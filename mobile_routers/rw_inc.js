const a0_0x2a4058=a0_0x1829;function a0_0x56e0(){const _0x48f33e=['2502102GjgZIR','62458BergJA','$product.type','../models/all_models','ejs','/barcode_scanner','$product.floorlevel','3020180wUnCGO','end','36hNRWaO','$product.bay','249755OfwXnz','$maxProdPerUnit','length','$product.room_name','$brand','table\x20page','name','$finalize','exports','293916BazBEj','271940ZNvBvj','query','$return_data','24yPKYPF','$warehouse_name','$maxStocks','json','$product_code','$secondary_unit','$alertquantity','$unit','$note','aggregate','$product.quantity','96zVZAeQ','suppliers','$category','Raw\x20Materials','10227480oVsUdT','Router','$suppliers_docs','$_id','express','post','status','$paid_amount','get','$secondary_code','$name','$expiry_date','$suppliers','nodemailer','9vdMHOl'];a0_0x56e0=function(){return _0x48f33e;};return a0_0x56e0();}(function(_0x4b8b44,_0x4ae7da){const _0x480a32=a0_0x1829,_0x151f62=_0x4b8b44();while(!![]){try{const _0x3e98c7=-parseInt(_0x480a32(0x1b6))/0x1*(-parseInt(_0x480a32(0x1be))/0x2)+parseInt(_0x480a32(0x1b5))/0x3+-parseInt(_0x480a32(0x1cd))/0x4*(-parseInt(_0x480a32(0x1ca))/0x5)+-parseInt(_0x480a32(0x1a2))/0x6*(parseInt(_0x480a32(0x1c9))/0x7)+parseInt(_0x480a32(0x1a6))/0x8*(-parseInt(_0x480a32(0x1b4))/0x9)+parseInt(_0x480a32(0x1bc))/0xa+parseInt(_0x480a32(0x1c0))/0xb;if(_0x3e98c7===_0x4ae7da)break;else _0x151f62['push'](_0x151f62['shift']());}catch(_0x401611){_0x151f62['push'](_0x151f62['shift']());}}}(a0_0x56e0,0xa0e8e));function a0_0x1829(_0x2283e0,_0xa9e3d9){const _0x56e08f=a0_0x56e0();return a0_0x1829=function(_0x18299a,_0x39d507){_0x18299a=_0x18299a-0x1a1;let _0xb80b6b=_0x56e08f[_0x18299a];return _0xb80b6b;},a0_0x1829(_0x2283e0,_0xa9e3d9);}const express=require(a0_0x2a4058(0x1aa)),app=express(),router=express[a0_0x2a4058(0x1a7)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x2a4058(0x1b8)),auth=require('../middleware/auth'),nodemailer=require(a0_0x2a4058(0x1b3));var ejs=require(a0_0x2a4058(0x1b9));const path=require('path'),users=require('../public/language/languages.json');router[a0_0x2a4058(0x1ae)]('/view',async(_0x5d182b,_0x4741e9)=>{const _0x5cb15a=a0_0x2a4058;try{const _0x106c65=parseInt(_0x5d182b['query']['start'])||0x0,_0x44abb2=parseInt(_0x5d182b[_0x5cb15a(0x1cb)][_0x5cb15a(0x1bd)])||0xa;let _0x1ea30d;_0x1ea30d=await purchases['aggregate']([{'$lookup':{'from':'suppliers','localField':_0x5cb15a(0x1a3),'foreignField':_0x5cb15a(0x1c6),'as':'suppliers_docs'}},{'$unwind':'$suppliers_docs'},{'$unwind':'$product'},{'$group':{'_id':_0x5cb15a(0x1a9),'invoice':{'$first':'$invoice'},'suppliers':{'$first':_0x5cb15a(0x1b2)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x5cb15a(0x1ce)},'room':{'$addToSet':_0x5cb15a(0x1c3)},'product':{'$push':'$product'},'note':{'$first':_0x5cb15a(0x1d5)},'paid_amount':{'$first':_0x5cb15a(0x1ad)},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':_0x5cb15a(0x1cc)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0x5cb15a(0x1b1)},'suppliers_docs':{'$first':_0x5cb15a(0x1a8)},'total_product_quantity':{'$sum':_0x5cb15a(0x1a1)},'level':{'$addToSet':_0x5cb15a(0x1bf)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x5cb15a(0x1b7)},'floorlevel':{'$addToSet':_0x5cb15a(0x1bb)},'finalize':{'$first':_0x5cb15a(0x1c7)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x106c65},{'$limit':_0x44abb2-_0x106c65}]),_0x4741e9[_0x5cb15a(0x1d0)](_0x1ea30d);}catch(_0x3f4e96){console['log'](_0x5cb15a(0x1c5),_0x3f4e96),_0x4741e9[_0x5cb15a(0x1ac)](0xc8)['json']({'message':_0x3f4e96['message']});}}),router[a0_0x2a4058(0x1ab)](a0_0x2a4058(0x1ba),async(_0x1ee80a,_0x3d7abd)=>{const _0xeef34e=a0_0x2a4058,{product_code:_0xbf0a2a}=_0x1ee80a['body'];var _0x3cc179;const _0xcf2b9f=await product[_0xeef34e(0x1d6)]([{'$match':{'primary_code':_0xbf0a2a,'product_category':_0xeef34e(0x1a5)}},{'$group':{'_id':_0xeef34e(0x1a9),'name':{'$first':_0xeef34e(0x1b0)},'category':{'$first':_0xeef34e(0x1a4)},'brand':{'$first':'$brand'},'unit':{'$first':_0xeef34e(0x1d4)},'alertquantity':{'$first':_0xeef34e(0x1d3)},'product_code':{'$first':_0xeef34e(0x1d1)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0xeef34e(0x1af)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0xeef34e(0x1c1)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0xeef34e(0x1d2)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x5c059a=await product[_0xeef34e(0x1d6)]([{'$match':{'secondary_code':_0xbf0a2a,'product_category':'Raw\x20Materials'}},{'$group':{'_id':'$_id','name':{'$first':_0xeef34e(0x1b0)},'category':{'$first':'$category'},'brand':{'$first':_0xeef34e(0x1c4)},'unit':{'$first':_0xeef34e(0x1d4)},'alertquantity':{'$first':_0xeef34e(0x1d3)},'product_code':{'$first':_0xeef34e(0x1d1)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0xeef34e(0x1cf)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0xcf2b9f[_0xeef34e(0x1c2)]>0x0)_0x3cc179=_0xcf2b9f;else _0x5c059a[_0xeef34e(0x1c2)]>0x0&&(_0x3cc179=_0x5c059a);_0x3d7abd['json'](_0x3cc179);}),module[a0_0x2a4058(0x1c8)]=router;