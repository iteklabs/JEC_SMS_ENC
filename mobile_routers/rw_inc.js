function a0_0x3149(){const _0x21ce03=['$alertquantity','../public/language/languages.json','express','length','/barcode_scanner','message','3387062ZpdRMS','809320hOeWAt','../models/all_models','body','$product_code','$batch_code','$_id','1917276LiaTyD','$primary_code','$return_data','Raw\x20Materials','$secondary_code','ejs','10FCTPye','$due_amount','$name','$note','$product.floorlevel','exports','status','$suppliers_docs','$secondary_unit','name','6kSEczc','$expiry_date','$finalize','$category','$product.bin','712235tiHpdS','5677866PHXIiA','$invoice','$suppliers','suppliers','368077JraGfy','post','$maxProdPerUnit','nodemailer','$unit','$product','$product.quantity','json','get','aggregate','$warehouse_name','/view','log','$date','$brand','4XwTjXU','table\x20page','end','425738UgoYan','$product.type','Router'];a0_0x3149=function(){return _0x21ce03;};return a0_0x3149();}const a0_0x19db48=a0_0x1692;(function(_0x2a61c1,_0x59231c){const _0x3307cf=a0_0x1692,_0x34f102=_0x2a61c1();while(!![]){try{const _0x10361e=-parseInt(_0x3307cf(0x192))/0x1+parseInt(_0x3307cf(0x1a4))/0x2*(-parseInt(_0x3307cf(0x188))/0x3)+parseInt(_0x3307cf(0x1a1))/0x4*(parseInt(_0x3307cf(0x18d))/0x5)+-parseInt(_0x3307cf(0x1b4))/0x6+parseInt(_0x3307cf(0x1ad))/0x7+parseInt(_0x3307cf(0x1ae))/0x8+-parseInt(_0x3307cf(0x18e))/0x9*(-parseInt(_0x3307cf(0x17e))/0xa);if(_0x10361e===_0x59231c)break;else _0x34f102['push'](_0x34f102['shift']());}catch(_0x823b71){_0x34f102['push'](_0x34f102['shift']());}}}(a0_0x3149,0x3bcff));const express=require(a0_0x19db48(0x1a9)),app=express(),router=express[a0_0x19db48(0x1a6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x19db48(0x1af)),auth=require('../middleware/auth'),nodemailer=require(a0_0x19db48(0x195));function a0_0x1692(_0x298c02,_0x56aa2b){const _0x314968=a0_0x3149();return a0_0x1692=function(_0x169293,_0x2fccbf){_0x169293=_0x169293-0x17a;let _0x2119ba=_0x314968[_0x169293];return _0x2119ba;},a0_0x1692(_0x298c02,_0x56aa2b);}var ejs=require(a0_0x19db48(0x17d));const path=require('path'),users=require(a0_0x19db48(0x1a8));router[a0_0x19db48(0x19a)](a0_0x19db48(0x19d),async(_0x177260,_0x586353)=>{const _0xc9c5ae=a0_0x19db48;try{const _0x4133cd=parseInt(_0x177260['query']['start'])||0x0,_0x3724fc=parseInt(_0x177260['query'][_0xc9c5ae(0x1a3)])||0xa;let _0x202310;_0x202310=await purchases[_0xc9c5ae(0x19b)]([{'$lookup':{'from':'suppliers','localField':_0xc9c5ae(0x191),'foreignField':_0xc9c5ae(0x187),'as':'suppliers_docs'}},{'$unwind':_0xc9c5ae(0x185)},{'$unwind':_0xc9c5ae(0x197)},{'$group':{'_id':_0xc9c5ae(0x1b3),'invoice':{'$first':_0xc9c5ae(0x18f)},'suppliers':{'$first':_0xc9c5ae(0x190)},'date':{'$first':_0xc9c5ae(0x19f)},'warehouse_name':{'$first':_0xc9c5ae(0x19c)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':'$product'},'note':{'$first':_0xc9c5ae(0x181)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0xc9c5ae(0x17f)},'return_data':{'$first':_0xc9c5ae(0x17a)},'batch_code':{'$first':_0xc9c5ae(0x1b2)},'expiry_date':{'$first':_0xc9c5ae(0x189)},'suppliers_docs':{'$first':_0xc9c5ae(0x185)},'total_product_quantity':{'$sum':_0xc9c5ae(0x198)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0xc9c5ae(0x18c)},'type':{'$addToSet':_0xc9c5ae(0x1a5)},'floorlevel':{'$addToSet':_0xc9c5ae(0x182)},'finalize':{'$first':_0xc9c5ae(0x18a)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x4133cd},{'$limit':_0x3724fc-_0x4133cd}]),_0x586353[_0xc9c5ae(0x199)](_0x202310);}catch(_0x492966){console[_0xc9c5ae(0x19e)](_0xc9c5ae(0x1a2),_0x492966),_0x586353[_0xc9c5ae(0x184)](0xc8)['json']({'message':_0x492966[_0xc9c5ae(0x1ac)]});}}),router[a0_0x19db48(0x193)](a0_0x19db48(0x1ab),async(_0x57fbcb,_0x2e72aa)=>{const _0x25c2d2=a0_0x19db48,{product_code:_0x3069f3}=_0x57fbcb[_0x25c2d2(0x1b0)];var _0x5d5dc7;const _0x3843b9=await product['aggregate']([{'$match':{'primary_code':_0x3069f3,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x25c2d2(0x1b3),'name':{'$first':_0x25c2d2(0x180)},'category':{'$first':'$category'},'brand':{'$first':_0x25c2d2(0x1a0)},'unit':{'$first':'$unit'},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x25c2d2(0x1b5)},'secondary_code':{'$first':_0x25c2d2(0x17c)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x25c2d2(0x186)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x13c195=await product[_0x25c2d2(0x19b)]([{'$match':{'secondary_code':_0x3069f3,'product_category':_0x25c2d2(0x17b)}},{'$group':{'_id':'$_id','name':{'$first':_0x25c2d2(0x180)},'category':{'$first':_0x25c2d2(0x18b)},'brand':{'$first':'$brand'},'unit':{'$first':_0x25c2d2(0x196)},'alertquantity':{'$first':_0x25c2d2(0x1a7)},'product_code':{'$first':_0x25c2d2(0x1b1)},'primary_code':{'$first':_0x25c2d2(0x1b5)},'secondary_code':{'$first':_0x25c2d2(0x17c)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x25c2d2(0x194)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x25c2d2(0x186)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x3843b9[_0x25c2d2(0x1aa)]>0x0)_0x5d5dc7=_0x3843b9;else _0x13c195[_0x25c2d2(0x1aa)]>0x0&&(_0x5d5dc7=_0x13c195);_0x2e72aa[_0x25c2d2(0x199)](_0x5d5dc7);}),module[a0_0x19db48(0x183)]=router;