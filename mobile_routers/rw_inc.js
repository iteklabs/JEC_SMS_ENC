function a0_0x4719(){const _0x463cbf=['$expiry_date','table\x20page','../middleware/auth','5oVIMZo','length','1163995gZiCBv','json','$product','query','$unit','9929565cndNeX','get','$primary_code','3954774NetNEX','$product.bay','post','exports','2ucgopt','$return_data','suppliers_docs','$invoice','Raw\x20Materials','$category','$product.room_name','$secondary_code','$suppliers_docs','$maxStocks','5731760ruiWWb','$finalize','$product.quantity','$alertquantity','2858514NjWkTk','message','start','$product_code','express','14Eoxnoj','$product.floorlevel','$suppliers','/barcode_scanner','$name','$maxProdPerUnit','ejs','$_id','suppliers','$brand','../public/language/languages.json','log','4394456LMzySn','$paid_amount','name','$date','/view','status','$due_amount','aggregate','$secondary_unit','3849364bNqpka','$note','$batch_code'];a0_0x4719=function(){return _0x463cbf;};return a0_0x4719();}const a0_0x303204=a0_0x23a8;function a0_0x23a8(_0x499289,_0x4badd1){const _0x4719f0=a0_0x4719();return a0_0x23a8=function(_0x23a8ba,_0x4f4179){_0x23a8ba=_0x23a8ba-0x1ec;let _0x48d195=_0x4719f0[_0x23a8ba];return _0x48d195;},a0_0x23a8(_0x499289,_0x4badd1);}(function(_0x17ed33,_0x2b6c4b){const _0x48e46e=a0_0x23a8,_0x391a39=_0x17ed33();while(!![]){try{const _0x104be8=-parseInt(_0x48e46e(0x215))/0x1+parseInt(_0x48e46e(0x221))/0x2*(parseInt(_0x48e46e(0x1f3))/0x3)+parseInt(_0x48e46e(0x20d))/0x4*(parseInt(_0x48e46e(0x213))/0x5)+-parseInt(_0x48e46e(0x21d))/0x6+-parseInt(_0x48e46e(0x1f8))/0x7*(-parseInt(_0x48e46e(0x204))/0x8)+-parseInt(_0x48e46e(0x21a))/0x9+parseInt(_0x48e46e(0x1ef))/0xa;if(_0x104be8===_0x2b6c4b)break;else _0x391a39['push'](_0x391a39['shift']());}catch(_0x2f505b){_0x391a39['push'](_0x391a39['shift']());}}}(a0_0x4719,0xa1450));const express=require(a0_0x303204(0x1f7)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x303204(0x212)),nodemailer=require('nodemailer');var ejs=require(a0_0x303204(0x1fe));const path=require('path'),users=require(a0_0x303204(0x202));router[a0_0x303204(0x21b)](a0_0x303204(0x208),async(_0x464439,_0xb9f0d7)=>{const _0x1ba7c3=a0_0x303204;try{const _0x2b366a=parseInt(_0x464439['query'][_0x1ba7c3(0x1f5)])||0x0,_0x155c70=parseInt(_0x464439[_0x1ba7c3(0x218)]['end'])||0xa;let _0x503565;_0x503565=await purchases[_0x1ba7c3(0x20b)]([{'$lookup':{'from':_0x1ba7c3(0x200),'localField':_0x1ba7c3(0x200),'foreignField':_0x1ba7c3(0x206),'as':_0x1ba7c3(0x223)}},{'$unwind':_0x1ba7c3(0x1ed)},{'$unwind':_0x1ba7c3(0x217)},{'$group':{'_id':_0x1ba7c3(0x1ff),'invoice':{'$first':_0x1ba7c3(0x224)},'suppliers':{'$first':_0x1ba7c3(0x1fa)},'date':{'$first':_0x1ba7c3(0x207)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x1ba7c3(0x227)},'product':{'$push':'$product'},'note':{'$first':_0x1ba7c3(0x20e)},'paid_amount':{'$first':_0x1ba7c3(0x205)},'due_amount':{'$first':_0x1ba7c3(0x20a)},'return_data':{'$first':_0x1ba7c3(0x222)},'batch_code':{'$first':_0x1ba7c3(0x20f)},'expiry_date':{'$first':_0x1ba7c3(0x210)},'suppliers_docs':{'$first':_0x1ba7c3(0x1ed)},'total_product_quantity':{'$sum':_0x1ba7c3(0x1f1)},'level':{'$addToSet':_0x1ba7c3(0x21e)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x1ba7c3(0x1f9)},'finalize':{'$first':_0x1ba7c3(0x1f0)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x2b366a},{'$limit':_0x155c70-_0x2b366a}]),_0xb9f0d7[_0x1ba7c3(0x216)](_0x503565);}catch(_0xac278e){console[_0x1ba7c3(0x203)](_0x1ba7c3(0x211),_0xac278e),_0xb9f0d7[_0x1ba7c3(0x209)](0xc8)[_0x1ba7c3(0x216)]({'message':_0xac278e[_0x1ba7c3(0x1f4)]});}}),router[a0_0x303204(0x21f)](a0_0x303204(0x1fb),async(_0x1180ba,_0x412da3)=>{const _0x191b70=a0_0x303204,{product_code:_0x4faf9b}=_0x1180ba['body'];var _0x5a7922;const _0x49fcf2=await product[_0x191b70(0x20b)]([{'$match':{'primary_code':_0x4faf9b,'product_category':_0x191b70(0x225)}},{'$group':{'_id':_0x191b70(0x1ff),'name':{'$first':_0x191b70(0x1fc)},'category':{'$first':_0x191b70(0x226)},'brand':{'$first':'$brand'},'unit':{'$first':_0x191b70(0x219)},'alertquantity':{'$first':_0x191b70(0x1f2)},'product_code':{'$first':_0x191b70(0x1f6)},'primary_code':{'$first':_0x191b70(0x21c)},'secondary_code':{'$first':_0x191b70(0x1ec)},'maxStocks':{'$first':_0x191b70(0x1ee)},'maxProdPerUnit':{'$first':_0x191b70(0x1fd)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x191b70(0x20c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x2fc592=await product[_0x191b70(0x20b)]([{'$match':{'secondary_code':_0x4faf9b,'product_category':_0x191b70(0x225)}},{'$group':{'_id':_0x191b70(0x1ff),'name':{'$first':_0x191b70(0x1fc)},'category':{'$first':_0x191b70(0x226)},'brand':{'$first':_0x191b70(0x201)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x191b70(0x1f2)},'product_code':{'$first':_0x191b70(0x1f6)},'primary_code':{'$first':_0x191b70(0x21c)},'secondary_code':{'$first':_0x191b70(0x1ec)},'maxStocks':{'$first':_0x191b70(0x1ee)},'maxProdPerUnit':{'$first':_0x191b70(0x1fd)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x191b70(0x20c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x49fcf2[_0x191b70(0x214)]>0x0)_0x5a7922=_0x49fcf2;else _0x2fc592[_0x191b70(0x214)]>0x0&&(_0x5a7922=_0x2fc592);_0x412da3[_0x191b70(0x216)](_0x5a7922);}),module[a0_0x303204(0x220)]=router;