const a0_0x55a4c0=a0_0x4698;function a0_0x4698(_0x554d4d,_0x49cb3b){const _0x16aa60=a0_0x16aa();return a0_0x4698=function(_0x4698eb,_0x126b8c){_0x4698eb=_0x4698eb-0xfc;let _0x5a6684=_0x16aa60[_0x4698eb];return _0x5a6684;},a0_0x4698(_0x554d4d,_0x49cb3b);}(function(_0xbccee0,_0x2657f5){const _0x4ec6dd=a0_0x4698,_0x250de5=_0xbccee0();while(!![]){try{const _0x15d0bd=parseInt(_0x4ec6dd(0x102))/0x1*(parseInt(_0x4ec6dd(0x112))/0x2)+parseInt(_0x4ec6dd(0x12b))/0x3+-parseInt(_0x4ec6dd(0x104))/0x4*(-parseInt(_0x4ec6dd(0x128))/0x5)+-parseInt(_0x4ec6dd(0x114))/0x6*(parseInt(_0x4ec6dd(0x11e))/0x7)+-parseInt(_0x4ec6dd(0x125))/0x8+parseInt(_0x4ec6dd(0x136))/0x9+-parseInt(_0x4ec6dd(0x11b))/0xa*(parseInt(_0x4ec6dd(0x127))/0xb);if(_0x15d0bd===_0x2657f5)break;else _0x250de5['push'](_0x250de5['shift']());}catch(_0x6ec428){_0x250de5['push'](_0x250de5['shift']());}}}(a0_0x16aa,0x63475));function a0_0x16aa(){const _0x513067=['Raw\x20Materials','2880564qSLiZL','aggregate','$_id','body','get','$product','Router','express','ejs','$finalize','nodemailer','$product.floorlevel','log','table\x20page','6TyWzSv','post','276282pNeIHI','$product.quantity','$suppliers','length','$maxProdPerUnit','$maxStocks','$invoice','81740bzdRlV','$due_amount','$product.bin','91AjjOLN','start','$warehouse_name','$unit','suppliers_docs','/view','path','953168AvLKBr','/barcode_scanner','737IDMrkE','5EghZzG','../middleware/auth','$suppliers_docs','1131720vbDaYs','$expiry_date','$batch_code','$secondary_code','$brand','json','suppliers','$alertquantity','$name','$primary_code','$secondary_unit','1440468KOpgbl','$date','status','$product.type','$category','query','exports','138209AmvEFw'];a0_0x16aa=function(){return _0x513067;};return a0_0x16aa();}const express=require(a0_0x55a4c0(0x10b)),app=express(),router=express[a0_0x55a4c0(0x10a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x55a4c0(0x129)),nodemailer=require(a0_0x55a4c0(0x10e));var ejs=require(a0_0x55a4c0(0x10c));const path=require(a0_0x55a4c0(0x124)),users=require('../public/language/languages.json');router[a0_0x55a4c0(0x108)](a0_0x55a4c0(0x123),async(_0x1b946d,_0x51edc8)=>{const _0x1650ff=a0_0x55a4c0;try{const _0x2765cb=parseInt(_0x1b946d[_0x1650ff(0x100)][_0x1650ff(0x11f)])||0x0,_0x293352=parseInt(_0x1b946d[_0x1650ff(0x100)]['end'])||0xa;let _0x113b03;_0x113b03=await purchases[_0x1650ff(0x105)]([{'$lookup':{'from':_0x1650ff(0x131),'localField':_0x1650ff(0x131),'foreignField':'name','as':_0x1650ff(0x122)}},{'$unwind':_0x1650ff(0x12a)},{'$unwind':_0x1650ff(0x109)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1650ff(0x11a)},'suppliers':{'$first':_0x1650ff(0x116)},'date':{'$first':_0x1650ff(0xfc)},'warehouse_name':{'$first':_0x1650ff(0x120)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':_0x1650ff(0x109)},'note':{'$first':'$note'},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x1650ff(0x11c)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x1650ff(0x12d)},'expiry_date':{'$first':_0x1650ff(0x12c)},'suppliers_docs':{'$first':'$suppliers_docs'},'total_product_quantity':{'$sum':_0x1650ff(0x115)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0x1650ff(0x11d)},'type':{'$addToSet':_0x1650ff(0xfe)},'floorlevel':{'$addToSet':_0x1650ff(0x10f)},'finalize':{'$first':_0x1650ff(0x10d)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x2765cb},{'$limit':_0x293352-_0x2765cb}]),_0x51edc8[_0x1650ff(0x130)](_0x113b03);}catch(_0x193081){console[_0x1650ff(0x110)](_0x1650ff(0x111),_0x193081),_0x51edc8[_0x1650ff(0xfd)](0xc8)['json']({'message':_0x193081['message']});}}),router[a0_0x55a4c0(0x113)](a0_0x55a4c0(0x126),async(_0x5b683c,_0x631a2d)=>{const _0x1c3e12=a0_0x55a4c0,{product_code:_0x2b90d6}=_0x5b683c[_0x1c3e12(0x107)];var _0xa82086;const _0x2298d8=await product['aggregate']([{'$match':{'primary_code':_0x2b90d6,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x1c3e12(0x106),'name':{'$first':_0x1c3e12(0x133)},'category':{'$first':_0x1c3e12(0xff)},'brand':{'$first':_0x1c3e12(0x12f)},'unit':{'$first':_0x1c3e12(0x121)},'alertquantity':{'$first':_0x1c3e12(0x132)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x1c3e12(0x134)},'secondary_code':{'$first':_0x1c3e12(0x12e)},'maxStocks':{'$first':_0x1c3e12(0x119)},'maxProdPerUnit':{'$first':_0x1c3e12(0x118)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x1c3e12(0x135)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x3e2276=await product[_0x1c3e12(0x105)]([{'$match':{'secondary_code':_0x2b90d6,'product_category':_0x1c3e12(0x103)}},{'$group':{'_id':_0x1c3e12(0x106),'name':{'$first':_0x1c3e12(0x133)},'category':{'$first':_0x1c3e12(0xff)},'brand':{'$first':_0x1c3e12(0x12f)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x1c3e12(0x132)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x1c3e12(0x134)},'secondary_code':{'$first':_0x1c3e12(0x12e)},'maxStocks':{'$first':_0x1c3e12(0x119)},'maxProdPerUnit':{'$first':_0x1c3e12(0x118)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x1c3e12(0x135)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x2298d8[_0x1c3e12(0x117)]>0x0)_0xa82086=_0x2298d8;else _0x3e2276[_0x1c3e12(0x117)]>0x0&&(_0xa82086=_0x3e2276);_0x631a2d[_0x1c3e12(0x130)](_0xa82086);}),module[a0_0x55a4c0(0x101)]=router;