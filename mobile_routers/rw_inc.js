const a0_0x28825c=a0_0x1027;(function(_0x105e24,_0x43aa68){const _0x2d8349=a0_0x1027,_0x1596ff=_0x105e24();while(!![]){try{const _0x51cc3d=-parseInt(_0x2d8349(0x9c))/0x1*(parseInt(_0x2d8349(0x78))/0x2)+parseInt(_0x2d8349(0xa0))/0x3*(parseInt(_0x2d8349(0x84))/0x4)+parseInt(_0x2d8349(0x8f))/0x5*(parseInt(_0x2d8349(0x76))/0x6)+parseInt(_0x2d8349(0xa6))/0x7+-parseInt(_0x2d8349(0xa1))/0x8+parseInt(_0x2d8349(0x80))/0x9*(-parseInt(_0x2d8349(0x6f))/0xa)+-parseInt(_0x2d8349(0x83))/0xb*(-parseInt(_0x2d8349(0x72))/0xc);if(_0x51cc3d===_0x43aa68)break;else _0x1596ff['push'](_0x1596ff['shift']());}catch(_0xd2fcdd){_0x1596ff['push'](_0x1596ff['shift']());}}}(a0_0x5191,0xb506b));const express=require(a0_0x28825c(0x87)),app=express(),router=express[a0_0x28825c(0x70)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x28825c(0x88)),auth=require('../middleware/auth'),nodemailer=require(a0_0x28825c(0x9e));function a0_0x1027(_0x4022a4,_0x470e96){const _0x5191a0=a0_0x5191();return a0_0x1027=function(_0x1027a6,_0x290fea){_0x1027a6=_0x1027a6-0x6d;let _0x469d7f=_0x5191a0[_0x1027a6];return _0x469d7f;},a0_0x1027(_0x4022a4,_0x470e96);}var ejs=require('ejs');const path=require(a0_0x28825c(0x8b)),users=require('../public/language/languages.json');router[a0_0x28825c(0x8a)](a0_0x28825c(0x81),async(_0x1c5b16,_0x862fe4)=>{const _0x563966=a0_0x28825c;try{const _0x3053f7=parseInt(_0x1c5b16[_0x563966(0x7b)][_0x563966(0xa3)])||0x0,_0x5bc93e=parseInt(_0x1c5b16[_0x563966(0x7b)]['end'])||0xa;let _0x187143;_0x187143=await purchases[_0x563966(0x9d)]([{'$lookup':{'from':_0x563966(0x94),'localField':_0x563966(0x94),'foreignField':'name','as':_0x563966(0xa4)}},{'$unwind':_0x563966(0x7d)},{'$unwind':_0x563966(0x6d)},{'$group':{'_id':'$_id','invoice':{'$first':_0x563966(0xa5)},'suppliers':{'$first':_0x563966(0x7f)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x563966(0x92)},'product':{'$push':_0x563966(0x6d)},'note':{'$first':'$note'},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x563966(0x9f)},'return_data':{'$first':_0x563966(0x6e)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0x563966(0x7e)},'suppliers_docs':{'$first':_0x563966(0x7d)},'total_product_quantity':{'$sum':_0x563966(0x75)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0x563966(0x85)},'type':{'$addToSet':_0x563966(0x8d)},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x3053f7},{'$limit':_0x5bc93e-_0x3053f7}]),_0x862fe4[_0x563966(0x7a)](_0x187143);}catch(_0x12beeb){console[_0x563966(0x73)](_0x563966(0xa2),_0x12beeb),_0x862fe4[_0x563966(0x71)](0xc8)['json']({'message':_0x12beeb[_0x563966(0x90)]});}}),router[a0_0x28825c(0x7c)](a0_0x28825c(0x82),async(_0xbbd133,_0x317713)=>{const _0x243d81=a0_0x28825c,{product_code:_0x4cd812}=_0xbbd133[_0x243d81(0x77)];var _0x502a96;const _0x5a3d72=await product[_0x243d81(0x9d)]([{'$match':{'primary_code':_0x4cd812,'product_category':_0x243d81(0x79)}},{'$group':{'_id':_0x243d81(0x89),'name':{'$first':_0x243d81(0x8e)},'category':{'$first':_0x243d81(0x8c)},'brand':{'$first':_0x243d81(0x95)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x243d81(0x96)},'product_code':{'$first':_0x243d81(0x9a)},'primary_code':{'$first':_0x243d81(0x9b)},'secondary_code':{'$first':_0x243d81(0x86)},'maxStocks':{'$first':_0x243d81(0x97)},'maxProdPerUnit':{'$first':_0x243d81(0x74)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x243d81(0x98)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x4ea984=await product[_0x243d81(0x9d)]([{'$match':{'secondary_code':_0x4cd812,'product_category':_0x243d81(0x79)}},{'$group':{'_id':_0x243d81(0x89),'name':{'$first':'$name'},'category':{'$first':_0x243d81(0x8c)},'brand':{'$first':_0x243d81(0x95)},'unit':{'$first':_0x243d81(0x99)},'alertquantity':{'$first':_0x243d81(0x96)},'product_code':{'$first':_0x243d81(0x9a)},'primary_code':{'$first':_0x243d81(0x9b)},'secondary_code':{'$first':_0x243d81(0x86)},'maxStocks':{'$first':_0x243d81(0x97)},'maxProdPerUnit':{'$first':_0x243d81(0x74)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x243d81(0x98)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x5a3d72[_0x243d81(0x91)]>0x0)_0x502a96=_0x5a3d72;else _0x4ea984[_0x243d81(0x91)]>0x0&&(_0x502a96=_0x4ea984);_0x317713[_0x243d81(0x7a)](_0x502a96);}),module[a0_0x28825c(0x93)]=router;function a0_0x5191(){const _0x149a04=['$product.bin','$secondary_code','express','../models/all_models','$_id','get','path','$category','$product.type','$name','6785HkhYDy','message','length','$product.room_name','exports','suppliers','$brand','$alertquantity','$maxStocks','$secondary_unit','$unit','$product_code','$primary_code','967549BCsRFk','aggregate','nodemailer','$due_amount','604665PCgvTO','463168eNWhFI','table\x20page','start','suppliers_docs','$invoice','4307954loFJGF','$product','$return_data','1510fshASm','Router','status','1236JwBrZF','log','$maxProdPerUnit','$product.quantity','6420moszBy','body','2isJnOb','Raw\x20Materials','json','query','post','$suppliers_docs','$expiry_date','$suppliers','78345olgDkq','/view','/barcode_scanner','22187ETMSFZ','16ZOQjMw'];a0_0x5191=function(){return _0x149a04;};return a0_0x5191();}