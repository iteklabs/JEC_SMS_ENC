function a0_0x47fd(){const _0x131986=['path','post','get','$batch_code','1236090vSYCnD','$expiry_date','express','6MkNxGL','aggregate','5536773spbqGD','query','$finalize','table\x20page','$alertquantity','$product.floorlevel','$product.bin','376wapUJg','3619UfwKfP','$warehouse_name','409724XwgnKv','length','ejs','$note','end','$product.bay','$due_amount','../public/language/languages.json','Raw\x20Materials','$brand','$name','$invoice','$maxProdPerUnit','$secondary_unit','$date','$suppliers','$unit','307834EqrvJf','message','body','../models/all_models','$secondary_code','$_id','$primary_code','20pBcmaF','exports','$maxStocks','$product','start','$product.quantity','$product.room_name','1464rNzUlo','$category','/barcode_scanner','28900QPvhiY','suppliers','2191239MAZxfl','$product_code','json','$suppliers_docs','status'];a0_0x47fd=function(){return _0x131986;};return a0_0x47fd();}const a0_0x187560=a0_0x4683;(function(_0x1cd600,_0x3e0443){const _0x57d6b7=a0_0x4683,_0x12c184=_0x1cd600();while(!![]){try{const _0x590d73=-parseInt(_0x57d6b7(0x15b))/0x1+-parseInt(_0x57d6b7(0x16c))/0x2*(parseInt(_0x57d6b7(0x14f))/0x3)+parseInt(_0x57d6b7(0x158))/0x4*(-parseInt(_0x57d6b7(0x17d))/0x5)+parseInt(_0x57d6b7(0x188))/0x6+parseInt(_0x57d6b7(0x159))/0x7*(parseInt(_0x57d6b7(0x17a))/0x8)+parseInt(_0x57d6b7(0x17f))/0x9+parseInt(_0x57d6b7(0x173))/0xa*(parseInt(_0x57d6b7(0x151))/0xb);if(_0x590d73===_0x3e0443)break;else _0x12c184['push'](_0x12c184['shift']());}catch(_0x585692){_0x12c184['push'](_0x12c184['shift']());}}}(a0_0x47fd,0x46c71));const express=require(a0_0x187560(0x14e)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x187560(0x16f)),auth=require('../middleware/auth'),nodemailer=require('nodemailer');var ejs=require(a0_0x187560(0x15d));function a0_0x4683(_0x517a14,_0x15f81e){const _0x47fd5e=a0_0x47fd();return a0_0x4683=function(_0x4683f7,_0x30f16b){_0x4683f7=_0x4683f7-0x14e;let _0x543f6e=_0x47fd5e[_0x4683f7];return _0x543f6e;},a0_0x4683(_0x517a14,_0x15f81e);}const path=require(a0_0x187560(0x184)),users=require(a0_0x187560(0x162));router[a0_0x187560(0x186)]('/view',async(_0x322d28,_0x472788)=>{const _0x51f9f0=a0_0x187560;try{const _0x147fe6=parseInt(_0x322d28[_0x51f9f0(0x152)][_0x51f9f0(0x177)])||0x0,_0x5cf325=parseInt(_0x322d28[_0x51f9f0(0x152)][_0x51f9f0(0x15f)])||0xa;let _0x8206af;_0x8206af=await purchases['aggregate']([{'$lookup':{'from':_0x51f9f0(0x17e),'localField':_0x51f9f0(0x17e),'foreignField':'name','as':'suppliers_docs'}},{'$unwind':_0x51f9f0(0x182)},{'$unwind':_0x51f9f0(0x176)},{'$group':{'_id':_0x51f9f0(0x171),'invoice':{'$first':_0x51f9f0(0x166)},'suppliers':{'$first':_0x51f9f0(0x16a)},'date':{'$first':_0x51f9f0(0x169)},'warehouse_name':{'$first':_0x51f9f0(0x15a)},'room':{'$addToSet':_0x51f9f0(0x179)},'product':{'$push':_0x51f9f0(0x176)},'note':{'$first':_0x51f9f0(0x15e)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x51f9f0(0x161)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x51f9f0(0x187)},'expiry_date':{'$first':_0x51f9f0(0x189)},'suppliers_docs':{'$first':'$suppliers_docs'},'total_product_quantity':{'$sum':_0x51f9f0(0x178)},'level':{'$addToSet':_0x51f9f0(0x160)},'isle':{'$addToSet':_0x51f9f0(0x157)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x51f9f0(0x156)},'finalize':{'$first':_0x51f9f0(0x153)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x147fe6},{'$limit':_0x5cf325-_0x147fe6}]),_0x472788[_0x51f9f0(0x181)](_0x8206af);}catch(_0x2055b9){console['log'](_0x51f9f0(0x154),_0x2055b9),_0x472788[_0x51f9f0(0x183)](0xc8)[_0x51f9f0(0x181)]({'message':_0x2055b9[_0x51f9f0(0x16d)]});}}),router[a0_0x187560(0x185)](a0_0x187560(0x17c),async(_0x3ccd69,_0x1000e6)=>{const _0x57c2eb=a0_0x187560,{product_code:_0x409beb}=_0x3ccd69[_0x57c2eb(0x16e)];var _0x380f92;const _0x3c0dd6=await product[_0x57c2eb(0x150)]([{'$match':{'primary_code':_0x409beb,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x57c2eb(0x171),'name':{'$first':_0x57c2eb(0x165)},'category':{'$first':_0x57c2eb(0x17b)},'brand':{'$first':_0x57c2eb(0x164)},'unit':{'$first':_0x57c2eb(0x16b)},'alertquantity':{'$first':_0x57c2eb(0x155)},'product_code':{'$first':_0x57c2eb(0x180)},'primary_code':{'$first':_0x57c2eb(0x172)},'secondary_code':{'$first':_0x57c2eb(0x170)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x57c2eb(0x167)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0xd2a69e=await product[_0x57c2eb(0x150)]([{'$match':{'secondary_code':_0x409beb,'product_category':_0x57c2eb(0x163)}},{'$group':{'_id':_0x57c2eb(0x171),'name':{'$first':_0x57c2eb(0x165)},'category':{'$first':_0x57c2eb(0x17b)},'brand':{'$first':'$brand'},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x57c2eb(0x155)},'product_code':{'$first':_0x57c2eb(0x180)},'primary_code':{'$first':_0x57c2eb(0x172)},'secondary_code':{'$first':_0x57c2eb(0x170)},'maxStocks':{'$first':_0x57c2eb(0x175)},'maxProdPerUnit':{'$first':_0x57c2eb(0x167)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x57c2eb(0x168)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x3c0dd6['length']>0x0)_0x380f92=_0x3c0dd6;else _0xd2a69e[_0x57c2eb(0x15c)]>0x0&&(_0x380f92=_0xd2a69e);_0x1000e6[_0x57c2eb(0x181)](_0x380f92);}),module[a0_0x187560(0x174)]=router;