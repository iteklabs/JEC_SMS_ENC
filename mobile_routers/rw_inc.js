const a0_0x15c499=a0_0x15c2;(function(_0xb74927,_0x688d67){const _0xb5d1d2=a0_0x15c2,_0xc02fbb=_0xb74927();while(!![]){try{const _0xbc791a=-parseInt(_0xb5d1d2(0xd1))/0x1+-parseInt(_0xb5d1d2(0xc5))/0x2+-parseInt(_0xb5d1d2(0xe4))/0x3*(parseInt(_0xb5d1d2(0xce))/0x4)+-parseInt(_0xb5d1d2(0xbb))/0x5+parseInt(_0xb5d1d2(0xf5))/0x6+parseInt(_0xb5d1d2(0xe3))/0x7*(parseInt(_0xb5d1d2(0xb9))/0x8)+parseInt(_0xb5d1d2(0xdd))/0x9*(parseInt(_0xb5d1d2(0xe1))/0xa);if(_0xbc791a===_0x688d67)break;else _0xc02fbb['push'](_0xc02fbb['shift']());}catch(_0x4e57ca){_0xc02fbb['push'](_0xc02fbb['shift']());}}}(a0_0x415a,0x6601e));const express=require(a0_0x15c499(0xbc)),app=express(),router=express[a0_0x15c499(0xdf)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x15c499(0xcb)),nodemailer=require(a0_0x15c499(0xe8));var ejs=require(a0_0x15c499(0xd9));function a0_0x415a(){const _0xd4997e=['message','$due_amount','$product.bay','$product_code','query','../public/language/languages.json','$expiry_date','aggregate','$product','end','path','get','2245128lTbZgA','start','length','33304aCKYbn','$_id','1373515HClMYW','express','exports','$secondary_code','/view','table\x20page','$suppliers_docs','$product.room_name','body','Raw\x20Materials','1028054fPeyLu','$product.bin','$invoice','$batch_code','$suppliers','$primary_code','../middleware/auth','/barcode_scanner','$name','14696FBVtfK','$return_data','$brand','808452cMocxo','$note','$alertquantity','name','$product.quantity','$category','$finalize','log','ejs','suppliers_docs','$date','$secondary_unit','18ppZyST','$warehouse_name','Router','post','5293810LUrJqN','$maxStocks','1232MrLSEW','123sJgcuJ','$unit','status','json','nodemailer'];a0_0x415a=function(){return _0xd4997e;};return a0_0x415a();}const path=require(a0_0x15c499(0xf3)),users=require(a0_0x15c499(0xee));function a0_0x15c2(_0x4ae749,_0x237fe5){const _0x415a56=a0_0x415a();return a0_0x15c2=function(_0x15c20c,_0x45924f){_0x15c20c=_0x15c20c-0xb8;let _0x4390f4=_0x415a56[_0x15c20c];return _0x4390f4;},a0_0x15c2(_0x4ae749,_0x237fe5);}router[a0_0x15c499(0xf4)](a0_0x15c499(0xbf),async(_0x24fcf3,_0x42efa8)=>{const _0x1ea0db=a0_0x15c499;try{const _0x40dfe6=parseInt(_0x24fcf3[_0x1ea0db(0xed)][_0x1ea0db(0xf6)])||0x0,_0x22e03f=parseInt(_0x24fcf3[_0x1ea0db(0xed)][_0x1ea0db(0xf2)])||0xa;let _0x5e08b2;_0x5e08b2=await purchases[_0x1ea0db(0xf0)]([{'$lookup':{'from':'suppliers','localField':'suppliers','foreignField':_0x1ea0db(0xd4),'as':_0x1ea0db(0xda)}},{'$unwind':'$suppliers_docs'},{'$unwind':'$product'},{'$group':{'_id':_0x1ea0db(0xba),'invoice':{'$first':_0x1ea0db(0xc7)},'suppliers':{'$first':_0x1ea0db(0xc9)},'date':{'$first':_0x1ea0db(0xdb)},'warehouse_name':{'$first':_0x1ea0db(0xde)},'room':{'$addToSet':_0x1ea0db(0xc2)},'product':{'$push':_0x1ea0db(0xf1)},'note':{'$first':_0x1ea0db(0xd2)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x1ea0db(0xea)},'return_data':{'$first':_0x1ea0db(0xcf)},'batch_code':{'$first':_0x1ea0db(0xc8)},'expiry_date':{'$first':_0x1ea0db(0xef)},'suppliers_docs':{'$first':_0x1ea0db(0xc1)},'total_product_quantity':{'$sum':_0x1ea0db(0xd5)},'level':{'$addToSet':_0x1ea0db(0xeb)},'isle':{'$addToSet':_0x1ea0db(0xc6)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':_0x1ea0db(0xd7)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x40dfe6},{'$limit':_0x22e03f-_0x40dfe6}]),_0x42efa8[_0x1ea0db(0xe7)](_0x5e08b2);}catch(_0x4da1bf){console[_0x1ea0db(0xd8)](_0x1ea0db(0xc0),_0x4da1bf),_0x42efa8[_0x1ea0db(0xe6)](0xc8)[_0x1ea0db(0xe7)]({'message':_0x4da1bf[_0x1ea0db(0xe9)]});}}),router[a0_0x15c499(0xe0)](a0_0x15c499(0xcc),async(_0xc2617c,_0x492844)=>{const _0x533c82=a0_0x15c499,{product_code:_0x29652f}=_0xc2617c[_0x533c82(0xc3)];var _0x173ebc;const _0x317312=await product[_0x533c82(0xf0)]([{'$match':{'primary_code':_0x29652f,'product_category':_0x533c82(0xc4)}},{'$group':{'_id':_0x533c82(0xba),'name':{'$first':_0x533c82(0xcd)},'category':{'$first':_0x533c82(0xd6)},'brand':{'$first':_0x533c82(0xd0)},'unit':{'$first':_0x533c82(0xe5)},'alertquantity':{'$first':_0x533c82(0xd3)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x533c82(0xca)},'secondary_code':{'$first':_0x533c82(0xbe)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x533c82(0xdc)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x35f1c1=await product[_0x533c82(0xf0)]([{'$match':{'secondary_code':_0x29652f,'product_category':_0x533c82(0xc4)}},{'$group':{'_id':_0x533c82(0xba),'name':{'$first':_0x533c82(0xcd)},'category':{'$first':_0x533c82(0xd6)},'brand':{'$first':_0x533c82(0xd0)},'unit':{'$first':_0x533c82(0xe5)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x533c82(0xec)},'primary_code':{'$first':_0x533c82(0xca)},'secondary_code':{'$first':_0x533c82(0xbe)},'maxStocks':{'$first':_0x533c82(0xe2)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x317312['length']>0x0)_0x173ebc=_0x317312;else _0x35f1c1[_0x533c82(0xb8)]>0x0&&(_0x173ebc=_0x35f1c1);_0x492844[_0x533c82(0xe7)](_0x173ebc);}),module[a0_0x15c499(0xbd)]=router;