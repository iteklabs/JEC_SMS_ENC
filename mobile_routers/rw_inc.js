const a0_0x249db9=a0_0x37c8;function a0_0x37c8(_0x156af7,_0x1feff4){const _0x2fe49d=a0_0x2fe4();return a0_0x37c8=function(_0x37c811,_0x320151){_0x37c811=_0x37c811-0x79;let _0x2eb305=_0x2fe49d[_0x37c811];return _0x2eb305;},a0_0x37c8(_0x156af7,_0x1feff4);}(function(_0x5d614f,_0x1966bb){const _0x4f61a9=a0_0x37c8,_0x1d08e2=_0x5d614f();while(!![]){try{const _0x32a82d=parseInt(_0x4f61a9(0x8e))/0x1*(-parseInt(_0x4f61a9(0x9c))/0x2)+-parseInt(_0x4f61a9(0x83))/0x3+parseInt(_0x4f61a9(0xa8))/0x4*(parseInt(_0x4f61a9(0x86))/0x5)+parseInt(_0x4f61a9(0x8a))/0x6+parseInt(_0x4f61a9(0xad))/0x7+parseInt(_0x4f61a9(0xa5))/0x8*(-parseInt(_0x4f61a9(0x7a))/0x9)+parseInt(_0x4f61a9(0x88))/0xa;if(_0x32a82d===_0x1966bb)break;else _0x1d08e2['push'](_0x1d08e2['shift']());}catch(_0x2fdf05){_0x1d08e2['push'](_0x1d08e2['shift']());}}}(a0_0x2fe4,0xd8a8a));const express=require(a0_0x249db9(0x90)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x249db9(0x8b)),auth=require(a0_0x249db9(0x9d)),nodemailer=require(a0_0x249db9(0x7b));var ejs=require('ejs');const path=require(a0_0x249db9(0x9f)),users=require(a0_0x249db9(0x93));router[a0_0x249db9(0x82)]('/view',async(_0x4794f2,_0x410762)=>{const _0x1da37e=a0_0x249db9;try{const _0x474e1a=parseInt(_0x4794f2[_0x1da37e(0x7e)][_0x1da37e(0xa3)])||0x0,_0x2ecb68=parseInt(_0x4794f2[_0x1da37e(0x7e)][_0x1da37e(0xaa)])||0xa;let _0x12e2eb;_0x12e2eb=await purchases['aggregate']([{'$lookup':{'from':_0x1da37e(0x8d),'localField':_0x1da37e(0x8d),'foreignField':_0x1da37e(0xa6),'as':'suppliers_docs'}},{'$unwind':_0x1da37e(0x79)},{'$unwind':'$product'},{'$group':{'_id':_0x1da37e(0xa7),'invoice':{'$first':_0x1da37e(0xab)},'suppliers':{'$first':'$suppliers'},'date':{'$first':_0x1da37e(0x7c)},'warehouse_name':{'$first':_0x1da37e(0xa2)},'room':{'$addToSet':_0x1da37e(0x84)},'product':{'$push':_0x1da37e(0xac)},'note':{'$first':_0x1da37e(0x9e)},'paid_amount':{'$first':_0x1da37e(0x94)},'due_amount':{'$first':_0x1da37e(0x97)},'return_data':{'$first':_0x1da37e(0xa1)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':'$suppliers_docs'},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x1da37e(0x89)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x1da37e(0x81)},'floorlevel':{'$addToSet':_0x1da37e(0xa0)},'finalize':{'$first':_0x1da37e(0x95)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x474e1a},{'$limit':_0x2ecb68-_0x474e1a}]),_0x410762[_0x1da37e(0x96)](_0x12e2eb);}catch(_0x1b25a5){console['log'](_0x1da37e(0x80),_0x1b25a5),_0x410762['status'](0xc8)[_0x1da37e(0x96)]({'message':_0x1b25a5[_0x1da37e(0xa9)]});}}),router[a0_0x249db9(0xb0)]('/barcode_scanner',async(_0x574681,_0xf1eba)=>{const _0x360fe3=a0_0x249db9,{product_code:_0x237bfc}=_0x574681[_0x360fe3(0x99)];var _0x91a619;const _0x1d40c6=await product[_0x360fe3(0xae)]([{'$match':{'primary_code':_0x237bfc,'product_category':_0x360fe3(0x7d)}},{'$group':{'_id':_0x360fe3(0xa7),'name':{'$first':_0x360fe3(0x92)},'category':{'$first':_0x360fe3(0x98)},'brand':{'$first':_0x360fe3(0x9a)},'unit':{'$first':_0x360fe3(0x7f)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x360fe3(0xaf)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x360fe3(0x8c)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x360fe3(0x87)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x360fe3(0xa4)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x1a780e=await product[_0x360fe3(0xae)]([{'$match':{'secondary_code':_0x237bfc,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x360fe3(0xa7),'name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':'$brand'},'unit':{'$first':_0x360fe3(0x7f)},'alertquantity':{'$first':_0x360fe3(0x9b)},'product_code':{'$first':_0x360fe3(0xaf)},'primary_code':{'$first':_0x360fe3(0x8f)},'secondary_code':{'$first':_0x360fe3(0x8c)},'maxStocks':{'$first':_0x360fe3(0x91)},'maxProdPerUnit':{'$first':_0x360fe3(0x87)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x1d40c6['length']>0x0)_0x91a619=_0x1d40c6;else _0x1a780e[_0x360fe3(0x85)]>0x0&&(_0x91a619=_0x1a780e);_0xf1eba['json'](_0x91a619);}),module['exports']=router;function a0_0x2fe4(){const _0x2dca8c=['$primary_code','express','$maxStocks','$name','../public/language/languages.json','$paid_amount','$finalize','json','$due_amount','$category','body','$brand','$alertquantity','2gYrqmE','../middleware/auth','$note','path','$product.floorlevel','$return_data','$warehouse_name','start','$secondary_unit','8jhbJnp','name','$_id','652YoQdQw','message','end','$invoice','$product','4413164vLXedE','aggregate','$product_code','post','$suppliers_docs','1110249eBvWdT','nodemailer','$date','Raw\x20Materials','query','$unit','table\x20page','$product.type','get','1028868jaydAr','$product.room_name','length','21745TUKwwk','$maxProdPerUnit','4437900WUNspW','$product.bay','3153006zybwpS','../models/all_models','$secondary_code','suppliers','954879pgeRfg'];a0_0x2fe4=function(){return _0x2dca8c;};return a0_0x2fe4();}