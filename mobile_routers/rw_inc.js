const a0_0x4df804=a0_0xad93;(function(_0x19fdf2,_0x36ab69){const _0x2bb4aa=a0_0xad93,_0x206aa2=_0x19fdf2();while(!![]){try{const _0x58bc16=-parseInt(_0x2bb4aa(0x12c))/0x1+-parseInt(_0x2bb4aa(0x133))/0x2*(-parseInt(_0x2bb4aa(0x157))/0x3)+-parseInt(_0x2bb4aa(0x144))/0x4*(parseInt(_0x2bb4aa(0x137))/0x5)+parseInt(_0x2bb4aa(0x14d))/0x6*(parseInt(_0x2bb4aa(0x141))/0x7)+-parseInt(_0x2bb4aa(0x153))/0x8*(parseInt(_0x2bb4aa(0x134))/0x9)+parseInt(_0x2bb4aa(0x158))/0xa*(-parseInt(_0x2bb4aa(0x161))/0xb)+parseInt(_0x2bb4aa(0x151))/0xc*(parseInt(_0x2bb4aa(0x12e))/0xd);if(_0x58bc16===_0x36ab69)break;else _0x206aa2['push'](_0x206aa2['shift']());}catch(_0x1eb1be){_0x206aa2['push'](_0x206aa2['shift']());}}}(a0_0x244b,0xe83ca));const express=require(a0_0x4df804(0x13f)),app=express(),router=express[a0_0x4df804(0x15e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x4df804(0x162)),auth=require(a0_0x4df804(0x15b)),nodemailer=require(a0_0x4df804(0x156));var ejs=require(a0_0x4df804(0x14e));const path=require(a0_0x4df804(0x131)),users=require(a0_0x4df804(0x148));router[a0_0x4df804(0x146)]('/view',async(_0x2f05cf,_0x268944)=>{const _0x56a256=a0_0x4df804;try{const _0x26c0e4=parseInt(_0x2f05cf[_0x56a256(0x15c)]['start'])||0x0,_0x58f566=parseInt(_0x2f05cf[_0x56a256(0x15c)][_0x56a256(0x140)])||0xa;let _0x3fe1e3;_0x3fe1e3=await purchases['aggregate']([{'$lookup':{'from':'suppliers','localField':_0x56a256(0x13e),'foreignField':'name','as':'suppliers_docs'}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x56a256(0x160)},{'$group':{'_id':_0x56a256(0x12f),'invoice':{'$first':_0x56a256(0x129)},'suppliers':{'$first':_0x56a256(0x163)},'date':{'$first':_0x56a256(0x159)},'warehouse_name':{'$first':_0x56a256(0x15a)},'room':{'$addToSet':_0x56a256(0x139)},'product':{'$push':_0x56a256(0x160)},'note':{'$first':_0x56a256(0x13b)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x56a256(0x164)},'expiry_date':{'$first':_0x56a256(0x135)},'suppliers_docs':{'$first':_0x56a256(0x152)},'total_product_quantity':{'$sum':_0x56a256(0x13a)},'level':{'$addToSet':_0x56a256(0x12d)},'isle':{'$addToSet':_0x56a256(0x143)},'type':{'$addToSet':_0x56a256(0x14f)},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x26c0e4},{'$limit':_0x58f566-_0x26c0e4}]),_0x268944[_0x56a256(0x150)](_0x3fe1e3);}catch(_0x1319dd){console[_0x56a256(0x145)](_0x56a256(0x136),_0x1319dd),_0x268944[_0x56a256(0x14b)](0xc8)[_0x56a256(0x150)]({'message':_0x1319dd[_0x56a256(0x154)]});}}),router[a0_0x4df804(0x13d)](a0_0x4df804(0x155),async(_0x11a968,_0x431967)=>{const _0x3c95df=a0_0x4df804,{product_code:_0x3ca6a4}=_0x11a968[_0x3c95df(0x138)];var _0x23b0f3;const _0x266c9e=await product[_0x3c95df(0x12b)]([{'$match':{'primary_code':_0x3ca6a4,'product_category':_0x3c95df(0x14a)}},{'$group':{'_id':_0x3c95df(0x12f),'name':{'$first':'$name'},'category':{'$first':_0x3c95df(0x13c)},'brand':{'$first':_0x3c95df(0x12a)},'unit':{'$first':_0x3c95df(0x149)},'alertquantity':{'$first':_0x3c95df(0x147)},'product_code':{'$first':_0x3c95df(0x130)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x3c95df(0x15d)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x3c95df(0x142)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x3c95df(0x14c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x2e2e17=await product[_0x3c95df(0x12b)]([{'$match':{'secondary_code':_0x3ca6a4,'product_category':_0x3c95df(0x14a)}},{'$group':{'_id':_0x3c95df(0x12f),'name':{'$first':'$name'},'category':{'$first':_0x3c95df(0x13c)},'brand':{'$first':'$brand'},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x3c95df(0x147)},'product_code':{'$first':_0x3c95df(0x130)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x3c95df(0x15d)},'maxStocks':{'$first':_0x3c95df(0x132)},'maxProdPerUnit':{'$first':_0x3c95df(0x142)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x266c9e[_0x3c95df(0x15f)]>0x0)_0x23b0f3=_0x266c9e;else _0x2e2e17[_0x3c95df(0x15f)]>0x0&&(_0x23b0f3=_0x2e2e17);_0x431967[_0x3c95df(0x150)](_0x23b0f3);}),module['exports']=router;function a0_0xad93(_0x54a4bd,_0x29addb){const _0x244b82=a0_0x244b();return a0_0xad93=function(_0xad93d4,_0x81740e){_0xad93d4=_0xad93d4-0x129;let _0x5bd818=_0x244b82[_0xad93d4];return _0x5bd818;},a0_0xad93(_0x54a4bd,_0x29addb);}function a0_0x244b(){const _0x3284ba=['496670laAPDF','$date','$warehouse_name','../middleware/auth','query','$secondary_code','Router','length','$product','418BpYDls','../models/all_models','$suppliers','$batch_code','$invoice','$brand','aggregate','913531JtPDSk','$product.bay','13JegVol','$_id','$product_code','path','$maxStocks','83718NEfEzO','153qYdqNN','$expiry_date','table\x20page','181415cQTaPg','body','$product.room_name','$product.quantity','$note','$category','post','suppliers','express','end','105cJvVdG','$maxProdPerUnit','$product.bin','112sllEnr','log','get','$alertquantity','../public/language/languages.json','$unit','Raw\x20Materials','status','$secondary_unit','95010YomVIS','ejs','$product.type','json','51789036RKcDRr','$suppliers_docs','115616dAyjXs','message','/barcode_scanner','nodemailer','33TNAWBz'];a0_0x244b=function(){return _0x3284ba;};return a0_0x244b();}