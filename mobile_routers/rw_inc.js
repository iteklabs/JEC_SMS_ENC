const a0_0x7a28b4=a0_0x5382;function a0_0x22cb(){const _0x1fcf37=['query','/view','$product.type','body','$name','110577UrCxgZ','../public/language/languages.json','name','8RJNztJ','Router','start','message','end','$product.floorlevel','$invoice','$product.room_name','17721650PXxPpD','aggregate','$product.quantity','$note','$secondary_code','$suppliers_docs','73578hMSDrw','/barcode_scanner','table\x20page','log','express','../middleware/auth','$product','753732IgHvsH','$primary_code','$warehouse_name','nodemailer','$brand','$product_code','$suppliers','3848972alaljL','$category','8023806znOpZj','$date','8grvdAl','Raw\x20Materials','get','$unit','$product.bay','post','$alertquantity','$_id','$batch_code','$maxProdPerUnit','$return_data','$paid_amount','$due_amount','json','$maxStocks','$finalize','path','115acMxSf','$expiry_date','suppliers','$secondary_unit','156730KwKrgn'];a0_0x22cb=function(){return _0x1fcf37;};return a0_0x22cb();}function a0_0x5382(_0x4ddb65,_0x507925){const _0x22cb33=a0_0x22cb();return a0_0x5382=function(_0x538237,_0x53f2b1){_0x538237=_0x538237-0x139;let _0x212b81=_0x22cb33[_0x538237];return _0x212b81;},a0_0x5382(_0x4ddb65,_0x507925);}(function(_0x5a4767,_0x27bed9){const _0x1a5409=a0_0x5382,_0x28abc4=_0x5a4767();while(!![]){try{const _0x4d69b0=parseInt(_0x1a5409(0x143))/0x1*(parseInt(_0x1a5409(0x158))/0x2)+-parseInt(_0x1a5409(0x15e))/0x3+parseInt(_0x1a5409(0x13f))/0x4+parseInt(_0x1a5409(0x154))/0x5*(-parseInt(_0x1a5409(0x16f))/0x6)+parseInt(_0x1a5409(0x176))/0x7*(parseInt(_0x1a5409(0x161))/0x8)+parseInt(_0x1a5409(0x141))/0x9+-parseInt(_0x1a5409(0x169))/0xa;if(_0x4d69b0===_0x27bed9)break;else _0x28abc4['push'](_0x28abc4['shift']());}catch(_0x58ca35){_0x28abc4['push'](_0x28abc4['shift']());}}}(a0_0x22cb,0x79694));const express=require(a0_0x7a28b4(0x173)),app=express(),router=express[a0_0x7a28b4(0x162)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x7a28b4(0x174)),nodemailer=require(a0_0x7a28b4(0x13b));var ejs=require('ejs');const path=require(a0_0x7a28b4(0x153)),users=require(a0_0x7a28b4(0x15f));router[a0_0x7a28b4(0x145)](a0_0x7a28b4(0x15a),async(_0x3bfb07,_0x481398)=>{const _0x169785=a0_0x7a28b4;try{const _0x449163=parseInt(_0x3bfb07[_0x169785(0x159)][_0x169785(0x163)])||0x0,_0x215626=parseInt(_0x3bfb07[_0x169785(0x159)][_0x169785(0x165)])||0xa;let _0x55f7dd;_0x55f7dd=await purchases['aggregate']([{'$lookup':{'from':_0x169785(0x156),'localField':_0x169785(0x156),'foreignField':_0x169785(0x160),'as':'suppliers_docs'}},{'$unwind':_0x169785(0x16e)},{'$unwind':_0x169785(0x175)},{'$group':{'_id':_0x169785(0x14a),'invoice':{'$first':_0x169785(0x167)},'suppliers':{'$first':_0x169785(0x13e)},'date':{'$first':_0x169785(0x142)},'warehouse_name':{'$first':_0x169785(0x13a)},'room':{'$addToSet':_0x169785(0x168)},'product':{'$push':_0x169785(0x175)},'note':{'$first':_0x169785(0x16c)},'paid_amount':{'$first':_0x169785(0x14e)},'due_amount':{'$first':_0x169785(0x14f)},'return_data':{'$first':_0x169785(0x14d)},'batch_code':{'$first':_0x169785(0x14b)},'expiry_date':{'$first':_0x169785(0x155)},'suppliers_docs':{'$first':_0x169785(0x16e)},'total_product_quantity':{'$sum':_0x169785(0x16b)},'level':{'$addToSet':_0x169785(0x147)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x169785(0x15b)},'floorlevel':{'$addToSet':_0x169785(0x166)},'finalize':{'$first':_0x169785(0x152)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x449163},{'$limit':_0x215626-_0x449163}]),_0x481398[_0x169785(0x150)](_0x55f7dd);}catch(_0x4cfeae){console[_0x169785(0x172)](_0x169785(0x171),_0x4cfeae),_0x481398['status'](0xc8)[_0x169785(0x150)]({'message':_0x4cfeae[_0x169785(0x164)]});}}),router[a0_0x7a28b4(0x148)](a0_0x7a28b4(0x170),async(_0x42f423,_0x14e19d)=>{const _0x19684f=a0_0x7a28b4,{product_code:_0x48b1fb}=_0x42f423[_0x19684f(0x15c)];var _0x518183;const _0x486fe2=await product[_0x19684f(0x16a)]([{'$match':{'primary_code':_0x48b1fb,'product_category':_0x19684f(0x144)}},{'$group':{'_id':_0x19684f(0x14a),'name':{'$first':_0x19684f(0x15d)},'category':{'$first':_0x19684f(0x140)},'brand':{'$first':_0x19684f(0x13c)},'unit':{'$first':_0x19684f(0x146)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x19684f(0x13d)},'primary_code':{'$first':_0x19684f(0x139)},'secondary_code':{'$first':_0x19684f(0x16d)},'maxStocks':{'$first':_0x19684f(0x151)},'maxProdPerUnit':{'$first':_0x19684f(0x14c)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x17199f=await product[_0x19684f(0x16a)]([{'$match':{'secondary_code':_0x48b1fb,'product_category':_0x19684f(0x144)}},{'$group':{'_id':'$_id','name':{'$first':_0x19684f(0x15d)},'category':{'$first':'$category'},'brand':{'$first':_0x19684f(0x13c)},'unit':{'$first':_0x19684f(0x146)},'alertquantity':{'$first':_0x19684f(0x149)},'product_code':{'$first':_0x19684f(0x13d)},'primary_code':{'$first':_0x19684f(0x139)},'secondary_code':{'$first':_0x19684f(0x16d)},'maxStocks':{'$first':_0x19684f(0x151)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x19684f(0x157)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x486fe2['length']>0x0)_0x518183=_0x486fe2;else _0x17199f['length']>0x0&&(_0x518183=_0x17199f);_0x14e19d[_0x19684f(0x150)](_0x518183);}),module['exports']=router;