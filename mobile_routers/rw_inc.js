const a0_0x4b893e=a0_0x19ec;(function(_0x1c674f,_0x299a2a){const _0x3fffe3=a0_0x19ec,_0x21887d=_0x1c674f();while(!![]){try{const _0x23f6cb=-parseInt(_0x3fffe3(0x206))/0x1*(parseInt(_0x3fffe3(0x1ed))/0x2)+-parseInt(_0x3fffe3(0x1e4))/0x3*(parseInt(_0x3fffe3(0x20a))/0x4)+parseInt(_0x3fffe3(0x205))/0x5+parseInt(_0x3fffe3(0x1da))/0x6*(parseInt(_0x3fffe3(0x1e0))/0x7)+-parseInt(_0x3fffe3(0x210))/0x8*(parseInt(_0x3fffe3(0x212))/0x9)+-parseInt(_0x3fffe3(0x1f2))/0xa*(-parseInt(_0x3fffe3(0x1fe))/0xb)+-parseInt(_0x3fffe3(0x1e1))/0xc;if(_0x23f6cb===_0x299a2a)break;else _0x21887d['push'](_0x21887d['shift']());}catch(_0x383802){_0x21887d['push'](_0x21887d['shift']());}}}(a0_0x2bb2,0xd9262));function a0_0x19ec(_0x3289e8,_0x5e1ea5){const _0x2bb236=a0_0x2bb2();return a0_0x19ec=function(_0x19ece8,_0x9533a5){_0x19ece8=_0x19ece8-0x1d8;let _0x5dbca3=_0x2bb236[_0x19ece8];return _0x5dbca3;},a0_0x19ec(_0x3289e8,_0x5e1ea5);}const express=require(a0_0x4b893e(0x1ec)),app=express(),router=express[a0_0x4b893e(0x1e7)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x4b893e(0x1de)),nodemailer=require(a0_0x4b893e(0x209));function a0_0x2bb2(){const _0x33e55b=['$date','$note','suppliers_docs','$product.quantity','exports','$paid_amount','$alertquantity','message','$suppliers','ejs','374HhVkUE','$maxStocks','name','aggregate','$product','$secondary_code','$name','6801265FCkPIo','3sZHlNR','$due_amount','Raw\x20Materials','nodemailer','4752196aZTbrj','$product.floorlevel','path','$brand','$invoice','$suppliers_docs','1463536MbrWqS','$category','9DVprVH','$secondary_unit','suppliers','$product.bay','start','body','6hgYbOi','$product_code','$product.bin','$unit','../middleware/auth','../public/language/languages.json','4516309KRAIQC','13311024ryjCvz','get','$_id','3yyBcvv','$finalize','log','Router','query','status','$primary_code','json','express','81286AOlRwk','post','/view','length','$maxProdPerUnit','437110JZwZlx','$warehouse_name'];a0_0x2bb2=function(){return _0x33e55b;};return a0_0x2bb2();}var ejs=require(a0_0x4b893e(0x1fd));const path=require(a0_0x4b893e(0x20c)),users=require(a0_0x4b893e(0x1df));router[a0_0x4b893e(0x1e2)](a0_0x4b893e(0x1ef),async(_0x41618a,_0x45c407)=>{const _0x46c7f1=a0_0x4b893e;try{const _0x37b48f=parseInt(_0x41618a['query'][_0x46c7f1(0x1d8)])||0x0,_0x45eaeb=parseInt(_0x41618a[_0x46c7f1(0x1e8)]['end'])||0xa;let _0x958980;_0x958980=await purchases['aggregate']([{'$lookup':{'from':_0x46c7f1(0x214),'localField':_0x46c7f1(0x214),'foreignField':_0x46c7f1(0x200),'as':_0x46c7f1(0x1f6)}},{'$unwind':_0x46c7f1(0x20f)},{'$unwind':'$product'},{'$group':{'_id':_0x46c7f1(0x1e3),'invoice':{'$first':_0x46c7f1(0x20e)},'suppliers':{'$first':_0x46c7f1(0x1fc)},'date':{'$first':_0x46c7f1(0x1f4)},'warehouse_name':{'$first':_0x46c7f1(0x1f3)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':_0x46c7f1(0x202)},'note':{'$first':_0x46c7f1(0x1f5)},'paid_amount':{'$first':_0x46c7f1(0x1f9)},'due_amount':{'$first':_0x46c7f1(0x207)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':'$suppliers_docs'},'total_product_quantity':{'$sum':_0x46c7f1(0x1f7)},'level':{'$addToSet':_0x46c7f1(0x215)},'isle':{'$addToSet':_0x46c7f1(0x1dc)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x46c7f1(0x20b)},'finalize':{'$first':_0x46c7f1(0x1e5)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x37b48f},{'$limit':_0x45eaeb-_0x37b48f}]),_0x45c407[_0x46c7f1(0x1eb)](_0x958980);}catch(_0x4e212d){console[_0x46c7f1(0x1e6)]('table\x20page',_0x4e212d),_0x45c407[_0x46c7f1(0x1e9)](0xc8)[_0x46c7f1(0x1eb)]({'message':_0x4e212d[_0x46c7f1(0x1fb)]});}}),router[a0_0x4b893e(0x1ee)]('/barcode_scanner',async(_0x29fdc5,_0x36ab43)=>{const _0x33b3a1=a0_0x4b893e,{product_code:_0xf4c91c}=_0x29fdc5[_0x33b3a1(0x1d9)];var _0x706563;const _0x34ee8a=await product[_0x33b3a1(0x201)]([{'$match':{'primary_code':_0xf4c91c,'product_category':_0x33b3a1(0x208)}},{'$group':{'_id':_0x33b3a1(0x1e3),'name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':_0x33b3a1(0x20d)},'unit':{'$first':_0x33b3a1(0x1dd)},'alertquantity':{'$first':_0x33b3a1(0x1fa)},'product_code':{'$first':_0x33b3a1(0x1db)},'primary_code':{'$first':_0x33b3a1(0x1ea)},'secondary_code':{'$first':_0x33b3a1(0x203)},'maxStocks':{'$first':_0x33b3a1(0x1ff)},'maxProdPerUnit':{'$first':_0x33b3a1(0x1f1)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x33b3a1(0x213)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x144ed7=await product['aggregate']([{'$match':{'secondary_code':_0xf4c91c,'product_category':_0x33b3a1(0x208)}},{'$group':{'_id':'$_id','name':{'$first':_0x33b3a1(0x204)},'category':{'$first':_0x33b3a1(0x211)},'brand':{'$first':'$brand'},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x33b3a1(0x1fa)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x33b3a1(0x1ea)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x33b3a1(0x1ff)},'maxProdPerUnit':{'$first':_0x33b3a1(0x1f1)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x33b3a1(0x213)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x34ee8a[_0x33b3a1(0x1f0)]>0x0)_0x706563=_0x34ee8a;else _0x144ed7['length']>0x0&&(_0x706563=_0x144ed7);_0x36ab43[_0x33b3a1(0x1eb)](_0x706563);}),module[a0_0x4b893e(0x1f8)]=router;