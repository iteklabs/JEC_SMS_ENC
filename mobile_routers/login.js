function a0_0x21f0(){const _0x2bb505=['465592pIDLcq','username','password','331311hTegaB','secret_key','json','staff','../middleware/auth','1999265RrjtZG','warehouse_category','your\x20email\x20is\x20not\x20register','sign','body','jwt','log','compare','9RUNJBo','3869168nbpmRm','2714574bMxhhm','email','2213379gfloYd','clearCookie','findOne','express','8RXhPFV','/logout','env','Disabled','get','jsonwebtoken','533704HOBeSJ','role','login\x20successfully.','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','Router','/login'];a0_0x21f0=function(){return _0x2bb505;};return a0_0x21f0();}const a0_0x103ab6=a0_0x3899;function a0_0x3899(_0xb9dd76,_0x593765){const _0x21f0e6=a0_0x21f0();return a0_0x3899=function(_0x389982,_0x3bbed7){_0x389982=_0x389982-0x6d;let _0x17740c=_0x21f0e6[_0x389982];return _0x17740c;},a0_0x3899(_0xb9dd76,_0x593765);}(function(_0x4ce2d8,_0x32eb06){const _0xa63711=a0_0x3899,_0x494bc1=_0x4ce2d8();while(!![]){try{const _0x1ce4a0=parseInt(_0xa63711(0x90))/0x1+parseInt(_0xa63711(0x8a))/0x2+-parseInt(_0xa63711(0x6f))/0x3*(parseInt(_0xa63711(0x84))/0x4)+parseInt(_0xa63711(0x74))/0x5+-parseInt(_0xa63711(0x7e))/0x6+parseInt(_0xa63711(0x80))/0x7+parseInt(_0xa63711(0x7d))/0x8*(-parseInt(_0xa63711(0x7c))/0x9);if(_0x1ce4a0===_0x32eb06)break;else _0x494bc1['push'](_0x494bc1['shift']());}catch(_0x24afbf){_0x494bc1['push'](_0x494bc1['shift']());}}}(a0_0x21f0,0x472d9));const express=require(a0_0x103ab6(0x83)),app=express(),router=express[a0_0x103ab6(0x8e)](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require('bcryptjs'),jwt=require(a0_0x103ab6(0x89)),auth=require(a0_0x103ab6(0x73));router['post'](a0_0x103ab6(0x8f),async(_0x537fb4,_0x86aa02)=>{const _0x18a5bc=a0_0x103ab6;try{const _0x55da96=_0x537fb4[_0x18a5bc(0x78)]['email'],_0x35b9d0=await sing_up[_0x18a5bc(0x82)]({'email':_0x55da96});!_0x35b9d0&&_0x86aa02[_0x18a5bc(0x71)]({'msgbox':_0x18a5bc(0x76)});const _0x2c0792=await staff[_0x18a5bc(0x82)]({'email':_0x35b9d0['email']});var _0x57e13b=_0x2c0792[_0x18a5bc(0x75)];if(_0x35b9d0['role']==_0x18a5bc(0x72)){const _0x5202c6=await staff[_0x18a5bc(0x82)]({'email':_0x35b9d0[_0x18a5bc(0x7f)]});_0x5202c6['status']==_0x18a5bc(0x87)&&_0x86aa02[_0x18a5bc(0x71)]({'msgbox':_0x18a5bc(0x8d),'data':_0x2c0792}),_0x57e13b=_0x5202c6[_0x18a5bc(0x75)];}const _0x33c683=_0x537fb4['body'][_0x18a5bc(0x6e)],_0x1b608b=await bcrypt[_0x18a5bc(0x7b)](_0x33c683,_0x35b9d0[_0x18a5bc(0x6e)]);_0x1b608b==![]&&_0x86aa02[_0x18a5bc(0x71)]({'msgbox':'login\x20failed.','token':null,'isValid':_0x1b608b,'data':null});const _0x39dab5=jwt[_0x18a5bc(0x77)]({'username':_0x35b9d0[_0x18a5bc(0x6d)],'email':_0x35b9d0[_0x18a5bc(0x7f)],'role':_0x35b9d0[_0x18a5bc(0x8b)],'warehouse_category':_0x57e13b},process[_0x18a5bc(0x86)][_0x18a5bc(0x70)]);_0x86aa02['cookie'](_0x18a5bc(0x79),_0x39dab5,{'expires':new Date(0xe677d213a700)}),_0x86aa02[_0x18a5bc(0x71)]({'msgbox':_0x18a5bc(0x8c),'token':_0x39dab5,'isValid':_0x1b608b,'data':_0x2c0792});}catch(_0x5541fd){console[_0x18a5bc(0x7a)](_0x5541fd);}}),router[a0_0x103ab6(0x88)](a0_0x103ab6(0x85),(_0x3cf96b,_0x29c9f2)=>{const _0xf9e558=a0_0x103ab6;_0x29c9f2[_0xf9e558(0x81)](_0xf9e558(0x79)),_0x29c9f2['redirect'](_0xf9e558(0x8f));}),module['exports']=router;