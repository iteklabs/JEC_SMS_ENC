const a0_0x491b66=a0_0x3da6;function a0_0x2098(){const _0x298559=['clearCookie','../middleware/auth','json','9smifcq','Disabled','log','post','/login','1141KluSfl','env','password','1835CpEcMP','jwt','2778pFGHgE','findOne','secret_key','Router','cookie','3809912KPQvkr','exports','express','17906ahhCXK','sign','username','body','1138344XQqcBg','login\x20successfully.','/logout','bcryptjs','your\x20email\x20is\x20not\x20register','3640iuSdDN','email','redirect','3044390JiQZDG','warehouse_category','6104868olmDqi','26OiSfmA','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.'];a0_0x2098=function(){return _0x298559;};return a0_0x2098();}(function(_0x2b83a1,_0x5dc671){const _0x2b6ece=a0_0x3da6,_0x57cc57=_0x2b83a1();while(!![]){try{const _0x303657=-parseInt(_0x2b6ece(0xce))/0x1*(parseInt(_0x2b6ece(0xdd))/0x2)+parseInt(_0x2b6ece(0xd2))/0x3+-parseInt(_0x2b6ece(0xd7))/0x4*(-parseInt(_0x2b6ece(0xea))/0x5)+parseInt(_0x2b6ece(0xec))/0x6*(parseInt(_0x2b6ece(0xe7))/0x7)+-parseInt(_0x2b6ece(0xf1))/0x8*(parseInt(_0x2b6ece(0xe2))/0x9)+-parseInt(_0x2b6ece(0xda))/0xa+parseInt(_0x2b6ece(0xdc))/0xb;if(_0x303657===_0x5dc671)break;else _0x57cc57['push'](_0x57cc57['shift']());}catch(_0x34bf3e){_0x57cc57['push'](_0x57cc57['shift']());}}}(a0_0x2098,0x50ab3));const express=require(a0_0x491b66(0xcd)),app=express(),router=express[a0_0x491b66(0xef)](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x491b66(0xd5)),jwt=require('jsonwebtoken'),auth=require(a0_0x491b66(0xe0));function a0_0x3da6(_0x422bba,_0x2c49b8){const _0x209864=a0_0x2098();return a0_0x3da6=function(_0x3da6f2,_0x2dba1b){_0x3da6f2=_0x3da6f2-0xcd;let _0x4c6e8f=_0x209864[_0x3da6f2];return _0x4c6e8f;},a0_0x3da6(_0x422bba,_0x2c49b8);}router[a0_0x491b66(0xe5)](a0_0x491b66(0xe6),async(_0xfbbc08,_0x356d2e)=>{const _0x558662=a0_0x491b66;try{const _0x3dffab=_0xfbbc08['body'][_0x558662(0xd8)],_0x1abd8d=await sing_up[_0x558662(0xed)]({'email':_0x3dffab});!_0x1abd8d&&_0x356d2e[_0x558662(0xe1)]({'msgbox':_0x558662(0xd6)});const _0x595877=await staff[_0x558662(0xed)]({'email':_0x1abd8d['email']});var _0x5c735c=_0x595877[_0x558662(0xdb)];if(_0x1abd8d['role']=='staff'){const _0x3180a8=await staff['findOne']({'email':_0x1abd8d['email']});_0x3180a8['status']==_0x558662(0xe3)&&_0x356d2e['json']({'msgbox':_0x558662(0xde),'data':_0x595877}),_0x5c735c=_0x3180a8[_0x558662(0xdb)];}const _0x4f45cd=_0xfbbc08[_0x558662(0xd1)][_0x558662(0xe9)],_0x327ace=await bcrypt['compare'](_0x4f45cd,_0x1abd8d[_0x558662(0xe9)]);_0x327ace==![]&&_0x356d2e['json']({'msgbox':'login\x20failed.','token':null,'isValid':_0x327ace,'data':null});const _0x366dd8=jwt[_0x558662(0xcf)]({'username':_0x1abd8d[_0x558662(0xd0)],'email':_0x1abd8d['email'],'role':_0x1abd8d['role'],'warehouse_category':_0x5c735c},process[_0x558662(0xe8)][_0x558662(0xee)]);_0x356d2e[_0x558662(0xf0)](_0x558662(0xeb),_0x366dd8,{'expires':new Date(0xe677d213a700)}),_0x356d2e['json']({'msgbox':_0x558662(0xd3),'token':_0x366dd8,'isValid':_0x327ace,'data':_0x595877});}catch(_0x4acaf9){console[_0x558662(0xe4)](_0x4acaf9);}}),router['get'](a0_0x491b66(0xd4),(_0x588c4c,_0x18be5c)=>{const _0x70efda=a0_0x491b66;_0x18be5c[_0x70efda(0xdf)](_0x70efda(0xeb)),_0x18be5c[_0x70efda(0xd9)](_0x70efda(0xe6));}),module[a0_0x491b66(0xf2)]=router;