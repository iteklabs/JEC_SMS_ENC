const a0_0x27b2b7=a0_0x3a59;function a0_0x44fe(){const _0x21d2b7=['/login','1110WaKZUL','secret_key','../models/all_models','sign','warehouse_category','2oLgIlP','password','compare','username','body','Disabled','json','env','jwt','email','staff','post','2642859NpUduh','2487940iPUOPw','status','/logout','role','34915455hKepvP','clearCookie','login\x20successfully.','1400432mvfUGa','11048YXTJnu','findOne','get','log','jsonwebtoken','2469264woxzEi','938660FjROqB','Router','cookie','your\x20email\x20is\x20not\x20register','redirect'];a0_0x44fe=function(){return _0x21d2b7;};return a0_0x44fe();}function a0_0x3a59(_0x3e15d2,_0xbbef37){const _0x44fea6=a0_0x44fe();return a0_0x3a59=function(_0x3a59a3,_0x4a2ca7){_0x3a59a3=_0x3a59a3-0xca;let _0x44edbc=_0x44fea6[_0x3a59a3];return _0x44edbc;},a0_0x3a59(_0x3e15d2,_0xbbef37);}(function(_0xda3d3,_0x1fccb4){const _0x630399=a0_0x3a59,_0x2eb374=_0xda3d3();while(!![]){try{const _0x5aed40=-parseInt(_0x630399(0xe4))/0x1*(parseInt(_0x630399(0xd9))/0x2)+-parseInt(_0x630399(0xca))/0x3+-parseInt(_0x630399(0xd3))/0x4*(parseInt(_0x630399(0xdf))/0x5)+-parseInt(_0x630399(0xd8))/0x6+-parseInt(_0x630399(0xcb))/0x7+-parseInt(_0x630399(0xd2))/0x8+parseInt(_0x630399(0xcf))/0x9;if(_0x5aed40===_0x1fccb4)break;else _0x2eb374['push'](_0x2eb374['shift']());}catch(_0x47f78b){_0x2eb374['push'](_0x2eb374['shift']());}}}(a0_0x44fe,0x7b37c));const express=require('express'),app=express(),router=express[a0_0x27b2b7(0xda)](),{sing_up,staff,profile,master_shop}=require(a0_0x27b2b7(0xe1)),bcrypt=require('bcryptjs'),jwt=require(a0_0x27b2b7(0xd7)),auth=require('../middleware/auth');router[a0_0x27b2b7(0xef)](a0_0x27b2b7(0xde),async(_0x5933ef,_0x4dbad4)=>{const _0x52808c=a0_0x27b2b7;try{const _0x5c2c88=_0x5933ef['body'][_0x52808c(0xed)],_0x2f76af=await sing_up[_0x52808c(0xd4)]({'email':_0x5c2c88});!_0x2f76af&&_0x4dbad4[_0x52808c(0xea)]({'msgbox':_0x52808c(0xdc)});const _0x5adefa=await staff[_0x52808c(0xd4)]({'email':_0x2f76af[_0x52808c(0xed)]});var _0x23d600=_0x5adefa[_0x52808c(0xe3)];if(_0x2f76af[_0x52808c(0xce)]==_0x52808c(0xee)){const _0x315f6b=await staff[_0x52808c(0xd4)]({'email':_0x2f76af['email']});_0x315f6b[_0x52808c(0xcc)]==_0x52808c(0xe9)&&_0x4dbad4[_0x52808c(0xea)]({'msgbox':'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','data':_0x5adefa}),_0x23d600=_0x315f6b[_0x52808c(0xe3)];}const _0x13220d=_0x5933ef[_0x52808c(0xe8)][_0x52808c(0xe5)],_0x525695=await bcrypt[_0x52808c(0xe6)](_0x13220d,_0x2f76af[_0x52808c(0xe5)]);_0x525695==![]&&_0x4dbad4[_0x52808c(0xea)]({'msgbox':'login\x20failed.','token':null,'isValid':_0x525695,'data':null});const _0x46ef93=jwt[_0x52808c(0xe2)]({'username':_0x2f76af[_0x52808c(0xe7)],'email':_0x2f76af[_0x52808c(0xed)],'role':_0x2f76af[_0x52808c(0xce)],'warehouse_category':_0x23d600},process[_0x52808c(0xeb)][_0x52808c(0xe0)]);_0x4dbad4[_0x52808c(0xdb)](_0x52808c(0xec),_0x46ef93,{'expires':new Date(0xe677d213a700)}),_0x4dbad4['json']({'msgbox':_0x52808c(0xd1),'token':_0x46ef93,'isValid':_0x525695,'data':_0x5adefa});}catch(_0xff71ec){console[_0x52808c(0xd6)](_0xff71ec);}}),router[a0_0x27b2b7(0xd5)](a0_0x27b2b7(0xcd),(_0x29a4e4,_0x33ba56)=>{const _0x50baa4=a0_0x27b2b7;_0x33ba56[_0x50baa4(0xd0)](_0x50baa4(0xec)),_0x33ba56[_0x50baa4(0xdd)](_0x50baa4(0xde));}),module['exports']=router;