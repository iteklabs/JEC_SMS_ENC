const a0_0x90e269=a0_0x1f46;function a0_0x5900(){const _0x2887b3=['160QHEkTG','secret_key','308341PVVVHR','staff','json','status','login\x20failed.','204370lOzNcT','get','email','username','jsonwebtoken','90WbWaLa','2VkHSOo','843633CqPIuz','653545EhDUkA','log','warehouse_category','/login','cookie','login\x20successfully.','findOne','jwt','your\x20email\x20is\x20not\x20register','sign','express','password','264oWgMnO','post','body','681486XoytHC','148302uDllZN','1361012opMrGI','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','role','../middleware/auth'];a0_0x5900=function(){return _0x2887b3;};return a0_0x5900();}(function(_0x4169d7,_0x443ebe){const _0x40801e=a0_0x1f46,_0x2e4c0c=_0x4169d7();while(!![]){try{const _0x272b28=-parseInt(_0x40801e(0x1c0))/0x1+-parseInt(_0x40801e(0x1be))/0x2*(parseInt(_0x40801e(0x1ab))/0x3)+parseInt(_0x40801e(0x1ad))/0x4+parseInt(_0x40801e(0x1b8))/0x5*(parseInt(_0x40801e(0x1bd))/0x6)+parseInt(_0x40801e(0x1ac))/0x7*(parseInt(_0x40801e(0x1cc))/0x8)+parseInt(_0x40801e(0x1bf))/0x9+parseInt(_0x40801e(0x1b1))/0xa*(-parseInt(_0x40801e(0x1b3))/0xb);if(_0x272b28===_0x443ebe)break;else _0x2e4c0c['push'](_0x2e4c0c['shift']());}catch(_0x3cca3e){_0x2e4c0c['push'](_0x2e4c0c['shift']());}}}(a0_0x5900,0x65d0b));function a0_0x1f46(_0x43fb17,_0x5a3cc2){const _0x59000e=a0_0x5900();return a0_0x1f46=function(_0x1f46aa,_0x52010e){_0x1f46aa=_0x1f46aa-0x1ab;let _0x56681b=_0x59000e[_0x1f46aa];return _0x56681b;},a0_0x1f46(_0x43fb17,_0x5a3cc2);}const express=require(a0_0x90e269(0x1ca)),app=express(),router=express['Router'](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require('bcryptjs'),jwt=require(a0_0x90e269(0x1bc)),auth=require(a0_0x90e269(0x1b0));router[a0_0x90e269(0x1cd)](a0_0x90e269(0x1c3),async(_0x5c3cad,_0x16fa94)=>{const _0x13fc22=a0_0x90e269;try{const _0x4f76f1=_0x5c3cad[_0x13fc22(0x1ce)][_0x13fc22(0x1ba)],_0x33dcc4=await sing_up[_0x13fc22(0x1c6)]({'email':_0x4f76f1});!_0x33dcc4&&_0x16fa94['json']({'msgbox':_0x13fc22(0x1c8)});const _0x477a79=await staff[_0x13fc22(0x1c6)]({'email':_0x33dcc4['email']});var _0xc1650=_0x477a79[_0x13fc22(0x1c2)];if(_0x33dcc4[_0x13fc22(0x1af)]==_0x13fc22(0x1b4)){const _0x11f2e3=await staff[_0x13fc22(0x1c6)]({'email':_0x33dcc4[_0x13fc22(0x1ba)]});_0x11f2e3[_0x13fc22(0x1b6)]=='Disabled'&&_0x16fa94[_0x13fc22(0x1b5)]({'msgbox':_0x13fc22(0x1ae),'data':_0x477a79}),_0xc1650=_0x11f2e3[_0x13fc22(0x1c2)];}const _0x8097a0=_0x5c3cad['body'][_0x13fc22(0x1cb)],_0x2e4408=await bcrypt['compare'](_0x8097a0,_0x33dcc4['password']);_0x2e4408==![]&&_0x16fa94[_0x13fc22(0x1b5)]({'msgbox':_0x13fc22(0x1b7),'token':null,'isValid':_0x2e4408,'data':null});const _0x1714ef=jwt[_0x13fc22(0x1c9)]({'username':_0x33dcc4[_0x13fc22(0x1bb)],'email':_0x33dcc4['email'],'role':_0x33dcc4['role'],'warehouse_category':_0xc1650},process['env'][_0x13fc22(0x1b2)]);_0x16fa94[_0x13fc22(0x1c4)](_0x13fc22(0x1c7),_0x1714ef,{'expires':new Date(0xe677d213a700)}),_0x16fa94[_0x13fc22(0x1b5)]({'msgbox':_0x13fc22(0x1c5),'token':_0x1714ef,'isValid':_0x2e4408,'data':_0x477a79});}catch(_0x43e7d4){console[_0x13fc22(0x1c1)](_0x43e7d4);}}),router[a0_0x90e269(0x1b9)]('/logout',(_0x5ba4c0,_0x167a17)=>{const _0x2d964a=a0_0x90e269;_0x167a17['clearCookie'](_0x2d964a(0x1c7)),_0x167a17['redirect']('/login');}),module['exports']=router;