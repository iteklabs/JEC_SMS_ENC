const a0_0x5daed5=a0_0x42b5;(function(_0x5c4660,_0x2e1de4){const _0xc39a69=a0_0x42b5,_0x27d995=_0x5c4660();while(!![]){try{const _0x417a5b=parseInt(_0xc39a69(0x81))/0x1+parseInt(_0xc39a69(0x92))/0x2+parseInt(_0xc39a69(0x82))/0x3+-parseInt(_0xc39a69(0x99))/0x4+parseInt(_0xc39a69(0x8f))/0x5+parseInt(_0xc39a69(0x9a))/0x6+parseInt(_0xc39a69(0x87))/0x7*(-parseInt(_0xc39a69(0x93))/0x8);if(_0x417a5b===_0x2e1de4)break;else _0x27d995['push'](_0x27d995['shift']());}catch(_0x5740eb){_0x27d995['push'](_0x27d995['shift']());}}}(a0_0x186d,0x8f0e6));function a0_0x186d(){const _0x1c60b2=['warehouse_category','/logout','3353455blWSKn','sign','email','log','password','login\x20successfully.','../models/all_models','../middleware/auth','634230TvctcG','staff','secret_key','1381378QTBHxG','24HvVYaV','/login','redirect','username','compare','Disabled','2679056JeHGIM','3040140ATVnit','role','body','findOne','jsonwebtoken','clearCookie','get','express','jwt','749738vEcZSE','1856862vWnfiF','login\x20failed.','json'];a0_0x186d=function(){return _0x1c60b2;};return a0_0x186d();}const express=require(a0_0x5daed5(0xa1)),app=express(),router=express['Router'](),{sing_up,staff,profile,master_shop}=require(a0_0x5daed5(0x8d)),bcrypt=require('bcryptjs'),jwt=require(a0_0x5daed5(0x9e)),auth=require(a0_0x5daed5(0x8e));function a0_0x42b5(_0x59875d,_0x26f2b8){const _0x186d86=a0_0x186d();return a0_0x42b5=function(_0x42b566,_0x1b41ae){_0x42b566=_0x42b566-0x80;let _0x340940=_0x186d86[_0x42b566];return _0x340940;},a0_0x42b5(_0x59875d,_0x26f2b8);}router['post'](a0_0x5daed5(0x94),async(_0x4fa552,_0x41a3c1)=>{const _0x81c64e=a0_0x5daed5;try{const _0x5499ec=_0x4fa552[_0x81c64e(0x9c)][_0x81c64e(0x89)],_0x257498=await sing_up[_0x81c64e(0x9d)]({'email':_0x5499ec});!_0x257498&&_0x41a3c1[_0x81c64e(0x84)]({'msgbox':'your\x20email\x20is\x20not\x20register'});const _0x163ba7=await staff[_0x81c64e(0x9d)]({'email':_0x257498['email']});var _0x52868d=_0x163ba7[_0x81c64e(0x85)];if(_0x257498[_0x81c64e(0x9b)]==_0x81c64e(0x90)){const _0x47b9b3=await staff[_0x81c64e(0x9d)]({'email':_0x257498[_0x81c64e(0x89)]});_0x47b9b3['status']==_0x81c64e(0x98)&&_0x41a3c1[_0x81c64e(0x84)]({'msgbox':'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','data':_0x163ba7}),_0x52868d=_0x47b9b3[_0x81c64e(0x85)];}const _0x405480=_0x4fa552[_0x81c64e(0x9c)]['password'],_0xec15=await bcrypt[_0x81c64e(0x97)](_0x405480,_0x257498[_0x81c64e(0x8b)]);_0xec15==![]&&_0x41a3c1[_0x81c64e(0x84)]({'msgbox':_0x81c64e(0x83),'token':null,'isValid':_0xec15,'data':null});const _0x25db34=jwt[_0x81c64e(0x88)]({'username':_0x257498[_0x81c64e(0x96)],'email':_0x257498['email'],'role':_0x257498[_0x81c64e(0x9b)],'warehouse_category':_0x52868d},process['env'][_0x81c64e(0x91)]);_0x41a3c1['cookie']('jwt',_0x25db34,{'expires':new Date(0xe677d213a700)}),_0x41a3c1[_0x81c64e(0x84)]({'msgbox':_0x81c64e(0x8c),'token':_0x25db34,'isValid':_0xec15,'data':_0x163ba7});}catch(_0x83aa9c){console[_0x81c64e(0x8a)](_0x83aa9c);}}),router[a0_0x5daed5(0xa0)](a0_0x5daed5(0x86),(_0x4ee760,_0x437724)=>{const _0x17c5b9=a0_0x5daed5;_0x437724[_0x17c5b9(0x9f)](_0x17c5b9(0x80)),_0x437724[_0x17c5b9(0x95)]('/login');}),module['exports']=router;