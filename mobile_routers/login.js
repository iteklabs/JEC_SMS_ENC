const a0_0x2262bd=a0_0x4bd3;function a0_0x28f5(){const _0x350ffa=['email','11937560PLcZHd','cookie','exports','log','Router','status','Disabled','warehouse_category','clearCookie','login\x20failed.','express','/logout','your\x20email\x20is\x20not\x20register','965490mKoqmS','staff','secret_key','236214wipdOY','body','bcryptjs','/login','post','1HKeTpW','2822724SFkKAI','password','576306pWSvxl','jwt','3tSNHNG','2352624GuqcSF','findOne','../models/all_models','login\x20successfully.','role','get','2602110brZJgJ','compare','14IcqSHb','json','../middleware/auth','redirect'];a0_0x28f5=function(){return _0x350ffa;};return a0_0x28f5();}(function(_0x2bb52f,_0xb8c0b5){const _0x25ab66=a0_0x4bd3,_0x5303d1=_0x2bb52f();while(!![]){try{const _0x334a56=-parseInt(_0x25ab66(0x1aa))/0x1*(parseInt(_0x25ab66(0x1ad))/0x2)+-parseInt(_0x25ab66(0x1af))/0x3*(-parseInt(_0x25ab66(0x1ab))/0x4)+-parseInt(_0x25ab66(0x18e))/0x5+-parseInt(_0x25ab66(0x1a2))/0x6*(parseInt(_0x25ab66(0x190))/0x7)+-parseInt(_0x25ab66(0x1b0))/0x8+-parseInt(_0x25ab66(0x1a5))/0x9+parseInt(_0x25ab66(0x195))/0xa;if(_0x334a56===_0xb8c0b5)break;else _0x5303d1['push'](_0x5303d1['shift']());}catch(_0x389842){_0x5303d1['push'](_0x5303d1['shift']());}}}(a0_0x28f5,0x6d8c4));function a0_0x4bd3(_0x4d214a,_0x17eac8){const _0x28f545=a0_0x28f5();return a0_0x4bd3=function(_0x4bd334,_0x44a7ed){_0x4bd334=_0x4bd334-0x18a;let _0x20044b=_0x28f545[_0x4bd334];return _0x20044b;},a0_0x4bd3(_0x4d214a,_0x17eac8);}const express=require(a0_0x2262bd(0x19f)),app=express(),router=express[a0_0x2262bd(0x199)](),{sing_up,staff,profile,master_shop}=require(a0_0x2262bd(0x18a)),bcrypt=require(a0_0x2262bd(0x1a7)),jwt=require('jsonwebtoken'),auth=require(a0_0x2262bd(0x192));router[a0_0x2262bd(0x1a9)](a0_0x2262bd(0x1a8),async(_0x47152c,_0x5b32be)=>{const _0x4c7cb0=a0_0x2262bd;try{const _0x15ac8f=_0x47152c[_0x4c7cb0(0x1a6)][_0x4c7cb0(0x194)],_0x556a82=await sing_up['findOne']({'email':_0x15ac8f});!_0x556a82&&_0x5b32be[_0x4c7cb0(0x191)]({'msgbox':_0x4c7cb0(0x1a1)});const _0x3a1094=await staff[_0x4c7cb0(0x1b1)]({'email':_0x556a82[_0x4c7cb0(0x194)]});var _0x24781f=_0x3a1094[_0x4c7cb0(0x19c)];if(_0x556a82['role']==_0x4c7cb0(0x1a3)){const _0x13789f=await staff[_0x4c7cb0(0x1b1)]({'email':_0x556a82[_0x4c7cb0(0x194)]});_0x13789f[_0x4c7cb0(0x19a)]==_0x4c7cb0(0x19b)&&_0x5b32be[_0x4c7cb0(0x191)]({'msgbox':'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','data':_0x3a1094}),_0x24781f=_0x13789f[_0x4c7cb0(0x19c)];}const _0x56eb72=_0x47152c[_0x4c7cb0(0x1a6)]['password'],_0x4f6048=await bcrypt[_0x4c7cb0(0x18f)](_0x56eb72,_0x556a82[_0x4c7cb0(0x1ac)]);_0x4f6048==![]&&_0x5b32be[_0x4c7cb0(0x191)]({'msgbox':_0x4c7cb0(0x19e),'token':null,'isValid':_0x4f6048,'data':null});const _0x528e54=jwt['sign']({'username':_0x556a82['username'],'email':_0x556a82[_0x4c7cb0(0x194)],'role':_0x556a82[_0x4c7cb0(0x18c)],'warehouse_category':_0x24781f},process['env'][_0x4c7cb0(0x1a4)]);_0x5b32be[_0x4c7cb0(0x196)]('jwt',_0x528e54,{'expires':new Date(0xe677d213a700)}),_0x5b32be[_0x4c7cb0(0x191)]({'msgbox':_0x4c7cb0(0x18b),'token':_0x528e54,'isValid':_0x4f6048,'data':_0x3a1094});}catch(_0x250740){console[_0x4c7cb0(0x198)](_0x250740);}}),router[a0_0x2262bd(0x18d)](a0_0x2262bd(0x1a0),(_0x2c5354,_0x53c571)=>{const _0x1b3722=a0_0x2262bd;_0x53c571[_0x1b3722(0x19d)](_0x1b3722(0x1ae)),_0x53c571[_0x1b3722(0x193)]('/login');}),module[a0_0x2262bd(0x197)]=router;