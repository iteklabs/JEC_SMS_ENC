var a0_0x1303ab=a0_0x5bc2;(function(_0x15e584,_0xe59d9a){var _0x86caff=a0_0x5bc2,_0x3bfbee=_0x15e584();while(!![]){try{var _0x219b7e=-parseInt(_0x86caff(0x1fb))/0x1+parseInt(_0x86caff(0x1fd))/0x2*(-parseInt(_0x86caff(0x179))/0x3)+-parseInt(_0x86caff(0x1b0))/0x4*(-parseInt(_0x86caff(0x209))/0x5)+-parseInt(_0x86caff(0x187))/0x6+parseInt(_0x86caff(0x24a))/0x7*(parseInt(_0x86caff(0x1a1))/0x8)+parseInt(_0x86caff(0x165))/0x9*(-parseInt(_0x86caff(0x152))/0xa)+parseInt(_0x86caff(0x25b))/0xb*(parseInt(_0x86caff(0x139))/0xc);if(_0x219b7e===_0xe59d9a)break;else _0x3bfbee['push'](_0x3bfbee['shift']());}catch(_0x184fce){_0x3bfbee['push'](_0x3bfbee['shift']());}}}(a0_0xd76b,0xb75d6));const express=require(a0_0x1303ab(0x15d)),app=express(),router=express[a0_0x1303ab(0x1dc)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require('../models/all_models'),auth=require('../middleware/auth'),nodemailer=require('nodemailer'),users=require(a0_0x1303ab(0x1b2)),mongoose=require(a0_0x1303ab(0x234));function a0_0xd76b(){var _0x4abb06=['<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','product_cat','date','/all_sales_finished/view','edit_sales_finished','email','product_name','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','Arabic\x20(ae)','/all_sales_finished/preview/','customer','<html><head><title></title>','final','313970TcCwCU','/barcode_scanner','$name','save','slice','/../public','primary_code','sale_qty','</h5>','sales\x20item\x20return\x20successfull','/invoice/:id','express','False','adjust_qty','True','Sales\x20Add\x20successfully','edit_sales_finished_view','<!DOCTYPE\x20html>','date_recieved','27nQqaAs','sales','image','for_categorize','expiry_date','maxPerUnit_QA','errors','English','$brand','_id','$customers_docs','map','params','roomNamed','undefined','Enabled','Email\x20sent\x20successfully','German','warehouse_id','group_ids','113871AxZFTi','primary_unit','</thead>','batch_code','maxperunit','maxProdPerUnit','maxProducts_QA','/barcode_scanner_auto_data','$sale_product.bin','id_transaction_from','$finalize','$product_details.room_name','\x20<>\x20','product_date','4015854bkgqmk','/preview/:id','\x20Name:\x20','$secondary_code','$warehouse_name','$room','foreach\x20newproduct','Arabic','OUT-','date_received','Hindi','add_sales_finished_logs','valueOf','/process/view','$product_details.product_name','message','product_stock','outgoing_invoice','received_amount','$maxStocks','Spanish','second_unit','product_code_QA','return_sale_QA','$product_details.primary_code','</span>','295544QtVExz','$sale_product.quantity','</body></html>','max_per_unit','Quality\x20Inspection','gmail','warehouse','$product_details.secondary_code','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','createTransport','return_qty','maxStocks','staff','<h5\x20style=\x22text-align:\x20left;\x22>','<strong>\x20Regards\x20</strong>','48452tyLVpk','split','../public/language/languages.json','\x20Order\x20Date\x20:\x20','unit','date_data','agent_id','Sales\x20Update\x20successfully','<table\x20style=\x22width:\x20100%\x20!important;\x22>','prod_invoice','padStart','sales_quantity_QA','$gross_price','batch_code_QA','$customer','secondary_code_QA','Logo.png','$alertquantity','invoice','forEach','maxProducts','\x20Date:\x20','/give_payment/:id','$sale_product.bay','$product_details.unit','product_name_QA1','Error\x20Occurs','return_sale_finished','concat','$product_details.bin','sales_category','/picking_list/pdf/','<span\x20style=\x22float:\x20right;\x22>','$note','catch','$sale_product.floorlevel','invoice_init','</table>','false','$product_details.expiry_date','LOG-OUT-','$product_details.production_date','There\x20is\x20','$product_details','Router','secondary_unit','$date','product_data','stock_data','post','add\x20post','here','getDate','</tbody>','all_sales_finished','level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','abs',',\x20Location:\x20','redirect','master','Portuguese','data_type','int','findOne','sendMail','$maxProdPerUnit','quantity','level2','currency','production_date','success','product_details','$_id','$product_details.product_code','412804FMFyVx','get','74SASJAg','$primary_code','logo','password','Finished\x20Goods','suppliers','name','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<hr\x20class=\x22my-3\x22>','log','toString','Enclosed','340gBJOaa','$return_data','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','all','min','sales_id','/view/:id','user','/all_sales/view','ObjectId','unit_QA','/upload/','/view/add_sale/product','$invoice','role','max','Received\x20Payment\x20For\x20Sale','secondary_code','body','room_name','primary_code_QA','prod_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','warehouse_id_detl','production_date_QA','$secondary_unit','match','$sales_category','push','status','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.bay','sales_quantity','/view','$product_details.uuid','English\x20(US)','$product_code','$product_details.gross_price','product_id','Sale\x20Return','stocks_QA','/view/add_sales/:id','<tr>','mongoose','find','bay','/view_log','prod_cat','</div>','$category','$sale_product','logs','Distributing\x20','due_amount','/view/add_sales_logs','\x20==\x20','return_data','own','Sale\x20Return\x20Mail','$product_details.secondary_unit','add_sales_finished','$sale_product.type','$product_details.type_products','return_sale','$product_details.floorlevel','203HMOSLz','stock','note',',\x20room:\x20','$product_details.maxPerUnit','currency_placement','sale_product','flash','Portuguese\x20(BR)','$product_details.product_cat','uuid','product','string','<h2>\x20','exports','finalize','$product_details.type','88vcVVpZ','$product_details.level','\x20</h2>','barcode\x20Product\x20master','all_sales_barcode','OUTF-','\x20Order\x20Number\x20:\x20','site_title','$product_details.invoice','$product_details.sales_category','return_qty_QA','French','sort','$product_details.date_recieved','<div>','</td>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','warehouse_name','Ambient','updateOne','maxPerUnit','out','$product_details.maxProducts','filter','$product_details.product_stock','gross_price','back','RoomAssigned','room','render','json','Return\x20Goods','getMonth','aggregate','findById','then','true','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','length','product_list','$product_details.storage','Chinese','$product_details.rack','/view/add_sales','2155116zLlelu','product_code','</tr>','</head><body>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.batch_code','expiry_date_QA','<h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$product_details._id','carton'];a0_0xd76b=function(){return _0x4abb06;};return a0_0xd76b();}router['get'](a0_0x1303ab(0x22a),auth,async(_0x34744f,_0x227968)=>{var _0x400863=a0_0x1303ab;try{const {username:_0x3e560d,email:_0xf255e0,role:_0x193bd2}=_0x34744f[_0x400863(0x210)],_0x29703f=_0x34744f['user'],_0xa261fd=await profile[_0x400863(0x1f0)]({'email':_0x29703f[_0x400863(0x149)]}),_0x12ed8b=await master_shop[_0x400863(0x235)]();let _0x6e2933;if(_0x29703f[_0x400863(0x217)]=='staff'){const _0x258d2b=await staff['findOne']({'email':_0x29703f[_0x400863(0x149)]});_0x6e2933=await sales_finished['aggregate']([{'$match':{'typeOfProducts':'own'}},{'$unwind':_0x400863(0x23b)},{'$group':{'_id':'$_id','invoice':{'$first':_0x400863(0x216)},'customers':{'$first':_0x400863(0x1be)},'date':{'$first':_0x400863(0x1de)},'warehouse_name':{'$first':_0x400863(0x18b)},'sale_product':{'$push':_0x400863(0x23b)},'note':{'$first':_0x400863(0x1d1)},'return_data':{'$first':_0x400863(0x20a)},'customers_docs':{'$first':_0x400863(0x16f)},'total_saleproduct_quantity':{'$sum':_0x400863(0x1a2)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x400863(0x246)},'pallet':{'$addToSet':_0x400863(0x1d3)},'finalize':{'$first':_0x400863(0x183)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x6e2933=await sales_finished[_0x400863(0x12e)]([{'$match':{'typeOfProducts':_0x400863(0x242)}},{'$unwind':_0x400863(0x23b)},{'$group':{'_id':_0x400863(0x1f9),'invoice':{'$first':_0x400863(0x216)},'customers':{'$first':_0x400863(0x1be)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x400863(0x18b)},'sale_product':{'$push':_0x400863(0x23b)},'note':{'$first':_0x400863(0x1d1)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x400863(0x16f)},'total_saleproduct_quantity':{'$sum':_0x400863(0x1a2)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x400863(0x181)},'type':{'$addToSet':_0x400863(0x246)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x400863(0x183)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x12ed8b[0x0][_0x400863(0x14b)]==_0x400863(0x22c)){var _0x44cda0=users['English'];console[_0x400863(0x206)](_0x44cda0);}else{if(_0x12ed8b[0x0][_0x400863(0x14b)]==_0x400863(0x191))var _0x44cda0=users[_0x400863(0x191)];else{if(_0x12ed8b[0x0]['language']==_0x400863(0x176))var _0x44cda0=users[_0x400863(0x176)];else{if(_0x12ed8b[0x0][_0x400863(0x14b)]==_0x400863(0x19b))var _0x44cda0=users['Spanish'];else{if(_0x12ed8b[0x0][_0x400863(0x14b)]==_0x400863(0x266))var _0x44cda0=users[_0x400863(0x266)];else{if(_0x12ed8b[0x0][_0x400863(0x14b)]=='Portuguese\x20(BR)')var _0x44cda0=users['Portuguese'];else{if(_0x12ed8b[0x0][_0x400863(0x14b)]==_0x400863(0x136))var _0x44cda0=users[_0x400863(0x136)];else{if(_0x12ed8b[0x0]['language']=='Arabic\x20(ae)')var _0x44cda0=users[_0x400863(0x18e)];}}}}}}}_0x227968[_0x400863(0x12a)](_0x400863(0x1e6),{'success':_0x34744f[_0x400863(0x251)](_0x400863(0x1f7)),'errors':_0x34744f[_0x400863(0x251)](_0x400863(0x16b)),'sales':_0x6e2933,'profile':_0xa261fd,'role':_0x29703f,'master_shop':_0x12ed8b,'language':_0x44cda0});}catch(_0x4eb8e5){console[_0x400863(0x206)](_0x4eb8e5);}}),router['get'](a0_0x1303ab(0x237),auth,async(_0x4b18ef,_0x4e485f)=>{var _0x218fc7=a0_0x1303ab;try{const {username:_0x4f9394,email:_0x3ca493,role:_0x4aaff5}=_0x4b18ef[_0x218fc7(0x210)],_0xdd42ca=_0x4b18ef[_0x218fc7(0x210)],_0x327a59=await profile[_0x218fc7(0x1f0)]({'email':_0xdd42ca[_0x218fc7(0x149)]}),_0x575ca9=await master_shop[_0x218fc7(0x235)]();let _0x4ab467;if(_0xdd42ca[_0x218fc7(0x217)]==_0x218fc7(0x1ad)){const _0x2ca9c3=await staff[_0x218fc7(0x1f0)]({'email':_0xdd42ca[_0x218fc7(0x149)]});_0x4ab467=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x218fc7(0x23c)}},{'$unwind':_0x218fc7(0x23b)},{'$group':{'_id':_0x218fc7(0x1f9),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x218fc7(0x1be)},'date':{'$first':_0x218fc7(0x1de)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x218fc7(0x23b)},'note':{'$first':'$note'},'return_data':{'$first':_0x218fc7(0x20a)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x218fc7(0x1a2)},'level':{'$addToSet':_0x218fc7(0x1c7)},'isle':{'$addToSet':_0x218fc7(0x181)},'type':{'$addToSet':_0x218fc7(0x246)},'pallet':{'$addToSet':_0x218fc7(0x1d3)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x4ab467=await sales_finished[_0x218fc7(0x12e)]([{'$match':{'typeOfProducts':_0x218fc7(0x23c)}},{'$unwind':_0x218fc7(0x23b)},{'$group':{'_id':_0x218fc7(0x1f9),'invoice':{'$first':_0x218fc7(0x216)},'customers':{'$first':_0x218fc7(0x1be)},'date':{'$first':_0x218fc7(0x1de)},'warehouse_name':{'$first':_0x218fc7(0x18b)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x218fc7(0x1d1)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x218fc7(0x1a2)},'level':{'$addToSet':_0x218fc7(0x1c7)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x218fc7(0x246)},'pallet':{'$addToSet':_0x218fc7(0x1d3)},'finalize':{'$first':_0x218fc7(0x183)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x575ca9[0x0][_0x218fc7(0x14b)]=='English\x20(US)'){var _0x381ece=users[_0x218fc7(0x16c)];console['log'](_0x381ece);}else{if(_0x575ca9[0x0][_0x218fc7(0x14b)]==_0x218fc7(0x191))var _0x381ece=users['Hindi'];else{if(_0x575ca9[0x0]['language']==_0x218fc7(0x176))var _0x381ece=users[_0x218fc7(0x176)];else{if(_0x575ca9[0x0]['language']=='Spanish')var _0x381ece=users[_0x218fc7(0x19b)];else{if(_0x575ca9[0x0]['language']==_0x218fc7(0x266))var _0x381ece=users[_0x218fc7(0x266)];else{if(_0x575ca9[0x0][_0x218fc7(0x14b)]==_0x218fc7(0x252))var _0x381ece=users[_0x218fc7(0x1ed)];else{if(_0x575ca9[0x0]['language']==_0x218fc7(0x136))var _0x381ece=users['Chinese'];else{if(_0x575ca9[0x0][_0x218fc7(0x14b)]==_0x218fc7(0x14d))var _0x381ece=users[_0x218fc7(0x18e)];}}}}}}}_0x4e485f[_0x218fc7(0x12a)]('all_sales_finished_logs',{'success':_0x4b18ef[_0x218fc7(0x251)](_0x218fc7(0x1f7)),'errors':_0x4b18ef['flash']('errors'),'sales':_0x4ab467,'profile':_0x327a59,'role':_0xdd42ca,'master_shop':_0x575ca9,'language':_0x381ece});}catch(_0x370fc1){console[_0x218fc7(0x206)](_0x370fc1);}});function a0_0x5bc2(_0x16d1c8,_0x12070f){var _0xd76b1b=a0_0xd76b();return a0_0x5bc2=function(_0x5bc2d8,_0x57d5d4){_0x5bc2d8=_0x5bc2d8-0x121;var _0x3b0e48=_0xd76b1b[_0x5bc2d8];return _0x3b0e48;},a0_0x5bc2(_0x16d1c8,_0x12070f);}async function getRandom8DigitNumber(){var _0x4d50c5=a0_0x1303ab;const _0x17beca=0x989680,_0x5e729e=0x5f5e0ff,_0x394aca=Math['floor'](Math['random']()*(_0x5e729e-_0x17beca+0x1))+_0x17beca;var _0x3bc4bb;const _0x108194=await sales_finished['findOne']({'invoice':_0x4d50c5(0x260)+_0x394aca});return _0x108194&&_0x108194[_0x4d50c5(0x133)]>0x0?_0x3bc4bb=_0x4d50c5(0x260)+_0x394aca:_0x3bc4bb=_0x4d50c5(0x260)+_0x394aca,_0x3bc4bb;}router['get'](a0_0x1303ab(0x138),auth,async(_0x68028,_0x3be20d)=>{var _0x27d66d=a0_0x1303ab;try{const {username:_0xa0eb10,email:_0x460024,role:_0x34fc7a}=_0x68028[_0x27d66d(0x210)],_0x4e913d=_0x68028[_0x27d66d(0x210)],_0x10f22e=await profile[_0x27d66d(0x1f0)]({'email':_0x4e913d[_0x27d66d(0x149)]}),_0x586d25=await master_shop[_0x27d66d(0x235)](),_0x2195c=await customer[_0x27d66d(0x235)]({});let _0x9bc73f;if(_0x4e913d[_0x27d66d(0x217)]==_0x27d66d(0x1ad)){const _0x2d0e20=await staff[_0x27d66d(0x1f0)]({'email':_0x4e913d['email']});_0x9bc73f=await warehouse[_0x27d66d(0x12e)]([{'$match':{'status':_0x27d66d(0x174),'name':_0x2d0e20[_0x27d66d(0x1a7)]}},{'$group':{'_id':_0x27d66d(0x154),'name':{'$first':_0x27d66d(0x154)}}},{'$sort':{'name':0x1}}]);}else _0x9bc73f=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x27d66d(0x154),'name':{'$first':_0x27d66d(0x154)}}},{'$sort':{'name':0x1}}]);const _0x53d15e=await product[_0x27d66d(0x235)]({});var _0x33ed86=['Ambient','Enclosed'];const _0x2cd6d5=await sales_finished['find']({}),_0x2b5196=_0x2cd6d5[_0x27d66d(0x133)]+0x1,_0x31e59c=_0x27d66d(0x260)+_0x2b5196[_0x27d66d(0x207)]()[_0x27d66d(0x1ba)](0x5,'0');if(_0x586d25[0x0][_0x27d66d(0x14b)]==_0x27d66d(0x22c)){var _0x3bfff8=users[_0x27d66d(0x16c)];console['log'](_0x3bfff8);}else{if(_0x586d25[0x0][_0x27d66d(0x14b)]==_0x27d66d(0x191))var _0x3bfff8=users[_0x27d66d(0x191)];else{if(_0x586d25[0x0][_0x27d66d(0x14b)]=='German')var _0x3bfff8=users[_0x27d66d(0x176)];else{if(_0x586d25[0x0][_0x27d66d(0x14b)]==_0x27d66d(0x19b))var _0x3bfff8=users['Spanish'];else{if(_0x586d25[0x0][_0x27d66d(0x14b)]==_0x27d66d(0x266))var _0x3bfff8=users[_0x27d66d(0x266)];else{if(_0x586d25[0x0][_0x27d66d(0x14b)]==_0x27d66d(0x252))var _0x3bfff8=users[_0x27d66d(0x1ed)];else{if(_0x586d25[0x0][_0x27d66d(0x14b)]==_0x27d66d(0x136))var _0x3bfff8=users[_0x27d66d(0x136)];else{if(_0x586d25[0x0]['language']==_0x27d66d(0x14d))var _0x3bfff8=users[_0x27d66d(0x18e)];}}}}}}}const _0x108b4f=getRandom8DigitNumber();_0x108b4f[_0x27d66d(0x130)](_0x39dadb=>{var _0x540621=_0x27d66d;_0x3be20d[_0x540621(0x12a)](_0x540621(0x245),{'success':_0x68028['flash'](_0x540621(0x1f7)),'errors':_0x68028[_0x540621(0x251)](_0x540621(0x16b)),'role':_0x4e913d,'profile':_0x10f22e,'customer':_0x2195c,'warehouse':_0x9bc73f,'product':_0x53d15e,'invoice':_0x39dadb,'master_shop':_0x586d25,'language':_0x3bfff8,'rooms_data':_0x33ed86});})[_0x27d66d(0x1d2)](_0x1f1129=>{var _0x1bb27c=_0x27d66d;_0x68028[_0x1bb27c(0x251)](_0x1bb27c(0x16b),_0x1bb27c(0x13d)),_0x3be20d['redirect'](_0x1bb27c(0x147));});}catch(_0x1aecf6){console['log'](_0x1aecf6);}}),router[a0_0x1303ab(0x1fc)](a0_0x1303ab(0x23f),auth,async(_0x375a8d,_0x5ba6db)=>{var _0x2e52c2=a0_0x1303ab;try{const {username:_0x52154d,email:_0x4416e6,role:_0x2a9201}=_0x375a8d[_0x2e52c2(0x210)],_0x3b0f3a=_0x375a8d['user'],_0x59e9fe=await profile[_0x2e52c2(0x1f0)]({'email':_0x3b0f3a['email']}),_0x514b8a=await master_shop[_0x2e52c2(0x235)](),_0xfddd29=await customer[_0x2e52c2(0x235)]({});let _0x88b8fc;if(_0x3b0f3a[_0x2e52c2(0x217)]==_0x2e52c2(0x1ad)){const _0x1d73c5=await staff[_0x2e52c2(0x1f0)]({'email':_0x3b0f3a['email']});_0x88b8fc=await warehouse['aggregate']([{'$match':{'status':_0x2e52c2(0x174),'name':_0x1d73c5[_0x2e52c2(0x1a7)]}},{'$group':{'_id':_0x2e52c2(0x154),'name':{'$first':_0x2e52c2(0x154)}}},{'$sort':{'name':0x1}}]);}else _0x88b8fc=await warehouse[_0x2e52c2(0x12e)]([{'$match':{'status':_0x2e52c2(0x174)}},{'$group':{'_id':_0x2e52c2(0x154),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x227fe4=await product[_0x2e52c2(0x235)]({});var _0x2baf1f=[_0x2e52c2(0x26d),'Enclosed'];const _0x5a7f3f=await sales_finished[_0x2e52c2(0x235)]({}),_0x33540d=_0x5a7f3f[_0x2e52c2(0x133)]+0x1,_0x1f4850=_0x2e52c2(0x260)+_0x33540d['toString']()[_0x2e52c2(0x1ba)](0x5,'0');if(_0x514b8a[0x0][_0x2e52c2(0x14b)]==_0x2e52c2(0x22c)){var _0x17cfa1=users['English'];console['log'](_0x17cfa1);}else{if(_0x514b8a[0x0]['language']==_0x2e52c2(0x191))var _0x17cfa1=users[_0x2e52c2(0x191)];else{if(_0x514b8a[0x0][_0x2e52c2(0x14b)]==_0x2e52c2(0x176))var _0x17cfa1=users[_0x2e52c2(0x176)];else{if(_0x514b8a[0x0][_0x2e52c2(0x14b)]==_0x2e52c2(0x19b))var _0x17cfa1=users[_0x2e52c2(0x19b)];else{if(_0x514b8a[0x0][_0x2e52c2(0x14b)]==_0x2e52c2(0x266))var _0x17cfa1=users[_0x2e52c2(0x266)];else{if(_0x514b8a[0x0][_0x2e52c2(0x14b)]==_0x2e52c2(0x252))var _0x17cfa1=users['Portuguese'];else{if(_0x514b8a[0x0]['language']==_0x2e52c2(0x136))var _0x17cfa1=users['Chinese'];else{if(_0x514b8a[0x0][_0x2e52c2(0x14b)]=='Arabic\x20(ae)')var _0x17cfa1=users[_0x2e52c2(0x18e)];}}}}}}}const _0x5a8493=getRandom8DigitNumber();_0x5a8493['then'](_0x40928d=>{var _0x35e18d=_0x2e52c2;_0x5ba6db[_0x35e18d(0x12a)](_0x35e18d(0x192),{'success':_0x375a8d[_0x35e18d(0x251)]('success'),'errors':_0x375a8d[_0x35e18d(0x251)](_0x35e18d(0x16b)),'role':_0x3b0f3a,'profile':_0x59e9fe,'customer':_0xfddd29,'warehouse':_0x88b8fc,'product':_0x227fe4,'invoice':_0x40928d,'master_shop':_0x514b8a,'language':_0x17cfa1,'rooms_data':_0x2baf1f});})['catch'](_0x3128ec=>{var _0x4398ef=_0x2e52c2;_0x375a8d[_0x4398ef(0x251)](_0x4398ef(0x16b),_0x4398ef(0x13d)),_0x5ba6db['redirect'](_0x4398ef(0x147));});}catch(_0x1043f1){console[_0x2e52c2(0x206)](_0x1043f1);}}),router[a0_0x1303ab(0x1e1)]('/view/add_sales_logs',auth,async(_0xf75ba2,_0x472922)=>{var _0x34a12c=a0_0x1303ab;try{const {invoice:_0x4597e7,date:_0x480744,warehouse_name:_0x48b91f,product_name:_0xcc8656,note:_0x403031,room:_0x4e43bd,primary_code:_0x19f020,secondary_code:_0x18e295,prod_code:_0x29504e,SCRN:_0x3be4f0,ReqBy:_0x1b2d81,dateofreq:_0x229758,PO_number:_0x357dda,typeservicesData:_0x5d4c04,typevehicle:_0x38317d,destination:_0x9b7a17,deliverydate:_0x57b1a1,driver:_0x3b78dc,plate:_0x20c232,van:_0x539672,DRSI:_0x2f5fad,TSU:_0x1e8ec7,TFU:_0x2614d6,mode_transpo:_0x4b56d4,name_driver:_0x37194f,type_of_products:_0x581e18}=_0xf75ba2[_0x34a12c(0x21b)];if(typeof _0xcc8656=='string')var _0x355731=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x14a)]],_0x55418e=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x24b)]],_0x48edc6=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x143)]],_0x276ad7=[_0xf75ba2['body'][_0x34a12c(0x158)]],_0xa6d179=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x21a)]],_0x278c9d=[_0xf75ba2['body'][_0x34a12c(0x21e)]],_0x2aa35c=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x1f4)]],_0x286ee2=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x17a)]],_0x38f107=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x1dd)]],_0x404e9d=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x17c)]],_0x329a3f=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x169)]],_0x2c76ef=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x186)]],_0x4c538c=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x1a4)]],_0x55daca=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x238)]],_0x83c699=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x128)]],_0x845316=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x1b9)]],_0x37ec53=[_0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x182)]],_0x1dd62c=[_0xf75ba2['body'][_0x34a12c(0x254)]],_0x3ed901=[_0xf75ba2['body'][_0x34a12c(0x126)]];else var _0x355731=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x14a)]],_0x55418e=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x24b)]],_0x48edc6=[..._0xf75ba2[_0x34a12c(0x21b)]['carton']],_0x276ad7=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x158)]],_0xa6d179=[..._0xf75ba2['body']['secondary_code']],_0x278c9d=[..._0xf75ba2[_0x34a12c(0x21b)]['prod_code']],_0x2aa35c=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x1f4)]],_0x286ee2=[..._0xf75ba2[_0x34a12c(0x21b)]['primary_unit']],_0x38f107=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x1dd)]],_0x404e9d=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x17c)]],_0x329a3f=[..._0xf75ba2['body'][_0x34a12c(0x169)]],_0x2c76ef=[..._0xf75ba2['body'][_0x34a12c(0x186)]],_0x4c538c=[..._0xf75ba2['body']['max_per_unit']],_0x55daca=[..._0xf75ba2[_0x34a12c(0x21b)]['prod_cat']],_0x83c699=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x128)]],_0x845316=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x1b9)]],_0x37ec53=[..._0xf75ba2['body'][_0x34a12c(0x182)]],_0x1dd62c=[..._0xf75ba2[_0x34a12c(0x21b)]['uuid']],_0x3ed901=[..._0xf75ba2[_0x34a12c(0x21b)][_0x34a12c(0x126)]];const _0x2bb046=_0x355731[_0x34a12c(0x170)](_0x2903db=>{return _0x2903db={'product_name':_0x2903db};});_0x55418e[_0x34a12c(0x1c3)]((_0x459236,_0x3214ae)=>{_0x2bb046[_0x3214ae]['stock']=_0x459236;}),_0x48edc6[_0x34a12c(0x1c3)]((_0x5668e3,_0x3a8034)=>{var _0x5b816d=_0x34a12c;_0x2bb046[_0x3a8034][_0x5b816d(0x1f3)]=Math[_0x5b816d(0x1e9)](_0x5668e3);}),_0x355731[_0x34a12c(0x1c3)]((_0x23ac76,_0x30ebb5)=>{var _0x3e419a=_0x34a12c;_0x2bb046[_0x30ebb5]['agent_id']=_0xf75ba2[_0x3e419a(0x21b)][_0x3e419a(0x166)];}),_0x3ed901[_0x34a12c(0x1c3)]((_0x508ef5,_0x527bb8)=>{var _0x2083f9=_0x34a12c;_0x2bb046[_0x527bb8][_0x2083f9(0x126)]=_0x508ef5;}),_0x1dd62c['forEach']((_0x55eda1,_0x3f121e)=>{var _0x490963=_0x34a12c;_0x2bb046[_0x3f121e][_0x490963(0x254)]=_0x55eda1;}),_0x37ec53['forEach']((_0x4efb7e,_0x28fde4)=>{_0x2bb046[_0x28fde4]['id_transaction_from']=_0x4efb7e;}),_0x276ad7[_0x34a12c(0x1c3)]((_0x25a7d8,_0x4718ea)=>{_0x2bb046[_0x4718ea]['primary_code']=_0x25a7d8;}),_0xa6d179[_0x34a12c(0x1c3)]((_0x16b778,_0x3a3c7e)=>{_0x2bb046[_0x3a3c7e]['secondary_code']=_0x16b778;}),_0x278c9d[_0x34a12c(0x1c3)]((_0x17933f,_0x151b08)=>{var _0x4eea51=_0x34a12c;_0x2bb046[_0x151b08][_0x4eea51(0x13a)]=_0x17933f;}),_0x2aa35c[_0x34a12c(0x1c3)]((_0x43b3ae,_0x2b73f1)=>{var _0x34f0d5=_0x34a12c,_0x325250=_0x43b3ae[_0x34f0d5(0x223)](/[A-Za-z]+/)[0x0],_0x972adc=parseInt(_0x43b3ae[_0x34f0d5(0x223)](/\d+/)[0x0]);_0x2bb046[_0x2b73f1]['bay']=_0x972adc,_0x2bb046[_0x2b73f1][_0x34f0d5(0x1e7)]=_0x325250;}),_0x286ee2['forEach']((_0x1f3394,_0x80664e)=>{var _0x3bfa86=_0x34a12c;_0x2bb046[_0x80664e][_0x3bfa86(0x1b4)]=_0x1f3394;}),_0x38f107[_0x34a12c(0x1c3)]((_0x3629f0,_0x2e4088)=>{var _0x15b819=_0x34a12c;_0x2bb046[_0x2e4088][_0x15b819(0x1dd)]=_0x3629f0;}),_0x404e9d[_0x34a12c(0x1c3)]((_0x517248,_0x54a3e1)=>{_0x2bb046[_0x54a3e1]['batch_code']=_0x517248;}),_0x329a3f[_0x34a12c(0x1c3)]((_0x4ca83c,_0x1ecabc)=>{var _0x222629=_0x34a12c;_0x2bb046[_0x1ecabc][_0x222629(0x169)]=_0x4ca83c;}),_0x2c76ef['forEach']((_0x3dd75d,_0x320eb4)=>{var _0x815c51=_0x34a12c;_0x2bb046[_0x320eb4][_0x815c51(0x1f6)]=_0x3dd75d;}),_0x4c538c[_0x34a12c(0x1c3)]((_0x55c330,_0xf34b8c)=>{var _0x15cde4=_0x34a12c;_0x2bb046[_0xf34b8c][_0x15cde4(0x17d)]=_0x55c330;}),_0x55daca[_0x34a12c(0x1c3)]((_0x7cb508,_0x3d0183)=>{var _0x4a63a5=_0x34a12c;_0x2bb046[_0x3d0183][_0x4a63a5(0x238)]=_0x7cb508;}),_0x83c699[_0x34a12c(0x1c3)]((_0x51a001,_0x4ac37e)=>{_0x2bb046[_0x4ac37e]['room_name']=_0x51a001;}),_0x845316[_0x34a12c(0x1c3)]((_0x25cc98,_0x30f17b)=>{var _0x4f749c=_0x34a12c;_0x2bb046[_0x30f17b][_0x4f749c(0x1c2)]=_0x25cc98,_0x2bb046[_0x30f17b]['date_data']=_0x480744;});const _0x468790=new sales_logs();await _0x468790[_0x34a12c(0x155)](),_0x845316['forEach']((_0x46a23f,_0x4e36e0)=>{var _0x5a9530=_0x34a12c;_0x2bb046[_0x4e36e0][_0x5a9530(0x198)]=_0x5a9530(0x1d8)+_0x468790[_0x5a9530(0x1d4)]['toString']()[_0x5a9530(0x1ba)](0x8,'0');});var _0x505485=0x0;_0x2bb046[_0x34a12c(0x1c3)](_0x5bb0c6=>{var _0x42c8ee=_0x34a12c;parseFloat(_0x5bb0c6[_0x42c8ee(0x24b)])<parseFloat(_0x5bb0c6[_0x42c8ee(0x1f3)])&&parseFloat(_0x5bb0c6[_0x42c8ee(0x1f3)])>parseFloat(_0x5bb0c6['stock'])&&(console[_0x42c8ee(0x206)](_0x5bb0c6[_0x42c8ee(0x24b)]+'\x20<>\x20'+_0x5bb0c6[_0x42c8ee(0x1f3)]),_0x505485++);});if(_0x505485!=0x0)return _0xf75ba2[_0x34a12c(0x251)](_0x34a12c(0x16b),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x472922[_0x34a12c(0x1eb)](_0x34a12c(0x127));const _0x1c8d61=_0x2bb046[_0x34a12c(0x124)](_0x4ce5e7=>_0x4ce5e7[_0x34a12c(0x1f3)]!=='0'&&_0x4ce5e7[_0x34a12c(0x1f3)]!==''),_0x3355fc=new sales_finished({'invoice':_0x34a12c(0x1d8)+_0x468790['invoice_init'][_0x34a12c(0x207)]()[_0x34a12c(0x1ba)](0x8,'0'),'sales_data':_0xf75ba2['body']['sales'],'customer':_0xf75ba2[_0x34a12c(0x21b)]['customer'],'date':_0x480744,'warehouse_name':_0x48b91f,'sale_product':_0x1c8d61,'note':_0x403031,'room':_0x4e43bd,'primary_code':_0x19f020,'secondary_code':_0x18e295,'prod_code':_0x29504e,'SCRN':_0x3be4f0,'finalize':_0x34a12c(0x15e),'mode_transpo':_0x4b56d4,'name_driver':_0x37194f,'ReqBy':_0x1b2d81,'dateofreq':_0x229758,'PO_number':_0x357dda,'typeservicesData':_0x5d4c04,'typevehicle':_0x38317d,'destination':_0x9b7a17,'deliverydate':_0x57b1a1,'driver':_0x3b78dc,'plate':_0x20c232,'van':_0x539672,'DRSI':_0x2f5fad,'TSU':_0x1e8ec7,'TFU':_0x2614d6,'typeOfProducts':_0x581e18}),_0x540128=await _0x3355fc[_0x34a12c(0x155)](),_0x5cdddf=await sales_finished[_0x34a12c(0x1f0)]({'invoice':_0x4597e7});_0xf75ba2[_0x34a12c(0x251)](_0x34a12c(0x1f7),'Sales\x20Add\x20successfully'),_0x472922['redirect'](_0x34a12c(0x14e)+_0x540128['_id']);}catch(_0x21b72a){console[_0x34a12c(0x206)](_0x21b72a);}}),router[a0_0x1303ab(0x1fc)](a0_0x1303ab(0x232),auth,async(_0x26e586,_0x4beeba)=>{var _0x27fbd1=a0_0x1303ab;try{const _0x1a424e=_0x26e586[_0x27fbd1(0x171)]['id'];console[_0x27fbd1(0x206)](_0x1a424e);const _0x4bf11d=await product[_0x27fbd1(0x235)](),_0x29f7b5=await purchases[_0x27fbd1(0x12e)]([{'$match':{'warehouse_name':_0x1a424e}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]);console[_0x27fbd1(0x206)]('purchases_data',_0x29f7b5),_0x4beeba['status'](0xc8)['json']({'purchases_data':_0x29f7b5,'product_data':_0x4bf11d});}catch(_0x4eaeba){console[_0x27fbd1(0x206)](_0x4eaeba);}}),router[a0_0x1303ab(0x1e1)](a0_0x1303ab(0x215),auth,async(_0x49fbb1,_0x14f36a)=>{var _0x410c6d=a0_0x1303ab;try{const {warehouse_data:_0x595ae2,product_data:_0x28bb0a}=_0x49fbb1[_0x410c6d(0x21b)];console[_0x410c6d(0x206)](_0x49fbb1[_0x410c6d(0x21b)][_0x410c6d(0x1df)]);;const _0x1ef608=await master_shop['find']();console[_0x410c6d(0x206)](_0x410c6d(0x1ec),_0x1ef608);const _0x1b968d=await product['findOne']({'name':_0x28bb0a});console[_0x410c6d(0x206)](_0x410c6d(0x255),_0x1b968d);const _0x3a1ee7=await warehouse[_0x410c6d(0x12e)]([{'$match':{'name':_0x595ae2}},{'$unwind':_0x410c6d(0x1db)},{'$match':{'product_details.product_name':_0x28bb0a}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x410c6d(0x125)}}}]);console[_0x410c6d(0x206)](_0x410c6d(0x1e0),_0x3a1ee7),_0x14f36a[_0x410c6d(0x226)](0xc8)[_0x410c6d(0x12b)]({'master':_0x1ef608,'new_product':_0x1b968d,'stock_data':_0x3a1ee7});}catch(_0x131bbb){console['log'](_0x131bbb);}}),router[a0_0x1303ab(0x1e1)](a0_0x1303ab(0x138),auth,async(_0x19267a,_0x201345)=>{var _0x2a4b12=a0_0x1303ab;try{const {invoice:_0x5d4ec0,date:_0x5e4cb4,warehouse_name:_0x24f17a,product_name:_0x7355ce,note:_0x928ebb,room:_0x563f20,primary_code:_0x5416df,secondary_code:_0x5320b5,prod_code:_0xd669c6,SCRN:_0x501c7f,ReqBy:_0x191c21,dateofreq:_0x2ac76d,PO_number:_0xd146c4,typeservicesData:_0x3705cb,typevehicle:_0x2c34f0,destination:_0x2ed933,deliverydate:_0x1dcb23,driver:_0x631e18,plate:_0x48435c,van:_0x50d63f,DRSI:_0x35f4c0,TSU:_0x4d1585,TFU:_0x1c2837,mode_transpo:_0x274ce8,name_driver:_0x2b686f,pull_out_date:_0x485c23,actual_delivery_date:_0x443e06}=_0x19267a['body'];_0x201345['json'](_0x19267a[_0x2a4b12(0x21b)]);return;if(typeof _0x7355ce=='string')var _0x2fbbb6=[_0x19267a['body'][_0x2a4b12(0x14a)]],_0x439c7e=[_0x19267a['body'][_0x2a4b12(0x24b)]],_0x467fa4=[_0x19267a['body'][_0x2a4b12(0x143)]],_0x31fc82=[_0x19267a['body'][_0x2a4b12(0x158)]],_0x4b9dce=[_0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x21a)]],_0x4bcc7a=[_0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x21e)]],_0x5b2f63=[_0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x1f4)]],_0x12eb9e=[_0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x17a)]],_0x3bd39b=[_0x19267a[_0x2a4b12(0x21b)]['secondary_unit']],_0x47c066=[_0x19267a['body']['batch_code']],_0xdb4818=[_0x19267a[_0x2a4b12(0x21b)]['expiry_date']],_0x4f24c4=[_0x19267a['body'][_0x2a4b12(0x186)]],_0x10b679=[_0x19267a['body']['max_per_unit']],_0xab95b4=[_0x19267a[_0x2a4b12(0x21b)]['prod_cat']],_0x410bb5=[_0x19267a['body'][_0x2a4b12(0x128)]],_0x325197=[_0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x1b9)]],_0x1fe972=[_0x19267a[_0x2a4b12(0x21b)]['id_transaction_from']],_0x335fda=[_0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x254)]],_0x37cb61=[_0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x126)]];else var _0x2fbbb6=[..._0x19267a[_0x2a4b12(0x21b)]['product_name']],_0x439c7e=[..._0x19267a[_0x2a4b12(0x21b)]['stock']],_0x467fa4=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x143)]],_0x31fc82=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x158)]],_0x4b9dce=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x21a)]],_0x4bcc7a=[..._0x19267a[_0x2a4b12(0x21b)]['prod_code']],_0x5b2f63=[..._0x19267a['body']['level2']],_0x12eb9e=[..._0x19267a[_0x2a4b12(0x21b)]['primary_unit']],_0x3bd39b=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x1dd)]],_0x47c066=[..._0x19267a['body'][_0x2a4b12(0x17c)]],_0xdb4818=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x169)]],_0x4f24c4=[..._0x19267a['body']['product_date']],_0x10b679=[..._0x19267a['body']['max_per_unit']],_0xab95b4=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x238)]],_0x410bb5=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x128)]],_0x325197=[..._0x19267a['body'][_0x2a4b12(0x1b9)]],_0x1fe972=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x182)]],_0x335fda=[..._0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x254)]],_0x37cb61=[..._0x19267a['body'][_0x2a4b12(0x126)]];const _0x3a7d35=_0x2fbbb6[_0x2a4b12(0x170)](_0x993c58=>{return _0x993c58={'product_name':_0x993c58};});_0x439c7e[_0x2a4b12(0x1c3)]((_0x36dea8,_0x3e60b5)=>{_0x3a7d35[_0x3e60b5]['stock']=_0x36dea8;}),_0x467fa4[_0x2a4b12(0x1c3)]((_0x543ce8,_0x56e0bd)=>{var _0x21d279=_0x2a4b12;_0x3a7d35[_0x56e0bd][_0x21d279(0x1f3)]=Math[_0x21d279(0x1e9)](_0x543ce8);}),_0x2fbbb6['forEach']((_0x26c768,_0x10cab8)=>{var _0xa74d3d=_0x2a4b12;_0x3a7d35[_0x10cab8][_0xa74d3d(0x1b6)]=_0x19267a[_0xa74d3d(0x21b)]['sales'];}),_0x37cb61[_0x2a4b12(0x1c3)]((_0x341321,_0x25eb43)=>{_0x3a7d35[_0x25eb43]['gross_price']=_0x341321;}),_0x335fda['forEach']((_0x329915,_0x4df8c2)=>{_0x3a7d35[_0x4df8c2]['uuid']=_0x329915;}),_0x1fe972[_0x2a4b12(0x1c3)]((_0x2ea887,_0x3b150c)=>{var _0x14f558=_0x2a4b12;_0x3a7d35[_0x3b150c][_0x14f558(0x182)]=_0x2ea887;}),_0x31fc82[_0x2a4b12(0x1c3)]((_0x461f50,_0x564558)=>{var _0x55c734=_0x2a4b12;_0x3a7d35[_0x564558][_0x55c734(0x158)]=_0x461f50;}),_0x4b9dce[_0x2a4b12(0x1c3)]((_0x1405a9,_0x16fa53)=>{var _0x40564b=_0x2a4b12;_0x3a7d35[_0x16fa53][_0x40564b(0x21a)]=_0x1405a9;}),_0x4bcc7a['forEach']((_0x1f6201,_0x352a30)=>{var _0x5cf68b=_0x2a4b12;_0x3a7d35[_0x352a30][_0x5cf68b(0x13a)]=_0x1f6201;}),_0x5b2f63[_0x2a4b12(0x1c3)]((_0x50862d,_0x5b64a5)=>{var _0x1e5dd5=_0x2a4b12,_0x425c37=_0x50862d[_0x1e5dd5(0x223)](/[A-Za-z]+/)[0x0],_0x3d0737=parseInt(_0x50862d[_0x1e5dd5(0x223)](/\d+/)[0x0]);_0x3a7d35[_0x5b64a5][_0x1e5dd5(0x236)]=_0x3d0737,_0x3a7d35[_0x5b64a5][_0x1e5dd5(0x1e7)]=_0x425c37;}),_0x12eb9e[_0x2a4b12(0x1c3)]((_0x4f6e88,_0x1eafdf)=>{var _0x51e9ca=_0x2a4b12;_0x3a7d35[_0x1eafdf][_0x51e9ca(0x1b4)]=_0x4f6e88;}),_0x3bd39b[_0x2a4b12(0x1c3)]((_0x5e0c06,_0x1835fc)=>{var _0x59cc24=_0x2a4b12;_0x3a7d35[_0x1835fc][_0x59cc24(0x1dd)]=_0x5e0c06;}),_0x47c066['forEach']((_0xe09548,_0x1937f9)=>{var _0xa34c4c=_0x2a4b12;_0x3a7d35[_0x1937f9][_0xa34c4c(0x17c)]=_0xe09548;}),_0xdb4818[_0x2a4b12(0x1c3)]((_0x16500b,_0x42f5e6)=>{var _0x522bd1=_0x2a4b12;_0x3a7d35[_0x42f5e6][_0x522bd1(0x169)]=_0x16500b;}),_0x4f24c4[_0x2a4b12(0x1c3)]((_0x698deb,_0x4d2d8a)=>{var _0x1b9cea=_0x2a4b12;_0x3a7d35[_0x4d2d8a][_0x1b9cea(0x1f6)]=_0x698deb;}),_0x10b679['forEach']((_0x533c11,_0x3508e8)=>{var _0x4c3fd5=_0x2a4b12;_0x3a7d35[_0x3508e8][_0x4c3fd5(0x17d)]=_0x533c11;}),_0xab95b4[_0x2a4b12(0x1c3)]((_0x2292c2,_0x2aa187)=>{var _0x22818f=_0x2a4b12;_0x3a7d35[_0x2aa187][_0x22818f(0x238)]=_0x2292c2;}),_0x410bb5[_0x2a4b12(0x1c3)]((_0xe0f605,_0x5bb9cd)=>{var _0x247631=_0x2a4b12;_0x3a7d35[_0x5bb9cd][_0x247631(0x21c)]=_0xe0f605;}),_0x325197[_0x2a4b12(0x1c3)]((_0x3250ef,_0x5dc7ae)=>{var _0xd95227=_0x2a4b12;_0x3a7d35[_0x5dc7ae][_0xd95227(0x1c2)]=_0x3250ef,_0x3a7d35[_0x5dc7ae][_0xd95227(0x1b5)]=_0x5e4cb4;});const _0x484b76=new invoice_for_outgoing();await _0x484b76[_0x2a4b12(0x155)](),_0x325197[_0x2a4b12(0x1c3)]((_0x10d793,_0x348f99)=>{var _0x4adb12=_0x2a4b12;_0x3a7d35[_0x348f99][_0x4adb12(0x198)]='OUT-'+_0x484b76['invoice_init'][_0x4adb12(0x207)]()[_0x4adb12(0x1ba)](0x8,'0');});var _0x53bd1c=0x0;_0x3a7d35[_0x2a4b12(0x1c3)](_0x35794c=>{var _0x4efaf3=_0x2a4b12;parseFloat(_0x35794c[_0x4efaf3(0x24b)])<parseFloat(_0x35794c['quantity'])&&parseFloat(_0x35794c[_0x4efaf3(0x1f3)])>parseFloat(_0x35794c[_0x4efaf3(0x24b)])&&(console[_0x4efaf3(0x206)](_0x35794c[_0x4efaf3(0x24b)]+_0x4efaf3(0x185)+_0x35794c[_0x4efaf3(0x1f3)]),_0x53bd1c++);});if(_0x53bd1c!=0x0)return _0x19267a[_0x2a4b12(0x251)](_0x2a4b12(0x16b),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x201345[_0x2a4b12(0x1eb)](_0x2a4b12(0x127));const _0x5abbd8=_0x3a7d35[_0x2a4b12(0x124)](_0x18633b=>_0x18633b['quantity']!=='0'&&_0x18633b['quantity']!==''),_0x461e06=new sales_finished({'invoice':'OUT-'+_0x484b76[_0x2a4b12(0x1d4)][_0x2a4b12(0x207)]()[_0x2a4b12(0x1ba)](0x8,'0'),'sales_data':_0x19267a[_0x2a4b12(0x21b)][_0x2a4b12(0x166)],'customer':_0x19267a[_0x2a4b12(0x21b)]['customer'],'date':_0x5e4cb4,'warehouse_name':_0x24f17a,'sale_product':_0x5abbd8,'note':_0x928ebb,'room':_0x563f20,'primary_code':_0x5416df,'secondary_code':_0x5320b5,'prod_code':_0xd669c6,'SCRN':_0x501c7f,'finalize':'False','mode_transpo':_0x274ce8,'name_driver':_0x2b686f,'ReqBy':_0x191c21,'dateofreq':_0x2ac76d,'PO_number':_0xd146c4,'typeservicesData':_0x3705cb,'typevehicle':_0x2c34f0,'destination':_0x2ed933,'deliverydate':_0x1dcb23,'driver':_0x631e18,'plate':_0x48435c,'van':_0x50d63f,'DRSI':_0x35f4c0,'TSU':_0x4d1585,'TFU':_0x1c2837,'pullout_date':_0x485c23,'actualdelivery_date':_0x443e06,'typeOfProducts':_0x2a4b12(0x242)}),_0x3f524b=await _0x461e06[_0x2a4b12(0x155)](),_0x53db07=await sales_finished['findOne']({'invoice':_0x5d4ec0});_0x19267a[_0x2a4b12(0x251)](_0x2a4b12(0x1f7),'Sales\x20Add\x20successfully'),_0x201345[_0x2a4b12(0x1eb)]('/all_sales_finished/preview/'+_0x3f524b['_id']);}catch(_0x389940){console[_0x2a4b12(0x206)](_0x389940);}}),router[a0_0x1303ab(0x1fc)](a0_0x1303ab(0x188),auth,async(_0x2bd413,_0x46c2e6)=>{var _0x2a0aae=a0_0x1303ab;try{const {username:_0x3387d0,email:_0x53f58e,role:_0x27d482}=_0x2bd413[_0x2a0aae(0x210)],_0x4dde53=_0x2bd413[_0x2a0aae(0x210)],_0x2017a7=await profile['findOne']({'email':_0x4dde53[_0x2a0aae(0x149)]}),_0x4ce264=await master_shop['find'](),_0x5aaacc=_0x2bd413[_0x2a0aae(0x171)]['id'],_0x1c3653=await sales_finished[_0x2a0aae(0x12f)](_0x5aaacc),_0x1f7f11=await warehouse[_0x2a0aae(0x12e)]([{'$match':{'name':_0x1c3653['warehouse_name']}},{'$unwind':_0x2a0aae(0x1db)},{'$group':{'_id':_0x2a0aae(0x142),'name':{'$first':_0x2a0aae(0x195)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2a0aae(0x228)},'bin':{'$first':_0x2a0aae(0x1cd)},'type':{'$first':_0x2a0aae(0x25a)},'floorlevel':{'$first':_0x2a0aae(0x249)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2a0aae(0x1a8)},'product_code':{'$first':_0x2a0aae(0x1fa)},'storage':{'$first':_0x2a0aae(0x135)},'rack':{'$first':_0x2a0aae(0x137)},'expiry_date':{'$first':_0x2a0aae(0x1d7)},'production_date':{'$first':_0x2a0aae(0x1d9)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x2a0aae(0x18c)},'room_data':{'$first':_0x2a0aae(0x184)}}}]),_0x4f5dca=await customer[_0x2a0aae(0x235)]({});let _0x7b2c4f;if(_0x4dde53['role']==_0x2a0aae(0x1ad)){const _0x5996f1=await staff[_0x2a0aae(0x1f0)]({'email':_0x4dde53[_0x2a0aae(0x149)]});_0x7b2c4f=await warehouse['aggregate']([{'$match':{'status':_0x2a0aae(0x174),'name':_0x5996f1[_0x2a0aae(0x1a7)]}},{'$group':{'_id':'$name','name':{'$first':_0x2a0aae(0x154)}}}]);}else _0x7b2c4f=await warehouse[_0x2a0aae(0x12e)]([{'$match':{'status':_0x2a0aae(0x174)}},{'$group':{'_id':_0x2a0aae(0x154),'name':{'$first':_0x2a0aae(0x154)}}}]);const _0x1d7207=await product['find']({});if(_0x4ce264[0x0]['language']==_0x2a0aae(0x22c)){var _0x4668d1=users[_0x2a0aae(0x16c)];console[_0x2a0aae(0x206)](_0x4668d1);}else{if(_0x4ce264[0x0][_0x2a0aae(0x14b)]==_0x2a0aae(0x191))var _0x4668d1=users[_0x2a0aae(0x191)];else{if(_0x4ce264[0x0][_0x2a0aae(0x14b)]==_0x2a0aae(0x176))var _0x4668d1=users[_0x2a0aae(0x176)];else{if(_0x4ce264[0x0]['language']==_0x2a0aae(0x19b))var _0x4668d1=users[_0x2a0aae(0x19b)];else{if(_0x4ce264[0x0][_0x2a0aae(0x14b)]==_0x2a0aae(0x266))var _0x4668d1=users[_0x2a0aae(0x266)];else{if(_0x4ce264[0x0][_0x2a0aae(0x14b)]=='Portuguese\x20(BR)')var _0x4668d1=users['Portuguese'];else{if(_0x4ce264[0x0][_0x2a0aae(0x14b)]==_0x2a0aae(0x136))var _0x4668d1=users[_0x2a0aae(0x136)];else{if(_0x4ce264[0x0]['language']=='Arabic\x20(ae)')var _0x4668d1=users['Arabic'];}}}}}}}_0x46c2e6[_0x2a0aae(0x12a)](_0x2a0aae(0x162),{'success':_0x2bd413[_0x2a0aae(0x251)](_0x2a0aae(0x1f7)),'errors':_0x2bd413[_0x2a0aae(0x251)]('errors'),'role':_0x4dde53,'profile':_0x2017a7,'customer':_0x4f5dca,'warehouse':_0x7b2c4f,'product':_0x1f7f11,'user':_0x1c3653,'master_shop':_0x4ce264,'unit':_0x1d7207,'language':_0x4668d1});}catch(_0x56b48e){console['log'](_0x56b48e);}});async function dataUpdate(_0x5669ae,_0x2b4888,_0x284195){var _0x5a918d=a0_0x1303ab;return await warehouse['updateOne']({'_id':_0x5669ae,'product_details._id':_0x2b4888},{'$set':{'product_details.$.product_stock':_0x284195}}),await warehouse[_0x5a918d(0x12f)](_0x5669ae);}router[a0_0x1303ab(0x1e1)](a0_0x1303ab(0x188),auth,async(_0x379025,_0x514769)=>{var _0x2ec534=a0_0x1303ab;try{const _0x4fc3fd=_0x379025[_0x2ec534(0x171)]['id'],{invoice:_0x28589c,warehouse_name:_0x5ec92a,room:_0x327b88}=_0x379025[_0x2ec534(0x21b)],_0x36793e=await sales_finished[_0x2ec534(0x1f0)]({'invoice':_0x28589c});for(let _0x5d5cc0=0x0;_0x5d5cc0<=_0x36793e[_0x2ec534(0x250)][_0x2ec534(0x133)]-0x1;_0x5d5cc0++){const _0x489cb7=_0x36793e['sale_product'][_0x5d5cc0];var _0xb4a0fa=await warehouse[_0x2ec534(0x1f0)]({'name':_0x5ec92a,'room':_0x489cb7[_0x2ec534(0x21c)]}),_0x20d046=0x0;for(let _0x4bb20a=0x0;_0x4bb20a<=_0xb4a0fa[_0x2ec534(0x1f8)][_0x2ec534(0x133)]-0x1;_0x4bb20a++){const _0x357ce3=_0xb4a0fa[_0x2ec534(0x1f8)][_0x4bb20a];_0x357ce3['_id']==_0x489cb7[_0x2ec534(0x182)]&&_0x357ce3[_0x2ec534(0x254)]==_0x489cb7[_0x2ec534(0x254)]&&(_0x20d046=Math[_0x2ec534(0x218)](0x0,Math[_0x2ec534(0x1e9)](_0x357ce3[_0x2ec534(0x197)])-Math[_0x2ec534(0x1e9)](_0x489cb7[_0x2ec534(0x1f3)])),await warehouse[_0x2ec534(0x26e)]({'_id':_0xb4a0fa[_0x2ec534(0x16e)][_0x2ec534(0x193)](),'product_details._id':_0x357ce3[_0x2ec534(0x16e)][_0x2ec534(0x193)](),'product_details.uuid':_0x489cb7[_0x2ec534(0x254)]},{'$set':{'product_details.$.product_stock':_0x20d046}}));}console[_0x2ec534(0x206)](typeof _0x489cb7[_0x2ec534(0x1b6)]);if(typeof _0x489cb7['agent_id']!==_0x2ec534(0x173)){var _0x55fe46=await staff[_0x2ec534(0x12f)](_0x489cb7[_0x2ec534(0x1b6)]);console['log'](_0x2ec534(0x1e3));var _0x31beeb=0x0;for(let _0x501e9a=0x0;_0x501e9a<=_0x55fe46[_0x2ec534(0x134)]['length']-0x1;_0x501e9a++){const _0x56119e=_0x55fe46[_0x2ec534(0x134)][_0x501e9a];console[_0x2ec534(0x206)](_0x489cb7[_0x2ec534(0x182)]+_0x2ec534(0x240)+_0x56119e[_0x2ec534(0x177)]+'\x20&&\x20'+_0x489cb7[_0x2ec534(0x16e)]+_0x2ec534(0x240)+_0x489cb7['_id']),_0x489cb7[_0x2ec534(0x182)]==_0x56119e['warehouse_id']&&_0x489cb7[_0x2ec534(0x16e)]==0x1&&(_0x56119e['product_stock']=Math[_0x2ec534(0x1e9)](_0x56119e[_0x2ec534(0x197)])+Math[_0x2ec534(0x1e9)](_0x489cb7[_0x2ec534(0x1f3)]),_0x31beeb++);}console['log'](_0x2ec534(0x1ef),_0x31beeb),_0x31beeb=='0'&&(_0x55fe46[_0x2ec534(0x134)]=_0x55fe46['product_list'][_0x2ec534(0x1cc)]({'product_name':_0x489cb7[_0x2ec534(0x14a)],'product_stock':_0x489cb7[_0x2ec534(0x1f3)],'bay':_0x489cb7[_0x2ec534(0x236)],'level':_0x489cb7[_0x2ec534(0x1e7)],'product_code':_0x489cb7[_0x2ec534(0x13a)],'primary_code':_0x489cb7['primary_code'],'secondary_code':_0x489cb7[_0x2ec534(0x21a)],'expiry_date':_0x489cb7['expiry_date'],'production_date':_0x489cb7['production_date'],'maxProducts':_0x489cb7[_0x2ec534(0x1c4)],'batch_code':_0x489cb7[_0x2ec534(0x17c)],'secondary_unit':_0x489cb7['secondary_unit'],'unit':_0x489cb7[_0x2ec534(0x1b4)],'maxProducts':_0x489cb7[_0x2ec534(0x1c4)],'maxPerUnit':_0x489cb7['maxperunit'],'invoice':_0x489cb7[_0x2ec534(0x1c2)],'warehouse_id':_0x489cb7[_0x2ec534(0x182)],'id_incoming':_0x489cb7[_0x2ec534(0x16e)],'uuid':_0x489cb7[_0x2ec534(0x254)],'gross_price':_0x489cb7[_0x2ec534(0x126)],'date_incoming':_0x489cb7[_0x2ec534(0x1b5)],'outgoing_invoice':_0x489cb7['outgoing_invoice']}),await _0x55fe46[_0x2ec534(0x155)]());}}_0x36793e[_0x2ec534(0x259)]=_0x2ec534(0x160);const _0x5bf559=await _0x36793e[_0x2ec534(0x155)](),_0x4f7e5e=await master_shop[_0x2ec534(0x235)](),_0xe2a106=await email_settings[_0x2ec534(0x1f0)](),_0xf1bac9=await supervisor_settings['find']();var _0x555913=_0x36793e[_0x2ec534(0x250)],_0x5cedb1='',_0x1f2338;for(_0x1f2338 in _0x555913){_0x5cedb1+=_0x2ec534(0x233)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x555913[_0x1f2338]['product_name']+_0x2ec534(0x26a)+_0x2ec534(0x21f)+_0x555913[_0x1f2338]['product_code']+_0x2ec534(0x26a)+_0x2ec534(0x21f)+_0x555913[_0x1f2338][_0x2ec534(0x1f3)]+_0x2ec534(0x26a)+_0x2ec534(0x21f)+_0x555913[_0x1f2338][_0x2ec534(0x1b4)]+_0x2ec534(0x26a)+_0x2ec534(0x21f)+_0x555913[_0x1f2338][_0x2ec534(0x1dd)]+_0x2ec534(0x26a)+_0x2ec534(0x21f)+_0x36793e['warehouse_name']+'</td>'+_0x2ec534(0x21f)+_0x555913[_0x1f2338][_0x2ec534(0x21c)]+_0x2ec534(0x26a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x555913[_0x1f2338][_0x2ec534(0x236)]+'</td>';}_0x379025['flash'](_0x2ec534(0x1f7),_0x2ec534(0x1b7)),_0x514769[_0x2ec534(0x1eb)](_0x2ec534(0x1cf)+_0x4fc3fd);}catch(_0x24ee39){console[_0x2ec534(0x206)](_0x24ee39);}}),router[a0_0x1303ab(0x1fc)](a0_0x1303ab(0x20f),auth,async(_0x14a830,_0x57a432)=>{var _0x2884c0=a0_0x1303ab;try{const {username:_0x3a6134,email:_0x1e08a7,role:_0x31ea86}=_0x14a830[_0x2884c0(0x210)],_0x479635=_0x14a830[_0x2884c0(0x210)],_0x3d659a=await profile[_0x2884c0(0x1f0)]({'email':_0x479635[_0x2884c0(0x149)]}),_0x265161=await master_shop['find'](),_0x5e943b=_0x14a830[_0x2884c0(0x171)]['id'],_0xa52ccd=await sales_finished[_0x2884c0(0x12f)](_0x5e943b);let _0x289697=new Date(_0xa52ccd[_0x2884c0(0x169)]),_0x531d6d=('0'+_0x289697[_0x2884c0(0x1e4)]())[_0x2884c0(0x156)](-0x2),_0x16cdae=('0'+(_0x289697['getMonth']()+0x1))[_0x2884c0(0x156)](-0x2),_0x5c12bd=_0x289697['getFullYear'](),_0xaa515c=_0x5c12bd+'-'+_0x16cdae+'-'+_0x531d6d;var _0x358f46=[_0x2884c0(0x26d),_0x2884c0(0x208)];const _0x55245e=await warehouse[_0x2884c0(0x12e)]([{'$match':{'name':_0xa52ccd[_0x2884c0(0x26c)],'room':_0xa52ccd[_0x2884c0(0x129)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2884c0(0x142),'name':{'$first':_0x2884c0(0x195)},'product_stock':{'$first':_0x2884c0(0x125)},'bay':{'$first':_0x2884c0(0x228)},'bin':{'$first':_0x2884c0(0x1cd)},'type':{'$first':_0x2884c0(0x25a)},'floorlevel':{'$first':_0x2884c0(0x249)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2884c0(0x1a8)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2884c0(0x135)},'rack':{'$first':_0x2884c0(0x137)}}}]),_0x17505e=await customer['find']({});let _0x15d656;if(_0x479635[_0x2884c0(0x217)]==_0x2884c0(0x1ad)){const _0x1377a6=await staff[_0x2884c0(0x1f0)]({'email':_0x479635['email']});_0x15d656=await warehouse[_0x2884c0(0x12e)]([{'$match':{'status':_0x2884c0(0x174),'name':_0x1377a6[_0x2884c0(0x1a7)]}},{'$group':{'_id':_0x2884c0(0x154),'name':{'$first':_0x2884c0(0x154)}}}]);}else _0x15d656=await warehouse[_0x2884c0(0x12e)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x2884c0(0x154),'name':{'$first':_0x2884c0(0x154)}}}]);const _0x2ce3ee=await product[_0x2884c0(0x235)]({});if(_0x265161[0x0][_0x2884c0(0x14b)]==_0x2884c0(0x22c)){var _0x188918=users[_0x2884c0(0x16c)];console[_0x2884c0(0x206)](_0x188918);}else{if(_0x265161[0x0][_0x2884c0(0x14b)]=='Hindi')var _0x188918=users[_0x2884c0(0x191)];else{if(_0x265161[0x0][_0x2884c0(0x14b)]==_0x2884c0(0x176))var _0x188918=users['German'];else{if(_0x265161[0x0][_0x2884c0(0x14b)]==_0x2884c0(0x19b))var _0x188918=users[_0x2884c0(0x19b)];else{if(_0x265161[0x0][_0x2884c0(0x14b)]==_0x2884c0(0x266))var _0x188918=users[_0x2884c0(0x266)];else{if(_0x265161[0x0][_0x2884c0(0x14b)]==_0x2884c0(0x252))var _0x188918=users[_0x2884c0(0x1ed)];else{if(_0x265161[0x0][_0x2884c0(0x14b)]==_0x2884c0(0x136))var _0x188918=users[_0x2884c0(0x136)];else{if(_0x265161[0x0][_0x2884c0(0x14b)]==_0x2884c0(0x14d))var _0x188918=users[_0x2884c0(0x18e)];}}}}}}}_0x57a432[_0x2884c0(0x12a)](_0x2884c0(0x148),{'success':_0x14a830[_0x2884c0(0x251)](_0x2884c0(0x1f7)),'errors':_0x14a830[_0x2884c0(0x251)](_0x2884c0(0x16b)),'role':_0x479635,'profile':_0x3d659a,'customer':_0x17505e,'warehouse':_0x15d656,'product':_0x55245e,'user':_0xa52ccd,'master_shop':_0x265161,'unit':_0x2ce3ee,'language':_0x188918,'rooms_data':_0x358f46,'ed_fullDate':_0xaa515c});}catch(_0x4c6d9b){console[_0x2884c0(0x206)](_0x4c6d9b);}}),router[a0_0x1303ab(0x1e1)](a0_0x1303ab(0x20f),auth,async(_0x164045,_0x1bf8bf)=>{var _0x56ff35=a0_0x1303ab;try{const _0x81d54f=_0x164045['params']['id'],_0x2ad615=await sales_finished[_0x56ff35(0x1f0)]({'_id':_0x164045[_0x56ff35(0x171)]['id']}),_0x446005=await warehouse[_0x56ff35(0x1f0)]({'name':_0x2ad615[_0x56ff35(0x26c)],'room':_0x164045[_0x56ff35(0x21b)]['room'],'warehouse_category':_0x56ff35(0x201)}),{invoice:_0x16eedf,customer:_0x1845da,date:_0x4a6352,warehouse_name:_0x4ed5ed,product_name:_0x2cc00c,stock:_0x4c5376,adjust_qty:_0x449f4f,note:_0x441440,room:_0x510436,primary_code:_0x3138a4,secondary_code:_0x35c0ee,prod_code:_0x345e6b,level:_0x35439a,isle:_0x16e2f8,pallet:_0x514345,expiry_date:_0x29f054}=_0x164045[_0x56ff35(0x21b)];if(typeof _0x2cc00c=='string')var _0x55da87=[_0x164045[_0x56ff35(0x21b)]['product_name']],_0x200a5b=[_0x164045[_0x56ff35(0x21b)][_0x56ff35(0x24b)]],_0x2c7322=[_0x164045[_0x56ff35(0x21b)][_0x56ff35(0x15f)]],_0x3ddce1=[_0x164045[_0x56ff35(0x21b)][_0x56ff35(0x158)]],_0x2f25eb=[_0x164045[_0x56ff35(0x21b)]['secondary_code']],_0x2a69b1=[_0x164045[_0x56ff35(0x21b)][_0x56ff35(0x21e)]],_0x2828b8=[_0x164045[_0x56ff35(0x21b)][_0x56ff35(0x1e7)]],_0x5aa26c=[_0x164045[_0x56ff35(0x21b)][_0x56ff35(0x169)]];else var _0x55da87=[..._0x164045[_0x56ff35(0x21b)]['product_name']],_0x200a5b=[..._0x164045[_0x56ff35(0x21b)][_0x56ff35(0x24b)]],_0x2c7322=[..._0x164045['body']['adjust_qty']],_0x3ddce1=[..._0x164045['body'][_0x56ff35(0x158)]],_0x2f25eb=[..._0x164045['body'][_0x56ff35(0x21a)]],_0x2a69b1=[..._0x164045['body'][_0x56ff35(0x21e)]],_0x2828b8=[..._0x164045[_0x56ff35(0x21b)]['level']],_0x5aa26c=[..._0x164045['body'][_0x56ff35(0x169)]];const _0xa6c11f=_0x55da87[_0x56ff35(0x170)](_0x33abd9=>{return _0x33abd9={'product_name':_0x33abd9};});_0x200a5b[_0x56ff35(0x1c3)]((_0x5d3c18,_0x3225be)=>{var _0x41ed98=_0x56ff35;_0xa6c11f[_0x3225be][_0x41ed98(0x24b)]=_0x5d3c18;}),_0x2c7322[_0x56ff35(0x1c3)]((_0x4cf7a9,_0x566776)=>{var _0x37c723=_0x56ff35;_0xa6c11f[_0x566776][_0x37c723(0x1f3)]=_0x4cf7a9;}),_0x3ddce1[_0x56ff35(0x1c3)]((_0x1b666f,_0x1a2355)=>{_0xa6c11f[_0x1a2355]['primary_code']=_0x1b666f;}),_0x2f25eb['forEach']((_0x1235a4,_0x4f27ec)=>{var _0x2f6a91=_0x56ff35;_0xa6c11f[_0x4f27ec][_0x2f6a91(0x21a)]=_0x1235a4;}),_0x2a69b1[_0x56ff35(0x1c3)]((_0x5abbce,_0x37d289)=>{var _0x413574=_0x56ff35;_0xa6c11f[_0x37d289][_0x413574(0x13a)]=_0x5abbce;}),_0x2828b8[_0x56ff35(0x1c3)]((_0x2f3851,_0x7bf6bc)=>{var _0x40e284=_0x56ff35;_0xa6c11f[_0x7bf6bc][_0x40e284(0x1e7)]=_0x2f3851;}),_0x5aa26c['forEach']((_0x45f205,_0x47079f)=>{var _0x1a2c9d=_0x56ff35;_0xa6c11f[_0x47079f][_0x1a2c9d(0x169)]=_0x45f205;});var _0x45df66=0x0;_0xa6c11f[_0x56ff35(0x1c3)](_0x4ae183=>{var _0x43f6b6=_0x56ff35;console[_0x43f6b6(0x206)](_0x43f6b6(0x18d),_0x4ae183),(parseInt(_0x4ae183[_0x43f6b6(0x24b)])<parseInt(_0x4ae183[_0x43f6b6(0x1f3)])||parseInt(_0x4ae183[_0x43f6b6(0x1f3)])==0x0)&&_0x45df66++;});if(_0x45df66!=0x0)return _0x164045[_0x56ff35(0x251)](_0x56ff35(0x16b),_0x56ff35(0x1a9)),_0x1bf8bf[_0x56ff35(0x1eb)](_0x56ff35(0x127));_0x2ad615['sale_product'][_0x56ff35(0x1c3)](_0x5ae23c=>{var _0xfb1f67=_0x56ff35;const _0x47389a=_0x446005[_0xfb1f67(0x1f8)][_0xfb1f67(0x170)](_0x4985e4=>{var _0x9cf8ee=_0xfb1f67;_0x4985e4[_0x9cf8ee(0x14a)]==_0x5ae23c[_0x9cf8ee(0x14a)]&&_0x4985e4[_0x9cf8ee(0x236)]==_0x5ae23c[_0x9cf8ee(0x236)]&&(_0x4985e4[_0x9cf8ee(0x197)]=parseInt(_0x4985e4[_0x9cf8ee(0x197)])+parseInt(_0x5ae23c[_0x9cf8ee(0x1f3)]));});}),await _0x446005[_0x56ff35(0x155)]();const _0x47dbb0=_0xa6c11f['filter'](_0x24be9b=>_0x24be9b[_0x56ff35(0x1f3)]!=='0'&&_0x24be9b['quantity']!=='');_0x2ad615[_0x56ff35(0x1c2)]=_0x16eedf,_0x2ad615[_0x56ff35(0x14f)]=_0x1845da,_0x2ad615[_0x56ff35(0x146)]=_0x4a6352,_0x2ad615['warehouse_name']=_0x4ed5ed,_0x2ad615[_0x56ff35(0x250)]=_0x47dbb0,_0x2ad615[_0x56ff35(0x24c)]=_0x441440,_0x2ad615[_0x56ff35(0x129)]=_0x510436;const _0x4ceb2c=await _0x2ad615[_0x56ff35(0x155)](),_0x5ccb4f=await sales_finished[_0x56ff35(0x1f0)]({'_id':_0x164045[_0x56ff35(0x171)]['id']}),_0x4df130=await warehouse[_0x56ff35(0x1f0)]({'name':_0x4ed5ed,'room':_0x510436,'warehouse_category':_0x56ff35(0x201)});_0x5ccb4f[_0x56ff35(0x250)]['forEach'](_0x464ba9=>{var _0x2cc49a=_0x56ff35;const _0x4cb74b=_0x4df130[_0x2cc49a(0x1f8)]['map'](_0x981d6c=>{var _0x399860=_0x2cc49a;_0x981d6c['product_name']==_0x464ba9[_0x399860(0x14a)]&&_0x981d6c['bay']==_0x464ba9[_0x399860(0x236)]&&(_0x981d6c[_0x399860(0x197)]=parseInt(_0x981d6c['product_stock'])-parseInt(_0x464ba9[_0x399860(0x1f3)]));});}),console[_0x56ff35(0x206)](_0x56ff35(0x151),_0x4df130),await _0x4df130[_0x56ff35(0x155)]();const _0x238221=await c_payment_data[_0x56ff35(0x1f0)]({'invoice':_0x164045[_0x56ff35(0x21b)]['invoice']});_0x238221[_0x56ff35(0x202)]=_0x164045['body']['suppliers'],await _0x238221[_0x56ff35(0x155)](),_0x164045[_0x56ff35(0x251)]('success',_0x56ff35(0x1b7)),_0x1bf8bf['redirect'](_0x56ff35(0x147));}catch(_0x3c7bdd){console[_0x56ff35(0x206)](_0x3c7bdd);}}),router[a0_0x1303ab(0x1e1)](a0_0x1303ab(0x1c6),auth,async(_0x4bc86e,_0x5db4ec)=>{var _0x375843=a0_0x1303ab;try{const _0x507245=_0x4bc86e['params']['id'],{invoice:_0x2395b2,customer:_0x135315,receivable_amount:_0x3c2bdc,received_amount:_0x1ae875}=_0x4bc86e['body'],_0xde95=await sales[_0x375843(0x12f)](_0x507245);console[_0x375843(0x206)](_0xde95);var _0x594b88=_0x3c2bdc-_0x1ae875;console[_0x375843(0x206)](_0x1ae875),_0xde95[_0x375843(0x199)]=parseFloat(_0x1ae875)+parseFloat(_0xde95['received_amount']),_0xde95[_0x375843(0x23e)]=_0x594b88,console[_0x375843(0x206)](_0xde95);const _0x525b58=await _0xde95[_0x375843(0x155)](),_0x121f8c=await c_payment_data[_0x375843(0x1f0)]({'invoice':_0x2395b2});_0x121f8c['amount']=_0x594b88,await _0x121f8c['save']();let _0x3c88a4=new Date(),_0x3e7677=('0'+_0x3c88a4[_0x375843(0x1e4)]())[_0x375843(0x156)](-0x2),_0x585322=('0'+(_0x3c88a4[_0x375843(0x12d)]()+0x1))[_0x375843(0x156)](-0x2),_0x4b7edc=_0x3c88a4['getFullYear'](),_0x5a71da=_0x4b7edc+'-'+_0x585322+'-'+_0x3e7677;const _0x191ec9=new customer_payment({'invoice':_0x2395b2,'date':_0x4b7edc+'-'+_0x585322+'-'+_0x3e7677,'customer':_0x135315,'reason':_0x375843(0x219),'amount':_0x1ae875}),_0x1ca467=await _0x191ec9[_0x375843(0x155)]();_0x4bc86e[_0x375843(0x251)](_0x375843(0x1f7),'payment\x20successfull'),_0x5db4ec[_0x375843(0x1eb)](_0x375843(0x211));}catch(_0x3bdfcb){console[_0x375843(0x206)](_0x3bdfcb);}}),router[a0_0x1303ab(0x1fc)](a0_0x1303ab(0x15c),auth,async(_0x20c77e,_0x2e6dc3)=>{var _0x1e2734=a0_0x1303ab;try{const {username:_0x14332a,email:_0x2b7761,role:_0x3b6399}=_0x20c77e[_0x1e2734(0x210)],_0x3903b5=_0x20c77e[_0x1e2734(0x210)],_0x46d9c6=await profile['findOne']({'email':_0x3903b5[_0x1e2734(0x149)]}),_0x56df81=await master_shop[_0x1e2734(0x235)]();console['log'](_0x1e2734(0x1ec),_0x56df81);const _0x4a5d05=_0x20c77e[_0x1e2734(0x171)]['id'],_0x11142=await sales[_0x1e2734(0x12f)](_0x4a5d05);console[_0x1e2734(0x206)](_0x11142);const _0x3d81f2=await customer[_0x1e2734(0x1f0)]({'name':_0x11142['customer']});console[_0x1e2734(0x206)](_0x3d81f2);if(_0x56df81[0x0][_0x1e2734(0x14b)]==_0x1e2734(0x22c)){var _0x179037=users[_0x1e2734(0x16c)];console[_0x1e2734(0x206)](_0x179037);}else{if(_0x56df81[0x0]['language']=='Hindi')var _0x179037=users['Hindi'];else{if(_0x56df81[0x0]['language']==_0x1e2734(0x176))var _0x179037=users['German'];else{if(_0x56df81[0x0]['language']==_0x1e2734(0x19b))var _0x179037=users[_0x1e2734(0x19b)];else{if(_0x56df81[0x0][_0x1e2734(0x14b)]==_0x1e2734(0x266))var _0x179037=users[_0x1e2734(0x266)];else{if(_0x56df81[0x0][_0x1e2734(0x14b)]==_0x1e2734(0x252))var _0x179037=users[_0x1e2734(0x1ed)];else{if(_0x56df81[0x0]['language']==_0x1e2734(0x136))var _0x179037=users['Chinese'];else{if(_0x56df81[0x0][_0x1e2734(0x14b)]==_0x1e2734(0x14d))var _0x179037=users[_0x1e2734(0x18e)];}}}}}}}_0x2e6dc3[_0x1e2734(0x12a)]('sales_invoice',{'success':_0x20c77e[_0x1e2734(0x251)]('success'),'errors':_0x20c77e['flash'](_0x1e2734(0x16b)),'role':_0x3903b5,'profile':_0x46d9c6,'master_shop':_0x56df81,'customers':_0x3d81f2,'sales':_0x11142,'language':_0x179037});}catch(_0x3e17a0){console['log'](_0x3e17a0);}}),router['get']('/view/return_sales/:id',auth,async(_0x13db38,_0x387eb4)=>{var _0x4a6215=a0_0x1303ab;try{const {username:_0x75aba5,email:_0x5c574a,role:_0x41b24e}=_0x13db38[_0x4a6215(0x210)],_0x16e3d2=_0x13db38['user'],_0x2692c2=await profile[_0x4a6215(0x1f0)]({'email':_0x16e3d2[_0x4a6215(0x149)]}),_0x2117d6=await master_shop['find'](),_0x42d31b=_0x13db38['params']['id'],_0x128e85=await sales_finished[_0x4a6215(0x12f)](_0x42d31b),_0x3f80cb=await warehouse[_0x4a6215(0x12e)]([{'$match':{'name':_0x128e85[_0x4a6215(0x26c)]}},{'$unwind':_0x4a6215(0x1db)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4a6215(0x195)},'product_stock':{'$first':_0x4a6215(0x125)},'bay':{'$first':_0x4a6215(0x228)},'bin':{'$first':_0x4a6215(0x1cd)},'type':{'$first':_0x4a6215(0x25a)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4a6215(0x19f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4a6215(0x135)},'rack':{'$first':_0x4a6215(0x137)},'expiry_date':{'$first':_0x4a6215(0x1d7)},'production_date':{'$first':_0x4a6215(0x1d9)},'unit':{'$first':_0x4a6215(0x1c8)},'secondary_unit':{'$first':_0x4a6215(0x244)},'maxProducts':{'$first':_0x4a6215(0x123)},'batch_code':{'$first':_0x4a6215(0x13e)},'maxPerUnit':{'$first':_0x4a6215(0x24e)}}}]),_0x233806=await product[_0x4a6215(0x235)]({}),_0x2fdbab=await warehouse[_0x4a6215(0x12e)]([{'$match':{'status':_0x4a6215(0x174),'warehouse_category':_0x4a6215(0x201),'name':{'$ne':_0x4a6215(0x12c),'$ne':_0x4a6215(0x1a5)}}},{'$group':{'_id':_0x4a6215(0x154),'name':{'$first':_0x4a6215(0x154)}}},{'$sort':{'name':0x1}}]);var _0xe25dcc=['Return\x20Rooms'];const _0x29c281=await warehouse[_0x4a6215(0x12e)]([{'$match':{'status':_0x4a6215(0x174),'name':_0x4a6215(0x1a5)}},{'$group':{'_id':_0x4a6215(0x154),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x2117d6[0x0][_0x4a6215(0x14b)]==_0x4a6215(0x22c)){var _0xd646ae=users['English'];console[_0x4a6215(0x206)](_0xd646ae);}else{if(_0x2117d6[0x0][_0x4a6215(0x14b)]=='Hindi')var _0xd646ae=users[_0x4a6215(0x191)];else{if(_0x2117d6[0x0]['language']=='German')var _0xd646ae=users['German'];else{if(_0x2117d6[0x0]['language']=='Spanish')var _0xd646ae=users[_0x4a6215(0x19b)];else{if(_0x2117d6[0x0]['language']==_0x4a6215(0x266))var _0xd646ae=users[_0x4a6215(0x266)];else{if(_0x2117d6[0x0][_0x4a6215(0x14b)]==_0x4a6215(0x252))var _0xd646ae=users[_0x4a6215(0x1ed)];else{if(_0x2117d6[0x0]['language']=='Chinese')var _0xd646ae=users[_0x4a6215(0x136)];else{if(_0x2117d6[0x0][_0x4a6215(0x14b)]==_0x4a6215(0x14d))var _0xd646ae=users[_0x4a6215(0x18e)];}}}}}}}_0x387eb4['render'](_0x4a6215(0x1cb),{'success':_0x13db38['flash'](_0x4a6215(0x1f7)),'errors':_0x13db38['flash'](_0x4a6215(0x16b)),'role':_0x16e3d2,'profile':_0x2692c2,'user':_0x128e85,'stock':_0x3f80cb,'master_shop':_0x2117d6,'unit':_0x233806,'language':_0xd646ae,'warehouses':_0x2fdbab,'rooms':_0xe25dcc,'warehouse_QA':_0x29c281});}catch(_0x487838){console[_0x4a6215(0x206)](_0x487838),_0x387eb4[_0x4a6215(0x226)](0xc8)[_0x4a6215(0x12b)]({'message':_0x487838[_0x4a6215(0x196)]});}}),router[a0_0x1303ab(0x1e1)]('/view/return_sales/:id',auth,async(_0x4e402c,_0x358dba)=>{var _0x24ffd6=a0_0x1303ab;if(_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x168)]=='QA')try{const {invoice:_0x3b246c,date:_0xfbfe09,warehouse_name:_0x32831d,product_name:_0x671ca3,primary_code:_0x2a40d2,secondary_code:_0x48e698,product_code:_0x5e572a,sales_quantity:_0x5bd2f6,stocks:_0x4396d5,return_qty:_0x4602a5,Room_name:_0x47a291,to_warehouse_name_QA:_0x1fe353,to_Room_name_QA:_0x14c876,note:_0x5d8e52,for_categorize:_0x365260,product_name_QA1:_0xcdc99a}=_0x4e402c[_0x24ffd6(0x21b)];if(typeof _0xcdc99a==_0x24ffd6(0x256))var _0x3a2e49=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1c9)]],_0x3128a5=[_0x4e402c['body'][_0x24ffd6(0x21d)]],_0x250f4a=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1bf)]],_0x37fd3f=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x19d)]],_0x275800=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1bb)]],_0x1c1985=[_0x4e402c['body'][_0x24ffd6(0x231)]],_0x2d5f33=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x265)]],_0x23b682=[_0x4e402c['body'][_0x24ffd6(0x16a)]],_0x3a7199=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x17f)]],_0x11e723=[_0x4e402c['body'][_0x24ffd6(0x1bd)]],_0x3d66dd=[_0x4e402c[_0x24ffd6(0x21b)]['secondary_unit_QA']],_0x397d9b=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x213)]],_0x263c0a=[_0x4e402c[_0x24ffd6(0x21b)]['production_date_QA']],_0x44e2a1=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x13f)]];else var _0x3a2e49=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1c9)]],_0x3128a5=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x21d)]],_0x250f4a=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1bf)]],_0x37fd3f=[..._0x4e402c['body'][_0x24ffd6(0x19d)]],_0x275800=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1bb)]],_0x1c1985=[..._0x4e402c['body']['stocks_QA']],_0x2d5f33=[..._0x4e402c['body'][_0x24ffd6(0x265)]],_0x23b682=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x16a)]],_0x3a7199=[..._0x4e402c['body'][_0x24ffd6(0x17f)]],_0x11e723=[..._0x4e402c['body']['batch_code_QA']],_0x3d66dd=[..._0x4e402c['body']['secondary_unit_QA']],_0x397d9b=[..._0x4e402c['body'][_0x24ffd6(0x213)]],_0x263c0a=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x221)]],_0x44e2a1=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x13f)]];const _0x46c89b=_0x3a2e49[_0x24ffd6(0x170)](_0xb3e1c1=>{return _0xb3e1c1={'product_name':_0xb3e1c1};});_0x3128a5['forEach']((_0x1327d2,_0x2b57b2)=>{var _0x3e20b6=_0x24ffd6;_0x46c89b[_0x2b57b2][_0x3e20b6(0x158)]=_0x1327d2;}),_0x250f4a[_0x24ffd6(0x1c3)]((_0x16644d,_0x4a7f97)=>{var _0x273cff=_0x24ffd6;_0x46c89b[_0x4a7f97][_0x273cff(0x21a)]=_0x16644d;}),_0x37fd3f['forEach']((_0x50b2ac,_0x533d70)=>{_0x46c89b[_0x533d70]['product_code']=_0x50b2ac;}),_0x275800[_0x24ffd6(0x1c3)]((_0x24c540,_0x2cf3d5)=>{var _0x59eb2f=_0x24ffd6;_0x46c89b[_0x2cf3d5][_0x59eb2f(0x159)]=_0x24c540;}),_0x1c1985[_0x24ffd6(0x1c3)]((_0x2c527a,_0x4994f5)=>{var _0x462379=_0x24ffd6;_0x46c89b[_0x4994f5][_0x462379(0x24b)]=_0x2c527a;}),_0x2d5f33[_0x24ffd6(0x1c3)]((_0x87b4ae,_0x30177d)=>{var _0x5947dd=_0x24ffd6;_0x46c89b[_0x30177d][_0x5947dd(0x1ab)]=_0x87b4ae;}),_0x23b682['forEach']((_0x576db3,_0x99f303)=>{_0x46c89b[_0x99f303]['maxPerUnit']=_0x576db3;}),_0x3a7199[_0x24ffd6(0x1c3)]((_0xa6c3ec,_0x4e676d)=>{var _0x330c99=_0x24ffd6;_0x46c89b[_0x4e676d][_0x330c99(0x1c4)]=_0xa6c3ec;}),_0x11e723[_0x24ffd6(0x1c3)]((_0x51719c,_0x1dc0f5)=>{var _0x24ce4c=_0x24ffd6;_0x46c89b[_0x1dc0f5][_0x24ce4c(0x17c)]=_0x51719c;}),_0x3d66dd[_0x24ffd6(0x1c3)]((_0x535253,_0x19b7c4)=>{var _0x1045b4=_0x24ffd6;_0x46c89b[_0x19b7c4][_0x1045b4(0x1dd)]=_0x535253;}),_0x397d9b[_0x24ffd6(0x1c3)]((_0x3e5617,_0x32b068)=>{var _0x11ef2d=_0x24ffd6;_0x46c89b[_0x32b068][_0x11ef2d(0x1b4)]=_0x3e5617;}),_0x263c0a['forEach']((_0x67fa6a,_0x3a2ef0)=>{var _0x56cd22=_0x24ffd6;_0x46c89b[_0x3a2ef0][_0x56cd22(0x1f6)]=_0x67fa6a;}),_0x44e2a1[_0x24ffd6(0x1c3)]((_0xefa59a,_0x49f81a)=>{var _0x31be4a=_0x24ffd6;_0x46c89b[_0x49f81a][_0x31be4a(0x169)]=_0xefa59a;});const _0x20483c=await sales_finished[_0x24ffd6(0x1f0)]({'invoice':_0x3b246c});_0x20483c['return_data']=_0x24ffd6(0x160);const _0x590c50=await _0x20483c[_0x24ffd6(0x155)](),_0x2a8213=new sales_return_finished({'invoice':_0x3b246c,'customer':_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x14f)],'date':_0xfbfe09,'warehouse_name':_0x32831d,'room':_0x47a291,'ToWarehouse':_0x1fe353,'ToRoom':_0x14c876,'return_sale_QA':_0x46c89b,'note':_0x5d8e52,'warehouse_cat':_0x365260}),_0x418046=await _0x2a8213[_0x24ffd6(0x155)](),_0x15e05b=await sales_return_finished[_0x24ffd6(0x1f0)]({'invoice':_0x3b246c}),_0x4bae99=await warehouse[_0x24ffd6(0x1f0)]({'name':_0x1fe353,'room':_0x14c876});_0x15e05b[_0x24ffd6(0x19e)]['forEach'](_0x50c69e=>{var _0x2c34ba=_0x24ffd6,_0x97fc8f=0x0;const _0x10b265=_0x4bae99['product_details'][_0x2c34ba(0x170)](_0x36736a=>{var _0x7f750c=_0x2c34ba;_0x36736a[_0x7f750c(0x14a)]==_0x50c69e['product_name']&&_0x36736a[_0x7f750c(0x169)]==_0x50c69e[_0x7f750c(0x169)]&&_0x36736a['production_date']==_0x50c69e[_0x7f750c(0x1f6)]&&_0x36736a['batch_code']==_0x50c69e[_0x7f750c(0x17c)]&&(_0x36736a[_0x7f750c(0x197)]=parseInt(_0x36736a[_0x7f750c(0x197)])+parseInt(_0x50c69e[_0x7f750c(0x1ab)]),_0x97fc8f++);});_0x97fc8f=='0'&&(_0x4bae99[_0x2c34ba(0x1f8)]=_0x4bae99['product_details'][_0x2c34ba(0x1cc)]({'product_name':_0x50c69e[_0x2c34ba(0x14a)],'product_stock':_0x50c69e[_0x2c34ba(0x1ab)],'primary_code':_0x50c69e[_0x2c34ba(0x158)],'secondary_code':_0x50c69e[_0x2c34ba(0x21a)],'product_code':_0x50c69e[_0x2c34ba(0x13a)],'batch_code':_0x50c69e[_0x2c34ba(0x17c)],'maxPerUnit':_0x50c69e[_0x2c34ba(0x121)],'production_date':_0x50c69e[_0x2c34ba(0x1f6)],'expiry_date':_0x50c69e[_0x2c34ba(0x169)],'secondary_unit':_0x50c69e[_0x2c34ba(0x1dd)],'unit':_0x50c69e['unit'],'maxProducts':_0x50c69e[_0x2c34ba(0x1c4)],'bay':_0x50c69e[_0x2c34ba(0x236)]}));}),await _0x4bae99['save']();const _0xfb7678=new c_payment_data({'invoice':_0x3b246c,'customer':_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x14f)],'reason':'Sale\x20Return'});await _0xfb7678['save']();const _0x357b13=await master_shop[_0x24ffd6(0x235)](),_0x4b45be=await email_settings[_0x24ffd6(0x1f0)](),_0x3af27c=await customer[_0x24ffd6(0x1f0)]({'name':_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x14f)]});_0x357b13[0x0]['currency_placement']==0x1?(right_currency=_0x357b13[0x0][_0x24ffd6(0x1f5)],left_currency=''):(right_currency='',left_currency=_0x357b13[0x0][_0x24ffd6(0x1f5)]);var _0x2e312d=_0x3a2e49,_0x521775=_0x2d5f33,_0x453c6f='',_0x1e3426;for(_0x1e3426 in _0x2e312d){_0x453c6f+=_0x24ffd6(0x233)+_0x24ffd6(0x21f)+_0x2e312d[_0x1e3426]+_0x24ffd6(0x26a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x521775[_0x1e3426]+'</td>'+_0x24ffd6(0x13b);}console['log'](_0x24ffd6(0x134),_0x453c6f);let _0x56426f=nodemailer[_0x24ffd6(0x1aa)]({'service':_0x24ffd6(0x1a6),'auth':{'user':_0x4b45be[_0x24ffd6(0x149)],'pass':_0x4b45be[_0x24ffd6(0x200)]}}),_0x2ca42d={'from':_0x4b45be[_0x24ffd6(0x149)],'to':_0x3af27c[_0x24ffd6(0x149)],'subject':_0x24ffd6(0x243),'attachments':[{'filename':_0x24ffd6(0x1c0),'path':__dirname+_0x24ffd6(0x157)+_0x24ffd6(0x214)+_0x357b13[0x0][_0x24ffd6(0x167)],'cid':_0x24ffd6(0x1ff)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x24ffd6(0x13c)+_0x24ffd6(0x269)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x24ffd6(0x269)+_0x24ffd6(0x26b)+_0x24ffd6(0x239)+_0x24ffd6(0x269)+'<h2>\x20'+_0x357b13[0x0][_0x24ffd6(0x262)]+_0x24ffd6(0x25d)+_0x24ffd6(0x239)+'</div>'+_0x24ffd6(0x205)+'<div>'+_0x24ffd6(0x1ae)+_0x24ffd6(0x261)+_0x3b246c+'\x20'+_0x24ffd6(0x1d0)+_0x24ffd6(0x1b3)+_0xfbfe09+'\x20'+'</span>'+'</h5>'+_0x24ffd6(0x239)+_0x24ffd6(0x1b8)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x24ffd6(0x233)+_0x24ffd6(0x144)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x24ffd6(0x1e8)+_0x24ffd6(0x14c)+_0x24ffd6(0x13b)+_0x24ffd6(0x17b)+_0x24ffd6(0x227)+'\x20'+_0x453c6f+'\x20'+_0x24ffd6(0x1e5)+_0x24ffd6(0x1d5)+'<div>'+_0x24ffd6(0x1af)+_0x24ffd6(0x140)+_0x357b13[0x0][_0x24ffd6(0x262)]+_0x24ffd6(0x15a)+_0x24ffd6(0x239)+_0x24ffd6(0x239)+_0x24ffd6(0x1a3)};_0x56426f[_0x24ffd6(0x1f1)](_0x2ca42d,function(_0x23ee0c,_0x3e20b8){var _0x4e5c83=_0x24ffd6;_0x23ee0c?(console[_0x4e5c83(0x206)](_0x23ee0c),console[_0x4e5c83(0x206)](_0x4e5c83(0x1ca))):console[_0x4e5c83(0x206)](_0x4e5c83(0x175));}),_0x4e402c['flash'](_0x24ffd6(0x1f7),_0x24ffd6(0x15b)),_0x358dba[_0x24ffd6(0x1eb)](_0x24ffd6(0x147));}catch(_0x121aa3){_0x358dba[_0x24ffd6(0x226)](0xc8)[_0x24ffd6(0x12b)]({'message1':_0x121aa3[_0x24ffd6(0x196)]});}else{if(_0x4e402c['body']['for_categorize']=='GS')try{const {invoice:_0x171158,date:_0x332a31,warehouse_name:_0x7011c0,product_name:_0x11ba3e,primary_code:_0x51d5ad,secondary_code:_0x2b8e34,product_code:_0x47fab1,sales_quantity:_0x5c085e,stocks:_0x2ab1a7,return_qty:_0x2565c0,Room_name:_0x14dae2,to_warehouse_name:_0x5a9285,to_Room_name:_0x1e7eaf,note:_0x47f540,level:_0x2bc5da,isle:_0x4c0dde,pallet:_0x9a4c00,for_categorize:_0x2a326d}=_0x4e402c[_0x24ffd6(0x21b)];if(typeof _0x11ba3e==_0x24ffd6(0x256))var _0x3a2e49=[_0x4e402c['body']['product_name']],_0x3128a5=[_0x4e402c['body']['primary_code']],_0x250f4a=[_0x4e402c['body']['secondary_code']],_0x37fd3f=[_0x4e402c['body'][_0x24ffd6(0x13a)]],_0x275800=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x229)]],_0x2d5f33=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1ab)]],_0x2a5934=[_0x4e402c[_0x24ffd6(0x21b)]['bay']],_0x23b682=[_0x4e402c['body'][_0x24ffd6(0x121)]],_0x3a7199=[_0x4e402c['body'][_0x24ffd6(0x1c4)]],_0x11e723=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x17c)]],_0x3d66dd=[_0x4e402c['body'][_0x24ffd6(0x1dd)]],_0x397d9b=[_0x4e402c[_0x24ffd6(0x21b)]['unit']],_0x263c0a=[_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1f6)]],_0x44e2a1=[_0x4e402c[_0x24ffd6(0x21b)]['expiry_date']];else var _0x3a2e49=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x14a)]],_0x3128a5=[..._0x4e402c[_0x24ffd6(0x21b)]['primary_code']],_0x250f4a=[..._0x4e402c[_0x24ffd6(0x21b)]['secondary_code']],_0x37fd3f=[..._0x4e402c[_0x24ffd6(0x21b)]['product_code']],_0x275800=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x229)]],_0x2d5f33=[..._0x4e402c[_0x24ffd6(0x21b)]['return_qty']],_0x2a5934=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x236)]],_0x23b682=[..._0x4e402c['body'][_0x24ffd6(0x121)]],_0x3a7199=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1c4)]],_0x11e723=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x17c)]],_0x3d66dd=[..._0x4e402c['body'][_0x24ffd6(0x1dd)]],_0x397d9b=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x1b4)]],_0x263c0a=[..._0x4e402c[_0x24ffd6(0x21b)]['production_date']],_0x44e2a1=[..._0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x169)]];const _0x25b310=_0x3a2e49[_0x24ffd6(0x170)](_0x357b0f=>{return _0x357b0f={'product_name':_0x357b0f};});_0x3128a5[_0x24ffd6(0x1c3)]((_0x44c2d5,_0x1423d4)=>{_0x25b310[_0x1423d4]['primary_code']=_0x44c2d5;}),_0x250f4a['forEach']((_0x527ce4,_0x330ce0)=>{_0x25b310[_0x330ce0]['secondary_code']=_0x527ce4;}),_0x37fd3f[_0x24ffd6(0x1c3)]((_0x2adf64,_0x2e5cb1)=>{var _0x50f9d0=_0x24ffd6;_0x25b310[_0x2e5cb1][_0x50f9d0(0x13a)]=_0x2adf64;}),_0x275800[_0x24ffd6(0x1c3)]((_0x5efcd9,_0x4a1a2b)=>{var _0x51b4d6=_0x24ffd6;_0x25b310[_0x4a1a2b][_0x51b4d6(0x159)]=_0x5efcd9;}),_0x2d5f33['forEach']((_0x4bc2f9,_0x58805c)=>{_0x25b310[_0x58805c]['return_qty']=_0x4bc2f9;}),_0x2a5934[_0x24ffd6(0x1c3)]((_0x5d3008,_0x6acf11)=>{var _0x5dd7e=_0x24ffd6;_0x25b310[_0x6acf11][_0x5dd7e(0x236)]=_0x5d3008;}),_0x23b682[_0x24ffd6(0x1c3)]((_0x5eb3be,_0x432dc7)=>{var _0x139941=_0x24ffd6;_0x25b310[_0x432dc7][_0x139941(0x121)]=_0x5eb3be;}),_0x3a7199[_0x24ffd6(0x1c3)]((_0x2544dd,_0x4c14f4)=>{var _0x467f56=_0x24ffd6;_0x25b310[_0x4c14f4][_0x467f56(0x1c4)]=_0x2544dd;}),_0x11e723[_0x24ffd6(0x1c3)]((_0x55dd2d,_0x4c2cca)=>{var _0x544d36=_0x24ffd6;_0x25b310[_0x4c2cca][_0x544d36(0x17c)]=_0x55dd2d;}),_0x3d66dd[_0x24ffd6(0x1c3)]((_0x51a304,_0x7d3ce5)=>{var _0x4b7c29=_0x24ffd6;_0x25b310[_0x7d3ce5][_0x4b7c29(0x1dd)]=_0x51a304;}),_0x397d9b['forEach']((_0x4af757,_0x49d3cd)=>{var _0x48b156=_0x24ffd6;_0x25b310[_0x49d3cd][_0x48b156(0x1b4)]=_0x4af757;}),_0x263c0a[_0x24ffd6(0x1c3)]((_0x43d101,_0x3ef8e6)=>{_0x25b310[_0x3ef8e6]['production_date']=_0x43d101;}),_0x44e2a1[_0x24ffd6(0x1c3)]((_0x4eb108,_0x202073)=>{_0x25b310[_0x202073]['expiry_date']=_0x4eb108;});var _0x2eff3b=0x0;_0x25b310[_0x24ffd6(0x1c3)](_0x84cd77=>{var _0x440405=_0x24ffd6;(parseInt(_0x84cd77[_0x440405(0x159)])<parseInt(_0x84cd77[_0x440405(0x1ab)])||parseInt(_0x84cd77[_0x440405(0x24b)])<parseInt(_0x84cd77[_0x440405(0x1ab)])&&parseInt(_0x84cd77['sale_qty'])>parseInt(_0x84cd77['return_qty'])||parseInt(_0x84cd77[_0x440405(0x1ab)])==0x0)&&_0x2eff3b++;});if(_0x2eff3b!=0x0)return _0x4e402c[_0x24ffd6(0x251)](_0x24ffd6(0x16b),_0x24ffd6(0x132)),_0x358dba[_0x24ffd6(0x1eb)](_0x24ffd6(0x127));const _0x9ef6a=await sales_finished[_0x24ffd6(0x1f0)]({'invoice':_0x171158});_0x9ef6a[_0x24ffd6(0x241)]=_0x24ffd6(0x160);const _0x57a74a=await _0x9ef6a['save'](),_0x174c7e=new sales_return_finished({'invoice':_0x171158,'customer':_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x14f)],'date':_0x332a31,'warehouse_name':_0x7011c0,'room':_0x14dae2,'ToWarehouse':_0x5a9285,'ToRoom':_0x1e7eaf,'return_sale':_0x25b310,'note':_0x47f540,'warehouse_cat':_0x2a326d}),_0x366b3c=await _0x174c7e[_0x24ffd6(0x155)](),_0xfddb58=await sales_return_finished[_0x24ffd6(0x1f0)]({'invoice':_0x171158}),_0x282517=await warehouse[_0x24ffd6(0x1f0)]({'name':_0x5a9285,'room':_0x1e7eaf,'warehouse_category':_0x24ffd6(0x201)});_0xfddb58[_0x24ffd6(0x248)][_0x24ffd6(0x1c3)](_0x3c0500=>{var _0x4368be=_0x24ffd6,_0x37cbaf=0x0;const _0x4e1278=_0x282517[_0x4368be(0x1f8)]['map'](_0x23372c=>{var _0x79a328=_0x4368be;_0x23372c[_0x79a328(0x14a)]==_0x3c0500[_0x79a328(0x14a)]&&_0x23372c[_0x79a328(0x236)]==_0x3c0500['bay']&&_0x23372c[_0x79a328(0x169)]==_0x3c0500['expiry_date']&&_0x23372c[_0x79a328(0x1f6)]==_0x3c0500[_0x79a328(0x1f6)]&&_0x23372c[_0x79a328(0x17c)]==_0x3c0500[_0x79a328(0x17c)]&&(_0x23372c[_0x79a328(0x197)]=parseInt(_0x23372c[_0x79a328(0x197)])+parseInt(_0x3c0500['return_qty']),_0x37cbaf++);});_0x37cbaf=='0'&&(_0x282517[_0x4368be(0x1f8)]=_0x282517[_0x4368be(0x1f8)]['concat']({'product_name':_0x3c0500[_0x4368be(0x14a)],'product_stock':_0x3c0500[_0x4368be(0x1ab)],'primary_code':_0x3c0500['primary_code'],'secondary_code':_0x3c0500[_0x4368be(0x21a)],'product_code':_0x3c0500[_0x4368be(0x13a)],'bay':_0x3c0500[_0x4368be(0x236)],'batch_code':_0x3c0500[_0x4368be(0x17c)],'maxPerUnit':_0x3c0500[_0x4368be(0x121)],'production_date':_0x3c0500[_0x4368be(0x1f6)],'expiry_date':_0x3c0500['expiry_date'],'secondary_unit':_0x3c0500[_0x4368be(0x1dd)],'unit':_0x3c0500['unit'],'maxProducts':_0x3c0500['maxProducts']}));}),await _0x282517['save'](),console[_0x24ffd6(0x206)](_0x4e402c[_0x24ffd6(0x21b)]);const _0x127e45=new c_payment_data({'invoice':_0x171158,'customer':_0x4e402c['body'][_0x24ffd6(0x14f)],'reason':_0x24ffd6(0x230)});await _0x127e45[_0x24ffd6(0x155)]();const _0x3222cd=await master_shop[_0x24ffd6(0x235)]();console[_0x24ffd6(0x206)](_0x24ffd6(0x1e2),_0x3222cd[0x0][_0x24ffd6(0x167)]);const _0x195c47=await email_settings[_0x24ffd6(0x1f0)](),_0x43715d=await customer['findOne']({'name':_0x4e402c[_0x24ffd6(0x21b)][_0x24ffd6(0x14f)]});console[_0x24ffd6(0x206)]('customer_data',_0x43715d);_0x3222cd[0x0][_0x24ffd6(0x24f)]==0x1?(right_currency=_0x3222cd[0x0][_0x24ffd6(0x1f5)],left_currency=''):(right_currency='',left_currency=_0x3222cd[0x0][_0x24ffd6(0x1f5)]);var _0x2e312d=_0x3a2e49,_0x521775=_0x2d5f33,_0x453c6f='',_0x1e3426;for(_0x1e3426 in _0x2e312d){_0x453c6f+=_0x24ffd6(0x233)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2e312d[_0x1e3426]+_0x24ffd6(0x26a)+_0x24ffd6(0x21f)+_0x521775[_0x1e3426]+_0x24ffd6(0x26a)+_0x24ffd6(0x13b);}console[_0x24ffd6(0x206)](_0x24ffd6(0x134),_0x453c6f);let _0x383722=nodemailer[_0x24ffd6(0x1aa)]({'service':'gmail','auth':{'user':_0x195c47[_0x24ffd6(0x149)],'pass':_0x195c47[_0x24ffd6(0x200)]}}),_0x4e4811={'from':_0x195c47[_0x24ffd6(0x149)],'to':_0x43715d[_0x24ffd6(0x149)],'subject':_0x24ffd6(0x243),'attachments':[{'filename':_0x24ffd6(0x1c0),'path':__dirname+_0x24ffd6(0x157)+_0x24ffd6(0x214)+_0x3222cd[0x0]['image'],'cid':_0x24ffd6(0x1ff)}],'html':_0x24ffd6(0x163)+_0x24ffd6(0x150)+_0x24ffd6(0x13c)+_0x24ffd6(0x269)+_0x24ffd6(0x204)+_0x24ffd6(0x269)+_0x24ffd6(0x26b)+_0x24ffd6(0x239)+_0x24ffd6(0x269)+_0x24ffd6(0x257)+_0x3222cd[0x0]['site_title']+_0x24ffd6(0x25d)+'</div>'+_0x24ffd6(0x239)+_0x24ffd6(0x205)+_0x24ffd6(0x269)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x24ffd6(0x261)+_0x171158+'\x20'+_0x24ffd6(0x1d0)+_0x24ffd6(0x1b3)+_0x332a31+'\x20'+_0x24ffd6(0x1a0)+_0x24ffd6(0x15a)+_0x24ffd6(0x239)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x24ffd6(0x20b)+_0x24ffd6(0x233)+_0x24ffd6(0x144)+_0x24ffd6(0x141)+_0x24ffd6(0x1e8)+_0x24ffd6(0x14c)+_0x24ffd6(0x13b)+_0x24ffd6(0x17b)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x453c6f+'\x20'+_0x24ffd6(0x1e5)+'</table>'+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x24ffd6(0x140)+_0x3222cd[0x0]['site_title']+_0x24ffd6(0x15a)+'</div>'+_0x24ffd6(0x239)+'</body></html>'};_0x383722[_0x24ffd6(0x1f1)](_0x4e4811,function(_0x580833,_0x9937e3){var _0x3607ef=_0x24ffd6;_0x580833?(console['log'](_0x580833),console[_0x3607ef(0x206)]('Error\x20Occurs')):console['log'](_0x3607ef(0x175));}),_0x4e402c[_0x24ffd6(0x251)]('success',_0x24ffd6(0x15b)),_0x358dba[_0x24ffd6(0x1eb)](_0x24ffd6(0x147));}catch(_0x49835d){console['log'](_0x49835d),_0x358dba[_0x24ffd6(0x226)](0xc8)[_0x24ffd6(0x12b)]({'message1':_0x49835d[_0x24ffd6(0x196)]});}}}),router['get']('/barcode/:id',auth,async(_0x466914,_0x31d507)=>{var _0x5d6043=a0_0x1303ab;try{const {username:_0x1f1c89,email:_0x199dcb,role:_0x1bf363}=_0x466914['user'],_0x243a12=_0x466914[_0x5d6043(0x210)],_0x4e0ae6=await profile[_0x5d6043(0x1f0)]({'email':_0x243a12[_0x5d6043(0x149)]}),_0xb6cb5d=await master_shop[_0x5d6043(0x235)]();console['log'](_0x5d6043(0x25e),_0xb6cb5d);const _0x4acba1=_0x466914[_0x5d6043(0x171)]['id'],_0x1d7076=await sales[_0x5d6043(0x12f)](_0x4acba1);console['log']('barcode\x20user_id',_0x1d7076);if(_0xb6cb5d[0x0]['language']==_0x5d6043(0x22c))var _0x333d25=users[_0x5d6043(0x16c)];else{if(_0xb6cb5d[0x0]['language']==_0x5d6043(0x191))var _0x333d25=users[_0x5d6043(0x191)];else{if(_0xb6cb5d[0x0][_0x5d6043(0x14b)]==_0x5d6043(0x176))var _0x333d25=users[_0x5d6043(0x176)];else{if(_0xb6cb5d[0x0][_0x5d6043(0x14b)]==_0x5d6043(0x19b))var _0x333d25=users[_0x5d6043(0x19b)];else{if(_0xb6cb5d[0x0][_0x5d6043(0x14b)]==_0x5d6043(0x266))var _0x333d25=users[_0x5d6043(0x266)];else{if(_0xb6cb5d[0x0][_0x5d6043(0x14b)]==_0x5d6043(0x252))var _0x333d25=users[_0x5d6043(0x1ed)];else{if(_0xb6cb5d[0x0]['language']==_0x5d6043(0x136))var _0x333d25=users[_0x5d6043(0x136)];else{if(_0xb6cb5d[0x0][_0x5d6043(0x14b)]==_0x5d6043(0x14d))var _0x333d25=users[_0x5d6043(0x18e)];}}}}}}}_0x31d507['render'](_0x5d6043(0x25f),{'success':_0x466914[_0x5d6043(0x251)](_0x5d6043(0x1f7)),'errors':_0x466914[_0x5d6043(0x251)]('errors'),'role':_0x243a12,'profile':_0x4e0ae6,'alldata':_0x1d7076,'master_shop':_0xb6cb5d,'language':_0x333d25});}catch(_0x59bc46){console[_0x5d6043(0x206)](_0x59bc46);}}),router[a0_0x1303ab(0x1e1)](a0_0x1303ab(0x153),async(_0x36469d,_0x377fbe)=>{var _0x58ec08=a0_0x1303ab;const {product_code:_0x3fad73,warehouse_name:_0x24bb00,rooms_data:_0x352af0,Roomslist:_0x3c3728,sales_category:_0x24947e}=_0x36469d[_0x58ec08(0x21b)],_0x1fdc4c=_0x3c3728['split'](','),_0x3123a6=[];async function _0x5e600c(_0x45e589){var _0x27ba09=_0x58ec08;const _0x2e9c21=await warehouse['aggregate']([{'$match':{'name':_0x24bb00,'room':_0x45e589}},{'$unwind':_0x27ba09(0x1db)},{'$match':{'product_details.primary_code':_0x3fad73}},{'$group':{'_id':_0x27ba09(0x142),'name':{'$first':_0x27ba09(0x195)},'product_stock':{'$first':_0x27ba09(0x125)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x27ba09(0x25c)},'bay':{'$first':_0x27ba09(0x228)},'type':{'$first':_0x27ba09(0x25a)},'pallet':{'$first':_0x27ba09(0x249)},'unit':{'$first':_0x27ba09(0x1c8)},'secondary_unit':{'$first':_0x27ba09(0x244)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x27ba09(0x137)},'expiry_date':{'$first':_0x27ba09(0x1d7)},'production_date':{'$first':_0x27ba09(0x1d9)},'maxPerUnit':{'$first':_0x27ba09(0x24e)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x27ba09(0x18c)},'invoice':{'$first':_0x27ba09(0x263)},'uuid':{'$first':_0x27ba09(0x22b)},'gross_price':{'$first':_0x27ba09(0x22e)},'sales_category':{'$first':_0x27ba09(0x264)}}}]),_0x1590ca=await warehouse[_0x27ba09(0x12e)]([{'$match':{'name':_0x24bb00,'room':_0x45e589}},{'$unwind':_0x27ba09(0x1db)},{'$match':{'product_details.secondary_code':_0x3fad73}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x27ba09(0x195)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x27ba09(0x19f)},'secondary_code':{'$first':_0x27ba09(0x1a8)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x27ba09(0x228)},'isle':{'$first':_0x27ba09(0x1cd)},'type':{'$first':_0x27ba09(0x25a)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x27ba09(0x1c8)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x27ba09(0x135)},'rack':{'$first':_0x27ba09(0x137)},'expiry_date':{'$first':_0x27ba09(0x1d7)},'production_date':{'$first':_0x27ba09(0x1d9)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x27ba09(0x13e)},'product_cat':{'$first':_0x27ba09(0x253)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x27ba09(0x263)},'uuid':{'$first':_0x27ba09(0x22b)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x27ba09(0x264)}}}]);if(_0x2e9c21[_0x27ba09(0x133)]>0x0)_0x3123a6[_0x27ba09(0x225)](_0x2e9c21);else _0x1590ca['length']>0x0&&_0x3123a6[_0x27ba09(0x225)](_0x1590ca);}const _0x525991=_0x1fdc4c['map'](_0x4e7041=>_0x5e600c(_0x4e7041));await Promise[_0x58ec08(0x20c)](_0x525991),_0x377fbe[_0x58ec08(0x12b)](_0x3123a6);}),router[a0_0x1303ab(0x1e1)]('/barcode_scanner_logs',async(_0x16969c,_0x5a05c9)=>{var _0x58c0ac=a0_0x1303ab;const {product_code:_0x2fd932,warehouse_name:_0x829f80,rooms_data:_0x5ec96f,Roomslist:_0x36413c,sales_category:_0x35407b}=_0x16969c['body'],_0x388c28=_0x36413c[_0x58c0ac(0x1b1)](','),_0x226613=[];async function _0x3b332c(_0x610478){var _0x551f09=_0x58c0ac;const _0x3239da=await warehouse[_0x551f09(0x12e)]([{'$match':{'name':_0x829f80,'room':_0x610478}},{'$unwind':_0x551f09(0x1db)},{'$match':{'product_details.primary_code':_0x2fd932,'product_details.sales_category':_0x35407b,'product_details.type_products':'log'}},{'$group':{'_id':_0x551f09(0x142),'name':{'$first':_0x551f09(0x195)},'product_stock':{'$first':_0x551f09(0x125)},'primary_code':{'$first':_0x551f09(0x19f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x551f09(0x1fa)},'level':{'$first':_0x551f09(0x25c)},'bay':{'$first':'$product_details.bay'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x551f09(0x249)},'unit':{'$first':_0x551f09(0x1c8)},'secondary_unit':{'$first':_0x551f09(0x244)},'storage':{'$first':_0x551f09(0x135)},'rack':{'$first':_0x551f09(0x137)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x551f09(0x1d9)},'maxPerUnit':{'$first':_0x551f09(0x24e)},'batch_code':{'$first':_0x551f09(0x13e)},'product_cat':{'$first':_0x551f09(0x253)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x551f09(0x18c)},'invoice':{'$first':_0x551f09(0x263)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x551f09(0x22e)},'sales_category':{'$first':_0x551f09(0x264)},'type_products':{'$first':_0x551f09(0x247)}}}]);console[_0x551f09(0x206)](_0x551f09(0x206)+_0x551f09(0x185)+_0x2fd932+'\x20<>\x20'+_0x35407b);const _0x5deaea=await warehouse[_0x551f09(0x12e)]([{'$match':{'name':_0x829f80,'room':_0x610478}},{'$unwind':_0x551f09(0x1db)},{'$match':{'product_details.secondary_code':_0x2fd932,'product_details.sales_category':_0x35407b,'product_details.type_products':_0x551f09(0x206)}},{'$group':{'_id':_0x551f09(0x142),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x551f09(0x125)},'primary_code':{'$first':_0x551f09(0x19f)},'secondary_code':{'$first':_0x551f09(0x1a8)},'product_code':{'$first':_0x551f09(0x1fa)},'level':{'$first':_0x551f09(0x228)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x551f09(0x25a)},'pallet':{'$first':_0x551f09(0x249)},'unit':{'$first':_0x551f09(0x1c8)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x551f09(0x135)},'rack':{'$first':_0x551f09(0x137)},'expiry_date':{'$first':_0x551f09(0x1d7)},'production_date':{'$first':_0x551f09(0x1d9)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x551f09(0x13e)},'product_cat':{'$first':_0x551f09(0x253)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x551f09(0x18c)},'invoice':{'$first':_0x551f09(0x263)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x551f09(0x22e)},'sales_category':{'$first':_0x551f09(0x264)},'type_products':{'$first':'$product_details.type_products'}}}]);if(_0x3239da[_0x551f09(0x133)]>0x0)_0x226613[_0x551f09(0x225)](_0x3239da);else _0x5deaea['length']>0x0&&_0x226613[_0x551f09(0x225)](_0x5deaea);}const _0x3ca9d4=_0x388c28['map'](_0x564e14=>_0x3b332c(_0x564e14));await Promise[_0x58c0ac(0x20c)](_0x3ca9d4),_0x5a05c9[_0x58c0ac(0x12b)](_0x226613);}),router[a0_0x1303ab(0x1e1)](a0_0x1303ab(0x180),async(_0x4cee5d,_0x18e061)=>{var _0x140709=a0_0x1303ab;try{const {prduct_code:_0x31502a,warehouse_data:_0xf4f5e0,qty_req:_0x539ec1}=_0x4cee5d['body'];let _0x37b871=_0x31502a[_0x140709(0x1b1)]('~'),_0x561d25=_0x539ec1[_0x140709(0x1b1)]('~'),_0x394988=[],_0xdba5f2=0x0;for(let _0x561249=0x0;_0x561249<=_0x37b871[_0x140709(0x133)]-0x1;_0x561249++){const _0x21498c=_0x37b871[_0x561249],_0x9dd5b0=_0x561d25[_0x561249],_0xd59759=await warehouse[_0x140709(0x12e)]([{'$match':{'name':_0xf4f5e0}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x21498c,'product_details.isAvailable':_0x140709(0x131),'product_details.isUsed':_0x140709(0x1d6)}},{'$sort':{'product_details.date_received':0x1,'product_details.level':-0x1,'product_details.bay':-0x1}},{'$group':{'_id':_0x140709(0x142),'name':{'$first':_0x140709(0x195)},'product_stock':{'$first':_0x140709(0x125)},'primary_code':{'$first':_0x140709(0x19f)},'secondary_code':{'$first':_0x140709(0x1a8)},'product_code':{'$first':_0x140709(0x1fa)},'level':{'$first':'$product_details.level'},'bay':{'$first':'$product_details.bay'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x140709(0x249)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x140709(0x244)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x140709(0x1d7)},'production_date':{'$first':_0x140709(0x1d9)},'maxPerUnit':{'$first':_0x140709(0x24e)},'batch_code':{'$first':_0x140709(0x13e)},'product_cat':{'$first':_0x140709(0x253)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x140709(0x18c)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x140709(0x22b)},'gross_price':{'$first':_0x140709(0x22e)},'sales_category':{'$first':_0x140709(0x264)},'date_received':{'$first':_0x140709(0x268)},'warehouse_id':{'$first':_0x140709(0x1f9)}}}]),_0x3c3129=_0xd59759[_0x140709(0x267)]((_0x4bf71c,_0x6f9fca)=>new Date(_0x4bf71c[_0x140709(0x190)])-new Date(_0x6f9fca[_0x140709(0x190)]));let _0x2823df=_0x9dd5b0;for(let _0x3dd40b=0x0;_0x3dd40b<=_0x3c3129['length']-0x1&&_0x2823df>0x0;_0x3dd40b++){const _0x51f17f=_0x3c3129[_0x3dd40b];if(_0x51f17f[_0x140709(0x13a)]==_0x21498c){_0x394988[_0xdba5f2]={};const _0x3422c3=parseInt(_0x51f17f[_0x140709(0x197)]),_0x1211bb=0x0;let _0xd8bb39=_0x3422c3-_0x1211bb,_0x4096fe=Math[_0x140709(0x20d)](_0x2823df,_0xd8bb39);console[_0x140709(0x206)](_0x140709(0x23d)+_0x4096fe+'\x20units\x20to\x20warehouse:\x20'+_0xf4f5e0+_0x140709(0x24d)+_0x51f17f[_0x140709(0x172)]+_0x140709(0x1ea)+(_0x51f17f['level']+_0x51f17f['bay'])+_0x140709(0x1c5)+_0x51f17f[_0x140709(0x190)]+_0x140709(0x189)+_0x51f17f[_0x140709(0x203)]),_0x394988[_0xdba5f2][_0x140709(0x178)]=_0x51f17f['warehouse_id']+'~'+_0x51f17f[_0x140709(0x16e)]+'~'+_0x4096fe,_0x394988[_0xdba5f2][_0x140709(0x14a)]=_0x51f17f[_0x140709(0x203)],_0x394988[_0xdba5f2]['product_code']=_0x51f17f['product_code'],_0x394988[_0xdba5f2][_0x140709(0x22f)]=_0x51f17f['product_id'],_0x394988[_0xdba5f2][_0x140709(0x164)]=_0x51f17f[_0x140709(0x164)],_0x394988[_0xdba5f2][_0x140709(0x1ce)]=_0x51f17f[_0x140709(0x1ce)],_0x394988[_0xdba5f2][_0x140709(0x254)]=_0x51f17f[_0x140709(0x254)],_0x394988[_0xdba5f2][_0x140709(0x1f3)]=_0x4096fe,_0x394988[_0xdba5f2][_0x140709(0x1b4)]=_0x51f17f[_0x140709(0x1b4)],_0x394988[_0xdba5f2]['secondary_unit']=_0x51f17f[_0x140709(0x1dd)],_0x394988[_0xdba5f2][_0x140709(0x158)]=_0x51f17f[_0x140709(0x158)],_0x394988[_0xdba5f2]['secondary_code']=_0x51f17f['secondary_code'],_0x394988[_0xdba5f2][_0x140709(0x1ac)]=_0x51f17f['maxStocks'],_0x394988[_0xdba5f2][_0x140709(0x17c)]=_0x51f17f[_0x140709(0x17c)],_0x394988[_0xdba5f2][_0x140709(0x169)]=_0x51f17f[_0x140709(0x169)],_0x394988[_0xdba5f2][_0x140709(0x1f6)]=_0x51f17f[_0x140709(0x1f6)],_0x394988[_0xdba5f2][_0x140709(0x17d)]=_0x51f17f[_0x140709(0x17d)],_0x394988[_0xdba5f2][_0x140709(0x145)]=_0x51f17f[_0x140709(0x145)],_0x394988[_0xdba5f2]['invoice']=_0x51f17f[_0x140709(0x1c2)],_0x394988[_0xdba5f2][_0x140709(0x126)]=_0x51f17f['gross_price'],_0x394988[_0xdba5f2]['room_name']=_0x51f17f[_0x140709(0x172)],_0x394988[_0xdba5f2][_0x140709(0x1e7)]=_0x51f17f[_0x140709(0x1e7)],_0x394988[_0xdba5f2]['bay']=_0x51f17f[_0x140709(0x236)],_0x394988[_0xdba5f2]['status']=_0x140709(0x131),console[_0x140709(0x206)]('1',_0xdba5f2),_0x2823df-=_0x4096fe,_0xdba5f2++;if(_0x2823df<=0x0)break;}}if(_0x2823df>0x0){var _0x515106=await product[_0x140709(0x1f0)]({'product_code':_0x21498c});console[_0x140709(0x206)]('2',_0xdba5f2),_0x394988[_0xdba5f2]={},_0x394988[_0xdba5f2][_0x140709(0x14a)]=_0x515106[_0x140709(0x203)],_0x394988[_0xdba5f2][_0x140709(0x13a)]=_0x21498c,_0x394988[_0xdba5f2][_0x140709(0x22f)]=_0x515106['_id'][_0x140709(0x193)](),_0x394988[_0xdba5f2][_0x140709(0x1f3)]=_0x2823df,_0x394988[_0xdba5f2]['standard_unit']=_0x515106[_0x140709(0x1b4)],_0x394988[_0xdba5f2][_0x140709(0x1dd)]=_0x515106[_0x140709(0x19c)],_0x394988[_0xdba5f2]['primary_code']=_0x515106[_0x140709(0x158)],_0x394988[_0xdba5f2]['secondary_code']=_0x515106[_0x140709(0x21a)],_0x394988[_0xdba5f2][_0x140709(0x1ac)]=_0x515106['maxStocks'],_0x394988[_0xdba5f2]['maxperunit']=_0x515106[_0x140709(0x17e)],_0x394988[_0xdba5f2]['gross_price']=_0x515106[_0x140709(0x126)],_0x394988[_0xdba5f2][_0x140709(0x226)]='false',console[_0x140709(0x206)](_0x140709(0x1da)+_0x2823df+'\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20'+_0xdba5f2+'\x20<>\x20'+_0x21498c),_0xdba5f2++;}}_0x18e061[_0x140709(0x12b)](_0x394988);}catch(_0x51549e){console[_0x140709(0x206)](_0x51549e);}}),router['post']('/barcode_scanner_auto',async(_0xcdfdf4,_0x555fc1)=>{var _0x3831d2=a0_0x1303ab;const {product_code:_0x5f2363}=_0xcdfdf4[_0x3831d2(0x21b)];var _0x323e00;const _0x2be2af=await product[_0x3831d2(0x12e)]([{'$match':{'primary_code':_0x5f2363}},{'$group':{'_id':'$_id','name':{'$first':_0x3831d2(0x154)},'category':{'$first':_0x3831d2(0x23a)},'brand':{'$first':_0x3831d2(0x16d)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x3831d2(0x1c1)},'product_code':{'$first':_0x3831d2(0x22d)},'primary_code':{'$first':_0x3831d2(0x1fe)},'secondary_code':{'$first':_0x3831d2(0x18a)},'maxStocks':{'$first':_0x3831d2(0x19a)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'},'gross_price':{'$first':_0x3831d2(0x1bc)},'sales_category':{'$first':_0x3831d2(0x224)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x210834=await product[_0x3831d2(0x12e)]([{'$match':{'secondary_code':_0x5f2363}},{'$group':{'_id':'$_id','name':{'$first':_0x3831d2(0x154)},'category':{'$first':_0x3831d2(0x23a)},'brand':{'$first':_0x3831d2(0x16d)},'unit':{'$first':'$unit'},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x3831d2(0x22d)},'primary_code':{'$first':_0x3831d2(0x1fe)},'secondary_code':{'$first':_0x3831d2(0x18a)},'maxStocks':{'$first':_0x3831d2(0x19a)},'maxProdPerUnit':{'$first':_0x3831d2(0x1f2)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x3831d2(0x222)},'gross_price':{'$first':'$gross_price'},'sales_category':{'$first':_0x3831d2(0x224)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x2be2af[_0x3831d2(0x133)]>0x0)_0x323e00=_0x2be2af;else _0x210834[_0x3831d2(0x133)]>0x0&&(_0x323e00=_0x210834);_0x555fc1[_0x3831d2(0x12b)](_0x323e00);}),router[a0_0x1303ab(0x1e1)](a0_0x1303ab(0x194),async(_0x52b905,_0x4b0681)=>{var _0x771f4c=a0_0x1303ab;try{const {group_id:_0x356970,DRSI:_0x4e842a,dateofreq:_0x159a1b,PO_number:_0x45ee1b,date:_0x3a7759,warehouse_name:_0x51379f,typevehicle:_0x5ccf02,deliverydate:_0x527b16,driver:_0x5a73a6,plate:_0x65dce1,van:_0x3e8b90,TSU:_0x2d7fc7,actual_delivery_date:_0x8b49a6,TFU:_0x2a00a7,pull_out_date:_0x1d8c6d,sales:_0x67ba2f,Customer_data:_0x2c415b,note:_0x1ae9b2}=_0x52b905[_0x771f4c(0x21b)],_0x38f053=mongoose['Types'][_0x771f4c(0x212)];let _0x38e4d6=[];const _0x50e817=new invoice_for_outgoing();await _0x50e817[_0x771f4c(0x155)]();const _0x55811a=_0x771f4c(0x18f)+_0x50e817[_0x771f4c(0x1d4)][_0x771f4c(0x207)]()[_0x771f4c(0x1ba)](0x8,'0');if(typeof _0x356970==_0x771f4c(0x256)){let _0x13dd24=_0x356970['split']('~');var _0x261782=_0x38f053(_0x13dd24[0x0]),_0x432d07=_0x38f053(_0x13dd24[0x1]),_0x115991=_0x13dd24[0x2];let _0xecdcdf=0x0;const _0x370cf2=await warehouse[_0x771f4c(0x12e)]([{'$match':{'_id':_0x261782}},{'$unwind':_0x771f4c(0x1db)},{'$match':{'product_details._id':_0x432d07}}]);await warehouse[_0x771f4c(0x26e)]({'_id':_0x38f053(_0x261782),'product_details._id':_0x38f053(_0x432d07)},{'$set':{'product_details.$.isUsed':_0x771f4c(0x131)}}),_0x38e4d6[_0xecdcdf]={};for(let _0x2b7838=0x0;_0x2b7838<=_0x370cf2[_0x771f4c(0x133)]-0x1;_0x2b7838++){const _0x223f68=_0x370cf2[_0x2b7838];console['log'](_0x223f68),_0x38e4d6[_0xecdcdf][_0x771f4c(0x1a7)]=_0x223f68[_0x771f4c(0x203)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x22f)]=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x22f)],_0x38e4d6[_0xecdcdf]['product_name']=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x14a)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x13a)]=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x13a)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x197)]=_0x115991,_0x38e4d6[_0xecdcdf][_0x771f4c(0x1f3)]=_0x115991,_0x38e4d6[_0xecdcdf][_0x771f4c(0x1b4)]=_0x223f68['product_details']['unit'],_0x38e4d6[_0xecdcdf]['secondary_unit']=_0x223f68[_0x771f4c(0x1f8)]['secondary_unit'],_0x38e4d6[_0xecdcdf][_0x771f4c(0x1e7)]=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x1e7)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x236)]=_0x223f68[_0x771f4c(0x1f8)]['bay'],_0x38e4d6[_0xecdcdf][_0x771f4c(0x158)]=_0x223f68['product_details'][_0x771f4c(0x158)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x21a)]=_0x223f68[_0x771f4c(0x1f8)]['secondary_code'],_0x38e4d6[_0xecdcdf]['maxStocks']=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x1ac)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x17c)]=_0x223f68['product_details']['batch_code'],_0x38e4d6[_0xecdcdf][_0x771f4c(0x169)]=_0x223f68[_0x771f4c(0x1f8)]['expiry_date'],_0x38e4d6[_0xecdcdf]['production_date']=_0x223f68['product_details'][_0x771f4c(0x1f6)],_0x38e4d6[_0xecdcdf]['maxperunit']=_0x223f68['product_details'][_0x771f4c(0x17d)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x145)]=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x145)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x21c)]=_0x223f68[_0x771f4c(0x129)],_0x38e4d6[_0xecdcdf]['invoice']=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x1c2)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x254)]=_0x223f68['product_details']['uuid'],_0x38e4d6[_0xecdcdf][_0x771f4c(0x126)]=_0x223f68[_0x771f4c(0x1f8)]['gross_price'],_0x38e4d6[_0xecdcdf][_0x771f4c(0x1ce)]=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x166)],_0x38e4d6[_0xecdcdf]['date_recieved']=_0x223f68['product_details'][_0x771f4c(0x164)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x20e)]=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x166)],_0x38e4d6[_0xecdcdf][_0x771f4c(0x177)]=_0x223f68['_id'][_0x771f4c(0x193)](),_0x38e4d6[_0xecdcdf]['warehouse_id_detl']=_0x223f68[_0x771f4c(0x1f8)][_0x771f4c(0x16e)][_0x771f4c(0x193)](),_0x38e4d6[_0xecdcdf]['data_type']=_0x771f4c(0x122),_0x38e4d6[_0xecdcdf][_0x771f4c(0x1b6)]=_0x223f68[_0x771f4c(0x1f8)]['sales'];}_0x38e4d6[_0xecdcdf]['outgoiug_inv']=_0x55811a;}else for(let _0x14f7c9=0x0;_0x14f7c9<=_0x356970['length']-0x1;_0x14f7c9++){const _0x3061be=_0x356970[_0x14f7c9];let _0x4d37a4=_0x3061be[_0x771f4c(0x1b1)]('~');console[_0x771f4c(0x206)](_0x4d37a4);var _0x261782=_0x38f053(_0x4d37a4[0x0]),_0x432d07=_0x38f053(_0x4d37a4[0x1]),_0x115991=_0x4d37a4[0x2];const _0x62eee4=await warehouse[_0x771f4c(0x12e)]([{'$match':{'_id':_0x261782}},{'$unwind':_0x771f4c(0x1db)},{'$match':{'product_details._id':_0x432d07}}]);await warehouse[_0x771f4c(0x26e)]({'_id':_0x38f053(_0x261782),'product_details._id':_0x38f053(_0x432d07)},{'$set':{'product_details.$.isUsed':_0x771f4c(0x131)}}),_0x38e4d6[_0x14f7c9]={};for(let _0x3a4872=0x0;_0x3a4872<=_0x62eee4['length']-0x1;_0x3a4872++){const _0x1cbb83=_0x62eee4[_0x3a4872];_0x38e4d6[_0x14f7c9][_0x771f4c(0x1a7)]=_0x1cbb83[_0x771f4c(0x203)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x22f)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x22f)],_0x38e4d6[_0x14f7c9]['product_name']=_0x1cbb83[_0x771f4c(0x1f8)]['product_name'],_0x38e4d6[_0x14f7c9][_0x771f4c(0x13a)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x13a)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x197)]=_0x115991,_0x38e4d6[_0x14f7c9][_0x771f4c(0x1f3)]=_0x115991,_0x38e4d6[_0x14f7c9][_0x771f4c(0x1b4)]=_0x1cbb83['product_details'][_0x771f4c(0x1b4)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x1dd)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x1dd)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x1e7)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x1e7)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x236)]=_0x1cbb83['product_details'][_0x771f4c(0x236)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x158)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x158)],_0x38e4d6[_0x14f7c9]['secondary_code']=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x21a)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x1ac)]=_0x1cbb83['product_details'][_0x771f4c(0x1ac)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x17c)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x17c)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x169)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x169)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x1f6)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x1f6)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x17d)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x17d)],_0x38e4d6[_0x14f7c9]['product_cat']=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x145)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x21c)]=_0x1cbb83[_0x771f4c(0x129)],_0x38e4d6[_0x14f7c9]['invoice']=_0x1cbb83[_0x771f4c(0x1f8)]['invoice'],_0x38e4d6[_0x14f7c9]['uuid']=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x254)],_0x38e4d6[_0x14f7c9]['gross_price']=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x126)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x1ce)]=_0x1cbb83['product_details'][_0x771f4c(0x166)],_0x38e4d6[_0x14f7c9]['date_recieved']=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x164)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x20e)]=_0x1cbb83['product_details'][_0x771f4c(0x166)],_0x38e4d6[_0x14f7c9][_0x771f4c(0x177)]=_0x1cbb83['_id'][_0x771f4c(0x193)](),_0x38e4d6[_0x14f7c9][_0x771f4c(0x220)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x16e)][_0x771f4c(0x193)](),_0x38e4d6[_0x14f7c9][_0x771f4c(0x1ee)]=_0x771f4c(0x122),_0x38e4d6[_0x14f7c9][_0x771f4c(0x1b6)]=_0x1cbb83[_0x771f4c(0x1f8)][_0x771f4c(0x166)];}_0x38e4d6[_0x14f7c9]['outgoiug_inv']=_0x55811a;}for(let _0x28ed03=0x0;_0x28ed03<=_0x38e4d6[_0x771f4c(0x133)]-0x1;_0x28ed03++){const _0x2d26c8=_0x38e4d6[_0x28ed03],_0x146d06=new warehouse_temporary(_0x2d26c8);await _0x146d06[_0x771f4c(0x155)]();}const _0x34d7ff=new sales_finished({'invoice':_0x55811a,'sales_data':_0x67ba2f,'customer':_0x2c415b,'date':_0x3a7759,'warehouse_name':_0x51379f,'sale_product':_0x38e4d6,'note':_0x1ae9b2,'finalize':'False','dateofreq':_0x159a1b,'PO_number':_0x45ee1b,'typevehicle':_0x5ccf02,'deliverydate':_0x527b16,'driver':_0x5a73a6,'plate':_0x65dce1,'van':_0x3e8b90,'DRSI':_0x4e842a,'TSU':_0x2d7fc7,'TFU':_0x2a00a7,'pullout_date':_0x1d8c6d,'actualdelivery_date':_0x8b49a6,'typeOfProducts':_0x771f4c(0x242)}),_0x35973c=await _0x34d7ff['save']();_0x52b905[_0x771f4c(0x251)]('success',_0x771f4c(0x161)),_0x4b0681['redirect'](_0x771f4c(0x14e)+_0x35973c[_0x771f4c(0x16e)]);}catch(_0x3055df){console[_0x771f4c(0x206)](_0x3055df);}}),module[a0_0x1303ab(0x258)]=router;