var a0_0x3457ae=a0_0x5511;function a0_0x57b5(){var _0x11074e=['product_details','status','$product_details.uuid','<hr\x20class=\x22my-3\x22>','render','stocks_QA','$sale_product.floorlevel','$invoice','2007516hiNwbn','$product_details.rack','logs','staff','warehouse','product_stock','date_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','French','14780348xLNVXh','$product_details.bin','return_qty','$product_details.room_name','maxPerUnit','padStart','secondary_unit','logo','English\x20(US)','received_amount','undefined','finalize','currency','Error\x20Occurs','customer','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.secondary_unit','$note','Arabic','room_name','LOG-OUT-','/invoice/:id','maxProducts_QA','split','<h2>\x20','/view_log','72zKLBra','/give_payment/:id','\x20==\x20','$sale_product.bay','save','batch_code','all','maxProducts','<h5>','$product_details.secondary_code','<strong>\x20Regards\x20</strong>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','body','<html><head><title></title>','prod_invoice','$sale_product.type','floor','return_data','level2','/barcode_scanner_logs','concat','Chinese','return_sale','<table\x20style=\x22width:\x20100%\x20!important;\x22>','image','$return_data','\x20</h2>','$product_details._id','master','$product_details.type','/all_sales_finished/view','$warehouse_name','int','</tr>','\x20Order\x20Number\x20:\x20','getMonth','string','$product_details','foreach\x20newproduct','_id','errors','</table>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','push','expiry_date_QA','expiry_date','Received\x20Payment\x20For\x20Sale','site_title','invoice','Portuguese\x20(BR)','customer_data','own','batch_code_QA','$product_details.product_cat','Spanish','OUT-','Email\x20sent\x20successfully','Portuguese','/../public','unit','return_sale_finished','$product_details.maxPerUnit','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','maxperunit','/all_sales_finished/preview/','warehouse_id','find','$product_details.level','product','max_per_unit','all_sales_finished','room','outgoing_invoice','maxPerUnit_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$sale_product','getDate','$customers_docs','Hindi','1HkvqwP','product_list','$name','role','uuid','secondary_code','sale_product','email','\x20<>\x20','<div>','return_sale_QA','id_transaction_from','redirect','<h5\x20style=\x22text-align:\x20left;\x22>','1346794jwKeCj','sales_quantity_QA','$product_details.gross_price','sales_quantity','return_qty_QA','invoice_init','Enclosed','$product_details.storage','$product_details.product_name','success','express','../middleware/auth','length','708MUkhTT','message','password','user','production_date_QA','primary_code_QA','<!DOCTYPE\x20html>','/preview/:id','Sales\x20Add\x20successfully','<tr>','Finished\x20Goods','</thead>','gross_price','Arabic\x20(ae)','../public/language/languages.json','Quality\x20Inspection','valueOf','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$sale_product.quantity','add_sales_finished_logs','max','get','3779376vNmjtv','production_date','filter','primary_unit','$room','Sale\x20Return','<span\x20style=\x22float:\x20right;\x22>','sales','barcode\x20user_id','Ambient','<tbody\x20style=\x22text-align:\x20center;\x22>','product_name','amount','\x20Order\x20Date\x20:\x20','edit_sales_finished_view','2985FoALxu','findOne','Sale\x20Return\x20Mail','553905JDQhwW','sendMail','random','/view','</head><body>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','flash','$product_details.floorlevel','currency_placement','forEach','$product_details.maxProducts','stock','/view/add_sale/product','date','product_name_QA1','product_date','prod_cat','params','warehouse_name','$date','OUTF-','Logo.png','Enabled','$product_details.primary_code','getFullYear','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','catch','secondary_unit_QA','$product_details.production_date','due_amount','$product_details.type_products','/barcode/:id','prod_code','bay','/all_sales/view','adjust_qty','product_code','back','final','$product_details.batch_code','German','English','level','$finalize','then','quantity','carton','unit_QA','sales\x20item\x20return\x20successfull','/view/return_sales/:id','Router','gmail','toString','findById','$product_details.expiry_date','match','here','$sale_product.bin','$product','</body></html>','/picking_list/pdf/','$product_details.bay','RoomAssigned','</tbody>','10DdvXCY','createTransport','primary_code','</h5>','1251330UiPIPs','Sales\x20Update\x20successfully','$product_details.sales_category','updateOne','sale_qty','json','edit_sales_finished','exports','slice','secondary_code_QA','log','$product.product_name','/view/add_sales','payment\x20successfull','$product_details.product_code','language','$_id','product_code_QA','</span>','</div>','$product_details.product_stock','$customer','/view/add_sales_logs','suppliers','</td>','aggregate','True','barcode\x20Product\x20master','False','$product_details.invoice','/view/:id','agent_id','abs','map','$product_details.unit','post'];a0_0x57b5=function(){return _0x11074e;};return a0_0x57b5();}(function(_0x41e0f6,_0x3618cc){var _0x34dee1=a0_0x5511,_0x4309d2=_0x41e0f6();while(!![]){try{var _0x467d2c=parseInt(_0x34dee1(0x11e))/0x1*(parseInt(_0x34dee1(0x12c))/0x2)+parseInt(_0x34dee1(0x1a5))/0x3+-parseInt(_0x34dee1(0x139))/0x4*(parseInt(_0x34dee1(0x15e))/0x5)+parseInt(_0x34dee1(0x14f))/0x6+-parseInt(_0x34dee1(0x1d1))/0x7+-parseInt(_0x34dee1(0x1f4))/0x8*(-parseInt(_0x34dee1(0x161))/0x9)+parseInt(_0x34dee1(0x1a1))/0xa*(-parseInt(_0x34dee1(0x1da))/0xb);if(_0x467d2c===_0x3618cc)break;else _0x4309d2['push'](_0x4309d2['shift']());}catch(_0x20580d){_0x4309d2['push'](_0x4309d2['shift']());}}}(a0_0x57b5,0x83647));const express=require(a0_0x3457ae(0x136)),app=express(),router=express[a0_0x3457ae(0x193)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require('../models/all_models'),auth=require(a0_0x3457ae(0x137)),nodemailer=require('nodemailer'),users=require(a0_0x3457ae(0x147));router[a0_0x3457ae(0x14e)](a0_0x3457ae(0x164),auth,async(_0x5b775f,_0x25e9d5)=>{var _0x87aa29=a0_0x3457ae;try{const {username:_0x47caa0,email:_0x5bbc96,role:_0x3b835c}=_0x5b775f['user'],_0x347eab=_0x5b775f[_0x87aa29(0x13c)],_0x1d3ea5=await profile[_0x87aa29(0x15f)]({'email':_0x347eab['email']}),_0x5d06b6=await master_shop[_0x87aa29(0x111)]();let _0x39cb98;if(_0x347eab[_0x87aa29(0x121)]=='staff'){const _0x5297c7=await staff[_0x87aa29(0x15f)]({'email':_0x347eab[_0x87aa29(0x125)]});_0x39cb98=await sales_finished[_0x87aa29(0x1be)]([{'$match':{'typeOfProducts':_0x87aa29(0x102)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x87aa29(0x1b5),'invoice':{'$first':_0x87aa29(0x1d0)},'customers':{'$first':_0x87aa29(0x1ba)},'date':{'$first':_0x87aa29(0x174)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x87aa29(0x11a)},'note':{'$first':'$note'},'return_data':{'$first':_0x87aa29(0x20d)},'customers_docs':{'$first':_0x87aa29(0x11c)},'total_saleproduct_quantity':{'$sum':_0x87aa29(0x14b)},'level':{'$addToSet':_0x87aa29(0x1f7)},'isle':{'$addToSet':_0x87aa29(0x19a)},'type':{'$addToSet':_0x87aa29(0x203)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x87aa29(0x18c)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x39cb98=await sales_finished[_0x87aa29(0x1be)]([{'$match':{'typeOfProducts':_0x87aa29(0x102)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x87aa29(0x1b5),'invoice':{'$first':_0x87aa29(0x1d0)},'customers':{'$first':_0x87aa29(0x1ba)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x87aa29(0x213)},'sale_product':{'$push':_0x87aa29(0x11a)},'note':{'$first':'$note'},'return_data':{'$first':_0x87aa29(0x20d)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x87aa29(0x14b)},'level':{'$addToSet':_0x87aa29(0x1f7)},'isle':{'$addToSet':_0x87aa29(0x19a)},'type':{'$addToSet':_0x87aa29(0x203)},'pallet':{'$addToSet':_0x87aa29(0x1cf)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x5d06b6[0x0]['language']==_0x87aa29(0x1e2)){var _0x552cf7=users[_0x87aa29(0x18a)];console[_0x87aa29(0x1af)](_0x552cf7);}else{if(_0x5d06b6[0x0][_0x87aa29(0x1b4)]==_0x87aa29(0x11d))var _0x552cf7=users['Hindi'];else{if(_0x5d06b6[0x0]['language']==_0x87aa29(0x189))var _0x552cf7=users['German'];else{if(_0x5d06b6[0x0][_0x87aa29(0x1b4)]==_0x87aa29(0x105))var _0x552cf7=users[_0x87aa29(0x105)];else{if(_0x5d06b6[0x0][_0x87aa29(0x1b4)]==_0x87aa29(0x1d9))var _0x552cf7=users[_0x87aa29(0x1d9)];else{if(_0x5d06b6[0x0]['language']=='Portuguese\x20(BR)')var _0x552cf7=users[_0x87aa29(0x108)];else{if(_0x5d06b6[0x0]['language']=='Chinese')var _0x552cf7=users['Chinese'];else{if(_0x5d06b6[0x0][_0x87aa29(0x1b4)]==_0x87aa29(0x146))var _0x552cf7=users[_0x87aa29(0x1ec)];}}}}}}}_0x25e9d5[_0x87aa29(0x1cd)](_0x87aa29(0x115),{'success':_0x5b775f[_0x87aa29(0x167)](_0x87aa29(0x135)),'errors':_0x5b775f[_0x87aa29(0x167)](_0x87aa29(0x21c)),'sales':_0x39cb98,'profile':_0x1d3ea5,'role':_0x347eab,'master_shop':_0x5d06b6,'language':_0x552cf7});}catch(_0x46e163){console[_0x87aa29(0x1af)](_0x46e163);}}),router[a0_0x3457ae(0x14e)](a0_0x3457ae(0x1f3),auth,async(_0x2d4a15,_0x5ecf7a)=>{var _0x43b498=a0_0x3457ae;try{const {username:_0x54cbec,email:_0x3913e3,role:_0x2756fb}=_0x2d4a15['user'],_0x3a3346=_0x2d4a15['user'],_0x15f039=await profile[_0x43b498(0x15f)]({'email':_0x3a3346[_0x43b498(0x125)]}),_0x44c52b=await master_shop['find']();let _0x14d36e;if(_0x3a3346['role']==_0x43b498(0x1d4)){const _0x283c3d=await staff[_0x43b498(0x15f)]({'email':_0x3a3346[_0x43b498(0x125)]});_0x14d36e=await sales_finished[_0x43b498(0x1be)]([{'$match':{'typeOfProducts':_0x43b498(0x1d3)}},{'$unwind':_0x43b498(0x11a)},{'$group':{'_id':_0x43b498(0x1b5),'invoice':{'$first':_0x43b498(0x1d0)},'customers':{'$first':_0x43b498(0x1ba)},'date':{'$first':_0x43b498(0x174)},'warehouse_name':{'$first':_0x43b498(0x213)},'sale_product':{'$push':_0x43b498(0x11a)},'note':{'$first':_0x43b498(0x1eb)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x43b498(0x11c)},'total_saleproduct_quantity':{'$sum':_0x43b498(0x14b)},'level':{'$addToSet':_0x43b498(0x1f7)},'isle':{'$addToSet':_0x43b498(0x19a)},'type':{'$addToSet':_0x43b498(0x203)},'pallet':{'$addToSet':_0x43b498(0x1cf)},'finalize':{'$first':_0x43b498(0x18c)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x14d36e=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x43b498(0x1d3)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x43b498(0x1b5),'invoice':{'$first':_0x43b498(0x1d0)},'customers':{'$first':_0x43b498(0x1ba)},'date':{'$first':_0x43b498(0x174)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x43b498(0x11a)},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x43b498(0x11c)},'total_saleproduct_quantity':{'$sum':_0x43b498(0x14b)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x43b498(0x19a)},'type':{'$addToSet':_0x43b498(0x203)},'pallet':{'$addToSet':_0x43b498(0x1cf)},'finalize':{'$first':_0x43b498(0x18c)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x44c52b[0x0][_0x43b498(0x1b4)]==_0x43b498(0x1e2)){var _0xe4e18b=users[_0x43b498(0x18a)];console[_0x43b498(0x1af)](_0xe4e18b);}else{if(_0x44c52b[0x0][_0x43b498(0x1b4)]==_0x43b498(0x11d))var _0xe4e18b=users['Hindi'];else{if(_0x44c52b[0x0][_0x43b498(0x1b4)]=='German')var _0xe4e18b=users[_0x43b498(0x189)];else{if(_0x44c52b[0x0][_0x43b498(0x1b4)]=='Spanish')var _0xe4e18b=users['Spanish'];else{if(_0x44c52b[0x0][_0x43b498(0x1b4)]==_0x43b498(0x1d9))var _0xe4e18b=users[_0x43b498(0x1d9)];else{if(_0x44c52b[0x0]['language']==_0x43b498(0x225))var _0xe4e18b=users['Portuguese'];else{if(_0x44c52b[0x0][_0x43b498(0x1b4)]==_0x43b498(0x209))var _0xe4e18b=users['Chinese'];else{if(_0x44c52b[0x0]['language']==_0x43b498(0x146))var _0xe4e18b=users['Arabic'];}}}}}}}_0x5ecf7a[_0x43b498(0x1cd)]('all_sales_finished_logs',{'success':_0x2d4a15['flash']('success'),'errors':_0x2d4a15[_0x43b498(0x167)](_0x43b498(0x21c)),'sales':_0x14d36e,'profile':_0x15f039,'role':_0x3a3346,'master_shop':_0x44c52b,'language':_0xe4e18b});}catch(_0x49864c){console[_0x43b498(0x1af)](_0x49864c);}});function a0_0x5511(_0x2c3624,_0x313dba){var _0x57b546=a0_0x57b5();return a0_0x5511=function(_0x55118d,_0x3e9d16){_0x55118d=_0x55118d-0x102;var _0x1f60ac=_0x57b546[_0x55118d];return _0x1f60ac;},a0_0x5511(_0x2c3624,_0x313dba);}async function getRandom8DigitNumber(){var _0x13769e=a0_0x3457ae;const _0x5ca214=0x989680,_0x1acd8e=0x5f5e0ff,_0x57f7be=Math[_0x13769e(0x204)](Math[_0x13769e(0x163)]()*(_0x1acd8e-_0x5ca214+0x1))+_0x5ca214;var _0x15a8ee;const _0x19a02=await sales_finished['findOne']({'invoice':_0x13769e(0x175)+_0x57f7be});return _0x19a02&&_0x19a02[_0x13769e(0x138)]>0x0?_0x15a8ee=_0x13769e(0x175)+_0x57f7be:_0x15a8ee=_0x13769e(0x175)+_0x57f7be,_0x15a8ee;}router[a0_0x3457ae(0x14e)]('/view/add_sales',auth,async(_0x4259cf,_0x2ac079)=>{var _0x1bbce2=a0_0x3457ae;try{const {username:_0x4a8119,email:_0x5e0db3,role:_0x3ce5a8}=_0x4259cf[_0x1bbce2(0x13c)],_0x532555=_0x4259cf['user'],_0x2d98fd=await profile[_0x1bbce2(0x15f)]({'email':_0x532555[_0x1bbce2(0x125)]}),_0x4421e5=await master_shop['find'](),_0x2868dd=await customer[_0x1bbce2(0x111)]({});let _0x36def4;if(_0x532555['role']==_0x1bbce2(0x1d4)){const _0x4d9776=await staff['findOne']({'email':_0x532555[_0x1bbce2(0x125)]});_0x36def4=await warehouse[_0x1bbce2(0x1be)]([{'$match':{'status':'Enabled','name':_0x4d9776[_0x1bbce2(0x1d5)]}},{'$group':{'_id':_0x1bbce2(0x120),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x36def4=await warehouse[_0x1bbce2(0x1be)]([{'$match':{'status':_0x1bbce2(0x177)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x53ea18=await product[_0x1bbce2(0x111)]({});var _0xc6a191=[_0x1bbce2(0x158),_0x1bbce2(0x132)];const _0x551000=await sales_finished[_0x1bbce2(0x111)]({}),_0x377620=_0x551000[_0x1bbce2(0x138)]+0x1,_0x163992=_0x1bbce2(0x175)+_0x377620[_0x1bbce2(0x195)]()[_0x1bbce2(0x1df)](0x5,'0');if(_0x4421e5[0x0][_0x1bbce2(0x1b4)]=='English\x20(US)'){var _0xbb06a0=users['English'];console[_0x1bbce2(0x1af)](_0xbb06a0);}else{if(_0x4421e5[0x0]['language']==_0x1bbce2(0x11d))var _0xbb06a0=users[_0x1bbce2(0x11d)];else{if(_0x4421e5[0x0][_0x1bbce2(0x1b4)]==_0x1bbce2(0x189))var _0xbb06a0=users[_0x1bbce2(0x189)];else{if(_0x4421e5[0x0]['language']==_0x1bbce2(0x105))var _0xbb06a0=users[_0x1bbce2(0x105)];else{if(_0x4421e5[0x0]['language']==_0x1bbce2(0x1d9))var _0xbb06a0=users[_0x1bbce2(0x1d9)];else{if(_0x4421e5[0x0][_0x1bbce2(0x1b4)]==_0x1bbce2(0x225))var _0xbb06a0=users[_0x1bbce2(0x108)];else{if(_0x4421e5[0x0][_0x1bbce2(0x1b4)]=='Chinese')var _0xbb06a0=users[_0x1bbce2(0x209)];else{if(_0x4421e5[0x0][_0x1bbce2(0x1b4)]==_0x1bbce2(0x146))var _0xbb06a0=users[_0x1bbce2(0x1ec)];}}}}}}}const _0x4ec848=getRandom8DigitNumber();_0x4ec848[_0x1bbce2(0x18d)](_0xa0b6d3=>{var _0x1d5215=_0x1bbce2;_0x2ac079[_0x1d5215(0x1cd)]('add_sales_finished',{'success':_0x4259cf[_0x1d5215(0x167)]('success'),'errors':_0x4259cf[_0x1d5215(0x167)]('errors'),'role':_0x532555,'profile':_0x2d98fd,'customer':_0x2868dd,'warehouse':_0x36def4,'product':_0x53ea18,'invoice':_0xa0b6d3,'master_shop':_0x4421e5,'language':_0xbb06a0,'rooms_data':_0xc6a191});})[_0x1bbce2(0x17b)](_0x4583f1=>{var _0xe44e13=_0x1bbce2;_0x4259cf[_0xe44e13(0x167)](_0xe44e13(0x21c),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2ac079[_0xe44e13(0x12a)](_0xe44e13(0x212));});}catch(_0x2169cb){console[_0x1bbce2(0x1af)](_0x2169cb);}}),router[a0_0x3457ae(0x14e)]('/view/add_sales_logs',auth,async(_0x4549a0,_0x2660a0)=>{var _0x541f16=a0_0x3457ae;try{const {username:_0x3ec255,email:_0x59cb82,role:_0x6ec455}=_0x4549a0[_0x541f16(0x13c)],_0x3819b1=_0x4549a0[_0x541f16(0x13c)],_0x33896a=await profile[_0x541f16(0x15f)]({'email':_0x3819b1['email']}),_0xe10144=await master_shop[_0x541f16(0x111)](),_0x41e960=await customer[_0x541f16(0x111)]({});let _0x533894;if(_0x3819b1[_0x541f16(0x121)]=='staff'){const _0x20b6e0=await staff['findOne']({'email':_0x3819b1[_0x541f16(0x125)]});_0x533894=await warehouse['aggregate']([{'$match':{'status':_0x541f16(0x177),'name':_0x20b6e0[_0x541f16(0x1d5)]}},{'$group':{'_id':_0x541f16(0x120),'name':{'$first':_0x541f16(0x120)}}},{'$sort':{'name':0x1}}]);}else _0x533894=await warehouse[_0x541f16(0x1be)]([{'$match':{'status':_0x541f16(0x177)}},{'$group':{'_id':_0x541f16(0x120),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x3995d=await product[_0x541f16(0x111)]({});var _0xe1cfde=[_0x541f16(0x158),_0x541f16(0x132)];const _0x425d87=await sales_finished['find']({}),_0x1457fe=_0x425d87[_0x541f16(0x138)]+0x1,_0x35affb=_0x541f16(0x175)+_0x1457fe[_0x541f16(0x195)]()['padStart'](0x5,'0');if(_0xe10144[0x0][_0x541f16(0x1b4)]==_0x541f16(0x1e2)){var _0x5767b1=users[_0x541f16(0x18a)];console[_0x541f16(0x1af)](_0x5767b1);}else{if(_0xe10144[0x0]['language']==_0x541f16(0x11d))var _0x5767b1=users[_0x541f16(0x11d)];else{if(_0xe10144[0x0][_0x541f16(0x1b4)]=='German')var _0x5767b1=users[_0x541f16(0x189)];else{if(_0xe10144[0x0][_0x541f16(0x1b4)]==_0x541f16(0x105))var _0x5767b1=users[_0x541f16(0x105)];else{if(_0xe10144[0x0][_0x541f16(0x1b4)]==_0x541f16(0x1d9))var _0x5767b1=users[_0x541f16(0x1d9)];else{if(_0xe10144[0x0]['language']=='Portuguese\x20(BR)')var _0x5767b1=users[_0x541f16(0x108)];else{if(_0xe10144[0x0]['language']==_0x541f16(0x209))var _0x5767b1=users[_0x541f16(0x209)];else{if(_0xe10144[0x0][_0x541f16(0x1b4)]=='Arabic\x20(ae)')var _0x5767b1=users[_0x541f16(0x1ec)];}}}}}}}const _0x668800=getRandom8DigitNumber();_0x668800['then'](_0x5b2bc5=>{var _0x1d3a8a=_0x541f16;_0x2660a0[_0x1d3a8a(0x1cd)](_0x1d3a8a(0x14c),{'success':_0x4549a0[_0x1d3a8a(0x167)](_0x1d3a8a(0x135)),'errors':_0x4549a0[_0x1d3a8a(0x167)](_0x1d3a8a(0x21c)),'role':_0x3819b1,'profile':_0x33896a,'customer':_0x41e960,'warehouse':_0x533894,'product':_0x3995d,'invoice':_0x5b2bc5,'master_shop':_0xe10144,'language':_0x5767b1,'rooms_data':_0xe1cfde});})[_0x541f16(0x17b)](_0x1bf9d3=>{var _0x8905fd=_0x541f16;_0x4549a0[_0x8905fd(0x167)](_0x8905fd(0x21c),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2660a0[_0x8905fd(0x12a)](_0x8905fd(0x212));});}catch(_0x4d6a37){console[_0x541f16(0x1af)](_0x4d6a37);}}),router[a0_0x3457ae(0x1c8)](a0_0x3457ae(0x1bb),auth,async(_0x3b1209,_0x1aa34e)=>{var _0x56dafc=a0_0x3457ae;try{const {invoice:_0x4212e4,date:_0x7dd3d8,warehouse_name:_0x458abe,product_name:_0x80263d,note:_0x1ed39d,room:_0x5b9596,primary_code:_0x30e78d,secondary_code:_0x3b7205,prod_code:_0x16c035,SCRN:_0x5b0e27,ReqBy:_0x15db89,dateofreq:_0x5c174b,PO_number:_0x22a389,typeservicesData:_0x3d9306,typevehicle:_0x7575bd,destination:_0x2dd5bd,deliverydate:_0xac9019,driver:_0x48e777,plate:_0x5c6fda,van:_0x37ec30,DRSI:_0x26768e,TSU:_0x37440d,TFU:_0x5297a1,mode_transpo:_0x42888d,name_driver:_0xf9d51d,type_of_products:_0x5c4a55}=_0x3b1209[_0x56dafc(0x200)];if(typeof _0x80263d==_0x56dafc(0x218))var _0x12c18e=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x15a)]],_0x2bd50e=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x16c)]],_0x541fd0=[_0x3b1209['body'][_0x56dafc(0x18f)]],_0x1b1d6b=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x1a3)]],_0x43b568=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x123)]],_0x57ca37=[_0x3b1209[_0x56dafc(0x200)]['prod_code']],_0x3b586f=[_0x3b1209['body'][_0x56dafc(0x206)]],_0x5101df=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x152)]],_0x70cdae=[_0x3b1209[_0x56dafc(0x200)]['secondary_unit']],_0x122eb1=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x1f9)]],_0x169cee=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x221)]],_0x55877d=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x170)]],_0xad177d=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x114)]],_0x570e65=[_0x3b1209['body'][_0x56dafc(0x171)]],_0x179c98=[_0x3b1209[_0x56dafc(0x200)]['RoomAssigned']],_0xff277d=[_0x3b1209['body'][_0x56dafc(0x202)]],_0x5b42c1=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x129)]],_0x2f8090=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x122)]],_0x2cf04a=[_0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x145)]];else var _0x12c18e=[..._0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x15a)]],_0x2bd50e=[..._0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x16c)]],_0x541fd0=[..._0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x18f)]],_0x1b1d6b=[..._0x3b1209['body'][_0x56dafc(0x1a3)]],_0x43b568=[..._0x3b1209['body'][_0x56dafc(0x123)]],_0x57ca37=[..._0x3b1209[_0x56dafc(0x200)]['prod_code']],_0x3b586f=[..._0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x206)]],_0x5101df=[..._0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x152)]],_0x70cdae=[..._0x3b1209[_0x56dafc(0x200)]['secondary_unit']],_0x122eb1=[..._0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x1f9)]],_0x169cee=[..._0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x221)]],_0x55877d=[..._0x3b1209['body'][_0x56dafc(0x170)]],_0xad177d=[..._0x3b1209['body'][_0x56dafc(0x114)]],_0x570e65=[..._0x3b1209[_0x56dafc(0x200)]['prod_cat']],_0x179c98=[..._0x3b1209['body']['RoomAssigned']],_0xff277d=[..._0x3b1209[_0x56dafc(0x200)]['prod_invoice']],_0x5b42c1=[..._0x3b1209['body'][_0x56dafc(0x129)]],_0x2f8090=[..._0x3b1209[_0x56dafc(0x200)][_0x56dafc(0x122)]],_0x2cf04a=[..._0x3b1209['body'][_0x56dafc(0x145)]];const _0x971b3d=_0x12c18e[_0x56dafc(0x1c6)](_0x54f62e=>{return _0x54f62e={'product_name':_0x54f62e};});_0x2bd50e['forEach']((_0xb5412,_0x44d571)=>{_0x971b3d[_0x44d571]['stock']=_0xb5412;}),_0x541fd0[_0x56dafc(0x16a)]((_0x381dda,_0x46a966)=>{var _0x127bde=_0x56dafc;_0x971b3d[_0x46a966][_0x127bde(0x18e)]=Math[_0x127bde(0x1c5)](_0x381dda);}),_0x12c18e['forEach']((_0x2df96c,_0x7db17a)=>{var _0x17e38e=_0x56dafc;_0x971b3d[_0x7db17a][_0x17e38e(0x1c4)]=_0x3b1209[_0x17e38e(0x200)][_0x17e38e(0x156)];}),_0x2cf04a[_0x56dafc(0x16a)]((_0x22921a,_0x3b8992)=>{var _0x3bd6f7=_0x56dafc;_0x971b3d[_0x3b8992][_0x3bd6f7(0x145)]=_0x22921a;}),_0x2f8090[_0x56dafc(0x16a)]((_0x51123c,_0x3b30ec)=>{var _0x288cf1=_0x56dafc;_0x971b3d[_0x3b30ec][_0x288cf1(0x122)]=_0x51123c;}),_0x5b42c1[_0x56dafc(0x16a)]((_0x55a97f,_0x2eba59)=>{var _0x545bbb=_0x56dafc;_0x971b3d[_0x2eba59][_0x545bbb(0x129)]=_0x55a97f;}),_0x1b1d6b[_0x56dafc(0x16a)]((_0x51c422,_0x1752b9)=>{var _0x415e81=_0x56dafc;_0x971b3d[_0x1752b9][_0x415e81(0x1a3)]=_0x51c422;}),_0x43b568['forEach']((_0x47e20b,_0x3038c8)=>{var _0x2ee1b2=_0x56dafc;_0x971b3d[_0x3038c8][_0x2ee1b2(0x123)]=_0x47e20b;}),_0x57ca37[_0x56dafc(0x16a)]((_0x21645c,_0x153a78)=>{_0x971b3d[_0x153a78]['product_code']=_0x21645c;}),_0x3b586f[_0x56dafc(0x16a)]((_0x359be8,_0x1e5001)=>{var _0x4e79b9=_0x56dafc,_0x1ab070=_0x359be8[_0x4e79b9(0x198)](/[A-Za-z]+/)[0x0],_0x2a9177=parseInt(_0x359be8[_0x4e79b9(0x198)](/\d+/)[0x0]);_0x971b3d[_0x1e5001][_0x4e79b9(0x182)]=_0x2a9177,_0x971b3d[_0x1e5001][_0x4e79b9(0x18b)]=_0x1ab070;}),_0x5101df[_0x56dafc(0x16a)]((_0x1c3f0c,_0x4d0740)=>{var _0x2fe4a4=_0x56dafc;_0x971b3d[_0x4d0740][_0x2fe4a4(0x10a)]=_0x1c3f0c;}),_0x70cdae['forEach']((_0x2ec290,_0x3f458f)=>{var _0x585561=_0x56dafc;_0x971b3d[_0x3f458f][_0x585561(0x1e0)]=_0x2ec290;}),_0x122eb1['forEach']((_0x3b73be,_0x537a73)=>{var _0x7f0f64=_0x56dafc;_0x971b3d[_0x537a73][_0x7f0f64(0x1f9)]=_0x3b73be;}),_0x169cee['forEach']((_0x484d04,_0x3a6fa7)=>{_0x971b3d[_0x3a6fa7]['expiry_date']=_0x484d04;}),_0x55877d['forEach']((_0x1256b8,_0x4d90c3)=>{var _0x31d7a3=_0x56dafc;_0x971b3d[_0x4d90c3][_0x31d7a3(0x150)]=_0x1256b8;}),_0xad177d['forEach']((_0xa57183,_0xd58bbe)=>{var _0x2515e3=_0x56dafc;_0x971b3d[_0xd58bbe][_0x2515e3(0x10e)]=_0xa57183;}),_0x570e65[_0x56dafc(0x16a)]((_0x5d3a48,_0x266f53)=>{_0x971b3d[_0x266f53]['prod_cat']=_0x5d3a48;}),_0x179c98['forEach']((_0x39e69f,_0x179802)=>{var _0x40f73b=_0x56dafc;_0x971b3d[_0x179802][_0x40f73b(0x1ed)]=_0x39e69f;}),_0xff277d[_0x56dafc(0x16a)]((_0x270c89,_0x2ee75b)=>{var _0x4ec701=_0x56dafc;_0x971b3d[_0x2ee75b][_0x4ec701(0x224)]=_0x270c89,_0x971b3d[_0x2ee75b]['date_data']=_0x7dd3d8;});const _0x27bf94=new sales_logs();await _0x27bf94[_0x56dafc(0x1f8)](),_0xff277d['forEach']((_0x37d37a,_0x21a95b)=>{var _0x44f630=_0x56dafc;_0x971b3d[_0x21a95b][_0x44f630(0x117)]='LOG-OUT-'+_0x27bf94['invoice_init'][_0x44f630(0x195)]()[_0x44f630(0x1df)](0x8,'0');});var _0x164752=0x0;_0x971b3d[_0x56dafc(0x16a)](_0xe71532=>{var _0x335041=_0x56dafc;parseFloat(_0xe71532[_0x335041(0x16c)])<parseFloat(_0xe71532[_0x335041(0x18e)])&&parseFloat(_0xe71532['quantity'])>parseFloat(_0xe71532[_0x335041(0x16c)])&&(console[_0x335041(0x1af)](_0xe71532[_0x335041(0x16c)]+_0x335041(0x126)+_0xe71532[_0x335041(0x18e)]),_0x164752++);});if(_0x164752!=0x0)return _0x3b1209[_0x56dafc(0x167)]('errors',_0x56dafc(0x17a)),_0x1aa34e[_0x56dafc(0x12a)](_0x56dafc(0x186));const _0x132e70=_0x971b3d[_0x56dafc(0x151)](_0x27a4a2=>_0x27a4a2['quantity']!=='0'&&_0x27a4a2['quantity']!==''),_0x4b5bd1=new sales_finished({'invoice':_0x56dafc(0x1ee)+_0x27bf94['invoice_init'][_0x56dafc(0x195)]()['padStart'](0x8,'0'),'sales_data':_0x3b1209['body']['sales'],'customer':_0x3b1209['body'][_0x56dafc(0x1e8)],'date':_0x7dd3d8,'warehouse_name':_0x458abe,'sale_product':_0x132e70,'note':_0x1ed39d,'room':_0x5b9596,'primary_code':_0x30e78d,'secondary_code':_0x3b7205,'prod_code':_0x16c035,'SCRN':_0x5b0e27,'finalize':_0x56dafc(0x1c1),'mode_transpo':_0x42888d,'name_driver':_0xf9d51d,'ReqBy':_0x15db89,'dateofreq':_0x5c174b,'PO_number':_0x22a389,'typeservicesData':_0x3d9306,'typevehicle':_0x7575bd,'destination':_0x2dd5bd,'deliverydate':_0xac9019,'driver':_0x48e777,'plate':_0x5c6fda,'van':_0x37ec30,'DRSI':_0x26768e,'TSU':_0x37440d,'TFU':_0x5297a1,'typeOfProducts':_0x5c4a55}),_0x2ab63d=await _0x4b5bd1[_0x56dafc(0x1f8)](),_0x5af1f0=await sales_finished[_0x56dafc(0x15f)]({'invoice':_0x4212e4});_0x3b1209['flash'](_0x56dafc(0x135),_0x56dafc(0x141)),_0x1aa34e[_0x56dafc(0x12a)](_0x56dafc(0x10f)+_0x2ab63d[_0x56dafc(0x21b)]);}catch(_0x2868f1){console[_0x56dafc(0x1af)](_0x2868f1);}}),router[a0_0x3457ae(0x14e)]('/view/add_sales/:id',auth,async(_0x428d65,_0x267bc0)=>{var _0x92eb45=a0_0x3457ae;try{const _0x56dace=_0x428d65[_0x92eb45(0x172)]['id'];console[_0x92eb45(0x1af)](_0x56dace);const _0x3ecf61=await product[_0x92eb45(0x111)](),_0x1d5104=await purchases[_0x92eb45(0x1be)]([{'$match':{'warehouse_name':_0x56dace}},{'$unwind':_0x92eb45(0x19b)},{'$group':{'_id':_0x92eb45(0x1b0)}}]);console['log']('purchases_data',_0x1d5104),_0x267bc0[_0x92eb45(0x1ca)](0xc8)[_0x92eb45(0x1aa)]({'purchases_data':_0x1d5104,'product_data':_0x3ecf61});}catch(_0x3a311e){console[_0x92eb45(0x1af)](_0x3a311e);}}),router[a0_0x3457ae(0x1c8)](a0_0x3457ae(0x16d),auth,async(_0x4f8f5f,_0x25b0f2)=>{var _0x459a8e=a0_0x3457ae;try{const {warehouse_data:_0x419f00,product_data:_0x3e5d4e}=_0x4f8f5f['body'];console['log'](_0x4f8f5f[_0x459a8e(0x200)]['product_data']);;const _0x3135ab=await master_shop['find']();console[_0x459a8e(0x1af)](_0x459a8e(0x210),_0x3135ab);const _0xd5a8e6=await product['findOne']({'name':_0x3e5d4e});console[_0x459a8e(0x1af)](_0x459a8e(0x113),_0xd5a8e6);const _0x5c19f0=await warehouse[_0x459a8e(0x1be)]([{'$match':{'name':_0x419f00}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x3e5d4e}},{'$group':{'_id':_0x459a8e(0x134),'product_stock':{'$first':'$product_details.product_stock'}}}]);console['log']('stock_data',_0x5c19f0),_0x25b0f2[_0x459a8e(0x1ca)](0xc8)['json']({'master':_0x3135ab,'new_product':_0xd5a8e6,'stock_data':_0x5c19f0});}catch(_0x435862){console['log'](_0x435862);}}),router['post'](a0_0x3457ae(0x1b1),auth,async(_0x472c77,_0x16a7a9)=>{var _0x10ef35=a0_0x3457ae;try{const {invoice:_0x1b1b14,date:_0x49ead4,warehouse_name:_0x57fd17,product_name:_0x49e2cc,note:_0x5958c7,room:_0x260ada,primary_code:_0x313b83,secondary_code:_0x447909,prod_code:_0x4fbda9,SCRN:_0x3d6995,ReqBy:_0x8de08f,dateofreq:_0x381245,PO_number:_0x2d643a,typeservicesData:_0x2db425,typevehicle:_0xf4f0cb,destination:_0x46b09b,deliverydate:_0x140e8e,driver:_0x584a35,plate:_0x3c5679,van:_0x5b2924,DRSI:_0x8ffe56,TSU:_0x2a077a,TFU:_0xab7515,mode_transpo:_0x195cdb,name_driver:_0x585507,pull_out_date:_0x4997cf,actual_delivery_date:_0x206db6}=_0x472c77[_0x10ef35(0x200)];if(typeof _0x49e2cc==_0x10ef35(0x218))var _0x2142ce=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x15a)]],_0x58a661=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x16c)]],_0x4e00ba=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x18f)]],_0x48a6fc=[_0x472c77['body'][_0x10ef35(0x1a3)]],_0x5d315b=[_0x472c77['body'][_0x10ef35(0x123)]],_0x260cf2=[_0x472c77[_0x10ef35(0x200)]['prod_code']],_0xdf2de9=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x206)]],_0x3671a2=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x152)]],_0x37cfa2=[_0x472c77['body'][_0x10ef35(0x1e0)]],_0x194e36=[_0x472c77['body']['batch_code']],_0x522840=[_0x472c77['body'][_0x10ef35(0x221)]],_0x2d3efd=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x170)]],_0x1116ee=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x114)]],_0x36e002=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x171)]],_0x189e75=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x19f)]],_0x44a65e=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x202)]],_0x2d0399=[_0x472c77[_0x10ef35(0x200)]['id_transaction_from']],_0x152a64=[_0x472c77['body'][_0x10ef35(0x122)]],_0x360974=[_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x145)]];else var _0x2142ce=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x15a)]],_0x58a661=[..._0x472c77['body']['stock']],_0x4e00ba=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x18f)]],_0x48a6fc=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x1a3)]],_0x5d315b=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x123)]],_0x260cf2=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x181)]],_0xdf2de9=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x206)]],_0x3671a2=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x152)]],_0x37cfa2=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x1e0)]],_0x194e36=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x1f9)]],_0x522840=[..._0x472c77[_0x10ef35(0x200)]['expiry_date']],_0x2d3efd=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x170)]],_0x1116ee=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x114)]],_0x36e002=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x171)]],_0x189e75=[..._0x472c77['body'][_0x10ef35(0x19f)]],_0x44a65e=[..._0x472c77[_0x10ef35(0x200)]['prod_invoice']],_0x2d0399=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x129)]],_0x152a64=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x122)]],_0x360974=[..._0x472c77[_0x10ef35(0x200)][_0x10ef35(0x145)]];const _0x3d6773=_0x2142ce[_0x10ef35(0x1c6)](_0x3fc44c=>{return _0x3fc44c={'product_name':_0x3fc44c};});_0x58a661[_0x10ef35(0x16a)]((_0x535b2a,_0x300240)=>{var _0x5a6d92=_0x10ef35;_0x3d6773[_0x300240][_0x5a6d92(0x16c)]=_0x535b2a;}),_0x4e00ba[_0x10ef35(0x16a)]((_0x315345,_0x5a3ac7)=>{_0x3d6773[_0x5a3ac7]['quantity']=Math['abs'](_0x315345);}),_0x2142ce[_0x10ef35(0x16a)]((_0x214521,_0x4f189b)=>{var _0x574026=_0x10ef35;_0x3d6773[_0x4f189b][_0x574026(0x1c4)]=_0x472c77[_0x574026(0x200)]['sales'];}),_0x360974[_0x10ef35(0x16a)]((_0x1996f9,_0x14a591)=>{var _0x38aed7=_0x10ef35;_0x3d6773[_0x14a591][_0x38aed7(0x145)]=_0x1996f9;}),_0x152a64[_0x10ef35(0x16a)]((_0x2cacb1,_0x37945e)=>{_0x3d6773[_0x37945e]['uuid']=_0x2cacb1;}),_0x2d0399[_0x10ef35(0x16a)]((_0x48bc8c,_0x5e4740)=>{var _0x16685a=_0x10ef35;_0x3d6773[_0x5e4740][_0x16685a(0x129)]=_0x48bc8c;}),_0x48a6fc[_0x10ef35(0x16a)]((_0x465015,_0x212ff9)=>{var _0x5d3d73=_0x10ef35;_0x3d6773[_0x212ff9][_0x5d3d73(0x1a3)]=_0x465015;}),_0x5d315b[_0x10ef35(0x16a)]((_0x447c04,_0x519a92)=>{var _0xb445a2=_0x10ef35;_0x3d6773[_0x519a92][_0xb445a2(0x123)]=_0x447c04;}),_0x260cf2['forEach']((_0x2e8115,_0x26fcd5)=>{_0x3d6773[_0x26fcd5]['product_code']=_0x2e8115;}),_0xdf2de9[_0x10ef35(0x16a)]((_0x1f03f6,_0x56abcd)=>{var _0xbe46b0=_0x10ef35,_0x5da061=_0x1f03f6['match'](/[A-Za-z]+/)[0x0],_0x4b75a7=parseInt(_0x1f03f6[_0xbe46b0(0x198)](/\d+/)[0x0]);_0x3d6773[_0x56abcd][_0xbe46b0(0x182)]=_0x4b75a7,_0x3d6773[_0x56abcd]['level']=_0x5da061;}),_0x3671a2[_0x10ef35(0x16a)]((_0x3490af,_0xfbdee8)=>{var _0x37b7e4=_0x10ef35;_0x3d6773[_0xfbdee8][_0x37b7e4(0x10a)]=_0x3490af;}),_0x37cfa2[_0x10ef35(0x16a)]((_0x29e3cf,_0x4ac6f7)=>{_0x3d6773[_0x4ac6f7]['secondary_unit']=_0x29e3cf;}),_0x194e36[_0x10ef35(0x16a)]((_0x1924d9,_0x463be1)=>{_0x3d6773[_0x463be1]['batch_code']=_0x1924d9;}),_0x522840[_0x10ef35(0x16a)]((_0x507bee,_0xb72a7f)=>{var _0x45ba60=_0x10ef35;_0x3d6773[_0xb72a7f][_0x45ba60(0x221)]=_0x507bee;}),_0x2d3efd[_0x10ef35(0x16a)]((_0x52dba8,_0x1e967a)=>{var _0xdff41=_0x10ef35;_0x3d6773[_0x1e967a][_0xdff41(0x150)]=_0x52dba8;}),_0x1116ee[_0x10ef35(0x16a)]((_0x5882ca,_0x4e67b7)=>{var _0x109786=_0x10ef35;_0x3d6773[_0x4e67b7][_0x109786(0x10e)]=_0x5882ca;}),_0x36e002[_0x10ef35(0x16a)]((_0x2efcdd,_0x131bbe)=>{var _0xc83da9=_0x10ef35;_0x3d6773[_0x131bbe][_0xc83da9(0x171)]=_0x2efcdd;}),_0x189e75[_0x10ef35(0x16a)]((_0x5f151a,_0x1b23ad)=>{var _0x3ada4c=_0x10ef35;_0x3d6773[_0x1b23ad][_0x3ada4c(0x1ed)]=_0x5f151a;}),_0x44a65e[_0x10ef35(0x16a)]((_0x1fafd9,_0x2a234)=>{var _0x5cac12=_0x10ef35;_0x3d6773[_0x2a234]['invoice']=_0x1fafd9,_0x3d6773[_0x2a234][_0x5cac12(0x1d7)]=_0x49ead4;});const _0xaca0bb=new invoice_for_outgoing();await _0xaca0bb[_0x10ef35(0x1f8)](),_0x44a65e[_0x10ef35(0x16a)]((_0x18d880,_0x87ab1a)=>{var _0x5c6159=_0x10ef35;_0x3d6773[_0x87ab1a][_0x5c6159(0x117)]='OUT-'+_0xaca0bb[_0x5c6159(0x131)][_0x5c6159(0x195)]()['padStart'](0x8,'0');});var _0x5c66f1=0x0;_0x3d6773[_0x10ef35(0x16a)](_0x1b5119=>{var _0xf53ba0=_0x10ef35;parseFloat(_0x1b5119['stock'])<parseFloat(_0x1b5119[_0xf53ba0(0x18e)])&&parseFloat(_0x1b5119['quantity'])>parseFloat(_0x1b5119['stock'])&&(console[_0xf53ba0(0x1af)](_0x1b5119[_0xf53ba0(0x16c)]+_0xf53ba0(0x126)+_0x1b5119[_0xf53ba0(0x18e)]),_0x5c66f1++);});if(_0x5c66f1!=0x0)return _0x472c77[_0x10ef35(0x167)](_0x10ef35(0x21c),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x16a7a9['redirect']('back');const _0x2845b9=_0x3d6773[_0x10ef35(0x151)](_0x57dd44=>_0x57dd44['quantity']!=='0'&&_0x57dd44[_0x10ef35(0x18e)]!==''),_0x56945c=new sales_finished({'invoice':_0x10ef35(0x106)+_0xaca0bb['invoice_init'][_0x10ef35(0x195)]()['padStart'](0x8,'0'),'sales_data':_0x472c77['body'][_0x10ef35(0x156)],'customer':_0x472c77[_0x10ef35(0x200)][_0x10ef35(0x1e8)],'date':_0x49ead4,'warehouse_name':_0x57fd17,'sale_product':_0x2845b9,'note':_0x5958c7,'room':_0x260ada,'primary_code':_0x313b83,'secondary_code':_0x447909,'prod_code':_0x4fbda9,'SCRN':_0x3d6995,'finalize':'False','mode_transpo':_0x195cdb,'name_driver':_0x585507,'ReqBy':_0x8de08f,'dateofreq':_0x381245,'PO_number':_0x2d643a,'typeservicesData':_0x2db425,'typevehicle':_0xf4f0cb,'destination':_0x46b09b,'deliverydate':_0x140e8e,'driver':_0x584a35,'plate':_0x3c5679,'van':_0x5b2924,'DRSI':_0x8ffe56,'TSU':_0x2a077a,'TFU':_0xab7515,'pullout_date':_0x4997cf,'actualdelivery_date':_0x206db6,'typeOfProducts':_0x10ef35(0x102)}),_0x18df9c=await _0x56945c[_0x10ef35(0x1f8)](),_0x5b6007=await sales_finished[_0x10ef35(0x15f)]({'invoice':_0x1b1b14});_0x472c77[_0x10ef35(0x167)](_0x10ef35(0x135),_0x10ef35(0x141)),_0x16a7a9[_0x10ef35(0x12a)](_0x10ef35(0x10f)+_0x18df9c[_0x10ef35(0x21b)]);}catch(_0x167f51){console[_0x10ef35(0x1af)](_0x167f51);}}),router[a0_0x3457ae(0x14e)](a0_0x3457ae(0x140),auth,async(_0x1510b9,_0x2a7a10)=>{var _0x2ea0ba=a0_0x3457ae;try{const {username:_0x3eeb8d,email:_0x391d97,role:_0x14b5be}=_0x1510b9[_0x2ea0ba(0x13c)],_0x45e563=_0x1510b9[_0x2ea0ba(0x13c)],_0x595d38=await profile[_0x2ea0ba(0x15f)]({'email':_0x45e563[_0x2ea0ba(0x125)]}),_0x5b2380=await master_shop[_0x2ea0ba(0x111)](),_0x5ef8d6=_0x1510b9[_0x2ea0ba(0x172)]['id'],_0x522b33=await sales_finished['findById'](_0x5ef8d6),_0xa48ed0=await warehouse[_0x2ea0ba(0x1be)]([{'$match':{'name':_0x522b33[_0x2ea0ba(0x173)]}},{'$unwind':_0x2ea0ba(0x219)},{'$group':{'_id':_0x2ea0ba(0x20f),'name':{'$first':_0x2ea0ba(0x134)},'product_stock':{'$first':_0x2ea0ba(0x1b9)},'bay':{'$first':_0x2ea0ba(0x19e)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2ea0ba(0x211)},'floorlevel':{'$first':_0x2ea0ba(0x168)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2ea0ba(0x1fd)},'product_code':{'$first':_0x2ea0ba(0x1b3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2ea0ba(0x197)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2ea0ba(0x188)},'room':{'$first':_0x2ea0ba(0x153)},'room_data':{'$first':_0x2ea0ba(0x1dd)}}}]),_0xe2cb02=await customer[_0x2ea0ba(0x111)]({});let _0x53ab7b;if(_0x45e563[_0x2ea0ba(0x121)]==_0x2ea0ba(0x1d4)){const _0x696d66=await staff[_0x2ea0ba(0x15f)]({'email':_0x45e563['email']});_0x53ab7b=await warehouse[_0x2ea0ba(0x1be)]([{'$match':{'status':_0x2ea0ba(0x177),'name':_0x696d66[_0x2ea0ba(0x1d5)]}},{'$group':{'_id':'$name','name':{'$first':_0x2ea0ba(0x120)}}}]);}else _0x53ab7b=await warehouse[_0x2ea0ba(0x1be)]([{'$match':{'status':_0x2ea0ba(0x177)}},{'$group':{'_id':_0x2ea0ba(0x120),'name':{'$first':_0x2ea0ba(0x120)}}}]);const _0x48b23d=await product['find']({});if(_0x5b2380[0x0][_0x2ea0ba(0x1b4)]==_0x2ea0ba(0x1e2)){var _0x18bc71=users[_0x2ea0ba(0x18a)];console['log'](_0x18bc71);}else{if(_0x5b2380[0x0][_0x2ea0ba(0x1b4)]==_0x2ea0ba(0x11d))var _0x18bc71=users[_0x2ea0ba(0x11d)];else{if(_0x5b2380[0x0][_0x2ea0ba(0x1b4)]==_0x2ea0ba(0x189))var _0x18bc71=users[_0x2ea0ba(0x189)];else{if(_0x5b2380[0x0][_0x2ea0ba(0x1b4)]==_0x2ea0ba(0x105))var _0x18bc71=users[_0x2ea0ba(0x105)];else{if(_0x5b2380[0x0][_0x2ea0ba(0x1b4)]==_0x2ea0ba(0x1d9))var _0x18bc71=users[_0x2ea0ba(0x1d9)];else{if(_0x5b2380[0x0]['language']=='Portuguese\x20(BR)')var _0x18bc71=users['Portuguese'];else{if(_0x5b2380[0x0]['language']==_0x2ea0ba(0x209))var _0x18bc71=users[_0x2ea0ba(0x209)];else{if(_0x5b2380[0x0][_0x2ea0ba(0x1b4)]==_0x2ea0ba(0x146))var _0x18bc71=users['Arabic'];}}}}}}}_0x2a7a10[_0x2ea0ba(0x1cd)](_0x2ea0ba(0x15d),{'success':_0x1510b9[_0x2ea0ba(0x167)](_0x2ea0ba(0x135)),'errors':_0x1510b9[_0x2ea0ba(0x167)]('errors'),'role':_0x45e563,'profile':_0x595d38,'customer':_0xe2cb02,'warehouse':_0x53ab7b,'product':_0xa48ed0,'user':_0x522b33,'master_shop':_0x5b2380,'unit':_0x48b23d,'language':_0x18bc71});}catch(_0x204451){console[_0x2ea0ba(0x1af)](_0x204451);}});async function dataUpdate(_0x2678c5,_0x52cb69,_0x2a77ca){var _0x5a6425=a0_0x3457ae;return await warehouse[_0x5a6425(0x1a8)]({'_id':_0x2678c5,'product_details._id':_0x52cb69},{'$set':{'product_details.$.product_stock':_0x2a77ca}}),await warehouse[_0x5a6425(0x196)](_0x2678c5);}router[a0_0x3457ae(0x1c8)](a0_0x3457ae(0x140),auth,async(_0x9a0b5d,_0x492901)=>{var _0x2fafd0=a0_0x3457ae;try{const _0x431a9d=_0x9a0b5d[_0x2fafd0(0x172)]['id'],{invoice:_0x5c9fb0,warehouse_name:_0x5cc3a6,room:_0x105bfc}=_0x9a0b5d[_0x2fafd0(0x200)],_0x21a9f1=await sales_finished[_0x2fafd0(0x15f)]({'invoice':_0x5c9fb0});for(let _0x4ce1e7=0x0;_0x4ce1e7<=_0x21a9f1[_0x2fafd0(0x124)][_0x2fafd0(0x138)]-0x1;_0x4ce1e7++){const _0x2b4f88=_0x21a9f1[_0x2fafd0(0x124)][_0x4ce1e7];var _0x3eeba7=await warehouse[_0x2fafd0(0x15f)]({'name':_0x5cc3a6,'room':_0x2b4f88['room_name']}),_0x25f61c=0x0;for(let _0x46a9ae=0x0;_0x46a9ae<=_0x3eeba7[_0x2fafd0(0x1c9)]['length']-0x1;_0x46a9ae++){const _0x5bc714=_0x3eeba7['product_details'][_0x46a9ae];_0x5bc714[_0x2fafd0(0x21b)]==_0x2b4f88[_0x2fafd0(0x129)]&&_0x5bc714[_0x2fafd0(0x122)]==_0x2b4f88['uuid']&&(_0x25f61c=Math[_0x2fafd0(0x14d)](0x0,Math['abs'](_0x5bc714[_0x2fafd0(0x1d6)])-Math[_0x2fafd0(0x1c5)](_0x2b4f88[_0x2fafd0(0x18e)])),await warehouse[_0x2fafd0(0x1a8)]({'_id':_0x3eeba7[_0x2fafd0(0x21b)][_0x2fafd0(0x149)](),'product_details._id':_0x5bc714[_0x2fafd0(0x21b)]['valueOf'](),'product_details.uuid':_0x2b4f88[_0x2fafd0(0x122)]},{'$set':{'product_details.$.product_stock':_0x25f61c}}));}console[_0x2fafd0(0x1af)](typeof _0x2b4f88[_0x2fafd0(0x1c4)]);if(typeof _0x2b4f88[_0x2fafd0(0x1c4)]!==_0x2fafd0(0x1e4)){var _0x48ddb1=await staff[_0x2fafd0(0x196)](_0x2b4f88[_0x2fafd0(0x1c4)]);console[_0x2fafd0(0x1af)](_0x2fafd0(0x199));var _0x1c15a6=0x0;for(let _0x5658e1=0x0;_0x5658e1<=_0x48ddb1[_0x2fafd0(0x11f)][_0x2fafd0(0x138)]-0x1;_0x5658e1++){const _0x5bd12d=_0x48ddb1['product_list'][_0x5658e1];console[_0x2fafd0(0x1af)](_0x2b4f88[_0x2fafd0(0x129)]+_0x2fafd0(0x1f6)+_0x5bd12d[_0x2fafd0(0x110)]+'\x20&&\x20'+_0x2b4f88['_id']+_0x2fafd0(0x1f6)+_0x2b4f88[_0x2fafd0(0x21b)]),_0x2b4f88[_0x2fafd0(0x129)]==_0x5bd12d[_0x2fafd0(0x110)]&&_0x2b4f88[_0x2fafd0(0x21b)]==0x1&&(_0x5bd12d['product_stock']=Math['abs'](_0x5bd12d[_0x2fafd0(0x1d6)])+Math[_0x2fafd0(0x1c5)](_0x2b4f88['quantity']),_0x1c15a6++);}console[_0x2fafd0(0x1af)](_0x2fafd0(0x214),_0x1c15a6),_0x1c15a6=='0'&&(_0x48ddb1[_0x2fafd0(0x11f)]=_0x48ddb1[_0x2fafd0(0x11f)][_0x2fafd0(0x208)]({'product_name':_0x2b4f88[_0x2fafd0(0x15a)],'product_stock':_0x2b4f88['quantity'],'bay':_0x2b4f88[_0x2fafd0(0x182)],'level':_0x2b4f88['level'],'product_code':_0x2b4f88[_0x2fafd0(0x185)],'primary_code':_0x2b4f88[_0x2fafd0(0x1a3)],'secondary_code':_0x2b4f88[_0x2fafd0(0x123)],'expiry_date':_0x2b4f88[_0x2fafd0(0x221)],'production_date':_0x2b4f88[_0x2fafd0(0x150)],'maxProducts':_0x2b4f88['maxProducts'],'batch_code':_0x2b4f88[_0x2fafd0(0x1f9)],'secondary_unit':_0x2b4f88[_0x2fafd0(0x1e0)],'unit':_0x2b4f88[_0x2fafd0(0x10a)],'maxProducts':_0x2b4f88[_0x2fafd0(0x1fb)],'maxPerUnit':_0x2b4f88[_0x2fafd0(0x10e)],'invoice':_0x2b4f88[_0x2fafd0(0x224)],'warehouse_id':_0x2b4f88[_0x2fafd0(0x129)],'id_incoming':_0x2b4f88['_id'],'uuid':_0x2b4f88[_0x2fafd0(0x122)],'gross_price':_0x2b4f88[_0x2fafd0(0x145)],'date_incoming':_0x2b4f88[_0x2fafd0(0x1d7)],'outgoing_invoice':_0x2b4f88[_0x2fafd0(0x117)]}),await _0x48ddb1['save']());}}_0x21a9f1[_0x2fafd0(0x1e5)]=_0x2fafd0(0x1bf);const _0xbc7158=await _0x21a9f1['save'](),_0x44a089=await master_shop[_0x2fafd0(0x111)](),_0x18ace7=await email_settings['findOne'](),_0x47b3c8=await supervisor_settings[_0x2fafd0(0x111)]();var _0x3ebe35=_0x21a9f1[_0x2fafd0(0x124)],_0x829115='',_0x94f4f0;for(_0x94f4f0 in _0x3ebe35){_0x829115+=_0x2fafd0(0x142)+_0x2fafd0(0x166)+_0x3ebe35[_0x94f4f0][_0x2fafd0(0x15a)]+_0x2fafd0(0x1bd)+_0x2fafd0(0x166)+_0x3ebe35[_0x94f4f0][_0x2fafd0(0x185)]+'</td>'+_0x2fafd0(0x166)+_0x3ebe35[_0x94f4f0]['quantity']+'</td>'+_0x2fafd0(0x166)+_0x3ebe35[_0x94f4f0]['unit']+'</td>'+_0x2fafd0(0x166)+_0x3ebe35[_0x94f4f0]['secondary_unit']+_0x2fafd0(0x1bd)+_0x2fafd0(0x166)+_0x21a9f1[_0x2fafd0(0x173)]+_0x2fafd0(0x1bd)+_0x2fafd0(0x166)+_0x3ebe35[_0x94f4f0][_0x2fafd0(0x1ed)]+_0x2fafd0(0x1bd)+_0x2fafd0(0x166)+_0x3ebe35[_0x94f4f0][_0x2fafd0(0x182)]+'</td>';}_0x9a0b5d[_0x2fafd0(0x167)](_0x2fafd0(0x135),_0x2fafd0(0x1a6)),_0x492901[_0x2fafd0(0x12a)](_0x2fafd0(0x19d)+_0x431a9d);}catch(_0x2f3855){console[_0x2fafd0(0x1af)](_0x2f3855);}}),router[a0_0x3457ae(0x14e)](a0_0x3457ae(0x1c3),auth,async(_0x3e5e2c,_0x3c884b)=>{var _0x3f8d57=a0_0x3457ae;try{const {username:_0x2327d4,email:_0x5bb7bc,role:_0x11f833}=_0x3e5e2c[_0x3f8d57(0x13c)],_0xf282fe=_0x3e5e2c[_0x3f8d57(0x13c)],_0x378b8a=await profile[_0x3f8d57(0x15f)]({'email':_0xf282fe[_0x3f8d57(0x125)]}),_0x59d8dc=await master_shop[_0x3f8d57(0x111)](),_0xfe5542=_0x3e5e2c['params']['id'],_0x1337cf=await sales_finished[_0x3f8d57(0x196)](_0xfe5542);let _0x1a113a=new Date(_0x1337cf['expiry_date']),_0x3065e4=('0'+_0x1a113a['getDate']())[_0x3f8d57(0x1ad)](-0x2),_0x583bf4=('0'+(_0x1a113a['getMonth']()+0x1))[_0x3f8d57(0x1ad)](-0x2),_0x2b10ee=_0x1a113a[_0x3f8d57(0x179)](),_0x13da85=_0x2b10ee+'-'+_0x583bf4+'-'+_0x3065e4;var _0x1f9b59=[_0x3f8d57(0x158),_0x3f8d57(0x132)];const _0x123077=await warehouse[_0x3f8d57(0x1be)]([{'$match':{'name':_0x1337cf[_0x3f8d57(0x173)],'room':_0x1337cf[_0x3f8d57(0x116)]}},{'$unwind':_0x3f8d57(0x219)},{'$group':{'_id':_0x3f8d57(0x20f),'name':{'$first':_0x3f8d57(0x134)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3f8d57(0x19e)},'bin':{'$first':_0x3f8d57(0x1db)},'type':{'$first':_0x3f8d57(0x211)},'floorlevel':{'$first':_0x3f8d57(0x168)},'primary_code':{'$first':_0x3f8d57(0x178)},'secondary_code':{'$first':_0x3f8d57(0x1fd)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3f8d57(0x133)},'rack':{'$first':'$product_details.rack'}}}]),_0x11a33e=await customer['find']({});let _0x9101d9;if(_0xf282fe[_0x3f8d57(0x121)]==_0x3f8d57(0x1d4)){const _0x54f700=await staff[_0x3f8d57(0x15f)]({'email':_0xf282fe[_0x3f8d57(0x125)]});_0x9101d9=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x54f700[_0x3f8d57(0x1d5)]}},{'$group':{'_id':'$name','name':{'$first':_0x3f8d57(0x120)}}}]);}else _0x9101d9=await warehouse[_0x3f8d57(0x1be)]([{'$match':{'status':_0x3f8d57(0x177)}},{'$group':{'_id':'$name','name':{'$first':_0x3f8d57(0x120)}}}]);const _0xd8c123=await product[_0x3f8d57(0x111)]({});if(_0x59d8dc[0x0][_0x3f8d57(0x1b4)]==_0x3f8d57(0x1e2)){var _0x5a2e10=users['English'];console[_0x3f8d57(0x1af)](_0x5a2e10);}else{if(_0x59d8dc[0x0]['language']==_0x3f8d57(0x11d))var _0x5a2e10=users[_0x3f8d57(0x11d)];else{if(_0x59d8dc[0x0][_0x3f8d57(0x1b4)]=='German')var _0x5a2e10=users[_0x3f8d57(0x189)];else{if(_0x59d8dc[0x0][_0x3f8d57(0x1b4)]==_0x3f8d57(0x105))var _0x5a2e10=users['Spanish'];else{if(_0x59d8dc[0x0]['language']=='French')var _0x5a2e10=users[_0x3f8d57(0x1d9)];else{if(_0x59d8dc[0x0][_0x3f8d57(0x1b4)]==_0x3f8d57(0x225))var _0x5a2e10=users[_0x3f8d57(0x108)];else{if(_0x59d8dc[0x0]['language']==_0x3f8d57(0x209))var _0x5a2e10=users[_0x3f8d57(0x209)];else{if(_0x59d8dc[0x0]['language']==_0x3f8d57(0x146))var _0x5a2e10=users['Arabic'];}}}}}}}_0x3c884b[_0x3f8d57(0x1cd)](_0x3f8d57(0x1ab),{'success':_0x3e5e2c[_0x3f8d57(0x167)](_0x3f8d57(0x135)),'errors':_0x3e5e2c['flash'](_0x3f8d57(0x21c)),'role':_0xf282fe,'profile':_0x378b8a,'customer':_0x11a33e,'warehouse':_0x9101d9,'product':_0x123077,'user':_0x1337cf,'master_shop':_0x59d8dc,'unit':_0xd8c123,'language':_0x5a2e10,'rooms_data':_0x1f9b59,'ed_fullDate':_0x13da85});}catch(_0x4bd2f7){console['log'](_0x4bd2f7);}}),router[a0_0x3457ae(0x1c8)](a0_0x3457ae(0x1c3),auth,async(_0x31d7b3,_0x29c49c)=>{var _0x23c57c=a0_0x3457ae;try{const _0x1cf256=_0x31d7b3[_0x23c57c(0x172)]['id'],_0x11215e=await sales_finished[_0x23c57c(0x15f)]({'_id':_0x31d7b3[_0x23c57c(0x172)]['id']}),_0x4113df=await warehouse[_0x23c57c(0x15f)]({'name':_0x11215e[_0x23c57c(0x173)],'room':_0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x116)],'warehouse_category':_0x23c57c(0x143)}),{invoice:_0x594d5c,customer:_0x2ebffc,date:_0x5ed4f8,warehouse_name:_0x2b24db,product_name:_0x227154,stock:_0x1a370e,adjust_qty:_0xcb6d0b,note:_0x4e295d,room:_0x5ad67d,primary_code:_0x4b4088,secondary_code:_0x138fd1,prod_code:_0x1b1b74,level:_0x3e6034,isle:_0x1532de,pallet:_0x203306,expiry_date:_0x52ff8c}=_0x31d7b3[_0x23c57c(0x200)];if(typeof _0x227154=='string')var _0x127c76=[_0x31d7b3['body'][_0x23c57c(0x15a)]],_0x194718=[_0x31d7b3[_0x23c57c(0x200)]['stock']],_0x55bc8c=[_0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x184)]],_0x5c13d6=[_0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x1a3)]],_0x430ab2=[_0x31d7b3[_0x23c57c(0x200)]['secondary_code']],_0x322cde=[_0x31d7b3['body'][_0x23c57c(0x181)]],_0x11e432=[_0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x18b)]],_0xddec44=[_0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x221)]];else var _0x127c76=[..._0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x15a)]],_0x194718=[..._0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x16c)]],_0x55bc8c=[..._0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x184)]],_0x5c13d6=[..._0x31d7b3[_0x23c57c(0x200)]['primary_code']],_0x430ab2=[..._0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x123)]],_0x322cde=[..._0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x181)]],_0x11e432=[..._0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x18b)]],_0xddec44=[..._0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x221)]];const _0x3c21e4=_0x127c76[_0x23c57c(0x1c6)](_0x55782e=>{return _0x55782e={'product_name':_0x55782e};});_0x194718['forEach']((_0xec9178,_0x337662)=>{var _0x23c990=_0x23c57c;_0x3c21e4[_0x337662][_0x23c990(0x16c)]=_0xec9178;}),_0x55bc8c[_0x23c57c(0x16a)]((_0x1c28f8,_0xc26cc2)=>{var _0x19b46c=_0x23c57c;_0x3c21e4[_0xc26cc2][_0x19b46c(0x18e)]=_0x1c28f8;}),_0x5c13d6[_0x23c57c(0x16a)]((_0x3f6c51,_0x30a081)=>{_0x3c21e4[_0x30a081]['primary_code']=_0x3f6c51;}),_0x430ab2['forEach']((_0x21031a,_0xa80e10)=>{var _0x35f0c0=_0x23c57c;_0x3c21e4[_0xa80e10][_0x35f0c0(0x123)]=_0x21031a;}),_0x322cde['forEach']((_0x1d7578,_0x30df3f)=>{var _0x22d496=_0x23c57c;_0x3c21e4[_0x30df3f][_0x22d496(0x185)]=_0x1d7578;}),_0x11e432['forEach']((_0x239938,_0x47f73f)=>{_0x3c21e4[_0x47f73f]['level']=_0x239938;}),_0xddec44[_0x23c57c(0x16a)]((_0x1e33e4,_0x581745)=>{var _0x107921=_0x23c57c;_0x3c21e4[_0x581745][_0x107921(0x221)]=_0x1e33e4;});var _0xd83693=0x0;_0x3c21e4[_0x23c57c(0x16a)](_0xa41dea=>{var _0x4873af=_0x23c57c;console[_0x4873af(0x1af)](_0x4873af(0x21a),_0xa41dea),(parseInt(_0xa41dea[_0x4873af(0x16c)])<parseInt(_0xa41dea[_0x4873af(0x18e)])||parseInt(_0xa41dea[_0x4873af(0x18e)])==0x0)&&_0xd83693++;});if(_0xd83693!=0x0)return _0x31d7b3[_0x23c57c(0x167)](_0x23c57c(0x21c),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x29c49c[_0x23c57c(0x12a)](_0x23c57c(0x186));_0x11215e[_0x23c57c(0x124)]['forEach'](_0x517e44=>{var _0x3d7b2f=_0x23c57c;const _0x5fa615=_0x4113df['product_details'][_0x3d7b2f(0x1c6)](_0x155eb6=>{var _0x9bd2c6=_0x3d7b2f;_0x155eb6[_0x9bd2c6(0x15a)]==_0x517e44[_0x9bd2c6(0x15a)]&&_0x155eb6['bay']==_0x517e44['bay']&&(_0x155eb6[_0x9bd2c6(0x1d6)]=parseInt(_0x155eb6[_0x9bd2c6(0x1d6)])+parseInt(_0x517e44['quantity']));});}),await _0x4113df[_0x23c57c(0x1f8)]();const _0x128a8e=_0x3c21e4[_0x23c57c(0x151)](_0xc42e87=>_0xc42e87[_0x23c57c(0x18e)]!=='0'&&_0xc42e87[_0x23c57c(0x18e)]!=='');_0x11215e[_0x23c57c(0x224)]=_0x594d5c,_0x11215e['customer']=_0x2ebffc,_0x11215e[_0x23c57c(0x16e)]=_0x5ed4f8,_0x11215e[_0x23c57c(0x173)]=_0x2b24db,_0x11215e[_0x23c57c(0x124)]=_0x128a8e,_0x11215e['note']=_0x4e295d,_0x11215e[_0x23c57c(0x116)]=_0x5ad67d;const _0x5f225a=await _0x11215e[_0x23c57c(0x1f8)](),_0x239272=await sales_finished['findOne']({'_id':_0x31d7b3[_0x23c57c(0x172)]['id']}),_0x1ad46c=await warehouse['findOne']({'name':_0x2b24db,'room':_0x5ad67d,'warehouse_category':'Finished\x20Goods'});_0x239272['sale_product']['forEach'](_0x158762=>{var _0x682df=_0x23c57c;const _0x33ab9a=_0x1ad46c['product_details'][_0x682df(0x1c6)](_0x46c37a=>{var _0x20faf4=_0x682df;_0x46c37a[_0x20faf4(0x15a)]==_0x158762[_0x20faf4(0x15a)]&&_0x46c37a[_0x20faf4(0x182)]==_0x158762[_0x20faf4(0x182)]&&(_0x46c37a['product_stock']=parseInt(_0x46c37a[_0x20faf4(0x1d6)])-parseInt(_0x158762[_0x20faf4(0x18e)]));});}),console['log'](_0x23c57c(0x187),_0x1ad46c),await _0x1ad46c[_0x23c57c(0x1f8)]();const _0x5d645d=await c_payment_data[_0x23c57c(0x15f)]({'invoice':_0x31d7b3[_0x23c57c(0x200)]['invoice']});_0x5d645d[_0x23c57c(0x1bc)]=_0x31d7b3[_0x23c57c(0x200)][_0x23c57c(0x1bc)],await _0x5d645d[_0x23c57c(0x1f8)](),_0x31d7b3[_0x23c57c(0x167)](_0x23c57c(0x135),'Sales\x20Update\x20successfully'),_0x29c49c[_0x23c57c(0x12a)](_0x23c57c(0x212));}catch(_0x321461){console['log'](_0x321461);}}),router['post'](a0_0x3457ae(0x1f5),auth,async(_0x245c09,_0x14ed17)=>{var _0x3d7168=a0_0x3457ae;try{const _0x50d389=_0x245c09[_0x3d7168(0x172)]['id'],{invoice:_0x1efb73,customer:_0x2bce2b,receivable_amount:_0xb22020,received_amount:_0x2e157d}=_0x245c09[_0x3d7168(0x200)],_0x24819d=await sales[_0x3d7168(0x196)](_0x50d389);console[_0x3d7168(0x1af)](_0x24819d);var _0x113091=_0xb22020-_0x2e157d;console[_0x3d7168(0x1af)](_0x2e157d),_0x24819d[_0x3d7168(0x1e3)]=parseFloat(_0x2e157d)+parseFloat(_0x24819d[_0x3d7168(0x1e3)]),_0x24819d[_0x3d7168(0x17e)]=_0x113091,console[_0x3d7168(0x1af)](_0x24819d);const _0xbcfaaa=await _0x24819d[_0x3d7168(0x1f8)](),_0x1793c5=await c_payment_data[_0x3d7168(0x15f)]({'invoice':_0x1efb73});_0x1793c5[_0x3d7168(0x15b)]=_0x113091,await _0x1793c5[_0x3d7168(0x1f8)]();let _0x43e0ab=new Date(),_0x59f8c6=('0'+_0x43e0ab[_0x3d7168(0x11b)]())[_0x3d7168(0x1ad)](-0x2),_0x302335=('0'+(_0x43e0ab[_0x3d7168(0x217)]()+0x1))['slice'](-0x2),_0x24bc43=_0x43e0ab[_0x3d7168(0x179)](),_0x14bc08=_0x24bc43+'-'+_0x302335+'-'+_0x59f8c6;const _0x116395=new customer_payment({'invoice':_0x1efb73,'date':_0x24bc43+'-'+_0x302335+'-'+_0x59f8c6,'customer':_0x2bce2b,'reason':_0x3d7168(0x222),'amount':_0x2e157d}),_0x4342bd=await _0x116395['save']();_0x245c09[_0x3d7168(0x167)](_0x3d7168(0x135),_0x3d7168(0x1b2)),_0x14ed17[_0x3d7168(0x12a)](_0x3d7168(0x183));}catch(_0x2ec54d){console[_0x3d7168(0x1af)](_0x2ec54d);}}),router[a0_0x3457ae(0x14e)](a0_0x3457ae(0x1ef),auth,async(_0x4e13e3,_0x5a05d1)=>{var _0x59ff5f=a0_0x3457ae;try{const {username:_0x2aa1da,email:_0x187a37,role:_0xbb8b68}=_0x4e13e3[_0x59ff5f(0x13c)],_0x23eea0=_0x4e13e3[_0x59ff5f(0x13c)],_0x75cccf=await profile[_0x59ff5f(0x15f)]({'email':_0x23eea0[_0x59ff5f(0x125)]}),_0x1373d3=await master_shop[_0x59ff5f(0x111)]();console[_0x59ff5f(0x1af)](_0x59ff5f(0x210),_0x1373d3);const _0xa9b488=_0x4e13e3[_0x59ff5f(0x172)]['id'],_0x258b7f=await sales['findById'](_0xa9b488);console[_0x59ff5f(0x1af)](_0x258b7f);const _0x5bf34e=await customer['findOne']({'name':_0x258b7f['customer']});console[_0x59ff5f(0x1af)](_0x5bf34e);if(_0x1373d3[0x0][_0x59ff5f(0x1b4)]==_0x59ff5f(0x1e2)){var _0x56a51f=users[_0x59ff5f(0x18a)];console[_0x59ff5f(0x1af)](_0x56a51f);}else{if(_0x1373d3[0x0][_0x59ff5f(0x1b4)]==_0x59ff5f(0x11d))var _0x56a51f=users[_0x59ff5f(0x11d)];else{if(_0x1373d3[0x0][_0x59ff5f(0x1b4)]==_0x59ff5f(0x189))var _0x56a51f=users[_0x59ff5f(0x189)];else{if(_0x1373d3[0x0]['language']==_0x59ff5f(0x105))var _0x56a51f=users[_0x59ff5f(0x105)];else{if(_0x1373d3[0x0][_0x59ff5f(0x1b4)]==_0x59ff5f(0x1d9))var _0x56a51f=users[_0x59ff5f(0x1d9)];else{if(_0x1373d3[0x0][_0x59ff5f(0x1b4)]==_0x59ff5f(0x225))var _0x56a51f=users['Portuguese'];else{if(_0x1373d3[0x0][_0x59ff5f(0x1b4)]==_0x59ff5f(0x209))var _0x56a51f=users[_0x59ff5f(0x209)];else{if(_0x1373d3[0x0]['language']==_0x59ff5f(0x146))var _0x56a51f=users[_0x59ff5f(0x1ec)];}}}}}}}_0x5a05d1['render']('sales_invoice',{'success':_0x4e13e3[_0x59ff5f(0x167)](_0x59ff5f(0x135)),'errors':_0x4e13e3[_0x59ff5f(0x167)](_0x59ff5f(0x21c)),'role':_0x23eea0,'profile':_0x75cccf,'master_shop':_0x1373d3,'customers':_0x5bf34e,'sales':_0x258b7f,'language':_0x56a51f});}catch(_0x3878dd){console[_0x59ff5f(0x1af)](_0x3878dd);}}),router[a0_0x3457ae(0x14e)](a0_0x3457ae(0x192),auth,async(_0x3ed375,_0x4e4497)=>{var _0x1ffe26=a0_0x3457ae;try{const {username:_0x186699,email:_0x2e0ef1,role:_0x3b4283}=_0x3ed375[_0x1ffe26(0x13c)],_0x2f0db2=_0x3ed375[_0x1ffe26(0x13c)],_0x3537ae=await profile[_0x1ffe26(0x15f)]({'email':_0x2f0db2[_0x1ffe26(0x125)]}),_0x4a4fcb=await master_shop[_0x1ffe26(0x111)](),_0x1c48ad=_0x3ed375[_0x1ffe26(0x172)]['id'],_0x223bdb=await sales_finished[_0x1ffe26(0x196)](_0x1c48ad),_0x48b5de=await warehouse[_0x1ffe26(0x1be)]([{'$match':{'name':_0x223bdb[_0x1ffe26(0x173)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1ffe26(0x20f),'name':{'$first':_0x1ffe26(0x134)},'product_stock':{'$first':_0x1ffe26(0x1b9)},'bay':{'$first':_0x1ffe26(0x19e)},'bin':{'$first':_0x1ffe26(0x1db)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1ffe26(0x178)},'secondary_code':{'$first':_0x1ffe26(0x1fd)},'product_code':{'$first':_0x1ffe26(0x1b3)},'storage':{'$first':_0x1ffe26(0x133)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1ffe26(0x197)},'production_date':{'$first':_0x1ffe26(0x17d)},'unit':{'$first':_0x1ffe26(0x1c7)},'secondary_unit':{'$first':_0x1ffe26(0x1ea)},'maxProducts':{'$first':_0x1ffe26(0x16b)},'batch_code':{'$first':_0x1ffe26(0x188)},'maxPerUnit':{'$first':_0x1ffe26(0x10c)}}}]),_0x33e90f=await product[_0x1ffe26(0x111)]({}),_0x34c0c7=await warehouse[_0x1ffe26(0x1be)]([{'$match':{'status':_0x1ffe26(0x177),'warehouse_category':'Finished\x20Goods','name':{'$ne':'Return\x20Goods','$ne':_0x1ffe26(0x148)}}},{'$group':{'_id':_0x1ffe26(0x120),'name':{'$first':_0x1ffe26(0x120)}}},{'$sort':{'name':0x1}}]);var _0x37f21a=['Return\x20Rooms'];const _0x2f142f=await warehouse[_0x1ffe26(0x1be)]([{'$match':{'status':'Enabled','name':_0x1ffe26(0x148)}},{'$group':{'_id':_0x1ffe26(0x120),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x4a4fcb[0x0]['language']==_0x1ffe26(0x1e2)){var _0x248cf1=users[_0x1ffe26(0x18a)];console['log'](_0x248cf1);}else{if(_0x4a4fcb[0x0][_0x1ffe26(0x1b4)]==_0x1ffe26(0x11d))var _0x248cf1=users[_0x1ffe26(0x11d)];else{if(_0x4a4fcb[0x0]['language']==_0x1ffe26(0x189))var _0x248cf1=users[_0x1ffe26(0x189)];else{if(_0x4a4fcb[0x0]['language']=='Spanish')var _0x248cf1=users[_0x1ffe26(0x105)];else{if(_0x4a4fcb[0x0]['language']=='French')var _0x248cf1=users[_0x1ffe26(0x1d9)];else{if(_0x4a4fcb[0x0][_0x1ffe26(0x1b4)]==_0x1ffe26(0x225))var _0x248cf1=users[_0x1ffe26(0x108)];else{if(_0x4a4fcb[0x0]['language']==_0x1ffe26(0x209))var _0x248cf1=users[_0x1ffe26(0x209)];else{if(_0x4a4fcb[0x0][_0x1ffe26(0x1b4)]==_0x1ffe26(0x146))var _0x248cf1=users[_0x1ffe26(0x1ec)];}}}}}}}_0x4e4497[_0x1ffe26(0x1cd)](_0x1ffe26(0x10b),{'success':_0x3ed375[_0x1ffe26(0x167)](_0x1ffe26(0x135)),'errors':_0x3ed375['flash']('errors'),'role':_0x2f0db2,'profile':_0x3537ae,'user':_0x223bdb,'stock':_0x48b5de,'master_shop':_0x4a4fcb,'unit':_0x33e90f,'language':_0x248cf1,'warehouses':_0x34c0c7,'rooms':_0x37f21a,'warehouse_QA':_0x2f142f});}catch(_0x1ffa04){console['log'](_0x1ffa04),_0x4e4497[_0x1ffe26(0x1ca)](0xc8)['json']({'message':_0x1ffa04[_0x1ffe26(0x13a)]});}}),router[a0_0x3457ae(0x1c8)]('/view/return_sales/:id',auth,async(_0x7b9cee,_0x1bb7c4)=>{var _0x1c7a08=a0_0x3457ae;if(_0x7b9cee[_0x1c7a08(0x200)]['for_categorize']=='QA')try{const {invoice:_0x18a75d,date:_0x43280a,warehouse_name:_0x1e0b18,product_name:_0x26e814,primary_code:_0x2fe7b1,secondary_code:_0x5988bb,product_code:_0x265ca5,sales_quantity:_0xc8f526,stocks:_0x280912,return_qty:_0x2590e3,Room_name:_0x5b5170,to_warehouse_name_QA:_0x9466f4,to_Room_name_QA:_0x1cebd1,note:_0x34fccc,for_categorize:_0x34c822,product_name_QA1:_0x37b162}=_0x7b9cee[_0x1c7a08(0x200)];if(typeof _0x37b162==_0x1c7a08(0x218))var _0x12ef0f=[_0x7b9cee[_0x1c7a08(0x200)]['product_name_QA1']],_0x2c53ef=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x13e)]],_0x9d723a=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1ae)]],_0x1de9cd=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1b6)]],_0x1e6894=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x12d)]],_0x3ddd1e=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1ce)]],_0x3b53c4=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x130)]],_0x5d7f19=[_0x7b9cee[_0x1c7a08(0x200)]['maxPerUnit_QA']],_0x32f624=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1f0)]],_0x4cfaf9=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x103)]],_0x1e068b=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x17c)]],_0x2a382c=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x190)]],_0x37b56a=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x13d)]],_0x34f749=[_0x7b9cee['body']['expiry_date_QA']];else var _0x12ef0f=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x16f)]],_0x2c53ef=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x13e)]],_0x9d723a=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1ae)]],_0x1de9cd=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1b6)]],_0x1e6894=[..._0x7b9cee['body']['sales_quantity_QA']],_0x3ddd1e=[..._0x7b9cee[_0x1c7a08(0x200)]['stocks_QA']],_0x3b53c4=[..._0x7b9cee['body']['return_qty_QA']],_0x5d7f19=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x118)]],_0x32f624=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1f0)]],_0x4cfaf9=[..._0x7b9cee['body'][_0x1c7a08(0x103)]],_0x1e068b=[..._0x7b9cee['body'][_0x1c7a08(0x17c)]],_0x2a382c=[..._0x7b9cee['body'][_0x1c7a08(0x190)]],_0x37b56a=[..._0x7b9cee[_0x1c7a08(0x200)]['production_date_QA']],_0x34f749=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x220)]];const _0x45d9bd=_0x12ef0f[_0x1c7a08(0x1c6)](_0x503ca5=>{return _0x503ca5={'product_name':_0x503ca5};});_0x2c53ef[_0x1c7a08(0x16a)]((_0x483e54,_0x1fdfc0)=>{_0x45d9bd[_0x1fdfc0]['primary_code']=_0x483e54;}),_0x9d723a[_0x1c7a08(0x16a)]((_0x1444b2,_0x388eb3)=>{var _0x51faa4=_0x1c7a08;_0x45d9bd[_0x388eb3][_0x51faa4(0x123)]=_0x1444b2;}),_0x1de9cd['forEach']((_0x4086c5,_0x3cd131)=>{var _0x15d74e=_0x1c7a08;_0x45d9bd[_0x3cd131][_0x15d74e(0x185)]=_0x4086c5;}),_0x1e6894[_0x1c7a08(0x16a)]((_0x348d4a,_0x507e3d)=>{var _0x39c2d7=_0x1c7a08;_0x45d9bd[_0x507e3d][_0x39c2d7(0x1a9)]=_0x348d4a;}),_0x3ddd1e[_0x1c7a08(0x16a)]((_0x3a9bdb,_0x4e3c1e)=>{var _0x59f228=_0x1c7a08;_0x45d9bd[_0x4e3c1e][_0x59f228(0x16c)]=_0x3a9bdb;}),_0x3b53c4[_0x1c7a08(0x16a)]((_0x467916,_0x2e703b)=>{var _0x39df61=_0x1c7a08;_0x45d9bd[_0x2e703b][_0x39df61(0x1dc)]=_0x467916;}),_0x5d7f19[_0x1c7a08(0x16a)]((_0x1dda2b,_0xf3b29c)=>{var _0x406359=_0x1c7a08;_0x45d9bd[_0xf3b29c][_0x406359(0x1de)]=_0x1dda2b;}),_0x32f624['forEach']((_0x31b374,_0x2a5d72)=>{var _0x59a971=_0x1c7a08;_0x45d9bd[_0x2a5d72][_0x59a971(0x1fb)]=_0x31b374;}),_0x4cfaf9['forEach']((_0x85bd5d,_0x4aea5d)=>{var _0x3c6d90=_0x1c7a08;_0x45d9bd[_0x4aea5d][_0x3c6d90(0x1f9)]=_0x85bd5d;}),_0x1e068b['forEach']((_0x29a3d7,_0x45f221)=>{var _0x219993=_0x1c7a08;_0x45d9bd[_0x45f221][_0x219993(0x1e0)]=_0x29a3d7;}),_0x2a382c['forEach']((_0x16d5f8,_0x25ace5)=>{_0x45d9bd[_0x25ace5]['unit']=_0x16d5f8;}),_0x37b56a[_0x1c7a08(0x16a)]((_0x2e1c3d,_0x5945b4)=>{var _0x5d0277=_0x1c7a08;_0x45d9bd[_0x5945b4][_0x5d0277(0x150)]=_0x2e1c3d;}),_0x34f749[_0x1c7a08(0x16a)]((_0x1a24c4,_0x26cc8d)=>{var _0x228672=_0x1c7a08;_0x45d9bd[_0x26cc8d][_0x228672(0x221)]=_0x1a24c4;});const _0x1b2295=await sales_finished['findOne']({'invoice':_0x18a75d});_0x1b2295[_0x1c7a08(0x205)]=_0x1c7a08(0x1bf);const _0x426f9d=await _0x1b2295['save'](),_0x212f64=new sales_return_finished({'invoice':_0x18a75d,'customer':_0x7b9cee[_0x1c7a08(0x200)]['customer'],'date':_0x43280a,'warehouse_name':_0x1e0b18,'room':_0x5b5170,'ToWarehouse':_0x9466f4,'ToRoom':_0x1cebd1,'return_sale_QA':_0x45d9bd,'note':_0x34fccc,'warehouse_cat':_0x34c822}),_0x53c84f=await _0x212f64[_0x1c7a08(0x1f8)](),_0x55a35a=await sales_return_finished['findOne']({'invoice':_0x18a75d}),_0x497602=await warehouse[_0x1c7a08(0x15f)]({'name':_0x9466f4,'room':_0x1cebd1});_0x55a35a[_0x1c7a08(0x128)][_0x1c7a08(0x16a)](_0x4b5251=>{var _0x4d941b=_0x1c7a08,_0x59a415=0x0;const _0x57d198=_0x497602[_0x4d941b(0x1c9)][_0x4d941b(0x1c6)](_0x4035e1=>{var _0xfcf7ea=_0x4d941b;_0x4035e1[_0xfcf7ea(0x15a)]==_0x4b5251[_0xfcf7ea(0x15a)]&&_0x4035e1['expiry_date']==_0x4b5251[_0xfcf7ea(0x221)]&&_0x4035e1[_0xfcf7ea(0x150)]==_0x4b5251[_0xfcf7ea(0x150)]&&_0x4035e1['batch_code']==_0x4b5251['batch_code']&&(_0x4035e1['product_stock']=parseInt(_0x4035e1[_0xfcf7ea(0x1d6)])+parseInt(_0x4b5251[_0xfcf7ea(0x1dc)]),_0x59a415++);});_0x59a415=='0'&&(_0x497602[_0x4d941b(0x1c9)]=_0x497602[_0x4d941b(0x1c9)][_0x4d941b(0x208)]({'product_name':_0x4b5251[_0x4d941b(0x15a)],'product_stock':_0x4b5251[_0x4d941b(0x1dc)],'primary_code':_0x4b5251['primary_code'],'secondary_code':_0x4b5251['secondary_code'],'product_code':_0x4b5251[_0x4d941b(0x185)],'batch_code':_0x4b5251['batch_code'],'maxPerUnit':_0x4b5251[_0x4d941b(0x1de)],'production_date':_0x4b5251[_0x4d941b(0x150)],'expiry_date':_0x4b5251[_0x4d941b(0x221)],'secondary_unit':_0x4b5251[_0x4d941b(0x1e0)],'unit':_0x4b5251['unit'],'maxProducts':_0x4b5251[_0x4d941b(0x1fb)],'bay':_0x4b5251[_0x4d941b(0x182)]}));}),await _0x497602['save']();const _0x50cdc7=new c_payment_data({'invoice':_0x18a75d,'customer':_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1e8)],'reason':_0x1c7a08(0x154)});await _0x50cdc7[_0x1c7a08(0x1f8)]();const _0x430ac=await master_shop['find'](),_0x5bcb2a=await email_settings['findOne'](),_0xf7d752=await customer[_0x1c7a08(0x15f)]({'name':_0x7b9cee['body'][_0x1c7a08(0x1e8)]});_0x430ac[0x0][_0x1c7a08(0x169)]==0x1?(right_currency=_0x430ac[0x0][_0x1c7a08(0x1e6)],left_currency=''):(right_currency='',left_currency=_0x430ac[0x0][_0x1c7a08(0x1e6)]);var _0x28affa=_0x12ef0f,_0xfdd7c2=_0x3b53c4,_0x1d8768='',_0x4edc37;for(_0x4edc37 in _0x28affa){_0x1d8768+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x28affa[_0x4edc37]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfdd7c2[_0x4edc37]+'</td>'+_0x1c7a08(0x215);}console[_0x1c7a08(0x1af)](_0x1c7a08(0x11f),_0x1d8768);let _0x33518c=nodemailer['createTransport']({'service':_0x1c7a08(0x194),'auth':{'user':_0x5bcb2a['email'],'pass':_0x5bcb2a[_0x1c7a08(0x13b)]}}),_0x4d34da={'from':_0x5bcb2a[_0x1c7a08(0x125)],'to':_0xf7d752['email'],'subject':_0x1c7a08(0x160),'attachments':[{'filename':_0x1c7a08(0x176),'path':__dirname+_0x1c7a08(0x109)+'/upload/'+_0x430ac[0x0][_0x1c7a08(0x20c)],'cid':_0x1c7a08(0x1e1)}],'html':_0x1c7a08(0x13f)+_0x1c7a08(0x201)+_0x1c7a08(0x165)+_0x1c7a08(0x127)+_0x1c7a08(0x21e)+_0x1c7a08(0x127)+_0x1c7a08(0x1e9)+_0x1c7a08(0x1b8)+_0x1c7a08(0x127)+_0x1c7a08(0x1f2)+_0x430ac[0x0][_0x1c7a08(0x223)]+_0x1c7a08(0x20e)+'</div>'+_0x1c7a08(0x1b8)+_0x1c7a08(0x1cc)+_0x1c7a08(0x127)+_0x1c7a08(0x12b)+_0x1c7a08(0x216)+_0x18a75d+'\x20'+_0x1c7a08(0x155)+'\x20Order\x20Date\x20:\x20'+_0x43280a+'\x20'+_0x1c7a08(0x1b7)+_0x1c7a08(0x1a4)+_0x1c7a08(0x1b8)+_0x1c7a08(0x20b)+_0x1c7a08(0x1ff)+_0x1c7a08(0x142)+_0x1c7a08(0x14a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x1c7a08(0x119)+_0x1c7a08(0x1d8)+_0x1c7a08(0x215)+_0x1c7a08(0x144)+_0x1c7a08(0x159)+'\x20'+_0x1d8768+'\x20'+_0x1c7a08(0x1a0)+_0x1c7a08(0x21d)+'<div>'+_0x1c7a08(0x1fe)+_0x1c7a08(0x1fc)+_0x430ac[0x0][_0x1c7a08(0x223)]+'</h5>'+_0x1c7a08(0x1b8)+'</div>'+_0x1c7a08(0x19c)};_0x33518c[_0x1c7a08(0x162)](_0x4d34da,function(_0x56a94c,_0xaeffcc){var _0x1f62e8=_0x1c7a08;_0x56a94c?(console[_0x1f62e8(0x1af)](_0x56a94c),console['log'](_0x1f62e8(0x1e7))):console[_0x1f62e8(0x1af)](_0x1f62e8(0x107));}),_0x7b9cee[_0x1c7a08(0x167)](_0x1c7a08(0x135),_0x1c7a08(0x191)),_0x1bb7c4['redirect'](_0x1c7a08(0x212));}catch(_0x38cf24){_0x1bb7c4[_0x1c7a08(0x1ca)](0xc8)[_0x1c7a08(0x1aa)]({'message1':_0x38cf24[_0x1c7a08(0x13a)]});}else{if(_0x7b9cee[_0x1c7a08(0x200)]['for_categorize']=='GS')try{const {invoice:_0x552bc4,date:_0x2d94dc,warehouse_name:_0x58c9f9,product_name:_0x188ad3,primary_code:_0x5f4227,secondary_code:_0x5bae45,product_code:_0x4388a5,sales_quantity:_0x526628,stocks:_0x286893,return_qty:_0x210d4a,Room_name:_0x1e2f97,to_warehouse_name:_0x30df6b,to_Room_name:_0x172468,note:_0xd0ad7f,level:_0x253c17,isle:_0xe9d823,pallet:_0x3b3f6a,for_categorize:_0x12285c}=_0x7b9cee[_0x1c7a08(0x200)];if(typeof _0x188ad3==_0x1c7a08(0x218))var _0x12ef0f=[_0x7b9cee['body']['product_name']],_0x2c53ef=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1a3)]],_0x9d723a=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x123)]],_0x1de9cd=[_0x7b9cee[_0x1c7a08(0x200)]['product_code']],_0x1e6894=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x12f)]],_0x3b53c4=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1dc)]],_0x52a595=[_0x7b9cee[_0x1c7a08(0x200)]['bay']],_0x5d7f19=[_0x7b9cee['body'][_0x1c7a08(0x1de)]],_0x32f624=[_0x7b9cee[_0x1c7a08(0x200)]['maxProducts']],_0x4cfaf9=[_0x7b9cee['body']['batch_code']],_0x1e068b=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1e0)]],_0x2a382c=[_0x7b9cee[_0x1c7a08(0x200)]['unit']],_0x37b56a=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x150)]],_0x34f749=[_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x221)]];else var _0x12ef0f=[..._0x7b9cee['body'][_0x1c7a08(0x15a)]],_0x2c53ef=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1a3)]],_0x9d723a=[..._0x7b9cee[_0x1c7a08(0x200)]['secondary_code']],_0x1de9cd=[..._0x7b9cee[_0x1c7a08(0x200)]['product_code']],_0x1e6894=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x12f)]],_0x3b53c4=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1dc)]],_0x52a595=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x182)]],_0x5d7f19=[..._0x7b9cee['body'][_0x1c7a08(0x1de)]],_0x32f624=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1fb)]],_0x4cfaf9=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1f9)]],_0x1e068b=[..._0x7b9cee[_0x1c7a08(0x200)]['secondary_unit']],_0x2a382c=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x10a)]],_0x37b56a=[..._0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x150)]],_0x34f749=[..._0x7b9cee['body']['expiry_date']];const _0x2068c7=_0x12ef0f[_0x1c7a08(0x1c6)](_0x2724a=>{return _0x2724a={'product_name':_0x2724a};});_0x2c53ef[_0x1c7a08(0x16a)]((_0x3a6758,_0x20b9df)=>{var _0x438b4b=_0x1c7a08;_0x2068c7[_0x20b9df][_0x438b4b(0x1a3)]=_0x3a6758;}),_0x9d723a[_0x1c7a08(0x16a)]((_0x6c76d4,_0x2fc0a0)=>{var _0x56ee8c=_0x1c7a08;_0x2068c7[_0x2fc0a0][_0x56ee8c(0x123)]=_0x6c76d4;}),_0x1de9cd['forEach']((_0x387a11,_0x3c0935)=>{_0x2068c7[_0x3c0935]['product_code']=_0x387a11;}),_0x1e6894[_0x1c7a08(0x16a)]((_0x1c8032,_0x82be3e)=>{var _0x1693aa=_0x1c7a08;_0x2068c7[_0x82be3e][_0x1693aa(0x1a9)]=_0x1c8032;}),_0x3b53c4[_0x1c7a08(0x16a)]((_0x417e96,_0xb9bd3d)=>{var _0x448263=_0x1c7a08;_0x2068c7[_0xb9bd3d][_0x448263(0x1dc)]=_0x417e96;}),_0x52a595[_0x1c7a08(0x16a)]((_0x720adb,_0x51e2ea)=>{var _0x6ba27e=_0x1c7a08;_0x2068c7[_0x51e2ea][_0x6ba27e(0x182)]=_0x720adb;}),_0x5d7f19[_0x1c7a08(0x16a)]((_0x2bc933,_0x137163)=>{var _0x554932=_0x1c7a08;_0x2068c7[_0x137163][_0x554932(0x1de)]=_0x2bc933;}),_0x32f624['forEach']((_0x867d29,_0x19b11c)=>{_0x2068c7[_0x19b11c]['maxProducts']=_0x867d29;}),_0x4cfaf9[_0x1c7a08(0x16a)]((_0x26b6b6,_0x5805be)=>{var _0x4250ff=_0x1c7a08;_0x2068c7[_0x5805be][_0x4250ff(0x1f9)]=_0x26b6b6;}),_0x1e068b[_0x1c7a08(0x16a)]((_0x4e68d4,_0x59ae9b)=>{var _0x13877a=_0x1c7a08;_0x2068c7[_0x59ae9b][_0x13877a(0x1e0)]=_0x4e68d4;}),_0x2a382c[_0x1c7a08(0x16a)]((_0x52e9d5,_0x429f9d)=>{var _0x4ae64d=_0x1c7a08;_0x2068c7[_0x429f9d][_0x4ae64d(0x10a)]=_0x52e9d5;}),_0x37b56a[_0x1c7a08(0x16a)]((_0x2afc8c,_0x22c511)=>{_0x2068c7[_0x22c511]['production_date']=_0x2afc8c;}),_0x34f749[_0x1c7a08(0x16a)]((_0x4f68ab,_0x24c8fe)=>{var _0x40edce=_0x1c7a08;_0x2068c7[_0x24c8fe][_0x40edce(0x221)]=_0x4f68ab;});var _0x453e12=0x0;_0x2068c7[_0x1c7a08(0x16a)](_0x34e575=>{var _0x187b4f=_0x1c7a08;(parseInt(_0x34e575[_0x187b4f(0x1a9)])<parseInt(_0x34e575[_0x187b4f(0x1dc)])||parseInt(_0x34e575['stock'])<parseInt(_0x34e575[_0x187b4f(0x1dc)])&&parseInt(_0x34e575[_0x187b4f(0x1a9)])>parseInt(_0x34e575[_0x187b4f(0x1dc)])||parseInt(_0x34e575[_0x187b4f(0x1dc)])==0x0)&&_0x453e12++;});if(_0x453e12!=0x0)return _0x7b9cee[_0x1c7a08(0x167)](_0x1c7a08(0x21c),_0x1c7a08(0x10d)),_0x1bb7c4[_0x1c7a08(0x12a)](_0x1c7a08(0x186));const _0x1645f9=await sales_finished[_0x1c7a08(0x15f)]({'invoice':_0x552bc4});_0x1645f9[_0x1c7a08(0x205)]=_0x1c7a08(0x1bf);const _0x3aaef2=await _0x1645f9[_0x1c7a08(0x1f8)](),_0x17073f=new sales_return_finished({'invoice':_0x552bc4,'customer':_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1e8)],'date':_0x2d94dc,'warehouse_name':_0x58c9f9,'room':_0x1e2f97,'ToWarehouse':_0x30df6b,'ToRoom':_0x172468,'return_sale':_0x2068c7,'note':_0xd0ad7f,'warehouse_cat':_0x12285c}),_0x4e2ab4=await _0x17073f[_0x1c7a08(0x1f8)](),_0x140cff=await sales_return_finished['findOne']({'invoice':_0x552bc4}),_0x556179=await warehouse[_0x1c7a08(0x15f)]({'name':_0x30df6b,'room':_0x172468,'warehouse_category':'Finished\x20Goods'});_0x140cff[_0x1c7a08(0x20a)][_0x1c7a08(0x16a)](_0x4da880=>{var _0x4d919a=_0x1c7a08,_0x1f0647=0x0;const _0x26f557=_0x556179['product_details'][_0x4d919a(0x1c6)](_0x400183=>{var _0x308b53=_0x4d919a;_0x400183['product_name']==_0x4da880[_0x308b53(0x15a)]&&_0x400183[_0x308b53(0x182)]==_0x4da880[_0x308b53(0x182)]&&_0x400183[_0x308b53(0x221)]==_0x4da880[_0x308b53(0x221)]&&_0x400183[_0x308b53(0x150)]==_0x4da880['production_date']&&_0x400183['batch_code']==_0x4da880[_0x308b53(0x1f9)]&&(_0x400183[_0x308b53(0x1d6)]=parseInt(_0x400183[_0x308b53(0x1d6)])+parseInt(_0x4da880[_0x308b53(0x1dc)]),_0x1f0647++);});_0x1f0647=='0'&&(_0x556179['product_details']=_0x556179[_0x4d919a(0x1c9)][_0x4d919a(0x208)]({'product_name':_0x4da880[_0x4d919a(0x15a)],'product_stock':_0x4da880['return_qty'],'primary_code':_0x4da880[_0x4d919a(0x1a3)],'secondary_code':_0x4da880[_0x4d919a(0x123)],'product_code':_0x4da880['product_code'],'bay':_0x4da880['bay'],'batch_code':_0x4da880['batch_code'],'maxPerUnit':_0x4da880[_0x4d919a(0x1de)],'production_date':_0x4da880[_0x4d919a(0x150)],'expiry_date':_0x4da880['expiry_date'],'secondary_unit':_0x4da880['secondary_unit'],'unit':_0x4da880[_0x4d919a(0x10a)],'maxProducts':_0x4da880[_0x4d919a(0x1fb)]}));}),await _0x556179[_0x1c7a08(0x1f8)](),console[_0x1c7a08(0x1af)](_0x7b9cee[_0x1c7a08(0x200)]);const _0x4905ae=new c_payment_data({'invoice':_0x552bc4,'customer':_0x7b9cee[_0x1c7a08(0x200)][_0x1c7a08(0x1e8)],'reason':_0x1c7a08(0x154)});await _0x4905ae[_0x1c7a08(0x1f8)]();const _0x42a653=await master_shop[_0x1c7a08(0x111)]();console[_0x1c7a08(0x1af)]('add\x20post',_0x42a653[0x0][_0x1c7a08(0x20c)]);const _0x544785=await email_settings['findOne'](),_0x3b3a0b=await customer[_0x1c7a08(0x15f)]({'name':_0x7b9cee[_0x1c7a08(0x200)]['customer']});console['log'](_0x1c7a08(0x226),_0x3b3a0b);_0x42a653[0x0]['currency_placement']==0x1?(right_currency=_0x42a653[0x0][_0x1c7a08(0x1e6)],left_currency=''):(right_currency='',left_currency=_0x42a653[0x0][_0x1c7a08(0x1e6)]);var _0x28affa=_0x12ef0f,_0xfdd7c2=_0x3b53c4,_0x1d8768='',_0x4edc37;for(_0x4edc37 in _0x28affa){_0x1d8768+=_0x1c7a08(0x142)+_0x1c7a08(0x166)+_0x28affa[_0x4edc37]+_0x1c7a08(0x1bd)+_0x1c7a08(0x166)+_0xfdd7c2[_0x4edc37]+_0x1c7a08(0x1bd)+_0x1c7a08(0x215);}console[_0x1c7a08(0x1af)]('product_list',_0x1d8768);let _0x2418c7=nodemailer[_0x1c7a08(0x1a2)]({'service':_0x1c7a08(0x194),'auth':{'user':_0x544785[_0x1c7a08(0x125)],'pass':_0x544785[_0x1c7a08(0x13b)]}}),_0x24833e={'from':_0x544785[_0x1c7a08(0x125)],'to':_0x3b3a0b[_0x1c7a08(0x125)],'subject':_0x1c7a08(0x160),'attachments':[{'filename':_0x1c7a08(0x176),'path':__dirname+'/../public'+'/upload/'+_0x42a653[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x1c7a08(0x165)+_0x1c7a08(0x127)+_0x1c7a08(0x21e)+_0x1c7a08(0x127)+_0x1c7a08(0x1e9)+_0x1c7a08(0x1b8)+'<div>'+_0x1c7a08(0x1f2)+_0x42a653[0x0][_0x1c7a08(0x223)]+_0x1c7a08(0x20e)+'</div>'+_0x1c7a08(0x1b8)+_0x1c7a08(0x1cc)+_0x1c7a08(0x127)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x1c7a08(0x216)+_0x552bc4+'\x20'+_0x1c7a08(0x155)+_0x1c7a08(0x15c)+_0x2d94dc+'\x20'+'</span>'+'</h5>'+'</div>'+_0x1c7a08(0x20b)+_0x1c7a08(0x1ff)+'<tr>'+_0x1c7a08(0x14a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x1c7a08(0x1d8)+_0x1c7a08(0x215)+_0x1c7a08(0x144)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1d8768+'\x20'+'</tbody>'+'</table>'+'<div>'+_0x1c7a08(0x1fe)+_0x1c7a08(0x1fc)+_0x42a653[0x0][_0x1c7a08(0x223)]+_0x1c7a08(0x1a4)+_0x1c7a08(0x1b8)+_0x1c7a08(0x1b8)+_0x1c7a08(0x19c)};_0x2418c7['sendMail'](_0x24833e,function(_0x21c6c0,_0x2319c9){var _0x716ffa=_0x1c7a08;_0x21c6c0?(console[_0x716ffa(0x1af)](_0x21c6c0),console[_0x716ffa(0x1af)](_0x716ffa(0x1e7))):console[_0x716ffa(0x1af)](_0x716ffa(0x107));}),_0x7b9cee[_0x1c7a08(0x167)](_0x1c7a08(0x135),_0x1c7a08(0x191)),_0x1bb7c4[_0x1c7a08(0x12a)](_0x1c7a08(0x212));}catch(_0x10bec7){console[_0x1c7a08(0x1af)](_0x10bec7),_0x1bb7c4['status'](0xc8)[_0x1c7a08(0x1aa)]({'message1':_0x10bec7['message']});}}}),router[a0_0x3457ae(0x14e)](a0_0x3457ae(0x180),auth,async(_0x3d6298,_0x5a6105)=>{var _0x214bba=a0_0x3457ae;try{const {username:_0x509b6c,email:_0x4004cf,role:_0x4f8495}=_0x3d6298[_0x214bba(0x13c)],_0x5f1a0e=_0x3d6298[_0x214bba(0x13c)],_0xf948b9=await profile[_0x214bba(0x15f)]({'email':_0x5f1a0e['email']}),_0x3e8163=await master_shop['find']();console[_0x214bba(0x1af)](_0x214bba(0x1c0),_0x3e8163);const _0x14ee95=_0x3d6298['params']['id'],_0x275b13=await sales['findById'](_0x14ee95);console[_0x214bba(0x1af)](_0x214bba(0x157),_0x275b13);if(_0x3e8163[0x0][_0x214bba(0x1b4)]==_0x214bba(0x1e2))var _0x25e206=users[_0x214bba(0x18a)];else{if(_0x3e8163[0x0][_0x214bba(0x1b4)]==_0x214bba(0x11d))var _0x25e206=users[_0x214bba(0x11d)];else{if(_0x3e8163[0x0][_0x214bba(0x1b4)]==_0x214bba(0x189))var _0x25e206=users[_0x214bba(0x189)];else{if(_0x3e8163[0x0][_0x214bba(0x1b4)]==_0x214bba(0x105))var _0x25e206=users[_0x214bba(0x105)];else{if(_0x3e8163[0x0]['language']==_0x214bba(0x1d9))var _0x25e206=users['French'];else{if(_0x3e8163[0x0][_0x214bba(0x1b4)]=='Portuguese\x20(BR)')var _0x25e206=users[_0x214bba(0x108)];else{if(_0x3e8163[0x0]['language']==_0x214bba(0x209))var _0x25e206=users['Chinese'];else{if(_0x3e8163[0x0]['language']==_0x214bba(0x146))var _0x25e206=users[_0x214bba(0x1ec)];}}}}}}}_0x5a6105[_0x214bba(0x1cd)]('all_sales_barcode',{'success':_0x3d6298['flash'](_0x214bba(0x135)),'errors':_0x3d6298[_0x214bba(0x167)](_0x214bba(0x21c)),'role':_0x5f1a0e,'profile':_0xf948b9,'alldata':_0x275b13,'master_shop':_0x3e8163,'language':_0x25e206});}catch(_0x55faae){console['log'](_0x55faae);}}),router[a0_0x3457ae(0x1c8)]('/barcode_scanner',async(_0x219e28,_0x5ca081)=>{var _0x5117a5=a0_0x3457ae;const {product_code:_0x45a655,warehouse_name:_0x398700,rooms_data:_0x3a1917,Roomslist:_0x2520c9,sales_category:_0x1baea4}=_0x219e28[_0x5117a5(0x200)],_0x25c23c=_0x2520c9[_0x5117a5(0x1f1)](','),_0x5f18ee=[];async function _0x33bf83(_0x5be675){var _0x2dc16a=_0x5117a5;const _0x772080=await warehouse[_0x2dc16a(0x1be)]([{'$match':{'name':_0x398700,'room':_0x5be675}},{'$unwind':_0x2dc16a(0x219)},{'$match':{'product_details.primary_code':_0x45a655}},{'$group':{'_id':_0x2dc16a(0x20f),'name':{'$first':_0x2dc16a(0x134)},'product_stock':{'$first':_0x2dc16a(0x1b9)},'primary_code':{'$first':_0x2dc16a(0x178)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2dc16a(0x1b3)},'level':{'$first':_0x2dc16a(0x112)},'bay':{'$first':_0x2dc16a(0x19e)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2dc16a(0x168)},'unit':{'$first':_0x2dc16a(0x1c7)},'secondary_unit':{'$first':_0x2dc16a(0x1ea)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2dc16a(0x1d2)},'expiry_date':{'$first':_0x2dc16a(0x197)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2dc16a(0x188)},'product_cat':{'$first':_0x2dc16a(0x104)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x2dc16a(0x1c2)},'uuid':{'$first':_0x2dc16a(0x1cb)},'gross_price':{'$first':_0x2dc16a(0x12e)},'sales_category':{'$first':_0x2dc16a(0x1a7)}}}]),_0x1bd056=await warehouse[_0x2dc16a(0x1be)]([{'$match':{'name':_0x398700,'room':_0x5be675}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x45a655}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2dc16a(0x134)},'product_stock':{'$first':_0x2dc16a(0x1b9)},'primary_code':{'$first':_0x2dc16a(0x178)},'secondary_code':{'$first':_0x2dc16a(0x1fd)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x2dc16a(0x211)},'pallet':{'$first':_0x2dc16a(0x168)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2dc16a(0x1ea)},'storage':{'$first':_0x2dc16a(0x133)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2dc16a(0x197)},'production_date':{'$first':_0x2dc16a(0x17d)},'maxPerUnit':{'$first':_0x2dc16a(0x10c)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x2dc16a(0x104)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2dc16a(0x153)},'invoice':{'$first':_0x2dc16a(0x1c2)},'uuid':{'$first':_0x2dc16a(0x1cb)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x2dc16a(0x1a7)}}}]);if(_0x772080['length']>0x0)_0x5f18ee['push'](_0x772080);else _0x1bd056[_0x2dc16a(0x138)]>0x0&&_0x5f18ee[_0x2dc16a(0x21f)](_0x1bd056);}const _0x31b9be=_0x25c23c[_0x5117a5(0x1c6)](_0x347cfa=>_0x33bf83(_0x347cfa));await Promise[_0x5117a5(0x1fa)](_0x31b9be),_0x5ca081[_0x5117a5(0x1aa)](_0x5f18ee);}),router['post'](a0_0x3457ae(0x207),async(_0x55f590,_0x20984c)=>{var _0x12a746=a0_0x3457ae;const {product_code:_0x17dafa,warehouse_name:_0x8ef1c0,rooms_data:_0x36cd8a,Roomslist:_0x10fd4a,sales_category:_0x456a0f}=_0x55f590[_0x12a746(0x200)],_0x18c215=_0x10fd4a[_0x12a746(0x1f1)](','),_0x92b77=[];async function _0x1085e9(_0x37230d){var _0x14b899=_0x12a746;const _0x484392=await warehouse[_0x14b899(0x1be)]([{'$match':{'name':_0x8ef1c0,'room':_0x37230d}},{'$unwind':_0x14b899(0x219)},{'$match':{'product_details.primary_code':_0x17dafa,'product_details.sales_category':_0x456a0f,'product_details.type_products':_0x14b899(0x1af)}},{'$group':{'_id':_0x14b899(0x20f),'name':{'$first':_0x14b899(0x134)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x14b899(0x178)},'secondary_code':{'$first':_0x14b899(0x1fd)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.level'},'bay':{'$first':_0x14b899(0x19e)},'type':{'$first':_0x14b899(0x211)},'pallet':{'$first':_0x14b899(0x168)},'unit':{'$first':_0x14b899(0x1c7)},'secondary_unit':{'$first':_0x14b899(0x1ea)},'storage':{'$first':_0x14b899(0x133)},'rack':{'$first':_0x14b899(0x1d2)},'expiry_date':{'$first':_0x14b899(0x197)},'production_date':{'$first':_0x14b899(0x17d)},'maxPerUnit':{'$first':_0x14b899(0x10c)},'batch_code':{'$first':_0x14b899(0x188)},'product_cat':{'$first':_0x14b899(0x104)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x14b899(0x153)},'invoice':{'$first':_0x14b899(0x1c2)},'uuid':{'$first':_0x14b899(0x1cb)},'gross_price':{'$first':_0x14b899(0x12e)},'sales_category':{'$first':_0x14b899(0x1a7)},'type_products':{'$first':'$product_details.type_products'}}}]);console[_0x14b899(0x1af)](_0x14b899(0x1af)+_0x14b899(0x126)+_0x17dafa+'\x20<>\x20'+_0x456a0f);const _0x5b5511=await warehouse['aggregate']([{'$match':{'name':_0x8ef1c0,'room':_0x37230d}},{'$unwind':_0x14b899(0x219)},{'$match':{'product_details.secondary_code':_0x17dafa,'product_details.sales_category':_0x456a0f,'product_details.type_products':_0x14b899(0x1af)}},{'$group':{'_id':_0x14b899(0x20f),'name':{'$first':_0x14b899(0x134)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x14b899(0x178)},'secondary_code':{'$first':_0x14b899(0x1fd)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x14b899(0x211)},'pallet':{'$first':_0x14b899(0x168)},'unit':{'$first':_0x14b899(0x1c7)},'secondary_unit':{'$first':_0x14b899(0x1ea)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x14b899(0x1d2)},'expiry_date':{'$first':_0x14b899(0x197)},'production_date':{'$first':_0x14b899(0x17d)},'maxPerUnit':{'$first':_0x14b899(0x10c)},'batch_code':{'$first':_0x14b899(0x188)},'product_cat':{'$first':_0x14b899(0x104)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x14b899(0x153)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x14b899(0x1cb)},'gross_price':{'$first':_0x14b899(0x12e)},'sales_category':{'$first':_0x14b899(0x1a7)},'type_products':{'$first':_0x14b899(0x17f)}}}]);if(_0x484392[_0x14b899(0x138)]>0x0)_0x92b77[_0x14b899(0x21f)](_0x484392);else _0x5b5511[_0x14b899(0x138)]>0x0&&_0x92b77[_0x14b899(0x21f)](_0x5b5511);}const _0x2df836=_0x18c215[_0x12a746(0x1c6)](_0x152309=>_0x1085e9(_0x152309));await Promise[_0x12a746(0x1fa)](_0x2df836),_0x20984c['json'](_0x92b77);}),module[a0_0x3457ae(0x1ac)]=router;