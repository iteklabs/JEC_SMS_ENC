var a0_0x5c4fd5=a0_0x49a2;function a0_0x5a16(){var _0x300800=['$product_details.storage','back','get','logo','Enclosed','<h5\x20style=\x22text-align:\x20left;\x22>','<hr\x20class=\x22my-3\x22>','room','expiry_date','all_sales_barcode','abs','sale_qty','/view_log','Arabic\x20(ae)','redirect','$product','/all_sales_finished/preview/','$product_details.maxProducts','primary_unit','product_date','final','sale_product','user','$date','$product_details.production_date','maxProducts_QA','flash','$product_details.rack','getDate','body','errors','</h5>','unit','findOne','received_amount','createTransport','<h5>','$product_details._id','Hindi','room_name','currency','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','add\x20post','catch','max_per_unit','66cZzwSA','$product_details.expiry_date','production_date','match','Enabled','all_sales_finished','secondary_code','$product_details.product_stock','product_name_QA1','<h2>\x20','note','express','$product_details.level','success','OUT-','return_data','$product_details.bin','add_sales_finished_logs','expiry_date_QA','$customers_docs','currency_placement','False','/upload/','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','int','toString','/preview/:id','/picking_list/pdf/','sales','<span\x20style=\x22float:\x20right;\x22>','return_sale','getMonth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','quantity','site_title','$sale_product.floorlevel','due_amount','$warehouse_name','Sales\x20Add\x20successfully','/barcode_scanner_logs','customer','English','staff','$product_details.type_products','True','batch_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','customer_data','params','/all_sales_finished/view','$product_details.room_name','<strong>\x20Regards\x20</strong>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$product_details.primary_code','id_transaction_from','render','edit_sales_finished','$invoice','findById','</table>','LOG-OUT-','carton','warehouse_id','Arabic','for_categorize','outgoing_invoice','valueOf','return_qty','here','\x20</h2>','$room','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','add_sales_finished','edit_sales_finished_view','product','product_list','$sale_product.bin','/view/add_sales_logs','concat','/view/add_sales','12362KVtKCe','log','$product_details.product_code','_id','/barcode_scanner','aggregate','Sale\x20Return','product_code','maxProducts','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','length','</thead>','OUTF-','445568qphNnp','Received\x20Payment\x20For\x20Sale','<tr>','$name','purchases_data','$product_details.uuid','\x20&&\x20','post','<div>','gmail','invoice_init','$sale_product.type','level','suppliers','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','map','2637648KbCHxu','random','find','master','all','language','</tr>','unit_QA','<html><head><title></title>','agent_id','foreach\x20newproduct','bay','Router','uuid','$customer','Email\x20sent\x20successfully','/view','warehouse','invoice','$product_details.product_name','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','payment\x20successfull','product_code_QA','date_data','padStart','$product_details.secondary_code','\x20==\x20','product_stock','962874YgfGHR','$product_details.product_cat','/invoice/:id','warehouse_name','own','../public/language/languages.json','$product_details.unit','/../public','$note','date','secondary_unit','return_sale_finished','$product_details.floorlevel','Finished\x20Goods','undefined','$product_details.bay','status','floor','secondary_unit_QA','$product_details.secondary_unit','German','secondary_code_QA','prod_cat','Sales\x20Update\x20successfully','sales_quantity','sales_invoice','</tbody>','stock','sales\x20item\x20return\x20successfull','English\x20(US)','/view/add_sale/product','$product_details','role','string','$product_details.gross_price','Return\x20Rooms','push','$product_details.batch_code','RoomAssigned','$_id','\x20<>\x20','barcode\x20user_id','adjust_qty','../middleware/auth','</td>','filter','updateOne','223757HboYqJ','slice','$product_details.invoice','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','stocks_QA','$product_details.type','production_date_QA','$sale_product','image','Error\x20Occurs','Portuguese','maxperunit','level2','amount','Ambient','<!DOCTYPE\x20html>','\x20Order\x20Number\x20:\x20','sendMail','Spanish','/give_payment/:id','5hpSIEw','message','$sale_product.bay','json','/all_sales/view','batch_code_QA','<tbody\x20style=\x22text-align:\x20center;\x22>','gross_price','product_name','sales_quantity_QA','$product_details.maxPerUnit','\x20Order\x20Date\x20:\x20','/view/add_sales/:id','/view/:id','Quality\x20Inspection','primary_code','</div>','French','forEach','exports','prod_code','maxPerUnit_QA','Portuguese\x20(BR)','$sale_product.quantity','save','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$finalize','7507242vtryNY','email','password','maxPerUnit','$return_data','Sale\x20Return\x20Mail','logs','$product_details.sales_category','14284agFzNe','</body></html>','Chinese','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','../models/all_models','prod_invoice','split'];a0_0x5a16=function(){return _0x300800;};return a0_0x5a16();}function a0_0x49a2(_0x158413,_0x38ec07){var _0x5a160e=a0_0x5a16();return a0_0x49a2=function(_0x49a2d7,_0x1ad08c){_0x49a2d7=_0x49a2d7-0x1cc;var _0x4182bf=_0x5a160e[_0x49a2d7];return _0x4182bf;},a0_0x49a2(_0x158413,_0x38ec07);}(function(_0x1d8314,_0x1662e2){var _0x4a475b=a0_0x49a2,_0x70fcb2=_0x1d8314();while(!![]){try{var _0x42fb51=parseInt(_0x4a475b(0x218))/0x1+-parseInt(_0x4a475b(0x2e1))/0x2+-parseInt(_0x4a475b(0x1e9))/0x3+-parseInt(_0x4a475b(0x250))/0x4*(-parseInt(_0x4a475b(0x22d))/0x5)+-parseInt(_0x4a475b(0x284))/0x6*(-parseInt(_0x4a475b(0x2d4))/0x7)+-parseInt(_0x4a475b(0x1cd))/0x8+parseInt(_0x4a475b(0x248))/0x9;if(_0x42fb51===_0x1662e2)break;else _0x70fcb2['push'](_0x70fcb2['shift']());}catch(_0x421d98){_0x70fcb2['push'](_0x70fcb2['shift']());}}}(a0_0x5a16,0x32a54));const express=require(a0_0x5c4fd5(0x28f)),app=express(),router=express[a0_0x5c4fd5(0x1d9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x5c4fd5(0x254)),auth=require(a0_0x5c4fd5(0x214)),nodemailer=require('nodemailer'),users=require(a0_0x5c4fd5(0x1ee));router[a0_0x5c4fd5(0x259)](a0_0x5c4fd5(0x1dd),auth,async(_0x238176,_0x3aef56)=>{var _0x2bfc39=a0_0x5c4fd5;try{const {username:_0xa6cb51,email:_0x558797,role:_0x574684}=_0x238176[_0x2bfc39(0x26d)],_0x2310a3=_0x238176['user'],_0x54ade5=await profile[_0x2bfc39(0x278)]({'email':_0x2310a3[_0x2bfc39(0x249)]}),_0x14fede=await master_shop[_0x2bfc39(0x1cf)]();let _0xb1a810;if(_0x2310a3[_0x2bfc39(0x209)]==_0x2bfc39(0x2ae)){const _0xe2f3c3=await staff[_0x2bfc39(0x278)]({'email':_0x2310a3[_0x2bfc39(0x249)]});_0xb1a810=await sales_finished[_0x2bfc39(0x2d9)]([{'$match':{'typeOfProducts':_0x2bfc39(0x1ed)}},{'$unwind':_0x2bfc39(0x220)},{'$group':{'_id':_0x2bfc39(0x210),'invoice':{'$first':_0x2bfc39(0x2bd)},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x2bfc39(0x220)},'note':{'$first':_0x2bfc39(0x1f1)},'return_data':{'$first':_0x2bfc39(0x24c)},'customers_docs':{'$first':_0x2bfc39(0x297)},'total_saleproduct_quantity':{'$sum':_0x2bfc39(0x244)},'level':{'$addToSet':_0x2bfc39(0x22f)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x2bfc39(0x2ec)},'pallet':{'$addToSet':_0x2bfc39(0x2a7)},'finalize':{'$first':_0x2bfc39(0x247)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0xb1a810=await sales_finished['aggregate']([{'$match':{'typeOfProducts':'own'}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x2bfc39(0x210),'invoice':{'$first':_0x2bfc39(0x2bd)},'customers':{'$first':_0x2bfc39(0x1db)},'date':{'$first':_0x2bfc39(0x26e)},'warehouse_name':{'$first':_0x2bfc39(0x2a9)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x2bfc39(0x1f1)},'return_data':{'$first':_0x2bfc39(0x24c)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x2bfc39(0x22f)},'isle':{'$addToSet':_0x2bfc39(0x2d0)},'type':{'$addToSet':_0x2bfc39(0x2ec)},'pallet':{'$addToSet':_0x2bfc39(0x2a7)},'finalize':{'$first':_0x2bfc39(0x247)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x14fede[0x0][_0x2bfc39(0x1d2)]==_0x2bfc39(0x206)){var _0x56e8fd=users['English'];console[_0x2bfc39(0x2d5)](_0x56e8fd);}else{if(_0x14fede[0x0][_0x2bfc39(0x1d2)]==_0x2bfc39(0x27d))var _0x56e8fd=users[_0x2bfc39(0x27d)];else{if(_0x14fede[0x0][_0x2bfc39(0x1d2)]==_0x2bfc39(0x1fd))var _0x56e8fd=users[_0x2bfc39(0x1fd)];else{if(_0x14fede[0x0]['language']==_0x2bfc39(0x22b))var _0x56e8fd=users[_0x2bfc39(0x22b)];else{if(_0x14fede[0x0][_0x2bfc39(0x1d2)]==_0x2bfc39(0x23e))var _0x56e8fd=users[_0x2bfc39(0x23e)];else{if(_0x14fede[0x0][_0x2bfc39(0x1d2)]==_0x2bfc39(0x243))var _0x56e8fd=users[_0x2bfc39(0x223)];else{if(_0x14fede[0x0][_0x2bfc39(0x1d2)]==_0x2bfc39(0x252))var _0x56e8fd=users['Chinese'];else{if(_0x14fede[0x0]['language']==_0x2bfc39(0x264))var _0x56e8fd=users[_0x2bfc39(0x2c3)];}}}}}}}_0x3aef56['render'](_0x2bfc39(0x289),{'success':_0x238176['flash'](_0x2bfc39(0x291)),'errors':_0x238176[_0x2bfc39(0x271)](_0x2bfc39(0x275)),'sales':_0xb1a810,'profile':_0x54ade5,'role':_0x2310a3,'master_shop':_0x14fede,'language':_0x56e8fd});}catch(_0x100ca8){console[_0x2bfc39(0x2d5)](_0x100ca8);}}),router['get'](a0_0x5c4fd5(0x263),auth,async(_0x237e23,_0x26eee0)=>{var _0x1eb5d8=a0_0x5c4fd5;try{const {username:_0x5dd900,email:_0x2d37a5,role:_0x5b5d6d}=_0x237e23[_0x1eb5d8(0x26d)],_0x1a6323=_0x237e23[_0x1eb5d8(0x26d)],_0x33aac9=await profile['findOne']({'email':_0x1a6323[_0x1eb5d8(0x249)]}),_0x47b66c=await master_shop[_0x1eb5d8(0x1cf)]();let _0x3836c1;if(_0x1a6323[_0x1eb5d8(0x209)]==_0x1eb5d8(0x2ae)){const _0x306364=await staff[_0x1eb5d8(0x278)]({'email':_0x1a6323[_0x1eb5d8(0x249)]});_0x3836c1=await sales_finished[_0x1eb5d8(0x2d9)]([{'$match':{'typeOfProducts':_0x1eb5d8(0x24e)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x1eb5d8(0x210),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x1eb5d8(0x1db)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x1eb5d8(0x220)},'note':{'$first':_0x1eb5d8(0x1f1)},'return_data':{'$first':_0x1eb5d8(0x24c)},'customers_docs':{'$first':_0x1eb5d8(0x297)},'total_saleproduct_quantity':{'$sum':_0x1eb5d8(0x244)},'level':{'$addToSet':_0x1eb5d8(0x22f)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x1eb5d8(0x2ec)},'pallet':{'$addToSet':_0x1eb5d8(0x2a7)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x3836c1=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x1eb5d8(0x24e)}},{'$unwind':_0x1eb5d8(0x220)},{'$group':{'_id':_0x1eb5d8(0x210),'invoice':{'$first':_0x1eb5d8(0x2bd)},'customers':{'$first':_0x1eb5d8(0x1db)},'date':{'$first':_0x1eb5d8(0x26e)},'warehouse_name':{'$first':_0x1eb5d8(0x2a9)},'sale_product':{'$push':_0x1eb5d8(0x220)},'note':{'$first':'$note'},'return_data':{'$first':_0x1eb5d8(0x24c)},'customers_docs':{'$first':_0x1eb5d8(0x297)},'total_saleproduct_quantity':{'$sum':_0x1eb5d8(0x244)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x1eb5d8(0x2ec)},'pallet':{'$addToSet':_0x1eb5d8(0x2a7)},'finalize':{'$first':_0x1eb5d8(0x247)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x47b66c[0x0]['language']=='English\x20(US)'){var _0x1e2e7c=users[_0x1eb5d8(0x2ad)];console['log'](_0x1e2e7c);}else{if(_0x47b66c[0x0][_0x1eb5d8(0x1d2)]==_0x1eb5d8(0x27d))var _0x1e2e7c=users['Hindi'];else{if(_0x47b66c[0x0]['language']==_0x1eb5d8(0x1fd))var _0x1e2e7c=users[_0x1eb5d8(0x1fd)];else{if(_0x47b66c[0x0][_0x1eb5d8(0x1d2)]==_0x1eb5d8(0x22b))var _0x1e2e7c=users[_0x1eb5d8(0x22b)];else{if(_0x47b66c[0x0][_0x1eb5d8(0x1d2)]==_0x1eb5d8(0x23e))var _0x1e2e7c=users[_0x1eb5d8(0x23e)];else{if(_0x47b66c[0x0][_0x1eb5d8(0x1d2)]=='Portuguese\x20(BR)')var _0x1e2e7c=users[_0x1eb5d8(0x223)];else{if(_0x47b66c[0x0][_0x1eb5d8(0x1d2)]=='Chinese')var _0x1e2e7c=users[_0x1eb5d8(0x252)];else{if(_0x47b66c[0x0][_0x1eb5d8(0x1d2)]==_0x1eb5d8(0x264))var _0x1e2e7c=users[_0x1eb5d8(0x2c3)];}}}}}}}_0x26eee0[_0x1eb5d8(0x2bb)]('all_sales_finished_logs',{'success':_0x237e23[_0x1eb5d8(0x271)](_0x1eb5d8(0x291)),'errors':_0x237e23['flash'](_0x1eb5d8(0x275)),'sales':_0x3836c1,'profile':_0x33aac9,'role':_0x1a6323,'master_shop':_0x47b66c,'language':_0x1e2e7c});}catch(_0x56492b){console[_0x1eb5d8(0x2d5)](_0x56492b);}});async function getRandom8DigitNumber(){var _0x4974fc=a0_0x5c4fd5;const _0x579237=0x989680,_0x329e35=0x5f5e0ff,_0x1e9aed=Math[_0x4974fc(0x1fa)](Math[_0x4974fc(0x1ce)]()*(_0x329e35-_0x579237+0x1))+_0x579237;var _0x5b7111;const _0x2a07fa=await sales_finished[_0x4974fc(0x278)]({'invoice':_0x4974fc(0x2e0)+_0x1e9aed});return _0x2a07fa&&_0x2a07fa[_0x4974fc(0x2de)]>0x0?_0x5b7111=_0x4974fc(0x2e0)+_0x1e9aed:_0x5b7111=_0x4974fc(0x2e0)+_0x1e9aed,_0x5b7111;}router[a0_0x5c4fd5(0x259)](a0_0x5c4fd5(0x2d3),auth,async(_0x417be8,_0x17b03d)=>{var _0x52e7c6=a0_0x5c4fd5;try{const {username:_0x17f8b7,email:_0x9d9e22,role:_0x4d9e2}=_0x417be8[_0x52e7c6(0x26d)],_0x4118db=_0x417be8[_0x52e7c6(0x26d)],_0x4ee96a=await profile[_0x52e7c6(0x278)]({'email':_0x4118db[_0x52e7c6(0x249)]}),_0x2ef72c=await master_shop['find'](),_0x768b6=await customer['find']({});let _0x26de85;if(_0x4118db[_0x52e7c6(0x209)]==_0x52e7c6(0x2ae)){const _0x231c90=await staff[_0x52e7c6(0x278)]({'email':_0x4118db['email']});_0x26de85=await warehouse[_0x52e7c6(0x2d9)]([{'$match':{'status':_0x52e7c6(0x288),'name':_0x231c90[_0x52e7c6(0x1de)]}},{'$group':{'_id':'$name','name':{'$first':_0x52e7c6(0x2e4)}}},{'$sort':{'name':0x1}}]);}else _0x26de85=await warehouse[_0x52e7c6(0x2d9)]([{'$match':{'status':_0x52e7c6(0x288)}},{'$group':{'_id':_0x52e7c6(0x2e4),'name':{'$first':_0x52e7c6(0x2e4)}}},{'$sort':{'name':0x1}}]);const _0x2ea410=await product['find']({});var _0x2a6a5c=[_0x52e7c6(0x227),_0x52e7c6(0x25b)];const _0x5cb124=await sales_finished['find']({}),_0x58ab65=_0x5cb124[_0x52e7c6(0x2de)]+0x1,_0x8a906d='OUTF-'+_0x58ab65[_0x52e7c6(0x29d)]()[_0x52e7c6(0x1e5)](0x5,'0');if(_0x2ef72c[0x0][_0x52e7c6(0x1d2)]==_0x52e7c6(0x206)){var _0x21a425=users['English'];console[_0x52e7c6(0x2d5)](_0x21a425);}else{if(_0x2ef72c[0x0][_0x52e7c6(0x1d2)]=='Hindi')var _0x21a425=users[_0x52e7c6(0x27d)];else{if(_0x2ef72c[0x0]['language']==_0x52e7c6(0x1fd))var _0x21a425=users[_0x52e7c6(0x1fd)];else{if(_0x2ef72c[0x0][_0x52e7c6(0x1d2)]==_0x52e7c6(0x22b))var _0x21a425=users[_0x52e7c6(0x22b)];else{if(_0x2ef72c[0x0][_0x52e7c6(0x1d2)]=='French')var _0x21a425=users[_0x52e7c6(0x23e)];else{if(_0x2ef72c[0x0][_0x52e7c6(0x1d2)]==_0x52e7c6(0x243))var _0x21a425=users[_0x52e7c6(0x223)];else{if(_0x2ef72c[0x0]['language']==_0x52e7c6(0x252))var _0x21a425=users['Chinese'];else{if(_0x2ef72c[0x0][_0x52e7c6(0x1d2)]==_0x52e7c6(0x264))var _0x21a425=users[_0x52e7c6(0x2c3)];}}}}}}}const _0x26499d=getRandom8DigitNumber();_0x26499d['then'](_0x272971=>{var _0x25227c=_0x52e7c6;_0x17b03d[_0x25227c(0x2bb)](_0x25227c(0x2cc),{'success':_0x417be8['flash'](_0x25227c(0x291)),'errors':_0x417be8[_0x25227c(0x271)](_0x25227c(0x275)),'role':_0x4118db,'profile':_0x4ee96a,'customer':_0x768b6,'warehouse':_0x26de85,'product':_0x2ea410,'invoice':_0x272971,'master_shop':_0x2ef72c,'language':_0x21a425,'rooms_data':_0x2a6a5c});})[_0x52e7c6(0x282)](_0x339a4f=>{var _0x41f222=_0x52e7c6;_0x417be8['flash'](_0x41f222(0x275),_0x41f222(0x2b2)),_0x17b03d[_0x41f222(0x265)]('/all_sales_finished/view');});}catch(_0x42de22){console[_0x52e7c6(0x2d5)](_0x42de22);}}),router['get']('/view/add_sales_logs',auth,async(_0x3de70,_0x5e5065)=>{var _0x3173c9=a0_0x5c4fd5;try{const {username:_0x183aad,email:_0x500847,role:_0x3dea31}=_0x3de70['user'],_0x354583=_0x3de70[_0x3173c9(0x26d)],_0x51e918=await profile[_0x3173c9(0x278)]({'email':_0x354583[_0x3173c9(0x249)]}),_0x538657=await master_shop[_0x3173c9(0x1cf)](),_0x56ef4c=await customer[_0x3173c9(0x1cf)]({});let _0x2488ac;if(_0x354583[_0x3173c9(0x209)]==_0x3173c9(0x2ae)){const _0x40ded5=await staff[_0x3173c9(0x278)]({'email':_0x354583[_0x3173c9(0x249)]});_0x2488ac=await warehouse['aggregate']([{'$match':{'status':_0x3173c9(0x288),'name':_0x40ded5[_0x3173c9(0x1de)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x2488ac=await warehouse[_0x3173c9(0x2d9)]([{'$match':{'status':_0x3173c9(0x288)}},{'$group':{'_id':_0x3173c9(0x2e4),'name':{'$first':_0x3173c9(0x2e4)}}},{'$sort':{'name':0x1}}]);const _0x240cbc=await product[_0x3173c9(0x1cf)]({});var _0x4cc1dd=[_0x3173c9(0x227),_0x3173c9(0x25b)];const _0x5a4871=await sales_finished[_0x3173c9(0x1cf)]({}),_0x2c88f6=_0x5a4871[_0x3173c9(0x2de)]+0x1,_0x36cf61='OUTF-'+_0x2c88f6[_0x3173c9(0x29d)]()[_0x3173c9(0x1e5)](0x5,'0');if(_0x538657[0x0][_0x3173c9(0x1d2)]==_0x3173c9(0x206)){var _0x4f7858=users['English'];console[_0x3173c9(0x2d5)](_0x4f7858);}else{if(_0x538657[0x0][_0x3173c9(0x1d2)]==_0x3173c9(0x27d))var _0x4f7858=users[_0x3173c9(0x27d)];else{if(_0x538657[0x0][_0x3173c9(0x1d2)]==_0x3173c9(0x1fd))var _0x4f7858=users[_0x3173c9(0x1fd)];else{if(_0x538657[0x0][_0x3173c9(0x1d2)]==_0x3173c9(0x22b))var _0x4f7858=users[_0x3173c9(0x22b)];else{if(_0x538657[0x0]['language']==_0x3173c9(0x23e))var _0x4f7858=users[_0x3173c9(0x23e)];else{if(_0x538657[0x0][_0x3173c9(0x1d2)]==_0x3173c9(0x243))var _0x4f7858=users[_0x3173c9(0x223)];else{if(_0x538657[0x0]['language']==_0x3173c9(0x252))var _0x4f7858=users[_0x3173c9(0x252)];else{if(_0x538657[0x0]['language']=='Arabic\x20(ae)')var _0x4f7858=users['Arabic'];}}}}}}}const _0x5e743c=getRandom8DigitNumber();_0x5e743c['then'](_0x5207bc=>{var _0x571c68=_0x3173c9;_0x5e5065[_0x571c68(0x2bb)](_0x571c68(0x295),{'success':_0x3de70[_0x571c68(0x271)](_0x571c68(0x291)),'errors':_0x3de70[_0x571c68(0x271)](_0x571c68(0x275)),'role':_0x354583,'profile':_0x51e918,'customer':_0x56ef4c,'warehouse':_0x2488ac,'product':_0x240cbc,'invoice':_0x5207bc,'master_shop':_0x538657,'language':_0x4f7858,'rooms_data':_0x4cc1dd});})[_0x3173c9(0x282)](_0x3c3f6c=>{var _0x46cb44=_0x3173c9;_0x3de70['flash']('errors',_0x46cb44(0x2b2)),_0x5e5065[_0x46cb44(0x265)](_0x46cb44(0x2b5));});}catch(_0x3e7117){console[_0x3173c9(0x2d5)](_0x3e7117);}}),router[a0_0x5c4fd5(0x2e8)](a0_0x5c4fd5(0x2d1),auth,async(_0x7e5296,_0x27aed1)=>{var _0x3e9475=a0_0x5c4fd5;try{const {invoice:_0xb1fffd,date:_0x3b3ee6,warehouse_name:_0x22a928,product_name:_0x5ca3b8,note:_0x14e8de,room:_0xa472a4,primary_code:_0x2c2467,secondary_code:_0x30c6ac,prod_code:_0x49479b,SCRN:_0x40a8ed,ReqBy:_0x48f712,dateofreq:_0x555c83,PO_number:_0xffdfc9,typeservicesData:_0x2c88f4,typevehicle:_0x32b4ed,destination:_0x5b2987,deliverydate:_0x2c1eac,driver:_0x1b6336,plate:_0x19399f,van:_0x141aab,DRSI:_0x5d02b0,TSU:_0x460232,TFU:_0x509d78,mode_transpo:_0x21d2de,name_driver:_0x555586,type_of_products:_0x2bdbd0}=_0x7e5296[_0x3e9475(0x274)];if(typeof _0x5ca3b8==_0x3e9475(0x20a))var _0x2812dd=[_0x7e5296['body']['product_name']],_0x115ecd=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x204)]],_0x29b53f=[_0x7e5296[_0x3e9475(0x274)]['carton']],_0x4c86b2=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x23c)]],_0x87f158=[_0x7e5296['body'][_0x3e9475(0x28a)]],_0x39cb12=[_0x7e5296['body']['prod_code']],_0x374649=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x225)]],_0x74e81c=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x269)]],_0x350533=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x1f3)]],_0x2137a7=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x2b1)]],_0x2a5826=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x25f)]],_0x1f7500=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x26a)]],_0x392147=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x283)]],_0x5ba8c7=[_0x7e5296[_0x3e9475(0x274)]['prod_cat']],_0x30208e=[_0x7e5296['body']['RoomAssigned']],_0x4389ff=[_0x7e5296[_0x3e9475(0x274)]['prod_invoice']],_0x55f991=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x2ba)]],_0x4bb1bd=[_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x1da)]],_0x278abd=[_0x7e5296['body'][_0x3e9475(0x234)]];else var _0x2812dd=[..._0x7e5296['body'][_0x3e9475(0x235)]],_0x115ecd=[..._0x7e5296['body'][_0x3e9475(0x204)]],_0x29b53f=[..._0x7e5296[_0x3e9475(0x274)]['carton']],_0x4c86b2=[..._0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x23c)]],_0x87f158=[..._0x7e5296['body'][_0x3e9475(0x28a)]],_0x39cb12=[..._0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x241)]],_0x374649=[..._0x7e5296[_0x3e9475(0x274)]['level2']],_0x74e81c=[..._0x7e5296['body'][_0x3e9475(0x269)]],_0x350533=[..._0x7e5296['body']['secondary_unit']],_0x2137a7=[..._0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x2b1)]],_0x2a5826=[..._0x7e5296['body'][_0x3e9475(0x25f)]],_0x1f7500=[..._0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x26a)]],_0x392147=[..._0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x283)]],_0x5ba8c7=[..._0x7e5296['body']['prod_cat']],_0x30208e=[..._0x7e5296['body'][_0x3e9475(0x20f)]],_0x4389ff=[..._0x7e5296['body'][_0x3e9475(0x255)]],_0x55f991=[..._0x7e5296['body'][_0x3e9475(0x2ba)]],_0x4bb1bd=[..._0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x1da)]],_0x278abd=[..._0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x234)]];const _0x49eb50=_0x2812dd[_0x3e9475(0x1cc)](_0x27d3bb=>{return _0x27d3bb={'product_name':_0x27d3bb};});_0x115ecd[_0x3e9475(0x23f)]((_0x5c0ea8,_0x1b123a)=>{var _0x12a035=_0x3e9475;_0x49eb50[_0x1b123a][_0x12a035(0x204)]=_0x5c0ea8;}),_0x29b53f[_0x3e9475(0x23f)]((_0x151dd5,_0x4d6718)=>{var _0x3e563b=_0x3e9475;_0x49eb50[_0x4d6718]['quantity']=Math[_0x3e563b(0x261)](_0x151dd5);}),_0x2812dd['forEach']((_0x4e9d5d,_0x415641)=>{var _0x3ce9c0=_0x3e9475;_0x49eb50[_0x415641][_0x3ce9c0(0x1d6)]=_0x7e5296[_0x3ce9c0(0x274)][_0x3ce9c0(0x2a0)];}),_0x278abd[_0x3e9475(0x23f)]((_0x19ed18,_0x14726a)=>{_0x49eb50[_0x14726a]['gross_price']=_0x19ed18;}),_0x4bb1bd[_0x3e9475(0x23f)]((_0x5bdceb,_0x6b558a)=>{var _0x4c4145=_0x3e9475;_0x49eb50[_0x6b558a][_0x4c4145(0x1da)]=_0x5bdceb;}),_0x55f991[_0x3e9475(0x23f)]((_0x21c6a9,_0x53045e)=>{var _0x14e83b=_0x3e9475;_0x49eb50[_0x53045e][_0x14e83b(0x2ba)]=_0x21c6a9;}),_0x4c86b2[_0x3e9475(0x23f)]((_0xc10ceb,_0xfeae6e)=>{var _0xa5381f=_0x3e9475;_0x49eb50[_0xfeae6e][_0xa5381f(0x23c)]=_0xc10ceb;}),_0x87f158[_0x3e9475(0x23f)]((_0x19a0f5,_0x19485b)=>{var _0x1f9904=_0x3e9475;_0x49eb50[_0x19485b][_0x1f9904(0x28a)]=_0x19a0f5;}),_0x39cb12[_0x3e9475(0x23f)]((_0x29ec2b,_0x32e1ca)=>{var _0x5f0525=_0x3e9475;_0x49eb50[_0x32e1ca][_0x5f0525(0x2db)]=_0x29ec2b;}),_0x374649[_0x3e9475(0x23f)]((_0x19d836,_0x4faf53)=>{var _0x1563fb=_0x3e9475,_0x5566b0=_0x19d836[_0x1563fb(0x287)](/[A-Za-z]+/)[0x0],_0x55497d=parseInt(_0x19d836[_0x1563fb(0x287)](/\d+/)[0x0]);_0x49eb50[_0x4faf53][_0x1563fb(0x1d8)]=_0x55497d,_0x49eb50[_0x4faf53]['level']=_0x5566b0;}),_0x74e81c[_0x3e9475(0x23f)]((_0x2772cd,_0x388be2)=>{var _0x4aceac=_0x3e9475;_0x49eb50[_0x388be2][_0x4aceac(0x277)]=_0x2772cd;}),_0x350533[_0x3e9475(0x23f)]((_0x4c5582,_0x4fab58)=>{_0x49eb50[_0x4fab58]['secondary_unit']=_0x4c5582;}),_0x2137a7[_0x3e9475(0x23f)]((_0x3bbc9a,_0x31480b)=>{_0x49eb50[_0x31480b]['batch_code']=_0x3bbc9a;}),_0x2a5826['forEach']((_0xf59ec1,_0x22abf9)=>{var _0x1a190d=_0x3e9475;_0x49eb50[_0x22abf9][_0x1a190d(0x25f)]=_0xf59ec1;}),_0x1f7500[_0x3e9475(0x23f)]((_0x359ef0,_0x2efd9d)=>{var _0x11e416=_0x3e9475;_0x49eb50[_0x2efd9d][_0x11e416(0x286)]=_0x359ef0;}),_0x392147[_0x3e9475(0x23f)]((_0x204ca1,_0x38f83b)=>{var _0x2e3bf4=_0x3e9475;_0x49eb50[_0x38f83b][_0x2e3bf4(0x224)]=_0x204ca1;}),_0x5ba8c7[_0x3e9475(0x23f)]((_0x92b443,_0x2828b4)=>{var _0x4ade8b=_0x3e9475;_0x49eb50[_0x2828b4][_0x4ade8b(0x1ff)]=_0x92b443;}),_0x30208e[_0x3e9475(0x23f)]((_0x242681,_0xe9b8d2)=>{_0x49eb50[_0xe9b8d2]['room_name']=_0x242681;}),_0x4389ff[_0x3e9475(0x23f)]((_0x16e2c1,_0x11f082)=>{var _0x563962=_0x3e9475;_0x49eb50[_0x11f082][_0x563962(0x1df)]=_0x16e2c1,_0x49eb50[_0x11f082][_0x563962(0x1e4)]=_0x3b3ee6;});const _0x4251c3=new sales_logs();await _0x4251c3[_0x3e9475(0x245)](),_0x4389ff[_0x3e9475(0x23f)]((_0x4dd289,_0x1bd71c)=>{var _0x131e16=_0x3e9475;_0x49eb50[_0x1bd71c][_0x131e16(0x2c5)]='LOG-OUT-'+_0x4251c3[_0x131e16(0x2eb)][_0x131e16(0x29d)]()[_0x131e16(0x1e5)](0x8,'0');});var _0x2ebb5a=0x0;_0x49eb50['forEach'](_0x590d4c=>{var _0x202fd3=_0x3e9475;parseFloat(_0x590d4c[_0x202fd3(0x204)])<parseFloat(_0x590d4c['quantity'])&&parseFloat(_0x590d4c[_0x202fd3(0x2a5)])>parseFloat(_0x590d4c[_0x202fd3(0x204)])&&(console['log'](_0x590d4c[_0x202fd3(0x204)]+'\x20<>\x20'+_0x590d4c[_0x202fd3(0x2a5)]),_0x2ebb5a++);});if(_0x2ebb5a!=0x0)return _0x7e5296['flash']('errors',_0x3e9475(0x253)),_0x27aed1[_0x3e9475(0x265)](_0x3e9475(0x258));const _0x56982=_0x49eb50[_0x3e9475(0x216)](_0x41b2d7=>_0x41b2d7[_0x3e9475(0x2a5)]!=='0'&&_0x41b2d7['quantity']!==''),_0x33a5ad=new sales_finished({'invoice':_0x3e9475(0x2c0)+_0x4251c3[_0x3e9475(0x2eb)][_0x3e9475(0x29d)]()[_0x3e9475(0x1e5)](0x8,'0'),'sales_data':_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x2a0)],'customer':_0x7e5296[_0x3e9475(0x274)][_0x3e9475(0x2ac)],'date':_0x3b3ee6,'warehouse_name':_0x22a928,'sale_product':_0x56982,'note':_0x14e8de,'room':_0xa472a4,'primary_code':_0x2c2467,'secondary_code':_0x30c6ac,'prod_code':_0x49479b,'SCRN':_0x40a8ed,'finalize':_0x3e9475(0x299),'mode_transpo':_0x21d2de,'name_driver':_0x555586,'ReqBy':_0x48f712,'dateofreq':_0x555c83,'PO_number':_0xffdfc9,'typeservicesData':_0x2c88f4,'typevehicle':_0x32b4ed,'destination':_0x5b2987,'deliverydate':_0x2c1eac,'driver':_0x1b6336,'plate':_0x19399f,'van':_0x141aab,'DRSI':_0x5d02b0,'TSU':_0x460232,'TFU':_0x509d78,'typeOfProducts':_0x2bdbd0}),_0x47d818=await _0x33a5ad['save'](),_0x3bbb91=await sales_finished[_0x3e9475(0x278)]({'invoice':_0xb1fffd});_0x7e5296[_0x3e9475(0x271)](_0x3e9475(0x291),'Sales\x20Add\x20successfully'),_0x27aed1[_0x3e9475(0x265)](_0x3e9475(0x267)+_0x47d818[_0x3e9475(0x2d7)]);}catch(_0x120f16){console[_0x3e9475(0x2d5)](_0x120f16);}}),router[a0_0x5c4fd5(0x259)](a0_0x5c4fd5(0x239),auth,async(_0x2edabf,_0x1980d0)=>{var _0x7823b8=a0_0x5c4fd5;try{const _0x1ab7d7=_0x2edabf[_0x7823b8(0x2b4)]['id'];console['log'](_0x1ab7d7);const _0x5ba211=await product[_0x7823b8(0x1cf)](),_0x119239=await purchases['aggregate']([{'$match':{'warehouse_name':_0x1ab7d7}},{'$unwind':_0x7823b8(0x266)},{'$group':{'_id':'$product.product_name'}}]);console[_0x7823b8(0x2d5)](_0x7823b8(0x2e5),_0x119239),_0x1980d0['status'](0xc8)[_0x7823b8(0x230)]({'purchases_data':_0x119239,'product_data':_0x5ba211});}catch(_0x39716a){console[_0x7823b8(0x2d5)](_0x39716a);}}),router['post'](a0_0x5c4fd5(0x207),auth,async(_0x11146e,_0x292128)=>{var _0x3acf08=a0_0x5c4fd5;try{const {warehouse_data:_0x4512f6,product_data:_0x2724f9}=_0x11146e[_0x3acf08(0x274)];console[_0x3acf08(0x2d5)](_0x11146e[_0x3acf08(0x274)]['product_data']);;const _0x5972cb=await master_shop[_0x3acf08(0x1cf)]();console[_0x3acf08(0x2d5)](_0x3acf08(0x1d0),_0x5972cb);const _0x33dd1d=await product[_0x3acf08(0x278)]({'name':_0x2724f9});console[_0x3acf08(0x2d5)](_0x3acf08(0x2ce),_0x33dd1d);const _0x2322e4=await warehouse[_0x3acf08(0x2d9)]([{'$match':{'name':_0x4512f6}},{'$unwind':_0x3acf08(0x208)},{'$match':{'product_details.product_name':_0x2724f9}},{'$group':{'_id':_0x3acf08(0x1e0),'product_stock':{'$first':'$product_details.product_stock'}}}]);console['log']('stock_data',_0x2322e4),_0x292128[_0x3acf08(0x1f9)](0xc8)[_0x3acf08(0x230)]({'master':_0x5972cb,'new_product':_0x33dd1d,'stock_data':_0x2322e4});}catch(_0x5b5a87){console[_0x3acf08(0x2d5)](_0x5b5a87);}}),router[a0_0x5c4fd5(0x2e8)](a0_0x5c4fd5(0x2d3),auth,async(_0x14792f,_0x5cdea7)=>{var _0x4fed95=a0_0x5c4fd5;try{const {invoice:_0x3a7e37,date:_0x5f5bb5,warehouse_name:_0x5175cb,product_name:_0x2ff1b4,note:_0xe6b87,room:_0xacb0c7,primary_code:_0x53fe02,secondary_code:_0x3a925d,prod_code:_0x5deb96,SCRN:_0x52a1c6,ReqBy:_0x1f627a,dateofreq:_0x52373c,PO_number:_0x427ed4,typeservicesData:_0x568063,typevehicle:_0x31ab77,destination:_0x27fd01,deliverydate:_0x2af0d3,driver:_0x444292,plate:_0xa07d3e,van:_0x15d54f,DRSI:_0x1bdca3,TSU:_0x3ad3d6,TFU:_0x4b890e,mode_transpo:_0x5da4e2,name_driver:_0x24be0d,pull_out_date:_0x30312a,actual_delivery_date:_0x442b87}=_0x14792f[_0x4fed95(0x274)];if(typeof _0x2ff1b4==_0x4fed95(0x20a))var _0x43a1d8=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x235)]],_0x570730=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x204)]],_0x376cab=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x2c1)]],_0x3af4ef=[_0x14792f['body'][_0x4fed95(0x23c)]],_0x4d663f=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x28a)]],_0x2768f6=[_0x14792f['body'][_0x4fed95(0x241)]],_0x22b7f2=[_0x14792f['body'][_0x4fed95(0x225)]],_0xb95b33=[_0x14792f[_0x4fed95(0x274)]['primary_unit']],_0x155edb=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x1f3)]],_0x4a7f7a=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x2b1)]],_0xed6369=[_0x14792f[_0x4fed95(0x274)]['expiry_date']],_0xaed960=[_0x14792f['body'][_0x4fed95(0x26a)]],_0x2160de=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x283)]],_0x57ca8b=[_0x14792f['body'][_0x4fed95(0x1ff)]],_0x57e8da=[_0x14792f[_0x4fed95(0x274)]['RoomAssigned']],_0x7b4ab3=[_0x14792f['body'][_0x4fed95(0x255)]],_0x1e6bcc=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x2ba)]],_0x26712a=[_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x1da)]],_0xf17731=[_0x14792f['body'][_0x4fed95(0x234)]];else var _0x43a1d8=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x235)]],_0x570730=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x204)]],_0x376cab=[..._0x14792f[_0x4fed95(0x274)]['carton']],_0x3af4ef=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x23c)]],_0x4d663f=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x28a)]],_0x2768f6=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x241)]],_0x22b7f2=[..._0x14792f[_0x4fed95(0x274)]['level2']],_0xb95b33=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x269)]],_0x155edb=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x1f3)]],_0x4a7f7a=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x2b1)]],_0xed6369=[..._0x14792f[_0x4fed95(0x274)]['expiry_date']],_0xaed960=[..._0x14792f['body'][_0x4fed95(0x26a)]],_0x2160de=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x283)]],_0x57ca8b=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x1ff)]],_0x57e8da=[..._0x14792f['body'][_0x4fed95(0x20f)]],_0x7b4ab3=[..._0x14792f['body'][_0x4fed95(0x255)]],_0x1e6bcc=[..._0x14792f[_0x4fed95(0x274)]['id_transaction_from']],_0x26712a=[..._0x14792f[_0x4fed95(0x274)][_0x4fed95(0x1da)]],_0xf17731=[..._0x14792f[_0x4fed95(0x274)]['gross_price']];const _0x37fb97=_0x43a1d8[_0x4fed95(0x1cc)](_0x5ef4db=>{return _0x5ef4db={'product_name':_0x5ef4db};});_0x570730[_0x4fed95(0x23f)]((_0x48c860,_0x442764)=>{_0x37fb97[_0x442764]['stock']=_0x48c860;}),_0x376cab[_0x4fed95(0x23f)]((_0x4037f7,_0x46dc46)=>{var _0x545a55=_0x4fed95;_0x37fb97[_0x46dc46][_0x545a55(0x2a5)]=Math[_0x545a55(0x261)](_0x4037f7);}),_0x43a1d8['forEach']((_0x1fe6a3,_0x505f63)=>{var _0x5e3e7c=_0x4fed95;_0x37fb97[_0x505f63][_0x5e3e7c(0x1d6)]=_0x14792f[_0x5e3e7c(0x274)][_0x5e3e7c(0x2a0)];}),_0xf17731[_0x4fed95(0x23f)]((_0x314ac8,_0x2fb424)=>{var _0x5d7dba=_0x4fed95;_0x37fb97[_0x2fb424][_0x5d7dba(0x234)]=_0x314ac8;}),_0x26712a[_0x4fed95(0x23f)]((_0x2c08d3,_0x2a4a48)=>{var _0xd6ab85=_0x4fed95;_0x37fb97[_0x2a4a48][_0xd6ab85(0x1da)]=_0x2c08d3;}),_0x1e6bcc[_0x4fed95(0x23f)]((_0x9a80af,_0x3a4eb5)=>{var _0x9cb307=_0x4fed95;_0x37fb97[_0x3a4eb5][_0x9cb307(0x2ba)]=_0x9a80af;}),_0x3af4ef[_0x4fed95(0x23f)]((_0x5952a9,_0x2f09cd)=>{var _0x39a80c=_0x4fed95;_0x37fb97[_0x2f09cd][_0x39a80c(0x23c)]=_0x5952a9;}),_0x4d663f[_0x4fed95(0x23f)]((_0x14ec32,_0x95dfbe)=>{_0x37fb97[_0x95dfbe]['secondary_code']=_0x14ec32;}),_0x2768f6['forEach']((_0x2e45ed,_0x2a0b9d)=>{var _0x4d2c08=_0x4fed95;_0x37fb97[_0x2a0b9d][_0x4d2c08(0x2db)]=_0x2e45ed;}),_0x22b7f2[_0x4fed95(0x23f)]((_0x21f2a9,_0x59049e)=>{var _0x2a81a0=_0x4fed95,_0x48780e=_0x21f2a9[_0x2a81a0(0x287)](/[A-Za-z]+/)[0x0],_0x52f837=parseInt(_0x21f2a9[_0x2a81a0(0x287)](/\d+/)[0x0]);_0x37fb97[_0x59049e][_0x2a81a0(0x1d8)]=_0x52f837,_0x37fb97[_0x59049e][_0x2a81a0(0x2ed)]=_0x48780e;}),_0xb95b33[_0x4fed95(0x23f)]((_0xe975e5,_0x82302e)=>{_0x37fb97[_0x82302e]['unit']=_0xe975e5;}),_0x155edb[_0x4fed95(0x23f)]((_0x2655d8,_0x4e04c7)=>{var _0x19bdd4=_0x4fed95;_0x37fb97[_0x4e04c7][_0x19bdd4(0x1f3)]=_0x2655d8;}),_0x4a7f7a[_0x4fed95(0x23f)]((_0x2f5f90,_0x5396e0)=>{var _0xa6d96f=_0x4fed95;_0x37fb97[_0x5396e0][_0xa6d96f(0x2b1)]=_0x2f5f90;}),_0xed6369[_0x4fed95(0x23f)]((_0x6057f0,_0x1d007e)=>{var _0x3b3df2=_0x4fed95;_0x37fb97[_0x1d007e][_0x3b3df2(0x25f)]=_0x6057f0;}),_0xaed960[_0x4fed95(0x23f)]((_0x430bc0,_0x13c519)=>{_0x37fb97[_0x13c519]['production_date']=_0x430bc0;}),_0x2160de[_0x4fed95(0x23f)]((_0x2aed24,_0x34b91b)=>{var _0x398199=_0x4fed95;_0x37fb97[_0x34b91b][_0x398199(0x224)]=_0x2aed24;}),_0x57ca8b['forEach']((_0xee100f,_0x54a83e)=>{var _0x428a4d=_0x4fed95;_0x37fb97[_0x54a83e][_0x428a4d(0x1ff)]=_0xee100f;}),_0x57e8da[_0x4fed95(0x23f)]((_0x1d277d,_0x5ee8a3)=>{var _0x561192=_0x4fed95;_0x37fb97[_0x5ee8a3][_0x561192(0x27e)]=_0x1d277d;}),_0x7b4ab3['forEach']((_0x56a9cf,_0x17d53e)=>{var _0x134150=_0x4fed95;_0x37fb97[_0x17d53e][_0x134150(0x1df)]=_0x56a9cf,_0x37fb97[_0x17d53e][_0x134150(0x1e4)]=_0x5f5bb5;});const _0x1ce3ce=new invoice_for_outgoing();await _0x1ce3ce[_0x4fed95(0x245)](),_0x7b4ab3[_0x4fed95(0x23f)]((_0x5adf5c,_0x48a99d)=>{var _0x367723=_0x4fed95;_0x37fb97[_0x48a99d][_0x367723(0x2c5)]=_0x367723(0x292)+_0x1ce3ce['invoice_init'][_0x367723(0x29d)]()[_0x367723(0x1e5)](0x8,'0');});var _0x34c248=0x0;_0x37fb97[_0x4fed95(0x23f)](_0x28bba5=>{var _0x24b2d5=_0x4fed95;parseFloat(_0x28bba5[_0x24b2d5(0x204)])<parseFloat(_0x28bba5[_0x24b2d5(0x2a5)])&&parseFloat(_0x28bba5[_0x24b2d5(0x2a5)])>parseFloat(_0x28bba5[_0x24b2d5(0x204)])&&(console[_0x24b2d5(0x2d5)](_0x28bba5[_0x24b2d5(0x204)]+_0x24b2d5(0x211)+_0x28bba5[_0x24b2d5(0x2a5)]),_0x34c248++);});if(_0x34c248!=0x0)return _0x14792f[_0x4fed95(0x271)](_0x4fed95(0x275),_0x4fed95(0x253)),_0x5cdea7[_0x4fed95(0x265)]('back');const _0x19c674=_0x37fb97[_0x4fed95(0x216)](_0x4b19ec=>_0x4b19ec['quantity']!=='0'&&_0x4b19ec[_0x4fed95(0x2a5)]!==''),_0x2398ba=new sales_finished({'invoice':_0x4fed95(0x292)+_0x1ce3ce[_0x4fed95(0x2eb)][_0x4fed95(0x29d)]()[_0x4fed95(0x1e5)](0x8,'0'),'sales_data':_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x2a0)],'customer':_0x14792f[_0x4fed95(0x274)][_0x4fed95(0x2ac)],'date':_0x5f5bb5,'warehouse_name':_0x5175cb,'sale_product':_0x19c674,'note':_0xe6b87,'room':_0xacb0c7,'primary_code':_0x53fe02,'secondary_code':_0x3a925d,'prod_code':_0x5deb96,'SCRN':_0x52a1c6,'finalize':_0x4fed95(0x299),'mode_transpo':_0x5da4e2,'name_driver':_0x24be0d,'ReqBy':_0x1f627a,'dateofreq':_0x52373c,'PO_number':_0x427ed4,'typeservicesData':_0x568063,'typevehicle':_0x31ab77,'destination':_0x27fd01,'deliverydate':_0x2af0d3,'driver':_0x444292,'plate':_0xa07d3e,'van':_0x15d54f,'DRSI':_0x1bdca3,'TSU':_0x3ad3d6,'TFU':_0x4b890e,'pullout_date':_0x30312a,'actualdelivery_date':_0x442b87,'typeOfProducts':_0x4fed95(0x1ed)}),_0xdef904=await _0x2398ba[_0x4fed95(0x245)](),_0x2b2896=await sales_finished[_0x4fed95(0x278)]({'invoice':_0x3a7e37});_0x14792f[_0x4fed95(0x271)](_0x4fed95(0x291),_0x4fed95(0x2aa)),_0x5cdea7['redirect'](_0x4fed95(0x267)+_0xdef904[_0x4fed95(0x2d7)]);}catch(_0x234ef9){console['log'](_0x234ef9);}}),router[a0_0x5c4fd5(0x259)](a0_0x5c4fd5(0x29e),auth,async(_0xddfb92,_0x5f2ced)=>{var _0xc1711f=a0_0x5c4fd5;try{const {username:_0xcf5580,email:_0x179653,role:_0xbd7b1d}=_0xddfb92[_0xc1711f(0x26d)],_0x451d76=_0xddfb92[_0xc1711f(0x26d)],_0x375a13=await profile[_0xc1711f(0x278)]({'email':_0x451d76[_0xc1711f(0x249)]}),_0x3d3b6c=await master_shop[_0xc1711f(0x1cf)](),_0x1aa846=_0xddfb92[_0xc1711f(0x2b4)]['id'],_0x18afbd=await sales_finished[_0xc1711f(0x2be)](_0x1aa846),_0x3abef3=await warehouse['aggregate']([{'$match':{'name':_0x18afbd[_0xc1711f(0x1ec)]}},{'$unwind':_0xc1711f(0x208)},{'$group':{'_id':_0xc1711f(0x27c),'name':{'$first':_0xc1711f(0x1e0)},'product_stock':{'$first':_0xc1711f(0x28b)},'bay':{'$first':_0xc1711f(0x1f8)},'bin':{'$first':_0xc1711f(0x294)},'type':{'$first':_0xc1711f(0x21e)},'floorlevel':{'$first':_0xc1711f(0x1f5)},'primary_code':{'$first':_0xc1711f(0x2b9)},'secondary_code':{'$first':_0xc1711f(0x1e6)},'product_code':{'$first':_0xc1711f(0x2d6)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xc1711f(0x285)},'production_date':{'$first':_0xc1711f(0x26f)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'},'room_data':{'$first':_0xc1711f(0x2b6)}}}]),_0x1ec657=await customer['find']({});let _0x412c14;if(_0x451d76[_0xc1711f(0x209)]=='staff'){const _0x5e6c4a=await staff[_0xc1711f(0x278)]({'email':_0x451d76[_0xc1711f(0x249)]});_0x412c14=await warehouse['aggregate']([{'$match':{'status':_0xc1711f(0x288),'name':_0x5e6c4a['warehouse']}},{'$group':{'_id':_0xc1711f(0x2e4),'name':{'$first':_0xc1711f(0x2e4)}}}]);}else _0x412c14=await warehouse[_0xc1711f(0x2d9)]([{'$match':{'status':_0xc1711f(0x288)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x30fc1d=await product[_0xc1711f(0x1cf)]({});if(_0x3d3b6c[0x0]['language']==_0xc1711f(0x206)){var _0xd19ce5=users[_0xc1711f(0x2ad)];console[_0xc1711f(0x2d5)](_0xd19ce5);}else{if(_0x3d3b6c[0x0][_0xc1711f(0x1d2)]=='Hindi')var _0xd19ce5=users[_0xc1711f(0x27d)];else{if(_0x3d3b6c[0x0][_0xc1711f(0x1d2)]==_0xc1711f(0x1fd))var _0xd19ce5=users[_0xc1711f(0x1fd)];else{if(_0x3d3b6c[0x0][_0xc1711f(0x1d2)]=='Spanish')var _0xd19ce5=users[_0xc1711f(0x22b)];else{if(_0x3d3b6c[0x0]['language']=='French')var _0xd19ce5=users['French'];else{if(_0x3d3b6c[0x0][_0xc1711f(0x1d2)]==_0xc1711f(0x243))var _0xd19ce5=users[_0xc1711f(0x223)];else{if(_0x3d3b6c[0x0][_0xc1711f(0x1d2)]==_0xc1711f(0x252))var _0xd19ce5=users[_0xc1711f(0x252)];else{if(_0x3d3b6c[0x0]['language']==_0xc1711f(0x264))var _0xd19ce5=users['Arabic'];}}}}}}}_0x5f2ced['render'](_0xc1711f(0x2cd),{'success':_0xddfb92[_0xc1711f(0x271)]('success'),'errors':_0xddfb92['flash'](_0xc1711f(0x275)),'role':_0x451d76,'profile':_0x375a13,'customer':_0x1ec657,'warehouse':_0x412c14,'product':_0x3abef3,'user':_0x18afbd,'master_shop':_0x3d3b6c,'unit':_0x30fc1d,'language':_0xd19ce5});}catch(_0x252dc0){console[_0xc1711f(0x2d5)](_0x252dc0);}});async function dataUpdate(_0x5f409f,_0x4e64a4,_0x4301cf){var _0x238655=a0_0x5c4fd5;return await warehouse[_0x238655(0x217)]({'_id':_0x5f409f,'product_details._id':_0x4e64a4},{'$set':{'product_details.$.product_stock':_0x4301cf}}),await warehouse[_0x238655(0x2be)](_0x5f409f);}router[a0_0x5c4fd5(0x2e8)]('/preview/:id',auth,async(_0x48c7ca,_0x4fa861)=>{var _0x552d1b=a0_0x5c4fd5;try{const _0x30ed50=_0x48c7ca['params']['id'],{invoice:_0x30ad22,warehouse_name:_0x2957d4,room:_0x5cc6ef}=_0x48c7ca[_0x552d1b(0x274)],_0x210ce0=await sales_finished[_0x552d1b(0x278)]({'invoice':_0x30ad22});for(let _0x57b9e4=0x0;_0x57b9e4<=_0x210ce0[_0x552d1b(0x26c)][_0x552d1b(0x2de)]-0x1;_0x57b9e4++){const _0x59b9f6=_0x210ce0['sale_product'][_0x57b9e4];var _0x54aead=await warehouse[_0x552d1b(0x278)]({'name':_0x2957d4,'room':_0x59b9f6['room_name']}),_0x38efdf=0x0;for(let _0x201a4e=0x0;_0x201a4e<=_0x54aead[_0x552d1b(0x21b)][_0x552d1b(0x2de)]-0x1;_0x201a4e++){const _0x54da02=_0x54aead[_0x552d1b(0x21b)][_0x201a4e];_0x54da02[_0x552d1b(0x2d7)]==_0x59b9f6[_0x552d1b(0x2ba)]&&_0x54da02[_0x552d1b(0x1da)]==_0x59b9f6[_0x552d1b(0x1da)]&&(_0x38efdf=Math['max'](0x0,Math[_0x552d1b(0x261)](_0x54da02[_0x552d1b(0x1e8)])-Math[_0x552d1b(0x261)](_0x59b9f6['quantity'])),await warehouse['updateOne']({'_id':_0x54aead['_id'][_0x552d1b(0x2c6)](),'product_details._id':_0x54da02['_id'][_0x552d1b(0x2c6)](),'product_details.uuid':_0x59b9f6[_0x552d1b(0x1da)]},{'$set':{'product_details.$.product_stock':_0x38efdf}}));}console['log'](typeof _0x59b9f6[_0x552d1b(0x1d6)]);if(typeof _0x59b9f6['agent_id']!==_0x552d1b(0x1f7)){var _0x2de481=await staff['findById'](_0x59b9f6[_0x552d1b(0x1d6)]);console['log'](_0x552d1b(0x2c8));var _0xc5078b=0x0;for(let _0x5e1737=0x0;_0x5e1737<=_0x2de481[_0x552d1b(0x2cf)]['length']-0x1;_0x5e1737++){const _0x460f92=_0x2de481[_0x552d1b(0x2cf)][_0x5e1737];console[_0x552d1b(0x2d5)](_0x59b9f6[_0x552d1b(0x2ba)]+_0x552d1b(0x1e7)+_0x460f92[_0x552d1b(0x2c2)]+_0x552d1b(0x2e7)+_0x59b9f6[_0x552d1b(0x2d7)]+_0x552d1b(0x1e7)+_0x59b9f6[_0x552d1b(0x2d7)]),_0x59b9f6[_0x552d1b(0x2ba)]==_0x460f92['warehouse_id']&&_0x59b9f6[_0x552d1b(0x2d7)]==0x1&&(_0x460f92[_0x552d1b(0x1e8)]=Math['abs'](_0x460f92[_0x552d1b(0x1e8)])+Math[_0x552d1b(0x261)](_0x59b9f6['quantity']),_0xc5078b++);}console['log'](_0x552d1b(0x29c),_0xc5078b),_0xc5078b=='0'&&(_0x2de481[_0x552d1b(0x2cf)]=_0x2de481['product_list']['concat']({'product_name':_0x59b9f6[_0x552d1b(0x235)],'product_stock':_0x59b9f6[_0x552d1b(0x2a5)],'bay':_0x59b9f6[_0x552d1b(0x1d8)],'level':_0x59b9f6[_0x552d1b(0x2ed)],'product_code':_0x59b9f6[_0x552d1b(0x2db)],'primary_code':_0x59b9f6[_0x552d1b(0x23c)],'secondary_code':_0x59b9f6[_0x552d1b(0x28a)],'expiry_date':_0x59b9f6[_0x552d1b(0x25f)],'production_date':_0x59b9f6[_0x552d1b(0x286)],'maxProducts':_0x59b9f6[_0x552d1b(0x2dc)],'batch_code':_0x59b9f6[_0x552d1b(0x2b1)],'secondary_unit':_0x59b9f6[_0x552d1b(0x1f3)],'unit':_0x59b9f6[_0x552d1b(0x277)],'maxProducts':_0x59b9f6[_0x552d1b(0x2dc)],'maxPerUnit':_0x59b9f6[_0x552d1b(0x224)],'invoice':_0x59b9f6[_0x552d1b(0x1df)],'warehouse_id':_0x59b9f6['id_transaction_from'],'id_incoming':_0x59b9f6[_0x552d1b(0x2d7)],'uuid':_0x59b9f6['uuid'],'gross_price':_0x59b9f6[_0x552d1b(0x234)],'date_incoming':_0x59b9f6[_0x552d1b(0x1e4)],'outgoing_invoice':_0x59b9f6['outgoing_invoice']}),await _0x2de481[_0x552d1b(0x245)]());}}_0x210ce0['finalize']=_0x552d1b(0x2b0);const _0x2a8602=await _0x210ce0[_0x552d1b(0x245)](),_0x43ba54=await master_shop['find'](),_0x511052=await email_settings[_0x552d1b(0x278)](),_0x80b53=await supervisor_settings['find']();var _0x110b87=_0x210ce0[_0x552d1b(0x26c)],_0x13137d='',_0x4a145e;for(_0x4a145e in _0x110b87){_0x13137d+=_0x552d1b(0x2e3)+_0x552d1b(0x2dd)+_0x110b87[_0x4a145e][_0x552d1b(0x235)]+_0x552d1b(0x215)+_0x552d1b(0x2dd)+_0x110b87[_0x4a145e][_0x552d1b(0x2db)]+_0x552d1b(0x215)+_0x552d1b(0x2dd)+_0x110b87[_0x4a145e][_0x552d1b(0x2a5)]+_0x552d1b(0x215)+_0x552d1b(0x2dd)+_0x110b87[_0x4a145e][_0x552d1b(0x277)]+_0x552d1b(0x215)+_0x552d1b(0x2dd)+_0x110b87[_0x4a145e][_0x552d1b(0x1f3)]+_0x552d1b(0x215)+_0x552d1b(0x2dd)+_0x210ce0[_0x552d1b(0x1ec)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x110b87[_0x4a145e]['room_name']+'</td>'+_0x552d1b(0x2dd)+_0x110b87[_0x4a145e][_0x552d1b(0x1d8)]+'</td>';}_0x48c7ca[_0x552d1b(0x271)]('success',_0x552d1b(0x200)),_0x4fa861[_0x552d1b(0x265)](_0x552d1b(0x29f)+_0x30ed50);}catch(_0x4ba069){console['log'](_0x4ba069);}}),router[a0_0x5c4fd5(0x259)](a0_0x5c4fd5(0x23a),auth,async(_0x20e739,_0x54947f)=>{var _0x541671=a0_0x5c4fd5;try{const {username:_0x316e90,email:_0x421670,role:_0x199ed3}=_0x20e739[_0x541671(0x26d)],_0x3d1ebf=_0x20e739['user'],_0x343339=await profile[_0x541671(0x278)]({'email':_0x3d1ebf[_0x541671(0x249)]}),_0x3dbed=await master_shop[_0x541671(0x1cf)](),_0x38bb31=_0x20e739[_0x541671(0x2b4)]['id'],_0x43a988=await sales_finished[_0x541671(0x2be)](_0x38bb31);let _0x5a454e=new Date(_0x43a988[_0x541671(0x25f)]),_0x64c7eb=('0'+_0x5a454e[_0x541671(0x273)]())[_0x541671(0x219)](-0x2),_0xf5e42e=('0'+(_0x5a454e[_0x541671(0x2a3)]()+0x1))[_0x541671(0x219)](-0x2),_0x2e39c8=_0x5a454e['getFullYear'](),_0x52d29c=_0x2e39c8+'-'+_0xf5e42e+'-'+_0x64c7eb;var _0x13fe67=[_0x541671(0x227),_0x541671(0x25b)];const _0x500032=await warehouse[_0x541671(0x2d9)]([{'$match':{'name':_0x43a988['warehouse_name'],'room':_0x43a988[_0x541671(0x25e)]}},{'$unwind':_0x541671(0x208)},{'$group':{'_id':_0x541671(0x27c),'name':{'$first':_0x541671(0x1e0)},'product_stock':{'$first':_0x541671(0x28b)},'bay':{'$first':_0x541671(0x1f8)},'bin':{'$first':_0x541671(0x294)},'type':{'$first':_0x541671(0x21e)},'floorlevel':{'$first':_0x541671(0x1f5)},'primary_code':{'$first':_0x541671(0x2b9)},'secondary_code':{'$first':_0x541671(0x1e6)},'product_code':{'$first':_0x541671(0x2d6)},'storage':{'$first':_0x541671(0x257)},'rack':{'$first':_0x541671(0x272)}}}]),_0x3f2ce0=await customer[_0x541671(0x1cf)]({});let _0x4b93b8;if(_0x3d1ebf[_0x541671(0x209)]=='staff'){const _0x18d51c=await staff[_0x541671(0x278)]({'email':_0x3d1ebf[_0x541671(0x249)]});_0x4b93b8=await warehouse['aggregate']([{'$match':{'status':_0x541671(0x288),'name':_0x18d51c[_0x541671(0x1de)]}},{'$group':{'_id':_0x541671(0x2e4),'name':{'$first':_0x541671(0x2e4)}}}]);}else _0x4b93b8=await warehouse[_0x541671(0x2d9)]([{'$match':{'status':_0x541671(0x288)}},{'$group':{'_id':_0x541671(0x2e4),'name':{'$first':_0x541671(0x2e4)}}}]);const _0x45ebf4=await product['find']({});if(_0x3dbed[0x0]['language']=='English\x20(US)'){var _0x5a4dc0=users[_0x541671(0x2ad)];console[_0x541671(0x2d5)](_0x5a4dc0);}else{if(_0x3dbed[0x0][_0x541671(0x1d2)]==_0x541671(0x27d))var _0x5a4dc0=users[_0x541671(0x27d)];else{if(_0x3dbed[0x0][_0x541671(0x1d2)]=='German')var _0x5a4dc0=users[_0x541671(0x1fd)];else{if(_0x3dbed[0x0][_0x541671(0x1d2)]==_0x541671(0x22b))var _0x5a4dc0=users[_0x541671(0x22b)];else{if(_0x3dbed[0x0][_0x541671(0x1d2)]==_0x541671(0x23e))var _0x5a4dc0=users[_0x541671(0x23e)];else{if(_0x3dbed[0x0][_0x541671(0x1d2)]==_0x541671(0x243))var _0x5a4dc0=users['Portuguese'];else{if(_0x3dbed[0x0][_0x541671(0x1d2)]==_0x541671(0x252))var _0x5a4dc0=users['Chinese'];else{if(_0x3dbed[0x0][_0x541671(0x1d2)]==_0x541671(0x264))var _0x5a4dc0=users[_0x541671(0x2c3)];}}}}}}}_0x54947f[_0x541671(0x2bb)](_0x541671(0x2bc),{'success':_0x20e739[_0x541671(0x271)](_0x541671(0x291)),'errors':_0x20e739[_0x541671(0x271)](_0x541671(0x275)),'role':_0x3d1ebf,'profile':_0x343339,'customer':_0x3f2ce0,'warehouse':_0x4b93b8,'product':_0x500032,'user':_0x43a988,'master_shop':_0x3dbed,'unit':_0x45ebf4,'language':_0x5a4dc0,'rooms_data':_0x13fe67,'ed_fullDate':_0x52d29c});}catch(_0x492eba){console[_0x541671(0x2d5)](_0x492eba);}}),router[a0_0x5c4fd5(0x2e8)](a0_0x5c4fd5(0x23a),auth,async(_0x4fb8d5,_0x7bf077)=>{var _0x4f4fcc=a0_0x5c4fd5;try{const _0x5cbef2=_0x4fb8d5['params']['id'],_0x406113=await sales_finished[_0x4f4fcc(0x278)]({'_id':_0x4fb8d5[_0x4f4fcc(0x2b4)]['id']}),_0x521581=await warehouse['findOne']({'name':_0x406113[_0x4f4fcc(0x1ec)],'room':_0x4fb8d5[_0x4f4fcc(0x274)]['room'],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x58626c,customer:_0x2c3d67,date:_0x3c29f0,warehouse_name:_0x30395f,product_name:_0x474138,stock:_0x4277b4,adjust_qty:_0x445d43,note:_0x58aff3,room:_0x1d90fe,primary_code:_0x236a41,secondary_code:_0x220779,prod_code:_0x3d8cc9,level:_0x157e83,isle:_0x4a1152,pallet:_0x338606,expiry_date:_0x52e026}=_0x4fb8d5[_0x4f4fcc(0x274)];if(typeof _0x474138==_0x4f4fcc(0x20a))var _0x83d821=[_0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x235)]],_0x51dbec=[_0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x204)]],_0x33ff3f=[_0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x213)]],_0x2d4cfc=[_0x4fb8d5[_0x4f4fcc(0x274)]['primary_code']],_0x12cdd4=[_0x4fb8d5[_0x4f4fcc(0x274)]['secondary_code']],_0x3abf62=[_0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x241)]],_0xec8c61=[_0x4fb8d5['body'][_0x4f4fcc(0x2ed)]],_0x5234d7=[_0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x25f)]];else var _0x83d821=[..._0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x235)]],_0x51dbec=[..._0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x204)]],_0x33ff3f=[..._0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x213)]],_0x2d4cfc=[..._0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x23c)]],_0x12cdd4=[..._0x4fb8d5['body']['secondary_code']],_0x3abf62=[..._0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x241)]],_0xec8c61=[..._0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x2ed)]],_0x5234d7=[..._0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x25f)]];const _0x69671e=_0x83d821[_0x4f4fcc(0x1cc)](_0x58cbff=>{return _0x58cbff={'product_name':_0x58cbff};});_0x51dbec[_0x4f4fcc(0x23f)]((_0xf0be41,_0x298f1c)=>{_0x69671e[_0x298f1c]['stock']=_0xf0be41;}),_0x33ff3f[_0x4f4fcc(0x23f)]((_0x4ec68e,_0x5857e4)=>{var _0x2ff391=_0x4f4fcc;_0x69671e[_0x5857e4][_0x2ff391(0x2a5)]=_0x4ec68e;}),_0x2d4cfc['forEach']((_0x3cd255,_0x32186d)=>{var _0x53669c=_0x4f4fcc;_0x69671e[_0x32186d][_0x53669c(0x23c)]=_0x3cd255;}),_0x12cdd4[_0x4f4fcc(0x23f)]((_0x5ad542,_0x392667)=>{var _0x24e925=_0x4f4fcc;_0x69671e[_0x392667][_0x24e925(0x28a)]=_0x5ad542;}),_0x3abf62[_0x4f4fcc(0x23f)]((_0x297b57,_0x46fcd9)=>{_0x69671e[_0x46fcd9]['product_code']=_0x297b57;}),_0xec8c61[_0x4f4fcc(0x23f)]((_0x2f5ce8,_0x4b266a)=>{var _0x5160ed=_0x4f4fcc;_0x69671e[_0x4b266a][_0x5160ed(0x2ed)]=_0x2f5ce8;}),_0x5234d7[_0x4f4fcc(0x23f)]((_0x2143ae,_0x4941e3)=>{var _0x426a32=_0x4f4fcc;_0x69671e[_0x4941e3][_0x426a32(0x25f)]=_0x2143ae;});var _0x16b250=0x0;_0x69671e[_0x4f4fcc(0x23f)](_0x53530c=>{var _0x5b3d5b=_0x4f4fcc;console['log'](_0x5b3d5b(0x1d7),_0x53530c),(parseInt(_0x53530c[_0x5b3d5b(0x204)])<parseInt(_0x53530c[_0x5b3d5b(0x2a5)])||parseInt(_0x53530c['quantity'])==0x0)&&_0x16b250++;});if(_0x16b250!=0x0)return _0x4fb8d5[_0x4f4fcc(0x271)](_0x4f4fcc(0x275),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x7bf077[_0x4f4fcc(0x265)](_0x4f4fcc(0x258));_0x406113['sale_product'][_0x4f4fcc(0x23f)](_0x17963a=>{var _0x5764a8=_0x4f4fcc;const _0x564608=_0x521581[_0x5764a8(0x21b)][_0x5764a8(0x1cc)](_0x146f33=>{var _0x24ce30=_0x5764a8;_0x146f33['product_name']==_0x17963a[_0x24ce30(0x235)]&&_0x146f33[_0x24ce30(0x1d8)]==_0x17963a[_0x24ce30(0x1d8)]&&(_0x146f33[_0x24ce30(0x1e8)]=parseInt(_0x146f33[_0x24ce30(0x1e8)])+parseInt(_0x17963a[_0x24ce30(0x2a5)]));});}),await _0x521581['save']();const _0x262c3d=_0x69671e[_0x4f4fcc(0x216)](_0x4d03e0=>_0x4d03e0[_0x4f4fcc(0x2a5)]!=='0'&&_0x4d03e0[_0x4f4fcc(0x2a5)]!=='');_0x406113[_0x4f4fcc(0x1df)]=_0x58626c,_0x406113[_0x4f4fcc(0x2ac)]=_0x2c3d67,_0x406113[_0x4f4fcc(0x1f2)]=_0x3c29f0,_0x406113[_0x4f4fcc(0x1ec)]=_0x30395f,_0x406113[_0x4f4fcc(0x26c)]=_0x262c3d,_0x406113[_0x4f4fcc(0x28e)]=_0x58aff3,_0x406113[_0x4f4fcc(0x25e)]=_0x1d90fe;const _0x8cc39=await _0x406113[_0x4f4fcc(0x245)](),_0x38bc08=await sales_finished['findOne']({'_id':_0x4fb8d5[_0x4f4fcc(0x2b4)]['id']}),_0xba9fb9=await warehouse[_0x4f4fcc(0x278)]({'name':_0x30395f,'room':_0x1d90fe,'warehouse_category':_0x4f4fcc(0x1f6)});_0x38bc08[_0x4f4fcc(0x26c)]['forEach'](_0x235c81=>{var _0xc630f3=_0x4f4fcc;const _0x2e39a0=_0xba9fb9[_0xc630f3(0x21b)][_0xc630f3(0x1cc)](_0x1d49ac=>{var _0x647210=_0xc630f3;_0x1d49ac[_0x647210(0x235)]==_0x235c81[_0x647210(0x235)]&&_0x1d49ac['bay']==_0x235c81[_0x647210(0x1d8)]&&(_0x1d49ac[_0x647210(0x1e8)]=parseInt(_0x1d49ac[_0x647210(0x1e8)])-parseInt(_0x235c81[_0x647210(0x2a5)]));});}),console[_0x4f4fcc(0x2d5)](_0x4f4fcc(0x26b),_0xba9fb9),await _0xba9fb9[_0x4f4fcc(0x245)]();const _0x2833f7=await c_payment_data[_0x4f4fcc(0x278)]({'invoice':_0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x1df)]});_0x2833f7['suppliers']=_0x4fb8d5[_0x4f4fcc(0x274)][_0x4f4fcc(0x2ee)],await _0x2833f7[_0x4f4fcc(0x245)](),_0x4fb8d5[_0x4f4fcc(0x271)]('success',_0x4f4fcc(0x200)),_0x7bf077[_0x4f4fcc(0x265)](_0x4f4fcc(0x2b5));}catch(_0x2961a5){console[_0x4f4fcc(0x2d5)](_0x2961a5);}}),router['post'](a0_0x5c4fd5(0x22c),auth,async(_0x3d563a,_0x23728d)=>{var _0x1ba946=a0_0x5c4fd5;try{const _0x1f515b=_0x3d563a[_0x1ba946(0x2b4)]['id'],{invoice:_0x2f88a5,customer:_0xc62ca3,receivable_amount:_0x582ac8,received_amount:_0x4575ab}=_0x3d563a[_0x1ba946(0x274)],_0x102821=await sales['findById'](_0x1f515b);console[_0x1ba946(0x2d5)](_0x102821);var _0x354c14=_0x582ac8-_0x4575ab;console[_0x1ba946(0x2d5)](_0x4575ab),_0x102821[_0x1ba946(0x279)]=parseFloat(_0x4575ab)+parseFloat(_0x102821['received_amount']),_0x102821[_0x1ba946(0x2a8)]=_0x354c14,console[_0x1ba946(0x2d5)](_0x102821);const _0xa02943=await _0x102821[_0x1ba946(0x245)](),_0x24764a=await c_payment_data[_0x1ba946(0x278)]({'invoice':_0x2f88a5});_0x24764a[_0x1ba946(0x226)]=_0x354c14,await _0x24764a[_0x1ba946(0x245)]();let _0x2131df=new Date(),_0x575782=('0'+_0x2131df[_0x1ba946(0x273)]())[_0x1ba946(0x219)](-0x2),_0x5efa7d=('0'+(_0x2131df[_0x1ba946(0x2a3)]()+0x1))['slice'](-0x2),_0x1d8568=_0x2131df['getFullYear'](),_0x2ac3af=_0x1d8568+'-'+_0x5efa7d+'-'+_0x575782;const _0x2c0264=new customer_payment({'invoice':_0x2f88a5,'date':_0x1d8568+'-'+_0x5efa7d+'-'+_0x575782,'customer':_0xc62ca3,'reason':_0x1ba946(0x2e2),'amount':_0x4575ab}),_0x305867=await _0x2c0264[_0x1ba946(0x245)]();_0x3d563a[_0x1ba946(0x271)]('success',_0x1ba946(0x1e2)),_0x23728d['redirect'](_0x1ba946(0x231));}catch(_0x3e2a87){console[_0x1ba946(0x2d5)](_0x3e2a87);}}),router[a0_0x5c4fd5(0x259)](a0_0x5c4fd5(0x1eb),auth,async(_0x20ab41,_0x4c9d6f)=>{var _0x3c4afc=a0_0x5c4fd5;try{const {username:_0x43cad9,email:_0x1d541a,role:_0x3bf6ac}=_0x20ab41['user'],_0x25743c=_0x20ab41[_0x3c4afc(0x26d)],_0x1d3ac9=await profile[_0x3c4afc(0x278)]({'email':_0x25743c[_0x3c4afc(0x249)]}),_0x42f996=await master_shop['find']();console['log']('master',_0x42f996);const _0x39ad57=_0x20ab41[_0x3c4afc(0x2b4)]['id'],_0x3bb246=await sales[_0x3c4afc(0x2be)](_0x39ad57);console['log'](_0x3bb246);const _0x2e3fbc=await customer[_0x3c4afc(0x278)]({'name':_0x3bb246[_0x3c4afc(0x2ac)]});console[_0x3c4afc(0x2d5)](_0x2e3fbc);if(_0x42f996[0x0][_0x3c4afc(0x1d2)]==_0x3c4afc(0x206)){var _0x57f55a=users[_0x3c4afc(0x2ad)];console[_0x3c4afc(0x2d5)](_0x57f55a);}else{if(_0x42f996[0x0][_0x3c4afc(0x1d2)]==_0x3c4afc(0x27d))var _0x57f55a=users[_0x3c4afc(0x27d)];else{if(_0x42f996[0x0][_0x3c4afc(0x1d2)]==_0x3c4afc(0x1fd))var _0x57f55a=users[_0x3c4afc(0x1fd)];else{if(_0x42f996[0x0][_0x3c4afc(0x1d2)]=='Spanish')var _0x57f55a=users['Spanish'];else{if(_0x42f996[0x0][_0x3c4afc(0x1d2)]=='French')var _0x57f55a=users[_0x3c4afc(0x23e)];else{if(_0x42f996[0x0][_0x3c4afc(0x1d2)]==_0x3c4afc(0x243))var _0x57f55a=users[_0x3c4afc(0x223)];else{if(_0x42f996[0x0][_0x3c4afc(0x1d2)]==_0x3c4afc(0x252))var _0x57f55a=users['Chinese'];else{if(_0x42f996[0x0][_0x3c4afc(0x1d2)]==_0x3c4afc(0x264))var _0x57f55a=users[_0x3c4afc(0x2c3)];}}}}}}}_0x4c9d6f[_0x3c4afc(0x2bb)](_0x3c4afc(0x202),{'success':_0x20ab41[_0x3c4afc(0x271)]('success'),'errors':_0x20ab41[_0x3c4afc(0x271)](_0x3c4afc(0x275)),'role':_0x25743c,'profile':_0x1d3ac9,'master_shop':_0x42f996,'customers':_0x2e3fbc,'sales':_0x3bb246,'language':_0x57f55a});}catch(_0x2b10e1){console[_0x3c4afc(0x2d5)](_0x2b10e1);}}),router[a0_0x5c4fd5(0x259)]('/view/return_sales/:id',auth,async(_0x113407,_0x4bd664)=>{var _0x31b49e=a0_0x5c4fd5;try{const {username:_0x1bb122,email:_0x2d3349,role:_0x193d6c}=_0x113407[_0x31b49e(0x26d)],_0x494a1d=_0x113407['user'],_0x1acec0=await profile['findOne']({'email':_0x494a1d[_0x31b49e(0x249)]}),_0x39a3d4=await master_shop[_0x31b49e(0x1cf)](),_0x161c5d=_0x113407[_0x31b49e(0x2b4)]['id'],_0xe7767a=await sales_finished[_0x31b49e(0x2be)](_0x161c5d),_0x52b97f=await warehouse['aggregate']([{'$match':{'name':_0xe7767a['warehouse_name']}},{'$unwind':_0x31b49e(0x208)},{'$group':{'_id':_0x31b49e(0x27c),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x31b49e(0x28b)},'bay':{'$first':_0x31b49e(0x1f8)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x31b49e(0x21e)},'floorlevel':{'$first':_0x31b49e(0x1f5)},'primary_code':{'$first':_0x31b49e(0x2b9)},'secondary_code':{'$first':_0x31b49e(0x1e6)},'product_code':{'$first':_0x31b49e(0x2d6)},'storage':{'$first':_0x31b49e(0x257)},'rack':{'$first':_0x31b49e(0x272)},'expiry_date':{'$first':_0x31b49e(0x285)},'production_date':{'$first':_0x31b49e(0x26f)},'unit':{'$first':_0x31b49e(0x1ef)},'secondary_unit':{'$first':_0x31b49e(0x1fc)},'maxProducts':{'$first':_0x31b49e(0x268)},'batch_code':{'$first':_0x31b49e(0x20e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x4b177b=await product[_0x31b49e(0x1cf)]({}),_0x3a04fb=await warehouse[_0x31b49e(0x2d9)]([{'$match':{'status':'Enabled','warehouse_category':_0x31b49e(0x1f6),'name':{'$ne':'Return\x20Goods','$ne':_0x31b49e(0x23b)}}},{'$group':{'_id':'$name','name':{'$first':_0x31b49e(0x2e4)}}},{'$sort':{'name':0x1}}]);var _0x28cf52=[_0x31b49e(0x20c)];const _0x175b17=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x31b49e(0x23b)}},{'$group':{'_id':_0x31b49e(0x2e4),'name':{'$first':_0x31b49e(0x2e4)}}},{'$sort':{'name':0x1}}]);if(_0x39a3d4[0x0][_0x31b49e(0x1d2)]==_0x31b49e(0x206)){var _0xce6672=users[_0x31b49e(0x2ad)];console[_0x31b49e(0x2d5)](_0xce6672);}else{if(_0x39a3d4[0x0]['language']==_0x31b49e(0x27d))var _0xce6672=users[_0x31b49e(0x27d)];else{if(_0x39a3d4[0x0]['language']==_0x31b49e(0x1fd))var _0xce6672=users[_0x31b49e(0x1fd)];else{if(_0x39a3d4[0x0][_0x31b49e(0x1d2)]=='Spanish')var _0xce6672=users[_0x31b49e(0x22b)];else{if(_0x39a3d4[0x0]['language']=='French')var _0xce6672=users[_0x31b49e(0x23e)];else{if(_0x39a3d4[0x0]['language']=='Portuguese\x20(BR)')var _0xce6672=users[_0x31b49e(0x223)];else{if(_0x39a3d4[0x0]['language']==_0x31b49e(0x252))var _0xce6672=users[_0x31b49e(0x252)];else{if(_0x39a3d4[0x0][_0x31b49e(0x1d2)]==_0x31b49e(0x264))var _0xce6672=users[_0x31b49e(0x2c3)];}}}}}}}_0x4bd664[_0x31b49e(0x2bb)](_0x31b49e(0x1f4),{'success':_0x113407[_0x31b49e(0x271)](_0x31b49e(0x291)),'errors':_0x113407['flash'](_0x31b49e(0x275)),'role':_0x494a1d,'profile':_0x1acec0,'user':_0xe7767a,'stock':_0x52b97f,'master_shop':_0x39a3d4,'unit':_0x4b177b,'language':_0xce6672,'warehouses':_0x3a04fb,'rooms':_0x28cf52,'warehouse_QA':_0x175b17});}catch(_0x18244e){console['log'](_0x18244e),_0x4bd664['status'](0xc8)[_0x31b49e(0x230)]({'message':_0x18244e[_0x31b49e(0x22e)]});}}),router[a0_0x5c4fd5(0x2e8)]('/view/return_sales/:id',auth,async(_0x14e5bc,_0x188406)=>{var _0x5425f0=a0_0x5c4fd5;if(_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2c4)]=='QA')try{const {invoice:_0x1bc4c7,date:_0x3c3674,warehouse_name:_0x2ee4cd,product_name:_0x1b520b,primary_code:_0x58f397,secondary_code:_0x3cdb2a,product_code:_0x439120,sales_quantity:_0x1a6517,stocks:_0x4f6e6c,return_qty:_0x4974b0,Room_name:_0x3eb1f5,to_warehouse_name_QA:_0x13c8f3,to_Room_name_QA:_0x250ef4,note:_0xda5e16,for_categorize:_0x489c95,product_name_QA1:_0x508e2a}=_0x14e5bc['body'];if(typeof _0x508e2a==_0x5425f0(0x20a))var _0x23b7f1=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x28c)]],_0x36a9a8=[_0x14e5bc[_0x5425f0(0x274)]['primary_code_QA']],_0x1a7b27=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x1fe)]],_0x4624e1=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x1e3)]],_0x46d721=[_0x14e5bc['body'][_0x5425f0(0x236)]],_0x2284d7=[_0x14e5bc['body'][_0x5425f0(0x21d)]],_0x4492c4=[_0x14e5bc[_0x5425f0(0x274)]['return_qty_QA']],_0x382544=[_0x14e5bc['body'][_0x5425f0(0x242)]],_0x4ae92e=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x270)]],_0x5efc85=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x232)]],_0x285eff=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x1fb)]],_0x1b3f29=[_0x14e5bc[_0x5425f0(0x274)]['unit_QA']],_0x41f0c0=[_0x14e5bc['body'][_0x5425f0(0x21f)]],_0x1d23ee=[_0x14e5bc[_0x5425f0(0x274)]['expiry_date_QA']];else var _0x23b7f1=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x28c)]],_0x36a9a8=[..._0x14e5bc['body']['primary_code_QA']],_0x1a7b27=[..._0x14e5bc[_0x5425f0(0x274)]['secondary_code_QA']],_0x4624e1=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x1e3)]],_0x46d721=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x236)]],_0x2284d7=[..._0x14e5bc[_0x5425f0(0x274)]['stocks_QA']],_0x4492c4=[..._0x14e5bc['body']['return_qty_QA']],_0x382544=[..._0x14e5bc['body'][_0x5425f0(0x242)]],_0x4ae92e=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x270)]],_0x5efc85=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x232)]],_0x285eff=[..._0x14e5bc['body'][_0x5425f0(0x1fb)]],_0x1b3f29=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x1d4)]],_0x41f0c0=[..._0x14e5bc['body'][_0x5425f0(0x21f)]],_0x1d23ee=[..._0x14e5bc['body'][_0x5425f0(0x296)]];const _0x559a3c=_0x23b7f1['map'](_0xf0a2a8=>{return _0xf0a2a8={'product_name':_0xf0a2a8};});_0x36a9a8[_0x5425f0(0x23f)]((_0x6250a,_0x52bc33)=>{var _0x34d561=_0x5425f0;_0x559a3c[_0x52bc33][_0x34d561(0x23c)]=_0x6250a;}),_0x1a7b27[_0x5425f0(0x23f)]((_0x322c93,_0x95b4fd)=>{var _0x534e68=_0x5425f0;_0x559a3c[_0x95b4fd][_0x534e68(0x28a)]=_0x322c93;}),_0x4624e1['forEach']((_0x2aa070,_0x5ab434)=>{var _0x164cbc=_0x5425f0;_0x559a3c[_0x5ab434][_0x164cbc(0x2db)]=_0x2aa070;}),_0x46d721[_0x5425f0(0x23f)]((_0x3544fc,_0x810b0d)=>{var _0x280be0=_0x5425f0;_0x559a3c[_0x810b0d][_0x280be0(0x262)]=_0x3544fc;}),_0x2284d7[_0x5425f0(0x23f)]((_0x182895,_0x1768d8)=>{var _0x1a1203=_0x5425f0;_0x559a3c[_0x1768d8][_0x1a1203(0x204)]=_0x182895;}),_0x4492c4[_0x5425f0(0x23f)]((_0x3c077d,_0x172d48)=>{var _0xc5b256=_0x5425f0;_0x559a3c[_0x172d48][_0xc5b256(0x2c7)]=_0x3c077d;}),_0x382544[_0x5425f0(0x23f)]((_0x3db4b9,_0xb396f9)=>{var _0x257c58=_0x5425f0;_0x559a3c[_0xb396f9][_0x257c58(0x24b)]=_0x3db4b9;}),_0x4ae92e[_0x5425f0(0x23f)]((_0x4fb1f4,_0xabdd55)=>{var _0x1349c3=_0x5425f0;_0x559a3c[_0xabdd55][_0x1349c3(0x2dc)]=_0x4fb1f4;}),_0x5efc85[_0x5425f0(0x23f)]((_0x5af3e2,_0x400693)=>{var _0x37e626=_0x5425f0;_0x559a3c[_0x400693][_0x37e626(0x2b1)]=_0x5af3e2;}),_0x285eff['forEach']((_0x5180ce,_0x1ae591)=>{var _0xad675e=_0x5425f0;_0x559a3c[_0x1ae591][_0xad675e(0x1f3)]=_0x5180ce;}),_0x1b3f29[_0x5425f0(0x23f)]((_0x39f21d,_0xa707f4)=>{var _0x97723c=_0x5425f0;_0x559a3c[_0xa707f4][_0x97723c(0x277)]=_0x39f21d;}),_0x41f0c0[_0x5425f0(0x23f)]((_0x48e03b,_0x2bf09b)=>{var _0x3143f5=_0x5425f0;_0x559a3c[_0x2bf09b][_0x3143f5(0x286)]=_0x48e03b;}),_0x1d23ee[_0x5425f0(0x23f)]((_0xf21d52,_0x3b7b7a)=>{var _0x90bcae=_0x5425f0;_0x559a3c[_0x3b7b7a][_0x90bcae(0x25f)]=_0xf21d52;});const _0x14851a=await sales_finished[_0x5425f0(0x278)]({'invoice':_0x1bc4c7});_0x14851a[_0x5425f0(0x293)]='True';const _0xc91900=await _0x14851a['save'](),_0x336e2e=new sales_return_finished({'invoice':_0x1bc4c7,'customer':_0x14e5bc[_0x5425f0(0x274)]['customer'],'date':_0x3c3674,'warehouse_name':_0x2ee4cd,'room':_0x3eb1f5,'ToWarehouse':_0x13c8f3,'ToRoom':_0x250ef4,'return_sale_QA':_0x559a3c,'note':_0xda5e16,'warehouse_cat':_0x489c95}),_0x145641=await _0x336e2e['save'](),_0x24d3b5=await sales_return_finished[_0x5425f0(0x278)]({'invoice':_0x1bc4c7}),_0x56f737=await warehouse[_0x5425f0(0x278)]({'name':_0x13c8f3,'room':_0x250ef4});_0x24d3b5['return_sale_QA'][_0x5425f0(0x23f)](_0x472d3a=>{var _0x32b4f9=_0x5425f0,_0x500494=0x0;const _0x48cf97=_0x56f737[_0x32b4f9(0x21b)][_0x32b4f9(0x1cc)](_0x2b2d14=>{var _0xf464b8=_0x32b4f9;_0x2b2d14[_0xf464b8(0x235)]==_0x472d3a[_0xf464b8(0x235)]&&_0x2b2d14[_0xf464b8(0x25f)]==_0x472d3a['expiry_date']&&_0x2b2d14[_0xf464b8(0x286)]==_0x472d3a['production_date']&&_0x2b2d14[_0xf464b8(0x2b1)]==_0x472d3a['batch_code']&&(_0x2b2d14[_0xf464b8(0x1e8)]=parseInt(_0x2b2d14[_0xf464b8(0x1e8)])+parseInt(_0x472d3a[_0xf464b8(0x2c7)]),_0x500494++);});_0x500494=='0'&&(_0x56f737[_0x32b4f9(0x21b)]=_0x56f737['product_details']['concat']({'product_name':_0x472d3a[_0x32b4f9(0x235)],'product_stock':_0x472d3a[_0x32b4f9(0x2c7)],'primary_code':_0x472d3a['primary_code'],'secondary_code':_0x472d3a[_0x32b4f9(0x28a)],'product_code':_0x472d3a[_0x32b4f9(0x2db)],'batch_code':_0x472d3a[_0x32b4f9(0x2b1)],'maxPerUnit':_0x472d3a[_0x32b4f9(0x24b)],'production_date':_0x472d3a['production_date'],'expiry_date':_0x472d3a['expiry_date'],'secondary_unit':_0x472d3a[_0x32b4f9(0x1f3)],'unit':_0x472d3a[_0x32b4f9(0x277)],'maxProducts':_0x472d3a[_0x32b4f9(0x2dc)],'bay':_0x472d3a[_0x32b4f9(0x1d8)]}));}),await _0x56f737[_0x5425f0(0x245)]();const _0x8810df=new c_payment_data({'invoice':_0x1bc4c7,'customer':_0x14e5bc['body']['customer'],'reason':_0x5425f0(0x2da)});await _0x8810df['save']();const _0x1f8c49=await master_shop[_0x5425f0(0x1cf)](),_0x4bb559=await email_settings['findOne'](),_0x315168=await customer['findOne']({'name':_0x14e5bc['body'][_0x5425f0(0x2ac)]});_0x1f8c49[0x0][_0x5425f0(0x298)]==0x1?(right_currency=_0x1f8c49[0x0][_0x5425f0(0x27f)],left_currency=''):(right_currency='',left_currency=_0x1f8c49[0x0]['currency']);var _0x1645de=_0x23b7f1,_0x45b18b=_0x4492c4,_0xcfd8cf='',_0x79be55;for(_0x79be55 in _0x1645de){_0xcfd8cf+=_0x5425f0(0x2e3)+_0x5425f0(0x2dd)+_0x1645de[_0x79be55]+_0x5425f0(0x215)+_0x5425f0(0x2dd)+_0x45b18b[_0x79be55]+_0x5425f0(0x215)+_0x5425f0(0x1d3);}console['log'](_0x5425f0(0x2cf),_0xcfd8cf);let _0x23ce96=nodemailer[_0x5425f0(0x27a)]({'service':_0x5425f0(0x2ea),'auth':{'user':_0x4bb559[_0x5425f0(0x249)],'pass':_0x4bb559[_0x5425f0(0x24a)]}}),_0x19f907={'from':_0x4bb559['email'],'to':_0x315168[_0x5425f0(0x249)],'subject':_0x5425f0(0x24d),'attachments':[{'filename':'Logo.png','path':__dirname+_0x5425f0(0x1f0)+_0x5425f0(0x29a)+_0x1f8c49[0x0][_0x5425f0(0x221)],'cid':_0x5425f0(0x25a)}],'html':_0x5425f0(0x228)+_0x5425f0(0x1d5)+'</head><body>'+'<div>'+_0x5425f0(0x2ef)+_0x5425f0(0x2e9)+_0x5425f0(0x29b)+'</div>'+_0x5425f0(0x2e9)+_0x5425f0(0x28d)+_0x1f8c49[0x0][_0x5425f0(0x2a6)]+_0x5425f0(0x2c9)+'</div>'+'</div>'+_0x5425f0(0x25d)+_0x5425f0(0x2e9)+_0x5425f0(0x25c)+_0x5425f0(0x229)+_0x1bc4c7+'\x20'+_0x5425f0(0x2a1)+_0x5425f0(0x238)+_0x3c3674+'\x20'+'</span>'+_0x5425f0(0x276)+_0x5425f0(0x23d)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5425f0(0x2cb)+_0x5425f0(0x2e3)+_0x5425f0(0x21c)+_0x5425f0(0x280)+_0x5425f0(0x2b8)+_0x5425f0(0x2a4)+_0x5425f0(0x1d3)+'</thead>'+_0x5425f0(0x233)+'\x20'+_0xcfd8cf+'\x20'+_0x5425f0(0x203)+_0x5425f0(0x2bf)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x5425f0(0x27b)+_0x1f8c49[0x0][_0x5425f0(0x2a6)]+_0x5425f0(0x276)+'</div>'+'</div>'+_0x5425f0(0x251)};_0x23ce96[_0x5425f0(0x22a)](_0x19f907,function(_0x5c200d,_0x123211){var _0x547872=_0x5425f0;_0x5c200d?(console['log'](_0x5c200d),console[_0x547872(0x2d5)](_0x547872(0x222))):console[_0x547872(0x2d5)]('Email\x20sent\x20successfully');}),_0x14e5bc[_0x5425f0(0x271)](_0x5425f0(0x291),_0x5425f0(0x205)),_0x188406['redirect']('/all_sales_finished/view');}catch(_0x169428){_0x188406[_0x5425f0(0x1f9)](0xc8)[_0x5425f0(0x230)]({'message1':_0x169428[_0x5425f0(0x22e)]});}else{if(_0x14e5bc['body'][_0x5425f0(0x2c4)]=='GS')try{const {invoice:_0x25d408,date:_0x520f27,warehouse_name:_0x587bf5,product_name:_0x451cf2,primary_code:_0x45e41a,secondary_code:_0x38999b,product_code:_0x505947,sales_quantity:_0x1bd067,stocks:_0x420115,return_qty:_0x2b54f5,Room_name:_0x1d0629,to_warehouse_name:_0x164ecf,to_Room_name:_0x1635a4,note:_0x72bfee,level:_0xa103a8,isle:_0x25c3a,pallet:_0x288189,for_categorize:_0x127ac0}=_0x14e5bc[_0x5425f0(0x274)];if(typeof _0x451cf2==_0x5425f0(0x20a))var _0x23b7f1=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x235)]],_0x36a9a8=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x23c)]],_0x1a7b27=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x28a)]],_0x4624e1=[_0x14e5bc['body'][_0x5425f0(0x2db)]],_0x46d721=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x201)]],_0x4492c4=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2c7)]],_0x30a5fb=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x1d8)]],_0x382544=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x24b)]],_0x4ae92e=[_0x14e5bc['body'][_0x5425f0(0x2dc)]],_0x5efc85=[_0x14e5bc['body'][_0x5425f0(0x2b1)]],_0x285eff=[_0x14e5bc['body']['secondary_unit']],_0x1b3f29=[_0x14e5bc[_0x5425f0(0x274)]['unit']],_0x41f0c0=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x286)]],_0x1d23ee=[_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x25f)]];else var _0x23b7f1=[..._0x14e5bc[_0x5425f0(0x274)]['product_name']],_0x36a9a8=[..._0x14e5bc['body']['primary_code']],_0x1a7b27=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x28a)]],_0x4624e1=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2db)]],_0x46d721=[..._0x14e5bc['body'][_0x5425f0(0x201)]],_0x4492c4=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2c7)]],_0x30a5fb=[..._0x14e5bc['body'][_0x5425f0(0x1d8)]],_0x382544=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x24b)]],_0x4ae92e=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2dc)]],_0x5efc85=[..._0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2b1)]],_0x285eff=[..._0x14e5bc['body'][_0x5425f0(0x1f3)]],_0x1b3f29=[..._0x14e5bc[_0x5425f0(0x274)]['unit']],_0x41f0c0=[..._0x14e5bc[_0x5425f0(0x274)]['production_date']],_0x1d23ee=[..._0x14e5bc['body'][_0x5425f0(0x25f)]];const _0x512057=_0x23b7f1[_0x5425f0(0x1cc)](_0x38abd9=>{return _0x38abd9={'product_name':_0x38abd9};});_0x36a9a8[_0x5425f0(0x23f)]((_0x4d6de1,_0x1b7b7f)=>{var _0xc94eac=_0x5425f0;_0x512057[_0x1b7b7f][_0xc94eac(0x23c)]=_0x4d6de1;}),_0x1a7b27['forEach']((_0xca44de,_0x4c9ce2)=>{var _0x3f7f4b=_0x5425f0;_0x512057[_0x4c9ce2][_0x3f7f4b(0x28a)]=_0xca44de;}),_0x4624e1[_0x5425f0(0x23f)]((_0x833c08,_0x4d923e)=>{_0x512057[_0x4d923e]['product_code']=_0x833c08;}),_0x46d721[_0x5425f0(0x23f)]((_0x3ea9c0,_0x1d8bcd)=>{var _0x104e46=_0x5425f0;_0x512057[_0x1d8bcd][_0x104e46(0x262)]=_0x3ea9c0;}),_0x4492c4[_0x5425f0(0x23f)]((_0xe93c49,_0x4c5850)=>{var _0x248e4e=_0x5425f0;_0x512057[_0x4c5850][_0x248e4e(0x2c7)]=_0xe93c49;}),_0x30a5fb[_0x5425f0(0x23f)]((_0x3edc74,_0x1ce625)=>{var _0x5b67ab=_0x5425f0;_0x512057[_0x1ce625][_0x5b67ab(0x1d8)]=_0x3edc74;}),_0x382544[_0x5425f0(0x23f)]((_0x2fc9ba,_0x2dbeed)=>{var _0x2bdd53=_0x5425f0;_0x512057[_0x2dbeed][_0x2bdd53(0x24b)]=_0x2fc9ba;}),_0x4ae92e[_0x5425f0(0x23f)]((_0x105c0b,_0x425a12)=>{_0x512057[_0x425a12]['maxProducts']=_0x105c0b;}),_0x5efc85[_0x5425f0(0x23f)]((_0x53c411,_0x4af771)=>{var _0x448e74=_0x5425f0;_0x512057[_0x4af771][_0x448e74(0x2b1)]=_0x53c411;}),_0x285eff[_0x5425f0(0x23f)]((_0x298955,_0x29412f)=>{_0x512057[_0x29412f]['secondary_unit']=_0x298955;}),_0x1b3f29[_0x5425f0(0x23f)]((_0x4659c2,_0xafaf42)=>{var _0x19c1b6=_0x5425f0;_0x512057[_0xafaf42][_0x19c1b6(0x277)]=_0x4659c2;}),_0x41f0c0['forEach']((_0x29253a,_0x462d16)=>{_0x512057[_0x462d16]['production_date']=_0x29253a;}),_0x1d23ee['forEach']((_0x1a422f,_0x21495a)=>{var _0x303dc1=_0x5425f0;_0x512057[_0x21495a][_0x303dc1(0x25f)]=_0x1a422f;});var _0x2c27e1=0x0;_0x512057[_0x5425f0(0x23f)](_0x2fb3ca=>{var _0x97112e=_0x5425f0;(parseInt(_0x2fb3ca[_0x97112e(0x262)])<parseInt(_0x2fb3ca[_0x97112e(0x2c7)])||parseInt(_0x2fb3ca[_0x97112e(0x204)])<parseInt(_0x2fb3ca['return_qty'])&&parseInt(_0x2fb3ca['sale_qty'])>parseInt(_0x2fb3ca[_0x97112e(0x2c7)])||parseInt(_0x2fb3ca[_0x97112e(0x2c7)])==0x0)&&_0x2c27e1++;});if(_0x2c27e1!=0x0)return _0x14e5bc[_0x5425f0(0x271)]('errors',_0x5425f0(0x1e1)),_0x188406[_0x5425f0(0x265)](_0x5425f0(0x258));const _0x57c585=await sales_finished[_0x5425f0(0x278)]({'invoice':_0x25d408});_0x57c585[_0x5425f0(0x293)]=_0x5425f0(0x2b0);const _0x127f7f=await _0x57c585[_0x5425f0(0x245)](),_0x3e56ce=new sales_return_finished({'invoice':_0x25d408,'customer':_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2ac)],'date':_0x520f27,'warehouse_name':_0x587bf5,'room':_0x1d0629,'ToWarehouse':_0x164ecf,'ToRoom':_0x1635a4,'return_sale':_0x512057,'note':_0x72bfee,'warehouse_cat':_0x127ac0}),_0x453c65=await _0x3e56ce[_0x5425f0(0x245)](),_0x4c5059=await sales_return_finished['findOne']({'invoice':_0x25d408}),_0x1d0761=await warehouse[_0x5425f0(0x278)]({'name':_0x164ecf,'room':_0x1635a4,'warehouse_category':_0x5425f0(0x1f6)});_0x4c5059[_0x5425f0(0x2a2)][_0x5425f0(0x23f)](_0x59edf1=>{var _0x450f83=_0x5425f0,_0x3681a3=0x0;const _0x3ce1a8=_0x1d0761[_0x450f83(0x21b)][_0x450f83(0x1cc)](_0x1f73f1=>{var _0x17eee1=_0x450f83;_0x1f73f1[_0x17eee1(0x235)]==_0x59edf1['product_name']&&_0x1f73f1[_0x17eee1(0x1d8)]==_0x59edf1[_0x17eee1(0x1d8)]&&_0x1f73f1['expiry_date']==_0x59edf1[_0x17eee1(0x25f)]&&_0x1f73f1[_0x17eee1(0x286)]==_0x59edf1[_0x17eee1(0x286)]&&_0x1f73f1[_0x17eee1(0x2b1)]==_0x59edf1['batch_code']&&(_0x1f73f1['product_stock']=parseInt(_0x1f73f1[_0x17eee1(0x1e8)])+parseInt(_0x59edf1[_0x17eee1(0x2c7)]),_0x3681a3++);});_0x3681a3=='0'&&(_0x1d0761['product_details']=_0x1d0761['product_details'][_0x450f83(0x2d2)]({'product_name':_0x59edf1[_0x450f83(0x235)],'product_stock':_0x59edf1[_0x450f83(0x2c7)],'primary_code':_0x59edf1[_0x450f83(0x23c)],'secondary_code':_0x59edf1['secondary_code'],'product_code':_0x59edf1[_0x450f83(0x2db)],'bay':_0x59edf1[_0x450f83(0x1d8)],'batch_code':_0x59edf1['batch_code'],'maxPerUnit':_0x59edf1[_0x450f83(0x24b)],'production_date':_0x59edf1[_0x450f83(0x286)],'expiry_date':_0x59edf1[_0x450f83(0x25f)],'secondary_unit':_0x59edf1['secondary_unit'],'unit':_0x59edf1[_0x450f83(0x277)],'maxProducts':_0x59edf1[_0x450f83(0x2dc)]}));}),await _0x1d0761[_0x5425f0(0x245)](),console[_0x5425f0(0x2d5)](_0x14e5bc[_0x5425f0(0x274)]);const _0x54981c=new c_payment_data({'invoice':_0x25d408,'customer':_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2ac)],'reason':_0x5425f0(0x2da)});await _0x54981c[_0x5425f0(0x245)]();const _0x4a2d3e=await master_shop['find']();console[_0x5425f0(0x2d5)](_0x5425f0(0x281),_0x4a2d3e[0x0][_0x5425f0(0x221)]);const _0x1d4fb8=await email_settings[_0x5425f0(0x278)](),_0x2caa9f=await customer[_0x5425f0(0x278)]({'name':_0x14e5bc[_0x5425f0(0x274)][_0x5425f0(0x2ac)]});console[_0x5425f0(0x2d5)](_0x5425f0(0x2b3),_0x2caa9f);_0x4a2d3e[0x0][_0x5425f0(0x298)]==0x1?(right_currency=_0x4a2d3e[0x0][_0x5425f0(0x27f)],left_currency=''):(right_currency='',left_currency=_0x4a2d3e[0x0][_0x5425f0(0x27f)]);var _0x1645de=_0x23b7f1,_0x45b18b=_0x4492c4,_0xcfd8cf='',_0x79be55;for(_0x79be55 in _0x1645de){_0xcfd8cf+=_0x5425f0(0x2e3)+_0x5425f0(0x2dd)+_0x1645de[_0x79be55]+_0x5425f0(0x215)+_0x5425f0(0x2dd)+_0x45b18b[_0x79be55]+_0x5425f0(0x215)+_0x5425f0(0x1d3);}console['log'](_0x5425f0(0x2cf),_0xcfd8cf);let _0x39f56f=nodemailer[_0x5425f0(0x27a)]({'service':_0x5425f0(0x2ea),'auth':{'user':_0x1d4fb8[_0x5425f0(0x249)],'pass':_0x1d4fb8[_0x5425f0(0x24a)]}}),_0x3a40cf={'from':_0x1d4fb8[_0x5425f0(0x249)],'to':_0x2caa9f['email'],'subject':_0x5425f0(0x24d),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x5425f0(0x29a)+_0x4a2d3e[0x0]['image'],'cid':_0x5425f0(0x25a)}],'html':_0x5425f0(0x228)+_0x5425f0(0x1d5)+'</head><body>'+'<div>'+_0x5425f0(0x2ef)+_0x5425f0(0x2e9)+_0x5425f0(0x29b)+_0x5425f0(0x23d)+_0x5425f0(0x2e9)+_0x5425f0(0x28d)+_0x4a2d3e[0x0][_0x5425f0(0x2a6)]+_0x5425f0(0x2c9)+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x5425f0(0x2e9)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x5425f0(0x229)+_0x25d408+'\x20'+_0x5425f0(0x2a1)+_0x5425f0(0x238)+_0x520f27+'\x20'+'</span>'+_0x5425f0(0x276)+_0x5425f0(0x23d)+_0x5425f0(0x246)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5425f0(0x2e3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x5425f0(0x280)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x5425f0(0x2a4)+_0x5425f0(0x1d3)+_0x5425f0(0x2df)+_0x5425f0(0x233)+'\x20'+_0xcfd8cf+'\x20'+'</tbody>'+'</table>'+_0x5425f0(0x2e9)+_0x5425f0(0x2b7)+_0x5425f0(0x27b)+_0x4a2d3e[0x0][_0x5425f0(0x2a6)]+'</h5>'+_0x5425f0(0x23d)+_0x5425f0(0x23d)+_0x5425f0(0x251)};_0x39f56f[_0x5425f0(0x22a)](_0x3a40cf,function(_0x36e535,_0x1d43d6){var _0x37f581=_0x5425f0;_0x36e535?(console[_0x37f581(0x2d5)](_0x36e535),console['log']('Error\x20Occurs')):console[_0x37f581(0x2d5)](_0x37f581(0x1dc));}),_0x14e5bc['flash'](_0x5425f0(0x291),_0x5425f0(0x205)),_0x188406[_0x5425f0(0x265)](_0x5425f0(0x2b5));}catch(_0x5bd456){console[_0x5425f0(0x2d5)](_0x5bd456),_0x188406['status'](0xc8)['json']({'message1':_0x5bd456[_0x5425f0(0x22e)]});}}}),router['get']('/barcode/:id',auth,async(_0x55c1a5,_0x2a1393)=>{var _0x15be87=a0_0x5c4fd5;try{const {username:_0x199846,email:_0x1d4913,role:_0x1336f6}=_0x55c1a5[_0x15be87(0x26d)],_0x1c57fc=_0x55c1a5[_0x15be87(0x26d)],_0x20ae9a=await profile[_0x15be87(0x278)]({'email':_0x1c57fc[_0x15be87(0x249)]}),_0x50442d=await master_shop[_0x15be87(0x1cf)]();console['log']('barcode\x20Product\x20master',_0x50442d);const _0x182b19=_0x55c1a5[_0x15be87(0x2b4)]['id'],_0x4b330c=await sales['findById'](_0x182b19);console[_0x15be87(0x2d5)](_0x15be87(0x212),_0x4b330c);if(_0x50442d[0x0]['language']==_0x15be87(0x206))var _0xa1669e=users['English'];else{if(_0x50442d[0x0][_0x15be87(0x1d2)]==_0x15be87(0x27d))var _0xa1669e=users[_0x15be87(0x27d)];else{if(_0x50442d[0x0][_0x15be87(0x1d2)]==_0x15be87(0x1fd))var _0xa1669e=users[_0x15be87(0x1fd)];else{if(_0x50442d[0x0][_0x15be87(0x1d2)]==_0x15be87(0x22b))var _0xa1669e=users['Spanish'];else{if(_0x50442d[0x0][_0x15be87(0x1d2)]=='French')var _0xa1669e=users[_0x15be87(0x23e)];else{if(_0x50442d[0x0][_0x15be87(0x1d2)]==_0x15be87(0x243))var _0xa1669e=users['Portuguese'];else{if(_0x50442d[0x0][_0x15be87(0x1d2)]==_0x15be87(0x252))var _0xa1669e=users[_0x15be87(0x252)];else{if(_0x50442d[0x0][_0x15be87(0x1d2)]==_0x15be87(0x264))var _0xa1669e=users[_0x15be87(0x2c3)];}}}}}}}_0x2a1393['render'](_0x15be87(0x260),{'success':_0x55c1a5['flash'](_0x15be87(0x291)),'errors':_0x55c1a5[_0x15be87(0x271)](_0x15be87(0x275)),'role':_0x1c57fc,'profile':_0x20ae9a,'alldata':_0x4b330c,'master_shop':_0x50442d,'language':_0xa1669e});}catch(_0x543ca9){console[_0x15be87(0x2d5)](_0x543ca9);}}),router[a0_0x5c4fd5(0x2e8)](a0_0x5c4fd5(0x2d8),async(_0x262db4,_0x5c71fd)=>{var _0x3c2a60=a0_0x5c4fd5;const {product_code:_0x4d4ada,warehouse_name:_0x3c66a1,rooms_data:_0x185caa,Roomslist:_0x1f18a6,sales_category:_0x22c4a6}=_0x262db4['body'],_0x5a4efe=_0x1f18a6[_0x3c2a60(0x256)](','),_0x326f87=[];async function _0x4d2b83(_0x2cc2d7){var _0x6d407a=_0x3c2a60;const _0x512ccd=await warehouse[_0x6d407a(0x2d9)]([{'$match':{'name':_0x3c66a1,'room':_0x2cc2d7}},{'$unwind':_0x6d407a(0x208)},{'$match':{'product_details.primary_code':_0x4d4ada}},{'$group':{'_id':_0x6d407a(0x27c),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x6d407a(0x28b)},'primary_code':{'$first':_0x6d407a(0x2b9)},'secondary_code':{'$first':_0x6d407a(0x1e6)},'product_code':{'$first':_0x6d407a(0x2d6)},'level':{'$first':_0x6d407a(0x290)},'bay':{'$first':'$product_details.bay'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x6d407a(0x1f5)},'unit':{'$first':_0x6d407a(0x1ef)},'secondary_unit':{'$first':_0x6d407a(0x1fc)},'storage':{'$first':_0x6d407a(0x257)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x6d407a(0x285)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x6d407a(0x237)},'batch_code':{'$first':_0x6d407a(0x20e)},'product_cat':{'$first':_0x6d407a(0x1ea)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x6d407a(0x2ca)},'invoice':{'$first':_0x6d407a(0x21a)},'uuid':{'$first':_0x6d407a(0x2e6)},'gross_price':{'$first':_0x6d407a(0x20b)},'sales_category':{'$first':'$product_details.sales_category'}}}]),_0x4daba0=await warehouse[_0x6d407a(0x2d9)]([{'$match':{'name':_0x3c66a1,'room':_0x2cc2d7}},{'$unwind':_0x6d407a(0x208)},{'$match':{'product_details.secondary_code':_0x4d4ada}},{'$group':{'_id':_0x6d407a(0x27c),'name':{'$first':_0x6d407a(0x1e0)},'product_stock':{'$first':_0x6d407a(0x28b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x6d407a(0x1e6)},'product_code':{'$first':_0x6d407a(0x2d6)},'level':{'$first':_0x6d407a(0x1f8)},'isle':{'$first':_0x6d407a(0x294)},'type':{'$first':_0x6d407a(0x21e)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x6d407a(0x1ef)},'secondary_unit':{'$first':_0x6d407a(0x1fc)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x6d407a(0x285)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x6d407a(0x237)},'batch_code':{'$first':_0x6d407a(0x20e)},'product_cat':{'$first':_0x6d407a(0x1ea)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x6d407a(0x2ca)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x6d407a(0x2e6)},'gross_price':{'$first':_0x6d407a(0x20b)},'sales_category':{'$first':_0x6d407a(0x24f)}}}]);if(_0x512ccd[_0x6d407a(0x2de)]>0x0)_0x326f87[_0x6d407a(0x20d)](_0x512ccd);else _0x4daba0[_0x6d407a(0x2de)]>0x0&&_0x326f87[_0x6d407a(0x20d)](_0x4daba0);}const _0x458162=_0x5a4efe['map'](_0x1d0995=>_0x4d2b83(_0x1d0995));await Promise[_0x3c2a60(0x1d1)](_0x458162),_0x5c71fd['json'](_0x326f87);}),router[a0_0x5c4fd5(0x2e8)](a0_0x5c4fd5(0x2ab),async(_0x551003,_0x5ab69f)=>{var _0x4e0be8=a0_0x5c4fd5;const {product_code:_0x220dbf,warehouse_name:_0x35464f,rooms_data:_0xf39262,Roomslist:_0x4bcfa8,sales_category:_0x550898}=_0x551003['body'],_0x51ce23=_0x4bcfa8[_0x4e0be8(0x256)](','),_0x50ea33=[];async function _0x5dae42(_0x362978){var _0x353e4a=_0x4e0be8;const _0x2c3f82=await warehouse[_0x353e4a(0x2d9)]([{'$match':{'name':_0x35464f,'room':_0x362978}},{'$unwind':_0x353e4a(0x208)},{'$match':{'product_details.primary_code':_0x220dbf,'product_details.sales_category':_0x550898,'product_details.type_products':_0x353e4a(0x2d5)}},{'$group':{'_id':_0x353e4a(0x27c),'name':{'$first':_0x353e4a(0x1e0)},'product_stock':{'$first':_0x353e4a(0x28b)},'primary_code':{'$first':_0x353e4a(0x2b9)},'secondary_code':{'$first':_0x353e4a(0x1e6)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.level'},'bay':{'$first':'$product_details.bay'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x353e4a(0x1ef)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x353e4a(0x257)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x353e4a(0x237)},'batch_code':{'$first':_0x353e4a(0x20e)},'product_cat':{'$first':_0x353e4a(0x1ea)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x353e4a(0x2ca)},'invoice':{'$first':_0x353e4a(0x21a)},'uuid':{'$first':_0x353e4a(0x2e6)},'gross_price':{'$first':_0x353e4a(0x20b)},'sales_category':{'$first':_0x353e4a(0x24f)},'type_products':{'$first':_0x353e4a(0x2af)}}}]);console[_0x353e4a(0x2d5)](_0x353e4a(0x2d5)+_0x353e4a(0x211)+_0x220dbf+'\x20<>\x20'+_0x550898);const _0x2870f8=await warehouse[_0x353e4a(0x2d9)]([{'$match':{'name':_0x35464f,'room':_0x362978}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x220dbf,'product_details.sales_category':_0x550898,'product_details.type_products':'log'}},{'$group':{'_id':_0x353e4a(0x27c),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x353e4a(0x28b)},'primary_code':{'$first':_0x353e4a(0x2b9)},'secondary_code':{'$first':_0x353e4a(0x1e6)},'product_code':{'$first':_0x353e4a(0x2d6)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x353e4a(0x1f5)},'unit':{'$first':_0x353e4a(0x1ef)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x353e4a(0x257)},'rack':{'$first':_0x353e4a(0x272)},'expiry_date':{'$first':_0x353e4a(0x285)},'production_date':{'$first':_0x353e4a(0x26f)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x353e4a(0x20e)},'product_cat':{'$first':_0x353e4a(0x1ea)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x353e4a(0x2ca)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x353e4a(0x2e6)},'gross_price':{'$first':_0x353e4a(0x20b)},'sales_category':{'$first':_0x353e4a(0x24f)},'type_products':{'$first':_0x353e4a(0x2af)}}}]);if(_0x2c3f82['length']>0x0)_0x50ea33['push'](_0x2c3f82);else _0x2870f8[_0x353e4a(0x2de)]>0x0&&_0x50ea33['push'](_0x2870f8);}const _0x5a2fe8=_0x51ce23['map'](_0x756000=>_0x5dae42(_0x756000));await Promise['all'](_0x5a2fe8),_0x5ab69f[_0x4e0be8(0x230)](_0x50ea33);}),module[a0_0x5c4fd5(0x240)]=router;