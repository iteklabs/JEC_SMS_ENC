var a0_0x72e872=a0_0x5d06;(function(_0x5f3214,_0x51ca54){var _0x4b0220=a0_0x5d06,_0x3c53dd=_0x5f3214();while(!![]){try{var _0x497ea0=-parseInt(_0x4b0220(0x193))/0x1+-parseInt(_0x4b0220(0x11c))/0x2*(parseInt(_0x4b0220(0x197))/0x3)+-parseInt(_0x4b0220(0x104))/0x4+-parseInt(_0x4b0220(0x162))/0x5+parseInt(_0x4b0220(0x1c4))/0x6*(parseInt(_0x4b0220(0x1d2))/0x7)+-parseInt(_0x4b0220(0x10c))/0x8+parseInt(_0x4b0220(0xfe))/0x9;if(_0x497ea0===_0x51ca54)break;else _0x3c53dd['push'](_0x3c53dd['shift']());}catch(_0x411132){_0x3c53dd['push'](_0x3c53dd['shift']());}}}(a0_0x389a,0x33d59));const express=require(a0_0x72e872(0x19d)),app=express(),router=express[a0_0x72e872(0x17f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x72e872(0x138)),auth=require(a0_0x72e872(0xf9)),nodemailer=require(a0_0x72e872(0x1bc)),users=require('../public/language/languages.json');router[a0_0x72e872(0x1d3)](a0_0x72e872(0x167),auth,async(_0x146437,_0x45b7e0)=>{var _0x4d7797=a0_0x72e872;try{const {username:_0x595f80,email:_0x377d6e,role:_0x394ad5}=_0x146437[_0x4d7797(0x114)],_0x42f66d=_0x146437['user'],_0x3f49c3=await profile['findOne']({'email':_0x42f66d[_0x4d7797(0x18f)]}),_0x52cfe8=await master_shop[_0x4d7797(0x176)]();let _0x3a30a1;if(_0x42f66d[_0x4d7797(0x1a8)]==_0x4d7797(0xfc)){const _0xfbcf2a=await staff[_0x4d7797(0x1c5)]({'email':_0x42f66d[_0x4d7797(0x18f)]});_0x3a30a1=await sales_finished[_0x4d7797(0x19b)]([{'$match':{'typeOfProducts':_0x4d7797(0x19a)}},{'$unwind':_0x4d7797(0x115)},{'$group':{'_id':_0x4d7797(0x131),'invoice':{'$first':_0x4d7797(0x142)},'customers':{'$first':'$customer'},'date':{'$first':_0x4d7797(0x12c)},'warehouse_name':{'$first':_0x4d7797(0x149)},'sale_product':{'$push':_0x4d7797(0x115)},'note':{'$first':'$note'},'return_data':{'$first':_0x4d7797(0x1a5)},'customers_docs':{'$first':_0x4d7797(0x187)},'total_saleproduct_quantity':{'$sum':_0x4d7797(0x188)},'level':{'$addToSet':_0x4d7797(0x161)},'isle':{'$addToSet':_0x4d7797(0x11b)},'type':{'$addToSet':_0x4d7797(0x1a6)},'pallet':{'$addToSet':_0x4d7797(0xc5)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x3a30a1=await sales_finished[_0x4d7797(0x19b)]([{'$match':{'typeOfProducts':_0x4d7797(0x19a)}},{'$unwind':_0x4d7797(0x115)},{'$group':{'_id':'$_id','invoice':{'$first':_0x4d7797(0x142)},'customers':{'$first':'$customer'},'date':{'$first':_0x4d7797(0x12c)},'warehouse_name':{'$first':_0x4d7797(0x149)},'sale_product':{'$push':_0x4d7797(0x115)},'note':{'$first':_0x4d7797(0x116)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x4d7797(0x187)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x4d7797(0x161)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x4d7797(0x1a6)},'pallet':{'$addToSet':_0x4d7797(0xc5)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x52cfe8[0x0][_0x4d7797(0x12a)]==_0x4d7797(0x113)){var _0x21da64=users[_0x4d7797(0x137)];console[_0x4d7797(0x1b7)](_0x21da64);}else{if(_0x52cfe8[0x0][_0x4d7797(0x12a)]==_0x4d7797(0x181))var _0x21da64=users['Hindi'];else{if(_0x52cfe8[0x0]['language']=='German')var _0x21da64=users[_0x4d7797(0x184)];else{if(_0x52cfe8[0x0][_0x4d7797(0x12a)]==_0x4d7797(0x1a3))var _0x21da64=users[_0x4d7797(0x1a3)];else{if(_0x52cfe8[0x0]['language']=='French')var _0x21da64=users[_0x4d7797(0xf3)];else{if(_0x52cfe8[0x0]['language']=='Portuguese\x20(BR)')var _0x21da64=users['Portuguese'];else{if(_0x52cfe8[0x0][_0x4d7797(0x12a)]=='Chinese')var _0x21da64=users[_0x4d7797(0x1cf)];else{if(_0x52cfe8[0x0][_0x4d7797(0x12a)]=='Arabic\x20(ae)')var _0x21da64=users[_0x4d7797(0x10a)];}}}}}}}_0x45b7e0[_0x4d7797(0x1a2)](_0x4d7797(0xde),{'success':_0x146437[_0x4d7797(0x1a9)]('success'),'errors':_0x146437[_0x4d7797(0x1a9)](_0x4d7797(0x15e)),'sales':_0x3a30a1,'profile':_0x3f49c3,'role':_0x42f66d,'master_shop':_0x52cfe8,'language':_0x21da64});}catch(_0x29ea04){console['log'](_0x29ea04);}}),router['get'](a0_0x72e872(0xcf),auth,async(_0x428246,_0x38cc2c)=>{var _0x244826=a0_0x72e872;try{const {username:_0x517991,email:_0x5e579e,role:_0x5b3e48}=_0x428246[_0x244826(0x114)],_0x18ae64=_0x428246[_0x244826(0x114)],_0x291a68=await profile[_0x244826(0x1c5)]({'email':_0x18ae64[_0x244826(0x18f)]}),_0x382b22=await master_shop['find']();let _0x2ee62b;if(_0x18ae64[_0x244826(0x1a8)]==_0x244826(0xfc)){const _0x15461f=await staff[_0x244826(0x1c5)]({'email':_0x18ae64[_0x244826(0x18f)]});_0x2ee62b=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x244826(0x103)}},{'$unwind':_0x244826(0x115)},{'$group':{'_id':'$_id','invoice':{'$first':_0x244826(0x142)},'customers':{'$first':_0x244826(0x122)},'date':{'$first':_0x244826(0x12c)},'warehouse_name':{'$first':_0x244826(0x149)},'sale_product':{'$push':_0x244826(0x115)},'note':{'$first':_0x244826(0x116)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x244826(0x188)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x244826(0x11b)},'type':{'$addToSet':_0x244826(0x1a6)},'pallet':{'$addToSet':_0x244826(0xc5)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x2ee62b=await sales_finished[_0x244826(0x19b)]([{'$match':{'typeOfProducts':'logs'}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x244826(0x131),'invoice':{'$first':_0x244826(0x142)},'customers':{'$first':_0x244826(0x122)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x244826(0x149)},'sale_product':{'$push':_0x244826(0x115)},'note':{'$first':_0x244826(0x116)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x244826(0x187)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x244826(0x161)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x244826(0xc5)},'finalize':{'$first':_0x244826(0x128)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x382b22[0x0][_0x244826(0x12a)]==_0x244826(0x113)){var _0x152b2e=users[_0x244826(0x137)];console[_0x244826(0x1b7)](_0x152b2e);}else{if(_0x382b22[0x0][_0x244826(0x12a)]==_0x244826(0x181))var _0x152b2e=users[_0x244826(0x181)];else{if(_0x382b22[0x0]['language']==_0x244826(0x184))var _0x152b2e=users[_0x244826(0x184)];else{if(_0x382b22[0x0]['language']==_0x244826(0x1a3))var _0x152b2e=users[_0x244826(0x1a3)];else{if(_0x382b22[0x0][_0x244826(0x12a)]==_0x244826(0xf3))var _0x152b2e=users['French'];else{if(_0x382b22[0x0][_0x244826(0x12a)]=='Portuguese\x20(BR)')var _0x152b2e=users[_0x244826(0x146)];else{if(_0x382b22[0x0][_0x244826(0x12a)]=='Chinese')var _0x152b2e=users['Chinese'];else{if(_0x382b22[0x0]['language']==_0x244826(0x11e))var _0x152b2e=users[_0x244826(0x10a)];}}}}}}}_0x38cc2c[_0x244826(0x1a2)](_0x244826(0xc1),{'success':_0x428246['flash'](_0x244826(0xfd)),'errors':_0x428246[_0x244826(0x1a9)]('errors'),'sales':_0x2ee62b,'profile':_0x291a68,'role':_0x18ae64,'master_shop':_0x382b22,'language':_0x152b2e});}catch(_0x3fff48){console[_0x244826(0x1b7)](_0x3fff48);}});async function getRandom8DigitNumber(){var _0x5a9485=a0_0x72e872;const _0x3cfd99=0x989680,_0x533e12=0x5f5e0ff,_0x91a636=Math[_0x5a9485(0xf5)](Math[_0x5a9485(0xf0)]()*(_0x533e12-_0x3cfd99+0x1))+_0x3cfd99;var _0x11a373;const _0x37212c=await sales_finished[_0x5a9485(0x1c5)]({'invoice':_0x5a9485(0x108)+_0x91a636});return _0x37212c&&_0x37212c['length']>0x0?_0x11a373=_0x5a9485(0x108)+_0x91a636:_0x11a373=_0x5a9485(0x108)+_0x91a636,_0x11a373;}router[a0_0x72e872(0x1d3)](a0_0x72e872(0x1ae),auth,async(_0x44e7c7,_0x3d158f)=>{var _0x377170=a0_0x72e872;try{const {username:_0x49cb47,email:_0x5e7121,role:_0x5242aa}=_0x44e7c7[_0x377170(0x114)],_0x3ebd55=_0x44e7c7[_0x377170(0x114)],_0x3b60d9=await profile[_0x377170(0x1c5)]({'email':_0x3ebd55[_0x377170(0x18f)]}),_0x27fa29=await master_shop[_0x377170(0x176)](),_0x348f7c=await customer['find']({});let _0x4c7ee8;if(_0x3ebd55['role']=='staff'){const _0xa3a686=await staff[_0x377170(0x1c5)]({'email':_0x3ebd55[_0x377170(0x18f)]});_0x4c7ee8=await warehouse[_0x377170(0x19b)]([{'$match':{'status':'Enabled','name':_0xa3a686[_0x377170(0x1cb)]}},{'$group':{'_id':_0x377170(0x168),'name':{'$first':_0x377170(0x168)}}},{'$sort':{'name':0x1}}]);}else _0x4c7ee8=await warehouse['aggregate']([{'$match':{'status':_0x377170(0x175)}},{'$group':{'_id':_0x377170(0x168),'name':{'$first':_0x377170(0x168)}}},{'$sort':{'name':0x1}}]);const _0x51f19d=await product[_0x377170(0x176)]({});var _0x817c37=['Ambient',_0x377170(0xed)];const _0x385b9d=await sales_finished[_0x377170(0x176)]({}),_0x1111c7=_0x385b9d['length']+0x1,_0x25f01a=_0x377170(0x108)+_0x1111c7[_0x377170(0xc6)]()[_0x377170(0x179)](0x5,'0');if(_0x27fa29[0x0][_0x377170(0x12a)]==_0x377170(0x113)){var _0x5787b1=users[_0x377170(0x137)];console[_0x377170(0x1b7)](_0x5787b1);}else{if(_0x27fa29[0x0][_0x377170(0x12a)]==_0x377170(0x181))var _0x5787b1=users['Hindi'];else{if(_0x27fa29[0x0][_0x377170(0x12a)]=='German')var _0x5787b1=users[_0x377170(0x184)];else{if(_0x27fa29[0x0][_0x377170(0x12a)]=='Spanish')var _0x5787b1=users['Spanish'];else{if(_0x27fa29[0x0]['language']==_0x377170(0xf3))var _0x5787b1=users[_0x377170(0xf3)];else{if(_0x27fa29[0x0]['language']=='Portuguese\x20(BR)')var _0x5787b1=users[_0x377170(0x146)];else{if(_0x27fa29[0x0]['language']==_0x377170(0x1cf))var _0x5787b1=users[_0x377170(0x1cf)];else{if(_0x27fa29[0x0][_0x377170(0x12a)]==_0x377170(0x11e))var _0x5787b1=users['Arabic'];}}}}}}}const _0x317d83=getRandom8DigitNumber();_0x317d83['then'](_0x420d98=>{var _0x51ff21=_0x377170;_0x3d158f[_0x51ff21(0x1a2)](_0x51ff21(0x1ca),{'success':_0x44e7c7[_0x51ff21(0x1a9)](_0x51ff21(0xfd)),'errors':_0x44e7c7[_0x51ff21(0x1a9)]('errors'),'role':_0x3ebd55,'profile':_0x3b60d9,'customer':_0x348f7c,'warehouse':_0x4c7ee8,'product':_0x51f19d,'invoice':_0x420d98,'master_shop':_0x27fa29,'language':_0x5787b1,'rooms_data':_0x817c37});})[_0x377170(0x144)](_0x893ce=>{var _0x1aee5a=_0x377170;_0x44e7c7[_0x1aee5a(0x1a9)](_0x1aee5a(0x15e),_0x1aee5a(0x17c)),_0x3d158f[_0x1aee5a(0x174)](_0x1aee5a(0x169));});}catch(_0x19b431){console[_0x377170(0x1b7)](_0x19b431);}}),router[a0_0x72e872(0x1d3)]('/view/add_sales_logs',auth,async(_0x11b260,_0x212a8d)=>{var _0x2ad06d=a0_0x72e872;try{const {username:_0x48b3af,email:_0x449c48,role:_0x55a555}=_0x11b260[_0x2ad06d(0x114)],_0x777697=_0x11b260[_0x2ad06d(0x114)],_0x1d7424=await profile[_0x2ad06d(0x1c5)]({'email':_0x777697[_0x2ad06d(0x18f)]}),_0x5dd084=await master_shop['find'](),_0x5718b6=await customer[_0x2ad06d(0x176)]({});let _0x3dc874;if(_0x777697[_0x2ad06d(0x1a8)]==_0x2ad06d(0xfc)){const _0x32df53=await staff[_0x2ad06d(0x1c5)]({'email':_0x777697[_0x2ad06d(0x18f)]});_0x3dc874=await warehouse[_0x2ad06d(0x19b)]([{'$match':{'status':_0x2ad06d(0x175),'name':_0x32df53[_0x2ad06d(0x1cb)]}},{'$group':{'_id':'$name','name':{'$first':_0x2ad06d(0x168)}}},{'$sort':{'name':0x1}}]);}else _0x3dc874=await warehouse[_0x2ad06d(0x19b)]([{'$match':{'status':_0x2ad06d(0x175)}},{'$group':{'_id':_0x2ad06d(0x168),'name':{'$first':_0x2ad06d(0x168)}}},{'$sort':{'name':0x1}}]);const _0x44f6a1=await product['find']({});var _0x3d1541=[_0x2ad06d(0xdc),_0x2ad06d(0xed)];const _0x836de=await sales_finished[_0x2ad06d(0x176)]({}),_0x2ccf16=_0x836de[_0x2ad06d(0x1b4)]+0x1,_0x2e5e45='OUTF-'+_0x2ccf16[_0x2ad06d(0xc6)]()['padStart'](0x5,'0');if(_0x5dd084[0x0]['language']==_0x2ad06d(0x113)){var _0x5c7f1f=users['English'];console[_0x2ad06d(0x1b7)](_0x5c7f1f);}else{if(_0x5dd084[0x0][_0x2ad06d(0x12a)]=='Hindi')var _0x5c7f1f=users['Hindi'];else{if(_0x5dd084[0x0]['language']==_0x2ad06d(0x184))var _0x5c7f1f=users['German'];else{if(_0x5dd084[0x0][_0x2ad06d(0x12a)]=='Spanish')var _0x5c7f1f=users['Spanish'];else{if(_0x5dd084[0x0][_0x2ad06d(0x12a)]=='French')var _0x5c7f1f=users[_0x2ad06d(0xf3)];else{if(_0x5dd084[0x0][_0x2ad06d(0x12a)]==_0x2ad06d(0x1d1))var _0x5c7f1f=users[_0x2ad06d(0x146)];else{if(_0x5dd084[0x0][_0x2ad06d(0x12a)]==_0x2ad06d(0x1cf))var _0x5c7f1f=users['Chinese'];else{if(_0x5dd084[0x0][_0x2ad06d(0x12a)]=='Arabic\x20(ae)')var _0x5c7f1f=users[_0x2ad06d(0x10a)];}}}}}}}const _0x219e2f=getRandom8DigitNumber();_0x219e2f[_0x2ad06d(0x1b0)](_0x3e48f3=>{var _0x431105=_0x2ad06d;_0x212a8d[_0x431105(0x1a2)](_0x431105(0x109),{'success':_0x11b260[_0x431105(0x1a9)]('success'),'errors':_0x11b260['flash']('errors'),'role':_0x777697,'profile':_0x1d7424,'customer':_0x5718b6,'warehouse':_0x3dc874,'product':_0x44f6a1,'invoice':_0x3e48f3,'master_shop':_0x5dd084,'language':_0x5c7f1f,'rooms_data':_0x3d1541});})[_0x2ad06d(0x144)](_0x2c5567=>{var _0x435162=_0x2ad06d;_0x11b260[_0x435162(0x1a9)](_0x435162(0x15e),_0x435162(0x17c)),_0x212a8d[_0x435162(0x174)]('/all_sales_finished/view');});}catch(_0x1771c0){console['log'](_0x1771c0);}}),router[a0_0x72e872(0x17d)](a0_0x72e872(0x1a7),auth,async(_0x487516,_0x17ded0)=>{var _0x5ee695=a0_0x72e872;try{const {invoice:_0x95d0b2,date:_0x1028a7,warehouse_name:_0x337af1,product_name:_0x163686,note:_0x607306,room:_0xb92949,primary_code:_0x2a1d5d,secondary_code:_0x52376e,prod_code:_0x18fe03,SCRN:_0x399c42,ReqBy:_0x46f4a5,dateofreq:_0x2cb46e,PO_number:_0x344c5d,typeservicesData:_0x13c0e4,typevehicle:_0x3d29af,destination:_0x1e6b50,deliverydate:_0x323525,driver:_0x3925f8,plate:_0x6ee2e1,van:_0x766c99,DRSI:_0x2a1561,TSU:_0x4442d3,TFU:_0x282484,mode_transpo:_0x44bfb6,name_driver:_0x385372,type_of_products:_0x73880}=_0x487516[_0x5ee695(0x1c7)];if(typeof _0x163686==_0x5ee695(0x13f))var _0xe0747a=[_0x487516['body'][_0x5ee695(0xd8)]],_0x100e5e=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x18c)]],_0x46329d=[_0x487516[_0x5ee695(0x1c7)]['carton']],_0x4815c1=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x1ab)]],_0x3adb2f=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0xcd)]],_0x5b94f0=[_0x487516[_0x5ee695(0x1c7)]['prod_code']],_0x25b251=[_0x487516['body']['level2']],_0x26caae=[_0x487516['body'][_0x5ee695(0x178)]],_0x269348=[_0x487516['body'][_0x5ee695(0x1b5)]],_0x309c1f=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x1d5)]],_0x2edb8b=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x13c)]],_0x38aad3=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x1d0)]],_0x494b30=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x16d)]],_0x3bb0d5=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x183)]],_0x53cd95=[_0x487516['body'][_0x5ee695(0x198)]],_0x5a135a=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x118)]],_0x65679e=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x1c2)]],_0x269c0b=[_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x19c)]],_0x30f080=[_0x487516[_0x5ee695(0x1c7)]['gross_price']];else var _0xe0747a=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0xd8)]],_0x100e5e=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x18c)]],_0x46329d=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x1bf)]],_0x4815c1=[..._0x487516[_0x5ee695(0x1c7)]['primary_code']],_0x3adb2f=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0xcd)]],_0x5b94f0=[..._0x487516['body']['prod_code']],_0x25b251=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x14f)]],_0x26caae=[..._0x487516['body'][_0x5ee695(0x178)]],_0x269348=[..._0x487516[_0x5ee695(0x1c7)]['secondary_unit']],_0x309c1f=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x1d5)]],_0x2edb8b=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x13c)]],_0x38aad3=[..._0x487516['body'][_0x5ee695(0x1d0)]],_0x494b30=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x16d)]],_0x3bb0d5=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x183)]],_0x53cd95=[..._0x487516[_0x5ee695(0x1c7)]['RoomAssigned']],_0x5a135a=[..._0x487516['body']['prod_invoice']],_0x65679e=[..._0x487516['body'][_0x5ee695(0x1c2)]],_0x269c0b=[..._0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x19c)]],_0x30f080=[..._0x487516[_0x5ee695(0x1c7)]['gross_price']];const _0x45aa4d=_0xe0747a[_0x5ee695(0xf8)](_0x3f1d0a=>{return _0x3f1d0a={'product_name':_0x3f1d0a};});_0x100e5e['forEach']((_0x5e5838,_0x1b6e2a)=>{_0x45aa4d[_0x1b6e2a]['stock']=_0x5e5838;}),_0x46329d[_0x5ee695(0xd7)]((_0x157e7a,_0x48cbb3)=>{var _0xfbc922=_0x5ee695;_0x45aa4d[_0x48cbb3][_0xfbc922(0xef)]=Math[_0xfbc922(0xe5)](_0x157e7a);}),_0xe0747a['forEach']((_0x23468c,_0x405730)=>{var _0x112f89=_0x5ee695;_0x45aa4d[_0x405730][_0x112f89(0x11a)]=_0x487516[_0x112f89(0x1c7)]['sales'];}),_0x30f080['forEach']((_0x1dc6fa,_0x1f10f9)=>{_0x45aa4d[_0x1f10f9]['gross_price']=_0x1dc6fa;}),_0x269c0b[_0x5ee695(0xd7)]((_0x39f4b0,_0x793264)=>{var _0x4fca6a=_0x5ee695;_0x45aa4d[_0x793264][_0x4fca6a(0x19c)]=_0x39f4b0;}),_0x65679e[_0x5ee695(0xd7)]((_0x577a12,_0x4e411b)=>{_0x45aa4d[_0x4e411b]['id_transaction_from']=_0x577a12;}),_0x4815c1[_0x5ee695(0xd7)]((_0x111b0f,_0x51a919)=>{var _0x2e7530=_0x5ee695;_0x45aa4d[_0x51a919][_0x2e7530(0x1ab)]=_0x111b0f;}),_0x3adb2f['forEach']((_0x1209ca,_0x3beda7)=>{var _0x1f20a0=_0x5ee695;_0x45aa4d[_0x3beda7][_0x1f20a0(0xcd)]=_0x1209ca;}),_0x5b94f0['forEach']((_0x503233,_0x18e149)=>{_0x45aa4d[_0x18e149]['product_code']=_0x503233;}),_0x25b251[_0x5ee695(0xd7)]((_0x4c0447,_0x6b6e98)=>{var _0x42430d=_0x5ee695,_0x130bce=_0x4c0447[_0x42430d(0xca)](/[A-Za-z]+/)[0x0],_0x476819=parseInt(_0x4c0447[_0x42430d(0xca)](/\d+/)[0x0]);_0x45aa4d[_0x6b6e98][_0x42430d(0x18b)]=_0x476819,_0x45aa4d[_0x6b6e98]['level']=_0x130bce;}),_0x26caae[_0x5ee695(0xd7)]((_0x530fa2,_0x248397)=>{var _0x10c1bc=_0x5ee695;_0x45aa4d[_0x248397][_0x10c1bc(0x11d)]=_0x530fa2;}),_0x269348[_0x5ee695(0xd7)]((_0x2f3321,_0x16791b)=>{_0x45aa4d[_0x16791b]['secondary_unit']=_0x2f3321;}),_0x309c1f[_0x5ee695(0xd7)]((_0x5f20d9,_0x8e1e23)=>{var _0x199594=_0x5ee695;_0x45aa4d[_0x8e1e23][_0x199594(0x1d5)]=_0x5f20d9;}),_0x2edb8b[_0x5ee695(0xd7)]((_0xdccf43,_0x5cc406)=>{var _0xb6517d=_0x5ee695;_0x45aa4d[_0x5cc406][_0xb6517d(0x13c)]=_0xdccf43;}),_0x38aad3['forEach']((_0x38e8fa,_0x358c3e)=>{_0x45aa4d[_0x358c3e]['production_date']=_0x38e8fa;}),_0x494b30[_0x5ee695(0xd7)]((_0x56ba56,_0x25a07e)=>{var _0x4903d4=_0x5ee695;_0x45aa4d[_0x25a07e][_0x4903d4(0xc2)]=_0x56ba56;}),_0x3bb0d5[_0x5ee695(0xd7)]((_0x1756af,_0x503418)=>{var _0x57e44d=_0x5ee695;_0x45aa4d[_0x503418][_0x57e44d(0x183)]=_0x1756af;}),_0x53cd95[_0x5ee695(0xd7)]((_0xd9587e,_0x130a79)=>{var _0xb032b6=_0x5ee695;_0x45aa4d[_0x130a79][_0xb032b6(0x190)]=_0xd9587e;}),_0x5a135a['forEach']((_0x156488,_0x481505)=>{var _0x456dc3=_0x5ee695;_0x45aa4d[_0x481505][_0x456dc3(0xc3)]=_0x156488,_0x45aa4d[_0x481505][_0x456dc3(0x155)]=_0x1028a7;});const _0x1c610a=new sales_logs();await _0x1c610a[_0x5ee695(0x154)](),_0x5a135a['forEach']((_0x43ba09,_0x4e8613)=>{var _0x2578b0=_0x5ee695;_0x45aa4d[_0x4e8613][_0x2578b0(0xc9)]='LOG-OUT-'+_0x1c610a[_0x2578b0(0x126)]['toString']()[_0x2578b0(0x179)](0x8,'0');});var _0xd4d9f2=0x0;_0x45aa4d[_0x5ee695(0xd7)](_0x4cd8c5=>{var _0x420801=_0x5ee695;parseFloat(_0x4cd8c5[_0x420801(0x18c)])<parseFloat(_0x4cd8c5[_0x420801(0xef)])&&parseFloat(_0x4cd8c5['quantity'])>parseFloat(_0x4cd8c5['stock'])&&(console[_0x420801(0x1b7)](_0x4cd8c5[_0x420801(0x18c)]+_0x420801(0xdf)+_0x4cd8c5[_0x420801(0xef)]),_0xd4d9f2++);});if(_0xd4d9f2!=0x0)return _0x487516[_0x5ee695(0x1a9)]('errors',_0x5ee695(0x1cd)),_0x17ded0[_0x5ee695(0x174)](_0x5ee695(0x1c6));const _0x5f13d8=_0x45aa4d['filter'](_0x13f868=>_0x13f868['quantity']!=='0'&&_0x13f868[_0x5ee695(0xef)]!==''),_0x11e673=new sales_finished({'invoice':'LOG-OUT-'+_0x1c610a[_0x5ee695(0x126)][_0x5ee695(0xc6)]()[_0x5ee695(0x179)](0x8,'0'),'sales_data':_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x145)],'customer':_0x487516[_0x5ee695(0x1c7)][_0x5ee695(0x1c0)],'date':_0x1028a7,'warehouse_name':_0x337af1,'sale_product':_0x5f13d8,'note':_0x607306,'room':_0xb92949,'primary_code':_0x2a1d5d,'secondary_code':_0x52376e,'prod_code':_0x18fe03,'SCRN':_0x399c42,'finalize':_0x5ee695(0x157),'mode_transpo':_0x44bfb6,'name_driver':_0x385372,'ReqBy':_0x46f4a5,'dateofreq':_0x2cb46e,'PO_number':_0x344c5d,'typeservicesData':_0x13c0e4,'typevehicle':_0x3d29af,'destination':_0x1e6b50,'deliverydate':_0x323525,'driver':_0x3925f8,'plate':_0x6ee2e1,'van':_0x766c99,'DRSI':_0x2a1561,'TSU':_0x4442d3,'TFU':_0x282484,'typeOfProducts':_0x73880}),_0x4adae3=await _0x11e673[_0x5ee695(0x154)](),_0x37315d=await sales_finished[_0x5ee695(0x1c5)]({'invoice':_0x95d0b2});_0x487516[_0x5ee695(0x1a9)](_0x5ee695(0xfd),_0x5ee695(0x15f)),_0x17ded0['redirect']('/all_sales_finished/preview/'+_0x4adae3[_0x5ee695(0xe0)]);}catch(_0x5b1d61){console[_0x5ee695(0x1b7)](_0x5b1d61);}}),router[a0_0x72e872(0x1d3)]('/view/add_sales/:id',auth,async(_0x35f922,_0x1f5716)=>{var _0x115671=a0_0x72e872;try{const _0x4c05ef=_0x35f922[_0x115671(0x177)]['id'];console[_0x115671(0x1b7)](_0x4c05ef);const _0x28c975=await product[_0x115671(0x176)](),_0x273094=await purchases[_0x115671(0x19b)]([{'$match':{'warehouse_name':_0x4c05ef}},{'$unwind':_0x115671(0x16f)},{'$group':{'_id':_0x115671(0x1b1)}}]);console[_0x115671(0x1b7)]('purchases_data',_0x273094),_0x1f5716['status'](0xc8)[_0x115671(0x12b)]({'purchases_data':_0x273094,'product_data':_0x28c975});}catch(_0x5c5212){console[_0x115671(0x1b7)](_0x5c5212);}}),router['post']('/view/add_sale/product',auth,async(_0x5ea4bc,_0x4d9cd7)=>{var _0x5046bb=a0_0x72e872;try{const {warehouse_data:_0x5d0e00,product_data:_0x1ba0f6}=_0x5ea4bc[_0x5046bb(0x1c7)];console[_0x5046bb(0x1b7)](_0x5ea4bc['body'][_0x5046bb(0x14d)]);;const _0x47615b=await master_shop['find']();console[_0x5046bb(0x1b7)](_0x5046bb(0x182),_0x47615b);const _0x34a200=await product['findOne']({'name':_0x1ba0f6});console[_0x5046bb(0x1b7)]('product',_0x34a200);const _0x9795f6=await warehouse['aggregate']([{'$match':{'name':_0x5d0e00}},{'$unwind':_0x5046bb(0x172)},{'$match':{'product_details.product_name':_0x1ba0f6}},{'$group':{'_id':_0x5046bb(0x147),'product_stock':{'$first':_0x5046bb(0xe3)}}}]);console[_0x5046bb(0x1b7)](_0x5046bb(0x194),_0x9795f6),_0x4d9cd7[_0x5046bb(0xfb)](0xc8)[_0x5046bb(0x12b)]({'master':_0x47615b,'new_product':_0x34a200,'stock_data':_0x9795f6});}catch(_0xea5925){console[_0x5046bb(0x1b7)](_0xea5925);}}),router[a0_0x72e872(0x17d)](a0_0x72e872(0x1ae),auth,async(_0x340da9,_0x14635f)=>{var _0x179aa6=a0_0x72e872;try{const {invoice:_0x2b280c,date:_0xd61ee5,warehouse_name:_0x2e205e,product_name:_0x8a7a4a,note:_0x48e77f,room:_0xdb4ac2,primary_code:_0x5aacbf,secondary_code:_0x5105fe,prod_code:_0x37ca9c,SCRN:_0x4f89b9,ReqBy:_0x118b3d,dateofreq:_0x397eb1,PO_number:_0x40bf4c,typeservicesData:_0xc3362c,typevehicle:_0x19047a,destination:_0x5ec8a3,deliverydate:_0x3074a3,driver:_0x2c69b5,plate:_0x2d55bc,van:_0xe46313,DRSI:_0x121049,TSU:_0x30e45d,TFU:_0x18cbf2,mode_transpo:_0xaf8e42,name_driver:_0x2c007f,pull_out_date:_0x358945,actual_delivery_date:_0x4f04dd}=_0x340da9[_0x179aa6(0x1c7)];if(typeof _0x8a7a4a==_0x179aa6(0x13f))var _0x46835c=[_0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0xd8)]],_0x356d6b=[_0x340da9['body']['stock']],_0x2344e7=[_0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x1bf)]],_0x52e120=[_0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x1ab)]],_0x45eb8e=[_0x340da9['body']['secondary_code']],_0x383fef=[_0x340da9[_0x179aa6(0x1c7)]['prod_code']],_0x113f5c=[_0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x14f)]],_0x422373=[_0x340da9['body'][_0x179aa6(0x178)]],_0x1519ee=[_0x340da9[_0x179aa6(0x1c7)]['secondary_unit']],_0x101261=[_0x340da9['body'][_0x179aa6(0x1d5)]],_0x4d74cf=[_0x340da9[_0x179aa6(0x1c7)]['expiry_date']],_0x69d49a=[_0x340da9['body'][_0x179aa6(0x1d0)]],_0xefaf9a=[_0x340da9[_0x179aa6(0x1c7)]['max_per_unit']],_0x188979=[_0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x183)]],_0x1bc0d3=[_0x340da9[_0x179aa6(0x1c7)]['RoomAssigned']],_0x3687da=[_0x340da9['body'][_0x179aa6(0x118)]],_0x2c709b=[_0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x1c2)]],_0xccf436=[_0x340da9['body'][_0x179aa6(0x19c)]],_0x55d2eb=[_0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0xd4)]];else var _0x46835c=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0xd8)]],_0x356d6b=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x18c)]],_0x2344e7=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x1bf)]],_0x52e120=[..._0x340da9['body'][_0x179aa6(0x1ab)]],_0x45eb8e=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0xcd)]],_0x383fef=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0xe8)]],_0x113f5c=[..._0x340da9['body'][_0x179aa6(0x14f)]],_0x422373=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x178)]],_0x1519ee=[..._0x340da9[_0x179aa6(0x1c7)]['secondary_unit']],_0x101261=[..._0x340da9['body']['batch_code']],_0x4d74cf=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x13c)]],_0x69d49a=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x1d0)]],_0xefaf9a=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x16d)]],_0x188979=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x183)]],_0x1bc0d3=[..._0x340da9[_0x179aa6(0x1c7)]['RoomAssigned']],_0x3687da=[..._0x340da9[_0x179aa6(0x1c7)]['prod_invoice']],_0x2c709b=[..._0x340da9['body'][_0x179aa6(0x1c2)]],_0xccf436=[..._0x340da9[_0x179aa6(0x1c7)][_0x179aa6(0x19c)]],_0x55d2eb=[..._0x340da9[_0x179aa6(0x1c7)]['gross_price']];const _0x565834=_0x46835c[_0x179aa6(0xf8)](_0x4f46c6=>{return _0x4f46c6={'product_name':_0x4f46c6};});_0x356d6b[_0x179aa6(0xd7)]((_0x30e1bf,_0x79ab38)=>{var _0x43fbe2=_0x179aa6;_0x565834[_0x79ab38][_0x43fbe2(0x18c)]=_0x30e1bf;}),_0x2344e7['forEach']((_0x12aa77,_0x23e334)=>{var _0x28fc76=_0x179aa6;_0x565834[_0x23e334][_0x28fc76(0xef)]=Math[_0x28fc76(0xe5)](_0x12aa77);}),_0x46835c['forEach']((_0x32ab14,_0x243b20)=>{var _0x4cb90b=_0x179aa6;_0x565834[_0x243b20][_0x4cb90b(0x11a)]=_0x340da9[_0x4cb90b(0x1c7)][_0x4cb90b(0x145)];}),_0x55d2eb[_0x179aa6(0xd7)]((_0x3264c5,_0x3cde7a)=>{var _0x1e8d47=_0x179aa6;_0x565834[_0x3cde7a][_0x1e8d47(0xd4)]=_0x3264c5;}),_0xccf436[_0x179aa6(0xd7)]((_0x5b0fa2,_0x83dc3b)=>{var _0x5e380a=_0x179aa6;_0x565834[_0x83dc3b][_0x5e380a(0x19c)]=_0x5b0fa2;}),_0x2c709b[_0x179aa6(0xd7)]((_0x46e488,_0xbc7a36)=>{_0x565834[_0xbc7a36]['id_transaction_from']=_0x46e488;}),_0x52e120['forEach']((_0x1c28e7,_0x2a054e)=>{_0x565834[_0x2a054e]['primary_code']=_0x1c28e7;}),_0x45eb8e[_0x179aa6(0xd7)]((_0x42020,_0x1bc198)=>{_0x565834[_0x1bc198]['secondary_code']=_0x42020;}),_0x383fef['forEach']((_0x26cd2c,_0xfdf08)=>{_0x565834[_0xfdf08]['product_code']=_0x26cd2c;}),_0x113f5c[_0x179aa6(0xd7)]((_0x1f0baa,_0x28035a)=>{var _0x323e3a=_0x179aa6,_0x5c4a05=_0x1f0baa[_0x323e3a(0xca)](/[A-Za-z]+/)[0x0],_0x13c2d4=parseInt(_0x1f0baa[_0x323e3a(0xca)](/\d+/)[0x0]);_0x565834[_0x28035a]['bay']=_0x13c2d4,_0x565834[_0x28035a][_0x323e3a(0x14c)]=_0x5c4a05;}),_0x422373[_0x179aa6(0xd7)]((_0x1ea51a,_0x4ebead)=>{var _0x14f929=_0x179aa6;_0x565834[_0x4ebead][_0x14f929(0x11d)]=_0x1ea51a;}),_0x1519ee[_0x179aa6(0xd7)]((_0x385043,_0x1757a6)=>{var _0x48c081=_0x179aa6;_0x565834[_0x1757a6][_0x48c081(0x1b5)]=_0x385043;}),_0x101261['forEach']((_0x13e484,_0x4ae139)=>{var _0x2b69bc=_0x179aa6;_0x565834[_0x4ae139][_0x2b69bc(0x1d5)]=_0x13e484;}),_0x4d74cf[_0x179aa6(0xd7)]((_0x5edc0d,_0x587c92)=>{_0x565834[_0x587c92]['expiry_date']=_0x5edc0d;}),_0x69d49a['forEach']((_0x2890ff,_0x21f93a)=>{var _0x5dbaf6=_0x179aa6;_0x565834[_0x21f93a][_0x5dbaf6(0xc7)]=_0x2890ff;}),_0xefaf9a[_0x179aa6(0xd7)]((_0x2754c4,_0x49c44c)=>{var _0x404898=_0x179aa6;_0x565834[_0x49c44c][_0x404898(0xc2)]=_0x2754c4;}),_0x188979[_0x179aa6(0xd7)]((_0x11e7ee,_0x1d26a2)=>{_0x565834[_0x1d26a2]['prod_cat']=_0x11e7ee;}),_0x1bc0d3[_0x179aa6(0xd7)]((_0x429812,_0x4e7ae2)=>{var _0xd69c6a=_0x179aa6;_0x565834[_0x4e7ae2][_0xd69c6a(0x190)]=_0x429812;}),_0x3687da[_0x179aa6(0xd7)]((_0x4f8be2,_0x4cca98)=>{var _0x386e2e=_0x179aa6;_0x565834[_0x4cca98][_0x386e2e(0xc3)]=_0x4f8be2,_0x565834[_0x4cca98][_0x386e2e(0x155)]=_0xd61ee5;});const _0xf40b95=new invoice_for_outgoing();await _0xf40b95[_0x179aa6(0x154)](),_0x3687da[_0x179aa6(0xd7)]((_0x3a49a4,_0x794876)=>{var _0x131939=_0x179aa6;_0x565834[_0x794876]['outgoing_invoice']=_0x131939(0x112)+_0xf40b95[_0x131939(0x126)][_0x131939(0xc6)]()[_0x131939(0x179)](0x8,'0');});var _0x46c197=0x0;_0x565834[_0x179aa6(0xd7)](_0x2e80b3=>{var _0x1fbc26=_0x179aa6;parseFloat(_0x2e80b3[_0x1fbc26(0x18c)])<parseFloat(_0x2e80b3[_0x1fbc26(0xef)])&&parseFloat(_0x2e80b3[_0x1fbc26(0xef)])>parseFloat(_0x2e80b3[_0x1fbc26(0x18c)])&&(console[_0x1fbc26(0x1b7)](_0x2e80b3[_0x1fbc26(0x18c)]+'\x20<>\x20'+_0x2e80b3['quantity']),_0x46c197++);});if(_0x46c197!=0x0)return _0x340da9[_0x179aa6(0x1a9)]('errors',_0x179aa6(0x1cd)),_0x14635f['redirect'](_0x179aa6(0x1c6));const _0x2a94f7=_0x565834['filter'](_0xa3c9dc=>_0xa3c9dc['quantity']!=='0'&&_0xa3c9dc[_0x179aa6(0xef)]!==''),_0x52dfd2=new sales_finished({'invoice':_0x179aa6(0x112)+_0xf40b95['invoice_init'][_0x179aa6(0xc6)]()[_0x179aa6(0x179)](0x8,'0'),'sales_data':_0x340da9['body'][_0x179aa6(0x145)],'customer':_0x340da9['body']['customer'],'date':_0xd61ee5,'warehouse_name':_0x2e205e,'sale_product':_0x2a94f7,'note':_0x48e77f,'room':_0xdb4ac2,'primary_code':_0x5aacbf,'secondary_code':_0x5105fe,'prod_code':_0x37ca9c,'SCRN':_0x4f89b9,'finalize':_0x179aa6(0x157),'mode_transpo':_0xaf8e42,'name_driver':_0x2c007f,'ReqBy':_0x118b3d,'dateofreq':_0x397eb1,'PO_number':_0x40bf4c,'typeservicesData':_0xc3362c,'typevehicle':_0x19047a,'destination':_0x5ec8a3,'deliverydate':_0x3074a3,'driver':_0x2c69b5,'plate':_0x2d55bc,'van':_0xe46313,'DRSI':_0x121049,'TSU':_0x30e45d,'TFU':_0x18cbf2,'pullout_date':_0x358945,'actualdelivery_date':_0x4f04dd,'typeOfProducts':_0x179aa6(0x19a)}),_0x56d5c3=await _0x52dfd2[_0x179aa6(0x154)](),_0x7818aa=await sales_finished['findOne']({'invoice':_0x2b280c});_0x340da9[_0x179aa6(0x1a9)]('success','Sales\x20Add\x20successfully'),_0x14635f[_0x179aa6(0x174)](_0x179aa6(0x16c)+_0x56d5c3[_0x179aa6(0xe0)]);}catch(_0x354409){console[_0x179aa6(0x1b7)](_0x354409);}}),router[a0_0x72e872(0x1d3)](a0_0x72e872(0xf7),auth,async(_0x2d0444,_0xc6ce48)=>{var _0x1f541d=a0_0x72e872;try{const {username:_0x24b732,email:_0x576583,role:_0x1d94de}=_0x2d0444[_0x1f541d(0x114)],_0x5d78b9=_0x2d0444[_0x1f541d(0x114)],_0xddffef=await profile[_0x1f541d(0x1c5)]({'email':_0x5d78b9[_0x1f541d(0x18f)]}),_0x2ecfb0=await master_shop[_0x1f541d(0x176)](),_0x207cb7=_0x2d0444[_0x1f541d(0x177)]['id'],_0x1550c1=await sales_finished[_0x1f541d(0x15a)](_0x207cb7),_0x3fb30a=await warehouse[_0x1f541d(0x19b)]([{'$match':{'name':_0x1550c1[_0x1f541d(0x16b)]}},{'$unwind':_0x1f541d(0x172)},{'$group':{'_id':_0x1f541d(0x18a),'name':{'$first':_0x1f541d(0x147)},'product_stock':{'$first':_0x1f541d(0xe3)},'bay':{'$first':_0x1f541d(0x192)},'bin':{'$first':_0x1f541d(0xbd)},'type':{'$first':_0x1f541d(0x14e)},'floorlevel':{'$first':_0x1f541d(0xee)},'primary_code':{'$first':_0x1f541d(0xd1)},'secondary_code':{'$first':_0x1f541d(0x13e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1f541d(0x124)},'rack':{'$first':_0x1f541d(0x151)},'expiry_date':{'$first':_0x1f541d(0x127)},'production_date':{'$first':_0x1f541d(0x16e)},'batch_code':{'$first':_0x1f541d(0x1b3)},'room':{'$first':'$room'},'room_data':{'$first':'$product_details.room_name'}}}]),_0x1ba574=await customer[_0x1f541d(0x176)]({});let _0x4290f4;if(_0x5d78b9['role']=='staff'){const _0x34e755=await staff[_0x1f541d(0x1c5)]({'email':_0x5d78b9[_0x1f541d(0x18f)]});_0x4290f4=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x34e755[_0x1f541d(0x1cb)]}},{'$group':{'_id':_0x1f541d(0x168),'name':{'$first':_0x1f541d(0x168)}}}]);}else _0x4290f4=await warehouse[_0x1f541d(0x19b)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x1f541d(0x168)}}}]);const _0x18e885=await product[_0x1f541d(0x176)]({});if(_0x2ecfb0[0x0][_0x1f541d(0x12a)]==_0x1f541d(0x113)){var _0x577477=users[_0x1f541d(0x137)];console['log'](_0x577477);}else{if(_0x2ecfb0[0x0][_0x1f541d(0x12a)]==_0x1f541d(0x181))var _0x577477=users['Hindi'];else{if(_0x2ecfb0[0x0][_0x1f541d(0x12a)]==_0x1f541d(0x184))var _0x577477=users[_0x1f541d(0x184)];else{if(_0x2ecfb0[0x0]['language']==_0x1f541d(0x1a3))var _0x577477=users[_0x1f541d(0x1a3)];else{if(_0x2ecfb0[0x0][_0x1f541d(0x12a)]==_0x1f541d(0xf3))var _0x577477=users[_0x1f541d(0xf3)];else{if(_0x2ecfb0[0x0][_0x1f541d(0x12a)]=='Portuguese\x20(BR)')var _0x577477=users['Portuguese'];else{if(_0x2ecfb0[0x0][_0x1f541d(0x12a)]==_0x1f541d(0x1cf))var _0x577477=users['Chinese'];else{if(_0x2ecfb0[0x0][_0x1f541d(0x12a)]==_0x1f541d(0x11e))var _0x577477=users[_0x1f541d(0x10a)];}}}}}}}_0xc6ce48['render'](_0x1f541d(0xcc),{'success':_0x2d0444[_0x1f541d(0x1a9)](_0x1f541d(0xfd)),'errors':_0x2d0444[_0x1f541d(0x1a9)](_0x1f541d(0x15e)),'role':_0x5d78b9,'profile':_0xddffef,'customer':_0x1ba574,'warehouse':_0x4290f4,'product':_0x3fb30a,'user':_0x1550c1,'master_shop':_0x2ecfb0,'unit':_0x18e885,'language':_0x577477});}catch(_0x3fe5e7){console[_0x1f541d(0x1b7)](_0x3fe5e7);}});async function dataUpdate(_0x334e8e,_0x2e3842,_0x29c8f9){var _0x22e607=a0_0x72e872;return await warehouse[_0x22e607(0xeb)]({'_id':_0x334e8e,'product_details._id':_0x2e3842},{'$set':{'product_details.$.product_stock':_0x29c8f9}}),await warehouse[_0x22e607(0x15a)](_0x334e8e);}function a0_0x5d06(_0x127086,_0x1e5a21){var _0x389a8a=a0_0x389a();return a0_0x5d06=function(_0x5d068f,_0x4a0172){_0x5d068f=_0x5d068f-0xba;var _0x5ce43d=_0x389a8a[_0x5d068f];return _0x5ce43d;},a0_0x5d06(_0x127086,_0x1e5a21);}router[a0_0x72e872(0x17d)](a0_0x72e872(0xf7),auth,async(_0x565ffd,_0x55ea07)=>{var _0x4e2a30=a0_0x72e872;try{const _0x1f285c=_0x565ffd['params']['id'],{invoice:_0x4d9633,warehouse_name:_0x5241af,room:_0x57c0c0}=_0x565ffd[_0x4e2a30(0x1c7)],_0x18fff1=await sales_finished[_0x4e2a30(0x1c5)]({'invoice':_0x4d9633});for(let _0x6c7db1=0x0;_0x6c7db1<=_0x18fff1[_0x4e2a30(0x17a)][_0x4e2a30(0x1b4)]-0x1;_0x6c7db1++){const _0x33a088=_0x18fff1[_0x4e2a30(0x17a)][_0x6c7db1];var _0x399309=await warehouse[_0x4e2a30(0x1c5)]({'name':_0x5241af,'room':_0x33a088['room_name']}),_0x21f748=0x0;for(let _0x46c647=0x0;_0x46c647<=_0x399309['product_details'][_0x4e2a30(0x1b4)]-0x1;_0x46c647++){const _0x454920=_0x399309[_0x4e2a30(0xc0)][_0x46c647];_0x454920[_0x4e2a30(0xe0)]==_0x33a088[_0x4e2a30(0x1c2)]&&_0x454920[_0x4e2a30(0x19c)]==_0x33a088[_0x4e2a30(0x19c)]&&(_0x21f748=Math['max'](0x0,Math['abs'](_0x454920[_0x4e2a30(0x13a)])-Math[_0x4e2a30(0xe5)](_0x33a088[_0x4e2a30(0xef)])),await warehouse[_0x4e2a30(0xeb)]({'_id':_0x399309[_0x4e2a30(0xe0)][_0x4e2a30(0x152)](),'product_details._id':_0x454920[_0x4e2a30(0xe0)][_0x4e2a30(0x152)](),'product_details.uuid':_0x33a088[_0x4e2a30(0x19c)]},{'$set':{'product_details.$.product_stock':_0x21f748}}));}console[_0x4e2a30(0x1b7)](typeof _0x33a088[_0x4e2a30(0x11a)]);if(typeof _0x33a088[_0x4e2a30(0x11a)]!==_0x4e2a30(0x135)){var _0x1f4261=await staff[_0x4e2a30(0x15a)](_0x33a088[_0x4e2a30(0x11a)]);console['log'](_0x4e2a30(0xda));var _0x4c3f3a=0x0;for(let _0x43b00e=0x0;_0x43b00e<=_0x1f4261[_0x4e2a30(0x189)]['length']-0x1;_0x43b00e++){const _0x18cd4a=_0x1f4261[_0x4e2a30(0x189)][_0x43b00e];console[_0x4e2a30(0x1b7)](_0x33a088['id_transaction_from']+'\x20==\x20'+_0x18cd4a[_0x4e2a30(0xbb)]+'\x20&&\x20'+_0x33a088[_0x4e2a30(0xe0)]+_0x4e2a30(0xc4)+_0x33a088[_0x4e2a30(0xe0)]),_0x33a088[_0x4e2a30(0x1c2)]==_0x18cd4a[_0x4e2a30(0xbb)]&&_0x33a088['_id']==0x1&&(_0x18cd4a[_0x4e2a30(0x13a)]=Math[_0x4e2a30(0xe5)](_0x18cd4a['product_stock'])+Math[_0x4e2a30(0xe5)](_0x33a088[_0x4e2a30(0xef)]),_0x4c3f3a++);}console[_0x4e2a30(0x1b7)]('int',_0x4c3f3a),_0x4c3f3a=='0'&&(_0x1f4261[_0x4e2a30(0x189)]=_0x1f4261[_0x4e2a30(0x189)][_0x4e2a30(0x163)]({'product_name':_0x33a088[_0x4e2a30(0xd8)],'product_stock':_0x33a088[_0x4e2a30(0xef)],'bay':_0x33a088[_0x4e2a30(0x18b)],'level':_0x33a088[_0x4e2a30(0x14c)],'product_code':_0x33a088[_0x4e2a30(0x107)],'primary_code':_0x33a088[_0x4e2a30(0x1ab)],'secondary_code':_0x33a088['secondary_code'],'expiry_date':_0x33a088[_0x4e2a30(0x13c)],'production_date':_0x33a088[_0x4e2a30(0xc7)],'maxProducts':_0x33a088[_0x4e2a30(0x12d)],'batch_code':_0x33a088['batch_code'],'secondary_unit':_0x33a088['secondary_unit'],'unit':_0x33a088[_0x4e2a30(0x11d)],'maxProducts':_0x33a088[_0x4e2a30(0x12d)],'maxPerUnit':_0x33a088[_0x4e2a30(0xc2)],'invoice':_0x33a088[_0x4e2a30(0xc3)],'warehouse_id':_0x33a088['id_transaction_from'],'id_incoming':_0x33a088[_0x4e2a30(0xe0)],'uuid':_0x33a088['uuid'],'gross_price':_0x33a088['gross_price'],'date_incoming':_0x33a088['date_data'],'outgoing_invoice':_0x33a088[_0x4e2a30(0xc9)]}),await _0x1f4261[_0x4e2a30(0x154)]());}}_0x18fff1[_0x4e2a30(0xdd)]=_0x4e2a30(0x106);const _0x42e6d3=await _0x18fff1['save'](),_0x3a37eb=await master_shop[_0x4e2a30(0x176)](),_0x5de757=await email_settings[_0x4e2a30(0x1c5)](),_0x26cf99=await supervisor_settings['find']();var _0x6affaf=_0x18fff1[_0x4e2a30(0x17a)],_0x272313='',_0x143031;for(_0x143031 in _0x6affaf){_0x272313+=_0x4e2a30(0xd6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x6affaf[_0x143031][_0x4e2a30(0xd8)]+_0x4e2a30(0xe2)+_0x4e2a30(0xd2)+_0x6affaf[_0x143031][_0x4e2a30(0x107)]+_0x4e2a30(0xe2)+_0x4e2a30(0xd2)+_0x6affaf[_0x143031][_0x4e2a30(0xef)]+_0x4e2a30(0xe2)+_0x4e2a30(0xd2)+_0x6affaf[_0x143031][_0x4e2a30(0x11d)]+_0x4e2a30(0xe2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x6affaf[_0x143031][_0x4e2a30(0x1b5)]+_0x4e2a30(0xe2)+_0x4e2a30(0xd2)+_0x18fff1[_0x4e2a30(0x16b)]+'</td>'+_0x4e2a30(0xd2)+_0x6affaf[_0x143031][_0x4e2a30(0x190)]+_0x4e2a30(0xe2)+_0x4e2a30(0xd2)+_0x6affaf[_0x143031]['bay']+_0x4e2a30(0xe2);}_0x565ffd['flash'](_0x4e2a30(0xfd),_0x4e2a30(0x191)),_0x55ea07[_0x4e2a30(0x174)]('/picking_list/pdf/'+_0x1f285c);}catch(_0x5bafe0){console[_0x4e2a30(0x1b7)](_0x5bafe0);}}),router[a0_0x72e872(0x1d3)](a0_0x72e872(0x1c9),auth,async(_0x4a0c2f,_0x137824)=>{var _0x3f5612=a0_0x72e872;try{const {username:_0x5e179c,email:_0x424746,role:_0x54806a}=_0x4a0c2f['user'],_0x481764=_0x4a0c2f['user'],_0x460707=await profile[_0x3f5612(0x1c5)]({'email':_0x481764[_0x3f5612(0x18f)]}),_0x5efaeb=await master_shop['find'](),_0x2d9729=_0x4a0c2f[_0x3f5612(0x177)]['id'],_0x395582=await sales_finished['findById'](_0x2d9729);let _0x38144a=new Date(_0x395582['expiry_date']),_0x3e3fd0=('0'+_0x38144a[_0x3f5612(0x1b6)]())[_0x3f5612(0x117)](-0x2),_0x426130=('0'+(_0x38144a[_0x3f5612(0x119)]()+0x1))[_0x3f5612(0x117)](-0x2),_0x5a24f1=_0x38144a[_0x3f5612(0x17b)](),_0x4947b1=_0x5a24f1+'-'+_0x426130+'-'+_0x3e3fd0;var _0x648b49=['Ambient',_0x3f5612(0xed)];const _0xd7114d=await warehouse[_0x3f5612(0x19b)]([{'$match':{'name':_0x395582[_0x3f5612(0x16b)],'room':_0x395582[_0x3f5612(0xbf)]}},{'$unwind':_0x3f5612(0x172)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3f5612(0x147)},'product_stock':{'$first':_0x3f5612(0xe3)},'bay':{'$first':_0x3f5612(0x192)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3f5612(0xee)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3f5612(0x13e)},'product_code':{'$first':_0x3f5612(0x15b)},'storage':{'$first':_0x3f5612(0x124)},'rack':{'$first':_0x3f5612(0x151)}}}]),_0x586100=await customer[_0x3f5612(0x176)]({});let _0x40d452;if(_0x481764['role']==_0x3f5612(0xfc)){const _0x40d020=await staff[_0x3f5612(0x1c5)]({'email':_0x481764[_0x3f5612(0x18f)]});_0x40d452=await warehouse[_0x3f5612(0x19b)]([{'$match':{'status':_0x3f5612(0x175),'name':_0x40d020[_0x3f5612(0x1cb)]}},{'$group':{'_id':_0x3f5612(0x168),'name':{'$first':_0x3f5612(0x168)}}}]);}else _0x40d452=await warehouse[_0x3f5612(0x19b)]([{'$match':{'status':_0x3f5612(0x175)}},{'$group':{'_id':_0x3f5612(0x168),'name':{'$first':_0x3f5612(0x168)}}}]);const _0x1e7d7b=await product['find']({});if(_0x5efaeb[0x0]['language']=='English\x20(US)'){var _0x477f64=users[_0x3f5612(0x137)];console[_0x3f5612(0x1b7)](_0x477f64);}else{if(_0x5efaeb[0x0][_0x3f5612(0x12a)]==_0x3f5612(0x181))var _0x477f64=users[_0x3f5612(0x181)];else{if(_0x5efaeb[0x0][_0x3f5612(0x12a)]==_0x3f5612(0x184))var _0x477f64=users['German'];else{if(_0x5efaeb[0x0][_0x3f5612(0x12a)]==_0x3f5612(0x1a3))var _0x477f64=users[_0x3f5612(0x1a3)];else{if(_0x5efaeb[0x0][_0x3f5612(0x12a)]==_0x3f5612(0xf3))var _0x477f64=users[_0x3f5612(0xf3)];else{if(_0x5efaeb[0x0][_0x3f5612(0x12a)]==_0x3f5612(0x1d1))var _0x477f64=users[_0x3f5612(0x146)];else{if(_0x5efaeb[0x0][_0x3f5612(0x12a)]==_0x3f5612(0x1cf))var _0x477f64=users['Chinese'];else{if(_0x5efaeb[0x0][_0x3f5612(0x12a)]==_0x3f5612(0x11e))var _0x477f64=users['Arabic'];}}}}}}}_0x137824['render'](_0x3f5612(0x14b),{'success':_0x4a0c2f[_0x3f5612(0x1a9)](_0x3f5612(0xfd)),'errors':_0x4a0c2f[_0x3f5612(0x1a9)](_0x3f5612(0x15e)),'role':_0x481764,'profile':_0x460707,'customer':_0x586100,'warehouse':_0x40d452,'product':_0xd7114d,'user':_0x395582,'master_shop':_0x5efaeb,'unit':_0x1e7d7b,'language':_0x477f64,'rooms_data':_0x648b49,'ed_fullDate':_0x4947b1});}catch(_0x2052d4){console[_0x3f5612(0x1b7)](_0x2052d4);}}),router[a0_0x72e872(0x17d)](a0_0x72e872(0x1c9),auth,async(_0x15df1a,_0x3221fc)=>{var _0x55f3b4=a0_0x72e872;try{const _0x1b5727=_0x15df1a[_0x55f3b4(0x177)]['id'],_0x111914=await sales_finished[_0x55f3b4(0x1c5)]({'_id':_0x15df1a[_0x55f3b4(0x177)]['id']}),_0x311771=await warehouse[_0x55f3b4(0x1c5)]({'name':_0x111914[_0x55f3b4(0x16b)],'room':_0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0xbf)],'warehouse_category':_0x55f3b4(0x16a)}),{invoice:_0x3e3eb0,customer:_0x50b02d,date:_0x23730b,warehouse_name:_0x1dd76c,product_name:_0x1268a7,stock:_0x35044d,adjust_qty:_0x15baed,note:_0x341d7e,room:_0x22e38c,primary_code:_0xec89d7,secondary_code:_0x2e4269,prod_code:_0x52d61a,level:_0x3643f4,isle:_0x8bb97d,pallet:_0x1f3d65,expiry_date:_0x190f5d}=_0x15df1a[_0x55f3b4(0x1c7)];if(typeof _0x1268a7==_0x55f3b4(0x13f))var _0x5fce49=[_0x15df1a[_0x55f3b4(0x1c7)]['product_name']],_0x3c39a5=[_0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0x18c)]],_0x3c88d2=[_0x15df1a['body'][_0x55f3b4(0xc8)]],_0x44c747=[_0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0x1ab)]],_0x79fa03=[_0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0xcd)]],_0x1705a8=[_0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0xe8)]],_0x25b110=[_0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0x14c)]],_0xa114d8=[_0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0x13c)]];else var _0x5fce49=[..._0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0xd8)]],_0x3c39a5=[..._0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0x18c)]],_0x3c88d2=[..._0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0xc8)]],_0x44c747=[..._0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0x1ab)]],_0x79fa03=[..._0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0xcd)]],_0x1705a8=[..._0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0xe8)]],_0x25b110=[..._0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0x14c)]],_0xa114d8=[..._0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0x13c)]];const _0x522d41=_0x5fce49['map'](_0x28ee6c=>{return _0x28ee6c={'product_name':_0x28ee6c};});_0x3c39a5['forEach']((_0x1d6b6e,_0x56a2fc)=>{var _0xcf7743=_0x55f3b4;_0x522d41[_0x56a2fc][_0xcf7743(0x18c)]=_0x1d6b6e;}),_0x3c88d2[_0x55f3b4(0xd7)]((_0x4ab732,_0x240c3f)=>{var _0xc072d4=_0x55f3b4;_0x522d41[_0x240c3f][_0xc072d4(0xef)]=_0x4ab732;}),_0x44c747[_0x55f3b4(0xd7)]((_0xbd722e,_0x1c1db0)=>{_0x522d41[_0x1c1db0]['primary_code']=_0xbd722e;}),_0x79fa03[_0x55f3b4(0xd7)]((_0xb2adba,_0xab043e)=>{var _0x2f22e1=_0x55f3b4;_0x522d41[_0xab043e][_0x2f22e1(0xcd)]=_0xb2adba;}),_0x1705a8['forEach']((_0x56662c,_0x1d9054)=>{var _0x4b428e=_0x55f3b4;_0x522d41[_0x1d9054][_0x4b428e(0x107)]=_0x56662c;}),_0x25b110[_0x55f3b4(0xd7)]((_0x48aeca,_0x514295)=>{_0x522d41[_0x514295]['level']=_0x48aeca;}),_0xa114d8[_0x55f3b4(0xd7)]((_0x24ca80,_0x524e96)=>{_0x522d41[_0x524e96]['expiry_date']=_0x24ca80;});var _0xf8bc5e=0x0;_0x522d41['forEach'](_0x4e3cc3=>{var _0x1a3601=_0x55f3b4;console['log']('foreach\x20newproduct',_0x4e3cc3),(parseInt(_0x4e3cc3[_0x1a3601(0x18c)])<parseInt(_0x4e3cc3[_0x1a3601(0xef)])||parseInt(_0x4e3cc3['quantity'])==0x0)&&_0xf8bc5e++;});if(_0xf8bc5e!=0x0)return _0x15df1a['flash'](_0x55f3b4(0x15e),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x3221fc[_0x55f3b4(0x174)](_0x55f3b4(0x1c6));_0x111914[_0x55f3b4(0x17a)][_0x55f3b4(0xd7)](_0x561ce4=>{var _0x57f888=_0x55f3b4;const _0x15eb4d=_0x311771[_0x57f888(0xc0)][_0x57f888(0xf8)](_0x45f7f2=>{var _0x5e5af5=_0x57f888;_0x45f7f2[_0x5e5af5(0xd8)]==_0x561ce4[_0x5e5af5(0xd8)]&&_0x45f7f2[_0x5e5af5(0x18b)]==_0x561ce4[_0x5e5af5(0x18b)]&&(_0x45f7f2[_0x5e5af5(0x13a)]=parseInt(_0x45f7f2[_0x5e5af5(0x13a)])+parseInt(_0x561ce4[_0x5e5af5(0xef)]));});}),await _0x311771[_0x55f3b4(0x154)]();const _0x1cf9d6=_0x522d41[_0x55f3b4(0x160)](_0x4d7c62=>_0x4d7c62[_0x55f3b4(0xef)]!=='0'&&_0x4d7c62['quantity']!=='');_0x111914['invoice']=_0x3e3eb0,_0x111914['customer']=_0x50b02d,_0x111914['date']=_0x23730b,_0x111914[_0x55f3b4(0x16b)]=_0x1dd76c,_0x111914[_0x55f3b4(0x17a)]=_0x1cf9d6,_0x111914[_0x55f3b4(0x12e)]=_0x341d7e,_0x111914[_0x55f3b4(0xbf)]=_0x22e38c;const _0x2f7d16=await _0x111914['save'](),_0x34002d=await sales_finished['findOne']({'_id':_0x15df1a['params']['id']}),_0x16aa6c=await warehouse[_0x55f3b4(0x1c5)]({'name':_0x1dd76c,'room':_0x22e38c,'warehouse_category':'Finished\x20Goods'});_0x34002d[_0x55f3b4(0x17a)][_0x55f3b4(0xd7)](_0x577c09=>{var _0x2b81f5=_0x55f3b4;const _0x1a1d39=_0x16aa6c['product_details'][_0x2b81f5(0xf8)](_0x4f99cd=>{var _0x1de0ca=_0x2b81f5;_0x4f99cd[_0x1de0ca(0xd8)]==_0x577c09[_0x1de0ca(0xd8)]&&_0x4f99cd['bay']==_0x577c09['bay']&&(_0x4f99cd[_0x1de0ca(0x13a)]=parseInt(_0x4f99cd['product_stock'])-parseInt(_0x577c09['quantity']));});}),console[_0x55f3b4(0x1b7)]('final',_0x16aa6c),await _0x16aa6c[_0x55f3b4(0x154)]();const _0x3f5c89=await c_payment_data[_0x55f3b4(0x1c5)]({'invoice':_0x15df1a[_0x55f3b4(0x1c7)][_0x55f3b4(0xc3)]});_0x3f5c89[_0x55f3b4(0x140)]=_0x15df1a[_0x55f3b4(0x1c7)]['suppliers'],await _0x3f5c89[_0x55f3b4(0x154)](),_0x15df1a[_0x55f3b4(0x1a9)](_0x55f3b4(0xfd),_0x55f3b4(0x191)),_0x3221fc[_0x55f3b4(0x174)]('/all_sales_finished/view');}catch(_0x3b90e9){console['log'](_0x3b90e9);}}),router[a0_0x72e872(0x17d)](a0_0x72e872(0x1d4),auth,async(_0x5eec31,_0x24c2d6)=>{var _0x564c1d=a0_0x72e872;try{const _0x263957=_0x5eec31[_0x564c1d(0x177)]['id'],{invoice:_0x4db4fb,customer:_0x3d5d0c,receivable_amount:_0x4d2738,received_amount:_0x34bc05}=_0x5eec31[_0x564c1d(0x1c7)],_0x3fd50a=await sales['findById'](_0x263957);console[_0x564c1d(0x1b7)](_0x3fd50a);var _0x3e2d64=_0x4d2738-_0x34bc05;console[_0x564c1d(0x1b7)](_0x34bc05),_0x3fd50a[_0x564c1d(0x158)]=parseFloat(_0x34bc05)+parseFloat(_0x3fd50a['received_amount']),_0x3fd50a[_0x564c1d(0x101)]=_0x3e2d64,console[_0x564c1d(0x1b7)](_0x3fd50a);const _0x1e5666=await _0x3fd50a[_0x564c1d(0x154)](),_0x59abf5=await c_payment_data['findOne']({'invoice':_0x4db4fb});_0x59abf5[_0x564c1d(0x1af)]=_0x3e2d64,await _0x59abf5[_0x564c1d(0x154)]();let _0x3da7ca=new Date(),_0x265bb2=('0'+_0x3da7ca[_0x564c1d(0x1b6)]())['slice'](-0x2),_0x533bbf=('0'+(_0x3da7ca[_0x564c1d(0x119)]()+0x1))[_0x564c1d(0x117)](-0x2),_0x11d838=_0x3da7ca[_0x564c1d(0x17b)](),_0x57f5b9=_0x11d838+'-'+_0x533bbf+'-'+_0x265bb2;const _0x187555=new customer_payment({'invoice':_0x4db4fb,'date':_0x11d838+'-'+_0x533bbf+'-'+_0x265bb2,'customer':_0x3d5d0c,'reason':_0x564c1d(0xba),'amount':_0x34bc05}),_0x37fda1=await _0x187555[_0x564c1d(0x154)]();_0x5eec31[_0x564c1d(0x1a9)](_0x564c1d(0xfd),'payment\x20successfull'),_0x24c2d6['redirect']('/all_sales/view');}catch(_0x5bb788){console['log'](_0x5bb788);}}),router[a0_0x72e872(0x1d3)](a0_0x72e872(0x1cc),auth,async(_0x2d26db,_0x404575)=>{var _0x3d3e0f=a0_0x72e872;try{const {username:_0x51f339,email:_0x551882,role:_0x4cb36f}=_0x2d26db[_0x3d3e0f(0x114)],_0x45791d=_0x2d26db[_0x3d3e0f(0x114)],_0x55e5a5=await profile[_0x3d3e0f(0x1c5)]({'email':_0x45791d[_0x3d3e0f(0x18f)]}),_0x223ea6=await master_shop[_0x3d3e0f(0x176)]();console[_0x3d3e0f(0x1b7)](_0x3d3e0f(0x182),_0x223ea6);const _0x14656e=_0x2d26db[_0x3d3e0f(0x177)]['id'],_0x1e9054=await sales['findById'](_0x14656e);console[_0x3d3e0f(0x1b7)](_0x1e9054);const _0x166075=await customer[_0x3d3e0f(0x1c5)]({'name':_0x1e9054['customer']});console[_0x3d3e0f(0x1b7)](_0x166075);if(_0x223ea6[0x0][_0x3d3e0f(0x12a)]=='English\x20(US)'){var _0x5272e0=users[_0x3d3e0f(0x137)];console[_0x3d3e0f(0x1b7)](_0x5272e0);}else{if(_0x223ea6[0x0][_0x3d3e0f(0x12a)]==_0x3d3e0f(0x181))var _0x5272e0=users[_0x3d3e0f(0x181)];else{if(_0x223ea6[0x0]['language']==_0x3d3e0f(0x184))var _0x5272e0=users[_0x3d3e0f(0x184)];else{if(_0x223ea6[0x0][_0x3d3e0f(0x12a)]==_0x3d3e0f(0x1a3))var _0x5272e0=users[_0x3d3e0f(0x1a3)];else{if(_0x223ea6[0x0][_0x3d3e0f(0x12a)]==_0x3d3e0f(0xf3))var _0x5272e0=users[_0x3d3e0f(0xf3)];else{if(_0x223ea6[0x0][_0x3d3e0f(0x12a)]==_0x3d3e0f(0x1d1))var _0x5272e0=users[_0x3d3e0f(0x146)];else{if(_0x223ea6[0x0][_0x3d3e0f(0x12a)]==_0x3d3e0f(0x1cf))var _0x5272e0=users[_0x3d3e0f(0x1cf)];else{if(_0x223ea6[0x0][_0x3d3e0f(0x12a)]=='Arabic\x20(ae)')var _0x5272e0=users[_0x3d3e0f(0x10a)];}}}}}}}_0x404575['render'](_0x3d3e0f(0x1a1),{'success':_0x2d26db[_0x3d3e0f(0x1a9)](_0x3d3e0f(0xfd)),'errors':_0x2d26db['flash'](_0x3d3e0f(0x15e)),'role':_0x45791d,'profile':_0x55e5a5,'master_shop':_0x223ea6,'customers':_0x166075,'sales':_0x1e9054,'language':_0x5272e0});}catch(_0xe28021){console[_0x3d3e0f(0x1b7)](_0xe28021);}}),router[a0_0x72e872(0x1d3)]('/view/return_sales/:id',auth,async(_0x390715,_0xcc4ebc)=>{var _0x52e189=a0_0x72e872;try{const {username:_0x10b0db,email:_0x55ad6c,role:_0x3fe157}=_0x390715['user'],_0x526883=_0x390715[_0x52e189(0x114)],_0x5b62de=await profile[_0x52e189(0x1c5)]({'email':_0x526883['email']}),_0x513bf8=await master_shop[_0x52e189(0x176)](),_0x21ceef=_0x390715[_0x52e189(0x177)]['id'],_0x4578d8=await sales_finished[_0x52e189(0x15a)](_0x21ceef),_0x2ccfa1=await warehouse['aggregate']([{'$match':{'name':_0x4578d8[_0x52e189(0x16b)]}},{'$unwind':_0x52e189(0x172)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x52e189(0xe3)},'bay':{'$first':_0x52e189(0x192)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x52e189(0xd1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x52e189(0x15b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x52e189(0x127)},'production_date':{'$first':_0x52e189(0x16e)},'unit':{'$first':_0x52e189(0xce)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x52e189(0x180)},'batch_code':{'$first':_0x52e189(0x1b3)},'maxPerUnit':{'$first':_0x52e189(0x13b)}}}]),_0x4340d9=await product[_0x52e189(0x176)]({}),_0x44455d=await warehouse[_0x52e189(0x19b)]([{'$match':{'status':'Enabled','warehouse_category':_0x52e189(0x16a),'name':{'$ne':_0x52e189(0x1ba),'$ne':_0x52e189(0x185)}}},{'$group':{'_id':_0x52e189(0x168),'name':{'$first':_0x52e189(0x168)}}},{'$sort':{'name':0x1}}]);var _0x8635b4=['Return\x20Rooms'];const _0x356182=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':'Quality\x20Inspection'}},{'$group':{'_id':_0x52e189(0x168),'name':{'$first':_0x52e189(0x168)}}},{'$sort':{'name':0x1}}]);if(_0x513bf8[0x0]['language']==_0x52e189(0x113)){var _0x303134=users[_0x52e189(0x137)];console[_0x52e189(0x1b7)](_0x303134);}else{if(_0x513bf8[0x0][_0x52e189(0x12a)]==_0x52e189(0x181))var _0x303134=users[_0x52e189(0x181)];else{if(_0x513bf8[0x0][_0x52e189(0x12a)]=='German')var _0x303134=users[_0x52e189(0x184)];else{if(_0x513bf8[0x0][_0x52e189(0x12a)]==_0x52e189(0x1a3))var _0x303134=users[_0x52e189(0x1a3)];else{if(_0x513bf8[0x0][_0x52e189(0x12a)]==_0x52e189(0xf3))var _0x303134=users['French'];else{if(_0x513bf8[0x0][_0x52e189(0x12a)]=='Portuguese\x20(BR)')var _0x303134=users[_0x52e189(0x146)];else{if(_0x513bf8[0x0][_0x52e189(0x12a)]=='Chinese')var _0x303134=users[_0x52e189(0x1cf)];else{if(_0x513bf8[0x0][_0x52e189(0x12a)]==_0x52e189(0x11e))var _0x303134=users[_0x52e189(0x10a)];}}}}}}}_0xcc4ebc[_0x52e189(0x1a2)](_0x52e189(0x121),{'success':_0x390715[_0x52e189(0x1a9)](_0x52e189(0xfd)),'errors':_0x390715['flash'](_0x52e189(0x15e)),'role':_0x526883,'profile':_0x5b62de,'user':_0x4578d8,'stock':_0x2ccfa1,'master_shop':_0x513bf8,'unit':_0x4340d9,'language':_0x303134,'warehouses':_0x44455d,'rooms':_0x8635b4,'warehouse_QA':_0x356182});}catch(_0x435ef3){console[_0x52e189(0x1b7)](_0x435ef3),_0xcc4ebc[_0x52e189(0xfb)](0xc8)[_0x52e189(0x12b)]({'message':_0x435ef3[_0x52e189(0xea)]});}}),router[a0_0x72e872(0x17d)](a0_0x72e872(0x173),auth,async(_0xb16fed,_0x55f31a)=>{var _0x4f100b=a0_0x72e872;if(_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xbc)]=='QA')try{const {invoice:_0x50a6f7,date:_0x59ec84,warehouse_name:_0x49ffcc,product_name:_0x40fe6f,primary_code:_0x5c91b2,secondary_code:_0x89a8e4,product_code:_0x101bc2,sales_quantity:_0x18b668,stocks:_0x473d4b,return_qty:_0x31eb7b,Room_name:_0x2890a3,to_warehouse_name_QA:_0xe25458,to_Room_name_QA:_0x3ca9b3,note:_0x16b0cb,for_categorize:_0x2853f3,product_name_QA1:_0x329e48}=_0xb16fed[_0x4f100b(0x1c7)];if(typeof _0x329e48==_0x4f100b(0x13f))var _0xbf1393=[_0xb16fed['body']['product_name_QA1']],_0x153b43=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xd5)]],_0x506e1b=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xf1)]],_0x4f611a=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xe6)]],_0x3d2ace=[_0xb16fed['body'][_0x4f100b(0x134)]],_0x1d2b93=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xe1)]],_0x400b8f=[_0xb16fed['body']['return_qty_QA']],_0x382772=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xe9)]],_0x3b5dba=[_0xb16fed[_0x4f100b(0x1c7)]['maxProducts_QA']],_0x4278e2=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1ac)]],_0x5bb19b=[_0xb16fed[_0x4f100b(0x1c7)]['secondary_unit_QA']],_0x29f95f=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x123)]],_0x237835=[_0xb16fed[_0x4f100b(0x1c7)]['production_date_QA']],_0x2fb224=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1a0)]];else var _0xbf1393=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1d6)]],_0x153b43=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xd5)]],_0x506e1b=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xf1)]],_0x4f611a=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xe6)]],_0x3d2ace=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x134)]],_0x1d2b93=[..._0xb16fed['body'][_0x4f100b(0xe1)]],_0x400b8f=[..._0xb16fed[_0x4f100b(0x1c7)]['return_qty_QA']],_0x382772=[..._0xb16fed[_0x4f100b(0x1c7)]['maxPerUnit_QA']],_0x3b5dba=[..._0xb16fed['body']['maxProducts_QA']],_0x4278e2=[..._0xb16fed[_0x4f100b(0x1c7)]['batch_code_QA']],_0x5bb19b=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xd3)]],_0x29f95f=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x123)]],_0x237835=[..._0xb16fed[_0x4f100b(0x1c7)]['production_date_QA']],_0x2fb224=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1a0)]];const _0x58fe49=_0xbf1393[_0x4f100b(0xf8)](_0x25af91=>{return _0x25af91={'product_name':_0x25af91};});_0x153b43[_0x4f100b(0xd7)]((_0x13873a,_0x163751)=>{var _0x1d7a61=_0x4f100b;_0x58fe49[_0x163751][_0x1d7a61(0x1ab)]=_0x13873a;}),_0x506e1b[_0x4f100b(0xd7)]((_0x442ca0,_0x4a922d)=>{_0x58fe49[_0x4a922d]['secondary_code']=_0x442ca0;}),_0x4f611a['forEach']((_0x1ce0f0,_0x1396f6)=>{var _0x150ae2=_0x4f100b;_0x58fe49[_0x1396f6][_0x150ae2(0x107)]=_0x1ce0f0;}),_0x3d2ace['forEach']((_0x39e8b5,_0x55c1aa)=>{var _0x319246=_0x4f100b;_0x58fe49[_0x55c1aa][_0x319246(0x14a)]=_0x39e8b5;}),_0x1d2b93[_0x4f100b(0xd7)]((_0x501539,_0x36a55f)=>{var _0x345e29=_0x4f100b;_0x58fe49[_0x36a55f][_0x345e29(0x18c)]=_0x501539;}),_0x400b8f['forEach']((_0x5705f6,_0x301f2f)=>{var _0x2c69cf=_0x4f100b;_0x58fe49[_0x301f2f][_0x2c69cf(0x102)]=_0x5705f6;}),_0x382772['forEach']((_0x226809,_0x10e78b)=>{var _0x54e7dc=_0x4f100b;_0x58fe49[_0x10e78b][_0x54e7dc(0xcb)]=_0x226809;}),_0x3b5dba[_0x4f100b(0xd7)]((_0x567ef4,_0x5444a9)=>{var _0x23526b=_0x4f100b;_0x58fe49[_0x5444a9][_0x23526b(0x12d)]=_0x567ef4;}),_0x4278e2[_0x4f100b(0xd7)]((_0x1530eb,_0x5c70d1)=>{var _0x293df8=_0x4f100b;_0x58fe49[_0x5c70d1][_0x293df8(0x1d5)]=_0x1530eb;}),_0x5bb19b[_0x4f100b(0xd7)]((_0x40e25f,_0x600247)=>{_0x58fe49[_0x600247]['secondary_unit']=_0x40e25f;}),_0x29f95f[_0x4f100b(0xd7)]((_0x3febae,_0x4ebca0)=>{var _0x3eba6e=_0x4f100b;_0x58fe49[_0x4ebca0][_0x3eba6e(0x11d)]=_0x3febae;}),_0x237835[_0x4f100b(0xd7)]((_0x598462,_0x9574a6)=>{_0x58fe49[_0x9574a6]['production_date']=_0x598462;}),_0x2fb224[_0x4f100b(0xd7)]((_0x44897d,_0x4b80ad)=>{_0x58fe49[_0x4b80ad]['expiry_date']=_0x44897d;});const _0x2cbc03=await sales_finished[_0x4f100b(0x1c5)]({'invoice':_0x50a6f7});_0x2cbc03[_0x4f100b(0x159)]=_0x4f100b(0x106);const _0x242849=await _0x2cbc03[_0x4f100b(0x154)](),_0x442ba7=new sales_return_finished({'invoice':_0x50a6f7,'customer':_0xb16fed['body'][_0x4f100b(0x1c0)],'date':_0x59ec84,'warehouse_name':_0x49ffcc,'room':_0x2890a3,'ToWarehouse':_0xe25458,'ToRoom':_0x3ca9b3,'return_sale_QA':_0x58fe49,'note':_0x16b0cb,'warehouse_cat':_0x2853f3}),_0x288795=await _0x442ba7['save'](),_0x3a1216=await sales_return_finished[_0x4f100b(0x1c5)]({'invoice':_0x50a6f7}),_0x3bb19c=await warehouse['findOne']({'name':_0xe25458,'room':_0x3ca9b3});_0x3a1216[_0x4f100b(0x1ce)]['forEach'](_0x2bdfeb=>{var _0x41c287=_0x4f100b,_0x5d5d6a=0x0;const _0x442496=_0x3bb19c[_0x41c287(0xc0)][_0x41c287(0xf8)](_0x200250=>{var _0x11b85a=_0x41c287;_0x200250[_0x11b85a(0xd8)]==_0x2bdfeb[_0x11b85a(0xd8)]&&_0x200250[_0x11b85a(0x13c)]==_0x2bdfeb['expiry_date']&&_0x200250[_0x11b85a(0xc7)]==_0x2bdfeb[_0x11b85a(0xc7)]&&_0x200250[_0x11b85a(0x1d5)]==_0x2bdfeb[_0x11b85a(0x1d5)]&&(_0x200250['product_stock']=parseInt(_0x200250[_0x11b85a(0x13a)])+parseInt(_0x2bdfeb[_0x11b85a(0x102)]),_0x5d5d6a++);});_0x5d5d6a=='0'&&(_0x3bb19c[_0x41c287(0xc0)]=_0x3bb19c[_0x41c287(0xc0)][_0x41c287(0x163)]({'product_name':_0x2bdfeb[_0x41c287(0xd8)],'product_stock':_0x2bdfeb['return_qty'],'primary_code':_0x2bdfeb[_0x41c287(0x1ab)],'secondary_code':_0x2bdfeb['secondary_code'],'product_code':_0x2bdfeb[_0x41c287(0x107)],'batch_code':_0x2bdfeb[_0x41c287(0x1d5)],'maxPerUnit':_0x2bdfeb[_0x41c287(0xcb)],'production_date':_0x2bdfeb['production_date'],'expiry_date':_0x2bdfeb['expiry_date'],'secondary_unit':_0x2bdfeb[_0x41c287(0x1b5)],'unit':_0x2bdfeb[_0x41c287(0x11d)],'maxProducts':_0x2bdfeb['maxProducts'],'bay':_0x2bdfeb[_0x41c287(0x18b)]}));}),await _0x3bb19c[_0x4f100b(0x154)]();const _0x59a686=new c_payment_data({'invoice':_0x50a6f7,'customer':_0xb16fed[_0x4f100b(0x1c7)]['customer'],'reason':_0x4f100b(0x186)});await _0x59a686[_0x4f100b(0x154)]();const _0x5836a1=await master_shop[_0x4f100b(0x176)](),_0x230b02=await email_settings[_0x4f100b(0x1c5)](),_0x2448cb=await customer['findOne']({'name':_0xb16fed['body'][_0x4f100b(0x1c0)]});_0x5836a1[0x0][_0x4f100b(0xec)]==0x1?(right_currency=_0x5836a1[0x0][_0x4f100b(0x1bd)],left_currency=''):(right_currency='',left_currency=_0x5836a1[0x0][_0x4f100b(0x1bd)]);var _0x3d9124=_0xbf1393,_0xe0ce3b=_0x400b8f,_0x35d73b='',_0x8cf178;for(_0x8cf178 in _0x3d9124){_0x35d73b+=_0x4f100b(0xd6)+_0x4f100b(0xd2)+_0x3d9124[_0x8cf178]+_0x4f100b(0xe2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xe0ce3b[_0x8cf178]+'</td>'+_0x4f100b(0x133);}console['log']('product_list',_0x35d73b);let _0x50ea69=nodemailer[_0x4f100b(0x164)]({'service':_0x4f100b(0x170),'auth':{'user':_0x230b02[_0x4f100b(0x18f)],'pass':_0x230b02[_0x4f100b(0xe4)]}}),_0x5950b8={'from':_0x230b02[_0x4f100b(0x18f)],'to':_0x2448cb[_0x4f100b(0x18f)],'subject':_0x4f100b(0x132),'attachments':[{'filename':_0x4f100b(0x17e),'path':__dirname+'/../public'+_0x4f100b(0x13d)+_0x5836a1[0x0][_0x4f100b(0xfa)],'cid':_0x4f100b(0xf2)}],'html':_0x4f100b(0x141)+_0x4f100b(0x1c8)+_0x4f100b(0x18e)+_0x4f100b(0x10b)+_0x4f100b(0x120)+_0x4f100b(0x10b)+_0x4f100b(0x1b9)+_0x4f100b(0x196)+_0x4f100b(0x10b)+_0x4f100b(0x165)+_0x5836a1[0x0][_0x4f100b(0xd0)]+_0x4f100b(0x15d)+_0x4f100b(0x196)+_0x4f100b(0x196)+_0x4f100b(0x10e)+_0x4f100b(0x10b)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x4f100b(0x1bb)+_0x50a6f7+'\x20'+_0x4f100b(0x139)+_0x4f100b(0x171)+_0x59ec84+'\x20'+'</span>'+_0x4f100b(0x105)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4f100b(0x156)+'<tr>'+_0x4f100b(0x143)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x4f100b(0x199)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+'</tr>'+'</thead>'+_0x4f100b(0x129)+'\x20'+_0x35d73b+'\x20'+_0x4f100b(0x148)+'</table>'+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x5836a1[0x0][_0x4f100b(0xd0)]+_0x4f100b(0x105)+_0x4f100b(0x196)+_0x4f100b(0x196)+'</body></html>'};_0x50ea69[_0x4f100b(0x166)](_0x5950b8,function(_0x1ef297,_0x184e01){var _0x209b69=_0x4f100b;_0x1ef297?(console['log'](_0x1ef297),console['log'](_0x209b69(0x18d))):console['log']('Email\x20sent\x20successfully');}),_0xb16fed[_0x4f100b(0x1a9)]('success',_0x4f100b(0x125)),_0x55f31a['redirect'](_0x4f100b(0x169));}catch(_0x5a5cc6){_0x55f31a[_0x4f100b(0xfb)](0xc8)[_0x4f100b(0x12b)]({'message1':_0x5a5cc6['message']});}else{if(_0xb16fed['body'][_0x4f100b(0xbc)]=='GS')try{const {invoice:_0x18497b,date:_0x519f4c,warehouse_name:_0x1e34a9,product_name:_0x2b29b9,primary_code:_0x1e1c55,secondary_code:_0x501d45,product_code:_0x3342e0,sales_quantity:_0x349f02,stocks:_0x25f443,return_qty:_0xe621fa,Room_name:_0x462918,to_warehouse_name:_0x231501,to_Room_name:_0x3365cb,note:_0xb48b31,level:_0x5d4ddb,isle:_0xe1ac6,pallet:_0x27370b,for_categorize:_0x3fd761}=_0xb16fed[_0x4f100b(0x1c7)];if(typeof _0x2b29b9=='string')var _0xbf1393=[_0xb16fed['body'][_0x4f100b(0xd8)]],_0x153b43=[_0xb16fed['body'][_0x4f100b(0x1ab)]],_0x506e1b=[_0xb16fed['body'][_0x4f100b(0xcd)]],_0x4f611a=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x107)]],_0x3d2ace=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1ad)]],_0x400b8f=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x102)]],_0xd509b1=[_0xb16fed['body'][_0x4f100b(0x18b)]],_0x382772=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xcb)]],_0x3b5dba=[_0xb16fed['body'][_0x4f100b(0x12d)]],_0x4278e2=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1d5)]],_0x5bb19b=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1b5)]],_0x29f95f=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x11d)]],_0x237835=[_0xb16fed['body'][_0x4f100b(0xc7)]],_0x2fb224=[_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x13c)]];else var _0xbf1393=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xd8)]],_0x153b43=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1ab)]],_0x506e1b=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xcd)]],_0x4f611a=[..._0xb16fed['body'][_0x4f100b(0x107)]],_0x3d2ace=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1ad)]],_0x400b8f=[..._0xb16fed['body'][_0x4f100b(0x102)]],_0xd509b1=[..._0xb16fed['body']['bay']],_0x382772=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xcb)]],_0x3b5dba=[..._0xb16fed[_0x4f100b(0x1c7)]['maxProducts']],_0x4278e2=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1d5)]],_0x5bb19b=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1b5)]],_0x29f95f=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x11d)]],_0x237835=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0xc7)]],_0x2fb224=[..._0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x13c)]];const _0x489a45=_0xbf1393[_0x4f100b(0xf8)](_0x46e4af=>{return _0x46e4af={'product_name':_0x46e4af};});_0x153b43[_0x4f100b(0xd7)]((_0x5d0f08,_0x3bd42d)=>{var _0x367560=_0x4f100b;_0x489a45[_0x3bd42d][_0x367560(0x1ab)]=_0x5d0f08;}),_0x506e1b[_0x4f100b(0xd7)]((_0x1924d5,_0x4ed974)=>{var _0x36d537=_0x4f100b;_0x489a45[_0x4ed974][_0x36d537(0xcd)]=_0x1924d5;}),_0x4f611a[_0x4f100b(0xd7)]((_0xe16982,_0xd34d5)=>{var _0x498362=_0x4f100b;_0x489a45[_0xd34d5][_0x498362(0x107)]=_0xe16982;}),_0x3d2ace['forEach']((_0x5dc756,_0x5ef256)=>{var _0x1bfeef=_0x4f100b;_0x489a45[_0x5ef256][_0x1bfeef(0x14a)]=_0x5dc756;}),_0x400b8f[_0x4f100b(0xd7)]((_0x372313,_0x5b3001)=>{_0x489a45[_0x5b3001]['return_qty']=_0x372313;}),_0xd509b1[_0x4f100b(0xd7)]((_0x373520,_0xbf2178)=>{var _0x19f9fa=_0x4f100b;_0x489a45[_0xbf2178][_0x19f9fa(0x18b)]=_0x373520;}),_0x382772['forEach']((_0x51bcef,_0x1061d2)=>{var _0x2d9aaf=_0x4f100b;_0x489a45[_0x1061d2][_0x2d9aaf(0xcb)]=_0x51bcef;}),_0x3b5dba[_0x4f100b(0xd7)]((_0x29676b,_0x5a0d30)=>{var _0x2d5baa=_0x4f100b;_0x489a45[_0x5a0d30][_0x2d5baa(0x12d)]=_0x29676b;}),_0x4278e2[_0x4f100b(0xd7)]((_0x544f23,_0x13d539)=>{var _0x1ad466=_0x4f100b;_0x489a45[_0x13d539][_0x1ad466(0x1d5)]=_0x544f23;}),_0x5bb19b[_0x4f100b(0xd7)]((_0x451f1d,_0x388596)=>{var _0x36dbef=_0x4f100b;_0x489a45[_0x388596][_0x36dbef(0x1b5)]=_0x451f1d;}),_0x29f95f[_0x4f100b(0xd7)]((_0x15dd1d,_0x40425c)=>{var _0x17e942=_0x4f100b;_0x489a45[_0x40425c][_0x17e942(0x11d)]=_0x15dd1d;}),_0x237835[_0x4f100b(0xd7)]((_0x2bb6e7,_0x3b9a8a)=>{var _0x501327=_0x4f100b;_0x489a45[_0x3b9a8a][_0x501327(0xc7)]=_0x2bb6e7;}),_0x2fb224[_0x4f100b(0xd7)]((_0x46ea13,_0x1e5a63)=>{var _0x8319c2=_0x4f100b;_0x489a45[_0x1e5a63][_0x8319c2(0x13c)]=_0x46ea13;});var _0x431ef4=0x0;_0x489a45[_0x4f100b(0xd7)](_0x5920ee=>{var _0x6aa41a=_0x4f100b;(parseInt(_0x5920ee[_0x6aa41a(0x14a)])<parseInt(_0x5920ee[_0x6aa41a(0x102)])||parseInt(_0x5920ee[_0x6aa41a(0x18c)])<parseInt(_0x5920ee[_0x6aa41a(0x102)])&&parseInt(_0x5920ee[_0x6aa41a(0x14a)])>parseInt(_0x5920ee[_0x6aa41a(0x102)])||parseInt(_0x5920ee[_0x6aa41a(0x102)])==0x0)&&_0x431ef4++;});if(_0x431ef4!=0x0)return _0xb16fed['flash']('errors',_0x4f100b(0x10d)),_0x55f31a[_0x4f100b(0x174)](_0x4f100b(0x1c6));const _0x6e7b9d=await sales_finished[_0x4f100b(0x1c5)]({'invoice':_0x18497b});_0x6e7b9d['return_data']=_0x4f100b(0x106);const _0x1d02bc=await _0x6e7b9d[_0x4f100b(0x154)](),_0x12d273=new sales_return_finished({'invoice':_0x18497b,'customer':_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1c0)],'date':_0x519f4c,'warehouse_name':_0x1e34a9,'room':_0x462918,'ToWarehouse':_0x231501,'ToRoom':_0x3365cb,'return_sale':_0x489a45,'note':_0xb48b31,'warehouse_cat':_0x3fd761}),_0x55f5e7=await _0x12d273[_0x4f100b(0x154)](),_0x51018b=await sales_return_finished[_0x4f100b(0x1c5)]({'invoice':_0x18497b}),_0x10bffe=await warehouse[_0x4f100b(0x1c5)]({'name':_0x231501,'room':_0x3365cb,'warehouse_category':_0x4f100b(0x16a)});_0x51018b[_0x4f100b(0xf6)]['forEach'](_0x4fabc8=>{var _0x48b326=_0x4f100b,_0x35c439=0x0;const _0x393d35=_0x10bffe[_0x48b326(0xc0)][_0x48b326(0xf8)](_0x1a7a3a=>{var _0xf7d3e7=_0x48b326;_0x1a7a3a[_0xf7d3e7(0xd8)]==_0x4fabc8['product_name']&&_0x1a7a3a[_0xf7d3e7(0x18b)]==_0x4fabc8['bay']&&_0x1a7a3a['expiry_date']==_0x4fabc8[_0xf7d3e7(0x13c)]&&_0x1a7a3a['production_date']==_0x4fabc8['production_date']&&_0x1a7a3a[_0xf7d3e7(0x1d5)]==_0x4fabc8[_0xf7d3e7(0x1d5)]&&(_0x1a7a3a['product_stock']=parseInt(_0x1a7a3a[_0xf7d3e7(0x13a)])+parseInt(_0x4fabc8[_0xf7d3e7(0x102)]),_0x35c439++);});_0x35c439=='0'&&(_0x10bffe[_0x48b326(0xc0)]=_0x10bffe[_0x48b326(0xc0)][_0x48b326(0x163)]({'product_name':_0x4fabc8[_0x48b326(0xd8)],'product_stock':_0x4fabc8['return_qty'],'primary_code':_0x4fabc8[_0x48b326(0x1ab)],'secondary_code':_0x4fabc8[_0x48b326(0xcd)],'product_code':_0x4fabc8[_0x48b326(0x107)],'bay':_0x4fabc8[_0x48b326(0x18b)],'batch_code':_0x4fabc8['batch_code'],'maxPerUnit':_0x4fabc8['maxPerUnit'],'production_date':_0x4fabc8[_0x48b326(0xc7)],'expiry_date':_0x4fabc8[_0x48b326(0x13c)],'secondary_unit':_0x4fabc8[_0x48b326(0x1b5)],'unit':_0x4fabc8[_0x48b326(0x11d)],'maxProducts':_0x4fabc8[_0x48b326(0x12d)]}));}),await _0x10bffe[_0x4f100b(0x154)](),console[_0x4f100b(0x1b7)](_0xb16fed[_0x4f100b(0x1c7)]);const _0x568fd0=new c_payment_data({'invoice':_0x18497b,'customer':_0xb16fed['body'][_0x4f100b(0x1c0)],'reason':'Sale\x20Return'});await _0x568fd0[_0x4f100b(0x154)]();const _0x4d81be=await master_shop[_0x4f100b(0x176)]();console[_0x4f100b(0x1b7)](_0x4f100b(0x15c),_0x4d81be[0x0][_0x4f100b(0xfa)]);const _0x5732a5=await email_settings[_0x4f100b(0x1c5)](),_0x1ba920=await customer[_0x4f100b(0x1c5)]({'name':_0xb16fed[_0x4f100b(0x1c7)][_0x4f100b(0x1c0)]});console['log'](_0x4f100b(0x1c3),_0x1ba920);_0x4d81be[0x0][_0x4f100b(0xec)]==0x1?(right_currency=_0x4d81be[0x0][_0x4f100b(0x1bd)],left_currency=''):(right_currency='',left_currency=_0x4d81be[0x0][_0x4f100b(0x1bd)]);var _0x3d9124=_0xbf1393,_0xe0ce3b=_0x400b8f,_0x35d73b='',_0x8cf178;for(_0x8cf178 in _0x3d9124){_0x35d73b+=_0x4f100b(0xd6)+_0x4f100b(0xd2)+_0x3d9124[_0x8cf178]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xe0ce3b[_0x8cf178]+_0x4f100b(0xe2)+_0x4f100b(0x133);}console[_0x4f100b(0x1b7)]('product_list',_0x35d73b);let _0x22ce9a=nodemailer['createTransport']({'service':_0x4f100b(0x170),'auth':{'user':_0x5732a5[_0x4f100b(0x18f)],'pass':_0x5732a5[_0x4f100b(0xe4)]}}),_0x14e079={'from':_0x5732a5[_0x4f100b(0x18f)],'to':_0x1ba920[_0x4f100b(0x18f)],'subject':_0x4f100b(0x132),'attachments':[{'filename':_0x4f100b(0x17e),'path':__dirname+_0x4f100b(0x12f)+_0x4f100b(0x13d)+_0x4d81be[0x0][_0x4f100b(0xfa)],'cid':'logo'}],'html':_0x4f100b(0x141)+_0x4f100b(0x1c8)+_0x4f100b(0x18e)+_0x4f100b(0x10b)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x4f100b(0x1b9)+_0x4f100b(0x196)+_0x4f100b(0x10b)+'<h2>\x20'+_0x4d81be[0x0][_0x4f100b(0xd0)]+'\x20</h2>'+_0x4f100b(0x196)+'</div>'+_0x4f100b(0x10e)+'<div>'+_0x4f100b(0x1a4)+_0x4f100b(0x1bb)+_0x18497b+'\x20'+_0x4f100b(0x139)+_0x4f100b(0x171)+_0x519f4c+'\x20'+'</span>'+'</h5>'+_0x4f100b(0x196)+_0x4f100b(0x11f)+_0x4f100b(0x156)+_0x4f100b(0xd6)+_0x4f100b(0x143)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x4f100b(0x199)+_0x4f100b(0x195)+_0x4f100b(0x133)+_0x4f100b(0x100)+_0x4f100b(0x129)+'\x20'+_0x35d73b+'\x20'+_0x4f100b(0x148)+_0x4f100b(0xdb)+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x4d81be[0x0][_0x4f100b(0xd0)]+_0x4f100b(0x105)+_0x4f100b(0x196)+_0x4f100b(0x196)+'</body></html>'};_0x22ce9a[_0x4f100b(0x166)](_0x14e079,function(_0x5629fc,_0x558de6){var _0x4564ad=_0x4f100b;_0x5629fc?(console['log'](_0x5629fc),console[_0x4564ad(0x1b7)](_0x4564ad(0x18d))):console[_0x4564ad(0x1b7)](_0x4564ad(0x136));}),_0xb16fed[_0x4f100b(0x1a9)](_0x4f100b(0xfd),_0x4f100b(0x125)),_0x55f31a[_0x4f100b(0x174)](_0x4f100b(0x169));}catch(_0x32322e){console[_0x4f100b(0x1b7)](_0x32322e),_0x55f31a[_0x4f100b(0xfb)](0xc8)['json']({'message1':_0x32322e[_0x4f100b(0xea)]});}}}),router[a0_0x72e872(0x1d3)]('/barcode/:id',auth,async(_0x3b0de5,_0xb20b8b)=>{var _0x484825=a0_0x72e872;try{const {username:_0x3365d5,email:_0x37add9,role:_0x386ac4}=_0x3b0de5[_0x484825(0x114)],_0x24ce31=_0x3b0de5[_0x484825(0x114)],_0x1c9c4c=await profile[_0x484825(0x1c5)]({'email':_0x24ce31['email']}),_0x50256e=await master_shop['find']();console['log'](_0x484825(0x110),_0x50256e);const _0x71bd39=_0x3b0de5[_0x484825(0x177)]['id'],_0x14b31b=await sales[_0x484825(0x15a)](_0x71bd39);console['log'](_0x484825(0x1c1),_0x14b31b);if(_0x50256e[0x0][_0x484825(0x12a)]==_0x484825(0x113))var _0x21fc96=users[_0x484825(0x137)];else{if(_0x50256e[0x0][_0x484825(0x12a)]=='Hindi')var _0x21fc96=users['Hindi'];else{if(_0x50256e[0x0][_0x484825(0x12a)]==_0x484825(0x184))var _0x21fc96=users['German'];else{if(_0x50256e[0x0][_0x484825(0x12a)]==_0x484825(0x1a3))var _0x21fc96=users[_0x484825(0x1a3)];else{if(_0x50256e[0x0]['language']==_0x484825(0xf3))var _0x21fc96=users[_0x484825(0xf3)];else{if(_0x50256e[0x0][_0x484825(0x12a)]==_0x484825(0x1d1))var _0x21fc96=users['Portuguese'];else{if(_0x50256e[0x0][_0x484825(0x12a)]==_0x484825(0x1cf))var _0x21fc96=users[_0x484825(0x1cf)];else{if(_0x50256e[0x0][_0x484825(0x12a)]==_0x484825(0x11e))var _0x21fc96=users[_0x484825(0x10a)];}}}}}}}_0xb20b8b['render'](_0x484825(0x153),{'success':_0x3b0de5['flash'](_0x484825(0xfd)),'errors':_0x3b0de5[_0x484825(0x1a9)](_0x484825(0x15e)),'role':_0x24ce31,'profile':_0x1c9c4c,'alldata':_0x14b31b,'master_shop':_0x50256e,'language':_0x21fc96});}catch(_0x3ae0fa){console[_0x484825(0x1b7)](_0x3ae0fa);}}),router['post'](a0_0x72e872(0x19f),async(_0x390b25,_0x4f09b9)=>{var _0xf969bc=a0_0x72e872;const {product_code:_0x413718,warehouse_name:_0xd23c,rooms_data:_0x1838d6,Roomslist:_0x477071,sales_category:_0x453a02}=_0x390b25[_0xf969bc(0x1c7)],_0x34742d=_0x477071['split'](','),_0x5d02f9=[];async function _0x2c3822(_0x337116){var _0x55114a=_0xf969bc;const _0x1700a3=await warehouse['aggregate']([{'$match':{'name':_0xd23c,'room':_0x337116}},{'$unwind':_0x55114a(0x172)},{'$match':{'product_details.primary_code':_0x413718}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x55114a(0x147)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x55114a(0xd1)},'secondary_code':{'$first':_0x55114a(0x13e)},'product_code':{'$first':_0x55114a(0x15b)},'level':{'$first':_0x55114a(0xe7)},'bay':{'$first':_0x55114a(0x192)},'type':{'$first':_0x55114a(0x14e)},'pallet':{'$first':_0x55114a(0xee)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x55114a(0x130)},'storage':{'$first':_0x55114a(0x124)},'rack':{'$first':_0x55114a(0x151)},'expiry_date':{'$first':_0x55114a(0x127)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x55114a(0x13b)},'batch_code':{'$first':_0x55114a(0x1b3)},'product_cat':{'$first':_0x55114a(0x19e)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x55114a(0x1aa)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x55114a(0xbe)},'sales_category':{'$first':_0x55114a(0x1b8)}}}]),_0x3c8f80=await warehouse[_0x55114a(0x19b)]([{'$match':{'name':_0xd23c,'room':_0x337116}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x413718}},{'$group':{'_id':_0x55114a(0x18a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x55114a(0xe3)},'primary_code':{'$first':_0x55114a(0xd1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x55114a(0x15b)},'level':{'$first':_0x55114a(0x192)},'isle':{'$first':_0x55114a(0xbd)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x55114a(0xee)},'unit':{'$first':_0x55114a(0xce)},'secondary_unit':{'$first':_0x55114a(0x130)},'storage':{'$first':_0x55114a(0x124)},'rack':{'$first':_0x55114a(0x151)},'expiry_date':{'$first':_0x55114a(0x127)},'production_date':{'$first':_0x55114a(0x16e)},'maxPerUnit':{'$first':_0x55114a(0x13b)},'batch_code':{'$first':_0x55114a(0x1b3)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x55114a(0x1aa)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x55114a(0x1be)},'gross_price':{'$first':_0x55114a(0xbe)},'sales_category':{'$first':_0x55114a(0x1b8)}}}]);if(_0x1700a3[_0x55114a(0x1b4)]>0x0)_0x5d02f9['push'](_0x1700a3);else _0x3c8f80[_0x55114a(0x1b4)]>0x0&&_0x5d02f9['push'](_0x3c8f80);}const _0x2fbecd=_0x34742d[_0xf969bc(0xf8)](_0x3b3bd1=>_0x2c3822(_0x3b3bd1));await Promise['all'](_0x2fbecd),_0x4f09b9[_0xf969bc(0x12b)](_0x5d02f9);}),router[a0_0x72e872(0x17d)](a0_0x72e872(0x111),async(_0x177f85,_0x4a8576)=>{var _0x533cf2=a0_0x72e872;const {product_code:_0x41af71,warehouse_name:_0x27041e,rooms_data:_0x3e1125,Roomslist:_0x559b50,sales_category:_0x48f7c7}=_0x177f85['body'],_0x1b2d1c=_0x559b50[_0x533cf2(0xff)](','),_0x3d9fb2=[];async function _0x2c0e1b(_0x4a1241){var _0x50c8d1=_0x533cf2;const _0x3b662c=await warehouse['aggregate']([{'$match':{'name':_0x27041e,'room':_0x4a1241}},{'$unwind':_0x50c8d1(0x172)},{'$match':{'product_details.primary_code':_0x41af71,'product_details.sales_category':_0x48f7c7,'product_details.type_products':'log'}},{'$group':{'_id':_0x50c8d1(0x18a),'name':{'$first':_0x50c8d1(0x147)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x50c8d1(0xd1)},'secondary_code':{'$first':_0x50c8d1(0x13e)},'product_code':{'$first':_0x50c8d1(0x15b)},'level':{'$first':_0x50c8d1(0xe7)},'bay':{'$first':_0x50c8d1(0x192)},'type':{'$first':_0x50c8d1(0x14e)},'pallet':{'$first':_0x50c8d1(0xee)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x50c8d1(0x124)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x50c8d1(0x127)},'production_date':{'$first':_0x50c8d1(0x16e)},'maxPerUnit':{'$first':_0x50c8d1(0x13b)},'batch_code':{'$first':_0x50c8d1(0x1b3)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x50c8d1(0x1aa)},'invoice':{'$first':_0x50c8d1(0xf4)},'uuid':{'$first':_0x50c8d1(0x1be)},'gross_price':{'$first':_0x50c8d1(0xbe)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':_0x50c8d1(0x1b2)}}}]);console[_0x50c8d1(0x1b7)](_0x50c8d1(0x1b7)+_0x50c8d1(0xdf)+_0x41af71+_0x50c8d1(0xdf)+_0x48f7c7);const _0xe60060=await warehouse[_0x50c8d1(0x19b)]([{'$match':{'name':_0x27041e,'room':_0x4a1241}},{'$unwind':_0x50c8d1(0x172)},{'$match':{'product_details.secondary_code':_0x41af71,'product_details.sales_category':_0x48f7c7,'product_details.type_products':_0x50c8d1(0x1b7)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x50c8d1(0xe3)},'primary_code':{'$first':_0x50c8d1(0xd1)},'secondary_code':{'$first':_0x50c8d1(0x13e)},'product_code':{'$first':_0x50c8d1(0x15b)},'level':{'$first':_0x50c8d1(0x192)},'isle':{'$first':_0x50c8d1(0xbd)},'type':{'$first':_0x50c8d1(0x14e)},'pallet':{'$first':_0x50c8d1(0xee)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x50c8d1(0x130)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x50c8d1(0x151)},'expiry_date':{'$first':_0x50c8d1(0x127)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x50c8d1(0x13b)},'batch_code':{'$first':_0x50c8d1(0x1b3)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x50c8d1(0x1aa)},'invoice':{'$first':_0x50c8d1(0xf4)},'uuid':{'$first':_0x50c8d1(0x1be)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x50c8d1(0x1b8)},'type_products':{'$first':_0x50c8d1(0x1b2)}}}]);if(_0x3b662c[_0x50c8d1(0x1b4)]>0x0)_0x3d9fb2[_0x50c8d1(0xd9)](_0x3b662c);else _0xe60060[_0x50c8d1(0x1b4)]>0x0&&_0x3d9fb2['push'](_0xe60060);}const _0x1775bc=_0x1b2d1c['map'](_0x30c841=>_0x2c0e1b(_0x30c841));await Promise[_0x533cf2(0x10f)](_0x1775bc),_0x4a8576['json'](_0x3d9fb2);}),module[a0_0x72e872(0x150)]=router;function a0_0x389a(){var _0x1ed057=['toString','production_date','adjust_qty','outgoing_invoice','match','maxPerUnit','edit_sales_finished_view','secondary_code','$product_details.unit','/view_log','site_title','$product_details.primary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','secondary_unit_QA','gross_price','primary_code_QA','<tr>','forEach','product_name','push','here','</table>','Ambient','finalize','all_sales_finished','\x20<>\x20','_id','stocks_QA','</td>','$product_details.product_stock','password','abs','product_code_QA','$product_details.level','prod_code','maxPerUnit_QA','message','updateOne','currency_placement','Enclosed','$product_details.floorlevel','quantity','random','secondary_code_QA','logo','French','$product_details.invoice','floor','return_sale','/preview/:id','map','../middleware/auth','image','status','staff','success','9187578DdmhOK','split','</thead>','due_amount','return_qty','logs','1564136sThfMd','</h5>','True','product_code','OUTF-','add_sales_finished_logs','Arabic','<div>','2428464paiBuz','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','<hr\x20class=\x22my-3\x22>','all','barcode\x20Product\x20master','/barcode_scanner_logs','OUT-','English\x20(US)','user','$sale_product','$note','slice','prod_invoice','getMonth','agent_id','$sale_product.bin','24238IAsSPl','unit','Arabic\x20(ae)','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','return_sale_finished','$customer','unit_QA','$product_details.storage','sales\x20item\x20return\x20successfull','invoice_init','$product_details.expiry_date','$finalize','<tbody\x20style=\x22text-align:\x20center;\x22>','language','json','$date','maxProducts','note','/../public','$product_details.secondary_unit','$_id','Sale\x20Return\x20Mail','</tr>','sales_quantity_QA','undefined','Email\x20sent\x20successfully','English','../models/all_models','<span\x20style=\x22float:\x20right;\x22>','product_stock','$product_details.maxPerUnit','expiry_date','/upload/','$product_details.secondary_code','string','suppliers','<!DOCTYPE\x20html>','$invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','catch','sales','Portuguese','$product_details.product_name','</tbody>','$warehouse_name','sale_qty','edit_sales_finished','level','product_data','$product_details.type','level2','exports','$product_details.rack','valueOf','all_sales_barcode','save','date_data','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','False','received_amount','return_data','findById','$product_details.product_code','add\x20post','\x20</h2>','errors','Sales\x20Add\x20successfully','filter','$sale_product.bay','1414420gPklMG','concat','createTransport','<h2>\x20','sendMail','/view','$name','/all_sales_finished/view','Finished\x20Goods','warehouse_name','/all_sales_finished/preview/','max_per_unit','$product_details.production_date','$product','gmail','\x20Order\x20Date\x20:\x20','$product_details','/view/return_sales/:id','redirect','Enabled','find','params','primary_unit','padStart','sale_product','getFullYear','There\x27s\x20a\x20error\x20in\x20this\x20transaction','post','Logo.png','Router','$product_details.maxProducts','Hindi','master','prod_cat','German','Quality\x20Inspection','Sale\x20Return','$customers_docs','$sale_product.quantity','product_list','$product_details._id','bay','stock','Error\x20Occurs','</head><body>','email','room_name','Sales\x20Update\x20successfully','$product_details.bay','119603ZcIAgG','stock_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','</div>','3upDqwg','RoomAssigned','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','own','aggregate','uuid','express','$product_details.product_cat','/barcode_scanner','expiry_date_QA','sales_invoice','render','Spanish','<h5\x20style=\x22text-align:\x20left;\x22>','$return_data','$sale_product.type','/view/add_sales_logs','role','flash','$room','primary_code','batch_code_QA','sales_quantity','/view/add_sales','amount','then','$product.product_name','$product_details.type_products','$product_details.batch_code','length','secondary_unit','getDate','log','$product_details.sales_category','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Return\x20Goods','\x20Order\x20Number\x20:\x20','nodemailer','currency','$product_details.uuid','carton','customer','barcode\x20user_id','id_transaction_from','customer_data','19398qACctG','findOne','back','body','<html><head><title></title>','/view/:id','add_sales_finished','warehouse','/invoice/:id','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','return_sale_QA','Chinese','product_date','Portuguese\x20(BR)','651Krfxds','get','/give_payment/:id','batch_code','product_name_QA1','Received\x20Payment\x20For\x20Sale','warehouse_id','for_categorize','$product_details.bin','$product_details.gross_price','room','product_details','all_sales_finished_logs','maxperunit','invoice','\x20==\x20','$sale_product.floorlevel'];a0_0x389a=function(){return _0x1ed057;};return a0_0x389a();}