var a0_0x14b807=a0_0x10bc;(function(_0x3e362b,_0x5cc8d4){var _0x32c191=a0_0x10bc,_0x72b16d=_0x3e362b();while(!![]){try{var _0x398c0e=-parseInt(_0x32c191(0x1ff))/0x1*(-parseInt(_0x32c191(0x204))/0x2)+-parseInt(_0x32c191(0x217))/0x3*(parseInt(_0x32c191(0x239))/0x4)+parseInt(_0x32c191(0x29f))/0x5+-parseInt(_0x32c191(0x270))/0x6*(-parseInt(_0x32c191(0x1f0))/0x7)+parseInt(_0x32c191(0x1f7))/0x8+-parseInt(_0x32c191(0x1d2))/0x9*(-parseInt(_0x32c191(0x2a1))/0xa)+-parseInt(_0x32c191(0x252))/0xb;if(_0x398c0e===_0x5cc8d4)break;else _0x72b16d['push'](_0x72b16d['shift']());}catch(_0x5bb504){_0x72b16d['push'](_0x72b16d['shift']());}}}(a0_0x21bc,0x34b21));function a0_0x21bc(){var _0x194bcb=['<thead\x20style=\x22width:\x20100%\x20!important;\x22>','quantity','sales_invoice','/barcode_scanner','/give_payment/:id','18scCXdR','/view/:id','expiry_date','RoomAssigned','valueOf','/barcode_scanner_logs','/view/add_sales','$product_details.product_stock','secondary_code','Enabled','add_sales_finished','room','Finished\x20Goods','$date','/all_sales_finished/preview/','int','prod_invoice','$product_details.sales_category','$product_details.rack','</td>','<!DOCTYPE\x20html>','uuid','toString','random','Email\x20sent\x20successfully','undefined','suppliers','purchases_data','unit','English\x20(US)','$product_details.product_name','\x20==\x20','findById','$sale_product.type','<div>','<tr>','\x20&&\x20','findOne','exports','site_title','</tr>','</thead>','$sale_product.bin','currency','/all_sales_finished/view','$customers_docs','max','1622815xyjnoR','adjust_qty','1603930pSQEOl','invoice','/upload/','<h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$sale_product.floorlevel','$product_details.bay','\x20<>\x20','length','currency_placement','return_data','product_code','$product_details.product_cat','Router','status','$return_data','</table>','$product_details._id','$product_details.production_date','/view/add_sale/product','carton','/barcode/:id','save','primary_code','match','product_data','stock_data','string','express','forEach','map','barcode\x20Product\x20master','$product_details.primary_code','Sale\x20Return','gmail','../public/language/languages.json','$product_details.floorlevel','bay','$_id','maxPerUnit_QA','return_qty','$product_details.unit','nodemailer','/view/add_sales_logs','</h5>','catch','Ambient','customer','False','errors','Quality\x20Inspection','$product_details.invoice','$product_details.expiry_date','/preview/:id','production_date','final','push','production_date_QA','sales','amount','level2','product_stock','$note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$product_details','slice','English','$customer','staff','note','finalize','<html><head><title></title>','updateOne','maxProducts_QA','<h5\x20style=\x22text-align:\x20left;\x22>','$sale_product.quantity','redirect','$product_details.product_code','$sale_product.bay','Sales\x20Update\x20successfully','product_details','9wqzUUM','warehouse','$product_details.bin','Chinese','Spanish','max_per_unit','language','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<hr\x20class=\x22my-3\x22>','all_sales_finished_logs','Sales\x20Add\x20successfully','Error\x20Occurs','</span>','product_name_QA1','Sale\x20Return\x20Mail','agent_id','prod_code','stock','id_transaction_from','abs','$product_details.level','Return\x20Goods','$product_details.uuid','secondary_unit','json','sendMail','received_amount','product_code_QA','$room','<tbody\x20style=\x22text-align:\x20center;\x22>','115661HhqXmR','</head><body>','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','warehouse_id','concat','master','French','2904472IgkXuU','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</div>','level','flash','for_categorize','$product_details.room_name','here','863FASUBm','$product_details.secondary_unit','maxPerUnit','filter','unit_QA','452AECyNX','gross_price','all_sales_finished','Arabic','render','image','user','Portuguese','</tbody>','$product_details.maxPerUnit','$product_details.type_products','edit_sales_finished','sale_product','$invoice','warehouse_name','aggregate','prod_cat','invoice_init','stocks_QA','759nAzszH','Enclosed','$product_details.type','barcode\x20user_id','Hindi','password','/view_log','Logo.png','/view/return_sales/:id','/picking_list/pdf/','sale_qty','\x20Order\x20Number\x20:\x20','\x20</h2>','logo','product_date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','maxProducts','log','payment\x20successfull','$product_details.gross_price','own','product','<span\x20style=\x22float:\x20right;\x22>','secondary_code_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','maxperunit','get','all','$warehouse_name','outgoing_invoice','return_qty_QA','email','$sale_product','back','2804QheqQi','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product.product_name','sales_quantity_QA','<strong>\x20Regards\x20</strong>','$finalize','Portuguese\x20(BR)','primary_unit','foreach\x20newproduct','secondary_unit_QA','add_sales_finished_logs','$product_details.storage','role','body','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','message','LOG-OUT-','return_sale_finished','find','post','batch_code_QA','</body></html>','product_name','expiry_date_QA','\x20Order\x20Date\x20:\x20','7693708vReWtq','add\x20post','logs','params','German','True','date_data','success','_id','getMonth','/../public','../middleware/auth','$name','sales_quantity','$product_details.batch_code','Received\x20Payment\x20For\x20Sale','batch_code','sales\x20item\x20return\x20successfull','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.secondary_code','product_list','split','padStart','OUTF-','Arabic\x20(ae)'];a0_0x21bc=function(){return _0x194bcb;};return a0_0x21bc();}const express=require(a0_0x14b807(0x2bd)),app=express(),router=express[a0_0x14b807(0x2ae)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require('../models/all_models'),auth=require(a0_0x14b807(0x25d)),nodemailer=require(a0_0x14b807(0x2cb)),users=require(a0_0x14b807(0x2c4));router[a0_0x14b807(0x231)]('/view',auth,async(_0x18b66e,_0x556d16)=>{var _0x1ca94a=a0_0x14b807;try{const {username:_0x351e4f,email:_0x36f71e,role:_0x19a038}=_0x18b66e['user'],_0x11f789=_0x18b66e[_0x1ca94a(0x20a)],_0x5bd311=await profile['findOne']({'email':_0x11f789[_0x1ca94a(0x236)]}),_0x12c5f5=await master_shop[_0x1ca94a(0x24b)]();let _0x347019;if(_0x11f789['role']==_0x1ca94a(0x1c5)){const _0x5bd71c=await staff[_0x1ca94a(0x295)]({'email':_0x11f789[_0x1ca94a(0x236)]});_0x347019=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x1ca94a(0x22b)}},{'$unwind':_0x1ca94a(0x237)},{'$group':{'_id':_0x1ca94a(0x2c7),'invoice':{'$first':_0x1ca94a(0x211)},'customers':{'$first':_0x1ca94a(0x1c4)},'date':{'$first':_0x1ca94a(0x27d)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x1ca94a(0x237)},'note':{'$first':'$note'},'return_data':{'$first':_0x1ca94a(0x2b0)},'customers_docs':{'$first':_0x1ca94a(0x29d)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x1ca94a(0x1cf)},'isle':{'$addToSet':_0x1ca94a(0x29a)},'type':{'$addToSet':_0x1ca94a(0x291)},'pallet':{'$addToSet':_0x1ca94a(0x2a6)},'finalize':{'$first':_0x1ca94a(0x23e)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x347019=await sales_finished['aggregate']([{'$match':{'typeOfProducts':'own'}},{'$unwind':_0x1ca94a(0x237)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1ca94a(0x211)},'customers':{'$first':'$customer'},'date':{'$first':_0x1ca94a(0x27d)},'warehouse_name':{'$first':_0x1ca94a(0x233)},'sale_product':{'$push':_0x1ca94a(0x237)},'note':{'$first':'$note'},'return_data':{'$first':_0x1ca94a(0x2b0)},'customers_docs':{'$first':_0x1ca94a(0x29d)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x1ca94a(0x1cf)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x1ca94a(0x2a6)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x12c5f5[0x0][_0x1ca94a(0x1d8)]==_0x1ca94a(0x28d)){var _0x3632c6=users['English'];console[_0x1ca94a(0x228)](_0x3632c6);}else{if(_0x12c5f5[0x0]['language']=='Hindi')var _0x3632c6=users[_0x1ca94a(0x21b)];else{if(_0x12c5f5[0x0][_0x1ca94a(0x1d8)]==_0x1ca94a(0x256))var _0x3632c6=users['German'];else{if(_0x12c5f5[0x0]['language']==_0x1ca94a(0x1d6))var _0x3632c6=users[_0x1ca94a(0x1d6)];else{if(_0x12c5f5[0x0][_0x1ca94a(0x1d8)]==_0x1ca94a(0x1f6))var _0x3632c6=users[_0x1ca94a(0x1f6)];else{if(_0x12c5f5[0x0]['language']=='Portuguese\x20(BR)')var _0x3632c6=users[_0x1ca94a(0x20b)];else{if(_0x12c5f5[0x0][_0x1ca94a(0x1d8)]==_0x1ca94a(0x1d5))var _0x3632c6=users[_0x1ca94a(0x1d5)];else{if(_0x12c5f5[0x0][_0x1ca94a(0x1d8)]==_0x1ca94a(0x26a))var _0x3632c6=users['Arabic'];}}}}}}}_0x556d16[_0x1ca94a(0x208)](_0x1ca94a(0x206),{'success':_0x18b66e[_0x1ca94a(0x1fb)](_0x1ca94a(0x259)),'errors':_0x18b66e[_0x1ca94a(0x1fb)](_0x1ca94a(0x2d2)),'sales':_0x347019,'profile':_0x5bd311,'role':_0x11f789,'master_shop':_0x12c5f5,'language':_0x3632c6});}catch(_0x142340){console['log'](_0x142340);}}),router[a0_0x14b807(0x231)](a0_0x14b807(0x21d),auth,async(_0x393afd,_0x5bd8d0)=>{var _0x5628d7=a0_0x14b807;try{const {username:_0x9d7119,email:_0x33c4b5,role:_0x150fd8}=_0x393afd[_0x5628d7(0x20a)],_0xb71dbd=_0x393afd[_0x5628d7(0x20a)],_0x4eb29c=await profile[_0x5628d7(0x295)]({'email':_0xb71dbd[_0x5628d7(0x236)]}),_0x361647=await master_shop[_0x5628d7(0x24b)]();let _0x368240;if(_0xb71dbd[_0x5628d7(0x245)]==_0x5628d7(0x1c5)){const _0x414908=await staff[_0x5628d7(0x295)]({'email':_0xb71dbd[_0x5628d7(0x236)]});_0x368240=await sales_finished[_0x5628d7(0x213)]([{'$match':{'typeOfProducts':'logs'}},{'$unwind':_0x5628d7(0x237)},{'$group':{'_id':'$_id','invoice':{'$first':_0x5628d7(0x211)},'customers':{'$first':_0x5628d7(0x1c4)},'date':{'$first':_0x5628d7(0x27d)},'warehouse_name':{'$first':_0x5628d7(0x233)},'sale_product':{'$push':_0x5628d7(0x237)},'note':{'$first':_0x5628d7(0x2df)},'return_data':{'$first':_0x5628d7(0x2b0)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x5628d7(0x1cc)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x5628d7(0x29a)},'type':{'$addToSet':_0x5628d7(0x291)},'pallet':{'$addToSet':_0x5628d7(0x2a6)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x368240=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x5628d7(0x254)}},{'$unwind':_0x5628d7(0x237)},{'$group':{'_id':'$_id','invoice':{'$first':_0x5628d7(0x211)},'customers':{'$first':'$customer'},'date':{'$first':_0x5628d7(0x27d)},'warehouse_name':{'$first':_0x5628d7(0x233)},'sale_product':{'$push':_0x5628d7(0x237)},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x5628d7(0x29d)},'total_saleproduct_quantity':{'$sum':_0x5628d7(0x1cc)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x5628d7(0x29a)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x5628d7(0x2a6)},'finalize':{'$first':_0x5628d7(0x23e)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x361647[0x0]['language']==_0x5628d7(0x28d)){var _0xc56a1a=users[_0x5628d7(0x2e3)];console[_0x5628d7(0x228)](_0xc56a1a);}else{if(_0x361647[0x0]['language']==_0x5628d7(0x21b))var _0xc56a1a=users[_0x5628d7(0x21b)];else{if(_0x361647[0x0][_0x5628d7(0x1d8)]==_0x5628d7(0x256))var _0xc56a1a=users[_0x5628d7(0x256)];else{if(_0x361647[0x0][_0x5628d7(0x1d8)]=='Spanish')var _0xc56a1a=users[_0x5628d7(0x1d6)];else{if(_0x361647[0x0][_0x5628d7(0x1d8)]==_0x5628d7(0x1f6))var _0xc56a1a=users[_0x5628d7(0x1f6)];else{if(_0x361647[0x0][_0x5628d7(0x1d8)]==_0x5628d7(0x23f))var _0xc56a1a=users[_0x5628d7(0x20b)];else{if(_0x361647[0x0][_0x5628d7(0x1d8)]==_0x5628d7(0x1d5))var _0xc56a1a=users[_0x5628d7(0x1d5)];else{if(_0x361647[0x0][_0x5628d7(0x1d8)]=='Arabic\x20(ae)')var _0xc56a1a=users[_0x5628d7(0x207)];}}}}}}}_0x5bd8d0[_0x5628d7(0x208)](_0x5628d7(0x1db),{'success':_0x393afd[_0x5628d7(0x1fb)](_0x5628d7(0x259)),'errors':_0x393afd[_0x5628d7(0x1fb)](_0x5628d7(0x2d2)),'sales':_0x368240,'profile':_0x4eb29c,'role':_0xb71dbd,'master_shop':_0x361647,'language':_0xc56a1a});}catch(_0x2a71a4){console[_0x5628d7(0x228)](_0x2a71a4);}});async function getRandom8DigitNumber(){var _0x2bed96=a0_0x14b807;const _0x1cf2b0=0x989680,_0x5e352f=0x5f5e0ff,_0x2ce8fe=Math['floor'](Math[_0x2bed96(0x287)]()*(_0x5e352f-_0x1cf2b0+0x1))+_0x1cf2b0;var _0x553731;const _0xc04d5b=await sales_finished[_0x2bed96(0x295)]({'invoice':_0x2bed96(0x269)+_0x2ce8fe});return _0xc04d5b&&_0xc04d5b['length']>0x0?_0x553731=_0x2bed96(0x269)+_0x2ce8fe:_0x553731='OUTF-'+_0x2ce8fe,_0x553731;}function a0_0x10bc(_0x49dc82,_0x537950){var _0x21bc45=a0_0x21bc();return a0_0x10bc=function(_0x10bc64,_0x48de59){_0x10bc64=_0x10bc64-0x1c4;var _0x51c79d=_0x21bc45[_0x10bc64];return _0x51c79d;},a0_0x10bc(_0x49dc82,_0x537950);}router[a0_0x14b807(0x231)](a0_0x14b807(0x276),auth,async(_0x374d02,_0x50940c)=>{var _0x411426=a0_0x14b807;try{const {username:_0x5bf528,email:_0x27ca63,role:_0x3ce414}=_0x374d02[_0x411426(0x20a)],_0x3a95d6=_0x374d02[_0x411426(0x20a)],_0x928b70=await profile[_0x411426(0x295)]({'email':_0x3a95d6[_0x411426(0x236)]}),_0x24f199=await master_shop['find'](),_0x36d5be=await customer[_0x411426(0x24b)]({});let _0x2347d9;if(_0x3a95d6[_0x411426(0x245)]==_0x411426(0x1c5)){const _0x2551b8=await staff[_0x411426(0x295)]({'email':_0x3a95d6[_0x411426(0x236)]});_0x2347d9=await warehouse[_0x411426(0x213)]([{'$match':{'status':'Enabled','name':_0x2551b8[_0x411426(0x1d3)]}},{'$group':{'_id':_0x411426(0x25e),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x2347d9=await warehouse['aggregate']([{'$match':{'status':_0x411426(0x279)}},{'$group':{'_id':_0x411426(0x25e),'name':{'$first':_0x411426(0x25e)}}},{'$sort':{'name':0x1}}]);const _0x1d1884=await product[_0x411426(0x24b)]({});var _0x19a3f1=[_0x411426(0x2cf),_0x411426(0x218)];const _0x217db1=await sales_finished['find']({}),_0x462788=_0x217db1['length']+0x1,_0x3289b8=_0x411426(0x269)+_0x462788[_0x411426(0x286)]()[_0x411426(0x268)](0x5,'0');if(_0x24f199[0x0]['language']==_0x411426(0x28d)){var _0x6e3363=users[_0x411426(0x2e3)];console[_0x411426(0x228)](_0x6e3363);}else{if(_0x24f199[0x0][_0x411426(0x1d8)]=='Hindi')var _0x6e3363=users[_0x411426(0x21b)];else{if(_0x24f199[0x0][_0x411426(0x1d8)]=='German')var _0x6e3363=users[_0x411426(0x256)];else{if(_0x24f199[0x0]['language']=='Spanish')var _0x6e3363=users[_0x411426(0x1d6)];else{if(_0x24f199[0x0]['language']=='French')var _0x6e3363=users[_0x411426(0x1f6)];else{if(_0x24f199[0x0][_0x411426(0x1d8)]==_0x411426(0x23f))var _0x6e3363=users[_0x411426(0x20b)];else{if(_0x24f199[0x0][_0x411426(0x1d8)]==_0x411426(0x1d5))var _0x6e3363=users[_0x411426(0x1d5)];else{if(_0x24f199[0x0][_0x411426(0x1d8)]==_0x411426(0x26a))var _0x6e3363=users[_0x411426(0x207)];}}}}}}}const _0x459703=getRandom8DigitNumber();_0x459703['then'](_0x2f629b=>{var _0x1ecad2=_0x411426;_0x50940c[_0x1ecad2(0x208)](_0x1ecad2(0x27a),{'success':_0x374d02[_0x1ecad2(0x1fb)](_0x1ecad2(0x259)),'errors':_0x374d02['flash'](_0x1ecad2(0x2d2)),'role':_0x3a95d6,'profile':_0x928b70,'customer':_0x36d5be,'warehouse':_0x2347d9,'product':_0x1d1884,'invoice':_0x2f629b,'master_shop':_0x24f199,'language':_0x6e3363,'rooms_data':_0x19a3f1});})[_0x411426(0x2ce)](_0x1dbe97=>{var _0x247b42=_0x411426;_0x374d02[_0x247b42(0x1fb)](_0x247b42(0x2d2),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x50940c[_0x247b42(0x1cd)](_0x247b42(0x29c));});}catch(_0x5a04bb){console[_0x411426(0x228)](_0x5a04bb);}}),router[a0_0x14b807(0x231)](a0_0x14b807(0x2cc),auth,async(_0x545c3d,_0x4cd47b)=>{var _0x55c1d3=a0_0x14b807;try{const {username:_0x2ba471,email:_0xba9c8c,role:_0x2a1829}=_0x545c3d[_0x55c1d3(0x20a)],_0x51d998=_0x545c3d['user'],_0x3950e1=await profile[_0x55c1d3(0x295)]({'email':_0x51d998['email']}),_0x5a6731=await master_shop[_0x55c1d3(0x24b)](),_0x451c12=await customer[_0x55c1d3(0x24b)]({});let _0x5d5547;if(_0x51d998[_0x55c1d3(0x245)]==_0x55c1d3(0x1c5)){const _0x320432=await staff[_0x55c1d3(0x295)]({'email':_0x51d998[_0x55c1d3(0x236)]});_0x5d5547=await warehouse[_0x55c1d3(0x213)]([{'$match':{'status':_0x55c1d3(0x279),'name':_0x320432[_0x55c1d3(0x1d3)]}},{'$group':{'_id':_0x55c1d3(0x25e),'name':{'$first':_0x55c1d3(0x25e)}}},{'$sort':{'name':0x1}}]);}else _0x5d5547=await warehouse[_0x55c1d3(0x213)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x55c1d3(0x25e)}}},{'$sort':{'name':0x1}}]);const _0x366980=await product[_0x55c1d3(0x24b)]({});var _0x54d5e9=['Ambient',_0x55c1d3(0x218)];const _0x4023cb=await sales_finished[_0x55c1d3(0x24b)]({}),_0xcb1ce3=_0x4023cb['length']+0x1,_0x13494a=_0x55c1d3(0x269)+_0xcb1ce3[_0x55c1d3(0x286)]()[_0x55c1d3(0x268)](0x5,'0');if(_0x5a6731[0x0]['language']==_0x55c1d3(0x28d)){var _0x36f407=users['English'];console['log'](_0x36f407);}else{if(_0x5a6731[0x0][_0x55c1d3(0x1d8)]=='Hindi')var _0x36f407=users[_0x55c1d3(0x21b)];else{if(_0x5a6731[0x0][_0x55c1d3(0x1d8)]==_0x55c1d3(0x256))var _0x36f407=users[_0x55c1d3(0x256)];else{if(_0x5a6731[0x0][_0x55c1d3(0x1d8)]==_0x55c1d3(0x1d6))var _0x36f407=users[_0x55c1d3(0x1d6)];else{if(_0x5a6731[0x0][_0x55c1d3(0x1d8)]=='French')var _0x36f407=users[_0x55c1d3(0x1f6)];else{if(_0x5a6731[0x0][_0x55c1d3(0x1d8)]==_0x55c1d3(0x23f))var _0x36f407=users[_0x55c1d3(0x20b)];else{if(_0x5a6731[0x0][_0x55c1d3(0x1d8)]==_0x55c1d3(0x1d5))var _0x36f407=users[_0x55c1d3(0x1d5)];else{if(_0x5a6731[0x0][_0x55c1d3(0x1d8)]==_0x55c1d3(0x26a))var _0x36f407=users[_0x55c1d3(0x207)];}}}}}}}const _0x8e859=getRandom8DigitNumber();_0x8e859['then'](_0x5cbd7b=>{var _0x17327f=_0x55c1d3;_0x4cd47b[_0x17327f(0x208)](_0x17327f(0x243),{'success':_0x545c3d[_0x17327f(0x1fb)](_0x17327f(0x259)),'errors':_0x545c3d['flash'](_0x17327f(0x2d2)),'role':_0x51d998,'profile':_0x3950e1,'customer':_0x451c12,'warehouse':_0x5d5547,'product':_0x366980,'invoice':_0x5cbd7b,'master_shop':_0x5a6731,'language':_0x36f407,'rooms_data':_0x54d5e9});})[_0x55c1d3(0x2ce)](_0x2efc04=>{var _0x286b95=_0x55c1d3;_0x545c3d[_0x286b95(0x1fb)](_0x286b95(0x2d2),_0x286b95(0x1d9)),_0x4cd47b['redirect']('/all_sales_finished/view');});}catch(_0x11cb3e){console[_0x55c1d3(0x228)](_0x11cb3e);}}),router[a0_0x14b807(0x24c)](a0_0x14b807(0x2cc),auth,async(_0x2c0282,_0x297f61)=>{var _0x434a15=a0_0x14b807;try{const {invoice:_0x12a502,date:_0x59c8f3,warehouse_name:_0x446ace,product_name:_0x422055,note:_0xd27eb5,room:_0x415976,primary_code:_0x2b0109,secondary_code:_0x21e247,prod_code:_0x575b89,SCRN:_0x38989d,ReqBy:_0x4f7523,dateofreq:_0xb7676b,PO_number:_0x10720e,typeservicesData:_0x3baf03,typevehicle:_0x38cf83,destination:_0x16ac9d,deliverydate:_0x450118,driver:_0x15a014,plate:_0x561cc6,van:_0x1a265e,DRSI:_0x164ff4,TSU:_0x90bb1e,TFU:_0x14462e,mode_transpo:_0x493217,name_driver:_0x350128,type_of_products:_0x4c3a61}=_0x2c0282[_0x434a15(0x246)];if(typeof _0x422055==_0x434a15(0x2bc))var _0x2c1f7a=[_0x2c0282[_0x434a15(0x246)]['product_name']],_0x587158=[_0x2c0282['body']['stock']],_0x178342=[_0x2c0282[_0x434a15(0x246)]['carton']],_0xa69b32=[_0x2c0282[_0x434a15(0x246)]['primary_code']],_0xbe76c=[_0x2c0282[_0x434a15(0x246)][_0x434a15(0x278)]],_0x47dd0f=[_0x2c0282['body'][_0x434a15(0x1e2)]],_0x1b3b75=[_0x2c0282['body'][_0x434a15(0x2dd)]],_0x361997=[_0x2c0282[_0x434a15(0x246)]['primary_unit']],_0x455002=[_0x2c0282[_0x434a15(0x246)][_0x434a15(0x1e9)]],_0x3027db=[_0x2c0282[_0x434a15(0x246)][_0x434a15(0x262)]],_0x1963e8=[_0x2c0282[_0x434a15(0x246)][_0x434a15(0x272)]],_0x25cd98=[_0x2c0282[_0x434a15(0x246)][_0x434a15(0x225)]],_0x34bc35=[_0x2c0282[_0x434a15(0x246)]['max_per_unit']],_0x190cf5=[_0x2c0282[_0x434a15(0x246)]['prod_cat']],_0x8d9e2e=[_0x2c0282[_0x434a15(0x246)]['RoomAssigned']],_0x5b2e5e=[_0x2c0282['body'][_0x434a15(0x280)]],_0x461f44=[_0x2c0282[_0x434a15(0x246)][_0x434a15(0x1e4)]],_0x108a0f=[_0x2c0282[_0x434a15(0x246)][_0x434a15(0x285)]],_0x3f0df0=[_0x2c0282['body']['gross_price']];else var _0x2c1f7a=[..._0x2c0282[_0x434a15(0x246)]['product_name']],_0x587158=[..._0x2c0282['body'][_0x434a15(0x1e3)]],_0x178342=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x2b5)]],_0xa69b32=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x2b8)]],_0xbe76c=[..._0x2c0282['body'][_0x434a15(0x278)]],_0x47dd0f=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x1e2)]],_0x1b3b75=[..._0x2c0282['body'][_0x434a15(0x2dd)]],_0x361997=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x240)]],_0x455002=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x1e9)]],_0x3027db=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x262)]],_0x1963e8=[..._0x2c0282['body'][_0x434a15(0x272)]],_0x25cd98=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x225)]],_0x34bc35=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x1d7)]],_0x190cf5=[..._0x2c0282['body']['prod_cat']],_0x8d9e2e=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x273)]],_0x5b2e5e=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x280)]],_0x461f44=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x1e4)]],_0x108a0f=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x285)]],_0x3f0df0=[..._0x2c0282[_0x434a15(0x246)][_0x434a15(0x205)]];const _0x34d9af=_0x2c1f7a[_0x434a15(0x2bf)](_0xd7dc95=>{return _0xd7dc95={'product_name':_0xd7dc95};});_0x587158[_0x434a15(0x2be)]((_0x5dce11,_0x256c67)=>{var _0x5121c0=_0x434a15;_0x34d9af[_0x256c67][_0x5121c0(0x1e3)]=_0x5dce11;}),_0x178342[_0x434a15(0x2be)]((_0x27d815,_0x34a816)=>{var _0x5aab61=_0x434a15;_0x34d9af[_0x34a816][_0x5aab61(0x26c)]=Math[_0x5aab61(0x1e5)](_0x27d815);}),_0x2c1f7a[_0x434a15(0x2be)]((_0x2d2095,_0x17e065)=>{var _0xe2f4a9=_0x434a15;_0x34d9af[_0x17e065][_0xe2f4a9(0x1e1)]=_0x2c0282[_0xe2f4a9(0x246)][_0xe2f4a9(0x2db)];}),_0x3f0df0[_0x434a15(0x2be)]((_0x472ca4,_0x37ac61)=>{_0x34d9af[_0x37ac61]['gross_price']=_0x472ca4;}),_0x108a0f[_0x434a15(0x2be)]((_0x40e1c5,_0x1860a7)=>{_0x34d9af[_0x1860a7]['uuid']=_0x40e1c5;}),_0x461f44[_0x434a15(0x2be)]((_0x52ac43,_0x24a476)=>{var _0x24d4f3=_0x434a15;_0x34d9af[_0x24a476][_0x24d4f3(0x1e4)]=_0x52ac43;}),_0xa69b32['forEach']((_0x4aaf2c,_0x42d4fc)=>{var _0x3e2840=_0x434a15;_0x34d9af[_0x42d4fc][_0x3e2840(0x2b8)]=_0x4aaf2c;}),_0xbe76c['forEach']((_0x5434ff,_0x3f2a9a)=>{var _0x3c4df9=_0x434a15;_0x34d9af[_0x3f2a9a][_0x3c4df9(0x278)]=_0x5434ff;}),_0x47dd0f[_0x434a15(0x2be)]((_0x5c3e2b,_0x1d861a)=>{var _0x22850d=_0x434a15;_0x34d9af[_0x1d861a][_0x22850d(0x2ac)]=_0x5c3e2b;}),_0x1b3b75[_0x434a15(0x2be)]((_0x3fce4e,_0x35bf2f)=>{var _0x3876dc=_0x434a15,_0x514465=_0x3fce4e['match'](/[A-Za-z]+/)[0x0],_0x2ded6b=parseInt(_0x3fce4e[_0x3876dc(0x2b9)](/\d+/)[0x0]);_0x34d9af[_0x35bf2f][_0x3876dc(0x2c6)]=_0x2ded6b,_0x34d9af[_0x35bf2f]['level']=_0x514465;}),_0x361997[_0x434a15(0x2be)]((_0x572653,_0x144585)=>{_0x34d9af[_0x144585]['unit']=_0x572653;}),_0x455002[_0x434a15(0x2be)]((_0x5a8132,_0xd58eff)=>{var _0x1e6119=_0x434a15;_0x34d9af[_0xd58eff][_0x1e6119(0x1e9)]=_0x5a8132;}),_0x3027db[_0x434a15(0x2be)]((_0x13cbfc,_0x31839b)=>{_0x34d9af[_0x31839b]['batch_code']=_0x13cbfc;}),_0x1963e8[_0x434a15(0x2be)]((_0x3efbb8,_0x4d1d1f)=>{_0x34d9af[_0x4d1d1f]['expiry_date']=_0x3efbb8;}),_0x25cd98[_0x434a15(0x2be)]((_0x2166c7,_0x1d692f)=>{var _0x5adeb0=_0x434a15;_0x34d9af[_0x1d692f][_0x5adeb0(0x2d7)]=_0x2166c7;}),_0x34bc35[_0x434a15(0x2be)]((_0x1a5f39,_0x2769d8)=>{var _0x98ec31=_0x434a15;_0x34d9af[_0x2769d8][_0x98ec31(0x230)]=_0x1a5f39;}),_0x190cf5[_0x434a15(0x2be)]((_0x10b078,_0x49f61a)=>{var _0x2907f5=_0x434a15;_0x34d9af[_0x49f61a][_0x2907f5(0x214)]=_0x10b078;}),_0x8d9e2e[_0x434a15(0x2be)]((_0x4ccfbe,_0x2631a2)=>{_0x34d9af[_0x2631a2]['room_name']=_0x4ccfbe;}),_0x5b2e5e[_0x434a15(0x2be)]((_0x61463b,_0x5e83aa)=>{var _0x8e844e=_0x434a15;_0x34d9af[_0x5e83aa][_0x8e844e(0x2a2)]=_0x61463b,_0x34d9af[_0x5e83aa][_0x8e844e(0x258)]=_0x59c8f3;});const _0x587e9b=new sales_logs();await _0x587e9b[_0x434a15(0x2b7)](),_0x5b2e5e[_0x434a15(0x2be)]((_0x234cf3,_0x2e98b2)=>{var _0x1360f3=_0x434a15;_0x34d9af[_0x2e98b2][_0x1360f3(0x234)]=_0x1360f3(0x249)+_0x587e9b[_0x1360f3(0x215)]['toString']()[_0x1360f3(0x268)](0x8,'0');});var _0x42a7d3=0x0;_0x34d9af[_0x434a15(0x2be)](_0x50ed8e=>{var _0x408330=_0x434a15;parseFloat(_0x50ed8e[_0x408330(0x1e3)])<parseFloat(_0x50ed8e[_0x408330(0x26c)])&&parseFloat(_0x50ed8e[_0x408330(0x26c)])>parseFloat(_0x50ed8e[_0x408330(0x1e3)])&&(console['log'](_0x50ed8e[_0x408330(0x1e3)]+_0x408330(0x2a8)+_0x50ed8e[_0x408330(0x26c)]),_0x42a7d3++);});if(_0x42a7d3!=0x0)return _0x2c0282[_0x434a15(0x1fb)]('errors','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x297f61['redirect'](_0x434a15(0x238));const _0x4d6e9c=_0x34d9af['filter'](_0x4ed6cd=>_0x4ed6cd[_0x434a15(0x26c)]!=='0'&&_0x4ed6cd[_0x434a15(0x26c)]!==''),_0x3912fd=new sales_finished({'invoice':_0x434a15(0x249)+_0x587e9b[_0x434a15(0x215)][_0x434a15(0x286)]()[_0x434a15(0x268)](0x8,'0'),'sales_data':_0x2c0282[_0x434a15(0x246)][_0x434a15(0x2db)],'customer':_0x2c0282['body'][_0x434a15(0x2d0)],'date':_0x59c8f3,'warehouse_name':_0x446ace,'sale_product':_0x4d6e9c,'note':_0xd27eb5,'room':_0x415976,'primary_code':_0x2b0109,'secondary_code':_0x21e247,'prod_code':_0x575b89,'SCRN':_0x38989d,'finalize':_0x434a15(0x2d1),'mode_transpo':_0x493217,'name_driver':_0x350128,'ReqBy':_0x4f7523,'dateofreq':_0xb7676b,'PO_number':_0x10720e,'typeservicesData':_0x3baf03,'typevehicle':_0x38cf83,'destination':_0x16ac9d,'deliverydate':_0x450118,'driver':_0x15a014,'plate':_0x561cc6,'van':_0x1a265e,'DRSI':_0x164ff4,'TSU':_0x90bb1e,'TFU':_0x14462e,'typeOfProducts':_0x4c3a61}),_0x266879=await _0x3912fd[_0x434a15(0x2b7)](),_0x204331=await sales_finished['findOne']({'invoice':_0x12a502});_0x2c0282['flash'](_0x434a15(0x259),_0x434a15(0x1dc)),_0x297f61['redirect'](_0x434a15(0x27e)+_0x266879['_id']);}catch(_0x53dd6e){console[_0x434a15(0x228)](_0x53dd6e);}}),router['get']('/view/add_sales/:id',auth,async(_0x418a38,_0x3e5597)=>{var _0x503b0d=a0_0x14b807;try{const _0x15bff0=_0x418a38[_0x503b0d(0x255)]['id'];console['log'](_0x15bff0);const _0x284936=await product[_0x503b0d(0x24b)](),_0x23808a=await purchases['aggregate']([{'$match':{'warehouse_name':_0x15bff0}},{'$unwind':'$product'},{'$group':{'_id':_0x503b0d(0x23b)}}]);console['log'](_0x503b0d(0x28b),_0x23808a),_0x3e5597[_0x503b0d(0x2af)](0xc8)[_0x503b0d(0x1ea)]({'purchases_data':_0x23808a,'product_data':_0x284936});}catch(_0x1ec8e3){console[_0x503b0d(0x228)](_0x1ec8e3);}}),router[a0_0x14b807(0x24c)](a0_0x14b807(0x2b4),auth,async(_0x3e85fe,_0x2ac051)=>{var _0x52d776=a0_0x14b807;try{const {warehouse_data:_0x1ac92a,product_data:_0x58afd9}=_0x3e85fe['body'];console[_0x52d776(0x228)](_0x3e85fe[_0x52d776(0x246)][_0x52d776(0x2ba)]);;const _0x3a9194=await master_shop[_0x52d776(0x24b)]();console[_0x52d776(0x228)](_0x52d776(0x1f5),_0x3a9194);const _0x46bd6e=await product[_0x52d776(0x295)]({'name':_0x58afd9});console[_0x52d776(0x228)](_0x52d776(0x22c),_0x46bd6e);const _0x5012a3=await warehouse[_0x52d776(0x213)]([{'$match':{'name':_0x1ac92a}},{'$unwind':_0x52d776(0x2e1)},{'$match':{'product_details.product_name':_0x58afd9}},{'$group':{'_id':_0x52d776(0x28e),'product_stock':{'$first':_0x52d776(0x277)}}}]);console[_0x52d776(0x228)](_0x52d776(0x2bb),_0x5012a3),_0x2ac051[_0x52d776(0x2af)](0xc8)[_0x52d776(0x1ea)]({'master':_0x3a9194,'new_product':_0x46bd6e,'stock_data':_0x5012a3});}catch(_0x42eff7){console[_0x52d776(0x228)](_0x42eff7);}}),router[a0_0x14b807(0x24c)](a0_0x14b807(0x276),auth,async(_0x13cd28,_0xd47992)=>{var _0x536096=a0_0x14b807;try{const {invoice:_0x2f6303,date:_0x46d898,warehouse_name:_0x51aba7,product_name:_0x1a70c4,note:_0x3910fc,room:_0x214400,primary_code:_0x2bdbbb,secondary_code:_0x19b137,prod_code:_0x18b77d,SCRN:_0x3f2356,ReqBy:_0x3276c1,dateofreq:_0x2c8d84,PO_number:_0xc5895,typeservicesData:_0x3e2c72,typevehicle:_0x325baa,destination:_0x4ff9c9,deliverydate:_0x3eb170,driver:_0x3aa378,plate:_0x50ea22,van:_0x2dd273,DRSI:_0x22d58d,TSU:_0x32ad17,TFU:_0x31d398,mode_transpo:_0xb66170,name_driver:_0x2d9e7d,pull_out_date:_0x465730,actual_delivery_date:_0x5014d6}=_0x13cd28[_0x536096(0x246)];if(typeof _0x1a70c4==_0x536096(0x2bc))var _0x504d86=[_0x13cd28[_0x536096(0x246)][_0x536096(0x24f)]],_0x1590b4=[_0x13cd28[_0x536096(0x246)][_0x536096(0x1e3)]],_0x1787f7=[_0x13cd28[_0x536096(0x246)][_0x536096(0x2b5)]],_0x28b51c=[_0x13cd28[_0x536096(0x246)][_0x536096(0x2b8)]],_0x1fa108=[_0x13cd28[_0x536096(0x246)][_0x536096(0x278)]],_0xe6e26e=[_0x13cd28[_0x536096(0x246)][_0x536096(0x1e2)]],_0x4221fd=[_0x13cd28[_0x536096(0x246)][_0x536096(0x2dd)]],_0x5b8a9c=[_0x13cd28[_0x536096(0x246)][_0x536096(0x240)]],_0x46fe0f=[_0x13cd28[_0x536096(0x246)][_0x536096(0x1e9)]],_0x66aea0=[_0x13cd28[_0x536096(0x246)]['batch_code']],_0x39477c=[_0x13cd28['body'][_0x536096(0x272)]],_0x977317=[_0x13cd28[_0x536096(0x246)][_0x536096(0x225)]],_0x599af3=[_0x13cd28[_0x536096(0x246)][_0x536096(0x1d7)]],_0x2b2224=[_0x13cd28['body'][_0x536096(0x214)]],_0x1e3783=[_0x13cd28[_0x536096(0x246)]['RoomAssigned']],_0x587b8e=[_0x13cd28[_0x536096(0x246)]['prod_invoice']],_0x1be8a6=[_0x13cd28[_0x536096(0x246)][_0x536096(0x1e4)]],_0x44e213=[_0x13cd28[_0x536096(0x246)][_0x536096(0x285)]],_0x57f070=[_0x13cd28[_0x536096(0x246)][_0x536096(0x205)]];else var _0x504d86=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x24f)]],_0x1590b4=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x1e3)]],_0x1787f7=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x2b5)]],_0x28b51c=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x2b8)]],_0x1fa108=[..._0x13cd28[_0x536096(0x246)]['secondary_code']],_0xe6e26e=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x1e2)]],_0x4221fd=[..._0x13cd28['body'][_0x536096(0x2dd)]],_0x5b8a9c=[..._0x13cd28['body'][_0x536096(0x240)]],_0x46fe0f=[..._0x13cd28[_0x536096(0x246)]['secondary_unit']],_0x66aea0=[..._0x13cd28[_0x536096(0x246)]['batch_code']],_0x39477c=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x272)]],_0x977317=[..._0x13cd28['body']['product_date']],_0x599af3=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x1d7)]],_0x2b2224=[..._0x13cd28['body'][_0x536096(0x214)]],_0x1e3783=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x273)]],_0x587b8e=[..._0x13cd28[_0x536096(0x246)][_0x536096(0x280)]],_0x1be8a6=[..._0x13cd28['body']['id_transaction_from']],_0x44e213=[..._0x13cd28['body'][_0x536096(0x285)]],_0x57f070=[..._0x13cd28[_0x536096(0x246)]['gross_price']];const _0x3fa174=_0x504d86[_0x536096(0x2bf)](_0x40218c=>{return _0x40218c={'product_name':_0x40218c};});_0x1590b4[_0x536096(0x2be)]((_0x5393ef,_0x955d04)=>{var _0x4b69c9=_0x536096;_0x3fa174[_0x955d04][_0x4b69c9(0x1e3)]=_0x5393ef;}),_0x1787f7[_0x536096(0x2be)]((_0x102d34,_0x113f42)=>{var _0x572326=_0x536096;_0x3fa174[_0x113f42][_0x572326(0x26c)]=Math['abs'](_0x102d34);}),_0x504d86[_0x536096(0x2be)]((_0x460042,_0x3c0278)=>{var _0x5b4ef4=_0x536096;_0x3fa174[_0x3c0278]['agent_id']=_0x13cd28[_0x5b4ef4(0x246)]['sales'];}),_0x57f070[_0x536096(0x2be)]((_0xcff9fd,_0x146298)=>{var _0x29816b=_0x536096;_0x3fa174[_0x146298][_0x29816b(0x205)]=_0xcff9fd;}),_0x44e213[_0x536096(0x2be)]((_0x528198,_0x2c002e)=>{var _0x49afdb=_0x536096;_0x3fa174[_0x2c002e][_0x49afdb(0x285)]=_0x528198;}),_0x1be8a6[_0x536096(0x2be)]((_0x8a0d4a,_0x309bf1)=>{var _0x6f8119=_0x536096;_0x3fa174[_0x309bf1][_0x6f8119(0x1e4)]=_0x8a0d4a;}),_0x28b51c[_0x536096(0x2be)]((_0x1eac9,_0x3afcef)=>{var _0x13f338=_0x536096;_0x3fa174[_0x3afcef][_0x13f338(0x2b8)]=_0x1eac9;}),_0x1fa108[_0x536096(0x2be)]((_0x2051bc,_0x4646b2)=>{var _0x400b20=_0x536096;_0x3fa174[_0x4646b2][_0x400b20(0x278)]=_0x2051bc;}),_0xe6e26e[_0x536096(0x2be)]((_0x4438b2,_0x52f434)=>{_0x3fa174[_0x52f434]['product_code']=_0x4438b2;}),_0x4221fd['forEach']((_0x66def8,_0x53e581)=>{var _0x2b2650=_0x536096,_0x442452=_0x66def8[_0x2b2650(0x2b9)](/[A-Za-z]+/)[0x0],_0x2ff200=parseInt(_0x66def8['match'](/\d+/)[0x0]);_0x3fa174[_0x53e581][_0x2b2650(0x2c6)]=_0x2ff200,_0x3fa174[_0x53e581][_0x2b2650(0x1fa)]=_0x442452;}),_0x5b8a9c['forEach']((_0x5c6ef2,_0x4d421c)=>{_0x3fa174[_0x4d421c]['unit']=_0x5c6ef2;}),_0x46fe0f[_0x536096(0x2be)]((_0x5c632e,_0x25c735)=>{_0x3fa174[_0x25c735]['secondary_unit']=_0x5c632e;}),_0x66aea0['forEach']((_0x588d7e,_0x357eaf)=>{var _0x474c1c=_0x536096;_0x3fa174[_0x357eaf][_0x474c1c(0x262)]=_0x588d7e;}),_0x39477c[_0x536096(0x2be)]((_0x8443b7,_0x2bdbaf)=>{_0x3fa174[_0x2bdbaf]['expiry_date']=_0x8443b7;}),_0x977317[_0x536096(0x2be)]((_0x4b48b5,_0x483bcb)=>{var _0x4ba99c=_0x536096;_0x3fa174[_0x483bcb][_0x4ba99c(0x2d7)]=_0x4b48b5;}),_0x599af3[_0x536096(0x2be)]((_0x41c7d5,_0x59d914)=>{var _0xa09dd2=_0x536096;_0x3fa174[_0x59d914][_0xa09dd2(0x230)]=_0x41c7d5;}),_0x2b2224[_0x536096(0x2be)]((_0x20c48d,_0x5e350a)=>{var _0x21d102=_0x536096;_0x3fa174[_0x5e350a][_0x21d102(0x214)]=_0x20c48d;}),_0x1e3783[_0x536096(0x2be)]((_0x280c51,_0x5d94ef)=>{_0x3fa174[_0x5d94ef]['room_name']=_0x280c51;}),_0x587b8e[_0x536096(0x2be)]((_0x4605f8,_0x23364c)=>{var _0x31bb44=_0x536096;_0x3fa174[_0x23364c][_0x31bb44(0x2a2)]=_0x4605f8,_0x3fa174[_0x23364c][_0x31bb44(0x258)]=_0x46d898;});const _0x2718e3=new invoice_for_outgoing();await _0x2718e3[_0x536096(0x2b7)](),_0x587b8e[_0x536096(0x2be)]((_0x2a2c82,_0x753e9d)=>{var _0x57fa56=_0x536096;_0x3fa174[_0x753e9d][_0x57fa56(0x234)]='OUT-'+_0x2718e3[_0x57fa56(0x215)][_0x57fa56(0x286)]()[_0x57fa56(0x268)](0x8,'0');});var _0x555f0b=0x0;_0x3fa174[_0x536096(0x2be)](_0x49bfb3=>{var _0x2e4b42=_0x536096;parseFloat(_0x49bfb3[_0x2e4b42(0x1e3)])<parseFloat(_0x49bfb3[_0x2e4b42(0x26c)])&&parseFloat(_0x49bfb3[_0x2e4b42(0x26c)])>parseFloat(_0x49bfb3[_0x2e4b42(0x1e3)])&&(console['log'](_0x49bfb3[_0x2e4b42(0x1e3)]+_0x2e4b42(0x2a8)+_0x49bfb3[_0x2e4b42(0x26c)]),_0x555f0b++);});if(_0x555f0b!=0x0)return _0x13cd28[_0x536096(0x1fb)]('errors',_0x536096(0x1f2)),_0xd47992[_0x536096(0x1cd)](_0x536096(0x238));const _0x186fdc=_0x3fa174[_0x536096(0x202)](_0x2d5a77=>_0x2d5a77['quantity']!=='0'&&_0x2d5a77['quantity']!==''),_0x408c0a=new sales_finished({'invoice':'OUT-'+_0x2718e3[_0x536096(0x215)][_0x536096(0x286)]()[_0x536096(0x268)](0x8,'0'),'sales_data':_0x13cd28[_0x536096(0x246)]['sales'],'customer':_0x13cd28['body']['customer'],'date':_0x46d898,'warehouse_name':_0x51aba7,'sale_product':_0x186fdc,'note':_0x3910fc,'room':_0x214400,'primary_code':_0x2bdbbb,'secondary_code':_0x19b137,'prod_code':_0x18b77d,'SCRN':_0x3f2356,'finalize':'False','mode_transpo':_0xb66170,'name_driver':_0x2d9e7d,'ReqBy':_0x3276c1,'dateofreq':_0x2c8d84,'PO_number':_0xc5895,'typeservicesData':_0x3e2c72,'typevehicle':_0x325baa,'destination':_0x4ff9c9,'deliverydate':_0x3eb170,'driver':_0x3aa378,'plate':_0x50ea22,'van':_0x2dd273,'DRSI':_0x22d58d,'TSU':_0x32ad17,'TFU':_0x31d398,'pullout_date':_0x465730,'actualdelivery_date':_0x5014d6,'typeOfProducts':_0x536096(0x22b)}),_0xeb4af2=await _0x408c0a['save'](),_0x2f9f56=await sales_finished[_0x536096(0x295)]({'invoice':_0x2f6303});_0x13cd28['flash'](_0x536096(0x259),_0x536096(0x1dc)),_0xd47992[_0x536096(0x1cd)](_0x536096(0x27e)+_0xeb4af2[_0x536096(0x25a)]);}catch(_0x2a79ed){console[_0x536096(0x228)](_0x2a79ed);}}),router[a0_0x14b807(0x231)](a0_0x14b807(0x2d6),auth,async(_0x9f3d8d,_0x33a525)=>{var _0x3ef728=a0_0x14b807;try{const {username:_0x4f17dc,email:_0x10db25,role:_0x371546}=_0x9f3d8d[_0x3ef728(0x20a)],_0xafc22c=_0x9f3d8d[_0x3ef728(0x20a)],_0x1fcc55=await profile[_0x3ef728(0x295)]({'email':_0xafc22c[_0x3ef728(0x236)]}),_0xc111b7=await master_shop[_0x3ef728(0x24b)](),_0x4ce0d5=_0x9f3d8d['params']['id'],_0x27b5cd=await sales_finished[_0x3ef728(0x290)](_0x4ce0d5),_0x26e90b=await warehouse[_0x3ef728(0x213)]([{'$match':{'name':_0x27b5cd[_0x3ef728(0x212)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3ef728(0x2b2),'name':{'$first':_0x3ef728(0x28e)},'product_stock':{'$first':_0x3ef728(0x277)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3ef728(0x219)},'floorlevel':{'$first':_0x3ef728(0x2c5)},'primary_code':{'$first':_0x3ef728(0x2c1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3ef728(0x1ce)},'storage':{'$first':_0x3ef728(0x244)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3ef728(0x2d5)},'production_date':{'$first':_0x3ef728(0x2b3)},'batch_code':{'$first':_0x3ef728(0x260)},'room':{'$first':_0x3ef728(0x1ee)},'room_data':{'$first':_0x3ef728(0x1fd)}}}]),_0x3f4f6c=await customer[_0x3ef728(0x24b)]({});let _0x29a161;if(_0xafc22c[_0x3ef728(0x245)]=='staff'){const _0x312e33=await staff['findOne']({'email':_0xafc22c['email']});_0x29a161=await warehouse['aggregate']([{'$match':{'status':_0x3ef728(0x279),'name':_0x312e33['warehouse']}},{'$group':{'_id':_0x3ef728(0x25e),'name':{'$first':_0x3ef728(0x25e)}}}]);}else _0x29a161=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x3ef728(0x25e),'name':{'$first':_0x3ef728(0x25e)}}}]);const _0x252978=await product[_0x3ef728(0x24b)]({});if(_0xc111b7[0x0][_0x3ef728(0x1d8)]==_0x3ef728(0x28d)){var _0x54f258=users['English'];console[_0x3ef728(0x228)](_0x54f258);}else{if(_0xc111b7[0x0][_0x3ef728(0x1d8)]==_0x3ef728(0x21b))var _0x54f258=users['Hindi'];else{if(_0xc111b7[0x0][_0x3ef728(0x1d8)]==_0x3ef728(0x256))var _0x54f258=users[_0x3ef728(0x256)];else{if(_0xc111b7[0x0]['language']==_0x3ef728(0x1d6))var _0x54f258=users[_0x3ef728(0x1d6)];else{if(_0xc111b7[0x0][_0x3ef728(0x1d8)]==_0x3ef728(0x1f6))var _0x54f258=users['French'];else{if(_0xc111b7[0x0][_0x3ef728(0x1d8)]==_0x3ef728(0x23f))var _0x54f258=users[_0x3ef728(0x20b)];else{if(_0xc111b7[0x0][_0x3ef728(0x1d8)]==_0x3ef728(0x1d5))var _0x54f258=users[_0x3ef728(0x1d5)];else{if(_0xc111b7[0x0][_0x3ef728(0x1d8)]==_0x3ef728(0x26a))var _0x54f258=users[_0x3ef728(0x207)];}}}}}}}_0x33a525[_0x3ef728(0x208)]('edit_sales_finished_view',{'success':_0x9f3d8d['flash'](_0x3ef728(0x259)),'errors':_0x9f3d8d[_0x3ef728(0x1fb)](_0x3ef728(0x2d2)),'role':_0xafc22c,'profile':_0x1fcc55,'customer':_0x3f4f6c,'warehouse':_0x29a161,'product':_0x26e90b,'user':_0x27b5cd,'master_shop':_0xc111b7,'unit':_0x252978,'language':_0x54f258});}catch(_0x25b1e5){console[_0x3ef728(0x228)](_0x25b1e5);}});async function dataUpdate(_0x8e1095,_0x2c21af,_0x1647bf){var _0x2fd161=a0_0x14b807;return await warehouse[_0x2fd161(0x1c9)]({'_id':_0x8e1095,'product_details._id':_0x2c21af},{'$set':{'product_details.$.product_stock':_0x1647bf}}),await warehouse[_0x2fd161(0x290)](_0x8e1095);}router[a0_0x14b807(0x24c)](a0_0x14b807(0x2d6),auth,async(_0x46bb3d,_0x10779e)=>{var _0x3a7aa4=a0_0x14b807;try{const _0x3d8832=_0x46bb3d['params']['id'],{invoice:_0x166453,warehouse_name:_0x5b5fc2,room:_0x3ad044}=_0x46bb3d[_0x3a7aa4(0x246)],_0xdaa1f7=await sales_finished['findOne']({'invoice':_0x166453});for(let _0x4e90fe=0x0;_0x4e90fe<=_0xdaa1f7['sale_product']['length']-0x1;_0x4e90fe++){const _0x142c96=_0xdaa1f7[_0x3a7aa4(0x210)][_0x4e90fe];var _0x5a330f=await warehouse[_0x3a7aa4(0x295)]({'name':_0x5b5fc2,'room':_0x142c96['room_name']}),_0x4d813e=0x0;for(let _0x1e0e75=0x0;_0x1e0e75<=_0x5a330f['product_details'][_0x3a7aa4(0x2a9)]-0x1;_0x1e0e75++){const _0x4b53df=_0x5a330f[_0x3a7aa4(0x1d1)][_0x1e0e75];_0x4b53df[_0x3a7aa4(0x25a)]==_0x142c96[_0x3a7aa4(0x1e4)]&&_0x4b53df['uuid']==_0x142c96['uuid']&&(_0x4d813e=Math[_0x3a7aa4(0x29e)](0x0,Math[_0x3a7aa4(0x1e5)](_0x4b53df[_0x3a7aa4(0x2de)])-Math[_0x3a7aa4(0x1e5)](_0x142c96[_0x3a7aa4(0x26c)])),await warehouse['updateOne']({'_id':_0x5a330f[_0x3a7aa4(0x25a)][_0x3a7aa4(0x274)](),'product_details._id':_0x4b53df[_0x3a7aa4(0x25a)][_0x3a7aa4(0x274)](),'product_details.uuid':_0x142c96[_0x3a7aa4(0x285)]},{'$set':{'product_details.$.product_stock':_0x4d813e}}));}console[_0x3a7aa4(0x228)](typeof _0x142c96['agent_id']);if(typeof _0x142c96['agent_id']!==_0x3a7aa4(0x289)){var _0x1edab9=await staff['findById'](_0x142c96['agent_id']);console[_0x3a7aa4(0x228)](_0x3a7aa4(0x1fe));var _0x1386e5=0x0;for(let _0x388a38=0x0;_0x388a38<=_0x1edab9['product_list'][_0x3a7aa4(0x2a9)]-0x1;_0x388a38++){const _0x1a65ad=_0x1edab9[_0x3a7aa4(0x266)][_0x388a38];console[_0x3a7aa4(0x228)](_0x142c96[_0x3a7aa4(0x1e4)]+_0x3a7aa4(0x28f)+_0x1a65ad[_0x3a7aa4(0x1f3)]+_0x3a7aa4(0x294)+_0x142c96[_0x3a7aa4(0x25a)]+_0x3a7aa4(0x28f)+_0x142c96[_0x3a7aa4(0x25a)]),_0x142c96[_0x3a7aa4(0x1e4)]==_0x1a65ad[_0x3a7aa4(0x1f3)]&&_0x142c96[_0x3a7aa4(0x25a)]==0x1&&(_0x1a65ad[_0x3a7aa4(0x2de)]=Math['abs'](_0x1a65ad[_0x3a7aa4(0x2de)])+Math['abs'](_0x142c96['quantity']),_0x1386e5++);}console[_0x3a7aa4(0x228)](_0x3a7aa4(0x27f),_0x1386e5),_0x1386e5=='0'&&(_0x1edab9[_0x3a7aa4(0x266)]=_0x1edab9[_0x3a7aa4(0x266)][_0x3a7aa4(0x1f4)]({'product_name':_0x142c96[_0x3a7aa4(0x24f)],'product_stock':_0x142c96['quantity'],'bay':_0x142c96[_0x3a7aa4(0x2c6)],'level':_0x142c96[_0x3a7aa4(0x1fa)],'product_code':_0x142c96[_0x3a7aa4(0x2ac)],'primary_code':_0x142c96[_0x3a7aa4(0x2b8)],'secondary_code':_0x142c96[_0x3a7aa4(0x278)],'expiry_date':_0x142c96[_0x3a7aa4(0x272)],'production_date':_0x142c96['production_date'],'maxProducts':_0x142c96['maxProducts'],'batch_code':_0x142c96[_0x3a7aa4(0x262)],'secondary_unit':_0x142c96[_0x3a7aa4(0x1e9)],'unit':_0x142c96[_0x3a7aa4(0x28c)],'maxProducts':_0x142c96[_0x3a7aa4(0x227)],'maxPerUnit':_0x142c96[_0x3a7aa4(0x230)],'invoice':_0x142c96[_0x3a7aa4(0x2a2)],'warehouse_id':_0x142c96[_0x3a7aa4(0x1e4)],'id_incoming':_0x142c96[_0x3a7aa4(0x25a)],'uuid':_0x142c96[_0x3a7aa4(0x285)],'gross_price':_0x142c96[_0x3a7aa4(0x205)],'date_incoming':_0x142c96[_0x3a7aa4(0x258)],'outgoing_invoice':_0x142c96[_0x3a7aa4(0x234)]}),await _0x1edab9[_0x3a7aa4(0x2b7)]());}}_0xdaa1f7[_0x3a7aa4(0x1c7)]=_0x3a7aa4(0x257);const _0x517570=await _0xdaa1f7[_0x3a7aa4(0x2b7)](),_0x4b5114=await master_shop[_0x3a7aa4(0x24b)](),_0x321c88=await email_settings[_0x3a7aa4(0x295)](),_0x2ff4aa=await supervisor_settings[_0x3a7aa4(0x24b)]();var _0x11fd43=_0xdaa1f7[_0x3a7aa4(0x210)],_0x2dec53='',_0x3386e5;for(_0x3386e5 in _0x11fd43){_0x2dec53+='<tr>'+_0x3a7aa4(0x247)+_0x11fd43[_0x3386e5][_0x3a7aa4(0x24f)]+_0x3a7aa4(0x283)+_0x3a7aa4(0x247)+_0x11fd43[_0x3386e5][_0x3a7aa4(0x2ac)]+_0x3a7aa4(0x283)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x11fd43[_0x3386e5]['quantity']+_0x3a7aa4(0x283)+_0x3a7aa4(0x247)+_0x11fd43[_0x3386e5][_0x3a7aa4(0x28c)]+'</td>'+_0x3a7aa4(0x247)+_0x11fd43[_0x3386e5]['secondary_unit']+_0x3a7aa4(0x283)+_0x3a7aa4(0x247)+_0xdaa1f7[_0x3a7aa4(0x212)]+_0x3a7aa4(0x283)+_0x3a7aa4(0x247)+_0x11fd43[_0x3386e5]['room_name']+'</td>'+_0x3a7aa4(0x247)+_0x11fd43[_0x3386e5][_0x3a7aa4(0x2c6)]+'</td>';}_0x46bb3d[_0x3a7aa4(0x1fb)]('success',_0x3a7aa4(0x1d0)),_0x10779e[_0x3a7aa4(0x1cd)](_0x3a7aa4(0x220)+_0x3d8832);}catch(_0x569699){console['log'](_0x569699);}}),router[a0_0x14b807(0x231)](a0_0x14b807(0x271),auth,async(_0x1c781f,_0x1081c)=>{var _0x64a35f=a0_0x14b807;try{const {username:_0x20cb33,email:_0x2a4814,role:_0x55ed5}=_0x1c781f[_0x64a35f(0x20a)],_0xfb3c01=_0x1c781f[_0x64a35f(0x20a)],_0x3fa2ca=await profile[_0x64a35f(0x295)]({'email':_0xfb3c01['email']}),_0x41d534=await master_shop[_0x64a35f(0x24b)](),_0x49de80=_0x1c781f[_0x64a35f(0x255)]['id'],_0x4aa332=await sales_finished[_0x64a35f(0x290)](_0x49de80);let _0x176e4f=new Date(_0x4aa332['expiry_date']),_0x59c01d=('0'+_0x176e4f['getDate']())[_0x64a35f(0x2e2)](-0x2),_0x1dc22c=('0'+(_0x176e4f[_0x64a35f(0x25b)]()+0x1))[_0x64a35f(0x2e2)](-0x2),_0x1a5055=_0x176e4f['getFullYear'](),_0x542e62=_0x1a5055+'-'+_0x1dc22c+'-'+_0x59c01d;var _0x4f9616=[_0x64a35f(0x2cf),_0x64a35f(0x218)];const _0x2aa0df=await warehouse[_0x64a35f(0x213)]([{'$match':{'name':_0x4aa332['warehouse_name'],'room':_0x4aa332[_0x64a35f(0x27b)]}},{'$unwind':_0x64a35f(0x2e1)},{'$group':{'_id':_0x64a35f(0x2b2),'name':{'$first':_0x64a35f(0x28e)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x64a35f(0x2a7)},'bin':{'$first':_0x64a35f(0x1d4)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x64a35f(0x2c5)},'primary_code':{'$first':_0x64a35f(0x2c1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x64a35f(0x1ce)},'storage':{'$first':_0x64a35f(0x244)},'rack':{'$first':'$product_details.rack'}}}]),_0x4361d5=await customer[_0x64a35f(0x24b)]({});let _0x20def1;if(_0xfb3c01[_0x64a35f(0x245)]=='staff'){const _0x2fad74=await staff['findOne']({'email':_0xfb3c01['email']});_0x20def1=await warehouse[_0x64a35f(0x213)]([{'$match':{'status':_0x64a35f(0x279),'name':_0x2fad74[_0x64a35f(0x1d3)]}},{'$group':{'_id':_0x64a35f(0x25e),'name':{'$first':_0x64a35f(0x25e)}}}]);}else _0x20def1=await warehouse['aggregate']([{'$match':{'status':_0x64a35f(0x279)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x54a8cb=await product['find']({});if(_0x41d534[0x0]['language']==_0x64a35f(0x28d)){var _0x2289ac=users[_0x64a35f(0x2e3)];console[_0x64a35f(0x228)](_0x2289ac);}else{if(_0x41d534[0x0][_0x64a35f(0x1d8)]=='Hindi')var _0x2289ac=users[_0x64a35f(0x21b)];else{if(_0x41d534[0x0][_0x64a35f(0x1d8)]==_0x64a35f(0x256))var _0x2289ac=users[_0x64a35f(0x256)];else{if(_0x41d534[0x0][_0x64a35f(0x1d8)]==_0x64a35f(0x1d6))var _0x2289ac=users['Spanish'];else{if(_0x41d534[0x0][_0x64a35f(0x1d8)]==_0x64a35f(0x1f6))var _0x2289ac=users['French'];else{if(_0x41d534[0x0][_0x64a35f(0x1d8)]==_0x64a35f(0x23f))var _0x2289ac=users[_0x64a35f(0x20b)];else{if(_0x41d534[0x0]['language']=='Chinese')var _0x2289ac=users[_0x64a35f(0x1d5)];else{if(_0x41d534[0x0][_0x64a35f(0x1d8)]==_0x64a35f(0x26a))var _0x2289ac=users['Arabic'];}}}}}}}_0x1081c[_0x64a35f(0x208)](_0x64a35f(0x20f),{'success':_0x1c781f[_0x64a35f(0x1fb)]('success'),'errors':_0x1c781f[_0x64a35f(0x1fb)]('errors'),'role':_0xfb3c01,'profile':_0x3fa2ca,'customer':_0x4361d5,'warehouse':_0x20def1,'product':_0x2aa0df,'user':_0x4aa332,'master_shop':_0x41d534,'unit':_0x54a8cb,'language':_0x2289ac,'rooms_data':_0x4f9616,'ed_fullDate':_0x542e62});}catch(_0x2b8cfd){console[_0x64a35f(0x228)](_0x2b8cfd);}}),router[a0_0x14b807(0x24c)](a0_0x14b807(0x271),auth,async(_0x3622a1,_0x346be1)=>{var _0x67f9a3=a0_0x14b807;try{const _0x427543=_0x3622a1[_0x67f9a3(0x255)]['id'],_0x2944a1=await sales_finished['findOne']({'_id':_0x3622a1['params']['id']}),_0x4f545f=await warehouse[_0x67f9a3(0x295)]({'name':_0x2944a1[_0x67f9a3(0x212)],'room':_0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x27b)],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x3288f4,customer:_0x5bd669,date:_0x579122,warehouse_name:_0x52a0c5,product_name:_0x2405e0,stock:_0x333428,adjust_qty:_0x113ca3,note:_0x3991c5,room:_0x3af8c7,primary_code:_0xf2ccfc,secondary_code:_0x3cded9,prod_code:_0x5b5ed1,level:_0x115845,isle:_0x20f0a1,pallet:_0x119378,expiry_date:_0xdbd2e4}=_0x3622a1[_0x67f9a3(0x246)];if(typeof _0x2405e0==_0x67f9a3(0x2bc))var _0x58e2bb=[_0x3622a1[_0x67f9a3(0x246)]['product_name']],_0x57809f=[_0x3622a1[_0x67f9a3(0x246)]['stock']],_0x421c43=[_0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x2a0)]],_0x4e12e2=[_0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x2b8)]],_0x23c279=[_0x3622a1[_0x67f9a3(0x246)]['secondary_code']],_0x1e6c43=[_0x3622a1['body'][_0x67f9a3(0x1e2)]],_0x20244c=[_0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x1fa)]],_0x5e4bbd=[_0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x272)]];else var _0x58e2bb=[..._0x3622a1['body']['product_name']],_0x57809f=[..._0x3622a1[_0x67f9a3(0x246)]['stock']],_0x421c43=[..._0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x2a0)]],_0x4e12e2=[..._0x3622a1['body'][_0x67f9a3(0x2b8)]],_0x23c279=[..._0x3622a1['body'][_0x67f9a3(0x278)]],_0x1e6c43=[..._0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x1e2)]],_0x20244c=[..._0x3622a1['body']['level']],_0x5e4bbd=[..._0x3622a1['body'][_0x67f9a3(0x272)]];const _0x32c2ba=_0x58e2bb[_0x67f9a3(0x2bf)](_0x270941=>{return _0x270941={'product_name':_0x270941};});_0x57809f[_0x67f9a3(0x2be)]((_0x863212,_0x17db3a)=>{_0x32c2ba[_0x17db3a]['stock']=_0x863212;}),_0x421c43['forEach']((_0x5c807d,_0x3ab171)=>{var _0x1ad95c=_0x67f9a3;_0x32c2ba[_0x3ab171][_0x1ad95c(0x26c)]=_0x5c807d;}),_0x4e12e2[_0x67f9a3(0x2be)]((_0x5acb7e,_0x3ca0be)=>{var _0x2882a0=_0x67f9a3;_0x32c2ba[_0x3ca0be][_0x2882a0(0x2b8)]=_0x5acb7e;}),_0x23c279[_0x67f9a3(0x2be)]((_0x3fefff,_0x82dac6)=>{_0x32c2ba[_0x82dac6]['secondary_code']=_0x3fefff;}),_0x1e6c43['forEach']((_0x39717a,_0x244d25)=>{var _0x50f68b=_0x67f9a3;_0x32c2ba[_0x244d25][_0x50f68b(0x2ac)]=_0x39717a;}),_0x20244c[_0x67f9a3(0x2be)]((_0x41ad79,_0x3fa492)=>{var _0x4273c3=_0x67f9a3;_0x32c2ba[_0x3fa492][_0x4273c3(0x1fa)]=_0x41ad79;}),_0x5e4bbd[_0x67f9a3(0x2be)]((_0x4f40dc,_0x1b3780)=>{var _0x4002d4=_0x67f9a3;_0x32c2ba[_0x1b3780][_0x4002d4(0x272)]=_0x4f40dc;});var _0x57f33d=0x0;_0x32c2ba[_0x67f9a3(0x2be)](_0x28ad82=>{var _0x44cd2e=_0x67f9a3;console['log'](_0x44cd2e(0x241),_0x28ad82),(parseInt(_0x28ad82[_0x44cd2e(0x1e3)])<parseInt(_0x28ad82[_0x44cd2e(0x26c)])||parseInt(_0x28ad82[_0x44cd2e(0x26c)])==0x0)&&_0x57f33d++;});if(_0x57f33d!=0x0)return _0x3622a1[_0x67f9a3(0x1fb)](_0x67f9a3(0x2d2),_0x67f9a3(0x264)),_0x346be1['redirect']('back');_0x2944a1[_0x67f9a3(0x210)][_0x67f9a3(0x2be)](_0x499c7c=>{var _0x2fcb95=_0x67f9a3;const _0x2bd6d8=_0x4f545f[_0x2fcb95(0x1d1)]['map'](_0x3f37ab=>{var _0x399674=_0x2fcb95;_0x3f37ab['product_name']==_0x499c7c[_0x399674(0x24f)]&&_0x3f37ab[_0x399674(0x2c6)]==_0x499c7c[_0x399674(0x2c6)]&&(_0x3f37ab[_0x399674(0x2de)]=parseInt(_0x3f37ab[_0x399674(0x2de)])+parseInt(_0x499c7c[_0x399674(0x26c)]));});}),await _0x4f545f[_0x67f9a3(0x2b7)]();const _0x10b222=_0x32c2ba['filter'](_0x25af52=>_0x25af52[_0x67f9a3(0x26c)]!=='0'&&_0x25af52[_0x67f9a3(0x26c)]!=='');_0x2944a1[_0x67f9a3(0x2a2)]=_0x3288f4,_0x2944a1['customer']=_0x5bd669,_0x2944a1['date']=_0x579122,_0x2944a1['warehouse_name']=_0x52a0c5,_0x2944a1[_0x67f9a3(0x210)]=_0x10b222,_0x2944a1[_0x67f9a3(0x1c6)]=_0x3991c5,_0x2944a1[_0x67f9a3(0x27b)]=_0x3af8c7;const _0x277b5b=await _0x2944a1[_0x67f9a3(0x2b7)](),_0x3f7fc1=await sales_finished[_0x67f9a3(0x295)]({'_id':_0x3622a1[_0x67f9a3(0x255)]['id']}),_0x4ca9c2=await warehouse[_0x67f9a3(0x295)]({'name':_0x52a0c5,'room':_0x3af8c7,'warehouse_category':_0x67f9a3(0x27c)});_0x3f7fc1[_0x67f9a3(0x210)][_0x67f9a3(0x2be)](_0x5a6468=>{var _0x3a159d=_0x67f9a3;const _0xdb1ebb=_0x4ca9c2[_0x3a159d(0x1d1)]['map'](_0x1afc4c=>{var _0x248f9a=_0x3a159d;_0x1afc4c[_0x248f9a(0x24f)]==_0x5a6468[_0x248f9a(0x24f)]&&_0x1afc4c[_0x248f9a(0x2c6)]==_0x5a6468[_0x248f9a(0x2c6)]&&(_0x1afc4c[_0x248f9a(0x2de)]=parseInt(_0x1afc4c['product_stock'])-parseInt(_0x5a6468[_0x248f9a(0x26c)]));});}),console[_0x67f9a3(0x228)](_0x67f9a3(0x2d8),_0x4ca9c2),await _0x4ca9c2['save']();const _0x37c7a8=await c_payment_data[_0x67f9a3(0x295)]({'invoice':_0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x2a2)]});_0x37c7a8[_0x67f9a3(0x28a)]=_0x3622a1[_0x67f9a3(0x246)][_0x67f9a3(0x28a)],await _0x37c7a8[_0x67f9a3(0x2b7)](),_0x3622a1[_0x67f9a3(0x1fb)](_0x67f9a3(0x259),_0x67f9a3(0x1d0)),_0x346be1['redirect'](_0x67f9a3(0x29c));}catch(_0x37775d){console['log'](_0x37775d);}}),router['post'](a0_0x14b807(0x26f),auth,async(_0xa8aa23,_0x22cd8a)=>{var _0x205b1c=a0_0x14b807;try{const _0x2b1630=_0xa8aa23[_0x205b1c(0x255)]['id'],{invoice:_0x4dcbb5,customer:_0xdbe4c6,receivable_amount:_0x447a5e,received_amount:_0x4d2a1b}=_0xa8aa23[_0x205b1c(0x246)],_0x11b43f=await sales[_0x205b1c(0x290)](_0x2b1630);console['log'](_0x11b43f);var _0x279eff=_0x447a5e-_0x4d2a1b;console[_0x205b1c(0x228)](_0x4d2a1b),_0x11b43f[_0x205b1c(0x1ec)]=parseFloat(_0x4d2a1b)+parseFloat(_0x11b43f['received_amount']),_0x11b43f['due_amount']=_0x279eff,console[_0x205b1c(0x228)](_0x11b43f);const _0x15f487=await _0x11b43f[_0x205b1c(0x2b7)](),_0x28296b=await c_payment_data[_0x205b1c(0x295)]({'invoice':_0x4dcbb5});_0x28296b[_0x205b1c(0x2dc)]=_0x279eff,await _0x28296b[_0x205b1c(0x2b7)]();let _0x5f0078=new Date(),_0x218ebc=('0'+_0x5f0078['getDate']())[_0x205b1c(0x2e2)](-0x2),_0x4335f7=('0'+(_0x5f0078['getMonth']()+0x1))[_0x205b1c(0x2e2)](-0x2),_0x311971=_0x5f0078['getFullYear'](),_0x62f549=_0x311971+'-'+_0x4335f7+'-'+_0x218ebc;const _0x2b9943=new customer_payment({'invoice':_0x4dcbb5,'date':_0x311971+'-'+_0x4335f7+'-'+_0x218ebc,'customer':_0xdbe4c6,'reason':_0x205b1c(0x261),'amount':_0x4d2a1b}),_0x92c7fe=await _0x2b9943[_0x205b1c(0x2b7)]();_0xa8aa23['flash'](_0x205b1c(0x259),_0x205b1c(0x229)),_0x22cd8a[_0x205b1c(0x1cd)]('/all_sales/view');}catch(_0x4c9b7c){console[_0x205b1c(0x228)](_0x4c9b7c);}}),router[a0_0x14b807(0x231)]('/invoice/:id',auth,async(_0x53b005,_0x33abd8)=>{var _0x6d5092=a0_0x14b807;try{const {username:_0x36288a,email:_0x306236,role:_0x41f0e5}=_0x53b005[_0x6d5092(0x20a)],_0x128a87=_0x53b005[_0x6d5092(0x20a)],_0x421e39=await profile[_0x6d5092(0x295)]({'email':_0x128a87[_0x6d5092(0x236)]}),_0x41d9ee=await master_shop['find']();console[_0x6d5092(0x228)](_0x6d5092(0x1f5),_0x41d9ee);const _0x23587d=_0x53b005['params']['id'],_0x2d7800=await sales[_0x6d5092(0x290)](_0x23587d);console[_0x6d5092(0x228)](_0x2d7800);const _0x44bf0f=await customer['findOne']({'name':_0x2d7800[_0x6d5092(0x2d0)]});console['log'](_0x44bf0f);if(_0x41d9ee[0x0][_0x6d5092(0x1d8)]==_0x6d5092(0x28d)){var _0x24e2bc=users[_0x6d5092(0x2e3)];console[_0x6d5092(0x228)](_0x24e2bc);}else{if(_0x41d9ee[0x0][_0x6d5092(0x1d8)]==_0x6d5092(0x21b))var _0x24e2bc=users[_0x6d5092(0x21b)];else{if(_0x41d9ee[0x0][_0x6d5092(0x1d8)]==_0x6d5092(0x256))var _0x24e2bc=users[_0x6d5092(0x256)];else{if(_0x41d9ee[0x0][_0x6d5092(0x1d8)]==_0x6d5092(0x1d6))var _0x24e2bc=users['Spanish'];else{if(_0x41d9ee[0x0]['language']=='French')var _0x24e2bc=users[_0x6d5092(0x1f6)];else{if(_0x41d9ee[0x0][_0x6d5092(0x1d8)]=='Portuguese\x20(BR)')var _0x24e2bc=users['Portuguese'];else{if(_0x41d9ee[0x0][_0x6d5092(0x1d8)]==_0x6d5092(0x1d5))var _0x24e2bc=users['Chinese'];else{if(_0x41d9ee[0x0][_0x6d5092(0x1d8)]=='Arabic\x20(ae)')var _0x24e2bc=users[_0x6d5092(0x207)];}}}}}}}_0x33abd8['render'](_0x6d5092(0x26d),{'success':_0x53b005[_0x6d5092(0x1fb)](_0x6d5092(0x259)),'errors':_0x53b005[_0x6d5092(0x1fb)]('errors'),'role':_0x128a87,'profile':_0x421e39,'master_shop':_0x41d9ee,'customers':_0x44bf0f,'sales':_0x2d7800,'language':_0x24e2bc});}catch(_0x19200c){console[_0x6d5092(0x228)](_0x19200c);}}),router[a0_0x14b807(0x231)](a0_0x14b807(0x21f),auth,async(_0x41b2d1,_0x4f1ab6)=>{var _0x366b0b=a0_0x14b807;try{const {username:_0x241af3,email:_0x2b79db,role:_0x15a860}=_0x41b2d1[_0x366b0b(0x20a)],_0x4a9318=_0x41b2d1['user'],_0x3bef1c=await profile[_0x366b0b(0x295)]({'email':_0x4a9318[_0x366b0b(0x236)]}),_0x4b16df=await master_shop[_0x366b0b(0x24b)](),_0x3dffd0=_0x41b2d1[_0x366b0b(0x255)]['id'],_0x5f1c75=await sales_finished[_0x366b0b(0x290)](_0x3dffd0),_0xebb68c=await warehouse[_0x366b0b(0x213)]([{'$match':{'name':_0x5f1c75['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x366b0b(0x28e)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x366b0b(0x2a7)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x366b0b(0x219)},'floorlevel':{'$first':_0x366b0b(0x2c5)},'primary_code':{'$first':_0x366b0b(0x2c1)},'secondary_code':{'$first':_0x366b0b(0x265)},'product_code':{'$first':_0x366b0b(0x1ce)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x366b0b(0x282)},'expiry_date':{'$first':_0x366b0b(0x2d5)},'production_date':{'$first':_0x366b0b(0x2b3)},'unit':{'$first':_0x366b0b(0x2ca)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':_0x366b0b(0x260)},'maxPerUnit':{'$first':_0x366b0b(0x20d)}}}]),_0x13494b=await product[_0x366b0b(0x24b)]({}),_0x3137e6=await warehouse[_0x366b0b(0x213)]([{'$match':{'status':'Enabled','warehouse_category':_0x366b0b(0x27c),'name':{'$ne':_0x366b0b(0x1e7),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':_0x366b0b(0x25e),'name':{'$first':_0x366b0b(0x25e)}}},{'$sort':{'name':0x1}}]);var _0x16d574=['Return\x20Rooms'];const _0x419fef=await warehouse[_0x366b0b(0x213)]([{'$match':{'status':_0x366b0b(0x279),'name':_0x366b0b(0x2d3)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x4b16df[0x0][_0x366b0b(0x1d8)]=='English\x20(US)'){var _0xad9963=users['English'];console[_0x366b0b(0x228)](_0xad9963);}else{if(_0x4b16df[0x0][_0x366b0b(0x1d8)]==_0x366b0b(0x21b))var _0xad9963=users[_0x366b0b(0x21b)];else{if(_0x4b16df[0x0][_0x366b0b(0x1d8)]==_0x366b0b(0x256))var _0xad9963=users['German'];else{if(_0x4b16df[0x0][_0x366b0b(0x1d8)]==_0x366b0b(0x1d6))var _0xad9963=users[_0x366b0b(0x1d6)];else{if(_0x4b16df[0x0][_0x366b0b(0x1d8)]=='French')var _0xad9963=users['French'];else{if(_0x4b16df[0x0][_0x366b0b(0x1d8)]==_0x366b0b(0x23f))var _0xad9963=users['Portuguese'];else{if(_0x4b16df[0x0][_0x366b0b(0x1d8)]==_0x366b0b(0x1d5))var _0xad9963=users['Chinese'];else{if(_0x4b16df[0x0][_0x366b0b(0x1d8)]=='Arabic\x20(ae)')var _0xad9963=users[_0x366b0b(0x207)];}}}}}}}_0x4f1ab6[_0x366b0b(0x208)](_0x366b0b(0x24a),{'success':_0x41b2d1['flash'](_0x366b0b(0x259)),'errors':_0x41b2d1[_0x366b0b(0x1fb)]('errors'),'role':_0x4a9318,'profile':_0x3bef1c,'user':_0x5f1c75,'stock':_0xebb68c,'master_shop':_0x4b16df,'unit':_0x13494b,'language':_0xad9963,'warehouses':_0x3137e6,'rooms':_0x16d574,'warehouse_QA':_0x419fef});}catch(_0x1a0352){console['log'](_0x1a0352),_0x4f1ab6[_0x366b0b(0x2af)](0xc8)[_0x366b0b(0x1ea)]({'message':_0x1a0352[_0x366b0b(0x248)]});}}),router[a0_0x14b807(0x24c)]('/view/return_sales/:id',auth,async(_0x2cf81d,_0x4e04e2)=>{var _0x37d4a3=a0_0x14b807;if(_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x1fc)]=='QA')try{const {invoice:_0x372bde,date:_0x4198b2,warehouse_name:_0x1c2efd,product_name:_0x191d1e,primary_code:_0x237122,secondary_code:_0x1f10df,product_code:_0x55b08e,sales_quantity:_0x3593dd,stocks:_0x48d1e2,return_qty:_0x9717ee,Room_name:_0x35890d,to_warehouse_name_QA:_0x49d50f,to_Room_name_QA:_0x54d8e7,note:_0x49f1bb,for_categorize:_0xc314db,product_name_QA1:_0x4eb43e}=_0x2cf81d[_0x37d4a3(0x246)];if(typeof _0x4eb43e=='string')var _0x4de33f=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x1df)]],_0x35cfa0=[_0x2cf81d['body']['primary_code_QA']],_0x39482d=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x22e)]],_0x1f0daa=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x1ed)]],_0x2b3ca4=[_0x2cf81d['body'][_0x37d4a3(0x23c)]],_0x49d7a1=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x216)]],_0x45872b=[_0x2cf81d[_0x37d4a3(0x246)]['return_qty_QA']],_0x3c62b0=[_0x2cf81d['body'][_0x37d4a3(0x2c8)]],_0x5e366c=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x1ca)]],_0x4925cd=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x24d)]],_0x7ed392=[_0x2cf81d['body']['secondary_unit_QA']],_0x300231=[_0x2cf81d[_0x37d4a3(0x246)]['unit_QA']],_0x5ab96f=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2da)]],_0x2356e9=[_0x2cf81d[_0x37d4a3(0x246)]['expiry_date_QA']];else var _0x4de33f=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x1df)]],_0x35cfa0=[..._0x2cf81d['body']['primary_code_QA']],_0x39482d=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x22e)]],_0x1f0daa=[..._0x2cf81d[_0x37d4a3(0x246)]['product_code_QA']],_0x2b3ca4=[..._0x2cf81d['body'][_0x37d4a3(0x23c)]],_0x49d7a1=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x216)]],_0x45872b=[..._0x2cf81d['body'][_0x37d4a3(0x235)]],_0x3c62b0=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2c8)]],_0x5e366c=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x1ca)]],_0x4925cd=[..._0x2cf81d[_0x37d4a3(0x246)]['batch_code_QA']],_0x7ed392=[..._0x2cf81d['body'][_0x37d4a3(0x242)]],_0x300231=[..._0x2cf81d['body'][_0x37d4a3(0x203)]],_0x5ab96f=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2da)]],_0x2356e9=[..._0x2cf81d['body'][_0x37d4a3(0x250)]];const _0x35db27=_0x4de33f[_0x37d4a3(0x2bf)](_0xc91acd=>{return _0xc91acd={'product_name':_0xc91acd};});_0x35cfa0[_0x37d4a3(0x2be)]((_0x25b51c,_0x157f1d)=>{var _0x720f39=_0x37d4a3;_0x35db27[_0x157f1d][_0x720f39(0x2b8)]=_0x25b51c;}),_0x39482d[_0x37d4a3(0x2be)]((_0x1ccdc6,_0x23ca0b)=>{var _0x3e4bf4=_0x37d4a3;_0x35db27[_0x23ca0b][_0x3e4bf4(0x278)]=_0x1ccdc6;}),_0x1f0daa['forEach']((_0x48e8b1,_0xe4ba3c)=>{_0x35db27[_0xe4ba3c]['product_code']=_0x48e8b1;}),_0x2b3ca4[_0x37d4a3(0x2be)]((_0x58dcac,_0x556ac4)=>{var _0x474fd8=_0x37d4a3;_0x35db27[_0x556ac4][_0x474fd8(0x221)]=_0x58dcac;}),_0x49d7a1[_0x37d4a3(0x2be)]((_0x4d75e2,_0x3a0c8f)=>{var _0xc25881=_0x37d4a3;_0x35db27[_0x3a0c8f][_0xc25881(0x1e3)]=_0x4d75e2;}),_0x45872b[_0x37d4a3(0x2be)]((_0x36d9c2,_0xa9d513)=>{var _0x5cc5bd=_0x37d4a3;_0x35db27[_0xa9d513][_0x5cc5bd(0x2c9)]=_0x36d9c2;}),_0x3c62b0['forEach']((_0x3d924e,_0x185c0b)=>{var _0x396e88=_0x37d4a3;_0x35db27[_0x185c0b][_0x396e88(0x201)]=_0x3d924e;}),_0x5e366c[_0x37d4a3(0x2be)]((_0xd4e683,_0x38613f)=>{_0x35db27[_0x38613f]['maxProducts']=_0xd4e683;}),_0x4925cd[_0x37d4a3(0x2be)]((_0x174d73,_0x1ccc6a)=>{_0x35db27[_0x1ccc6a]['batch_code']=_0x174d73;}),_0x7ed392[_0x37d4a3(0x2be)]((_0x5434ed,_0x10b9a7)=>{var _0x2c31eb=_0x37d4a3;_0x35db27[_0x10b9a7][_0x2c31eb(0x1e9)]=_0x5434ed;}),_0x300231[_0x37d4a3(0x2be)]((_0x5bbb85,_0x3f86b5)=>{var _0x3329d2=_0x37d4a3;_0x35db27[_0x3f86b5][_0x3329d2(0x28c)]=_0x5bbb85;}),_0x5ab96f[_0x37d4a3(0x2be)]((_0x1f9883,_0x42b3b2)=>{_0x35db27[_0x42b3b2]['production_date']=_0x1f9883;}),_0x2356e9['forEach']((_0x3f5cc1,_0x267832)=>{var _0x4596a3=_0x37d4a3;_0x35db27[_0x267832][_0x4596a3(0x272)]=_0x3f5cc1;});const _0x45391f=await sales_finished[_0x37d4a3(0x295)]({'invoice':_0x372bde});_0x45391f['return_data']=_0x37d4a3(0x257);const _0x5baad4=await _0x45391f[_0x37d4a3(0x2b7)](),_0x3a3f8c=new sales_return_finished({'invoice':_0x372bde,'customer':_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2d0)],'date':_0x4198b2,'warehouse_name':_0x1c2efd,'room':_0x35890d,'ToWarehouse':_0x49d50f,'ToRoom':_0x54d8e7,'return_sale_QA':_0x35db27,'note':_0x49f1bb,'warehouse_cat':_0xc314db}),_0x504549=await _0x3a3f8c['save'](),_0x409e09=await sales_return_finished[_0x37d4a3(0x295)]({'invoice':_0x372bde}),_0x1b7a11=await warehouse[_0x37d4a3(0x295)]({'name':_0x49d50f,'room':_0x54d8e7});_0x409e09['return_sale_QA'][_0x37d4a3(0x2be)](_0x3b3f45=>{var _0x1721d7=_0x37d4a3,_0x1b09f9=0x0;const _0x5ee647=_0x1b7a11['product_details'][_0x1721d7(0x2bf)](_0x28463a=>{var _0x4dc4da=_0x1721d7;_0x28463a['product_name']==_0x3b3f45[_0x4dc4da(0x24f)]&&_0x28463a[_0x4dc4da(0x272)]==_0x3b3f45['expiry_date']&&_0x28463a[_0x4dc4da(0x2d7)]==_0x3b3f45[_0x4dc4da(0x2d7)]&&_0x28463a[_0x4dc4da(0x262)]==_0x3b3f45[_0x4dc4da(0x262)]&&(_0x28463a[_0x4dc4da(0x2de)]=parseInt(_0x28463a[_0x4dc4da(0x2de)])+parseInt(_0x3b3f45[_0x4dc4da(0x2c9)]),_0x1b09f9++);});_0x1b09f9=='0'&&(_0x1b7a11['product_details']=_0x1b7a11[_0x1721d7(0x1d1)][_0x1721d7(0x1f4)]({'product_name':_0x3b3f45['product_name'],'product_stock':_0x3b3f45[_0x1721d7(0x2c9)],'primary_code':_0x3b3f45[_0x1721d7(0x2b8)],'secondary_code':_0x3b3f45[_0x1721d7(0x278)],'product_code':_0x3b3f45['product_code'],'batch_code':_0x3b3f45[_0x1721d7(0x262)],'maxPerUnit':_0x3b3f45['maxPerUnit'],'production_date':_0x3b3f45[_0x1721d7(0x2d7)],'expiry_date':_0x3b3f45['expiry_date'],'secondary_unit':_0x3b3f45[_0x1721d7(0x1e9)],'unit':_0x3b3f45[_0x1721d7(0x28c)],'maxProducts':_0x3b3f45[_0x1721d7(0x227)],'bay':_0x3b3f45['bay']}));}),await _0x1b7a11[_0x37d4a3(0x2b7)]();const _0x3f1e74=new c_payment_data({'invoice':_0x372bde,'customer':_0x2cf81d['body'][_0x37d4a3(0x2d0)],'reason':_0x37d4a3(0x2c2)});await _0x3f1e74['save']();const _0x1c9356=await master_shop[_0x37d4a3(0x24b)](),_0x11d7f2=await email_settings[_0x37d4a3(0x295)](),_0x5b81e8=await customer[_0x37d4a3(0x295)]({'name':_0x2cf81d[_0x37d4a3(0x246)]['customer']});_0x1c9356[0x0][_0x37d4a3(0x2aa)]==0x1?(right_currency=_0x1c9356[0x0][_0x37d4a3(0x29b)],left_currency=''):(right_currency='',left_currency=_0x1c9356[0x0][_0x37d4a3(0x29b)]);var _0x9646b8=_0x4de33f,_0x12d14f=_0x45872b,_0x1b6b7f='',_0x47d6b3;for(_0x47d6b3 in _0x9646b8){_0x1b6b7f+=_0x37d4a3(0x293)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9646b8[_0x47d6b3]+_0x37d4a3(0x283)+_0x37d4a3(0x247)+_0x12d14f[_0x47d6b3]+_0x37d4a3(0x283)+_0x37d4a3(0x298);}console[_0x37d4a3(0x228)](_0x37d4a3(0x266),_0x1b6b7f);let _0x3640e9=nodemailer['createTransport']({'service':_0x37d4a3(0x2c3),'auth':{'user':_0x11d7f2[_0x37d4a3(0x236)],'pass':_0x11d7f2[_0x37d4a3(0x21c)]}}),_0x5ac7e4={'from':_0x11d7f2[_0x37d4a3(0x236)],'to':_0x5b81e8['email'],'subject':_0x37d4a3(0x1e0),'attachments':[{'filename':'Logo.png','path':__dirname+_0x37d4a3(0x25c)+_0x37d4a3(0x2a3)+_0x1c9356[0x0][_0x37d4a3(0x209)],'cid':_0x37d4a3(0x224)}],'html':'<!DOCTYPE\x20html>'+_0x37d4a3(0x1c8)+_0x37d4a3(0x1f1)+_0x37d4a3(0x292)+_0x37d4a3(0x1f8)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x37d4a3(0x1f9)+'<div>'+'<h2>\x20'+_0x1c9356[0x0][_0x37d4a3(0x297)]+'\x20</h2>'+_0x37d4a3(0x1f9)+'</div>'+_0x37d4a3(0x1da)+_0x37d4a3(0x292)+_0x37d4a3(0x1cb)+_0x37d4a3(0x222)+_0x372bde+'\x20'+_0x37d4a3(0x22d)+_0x37d4a3(0x251)+_0x4198b2+'\x20'+_0x37d4a3(0x1de)+_0x37d4a3(0x2cd)+_0x37d4a3(0x1f9)+_0x37d4a3(0x23a)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x37d4a3(0x2a5)+_0x37d4a3(0x2e0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x37d4a3(0x22f)+_0x37d4a3(0x298)+_0x37d4a3(0x299)+_0x37d4a3(0x1ef)+'\x20'+_0x1b6b7f+'\x20'+_0x37d4a3(0x20c)+_0x37d4a3(0x2b1)+_0x37d4a3(0x292)+_0x37d4a3(0x23d)+'<h5>'+_0x1c9356[0x0][_0x37d4a3(0x297)]+_0x37d4a3(0x2cd)+_0x37d4a3(0x1f9)+'</div>'+_0x37d4a3(0x24e)};_0x3640e9[_0x37d4a3(0x1eb)](_0x5ac7e4,function(_0x179439,_0x1fd12b){var _0x4c997c=_0x37d4a3;_0x179439?(console['log'](_0x179439),console[_0x4c997c(0x228)](_0x4c997c(0x1dd))):console[_0x4c997c(0x228)]('Email\x20sent\x20successfully');}),_0x2cf81d[_0x37d4a3(0x1fb)](_0x37d4a3(0x259),_0x37d4a3(0x263)),_0x4e04e2[_0x37d4a3(0x1cd)](_0x37d4a3(0x29c));}catch(_0x138f5d){_0x4e04e2[_0x37d4a3(0x2af)](0xc8)[_0x37d4a3(0x1ea)]({'message1':_0x138f5d[_0x37d4a3(0x248)]});}else{if(_0x2cf81d['body'][_0x37d4a3(0x1fc)]=='GS')try{const {invoice:_0x319276,date:_0xd7a487,warehouse_name:_0x45913c,product_name:_0x178053,primary_code:_0x1ce497,secondary_code:_0x496e22,product_code:_0x4166f3,sales_quantity:_0x533968,stocks:_0x23d069,return_qty:_0x5a0045,Room_name:_0x450cb0,to_warehouse_name:_0x51ad5f,to_Room_name:_0x2be869,note:_0x7d80d0,level:_0x181c99,isle:_0x33ce96,pallet:_0x4aae67,for_categorize:_0x2fd4ac}=_0x2cf81d['body'];if(typeof _0x178053==_0x37d4a3(0x2bc))var _0x4de33f=[_0x2cf81d[_0x37d4a3(0x246)]['product_name']],_0x35cfa0=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2b8)]],_0x39482d=[_0x2cf81d['body']['secondary_code']],_0x1f0daa=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2ac)]],_0x2b3ca4=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x25f)]],_0x45872b=[_0x2cf81d[_0x37d4a3(0x246)]['return_qty']],_0xf14f0b=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2c6)]],_0x3c62b0=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x201)]],_0x5e366c=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x227)]],_0x4925cd=[_0x2cf81d['body'][_0x37d4a3(0x262)]],_0x7ed392=[_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x1e9)]],_0x300231=[_0x2cf81d['body'][_0x37d4a3(0x28c)]],_0x5ab96f=[_0x2cf81d['body'][_0x37d4a3(0x2d7)]],_0x2356e9=[_0x2cf81d[_0x37d4a3(0x246)]['expiry_date']];else var _0x4de33f=[..._0x2cf81d['body'][_0x37d4a3(0x24f)]],_0x35cfa0=[..._0x2cf81d[_0x37d4a3(0x246)]['primary_code']],_0x39482d=[..._0x2cf81d['body'][_0x37d4a3(0x278)]],_0x1f0daa=[..._0x2cf81d[_0x37d4a3(0x246)]['product_code']],_0x2b3ca4=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x25f)]],_0x45872b=[..._0x2cf81d[_0x37d4a3(0x246)]['return_qty']],_0xf14f0b=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2c6)]],_0x3c62b0=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x201)]],_0x5e366c=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x227)]],_0x4925cd=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x262)]],_0x7ed392=[..._0x2cf81d[_0x37d4a3(0x246)]['secondary_unit']],_0x300231=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x28c)]],_0x5ab96f=[..._0x2cf81d[_0x37d4a3(0x246)]['production_date']],_0x2356e9=[..._0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x272)]];const _0x1fb1a6=_0x4de33f[_0x37d4a3(0x2bf)](_0xb14df8=>{return _0xb14df8={'product_name':_0xb14df8};});_0x35cfa0['forEach']((_0x5d61a4,_0x472f51)=>{_0x1fb1a6[_0x472f51]['primary_code']=_0x5d61a4;}),_0x39482d[_0x37d4a3(0x2be)]((_0x5082e0,_0x231b67)=>{_0x1fb1a6[_0x231b67]['secondary_code']=_0x5082e0;}),_0x1f0daa['forEach']((_0x4212e4,_0x4dc8d7)=>{var _0x15f347=_0x37d4a3;_0x1fb1a6[_0x4dc8d7][_0x15f347(0x2ac)]=_0x4212e4;}),_0x2b3ca4[_0x37d4a3(0x2be)]((_0x56f5a1,_0x182d62)=>{var _0x40eff8=_0x37d4a3;_0x1fb1a6[_0x182d62][_0x40eff8(0x221)]=_0x56f5a1;}),_0x45872b[_0x37d4a3(0x2be)]((_0x28d868,_0x2020fb)=>{var _0x2f8f5d=_0x37d4a3;_0x1fb1a6[_0x2020fb][_0x2f8f5d(0x2c9)]=_0x28d868;}),_0xf14f0b[_0x37d4a3(0x2be)]((_0x2ac795,_0x1cd458)=>{var _0x11b71a=_0x37d4a3;_0x1fb1a6[_0x1cd458][_0x11b71a(0x2c6)]=_0x2ac795;}),_0x3c62b0['forEach']((_0x1cfec9,_0x3b2ff3)=>{var _0xe5ef1e=_0x37d4a3;_0x1fb1a6[_0x3b2ff3][_0xe5ef1e(0x201)]=_0x1cfec9;}),_0x5e366c['forEach']((_0x1f8112,_0x48b0ed)=>{var _0x4dc513=_0x37d4a3;_0x1fb1a6[_0x48b0ed][_0x4dc513(0x227)]=_0x1f8112;}),_0x4925cd['forEach']((_0x45e229,_0x17059d)=>{var _0x302b85=_0x37d4a3;_0x1fb1a6[_0x17059d][_0x302b85(0x262)]=_0x45e229;}),_0x7ed392['forEach']((_0xb4d270,_0x123e6b)=>{var _0x41d5d0=_0x37d4a3;_0x1fb1a6[_0x123e6b][_0x41d5d0(0x1e9)]=_0xb4d270;}),_0x300231['forEach']((_0x3c9603,_0x5babfa)=>{var _0x1f1894=_0x37d4a3;_0x1fb1a6[_0x5babfa][_0x1f1894(0x28c)]=_0x3c9603;}),_0x5ab96f[_0x37d4a3(0x2be)]((_0x5b576e,_0x11648b)=>{var _0x488007=_0x37d4a3;_0x1fb1a6[_0x11648b][_0x488007(0x2d7)]=_0x5b576e;}),_0x2356e9[_0x37d4a3(0x2be)]((_0x546afa,_0x356ad9)=>{var _0xe9551c=_0x37d4a3;_0x1fb1a6[_0x356ad9][_0xe9551c(0x272)]=_0x546afa;});var _0x36505c=0x0;_0x1fb1a6['forEach'](_0x5c030b=>{var _0x1280a9=_0x37d4a3;(parseInt(_0x5c030b[_0x1280a9(0x221)])<parseInt(_0x5c030b[_0x1280a9(0x2c9)])||parseInt(_0x5c030b[_0x1280a9(0x1e3)])<parseInt(_0x5c030b[_0x1280a9(0x2c9)])&&parseInt(_0x5c030b[_0x1280a9(0x221)])>parseInt(_0x5c030b[_0x1280a9(0x2c9)])||parseInt(_0x5c030b[_0x1280a9(0x2c9)])==0x0)&&_0x36505c++;});if(_0x36505c!=0x0)return _0x2cf81d[_0x37d4a3(0x1fb)](_0x37d4a3(0x2d2),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x4e04e2[_0x37d4a3(0x1cd)](_0x37d4a3(0x238));const _0x566635=await sales_finished[_0x37d4a3(0x295)]({'invoice':_0x319276});_0x566635[_0x37d4a3(0x2ab)]=_0x37d4a3(0x257);const _0x1d309d=await _0x566635[_0x37d4a3(0x2b7)](),_0x26c8bd=new sales_return_finished({'invoice':_0x319276,'customer':_0x2cf81d[_0x37d4a3(0x246)][_0x37d4a3(0x2d0)],'date':_0xd7a487,'warehouse_name':_0x45913c,'room':_0x450cb0,'ToWarehouse':_0x51ad5f,'ToRoom':_0x2be869,'return_sale':_0x1fb1a6,'note':_0x7d80d0,'warehouse_cat':_0x2fd4ac}),_0x3fdb29=await _0x26c8bd[_0x37d4a3(0x2b7)](),_0xb8c1be=await sales_return_finished[_0x37d4a3(0x295)]({'invoice':_0x319276}),_0x478c22=await warehouse[_0x37d4a3(0x295)]({'name':_0x51ad5f,'room':_0x2be869,'warehouse_category':_0x37d4a3(0x27c)});_0xb8c1be['return_sale'][_0x37d4a3(0x2be)](_0x3ffe77=>{var _0x536fe2=_0x37d4a3,_0x3c465f=0x0;const _0x469c1a=_0x478c22[_0x536fe2(0x1d1)][_0x536fe2(0x2bf)](_0x55e1df=>{var _0x5522c4=_0x536fe2;_0x55e1df[_0x5522c4(0x24f)]==_0x3ffe77[_0x5522c4(0x24f)]&&_0x55e1df['bay']==_0x3ffe77[_0x5522c4(0x2c6)]&&_0x55e1df[_0x5522c4(0x272)]==_0x3ffe77[_0x5522c4(0x272)]&&_0x55e1df[_0x5522c4(0x2d7)]==_0x3ffe77[_0x5522c4(0x2d7)]&&_0x55e1df[_0x5522c4(0x262)]==_0x3ffe77[_0x5522c4(0x262)]&&(_0x55e1df[_0x5522c4(0x2de)]=parseInt(_0x55e1df[_0x5522c4(0x2de)])+parseInt(_0x3ffe77[_0x5522c4(0x2c9)]),_0x3c465f++);});_0x3c465f=='0'&&(_0x478c22[_0x536fe2(0x1d1)]=_0x478c22[_0x536fe2(0x1d1)]['concat']({'product_name':_0x3ffe77[_0x536fe2(0x24f)],'product_stock':_0x3ffe77[_0x536fe2(0x2c9)],'primary_code':_0x3ffe77[_0x536fe2(0x2b8)],'secondary_code':_0x3ffe77[_0x536fe2(0x278)],'product_code':_0x3ffe77[_0x536fe2(0x2ac)],'bay':_0x3ffe77[_0x536fe2(0x2c6)],'batch_code':_0x3ffe77[_0x536fe2(0x262)],'maxPerUnit':_0x3ffe77[_0x536fe2(0x201)],'production_date':_0x3ffe77[_0x536fe2(0x2d7)],'expiry_date':_0x3ffe77[_0x536fe2(0x272)],'secondary_unit':_0x3ffe77['secondary_unit'],'unit':_0x3ffe77[_0x536fe2(0x28c)],'maxProducts':_0x3ffe77[_0x536fe2(0x227)]}));}),await _0x478c22[_0x37d4a3(0x2b7)](),console['log'](_0x2cf81d['body']);const _0x24bb4b=new c_payment_data({'invoice':_0x319276,'customer':_0x2cf81d[_0x37d4a3(0x246)]['customer'],'reason':_0x37d4a3(0x2c2)});await _0x24bb4b['save']();const _0x46ba78=await master_shop['find']();console[_0x37d4a3(0x228)](_0x37d4a3(0x253),_0x46ba78[0x0]['image']);const _0x1cb2f9=await email_settings[_0x37d4a3(0x295)](),_0x3b19ca=await customer[_0x37d4a3(0x295)]({'name':_0x2cf81d['body'][_0x37d4a3(0x2d0)]});console['log']('customer_data',_0x3b19ca);_0x46ba78[0x0]['currency_placement']==0x1?(right_currency=_0x46ba78[0x0][_0x37d4a3(0x29b)],left_currency=''):(right_currency='',left_currency=_0x46ba78[0x0][_0x37d4a3(0x29b)]);var _0x9646b8=_0x4de33f,_0x12d14f=_0x45872b,_0x1b6b7f='',_0x47d6b3;for(_0x47d6b3 in _0x9646b8){_0x1b6b7f+=_0x37d4a3(0x293)+_0x37d4a3(0x247)+_0x9646b8[_0x47d6b3]+_0x37d4a3(0x283)+_0x37d4a3(0x247)+_0x12d14f[_0x47d6b3]+_0x37d4a3(0x283)+_0x37d4a3(0x298);}console['log'](_0x37d4a3(0x266),_0x1b6b7f);let _0x481488=nodemailer['createTransport']({'service':_0x37d4a3(0x2c3),'auth':{'user':_0x1cb2f9[_0x37d4a3(0x236)],'pass':_0x1cb2f9[_0x37d4a3(0x21c)]}}),_0x4240a1={'from':_0x1cb2f9[_0x37d4a3(0x236)],'to':_0x3b19ca[_0x37d4a3(0x236)],'subject':_0x37d4a3(0x1e0),'attachments':[{'filename':_0x37d4a3(0x21e),'path':__dirname+_0x37d4a3(0x25c)+_0x37d4a3(0x2a3)+_0x46ba78[0x0]['image'],'cid':_0x37d4a3(0x224)}],'html':_0x37d4a3(0x284)+_0x37d4a3(0x1c8)+'</head><body>'+_0x37d4a3(0x292)+_0x37d4a3(0x1f8)+'<div>'+_0x37d4a3(0x226)+_0x37d4a3(0x1f9)+_0x37d4a3(0x292)+'<h2>\x20'+_0x46ba78[0x0][_0x37d4a3(0x297)]+_0x37d4a3(0x223)+'</div>'+_0x37d4a3(0x1f9)+_0x37d4a3(0x1da)+_0x37d4a3(0x292)+_0x37d4a3(0x1cb)+_0x37d4a3(0x222)+_0x319276+'\x20'+_0x37d4a3(0x22d)+_0x37d4a3(0x251)+_0xd7a487+'\x20'+_0x37d4a3(0x1de)+'</h5>'+_0x37d4a3(0x1f9)+_0x37d4a3(0x23a)+_0x37d4a3(0x26b)+_0x37d4a3(0x293)+_0x37d4a3(0x2a5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x37d4a3(0x22f)+'</tr>'+'</thead>'+_0x37d4a3(0x1ef)+'\x20'+_0x1b6b7f+'\x20'+_0x37d4a3(0x20c)+_0x37d4a3(0x2b1)+_0x37d4a3(0x292)+_0x37d4a3(0x23d)+_0x37d4a3(0x2a4)+_0x46ba78[0x0][_0x37d4a3(0x297)]+_0x37d4a3(0x2cd)+_0x37d4a3(0x1f9)+'</div>'+'</body></html>'};_0x481488['sendMail'](_0x4240a1,function(_0x56f42f,_0x1ce883){var _0x9bade2=_0x37d4a3;_0x56f42f?(console[_0x9bade2(0x228)](_0x56f42f),console[_0x9bade2(0x228)](_0x9bade2(0x1dd))):console[_0x9bade2(0x228)](_0x9bade2(0x288));}),_0x2cf81d[_0x37d4a3(0x1fb)](_0x37d4a3(0x259),_0x37d4a3(0x263)),_0x4e04e2[_0x37d4a3(0x1cd)](_0x37d4a3(0x29c));}catch(_0x12da7d){console['log'](_0x12da7d),_0x4e04e2[_0x37d4a3(0x2af)](0xc8)['json']({'message1':_0x12da7d[_0x37d4a3(0x248)]});}}}),router[a0_0x14b807(0x231)](a0_0x14b807(0x2b6),auth,async(_0x137a61,_0xf57851)=>{var _0x311fc0=a0_0x14b807;try{const {username:_0x49d1e1,email:_0x14aef0,role:_0x448db2}=_0x137a61[_0x311fc0(0x20a)],_0x5a3b93=_0x137a61['user'],_0x1798c3=await profile['findOne']({'email':_0x5a3b93[_0x311fc0(0x236)]}),_0x2e91bf=await master_shop[_0x311fc0(0x24b)]();console[_0x311fc0(0x228)](_0x311fc0(0x2c0),_0x2e91bf);const _0x4ce2e1=_0x137a61[_0x311fc0(0x255)]['id'],_0x3edc7b=await sales['findById'](_0x4ce2e1);console[_0x311fc0(0x228)](_0x311fc0(0x21a),_0x3edc7b);if(_0x2e91bf[0x0]['language']==_0x311fc0(0x28d))var _0x40152b=users[_0x311fc0(0x2e3)];else{if(_0x2e91bf[0x0][_0x311fc0(0x1d8)]==_0x311fc0(0x21b))var _0x40152b=users[_0x311fc0(0x21b)];else{if(_0x2e91bf[0x0]['language']==_0x311fc0(0x256))var _0x40152b=users[_0x311fc0(0x256)];else{if(_0x2e91bf[0x0][_0x311fc0(0x1d8)]==_0x311fc0(0x1d6))var _0x40152b=users['Spanish'];else{if(_0x2e91bf[0x0][_0x311fc0(0x1d8)]==_0x311fc0(0x1f6))var _0x40152b=users[_0x311fc0(0x1f6)];else{if(_0x2e91bf[0x0]['language']==_0x311fc0(0x23f))var _0x40152b=users[_0x311fc0(0x20b)];else{if(_0x2e91bf[0x0][_0x311fc0(0x1d8)]==_0x311fc0(0x1d5))var _0x40152b=users['Chinese'];else{if(_0x2e91bf[0x0]['language']==_0x311fc0(0x26a))var _0x40152b=users[_0x311fc0(0x207)];}}}}}}}_0xf57851[_0x311fc0(0x208)]('all_sales_barcode',{'success':_0x137a61[_0x311fc0(0x1fb)]('success'),'errors':_0x137a61[_0x311fc0(0x1fb)]('errors'),'role':_0x5a3b93,'profile':_0x1798c3,'alldata':_0x3edc7b,'master_shop':_0x2e91bf,'language':_0x40152b});}catch(_0x495abf){console['log'](_0x495abf);}}),router['post'](a0_0x14b807(0x26e),async(_0x2bfc56,_0x3c3d30)=>{var _0x285e4b=a0_0x14b807;const {product_code:_0x41d070,warehouse_name:_0xff5cb1,rooms_data:_0x3077f9,Roomslist:_0x512ed0,sales_category:_0x547bf0}=_0x2bfc56[_0x285e4b(0x246)],_0x23a518=_0x512ed0[_0x285e4b(0x267)](','),_0x186f45=[];async function _0x2b3c4e(_0xb11004){var _0x160fc9=_0x285e4b;const _0x2216b0=await warehouse[_0x160fc9(0x213)]([{'$match':{'name':_0xff5cb1,'room':_0xb11004}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x41d070}},{'$group':{'_id':_0x160fc9(0x2b2),'name':{'$first':_0x160fc9(0x28e)},'product_stock':{'$first':_0x160fc9(0x277)},'primary_code':{'$first':_0x160fc9(0x2c1)},'secondary_code':{'$first':_0x160fc9(0x265)},'product_code':{'$first':_0x160fc9(0x1ce)},'level':{'$first':_0x160fc9(0x1e6)},'bay':{'$first':_0x160fc9(0x2a7)},'type':{'$first':_0x160fc9(0x219)},'pallet':{'$first':_0x160fc9(0x2c5)},'unit':{'$first':_0x160fc9(0x2ca)},'secondary_unit':{'$first':_0x160fc9(0x200)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x160fc9(0x282)},'expiry_date':{'$first':_0x160fc9(0x2d5)},'production_date':{'$first':_0x160fc9(0x2b3)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x160fc9(0x2ad)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x160fc9(0x2d4)},'uuid':{'$first':_0x160fc9(0x1e8)},'gross_price':{'$first':_0x160fc9(0x22a)},'sales_category':{'$first':_0x160fc9(0x281)}}}]),_0x52e412=await warehouse[_0x160fc9(0x213)]([{'$match':{'name':_0xff5cb1,'room':_0xb11004}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x41d070}},{'$group':{'_id':_0x160fc9(0x2b2),'name':{'$first':_0x160fc9(0x28e)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x160fc9(0x1ce)},'level':{'$first':_0x160fc9(0x2a7)},'isle':{'$first':_0x160fc9(0x1d4)},'type':{'$first':_0x160fc9(0x219)},'pallet':{'$first':_0x160fc9(0x2c5)},'unit':{'$first':_0x160fc9(0x2ca)},'secondary_unit':{'$first':_0x160fc9(0x200)},'storage':{'$first':_0x160fc9(0x244)},'rack':{'$first':_0x160fc9(0x282)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x160fc9(0x2b3)},'maxPerUnit':{'$first':_0x160fc9(0x20d)},'batch_code':{'$first':_0x160fc9(0x260)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x160fc9(0x1ee)},'invoice':{'$first':_0x160fc9(0x2d4)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x160fc9(0x22a)},'sales_category':{'$first':_0x160fc9(0x281)}}}]);if(_0x2216b0[_0x160fc9(0x2a9)]>0x0)_0x186f45[_0x160fc9(0x2d9)](_0x2216b0);else _0x52e412[_0x160fc9(0x2a9)]>0x0&&_0x186f45[_0x160fc9(0x2d9)](_0x52e412);}const _0x3572dc=_0x23a518[_0x285e4b(0x2bf)](_0x5e23cc=>_0x2b3c4e(_0x5e23cc));await Promise[_0x285e4b(0x232)](_0x3572dc),_0x3c3d30[_0x285e4b(0x1ea)](_0x186f45);}),router[a0_0x14b807(0x24c)](a0_0x14b807(0x275),async(_0x5e0db8,_0x3fa515)=>{var _0x26b438=a0_0x14b807;const {product_code:_0xd6e8b7,warehouse_name:_0x2c9bca,rooms_data:_0x3c896c,Roomslist:_0x378a7d,sales_category:_0xb07e0b}=_0x5e0db8[_0x26b438(0x246)],_0x47d562=_0x378a7d[_0x26b438(0x267)](','),_0x576d21=[];async function _0x2512a4(_0x53ffb9){var _0x556529=_0x26b438;const _0x1dac54=await warehouse[_0x556529(0x213)]([{'$match':{'name':_0x2c9bca,'room':_0x53ffb9}},{'$unwind':_0x556529(0x2e1)},{'$match':{'product_details.primary_code':_0xd6e8b7,'product_details.sales_category':_0xb07e0b,'product_details.type_products':'log'}},{'$group':{'_id':_0x556529(0x2b2),'name':{'$first':_0x556529(0x28e)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x556529(0x2c1)},'secondary_code':{'$first':_0x556529(0x265)},'product_code':{'$first':_0x556529(0x1ce)},'level':{'$first':_0x556529(0x1e6)},'bay':{'$first':_0x556529(0x2a7)},'type':{'$first':_0x556529(0x219)},'pallet':{'$first':_0x556529(0x2c5)},'unit':{'$first':_0x556529(0x2ca)},'secondary_unit':{'$first':_0x556529(0x200)},'storage':{'$first':_0x556529(0x244)},'rack':{'$first':_0x556529(0x282)},'expiry_date':{'$first':_0x556529(0x2d5)},'production_date':{'$first':_0x556529(0x2b3)},'maxPerUnit':{'$first':_0x556529(0x20d)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x556529(0x2ad)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x556529(0x1ee)},'invoice':{'$first':_0x556529(0x2d4)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x556529(0x22a)},'sales_category':{'$first':_0x556529(0x281)},'type_products':{'$first':_0x556529(0x20e)}}}]);console[_0x556529(0x228)](_0x556529(0x228)+_0x556529(0x2a8)+_0xd6e8b7+'\x20<>\x20'+_0xb07e0b);const _0x5ac689=await warehouse[_0x556529(0x213)]([{'$match':{'name':_0x2c9bca,'room':_0x53ffb9}},{'$unwind':_0x556529(0x2e1)},{'$match':{'product_details.secondary_code':_0xd6e8b7,'product_details.sales_category':_0xb07e0b,'product_details.type_products':'log'}},{'$group':{'_id':_0x556529(0x2b2),'name':{'$first':_0x556529(0x28e)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x556529(0x2c1)},'secondary_code':{'$first':_0x556529(0x265)},'product_code':{'$first':_0x556529(0x1ce)},'level':{'$first':_0x556529(0x2a7)},'isle':{'$first':_0x556529(0x1d4)},'type':{'$first':_0x556529(0x219)},'pallet':{'$first':_0x556529(0x2c5)},'unit':{'$first':_0x556529(0x2ca)},'secondary_unit':{'$first':_0x556529(0x200)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x556529(0x282)},'expiry_date':{'$first':_0x556529(0x2d5)},'production_date':{'$first':_0x556529(0x2b3)},'maxPerUnit':{'$first':_0x556529(0x20d)},'batch_code':{'$first':_0x556529(0x260)},'product_cat':{'$first':_0x556529(0x2ad)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x556529(0x1ee)},'invoice':{'$first':_0x556529(0x2d4)},'uuid':{'$first':_0x556529(0x1e8)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x556529(0x281)},'type_products':{'$first':_0x556529(0x20e)}}}]);if(_0x1dac54['length']>0x0)_0x576d21[_0x556529(0x2d9)](_0x1dac54);else _0x5ac689[_0x556529(0x2a9)]>0x0&&_0x576d21[_0x556529(0x2d9)](_0x5ac689);}const _0x1bfe42=_0x47d562[_0x26b438(0x2bf)](_0x4fedc9=>_0x2512a4(_0x4fedc9));await Promise[_0x26b438(0x232)](_0x1bfe42),_0x3fa515[_0x26b438(0x1ea)](_0x576d21);}),module[a0_0x14b807(0x296)]=router;