function a0_0x5b52(){var _0x381429=['prod_code','room','maxProducts','Arabic','$product_details.room_name','$_id','sale_product','True','production_date','currency','maxperunit','<span\x20style=\x22float:\x20right;\x22>','/view/add_sales_logs','$sale_product','add_sales_finished','primary_code','return_sale_finished','string','outgoing_invoice','$product_details.production_date','padStart','status','<tr>','$note','product_code_QA','Spanish','English','Sales\x20Add\x20successfully','findOne','$finalize','sales_quantity','<strong>\x20Regards\x20</strong>','/view_log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view','/preview/:id','\x20&&\x20','max_per_unit','agent_id','aggregate','/view/add_sales/:id','Ambient','unit','$sale_product.type','4019634tfBzEk','nodemailer','return_qty_QA','2470920ZWbMXR','sale_qty','own','concat','product_date','level','</thead>','room_name','primary_code_QA','$product_details._id','maxPerUnit','</div>','../public/language/languages.json','all','adjust_qty','255661vacBpk','forEach','customer_data','$product_details','quantity','site_title','$product','gmail','save','\x20<>\x20','$product.product_name','/all_sales_finished/view','Quality\x20Inspection','\x20Order\x20Date\x20:\x20','all_sales_finished_logs','sales\x20item\x20return\x20successfull','$product_details.expiry_date','German','</table>','/barcode/:id','$product_details.sales_category','$name','note','$customer','../middleware/auth','uuid','filter','stocks_QA','74lpQGnV','logs','$sale_product.quantity','level2','undefined','master','<h5\x20style=\x22text-align:\x20left;\x22>','date','bay','/view/add_sale/product','Sale\x20Return','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','edit_sales_finished_view','Arabic\x20(ae)','$product_details.rack','sales_quantity_QA','params','suppliers','return_sale_QA','payment\x20successfull','Chinese','/give_payment/:id','/view/return_sales/:id','<h2>\x20','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/view/add_sales','$product_details.type','<div>','$product_details.product_code','email','for_categorize','max','body','product','$product_details.maxPerUnit','final','$room','$product_details.invoice','\x20==\x20','image','$date','edit_sales_finished','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','$product_details.batch_code','abs','finalize','There\x27s\x20a\x20error\x20in\x20this\x20transaction','warehouse_name','$customers_docs','$product_details.gross_price','</tbody>','French','Enclosed','OUTF-','barcode\x20Product\x20master','redirect','unit_QA','map','/upload/','RoomAssigned','/barcode_scanner_logs','$sale_product.floorlevel','expiry_date','Enabled','Return\x20Rooms','findById','../models/all_models','Hindi','random','$invoice','False','post','user','return_data','Email\x20sent\x20successfully','184UVzDNb','$warehouse_name','$product_details.uuid','match','product_list','Error\x20Occurs','<h5>','push','117615HpTCWC','prod_invoice','Portuguese\x20(BR)','Portuguese','flash','<!DOCTYPE\x20html>','invoice_init','$product_details.secondary_code','654845twDMYD','$product_details.storage','currency_placement','\x20Order\x20Number\x20:\x20','secondary_unit_QA','$sale_product.bay','/all_sales_finished/preview/','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</td>','$sale_product.bin','staff','errors','/invoice/:id','slice','\x20</h2>','batch_code','maxPerUnit_QA','$product_details.type_products','int','here','expiry_date_QA','$product_details.level','$product_details.floorlevel','logo','</h5>','gross_price','batch_code_QA','received_amount','</tr>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','customer','all_sales_barcode','Sales\x20Update\x20successfully','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','date_data','/picking_list/pdf/','18863860FyPsUb','split','8qKZAHm','barcode\x20user_id','sales_invoice','carton','sales','Return\x20Goods','all_sales_finished','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','language','product_details','<hr\x20class=\x22my-3\x22>','product_stock','getFullYear','/../public','foreach\x20newproduct','json','$product_details.unit','warehouse_id','express','secondary_unit','$product_details.bin','success','$product_details.secondary_unit','invoice','message','warehouse','toString','get','stock','back','Logo.png','$product_details.bay','/view/:id','</span>','secondary_code_QA','product_name_QA1','$product_details.primary_code','role','return_qty','length','createTransport','Finished\x20Goods','find','product_code','/barcode_scanner','<html><head><title></title>','product_name','id_transaction_from','getMonth','$product_details.product_name','add_sales_finished_logs','_id','$return_data','$product_details.product_cat','English\x20(US)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','log','2920735QDxFDv','render','primary_unit','OUT-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','then','getDate','prod_cat','</head><body>','$product_details.product_stock','secondary_code','maxProducts_QA'];a0_0x5b52=function(){return _0x381429;};return a0_0x5b52();}var a0_0x9b60ca=a0_0x1872;(function(_0x393e0b,_0x212b64){var _0x43e3eb=a0_0x1872,_0xc078ec=_0x393e0b();while(!![]){try{var _0xeaf70a=parseInt(_0x43e3eb(0x1ee))/0x1+parseInt(_0x43e3eb(0x193))/0x2*(-parseInt(_0x43e3eb(0x1e6))/0x3)+parseInt(_0x43e3eb(0x214))/0x4*(-parseInt(_0x43e3eb(0x24e))/0x5)+parseInt(_0x43e3eb(0x168))/0x6+-parseInt(_0x43e3eb(0x177))/0x7*(-parseInt(_0x43e3eb(0x1de))/0x8)+-parseInt(_0x43e3eb(0x165))/0x9+parseInt(_0x43e3eb(0x212))/0xa;if(_0xeaf70a===_0x212b64)break;else _0xc078ec['push'](_0xc078ec['shift']());}catch(_0x129758){_0xc078ec['push'](_0xc078ec['shift']());}}}(a0_0x5b52,0xb1a17));const express=require(a0_0x9b60ca(0x227)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x9b60ca(0x1d5)),auth=require(a0_0x9b60ca(0x18f)),nodemailer=require(a0_0x9b60ca(0x166)),users=require(a0_0x9b60ca(0x174));router[a0_0x9b60ca(0x230)](a0_0x9b60ca(0x15b),auth,async(_0x34825d,_0x2f1a82)=>{var _0x1f1f8a=a0_0x9b60ca;try{const {username:_0x545454,email:_0x46e50d,role:_0xdddfe8}=_0x34825d[_0x1f1f8a(0x1db)],_0x430bbc=_0x34825d['user'],_0x28c4a7=await profile[_0x1f1f8a(0x155)]({'email':_0x430bbc[_0x1f1f8a(0x1b0)]}),_0xbc4e0c=await master_shop['find']();let _0x2c504d;if(_0x430bbc[_0x1f1f8a(0x23a)]==_0x1f1f8a(0x1f8)){const _0x3c1ee8=await staff[_0x1f1f8a(0x155)]({'email':_0x430bbc[_0x1f1f8a(0x1b0)]});_0x2c504d=await sales_finished[_0x1f1f8a(0x160)]([{'$match':{'typeOfProducts':_0x1f1f8a(0x16a)}},{'$unwind':_0x1f1f8a(0x267)},{'$group':{'_id':_0x1f1f8a(0x25f),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x1f1f8a(0x18e)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x1f1f8a(0x267)},'note':{'$first':_0x1f1f8a(0x271)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x1f1f8a(0x1c3)},'total_saleproduct_quantity':{'$sum':_0x1f1f8a(0x195)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x1f1f8a(0x1f7)},'type':{'$addToSet':_0x1f1f8a(0x164)},'pallet':{'$addToSet':_0x1f1f8a(0x1d0)},'finalize':{'$first':_0x1f1f8a(0x156)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x2c504d=await sales_finished[_0x1f1f8a(0x160)]([{'$match':{'typeOfProducts':_0x1f1f8a(0x16a)}},{'$unwind':_0x1f1f8a(0x267)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1f1f8a(0x1d8)},'customers':{'$first':_0x1f1f8a(0x18e)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x1f1f8a(0x1df)},'sale_product':{'$push':_0x1f1f8a(0x267)},'note':{'$first':'$note'},'return_data':{'$first':_0x1f1f8a(0x249)},'customers_docs':{'$first':_0x1f1f8a(0x1c3)},'total_saleproduct_quantity':{'$sum':_0x1f1f8a(0x195)},'level':{'$addToSet':_0x1f1f8a(0x1f3)},'isle':{'$addToSet':_0x1f1f8a(0x1f7)},'type':{'$addToSet':_0x1f1f8a(0x164)},'pallet':{'$addToSet':_0x1f1f8a(0x1d0)},'finalize':{'$first':_0x1f1f8a(0x156)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0xbc4e0c[0x0][_0x1f1f8a(0x21d)]==_0x1f1f8a(0x24b)){var _0x45bf1e=users[_0x1f1f8a(0x274)];console[_0x1f1f8a(0x24d)](_0x45bf1e);}else{if(_0xbc4e0c[0x0][_0x1f1f8a(0x21d)]=='Hindi')var _0x45bf1e=users[_0x1f1f8a(0x1d6)];else{if(_0xbc4e0c[0x0][_0x1f1f8a(0x21d)]==_0x1f1f8a(0x188))var _0x45bf1e=users[_0x1f1f8a(0x188)];else{if(_0xbc4e0c[0x0]['language']==_0x1f1f8a(0x273))var _0x45bf1e=users['Spanish'];else{if(_0xbc4e0c[0x0][_0x1f1f8a(0x21d)]==_0x1f1f8a(0x1c6))var _0x45bf1e=users[_0x1f1f8a(0x1c6)];else{if(_0xbc4e0c[0x0]['language']==_0x1f1f8a(0x1e8))var _0x45bf1e=users[_0x1f1f8a(0x1e9)];else{if(_0xbc4e0c[0x0][_0x1f1f8a(0x21d)]==_0x1f1f8a(0x1a7))var _0x45bf1e=users[_0x1f1f8a(0x1a7)];else{if(_0xbc4e0c[0x0][_0x1f1f8a(0x21d)]==_0x1f1f8a(0x1a0))var _0x45bf1e=users[_0x1f1f8a(0x25d)];}}}}}}}_0x2f1a82['render'](_0x1f1f8a(0x21a),{'success':_0x34825d[_0x1f1f8a(0x1ea)](_0x1f1f8a(0x22a)),'errors':_0x34825d[_0x1f1f8a(0x1ea)](_0x1f1f8a(0x1f9)),'sales':_0x2c504d,'profile':_0x28c4a7,'role':_0x430bbc,'master_shop':_0xbc4e0c,'language':_0x45bf1e});}catch(_0x3e11a7){console['log'](_0x3e11a7);}}),router[a0_0x9b60ca(0x230)](a0_0x9b60ca(0x159),auth,async(_0xeca845,_0x119ddd)=>{var _0x1f2660=a0_0x9b60ca;try{const {username:_0x3889e8,email:_0x51b544,role:_0x19ab12}=_0xeca845[_0x1f2660(0x1db)],_0x2a0e5d=_0xeca845[_0x1f2660(0x1db)],_0x1a1158=await profile['findOne']({'email':_0x2a0e5d[_0x1f2660(0x1b0)]}),_0x2befdf=await master_shop['find']();let _0x323150;if(_0x2a0e5d[_0x1f2660(0x23a)]==_0x1f2660(0x1f8)){const _0x5dbb6c=await staff['findOne']({'email':_0x2a0e5d[_0x1f2660(0x1b0)]});_0x323150=await sales_finished[_0x1f2660(0x160)]([{'$match':{'typeOfProducts':_0x1f2660(0x194)}},{'$unwind':_0x1f2660(0x267)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1f2660(0x1d8)},'customers':{'$first':_0x1f2660(0x18e)},'date':{'$first':_0x1f2660(0x1bb)},'warehouse_name':{'$first':_0x1f2660(0x1df)},'sale_product':{'$push':_0x1f2660(0x267)},'note':{'$first':'$note'},'return_data':{'$first':_0x1f2660(0x249)},'customers_docs':{'$first':_0x1f2660(0x1c3)},'total_saleproduct_quantity':{'$sum':_0x1f2660(0x195)},'level':{'$addToSet':_0x1f2660(0x1f3)},'isle':{'$addToSet':_0x1f2660(0x1f7)},'type':{'$addToSet':_0x1f2660(0x164)},'pallet':{'$addToSet':_0x1f2660(0x1d0)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x323150=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x1f2660(0x194)}},{'$unwind':_0x1f2660(0x267)},{'$group':{'_id':_0x1f2660(0x25f),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x1f2660(0x18e)},'date':{'$first':_0x1f2660(0x1bb)},'warehouse_name':{'$first':_0x1f2660(0x1df)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x1f2660(0x271)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x1f2660(0x1c3)},'total_saleproduct_quantity':{'$sum':_0x1f2660(0x195)},'level':{'$addToSet':_0x1f2660(0x1f3)},'isle':{'$addToSet':_0x1f2660(0x1f7)},'type':{'$addToSet':_0x1f2660(0x164)},'pallet':{'$addToSet':_0x1f2660(0x1d0)},'finalize':{'$first':_0x1f2660(0x156)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x2befdf[0x0][_0x1f2660(0x21d)]==_0x1f2660(0x24b)){var _0xf26371=users[_0x1f2660(0x274)];console[_0x1f2660(0x24d)](_0xf26371);}else{if(_0x2befdf[0x0]['language']==_0x1f2660(0x1d6))var _0xf26371=users[_0x1f2660(0x1d6)];else{if(_0x2befdf[0x0][_0x1f2660(0x21d)]==_0x1f2660(0x188))var _0xf26371=users['German'];else{if(_0x2befdf[0x0]['language']==_0x1f2660(0x273))var _0xf26371=users[_0x1f2660(0x273)];else{if(_0x2befdf[0x0]['language']==_0x1f2660(0x1c6))var _0xf26371=users[_0x1f2660(0x1c6)];else{if(_0x2befdf[0x0][_0x1f2660(0x21d)]==_0x1f2660(0x1e8))var _0xf26371=users[_0x1f2660(0x1e9)];else{if(_0x2befdf[0x0]['language']==_0x1f2660(0x1a7))var _0xf26371=users[_0x1f2660(0x1a7)];else{if(_0x2befdf[0x0][_0x1f2660(0x21d)]=='Arabic\x20(ae)')var _0xf26371=users['Arabic'];}}}}}}}_0x119ddd[_0x1f2660(0x24f)](_0x1f2660(0x185),{'success':_0xeca845[_0x1f2660(0x1ea)](_0x1f2660(0x22a)),'errors':_0xeca845[_0x1f2660(0x1ea)](_0x1f2660(0x1f9)),'sales':_0x323150,'profile':_0x1a1158,'role':_0x2a0e5d,'master_shop':_0x2befdf,'language':_0xf26371});}catch(_0x104ee2){console[_0x1f2660(0x24d)](_0x104ee2);}});async function getRandom8DigitNumber(){var _0x28c34d=a0_0x9b60ca;const _0x281a8c=0x989680,_0x51a622=0x5f5e0ff,_0x48baa5=Math['floor'](Math[_0x28c34d(0x1d7)]()*(_0x51a622-_0x281a8c+0x1))+_0x281a8c;var _0x50a688;const _0x2f1e6e=await sales_finished['findOne']({'invoice':_0x28c34d(0x1c8)+_0x48baa5});return _0x2f1e6e&&_0x2f1e6e[_0x28c34d(0x23c)]>0x0?_0x50a688=_0x28c34d(0x1c8)+_0x48baa5:_0x50a688=_0x28c34d(0x1c8)+_0x48baa5,_0x50a688;}function a0_0x1872(_0x40d040,_0x51b572){var _0x5b5262=a0_0x5b52();return a0_0x1872=function(_0x187209,_0x847674){_0x187209=_0x187209-0x155;var _0x298348=_0x5b5262[_0x187209];return _0x298348;},a0_0x1872(_0x40d040,_0x51b572);}router['get'](a0_0x9b60ca(0x1ac),auth,async(_0x4c67bc,_0x90a6d2)=>{var _0x5eb972=a0_0x9b60ca;try{const {username:_0x58f8fa,email:_0x5503e8,role:_0x1972bc}=_0x4c67bc[_0x5eb972(0x1db)],_0x27e568=_0x4c67bc[_0x5eb972(0x1db)],_0x23d687=await profile[_0x5eb972(0x155)]({'email':_0x27e568[_0x5eb972(0x1b0)]}),_0x5db103=await master_shop['find'](),_0xe005fb=await customer[_0x5eb972(0x23f)]({});let _0x1f1717;if(_0x27e568[_0x5eb972(0x23a)]==_0x5eb972(0x1f8)){const _0x1502b0=await staff[_0x5eb972(0x155)]({'email':_0x27e568[_0x5eb972(0x1b0)]});_0x1f1717=await warehouse[_0x5eb972(0x160)]([{'$match':{'status':_0x5eb972(0x1d2),'name':_0x1502b0[_0x5eb972(0x22e)]}},{'$group':{'_id':_0x5eb972(0x18c),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x1f1717=await warehouse[_0x5eb972(0x160)]([{'$match':{'status':_0x5eb972(0x1d2)}},{'$group':{'_id':_0x5eb972(0x18c),'name':{'$first':_0x5eb972(0x18c)}}},{'$sort':{'name':0x1}}]);const _0x3f5af5=await product['find']({});var _0x3f355c=[_0x5eb972(0x162),_0x5eb972(0x1c7)];const _0x2d6412=await sales_finished[_0x5eb972(0x23f)]({}),_0x2e4567=_0x2d6412[_0x5eb972(0x23c)]+0x1,_0x4b6b15=_0x5eb972(0x1c8)+_0x2e4567[_0x5eb972(0x22f)]()[_0x5eb972(0x26e)](0x5,'0');if(_0x5db103[0x0]['language']==_0x5eb972(0x24b)){var _0x1bcb41=users[_0x5eb972(0x274)];console[_0x5eb972(0x24d)](_0x1bcb41);}else{if(_0x5db103[0x0][_0x5eb972(0x21d)]==_0x5eb972(0x1d6))var _0x1bcb41=users[_0x5eb972(0x1d6)];else{if(_0x5db103[0x0]['language']==_0x5eb972(0x188))var _0x1bcb41=users['German'];else{if(_0x5db103[0x0]['language']==_0x5eb972(0x273))var _0x1bcb41=users[_0x5eb972(0x273)];else{if(_0x5db103[0x0][_0x5eb972(0x21d)]==_0x5eb972(0x1c6))var _0x1bcb41=users[_0x5eb972(0x1c6)];else{if(_0x5db103[0x0]['language']==_0x5eb972(0x1e8))var _0x1bcb41=users[_0x5eb972(0x1e9)];else{if(_0x5db103[0x0][_0x5eb972(0x21d)]==_0x5eb972(0x1a7))var _0x1bcb41=users[_0x5eb972(0x1a7)];else{if(_0x5db103[0x0]['language']==_0x5eb972(0x1a0))var _0x1bcb41=users['Arabic'];}}}}}}}const _0x422113=getRandom8DigitNumber();_0x422113[_0x5eb972(0x253)](_0x40e658=>{var _0x227222=_0x5eb972;_0x90a6d2[_0x227222(0x24f)](_0x227222(0x268),{'success':_0x4c67bc[_0x227222(0x1ea)]('success'),'errors':_0x4c67bc['flash'](_0x227222(0x1f9)),'role':_0x27e568,'profile':_0x23d687,'customer':_0xe005fb,'warehouse':_0x1f1717,'product':_0x3f5af5,'invoice':_0x40e658,'master_shop':_0x5db103,'language':_0x1bcb41,'rooms_data':_0x3f355c});})['catch'](_0x2d0288=>{var _0xc74db4=_0x5eb972;_0x4c67bc['flash'](_0xc74db4(0x1f9),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x90a6d2[_0xc74db4(0x1ca)](_0xc74db4(0x182));});}catch(_0x417887){console[_0x5eb972(0x24d)](_0x417887);}}),router['get']('/view/add_sales_logs',auth,async(_0x3fd1c6,_0x301b7f)=>{var _0x466ce9=a0_0x9b60ca;try{const {username:_0x716d55,email:_0xfbbf52,role:_0x3ae451}=_0x3fd1c6[_0x466ce9(0x1db)],_0x2d4cff=_0x3fd1c6[_0x466ce9(0x1db)],_0x31dd23=await profile['findOne']({'email':_0x2d4cff['email']}),_0x43fdf9=await master_shop[_0x466ce9(0x23f)](),_0x366a4b=await customer['find']({});let _0x1b0055;if(_0x2d4cff[_0x466ce9(0x23a)]==_0x466ce9(0x1f8)){const _0x3fd28e=await staff[_0x466ce9(0x155)]({'email':_0x2d4cff[_0x466ce9(0x1b0)]});_0x1b0055=await warehouse[_0x466ce9(0x160)]([{'$match':{'status':_0x466ce9(0x1d2),'name':_0x3fd28e[_0x466ce9(0x22e)]}},{'$group':{'_id':_0x466ce9(0x18c),'name':{'$first':_0x466ce9(0x18c)}}},{'$sort':{'name':0x1}}]);}else _0x1b0055=await warehouse[_0x466ce9(0x160)]([{'$match':{'status':_0x466ce9(0x1d2)}},{'$group':{'_id':_0x466ce9(0x18c),'name':{'$first':_0x466ce9(0x18c)}}},{'$sort':{'name':0x1}}]);const _0x517a10=await product[_0x466ce9(0x23f)]({});var _0x12778a=['Ambient',_0x466ce9(0x1c7)];const _0x3ae2c2=await sales_finished[_0x466ce9(0x23f)]({}),_0x29fbb7=_0x3ae2c2[_0x466ce9(0x23c)]+0x1,_0x50235e=_0x466ce9(0x1c8)+_0x29fbb7['toString']()[_0x466ce9(0x26e)](0x5,'0');if(_0x43fdf9[0x0]['language']==_0x466ce9(0x24b)){var _0x290fc3=users[_0x466ce9(0x274)];console['log'](_0x290fc3);}else{if(_0x43fdf9[0x0][_0x466ce9(0x21d)]==_0x466ce9(0x1d6))var _0x290fc3=users[_0x466ce9(0x1d6)];else{if(_0x43fdf9[0x0][_0x466ce9(0x21d)]==_0x466ce9(0x188))var _0x290fc3=users[_0x466ce9(0x188)];else{if(_0x43fdf9[0x0][_0x466ce9(0x21d)]==_0x466ce9(0x273))var _0x290fc3=users[_0x466ce9(0x273)];else{if(_0x43fdf9[0x0][_0x466ce9(0x21d)]==_0x466ce9(0x1c6))var _0x290fc3=users[_0x466ce9(0x1c6)];else{if(_0x43fdf9[0x0][_0x466ce9(0x21d)]=='Portuguese\x20(BR)')var _0x290fc3=users[_0x466ce9(0x1e9)];else{if(_0x43fdf9[0x0][_0x466ce9(0x21d)]=='Chinese')var _0x290fc3=users['Chinese'];else{if(_0x43fdf9[0x0][_0x466ce9(0x21d)]=='Arabic\x20(ae)')var _0x290fc3=users[_0x466ce9(0x25d)];}}}}}}}const _0x4a81a7=getRandom8DigitNumber();_0x4a81a7[_0x466ce9(0x253)](_0x17001b=>{var _0xa8b1c9=_0x466ce9;_0x301b7f['render'](_0xa8b1c9(0x247),{'success':_0x3fd1c6['flash'](_0xa8b1c9(0x22a)),'errors':_0x3fd1c6['flash']('errors'),'role':_0x2d4cff,'profile':_0x31dd23,'customer':_0x366a4b,'warehouse':_0x1b0055,'product':_0x517a10,'invoice':_0x17001b,'master_shop':_0x43fdf9,'language':_0x290fc3,'rooms_data':_0x12778a});})['catch'](_0x37fca9=>{var _0x443bb7=_0x466ce9;_0x3fd1c6[_0x443bb7(0x1ea)](_0x443bb7(0x1f9),_0x443bb7(0x1c1)),_0x301b7f[_0x443bb7(0x1ca)]('/all_sales_finished/view');});}catch(_0x36d3e2){console[_0x466ce9(0x24d)](_0x36d3e2);}}),router[a0_0x9b60ca(0x1da)](a0_0x9b60ca(0x266),auth,async(_0x49d3b7,_0x4d8ffb)=>{var _0x2c546d=a0_0x9b60ca;try{const {invoice:_0xb0a435,date:_0x2f2cb0,warehouse_name:_0x295bfd,product_name:_0xfd2c9b,note:_0x2420e0,room:_0x529165,primary_code:_0x8a1a2b,secondary_code:_0xa53644,prod_code:_0x37a8ee,SCRN:_0x36b03c,ReqBy:_0x3d6a46,dateofreq:_0x57d873,PO_number:_0x377e90,typeservicesData:_0x1e6a12,typevehicle:_0x22d8cd,destination:_0x2b8743,deliverydate:_0x20f201,driver:_0x422a8f,plate:_0x1b3c83,van:_0x2d4cef,DRSI:_0x4dd622,TSU:_0x520fee,TFU:_0x1e8ee9,mode_transpo:_0x1f3be8,name_driver:_0x406130,type_of_products:_0x4f0b88}=_0x49d3b7[_0x2c546d(0x1b3)];if(typeof _0xfd2c9b==_0x2c546d(0x26b))var _0x81baaa=[_0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x243)]],_0x3a823c=[_0x49d3b7[_0x2c546d(0x1b3)]['stock']],_0x2a9bd1=[_0x49d3b7[_0x2c546d(0x1b3)]['carton']],_0x15fdf9=[_0x49d3b7[_0x2c546d(0x1b3)]['primary_code']],_0x36ddf7=[_0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x258)]],_0x3e56fb=[_0x49d3b7['body'][_0x2c546d(0x25a)]],_0x174563=[_0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x196)]],_0x298ac9=[_0x49d3b7['body'][_0x2c546d(0x250)]],_0x2fad1a=[_0x49d3b7['body'][_0x2c546d(0x228)]],_0x37a6cf=[_0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x1fd)]],_0xbf7645=[_0x49d3b7[_0x2c546d(0x1b3)]['expiry_date']],_0x2bb87a=[_0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x16c)]],_0x2df615=[_0x49d3b7[_0x2c546d(0x1b3)]['max_per_unit']],_0x21a142=[_0x49d3b7[_0x2c546d(0x1b3)]['prod_cat']],_0x2e22b9=[_0x49d3b7['body'][_0x2c546d(0x1ce)]],_0x30334e=[_0x49d3b7['body']['prod_invoice']],_0x40ca2b=[_0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x244)]],_0x506925=[_0x49d3b7['body'][_0x2c546d(0x190)]],_0x5c8b02=[_0x49d3b7['body']['gross_price']];else var _0x81baaa=[..._0x49d3b7['body'][_0x2c546d(0x243)]],_0x3a823c=[..._0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x231)]],_0x2a9bd1=[..._0x49d3b7['body']['carton']],_0x15fdf9=[..._0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x269)]],_0x36ddf7=[..._0x49d3b7['body'][_0x2c546d(0x258)]],_0x3e56fb=[..._0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x25a)]],_0x174563=[..._0x49d3b7[_0x2c546d(0x1b3)]['level2']],_0x298ac9=[..._0x49d3b7['body'][_0x2c546d(0x250)]],_0x2fad1a=[..._0x49d3b7['body'][_0x2c546d(0x228)]],_0x37a6cf=[..._0x49d3b7['body'][_0x2c546d(0x1fd)]],_0xbf7645=[..._0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x1d1)]],_0x2bb87a=[..._0x49d3b7[_0x2c546d(0x1b3)]['product_date']],_0x2df615=[..._0x49d3b7['body'][_0x2c546d(0x15e)]],_0x21a142=[..._0x49d3b7[_0x2c546d(0x1b3)]['prod_cat']],_0x2e22b9=[..._0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x1ce)]],_0x30334e=[..._0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x1e7)]],_0x40ca2b=[..._0x49d3b7['body'][_0x2c546d(0x244)]],_0x506925=[..._0x49d3b7['body'][_0x2c546d(0x190)]],_0x5c8b02=[..._0x49d3b7[_0x2c546d(0x1b3)]['gross_price']];const _0x575419=_0x81baaa[_0x2c546d(0x1cc)](_0x5dfc99=>{return _0x5dfc99={'product_name':_0x5dfc99};});_0x3a823c[_0x2c546d(0x178)]((_0x55517b,_0x11fd6f)=>{var _0x52a308=_0x2c546d;_0x575419[_0x11fd6f][_0x52a308(0x231)]=_0x55517b;}),_0x2a9bd1[_0x2c546d(0x178)]((_0x454f37,_0x582217)=>{_0x575419[_0x582217]['quantity']=Math['abs'](_0x454f37);}),_0x81baaa[_0x2c546d(0x178)]((_0x39b640,_0x3c9fa8)=>{var _0x3934d8=_0x2c546d;_0x575419[_0x3c9fa8]['agent_id']=_0x49d3b7[_0x3934d8(0x1b3)][_0x3934d8(0x218)];}),_0x5c8b02[_0x2c546d(0x178)]((_0x502c7e,_0x476734)=>{var _0x512b35=_0x2c546d;_0x575419[_0x476734][_0x512b35(0x207)]=_0x502c7e;}),_0x506925[_0x2c546d(0x178)]((_0x1e40fd,_0x33ccca)=>{var _0x3f153a=_0x2c546d;_0x575419[_0x33ccca][_0x3f153a(0x190)]=_0x1e40fd;}),_0x40ca2b[_0x2c546d(0x178)]((_0xbf80cf,_0x18588d)=>{_0x575419[_0x18588d]['id_transaction_from']=_0xbf80cf;}),_0x15fdf9[_0x2c546d(0x178)]((_0x24f6c6,_0x40f590)=>{var _0x1795fa=_0x2c546d;_0x575419[_0x40f590][_0x1795fa(0x269)]=_0x24f6c6;}),_0x36ddf7[_0x2c546d(0x178)]((_0x3a6119,_0x903951)=>{var _0x2b4c3b=_0x2c546d;_0x575419[_0x903951][_0x2b4c3b(0x258)]=_0x3a6119;}),_0x3e56fb['forEach']((_0x45bdbd,_0x463dad)=>{var _0x7314b7=_0x2c546d;_0x575419[_0x463dad][_0x7314b7(0x240)]=_0x45bdbd;}),_0x174563[_0x2c546d(0x178)]((_0x1a7a6a,_0x249ccc)=>{var _0x4a550a=_0x2c546d,_0x4b656c=_0x1a7a6a[_0x4a550a(0x1e1)](/[A-Za-z]+/)[0x0],_0x9698e8=parseInt(_0x1a7a6a[_0x4a550a(0x1e1)](/\d+/)[0x0]);_0x575419[_0x249ccc]['bay']=_0x9698e8,_0x575419[_0x249ccc]['level']=_0x4b656c;}),_0x298ac9[_0x2c546d(0x178)]((_0x3d9157,_0x57b73a)=>{var _0x3453d2=_0x2c546d;_0x575419[_0x57b73a][_0x3453d2(0x163)]=_0x3d9157;}),_0x2fad1a[_0x2c546d(0x178)]((_0x475df6,_0x4a28a3)=>{var _0xea5008=_0x2c546d;_0x575419[_0x4a28a3][_0xea5008(0x228)]=_0x475df6;}),_0x37a6cf[_0x2c546d(0x178)]((_0x490541,_0x1d1ca4)=>{_0x575419[_0x1d1ca4]['batch_code']=_0x490541;}),_0xbf7645[_0x2c546d(0x178)]((_0x45aae5,_0x538b92)=>{var _0x5a3ff3=_0x2c546d;_0x575419[_0x538b92][_0x5a3ff3(0x1d1)]=_0x45aae5;}),_0x2bb87a[_0x2c546d(0x178)]((_0x499f09,_0xb8a230)=>{var _0x257bb9=_0x2c546d;_0x575419[_0xb8a230][_0x257bb9(0x262)]=_0x499f09;}),_0x2df615[_0x2c546d(0x178)]((_0x50a976,_0x32ad11)=>{var _0x4c1362=_0x2c546d;_0x575419[_0x32ad11][_0x4c1362(0x264)]=_0x50a976;}),_0x21a142['forEach']((_0x3ee8d7,_0x20d45e)=>{var _0x160b7f=_0x2c546d;_0x575419[_0x20d45e][_0x160b7f(0x255)]=_0x3ee8d7;}),_0x2e22b9['forEach']((_0x21e4ab,_0x3d33da)=>{var _0x3fc5ea=_0x2c546d;_0x575419[_0x3d33da][_0x3fc5ea(0x16f)]=_0x21e4ab;}),_0x30334e['forEach']((_0x4c1042,_0xffa7d6)=>{var _0x1e67d1=_0x2c546d;_0x575419[_0xffa7d6][_0x1e67d1(0x22c)]=_0x4c1042,_0x575419[_0xffa7d6]['date_data']=_0x2f2cb0;});const _0x301884=new sales_logs();await _0x301884[_0x2c546d(0x17f)](),_0x30334e[_0x2c546d(0x178)]((_0x1ac5ac,_0x35e672)=>{var _0xf8830b=_0x2c546d;_0x575419[_0x35e672][_0xf8830b(0x26c)]='LOG-OUT-'+_0x301884[_0xf8830b(0x1ec)][_0xf8830b(0x22f)]()[_0xf8830b(0x26e)](0x8,'0');});var _0x29f508=0x0;_0x575419[_0x2c546d(0x178)](_0x1a3c98=>{var _0x2c2063=_0x2c546d;parseFloat(_0x1a3c98[_0x2c2063(0x231)])<parseFloat(_0x1a3c98[_0x2c2063(0x17b)])&&parseFloat(_0x1a3c98[_0x2c2063(0x17b)])>parseFloat(_0x1a3c98[_0x2c2063(0x231)])&&(console[_0x2c2063(0x24d)](_0x1a3c98[_0x2c2063(0x231)]+_0x2c2063(0x180)+_0x1a3c98[_0x2c2063(0x17b)]),_0x29f508++);});if(_0x29f508!=0x0)return _0x49d3b7[_0x2c546d(0x1ea)](_0x2c546d(0x1f9),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x4d8ffb[_0x2c546d(0x1ca)]('back');const _0x5a8927=_0x575419[_0x2c546d(0x191)](_0x2ce9e1=>_0x2ce9e1['quantity']!=='0'&&_0x2ce9e1['quantity']!==''),_0x52e99b=new sales_finished({'invoice':'LOG-OUT-'+_0x301884['invoice_init'][_0x2c546d(0x22f)]()[_0x2c546d(0x26e)](0x8,'0'),'sales_data':_0x49d3b7[_0x2c546d(0x1b3)]['sales'],'customer':_0x49d3b7[_0x2c546d(0x1b3)][_0x2c546d(0x20c)],'date':_0x2f2cb0,'warehouse_name':_0x295bfd,'sale_product':_0x5a8927,'note':_0x2420e0,'room':_0x529165,'primary_code':_0x8a1a2b,'secondary_code':_0xa53644,'prod_code':_0x37a8ee,'SCRN':_0x36b03c,'finalize':_0x2c546d(0x1d9),'mode_transpo':_0x1f3be8,'name_driver':_0x406130,'ReqBy':_0x3d6a46,'dateofreq':_0x57d873,'PO_number':_0x377e90,'typeservicesData':_0x1e6a12,'typevehicle':_0x22d8cd,'destination':_0x2b8743,'deliverydate':_0x20f201,'driver':_0x422a8f,'plate':_0x1b3c83,'van':_0x2d4cef,'DRSI':_0x4dd622,'TSU':_0x520fee,'TFU':_0x1e8ee9,'typeOfProducts':_0x4f0b88}),_0x58ecdf=await _0x52e99b['save'](),_0x3beb52=await sales_finished[_0x2c546d(0x155)]({'invoice':_0xb0a435});_0x49d3b7[_0x2c546d(0x1ea)](_0x2c546d(0x22a),_0x2c546d(0x275)),_0x4d8ffb['redirect'](_0x2c546d(0x1f4)+_0x58ecdf[_0x2c546d(0x248)]);}catch(_0x274558){console[_0x2c546d(0x24d)](_0x274558);}}),router[a0_0x9b60ca(0x230)](a0_0x9b60ca(0x161),auth,async(_0x1555e7,_0x3a9709)=>{var _0x3f8a45=a0_0x9b60ca;try{const _0x28f847=_0x1555e7[_0x3f8a45(0x1a3)]['id'];console[_0x3f8a45(0x24d)](_0x28f847);const _0x4640aa=await product[_0x3f8a45(0x23f)](),_0x43a3ca=await purchases['aggregate']([{'$match':{'warehouse_name':_0x28f847}},{'$unwind':_0x3f8a45(0x17d)},{'$group':{'_id':_0x3f8a45(0x181)}}]);console[_0x3f8a45(0x24d)]('purchases_data',_0x43a3ca),_0x3a9709[_0x3f8a45(0x26f)](0xc8)['json']({'purchases_data':_0x43a3ca,'product_data':_0x4640aa});}catch(_0x537560){console[_0x3f8a45(0x24d)](_0x537560);}}),router[a0_0x9b60ca(0x1da)](a0_0x9b60ca(0x19c),auth,async(_0x4fba6a,_0x3f3080)=>{var _0x2c1bbb=a0_0x9b60ca;try{const {warehouse_data:_0x536853,product_data:_0x37cab6}=_0x4fba6a[_0x2c1bbb(0x1b3)];console['log'](_0x4fba6a[_0x2c1bbb(0x1b3)]['product_data']);;const _0xa8ac8d=await master_shop['find']();console[_0x2c1bbb(0x24d)]('master',_0xa8ac8d);const _0x68702f=await product[_0x2c1bbb(0x155)]({'name':_0x37cab6});console[_0x2c1bbb(0x24d)](_0x2c1bbb(0x1b4),_0x68702f);const _0x13413c=await warehouse[_0x2c1bbb(0x160)]([{'$match':{'name':_0x536853}},{'$unwind':_0x2c1bbb(0x17a)},{'$match':{'product_details.product_name':_0x37cab6}},{'$group':{'_id':_0x2c1bbb(0x246),'product_stock':{'$first':_0x2c1bbb(0x257)}}}]);console[_0x2c1bbb(0x24d)]('stock_data',_0x13413c),_0x3f3080[_0x2c1bbb(0x26f)](0xc8)[_0x2c1bbb(0x224)]({'master':_0xa8ac8d,'new_product':_0x68702f,'stock_data':_0x13413c});}catch(_0x1fec1f){console[_0x2c1bbb(0x24d)](_0x1fec1f);}}),router['post']('/view/add_sales',auth,async(_0x1c24e9,_0x8a8910)=>{var _0x42dc43=a0_0x9b60ca;try{const {invoice:_0x232da8,date:_0x30c9da,warehouse_name:_0x2f0d9d,product_name:_0x1ac7eb,note:_0x3c9317,room:_0x17b734,primary_code:_0x1c23ae,secondary_code:_0x4510e4,prod_code:_0x278911,SCRN:_0x3cc5d0,ReqBy:_0x8ae8d6,dateofreq:_0xdf77ee,PO_number:_0x2740bf,typeservicesData:_0x45cd9b,typevehicle:_0x4b526f,destination:_0x16e3fd,deliverydate:_0x6a191c,driver:_0x4e2835,plate:_0x1de010,van:_0x414540,DRSI:_0x2cabd8,TSU:_0x4d43a6,TFU:_0x11f6d1,mode_transpo:_0x114302,name_driver:_0x49ee6f,pull_out_date:_0x43b950,actual_delivery_date:_0x125c64}=_0x1c24e9[_0x42dc43(0x1b3)];if(typeof _0x1ac7eb=='string')var _0xda7ca=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x243)]],_0x5d3390=[_0x1c24e9[_0x42dc43(0x1b3)]['stock']],_0x11ef1f=[_0x1c24e9[_0x42dc43(0x1b3)]['carton']],_0x5caf53=[_0x1c24e9['body'][_0x42dc43(0x269)]],_0x433279=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x258)]],_0x5dab43=[_0x1c24e9['body'][_0x42dc43(0x25a)]],_0x3cc072=[_0x1c24e9[_0x42dc43(0x1b3)]['level2']],_0xec3e23=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x250)]],_0x37b129=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x228)]],_0x30c738=[_0x1c24e9['body']['batch_code']],_0x3f8dab=[_0x1c24e9['body']['expiry_date']],_0x4c0cba=[_0x1c24e9['body'][_0x42dc43(0x16c)]],_0x186acd=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x15e)]],_0x3dcf71=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x255)]],_0x323e69=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x1ce)]],_0x446a35=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x1e7)]],_0x3fc657=[_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x244)]],_0xe02bd6=[_0x1c24e9[_0x42dc43(0x1b3)]['uuid']],_0x3e9797=[_0x1c24e9['body'][_0x42dc43(0x207)]];else var _0xda7ca=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x243)]],_0x5d3390=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x231)]],_0x11ef1f=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x217)]],_0x5caf53=[..._0x1c24e9['body'][_0x42dc43(0x269)]],_0x433279=[..._0x1c24e9[_0x42dc43(0x1b3)]['secondary_code']],_0x5dab43=[..._0x1c24e9['body']['prod_code']],_0x3cc072=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x196)]],_0xec3e23=[..._0x1c24e9['body'][_0x42dc43(0x250)]],_0x37b129=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x228)]],_0x30c738=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x1fd)]],_0x3f8dab=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x1d1)]],_0x4c0cba=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x16c)]],_0x186acd=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x15e)]],_0x3dcf71=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x255)]],_0x323e69=[..._0x1c24e9['body'][_0x42dc43(0x1ce)]],_0x446a35=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x1e7)]],_0x3fc657=[..._0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x244)]],_0xe02bd6=[..._0x1c24e9[_0x42dc43(0x1b3)]['uuid']],_0x3e9797=[..._0x1c24e9[_0x42dc43(0x1b3)]['gross_price']];const _0x34438b=_0xda7ca[_0x42dc43(0x1cc)](_0x13b926=>{return _0x13b926={'product_name':_0x13b926};});_0x5d3390[_0x42dc43(0x178)]((_0x449653,_0x208076)=>{var _0xebb4dd=_0x42dc43;_0x34438b[_0x208076][_0xebb4dd(0x231)]=_0x449653;}),_0x11ef1f['forEach']((_0x1e1825,_0x5cc233)=>{var _0x36e4c5=_0x42dc43;_0x34438b[_0x5cc233][_0x36e4c5(0x17b)]=Math[_0x36e4c5(0x1bf)](_0x1e1825);}),_0xda7ca['forEach']((_0x5ad557,_0x756341)=>{var _0x37ebdb=_0x42dc43;_0x34438b[_0x756341][_0x37ebdb(0x15f)]=_0x1c24e9['body'][_0x37ebdb(0x218)];}),_0x3e9797[_0x42dc43(0x178)]((_0x54973c,_0x475c43)=>{var _0x1feec2=_0x42dc43;_0x34438b[_0x475c43][_0x1feec2(0x207)]=_0x54973c;}),_0xe02bd6[_0x42dc43(0x178)]((_0x57d629,_0x571c11)=>{var _0xe3bbf6=_0x42dc43;_0x34438b[_0x571c11][_0xe3bbf6(0x190)]=_0x57d629;}),_0x3fc657[_0x42dc43(0x178)]((_0x8aff8f,_0x412163)=>{var _0x173e50=_0x42dc43;_0x34438b[_0x412163][_0x173e50(0x244)]=_0x8aff8f;}),_0x5caf53[_0x42dc43(0x178)]((_0x20e361,_0x220639)=>{var _0x10eb6d=_0x42dc43;_0x34438b[_0x220639][_0x10eb6d(0x269)]=_0x20e361;}),_0x433279[_0x42dc43(0x178)]((_0x3eb343,_0x3311dc)=>{var _0x2f4508=_0x42dc43;_0x34438b[_0x3311dc][_0x2f4508(0x258)]=_0x3eb343;}),_0x5dab43[_0x42dc43(0x178)]((_0x200796,_0x24927d)=>{_0x34438b[_0x24927d]['product_code']=_0x200796;}),_0x3cc072[_0x42dc43(0x178)]((_0x345b5c,_0x5781c6)=>{var _0x362752=_0x42dc43,_0x1340df=_0x345b5c[_0x362752(0x1e1)](/[A-Za-z]+/)[0x0],_0x163011=parseInt(_0x345b5c[_0x362752(0x1e1)](/\d+/)[0x0]);_0x34438b[_0x5781c6]['bay']=_0x163011,_0x34438b[_0x5781c6][_0x362752(0x16d)]=_0x1340df;}),_0xec3e23[_0x42dc43(0x178)]((_0x16c234,_0x57a1e8)=>{_0x34438b[_0x57a1e8]['unit']=_0x16c234;}),_0x37b129[_0x42dc43(0x178)]((_0x208214,_0x4e2867)=>{var _0x3c3781=_0x42dc43;_0x34438b[_0x4e2867][_0x3c3781(0x228)]=_0x208214;}),_0x30c738[_0x42dc43(0x178)]((_0x43e165,_0x55d61c)=>{_0x34438b[_0x55d61c]['batch_code']=_0x43e165;}),_0x3f8dab[_0x42dc43(0x178)]((_0x494507,_0x461d5b)=>{var _0x4bd46d=_0x42dc43;_0x34438b[_0x461d5b][_0x4bd46d(0x1d1)]=_0x494507;}),_0x4c0cba[_0x42dc43(0x178)]((_0x1fefff,_0x9d811f)=>{_0x34438b[_0x9d811f]['production_date']=_0x1fefff;}),_0x186acd[_0x42dc43(0x178)]((_0x4dd70f,_0x45b568)=>{var _0x576662=_0x42dc43;_0x34438b[_0x45b568][_0x576662(0x264)]=_0x4dd70f;}),_0x3dcf71[_0x42dc43(0x178)]((_0x3989cb,_0x1239b4)=>{_0x34438b[_0x1239b4]['prod_cat']=_0x3989cb;}),_0x323e69[_0x42dc43(0x178)]((_0x4be866,_0x473f74)=>{var _0x1993f6=_0x42dc43;_0x34438b[_0x473f74][_0x1993f6(0x16f)]=_0x4be866;}),_0x446a35['forEach']((_0x23a3ef,_0x364e74)=>{var _0x5789d5=_0x42dc43;_0x34438b[_0x364e74][_0x5789d5(0x22c)]=_0x23a3ef,_0x34438b[_0x364e74][_0x5789d5(0x210)]=_0x30c9da;});const _0x3e5a07=new invoice_for_outgoing();await _0x3e5a07[_0x42dc43(0x17f)](),_0x446a35[_0x42dc43(0x178)]((_0x4532e0,_0x3e761b)=>{var _0x1d7e82=_0x42dc43;_0x34438b[_0x3e761b][_0x1d7e82(0x26c)]=_0x1d7e82(0x251)+_0x3e5a07['invoice_init'][_0x1d7e82(0x22f)]()[_0x1d7e82(0x26e)](0x8,'0');});var _0x5b74ca=0x0;_0x34438b[_0x42dc43(0x178)](_0x6d573b=>{var _0x42678=_0x42dc43;parseFloat(_0x6d573b[_0x42678(0x231)])<parseFloat(_0x6d573b[_0x42678(0x17b)])&&parseFloat(_0x6d573b[_0x42678(0x17b)])>parseFloat(_0x6d573b['stock'])&&(console[_0x42678(0x24d)](_0x6d573b[_0x42678(0x231)]+'\x20<>\x20'+_0x6d573b['quantity']),_0x5b74ca++);});if(_0x5b74ca!=0x0)return _0x1c24e9[_0x42dc43(0x1ea)](_0x42dc43(0x1f9),_0x42dc43(0x1bd)),_0x8a8910['redirect'](_0x42dc43(0x232));const _0x2fce05=_0x34438b[_0x42dc43(0x191)](_0x4c5fb0=>_0x4c5fb0[_0x42dc43(0x17b)]!=='0'&&_0x4c5fb0[_0x42dc43(0x17b)]!==''),_0x269a27=new sales_finished({'invoice':'OUT-'+_0x3e5a07[_0x42dc43(0x1ec)][_0x42dc43(0x22f)]()[_0x42dc43(0x26e)](0x8,'0'),'sales_data':_0x1c24e9[_0x42dc43(0x1b3)][_0x42dc43(0x218)],'customer':_0x1c24e9['body'][_0x42dc43(0x20c)],'date':_0x30c9da,'warehouse_name':_0x2f0d9d,'sale_product':_0x2fce05,'note':_0x3c9317,'room':_0x17b734,'primary_code':_0x1c23ae,'secondary_code':_0x4510e4,'prod_code':_0x278911,'SCRN':_0x3cc5d0,'finalize':_0x42dc43(0x1d9),'mode_transpo':_0x114302,'name_driver':_0x49ee6f,'ReqBy':_0x8ae8d6,'dateofreq':_0xdf77ee,'PO_number':_0x2740bf,'typeservicesData':_0x45cd9b,'typevehicle':_0x4b526f,'destination':_0x16e3fd,'deliverydate':_0x6a191c,'driver':_0x4e2835,'plate':_0x1de010,'van':_0x414540,'DRSI':_0x2cabd8,'TSU':_0x4d43a6,'TFU':_0x11f6d1,'pullout_date':_0x43b950,'actualdelivery_date':_0x125c64,'typeOfProducts':'own'}),_0x5e979e=await _0x269a27['save'](),_0x41519d=await sales_finished[_0x42dc43(0x155)]({'invoice':_0x232da8});_0x1c24e9[_0x42dc43(0x1ea)](_0x42dc43(0x22a),_0x42dc43(0x275)),_0x8a8910[_0x42dc43(0x1ca)](_0x42dc43(0x1f4)+_0x5e979e[_0x42dc43(0x248)]);}catch(_0x39fa13){console[_0x42dc43(0x24d)](_0x39fa13);}}),router[a0_0x9b60ca(0x230)](a0_0x9b60ca(0x15c),auth,async(_0x40b9ea,_0x5c8f71)=>{var _0x4c81cc=a0_0x9b60ca;try{const {username:_0x4728dd,email:_0x26aef8,role:_0x5b9955}=_0x40b9ea['user'],_0x5601dd=_0x40b9ea['user'],_0x531e88=await profile[_0x4c81cc(0x155)]({'email':_0x5601dd[_0x4c81cc(0x1b0)]}),_0x46d371=await master_shop['find'](),_0x2cd927=_0x40b9ea[_0x4c81cc(0x1a3)]['id'],_0x293572=await sales_finished[_0x4c81cc(0x1d4)](_0x2cd927),_0x28e9d2=await warehouse[_0x4c81cc(0x160)]([{'$match':{'name':_0x293572['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4c81cc(0x171),'name':{'$first':_0x4c81cc(0x246)},'product_stock':{'$first':_0x4c81cc(0x257)},'bay':{'$first':_0x4c81cc(0x234)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4c81cc(0x1ad)},'floorlevel':{'$first':_0x4c81cc(0x204)},'primary_code':{'$first':_0x4c81cc(0x239)},'secondary_code':{'$first':_0x4c81cc(0x1ed)},'product_code':{'$first':_0x4c81cc(0x1af)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4c81cc(0x1a1)},'expiry_date':{'$first':_0x4c81cc(0x187)},'production_date':{'$first':_0x4c81cc(0x26d)},'batch_code':{'$first':_0x4c81cc(0x1be)},'room':{'$first':_0x4c81cc(0x1b7)},'room_data':{'$first':_0x4c81cc(0x25e)}}}]),_0x1663b0=await customer[_0x4c81cc(0x23f)]({});let _0x517a60;if(_0x5601dd[_0x4c81cc(0x23a)]==_0x4c81cc(0x1f8)){const _0x11f138=await staff[_0x4c81cc(0x155)]({'email':_0x5601dd['email']});_0x517a60=await warehouse[_0x4c81cc(0x160)]([{'$match':{'status':_0x4c81cc(0x1d2),'name':_0x11f138[_0x4c81cc(0x22e)]}},{'$group':{'_id':'$name','name':{'$first':_0x4c81cc(0x18c)}}}]);}else _0x517a60=await warehouse[_0x4c81cc(0x160)]([{'$match':{'status':_0x4c81cc(0x1d2)}},{'$group':{'_id':_0x4c81cc(0x18c),'name':{'$first':'$name'}}}]);const _0x48dc80=await product[_0x4c81cc(0x23f)]({});if(_0x46d371[0x0][_0x4c81cc(0x21d)]=='English\x20(US)'){var _0x4427f6=users[_0x4c81cc(0x274)];console[_0x4c81cc(0x24d)](_0x4427f6);}else{if(_0x46d371[0x0]['language']==_0x4c81cc(0x1d6))var _0x4427f6=users[_0x4c81cc(0x1d6)];else{if(_0x46d371[0x0][_0x4c81cc(0x21d)]=='German')var _0x4427f6=users['German'];else{if(_0x46d371[0x0][_0x4c81cc(0x21d)]==_0x4c81cc(0x273))var _0x4427f6=users[_0x4c81cc(0x273)];else{if(_0x46d371[0x0]['language']==_0x4c81cc(0x1c6))var _0x4427f6=users[_0x4c81cc(0x1c6)];else{if(_0x46d371[0x0][_0x4c81cc(0x21d)]==_0x4c81cc(0x1e8))var _0x4427f6=users['Portuguese'];else{if(_0x46d371[0x0]['language']=='Chinese')var _0x4427f6=users[_0x4c81cc(0x1a7)];else{if(_0x46d371[0x0][_0x4c81cc(0x21d)]==_0x4c81cc(0x1a0))var _0x4427f6=users['Arabic'];}}}}}}}_0x5c8f71[_0x4c81cc(0x24f)](_0x4c81cc(0x19f),{'success':_0x40b9ea['flash'](_0x4c81cc(0x22a)),'errors':_0x40b9ea[_0x4c81cc(0x1ea)]('errors'),'role':_0x5601dd,'profile':_0x531e88,'customer':_0x1663b0,'warehouse':_0x517a60,'product':_0x28e9d2,'user':_0x293572,'master_shop':_0x46d371,'unit':_0x48dc80,'language':_0x4427f6});}catch(_0x237580){console[_0x4c81cc(0x24d)](_0x237580);}});async function dataUpdate(_0x2003fb,_0x3dc4dc,_0x13b3a9){var _0x4fc862=a0_0x9b60ca;return await warehouse['updateOne']({'_id':_0x2003fb,'product_details._id':_0x3dc4dc},{'$set':{'product_details.$.product_stock':_0x13b3a9}}),await warehouse[_0x4fc862(0x1d4)](_0x2003fb);}router[a0_0x9b60ca(0x1da)]('/preview/:id',auth,async(_0x3176c9,_0x58f3e8)=>{var _0x8acddf=a0_0x9b60ca;try{const _0x285b4e=_0x3176c9['params']['id'],{invoice:_0x2e98bc,warehouse_name:_0x3beefc,room:_0x2b3479}=_0x3176c9[_0x8acddf(0x1b3)],_0x120171=await sales_finished[_0x8acddf(0x155)]({'invoice':_0x2e98bc});for(let _0xf8c92a=0x0;_0xf8c92a<=_0x120171[_0x8acddf(0x260)][_0x8acddf(0x23c)]-0x1;_0xf8c92a++){const _0x10de3e=_0x120171[_0x8acddf(0x260)][_0xf8c92a];var _0x3f044a=await warehouse['findOne']({'name':_0x3beefc,'room':_0x10de3e[_0x8acddf(0x16f)]}),_0x82c893=0x0;for(let _0x2ac00e=0x0;_0x2ac00e<=_0x3f044a[_0x8acddf(0x21e)][_0x8acddf(0x23c)]-0x1;_0x2ac00e++){const _0x234afa=_0x3f044a[_0x8acddf(0x21e)][_0x2ac00e];_0x234afa[_0x8acddf(0x248)]==_0x10de3e[_0x8acddf(0x244)]&&_0x234afa[_0x8acddf(0x190)]==_0x10de3e[_0x8acddf(0x190)]&&(_0x82c893=Math[_0x8acddf(0x1b2)](0x0,Math[_0x8acddf(0x1bf)](_0x234afa['product_stock'])-Math[_0x8acddf(0x1bf)](_0x10de3e[_0x8acddf(0x17b)])),await warehouse['updateOne']({'_id':_0x3f044a[_0x8acddf(0x248)]['valueOf'](),'product_details._id':_0x234afa[_0x8acddf(0x248)]['valueOf'](),'product_details.uuid':_0x10de3e[_0x8acddf(0x190)]},{'$set':{'product_details.$.product_stock':_0x82c893}}));}console[_0x8acddf(0x24d)](typeof _0x10de3e[_0x8acddf(0x15f)]);if(typeof _0x10de3e['agent_id']!==_0x8acddf(0x197)){var _0xe8a110=await staff[_0x8acddf(0x1d4)](_0x10de3e[_0x8acddf(0x15f)]);console[_0x8acddf(0x24d)](_0x8acddf(0x201));var _0x154e6a=0x0;for(let _0x1c5fa9=0x0;_0x1c5fa9<=_0xe8a110[_0x8acddf(0x1e2)][_0x8acddf(0x23c)]-0x1;_0x1c5fa9++){const _0x5f161a=_0xe8a110[_0x8acddf(0x1e2)][_0x1c5fa9];console[_0x8acddf(0x24d)](_0x10de3e['id_transaction_from']+_0x8acddf(0x1b9)+_0x5f161a[_0x8acddf(0x226)]+_0x8acddf(0x15d)+_0x10de3e[_0x8acddf(0x248)]+_0x8acddf(0x1b9)+_0x10de3e[_0x8acddf(0x248)]),_0x10de3e[_0x8acddf(0x244)]==_0x5f161a[_0x8acddf(0x226)]&&_0x10de3e[_0x8acddf(0x248)]==0x1&&(_0x5f161a[_0x8acddf(0x220)]=Math[_0x8acddf(0x1bf)](_0x5f161a[_0x8acddf(0x220)])+Math['abs'](_0x10de3e[_0x8acddf(0x17b)]),_0x154e6a++);}console[_0x8acddf(0x24d)](_0x8acddf(0x200),_0x154e6a),_0x154e6a=='0'&&(_0xe8a110[_0x8acddf(0x1e2)]=_0xe8a110[_0x8acddf(0x1e2)][_0x8acddf(0x16b)]({'product_name':_0x10de3e[_0x8acddf(0x243)],'product_stock':_0x10de3e[_0x8acddf(0x17b)],'bay':_0x10de3e[_0x8acddf(0x19b)],'level':_0x10de3e[_0x8acddf(0x16d)],'product_code':_0x10de3e['product_code'],'primary_code':_0x10de3e[_0x8acddf(0x269)],'secondary_code':_0x10de3e[_0x8acddf(0x258)],'expiry_date':_0x10de3e[_0x8acddf(0x1d1)],'production_date':_0x10de3e['production_date'],'maxProducts':_0x10de3e[_0x8acddf(0x25c)],'batch_code':_0x10de3e[_0x8acddf(0x1fd)],'secondary_unit':_0x10de3e['secondary_unit'],'unit':_0x10de3e['unit'],'maxProducts':_0x10de3e[_0x8acddf(0x25c)],'maxPerUnit':_0x10de3e[_0x8acddf(0x264)],'invoice':_0x10de3e[_0x8acddf(0x22c)],'warehouse_id':_0x10de3e[_0x8acddf(0x244)],'id_incoming':_0x10de3e['_id'],'uuid':_0x10de3e['uuid'],'gross_price':_0x10de3e[_0x8acddf(0x207)],'date_incoming':_0x10de3e[_0x8acddf(0x210)],'outgoing_invoice':_0x10de3e[_0x8acddf(0x26c)]}),await _0xe8a110[_0x8acddf(0x17f)]());}}_0x120171[_0x8acddf(0x1c0)]=_0x8acddf(0x261);const _0x3386f0=await _0x120171['save'](),_0x240288=await master_shop[_0x8acddf(0x23f)](),_0x2b8b54=await email_settings[_0x8acddf(0x155)](),_0xda9d52=await supervisor_settings[_0x8acddf(0x23f)]();var _0x13b802=_0x120171['sale_product'],_0x25e1f0='',_0x5cc4eb;for(_0x5cc4eb in _0x13b802){_0x25e1f0+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13b802[_0x5cc4eb][_0x8acddf(0x243)]+_0x8acddf(0x1f6)+_0x8acddf(0x20f)+_0x13b802[_0x5cc4eb]['product_code']+'</td>'+_0x8acddf(0x20f)+_0x13b802[_0x5cc4eb][_0x8acddf(0x17b)]+_0x8acddf(0x1f6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13b802[_0x5cc4eb][_0x8acddf(0x163)]+_0x8acddf(0x1f6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13b802[_0x5cc4eb][_0x8acddf(0x228)]+_0x8acddf(0x1f6)+_0x8acddf(0x20f)+_0x120171[_0x8acddf(0x1c2)]+_0x8acddf(0x1f6)+_0x8acddf(0x20f)+_0x13b802[_0x5cc4eb][_0x8acddf(0x16f)]+_0x8acddf(0x1f6)+_0x8acddf(0x20f)+_0x13b802[_0x5cc4eb][_0x8acddf(0x19b)]+_0x8acddf(0x1f6);}_0x3176c9[_0x8acddf(0x1ea)](_0x8acddf(0x22a),_0x8acddf(0x20e)),_0x58f3e8[_0x8acddf(0x1ca)](_0x8acddf(0x211)+_0x285b4e);}catch(_0x58098a){console[_0x8acddf(0x24d)](_0x58098a);}}),router['get'](a0_0x9b60ca(0x235),auth,async(_0x1eb1d8,_0x3643fc)=>{var _0x5d2d66=a0_0x9b60ca;try{const {username:_0x407508,email:_0x5ee02b,role:_0x51264a}=_0x1eb1d8[_0x5d2d66(0x1db)],_0x3c9593=_0x1eb1d8[_0x5d2d66(0x1db)],_0x6950f1=await profile['findOne']({'email':_0x3c9593[_0x5d2d66(0x1b0)]}),_0x16d57d=await master_shop['find'](),_0x169ae3=_0x1eb1d8[_0x5d2d66(0x1a3)]['id'],_0x390e5=await sales_finished['findById'](_0x169ae3);let _0x2e6623=new Date(_0x390e5['expiry_date']),_0x2d65e6=('0'+_0x2e6623['getDate']())[_0x5d2d66(0x1fb)](-0x2),_0xe81ca1=('0'+(_0x2e6623['getMonth']()+0x1))[_0x5d2d66(0x1fb)](-0x2),_0x4cd10a=_0x2e6623['getFullYear'](),_0x42964f=_0x4cd10a+'-'+_0xe81ca1+'-'+_0x2d65e6;var _0x2973c6=['Ambient','Enclosed'];const _0x4f8366=await warehouse['aggregate']([{'$match':{'name':_0x390e5[_0x5d2d66(0x1c2)],'room':_0x390e5[_0x5d2d66(0x25b)]}},{'$unwind':_0x5d2d66(0x17a)},{'$group':{'_id':_0x5d2d66(0x171),'name':{'$first':_0x5d2d66(0x246)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5d2d66(0x1ad)},'floorlevel':{'$first':_0x5d2d66(0x204)},'primary_code':{'$first':_0x5d2d66(0x239)},'secondary_code':{'$first':_0x5d2d66(0x1ed)},'product_code':{'$first':_0x5d2d66(0x1af)},'storage':{'$first':_0x5d2d66(0x1ef)},'rack':{'$first':_0x5d2d66(0x1a1)}}}]),_0x18e31e=await customer[_0x5d2d66(0x23f)]({});let _0x3c66df;if(_0x3c9593[_0x5d2d66(0x23a)]==_0x5d2d66(0x1f8)){const _0x56c15=await staff['findOne']({'email':_0x3c9593[_0x5d2d66(0x1b0)]});_0x3c66df=await warehouse['aggregate']([{'$match':{'status':_0x5d2d66(0x1d2),'name':_0x56c15['warehouse']}},{'$group':{'_id':_0x5d2d66(0x18c),'name':{'$first':_0x5d2d66(0x18c)}}}]);}else _0x3c66df=await warehouse[_0x5d2d66(0x160)]([{'$match':{'status':_0x5d2d66(0x1d2)}},{'$group':{'_id':_0x5d2d66(0x18c),'name':{'$first':_0x5d2d66(0x18c)}}}]);const _0x5c2f71=await product[_0x5d2d66(0x23f)]({});if(_0x16d57d[0x0]['language']=='English\x20(US)'){var _0x101e6a=users[_0x5d2d66(0x274)];console[_0x5d2d66(0x24d)](_0x101e6a);}else{if(_0x16d57d[0x0]['language']=='Hindi')var _0x101e6a=users['Hindi'];else{if(_0x16d57d[0x0]['language']=='German')var _0x101e6a=users[_0x5d2d66(0x188)];else{if(_0x16d57d[0x0][_0x5d2d66(0x21d)]==_0x5d2d66(0x273))var _0x101e6a=users[_0x5d2d66(0x273)];else{if(_0x16d57d[0x0][_0x5d2d66(0x21d)]==_0x5d2d66(0x1c6))var _0x101e6a=users[_0x5d2d66(0x1c6)];else{if(_0x16d57d[0x0]['language']==_0x5d2d66(0x1e8))var _0x101e6a=users['Portuguese'];else{if(_0x16d57d[0x0][_0x5d2d66(0x21d)]==_0x5d2d66(0x1a7))var _0x101e6a=users[_0x5d2d66(0x1a7)];else{if(_0x16d57d[0x0]['language']==_0x5d2d66(0x1a0))var _0x101e6a=users['Arabic'];}}}}}}}_0x3643fc[_0x5d2d66(0x24f)](_0x5d2d66(0x1bc),{'success':_0x1eb1d8[_0x5d2d66(0x1ea)](_0x5d2d66(0x22a)),'errors':_0x1eb1d8[_0x5d2d66(0x1ea)](_0x5d2d66(0x1f9)),'role':_0x3c9593,'profile':_0x6950f1,'customer':_0x18e31e,'warehouse':_0x3c66df,'product':_0x4f8366,'user':_0x390e5,'master_shop':_0x16d57d,'unit':_0x5c2f71,'language':_0x101e6a,'rooms_data':_0x2973c6,'ed_fullDate':_0x42964f});}catch(_0xe56288){console[_0x5d2d66(0x24d)](_0xe56288);}}),router['post'](a0_0x9b60ca(0x235),auth,async(_0x1dfe20,_0x43321a)=>{var _0x4844ca=a0_0x9b60ca;try{const _0x48a26d=_0x1dfe20[_0x4844ca(0x1a3)]['id'],_0x5f27dc=await sales_finished[_0x4844ca(0x155)]({'_id':_0x1dfe20[_0x4844ca(0x1a3)]['id']}),_0x118985=await warehouse['findOne']({'name':_0x5f27dc['warehouse_name'],'room':_0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x25b)],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x118803,customer:_0x140304,date:_0x150d16,warehouse_name:_0x2c2ba1,product_name:_0x246487,stock:_0x39b64b,adjust_qty:_0xa03b55,note:_0x23bc80,room:_0x4f5410,primary_code:_0x23748e,secondary_code:_0x505a6b,prod_code:_0x449a78,level:_0x48859d,isle:_0xf6ec5e,pallet:_0x596642,expiry_date:_0x504d0e}=_0x1dfe20['body'];if(typeof _0x246487==_0x4844ca(0x26b))var _0x1b9118=[_0x1dfe20[_0x4844ca(0x1b3)]['product_name']],_0xced69a=[_0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x231)]],_0x152030=[_0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x176)]],_0x4d46f2=[_0x1dfe20['body'][_0x4844ca(0x269)]],_0x2bd916=[_0x1dfe20[_0x4844ca(0x1b3)]['secondary_code']],_0xdb28c6=[_0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x25a)]],_0xd1ec2f=[_0x1dfe20['body'][_0x4844ca(0x16d)]],_0x26732b=[_0x1dfe20[_0x4844ca(0x1b3)]['expiry_date']];else var _0x1b9118=[..._0x1dfe20[_0x4844ca(0x1b3)]['product_name']],_0xced69a=[..._0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x231)]],_0x152030=[..._0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x176)]],_0x4d46f2=[..._0x1dfe20[_0x4844ca(0x1b3)]['primary_code']],_0x2bd916=[..._0x1dfe20['body']['secondary_code']],_0xdb28c6=[..._0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x25a)]],_0xd1ec2f=[..._0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x16d)]],_0x26732b=[..._0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x1d1)]];const _0x229d88=_0x1b9118[_0x4844ca(0x1cc)](_0x291e9e=>{return _0x291e9e={'product_name':_0x291e9e};});_0xced69a[_0x4844ca(0x178)]((_0x5af9c5,_0x5ae4ad)=>{var _0x34131d=_0x4844ca;_0x229d88[_0x5ae4ad][_0x34131d(0x231)]=_0x5af9c5;}),_0x152030['forEach']((_0x3e1669,_0x118336)=>{var _0x1e17e8=_0x4844ca;_0x229d88[_0x118336][_0x1e17e8(0x17b)]=_0x3e1669;}),_0x4d46f2[_0x4844ca(0x178)]((_0x197341,_0x20e3f3)=>{var _0x5d8985=_0x4844ca;_0x229d88[_0x20e3f3][_0x5d8985(0x269)]=_0x197341;}),_0x2bd916[_0x4844ca(0x178)]((_0xe522f7,_0xa5939a)=>{var _0x27a830=_0x4844ca;_0x229d88[_0xa5939a][_0x27a830(0x258)]=_0xe522f7;}),_0xdb28c6[_0x4844ca(0x178)]((_0x711d23,_0x21b091)=>{var _0xa8d857=_0x4844ca;_0x229d88[_0x21b091][_0xa8d857(0x240)]=_0x711d23;}),_0xd1ec2f[_0x4844ca(0x178)]((_0x56f653,_0x5459fc)=>{var _0x5504ad=_0x4844ca;_0x229d88[_0x5459fc][_0x5504ad(0x16d)]=_0x56f653;}),_0x26732b[_0x4844ca(0x178)]((_0x587439,_0x12d9ea)=>{var _0x303391=_0x4844ca;_0x229d88[_0x12d9ea][_0x303391(0x1d1)]=_0x587439;});var _0x97baab=0x0;_0x229d88[_0x4844ca(0x178)](_0x2196ea=>{var _0xd3aa74=_0x4844ca;console[_0xd3aa74(0x24d)](_0xd3aa74(0x223),_0x2196ea),(parseInt(_0x2196ea[_0xd3aa74(0x231)])<parseInt(_0x2196ea[_0xd3aa74(0x17b)])||parseInt(_0x2196ea['quantity'])==0x0)&&_0x97baab++;});if(_0x97baab!=0x0)return _0x1dfe20[_0x4844ca(0x1ea)](_0x4844ca(0x1f9),_0x4844ca(0x1ab)),_0x43321a[_0x4844ca(0x1ca)](_0x4844ca(0x232));_0x5f27dc[_0x4844ca(0x260)][_0x4844ca(0x178)](_0x5c222d=>{var _0x541461=_0x4844ca;const _0x20c4b6=_0x118985['product_details'][_0x541461(0x1cc)](_0x233490=>{var _0x141708=_0x541461;_0x233490['product_name']==_0x5c222d[_0x141708(0x243)]&&_0x233490[_0x141708(0x19b)]==_0x5c222d[_0x141708(0x19b)]&&(_0x233490[_0x141708(0x220)]=parseInt(_0x233490['product_stock'])+parseInt(_0x5c222d[_0x141708(0x17b)]));});}),await _0x118985[_0x4844ca(0x17f)]();const _0x1fb004=_0x229d88['filter'](_0x2dc015=>_0x2dc015['quantity']!=='0'&&_0x2dc015[_0x4844ca(0x17b)]!=='');_0x5f27dc[_0x4844ca(0x22c)]=_0x118803,_0x5f27dc[_0x4844ca(0x20c)]=_0x140304,_0x5f27dc[_0x4844ca(0x19a)]=_0x150d16,_0x5f27dc['warehouse_name']=_0x2c2ba1,_0x5f27dc[_0x4844ca(0x260)]=_0x1fb004,_0x5f27dc[_0x4844ca(0x18d)]=_0x23bc80,_0x5f27dc[_0x4844ca(0x25b)]=_0x4f5410;const _0x331dfe=await _0x5f27dc[_0x4844ca(0x17f)](),_0x5283e1=await sales_finished[_0x4844ca(0x155)]({'_id':_0x1dfe20[_0x4844ca(0x1a3)]['id']}),_0x59caa3=await warehouse['findOne']({'name':_0x2c2ba1,'room':_0x4f5410,'warehouse_category':_0x4844ca(0x23e)});_0x5283e1[_0x4844ca(0x260)]['forEach'](_0x1f8d0a=>{const _0x52c2af=_0x59caa3['product_details']['map'](_0x55951a=>{var _0x4b7a00=a0_0x1872;_0x55951a[_0x4b7a00(0x243)]==_0x1f8d0a['product_name']&&_0x55951a[_0x4b7a00(0x19b)]==_0x1f8d0a[_0x4b7a00(0x19b)]&&(_0x55951a[_0x4b7a00(0x220)]=parseInt(_0x55951a[_0x4b7a00(0x220)])-parseInt(_0x1f8d0a[_0x4b7a00(0x17b)]));});}),console[_0x4844ca(0x24d)](_0x4844ca(0x1b6),_0x59caa3),await _0x59caa3[_0x4844ca(0x17f)]();const _0x31a1cc=await c_payment_data[_0x4844ca(0x155)]({'invoice':_0x1dfe20['body'][_0x4844ca(0x22c)]});_0x31a1cc[_0x4844ca(0x1a4)]=_0x1dfe20[_0x4844ca(0x1b3)][_0x4844ca(0x1a4)],await _0x31a1cc[_0x4844ca(0x17f)](),_0x1dfe20[_0x4844ca(0x1ea)](_0x4844ca(0x22a),_0x4844ca(0x20e)),_0x43321a[_0x4844ca(0x1ca)](_0x4844ca(0x182));}catch(_0x13c5c9){console[_0x4844ca(0x24d)](_0x13c5c9);}}),router[a0_0x9b60ca(0x1da)](a0_0x9b60ca(0x1a8),auth,async(_0x40b676,_0x50f4ba)=>{var _0x5ad307=a0_0x9b60ca;try{const _0x14c2c9=_0x40b676['params']['id'],{invoice:_0x4b785f,customer:_0x35fea7,receivable_amount:_0x2eea5d,received_amount:_0x1c0a34}=_0x40b676[_0x5ad307(0x1b3)],_0xbac316=await sales[_0x5ad307(0x1d4)](_0x14c2c9);console[_0x5ad307(0x24d)](_0xbac316);var _0x53be90=_0x2eea5d-_0x1c0a34;console[_0x5ad307(0x24d)](_0x1c0a34),_0xbac316['received_amount']=parseFloat(_0x1c0a34)+parseFloat(_0xbac316[_0x5ad307(0x209)]),_0xbac316['due_amount']=_0x53be90,console[_0x5ad307(0x24d)](_0xbac316);const _0x45989e=await _0xbac316[_0x5ad307(0x17f)](),_0x2c7bc2=await c_payment_data[_0x5ad307(0x155)]({'invoice':_0x4b785f});_0x2c7bc2['amount']=_0x53be90,await _0x2c7bc2[_0x5ad307(0x17f)]();let _0x38d5a3=new Date(),_0x47b7c2=('0'+_0x38d5a3[_0x5ad307(0x254)]())['slice'](-0x2),_0x87986e=('0'+(_0x38d5a3[_0x5ad307(0x245)]()+0x1))['slice'](-0x2),_0xdabb80=_0x38d5a3[_0x5ad307(0x221)](),_0x27f0b6=_0xdabb80+'-'+_0x87986e+'-'+_0x47b7c2;const _0x4221ed=new customer_payment({'invoice':_0x4b785f,'date':_0xdabb80+'-'+_0x87986e+'-'+_0x47b7c2,'customer':_0x35fea7,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x1c0a34}),_0x5e2cc5=await _0x4221ed[_0x5ad307(0x17f)]();_0x40b676[_0x5ad307(0x1ea)]('success',_0x5ad307(0x1a6)),_0x50f4ba[_0x5ad307(0x1ca)]('/all_sales/view');}catch(_0x95da27){console['log'](_0x95da27);}}),router[a0_0x9b60ca(0x230)](a0_0x9b60ca(0x1fa),auth,async(_0x5c34a5,_0x258238)=>{var _0x1cf7b0=a0_0x9b60ca;try{const {username:_0x442fb9,email:_0x5e6996,role:_0x3cc11b}=_0x5c34a5[_0x1cf7b0(0x1db)],_0x4a2efc=_0x5c34a5[_0x1cf7b0(0x1db)],_0x56355e=await profile[_0x1cf7b0(0x155)]({'email':_0x4a2efc[_0x1cf7b0(0x1b0)]}),_0x1951cd=await master_shop[_0x1cf7b0(0x23f)]();console[_0x1cf7b0(0x24d)](_0x1cf7b0(0x198),_0x1951cd);const _0x51c204=_0x5c34a5[_0x1cf7b0(0x1a3)]['id'],_0x2725f3=await sales[_0x1cf7b0(0x1d4)](_0x51c204);console['log'](_0x2725f3);const _0x383596=await customer[_0x1cf7b0(0x155)]({'name':_0x2725f3[_0x1cf7b0(0x20c)]});console[_0x1cf7b0(0x24d)](_0x383596);if(_0x1951cd[0x0]['language']==_0x1cf7b0(0x24b)){var _0x3d0299=users[_0x1cf7b0(0x274)];console[_0x1cf7b0(0x24d)](_0x3d0299);}else{if(_0x1951cd[0x0][_0x1cf7b0(0x21d)]==_0x1cf7b0(0x1d6))var _0x3d0299=users['Hindi'];else{if(_0x1951cd[0x0][_0x1cf7b0(0x21d)]==_0x1cf7b0(0x188))var _0x3d0299=users[_0x1cf7b0(0x188)];else{if(_0x1951cd[0x0][_0x1cf7b0(0x21d)]==_0x1cf7b0(0x273))var _0x3d0299=users[_0x1cf7b0(0x273)];else{if(_0x1951cd[0x0][_0x1cf7b0(0x21d)]==_0x1cf7b0(0x1c6))var _0x3d0299=users[_0x1cf7b0(0x1c6)];else{if(_0x1951cd[0x0]['language']==_0x1cf7b0(0x1e8))var _0x3d0299=users[_0x1cf7b0(0x1e9)];else{if(_0x1951cd[0x0][_0x1cf7b0(0x21d)]=='Chinese')var _0x3d0299=users[_0x1cf7b0(0x1a7)];else{if(_0x1951cd[0x0]['language']==_0x1cf7b0(0x1a0))var _0x3d0299=users['Arabic'];}}}}}}}_0x258238[_0x1cf7b0(0x24f)](_0x1cf7b0(0x216),{'success':_0x5c34a5['flash'](_0x1cf7b0(0x22a)),'errors':_0x5c34a5[_0x1cf7b0(0x1ea)](_0x1cf7b0(0x1f9)),'role':_0x4a2efc,'profile':_0x56355e,'master_shop':_0x1951cd,'customers':_0x383596,'sales':_0x2725f3,'language':_0x3d0299});}catch(_0x886d96){console[_0x1cf7b0(0x24d)](_0x886d96);}}),router[a0_0x9b60ca(0x230)](a0_0x9b60ca(0x1a9),auth,async(_0x213999,_0x27fccd)=>{var _0x5acf84=a0_0x9b60ca;try{const {username:_0x188af7,email:_0x2d9381,role:_0x1f252d}=_0x213999['user'],_0x1110d8=_0x213999['user'],_0x1a699b=await profile[_0x5acf84(0x155)]({'email':_0x1110d8[_0x5acf84(0x1b0)]}),_0x5478ed=await master_shop[_0x5acf84(0x23f)](),_0x2bc5e6=_0x213999[_0x5acf84(0x1a3)]['id'],_0x20dba4=await sales_finished[_0x5acf84(0x1d4)](_0x2bc5e6),_0x28d161=await warehouse['aggregate']([{'$match':{'name':_0x20dba4['warehouse_name']}},{'$unwind':_0x5acf84(0x17a)},{'$group':{'_id':_0x5acf84(0x171),'name':{'$first':_0x5acf84(0x246)},'product_stock':{'$first':_0x5acf84(0x257)},'bay':{'$first':_0x5acf84(0x234)},'bin':{'$first':_0x5acf84(0x229)},'type':{'$first':_0x5acf84(0x1ad)},'floorlevel':{'$first':_0x5acf84(0x204)},'primary_code':{'$first':_0x5acf84(0x239)},'secondary_code':{'$first':_0x5acf84(0x1ed)},'product_code':{'$first':_0x5acf84(0x1af)},'storage':{'$first':_0x5acf84(0x1ef)},'rack':{'$first':_0x5acf84(0x1a1)},'expiry_date':{'$first':_0x5acf84(0x187)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':_0x5acf84(0x225)},'secondary_unit':{'$first':_0x5acf84(0x22b)},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':_0x5acf84(0x1be)},'maxPerUnit':{'$first':_0x5acf84(0x1b5)}}}]),_0x541e2f=await product[_0x5acf84(0x23f)]({}),_0x1d5406=await warehouse['aggregate']([{'$match':{'status':_0x5acf84(0x1d2),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x5acf84(0x219),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);var _0x27f3e2=[_0x5acf84(0x1d3)];const _0x16a6b4=await warehouse[_0x5acf84(0x160)]([{'$match':{'status':_0x5acf84(0x1d2),'name':_0x5acf84(0x183)}},{'$group':{'_id':'$name','name':{'$first':_0x5acf84(0x18c)}}},{'$sort':{'name':0x1}}]);if(_0x5478ed[0x0][_0x5acf84(0x21d)]==_0x5acf84(0x24b)){var _0x5b200e=users[_0x5acf84(0x274)];console['log'](_0x5b200e);}else{if(_0x5478ed[0x0][_0x5acf84(0x21d)]==_0x5acf84(0x1d6))var _0x5b200e=users[_0x5acf84(0x1d6)];else{if(_0x5478ed[0x0]['language']==_0x5acf84(0x188))var _0x5b200e=users[_0x5acf84(0x188)];else{if(_0x5478ed[0x0][_0x5acf84(0x21d)]==_0x5acf84(0x273))var _0x5b200e=users[_0x5acf84(0x273)];else{if(_0x5478ed[0x0][_0x5acf84(0x21d)]==_0x5acf84(0x1c6))var _0x5b200e=users[_0x5acf84(0x1c6)];else{if(_0x5478ed[0x0]['language']==_0x5acf84(0x1e8))var _0x5b200e=users[_0x5acf84(0x1e9)];else{if(_0x5478ed[0x0]['language']=='Chinese')var _0x5b200e=users[_0x5acf84(0x1a7)];else{if(_0x5478ed[0x0][_0x5acf84(0x21d)]=='Arabic\x20(ae)')var _0x5b200e=users['Arabic'];}}}}}}}_0x27fccd[_0x5acf84(0x24f)](_0x5acf84(0x26a),{'success':_0x213999[_0x5acf84(0x1ea)](_0x5acf84(0x22a)),'errors':_0x213999[_0x5acf84(0x1ea)]('errors'),'role':_0x1110d8,'profile':_0x1a699b,'user':_0x20dba4,'stock':_0x28d161,'master_shop':_0x5478ed,'unit':_0x541e2f,'language':_0x5b200e,'warehouses':_0x1d5406,'rooms':_0x27f3e2,'warehouse_QA':_0x16a6b4});}catch(_0x4345a7){console['log'](_0x4345a7),_0x27fccd[_0x5acf84(0x26f)](0xc8)['json']({'message':_0x4345a7[_0x5acf84(0x22d)]});}}),router['post'](a0_0x9b60ca(0x1a9),auth,async(_0x5484b8,_0x2f3e71)=>{var _0x1c8600=a0_0x9b60ca;if(_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x1b1)]=='QA')try{const {invoice:_0x400af5,date:_0x1da4cf,warehouse_name:_0x1162db,product_name:_0x5f269a,primary_code:_0x528bf8,secondary_code:_0x2aff32,product_code:_0x1f98d4,sales_quantity:_0x6230b6,stocks:_0x3323f5,return_qty:_0x238134,Room_name:_0x34dfc5,to_warehouse_name_QA:_0x1e1435,to_Room_name_QA:_0x8c4872,note:_0x4ee566,for_categorize:_0x2885d8,product_name_QA1:_0x515f73}=_0x5484b8[_0x1c8600(0x1b3)];if(typeof _0x515f73=='string')var _0x1d69f2=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x238)]],_0x288ee9=[_0x5484b8['body'][_0x1c8600(0x170)]],_0x230b0a=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x237)]],_0x29370d=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x272)]],_0x2bf22c=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x1a2)]],_0x510b55=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x192)]],_0x3d1dad=[_0x5484b8[_0x1c8600(0x1b3)]['return_qty_QA']],_0x282087=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x1fe)]],_0x4a40c8=[_0x5484b8[_0x1c8600(0x1b3)]['maxProducts_QA']],_0x4aabe1=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x208)]],_0x37df5f=[_0x5484b8[_0x1c8600(0x1b3)]['secondary_unit_QA']],_0x30557f=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x1cb)]],_0x23f439=[_0x5484b8[_0x1c8600(0x1b3)]['production_date_QA']],_0x939da7=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x202)]];else var _0x1d69f2=[..._0x5484b8[_0x1c8600(0x1b3)]['product_name_QA1']],_0x288ee9=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x170)]],_0x230b0a=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x237)]],_0x29370d=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x272)]],_0x2bf22c=[..._0x5484b8[_0x1c8600(0x1b3)]['sales_quantity_QA']],_0x510b55=[..._0x5484b8['body'][_0x1c8600(0x192)]],_0x3d1dad=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x167)]],_0x282087=[..._0x5484b8[_0x1c8600(0x1b3)]['maxPerUnit_QA']],_0x4a40c8=[..._0x5484b8['body'][_0x1c8600(0x259)]],_0x4aabe1=[..._0x5484b8['body'][_0x1c8600(0x208)]],_0x37df5f=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x1f2)]],_0x30557f=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x1cb)]],_0x23f439=[..._0x5484b8[_0x1c8600(0x1b3)]['production_date_QA']],_0x939da7=[..._0x5484b8[_0x1c8600(0x1b3)]['expiry_date_QA']];const _0xf8200f=_0x1d69f2['map'](_0x5167c0=>{return _0x5167c0={'product_name':_0x5167c0};});_0x288ee9['forEach']((_0x23ed0e,_0x196869)=>{var _0x49730e=_0x1c8600;_0xf8200f[_0x196869][_0x49730e(0x269)]=_0x23ed0e;}),_0x230b0a[_0x1c8600(0x178)]((_0x1d8f7d,_0xad8b3a)=>{var _0x286d21=_0x1c8600;_0xf8200f[_0xad8b3a][_0x286d21(0x258)]=_0x1d8f7d;}),_0x29370d[_0x1c8600(0x178)]((_0x4a832b,_0x122c5c)=>{_0xf8200f[_0x122c5c]['product_code']=_0x4a832b;}),_0x2bf22c[_0x1c8600(0x178)]((_0xaa6bc0,_0x29741e)=>{var _0x1a6140=_0x1c8600;_0xf8200f[_0x29741e][_0x1a6140(0x169)]=_0xaa6bc0;}),_0x510b55[_0x1c8600(0x178)]((_0xf5b435,_0x4ceb5d)=>{_0xf8200f[_0x4ceb5d]['stock']=_0xf5b435;}),_0x3d1dad[_0x1c8600(0x178)]((_0x14ad6c,_0x1f46a4)=>{_0xf8200f[_0x1f46a4]['return_qty']=_0x14ad6c;}),_0x282087['forEach']((_0xdbcb7c,_0x535789)=>{_0xf8200f[_0x535789]['maxPerUnit']=_0xdbcb7c;}),_0x4a40c8['forEach']((_0x34fe54,_0xdd8a89)=>{var _0xd07df7=_0x1c8600;_0xf8200f[_0xdd8a89][_0xd07df7(0x25c)]=_0x34fe54;}),_0x4aabe1[_0x1c8600(0x178)]((_0x3b630f,_0x2addc8)=>{_0xf8200f[_0x2addc8]['batch_code']=_0x3b630f;}),_0x37df5f[_0x1c8600(0x178)]((_0x4cfda0,_0x488720)=>{var _0x17f197=_0x1c8600;_0xf8200f[_0x488720][_0x17f197(0x228)]=_0x4cfda0;}),_0x30557f[_0x1c8600(0x178)]((_0x50ac92,_0x1ec95c)=>{var _0x132b6f=_0x1c8600;_0xf8200f[_0x1ec95c][_0x132b6f(0x163)]=_0x50ac92;}),_0x23f439['forEach']((_0x43a44c,_0x4f0e35)=>{_0xf8200f[_0x4f0e35]['production_date']=_0x43a44c;}),_0x939da7['forEach']((_0x34bd77,_0x23c9d6)=>{var _0x5a51b7=_0x1c8600;_0xf8200f[_0x23c9d6][_0x5a51b7(0x1d1)]=_0x34bd77;});const _0x50a38a=await sales_finished[_0x1c8600(0x155)]({'invoice':_0x400af5});_0x50a38a[_0x1c8600(0x1dc)]=_0x1c8600(0x261);const _0x910168=await _0x50a38a[_0x1c8600(0x17f)](),_0x2b7502=new sales_return_finished({'invoice':_0x400af5,'customer':_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x20c)],'date':_0x1da4cf,'warehouse_name':_0x1162db,'room':_0x34dfc5,'ToWarehouse':_0x1e1435,'ToRoom':_0x8c4872,'return_sale_QA':_0xf8200f,'note':_0x4ee566,'warehouse_cat':_0x2885d8}),_0x4f56b8=await _0x2b7502[_0x1c8600(0x17f)](),_0x193705=await sales_return_finished[_0x1c8600(0x155)]({'invoice':_0x400af5}),_0x5ec6e4=await warehouse[_0x1c8600(0x155)]({'name':_0x1e1435,'room':_0x8c4872});_0x193705[_0x1c8600(0x1a5)][_0x1c8600(0x178)](_0x288660=>{var _0x470f89=_0x1c8600,_0x5d4bc0=0x0;const _0x4c45c8=_0x5ec6e4[_0x470f89(0x21e)][_0x470f89(0x1cc)](_0x480b92=>{var _0x1f6ac2=_0x470f89;_0x480b92['product_name']==_0x288660[_0x1f6ac2(0x243)]&&_0x480b92['expiry_date']==_0x288660[_0x1f6ac2(0x1d1)]&&_0x480b92['production_date']==_0x288660[_0x1f6ac2(0x262)]&&_0x480b92[_0x1f6ac2(0x1fd)]==_0x288660['batch_code']&&(_0x480b92[_0x1f6ac2(0x220)]=parseInt(_0x480b92['product_stock'])+parseInt(_0x288660[_0x1f6ac2(0x23b)]),_0x5d4bc0++);});_0x5d4bc0=='0'&&(_0x5ec6e4[_0x470f89(0x21e)]=_0x5ec6e4[_0x470f89(0x21e)][_0x470f89(0x16b)]({'product_name':_0x288660[_0x470f89(0x243)],'product_stock':_0x288660[_0x470f89(0x23b)],'primary_code':_0x288660[_0x470f89(0x269)],'secondary_code':_0x288660['secondary_code'],'product_code':_0x288660[_0x470f89(0x240)],'batch_code':_0x288660[_0x470f89(0x1fd)],'maxPerUnit':_0x288660[_0x470f89(0x172)],'production_date':_0x288660[_0x470f89(0x262)],'expiry_date':_0x288660['expiry_date'],'secondary_unit':_0x288660[_0x470f89(0x228)],'unit':_0x288660[_0x470f89(0x163)],'maxProducts':_0x288660[_0x470f89(0x25c)],'bay':_0x288660[_0x470f89(0x19b)]}));}),await _0x5ec6e4['save']();const _0x2bb3f5=new c_payment_data({'invoice':_0x400af5,'customer':_0x5484b8['body'][_0x1c8600(0x20c)],'reason':'Sale\x20Return'});await _0x2bb3f5[_0x1c8600(0x17f)]();const _0x36c289=await master_shop[_0x1c8600(0x23f)](),_0x2bb8a0=await email_settings[_0x1c8600(0x155)](),_0x388096=await customer[_0x1c8600(0x155)]({'name':_0x5484b8['body'][_0x1c8600(0x20c)]});_0x36c289[0x0][_0x1c8600(0x1f0)]==0x1?(right_currency=_0x36c289[0x0][_0x1c8600(0x263)],left_currency=''):(right_currency='',left_currency=_0x36c289[0x0][_0x1c8600(0x263)]);var _0x5ccbf7=_0x1d69f2,_0x3fec21=_0x3d1dad,_0x1920f4='',_0x22893b;for(_0x22893b in _0x5ccbf7){_0x1920f4+=_0x1c8600(0x270)+_0x1c8600(0x20f)+_0x5ccbf7[_0x22893b]+_0x1c8600(0x1f6)+_0x1c8600(0x20f)+_0x3fec21[_0x22893b]+_0x1c8600(0x1f6)+_0x1c8600(0x20a);}console[_0x1c8600(0x24d)](_0x1c8600(0x1e2),_0x1920f4);let _0x31f38a=nodemailer[_0x1c8600(0x23d)]({'service':_0x1c8600(0x17e),'auth':{'user':_0x2bb8a0['email'],'pass':_0x2bb8a0['password']}}),_0xc311c8={'from':_0x2bb8a0[_0x1c8600(0x1b0)],'to':_0x388096[_0x1c8600(0x1b0)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x1c8600(0x233),'path':__dirname+_0x1c8600(0x222)+_0x1c8600(0x1cd)+_0x36c289[0x0][_0x1c8600(0x1ba)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x1c8600(0x242)+_0x1c8600(0x256)+_0x1c8600(0x1ae)+_0x1c8600(0x21b)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1c8600(0x173)+'<div>'+_0x1c8600(0x1aa)+_0x36c289[0x0][_0x1c8600(0x17c)]+_0x1c8600(0x1fc)+_0x1c8600(0x173)+'</div>'+_0x1c8600(0x21f)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x1c8600(0x1f1)+_0x400af5+'\x20'+_0x1c8600(0x265)+'\x20Order\x20Date\x20:\x20'+_0x1da4cf+'\x20'+_0x1c8600(0x236)+'</h5>'+_0x1c8600(0x173)+_0x1c8600(0x1f5)+_0x1c8600(0x19e)+_0x1c8600(0x270)+_0x1c8600(0x15a)+_0x1c8600(0x24c)+_0x1c8600(0x21c)+_0x1c8600(0x252)+'</tr>'+_0x1c8600(0x16e)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1920f4+'\x20'+_0x1c8600(0x1c5)+_0x1c8600(0x189)+'<div>'+_0x1c8600(0x158)+_0x1c8600(0x1e4)+_0x36c289[0x0][_0x1c8600(0x17c)]+_0x1c8600(0x206)+'</div>'+_0x1c8600(0x173)+'</body></html>'};_0x31f38a['sendMail'](_0xc311c8,function(_0x333a51,_0xd37cc){var _0x53d6fb=_0x1c8600;_0x333a51?(console[_0x53d6fb(0x24d)](_0x333a51),console[_0x53d6fb(0x24d)](_0x53d6fb(0x1e3))):console[_0x53d6fb(0x24d)](_0x53d6fb(0x1dd));}),_0x5484b8[_0x1c8600(0x1ea)](_0x1c8600(0x22a),_0x1c8600(0x186)),_0x2f3e71[_0x1c8600(0x1ca)](_0x1c8600(0x182));}catch(_0x248699){_0x2f3e71[_0x1c8600(0x26f)](0xc8)[_0x1c8600(0x224)]({'message1':_0x248699[_0x1c8600(0x22d)]});}else{if(_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x1b1)]=='GS')try{const {invoice:_0x25fc0f,date:_0x183c43,warehouse_name:_0x3143b3,product_name:_0x235085,primary_code:_0x2260ad,secondary_code:_0x38c03c,product_code:_0x577632,sales_quantity:_0xac3145,stocks:_0x3da021,return_qty:_0x244670,Room_name:_0x5587c0,to_warehouse_name:_0x49dc91,to_Room_name:_0x3a8b14,note:_0x101972,level:_0x3020cc,isle:_0x4b7413,pallet:_0x3a93fc,for_categorize:_0x2bf512}=_0x5484b8[_0x1c8600(0x1b3)];if(typeof _0x235085==_0x1c8600(0x26b))var _0x1d69f2=[_0x5484b8['body'][_0x1c8600(0x243)]],_0x288ee9=[_0x5484b8['body'][_0x1c8600(0x269)]],_0x230b0a=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x258)]],_0x29370d=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x240)]],_0x2bf22c=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x157)]],_0x3d1dad=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x23b)]],_0x16f8e5=[_0x5484b8['body'][_0x1c8600(0x19b)]],_0x282087=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x172)]],_0x4a40c8=[_0x5484b8['body'][_0x1c8600(0x25c)]],_0x4aabe1=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x1fd)]],_0x37df5f=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x228)]],_0x30557f=[_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x163)]],_0x23f439=[_0x5484b8['body'][_0x1c8600(0x262)]],_0x939da7=[_0x5484b8['body']['expiry_date']];else var _0x1d69f2=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x243)]],_0x288ee9=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x269)]],_0x230b0a=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x258)]],_0x29370d=[..._0x5484b8[_0x1c8600(0x1b3)]['product_code']],_0x2bf22c=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x157)]],_0x3d1dad=[..._0x5484b8[_0x1c8600(0x1b3)]['return_qty']],_0x16f8e5=[..._0x5484b8['body'][_0x1c8600(0x19b)]],_0x282087=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x172)]],_0x4a40c8=[..._0x5484b8['body'][_0x1c8600(0x25c)]],_0x4aabe1=[..._0x5484b8[_0x1c8600(0x1b3)]['batch_code']],_0x37df5f=[..._0x5484b8[_0x1c8600(0x1b3)]['secondary_unit']],_0x30557f=[..._0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x163)]],_0x23f439=[..._0x5484b8['body'][_0x1c8600(0x262)]],_0x939da7=[..._0x5484b8[_0x1c8600(0x1b3)]['expiry_date']];const _0x31e6dc=_0x1d69f2['map'](_0x57a072=>{return _0x57a072={'product_name':_0x57a072};});_0x288ee9[_0x1c8600(0x178)]((_0x4eb870,_0x436b7f)=>{var _0x4e6076=_0x1c8600;_0x31e6dc[_0x436b7f][_0x4e6076(0x269)]=_0x4eb870;}),_0x230b0a[_0x1c8600(0x178)]((_0x379c4b,_0xbd098e)=>{var _0x5b1f83=_0x1c8600;_0x31e6dc[_0xbd098e][_0x5b1f83(0x258)]=_0x379c4b;}),_0x29370d[_0x1c8600(0x178)]((_0x3b3ef6,_0x5bb8c0)=>{_0x31e6dc[_0x5bb8c0]['product_code']=_0x3b3ef6;}),_0x2bf22c['forEach']((_0x4bd6e2,_0x1b7e61)=>{_0x31e6dc[_0x1b7e61]['sale_qty']=_0x4bd6e2;}),_0x3d1dad['forEach']((_0x218df5,_0x263db8)=>{var _0x44c782=_0x1c8600;_0x31e6dc[_0x263db8][_0x44c782(0x23b)]=_0x218df5;}),_0x16f8e5['forEach']((_0x3cbecf,_0x455193)=>{_0x31e6dc[_0x455193]['bay']=_0x3cbecf;}),_0x282087[_0x1c8600(0x178)]((_0x1205fd,_0x3949a7)=>{var _0x2dc3a1=_0x1c8600;_0x31e6dc[_0x3949a7][_0x2dc3a1(0x172)]=_0x1205fd;}),_0x4a40c8[_0x1c8600(0x178)]((_0x2030c0,_0x8b762a)=>{var _0x578c5f=_0x1c8600;_0x31e6dc[_0x8b762a][_0x578c5f(0x25c)]=_0x2030c0;}),_0x4aabe1[_0x1c8600(0x178)]((_0x682df9,_0x1919b4)=>{var _0x22d30e=_0x1c8600;_0x31e6dc[_0x1919b4][_0x22d30e(0x1fd)]=_0x682df9;}),_0x37df5f['forEach']((_0xa070aa,_0x4834cc)=>{_0x31e6dc[_0x4834cc]['secondary_unit']=_0xa070aa;}),_0x30557f[_0x1c8600(0x178)]((_0x4e3516,_0x3b6e42)=>{_0x31e6dc[_0x3b6e42]['unit']=_0x4e3516;}),_0x23f439[_0x1c8600(0x178)]((_0x5bc23b,_0x1e900e)=>{var _0xcb61e7=_0x1c8600;_0x31e6dc[_0x1e900e][_0xcb61e7(0x262)]=_0x5bc23b;}),_0x939da7['forEach']((_0x44427c,_0x25c1cb)=>{var _0x5e5fbd=_0x1c8600;_0x31e6dc[_0x25c1cb][_0x5e5fbd(0x1d1)]=_0x44427c;});var _0x2c1e12=0x0;_0x31e6dc[_0x1c8600(0x178)](_0x3df1e0=>{var _0x16a81e=_0x1c8600;(parseInt(_0x3df1e0[_0x16a81e(0x169)])<parseInt(_0x3df1e0[_0x16a81e(0x23b)])||parseInt(_0x3df1e0[_0x16a81e(0x231)])<parseInt(_0x3df1e0[_0x16a81e(0x23b)])&&parseInt(_0x3df1e0[_0x16a81e(0x169)])>parseInt(_0x3df1e0[_0x16a81e(0x23b)])||parseInt(_0x3df1e0[_0x16a81e(0x23b)])==0x0)&&_0x2c1e12++;});if(_0x2c1e12!=0x0)return _0x5484b8[_0x1c8600(0x1ea)]('errors','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x2f3e71[_0x1c8600(0x1ca)]('back');const _0x287905=await sales_finished[_0x1c8600(0x155)]({'invoice':_0x25fc0f});_0x287905[_0x1c8600(0x1dc)]='True';const _0x13e41c=await _0x287905['save'](),_0x60cc08=new sales_return_finished({'invoice':_0x25fc0f,'customer':_0x5484b8['body'][_0x1c8600(0x20c)],'date':_0x183c43,'warehouse_name':_0x3143b3,'room':_0x5587c0,'ToWarehouse':_0x49dc91,'ToRoom':_0x3a8b14,'return_sale':_0x31e6dc,'note':_0x101972,'warehouse_cat':_0x2bf512}),_0x39df70=await _0x60cc08[_0x1c8600(0x17f)](),_0x4cbcb8=await sales_return_finished['findOne']({'invoice':_0x25fc0f}),_0x39feac=await warehouse['findOne']({'name':_0x49dc91,'room':_0x3a8b14,'warehouse_category':_0x1c8600(0x23e)});_0x4cbcb8['return_sale']['forEach'](_0x112566=>{var _0x2c60fd=_0x1c8600,_0x3d5363=0x0;const _0x501f9f=_0x39feac[_0x2c60fd(0x21e)]['map'](_0x24a624=>{var _0x52426c=_0x2c60fd;_0x24a624['product_name']==_0x112566[_0x52426c(0x243)]&&_0x24a624[_0x52426c(0x19b)]==_0x112566[_0x52426c(0x19b)]&&_0x24a624[_0x52426c(0x1d1)]==_0x112566['expiry_date']&&_0x24a624[_0x52426c(0x262)]==_0x112566[_0x52426c(0x262)]&&_0x24a624['batch_code']==_0x112566[_0x52426c(0x1fd)]&&(_0x24a624['product_stock']=parseInt(_0x24a624[_0x52426c(0x220)])+parseInt(_0x112566[_0x52426c(0x23b)]),_0x3d5363++);});_0x3d5363=='0'&&(_0x39feac['product_details']=_0x39feac[_0x2c60fd(0x21e)][_0x2c60fd(0x16b)]({'product_name':_0x112566[_0x2c60fd(0x243)],'product_stock':_0x112566[_0x2c60fd(0x23b)],'primary_code':_0x112566[_0x2c60fd(0x269)],'secondary_code':_0x112566[_0x2c60fd(0x258)],'product_code':_0x112566[_0x2c60fd(0x240)],'bay':_0x112566['bay'],'batch_code':_0x112566['batch_code'],'maxPerUnit':_0x112566['maxPerUnit'],'production_date':_0x112566[_0x2c60fd(0x262)],'expiry_date':_0x112566['expiry_date'],'secondary_unit':_0x112566['secondary_unit'],'unit':_0x112566['unit'],'maxProducts':_0x112566[_0x2c60fd(0x25c)]}));}),await _0x39feac[_0x1c8600(0x17f)](),console[_0x1c8600(0x24d)](_0x5484b8['body']);const _0x1c958b=new c_payment_data({'invoice':_0x25fc0f,'customer':_0x5484b8['body'][_0x1c8600(0x20c)],'reason':_0x1c8600(0x19d)});await _0x1c958b[_0x1c8600(0x17f)]();const _0x1f5540=await master_shop['find']();console[_0x1c8600(0x24d)]('add\x20post',_0x1f5540[0x0][_0x1c8600(0x1ba)]);const _0x3db59f=await email_settings[_0x1c8600(0x155)](),_0x54c4a7=await customer[_0x1c8600(0x155)]({'name':_0x5484b8[_0x1c8600(0x1b3)][_0x1c8600(0x20c)]});console[_0x1c8600(0x24d)](_0x1c8600(0x179),_0x54c4a7);_0x1f5540[0x0][_0x1c8600(0x1f0)]==0x1?(right_currency=_0x1f5540[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x1f5540[0x0][_0x1c8600(0x263)]);var _0x5ccbf7=_0x1d69f2,_0x3fec21=_0x3d1dad,_0x1920f4='',_0x22893b;for(_0x22893b in _0x5ccbf7){_0x1920f4+=_0x1c8600(0x270)+_0x1c8600(0x20f)+_0x5ccbf7[_0x22893b]+_0x1c8600(0x1f6)+_0x1c8600(0x20f)+_0x3fec21[_0x22893b]+_0x1c8600(0x1f6)+_0x1c8600(0x20a);}console['log'](_0x1c8600(0x1e2),_0x1920f4);let _0x511de3=nodemailer[_0x1c8600(0x23d)]({'service':_0x1c8600(0x17e),'auth':{'user':_0x3db59f[_0x1c8600(0x1b0)],'pass':_0x3db59f['password']}}),_0x27d56a={'from':_0x3db59f[_0x1c8600(0x1b0)],'to':_0x54c4a7[_0x1c8600(0x1b0)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x1c8600(0x233),'path':__dirname+'/../public'+_0x1c8600(0x1cd)+_0x1f5540[0x0][_0x1c8600(0x1ba)],'cid':_0x1c8600(0x205)}],'html':_0x1c8600(0x1eb)+_0x1c8600(0x242)+'</head><body>'+'<div>'+_0x1c8600(0x21b)+_0x1c8600(0x1ae)+_0x1c8600(0x20b)+_0x1c8600(0x173)+_0x1c8600(0x1ae)+_0x1c8600(0x1aa)+_0x1f5540[0x0]['site_title']+'\x20</h2>'+_0x1c8600(0x173)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x1c8600(0x1ae)+_0x1c8600(0x199)+_0x1c8600(0x1f1)+_0x25fc0f+'\x20'+_0x1c8600(0x265)+_0x1c8600(0x184)+_0x183c43+'\x20'+_0x1c8600(0x236)+_0x1c8600(0x206)+_0x1c8600(0x173)+_0x1c8600(0x1f5)+_0x1c8600(0x19e)+_0x1c8600(0x270)+_0x1c8600(0x15a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x1c8600(0x21c)+_0x1c8600(0x252)+_0x1c8600(0x20a)+_0x1c8600(0x16e)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1920f4+'\x20'+_0x1c8600(0x1c5)+'</table>'+_0x1c8600(0x1ae)+_0x1c8600(0x158)+'<h5>'+_0x1f5540[0x0][_0x1c8600(0x17c)]+_0x1c8600(0x206)+_0x1c8600(0x173)+_0x1c8600(0x173)+'</body></html>'};_0x511de3['sendMail'](_0x27d56a,function(_0x3f9ba2,_0x613061){var _0x4dedc4=_0x1c8600;_0x3f9ba2?(console[_0x4dedc4(0x24d)](_0x3f9ba2),console['log']('Error\x20Occurs')):console[_0x4dedc4(0x24d)](_0x4dedc4(0x1dd));}),_0x5484b8[_0x1c8600(0x1ea)](_0x1c8600(0x22a),_0x1c8600(0x186)),_0x2f3e71['redirect'](_0x1c8600(0x182));}catch(_0x15cee6){console[_0x1c8600(0x24d)](_0x15cee6),_0x2f3e71['status'](0xc8)['json']({'message1':_0x15cee6[_0x1c8600(0x22d)]});}}}),router[a0_0x9b60ca(0x230)](a0_0x9b60ca(0x18a),auth,async(_0x5b78b2,_0xacfe4e)=>{var _0x4de8d8=a0_0x9b60ca;try{const {username:_0x1679e6,email:_0x1b7457,role:_0x32b93f}=_0x5b78b2['user'],_0x1a77d6=_0x5b78b2[_0x4de8d8(0x1db)],_0x1fd38b=await profile['findOne']({'email':_0x1a77d6['email']}),_0x51c434=await master_shop[_0x4de8d8(0x23f)]();console[_0x4de8d8(0x24d)](_0x4de8d8(0x1c9),_0x51c434);const _0x2e2cb2=_0x5b78b2[_0x4de8d8(0x1a3)]['id'],_0x3c9410=await sales['findById'](_0x2e2cb2);console[_0x4de8d8(0x24d)](_0x4de8d8(0x215),_0x3c9410);if(_0x51c434[0x0][_0x4de8d8(0x21d)]==_0x4de8d8(0x24b))var _0x53d958=users['English'];else{if(_0x51c434[0x0][_0x4de8d8(0x21d)]=='Hindi')var _0x53d958=users[_0x4de8d8(0x1d6)];else{if(_0x51c434[0x0][_0x4de8d8(0x21d)]==_0x4de8d8(0x188))var _0x53d958=users[_0x4de8d8(0x188)];else{if(_0x51c434[0x0][_0x4de8d8(0x21d)]=='Spanish')var _0x53d958=users[_0x4de8d8(0x273)];else{if(_0x51c434[0x0][_0x4de8d8(0x21d)]==_0x4de8d8(0x1c6))var _0x53d958=users[_0x4de8d8(0x1c6)];else{if(_0x51c434[0x0][_0x4de8d8(0x21d)]==_0x4de8d8(0x1e8))var _0x53d958=users[_0x4de8d8(0x1e9)];else{if(_0x51c434[0x0]['language']==_0x4de8d8(0x1a7))var _0x53d958=users[_0x4de8d8(0x1a7)];else{if(_0x51c434[0x0]['language']==_0x4de8d8(0x1a0))var _0x53d958=users[_0x4de8d8(0x25d)];}}}}}}}_0xacfe4e[_0x4de8d8(0x24f)](_0x4de8d8(0x20d),{'success':_0x5b78b2[_0x4de8d8(0x1ea)](_0x4de8d8(0x22a)),'errors':_0x5b78b2[_0x4de8d8(0x1ea)](_0x4de8d8(0x1f9)),'role':_0x1a77d6,'profile':_0x1fd38b,'alldata':_0x3c9410,'master_shop':_0x51c434,'language':_0x53d958});}catch(_0x3c4ed8){console['log'](_0x3c4ed8);}}),router[a0_0x9b60ca(0x1da)](a0_0x9b60ca(0x241),async(_0x5f3859,_0x4600a5)=>{var _0x451e19=a0_0x9b60ca;const {product_code:_0x44408b,warehouse_name:_0x4c2f30,rooms_data:_0x32fff9,Roomslist:_0x1b5330,sales_category:_0x13a672}=_0x5f3859[_0x451e19(0x1b3)],_0x2bb7a8=_0x1b5330[_0x451e19(0x213)](','),_0x46a470=[];async function _0x2ef6ab(_0x5aeb3d){var _0x2922e7=_0x451e19;const _0xa788ac=await warehouse['aggregate']([{'$match':{'name':_0x4c2f30,'room':_0x5aeb3d}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x44408b}},{'$group':{'_id':_0x2922e7(0x171),'name':{'$first':_0x2922e7(0x246)},'product_stock':{'$first':_0x2922e7(0x257)},'primary_code':{'$first':_0x2922e7(0x239)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x2922e7(0x203)},'bay':{'$first':_0x2922e7(0x234)},'type':{'$first':_0x2922e7(0x1ad)},'pallet':{'$first':_0x2922e7(0x204)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2922e7(0x1a1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2922e7(0x26d)},'maxPerUnit':{'$first':_0x2922e7(0x1b5)},'batch_code':{'$first':_0x2922e7(0x1be)},'product_cat':{'$first':_0x2922e7(0x24a)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x2922e7(0x1b8)},'uuid':{'$first':_0x2922e7(0x1e0)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x2922e7(0x18b)}}}]),_0x45cf53=await warehouse[_0x2922e7(0x160)]([{'$match':{'name':_0x4c2f30,'room':_0x5aeb3d}},{'$unwind':_0x2922e7(0x17a)},{'$match':{'product_details.secondary_code':_0x44408b}},{'$group':{'_id':_0x2922e7(0x171),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2922e7(0x257)},'primary_code':{'$first':_0x2922e7(0x239)},'secondary_code':{'$first':_0x2922e7(0x1ed)},'product_code':{'$first':_0x2922e7(0x1af)},'level':{'$first':_0x2922e7(0x234)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x2922e7(0x1ad)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2922e7(0x22b)},'storage':{'$first':_0x2922e7(0x1ef)},'rack':{'$first':_0x2922e7(0x1a1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2922e7(0x26d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2922e7(0x1b7)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x2922e7(0x1e0)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x2922e7(0x18b)}}}]);if(_0xa788ac[_0x2922e7(0x23c)]>0x0)_0x46a470[_0x2922e7(0x1e5)](_0xa788ac);else _0x45cf53[_0x2922e7(0x23c)]>0x0&&_0x46a470[_0x2922e7(0x1e5)](_0x45cf53);}const _0xedaad9=_0x2bb7a8[_0x451e19(0x1cc)](_0x27a682=>_0x2ef6ab(_0x27a682));await Promise[_0x451e19(0x175)](_0xedaad9),_0x4600a5[_0x451e19(0x224)](_0x46a470);}),router[a0_0x9b60ca(0x1da)](a0_0x9b60ca(0x1cf),async(_0x14829e,_0x140ad1)=>{var _0x563e92=a0_0x9b60ca;const {product_code:_0x484648,warehouse_name:_0x4975d2,rooms_data:_0x158384,Roomslist:_0x4289fc,sales_category:_0x91168c}=_0x14829e['body'],_0x2480aa=_0x4289fc['split'](','),_0x27d0b3=[];async function _0x351781(_0x31bb4a){var _0x21c01f=a0_0x1872;const _0x17cb29=await warehouse[_0x21c01f(0x160)]([{'$match':{'name':_0x4975d2,'room':_0x31bb4a}},{'$unwind':_0x21c01f(0x17a)},{'$match':{'product_details.primary_code':_0x484648,'product_details.sales_category':_0x91168c,'product_details.type_products':_0x21c01f(0x24d)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x21c01f(0x257)},'primary_code':{'$first':_0x21c01f(0x239)},'secondary_code':{'$first':_0x21c01f(0x1ed)},'product_code':{'$first':_0x21c01f(0x1af)},'level':{'$first':_0x21c01f(0x203)},'bay':{'$first':_0x21c01f(0x234)},'type':{'$first':_0x21c01f(0x1ad)},'pallet':{'$first':_0x21c01f(0x204)},'unit':{'$first':_0x21c01f(0x225)},'secondary_unit':{'$first':_0x21c01f(0x22b)},'storage':{'$first':_0x21c01f(0x1ef)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x21c01f(0x187)},'production_date':{'$first':_0x21c01f(0x26d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x21c01f(0x1be)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x21c01f(0x1b8)},'uuid':{'$first':_0x21c01f(0x1e0)},'gross_price':{'$first':_0x21c01f(0x1c4)},'sales_category':{'$first':_0x21c01f(0x18b)},'type_products':{'$first':'$product_details.type_products'}}}]);console[_0x21c01f(0x24d)](_0x21c01f(0x24d)+_0x21c01f(0x180)+_0x484648+'\x20<>\x20'+_0x91168c);const _0x4c2bef=await warehouse['aggregate']([{'$match':{'name':_0x4975d2,'room':_0x31bb4a}},{'$unwind':_0x21c01f(0x17a)},{'$match':{'product_details.secondary_code':_0x484648,'product_details.sales_category':_0x91168c,'product_details.type_products':_0x21c01f(0x24d)}},{'$group':{'_id':_0x21c01f(0x171),'name':{'$first':_0x21c01f(0x246)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x21c01f(0x239)},'secondary_code':{'$first':_0x21c01f(0x1ed)},'product_code':{'$first':_0x21c01f(0x1af)},'level':{'$first':_0x21c01f(0x234)},'isle':{'$first':_0x21c01f(0x229)},'type':{'$first':_0x21c01f(0x1ad)},'pallet':{'$first':_0x21c01f(0x204)},'unit':{'$first':_0x21c01f(0x225)},'secondary_unit':{'$first':_0x21c01f(0x22b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x21c01f(0x1a1)},'expiry_date':{'$first':_0x21c01f(0x187)},'production_date':{'$first':_0x21c01f(0x26d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x21c01f(0x1be)},'product_cat':{'$first':_0x21c01f(0x24a)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x21c01f(0x1b7)},'invoice':{'$first':_0x21c01f(0x1b8)},'uuid':{'$first':_0x21c01f(0x1e0)},'gross_price':{'$first':_0x21c01f(0x1c4)},'sales_category':{'$first':_0x21c01f(0x18b)},'type_products':{'$first':_0x21c01f(0x1ff)}}}]);if(_0x17cb29['length']>0x0)_0x27d0b3[_0x21c01f(0x1e5)](_0x17cb29);else _0x4c2bef[_0x21c01f(0x23c)]>0x0&&_0x27d0b3[_0x21c01f(0x1e5)](_0x4c2bef);}const _0x3d3113=_0x2480aa[_0x563e92(0x1cc)](_0x3706b5=>_0x351781(_0x3706b5));await Promise[_0x563e92(0x175)](_0x3d3113),_0x140ad1[_0x563e92(0x224)](_0x27d0b3);}),module['exports']=router;