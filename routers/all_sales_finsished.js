var a0_0x3b0c45=a0_0x5189;(function(_0x54d87b,_0x20205d){var _0x3ceaaa=a0_0x5189,_0x1b9509=_0x54d87b();while(!![]){try{var _0x278077=-parseInt(_0x3ceaaa(0x1e0))/0x1*(-parseInt(_0x3ceaaa(0x1a7))/0x2)+-parseInt(_0x3ceaaa(0x29a))/0x3+-parseInt(_0x3ceaaa(0x2b0))/0x4*(parseInt(_0x3ceaaa(0x256))/0x5)+-parseInt(_0x3ceaaa(0x224))/0x6+-parseInt(_0x3ceaaa(0x210))/0x7+-parseInt(_0x3ceaaa(0x19d))/0x8+parseInt(_0x3ceaaa(0x27f))/0x9;if(_0x278077===_0x20205d)break;else _0x1b9509['push'](_0x1b9509['shift']());}catch(_0x1a9ec7){_0x1b9509['push'](_0x1b9509['shift']());}}}(a0_0x83c8,0x33a23));const express=require(a0_0x3b0c45(0x2b3)),app=express(),router=express[a0_0x3b0c45(0x266)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require(a0_0x3b0c45(0x2ab)),auth=require(a0_0x3b0c45(0x2d5)),nodemailer=require('nodemailer'),users=require(a0_0x3b0c45(0x1ea)),mongoose=require('mongoose');router[a0_0x3b0c45(0x1f7)](a0_0x3b0c45(0x24b),auth,async(_0x1abdb7,_0x28fd37)=>{var _0x2a1152=a0_0x3b0c45;try{const {username:_0x1330d6,email:_0x35750b,role:_0x4d7569}=_0x1abdb7['user'],_0x2abb96=_0x1abdb7[_0x2a1152(0x27c)],_0xb1011b=await profile[_0x2a1152(0x1e4)]({'email':_0x2abb96['email']}),_0xd22717=await master_shop['find']();let _0x220d50;if(_0x2abb96[_0x2a1152(0x2b7)]=='staff'){const _0x217e01=await staff['findOne']({'email':_0x2abb96['email']});_0x220d50=await sales_finished[_0x2a1152(0x1f8)]([{'$match':{'typeOfProducts':_0x2a1152(0x18a)}},{'$unwind':_0x2a1152(0x25e)},{'$group':{'_id':'$_id','invoice':{'$first':_0x2a1152(0x2cb)},'customers':{'$first':_0x2a1152(0x1bb)},'date':{'$first':_0x2a1152(0x2ad)},'warehouse_name':{'$first':_0x2a1152(0x1ed)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x2a1152(0x291)},'return_data':{'$first':_0x2a1152(0x275)},'customers_docs':{'$first':_0x2a1152(0x23c)},'total_saleproduct_quantity':{'$sum':_0x2a1152(0x241)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x2a1152(0x2be)},'type':{'$addToSet':_0x2a1152(0x282)},'pallet':{'$addToSet':_0x2a1152(0x1de)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x220d50=await sales_finished[_0x2a1152(0x1f8)]([{'$match':{'typeOfProducts':'own'}},{'$unwind':_0x2a1152(0x25e)},{'$group':{'_id':_0x2a1152(0x1fb),'invoice':{'$first':_0x2a1152(0x2cb)},'customers':{'$first':'$customer'},'date':{'$first':_0x2a1152(0x2ad)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x2a1152(0x25e)},'note':{'$first':_0x2a1152(0x291)},'return_data':{'$first':_0x2a1152(0x275)},'customers_docs':{'$first':_0x2a1152(0x23c)},'total_saleproduct_quantity':{'$sum':_0x2a1152(0x241)},'level':{'$addToSet':_0x2a1152(0x2c9)},'isle':{'$addToSet':_0x2a1152(0x2be)},'type':{'$addToSet':_0x2a1152(0x282)},'pallet':{'$addToSet':_0x2a1152(0x1de)},'finalize':{'$first':_0x2a1152(0x2ca)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0xd22717[0x0][_0x2a1152(0x222)]==_0x2a1152(0x255)){var _0x291bce=users[_0x2a1152(0x29d)];console['log'](_0x291bce);}else{if(_0xd22717[0x0][_0x2a1152(0x222)]=='Hindi')var _0x291bce=users[_0x2a1152(0x2ce)];else{if(_0xd22717[0x0][_0x2a1152(0x222)]=='German')var _0x291bce=users[_0x2a1152(0x2a4)];else{if(_0xd22717[0x0][_0x2a1152(0x222)]==_0x2a1152(0x1fa))var _0x291bce=users['Spanish'];else{if(_0xd22717[0x0][_0x2a1152(0x222)]==_0x2a1152(0x1da))var _0x291bce=users['French'];else{if(_0xd22717[0x0]['language']==_0x2a1152(0x1bf))var _0x291bce=users['Portuguese'];else{if(_0xd22717[0x0]['language']==_0x2a1152(0x1a0))var _0x291bce=users[_0x2a1152(0x1a0)];else{if(_0xd22717[0x0][_0x2a1152(0x222)]=='Arabic\x20(ae)')var _0x291bce=users['Arabic'];}}}}}}}_0x28fd37[_0x2a1152(0x1f0)]('all_sales_finished',{'success':_0x1abdb7[_0x2a1152(0x1a3)]('success'),'errors':_0x1abdb7['flash'](_0x2a1152(0x205)),'sales':_0x220d50,'profile':_0xb1011b,'role':_0x2abb96,'master_shop':_0xd22717,'language':_0x291bce});}catch(_0x2acd98){console['log'](_0x2acd98);}}),router['get'](a0_0x3b0c45(0x226),auth,async(_0x233efb,_0xbab2c6)=>{var _0x24dea7=a0_0x3b0c45;try{const {username:_0x4a4e58,email:_0x1fd762,role:_0x4e5591}=_0x233efb[_0x24dea7(0x27c)],_0x198573=_0x233efb[_0x24dea7(0x27c)],_0x46a59c=await profile[_0x24dea7(0x1e4)]({'email':_0x198573[_0x24dea7(0x1b6)]}),_0x126ff7=await master_shop[_0x24dea7(0x223)]();let _0x343345;if(_0x198573['role']==_0x24dea7(0x230)){const _0x39206b=await staff[_0x24dea7(0x1e4)]({'email':_0x198573[_0x24dea7(0x1b6)]});_0x343345=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x24dea7(0x1b5)}},{'$unwind':_0x24dea7(0x25e)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':_0x24dea7(0x1bb)},'date':{'$first':_0x24dea7(0x2ad)},'warehouse_name':{'$first':_0x24dea7(0x1ed)},'sale_product':{'$push':_0x24dea7(0x25e)},'note':{'$first':_0x24dea7(0x291)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x24dea7(0x23c)},'total_saleproduct_quantity':{'$sum':_0x24dea7(0x241)},'level':{'$addToSet':_0x24dea7(0x2c9)},'isle':{'$addToSet':_0x24dea7(0x2be)},'type':{'$addToSet':_0x24dea7(0x282)},'pallet':{'$addToSet':_0x24dea7(0x1de)},'finalize':{'$first':_0x24dea7(0x2ca)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x343345=await sales_finished[_0x24dea7(0x1f8)]([{'$match':{'typeOfProducts':_0x24dea7(0x1b5)}},{'$unwind':_0x24dea7(0x25e)},{'$group':{'_id':_0x24dea7(0x1fb),'invoice':{'$first':_0x24dea7(0x2cb)},'customers':{'$first':_0x24dea7(0x1bb)},'date':{'$first':_0x24dea7(0x2ad)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x24dea7(0x291)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x24dea7(0x23c)},'total_saleproduct_quantity':{'$sum':_0x24dea7(0x241)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x24dea7(0x2be)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x24dea7(0x2ca)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x126ff7[0x0][_0x24dea7(0x222)]==_0x24dea7(0x255)){var _0x16df51=users[_0x24dea7(0x29d)];console[_0x24dea7(0x2ac)](_0x16df51);}else{if(_0x126ff7[0x0][_0x24dea7(0x222)]==_0x24dea7(0x2ce))var _0x16df51=users[_0x24dea7(0x2ce)];else{if(_0x126ff7[0x0][_0x24dea7(0x222)]=='German')var _0x16df51=users[_0x24dea7(0x2a4)];else{if(_0x126ff7[0x0]['language']==_0x24dea7(0x1fa))var _0x16df51=users[_0x24dea7(0x1fa)];else{if(_0x126ff7[0x0][_0x24dea7(0x222)]==_0x24dea7(0x1da))var _0x16df51=users[_0x24dea7(0x1da)];else{if(_0x126ff7[0x0][_0x24dea7(0x222)]=='Portuguese\x20(BR)')var _0x16df51=users[_0x24dea7(0x24f)];else{if(_0x126ff7[0x0][_0x24dea7(0x222)]==_0x24dea7(0x1a0))var _0x16df51=users[_0x24dea7(0x1a0)];else{if(_0x126ff7[0x0][_0x24dea7(0x222)]==_0x24dea7(0x20e))var _0x16df51=users['Arabic'];}}}}}}}_0xbab2c6[_0x24dea7(0x1f0)](_0x24dea7(0x1a1),{'success':_0x233efb[_0x24dea7(0x1a3)](_0x24dea7(0x28c)),'errors':_0x233efb[_0x24dea7(0x1a3)]('errors'),'sales':_0x343345,'profile':_0x46a59c,'role':_0x198573,'master_shop':_0x126ff7,'language':_0x16df51});}catch(_0x179741){console[_0x24dea7(0x2ac)](_0x179741);}});async function getRandom8DigitNumber(){var _0x4b8493=a0_0x3b0c45;const _0x519c49=0x989680,_0xa8b5c8=0x5f5e0ff,_0x3d5b26=Math[_0x4b8493(0x1f3)](Math[_0x4b8493(0x28d)]()*(_0xa8b5c8-_0x519c49+0x1))+_0x519c49;var _0x393bbc;const _0x153b28=await sales_finished[_0x4b8493(0x1e4)]({'invoice':_0x4b8493(0x2cd)+_0x3d5b26});return _0x153b28&&_0x153b28[_0x4b8493(0x1cf)]>0x0?_0x393bbc='OUTF-'+_0x3d5b26:_0x393bbc=_0x4b8493(0x2cd)+_0x3d5b26,_0x393bbc;}router[a0_0x3b0c45(0x1f7)](a0_0x3b0c45(0x1a6),auth,async(_0x26c64f,_0x519f76)=>{var _0x407211=a0_0x3b0c45;try{const {username:_0x45b1bf,email:_0x3753dc,role:_0xb5af08}=_0x26c64f[_0x407211(0x27c)],_0x1bc717=_0x26c64f[_0x407211(0x27c)],_0x2a8b71=await profile[_0x407211(0x1e4)]({'email':_0x1bc717[_0x407211(0x1b6)]}),_0x5c471e=await master_shop[_0x407211(0x223)](),_0x113ec1=await customer[_0x407211(0x223)]({});let _0x1c46ea;if(_0x1bc717[_0x407211(0x2b7)]==_0x407211(0x230)){const _0x49f597=await staff[_0x407211(0x1e4)]({'email':_0x1bc717['email']});_0x1c46ea=await warehouse[_0x407211(0x1f8)]([{'$match':{'status':_0x407211(0x203),'name':_0x49f597[_0x407211(0x1c8)]}},{'$group':{'_id':'$name','name':{'$first':_0x407211(0x248)}}},{'$sort':{'name':0x1}}]);}else _0x1c46ea=await warehouse['aggregate']([{'$match':{'status':_0x407211(0x203)}},{'$group':{'_id':_0x407211(0x248),'name':{'$first':_0x407211(0x248)}}},{'$sort':{'name':0x1}}]);const _0x314e7f=await product[_0x407211(0x223)]({});var _0x2a9b24=[_0x407211(0x2c0),_0x407211(0x286)];const _0x27eb99=await sales_finished[_0x407211(0x223)]({}),_0x3e6753=_0x27eb99['length']+0x1,_0x41f563='OUTF-'+_0x3e6753[_0x407211(0x21b)]()[_0x407211(0x19e)](0x5,'0');if(_0x5c471e[0x0][_0x407211(0x222)]==_0x407211(0x255)){var _0x1b994e=users[_0x407211(0x29d)];console[_0x407211(0x2ac)](_0x1b994e);}else{if(_0x5c471e[0x0][_0x407211(0x222)]=='Hindi')var _0x1b994e=users['Hindi'];else{if(_0x5c471e[0x0][_0x407211(0x222)]==_0x407211(0x2a4))var _0x1b994e=users['German'];else{if(_0x5c471e[0x0]['language']==_0x407211(0x1fa))var _0x1b994e=users[_0x407211(0x1fa)];else{if(_0x5c471e[0x0][_0x407211(0x222)]==_0x407211(0x1da))var _0x1b994e=users[_0x407211(0x1da)];else{if(_0x5c471e[0x0]['language']=='Portuguese\x20(BR)')var _0x1b994e=users[_0x407211(0x24f)];else{if(_0x5c471e[0x0][_0x407211(0x222)]==_0x407211(0x1a0))var _0x1b994e=users[_0x407211(0x1a0)];else{if(_0x5c471e[0x0][_0x407211(0x222)]==_0x407211(0x20e))var _0x1b994e=users[_0x407211(0x1c1)];}}}}}}}const _0x13f1da=getRandom8DigitNumber();_0x13f1da[_0x407211(0x289)](_0x220160=>{var _0x8fd50=_0x407211;_0x519f76[_0x8fd50(0x1f0)](_0x8fd50(0x2c4),{'success':_0x26c64f[_0x8fd50(0x1a3)]('success'),'errors':_0x26c64f[_0x8fd50(0x1a3)](_0x8fd50(0x205)),'role':_0x1bc717,'profile':_0x2a8b71,'customer':_0x113ec1,'warehouse':_0x1c46ea,'product':_0x314e7f,'invoice':_0x220160,'master_shop':_0x5c471e,'language':_0x1b994e,'rooms_data':_0x2a9b24});})['catch'](_0x165fa9=>{var _0x16bf3e=_0x407211;_0x26c64f[_0x16bf3e(0x1a3)]('errors',_0x16bf3e(0x1a5)),_0x519f76[_0x16bf3e(0x1e9)](_0x16bf3e(0x216));});}catch(_0xe51b47){console[_0x407211(0x2ac)](_0xe51b47);}}),router['get'](a0_0x3b0c45(0x22e),auth,async(_0x32d3a2,_0xbdc85)=>{var _0x4ecdb8=a0_0x3b0c45;try{const {username:_0x539777,email:_0x332db4,role:_0x1d1520}=_0x32d3a2[_0x4ecdb8(0x27c)],_0x423c89=_0x32d3a2[_0x4ecdb8(0x27c)],_0x4c24b9=await profile[_0x4ecdb8(0x1e4)]({'email':_0x423c89[_0x4ecdb8(0x1b6)]}),_0x142e64=await master_shop[_0x4ecdb8(0x223)](),_0x2868d1=await customer[_0x4ecdb8(0x223)]({});let _0x1fe847;if(_0x423c89['role']==_0x4ecdb8(0x230)){const _0x5cb872=await staff[_0x4ecdb8(0x1e4)]({'email':_0x423c89['email']});_0x1fe847=await warehouse[_0x4ecdb8(0x1f8)]([{'$match':{'status':_0x4ecdb8(0x203),'name':_0x5cb872['warehouse']}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x1fe847=await warehouse[_0x4ecdb8(0x1f8)]([{'$match':{'status':_0x4ecdb8(0x203)}},{'$group':{'_id':_0x4ecdb8(0x248),'name':{'$first':_0x4ecdb8(0x248)}}},{'$sort':{'name':0x1}}]);const _0x47f5a9=await product['find']({});var _0x551327=[_0x4ecdb8(0x2c0),'Enclosed'];const _0x3dd06=await sales_finished[_0x4ecdb8(0x223)]({}),_0x3574f9=_0x3dd06['length']+0x1,_0x548d06=_0x4ecdb8(0x2cd)+_0x3574f9['toString']()[_0x4ecdb8(0x19e)](0x5,'0');if(_0x142e64[0x0]['language']=='English\x20(US)'){var _0x123d1b=users[_0x4ecdb8(0x29d)];console[_0x4ecdb8(0x2ac)](_0x123d1b);}else{if(_0x142e64[0x0][_0x4ecdb8(0x222)]==_0x4ecdb8(0x2ce))var _0x123d1b=users[_0x4ecdb8(0x2ce)];else{if(_0x142e64[0x0][_0x4ecdb8(0x222)]==_0x4ecdb8(0x2a4))var _0x123d1b=users[_0x4ecdb8(0x2a4)];else{if(_0x142e64[0x0]['language']=='Spanish')var _0x123d1b=users[_0x4ecdb8(0x1fa)];else{if(_0x142e64[0x0][_0x4ecdb8(0x222)]==_0x4ecdb8(0x1da))var _0x123d1b=users['French'];else{if(_0x142e64[0x0][_0x4ecdb8(0x222)]=='Portuguese\x20(BR)')var _0x123d1b=users[_0x4ecdb8(0x24f)];else{if(_0x142e64[0x0][_0x4ecdb8(0x222)]==_0x4ecdb8(0x1a0))var _0x123d1b=users[_0x4ecdb8(0x1a0)];else{if(_0x142e64[0x0][_0x4ecdb8(0x222)]=='Arabic\x20(ae)')var _0x123d1b=users[_0x4ecdb8(0x1c1)];}}}}}}}const _0x1a3383=getRandom8DigitNumber();_0x1a3383[_0x4ecdb8(0x289)](_0x2cf03e=>{var _0x17a4b0=_0x4ecdb8;_0xbdc85[_0x17a4b0(0x1f0)](_0x17a4b0(0x1d1),{'success':_0x32d3a2[_0x17a4b0(0x1a3)](_0x17a4b0(0x28c)),'errors':_0x32d3a2[_0x17a4b0(0x1a3)](_0x17a4b0(0x205)),'role':_0x423c89,'profile':_0x4c24b9,'customer':_0x2868d1,'warehouse':_0x1fe847,'product':_0x47f5a9,'invoice':_0x2cf03e,'master_shop':_0x142e64,'language':_0x123d1b,'rooms_data':_0x551327});})[_0x4ecdb8(0x1e1)](_0x351e34=>{var _0x4f0152=_0x4ecdb8;_0x32d3a2[_0x4f0152(0x1a3)]('errors',_0x4f0152(0x1a5)),_0xbdc85['redirect'](_0x4f0152(0x216));});}catch(_0x5ee9d0){console[_0x4ecdb8(0x2ac)](_0x5ee9d0);}}),router[a0_0x3b0c45(0x2b8)](a0_0x3b0c45(0x22e),auth,async(_0x4c9f7d,_0x4c3b04)=>{var _0x259c40=a0_0x3b0c45;try{const {invoice:_0x581df7,date:_0xda3d98,warehouse_name:_0x130543,product_name:_0x14ba65,note:_0x19a665,room:_0x500ca3,primary_code:_0x460c79,secondary_code:_0x18ced6,prod_code:_0x47a35c,SCRN:_0xa211e1,ReqBy:_0x53aae8,dateofreq:_0x12e80c,PO_number:_0x3d1b6b,typeservicesData:_0x10f5b3,typevehicle:_0x56d288,destination:_0x124074,deliverydate:_0xb5d60d,driver:_0x71dd16,plate:_0x542357,van:_0x5143ba,DRSI:_0x5643f1,TSU:_0x2bac34,TFU:_0x28207d,mode_transpo:_0x38adf0,name_driver:_0x4c6db4,type_of_products:_0x3db2da}=_0x4c9f7d[_0x259c40(0x25d)];if(typeof _0x14ba65==_0x259c40(0x196))var _0x1c7d61=[_0x4c9f7d['body'][_0x259c40(0x2a9)]],_0x57ba2a=[_0x4c9f7d['body'][_0x259c40(0x26d)]],_0x5416d4=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x22c)]],_0xd9ce59=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x2bb)]],_0x39ce0d=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x298)]],_0x5c2be5=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x2ba)]],_0xb8f3b4=[_0x4c9f7d[_0x259c40(0x25d)]['level2']],_0x27fd37=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x199)]],_0x44aaa6=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x198)]],_0x378318=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x26f)]],_0x8c69cf=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x25a)]],_0x738f76=[_0x4c9f7d['body'][_0x259c40(0x1a9)]],_0x2905a2=[_0x4c9f7d[_0x259c40(0x25d)]['max_per_unit']],_0x2fe357=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x225)]],_0x5cd482=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x215)]],_0x33bace=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x2bc)]],_0x116a82=[_0x4c9f7d['body'][_0x259c40(0x287)]],_0x5727cf=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x21f)]],_0x4480e3=[_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x23b)]];else var _0x1c7d61=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x2a9)]],_0x57ba2a=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x26d)]],_0x5416d4=[..._0x4c9f7d[_0x259c40(0x25d)]['carton']],_0xd9ce59=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x2bb)]],_0x39ce0d=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x298)]],_0x5c2be5=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x2ba)]],_0xb8f3b4=[..._0x4c9f7d['body'][_0x259c40(0x22d)]],_0x27fd37=[..._0x4c9f7d['body'][_0x259c40(0x199)]],_0x44aaa6=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x198)]],_0x378318=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x26f)]],_0x8c69cf=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x25a)]],_0x738f76=[..._0x4c9f7d['body'][_0x259c40(0x1a9)]],_0x2905a2=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x24e)]],_0x2fe357=[..._0x4c9f7d['body'][_0x259c40(0x225)]],_0x5cd482=[..._0x4c9f7d[_0x259c40(0x25d)]['RoomAssigned']],_0x33bace=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x2bc)]],_0x116a82=[..._0x4c9f7d['body'][_0x259c40(0x287)]],_0x5727cf=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x21f)]],_0x4480e3=[..._0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x23b)]];const _0x2fb529=_0x1c7d61[_0x259c40(0x2b4)](_0x5bc0d9=>{return _0x5bc0d9={'product_name':_0x5bc0d9};});_0x57ba2a[_0x259c40(0x284)]((_0x3d2bc4,_0x251f1c)=>{_0x2fb529[_0x251f1c]['stock']=_0x3d2bc4;}),_0x5416d4[_0x259c40(0x284)]((_0x28435c,_0x504a22)=>{var _0x482b88=_0x259c40;_0x2fb529[_0x504a22][_0x482b88(0x19a)]=Math[_0x482b88(0x18f)](_0x28435c);}),_0x1c7d61[_0x259c40(0x284)]((_0x346468,_0x36de1f)=>{var _0x288b67=_0x259c40;_0x2fb529[_0x36de1f][_0x288b67(0x188)]=_0x4c9f7d[_0x288b67(0x25d)][_0x288b67(0x268)];}),_0x4480e3[_0x259c40(0x284)]((_0x3f63e3,_0x3e5a56)=>{var _0xbccb11=_0x259c40;_0x2fb529[_0x3e5a56][_0xbccb11(0x23b)]=_0x3f63e3;}),_0x5727cf[_0x259c40(0x284)]((_0x385fb1,_0x71b590)=>{var _0x49d4b8=_0x259c40;_0x2fb529[_0x71b590][_0x49d4b8(0x21f)]=_0x385fb1;}),_0x116a82[_0x259c40(0x284)]((_0x23b575,_0x43d55c)=>{var _0x108835=_0x259c40;_0x2fb529[_0x43d55c][_0x108835(0x287)]=_0x23b575;}),_0xd9ce59[_0x259c40(0x284)]((_0xe50f7,_0x5db18c)=>{_0x2fb529[_0x5db18c]['primary_code']=_0xe50f7;}),_0x39ce0d[_0x259c40(0x284)]((_0x46830a,_0xeab72d)=>{var _0x25bf67=_0x259c40;_0x2fb529[_0xeab72d][_0x25bf67(0x298)]=_0x46830a;}),_0x5c2be5['forEach']((_0x56faed,_0x3dcf95)=>{var _0x49a93f=_0x259c40;_0x2fb529[_0x3dcf95][_0x49a93f(0x2c6)]=_0x56faed;}),_0xb8f3b4[_0x259c40(0x284)]((_0x28c029,_0x5d8c7c)=>{var _0x818859=_0x259c40,_0x271e36=_0x28c029[_0x818859(0x212)](/[A-Za-z]+/)[0x0],_0x221b75=parseInt(_0x28c029[_0x818859(0x212)](/\d+/)[0x0]);_0x2fb529[_0x5d8c7c][_0x818859(0x18e)]=_0x221b75,_0x2fb529[_0x5d8c7c]['level']=_0x271e36;}),_0x27fd37['forEach']((_0x1b3daf,_0x428df0)=>{var _0x232c7f=_0x259c40;_0x2fb529[_0x428df0][_0x232c7f(0x236)]=_0x1b3daf;}),_0x44aaa6[_0x259c40(0x284)]((_0x342e01,_0x23e4d7)=>{var _0x208dac=_0x259c40;_0x2fb529[_0x23e4d7][_0x208dac(0x198)]=_0x342e01;}),_0x378318[_0x259c40(0x284)]((_0x4f7b25,_0x5568c5)=>{var _0x190c62=_0x259c40;_0x2fb529[_0x5568c5][_0x190c62(0x26f)]=_0x4f7b25;}),_0x8c69cf[_0x259c40(0x284)]((_0x153b9c,_0x3abb19)=>{_0x2fb529[_0x3abb19]['expiry_date']=_0x153b9c;}),_0x738f76[_0x259c40(0x284)]((_0x2bca61,_0x4622e3)=>{var _0x1b5db6=_0x259c40;_0x2fb529[_0x4622e3][_0x1b5db6(0x1c7)]=_0x2bca61;}),_0x2905a2[_0x259c40(0x284)]((_0x449d7c,_0x14e17d)=>{_0x2fb529[_0x14e17d]['maxperunit']=_0x449d7c;}),_0x2fe357[_0x259c40(0x284)]((_0x24b300,_0x996c72)=>{var _0x58ba71=_0x259c40;_0x2fb529[_0x996c72][_0x58ba71(0x225)]=_0x24b300;}),_0x5cd482[_0x259c40(0x284)]((_0x171c2b,_0xe78d12)=>{_0x2fb529[_0xe78d12]['room_name']=_0x171c2b;}),_0x33bace['forEach']((_0x2a8de4,_0x2c280c)=>{var _0x184ed1=_0x259c40;_0x2fb529[_0x2c280c][_0x184ed1(0x2c2)]=_0x2a8de4,_0x2fb529[_0x2c280c][_0x184ed1(0x1d6)]=_0xda3d98;});const _0x5a5d3a=new sales_logs();await _0x5a5d3a[_0x259c40(0x1c0)](),_0x33bace[_0x259c40(0x284)]((_0x3f8dad,_0x1570ce)=>{var _0x4a345e=_0x259c40;_0x2fb529[_0x1570ce][_0x4a345e(0x211)]=_0x4a345e(0x252)+_0x5a5d3a['invoice_init'][_0x4a345e(0x21b)]()[_0x4a345e(0x19e)](0x8,'0');});var _0x117064=0x0;_0x2fb529['forEach'](_0x1dc45b=>{var _0x1a1db0=_0x259c40;parseFloat(_0x1dc45b[_0x1a1db0(0x26d)])<parseFloat(_0x1dc45b[_0x1a1db0(0x19a)])&&parseFloat(_0x1dc45b[_0x1a1db0(0x19a)])>parseFloat(_0x1dc45b[_0x1a1db0(0x26d)])&&(console[_0x1a1db0(0x2ac)](_0x1dc45b['stock']+'\x20<>\x20'+_0x1dc45b[_0x1a1db0(0x19a)]),_0x117064++);});if(_0x117064!=0x0)return _0x4c9f7d['flash']('errors',_0x259c40(0x29f)),_0x4c3b04[_0x259c40(0x1e9)](_0x259c40(0x1a2));const _0x35e42a=_0x2fb529[_0x259c40(0x1b3)](_0x54839e=>_0x54839e[_0x259c40(0x19a)]!=='0'&&_0x54839e[_0x259c40(0x19a)]!==''),_0x18e85e=new sales_finished({'invoice':_0x259c40(0x252)+_0x5a5d3a[_0x259c40(0x1b0)][_0x259c40(0x21b)]()[_0x259c40(0x19e)](0x8,'0'),'sales_data':_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x268)],'customer':_0x4c9f7d[_0x259c40(0x25d)][_0x259c40(0x1f9)],'date':_0xda3d98,'warehouse_name':_0x130543,'sale_product':_0x35e42a,'note':_0x19a665,'room':_0x500ca3,'primary_code':_0x460c79,'secondary_code':_0x18ced6,'prod_code':_0x47a35c,'SCRN':_0xa211e1,'finalize':_0x259c40(0x1ca),'mode_transpo':_0x38adf0,'name_driver':_0x4c6db4,'ReqBy':_0x53aae8,'dateofreq':_0x12e80c,'PO_number':_0x3d1b6b,'typeservicesData':_0x10f5b3,'typevehicle':_0x56d288,'destination':_0x124074,'deliverydate':_0xb5d60d,'driver':_0x71dd16,'plate':_0x542357,'van':_0x5143ba,'DRSI':_0x5643f1,'TSU':_0x2bac34,'TFU':_0x28207d,'typeOfProducts':_0x3db2da}),_0x347e63=await _0x18e85e[_0x259c40(0x1c0)](),_0x4f8385=await sales_finished[_0x259c40(0x1e4)]({'invoice':_0x581df7});_0x4c9f7d[_0x259c40(0x1a3)](_0x259c40(0x28c),_0x259c40(0x2c1)),_0x4c3b04[_0x259c40(0x1e9)](_0x259c40(0x1b2)+_0x347e63[_0x259c40(0x2bf)]);}catch(_0xbee8bf){console[_0x259c40(0x2ac)](_0xbee8bf);}}),router[a0_0x3b0c45(0x1f7)](a0_0x3b0c45(0x1c5),auth,async(_0x21d373,_0x2319aa)=>{var _0x5b4b99=a0_0x3b0c45;try{const _0x3ada92=_0x21d373[_0x5b4b99(0x285)]['id'];console[_0x5b4b99(0x2ac)](_0x3ada92);const _0x4f5b5c=await product[_0x5b4b99(0x223)](),_0x3ffc9d=await purchases[_0x5b4b99(0x1f8)]([{'$match':{'warehouse_name':_0x3ada92}},{'$unwind':'$product'},{'$group':{'_id':_0x5b4b99(0x27e)}}]);console['log'](_0x5b4b99(0x26c),_0x3ffc9d),_0x2319aa[_0x5b4b99(0x1e8)](0xc8)['json']({'purchases_data':_0x3ffc9d,'product_data':_0x4f5b5c});}catch(_0x167a9d){console[_0x5b4b99(0x2ac)](_0x167a9d);}}),router['post'](a0_0x3b0c45(0x2c3),auth,async(_0x13bbf9,_0x3c91e5)=>{var _0x54c16b=a0_0x3b0c45;try{const {warehouse_data:_0x5eeb4e,product_data:_0x28df09}=_0x13bbf9[_0x54c16b(0x25d)];console[_0x54c16b(0x2ac)](_0x13bbf9[_0x54c16b(0x25d)][_0x54c16b(0x1c4)]);;const _0x8b1495=await master_shop['find']();console[_0x54c16b(0x2ac)]('master',_0x8b1495);const _0x5ea919=await product[_0x54c16b(0x1e4)]({'name':_0x28df09});console['log'](_0x54c16b(0x201),_0x5ea919);const _0x54304d=await warehouse[_0x54c16b(0x1f8)]([{'$match':{'name':_0x5eeb4e}},{'$unwind':_0x54c16b(0x2cc)},{'$match':{'product_details.product_name':_0x28df09}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x54c16b(0x263)}}}]);console[_0x54c16b(0x2ac)](_0x54c16b(0x2c8),_0x54304d),_0x3c91e5[_0x54c16b(0x1e8)](0xc8)[_0x54c16b(0x1ae)]({'master':_0x8b1495,'new_product':_0x5ea919,'stock_data':_0x54304d});}catch(_0x24e1b5){console['log'](_0x24e1b5);}}),router[a0_0x3b0c45(0x2b8)](a0_0x3b0c45(0x1a6),auth,async(_0xf82d0e,_0x437a1f)=>{var _0x58f0a2=a0_0x3b0c45;try{const {invoice:_0xf68fde,date:_0x3fa24,warehouse_name:_0x168ecb,product_name:_0x5cbb1f,note:_0x3e5f93,room:_0x23b0f4,primary_code:_0x18e0c6,secondary_code:_0x5655e0,prod_code:_0x5bc205,SCRN:_0x476686,ReqBy:_0x22a093,dateofreq:_0x50aa9e,PO_number:_0x465610,typeservicesData:_0x4ebfbd,typevehicle:_0x538c3b,destination:_0x28131b,deliverydate:_0x285330,driver:_0x58039d,plate:_0x1d0d9c,van:_0x4b8706,DRSI:_0x1de13d,TSU:_0x364643,TFU:_0x55009c,mode_transpo:_0x453694,name_driver:_0x4bb76d,pull_out_date:_0x59fc7f,actual_delivery_date:_0x57059e}=_0xf82d0e['body'];_0x437a1f[_0x58f0a2(0x1ae)](_0xf82d0e[_0x58f0a2(0x25d)]);return;if(typeof _0x5cbb1f=='string')var _0x5260cc=[_0xf82d0e['body']['product_name']],_0x330904=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x26d)]],_0xbb6db1=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x22c)]],_0x3fcb7a=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x2bb)]],_0x507ec6=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x298)]],_0x339da2=[_0xf82d0e[_0x58f0a2(0x25d)]['prod_code']],_0x51a885=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x22d)]],_0x47c2c0=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x199)]],_0x67cf94=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x198)]],_0x552ae1=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x26f)]],_0x2f4ef3=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x25a)]],_0x2f61c7=[_0xf82d0e['body'][_0x58f0a2(0x1a9)]],_0x1748ef=[_0xf82d0e['body'][_0x58f0a2(0x24e)]],_0x2f811a=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x225)]],_0x490811=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x215)]],_0x265971=[_0xf82d0e['body'][_0x58f0a2(0x2bc)]],_0x167a32=[_0xf82d0e['body'][_0x58f0a2(0x287)]],_0x2cab59=[_0xf82d0e['body'][_0x58f0a2(0x21f)]],_0x111c07=[_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x23b)]];else var _0x5260cc=[..._0xf82d0e['body']['product_name']],_0x330904=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x26d)]],_0xbb6db1=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x22c)]],_0x3fcb7a=[..._0xf82d0e[_0x58f0a2(0x25d)]['primary_code']],_0x507ec6=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x298)]],_0x339da2=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x2ba)]],_0x51a885=[..._0xf82d0e['body'][_0x58f0a2(0x22d)]],_0x47c2c0=[..._0xf82d0e['body'][_0x58f0a2(0x199)]],_0x67cf94=[..._0xf82d0e[_0x58f0a2(0x25d)]['secondary_unit']],_0x552ae1=[..._0xf82d0e['body'][_0x58f0a2(0x26f)]],_0x2f4ef3=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x25a)]],_0x2f61c7=[..._0xf82d0e[_0x58f0a2(0x25d)]['product_date']],_0x1748ef=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x24e)]],_0x2f811a=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x225)]],_0x490811=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x215)]],_0x265971=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x2bc)]],_0x167a32=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x287)]],_0x2cab59=[..._0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x21f)]],_0x111c07=[..._0xf82d0e['body']['gross_price']];const _0x71bf97=_0x5260cc[_0x58f0a2(0x2b4)](_0xfed42e=>{return _0xfed42e={'product_name':_0xfed42e};});_0x330904[_0x58f0a2(0x284)]((_0x80789,_0x36a69c)=>{_0x71bf97[_0x36a69c]['stock']=_0x80789;}),_0xbb6db1[_0x58f0a2(0x284)]((_0x2807f0,_0x6faecf)=>{var _0x46a116=_0x58f0a2;_0x71bf97[_0x6faecf][_0x46a116(0x19a)]=Math[_0x46a116(0x18f)](_0x2807f0);}),_0x5260cc[_0x58f0a2(0x284)]((_0x4453ab,_0x42b2dc)=>{var _0x23ecd7=_0x58f0a2;_0x71bf97[_0x42b2dc][_0x23ecd7(0x188)]=_0xf82d0e['body'][_0x23ecd7(0x268)];}),_0x111c07[_0x58f0a2(0x284)]((_0x16a6dc,_0x4e8fac)=>{var _0x2f9714=_0x58f0a2;_0x71bf97[_0x4e8fac][_0x2f9714(0x23b)]=_0x16a6dc;}),_0x2cab59['forEach']((_0x4c0c06,_0x2f3cfe)=>{_0x71bf97[_0x2f3cfe]['uuid']=_0x4c0c06;}),_0x167a32[_0x58f0a2(0x284)]((_0x1b0a9,_0x48b17f)=>{_0x71bf97[_0x48b17f]['id_transaction_from']=_0x1b0a9;}),_0x3fcb7a[_0x58f0a2(0x284)]((_0x50202e,_0x3f0446)=>{var _0x44a42d=_0x58f0a2;_0x71bf97[_0x3f0446][_0x44a42d(0x2bb)]=_0x50202e;}),_0x507ec6[_0x58f0a2(0x284)]((_0x4fed8f,_0xefa7e2)=>{_0x71bf97[_0xefa7e2]['secondary_code']=_0x4fed8f;}),_0x339da2[_0x58f0a2(0x284)]((_0x53a94b,_0xfc91e0)=>{var _0x4655d3=_0x58f0a2;_0x71bf97[_0xfc91e0][_0x4655d3(0x2c6)]=_0x53a94b;}),_0x51a885[_0x58f0a2(0x284)]((_0x2bc4ea,_0x2b15e6)=>{var _0x818de8=_0x58f0a2,_0x3e92e1=_0x2bc4ea[_0x818de8(0x212)](/[A-Za-z]+/)[0x0],_0x52717d=parseInt(_0x2bc4ea[_0x818de8(0x212)](/\d+/)[0x0]);_0x71bf97[_0x2b15e6]['bay']=_0x52717d,_0x71bf97[_0x2b15e6][_0x818de8(0x24d)]=_0x3e92e1;}),_0x47c2c0[_0x58f0a2(0x284)]((_0x31c9d7,_0x49a448)=>{var _0x1316f9=_0x58f0a2;_0x71bf97[_0x49a448][_0x1316f9(0x236)]=_0x31c9d7;}),_0x67cf94['forEach']((_0x32dd3c,_0x21c74f)=>{var _0x58751e=_0x58f0a2;_0x71bf97[_0x21c74f][_0x58751e(0x198)]=_0x32dd3c;}),_0x552ae1['forEach']((_0x138941,_0x1ddddb)=>{var _0x3753e4=_0x58f0a2;_0x71bf97[_0x1ddddb][_0x3753e4(0x26f)]=_0x138941;}),_0x2f4ef3[_0x58f0a2(0x284)]((_0x2777f4,_0x4d41b5)=>{var _0x527a86=_0x58f0a2;_0x71bf97[_0x4d41b5][_0x527a86(0x25a)]=_0x2777f4;}),_0x2f61c7['forEach']((_0x18f6df,_0x320600)=>{_0x71bf97[_0x320600]['production_date']=_0x18f6df;}),_0x1748ef[_0x58f0a2(0x284)]((_0x5799d2,_0x219f08)=>{var _0x5000b9=_0x58f0a2;_0x71bf97[_0x219f08][_0x5000b9(0x22a)]=_0x5799d2;}),_0x2f811a[_0x58f0a2(0x284)]((_0x58ff5d,_0x1f61cc)=>{var _0x82c08f=_0x58f0a2;_0x71bf97[_0x1f61cc][_0x82c08f(0x225)]=_0x58ff5d;}),_0x490811[_0x58f0a2(0x284)]((_0x4e3db5,_0x27545b)=>{var _0x238bd9=_0x58f0a2;_0x71bf97[_0x27545b][_0x238bd9(0x190)]=_0x4e3db5;}),_0x265971[_0x58f0a2(0x284)]((_0x596768,_0x368d25)=>{var _0xa85963=_0x58f0a2;_0x71bf97[_0x368d25][_0xa85963(0x2c2)]=_0x596768,_0x71bf97[_0x368d25][_0xa85963(0x1d6)]=_0x3fa24;});const _0x471ce6=new invoice_for_outgoing();await _0x471ce6[_0x58f0a2(0x1c0)](),_0x265971[_0x58f0a2(0x284)]((_0x1f8045,_0x49d26a)=>{var _0x47e168=_0x58f0a2;_0x71bf97[_0x49d26a][_0x47e168(0x211)]=_0x47e168(0x2d1)+_0x471ce6[_0x47e168(0x1b0)][_0x47e168(0x21b)]()[_0x47e168(0x19e)](0x8,'0');});var _0x3e7724=0x0;_0x71bf97[_0x58f0a2(0x284)](_0x2b1e8a=>{var _0x4b7f73=_0x58f0a2;parseFloat(_0x2b1e8a['stock'])<parseFloat(_0x2b1e8a[_0x4b7f73(0x19a)])&&parseFloat(_0x2b1e8a[_0x4b7f73(0x19a)])>parseFloat(_0x2b1e8a[_0x4b7f73(0x26d)])&&(console[_0x4b7f73(0x2ac)](_0x2b1e8a['stock']+_0x4b7f73(0x208)+_0x2b1e8a[_0x4b7f73(0x19a)]),_0x3e7724++);});if(_0x3e7724!=0x0)return _0xf82d0e[_0x58f0a2(0x1a3)](_0x58f0a2(0x205),_0x58f0a2(0x29f)),_0x437a1f[_0x58f0a2(0x1e9)]('back');const _0x507f10=_0x71bf97[_0x58f0a2(0x1b3)](_0x16d7a5=>_0x16d7a5['quantity']!=='0'&&_0x16d7a5[_0x58f0a2(0x19a)]!==''),_0x1bc62e=new sales_finished({'invoice':_0x58f0a2(0x2d1)+_0x471ce6[_0x58f0a2(0x1b0)]['toString']()['padStart'](0x8,'0'),'sales_data':_0xf82d0e['body'][_0x58f0a2(0x268)],'customer':_0xf82d0e[_0x58f0a2(0x25d)][_0x58f0a2(0x1f9)],'date':_0x3fa24,'warehouse_name':_0x168ecb,'sale_product':_0x507f10,'note':_0x3e5f93,'room':_0x23b0f4,'primary_code':_0x18e0c6,'secondary_code':_0x5655e0,'prod_code':_0x5bc205,'SCRN':_0x476686,'finalize':_0x58f0a2(0x1ca),'mode_transpo':_0x453694,'name_driver':_0x4bb76d,'ReqBy':_0x22a093,'dateofreq':_0x50aa9e,'PO_number':_0x465610,'typeservicesData':_0x4ebfbd,'typevehicle':_0x538c3b,'destination':_0x28131b,'deliverydate':_0x285330,'driver':_0x58039d,'plate':_0x1d0d9c,'van':_0x4b8706,'DRSI':_0x1de13d,'TSU':_0x364643,'TFU':_0x55009c,'pullout_date':_0x59fc7f,'actualdelivery_date':_0x57059e,'typeOfProducts':_0x58f0a2(0x18a)}),_0x5c4847=await _0x1bc62e[_0x58f0a2(0x1c0)](),_0x272265=await sales_finished[_0x58f0a2(0x1e4)]({'invoice':_0xf68fde});_0xf82d0e[_0x58f0a2(0x1a3)](_0x58f0a2(0x28c),'Sales\x20Add\x20successfully'),_0x437a1f['redirect']('/all_sales_finished/preview/'+_0x5c4847[_0x58f0a2(0x2bf)]);}catch(_0x328050){console[_0x58f0a2(0x2ac)](_0x328050);}}),router[a0_0x3b0c45(0x1f7)](a0_0x3b0c45(0x1d7),auth,async(_0x4407d2,_0x1b07d3)=>{var _0x3f84ca=a0_0x3b0c45;try{const {username:_0x168747,email:_0x1e8cff,role:_0x317bbb}=_0x4407d2[_0x3f84ca(0x27c)],_0x477676=_0x4407d2[_0x3f84ca(0x27c)],_0x439709=await profile['findOne']({'email':_0x477676[_0x3f84ca(0x1b6)]}),_0x352848=await master_shop[_0x3f84ca(0x223)](),_0x6b0ce1=_0x4407d2['params']['id'],_0x5964c8=await sales_finished[_0x3f84ca(0x295)](_0x6b0ce1),_0x1683a8=await warehouse[_0x3f84ca(0x1f8)]([{'$match':{'name':_0x5964c8[_0x3f84ca(0x20c)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3f84ca(0x270)},'product_stock':{'$first':_0x3f84ca(0x263)},'bay':{'$first':_0x3f84ca(0x229)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3f84ca(0x23d)},'floorlevel':{'$first':_0x3f84ca(0x1d3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3f84ca(0x280)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3f84ca(0x209)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3f84ca(0x2a3)},'production_date':{'$first':_0x3f84ca(0x204)},'batch_code':{'$first':_0x3f84ca(0x23f)},'room':{'$first':_0x3f84ca(0x28f)},'room_data':{'$first':_0x3f84ca(0x1ba)}}}]),_0x371d1a=await customer[_0x3f84ca(0x223)]({});let _0x13a9f4;if(_0x477676[_0x3f84ca(0x2b7)]==_0x3f84ca(0x230)){const _0x5df912=await staff['findOne']({'email':_0x477676[_0x3f84ca(0x1b6)]});_0x13a9f4=await warehouse[_0x3f84ca(0x1f8)]([{'$match':{'status':'Enabled','name':_0x5df912['warehouse']}},{'$group':{'_id':_0x3f84ca(0x248),'name':{'$first':_0x3f84ca(0x248)}}}]);}else _0x13a9f4=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x3f84ca(0x248)}}}]);const _0x38cf19=await product['find']({});if(_0x352848[0x0][_0x3f84ca(0x222)]==_0x3f84ca(0x255)){var _0x194496=users[_0x3f84ca(0x29d)];console[_0x3f84ca(0x2ac)](_0x194496);}else{if(_0x352848[0x0][_0x3f84ca(0x222)]==_0x3f84ca(0x2ce))var _0x194496=users[_0x3f84ca(0x2ce)];else{if(_0x352848[0x0]['language']==_0x3f84ca(0x2a4))var _0x194496=users[_0x3f84ca(0x2a4)];else{if(_0x352848[0x0][_0x3f84ca(0x222)]=='Spanish')var _0x194496=users[_0x3f84ca(0x1fa)];else{if(_0x352848[0x0]['language']==_0x3f84ca(0x1da))var _0x194496=users[_0x3f84ca(0x1da)];else{if(_0x352848[0x0][_0x3f84ca(0x222)]==_0x3f84ca(0x1bf))var _0x194496=users[_0x3f84ca(0x24f)];else{if(_0x352848[0x0]['language']=='Chinese')var _0x194496=users[_0x3f84ca(0x1a0)];else{if(_0x352848[0x0][_0x3f84ca(0x222)]==_0x3f84ca(0x20e))var _0x194496=users[_0x3f84ca(0x1c1)];}}}}}}}_0x1b07d3[_0x3f84ca(0x1f0)]('edit_sales_finished_view',{'success':_0x4407d2['flash']('success'),'errors':_0x4407d2[_0x3f84ca(0x1a3)](_0x3f84ca(0x205)),'role':_0x477676,'profile':_0x439709,'customer':_0x371d1a,'warehouse':_0x13a9f4,'product':_0x1683a8,'user':_0x5964c8,'master_shop':_0x352848,'unit':_0x38cf19,'language':_0x194496});}catch(_0xd3ac3c){console[_0x3f84ca(0x2ac)](_0xd3ac3c);}});async function dataUpdate(_0x3764aa,_0x1a2764,_0x3c7a25){var _0x14200d=a0_0x3b0c45;return await warehouse['updateOne']({'_id':_0x3764aa,'product_details._id':_0x1a2764},{'$set':{'product_details.$.product_stock':_0x3c7a25}}),await warehouse[_0x14200d(0x295)](_0x3764aa);}function a0_0x5189(_0x4fd4d9,_0x14316a){var _0x83c8ae=a0_0x83c8();return a0_0x5189=function(_0x518973,_0x7298ab){_0x518973=_0x518973-0x188;var _0xf9f3af=_0x83c8ae[_0x518973];return _0xf9f3af;},a0_0x5189(_0x4fd4d9,_0x14316a);}router[a0_0x3b0c45(0x2b8)](a0_0x3b0c45(0x1d7),auth,async(_0x3762c1,_0x2c3ca3)=>{var _0x142118=a0_0x3b0c45;try{const _0x116cd7=_0x3762c1[_0x142118(0x285)]['id'],{invoice:_0x26de46,warehouse_name:_0x51ca08,room:_0x510c01}=_0x3762c1[_0x142118(0x25d)],_0x4b3983=await sales_finished[_0x142118(0x1e4)]({'invoice':_0x26de46});for(let _0x89bd8c=0x0;_0x89bd8c<=_0x4b3983[_0x142118(0x2d0)][_0x142118(0x1cf)]-0x1;_0x89bd8c++){const _0x2f7c1b=_0x4b3983[_0x142118(0x2d0)][_0x89bd8c];var _0x2d5ed1=await warehouse[_0x142118(0x1e4)]({'name':_0x51ca08,'room':_0x2f7c1b[_0x142118(0x190)]}),_0x3adcae=0x0;for(let _0x573fa2=0x0;_0x573fa2<=_0x2d5ed1['product_details']['length']-0x1;_0x573fa2++){const _0x4ceed8=_0x2d5ed1['product_details'][_0x573fa2];_0x4ceed8[_0x142118(0x2bf)]==_0x2f7c1b[_0x142118(0x287)]&&_0x4ceed8[_0x142118(0x21f)]==_0x2f7c1b[_0x142118(0x21f)]&&(_0x3adcae=Math[_0x142118(0x194)](0x0,Math[_0x142118(0x18f)](_0x4ceed8[_0x142118(0x2d2)])-Math[_0x142118(0x18f)](_0x2f7c1b['quantity'])),await warehouse[_0x142118(0x26b)]({'_id':_0x2d5ed1[_0x142118(0x2bf)][_0x142118(0x1f4)](),'product_details._id':_0x4ceed8[_0x142118(0x2bf)][_0x142118(0x1f4)](),'product_details.uuid':_0x2f7c1b['uuid']},{'$set':{'product_details.$.product_stock':_0x3adcae}}));}console[_0x142118(0x2ac)](typeof _0x2f7c1b[_0x142118(0x188)]);if(typeof _0x2f7c1b[_0x142118(0x188)]!==_0x142118(0x1ee)){var _0x5e7925=await staff[_0x142118(0x295)](_0x2f7c1b[_0x142118(0x188)]);console[_0x142118(0x2ac)](_0x142118(0x259));var _0x38b755=0x0;for(let _0x40ffd4=0x0;_0x40ffd4<=_0x5e7925[_0x142118(0x247)][_0x142118(0x1cf)]-0x1;_0x40ffd4++){const _0x1c743e=_0x5e7925[_0x142118(0x247)][_0x40ffd4];console['log'](_0x2f7c1b[_0x142118(0x287)]+_0x142118(0x264)+_0x1c743e[_0x142118(0x1dc)]+_0x142118(0x227)+_0x2f7c1b[_0x142118(0x2bf)]+_0x142118(0x264)+_0x2f7c1b[_0x142118(0x2bf)]),_0x2f7c1b['id_transaction_from']==_0x1c743e[_0x142118(0x1dc)]&&_0x2f7c1b[_0x142118(0x2bf)]==0x1&&(_0x1c743e[_0x142118(0x2d2)]=Math[_0x142118(0x18f)](_0x1c743e[_0x142118(0x2d2)])+Math[_0x142118(0x18f)](_0x2f7c1b[_0x142118(0x19a)]),_0x38b755++);}console[_0x142118(0x2ac)](_0x142118(0x293),_0x38b755),_0x38b755=='0'&&(_0x5e7925[_0x142118(0x247)]=_0x5e7925[_0x142118(0x247)]['concat']({'product_name':_0x2f7c1b[_0x142118(0x2a9)],'product_stock':_0x2f7c1b[_0x142118(0x19a)],'bay':_0x2f7c1b['bay'],'level':_0x2f7c1b[_0x142118(0x24d)],'product_code':_0x2f7c1b['product_code'],'primary_code':_0x2f7c1b[_0x142118(0x2bb)],'secondary_code':_0x2f7c1b[_0x142118(0x298)],'expiry_date':_0x2f7c1b[_0x142118(0x25a)],'production_date':_0x2f7c1b[_0x142118(0x1c7)],'maxProducts':_0x2f7c1b[_0x142118(0x228)],'batch_code':_0x2f7c1b[_0x142118(0x26f)],'secondary_unit':_0x2f7c1b[_0x142118(0x198)],'unit':_0x2f7c1b['unit'],'maxProducts':_0x2f7c1b[_0x142118(0x228)],'maxPerUnit':_0x2f7c1b[_0x142118(0x22a)],'invoice':_0x2f7c1b[_0x142118(0x2c2)],'warehouse_id':_0x2f7c1b['id_transaction_from'],'id_incoming':_0x2f7c1b[_0x142118(0x2bf)],'uuid':_0x2f7c1b['uuid'],'gross_price':_0x2f7c1b['gross_price'],'date_incoming':_0x2f7c1b[_0x142118(0x1d6)],'outgoing_invoice':_0x2f7c1b[_0x142118(0x211)]}),await _0x5e7925['save']());}}_0x4b3983[_0x142118(0x25f)]=_0x142118(0x267);const _0x3f2366=await _0x4b3983[_0x142118(0x1c0)](),_0x1fa825=await master_shop[_0x142118(0x223)](),_0x48699a=await email_settings[_0x142118(0x1e4)](),_0x45ffcd=await supervisor_settings[_0x142118(0x223)]();var _0x3a2310=_0x4b3983[_0x142118(0x2d0)],_0x316c62='',_0x1d7ff7;for(_0x1d7ff7 in _0x3a2310){_0x316c62+=_0x142118(0x278)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3a2310[_0x1d7ff7][_0x142118(0x2a9)]+_0x142118(0x195)+_0x142118(0x240)+_0x3a2310[_0x1d7ff7][_0x142118(0x2c6)]+_0x142118(0x195)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3a2310[_0x1d7ff7][_0x142118(0x19a)]+_0x142118(0x195)+_0x142118(0x240)+_0x3a2310[_0x1d7ff7][_0x142118(0x236)]+_0x142118(0x195)+_0x142118(0x240)+_0x3a2310[_0x1d7ff7][_0x142118(0x198)]+_0x142118(0x195)+_0x142118(0x240)+_0x4b3983[_0x142118(0x20c)]+'</td>'+_0x142118(0x240)+_0x3a2310[_0x1d7ff7]['room_name']+_0x142118(0x195)+_0x142118(0x240)+_0x3a2310[_0x1d7ff7][_0x142118(0x18e)]+_0x142118(0x195);}_0x3762c1[_0x142118(0x1a3)]('success',_0x142118(0x21e)),_0x2c3ca3[_0x142118(0x1e9)]('/picking_list/pdf/'+_0x116cd7);}catch(_0x5ed46d){console[_0x142118(0x2ac)](_0x5ed46d);}}),router[a0_0x3b0c45(0x1f7)](a0_0x3b0c45(0x192),auth,async(_0x58f7db,_0x2a168e)=>{var _0x285146=a0_0x3b0c45;try{const {username:_0x123375,email:_0x399742,role:_0x211386}=_0x58f7db[_0x285146(0x27c)],_0x4b5317=_0x58f7db[_0x285146(0x27c)],_0x21ee7f=await profile[_0x285146(0x1e4)]({'email':_0x4b5317['email']}),_0x438468=await master_shop[_0x285146(0x223)](),_0x2b6216=_0x58f7db[_0x285146(0x285)]['id'],_0x3d9235=await sales_finished[_0x285146(0x295)](_0x2b6216);let _0x7938f8=new Date(_0x3d9235[_0x285146(0x25a)]),_0x511a29=('0'+_0x7938f8[_0x285146(0x24c)]())[_0x285146(0x246)](-0x2),_0xcb59ac=('0'+(_0x7938f8[_0x285146(0x1ab)]()+0x1))[_0x285146(0x246)](-0x2),_0x388269=_0x7938f8[_0x285146(0x21c)](),_0x8b69bc=_0x388269+'-'+_0xcb59ac+'-'+_0x511a29;var _0xfb0c57=[_0x285146(0x2c0),'Enclosed'];const _0x2f4eff=await warehouse[_0x285146(0x1f8)]([{'$match':{'name':_0x3d9235[_0x285146(0x20c)],'room':_0x3d9235[_0x285146(0x191)]}},{'$unwind':_0x285146(0x2cc)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x285146(0x270)},'product_stock':{'$first':_0x285146(0x263)},'bay':{'$first':_0x285146(0x229)},'bin':{'$first':_0x285146(0x1b4)},'type':{'$first':_0x285146(0x23d)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x285146(0x1f6)},'secondary_code':{'$first':_0x285146(0x280)},'product_code':{'$first':_0x285146(0x1c3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]),_0x3df210=await customer[_0x285146(0x223)]({});let _0x1e824c;if(_0x4b5317[_0x285146(0x2b7)]=='staff'){const _0x4af5b0=await staff[_0x285146(0x1e4)]({'email':_0x4b5317[_0x285146(0x1b6)]});_0x1e824c=await warehouse[_0x285146(0x1f8)]([{'$match':{'status':_0x285146(0x203),'name':_0x4af5b0[_0x285146(0x1c8)]}},{'$group':{'_id':'$name','name':{'$first':_0x285146(0x248)}}}]);}else _0x1e824c=await warehouse[_0x285146(0x1f8)]([{'$match':{'status':_0x285146(0x203)}},{'$group':{'_id':_0x285146(0x248),'name':{'$first':_0x285146(0x248)}}}]);const _0x3f57fe=await product['find']({});if(_0x438468[0x0][_0x285146(0x222)]==_0x285146(0x255)){var _0x1e7207=users[_0x285146(0x29d)];console[_0x285146(0x2ac)](_0x1e7207);}else{if(_0x438468[0x0]['language']=='Hindi')var _0x1e7207=users[_0x285146(0x2ce)];else{if(_0x438468[0x0][_0x285146(0x222)]==_0x285146(0x2a4))var _0x1e7207=users[_0x285146(0x2a4)];else{if(_0x438468[0x0]['language']==_0x285146(0x1fa))var _0x1e7207=users[_0x285146(0x1fa)];else{if(_0x438468[0x0]['language']=='French')var _0x1e7207=users[_0x285146(0x1da)];else{if(_0x438468[0x0][_0x285146(0x222)]==_0x285146(0x1bf))var _0x1e7207=users[_0x285146(0x24f)];else{if(_0x438468[0x0][_0x285146(0x222)]==_0x285146(0x1a0))var _0x1e7207=users['Chinese'];else{if(_0x438468[0x0][_0x285146(0x222)]=='Arabic\x20(ae)')var _0x1e7207=users[_0x285146(0x1c1)];}}}}}}}_0x2a168e[_0x285146(0x1f0)](_0x285146(0x20f),{'success':_0x58f7db[_0x285146(0x1a3)](_0x285146(0x28c)),'errors':_0x58f7db[_0x285146(0x1a3)](_0x285146(0x205)),'role':_0x4b5317,'profile':_0x21ee7f,'customer':_0x3df210,'warehouse':_0x1e824c,'product':_0x2f4eff,'user':_0x3d9235,'master_shop':_0x438468,'unit':_0x3f57fe,'language':_0x1e7207,'rooms_data':_0xfb0c57,'ed_fullDate':_0x8b69bc});}catch(_0x40573d){console['log'](_0x40573d);}}),router['post'](a0_0x3b0c45(0x192),auth,async(_0x567c6e,_0x30adb5)=>{var _0x4bb044=a0_0x3b0c45;try{const _0xdbd7d6=_0x567c6e[_0x4bb044(0x285)]['id'],_0xfdace=await sales_finished['findOne']({'_id':_0x567c6e[_0x4bb044(0x285)]['id']}),_0x51d902=await warehouse[_0x4bb044(0x1e4)]({'name':_0xfdace[_0x4bb044(0x20c)],'room':_0x567c6e[_0x4bb044(0x25d)]['room'],'warehouse_category':_0x4bb044(0x1d0)}),{invoice:_0x344f7d,customer:_0x1ef388,date:_0x4e5291,warehouse_name:_0x303609,product_name:_0x39c43c,stock:_0x4303b1,adjust_qty:_0x15a40c,note:_0x3f064d,room:_0x308676,primary_code:_0xf8b7ca,secondary_code:_0x1288bf,prod_code:_0x326522,level:_0x1923b7,isle:_0x2f3a85,pallet:_0x4ac7c0,expiry_date:_0x57b2fa}=_0x567c6e[_0x4bb044(0x25d)];if(typeof _0x39c43c==_0x4bb044(0x196))var _0x2a5c08=[_0x567c6e[_0x4bb044(0x25d)]['product_name']],_0x16be48=[_0x567c6e['body'][_0x4bb044(0x26d)]],_0x4740f7=[_0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x2bd)]],_0x2851d2=[_0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x2bb)]],_0x44123a=[_0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x298)]],_0x4f914e=[_0x567c6e[_0x4bb044(0x25d)]['prod_code']],_0x2f28f1=[_0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x24d)]],_0x9c814b=[_0x567c6e['body'][_0x4bb044(0x25a)]];else var _0x2a5c08=[..._0x567c6e[_0x4bb044(0x25d)]['product_name']],_0x16be48=[..._0x567c6e[_0x4bb044(0x25d)]['stock']],_0x4740f7=[..._0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x2bd)]],_0x2851d2=[..._0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x2bb)]],_0x44123a=[..._0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x298)]],_0x4f914e=[..._0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x2ba)]],_0x2f28f1=[..._0x567c6e[_0x4bb044(0x25d)]['level']],_0x9c814b=[..._0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x25a)]];const _0x15e982=_0x2a5c08[_0x4bb044(0x2b4)](_0x38d63c=>{return _0x38d63c={'product_name':_0x38d63c};});_0x16be48[_0x4bb044(0x284)]((_0x5bfc1f,_0x57ce36)=>{var _0x4ecd13=_0x4bb044;_0x15e982[_0x57ce36][_0x4ecd13(0x26d)]=_0x5bfc1f;}),_0x4740f7[_0x4bb044(0x284)]((_0x258646,_0x18da2)=>{var _0x304c85=_0x4bb044;_0x15e982[_0x18da2][_0x304c85(0x19a)]=_0x258646;}),_0x2851d2[_0x4bb044(0x284)]((_0x464caa,_0x2ec2a6)=>{var _0x666d0d=_0x4bb044;_0x15e982[_0x2ec2a6][_0x666d0d(0x2bb)]=_0x464caa;}),_0x44123a[_0x4bb044(0x284)]((_0x1c6c5c,_0xeeb424)=>{var _0x297d17=_0x4bb044;_0x15e982[_0xeeb424][_0x297d17(0x298)]=_0x1c6c5c;}),_0x4f914e['forEach']((_0x86b670,_0x38fd02)=>{_0x15e982[_0x38fd02]['product_code']=_0x86b670;}),_0x2f28f1[_0x4bb044(0x284)]((_0x55a122,_0x58bf9b)=>{var _0x9e6129=_0x4bb044;_0x15e982[_0x58bf9b][_0x9e6129(0x24d)]=_0x55a122;}),_0x9c814b[_0x4bb044(0x284)]((_0x525c6d,_0x2ea730)=>{var _0x1463eb=_0x4bb044;_0x15e982[_0x2ea730][_0x1463eb(0x25a)]=_0x525c6d;});var _0x1dcd03=0x0;_0x15e982['forEach'](_0x386a68=>{var _0x125520=_0x4bb044;console['log'](_0x125520(0x1c6),_0x386a68),(parseInt(_0x386a68[_0x125520(0x26d)])<parseInt(_0x386a68['quantity'])||parseInt(_0x386a68[_0x125520(0x19a)])==0x0)&&_0x1dcd03++;});if(_0x1dcd03!=0x0)return _0x567c6e[_0x4bb044(0x1a3)](_0x4bb044(0x205),_0x4bb044(0x2a0)),_0x30adb5[_0x4bb044(0x1e9)](_0x4bb044(0x1a2));_0xfdace[_0x4bb044(0x2d0)][_0x4bb044(0x284)](_0x30e4f7=>{var _0x539551=_0x4bb044;const _0x21841d=_0x51d902[_0x539551(0x1ef)][_0x539551(0x2b4)](_0xfc34fb=>{var _0x219820=_0x539551;_0xfc34fb[_0x219820(0x2a9)]==_0x30e4f7[_0x219820(0x2a9)]&&_0xfc34fb[_0x219820(0x18e)]==_0x30e4f7[_0x219820(0x18e)]&&(_0xfc34fb[_0x219820(0x2d2)]=parseInt(_0xfc34fb[_0x219820(0x2d2)])+parseInt(_0x30e4f7[_0x219820(0x19a)]));});}),await _0x51d902['save']();const _0x51eb2b=_0x15e982[_0x4bb044(0x1b3)](_0x58e8f7=>_0x58e8f7[_0x4bb044(0x19a)]!=='0'&&_0x58e8f7[_0x4bb044(0x19a)]!=='');_0xfdace[_0x4bb044(0x2c2)]=_0x344f7d,_0xfdace['customer']=_0x1ef388,_0xfdace[_0x4bb044(0x1bc)]=_0x4e5291,_0xfdace[_0x4bb044(0x20c)]=_0x303609,_0xfdace[_0x4bb044(0x2d0)]=_0x51eb2b,_0xfdace[_0x4bb044(0x277)]=_0x3f064d,_0xfdace[_0x4bb044(0x191)]=_0x308676;const _0xd9bd18=await _0xfdace[_0x4bb044(0x1c0)](),_0x23061b=await sales_finished['findOne']({'_id':_0x567c6e['params']['id']}),_0x16cb39=await warehouse[_0x4bb044(0x1e4)]({'name':_0x303609,'room':_0x308676,'warehouse_category':_0x4bb044(0x1d0)});_0x23061b[_0x4bb044(0x2d0)][_0x4bb044(0x284)](_0x1db586=>{var _0x4e29b9=_0x4bb044;const _0x488cf2=_0x16cb39[_0x4e29b9(0x1ef)][_0x4e29b9(0x2b4)](_0x15bd00=>{var _0x3b5439=_0x4e29b9;_0x15bd00[_0x3b5439(0x2a9)]==_0x1db586[_0x3b5439(0x2a9)]&&_0x15bd00['bay']==_0x1db586[_0x3b5439(0x18e)]&&(_0x15bd00[_0x3b5439(0x2d2)]=parseInt(_0x15bd00[_0x3b5439(0x2d2)])-parseInt(_0x1db586[_0x3b5439(0x19a)]));});}),console['log'](_0x4bb044(0x1d5),_0x16cb39),await _0x16cb39[_0x4bb044(0x1c0)]();const _0x28d974=await c_payment_data['findOne']({'invoice':_0x567c6e[_0x4bb044(0x25d)][_0x4bb044(0x2c2)]});_0x28d974[_0x4bb044(0x28b)]=_0x567c6e[_0x4bb044(0x25d)]['suppliers'],await _0x28d974[_0x4bb044(0x1c0)](),_0x567c6e[_0x4bb044(0x1a3)](_0x4bb044(0x28c),_0x4bb044(0x21e)),_0x30adb5[_0x4bb044(0x1e9)](_0x4bb044(0x216));}catch(_0x5f0a0b){console['log'](_0x5f0a0b);}}),router[a0_0x3b0c45(0x2b8)](a0_0x3b0c45(0x18b),auth,async(_0x464c08,_0x554911)=>{var _0x5ab6c3=a0_0x3b0c45;try{const _0x2d626a=_0x464c08[_0x5ab6c3(0x285)]['id'],{invoice:_0x3896f8,customer:_0x5100ed,receivable_amount:_0x359c98,received_amount:_0x1263fd}=_0x464c08[_0x5ab6c3(0x25d)],_0x1e4e88=await sales[_0x5ab6c3(0x295)](_0x2d626a);console[_0x5ab6c3(0x2ac)](_0x1e4e88);var _0x12a6f4=_0x359c98-_0x1263fd;console[_0x5ab6c3(0x2ac)](_0x1263fd),_0x1e4e88[_0x5ab6c3(0x273)]=parseFloat(_0x1263fd)+parseFloat(_0x1e4e88[_0x5ab6c3(0x273)]),_0x1e4e88[_0x5ab6c3(0x19f)]=_0x12a6f4,console[_0x5ab6c3(0x2ac)](_0x1e4e88);const _0x5a8bd1=await _0x1e4e88[_0x5ab6c3(0x1c0)](),_0x118d39=await c_payment_data[_0x5ab6c3(0x1e4)]({'invoice':_0x3896f8});_0x118d39[_0x5ab6c3(0x1d9)]=_0x12a6f4,await _0x118d39[_0x5ab6c3(0x1c0)]();let _0x17a69b=new Date(),_0x2ce822=('0'+_0x17a69b[_0x5ab6c3(0x24c)]())['slice'](-0x2),_0xc61ea7=('0'+(_0x17a69b[_0x5ab6c3(0x1ab)]()+0x1))[_0x5ab6c3(0x246)](-0x2),_0x2a4c8a=_0x17a69b[_0x5ab6c3(0x21c)](),_0x1a24e2=_0x2a4c8a+'-'+_0xc61ea7+'-'+_0x2ce822;const _0x4310c9=new customer_payment({'invoice':_0x3896f8,'date':_0x2a4c8a+'-'+_0xc61ea7+'-'+_0x2ce822,'customer':_0x5100ed,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x1263fd}),_0x20450f=await _0x4310c9['save']();_0x464c08['flash'](_0x5ab6c3(0x28c),'payment\x20successfull'),_0x554911[_0x5ab6c3(0x1e9)]('/all_sales/view');}catch(_0x549ed9){console[_0x5ab6c3(0x2ac)](_0x549ed9);}}),router[a0_0x3b0c45(0x1f7)](a0_0x3b0c45(0x261),auth,async(_0x16c72b,_0x4dff0d)=>{var _0x5b3d34=a0_0x3b0c45;try{const {username:_0x403e0d,email:_0x3623f1,role:_0x5ddaf8}=_0x16c72b['user'],_0x272750=_0x16c72b['user'],_0x1b0a72=await profile[_0x5b3d34(0x1e4)]({'email':_0x272750[_0x5b3d34(0x1b6)]}),_0x14eff6=await master_shop[_0x5b3d34(0x223)]();console['log'](_0x5b3d34(0x23a),_0x14eff6);const _0x32730c=_0x16c72b[_0x5b3d34(0x285)]['id'],_0x434717=await sales['findById'](_0x32730c);console[_0x5b3d34(0x2ac)](_0x434717);const _0x247480=await customer[_0x5b3d34(0x1e4)]({'name':_0x434717[_0x5b3d34(0x1f9)]});console[_0x5b3d34(0x2ac)](_0x247480);if(_0x14eff6[0x0]['language']==_0x5b3d34(0x255)){var _0x55a3c3=users['English'];console[_0x5b3d34(0x2ac)](_0x55a3c3);}else{if(_0x14eff6[0x0]['language']=='Hindi')var _0x55a3c3=users[_0x5b3d34(0x2ce)];else{if(_0x14eff6[0x0][_0x5b3d34(0x222)]==_0x5b3d34(0x2a4))var _0x55a3c3=users[_0x5b3d34(0x2a4)];else{if(_0x14eff6[0x0][_0x5b3d34(0x222)]==_0x5b3d34(0x1fa))var _0x55a3c3=users[_0x5b3d34(0x1fa)];else{if(_0x14eff6[0x0]['language']==_0x5b3d34(0x1da))var _0x55a3c3=users[_0x5b3d34(0x1da)];else{if(_0x14eff6[0x0]['language']==_0x5b3d34(0x1bf))var _0x55a3c3=users['Portuguese'];else{if(_0x14eff6[0x0][_0x5b3d34(0x222)]==_0x5b3d34(0x1a0))var _0x55a3c3=users[_0x5b3d34(0x1a0)];else{if(_0x14eff6[0x0]['language']==_0x5b3d34(0x20e))var _0x55a3c3=users['Arabic'];}}}}}}}_0x4dff0d[_0x5b3d34(0x1f0)]('sales_invoice',{'success':_0x16c72b[_0x5b3d34(0x1a3)]('success'),'errors':_0x16c72b[_0x5b3d34(0x1a3)](_0x5b3d34(0x205)),'role':_0x272750,'profile':_0x1b0a72,'master_shop':_0x14eff6,'customers':_0x247480,'sales':_0x434717,'language':_0x55a3c3});}catch(_0x3ca92c){console[_0x5b3d34(0x2ac)](_0x3ca92c);}}),router[a0_0x3b0c45(0x1f7)]('/view/return_sales/:id',auth,async(_0x16661e,_0x39d555)=>{var _0x58616c=a0_0x3b0c45;try{const {username:_0x35aa8d,email:_0x4b37d9,role:_0x3d1535}=_0x16661e['user'],_0x4d81f7=_0x16661e['user'],_0x5766c6=await profile[_0x58616c(0x1e4)]({'email':_0x4d81f7['email']}),_0x1afa6e=await master_shop['find'](),_0x1c773c=_0x16661e[_0x58616c(0x285)]['id'],_0x181075=await sales_finished['findById'](_0x1c773c),_0x240da2=await warehouse[_0x58616c(0x1f8)]([{'$match':{'name':_0x181075['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x58616c(0x297),'name':{'$first':_0x58616c(0x270)},'product_stock':{'$first':_0x58616c(0x263)},'bay':{'$first':_0x58616c(0x229)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x58616c(0x23d)},'floorlevel':{'$first':_0x58616c(0x1d3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x58616c(0x280)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x58616c(0x218)},'expiry_date':{'$first':_0x58616c(0x2a3)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x58616c(0x1fd)},'batch_code':{'$first':_0x58616c(0x23f)},'maxPerUnit':{'$first':_0x58616c(0x197)}}}]),_0xbc7593=await product['find']({}),_0x2e46d6=await warehouse['aggregate']([{'$match':{'status':_0x58616c(0x203),'warehouse_category':'Finished\x20Goods','name':{'$ne':'Return\x20Goods','$ne':'Quality\x20Inspection'}}},{'$group':{'_id':'$name','name':{'$first':_0x58616c(0x248)}}},{'$sort':{'name':0x1}}]);var _0x420d53=[_0x58616c(0x2a6)];const _0x5eefe6=await warehouse[_0x58616c(0x1f8)]([{'$match':{'status':_0x58616c(0x203),'name':_0x58616c(0x1eb)}},{'$group':{'_id':_0x58616c(0x248),'name':{'$first':_0x58616c(0x248)}}},{'$sort':{'name':0x1}}]);if(_0x1afa6e[0x0][_0x58616c(0x222)]==_0x58616c(0x255)){var _0x381bd2=users['English'];console[_0x58616c(0x2ac)](_0x381bd2);}else{if(_0x1afa6e[0x0][_0x58616c(0x222)]==_0x58616c(0x2ce))var _0x381bd2=users[_0x58616c(0x2ce)];else{if(_0x1afa6e[0x0]['language']==_0x58616c(0x2a4))var _0x381bd2=users[_0x58616c(0x2a4)];else{if(_0x1afa6e[0x0]['language']==_0x58616c(0x1fa))var _0x381bd2=users[_0x58616c(0x1fa)];else{if(_0x1afa6e[0x0][_0x58616c(0x222)]=='French')var _0x381bd2=users[_0x58616c(0x1da)];else{if(_0x1afa6e[0x0][_0x58616c(0x222)]=='Portuguese\x20(BR)')var _0x381bd2=users['Portuguese'];else{if(_0x1afa6e[0x0]['language']==_0x58616c(0x1a0))var _0x381bd2=users[_0x58616c(0x1a0)];else{if(_0x1afa6e[0x0][_0x58616c(0x222)]==_0x58616c(0x20e))var _0x381bd2=users[_0x58616c(0x1c1)];}}}}}}}_0x39d555['render'](_0x58616c(0x2a1),{'success':_0x16661e[_0x58616c(0x1a3)](_0x58616c(0x28c)),'errors':_0x16661e[_0x58616c(0x1a3)](_0x58616c(0x205)),'role':_0x4d81f7,'profile':_0x5766c6,'user':_0x181075,'stock':_0x240da2,'master_shop':_0x1afa6e,'unit':_0xbc7593,'language':_0x381bd2,'warehouses':_0x2e46d6,'rooms':_0x420d53,'warehouse_QA':_0x5eefe6});}catch(_0x3e7284){console['log'](_0x3e7284),_0x39d555[_0x58616c(0x1e8)](0xc8)['json']({'message':_0x3e7284[_0x58616c(0x1d4)]});}}),router[a0_0x3b0c45(0x2b8)]('/view/return_sales/:id',auth,async(_0x90c751,_0x425740)=>{var _0x57b3c6=a0_0x3b0c45;if(_0x90c751['body'][_0x57b3c6(0x2d3)]=='QA')try{const {invoice:_0x5c808d,date:_0x1c212b,warehouse_name:_0x2ad3b5,product_name:_0x1a0084,primary_code:_0x41c834,secondary_code:_0x2ccfeb,product_code:_0x4ccff5,sales_quantity:_0x514850,stocks:_0x51d3f7,return_qty:_0x294f73,Room_name:_0x4391f5,to_warehouse_name_QA:_0x2e5f30,to_Room_name_QA:_0x2734e3,note:_0x4be57d,for_categorize:_0xcec7a0,product_name_QA1:_0x11abf2}=_0x90c751[_0x57b3c6(0x25d)];if(typeof _0x11abf2==_0x57b3c6(0x196))var _0xf9c252=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x258)]],_0x379bca=[_0x90c751['body'][_0x57b3c6(0x18c)]],_0x3e0445=[_0x90c751['body'][_0x57b3c6(0x244)]],_0x2358ca=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2a5)]],_0x37c865=[_0x90c751['body'][_0x57b3c6(0x1c9)]],_0x3ada9d=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x1be)]],_0x5dfc14=[_0x90c751[_0x57b3c6(0x25d)]['return_qty_QA']],_0x45dce5=[_0x90c751['body'][_0x57b3c6(0x1d2)]],_0x2cb87b=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x206)]],_0x5d5616=[_0x90c751['body'][_0x57b3c6(0x1ac)]],_0x5e6358=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x217)]],_0x2515ae=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x232)]],_0x3ada42=[_0x90c751['body']['production_date_QA']],_0x5d3fb1=[_0x90c751[_0x57b3c6(0x25d)]['expiry_date_QA']];else var _0xf9c252=[..._0x90c751['body'][_0x57b3c6(0x258)]],_0x379bca=[..._0x90c751['body']['primary_code_QA']],_0x3e0445=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x244)]],_0x2358ca=[..._0x90c751['body'][_0x57b3c6(0x2a5)]],_0x37c865=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x1c9)]],_0x3ada9d=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x1be)]],_0x5dfc14=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x1cc)]],_0x45dce5=[..._0x90c751[_0x57b3c6(0x25d)]['maxPerUnit_QA']],_0x2cb87b=[..._0x90c751[_0x57b3c6(0x25d)]['maxProducts_QA']],_0x5d5616=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x1ac)]],_0x5e6358=[..._0x90c751['body'][_0x57b3c6(0x217)]],_0x2515ae=[..._0x90c751['body']['unit_QA']],_0x3ada42=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x235)]],_0x5d3fb1=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x27a)]];const _0x568b3b=_0xf9c252['map'](_0x599f6f=>{return _0x599f6f={'product_name':_0x599f6f};});_0x379bca[_0x57b3c6(0x284)]((_0x4e5040,_0x2ad93c)=>{var _0x53635e=_0x57b3c6;_0x568b3b[_0x2ad93c][_0x53635e(0x2bb)]=_0x4e5040;}),_0x3e0445[_0x57b3c6(0x284)]((_0x1c2f40,_0x315405)=>{var _0x13aa3d=_0x57b3c6;_0x568b3b[_0x315405][_0x13aa3d(0x298)]=_0x1c2f40;}),_0x2358ca['forEach']((_0x1ed571,_0x1c2cd0)=>{var _0x189745=_0x57b3c6;_0x568b3b[_0x1c2cd0][_0x189745(0x2c6)]=_0x1ed571;}),_0x37c865['forEach']((_0x58b34a,_0x3a6905)=>{_0x568b3b[_0x3a6905]['sale_qty']=_0x58b34a;}),_0x3ada9d['forEach']((_0x3236f3,_0x555ad0)=>{var _0x535e18=_0x57b3c6;_0x568b3b[_0x555ad0][_0x535e18(0x26d)]=_0x3236f3;}),_0x5dfc14['forEach']((_0x452a26,_0x357bc3)=>{var _0x4ea4d0=_0x57b3c6;_0x568b3b[_0x357bc3][_0x4ea4d0(0x1f2)]=_0x452a26;}),_0x45dce5[_0x57b3c6(0x284)]((_0x5a088f,_0x57b362)=>{var _0x46b9a6=_0x57b3c6;_0x568b3b[_0x57b362][_0x46b9a6(0x2aa)]=_0x5a088f;}),_0x2cb87b[_0x57b3c6(0x284)]((_0x4b7d9f,_0x3aade9)=>{var _0x582444=_0x57b3c6;_0x568b3b[_0x3aade9][_0x582444(0x228)]=_0x4b7d9f;}),_0x5d5616['forEach']((_0x5766ab,_0x27924e)=>{var _0x29e339=_0x57b3c6;_0x568b3b[_0x27924e][_0x29e339(0x26f)]=_0x5766ab;}),_0x5e6358[_0x57b3c6(0x284)]((_0xfbb06c,_0x11a44d)=>{var _0x24ffcf=_0x57b3c6;_0x568b3b[_0x11a44d][_0x24ffcf(0x198)]=_0xfbb06c;}),_0x2515ae['forEach']((_0x264e09,_0x512896)=>{var _0x4de552=_0x57b3c6;_0x568b3b[_0x512896][_0x4de552(0x236)]=_0x264e09;}),_0x3ada42[_0x57b3c6(0x284)]((_0x3e4e51,_0x452302)=>{var _0x1514df=_0x57b3c6;_0x568b3b[_0x452302][_0x1514df(0x1c7)]=_0x3e4e51;}),_0x5d3fb1['forEach']((_0x22d2dd,_0x41be35)=>{var _0x4d18e7=_0x57b3c6;_0x568b3b[_0x41be35][_0x4d18e7(0x25a)]=_0x22d2dd;});const _0x454e0=await sales_finished['findOne']({'invoice':_0x5c808d});_0x454e0[_0x57b3c6(0x19b)]=_0x57b3c6(0x267);const _0xca7978=await _0x454e0[_0x57b3c6(0x1c0)](),_0x185898=new sales_return_finished({'invoice':_0x5c808d,'customer':_0x90c751[_0x57b3c6(0x25d)]['customer'],'date':_0x1c212b,'warehouse_name':_0x2ad3b5,'room':_0x4391f5,'ToWarehouse':_0x2e5f30,'ToRoom':_0x2734e3,'return_sale_QA':_0x568b3b,'note':_0x4be57d,'warehouse_cat':_0xcec7a0}),_0x2e8258=await _0x185898[_0x57b3c6(0x1c0)](),_0xbe7871=await sales_return_finished[_0x57b3c6(0x1e4)]({'invoice':_0x5c808d}),_0x5aa1be=await warehouse[_0x57b3c6(0x1e4)]({'name':_0x2e5f30,'room':_0x2734e3});_0xbe7871[_0x57b3c6(0x262)]['forEach'](_0x1b6a5b=>{var _0x1a8aea=_0x57b3c6,_0x3693a5=0x0;const _0x4b85f3=_0x5aa1be[_0x1a8aea(0x1ef)]['map'](_0x2cc55e=>{var _0x496b83=_0x1a8aea;_0x2cc55e[_0x496b83(0x2a9)]==_0x1b6a5b[_0x496b83(0x2a9)]&&_0x2cc55e[_0x496b83(0x25a)]==_0x1b6a5b[_0x496b83(0x25a)]&&_0x2cc55e[_0x496b83(0x1c7)]==_0x1b6a5b[_0x496b83(0x1c7)]&&_0x2cc55e[_0x496b83(0x26f)]==_0x1b6a5b['batch_code']&&(_0x2cc55e[_0x496b83(0x2d2)]=parseInt(_0x2cc55e['product_stock'])+parseInt(_0x1b6a5b[_0x496b83(0x1f2)]),_0x3693a5++);});_0x3693a5=='0'&&(_0x5aa1be['product_details']=_0x5aa1be[_0x1a8aea(0x1ef)]['concat']({'product_name':_0x1b6a5b['product_name'],'product_stock':_0x1b6a5b[_0x1a8aea(0x1f2)],'primary_code':_0x1b6a5b[_0x1a8aea(0x2bb)],'secondary_code':_0x1b6a5b[_0x1a8aea(0x298)],'product_code':_0x1b6a5b[_0x1a8aea(0x2c6)],'batch_code':_0x1b6a5b[_0x1a8aea(0x26f)],'maxPerUnit':_0x1b6a5b[_0x1a8aea(0x2aa)],'production_date':_0x1b6a5b[_0x1a8aea(0x1c7)],'expiry_date':_0x1b6a5b[_0x1a8aea(0x25a)],'secondary_unit':_0x1b6a5b['secondary_unit'],'unit':_0x1b6a5b[_0x1a8aea(0x236)],'maxProducts':_0x1b6a5b[_0x1a8aea(0x228)],'bay':_0x1b6a5b[_0x1a8aea(0x18e)]}));}),await _0x5aa1be[_0x57b3c6(0x1c0)]();const _0x5bfea7=new c_payment_data({'invoice':_0x5c808d,'customer':_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x1f9)],'reason':_0x57b3c6(0x25c)});await _0x5bfea7[_0x57b3c6(0x1c0)]();const _0xe0a05d=await master_shop[_0x57b3c6(0x223)](),_0x24acd7=await email_settings[_0x57b3c6(0x1e4)](),_0x56d03e=await customer[_0x57b3c6(0x1e4)]({'name':_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x1f9)]});_0xe0a05d[0x0][_0x57b3c6(0x28a)]==0x1?(right_currency=_0xe0a05d[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0xe0a05d[0x0][_0x57b3c6(0x27b)]);var _0xb524ae=_0xf9c252,_0x25b40f=_0x5dfc14,_0x1f997f='',_0x40da30;for(_0x40da30 in _0xb524ae){_0x1f997f+=_0x57b3c6(0x278)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xb524ae[_0x40da30]+_0x57b3c6(0x195)+_0x57b3c6(0x240)+_0x25b40f[_0x40da30]+_0x57b3c6(0x195)+_0x57b3c6(0x29e);}console[_0x57b3c6(0x2ac)](_0x57b3c6(0x247),_0x1f997f);let _0x344b85=nodemailer[_0x57b3c6(0x1f5)]({'service':_0x57b3c6(0x1e3),'auth':{'user':_0x24acd7['email'],'pass':_0x24acd7[_0x57b3c6(0x1cb)]}}),_0x3dba6b={'from':_0x24acd7[_0x57b3c6(0x1b6)],'to':_0x56d03e[_0x57b3c6(0x1b6)],'subject':_0x57b3c6(0x292),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x57b3c6(0x25b)+_0xe0a05d[0x0]['image'],'cid':_0x57b3c6(0x299)}],'html':_0x57b3c6(0x1d8)+'<html><head><title></title>'+'</head><body>'+_0x57b3c6(0x2a7)+_0x57b3c6(0x2d4)+_0x57b3c6(0x2a7)+_0x57b3c6(0x2c7)+_0x57b3c6(0x269)+_0x57b3c6(0x2a7)+'<h2>\x20'+_0xe0a05d[0x0][_0x57b3c6(0x200)]+_0x57b3c6(0x1ff)+_0x57b3c6(0x269)+'</div>'+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x57b3c6(0x1bd)+_0x5c808d+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x57b3c6(0x257)+_0x1c212b+'\x20'+_0x57b3c6(0x1a8)+_0x57b3c6(0x281)+_0x57b3c6(0x269)+_0x57b3c6(0x276)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x57b3c6(0x278)+_0x57b3c6(0x274)+_0x57b3c6(0x2b2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x57b3c6(0x1af)+'</tr>'+_0x57b3c6(0x2af)+_0x57b3c6(0x219)+'\x20'+_0x1f997f+'\x20'+_0x57b3c6(0x189)+'</table>'+_0x57b3c6(0x2a7)+_0x57b3c6(0x22f)+'<h5>'+_0xe0a05d[0x0]['site_title']+_0x57b3c6(0x281)+'</div>'+_0x57b3c6(0x269)+_0x57b3c6(0x1e6)};_0x344b85[_0x57b3c6(0x251)](_0x3dba6b,function(_0x528988,_0x3c8a9b){var _0x3aa508=_0x57b3c6;_0x528988?(console[_0x3aa508(0x2ac)](_0x528988),console['log'](_0x3aa508(0x20a))):console['log']('Email\x20sent\x20successfully');}),_0x90c751[_0x57b3c6(0x1a3)]('success',_0x57b3c6(0x1e2)),_0x425740[_0x57b3c6(0x1e9)](_0x57b3c6(0x216));}catch(_0x104a0a){_0x425740[_0x57b3c6(0x1e8)](0xc8)[_0x57b3c6(0x1ae)]({'message1':_0x104a0a[_0x57b3c6(0x1d4)]});}else{if(_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2d3)]=='GS')try{const {invoice:_0x88c52c,date:_0x3b42f2,warehouse_name:_0xf75107,product_name:_0x3f4387,primary_code:_0xd084f8,secondary_code:_0x4b79f1,product_code:_0x457563,sales_quantity:_0x382525,stocks:_0x8743f3,return_qty:_0x7caba3,Room_name:_0x22a8bc,to_warehouse_name:_0x43be71,to_Room_name:_0x52f144,note:_0x540d89,level:_0x2d9b35,isle:_0x5577bb,pallet:_0x184d0e,for_categorize:_0x2b0f53}=_0x90c751[_0x57b3c6(0x25d)];if(typeof _0x3f4387=='string')var _0xf9c252=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2a9)]],_0x379bca=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2bb)]],_0x3e0445=[_0x90c751['body'][_0x57b3c6(0x298)]],_0x2358ca=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2c6)]],_0x37c865=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x260)]],_0x5dfc14=[_0x90c751['body'][_0x57b3c6(0x1f2)]],_0xd7676a=[_0x90c751[_0x57b3c6(0x25d)]['bay']],_0x45dce5=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2aa)]],_0x2cb87b=[_0x90c751[_0x57b3c6(0x25d)]['maxProducts']],_0x5d5616=[_0x90c751[_0x57b3c6(0x25d)]['batch_code']],_0x5e6358=[_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x198)]],_0x2515ae=[_0x90c751[_0x57b3c6(0x25d)]['unit']],_0x3ada42=[_0x90c751[_0x57b3c6(0x25d)]['production_date']],_0x5d3fb1=[_0x90c751[_0x57b3c6(0x25d)]['expiry_date']];else var _0xf9c252=[..._0x90c751['body']['product_name']],_0x379bca=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2bb)]],_0x3e0445=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x298)]],_0x2358ca=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2c6)]],_0x37c865=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x260)]],_0x5dfc14=[..._0x90c751['body']['return_qty']],_0xd7676a=[..._0x90c751[_0x57b3c6(0x25d)]['bay']],_0x45dce5=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x2aa)]],_0x2cb87b=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x228)]],_0x5d5616=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x26f)]],_0x5e6358=[..._0x90c751[_0x57b3c6(0x25d)]['secondary_unit']],_0x2515ae=[..._0x90c751['body'][_0x57b3c6(0x236)]],_0x3ada42=[..._0x90c751['body']['production_date']],_0x5d3fb1=[..._0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x25a)]];const _0xf2bda6=_0xf9c252['map'](_0x3be87d=>{return _0x3be87d={'product_name':_0x3be87d};});_0x379bca[_0x57b3c6(0x284)]((_0x176e9f,_0x5e87a9)=>{_0xf2bda6[_0x5e87a9]['primary_code']=_0x176e9f;}),_0x3e0445[_0x57b3c6(0x284)]((_0xf85726,_0x2f32c1)=>{var _0x23a7a6=_0x57b3c6;_0xf2bda6[_0x2f32c1][_0x23a7a6(0x298)]=_0xf85726;}),_0x2358ca[_0x57b3c6(0x284)]((_0x1264b2,_0x372c4b)=>{_0xf2bda6[_0x372c4b]['product_code']=_0x1264b2;}),_0x37c865[_0x57b3c6(0x284)]((_0x1f570f,_0x21e577)=>{var _0x5ea99a=_0x57b3c6;_0xf2bda6[_0x21e577][_0x5ea99a(0x245)]=_0x1f570f;}),_0x5dfc14['forEach']((_0x4b8825,_0x742663)=>{_0xf2bda6[_0x742663]['return_qty']=_0x4b8825;}),_0xd7676a['forEach']((_0x222c00,_0x2ed192)=>{var _0x40a2e7=_0x57b3c6;_0xf2bda6[_0x2ed192][_0x40a2e7(0x18e)]=_0x222c00;}),_0x45dce5[_0x57b3c6(0x284)]((_0x3e6a94,_0x48d182)=>{_0xf2bda6[_0x48d182]['maxPerUnit']=_0x3e6a94;}),_0x2cb87b['forEach']((_0x3262e4,_0x5edd30)=>{var _0x354dc1=_0x57b3c6;_0xf2bda6[_0x5edd30][_0x354dc1(0x228)]=_0x3262e4;}),_0x5d5616['forEach']((_0x3acb98,_0x3cdcea)=>{_0xf2bda6[_0x3cdcea]['batch_code']=_0x3acb98;}),_0x5e6358[_0x57b3c6(0x284)]((_0x26e55f,_0x4a4c6d)=>{var _0x581f32=_0x57b3c6;_0xf2bda6[_0x4a4c6d][_0x581f32(0x198)]=_0x26e55f;}),_0x2515ae['forEach']((_0x3d2bd4,_0x29623e)=>{_0xf2bda6[_0x29623e]['unit']=_0x3d2bd4;}),_0x3ada42['forEach']((_0x23716b,_0x5a300a)=>{var _0x26cda4=_0x57b3c6;_0xf2bda6[_0x5a300a][_0x26cda4(0x1c7)]=_0x23716b;}),_0x5d3fb1['forEach']((_0x102bb2,_0xd6e2d1)=>{var _0xe61bae=_0x57b3c6;_0xf2bda6[_0xd6e2d1][_0xe61bae(0x25a)]=_0x102bb2;});var _0x398c5d=0x0;_0xf2bda6['forEach'](_0xdc9e88=>{var _0x5ddb75=_0x57b3c6;(parseInt(_0xdc9e88[_0x5ddb75(0x245)])<parseInt(_0xdc9e88[_0x5ddb75(0x1f2)])||parseInt(_0xdc9e88[_0x5ddb75(0x26d)])<parseInt(_0xdc9e88[_0x5ddb75(0x1f2)])&&parseInt(_0xdc9e88[_0x5ddb75(0x245)])>parseInt(_0xdc9e88[_0x5ddb75(0x1f2)])||parseInt(_0xdc9e88[_0x5ddb75(0x1f2)])==0x0)&&_0x398c5d++;});if(_0x398c5d!=0x0)return _0x90c751['flash'](_0x57b3c6(0x205),_0x57b3c6(0x1b9)),_0x425740[_0x57b3c6(0x1e9)](_0x57b3c6(0x1a2));const _0x4720eb=await sales_finished['findOne']({'invoice':_0x88c52c});_0x4720eb[_0x57b3c6(0x19b)]=_0x57b3c6(0x267);const _0x4046a0=await _0x4720eb[_0x57b3c6(0x1c0)](),_0x5b0ae0=new sales_return_finished({'invoice':_0x88c52c,'customer':_0x90c751['body'][_0x57b3c6(0x1f9)],'date':_0x3b42f2,'warehouse_name':_0xf75107,'room':_0x22a8bc,'ToWarehouse':_0x43be71,'ToRoom':_0x52f144,'return_sale':_0xf2bda6,'note':_0x540d89,'warehouse_cat':_0x2b0f53}),_0x333122=await _0x5b0ae0[_0x57b3c6(0x1c0)](),_0x14bd4b=await sales_return_finished[_0x57b3c6(0x1e4)]({'invoice':_0x88c52c}),_0x2c5a03=await warehouse[_0x57b3c6(0x1e4)]({'name':_0x43be71,'room':_0x52f144,'warehouse_category':'Finished\x20Goods'});_0x14bd4b[_0x57b3c6(0x1df)]['forEach'](_0x329029=>{var _0x41090b=_0x57b3c6,_0x1d07b7=0x0;const _0x1fce43=_0x2c5a03[_0x41090b(0x1ef)][_0x41090b(0x2b4)](_0x15ea1e=>{var _0x38c128=_0x41090b;_0x15ea1e[_0x38c128(0x2a9)]==_0x329029['product_name']&&_0x15ea1e[_0x38c128(0x18e)]==_0x329029[_0x38c128(0x18e)]&&_0x15ea1e[_0x38c128(0x25a)]==_0x329029['expiry_date']&&_0x15ea1e[_0x38c128(0x1c7)]==_0x329029[_0x38c128(0x1c7)]&&_0x15ea1e['batch_code']==_0x329029[_0x38c128(0x26f)]&&(_0x15ea1e[_0x38c128(0x2d2)]=parseInt(_0x15ea1e[_0x38c128(0x2d2)])+parseInt(_0x329029[_0x38c128(0x1f2)]),_0x1d07b7++);});_0x1d07b7=='0'&&(_0x2c5a03[_0x41090b(0x1ef)]=_0x2c5a03[_0x41090b(0x1ef)][_0x41090b(0x271)]({'product_name':_0x329029[_0x41090b(0x2a9)],'product_stock':_0x329029['return_qty'],'primary_code':_0x329029[_0x41090b(0x2bb)],'secondary_code':_0x329029[_0x41090b(0x298)],'product_code':_0x329029['product_code'],'bay':_0x329029['bay'],'batch_code':_0x329029[_0x41090b(0x26f)],'maxPerUnit':_0x329029[_0x41090b(0x2aa)],'production_date':_0x329029['production_date'],'expiry_date':_0x329029[_0x41090b(0x25a)],'secondary_unit':_0x329029[_0x41090b(0x198)],'unit':_0x329029['unit'],'maxProducts':_0x329029['maxProducts']}));}),await _0x2c5a03[_0x57b3c6(0x1c0)](),console[_0x57b3c6(0x2ac)](_0x90c751['body']);const _0x4330b3=new c_payment_data({'invoice':_0x88c52c,'customer':_0x90c751[_0x57b3c6(0x25d)]['customer'],'reason':_0x57b3c6(0x25c)});await _0x4330b3[_0x57b3c6(0x1c0)]();const _0x1667d0=await master_shop[_0x57b3c6(0x223)]();console['log'](_0x57b3c6(0x242),_0x1667d0[0x0][_0x57b3c6(0x1e5)]);const _0x53b915=await email_settings[_0x57b3c6(0x1e4)](),_0xf5b7a1=await customer[_0x57b3c6(0x1e4)]({'name':_0x90c751[_0x57b3c6(0x25d)][_0x57b3c6(0x1f9)]});console[_0x57b3c6(0x2ac)]('customer_data',_0xf5b7a1);_0x1667d0[0x0][_0x57b3c6(0x28a)]==0x1?(right_currency=_0x1667d0[0x0][_0x57b3c6(0x27b)],left_currency=''):(right_currency='',left_currency=_0x1667d0[0x0][_0x57b3c6(0x27b)]);var _0xb524ae=_0xf9c252,_0x25b40f=_0x5dfc14,_0x1f997f='',_0x40da30;for(_0x40da30 in _0xb524ae){_0x1f997f+=_0x57b3c6(0x278)+_0x57b3c6(0x240)+_0xb524ae[_0x40da30]+_0x57b3c6(0x195)+_0x57b3c6(0x240)+_0x25b40f[_0x40da30]+_0x57b3c6(0x195)+_0x57b3c6(0x29e);}console[_0x57b3c6(0x2ac)](_0x57b3c6(0x247),_0x1f997f);let _0x5e8362=nodemailer[_0x57b3c6(0x1f5)]({'service':_0x57b3c6(0x1e3),'auth':{'user':_0x53b915['email'],'pass':_0x53b915[_0x57b3c6(0x1cb)]}}),_0x2a73da={'from':_0x53b915[_0x57b3c6(0x1b6)],'to':_0xf5b7a1[_0x57b3c6(0x1b6)],'subject':_0x57b3c6(0x292),'attachments':[{'filename':_0x57b3c6(0x18d),'path':__dirname+'/../public'+'/upload/'+_0x1667d0[0x0][_0x57b3c6(0x1e5)],'cid':'logo'}],'html':_0x57b3c6(0x1d8)+_0x57b3c6(0x253)+_0x57b3c6(0x2a2)+_0x57b3c6(0x2a7)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x57b3c6(0x2a7)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x57b3c6(0x269)+'<div>'+_0x57b3c6(0x207)+_0x1667d0[0x0][_0x57b3c6(0x200)]+_0x57b3c6(0x1ff)+_0x57b3c6(0x269)+_0x57b3c6(0x269)+'<hr\x20class=\x22my-3\x22>'+_0x57b3c6(0x2a7)+_0x57b3c6(0x1cd)+_0x57b3c6(0x1bd)+_0x88c52c+'\x20'+_0x57b3c6(0x283)+_0x57b3c6(0x257)+_0x3b42f2+'\x20'+_0x57b3c6(0x1a8)+_0x57b3c6(0x281)+'</div>'+_0x57b3c6(0x276)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x57b3c6(0x274)+_0x57b3c6(0x2b2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x57b3c6(0x1af)+_0x57b3c6(0x29e)+_0x57b3c6(0x2af)+_0x57b3c6(0x219)+'\x20'+_0x1f997f+'\x20'+_0x57b3c6(0x189)+'</table>'+_0x57b3c6(0x2a7)+'<strong>\x20Regards\x20</strong>'+_0x57b3c6(0x1ad)+_0x1667d0[0x0][_0x57b3c6(0x200)]+'</h5>'+_0x57b3c6(0x269)+_0x57b3c6(0x269)+'</body></html>'};_0x5e8362[_0x57b3c6(0x251)](_0x2a73da,function(_0xc034b6,_0x3c2851){var _0x39855e=_0x57b3c6;_0xc034b6?(console[_0x39855e(0x2ac)](_0xc034b6),console[_0x39855e(0x2ac)](_0x39855e(0x20a))):console['log'](_0x39855e(0x1dd));}),_0x90c751[_0x57b3c6(0x1a3)](_0x57b3c6(0x28c),_0x57b3c6(0x1e2)),_0x425740[_0x57b3c6(0x1e9)](_0x57b3c6(0x216));}catch(_0x513694){console[_0x57b3c6(0x2ac)](_0x513694),_0x425740[_0x57b3c6(0x1e8)](0xc8)[_0x57b3c6(0x1ae)]({'message1':_0x513694['message']});}}}),router[a0_0x3b0c45(0x1f7)]('/barcode/:id',auth,async(_0x246a7d,_0x41ae9b)=>{var _0x57e470=a0_0x3b0c45;try{const {username:_0x5001e7,email:_0x3572db,role:_0x1c1757}=_0x246a7d['user'],_0x48ddd0=_0x246a7d[_0x57e470(0x27c)],_0x2689a8=await profile[_0x57e470(0x1e4)]({'email':_0x48ddd0[_0x57e470(0x1b6)]}),_0x3b5f7d=await master_shop['find']();console['log'](_0x57e470(0x237),_0x3b5f7d);const _0xf34a60=_0x246a7d['params']['id'],_0x3bf0c3=await sales[_0x57e470(0x295)](_0xf34a60);console[_0x57e470(0x2ac)](_0x57e470(0x243),_0x3bf0c3);if(_0x3b5f7d[0x0]['language']==_0x57e470(0x255))var _0x401481=users[_0x57e470(0x29d)];else{if(_0x3b5f7d[0x0][_0x57e470(0x222)]=='Hindi')var _0x401481=users[_0x57e470(0x2ce)];else{if(_0x3b5f7d[0x0][_0x57e470(0x222)]=='German')var _0x401481=users['German'];else{if(_0x3b5f7d[0x0][_0x57e470(0x222)]==_0x57e470(0x1fa))var _0x401481=users['Spanish'];else{if(_0x3b5f7d[0x0][_0x57e470(0x222)]==_0x57e470(0x1da))var _0x401481=users[_0x57e470(0x1da)];else{if(_0x3b5f7d[0x0]['language']==_0x57e470(0x1bf))var _0x401481=users['Portuguese'];else{if(_0x3b5f7d[0x0][_0x57e470(0x222)]==_0x57e470(0x1a0))var _0x401481=users[_0x57e470(0x1a0)];else{if(_0x3b5f7d[0x0][_0x57e470(0x222)]==_0x57e470(0x20e))var _0x401481=users['Arabic'];}}}}}}}_0x41ae9b['render'](_0x57e470(0x254),{'success':_0x246a7d[_0x57e470(0x1a3)](_0x57e470(0x28c)),'errors':_0x246a7d[_0x57e470(0x1a3)](_0x57e470(0x205)),'role':_0x48ddd0,'profile':_0x2689a8,'alldata':_0x3bf0c3,'master_shop':_0x3b5f7d,'language':_0x401481});}catch(_0x105495){console[_0x57e470(0x2ac)](_0x105495);}}),router['post'](a0_0x3b0c45(0x2b5),async(_0x434292,_0x3af069)=>{var _0x4e4103=a0_0x3b0c45;const {product_code:_0x2fe0f2,warehouse_name:_0x45a0cc,rooms_data:_0x23d3ab,Roomslist:_0x33d67b,sales_category:_0x4e5672}=_0x434292['body'],_0x102876=_0x33d67b[_0x4e4103(0x202)](','),_0x5045b0=[];async function _0x3870a8(_0x3ffa98){var _0x9d32a=_0x4e4103;const _0x32ae18=await warehouse[_0x9d32a(0x1f8)]([{'$match':{'name':_0x45a0cc,'room':_0x3ffa98}},{'$unwind':_0x9d32a(0x2cc)},{'$match':{'product_details.primary_code':_0x2fe0f2}},{'$group':{'_id':_0x9d32a(0x297),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x9d32a(0x263)},'primary_code':{'$first':_0x9d32a(0x1f6)},'secondary_code':{'$first':_0x9d32a(0x280)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x9d32a(0x29c)},'bay':{'$first':_0x9d32a(0x229)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x9d32a(0x1d3)},'unit':{'$first':_0x9d32a(0x294)},'secondary_unit':{'$first':_0x9d32a(0x220)},'storage':{'$first':_0x9d32a(0x209)},'rack':{'$first':_0x9d32a(0x218)},'expiry_date':{'$first':_0x9d32a(0x2a3)},'production_date':{'$first':_0x9d32a(0x204)},'maxPerUnit':{'$first':_0x9d32a(0x197)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x9d32a(0x279)},'uuid':{'$first':_0x9d32a(0x21a)},'gross_price':{'$first':_0x9d32a(0x2c5)},'sales_category':{'$first':'$product_details.sales_category'}}}]),_0x11c5a1=await warehouse['aggregate']([{'$match':{'name':_0x45a0cc,'room':_0x3ffa98}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2fe0f2}},{'$group':{'_id':_0x9d32a(0x297),'name':{'$first':_0x9d32a(0x270)},'product_stock':{'$first':_0x9d32a(0x263)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x9d32a(0x280)},'product_code':{'$first':_0x9d32a(0x1c3)},'level':{'$first':_0x9d32a(0x229)},'isle':{'$first':_0x9d32a(0x1b4)},'type':{'$first':_0x9d32a(0x23d)},'pallet':{'$first':_0x9d32a(0x1d3)},'unit':{'$first':_0x9d32a(0x294)},'secondary_unit':{'$first':_0x9d32a(0x220)},'storage':{'$first':_0x9d32a(0x209)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x9d32a(0x2a3)},'production_date':{'$first':_0x9d32a(0x204)},'maxPerUnit':{'$first':_0x9d32a(0x197)},'batch_code':{'$first':_0x9d32a(0x23f)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x9d32a(0x279)},'uuid':{'$first':_0x9d32a(0x21a)},'gross_price':{'$first':_0x9d32a(0x2c5)},'sales_category':{'$first':_0x9d32a(0x2ae)}}}]);if(_0x32ae18[_0x9d32a(0x1cf)]>0x0)_0x5045b0['push'](_0x32ae18);else _0x11c5a1[_0x9d32a(0x1cf)]>0x0&&_0x5045b0['push'](_0x11c5a1);}const _0x182527=_0x102876[_0x4e4103(0x2b4)](_0x307282=>_0x3870a8(_0x307282));await Promise[_0x4e4103(0x1b1)](_0x182527),_0x3af069[_0x4e4103(0x1ae)](_0x5045b0);}),router[a0_0x3b0c45(0x2b8)](a0_0x3b0c45(0x238),async(_0x181bd6,_0x32a02a)=>{var _0x52ba25=a0_0x3b0c45;const {product_code:_0x4b4d56,warehouse_name:_0x3b2161,rooms_data:_0x237b21,Roomslist:_0x5854d4,sales_category:_0x5b7a64}=_0x181bd6['body'],_0x5f9fe6=_0x5854d4['split'](','),_0x529c82=[];async function _0x54a2bd(_0x157a1c){var _0xf8a4bf=a0_0x5189;const _0x48bad4=await warehouse[_0xf8a4bf(0x1f8)]([{'$match':{'name':_0x3b2161,'room':_0x157a1c}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x4b4d56,'product_details.sales_category':_0x5b7a64,'product_details.type_products':'log'}},{'$group':{'_id':_0xf8a4bf(0x297),'name':{'$first':_0xf8a4bf(0x270)},'product_stock':{'$first':_0xf8a4bf(0x263)},'primary_code':{'$first':_0xf8a4bf(0x1f6)},'secondary_code':{'$first':_0xf8a4bf(0x280)},'product_code':{'$first':_0xf8a4bf(0x1c3)},'level':{'$first':_0xf8a4bf(0x29c)},'bay':{'$first':_0xf8a4bf(0x229)},'type':{'$first':_0xf8a4bf(0x23d)},'pallet':{'$first':_0xf8a4bf(0x1d3)},'unit':{'$first':_0xf8a4bf(0x294)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0xf8a4bf(0x209)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xf8a4bf(0x2a3)},'production_date':{'$first':_0xf8a4bf(0x204)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0xf8a4bf(0x23f)},'product_cat':{'$first':_0xf8a4bf(0x27d)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0xf8a4bf(0x28f)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0xf8a4bf(0x2c5)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':_0xf8a4bf(0x231)}}}]);console[_0xf8a4bf(0x2ac)](_0xf8a4bf(0x2ac)+'\x20<>\x20'+_0x4b4d56+_0xf8a4bf(0x208)+_0x5b7a64);const _0x6bf911=await warehouse[_0xf8a4bf(0x1f8)]([{'$match':{'name':_0x3b2161,'room':_0x157a1c}},{'$unwind':_0xf8a4bf(0x2cc)},{'$match':{'product_details.secondary_code':_0x4b4d56,'product_details.sales_category':_0x5b7a64,'product_details.type_products':'log'}},{'$group':{'_id':_0xf8a4bf(0x297),'name':{'$first':_0xf8a4bf(0x270)},'product_stock':{'$first':_0xf8a4bf(0x263)},'primary_code':{'$first':_0xf8a4bf(0x1f6)},'secondary_code':{'$first':_0xf8a4bf(0x280)},'product_code':{'$first':_0xf8a4bf(0x1c3)},'level':{'$first':_0xf8a4bf(0x229)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xf8a4bf(0x23d)},'pallet':{'$first':_0xf8a4bf(0x1d3)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xf8a4bf(0x220)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xf8a4bf(0x218)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xf8a4bf(0x204)},'maxPerUnit':{'$first':_0xf8a4bf(0x197)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0xf8a4bf(0x27d)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0xf8a4bf(0x28f)},'invoice':{'$first':_0xf8a4bf(0x279)},'uuid':{'$first':_0xf8a4bf(0x21a)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0xf8a4bf(0x2ae)},'type_products':{'$first':_0xf8a4bf(0x231)}}}]);if(_0x48bad4['length']>0x0)_0x529c82[_0xf8a4bf(0x1f1)](_0x48bad4);else _0x6bf911['length']>0x0&&_0x529c82[_0xf8a4bf(0x1f1)](_0x6bf911);}const _0x373b51=_0x5f9fe6[_0x52ba25(0x2b4)](_0x50aa22=>_0x54a2bd(_0x50aa22));await Promise[_0x52ba25(0x1b1)](_0x373b51),_0x32a02a[_0x52ba25(0x1ae)](_0x529c82);}),router[a0_0x3b0c45(0x2b8)](a0_0x3b0c45(0x19c),async(_0x18f8bc,_0x1cb3fa)=>{var _0x7d41f8=a0_0x3b0c45;try{const {prduct_code:_0x4782fc,warehouse_data:_0x6e30a9,qty_req:_0x4e6c2d}=_0x18f8bc[_0x7d41f8(0x25d)];let _0x41ba58=_0x4782fc['split']('~'),_0x2a22df=_0x4e6c2d[_0x7d41f8(0x202)]('~'),_0x309bbb=[],_0x341ab3=0x0;for(let _0x56cccb=0x0;_0x56cccb<=_0x41ba58[_0x7d41f8(0x1cf)]-0x1;_0x56cccb++){const _0x213634=_0x41ba58[_0x56cccb],_0x5dc18c=_0x2a22df[_0x56cccb],_0x1e0013=await warehouse[_0x7d41f8(0x1f8)]([{'$match':{'name':_0x6e30a9}},{'$unwind':_0x7d41f8(0x2cc)},{'$match':{'product_details.product_code':_0x213634,'product_details.isAvailable':'true','product_details.isUsed':_0x7d41f8(0x214)}},{'$sort':{'product_details.date_received':0x1,'product_details.level':-0x1,'product_details.bay':-0x1}},{'$group':{'_id':_0x7d41f8(0x297),'name':{'$first':_0x7d41f8(0x270)},'product_stock':{'$first':_0x7d41f8(0x263)},'primary_code':{'$first':_0x7d41f8(0x1f6)},'secondary_code':{'$first':_0x7d41f8(0x280)},'product_code':{'$first':_0x7d41f8(0x1c3)},'level':{'$first':_0x7d41f8(0x29c)},'bay':{'$first':_0x7d41f8(0x229)},'type':{'$first':_0x7d41f8(0x23d)},'pallet':{'$first':_0x7d41f8(0x1d3)},'unit':{'$first':_0x7d41f8(0x294)},'secondary_unit':{'$first':_0x7d41f8(0x220)},'storage':{'$first':_0x7d41f8(0x209)},'rack':{'$first':_0x7d41f8(0x218)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x7d41f8(0x197)},'batch_code':{'$first':_0x7d41f8(0x23f)},'product_cat':{'$first':_0x7d41f8(0x27d)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x7d41f8(0x28f)},'invoice':{'$first':_0x7d41f8(0x279)},'uuid':{'$first':_0x7d41f8(0x21a)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x7d41f8(0x2ae)},'date_received':{'$first':'$product_details.date_recieved'},'warehouse_id':{'$first':_0x7d41f8(0x1fb)}}}]),_0x4e981d=_0x1e0013[_0x7d41f8(0x1b7)]((_0x227c22,_0x2b199b)=>new Date(_0x227c22['date_received'])-new Date(_0x2b199b[_0x7d41f8(0x22b)]));let _0x55fa64=_0x5dc18c;for(let _0x46f9d4=0x0;_0x46f9d4<=_0x4e981d['length']-0x1&&_0x55fa64>0x0;_0x46f9d4++){const _0x4ba736=_0x4e981d[_0x46f9d4];if(_0x4ba736[_0x7d41f8(0x2c6)]==_0x213634){_0x309bbb[_0x341ab3]={};const _0x103567=parseInt(_0x4ba736[_0x7d41f8(0x2d2)]),_0x4f51aa=0x0;let _0x4e45fa=_0x103567-_0x4f51aa,_0x4b82bf=Math[_0x7d41f8(0x1ce)](_0x55fa64,_0x4e45fa);console[_0x7d41f8(0x2ac)](_0x7d41f8(0x1b8)+_0x4b82bf+'\x20units\x20to\x20warehouse:\x20'+_0x6e30a9+_0x7d41f8(0x239)+_0x4ba736[_0x7d41f8(0x26e)]+',\x20Location:\x20'+(_0x4ba736[_0x7d41f8(0x24d)]+_0x4ba736[_0x7d41f8(0x18e)])+'\x20Date:\x20'+_0x4ba736[_0x7d41f8(0x22b)]+_0x7d41f8(0x23e)+_0x4ba736[_0x7d41f8(0x2b1)]),_0x309bbb[_0x341ab3]['group_ids']=_0x4ba736['warehouse_id']+'~'+_0x4ba736[_0x7d41f8(0x2bf)]+'~'+_0x4b82bf,_0x309bbb[_0x341ab3][_0x7d41f8(0x2a9)]=_0x4ba736[_0x7d41f8(0x2b1)],_0x309bbb[_0x341ab3][_0x7d41f8(0x2c6)]=_0x4ba736[_0x7d41f8(0x2c6)],_0x309bbb[_0x341ab3][_0x7d41f8(0x221)]=_0x4ba736['product_id'],_0x309bbb[_0x341ab3][_0x7d41f8(0x1aa)]=_0x4ba736[_0x7d41f8(0x1aa)],_0x309bbb[_0x341ab3]['sales_category']=_0x4ba736[_0x7d41f8(0x272)],_0x309bbb[_0x341ab3][_0x7d41f8(0x21f)]=_0x4ba736[_0x7d41f8(0x21f)],_0x309bbb[_0x341ab3][_0x7d41f8(0x19a)]=_0x4b82bf,_0x309bbb[_0x341ab3][_0x7d41f8(0x236)]=_0x4ba736[_0x7d41f8(0x236)],_0x309bbb[_0x341ab3][_0x7d41f8(0x198)]=_0x4ba736['secondary_unit'],_0x309bbb[_0x341ab3]['primary_code']=_0x4ba736[_0x7d41f8(0x2bb)],_0x309bbb[_0x341ab3][_0x7d41f8(0x298)]=_0x4ba736[_0x7d41f8(0x298)],_0x309bbb[_0x341ab3][_0x7d41f8(0x20d)]=_0x4ba736[_0x7d41f8(0x20d)],_0x309bbb[_0x341ab3][_0x7d41f8(0x26f)]=_0x4ba736[_0x7d41f8(0x26f)],_0x309bbb[_0x341ab3][_0x7d41f8(0x25a)]=_0x4ba736[_0x7d41f8(0x25a)],_0x309bbb[_0x341ab3]['production_date']=_0x4ba736[_0x7d41f8(0x1c7)],_0x309bbb[_0x341ab3][_0x7d41f8(0x22a)]=_0x4ba736[_0x7d41f8(0x22a)],_0x309bbb[_0x341ab3][_0x7d41f8(0x20b)]=_0x4ba736['product_cat'],_0x309bbb[_0x341ab3]['invoice']=_0x4ba736[_0x7d41f8(0x2c2)],_0x309bbb[_0x341ab3]['gross_price']=_0x4ba736[_0x7d41f8(0x23b)],_0x309bbb[_0x341ab3]['room_name']=_0x4ba736[_0x7d41f8(0x26e)],_0x309bbb[_0x341ab3][_0x7d41f8(0x24d)]=_0x4ba736[_0x7d41f8(0x24d)],_0x309bbb[_0x341ab3][_0x7d41f8(0x18e)]=_0x4ba736['bay'],_0x309bbb[_0x341ab3]['status']=_0x7d41f8(0x1fc),console['log']('1',_0x341ab3),_0x55fa64-=_0x4b82bf,_0x341ab3++;if(_0x55fa64<=0x0)break;}}if(_0x55fa64>0x0){var _0x32097b=await product[_0x7d41f8(0x1e4)]({'product_code':_0x213634});console[_0x7d41f8(0x2ac)]('2',_0x341ab3),_0x309bbb[_0x341ab3]={},_0x309bbb[_0x341ab3][_0x7d41f8(0x2a9)]=_0x32097b[_0x7d41f8(0x2b1)],_0x309bbb[_0x341ab3][_0x7d41f8(0x2c6)]=_0x213634,_0x309bbb[_0x341ab3][_0x7d41f8(0x221)]=_0x32097b['_id']['valueOf'](),_0x309bbb[_0x341ab3][_0x7d41f8(0x19a)]=_0x55fa64,_0x309bbb[_0x341ab3][_0x7d41f8(0x24a)]=_0x32097b[_0x7d41f8(0x236)],_0x309bbb[_0x341ab3]['secondary_unit']=_0x32097b['second_unit'],_0x309bbb[_0x341ab3][_0x7d41f8(0x2bb)]=_0x32097b[_0x7d41f8(0x2bb)],_0x309bbb[_0x341ab3][_0x7d41f8(0x298)]=_0x32097b[_0x7d41f8(0x298)],_0x309bbb[_0x341ab3][_0x7d41f8(0x20d)]=_0x32097b[_0x7d41f8(0x20d)],_0x309bbb[_0x341ab3][_0x7d41f8(0x22a)]=_0x32097b[_0x7d41f8(0x1a4)],_0x309bbb[_0x341ab3]['gross_price']=_0x32097b[_0x7d41f8(0x23b)],_0x309bbb[_0x341ab3][_0x7d41f8(0x1e8)]=_0x7d41f8(0x214),console[_0x7d41f8(0x2ac)](_0x7d41f8(0x233)+_0x55fa64+_0x7d41f8(0x265)+_0x341ab3+_0x7d41f8(0x208)+_0x213634),_0x341ab3++;}}_0x1cb3fa[_0x7d41f8(0x1ae)](_0x309bbb);}catch(_0x1109dc){console[_0x7d41f8(0x2ac)](_0x1109dc);}}),router[a0_0x3b0c45(0x2b8)](a0_0x3b0c45(0x2cf),async(_0x35fc7e,_0x532733)=>{var _0x849bfa=a0_0x3b0c45;const {product_code:_0x1cfc7e}=_0x35fc7e['body'];var _0x4fbc6f;const _0xa29aa2=await product[_0x849bfa(0x1f8)]([{'$match':{'primary_code':_0x1cfc7e}},{'$group':{'_id':_0x849bfa(0x1fb),'name':{'$first':'$name'},'category':{'$first':_0x849bfa(0x1db)},'brand':{'$first':_0x849bfa(0x2b9)},'unit':{'$first':_0x849bfa(0x290)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x849bfa(0x1ec)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x849bfa(0x296)},'maxProdPerUnit':{'$first':_0x849bfa(0x1c2)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'},'gross_price':{'$first':_0x849bfa(0x28e)},'sales_category':{'$first':_0x849bfa(0x29b)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x373493=await product[_0x849bfa(0x1f8)]([{'$match':{'secondary_code':_0x1cfc7e}},{'$group':{'_id':'$_id','name':{'$first':'$name'},'category':{'$first':_0x849bfa(0x1db)},'brand':{'$first':_0x849bfa(0x2b9)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x849bfa(0x2b6)},'product_code':{'$first':_0x849bfa(0x193)},'primary_code':{'$first':_0x849bfa(0x1ec)},'secondary_code':{'$first':_0x849bfa(0x213)},'maxStocks':{'$first':_0x849bfa(0x296)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x849bfa(0x21d)},'gross_price':{'$first':_0x849bfa(0x28e)},'sales_category':{'$first':_0x849bfa(0x29b)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0xa29aa2['length']>0x0)_0x4fbc6f=_0xa29aa2;else _0x373493[_0x849bfa(0x1cf)]>0x0&&(_0x4fbc6f=_0x373493);_0x532733[_0x849bfa(0x1ae)](_0x4fbc6f);}),router['post'](a0_0x3b0c45(0x2a8),async(_0x3c9a54,_0x53b465)=>{var _0x5e895e=a0_0x3b0c45;try{const {group_id:_0x246361,DRSI:_0xe71ddb,dateofreq:_0x3a5b95,PO_number:_0x196b1e,date:_0x1e14a7,warehouse_name:_0x573d09,typevehicle:_0x16bbcf,deliverydate:_0x544371,driver:_0x231081,plate:_0x1a139c,van:_0x3acd22,TSU:_0x8bae02,actual_delivery_date:_0xeb493a,TFU:_0x512a17,pull_out_date:_0x291868,sales:_0x5ceebe,Customer_data:_0x5818f7,note:_0x3b0a5f}=_0x3c9a54['body'],_0x4ec6a3=mongoose[_0x5e895e(0x288)][_0x5e895e(0x1fe)];let _0x566a00=[];const _0x16d393=new invoice_for_outgoing();await _0x16d393[_0x5e895e(0x1c0)]();const _0x5dbbb2=_0x5e895e(0x2d1)+_0x16d393['invoice_init']['toString']()[_0x5e895e(0x19e)](0x8,'0');if(typeof _0x246361==_0x5e895e(0x196)){let _0x4d99f7=_0x246361[_0x5e895e(0x202)]('~');var _0x20ddb3=_0x4ec6a3(_0x4d99f7[0x0]),_0x78d29a=_0x4ec6a3(_0x4d99f7[0x1]),_0x2bafe3=_0x4d99f7[0x2];let _0xcb0739=0x0;const _0x3a0c74=await warehouse[_0x5e895e(0x1f8)]([{'$match':{'_id':_0x20ddb3}},{'$unwind':_0x5e895e(0x2cc)},{'$match':{'product_details._id':_0x78d29a}}]);await warehouse[_0x5e895e(0x26b)]({'_id':_0x4ec6a3(_0x20ddb3),'product_details._id':_0x4ec6a3(_0x78d29a)},{'$set':{'product_details.$.isUsed':'true'}}),_0x566a00[_0xcb0739]={};for(let _0x52dc83=0x0;_0x52dc83<=_0x3a0c74[_0x5e895e(0x1cf)]-0x1;_0x52dc83++){const _0x53fb2f=_0x3a0c74[_0x52dc83];console[_0x5e895e(0x2ac)](_0x53fb2f),_0x566a00[_0xcb0739]['warehouse']=_0x53fb2f[_0x5e895e(0x2b1)],_0x566a00[_0xcb0739]['product_id']=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x221)],_0x566a00[_0xcb0739]['product_name']=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x2a9)],_0x566a00[_0xcb0739][_0x5e895e(0x2c6)]=_0x53fb2f['product_details'][_0x5e895e(0x2c6)],_0x566a00[_0xcb0739][_0x5e895e(0x2d2)]=_0x2bafe3,_0x566a00[_0xcb0739][_0x5e895e(0x19a)]=_0x2bafe3,_0x566a00[_0xcb0739]['unit']=_0x53fb2f['product_details']['unit'],_0x566a00[_0xcb0739][_0x5e895e(0x198)]=_0x53fb2f['product_details'][_0x5e895e(0x198)],_0x566a00[_0xcb0739][_0x5e895e(0x24d)]=_0x53fb2f[_0x5e895e(0x1ef)]['level'],_0x566a00[_0xcb0739]['bay']=_0x53fb2f['product_details'][_0x5e895e(0x18e)],_0x566a00[_0xcb0739][_0x5e895e(0x2bb)]=_0x53fb2f['product_details']['primary_code'],_0x566a00[_0xcb0739][_0x5e895e(0x298)]=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x298)],_0x566a00[_0xcb0739][_0x5e895e(0x20d)]=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x20d)],_0x566a00[_0xcb0739]['batch_code']=_0x53fb2f['product_details'][_0x5e895e(0x26f)],_0x566a00[_0xcb0739][_0x5e895e(0x25a)]=_0x53fb2f[_0x5e895e(0x1ef)]['expiry_date'],_0x566a00[_0xcb0739][_0x5e895e(0x1c7)]=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x1c7)],_0x566a00[_0xcb0739][_0x5e895e(0x22a)]=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x22a)],_0x566a00[_0xcb0739]['product_cat']=_0x53fb2f['product_details'][_0x5e895e(0x20b)],_0x566a00[_0xcb0739][_0x5e895e(0x190)]=_0x53fb2f[_0x5e895e(0x191)],_0x566a00[_0xcb0739][_0x5e895e(0x2c2)]=_0x53fb2f[_0x5e895e(0x1ef)]['invoice'],_0x566a00[_0xcb0739][_0x5e895e(0x21f)]=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x21f)],_0x566a00[_0xcb0739][_0x5e895e(0x23b)]=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x23b)],_0x566a00[_0xcb0739][_0x5e895e(0x272)]=_0x53fb2f['product_details']['sales'],_0x566a00[_0xcb0739][_0x5e895e(0x1aa)]=_0x53fb2f[_0x5e895e(0x1ef)]['date_recieved'],_0x566a00[_0xcb0739][_0x5e895e(0x250)]=_0x53fb2f['product_details']['sales'],_0x566a00[_0xcb0739][_0x5e895e(0x1dc)]=_0x53fb2f['_id'][_0x5e895e(0x1f4)](),_0x566a00[_0xcb0739][_0x5e895e(0x234)]=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x2bf)][_0x5e895e(0x1f4)](),_0x566a00[_0xcb0739][_0x5e895e(0x1e7)]=_0x5e895e(0x249),_0x566a00[_0xcb0739]['agent_id']=_0x53fb2f[_0x5e895e(0x1ef)][_0x5e895e(0x268)];}_0x566a00[_0xcb0739][_0x5e895e(0x26a)]=_0x5dbbb2;}else for(let _0x450a4d=0x0;_0x450a4d<=_0x246361[_0x5e895e(0x1cf)]-0x1;_0x450a4d++){const _0x1f4041=_0x246361[_0x450a4d];let _0x2f0d9c=_0x1f4041[_0x5e895e(0x202)]('~');console['log'](_0x2f0d9c);var _0x20ddb3=_0x4ec6a3(_0x2f0d9c[0x0]),_0x78d29a=_0x4ec6a3(_0x2f0d9c[0x1]),_0x2bafe3=_0x2f0d9c[0x2];const _0x45fe9d=await warehouse[_0x5e895e(0x1f8)]([{'$match':{'_id':_0x20ddb3}},{'$unwind':_0x5e895e(0x2cc)},{'$match':{'product_details._id':_0x78d29a}}]);await warehouse[_0x5e895e(0x26b)]({'_id':_0x4ec6a3(_0x20ddb3),'product_details._id':_0x4ec6a3(_0x78d29a)},{'$set':{'product_details.$.isUsed':_0x5e895e(0x1fc)}}),_0x566a00[_0x450a4d]={};for(let _0x3cae5b=0x0;_0x3cae5b<=_0x45fe9d[_0x5e895e(0x1cf)]-0x1;_0x3cae5b++){const _0x3044a5=_0x45fe9d[_0x3cae5b];_0x566a00[_0x450a4d]['warehouse']=_0x3044a5[_0x5e895e(0x2b1)],_0x566a00[_0x450a4d][_0x5e895e(0x221)]=_0x3044a5['product_details'][_0x5e895e(0x221)],_0x566a00[_0x450a4d][_0x5e895e(0x2a9)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x2a9)],_0x566a00[_0x450a4d]['product_code']=_0x3044a5['product_details']['product_code'],_0x566a00[_0x450a4d][_0x5e895e(0x2d2)]=_0x2bafe3,_0x566a00[_0x450a4d]['quantity']=_0x2bafe3,_0x566a00[_0x450a4d][_0x5e895e(0x236)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x236)],_0x566a00[_0x450a4d][_0x5e895e(0x198)]=_0x3044a5['product_details'][_0x5e895e(0x198)],_0x566a00[_0x450a4d][_0x5e895e(0x24d)]=_0x3044a5['product_details'][_0x5e895e(0x24d)],_0x566a00[_0x450a4d][_0x5e895e(0x18e)]=_0x3044a5['product_details'][_0x5e895e(0x18e)],_0x566a00[_0x450a4d][_0x5e895e(0x2bb)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x2bb)],_0x566a00[_0x450a4d][_0x5e895e(0x298)]=_0x3044a5['product_details'][_0x5e895e(0x298)],_0x566a00[_0x450a4d]['maxStocks']=_0x3044a5[_0x5e895e(0x1ef)]['maxStocks'],_0x566a00[_0x450a4d][_0x5e895e(0x26f)]=_0x3044a5[_0x5e895e(0x1ef)]['batch_code'],_0x566a00[_0x450a4d][_0x5e895e(0x25a)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x25a)],_0x566a00[_0x450a4d][_0x5e895e(0x1c7)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x1c7)],_0x566a00[_0x450a4d]['maxperunit']=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x22a)],_0x566a00[_0x450a4d][_0x5e895e(0x20b)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x20b)],_0x566a00[_0x450a4d][_0x5e895e(0x190)]=_0x3044a5[_0x5e895e(0x191)],_0x566a00[_0x450a4d][_0x5e895e(0x2c2)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x2c2)],_0x566a00[_0x450a4d][_0x5e895e(0x21f)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x21f)],_0x566a00[_0x450a4d][_0x5e895e(0x23b)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x23b)],_0x566a00[_0x450a4d][_0x5e895e(0x272)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x268)],_0x566a00[_0x450a4d]['date_recieved']=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x1aa)],_0x566a00[_0x450a4d][_0x5e895e(0x250)]=_0x3044a5[_0x5e895e(0x1ef)]['sales'],_0x566a00[_0x450a4d][_0x5e895e(0x1dc)]=_0x3044a5[_0x5e895e(0x2bf)][_0x5e895e(0x1f4)](),_0x566a00[_0x450a4d]['warehouse_id_detl']=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x2bf)][_0x5e895e(0x1f4)](),_0x566a00[_0x450a4d]['data_type']='out',_0x566a00[_0x450a4d][_0x5e895e(0x188)]=_0x3044a5[_0x5e895e(0x1ef)][_0x5e895e(0x268)];}_0x566a00[_0x450a4d][_0x5e895e(0x26a)]=_0x5dbbb2;}for(let _0x5ba9f5=0x0;_0x5ba9f5<=_0x566a00['length']-0x1;_0x5ba9f5++){const _0x586b8f=_0x566a00[_0x5ba9f5],_0x910de3=new warehouse_temporary(_0x586b8f);await _0x910de3['save']();}const _0x2dc71f=new sales_finished({'invoice':_0x5dbbb2,'sales_data':_0x5ceebe,'customer':_0x5818f7,'date':_0x1e14a7,'warehouse_name':_0x573d09,'sale_product':_0x566a00,'note':_0x3b0a5f,'finalize':_0x5e895e(0x1ca),'dateofreq':_0x3a5b95,'PO_number':_0x196b1e,'typevehicle':_0x16bbcf,'deliverydate':_0x544371,'driver':_0x231081,'plate':_0x1a139c,'van':_0x3acd22,'DRSI':_0xe71ddb,'TSU':_0x8bae02,'TFU':_0x512a17,'pullout_date':_0x291868,'actualdelivery_date':_0xeb493a,'typeOfProducts':_0x5e895e(0x18a)}),_0x2954d9=await _0x2dc71f[_0x5e895e(0x1c0)]();_0x3c9a54[_0x5e895e(0x1a3)](_0x5e895e(0x28c),_0x5e895e(0x2c1)),_0x53b465[_0x5e895e(0x1e9)](_0x5e895e(0x1b2)+_0x2954d9[_0x5e895e(0x2bf)]);}catch(_0x16a874){console[_0x5e895e(0x2ac)](_0x16a874);}}),module['exports']=router;function a0_0x83c8(){var _0x1b073e=['/preview/:id','<!DOCTYPE\x20html>','amount','French','$category','warehouse_id','Email\x20sent\x20successfully','$sale_product.floorlevel','return_sale','164zKuSDy','catch','sales\x20item\x20return\x20successfull','gmail','findOne','image','</body></html>','data_type','status','redirect','../public/language/languages.json','Quality\x20Inspection','$primary_code','$warehouse_name','undefined','product_details','render','push','return_qty','floor','valueOf','createTransport','$product_details.primary_code','get','aggregate','customer','Spanish','$_id','true','$product_details.maxProducts','ObjectId','\x20</h2>','site_title','product','split','Enabled','$product_details.production_date','errors','maxProducts_QA','<h2>\x20','\x20<>\x20','$product_details.storage','Error\x20Occurs','product_cat','warehouse_name','maxStocks','Arabic\x20(ae)','edit_sales_finished','214732lMDwqP','outgoing_invoice','match','$secondary_code','false','RoomAssigned','/all_sales_finished/view','secondary_unit_QA','$product_details.rack','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.uuid','toString','getFullYear','$secondary_unit','Sales\x20Update\x20successfully','uuid','$product_details.secondary_unit','product_id','language','find','84402UuCeCu','prod_cat','/view_log','\x20&&\x20','maxProducts','$product_details.bay','maxperunit','date_received','carton','level2','/view/add_sales_logs','<strong>\x20Regards\x20</strong>','staff','$product_details.type_products','unit_QA','There\x20is\x20','warehouse_id_detl','production_date_QA','unit','barcode\x20Product\x20master','/barcode_scanner_logs',',\x20room:\x20','master','gross_price','$customers_docs','$product_details.type','\x20Name:\x20','$product_details.batch_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$sale_product.quantity','add\x20post','barcode\x20user_id','secondary_code_QA','sale_qty','slice','product_list','$name','out','standard_unit','/view','getDate','level','max_per_unit','Portuguese','sales_id','sendMail','LOG-OUT-','<html><head><title></title>','all_sales_barcode','English\x20(US)','1680zBEUGH','\x20Order\x20Date\x20:\x20','product_name_QA1','here','expiry_date','/upload/','Sale\x20Return','body','$sale_product','finalize','sales_quantity','/invoice/:id','return_sale_QA','$product_details.product_stock','\x20==\x20','\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20','Router','True','sales','</div>','outgoiug_inv','updateOne','purchases_data','stock','roomNamed','batch_code','$product_details.product_name','concat','sales_category','received_amount','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$return_data','<table\x20style=\x22width:\x20100%\x20!important;\x22>','note','<tr>','$product_details.invoice','expiry_date_QA','currency','user','$product_details.product_cat','$product.product_name','5627718tWudyD','$product_details.secondary_code','</h5>','$sale_product.type','<span\x20style=\x22float:\x20right;\x22>','forEach','params','Enclosed','id_transaction_from','Types','then','currency_placement','suppliers','success','random','$gross_price','$room','$unit','$note','Sale\x20Return\x20Mail','int','$product_details.unit','findById','$maxStocks','$product_details._id','secondary_code','logo','1260450YdVjnG','$sales_category','$product_details.level','English','</tr>','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','return_sale_finished','</head><body>','$product_details.expiry_date','German','product_code_QA','Return\x20Rooms','<div>','/process/view','product_name','maxPerUnit','../models/all_models','log','$date','$product_details.sales_category','</thead>','380SIBaaG','name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','express','map','/barcode_scanner','$alertquantity','role','post','$brand','prod_code','primary_code','prod_invoice','adjust_qty','$sale_product.bin','_id','Ambient','Sales\x20Add\x20successfully','invoice','/view/add_sale/product','add_sales_finished','$product_details.gross_price','product_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','stock_data','$sale_product.bay','$finalize','$invoice','$product_details','OUTF-','Hindi','/barcode_scanner_auto','sale_product','OUT-','product_stock','for_categorize','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','../middleware/auth','agent_id','</tbody>','own','/give_payment/:id','primary_code_QA','Logo.png','bay','abs','room_name','room','/view/:id','$product_code','max','</td>','string','$product_details.maxPerUnit','secondary_unit','primary_unit','quantity','return_data','/barcode_scanner_auto_data','1721200GSlHOy','padStart','due_amount','Chinese','all_sales_finished_logs','back','flash','maxProdPerUnit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/view/add_sales','3636szvrRh','</span>','product_date','date_recieved','getMonth','batch_code_QA','<h5>','json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','invoice_init','all','/all_sales_finished/preview/','filter','$product_details.bin','logs','email','sort','Distributing\x20','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$product_details.room_name','$customer','date','\x20Order\x20Number\x20:\x20','stocks_QA','Portuguese\x20(BR)','save','Arabic','$maxProdPerUnit','$product_details.product_code','product_data','/view/add_sales/:id','foreach\x20newproduct','production_date','warehouse','sales_quantity_QA','False','password','return_qty_QA','<h5\x20style=\x22text-align:\x20left;\x22>','min','length','Finished\x20Goods','add_sales_finished_logs','maxPerUnit_QA','$product_details.floorlevel','message','final','date_data'];a0_0x83c8=function(){return _0x1b073e;};return a0_0x83c8();}