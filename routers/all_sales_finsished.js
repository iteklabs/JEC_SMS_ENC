var a0_0x322bc7=a0_0x45f8;(function(_0x12b1c9,_0xb87704){var _0x3e1c8b=a0_0x45f8,_0x4daf1a=_0x12b1c9();while(!![]){try{var _0xc743c9=-parseInt(_0x3e1c8b(0x1e9))/0x1*(-parseInt(_0x3e1c8b(0x233))/0x2)+parseInt(_0x3e1c8b(0x2d6))/0x3*(parseInt(_0x3e1c8b(0x2a4))/0x4)+parseInt(_0x3e1c8b(0x28a))/0x5*(-parseInt(_0x3e1c8b(0x1df))/0x6)+-parseInt(_0x3e1c8b(0x27f))/0x7*(parseInt(_0x3e1c8b(0x2ce))/0x8)+-parseInt(_0x3e1c8b(0x214))/0x9+parseInt(_0x3e1c8b(0x1f3))/0xa+parseInt(_0x3e1c8b(0x1ca))/0xb*(parseInt(_0x3e1c8b(0x28c))/0xc);if(_0xc743c9===_0xb87704)break;else _0x4daf1a['push'](_0x4daf1a['shift']());}catch(_0x30af63){_0x4daf1a['push'](_0x4daf1a['shift']());}}}(a0_0x50f4,0x39e16));function a0_0x45f8(_0x11f6e0,_0x5bb958){var _0x50f42b=a0_0x50f4();return a0_0x45f8=function(_0x45f834,_0x20dc93){_0x45f834=_0x45f834-0x1bd;var _0x1949b6=_0x50f42b[_0x45f834];return _0x1949b6;},a0_0x45f8(_0x11f6e0,_0x5bb958);}const express=require(a0_0x322bc7(0x295)),app=express(),router=express[a0_0x322bc7(0x249)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x322bc7(0x216)),auth=require(a0_0x322bc7(0x2c2)),nodemailer=require(a0_0x322bc7(0x28d)),users=require('../public/language/languages.json');function a0_0x50f4(){var _0x74d682=['Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','message','slice','production_date','Finished\x20Goods','padStart','<h5\x20style=\x22text-align:\x20left;\x22>','floor','$sale_product.bin','sendMail','1340uypCIH','password','2591844JzUhzQ','nodemailer','<strong>\x20Regards\x20</strong>','createTransport','logo','currency','$product_details.product_stock','catch','Sales\x20Add\x20successfully','express','$product_details.secondary_code','$sale_product.bay','gmail','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</tr>','Return\x20Rooms','add\x20post','English','secondary_code_QA','product_details','product_code_QA','<span\x20style=\x22float:\x20right;\x22>','body','$product_details.expiry_date','200kkXvYc','Sale\x20Return','maxperunit','due_amount','return_sale_finished','LOG-OUT-','product','</tbody>','map','$product_details.sales_category','invoice_init','invoice','maxPerUnit','/view/return_sales/:id','edit_sales_finished_view','Hindi','language','$return_data','$product_details.bin','currency_placement','/view/:id','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','uuid','length','purchases_data','Chinese','Email\x20sent\x20successfully','<h5>','$product_details.production_date','email','../middleware/auth','$invoice','$product_details.product_name','sale_qty','primary_code','filter','$product_details.floorlevel','product_data','<hr\x20class=\x22my-3\x22>','product_list','date','render','8tlKgDR','warehouse_name','$product_details.type_products','findById','expiry_date_QA','/view_log','\x20Order\x20Number\x20:\x20','$product_details.gross_price','6117vNUehV','/upload/','return_qty','$customer','<tr>','$product_details.primary_code','</td>','customer_data','match','There\x27s\x20a\x20error\x20in\x20this\x20transaction','all','Ambient','here','False','findOne','params','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$name','</div>','prod_invoice','stock','$product_details.unit','maxPerUnit_QA','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product.product_name','11zFSmMD','sale_product','master','save','customer','prod_cat','$product_details.product_cat','$product_details.invoice','secondary_unit_QA','product_name','batch_code_QA','own','unit_QA','/barcode/:id','split','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/view/add_sales','</body></html>','updateOne','$sale_product','maxProducts_QA','654XHyVOO','$product_details.product_code','barcode\x20user_id','OUTF-','Enabled','Arabic\x20(ae)','Received\x20Payment\x20For\x20Sale','back','Quality\x20Inspection','$finalize','30146MPzpiL','push','<tbody\x20style=\x22text-align:\x20center;\x22>','bay','add_sales_finished_logs','product_stock','sales_invoice','stock_data','sales','$note','534560lcOIHj','all_sales_barcode','Enclosed','string','</span>','warehouse','suppliers','get','toString','errors','$date','\x20Order\x20Date\x20:\x20','$product_details.level','status','stocks_QA','/barcode_scanner','logs','$warehouse_name','True','date_data','adjust_qty','foreach\x20newproduct','\x20<>\x20','batch_code','Sale\x20Return\x20Mail','French','int','all_sales_finished','concat','carton','exports','outgoing_invoice','gross_price','2584548fNADsv','$product_details','../models/all_models','Portuguese','level2','Spanish','</head><body>','secondary_unit','$product_details.uuid','$sale_product.floorlevel','abs','staff','$product','English\x20(US)','<html><head><title></title>','$product_details.secondary_unit','find','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','log','payment\x20successfull','German','sales_quantity_QA','role','$product_details.bay','expiry_date','maxProducts','getDate','$sale_product.quantity','site_title','<table\x20style=\x22width:\x20100%\x20!important;\x22>','RoomAssigned','18bXqRmz','barcode\x20Product\x20master','primary_unit','$room','$product_details.type','<h2>\x20','/picking_list/pdf/','room','Portuguese\x20(BR)','/all_sales_finished/view','/view/add_sales_logs','valueOf','return_qty_QA','product_date','forEach','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','product_code','$product_details.maxPerUnit','amount','/preview/:id','all_sales_finished_logs','$product_details._id','Router','production_date_QA','note','unit','$product_details.rack','return_data','user','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','for_categorize','<div>','prod_code','$product_details.batch_code','id_transaction_from','image','getMonth','level','sales\x20item\x20return\x20successfull','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','add_sales_finished','_id','$product_details.storage','/all_sales_finished/preview/','return_sale_QA','room_name','Return\x20Goods','redirect','\x20==\x20','max_per_unit','secondary_code','$_id','flash','$sale_product.type','primary_code_QA','warehouse_id','getFullYear','</h5>','agent_id','OUT-','quantity','/invoice/:id','<!DOCTYPE\x20html>','$customers_docs','undefined','/view/add_sales/:id','Arabic','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','product_name_QA1','sales_quantity','post','aggregate','edit_sales_finished','Sales\x20Update\x20successfully','json','624715oZAezm'];a0_0x50f4=function(){return _0x74d682;};return a0_0x50f4();}router['get']('/view',auth,async(_0x34eb69,_0x3de4dc)=>{var _0x336739=a0_0x322bc7;try{const {username:_0x22d742,email:_0x466b2c,role:_0x151897}=_0x34eb69[_0x336739(0x24f)],_0xb3da4a=_0x34eb69['user'],_0x17f064=await profile[_0x336739(0x1bf)]({'email':_0xb3da4a[_0x336739(0x2c1)]}),_0x229b4f=await master_shop[_0x336739(0x224)]();let _0x532570;if(_0xb3da4a[_0x336739(0x22a)]=='staff'){const _0x116e13=await staff[_0x336739(0x1bf)]({'email':_0xb3da4a['email']});_0x532570=await sales_finished[_0x336739(0x27b)]([{'$match':{'typeOfProducts':_0x336739(0x1d5)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x336739(0x266),'invoice':{'$first':_0x336739(0x2c3)},'customers':{'$first':'$customer'},'date':{'$first':_0x336739(0x1fd)},'warehouse_name':{'$first':_0x336739(0x204)},'sale_product':{'$push':_0x336739(0x1dd)},'note':{'$first':_0x336739(0x1f2)},'return_data':{'$first':_0x336739(0x2b5)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x336739(0x297)},'isle':{'$addToSet':_0x336739(0x288)},'type':{'$addToSet':_0x336739(0x268)},'pallet':{'$addToSet':_0x336739(0x21d)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x532570=await sales_finished[_0x336739(0x27b)]([{'$match':{'typeOfProducts':_0x336739(0x1d5)}},{'$unwind':_0x336739(0x1dd)},{'$group':{'_id':_0x336739(0x266),'invoice':{'$first':_0x336739(0x2c3)},'customers':{'$first':_0x336739(0x2d9)},'date':{'$first':_0x336739(0x1fd)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x336739(0x1dd)},'note':{'$first':_0x336739(0x1f2)},'return_data':{'$first':_0x336739(0x2b5)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x336739(0x22f)},'level':{'$addToSet':_0x336739(0x297)},'isle':{'$addToSet':_0x336739(0x288)},'type':{'$addToSet':_0x336739(0x268)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x336739(0x1e8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x229b4f[0x0][_0x336739(0x2b4)]==_0x336739(0x221)){var _0x5800c9=users[_0x336739(0x29d)];console[_0x336739(0x226)](_0x5800c9);}else{if(_0x229b4f[0x0][_0x336739(0x2b4)]==_0x336739(0x2b3))var _0x5800c9=users[_0x336739(0x2b3)];else{if(_0x229b4f[0x0][_0x336739(0x2b4)]==_0x336739(0x228))var _0x5800c9=users[_0x336739(0x228)];else{if(_0x229b4f[0x0][_0x336739(0x2b4)]==_0x336739(0x219))var _0x5800c9=users[_0x336739(0x219)];else{if(_0x229b4f[0x0][_0x336739(0x2b4)]=='French')var _0x5800c9=users['French'];else{if(_0x229b4f[0x0][_0x336739(0x2b4)]==_0x336739(0x23b))var _0x5800c9=users[_0x336739(0x217)];else{if(_0x229b4f[0x0][_0x336739(0x2b4)]==_0x336739(0x2bd))var _0x5800c9=users[_0x336739(0x2bd)];else{if(_0x229b4f[0x0][_0x336739(0x2b4)]==_0x336739(0x1e4))var _0x5800c9=users['Arabic'];}}}}}}}_0x3de4dc['render'](_0x336739(0x20e),{'success':_0x34eb69[_0x336739(0x267)]('success'),'errors':_0x34eb69['flash'](_0x336739(0x1fc)),'sales':_0x532570,'profile':_0x17f064,'role':_0xb3da4a,'master_shop':_0x229b4f,'language':_0x5800c9});}catch(_0x46d029){console[_0x336739(0x226)](_0x46d029);}}),router[a0_0x322bc7(0x1fa)](a0_0x322bc7(0x2d3),auth,async(_0x11aabb,_0x252606)=>{var _0x3ba34e=a0_0x322bc7;try{const {username:_0xbf219d,email:_0x19c8cf,role:_0x35d05d}=_0x11aabb['user'],_0x2ae15a=_0x11aabb[_0x3ba34e(0x24f)],_0xd7377a=await profile['findOne']({'email':_0x2ae15a[_0x3ba34e(0x2c1)]}),_0x14855e=await master_shop[_0x3ba34e(0x224)]();let _0x1a3cdf;if(_0x2ae15a[_0x3ba34e(0x22a)]==_0x3ba34e(0x21f)){const _0x4a0394=await staff[_0x3ba34e(0x1bf)]({'email':_0x2ae15a[_0x3ba34e(0x2c1)]});_0x1a3cdf=await sales_finished[_0x3ba34e(0x27b)]([{'$match':{'typeOfProducts':_0x3ba34e(0x203)}},{'$unwind':_0x3ba34e(0x1dd)},{'$group':{'_id':_0x3ba34e(0x266),'invoice':{'$first':_0x3ba34e(0x2c3)},'customers':{'$first':_0x3ba34e(0x2d9)},'date':{'$first':_0x3ba34e(0x1fd)},'warehouse_name':{'$first':_0x3ba34e(0x204)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x3ba34e(0x1f2)},'return_data':{'$first':_0x3ba34e(0x2b5)},'customers_docs':{'$first':_0x3ba34e(0x272)},'total_saleproduct_quantity':{'$sum':_0x3ba34e(0x22f)},'level':{'$addToSet':_0x3ba34e(0x297)},'isle':{'$addToSet':_0x3ba34e(0x288)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x3ba34e(0x21d)},'finalize':{'$first':_0x3ba34e(0x1e8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x1a3cdf=await sales_finished[_0x3ba34e(0x27b)]([{'$match':{'typeOfProducts':'logs'}},{'$unwind':_0x3ba34e(0x1dd)},{'$group':{'_id':'$_id','invoice':{'$first':_0x3ba34e(0x2c3)},'customers':{'$first':_0x3ba34e(0x2d9)},'date':{'$first':_0x3ba34e(0x1fd)},'warehouse_name':{'$first':_0x3ba34e(0x204)},'sale_product':{'$push':'$sale_product'},'note':{'$first':'$note'},'return_data':{'$first':_0x3ba34e(0x2b5)},'customers_docs':{'$first':_0x3ba34e(0x272)},'total_saleproduct_quantity':{'$sum':_0x3ba34e(0x22f)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x3ba34e(0x21d)},'finalize':{'$first':_0x3ba34e(0x1e8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x14855e[0x0][_0x3ba34e(0x2b4)]==_0x3ba34e(0x221)){var _0x4116e5=users[_0x3ba34e(0x29d)];console[_0x3ba34e(0x226)](_0x4116e5);}else{if(_0x14855e[0x0][_0x3ba34e(0x2b4)]=='Hindi')var _0x4116e5=users[_0x3ba34e(0x2b3)];else{if(_0x14855e[0x0][_0x3ba34e(0x2b4)]==_0x3ba34e(0x228))var _0x4116e5=users[_0x3ba34e(0x228)];else{if(_0x14855e[0x0]['language']==_0x3ba34e(0x219))var _0x4116e5=users[_0x3ba34e(0x219)];else{if(_0x14855e[0x0][_0x3ba34e(0x2b4)]==_0x3ba34e(0x20c))var _0x4116e5=users[_0x3ba34e(0x20c)];else{if(_0x14855e[0x0]['language']==_0x3ba34e(0x23b))var _0x4116e5=users[_0x3ba34e(0x217)];else{if(_0x14855e[0x0][_0x3ba34e(0x2b4)]=='Chinese')var _0x4116e5=users['Chinese'];else{if(_0x14855e[0x0][_0x3ba34e(0x2b4)]=='Arabic\x20(ae)')var _0x4116e5=users['Arabic'];}}}}}}}_0x252606['render'](_0x3ba34e(0x247),{'success':_0x11aabb[_0x3ba34e(0x267)](_0x3ba34e(0x276)),'errors':_0x11aabb[_0x3ba34e(0x267)](_0x3ba34e(0x1fc)),'sales':_0x1a3cdf,'profile':_0xd7377a,'role':_0x2ae15a,'master_shop':_0x14855e,'language':_0x4116e5});}catch(_0x513e3b){console[_0x3ba34e(0x226)](_0x513e3b);}});async function getRandom8DigitNumber(){var _0x21eb85=a0_0x322bc7;const _0xea01ad=0x989680,_0x1873b9=0x5f5e0ff,_0x4e3e7b=Math[_0x21eb85(0x287)](Math['random']()*(_0x1873b9-_0xea01ad+0x1))+_0xea01ad;var _0x535ffe;const _0x3493e0=await sales_finished[_0x21eb85(0x1bf)]({'invoice':'OUTF-'+_0x4e3e7b});return _0x3493e0&&_0x3493e0[_0x21eb85(0x2bb)]>0x0?_0x535ffe=_0x21eb85(0x1e2)+_0x4e3e7b:_0x535ffe=_0x21eb85(0x1e2)+_0x4e3e7b,_0x535ffe;}router['get'](a0_0x322bc7(0x1da),auth,async(_0x328a4e,_0x34b77b)=>{var _0x43f72a=a0_0x322bc7;try{const {username:_0x2e1647,email:_0x18e12c,role:_0x47da31}=_0x328a4e['user'],_0x16c930=_0x328a4e[_0x43f72a(0x24f)],_0x430d7d=await profile[_0x43f72a(0x1bf)]({'email':_0x16c930['email']}),_0x532ae3=await master_shop[_0x43f72a(0x224)](),_0xc0bd11=await customer[_0x43f72a(0x224)]({});let _0x303ccd;if(_0x16c930[_0x43f72a(0x22a)]==_0x43f72a(0x21f)){const _0x387267=await staff[_0x43f72a(0x1bf)]({'email':_0x16c930['email']});_0x303ccd=await warehouse[_0x43f72a(0x27b)]([{'$match':{'status':_0x43f72a(0x1e3),'name':_0x387267[_0x43f72a(0x1f8)]}},{'$group':{'_id':_0x43f72a(0x1c2),'name':{'$first':_0x43f72a(0x1c2)}}},{'$sort':{'name':0x1}}]);}else _0x303ccd=await warehouse[_0x43f72a(0x27b)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x43f72a(0x1c2),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x225f0f=await product[_0x43f72a(0x224)]({});var _0x3f84fc=[_0x43f72a(0x2e1),_0x43f72a(0x1f5)];const _0x21b244=await sales_finished[_0x43f72a(0x224)]({}),_0xe78e9a=_0x21b244[_0x43f72a(0x2bb)]+0x1,_0x36ef26='OUTF-'+_0xe78e9a[_0x43f72a(0x1fb)]()['padStart'](0x5,'0');if(_0x532ae3[0x0]['language']=='English\x20(US)'){var _0xb8dd2c=users['English'];console[_0x43f72a(0x226)](_0xb8dd2c);}else{if(_0x532ae3[0x0][_0x43f72a(0x2b4)]=='Hindi')var _0xb8dd2c=users[_0x43f72a(0x2b3)];else{if(_0x532ae3[0x0][_0x43f72a(0x2b4)]==_0x43f72a(0x228))var _0xb8dd2c=users[_0x43f72a(0x228)];else{if(_0x532ae3[0x0]['language']==_0x43f72a(0x219))var _0xb8dd2c=users['Spanish'];else{if(_0x532ae3[0x0][_0x43f72a(0x2b4)]==_0x43f72a(0x20c))var _0xb8dd2c=users[_0x43f72a(0x20c)];else{if(_0x532ae3[0x0][_0x43f72a(0x2b4)]==_0x43f72a(0x23b))var _0xb8dd2c=users['Portuguese'];else{if(_0x532ae3[0x0]['language']==_0x43f72a(0x2bd))var _0xb8dd2c=users['Chinese'];else{if(_0x532ae3[0x0][_0x43f72a(0x2b4)]==_0x43f72a(0x1e4))var _0xb8dd2c=users['Arabic'];}}}}}}}const _0x421118=getRandom8DigitNumber();_0x421118['then'](_0x4e1731=>{var _0x373087=_0x43f72a;_0x34b77b[_0x373087(0x2cd)](_0x373087(0x25b),{'success':_0x328a4e[_0x373087(0x267)](_0x373087(0x276)),'errors':_0x328a4e[_0x373087(0x267)](_0x373087(0x1fc)),'role':_0x16c930,'profile':_0x430d7d,'customer':_0xc0bd11,'warehouse':_0x303ccd,'product':_0x225f0f,'invoice':_0x4e1731,'master_shop':_0x532ae3,'language':_0xb8dd2c,'rooms_data':_0x3f84fc});})[_0x43f72a(0x293)](_0x295251=>{var _0x28f987=_0x43f72a;_0x328a4e[_0x28f987(0x267)](_0x28f987(0x1fc),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x34b77b[_0x28f987(0x262)]('/all_sales_finished/view');});}catch(_0x3f38e8){console['log'](_0x3f38e8);}}),router[a0_0x322bc7(0x1fa)](a0_0x322bc7(0x23d),auth,async(_0x6b00f0,_0x1507ce)=>{var _0x3aff04=a0_0x322bc7;try{const {username:_0x39cfb3,email:_0x2dc8da,role:_0x37062d}=_0x6b00f0[_0x3aff04(0x24f)],_0x176a16=_0x6b00f0[_0x3aff04(0x24f)],_0x543d6c=await profile[_0x3aff04(0x1bf)]({'email':_0x176a16[_0x3aff04(0x2c1)]}),_0x4b13b2=await master_shop[_0x3aff04(0x224)](),_0x18211b=await customer[_0x3aff04(0x224)]({});let _0x33e74f;if(_0x176a16[_0x3aff04(0x22a)]==_0x3aff04(0x21f)){const _0x33b5c7=await staff[_0x3aff04(0x1bf)]({'email':_0x176a16[_0x3aff04(0x2c1)]});_0x33e74f=await warehouse[_0x3aff04(0x27b)]([{'$match':{'status':_0x3aff04(0x1e3),'name':_0x33b5c7['warehouse']}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x33e74f=await warehouse[_0x3aff04(0x27b)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x3aff04(0x1c2),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x2d3f4=await product[_0x3aff04(0x224)]({});var _0x5ea503=[_0x3aff04(0x2e1),'Enclosed'];const _0x13611c=await sales_finished[_0x3aff04(0x224)]({}),_0x2604df=_0x13611c[_0x3aff04(0x2bb)]+0x1,_0x2d08b9=_0x3aff04(0x1e2)+_0x2604df[_0x3aff04(0x1fb)]()[_0x3aff04(0x285)](0x5,'0');if(_0x4b13b2[0x0][_0x3aff04(0x2b4)]==_0x3aff04(0x221)){var _0x27f545=users[_0x3aff04(0x29d)];console['log'](_0x27f545);}else{if(_0x4b13b2[0x0][_0x3aff04(0x2b4)]==_0x3aff04(0x2b3))var _0x27f545=users[_0x3aff04(0x2b3)];else{if(_0x4b13b2[0x0][_0x3aff04(0x2b4)]==_0x3aff04(0x228))var _0x27f545=users[_0x3aff04(0x228)];else{if(_0x4b13b2[0x0][_0x3aff04(0x2b4)]==_0x3aff04(0x219))var _0x27f545=users[_0x3aff04(0x219)];else{if(_0x4b13b2[0x0][_0x3aff04(0x2b4)]==_0x3aff04(0x20c))var _0x27f545=users['French'];else{if(_0x4b13b2[0x0][_0x3aff04(0x2b4)]==_0x3aff04(0x23b))var _0x27f545=users['Portuguese'];else{if(_0x4b13b2[0x0][_0x3aff04(0x2b4)]==_0x3aff04(0x2bd))var _0x27f545=users[_0x3aff04(0x2bd)];else{if(_0x4b13b2[0x0][_0x3aff04(0x2b4)]==_0x3aff04(0x1e4))var _0x27f545=users[_0x3aff04(0x275)];}}}}}}}const _0x390d3e=getRandom8DigitNumber();_0x390d3e['then'](_0x291e55=>{var _0x52de4e=_0x3aff04;_0x1507ce[_0x52de4e(0x2cd)](_0x52de4e(0x1ed),{'success':_0x6b00f0[_0x52de4e(0x267)](_0x52de4e(0x276)),'errors':_0x6b00f0[_0x52de4e(0x267)]('errors'),'role':_0x176a16,'profile':_0x543d6c,'customer':_0x18211b,'warehouse':_0x33e74f,'product':_0x2d3f4,'invoice':_0x291e55,'master_shop':_0x4b13b2,'language':_0x27f545,'rooms_data':_0x5ea503});})[_0x3aff04(0x293)](_0x4ffd36=>{var _0x550a14=_0x3aff04;_0x6b00f0[_0x550a14(0x267)](_0x550a14(0x1fc),_0x550a14(0x2df)),_0x1507ce['redirect'](_0x550a14(0x23c));});}catch(_0x1edeec){console['log'](_0x1edeec);}}),router[a0_0x322bc7(0x27a)](a0_0x322bc7(0x23d),auth,async(_0x42867d,_0x988db0)=>{var _0xaed091=a0_0x322bc7;try{const {invoice:_0x191ad7,date:_0x31285a,warehouse_name:_0x37a1d9,product_name:_0x5a2458,note:_0x3fc7f5,room:_0x28e2a8,primary_code:_0x5bdea2,secondary_code:_0x5ba361,prod_code:_0x27de1d,SCRN:_0xca59b4,ReqBy:_0x4374a2,dateofreq:_0x197603,PO_number:_0x39b7b0,typeservicesData:_0x58f9d4,typevehicle:_0x3f4a13,destination:_0x3df6da,deliverydate:_0x15cbfa,driver:_0x538561,plate:_0x19be9f,van:_0x7b183a,DRSI:_0x2aa950,TSU:_0x2e5e1a,TFU:_0x2e6a05,mode_transpo:_0x4243,name_driver:_0x433fb8,type_of_products:_0x37a9e0}=_0x42867d[_0xaed091(0x2a2)];if(typeof _0x5a2458=='string')var _0x3f4429=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x1d3)]],_0x10e792=[_0x42867d[_0xaed091(0x2a2)]['stock']],_0x35209b=[_0x42867d[_0xaed091(0x2a2)]['carton']],_0x15d5da=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x2c6)]],_0x56be10=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x265)]],_0x475782=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x253)]],_0x3bbe8b=[_0x42867d['body']['level2']],_0x1304a9=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x235)]],_0x1d435b=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x21b)]],_0x4e2b51=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x20a)]],_0x285f30=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x22c)]],_0x29f7b6=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x240)]],_0x266251=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x264)]],_0x256839=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x1cf)]],_0x511b68=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x232)]],_0x2adf22=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x1c4)]],_0x353e80=[_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x255)]],_0xbdee5d=[_0x42867d['body'][_0xaed091(0x2ba)]],_0x391353=[_0x42867d[_0xaed091(0x2a2)]['gross_price']];else var _0x3f4429=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x1d3)]],_0x10e792=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x1c5)]],_0x35209b=[..._0x42867d['body'][_0xaed091(0x210)]],_0x15d5da=[..._0x42867d['body'][_0xaed091(0x2c6)]],_0x56be10=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x265)]],_0x475782=[..._0x42867d[_0xaed091(0x2a2)]['prod_code']],_0x3bbe8b=[..._0x42867d[_0xaed091(0x2a2)]['level2']],_0x1304a9=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x235)]],_0x1d435b=[..._0x42867d['body'][_0xaed091(0x21b)]],_0x4e2b51=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x20a)]],_0x285f30=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x22c)]],_0x29f7b6=[..._0x42867d[_0xaed091(0x2a2)]['product_date']],_0x266251=[..._0x42867d['body'][_0xaed091(0x264)]],_0x256839=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x1cf)]],_0x511b68=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x232)]],_0x2adf22=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x1c4)]],_0x353e80=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x255)]],_0xbdee5d=[..._0x42867d[_0xaed091(0x2a2)]['uuid']],_0x391353=[..._0x42867d[_0xaed091(0x2a2)][_0xaed091(0x213)]];const _0x16dc9d=_0x3f4429[_0xaed091(0x2ac)](_0x2368a3=>{return _0x2368a3={'product_name':_0x2368a3};});_0x10e792[_0xaed091(0x241)]((_0x1442c8,_0x4aa895)=>{var _0x2e5f3b=_0xaed091;_0x16dc9d[_0x4aa895][_0x2e5f3b(0x1c5)]=_0x1442c8;}),_0x35209b[_0xaed091(0x241)]((_0x1e7a55,_0x157724)=>{var _0x356cc9=_0xaed091;_0x16dc9d[_0x157724][_0x356cc9(0x26f)]=Math[_0x356cc9(0x21e)](_0x1e7a55);}),_0x3f4429[_0xaed091(0x241)]((_0x5d4a05,_0x360b76)=>{var _0x2b91a8=_0xaed091;_0x16dc9d[_0x360b76][_0x2b91a8(0x26d)]=_0x42867d['body'][_0x2b91a8(0x1f1)];}),_0x391353[_0xaed091(0x241)]((_0x5033a3,_0x405751)=>{_0x16dc9d[_0x405751]['gross_price']=_0x5033a3;}),_0xbdee5d[_0xaed091(0x241)]((_0x566b3b,_0x36cf58)=>{var _0x34b35f=_0xaed091;_0x16dc9d[_0x36cf58][_0x34b35f(0x2ba)]=_0x566b3b;}),_0x353e80[_0xaed091(0x241)]((_0x151a5c,_0x50b014)=>{_0x16dc9d[_0x50b014]['id_transaction_from']=_0x151a5c;}),_0x15d5da['forEach']((_0x2bfda7,_0x13538a)=>{_0x16dc9d[_0x13538a]['primary_code']=_0x2bfda7;}),_0x56be10['forEach']((_0x4aabc5,_0x1a93c6)=>{var _0x3c17e3=_0xaed091;_0x16dc9d[_0x1a93c6][_0x3c17e3(0x265)]=_0x4aabc5;}),_0x475782[_0xaed091(0x241)]((_0x5638c5,_0x15e60d)=>{var _0x5c2078=_0xaed091;_0x16dc9d[_0x15e60d][_0x5c2078(0x243)]=_0x5638c5;}),_0x3bbe8b[_0xaed091(0x241)]((_0x130f94,_0x159618)=>{var _0x1f3512=_0xaed091,_0x227952=_0x130f94[_0x1f3512(0x2de)](/[A-Za-z]+/)[0x0],_0x5eef34=parseInt(_0x130f94[_0x1f3512(0x2de)](/\d+/)[0x0]);_0x16dc9d[_0x159618]['bay']=_0x5eef34,_0x16dc9d[_0x159618][_0x1f3512(0x258)]=_0x227952;}),_0x1304a9[_0xaed091(0x241)]((_0x443fcc,_0x4d4632)=>{var _0xd035e=_0xaed091;_0x16dc9d[_0x4d4632][_0xd035e(0x24c)]=_0x443fcc;}),_0x1d435b[_0xaed091(0x241)]((_0xb3badc,_0x3ae270)=>{_0x16dc9d[_0x3ae270]['secondary_unit']=_0xb3badc;}),_0x4e2b51[_0xaed091(0x241)]((_0x4188b5,_0xafd709)=>{var _0x18c98a=_0xaed091;_0x16dc9d[_0xafd709][_0x18c98a(0x20a)]=_0x4188b5;}),_0x285f30[_0xaed091(0x241)]((_0x2c5ec7,_0x595fc3)=>{var _0x76ce62=_0xaed091;_0x16dc9d[_0x595fc3][_0x76ce62(0x22c)]=_0x2c5ec7;}),_0x29f7b6[_0xaed091(0x241)]((_0x1b0994,_0x129e96)=>{_0x16dc9d[_0x129e96]['production_date']=_0x1b0994;}),_0x266251[_0xaed091(0x241)]((_0x77730c,_0x9025ca)=>{_0x16dc9d[_0x9025ca]['maxperunit']=_0x77730c;}),_0x256839[_0xaed091(0x241)]((_0x318aa1,_0x5f40ef)=>{var _0x2360d2=_0xaed091;_0x16dc9d[_0x5f40ef][_0x2360d2(0x1cf)]=_0x318aa1;}),_0x511b68[_0xaed091(0x241)]((_0x5e7bce,_0x5cf3a9)=>{var _0xf2954a=_0xaed091;_0x16dc9d[_0x5cf3a9][_0xf2954a(0x260)]=_0x5e7bce;}),_0x2adf22[_0xaed091(0x241)]((_0x397f67,_0x380ebe)=>{var _0x37140e=_0xaed091;_0x16dc9d[_0x380ebe][_0x37140e(0x2af)]=_0x397f67,_0x16dc9d[_0x380ebe][_0x37140e(0x206)]=_0x31285a;});const _0x574d7e=new sales_logs();await _0x574d7e['save'](),_0x2adf22[_0xaed091(0x241)]((_0x577cef,_0x2d4c53)=>{var _0x3cf47a=_0xaed091;_0x16dc9d[_0x2d4c53][_0x3cf47a(0x212)]=_0x3cf47a(0x2a9)+_0x574d7e[_0x3cf47a(0x2ae)][_0x3cf47a(0x1fb)]()[_0x3cf47a(0x285)](0x8,'0');});var _0x4e6a4f=0x0;_0x16dc9d[_0xaed091(0x241)](_0x1c7a39=>{var _0x458c4c=_0xaed091;parseFloat(_0x1c7a39[_0x458c4c(0x1c5)])<parseFloat(_0x1c7a39[_0x458c4c(0x26f)])&&parseFloat(_0x1c7a39[_0x458c4c(0x26f)])>parseFloat(_0x1c7a39['stock'])&&(console[_0x458c4c(0x226)](_0x1c7a39[_0x458c4c(0x1c5)]+_0x458c4c(0x209)+_0x1c7a39[_0x458c4c(0x26f)]),_0x4e6a4f++);});if(_0x4e6a4f!=0x0)return _0x42867d['flash']('errors',_0xaed091(0x280)),_0x988db0[_0xaed091(0x262)](_0xaed091(0x1e6));const _0x31721a=_0x16dc9d[_0xaed091(0x2c7)](_0x2bd0f0=>_0x2bd0f0[_0xaed091(0x26f)]!=='0'&&_0x2bd0f0[_0xaed091(0x26f)]!==''),_0x3389b8=new sales_finished({'invoice':'LOG-OUT-'+_0x574d7e[_0xaed091(0x2ae)][_0xaed091(0x1fb)]()[_0xaed091(0x285)](0x8,'0'),'sales_data':_0x42867d[_0xaed091(0x2a2)][_0xaed091(0x1f1)],'customer':_0x42867d['body'][_0xaed091(0x1ce)],'date':_0x31285a,'warehouse_name':_0x37a1d9,'sale_product':_0x31721a,'note':_0x3fc7f5,'room':_0x28e2a8,'primary_code':_0x5bdea2,'secondary_code':_0x5ba361,'prod_code':_0x27de1d,'SCRN':_0xca59b4,'finalize':_0xaed091(0x1be),'mode_transpo':_0x4243,'name_driver':_0x433fb8,'ReqBy':_0x4374a2,'dateofreq':_0x197603,'PO_number':_0x39b7b0,'typeservicesData':_0x58f9d4,'typevehicle':_0x3f4a13,'destination':_0x3df6da,'deliverydate':_0x15cbfa,'driver':_0x538561,'plate':_0x19be9f,'van':_0x7b183a,'DRSI':_0x2aa950,'TSU':_0x2e5e1a,'TFU':_0x2e6a05,'typeOfProducts':_0x37a9e0}),_0x4fdcdd=await _0x3389b8[_0xaed091(0x1cd)](),_0x1e10c5=await sales_finished[_0xaed091(0x1bf)]({'invoice':_0x191ad7});_0x42867d[_0xaed091(0x267)](_0xaed091(0x276),_0xaed091(0x294)),_0x988db0[_0xaed091(0x262)](_0xaed091(0x25e)+_0x4fdcdd['_id']);}catch(_0x187a30){console['log'](_0x187a30);}}),router[a0_0x322bc7(0x1fa)](a0_0x322bc7(0x274),auth,async(_0x4db7f6,_0x3e2dea)=>{var _0x37d306=a0_0x322bc7;try{const _0xf110d7=_0x4db7f6[_0x37d306(0x1c0)]['id'];console[_0x37d306(0x226)](_0xf110d7);const _0x3c260f=await product[_0x37d306(0x224)](),_0x1da34c=await purchases[_0x37d306(0x27b)]([{'$match':{'warehouse_name':_0xf110d7}},{'$unwind':_0x37d306(0x220)},{'$group':{'_id':_0x37d306(0x1c9)}}]);console[_0x37d306(0x226)](_0x37d306(0x2bc),_0x1da34c),_0x3e2dea['status'](0xc8)[_0x37d306(0x27e)]({'purchases_data':_0x1da34c,'product_data':_0x3c260f});}catch(_0x1e7a0f){console[_0x37d306(0x226)](_0x1e7a0f);}}),router[a0_0x322bc7(0x27a)]('/view/add_sale/product',auth,async(_0x396637,_0x21e209)=>{var _0x1a510e=a0_0x322bc7;try{const {warehouse_data:_0x5343d3,product_data:_0x51fc7e}=_0x396637[_0x1a510e(0x2a2)];console['log'](_0x396637[_0x1a510e(0x2a2)][_0x1a510e(0x2c9)]);;const _0x2b0759=await master_shop['find']();console['log'](_0x1a510e(0x1cc),_0x2b0759);const _0x16ad73=await product[_0x1a510e(0x1bf)]({'name':_0x51fc7e});console[_0x1a510e(0x226)](_0x1a510e(0x2aa),_0x16ad73);const _0x3d0073=await warehouse[_0x1a510e(0x27b)]([{'$match':{'name':_0x5343d3}},{'$unwind':_0x1a510e(0x215)},{'$match':{'product_details.product_name':_0x51fc7e}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':'$product_details.product_stock'}}}]);console[_0x1a510e(0x226)](_0x1a510e(0x1f0),_0x3d0073),_0x21e209[_0x1a510e(0x200)](0xc8)[_0x1a510e(0x27e)]({'master':_0x2b0759,'new_product':_0x16ad73,'stock_data':_0x3d0073});}catch(_0xfa87e9){console[_0x1a510e(0x226)](_0xfa87e9);}}),router[a0_0x322bc7(0x27a)]('/view/add_sales',auth,async(_0x3bf0a4,_0x4cbad)=>{var _0x3cf5b2=a0_0x322bc7;try{const {invoice:_0x4b920a,date:_0xd6edeb,warehouse_name:_0x3b7b11,product_name:_0xdc0c24,note:_0xf95b10,room:_0x35a139,primary_code:_0x2cf34d,secondary_code:_0x27beb7,prod_code:_0x151daf,SCRN:_0x4b8ade,ReqBy:_0x516278,dateofreq:_0x49d005,PO_number:_0x4f6fa2,typeservicesData:_0x52a7b9,typevehicle:_0x3a0d8f,destination:_0x29bc13,deliverydate:_0x2e7173,driver:_0x2c6d79,plate:_0xcfca18,van:_0x18637a,DRSI:_0x4c48bc,TSU:_0x4bc6ae,TFU:_0x4be9b9,mode_transpo:_0x59f772,name_driver:_0x5ad851,pull_out_date:_0x166d48,actual_delivery_date:_0x3ad485}=_0x3bf0a4[_0x3cf5b2(0x2a2)];if(typeof _0xdc0c24=='string')var _0x57df44=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x1d3)]],_0x12c18d=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x1c5)]],_0xcbcd5b=[_0x3bf0a4[_0x3cf5b2(0x2a2)]['carton']],_0x39c8e4=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x2c6)]],_0x5d9ba4=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x265)]],_0x2375a8=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x253)]],_0x2247d4=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x218)]],_0x2eaec2=[_0x3bf0a4[_0x3cf5b2(0x2a2)]['primary_unit']],_0x5e7a06=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x21b)]],_0x5b9332=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x20a)]],_0x52f883=[_0x3bf0a4[_0x3cf5b2(0x2a2)]['expiry_date']],_0x224d31=[_0x3bf0a4[_0x3cf5b2(0x2a2)]['product_date']],_0x568a69=[_0x3bf0a4[_0x3cf5b2(0x2a2)]['max_per_unit']],_0x2d0c7b=[_0x3bf0a4['body'][_0x3cf5b2(0x1cf)]],_0x19f3aa=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x232)]],_0x581b78=[_0x3bf0a4[_0x3cf5b2(0x2a2)]['prod_invoice']],_0x42e87e=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x255)]],_0x582d60=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x2ba)]],_0xeec949=[_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x213)]];else var _0x57df44=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x1d3)]],_0x12c18d=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x1c5)]],_0xcbcd5b=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x210)]],_0x39c8e4=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x2c6)]],_0x5d9ba4=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x265)]],_0x2375a8=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x253)]],_0x2247d4=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x218)]],_0x2eaec2=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x235)]],_0x5e7a06=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x21b)]],_0x5b9332=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x20a)]],_0x52f883=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x22c)]],_0x224d31=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x240)]],_0x568a69=[..._0x3bf0a4[_0x3cf5b2(0x2a2)]['max_per_unit']],_0x2d0c7b=[..._0x3bf0a4[_0x3cf5b2(0x2a2)]['prod_cat']],_0x19f3aa=[..._0x3bf0a4[_0x3cf5b2(0x2a2)]['RoomAssigned']],_0x581b78=[..._0x3bf0a4['body'][_0x3cf5b2(0x1c4)]],_0x42e87e=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x255)]],_0x582d60=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x2ba)]],_0xeec949=[..._0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x213)]];const _0xace76d=_0x57df44[_0x3cf5b2(0x2ac)](_0x58e3ae=>{return _0x58e3ae={'product_name':_0x58e3ae};});_0x12c18d[_0x3cf5b2(0x241)]((_0x185898,_0x345f0a)=>{var _0x4aaf85=_0x3cf5b2;_0xace76d[_0x345f0a][_0x4aaf85(0x1c5)]=_0x185898;}),_0xcbcd5b[_0x3cf5b2(0x241)]((_0x3fce17,_0x44c8d8)=>{var _0x4183cc=_0x3cf5b2;_0xace76d[_0x44c8d8][_0x4183cc(0x26f)]=Math[_0x4183cc(0x21e)](_0x3fce17);}),_0x57df44[_0x3cf5b2(0x241)]((_0x4cbc44,_0x18b437)=>{var _0x32fd41=_0x3cf5b2;_0xace76d[_0x18b437][_0x32fd41(0x26d)]=_0x3bf0a4[_0x32fd41(0x2a2)][_0x32fd41(0x1f1)];}),_0xeec949[_0x3cf5b2(0x241)]((_0x249ea5,_0x48e259)=>{_0xace76d[_0x48e259]['gross_price']=_0x249ea5;}),_0x582d60[_0x3cf5b2(0x241)]((_0x18e797,_0x2d68ee)=>{_0xace76d[_0x2d68ee]['uuid']=_0x18e797;}),_0x42e87e[_0x3cf5b2(0x241)]((_0x3c2efc,_0x2cf861)=>{_0xace76d[_0x2cf861]['id_transaction_from']=_0x3c2efc;}),_0x39c8e4[_0x3cf5b2(0x241)]((_0x2e40e1,_0x2e9a3b)=>{var _0x5a8237=_0x3cf5b2;_0xace76d[_0x2e9a3b][_0x5a8237(0x2c6)]=_0x2e40e1;}),_0x5d9ba4[_0x3cf5b2(0x241)]((_0x4d7c7c,_0x903409)=>{var _0x1a5bda=_0x3cf5b2;_0xace76d[_0x903409][_0x1a5bda(0x265)]=_0x4d7c7c;}),_0x2375a8[_0x3cf5b2(0x241)]((_0x3f71bf,_0x1c9c15)=>{var _0x45ef93=_0x3cf5b2;_0xace76d[_0x1c9c15][_0x45ef93(0x243)]=_0x3f71bf;}),_0x2247d4[_0x3cf5b2(0x241)]((_0x2adff5,_0x96af81)=>{var _0x5166fc=_0x3cf5b2,_0x36f512=_0x2adff5[_0x5166fc(0x2de)](/[A-Za-z]+/)[0x0],_0x15dcc3=parseInt(_0x2adff5['match'](/\d+/)[0x0]);_0xace76d[_0x96af81]['bay']=_0x15dcc3,_0xace76d[_0x96af81][_0x5166fc(0x258)]=_0x36f512;}),_0x2eaec2[_0x3cf5b2(0x241)]((_0x335f2f,_0x3f34a5)=>{_0xace76d[_0x3f34a5]['unit']=_0x335f2f;}),_0x5e7a06[_0x3cf5b2(0x241)]((_0x276e04,_0x6a768)=>{var _0x498e69=_0x3cf5b2;_0xace76d[_0x6a768][_0x498e69(0x21b)]=_0x276e04;}),_0x5b9332[_0x3cf5b2(0x241)]((_0x4922fc,_0x3c4bc9)=>{var _0x32748c=_0x3cf5b2;_0xace76d[_0x3c4bc9][_0x32748c(0x20a)]=_0x4922fc;}),_0x52f883[_0x3cf5b2(0x241)]((_0x288a64,_0x682d28)=>{var _0x409448=_0x3cf5b2;_0xace76d[_0x682d28][_0x409448(0x22c)]=_0x288a64;}),_0x224d31[_0x3cf5b2(0x241)]((_0x1d5ac3,_0x53c670)=>{var _0x2d5033=_0x3cf5b2;_0xace76d[_0x53c670][_0x2d5033(0x283)]=_0x1d5ac3;}),_0x568a69[_0x3cf5b2(0x241)]((_0x523a93,_0x222f29)=>{var _0x1f0f01=_0x3cf5b2;_0xace76d[_0x222f29][_0x1f0f01(0x2a6)]=_0x523a93;}),_0x2d0c7b['forEach']((_0x23c50e,_0x154afa)=>{var _0xe1f1ff=_0x3cf5b2;_0xace76d[_0x154afa][_0xe1f1ff(0x1cf)]=_0x23c50e;}),_0x19f3aa[_0x3cf5b2(0x241)]((_0x4e6edc,_0x2b6fb4)=>{_0xace76d[_0x2b6fb4]['room_name']=_0x4e6edc;}),_0x581b78['forEach']((_0xf75147,_0xc37d7c)=>{var _0x15fe8c=_0x3cf5b2;_0xace76d[_0xc37d7c][_0x15fe8c(0x2af)]=_0xf75147,_0xace76d[_0xc37d7c][_0x15fe8c(0x206)]=_0xd6edeb;});const _0x220cf6=new invoice_for_outgoing();await _0x220cf6[_0x3cf5b2(0x1cd)](),_0x581b78['forEach']((_0x99eeb7,_0x3d2438)=>{var _0x3c29d6=_0x3cf5b2;_0xace76d[_0x3d2438][_0x3c29d6(0x212)]=_0x3c29d6(0x26e)+_0x220cf6[_0x3c29d6(0x2ae)][_0x3c29d6(0x1fb)]()[_0x3c29d6(0x285)](0x8,'0');});var _0x537589=0x0;_0xace76d[_0x3cf5b2(0x241)](_0x241917=>{var _0x2e8d6c=_0x3cf5b2;parseFloat(_0x241917[_0x2e8d6c(0x1c5)])<parseFloat(_0x241917[_0x2e8d6c(0x26f)])&&parseFloat(_0x241917[_0x2e8d6c(0x26f)])>parseFloat(_0x241917[_0x2e8d6c(0x1c5)])&&(console[_0x2e8d6c(0x226)](_0x241917[_0x2e8d6c(0x1c5)]+_0x2e8d6c(0x209)+_0x241917[_0x2e8d6c(0x26f)]),_0x537589++);});if(_0x537589!=0x0)return _0x3bf0a4[_0x3cf5b2(0x267)](_0x3cf5b2(0x1fc),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x4cbad[_0x3cf5b2(0x262)](_0x3cf5b2(0x1e6));const _0x45354d=_0xace76d[_0x3cf5b2(0x2c7)](_0x4173ab=>_0x4173ab[_0x3cf5b2(0x26f)]!=='0'&&_0x4173ab[_0x3cf5b2(0x26f)]!==''),_0x590c7a=new sales_finished({'invoice':_0x3cf5b2(0x26e)+_0x220cf6[_0x3cf5b2(0x2ae)][_0x3cf5b2(0x1fb)]()['padStart'](0x8,'0'),'sales_data':_0x3bf0a4[_0x3cf5b2(0x2a2)]['sales'],'customer':_0x3bf0a4[_0x3cf5b2(0x2a2)][_0x3cf5b2(0x1ce)],'date':_0xd6edeb,'warehouse_name':_0x3b7b11,'sale_product':_0x45354d,'note':_0xf95b10,'room':_0x35a139,'primary_code':_0x2cf34d,'secondary_code':_0x27beb7,'prod_code':_0x151daf,'SCRN':_0x4b8ade,'finalize':'False','mode_transpo':_0x59f772,'name_driver':_0x5ad851,'ReqBy':_0x516278,'dateofreq':_0x49d005,'PO_number':_0x4f6fa2,'typeservicesData':_0x52a7b9,'typevehicle':_0x3a0d8f,'destination':_0x29bc13,'deliverydate':_0x2e7173,'driver':_0x2c6d79,'plate':_0xcfca18,'van':_0x18637a,'DRSI':_0x4c48bc,'TSU':_0x4bc6ae,'TFU':_0x4be9b9,'pullout_date':_0x166d48,'actualdelivery_date':_0x3ad485,'typeOfProducts':'own'}),_0x1fbe5e=await _0x590c7a[_0x3cf5b2(0x1cd)](),_0x4585ef=await sales_finished[_0x3cf5b2(0x1bf)]({'invoice':_0x4b920a});_0x3bf0a4['flash'](_0x3cf5b2(0x276),_0x3cf5b2(0x294)),_0x4cbad[_0x3cf5b2(0x262)](_0x3cf5b2(0x25e)+_0x1fbe5e['_id']);}catch(_0x4a68e0){console['log'](_0x4a68e0);}}),router[a0_0x322bc7(0x1fa)]('/preview/:id',auth,async(_0x359daf,_0xf3aba1)=>{var _0x2bdb33=a0_0x322bc7;try{const {username:_0x44c7f1,email:_0x15d631,role:_0x5a9757}=_0x359daf[_0x2bdb33(0x24f)],_0x31a52d=_0x359daf[_0x2bdb33(0x24f)],_0x46a4a0=await profile['findOne']({'email':_0x31a52d[_0x2bdb33(0x2c1)]}),_0x51411b=await master_shop[_0x2bdb33(0x224)](),_0x575ee7=_0x359daf['params']['id'],_0x1a7b8b=await sales_finished['findById'](_0x575ee7),_0x5b75df=await warehouse[_0x2bdb33(0x27b)]([{'$match':{'name':_0x1a7b8b[_0x2bdb33(0x2cf)]}},{'$unwind':_0x2bdb33(0x215)},{'$group':{'_id':_0x2bdb33(0x248),'name':{'$first':_0x2bdb33(0x2c4)},'product_stock':{'$first':_0x2bdb33(0x292)},'bay':{'$first':_0x2bdb33(0x22b)},'bin':{'$first':_0x2bdb33(0x2b6)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2bdb33(0x1e0)},'storage':{'$first':_0x2bdb33(0x25d)},'rack':{'$first':_0x2bdb33(0x24d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2bdb33(0x254)},'room':{'$first':_0x2bdb33(0x236)},'room_data':{'$first':'$product_details.room_name'}}}]),_0x565ac3=await customer['find']({});let _0x1e13ec;if(_0x31a52d[_0x2bdb33(0x22a)]==_0x2bdb33(0x21f)){const _0x273eee=await staff[_0x2bdb33(0x1bf)]({'email':_0x31a52d[_0x2bdb33(0x2c1)]});_0x1e13ec=await warehouse['aggregate']([{'$match':{'status':_0x2bdb33(0x1e3),'name':_0x273eee['warehouse']}},{'$group':{'_id':_0x2bdb33(0x1c2),'name':{'$first':'$name'}}}]);}else _0x1e13ec=await warehouse['aggregate']([{'$match':{'status':_0x2bdb33(0x1e3)}},{'$group':{'_id':_0x2bdb33(0x1c2),'name':{'$first':_0x2bdb33(0x1c2)}}}]);const _0x4bf45c=await product[_0x2bdb33(0x224)]({});if(_0x51411b[0x0][_0x2bdb33(0x2b4)]==_0x2bdb33(0x221)){var _0x16cf00=users[_0x2bdb33(0x29d)];console[_0x2bdb33(0x226)](_0x16cf00);}else{if(_0x51411b[0x0][_0x2bdb33(0x2b4)]=='Hindi')var _0x16cf00=users[_0x2bdb33(0x2b3)];else{if(_0x51411b[0x0][_0x2bdb33(0x2b4)]==_0x2bdb33(0x228))var _0x16cf00=users['German'];else{if(_0x51411b[0x0][_0x2bdb33(0x2b4)]=='Spanish')var _0x16cf00=users[_0x2bdb33(0x219)];else{if(_0x51411b[0x0][_0x2bdb33(0x2b4)]==_0x2bdb33(0x20c))var _0x16cf00=users['French'];else{if(_0x51411b[0x0][_0x2bdb33(0x2b4)]==_0x2bdb33(0x23b))var _0x16cf00=users[_0x2bdb33(0x217)];else{if(_0x51411b[0x0][_0x2bdb33(0x2b4)]==_0x2bdb33(0x2bd))var _0x16cf00=users[_0x2bdb33(0x2bd)];else{if(_0x51411b[0x0][_0x2bdb33(0x2b4)]==_0x2bdb33(0x1e4))var _0x16cf00=users['Arabic'];}}}}}}}_0xf3aba1[_0x2bdb33(0x2cd)](_0x2bdb33(0x2b2),{'success':_0x359daf[_0x2bdb33(0x267)](_0x2bdb33(0x276)),'errors':_0x359daf['flash'](_0x2bdb33(0x1fc)),'role':_0x31a52d,'profile':_0x46a4a0,'customer':_0x565ac3,'warehouse':_0x1e13ec,'product':_0x5b75df,'user':_0x1a7b8b,'master_shop':_0x51411b,'unit':_0x4bf45c,'language':_0x16cf00});}catch(_0x1d523d){console[_0x2bdb33(0x226)](_0x1d523d);}});async function dataUpdate(_0x72dbb4,_0x4c6507,_0x53a35f){var _0x286c31=a0_0x322bc7;return await warehouse[_0x286c31(0x1dc)]({'_id':_0x72dbb4,'product_details._id':_0x4c6507},{'$set':{'product_details.$.product_stock':_0x53a35f}}),await warehouse[_0x286c31(0x2d1)](_0x72dbb4);}router['post'](a0_0x322bc7(0x246),auth,async(_0x42d4d1,_0x223685)=>{var _0xf8d9f8=a0_0x322bc7;try{const _0xf99b4c=_0x42d4d1[_0xf8d9f8(0x1c0)]['id'],{invoice:_0x37b9db,warehouse_name:_0x5dd4fe,room:_0x28d54d}=_0x42d4d1[_0xf8d9f8(0x2a2)],_0x53f08c=await sales_finished[_0xf8d9f8(0x1bf)]({'invoice':_0x37b9db});for(let _0x287164=0x0;_0x287164<=_0x53f08c[_0xf8d9f8(0x1cb)][_0xf8d9f8(0x2bb)]-0x1;_0x287164++){const _0x4a8534=_0x53f08c['sale_product'][_0x287164];var _0x5ade40=await warehouse['findOne']({'name':_0x5dd4fe,'room':_0x4a8534[_0xf8d9f8(0x260)]}),_0x53c3cd=0x0;for(let _0x5aa888=0x0;_0x5aa888<=_0x5ade40[_0xf8d9f8(0x29f)][_0xf8d9f8(0x2bb)]-0x1;_0x5aa888++){const _0x7d02eb=_0x5ade40[_0xf8d9f8(0x29f)][_0x5aa888];_0x7d02eb['_id']==_0x4a8534[_0xf8d9f8(0x255)]&&_0x7d02eb['uuid']==_0x4a8534[_0xf8d9f8(0x2ba)]&&(_0x53c3cd=Math['max'](0x0,Math[_0xf8d9f8(0x21e)](_0x7d02eb['product_stock'])-Math[_0xf8d9f8(0x21e)](_0x4a8534[_0xf8d9f8(0x26f)])),await warehouse[_0xf8d9f8(0x1dc)]({'_id':_0x5ade40[_0xf8d9f8(0x25c)][_0xf8d9f8(0x23e)](),'product_details._id':_0x7d02eb[_0xf8d9f8(0x25c)][_0xf8d9f8(0x23e)](),'product_details.uuid':_0x4a8534[_0xf8d9f8(0x2ba)]},{'$set':{'product_details.$.product_stock':_0x53c3cd}}));}console['log'](typeof _0x4a8534[_0xf8d9f8(0x26d)]);if(typeof _0x4a8534[_0xf8d9f8(0x26d)]!==_0xf8d9f8(0x273)){var _0x439b58=await staff[_0xf8d9f8(0x2d1)](_0x4a8534[_0xf8d9f8(0x26d)]);console[_0xf8d9f8(0x226)](_0xf8d9f8(0x1bd));var _0x4141cf=0x0;for(let _0x173a8e=0x0;_0x173a8e<=_0x439b58['product_list'][_0xf8d9f8(0x2bb)]-0x1;_0x173a8e++){const _0x5d82be=_0x439b58[_0xf8d9f8(0x2cb)][_0x173a8e];console['log'](_0x4a8534[_0xf8d9f8(0x255)]+'\x20==\x20'+_0x5d82be[_0xf8d9f8(0x26a)]+'\x20&&\x20'+_0x4a8534[_0xf8d9f8(0x25c)]+_0xf8d9f8(0x263)+_0x4a8534[_0xf8d9f8(0x25c)]),_0x4a8534['id_transaction_from']==_0x5d82be[_0xf8d9f8(0x26a)]&&_0x4a8534['_id']==0x1&&(_0x5d82be[_0xf8d9f8(0x1ee)]=Math[_0xf8d9f8(0x21e)](_0x5d82be[_0xf8d9f8(0x1ee)])+Math['abs'](_0x4a8534[_0xf8d9f8(0x26f)]),_0x4141cf++);}console['log'](_0xf8d9f8(0x20d),_0x4141cf),_0x4141cf=='0'&&(_0x439b58[_0xf8d9f8(0x2cb)]=_0x439b58[_0xf8d9f8(0x2cb)][_0xf8d9f8(0x20f)]({'product_name':_0x4a8534['product_name'],'product_stock':_0x4a8534['quantity'],'bay':_0x4a8534[_0xf8d9f8(0x1ec)],'level':_0x4a8534[_0xf8d9f8(0x258)],'product_code':_0x4a8534[_0xf8d9f8(0x243)],'primary_code':_0x4a8534['primary_code'],'secondary_code':_0x4a8534[_0xf8d9f8(0x265)],'expiry_date':_0x4a8534['expiry_date'],'production_date':_0x4a8534[_0xf8d9f8(0x283)],'maxProducts':_0x4a8534[_0xf8d9f8(0x22d)],'batch_code':_0x4a8534[_0xf8d9f8(0x20a)],'secondary_unit':_0x4a8534[_0xf8d9f8(0x21b)],'unit':_0x4a8534[_0xf8d9f8(0x24c)],'maxProducts':_0x4a8534[_0xf8d9f8(0x22d)],'maxPerUnit':_0x4a8534[_0xf8d9f8(0x2a6)],'invoice':_0x4a8534[_0xf8d9f8(0x2af)],'warehouse_id':_0x4a8534[_0xf8d9f8(0x255)],'id_incoming':_0x4a8534[_0xf8d9f8(0x25c)],'uuid':_0x4a8534[_0xf8d9f8(0x2ba)],'gross_price':_0x4a8534['gross_price'],'date_incoming':_0x4a8534['date_data'],'outgoing_invoice':_0x4a8534[_0xf8d9f8(0x212)]}),await _0x439b58[_0xf8d9f8(0x1cd)]());}}_0x53f08c['finalize']='True';const _0x6c17ee=await _0x53f08c['save'](),_0xba6cff=await master_shop['find'](),_0x5532f1=await email_settings[_0xf8d9f8(0x1bf)](),_0x80f6b7=await supervisor_settings[_0xf8d9f8(0x224)]();var _0x34cd63=_0x53f08c[_0xf8d9f8(0x1cb)],_0x331b85='',_0x1d89ad;for(_0x1d89ad in _0x34cd63){_0x331b85+='<tr>'+_0xf8d9f8(0x299)+_0x34cd63[_0x1d89ad][_0xf8d9f8(0x1d3)]+_0xf8d9f8(0x2dc)+_0xf8d9f8(0x299)+_0x34cd63[_0x1d89ad][_0xf8d9f8(0x243)]+'</td>'+_0xf8d9f8(0x299)+_0x34cd63[_0x1d89ad]['quantity']+_0xf8d9f8(0x2dc)+_0xf8d9f8(0x299)+_0x34cd63[_0x1d89ad][_0xf8d9f8(0x24c)]+_0xf8d9f8(0x2dc)+_0xf8d9f8(0x299)+_0x34cd63[_0x1d89ad][_0xf8d9f8(0x21b)]+_0xf8d9f8(0x2dc)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x53f08c[_0xf8d9f8(0x2cf)]+_0xf8d9f8(0x2dc)+_0xf8d9f8(0x299)+_0x34cd63[_0x1d89ad][_0xf8d9f8(0x260)]+_0xf8d9f8(0x2dc)+_0xf8d9f8(0x299)+_0x34cd63[_0x1d89ad]['bay']+_0xf8d9f8(0x2dc);}_0x42d4d1['flash'](_0xf8d9f8(0x276),_0xf8d9f8(0x27d)),_0x223685[_0xf8d9f8(0x262)](_0xf8d9f8(0x239)+_0xf99b4c);}catch(_0x57804c){console[_0xf8d9f8(0x226)](_0x57804c);}}),router[a0_0x322bc7(0x1fa)](a0_0x322bc7(0x2b8),auth,async(_0x2ca216,_0x2d5781)=>{var _0x324767=a0_0x322bc7;try{const {username:_0xf7dd59,email:_0x42e185,role:_0x119d3e}=_0x2ca216['user'],_0x53c0cf=_0x2ca216[_0x324767(0x24f)],_0x2df406=await profile[_0x324767(0x1bf)]({'email':_0x53c0cf[_0x324767(0x2c1)]}),_0xe0cc73=await master_shop[_0x324767(0x224)](),_0x267066=_0x2ca216[_0x324767(0x1c0)]['id'],_0x27485f=await sales_finished[_0x324767(0x2d1)](_0x267066);let _0x11754a=new Date(_0x27485f[_0x324767(0x22c)]),_0x16cc08=('0'+_0x11754a[_0x324767(0x22e)]())['slice'](-0x2),_0x4dcd85=('0'+(_0x11754a[_0x324767(0x257)]()+0x1))[_0x324767(0x282)](-0x2),_0x56a04a=_0x11754a[_0x324767(0x26b)](),_0x149ef6=_0x56a04a+'-'+_0x4dcd85+'-'+_0x16cc08;var _0x1a7ae4=[_0x324767(0x2e1),'Enclosed'];const _0x149028=await warehouse['aggregate']([{'$match':{'name':_0x27485f[_0x324767(0x2cf)],'room':_0x27485f['room']}},{'$unwind':_0x324767(0x215)},{'$group':{'_id':_0x324767(0x248),'name':{'$first':_0x324767(0x2c4)},'product_stock':{'$first':_0x324767(0x292)},'bay':{'$first':_0x324767(0x22b)},'bin':{'$first':_0x324767(0x2b6)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x324767(0x296)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x324767(0x25d)},'rack':{'$first':_0x324767(0x24d)}}}]),_0x517c16=await customer[_0x324767(0x224)]({});let _0x1efe53;if(_0x53c0cf['role']=='staff'){const _0x6c25a1=await staff['findOne']({'email':_0x53c0cf[_0x324767(0x2c1)]});_0x1efe53=await warehouse[_0x324767(0x27b)]([{'$match':{'status':'Enabled','name':_0x6c25a1[_0x324767(0x1f8)]}},{'$group':{'_id':_0x324767(0x1c2),'name':{'$first':_0x324767(0x1c2)}}}]);}else _0x1efe53=await warehouse[_0x324767(0x27b)]([{'$match':{'status':_0x324767(0x1e3)}},{'$group':{'_id':_0x324767(0x1c2),'name':{'$first':_0x324767(0x1c2)}}}]);const _0x3d4641=await product[_0x324767(0x224)]({});if(_0xe0cc73[0x0]['language']==_0x324767(0x221)){var _0x4bab22=users[_0x324767(0x29d)];console[_0x324767(0x226)](_0x4bab22);}else{if(_0xe0cc73[0x0][_0x324767(0x2b4)]=='Hindi')var _0x4bab22=users[_0x324767(0x2b3)];else{if(_0xe0cc73[0x0][_0x324767(0x2b4)]==_0x324767(0x228))var _0x4bab22=users['German'];else{if(_0xe0cc73[0x0][_0x324767(0x2b4)]==_0x324767(0x219))var _0x4bab22=users[_0x324767(0x219)];else{if(_0xe0cc73[0x0][_0x324767(0x2b4)]==_0x324767(0x20c))var _0x4bab22=users['French'];else{if(_0xe0cc73[0x0][_0x324767(0x2b4)]==_0x324767(0x23b))var _0x4bab22=users['Portuguese'];else{if(_0xe0cc73[0x0][_0x324767(0x2b4)]==_0x324767(0x2bd))var _0x4bab22=users['Chinese'];else{if(_0xe0cc73[0x0]['language']==_0x324767(0x1e4))var _0x4bab22=users['Arabic'];}}}}}}}_0x2d5781[_0x324767(0x2cd)](_0x324767(0x27c),{'success':_0x2ca216['flash'](_0x324767(0x276)),'errors':_0x2ca216[_0x324767(0x267)](_0x324767(0x1fc)),'role':_0x53c0cf,'profile':_0x2df406,'customer':_0x517c16,'warehouse':_0x1efe53,'product':_0x149028,'user':_0x27485f,'master_shop':_0xe0cc73,'unit':_0x3d4641,'language':_0x4bab22,'rooms_data':_0x1a7ae4,'ed_fullDate':_0x149ef6});}catch(_0x374536){console[_0x324767(0x226)](_0x374536);}}),router[a0_0x322bc7(0x27a)](a0_0x322bc7(0x2b8),auth,async(_0x435e94,_0x4223e7)=>{var _0x2b32e0=a0_0x322bc7;try{const _0x3240d7=_0x435e94[_0x2b32e0(0x1c0)]['id'],_0x13ca18=await sales_finished['findOne']({'_id':_0x435e94[_0x2b32e0(0x1c0)]['id']}),_0x4f3a0f=await warehouse[_0x2b32e0(0x1bf)]({'name':_0x13ca18[_0x2b32e0(0x2cf)],'room':_0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x23a)],'warehouse_category':_0x2b32e0(0x284)}),{invoice:_0x178e7b,customer:_0x5179f5,date:_0x1b6c69,warehouse_name:_0x2c2777,product_name:_0xb776ed,stock:_0x3fa934,adjust_qty:_0x2db2d3,note:_0x4e6259,room:_0x5bde49,primary_code:_0x518221,secondary_code:_0x3ef6bc,prod_code:_0x4a89af,level:_0x5e9712,isle:_0x470cf4,pallet:_0x4276fa,expiry_date:_0x2be1fa}=_0x435e94[_0x2b32e0(0x2a2)];if(typeof _0xb776ed==_0x2b32e0(0x1f6))var _0x4d38d3=[_0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x1d3)]],_0x33a958=[_0x435e94[_0x2b32e0(0x2a2)]['stock']],_0x433a62=[_0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x207)]],_0x5124e5=[_0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x2c6)]],_0x5d3263=[_0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x265)]],_0x37a1b6=[_0x435e94['body']['prod_code']],_0xf32288=[_0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x258)]],_0x171fee=[_0x435e94[_0x2b32e0(0x2a2)]['expiry_date']];else var _0x4d38d3=[..._0x435e94[_0x2b32e0(0x2a2)]['product_name']],_0x33a958=[..._0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x1c5)]],_0x433a62=[..._0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x207)]],_0x5124e5=[..._0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x2c6)]],_0x5d3263=[..._0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x265)]],_0x37a1b6=[..._0x435e94['body'][_0x2b32e0(0x253)]],_0xf32288=[..._0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x258)]],_0x171fee=[..._0x435e94['body'][_0x2b32e0(0x22c)]];const _0x250fd2=_0x4d38d3[_0x2b32e0(0x2ac)](_0x5e764b=>{return _0x5e764b={'product_name':_0x5e764b};});_0x33a958['forEach']((_0x429d1a,_0x4bf89a)=>{var _0x8139a3=_0x2b32e0;_0x250fd2[_0x4bf89a][_0x8139a3(0x1c5)]=_0x429d1a;}),_0x433a62[_0x2b32e0(0x241)]((_0x4941e8,_0x389a53)=>{var _0x33a37c=_0x2b32e0;_0x250fd2[_0x389a53][_0x33a37c(0x26f)]=_0x4941e8;}),_0x5124e5['forEach']((_0x5d24f7,_0x311b40)=>{_0x250fd2[_0x311b40]['primary_code']=_0x5d24f7;}),_0x5d3263['forEach']((_0x52100c,_0x324a70)=>{_0x250fd2[_0x324a70]['secondary_code']=_0x52100c;}),_0x37a1b6[_0x2b32e0(0x241)]((_0x594862,_0xab9343)=>{var _0x5c0f07=_0x2b32e0;_0x250fd2[_0xab9343][_0x5c0f07(0x243)]=_0x594862;}),_0xf32288['forEach']((_0x21bbc0,_0x476394)=>{var _0xc4e5f8=_0x2b32e0;_0x250fd2[_0x476394][_0xc4e5f8(0x258)]=_0x21bbc0;}),_0x171fee['forEach']((_0x4cbf2f,_0x124dfe)=>{_0x250fd2[_0x124dfe]['expiry_date']=_0x4cbf2f;});var _0x3f1836=0x0;_0x250fd2['forEach'](_0x159be2=>{var _0x1c897a=_0x2b32e0;console[_0x1c897a(0x226)](_0x1c897a(0x208),_0x159be2),(parseInt(_0x159be2['stock'])<parseInt(_0x159be2[_0x1c897a(0x26f)])||parseInt(_0x159be2[_0x1c897a(0x26f)])==0x0)&&_0x3f1836++;});if(_0x3f1836!=0x0)return _0x435e94[_0x2b32e0(0x267)](_0x2b32e0(0x1fc),_0x2b32e0(0x225)),_0x4223e7['redirect'](_0x2b32e0(0x1e6));_0x13ca18['sale_product'][_0x2b32e0(0x241)](_0x395a5e=>{var _0x38fa8d=_0x2b32e0;const _0x2100d5=_0x4f3a0f[_0x38fa8d(0x29f)][_0x38fa8d(0x2ac)](_0x396751=>{var _0x5e77eb=_0x38fa8d;_0x396751[_0x5e77eb(0x1d3)]==_0x395a5e[_0x5e77eb(0x1d3)]&&_0x396751[_0x5e77eb(0x1ec)]==_0x395a5e[_0x5e77eb(0x1ec)]&&(_0x396751[_0x5e77eb(0x1ee)]=parseInt(_0x396751[_0x5e77eb(0x1ee)])+parseInt(_0x395a5e[_0x5e77eb(0x26f)]));});}),await _0x4f3a0f[_0x2b32e0(0x1cd)]();const _0x1057f2=_0x250fd2['filter'](_0x4acefe=>_0x4acefe['quantity']!=='0'&&_0x4acefe[_0x2b32e0(0x26f)]!=='');_0x13ca18[_0x2b32e0(0x2af)]=_0x178e7b,_0x13ca18[_0x2b32e0(0x1ce)]=_0x5179f5,_0x13ca18[_0x2b32e0(0x2cc)]=_0x1b6c69,_0x13ca18[_0x2b32e0(0x2cf)]=_0x2c2777,_0x13ca18[_0x2b32e0(0x1cb)]=_0x1057f2,_0x13ca18[_0x2b32e0(0x24b)]=_0x4e6259,_0x13ca18['room']=_0x5bde49;const _0x13e693=await _0x13ca18[_0x2b32e0(0x1cd)](),_0x4d948b=await sales_finished['findOne']({'_id':_0x435e94[_0x2b32e0(0x1c0)]['id']}),_0x5af4e2=await warehouse[_0x2b32e0(0x1bf)]({'name':_0x2c2777,'room':_0x5bde49,'warehouse_category':'Finished\x20Goods'});_0x4d948b['sale_product'][_0x2b32e0(0x241)](_0x5c86d3=>{var _0x35f4ef=_0x2b32e0;const _0x4de139=_0x5af4e2[_0x35f4ef(0x29f)][_0x35f4ef(0x2ac)](_0x563e8e=>{var _0x2bc0f8=_0x35f4ef;_0x563e8e[_0x2bc0f8(0x1d3)]==_0x5c86d3[_0x2bc0f8(0x1d3)]&&_0x563e8e[_0x2bc0f8(0x1ec)]==_0x5c86d3[_0x2bc0f8(0x1ec)]&&(_0x563e8e[_0x2bc0f8(0x1ee)]=parseInt(_0x563e8e[_0x2bc0f8(0x1ee)])-parseInt(_0x5c86d3['quantity']));});}),console[_0x2b32e0(0x226)]('final',_0x5af4e2),await _0x5af4e2[_0x2b32e0(0x1cd)]();const _0x17eb68=await c_payment_data[_0x2b32e0(0x1bf)]({'invoice':_0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x2af)]});_0x17eb68['suppliers']=_0x435e94[_0x2b32e0(0x2a2)][_0x2b32e0(0x1f9)],await _0x17eb68[_0x2b32e0(0x1cd)](),_0x435e94[_0x2b32e0(0x267)](_0x2b32e0(0x276),_0x2b32e0(0x27d)),_0x4223e7[_0x2b32e0(0x262)](_0x2b32e0(0x23c));}catch(_0x5c99f9){console[_0x2b32e0(0x226)](_0x5c99f9);}}),router['post']('/give_payment/:id',auth,async(_0x37bcd2,_0xdbb5d4)=>{var _0x3fed19=a0_0x322bc7;try{const _0x4f9b04=_0x37bcd2[_0x3fed19(0x1c0)]['id'],{invoice:_0x408f8f,customer:_0x35cf82,receivable_amount:_0x6b84ac,received_amount:_0x31ad9b}=_0x37bcd2[_0x3fed19(0x2a2)],_0x31dcae=await sales[_0x3fed19(0x2d1)](_0x4f9b04);console[_0x3fed19(0x226)](_0x31dcae);var _0x5ad4=_0x6b84ac-_0x31ad9b;console[_0x3fed19(0x226)](_0x31ad9b),_0x31dcae['received_amount']=parseFloat(_0x31ad9b)+parseFloat(_0x31dcae['received_amount']),_0x31dcae[_0x3fed19(0x2a7)]=_0x5ad4,console['log'](_0x31dcae);const _0x48ce6c=await _0x31dcae[_0x3fed19(0x1cd)](),_0xcd024a=await c_payment_data[_0x3fed19(0x1bf)]({'invoice':_0x408f8f});_0xcd024a[_0x3fed19(0x245)]=_0x5ad4,await _0xcd024a['save']();let _0x456bb0=new Date(),_0x2789ee=('0'+_0x456bb0[_0x3fed19(0x22e)]())[_0x3fed19(0x282)](-0x2),_0x3e52c4=('0'+(_0x456bb0['getMonth']()+0x1))[_0x3fed19(0x282)](-0x2),_0x2a5669=_0x456bb0[_0x3fed19(0x26b)](),_0x168fdf=_0x2a5669+'-'+_0x3e52c4+'-'+_0x2789ee;const _0x8bfd68=new customer_payment({'invoice':_0x408f8f,'date':_0x2a5669+'-'+_0x3e52c4+'-'+_0x2789ee,'customer':_0x35cf82,'reason':_0x3fed19(0x1e5),'amount':_0x31ad9b}),_0x2ac029=await _0x8bfd68['save']();_0x37bcd2['flash'](_0x3fed19(0x276),_0x3fed19(0x227)),_0xdbb5d4[_0x3fed19(0x262)]('/all_sales/view');}catch(_0x23346c){console[_0x3fed19(0x226)](_0x23346c);}}),router[a0_0x322bc7(0x1fa)](a0_0x322bc7(0x270),auth,async(_0x29bf17,_0x10151c)=>{var _0x64447a=a0_0x322bc7;try{const {username:_0x13ef89,email:_0x14c1d9,role:_0xc32eaa}=_0x29bf17[_0x64447a(0x24f)],_0x4e1ecf=_0x29bf17[_0x64447a(0x24f)],_0x3e5d81=await profile[_0x64447a(0x1bf)]({'email':_0x4e1ecf[_0x64447a(0x2c1)]}),_0x102842=await master_shop[_0x64447a(0x224)]();console[_0x64447a(0x226)](_0x64447a(0x1cc),_0x102842);const _0x1abab0=_0x29bf17[_0x64447a(0x1c0)]['id'],_0x2ba034=await sales[_0x64447a(0x2d1)](_0x1abab0);console['log'](_0x2ba034);const _0x3a016b=await customer['findOne']({'name':_0x2ba034[_0x64447a(0x1ce)]});console[_0x64447a(0x226)](_0x3a016b);if(_0x102842[0x0][_0x64447a(0x2b4)]==_0x64447a(0x221)){var _0x41d76d=users[_0x64447a(0x29d)];console[_0x64447a(0x226)](_0x41d76d);}else{if(_0x102842[0x0][_0x64447a(0x2b4)]==_0x64447a(0x2b3))var _0x41d76d=users[_0x64447a(0x2b3)];else{if(_0x102842[0x0][_0x64447a(0x2b4)]==_0x64447a(0x228))var _0x41d76d=users[_0x64447a(0x228)];else{if(_0x102842[0x0][_0x64447a(0x2b4)]==_0x64447a(0x219))var _0x41d76d=users[_0x64447a(0x219)];else{if(_0x102842[0x0][_0x64447a(0x2b4)]=='French')var _0x41d76d=users['French'];else{if(_0x102842[0x0]['language']==_0x64447a(0x23b))var _0x41d76d=users[_0x64447a(0x217)];else{if(_0x102842[0x0][_0x64447a(0x2b4)]==_0x64447a(0x2bd))var _0x41d76d=users[_0x64447a(0x2bd)];else{if(_0x102842[0x0][_0x64447a(0x2b4)]=='Arabic\x20(ae)')var _0x41d76d=users[_0x64447a(0x275)];}}}}}}}_0x10151c[_0x64447a(0x2cd)](_0x64447a(0x1ef),{'success':_0x29bf17['flash'](_0x64447a(0x276)),'errors':_0x29bf17['flash'](_0x64447a(0x1fc)),'role':_0x4e1ecf,'profile':_0x3e5d81,'master_shop':_0x102842,'customers':_0x3a016b,'sales':_0x2ba034,'language':_0x41d76d});}catch(_0x49a2f8){console[_0x64447a(0x226)](_0x49a2f8);}}),router['get'](a0_0x322bc7(0x2b1),auth,async(_0x4a6cb8,_0x18b83d)=>{var _0x4b974d=a0_0x322bc7;try{const {username:_0x274873,email:_0x4dabde,role:_0x1dd545}=_0x4a6cb8[_0x4b974d(0x24f)],_0x1564f0=_0x4a6cb8[_0x4b974d(0x24f)],_0x49cb13=await profile['findOne']({'email':_0x1564f0[_0x4b974d(0x2c1)]}),_0x5a32a4=await master_shop[_0x4b974d(0x224)](),_0x5cf776=_0x4a6cb8[_0x4b974d(0x1c0)]['id'],_0x4dcc63=await sales_finished[_0x4b974d(0x2d1)](_0x5cf776),_0x572356=await warehouse[_0x4b974d(0x27b)]([{'$match':{'name':_0x4dcc63[_0x4b974d(0x2cf)]}},{'$unwind':_0x4b974d(0x215)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4b974d(0x2c4)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4b974d(0x22b)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4b974d(0x237)},'floorlevel':{'$first':_0x4b974d(0x2c8)},'primary_code':{'$first':_0x4b974d(0x2db)},'secondary_code':{'$first':_0x4b974d(0x296)},'product_code':{'$first':_0x4b974d(0x1e0)},'storage':{'$first':_0x4b974d(0x25d)},'rack':{'$first':_0x4b974d(0x24d)},'expiry_date':{'$first':_0x4b974d(0x2a3)},'production_date':{'$first':_0x4b974d(0x2c0)},'unit':{'$first':_0x4b974d(0x1c6)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x4b974d(0x244)}}}]),_0x3e292f=await product[_0x4b974d(0x224)]({}),_0x55d8a1=await warehouse['aggregate']([{'$match':{'status':_0x4b974d(0x1e3),'warehouse_category':_0x4b974d(0x284),'name':{'$ne':_0x4b974d(0x261),'$ne':_0x4b974d(0x1e7)}}},{'$group':{'_id':_0x4b974d(0x1c2),'name':{'$first':_0x4b974d(0x1c2)}}},{'$sort':{'name':0x1}}]);var _0x5baebc=[_0x4b974d(0x29b)];const _0x3a8868=await warehouse[_0x4b974d(0x27b)]([{'$match':{'status':_0x4b974d(0x1e3),'name':_0x4b974d(0x1e7)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x5a32a4[0x0]['language']==_0x4b974d(0x221)){var _0x294516=users[_0x4b974d(0x29d)];console[_0x4b974d(0x226)](_0x294516);}else{if(_0x5a32a4[0x0][_0x4b974d(0x2b4)]==_0x4b974d(0x2b3))var _0x294516=users['Hindi'];else{if(_0x5a32a4[0x0]['language']==_0x4b974d(0x228))var _0x294516=users[_0x4b974d(0x228)];else{if(_0x5a32a4[0x0]['language']=='Spanish')var _0x294516=users['Spanish'];else{if(_0x5a32a4[0x0][_0x4b974d(0x2b4)]==_0x4b974d(0x20c))var _0x294516=users['French'];else{if(_0x5a32a4[0x0][_0x4b974d(0x2b4)]==_0x4b974d(0x23b))var _0x294516=users[_0x4b974d(0x217)];else{if(_0x5a32a4[0x0][_0x4b974d(0x2b4)]==_0x4b974d(0x2bd))var _0x294516=users[_0x4b974d(0x2bd)];else{if(_0x5a32a4[0x0][_0x4b974d(0x2b4)]==_0x4b974d(0x1e4))var _0x294516=users[_0x4b974d(0x275)];}}}}}}}_0x18b83d[_0x4b974d(0x2cd)](_0x4b974d(0x2a8),{'success':_0x4a6cb8[_0x4b974d(0x267)](_0x4b974d(0x276)),'errors':_0x4a6cb8[_0x4b974d(0x267)]('errors'),'role':_0x1564f0,'profile':_0x49cb13,'user':_0x4dcc63,'stock':_0x572356,'master_shop':_0x5a32a4,'unit':_0x3e292f,'language':_0x294516,'warehouses':_0x55d8a1,'rooms':_0x5baebc,'warehouse_QA':_0x3a8868});}catch(_0x5d9d90){console[_0x4b974d(0x226)](_0x5d9d90),_0x18b83d[_0x4b974d(0x200)](0xc8)[_0x4b974d(0x27e)]({'message':_0x5d9d90[_0x4b974d(0x281)]});}}),router['post'](a0_0x322bc7(0x2b1),auth,async(_0x1d3909,_0x48860d)=>{var _0xf1f5ae=a0_0x322bc7;if(_0x1d3909['body']['for_categorize']=='QA')try{const {invoice:_0x181b8e,date:_0xab417a,warehouse_name:_0xc62529,product_name:_0x3a4d5e,primary_code:_0x5e815b,secondary_code:_0xaaa482,product_code:_0x21f187,sales_quantity:_0x16928d,stocks:_0xda40b3,return_qty:_0x52fdc2,Room_name:_0x2b0ba4,to_warehouse_name_QA:_0x27e8c3,to_Room_name_QA:_0x5423b3,note:_0xcd40c2,for_categorize:_0x204f46,product_name_QA1:_0x23b46e}=_0x1d3909[_0xf1f5ae(0x2a2)];if(typeof _0x23b46e==_0xf1f5ae(0x1f6))var _0x2ca2b1=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x278)]],_0x2a54d8=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x269)]],_0x3dba8d=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x29e)]],_0xbb7f03=[_0x1d3909['body'][_0xf1f5ae(0x2a0)]],_0x5eca42=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x229)]],_0x3c384f=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x201)]],_0x3c87ac=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x23f)]],_0x47639c=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1c7)]],_0x56e7d3=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1de)]],_0x52a0c8=[_0x1d3909[_0xf1f5ae(0x2a2)]['batch_code_QA']],_0x1feac6=[_0x1d3909['body'][_0xf1f5ae(0x1d2)]],_0x11dafb=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1d6)]],_0x29b918=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x24a)]],_0x966faa=[_0x1d3909['body'][_0xf1f5ae(0x2d2)]];else var _0x2ca2b1=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x278)]],_0x2a54d8=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x269)]],_0x3dba8d=[..._0x1d3909['body'][_0xf1f5ae(0x29e)]],_0xbb7f03=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x2a0)]],_0x5eca42=[..._0x1d3909[_0xf1f5ae(0x2a2)]['sales_quantity_QA']],_0x3c384f=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x201)]],_0x3c87ac=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x23f)]],_0x47639c=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1c7)]],_0x56e7d3=[..._0x1d3909[_0xf1f5ae(0x2a2)]['maxProducts_QA']],_0x52a0c8=[..._0x1d3909['body'][_0xf1f5ae(0x1d4)]],_0x1feac6=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1d2)]],_0x11dafb=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1d6)]],_0x29b918=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x24a)]],_0x966faa=[..._0x1d3909['body'][_0xf1f5ae(0x2d2)]];const _0x5ba594=_0x2ca2b1['map'](_0x392b0a=>{return _0x392b0a={'product_name':_0x392b0a};});_0x2a54d8['forEach']((_0x2d7873,_0x4cd55b)=>{var _0x232e91=_0xf1f5ae;_0x5ba594[_0x4cd55b][_0x232e91(0x2c6)]=_0x2d7873;}),_0x3dba8d[_0xf1f5ae(0x241)]((_0x14af58,_0x566889)=>{_0x5ba594[_0x566889]['secondary_code']=_0x14af58;}),_0xbb7f03[_0xf1f5ae(0x241)]((_0xe3d70e,_0x2013f7)=>{var _0x353e8e=_0xf1f5ae;_0x5ba594[_0x2013f7][_0x353e8e(0x243)]=_0xe3d70e;}),_0x5eca42['forEach']((_0x2d8f91,_0x6e0946)=>{var _0x3369e0=_0xf1f5ae;_0x5ba594[_0x6e0946][_0x3369e0(0x2c5)]=_0x2d8f91;}),_0x3c384f[_0xf1f5ae(0x241)]((_0x50f0ba,_0x4c5fd6)=>{_0x5ba594[_0x4c5fd6]['stock']=_0x50f0ba;}),_0x3c87ac[_0xf1f5ae(0x241)]((_0xc7a74b,_0x71a00e)=>{var _0xf67584=_0xf1f5ae;_0x5ba594[_0x71a00e][_0xf67584(0x2d8)]=_0xc7a74b;}),_0x47639c[_0xf1f5ae(0x241)]((_0x5405ec,_0x2eb484)=>{var _0x3545f7=_0xf1f5ae;_0x5ba594[_0x2eb484][_0x3545f7(0x2b0)]=_0x5405ec;}),_0x56e7d3[_0xf1f5ae(0x241)]((_0x4c0792,_0x3b6ea5)=>{var _0x281728=_0xf1f5ae;_0x5ba594[_0x3b6ea5][_0x281728(0x22d)]=_0x4c0792;}),_0x52a0c8[_0xf1f5ae(0x241)]((_0x59b506,_0x59c032)=>{_0x5ba594[_0x59c032]['batch_code']=_0x59b506;}),_0x1feac6['forEach']((_0x32b133,_0x3d488e)=>{_0x5ba594[_0x3d488e]['secondary_unit']=_0x32b133;}),_0x11dafb[_0xf1f5ae(0x241)]((_0xaf6ec5,_0x2266fe)=>{var _0x3f78e3=_0xf1f5ae;_0x5ba594[_0x2266fe][_0x3f78e3(0x24c)]=_0xaf6ec5;}),_0x29b918[_0xf1f5ae(0x241)]((_0x2ea6e9,_0x457e07)=>{var _0x148cf9=_0xf1f5ae;_0x5ba594[_0x457e07][_0x148cf9(0x283)]=_0x2ea6e9;}),_0x966faa[_0xf1f5ae(0x241)]((_0x1373ce,_0x4ec2a1)=>{_0x5ba594[_0x4ec2a1]['expiry_date']=_0x1373ce;});const _0x42f3e1=await sales_finished[_0xf1f5ae(0x1bf)]({'invoice':_0x181b8e});_0x42f3e1[_0xf1f5ae(0x24e)]=_0xf1f5ae(0x205);const _0x1d40b2=await _0x42f3e1[_0xf1f5ae(0x1cd)](),_0x4fb55c=new sales_return_finished({'invoice':_0x181b8e,'customer':_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1ce)],'date':_0xab417a,'warehouse_name':_0xc62529,'room':_0x2b0ba4,'ToWarehouse':_0x27e8c3,'ToRoom':_0x5423b3,'return_sale_QA':_0x5ba594,'note':_0xcd40c2,'warehouse_cat':_0x204f46}),_0x41d262=await _0x4fb55c[_0xf1f5ae(0x1cd)](),_0x1a4d38=await sales_return_finished[_0xf1f5ae(0x1bf)]({'invoice':_0x181b8e}),_0x58c54e=await warehouse[_0xf1f5ae(0x1bf)]({'name':_0x27e8c3,'room':_0x5423b3});_0x1a4d38[_0xf1f5ae(0x25f)][_0xf1f5ae(0x241)](_0x32779b=>{var _0xd66ea5=_0xf1f5ae,_0xe49468=0x0;const _0x19153c=_0x58c54e[_0xd66ea5(0x29f)]['map'](_0x353577=>{var _0x249204=_0xd66ea5;_0x353577[_0x249204(0x1d3)]==_0x32779b[_0x249204(0x1d3)]&&_0x353577[_0x249204(0x22c)]==_0x32779b[_0x249204(0x22c)]&&_0x353577[_0x249204(0x283)]==_0x32779b[_0x249204(0x283)]&&_0x353577['batch_code']==_0x32779b[_0x249204(0x20a)]&&(_0x353577[_0x249204(0x1ee)]=parseInt(_0x353577[_0x249204(0x1ee)])+parseInt(_0x32779b[_0x249204(0x2d8)]),_0xe49468++);});_0xe49468=='0'&&(_0x58c54e[_0xd66ea5(0x29f)]=_0x58c54e[_0xd66ea5(0x29f)]['concat']({'product_name':_0x32779b[_0xd66ea5(0x1d3)],'product_stock':_0x32779b['return_qty'],'primary_code':_0x32779b['primary_code'],'secondary_code':_0x32779b[_0xd66ea5(0x265)],'product_code':_0x32779b[_0xd66ea5(0x243)],'batch_code':_0x32779b[_0xd66ea5(0x20a)],'maxPerUnit':_0x32779b['maxPerUnit'],'production_date':_0x32779b['production_date'],'expiry_date':_0x32779b[_0xd66ea5(0x22c)],'secondary_unit':_0x32779b[_0xd66ea5(0x21b)],'unit':_0x32779b[_0xd66ea5(0x24c)],'maxProducts':_0x32779b[_0xd66ea5(0x22d)],'bay':_0x32779b['bay']}));}),await _0x58c54e[_0xf1f5ae(0x1cd)]();const _0xfc53c3=new c_payment_data({'invoice':_0x181b8e,'customer':_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1ce)],'reason':_0xf1f5ae(0x2a5)});await _0xfc53c3[_0xf1f5ae(0x1cd)]();const _0x1db25e=await master_shop[_0xf1f5ae(0x224)](),_0x3e0438=await email_settings[_0xf1f5ae(0x1bf)](),_0x343b43=await customer['findOne']({'name':_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1ce)]});_0x1db25e[0x0][_0xf1f5ae(0x2b7)]==0x1?(right_currency=_0x1db25e[0x0][_0xf1f5ae(0x291)],left_currency=''):(right_currency='',left_currency=_0x1db25e[0x0][_0xf1f5ae(0x291)]);var _0x59d762=_0x2ca2b1,_0x5183ed=_0x3c87ac,_0xea2ef5='',_0x11c84b;for(_0x11c84b in _0x59d762){_0xea2ef5+=_0xf1f5ae(0x2da)+_0xf1f5ae(0x299)+_0x59d762[_0x11c84b]+_0xf1f5ae(0x2dc)+_0xf1f5ae(0x299)+_0x5183ed[_0x11c84b]+_0xf1f5ae(0x2dc)+_0xf1f5ae(0x29a);}console[_0xf1f5ae(0x226)](_0xf1f5ae(0x2cb),_0xea2ef5);let _0x120463=nodemailer[_0xf1f5ae(0x28f)]({'service':_0xf1f5ae(0x298),'auth':{'user':_0x3e0438[_0xf1f5ae(0x2c1)],'pass':_0x3e0438[_0xf1f5ae(0x28b)]}}),_0x2de79a={'from':_0x3e0438[_0xf1f5ae(0x2c1)],'to':_0x343b43[_0xf1f5ae(0x2c1)],'subject':_0xf1f5ae(0x20b),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+'/upload/'+_0x1db25e[0x0][_0xf1f5ae(0x256)],'cid':_0xf1f5ae(0x290)}],'html':_0xf1f5ae(0x271)+_0xf1f5ae(0x222)+_0xf1f5ae(0x21a)+_0xf1f5ae(0x252)+_0xf1f5ae(0x1c8)+_0xf1f5ae(0x252)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0xf1f5ae(0x1c3)+'<div>'+'<h2>\x20'+_0x1db25e[0x0]['site_title']+'\x20</h2>'+'</div>'+_0xf1f5ae(0x1c3)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0xf1f5ae(0x286)+_0xf1f5ae(0x2d4)+_0x181b8e+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0xf1f5ae(0x1fe)+_0xab417a+'\x20'+_0xf1f5ae(0x1f7)+_0xf1f5ae(0x26c)+_0xf1f5ae(0x1c3)+_0xf1f5ae(0x231)+_0xf1f5ae(0x2b9)+_0xf1f5ae(0x2da)+_0xf1f5ae(0x242)+_0xf1f5ae(0x277)+_0xf1f5ae(0x25a)+_0xf1f5ae(0x250)+_0xf1f5ae(0x29a)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0xea2ef5+'\x20'+'</tbody>'+'</table>'+_0xf1f5ae(0x252)+_0xf1f5ae(0x28e)+_0xf1f5ae(0x2bf)+_0x1db25e[0x0][_0xf1f5ae(0x230)]+_0xf1f5ae(0x26c)+_0xf1f5ae(0x1c3)+_0xf1f5ae(0x1c3)+_0xf1f5ae(0x1db)};_0x120463['sendMail'](_0x2de79a,function(_0xab38a3,_0x563aca){var _0x174115=_0xf1f5ae;_0xab38a3?(console[_0x174115(0x226)](_0xab38a3),console[_0x174115(0x226)]('Error\x20Occurs')):console[_0x174115(0x226)](_0x174115(0x2be));}),_0x1d3909['flash']('success','sales\x20item\x20return\x20successfull'),_0x48860d[_0xf1f5ae(0x262)](_0xf1f5ae(0x23c));}catch(_0x3fd26f){_0x48860d['status'](0xc8)[_0xf1f5ae(0x27e)]({'message1':_0x3fd26f[_0xf1f5ae(0x281)]});}else{if(_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x251)]=='GS')try{const {invoice:_0x2eb964,date:_0x4e3c53,warehouse_name:_0x293644,product_name:_0x2821e4,primary_code:_0x1acaf2,secondary_code:_0x1ac00e,product_code:_0x93f027,sales_quantity:_0x587af5,stocks:_0xc7e64f,return_qty:_0x1b88e6,Room_name:_0x66bac6,to_warehouse_name:_0x1780ee,to_Room_name:_0x38c442,note:_0x2ae445,level:_0x1d5778,isle:_0x29730b,pallet:_0x4ee23e,for_categorize:_0x45d6d9}=_0x1d3909['body'];if(typeof _0x2821e4==_0xf1f5ae(0x1f6))var _0x2ca2b1=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1d3)]],_0x2a54d8=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x2c6)]],_0x3dba8d=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x265)]],_0xbb7f03=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x243)]],_0x5eca42=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x279)]],_0x3c87ac=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x2d8)]],_0x1edb14=[_0x1d3909[_0xf1f5ae(0x2a2)]['bay']],_0x47639c=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x2b0)]],_0x56e7d3=[_0x1d3909[_0xf1f5ae(0x2a2)]['maxProducts']],_0x52a0c8=[_0x1d3909[_0xf1f5ae(0x2a2)]['batch_code']],_0x1feac6=[_0x1d3909['body']['secondary_unit']],_0x11dafb=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x24c)]],_0x29b918=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x283)]],_0x966faa=[_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x22c)]];else var _0x2ca2b1=[..._0x1d3909['body'][_0xf1f5ae(0x1d3)]],_0x2a54d8=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x2c6)]],_0x3dba8d=[..._0x1d3909[_0xf1f5ae(0x2a2)]['secondary_code']],_0xbb7f03=[..._0x1d3909['body'][_0xf1f5ae(0x243)]],_0x5eca42=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x279)]],_0x3c87ac=[..._0x1d3909['body'][_0xf1f5ae(0x2d8)]],_0x1edb14=[..._0x1d3909[_0xf1f5ae(0x2a2)]['bay']],_0x47639c=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x2b0)]],_0x56e7d3=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x22d)]],_0x52a0c8=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x20a)]],_0x1feac6=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x21b)]],_0x11dafb=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x24c)]],_0x29b918=[..._0x1d3909[_0xf1f5ae(0x2a2)]['production_date']],_0x966faa=[..._0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x22c)]];const _0x1fa997=_0x2ca2b1[_0xf1f5ae(0x2ac)](_0x558a17=>{return _0x558a17={'product_name':_0x558a17};});_0x2a54d8[_0xf1f5ae(0x241)]((_0x35b647,_0x2ef721)=>{var _0x1d83c0=_0xf1f5ae;_0x1fa997[_0x2ef721][_0x1d83c0(0x2c6)]=_0x35b647;}),_0x3dba8d[_0xf1f5ae(0x241)]((_0xe76d2c,_0x26596c)=>{_0x1fa997[_0x26596c]['secondary_code']=_0xe76d2c;}),_0xbb7f03['forEach']((_0x20b361,_0x5cff7f)=>{var _0x3801cc=_0xf1f5ae;_0x1fa997[_0x5cff7f][_0x3801cc(0x243)]=_0x20b361;}),_0x5eca42['forEach']((_0x29ec87,_0x4583dd)=>{_0x1fa997[_0x4583dd]['sale_qty']=_0x29ec87;}),_0x3c87ac[_0xf1f5ae(0x241)]((_0x282cd1,_0x1b3482)=>{var _0x4c3383=_0xf1f5ae;_0x1fa997[_0x1b3482][_0x4c3383(0x2d8)]=_0x282cd1;}),_0x1edb14[_0xf1f5ae(0x241)]((_0x3fb69e,_0x5bfee3)=>{_0x1fa997[_0x5bfee3]['bay']=_0x3fb69e;}),_0x47639c['forEach']((_0x420234,_0x5386d1)=>{var _0x3f1fc=_0xf1f5ae;_0x1fa997[_0x5386d1][_0x3f1fc(0x2b0)]=_0x420234;}),_0x56e7d3[_0xf1f5ae(0x241)]((_0x43e4e3,_0x569329)=>{_0x1fa997[_0x569329]['maxProducts']=_0x43e4e3;}),_0x52a0c8[_0xf1f5ae(0x241)]((_0x20b5f2,_0x51be17)=>{_0x1fa997[_0x51be17]['batch_code']=_0x20b5f2;}),_0x1feac6[_0xf1f5ae(0x241)]((_0x48cdcb,_0x5db3ff)=>{_0x1fa997[_0x5db3ff]['secondary_unit']=_0x48cdcb;}),_0x11dafb['forEach']((_0x5467c7,_0x58b8c4)=>{var _0x4b2fda=_0xf1f5ae;_0x1fa997[_0x58b8c4][_0x4b2fda(0x24c)]=_0x5467c7;}),_0x29b918[_0xf1f5ae(0x241)]((_0x5b7383,_0x3f376e)=>{_0x1fa997[_0x3f376e]['production_date']=_0x5b7383;}),_0x966faa[_0xf1f5ae(0x241)]((_0x1540d2,_0x5b4ac0)=>{var _0x2ec125=_0xf1f5ae;_0x1fa997[_0x5b4ac0][_0x2ec125(0x22c)]=_0x1540d2;});var _0x5d6903=0x0;_0x1fa997['forEach'](_0x3a3689=>{var _0x175e2d=_0xf1f5ae;(parseInt(_0x3a3689[_0x175e2d(0x2c5)])<parseInt(_0x3a3689[_0x175e2d(0x2d8)])||parseInt(_0x3a3689[_0x175e2d(0x1c5)])<parseInt(_0x3a3689['return_qty'])&&parseInt(_0x3a3689[_0x175e2d(0x2c5)])>parseInt(_0x3a3689[_0x175e2d(0x2d8)])||parseInt(_0x3a3689[_0x175e2d(0x2d8)])==0x0)&&_0x5d6903++;});if(_0x5d6903!=0x0)return _0x1d3909[_0xf1f5ae(0x267)](_0xf1f5ae(0x1fc),_0xf1f5ae(0x1c1)),_0x48860d[_0xf1f5ae(0x262)](_0xf1f5ae(0x1e6));const _0x5b342e=await sales_finished[_0xf1f5ae(0x1bf)]({'invoice':_0x2eb964});_0x5b342e['return_data']=_0xf1f5ae(0x205);const _0x521136=await _0x5b342e[_0xf1f5ae(0x1cd)](),_0x9e1c04=new sales_return_finished({'invoice':_0x2eb964,'customer':_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1ce)],'date':_0x4e3c53,'warehouse_name':_0x293644,'room':_0x66bac6,'ToWarehouse':_0x1780ee,'ToRoom':_0x38c442,'return_sale':_0x1fa997,'note':_0x2ae445,'warehouse_cat':_0x45d6d9}),_0x29a045=await _0x9e1c04['save'](),_0x485f44=await sales_return_finished['findOne']({'invoice':_0x2eb964}),_0x4cc387=await warehouse[_0xf1f5ae(0x1bf)]({'name':_0x1780ee,'room':_0x38c442,'warehouse_category':_0xf1f5ae(0x284)});_0x485f44['return_sale'][_0xf1f5ae(0x241)](_0x5791e5=>{var _0x5a7647=_0xf1f5ae,_0x405cd1=0x0;const _0x12763f=_0x4cc387['product_details'][_0x5a7647(0x2ac)](_0x1bd297=>{var _0x42c4c2=_0x5a7647;_0x1bd297[_0x42c4c2(0x1d3)]==_0x5791e5[_0x42c4c2(0x1d3)]&&_0x1bd297[_0x42c4c2(0x1ec)]==_0x5791e5['bay']&&_0x1bd297['expiry_date']==_0x5791e5[_0x42c4c2(0x22c)]&&_0x1bd297[_0x42c4c2(0x283)]==_0x5791e5[_0x42c4c2(0x283)]&&_0x1bd297[_0x42c4c2(0x20a)]==_0x5791e5[_0x42c4c2(0x20a)]&&(_0x1bd297[_0x42c4c2(0x1ee)]=parseInt(_0x1bd297[_0x42c4c2(0x1ee)])+parseInt(_0x5791e5[_0x42c4c2(0x2d8)]),_0x405cd1++);});_0x405cd1=='0'&&(_0x4cc387[_0x5a7647(0x29f)]=_0x4cc387[_0x5a7647(0x29f)][_0x5a7647(0x20f)]({'product_name':_0x5791e5[_0x5a7647(0x1d3)],'product_stock':_0x5791e5[_0x5a7647(0x2d8)],'primary_code':_0x5791e5[_0x5a7647(0x2c6)],'secondary_code':_0x5791e5[_0x5a7647(0x265)],'product_code':_0x5791e5[_0x5a7647(0x243)],'bay':_0x5791e5[_0x5a7647(0x1ec)],'batch_code':_0x5791e5[_0x5a7647(0x20a)],'maxPerUnit':_0x5791e5[_0x5a7647(0x2b0)],'production_date':_0x5791e5[_0x5a7647(0x283)],'expiry_date':_0x5791e5['expiry_date'],'secondary_unit':_0x5791e5[_0x5a7647(0x21b)],'unit':_0x5791e5[_0x5a7647(0x24c)],'maxProducts':_0x5791e5[_0x5a7647(0x22d)]}));}),await _0x4cc387['save'](),console[_0xf1f5ae(0x226)](_0x1d3909[_0xf1f5ae(0x2a2)]);const _0x3cbe2d=new c_payment_data({'invoice':_0x2eb964,'customer':_0x1d3909[_0xf1f5ae(0x2a2)][_0xf1f5ae(0x1ce)],'reason':_0xf1f5ae(0x2a5)});await _0x3cbe2d[_0xf1f5ae(0x1cd)]();const _0x3a4e95=await master_shop[_0xf1f5ae(0x224)]();console[_0xf1f5ae(0x226)](_0xf1f5ae(0x29c),_0x3a4e95[0x0][_0xf1f5ae(0x256)]);const _0x2bddf8=await email_settings[_0xf1f5ae(0x1bf)](),_0xe00b7d=await customer[_0xf1f5ae(0x1bf)]({'name':_0x1d3909[_0xf1f5ae(0x2a2)]['customer']});console[_0xf1f5ae(0x226)](_0xf1f5ae(0x2dd),_0xe00b7d);_0x3a4e95[0x0][_0xf1f5ae(0x2b7)]==0x1?(right_currency=_0x3a4e95[0x0][_0xf1f5ae(0x291)],left_currency=''):(right_currency='',left_currency=_0x3a4e95[0x0][_0xf1f5ae(0x291)]);var _0x59d762=_0x2ca2b1,_0x5183ed=_0x3c87ac,_0xea2ef5='',_0x11c84b;for(_0x11c84b in _0x59d762){_0xea2ef5+='<tr>'+_0xf1f5ae(0x299)+_0x59d762[_0x11c84b]+_0xf1f5ae(0x2dc)+_0xf1f5ae(0x299)+_0x5183ed[_0x11c84b]+_0xf1f5ae(0x2dc)+'</tr>';}console[_0xf1f5ae(0x226)](_0xf1f5ae(0x2cb),_0xea2ef5);let _0x290185=nodemailer[_0xf1f5ae(0x28f)]({'service':_0xf1f5ae(0x298),'auth':{'user':_0x2bddf8[_0xf1f5ae(0x2c1)],'pass':_0x2bddf8[_0xf1f5ae(0x28b)]}}),_0x782ccf={'from':_0x2bddf8[_0xf1f5ae(0x2c1)],'to':_0xe00b7d[_0xf1f5ae(0x2c1)],'subject':_0xf1f5ae(0x20b),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0xf1f5ae(0x2d7)+_0x3a4e95[0x0][_0xf1f5ae(0x256)],'cid':_0xf1f5ae(0x290)}],'html':_0xf1f5ae(0x271)+_0xf1f5ae(0x222)+_0xf1f5ae(0x21a)+_0xf1f5ae(0x252)+_0xf1f5ae(0x1c8)+_0xf1f5ae(0x252)+_0xf1f5ae(0x1d9)+'</div>'+_0xf1f5ae(0x252)+_0xf1f5ae(0x238)+_0x3a4e95[0x0]['site_title']+'\x20</h2>'+'</div>'+'</div>'+_0xf1f5ae(0x2ca)+_0xf1f5ae(0x252)+_0xf1f5ae(0x286)+_0xf1f5ae(0x2d4)+_0x2eb964+'\x20'+_0xf1f5ae(0x2a1)+_0xf1f5ae(0x1fe)+_0x4e3c53+'\x20'+_0xf1f5ae(0x1f7)+_0xf1f5ae(0x26c)+_0xf1f5ae(0x1c3)+_0xf1f5ae(0x231)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xf1f5ae(0x2da)+_0xf1f5ae(0x242)+_0xf1f5ae(0x277)+_0xf1f5ae(0x25a)+_0xf1f5ae(0x250)+'</tr>'+'</thead>'+_0xf1f5ae(0x1eb)+'\x20'+_0xea2ef5+'\x20'+_0xf1f5ae(0x2ab)+'</table>'+_0xf1f5ae(0x252)+_0xf1f5ae(0x28e)+_0xf1f5ae(0x2bf)+_0x3a4e95[0x0]['site_title']+'</h5>'+'</div>'+'</div>'+_0xf1f5ae(0x1db)};_0x290185[_0xf1f5ae(0x289)](_0x782ccf,function(_0x386217,_0x353f5b){var _0x4ac096=_0xf1f5ae;_0x386217?(console[_0x4ac096(0x226)](_0x386217),console['log']('Error\x20Occurs')):console[_0x4ac096(0x226)](_0x4ac096(0x2be));}),_0x1d3909['flash'](_0xf1f5ae(0x276),_0xf1f5ae(0x259)),_0x48860d[_0xf1f5ae(0x262)](_0xf1f5ae(0x23c));}catch(_0x2517a0){console[_0xf1f5ae(0x226)](_0x2517a0),_0x48860d[_0xf1f5ae(0x200)](0xc8)[_0xf1f5ae(0x27e)]({'message1':_0x2517a0['message']});}}}),router['get'](a0_0x322bc7(0x1d7),auth,async(_0x46134f,_0x5b300c)=>{var _0x405a40=a0_0x322bc7;try{const {username:_0x5f126c,email:_0x3e61ef,role:_0x53dbc6}=_0x46134f[_0x405a40(0x24f)],_0x20c1d3=_0x46134f[_0x405a40(0x24f)],_0x3f35ab=await profile[_0x405a40(0x1bf)]({'email':_0x20c1d3[_0x405a40(0x2c1)]}),_0x268f4f=await master_shop[_0x405a40(0x224)]();console[_0x405a40(0x226)](_0x405a40(0x234),_0x268f4f);const _0x3e9eb=_0x46134f[_0x405a40(0x1c0)]['id'],_0x27305b=await sales[_0x405a40(0x2d1)](_0x3e9eb);console[_0x405a40(0x226)](_0x405a40(0x1e1),_0x27305b);if(_0x268f4f[0x0][_0x405a40(0x2b4)]==_0x405a40(0x221))var _0x42f07b=users['English'];else{if(_0x268f4f[0x0][_0x405a40(0x2b4)]==_0x405a40(0x2b3))var _0x42f07b=users[_0x405a40(0x2b3)];else{if(_0x268f4f[0x0][_0x405a40(0x2b4)]==_0x405a40(0x228))var _0x42f07b=users[_0x405a40(0x228)];else{if(_0x268f4f[0x0][_0x405a40(0x2b4)]==_0x405a40(0x219))var _0x42f07b=users[_0x405a40(0x219)];else{if(_0x268f4f[0x0][_0x405a40(0x2b4)]==_0x405a40(0x20c))var _0x42f07b=users[_0x405a40(0x20c)];else{if(_0x268f4f[0x0][_0x405a40(0x2b4)]==_0x405a40(0x23b))var _0x42f07b=users[_0x405a40(0x217)];else{if(_0x268f4f[0x0][_0x405a40(0x2b4)]==_0x405a40(0x2bd))var _0x42f07b=users[_0x405a40(0x2bd)];else{if(_0x268f4f[0x0][_0x405a40(0x2b4)]==_0x405a40(0x1e4))var _0x42f07b=users[_0x405a40(0x275)];}}}}}}}_0x5b300c[_0x405a40(0x2cd)](_0x405a40(0x1f4),{'success':_0x46134f[_0x405a40(0x267)](_0x405a40(0x276)),'errors':_0x46134f[_0x405a40(0x267)]('errors'),'role':_0x20c1d3,'profile':_0x3f35ab,'alldata':_0x27305b,'master_shop':_0x268f4f,'language':_0x42f07b});}catch(_0x4b41a5){console['log'](_0x4b41a5);}}),router['post'](a0_0x322bc7(0x202),async(_0x462300,_0x5e95c3)=>{var _0x414a9f=a0_0x322bc7;const {product_code:_0x590542,warehouse_name:_0x5ec73a,rooms_data:_0x107176,Roomslist:_0x498460,sales_category:_0x476057}=_0x462300[_0x414a9f(0x2a2)],_0x5963c8=_0x498460[_0x414a9f(0x1d8)](','),_0x48084a=[];async function _0x17334c(_0x25ec7d){var _0x5bb484=_0x414a9f;const _0x213277=await warehouse['aggregate']([{'$match':{'name':_0x5ec73a,'room':_0x25ec7d}},{'$unwind':_0x5bb484(0x215)},{'$match':{'product_details.primary_code':_0x590542}},{'$group':{'_id':_0x5bb484(0x248),'name':{'$first':_0x5bb484(0x2c4)},'product_stock':{'$first':_0x5bb484(0x292)},'primary_code':{'$first':_0x5bb484(0x2db)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5bb484(0x1e0)},'level':{'$first':_0x5bb484(0x1ff)},'bay':{'$first':_0x5bb484(0x22b)},'type':{'$first':_0x5bb484(0x237)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5bb484(0x1c6)},'secondary_unit':{'$first':_0x5bb484(0x223)},'storage':{'$first':_0x5bb484(0x25d)},'rack':{'$first':_0x5bb484(0x24d)},'expiry_date':{'$first':_0x5bb484(0x2a3)},'production_date':{'$first':_0x5bb484(0x2c0)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x5bb484(0x254)},'product_cat':{'$first':_0x5bb484(0x1d0)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x5bb484(0x236)},'invoice':{'$first':_0x5bb484(0x1d1)},'uuid':{'$first':_0x5bb484(0x21c)},'gross_price':{'$first':_0x5bb484(0x2d5)},'sales_category':{'$first':_0x5bb484(0x2ad)}}}]),_0x34bfcb=await warehouse[_0x5bb484(0x27b)]([{'$match':{'name':_0x5ec73a,'room':_0x25ec7d}},{'$unwind':_0x5bb484(0x215)},{'$match':{'product_details.secondary_code':_0x590542}},{'$group':{'_id':_0x5bb484(0x248),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5bb484(0x2db)},'secondary_code':{'$first':_0x5bb484(0x296)},'product_code':{'$first':_0x5bb484(0x1e0)},'level':{'$first':_0x5bb484(0x22b)},'isle':{'$first':_0x5bb484(0x2b6)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x5bb484(0x2c8)},'unit':{'$first':_0x5bb484(0x1c6)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5bb484(0x24d)},'expiry_date':{'$first':_0x5bb484(0x2a3)},'production_date':{'$first':_0x5bb484(0x2c0)},'maxPerUnit':{'$first':_0x5bb484(0x244)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x5bb484(0x236)},'invoice':{'$first':_0x5bb484(0x1d1)},'uuid':{'$first':_0x5bb484(0x21c)},'gross_price':{'$first':_0x5bb484(0x2d5)},'sales_category':{'$first':_0x5bb484(0x2ad)}}}]);if(_0x213277['length']>0x0)_0x48084a[_0x5bb484(0x1ea)](_0x213277);else _0x34bfcb[_0x5bb484(0x2bb)]>0x0&&_0x48084a[_0x5bb484(0x1ea)](_0x34bfcb);}const _0x522622=_0x5963c8[_0x414a9f(0x2ac)](_0x51117c=>_0x17334c(_0x51117c));await Promise['all'](_0x522622),_0x5e95c3['json'](_0x48084a);}),router[a0_0x322bc7(0x27a)]('/barcode_scanner_logs',async(_0x15660c,_0x2b83fe)=>{var _0x3be85a=a0_0x322bc7;const {product_code:_0x13a997,warehouse_name:_0x5de02c,rooms_data:_0x22a7cc,Roomslist:_0x36354d,sales_category:_0x44e84b}=_0x15660c[_0x3be85a(0x2a2)],_0x29a6b3=_0x36354d[_0x3be85a(0x1d8)](','),_0x24c2b1=[];async function _0x40e6b0(_0x1e488a){var _0x3dcfc4=_0x3be85a;const _0x1736e0=await warehouse[_0x3dcfc4(0x27b)]([{'$match':{'name':_0x5de02c,'room':_0x1e488a}},{'$unwind':_0x3dcfc4(0x215)},{'$match':{'product_details.primary_code':_0x13a997,'product_details.sales_category':_0x44e84b,'product_details.type_products':_0x3dcfc4(0x226)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3dcfc4(0x292)},'primary_code':{'$first':_0x3dcfc4(0x2db)},'secondary_code':{'$first':_0x3dcfc4(0x296)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3dcfc4(0x1ff)},'bay':{'$first':_0x3dcfc4(0x22b)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3dcfc4(0x2c8)},'unit':{'$first':_0x3dcfc4(0x1c6)},'secondary_unit':{'$first':_0x3dcfc4(0x223)},'storage':{'$first':_0x3dcfc4(0x25d)},'rack':{'$first':_0x3dcfc4(0x24d)},'expiry_date':{'$first':_0x3dcfc4(0x2a3)},'production_date':{'$first':_0x3dcfc4(0x2c0)},'maxPerUnit':{'$first':_0x3dcfc4(0x244)},'batch_code':{'$first':_0x3dcfc4(0x254)},'product_cat':{'$first':_0x3dcfc4(0x1d0)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x3dcfc4(0x1d1)},'uuid':{'$first':_0x3dcfc4(0x21c)},'gross_price':{'$first':_0x3dcfc4(0x2d5)},'sales_category':{'$first':_0x3dcfc4(0x2ad)},'type_products':{'$first':_0x3dcfc4(0x2d0)}}}]);console['log'](_0x3dcfc4(0x226)+_0x3dcfc4(0x209)+_0x13a997+_0x3dcfc4(0x209)+_0x44e84b);const _0x1a450c=await warehouse[_0x3dcfc4(0x27b)]([{'$match':{'name':_0x5de02c,'room':_0x1e488a}},{'$unwind':_0x3dcfc4(0x215)},{'$match':{'product_details.secondary_code':_0x13a997,'product_details.sales_category':_0x44e84b,'product_details.type_products':_0x3dcfc4(0x226)}},{'$group':{'_id':_0x3dcfc4(0x248),'name':{'$first':_0x3dcfc4(0x2c4)},'product_stock':{'$first':_0x3dcfc4(0x292)},'primary_code':{'$first':_0x3dcfc4(0x2db)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3dcfc4(0x22b)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3dcfc4(0x237)},'pallet':{'$first':_0x3dcfc4(0x2c8)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x3dcfc4(0x223)},'storage':{'$first':_0x3dcfc4(0x25d)},'rack':{'$first':_0x3dcfc4(0x24d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3dcfc4(0x2c0)},'maxPerUnit':{'$first':_0x3dcfc4(0x244)},'batch_code':{'$first':_0x3dcfc4(0x254)},'product_cat':{'$first':_0x3dcfc4(0x1d0)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3dcfc4(0x236)},'invoice':{'$first':_0x3dcfc4(0x1d1)},'uuid':{'$first':_0x3dcfc4(0x21c)},'gross_price':{'$first':_0x3dcfc4(0x2d5)},'sales_category':{'$first':_0x3dcfc4(0x2ad)},'type_products':{'$first':_0x3dcfc4(0x2d0)}}}]);if(_0x1736e0[_0x3dcfc4(0x2bb)]>0x0)_0x24c2b1[_0x3dcfc4(0x1ea)](_0x1736e0);else _0x1a450c[_0x3dcfc4(0x2bb)]>0x0&&_0x24c2b1[_0x3dcfc4(0x1ea)](_0x1a450c);}const _0x2343f7=_0x29a6b3['map'](_0x3d6da1=>_0x40e6b0(_0x3d6da1));await Promise[_0x3be85a(0x2e0)](_0x2343f7),_0x2b83fe[_0x3be85a(0x27e)](_0x24c2b1);}),module[a0_0x322bc7(0x211)]=router;