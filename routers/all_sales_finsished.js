var a0_0x1032ba=a0_0x1357;(function(_0x3d772c,_0x2f8ea2){var _0x4a7f9d=a0_0x1357,_0x4d0055=_0x3d772c();while(!![]){try{var _0x21235b=-parseInt(_0x4a7f9d(0x22f))/0x1*(parseInt(_0x4a7f9d(0x277))/0x2)+parseInt(_0x4a7f9d(0x2d9))/0x3+-parseInt(_0x4a7f9d(0x326))/0x4*(-parseInt(_0x4a7f9d(0x312))/0x5)+-parseInt(_0x4a7f9d(0x28d))/0x6+-parseInt(_0x4a7f9d(0x1f7))/0x7*(parseInt(_0x4a7f9d(0x30b))/0x8)+parseInt(_0x4a7f9d(0x22d))/0x9+parseInt(_0x4a7f9d(0x1ef))/0xa*(parseInt(_0x4a7f9d(0x279))/0xb);if(_0x21235b===_0x2f8ea2)break;else _0x4d0055['push'](_0x4d0055['shift']());}catch(_0x2c07e1){_0x4d0055['push'](_0x4d0055['shift']());}}}(a0_0x5669,0x970ec));const express=require('express'),app=express(),router=express[a0_0x1032ba(0x209)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require(a0_0x1032ba(0x290)),auth=require(a0_0x1032ba(0x1ea)),nodemailer=require(a0_0x1032ba(0x282)),users=require(a0_0x1032ba(0x2eb)),mongoose=require(a0_0x1032ba(0x272));router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x327),auth,async(_0x36da83,_0x3d72a8)=>{var _0x4bedfb=a0_0x1032ba;try{const {username:_0x125462,email:_0x35b8f8,role:_0x1c7e7d}=_0x36da83[_0x4bedfb(0x2bf)],_0x59da1f=_0x36da83['user'],_0x120952=await profile[_0x4bedfb(0x1ee)]({'email':_0x59da1f[_0x4bedfb(0x313)]}),_0x577d14=await master_shop[_0x4bedfb(0x2f2)]();let _0x47d7dc;if(_0x59da1f['role']=='staff'){const _0xfff4a7=await staff['findOne']({'email':_0x59da1f[_0x4bedfb(0x313)]});_0x47d7dc=await sales_finished[_0x4bedfb(0x2cf)]([{'$match':{'typeOfProducts':'own'}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x4bedfb(0x2f6),'invoice':{'$first':_0x4bedfb(0x2be)},'customers':{'$first':_0x4bedfb(0x23e)},'date':{'$first':_0x4bedfb(0x21d)},'warehouse_name':{'$first':_0x4bedfb(0x1fc)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x4bedfb(0x2c3)},'return_data':{'$first':_0x4bedfb(0x25a)},'customers_docs':{'$first':_0x4bedfb(0x270)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x4bedfb(0x2b4)},'isle':{'$addToSet':_0x4bedfb(0x283)},'type':{'$addToSet':_0x4bedfb(0x2c8)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x47d7dc=await sales_finished[_0x4bedfb(0x2cf)]([{'$match':{'typeOfProducts':_0x4bedfb(0x2d1)}},{'$unwind':_0x4bedfb(0x24e)},{'$group':{'_id':_0x4bedfb(0x2f6),'invoice':{'$first':_0x4bedfb(0x2be)},'customers':{'$first':_0x4bedfb(0x23e)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x4bedfb(0x1fc)},'sale_product':{'$push':_0x4bedfb(0x24e)},'note':{'$first':_0x4bedfb(0x2c3)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x4bedfb(0x270)},'total_saleproduct_quantity':{'$sum':_0x4bedfb(0x21f)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x4bedfb(0x2c8)},'pallet':{'$addToSet':_0x4bedfb(0x2f3)},'finalize':{'$first':_0x4bedfb(0x319)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x577d14[0x0][_0x4bedfb(0x238)]==_0x4bedfb(0x310)){var _0x54ccfa=users[_0x4bedfb(0x2ff)];console[_0x4bedfb(0x27a)](_0x54ccfa);}else{if(_0x577d14[0x0][_0x4bedfb(0x238)]==_0x4bedfb(0x268))var _0x54ccfa=users[_0x4bedfb(0x268)];else{if(_0x577d14[0x0][_0x4bedfb(0x238)]==_0x4bedfb(0x28c))var _0x54ccfa=users[_0x4bedfb(0x28c)];else{if(_0x577d14[0x0][_0x4bedfb(0x238)]==_0x4bedfb(0x250))var _0x54ccfa=users[_0x4bedfb(0x250)];else{if(_0x577d14[0x0][_0x4bedfb(0x238)]=='French')var _0x54ccfa=users[_0x4bedfb(0x30e)];else{if(_0x577d14[0x0]['language']=='Portuguese\x20(BR)')var _0x54ccfa=users['Portuguese'];else{if(_0x577d14[0x0][_0x4bedfb(0x238)]=='Chinese')var _0x54ccfa=users['Chinese'];else{if(_0x577d14[0x0][_0x4bedfb(0x238)]==_0x4bedfb(0x321))var _0x54ccfa=users[_0x4bedfb(0x1f0)];}}}}}}}_0x3d72a8[_0x4bedfb(0x23c)](_0x4bedfb(0x2ab),{'success':_0x36da83[_0x4bedfb(0x240)](_0x4bedfb(0x23f)),'errors':_0x36da83[_0x4bedfb(0x240)](_0x4bedfb(0x210)),'sales':_0x47d7dc,'profile':_0x120952,'role':_0x59da1f,'master_shop':_0x577d14,'language':_0x54ccfa});}catch(_0xba1757){console[_0x4bedfb(0x27a)](_0xba1757);}}),router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x28b),auth,async(_0x2e467a,_0x339729)=>{var _0x95f764=a0_0x1032ba;try{const {username:_0x55c14a,email:_0x2885f6,role:_0x379085}=_0x2e467a[_0x95f764(0x2bf)],_0x3ed825=_0x2e467a[_0x95f764(0x2bf)],_0x59ef1b=await profile[_0x95f764(0x1ee)]({'email':_0x3ed825[_0x95f764(0x313)]}),_0x32677d=await master_shop[_0x95f764(0x2f2)]();let _0x59be60;if(_0x3ed825[_0x95f764(0x204)]==_0x95f764(0x262)){const _0x1b6a8a=await staff[_0x95f764(0x1ee)]({'email':_0x3ed825[_0x95f764(0x313)]});_0x59be60=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x95f764(0x29b)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x95f764(0x2f6),'invoice':{'$first':_0x95f764(0x2be)},'customers':{'$first':_0x95f764(0x23e)},'date':{'$first':_0x95f764(0x21d)},'warehouse_name':{'$first':_0x95f764(0x1fc)},'sale_product':{'$push':_0x95f764(0x24e)},'note':{'$first':_0x95f764(0x2c3)},'return_data':{'$first':_0x95f764(0x25a)},'customers_docs':{'$first':_0x95f764(0x270)},'total_saleproduct_quantity':{'$sum':_0x95f764(0x21f)},'level':{'$addToSet':_0x95f764(0x2b4)},'isle':{'$addToSet':_0x95f764(0x283)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x59be60=await sales_finished[_0x95f764(0x2cf)]([{'$match':{'typeOfProducts':_0x95f764(0x29b)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x95f764(0x2f6),'invoice':{'$first':_0x95f764(0x2be)},'customers':{'$first':_0x95f764(0x23e)},'date':{'$first':_0x95f764(0x21d)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x95f764(0x2c3)},'return_data':{'$first':_0x95f764(0x25a)},'customers_docs':{'$first':_0x95f764(0x270)},'total_saleproduct_quantity':{'$sum':_0x95f764(0x21f)},'level':{'$addToSet':_0x95f764(0x2b4)},'isle':{'$addToSet':_0x95f764(0x283)},'type':{'$addToSet':_0x95f764(0x2c8)},'pallet':{'$addToSet':_0x95f764(0x2f3)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x32677d[0x0]['language']==_0x95f764(0x310)){var _0x5060d5=users[_0x95f764(0x2ff)];console['log'](_0x5060d5);}else{if(_0x32677d[0x0][_0x95f764(0x238)]=='Hindi')var _0x5060d5=users['Hindi'];else{if(_0x32677d[0x0][_0x95f764(0x238)]==_0x95f764(0x28c))var _0x5060d5=users['German'];else{if(_0x32677d[0x0]['language']==_0x95f764(0x250))var _0x5060d5=users[_0x95f764(0x250)];else{if(_0x32677d[0x0][_0x95f764(0x238)]==_0x95f764(0x30e))var _0x5060d5=users['French'];else{if(_0x32677d[0x0][_0x95f764(0x238)]==_0x95f764(0x2b6))var _0x5060d5=users[_0x95f764(0x20d)];else{if(_0x32677d[0x0][_0x95f764(0x238)]==_0x95f764(0x239))var _0x5060d5=users[_0x95f764(0x239)];else{if(_0x32677d[0x0]['language']==_0x95f764(0x321))var _0x5060d5=users['Arabic'];}}}}}}}_0x339729['render'](_0x95f764(0x1f1),{'success':_0x2e467a[_0x95f764(0x240)](_0x95f764(0x23f)),'errors':_0x2e467a[_0x95f764(0x240)](_0x95f764(0x210)),'sales':_0x59be60,'profile':_0x59ef1b,'role':_0x3ed825,'master_shop':_0x32677d,'language':_0x5060d5});}catch(_0x118dac){console[_0x95f764(0x27a)](_0x118dac);}});async function getRandom8DigitNumber(){var _0x27e9da=a0_0x1032ba;const _0x1fd765=0x989680,_0xd32438=0x5f5e0ff,_0x3d145d=Math['floor'](Math[_0x27e9da(0x2e9)]()*(_0xd32438-_0x1fd765+0x1))+_0x1fd765;var _0x52545e;const _0x4b0cb3=await sales_finished[_0x27e9da(0x1ee)]({'invoice':_0x27e9da(0x2a3)+_0x3d145d});return _0x4b0cb3&&_0x4b0cb3[_0x27e9da(0x246)]>0x0?_0x52545e=_0x27e9da(0x2a3)+_0x3d145d:_0x52545e=_0x27e9da(0x2a3)+_0x3d145d,_0x52545e;}function a0_0x1357(_0x49b125,_0x26713d){var _0x56698b=a0_0x5669();return a0_0x1357=function(_0x135736,_0x2817fb){_0x135736=_0x135736-0x1e3;var _0x13d1f0=_0x56698b[_0x135736];return _0x13d1f0;},a0_0x1357(_0x49b125,_0x26713d);}router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x2e1),auth,async(_0x27a433,_0x36d670)=>{var _0x52d54d=a0_0x1032ba;try{const {username:_0x195e84,email:_0x2416fa,role:_0x175fd2}=_0x27a433[_0x52d54d(0x2bf)],_0x27da94=_0x27a433[_0x52d54d(0x2bf)],_0x7cda85=await profile[_0x52d54d(0x1ee)]({'email':_0x27da94[_0x52d54d(0x313)]}),_0x2d3fc4=await master_shop[_0x52d54d(0x2f2)](),_0x109a0a=await customer[_0x52d54d(0x2f2)]({});let _0x33119f;if(_0x27da94['role']==_0x52d54d(0x262)){const _0x2c2525=await staff[_0x52d54d(0x1ee)]({'email':_0x27da94[_0x52d54d(0x313)]});_0x33119f=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x2c2525[_0x52d54d(0x2f5)]}},{'$group':{'_id':_0x52d54d(0x1f8),'name':{'$first':_0x52d54d(0x1f8)}}},{'$sort':{'name':0x1}}]);}else _0x33119f=await warehouse[_0x52d54d(0x2cf)]([{'$match':{'status':_0x52d54d(0x2c7)}},{'$group':{'_id':'$name','name':{'$first':_0x52d54d(0x1f8)}}},{'$sort':{'name':0x1}}]);const _0x4cf515=await product[_0x52d54d(0x2f2)]({});var _0x531c77=[_0x52d54d(0x213),_0x52d54d(0x29d)];const _0x1c5024=await sales_finished['find']({}),_0x455e8a=_0x1c5024[_0x52d54d(0x246)]+0x1,_0x494b52='OUTF-'+_0x455e8a['toString']()['padStart'](0x5,'0');if(_0x2d3fc4[0x0][_0x52d54d(0x238)]==_0x52d54d(0x310)){var _0x48269e=users['English'];console[_0x52d54d(0x27a)](_0x48269e);}else{if(_0x2d3fc4[0x0][_0x52d54d(0x238)]==_0x52d54d(0x268))var _0x48269e=users[_0x52d54d(0x268)];else{if(_0x2d3fc4[0x0]['language']==_0x52d54d(0x28c))var _0x48269e=users['German'];else{if(_0x2d3fc4[0x0][_0x52d54d(0x238)]==_0x52d54d(0x250))var _0x48269e=users[_0x52d54d(0x250)];else{if(_0x2d3fc4[0x0][_0x52d54d(0x238)]==_0x52d54d(0x30e))var _0x48269e=users[_0x52d54d(0x30e)];else{if(_0x2d3fc4[0x0][_0x52d54d(0x238)]==_0x52d54d(0x2b6))var _0x48269e=users[_0x52d54d(0x20d)];else{if(_0x2d3fc4[0x0][_0x52d54d(0x238)]==_0x52d54d(0x239))var _0x48269e=users[_0x52d54d(0x239)];else{if(_0x2d3fc4[0x0]['language']=='Arabic\x20(ae)')var _0x48269e=users['Arabic'];}}}}}}}const _0x372def=getRandom8DigitNumber();_0x372def[_0x52d54d(0x2e0)](_0x380775=>{var _0xacc045=_0x52d54d;_0x36d670[_0xacc045(0x23c)](_0xacc045(0x2a9),{'success':_0x27a433[_0xacc045(0x240)](_0xacc045(0x23f)),'errors':_0x27a433['flash']('errors'),'role':_0x27da94,'profile':_0x7cda85,'customer':_0x109a0a,'warehouse':_0x33119f,'product':_0x4cf515,'invoice':_0x380775,'master_shop':_0x2d3fc4,'language':_0x48269e,'rooms_data':_0x531c77});})['catch'](_0x579567=>{var _0x1735bf=_0x52d54d;_0x27a433[_0x1735bf(0x240)](_0x1735bf(0x210),_0x1735bf(0x30a)),_0x36d670[_0x1735bf(0x2a0)]('/all_sales_finished/view');});}catch(_0x5363ee){console[_0x52d54d(0x27a)](_0x5363ee);}}),router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x254),auth,async(_0x43ad5d,_0x1a6f68)=>{var _0x59501f=a0_0x1032ba;try{const {username:_0x17a50c,email:_0x558a75,role:_0x4bde51}=_0x43ad5d[_0x59501f(0x2bf)],_0x34e5a9=_0x43ad5d[_0x59501f(0x2bf)],_0xc27081=await profile[_0x59501f(0x1ee)]({'email':_0x34e5a9['email']}),_0x5be289=await master_shop['find'](),_0x2cd2b3=await customer['find']({});let _0x292e26;if(_0x34e5a9[_0x59501f(0x204)]==_0x59501f(0x262)){const _0x30159d=await staff[_0x59501f(0x1ee)]({'email':_0x34e5a9[_0x59501f(0x313)]});_0x292e26=await warehouse[_0x59501f(0x2cf)]([{'$match':{'status':_0x59501f(0x2c7),'name':_0x30159d[_0x59501f(0x2f5)]}},{'$group':{'_id':_0x59501f(0x1f8),'name':{'$first':_0x59501f(0x1f8)}}},{'$sort':{'name':0x1}}]);}else _0x292e26=await warehouse[_0x59501f(0x2cf)]([{'$match':{'status':_0x59501f(0x2c7)}},{'$group':{'_id':_0x59501f(0x1f8),'name':{'$first':_0x59501f(0x1f8)}}},{'$sort':{'name':0x1}}]);const _0x485442=await product[_0x59501f(0x2f2)]({});var _0x4da2e2=['Ambient',_0x59501f(0x29d)];const _0x1688d0=await sales_finished[_0x59501f(0x2f2)]({}),_0x43946d=_0x1688d0[_0x59501f(0x246)]+0x1,_0x39cebf=_0x59501f(0x2a3)+_0x43946d[_0x59501f(0x28e)]()['padStart'](0x5,'0');if(_0x5be289[0x0][_0x59501f(0x238)]=='English\x20(US)'){var _0x1bf706=users[_0x59501f(0x2ff)];console[_0x59501f(0x27a)](_0x1bf706);}else{if(_0x5be289[0x0][_0x59501f(0x238)]==_0x59501f(0x268))var _0x1bf706=users[_0x59501f(0x268)];else{if(_0x5be289[0x0][_0x59501f(0x238)]==_0x59501f(0x28c))var _0x1bf706=users['German'];else{if(_0x5be289[0x0][_0x59501f(0x238)]==_0x59501f(0x250))var _0x1bf706=users['Spanish'];else{if(_0x5be289[0x0][_0x59501f(0x238)]==_0x59501f(0x30e))var _0x1bf706=users[_0x59501f(0x30e)];else{if(_0x5be289[0x0][_0x59501f(0x238)]==_0x59501f(0x2b6))var _0x1bf706=users[_0x59501f(0x20d)];else{if(_0x5be289[0x0][_0x59501f(0x238)]=='Chinese')var _0x1bf706=users[_0x59501f(0x239)];else{if(_0x5be289[0x0][_0x59501f(0x238)]=='Arabic\x20(ae)')var _0x1bf706=users[_0x59501f(0x1f0)];}}}}}}}const _0x360106=getRandom8DigitNumber();_0x360106[_0x59501f(0x2e0)](_0x182120=>{var _0x35452f=_0x59501f;_0x1a6f68[_0x35452f(0x23c)](_0x35452f(0x281),{'success':_0x43ad5d[_0x35452f(0x240)](_0x35452f(0x23f)),'errors':_0x43ad5d[_0x35452f(0x240)](_0x35452f(0x210)),'role':_0x34e5a9,'profile':_0xc27081,'customer':_0x2cd2b3,'warehouse':_0x292e26,'product':_0x485442,'invoice':_0x182120,'master_shop':_0x5be289,'language':_0x1bf706,'rooms_data':_0x4da2e2});})[_0x59501f(0x2ed)](_0x3b8c17=>{var _0x23ad86=_0x59501f;_0x43ad5d[_0x23ad86(0x240)](_0x23ad86(0x210),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1a6f68['redirect'](_0x23ad86(0x328));});}catch(_0x2bee51){console[_0x59501f(0x27a)](_0x2bee51);}}),router[a0_0x1032ba(0x21c)](a0_0x1032ba(0x254),auth,async(_0x341c2d,_0x13e43a)=>{var _0x6f6686=a0_0x1032ba;try{const {invoice:_0x70fd49,date:_0x32cba9,warehouse_name:_0x4e2834,product_name:_0x35393f,note:_0xe3fe95,room:_0x2770d5,primary_code:_0x468ac6,secondary_code:_0x3629c1,prod_code:_0x175828,SCRN:_0x19f7e8,ReqBy:_0x483091,dateofreq:_0x3f2816,PO_number:_0x564b62,typeservicesData:_0x2046ea,typevehicle:_0x2fbcb4,destination:_0x544700,deliverydate:_0x4cf301,driver:_0x241c9c,plate:_0x38048b,van:_0x40246d,DRSI:_0x3d6e7b,TSU:_0x5e9f70,TFU:_0x22acfb,mode_transpo:_0x490a4c,name_driver:_0x1c361b,type_of_products:_0x546614}=_0x341c2d[_0x6f6686(0x1f3)];if(typeof _0x35393f==_0x6f6686(0x2e3))var _0x19fc71=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x320)]],_0x1ea69b=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x21b)]],_0x2fb0b2=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x202)]],_0x1a19c0=[_0x341c2d[_0x6f6686(0x1f3)]['primary_code']],_0x5a8c50=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x296)]],_0x2fac0c=[_0x341c2d['body']['prod_code']],_0x178d82=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x2a1)]],_0x51780d=[_0x341c2d['body'][_0x6f6686(0x31d)]],_0xd0dcd8=[_0x341c2d['body'][_0x6f6686(0x1f5)]],_0x9213a8=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x1e7)]],_0x4a41c1=[_0x341c2d['body'][_0x6f6686(0x225)]],_0x19cfea=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x275)]],_0x3040e0=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x23d)]],_0xb1a302=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x306)]],_0x21c9a8=[_0x341c2d['body']['RoomAssigned']],_0x57921c=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x1f6)]],_0x145925=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x305)]],_0x392241=[_0x341c2d['body'][_0x6f6686(0x317)]],_0x52e91b=[_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x30c)]];else var _0x19fc71=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x320)]],_0x1ea69b=[..._0x341c2d['body'][_0x6f6686(0x21b)]],_0x2fb0b2=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x202)]],_0x1a19c0=[..._0x341c2d[_0x6f6686(0x1f3)]['primary_code']],_0x5a8c50=[..._0x341c2d['body'][_0x6f6686(0x296)]],_0x2fac0c=[..._0x341c2d[_0x6f6686(0x1f3)]['prod_code']],_0x178d82=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x2a1)]],_0x51780d=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x31d)]],_0xd0dcd8=[..._0x341c2d['body'][_0x6f6686(0x1f5)]],_0x9213a8=[..._0x341c2d[_0x6f6686(0x1f3)]['batch_code']],_0x4a41c1=[..._0x341c2d['body']['expiry_date']],_0x19cfea=[..._0x341c2d[_0x6f6686(0x1f3)]['product_date']],_0x3040e0=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x23d)]],_0xb1a302=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x306)]],_0x21c9a8=[..._0x341c2d[_0x6f6686(0x1f3)]['RoomAssigned']],_0x57921c=[..._0x341c2d[_0x6f6686(0x1f3)]['prod_invoice']],_0x145925=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x305)]],_0x392241=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x317)]],_0x52e91b=[..._0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x30c)]];const _0x546fda=_0x19fc71[_0x6f6686(0x20a)](_0x4839ae=>{return _0x4839ae={'product_name':_0x4839ae};});_0x1ea69b[_0x6f6686(0x2c5)]((_0x15af1f,_0x488033)=>{var _0x231543=_0x6f6686;_0x546fda[_0x488033][_0x231543(0x21b)]=_0x15af1f;}),_0x2fb0b2[_0x6f6686(0x2c5)]((_0x130a66,_0x2bb899)=>{var _0x195d3c=_0x6f6686;_0x546fda[_0x2bb899][_0x195d3c(0x2fb)]=Math[_0x195d3c(0x230)](_0x130a66);}),_0x19fc71[_0x6f6686(0x2c5)]((_0x2115c0,_0x2d708a)=>{var _0xc42cc7=_0x6f6686;_0x546fda[_0x2d708a][_0xc42cc7(0x29e)]=_0x341c2d[_0xc42cc7(0x1f3)]['sales'];}),_0x52e91b['forEach']((_0x24f42a,_0x16398d)=>{var _0x5ab68b=_0x6f6686;_0x546fda[_0x16398d][_0x5ab68b(0x30c)]=_0x24f42a;}),_0x392241[_0x6f6686(0x2c5)]((_0x953dd4,_0xc5799a)=>{_0x546fda[_0xc5799a]['uuid']=_0x953dd4;}),_0x145925[_0x6f6686(0x2c5)]((_0x10f045,_0x3612ff)=>{var _0xff542f=_0x6f6686;_0x546fda[_0x3612ff][_0xff542f(0x305)]=_0x10f045;}),_0x1a19c0['forEach']((_0x3b78ac,_0x18a21d)=>{var _0x137db8=_0x6f6686;_0x546fda[_0x18a21d][_0x137db8(0x243)]=_0x3b78ac;}),_0x5a8c50[_0x6f6686(0x2c5)]((_0x400eb4,_0x190bb9)=>{var _0x5b4346=_0x6f6686;_0x546fda[_0x190bb9][_0x5b4346(0x296)]=_0x400eb4;}),_0x2fac0c[_0x6f6686(0x2c5)]((_0x4d6061,_0x4fd2b9)=>{_0x546fda[_0x4fd2b9]['product_code']=_0x4d6061;}),_0x178d82['forEach']((_0x138512,_0x4e1c11)=>{var _0x3cacd2=_0x6f6686,_0x1e4a37=_0x138512[_0x3cacd2(0x27c)](/[A-Za-z]+/)[0x0],_0x3abf64=parseInt(_0x138512['match'](/\d+/)[0x0]);_0x546fda[_0x4e1c11]['bay']=_0x3abf64,_0x546fda[_0x4e1c11][_0x3cacd2(0x2fe)]=_0x1e4a37;}),_0x51780d[_0x6f6686(0x2c5)]((_0xfc8fd2,_0x1b827d)=>{var _0x50234c=_0x6f6686;_0x546fda[_0x1b827d][_0x50234c(0x226)]=_0xfc8fd2;}),_0xd0dcd8[_0x6f6686(0x2c5)]((_0x20bfe1,_0x1ec76f)=>{var _0x5897bb=_0x6f6686;_0x546fda[_0x1ec76f][_0x5897bb(0x1f5)]=_0x20bfe1;}),_0x9213a8[_0x6f6686(0x2c5)]((_0x54c860,_0x33c0bb)=>{_0x546fda[_0x33c0bb]['batch_code']=_0x54c860;}),_0x4a41c1[_0x6f6686(0x2c5)]((_0x1ccc6d,_0xc4a4c3)=>{var _0xe7620c=_0x6f6686;_0x546fda[_0xc4a4c3][_0xe7620c(0x225)]=_0x1ccc6d;}),_0x19cfea[_0x6f6686(0x2c5)]((_0x352f77,_0x4c09ee)=>{var _0x5aa356=_0x6f6686;_0x546fda[_0x4c09ee][_0x5aa356(0x2ad)]=_0x352f77;}),_0x3040e0[_0x6f6686(0x2c5)]((_0x56245e,_0x4dd3d4)=>{var _0xadf721=_0x6f6686;_0x546fda[_0x4dd3d4][_0xadf721(0x215)]=_0x56245e;}),_0xb1a302['forEach']((_0x20860e,_0x298629)=>{var _0x82d426=_0x6f6686;_0x546fda[_0x298629][_0x82d426(0x306)]=_0x20860e;}),_0x21c9a8[_0x6f6686(0x2c5)]((_0x3df806,_0x33f32a)=>{var _0x2ff328=_0x6f6686;_0x546fda[_0x33f32a][_0x2ff328(0x2bb)]=_0x3df806;}),_0x57921c['forEach']((_0x4c8618,_0x2d4715)=>{var _0x4f29f3=_0x6f6686;_0x546fda[_0x2d4715][_0x4f29f3(0x2cb)]=_0x4c8618,_0x546fda[_0x2d4715][_0x4f29f3(0x293)]=_0x32cba9;});const _0x31c612=new sales_logs();await _0x31c612['save'](),_0x57921c['forEach']((_0x41c770,_0x572453)=>{var _0x2f4f17=_0x6f6686;_0x546fda[_0x572453][_0x2f4f17(0x300)]='LOG-OUT-'+_0x31c612[_0x2f4f17(0x284)][_0x2f4f17(0x28e)]()[_0x2f4f17(0x1fe)](0x8,'0');});var _0x426a68=0x0;_0x546fda[_0x6f6686(0x2c5)](_0x1a11ca=>{var _0x2d2ebb=_0x6f6686;parseFloat(_0x1a11ca[_0x2d2ebb(0x21b)])<parseFloat(_0x1a11ca[_0x2d2ebb(0x2fb)])&&parseFloat(_0x1a11ca[_0x2d2ebb(0x2fb)])>parseFloat(_0x1a11ca[_0x2d2ebb(0x21b)])&&(console[_0x2d2ebb(0x27a)](_0x1a11ca[_0x2d2ebb(0x21b)]+_0x2d2ebb(0x20f)+_0x1a11ca['quantity']),_0x426a68++);});if(_0x426a68!=0x0)return _0x341c2d['flash'](_0x6f6686(0x210),_0x6f6686(0x1e6)),_0x13e43a['redirect'](_0x6f6686(0x323));const _0x4f6aca=_0x546fda[_0x6f6686(0x2ac)](_0x4e44b7=>_0x4e44b7[_0x6f6686(0x2fb)]!=='0'&&_0x4e44b7[_0x6f6686(0x2fb)]!==''),_0x4d9316=new sales_finished({'invoice':_0x6f6686(0x289)+_0x31c612[_0x6f6686(0x284)][_0x6f6686(0x28e)]()[_0x6f6686(0x1fe)](0x8,'0'),'sales_data':_0x341c2d[_0x6f6686(0x1f3)][_0x6f6686(0x263)],'customer':_0x341c2d['body'][_0x6f6686(0x24b)],'date':_0x32cba9,'warehouse_name':_0x4e2834,'sale_product':_0x4f6aca,'note':_0xe3fe95,'room':_0x2770d5,'primary_code':_0x468ac6,'secondary_code':_0x3629c1,'prod_code':_0x175828,'SCRN':_0x19f7e8,'finalize':_0x6f6686(0x27f),'mode_transpo':_0x490a4c,'name_driver':_0x1c361b,'ReqBy':_0x483091,'dateofreq':_0x3f2816,'PO_number':_0x564b62,'typeservicesData':_0x2046ea,'typevehicle':_0x2fbcb4,'destination':_0x544700,'deliverydate':_0x4cf301,'driver':_0x241c9c,'plate':_0x38048b,'van':_0x40246d,'DRSI':_0x3d6e7b,'TSU':_0x5e9f70,'TFU':_0x22acfb,'typeOfProducts':_0x546614}),_0x199c2e=await _0x4d9316[_0x6f6686(0x315)](),_0x2e6aa1=await sales_finished[_0x6f6686(0x1ee)]({'invoice':_0x70fd49});_0x341c2d[_0x6f6686(0x240)]('success',_0x6f6686(0x1e3)),_0x13e43a[_0x6f6686(0x2a0)]('/all_sales_finished/preview/'+_0x199c2e[_0x6f6686(0x200)]);}catch(_0xbb092f){console['log'](_0xbb092f);}}),router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x2c6),auth,async(_0x9623bc,_0x2476a7)=>{var _0x3707ad=a0_0x1032ba;try{const _0x392ae7=_0x9623bc[_0x3707ad(0x2dc)]['id'];console[_0x3707ad(0x27a)](_0x392ae7);const _0xf8c4cf=await product[_0x3707ad(0x2f2)](),_0x3064cf=await purchases['aggregate']([{'$match':{'warehouse_name':_0x392ae7}},{'$unwind':_0x3707ad(0x1ed)},{'$group':{'_id':'$product.product_name'}}]);console[_0x3707ad(0x27a)](_0x3707ad(0x24d),_0x3064cf),_0x2476a7[_0x3707ad(0x21e)](0xc8)['json']({'purchases_data':_0x3064cf,'product_data':_0xf8c4cf});}catch(_0x32c781){console[_0x3707ad(0x27a)](_0x32c781);}}),router[a0_0x1032ba(0x21c)](a0_0x1032ba(0x264),auth,async(_0x478d42,_0x2a8f3c)=>{var _0x500704=a0_0x1032ba;try{const {warehouse_data:_0xfe4d19,product_data:_0x1227bb}=_0x478d42['body'];console[_0x500704(0x27a)](_0x478d42[_0x500704(0x1f3)]['product_data']);;const _0x37c7e5=await master_shop[_0x500704(0x2f2)]();console['log'](_0x500704(0x2ee),_0x37c7e5);const _0x4580df=await product['findOne']({'name':_0x1227bb});console[_0x500704(0x27a)](_0x500704(0x26a),_0x4580df);const _0x5da434=await warehouse[_0x500704(0x2cf)]([{'$match':{'name':_0xfe4d19}},{'$unwind':_0x500704(0x2f1)},{'$match':{'product_details.product_name':_0x1227bb}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x500704(0x2f4)}}}]);console[_0x500704(0x27a)](_0x500704(0x322),_0x5da434),_0x2a8f3c['status'](0xc8)[_0x500704(0x2f8)]({'master':_0x37c7e5,'new_product':_0x4580df,'stock_data':_0x5da434});}catch(_0x3238da){console[_0x500704(0x27a)](_0x3238da);}}),router['post']('/view/add_sales',auth,async(_0x8e7ee8,_0xe00747)=>{var _0x2ad4cb=a0_0x1032ba;try{const {invoice:_0xd5de55,date:_0x2e2179,warehouse_name:_0x50ae57,product_name:_0x1f095b,note:_0x4b735f,room:_0x2a00f9,primary_code:_0x443b7c,secondary_code:_0x487062,prod_code:_0x161358,SCRN:_0x3d4207,ReqBy:_0x25ef81,dateofreq:_0xddb656,PO_number:_0x5b815e,typeservicesData:_0x5979ad,typevehicle:_0x3703d6,destination:_0x28c658,deliverydate:_0xbc7d0f,driver:_0x23215c,plate:_0x209f47,van:_0x48edfb,DRSI:_0x5f275f,TSU:_0x5848a8,TFU:_0x252dc0,mode_transpo:_0x4bb5c0,name_driver:_0xbd6273,pull_out_date:_0x4c87f6,actual_delivery_date:_0x10605e}=_0x8e7ee8[_0x2ad4cb(0x1f3)];_0xe00747[_0x2ad4cb(0x2f8)](_0x8e7ee8[_0x2ad4cb(0x1f3)]);return;if(typeof _0x1f095b=='string')var _0x284c9c=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x320)]],_0x130231=[_0x8e7ee8['body']['stock']],_0x114998=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x202)]],_0x1c84ee=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x243)]],_0x55a0f8=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x296)]],_0x6f61ef=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x302)]],_0x58506a=[_0x8e7ee8[_0x2ad4cb(0x1f3)]['level2']],_0x29fda1=[_0x8e7ee8[_0x2ad4cb(0x1f3)]['primary_unit']],_0x50c143=[_0x8e7ee8['body'][_0x2ad4cb(0x1f5)]],_0x4e4190=[_0x8e7ee8['body'][_0x2ad4cb(0x1e7)]],_0x3088e1=[_0x8e7ee8[_0x2ad4cb(0x1f3)]['expiry_date']],_0x37b4ae=[_0x8e7ee8['body'][_0x2ad4cb(0x275)]],_0x309ce5=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x23d)]],_0x2513f4=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x306)]],_0x47a0c6=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x2ce)]],_0x478b70=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x1f6)]],_0x3d44c0=[_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x305)]],_0x1b0075=[_0x8e7ee8['body'][_0x2ad4cb(0x317)]],_0x56d54d=[_0x8e7ee8['body'][_0x2ad4cb(0x30c)]];else var _0x284c9c=[..._0x8e7ee8['body'][_0x2ad4cb(0x320)]],_0x130231=[..._0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x21b)]],_0x114998=[..._0x8e7ee8['body'][_0x2ad4cb(0x202)]],_0x1c84ee=[..._0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x243)]],_0x55a0f8=[..._0x8e7ee8['body'][_0x2ad4cb(0x296)]],_0x6f61ef=[..._0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x302)]],_0x58506a=[..._0x8e7ee8[_0x2ad4cb(0x1f3)]['level2']],_0x29fda1=[..._0x8e7ee8[_0x2ad4cb(0x1f3)]['primary_unit']],_0x50c143=[..._0x8e7ee8['body'][_0x2ad4cb(0x1f5)]],_0x4e4190=[..._0x8e7ee8['body'][_0x2ad4cb(0x1e7)]],_0x3088e1=[..._0x8e7ee8['body']['expiry_date']],_0x37b4ae=[..._0x8e7ee8['body'][_0x2ad4cb(0x275)]],_0x309ce5=[..._0x8e7ee8['body'][_0x2ad4cb(0x23d)]],_0x2513f4=[..._0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x306)]],_0x47a0c6=[..._0x8e7ee8[_0x2ad4cb(0x1f3)]['RoomAssigned']],_0x478b70=[..._0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x1f6)]],_0x3d44c0=[..._0x8e7ee8['body']['id_transaction_from']],_0x1b0075=[..._0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x317)]],_0x56d54d=[..._0x8e7ee8[_0x2ad4cb(0x1f3)]['gross_price']];const _0x5dee2a=_0x284c9c['map'](_0x55223f=>{return _0x55223f={'product_name':_0x55223f};});_0x130231['forEach']((_0x55302a,_0x52a35f)=>{_0x5dee2a[_0x52a35f]['stock']=_0x55302a;}),_0x114998[_0x2ad4cb(0x2c5)]((_0x55210e,_0x3fd853)=>{var _0x557d2f=_0x2ad4cb;_0x5dee2a[_0x3fd853][_0x557d2f(0x2fb)]=Math[_0x557d2f(0x230)](_0x55210e);}),_0x284c9c[_0x2ad4cb(0x2c5)]((_0x279663,_0xa47b00)=>{var _0xa98979=_0x2ad4cb;_0x5dee2a[_0xa47b00][_0xa98979(0x29e)]=_0x8e7ee8[_0xa98979(0x1f3)][_0xa98979(0x263)];}),_0x56d54d[_0x2ad4cb(0x2c5)]((_0x5ebcbf,_0xe5a41e)=>{var _0x25362c=_0x2ad4cb;_0x5dee2a[_0xe5a41e][_0x25362c(0x30c)]=_0x5ebcbf;}),_0x1b0075['forEach']((_0x3c3b1b,_0x4a0c7a)=>{_0x5dee2a[_0x4a0c7a]['uuid']=_0x3c3b1b;}),_0x3d44c0[_0x2ad4cb(0x2c5)]((_0x425c51,_0x3605ce)=>{var _0x5b5d5d=_0x2ad4cb;_0x5dee2a[_0x3605ce][_0x5b5d5d(0x305)]=_0x425c51;}),_0x1c84ee[_0x2ad4cb(0x2c5)]((_0xb17a22,_0x5e74cb)=>{_0x5dee2a[_0x5e74cb]['primary_code']=_0xb17a22;}),_0x55a0f8['forEach']((_0x22412b,_0x6d621e)=>{var _0x4942c5=_0x2ad4cb;_0x5dee2a[_0x6d621e][_0x4942c5(0x296)]=_0x22412b;}),_0x6f61ef[_0x2ad4cb(0x2c5)]((_0x4b0ec4,_0x1f33bc)=>{var _0x28e73a=_0x2ad4cb;_0x5dee2a[_0x1f33bc][_0x28e73a(0x20e)]=_0x4b0ec4;}),_0x58506a[_0x2ad4cb(0x2c5)]((_0x485728,_0x361252)=>{var _0x24312e=_0x2ad4cb,_0x57f15b=_0x485728[_0x24312e(0x27c)](/[A-Za-z]+/)[0x0],_0x181215=parseInt(_0x485728['match'](/\d+/)[0x0]);_0x5dee2a[_0x361252][_0x24312e(0x222)]=_0x181215,_0x5dee2a[_0x361252]['level']=_0x57f15b;}),_0x29fda1['forEach']((_0xc2a0b5,_0x522d9a)=>{_0x5dee2a[_0x522d9a]['unit']=_0xc2a0b5;}),_0x50c143[_0x2ad4cb(0x2c5)]((_0x4cab61,_0x50fae4)=>{var _0x18333b=_0x2ad4cb;_0x5dee2a[_0x50fae4][_0x18333b(0x1f5)]=_0x4cab61;}),_0x4e4190[_0x2ad4cb(0x2c5)]((_0x15ee3d,_0x547beb)=>{var _0x1122a9=_0x2ad4cb;_0x5dee2a[_0x547beb][_0x1122a9(0x1e7)]=_0x15ee3d;}),_0x3088e1[_0x2ad4cb(0x2c5)]((_0x27729a,_0xb144c4)=>{_0x5dee2a[_0xb144c4]['expiry_date']=_0x27729a;}),_0x37b4ae[_0x2ad4cb(0x2c5)]((_0x406924,_0x34c470)=>{var _0x1bd0bf=_0x2ad4cb;_0x5dee2a[_0x34c470][_0x1bd0bf(0x2ad)]=_0x406924;}),_0x309ce5['forEach']((_0x575f4b,_0x308444)=>{var _0x49e4b8=_0x2ad4cb;_0x5dee2a[_0x308444][_0x49e4b8(0x215)]=_0x575f4b;}),_0x2513f4[_0x2ad4cb(0x2c5)]((_0x1c6318,_0x58d756)=>{_0x5dee2a[_0x58d756]['prod_cat']=_0x1c6318;}),_0x47a0c6[_0x2ad4cb(0x2c5)]((_0x44794d,_0x341014)=>{_0x5dee2a[_0x341014]['room_name']=_0x44794d;}),_0x478b70[_0x2ad4cb(0x2c5)]((_0x33fe37,_0x26647a)=>{var _0x42de97=_0x2ad4cb;_0x5dee2a[_0x26647a][_0x42de97(0x2cb)]=_0x33fe37,_0x5dee2a[_0x26647a][_0x42de97(0x293)]=_0x2e2179;});const _0x16c4c9=new invoice_for_outgoing();await _0x16c4c9[_0x2ad4cb(0x315)](),_0x478b70[_0x2ad4cb(0x2c5)]((_0x48a393,_0x246557)=>{var _0x3a5158=_0x2ad4cb;_0x5dee2a[_0x246557][_0x3a5158(0x300)]=_0x3a5158(0x236)+_0x16c4c9[_0x3a5158(0x284)][_0x3a5158(0x28e)]()['padStart'](0x8,'0');});var _0x1c8985=0x0;_0x5dee2a[_0x2ad4cb(0x2c5)](_0x5cbfc8=>{var _0x3a31be=_0x2ad4cb;parseFloat(_0x5cbfc8[_0x3a31be(0x21b)])<parseFloat(_0x5cbfc8['quantity'])&&parseFloat(_0x5cbfc8[_0x3a31be(0x2fb)])>parseFloat(_0x5cbfc8[_0x3a31be(0x21b)])&&(console[_0x3a31be(0x27a)](_0x5cbfc8[_0x3a31be(0x21b)]+'\x20<>\x20'+_0x5cbfc8[_0x3a31be(0x2fb)]),_0x1c8985++);});if(_0x1c8985!=0x0)return _0x8e7ee8['flash'](_0x2ad4cb(0x210),_0x2ad4cb(0x1e6)),_0xe00747['redirect'](_0x2ad4cb(0x323));const _0x20013f=_0x5dee2a[_0x2ad4cb(0x2ac)](_0x492f97=>_0x492f97[_0x2ad4cb(0x2fb)]!=='0'&&_0x492f97[_0x2ad4cb(0x2fb)]!==''),_0x2575f8=new sales_finished({'invoice':_0x2ad4cb(0x236)+_0x16c4c9[_0x2ad4cb(0x284)][_0x2ad4cb(0x28e)]()[_0x2ad4cb(0x1fe)](0x8,'0'),'sales_data':_0x8e7ee8['body'][_0x2ad4cb(0x263)],'customer':_0x8e7ee8[_0x2ad4cb(0x1f3)][_0x2ad4cb(0x24b)],'date':_0x2e2179,'warehouse_name':_0x50ae57,'sale_product':_0x20013f,'note':_0x4b735f,'room':_0x2a00f9,'primary_code':_0x443b7c,'secondary_code':_0x487062,'prod_code':_0x161358,'SCRN':_0x3d4207,'finalize':_0x2ad4cb(0x27f),'mode_transpo':_0x4bb5c0,'name_driver':_0xbd6273,'ReqBy':_0x25ef81,'dateofreq':_0xddb656,'PO_number':_0x5b815e,'typeservicesData':_0x5979ad,'typevehicle':_0x3703d6,'destination':_0x28c658,'deliverydate':_0xbc7d0f,'driver':_0x23215c,'plate':_0x209f47,'van':_0x48edfb,'DRSI':_0x5f275f,'TSU':_0x5848a8,'TFU':_0x252dc0,'pullout_date':_0x4c87f6,'actualdelivery_date':_0x10605e,'typeOfProducts':_0x2ad4cb(0x2d1)}),_0x3c5e80=await _0x2575f8[_0x2ad4cb(0x315)](),_0x3de684=await sales_finished[_0x2ad4cb(0x1ee)]({'invoice':_0xd5de55});_0x8e7ee8['flash']('success',_0x2ad4cb(0x1e3)),_0xe00747[_0x2ad4cb(0x2a0)](_0x2ad4cb(0x2d0)+_0x3c5e80[_0x2ad4cb(0x200)]);}catch(_0x3dc812){console[_0x2ad4cb(0x27a)](_0x3dc812);}}),router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x2a8),auth,async(_0x587b11,_0x1ece55)=>{var _0x57edd4=a0_0x1032ba;try{const {username:_0x119c29,email:_0x4126de,role:_0x2e9b82}=_0x587b11[_0x57edd4(0x2bf)],_0x928007=_0x587b11[_0x57edd4(0x2bf)],_0x299cf1=await profile[_0x57edd4(0x1ee)]({'email':_0x928007['email']}),_0x1f63bf=await master_shop[_0x57edd4(0x2f2)](),_0x1e03c2=_0x587b11['params']['id'],_0x222623=await sales_finished[_0x57edd4(0x316)](_0x1e03c2),_0x44b48d=await warehouse['aggregate']([{'$match':{'name':_0x222623[_0x57edd4(0x31e)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x57edd4(0x22e),'name':{'$first':_0x57edd4(0x244)},'product_stock':{'$first':_0x57edd4(0x2f4)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x57edd4(0x214)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x57edd4(0x227)},'secondary_code':{'$first':_0x57edd4(0x2e7)},'product_code':{'$first':_0x57edd4(0x2fd)},'storage':{'$first':_0x57edd4(0x2c0)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x57edd4(0x2af)},'production_date':{'$first':_0x57edd4(0x2df)},'batch_code':{'$first':_0x57edd4(0x294)},'room':{'$first':_0x57edd4(0x287)},'room_data':{'$first':'$product_details.room_name'}}}]),_0xbda6df=await customer[_0x57edd4(0x2f2)]({});let _0x32bf8b;if(_0x928007[_0x57edd4(0x204)]=='staff'){const _0x192af4=await staff[_0x57edd4(0x1ee)]({'email':_0x928007[_0x57edd4(0x313)]});_0x32bf8b=await warehouse[_0x57edd4(0x2cf)]([{'$match':{'status':_0x57edd4(0x2c7),'name':_0x192af4[_0x57edd4(0x2f5)]}},{'$group':{'_id':_0x57edd4(0x1f8),'name':{'$first':_0x57edd4(0x1f8)}}}]);}else _0x32bf8b=await warehouse[_0x57edd4(0x2cf)]([{'$match':{'status':_0x57edd4(0x2c7)}},{'$group':{'_id':_0x57edd4(0x1f8),'name':{'$first':_0x57edd4(0x1f8)}}}]);const _0x14afe9=await product[_0x57edd4(0x2f2)]({});if(_0x1f63bf[0x0][_0x57edd4(0x238)]==_0x57edd4(0x310)){var _0x4d1ba7=users[_0x57edd4(0x2ff)];console[_0x57edd4(0x27a)](_0x4d1ba7);}else{if(_0x1f63bf[0x0][_0x57edd4(0x238)]==_0x57edd4(0x268))var _0x4d1ba7=users[_0x57edd4(0x268)];else{if(_0x1f63bf[0x0][_0x57edd4(0x238)]==_0x57edd4(0x28c))var _0x4d1ba7=users[_0x57edd4(0x28c)];else{if(_0x1f63bf[0x0]['language']==_0x57edd4(0x250))var _0x4d1ba7=users[_0x57edd4(0x250)];else{if(_0x1f63bf[0x0][_0x57edd4(0x238)]==_0x57edd4(0x30e))var _0x4d1ba7=users[_0x57edd4(0x30e)];else{if(_0x1f63bf[0x0][_0x57edd4(0x238)]=='Portuguese\x20(BR)')var _0x4d1ba7=users['Portuguese'];else{if(_0x1f63bf[0x0]['language']==_0x57edd4(0x239))var _0x4d1ba7=users[_0x57edd4(0x239)];else{if(_0x1f63bf[0x0][_0x57edd4(0x238)]==_0x57edd4(0x321))var _0x4d1ba7=users['Arabic'];}}}}}}}_0x1ece55[_0x57edd4(0x23c)]('edit_sales_finished_view',{'success':_0x587b11[_0x57edd4(0x240)](_0x57edd4(0x23f)),'errors':_0x587b11[_0x57edd4(0x240)](_0x57edd4(0x210)),'role':_0x928007,'profile':_0x299cf1,'customer':_0xbda6df,'warehouse':_0x32bf8b,'product':_0x44b48d,'user':_0x222623,'master_shop':_0x1f63bf,'unit':_0x14afe9,'language':_0x4d1ba7});}catch(_0x5ad8ed){console['log'](_0x5ad8ed);}});function a0_0x5669(){var _0xf1e437=['return_sale','body','/barcode_scanner_logs','secondary_unit','prod_invoice','98xXyGCv','$name','<h2>\x20','$product_details.maxPerUnit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$warehouse_name','logo','padStart','$sales_category','_id','$product_details.unit','carton','name','role','</table>','Return\x20Goods','amount','$product_details.date_recieved','Router','map','second_unit','sales_id','Portuguese','product_code','\x20<>\x20','errors','$secondary_code','Types','Ambient','$product_details.type','maxperunit','return_qty_QA','Distributing\x20','primary_code_QA','payment\x20successfull','Sale\x20Return','stock','post','$date','status','$sale_product.quantity','$primary_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','bay','$category','product_code_QA','expiry_date','unit','$product_details.primary_code','\x20Order\x20Date\x20:\x20','production_date_QA','/all_sales/view','Sales\x20Update\x20successfully','split','7540038rLzCFX','$product_details._id','1057zSMlJq','abs','/picking_list/pdf/','</td>','$product_details.bin','$product_details.product_cat','/process/view','OUT-','final','language','Chinese','$unit','gmail','render','max_per_unit','$customer','success','flash','all','for_categorize','primary_code','$product_details.product_name','createTransport','length','maxPerUnit_QA','</tr>','ObjectId','maxProdPerUnit','customer','<hr\x20class=\x22my-3\x22>','purchases_data','$sale_product','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Spanish','product_id','getMonth','false','/view/add_sales_logs','maxProducts','$product_details.invoice','<tbody\x20style=\x22text-align:\x20center;\x22>','Logo.png','foreach\x20newproduct','$return_data','warehouse_id_detl','<tr>','room','/view/return_sales/:id','$product_details.floorlevel','undefined','out','staff','sales','/view/add_sale/product','</tbody>','message','<div>','Hindi','\x20Order\x20Number\x20:\x20','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','Quality\x20Inspection','date','$secondary_unit','/upload/','$customers_docs','sale_qty','mongoose','Return\x20Rooms','warehouse_id','product_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','1066kkgFsO','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','5302sfVLoy','log','$product_details.bay','match','get','/../public','False','/barcode/:id','add_sales_finished_logs','nodemailer','$sale_product.bin','invoice_init','suppliers','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$room','/view/:id','LOG-OUT-','maxProducts_QA','/view_log','German','4420890JzZxRD','toString','product_name_QA1','../models/all_models','$product_code','return_qty','date_data','$product_details.batch_code','sales_category','secondary_code','expiry_date_QA','concat','return_data','</h5>','logs','</body></html>','Enclosed','agent_id','due_amount','redirect','level2','$maxProdPerUnit','OUTF-','return_sale_QA','Received\x20Payment\x20For\x20Sale','stocks_QA','\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20','/preview/:id','add_sales_finished','</head><body>','all_sales_finished','filter','production_date','<!DOCTYPE\x20html>','$product_details.expiry_date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','date_recieved','/barcode_scanner_auto','image','$sale_product.bay','max','Portuguese\x20(BR)','</span>','$brand','Sale\x20Return\x20Mail','adjust_qty','room_name','<h5\x20style=\x22text-align:\x20left;\x22>','currency_placement','$invoice','user','$product_details.storage','</div>','Email\x20sent\x20successfully','$note','<strong>\x20Regards\x20</strong>','forEach','/view/add_sales/:id','Enabled','$sale_product.type','</thead>','product_cat','invoice','true','batch_code_QA','RoomAssigned','aggregate','/all_sales_finished/preview/','own','product_details','product_stock','updateOne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','min','$product_details.gross_price','Finished\x20Goods','1899225BNybpr','sales_invoice','\x20Date:\x20','params','secondary_unit_QA','sale_product','$product_details.production_date','then','/view/add_sales','$product_details.uuid','string','$product_details.secondary_unit','\x20</h2>','$product_details.sales_category','$product_details.secondary_code','\x20Name:\x20','random','valueOf','../public/language/languages.json','currency','catch','master','push','$gross_price','$product_details','find','$sale_product.floorlevel','$product_details.product_stock','warehouse','$_id','/invoice/:id','json','maxPerUnit',',\x20Location:\x20','quantity','$maxStocks','$product_details.product_code','level','English','outgoing_invoice','True','prod_code','group_ids','product_list','id_transaction_from','prod_cat','slice','<table\x20style=\x22width:\x20100%\x20!important;\x22>','\x20==\x20','There\x27s\x20a\x20error\x20in\x20this\x20transaction','323744wjiFfk','gross_price','$product_details.rack','French','sales_quantity_QA','English\x20(US)','barcode\x20Product\x20master','48695hcjnqe','email','sendMail','save','findById','uuid','$product_details.level','$finalize','$alertquantity','sales_quantity','$product_details.type_products','primary_unit','warehouse_name','outgoiug_inv','product_name','Arabic\x20(ae)','stock_data','back','/barcode_scanner',',\x20room:\x20','20ngDZHo','/view','/all_sales_finished/view','Sales\x20Add\x20successfully','date_received','note','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','batch_code','maxStocks','sales\x20item\x20return\x20successfull','../middleware/auth','return_sale_finished','site_title','$product','findOne','20040LlOzzi','Arabic','all_sales_finished_logs'];a0_0x5669=function(){return _0xf1e437;};return a0_0x5669();}async function dataUpdate(_0x4444de,_0x2ac9c3,_0xb0bbe8){var _0x15bc38=a0_0x1032ba;return await warehouse[_0x15bc38(0x2d4)]({'_id':_0x4444de,'product_details._id':_0x2ac9c3},{'$set':{'product_details.$.product_stock':_0xb0bbe8}}),await warehouse[_0x15bc38(0x316)](_0x4444de);}router[a0_0x1032ba(0x21c)](a0_0x1032ba(0x2a8),auth,async(_0x13219f,_0x5105cf)=>{var _0xe5a20b=a0_0x1032ba;try{const _0x3655fb=_0x13219f['params']['id'],{invoice:_0x306b4b,warehouse_name:_0x254d9a,room:_0x116859}=_0x13219f[_0xe5a20b(0x1f3)],_0x30c4bd=await sales_finished[_0xe5a20b(0x1ee)]({'invoice':_0x306b4b});for(let _0x3b7314=0x0;_0x3b7314<=_0x30c4bd[_0xe5a20b(0x2de)][_0xe5a20b(0x246)]-0x1;_0x3b7314++){const _0x5e231d=_0x30c4bd[_0xe5a20b(0x2de)][_0x3b7314];var _0x1daeaf=await warehouse[_0xe5a20b(0x1ee)]({'name':_0x254d9a,'room':_0x5e231d['room_name']}),_0x27c7a5=0x0;for(let _0x2660a6=0x0;_0x2660a6<=_0x1daeaf[_0xe5a20b(0x2d2)][_0xe5a20b(0x246)]-0x1;_0x2660a6++){const _0x4d5bb3=_0x1daeaf[_0xe5a20b(0x2d2)][_0x2660a6];_0x4d5bb3[_0xe5a20b(0x200)]==_0x5e231d[_0xe5a20b(0x305)]&&_0x4d5bb3[_0xe5a20b(0x317)]==_0x5e231d['uuid']&&(_0x27c7a5=Math[_0xe5a20b(0x2b5)](0x0,Math[_0xe5a20b(0x230)](_0x4d5bb3[_0xe5a20b(0x2d3)])-Math[_0xe5a20b(0x230)](_0x5e231d['quantity'])),await warehouse['updateOne']({'_id':_0x1daeaf['_id'][_0xe5a20b(0x2ea)](),'product_details._id':_0x4d5bb3[_0xe5a20b(0x200)][_0xe5a20b(0x2ea)](),'product_details.uuid':_0x5e231d[_0xe5a20b(0x317)]},{'$set':{'product_details.$.product_stock':_0x27c7a5}}));}console[_0xe5a20b(0x27a)](typeof _0x5e231d['agent_id']);if(typeof _0x5e231d['agent_id']!==_0xe5a20b(0x260)){var _0x3b2f9b=await staff['findById'](_0x5e231d[_0xe5a20b(0x29e)]);console[_0xe5a20b(0x27a)]('here');var _0x40c70b=0x0;for(let _0x1d5bc7=0x0;_0x1d5bc7<=_0x3b2f9b[_0xe5a20b(0x304)][_0xe5a20b(0x246)]-0x1;_0x1d5bc7++){const _0x1f50e5=_0x3b2f9b['product_list'][_0x1d5bc7];console[_0xe5a20b(0x27a)](_0x5e231d[_0xe5a20b(0x305)]+_0xe5a20b(0x309)+_0x1f50e5['warehouse_id']+'\x20&&\x20'+_0x5e231d['_id']+_0xe5a20b(0x309)+_0x5e231d['_id']),_0x5e231d[_0xe5a20b(0x305)]==_0x1f50e5[_0xe5a20b(0x274)]&&_0x5e231d[_0xe5a20b(0x200)]==0x1&&(_0x1f50e5['product_stock']=Math[_0xe5a20b(0x230)](_0x1f50e5[_0xe5a20b(0x2d3)])+Math[_0xe5a20b(0x230)](_0x5e231d[_0xe5a20b(0x2fb)]),_0x40c70b++);}console[_0xe5a20b(0x27a)]('int',_0x40c70b),_0x40c70b=='0'&&(_0x3b2f9b[_0xe5a20b(0x304)]=_0x3b2f9b[_0xe5a20b(0x304)][_0xe5a20b(0x298)]({'product_name':_0x5e231d[_0xe5a20b(0x320)],'product_stock':_0x5e231d[_0xe5a20b(0x2fb)],'bay':_0x5e231d['bay'],'level':_0x5e231d[_0xe5a20b(0x2fe)],'product_code':_0x5e231d[_0xe5a20b(0x20e)],'primary_code':_0x5e231d[_0xe5a20b(0x243)],'secondary_code':_0x5e231d[_0xe5a20b(0x296)],'expiry_date':_0x5e231d[_0xe5a20b(0x225)],'production_date':_0x5e231d['production_date'],'maxProducts':_0x5e231d['maxProducts'],'batch_code':_0x5e231d['batch_code'],'secondary_unit':_0x5e231d['secondary_unit'],'unit':_0x5e231d[_0xe5a20b(0x226)],'maxProducts':_0x5e231d[_0xe5a20b(0x255)],'maxPerUnit':_0x5e231d[_0xe5a20b(0x215)],'invoice':_0x5e231d[_0xe5a20b(0x2cb)],'warehouse_id':_0x5e231d[_0xe5a20b(0x305)],'id_incoming':_0x5e231d[_0xe5a20b(0x200)],'uuid':_0x5e231d['uuid'],'gross_price':_0x5e231d[_0xe5a20b(0x30c)],'date_incoming':_0x5e231d[_0xe5a20b(0x293)],'outgoing_invoice':_0x5e231d[_0xe5a20b(0x300)]}),await _0x3b2f9b[_0xe5a20b(0x315)]());}}_0x30c4bd['finalize']=_0xe5a20b(0x301);const _0x2c34cc=await _0x30c4bd[_0xe5a20b(0x315)](),_0x11c33d=await master_shop[_0xe5a20b(0x2f2)](),_0x4ee360=await email_settings[_0xe5a20b(0x1ee)](),_0x34ef99=await supervisor_settings[_0xe5a20b(0x2f2)]();var _0x38dcfb=_0x30c4bd['sale_product'],_0x2cf079='',_0xfff5a9;for(_0xfff5a9 in _0x38dcfb){_0x2cf079+=_0xe5a20b(0x25c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x38dcfb[_0xfff5a9][_0xe5a20b(0x320)]+_0xe5a20b(0x232)+_0xe5a20b(0x286)+_0x38dcfb[_0xfff5a9][_0xe5a20b(0x20e)]+'</td>'+_0xe5a20b(0x286)+_0x38dcfb[_0xfff5a9][_0xe5a20b(0x2fb)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x38dcfb[_0xfff5a9][_0xe5a20b(0x226)]+_0xe5a20b(0x232)+_0xe5a20b(0x286)+_0x38dcfb[_0xfff5a9][_0xe5a20b(0x1f5)]+_0xe5a20b(0x232)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x30c4bd[_0xe5a20b(0x31e)]+_0xe5a20b(0x232)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x38dcfb[_0xfff5a9]['room_name']+'</td>'+_0xe5a20b(0x286)+_0x38dcfb[_0xfff5a9][_0xe5a20b(0x222)]+_0xe5a20b(0x232);}_0x13219f[_0xe5a20b(0x240)](_0xe5a20b(0x23f),_0xe5a20b(0x22b)),_0x5105cf[_0xe5a20b(0x2a0)](_0xe5a20b(0x231)+_0x3655fb);}catch(_0x146aca){console[_0xe5a20b(0x27a)](_0x146aca);}}),router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x288),auth,async(_0x2d90af,_0x393477)=>{var _0x938862=a0_0x1032ba;try{const {username:_0x15f0f1,email:_0x13d857,role:_0x231db4}=_0x2d90af[_0x938862(0x2bf)],_0x136f42=_0x2d90af[_0x938862(0x2bf)],_0x51f4a4=await profile[_0x938862(0x1ee)]({'email':_0x136f42[_0x938862(0x313)]}),_0x33800b=await master_shop['find'](),_0x1da3ba=_0x2d90af[_0x938862(0x2dc)]['id'],_0xd242c3=await sales_finished[_0x938862(0x316)](_0x1da3ba);let _0x25eaba=new Date(_0xd242c3[_0x938862(0x225)]),_0x44a4ab=('0'+_0x25eaba['getDate']())[_0x938862(0x307)](-0x2),_0x856aba=('0'+(_0x25eaba[_0x938862(0x252)]()+0x1))[_0x938862(0x307)](-0x2),_0x369e13=_0x25eaba['getFullYear'](),_0x47d5f9=_0x369e13+'-'+_0x856aba+'-'+_0x44a4ab;var _0x2f5566=[_0x938862(0x213),_0x938862(0x29d)];const _0x3823a8=await warehouse[_0x938862(0x2cf)]([{'$match':{'name':_0xd242c3['warehouse_name'],'room':_0xd242c3[_0x938862(0x25d)]}},{'$unwind':_0x938862(0x2f1)},{'$group':{'_id':_0x938862(0x22e),'name':{'$first':_0x938862(0x244)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x938862(0x233)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x938862(0x25f)},'primary_code':{'$first':_0x938862(0x227)},'secondary_code':{'$first':_0x938862(0x2e7)},'product_code':{'$first':_0x938862(0x2fd)},'storage':{'$first':_0x938862(0x2c0)},'rack':{'$first':_0x938862(0x30d)}}}]),_0x3250ec=await customer[_0x938862(0x2f2)]({});let _0x3542c1;if(_0x136f42['role']==_0x938862(0x262)){const _0x5902ed=await staff[_0x938862(0x1ee)]({'email':_0x136f42['email']});_0x3542c1=await warehouse[_0x938862(0x2cf)]([{'$match':{'status':'Enabled','name':_0x5902ed[_0x938862(0x2f5)]}},{'$group':{'_id':_0x938862(0x1f8),'name':{'$first':_0x938862(0x1f8)}}}]);}else _0x3542c1=await warehouse[_0x938862(0x2cf)]([{'$match':{'status':_0x938862(0x2c7)}},{'$group':{'_id':'$name','name':{'$first':_0x938862(0x1f8)}}}]);const _0x373e9d=await product['find']({});if(_0x33800b[0x0]['language']==_0x938862(0x310)){var _0x4eabd7=users[_0x938862(0x2ff)];console[_0x938862(0x27a)](_0x4eabd7);}else{if(_0x33800b[0x0][_0x938862(0x238)]==_0x938862(0x268))var _0x4eabd7=users[_0x938862(0x268)];else{if(_0x33800b[0x0][_0x938862(0x238)]==_0x938862(0x28c))var _0x4eabd7=users[_0x938862(0x28c)];else{if(_0x33800b[0x0][_0x938862(0x238)]==_0x938862(0x250))var _0x4eabd7=users[_0x938862(0x250)];else{if(_0x33800b[0x0][_0x938862(0x238)]==_0x938862(0x30e))var _0x4eabd7=users[_0x938862(0x30e)];else{if(_0x33800b[0x0][_0x938862(0x238)]==_0x938862(0x2b6))var _0x4eabd7=users['Portuguese'];else{if(_0x33800b[0x0][_0x938862(0x238)]==_0x938862(0x239))var _0x4eabd7=users['Chinese'];else{if(_0x33800b[0x0][_0x938862(0x238)]=='Arabic\x20(ae)')var _0x4eabd7=users['Arabic'];}}}}}}}_0x393477[_0x938862(0x23c)]('edit_sales_finished',{'success':_0x2d90af[_0x938862(0x240)](_0x938862(0x23f)),'errors':_0x2d90af[_0x938862(0x240)](_0x938862(0x210)),'role':_0x136f42,'profile':_0x51f4a4,'customer':_0x3250ec,'warehouse':_0x3542c1,'product':_0x3823a8,'user':_0xd242c3,'master_shop':_0x33800b,'unit':_0x373e9d,'language':_0x4eabd7,'rooms_data':_0x2f5566,'ed_fullDate':_0x47d5f9});}catch(_0xb8746d){console[_0x938862(0x27a)](_0xb8746d);}}),router[a0_0x1032ba(0x21c)](a0_0x1032ba(0x288),auth,async(_0x4cb2cb,_0x5992df)=>{var _0x170a86=a0_0x1032ba;try{const _0x13b483=_0x4cb2cb['params']['id'],_0x7dccb9=await sales_finished[_0x170a86(0x1ee)]({'_id':_0x4cb2cb['params']['id']}),_0x169060=await warehouse[_0x170a86(0x1ee)]({'name':_0x7dccb9[_0x170a86(0x31e)],'room':_0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x25d)],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x36b484,customer:_0x3edba1,date:_0x4f0d54,warehouse_name:_0x512e5e,product_name:_0x201360,stock:_0x5c7671,adjust_qty:_0x12d0f5,note:_0x3c5d24,room:_0x1957b1,primary_code:_0x16fe70,secondary_code:_0xf1421f,prod_code:_0xaacc8e,level:_0x431c04,isle:_0x856332,pallet:_0x754b69,expiry_date:_0x5c7cd1}=_0x4cb2cb[_0x170a86(0x1f3)];if(typeof _0x201360==_0x170a86(0x2e3))var _0x5a38ce=[_0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x320)]],_0x12419e=[_0x4cb2cb['body'][_0x170a86(0x21b)]],_0x50a5c0=[_0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x2ba)]],_0xb9eac4=[_0x4cb2cb['body'][_0x170a86(0x243)]],_0x32d27c=[_0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x296)]],_0xdf60c3=[_0x4cb2cb['body'][_0x170a86(0x302)]],_0x6a230b=[_0x4cb2cb['body'][_0x170a86(0x2fe)]],_0x359ee2=[_0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x225)]];else var _0x5a38ce=[..._0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x320)]],_0x12419e=[..._0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x21b)]],_0x50a5c0=[..._0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x2ba)]],_0xb9eac4=[..._0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x243)]],_0x32d27c=[..._0x4cb2cb[_0x170a86(0x1f3)]['secondary_code']],_0xdf60c3=[..._0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x302)]],_0x6a230b=[..._0x4cb2cb[_0x170a86(0x1f3)]['level']],_0x359ee2=[..._0x4cb2cb[_0x170a86(0x1f3)]['expiry_date']];const _0x2da04c=_0x5a38ce[_0x170a86(0x20a)](_0x411f52=>{return _0x411f52={'product_name':_0x411f52};});_0x12419e[_0x170a86(0x2c5)]((_0x432eef,_0x533a72)=>{var _0x4f7c97=_0x170a86;_0x2da04c[_0x533a72][_0x4f7c97(0x21b)]=_0x432eef;}),_0x50a5c0[_0x170a86(0x2c5)]((_0x1ee918,_0x271f41)=>{var _0x46e8dc=_0x170a86;_0x2da04c[_0x271f41][_0x46e8dc(0x2fb)]=_0x1ee918;}),_0xb9eac4[_0x170a86(0x2c5)]((_0x49fb92,_0xce46da)=>{_0x2da04c[_0xce46da]['primary_code']=_0x49fb92;}),_0x32d27c[_0x170a86(0x2c5)]((_0x3b0f4b,_0x32aa07)=>{var _0x5bbdd0=_0x170a86;_0x2da04c[_0x32aa07][_0x5bbdd0(0x296)]=_0x3b0f4b;}),_0xdf60c3[_0x170a86(0x2c5)]((_0x2a66ed,_0x1e4a4e)=>{_0x2da04c[_0x1e4a4e]['product_code']=_0x2a66ed;}),_0x6a230b[_0x170a86(0x2c5)]((_0x403bb1,_0x52c962)=>{var _0x13fdf6=_0x170a86;_0x2da04c[_0x52c962][_0x13fdf6(0x2fe)]=_0x403bb1;}),_0x359ee2[_0x170a86(0x2c5)]((_0x2964f2,_0x52c812)=>{_0x2da04c[_0x52c812]['expiry_date']=_0x2964f2;});var _0x4d2a1c=0x0;_0x2da04c[_0x170a86(0x2c5)](_0x232754=>{var _0x1d5dd0=_0x170a86;console['log'](_0x1d5dd0(0x259),_0x232754),(parseInt(_0x232754['stock'])<parseInt(_0x232754[_0x1d5dd0(0x2fb)])||parseInt(_0x232754[_0x1d5dd0(0x2fb)])==0x0)&&_0x4d2a1c++;});if(_0x4d2a1c!=0x0)return _0x4cb2cb[_0x170a86(0x240)](_0x170a86(0x210),_0x170a86(0x24f)),_0x5992df[_0x170a86(0x2a0)](_0x170a86(0x323));_0x7dccb9['sale_product'][_0x170a86(0x2c5)](_0x4258c2=>{var _0x46a6c1=_0x170a86;const _0x4456b8=_0x169060[_0x46a6c1(0x2d2)]['map'](_0x3fccb8=>{var _0x337b6b=_0x46a6c1;_0x3fccb8['product_name']==_0x4258c2[_0x337b6b(0x320)]&&_0x3fccb8['bay']==_0x4258c2[_0x337b6b(0x222)]&&(_0x3fccb8[_0x337b6b(0x2d3)]=parseInt(_0x3fccb8[_0x337b6b(0x2d3)])+parseInt(_0x4258c2[_0x337b6b(0x2fb)]));});}),await _0x169060['save']();const _0x21748c=_0x2da04c['filter'](_0x1b570b=>_0x1b570b[_0x170a86(0x2fb)]!=='0'&&_0x1b570b['quantity']!=='');_0x7dccb9[_0x170a86(0x2cb)]=_0x36b484,_0x7dccb9[_0x170a86(0x24b)]=_0x3edba1,_0x7dccb9[_0x170a86(0x26d)]=_0x4f0d54,_0x7dccb9['warehouse_name']=_0x512e5e,_0x7dccb9['sale_product']=_0x21748c,_0x7dccb9[_0x170a86(0x1e5)]=_0x3c5d24,_0x7dccb9[_0x170a86(0x25d)]=_0x1957b1;const _0x4cbb21=await _0x7dccb9[_0x170a86(0x315)](),_0x2b6159=await sales_finished[_0x170a86(0x1ee)]({'_id':_0x4cb2cb[_0x170a86(0x2dc)]['id']}),_0x478f17=await warehouse[_0x170a86(0x1ee)]({'name':_0x512e5e,'room':_0x1957b1,'warehouse_category':_0x170a86(0x2d8)});_0x2b6159['sale_product'][_0x170a86(0x2c5)](_0x1b9432=>{var _0x44a483=_0x170a86;const _0x3465b5=_0x478f17[_0x44a483(0x2d2)][_0x44a483(0x20a)](_0x5a933c=>{var _0x8288e2=_0x44a483;_0x5a933c[_0x8288e2(0x320)]==_0x1b9432['product_name']&&_0x5a933c[_0x8288e2(0x222)]==_0x1b9432[_0x8288e2(0x222)]&&(_0x5a933c[_0x8288e2(0x2d3)]=parseInt(_0x5a933c[_0x8288e2(0x2d3)])-parseInt(_0x1b9432[_0x8288e2(0x2fb)]));});}),console['log'](_0x170a86(0x237),_0x478f17),await _0x478f17['save']();const _0x571a64=await c_payment_data[_0x170a86(0x1ee)]({'invoice':_0x4cb2cb[_0x170a86(0x1f3)][_0x170a86(0x2cb)]});_0x571a64[_0x170a86(0x285)]=_0x4cb2cb['body'][_0x170a86(0x285)],await _0x571a64['save'](),_0x4cb2cb[_0x170a86(0x240)]('success',_0x170a86(0x22b)),_0x5992df['redirect'](_0x170a86(0x328));}catch(_0x727b59){console[_0x170a86(0x27a)](_0x727b59);}}),router['post']('/give_payment/:id',auth,async(_0x330846,_0xac7c5a)=>{var _0xad488a=a0_0x1032ba;try{const _0xfb7a5f=_0x330846[_0xad488a(0x2dc)]['id'],{invoice:_0x1699f2,customer:_0x2dea62,receivable_amount:_0x52e6ba,received_amount:_0x54eb43}=_0x330846['body'],_0x293ce3=await sales[_0xad488a(0x316)](_0xfb7a5f);console['log'](_0x293ce3);var _0x3244bd=_0x52e6ba-_0x54eb43;console['log'](_0x54eb43),_0x293ce3['received_amount']=parseFloat(_0x54eb43)+parseFloat(_0x293ce3['received_amount']),_0x293ce3[_0xad488a(0x29f)]=_0x3244bd,console[_0xad488a(0x27a)](_0x293ce3);const _0xfdec20=await _0x293ce3['save'](),_0x7ad52d=await c_payment_data[_0xad488a(0x1ee)]({'invoice':_0x1699f2});_0x7ad52d[_0xad488a(0x207)]=_0x3244bd,await _0x7ad52d[_0xad488a(0x315)]();let _0x3b14fb=new Date(),_0x5c331c=('0'+_0x3b14fb['getDate']())[_0xad488a(0x307)](-0x2),_0xfbd43=('0'+(_0x3b14fb[_0xad488a(0x252)]()+0x1))[_0xad488a(0x307)](-0x2),_0xecd9fc=_0x3b14fb['getFullYear'](),_0x5e71d8=_0xecd9fc+'-'+_0xfbd43+'-'+_0x5c331c;const _0xeee5db=new customer_payment({'invoice':_0x1699f2,'date':_0xecd9fc+'-'+_0xfbd43+'-'+_0x5c331c,'customer':_0x2dea62,'reason':_0xad488a(0x2a5),'amount':_0x54eb43}),_0x1c4a0a=await _0xeee5db[_0xad488a(0x315)]();_0x330846['flash'](_0xad488a(0x23f),_0xad488a(0x219)),_0xac7c5a[_0xad488a(0x2a0)](_0xad488a(0x22a));}catch(_0x5ade1a){console[_0xad488a(0x27a)](_0x5ade1a);}}),router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x2f7),auth,async(_0x865087,_0x13389f)=>{var _0x26a3df=a0_0x1032ba;try{const {username:_0x409e0a,email:_0x1ebdd3,role:_0x339b96}=_0x865087['user'],_0x449ce9=_0x865087[_0x26a3df(0x2bf)],_0x12b2c2=await profile[_0x26a3df(0x1ee)]({'email':_0x449ce9[_0x26a3df(0x313)]}),_0x472b54=await master_shop['find']();console[_0x26a3df(0x27a)](_0x26a3df(0x2ee),_0x472b54);const _0xbb0bcf=_0x865087[_0x26a3df(0x2dc)]['id'],_0x1512d0=await sales[_0x26a3df(0x316)](_0xbb0bcf);console['log'](_0x1512d0);const _0x55f8fb=await customer['findOne']({'name':_0x1512d0[_0x26a3df(0x24b)]});console['log'](_0x55f8fb);if(_0x472b54[0x0]['language']==_0x26a3df(0x310)){var _0x117b29=users[_0x26a3df(0x2ff)];console[_0x26a3df(0x27a)](_0x117b29);}else{if(_0x472b54[0x0][_0x26a3df(0x238)]==_0x26a3df(0x268))var _0x117b29=users[_0x26a3df(0x268)];else{if(_0x472b54[0x0][_0x26a3df(0x238)]==_0x26a3df(0x28c))var _0x117b29=users[_0x26a3df(0x28c)];else{if(_0x472b54[0x0][_0x26a3df(0x238)]==_0x26a3df(0x250))var _0x117b29=users['Spanish'];else{if(_0x472b54[0x0]['language']==_0x26a3df(0x30e))var _0x117b29=users[_0x26a3df(0x30e)];else{if(_0x472b54[0x0][_0x26a3df(0x238)]==_0x26a3df(0x2b6))var _0x117b29=users[_0x26a3df(0x20d)];else{if(_0x472b54[0x0][_0x26a3df(0x238)]==_0x26a3df(0x239))var _0x117b29=users[_0x26a3df(0x239)];else{if(_0x472b54[0x0][_0x26a3df(0x238)]==_0x26a3df(0x321))var _0x117b29=users[_0x26a3df(0x1f0)];}}}}}}}_0x13389f[_0x26a3df(0x23c)](_0x26a3df(0x2da),{'success':_0x865087[_0x26a3df(0x240)](_0x26a3df(0x23f)),'errors':_0x865087[_0x26a3df(0x240)](_0x26a3df(0x210)),'role':_0x449ce9,'profile':_0x12b2c2,'master_shop':_0x472b54,'customers':_0x55f8fb,'sales':_0x1512d0,'language':_0x117b29});}catch(_0x27fb23){console[_0x26a3df(0x27a)](_0x27fb23);}}),router['get'](a0_0x1032ba(0x25e),auth,async(_0x4c6295,_0x23e1c0)=>{var _0x270ff0=a0_0x1032ba;try{const {username:_0x5f364d,email:_0x4cb07f,role:_0x3b2967}=_0x4c6295[_0x270ff0(0x2bf)],_0x394802=_0x4c6295[_0x270ff0(0x2bf)],_0x4333b9=await profile[_0x270ff0(0x1ee)]({'email':_0x394802['email']}),_0x5b0767=await master_shop[_0x270ff0(0x2f2)](),_0x3baf7c=_0x4c6295['params']['id'],_0xfadef0=await sales_finished[_0x270ff0(0x316)](_0x3baf7c),_0xc3df39=await warehouse['aggregate']([{'$match':{'name':_0xfadef0[_0x270ff0(0x31e)]}},{'$unwind':_0x270ff0(0x2f1)},{'$group':{'_id':_0x270ff0(0x22e),'name':{'$first':_0x270ff0(0x244)},'product_stock':{'$first':_0x270ff0(0x2f4)},'bay':{'$first':_0x270ff0(0x27b)},'bin':{'$first':_0x270ff0(0x233)},'type':{'$first':_0x270ff0(0x214)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x270ff0(0x227)},'secondary_code':{'$first':_0x270ff0(0x2e7)},'product_code':{'$first':_0x270ff0(0x2fd)},'storage':{'$first':_0x270ff0(0x2c0)},'rack':{'$first':_0x270ff0(0x30d)},'expiry_date':{'$first':_0x270ff0(0x2af)},'production_date':{'$first':_0x270ff0(0x2df)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x270ff0(0x2e4)},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':_0x270ff0(0x294)},'maxPerUnit':{'$first':_0x270ff0(0x1fa)}}}]),_0x1738b9=await product[_0x270ff0(0x2f2)]({}),_0x3e99c1=await warehouse[_0x270ff0(0x2cf)]([{'$match':{'status':'Enabled','warehouse_category':_0x270ff0(0x2d8),'name':{'$ne':_0x270ff0(0x206),'$ne':_0x270ff0(0x26c)}}},{'$group':{'_id':_0x270ff0(0x1f8),'name':{'$first':_0x270ff0(0x1f8)}}},{'$sort':{'name':0x1}}]);var _0x22e7e7=[_0x270ff0(0x273)];const _0x47ab83=await warehouse['aggregate']([{'$match':{'status':_0x270ff0(0x2c7),'name':_0x270ff0(0x26c)}},{'$group':{'_id':_0x270ff0(0x1f8),'name':{'$first':_0x270ff0(0x1f8)}}},{'$sort':{'name':0x1}}]);if(_0x5b0767[0x0][_0x270ff0(0x238)]==_0x270ff0(0x310)){var _0x32aeed=users[_0x270ff0(0x2ff)];console[_0x270ff0(0x27a)](_0x32aeed);}else{if(_0x5b0767[0x0][_0x270ff0(0x238)]==_0x270ff0(0x268))var _0x32aeed=users[_0x270ff0(0x268)];else{if(_0x5b0767[0x0]['language']==_0x270ff0(0x28c))var _0x32aeed=users[_0x270ff0(0x28c)];else{if(_0x5b0767[0x0][_0x270ff0(0x238)]==_0x270ff0(0x250))var _0x32aeed=users['Spanish'];else{if(_0x5b0767[0x0][_0x270ff0(0x238)]==_0x270ff0(0x30e))var _0x32aeed=users[_0x270ff0(0x30e)];else{if(_0x5b0767[0x0][_0x270ff0(0x238)]==_0x270ff0(0x2b6))var _0x32aeed=users[_0x270ff0(0x20d)];else{if(_0x5b0767[0x0]['language']==_0x270ff0(0x239))var _0x32aeed=users['Chinese'];else{if(_0x5b0767[0x0][_0x270ff0(0x238)]==_0x270ff0(0x321))var _0x32aeed=users[_0x270ff0(0x1f0)];}}}}}}}_0x23e1c0[_0x270ff0(0x23c)](_0x270ff0(0x1eb),{'success':_0x4c6295[_0x270ff0(0x240)]('success'),'errors':_0x4c6295['flash'](_0x270ff0(0x210)),'role':_0x394802,'profile':_0x4333b9,'user':_0xfadef0,'stock':_0xc3df39,'master_shop':_0x5b0767,'unit':_0x1738b9,'language':_0x32aeed,'warehouses':_0x3e99c1,'rooms':_0x22e7e7,'warehouse_QA':_0x47ab83});}catch(_0x26b265){console[_0x270ff0(0x27a)](_0x26b265),_0x23e1c0[_0x270ff0(0x21e)](0xc8)[_0x270ff0(0x2f8)]({'message':_0x26b265[_0x270ff0(0x266)]});}}),router['post']('/view/return_sales/:id',auth,async(_0x41bfdb,_0x2d1af2)=>{var _0x122f32=a0_0x1032ba;if(_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x242)]=='QA')try{const {invoice:_0x9f978a,date:_0x385c04,warehouse_name:_0x38aa84,product_name:_0x5bfb22,primary_code:_0x50f9ad,secondary_code:_0x2c3b9f,product_code:_0x45f050,sales_quantity:_0x224450,stocks:_0x4d6053,return_qty:_0x4f7b29,Room_name:_0x3d9715,to_warehouse_name_QA:_0x44ef61,to_Room_name_QA:_0x2c79c8,note:_0x52e8e3,for_categorize:_0x29a484,product_name_QA1:_0xbb04d0}=_0x41bfdb[_0x122f32(0x1f3)];if(typeof _0xbb04d0=='string')var _0x219169=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x28f)]],_0x4c3c42=[_0x41bfdb[_0x122f32(0x1f3)]['primary_code_QA']],_0x326cb3=[_0x41bfdb[_0x122f32(0x1f3)]['secondary_code_QA']],_0x24c6f2=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x224)]],_0x19b3a5=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x30f)]],_0x1c0cbc=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x2a6)]],_0xa96135=[_0x41bfdb['body'][_0x122f32(0x216)]],_0x15d90c=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x247)]],_0x17c890=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x28a)]],_0x2227f6=[_0x41bfdb[_0x122f32(0x1f3)]['batch_code_QA']],_0x31e3c5=[_0x41bfdb['body'][_0x122f32(0x2dd)]],_0x26b72a=[_0x41bfdb['body']['unit_QA']],_0x31dfa1=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x229)]],_0x13f789=[_0x41bfdb[_0x122f32(0x1f3)]['expiry_date_QA']];else var _0x219169=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x28f)]],_0x4c3c42=[..._0x41bfdb['body'][_0x122f32(0x218)]],_0x326cb3=[..._0x41bfdb['body']['secondary_code_QA']],_0x24c6f2=[..._0x41bfdb['body']['product_code_QA']],_0x19b3a5=[..._0x41bfdb[_0x122f32(0x1f3)]['sales_quantity_QA']],_0x1c0cbc=[..._0x41bfdb[_0x122f32(0x1f3)]['stocks_QA']],_0xa96135=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x216)]],_0x15d90c=[..._0x41bfdb[_0x122f32(0x1f3)]['maxPerUnit_QA']],_0x17c890=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x28a)]],_0x2227f6=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x2cd)]],_0x31e3c5=[..._0x41bfdb[_0x122f32(0x1f3)]['secondary_unit_QA']],_0x26b72a=[..._0x41bfdb[_0x122f32(0x1f3)]['unit_QA']],_0x31dfa1=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x229)]],_0x13f789=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x297)]];const _0x251676=_0x219169[_0x122f32(0x20a)](_0x599b36=>{return _0x599b36={'product_name':_0x599b36};});_0x4c3c42[_0x122f32(0x2c5)]((_0x3e66ed,_0x4e77dd)=>{var _0x2803b5=_0x122f32;_0x251676[_0x4e77dd][_0x2803b5(0x243)]=_0x3e66ed;}),_0x326cb3[_0x122f32(0x2c5)]((_0x11ca59,_0xe342b)=>{var _0xb27c1c=_0x122f32;_0x251676[_0xe342b][_0xb27c1c(0x296)]=_0x11ca59;}),_0x24c6f2['forEach']((_0x6b36d7,_0x4cc7ff)=>{_0x251676[_0x4cc7ff]['product_code']=_0x6b36d7;}),_0x19b3a5[_0x122f32(0x2c5)]((_0x6b5458,_0x387a66)=>{var _0x1b9c90=_0x122f32;_0x251676[_0x387a66][_0x1b9c90(0x271)]=_0x6b5458;}),_0x1c0cbc['forEach']((_0x572eb8,_0x716558)=>{_0x251676[_0x716558]['stock']=_0x572eb8;}),_0xa96135[_0x122f32(0x2c5)]((_0x7f79d7,_0x66697c)=>{var _0x57b270=_0x122f32;_0x251676[_0x66697c][_0x57b270(0x292)]=_0x7f79d7;}),_0x15d90c['forEach']((_0x43d75b,_0x484387)=>{_0x251676[_0x484387]['maxPerUnit']=_0x43d75b;}),_0x17c890[_0x122f32(0x2c5)]((_0x2f6568,_0x325e40)=>{var _0x7c598b=_0x122f32;_0x251676[_0x325e40][_0x7c598b(0x255)]=_0x2f6568;}),_0x2227f6[_0x122f32(0x2c5)]((_0x3f9a2a,_0xff9f1)=>{var _0x173152=_0x122f32;_0x251676[_0xff9f1][_0x173152(0x1e7)]=_0x3f9a2a;}),_0x31e3c5['forEach']((_0x42abb6,_0x4f012c)=>{var _0x16f65d=_0x122f32;_0x251676[_0x4f012c][_0x16f65d(0x1f5)]=_0x42abb6;}),_0x26b72a[_0x122f32(0x2c5)]((_0x5809f1,_0x3daf04)=>{var _0x457cb9=_0x122f32;_0x251676[_0x3daf04][_0x457cb9(0x226)]=_0x5809f1;}),_0x31dfa1['forEach']((_0x334eaa,_0x5bf587)=>{var _0x399e81=_0x122f32;_0x251676[_0x5bf587][_0x399e81(0x2ad)]=_0x334eaa;}),_0x13f789[_0x122f32(0x2c5)]((_0x2c239a,_0x2f7740)=>{var _0x1c9116=_0x122f32;_0x251676[_0x2f7740][_0x1c9116(0x225)]=_0x2c239a;});const _0x4615c7=await sales_finished[_0x122f32(0x1ee)]({'invoice':_0x9f978a});_0x4615c7[_0x122f32(0x299)]=_0x122f32(0x301);const _0x24e250=await _0x4615c7[_0x122f32(0x315)](),_0x355fce=new sales_return_finished({'invoice':_0x9f978a,'customer':_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x24b)],'date':_0x385c04,'warehouse_name':_0x38aa84,'room':_0x3d9715,'ToWarehouse':_0x44ef61,'ToRoom':_0x2c79c8,'return_sale_QA':_0x251676,'note':_0x52e8e3,'warehouse_cat':_0x29a484}),_0x55d280=await _0x355fce[_0x122f32(0x315)](),_0x3e3ede=await sales_return_finished[_0x122f32(0x1ee)]({'invoice':_0x9f978a}),_0x45eaa7=await warehouse[_0x122f32(0x1ee)]({'name':_0x44ef61,'room':_0x2c79c8});_0x3e3ede[_0x122f32(0x2a4)]['forEach'](_0x902477=>{var _0x5ebf4c=_0x122f32,_0x3b8fa6=0x0;const _0x5e21d7=_0x45eaa7[_0x5ebf4c(0x2d2)][_0x5ebf4c(0x20a)](_0x3f1175=>{var _0x220680=_0x5ebf4c;_0x3f1175['product_name']==_0x902477['product_name']&&_0x3f1175[_0x220680(0x225)]==_0x902477[_0x220680(0x225)]&&_0x3f1175[_0x220680(0x2ad)]==_0x902477[_0x220680(0x2ad)]&&_0x3f1175[_0x220680(0x1e7)]==_0x902477[_0x220680(0x1e7)]&&(_0x3f1175[_0x220680(0x2d3)]=parseInt(_0x3f1175[_0x220680(0x2d3)])+parseInt(_0x902477[_0x220680(0x292)]),_0x3b8fa6++);});_0x3b8fa6=='0'&&(_0x45eaa7[_0x5ebf4c(0x2d2)]=_0x45eaa7['product_details'][_0x5ebf4c(0x298)]({'product_name':_0x902477[_0x5ebf4c(0x320)],'product_stock':_0x902477[_0x5ebf4c(0x292)],'primary_code':_0x902477[_0x5ebf4c(0x243)],'secondary_code':_0x902477[_0x5ebf4c(0x296)],'product_code':_0x902477[_0x5ebf4c(0x20e)],'batch_code':_0x902477[_0x5ebf4c(0x1e7)],'maxPerUnit':_0x902477[_0x5ebf4c(0x2f9)],'production_date':_0x902477[_0x5ebf4c(0x2ad)],'expiry_date':_0x902477[_0x5ebf4c(0x225)],'secondary_unit':_0x902477[_0x5ebf4c(0x1f5)],'unit':_0x902477[_0x5ebf4c(0x226)],'maxProducts':_0x902477['maxProducts'],'bay':_0x902477[_0x5ebf4c(0x222)]}));}),await _0x45eaa7[_0x122f32(0x315)]();const _0x3e6d9a=new c_payment_data({'invoice':_0x9f978a,'customer':_0x41bfdb[_0x122f32(0x1f3)]['customer'],'reason':_0x122f32(0x21a)});await _0x3e6d9a[_0x122f32(0x315)]();const _0x5c38ad=await master_shop[_0x122f32(0x2f2)](),_0x41f5c6=await email_settings[_0x122f32(0x1ee)](),_0x866dc6=await customer[_0x122f32(0x1ee)]({'name':_0x41bfdb['body'][_0x122f32(0x24b)]});_0x5c38ad[0x0][_0x122f32(0x2bd)]==0x1?(right_currency=_0x5c38ad[0x0][_0x122f32(0x2ec)],left_currency=''):(right_currency='',left_currency=_0x5c38ad[0x0]['currency']);var _0x41c10e=_0x219169,_0x59aa13=_0xa96135,_0x292a87='',_0x2cad14;for(_0x2cad14 in _0x41c10e){_0x292a87+='<tr>'+_0x122f32(0x286)+_0x41c10e[_0x2cad14]+_0x122f32(0x232)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x59aa13[_0x2cad14]+'</td>'+_0x122f32(0x248);}console['log'](_0x122f32(0x304),_0x292a87);let _0x16a953=nodemailer[_0x122f32(0x245)]({'service':_0x122f32(0x23b),'auth':{'user':_0x41f5c6[_0x122f32(0x313)],'pass':_0x41f5c6['password']}}),_0x5b15c6={'from':_0x41f5c6[_0x122f32(0x313)],'to':_0x866dc6[_0x122f32(0x313)],'subject':_0x122f32(0x2b9),'attachments':[{'filename':_0x122f32(0x258),'path':__dirname+_0x122f32(0x27e)+_0x122f32(0x26f)+_0x5c38ad[0x0][_0x122f32(0x2b3)],'cid':_0x122f32(0x1fd)}],'html':_0x122f32(0x2ae)+'<html><head><title></title>'+_0x122f32(0x2aa)+_0x122f32(0x267)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x122f32(0x2b0)+'</div>'+_0x122f32(0x267)+_0x122f32(0x1f9)+_0x5c38ad[0x0][_0x122f32(0x1ec)]+_0x122f32(0x2e5)+_0x122f32(0x2c1)+_0x122f32(0x2c1)+_0x122f32(0x24c)+_0x122f32(0x267)+_0x122f32(0x2bc)+'\x20Order\x20Number\x20:\x20'+_0x9f978a+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x385c04+'\x20'+_0x122f32(0x2b7)+_0x122f32(0x29a)+_0x122f32(0x2c1)+_0x122f32(0x308)+_0x122f32(0x278)+'<tr>'+_0x122f32(0x2d5)+_0x122f32(0x276)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x122f32(0x26b)+'</tr>'+'</thead>'+_0x122f32(0x257)+'\x20'+_0x292a87+'\x20'+'</tbody>'+_0x122f32(0x205)+_0x122f32(0x267)+_0x122f32(0x2c4)+'<h5>'+_0x5c38ad[0x0][_0x122f32(0x1ec)]+_0x122f32(0x29a)+_0x122f32(0x2c1)+'</div>'+_0x122f32(0x29c)};_0x16a953[_0x122f32(0x314)](_0x5b15c6,function(_0x5b9ca6,_0x2eb79a){var _0x18c059=_0x122f32;_0x5b9ca6?(console['log'](_0x5b9ca6),console[_0x18c059(0x27a)]('Error\x20Occurs')):console[_0x18c059(0x27a)](_0x18c059(0x2c2));}),_0x41bfdb[_0x122f32(0x240)](_0x122f32(0x23f),_0x122f32(0x1e9)),_0x2d1af2[_0x122f32(0x2a0)](_0x122f32(0x328));}catch(_0x18978f){_0x2d1af2[_0x122f32(0x21e)](0xc8)[_0x122f32(0x2f8)]({'message1':_0x18978f[_0x122f32(0x266)]});}else{if(_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x242)]=='GS')try{const {invoice:_0x391284,date:_0x47c451,warehouse_name:_0xdfdbb6,product_name:_0x3fd7bd,primary_code:_0x3e0cd1,secondary_code:_0x32e90a,product_code:_0x3663ac,sales_quantity:_0x367b36,stocks:_0x57619e,return_qty:_0x54a855,Room_name:_0x303fe1,to_warehouse_name:_0x41d133,to_Room_name:_0x270d72,note:_0xb5a529,level:_0x3c67d9,isle:_0x13821e,pallet:_0x5eaace,for_categorize:_0x2ee36a}=_0x41bfdb[_0x122f32(0x1f3)];if(typeof _0x3fd7bd==_0x122f32(0x2e3))var _0x219169=[_0x41bfdb[_0x122f32(0x1f3)]['product_name']],_0x4c3c42=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x243)]],_0x326cb3=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x296)]],_0x24c6f2=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x20e)]],_0x19b3a5=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x31b)]],_0xa96135=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x292)]],_0x4b538a=[_0x41bfdb['body'][_0x122f32(0x222)]],_0x15d90c=[_0x41bfdb['body']['maxPerUnit']],_0x17c890=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x255)]],_0x2227f6=[_0x41bfdb['body'][_0x122f32(0x1e7)]],_0x31e3c5=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x1f5)]],_0x26b72a=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x226)]],_0x31dfa1=[_0x41bfdb[_0x122f32(0x1f3)]['production_date']],_0x13f789=[_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x225)]];else var _0x219169=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x320)]],_0x4c3c42=[..._0x41bfdb['body'][_0x122f32(0x243)]],_0x326cb3=[..._0x41bfdb['body'][_0x122f32(0x296)]],_0x24c6f2=[..._0x41bfdb['body'][_0x122f32(0x20e)]],_0x19b3a5=[..._0x41bfdb[_0x122f32(0x1f3)]['sales_quantity']],_0xa96135=[..._0x41bfdb['body'][_0x122f32(0x292)]],_0x4b538a=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x222)]],_0x15d90c=[..._0x41bfdb['body'][_0x122f32(0x2f9)]],_0x17c890=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x255)]],_0x2227f6=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x1e7)]],_0x31e3c5=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x1f5)]],_0x26b72a=[..._0x41bfdb['body'][_0x122f32(0x226)]],_0x31dfa1=[..._0x41bfdb[_0x122f32(0x1f3)]['production_date']],_0x13f789=[..._0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x225)]];const _0x421265=_0x219169['map'](_0x1f21aa=>{return _0x1f21aa={'product_name':_0x1f21aa};});_0x4c3c42[_0x122f32(0x2c5)]((_0x112727,_0x5d4fd9)=>{var _0x5134d0=_0x122f32;_0x421265[_0x5d4fd9][_0x5134d0(0x243)]=_0x112727;}),_0x326cb3['forEach']((_0x2974d3,_0x23833d)=>{var _0x57acec=_0x122f32;_0x421265[_0x23833d][_0x57acec(0x296)]=_0x2974d3;}),_0x24c6f2['forEach']((_0x1c4e82,_0x58a56d)=>{var _0x2f9528=_0x122f32;_0x421265[_0x58a56d][_0x2f9528(0x20e)]=_0x1c4e82;}),_0x19b3a5[_0x122f32(0x2c5)]((_0x580d61,_0x52cc15)=>{var _0x3eea3b=_0x122f32;_0x421265[_0x52cc15][_0x3eea3b(0x271)]=_0x580d61;}),_0xa96135[_0x122f32(0x2c5)]((_0x43a46e,_0x1f6145)=>{var _0x35eec3=_0x122f32;_0x421265[_0x1f6145][_0x35eec3(0x292)]=_0x43a46e;}),_0x4b538a[_0x122f32(0x2c5)]((_0x2e154b,_0x4281e7)=>{_0x421265[_0x4281e7]['bay']=_0x2e154b;}),_0x15d90c[_0x122f32(0x2c5)]((_0x2d616c,_0x795865)=>{_0x421265[_0x795865]['maxPerUnit']=_0x2d616c;}),_0x17c890['forEach']((_0x3df914,_0x4de07e)=>{var _0x429350=_0x122f32;_0x421265[_0x4de07e][_0x429350(0x255)]=_0x3df914;}),_0x2227f6[_0x122f32(0x2c5)]((_0x2f5a55,_0x2dd24b)=>{var _0x5bb13e=_0x122f32;_0x421265[_0x2dd24b][_0x5bb13e(0x1e7)]=_0x2f5a55;}),_0x31e3c5[_0x122f32(0x2c5)]((_0x34da4c,_0x442025)=>{var _0x4728a2=_0x122f32;_0x421265[_0x442025][_0x4728a2(0x1f5)]=_0x34da4c;}),_0x26b72a['forEach']((_0x153084,_0x4c7e8b)=>{_0x421265[_0x4c7e8b]['unit']=_0x153084;}),_0x31dfa1[_0x122f32(0x2c5)]((_0x45ac81,_0x1f5b6a)=>{var _0x517221=_0x122f32;_0x421265[_0x1f5b6a][_0x517221(0x2ad)]=_0x45ac81;}),_0x13f789[_0x122f32(0x2c5)]((_0x3a9df7,_0x80fd06)=>{_0x421265[_0x80fd06]['expiry_date']=_0x3a9df7;});var _0x266228=0x0;_0x421265[_0x122f32(0x2c5)](_0x5f4e2d=>{var _0x5e403f=_0x122f32;(parseInt(_0x5f4e2d['sale_qty'])<parseInt(_0x5f4e2d[_0x5e403f(0x292)])||parseInt(_0x5f4e2d[_0x5e403f(0x21b)])<parseInt(_0x5f4e2d[_0x5e403f(0x292)])&&parseInt(_0x5f4e2d[_0x5e403f(0x271)])>parseInt(_0x5f4e2d['return_qty'])||parseInt(_0x5f4e2d[_0x5e403f(0x292)])==0x0)&&_0x266228++;});if(_0x266228!=0x0)return _0x41bfdb[_0x122f32(0x240)](_0x122f32(0x210),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x2d1af2['redirect'](_0x122f32(0x323));const _0x114a09=await sales_finished[_0x122f32(0x1ee)]({'invoice':_0x391284});_0x114a09[_0x122f32(0x299)]=_0x122f32(0x301);const _0x2ceb59=await _0x114a09[_0x122f32(0x315)](),_0x1ec7da=new sales_return_finished({'invoice':_0x391284,'customer':_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x24b)],'date':_0x47c451,'warehouse_name':_0xdfdbb6,'room':_0x303fe1,'ToWarehouse':_0x41d133,'ToRoom':_0x270d72,'return_sale':_0x421265,'note':_0xb5a529,'warehouse_cat':_0x2ee36a}),_0x251abf=await _0x1ec7da[_0x122f32(0x315)](),_0x54c8b9=await sales_return_finished[_0x122f32(0x1ee)]({'invoice':_0x391284}),_0x30e399=await warehouse[_0x122f32(0x1ee)]({'name':_0x41d133,'room':_0x270d72,'warehouse_category':_0x122f32(0x2d8)});_0x54c8b9[_0x122f32(0x1f2)][_0x122f32(0x2c5)](_0x38bb00=>{var _0x25fe39=_0x122f32,_0x377909=0x0;const _0x426e67=_0x30e399[_0x25fe39(0x2d2)][_0x25fe39(0x20a)](_0x4ed593=>{var _0x38dded=_0x25fe39;_0x4ed593[_0x38dded(0x320)]==_0x38bb00[_0x38dded(0x320)]&&_0x4ed593[_0x38dded(0x222)]==_0x38bb00[_0x38dded(0x222)]&&_0x4ed593['expiry_date']==_0x38bb00[_0x38dded(0x225)]&&_0x4ed593[_0x38dded(0x2ad)]==_0x38bb00[_0x38dded(0x2ad)]&&_0x4ed593[_0x38dded(0x1e7)]==_0x38bb00['batch_code']&&(_0x4ed593[_0x38dded(0x2d3)]=parseInt(_0x4ed593[_0x38dded(0x2d3)])+parseInt(_0x38bb00[_0x38dded(0x292)]),_0x377909++);});_0x377909=='0'&&(_0x30e399[_0x25fe39(0x2d2)]=_0x30e399[_0x25fe39(0x2d2)]['concat']({'product_name':_0x38bb00[_0x25fe39(0x320)],'product_stock':_0x38bb00['return_qty'],'primary_code':_0x38bb00[_0x25fe39(0x243)],'secondary_code':_0x38bb00[_0x25fe39(0x296)],'product_code':_0x38bb00[_0x25fe39(0x20e)],'bay':_0x38bb00[_0x25fe39(0x222)],'batch_code':_0x38bb00[_0x25fe39(0x1e7)],'maxPerUnit':_0x38bb00['maxPerUnit'],'production_date':_0x38bb00['production_date'],'expiry_date':_0x38bb00[_0x25fe39(0x225)],'secondary_unit':_0x38bb00['secondary_unit'],'unit':_0x38bb00[_0x25fe39(0x226)],'maxProducts':_0x38bb00['maxProducts']}));}),await _0x30e399[_0x122f32(0x315)](),console[_0x122f32(0x27a)](_0x41bfdb['body']);const _0x43452f=new c_payment_data({'invoice':_0x391284,'customer':_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x24b)],'reason':'Sale\x20Return'});await _0x43452f[_0x122f32(0x315)]();const _0x4ff8cf=await master_shop[_0x122f32(0x2f2)]();console[_0x122f32(0x27a)]('add\x20post',_0x4ff8cf[0x0][_0x122f32(0x2b3)]);const _0x3b253e=await email_settings[_0x122f32(0x1ee)](),_0x308f9a=await customer[_0x122f32(0x1ee)]({'name':_0x41bfdb[_0x122f32(0x1f3)][_0x122f32(0x24b)]});console[_0x122f32(0x27a)]('customer_data',_0x308f9a);_0x4ff8cf[0x0][_0x122f32(0x2bd)]==0x1?(right_currency=_0x4ff8cf[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x4ff8cf[0x0][_0x122f32(0x2ec)]);var _0x41c10e=_0x219169,_0x59aa13=_0xa96135,_0x292a87='',_0x2cad14;for(_0x2cad14 in _0x41c10e){_0x292a87+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x41c10e[_0x2cad14]+_0x122f32(0x232)+_0x122f32(0x286)+_0x59aa13[_0x2cad14]+'</td>'+_0x122f32(0x248);}console[_0x122f32(0x27a)](_0x122f32(0x304),_0x292a87);let _0x3501e9=nodemailer['createTransport']({'service':_0x122f32(0x23b),'auth':{'user':_0x3b253e[_0x122f32(0x313)],'pass':_0x3b253e['password']}}),_0x331924={'from':_0x3b253e['email'],'to':_0x308f9a[_0x122f32(0x313)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x122f32(0x258),'path':__dirname+_0x122f32(0x27e)+_0x122f32(0x26f)+_0x4ff8cf[0x0][_0x122f32(0x2b3)],'cid':_0x122f32(0x1fd)}],'html':_0x122f32(0x2ae)+'<html><head><title></title>'+_0x122f32(0x2aa)+'<div>'+_0x122f32(0x221)+_0x122f32(0x267)+_0x122f32(0x2b0)+_0x122f32(0x2c1)+_0x122f32(0x267)+'<h2>\x20'+_0x4ff8cf[0x0][_0x122f32(0x1ec)]+'\x20</h2>'+_0x122f32(0x2c1)+_0x122f32(0x2c1)+_0x122f32(0x24c)+_0x122f32(0x267)+_0x122f32(0x2bc)+_0x122f32(0x269)+_0x391284+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x122f32(0x228)+_0x47c451+'\x20'+'</span>'+_0x122f32(0x29a)+'</div>'+_0x122f32(0x308)+_0x122f32(0x278)+_0x122f32(0x25c)+_0x122f32(0x2d5)+_0x122f32(0x276)+_0x122f32(0x1fb)+_0x122f32(0x26b)+_0x122f32(0x248)+_0x122f32(0x2c9)+_0x122f32(0x257)+'\x20'+_0x292a87+'\x20'+_0x122f32(0x265)+'</table>'+_0x122f32(0x267)+_0x122f32(0x2c4)+'<h5>'+_0x4ff8cf[0x0][_0x122f32(0x1ec)]+'</h5>'+_0x122f32(0x2c1)+'</div>'+_0x122f32(0x29c)};_0x3501e9[_0x122f32(0x314)](_0x331924,function(_0x4d3849,_0x5ab340){var _0x37b812=_0x122f32;_0x4d3849?(console['log'](_0x4d3849),console[_0x37b812(0x27a)]('Error\x20Occurs')):console[_0x37b812(0x27a)](_0x37b812(0x2c2));}),_0x41bfdb['flash']('success',_0x122f32(0x1e9)),_0x2d1af2[_0x122f32(0x2a0)](_0x122f32(0x328));}catch(_0x3cb926){console['log'](_0x3cb926),_0x2d1af2[_0x122f32(0x21e)](0xc8)[_0x122f32(0x2f8)]({'message1':_0x3cb926['message']});}}}),router[a0_0x1032ba(0x27d)](a0_0x1032ba(0x280),auth,async(_0xfd4b77,_0x1b5e7e)=>{var _0x1d380e=a0_0x1032ba;try{const {username:_0x39d519,email:_0x5a44c7,role:_0x1aa4aa}=_0xfd4b77['user'],_0x274198=_0xfd4b77[_0x1d380e(0x2bf)],_0x21f196=await profile[_0x1d380e(0x1ee)]({'email':_0x274198['email']}),_0x58d60d=await master_shop[_0x1d380e(0x2f2)]();console['log'](_0x1d380e(0x311),_0x58d60d);const _0x52a918=_0xfd4b77[_0x1d380e(0x2dc)]['id'],_0x51a430=await sales[_0x1d380e(0x316)](_0x52a918);console[_0x1d380e(0x27a)]('barcode\x20user_id',_0x51a430);if(_0x58d60d[0x0][_0x1d380e(0x238)]==_0x1d380e(0x310))var _0x4596be=users['English'];else{if(_0x58d60d[0x0][_0x1d380e(0x238)]==_0x1d380e(0x268))var _0x4596be=users[_0x1d380e(0x268)];else{if(_0x58d60d[0x0][_0x1d380e(0x238)]==_0x1d380e(0x28c))var _0x4596be=users[_0x1d380e(0x28c)];else{if(_0x58d60d[0x0][_0x1d380e(0x238)]==_0x1d380e(0x250))var _0x4596be=users[_0x1d380e(0x250)];else{if(_0x58d60d[0x0][_0x1d380e(0x238)]==_0x1d380e(0x30e))var _0x4596be=users[_0x1d380e(0x30e)];else{if(_0x58d60d[0x0]['language']==_0x1d380e(0x2b6))var _0x4596be=users[_0x1d380e(0x20d)];else{if(_0x58d60d[0x0][_0x1d380e(0x238)]==_0x1d380e(0x239))var _0x4596be=users[_0x1d380e(0x239)];else{if(_0x58d60d[0x0][_0x1d380e(0x238)]==_0x1d380e(0x321))var _0x4596be=users[_0x1d380e(0x1f0)];}}}}}}}_0x1b5e7e[_0x1d380e(0x23c)]('all_sales_barcode',{'success':_0xfd4b77[_0x1d380e(0x240)](_0x1d380e(0x23f)),'errors':_0xfd4b77[_0x1d380e(0x240)](_0x1d380e(0x210)),'role':_0x274198,'profile':_0x21f196,'alldata':_0x51a430,'master_shop':_0x58d60d,'language':_0x4596be});}catch(_0x6a5d42){console['log'](_0x6a5d42);}}),router[a0_0x1032ba(0x21c)](a0_0x1032ba(0x324),async(_0x331440,_0x418f29)=>{var _0x2124c0=a0_0x1032ba;const {product_code:_0x46943d,warehouse_name:_0x333849,rooms_data:_0x53a2c6,Roomslist:_0x14389b,sales_category:_0x5d1039}=_0x331440[_0x2124c0(0x1f3)],_0x1b0399=_0x14389b['split'](','),_0x5a1457=[];async function _0x5b4170(_0x511b7c){var _0x4e0c5a=_0x2124c0;const _0x1b4700=await warehouse['aggregate']([{'$match':{'name':_0x333849,'room':_0x511b7c}},{'$unwind':_0x4e0c5a(0x2f1)},{'$match':{'product_details.primary_code':_0x46943d}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4e0c5a(0x244)},'product_stock':{'$first':_0x4e0c5a(0x2f4)},'primary_code':{'$first':_0x4e0c5a(0x227)},'secondary_code':{'$first':_0x4e0c5a(0x2e7)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4e0c5a(0x318)},'bay':{'$first':_0x4e0c5a(0x27b)},'type':{'$first':_0x4e0c5a(0x214)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x4e0c5a(0x201)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x4e0c5a(0x2c0)},'rack':{'$first':_0x4e0c5a(0x30d)},'expiry_date':{'$first':_0x4e0c5a(0x2af)},'production_date':{'$first':_0x4e0c5a(0x2df)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x4e0c5a(0x294)},'product_cat':{'$first':_0x4e0c5a(0x234)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x4e0c5a(0x287)},'invoice':{'$first':_0x4e0c5a(0x256)},'uuid':{'$first':_0x4e0c5a(0x2e2)},'gross_price':{'$first':_0x4e0c5a(0x2d7)},'sales_category':{'$first':_0x4e0c5a(0x2e6)}}}]),_0x3afa0c=await warehouse[_0x4e0c5a(0x2cf)]([{'$match':{'name':_0x333849,'room':_0x511b7c}},{'$unwind':_0x4e0c5a(0x2f1)},{'$match':{'product_details.secondary_code':_0x46943d}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4e0c5a(0x244)},'product_stock':{'$first':_0x4e0c5a(0x2f4)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4e0c5a(0x2fd)},'level':{'$first':_0x4e0c5a(0x27b)},'isle':{'$first':_0x4e0c5a(0x233)},'type':{'$first':_0x4e0c5a(0x214)},'pallet':{'$first':_0x4e0c5a(0x25f)},'unit':{'$first':_0x4e0c5a(0x201)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4e0c5a(0x30d)},'expiry_date':{'$first':_0x4e0c5a(0x2af)},'production_date':{'$first':_0x4e0c5a(0x2df)},'maxPerUnit':{'$first':_0x4e0c5a(0x1fa)},'batch_code':{'$first':_0x4e0c5a(0x294)},'product_cat':{'$first':_0x4e0c5a(0x234)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x4e0c5a(0x287)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x4e0c5a(0x2d7)},'sales_category':{'$first':_0x4e0c5a(0x2e6)}}}]);if(_0x1b4700[_0x4e0c5a(0x246)]>0x0)_0x5a1457[_0x4e0c5a(0x2ef)](_0x1b4700);else _0x3afa0c['length']>0x0&&_0x5a1457[_0x4e0c5a(0x2ef)](_0x3afa0c);}const _0x262d19=_0x1b0399['map'](_0x2bf349=>_0x5b4170(_0x2bf349));await Promise['all'](_0x262d19),_0x418f29[_0x2124c0(0x2f8)](_0x5a1457);}),router[a0_0x1032ba(0x21c)](a0_0x1032ba(0x1f4),async(_0x5d81fd,_0xfd52de)=>{var _0x2ace44=a0_0x1032ba;const {product_code:_0x28ae4b,warehouse_name:_0x280d53,rooms_data:_0x534850,Roomslist:_0x10b7ca,sales_category:_0x114a9a}=_0x5d81fd['body'],_0x226c96=_0x10b7ca[_0x2ace44(0x22c)](','),_0x44afa9=[];async function _0x405fca(_0x58a447){var _0x29dc5b=_0x2ace44;const _0x47a4cd=await warehouse[_0x29dc5b(0x2cf)]([{'$match':{'name':_0x280d53,'room':_0x58a447}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x28ae4b,'product_details.sales_category':_0x114a9a,'product_details.type_products':_0x29dc5b(0x27a)}},{'$group':{'_id':_0x29dc5b(0x22e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x29dc5b(0x2f4)},'primary_code':{'$first':_0x29dc5b(0x227)},'secondary_code':{'$first':_0x29dc5b(0x2e7)},'product_code':{'$first':_0x29dc5b(0x2fd)},'level':{'$first':_0x29dc5b(0x318)},'bay':{'$first':_0x29dc5b(0x27b)},'type':{'$first':_0x29dc5b(0x214)},'pallet':{'$first':_0x29dc5b(0x25f)},'unit':{'$first':_0x29dc5b(0x201)},'secondary_unit':{'$first':_0x29dc5b(0x2e4)},'storage':{'$first':_0x29dc5b(0x2c0)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x29dc5b(0x2af)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x29dc5b(0x1fa)},'batch_code':{'$first':_0x29dc5b(0x294)},'product_cat':{'$first':_0x29dc5b(0x234)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x29dc5b(0x256)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x29dc5b(0x2d7)},'sales_category':{'$first':_0x29dc5b(0x2e6)},'type_products':{'$first':_0x29dc5b(0x31c)}}}]);console[_0x29dc5b(0x27a)](_0x29dc5b(0x27a)+'\x20<>\x20'+_0x28ae4b+'\x20<>\x20'+_0x114a9a);const _0x391dd1=await warehouse[_0x29dc5b(0x2cf)]([{'$match':{'name':_0x280d53,'room':_0x58a447}},{'$unwind':_0x29dc5b(0x2f1)},{'$match':{'product_details.secondary_code':_0x28ae4b,'product_details.sales_category':_0x114a9a,'product_details.type_products':'log'}},{'$group':{'_id':_0x29dc5b(0x22e),'name':{'$first':_0x29dc5b(0x244)},'product_stock':{'$first':_0x29dc5b(0x2f4)},'primary_code':{'$first':_0x29dc5b(0x227)},'secondary_code':{'$first':_0x29dc5b(0x2e7)},'product_code':{'$first':_0x29dc5b(0x2fd)},'level':{'$first':_0x29dc5b(0x27b)},'isle':{'$first':_0x29dc5b(0x233)},'type':{'$first':_0x29dc5b(0x214)},'pallet':{'$first':_0x29dc5b(0x25f)},'unit':{'$first':_0x29dc5b(0x201)},'secondary_unit':{'$first':_0x29dc5b(0x2e4)},'storage':{'$first':_0x29dc5b(0x2c0)},'rack':{'$first':_0x29dc5b(0x30d)},'expiry_date':{'$first':_0x29dc5b(0x2af)},'production_date':{'$first':_0x29dc5b(0x2df)},'maxPerUnit':{'$first':_0x29dc5b(0x1fa)},'batch_code':{'$first':_0x29dc5b(0x294)},'product_cat':{'$first':_0x29dc5b(0x234)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x29dc5b(0x287)},'invoice':{'$first':_0x29dc5b(0x256)},'uuid':{'$first':_0x29dc5b(0x2e2)},'gross_price':{'$first':_0x29dc5b(0x2d7)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':_0x29dc5b(0x31c)}}}]);if(_0x47a4cd[_0x29dc5b(0x246)]>0x0)_0x44afa9['push'](_0x47a4cd);else _0x391dd1[_0x29dc5b(0x246)]>0x0&&_0x44afa9[_0x29dc5b(0x2ef)](_0x391dd1);}const _0xf2e0f9=_0x226c96[_0x2ace44(0x20a)](_0x26ea9d=>_0x405fca(_0x26ea9d));await Promise[_0x2ace44(0x241)](_0xf2e0f9),_0xfd52de[_0x2ace44(0x2f8)](_0x44afa9);}),router['post']('/barcode_scanner_auto_data',async(_0x168925,_0x162acd)=>{var _0x21ab57=a0_0x1032ba;try{const {prduct_code:_0x30eadc,warehouse_data:_0x4e7f5d,qty_req:_0x5b8f1b}=_0x168925['body'];let _0x306a16=_0x30eadc[_0x21ab57(0x22c)]('~'),_0x182a7f=_0x5b8f1b[_0x21ab57(0x22c)]('~'),_0x220c93=[],_0x6d0d3a=0x0;for(let _0x1e0063=0x0;_0x1e0063<=_0x306a16['length']-0x1;_0x1e0063++){const _0x48bff7=_0x306a16[_0x1e0063],_0x15c9ae=_0x182a7f[_0x1e0063],_0xcf2ada=await warehouse[_0x21ab57(0x2cf)]([{'$match':{'name':_0x4e7f5d}},{'$unwind':_0x21ab57(0x2f1)},{'$match':{'product_details.product_code':_0x48bff7,'product_details.isAvailable':_0x21ab57(0x2cc),'product_details.isUsed':_0x21ab57(0x253)}},{'$sort':{'product_details.date_received':0x1,'product_details.level':-0x1,'product_details.bay':-0x1}},{'$group':{'_id':_0x21ab57(0x22e),'name':{'$first':_0x21ab57(0x244)},'product_stock':{'$first':_0x21ab57(0x2f4)},'primary_code':{'$first':_0x21ab57(0x227)},'secondary_code':{'$first':_0x21ab57(0x2e7)},'product_code':{'$first':_0x21ab57(0x2fd)},'level':{'$first':_0x21ab57(0x318)},'bay':{'$first':_0x21ab57(0x27b)},'type':{'$first':_0x21ab57(0x214)},'pallet':{'$first':_0x21ab57(0x25f)},'unit':{'$first':_0x21ab57(0x201)},'secondary_unit':{'$first':_0x21ab57(0x2e4)},'storage':{'$first':_0x21ab57(0x2c0)},'rack':{'$first':_0x21ab57(0x30d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x21ab57(0x2df)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x21ab57(0x294)},'product_cat':{'$first':_0x21ab57(0x234)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x21ab57(0x287)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x21ab57(0x2e2)},'gross_price':{'$first':_0x21ab57(0x2d7)},'sales_category':{'$first':_0x21ab57(0x2e6)},'date_received':{'$first':_0x21ab57(0x208)},'warehouse_id':{'$first':_0x21ab57(0x2f6)}}}]),_0x5f2b66=_0xcf2ada['sort']((_0x1f6027,_0x41e990)=>new Date(_0x1f6027[_0x21ab57(0x1e4)])-new Date(_0x41e990[_0x21ab57(0x1e4)]));let _0x35901b=_0x15c9ae;for(let _0x5a46d9=0x0;_0x5a46d9<=_0x5f2b66[_0x21ab57(0x246)]-0x1&&_0x35901b>0x0;_0x5a46d9++){const _0x2974cc=_0x5f2b66[_0x5a46d9];if(_0x2974cc[_0x21ab57(0x20e)]==_0x48bff7){_0x220c93[_0x6d0d3a]={};const _0x3c572d=parseInt(_0x2974cc['product_stock']),_0x1064e7=0x0;let _0x3894f7=_0x3c572d-_0x1064e7,_0x5d47fd=Math[_0x21ab57(0x2d6)](_0x35901b,_0x3894f7);console[_0x21ab57(0x27a)](_0x21ab57(0x217)+_0x5d47fd+'\x20units\x20to\x20warehouse:\x20'+_0x4e7f5d+_0x21ab57(0x325)+_0x2974cc['roomNamed']+_0x21ab57(0x2fa)+(_0x2974cc['level']+_0x2974cc[_0x21ab57(0x222)])+_0x21ab57(0x2db)+_0x2974cc[_0x21ab57(0x1e4)]+_0x21ab57(0x2e8)+_0x2974cc[_0x21ab57(0x203)]),_0x220c93[_0x6d0d3a][_0x21ab57(0x303)]=_0x2974cc[_0x21ab57(0x274)]+'~'+_0x2974cc[_0x21ab57(0x200)]+'~'+_0x5d47fd,_0x220c93[_0x6d0d3a]['product_name']=_0x2974cc[_0x21ab57(0x203)],_0x220c93[_0x6d0d3a][_0x21ab57(0x20e)]=_0x2974cc[_0x21ab57(0x20e)],_0x220c93[_0x6d0d3a][_0x21ab57(0x251)]=_0x2974cc[_0x21ab57(0x251)],_0x220c93[_0x6d0d3a][_0x21ab57(0x2b1)]=_0x2974cc['date_recieved'],_0x220c93[_0x6d0d3a]['sales_category']=_0x2974cc[_0x21ab57(0x295)],_0x220c93[_0x6d0d3a]['uuid']=_0x2974cc['uuid'],_0x220c93[_0x6d0d3a][_0x21ab57(0x2fb)]=_0x5d47fd,_0x220c93[_0x6d0d3a]['unit']=_0x2974cc[_0x21ab57(0x226)],_0x220c93[_0x6d0d3a]['secondary_unit']=_0x2974cc[_0x21ab57(0x1f5)],_0x220c93[_0x6d0d3a][_0x21ab57(0x243)]=_0x2974cc[_0x21ab57(0x243)],_0x220c93[_0x6d0d3a][_0x21ab57(0x296)]=_0x2974cc[_0x21ab57(0x296)],_0x220c93[_0x6d0d3a][_0x21ab57(0x1e8)]=_0x2974cc['maxStocks'],_0x220c93[_0x6d0d3a][_0x21ab57(0x1e7)]=_0x2974cc[_0x21ab57(0x1e7)],_0x220c93[_0x6d0d3a]['expiry_date']=_0x2974cc[_0x21ab57(0x225)],_0x220c93[_0x6d0d3a][_0x21ab57(0x2ad)]=_0x2974cc[_0x21ab57(0x2ad)],_0x220c93[_0x6d0d3a][_0x21ab57(0x215)]=_0x2974cc[_0x21ab57(0x215)],_0x220c93[_0x6d0d3a][_0x21ab57(0x2ca)]=_0x2974cc[_0x21ab57(0x2ca)],_0x220c93[_0x6d0d3a]['invoice']=_0x2974cc[_0x21ab57(0x2cb)],_0x220c93[_0x6d0d3a]['gross_price']=_0x2974cc[_0x21ab57(0x30c)],_0x220c93[_0x6d0d3a]['room_name']=_0x2974cc['roomNamed'],_0x220c93[_0x6d0d3a]['level']=_0x2974cc[_0x21ab57(0x2fe)],_0x220c93[_0x6d0d3a]['bay']=_0x2974cc[_0x21ab57(0x222)],_0x220c93[_0x6d0d3a][_0x21ab57(0x21e)]=_0x21ab57(0x2cc),console[_0x21ab57(0x27a)]('1',_0x6d0d3a),_0x35901b-=_0x5d47fd,_0x6d0d3a++;if(_0x35901b<=0x0)break;}}if(_0x35901b>0x0){var _0x164ff7=await product[_0x21ab57(0x1ee)]({'product_code':_0x48bff7});console['log']('2',_0x6d0d3a),_0x220c93[_0x6d0d3a]={},_0x220c93[_0x6d0d3a][_0x21ab57(0x320)]=_0x164ff7[_0x21ab57(0x203)],_0x220c93[_0x6d0d3a][_0x21ab57(0x20e)]=_0x48bff7,_0x220c93[_0x6d0d3a][_0x21ab57(0x251)]=_0x164ff7['_id'][_0x21ab57(0x2ea)](),_0x220c93[_0x6d0d3a][_0x21ab57(0x2fb)]=_0x35901b,_0x220c93[_0x6d0d3a]['standard_unit']=_0x164ff7[_0x21ab57(0x226)],_0x220c93[_0x6d0d3a][_0x21ab57(0x1f5)]=_0x164ff7[_0x21ab57(0x20b)],_0x220c93[_0x6d0d3a]['primary_code']=_0x164ff7['primary_code'],_0x220c93[_0x6d0d3a][_0x21ab57(0x296)]=_0x164ff7[_0x21ab57(0x296)],_0x220c93[_0x6d0d3a][_0x21ab57(0x1e8)]=_0x164ff7[_0x21ab57(0x1e8)],_0x220c93[_0x6d0d3a]['maxperunit']=_0x164ff7[_0x21ab57(0x24a)],_0x220c93[_0x6d0d3a][_0x21ab57(0x30c)]=_0x164ff7['gross_price'],_0x220c93[_0x6d0d3a][_0x21ab57(0x21e)]=_0x21ab57(0x253),console[_0x21ab57(0x27a)]('There\x20is\x20'+_0x35901b+_0x21ab57(0x2a7)+_0x6d0d3a+'\x20<>\x20'+_0x48bff7),_0x6d0d3a++;}}_0x162acd[_0x21ab57(0x2f8)](_0x220c93);}catch(_0x13b619){console[_0x21ab57(0x27a)](_0x13b619);}}),router['post'](a0_0x1032ba(0x2b2),async(_0x56e6b7,_0x25e583)=>{var _0x224f77=a0_0x1032ba;const {product_code:_0x2504fe}=_0x56e6b7['body'];var _0x1c747c;const _0x481615=await product['aggregate']([{'$match':{'primary_code':_0x2504fe}},{'$group':{'_id':_0x224f77(0x2f6),'name':{'$first':_0x224f77(0x1f8)},'category':{'$first':_0x224f77(0x223)},'brand':{'$first':'$brand'},'unit':{'$first':'$unit'},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x224f77(0x291)},'primary_code':{'$first':_0x224f77(0x220)},'secondary_code':{'$first':_0x224f77(0x211)},'maxStocks':{'$first':_0x224f77(0x2fc)},'maxProdPerUnit':{'$first':_0x224f77(0x2a2)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x224f77(0x26e)},'gross_price':{'$first':'$gross_price'},'sales_category':{'$first':_0x224f77(0x1ff)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x24f932=await product[_0x224f77(0x2cf)]([{'$match':{'secondary_code':_0x2504fe}},{'$group':{'_id':_0x224f77(0x2f6),'name':{'$first':_0x224f77(0x1f8)},'category':{'$first':'$category'},'brand':{'$first':_0x224f77(0x2b8)},'unit':{'$first':_0x224f77(0x23a)},'alertquantity':{'$first':_0x224f77(0x31a)},'product_code':{'$first':_0x224f77(0x291)},'primary_code':{'$first':_0x224f77(0x220)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x224f77(0x2fc)},'maxProdPerUnit':{'$first':_0x224f77(0x2a2)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x224f77(0x26e)},'gross_price':{'$first':_0x224f77(0x2f0)},'sales_category':{'$first':_0x224f77(0x1ff)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x481615[_0x224f77(0x246)]>0x0)_0x1c747c=_0x481615;else _0x24f932[_0x224f77(0x246)]>0x0&&(_0x1c747c=_0x24f932);_0x25e583[_0x224f77(0x2f8)](_0x1c747c);}),router[a0_0x1032ba(0x21c)](a0_0x1032ba(0x235),async(_0x567892,_0x4e4fa4)=>{var _0x4d451a=a0_0x1032ba;try{const {group_id:_0x56f440,DRSI:_0x14dcc3,dateofreq:_0xa77ea4,PO_number:_0x2ba75e,date:_0xf8f1e1,warehouse_name:_0x162d58,typevehicle:_0x1667ed,deliverydate:_0x298ca9,driver:_0x449229,plate:_0x134a78,van:_0x442b23,TSU:_0x2cc9cf,actual_delivery_date:_0x125bd5,TFU:_0x100608,pull_out_date:_0x11cea2,sales:_0x4f8e5c,Customer_data:_0x564036,note:_0x3b732d}=_0x567892[_0x4d451a(0x1f3)],_0x234526=mongoose[_0x4d451a(0x212)][_0x4d451a(0x249)];let _0x4e1cba=[];const _0x29b3f6=new invoice_for_outgoing();await _0x29b3f6[_0x4d451a(0x315)]();const _0x543668='OUT-'+_0x29b3f6[_0x4d451a(0x284)][_0x4d451a(0x28e)]()['padStart'](0x8,'0');if(typeof _0x56f440==_0x4d451a(0x2e3)){let _0x450161=_0x56f440[_0x4d451a(0x22c)]('~');var _0x1a1c75=_0x234526(_0x450161[0x0]),_0x222926=_0x234526(_0x450161[0x1]),_0x24c16d=_0x450161[0x2];let _0x27b5ed=0x0;const _0x4da419=await warehouse['aggregate']([{'$match':{'_id':_0x1a1c75}},{'$unwind':'$product_details'},{'$match':{'product_details._id':_0x222926}}]);await warehouse[_0x4d451a(0x2d4)]({'_id':_0x234526(_0x1a1c75),'product_details._id':_0x234526(_0x222926)},{'$set':{'product_details.$.isUsed':_0x4d451a(0x2cc)}}),_0x4e1cba[_0x27b5ed]={};for(let _0x3ee86c=0x0;_0x3ee86c<=_0x4da419[_0x4d451a(0x246)]-0x1;_0x3ee86c++){const _0x32e390=_0x4da419[_0x3ee86c];console[_0x4d451a(0x27a)](_0x32e390),_0x4e1cba[_0x27b5ed][_0x4d451a(0x2f5)]=_0x32e390[_0x4d451a(0x203)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x251)]=_0x32e390['product_details'][_0x4d451a(0x251)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x320)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x320)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x20e)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x20e)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x2d3)]=_0x24c16d,_0x4e1cba[_0x27b5ed][_0x4d451a(0x2fb)]=_0x24c16d,_0x4e1cba[_0x27b5ed][_0x4d451a(0x226)]=_0x32e390['product_details']['unit'],_0x4e1cba[_0x27b5ed][_0x4d451a(0x1f5)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x1f5)],_0x4e1cba[_0x27b5ed]['level']=_0x32e390['product_details']['level'],_0x4e1cba[_0x27b5ed][_0x4d451a(0x222)]=_0x32e390[_0x4d451a(0x2d2)]['bay'],_0x4e1cba[_0x27b5ed][_0x4d451a(0x243)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x243)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x296)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x296)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x1e8)]=_0x32e390[_0x4d451a(0x2d2)]['maxStocks'],_0x4e1cba[_0x27b5ed][_0x4d451a(0x1e7)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x1e7)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x225)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x225)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x2ad)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x2ad)],_0x4e1cba[_0x27b5ed]['maxperunit']=_0x32e390[_0x4d451a(0x2d2)]['maxperunit'],_0x4e1cba[_0x27b5ed][_0x4d451a(0x2ca)]=_0x32e390['product_details'][_0x4d451a(0x2ca)],_0x4e1cba[_0x27b5ed]['room_name']=_0x32e390[_0x4d451a(0x25d)],_0x4e1cba[_0x27b5ed]['invoice']=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x2cb)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x317)]=_0x32e390['product_details'][_0x4d451a(0x317)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x30c)]=_0x32e390[_0x4d451a(0x2d2)][_0x4d451a(0x30c)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x295)]=_0x32e390['product_details'][_0x4d451a(0x263)],_0x4e1cba[_0x27b5ed][_0x4d451a(0x2b1)]=_0x32e390[_0x4d451a(0x2d2)]['date_recieved'],_0x4e1cba[_0x27b5ed][_0x4d451a(0x20c)]=_0x32e390['product_details']['sales'],_0x4e1cba[_0x27b5ed][_0x4d451a(0x274)]=_0x32e390['_id']['valueOf'](),_0x4e1cba[_0x27b5ed][_0x4d451a(0x25b)]=_0x32e390['product_details'][_0x4d451a(0x200)][_0x4d451a(0x2ea)](),_0x4e1cba[_0x27b5ed]['data_type']=_0x4d451a(0x261),_0x4e1cba[_0x27b5ed][_0x4d451a(0x29e)]=_0x32e390[_0x4d451a(0x2d2)]['sales'];}_0x4e1cba[_0x27b5ed][_0x4d451a(0x31f)]=_0x543668;}else for(let _0xc781fe=0x0;_0xc781fe<=_0x56f440['length']-0x1;_0xc781fe++){const _0x16a76b=_0x56f440[_0xc781fe];let _0x37bad6=_0x16a76b['split']('~');console['log'](_0x37bad6);var _0x1a1c75=_0x234526(_0x37bad6[0x0]),_0x222926=_0x234526(_0x37bad6[0x1]),_0x24c16d=_0x37bad6[0x2];const _0xec610d=await warehouse[_0x4d451a(0x2cf)]([{'$match':{'_id':_0x1a1c75}},{'$unwind':_0x4d451a(0x2f1)},{'$match':{'product_details._id':_0x222926}}]);await warehouse['updateOne']({'_id':_0x234526(_0x1a1c75),'product_details._id':_0x234526(_0x222926)},{'$set':{'product_details.$.isUsed':_0x4d451a(0x2cc)}}),_0x4e1cba[_0xc781fe]={};for(let _0x451aa1=0x0;_0x451aa1<=_0xec610d[_0x4d451a(0x246)]-0x1;_0x451aa1++){const _0x1d498c=_0xec610d[_0x451aa1];_0x4e1cba[_0xc781fe][_0x4d451a(0x2f5)]=_0x1d498c[_0x4d451a(0x203)],_0x4e1cba[_0xc781fe][_0x4d451a(0x251)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x251)],_0x4e1cba[_0xc781fe][_0x4d451a(0x320)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x320)],_0x4e1cba[_0xc781fe][_0x4d451a(0x20e)]=_0x1d498c['product_details'][_0x4d451a(0x20e)],_0x4e1cba[_0xc781fe]['product_stock']=_0x24c16d,_0x4e1cba[_0xc781fe][_0x4d451a(0x2fb)]=_0x24c16d,_0x4e1cba[_0xc781fe][_0x4d451a(0x226)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x226)],_0x4e1cba[_0xc781fe][_0x4d451a(0x1f5)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x1f5)],_0x4e1cba[_0xc781fe][_0x4d451a(0x2fe)]=_0x1d498c[_0x4d451a(0x2d2)]['level'],_0x4e1cba[_0xc781fe][_0x4d451a(0x222)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x222)],_0x4e1cba[_0xc781fe][_0x4d451a(0x243)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x243)],_0x4e1cba[_0xc781fe][_0x4d451a(0x296)]=_0x1d498c['product_details'][_0x4d451a(0x296)],_0x4e1cba[_0xc781fe]['maxStocks']=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x1e8)],_0x4e1cba[_0xc781fe][_0x4d451a(0x1e7)]=_0x1d498c['product_details'][_0x4d451a(0x1e7)],_0x4e1cba[_0xc781fe][_0x4d451a(0x225)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x225)],_0x4e1cba[_0xc781fe][_0x4d451a(0x2ad)]=_0x1d498c[_0x4d451a(0x2d2)]['production_date'],_0x4e1cba[_0xc781fe][_0x4d451a(0x215)]=_0x1d498c['product_details'][_0x4d451a(0x215)],_0x4e1cba[_0xc781fe][_0x4d451a(0x2ca)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x2ca)],_0x4e1cba[_0xc781fe][_0x4d451a(0x2bb)]=_0x1d498c['room'],_0x4e1cba[_0xc781fe][_0x4d451a(0x2cb)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x2cb)],_0x4e1cba[_0xc781fe][_0x4d451a(0x317)]=_0x1d498c[_0x4d451a(0x2d2)]['uuid'],_0x4e1cba[_0xc781fe][_0x4d451a(0x30c)]=_0x1d498c['product_details']['gross_price'],_0x4e1cba[_0xc781fe]['sales_category']=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x263)],_0x4e1cba[_0xc781fe][_0x4d451a(0x2b1)]=_0x1d498c['product_details'][_0x4d451a(0x2b1)],_0x4e1cba[_0xc781fe][_0x4d451a(0x20c)]=_0x1d498c[_0x4d451a(0x2d2)][_0x4d451a(0x263)],_0x4e1cba[_0xc781fe][_0x4d451a(0x274)]=_0x1d498c[_0x4d451a(0x200)]['valueOf'](),_0x4e1cba[_0xc781fe][_0x4d451a(0x25b)]=_0x1d498c['product_details'][_0x4d451a(0x200)][_0x4d451a(0x2ea)](),_0x4e1cba[_0xc781fe]['data_type']=_0x4d451a(0x261),_0x4e1cba[_0xc781fe][_0x4d451a(0x29e)]=_0x1d498c['product_details'][_0x4d451a(0x263)];}_0x4e1cba[_0xc781fe][_0x4d451a(0x31f)]=_0x543668;}for(let _0xa3237d=0x0;_0xa3237d<=_0x4e1cba[_0x4d451a(0x246)]-0x1;_0xa3237d++){const _0x4b58ca=_0x4e1cba[_0xa3237d],_0x2a3515=new warehouse_temporary(_0x4b58ca);await _0x2a3515[_0x4d451a(0x315)]();}const _0x10ccb1=new sales_finished({'invoice':_0x543668,'sales_data':_0x4f8e5c,'customer':_0x564036,'date':_0xf8f1e1,'warehouse_name':_0x162d58,'sale_product':_0x4e1cba,'note':_0x3b732d,'finalize':_0x4d451a(0x27f),'dateofreq':_0xa77ea4,'PO_number':_0x2ba75e,'typevehicle':_0x1667ed,'deliverydate':_0x298ca9,'driver':_0x449229,'plate':_0x134a78,'van':_0x442b23,'DRSI':_0x14dcc3,'TSU':_0x2cc9cf,'TFU':_0x100608,'pullout_date':_0x11cea2,'actualdelivery_date':_0x125bd5,'typeOfProducts':_0x4d451a(0x2d1)}),_0x4a02ae=await _0x10ccb1[_0x4d451a(0x315)]();_0x567892[_0x4d451a(0x240)](_0x4d451a(0x23f),_0x4d451a(0x1e3)),_0x4e4fa4[_0x4d451a(0x2a0)](_0x4d451a(0x2d0)+_0x4a02ae[_0x4d451a(0x200)]);}catch(_0x1ddff6){console[_0x4d451a(0x27a)](_0x1ddff6);}}),module['exports']=router;