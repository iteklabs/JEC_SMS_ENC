var a0_0x36fbec=a0_0x97a8;(function(_0x480444,_0x23facd){var _0x3185f0=a0_0x97a8,_0x25773c=_0x480444();while(!![]){try{var _0xc1078a=parseInt(_0x3185f0(0x2f4))/0x1*(-parseInt(_0x3185f0(0x2b3))/0x2)+-parseInt(_0x3185f0(0x209))/0x3+-parseInt(_0x3185f0(0x273))/0x4*(-parseInt(_0x3185f0(0x22e))/0x5)+-parseInt(_0x3185f0(0x2b7))/0x6*(-parseInt(_0x3185f0(0x2aa))/0x7)+parseInt(_0x3185f0(0x22b))/0x8*(parseInt(_0x3185f0(0x258))/0x9)+-parseInt(_0x3185f0(0x2ab))/0xa*(parseInt(_0x3185f0(0x1fe))/0xb)+parseInt(_0x3185f0(0x28f))/0xc*(parseInt(_0x3185f0(0x285))/0xd);if(_0xc1078a===_0x23facd)break;else _0x25773c['push'](_0x25773c['shift']());}catch(_0x3e6a7a){_0x25773c['push'](_0x25773c['shift']());}}}(a0_0x12a9,0x43767));function a0_0x97a8(_0x2d49d0,_0x2dca94){var _0x12a9fe=a0_0x12a9();return a0_0x97a8=function(_0x97a83a,_0x2bfa32){_0x97a83a=_0x97a83a-0x1ed;var _0x2b40fa=_0x12a9fe[_0x97a83a];return _0x2b40fa;},a0_0x97a8(_0x2d49d0,_0x2dca94);}const express=require(a0_0x36fbec(0x2cf)),app=express(),router=express[a0_0x36fbec(0x1f5)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x36fbec(0x2b5)),auth=require(a0_0x36fbec(0x1f7)),nodemailer=require(a0_0x36fbec(0x30a)),users=require('../public/language/languages.json');router[a0_0x36fbec(0x202)](a0_0x36fbec(0x2a2),auth,async(_0x3306fd,_0x4995fb)=>{var _0x17fdc3=a0_0x36fbec;try{const {username:_0x39f7b7,email:_0x19dad3,role:_0x3b0b35}=_0x3306fd[_0x17fdc3(0x1ff)],_0x28bdf4=_0x3306fd[_0x17fdc3(0x1ff)],_0x567923=await profile[_0x17fdc3(0x2bb)]({'email':_0x28bdf4['email']}),_0x2735c7=await master_shop['find']();let _0x426985;if(_0x28bdf4[_0x17fdc3(0x2d1)]==_0x17fdc3(0x28e)){const _0x3312d5=await staff[_0x17fdc3(0x2bb)]({'email':_0x28bdf4[_0x17fdc3(0x2c6)]});_0x426985=await sales_finished[_0x17fdc3(0x20e)]([{'$match':{'typeOfProducts':_0x17fdc3(0x25a)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x17fdc3(0x2ea),'invoice':{'$first':_0x17fdc3(0x294)},'customers':{'$first':'$customer'},'date':{'$first':_0x17fdc3(0x262)},'warehouse_name':{'$first':_0x17fdc3(0x21a)},'sale_product':{'$push':_0x17fdc3(0x205)},'note':{'$first':_0x17fdc3(0x2a0)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x17fdc3(0x318)},'total_saleproduct_quantity':{'$sum':_0x17fdc3(0x2db)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x17fdc3(0x270)},'type':{'$addToSet':_0x17fdc3(0x276)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x17fdc3(0x251)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x426985=await sales_finished[_0x17fdc3(0x20e)]([{'$match':{'typeOfProducts':_0x17fdc3(0x25a)}},{'$unwind':_0x17fdc3(0x205)},{'$group':{'_id':'$_id','invoice':{'$first':_0x17fdc3(0x294)},'customers':{'$first':'$customer'},'date':{'$first':_0x17fdc3(0x262)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x17fdc3(0x205)},'note':{'$first':_0x17fdc3(0x2a0)},'return_data':{'$first':_0x17fdc3(0x241)},'customers_docs':{'$first':_0x17fdc3(0x318)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x17fdc3(0x1f0)},'isle':{'$addToSet':_0x17fdc3(0x270)},'type':{'$addToSet':_0x17fdc3(0x276)},'pallet':{'$addToSet':_0x17fdc3(0x27e)},'finalize':{'$first':_0x17fdc3(0x251)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x2735c7[0x0]['language']=='English\x20(US)'){var _0x9a9c15=users[_0x17fdc3(0x261)];console[_0x17fdc3(0x269)](_0x9a9c15);}else{if(_0x2735c7[0x0][_0x17fdc3(0x2b9)]=='Hindi')var _0x9a9c15=users[_0x17fdc3(0x21f)];else{if(_0x2735c7[0x0][_0x17fdc3(0x2b9)]=='German')var _0x9a9c15=users['German'];else{if(_0x2735c7[0x0][_0x17fdc3(0x2b9)]==_0x17fdc3(0x267))var _0x9a9c15=users[_0x17fdc3(0x267)];else{if(_0x2735c7[0x0]['language']==_0x17fdc3(0x248))var _0x9a9c15=users['French'];else{if(_0x2735c7[0x0][_0x17fdc3(0x2b9)]==_0x17fdc3(0x29a))var _0x9a9c15=users['Portuguese'];else{if(_0x2735c7[0x0][_0x17fdc3(0x2b9)]==_0x17fdc3(0x2c3))var _0x9a9c15=users[_0x17fdc3(0x2c3)];else{if(_0x2735c7[0x0]['language']==_0x17fdc3(0x2ac))var _0x9a9c15=users[_0x17fdc3(0x25f)];}}}}}}}_0x4995fb['render'](_0x17fdc3(0x20c),{'success':_0x3306fd['flash']('success'),'errors':_0x3306fd[_0x17fdc3(0x28d)](_0x17fdc3(0x2b1)),'sales':_0x426985,'profile':_0x567923,'role':_0x28bdf4,'master_shop':_0x2735c7,'language':_0x9a9c15});}catch(_0x21d411){console[_0x17fdc3(0x269)](_0x21d411);}}),router[a0_0x36fbec(0x202)]('/view_log',auth,async(_0x499d4d,_0x1e4825)=>{var _0x369d61=a0_0x36fbec;try{const {username:_0x208a5a,email:_0x56297a,role:_0x280a58}=_0x499d4d['user'],_0x2068c2=_0x499d4d['user'],_0x41c01a=await profile[_0x369d61(0x2bb)]({'email':_0x2068c2[_0x369d61(0x2c6)]}),_0x4b5832=await master_shop[_0x369d61(0x25c)]();let _0x391419;if(_0x2068c2[_0x369d61(0x2d1)]==_0x369d61(0x28e)){const _0x2f86b7=await staff[_0x369d61(0x2bb)]({'email':_0x2068c2[_0x369d61(0x2c6)]});_0x391419=await sales_finished[_0x369d61(0x20e)]([{'$match':{'typeOfProducts':'logs'}},{'$unwind':_0x369d61(0x205)},{'$group':{'_id':_0x369d61(0x2ea),'invoice':{'$first':_0x369d61(0x294)},'customers':{'$first':_0x369d61(0x226)},'date':{'$first':_0x369d61(0x262)},'warehouse_name':{'$first':_0x369d61(0x21a)},'sale_product':{'$push':_0x369d61(0x205)},'note':{'$first':'$note'},'return_data':{'$first':_0x369d61(0x241)},'customers_docs':{'$first':_0x369d61(0x318)},'total_saleproduct_quantity':{'$sum':_0x369d61(0x2db)},'level':{'$addToSet':_0x369d61(0x1f0)},'isle':{'$addToSet':_0x369d61(0x270)},'type':{'$addToSet':_0x369d61(0x276)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x369d61(0x251)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x391419=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x369d61(0x30e)}},{'$unwind':_0x369d61(0x205)},{'$group':{'_id':_0x369d61(0x2ea),'invoice':{'$first':_0x369d61(0x294)},'customers':{'$first':_0x369d61(0x226)},'date':{'$first':_0x369d61(0x262)},'warehouse_name':{'$first':_0x369d61(0x21a)},'sale_product':{'$push':_0x369d61(0x205)},'note':{'$first':_0x369d61(0x2a0)},'return_data':{'$first':_0x369d61(0x241)},'customers_docs':{'$first':_0x369d61(0x318)},'total_saleproduct_quantity':{'$sum':_0x369d61(0x2db)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x369d61(0x276)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x369d61(0x251)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x4b5832[0x0][_0x369d61(0x2b9)]==_0x369d61(0x312)){var _0x22161c=users[_0x369d61(0x261)];console[_0x369d61(0x269)](_0x22161c);}else{if(_0x4b5832[0x0][_0x369d61(0x2b9)]=='Hindi')var _0x22161c=users['Hindi'];else{if(_0x4b5832[0x0][_0x369d61(0x2b9)]==_0x369d61(0x246))var _0x22161c=users['German'];else{if(_0x4b5832[0x0][_0x369d61(0x2b9)]==_0x369d61(0x267))var _0x22161c=users[_0x369d61(0x267)];else{if(_0x4b5832[0x0]['language']=='French')var _0x22161c=users[_0x369d61(0x248)];else{if(_0x4b5832[0x0][_0x369d61(0x2b9)]==_0x369d61(0x29a))var _0x22161c=users['Portuguese'];else{if(_0x4b5832[0x0][_0x369d61(0x2b9)]=='Chinese')var _0x22161c=users['Chinese'];else{if(_0x4b5832[0x0]['language']==_0x369d61(0x2ac))var _0x22161c=users[_0x369d61(0x25f)];}}}}}}}_0x1e4825[_0x369d61(0x242)]('all_sales_finished_logs',{'success':_0x499d4d[_0x369d61(0x28d)](_0x369d61(0x257)),'errors':_0x499d4d[_0x369d61(0x28d)](_0x369d61(0x2b1)),'sales':_0x391419,'profile':_0x41c01a,'role':_0x2068c2,'master_shop':_0x4b5832,'language':_0x22161c});}catch(_0x27b1b9){console[_0x369d61(0x269)](_0x27b1b9);}});async function getRandom8DigitNumber(){var _0x12ed90=a0_0x36fbec;const _0x1f3720=0x989680,_0x538abb=0x5f5e0ff,_0x4d9696=Math['floor'](Math[_0x12ed90(0x295)]()*(_0x538abb-_0x1f3720+0x1))+_0x1f3720;var _0x52e1a2;const _0x3594d9=await sales_finished[_0x12ed90(0x2bb)]({'invoice':'OUTF-'+_0x4d9696});return _0x3594d9&&_0x3594d9[_0x12ed90(0x2ef)]>0x0?_0x52e1a2=_0x12ed90(0x29e)+_0x4d9696:_0x52e1a2=_0x12ed90(0x29e)+_0x4d9696,_0x52e1a2;}router[a0_0x36fbec(0x202)](a0_0x36fbec(0x24f),auth,async(_0x4ebae8,_0x2047a3)=>{var _0x1dc1c6=a0_0x36fbec;try{const {username:_0x3f5508,email:_0x4dcaaf,role:_0x3308ef}=_0x4ebae8[_0x1dc1c6(0x1ff)],_0x374823=_0x4ebae8[_0x1dc1c6(0x1ff)],_0x332d4c=await profile['findOne']({'email':_0x374823['email']}),_0x21344c=await master_shop[_0x1dc1c6(0x25c)](),_0x3a1b35=await customer[_0x1dc1c6(0x25c)]({});let _0x206047;if(_0x374823[_0x1dc1c6(0x2d1)]=='staff'){const _0x26bcf9=await staff['findOne']({'email':_0x374823['email']});_0x206047=await warehouse[_0x1dc1c6(0x20e)]([{'$match':{'status':'Enabled','name':_0x26bcf9[_0x1dc1c6(0x247)]}},{'$group':{'_id':_0x1dc1c6(0x230),'name':{'$first':_0x1dc1c6(0x230)}}},{'$sort':{'name':0x1}}]);}else _0x206047=await warehouse[_0x1dc1c6(0x20e)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x1dc1c6(0x230),'name':{'$first':_0x1dc1c6(0x230)}}},{'$sort':{'name':0x1}}]);const _0xfd8ede=await product[_0x1dc1c6(0x25c)]({});var _0x2863f3=[_0x1dc1c6(0x2b2),_0x1dc1c6(0x218)];const _0x346c25=await sales_finished[_0x1dc1c6(0x25c)]({}),_0x4856e0=_0x346c25['length']+0x1,_0x1742d9='OUTF-'+_0x4856e0['toString']()[_0x1dc1c6(0x2c2)](0x5,'0');if(_0x21344c[0x0][_0x1dc1c6(0x2b9)]=='English\x20(US)'){var _0x839c39=users[_0x1dc1c6(0x261)];console['log'](_0x839c39);}else{if(_0x21344c[0x0][_0x1dc1c6(0x2b9)]=='Hindi')var _0x839c39=users['Hindi'];else{if(_0x21344c[0x0][_0x1dc1c6(0x2b9)]==_0x1dc1c6(0x246))var _0x839c39=users[_0x1dc1c6(0x246)];else{if(_0x21344c[0x0][_0x1dc1c6(0x2b9)]==_0x1dc1c6(0x267))var _0x839c39=users['Spanish'];else{if(_0x21344c[0x0][_0x1dc1c6(0x2b9)]==_0x1dc1c6(0x248))var _0x839c39=users[_0x1dc1c6(0x248)];else{if(_0x21344c[0x0][_0x1dc1c6(0x2b9)]==_0x1dc1c6(0x29a))var _0x839c39=users['Portuguese'];else{if(_0x21344c[0x0]['language']==_0x1dc1c6(0x2c3))var _0x839c39=users[_0x1dc1c6(0x2c3)];else{if(_0x21344c[0x0][_0x1dc1c6(0x2b9)]==_0x1dc1c6(0x2ac))var _0x839c39=users[_0x1dc1c6(0x25f)];}}}}}}}const _0x452f7f=getRandom8DigitNumber();_0x452f7f[_0x1dc1c6(0x210)](_0x348590=>{var _0x537cbf=_0x1dc1c6;_0x2047a3[_0x537cbf(0x242)](_0x537cbf(0x20d),{'success':_0x4ebae8['flash'](_0x537cbf(0x257)),'errors':_0x4ebae8['flash']('errors'),'role':_0x374823,'profile':_0x332d4c,'customer':_0x3a1b35,'warehouse':_0x206047,'product':_0xfd8ede,'invoice':_0x348590,'master_shop':_0x21344c,'language':_0x839c39,'rooms_data':_0x2863f3});})[_0x1dc1c6(0x280)](_0x352290=>{var _0x4f6105=_0x1dc1c6;_0x4ebae8[_0x4f6105(0x28d)](_0x4f6105(0x2b1),_0x4f6105(0x2e1)),_0x2047a3[_0x4f6105(0x2cd)](_0x4f6105(0x2c8));});}catch(_0x47ce8b){console['log'](_0x47ce8b);}}),router[a0_0x36fbec(0x202)](a0_0x36fbec(0x225),auth,async(_0x3ff1ac,_0x243173)=>{var _0x2bd63e=a0_0x36fbec;try{const {username:_0x1d5297,email:_0x46c6f2,role:_0x246753}=_0x3ff1ac[_0x2bd63e(0x1ff)],_0x5096ce=_0x3ff1ac[_0x2bd63e(0x1ff)],_0x2f47f5=await profile[_0x2bd63e(0x2bb)]({'email':_0x5096ce['email']}),_0x520a9e=await master_shop[_0x2bd63e(0x25c)](),_0x2af785=await customer[_0x2bd63e(0x25c)]({});let _0x7c20fa;if(_0x5096ce[_0x2bd63e(0x2d1)]==_0x2bd63e(0x28e)){const _0x5adc3b=await staff[_0x2bd63e(0x2bb)]({'email':_0x5096ce[_0x2bd63e(0x2c6)]});_0x7c20fa=await warehouse['aggregate']([{'$match':{'status':_0x2bd63e(0x20b),'name':_0x5adc3b[_0x2bd63e(0x247)]}},{'$group':{'_id':_0x2bd63e(0x230),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x7c20fa=await warehouse[_0x2bd63e(0x20e)]([{'$match':{'status':_0x2bd63e(0x20b)}},{'$group':{'_id':_0x2bd63e(0x230),'name':{'$first':_0x2bd63e(0x230)}}},{'$sort':{'name':0x1}}]);const _0x597024=await product[_0x2bd63e(0x25c)]({});var _0x49b57a=[_0x2bd63e(0x2b2),_0x2bd63e(0x218)];const _0x36eda0=await sales_finished[_0x2bd63e(0x25c)]({}),_0x217f90=_0x36eda0[_0x2bd63e(0x2ef)]+0x1,_0x5293ec='OUTF-'+_0x217f90[_0x2bd63e(0x223)]()[_0x2bd63e(0x2c2)](0x5,'0');if(_0x520a9e[0x0][_0x2bd63e(0x2b9)]==_0x2bd63e(0x312)){var _0x2d5c8d=users[_0x2bd63e(0x261)];console[_0x2bd63e(0x269)](_0x2d5c8d);}else{if(_0x520a9e[0x0]['language']==_0x2bd63e(0x21f))var _0x2d5c8d=users[_0x2bd63e(0x21f)];else{if(_0x520a9e[0x0][_0x2bd63e(0x2b9)]==_0x2bd63e(0x246))var _0x2d5c8d=users[_0x2bd63e(0x246)];else{if(_0x520a9e[0x0][_0x2bd63e(0x2b9)]==_0x2bd63e(0x267))var _0x2d5c8d=users[_0x2bd63e(0x267)];else{if(_0x520a9e[0x0][_0x2bd63e(0x2b9)]==_0x2bd63e(0x248))var _0x2d5c8d=users[_0x2bd63e(0x248)];else{if(_0x520a9e[0x0]['language']==_0x2bd63e(0x29a))var _0x2d5c8d=users['Portuguese'];else{if(_0x520a9e[0x0][_0x2bd63e(0x2b9)]==_0x2bd63e(0x2c3))var _0x2d5c8d=users[_0x2bd63e(0x2c3)];else{if(_0x520a9e[0x0][_0x2bd63e(0x2b9)]=='Arabic\x20(ae)')var _0x2d5c8d=users['Arabic'];}}}}}}}const _0x312cb3=getRandom8DigitNumber();_0x312cb3['then'](_0x344036=>{var _0x16b50d=_0x2bd63e;_0x243173['render'](_0x16b50d(0x2e9),{'success':_0x3ff1ac[_0x16b50d(0x28d)]('success'),'errors':_0x3ff1ac['flash'](_0x16b50d(0x2b1)),'role':_0x5096ce,'profile':_0x2f47f5,'customer':_0x2af785,'warehouse':_0x7c20fa,'product':_0x597024,'invoice':_0x344036,'master_shop':_0x520a9e,'language':_0x2d5c8d,'rooms_data':_0x49b57a});})[_0x2bd63e(0x280)](_0x1b4045=>{var _0x598cbd=_0x2bd63e;_0x3ff1ac['flash'](_0x598cbd(0x2b1),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x243173[_0x598cbd(0x2cd)](_0x598cbd(0x2c8));});}catch(_0x1844a9){console[_0x2bd63e(0x269)](_0x1844a9);}}),router['post'](a0_0x36fbec(0x225),auth,async(_0x2420fe,_0x5ed255)=>{var _0x3d2b2d=a0_0x36fbec;try{const {invoice:_0x27927d,date:_0x370449,warehouse_name:_0x37d523,product_name:_0xdd3a24,note:_0x124c62,room:_0x137bd9,primary_code:_0x3439ad,secondary_code:_0x59694d,prod_code:_0x1a2df1,SCRN:_0x975186,ReqBy:_0x11b520,dateofreq:_0x8c6605,PO_number:_0x1e2647,typeservicesData:_0x4c6e70,typevehicle:_0x5b0365,destination:_0x1c2a0e,deliverydate:_0x5c25a8,driver:_0x40419a,plate:_0x5ba904,van:_0x1ecac3,DRSI:_0x42f4d4,TSU:_0x4fa73f,TFU:_0x531a08,mode_transpo:_0x5ce056,name_driver:_0x4acb3e,type_of_products:_0x498554}=_0x2420fe[_0x3d2b2d(0x2be)];if(typeof _0xdd3a24==_0x3d2b2d(0x213))var _0x24351c=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x29f)]],_0x19f46f=[_0x2420fe[_0x3d2b2d(0x2be)]['stock']],_0x5028d2=[_0x2420fe[_0x3d2b2d(0x2be)]['carton']],_0x11c474=[_0x2420fe[_0x3d2b2d(0x2be)]['primary_code']],_0x1efa66=[_0x2420fe[_0x3d2b2d(0x2be)]['secondary_code']],_0x4fd109=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x315)]],_0x402f13=[_0x2420fe['body'][_0x3d2b2d(0x264)]],_0xd2abf1=[_0x2420fe[_0x3d2b2d(0x2be)]['primary_unit']],_0x10a752=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x217)]],_0x2f34c8=[_0x2420fe[_0x3d2b2d(0x2be)]['batch_code']],_0x12b042=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x26f)]],_0x2c47d0=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x2b4)]],_0x3a0d79=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x263)]],_0x2465af=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x2d2)]],_0x3839e4=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x220)]],_0x5dc6b1=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x231)]],_0x15ce7b=[_0x2420fe[_0x3d2b2d(0x2be)]['id_transaction_from']],_0x4f1815=[_0x2420fe[_0x3d2b2d(0x2be)]['uuid']],_0x37245f=[_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x2c7)]];else var _0x24351c=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x29f)]],_0x19f46f=[..._0x2420fe['body'][_0x3d2b2d(0x228)]],_0x5028d2=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x204)]],_0x11c474=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x23f)]],_0x1efa66=[..._0x2420fe['body']['secondary_code']],_0x4fd109=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x315)]],_0x402f13=[..._0x2420fe[_0x3d2b2d(0x2be)]['level2']],_0xd2abf1=[..._0x2420fe[_0x3d2b2d(0x2be)]['primary_unit']],_0x10a752=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x217)]],_0x2f34c8=[..._0x2420fe[_0x3d2b2d(0x2be)]['batch_code']],_0x12b042=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x26f)]],_0x2c47d0=[..._0x2420fe['body'][_0x3d2b2d(0x2b4)]],_0x3a0d79=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x263)]],_0x2465af=[..._0x2420fe['body'][_0x3d2b2d(0x2d2)]],_0x3839e4=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x220)]],_0x5dc6b1=[..._0x2420fe['body']['prod_invoice']],_0x15ce7b=[..._0x2420fe['body'][_0x3d2b2d(0x2a6)]],_0x4f1815=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x296)]],_0x37245f=[..._0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x2c7)]];const _0x2c0033=_0x24351c[_0x3d2b2d(0x23a)](_0x7fec6=>{return _0x7fec6={'product_name':_0x7fec6};});_0x19f46f[_0x3d2b2d(0x2bd)]((_0x534791,_0x204b6c)=>{var _0x33c956=_0x3d2b2d;_0x2c0033[_0x204b6c][_0x33c956(0x228)]=_0x534791;}),_0x5028d2[_0x3d2b2d(0x2bd)]((_0x66f44b,_0x5825f4)=>{var _0x30169c=_0x3d2b2d;_0x2c0033[_0x5825f4]['quantity']=Math[_0x30169c(0x2da)](_0x66f44b);}),_0x24351c[_0x3d2b2d(0x2bd)]((_0x5e7a19,_0x5464ed)=>{var _0x56d582=_0x3d2b2d;_0x2c0033[_0x5464ed]['agent_id']=_0x2420fe[_0x56d582(0x2be)][_0x56d582(0x254)];}),_0x37245f['forEach']((_0x4fad75,_0x285691)=>{var _0x221dc0=_0x3d2b2d;_0x2c0033[_0x285691][_0x221dc0(0x2c7)]=_0x4fad75;}),_0x4f1815[_0x3d2b2d(0x2bd)]((_0x112e72,_0x73667a)=>{var _0x16e37b=_0x3d2b2d;_0x2c0033[_0x73667a][_0x16e37b(0x296)]=_0x112e72;}),_0x15ce7b[_0x3d2b2d(0x2bd)]((_0x383091,_0x28f18a)=>{var _0x45eceb=_0x3d2b2d;_0x2c0033[_0x28f18a][_0x45eceb(0x2a6)]=_0x383091;}),_0x11c474['forEach']((_0x1217af,_0x1e8b58)=>{var _0x4ec108=_0x3d2b2d;_0x2c0033[_0x1e8b58][_0x4ec108(0x23f)]=_0x1217af;}),_0x1efa66[_0x3d2b2d(0x2bd)]((_0x34ac36,_0x1f296e)=>{var _0x212c19=_0x3d2b2d;_0x2c0033[_0x1f296e][_0x212c19(0x236)]=_0x34ac36;}),_0x4fd109[_0x3d2b2d(0x2bd)]((_0x2eb436,_0x4aaaeb)=>{_0x2c0033[_0x4aaaeb]['product_code']=_0x2eb436;}),_0x402f13[_0x3d2b2d(0x2bd)]((_0x1e683f,_0x1effab)=>{var _0x2fefec=_0x3d2b2d,_0x3efdd7=_0x1e683f[_0x2fefec(0x2d0)](/[A-Za-z]+/)[0x0],_0x2ae8b6=parseInt(_0x1e683f[_0x2fefec(0x2d0)](/\d+/)[0x0]);_0x2c0033[_0x1effab][_0x2fefec(0x2bf)]=_0x2ae8b6,_0x2c0033[_0x1effab][_0x2fefec(0x1fb)]=_0x3efdd7;}),_0xd2abf1[_0x3d2b2d(0x2bd)]((_0x28208b,_0x3ae5cf)=>{var _0x432822=_0x3d2b2d;_0x2c0033[_0x3ae5cf][_0x432822(0x2e2)]=_0x28208b;}),_0x10a752[_0x3d2b2d(0x2bd)]((_0x48f714,_0x3e8c56)=>{_0x2c0033[_0x3e8c56]['secondary_unit']=_0x48f714;}),_0x2f34c8['forEach']((_0xe22dcc,_0x138462)=>{var _0x42a4de=_0x3d2b2d;_0x2c0033[_0x138462][_0x42a4de(0x1fa)]=_0xe22dcc;}),_0x12b042[_0x3d2b2d(0x2bd)]((_0x517b8d,_0x465abf)=>{var _0xf95097=_0x3d2b2d;_0x2c0033[_0x465abf][_0xf95097(0x26f)]=_0x517b8d;}),_0x2c47d0[_0x3d2b2d(0x2bd)]((_0x19b417,_0x118b04)=>{var _0x2a81eb=_0x3d2b2d;_0x2c0033[_0x118b04][_0x2a81eb(0x249)]=_0x19b417;}),_0x3a0d79[_0x3d2b2d(0x2bd)]((_0x4f8f5e,_0x2126ca)=>{var _0x391173=_0x3d2b2d;_0x2c0033[_0x2126ca][_0x391173(0x22a)]=_0x4f8f5e;}),_0x2465af['forEach']((_0xe45ac4,_0x5c6369)=>{var _0x24e198=_0x3d2b2d;_0x2c0033[_0x5c6369][_0x24e198(0x2d2)]=_0xe45ac4;}),_0x3839e4[_0x3d2b2d(0x2bd)]((_0x3161a2,_0x45d110)=>{var _0x446e19=_0x3d2b2d;_0x2c0033[_0x45d110][_0x446e19(0x30f)]=_0x3161a2;}),_0x5dc6b1['forEach']((_0x5e7ce7,_0x70b2e7)=>{var _0xe88cb=_0x3d2b2d;_0x2c0033[_0x70b2e7][_0xe88cb(0x2e7)]=_0x5e7ce7,_0x2c0033[_0x70b2e7][_0xe88cb(0x23b)]=_0x370449;});const _0x22fcbd=new sales_logs();await _0x22fcbd[_0x3d2b2d(0x305)](),_0x5dc6b1['forEach']((_0xe8354d,_0x4a2dbe)=>{var _0x70c08b=_0x3d2b2d;_0x2c0033[_0x4a2dbe]['outgoing_invoice']='LOG-OUT-'+_0x22fcbd[_0x70c08b(0x2fc)]['toString']()['padStart'](0x8,'0');});var _0x53fcaf=0x0;_0x2c0033['forEach'](_0x5218de=>{var _0x5e1da0=_0x3d2b2d;parseFloat(_0x5218de[_0x5e1da0(0x228)])<parseFloat(_0x5218de[_0x5e1da0(0x2ca)])&&parseFloat(_0x5218de[_0x5e1da0(0x2ca)])>parseFloat(_0x5218de[_0x5e1da0(0x228)])&&(console['log'](_0x5218de[_0x5e1da0(0x228)]+_0x5e1da0(0x2f1)+_0x5218de[_0x5e1da0(0x2ca)]),_0x53fcaf++);});if(_0x53fcaf!=0x0)return _0x2420fe[_0x3d2b2d(0x28d)](_0x3d2b2d(0x2b1),_0x3d2b2d(0x317)),_0x5ed255[_0x3d2b2d(0x2cd)](_0x3d2b2d(0x1fd));const _0x121f34=_0x2c0033[_0x3d2b2d(0x290)](_0x8dd5f5=>_0x8dd5f5['quantity']!=='0'&&_0x8dd5f5['quantity']!==''),_0x4a88fa=new sales_finished({'invoice':_0x3d2b2d(0x253)+_0x22fcbd[_0x3d2b2d(0x2fc)][_0x3d2b2d(0x223)]()[_0x3d2b2d(0x2c2)](0x8,'0'),'sales_data':_0x2420fe['body']['sales'],'customer':_0x2420fe[_0x3d2b2d(0x2be)][_0x3d2b2d(0x240)],'date':_0x370449,'warehouse_name':_0x37d523,'sale_product':_0x121f34,'note':_0x124c62,'room':_0x137bd9,'primary_code':_0x3439ad,'secondary_code':_0x59694d,'prod_code':_0x1a2df1,'SCRN':_0x975186,'finalize':_0x3d2b2d(0x30c),'mode_transpo':_0x5ce056,'name_driver':_0x4acb3e,'ReqBy':_0x11b520,'dateofreq':_0x8c6605,'PO_number':_0x1e2647,'typeservicesData':_0x4c6e70,'typevehicle':_0x5b0365,'destination':_0x1c2a0e,'deliverydate':_0x5c25a8,'driver':_0x40419a,'plate':_0x5ba904,'van':_0x1ecac3,'DRSI':_0x42f4d4,'TSU':_0x4fa73f,'TFU':_0x531a08,'typeOfProducts':_0x498554}),_0x59999a=await _0x4a88fa[_0x3d2b2d(0x305)](),_0x3abe1a=await sales_finished[_0x3d2b2d(0x2bb)]({'invoice':_0x27927d});_0x2420fe['flash'](_0x3d2b2d(0x257),_0x3d2b2d(0x301)),_0x5ed255[_0x3d2b2d(0x2cd)](_0x3d2b2d(0x2d6)+_0x59999a[_0x3d2b2d(0x238)]);}catch(_0x1b05a0){console[_0x3d2b2d(0x269)](_0x1b05a0);}}),router[a0_0x36fbec(0x202)](a0_0x36fbec(0x2f7),auth,async(_0x16b9c0,_0x1080ab)=>{var _0xb7bb44=a0_0x36fbec;try{const _0x4dc5a8=_0x16b9c0['params']['id'];console[_0xb7bb44(0x269)](_0x4dc5a8);const _0x33ac60=await product[_0xb7bb44(0x25c)](),_0x4a733c=await purchases[_0xb7bb44(0x20e)]([{'$match':{'warehouse_name':_0x4dc5a8}},{'$unwind':_0xb7bb44(0x297)},{'$group':{'_id':_0xb7bb44(0x2b8)}}]);console[_0xb7bb44(0x269)](_0xb7bb44(0x207),_0x4a733c),_0x1080ab['status'](0xc8)[_0xb7bb44(0x24a)]({'purchases_data':_0x4a733c,'product_data':_0x33ac60});}catch(_0x1648a1){console[_0xb7bb44(0x269)](_0x1648a1);}}),router[a0_0x36fbec(0x2e4)](a0_0x36fbec(0x239),auth,async(_0x231ade,_0x40b744)=>{var _0x2b4bed=a0_0x36fbec;try{const {warehouse_data:_0x3258c9,product_data:_0x151e9b}=_0x231ade['body'];console['log'](_0x231ade[_0x2b4bed(0x2be)][_0x2b4bed(0x1ee)]);;const _0x57c8d6=await master_shop[_0x2b4bed(0x25c)]();console[_0x2b4bed(0x269)](_0x2b4bed(0x2b6),_0x57c8d6);const _0x54728f=await product[_0x2b4bed(0x2bb)]({'name':_0x151e9b});console['log'](_0x2b4bed(0x2bc),_0x54728f);const _0x46b59b=await warehouse[_0x2b4bed(0x20e)]([{'$match':{'name':_0x3258c9}},{'$unwind':_0x2b4bed(0x21e)},{'$match':{'product_details.product_name':_0x151e9b}},{'$group':{'_id':_0x2b4bed(0x24c),'product_stock':{'$first':_0x2b4bed(0x215)}}}]);console[_0x2b4bed(0x269)](_0x2b4bed(0x243),_0x46b59b),_0x40b744[_0x2b4bed(0x21d)](0xc8)['json']({'master':_0x57c8d6,'new_product':_0x54728f,'stock_data':_0x46b59b});}catch(_0x1a8ecf){console[_0x2b4bed(0x269)](_0x1a8ecf);}}),router[a0_0x36fbec(0x2e4)](a0_0x36fbec(0x24f),auth,async(_0x14883d,_0x5818a7)=>{var _0x4a4004=a0_0x36fbec;try{const {invoice:_0x2b558d,date:_0x46b3da,warehouse_name:_0x55c9ec,product_name:_0x314810,note:_0x4e8825,room:_0x5cc770,primary_code:_0x56257e,secondary_code:_0x5a75d5,prod_code:_0x28ed01,SCRN:_0x2779ef,ReqBy:_0x1c497f,dateofreq:_0x1191bd,PO_number:_0x2054e7,typeservicesData:_0x46b7d7,typevehicle:_0x29c2a2,destination:_0x21b1c5,deliverydate:_0x2a3656,driver:_0x54fcd2,plate:_0x138bfa,van:_0x17055f,DRSI:_0x5cd39c,TSU:_0x1c4230,TFU:_0x9414e2,mode_transpo:_0x304ae1,name_driver:_0x42cf36,pull_out_date:_0x803840,actual_delivery_date:_0x543bf8}=_0x14883d[_0x4a4004(0x2be)];if(typeof _0x314810==_0x4a4004(0x213))var _0x234cb1=[_0x14883d['body'][_0x4a4004(0x29f)]],_0x44b23d=[_0x14883d[_0x4a4004(0x2be)]['stock']],_0x2a3a9f=[_0x14883d['body'][_0x4a4004(0x204)]],_0x425f87=[_0x14883d[_0x4a4004(0x2be)]['primary_code']],_0x35a771=[_0x14883d[_0x4a4004(0x2be)]['secondary_code']],_0x3b9ac1=[_0x14883d['body'][_0x4a4004(0x315)]],_0x51a39a=[_0x14883d['body'][_0x4a4004(0x264)]],_0x1469ce=[_0x14883d['body'][_0x4a4004(0x24b)]],_0x151f92=[_0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x217)]],_0x1973ea=[_0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x1fa)]],_0x434b04=[_0x14883d['body'][_0x4a4004(0x26f)]],_0x1d857f=[_0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x2b4)]],_0x309004=[_0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x263)]],_0x81e46e=[_0x14883d['body'][_0x4a4004(0x2d2)]],_0x56fad9=[_0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x220)]],_0x94e559=[_0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x231)]],_0x4373e3=[_0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x2a6)]],_0x21d8ac=[_0x14883d[_0x4a4004(0x2be)]['uuid']],_0x392d1f=[_0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x2c7)]];else var _0x234cb1=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x29f)]],_0x44b23d=[..._0x14883d['body']['stock']],_0x2a3a9f=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x204)]],_0x425f87=[..._0x14883d[_0x4a4004(0x2be)]['primary_code']],_0x35a771=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x236)]],_0x3b9ac1=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x315)]],_0x51a39a=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x264)]],_0x1469ce=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x24b)]],_0x151f92=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x217)]],_0x1973ea=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x1fa)]],_0x434b04=[..._0x14883d['body'][_0x4a4004(0x26f)]],_0x1d857f=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x2b4)]],_0x309004=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x263)]],_0x81e46e=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x2d2)]],_0x56fad9=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x220)]],_0x94e559=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x231)]],_0x4373e3=[..._0x14883d[_0x4a4004(0x2be)][_0x4a4004(0x2a6)]],_0x21d8ac=[..._0x14883d[_0x4a4004(0x2be)]['uuid']],_0x392d1f=[..._0x14883d[_0x4a4004(0x2be)]['gross_price']];const _0x456f41=_0x234cb1[_0x4a4004(0x23a)](_0x229d3b=>{return _0x229d3b={'product_name':_0x229d3b};});_0x44b23d[_0x4a4004(0x2bd)]((_0x21ed5e,_0x1e6cf1)=>{var _0xa03199=_0x4a4004;_0x456f41[_0x1e6cf1][_0xa03199(0x228)]=_0x21ed5e;}),_0x2a3a9f[_0x4a4004(0x2bd)]((_0x1867a9,_0x541ac7)=>{var _0x164863=_0x4a4004;_0x456f41[_0x541ac7][_0x164863(0x2ca)]=Math[_0x164863(0x2da)](_0x1867a9);}),_0x234cb1[_0x4a4004(0x2bd)]((_0x1f4b98,_0x26c806)=>{var _0x371292=_0x4a4004;_0x456f41[_0x26c806][_0x371292(0x300)]=_0x14883d[_0x371292(0x2be)]['sales'];}),_0x392d1f['forEach']((_0x3ca88d,_0x57b77a)=>{var _0x568d83=_0x4a4004;_0x456f41[_0x57b77a][_0x568d83(0x2c7)]=_0x3ca88d;}),_0x21d8ac[_0x4a4004(0x2bd)]((_0x3298c8,_0x5f541b)=>{var _0x31287a=_0x4a4004;_0x456f41[_0x5f541b][_0x31287a(0x296)]=_0x3298c8;}),_0x4373e3['forEach']((_0x14d4ba,_0x44792f)=>{_0x456f41[_0x44792f]['id_transaction_from']=_0x14d4ba;}),_0x425f87[_0x4a4004(0x2bd)]((_0x20f140,_0x454bce)=>{var _0x183641=_0x4a4004;_0x456f41[_0x454bce][_0x183641(0x23f)]=_0x20f140;}),_0x35a771[_0x4a4004(0x2bd)]((_0x5d8925,_0x5ccd02)=>{var _0xd441b=_0x4a4004;_0x456f41[_0x5ccd02][_0xd441b(0x236)]=_0x5d8925;}),_0x3b9ac1['forEach']((_0x53e630,_0x187d93)=>{var _0x89a1b7=_0x4a4004;_0x456f41[_0x187d93][_0x89a1b7(0x27c)]=_0x53e630;}),_0x51a39a[_0x4a4004(0x2bd)]((_0x1bfb2f,_0x384c5e)=>{var _0x55f058=_0x4a4004,_0xc99da5=_0x1bfb2f[_0x55f058(0x2d0)](/[A-Za-z]+/)[0x0],_0x1aa008=parseInt(_0x1bfb2f[_0x55f058(0x2d0)](/\d+/)[0x0]);_0x456f41[_0x384c5e]['bay']=_0x1aa008,_0x456f41[_0x384c5e][_0x55f058(0x1fb)]=_0xc99da5;}),_0x1469ce[_0x4a4004(0x2bd)]((_0x25b873,_0x262a3d)=>{var _0x172f21=_0x4a4004;_0x456f41[_0x262a3d][_0x172f21(0x2e2)]=_0x25b873;}),_0x151f92[_0x4a4004(0x2bd)]((_0x16311a,_0x5ed671)=>{var _0x3da042=_0x4a4004;_0x456f41[_0x5ed671][_0x3da042(0x217)]=_0x16311a;}),_0x1973ea[_0x4a4004(0x2bd)]((_0x286316,_0xd5ca0a)=>{var _0x4d4e02=_0x4a4004;_0x456f41[_0xd5ca0a][_0x4d4e02(0x1fa)]=_0x286316;}),_0x434b04[_0x4a4004(0x2bd)]((_0x2f7c27,_0x5b8606)=>{var _0x1f727d=_0x4a4004;_0x456f41[_0x5b8606][_0x1f727d(0x26f)]=_0x2f7c27;}),_0x1d857f[_0x4a4004(0x2bd)]((_0x120263,_0x1fb35a)=>{var _0x46ee7c=_0x4a4004;_0x456f41[_0x1fb35a][_0x46ee7c(0x249)]=_0x120263;}),_0x309004[_0x4a4004(0x2bd)]((_0x41403f,_0x2819fa)=>{var _0xc92807=_0x4a4004;_0x456f41[_0x2819fa][_0xc92807(0x22a)]=_0x41403f;}),_0x81e46e['forEach']((_0x518d06,_0x337f0e)=>{var _0x244c95=_0x4a4004;_0x456f41[_0x337f0e][_0x244c95(0x2d2)]=_0x518d06;}),_0x56fad9[_0x4a4004(0x2bd)]((_0x315eae,_0x1a9783)=>{var _0x382f11=_0x4a4004;_0x456f41[_0x1a9783][_0x382f11(0x30f)]=_0x315eae;}),_0x94e559[_0x4a4004(0x2bd)]((_0x3fa36e,_0x5a8af2)=>{var _0x200021=_0x4a4004;_0x456f41[_0x5a8af2]['invoice']=_0x3fa36e,_0x456f41[_0x5a8af2][_0x200021(0x23b)]=_0x46b3da;});const _0xaff7eb=new invoice_for_outgoing();await _0xaff7eb[_0x4a4004(0x305)](),_0x94e559[_0x4a4004(0x2bd)]((_0x40994b,_0x58a1d8)=>{var _0x348418=_0x4a4004;_0x456f41[_0x58a1d8][_0x348418(0x2eb)]=_0x348418(0x2d9)+_0xaff7eb[_0x348418(0x2fc)][_0x348418(0x223)]()[_0x348418(0x2c2)](0x8,'0');});var _0x111c89=0x0;_0x456f41['forEach'](_0x28fba0=>{var _0x47c24a=_0x4a4004;parseFloat(_0x28fba0[_0x47c24a(0x228)])<parseFloat(_0x28fba0[_0x47c24a(0x2ca)])&&parseFloat(_0x28fba0[_0x47c24a(0x2ca)])>parseFloat(_0x28fba0[_0x47c24a(0x228)])&&(console[_0x47c24a(0x269)](_0x28fba0[_0x47c24a(0x228)]+_0x47c24a(0x2f1)+_0x28fba0[_0x47c24a(0x2ca)]),_0x111c89++);});if(_0x111c89!=0x0)return _0x14883d[_0x4a4004(0x28d)](_0x4a4004(0x2b1),_0x4a4004(0x317)),_0x5818a7[_0x4a4004(0x2cd)](_0x4a4004(0x1fd));const _0x5cbc91=_0x456f41['filter'](_0x46f3e1=>_0x46f3e1[_0x4a4004(0x2ca)]!=='0'&&_0x46f3e1[_0x4a4004(0x2ca)]!==''),_0x1eed37=new sales_finished({'invoice':_0x4a4004(0x2d9)+_0xaff7eb[_0x4a4004(0x2fc)][_0x4a4004(0x223)]()['padStart'](0x8,'0'),'sales_data':_0x14883d[_0x4a4004(0x2be)]['sales'],'customer':_0x14883d[_0x4a4004(0x2be)]['customer'],'date':_0x46b3da,'warehouse_name':_0x55c9ec,'sale_product':_0x5cbc91,'note':_0x4e8825,'room':_0x5cc770,'primary_code':_0x56257e,'secondary_code':_0x5a75d5,'prod_code':_0x28ed01,'SCRN':_0x2779ef,'finalize':_0x4a4004(0x30c),'mode_transpo':_0x304ae1,'name_driver':_0x42cf36,'ReqBy':_0x1c497f,'dateofreq':_0x1191bd,'PO_number':_0x2054e7,'typeservicesData':_0x46b7d7,'typevehicle':_0x29c2a2,'destination':_0x21b1c5,'deliverydate':_0x2a3656,'driver':_0x54fcd2,'plate':_0x138bfa,'van':_0x17055f,'DRSI':_0x5cd39c,'TSU':_0x1c4230,'TFU':_0x9414e2,'pullout_date':_0x803840,'actualdelivery_date':_0x543bf8,'typeOfProducts':_0x4a4004(0x25a)}),_0x6959a5=await _0x1eed37[_0x4a4004(0x305)](),_0x40c25e=await sales_finished[_0x4a4004(0x2bb)]({'invoice':_0x2b558d});_0x14883d[_0x4a4004(0x28d)]('success',_0x4a4004(0x301)),_0x5818a7[_0x4a4004(0x2cd)](_0x4a4004(0x2d6)+_0x6959a5[_0x4a4004(0x238)]);}catch(_0x482798){console[_0x4a4004(0x269)](_0x482798);}}),router['get']('/preview/:id',auth,async(_0x1420b6,_0x23fd84)=>{var _0x39f28c=a0_0x36fbec;try{const {username:_0x309411,email:_0x52b061,role:_0x220127}=_0x1420b6[_0x39f28c(0x1ff)],_0x2b71f3=_0x1420b6[_0x39f28c(0x1ff)],_0x559956=await profile[_0x39f28c(0x2bb)]({'email':_0x2b71f3['email']}),_0x183401=await master_shop[_0x39f28c(0x25c)](),_0x114586=_0x1420b6[_0x39f28c(0x2a3)]['id'],_0x54df60=await sales_finished[_0x39f28c(0x30b)](_0x114586),_0x178764=await warehouse[_0x39f28c(0x20e)]([{'$match':{'name':_0x54df60['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x39f28c(0x2c4),'name':{'$first':_0x39f28c(0x24c)},'product_stock':{'$first':_0x39f28c(0x215)},'bay':{'$first':_0x39f28c(0x2a9)},'bin':{'$first':_0x39f28c(0x271)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x39f28c(0x2a4)},'secondary_code':{'$first':_0x39f28c(0x26b)},'product_code':{'$first':_0x39f28c(0x27b)},'storage':{'$first':_0x39f28c(0x260)},'rack':{'$first':_0x39f28c(0x212)},'expiry_date':{'$first':_0x39f28c(0x256)},'production_date':{'$first':_0x39f28c(0x1f1)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'},'room_data':{'$first':_0x39f28c(0x2e8)}}}]),_0x40f736=await customer[_0x39f28c(0x25c)]({});let _0x27d001;if(_0x2b71f3[_0x39f28c(0x2d1)]==_0x39f28c(0x28e)){const _0x5eb14c=await staff[_0x39f28c(0x2bb)]({'email':_0x2b71f3['email']});_0x27d001=await warehouse[_0x39f28c(0x20e)]([{'$match':{'status':_0x39f28c(0x20b),'name':_0x5eb14c[_0x39f28c(0x247)]}},{'$group':{'_id':_0x39f28c(0x230),'name':{'$first':_0x39f28c(0x230)}}}]);}else _0x27d001=await warehouse[_0x39f28c(0x20e)]([{'$match':{'status':_0x39f28c(0x20b)}},{'$group':{'_id':_0x39f28c(0x230),'name':{'$first':_0x39f28c(0x230)}}}]);const _0x3575c6=await product[_0x39f28c(0x25c)]({});if(_0x183401[0x0]['language']=='English\x20(US)'){var _0x1384ff=users[_0x39f28c(0x261)];console['log'](_0x1384ff);}else{if(_0x183401[0x0][_0x39f28c(0x2b9)]==_0x39f28c(0x21f))var _0x1384ff=users[_0x39f28c(0x21f)];else{if(_0x183401[0x0]['language']==_0x39f28c(0x246))var _0x1384ff=users[_0x39f28c(0x246)];else{if(_0x183401[0x0][_0x39f28c(0x2b9)]==_0x39f28c(0x267))var _0x1384ff=users[_0x39f28c(0x267)];else{if(_0x183401[0x0][_0x39f28c(0x2b9)]=='French')var _0x1384ff=users['French'];else{if(_0x183401[0x0][_0x39f28c(0x2b9)]==_0x39f28c(0x29a))var _0x1384ff=users[_0x39f28c(0x2de)];else{if(_0x183401[0x0][_0x39f28c(0x2b9)]==_0x39f28c(0x2c3))var _0x1384ff=users[_0x39f28c(0x2c3)];else{if(_0x183401[0x0][_0x39f28c(0x2b9)]=='Arabic\x20(ae)')var _0x1384ff=users[_0x39f28c(0x25f)];}}}}}}}_0x23fd84[_0x39f28c(0x242)](_0x39f28c(0x289),{'success':_0x1420b6[_0x39f28c(0x28d)](_0x39f28c(0x257)),'errors':_0x1420b6[_0x39f28c(0x28d)](_0x39f28c(0x2b1)),'role':_0x2b71f3,'profile':_0x559956,'customer':_0x40f736,'warehouse':_0x27d001,'product':_0x178764,'user':_0x54df60,'master_shop':_0x183401,'unit':_0x3575c6,'language':_0x1384ff});}catch(_0x20f102){console['log'](_0x20f102);}});function a0_0x12a9(){var _0x1d2704=['return_sale_QA','agent_id','Sales\x20Add\x20successfully','sales\x20item\x20return\x20successfull','createTransport','getDate','save','for_categorize','</span>','<tr>','secondary_unit_QA','nodemailer','findById','False','Sale\x20Return','logs','room_name','$product_details.product_cat','adjust_qty','English\x20(US)','<strong>\x20Regards\x20</strong>','<hr\x20class=\x22my-3\x22>','prod_code','updateOne','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','$customers_docs','site_title','<!DOCTYPE\x20html>','product_data','Quality\x20Inspection','$sale_product.bay','$product_details.production_date','currency_placement','maxProducts_QA','/barcode_scanner_logs','Router','push','../middleware/auth','return_sale','getMonth','batch_code','level','Return\x20Rooms','back','11OJOpNe','user','valueOf','foreach\x20newproduct','get','\x20Order\x20Number\x20:\x20','carton','$sale_product','$product_details.maxPerUnit','purchases_data','image','1094367fPNpJw','Received\x20Payment\x20For\x20Sale','Enabled','all_sales_finished','add_sales_finished','aggregate','message','then','sale_qty','$product_details.rack','string','$product_details.type','$product_details.product_stock','</tr>','secondary_unit','Enclosed','<span\x20style=\x22float:\x20right;\x22>','$warehouse_name','/upload/','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','status','$product_details','Hindi','RoomAssigned','final','finalize','toString','/give_payment/:id','/view/add_sales_logs','$customer','all','stock','barcode\x20Product\x20master','maxperunit','64NrJWhC','product_list','production_date_QA','2552115HUpXZb','$product_details.level','$name','prod_invoice','getFullYear','batch_code_QA','payment\x20successfull','slice','secondary_code','</thead>','_id','/view/add_sale/product','map','date_data','<tbody\x20style=\x22text-align:\x20center;\x22>','<html><head><title></title>','$product_details.unit','primary_code','customer','$return_data','render','stock_data','$product_details.batch_code','note','German','warehouse','French','production_date','json','primary_unit','$product_details.product_name','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','date','/view/add_sales','due_amount','$finalize','</h5>','LOG-OUT-','sales','maxPerUnit_QA','$product_details.expiry_date','success','28269HtRwAq','</tbody>','own','expiry_date_QA','find','stocks_QA','sales_quantity','Arabic','$product_details.storage','English','$date','max_per_unit','level2','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','Spanish','product_stock','log','$product_details.sales_category','$product_details.secondary_code','\x20</h2>','/../public','amount','expiry_date','$sale_product.bin','$product_details.bin','concat','4HoaRMj','/all_sales/view','$product_details.floorlevel','$sale_product.type','maxProducts','secondary_code_QA','return_qty','customer_data','$product_details.product_code','product_code','$product_details.gross_price','$sale_product.floorlevel','$product_details.invoice','catch','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_details','product_code_QA','/picking_list/pdf/','234uhwvdd','logo','primary_code_QA','exports','edit_sales_finished_view','barcode\x20user_id','$product_details.uuid','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','flash','staff','446340QczUEI','filter','warehouse_id','</head><body>','return_qty_QA','$invoice','random','uuid','$product','/view/return_sales/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Portuguese\x20(BR)','\x20&&\x20','maxPerUnit','suppliers','OUTF-','product_name','$note','</td>','/view','params','$product_details.primary_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','id_transaction_from','unit_QA','/view/:id','$product_details.bay','129801qJENsw','3324770vTwPzi','Arabic\x20(ae)','gmail','</body></html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$product_details.secondary_unit','errors','Ambient','30GbqRWm','product_date','../models/all_models','master','54Rbwwiw','$product.product_name','language','\x20Order\x20Date\x20:\x20','findOne','product','forEach','body','bay','password','sendMail','padStart','Chinese','$product_details._id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','email','gross_price','/all_sales_finished/view','Finished\x20Goods','quantity','split','product_name_QA1','redirect','sales_quantity_QA','express','match','role','prod_cat','Email\x20sent\x20successfully','sales_invoice','$product_details.type_products','/all_sales_finished/preview/','Logo.png','room','OUT-','abs','$sale_product.quantity','here','Return\x20Goods','Portuguese','$room','<h2>\x20','There\x27s\x20a\x20error\x20in\x20this\x20transaction','unit','</table>','post','<h5>','warehouse_name','invoice','$product_details.room_name','add_sales_finished_logs','$_id','outgoing_invoice','currency','int','True','length','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','\x20<>\x20','sale_product','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','26557AlicbH','received_amount','return_data','/view/add_sales/:id','$product_details.maxProducts','Error\x20Occurs','return_sale_finished','edit_sales_finished','invoice_init','<h5\x20style=\x22text-align:\x20left;\x22>','<div>'];a0_0x12a9=function(){return _0x1d2704;};return a0_0x12a9();}async function dataUpdate(_0x7b903b,_0x431fd7,_0x29f395){var _0x13e754=a0_0x36fbec;return await warehouse[_0x13e754(0x316)]({'_id':_0x7b903b,'product_details._id':_0x431fd7},{'$set':{'product_details.$.product_stock':_0x29f395}}),await warehouse[_0x13e754(0x30b)](_0x7b903b);}router[a0_0x36fbec(0x2e4)]('/preview/:id',auth,async(_0x5e9c78,_0x3b11aa)=>{var _0x11f468=a0_0x36fbec;try{const _0x3ec109=_0x5e9c78['params']['id'],{invoice:_0x32aa03,warehouse_name:_0x557bfd,room:_0x38c492}=_0x5e9c78['body'],_0x3e4b34=await sales_finished[_0x11f468(0x2bb)]({'invoice':_0x32aa03});for(let _0x506610=0x0;_0x506610<=_0x3e4b34[_0x11f468(0x2f2)][_0x11f468(0x2ef)]-0x1;_0x506610++){const _0xe2aa91=_0x3e4b34['sale_product'][_0x506610];var _0x47a339=await warehouse['findOne']({'name':_0x557bfd,'room':_0xe2aa91[_0x11f468(0x30f)]}),_0x2aa5c3=0x0;for(let _0x3ab069=0x0;_0x3ab069<=_0x47a339[_0x11f468(0x282)][_0x11f468(0x2ef)]-0x1;_0x3ab069++){const _0x13821a=_0x47a339[_0x11f468(0x282)][_0x3ab069];_0x13821a[_0x11f468(0x238)]==_0xe2aa91[_0x11f468(0x2a6)]&&_0x13821a[_0x11f468(0x296)]==_0xe2aa91[_0x11f468(0x296)]&&(_0x2aa5c3=Math['max'](0x0,Math[_0x11f468(0x2da)](_0x13821a[_0x11f468(0x268)])-Math[_0x11f468(0x2da)](_0xe2aa91[_0x11f468(0x2ca)])),await warehouse['updateOne']({'_id':_0x47a339[_0x11f468(0x238)][_0x11f468(0x200)](),'product_details._id':_0x13821a[_0x11f468(0x238)]['valueOf'](),'product_details.uuid':_0xe2aa91[_0x11f468(0x296)]},{'$set':{'product_details.$.product_stock':_0x2aa5c3}}));}console['log'](typeof _0xe2aa91[_0x11f468(0x300)]);if(typeof _0xe2aa91[_0x11f468(0x300)]!=='undefined'){var _0x343ab5=await staff['findById'](_0xe2aa91[_0x11f468(0x300)]);console[_0x11f468(0x269)](_0x11f468(0x2dc));var _0x216c17=0x0;for(let _0x5f01a0=0x0;_0x5f01a0<=_0x343ab5['product_list'][_0x11f468(0x2ef)]-0x1;_0x5f01a0++){const _0x3db2ca=_0x343ab5[_0x11f468(0x22c)][_0x5f01a0];console[_0x11f468(0x269)](_0xe2aa91[_0x11f468(0x2a6)]+'\x20==\x20'+_0x3db2ca[_0x11f468(0x291)]+_0x11f468(0x29b)+_0xe2aa91[_0x11f468(0x238)]+'\x20==\x20'+_0xe2aa91[_0x11f468(0x238)]),_0xe2aa91[_0x11f468(0x2a6)]==_0x3db2ca[_0x11f468(0x291)]&&_0xe2aa91['_id']==0x1&&(_0x3db2ca[_0x11f468(0x268)]=Math[_0x11f468(0x2da)](_0x3db2ca['product_stock'])+Math[_0x11f468(0x2da)](_0xe2aa91['quantity']),_0x216c17++);}console[_0x11f468(0x269)](_0x11f468(0x2ed),_0x216c17),_0x216c17=='0'&&(_0x343ab5[_0x11f468(0x22c)]=_0x343ab5[_0x11f468(0x22c)][_0x11f468(0x272)]({'product_name':_0xe2aa91[_0x11f468(0x29f)],'product_stock':_0xe2aa91[_0x11f468(0x2ca)],'bay':_0xe2aa91[_0x11f468(0x2bf)],'level':_0xe2aa91[_0x11f468(0x1fb)],'product_code':_0xe2aa91[_0x11f468(0x27c)],'primary_code':_0xe2aa91['primary_code'],'secondary_code':_0xe2aa91[_0x11f468(0x236)],'expiry_date':_0xe2aa91['expiry_date'],'production_date':_0xe2aa91[_0x11f468(0x249)],'maxProducts':_0xe2aa91[_0x11f468(0x277)],'batch_code':_0xe2aa91[_0x11f468(0x1fa)],'secondary_unit':_0xe2aa91[_0x11f468(0x217)],'unit':_0xe2aa91[_0x11f468(0x2e2)],'maxProducts':_0xe2aa91[_0x11f468(0x277)],'maxPerUnit':_0xe2aa91[_0x11f468(0x22a)],'invoice':_0xe2aa91['invoice'],'warehouse_id':_0xe2aa91[_0x11f468(0x2a6)],'id_incoming':_0xe2aa91['_id'],'uuid':_0xe2aa91[_0x11f468(0x296)],'gross_price':_0xe2aa91[_0x11f468(0x2c7)],'date_incoming':_0xe2aa91['date_data'],'outgoing_invoice':_0xe2aa91[_0x11f468(0x2eb)]}),await _0x343ab5[_0x11f468(0x305)]());}}_0x3e4b34[_0x11f468(0x222)]=_0x11f468(0x2ee);const _0x567cd6=await _0x3e4b34[_0x11f468(0x305)](),_0x59f1b9=await master_shop[_0x11f468(0x25c)](),_0xc34376=await email_settings[_0x11f468(0x2bb)](),_0x141975=await supervisor_settings[_0x11f468(0x25c)]();var _0x3621d7=_0x3e4b34[_0x11f468(0x2f2)],_0x3d261f='',_0x3feb25;for(_0x3feb25 in _0x3621d7){_0x3d261f+='<tr>'+_0x11f468(0x281)+_0x3621d7[_0x3feb25][_0x11f468(0x29f)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3621d7[_0x3feb25][_0x11f468(0x27c)]+'</td>'+_0x11f468(0x281)+_0x3621d7[_0x3feb25]['quantity']+'</td>'+_0x11f468(0x281)+_0x3621d7[_0x3feb25]['unit']+'</td>'+_0x11f468(0x281)+_0x3621d7[_0x3feb25][_0x11f468(0x217)]+_0x11f468(0x2a1)+_0x11f468(0x281)+_0x3e4b34[_0x11f468(0x2e6)]+_0x11f468(0x2a1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3621d7[_0x3feb25]['room_name']+_0x11f468(0x2a1)+_0x11f468(0x281)+_0x3621d7[_0x3feb25]['bay']+_0x11f468(0x2a1);}_0x5e9c78[_0x11f468(0x28d)](_0x11f468(0x257),'Sales\x20Update\x20successfully'),_0x3b11aa[_0x11f468(0x2cd)](_0x11f468(0x284)+_0x3ec109);}catch(_0x37f94e){console[_0x11f468(0x269)](_0x37f94e);}}),router[a0_0x36fbec(0x202)](a0_0x36fbec(0x2a8),auth,async(_0x5654bc,_0x55db41)=>{var _0x97f279=a0_0x36fbec;try{const {username:_0x5821b0,email:_0x27127b,role:_0x26532f}=_0x5654bc[_0x97f279(0x1ff)],_0x4e9ebf=_0x5654bc['user'],_0x53580f=await profile['findOne']({'email':_0x4e9ebf['email']}),_0x22bd5f=await master_shop['find'](),_0x126df3=_0x5654bc[_0x97f279(0x2a3)]['id'],_0x215933=await sales_finished[_0x97f279(0x30b)](_0x126df3);let _0x36aea0=new Date(_0x215933[_0x97f279(0x26f)]),_0x2ab3e7=('0'+_0x36aea0[_0x97f279(0x304)]())[_0x97f279(0x235)](-0x2),_0x4b0d8f=('0'+(_0x36aea0['getMonth']()+0x1))[_0x97f279(0x235)](-0x2),_0x117991=_0x36aea0[_0x97f279(0x232)](),_0x2cdac5=_0x117991+'-'+_0x4b0d8f+'-'+_0x2ab3e7;var _0x59f385=['Ambient',_0x97f279(0x218)];const _0x4cddff=await warehouse['aggregate']([{'$match':{'name':_0x215933[_0x97f279(0x2e6)],'room':_0x215933[_0x97f279(0x2d8)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x97f279(0x2c4),'name':{'$first':_0x97f279(0x24c)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x97f279(0x2a9)},'bin':{'$first':_0x97f279(0x271)},'type':{'$first':_0x97f279(0x214)},'floorlevel':{'$first':_0x97f279(0x275)},'primary_code':{'$first':_0x97f279(0x2a4)},'secondary_code':{'$first':_0x97f279(0x26b)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]),_0x4eba06=await customer[_0x97f279(0x25c)]({});let _0xffdda5;if(_0x4e9ebf[_0x97f279(0x2d1)]==_0x97f279(0x28e)){const _0x231a59=await staff[_0x97f279(0x2bb)]({'email':_0x4e9ebf[_0x97f279(0x2c6)]});_0xffdda5=await warehouse[_0x97f279(0x20e)]([{'$match':{'status':'Enabled','name':_0x231a59[_0x97f279(0x247)]}},{'$group':{'_id':_0x97f279(0x230),'name':{'$first':_0x97f279(0x230)}}}]);}else _0xffdda5=await warehouse[_0x97f279(0x20e)]([{'$match':{'status':_0x97f279(0x20b)}},{'$group':{'_id':_0x97f279(0x230),'name':{'$first':_0x97f279(0x230)}}}]);const _0x4342c6=await product['find']({});if(_0x22bd5f[0x0][_0x97f279(0x2b9)]==_0x97f279(0x312)){var _0x2a7108=users['English'];console[_0x97f279(0x269)](_0x2a7108);}else{if(_0x22bd5f[0x0][_0x97f279(0x2b9)]==_0x97f279(0x21f))var _0x2a7108=users[_0x97f279(0x21f)];else{if(_0x22bd5f[0x0]['language']==_0x97f279(0x246))var _0x2a7108=users['German'];else{if(_0x22bd5f[0x0][_0x97f279(0x2b9)]=='Spanish')var _0x2a7108=users[_0x97f279(0x267)];else{if(_0x22bd5f[0x0]['language']==_0x97f279(0x248))var _0x2a7108=users[_0x97f279(0x248)];else{if(_0x22bd5f[0x0][_0x97f279(0x2b9)]==_0x97f279(0x29a))var _0x2a7108=users['Portuguese'];else{if(_0x22bd5f[0x0][_0x97f279(0x2b9)]==_0x97f279(0x2c3))var _0x2a7108=users[_0x97f279(0x2c3)];else{if(_0x22bd5f[0x0][_0x97f279(0x2b9)]==_0x97f279(0x2ac))var _0x2a7108=users[_0x97f279(0x25f)];}}}}}}}_0x55db41['render'](_0x97f279(0x2fb),{'success':_0x5654bc[_0x97f279(0x28d)](_0x97f279(0x257)),'errors':_0x5654bc[_0x97f279(0x28d)]('errors'),'role':_0x4e9ebf,'profile':_0x53580f,'customer':_0x4eba06,'warehouse':_0xffdda5,'product':_0x4cddff,'user':_0x215933,'master_shop':_0x22bd5f,'unit':_0x4342c6,'language':_0x2a7108,'rooms_data':_0x59f385,'ed_fullDate':_0x2cdac5});}catch(_0x4b3437){console['log'](_0x4b3437);}}),router['post'](a0_0x36fbec(0x2a8),auth,async(_0x443794,_0xf3cb12)=>{var _0x499d8c=a0_0x36fbec;try{const _0x456253=_0x443794['params']['id'],_0x5d0435=await sales_finished['findOne']({'_id':_0x443794['params']['id']}),_0x2a3bcd=await warehouse['findOne']({'name':_0x5d0435[_0x499d8c(0x2e6)],'room':_0x443794[_0x499d8c(0x2be)][_0x499d8c(0x2d8)],'warehouse_category':_0x499d8c(0x2c9)}),{invoice:_0x4f2ea5,customer:_0x2cc623,date:_0x58b032,warehouse_name:_0x49de9c,product_name:_0x1028fc,stock:_0x5f1e4a,adjust_qty:_0x14c987,note:_0x2af67d,room:_0x3ab923,primary_code:_0x311d77,secondary_code:_0x424c33,prod_code:_0x3001c1,level:_0x1f6d6b,isle:_0x559ca0,pallet:_0x2d70ad,expiry_date:_0x2fb064}=_0x443794['body'];if(typeof _0x1028fc=='string')var _0x2ec4c6=[_0x443794['body']['product_name']],_0x5b6bb2=[_0x443794[_0x499d8c(0x2be)][_0x499d8c(0x228)]],_0x5a9213=[_0x443794[_0x499d8c(0x2be)][_0x499d8c(0x311)]],_0x338b59=[_0x443794['body']['primary_code']],_0x557c12=[_0x443794['body'][_0x499d8c(0x236)]],_0x8525fb=[_0x443794['body']['prod_code']],_0x387554=[_0x443794[_0x499d8c(0x2be)][_0x499d8c(0x1fb)]],_0x119d5e=[_0x443794[_0x499d8c(0x2be)][_0x499d8c(0x26f)]];else var _0x2ec4c6=[..._0x443794[_0x499d8c(0x2be)][_0x499d8c(0x29f)]],_0x5b6bb2=[..._0x443794[_0x499d8c(0x2be)][_0x499d8c(0x228)]],_0x5a9213=[..._0x443794[_0x499d8c(0x2be)][_0x499d8c(0x311)]],_0x338b59=[..._0x443794[_0x499d8c(0x2be)][_0x499d8c(0x23f)]],_0x557c12=[..._0x443794['body']['secondary_code']],_0x8525fb=[..._0x443794[_0x499d8c(0x2be)]['prod_code']],_0x387554=[..._0x443794[_0x499d8c(0x2be)][_0x499d8c(0x1fb)]],_0x119d5e=[..._0x443794[_0x499d8c(0x2be)][_0x499d8c(0x26f)]];const _0x355c19=_0x2ec4c6[_0x499d8c(0x23a)](_0x20a636=>{return _0x20a636={'product_name':_0x20a636};});_0x5b6bb2[_0x499d8c(0x2bd)]((_0x3a4fd6,_0x56dc12)=>{_0x355c19[_0x56dc12]['stock']=_0x3a4fd6;}),_0x5a9213[_0x499d8c(0x2bd)]((_0x4bd750,_0x3e04d4)=>{var _0x24c5c0=_0x499d8c;_0x355c19[_0x3e04d4][_0x24c5c0(0x2ca)]=_0x4bd750;}),_0x338b59[_0x499d8c(0x2bd)]((_0x2d03b0,_0x54a394)=>{var _0x17331d=_0x499d8c;_0x355c19[_0x54a394][_0x17331d(0x23f)]=_0x2d03b0;}),_0x557c12['forEach']((_0x1a0919,_0x4bedb1)=>{var _0x1db3c8=_0x499d8c;_0x355c19[_0x4bedb1][_0x1db3c8(0x236)]=_0x1a0919;}),_0x8525fb[_0x499d8c(0x2bd)]((_0x123457,_0x3676c5)=>{var _0x3d673b=_0x499d8c;_0x355c19[_0x3676c5][_0x3d673b(0x27c)]=_0x123457;}),_0x387554[_0x499d8c(0x2bd)]((_0x2d9661,_0x23755a)=>{_0x355c19[_0x23755a]['level']=_0x2d9661;}),_0x119d5e[_0x499d8c(0x2bd)]((_0x6215a0,_0x1041e7)=>{var _0x47e25f=_0x499d8c;_0x355c19[_0x1041e7][_0x47e25f(0x26f)]=_0x6215a0;});var _0x31a583=0x0;_0x355c19[_0x499d8c(0x2bd)](_0x78bbcf=>{var _0x1e3488=_0x499d8c;console[_0x1e3488(0x269)](_0x1e3488(0x201),_0x78bbcf),(parseInt(_0x78bbcf[_0x1e3488(0x228)])<parseInt(_0x78bbcf[_0x1e3488(0x2ca)])||parseInt(_0x78bbcf[_0x1e3488(0x2ca)])==0x0)&&_0x31a583++;});if(_0x31a583!=0x0)return _0x443794[_0x499d8c(0x28d)]('errors',_0x499d8c(0x2f3)),_0xf3cb12[_0x499d8c(0x2cd)](_0x499d8c(0x1fd));_0x5d0435['sale_product'][_0x499d8c(0x2bd)](_0x53c4cb=>{var _0x59e767=_0x499d8c;const _0x229b74=_0x2a3bcd[_0x59e767(0x282)][_0x59e767(0x23a)](_0x14cb80=>{var _0x442bd1=_0x59e767;_0x14cb80['product_name']==_0x53c4cb[_0x442bd1(0x29f)]&&_0x14cb80[_0x442bd1(0x2bf)]==_0x53c4cb[_0x442bd1(0x2bf)]&&(_0x14cb80['product_stock']=parseInt(_0x14cb80[_0x442bd1(0x268)])+parseInt(_0x53c4cb[_0x442bd1(0x2ca)]));});}),await _0x2a3bcd[_0x499d8c(0x305)]();const _0x3a0a59=_0x355c19['filter'](_0x4946bb=>_0x4946bb[_0x499d8c(0x2ca)]!=='0'&&_0x4946bb['quantity']!=='');_0x5d0435[_0x499d8c(0x2e7)]=_0x4f2ea5,_0x5d0435['customer']=_0x2cc623,_0x5d0435[_0x499d8c(0x24e)]=_0x58b032,_0x5d0435[_0x499d8c(0x2e6)]=_0x49de9c,_0x5d0435['sale_product']=_0x3a0a59,_0x5d0435[_0x499d8c(0x245)]=_0x2af67d,_0x5d0435['room']=_0x3ab923;const _0xf69876=await _0x5d0435[_0x499d8c(0x305)](),_0x512106=await sales_finished[_0x499d8c(0x2bb)]({'_id':_0x443794['params']['id']}),_0x4f3507=await warehouse[_0x499d8c(0x2bb)]({'name':_0x49de9c,'room':_0x3ab923,'warehouse_category':_0x499d8c(0x2c9)});_0x512106[_0x499d8c(0x2f2)][_0x499d8c(0x2bd)](_0x47fda1=>{const _0x382b48=_0x4f3507['product_details']['map'](_0xfee109=>{var _0x1dcac1=a0_0x97a8;_0xfee109[_0x1dcac1(0x29f)]==_0x47fda1[_0x1dcac1(0x29f)]&&_0xfee109[_0x1dcac1(0x2bf)]==_0x47fda1[_0x1dcac1(0x2bf)]&&(_0xfee109['product_stock']=parseInt(_0xfee109[_0x1dcac1(0x268)])-parseInt(_0x47fda1[_0x1dcac1(0x2ca)]));});}),console[_0x499d8c(0x269)](_0x499d8c(0x221),_0x4f3507),await _0x4f3507[_0x499d8c(0x305)]();const _0x3e0fd6=await c_payment_data['findOne']({'invoice':_0x443794[_0x499d8c(0x2be)][_0x499d8c(0x2e7)]});_0x3e0fd6['suppliers']=_0x443794['body'][_0x499d8c(0x29d)],await _0x3e0fd6['save'](),_0x443794[_0x499d8c(0x28d)](_0x499d8c(0x257),'Sales\x20Update\x20successfully'),_0xf3cb12[_0x499d8c(0x2cd)]('/all_sales_finished/view');}catch(_0x252484){console[_0x499d8c(0x269)](_0x252484);}}),router[a0_0x36fbec(0x2e4)](a0_0x36fbec(0x224),auth,async(_0x540d6c,_0x3c7955)=>{var _0x1e7d33=a0_0x36fbec;try{const _0x23ae89=_0x540d6c[_0x1e7d33(0x2a3)]['id'],{invoice:_0x3ee3c6,customer:_0x46ddda,receivable_amount:_0xefc019,received_amount:_0x41534b}=_0x540d6c[_0x1e7d33(0x2be)],_0x5b8f92=await sales[_0x1e7d33(0x30b)](_0x23ae89);console[_0x1e7d33(0x269)](_0x5b8f92);var _0x48ced0=_0xefc019-_0x41534b;console['log'](_0x41534b),_0x5b8f92[_0x1e7d33(0x2f5)]=parseFloat(_0x41534b)+parseFloat(_0x5b8f92[_0x1e7d33(0x2f5)]),_0x5b8f92[_0x1e7d33(0x250)]=_0x48ced0,console[_0x1e7d33(0x269)](_0x5b8f92);const _0x295d32=await _0x5b8f92[_0x1e7d33(0x305)](),_0x59b394=await c_payment_data[_0x1e7d33(0x2bb)]({'invoice':_0x3ee3c6});_0x59b394[_0x1e7d33(0x26e)]=_0x48ced0,await _0x59b394['save']();let _0x2b03e7=new Date(),_0x492cb8=('0'+_0x2b03e7[_0x1e7d33(0x304)]())[_0x1e7d33(0x235)](-0x2),_0x13e0d1=('0'+(_0x2b03e7[_0x1e7d33(0x1f9)]()+0x1))[_0x1e7d33(0x235)](-0x2),_0x546e7f=_0x2b03e7[_0x1e7d33(0x232)](),_0x5b6b42=_0x546e7f+'-'+_0x13e0d1+'-'+_0x492cb8;const _0x34dcd2=new customer_payment({'invoice':_0x3ee3c6,'date':_0x546e7f+'-'+_0x13e0d1+'-'+_0x492cb8,'customer':_0x46ddda,'reason':_0x1e7d33(0x20a),'amount':_0x41534b}),_0x2e7eb4=await _0x34dcd2[_0x1e7d33(0x305)]();_0x540d6c['flash'](_0x1e7d33(0x257),_0x1e7d33(0x234)),_0x3c7955[_0x1e7d33(0x2cd)](_0x1e7d33(0x274));}catch(_0x3bfd43){console[_0x1e7d33(0x269)](_0x3bfd43);}}),router['get']('/invoice/:id',auth,async(_0x20825b,_0x4c0d01)=>{var _0x5ee947=a0_0x36fbec;try{const {username:_0x5eb257,email:_0x3edb21,role:_0x24bcc4}=_0x20825b['user'],_0x5720eb=_0x20825b['user'],_0x576c6e=await profile[_0x5ee947(0x2bb)]({'email':_0x5720eb[_0x5ee947(0x2c6)]}),_0x2ec31e=await master_shop[_0x5ee947(0x25c)]();console['log'](_0x5ee947(0x2b6),_0x2ec31e);const _0x3b4134=_0x20825b['params']['id'],_0x55350e=await sales[_0x5ee947(0x30b)](_0x3b4134);console[_0x5ee947(0x269)](_0x55350e);const _0x2c316c=await customer[_0x5ee947(0x2bb)]({'name':_0x55350e['customer']});console[_0x5ee947(0x269)](_0x2c316c);if(_0x2ec31e[0x0][_0x5ee947(0x2b9)]==_0x5ee947(0x312)){var _0x4b69f1=users[_0x5ee947(0x261)];console[_0x5ee947(0x269)](_0x4b69f1);}else{if(_0x2ec31e[0x0][_0x5ee947(0x2b9)]=='Hindi')var _0x4b69f1=users['Hindi'];else{if(_0x2ec31e[0x0][_0x5ee947(0x2b9)]=='German')var _0x4b69f1=users[_0x5ee947(0x246)];else{if(_0x2ec31e[0x0][_0x5ee947(0x2b9)]==_0x5ee947(0x267))var _0x4b69f1=users[_0x5ee947(0x267)];else{if(_0x2ec31e[0x0][_0x5ee947(0x2b9)]==_0x5ee947(0x248))var _0x4b69f1=users[_0x5ee947(0x248)];else{if(_0x2ec31e[0x0][_0x5ee947(0x2b9)]==_0x5ee947(0x29a))var _0x4b69f1=users[_0x5ee947(0x2de)];else{if(_0x2ec31e[0x0][_0x5ee947(0x2b9)]==_0x5ee947(0x2c3))var _0x4b69f1=users[_0x5ee947(0x2c3)];else{if(_0x2ec31e[0x0][_0x5ee947(0x2b9)]==_0x5ee947(0x2ac))var _0x4b69f1=users[_0x5ee947(0x25f)];}}}}}}}_0x4c0d01[_0x5ee947(0x242)](_0x5ee947(0x2d4),{'success':_0x20825b['flash']('success'),'errors':_0x20825b[_0x5ee947(0x28d)]('errors'),'role':_0x5720eb,'profile':_0x576c6e,'master_shop':_0x2ec31e,'customers':_0x2c316c,'sales':_0x55350e,'language':_0x4b69f1});}catch(_0x210039){console[_0x5ee947(0x269)](_0x210039);}}),router[a0_0x36fbec(0x202)](a0_0x36fbec(0x298),auth,async(_0x532956,_0x38a863)=>{var _0x52b740=a0_0x36fbec;try{const {username:_0x1d003c,email:_0x3e81c0,role:_0x16a5f0}=_0x532956[_0x52b740(0x1ff)],_0x4d60bb=_0x532956['user'],_0x5c367c=await profile[_0x52b740(0x2bb)]({'email':_0x4d60bb[_0x52b740(0x2c6)]}),_0x687829=await master_shop[_0x52b740(0x25c)](),_0x558fa8=_0x532956['params']['id'],_0x286472=await sales_finished[_0x52b740(0x30b)](_0x558fa8),_0x201cb3=await warehouse['aggregate']([{'$match':{'name':_0x286472[_0x52b740(0x2e6)]}},{'$unwind':_0x52b740(0x21e)},{'$group':{'_id':_0x52b740(0x2c4),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x52b740(0x215)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x52b740(0x271)},'type':{'$first':_0x52b740(0x214)},'floorlevel':{'$first':_0x52b740(0x275)},'primary_code':{'$first':_0x52b740(0x2a4)},'secondary_code':{'$first':_0x52b740(0x26b)},'product_code':{'$first':_0x52b740(0x27b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x52b740(0x256)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x52b740(0x2b0)},'maxProducts':{'$first':_0x52b740(0x2f8)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x52b740(0x206)}}}]),_0x4e7987=await product[_0x52b740(0x25c)]({}),_0x7e255d=await warehouse[_0x52b740(0x20e)]([{'$match':{'status':_0x52b740(0x20b),'warehouse_category':_0x52b740(0x2c9),'name':{'$ne':_0x52b740(0x2dd),'$ne':_0x52b740(0x1ef)}}},{'$group':{'_id':'$name','name':{'$first':_0x52b740(0x230)}}},{'$sort':{'name':0x1}}]);var _0x5ec900=[_0x52b740(0x1fc)];const _0x50b228=await warehouse[_0x52b740(0x20e)]([{'$match':{'status':'Enabled','name':_0x52b740(0x1ef)}},{'$group':{'_id':_0x52b740(0x230),'name':{'$first':_0x52b740(0x230)}}},{'$sort':{'name':0x1}}]);if(_0x687829[0x0][_0x52b740(0x2b9)]==_0x52b740(0x312)){var _0x27b8b1=users[_0x52b740(0x261)];console['log'](_0x27b8b1);}else{if(_0x687829[0x0][_0x52b740(0x2b9)]=='Hindi')var _0x27b8b1=users[_0x52b740(0x21f)];else{if(_0x687829[0x0][_0x52b740(0x2b9)]==_0x52b740(0x246))var _0x27b8b1=users[_0x52b740(0x246)];else{if(_0x687829[0x0][_0x52b740(0x2b9)]=='Spanish')var _0x27b8b1=users['Spanish'];else{if(_0x687829[0x0][_0x52b740(0x2b9)]==_0x52b740(0x248))var _0x27b8b1=users['French'];else{if(_0x687829[0x0][_0x52b740(0x2b9)]==_0x52b740(0x29a))var _0x27b8b1=users[_0x52b740(0x2de)];else{if(_0x687829[0x0][_0x52b740(0x2b9)]==_0x52b740(0x2c3))var _0x27b8b1=users['Chinese'];else{if(_0x687829[0x0][_0x52b740(0x2b9)]==_0x52b740(0x2ac))var _0x27b8b1=users[_0x52b740(0x25f)];}}}}}}}_0x38a863['render'](_0x52b740(0x2fa),{'success':_0x532956[_0x52b740(0x28d)](_0x52b740(0x257)),'errors':_0x532956['flash'](_0x52b740(0x2b1)),'role':_0x4d60bb,'profile':_0x5c367c,'user':_0x286472,'stock':_0x201cb3,'master_shop':_0x687829,'unit':_0x4e7987,'language':_0x27b8b1,'warehouses':_0x7e255d,'rooms':_0x5ec900,'warehouse_QA':_0x50b228});}catch(_0x3affad){console['log'](_0x3affad),_0x38a863[_0x52b740(0x21d)](0xc8)['json']({'message':_0x3affad['message']});}}),router['post'](a0_0x36fbec(0x298),auth,async(_0x329b4a,_0xaafd52)=>{var _0x1ed0a9=a0_0x36fbec;if(_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x306)]=='QA')try{const {invoice:_0x132c50,date:_0x55ff91,warehouse_name:_0x5cd0a6,product_name:_0x153ccb,primary_code:_0x1e4ab9,secondary_code:_0x429acb,product_code:_0x15ba0c,sales_quantity:_0x4bd6bd,stocks:_0x5071be,return_qty:_0x35ae44,Room_name:_0x5c910b,to_warehouse_name_QA:_0x2cddb2,to_Room_name_QA:_0x178063,note:_0x289616,for_categorize:_0x178960,product_name_QA1:_0x42f233}=_0x329b4a[_0x1ed0a9(0x2be)];if(typeof _0x42f233==_0x1ed0a9(0x213))var _0x266bf9=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x2cc)]],_0x4f2f6b=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x287)]],_0x5302f3=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x278)]],_0x7f3360=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x283)]],_0x81d57d=[_0x329b4a['body']['sales_quantity_QA']],_0x2207f2=[_0x329b4a['body'][_0x1ed0a9(0x25d)]],_0x16de4c=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x293)]],_0xf68e9e=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x255)]],_0x2a9b12=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x1f3)]],_0xe3a8b1=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x233)]],_0x3f08d1=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x309)]],_0x47d5da=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x2a7)]],_0x3742db=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x22d)]],_0x50efe2=[_0x329b4a['body'][_0x1ed0a9(0x25b)]];else var _0x266bf9=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x2cc)]],_0x4f2f6b=[..._0x329b4a['body']['primary_code_QA']],_0x5302f3=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x278)]],_0x7f3360=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x283)]],_0x81d57d=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x2ce)]],_0x2207f2=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x25d)]],_0x16de4c=[..._0x329b4a[_0x1ed0a9(0x2be)]['return_qty_QA']],_0xf68e9e=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x255)]],_0x2a9b12=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x1f3)]],_0xe3a8b1=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x233)]],_0x3f08d1=[..._0x329b4a['body'][_0x1ed0a9(0x309)]],_0x47d5da=[..._0x329b4a[_0x1ed0a9(0x2be)]['unit_QA']],_0x3742db=[..._0x329b4a[_0x1ed0a9(0x2be)]['production_date_QA']],_0x50efe2=[..._0x329b4a[_0x1ed0a9(0x2be)]['expiry_date_QA']];const _0x3538d8=_0x266bf9[_0x1ed0a9(0x23a)](_0x3422cc=>{return _0x3422cc={'product_name':_0x3422cc};});_0x4f2f6b[_0x1ed0a9(0x2bd)]((_0x1861e1,_0x503623)=>{var _0x31ff06=_0x1ed0a9;_0x3538d8[_0x503623][_0x31ff06(0x23f)]=_0x1861e1;}),_0x5302f3['forEach']((_0x493782,_0x23a6e5)=>{var _0x3ba512=_0x1ed0a9;_0x3538d8[_0x23a6e5][_0x3ba512(0x236)]=_0x493782;}),_0x7f3360[_0x1ed0a9(0x2bd)]((_0x3a2cc9,_0x4ad82f)=>{var _0x4a757d=_0x1ed0a9;_0x3538d8[_0x4ad82f][_0x4a757d(0x27c)]=_0x3a2cc9;}),_0x81d57d['forEach']((_0x1c8944,_0xe03d38)=>{_0x3538d8[_0xe03d38]['sale_qty']=_0x1c8944;}),_0x2207f2[_0x1ed0a9(0x2bd)]((_0x18dd69,_0x7e9eab)=>{_0x3538d8[_0x7e9eab]['stock']=_0x18dd69;}),_0x16de4c['forEach']((_0x396412,_0x953eff)=>{_0x3538d8[_0x953eff]['return_qty']=_0x396412;}),_0xf68e9e[_0x1ed0a9(0x2bd)]((_0x53f73c,_0x2179d5)=>{var _0x2bd70c=_0x1ed0a9;_0x3538d8[_0x2179d5][_0x2bd70c(0x29c)]=_0x53f73c;}),_0x2a9b12[_0x1ed0a9(0x2bd)]((_0x2cf9a1,_0x56785d)=>{_0x3538d8[_0x56785d]['maxProducts']=_0x2cf9a1;}),_0xe3a8b1[_0x1ed0a9(0x2bd)]((_0xafbe38,_0x53b991)=>{var _0x2b1872=_0x1ed0a9;_0x3538d8[_0x53b991][_0x2b1872(0x1fa)]=_0xafbe38;}),_0x3f08d1[_0x1ed0a9(0x2bd)]((_0x3d1238,_0x5a249a)=>{var _0x4e8773=_0x1ed0a9;_0x3538d8[_0x5a249a][_0x4e8773(0x217)]=_0x3d1238;}),_0x47d5da[_0x1ed0a9(0x2bd)]((_0x295aaf,_0x46a7a6)=>{var _0xe0f206=_0x1ed0a9;_0x3538d8[_0x46a7a6][_0xe0f206(0x2e2)]=_0x295aaf;}),_0x3742db['forEach']((_0x5e6c45,_0x25b152)=>{var _0x5b5261=_0x1ed0a9;_0x3538d8[_0x25b152][_0x5b5261(0x249)]=_0x5e6c45;}),_0x50efe2[_0x1ed0a9(0x2bd)]((_0x2e2441,_0x22f98f)=>{_0x3538d8[_0x22f98f]['expiry_date']=_0x2e2441;});const _0x3f0ef0=await sales_finished['findOne']({'invoice':_0x132c50});_0x3f0ef0[_0x1ed0a9(0x2f6)]=_0x1ed0a9(0x2ee);const _0x4462ab=await _0x3f0ef0[_0x1ed0a9(0x305)](),_0x5129d0=new sales_return_finished({'invoice':_0x132c50,'customer':_0x329b4a['body'][_0x1ed0a9(0x240)],'date':_0x55ff91,'warehouse_name':_0x5cd0a6,'room':_0x5c910b,'ToWarehouse':_0x2cddb2,'ToRoom':_0x178063,'return_sale_QA':_0x3538d8,'note':_0x289616,'warehouse_cat':_0x178960}),_0x3a4cea=await _0x5129d0['save'](),_0x7989b9=await sales_return_finished[_0x1ed0a9(0x2bb)]({'invoice':_0x132c50}),_0x22621b=await warehouse[_0x1ed0a9(0x2bb)]({'name':_0x2cddb2,'room':_0x178063});_0x7989b9[_0x1ed0a9(0x2ff)]['forEach'](_0x4c2829=>{var _0x549fdc=_0x1ed0a9,_0x964d99=0x0;const _0x3a7b32=_0x22621b[_0x549fdc(0x282)][_0x549fdc(0x23a)](_0x14181e=>{var _0x54ba0d=_0x549fdc;_0x14181e[_0x54ba0d(0x29f)]==_0x4c2829[_0x54ba0d(0x29f)]&&_0x14181e[_0x54ba0d(0x26f)]==_0x4c2829[_0x54ba0d(0x26f)]&&_0x14181e[_0x54ba0d(0x249)]==_0x4c2829[_0x54ba0d(0x249)]&&_0x14181e[_0x54ba0d(0x1fa)]==_0x4c2829[_0x54ba0d(0x1fa)]&&(_0x14181e[_0x54ba0d(0x268)]=parseInt(_0x14181e['product_stock'])+parseInt(_0x4c2829['return_qty']),_0x964d99++);});_0x964d99=='0'&&(_0x22621b['product_details']=_0x22621b[_0x549fdc(0x282)][_0x549fdc(0x272)]({'product_name':_0x4c2829[_0x549fdc(0x29f)],'product_stock':_0x4c2829['return_qty'],'primary_code':_0x4c2829[_0x549fdc(0x23f)],'secondary_code':_0x4c2829[_0x549fdc(0x236)],'product_code':_0x4c2829['product_code'],'batch_code':_0x4c2829[_0x549fdc(0x1fa)],'maxPerUnit':_0x4c2829[_0x549fdc(0x29c)],'production_date':_0x4c2829['production_date'],'expiry_date':_0x4c2829['expiry_date'],'secondary_unit':_0x4c2829[_0x549fdc(0x217)],'unit':_0x4c2829['unit'],'maxProducts':_0x4c2829[_0x549fdc(0x277)],'bay':_0x4c2829[_0x549fdc(0x2bf)]}));}),await _0x22621b[_0x1ed0a9(0x305)]();const _0x32fec4=new c_payment_data({'invoice':_0x132c50,'customer':_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x240)],'reason':_0x1ed0a9(0x30d)});await _0x32fec4['save']();const _0x26168e=await master_shop[_0x1ed0a9(0x25c)](),_0x198edf=await email_settings[_0x1ed0a9(0x2bb)](),_0x12dad7=await customer[_0x1ed0a9(0x2bb)]({'name':_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x240)]});_0x26168e[0x0][_0x1ed0a9(0x1f2)]==0x1?(right_currency=_0x26168e[0x0][_0x1ed0a9(0x2ec)],left_currency=''):(right_currency='',left_currency=_0x26168e[0x0][_0x1ed0a9(0x2ec)]);var _0x229316=_0x266bf9,_0x3bbb2b=_0x16de4c,_0x1385c9='',_0x59f37f;for(_0x59f37f in _0x229316){_0x1385c9+=_0x1ed0a9(0x308)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x229316[_0x59f37f]+_0x1ed0a9(0x2a1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3bbb2b[_0x59f37f]+_0x1ed0a9(0x2a1)+_0x1ed0a9(0x216);}console[_0x1ed0a9(0x269)](_0x1ed0a9(0x22c),_0x1385c9);let _0x1b8737=nodemailer['createTransport']({'service':_0x1ed0a9(0x2ad),'auth':{'user':_0x198edf[_0x1ed0a9(0x2c6)],'pass':_0x198edf[_0x1ed0a9(0x2c0)]}}),_0x3354e0={'from':_0x198edf[_0x1ed0a9(0x2c6)],'to':_0x12dad7[_0x1ed0a9(0x2c6)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x1ed0a9(0x2d7),'path':__dirname+_0x1ed0a9(0x26d)+_0x1ed0a9(0x21b)+_0x26168e[0x0]['image'],'cid':_0x1ed0a9(0x286)}],'html':_0x1ed0a9(0x1ed)+_0x1ed0a9(0x23d)+'</head><body>'+'<div>'+_0x1ed0a9(0x21c)+_0x1ed0a9(0x2fe)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1ed0a9(0x265)+_0x1ed0a9(0x2fe)+_0x1ed0a9(0x2e0)+_0x26168e[0x0][_0x1ed0a9(0x319)]+_0x1ed0a9(0x26c)+_0x1ed0a9(0x265)+'</div>'+_0x1ed0a9(0x314)+_0x1ed0a9(0x2fe)+_0x1ed0a9(0x2fd)+_0x1ed0a9(0x203)+_0x132c50+'\x20'+_0x1ed0a9(0x219)+_0x1ed0a9(0x2ba)+_0x55ff91+'\x20'+_0x1ed0a9(0x307)+'</h5>'+_0x1ed0a9(0x265)+_0x1ed0a9(0x2c5)+_0x1ed0a9(0x2a5)+_0x1ed0a9(0x308)+_0x1ed0a9(0x299)+_0x1ed0a9(0x2af)+_0x1ed0a9(0x266)+_0x1ed0a9(0x28c)+_0x1ed0a9(0x216)+_0x1ed0a9(0x237)+_0x1ed0a9(0x23c)+'\x20'+_0x1385c9+'\x20'+_0x1ed0a9(0x259)+_0x1ed0a9(0x2e3)+'<div>'+_0x1ed0a9(0x313)+_0x1ed0a9(0x2e5)+_0x26168e[0x0][_0x1ed0a9(0x319)]+_0x1ed0a9(0x252)+_0x1ed0a9(0x265)+_0x1ed0a9(0x265)+_0x1ed0a9(0x2ae)};_0x1b8737[_0x1ed0a9(0x2c1)](_0x3354e0,function(_0x1dc4a3,_0x42270a){var _0x53f167=_0x1ed0a9;_0x1dc4a3?(console['log'](_0x1dc4a3),console[_0x53f167(0x269)](_0x53f167(0x2f9))):console[_0x53f167(0x269)](_0x53f167(0x2d3));}),_0x329b4a[_0x1ed0a9(0x28d)](_0x1ed0a9(0x257),_0x1ed0a9(0x302)),_0xaafd52[_0x1ed0a9(0x2cd)](_0x1ed0a9(0x2c8));}catch(_0x14e5dc){_0xaafd52[_0x1ed0a9(0x21d)](0xc8)[_0x1ed0a9(0x24a)]({'message1':_0x14e5dc[_0x1ed0a9(0x20f)]});}else{if(_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x306)]=='GS')try{const {invoice:_0x21c8a4,date:_0x5a77ce,warehouse_name:_0x26aaf0,product_name:_0xb06fec,primary_code:_0x246af2,secondary_code:_0x4df712,product_code:_0x12fc25,sales_quantity:_0x2425ac,stocks:_0x5d98d1,return_qty:_0x55c2ea,Room_name:_0x2947e1,to_warehouse_name:_0x3cbc9e,to_Room_name:_0x3ab34d,note:_0x2fd914,level:_0x529599,isle:_0x46cfa9,pallet:_0x2dd774,for_categorize:_0x24864d}=_0x329b4a[_0x1ed0a9(0x2be)];if(typeof _0xb06fec==_0x1ed0a9(0x213))var _0x266bf9=[_0x329b4a[_0x1ed0a9(0x2be)]['product_name']],_0x4f2f6b=[_0x329b4a['body'][_0x1ed0a9(0x23f)]],_0x5302f3=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x236)]],_0x7f3360=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x27c)]],_0x81d57d=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x25e)]],_0x16de4c=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x279)]],_0x2fe820=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x2bf)]],_0xf68e9e=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x29c)]],_0x2a9b12=[_0x329b4a['body']['maxProducts']],_0xe3a8b1=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x1fa)]],_0x3f08d1=[_0x329b4a['body']['secondary_unit']],_0x47d5da=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x2e2)]],_0x3742db=[_0x329b4a['body'][_0x1ed0a9(0x249)]],_0x50efe2=[_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x26f)]];else var _0x266bf9=[..._0x329b4a['body'][_0x1ed0a9(0x29f)]],_0x4f2f6b=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x23f)]],_0x5302f3=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x236)]],_0x7f3360=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x27c)]],_0x81d57d=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x25e)]],_0x16de4c=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x279)]],_0x2fe820=[..._0x329b4a['body'][_0x1ed0a9(0x2bf)]],_0xf68e9e=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x29c)]],_0x2a9b12=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x277)]],_0xe3a8b1=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x1fa)]],_0x3f08d1=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x217)]],_0x47d5da=[..._0x329b4a[_0x1ed0a9(0x2be)]['unit']],_0x3742db=[..._0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x249)]],_0x50efe2=[..._0x329b4a[_0x1ed0a9(0x2be)]['expiry_date']];const _0x5e7b43=_0x266bf9[_0x1ed0a9(0x23a)](_0x10c962=>{return _0x10c962={'product_name':_0x10c962};});_0x4f2f6b[_0x1ed0a9(0x2bd)]((_0x3adfb3,_0xb20a4c)=>{_0x5e7b43[_0xb20a4c]['primary_code']=_0x3adfb3;}),_0x5302f3[_0x1ed0a9(0x2bd)]((_0x28bde7,_0xc9d887)=>{_0x5e7b43[_0xc9d887]['secondary_code']=_0x28bde7;}),_0x7f3360['forEach']((_0x2b7508,_0x3b32dd)=>{var _0x4ee417=_0x1ed0a9;_0x5e7b43[_0x3b32dd][_0x4ee417(0x27c)]=_0x2b7508;}),_0x81d57d[_0x1ed0a9(0x2bd)]((_0x3ba24a,_0x25f915)=>{var _0x40b7e9=_0x1ed0a9;_0x5e7b43[_0x25f915][_0x40b7e9(0x211)]=_0x3ba24a;}),_0x16de4c[_0x1ed0a9(0x2bd)]((_0x2728b6,_0x3f9faa)=>{_0x5e7b43[_0x3f9faa]['return_qty']=_0x2728b6;}),_0x2fe820[_0x1ed0a9(0x2bd)]((_0x3b454e,_0x49ad12)=>{var _0xf7db8c=_0x1ed0a9;_0x5e7b43[_0x49ad12][_0xf7db8c(0x2bf)]=_0x3b454e;}),_0xf68e9e['forEach']((_0x93302a,_0x50f841)=>{var _0x3cd62e=_0x1ed0a9;_0x5e7b43[_0x50f841][_0x3cd62e(0x29c)]=_0x93302a;}),_0x2a9b12[_0x1ed0a9(0x2bd)]((_0x2a99f3,_0x5c0639)=>{_0x5e7b43[_0x5c0639]['maxProducts']=_0x2a99f3;}),_0xe3a8b1[_0x1ed0a9(0x2bd)]((_0x3c2317,_0x600275)=>{var _0x3fdd07=_0x1ed0a9;_0x5e7b43[_0x600275][_0x3fdd07(0x1fa)]=_0x3c2317;}),_0x3f08d1[_0x1ed0a9(0x2bd)]((_0x15a8c0,_0x1bcb71)=>{var _0x5cad1e=_0x1ed0a9;_0x5e7b43[_0x1bcb71][_0x5cad1e(0x217)]=_0x15a8c0;}),_0x47d5da[_0x1ed0a9(0x2bd)]((_0x288516,_0x2f3831)=>{var _0x492ac6=_0x1ed0a9;_0x5e7b43[_0x2f3831][_0x492ac6(0x2e2)]=_0x288516;}),_0x3742db['forEach']((_0x2b92e5,_0x1666df)=>{var _0x47c94e=_0x1ed0a9;_0x5e7b43[_0x1666df][_0x47c94e(0x249)]=_0x2b92e5;}),_0x50efe2['forEach']((_0xc9f283,_0x4a343b)=>{var _0x21c2a9=_0x1ed0a9;_0x5e7b43[_0x4a343b][_0x21c2a9(0x26f)]=_0xc9f283;});var _0x29ff19=0x0;_0x5e7b43[_0x1ed0a9(0x2bd)](_0x35f321=>{var _0x41ddf5=_0x1ed0a9;(parseInt(_0x35f321['sale_qty'])<parseInt(_0x35f321['return_qty'])||parseInt(_0x35f321[_0x41ddf5(0x228)])<parseInt(_0x35f321['return_qty'])&&parseInt(_0x35f321[_0x41ddf5(0x211)])>parseInt(_0x35f321[_0x41ddf5(0x279)])||parseInt(_0x35f321[_0x41ddf5(0x279)])==0x0)&&_0x29ff19++;});if(_0x29ff19!=0x0)return _0x329b4a['flash']('errors',_0x1ed0a9(0x24d)),_0xaafd52[_0x1ed0a9(0x2cd)]('back');const _0x37e349=await sales_finished[_0x1ed0a9(0x2bb)]({'invoice':_0x21c8a4});_0x37e349[_0x1ed0a9(0x2f6)]=_0x1ed0a9(0x2ee);const _0x539012=await _0x37e349[_0x1ed0a9(0x305)](),_0x3fbe51=new sales_return_finished({'invoice':_0x21c8a4,'customer':_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x240)],'date':_0x5a77ce,'warehouse_name':_0x26aaf0,'room':_0x2947e1,'ToWarehouse':_0x3cbc9e,'ToRoom':_0x3ab34d,'return_sale':_0x5e7b43,'note':_0x2fd914,'warehouse_cat':_0x24864d}),_0x23b031=await _0x3fbe51['save'](),_0x35891a=await sales_return_finished[_0x1ed0a9(0x2bb)]({'invoice':_0x21c8a4}),_0x4fb2a0=await warehouse[_0x1ed0a9(0x2bb)]({'name':_0x3cbc9e,'room':_0x3ab34d,'warehouse_category':_0x1ed0a9(0x2c9)});_0x35891a[_0x1ed0a9(0x1f8)]['forEach'](_0x1be464=>{var _0x29f34a=_0x1ed0a9,_0x59c7be=0x0;const _0x51f6f1=_0x4fb2a0[_0x29f34a(0x282)][_0x29f34a(0x23a)](_0x3d338c=>{var _0x446883=_0x29f34a;_0x3d338c[_0x446883(0x29f)]==_0x1be464['product_name']&&_0x3d338c[_0x446883(0x2bf)]==_0x1be464[_0x446883(0x2bf)]&&_0x3d338c[_0x446883(0x26f)]==_0x1be464['expiry_date']&&_0x3d338c[_0x446883(0x249)]==_0x1be464[_0x446883(0x249)]&&_0x3d338c[_0x446883(0x1fa)]==_0x1be464[_0x446883(0x1fa)]&&(_0x3d338c[_0x446883(0x268)]=parseInt(_0x3d338c[_0x446883(0x268)])+parseInt(_0x1be464['return_qty']),_0x59c7be++);});_0x59c7be=='0'&&(_0x4fb2a0[_0x29f34a(0x282)]=_0x4fb2a0[_0x29f34a(0x282)][_0x29f34a(0x272)]({'product_name':_0x1be464[_0x29f34a(0x29f)],'product_stock':_0x1be464[_0x29f34a(0x279)],'primary_code':_0x1be464[_0x29f34a(0x23f)],'secondary_code':_0x1be464[_0x29f34a(0x236)],'product_code':_0x1be464[_0x29f34a(0x27c)],'bay':_0x1be464[_0x29f34a(0x2bf)],'batch_code':_0x1be464[_0x29f34a(0x1fa)],'maxPerUnit':_0x1be464[_0x29f34a(0x29c)],'production_date':_0x1be464[_0x29f34a(0x249)],'expiry_date':_0x1be464[_0x29f34a(0x26f)],'secondary_unit':_0x1be464[_0x29f34a(0x217)],'unit':_0x1be464[_0x29f34a(0x2e2)],'maxProducts':_0x1be464[_0x29f34a(0x277)]}));}),await _0x4fb2a0[_0x1ed0a9(0x305)](),console['log'](_0x329b4a[_0x1ed0a9(0x2be)]);const _0x13579f=new c_payment_data({'invoice':_0x21c8a4,'customer':_0x329b4a['body']['customer'],'reason':_0x1ed0a9(0x30d)});await _0x13579f[_0x1ed0a9(0x305)]();const _0x1f53f6=await master_shop[_0x1ed0a9(0x25c)]();console[_0x1ed0a9(0x269)]('add\x20post',_0x1f53f6[0x0][_0x1ed0a9(0x208)]);const _0x4bffcf=await email_settings[_0x1ed0a9(0x2bb)](),_0x5dccc9=await customer[_0x1ed0a9(0x2bb)]({'name':_0x329b4a[_0x1ed0a9(0x2be)][_0x1ed0a9(0x240)]});console[_0x1ed0a9(0x269)](_0x1ed0a9(0x27a),_0x5dccc9);_0x1f53f6[0x0][_0x1ed0a9(0x1f2)]==0x1?(right_currency=_0x1f53f6[0x0][_0x1ed0a9(0x2ec)],left_currency=''):(right_currency='',left_currency=_0x1f53f6[0x0][_0x1ed0a9(0x2ec)]);var _0x229316=_0x266bf9,_0x3bbb2b=_0x16de4c,_0x1385c9='',_0x59f37f;for(_0x59f37f in _0x229316){_0x1385c9+=_0x1ed0a9(0x308)+_0x1ed0a9(0x281)+_0x229316[_0x59f37f]+_0x1ed0a9(0x2a1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3bbb2b[_0x59f37f]+_0x1ed0a9(0x2a1)+_0x1ed0a9(0x216);}console[_0x1ed0a9(0x269)](_0x1ed0a9(0x22c),_0x1385c9);let _0x528a69=nodemailer[_0x1ed0a9(0x303)]({'service':'gmail','auth':{'user':_0x4bffcf[_0x1ed0a9(0x2c6)],'pass':_0x4bffcf[_0x1ed0a9(0x2c0)]}}),_0x402f54={'from':_0x4bffcf[_0x1ed0a9(0x2c6)],'to':_0x5dccc9[_0x1ed0a9(0x2c6)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x1ed0a9(0x2d7),'path':__dirname+_0x1ed0a9(0x26d)+_0x1ed0a9(0x21b)+_0x1f53f6[0x0][_0x1ed0a9(0x208)],'cid':_0x1ed0a9(0x286)}],'html':_0x1ed0a9(0x1ed)+'<html><head><title></title>'+_0x1ed0a9(0x292)+_0x1ed0a9(0x2fe)+_0x1ed0a9(0x21c)+'<div>'+_0x1ed0a9(0x2f0)+'</div>'+_0x1ed0a9(0x2fe)+'<h2>\x20'+_0x1f53f6[0x0][_0x1ed0a9(0x319)]+_0x1ed0a9(0x26c)+_0x1ed0a9(0x265)+'</div>'+_0x1ed0a9(0x314)+_0x1ed0a9(0x2fe)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x21c8a4+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x1ed0a9(0x2ba)+_0x5a77ce+'\x20'+_0x1ed0a9(0x307)+'</h5>'+_0x1ed0a9(0x265)+_0x1ed0a9(0x2c5)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1ed0a9(0x308)+_0x1ed0a9(0x299)+_0x1ed0a9(0x2af)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x1ed0a9(0x28c)+'</tr>'+_0x1ed0a9(0x237)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1385c9+'\x20'+_0x1ed0a9(0x259)+_0x1ed0a9(0x2e3)+_0x1ed0a9(0x2fe)+_0x1ed0a9(0x313)+'<h5>'+_0x1f53f6[0x0][_0x1ed0a9(0x319)]+_0x1ed0a9(0x252)+_0x1ed0a9(0x265)+_0x1ed0a9(0x265)+_0x1ed0a9(0x2ae)};_0x528a69[_0x1ed0a9(0x2c1)](_0x402f54,function(_0xa3d168,_0x251a79){var _0x4fd638=_0x1ed0a9;_0xa3d168?(console['log'](_0xa3d168),console[_0x4fd638(0x269)]('Error\x20Occurs')):console['log'](_0x4fd638(0x2d3));}),_0x329b4a[_0x1ed0a9(0x28d)](_0x1ed0a9(0x257),_0x1ed0a9(0x302)),_0xaafd52['redirect'](_0x1ed0a9(0x2c8));}catch(_0x5829fa){console[_0x1ed0a9(0x269)](_0x5829fa),_0xaafd52[_0x1ed0a9(0x21d)](0xc8)[_0x1ed0a9(0x24a)]({'message1':_0x5829fa[_0x1ed0a9(0x20f)]});}}}),router['get']('/barcode/:id',auth,async(_0x507979,_0x3da4d9)=>{var _0x5696ce=a0_0x36fbec;try{const {username:_0x547b55,email:_0x3bd57e,role:_0x1295f7}=_0x507979[_0x5696ce(0x1ff)],_0x55716b=_0x507979[_0x5696ce(0x1ff)],_0x1e55d4=await profile[_0x5696ce(0x2bb)]({'email':_0x55716b[_0x5696ce(0x2c6)]}),_0x30eb69=await master_shop['find']();console[_0x5696ce(0x269)](_0x5696ce(0x229),_0x30eb69);const _0x224f90=_0x507979['params']['id'],_0x286adf=await sales[_0x5696ce(0x30b)](_0x224f90);console[_0x5696ce(0x269)](_0x5696ce(0x28a),_0x286adf);if(_0x30eb69[0x0][_0x5696ce(0x2b9)]==_0x5696ce(0x312))var _0x26fb88=users['English'];else{if(_0x30eb69[0x0][_0x5696ce(0x2b9)]=='Hindi')var _0x26fb88=users[_0x5696ce(0x21f)];else{if(_0x30eb69[0x0][_0x5696ce(0x2b9)]==_0x5696ce(0x246))var _0x26fb88=users[_0x5696ce(0x246)];else{if(_0x30eb69[0x0]['language']==_0x5696ce(0x267))var _0x26fb88=users[_0x5696ce(0x267)];else{if(_0x30eb69[0x0][_0x5696ce(0x2b9)]==_0x5696ce(0x248))var _0x26fb88=users[_0x5696ce(0x248)];else{if(_0x30eb69[0x0][_0x5696ce(0x2b9)]==_0x5696ce(0x29a))var _0x26fb88=users[_0x5696ce(0x2de)];else{if(_0x30eb69[0x0]['language']=='Chinese')var _0x26fb88=users['Chinese'];else{if(_0x30eb69[0x0][_0x5696ce(0x2b9)]==_0x5696ce(0x2ac))var _0x26fb88=users[_0x5696ce(0x25f)];}}}}}}}_0x3da4d9[_0x5696ce(0x242)]('all_sales_barcode',{'success':_0x507979[_0x5696ce(0x28d)](_0x5696ce(0x257)),'errors':_0x507979['flash'](_0x5696ce(0x2b1)),'role':_0x55716b,'profile':_0x1e55d4,'alldata':_0x286adf,'master_shop':_0x30eb69,'language':_0x26fb88});}catch(_0x3eefb9){console[_0x5696ce(0x269)](_0x3eefb9);}}),router[a0_0x36fbec(0x2e4)]('/barcode_scanner',async(_0x4d02d9,_0x3400d3)=>{var _0x10e006=a0_0x36fbec;const {product_code:_0xa6fa06,warehouse_name:_0x35df0e,rooms_data:_0x5fcfcd,Roomslist:_0x4e585e,sales_category:_0x1ba913}=_0x4d02d9[_0x10e006(0x2be)],_0x42246a=_0x4e585e[_0x10e006(0x2cb)](','),_0x393d17=[];async function _0x2acd24(_0x1b067b){var _0x59340a=_0x10e006;const _0x4ee99b=await warehouse['aggregate']([{'$match':{'name':_0x35df0e,'room':_0x1b067b}},{'$unwind':_0x59340a(0x21e)},{'$match':{'product_details.primary_code':_0xa6fa06}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x59340a(0x24c)},'product_stock':{'$first':_0x59340a(0x215)},'primary_code':{'$first':_0x59340a(0x2a4)},'secondary_code':{'$first':_0x59340a(0x26b)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x59340a(0x22f)},'bay':{'$first':_0x59340a(0x2a9)},'type':{'$first':_0x59340a(0x214)},'pallet':{'$first':_0x59340a(0x275)},'unit':{'$first':_0x59340a(0x23e)},'secondary_unit':{'$first':_0x59340a(0x2b0)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x59340a(0x212)},'expiry_date':{'$first':_0x59340a(0x256)},'production_date':{'$first':_0x59340a(0x1f1)},'maxPerUnit':{'$first':_0x59340a(0x206)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x59340a(0x310)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x59340a(0x2df)},'invoice':{'$first':_0x59340a(0x27f)},'uuid':{'$first':_0x59340a(0x28b)},'gross_price':{'$first':_0x59340a(0x27d)},'sales_category':{'$first':_0x59340a(0x26a)}}}]),_0x31621a=await warehouse['aggregate']([{'$match':{'name':_0x35df0e,'room':_0x1b067b}},{'$unwind':_0x59340a(0x21e)},{'$match':{'product_details.secondary_code':_0xa6fa06}},{'$group':{'_id':_0x59340a(0x2c4),'name':{'$first':_0x59340a(0x24c)},'product_stock':{'$first':_0x59340a(0x215)},'primary_code':{'$first':_0x59340a(0x2a4)},'secondary_code':{'$first':_0x59340a(0x26b)},'product_code':{'$first':_0x59340a(0x27b)},'level':{'$first':_0x59340a(0x2a9)},'isle':{'$first':_0x59340a(0x271)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x59340a(0x275)},'unit':{'$first':_0x59340a(0x23e)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x59340a(0x260)},'rack':{'$first':_0x59340a(0x212)},'expiry_date':{'$first':_0x59340a(0x256)},'production_date':{'$first':_0x59340a(0x1f1)},'maxPerUnit':{'$first':_0x59340a(0x206)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x59340a(0x310)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x59340a(0x2df)},'invoice':{'$first':_0x59340a(0x27f)},'uuid':{'$first':_0x59340a(0x28b)},'gross_price':{'$first':_0x59340a(0x27d)},'sales_category':{'$first':_0x59340a(0x26a)}}}]);if(_0x4ee99b[_0x59340a(0x2ef)]>0x0)_0x393d17[_0x59340a(0x1f6)](_0x4ee99b);else _0x31621a[_0x59340a(0x2ef)]>0x0&&_0x393d17['push'](_0x31621a);}const _0x28efb6=_0x42246a['map'](_0x4fc15c=>_0x2acd24(_0x4fc15c));await Promise['all'](_0x28efb6),_0x3400d3['json'](_0x393d17);}),router[a0_0x36fbec(0x2e4)](a0_0x36fbec(0x1f4),async(_0x5a93ee,_0x1bd2db)=>{var _0xa48b8d=a0_0x36fbec;const {product_code:_0x58ee26,warehouse_name:_0x57d15d,rooms_data:_0xe16d,Roomslist:_0x5b068b,sales_category:_0x22d4e0}=_0x5a93ee[_0xa48b8d(0x2be)],_0x7f22d5=_0x5b068b[_0xa48b8d(0x2cb)](','),_0x2b874f=[];async function _0x3c509f(_0x16e1ed){var _0x300969=_0xa48b8d;const _0x155c6f=await warehouse[_0x300969(0x20e)]([{'$match':{'name':_0x57d15d,'room':_0x16e1ed}},{'$unwind':_0x300969(0x21e)},{'$match':{'product_details.primary_code':_0x58ee26,'product_details.sales_category':_0x22d4e0,'product_details.type_products':_0x300969(0x269)}},{'$group':{'_id':_0x300969(0x2c4),'name':{'$first':_0x300969(0x24c)},'product_stock':{'$first':_0x300969(0x215)},'primary_code':{'$first':_0x300969(0x2a4)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x300969(0x27b)},'level':{'$first':_0x300969(0x22f)},'bay':{'$first':_0x300969(0x2a9)},'type':{'$first':_0x300969(0x214)},'pallet':{'$first':_0x300969(0x275)},'unit':{'$first':_0x300969(0x23e)},'secondary_unit':{'$first':_0x300969(0x2b0)},'storage':{'$first':_0x300969(0x260)},'rack':{'$first':_0x300969(0x212)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x300969(0x1f1)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x300969(0x27f)},'uuid':{'$first':_0x300969(0x28b)},'gross_price':{'$first':_0x300969(0x27d)},'sales_category':{'$first':_0x300969(0x26a)},'type_products':{'$first':'$product_details.type_products'}}}]);console[_0x300969(0x269)](_0x300969(0x269)+'\x20<>\x20'+_0x58ee26+_0x300969(0x2f1)+_0x22d4e0);const _0x4f9c40=await warehouse[_0x300969(0x20e)]([{'$match':{'name':_0x57d15d,'room':_0x16e1ed}},{'$unwind':_0x300969(0x21e)},{'$match':{'product_details.secondary_code':_0x58ee26,'product_details.sales_category':_0x22d4e0,'product_details.type_products':_0x300969(0x269)}},{'$group':{'_id':_0x300969(0x2c4),'name':{'$first':_0x300969(0x24c)},'product_stock':{'$first':_0x300969(0x215)},'primary_code':{'$first':_0x300969(0x2a4)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x300969(0x2a9)},'isle':{'$first':_0x300969(0x271)},'type':{'$first':_0x300969(0x214)},'pallet':{'$first':_0x300969(0x275)},'unit':{'$first':_0x300969(0x23e)},'secondary_unit':{'$first':_0x300969(0x2b0)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x300969(0x206)},'batch_code':{'$first':_0x300969(0x244)},'product_cat':{'$first':_0x300969(0x310)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x300969(0x2df)},'invoice':{'$first':_0x300969(0x27f)},'uuid':{'$first':_0x300969(0x28b)},'gross_price':{'$first':_0x300969(0x27d)},'sales_category':{'$first':_0x300969(0x26a)},'type_products':{'$first':_0x300969(0x2d5)}}}]);if(_0x155c6f[_0x300969(0x2ef)]>0x0)_0x2b874f['push'](_0x155c6f);else _0x4f9c40[_0x300969(0x2ef)]>0x0&&_0x2b874f[_0x300969(0x1f6)](_0x4f9c40);}const _0x42c4f2=_0x7f22d5[_0xa48b8d(0x23a)](_0x4c1b19=>_0x3c509f(_0x4c1b19));await Promise[_0xa48b8d(0x227)](_0x42c4f2),_0x1bd2db[_0xa48b8d(0x24a)](_0x2b874f);}),module[a0_0x36fbec(0x288)]=router;