var a0_0x563031=a0_0x22e3;(function(_0x46b642,_0xb09fcd){var _0x1fd770=a0_0x22e3,_0x16acde=_0x46b642();while(!![]){try{var _0x3c1561=-parseInt(_0x1fd770(0xbc))/0x1+-parseInt(_0x1fd770(0xf1))/0x2*(-parseInt(_0x1fd770(0x148))/0x3)+-parseInt(_0x1fd770(0x15e))/0x4+parseInt(_0x1fd770(0x104))/0x5+parseInt(_0x1fd770(0xe8))/0x6+-parseInt(_0x1fd770(0x114))/0x7*(-parseInt(_0x1fd770(0xb9))/0x8)+-parseInt(_0x1fd770(0x13c))/0x9*(-parseInt(_0x1fd770(0x188))/0xa);if(_0x3c1561===_0xb09fcd)break;else _0x16acde['push'](_0x16acde['shift']());}catch(_0x5148cb){_0x16acde['push'](_0x16acde['shift']());}}}(a0_0x26a2,0x2473e));const express=require(a0_0x563031(0x14d)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x563031(0x1b1)),auth=require(a0_0x563031(0xc5)),nodemailer=require(a0_0x563031(0x18b)),users=require('../public/language/languages.json');router[a0_0x563031(0xec)](a0_0x563031(0xda),auth,async(_0x479506,_0x54953b)=>{var _0x1b1b5e=a0_0x563031;try{const {username:_0x4f5b26,email:_0x14f3ad,role:_0x10179b}=_0x479506[_0x1b1b5e(0x134)],_0x525327=_0x479506[_0x1b1b5e(0x134)],_0x384507=await profile[_0x1b1b5e(0xa2)]({'email':_0x525327[_0x1b1b5e(0xa0)]}),_0x2b8f8d=await master_shop['find']();let _0x2924de;if(_0x525327[_0x1b1b5e(0xb4)]==_0x1b1b5e(0x158)){const _0x49d74b=await staff['findOne']({'email':_0x525327['email']});_0x2924de=await sales_finished[_0x1b1b5e(0x17f)]([{'$match':{'typeOfProducts':_0x1b1b5e(0x142)}},{'$unwind':_0x1b1b5e(0x135)},{'$group':{'_id':_0x1b1b5e(0xc3),'invoice':{'$first':_0x1b1b5e(0x157)},'customers':{'$first':'$customer'},'date':{'$first':_0x1b1b5e(0x14b)},'warehouse_name':{'$first':_0x1b1b5e(0xbb)},'sale_product':{'$push':_0x1b1b5e(0x135)},'note':{'$first':_0x1b1b5e(0x183)},'return_data':{'$first':_0x1b1b5e(0x1a5)},'customers_docs':{'$first':_0x1b1b5e(0xa6)},'total_saleproduct_quantity':{'$sum':_0x1b1b5e(0x155)},'level':{'$addToSet':_0x1b1b5e(0xcb)},'isle':{'$addToSet':_0x1b1b5e(0x187)},'type':{'$addToSet':_0x1b1b5e(0x1ae)},'pallet':{'$addToSet':_0x1b1b5e(0xe2)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x2924de=await sales_finished[_0x1b1b5e(0x17f)]([{'$match':{'typeOfProducts':'own'}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x1b1b5e(0xc3),'invoice':{'$first':_0x1b1b5e(0x157)},'customers':{'$first':_0x1b1b5e(0x11e)},'date':{'$first':_0x1b1b5e(0x14b)},'warehouse_name':{'$first':_0x1b1b5e(0xbb)},'sale_product':{'$push':_0x1b1b5e(0x135)},'note':{'$first':'$note'},'return_data':{'$first':_0x1b1b5e(0x1a5)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x1b1b5e(0x155)},'level':{'$addToSet':_0x1b1b5e(0xcb)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x1b1b5e(0xe2)},'finalize':{'$first':_0x1b1b5e(0xb0)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x2b8f8d[0x0][_0x1b1b5e(0x166)]==_0x1b1b5e(0x103)){var _0x45367e=users[_0x1b1b5e(0x1a4)];console[_0x1b1b5e(0xa9)](_0x45367e);}else{if(_0x2b8f8d[0x0]['language']==_0x1b1b5e(0x97))var _0x45367e=users[_0x1b1b5e(0x97)];else{if(_0x2b8f8d[0x0][_0x1b1b5e(0x166)]=='German')var _0x45367e=users[_0x1b1b5e(0x140)];else{if(_0x2b8f8d[0x0][_0x1b1b5e(0x166)]==_0x1b1b5e(0x102))var _0x45367e=users[_0x1b1b5e(0x102)];else{if(_0x2b8f8d[0x0]['language']==_0x1b1b5e(0x171))var _0x45367e=users[_0x1b1b5e(0x171)];else{if(_0x2b8f8d[0x0][_0x1b1b5e(0x166)]==_0x1b1b5e(0xd9))var _0x45367e=users['Portuguese'];else{if(_0x2b8f8d[0x0][_0x1b1b5e(0x166)]=='Chinese')var _0x45367e=users[_0x1b1b5e(0x196)];else{if(_0x2b8f8d[0x0][_0x1b1b5e(0x166)]==_0x1b1b5e(0xfc))var _0x45367e=users['Arabic'];}}}}}}}_0x54953b[_0x1b1b5e(0xdc)](_0x1b1b5e(0x10b),{'success':_0x479506[_0x1b1b5e(0x159)]('success'),'errors':_0x479506[_0x1b1b5e(0x159)](_0x1b1b5e(0x118)),'sales':_0x2924de,'profile':_0x384507,'role':_0x525327,'master_shop':_0x2b8f8d,'language':_0x45367e});}catch(_0x530caa){console[_0x1b1b5e(0xa9)](_0x530caa);}}),router['get']('/view_log',auth,async(_0x176744,_0x4b0b01)=>{var _0x1e12e2=a0_0x563031;try{const {username:_0x1084a4,email:_0x3ff277,role:_0x271048}=_0x176744[_0x1e12e2(0x134)],_0x5eb091=_0x176744['user'],_0x42cb7b=await profile[_0x1e12e2(0xa2)]({'email':_0x5eb091[_0x1e12e2(0xa0)]}),_0x5dd447=await master_shop[_0x1e12e2(0xd3)]();let _0x19ad7c;if(_0x5eb091[_0x1e12e2(0xb4)]==_0x1e12e2(0x158)){const _0x1ee10a=await staff[_0x1e12e2(0xa2)]({'email':_0x5eb091[_0x1e12e2(0xa0)]});_0x19ad7c=await sales_finished[_0x1e12e2(0x17f)]([{'$match':{'typeOfProducts':'logs'}},{'$unwind':_0x1e12e2(0x135)},{'$group':{'_id':_0x1e12e2(0xc3),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x1e12e2(0x11e)},'date':{'$first':_0x1e12e2(0x14b)},'warehouse_name':{'$first':_0x1e12e2(0xbb)},'sale_product':{'$push':_0x1e12e2(0x135)},'note':{'$first':_0x1e12e2(0x183)},'return_data':{'$first':_0x1e12e2(0x1a5)},'customers_docs':{'$first':_0x1e12e2(0xa6)},'total_saleproduct_quantity':{'$sum':_0x1e12e2(0x155)},'level':{'$addToSet':_0x1e12e2(0xcb)},'isle':{'$addToSet':_0x1e12e2(0x187)},'type':{'$addToSet':_0x1e12e2(0x1ae)},'pallet':{'$addToSet':_0x1e12e2(0xe2)},'finalize':{'$first':_0x1e12e2(0xb0)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x19ad7c=await sales_finished['aggregate']([{'$match':{'typeOfProducts':'logs'}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x1e12e2(0xc3),'invoice':{'$first':_0x1e12e2(0x157)},'customers':{'$first':'$customer'},'date':{'$first':_0x1e12e2(0x14b)},'warehouse_name':{'$first':_0x1e12e2(0xbb)},'sale_product':{'$push':_0x1e12e2(0x135)},'note':{'$first':_0x1e12e2(0x183)},'return_data':{'$first':_0x1e12e2(0x1a5)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x1e12e2(0x155)},'level':{'$addToSet':_0x1e12e2(0xcb)},'isle':{'$addToSet':_0x1e12e2(0x187)},'type':{'$addToSet':_0x1e12e2(0x1ae)},'pallet':{'$addToSet':_0x1e12e2(0xe2)},'finalize':{'$first':_0x1e12e2(0xb0)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x5dd447[0x0][_0x1e12e2(0x166)]=='English\x20(US)'){var _0x58291d=users['English'];console['log'](_0x58291d);}else{if(_0x5dd447[0x0]['language']==_0x1e12e2(0x97))var _0x58291d=users[_0x1e12e2(0x97)];else{if(_0x5dd447[0x0][_0x1e12e2(0x166)]==_0x1e12e2(0x140))var _0x58291d=users['German'];else{if(_0x5dd447[0x0][_0x1e12e2(0x166)]==_0x1e12e2(0x102))var _0x58291d=users['Spanish'];else{if(_0x5dd447[0x0][_0x1e12e2(0x166)]==_0x1e12e2(0x171))var _0x58291d=users[_0x1e12e2(0x171)];else{if(_0x5dd447[0x0][_0x1e12e2(0x166)]=='Portuguese\x20(BR)')var _0x58291d=users[_0x1e12e2(0x9a)];else{if(_0x5dd447[0x0][_0x1e12e2(0x166)]=='Chinese')var _0x58291d=users[_0x1e12e2(0x196)];else{if(_0x5dd447[0x0][_0x1e12e2(0x166)]=='Arabic\x20(ae)')var _0x58291d=users['Arabic'];}}}}}}}_0x4b0b01[_0x1e12e2(0xdc)](_0x1e12e2(0xdd),{'success':_0x176744[_0x1e12e2(0x159)](_0x1e12e2(0x161)),'errors':_0x176744[_0x1e12e2(0x159)](_0x1e12e2(0x118)),'sales':_0x19ad7c,'profile':_0x42cb7b,'role':_0x5eb091,'master_shop':_0x5dd447,'language':_0x58291d});}catch(_0x5c8a57){console[_0x1e12e2(0xa9)](_0x5c8a57);}});async function getRandom8DigitNumber(){var _0x4efaeb=a0_0x563031;const _0x14d93a=0x989680,_0x2c3a50=0x5f5e0ff,_0x629e9c=Math[_0x4efaeb(0xd1)](Math[_0x4efaeb(0xe9)]()*(_0x2c3a50-_0x14d93a+0x1))+_0x14d93a;var _0x36425d;const _0x5d3462=await sales_finished['findOne']({'invoice':'OUTF-'+_0x629e9c});return _0x5d3462&&_0x5d3462[_0x4efaeb(0x120)]>0x0?_0x36425d='OUTF-'+_0x629e9c:_0x36425d=_0x4efaeb(0x9d)+_0x629e9c,_0x36425d;}function a0_0x22e3(_0xb354c1,_0x41afe0){var _0x26a262=a0_0x26a2();return a0_0x22e3=function(_0x22e3de,_0x3ebb11){_0x22e3de=_0x22e3de-0x97;var _0x2ea5b8=_0x26a262[_0x22e3de];return _0x2ea5b8;},a0_0x22e3(_0xb354c1,_0x41afe0);}router[a0_0x563031(0xec)](a0_0x563031(0x10d),auth,async(_0x2603b5,_0x8fa9c8)=>{var _0x4ac2c6=a0_0x563031;try{const {username:_0x122d94,email:_0x142b53,role:_0x215a08}=_0x2603b5['user'],_0x593991=_0x2603b5[_0x4ac2c6(0x134)],_0x52c539=await profile[_0x4ac2c6(0xa2)]({'email':_0x593991[_0x4ac2c6(0xa0)]}),_0x44c2e0=await master_shop[_0x4ac2c6(0xd3)](),_0x2605e3=await customer[_0x4ac2c6(0xd3)]({});let _0x31c93a;if(_0x593991[_0x4ac2c6(0xb4)]==_0x4ac2c6(0x158)){const _0xe8da9c=await staff[_0x4ac2c6(0xa2)]({'email':_0x593991[_0x4ac2c6(0xa0)]});_0x31c93a=await warehouse[_0x4ac2c6(0x17f)]([{'$match':{'status':_0x4ac2c6(0x106),'name':_0xe8da9c['warehouse']}},{'$group':{'_id':_0x4ac2c6(0xf4),'name':{'$first':_0x4ac2c6(0xf4)}}},{'$sort':{'name':0x1}}]);}else _0x31c93a=await warehouse['aggregate']([{'$match':{'status':_0x4ac2c6(0x106)}},{'$group':{'_id':_0x4ac2c6(0xf4),'name':{'$first':_0x4ac2c6(0xf4)}}},{'$sort':{'name':0x1}}]);const _0x3c5d6e=await product[_0x4ac2c6(0xd3)]({});var _0x21a9b1=[_0x4ac2c6(0xf0),_0x4ac2c6(0x15b)];const _0x1ab038=await sales_finished[_0x4ac2c6(0xd3)]({}),_0x287682=_0x1ab038[_0x4ac2c6(0x120)]+0x1,_0x3091c0=_0x4ac2c6(0x9d)+_0x287682[_0x4ac2c6(0x111)]()[_0x4ac2c6(0xc6)](0x5,'0');if(_0x44c2e0[0x0][_0x4ac2c6(0x166)]==_0x4ac2c6(0x103)){var _0x5655aa=users[_0x4ac2c6(0x1a4)];console[_0x4ac2c6(0xa9)](_0x5655aa);}else{if(_0x44c2e0[0x0][_0x4ac2c6(0x166)]==_0x4ac2c6(0x97))var _0x5655aa=users['Hindi'];else{if(_0x44c2e0[0x0][_0x4ac2c6(0x166)]==_0x4ac2c6(0x140))var _0x5655aa=users[_0x4ac2c6(0x140)];else{if(_0x44c2e0[0x0][_0x4ac2c6(0x166)]==_0x4ac2c6(0x102))var _0x5655aa=users[_0x4ac2c6(0x102)];else{if(_0x44c2e0[0x0][_0x4ac2c6(0x166)]=='French')var _0x5655aa=users[_0x4ac2c6(0x171)];else{if(_0x44c2e0[0x0][_0x4ac2c6(0x166)]==_0x4ac2c6(0xd9))var _0x5655aa=users[_0x4ac2c6(0x9a)];else{if(_0x44c2e0[0x0][_0x4ac2c6(0x166)]==_0x4ac2c6(0x196))var _0x5655aa=users['Chinese'];else{if(_0x44c2e0[0x0][_0x4ac2c6(0x166)]==_0x4ac2c6(0xfc))var _0x5655aa=users['Arabic'];}}}}}}}const _0x88ffd2=getRandom8DigitNumber();_0x88ffd2[_0x4ac2c6(0x19c)](_0x472e7f=>{var _0x25fdf5=_0x4ac2c6;_0x8fa9c8[_0x25fdf5(0xdc)]('add_sales_finished',{'success':_0x2603b5['flash']('success'),'errors':_0x2603b5[_0x25fdf5(0x159)](_0x25fdf5(0x118)),'role':_0x593991,'profile':_0x52c539,'customer':_0x2605e3,'warehouse':_0x31c93a,'product':_0x3c5d6e,'invoice':_0x472e7f,'master_shop':_0x44c2e0,'language':_0x5655aa,'rooms_data':_0x21a9b1});})[_0x4ac2c6(0x184)](_0x5e631d=>{var _0x589c06=_0x4ac2c6;_0x2603b5[_0x589c06(0x159)](_0x589c06(0x118),_0x589c06(0xa1)),_0x8fa9c8[_0x589c06(0x146)](_0x589c06(0x127));});}catch(_0x3b62d8){console[_0x4ac2c6(0xa9)](_0x3b62d8);}}),router[a0_0x563031(0xec)](a0_0x563031(0x185),auth,async(_0x59acef,_0x389c36)=>{var _0x5d176e=a0_0x563031;try{const {username:_0x2bd87e,email:_0x45aa35,role:_0x6b689e}=_0x59acef['user'],_0x1e5c6f=_0x59acef[_0x5d176e(0x134)],_0x1dfb6c=await profile[_0x5d176e(0xa2)]({'email':_0x1e5c6f[_0x5d176e(0xa0)]}),_0x612a61=await master_shop[_0x5d176e(0xd3)](),_0x55c527=await customer['find']({});let _0x2f364f;if(_0x1e5c6f['role']=='staff'){const _0x2ab604=await staff[_0x5d176e(0xa2)]({'email':_0x1e5c6f[_0x5d176e(0xa0)]});_0x2f364f=await warehouse['aggregate']([{'$match':{'status':_0x5d176e(0x106),'name':_0x2ab604[_0x5d176e(0x156)]}},{'$group':{'_id':_0x5d176e(0xf4),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x2f364f=await warehouse[_0x5d176e(0x17f)]([{'$match':{'status':_0x5d176e(0x106)}},{'$group':{'_id':'$name','name':{'$first':_0x5d176e(0xf4)}}},{'$sort':{'name':0x1}}]);const _0x3e4ea5=await product[_0x5d176e(0xd3)]({});var _0xada5f7=['Ambient','Enclosed'];const _0x2d7e0e=await sales_finished[_0x5d176e(0xd3)]({}),_0x4e8b7b=_0x2d7e0e[_0x5d176e(0x120)]+0x1,_0x47d9eb=_0x5d176e(0x9d)+_0x4e8b7b[_0x5d176e(0x111)]()[_0x5d176e(0xc6)](0x5,'0');if(_0x612a61[0x0]['language']==_0x5d176e(0x103)){var _0x40e4c2=users['English'];console[_0x5d176e(0xa9)](_0x40e4c2);}else{if(_0x612a61[0x0]['language']=='Hindi')var _0x40e4c2=users[_0x5d176e(0x97)];else{if(_0x612a61[0x0][_0x5d176e(0x166)]==_0x5d176e(0x140))var _0x40e4c2=users[_0x5d176e(0x140)];else{if(_0x612a61[0x0]['language']==_0x5d176e(0x102))var _0x40e4c2=users[_0x5d176e(0x102)];else{if(_0x612a61[0x0][_0x5d176e(0x166)]==_0x5d176e(0x171))var _0x40e4c2=users[_0x5d176e(0x171)];else{if(_0x612a61[0x0][_0x5d176e(0x166)]==_0x5d176e(0xd9))var _0x40e4c2=users[_0x5d176e(0x9a)];else{if(_0x612a61[0x0]['language']==_0x5d176e(0x196))var _0x40e4c2=users[_0x5d176e(0x196)];else{if(_0x612a61[0x0][_0x5d176e(0x166)]=='Arabic\x20(ae)')var _0x40e4c2=users[_0x5d176e(0xaa)];}}}}}}}const _0x2e83f4=getRandom8DigitNumber();_0x2e83f4['then'](_0x4327a9=>{var _0x46a1aa=_0x5d176e;_0x389c36[_0x46a1aa(0xdc)](_0x46a1aa(0x133),{'success':_0x59acef[_0x46a1aa(0x159)](_0x46a1aa(0x161)),'errors':_0x59acef['flash'](_0x46a1aa(0x118)),'role':_0x1e5c6f,'profile':_0x1dfb6c,'customer':_0x55c527,'warehouse':_0x2f364f,'product':_0x3e4ea5,'invoice':_0x4327a9,'master_shop':_0x612a61,'language':_0x40e4c2,'rooms_data':_0xada5f7});})[_0x5d176e(0x184)](_0x1195fc=>{var _0x8ab5bd=_0x5d176e;_0x59acef[_0x8ab5bd(0x159)]('errors',_0x8ab5bd(0xa1)),_0x389c36['redirect'](_0x8ab5bd(0x127));});}catch(_0x423e52){console[_0x5d176e(0xa9)](_0x423e52);}}),router[a0_0x563031(0x1ab)](a0_0x563031(0x185),auth,async(_0x162f36,_0x179eb3)=>{var _0x5ed267=a0_0x563031;try{const {invoice:_0x1b2539,date:_0x640ac1,warehouse_name:_0x38b787,product_name:_0x231401,note:_0x53b59a,room:_0x213cfd,primary_code:_0x5e70ad,secondary_code:_0x362522,prod_code:_0x102cba,SCRN:_0x3b3baa,ReqBy:_0x26c541,dateofreq:_0x4f97bf,PO_number:_0x8289d3,typeservicesData:_0x1bdeab,typevehicle:_0x1593eb,destination:_0x4b1606,deliverydate:_0x240cee,driver:_0x218a53,plate:_0x1d7a35,van:_0x399749,DRSI:_0x415c02,TSU:_0x55d057,TFU:_0x108e11,mode_transpo:_0x21e249,name_driver:_0x397b74,type_of_products:_0xae1922}=_0x162f36['body'];if(typeof _0x231401==_0x5ed267(0x151))var _0x13ea9b=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x10a)]],_0xd668a1=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0xc8)]],_0x1f49cd=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0xe1)]],_0x105c8c=[_0x162f36['body']['primary_code']],_0x24f270=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x10f)]],_0x13692b=[_0x162f36['body'][_0x5ed267(0x119)]],_0x34ec08=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x1b4)]],_0x557f0c=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x126)]],_0xee69e3=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x1b2)]],_0x53e86a=[_0x162f36['body'][_0x5ed267(0x10e)]],_0x3082c2=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x123)]],_0x3337ad=[_0x162f36['body']['product_date']],_0x3f754f=[_0x162f36[_0x5ed267(0x144)]['max_per_unit']],_0x4ba84a=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x136)]],_0x2adc21=[_0x162f36['body']['RoomAssigned']],_0x3a0856=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x16d)]],_0x108923=[_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x110)]],_0x56dd56=[_0x162f36['body'][_0x5ed267(0xe0)]],_0x4341f6=[_0x162f36[_0x5ed267(0x144)]['gross_price']];else var _0x13ea9b=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x10a)]],_0xd668a1=[..._0x162f36['body'][_0x5ed267(0xc8)]],_0x1f49cd=[..._0x162f36['body'][_0x5ed267(0xe1)]],_0x105c8c=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x138)]],_0x24f270=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x10f)]],_0x13692b=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x119)]],_0x34ec08=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x1b4)]],_0x557f0c=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x126)]],_0xee69e3=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x1b2)]],_0x53e86a=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x10e)]],_0x3082c2=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0x123)]],_0x3337ad=[..._0x162f36['body'][_0x5ed267(0x153)]],_0x3f754f=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0xb6)]],_0x4ba84a=[..._0x162f36[_0x5ed267(0x144)]['prod_cat']],_0x2adc21=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0xcf)]],_0x3a0856=[..._0x162f36['body'][_0x5ed267(0x16d)]],_0x108923=[..._0x162f36[_0x5ed267(0x144)]['id_transaction_from']],_0x56dd56=[..._0x162f36[_0x5ed267(0x144)][_0x5ed267(0xe0)]],_0x4341f6=[..._0x162f36[_0x5ed267(0x144)]['gross_price']];const _0x5f08a8=_0x13ea9b[_0x5ed267(0x17a)](_0x3d24ab=>{return _0x3d24ab={'product_name':_0x3d24ab};});_0xd668a1[_0x5ed267(0x150)]((_0x62f1ec,_0x3adb7c)=>{var _0x386db7=_0x5ed267;_0x5f08a8[_0x3adb7c][_0x386db7(0xc8)]=_0x62f1ec;}),_0x1f49cd['forEach']((_0x21a60f,_0x63367)=>{_0x5f08a8[_0x63367]['quantity']=Math['abs'](_0x21a60f);}),_0x13ea9b[_0x5ed267(0x150)]((_0x5105cd,_0x260bcd)=>{var _0x74b445=_0x5ed267;_0x5f08a8[_0x260bcd][_0x74b445(0x18c)]=_0x162f36[_0x74b445(0x144)][_0x74b445(0xee)];}),_0x4341f6[_0x5ed267(0x150)]((_0x2ca331,_0x3c3875)=>{var _0x17720b=_0x5ed267;_0x5f08a8[_0x3c3875][_0x17720b(0xf6)]=_0x2ca331;}),_0x56dd56[_0x5ed267(0x150)]((_0x3f4199,_0x3e550c)=>{var _0x6020c0=_0x5ed267;_0x5f08a8[_0x3e550c][_0x6020c0(0xe0)]=_0x3f4199;}),_0x108923['forEach']((_0x5f5099,_0xac4fc)=>{_0x5f08a8[_0xac4fc]['id_transaction_from']=_0x5f5099;}),_0x105c8c[_0x5ed267(0x150)]((_0x54a75f,_0x1d6868)=>{var _0x4dedab=_0x5ed267;_0x5f08a8[_0x1d6868][_0x4dedab(0x138)]=_0x54a75f;}),_0x24f270[_0x5ed267(0x150)]((_0x5ca93e,_0x5db2d0)=>{_0x5f08a8[_0x5db2d0]['secondary_code']=_0x5ca93e;}),_0x13692b[_0x5ed267(0x150)]((_0x454206,_0x5a4fa9)=>{_0x5f08a8[_0x5a4fa9]['product_code']=_0x454206;}),_0x34ec08[_0x5ed267(0x150)]((_0x5ed3b9,_0x1fc7e6)=>{var _0x121219=_0x5ed267,_0x2a48b2=_0x5ed3b9[_0x121219(0x1ac)](/[A-Za-z]+/)[0x0],_0x2887cd=parseInt(_0x5ed3b9[_0x121219(0x1ac)](/\d+/)[0x0]);_0x5f08a8[_0x1fc7e6][_0x121219(0x15d)]=_0x2887cd,_0x5f08a8[_0x1fc7e6][_0x121219(0x168)]=_0x2a48b2;}),_0x557f0c[_0x5ed267(0x150)]((_0x202966,_0x31bd40)=>{var _0x53e98d=_0x5ed267;_0x5f08a8[_0x31bd40][_0x53e98d(0x154)]=_0x202966;}),_0xee69e3[_0x5ed267(0x150)]((_0x424b89,_0x1eed23)=>{var _0x308a67=_0x5ed267;_0x5f08a8[_0x1eed23][_0x308a67(0x1b2)]=_0x424b89;}),_0x53e86a['forEach']((_0x57fd52,_0x4dab5f)=>{var _0x553dcb=_0x5ed267;_0x5f08a8[_0x4dab5f][_0x553dcb(0x10e)]=_0x57fd52;}),_0x3082c2[_0x5ed267(0x150)]((_0x17f6d9,_0x2fa9b7)=>{var _0x8437e6=_0x5ed267;_0x5f08a8[_0x2fa9b7][_0x8437e6(0x123)]=_0x17f6d9;}),_0x3337ad[_0x5ed267(0x150)]((_0x1c3867,_0x2e0e7a)=>{_0x5f08a8[_0x2e0e7a]['production_date']=_0x1c3867;}),_0x3f754f[_0x5ed267(0x150)]((_0x4d4de0,_0x54aeff)=>{_0x5f08a8[_0x54aeff]['maxperunit']=_0x4d4de0;}),_0x4ba84a['forEach']((_0x175657,_0x4da018)=>{var _0x38b94f=_0x5ed267;_0x5f08a8[_0x4da018][_0x38b94f(0x136)]=_0x175657;}),_0x2adc21[_0x5ed267(0x150)]((_0xe6164a,_0x1769ab)=>{var _0x168319=_0x5ed267;_0x5f08a8[_0x1769ab][_0x168319(0x1a2)]=_0xe6164a;}),_0x3a0856['forEach']((_0x58fcd9,_0x49b916)=>{var _0x57b5eb=_0x5ed267;_0x5f08a8[_0x49b916][_0x57b5eb(0x13f)]=_0x58fcd9,_0x5f08a8[_0x49b916][_0x57b5eb(0x109)]=_0x640ac1;});const _0x3c94c2=new sales_logs();await _0x3c94c2['save'](),_0x3a0856[_0x5ed267(0x150)]((_0x21e343,_0x5d82b1)=>{var _0x4df24d=_0x5ed267;_0x5f08a8[_0x5d82b1][_0x4df24d(0xd8)]=_0x4df24d(0xd7)+_0x3c94c2[_0x4df24d(0x15f)]['toString']()[_0x4df24d(0xc6)](0x8,'0');});var _0x7bbd60=0x0;_0x5f08a8[_0x5ed267(0x150)](_0x4bf8f4=>{var _0x579c48=_0x5ed267;parseFloat(_0x4bf8f4[_0x579c48(0xc8)])<parseFloat(_0x4bf8f4[_0x579c48(0x1a0)])&&parseFloat(_0x4bf8f4[_0x579c48(0x1a0)])>parseFloat(_0x4bf8f4[_0x579c48(0xc8)])&&(console[_0x579c48(0xa9)](_0x4bf8f4[_0x579c48(0xc8)]+'\x20<>\x20'+_0x4bf8f4[_0x579c48(0x1a0)]),_0x7bbd60++);});if(_0x7bbd60!=0x0)return _0x162f36[_0x5ed267(0x159)]('errors','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x179eb3[_0x5ed267(0x146)](_0x5ed267(0xf5));const _0x254e89=_0x5f08a8['filter'](_0x1524a8=>_0x1524a8[_0x5ed267(0x1a0)]!=='0'&&_0x1524a8[_0x5ed267(0x1a0)]!==''),_0x14af8b=new sales_finished({'invoice':_0x5ed267(0xd7)+_0x3c94c2[_0x5ed267(0x15f)][_0x5ed267(0x111)]()[_0x5ed267(0xc6)](0x8,'0'),'sales_data':_0x162f36[_0x5ed267(0x144)]['sales'],'customer':_0x162f36[_0x5ed267(0x144)][_0x5ed267(0x181)],'date':_0x640ac1,'warehouse_name':_0x38b787,'sale_product':_0x254e89,'note':_0x53b59a,'room':_0x213cfd,'primary_code':_0x5e70ad,'secondary_code':_0x362522,'prod_code':_0x102cba,'SCRN':_0x3b3baa,'finalize':_0x5ed267(0x162),'mode_transpo':_0x21e249,'name_driver':_0x397b74,'ReqBy':_0x26c541,'dateofreq':_0x4f97bf,'PO_number':_0x8289d3,'typeservicesData':_0x1bdeab,'typevehicle':_0x1593eb,'destination':_0x4b1606,'deliverydate':_0x240cee,'driver':_0x218a53,'plate':_0x1d7a35,'van':_0x399749,'DRSI':_0x415c02,'TSU':_0x55d057,'TFU':_0x108e11,'typeOfProducts':_0xae1922}),_0x5cac32=await _0x14af8b[_0x5ed267(0xe6)](),_0x1b97ab=await sales_finished['findOne']({'invoice':_0x1b2539});_0x162f36[_0x5ed267(0x159)](_0x5ed267(0x161),_0x5ed267(0x163)),_0x179eb3[_0x5ed267(0x146)]('/all_sales_finished/preview/'+_0x5cac32[_0x5ed267(0x113)]);}catch(_0x11284a){console[_0x5ed267(0xa9)](_0x11284a);}}),router[a0_0x563031(0xec)](a0_0x563031(0xbf),auth,async(_0x2fd402,_0x334691)=>{var _0x2501bd=a0_0x563031;try{const _0x252213=_0x2fd402[_0x2501bd(0xa4)]['id'];console[_0x2501bd(0xa9)](_0x252213);const _0x13a2b6=await product[_0x2501bd(0xd3)](),_0x38c635=await purchases['aggregate']([{'$match':{'warehouse_name':_0x252213}},{'$unwind':_0x2501bd(0xae)},{'$group':{'_id':'$product.product_name'}}]);console[_0x2501bd(0xa9)](_0x2501bd(0x174),_0x38c635),_0x334691['status'](0xc8)[_0x2501bd(0x10c)]({'purchases_data':_0x38c635,'product_data':_0x13a2b6});}catch(_0x31a1b8){console[_0x2501bd(0xa9)](_0x31a1b8);}}),router[a0_0x563031(0x1ab)](a0_0x563031(0x99),auth,async(_0x5ebaf8,_0x288b86)=>{var _0x216dc1=a0_0x563031;try{const {warehouse_data:_0x2dd778,product_data:_0x665913}=_0x5ebaf8['body'];console['log'](_0x5ebaf8['body'][_0x216dc1(0x1af)]);;const _0x410c97=await master_shop['find']();console[_0x216dc1(0xa9)](_0x216dc1(0x18a),_0x410c97);const _0x272993=await product[_0x216dc1(0xa2)]({'name':_0x665913});console['log'](_0x216dc1(0xbd),_0x272993);const _0x539dea=await warehouse[_0x216dc1(0x17f)]([{'$match':{'name':_0x2dd778}},{'$unwind':_0x216dc1(0x12c)},{'$match':{'product_details.product_name':_0x665913}},{'$group':{'_id':_0x216dc1(0xce),'product_stock':{'$first':_0x216dc1(0x17e)}}}]);console[_0x216dc1(0xa9)](_0x216dc1(0x191),_0x539dea),_0x288b86[_0x216dc1(0x176)](0xc8)[_0x216dc1(0x10c)]({'master':_0x410c97,'new_product':_0x272993,'stock_data':_0x539dea});}catch(_0x31efbc){console[_0x216dc1(0xa9)](_0x31efbc);}}),router['post']('/view/add_sales',auth,async(_0x5c1e11,_0x2f6808)=>{var _0x1a837a=a0_0x563031;try{const {invoice:_0x3f7293,date:_0x4f22e5,warehouse_name:_0x47ea3e,product_name:_0x4d3f6a,note:_0x5bb5a8,room:_0x67dcbf,primary_code:_0x4f8770,secondary_code:_0x39786c,prod_code:_0x36c01a,SCRN:_0x54b391,ReqBy:_0x327801,dateofreq:_0x373abf,PO_number:_0x114b1c,typeservicesData:_0x2fabc6,typevehicle:_0x508032,destination:_0x34f7a8,deliverydate:_0x2e4de1,driver:_0x1bb44c,plate:_0x241e16,van:_0x56a39a,DRSI:_0x8354da,TSU:_0x443341,TFU:_0x2c9190,mode_transpo:_0x2dfbb1,name_driver:_0x550d50,pull_out_date:_0x5a0e53,actual_delivery_date:_0x33ac64}=_0x5c1e11[_0x1a837a(0x144)];if(typeof _0x4d3f6a=='string')var _0x8ee99b=[_0x5c1e11['body'][_0x1a837a(0x10a)]],_0x1e5591=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xc8)]],_0x1f355b=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xe1)]],_0xca5cca=[_0x5c1e11[_0x1a837a(0x144)]['primary_code']],_0x32501d=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x10f)]],_0x452901=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x119)]],_0x217083=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x1b4)]],_0x192168=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x126)]],_0x21e1d4=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x1b2)]],_0x257a75=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x10e)]],_0x5ce02a=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x123)]],_0x3aaeae=[_0x5c1e11[_0x1a837a(0x144)]['product_date']],_0x49a87d=[_0x5c1e11[_0x1a837a(0x144)]['max_per_unit']],_0xb287fc=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x136)]],_0x17941a=[_0x5c1e11['body']['RoomAssigned']],_0x4b0529=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x16d)]],_0x1bf6c8=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x110)]],_0x272270=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xe0)]],_0x4a9527=[_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xf6)]];else var _0x8ee99b=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x10a)]],_0x1e5591=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xc8)]],_0x1f355b=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xe1)]],_0xca5cca=[..._0x5c1e11[_0x1a837a(0x144)]['primary_code']],_0x32501d=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x10f)]],_0x452901=[..._0x5c1e11['body'][_0x1a837a(0x119)]],_0x217083=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x1b4)]],_0x192168=[..._0x5c1e11[_0x1a837a(0x144)]['primary_unit']],_0x21e1d4=[..._0x5c1e11['body'][_0x1a837a(0x1b2)]],_0x257a75=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x10e)]],_0x5ce02a=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x123)]],_0x3aaeae=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x153)]],_0x49a87d=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xb6)]],_0xb287fc=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x136)]],_0x17941a=[..._0x5c1e11['body']['RoomAssigned']],_0x4b0529=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x16d)]],_0x1bf6c8=[..._0x5c1e11[_0x1a837a(0x144)]['id_transaction_from']],_0x272270=[..._0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xe0)]],_0x4a9527=[..._0x5c1e11['body']['gross_price']];const _0x193c7f=_0x8ee99b[_0x1a837a(0x17a)](_0x379eb1=>{return _0x379eb1={'product_name':_0x379eb1};});_0x1e5591[_0x1a837a(0x150)]((_0x8b7eee,_0xc97c48)=>{var _0x59bc3a=_0x1a837a;_0x193c7f[_0xc97c48][_0x59bc3a(0xc8)]=_0x8b7eee;}),_0x1f355b[_0x1a837a(0x150)]((_0x434a45,_0x4662a3)=>{var _0x547c4b=_0x1a837a;_0x193c7f[_0x4662a3]['quantity']=Math[_0x547c4b(0xf8)](_0x434a45);}),_0x8ee99b[_0x1a837a(0x150)]((_0x38dff3,_0xcb9ca5)=>{var _0x1164ee=_0x1a837a;_0x193c7f[_0xcb9ca5][_0x1164ee(0x18c)]=_0x5c1e11[_0x1164ee(0x144)][_0x1164ee(0xee)];}),_0x4a9527[_0x1a837a(0x150)]((_0x514700,_0x3758af)=>{var _0x4a47a8=_0x1a837a;_0x193c7f[_0x3758af][_0x4a47a8(0xf6)]=_0x514700;}),_0x272270[_0x1a837a(0x150)]((_0x23c31c,_0x3e5534)=>{var _0x59e820=_0x1a837a;_0x193c7f[_0x3e5534][_0x59e820(0xe0)]=_0x23c31c;}),_0x1bf6c8[_0x1a837a(0x150)]((_0x5e4ca3,_0x5d749e)=>{var _0x1ca5bf=_0x1a837a;_0x193c7f[_0x5d749e][_0x1ca5bf(0x110)]=_0x5e4ca3;}),_0xca5cca[_0x1a837a(0x150)]((_0x3d4e7e,_0xe0f684)=>{var _0x257409=_0x1a837a;_0x193c7f[_0xe0f684][_0x257409(0x138)]=_0x3d4e7e;}),_0x32501d[_0x1a837a(0x150)]((_0x1380e6,_0x2b1d0f)=>{_0x193c7f[_0x2b1d0f]['secondary_code']=_0x1380e6;}),_0x452901[_0x1a837a(0x150)]((_0x327715,_0x4110db)=>{var _0x352652=_0x1a837a;_0x193c7f[_0x4110db][_0x352652(0xcc)]=_0x327715;}),_0x217083[_0x1a837a(0x150)]((_0x49c08a,_0x39bd80)=>{var _0x27b57f=_0x1a837a,_0x320bfd=_0x49c08a[_0x27b57f(0x1ac)](/[A-Za-z]+/)[0x0],_0x2a7fcd=parseInt(_0x49c08a[_0x27b57f(0x1ac)](/\d+/)[0x0]);_0x193c7f[_0x39bd80][_0x27b57f(0x15d)]=_0x2a7fcd,_0x193c7f[_0x39bd80][_0x27b57f(0x168)]=_0x320bfd;}),_0x192168[_0x1a837a(0x150)]((_0x1e0a0f,_0x2c627b)=>{_0x193c7f[_0x2c627b]['unit']=_0x1e0a0f;}),_0x21e1d4[_0x1a837a(0x150)]((_0x978a78,_0x9d4810)=>{var _0xea230=_0x1a837a;_0x193c7f[_0x9d4810][_0xea230(0x1b2)]=_0x978a78;}),_0x257a75['forEach']((_0x12157a,_0x3ff895)=>{var _0x14300d=_0x1a837a;_0x193c7f[_0x3ff895][_0x14300d(0x10e)]=_0x12157a;}),_0x5ce02a['forEach']((_0xad4a55,_0x385683)=>{var _0x4f3f46=_0x1a837a;_0x193c7f[_0x385683][_0x4f3f46(0x123)]=_0xad4a55;}),_0x3aaeae[_0x1a837a(0x150)]((_0xefa02,_0x1ba505)=>{var _0x22e31f=_0x1a837a;_0x193c7f[_0x1ba505][_0x22e31f(0x19a)]=_0xefa02;}),_0x49a87d['forEach']((_0xb7afdb,_0x302e5d)=>{_0x193c7f[_0x302e5d]['maxperunit']=_0xb7afdb;}),_0xb287fc['forEach']((_0x7b96bc,_0x489708)=>{var _0x46483d=_0x1a837a;_0x193c7f[_0x489708][_0x46483d(0x136)]=_0x7b96bc;}),_0x17941a['forEach']((_0x457324,_0x1bd9c1)=>{var _0x15832f=_0x1a837a;_0x193c7f[_0x1bd9c1][_0x15832f(0x1a2)]=_0x457324;}),_0x4b0529[_0x1a837a(0x150)]((_0x2af7a5,_0x5f3d11)=>{var _0x877a3e=_0x1a837a;_0x193c7f[_0x5f3d11][_0x877a3e(0x13f)]=_0x2af7a5,_0x193c7f[_0x5f3d11][_0x877a3e(0x109)]=_0x4f22e5;});const _0x2b6bc9=new invoice_for_outgoing();await _0x2b6bc9[_0x1a837a(0xe6)](),_0x4b0529['forEach']((_0x2c7019,_0x2de1c4)=>{var _0x14def1=_0x1a837a;_0x193c7f[_0x2de1c4]['outgoing_invoice']='OUT-'+_0x2b6bc9[_0x14def1(0x15f)][_0x14def1(0x111)]()[_0x14def1(0xc6)](0x8,'0');});var _0x306101=0x0;_0x193c7f['forEach'](_0x2c775b=>{var _0x5f2350=_0x1a837a;parseFloat(_0x2c775b[_0x5f2350(0xc8)])<parseFloat(_0x2c775b[_0x5f2350(0x1a0)])&&parseFloat(_0x2c775b['quantity'])>parseFloat(_0x2c775b[_0x5f2350(0xc8)])&&(console[_0x5f2350(0xa9)](_0x2c775b[_0x5f2350(0xc8)]+_0x5f2350(0x124)+_0x2c775b['quantity']),_0x306101++);});if(_0x306101!=0x0)return _0x5c1e11[_0x1a837a(0x159)](_0x1a837a(0x118),_0x1a837a(0x199)),_0x2f6808[_0x1a837a(0x146)]('back');const _0x502905=_0x193c7f[_0x1a837a(0xca)](_0x559b3d=>_0x559b3d[_0x1a837a(0x1a0)]!=='0'&&_0x559b3d['quantity']!==''),_0x1b6192=new sales_finished({'invoice':_0x1a837a(0x179)+_0x2b6bc9['invoice_init']['toString']()[_0x1a837a(0xc6)](0x8,'0'),'sales_data':_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0xee)],'customer':_0x5c1e11[_0x1a837a(0x144)][_0x1a837a(0x181)],'date':_0x4f22e5,'warehouse_name':_0x47ea3e,'sale_product':_0x502905,'note':_0x5bb5a8,'room':_0x67dcbf,'primary_code':_0x4f8770,'secondary_code':_0x39786c,'prod_code':_0x36c01a,'SCRN':_0x54b391,'finalize':_0x1a837a(0x162),'mode_transpo':_0x2dfbb1,'name_driver':_0x550d50,'ReqBy':_0x327801,'dateofreq':_0x373abf,'PO_number':_0x114b1c,'typeservicesData':_0x2fabc6,'typevehicle':_0x508032,'destination':_0x34f7a8,'deliverydate':_0x2e4de1,'driver':_0x1bb44c,'plate':_0x241e16,'van':_0x56a39a,'DRSI':_0x8354da,'TSU':_0x443341,'TFU':_0x2c9190,'pullout_date':_0x5a0e53,'actualdelivery_date':_0x33ac64,'typeOfProducts':'own'}),_0x404318=await _0x1b6192[_0x1a837a(0xe6)](),_0x1d3c02=await sales_finished['findOne']({'invoice':_0x3f7293});_0x5c1e11[_0x1a837a(0x159)]('success','Sales\x20Add\x20successfully'),_0x2f6808[_0x1a837a(0x146)](_0x1a837a(0xea)+_0x404318[_0x1a837a(0x113)]);}catch(_0x313266){console[_0x1a837a(0xa9)](_0x313266);}}),router[a0_0x563031(0xec)](a0_0x563031(0xe4),auth,async(_0x4f90b8,_0x3d1c0f)=>{var _0x2d052d=a0_0x563031;try{const {username:_0x7e8d71,email:_0x13ba14,role:_0x290174}=_0x4f90b8[_0x2d052d(0x134)],_0x45fca3=_0x4f90b8['user'],_0x245d0d=await profile[_0x2d052d(0xa2)]({'email':_0x45fca3[_0x2d052d(0xa0)]}),_0x17f446=await master_shop[_0x2d052d(0xd3)](),_0x2b5bc9=_0x4f90b8[_0x2d052d(0xa4)]['id'],_0x284baa=await sales_finished[_0x2d052d(0x11d)](_0x2b5bc9),_0x4abc4a=await warehouse[_0x2d052d(0x17f)]([{'$match':{'name':_0x284baa['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2d052d(0xce)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x2d052d(0x139)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2d052d(0x198)},'secondary_code':{'$first':_0x2d052d(0xc2)},'product_code':{'$first':_0x2d052d(0x17b)},'storage':{'$first':_0x2d052d(0x9b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2d052d(0xa7)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2d052d(0x1aa)},'room':{'$first':'$room'},'room_data':{'$first':_0x2d052d(0xb7)}}}]),_0x123fc7=await customer[_0x2d052d(0xd3)]({});let _0x4645c7;if(_0x45fca3[_0x2d052d(0xb4)]==_0x2d052d(0x158)){const _0x4127ac=await staff[_0x2d052d(0xa2)]({'email':_0x45fca3['email']});_0x4645c7=await warehouse[_0x2d052d(0x17f)]([{'$match':{'status':_0x2d052d(0x106),'name':_0x4127ac[_0x2d052d(0x156)]}},{'$group':{'_id':_0x2d052d(0xf4),'name':{'$first':_0x2d052d(0xf4)}}}]);}else _0x4645c7=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x2d052d(0xf4),'name':{'$first':_0x2d052d(0xf4)}}}]);const _0x212a3e=await product[_0x2d052d(0xd3)]({});if(_0x17f446[0x0][_0x2d052d(0x166)]==_0x2d052d(0x103)){var _0x3eb096=users[_0x2d052d(0x1a4)];console[_0x2d052d(0xa9)](_0x3eb096);}else{if(_0x17f446[0x0][_0x2d052d(0x166)]==_0x2d052d(0x97))var _0x3eb096=users[_0x2d052d(0x97)];else{if(_0x17f446[0x0]['language']=='German')var _0x3eb096=users['German'];else{if(_0x17f446[0x0][_0x2d052d(0x166)]==_0x2d052d(0x102))var _0x3eb096=users['Spanish'];else{if(_0x17f446[0x0][_0x2d052d(0x166)]=='French')var _0x3eb096=users['French'];else{if(_0x17f446[0x0]['language']==_0x2d052d(0xd9))var _0x3eb096=users[_0x2d052d(0x9a)];else{if(_0x17f446[0x0][_0x2d052d(0x166)]==_0x2d052d(0x196))var _0x3eb096=users[_0x2d052d(0x196)];else{if(_0x17f446[0x0][_0x2d052d(0x166)]=='Arabic\x20(ae)')var _0x3eb096=users[_0x2d052d(0xaa)];}}}}}}}_0x3d1c0f['render'](_0x2d052d(0xfd),{'success':_0x4f90b8['flash'](_0x2d052d(0x161)),'errors':_0x4f90b8['flash']('errors'),'role':_0x45fca3,'profile':_0x245d0d,'customer':_0x123fc7,'warehouse':_0x4645c7,'product':_0x4abc4a,'user':_0x284baa,'master_shop':_0x17f446,'unit':_0x212a3e,'language':_0x3eb096});}catch(_0x5b1deb){console[_0x2d052d(0xa9)](_0x5b1deb);}});async function dataUpdate(_0x435494,_0x1dcd5f,_0x210605){var _0x144992=a0_0x563031;return await warehouse[_0x144992(0xa5)]({'_id':_0x435494,'product_details._id':_0x1dcd5f},{'$set':{'product_details.$.product_stock':_0x210605}}),await warehouse['findById'](_0x435494);}router['post'](a0_0x563031(0xe4),auth,async(_0x3f7238,_0x40e15f)=>{var _0x3a7133=a0_0x563031;try{const _0x39df15=_0x3f7238[_0x3a7133(0xa4)]['id'],{invoice:_0x5076bd,warehouse_name:_0x1d4385,room:_0xfde411}=_0x3f7238['body'],_0x5ec3f0=await sales_finished['findOne']({'invoice':_0x5076bd});for(let _0x9d37f2=0x0;_0x9d37f2<=_0x5ec3f0[_0x3a7133(0xf7)][_0x3a7133(0x120)]-0x1;_0x9d37f2++){const _0x29219c=_0x5ec3f0['sale_product'][_0x9d37f2];var _0x5a3bd0=await warehouse['findOne']({'name':_0x1d4385,'room':_0x29219c[_0x3a7133(0x1a2)]}),_0x4aa7a2=0x0;for(let _0x532503=0x0;_0x532503<=_0x5a3bd0[_0x3a7133(0x149)][_0x3a7133(0x120)]-0x1;_0x532503++){const _0x37237d=_0x5a3bd0[_0x3a7133(0x149)][_0x532503];_0x37237d[_0x3a7133(0x113)]==_0x29219c[_0x3a7133(0x110)]&&_0x37237d[_0x3a7133(0xe0)]==_0x29219c[_0x3a7133(0xe0)]&&(_0x4aa7a2=Math[_0x3a7133(0x17d)](0x0,Math['abs'](_0x37237d['product_stock'])-Math[_0x3a7133(0xf8)](_0x29219c[_0x3a7133(0x1a0)])),await warehouse[_0x3a7133(0xa5)]({'_id':_0x5a3bd0[_0x3a7133(0x113)]['valueOf'](),'product_details._id':_0x37237d[_0x3a7133(0x113)][_0x3a7133(0x177)](),'product_details.uuid':_0x29219c[_0x3a7133(0xe0)]},{'$set':{'product_details.$.product_stock':_0x4aa7a2}}));}console['log'](typeof _0x29219c[_0x3a7133(0x18c)]);if(typeof _0x29219c['agent_id']!==_0x3a7133(0x167)){var _0x1889cf=await staff['findById'](_0x29219c[_0x3a7133(0x18c)]);console[_0x3a7133(0xa9)](_0x3a7133(0x1a1));var _0x3f16ea=0x0;for(let _0x843ead=0x0;_0x843ead<=_0x1889cf[_0x3a7133(0x9f)]['length']-0x1;_0x843ead++){const _0x464ddb=_0x1889cf[_0x3a7133(0x9f)][_0x843ead];console[_0x3a7133(0xa9)](_0x29219c[_0x3a7133(0x110)]+_0x3a7133(0x107)+_0x464ddb['warehouse_id']+'\x20&&\x20'+_0x29219c['_id']+'\x20==\x20'+_0x29219c['_id']),_0x29219c[_0x3a7133(0x110)]==_0x464ddb[_0x3a7133(0xb8)]&&_0x29219c[_0x3a7133(0x113)]==0x1&&(_0x464ddb[_0x3a7133(0x18d)]=Math[_0x3a7133(0xf8)](_0x464ddb[_0x3a7133(0x18d)])+Math[_0x3a7133(0xf8)](_0x29219c[_0x3a7133(0x1a0)]),_0x3f16ea++);}console[_0x3a7133(0xa9)](_0x3a7133(0xa3),_0x3f16ea),_0x3f16ea=='0'&&(_0x1889cf[_0x3a7133(0x9f)]=_0x1889cf[_0x3a7133(0x9f)][_0x3a7133(0x173)]({'product_name':_0x29219c['product_name'],'product_stock':_0x29219c[_0x3a7133(0x1a0)],'bay':_0x29219c['bay'],'level':_0x29219c['level'],'product_code':_0x29219c[_0x3a7133(0xcc)],'primary_code':_0x29219c[_0x3a7133(0x138)],'secondary_code':_0x29219c['secondary_code'],'expiry_date':_0x29219c[_0x3a7133(0x123)],'production_date':_0x29219c['production_date'],'maxProducts':_0x29219c[_0x3a7133(0x164)],'batch_code':_0x29219c[_0x3a7133(0x10e)],'secondary_unit':_0x29219c['secondary_unit'],'unit':_0x29219c['unit'],'maxProducts':_0x29219c[_0x3a7133(0x164)],'maxPerUnit':_0x29219c[_0x3a7133(0x182)],'invoice':_0x29219c[_0x3a7133(0x13f)],'warehouse_id':_0x29219c[_0x3a7133(0x110)],'id_incoming':_0x29219c[_0x3a7133(0x113)],'uuid':_0x29219c[_0x3a7133(0xe0)],'gross_price':_0x29219c[_0x3a7133(0xf6)],'date_incoming':_0x29219c[_0x3a7133(0x109)],'outgoing_invoice':_0x29219c[_0x3a7133(0xd8)]}),await _0x1889cf[_0x3a7133(0xe6)]());}}_0x5ec3f0['finalize']=_0x3a7133(0x195);const _0x41e645=await _0x5ec3f0[_0x3a7133(0xe6)](),_0x274af9=await master_shop[_0x3a7133(0xd3)](),_0x28bd10=await email_settings[_0x3a7133(0xa2)](),_0x436d5d=await supervisor_settings['find']();var _0x2f12bf=_0x5ec3f0[_0x3a7133(0xf7)],_0x295566='',_0x27aa88;for(_0x27aa88 in _0x2f12bf){_0x295566+=_0x3a7133(0x19e)+_0x3a7133(0x141)+_0x2f12bf[_0x27aa88][_0x3a7133(0x10a)]+'</td>'+_0x3a7133(0x141)+_0x2f12bf[_0x27aa88][_0x3a7133(0xcc)]+'</td>'+_0x3a7133(0x141)+_0x2f12bf[_0x27aa88][_0x3a7133(0x1a0)]+'</td>'+_0x3a7133(0x141)+_0x2f12bf[_0x27aa88][_0x3a7133(0x154)]+_0x3a7133(0x143)+_0x3a7133(0x141)+_0x2f12bf[_0x27aa88][_0x3a7133(0x1b2)]+'</td>'+_0x3a7133(0x141)+_0x5ec3f0['warehouse_name']+_0x3a7133(0x143)+_0x3a7133(0x141)+_0x2f12bf[_0x27aa88][_0x3a7133(0x1a2)]+_0x3a7133(0x143)+_0x3a7133(0x141)+_0x2f12bf[_0x27aa88]['bay']+'</td>';}_0x3f7238[_0x3a7133(0x159)]('success',_0x3a7133(0x1a9)),_0x40e15f[_0x3a7133(0x146)]('/picking_list/pdf/'+_0x39df15);}catch(_0x18b37c){console[_0x3a7133(0xa9)](_0x18b37c);}}),router[a0_0x563031(0xec)](a0_0x563031(0xbe),auth,async(_0x1b3b8b,_0x47d28d)=>{var _0x3e9832=a0_0x563031;try{const {username:_0x576541,email:_0x4c1cb8,role:_0x19bd06}=_0x1b3b8b['user'],_0x4bdc2a=_0x1b3b8b[_0x3e9832(0x134)],_0x586e33=await profile['findOne']({'email':_0x4bdc2a[_0x3e9832(0xa0)]}),_0x3bcf0f=await master_shop['find'](),_0x58c0a6=_0x1b3b8b[_0x3e9832(0xa4)]['id'],_0x4e1687=await sales_finished['findById'](_0x58c0a6);let _0x14d09=new Date(_0x4e1687[_0x3e9832(0x123)]),_0x38a9f7=('0'+_0x14d09['getDate']())['slice'](-0x2),_0x4c5bac=('0'+(_0x14d09[_0x3e9832(0xb2)]()+0x1))[_0x3e9832(0x18f)](-0x2),_0x5e9466=_0x14d09['getFullYear'](),_0x262c60=_0x5e9466+'-'+_0x4c5bac+'-'+_0x38a9f7;var _0x98c51e=[_0x3e9832(0xf0),_0x3e9832(0x15b)];const _0x1b7fa2=await warehouse['aggregate']([{'$match':{'name':_0x4e1687[_0x3e9832(0x18e)],'room':_0x4e1687['room']}},{'$unwind':_0x3e9832(0x12c)},{'$group':{'_id':_0x3e9832(0xc9),'name':{'$first':_0x3e9832(0xce)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x3e9832(0x139)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x3e9832(0x198)},'secondary_code':{'$first':_0x3e9832(0xc2)},'product_code':{'$first':_0x3e9832(0x17b)},'storage':{'$first':_0x3e9832(0x9b)},'rack':{'$first':'$product_details.rack'}}}]),_0x89b395=await customer['find']({});let _0x160418;if(_0x4bdc2a[_0x3e9832(0xb4)]=='staff'){const _0x1df6de=await staff[_0x3e9832(0xa2)]({'email':_0x4bdc2a[_0x3e9832(0xa0)]});_0x160418=await warehouse[_0x3e9832(0x17f)]([{'$match':{'status':_0x3e9832(0x106),'name':_0x1df6de['warehouse']}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x160418=await warehouse[_0x3e9832(0x17f)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x3e9832(0xf4),'name':{'$first':_0x3e9832(0xf4)}}}]);const _0x3ddcd2=await product[_0x3e9832(0xd3)]({});if(_0x3bcf0f[0x0][_0x3e9832(0x166)]==_0x3e9832(0x103)){var _0x1861a0=users[_0x3e9832(0x1a4)];console['log'](_0x1861a0);}else{if(_0x3bcf0f[0x0][_0x3e9832(0x166)]==_0x3e9832(0x97))var _0x1861a0=users['Hindi'];else{if(_0x3bcf0f[0x0][_0x3e9832(0x166)]==_0x3e9832(0x140))var _0x1861a0=users[_0x3e9832(0x140)];else{if(_0x3bcf0f[0x0][_0x3e9832(0x166)]==_0x3e9832(0x102))var _0x1861a0=users[_0x3e9832(0x102)];else{if(_0x3bcf0f[0x0][_0x3e9832(0x166)]==_0x3e9832(0x171))var _0x1861a0=users[_0x3e9832(0x171)];else{if(_0x3bcf0f[0x0]['language']==_0x3e9832(0xd9))var _0x1861a0=users[_0x3e9832(0x9a)];else{if(_0x3bcf0f[0x0][_0x3e9832(0x166)]==_0x3e9832(0x196))var _0x1861a0=users['Chinese'];else{if(_0x3bcf0f[0x0]['language']=='Arabic\x20(ae)')var _0x1861a0=users[_0x3e9832(0xaa)];}}}}}}}_0x47d28d[_0x3e9832(0xdc)](_0x3e9832(0x9e),{'success':_0x1b3b8b['flash']('success'),'errors':_0x1b3b8b['flash'](_0x3e9832(0x118)),'role':_0x4bdc2a,'profile':_0x586e33,'customer':_0x89b395,'warehouse':_0x160418,'product':_0x1b7fa2,'user':_0x4e1687,'master_shop':_0x3bcf0f,'unit':_0x3ddcd2,'language':_0x1861a0,'rooms_data':_0x98c51e,'ed_fullDate':_0x262c60});}catch(_0x1ed44f){console[_0x3e9832(0xa9)](_0x1ed44f);}}),router[a0_0x563031(0x1ab)](a0_0x563031(0xbe),auth,async(_0x498f4c,_0x5adbb7)=>{var _0xd22117=a0_0x563031;try{const _0xc09aa4=_0x498f4c[_0xd22117(0xa4)]['id'],_0xc665e9=await sales_finished[_0xd22117(0xa2)]({'_id':_0x498f4c['params']['id']}),_0x5c622c=await warehouse[_0xd22117(0xa2)]({'name':_0xc665e9[_0xd22117(0x18e)],'room':_0x498f4c[_0xd22117(0x144)][_0xd22117(0x1b5)],'warehouse_category':_0xd22117(0xaf)}),{invoice:_0x5e0a44,customer:_0x99794c,date:_0x555910,warehouse_name:_0xad306f,product_name:_0x4e82e1,stock:_0x763020,adjust_qty:_0x2c0148,note:_0x11c747,room:_0x493dd5,primary_code:_0x2affde,secondary_code:_0x54fd28,prod_code:_0x19de6f,level:_0x1229d2,isle:_0x24935f,pallet:_0x1f5391,expiry_date:_0x696ed6}=_0x498f4c[_0xd22117(0x144)];if(typeof _0x4e82e1==_0xd22117(0x151))var _0x22f3e0=[_0x498f4c['body'][_0xd22117(0x10a)]],_0x55c81f=[_0x498f4c['body']['stock']],_0x481499=[_0x498f4c[_0xd22117(0x144)]['adjust_qty']],_0xac8ee8=[_0x498f4c[_0xd22117(0x144)][_0xd22117(0x138)]],_0x45f60b=[_0x498f4c['body'][_0xd22117(0x10f)]],_0x2e3874=[_0x498f4c['body']['prod_code']],_0x13a7ff=[_0x498f4c[_0xd22117(0x144)][_0xd22117(0x168)]],_0x4214c9=[_0x498f4c[_0xd22117(0x144)][_0xd22117(0x123)]];else var _0x22f3e0=[..._0x498f4c[_0xd22117(0x144)][_0xd22117(0x10a)]],_0x55c81f=[..._0x498f4c[_0xd22117(0x144)][_0xd22117(0xc8)]],_0x481499=[..._0x498f4c['body'][_0xd22117(0xd0)]],_0xac8ee8=[..._0x498f4c[_0xd22117(0x144)][_0xd22117(0x138)]],_0x45f60b=[..._0x498f4c[_0xd22117(0x144)][_0xd22117(0x10f)]],_0x2e3874=[..._0x498f4c[_0xd22117(0x144)]['prod_code']],_0x13a7ff=[..._0x498f4c['body'][_0xd22117(0x168)]],_0x4214c9=[..._0x498f4c[_0xd22117(0x144)][_0xd22117(0x123)]];const _0x334dfd=_0x22f3e0[_0xd22117(0x17a)](_0x2df1a6=>{return _0x2df1a6={'product_name':_0x2df1a6};});_0x55c81f[_0xd22117(0x150)]((_0x2447be,_0x1a7cf6)=>{var _0x57aeb9=_0xd22117;_0x334dfd[_0x1a7cf6][_0x57aeb9(0xc8)]=_0x2447be;}),_0x481499[_0xd22117(0x150)]((_0x1cd04e,_0x268203)=>{_0x334dfd[_0x268203]['quantity']=_0x1cd04e;}),_0xac8ee8[_0xd22117(0x150)]((_0x31b3ff,_0x4b8068)=>{var _0x4e96ef=_0xd22117;_0x334dfd[_0x4b8068][_0x4e96ef(0x138)]=_0x31b3ff;}),_0x45f60b['forEach']((_0x319db6,_0x15b911)=>{var _0x2fa4a2=_0xd22117;_0x334dfd[_0x15b911][_0x2fa4a2(0x10f)]=_0x319db6;}),_0x2e3874['forEach']((_0x49861f,_0x4b1b39)=>{_0x334dfd[_0x4b1b39]['product_code']=_0x49861f;}),_0x13a7ff[_0xd22117(0x150)]((_0x10cde3,_0x1bc226)=>{var _0x19df14=_0xd22117;_0x334dfd[_0x1bc226][_0x19df14(0x168)]=_0x10cde3;}),_0x4214c9[_0xd22117(0x150)]((_0x708a93,_0x2a0338)=>{var _0x5acb3a=_0xd22117;_0x334dfd[_0x2a0338][_0x5acb3a(0x123)]=_0x708a93;});var _0x27e15a=0x0;_0x334dfd[_0xd22117(0x150)](_0x24d11b=>{var _0x3f419c=_0xd22117;console[_0x3f419c(0xa9)]('foreach\x20newproduct',_0x24d11b),(parseInt(_0x24d11b[_0x3f419c(0xc8)])<parseInt(_0x24d11b[_0x3f419c(0x1a0)])||parseInt(_0x24d11b['quantity'])==0x0)&&_0x27e15a++;});if(_0x27e15a!=0x0)return _0x498f4c['flash'](_0xd22117(0x118),_0xd22117(0xba)),_0x5adbb7[_0xd22117(0x146)](_0xd22117(0xf5));_0xc665e9[_0xd22117(0xf7)][_0xd22117(0x150)](_0x2f8caa=>{var _0x30e724=_0xd22117;const _0x23160c=_0x5c622c[_0x30e724(0x149)][_0x30e724(0x17a)](_0x4509b4=>{var _0x2d9369=_0x30e724;_0x4509b4[_0x2d9369(0x10a)]==_0x2f8caa[_0x2d9369(0x10a)]&&_0x4509b4[_0x2d9369(0x15d)]==_0x2f8caa['bay']&&(_0x4509b4[_0x2d9369(0x18d)]=parseInt(_0x4509b4[_0x2d9369(0x18d)])+parseInt(_0x2f8caa[_0x2d9369(0x1a0)]));});}),await _0x5c622c[_0xd22117(0xe6)]();const _0x583f9b=_0x334dfd[_0xd22117(0xca)](_0x49ac21=>_0x49ac21['quantity']!=='0'&&_0x49ac21[_0xd22117(0x1a0)]!=='');_0xc665e9[_0xd22117(0x13f)]=_0x5e0a44,_0xc665e9['customer']=_0x99794c,_0xc665e9[_0xd22117(0x190)]=_0x555910,_0xc665e9['warehouse_name']=_0xad306f,_0xc665e9[_0xd22117(0xf7)]=_0x583f9b,_0xc665e9['note']=_0x11c747,_0xc665e9[_0xd22117(0x1b5)]=_0x493dd5;const _0x2c7369=await _0xc665e9[_0xd22117(0xe6)](),_0x349e7b=await sales_finished['findOne']({'_id':_0x498f4c['params']['id']}),_0xc9bb92=await warehouse[_0xd22117(0xa2)]({'name':_0xad306f,'room':_0x493dd5,'warehouse_category':'Finished\x20Goods'});_0x349e7b['sale_product'][_0xd22117(0x150)](_0x2cce25=>{var _0x7bdc71=_0xd22117;const _0x345aba=_0xc9bb92[_0x7bdc71(0x149)]['map'](_0x398d3a=>{var _0x23079f=_0x7bdc71;_0x398d3a[_0x23079f(0x10a)]==_0x2cce25[_0x23079f(0x10a)]&&_0x398d3a[_0x23079f(0x15d)]==_0x2cce25[_0x23079f(0x15d)]&&(_0x398d3a[_0x23079f(0x18d)]=parseInt(_0x398d3a[_0x23079f(0x18d)])-parseInt(_0x2cce25['quantity']));});}),console[_0xd22117(0xa9)](_0xd22117(0x17c),_0xc9bb92),await _0xc9bb92['save']();const _0x3639da=await c_payment_data[_0xd22117(0xa2)]({'invoice':_0x498f4c['body']['invoice']});_0x3639da['suppliers']=_0x498f4c[_0xd22117(0x144)][_0xd22117(0xdb)],await _0x3639da[_0xd22117(0xe6)](),_0x498f4c[_0xd22117(0x159)](_0xd22117(0x161),_0xd22117(0x1a9)),_0x5adbb7[_0xd22117(0x146)](_0xd22117(0x127));}catch(_0x3c4d2b){console[_0xd22117(0xa9)](_0x3c4d2b);}}),router[a0_0x563031(0x1ab)](a0_0x563031(0x9c),auth,async(_0x4f2c6a,_0x2a7334)=>{var _0x5bc9d2=a0_0x563031;try{const _0x57349a=_0x4f2c6a['params']['id'],{invoice:_0x59d7dc,customer:_0x2b7eb5,receivable_amount:_0x4c77ab,received_amount:_0x131386}=_0x4f2c6a['body'],_0x21e527=await sales['findById'](_0x57349a);console[_0x5bc9d2(0xa9)](_0x21e527);var _0x539fb1=_0x4c77ab-_0x131386;console[_0x5bc9d2(0xa9)](_0x131386),_0x21e527[_0x5bc9d2(0xc0)]=parseFloat(_0x131386)+parseFloat(_0x21e527[_0x5bc9d2(0xc0)]),_0x21e527[_0x5bc9d2(0x175)]=_0x539fb1,console['log'](_0x21e527);const _0x1733fd=await _0x21e527[_0x5bc9d2(0xe6)](),_0x1ed269=await c_payment_data[_0x5bc9d2(0xa2)]({'invoice':_0x59d7dc});_0x1ed269[_0x5bc9d2(0xde)]=_0x539fb1,await _0x1ed269[_0x5bc9d2(0xe6)]();let _0x23e761=new Date(),_0x379f54=('0'+_0x23e761[_0x5bc9d2(0xd6)]())[_0x5bc9d2(0x18f)](-0x2),_0x48a99d=('0'+(_0x23e761[_0x5bc9d2(0xb2)]()+0x1))[_0x5bc9d2(0x18f)](-0x2),_0x5b449a=_0x23e761['getFullYear'](),_0x42708e=_0x5b449a+'-'+_0x48a99d+'-'+_0x379f54;const _0x48631a=new customer_payment({'invoice':_0x59d7dc,'date':_0x5b449a+'-'+_0x48a99d+'-'+_0x379f54,'customer':_0x2b7eb5,'reason':_0x5bc9d2(0x169),'amount':_0x131386}),_0x38447f=await _0x48631a[_0x5bc9d2(0xe6)]();_0x4f2c6a[_0x5bc9d2(0x159)]('success','payment\x20successfull'),_0x2a7334[_0x5bc9d2(0x146)](_0x5bc9d2(0xb1));}catch(_0x51052b){console['log'](_0x51052b);}}),router[a0_0x563031(0xec)](a0_0x563031(0x19f),auth,async(_0x9c7c24,_0x3d0f5c)=>{var _0x498d4f=a0_0x563031;try{const {username:_0x58da64,email:_0x5c2925,role:_0x31dee4}=_0x9c7c24[_0x498d4f(0x134)],_0x3ca3e0=_0x9c7c24[_0x498d4f(0x134)],_0x68f77=await profile[_0x498d4f(0xa2)]({'email':_0x3ca3e0['email']}),_0x76a17d=await master_shop[_0x498d4f(0xd3)]();console[_0x498d4f(0xa9)]('master',_0x76a17d);const _0x1f1522=_0x9c7c24[_0x498d4f(0xa4)]['id'],_0x5cbdc5=await sales[_0x498d4f(0x11d)](_0x1f1522);console['log'](_0x5cbdc5);const _0x46f7ec=await customer[_0x498d4f(0xa2)]({'name':_0x5cbdc5['customer']});console[_0x498d4f(0xa9)](_0x46f7ec);if(_0x76a17d[0x0][_0x498d4f(0x166)]=='English\x20(US)'){var _0x5611d0=users[_0x498d4f(0x1a4)];console[_0x498d4f(0xa9)](_0x5611d0);}else{if(_0x76a17d[0x0][_0x498d4f(0x166)]==_0x498d4f(0x97))var _0x5611d0=users[_0x498d4f(0x97)];else{if(_0x76a17d[0x0][_0x498d4f(0x166)]=='German')var _0x5611d0=users['German'];else{if(_0x76a17d[0x0][_0x498d4f(0x166)]==_0x498d4f(0x102))var _0x5611d0=users[_0x498d4f(0x102)];else{if(_0x76a17d[0x0]['language']=='French')var _0x5611d0=users['French'];else{if(_0x76a17d[0x0][_0x498d4f(0x166)]=='Portuguese\x20(BR)')var _0x5611d0=users[_0x498d4f(0x9a)];else{if(_0x76a17d[0x0][_0x498d4f(0x166)]==_0x498d4f(0x196))var _0x5611d0=users['Chinese'];else{if(_0x76a17d[0x0][_0x498d4f(0x166)]=='Arabic\x20(ae)')var _0x5611d0=users[_0x498d4f(0xaa)];}}}}}}}_0x3d0f5c[_0x498d4f(0xdc)]('sales_invoice',{'success':_0x9c7c24[_0x498d4f(0x159)](_0x498d4f(0x161)),'errors':_0x9c7c24['flash'](_0x498d4f(0x118)),'role':_0x3ca3e0,'profile':_0x68f77,'master_shop':_0x76a17d,'customers':_0x46f7ec,'sales':_0x5cbdc5,'language':_0x5611d0});}catch(_0x219523){console[_0x498d4f(0xa9)](_0x219523);}}),router[a0_0x563031(0xec)](a0_0x563031(0x12f),auth,async(_0x14808d,_0x53834f)=>{var _0xf4cedc=a0_0x563031;try{const {username:_0x112ac2,email:_0x53fb1c,role:_0x205290}=_0x14808d['user'],_0x572b51=_0x14808d[_0xf4cedc(0x134)],_0x291bdd=await profile[_0xf4cedc(0xa2)]({'email':_0x572b51['email']}),_0x4933c0=await master_shop[_0xf4cedc(0xd3)](),_0x5ab81c=_0x14808d['params']['id'],_0xe41cc6=await sales_finished[_0xf4cedc(0x11d)](_0x5ab81c),_0x68a4ee=await warehouse['aggregate']([{'$match':{'name':_0xe41cc6[_0xf4cedc(0x18e)]}},{'$unwind':_0xf4cedc(0x12c)},{'$group':{'_id':_0xf4cedc(0xc9),'name':{'$first':_0xf4cedc(0xce)},'product_stock':{'$first':_0xf4cedc(0x17e)},'bay':{'$first':_0xf4cedc(0x145)},'bin':{'$first':_0xf4cedc(0x139)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xf4cedc(0x98)},'primary_code':{'$first':_0xf4cedc(0x198)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xf4cedc(0x17b)},'storage':{'$first':_0xf4cedc(0x9b)},'rack':{'$first':_0xf4cedc(0xcd)},'expiry_date':{'$first':_0xf4cedc(0xa7)},'production_date':{'$first':_0xf4cedc(0x180)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xf4cedc(0x16a)},'maxProducts':{'$first':_0xf4cedc(0x11a)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0xf4cedc(0x19d)}}}]),_0x21130f=await product[_0xf4cedc(0xd3)]({}),_0x321715=await warehouse[_0xf4cedc(0x17f)]([{'$match':{'status':_0xf4cedc(0x106),'warehouse_category':'Finished\x20Goods','name':{'$ne':'Return\x20Goods','$ne':_0xf4cedc(0xc1)}}},{'$group':{'_id':_0xf4cedc(0xf4),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);var _0x14efa6=[_0xf4cedc(0x147)];const _0x524a06=await warehouse[_0xf4cedc(0x17f)]([{'$match':{'status':_0xf4cedc(0x106),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0xf4cedc(0xf4),'name':{'$first':_0xf4cedc(0xf4)}}},{'$sort':{'name':0x1}}]);if(_0x4933c0[0x0][_0xf4cedc(0x166)]==_0xf4cedc(0x103)){var _0x5eb96e=users['English'];console[_0xf4cedc(0xa9)](_0x5eb96e);}else{if(_0x4933c0[0x0][_0xf4cedc(0x166)]==_0xf4cedc(0x97))var _0x5eb96e=users[_0xf4cedc(0x97)];else{if(_0x4933c0[0x0][_0xf4cedc(0x166)]==_0xf4cedc(0x140))var _0x5eb96e=users[_0xf4cedc(0x140)];else{if(_0x4933c0[0x0][_0xf4cedc(0x166)]=='Spanish')var _0x5eb96e=users[_0xf4cedc(0x102)];else{if(_0x4933c0[0x0][_0xf4cedc(0x166)]==_0xf4cedc(0x171))var _0x5eb96e=users['French'];else{if(_0x4933c0[0x0][_0xf4cedc(0x166)]==_0xf4cedc(0xd9))var _0x5eb96e=users[_0xf4cedc(0x9a)];else{if(_0x4933c0[0x0][_0xf4cedc(0x166)]==_0xf4cedc(0x196))var _0x5eb96e=users['Chinese'];else{if(_0x4933c0[0x0][_0xf4cedc(0x166)]==_0xf4cedc(0xfc))var _0x5eb96e=users[_0xf4cedc(0xaa)];}}}}}}}_0x53834f[_0xf4cedc(0xdc)](_0xf4cedc(0x100),{'success':_0x14808d['flash'](_0xf4cedc(0x161)),'errors':_0x14808d[_0xf4cedc(0x159)]('errors'),'role':_0x572b51,'profile':_0x291bdd,'user':_0xe41cc6,'stock':_0x68a4ee,'master_shop':_0x4933c0,'unit':_0x21130f,'language':_0x5eb96e,'warehouses':_0x321715,'rooms':_0x14efa6,'warehouse_QA':_0x524a06});}catch(_0x476420){console[_0xf4cedc(0xa9)](_0x476420),_0x53834f[_0xf4cedc(0x176)](0xc8)[_0xf4cedc(0x10c)]({'message':_0x476420[_0xf4cedc(0x16b)]});}}),router[a0_0x563031(0x1ab)](a0_0x563031(0x12f),auth,async(_0x4247a0,_0x1edf1e)=>{var _0x12a57e=a0_0x563031;if(_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xfb)]=='QA')try{const {invoice:_0x4860a4,date:_0x18e790,warehouse_name:_0x4fd83d,product_name:_0x3258f5,primary_code:_0xd4b533,secondary_code:_0x149ce9,product_code:_0x45436d,sales_quantity:_0x41fa84,stocks:_0x5ee22f,return_qty:_0x35f1e4,Room_name:_0x23b0aa,to_warehouse_name_QA:_0x481030,to_Room_name_QA:_0x2898b7,note:_0x436771,for_categorize:_0x17f6a7,product_name_QA1:_0x423aa2}=_0x4247a0[_0x12a57e(0x144)];if(typeof _0x423aa2==_0x12a57e(0x151))var _0x455254=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x13b)]],_0x3c4540=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x192)]],_0x1f7c45=[_0x4247a0['body']['secondary_code_QA']],_0x46c032=[_0x4247a0[_0x12a57e(0x144)]['product_code_QA']],_0x83301f=[_0x4247a0[_0x12a57e(0x144)]['sales_quantity_QA']],_0xad02a9=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x117)]],_0x23c1b0=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x12a)]],_0x4e31d6=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x14c)]],_0x472f19=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xc7)]],_0x297b26=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x19b)]],_0x43abd5=[_0x4247a0[_0x12a57e(0x144)]['secondary_unit_QA']],_0x37c67e=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x13a)]],_0xf57eb=[_0x4247a0['body'][_0x12a57e(0x178)]],_0x9067ac=[_0x4247a0[_0x12a57e(0x144)]['expiry_date_QA']];else var _0x455254=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x13b)]],_0x3c4540=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x192)]],_0x1f7c45=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xb5)]],_0x46c032=[..._0x4247a0['body']['product_code_QA']],_0x83301f=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xab)]],_0xad02a9=[..._0x4247a0[_0x12a57e(0x144)]['stocks_QA']],_0x23c1b0=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x12a)]],_0x4e31d6=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x14c)]],_0x472f19=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xc7)]],_0x297b26=[..._0x4247a0['body'][_0x12a57e(0x19b)]],_0x43abd5=[..._0x4247a0[_0x12a57e(0x144)]['secondary_unit_QA']],_0x37c67e=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x13a)]],_0xf57eb=[..._0x4247a0['body'][_0x12a57e(0x178)]],_0x9067ac=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xe7)]];const _0x4b66a3=_0x455254[_0x12a57e(0x17a)](_0x1e37fd=>{return _0x1e37fd={'product_name':_0x1e37fd};});_0x3c4540[_0x12a57e(0x150)]((_0x25890c,_0x1eec69)=>{var _0x35a608=_0x12a57e;_0x4b66a3[_0x1eec69][_0x35a608(0x138)]=_0x25890c;}),_0x1f7c45[_0x12a57e(0x150)]((_0x1b6cfc,_0x4e05f2)=>{var _0x2630ca=_0x12a57e;_0x4b66a3[_0x4e05f2][_0x2630ca(0x10f)]=_0x1b6cfc;}),_0x46c032[_0x12a57e(0x150)]((_0x38fd68,_0x345158)=>{var _0x6abb51=_0x12a57e;_0x4b66a3[_0x345158][_0x6abb51(0xcc)]=_0x38fd68;}),_0x83301f[_0x12a57e(0x150)]((_0x41aaa3,_0x49575e)=>{var _0x3228dd=_0x12a57e;_0x4b66a3[_0x49575e][_0x3228dd(0x122)]=_0x41aaa3;}),_0xad02a9['forEach']((_0x1f35f4,_0x3e15db)=>{var _0x215422=_0x12a57e;_0x4b66a3[_0x3e15db][_0x215422(0xc8)]=_0x1f35f4;}),_0x23c1b0[_0x12a57e(0x150)]((_0x29a91f,_0x24ca80)=>{var _0x35513e=_0x12a57e;_0x4b66a3[_0x24ca80][_0x35513e(0x132)]=_0x29a91f;}),_0x4e31d6[_0x12a57e(0x150)]((_0x1e02d8,_0xc1c811)=>{var _0x4d4524=_0x12a57e;_0x4b66a3[_0xc1c811][_0x4d4524(0x15a)]=_0x1e02d8;}),_0x472f19[_0x12a57e(0x150)]((_0x351065,_0x259086)=>{var _0x4803b6=_0x12a57e;_0x4b66a3[_0x259086][_0x4803b6(0x164)]=_0x351065;}),_0x297b26[_0x12a57e(0x150)]((_0x8ecd2d,_0x28388e)=>{_0x4b66a3[_0x28388e]['batch_code']=_0x8ecd2d;}),_0x43abd5[_0x12a57e(0x150)]((_0x35669c,_0x5271cd)=>{var _0x39b50d=_0x12a57e;_0x4b66a3[_0x5271cd][_0x39b50d(0x1b2)]=_0x35669c;}),_0x37c67e['forEach']((_0x30ce45,_0x1c8787)=>{_0x4b66a3[_0x1c8787]['unit']=_0x30ce45;}),_0xf57eb[_0x12a57e(0x150)]((_0x599f0f,_0x1c9ac7)=>{var _0x371c2c=_0x12a57e;_0x4b66a3[_0x1c9ac7][_0x371c2c(0x19a)]=_0x599f0f;}),_0x9067ac[_0x12a57e(0x150)]((_0x1924a8,_0x52eb10)=>{var _0x3576f0=_0x12a57e;_0x4b66a3[_0x52eb10][_0x3576f0(0x123)]=_0x1924a8;});const _0x14f15c=await sales_finished['findOne']({'invoice':_0x4860a4});_0x14f15c['return_data']=_0x12a57e(0x195);const _0x3865c3=await _0x14f15c[_0x12a57e(0xe6)](),_0x274a52=new sales_return_finished({'invoice':_0x4860a4,'customer':_0x4247a0['body']['customer'],'date':_0x18e790,'warehouse_name':_0x4fd83d,'room':_0x23b0aa,'ToWarehouse':_0x481030,'ToRoom':_0x2898b7,'return_sale_QA':_0x4b66a3,'note':_0x436771,'warehouse_cat':_0x17f6a7}),_0x3e8da0=await _0x274a52[_0x12a57e(0xe6)](),_0x4cf026=await sales_return_finished[_0x12a57e(0xa2)]({'invoice':_0x4860a4}),_0x2ada77=await warehouse[_0x12a57e(0xa2)]({'name':_0x481030,'room':_0x2898b7});_0x4cf026[_0x12a57e(0x121)][_0x12a57e(0x150)](_0x101308=>{var _0x86e06=_0x12a57e,_0x2bab17=0x0;const _0x242d54=_0x2ada77[_0x86e06(0x149)][_0x86e06(0x17a)](_0x4cc2b0=>{var _0x3c7ecd=_0x86e06;_0x4cc2b0[_0x3c7ecd(0x10a)]==_0x101308[_0x3c7ecd(0x10a)]&&_0x4cc2b0[_0x3c7ecd(0x123)]==_0x101308[_0x3c7ecd(0x123)]&&_0x4cc2b0[_0x3c7ecd(0x19a)]==_0x101308[_0x3c7ecd(0x19a)]&&_0x4cc2b0[_0x3c7ecd(0x10e)]==_0x101308['batch_code']&&(_0x4cc2b0[_0x3c7ecd(0x18d)]=parseInt(_0x4cc2b0[_0x3c7ecd(0x18d)])+parseInt(_0x101308[_0x3c7ecd(0x132)]),_0x2bab17++);});_0x2bab17=='0'&&(_0x2ada77[_0x86e06(0x149)]=_0x2ada77[_0x86e06(0x149)][_0x86e06(0x173)]({'product_name':_0x101308[_0x86e06(0x10a)],'product_stock':_0x101308['return_qty'],'primary_code':_0x101308['primary_code'],'secondary_code':_0x101308['secondary_code'],'product_code':_0x101308[_0x86e06(0xcc)],'batch_code':_0x101308[_0x86e06(0x10e)],'maxPerUnit':_0x101308['maxPerUnit'],'production_date':_0x101308[_0x86e06(0x19a)],'expiry_date':_0x101308[_0x86e06(0x123)],'secondary_unit':_0x101308[_0x86e06(0x1b2)],'unit':_0x101308['unit'],'maxProducts':_0x101308[_0x86e06(0x164)],'bay':_0x101308[_0x86e06(0x15d)]}));}),await _0x2ada77[_0x12a57e(0xe6)]();const _0x4f970c=new c_payment_data({'invoice':_0x4860a4,'customer':_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x181)],'reason':_0x12a57e(0x160)});await _0x4f970c[_0x12a57e(0xe6)]();const _0x3a88d6=await master_shop[_0x12a57e(0xd3)](),_0x59b456=await email_settings[_0x12a57e(0xa2)](),_0x3a8cae=await customer[_0x12a57e(0xa2)]({'name':_0x4247a0['body']['customer']});_0x3a88d6[0x0][_0x12a57e(0x131)]==0x1?(right_currency=_0x3a88d6[0x0][_0x12a57e(0xff)],left_currency=''):(right_currency='',left_currency=_0x3a88d6[0x0][_0x12a57e(0xff)]);var _0x39269a=_0x455254,_0x1cc32f=_0x23c1b0,_0x31eab8='',_0x846eb9;for(_0x846eb9 in _0x39269a){_0x31eab8+='<tr>'+_0x12a57e(0x141)+_0x39269a[_0x846eb9]+_0x12a57e(0x143)+_0x12a57e(0x141)+_0x1cc32f[_0x846eb9]+_0x12a57e(0x143)+_0x12a57e(0x101);}console[_0x12a57e(0xa9)](_0x12a57e(0x9f),_0x31eab8);let _0x5126e7=nodemailer[_0x12a57e(0xac)]({'service':_0x12a57e(0x1a6),'auth':{'user':_0x59b456[_0x12a57e(0xa0)],'pass':_0x59b456[_0x12a57e(0xe3)]}}),_0x3ad159={'from':_0x59b456[_0x12a57e(0xa0)],'to':_0x3a8cae[_0x12a57e(0xa0)],'subject':_0x12a57e(0x197),'attachments':[{'filename':_0x12a57e(0x170),'path':__dirname+_0x12a57e(0x16f)+_0x12a57e(0xd5)+_0x3a88d6[0x0]['image'],'cid':'logo'}],'html':_0x12a57e(0x165)+_0x12a57e(0x11b)+'</head><body>'+_0x12a57e(0x128)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x12a57e(0x128)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x12a57e(0x108)+_0x12a57e(0x128)+_0x12a57e(0x14f)+_0x3a88d6[0x0][_0x12a57e(0xeb)]+'\x20</h2>'+_0x12a57e(0x108)+_0x12a57e(0x108)+_0x12a57e(0x13d)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x12a57e(0xfa)+_0x4860a4+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x18e790+'\x20'+_0x12a57e(0x116)+'</h5>'+'</div>'+_0x12a57e(0x11c)+_0x12a57e(0xa8)+_0x12a57e(0x19e)+_0x12a57e(0xdf)+_0x12a57e(0xf2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x12a57e(0x186)+_0x12a57e(0x101)+'</thead>'+_0x12a57e(0x12d)+'\x20'+_0x31eab8+'\x20'+_0x12a57e(0x194)+_0x12a57e(0x105)+'<div>'+_0x12a57e(0x125)+_0x12a57e(0x1a8)+_0x3a88d6[0x0][_0x12a57e(0xeb)]+_0x12a57e(0xb3)+'</div>'+_0x12a57e(0x108)+'</body></html>'};_0x5126e7[_0x12a57e(0xe5)](_0x3ad159,function(_0x19fc2e,_0x5d5d9a){var _0x547a14=_0x12a57e;_0x19fc2e?(console[_0x547a14(0xa9)](_0x19fc2e),console['log'](_0x547a14(0x12b))):console[_0x547a14(0xa9)]('Email\x20sent\x20successfully');}),_0x4247a0[_0x12a57e(0x159)](_0x12a57e(0x161),_0x12a57e(0xf3)),_0x1edf1e[_0x12a57e(0x146)](_0x12a57e(0x127));}catch(_0x306f3d){_0x1edf1e[_0x12a57e(0x176)](0xc8)[_0x12a57e(0x10c)]({'message1':_0x306f3d[_0x12a57e(0x16b)]});}else{if(_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xfb)]=='GS')try{const {invoice:_0x690005,date:_0x4d75e8,warehouse_name:_0x5eed2b,product_name:_0x3d7be4,primary_code:_0x4195e9,secondary_code:_0x5ed2fd,product_code:_0x295132,sales_quantity:_0x53262e,stocks:_0x50a0bd,return_qty:_0x2aa287,Room_name:_0x38284c,to_warehouse_name:_0x30d2fa,to_Room_name:_0x13e977,note:_0x5396cb,level:_0x40dc7a,isle:_0x1a0f37,pallet:_0x125fd,for_categorize:_0x5ec28d}=_0x4247a0[_0x12a57e(0x144)];if(typeof _0x3d7be4==_0x12a57e(0x151))var _0x455254=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x10a)]],_0x3c4540=[_0x4247a0[_0x12a57e(0x144)]['primary_code']],_0x1f7c45=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x10f)]],_0x46c032=[_0x4247a0['body'][_0x12a57e(0xcc)]],_0x83301f=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xef)]],_0x23c1b0=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x132)]],_0x3ec6f1=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x15d)]],_0x4e31d6=[_0x4247a0['body']['maxPerUnit']],_0x472f19=[_0x4247a0['body'][_0x12a57e(0x164)]],_0x297b26=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x10e)]],_0x43abd5=[_0x4247a0['body'][_0x12a57e(0x1b2)]],_0x37c67e=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x154)]],_0xf57eb=[_0x4247a0['body'][_0x12a57e(0x19a)]],_0x9067ac=[_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x123)]];else var _0x455254=[..._0x4247a0['body'][_0x12a57e(0x10a)]],_0x3c4540=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x138)]],_0x1f7c45=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x10f)]],_0x46c032=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0xcc)]],_0x83301f=[..._0x4247a0['body'][_0x12a57e(0xef)]],_0x23c1b0=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x132)]],_0x3ec6f1=[..._0x4247a0['body'][_0x12a57e(0x15d)]],_0x4e31d6=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x15a)]],_0x472f19=[..._0x4247a0['body'][_0x12a57e(0x164)]],_0x297b26=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x10e)]],_0x43abd5=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x1b2)]],_0x37c67e=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x154)]],_0xf57eb=[..._0x4247a0['body']['production_date']],_0x9067ac=[..._0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x123)]];const _0x46a4ad=_0x455254[_0x12a57e(0x17a)](_0x1692e4=>{return _0x1692e4={'product_name':_0x1692e4};});_0x3c4540[_0x12a57e(0x150)]((_0x622996,_0x45aa8a)=>{var _0x4cecac=_0x12a57e;_0x46a4ad[_0x45aa8a][_0x4cecac(0x138)]=_0x622996;}),_0x1f7c45[_0x12a57e(0x150)]((_0x2fd87b,_0x3bdfa9)=>{var _0x4f0b6d=_0x12a57e;_0x46a4ad[_0x3bdfa9][_0x4f0b6d(0x10f)]=_0x2fd87b;}),_0x46c032[_0x12a57e(0x150)]((_0x79cda5,_0x4b468a)=>{var _0x5efb86=_0x12a57e;_0x46a4ad[_0x4b468a][_0x5efb86(0xcc)]=_0x79cda5;}),_0x83301f[_0x12a57e(0x150)]((_0x184230,_0xbbc7f5)=>{var _0x6e19f7=_0x12a57e;_0x46a4ad[_0xbbc7f5][_0x6e19f7(0x122)]=_0x184230;}),_0x23c1b0[_0x12a57e(0x150)]((_0x15be5c,_0x4fd44c)=>{_0x46a4ad[_0x4fd44c]['return_qty']=_0x15be5c;}),_0x3ec6f1[_0x12a57e(0x150)]((_0x571217,_0x2a0c85)=>{var _0x3dfcce=_0x12a57e;_0x46a4ad[_0x2a0c85][_0x3dfcce(0x15d)]=_0x571217;}),_0x4e31d6[_0x12a57e(0x150)]((_0x882c8d,_0x1b8f4d)=>{var _0x3de755=_0x12a57e;_0x46a4ad[_0x1b8f4d][_0x3de755(0x15a)]=_0x882c8d;}),_0x472f19['forEach']((_0x4e15ab,_0x56b00f)=>{_0x46a4ad[_0x56b00f]['maxProducts']=_0x4e15ab;}),_0x297b26[_0x12a57e(0x150)]((_0x595e19,_0x139fab)=>{var _0x2c0665=_0x12a57e;_0x46a4ad[_0x139fab][_0x2c0665(0x10e)]=_0x595e19;}),_0x43abd5['forEach']((_0x2a4c6e,_0x114685)=>{var _0x4ba43e=_0x12a57e;_0x46a4ad[_0x114685][_0x4ba43e(0x1b2)]=_0x2a4c6e;}),_0x37c67e[_0x12a57e(0x150)]((_0xcfbce4,_0x271b22)=>{var _0x39ec5c=_0x12a57e;_0x46a4ad[_0x271b22][_0x39ec5c(0x154)]=_0xcfbce4;}),_0xf57eb[_0x12a57e(0x150)]((_0x287534,_0x2823b6)=>{var _0xe912ef=_0x12a57e;_0x46a4ad[_0x2823b6][_0xe912ef(0x19a)]=_0x287534;}),_0x9067ac[_0x12a57e(0x150)]((_0xe150b5,_0xfc7697)=>{var _0x55a820=_0x12a57e;_0x46a4ad[_0xfc7697][_0x55a820(0x123)]=_0xe150b5;});var _0x186cfd=0x0;_0x46a4ad[_0x12a57e(0x150)](_0x5dc4f8=>{var _0x4ee71d=_0x12a57e;(parseInt(_0x5dc4f8[_0x4ee71d(0x122)])<parseInt(_0x5dc4f8[_0x4ee71d(0x132)])||parseInt(_0x5dc4f8[_0x4ee71d(0xc8)])<parseInt(_0x5dc4f8[_0x4ee71d(0x132)])&&parseInt(_0x5dc4f8[_0x4ee71d(0x122)])>parseInt(_0x5dc4f8[_0x4ee71d(0x132)])||parseInt(_0x5dc4f8['return_qty'])==0x0)&&_0x186cfd++;});if(_0x186cfd!=0x0)return _0x4247a0[_0x12a57e(0x159)](_0x12a57e(0x118),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x1edf1e['redirect'](_0x12a57e(0xf5));const _0x289ceb=await sales_finished[_0x12a57e(0xa2)]({'invoice':_0x690005});_0x289ceb['return_data']=_0x12a57e(0x195);const _0x58c2b6=await _0x289ceb['save'](),_0x4bf34c=new sales_return_finished({'invoice':_0x690005,'customer':_0x4247a0['body'][_0x12a57e(0x181)],'date':_0x4d75e8,'warehouse_name':_0x5eed2b,'room':_0x38284c,'ToWarehouse':_0x30d2fa,'ToRoom':_0x13e977,'return_sale':_0x46a4ad,'note':_0x5396cb,'warehouse_cat':_0x5ec28d}),_0x3d7716=await _0x4bf34c[_0x12a57e(0xe6)](),_0xb6c377=await sales_return_finished[_0x12a57e(0xa2)]({'invoice':_0x690005}),_0x550ea2=await warehouse[_0x12a57e(0xa2)]({'name':_0x30d2fa,'room':_0x13e977,'warehouse_category':_0x12a57e(0xaf)});_0xb6c377['return_sale']['forEach'](_0x50c141=>{var _0x5824c2=_0x12a57e,_0x2f96c7=0x0;const _0x3d61ac=_0x550ea2[_0x5824c2(0x149)]['map'](_0x8c7a24=>{var _0x5910c2=_0x5824c2;_0x8c7a24['product_name']==_0x50c141[_0x5910c2(0x10a)]&&_0x8c7a24['bay']==_0x50c141[_0x5910c2(0x15d)]&&_0x8c7a24[_0x5910c2(0x123)]==_0x50c141[_0x5910c2(0x123)]&&_0x8c7a24[_0x5910c2(0x19a)]==_0x50c141['production_date']&&_0x8c7a24['batch_code']==_0x50c141['batch_code']&&(_0x8c7a24[_0x5910c2(0x18d)]=parseInt(_0x8c7a24[_0x5910c2(0x18d)])+parseInt(_0x50c141[_0x5910c2(0x132)]),_0x2f96c7++);});_0x2f96c7=='0'&&(_0x550ea2[_0x5824c2(0x149)]=_0x550ea2['product_details'][_0x5824c2(0x173)]({'product_name':_0x50c141[_0x5824c2(0x10a)],'product_stock':_0x50c141[_0x5824c2(0x132)],'primary_code':_0x50c141[_0x5824c2(0x138)],'secondary_code':_0x50c141[_0x5824c2(0x10f)],'product_code':_0x50c141[_0x5824c2(0xcc)],'bay':_0x50c141[_0x5824c2(0x15d)],'batch_code':_0x50c141[_0x5824c2(0x10e)],'maxPerUnit':_0x50c141[_0x5824c2(0x15a)],'production_date':_0x50c141[_0x5824c2(0x19a)],'expiry_date':_0x50c141[_0x5824c2(0x123)],'secondary_unit':_0x50c141[_0x5824c2(0x1b2)],'unit':_0x50c141[_0x5824c2(0x154)],'maxProducts':_0x50c141['maxProducts']}));}),await _0x550ea2[_0x12a57e(0xe6)](),console[_0x12a57e(0xa9)](_0x4247a0[_0x12a57e(0x144)]);const _0x5296a1=new c_payment_data({'invoice':_0x690005,'customer':_0x4247a0[_0x12a57e(0x144)][_0x12a57e(0x181)],'reason':_0x12a57e(0x160)});await _0x5296a1['save']();const _0x595ca5=await master_shop['find']();console[_0x12a57e(0xa9)](_0x12a57e(0x112),_0x595ca5[0x0]['image']);const _0x260cfa=await email_settings[_0x12a57e(0xa2)](),_0x12d008=await customer[_0x12a57e(0xa2)]({'name':_0x4247a0[_0x12a57e(0x144)]['customer']});console[_0x12a57e(0xa9)](_0x12a57e(0x16c),_0x12d008);_0x595ca5[0x0][_0x12a57e(0x131)]==0x1?(right_currency=_0x595ca5[0x0][_0x12a57e(0xff)],left_currency=''):(right_currency='',left_currency=_0x595ca5[0x0]['currency']);var _0x39269a=_0x455254,_0x1cc32f=_0x23c1b0,_0x31eab8='',_0x846eb9;for(_0x846eb9 in _0x39269a){_0x31eab8+=_0x12a57e(0x19e)+_0x12a57e(0x141)+_0x39269a[_0x846eb9]+_0x12a57e(0x143)+_0x12a57e(0x141)+_0x1cc32f[_0x846eb9]+_0x12a57e(0x143)+'</tr>';}console['log'](_0x12a57e(0x9f),_0x31eab8);let _0xaca467=nodemailer['createTransport']({'service':'gmail','auth':{'user':_0x260cfa[_0x12a57e(0xa0)],'pass':_0x260cfa[_0x12a57e(0xe3)]}}),_0x1cd621={'from':_0x260cfa['email'],'to':_0x12d008[_0x12a57e(0xa0)],'subject':_0x12a57e(0x197),'attachments':[{'filename':_0x12a57e(0x170),'path':__dirname+_0x12a57e(0x16f)+_0x12a57e(0xd5)+_0x595ca5[0x0]['image'],'cid':'logo'}],'html':_0x12a57e(0x165)+_0x12a57e(0x11b)+'</head><body>'+'<div>'+_0x12a57e(0x16e)+_0x12a57e(0x128)+_0x12a57e(0x1b0)+_0x12a57e(0x108)+_0x12a57e(0x128)+_0x12a57e(0x14f)+_0x595ca5[0x0]['site_title']+_0x12a57e(0x1ad)+_0x12a57e(0x108)+_0x12a57e(0x108)+_0x12a57e(0x13d)+_0x12a57e(0x128)+_0x12a57e(0xc4)+_0x12a57e(0xfa)+_0x690005+'\x20'+_0x12a57e(0x1a3)+_0x12a57e(0x14a)+_0x4d75e8+'\x20'+_0x12a57e(0x116)+_0x12a57e(0xb3)+'</div>'+_0x12a57e(0x11c)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x12a57e(0x19e)+_0x12a57e(0xdf)+_0x12a57e(0xf2)+_0x12a57e(0x152)+_0x12a57e(0x186)+_0x12a57e(0x101)+_0x12a57e(0xfe)+_0x12a57e(0x12d)+'\x20'+_0x31eab8+'\x20'+_0x12a57e(0x194)+_0x12a57e(0x105)+_0x12a57e(0x128)+_0x12a57e(0x125)+_0x12a57e(0x1a8)+_0x595ca5[0x0][_0x12a57e(0xeb)]+'</h5>'+'</div>'+'</div>'+'</body></html>'};_0xaca467['sendMail'](_0x1cd621,function(_0xc93ded,_0x4237b7){var _0x1d2ace=_0x12a57e;_0xc93ded?(console[_0x1d2ace(0xa9)](_0xc93ded),console['log']('Error\x20Occurs')):console[_0x1d2ace(0xa9)](_0x1d2ace(0x1a7));}),_0x4247a0[_0x12a57e(0x159)]('success',_0x12a57e(0xf3)),_0x1edf1e[_0x12a57e(0x146)](_0x12a57e(0x127));}catch(_0x48246e){console[_0x12a57e(0xa9)](_0x48246e),_0x1edf1e[_0x12a57e(0x176)](0xc8)[_0x12a57e(0x10c)]({'message1':_0x48246e[_0x12a57e(0x16b)]});}}}),router[a0_0x563031(0xec)](a0_0x563031(0x12e),auth,async(_0x2f4518,_0x54863f)=>{var _0x1943b0=a0_0x563031;try{const {username:_0x4675bc,email:_0x49d831,role:_0x50f352}=_0x2f4518[_0x1943b0(0x134)],_0x50e97d=_0x2f4518[_0x1943b0(0x134)],_0x468129=await profile['findOne']({'email':_0x50e97d[_0x1943b0(0xa0)]}),_0x495ec7=await master_shop[_0x1943b0(0xd3)]();console['log'](_0x1943b0(0xd4),_0x495ec7);const _0x62d835=_0x2f4518[_0x1943b0(0xa4)]['id'],_0x2f746d=await sales['findById'](_0x62d835);console[_0x1943b0(0xa9)](_0x1943b0(0xf9),_0x2f746d);if(_0x495ec7[0x0]['language']=='English\x20(US)')var _0x11bd6f=users[_0x1943b0(0x1a4)];else{if(_0x495ec7[0x0]['language']=='Hindi')var _0x11bd6f=users[_0x1943b0(0x97)];else{if(_0x495ec7[0x0][_0x1943b0(0x166)]==_0x1943b0(0x140))var _0x11bd6f=users[_0x1943b0(0x140)];else{if(_0x495ec7[0x0][_0x1943b0(0x166)]=='Spanish')var _0x11bd6f=users['Spanish'];else{if(_0x495ec7[0x0][_0x1943b0(0x166)]==_0x1943b0(0x171))var _0x11bd6f=users[_0x1943b0(0x171)];else{if(_0x495ec7[0x0][_0x1943b0(0x166)]=='Portuguese\x20(BR)')var _0x11bd6f=users[_0x1943b0(0x9a)];else{if(_0x495ec7[0x0][_0x1943b0(0x166)]==_0x1943b0(0x196))var _0x11bd6f=users[_0x1943b0(0x196)];else{if(_0x495ec7[0x0][_0x1943b0(0x166)]=='Arabic\x20(ae)')var _0x11bd6f=users[_0x1943b0(0xaa)];}}}}}}}_0x54863f[_0x1943b0(0xdc)](_0x1943b0(0x137),{'success':_0x2f4518[_0x1943b0(0x159)](_0x1943b0(0x161)),'errors':_0x2f4518['flash'](_0x1943b0(0x118)),'role':_0x50e97d,'profile':_0x468129,'alldata':_0x2f746d,'master_shop':_0x495ec7,'language':_0x11bd6f});}catch(_0x1ef049){console['log'](_0x1ef049);}}),router[a0_0x563031(0x1ab)](a0_0x563031(0x14e),async(_0x302b94,_0x3bfe0a)=>{var _0x677064=a0_0x563031;const {product_code:_0x161379,warehouse_name:_0x43a881,rooms_data:_0x54fa26,Roomslist:_0x5f0f10,sales_category:_0x198d11}=_0x302b94[_0x677064(0x144)],_0x2077a9=_0x5f0f10['split'](','),_0x324ae5=[];async function _0x3ca71b(_0x41e641){var _0x13351d=_0x677064;const _0x38908f=await warehouse[_0x13351d(0x17f)]([{'$match':{'name':_0x43a881,'room':_0x41e641}},{'$unwind':_0x13351d(0x12c)},{'$match':{'product_details.primary_code':_0x161379}},{'$group':{'_id':_0x13351d(0xc9),'name':{'$first':_0x13351d(0xce)},'product_stock':{'$first':_0x13351d(0x17e)},'primary_code':{'$first':_0x13351d(0x198)},'secondary_code':{'$first':_0x13351d(0xc2)},'product_code':{'$first':_0x13351d(0x17b)},'level':{'$first':'$product_details.level'},'bay':{'$first':_0x13351d(0x145)},'type':{'$first':_0x13351d(0x130)},'pallet':{'$first':_0x13351d(0x98)},'unit':{'$first':_0x13351d(0xed)},'secondary_unit':{'$first':_0x13351d(0x16a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x13351d(0xcd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x13351d(0x180)},'maxPerUnit':{'$first':_0x13351d(0x19d)},'batch_code':{'$first':_0x13351d(0x1aa)},'product_cat':{'$first':_0x13351d(0x13e)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x13351d(0x11f)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x13351d(0x115)},'gross_price':{'$first':_0x13351d(0xad)},'sales_category':{'$first':_0x13351d(0xd2)}}}]),_0x373824=await warehouse['aggregate']([{'$match':{'name':_0x43a881,'room':_0x41e641}},{'$unwind':_0x13351d(0x12c)},{'$match':{'product_details.secondary_code':_0x161379}},{'$group':{'_id':_0x13351d(0xc9),'name':{'$first':_0x13351d(0xce)},'product_stock':{'$first':_0x13351d(0x17e)},'primary_code':{'$first':_0x13351d(0x198)},'secondary_code':{'$first':_0x13351d(0xc2)},'product_code':{'$first':_0x13351d(0x17b)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x13351d(0x98)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x13351d(0x16a)},'storage':{'$first':_0x13351d(0x9b)},'rack':{'$first':_0x13351d(0xcd)},'expiry_date':{'$first':_0x13351d(0xa7)},'production_date':{'$first':_0x13351d(0x180)},'maxPerUnit':{'$first':_0x13351d(0x19d)},'batch_code':{'$first':_0x13351d(0x1aa)},'product_cat':{'$first':_0x13351d(0x13e)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x13351d(0x11f)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x13351d(0x115)},'gross_price':{'$first':_0x13351d(0xad)},'sales_category':{'$first':_0x13351d(0xd2)}}}]);if(_0x38908f['length']>0x0)_0x324ae5[_0x13351d(0x172)](_0x38908f);else _0x373824[_0x13351d(0x120)]>0x0&&_0x324ae5[_0x13351d(0x172)](_0x373824);}const _0x2eb4ad=_0x2077a9[_0x677064(0x17a)](_0x1547c8=>_0x3ca71b(_0x1547c8));await Promise[_0x677064(0x15c)](_0x2eb4ad),_0x3bfe0a[_0x677064(0x10c)](_0x324ae5);}),router['post'](a0_0x563031(0x129),async(_0x3c5b52,_0x138b6c)=>{var _0x1337a0=a0_0x563031;const {product_code:_0x4dc133,warehouse_name:_0x4ea9c6,rooms_data:_0x227310,Roomslist:_0x20b4d9,sales_category:_0x46d8b9}=_0x3c5b52[_0x1337a0(0x144)],_0xfe4df5=_0x20b4d9[_0x1337a0(0x189)](','),_0x55092b=[];async function _0x3fcc12(_0x408283){var _0x336a6a=_0x1337a0;const _0x4334d6=await warehouse[_0x336a6a(0x17f)]([{'$match':{'name':_0x4ea9c6,'room':_0x408283}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x4dc133,'product_details.sales_category':_0x46d8b9,'product_details.type_products':'log'}},{'$group':{'_id':_0x336a6a(0xc9),'name':{'$first':_0x336a6a(0xce)},'product_stock':{'$first':_0x336a6a(0x17e)},'primary_code':{'$first':_0x336a6a(0x198)},'secondary_code':{'$first':_0x336a6a(0xc2)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x336a6a(0x1b3)},'bay':{'$first':_0x336a6a(0x145)},'type':{'$first':_0x336a6a(0x130)},'pallet':{'$first':_0x336a6a(0x98)},'unit':{'$first':_0x336a6a(0xed)},'secondary_unit':{'$first':_0x336a6a(0x16a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x336a6a(0xcd)},'expiry_date':{'$first':_0x336a6a(0xa7)},'production_date':{'$first':_0x336a6a(0x180)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x336a6a(0x1aa)},'product_cat':{'$first':_0x336a6a(0x13e)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x336a6a(0x11f)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x336a6a(0xad)},'sales_category':{'$first':_0x336a6a(0xd2)},'type_products':{'$first':'$product_details.type_products'}}}]);console[_0x336a6a(0xa9)](_0x336a6a(0xa9)+_0x336a6a(0x124)+_0x4dc133+_0x336a6a(0x124)+_0x46d8b9);const _0x1bbe0b=await warehouse[_0x336a6a(0x17f)]([{'$match':{'name':_0x4ea9c6,'room':_0x408283}},{'$unwind':_0x336a6a(0x12c)},{'$match':{'product_details.secondary_code':_0x4dc133,'product_details.sales_category':_0x46d8b9,'product_details.type_products':_0x336a6a(0xa9)}},{'$group':{'_id':_0x336a6a(0xc9),'name':{'$first':_0x336a6a(0xce)},'product_stock':{'$first':_0x336a6a(0x17e)},'primary_code':{'$first':_0x336a6a(0x198)},'secondary_code':{'$first':_0x336a6a(0xc2)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x336a6a(0x145)},'isle':{'$first':_0x336a6a(0x139)},'type':{'$first':_0x336a6a(0x130)},'pallet':{'$first':_0x336a6a(0x98)},'unit':{'$first':_0x336a6a(0xed)},'secondary_unit':{'$first':_0x336a6a(0x16a)},'storage':{'$first':_0x336a6a(0x9b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x336a6a(0x180)},'maxPerUnit':{'$first':_0x336a6a(0x19d)},'batch_code':{'$first':_0x336a6a(0x1aa)},'product_cat':{'$first':_0x336a6a(0x13e)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x336a6a(0x115)},'gross_price':{'$first':_0x336a6a(0xad)},'sales_category':{'$first':_0x336a6a(0xd2)},'type_products':{'$first':'$product_details.type_products'}}}]);if(_0x4334d6[_0x336a6a(0x120)]>0x0)_0x55092b[_0x336a6a(0x172)](_0x4334d6);else _0x1bbe0b[_0x336a6a(0x120)]>0x0&&_0x55092b[_0x336a6a(0x172)](_0x1bbe0b);}const _0x396885=_0xfe4df5['map'](_0x438c50=>_0x3fcc12(_0x438c50));await Promise['all'](_0x396885),_0x138b6c[_0x1337a0(0x10c)](_0x55092b);}),module[a0_0x563031(0x193)]=router;function a0_0x26a2(){var _0x10d906=['body','$product_details.bay','redirect','Return\x20Rooms','76029VFpsLE','product_details','\x20Order\x20Date\x20:\x20','$date','maxPerUnit_QA','express','/barcode_scanner','<h2>\x20','forEach','string','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','product_date','unit','$sale_product.quantity','warehouse','$invoice','staff','flash','maxPerUnit','Enclosed','all','bay','765536oiFTlG','invoice_init','Sale\x20Return','success','False','Sales\x20Add\x20successfully','maxProducts','<!DOCTYPE\x20html>','language','undefined','level','Received\x20Payment\x20For\x20Sale','$product_details.secondary_unit','message','customer_data','prod_invoice','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/../public','Logo.png','French','push','concat','purchases_data','due_amount','status','valueOf','production_date_QA','OUT-','map','$product_details.product_code','final','max','$product_details.product_stock','aggregate','$product_details.production_date','customer','maxperunit','$note','catch','/view/add_sales_logs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$sale_product.bin','239650EpHPte','split','master','nodemailer','agent_id','product_stock','warehouse_name','slice','date','stock_data','primary_code_QA','exports','</tbody>','True','Chinese','Sale\x20Return\x20Mail','$product_details.primary_code','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','production_date','batch_code_QA','then','$product_details.maxPerUnit','<tr>','/invoice/:id','quantity','here','room_name','<span\x20style=\x22float:\x20right;\x22>','English','$return_data','gmail','Email\x20sent\x20successfully','<h5>','Sales\x20Update\x20successfully','$product_details.batch_code','post','match','\x20</h2>','$sale_product.type','product_data','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','../models/all_models','secondary_unit','$product_details.level','level2','room','Hindi','$product_details.floorlevel','/view/add_sale/product','Portuguese','$product_details.storage','/give_payment/:id','OUTF-','edit_sales_finished','product_list','email','There\x27s\x20a\x20error\x20in\x20this\x20transaction','findOne','int','params','updateOne','$customers_docs','$product_details.expiry_date','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','log','Arabic','sales_quantity_QA','createTransport','$product_details.gross_price','$product','Finished\x20Goods','$finalize','/all_sales/view','getMonth','</h5>','role','secondary_code_QA','max_per_unit','$product_details.room_name','warehouse_id','2112008BSDUuc','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$warehouse_name','236904GPmgqf','product','/view/:id','/view/add_sales/:id','received_amount','Quality\x20Inspection','$product_details.secondary_code','$_id','<h5\x20style=\x22text-align:\x20left;\x22>','../middleware/auth','padStart','maxProducts_QA','stock','$product_details._id','filter','$sale_product.bay','product_code','$product_details.rack','$product_details.product_name','RoomAssigned','adjust_qty','floor','$product_details.sales_category','find','barcode\x20Product\x20master','/upload/','getDate','LOG-OUT-','outgoing_invoice','Portuguese\x20(BR)','/view','suppliers','render','all_sales_finished_logs','amount','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','uuid','carton','$sale_product.floorlevel','password','/preview/:id','sendMail','save','expiry_date_QA','534138lVXnAF','random','/all_sales_finished/preview/','site_title','get','$product_details.unit','sales','sales_quantity','Ambient','6vUOiPK','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','sales\x20item\x20return\x20successfull','$name','back','gross_price','sale_product','abs','barcode\x20user_id','\x20Order\x20Number\x20:\x20','for_categorize','Arabic\x20(ae)','edit_sales_finished_view','</thead>','currency','return_sale_finished','</tr>','Spanish','English\x20(US)','143600fZjDqd','</table>','Enabled','\x20==\x20','</div>','date_data','product_name','all_sales_finished','json','/view/add_sales','batch_code','secondary_code','id_transaction_from','toString','add\x20post','_id','7bVCusE','$product_details.uuid','</span>','stocks_QA','errors','prod_code','$product_details.maxProducts','<html><head><title></title>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','findById','$customer','$room','length','return_sale_QA','sale_qty','expiry_date','\x20<>\x20','<strong>\x20Regards\x20</strong>','primary_unit','/all_sales_finished/view','<div>','/barcode_scanner_logs','return_qty_QA','Error\x20Occurs','$product_details','<tbody\x20style=\x22text-align:\x20center;\x22>','/barcode/:id','/view/return_sales/:id','$product_details.type','currency_placement','return_qty','add_sales_finished_logs','user','$sale_product','prod_cat','all_sales_barcode','primary_code','$product_details.bin','unit_QA','product_name_QA1','45WaQXGQ','<hr\x20class=\x22my-3\x22>','$product_details.product_cat','invoice','German','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','own','</td>'];a0_0x26a2=function(){return _0x10d906;};return a0_0x26a2();}