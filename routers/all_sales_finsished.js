function a0_0x1a54(_0x3f127e,_0x4d8d29){var _0x419e4e=a0_0x419e();return a0_0x1a54=function(_0x1a544f,_0xc9557c){_0x1a544f=_0x1a544f-0xa4;var _0x7440c5=_0x419e4e[_0x1a544f];return _0x7440c5;},a0_0x1a54(_0x3f127e,_0x4d8d29);}var a0_0x234545=a0_0x1a54;(function(_0x5dedd0,_0x118ee4){var _0x60b5af=a0_0x1a54,_0x36c9b9=_0x5dedd0();while(!![]){try{var _0x11607a=-parseInt(_0x60b5af(0x1cc))/0x1*(-parseInt(_0x60b5af(0x190))/0x2)+parseInt(_0x60b5af(0xfb))/0x3+parseInt(_0x60b5af(0x103))/0x4+-parseInt(_0x60b5af(0x19a))/0x5*(parseInt(_0x60b5af(0x1d9))/0x6)+parseInt(_0x60b5af(0x1b6))/0x7+-parseInt(_0x60b5af(0x19f))/0x8*(-parseInt(_0x60b5af(0xf6))/0x9)+parseInt(_0x60b5af(0x158))/0xa*(-parseInt(_0x60b5af(0x15b))/0xb);if(_0x11607a===_0x118ee4)break;else _0x36c9b9['push'](_0x36c9b9['shift']());}catch(_0x301a7d){_0x36c9b9['push'](_0x36c9b9['shift']());}}}(a0_0x419e,0xda775));const express=require(a0_0x234545(0x1a4)),app=express(),router=express[a0_0x234545(0xe3)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require(a0_0x234545(0x131)),auth=require(a0_0x234545(0x163)),nodemailer=require(a0_0x234545(0x10d)),users=require(a0_0x234545(0x1d7)),mongoose=require('mongoose');router[a0_0x234545(0x18b)]('/view',auth,async(_0x148f38,_0x1b3571)=>{var _0x4442d1=a0_0x234545;try{const {username:_0x2b918f,email:_0x50275f,role:_0x26afe0}=_0x148f38[_0x4442d1(0x149)],_0x2389bd=_0x148f38[_0x4442d1(0x149)],_0x32503d=await profile[_0x4442d1(0xe5)]({'email':_0x2389bd[_0x4442d1(0x170)]}),_0x40713d=await master_shop[_0x4442d1(0x1b4)]();let _0x19a2c2;if(_0x2389bd[_0x4442d1(0x134)]==_0x4442d1(0x177)){const _0x81a187=await staff[_0x4442d1(0xe5)]({'email':_0x2389bd[_0x4442d1(0x170)]});_0x19a2c2=await sales_finished['aggregate']([{'$match':{'typeOfProducts':'own'}},{'$unwind':_0x4442d1(0xb4)},{'$group':{'_id':_0x4442d1(0x1b3),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':_0x4442d1(0xe1)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x4442d1(0xb4)},'note':{'$first':_0x4442d1(0x137)},'return_data':{'$first':_0x4442d1(0xbb)},'customers_docs':{'$first':_0x4442d1(0x16e)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x4442d1(0x1cd)},'pallet':{'$addToSet':_0x4442d1(0xb3)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x19a2c2=await sales_finished[_0x4442d1(0x16f)]([{'$match':{'typeOfProducts':_0x4442d1(0x15d)}},{'$unwind':'$sale_product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x4442d1(0x174)},'customers':{'$first':'$customer'},'date':{'$first':_0x4442d1(0xe1)},'warehouse_name':{'$first':_0x4442d1(0xdb)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x4442d1(0x137)},'return_data':{'$first':_0x4442d1(0xbb)},'customers_docs':{'$first':_0x4442d1(0x16e)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x4442d1(0x186)},'isle':{'$addToSet':_0x4442d1(0x1ce)},'type':{'$addToSet':_0x4442d1(0x1cd)},'pallet':{'$addToSet':_0x4442d1(0xb3)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x40713d[0x0][_0x4442d1(0x1d8)]==_0x4442d1(0x1af)){var _0x2963d7=users[_0x4442d1(0x1d3)];console[_0x4442d1(0xf5)](_0x2963d7);}else{if(_0x40713d[0x0][_0x4442d1(0x1d8)]==_0x4442d1(0x114))var _0x2963d7=users['Hindi'];else{if(_0x40713d[0x0][_0x4442d1(0x1d8)]==_0x4442d1(0x1cf))var _0x2963d7=users[_0x4442d1(0x1cf)];else{if(_0x40713d[0x0][_0x4442d1(0x1d8)]==_0x4442d1(0x198))var _0x2963d7=users['Spanish'];else{if(_0x40713d[0x0][_0x4442d1(0x1d8)]==_0x4442d1(0x1c8))var _0x2963d7=users[_0x4442d1(0x1c8)];else{if(_0x40713d[0x0][_0x4442d1(0x1d8)]==_0x4442d1(0x189))var _0x2963d7=users[_0x4442d1(0xe0)];else{if(_0x40713d[0x0][_0x4442d1(0x1d8)]==_0x4442d1(0x17d))var _0x2963d7=users[_0x4442d1(0x17d)];else{if(_0x40713d[0x0][_0x4442d1(0x1d8)]==_0x4442d1(0x139))var _0x2963d7=users['Arabic'];}}}}}}}_0x1b3571['render'](_0x4442d1(0xf3),{'success':_0x148f38['flash'](_0x4442d1(0x1f6)),'errors':_0x148f38[_0x4442d1(0xde)]('errors'),'sales':_0x19a2c2,'profile':_0x32503d,'role':_0x2389bd,'master_shop':_0x40713d,'language':_0x2963d7});}catch(_0x142445){console[_0x4442d1(0xf5)](_0x142445);}}),router[a0_0x234545(0x18b)]('/view_log',auth,async(_0x4badcc,_0x4c3fcb)=>{var _0x59e1ff=a0_0x234545;try{const {username:_0x3b6666,email:_0x278540,role:_0xdcb2c3}=_0x4badcc[_0x59e1ff(0x149)],_0x96b7bb=_0x4badcc[_0x59e1ff(0x149)],_0x1ff7f7=await profile[_0x59e1ff(0xe5)]({'email':_0x96b7bb['email']}),_0x1247e2=await master_shop[_0x59e1ff(0x1b4)]();let _0x234676;if(_0x96b7bb[_0x59e1ff(0x134)]==_0x59e1ff(0x177)){const _0x36cd0c=await staff[_0x59e1ff(0xe5)]({'email':_0x96b7bb[_0x59e1ff(0x170)]});_0x234676=await sales_finished[_0x59e1ff(0x16f)]([{'$match':{'typeOfProducts':_0x59e1ff(0xc9)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x59e1ff(0x1b3),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':_0x59e1ff(0xe1)},'warehouse_name':{'$first':_0x59e1ff(0xdb)},'sale_product':{'$push':'$sale_product'},'note':{'$first':'$note'},'return_data':{'$first':_0x59e1ff(0xbb)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x59e1ff(0xe7)},'level':{'$addToSet':_0x59e1ff(0x186)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x59e1ff(0x1cd)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x59e1ff(0x12f)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x234676=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x59e1ff(0xc9)}},{'$unwind':_0x59e1ff(0xb4)},{'$group':{'_id':'$_id','invoice':{'$first':_0x59e1ff(0x174)},'customers':{'$first':_0x59e1ff(0x1a8)},'date':{'$first':_0x59e1ff(0xe1)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x59e1ff(0xb4)},'note':{'$first':_0x59e1ff(0x137)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x59e1ff(0x1cd)},'pallet':{'$addToSet':_0x59e1ff(0xb3)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x1247e2[0x0]['language']=='English\x20(US)'){var _0xade9f6=users['English'];console[_0x59e1ff(0xf5)](_0xade9f6);}else{if(_0x1247e2[0x0]['language']=='Hindi')var _0xade9f6=users[_0x59e1ff(0x114)];else{if(_0x1247e2[0x0][_0x59e1ff(0x1d8)]==_0x59e1ff(0x1cf))var _0xade9f6=users[_0x59e1ff(0x1cf)];else{if(_0x1247e2[0x0][_0x59e1ff(0x1d8)]==_0x59e1ff(0x198))var _0xade9f6=users['Spanish'];else{if(_0x1247e2[0x0][_0x59e1ff(0x1d8)]==_0x59e1ff(0x1c8))var _0xade9f6=users[_0x59e1ff(0x1c8)];else{if(_0x1247e2[0x0][_0x59e1ff(0x1d8)]==_0x59e1ff(0x189))var _0xade9f6=users[_0x59e1ff(0xe0)];else{if(_0x1247e2[0x0][_0x59e1ff(0x1d8)]==_0x59e1ff(0x17d))var _0xade9f6=users[_0x59e1ff(0x17d)];else{if(_0x1247e2[0x0]['language']==_0x59e1ff(0x139))var _0xade9f6=users['Arabic'];}}}}}}}_0x4c3fcb[_0x59e1ff(0x121)](_0x59e1ff(0x11d),{'success':_0x4badcc[_0x59e1ff(0xde)](_0x59e1ff(0x1f6)),'errors':_0x4badcc[_0x59e1ff(0xde)]('errors'),'sales':_0x234676,'profile':_0x1ff7f7,'role':_0x96b7bb,'master_shop':_0x1247e2,'language':_0xade9f6});}catch(_0x214f48){console[_0x59e1ff(0xf5)](_0x214f48);}});async function getRandom8DigitNumber(){var _0x5231fb=a0_0x234545;const _0x33d1e0=0x989680,_0x1b9416=0x5f5e0ff,_0x5b0ebd=Math['floor'](Math[_0x5231fb(0x1e0)]()*(_0x1b9416-_0x33d1e0+0x1))+_0x33d1e0;var _0x34f737;const _0x19fe5f=await sales_finished[_0x5231fb(0xe5)]({'invoice':_0x5231fb(0x18a)+_0x5b0ebd});return _0x19fe5f&&_0x19fe5f[_0x5231fb(0x142)]>0x0?_0x34f737=_0x5231fb(0x18a)+_0x5b0ebd:_0x34f737=_0x5231fb(0x18a)+_0x5b0ebd,_0x34f737;}router[a0_0x234545(0x18b)]('/view/add_sales',auth,async(_0x337935,_0x59d8b1)=>{var _0x614fea=a0_0x234545;try{const {username:_0x801f45,email:_0x427b0e,role:_0x1cf745}=_0x337935[_0x614fea(0x149)],_0xfc729b=_0x337935[_0x614fea(0x149)],_0x51e2b8=await profile['findOne']({'email':_0xfc729b[_0x614fea(0x170)]}),_0x1c02b6=await master_shop[_0x614fea(0x1b4)](),_0x4f69b1=await customer[_0x614fea(0x1b4)]({});let _0xd40b4e;if(_0xfc729b[_0x614fea(0x134)]==_0x614fea(0x177)){const _0x3a84f3=await staff[_0x614fea(0xe5)]({'email':_0xfc729b[_0x614fea(0x170)]});_0xd40b4e=await warehouse[_0x614fea(0x16f)]([{'$match':{'status':_0x614fea(0x1c3),'name':_0x3a84f3[_0x614fea(0x10c)]}},{'$group':{'_id':_0x614fea(0x1bd),'name':{'$first':_0x614fea(0x1bd)}}},{'$sort':{'name':0x1}}]);}else _0xd40b4e=await warehouse[_0x614fea(0x16f)]([{'$match':{'status':_0x614fea(0x1c3)}},{'$group':{'_id':_0x614fea(0x1bd),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x4693ee=await product[_0x614fea(0x1b4)]({});var _0x10be96=[_0x614fea(0xe4),_0x614fea(0x1ef)];const _0x1c288c=await sales_finished[_0x614fea(0x1b4)]({}),_0x1b3d23=_0x1c288c[_0x614fea(0x142)]+0x1,_0x7a82fb=_0x614fea(0x18a)+_0x1b3d23[_0x614fea(0x119)]()[_0x614fea(0x1ee)](0x5,'0');if(_0x1c02b6[0x0][_0x614fea(0x1d8)]==_0x614fea(0x1af)){var _0xbbc727=users[_0x614fea(0x1d3)];console[_0x614fea(0xf5)](_0xbbc727);}else{if(_0x1c02b6[0x0][_0x614fea(0x1d8)]=='Hindi')var _0xbbc727=users[_0x614fea(0x114)];else{if(_0x1c02b6[0x0][_0x614fea(0x1d8)]=='German')var _0xbbc727=users['German'];else{if(_0x1c02b6[0x0][_0x614fea(0x1d8)]==_0x614fea(0x198))var _0xbbc727=users[_0x614fea(0x198)];else{if(_0x1c02b6[0x0][_0x614fea(0x1d8)]==_0x614fea(0x1c8))var _0xbbc727=users[_0x614fea(0x1c8)];else{if(_0x1c02b6[0x0][_0x614fea(0x1d8)]==_0x614fea(0x189))var _0xbbc727=users[_0x614fea(0xe0)];else{if(_0x1c02b6[0x0][_0x614fea(0x1d8)]==_0x614fea(0x17d))var _0xbbc727=users[_0x614fea(0x17d)];else{if(_0x1c02b6[0x0][_0x614fea(0x1d8)]==_0x614fea(0x139))var _0xbbc727=users[_0x614fea(0x146)];}}}}}}}const _0x2f0a68=getRandom8DigitNumber();_0x2f0a68[_0x614fea(0xfe)](_0x16779c=>{var _0x10bd2c=_0x614fea;_0x59d8b1[_0x10bd2c(0x121)]('add_sales_finished',{'success':_0x337935['flash'](_0x10bd2c(0x1f6)),'errors':_0x337935[_0x10bd2c(0xde)](_0x10bd2c(0x157)),'role':_0xfc729b,'profile':_0x51e2b8,'customer':_0x4f69b1,'warehouse':_0xd40b4e,'product':_0x4693ee,'invoice':_0x16779c,'master_shop':_0x1c02b6,'language':_0xbbc727,'rooms_data':_0x10be96});})['catch'](_0x32f359=>{var _0x5d011f=_0x614fea;_0x337935[_0x5d011f(0xde)]('errors',_0x5d011f(0x1a2)),_0x59d8b1['redirect']('/all_sales_finished/view');});}catch(_0xc191c5){console['log'](_0xc191c5);}}),router['get']('/view/add_sales_logs',auth,async(_0x367dc5,_0x76adbf)=>{var _0x29ca96=a0_0x234545;try{const {username:_0x1b1dba,email:_0x203fac,role:_0x57c57e}=_0x367dc5[_0x29ca96(0x149)],_0xbc7c12=_0x367dc5[_0x29ca96(0x149)],_0x2cdef9=await profile['findOne']({'email':_0xbc7c12[_0x29ca96(0x170)]}),_0x54a5fe=await master_shop[_0x29ca96(0x1b4)](),_0xd59da=await customer['find']({});let _0xfcc403;if(_0xbc7c12[_0x29ca96(0x134)]=='staff'){const _0x50df21=await staff[_0x29ca96(0xe5)]({'email':_0xbc7c12['email']});_0xfcc403=await warehouse[_0x29ca96(0x16f)]([{'$match':{'status':_0x29ca96(0x1c3),'name':_0x50df21['warehouse']}},{'$group':{'_id':_0x29ca96(0x1bd),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0xfcc403=await warehouse[_0x29ca96(0x16f)]([{'$match':{'status':_0x29ca96(0x1c3)}},{'$group':{'_id':_0x29ca96(0x1bd),'name':{'$first':_0x29ca96(0x1bd)}}},{'$sort':{'name':0x1}}]);const _0x5c32cc=await product['find']({});var _0x408d2a=[_0x29ca96(0xe4),_0x29ca96(0x1ef)];const _0x2181ae=await sales_finished[_0x29ca96(0x1b4)]({}),_0x523771=_0x2181ae[_0x29ca96(0x142)]+0x1,_0x4c8fe4=_0x29ca96(0x18a)+_0x523771['toString']()[_0x29ca96(0x1ee)](0x5,'0');if(_0x54a5fe[0x0][_0x29ca96(0x1d8)]==_0x29ca96(0x1af)){var _0x178771=users[_0x29ca96(0x1d3)];console['log'](_0x178771);}else{if(_0x54a5fe[0x0][_0x29ca96(0x1d8)]==_0x29ca96(0x114))var _0x178771=users[_0x29ca96(0x114)];else{if(_0x54a5fe[0x0][_0x29ca96(0x1d8)]==_0x29ca96(0x1cf))var _0x178771=users[_0x29ca96(0x1cf)];else{if(_0x54a5fe[0x0]['language']==_0x29ca96(0x198))var _0x178771=users[_0x29ca96(0x198)];else{if(_0x54a5fe[0x0][_0x29ca96(0x1d8)]=='French')var _0x178771=users[_0x29ca96(0x1c8)];else{if(_0x54a5fe[0x0][_0x29ca96(0x1d8)]==_0x29ca96(0x189))var _0x178771=users[_0x29ca96(0xe0)];else{if(_0x54a5fe[0x0][_0x29ca96(0x1d8)]=='Chinese')var _0x178771=users[_0x29ca96(0x17d)];else{if(_0x54a5fe[0x0][_0x29ca96(0x1d8)]==_0x29ca96(0x139))var _0x178771=users[_0x29ca96(0x146)];}}}}}}}const _0x2332a4=getRandom8DigitNumber();_0x2332a4[_0x29ca96(0xfe)](_0x3c3db9=>{var _0x352981=_0x29ca96;_0x76adbf[_0x352981(0x121)](_0x352981(0x1a5),{'success':_0x367dc5['flash']('success'),'errors':_0x367dc5[_0x352981(0xde)](_0x352981(0x157)),'role':_0xbc7c12,'profile':_0x2cdef9,'customer':_0xd59da,'warehouse':_0xfcc403,'product':_0x5c32cc,'invoice':_0x3c3db9,'master_shop':_0x54a5fe,'language':_0x178771,'rooms_data':_0x408d2a});})[_0x29ca96(0xcc)](_0x4aa0ea=>{var _0x2cba50=_0x29ca96;_0x367dc5['flash'](_0x2cba50(0x157),_0x2cba50(0x1a2)),_0x76adbf['redirect'](_0x2cba50(0xce));});}catch(_0x1550cf){console[_0x29ca96(0xf5)](_0x1550cf);}}),router['post'](a0_0x234545(0x18e),auth,async(_0x142e6d,_0x4a9973)=>{var _0x1c8624=a0_0x234545;try{const {invoice:_0x4bacbf,date:_0x1514e0,warehouse_name:_0x8a9af4,product_name:_0x220fa0,note:_0xaf729c,room:_0x32d51a,primary_code:_0x4ff1db,secondary_code:_0x398257,prod_code:_0x481ef0,SCRN:_0x5941b3,ReqBy:_0x253f87,dateofreq:_0x205411,PO_number:_0xa6db8b,typeservicesData:_0x2c4226,typevehicle:_0x55b3eb,destination:_0x53da32,deliverydate:_0x1d2dae,driver:_0x44dacb,plate:_0x2fe7b5,van:_0x5c63fd,DRSI:_0x4b8bf4,TSU:_0x33c0b7,TFU:_0x3de229,mode_transpo:_0x134234,name_driver:_0x44626c,type_of_products:_0x23fdff}=_0x142e6d[_0x1c8624(0xb8)];if(typeof _0x220fa0==_0x1c8624(0x11b))var _0x540d01=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0xc7)]],_0x1348d4=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x102)]],_0x508bf2=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x13f)]],_0x8d2c89=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0xba)]],_0x2d7b1a=[_0x142e6d['body'][_0x1c8624(0x1c6)]],_0x28ce8a=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x17f)]],_0x521dcf=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x112)]],_0x3f66e2=[_0x142e6d['body'][_0x1c8624(0xc6)]],_0x512f77=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x1f3)]],_0x52d069=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x1dc)]],_0x2b36bc=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0xec)]],_0x20a1f0=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x15e)]],_0x13b7a5=[_0x142e6d[_0x1c8624(0xb8)]['max_per_unit']],_0x33b033=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x12d)]],_0xc5903e=[_0x142e6d['body'][_0x1c8624(0x154)]],_0x5783b9=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0xbe)]],_0x3ed0f0=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x1ae)]],_0x353163=[_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0xd5)]],_0x342e4a=[_0x142e6d[_0x1c8624(0xb8)]['gross_price']];else var _0x540d01=[..._0x142e6d['body'][_0x1c8624(0xc7)]],_0x1348d4=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x102)]],_0x508bf2=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x13f)]],_0x8d2c89=[..._0x142e6d['body'][_0x1c8624(0xba)]],_0x2d7b1a=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x1c6)]],_0x28ce8a=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x17f)]],_0x521dcf=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x112)]],_0x3f66e2=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0xc6)]],_0x512f77=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x1f3)]],_0x52d069=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x1dc)]],_0x2b36bc=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0xec)]],_0x20a1f0=[..._0x142e6d['body'][_0x1c8624(0x15e)]],_0x13b7a5=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x13a)]],_0x33b033=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x12d)]],_0xc5903e=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x154)]],_0x5783b9=[..._0x142e6d[_0x1c8624(0xb8)]['prod_invoice']],_0x3ed0f0=[..._0x142e6d[_0x1c8624(0xb8)]['id_transaction_from']],_0x353163=[..._0x142e6d[_0x1c8624(0xb8)]['uuid']],_0x342e4a=[..._0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x10b)]];const _0x29a5e9=_0x540d01['map'](_0x53e703=>{return _0x53e703={'product_name':_0x53e703};});_0x1348d4[_0x1c8624(0xc3)]((_0x312271,_0x42f168)=>{var _0x4c9d75=_0x1c8624;_0x29a5e9[_0x42f168][_0x4c9d75(0x102)]=_0x312271;}),_0x508bf2['forEach']((_0x2d2c30,_0xd9b1)=>{var _0x254025=_0x1c8624;_0x29a5e9[_0xd9b1][_0x254025(0xd7)]=Math[_0x254025(0x17c)](_0x2d2c30);}),_0x540d01['forEach']((_0xf8c5e8,_0x790f0d)=>{var _0x2ff761=_0x1c8624;_0x29a5e9[_0x790f0d]['agent_id']=_0x142e6d[_0x2ff761(0xb8)][_0x2ff761(0x185)];}),_0x342e4a[_0x1c8624(0xc3)]((_0x5eccf5,_0x1828f8)=>{var _0x583356=_0x1c8624;_0x29a5e9[_0x1828f8][_0x583356(0x10b)]=_0x5eccf5;}),_0x353163[_0x1c8624(0xc3)]((_0x554be9,_0x3cf77b)=>{var _0x362b9d=_0x1c8624;_0x29a5e9[_0x3cf77b][_0x362b9d(0xd5)]=_0x554be9;}),_0x3ed0f0[_0x1c8624(0xc3)]((_0xa61910,_0x2ce3da)=>{var _0x26de91=_0x1c8624;_0x29a5e9[_0x2ce3da][_0x26de91(0x1ae)]=_0xa61910;}),_0x8d2c89['forEach']((_0x4b6cc8,_0x3e0ec4)=>{var _0x4f992e=_0x1c8624;_0x29a5e9[_0x3e0ec4][_0x4f992e(0xba)]=_0x4b6cc8;}),_0x2d7b1a['forEach']((_0x4ebf4e,_0x3541a3)=>{var _0x1ef147=_0x1c8624;_0x29a5e9[_0x3541a3][_0x1ef147(0x1c6)]=_0x4ebf4e;}),_0x28ce8a[_0x1c8624(0xc3)]((_0x389a8d,_0x419659)=>{var _0x1c982f=_0x1c8624;_0x29a5e9[_0x419659][_0x1c982f(0x1c2)]=_0x389a8d;}),_0x521dcf[_0x1c8624(0xc3)]((_0x542add,_0x40eac5)=>{var _0x57b7cb=_0x1c8624,_0x1b6743=_0x542add['match'](/[A-Za-z]+/)[0x0],_0x4b66b6=parseInt(_0x542add[_0x57b7cb(0x1f1)](/\d+/)[0x0]);_0x29a5e9[_0x40eac5]['bay']=_0x4b66b6,_0x29a5e9[_0x40eac5][_0x57b7cb(0x15a)]=_0x1b6743;}),_0x3f66e2[_0x1c8624(0xc3)]((_0x412a3f,_0x29f162)=>{var _0x356a1c=_0x1c8624;_0x29a5e9[_0x29f162][_0x356a1c(0x1ca)]=_0x412a3f;}),_0x512f77[_0x1c8624(0xc3)]((_0x309981,_0x2756b2)=>{var _0x3ea43c=_0x1c8624;_0x29a5e9[_0x2756b2][_0x3ea43c(0x1f3)]=_0x309981;}),_0x52d069[_0x1c8624(0xc3)]((_0x598382,_0x318f34)=>{var _0x2bb8dd=_0x1c8624;_0x29a5e9[_0x318f34][_0x2bb8dd(0x1dc)]=_0x598382;}),_0x2b36bc[_0x1c8624(0xc3)]((_0x35ce32,_0x457798)=>{var _0xd247b5=_0x1c8624;_0x29a5e9[_0x457798][_0xd247b5(0xec)]=_0x35ce32;}),_0x20a1f0['forEach']((_0x423670,_0x182e01)=>{var _0x91bf50=_0x1c8624;_0x29a5e9[_0x182e01][_0x91bf50(0x13e)]=_0x423670;}),_0x13b7a5['forEach']((_0x2b3769,_0x315658)=>{var _0x1df38f=_0x1c8624;_0x29a5e9[_0x315658][_0x1df38f(0xd6)]=_0x2b3769;}),_0x33b033[_0x1c8624(0xc3)]((_0x12f799,_0x47bd26)=>{var _0x29b2e3=_0x1c8624;_0x29a5e9[_0x47bd26][_0x29b2e3(0x12d)]=_0x12f799;}),_0xc5903e[_0x1c8624(0xc3)]((_0x442fba,_0x22b73a)=>{_0x29a5e9[_0x22b73a]['room_name']=_0x442fba;}),_0x5783b9[_0x1c8624(0xc3)]((_0x66688b,_0x49c4bb)=>{_0x29a5e9[_0x49c4bb]['invoice']=_0x66688b,_0x29a5e9[_0x49c4bb]['date_data']=_0x1514e0;});const _0x4d0603=new sales_logs();await _0x4d0603[_0x1c8624(0xdc)](),_0x5783b9[_0x1c8624(0xc3)]((_0x53e4ab,_0x2b52b2)=>{var _0x57455a=_0x1c8624;_0x29a5e9[_0x2b52b2][_0x57455a(0x109)]=_0x57455a(0xf4)+_0x4d0603['invoice_init'][_0x57455a(0x119)]()[_0x57455a(0x1ee)](0x8,'0');});var _0x169b11=0x0;_0x29a5e9['forEach'](_0x56ae3d=>{var _0x3d6828=_0x1c8624;parseFloat(_0x56ae3d[_0x3d6828(0x102)])<parseFloat(_0x56ae3d[_0x3d6828(0xd7)])&&parseFloat(_0x56ae3d[_0x3d6828(0xd7)])>parseFloat(_0x56ae3d[_0x3d6828(0x102)])&&(console[_0x3d6828(0xf5)](_0x56ae3d[_0x3d6828(0x102)]+_0x3d6828(0x1bb)+_0x56ae3d[_0x3d6828(0xd7)]),_0x169b11++);});if(_0x169b11!=0x0)return _0x142e6d[_0x1c8624(0xde)](_0x1c8624(0x157),_0x1c8624(0xee)),_0x4a9973[_0x1c8624(0x125)](_0x1c8624(0xc4));const _0x2b61b3=_0x29a5e9[_0x1c8624(0x172)](_0x9b1286=>_0x9b1286[_0x1c8624(0xd7)]!=='0'&&_0x9b1286[_0x1c8624(0xd7)]!==''),_0x466837=new sales_finished({'invoice':_0x1c8624(0xf4)+_0x4d0603[_0x1c8624(0x1ed)]['toString']()['padStart'](0x8,'0'),'sales_data':_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x185)],'customer':_0x142e6d[_0x1c8624(0xb8)][_0x1c8624(0x1a7)],'date':_0x1514e0,'warehouse_name':_0x8a9af4,'sale_product':_0x2b61b3,'note':_0xaf729c,'room':_0x32d51a,'primary_code':_0x4ff1db,'secondary_code':_0x398257,'prod_code':_0x481ef0,'SCRN':_0x5941b3,'finalize':'False','mode_transpo':_0x134234,'name_driver':_0x44626c,'ReqBy':_0x253f87,'dateofreq':_0x205411,'PO_number':_0xa6db8b,'typeservicesData':_0x2c4226,'typevehicle':_0x55b3eb,'destination':_0x53da32,'deliverydate':_0x1d2dae,'driver':_0x44dacb,'plate':_0x2fe7b5,'van':_0x5c63fd,'DRSI':_0x4b8bf4,'TSU':_0x33c0b7,'TFU':_0x3de229,'typeOfProducts':_0x23fdff}),_0xf2018d=await _0x466837[_0x1c8624(0xdc)](),_0x34ae30=await sales_finished[_0x1c8624(0xe5)]({'invoice':_0x4bacbf});_0x142e6d['flash'](_0x1c8624(0x1f6),_0x1c8624(0x140)),_0x4a9973[_0x1c8624(0x125)](_0x1c8624(0x128)+_0xf2018d[_0x1c8624(0x1b9)]);}catch(_0x4258d9){console[_0x1c8624(0xf5)](_0x4258d9);}}),router[a0_0x234545(0x18b)](a0_0x234545(0x108),auth,async(_0x6ce3cf,_0x557039)=>{var _0x34b32b=a0_0x234545;try{const _0x5bd42b=_0x6ce3cf[_0x34b32b(0x120)]['id'];console['log'](_0x5bd42b);const _0xfeead3=await product['find'](),_0x37ebe8=await purchases['aggregate']([{'$match':{'warehouse_name':_0x5bd42b}},{'$unwind':_0x34b32b(0xf9)},{'$group':{'_id':'$product.product_name'}}]);console[_0x34b32b(0xf5)]('purchases_data',_0x37ebe8),_0x557039[_0x34b32b(0xbc)](0xc8)['json']({'purchases_data':_0x37ebe8,'product_data':_0xfeead3});}catch(_0x388314){console[_0x34b32b(0xf5)](_0x388314);}}),router[a0_0x234545(0x1e2)](a0_0x234545(0x1e1),auth,async(_0x390157,_0xe53ea0)=>{var _0x4f3469=a0_0x234545;try{const {warehouse_data:_0x582347,product_data:_0x5961aa}=_0x390157[_0x4f3469(0xb8)];console[_0x4f3469(0xf5)](_0x390157[_0x4f3469(0xb8)][_0x4f3469(0xc5)]);;const _0x3febfa=await master_shop[_0x4f3469(0x1b4)]();console[_0x4f3469(0xf5)](_0x4f3469(0x1c5),_0x3febfa);const _0x3e28a0=await product['findOne']({'name':_0x5961aa});console[_0x4f3469(0xf5)](_0x4f3469(0xc1),_0x3e28a0);const _0x5253e9=await warehouse[_0x4f3469(0x16f)]([{'$match':{'name':_0x582347}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x5961aa}},{'$group':{'_id':_0x4f3469(0xbf),'product_stock':{'$first':_0x4f3469(0x181)}}}]);console['log'](_0x4f3469(0x15f),_0x5253e9),_0xe53ea0[_0x4f3469(0xbc)](0xc8)[_0x4f3469(0x1f4)]({'master':_0x3febfa,'new_product':_0x3e28a0,'stock_data':_0x5253e9});}catch(_0x3cb26a){console[_0x4f3469(0xf5)](_0x3cb26a);}}),router[a0_0x234545(0x1e2)](a0_0x234545(0xf8),auth,async(_0xc4d5d3,_0xaecc58)=>{var _0x4545f3=a0_0x234545;try{const {invoice:_0x1ac7b3,date:_0x5311bd,warehouse_name:_0x462e09,product_name:_0x2446be,note:_0x366f1f,room:_0x3af216,primary_code:_0x22cd2b,secondary_code:_0x452956,prod_code:_0x27255b,SCRN:_0x38f832,ReqBy:_0x36bec9,dateofreq:_0x43a663,PO_number:_0x341b50,typeservicesData:_0x4d9183,typevehicle:_0x5deafd,destination:_0x189aff,deliverydate:_0x5b440b,driver:_0xc64ca9,plate:_0x2698ae,van:_0x3d994d,DRSI:_0x10bcfe,TSU:_0x2ce158,TFU:_0x1065dd,mode_transpo:_0x27c28b,name_driver:_0x397e0d,pull_out_date:_0x83a25c,actual_delivery_date:_0x43573d}=_0xc4d5d3[_0x4545f3(0xb8)];_0xaecc58['json'](_0xc4d5d3[_0x4545f3(0xb8)]);return;if(typeof _0x2446be==_0x4545f3(0x11b))var _0x2339ab=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0xc7)]],_0x2d7a5e=[_0xc4d5d3['body'][_0x4545f3(0x102)]],_0x4823da=[_0xc4d5d3['body']['carton']],_0x28dc69=[_0xc4d5d3['body']['primary_code']],_0x2150f4=[_0xc4d5d3[_0x4545f3(0xb8)]['secondary_code']],_0x4bb1c2=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x17f)]],_0x4e7741=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x112)]],_0x55d229=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0xc6)]],_0x3a959d=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x1f3)]],_0xa1cfb8=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x1dc)]],_0x19416b=[_0xc4d5d3['body'][_0x4545f3(0xec)]],_0x11c53f=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x15e)]],_0x41e06c=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x13a)]],_0x480add=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x12d)]],_0x322fa9=[_0xc4d5d3[_0x4545f3(0xb8)]['RoomAssigned']],_0x1688ca=[_0xc4d5d3[_0x4545f3(0xb8)]['prod_invoice']],_0x1101e6=[_0xc4d5d3[_0x4545f3(0xb8)]['id_transaction_from']],_0xd0b98a=[_0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0xd5)]],_0xeaf347=[_0xc4d5d3[_0x4545f3(0xb8)]['gross_price']];else var _0x2339ab=[..._0xc4d5d3['body'][_0x4545f3(0xc7)]],_0x2d7a5e=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x102)]],_0x4823da=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x13f)]],_0x28dc69=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0xba)]],_0x2150f4=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x1c6)]],_0x4bb1c2=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x17f)]],_0x4e7741=[..._0xc4d5d3['body'][_0x4545f3(0x112)]],_0x55d229=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0xc6)]],_0x3a959d=[..._0xc4d5d3['body']['secondary_unit']],_0xa1cfb8=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x1dc)]],_0x19416b=[..._0xc4d5d3['body']['expiry_date']],_0x11c53f=[..._0xc4d5d3[_0x4545f3(0xb8)]['product_date']],_0x41e06c=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x13a)]],_0x480add=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x12d)]],_0x322fa9=[..._0xc4d5d3[_0x4545f3(0xb8)]['RoomAssigned']],_0x1688ca=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0xbe)]],_0x1101e6=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x1ae)]],_0xd0b98a=[..._0xc4d5d3[_0x4545f3(0xb8)]['uuid']],_0xeaf347=[..._0xc4d5d3[_0x4545f3(0xb8)][_0x4545f3(0x10b)]];const _0x58d3d6=_0x2339ab[_0x4545f3(0x136)](_0x567a3f=>{return _0x567a3f={'product_name':_0x567a3f};});_0x2d7a5e[_0x4545f3(0xc3)]((_0x1227ca,_0x503c45)=>{var _0x2410fa=_0x4545f3;_0x58d3d6[_0x503c45][_0x2410fa(0x102)]=_0x1227ca;}),_0x4823da['forEach']((_0x938cef,_0x6bd0ea)=>{var _0x16e2e2=_0x4545f3;_0x58d3d6[_0x6bd0ea][_0x16e2e2(0xd7)]=Math[_0x16e2e2(0x17c)](_0x938cef);}),_0x2339ab['forEach']((_0x1fe34c,_0x4fb19f)=>{var _0x2fff07=_0x4545f3;_0x58d3d6[_0x4fb19f]['agent_id']=_0xc4d5d3[_0x2fff07(0xb8)][_0x2fff07(0x185)];}),_0xeaf347[_0x4545f3(0xc3)]((_0x4c099d,_0x10a105)=>{var _0x278bee=_0x4545f3;_0x58d3d6[_0x10a105][_0x278bee(0x10b)]=_0x4c099d;}),_0xd0b98a['forEach']((_0x55904f,_0x43b09e)=>{_0x58d3d6[_0x43b09e]['uuid']=_0x55904f;}),_0x1101e6['forEach']((_0x1c8275,_0x30bd7b)=>{var _0x585d62=_0x4545f3;_0x58d3d6[_0x30bd7b][_0x585d62(0x1ae)]=_0x1c8275;}),_0x28dc69[_0x4545f3(0xc3)]((_0x36bc3e,_0x4ccb60)=>{var _0x59e69a=_0x4545f3;_0x58d3d6[_0x4ccb60][_0x59e69a(0xba)]=_0x36bc3e;}),_0x2150f4[_0x4545f3(0xc3)]((_0x1838e3,_0x398096)=>{_0x58d3d6[_0x398096]['secondary_code']=_0x1838e3;}),_0x4bb1c2[_0x4545f3(0xc3)]((_0x1e2b1d,_0x1386ab)=>{var _0x151c28=_0x4545f3;_0x58d3d6[_0x1386ab][_0x151c28(0x1c2)]=_0x1e2b1d;}),_0x4e7741[_0x4545f3(0xc3)]((_0x443824,_0x5dfc23)=>{var _0x4c6747=_0x4545f3,_0x2c7be4=_0x443824[_0x4c6747(0x1f1)](/[A-Za-z]+/)[0x0],_0x43a3f6=parseInt(_0x443824[_0x4c6747(0x1f1)](/\d+/)[0x0]);_0x58d3d6[_0x5dfc23][_0x4c6747(0x122)]=_0x43a3f6,_0x58d3d6[_0x5dfc23]['level']=_0x2c7be4;}),_0x55d229[_0x4545f3(0xc3)]((_0x155fac,_0x317d53)=>{var _0x3c908e=_0x4545f3;_0x58d3d6[_0x317d53][_0x3c908e(0x1ca)]=_0x155fac;}),_0x3a959d[_0x4545f3(0xc3)]((_0x595a79,_0xc49000)=>{var _0x2ef36b=_0x4545f3;_0x58d3d6[_0xc49000][_0x2ef36b(0x1f3)]=_0x595a79;}),_0xa1cfb8[_0x4545f3(0xc3)]((_0x5c7223,_0x2aac42)=>{var _0x5df4d6=_0x4545f3;_0x58d3d6[_0x2aac42][_0x5df4d6(0x1dc)]=_0x5c7223;}),_0x19416b[_0x4545f3(0xc3)]((_0x47f1f4,_0x51e5e2)=>{var _0x1995f6=_0x4545f3;_0x58d3d6[_0x51e5e2][_0x1995f6(0xec)]=_0x47f1f4;}),_0x11c53f[_0x4545f3(0xc3)]((_0xd4cf03,_0x58ff93)=>{var _0x1a88aa=_0x4545f3;_0x58d3d6[_0x58ff93][_0x1a88aa(0x13e)]=_0xd4cf03;}),_0x41e06c[_0x4545f3(0xc3)]((_0x27ae11,_0x20ffd2)=>{var _0xca75a5=_0x4545f3;_0x58d3d6[_0x20ffd2][_0xca75a5(0xd6)]=_0x27ae11;}),_0x480add[_0x4545f3(0xc3)]((_0x124401,_0x2cf5ac)=>{var _0x26f895=_0x4545f3;_0x58d3d6[_0x2cf5ac][_0x26f895(0x12d)]=_0x124401;}),_0x322fa9[_0x4545f3(0xc3)]((_0x59d77e,_0x2919c1)=>{_0x58d3d6[_0x2919c1]['room_name']=_0x59d77e;}),_0x1688ca[_0x4545f3(0xc3)]((_0x43fa50,_0x4a8e45)=>{var _0x4a5553=_0x4545f3;_0x58d3d6[_0x4a8e45][_0x4a5553(0x19d)]=_0x43fa50,_0x58d3d6[_0x4a8e45][_0x4a5553(0x13b)]=_0x5311bd;});const _0x454cfc=new invoice_for_outgoing();await _0x454cfc['save'](),_0x1688ca['forEach']((_0x3076ef,_0x3c188a)=>{var _0x590885=_0x4545f3;_0x58d3d6[_0x3c188a][_0x590885(0x109)]=_0x590885(0x1f5)+_0x454cfc[_0x590885(0x1ed)][_0x590885(0x119)]()['padStart'](0x8,'0');});var _0x275db0=0x0;_0x58d3d6[_0x4545f3(0xc3)](_0x232689=>{var _0x4aa813=_0x4545f3;parseFloat(_0x232689[_0x4aa813(0x102)])<parseFloat(_0x232689[_0x4aa813(0xd7)])&&parseFloat(_0x232689[_0x4aa813(0xd7)])>parseFloat(_0x232689['stock'])&&(console['log'](_0x232689[_0x4aa813(0x102)]+_0x4aa813(0x1bb)+_0x232689[_0x4aa813(0xd7)]),_0x275db0++);});if(_0x275db0!=0x0)return _0xc4d5d3[_0x4545f3(0xde)]('errors',_0x4545f3(0xee)),_0xaecc58[_0x4545f3(0x125)](_0x4545f3(0xc4));const _0x1d1f78=_0x58d3d6[_0x4545f3(0x172)](_0x4b1953=>_0x4b1953['quantity']!=='0'&&_0x4b1953[_0x4545f3(0xd7)]!==''),_0x520acc=new sales_finished({'invoice':_0x4545f3(0x1f5)+_0x454cfc[_0x4545f3(0x1ed)][_0x4545f3(0x119)]()[_0x4545f3(0x1ee)](0x8,'0'),'sales_data':_0xc4d5d3[_0x4545f3(0xb8)]['sales'],'customer':_0xc4d5d3[_0x4545f3(0xb8)]['customer'],'date':_0x5311bd,'warehouse_name':_0x462e09,'sale_product':_0x1d1f78,'note':_0x366f1f,'room':_0x3af216,'primary_code':_0x22cd2b,'secondary_code':_0x452956,'prod_code':_0x27255b,'SCRN':_0x38f832,'finalize':_0x4545f3(0x18d),'mode_transpo':_0x27c28b,'name_driver':_0x397e0d,'ReqBy':_0x36bec9,'dateofreq':_0x43a663,'PO_number':_0x341b50,'typeservicesData':_0x4d9183,'typevehicle':_0x5deafd,'destination':_0x189aff,'deliverydate':_0x5b440b,'driver':_0xc64ca9,'plate':_0x2698ae,'van':_0x3d994d,'DRSI':_0x10bcfe,'TSU':_0x2ce158,'TFU':_0x1065dd,'pullout_date':_0x83a25c,'actualdelivery_date':_0x43573d,'typeOfProducts':_0x4545f3(0x15d)}),_0x1f3277=await _0x520acc['save'](),_0x4bbe8b=await sales_finished[_0x4545f3(0xe5)]({'invoice':_0x1ac7b3});_0xc4d5d3[_0x4545f3(0xde)](_0x4545f3(0x1f6),'Sales\x20Add\x20successfully'),_0xaecc58[_0x4545f3(0x125)]('/all_sales_finished/preview/'+_0x1f3277[_0x4545f3(0x1b9)]);}catch(_0x240991){console[_0x4545f3(0xf5)](_0x240991);}}),router[a0_0x234545(0x18b)](a0_0x234545(0x1ad),auth,async(_0x45e3e1,_0x3123d2)=>{var _0x1c2c15=a0_0x234545;try{const {username:_0x4de227,email:_0x26fb07,role:_0x57b583}=_0x45e3e1[_0x1c2c15(0x149)],_0x1f7ac1=_0x45e3e1['user'],_0x1fa690=await profile[_0x1c2c15(0xe5)]({'email':_0x1f7ac1['email']}),_0x3eef77=await master_shop[_0x1c2c15(0x1b4)](),_0x26c0f0=_0x45e3e1[_0x1c2c15(0x120)]['id'],_0x5f559c=await sales_finished['findById'](_0x26c0f0),_0x538bb1=await warehouse[_0x1c2c15(0x16f)]([{'$match':{'name':_0x5f559c['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1c2c15(0x1b5),'name':{'$first':_0x1c2c15(0xbf)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1c2c15(0xb9)},'bin':{'$first':_0x1c2c15(0x129)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1c2c15(0xfd)},'primary_code':{'$first':_0x1c2c15(0x160)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1c2c15(0x1c9)},'storage':{'$first':_0x1c2c15(0x1df)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1c2c15(0xda)},'production_date':{'$first':_0x1c2c15(0x14b)},'batch_code':{'$first':_0x1c2c15(0x175)},'room':{'$first':_0x1c2c15(0x159)},'room_data':{'$first':_0x1c2c15(0xef)}}}]),_0x11dcf7=await customer['find']({});let _0x5956bd;if(_0x1f7ac1[_0x1c2c15(0x134)]=='staff'){const _0x3c5252=await staff['findOne']({'email':_0x1f7ac1[_0x1c2c15(0x170)]});_0x5956bd=await warehouse[_0x1c2c15(0x16f)]([{'$match':{'status':_0x1c2c15(0x1c3),'name':_0x3c5252[_0x1c2c15(0x10c)]}},{'$group':{'_id':_0x1c2c15(0x1bd),'name':{'$first':_0x1c2c15(0x1bd)}}}]);}else _0x5956bd=await warehouse[_0x1c2c15(0x16f)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x1c2c15(0x1bd),'name':{'$first':'$name'}}}]);const _0x270a32=await product[_0x1c2c15(0x1b4)]({});if(_0x3eef77[0x0][_0x1c2c15(0x1d8)]==_0x1c2c15(0x1af)){var _0x564c11=users['English'];console['log'](_0x564c11);}else{if(_0x3eef77[0x0][_0x1c2c15(0x1d8)]=='Hindi')var _0x564c11=users[_0x1c2c15(0x114)];else{if(_0x3eef77[0x0][_0x1c2c15(0x1d8)]==_0x1c2c15(0x1cf))var _0x564c11=users['German'];else{if(_0x3eef77[0x0][_0x1c2c15(0x1d8)]==_0x1c2c15(0x198))var _0x564c11=users[_0x1c2c15(0x198)];else{if(_0x3eef77[0x0][_0x1c2c15(0x1d8)]==_0x1c2c15(0x1c8))var _0x564c11=users['French'];else{if(_0x3eef77[0x0][_0x1c2c15(0x1d8)]==_0x1c2c15(0x189))var _0x564c11=users[_0x1c2c15(0xe0)];else{if(_0x3eef77[0x0][_0x1c2c15(0x1d8)]==_0x1c2c15(0x17d))var _0x564c11=users[_0x1c2c15(0x17d)];else{if(_0x3eef77[0x0][_0x1c2c15(0x1d8)]==_0x1c2c15(0x139))var _0x564c11=users[_0x1c2c15(0x146)];}}}}}}}_0x3123d2[_0x1c2c15(0x121)](_0x1c2c15(0x193),{'success':_0x45e3e1[_0x1c2c15(0xde)]('success'),'errors':_0x45e3e1[_0x1c2c15(0xde)](_0x1c2c15(0x157)),'role':_0x1f7ac1,'profile':_0x1fa690,'customer':_0x11dcf7,'warehouse':_0x5956bd,'product':_0x538bb1,'user':_0x5f559c,'master_shop':_0x3eef77,'unit':_0x270a32,'language':_0x564c11});}catch(_0x1c676a){console[_0x1c2c15(0xf5)](_0x1c676a);}});async function dataUpdate(_0x4049c3,_0x371424,_0x517619){var _0x5adf46=a0_0x234545;return await warehouse['updateOne']({'_id':_0x4049c3,'product_details._id':_0x371424},{'$set':{'product_details.$.product_stock':_0x517619}}),await warehouse[_0x5adf46(0x1e5)](_0x4049c3);}router[a0_0x234545(0x1e2)]('/preview/:id',auth,async(_0x17f8ef,_0x3fcddb)=>{var _0x3f8a31=a0_0x234545;try{const _0x1bb050=_0x17f8ef[_0x3f8a31(0x120)]['id'],{invoice:_0x39949c,warehouse_name:_0x2210b0,room:_0x410b64}=_0x17f8ef[_0x3f8a31(0xb8)],_0xd618dd=await sales_finished['findOne']({'invoice':_0x39949c});for(let _0x4cff89=0x0;_0x4cff89<=_0xd618dd['sale_product'][_0x3f8a31(0x142)]-0x1;_0x4cff89++){const _0x4f0387=_0xd618dd[_0x3f8a31(0x14e)][_0x4cff89];var _0x3977c4=await warehouse[_0x3f8a31(0xe5)]({'name':_0x2210b0,'room':_0x4f0387[_0x3f8a31(0x194)]}),_0x496705=0x0;for(let _0x139bb0=0x0;_0x139bb0<=_0x3977c4[_0x3f8a31(0x1b2)][_0x3f8a31(0x142)]-0x1;_0x139bb0++){const _0x3d7d32=_0x3977c4[_0x3f8a31(0x1b2)][_0x139bb0];_0x3d7d32['_id']==_0x4f0387[_0x3f8a31(0x1ae)]&&_0x3d7d32[_0x3f8a31(0xd5)]==_0x4f0387[_0x3f8a31(0xd5)]&&(_0x496705=Math[_0x3f8a31(0xdd)](0x0,Math[_0x3f8a31(0x17c)](_0x3d7d32[_0x3f8a31(0x1ab)])-Math['abs'](_0x4f0387[_0x3f8a31(0xd7)])),await warehouse['updateOne']({'_id':_0x3977c4[_0x3f8a31(0x1b9)]['valueOf'](),'product_details._id':_0x3d7d32[_0x3f8a31(0x1b9)][_0x3f8a31(0xff)](),'product_details.uuid':_0x4f0387[_0x3f8a31(0xd5)]},{'$set':{'product_details.$.product_stock':_0x496705}}));}console[_0x3f8a31(0xf5)](typeof _0x4f0387[_0x3f8a31(0x1b0)]);if(typeof _0x4f0387[_0x3f8a31(0x1b0)]!==_0x3f8a31(0xd3)){var _0x5a97e7=await staff[_0x3f8a31(0x1e5)](_0x4f0387[_0x3f8a31(0x1b0)]);console[_0x3f8a31(0xf5)](_0x3f8a31(0x1d0));var _0x199f7d=0x0;for(let _0x1ab53f=0x0;_0x1ab53f<=_0x5a97e7[_0x3f8a31(0xf0)][_0x3f8a31(0x142)]-0x1;_0x1ab53f++){const _0x3fef3c=_0x5a97e7[_0x3f8a31(0xf0)][_0x1ab53f];console[_0x3f8a31(0xf5)](_0x4f0387[_0x3f8a31(0x1ae)]+_0x3f8a31(0x115)+_0x3fef3c['warehouse_id']+_0x3f8a31(0x167)+_0x4f0387[_0x3f8a31(0x1b9)]+_0x3f8a31(0x115)+_0x4f0387[_0x3f8a31(0x1b9)]),_0x4f0387['id_transaction_from']==_0x3fef3c[_0x3f8a31(0x1ba)]&&_0x4f0387['_id']==0x1&&(_0x3fef3c[_0x3f8a31(0x1ab)]=Math[_0x3f8a31(0x17c)](_0x3fef3c[_0x3f8a31(0x1ab)])+Math['abs'](_0x4f0387[_0x3f8a31(0xd7)]),_0x199f7d++);}console[_0x3f8a31(0xf5)](_0x3f8a31(0x1f0),_0x199f7d),_0x199f7d=='0'&&(_0x5a97e7[_0x3f8a31(0xf0)]=_0x5a97e7['product_list'][_0x3f8a31(0x161)]({'product_name':_0x4f0387[_0x3f8a31(0xc7)],'product_stock':_0x4f0387['quantity'],'bay':_0x4f0387['bay'],'level':_0x4f0387[_0x3f8a31(0x15a)],'product_code':_0x4f0387[_0x3f8a31(0x1c2)],'primary_code':_0x4f0387['primary_code'],'secondary_code':_0x4f0387[_0x3f8a31(0x1c6)],'expiry_date':_0x4f0387['expiry_date'],'production_date':_0x4f0387['production_date'],'maxProducts':_0x4f0387['maxProducts'],'batch_code':_0x4f0387[_0x3f8a31(0x1dc)],'secondary_unit':_0x4f0387['secondary_unit'],'unit':_0x4f0387['unit'],'maxProducts':_0x4f0387[_0x3f8a31(0x19b)],'maxPerUnit':_0x4f0387[_0x3f8a31(0xd6)],'invoice':_0x4f0387[_0x3f8a31(0x19d)],'warehouse_id':_0x4f0387[_0x3f8a31(0x1ae)],'id_incoming':_0x4f0387[_0x3f8a31(0x1b9)],'uuid':_0x4f0387[_0x3f8a31(0xd5)],'gross_price':_0x4f0387['gross_price'],'date_incoming':_0x4f0387[_0x3f8a31(0x13b)],'outgoing_invoice':_0x4f0387[_0x3f8a31(0x109)]}),await _0x5a97e7[_0x3f8a31(0xdc)]());}}_0xd618dd[_0x3f8a31(0xd1)]=_0x3f8a31(0x133);const _0x24bf5d=await _0xd618dd[_0x3f8a31(0xdc)](),_0x2b5ff5=await master_shop['find'](),_0x5c6d1b=await email_settings[_0x3f8a31(0xe5)](),_0x531fb9=await supervisor_settings[_0x3f8a31(0x1b4)]();var _0x2be03f=_0xd618dd['sale_product'],_0x408b00='',_0xdf12ce;for(_0xdf12ce in _0x2be03f){_0x408b00+=_0x3f8a31(0x1d5)+_0x3f8a31(0xaf)+_0x2be03f[_0xdf12ce][_0x3f8a31(0xc7)]+_0x3f8a31(0x19c)+_0x3f8a31(0xaf)+_0x2be03f[_0xdf12ce][_0x3f8a31(0x1c2)]+_0x3f8a31(0x19c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2be03f[_0xdf12ce][_0x3f8a31(0xd7)]+'</td>'+_0x3f8a31(0xaf)+_0x2be03f[_0xdf12ce]['unit']+'</td>'+_0x3f8a31(0xaf)+_0x2be03f[_0xdf12ce][_0x3f8a31(0x1f3)]+_0x3f8a31(0x19c)+_0x3f8a31(0xaf)+_0xd618dd[_0x3f8a31(0x11f)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2be03f[_0xdf12ce][_0x3f8a31(0x194)]+_0x3f8a31(0x19c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2be03f[_0xdf12ce][_0x3f8a31(0x122)]+'</td>';}_0x17f8ef['flash']('success',_0x3f8a31(0x104)),_0x3fcddb[_0x3f8a31(0x125)](_0x3f8a31(0x124)+_0x1bb050);}catch(_0x419e9f){console['log'](_0x419e9f);}}),router[a0_0x234545(0x18b)](a0_0x234545(0x1de),auth,async(_0x22e976,_0x394ae9)=>{var _0x14e214=a0_0x234545;try{const {username:_0x51292e,email:_0x193653,role:_0x3b459e}=_0x22e976[_0x14e214(0x149)],_0x5cb2a6=_0x22e976[_0x14e214(0x149)],_0x17851b=await profile[_0x14e214(0xe5)]({'email':_0x5cb2a6['email']}),_0x3a4e50=await master_shop[_0x14e214(0x1b4)](),_0x58f185=_0x22e976[_0x14e214(0x120)]['id'],_0x106d54=await sales_finished[_0x14e214(0x1e5)](_0x58f185);let _0x18b4a7=new Date(_0x106d54[_0x14e214(0xec)]),_0x585e2a=('0'+_0x18b4a7[_0x14e214(0xa8)]())[_0x14e214(0x176)](-0x2),_0x3d0843=('0'+(_0x18b4a7[_0x14e214(0xdf)]()+0x1))[_0x14e214(0x176)](-0x2),_0x56b72c=_0x18b4a7[_0x14e214(0x1f2)](),_0x4f134b=_0x56b72c+'-'+_0x3d0843+'-'+_0x585e2a;var _0x380048=['Ambient',_0x14e214(0x1ef)];const _0x422eb3=await warehouse[_0x14e214(0x16f)]([{'$match':{'name':_0x106d54[_0x14e214(0x11f)],'room':_0x106d54[_0x14e214(0x1a3)]}},{'$unwind':_0x14e214(0x1bc)},{'$group':{'_id':_0x14e214(0x1b5),'name':{'$first':_0x14e214(0xbf)},'product_stock':{'$first':_0x14e214(0x181)},'bay':{'$first':_0x14e214(0xb9)},'bin':{'$first':_0x14e214(0x129)},'type':{'$first':_0x14e214(0x11c)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x14e214(0x160)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x14e214(0x1c9)},'storage':{'$first':_0x14e214(0x1df)},'rack':{'$first':'$product_details.rack'}}}]),_0x576b76=await customer[_0x14e214(0x1b4)]({});let _0x1d4659;if(_0x5cb2a6['role']==_0x14e214(0x177)){const _0x988dfc=await staff[_0x14e214(0xe5)]({'email':_0x5cb2a6['email']});_0x1d4659=await warehouse[_0x14e214(0x16f)]([{'$match':{'status':_0x14e214(0x1c3),'name':_0x988dfc[_0x14e214(0x10c)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x1d4659=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x14e214(0x1bd)}}}]);const _0xff4232=await product[_0x14e214(0x1b4)]({});if(_0x3a4e50[0x0][_0x14e214(0x1d8)]==_0x14e214(0x1af)){var _0x1bb8ae=users[_0x14e214(0x1d3)];console['log'](_0x1bb8ae);}else{if(_0x3a4e50[0x0][_0x14e214(0x1d8)]==_0x14e214(0x114))var _0x1bb8ae=users[_0x14e214(0x114)];else{if(_0x3a4e50[0x0]['language']==_0x14e214(0x1cf))var _0x1bb8ae=users[_0x14e214(0x1cf)];else{if(_0x3a4e50[0x0][_0x14e214(0x1d8)]==_0x14e214(0x198))var _0x1bb8ae=users['Spanish'];else{if(_0x3a4e50[0x0][_0x14e214(0x1d8)]==_0x14e214(0x1c8))var _0x1bb8ae=users[_0x14e214(0x1c8)];else{if(_0x3a4e50[0x0]['language']=='Portuguese\x20(BR)')var _0x1bb8ae=users[_0x14e214(0xe0)];else{if(_0x3a4e50[0x0]['language']==_0x14e214(0x17d))var _0x1bb8ae=users[_0x14e214(0x17d)];else{if(_0x3a4e50[0x0]['language']==_0x14e214(0x139))var _0x1bb8ae=users[_0x14e214(0x146)];}}}}}}}_0x394ae9[_0x14e214(0x121)](_0x14e214(0x132),{'success':_0x22e976[_0x14e214(0xde)]('success'),'errors':_0x22e976[_0x14e214(0xde)](_0x14e214(0x157)),'role':_0x5cb2a6,'profile':_0x17851b,'customer':_0x576b76,'warehouse':_0x1d4659,'product':_0x422eb3,'user':_0x106d54,'master_shop':_0x3a4e50,'unit':_0xff4232,'language':_0x1bb8ae,'rooms_data':_0x380048,'ed_fullDate':_0x4f134b});}catch(_0x9e6f38){console['log'](_0x9e6f38);}}),router['post']('/view/:id',auth,async(_0x497f45,_0xf342c0)=>{var _0x544b7d=a0_0x234545;try{const _0x5632af=_0x497f45[_0x544b7d(0x120)]['id'],_0x183e46=await sales_finished[_0x544b7d(0xe5)]({'_id':_0x497f45[_0x544b7d(0x120)]['id']}),_0xdbfba4=await warehouse[_0x544b7d(0xe5)]({'name':_0x183e46[_0x544b7d(0x11f)],'room':_0x497f45['body'][_0x544b7d(0x1a3)],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x240593,customer:_0x3e8508,date:_0xeb8e0,warehouse_name:_0x4da385,product_name:_0x4f385e,stock:_0x5aa502,adjust_qty:_0x3e686e,note:_0x4b5095,room:_0x396d84,primary_code:_0x13fc5f,secondary_code:_0xdb0fce,prod_code:_0x229185,level:_0x4144dd,isle:_0x1b845b,pallet:_0x800130,expiry_date:_0x1af99e}=_0x497f45[_0x544b7d(0xb8)];if(typeof _0x4f385e==_0x544b7d(0x11b))var _0xe0feea=[_0x497f45[_0x544b7d(0xb8)][_0x544b7d(0xc7)]],_0x383971=[_0x497f45['body'][_0x544b7d(0x102)]],_0x43ebc4=[_0x497f45[_0x544b7d(0xb8)]['adjust_qty']],_0x2f3458=[_0x497f45[_0x544b7d(0xb8)][_0x544b7d(0xba)]],_0x4a20c5=[_0x497f45[_0x544b7d(0xb8)][_0x544b7d(0x1c6)]],_0x3eb695=[_0x497f45['body'][_0x544b7d(0x17f)]],_0x4e0053=[_0x497f45[_0x544b7d(0xb8)][_0x544b7d(0x15a)]],_0x5c8818=[_0x497f45[_0x544b7d(0xb8)][_0x544b7d(0xec)]];else var _0xe0feea=[..._0x497f45[_0x544b7d(0xb8)][_0x544b7d(0xc7)]],_0x383971=[..._0x497f45['body'][_0x544b7d(0x102)]],_0x43ebc4=[..._0x497f45[_0x544b7d(0xb8)][_0x544b7d(0xfa)]],_0x2f3458=[..._0x497f45['body'][_0x544b7d(0xba)]],_0x4a20c5=[..._0x497f45[_0x544b7d(0xb8)][_0x544b7d(0x1c6)]],_0x3eb695=[..._0x497f45[_0x544b7d(0xb8)]['prod_code']],_0x4e0053=[..._0x497f45[_0x544b7d(0xb8)][_0x544b7d(0x15a)]],_0x5c8818=[..._0x497f45[_0x544b7d(0xb8)][_0x544b7d(0xec)]];const _0x3072cf=_0xe0feea['map'](_0x41cf41=>{return _0x41cf41={'product_name':_0x41cf41};});_0x383971[_0x544b7d(0xc3)]((_0x3eedfb,_0x132fb2)=>{var _0x85f78b=_0x544b7d;_0x3072cf[_0x132fb2][_0x85f78b(0x102)]=_0x3eedfb;}),_0x43ebc4[_0x544b7d(0xc3)]((_0x14973f,_0x296f69)=>{_0x3072cf[_0x296f69]['quantity']=_0x14973f;}),_0x2f3458[_0x544b7d(0xc3)]((_0x520141,_0x53bf87)=>{_0x3072cf[_0x53bf87]['primary_code']=_0x520141;}),_0x4a20c5['forEach']((_0x273c6f,_0x28f53f)=>{var _0x1ee9cb=_0x544b7d;_0x3072cf[_0x28f53f][_0x1ee9cb(0x1c6)]=_0x273c6f;}),_0x3eb695[_0x544b7d(0xc3)]((_0x2bd27d,_0x421fea)=>{var _0x7f69b1=_0x544b7d;_0x3072cf[_0x421fea][_0x7f69b1(0x1c2)]=_0x2bd27d;}),_0x4e0053[_0x544b7d(0xc3)]((_0x305225,_0x55a390)=>{var _0x456c08=_0x544b7d;_0x3072cf[_0x55a390][_0x456c08(0x15a)]=_0x305225;}),_0x5c8818[_0x544b7d(0xc3)]((_0x53d962,_0x2cf9eb)=>{_0x3072cf[_0x2cf9eb]['expiry_date']=_0x53d962;});var _0x2fc17c=0x0;_0x3072cf['forEach'](_0xc4bc71=>{var _0x165b9f=_0x544b7d;console['log'](_0x165b9f(0x14a),_0xc4bc71),(parseInt(_0xc4bc71['stock'])<parseInt(_0xc4bc71[_0x165b9f(0xd7)])||parseInt(_0xc4bc71[_0x165b9f(0xd7)])==0x0)&&_0x2fc17c++;});if(_0x2fc17c!=0x0)return _0x497f45[_0x544b7d(0xde)](_0x544b7d(0x157),_0x544b7d(0x16a)),_0xf342c0[_0x544b7d(0x125)](_0x544b7d(0xc4));_0x183e46[_0x544b7d(0x14e)][_0x544b7d(0xc3)](_0x5ef863=>{var _0x7d1740=_0x544b7d;const _0x25f9fb=_0xdbfba4[_0x7d1740(0x1b2)]['map'](_0x5598a2=>{var _0x27dca=_0x7d1740;_0x5598a2[_0x27dca(0xc7)]==_0x5ef863[_0x27dca(0xc7)]&&_0x5598a2[_0x27dca(0x122)]==_0x5ef863[_0x27dca(0x122)]&&(_0x5598a2['product_stock']=parseInt(_0x5598a2[_0x27dca(0x1ab)])+parseInt(_0x5ef863[_0x27dca(0xd7)]));});}),await _0xdbfba4['save']();const _0x27671f=_0x3072cf[_0x544b7d(0x172)](_0x4998b5=>_0x4998b5[_0x544b7d(0xd7)]!=='0'&&_0x4998b5[_0x544b7d(0xd7)]!=='');_0x183e46[_0x544b7d(0x19d)]=_0x240593,_0x183e46[_0x544b7d(0x1a7)]=_0x3e8508,_0x183e46[_0x544b7d(0x1e4)]=_0xeb8e0,_0x183e46['warehouse_name']=_0x4da385,_0x183e46['sale_product']=_0x27671f,_0x183e46['note']=_0x4b5095,_0x183e46[_0x544b7d(0x1a3)]=_0x396d84;const _0x2d0bab=await _0x183e46['save'](),_0x47d71b=await sales_finished[_0x544b7d(0xe5)]({'_id':_0x497f45[_0x544b7d(0x120)]['id']}),_0x5556b3=await warehouse[_0x544b7d(0xe5)]({'name':_0x4da385,'room':_0x396d84,'warehouse_category':'Finished\x20Goods'});_0x47d71b[_0x544b7d(0x14e)][_0x544b7d(0xc3)](_0x177709=>{var _0x417eb2=_0x544b7d;const _0x135d70=_0x5556b3['product_details'][_0x417eb2(0x136)](_0x4f8a40=>{var _0x3ac26c=_0x417eb2;_0x4f8a40[_0x3ac26c(0xc7)]==_0x177709['product_name']&&_0x4f8a40['bay']==_0x177709[_0x3ac26c(0x122)]&&(_0x4f8a40[_0x3ac26c(0x1ab)]=parseInt(_0x4f8a40[_0x3ac26c(0x1ab)])-parseInt(_0x177709['quantity']));});}),console['log']('final',_0x5556b3),await _0x5556b3[_0x544b7d(0xdc)]();const _0x398e0c=await c_payment_data[_0x544b7d(0xe5)]({'invoice':_0x497f45[_0x544b7d(0xb8)][_0x544b7d(0x19d)]});_0x398e0c['suppliers']=_0x497f45[_0x544b7d(0xb8)][_0x544b7d(0x1eb)],await _0x398e0c[_0x544b7d(0xdc)](),_0x497f45[_0x544b7d(0xde)](_0x544b7d(0x1f6),'Sales\x20Update\x20successfully'),_0xf342c0[_0x544b7d(0x125)](_0x544b7d(0xce));}catch(_0x1b5640){console[_0x544b7d(0xf5)](_0x1b5640);}}),router['post']('/give_payment/:id',auth,async(_0x35d961,_0x31640b)=>{var _0x3ec505=a0_0x234545;try{const _0x435992=_0x35d961['params']['id'],{invoice:_0x279dcf,customer:_0x2a7753,receivable_amount:_0xc771da,received_amount:_0x3bdf63}=_0x35d961['body'],_0x157c7e=await sales[_0x3ec505(0x1e5)](_0x435992);console[_0x3ec505(0xf5)](_0x157c7e);var _0x4dca44=_0xc771da-_0x3bdf63;console[_0x3ec505(0xf5)](_0x3bdf63),_0x157c7e[_0x3ec505(0xd0)]=parseFloat(_0x3bdf63)+parseFloat(_0x157c7e[_0x3ec505(0xd0)]),_0x157c7e[_0x3ec505(0x12b)]=_0x4dca44,console[_0x3ec505(0xf5)](_0x157c7e);const _0x18f0f9=await _0x157c7e[_0x3ec505(0xdc)](),_0x599430=await c_payment_data[_0x3ec505(0xe5)]({'invoice':_0x279dcf});_0x599430[_0x3ec505(0x178)]=_0x4dca44,await _0x599430['save']();let _0x2612b2=new Date(),_0x32bbbe=('0'+_0x2612b2[_0x3ec505(0xa8)]())[_0x3ec505(0x176)](-0x2),_0x46259c=('0'+(_0x2612b2[_0x3ec505(0xdf)]()+0x1))['slice'](-0x2),_0xe32a46=_0x2612b2[_0x3ec505(0x1f2)](),_0x44b191=_0xe32a46+'-'+_0x46259c+'-'+_0x32bbbe;const _0x2618b7=new customer_payment({'invoice':_0x279dcf,'date':_0xe32a46+'-'+_0x46259c+'-'+_0x32bbbe,'customer':_0x2a7753,'reason':_0x3ec505(0x10a),'amount':_0x3bdf63}),_0x117f4f=await _0x2618b7['save']();_0x35d961[_0x3ec505(0xde)](_0x3ec505(0x1f6),_0x3ec505(0x130)),_0x31640b[_0x3ec505(0x125)](_0x3ec505(0x1bf));}catch(_0x518caa){console[_0x3ec505(0xf5)](_0x518caa);}}),router['get'](a0_0x234545(0x155),auth,async(_0x3ed5fe,_0x5d39ab)=>{var _0x280611=a0_0x234545;try{const {username:_0x275dec,email:_0x2d0b3c,role:_0x7112ea}=_0x3ed5fe[_0x280611(0x149)],_0x5d247b=_0x3ed5fe['user'],_0xdb6d50=await profile['findOne']({'email':_0x5d247b['email']}),_0x7c90bc=await master_shop[_0x280611(0x1b4)]();console['log'](_0x280611(0x1c5),_0x7c90bc);const _0x1887a7=_0x3ed5fe[_0x280611(0x120)]['id'],_0x289bd5=await sales[_0x280611(0x1e5)](_0x1887a7);console[_0x280611(0xf5)](_0x289bd5);const _0x1d6811=await customer[_0x280611(0xe5)]({'name':_0x289bd5[_0x280611(0x1a7)]});console[_0x280611(0xf5)](_0x1d6811);if(_0x7c90bc[0x0][_0x280611(0x1d8)]=='English\x20(US)'){var _0x3b3ae6=users[_0x280611(0x1d3)];console[_0x280611(0xf5)](_0x3b3ae6);}else{if(_0x7c90bc[0x0][_0x280611(0x1d8)]==_0x280611(0x114))var _0x3b3ae6=users[_0x280611(0x114)];else{if(_0x7c90bc[0x0][_0x280611(0x1d8)]==_0x280611(0x1cf))var _0x3b3ae6=users[_0x280611(0x1cf)];else{if(_0x7c90bc[0x0][_0x280611(0x1d8)]==_0x280611(0x198))var _0x3b3ae6=users[_0x280611(0x198)];else{if(_0x7c90bc[0x0][_0x280611(0x1d8)]==_0x280611(0x1c8))var _0x3b3ae6=users['French'];else{if(_0x7c90bc[0x0][_0x280611(0x1d8)]=='Portuguese\x20(BR)')var _0x3b3ae6=users['Portuguese'];else{if(_0x7c90bc[0x0][_0x280611(0x1d8)]==_0x280611(0x17d))var _0x3b3ae6=users[_0x280611(0x17d)];else{if(_0x7c90bc[0x0][_0x280611(0x1d8)]==_0x280611(0x139))var _0x3b3ae6=users[_0x280611(0x146)];}}}}}}}_0x5d39ab[_0x280611(0x121)](_0x280611(0x105),{'success':_0x3ed5fe[_0x280611(0xde)](_0x280611(0x1f6)),'errors':_0x3ed5fe['flash'](_0x280611(0x157)),'role':_0x5d247b,'profile':_0xdb6d50,'master_shop':_0x7c90bc,'customers':_0x1d6811,'sales':_0x289bd5,'language':_0x3b3ae6});}catch(_0x463375){console[_0x280611(0xf5)](_0x463375);}}),router['get'](a0_0x234545(0x12e),auth,async(_0xb93e1a,_0x2275e6)=>{var _0x8d6525=a0_0x234545;try{const {username:_0x346ab7,email:_0x45dad4,role:_0x435e15}=_0xb93e1a[_0x8d6525(0x149)],_0x839f0d=_0xb93e1a[_0x8d6525(0x149)],_0x40bc22=await profile[_0x8d6525(0xe5)]({'email':_0x839f0d[_0x8d6525(0x170)]}),_0x528254=await master_shop[_0x8d6525(0x1b4)](),_0x5eec4a=_0xb93e1a[_0x8d6525(0x120)]['id'],_0x131405=await sales_finished[_0x8d6525(0x1e5)](_0x5eec4a),_0x3433fe=await warehouse[_0x8d6525(0x16f)]([{'$match':{'name':_0x131405['warehouse_name']}},{'$unwind':_0x8d6525(0x1bc)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x8d6525(0xbf)},'product_stock':{'$first':_0x8d6525(0x181)},'bay':{'$first':_0x8d6525(0xb9)},'bin':{'$first':_0x8d6525(0x129)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x8d6525(0xfd)},'primary_code':{'$first':_0x8d6525(0x160)},'secondary_code':{'$first':_0x8d6525(0x1cb)},'product_code':{'$first':_0x8d6525(0x1c9)},'storage':{'$first':_0x8d6525(0x1df)},'rack':{'$first':_0x8d6525(0x11a)},'expiry_date':{'$first':_0x8d6525(0xda)},'production_date':{'$first':_0x8d6525(0x14b)},'unit':{'$first':_0x8d6525(0x14c)},'secondary_unit':{'$first':_0x8d6525(0x171)},'maxProducts':{'$first':_0x8d6525(0xb2)},'batch_code':{'$first':_0x8d6525(0x175)},'maxPerUnit':{'$first':_0x8d6525(0x107)}}}]),_0x5b9f24=await product[_0x8d6525(0x1b4)]({}),_0x39522b=await warehouse[_0x8d6525(0x16f)]([{'$match':{'status':_0x8d6525(0x1c3),'warehouse_category':_0x8d6525(0x169),'name':{'$ne':_0x8d6525(0x199),'$ne':_0x8d6525(0x1a9)}}},{'$group':{'_id':'$name','name':{'$first':_0x8d6525(0x1bd)}}},{'$sort':{'name':0x1}}]);var _0x5baee7=['Return\x20Rooms'];const _0x189dab=await warehouse['aggregate']([{'$match':{'status':_0x8d6525(0x1c3),'name':_0x8d6525(0x1a9)}},{'$group':{'_id':_0x8d6525(0x1bd),'name':{'$first':_0x8d6525(0x1bd)}}},{'$sort':{'name':0x1}}]);if(_0x528254[0x0][_0x8d6525(0x1d8)]=='English\x20(US)'){var _0x38040c=users['English'];console['log'](_0x38040c);}else{if(_0x528254[0x0]['language']=='Hindi')var _0x38040c=users[_0x8d6525(0x114)];else{if(_0x528254[0x0][_0x8d6525(0x1d8)]==_0x8d6525(0x1cf))var _0x38040c=users[_0x8d6525(0x1cf)];else{if(_0x528254[0x0][_0x8d6525(0x1d8)]==_0x8d6525(0x198))var _0x38040c=users[_0x8d6525(0x198)];else{if(_0x528254[0x0][_0x8d6525(0x1d8)]=='French')var _0x38040c=users[_0x8d6525(0x1c8)];else{if(_0x528254[0x0]['language']==_0x8d6525(0x189))var _0x38040c=users[_0x8d6525(0xe0)];else{if(_0x528254[0x0][_0x8d6525(0x1d8)]==_0x8d6525(0x17d))var _0x38040c=users['Chinese'];else{if(_0x528254[0x0][_0x8d6525(0x1d8)]==_0x8d6525(0x139))var _0x38040c=users['Arabic'];}}}}}}}_0x2275e6[_0x8d6525(0x121)](_0x8d6525(0x184),{'success':_0xb93e1a[_0x8d6525(0xde)](_0x8d6525(0x1f6)),'errors':_0xb93e1a[_0x8d6525(0xde)](_0x8d6525(0x157)),'role':_0x839f0d,'profile':_0x40bc22,'user':_0x131405,'stock':_0x3433fe,'master_shop':_0x528254,'unit':_0x5b9f24,'language':_0x38040c,'warehouses':_0x39522b,'rooms':_0x5baee7,'warehouse_QA':_0x189dab});}catch(_0x2fb4aa){console['log'](_0x2fb4aa),_0x2275e6[_0x8d6525(0xbc)](0xc8)[_0x8d6525(0x1f4)]({'message':_0x2fb4aa[_0x8d6525(0x1be)]});}}),router['post']('/view/return_sales/:id',auth,async(_0x3e79ac,_0x12d1f1)=>{var _0x5674f5=a0_0x234545;if(_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1d1)]=='QA')try{const {invoice:_0xc54b5a,date:_0x395a40,warehouse_name:_0x3b87b0,product_name:_0x13aac3,primary_code:_0x1e73e1,secondary_code:_0x3d6620,product_code:_0x127a57,sales_quantity:_0x2008b8,stocks:_0x4000ec,return_qty:_0x5884d5,Room_name:_0x485333,to_warehouse_name_QA:_0x57f79e,to_Room_name_QA:_0x4f86ad,note:_0x2ca6a5,for_categorize:_0x3f2487,product_name_QA1:_0x19d772}=_0x3e79ac[_0x5674f5(0xb8)];if(typeof _0x19d772=='string')var _0x27f06b=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1e7)]],_0x28c064=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x168)]],_0x497444=[_0x3e79ac[_0x5674f5(0xb8)]['secondary_code_QA']],_0x5c5d6c=[_0x3e79ac[_0x5674f5(0xb8)]['product_code_QA']],_0x2962c0=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x138)]],_0x534884=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1d2)]],_0x1b286a=[_0x3e79ac[_0x5674f5(0xb8)]['return_qty_QA']],_0x5edcc8=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xb1)]],_0x24892c=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x15c)]],_0x1580ca=[_0x3e79ac['body'][_0x5674f5(0xe9)]],_0x4b24ee=[_0x3e79ac[_0x5674f5(0xb8)]['secondary_unit_QA']],_0x409c73=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x152)]],_0x30da1d=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xca)]],_0x545555=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xcf)]];else var _0x27f06b=[..._0x3e79ac[_0x5674f5(0xb8)]['product_name_QA1']],_0x28c064=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x168)]],_0x497444=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x18c)]],_0x5c5d6c=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x100)]],_0x2962c0=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x138)]],_0x534884=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1d2)]],_0x1b286a=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x123)]],_0x5edcc8=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xb1)]],_0x24892c=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x15c)]],_0x1580ca=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xe9)]],_0x4b24ee=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x16d)]],_0x409c73=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x152)]],_0x30da1d=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xca)]],_0x545555=[..._0x3e79ac[_0x5674f5(0xb8)]['expiry_date_QA']];const _0x5790f2=_0x27f06b['map'](_0x14759f=>{return _0x14759f={'product_name':_0x14759f};});_0x28c064[_0x5674f5(0xc3)]((_0x125caa,_0x18033d)=>{var _0x377db1=_0x5674f5;_0x5790f2[_0x18033d][_0x377db1(0xba)]=_0x125caa;}),_0x497444['forEach']((_0xcc983,_0x2169c0)=>{var _0x4eb2a8=_0x5674f5;_0x5790f2[_0x2169c0][_0x4eb2a8(0x1c6)]=_0xcc983;}),_0x5c5d6c[_0x5674f5(0xc3)]((_0x30f3d4,_0x18e19e)=>{var _0x15145b=_0x5674f5;_0x5790f2[_0x18e19e][_0x15145b(0x1c2)]=_0x30f3d4;}),_0x2962c0[_0x5674f5(0xc3)]((_0x42c965,_0x44a852)=>{var _0x25fba1=_0x5674f5;_0x5790f2[_0x44a852][_0x25fba1(0x111)]=_0x42c965;}),_0x534884['forEach']((_0x54e2a4,_0x37a81d)=>{_0x5790f2[_0x37a81d]['stock']=_0x54e2a4;}),_0x1b286a[_0x5674f5(0xc3)]((_0x1c447f,_0x50fa0f)=>{var _0x338f5b=_0x5674f5;_0x5790f2[_0x50fa0f][_0x338f5b(0x187)]=_0x1c447f;}),_0x5edcc8[_0x5674f5(0xc3)]((_0x1e67d1,_0x3219f9)=>{var _0x23a58d=_0x5674f5;_0x5790f2[_0x3219f9][_0x23a58d(0xae)]=_0x1e67d1;}),_0x24892c[_0x5674f5(0xc3)]((_0x26cfda,_0x2532db)=>{var _0x1dac2e=_0x5674f5;_0x5790f2[_0x2532db][_0x1dac2e(0x19b)]=_0x26cfda;}),_0x1580ca[_0x5674f5(0xc3)]((_0x524a47,_0x3c9891)=>{var _0x22a54b=_0x5674f5;_0x5790f2[_0x3c9891][_0x22a54b(0x1dc)]=_0x524a47;}),_0x4b24ee[_0x5674f5(0xc3)]((_0x46ce47,_0x37a86e)=>{var _0x6a258=_0x5674f5;_0x5790f2[_0x37a86e][_0x6a258(0x1f3)]=_0x46ce47;}),_0x409c73[_0x5674f5(0xc3)]((_0x3f72a4,_0x1a9858)=>{var _0xdbf308=_0x5674f5;_0x5790f2[_0x1a9858][_0xdbf308(0x1ca)]=_0x3f72a4;}),_0x30da1d[_0x5674f5(0xc3)]((_0x1c5cf6,_0x4b9351)=>{var _0x169a51=_0x5674f5;_0x5790f2[_0x4b9351][_0x169a51(0x13e)]=_0x1c5cf6;}),_0x545555[_0x5674f5(0xc3)]((_0x3e2148,_0x12e179)=>{var _0x22b16e=_0x5674f5;_0x5790f2[_0x12e179][_0x22b16e(0xec)]=_0x3e2148;});const _0x562c1e=await sales_finished['findOne']({'invoice':_0xc54b5a});_0x562c1e[_0x5674f5(0x118)]=_0x5674f5(0x133);const _0x1ac788=await _0x562c1e[_0x5674f5(0xdc)](),_0x47f879=new sales_return_finished({'invoice':_0xc54b5a,'customer':_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1a7)],'date':_0x395a40,'warehouse_name':_0x3b87b0,'room':_0x485333,'ToWarehouse':_0x57f79e,'ToRoom':_0x4f86ad,'return_sale_QA':_0x5790f2,'note':_0x2ca6a5,'warehouse_cat':_0x3f2487}),_0x77fd5e=await _0x47f879['save'](),_0x2c8765=await sales_return_finished[_0x5674f5(0xe5)]({'invoice':_0xc54b5a}),_0x368205=await warehouse[_0x5674f5(0xe5)]({'name':_0x57f79e,'room':_0x4f86ad});_0x2c8765[_0x5674f5(0xc8)]['forEach'](_0x49ee05=>{var _0x5f172e=_0x5674f5,_0x37ac03=0x0;const _0x462aea=_0x368205[_0x5f172e(0x1b2)]['map'](_0x105e87=>{var _0x37be08=_0x5f172e;_0x105e87['product_name']==_0x49ee05[_0x37be08(0xc7)]&&_0x105e87[_0x37be08(0xec)]==_0x49ee05[_0x37be08(0xec)]&&_0x105e87[_0x37be08(0x13e)]==_0x49ee05[_0x37be08(0x13e)]&&_0x105e87[_0x37be08(0x1dc)]==_0x49ee05['batch_code']&&(_0x105e87['product_stock']=parseInt(_0x105e87[_0x37be08(0x1ab)])+parseInt(_0x49ee05['return_qty']),_0x37ac03++);});_0x37ac03=='0'&&(_0x368205['product_details']=_0x368205[_0x5f172e(0x1b2)]['concat']({'product_name':_0x49ee05[_0x5f172e(0xc7)],'product_stock':_0x49ee05['return_qty'],'primary_code':_0x49ee05[_0x5f172e(0xba)],'secondary_code':_0x49ee05['secondary_code'],'product_code':_0x49ee05[_0x5f172e(0x1c2)],'batch_code':_0x49ee05['batch_code'],'maxPerUnit':_0x49ee05[_0x5f172e(0xae)],'production_date':_0x49ee05['production_date'],'expiry_date':_0x49ee05['expiry_date'],'secondary_unit':_0x49ee05[_0x5f172e(0x1f3)],'unit':_0x49ee05[_0x5f172e(0x1ca)],'maxProducts':_0x49ee05['maxProducts'],'bay':_0x49ee05[_0x5f172e(0x122)]}));}),await _0x368205['save']();const _0xdb6d75=new c_payment_data({'invoice':_0xc54b5a,'customer':_0x3e79ac['body'][_0x5674f5(0x1a7)],'reason':_0x5674f5(0xd2)});await _0xdb6d75[_0x5674f5(0xdc)]();const _0x524c51=await master_shop[_0x5674f5(0x1b4)](),_0x4df807=await email_settings['findOne'](),_0x1b68d6=await customer[_0x5674f5(0xe5)]({'name':_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1a7)]});_0x524c51[0x0][_0x5674f5(0x143)]==0x1?(right_currency=_0x524c51[0x0][_0x5674f5(0x101)],left_currency=''):(right_currency='',left_currency=_0x524c51[0x0][_0x5674f5(0x101)]);var _0x1c4e9a=_0x27f06b,_0x45a950=_0x1b286a,_0x44ecd1='',_0x3e0aa6;for(_0x3e0aa6 in _0x1c4e9a){_0x44ecd1+=_0x5674f5(0x1d5)+_0x5674f5(0xaf)+_0x1c4e9a[_0x3e0aa6]+_0x5674f5(0x19c)+_0x5674f5(0xaf)+_0x45a950[_0x3e0aa6]+_0x5674f5(0x19c)+_0x5674f5(0xf7);}console[_0x5674f5(0xf5)](_0x5674f5(0xf0),_0x44ecd1);let _0x16cc3e=nodemailer[_0x5674f5(0x188)]({'service':_0x5674f5(0x182),'auth':{'user':_0x4df807[_0x5674f5(0x170)],'pass':_0x4df807['password']}}),_0x52fea8={'from':_0x4df807[_0x5674f5(0x170)],'to':_0x1b68d6[_0x5674f5(0x170)],'subject':_0x5674f5(0x148),'attachments':[{'filename':_0x5674f5(0x180),'path':__dirname+_0x5674f5(0xa6)+_0x5674f5(0x162)+_0x524c51[0x0][_0x5674f5(0x113)],'cid':_0x5674f5(0x1dd)}],'html':_0x5674f5(0x12a)+'<html><head><title></title>'+_0x5674f5(0x1c4)+'<div>'+_0x5674f5(0x1b8)+_0x5674f5(0x145)+_0x5674f5(0xcb)+'</div>'+_0x5674f5(0x145)+'<h2>\x20'+_0x524c51[0x0]['site_title']+'\x20</h2>'+_0x5674f5(0x173)+_0x5674f5(0x173)+_0x5674f5(0x110)+_0x5674f5(0x145)+_0x5674f5(0x12c)+_0x5674f5(0x195)+_0xc54b5a+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x5674f5(0xf2)+_0x395a40+'\x20'+_0x5674f5(0x150)+_0x5674f5(0x17a)+_0x5674f5(0x173)+_0x5674f5(0x1ac)+_0x5674f5(0x19e)+'<tr>'+_0x5674f5(0x1a1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x5674f5(0xa4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x5674f5(0xf7)+_0x5674f5(0x16b)+_0x5674f5(0x14f)+'\x20'+_0x44ecd1+'\x20'+_0x5674f5(0x10e)+_0x5674f5(0x1e3)+_0x5674f5(0x145)+_0x5674f5(0xfc)+'<h5>'+_0x524c51[0x0]['site_title']+'</h5>'+_0x5674f5(0x173)+_0x5674f5(0x173)+_0x5674f5(0x166)};_0x16cc3e[_0x5674f5(0xd4)](_0x52fea8,function(_0x520d6c,_0x5c3638){var _0xdc738d=_0x5674f5;_0x520d6c?(console['log'](_0x520d6c),console[_0xdc738d(0xf5)](_0xdc738d(0x13c))):console[_0xdc738d(0xf5)](_0xdc738d(0xa9));}),_0x3e79ac[_0x5674f5(0xde)](_0x5674f5(0x1f6),_0x5674f5(0xe2)),_0x12d1f1['redirect'](_0x5674f5(0xce));}catch(_0x38aeb8){_0x12d1f1[_0x5674f5(0xbc)](0xc8)[_0x5674f5(0x1f4)]({'message1':_0x38aeb8['message']});}else{if(_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1d1)]=='GS')try{const {invoice:_0xd012e2,date:_0x684260,warehouse_name:_0x1fb471,product_name:_0x5b29a9,primary_code:_0x5bea98,secondary_code:_0xa8abda,product_code:_0x422ecc,sales_quantity:_0x343626,stocks:_0x1501cd,return_qty:_0x24655f,Room_name:_0x32eed2,to_warehouse_name:_0x282436,to_Room_name:_0x368482,note:_0x1da280,level:_0x323138,isle:_0x257c52,pallet:_0x33ab94,for_categorize:_0x33af10}=_0x3e79ac[_0x5674f5(0xb8)];if(typeof _0x5b29a9==_0x5674f5(0x11b))var _0x27f06b=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xc7)]],_0x28c064=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xba)]],_0x497444=[_0x3e79ac['body'][_0x5674f5(0x1c6)]],_0x5c5d6c=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1c2)]],_0x2962c0=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x191)]],_0x1b286a=[_0x3e79ac['body']['return_qty']],_0x585b2d=[_0x3e79ac[_0x5674f5(0xb8)]['bay']],_0x5edcc8=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xae)]],_0x24892c=[_0x3e79ac['body'][_0x5674f5(0x19b)]],_0x1580ca=[_0x3e79ac['body']['batch_code']],_0x4b24ee=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1f3)]],_0x409c73=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1ca)]],_0x30da1d=[_0x3e79ac[_0x5674f5(0xb8)]['production_date']],_0x545555=[_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xec)]];else var _0x27f06b=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0xc7)]],_0x28c064=[..._0x3e79ac[_0x5674f5(0xb8)]['primary_code']],_0x497444=[..._0x3e79ac['body']['secondary_code']],_0x5c5d6c=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1c2)]],_0x2962c0=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x191)]],_0x1b286a=[..._0x3e79ac['body']['return_qty']],_0x585b2d=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x122)]],_0x5edcc8=[..._0x3e79ac['body'][_0x5674f5(0xae)]],_0x24892c=[..._0x3e79ac['body']['maxProducts']],_0x1580ca=[..._0x3e79ac['body'][_0x5674f5(0x1dc)]],_0x4b24ee=[..._0x3e79ac[_0x5674f5(0xb8)]['secondary_unit']],_0x409c73=[..._0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1ca)]],_0x30da1d=[..._0x3e79ac['body'][_0x5674f5(0x13e)]],_0x545555=[..._0x3e79ac['body'][_0x5674f5(0xec)]];const _0x102a39=_0x27f06b[_0x5674f5(0x136)](_0x1583dd=>{return _0x1583dd={'product_name':_0x1583dd};});_0x28c064[_0x5674f5(0xc3)]((_0x20ae83,_0x25b586)=>{var _0x675ee5=_0x5674f5;_0x102a39[_0x25b586][_0x675ee5(0xba)]=_0x20ae83;}),_0x497444[_0x5674f5(0xc3)]((_0x1110f0,_0x4f997d)=>{var _0xa8a8b3=_0x5674f5;_0x102a39[_0x4f997d][_0xa8a8b3(0x1c6)]=_0x1110f0;}),_0x5c5d6c[_0x5674f5(0xc3)]((_0x3f8657,_0x57d53e)=>{_0x102a39[_0x57d53e]['product_code']=_0x3f8657;}),_0x2962c0['forEach']((_0x1e9dc3,_0x3db9da)=>{var _0x3ab70d=_0x5674f5;_0x102a39[_0x3db9da][_0x3ab70d(0x111)]=_0x1e9dc3;}),_0x1b286a['forEach']((_0x2a12a6,_0x144c0f)=>{var _0x2628f2=_0x5674f5;_0x102a39[_0x144c0f][_0x2628f2(0x187)]=_0x2a12a6;}),_0x585b2d[_0x5674f5(0xc3)]((_0x2d942e,_0x5d7b79)=>{_0x102a39[_0x5d7b79]['bay']=_0x2d942e;}),_0x5edcc8[_0x5674f5(0xc3)]((_0x22d7fe,_0x12067b)=>{var _0x3b50ea=_0x5674f5;_0x102a39[_0x12067b][_0x3b50ea(0xae)]=_0x22d7fe;}),_0x24892c[_0x5674f5(0xc3)]((_0x4ea866,_0x4ae0e8)=>{var _0x222b91=_0x5674f5;_0x102a39[_0x4ae0e8][_0x222b91(0x19b)]=_0x4ea866;}),_0x1580ca[_0x5674f5(0xc3)]((_0x4ad67a,_0x4cdf4b)=>{var _0xf4707a=_0x5674f5;_0x102a39[_0x4cdf4b][_0xf4707a(0x1dc)]=_0x4ad67a;}),_0x4b24ee['forEach']((_0x4b386a,_0x3c0590)=>{_0x102a39[_0x3c0590]['secondary_unit']=_0x4b386a;}),_0x409c73[_0x5674f5(0xc3)]((_0x34f834,_0x1ef11d)=>{_0x102a39[_0x1ef11d]['unit']=_0x34f834;}),_0x30da1d[_0x5674f5(0xc3)]((_0x577552,_0x3027fb)=>{var _0x7582e0=_0x5674f5;_0x102a39[_0x3027fb][_0x7582e0(0x13e)]=_0x577552;}),_0x545555[_0x5674f5(0xc3)]((_0x5ebdfe,_0xbd6a2b)=>{var _0x4aa8fc=_0x5674f5;_0x102a39[_0xbd6a2b][_0x4aa8fc(0xec)]=_0x5ebdfe;});var _0x56ab7e=0x0;_0x102a39[_0x5674f5(0xc3)](_0x419359=>{var _0x3e98e6=_0x5674f5;(parseInt(_0x419359[_0x3e98e6(0x111)])<parseInt(_0x419359[_0x3e98e6(0x187)])||parseInt(_0x419359[_0x3e98e6(0x102)])<parseInt(_0x419359[_0x3e98e6(0x187)])&&parseInt(_0x419359[_0x3e98e6(0x111)])>parseInt(_0x419359[_0x3e98e6(0x187)])||parseInt(_0x419359[_0x3e98e6(0x187)])==0x0)&&_0x56ab7e++;});if(_0x56ab7e!=0x0)return _0x3e79ac['flash']('errors',_0x5674f5(0x10f)),_0x12d1f1['redirect']('back');const _0x12ff99=await sales_finished[_0x5674f5(0xe5)]({'invoice':_0xd012e2});_0x12ff99[_0x5674f5(0x118)]='True';const _0x16a033=await _0x12ff99[_0x5674f5(0xdc)](),_0x38217a=new sales_return_finished({'invoice':_0xd012e2,'customer':_0x3e79ac[_0x5674f5(0xb8)]['customer'],'date':_0x684260,'warehouse_name':_0x1fb471,'room':_0x32eed2,'ToWarehouse':_0x282436,'ToRoom':_0x368482,'return_sale':_0x102a39,'note':_0x1da280,'warehouse_cat':_0x33af10}),_0x5ceb35=await _0x38217a[_0x5674f5(0xdc)](),_0xd1225b=await sales_return_finished['findOne']({'invoice':_0xd012e2}),_0x1e794b=await warehouse[_0x5674f5(0xe5)]({'name':_0x282436,'room':_0x368482,'warehouse_category':_0x5674f5(0x169)});_0xd1225b[_0x5674f5(0x1e8)]['forEach'](_0xe2f449=>{var _0x80d40e=_0x5674f5,_0x3d77bd=0x0;const _0x42654b=_0x1e794b['product_details']['map'](_0x154022=>{var _0x263365=a0_0x1a54;_0x154022['product_name']==_0xe2f449[_0x263365(0xc7)]&&_0x154022[_0x263365(0x122)]==_0xe2f449[_0x263365(0x122)]&&_0x154022[_0x263365(0xec)]==_0xe2f449[_0x263365(0xec)]&&_0x154022['production_date']==_0xe2f449['production_date']&&_0x154022[_0x263365(0x1dc)]==_0xe2f449[_0x263365(0x1dc)]&&(_0x154022[_0x263365(0x1ab)]=parseInt(_0x154022['product_stock'])+parseInt(_0xe2f449[_0x263365(0x187)]),_0x3d77bd++);});_0x3d77bd=='0'&&(_0x1e794b['product_details']=_0x1e794b[_0x80d40e(0x1b2)][_0x80d40e(0x161)]({'product_name':_0xe2f449[_0x80d40e(0xc7)],'product_stock':_0xe2f449[_0x80d40e(0x187)],'primary_code':_0xe2f449[_0x80d40e(0xba)],'secondary_code':_0xe2f449[_0x80d40e(0x1c6)],'product_code':_0xe2f449[_0x80d40e(0x1c2)],'bay':_0xe2f449[_0x80d40e(0x122)],'batch_code':_0xe2f449[_0x80d40e(0x1dc)],'maxPerUnit':_0xe2f449['maxPerUnit'],'production_date':_0xe2f449['production_date'],'expiry_date':_0xe2f449['expiry_date'],'secondary_unit':_0xe2f449[_0x80d40e(0x1f3)],'unit':_0xe2f449[_0x80d40e(0x1ca)],'maxProducts':_0xe2f449[_0x80d40e(0x19b)]}));}),await _0x1e794b[_0x5674f5(0xdc)](),console[_0x5674f5(0xf5)](_0x3e79ac[_0x5674f5(0xb8)]);const _0x38e4af=new c_payment_data({'invoice':_0xd012e2,'customer':_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1a7)],'reason':_0x5674f5(0xd2)});await _0x38e4af[_0x5674f5(0xdc)]();const _0x37be16=await master_shop['find']();console[_0x5674f5(0xf5)](_0x5674f5(0xac),_0x37be16[0x0]['image']);const _0xbd6c1b=await email_settings[_0x5674f5(0xe5)](),_0x4addee=await customer[_0x5674f5(0xe5)]({'name':_0x3e79ac[_0x5674f5(0xb8)][_0x5674f5(0x1a7)]});console['log']('customer_data',_0x4addee);_0x37be16[0x0][_0x5674f5(0x143)]==0x1?(right_currency=_0x37be16[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x37be16[0x0][_0x5674f5(0x101)]);var _0x1c4e9a=_0x27f06b,_0x45a950=_0x1b286a,_0x44ecd1='',_0x3e0aa6;for(_0x3e0aa6 in _0x1c4e9a){_0x44ecd1+=_0x5674f5(0x1d5)+_0x5674f5(0xaf)+_0x1c4e9a[_0x3e0aa6]+_0x5674f5(0x19c)+_0x5674f5(0xaf)+_0x45a950[_0x3e0aa6]+_0x5674f5(0x19c)+_0x5674f5(0xf7);}console[_0x5674f5(0xf5)](_0x5674f5(0xf0),_0x44ecd1);let _0x5981d4=nodemailer[_0x5674f5(0x188)]({'service':_0x5674f5(0x182),'auth':{'user':_0xbd6c1b['email'],'pass':_0xbd6c1b['password']}}),_0x121477={'from':_0xbd6c1b['email'],'to':_0x4addee[_0x5674f5(0x170)],'subject':_0x5674f5(0x148),'attachments':[{'filename':_0x5674f5(0x180),'path':__dirname+_0x5674f5(0xa6)+'/upload/'+_0x37be16[0x0][_0x5674f5(0x113)],'cid':_0x5674f5(0x1dd)}],'html':_0x5674f5(0x12a)+_0x5674f5(0x13d)+_0x5674f5(0x1c4)+'<div>'+_0x5674f5(0x1b8)+_0x5674f5(0x145)+_0x5674f5(0xcb)+_0x5674f5(0x173)+_0x5674f5(0x145)+_0x5674f5(0x127)+_0x37be16[0x0][_0x5674f5(0xed)]+_0x5674f5(0x179)+_0x5674f5(0x173)+_0x5674f5(0x173)+_0x5674f5(0x110)+'<div>'+_0x5674f5(0x12c)+_0x5674f5(0x195)+_0xd012e2+'\x20'+_0x5674f5(0xf1)+'\x20Order\x20Date\x20:\x20'+_0x684260+'\x20'+'</span>'+_0x5674f5(0x17a)+_0x5674f5(0x173)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5674f5(0x19e)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x5674f5(0xa4)+_0x5674f5(0x17b)+'</tr>'+_0x5674f5(0x16b)+_0x5674f5(0x14f)+'\x20'+_0x44ecd1+'\x20'+'</tbody>'+'</table>'+_0x5674f5(0x145)+_0x5674f5(0xfc)+_0x5674f5(0x17e)+_0x37be16[0x0][_0x5674f5(0xed)]+_0x5674f5(0x17a)+_0x5674f5(0x173)+_0x5674f5(0x173)+_0x5674f5(0x166)};_0x5981d4[_0x5674f5(0xd4)](_0x121477,function(_0xb9297,_0x238a78){var _0x704d63=_0x5674f5;_0xb9297?(console['log'](_0xb9297),console['log'](_0x704d63(0x13c))):console[_0x704d63(0xf5)]('Email\x20sent\x20successfully');}),_0x3e79ac[_0x5674f5(0xde)](_0x5674f5(0x1f6),_0x5674f5(0xe2)),_0x12d1f1[_0x5674f5(0x125)](_0x5674f5(0xce));}catch(_0x3e8f47){console[_0x5674f5(0xf5)](_0x3e8f47),_0x12d1f1['status'](0xc8)[_0x5674f5(0x1f4)]({'message1':_0x3e8f47['message']});}}}),router[a0_0x234545(0x18b)](a0_0x234545(0x1b7),auth,async(_0x54b9d4,_0x5a0b14)=>{var _0x1f7334=a0_0x234545;try{const {username:_0x277ddd,email:_0x3947ee,role:_0x2d1e05}=_0x54b9d4['user'],_0x206d07=_0x54b9d4[_0x1f7334(0x149)],_0x464376=await profile[_0x1f7334(0xe5)]({'email':_0x206d07[_0x1f7334(0x170)]}),_0x5ed7a5=await master_shop[_0x1f7334(0x1b4)]();console[_0x1f7334(0xf5)](_0x1f7334(0xb6),_0x5ed7a5);const _0x5b46a8=_0x54b9d4['params']['id'],_0x54e0d3=await sales['findById'](_0x5b46a8);console[_0x1f7334(0xf5)](_0x1f7334(0x153),_0x54e0d3);if(_0x5ed7a5[0x0]['language']==_0x1f7334(0x1af))var _0x41646d=users[_0x1f7334(0x1d3)];else{if(_0x5ed7a5[0x0][_0x1f7334(0x1d8)]==_0x1f7334(0x114))var _0x41646d=users['Hindi'];else{if(_0x5ed7a5[0x0][_0x1f7334(0x1d8)]==_0x1f7334(0x1cf))var _0x41646d=users[_0x1f7334(0x1cf)];else{if(_0x5ed7a5[0x0]['language']=='Spanish')var _0x41646d=users['Spanish'];else{if(_0x5ed7a5[0x0][_0x1f7334(0x1d8)]==_0x1f7334(0x1c8))var _0x41646d=users['French'];else{if(_0x5ed7a5[0x0][_0x1f7334(0x1d8)]==_0x1f7334(0x189))var _0x41646d=users[_0x1f7334(0xe0)];else{if(_0x5ed7a5[0x0]['language']==_0x1f7334(0x17d))var _0x41646d=users[_0x1f7334(0x17d)];else{if(_0x5ed7a5[0x0][_0x1f7334(0x1d8)]==_0x1f7334(0x139))var _0x41646d=users[_0x1f7334(0x146)];}}}}}}}_0x5a0b14[_0x1f7334(0x121)]('all_sales_barcode',{'success':_0x54b9d4[_0x1f7334(0xde)](_0x1f7334(0x1f6)),'errors':_0x54b9d4[_0x1f7334(0xde)]('errors'),'role':_0x206d07,'profile':_0x464376,'alldata':_0x54e0d3,'master_shop':_0x5ed7a5,'language':_0x41646d});}catch(_0x19d6b4){console[_0x1f7334(0xf5)](_0x19d6b4);}}),router[a0_0x234545(0x1e2)](a0_0x234545(0x1e9),async(_0x28f870,_0x1b5e7d)=>{var _0x5c2cf9=a0_0x234545;const {product_code:_0x4bdb33,warehouse_name:_0x126cbd,rooms_data:_0x280677,Roomslist:_0x542f32,sales_category:_0x428c2b}=_0x28f870[_0x5c2cf9(0xb8)],_0x366554=_0x542f32[_0x5c2cf9(0x197)](','),_0x2634bd=[];async function _0x3ba535(_0x426d57){var _0x3f4f69=_0x5c2cf9;const _0xb0331a=await warehouse['aggregate']([{'$match':{'name':_0x126cbd,'room':_0x426d57}},{'$unwind':_0x3f4f69(0x1bc)},{'$match':{'product_details.primary_code':_0x4bdb33}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3f4f69(0xbf)},'product_stock':{'$first':_0x3f4f69(0x181)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3f4f69(0x1c9)},'level':{'$first':_0x3f4f69(0x156)},'bay':{'$first':_0x3f4f69(0xb9)},'type':{'$first':_0x3f4f69(0x11c)},'pallet':{'$first':_0x3f4f69(0xfd)},'unit':{'$first':_0x3f4f69(0x14c)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3f4f69(0x1df)},'rack':{'$first':_0x3f4f69(0x11a)},'expiry_date':{'$first':_0x3f4f69(0xda)},'production_date':{'$first':_0x3f4f69(0x14b)},'maxPerUnit':{'$first':_0x3f4f69(0x107)},'batch_code':{'$first':_0x3f4f69(0x175)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3f4f69(0x159)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x3f4f69(0x1ea)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x3f4f69(0x18f)}}}]),_0x210bfc=await warehouse[_0x3f4f69(0x16f)]([{'$match':{'name':_0x126cbd,'room':_0x426d57}},{'$unwind':_0x3f4f69(0x1bc)},{'$match':{'product_details.secondary_code':_0x4bdb33}},{'$group':{'_id':_0x3f4f69(0x1b5),'name':{'$first':_0x3f4f69(0xbf)},'product_stock':{'$first':_0x3f4f69(0x181)},'primary_code':{'$first':_0x3f4f69(0x160)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3f4f69(0x1c9)},'level':{'$first':_0x3f4f69(0xb9)},'isle':{'$first':_0x3f4f69(0x129)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3f4f69(0xfd)},'unit':{'$first':_0x3f4f69(0x14c)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3f4f69(0x11a)},'expiry_date':{'$first':_0x3f4f69(0xda)},'production_date':{'$first':_0x3f4f69(0x14b)},'maxPerUnit':{'$first':_0x3f4f69(0x107)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x3f4f69(0x196)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x3f4f69(0x147)},'uuid':{'$first':_0x3f4f69(0x1ea)},'gross_price':{'$first':_0x3f4f69(0x1a0)},'sales_category':{'$first':_0x3f4f69(0x18f)}}}]);if(_0xb0331a['length']>0x0)_0x2634bd['push'](_0xb0331a);else _0x210bfc[_0x3f4f69(0x142)]>0x0&&_0x2634bd['push'](_0x210bfc);}const _0x5f2360=_0x366554[_0x5c2cf9(0x136)](_0x2413ad=>_0x3ba535(_0x2413ad));await Promise[_0x5c2cf9(0x116)](_0x5f2360),_0x1b5e7d[_0x5c2cf9(0x1f4)](_0x2634bd);}),router[a0_0x234545(0x1e2)](a0_0x234545(0x151),async(_0x18ce9e,_0xf35a0f)=>{var _0xb4bd98=a0_0x234545;const {product_code:_0x1847bb,warehouse_name:_0x2dbe0f,rooms_data:_0x45550a,Roomslist:_0x118e77,sales_category:_0x287934}=_0x18ce9e['body'],_0x23a43d=_0x118e77[_0xb4bd98(0x197)](','),_0x425e86=[];async function _0x87489c(_0x5b58e2){var _0x42559c=_0xb4bd98;const _0x1c6d68=await warehouse[_0x42559c(0x16f)]([{'$match':{'name':_0x2dbe0f,'room':_0x5b58e2}},{'$unwind':_0x42559c(0x1bc)},{'$match':{'product_details.primary_code':_0x1847bb,'product_details.sales_category':_0x287934,'product_details.type_products':_0x42559c(0xf5)}},{'$group':{'_id':_0x42559c(0x1b5),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x42559c(0x181)},'primary_code':{'$first':_0x42559c(0x160)},'secondary_code':{'$first':_0x42559c(0x1cb)},'product_code':{'$first':_0x42559c(0x1c9)},'level':{'$first':'$product_details.level'},'bay':{'$first':_0x42559c(0xb9)},'type':{'$first':_0x42559c(0x11c)},'pallet':{'$first':_0x42559c(0xfd)},'unit':{'$first':_0x42559c(0x14c)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x42559c(0x1df)},'rack':{'$first':_0x42559c(0x11a)},'expiry_date':{'$first':_0x42559c(0xda)},'production_date':{'$first':_0x42559c(0x14b)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x42559c(0x196)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x42559c(0x159)},'invoice':{'$first':_0x42559c(0x147)},'uuid':{'$first':_0x42559c(0x1ea)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x42559c(0x18f)},'type_products':{'$first':_0x42559c(0x164)}}}]);console[_0x42559c(0xf5)](_0x42559c(0xf5)+_0x42559c(0x1bb)+_0x1847bb+_0x42559c(0x1bb)+_0x287934);const _0x2e8875=await warehouse['aggregate']([{'$match':{'name':_0x2dbe0f,'room':_0x5b58e2}},{'$unwind':_0x42559c(0x1bc)},{'$match':{'product_details.secondary_code':_0x1847bb,'product_details.sales_category':_0x287934,'product_details.type_products':'log'}},{'$group':{'_id':_0x42559c(0x1b5),'name':{'$first':_0x42559c(0xbf)},'product_stock':{'$first':_0x42559c(0x181)},'primary_code':{'$first':_0x42559c(0x160)},'secondary_code':{'$first':_0x42559c(0x1cb)},'product_code':{'$first':_0x42559c(0x1c9)},'level':{'$first':_0x42559c(0xb9)},'isle':{'$first':_0x42559c(0x129)},'type':{'$first':_0x42559c(0x11c)},'pallet':{'$first':_0x42559c(0xfd)},'unit':{'$first':_0x42559c(0x14c)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x42559c(0x1df)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x42559c(0x175)},'product_cat':{'$first':_0x42559c(0x196)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x42559c(0x159)},'invoice':{'$first':_0x42559c(0x147)},'uuid':{'$first':_0x42559c(0x1ea)},'gross_price':{'$first':_0x42559c(0x1a0)},'sales_category':{'$first':_0x42559c(0x18f)},'type_products':{'$first':'$product_details.type_products'}}}]);if(_0x1c6d68[_0x42559c(0x142)]>0x0)_0x425e86[_0x42559c(0xbd)](_0x1c6d68);else _0x2e8875[_0x42559c(0x142)]>0x0&&_0x425e86[_0x42559c(0xbd)](_0x2e8875);}const _0x4f7adb=_0x23a43d[_0xb4bd98(0x136)](_0x440aaf=>_0x87489c(_0x440aaf));await Promise[_0xb4bd98(0x116)](_0x4f7adb),_0xf35a0f[_0xb4bd98(0x1f4)](_0x425e86);}),router[a0_0x234545(0x1e2)](a0_0x234545(0x16c),async(_0x14e3ab,_0x9fbffa)=>{var _0x237d17=a0_0x234545;try{const {prduct_code:_0x20dad6,warehouse_data:_0x3e23d8,qty_req:_0x1c8a2b}=_0x14e3ab[_0x237d17(0xb8)];let _0x4aa70f=_0x20dad6[_0x237d17(0x197)]('~'),_0x1f0c90=_0x1c8a2b[_0x237d17(0x197)]('~'),_0x3c569e=[],_0x434d11=0x0;for(let _0xf92603=0x0;_0xf92603<=_0x4aa70f[_0x237d17(0x142)]-0x1;_0xf92603++){const _0x423d7a=_0x4aa70f[_0xf92603],_0x269809=_0x1f0c90[_0xf92603],_0x145c1c=await warehouse[_0x237d17(0x16f)]([{'$match':{'name':_0x3e23d8}},{'$unwind':_0x237d17(0x1bc)},{'$match':{'product_details.product_code':_0x423d7a,'product_details.isAvailable':_0x237d17(0x126),'product_details.isUsed':_0x237d17(0x1db)}},{'$sort':{'product_details.date_received':0x1,'product_details.level':-0x1,'product_details.bay':-0x1}},{'$group':{'_id':_0x237d17(0x1b5),'name':{'$first':_0x237d17(0xbf)},'product_stock':{'$first':_0x237d17(0x181)},'primary_code':{'$first':_0x237d17(0x160)},'secondary_code':{'$first':_0x237d17(0x1cb)},'product_code':{'$first':_0x237d17(0x1c9)},'level':{'$first':_0x237d17(0x156)},'bay':{'$first':_0x237d17(0xb9)},'type':{'$first':_0x237d17(0x11c)},'pallet':{'$first':_0x237d17(0xfd)},'unit':{'$first':_0x237d17(0x14c)},'secondary_unit':{'$first':_0x237d17(0x171)},'storage':{'$first':_0x237d17(0x1df)},'rack':{'$first':_0x237d17(0x11a)},'expiry_date':{'$first':_0x237d17(0xda)},'production_date':{'$first':_0x237d17(0x14b)},'maxPerUnit':{'$first':_0x237d17(0x107)},'batch_code':{'$first':_0x237d17(0x175)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x237d17(0x159)},'invoice':{'$first':_0x237d17(0x147)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x237d17(0x18f)},'date_received':{'$first':'$product_details.date_recieved'},'warehouse_id':{'$first':'$_id'}}}]),_0x3fa315=_0x145c1c[_0x237d17(0x1e6)]((_0x361dac,_0x3ee3ed)=>new Date(_0x361dac[_0x237d17(0xa5)])-new Date(_0x3ee3ed['date_received']));let _0x1fe332=_0x269809;for(let _0x318fc8=0x0;_0x318fc8<=_0x3fa315[_0x237d17(0x142)]-0x1&&_0x1fe332>0x0;_0x318fc8++){const _0x2f75d0=_0x3fa315[_0x318fc8];if(_0x2f75d0[_0x237d17(0x1c2)]==_0x423d7a){_0x3c569e[_0x434d11]={};const _0x557446=parseInt(_0x2f75d0[_0x237d17(0x1ab)]),_0x2d91c1=0x0;let _0x2374e3=_0x557446-_0x2d91c1,_0x2dd6b7=Math[_0x237d17(0xa7)](_0x1fe332,_0x2374e3);console[_0x237d17(0xf5)]('Distributing\x20'+_0x2dd6b7+'\x20units\x20to\x20warehouse:\x20'+_0x3e23d8+_0x237d17(0x1b1)+_0x2f75d0[_0x237d17(0xb7)]+_0x237d17(0x144)+(_0x2f75d0['level']+_0x2f75d0[_0x237d17(0x122)])+_0x237d17(0x106)+_0x2f75d0['date_received']+_0x237d17(0x1a6)+_0x2f75d0[_0x237d17(0xe8)]),_0x3c569e[_0x434d11][_0x237d17(0x1d6)]=_0x2f75d0['warehouse_id']+'~'+_0x2f75d0['_id']+'~'+_0x2dd6b7,_0x3c569e[_0x434d11][_0x237d17(0xc7)]=_0x2f75d0['name'],_0x3c569e[_0x434d11][_0x237d17(0x1c2)]=_0x2f75d0[_0x237d17(0x1c2)],_0x3c569e[_0x434d11]['product_id']=_0x2f75d0['product_id'],_0x3c569e[_0x434d11]['date_recieved']=_0x2f75d0[_0x237d17(0x1c0)],_0x3c569e[_0x434d11]['sales_category']=_0x2f75d0['sales_category'],_0x3c569e[_0x434d11][_0x237d17(0xd5)]=_0x2f75d0[_0x237d17(0xd5)],_0x3c569e[_0x434d11][_0x237d17(0xd7)]=_0x2dd6b7,_0x3c569e[_0x434d11][_0x237d17(0x1ca)]=_0x2f75d0[_0x237d17(0x1ca)],_0x3c569e[_0x434d11][_0x237d17(0x1f3)]=_0x2f75d0[_0x237d17(0x1f3)],_0x3c569e[_0x434d11][_0x237d17(0xba)]=_0x2f75d0[_0x237d17(0xba)],_0x3c569e[_0x434d11]['secondary_code']=_0x2f75d0[_0x237d17(0x1c6)],_0x3c569e[_0x434d11]['maxStocks']=_0x2f75d0[_0x237d17(0x1da)],_0x3c569e[_0x434d11][_0x237d17(0x1dc)]=_0x2f75d0[_0x237d17(0x1dc)],_0x3c569e[_0x434d11][_0x237d17(0xec)]=_0x2f75d0[_0x237d17(0xec)],_0x3c569e[_0x434d11][_0x237d17(0x13e)]=_0x2f75d0[_0x237d17(0x13e)],_0x3c569e[_0x434d11][_0x237d17(0xd6)]=_0x2f75d0[_0x237d17(0xd6)],_0x3c569e[_0x434d11][_0x237d17(0x1ec)]=_0x2f75d0[_0x237d17(0x1ec)],_0x3c569e[_0x434d11][_0x237d17(0x19d)]=_0x2f75d0[_0x237d17(0x19d)],_0x3c569e[_0x434d11]['gross_price']=_0x2f75d0[_0x237d17(0x10b)],_0x3c569e[_0x434d11]['room_name']=_0x2f75d0['roomNamed'],_0x3c569e[_0x434d11][_0x237d17(0x15a)]=_0x2f75d0[_0x237d17(0x15a)],_0x3c569e[_0x434d11][_0x237d17(0x122)]=_0x2f75d0[_0x237d17(0x122)],_0x3c569e[_0x434d11][_0x237d17(0xbc)]=_0x237d17(0x126),console[_0x237d17(0xf5)]('1',_0x434d11),_0x1fe332-=_0x2dd6b7,_0x434d11++;if(_0x1fe332<=0x0)break;}}if(_0x1fe332>0x0){var _0x453878=await product['findOne']({'product_code':_0x423d7a});console[_0x237d17(0xf5)]('2',_0x434d11),_0x3c569e[_0x434d11]={},_0x3c569e[_0x434d11]['product_name']=_0x453878['name'],_0x3c569e[_0x434d11][_0x237d17(0x1c2)]=_0x423d7a,_0x3c569e[_0x434d11][_0x237d17(0x1c7)]=_0x453878['_id']['valueOf'](),_0x3c569e[_0x434d11][_0x237d17(0xd7)]=_0x1fe332,_0x3c569e[_0x434d11][_0x237d17(0x135)]=_0x453878['unit'],_0x3c569e[_0x434d11][_0x237d17(0x1f3)]=_0x453878['second_unit'],_0x3c569e[_0x434d11][_0x237d17(0xba)]=_0x453878[_0x237d17(0xba)],_0x3c569e[_0x434d11][_0x237d17(0x1c6)]=_0x453878[_0x237d17(0x1c6)],_0x3c569e[_0x434d11]['maxStocks']=_0x453878[_0x237d17(0x1da)],_0x3c569e[_0x434d11][_0x237d17(0xd6)]=_0x453878[_0x237d17(0xb0)],_0x3c569e[_0x434d11][_0x237d17(0x10b)]=_0x453878['gross_price'],_0x3c569e[_0x434d11]['status']=_0x237d17(0x1db),console[_0x237d17(0xf5)]('There\x20is\x20'+_0x1fe332+_0x237d17(0x117)+_0x434d11+_0x237d17(0x1bb)+_0x423d7a),_0x434d11++;}}_0x9fbffa[_0x237d17(0x1f4)](_0x3c569e);}catch(_0x54c9e3){console['log'](_0x54c9e3);}}),router[a0_0x234545(0x1e2)](a0_0x234545(0x183),async(_0x3ba2bc,_0x1d3fd9)=>{var _0x44bdc0=a0_0x234545;const {product_code:_0x5d43c1}=_0x3ba2bc[_0x44bdc0(0xb8)];var _0x1e5091;const _0x530e95=await product[_0x44bdc0(0x16f)]([{'$match':{'primary_code':_0x5d43c1}},{'$group':{'_id':_0x44bdc0(0x1b3),'name':{'$first':_0x44bdc0(0x1bd)},'category':{'$first':_0x44bdc0(0x165)},'brand':{'$first':_0x44bdc0(0x1aa)},'unit':{'$first':_0x44bdc0(0xd8)},'alertquantity':{'$first':_0x44bdc0(0xeb)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x44bdc0(0xcd)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x44bdc0(0xc0)},'maxProdPerUnit':{'$first':_0x44bdc0(0x14d)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x44bdc0(0xb5)},'gross_price':{'$first':_0x44bdc0(0x141)},'sales_category':{'$first':_0x44bdc0(0xab)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x4975db=await product[_0x44bdc0(0x16f)]([{'$match':{'secondary_code':_0x5d43c1}},{'$group':{'_id':_0x44bdc0(0x1b3),'name':{'$first':_0x44bdc0(0x1bd)},'category':{'$first':_0x44bdc0(0x165)},'brand':{'$first':_0x44bdc0(0x1aa)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x44bdc0(0xeb)},'product_code':{'$first':_0x44bdc0(0xe6)},'primary_code':{'$first':_0x44bdc0(0xcd)},'secondary_code':{'$first':_0x44bdc0(0xc2)},'maxStocks':{'$first':_0x44bdc0(0xc0)},'maxProdPerUnit':{'$first':_0x44bdc0(0x14d)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x44bdc0(0xb5)},'gross_price':{'$first':'$gross_price'},'sales_category':{'$first':'$sales_category'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x530e95[_0x44bdc0(0x142)]>0x0)_0x1e5091=_0x530e95;else _0x4975db[_0x44bdc0(0x142)]>0x0&&(_0x1e5091=_0x4975db);_0x1d3fd9[_0x44bdc0(0x1f4)](_0x1e5091);}),router[a0_0x234545(0x1e2)]('/process/view',async(_0x441b65,_0x3ab532)=>{var _0x3eca55=a0_0x234545;try{const {group_id:_0x502aff,DRSI:_0x42f7f4,dateofreq:_0x477435,PO_number:_0x4cd908,date:_0x387302,warehouse_name:_0xbcc447,typevehicle:_0x33b62a,deliverydate:_0x228aae,driver:_0x4d3e9d,plate:_0x5c0ecf,van:_0x1eff19,TSU:_0x576bbc,actual_delivery_date:_0x5254d9,TFU:_0x324110,pull_out_date:_0x5e3ad5,sales:_0x771ddd,Customer_data:_0x4765ae,note:_0x54cb2b}=_0x441b65['body'],_0x23abf2=mongoose[_0x3eca55(0x11e)]['ObjectId'];let _0x121b93=[];const _0x435284=new invoice_for_outgoing();await _0x435284['save']();const _0x3c5439='OUT-'+_0x435284[_0x3eca55(0x1ed)][_0x3eca55(0x119)]()[_0x3eca55(0x1ee)](0x8,'0');if(typeof _0x502aff==_0x3eca55(0x11b)){let _0x5c8212=_0x502aff[_0x3eca55(0x197)]('~');var _0x381256=_0x23abf2(_0x5c8212[0x0]),_0x20942c=_0x23abf2(_0x5c8212[0x1]),_0xa4f1af=_0x5c8212[0x2];let _0x15f93e=0x0;const _0x17aa1a=await warehouse[_0x3eca55(0x16f)]([{'$match':{'_id':_0x381256}},{'$unwind':_0x3eca55(0x1bc)},{'$match':{'product_details._id':_0x20942c}}]);await warehouse[_0x3eca55(0x192)]({'_id':_0x23abf2(_0x381256),'product_details._id':_0x23abf2(_0x20942c)},{'$set':{'product_details.$.isUsed':'true'}}),_0x121b93[_0x15f93e]={};for(let _0x37ae37=0x0;_0x37ae37<=_0x17aa1a[_0x3eca55(0x142)]-0x1;_0x37ae37++){const _0x31ff20=_0x17aa1a[_0x37ae37];console[_0x3eca55(0xf5)](_0x31ff20),_0x121b93[_0x15f93e][_0x3eca55(0x10c)]=_0x31ff20[_0x3eca55(0xe8)],_0x121b93[_0x15f93e][_0x3eca55(0x1c7)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x1c7)],_0x121b93[_0x15f93e]['product_name']=_0x31ff20['product_details'][_0x3eca55(0xc7)],_0x121b93[_0x15f93e]['product_code']=_0x31ff20[_0x3eca55(0x1b2)]['product_code'],_0x121b93[_0x15f93e][_0x3eca55(0x1ab)]=_0xa4f1af,_0x121b93[_0x15f93e][_0x3eca55(0xd7)]=_0xa4f1af,_0x121b93[_0x15f93e][_0x3eca55(0x1ca)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x1ca)],_0x121b93[_0x15f93e][_0x3eca55(0x1f3)]=_0x31ff20['product_details'][_0x3eca55(0x1f3)],_0x121b93[_0x15f93e][_0x3eca55(0x15a)]=_0x31ff20[_0x3eca55(0x1b2)]['level'],_0x121b93[_0x15f93e][_0x3eca55(0x122)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x122)],_0x121b93[_0x15f93e][_0x3eca55(0xba)]=_0x31ff20['product_details']['primary_code'],_0x121b93[_0x15f93e][_0x3eca55(0x1c6)]=_0x31ff20[_0x3eca55(0x1b2)]['secondary_code'],_0x121b93[_0x15f93e][_0x3eca55(0x1da)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x1da)],_0x121b93[_0x15f93e]['batch_code']=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x1dc)],_0x121b93[_0x15f93e][_0x3eca55(0xec)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0xec)],_0x121b93[_0x15f93e]['production_date']=_0x31ff20['product_details'][_0x3eca55(0x13e)],_0x121b93[_0x15f93e][_0x3eca55(0xd6)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0xd6)],_0x121b93[_0x15f93e][_0x3eca55(0x1ec)]=_0x31ff20[_0x3eca55(0x1b2)]['product_cat'],_0x121b93[_0x15f93e][_0x3eca55(0x194)]=_0x31ff20[_0x3eca55(0x1a3)],_0x121b93[_0x15f93e][_0x3eca55(0x19d)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x19d)],_0x121b93[_0x15f93e][_0x3eca55(0xd5)]=_0x31ff20['product_details'][_0x3eca55(0xd5)],_0x121b93[_0x15f93e]['gross_price']=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x10b)],_0x121b93[_0x15f93e][_0x3eca55(0xea)]=_0x31ff20['product_details'][_0x3eca55(0x185)],_0x121b93[_0x15f93e][_0x3eca55(0x1c0)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x1c0)],_0x121b93[_0x15f93e][_0x3eca55(0x1c1)]=_0x31ff20['product_details']['sales'],_0x121b93[_0x15f93e]['warehouse_id']=_0x31ff20[_0x3eca55(0x1b9)]['valueOf'](),_0x121b93[_0x15f93e][_0x3eca55(0x1d4)]=_0x31ff20['product_details'][_0x3eca55(0x1b9)][_0x3eca55(0xff)](),_0x121b93[_0x15f93e][_0x3eca55(0xd9)]='out',_0x121b93[_0x15f93e][_0x3eca55(0x1b0)]=_0x31ff20[_0x3eca55(0x1b2)][_0x3eca55(0x185)];}_0x121b93[_0x15f93e][_0x3eca55(0xaa)]=_0x3c5439;}else for(let _0x19961f=0x0;_0x19961f<=_0x502aff[_0x3eca55(0x142)]-0x1;_0x19961f++){const _0x59a339=_0x502aff[_0x19961f];let _0x3df2f2=_0x59a339['split']('~');console[_0x3eca55(0xf5)](_0x3df2f2);var _0x381256=_0x23abf2(_0x3df2f2[0x0]),_0x20942c=_0x23abf2(_0x3df2f2[0x1]),_0xa4f1af=_0x3df2f2[0x2];const _0xb38949=await warehouse[_0x3eca55(0x16f)]([{'$match':{'_id':_0x381256}},{'$unwind':_0x3eca55(0x1bc)},{'$match':{'product_details._id':_0x20942c}}]);await warehouse[_0x3eca55(0x192)]({'_id':_0x23abf2(_0x381256),'product_details._id':_0x23abf2(_0x20942c)},{'$set':{'product_details.$.isUsed':_0x3eca55(0x126)}}),_0x121b93[_0x19961f]={};for(let _0x14fd17=0x0;_0x14fd17<=_0xb38949[_0x3eca55(0x142)]-0x1;_0x14fd17++){const _0x349296=_0xb38949[_0x14fd17];_0x121b93[_0x19961f][_0x3eca55(0x10c)]=_0x349296['name'],_0x121b93[_0x19961f][_0x3eca55(0x1c7)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x1c7)],_0x121b93[_0x19961f][_0x3eca55(0xc7)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0xc7)],_0x121b93[_0x19961f]['product_code']=_0x349296[_0x3eca55(0x1b2)]['product_code'],_0x121b93[_0x19961f][_0x3eca55(0x1ab)]=_0xa4f1af,_0x121b93[_0x19961f]['quantity']=_0xa4f1af,_0x121b93[_0x19961f][_0x3eca55(0x1ca)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x1ca)],_0x121b93[_0x19961f][_0x3eca55(0x1f3)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x1f3)],_0x121b93[_0x19961f][_0x3eca55(0x15a)]=_0x349296['product_details'][_0x3eca55(0x15a)],_0x121b93[_0x19961f][_0x3eca55(0x122)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x122)],_0x121b93[_0x19961f]['primary_code']=_0x349296['product_details']['primary_code'],_0x121b93[_0x19961f][_0x3eca55(0x1c6)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x1c6)],_0x121b93[_0x19961f][_0x3eca55(0x1da)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x1da)],_0x121b93[_0x19961f][_0x3eca55(0x1dc)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x1dc)],_0x121b93[_0x19961f]['expiry_date']=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0xec)],_0x121b93[_0x19961f][_0x3eca55(0x13e)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x13e)],_0x121b93[_0x19961f][_0x3eca55(0xd6)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0xd6)],_0x121b93[_0x19961f]['product_cat']=_0x349296['product_details'][_0x3eca55(0x1ec)],_0x121b93[_0x19961f][_0x3eca55(0x194)]=_0x349296[_0x3eca55(0x1a3)],_0x121b93[_0x19961f][_0x3eca55(0x19d)]=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x19d)],_0x121b93[_0x19961f][_0x3eca55(0xd5)]=_0x349296[_0x3eca55(0x1b2)]['uuid'],_0x121b93[_0x19961f][_0x3eca55(0x10b)]=_0x349296[_0x3eca55(0x1b2)]['gross_price'],_0x121b93[_0x19961f]['sales_category']=_0x349296['product_details'][_0x3eca55(0x185)],_0x121b93[_0x19961f]['date_recieved']=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x1c0)],_0x121b93[_0x19961f]['sales_id']=_0x349296[_0x3eca55(0x1b2)][_0x3eca55(0x185)],_0x121b93[_0x19961f][_0x3eca55(0x1ba)]=_0x349296[_0x3eca55(0x1b9)][_0x3eca55(0xff)](),_0x121b93[_0x19961f][_0x3eca55(0x1d4)]=_0x349296[_0x3eca55(0x1b2)]['_id'][_0x3eca55(0xff)](),_0x121b93[_0x19961f][_0x3eca55(0xd9)]='out',_0x121b93[_0x19961f]['agent_id']=_0x349296[_0x3eca55(0x1b2)]['sales'];}_0x121b93[_0x19961f][_0x3eca55(0xaa)]=_0x3c5439;}for(let _0x16cf65=0x0;_0x16cf65<=_0x121b93[_0x3eca55(0x142)]-0x1;_0x16cf65++){const _0x35e0f1=_0x121b93[_0x16cf65],_0x31db8d=new warehouse_temporary(_0x35e0f1);await _0x31db8d[_0x3eca55(0xdc)]();}const _0x32e6da=new sales_finished({'invoice':_0x3c5439,'sales_data':_0x771ddd,'customer':_0x4765ae,'date':_0x387302,'warehouse_name':_0xbcc447,'sale_product':_0x121b93,'note':_0x54cb2b,'finalize':'False','dateofreq':_0x477435,'PO_number':_0x4cd908,'typevehicle':_0x33b62a,'deliverydate':_0x228aae,'driver':_0x4d3e9d,'plate':_0x5c0ecf,'van':_0x1eff19,'DRSI':_0x42f7f4,'TSU':_0x576bbc,'TFU':_0x324110,'pullout_date':_0x5e3ad5,'actualdelivery_date':_0x5254d9,'typeOfProducts':_0x3eca55(0x15d)}),_0x19bd23=await _0x32e6da['save']();_0x441b65[_0x3eca55(0xde)](_0x3eca55(0x1f6),'Sales\x20Add\x20successfully'),_0x3ab532[_0x3eca55(0x125)]('/all_sales_finished/preview/'+_0x19bd23[_0x3eca55(0x1b9)]);}catch(_0x5627a7){console[_0x3eca55(0xf5)](_0x5627a7);}}),module[a0_0x234545(0xad)]=router;function a0_0x419e(){var _0x1602d7=['adjust_qty','2210559EmdnLL','<strong>\x20Regards\x20</strong>','$product_details.floorlevel','then','valueOf','product_code_QA','currency','stock','2383496efBupp','Sales\x20Update\x20successfully','sales_invoice','\x20Date:\x20','$product_details.maxPerUnit','/view/add_sales/:id','outgoing_invoice','Received\x20Payment\x20For\x20Sale','gross_price','warehouse','nodemailer','</tbody>','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','<hr\x20class=\x22my-3\x22>','sale_qty','level2','image','Hindi','\x20==\x20','all','\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20','return_data','toString','$product_details.rack','string','$product_details.type','all_sales_finished_logs','Types','warehouse_name','params','render','bay','return_qty_QA','/picking_list/pdf/','redirect','true','<h2>\x20','/all_sales_finished/preview/','$product_details.bin','<!DOCTYPE\x20html>','due_amount','<h5\x20style=\x22text-align:\x20left;\x22>','prod_cat','/view/return_sales/:id','$finalize','payment\x20successfull','../models/all_models','edit_sales_finished','True','role','standard_unit','map','$note','sales_quantity_QA','Arabic\x20(ae)','max_per_unit','date_data','Error\x20Occurs','<html><head><title></title>','production_date','carton','Sales\x20Add\x20successfully','$gross_price','length','currency_placement',',\x20Location:\x20','<div>','Arabic','$product_details.invoice','Sale\x20Return\x20Mail','user','foreach\x20newproduct','$product_details.production_date','$product_details.unit','$maxProdPerUnit','sale_product','<tbody\x20style=\x22text-align:\x20center;\x22>','</span>','/barcode_scanner_logs','unit_QA','barcode\x20user_id','RoomAssigned','/invoice/:id','$product_details.level','errors','10khvemx','$room','level','8187201KvfMFu','maxProducts_QA','own','product_date','stock_data','$product_details.primary_code','concat','/upload/','../middleware/auth','$product_details.type_products','$category','</body></html>','\x20&&\x20','primary_code_QA','Finished\x20Goods','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','</thead>','/barcode_scanner_auto_data','secondary_unit_QA','$customers_docs','aggregate','email','$product_details.secondary_unit','filter','</div>','$invoice','$product_details.batch_code','slice','staff','amount','\x20</h2>','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','abs','Chinese','<h5>','prod_code','Logo.png','$product_details.product_stock','gmail','/barcode_scanner_auto','return_sale_finished','sales','$sale_product.bay','return_qty','createTransport','Portuguese\x20(BR)','OUTF-','get','secondary_code_QA','False','/view/add_sales_logs','$product_details.sales_category','2uSTsCe','sales_quantity','updateOne','edit_sales_finished_view','room_name','\x20Order\x20Number\x20:\x20','$product_details.product_cat','split','Spanish','Return\x20Goods','3032285IjHoSo','maxProducts','</td>','invoice','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','184DEEcjG','$product_details.gross_price','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','room','express','add_sales_finished_logs','\x20Name:\x20','customer','$customer','Quality\x20Inspection','$brand','product_stock','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/preview/:id','id_transaction_from','English\x20(US)','agent_id',',\x20room:\x20','product_details','$_id','find','$product_details._id','648144zyGHeH','/barcode/:id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','_id','warehouse_id','\x20<>\x20','$product_details','$name','message','/all_sales/view','date_recieved','sales_id','product_code','Enabled','</head><body>','master','secondary_code','product_id','French','$product_details.product_code','unit','$product_details.secondary_code','161845ccyPfV','$sale_product.type','$sale_product.bin','German','here','for_categorize','stocks_QA','English','warehouse_id_detl','<tr>','group_ids','../public/language/languages.json','language','6VMWgmN','maxStocks','false','batch_code','logo','/view/:id','$product_details.storage','random','/view/add_sale/product','post','</table>','date','findById','sort','product_name_QA1','return_sale','/barcode_scanner','$product_details.uuid','suppliers','product_cat','invoice_init','padStart','Enclosed','int','match','getFullYear','secondary_unit','json','OUT-','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','date_received','/../public','min','getDate','Email\x20sent\x20successfully','outgoiug_inv','$sales_category','add\x20post','exports','maxPerUnit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','maxProdPerUnit','maxPerUnit_QA','$product_details.maxProducts','$sale_product.floorlevel','$sale_product','$secondary_unit','barcode\x20Product\x20master','roomNamed','body','$product_details.bay','primary_code','$return_data','status','push','prod_invoice','$product_details.product_name','$maxStocks','product','$secondary_code','forEach','back','product_data','primary_unit','product_name','return_sale_QA','logs','production_date_QA','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','catch','$primary_code','/all_sales_finished/view','expiry_date_QA','received_amount','finalize','Sale\x20Return','undefined','sendMail','uuid','maxperunit','quantity','$unit','data_type','$product_details.expiry_date','$warehouse_name','save','max','flash','getMonth','Portuguese','$date','sales\x20item\x20return\x20successfull','Router','Ambient','findOne','$product_code','$sale_product.quantity','name','batch_code_QA','sales_category','$alertquantity','expiry_date','site_title','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','$product_details.room_name','product_list','<span\x20style=\x22float:\x20right;\x22>','\x20Order\x20Date\x20:\x20','all_sales_finished','LOG-OUT-','log','257643ZNdBby','</tr>','/view/add_sales','$product'];a0_0x419e=function(){return _0x1602d7;};return a0_0x419e();}