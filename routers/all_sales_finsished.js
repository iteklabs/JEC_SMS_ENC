var a0_0x2f8a4e=a0_0x109b;(function(_0x9ecda0,_0x5a3e89){var _0x95753e=a0_0x109b,_0x1d6f41=_0x9ecda0();while(!![]){try{var _0x1f21e1=-parseInt(_0x95753e(0x18b))/0x1+parseInt(_0x95753e(0x1ff))/0x2+-parseInt(_0x95753e(0x1ad))/0x3*(parseInt(_0x95753e(0x128))/0x4)+-parseInt(_0x95753e(0x197))/0x5*(-parseInt(_0x95753e(0x1fb))/0x6)+-parseInt(_0x95753e(0x20e))/0x7*(-parseInt(_0x95753e(0x1ba))/0x8)+-parseInt(_0x95753e(0x1bb))/0x9+parseInt(_0x95753e(0x164))/0xa;if(_0x1f21e1===_0x5a3e89)break;else _0x1d6f41['push'](_0x1d6f41['shift']());}catch(_0x3fc99d){_0x1d6f41['push'](_0x1d6f41['shift']());}}}(a0_0x2bb0,0x9801d));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require('../models/all_models'),auth=require(a0_0x2f8a4e(0x1d3)),nodemailer=require('nodemailer'),users=require(a0_0x2f8a4e(0x187));router['get'](a0_0x2f8a4e(0x1fd),auth,async(_0x4db684,_0x50c677)=>{var _0x519b32=a0_0x2f8a4e;try{const {username:_0x29da1d,email:_0x2f26ca,role:_0x356d68}=_0x4db684[_0x519b32(0x18f)],_0x4f26be=_0x4db684[_0x519b32(0x18f)],_0x405216=await profile[_0x519b32(0x1d4)]({'email':_0x4f26be[_0x519b32(0x220)]}),_0x80184b=await master_shop[_0x519b32(0x234)]();let _0x1b994d;if(_0x4f26be[_0x519b32(0x19c)]==_0x519b32(0x1f7)){const _0x4c9bb5=await staff[_0x519b32(0x1d4)]({'email':_0x4f26be[_0x519b32(0x220)]});_0x1b994d=await sales_finished[_0x519b32(0x235)]([{'$match':{'typeOfProducts':_0x519b32(0x12f)}},{'$unwind':_0x519b32(0x180)},{'$group':{'_id':_0x519b32(0x165),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x519b32(0x178)},'date':{'$first':_0x519b32(0x20f)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x519b32(0x180)},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x519b32(0x1ca)},'total_saleproduct_quantity':{'$sum':_0x519b32(0x19a)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x519b32(0x162)},'type':{'$addToSet':_0x519b32(0x1bf)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x519b32(0x12a)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x1b994d=await sales_finished[_0x519b32(0x235)]([{'$match':{'typeOfProducts':_0x519b32(0x12f)}},{'$unwind':_0x519b32(0x180)},{'$group':{'_id':_0x519b32(0x165),'invoice':{'$first':_0x519b32(0x1ee)},'customers':{'$first':'$customer'},'date':{'$first':_0x519b32(0x20f)},'warehouse_name':{'$first':_0x519b32(0x1d2)},'sale_product':{'$push':_0x519b32(0x180)},'note':{'$first':_0x519b32(0x16d)},'return_data':{'$first':_0x519b32(0x217)},'customers_docs':{'$first':_0x519b32(0x1ca)},'total_saleproduct_quantity':{'$sum':_0x519b32(0x19a)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x519b32(0x162)},'type':{'$addToSet':_0x519b32(0x1bf)},'pallet':{'$addToSet':_0x519b32(0x203)},'finalize':{'$first':_0x519b32(0x12a)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x80184b[0x0][_0x519b32(0x210)]==_0x519b32(0x231)){var _0x5dc9db=users[_0x519b32(0x20c)];console['log'](_0x5dc9db);}else{if(_0x80184b[0x0]['language']==_0x519b32(0x208))var _0x5dc9db=users['Hindi'];else{if(_0x80184b[0x0][_0x519b32(0x210)]=='German')var _0x5dc9db=users[_0x519b32(0x18e)];else{if(_0x80184b[0x0][_0x519b32(0x210)]==_0x519b32(0x125))var _0x5dc9db=users[_0x519b32(0x125)];else{if(_0x80184b[0x0][_0x519b32(0x210)]==_0x519b32(0x246))var _0x5dc9db=users[_0x519b32(0x246)];else{if(_0x80184b[0x0][_0x519b32(0x210)]=='Portuguese\x20(BR)')var _0x5dc9db=users[_0x519b32(0x1b0)];else{if(_0x80184b[0x0][_0x519b32(0x210)]=='Chinese')var _0x5dc9db=users[_0x519b32(0x1a5)];else{if(_0x80184b[0x0][_0x519b32(0x210)]=='Arabic\x20(ae)')var _0x5dc9db=users[_0x519b32(0x1b3)];}}}}}}}_0x50c677['render'](_0x519b32(0x1c1),{'success':_0x4db684['flash'](_0x519b32(0x228)),'errors':_0x4db684[_0x519b32(0x1d7)]('errors'),'sales':_0x1b994d,'profile':_0x405216,'role':_0x4f26be,'master_shop':_0x80184b,'language':_0x5dc9db});}catch(_0x58589d){console[_0x519b32(0x202)](_0x58589d);}}),router[a0_0x2f8a4e(0x18d)]('/view_log',auth,async(_0x494bd0,_0x49b744)=>{var _0x45d9f1=a0_0x2f8a4e;try{const {username:_0x6f5a99,email:_0xcb3142,role:_0x526b93}=_0x494bd0[_0x45d9f1(0x18f)],_0x1a7111=_0x494bd0[_0x45d9f1(0x18f)],_0xc67dec=await profile[_0x45d9f1(0x1d4)]({'email':_0x1a7111['email']}),_0x3e9fa7=await master_shop[_0x45d9f1(0x234)]();let _0x22893e;if(_0x1a7111[_0x45d9f1(0x19c)]==_0x45d9f1(0x1f7)){const _0x4797bb=await staff[_0x45d9f1(0x1d4)]({'email':_0x1a7111[_0x45d9f1(0x220)]});_0x22893e=await sales_finished[_0x45d9f1(0x235)]([{'$match':{'typeOfProducts':_0x45d9f1(0x1fe)}},{'$unwind':_0x45d9f1(0x180)},{'$group':{'_id':_0x45d9f1(0x165),'invoice':{'$first':_0x45d9f1(0x1ee)},'customers':{'$first':_0x45d9f1(0x178)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x45d9f1(0x180)},'note':{'$first':'$note'},'return_data':{'$first':_0x45d9f1(0x217)},'customers_docs':{'$first':_0x45d9f1(0x1ca)},'total_saleproduct_quantity':{'$sum':_0x45d9f1(0x19a)},'level':{'$addToSet':_0x45d9f1(0x20b)},'isle':{'$addToSet':_0x45d9f1(0x162)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x45d9f1(0x203)},'finalize':{'$first':_0x45d9f1(0x12a)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x22893e=await sales_finished[_0x45d9f1(0x235)]([{'$match':{'typeOfProducts':'logs'}},{'$unwind':_0x45d9f1(0x180)},{'$group':{'_id':_0x45d9f1(0x165),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':_0x45d9f1(0x20f)},'warehouse_name':{'$first':_0x45d9f1(0x1d2)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x45d9f1(0x16d)},'return_data':{'$first':_0x45d9f1(0x217)},'customers_docs':{'$first':_0x45d9f1(0x1ca)},'total_saleproduct_quantity':{'$sum':_0x45d9f1(0x19a)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x45d9f1(0x162)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x45d9f1(0x203)},'finalize':{'$first':_0x45d9f1(0x12a)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x3e9fa7[0x0][_0x45d9f1(0x210)]==_0x45d9f1(0x231)){var _0x210ff2=users[_0x45d9f1(0x20c)];console[_0x45d9f1(0x202)](_0x210ff2);}else{if(_0x3e9fa7[0x0]['language']==_0x45d9f1(0x208))var _0x210ff2=users[_0x45d9f1(0x208)];else{if(_0x3e9fa7[0x0]['language']==_0x45d9f1(0x18e))var _0x210ff2=users[_0x45d9f1(0x18e)];else{if(_0x3e9fa7[0x0][_0x45d9f1(0x210)]==_0x45d9f1(0x125))var _0x210ff2=users[_0x45d9f1(0x125)];else{if(_0x3e9fa7[0x0][_0x45d9f1(0x210)]==_0x45d9f1(0x246))var _0x210ff2=users[_0x45d9f1(0x246)];else{if(_0x3e9fa7[0x0][_0x45d9f1(0x210)]==_0x45d9f1(0x198))var _0x210ff2=users['Portuguese'];else{if(_0x3e9fa7[0x0][_0x45d9f1(0x210)]==_0x45d9f1(0x1a5))var _0x210ff2=users[_0x45d9f1(0x1a5)];else{if(_0x3e9fa7[0x0][_0x45d9f1(0x210)]==_0x45d9f1(0x186))var _0x210ff2=users[_0x45d9f1(0x1b3)];}}}}}}}_0x49b744[_0x45d9f1(0x1c9)](_0x45d9f1(0x1f9),{'success':_0x494bd0[_0x45d9f1(0x1d7)](_0x45d9f1(0x228)),'errors':_0x494bd0[_0x45d9f1(0x1d7)](_0x45d9f1(0x224)),'sales':_0x22893e,'profile':_0xc67dec,'role':_0x1a7111,'master_shop':_0x3e9fa7,'language':_0x210ff2});}catch(_0x1ef770){console[_0x45d9f1(0x202)](_0x1ef770);}});async function getRandom8DigitNumber(){var _0x52561d=a0_0x2f8a4e;const _0x208105=0x989680,_0x4485f8=0x5f5e0ff,_0x1af711=Math[_0x52561d(0x13d)](Math['random']()*(_0x4485f8-_0x208105+0x1))+_0x208105;var _0x2a4efb;const _0x1d7430=await sales_finished['findOne']({'invoice':_0x52561d(0x206)+_0x1af711});return _0x1d7430&&_0x1d7430[_0x52561d(0x22f)]>0x0?_0x2a4efb=_0x52561d(0x206)+_0x1af711:_0x2a4efb=_0x52561d(0x206)+_0x1af711,_0x2a4efb;}function a0_0x2bb0(){var _0x1d835d=['<div>','Portuguese','batch_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Arabic','$room','createTransport','$product_details.bin','json','Error\x20Occurs','prod_code','2991192aTbOkK','8998947xtCZJV','Sale\x20Return','suppliers','product_data','$sale_product.type','add\x20post','all_sales_finished','adjust_qty','$product_details.storage','max_per_unit','warehouse','stock','<h2>\x20','filter','render','$customers_docs','customer','updateOne','/../public','\x20==\x20','quantity','sales\x20item\x20return\x20successfull','</div>','$warehouse_name','../middleware/auth','findOne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$product_details.uuid','flash','</table>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view/add_sales','$name','id_transaction_from','/view/add_sales_logs','$product.product_name','/barcode_scanner','/give_payment/:id','product','match','primary_unit','post','warehouse_id','/all_sales_finished/preview/','Sales\x20Add\x20successfully','/all_sales/view','$product_details.type_products','$product_details.unit','</td>','Email\x20sent\x20successfully','$product_details.level','$invoice','</span>','<tbody\x20style=\x22text-align:\x20center;\x22>','primary_code_QA','$product_details.secondary_code','currency','<h5>','$product','$product_details.gross_price','staff','stock_data','all_sales_finished_logs','date_data','4122666QyKEbM','return_sale_finished','/view','logs','2090720qWaLUQ','valueOf','$product_details.product_cat','log','$sale_product.floorlevel','\x20Order\x20Number\x20:\x20','\x20</h2>','OUTF-','Ambient','Hindi','getFullYear','return_sale','$sale_product.bay','English','sale_product','14mwbIRw','$date','language','gmail','room_name','level2','findById','$product_details.secondary_unit','$product_details.floorlevel','$return_data','amount','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details._id','split','carton','Logo.png','redirect','maxperunit','email','/invoice/:id','sendMail','_id','errors','</h5>','save','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','success','password','$product_details.batch_code','for_categorize','Return\x20Rooms','getDate','RoomAssigned','length','</tr>','English\x20(US)','forEach','agent_id','find','aggregate','sales_quantity','return_qty','<tr>','status','$product_details.maxPerUnit','OUT-','maxPerUnit','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','currency_placement','int','invoice_init','add_sales_finished_logs','\x20Order\x20Date\x20:\x20','\x20<>\x20','product_name','Enabled','French','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','final','</tbody>','secondary_code','</head><body>','Spanish','sales','product_list','454820uvyvRO','edit_sales_finished_view','$finalize','max','Return\x20Goods','warehouse_name','payment\x20successfull','own','$product_details.primary_code','$product_details.expiry_date','Quality\x20Inspection','secondary_code_QA','$product_details.product_stock','string','return_qty_QA','received_amount','expiry_date_QA','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','level','$product_details.production_date','Received\x20Payment\x20For\x20Sale','floor','<span\x20style=\x22float:\x20right;\x22>','sales_quantity_QA','map','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.invoice','outgoing_invoice','toString','sale_qty','$product_details.bay','/barcode_scanner_logs','<strong>\x20Regards\x20</strong>','edit_sales_finished','/all_sales_finished/view','room','push','undefined','body','unit_QA','/view/:id','finalize','message','production_date','image','here','prod_invoice','bay','$product_details.sales_category','concat','<h5\x20style=\x22text-align:\x20left;\x22>','back','barcode\x20Product\x20master','<html><head><title></title>','True','gross_price','False','all_sales_barcode','$sale_product.bin','/preview/:id','9071690VFFACF','$_id','/upload/','purchases_data','LOG-OUT-','params','customer_data','product_code','</thead>','$note','/view/add_sales/:id','<hr\x20class=\x22my-3\x22>','invoice','Finished\x20Goods','</body></html>','$product_details','product_name_QA1','Enclosed','$product_details.type','secondary_unit','$customer','$product_details.rack','foreach\x20newproduct','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','stocks_QA','padStart','$product_details.maxProducts','expiry_date','$sale_product','Sales\x20Update\x20successfully','due_amount','product_details','There\x27s\x20a\x20error\x20in\x20this\x20transaction','batch_code_QA','Arabic\x20(ae)','../public/language/languages.json','/barcode/:id','getMonth','catch','968999bKhJwI','master','get','German','user','\x20&&\x20','production_date_QA','date','barcode\x20user_id','then','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','secondary_unit_QA','5OwAFAU','Portuguese\x20(BR)','add_sales_finished','$sale_product.quantity','$product_details.product_name','role','Sale\x20Return\x20Mail','primary_code','product_code_QA','note','slice','site_title','product_stock','maxProducts','Chinese','$product_details.product_code','all','prod_cat','uuid','product_date','maxPerUnit_QA','unit','21AqBxJf','abs'];a0_0x2bb0=function(){return _0x1d835d;};return a0_0x2bb0();}router[a0_0x2f8a4e(0x18d)](a0_0x2f8a4e(0x1da),auth,async(_0x1c6675,_0x1dce67)=>{var _0xa6b7ae=a0_0x2f8a4e;try{const {username:_0x47f28e,email:_0xf1684c,role:_0xc7fd5e}=_0x1c6675[_0xa6b7ae(0x18f)],_0x13c8c3=_0x1c6675[_0xa6b7ae(0x18f)],_0x55f36c=await profile[_0xa6b7ae(0x1d4)]({'email':_0x13c8c3[_0xa6b7ae(0x220)]}),_0x3057fa=await master_shop['find'](),_0x3b1dda=await customer['find']({});let _0x2904f5;if(_0x13c8c3[_0xa6b7ae(0x19c)]=='staff'){const _0x2e32ca=await staff['findOne']({'email':_0x13c8c3['email']});_0x2904f5=await warehouse[_0xa6b7ae(0x235)]([{'$match':{'status':_0xa6b7ae(0x245),'name':_0x2e32ca[_0xa6b7ae(0x1c5)]}},{'$group':{'_id':_0xa6b7ae(0x1db),'name':{'$first':_0xa6b7ae(0x1db)}}},{'$sort':{'name':0x1}}]);}else _0x2904f5=await warehouse['aggregate']([{'$match':{'status':_0xa6b7ae(0x245)}},{'$group':{'_id':_0xa6b7ae(0x1db),'name':{'$first':_0xa6b7ae(0x1db)}}},{'$sort':{'name':0x1}}]);const _0x695aed=await product[_0xa6b7ae(0x234)]({});var _0x56f476=[_0xa6b7ae(0x207),_0xa6b7ae(0x175)];const _0x2980b8=await sales_finished['find']({}),_0x57cec2=_0x2980b8[_0xa6b7ae(0x22f)]+0x1,_0x300545=_0xa6b7ae(0x206)+_0x57cec2[_0xa6b7ae(0x144)]()['padStart'](0x5,'0');if(_0x3057fa[0x0]['language']==_0xa6b7ae(0x231)){var _0x26bd3b=users['English'];console[_0xa6b7ae(0x202)](_0x26bd3b);}else{if(_0x3057fa[0x0][_0xa6b7ae(0x210)]==_0xa6b7ae(0x208))var _0x26bd3b=users[_0xa6b7ae(0x208)];else{if(_0x3057fa[0x0][_0xa6b7ae(0x210)]==_0xa6b7ae(0x18e))var _0x26bd3b=users[_0xa6b7ae(0x18e)];else{if(_0x3057fa[0x0]['language']==_0xa6b7ae(0x125))var _0x26bd3b=users['Spanish'];else{if(_0x3057fa[0x0][_0xa6b7ae(0x210)]==_0xa6b7ae(0x246))var _0x26bd3b=users[_0xa6b7ae(0x246)];else{if(_0x3057fa[0x0][_0xa6b7ae(0x210)]==_0xa6b7ae(0x198))var _0x26bd3b=users['Portuguese'];else{if(_0x3057fa[0x0][_0xa6b7ae(0x210)]=='Chinese')var _0x26bd3b=users['Chinese'];else{if(_0x3057fa[0x0][_0xa6b7ae(0x210)]==_0xa6b7ae(0x186))var _0x26bd3b=users[_0xa6b7ae(0x1b3)];}}}}}}}const _0x517ff1=getRandom8DigitNumber();_0x517ff1[_0xa6b7ae(0x194)](_0x178b4a=>{var _0x4298e5=_0xa6b7ae;_0x1dce67[_0x4298e5(0x1c9)](_0x4298e5(0x199),{'success':_0x1c6675['flash'](_0x4298e5(0x228)),'errors':_0x1c6675[_0x4298e5(0x1d7)](_0x4298e5(0x224)),'role':_0x13c8c3,'profile':_0x55f36c,'customer':_0x3b1dda,'warehouse':_0x2904f5,'product':_0x695aed,'invoice':_0x178b4a,'master_shop':_0x3057fa,'language':_0x26bd3b,'rooms_data':_0x56f476});})[_0xa6b7ae(0x18a)](_0x4df88a=>{var _0x33d974=_0xa6b7ae;_0x1c6675['flash'](_0x33d974(0x224),_0x33d974(0x184)),_0x1dce67[_0x33d974(0x21e)](_0x33d974(0x14a));});}catch(_0x329b22){console[_0xa6b7ae(0x202)](_0x329b22);}}),router['get']('/view/add_sales_logs',auth,async(_0x22ded7,_0x2f7533)=>{var _0x150ffe=a0_0x2f8a4e;try{const {username:_0x32a733,email:_0x580846,role:_0x1ed33f}=_0x22ded7[_0x150ffe(0x18f)],_0x1698e4=_0x22ded7[_0x150ffe(0x18f)],_0xf080e5=await profile[_0x150ffe(0x1d4)]({'email':_0x1698e4[_0x150ffe(0x220)]}),_0x28b0c7=await master_shop[_0x150ffe(0x234)](),_0xa74356=await customer['find']({});let _0x59b685;if(_0x1698e4[_0x150ffe(0x19c)]==_0x150ffe(0x1f7)){const _0x51af3b=await staff['findOne']({'email':_0x1698e4[_0x150ffe(0x220)]});_0x59b685=await warehouse[_0x150ffe(0x235)]([{'$match':{'status':_0x150ffe(0x245),'name':_0x51af3b[_0x150ffe(0x1c5)]}},{'$group':{'_id':_0x150ffe(0x1db),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x59b685=await warehouse[_0x150ffe(0x235)]([{'$match':{'status':_0x150ffe(0x245)}},{'$group':{'_id':_0x150ffe(0x1db),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x563313=await product[_0x150ffe(0x234)]({});var _0x102488=[_0x150ffe(0x207),'Enclosed'];const _0x3323bf=await sales_finished[_0x150ffe(0x234)]({}),_0x156aaf=_0x3323bf[_0x150ffe(0x22f)]+0x1,_0x595e54='OUTF-'+_0x156aaf[_0x150ffe(0x144)]()[_0x150ffe(0x17d)](0x5,'0');if(_0x28b0c7[0x0][_0x150ffe(0x210)]=='English\x20(US)'){var _0x2651c3=users['English'];console[_0x150ffe(0x202)](_0x2651c3);}else{if(_0x28b0c7[0x0][_0x150ffe(0x210)]==_0x150ffe(0x208))var _0x2651c3=users[_0x150ffe(0x208)];else{if(_0x28b0c7[0x0][_0x150ffe(0x210)]==_0x150ffe(0x18e))var _0x2651c3=users[_0x150ffe(0x18e)];else{if(_0x28b0c7[0x0][_0x150ffe(0x210)]==_0x150ffe(0x125))var _0x2651c3=users[_0x150ffe(0x125)];else{if(_0x28b0c7[0x0][_0x150ffe(0x210)]==_0x150ffe(0x246))var _0x2651c3=users[_0x150ffe(0x246)];else{if(_0x28b0c7[0x0][_0x150ffe(0x210)]==_0x150ffe(0x198))var _0x2651c3=users[_0x150ffe(0x1b0)];else{if(_0x28b0c7[0x0]['language']==_0x150ffe(0x1a5))var _0x2651c3=users[_0x150ffe(0x1a5)];else{if(_0x28b0c7[0x0][_0x150ffe(0x210)]=='Arabic\x20(ae)')var _0x2651c3=users[_0x150ffe(0x1b3)];}}}}}}}const _0x54e429=getRandom8DigitNumber();_0x54e429['then'](_0x48a1ea=>{var _0x467d13=_0x150ffe;_0x2f7533[_0x467d13(0x1c9)](_0x467d13(0x241),{'success':_0x22ded7['flash'](_0x467d13(0x228)),'errors':_0x22ded7[_0x467d13(0x1d7)]('errors'),'role':_0x1698e4,'profile':_0xf080e5,'customer':_0xa74356,'warehouse':_0x59b685,'product':_0x563313,'invoice':_0x48a1ea,'master_shop':_0x28b0c7,'language':_0x2651c3,'rooms_data':_0x102488});})[_0x150ffe(0x18a)](_0x3c2472=>{var _0x59e32c=_0x150ffe;_0x22ded7[_0x59e32c(0x1d7)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2f7533['redirect'](_0x59e32c(0x14a));});}catch(_0x18d228){console[_0x150ffe(0x202)](_0x18d228);}}),router['post'](a0_0x2f8a4e(0x1dd),auth,async(_0x408f0c,_0x21d4b2)=>{var _0x336b7d=a0_0x2f8a4e;try{const {invoice:_0x3330d1,date:_0x3a7989,warehouse_name:_0x42b3a5,product_name:_0x4366be,note:_0x4abfef,room:_0x552bed,primary_code:_0x1675a8,secondary_code:_0x554625,prod_code:_0x9133b3,SCRN:_0x2aa844,ReqBy:_0x575779,dateofreq:_0x2c2dd9,PO_number:_0x396469,typeservicesData:_0x456fd9,typevehicle:_0x3f68aa,destination:_0x52b423,deliverydate:_0x4e9305,driver:_0x16b092,plate:_0x5425df,van:_0x445b95,DRSI:_0x24c860,TSU:_0x189781,TFU:_0x3604e5,mode_transpo:_0x49a85e,name_driver:_0x34fec0,type_of_products:_0x2b83b6}=_0x408f0c[_0x336b7d(0x14e)];if(typeof _0x4366be==_0x336b7d(0x135))var _0x58c1e7=[_0x408f0c['body'][_0x336b7d(0x244)]],_0x47559b=[_0x408f0c['body'][_0x336b7d(0x1c6)]],_0x4434e6=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x21c)]],_0x1b53ff=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x19e)]],_0x4be933=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x123)]],_0x2692b4=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1b9)]],_0x26b525=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x213)]],_0x1c916b=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1e3)]],_0x4ffba1=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x177)]],_0x4242fc=[_0x408f0c['body'][_0x336b7d(0x1b1)]],_0x4bbb29=[_0x408f0c[_0x336b7d(0x14e)]['expiry_date']],_0x5d5cd7=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1aa)]],_0x31d1f1=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1c4)]],_0x5a8111=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1a8)]],_0x592e2a=[_0x408f0c[_0x336b7d(0x14e)]['RoomAssigned']],_0xd5d700=[_0x408f0c[_0x336b7d(0x14e)]['prod_invoice']],_0x25b11c=[_0x408f0c[_0x336b7d(0x14e)]['id_transaction_from']],_0x5e2601=[_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1a9)]],_0x2953f7=[_0x408f0c['body']['gross_price']];else var _0x58c1e7=[..._0x408f0c['body'][_0x336b7d(0x244)]],_0x47559b=[..._0x408f0c['body'][_0x336b7d(0x1c6)]],_0x4434e6=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x21c)]],_0x1b53ff=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x19e)]],_0x4be933=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x123)]],_0x2692b4=[..._0x408f0c[_0x336b7d(0x14e)]['prod_code']],_0x26b525=[..._0x408f0c[_0x336b7d(0x14e)]['level2']],_0x1c916b=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1e3)]],_0x4ffba1=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x177)]],_0x4242fc=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1b1)]],_0x4bbb29=[..._0x408f0c[_0x336b7d(0x14e)]['expiry_date']],_0x5d5cd7=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1aa)]],_0x31d1f1=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1c4)]],_0x5a8111=[..._0x408f0c['body']['prod_cat']],_0x592e2a=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x22e)]],_0xd5d700=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x156)]],_0x25b11c=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1dc)]],_0x5e2601=[..._0x408f0c['body'][_0x336b7d(0x1a9)]],_0x2953f7=[..._0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x15f)]];const _0x11b83e=_0x58c1e7[_0x336b7d(0x140)](_0x2994db=>{return _0x2994db={'product_name':_0x2994db};});_0x47559b[_0x336b7d(0x232)]((_0x12c4dd,_0x15708a)=>{var _0x21a40c=_0x336b7d;_0x11b83e[_0x15708a][_0x21a40c(0x1c6)]=_0x12c4dd;}),_0x4434e6[_0x336b7d(0x232)]((_0x162a1e,_0x2d335c)=>{var _0x410cc9=_0x336b7d;_0x11b83e[_0x2d335c][_0x410cc9(0x1cf)]=Math[_0x410cc9(0x1ae)](_0x162a1e);}),_0x58c1e7[_0x336b7d(0x232)]((_0x35d978,_0x3558ad)=>{var _0x48cd1e=_0x336b7d;_0x11b83e[_0x3558ad][_0x48cd1e(0x233)]=_0x408f0c[_0x48cd1e(0x14e)]['sales'];}),_0x2953f7[_0x336b7d(0x232)]((_0x427148,_0x59f37c)=>{var _0x14268f=_0x336b7d;_0x11b83e[_0x59f37c][_0x14268f(0x15f)]=_0x427148;}),_0x5e2601['forEach']((_0x20c773,_0x2ec453)=>{var _0x962b71=_0x336b7d;_0x11b83e[_0x2ec453][_0x962b71(0x1a9)]=_0x20c773;}),_0x25b11c[_0x336b7d(0x232)]((_0x2c1c79,_0x5af05d)=>{var _0x18a7f6=_0x336b7d;_0x11b83e[_0x5af05d][_0x18a7f6(0x1dc)]=_0x2c1c79;}),_0x1b53ff[_0x336b7d(0x232)]((_0x864d05,_0x595a52)=>{var _0x4c4baa=_0x336b7d;_0x11b83e[_0x595a52][_0x4c4baa(0x19e)]=_0x864d05;}),_0x4be933[_0x336b7d(0x232)]((_0x5ee231,_0x5ee5ff)=>{var _0x497159=_0x336b7d;_0x11b83e[_0x5ee5ff][_0x497159(0x123)]=_0x5ee231;}),_0x2692b4['forEach']((_0x3f1013,_0xab9571)=>{var _0x4ce04f=_0x336b7d;_0x11b83e[_0xab9571][_0x4ce04f(0x16b)]=_0x3f1013;}),_0x26b525[_0x336b7d(0x232)]((_0x156b8c,_0xf42514)=>{var _0x28463b=_0x336b7d,_0x319d06=_0x156b8c[_0x28463b(0x1e2)](/[A-Za-z]+/)[0x0],_0x1eaa5c=parseInt(_0x156b8c[_0x28463b(0x1e2)](/\d+/)[0x0]);_0x11b83e[_0xf42514][_0x28463b(0x157)]=_0x1eaa5c,_0x11b83e[_0xf42514]['level']=_0x319d06;}),_0x1c916b[_0x336b7d(0x232)]((_0x35e96f,_0x3e8923)=>{_0x11b83e[_0x3e8923]['unit']=_0x35e96f;}),_0x4ffba1[_0x336b7d(0x232)]((_0x174235,_0x550606)=>{_0x11b83e[_0x550606]['secondary_unit']=_0x174235;}),_0x4242fc['forEach']((_0x254abf,_0x3d6943)=>{var _0x2b7e7f=_0x336b7d;_0x11b83e[_0x3d6943][_0x2b7e7f(0x1b1)]=_0x254abf;}),_0x4bbb29[_0x336b7d(0x232)]((_0x2afd9a,_0x10b6dd)=>{var _0x456bd2=_0x336b7d;_0x11b83e[_0x10b6dd][_0x456bd2(0x17f)]=_0x2afd9a;}),_0x5d5cd7['forEach']((_0x5bd146,_0x42f029)=>{var _0x5e1df8=_0x336b7d;_0x11b83e[_0x42f029][_0x5e1df8(0x153)]=_0x5bd146;}),_0x31d1f1[_0x336b7d(0x232)]((_0xd3ba57,_0x1462ab)=>{_0x11b83e[_0x1462ab]['maxperunit']=_0xd3ba57;}),_0x5a8111[_0x336b7d(0x232)]((_0x21eb5d,_0x4f9074)=>{_0x11b83e[_0x4f9074]['prod_cat']=_0x21eb5d;}),_0x592e2a[_0x336b7d(0x232)]((_0x5e1b69,_0x561e19)=>{var _0x39c9f0=_0x336b7d;_0x11b83e[_0x561e19][_0x39c9f0(0x212)]=_0x5e1b69;}),_0xd5d700[_0x336b7d(0x232)]((_0x2f3736,_0x3f0e13)=>{var _0x6bf315=_0x336b7d;_0x11b83e[_0x3f0e13][_0x6bf315(0x170)]=_0x2f3736,_0x11b83e[_0x3f0e13][_0x6bf315(0x1fa)]=_0x3a7989;});const _0x4455c7=new sales_logs();await _0x4455c7[_0x336b7d(0x226)](),_0xd5d700[_0x336b7d(0x232)]((_0x41b836,_0x18b652)=>{var _0xbd44f0=_0x336b7d;_0x11b83e[_0x18b652][_0xbd44f0(0x143)]=_0xbd44f0(0x168)+_0x4455c7['invoice_init'][_0xbd44f0(0x144)]()[_0xbd44f0(0x17d)](0x8,'0');});var _0x4a2502=0x0;_0x11b83e[_0x336b7d(0x232)](_0x50988e=>{var _0x2a55c1=_0x336b7d;parseFloat(_0x50988e[_0x2a55c1(0x1c6)])<parseFloat(_0x50988e[_0x2a55c1(0x1cf)])&&parseFloat(_0x50988e[_0x2a55c1(0x1cf)])>parseFloat(_0x50988e[_0x2a55c1(0x1c6)])&&(console[_0x2a55c1(0x202)](_0x50988e[_0x2a55c1(0x1c6)]+_0x2a55c1(0x243)+_0x50988e[_0x2a55c1(0x1cf)]),_0x4a2502++);});if(_0x4a2502!=0x0)return _0x408f0c[_0x336b7d(0x1d7)](_0x336b7d(0x224),_0x336b7d(0x139)),_0x21d4b2[_0x336b7d(0x21e)]('back');const _0x165a8e=_0x11b83e[_0x336b7d(0x1c8)](_0x57a0bd=>_0x57a0bd[_0x336b7d(0x1cf)]!=='0'&&_0x57a0bd[_0x336b7d(0x1cf)]!==''),_0x4e1cf5=new sales_finished({'invoice':'LOG-OUT-'+_0x4455c7['invoice_init'][_0x336b7d(0x144)]()['padStart'](0x8,'0'),'sales_data':_0x408f0c['body'][_0x336b7d(0x126)],'customer':_0x408f0c[_0x336b7d(0x14e)][_0x336b7d(0x1cb)],'date':_0x3a7989,'warehouse_name':_0x42b3a5,'sale_product':_0x165a8e,'note':_0x4abfef,'room':_0x552bed,'primary_code':_0x1675a8,'secondary_code':_0x554625,'prod_code':_0x9133b3,'SCRN':_0x2aa844,'finalize':_0x336b7d(0x160),'mode_transpo':_0x49a85e,'name_driver':_0x34fec0,'ReqBy':_0x575779,'dateofreq':_0x2c2dd9,'PO_number':_0x396469,'typeservicesData':_0x456fd9,'typevehicle':_0x3f68aa,'destination':_0x52b423,'deliverydate':_0x4e9305,'driver':_0x16b092,'plate':_0x5425df,'van':_0x445b95,'DRSI':_0x24c860,'TSU':_0x189781,'TFU':_0x3604e5,'typeOfProducts':_0x2b83b6}),_0x54e531=await _0x4e1cf5[_0x336b7d(0x226)](),_0x6ce5b8=await sales_finished[_0x336b7d(0x1d4)]({'invoice':_0x3330d1});_0x408f0c[_0x336b7d(0x1d7)]('success',_0x336b7d(0x1e7)),_0x21d4b2[_0x336b7d(0x21e)](_0x336b7d(0x1e6)+_0x54e531['_id']);}catch(_0x5f4c7a){console['log'](_0x5f4c7a);}}),router[a0_0x2f8a4e(0x18d)](a0_0x2f8a4e(0x16e),auth,async(_0x337203,_0xf55925)=>{var _0x282c16=a0_0x2f8a4e;try{const _0x33b99e=_0x337203[_0x282c16(0x169)]['id'];console[_0x282c16(0x202)](_0x33b99e);const _0x3b2779=await product[_0x282c16(0x234)](),_0x5cb2f0=await purchases[_0x282c16(0x235)]([{'$match':{'warehouse_name':_0x33b99e}},{'$unwind':_0x282c16(0x1f5)},{'$group':{'_id':_0x282c16(0x1de)}}]);console[_0x282c16(0x202)](_0x282c16(0x167),_0x5cb2f0),_0xf55925[_0x282c16(0x239)](0xc8)[_0x282c16(0x1b7)]({'purchases_data':_0x5cb2f0,'product_data':_0x3b2779});}catch(_0x3a6bcc){console['log'](_0x3a6bcc);}}),router[a0_0x2f8a4e(0x1e4)]('/view/add_sale/product',auth,async(_0x221f04,_0x1de5c3)=>{var _0x40f71b=a0_0x2f8a4e;try{const {warehouse_data:_0x9e28f8,product_data:_0x3b21aa}=_0x221f04[_0x40f71b(0x14e)];console['log'](_0x221f04[_0x40f71b(0x14e)][_0x40f71b(0x1be)]);;const _0x2c0bc0=await master_shop[_0x40f71b(0x234)]();console['log'](_0x40f71b(0x18c),_0x2c0bc0);const _0x45dbb8=await product[_0x40f71b(0x1d4)]({'name':_0x3b21aa});console['log'](_0x40f71b(0x1e1),_0x45dbb8);const _0x1925c9=await warehouse[_0x40f71b(0x235)]([{'$match':{'name':_0x9e28f8}},{'$unwind':_0x40f71b(0x173)},{'$match':{'product_details.product_name':_0x3b21aa}},{'$group':{'_id':_0x40f71b(0x19b),'product_stock':{'$first':_0x40f71b(0x134)}}}]);console[_0x40f71b(0x202)](_0x40f71b(0x1f8),_0x1925c9),_0x1de5c3[_0x40f71b(0x239)](0xc8)[_0x40f71b(0x1b7)]({'master':_0x2c0bc0,'new_product':_0x45dbb8,'stock_data':_0x1925c9});}catch(_0x200c5e){console[_0x40f71b(0x202)](_0x200c5e);}}),router['post'](a0_0x2f8a4e(0x1da),auth,async(_0x23e3ec,_0x11cfbb)=>{var _0x3939e4=a0_0x2f8a4e;try{const {invoice:_0x27c0cd,date:_0x54b45d,warehouse_name:_0x2d1e40,product_name:_0x92b4c3,note:_0x1f5f85,room:_0x1b710f,primary_code:_0x4fe263,secondary_code:_0x21b3ef,prod_code:_0x4cc8bb,SCRN:_0x233a14,ReqBy:_0x4c8ba8,dateofreq:_0x43fed3,PO_number:_0x4ca69b,typeservicesData:_0x13b0cd,typevehicle:_0x3fe95e,destination:_0x4bede5,deliverydate:_0x83dc19,driver:_0x4d94f8,plate:_0x473223,van:_0x4aa683,DRSI:_0x4a97fc,TSU:_0x48350f,TFU:_0x490bd8,mode_transpo:_0x447762,name_driver:_0x789253,pull_out_date:_0x4097c1,actual_delivery_date:_0x1be16c}=_0x23e3ec[_0x3939e4(0x14e)];if(typeof _0x92b4c3==_0x3939e4(0x135))var _0x4979dd=[_0x23e3ec['body']['product_name']],_0x5b0cfc=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1c6)]],_0x1738f9=[_0x23e3ec[_0x3939e4(0x14e)]['carton']],_0x436215=[_0x23e3ec['body'][_0x3939e4(0x19e)]],_0x480117=[_0x23e3ec['body'][_0x3939e4(0x123)]],_0x755169=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1b9)]],_0x156dac=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x213)]],_0x40f93b=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1e3)]],_0x550b1d=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x177)]],_0x2d7c56=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1b1)]],_0xe59954=[_0x23e3ec['body'][_0x3939e4(0x17f)]],_0x337acc=[_0x23e3ec['body'][_0x3939e4(0x1aa)]],_0x4bc917=[_0x23e3ec['body'][_0x3939e4(0x1c4)]],_0x3414a4=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1a8)]],_0x517bdd=[_0x23e3ec['body'][_0x3939e4(0x22e)]],_0x243202=[_0x23e3ec['body'][_0x3939e4(0x156)]],_0x24492c=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1dc)]],_0x2d7efd=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1a9)]],_0x2546d4=[_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x15f)]];else var _0x4979dd=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x244)]],_0x5b0cfc=[..._0x23e3ec['body'][_0x3939e4(0x1c6)]],_0x1738f9=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x21c)]],_0x436215=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x19e)]],_0x480117=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x123)]],_0x755169=[..._0x23e3ec['body'][_0x3939e4(0x1b9)]],_0x156dac=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x213)]],_0x40f93b=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1e3)]],_0x550b1d=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x177)]],_0x2d7c56=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1b1)]],_0xe59954=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x17f)]],_0x337acc=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1aa)]],_0x4bc917=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1c4)]],_0x3414a4=[..._0x23e3ec['body'][_0x3939e4(0x1a8)]],_0x517bdd=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x22e)]],_0x243202=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x156)]],_0x24492c=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1dc)]],_0x2d7efd=[..._0x23e3ec[_0x3939e4(0x14e)]['uuid']],_0x2546d4=[..._0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x15f)]];const _0x167270=_0x4979dd[_0x3939e4(0x140)](_0x5d0f0e=>{return _0x5d0f0e={'product_name':_0x5d0f0e};});_0x5b0cfc[_0x3939e4(0x232)]((_0x3f0b83,_0x209911)=>{var _0x1d84c8=_0x3939e4;_0x167270[_0x209911][_0x1d84c8(0x1c6)]=_0x3f0b83;}),_0x1738f9[_0x3939e4(0x232)]((_0x3ee6aa,_0x434b03)=>{_0x167270[_0x434b03]['quantity']=Math['abs'](_0x3ee6aa);}),_0x4979dd[_0x3939e4(0x232)]((_0x4d8277,_0x5a425e)=>{var _0x18dd4b=_0x3939e4;_0x167270[_0x5a425e][_0x18dd4b(0x233)]=_0x23e3ec['body'][_0x18dd4b(0x126)];}),_0x2546d4['forEach']((_0x3c265f,_0x33546e)=>{var _0x119f30=_0x3939e4;_0x167270[_0x33546e][_0x119f30(0x15f)]=_0x3c265f;}),_0x2d7efd[_0x3939e4(0x232)]((_0xf3bc77,_0x359cbc)=>{var _0xd10df8=_0x3939e4;_0x167270[_0x359cbc][_0xd10df8(0x1a9)]=_0xf3bc77;}),_0x24492c[_0x3939e4(0x232)]((_0x312b81,_0x194bec)=>{var _0x5a50ac=_0x3939e4;_0x167270[_0x194bec][_0x5a50ac(0x1dc)]=_0x312b81;}),_0x436215[_0x3939e4(0x232)]((_0x1db4a3,_0x1485d3)=>{var _0x29b8f5=_0x3939e4;_0x167270[_0x1485d3][_0x29b8f5(0x19e)]=_0x1db4a3;}),_0x480117[_0x3939e4(0x232)]((_0x40e12f,_0x50bdcb)=>{var _0x2268b9=_0x3939e4;_0x167270[_0x50bdcb][_0x2268b9(0x123)]=_0x40e12f;}),_0x755169[_0x3939e4(0x232)]((_0x1f3d0e,_0x268fbb)=>{var _0x4e3659=_0x3939e4;_0x167270[_0x268fbb][_0x4e3659(0x16b)]=_0x1f3d0e;}),_0x156dac[_0x3939e4(0x232)]((_0x5e8d93,_0x3dd522)=>{var _0x21571a=_0x3939e4,_0x3bd49a=_0x5e8d93[_0x21571a(0x1e2)](/[A-Za-z]+/)[0x0],_0x8bed6a=parseInt(_0x5e8d93['match'](/\d+/)[0x0]);_0x167270[_0x3dd522][_0x21571a(0x157)]=_0x8bed6a,_0x167270[_0x3dd522][_0x21571a(0x13a)]=_0x3bd49a;}),_0x40f93b[_0x3939e4(0x232)]((_0x55e23f,_0x20cd42)=>{_0x167270[_0x20cd42]['unit']=_0x55e23f;}),_0x550b1d[_0x3939e4(0x232)]((_0x24d96a,_0x48b06f)=>{_0x167270[_0x48b06f]['secondary_unit']=_0x24d96a;}),_0x2d7c56[_0x3939e4(0x232)]((_0x313dcc,_0x120713)=>{var _0x7beba5=_0x3939e4;_0x167270[_0x120713][_0x7beba5(0x1b1)]=_0x313dcc;}),_0xe59954[_0x3939e4(0x232)]((_0x129fb5,_0x44e12d)=>{var _0x40e6bd=_0x3939e4;_0x167270[_0x44e12d][_0x40e6bd(0x17f)]=_0x129fb5;}),_0x337acc['forEach']((_0x1bd83a,_0x4c6fc7)=>{var _0x5d9edc=_0x3939e4;_0x167270[_0x4c6fc7][_0x5d9edc(0x153)]=_0x1bd83a;}),_0x4bc917[_0x3939e4(0x232)]((_0x169a2d,_0x3a33a6)=>{_0x167270[_0x3a33a6]['maxperunit']=_0x169a2d;}),_0x3414a4[_0x3939e4(0x232)]((_0x46de5f,_0x3e9ffe)=>{_0x167270[_0x3e9ffe]['prod_cat']=_0x46de5f;}),_0x517bdd[_0x3939e4(0x232)]((_0x28513e,_0x6c9981)=>{var _0x2cd13c=_0x3939e4;_0x167270[_0x6c9981][_0x2cd13c(0x212)]=_0x28513e;}),_0x243202['forEach']((_0x136ad0,_0xd0ba97)=>{_0x167270[_0xd0ba97]['invoice']=_0x136ad0,_0x167270[_0xd0ba97]['date_data']=_0x54b45d;});const _0x5161a9=new invoice_for_outgoing();await _0x5161a9[_0x3939e4(0x226)](),_0x243202[_0x3939e4(0x232)]((_0xa7268a,_0x3ac22e)=>{var _0x9d1aa5=_0x3939e4;_0x167270[_0x3ac22e][_0x9d1aa5(0x143)]=_0x9d1aa5(0x23b)+_0x5161a9['invoice_init']['toString']()[_0x9d1aa5(0x17d)](0x8,'0');});var _0x34da8e=0x0;_0x167270[_0x3939e4(0x232)](_0x5d5cc5=>{var _0x2fa9b5=_0x3939e4;parseFloat(_0x5d5cc5[_0x2fa9b5(0x1c6)])<parseFloat(_0x5d5cc5[_0x2fa9b5(0x1cf)])&&parseFloat(_0x5d5cc5[_0x2fa9b5(0x1cf)])>parseFloat(_0x5d5cc5[_0x2fa9b5(0x1c6)])&&(console[_0x2fa9b5(0x202)](_0x5d5cc5[_0x2fa9b5(0x1c6)]+'\x20<>\x20'+_0x5d5cc5['quantity']),_0x34da8e++);});if(_0x34da8e!=0x0)return _0x23e3ec[_0x3939e4(0x1d7)](_0x3939e4(0x224),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x11cfbb[_0x3939e4(0x21e)]('back');const _0xd7c18f=_0x167270[_0x3939e4(0x1c8)](_0x4c919a=>_0x4c919a[_0x3939e4(0x1cf)]!=='0'&&_0x4c919a['quantity']!==''),_0x4a753d=new sales_finished({'invoice':_0x3939e4(0x23b)+_0x5161a9[_0x3939e4(0x240)][_0x3939e4(0x144)]()[_0x3939e4(0x17d)](0x8,'0'),'sales_data':_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x126)],'customer':_0x23e3ec[_0x3939e4(0x14e)][_0x3939e4(0x1cb)],'date':_0x54b45d,'warehouse_name':_0x2d1e40,'sale_product':_0xd7c18f,'note':_0x1f5f85,'room':_0x1b710f,'primary_code':_0x4fe263,'secondary_code':_0x21b3ef,'prod_code':_0x4cc8bb,'SCRN':_0x233a14,'finalize':'False','mode_transpo':_0x447762,'name_driver':_0x789253,'ReqBy':_0x4c8ba8,'dateofreq':_0x43fed3,'PO_number':_0x4ca69b,'typeservicesData':_0x13b0cd,'typevehicle':_0x3fe95e,'destination':_0x4bede5,'deliverydate':_0x83dc19,'driver':_0x4d94f8,'plate':_0x473223,'van':_0x4aa683,'DRSI':_0x4a97fc,'TSU':_0x48350f,'TFU':_0x490bd8,'pullout_date':_0x4097c1,'actualdelivery_date':_0x1be16c,'typeOfProducts':_0x3939e4(0x12f)}),_0x90e401=await _0x4a753d[_0x3939e4(0x226)](),_0x366fb6=await sales_finished['findOne']({'invoice':_0x27c0cd});_0x23e3ec[_0x3939e4(0x1d7)]('success','Sales\x20Add\x20successfully'),_0x11cfbb[_0x3939e4(0x21e)](_0x3939e4(0x1e6)+_0x90e401['_id']);}catch(_0x647258){console[_0x3939e4(0x202)](_0x647258);}}),router[a0_0x2f8a4e(0x18d)](a0_0x2f8a4e(0x163),auth,async(_0x15428f,_0x4b5f15)=>{var _0x32b20a=a0_0x2f8a4e;try{const {username:_0x32456a,email:_0x429ffa,role:_0x4905cf}=_0x15428f[_0x32b20a(0x18f)],_0x160374=_0x15428f[_0x32b20a(0x18f)],_0x3f7f9c=await profile[_0x32b20a(0x1d4)]({'email':_0x160374[_0x32b20a(0x220)]}),_0x404a1b=await master_shop[_0x32b20a(0x234)](),_0x17fbe1=_0x15428f[_0x32b20a(0x169)]['id'],_0x4db54=await sales_finished[_0x32b20a(0x214)](_0x17fbe1),_0x1dd659=await warehouse[_0x32b20a(0x235)]([{'$match':{'name':_0x4db54[_0x32b20a(0x12d)]}},{'$unwind':_0x32b20a(0x173)},{'$group':{'_id':_0x32b20a(0x21a),'name':{'$first':_0x32b20a(0x19b)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x32b20a(0x1b6)},'type':{'$first':_0x32b20a(0x176)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x32b20a(0x130)},'secondary_code':{'$first':_0x32b20a(0x1f2)},'product_code':{'$first':_0x32b20a(0x1a6)},'storage':{'$first':_0x32b20a(0x1c3)},'rack':{'$first':_0x32b20a(0x179)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x32b20a(0x22a)},'room':{'$first':_0x32b20a(0x1b4)},'room_data':{'$first':'$product_details.room_name'}}}]),_0x39742e=await customer[_0x32b20a(0x234)]({});let _0x308eb5;if(_0x160374[_0x32b20a(0x19c)]==_0x32b20a(0x1f7)){const _0x1e0f20=await staff[_0x32b20a(0x1d4)]({'email':_0x160374['email']});_0x308eb5=await warehouse[_0x32b20a(0x235)]([{'$match':{'status':'Enabled','name':_0x1e0f20[_0x32b20a(0x1c5)]}},{'$group':{'_id':'$name','name':{'$first':_0x32b20a(0x1db)}}}]);}else _0x308eb5=await warehouse[_0x32b20a(0x235)]([{'$match':{'status':_0x32b20a(0x245)}},{'$group':{'_id':_0x32b20a(0x1db),'name':{'$first':_0x32b20a(0x1db)}}}]);const _0x2c4b47=await product['find']({});if(_0x404a1b[0x0][_0x32b20a(0x210)]==_0x32b20a(0x231)){var _0x1845f0=users[_0x32b20a(0x20c)];console[_0x32b20a(0x202)](_0x1845f0);}else{if(_0x404a1b[0x0]['language']=='Hindi')var _0x1845f0=users['Hindi'];else{if(_0x404a1b[0x0][_0x32b20a(0x210)]==_0x32b20a(0x18e))var _0x1845f0=users[_0x32b20a(0x18e)];else{if(_0x404a1b[0x0][_0x32b20a(0x210)]==_0x32b20a(0x125))var _0x1845f0=users['Spanish'];else{if(_0x404a1b[0x0][_0x32b20a(0x210)]==_0x32b20a(0x246))var _0x1845f0=users[_0x32b20a(0x246)];else{if(_0x404a1b[0x0][_0x32b20a(0x210)]==_0x32b20a(0x198))var _0x1845f0=users['Portuguese'];else{if(_0x404a1b[0x0][_0x32b20a(0x210)]==_0x32b20a(0x1a5))var _0x1845f0=users[_0x32b20a(0x1a5)];else{if(_0x404a1b[0x0]['language']=='Arabic\x20(ae)')var _0x1845f0=users[_0x32b20a(0x1b3)];}}}}}}}_0x4b5f15[_0x32b20a(0x1c9)](_0x32b20a(0x129),{'success':_0x15428f[_0x32b20a(0x1d7)](_0x32b20a(0x228)),'errors':_0x15428f[_0x32b20a(0x1d7)](_0x32b20a(0x224)),'role':_0x160374,'profile':_0x3f7f9c,'customer':_0x39742e,'warehouse':_0x308eb5,'product':_0x1dd659,'user':_0x4db54,'master_shop':_0x404a1b,'unit':_0x2c4b47,'language':_0x1845f0});}catch(_0x5e664a){console[_0x32b20a(0x202)](_0x5e664a);}});function a0_0x109b(_0x238759,_0x248037){var _0x2bb098=a0_0x2bb0();return a0_0x109b=function(_0x109b6e,_0xaf9acb){_0x109b6e=_0x109b6e-0x123;var _0x4234de=_0x2bb098[_0x109b6e];return _0x4234de;},a0_0x109b(_0x238759,_0x248037);}async function dataUpdate(_0x46ca61,_0x5398a3,_0x1c9098){var _0x14ac25=a0_0x2f8a4e;return await warehouse[_0x14ac25(0x1cc)]({'_id':_0x46ca61,'product_details._id':_0x5398a3},{'$set':{'product_details.$.product_stock':_0x1c9098}}),await warehouse['findById'](_0x46ca61);}router[a0_0x2f8a4e(0x1e4)]('/preview/:id',auth,async(_0x963152,_0x146d46)=>{var _0x5b2c03=a0_0x2f8a4e;try{const _0x38e222=_0x963152['params']['id'],{invoice:_0x34a067,warehouse_name:_0x423a98,room:_0x183059}=_0x963152[_0x5b2c03(0x14e)],_0x43a63c=await sales_finished[_0x5b2c03(0x1d4)]({'invoice':_0x34a067});for(let _0x106f10=0x0;_0x106f10<=_0x43a63c[_0x5b2c03(0x20d)][_0x5b2c03(0x22f)]-0x1;_0x106f10++){const _0x40b8b8=_0x43a63c[_0x5b2c03(0x20d)][_0x106f10];var _0x3ed5a1=await warehouse[_0x5b2c03(0x1d4)]({'name':_0x423a98,'room':_0x40b8b8['room_name']}),_0x3271e2=0x0;for(let _0x517c24=0x0;_0x517c24<=_0x3ed5a1[_0x5b2c03(0x183)][_0x5b2c03(0x22f)]-0x1;_0x517c24++){const _0x202711=_0x3ed5a1[_0x5b2c03(0x183)][_0x517c24];_0x202711[_0x5b2c03(0x223)]==_0x40b8b8[_0x5b2c03(0x1dc)]&&_0x202711[_0x5b2c03(0x1a9)]==_0x40b8b8[_0x5b2c03(0x1a9)]&&(_0x3271e2=Math[_0x5b2c03(0x12b)](0x0,Math[_0x5b2c03(0x1ae)](_0x202711[_0x5b2c03(0x1a3)])-Math[_0x5b2c03(0x1ae)](_0x40b8b8[_0x5b2c03(0x1cf)])),await warehouse[_0x5b2c03(0x1cc)]({'_id':_0x3ed5a1[_0x5b2c03(0x223)][_0x5b2c03(0x200)](),'product_details._id':_0x202711[_0x5b2c03(0x223)][_0x5b2c03(0x200)](),'product_details.uuid':_0x40b8b8[_0x5b2c03(0x1a9)]},{'$set':{'product_details.$.product_stock':_0x3271e2}}));}console['log'](typeof _0x40b8b8[_0x5b2c03(0x233)]);if(typeof _0x40b8b8[_0x5b2c03(0x233)]!==_0x5b2c03(0x14d)){var _0x328c0f=await staff[_0x5b2c03(0x214)](_0x40b8b8[_0x5b2c03(0x233)]);console[_0x5b2c03(0x202)](_0x5b2c03(0x155));var _0x5e5615=0x0;for(let _0x506358=0x0;_0x506358<=_0x328c0f[_0x5b2c03(0x127)][_0x5b2c03(0x22f)]-0x1;_0x506358++){const _0x35ca4d=_0x328c0f[_0x5b2c03(0x127)][_0x506358];console[_0x5b2c03(0x202)](_0x40b8b8[_0x5b2c03(0x1dc)]+_0x5b2c03(0x1ce)+_0x35ca4d[_0x5b2c03(0x1e5)]+_0x5b2c03(0x190)+_0x40b8b8[_0x5b2c03(0x223)]+'\x20==\x20'+_0x40b8b8[_0x5b2c03(0x223)]),_0x40b8b8[_0x5b2c03(0x1dc)]==_0x35ca4d[_0x5b2c03(0x1e5)]&&_0x40b8b8[_0x5b2c03(0x223)]==0x1&&(_0x35ca4d[_0x5b2c03(0x1a3)]=Math[_0x5b2c03(0x1ae)](_0x35ca4d[_0x5b2c03(0x1a3)])+Math['abs'](_0x40b8b8['quantity']),_0x5e5615++);}console[_0x5b2c03(0x202)](_0x5b2c03(0x23f),_0x5e5615),_0x5e5615=='0'&&(_0x328c0f[_0x5b2c03(0x127)]=_0x328c0f[_0x5b2c03(0x127)][_0x5b2c03(0x159)]({'product_name':_0x40b8b8[_0x5b2c03(0x244)],'product_stock':_0x40b8b8[_0x5b2c03(0x1cf)],'bay':_0x40b8b8[_0x5b2c03(0x157)],'level':_0x40b8b8[_0x5b2c03(0x13a)],'product_code':_0x40b8b8[_0x5b2c03(0x16b)],'primary_code':_0x40b8b8[_0x5b2c03(0x19e)],'secondary_code':_0x40b8b8[_0x5b2c03(0x123)],'expiry_date':_0x40b8b8[_0x5b2c03(0x17f)],'production_date':_0x40b8b8['production_date'],'maxProducts':_0x40b8b8[_0x5b2c03(0x1a4)],'batch_code':_0x40b8b8[_0x5b2c03(0x1b1)],'secondary_unit':_0x40b8b8[_0x5b2c03(0x177)],'unit':_0x40b8b8['unit'],'maxProducts':_0x40b8b8[_0x5b2c03(0x1a4)],'maxPerUnit':_0x40b8b8[_0x5b2c03(0x21f)],'invoice':_0x40b8b8[_0x5b2c03(0x170)],'warehouse_id':_0x40b8b8['id_transaction_from'],'id_incoming':_0x40b8b8[_0x5b2c03(0x223)],'uuid':_0x40b8b8['uuid'],'gross_price':_0x40b8b8[_0x5b2c03(0x15f)],'date_incoming':_0x40b8b8[_0x5b2c03(0x1fa)],'outgoing_invoice':_0x40b8b8[_0x5b2c03(0x143)]}),await _0x328c0f[_0x5b2c03(0x226)]());}}_0x43a63c[_0x5b2c03(0x151)]=_0x5b2c03(0x15e);const _0x236a08=await _0x43a63c[_0x5b2c03(0x226)](),_0x202c53=await master_shop[_0x5b2c03(0x234)](),_0x189cd7=await email_settings[_0x5b2c03(0x1d4)](),_0xf2a964=await supervisor_settings['find']();var _0x404da0=_0x43a63c[_0x5b2c03(0x20d)],_0x11575e='',_0x406cf3;for(_0x406cf3 in _0x404da0){_0x11575e+=_0x5b2c03(0x238)+_0x5b2c03(0x1b2)+_0x404da0[_0x406cf3][_0x5b2c03(0x244)]+_0x5b2c03(0x1eb)+_0x5b2c03(0x1b2)+_0x404da0[_0x406cf3][_0x5b2c03(0x16b)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x404da0[_0x406cf3]['quantity']+_0x5b2c03(0x1eb)+_0x5b2c03(0x1b2)+_0x404da0[_0x406cf3][_0x5b2c03(0x1ac)]+_0x5b2c03(0x1eb)+_0x5b2c03(0x1b2)+_0x404da0[_0x406cf3][_0x5b2c03(0x177)]+'</td>'+_0x5b2c03(0x1b2)+_0x43a63c[_0x5b2c03(0x12d)]+_0x5b2c03(0x1eb)+_0x5b2c03(0x1b2)+_0x404da0[_0x406cf3][_0x5b2c03(0x212)]+_0x5b2c03(0x1eb)+_0x5b2c03(0x1b2)+_0x404da0[_0x406cf3]['bay']+_0x5b2c03(0x1eb);}_0x963152[_0x5b2c03(0x1d7)](_0x5b2c03(0x228),_0x5b2c03(0x181)),_0x146d46['redirect']('/picking_list/pdf/'+_0x38e222);}catch(_0x383e8c){console[_0x5b2c03(0x202)](_0x383e8c);}}),router['get']('/view/:id',auth,async(_0x55878a,_0x33c5b9)=>{var _0x5069b0=a0_0x2f8a4e;try{const {username:_0xa70656,email:_0x27748e,role:_0x33b18b}=_0x55878a[_0x5069b0(0x18f)],_0x1b9183=_0x55878a[_0x5069b0(0x18f)],_0x2d26a9=await profile[_0x5069b0(0x1d4)]({'email':_0x1b9183[_0x5069b0(0x220)]}),_0x235bc8=await master_shop[_0x5069b0(0x234)](),_0x2a39ed=_0x55878a[_0x5069b0(0x169)]['id'],_0x61ca1e=await sales_finished['findById'](_0x2a39ed);let _0x56a284=new Date(_0x61ca1e[_0x5069b0(0x17f)]),_0x2017d6=('0'+_0x56a284[_0x5069b0(0x22d)]())[_0x5069b0(0x1a1)](-0x2),_0x205cba=('0'+(_0x56a284[_0x5069b0(0x189)]()+0x1))[_0x5069b0(0x1a1)](-0x2),_0x2e2e36=_0x56a284[_0x5069b0(0x209)](),_0x24102d=_0x2e2e36+'-'+_0x205cba+'-'+_0x2017d6;var _0x3b38f7=[_0x5069b0(0x207),_0x5069b0(0x175)];const _0x598d95=await warehouse[_0x5069b0(0x235)]([{'$match':{'name':_0x61ca1e[_0x5069b0(0x12d)],'room':_0x61ca1e['room']}},{'$unwind':_0x5069b0(0x173)},{'$group':{'_id':_0x5069b0(0x21a),'name':{'$first':_0x5069b0(0x19b)},'product_stock':{'$first':_0x5069b0(0x134)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x5069b0(0x1b6)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5069b0(0x216)},'primary_code':{'$first':_0x5069b0(0x130)},'secondary_code':{'$first':_0x5069b0(0x1f2)},'product_code':{'$first':_0x5069b0(0x1a6)},'storage':{'$first':_0x5069b0(0x1c3)},'rack':{'$first':_0x5069b0(0x179)}}}]),_0x1f6d16=await customer[_0x5069b0(0x234)]({});let _0x5b034e;if(_0x1b9183[_0x5069b0(0x19c)]==_0x5069b0(0x1f7)){const _0x4a9751=await staff[_0x5069b0(0x1d4)]({'email':_0x1b9183[_0x5069b0(0x220)]});_0x5b034e=await warehouse[_0x5069b0(0x235)]([{'$match':{'status':_0x5069b0(0x245),'name':_0x4a9751[_0x5069b0(0x1c5)]}},{'$group':{'_id':_0x5069b0(0x1db),'name':{'$first':_0x5069b0(0x1db)}}}]);}else _0x5b034e=await warehouse['aggregate']([{'$match':{'status':_0x5069b0(0x245)}},{'$group':{'_id':_0x5069b0(0x1db),'name':{'$first':'$name'}}}]);const _0x21f951=await product[_0x5069b0(0x234)]({});if(_0x235bc8[0x0][_0x5069b0(0x210)]==_0x5069b0(0x231)){var _0x4bf6d9=users['English'];console[_0x5069b0(0x202)](_0x4bf6d9);}else{if(_0x235bc8[0x0][_0x5069b0(0x210)]==_0x5069b0(0x208))var _0x4bf6d9=users[_0x5069b0(0x208)];else{if(_0x235bc8[0x0][_0x5069b0(0x210)]==_0x5069b0(0x18e))var _0x4bf6d9=users[_0x5069b0(0x18e)];else{if(_0x235bc8[0x0][_0x5069b0(0x210)]==_0x5069b0(0x125))var _0x4bf6d9=users[_0x5069b0(0x125)];else{if(_0x235bc8[0x0][_0x5069b0(0x210)]=='French')var _0x4bf6d9=users[_0x5069b0(0x246)];else{if(_0x235bc8[0x0]['language']=='Portuguese\x20(BR)')var _0x4bf6d9=users[_0x5069b0(0x1b0)];else{if(_0x235bc8[0x0][_0x5069b0(0x210)]==_0x5069b0(0x1a5))var _0x4bf6d9=users[_0x5069b0(0x1a5)];else{if(_0x235bc8[0x0][_0x5069b0(0x210)]==_0x5069b0(0x186))var _0x4bf6d9=users[_0x5069b0(0x1b3)];}}}}}}}_0x33c5b9[_0x5069b0(0x1c9)](_0x5069b0(0x149),{'success':_0x55878a[_0x5069b0(0x1d7)]('success'),'errors':_0x55878a[_0x5069b0(0x1d7)](_0x5069b0(0x224)),'role':_0x1b9183,'profile':_0x2d26a9,'customer':_0x1f6d16,'warehouse':_0x5b034e,'product':_0x598d95,'user':_0x61ca1e,'master_shop':_0x235bc8,'unit':_0x21f951,'language':_0x4bf6d9,'rooms_data':_0x3b38f7,'ed_fullDate':_0x24102d});}catch(_0x40d77a){console[_0x5069b0(0x202)](_0x40d77a);}}),router['post'](a0_0x2f8a4e(0x150),auth,async(_0x5bd21f,_0x4201fb)=>{var _0x32f3bb=a0_0x2f8a4e;try{const _0x2937d9=_0x5bd21f['params']['id'],_0x4bd81e=await sales_finished[_0x32f3bb(0x1d4)]({'_id':_0x5bd21f[_0x32f3bb(0x169)]['id']}),_0x2da4f7=await warehouse[_0x32f3bb(0x1d4)]({'name':_0x4bd81e[_0x32f3bb(0x12d)],'room':_0x5bd21f['body'][_0x32f3bb(0x14b)],'warehouse_category':_0x32f3bb(0x171)}),{invoice:_0x53c38b,customer:_0x2fc915,date:_0x8fe55d,warehouse_name:_0x216c52,product_name:_0x4efb34,stock:_0x4fb313,adjust_qty:_0x5ae43d,note:_0x36f530,room:_0x4d6025,primary_code:_0x19b541,secondary_code:_0x50b75c,prod_code:_0x18a92a,level:_0x1f4f26,isle:_0x26d732,pallet:_0x3d227e,expiry_date:_0xc4b004}=_0x5bd21f['body'];if(typeof _0x4efb34=='string')var _0x28a18d=[_0x5bd21f[_0x32f3bb(0x14e)][_0x32f3bb(0x244)]],_0x4bac88=[_0x5bd21f['body']['stock']],_0x569a7e=[_0x5bd21f['body'][_0x32f3bb(0x1c2)]],_0x3457c1=[_0x5bd21f[_0x32f3bb(0x14e)][_0x32f3bb(0x19e)]],_0x2efc0f=[_0x5bd21f[_0x32f3bb(0x14e)]['secondary_code']],_0xd91fff=[_0x5bd21f[_0x32f3bb(0x14e)][_0x32f3bb(0x1b9)]],_0x1d3733=[_0x5bd21f['body'][_0x32f3bb(0x13a)]],_0xcf3cdf=[_0x5bd21f['body'][_0x32f3bb(0x17f)]];else var _0x28a18d=[..._0x5bd21f[_0x32f3bb(0x14e)]['product_name']],_0x4bac88=[..._0x5bd21f[_0x32f3bb(0x14e)][_0x32f3bb(0x1c6)]],_0x569a7e=[..._0x5bd21f['body'][_0x32f3bb(0x1c2)]],_0x3457c1=[..._0x5bd21f['body'][_0x32f3bb(0x19e)]],_0x2efc0f=[..._0x5bd21f[_0x32f3bb(0x14e)][_0x32f3bb(0x123)]],_0xd91fff=[..._0x5bd21f[_0x32f3bb(0x14e)]['prod_code']],_0x1d3733=[..._0x5bd21f[_0x32f3bb(0x14e)][_0x32f3bb(0x13a)]],_0xcf3cdf=[..._0x5bd21f[_0x32f3bb(0x14e)][_0x32f3bb(0x17f)]];const _0x3a3a03=_0x28a18d['map'](_0x1b061b=>{return _0x1b061b={'product_name':_0x1b061b};});_0x4bac88[_0x32f3bb(0x232)]((_0x3efd24,_0x14ca54)=>{var _0x478e23=_0x32f3bb;_0x3a3a03[_0x14ca54][_0x478e23(0x1c6)]=_0x3efd24;}),_0x569a7e[_0x32f3bb(0x232)]((_0x36728c,_0x26082a)=>{var _0x4dc4b4=_0x32f3bb;_0x3a3a03[_0x26082a][_0x4dc4b4(0x1cf)]=_0x36728c;}),_0x3457c1[_0x32f3bb(0x232)]((_0x19fbe8,_0x15babe)=>{_0x3a3a03[_0x15babe]['primary_code']=_0x19fbe8;}),_0x2efc0f['forEach']((_0x3180af,_0x140be2)=>{var _0xbe8a0b=_0x32f3bb;_0x3a3a03[_0x140be2][_0xbe8a0b(0x123)]=_0x3180af;}),_0xd91fff[_0x32f3bb(0x232)]((_0x58ea15,_0x2a058e)=>{var _0x31df41=_0x32f3bb;_0x3a3a03[_0x2a058e][_0x31df41(0x16b)]=_0x58ea15;}),_0x1d3733[_0x32f3bb(0x232)]((_0x10acb8,_0x188240)=>{var _0x1e73dc=_0x32f3bb;_0x3a3a03[_0x188240][_0x1e73dc(0x13a)]=_0x10acb8;}),_0xcf3cdf['forEach']((_0x36439c,_0x5e4e35)=>{var _0x5e028a=_0x32f3bb;_0x3a3a03[_0x5e4e35][_0x5e028a(0x17f)]=_0x36439c;});var _0x19bf2f=0x0;_0x3a3a03[_0x32f3bb(0x232)](_0x128ebe=>{var _0x5a514b=_0x32f3bb;console[_0x5a514b(0x202)](_0x5a514b(0x17a),_0x128ebe),(parseInt(_0x128ebe['stock'])<parseInt(_0x128ebe[_0x5a514b(0x1cf)])||parseInt(_0x128ebe[_0x5a514b(0x1cf)])==0x0)&&_0x19bf2f++;});if(_0x19bf2f!=0x0)return _0x5bd21f[_0x32f3bb(0x1d7)](_0x32f3bb(0x224),_0x32f3bb(0x219)),_0x4201fb[_0x32f3bb(0x21e)]('back');_0x4bd81e['sale_product'][_0x32f3bb(0x232)](_0x2b2177=>{var _0x271458=_0x32f3bb;const _0x27023c=_0x2da4f7[_0x271458(0x183)][_0x271458(0x140)](_0x413577=>{var _0x4fb1bb=_0x271458;_0x413577[_0x4fb1bb(0x244)]==_0x2b2177[_0x4fb1bb(0x244)]&&_0x413577['bay']==_0x2b2177[_0x4fb1bb(0x157)]&&(_0x413577[_0x4fb1bb(0x1a3)]=parseInt(_0x413577['product_stock'])+parseInt(_0x2b2177[_0x4fb1bb(0x1cf)]));});}),await _0x2da4f7['save']();const _0x5cbabb=_0x3a3a03['filter'](_0x48eae6=>_0x48eae6[_0x32f3bb(0x1cf)]!=='0'&&_0x48eae6['quantity']!=='');_0x4bd81e[_0x32f3bb(0x170)]=_0x53c38b,_0x4bd81e[_0x32f3bb(0x1cb)]=_0x2fc915,_0x4bd81e[_0x32f3bb(0x192)]=_0x8fe55d,_0x4bd81e[_0x32f3bb(0x12d)]=_0x216c52,_0x4bd81e[_0x32f3bb(0x20d)]=_0x5cbabb,_0x4bd81e[_0x32f3bb(0x1a0)]=_0x36f530,_0x4bd81e['room']=_0x4d6025;const _0x3ef7b3=await _0x4bd81e['save'](),_0x201aee=await sales_finished[_0x32f3bb(0x1d4)]({'_id':_0x5bd21f[_0x32f3bb(0x169)]['id']}),_0x51f751=await warehouse[_0x32f3bb(0x1d4)]({'name':_0x216c52,'room':_0x4d6025,'warehouse_category':_0x32f3bb(0x171)});_0x201aee[_0x32f3bb(0x20d)]['forEach'](_0x43d2f3=>{var _0x52f85e=_0x32f3bb;const _0x1a437d=_0x51f751[_0x52f85e(0x183)][_0x52f85e(0x140)](_0x102dcb=>{var _0x117bfa=_0x52f85e;_0x102dcb['product_name']==_0x43d2f3['product_name']&&_0x102dcb[_0x117bfa(0x157)]==_0x43d2f3['bay']&&(_0x102dcb[_0x117bfa(0x1a3)]=parseInt(_0x102dcb[_0x117bfa(0x1a3)])-parseInt(_0x43d2f3[_0x117bfa(0x1cf)]));});}),console[_0x32f3bb(0x202)](_0x32f3bb(0x248),_0x51f751),await _0x51f751[_0x32f3bb(0x226)]();const _0xd87057=await c_payment_data[_0x32f3bb(0x1d4)]({'invoice':_0x5bd21f['body'][_0x32f3bb(0x170)]});_0xd87057[_0x32f3bb(0x1bd)]=_0x5bd21f[_0x32f3bb(0x14e)][_0x32f3bb(0x1bd)],await _0xd87057[_0x32f3bb(0x226)](),_0x5bd21f['flash'](_0x32f3bb(0x228),_0x32f3bb(0x181)),_0x4201fb[_0x32f3bb(0x21e)](_0x32f3bb(0x14a));}catch(_0x11c01d){console[_0x32f3bb(0x202)](_0x11c01d);}}),router[a0_0x2f8a4e(0x1e4)](a0_0x2f8a4e(0x1e0),auth,async(_0x42e51d,_0x2df70b)=>{var _0x5e4722=a0_0x2f8a4e;try{const _0x4a0b8f=_0x42e51d[_0x5e4722(0x169)]['id'],{invoice:_0x262e05,customer:_0x334ea8,receivable_amount:_0x42928e,received_amount:_0x37b5ca}=_0x42e51d[_0x5e4722(0x14e)],_0x4ef90c=await sales[_0x5e4722(0x214)](_0x4a0b8f);console[_0x5e4722(0x202)](_0x4ef90c);var _0x3197f8=_0x42928e-_0x37b5ca;console[_0x5e4722(0x202)](_0x37b5ca),_0x4ef90c[_0x5e4722(0x137)]=parseFloat(_0x37b5ca)+parseFloat(_0x4ef90c['received_amount']),_0x4ef90c[_0x5e4722(0x182)]=_0x3197f8,console['log'](_0x4ef90c);const _0x4da18b=await _0x4ef90c[_0x5e4722(0x226)](),_0x42090d=await c_payment_data[_0x5e4722(0x1d4)]({'invoice':_0x262e05});_0x42090d[_0x5e4722(0x218)]=_0x3197f8,await _0x42090d[_0x5e4722(0x226)]();let _0x3e3c49=new Date(),_0x3d524e=('0'+_0x3e3c49['getDate']())[_0x5e4722(0x1a1)](-0x2),_0x67a40b=('0'+(_0x3e3c49['getMonth']()+0x1))['slice'](-0x2),_0xe60bf3=_0x3e3c49[_0x5e4722(0x209)](),_0x1592a9=_0xe60bf3+'-'+_0x67a40b+'-'+_0x3d524e;const _0x4c4597=new customer_payment({'invoice':_0x262e05,'date':_0xe60bf3+'-'+_0x67a40b+'-'+_0x3d524e,'customer':_0x334ea8,'reason':_0x5e4722(0x13c),'amount':_0x37b5ca}),_0x25bd83=await _0x4c4597[_0x5e4722(0x226)]();_0x42e51d[_0x5e4722(0x1d7)]('success',_0x5e4722(0x12e)),_0x2df70b['redirect'](_0x5e4722(0x1e8));}catch(_0x2b3660){console[_0x5e4722(0x202)](_0x2b3660);}}),router[a0_0x2f8a4e(0x18d)](a0_0x2f8a4e(0x221),auth,async(_0x59f8e9,_0x3ddb4a)=>{var _0x27ffc0=a0_0x2f8a4e;try{const {username:_0x299c82,email:_0x32fde6,role:_0x342fbe}=_0x59f8e9['user'],_0x5489da=_0x59f8e9[_0x27ffc0(0x18f)],_0x54732b=await profile['findOne']({'email':_0x5489da['email']}),_0x34155a=await master_shop[_0x27ffc0(0x234)]();console['log'](_0x27ffc0(0x18c),_0x34155a);const _0x4acab1=_0x59f8e9[_0x27ffc0(0x169)]['id'],_0x1c8405=await sales[_0x27ffc0(0x214)](_0x4acab1);console[_0x27ffc0(0x202)](_0x1c8405);const _0x19ac3f=await customer[_0x27ffc0(0x1d4)]({'name':_0x1c8405[_0x27ffc0(0x1cb)]});console[_0x27ffc0(0x202)](_0x19ac3f);if(_0x34155a[0x0][_0x27ffc0(0x210)]==_0x27ffc0(0x231)){var _0x8bbb33=users[_0x27ffc0(0x20c)];console[_0x27ffc0(0x202)](_0x8bbb33);}else{if(_0x34155a[0x0][_0x27ffc0(0x210)]=='Hindi')var _0x8bbb33=users[_0x27ffc0(0x208)];else{if(_0x34155a[0x0]['language']==_0x27ffc0(0x18e))var _0x8bbb33=users[_0x27ffc0(0x18e)];else{if(_0x34155a[0x0]['language']==_0x27ffc0(0x125))var _0x8bbb33=users[_0x27ffc0(0x125)];else{if(_0x34155a[0x0][_0x27ffc0(0x210)]==_0x27ffc0(0x246))var _0x8bbb33=users['French'];else{if(_0x34155a[0x0][_0x27ffc0(0x210)]==_0x27ffc0(0x198))var _0x8bbb33=users['Portuguese'];else{if(_0x34155a[0x0][_0x27ffc0(0x210)]==_0x27ffc0(0x1a5))var _0x8bbb33=users[_0x27ffc0(0x1a5)];else{if(_0x34155a[0x0][_0x27ffc0(0x210)]=='Arabic\x20(ae)')var _0x8bbb33=users['Arabic'];}}}}}}}_0x3ddb4a[_0x27ffc0(0x1c9)]('sales_invoice',{'success':_0x59f8e9['flash']('success'),'errors':_0x59f8e9['flash']('errors'),'role':_0x5489da,'profile':_0x54732b,'master_shop':_0x34155a,'customers':_0x19ac3f,'sales':_0x1c8405,'language':_0x8bbb33});}catch(_0x15766f){console['log'](_0x15766f);}}),router[a0_0x2f8a4e(0x18d)]('/view/return_sales/:id',auth,async(_0x1c28b5,_0x3dd508)=>{var _0x3e7133=a0_0x2f8a4e;try{const {username:_0x4534db,email:_0x4680ec,role:_0x524037}=_0x1c28b5['user'],_0x16d3ea=_0x1c28b5['user'],_0x1f9198=await profile[_0x3e7133(0x1d4)]({'email':_0x16d3ea[_0x3e7133(0x220)]}),_0xc32afe=await master_shop[_0x3e7133(0x234)](),_0x226d79=_0x1c28b5[_0x3e7133(0x169)]['id'],_0x1a8b48=await sales_finished[_0x3e7133(0x214)](_0x226d79),_0x4fd477=await warehouse[_0x3e7133(0x235)]([{'$match':{'name':_0x1a8b48[_0x3e7133(0x12d)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3e7133(0x21a),'name':{'$first':_0x3e7133(0x19b)},'product_stock':{'$first':_0x3e7133(0x134)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x3e7133(0x1b6)},'type':{'$first':_0x3e7133(0x176)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x3e7133(0x130)},'secondary_code':{'$first':_0x3e7133(0x1f2)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3e7133(0x179)},'expiry_date':{'$first':_0x3e7133(0x131)},'production_date':{'$first':_0x3e7133(0x13b)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x3e7133(0x215)},'maxProducts':{'$first':_0x3e7133(0x17e)},'batch_code':{'$first':_0x3e7133(0x22a)},'maxPerUnit':{'$first':_0x3e7133(0x23a)}}}]),_0x401803=await product[_0x3e7133(0x234)]({}),_0xad812=await warehouse[_0x3e7133(0x235)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods','name':{'$ne':_0x3e7133(0x12c),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':_0x3e7133(0x1db),'name':{'$first':_0x3e7133(0x1db)}}},{'$sort':{'name':0x1}}]);var _0x2827df=[_0x3e7133(0x22c)];const _0x27029c=await warehouse[_0x3e7133(0x235)]([{'$match':{'status':'Enabled','name':_0x3e7133(0x132)}},{'$group':{'_id':'$name','name':{'$first':_0x3e7133(0x1db)}}},{'$sort':{'name':0x1}}]);if(_0xc32afe[0x0][_0x3e7133(0x210)]=='English\x20(US)'){var _0x97342b=users[_0x3e7133(0x20c)];console[_0x3e7133(0x202)](_0x97342b);}else{if(_0xc32afe[0x0][_0x3e7133(0x210)]==_0x3e7133(0x208))var _0x97342b=users[_0x3e7133(0x208)];else{if(_0xc32afe[0x0][_0x3e7133(0x210)]=='German')var _0x97342b=users[_0x3e7133(0x18e)];else{if(_0xc32afe[0x0][_0x3e7133(0x210)]=='Spanish')var _0x97342b=users[_0x3e7133(0x125)];else{if(_0xc32afe[0x0][_0x3e7133(0x210)]=='French')var _0x97342b=users['French'];else{if(_0xc32afe[0x0][_0x3e7133(0x210)]=='Portuguese\x20(BR)')var _0x97342b=users[_0x3e7133(0x1b0)];else{if(_0xc32afe[0x0]['language']==_0x3e7133(0x1a5))var _0x97342b=users['Chinese'];else{if(_0xc32afe[0x0][_0x3e7133(0x210)]=='Arabic\x20(ae)')var _0x97342b=users[_0x3e7133(0x1b3)];}}}}}}}_0x3dd508['render'](_0x3e7133(0x1fc),{'success':_0x1c28b5[_0x3e7133(0x1d7)]('success'),'errors':_0x1c28b5[_0x3e7133(0x1d7)](_0x3e7133(0x224)),'role':_0x16d3ea,'profile':_0x1f9198,'user':_0x1a8b48,'stock':_0x4fd477,'master_shop':_0xc32afe,'unit':_0x401803,'language':_0x97342b,'warehouses':_0xad812,'rooms':_0x2827df,'warehouse_QA':_0x27029c});}catch(_0x4b9916){console[_0x3e7133(0x202)](_0x4b9916),_0x3dd508['status'](0xc8)['json']({'message':_0x4b9916['message']});}}),router[a0_0x2f8a4e(0x1e4)]('/view/return_sales/:id',auth,async(_0x3d6db5,_0xdaf434)=>{var _0x9f5c1f=a0_0x2f8a4e;if(_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x22b)]=='QA')try{const {invoice:_0x1b2805,date:_0x4ae176,warehouse_name:_0x3ef66a,product_name:_0x40a52e,primary_code:_0x3febb3,secondary_code:_0xdabfcb,product_code:_0x1274ce,sales_quantity:_0x264281,stocks:_0x1b353e,return_qty:_0x22adba,Room_name:_0x15261e,to_warehouse_name_QA:_0x46aeb4,to_Room_name_QA:_0x4aa02d,note:_0x3ef905,for_categorize:_0x2c63b4,product_name_QA1:_0x160887}=_0x3d6db5[_0x9f5c1f(0x14e)];if(typeof _0x160887==_0x9f5c1f(0x135))var _0x133b56=[_0x3d6db5['body'][_0x9f5c1f(0x174)]],_0x35fbd0=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1f1)]],_0x34475e=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x133)]],_0x10e5da=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x19f)]],_0x4e2e3c=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x13f)]],_0x148049=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x17c)]],_0x4b3e2a=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x136)]],_0x55cab6=[_0x3d6db5['body'][_0x9f5c1f(0x1ab)]],_0x1c8b01=[_0x3d6db5[_0x9f5c1f(0x14e)]['maxProducts_QA']],_0x11c261=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x185)]],_0x36663f=[_0x3d6db5[_0x9f5c1f(0x14e)]['secondary_unit_QA']],_0x296a0f=[_0x3d6db5['body'][_0x9f5c1f(0x14f)]],_0x215c19=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x191)]],_0x4096cf=[_0x3d6db5['body']['expiry_date_QA']];else var _0x133b56=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x174)]],_0x35fbd0=[..._0x3d6db5['body'][_0x9f5c1f(0x1f1)]],_0x34475e=[..._0x3d6db5['body'][_0x9f5c1f(0x133)]],_0x10e5da=[..._0x3d6db5[_0x9f5c1f(0x14e)]['product_code_QA']],_0x4e2e3c=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x13f)]],_0x148049=[..._0x3d6db5[_0x9f5c1f(0x14e)]['stocks_QA']],_0x4b3e2a=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x136)]],_0x55cab6=[..._0x3d6db5['body'][_0x9f5c1f(0x1ab)]],_0x1c8b01=[..._0x3d6db5[_0x9f5c1f(0x14e)]['maxProducts_QA']],_0x11c261=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x185)]],_0x36663f=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x196)]],_0x296a0f=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x14f)]],_0x215c19=[..._0x3d6db5['body'][_0x9f5c1f(0x191)]],_0x4096cf=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x138)]];const _0x26c4b1=_0x133b56[_0x9f5c1f(0x140)](_0x487920=>{return _0x487920={'product_name':_0x487920};});_0x35fbd0[_0x9f5c1f(0x232)]((_0x33c0ed,_0x2503ed)=>{var _0x5e290c=_0x9f5c1f;_0x26c4b1[_0x2503ed][_0x5e290c(0x19e)]=_0x33c0ed;}),_0x34475e[_0x9f5c1f(0x232)]((_0x19c963,_0x116012)=>{_0x26c4b1[_0x116012]['secondary_code']=_0x19c963;}),_0x10e5da[_0x9f5c1f(0x232)]((_0x28e41d,_0x3a79f7)=>{var _0x1a7341=_0x9f5c1f;_0x26c4b1[_0x3a79f7][_0x1a7341(0x16b)]=_0x28e41d;}),_0x4e2e3c[_0x9f5c1f(0x232)]((_0xb0a67e,_0x3a8ed1)=>{var _0x26d591=_0x9f5c1f;_0x26c4b1[_0x3a8ed1][_0x26d591(0x145)]=_0xb0a67e;}),_0x148049[_0x9f5c1f(0x232)]((_0x5cfcbb,_0x4c9294)=>{_0x26c4b1[_0x4c9294]['stock']=_0x5cfcbb;}),_0x4b3e2a[_0x9f5c1f(0x232)]((_0x120b7b,_0x23ec82)=>{var _0x54e3b9=_0x9f5c1f;_0x26c4b1[_0x23ec82][_0x54e3b9(0x237)]=_0x120b7b;}),_0x55cab6['forEach']((_0x42da30,_0x4ca0fa)=>{var _0x1b709f=_0x9f5c1f;_0x26c4b1[_0x4ca0fa][_0x1b709f(0x23c)]=_0x42da30;}),_0x1c8b01[_0x9f5c1f(0x232)]((_0x351c01,_0x23351f)=>{var _0xe78161=_0x9f5c1f;_0x26c4b1[_0x23351f][_0xe78161(0x1a4)]=_0x351c01;}),_0x11c261[_0x9f5c1f(0x232)]((_0x3f1992,_0xa1bd2c)=>{var _0x2fb35f=_0x9f5c1f;_0x26c4b1[_0xa1bd2c][_0x2fb35f(0x1b1)]=_0x3f1992;}),_0x36663f[_0x9f5c1f(0x232)]((_0xd258c0,_0x2a5256)=>{_0x26c4b1[_0x2a5256]['secondary_unit']=_0xd258c0;}),_0x296a0f[_0x9f5c1f(0x232)]((_0x4ee9b8,_0x2bac32)=>{var _0x5c52de=_0x9f5c1f;_0x26c4b1[_0x2bac32][_0x5c52de(0x1ac)]=_0x4ee9b8;}),_0x215c19[_0x9f5c1f(0x232)]((_0x7204d5,_0x4ef14a)=>{var _0x4babf3=_0x9f5c1f;_0x26c4b1[_0x4ef14a][_0x4babf3(0x153)]=_0x7204d5;}),_0x4096cf[_0x9f5c1f(0x232)]((_0x18e584,_0x32416d)=>{var _0x18bc70=_0x9f5c1f;_0x26c4b1[_0x32416d][_0x18bc70(0x17f)]=_0x18e584;});const _0x919e0c=await sales_finished[_0x9f5c1f(0x1d4)]({'invoice':_0x1b2805});_0x919e0c['return_data']=_0x9f5c1f(0x15e);const _0x1cd3bb=await _0x919e0c[_0x9f5c1f(0x226)](),_0x19c378=new sales_return_finished({'invoice':_0x1b2805,'customer':_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1cb)],'date':_0x4ae176,'warehouse_name':_0x3ef66a,'room':_0x15261e,'ToWarehouse':_0x46aeb4,'ToRoom':_0x4aa02d,'return_sale_QA':_0x26c4b1,'note':_0x3ef905,'warehouse_cat':_0x2c63b4}),_0x4fc3da=await _0x19c378[_0x9f5c1f(0x226)](),_0x32e214=await sales_return_finished[_0x9f5c1f(0x1d4)]({'invoice':_0x1b2805}),_0x48f7c9=await warehouse['findOne']({'name':_0x46aeb4,'room':_0x4aa02d});_0x32e214['return_sale_QA'][_0x9f5c1f(0x232)](_0x4701ae=>{var _0x522926=_0x9f5c1f,_0x4689eb=0x0;const _0x36f2c1=_0x48f7c9[_0x522926(0x183)][_0x522926(0x140)](_0x478093=>{var _0x7d35d5=_0x522926;_0x478093[_0x7d35d5(0x244)]==_0x4701ae[_0x7d35d5(0x244)]&&_0x478093[_0x7d35d5(0x17f)]==_0x4701ae[_0x7d35d5(0x17f)]&&_0x478093[_0x7d35d5(0x153)]==_0x4701ae[_0x7d35d5(0x153)]&&_0x478093[_0x7d35d5(0x1b1)]==_0x4701ae[_0x7d35d5(0x1b1)]&&(_0x478093['product_stock']=parseInt(_0x478093[_0x7d35d5(0x1a3)])+parseInt(_0x4701ae['return_qty']),_0x4689eb++);});_0x4689eb=='0'&&(_0x48f7c9[_0x522926(0x183)]=_0x48f7c9[_0x522926(0x183)][_0x522926(0x159)]({'product_name':_0x4701ae[_0x522926(0x244)],'product_stock':_0x4701ae[_0x522926(0x237)],'primary_code':_0x4701ae[_0x522926(0x19e)],'secondary_code':_0x4701ae['secondary_code'],'product_code':_0x4701ae[_0x522926(0x16b)],'batch_code':_0x4701ae[_0x522926(0x1b1)],'maxPerUnit':_0x4701ae[_0x522926(0x23c)],'production_date':_0x4701ae[_0x522926(0x153)],'expiry_date':_0x4701ae[_0x522926(0x17f)],'secondary_unit':_0x4701ae[_0x522926(0x177)],'unit':_0x4701ae['unit'],'maxProducts':_0x4701ae[_0x522926(0x1a4)],'bay':_0x4701ae['bay']}));}),await _0x48f7c9[_0x9f5c1f(0x226)]();const _0x5cb68b=new c_payment_data({'invoice':_0x1b2805,'customer':_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1cb)],'reason':'Sale\x20Return'});await _0x5cb68b['save']();const _0x3a5b97=await master_shop[_0x9f5c1f(0x234)](),_0x17c9a8=await email_settings['findOne'](),_0x5058ef=await customer[_0x9f5c1f(0x1d4)]({'name':_0x3d6db5['body']['customer']});_0x3a5b97[0x0][_0x9f5c1f(0x23e)]==0x1?(right_currency=_0x3a5b97[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x3a5b97[0x0][_0x9f5c1f(0x1f3)]);var _0x5c358e=_0x133b56,_0x5004ca=_0x4b3e2a,_0x441cff='',_0x44bce0;for(_0x44bce0 in _0x5c358e){_0x441cff+='<tr>'+_0x9f5c1f(0x1b2)+_0x5c358e[_0x44bce0]+_0x9f5c1f(0x1eb)+_0x9f5c1f(0x1b2)+_0x5004ca[_0x44bce0]+_0x9f5c1f(0x1eb)+'</tr>';}console[_0x9f5c1f(0x202)](_0x9f5c1f(0x127),_0x441cff);let _0x50f78c=nodemailer[_0x9f5c1f(0x1b5)]({'service':'gmail','auth':{'user':_0x17c9a8[_0x9f5c1f(0x220)],'pass':_0x17c9a8[_0x9f5c1f(0x229)]}}),_0x1b3a98={'from':_0x17c9a8[_0x9f5c1f(0x220)],'to':_0x5058ef[_0x9f5c1f(0x220)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x9f5c1f(0x21d),'path':__dirname+'/../public'+'/upload/'+_0x3a5b97[0x0][_0x9f5c1f(0x154)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x9f5c1f(0x15d)+'</head><body>'+'<div>'+_0x9f5c1f(0x227)+_0x9f5c1f(0x1af)+_0x9f5c1f(0x23d)+_0x9f5c1f(0x1d1)+_0x9f5c1f(0x1af)+'<h2>\x20'+_0x3a5b97[0x0]['site_title']+_0x9f5c1f(0x205)+'</div>'+_0x9f5c1f(0x1d1)+_0x9f5c1f(0x16f)+_0x9f5c1f(0x1af)+_0x9f5c1f(0x15a)+_0x9f5c1f(0x204)+_0x1b2805+'\x20'+_0x9f5c1f(0x13e)+_0x9f5c1f(0x242)+_0x4ae176+'\x20'+_0x9f5c1f(0x1ef)+_0x9f5c1f(0x225)+_0x9f5c1f(0x1d1)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x9f5c1f(0x17b)+'<tr>'+_0x9f5c1f(0x1d9)+_0x9f5c1f(0x1d5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x9f5c1f(0x247)+'</tr>'+_0x9f5c1f(0x16c)+_0x9f5c1f(0x1f0)+'\x20'+_0x441cff+'\x20'+_0x9f5c1f(0x249)+_0x9f5c1f(0x1d8)+_0x9f5c1f(0x1af)+_0x9f5c1f(0x148)+'<h5>'+_0x3a5b97[0x0][_0x9f5c1f(0x1a2)]+_0x9f5c1f(0x225)+_0x9f5c1f(0x1d1)+_0x9f5c1f(0x1d1)+_0x9f5c1f(0x172)};_0x50f78c[_0x9f5c1f(0x222)](_0x1b3a98,function(_0x35374d,_0x399c08){var _0x24756a=_0x9f5c1f;_0x35374d?(console['log'](_0x35374d),console[_0x24756a(0x202)](_0x24756a(0x1b8))):console['log'](_0x24756a(0x1ec));}),_0x3d6db5[_0x9f5c1f(0x1d7)](_0x9f5c1f(0x228),_0x9f5c1f(0x1d0)),_0xdaf434[_0x9f5c1f(0x21e)]('/all_sales_finished/view');}catch(_0x283d94){_0xdaf434[_0x9f5c1f(0x239)](0xc8)[_0x9f5c1f(0x1b7)]({'message1':_0x283d94[_0x9f5c1f(0x152)]});}else{if(_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x22b)]=='GS')try{const {invoice:_0x23417d,date:_0x3f5082,warehouse_name:_0x5977d6,product_name:_0x3da6f5,primary_code:_0x5dfec6,secondary_code:_0x43c134,product_code:_0x435c93,sales_quantity:_0x2313c2,stocks:_0x10e49e,return_qty:_0x39ada2,Room_name:_0xc8614d,to_warehouse_name:_0x5802ee,to_Room_name:_0x5dfb14,note:_0x24a20a,level:_0x38fc65,isle:_0x5861a4,pallet:_0x50739c,for_categorize:_0x49d2ba}=_0x3d6db5[_0x9f5c1f(0x14e)];if(typeof _0x3da6f5=='string')var _0x133b56=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x244)]],_0x35fbd0=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x19e)]],_0x34475e=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x123)]],_0x10e5da=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x16b)]],_0x4e2e3c=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x236)]],_0x4b3e2a=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x237)]],_0x1c7898=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x157)]],_0x55cab6=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x23c)]],_0x1c8b01=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1a4)]],_0x11c261=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1b1)]],_0x36663f=[_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x177)]],_0x296a0f=[_0x3d6db5['body'][_0x9f5c1f(0x1ac)]],_0x215c19=[_0x3d6db5[_0x9f5c1f(0x14e)]['production_date']],_0x4096cf=[_0x3d6db5['body']['expiry_date']];else var _0x133b56=[..._0x3d6db5['body'][_0x9f5c1f(0x244)]],_0x35fbd0=[..._0x3d6db5[_0x9f5c1f(0x14e)]['primary_code']],_0x34475e=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x123)]],_0x10e5da=[..._0x3d6db5[_0x9f5c1f(0x14e)]['product_code']],_0x4e2e3c=[..._0x3d6db5['body'][_0x9f5c1f(0x236)]],_0x4b3e2a=[..._0x3d6db5['body']['return_qty']],_0x1c7898=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x157)]],_0x55cab6=[..._0x3d6db5['body']['maxPerUnit']],_0x1c8b01=[..._0x3d6db5[_0x9f5c1f(0x14e)]['maxProducts']],_0x11c261=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1b1)]],_0x36663f=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x177)]],_0x296a0f=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1ac)]],_0x215c19=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x153)]],_0x4096cf=[..._0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x17f)]];const _0x149ae4=_0x133b56[_0x9f5c1f(0x140)](_0x59929b=>{return _0x59929b={'product_name':_0x59929b};});_0x35fbd0[_0x9f5c1f(0x232)]((_0x5ce442,_0x520f26)=>{var _0x1a1b0b=_0x9f5c1f;_0x149ae4[_0x520f26][_0x1a1b0b(0x19e)]=_0x5ce442;}),_0x34475e[_0x9f5c1f(0x232)]((_0x1a5c63,_0x58fa22)=>{_0x149ae4[_0x58fa22]['secondary_code']=_0x1a5c63;}),_0x10e5da[_0x9f5c1f(0x232)]((_0x5339a5,_0xa92c4e)=>{var _0x53338e=_0x9f5c1f;_0x149ae4[_0xa92c4e][_0x53338e(0x16b)]=_0x5339a5;}),_0x4e2e3c[_0x9f5c1f(0x232)]((_0x7a8c0a,_0x383bf7)=>{_0x149ae4[_0x383bf7]['sale_qty']=_0x7a8c0a;}),_0x4b3e2a[_0x9f5c1f(0x232)]((_0x1f589f,_0x278213)=>{_0x149ae4[_0x278213]['return_qty']=_0x1f589f;}),_0x1c7898[_0x9f5c1f(0x232)]((_0x174532,_0x25e359)=>{var _0x56cc64=_0x9f5c1f;_0x149ae4[_0x25e359][_0x56cc64(0x157)]=_0x174532;}),_0x55cab6[_0x9f5c1f(0x232)]((_0x1cde40,_0x12559d)=>{var _0x52455=_0x9f5c1f;_0x149ae4[_0x12559d][_0x52455(0x23c)]=_0x1cde40;}),_0x1c8b01[_0x9f5c1f(0x232)]((_0x5ba555,_0x449a14)=>{_0x149ae4[_0x449a14]['maxProducts']=_0x5ba555;}),_0x11c261[_0x9f5c1f(0x232)]((_0x344f88,_0x1debf0)=>{var _0x8623e2=_0x9f5c1f;_0x149ae4[_0x1debf0][_0x8623e2(0x1b1)]=_0x344f88;}),_0x36663f[_0x9f5c1f(0x232)]((_0x369bdb,_0x249f22)=>{var _0x5822f7=_0x9f5c1f;_0x149ae4[_0x249f22][_0x5822f7(0x177)]=_0x369bdb;}),_0x296a0f[_0x9f5c1f(0x232)]((_0x16d6b7,_0x214761)=>{_0x149ae4[_0x214761]['unit']=_0x16d6b7;}),_0x215c19['forEach']((_0x3eb2f8,_0x3c4509)=>{var _0x3f2980=_0x9f5c1f;_0x149ae4[_0x3c4509][_0x3f2980(0x153)]=_0x3eb2f8;}),_0x4096cf[_0x9f5c1f(0x232)]((_0x5d6066,_0x58b9d7)=>{var _0x197f32=_0x9f5c1f;_0x149ae4[_0x58b9d7][_0x197f32(0x17f)]=_0x5d6066;});var _0x14333a=0x0;_0x149ae4[_0x9f5c1f(0x232)](_0x3e061e=>{var _0x581aad=_0x9f5c1f;(parseInt(_0x3e061e[_0x581aad(0x145)])<parseInt(_0x3e061e[_0x581aad(0x237)])||parseInt(_0x3e061e[_0x581aad(0x1c6)])<parseInt(_0x3e061e[_0x581aad(0x237)])&&parseInt(_0x3e061e[_0x581aad(0x145)])>parseInt(_0x3e061e['return_qty'])||parseInt(_0x3e061e[_0x581aad(0x237)])==0x0)&&_0x14333a++;});if(_0x14333a!=0x0)return _0x3d6db5[_0x9f5c1f(0x1d7)](_0x9f5c1f(0x224),_0x9f5c1f(0x195)),_0xdaf434['redirect'](_0x9f5c1f(0x15b));const _0x5182f1=await sales_finished[_0x9f5c1f(0x1d4)]({'invoice':_0x23417d});_0x5182f1['return_data']=_0x9f5c1f(0x15e);const _0x30d5d0=await _0x5182f1['save'](),_0x181c26=new sales_return_finished({'invoice':_0x23417d,'customer':_0x3d6db5['body'][_0x9f5c1f(0x1cb)],'date':_0x3f5082,'warehouse_name':_0x5977d6,'room':_0xc8614d,'ToWarehouse':_0x5802ee,'ToRoom':_0x5dfb14,'return_sale':_0x149ae4,'note':_0x24a20a,'warehouse_cat':_0x49d2ba}),_0x3dbc76=await _0x181c26[_0x9f5c1f(0x226)](),_0x3039a5=await sales_return_finished['findOne']({'invoice':_0x23417d}),_0x5c2a47=await warehouse[_0x9f5c1f(0x1d4)]({'name':_0x5802ee,'room':_0x5dfb14,'warehouse_category':_0x9f5c1f(0x171)});_0x3039a5[_0x9f5c1f(0x20a)][_0x9f5c1f(0x232)](_0xd6ec21=>{var _0x559f60=_0x9f5c1f,_0x357cd2=0x0;const _0x1ca0cd=_0x5c2a47[_0x559f60(0x183)]['map'](_0x228a4a=>{var _0x448823=_0x559f60;_0x228a4a[_0x448823(0x244)]==_0xd6ec21[_0x448823(0x244)]&&_0x228a4a[_0x448823(0x157)]==_0xd6ec21[_0x448823(0x157)]&&_0x228a4a[_0x448823(0x17f)]==_0xd6ec21[_0x448823(0x17f)]&&_0x228a4a[_0x448823(0x153)]==_0xd6ec21['production_date']&&_0x228a4a[_0x448823(0x1b1)]==_0xd6ec21[_0x448823(0x1b1)]&&(_0x228a4a[_0x448823(0x1a3)]=parseInt(_0x228a4a[_0x448823(0x1a3)])+parseInt(_0xd6ec21[_0x448823(0x237)]),_0x357cd2++);});_0x357cd2=='0'&&(_0x5c2a47[_0x559f60(0x183)]=_0x5c2a47[_0x559f60(0x183)][_0x559f60(0x159)]({'product_name':_0xd6ec21['product_name'],'product_stock':_0xd6ec21['return_qty'],'primary_code':_0xd6ec21[_0x559f60(0x19e)],'secondary_code':_0xd6ec21[_0x559f60(0x123)],'product_code':_0xd6ec21[_0x559f60(0x16b)],'bay':_0xd6ec21['bay'],'batch_code':_0xd6ec21[_0x559f60(0x1b1)],'maxPerUnit':_0xd6ec21[_0x559f60(0x23c)],'production_date':_0xd6ec21['production_date'],'expiry_date':_0xd6ec21[_0x559f60(0x17f)],'secondary_unit':_0xd6ec21[_0x559f60(0x177)],'unit':_0xd6ec21[_0x559f60(0x1ac)],'maxProducts':_0xd6ec21[_0x559f60(0x1a4)]}));}),await _0x5c2a47[_0x9f5c1f(0x226)](),console['log'](_0x3d6db5['body']);const _0x195ea1=new c_payment_data({'invoice':_0x23417d,'customer':_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1cb)],'reason':_0x9f5c1f(0x1bc)});await _0x195ea1[_0x9f5c1f(0x226)]();const _0xc9a1d6=await master_shop[_0x9f5c1f(0x234)]();console[_0x9f5c1f(0x202)](_0x9f5c1f(0x1c0),_0xc9a1d6[0x0][_0x9f5c1f(0x154)]);const _0x2f2970=await email_settings[_0x9f5c1f(0x1d4)](),_0x1afb90=await customer['findOne']({'name':_0x3d6db5[_0x9f5c1f(0x14e)][_0x9f5c1f(0x1cb)]});console[_0x9f5c1f(0x202)](_0x9f5c1f(0x16a),_0x1afb90);_0xc9a1d6[0x0][_0x9f5c1f(0x23e)]==0x1?(right_currency=_0xc9a1d6[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0xc9a1d6[0x0][_0x9f5c1f(0x1f3)]);var _0x5c358e=_0x133b56,_0x5004ca=_0x4b3e2a,_0x441cff='',_0x44bce0;for(_0x44bce0 in _0x5c358e){_0x441cff+='<tr>'+_0x9f5c1f(0x1b2)+_0x5c358e[_0x44bce0]+'</td>'+_0x9f5c1f(0x1b2)+_0x5004ca[_0x44bce0]+_0x9f5c1f(0x1eb)+_0x9f5c1f(0x230);}console['log'](_0x9f5c1f(0x127),_0x441cff);let _0x138774=nodemailer[_0x9f5c1f(0x1b5)]({'service':_0x9f5c1f(0x211),'auth':{'user':_0x2f2970[_0x9f5c1f(0x220)],'pass':_0x2f2970[_0x9f5c1f(0x229)]}}),_0x5b5a07={'from':_0x2f2970['email'],'to':_0x1afb90[_0x9f5c1f(0x220)],'subject':_0x9f5c1f(0x19d),'attachments':[{'filename':'Logo.png','path':__dirname+_0x9f5c1f(0x1cd)+_0x9f5c1f(0x166)+_0xc9a1d6[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x9f5c1f(0x15d)+_0x9f5c1f(0x124)+_0x9f5c1f(0x1af)+_0x9f5c1f(0x227)+_0x9f5c1f(0x1af)+_0x9f5c1f(0x23d)+'</div>'+_0x9f5c1f(0x1af)+_0x9f5c1f(0x1c7)+_0xc9a1d6[0x0]['site_title']+_0x9f5c1f(0x205)+_0x9f5c1f(0x1d1)+_0x9f5c1f(0x1d1)+_0x9f5c1f(0x16f)+_0x9f5c1f(0x1af)+_0x9f5c1f(0x15a)+_0x9f5c1f(0x204)+_0x23417d+'\x20'+_0x9f5c1f(0x13e)+_0x9f5c1f(0x242)+_0x3f5082+'\x20'+_0x9f5c1f(0x1ef)+_0x9f5c1f(0x225)+'</div>'+_0x9f5c1f(0x141)+_0x9f5c1f(0x17b)+_0x9f5c1f(0x238)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x9f5c1f(0x1d5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x9f5c1f(0x247)+_0x9f5c1f(0x230)+_0x9f5c1f(0x16c)+_0x9f5c1f(0x1f0)+'\x20'+_0x441cff+'\x20'+_0x9f5c1f(0x249)+_0x9f5c1f(0x1d8)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x9f5c1f(0x1f4)+_0xc9a1d6[0x0][_0x9f5c1f(0x1a2)]+'</h5>'+'</div>'+'</div>'+_0x9f5c1f(0x172)};_0x138774[_0x9f5c1f(0x222)](_0x5b5a07,function(_0x2c823f,_0x4c7654){var _0x1d1fc3=_0x9f5c1f;_0x2c823f?(console[_0x1d1fc3(0x202)](_0x2c823f),console[_0x1d1fc3(0x202)](_0x1d1fc3(0x1b8))):console[_0x1d1fc3(0x202)](_0x1d1fc3(0x1ec));}),_0x3d6db5[_0x9f5c1f(0x1d7)](_0x9f5c1f(0x228),_0x9f5c1f(0x1d0)),_0xdaf434[_0x9f5c1f(0x21e)](_0x9f5c1f(0x14a));}catch(_0x4877b8){console[_0x9f5c1f(0x202)](_0x4877b8),_0xdaf434[_0x9f5c1f(0x239)](0xc8)['json']({'message1':_0x4877b8[_0x9f5c1f(0x152)]});}}}),router['get'](a0_0x2f8a4e(0x188),auth,async(_0x47d646,_0x159b4b)=>{var _0x863862=a0_0x2f8a4e;try{const {username:_0x3556a1,email:_0x3fe4ee,role:_0x57d7c8}=_0x47d646[_0x863862(0x18f)],_0x2858c4=_0x47d646[_0x863862(0x18f)],_0x741eb7=await profile[_0x863862(0x1d4)]({'email':_0x2858c4[_0x863862(0x220)]}),_0x1eeb67=await master_shop[_0x863862(0x234)]();console['log'](_0x863862(0x15c),_0x1eeb67);const _0x3c4d84=_0x47d646['params']['id'],_0x2dd2a1=await sales[_0x863862(0x214)](_0x3c4d84);console[_0x863862(0x202)](_0x863862(0x193),_0x2dd2a1);if(_0x1eeb67[0x0][_0x863862(0x210)]==_0x863862(0x231))var _0x3d80f5=users[_0x863862(0x20c)];else{if(_0x1eeb67[0x0]['language']==_0x863862(0x208))var _0x3d80f5=users[_0x863862(0x208)];else{if(_0x1eeb67[0x0]['language']==_0x863862(0x18e))var _0x3d80f5=users['German'];else{if(_0x1eeb67[0x0]['language']==_0x863862(0x125))var _0x3d80f5=users['Spanish'];else{if(_0x1eeb67[0x0][_0x863862(0x210)]==_0x863862(0x246))var _0x3d80f5=users[_0x863862(0x246)];else{if(_0x1eeb67[0x0][_0x863862(0x210)]==_0x863862(0x198))var _0x3d80f5=users[_0x863862(0x1b0)];else{if(_0x1eeb67[0x0][_0x863862(0x210)]=='Chinese')var _0x3d80f5=users[_0x863862(0x1a5)];else{if(_0x1eeb67[0x0][_0x863862(0x210)]==_0x863862(0x186))var _0x3d80f5=users['Arabic'];}}}}}}}_0x159b4b[_0x863862(0x1c9)](_0x863862(0x161),{'success':_0x47d646[_0x863862(0x1d7)](_0x863862(0x228)),'errors':_0x47d646[_0x863862(0x1d7)]('errors'),'role':_0x2858c4,'profile':_0x741eb7,'alldata':_0x2dd2a1,'master_shop':_0x1eeb67,'language':_0x3d80f5});}catch(_0x2811c9){console[_0x863862(0x202)](_0x2811c9);}}),router['post'](a0_0x2f8a4e(0x1df),async(_0x30f2ca,_0x5f22f3)=>{var _0x3a3de9=a0_0x2f8a4e;const {product_code:_0x3f67a7,warehouse_name:_0x485d28,rooms_data:_0x2e8329,Roomslist:_0x20ab66,sales_category:_0x5c37dc}=_0x30f2ca[_0x3a3de9(0x14e)],_0x396857=_0x20ab66[_0x3a3de9(0x21b)](','),_0x24fb79=[];async function _0x3574e3(_0x40eab2){var _0x37e11f=_0x3a3de9;const _0x4095c6=await warehouse[_0x37e11f(0x235)]([{'$match':{'name':_0x485d28,'room':_0x40eab2}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x3f67a7}},{'$group':{'_id':_0x37e11f(0x21a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x37e11f(0x134)},'primary_code':{'$first':_0x37e11f(0x130)},'secondary_code':{'$first':_0x37e11f(0x1f2)},'product_code':{'$first':_0x37e11f(0x1a6)},'level':{'$first':_0x37e11f(0x1ed)},'bay':{'$first':_0x37e11f(0x146)},'type':{'$first':_0x37e11f(0x176)},'pallet':{'$first':_0x37e11f(0x216)},'unit':{'$first':_0x37e11f(0x1ea)},'secondary_unit':{'$first':_0x37e11f(0x215)},'storage':{'$first':_0x37e11f(0x1c3)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x37e11f(0x23a)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x37e11f(0x1b4)},'invoice':{'$first':_0x37e11f(0x142)},'uuid':{'$first':_0x37e11f(0x1d6)},'gross_price':{'$first':_0x37e11f(0x1f6)},'sales_category':{'$first':_0x37e11f(0x158)}}}]),_0x26873f=await warehouse[_0x37e11f(0x235)]([{'$match':{'name':_0x485d28,'room':_0x40eab2}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3f67a7}},{'$group':{'_id':_0x37e11f(0x21a),'name':{'$first':_0x37e11f(0x19b)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x37e11f(0x130)},'secondary_code':{'$first':_0x37e11f(0x1f2)},'product_code':{'$first':_0x37e11f(0x1a6)},'level':{'$first':_0x37e11f(0x146)},'isle':{'$first':_0x37e11f(0x1b6)},'type':{'$first':_0x37e11f(0x176)},'pallet':{'$first':_0x37e11f(0x216)},'unit':{'$first':_0x37e11f(0x1ea)},'secondary_unit':{'$first':_0x37e11f(0x215)},'storage':{'$first':_0x37e11f(0x1c3)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x37e11f(0x131)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x37e11f(0x23a)},'batch_code':{'$first':_0x37e11f(0x22a)},'product_cat':{'$first':_0x37e11f(0x201)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x37e11f(0x1b4)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x37e11f(0x1d6)},'gross_price':{'$first':_0x37e11f(0x1f6)},'sales_category':{'$first':_0x37e11f(0x158)}}}]);if(_0x4095c6[_0x37e11f(0x22f)]>0x0)_0x24fb79[_0x37e11f(0x14c)](_0x4095c6);else _0x26873f['length']>0x0&&_0x24fb79[_0x37e11f(0x14c)](_0x26873f);}const _0x251e6f=_0x396857[_0x3a3de9(0x140)](_0x5a85f1=>_0x3574e3(_0x5a85f1));await Promise[_0x3a3de9(0x1a7)](_0x251e6f),_0x5f22f3[_0x3a3de9(0x1b7)](_0x24fb79);}),router[a0_0x2f8a4e(0x1e4)](a0_0x2f8a4e(0x147),async(_0x1a71e7,_0x501c9c)=>{var _0x3fd5d9=a0_0x2f8a4e;const {product_code:_0x367bea,warehouse_name:_0x5d2965,rooms_data:_0x29c807,Roomslist:_0x5d403b,sales_category:_0xb174e8}=_0x1a71e7['body'],_0x3002b9=_0x5d403b['split'](','),_0x1e9cf2=[];async function _0x100bb4(_0x2bfe2b){var _0x402f0c=a0_0x109b;const _0x3cac09=await warehouse['aggregate']([{'$match':{'name':_0x5d2965,'room':_0x2bfe2b}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x367bea,'product_details.sales_category':_0xb174e8,'product_details.type_products':_0x402f0c(0x202)}},{'$group':{'_id':_0x402f0c(0x21a),'name':{'$first':_0x402f0c(0x19b)},'product_stock':{'$first':_0x402f0c(0x134)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x402f0c(0x1f2)},'product_code':{'$first':_0x402f0c(0x1a6)},'level':{'$first':_0x402f0c(0x1ed)},'bay':{'$first':_0x402f0c(0x146)},'type':{'$first':_0x402f0c(0x176)},'pallet':{'$first':_0x402f0c(0x216)},'unit':{'$first':_0x402f0c(0x1ea)},'secondary_unit':{'$first':_0x402f0c(0x215)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x402f0c(0x179)},'expiry_date':{'$first':_0x402f0c(0x131)},'production_date':{'$first':_0x402f0c(0x13b)},'maxPerUnit':{'$first':_0x402f0c(0x23a)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x402f0c(0x201)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x402f0c(0x1b4)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x402f0c(0x1d6)},'gross_price':{'$first':_0x402f0c(0x1f6)},'sales_category':{'$first':_0x402f0c(0x158)},'type_products':{'$first':'$product_details.type_products'}}}]);console[_0x402f0c(0x202)](_0x402f0c(0x202)+_0x402f0c(0x243)+_0x367bea+_0x402f0c(0x243)+_0xb174e8);const _0x11eed2=await warehouse[_0x402f0c(0x235)]([{'$match':{'name':_0x5d2965,'room':_0x2bfe2b}},{'$unwind':_0x402f0c(0x173)},{'$match':{'product_details.secondary_code':_0x367bea,'product_details.sales_category':_0xb174e8,'product_details.type_products':_0x402f0c(0x202)}},{'$group':{'_id':_0x402f0c(0x21a),'name':{'$first':_0x402f0c(0x19b)},'product_stock':{'$first':_0x402f0c(0x134)},'primary_code':{'$first':_0x402f0c(0x130)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x402f0c(0x1a6)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x402f0c(0x1b6)},'type':{'$first':_0x402f0c(0x176)},'pallet':{'$first':_0x402f0c(0x216)},'unit':{'$first':_0x402f0c(0x1ea)},'secondary_unit':{'$first':_0x402f0c(0x215)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x402f0c(0x179)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x402f0c(0x22a)},'product_cat':{'$first':_0x402f0c(0x201)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x402f0c(0x1b4)},'invoice':{'$first':_0x402f0c(0x142)},'uuid':{'$first':_0x402f0c(0x1d6)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x402f0c(0x158)},'type_products':{'$first':_0x402f0c(0x1e9)}}}]);if(_0x3cac09[_0x402f0c(0x22f)]>0x0)_0x1e9cf2[_0x402f0c(0x14c)](_0x3cac09);else _0x11eed2['length']>0x0&&_0x1e9cf2[_0x402f0c(0x14c)](_0x11eed2);}const _0x57ecae=_0x3002b9['map'](_0x5c1389=>_0x100bb4(_0x5c1389));await Promise[_0x3fd5d9(0x1a7)](_0x57ecae),_0x501c9c[_0x3fd5d9(0x1b7)](_0x1e9cf2);}),module['exports']=router;