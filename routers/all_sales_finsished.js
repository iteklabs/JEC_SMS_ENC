function a0_0x2a6f(_0x5d4820,_0x35f8ce){var _0x2ac64b=a0_0x2ac6();return a0_0x2a6f=function(_0x2a6fe2,_0x31d7eb){_0x2a6fe2=_0x2a6fe2-0xd0;var _0x336c60=_0x2ac64b[_0x2a6fe2];return _0x336c60;},a0_0x2a6f(_0x5d4820,_0x35f8ce);}var a0_0x376c37=a0_0x2a6f;(function(_0x4a4a3f,_0x5f2962){var _0x2821d3=a0_0x2a6f,_0x200ac1=_0x4a4a3f();while(!![]){try{var _0x30ef8d=parseInt(_0x2821d3(0x169))/0x1*(parseInt(_0x2821d3(0xd9))/0x2)+-parseInt(_0x2821d3(0x136))/0x3+-parseInt(_0x2821d3(0x208))/0x4*(parseInt(_0x2821d3(0x1d9))/0x5)+-parseInt(_0x2821d3(0x1eb))/0x6+-parseInt(_0x2821d3(0x161))/0x7+parseInt(_0x2821d3(0xfa))/0x8*(parseInt(_0x2821d3(0x117))/0x9)+parseInt(_0x2821d3(0x1a0))/0xa;if(_0x30ef8d===_0x5f2962)break;else _0x200ac1['push'](_0x200ac1['shift']());}catch(_0x16417c){_0x200ac1['push'](_0x200ac1['shift']());}}}(a0_0x2ac6,0x81eab));const express=require('express'),app=express(),router=express[a0_0x376c37(0x11a)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require(a0_0x376c37(0x130)),auth=require('../middleware/auth'),nodemailer=require(a0_0x376c37(0x102)),users=require(a0_0x376c37(0x1b7)),mongoose=require('mongoose');router['get'](a0_0x376c37(0x12d),auth,async(_0x3ff2f6,_0x2998f3)=>{var _0x1de1fe=a0_0x376c37;try{const {username:_0x472f53,email:_0x20e340,role:_0xaecd08}=_0x3ff2f6['user'],_0x54a021=_0x3ff2f6[_0x1de1fe(0x135)],_0x557e5a=await profile[_0x1de1fe(0x14b)]({'email':_0x54a021[_0x1de1fe(0x151)]}),_0x4a9fba=await master_shop[_0x1de1fe(0x1b4)]();let _0x478b7c;if(_0x54a021[_0x1de1fe(0x17a)]==_0x1de1fe(0x1a6)){const _0x14a201=await staff[_0x1de1fe(0x14b)]({'email':_0x54a021[_0x1de1fe(0x151)]});_0x478b7c=await sales_finished[_0x1de1fe(0x15c)]([{'$match':{'typeOfProducts':'own'}},{'$unwind':_0x1de1fe(0x18e)},{'$group':{'_id':_0x1de1fe(0xea),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x1de1fe(0x16a)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x1de1fe(0x207)},'sale_product':{'$push':_0x1de1fe(0x18e)},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x1de1fe(0x1b0)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x1de1fe(0x1b8)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x1de1fe(0x1f8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x478b7c=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x1de1fe(0xf5)}},{'$unwind':_0x1de1fe(0x18e)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':_0x1de1fe(0x16a)},'date':{'$first':_0x1de1fe(0x1d1)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x1de1fe(0x18e)},'note':{'$first':_0x1de1fe(0x127)},'return_data':{'$first':_0x1de1fe(0x1b6)},'customers_docs':{'$first':_0x1de1fe(0x1b0)},'total_saleproduct_quantity':{'$sum':_0x1de1fe(0x10d)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x1de1fe(0x1b8)},'type':{'$addToSet':_0x1de1fe(0xf8)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x1de1fe(0x1f8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x4a9fba[0x0][_0x1de1fe(0x1ea)]==_0x1de1fe(0x17d)){var _0x3effb7=users[_0x1de1fe(0x124)];console[_0x1de1fe(0x11b)](_0x3effb7);}else{if(_0x4a9fba[0x0][_0x1de1fe(0x1ea)]=='Hindi')var _0x3effb7=users[_0x1de1fe(0x1dd)];else{if(_0x4a9fba[0x0]['language']==_0x1de1fe(0x1ff))var _0x3effb7=users[_0x1de1fe(0x1ff)];else{if(_0x4a9fba[0x0]['language']==_0x1de1fe(0x197))var _0x3effb7=users['Spanish'];else{if(_0x4a9fba[0x0][_0x1de1fe(0x1ea)]==_0x1de1fe(0x10f))var _0x3effb7=users[_0x1de1fe(0x10f)];else{if(_0x4a9fba[0x0][_0x1de1fe(0x1ea)]=='Portuguese\x20(BR)')var _0x3effb7=users['Portuguese'];else{if(_0x4a9fba[0x0]['language']=='Chinese')var _0x3effb7=users['Chinese'];else{if(_0x4a9fba[0x0][_0x1de1fe(0x1ea)]=='Arabic\x20(ae)')var _0x3effb7=users['Arabic'];}}}}}}}_0x2998f3['render'](_0x1de1fe(0x109),{'success':_0x3ff2f6['flash'](_0x1de1fe(0x128)),'errors':_0x3ff2f6['flash'](_0x1de1fe(0xd8)),'sales':_0x478b7c,'profile':_0x557e5a,'role':_0x54a021,'master_shop':_0x4a9fba,'language':_0x3effb7});}catch(_0x27ef1f){console['log'](_0x27ef1f);}}),router['get']('/view_log',auth,async(_0x475f4f,_0x354bc5)=>{var _0x2a7516=a0_0x376c37;try{const {username:_0x3b9140,email:_0x653689,role:_0x140099}=_0x475f4f[_0x2a7516(0x135)],_0x9d80e5=_0x475f4f['user'],_0x5d60d2=await profile[_0x2a7516(0x14b)]({'email':_0x9d80e5[_0x2a7516(0x151)]}),_0x34b614=await master_shop['find']();let _0x18e00b;if(_0x9d80e5[_0x2a7516(0x17a)]==_0x2a7516(0x1a6)){const _0x147c97=await staff['findOne']({'email':_0x9d80e5['email']});_0x18e00b=await sales_finished[_0x2a7516(0x15c)]([{'$match':{'typeOfProducts':_0x2a7516(0xe8)}},{'$unwind':_0x2a7516(0x18e)},{'$group':{'_id':_0x2a7516(0xea),'invoice':{'$first':_0x2a7516(0x1cc)},'customers':{'$first':_0x2a7516(0x16a)},'date':{'$first':_0x2a7516(0x1d1)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x2a7516(0x18e)},'note':{'$first':_0x2a7516(0x127)},'return_data':{'$first':_0x2a7516(0x1b6)},'customers_docs':{'$first':_0x2a7516(0x1b0)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x2a7516(0x184)},'isle':{'$addToSet':_0x2a7516(0x1b8)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x2a7516(0x14d)},'finalize':{'$first':_0x2a7516(0x1f8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x18e00b=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x2a7516(0xe8)}},{'$unwind':_0x2a7516(0x18e)},{'$group':{'_id':'$_id','invoice':{'$first':_0x2a7516(0x1cc)},'customers':{'$first':_0x2a7516(0x16a)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x2a7516(0x207)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x2a7516(0x127)},'return_data':{'$first':_0x2a7516(0x1b6)},'customers_docs':{'$first':_0x2a7516(0x1b0)},'total_saleproduct_quantity':{'$sum':_0x2a7516(0x10d)},'level':{'$addToSet':_0x2a7516(0x184)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x2a7516(0xf8)},'pallet':{'$addToSet':_0x2a7516(0x14d)},'finalize':{'$first':_0x2a7516(0x1f8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x34b614[0x0][_0x2a7516(0x1ea)]==_0x2a7516(0x17d)){var _0x48033a=users[_0x2a7516(0x124)];console[_0x2a7516(0x11b)](_0x48033a);}else{if(_0x34b614[0x0][_0x2a7516(0x1ea)]=='Hindi')var _0x48033a=users[_0x2a7516(0x1dd)];else{if(_0x34b614[0x0][_0x2a7516(0x1ea)]=='German')var _0x48033a=users[_0x2a7516(0x1ff)];else{if(_0x34b614[0x0][_0x2a7516(0x1ea)]==_0x2a7516(0x197))var _0x48033a=users[_0x2a7516(0x197)];else{if(_0x34b614[0x0][_0x2a7516(0x1ea)]=='French')var _0x48033a=users[_0x2a7516(0x10f)];else{if(_0x34b614[0x0][_0x2a7516(0x1ea)]==_0x2a7516(0x101))var _0x48033a=users[_0x2a7516(0x219)];else{if(_0x34b614[0x0][_0x2a7516(0x1ea)]==_0x2a7516(0x192))var _0x48033a=users['Chinese'];else{if(_0x34b614[0x0][_0x2a7516(0x1ea)]==_0x2a7516(0x1b3))var _0x48033a=users[_0x2a7516(0x1c5)];}}}}}}}_0x354bc5['render'](_0x2a7516(0x20e),{'success':_0x475f4f['flash'](_0x2a7516(0x128)),'errors':_0x475f4f['flash'](_0x2a7516(0xd8)),'sales':_0x18e00b,'profile':_0x5d60d2,'role':_0x9d80e5,'master_shop':_0x34b614,'language':_0x48033a});}catch(_0x683f38){console['log'](_0x683f38);}});async function getRandom8DigitNumber(){var _0x5d2779=a0_0x376c37;const _0x39aea5=0x989680,_0x30d0f7=0x5f5e0ff,_0x175454=Math[_0x5d2779(0xec)](Math['random']()*(_0x30d0f7-_0x39aea5+0x1))+_0x39aea5;var _0x19ceec;const _0x382b09=await sales_finished['findOne']({'invoice':_0x5d2779(0x1d4)+_0x175454});return _0x382b09&&_0x382b09[_0x5d2779(0x1ad)]>0x0?_0x19ceec='OUTF-'+_0x175454:_0x19ceec=_0x5d2779(0x1d4)+_0x175454,_0x19ceec;}router[a0_0x376c37(0x1c7)](a0_0x376c37(0xd5),auth,async(_0x425d39,_0x3b1a4e)=>{var _0x2c5f77=a0_0x376c37;try{const {username:_0x3a9f51,email:_0x52d542,role:_0x1e0cc2}=_0x425d39['user'],_0x2ae5b3=_0x425d39[_0x2c5f77(0x135)],_0x25719f=await profile['findOne']({'email':_0x2ae5b3['email']}),_0x1340ed=await master_shop[_0x2c5f77(0x1b4)](),_0x18ce62=await customer[_0x2c5f77(0x1b4)]({});let _0x1292d9;if(_0x2ae5b3[_0x2c5f77(0x17a)]=='staff'){const _0x48f97e=await staff[_0x2c5f77(0x14b)]({'email':_0x2ae5b3[_0x2c5f77(0x151)]});_0x1292d9=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x48f97e['warehouse']}},{'$group':{'_id':_0x2c5f77(0x145),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x1292d9=await warehouse[_0x2c5f77(0x15c)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x2c5f77(0x145),'name':{'$first':_0x2c5f77(0x145)}}},{'$sort':{'name':0x1}}]);const _0x31d466=await product[_0x2c5f77(0x1b4)]({});var _0x59ae8b=[_0x2c5f77(0x1db),'Enclosed'];const _0x13ded2=await sales_finished[_0x2c5f77(0x1b4)]({}),_0x5e6427=_0x13ded2[_0x2c5f77(0x1ad)]+0x1,_0x3c45e8=_0x2c5f77(0x1d4)+_0x5e6427[_0x2c5f77(0x123)]()[_0x2c5f77(0xd0)](0x5,'0');if(_0x1340ed[0x0][_0x2c5f77(0x1ea)]==_0x2c5f77(0x17d)){var _0x15a1d0=users[_0x2c5f77(0x124)];console['log'](_0x15a1d0);}else{if(_0x1340ed[0x0]['language']=='Hindi')var _0x15a1d0=users[_0x2c5f77(0x1dd)];else{if(_0x1340ed[0x0]['language']==_0x2c5f77(0x1ff))var _0x15a1d0=users['German'];else{if(_0x1340ed[0x0][_0x2c5f77(0x1ea)]=='Spanish')var _0x15a1d0=users[_0x2c5f77(0x197)];else{if(_0x1340ed[0x0][_0x2c5f77(0x1ea)]==_0x2c5f77(0x10f))var _0x15a1d0=users[_0x2c5f77(0x10f)];else{if(_0x1340ed[0x0]['language']==_0x2c5f77(0x101))var _0x15a1d0=users[_0x2c5f77(0x219)];else{if(_0x1340ed[0x0][_0x2c5f77(0x1ea)]==_0x2c5f77(0x192))var _0x15a1d0=users[_0x2c5f77(0x192)];else{if(_0x1340ed[0x0]['language']==_0x2c5f77(0x1b3))var _0x15a1d0=users[_0x2c5f77(0x1c5)];}}}}}}}const _0x58d817=getRandom8DigitNumber();_0x58d817[_0x2c5f77(0x17e)](_0x4c478f=>{var _0x4135ac=_0x2c5f77;_0x3b1a4e[_0x4135ac(0x11e)](_0x4135ac(0x16b),{'success':_0x425d39[_0x4135ac(0x13f)](_0x4135ac(0x128)),'errors':_0x425d39[_0x4135ac(0x13f)](_0x4135ac(0xd8)),'role':_0x2ae5b3,'profile':_0x25719f,'customer':_0x18ce62,'warehouse':_0x1292d9,'product':_0x31d466,'invoice':_0x4c478f,'master_shop':_0x1340ed,'language':_0x15a1d0,'rooms_data':_0x59ae8b});})[_0x2c5f77(0xdb)](_0x1a8264=>{var _0x5dfddc=_0x2c5f77;_0x425d39[_0x5dfddc(0x13f)](_0x5dfddc(0xd8),_0x5dfddc(0x107)),_0x3b1a4e[_0x5dfddc(0x153)](_0x5dfddc(0xd6));});}catch(_0x3e4fb0){console[_0x2c5f77(0x11b)](_0x3e4fb0);}}),router[a0_0x376c37(0x1c7)]('/view/add_sales_logs',auth,async(_0x48d7fc,_0x145e23)=>{var _0x54ea62=a0_0x376c37;try{const {username:_0x3a291e,email:_0x1c01aa,role:_0x26c0e1}=_0x48d7fc['user'],_0x40ac20=_0x48d7fc[_0x54ea62(0x135)],_0x4346a1=await profile[_0x54ea62(0x14b)]({'email':_0x40ac20['email']}),_0x2d8b7e=await master_shop['find'](),_0x5854cf=await customer['find']({});let _0x4c6277;if(_0x40ac20[_0x54ea62(0x17a)]==_0x54ea62(0x1a6)){const _0xf6f640=await staff[_0x54ea62(0x14b)]({'email':_0x40ac20[_0x54ea62(0x151)]});_0x4c6277=await warehouse[_0x54ea62(0x15c)]([{'$match':{'status':_0x54ea62(0x185),'name':_0xf6f640[_0x54ea62(0x1f1)]}},{'$group':{'_id':'$name','name':{'$first':_0x54ea62(0x145)}}},{'$sort':{'name':0x1}}]);}else _0x4c6277=await warehouse['aggregate']([{'$match':{'status':_0x54ea62(0x185)}},{'$group':{'_id':_0x54ea62(0x145),'name':{'$first':_0x54ea62(0x145)}}},{'$sort':{'name':0x1}}]);const _0x2081a3=await product[_0x54ea62(0x1b4)]({});var _0xbeb078=['Ambient',_0x54ea62(0x173)];const _0x2e847c=await sales_finished[_0x54ea62(0x1b4)]({}),_0x31e64c=_0x2e847c['length']+0x1,_0x5621db=_0x54ea62(0x1d4)+_0x31e64c[_0x54ea62(0x123)]()[_0x54ea62(0xd0)](0x5,'0');if(_0x2d8b7e[0x0][_0x54ea62(0x1ea)]==_0x54ea62(0x17d)){var _0x15fa14=users['English'];console[_0x54ea62(0x11b)](_0x15fa14);}else{if(_0x2d8b7e[0x0][_0x54ea62(0x1ea)]==_0x54ea62(0x1dd))var _0x15fa14=users[_0x54ea62(0x1dd)];else{if(_0x2d8b7e[0x0][_0x54ea62(0x1ea)]=='German')var _0x15fa14=users['German'];else{if(_0x2d8b7e[0x0][_0x54ea62(0x1ea)]==_0x54ea62(0x197))var _0x15fa14=users[_0x54ea62(0x197)];else{if(_0x2d8b7e[0x0][_0x54ea62(0x1ea)]==_0x54ea62(0x10f))var _0x15fa14=users[_0x54ea62(0x10f)];else{if(_0x2d8b7e[0x0][_0x54ea62(0x1ea)]==_0x54ea62(0x101))var _0x15fa14=users[_0x54ea62(0x219)];else{if(_0x2d8b7e[0x0]['language']==_0x54ea62(0x192))var _0x15fa14=users[_0x54ea62(0x192)];else{if(_0x2d8b7e[0x0]['language']=='Arabic\x20(ae)')var _0x15fa14=users[_0x54ea62(0x1c5)];}}}}}}}const _0x4b8a94=getRandom8DigitNumber();_0x4b8a94[_0x54ea62(0x17e)](_0x265685=>{var _0xe847b=_0x54ea62;_0x145e23['render']('add_sales_finished_logs',{'success':_0x48d7fc[_0xe847b(0x13f)](_0xe847b(0x128)),'errors':_0x48d7fc[_0xe847b(0x13f)](_0xe847b(0xd8)),'role':_0x40ac20,'profile':_0x4346a1,'customer':_0x5854cf,'warehouse':_0x4c6277,'product':_0x2081a3,'invoice':_0x265685,'master_shop':_0x2d8b7e,'language':_0x15fa14,'rooms_data':_0xbeb078});})[_0x54ea62(0xdb)](_0x10848c=>{var _0x84bcca=_0x54ea62;_0x48d7fc[_0x84bcca(0x13f)](_0x84bcca(0xd8),_0x84bcca(0x107)),_0x145e23['redirect'](_0x84bcca(0xd6));});}catch(_0x186398){console[_0x54ea62(0x11b)](_0x186398);}}),router[a0_0x376c37(0xd4)]('/view/add_sales_logs',auth,async(_0x6488ac,_0x26351a)=>{var _0x12ae99=a0_0x376c37;try{const {invoice:_0x4eb3b1,date:_0x1d28c0,warehouse_name:_0x6985ee,product_name:_0x52aa62,note:_0x393bf8,room:_0xd0f2b,primary_code:_0x5b9ae4,secondary_code:_0x53d28b,prod_code:_0x550d6d,SCRN:_0x3a6110,ReqBy:_0x1b0b8e,dateofreq:_0x587461,PO_number:_0x3045e2,typeservicesData:_0x38e5e9,typevehicle:_0x399f7e,destination:_0x2677c8,deliverydate:_0x595f42,driver:_0x149c52,plate:_0x3c9e5b,van:_0x10b496,DRSI:_0x4cc413,TSU:_0x58d389,TFU:_0x584e33,mode_transpo:_0x49e1d5,name_driver:_0x6363ef,type_of_products:_0x532ee1}=_0x6488ac[_0x12ae99(0x159)];if(typeof _0x52aa62==_0x12ae99(0x14e))var _0x3fe954=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x1d6)]],_0xf7b582=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x16c)]],_0x1287e0=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x15a)]],_0x5af595=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x20c)]],_0x2c46fb=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x178)]],_0xc7d820=[_0x6488ac[_0x12ae99(0x159)]['prod_code']],_0x2c919d=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x1dc)]],_0x80ef7=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x165)]],_0x49c2ea=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x1c0)]],_0xa6c7a1=[_0x6488ac['body'][_0x12ae99(0x1fe)]],_0x5e2ed9=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x1f5)]],_0x414873=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0xf7)]],_0x2d105f=[_0x6488ac[_0x12ae99(0x159)]['max_per_unit']],_0x55ccf8=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x10e)]],_0x1e4491=[_0x6488ac['body'][_0x12ae99(0x171)]],_0x3f1440=[_0x6488ac['body'][_0x12ae99(0x12a)]],_0x267adb=[_0x6488ac['body']['id_transaction_from']],_0x355b00=[_0x6488ac['body'][_0x12ae99(0x146)]],_0x314098=[_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0xed)]];else var _0x3fe954=[..._0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x1d6)]],_0xf7b582=[..._0x6488ac['body'][_0x12ae99(0x16c)]],_0x1287e0=[..._0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x15a)]],_0x5af595=[..._0x6488ac[_0x12ae99(0x159)]['primary_code']],_0x2c46fb=[..._0x6488ac['body']['secondary_code']],_0xc7d820=[..._0x6488ac['body'][_0x12ae99(0x1c6)]],_0x2c919d=[..._0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x1dc)]],_0x80ef7=[..._0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x165)]],_0x49c2ea=[..._0x6488ac[_0x12ae99(0x159)]['secondary_unit']],_0xa6c7a1=[..._0x6488ac['body'][_0x12ae99(0x1fe)]],_0x5e2ed9=[..._0x6488ac['body'][_0x12ae99(0x1f5)]],_0x414873=[..._0x6488ac['body'][_0x12ae99(0xf7)]],_0x2d105f=[..._0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x1e8)]],_0x55ccf8=[..._0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x10e)]],_0x1e4491=[..._0x6488ac['body'][_0x12ae99(0x171)]],_0x3f1440=[..._0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x12a)]],_0x267adb=[..._0x6488ac[_0x12ae99(0x159)]['id_transaction_from']],_0x355b00=[..._0x6488ac['body']['uuid']],_0x314098=[..._0x6488ac[_0x12ae99(0x159)][_0x12ae99(0xed)]];const _0x239f9e=_0x3fe954[_0x12ae99(0x132)](_0x4abbe0=>{return _0x4abbe0={'product_name':_0x4abbe0};});_0xf7b582[_0x12ae99(0x1e7)]((_0x1be380,_0x3e9b78)=>{var _0x409706=_0x12ae99;_0x239f9e[_0x3e9b78][_0x409706(0x16c)]=_0x1be380;}),_0x1287e0[_0x12ae99(0x1e7)]((_0x526142,_0x278f33)=>{var _0x427141=_0x12ae99;_0x239f9e[_0x278f33][_0x427141(0xfb)]=Math[_0x427141(0xd3)](_0x526142);}),_0x3fe954[_0x12ae99(0x1e7)]((_0x1b75f0,_0x2d03c6)=>{var _0x4ed96b=_0x12ae99;_0x239f9e[_0x2d03c6][_0x4ed96b(0x140)]=_0x6488ac[_0x4ed96b(0x159)][_0x4ed96b(0x162)];}),_0x314098[_0x12ae99(0x1e7)]((_0x4e6254,_0x2ef37c)=>{var _0xcb4d56=_0x12ae99;_0x239f9e[_0x2ef37c][_0xcb4d56(0xed)]=_0x4e6254;}),_0x355b00[_0x12ae99(0x1e7)]((_0xd738eb,_0x2fceb7)=>{var _0x63ae07=_0x12ae99;_0x239f9e[_0x2fceb7][_0x63ae07(0x146)]=_0xd738eb;}),_0x267adb[_0x12ae99(0x1e7)]((_0x38cc81,_0x34cd6c)=>{var _0x1e7af2=_0x12ae99;_0x239f9e[_0x34cd6c][_0x1e7af2(0x175)]=_0x38cc81;}),_0x5af595['forEach']((_0x288a1a,_0x17172a)=>{var _0x338bf3=_0x12ae99;_0x239f9e[_0x17172a][_0x338bf3(0x20c)]=_0x288a1a;}),_0x2c46fb[_0x12ae99(0x1e7)]((_0x2ad0ea,_0x18e525)=>{var _0x4c2090=_0x12ae99;_0x239f9e[_0x18e525][_0x4c2090(0x178)]=_0x2ad0ea;}),_0xc7d820[_0x12ae99(0x1e7)]((_0x2db915,_0x37a2ef)=>{var _0x22073e=_0x12ae99;_0x239f9e[_0x37a2ef][_0x22073e(0x1bc)]=_0x2db915;}),_0x2c919d[_0x12ae99(0x1e7)]((_0x19b665,_0x55224c)=>{var _0x1d48b9=_0x12ae99,_0x362745=_0x19b665[_0x1d48b9(0x16e)](/[A-Za-z]+/)[0x0],_0x45a8e0=parseInt(_0x19b665[_0x1d48b9(0x16e)](/\d+/)[0x0]);_0x239f9e[_0x55224c][_0x1d48b9(0x12f)]=_0x45a8e0,_0x239f9e[_0x55224c][_0x1d48b9(0xd2)]=_0x362745;}),_0x80ef7[_0x12ae99(0x1e7)]((_0x512849,_0x3205d8)=>{var _0x4b130b=_0x12ae99;_0x239f9e[_0x3205d8][_0x4b130b(0xf3)]=_0x512849;}),_0x49c2ea[_0x12ae99(0x1e7)]((_0x44f83e,_0x4c14b0)=>{var _0x2cbece=_0x12ae99;_0x239f9e[_0x4c14b0][_0x2cbece(0x1c0)]=_0x44f83e;}),_0xa6c7a1[_0x12ae99(0x1e7)]((_0x10036d,_0x2e50bc)=>{_0x239f9e[_0x2e50bc]['batch_code']=_0x10036d;}),_0x5e2ed9[_0x12ae99(0x1e7)]((_0xbac324,_0x2fe63b)=>{var _0x2ba9a7=_0x12ae99;_0x239f9e[_0x2fe63b][_0x2ba9a7(0x1f5)]=_0xbac324;}),_0x414873[_0x12ae99(0x1e7)]((_0x21dc3d,_0x497935)=>{var _0x13f014=_0x12ae99;_0x239f9e[_0x497935][_0x13f014(0x19d)]=_0x21dc3d;}),_0x2d105f[_0x12ae99(0x1e7)]((_0x4259d9,_0x33185e)=>{var _0x32997c=_0x12ae99;_0x239f9e[_0x33185e][_0x32997c(0x1ec)]=_0x4259d9;}),_0x55ccf8[_0x12ae99(0x1e7)]((_0x54cb0a,_0x1e315a)=>{var _0x342cc8=_0x12ae99;_0x239f9e[_0x1e315a][_0x342cc8(0x10e)]=_0x54cb0a;}),_0x1e4491[_0x12ae99(0x1e7)]((_0x453efb,_0x15217c)=>{_0x239f9e[_0x15217c]['room_name']=_0x453efb;}),_0x3f1440[_0x12ae99(0x1e7)]((_0x3bc6d6,_0x245d5a)=>{var _0x2a3e21=_0x12ae99;_0x239f9e[_0x245d5a][_0x2a3e21(0x1c2)]=_0x3bc6d6,_0x239f9e[_0x245d5a][_0x2a3e21(0x106)]=_0x1d28c0;});const _0x318fa2=new sales_logs();await _0x318fa2[_0x12ae99(0x1a2)](),_0x3f1440[_0x12ae99(0x1e7)]((_0x192f9f,_0x1b596d)=>{var _0x31683=_0x12ae99;_0x239f9e[_0x1b596d][_0x31683(0x1bd)]='LOG-OUT-'+_0x318fa2[_0x31683(0x12e)][_0x31683(0x123)]()[_0x31683(0xd0)](0x8,'0');});var _0x11408b=0x0;_0x239f9e[_0x12ae99(0x1e7)](_0x2c6a39=>{var _0x26d751=_0x12ae99;parseFloat(_0x2c6a39[_0x26d751(0x16c)])<parseFloat(_0x2c6a39[_0x26d751(0xfb)])&&parseFloat(_0x2c6a39['quantity'])>parseFloat(_0x2c6a39[_0x26d751(0x16c)])&&(console['log'](_0x2c6a39[_0x26d751(0x16c)]+_0x26d751(0x1ae)+_0x2c6a39[_0x26d751(0xfb)]),_0x11408b++);});if(_0x11408b!=0x0)return _0x6488ac[_0x12ae99(0x13f)](_0x12ae99(0xd8),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x26351a[_0x12ae99(0x153)]('back');const _0x3e4f5e=_0x239f9e['filter'](_0x47c5b9=>_0x47c5b9[_0x12ae99(0xfb)]!=='0'&&_0x47c5b9['quantity']!==''),_0x47f9e2=new sales_finished({'invoice':_0x12ae99(0x1f2)+_0x318fa2[_0x12ae99(0x12e)][_0x12ae99(0x123)]()[_0x12ae99(0xd0)](0x8,'0'),'sales_data':_0x6488ac[_0x12ae99(0x159)]['sales'],'customer':_0x6488ac[_0x12ae99(0x159)][_0x12ae99(0x154)],'date':_0x1d28c0,'warehouse_name':_0x6985ee,'sale_product':_0x3e4f5e,'note':_0x393bf8,'room':_0xd0f2b,'primary_code':_0x5b9ae4,'secondary_code':_0x53d28b,'prod_code':_0x550d6d,'SCRN':_0x3a6110,'finalize':_0x12ae99(0x103),'mode_transpo':_0x49e1d5,'name_driver':_0x6363ef,'ReqBy':_0x1b0b8e,'dateofreq':_0x587461,'PO_number':_0x3045e2,'typeservicesData':_0x38e5e9,'typevehicle':_0x399f7e,'destination':_0x2677c8,'deliverydate':_0x595f42,'driver':_0x149c52,'plate':_0x3c9e5b,'van':_0x10b496,'DRSI':_0x4cc413,'TSU':_0x58d389,'TFU':_0x584e33,'typeOfProducts':_0x532ee1}),_0x5c13ef=await _0x47f9e2['save'](),_0x3c5381=await sales_finished['findOne']({'invoice':_0x4eb3b1});_0x6488ac[_0x12ae99(0x13f)](_0x12ae99(0x128),_0x12ae99(0x1ba)),_0x26351a[_0x12ae99(0x153)]('/all_sales_finished/preview/'+_0x5c13ef[_0x12ae99(0x15f)]);}catch(_0x27983c){console[_0x12ae99(0x11b)](_0x27983c);}}),router[a0_0x376c37(0x1c7)]('/view/add_sales/:id',auth,async(_0x172378,_0x1ad115)=>{var _0x561cd2=a0_0x376c37;try{const _0x2e98e8=_0x172378[_0x561cd2(0x112)]['id'];console[_0x561cd2(0x11b)](_0x2e98e8);const _0x3f3b15=await product[_0x561cd2(0x1b4)](),_0x2decd3=await purchases[_0x561cd2(0x15c)]([{'$match':{'warehouse_name':_0x2e98e8}},{'$unwind':'$product'},{'$group':{'_id':_0x561cd2(0x20b)}}]);console['log'](_0x561cd2(0x200),_0x2decd3),_0x1ad115['status'](0xc8)[_0x561cd2(0x121)]({'purchases_data':_0x2decd3,'product_data':_0x3f3b15});}catch(_0x224ee1){console[_0x561cd2(0x11b)](_0x224ee1);}}),router[a0_0x376c37(0xd4)](a0_0x376c37(0x1c8),auth,async(_0x30950a,_0x4a6b31)=>{var _0x20d8a0=a0_0x376c37;try{const {warehouse_data:_0x4efe44,product_data:_0x48eb95}=_0x30950a['body'];console['log'](_0x30950a[_0x20d8a0(0x159)][_0x20d8a0(0x176)]);;const _0x1cd367=await master_shop[_0x20d8a0(0x1b4)]();console[_0x20d8a0(0x11b)](_0x20d8a0(0x166),_0x1cd367);const _0x38b74a=await product[_0x20d8a0(0x14b)]({'name':_0x48eb95});console['log'](_0x20d8a0(0x189),_0x38b74a);const _0x169cc3=await warehouse[_0x20d8a0(0x15c)]([{'$match':{'name':_0x4efe44}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x48eb95}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x20d8a0(0x21a)}}}]);console[_0x20d8a0(0x11b)](_0x20d8a0(0x11d),_0x169cc3),_0x4a6b31[_0x20d8a0(0x1f7)](0xc8)['json']({'master':_0x1cd367,'new_product':_0x38b74a,'stock_data':_0x169cc3});}catch(_0x4b9d66){console[_0x20d8a0(0x11b)](_0x4b9d66);}}),router[a0_0x376c37(0xd4)](a0_0x376c37(0xd5),auth,async(_0x252c97,_0x4397c9)=>{var _0x4d641e=a0_0x376c37;try{const {invoice:_0x23c864,date:_0x17cd56,warehouse_name:_0x57bfb2,product_name:_0x4db6ab,note:_0xf02b02,room:_0x5dfa70,primary_code:_0x3cb474,secondary_code:_0x34b90d,prod_code:_0xa77665,SCRN:_0x1f4fa7,ReqBy:_0x54196b,dateofreq:_0x4ae51b,PO_number:_0x15ba79,typeservicesData:_0x14aa2e,typevehicle:_0x252a21,destination:_0x1e5264,deliverydate:_0x4a3d7f,driver:_0x23942d,plate:_0x1b42f5,van:_0x5bb488,DRSI:_0x521fce,TSU:_0x2810c3,TFU:_0x3bb75a,mode_transpo:_0x406083,name_driver:_0x1cdc89,pull_out_date:_0xca0429,actual_delivery_date:_0x47799e}=_0x252c97[_0x4d641e(0x159)];_0x4397c9[_0x4d641e(0x121)](_0x252c97['body']);return;if(typeof _0x4db6ab==_0x4d641e(0x14e))var _0x525d7e=[_0x252c97['body'][_0x4d641e(0x1d6)]],_0x4384ee=[_0x252c97[_0x4d641e(0x159)][_0x4d641e(0x16c)]],_0x586ca6=[_0x252c97['body'][_0x4d641e(0x15a)]],_0x220f4c=[_0x252c97['body']['primary_code']],_0x45ce71=[_0x252c97[_0x4d641e(0x159)]['secondary_code']],_0x3152e4=[_0x252c97['body'][_0x4d641e(0x1c6)]],_0x48a021=[_0x252c97[_0x4d641e(0x159)][_0x4d641e(0x1dc)]],_0x56f4e6=[_0x252c97[_0x4d641e(0x159)][_0x4d641e(0x165)]],_0x59d2bf=[_0x252c97[_0x4d641e(0x159)][_0x4d641e(0x1c0)]],_0x3cc4d6=[_0x252c97[_0x4d641e(0x159)][_0x4d641e(0x1fe)]],_0x156adf=[_0x252c97['body'][_0x4d641e(0x1f5)]],_0x3892fb=[_0x252c97['body'][_0x4d641e(0xf7)]],_0x244d13=[_0x252c97['body'][_0x4d641e(0x1e8)]],_0x13d0cb=[_0x252c97[_0x4d641e(0x159)]['prod_cat']],_0x156c3c=[_0x252c97[_0x4d641e(0x159)][_0x4d641e(0x171)]],_0x1fe422=[_0x252c97['body']['prod_invoice']],_0x19c1d1=[_0x252c97['body']['id_transaction_from']],_0x10bc5c=[_0x252c97[_0x4d641e(0x159)][_0x4d641e(0x146)]],_0xd0ce2a=[_0x252c97['body'][_0x4d641e(0xed)]];else var _0x525d7e=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0x1d6)]],_0x4384ee=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0x16c)]],_0x586ca6=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0x15a)]],_0x220f4c=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0x20c)]],_0x45ce71=[..._0x252c97[_0x4d641e(0x159)]['secondary_code']],_0x3152e4=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0x1c6)]],_0x48a021=[..._0x252c97['body'][_0x4d641e(0x1dc)]],_0x56f4e6=[..._0x252c97['body'][_0x4d641e(0x165)]],_0x59d2bf=[..._0x252c97[_0x4d641e(0x159)]['secondary_unit']],_0x3cc4d6=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0x1fe)]],_0x156adf=[..._0x252c97[_0x4d641e(0x159)]['expiry_date']],_0x3892fb=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0xf7)]],_0x244d13=[..._0x252c97[_0x4d641e(0x159)]['max_per_unit']],_0x13d0cb=[..._0x252c97[_0x4d641e(0x159)]['prod_cat']],_0x156c3c=[..._0x252c97['body'][_0x4d641e(0x171)]],_0x1fe422=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0x12a)]],_0x19c1d1=[..._0x252c97[_0x4d641e(0x159)][_0x4d641e(0x175)]],_0x10bc5c=[..._0x252c97['body']['uuid']],_0xd0ce2a=[..._0x252c97['body'][_0x4d641e(0xed)]];const _0x3bcd9b=_0x525d7e['map'](_0x1ef57a=>{return _0x1ef57a={'product_name':_0x1ef57a};});_0x4384ee[_0x4d641e(0x1e7)]((_0xbc917e,_0x5acc1f)=>{var _0x408379=_0x4d641e;_0x3bcd9b[_0x5acc1f][_0x408379(0x16c)]=_0xbc917e;}),_0x586ca6['forEach']((_0x490768,_0x2880f8)=>{var _0x14e709=_0x4d641e;_0x3bcd9b[_0x2880f8][_0x14e709(0xfb)]=Math['abs'](_0x490768);}),_0x525d7e[_0x4d641e(0x1e7)]((_0x2c49f6,_0x14827b)=>{var _0x21e483=_0x4d641e;_0x3bcd9b[_0x14827b][_0x21e483(0x140)]=_0x252c97['body'][_0x21e483(0x162)];}),_0xd0ce2a[_0x4d641e(0x1e7)]((_0x44bd2,_0x114ee3)=>{var _0xb1ff06=_0x4d641e;_0x3bcd9b[_0x114ee3][_0xb1ff06(0xed)]=_0x44bd2;}),_0x10bc5c[_0x4d641e(0x1e7)]((_0x362ab2,_0x24dac8)=>{var _0x32c62f=_0x4d641e;_0x3bcd9b[_0x24dac8][_0x32c62f(0x146)]=_0x362ab2;}),_0x19c1d1[_0x4d641e(0x1e7)]((_0x2e2f5e,_0x76f0aa)=>{var _0x54d18a=_0x4d641e;_0x3bcd9b[_0x76f0aa][_0x54d18a(0x175)]=_0x2e2f5e;}),_0x220f4c[_0x4d641e(0x1e7)]((_0x2cd1d4,_0x130456)=>{_0x3bcd9b[_0x130456]['primary_code']=_0x2cd1d4;}),_0x45ce71[_0x4d641e(0x1e7)]((_0x476c6e,_0xb48b90)=>{var _0x37d431=_0x4d641e;_0x3bcd9b[_0xb48b90][_0x37d431(0x178)]=_0x476c6e;}),_0x3152e4[_0x4d641e(0x1e7)]((_0x315447,_0x24e49c)=>{var _0x262079=_0x4d641e;_0x3bcd9b[_0x24e49c][_0x262079(0x1bc)]=_0x315447;}),_0x48a021[_0x4d641e(0x1e7)]((_0x31d08f,_0x3dee2e)=>{var _0x163ee6=_0x4d641e,_0x199816=_0x31d08f[_0x163ee6(0x16e)](/[A-Za-z]+/)[0x0],_0x5d50ba=parseInt(_0x31d08f[_0x163ee6(0x16e)](/\d+/)[0x0]);_0x3bcd9b[_0x3dee2e][_0x163ee6(0x12f)]=_0x5d50ba,_0x3bcd9b[_0x3dee2e]['level']=_0x199816;}),_0x56f4e6[_0x4d641e(0x1e7)]((_0x59409d,_0x31f990)=>{var _0x6bb5fd=_0x4d641e;_0x3bcd9b[_0x31f990][_0x6bb5fd(0xf3)]=_0x59409d;}),_0x59d2bf[_0x4d641e(0x1e7)]((_0x4ac5e8,_0x163eff)=>{var _0x5e72be=_0x4d641e;_0x3bcd9b[_0x163eff][_0x5e72be(0x1c0)]=_0x4ac5e8;}),_0x3cc4d6[_0x4d641e(0x1e7)]((_0x1fc657,_0x35c36b)=>{var _0x5e1f48=_0x4d641e;_0x3bcd9b[_0x35c36b][_0x5e1f48(0x1fe)]=_0x1fc657;}),_0x156adf['forEach']((_0x3fde78,_0x5f3179)=>{var _0x4ca8c5=_0x4d641e;_0x3bcd9b[_0x5f3179][_0x4ca8c5(0x1f5)]=_0x3fde78;}),_0x3892fb[_0x4d641e(0x1e7)]((_0x40011b,_0x11ae9c)=>{var _0x475423=_0x4d641e;_0x3bcd9b[_0x11ae9c][_0x475423(0x19d)]=_0x40011b;}),_0x244d13[_0x4d641e(0x1e7)]((_0x5e9399,_0x1904d2)=>{var _0x870483=_0x4d641e;_0x3bcd9b[_0x1904d2][_0x870483(0x1ec)]=_0x5e9399;}),_0x13d0cb[_0x4d641e(0x1e7)]((_0x60f084,_0x49a00a)=>{var _0x575d38=_0x4d641e;_0x3bcd9b[_0x49a00a][_0x575d38(0x10e)]=_0x60f084;}),_0x156c3c[_0x4d641e(0x1e7)]((_0x225fac,_0x13789f)=>{var _0x5bc339=_0x4d641e;_0x3bcd9b[_0x13789f][_0x5bc339(0x158)]=_0x225fac;}),_0x1fe422[_0x4d641e(0x1e7)]((_0x3dfd91,_0x164e0d)=>{var _0x370dc8=_0x4d641e;_0x3bcd9b[_0x164e0d][_0x370dc8(0x1c2)]=_0x3dfd91,_0x3bcd9b[_0x164e0d]['date_data']=_0x17cd56;});const _0x246785=new invoice_for_outgoing();await _0x246785[_0x4d641e(0x1a2)](),_0x1fe422[_0x4d641e(0x1e7)]((_0x5da352,_0x399817)=>{var _0x2fcc5d=_0x4d641e;_0x3bcd9b[_0x399817][_0x2fcc5d(0x1bd)]=_0x2fcc5d(0x111)+_0x246785[_0x2fcc5d(0x12e)][_0x2fcc5d(0x123)]()[_0x2fcc5d(0xd0)](0x8,'0');});var _0x74dfd4=0x0;_0x3bcd9b['forEach'](_0x11e57e=>{var _0x284762=_0x4d641e;parseFloat(_0x11e57e[_0x284762(0x16c)])<parseFloat(_0x11e57e[_0x284762(0xfb)])&&parseFloat(_0x11e57e['quantity'])>parseFloat(_0x11e57e[_0x284762(0x16c)])&&(console[_0x284762(0x11b)](_0x11e57e[_0x284762(0x16c)]+_0x284762(0x1ae)+_0x11e57e[_0x284762(0xfb)]),_0x74dfd4++);});if(_0x74dfd4!=0x0)return _0x252c97[_0x4d641e(0x13f)](_0x4d641e(0xd8),_0x4d641e(0x1e5)),_0x4397c9['redirect']('back');const _0x5495bf=_0x3bcd9b[_0x4d641e(0x19c)](_0x4dc5ae=>_0x4dc5ae[_0x4d641e(0xfb)]!=='0'&&_0x4dc5ae[_0x4d641e(0xfb)]!==''),_0x5a1106=new sales_finished({'invoice':_0x4d641e(0x111)+_0x246785[_0x4d641e(0x12e)][_0x4d641e(0x123)]()['padStart'](0x8,'0'),'sales_data':_0x252c97[_0x4d641e(0x159)]['sales'],'customer':_0x252c97[_0x4d641e(0x159)][_0x4d641e(0x154)],'date':_0x17cd56,'warehouse_name':_0x57bfb2,'sale_product':_0x5495bf,'note':_0xf02b02,'room':_0x5dfa70,'primary_code':_0x3cb474,'secondary_code':_0x34b90d,'prod_code':_0xa77665,'SCRN':_0x1f4fa7,'finalize':_0x4d641e(0x103),'mode_transpo':_0x406083,'name_driver':_0x1cdc89,'ReqBy':_0x54196b,'dateofreq':_0x4ae51b,'PO_number':_0x15ba79,'typeservicesData':_0x14aa2e,'typevehicle':_0x252a21,'destination':_0x1e5264,'deliverydate':_0x4a3d7f,'driver':_0x23942d,'plate':_0x1b42f5,'van':_0x5bb488,'DRSI':_0x521fce,'TSU':_0x2810c3,'TFU':_0x3bb75a,'pullout_date':_0xca0429,'actualdelivery_date':_0x47799e,'typeOfProducts':'own'}),_0x3f79d3=await _0x5a1106['save'](),_0x59f593=await sales_finished[_0x4d641e(0x14b)]({'invoice':_0x23c864});_0x252c97['flash']('success',_0x4d641e(0x1ba)),_0x4397c9['redirect'](_0x4d641e(0x119)+_0x3f79d3[_0x4d641e(0x15f)]);}catch(_0x1ff3cc){console[_0x4d641e(0x11b)](_0x1ff3cc);}}),router[a0_0x376c37(0x1c7)](a0_0x376c37(0x15e),auth,async(_0x1ccad5,_0x80ad48)=>{var _0x2da695=a0_0x376c37;try{const {username:_0x321fc5,email:_0x1dbeb0,role:_0x55feb7}=_0x1ccad5['user'],_0x2904e7=_0x1ccad5[_0x2da695(0x135)],_0x213099=await profile[_0x2da695(0x14b)]({'email':_0x2904e7['email']}),_0x4d17ed=await master_shop[_0x2da695(0x1b4)](),_0x58bce9=_0x1ccad5['params']['id'],_0x4f9e38=await sales_finished[_0x2da695(0x183)](_0x58bce9),_0x2639b7=await warehouse[_0x2da695(0x15c)]([{'$match':{'name':_0x4f9e38[_0x2da695(0x14a)]}},{'$unwind':_0x2da695(0xe6)},{'$group':{'_id':_0x2da695(0x1be),'name':{'$first':_0x2da695(0x1e1)},'product_stock':{'$first':_0x2da695(0x21a)},'bay':{'$first':_0x2da695(0x20a)},'bin':{'$first':_0x2da695(0x13c)},'type':{'$first':_0x2da695(0x1bb)},'floorlevel':{'$first':_0x2da695(0x163)},'primary_code':{'$first':_0x2da695(0x133)},'secondary_code':{'$first':_0x2da695(0x216)},'product_code':{'$first':_0x2da695(0x14f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2da695(0x1cb)},'expiry_date':{'$first':_0x2da695(0x1a5)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2da695(0xfe)},'room':{'$first':'$room'},'room_data':{'$first':_0x2da695(0x15b)}}}]),_0x42d247=await customer[_0x2da695(0x1b4)]({});let _0x180a47;if(_0x2904e7[_0x2da695(0x17a)]==_0x2da695(0x1a6)){const _0x39763f=await staff['findOne']({'email':_0x2904e7[_0x2da695(0x151)]});_0x180a47=await warehouse[_0x2da695(0x15c)]([{'$match':{'status':_0x2da695(0x185),'name':_0x39763f['warehouse']}},{'$group':{'_id':_0x2da695(0x145),'name':{'$first':_0x2da695(0x145)}}}]);}else _0x180a47=await warehouse[_0x2da695(0x15c)]([{'$match':{'status':_0x2da695(0x185)}},{'$group':{'_id':_0x2da695(0x145),'name':{'$first':_0x2da695(0x145)}}}]);const _0x5c1ea5=await product[_0x2da695(0x1b4)]({});if(_0x4d17ed[0x0]['language']==_0x2da695(0x17d)){var _0x2695bc=users[_0x2da695(0x124)];console[_0x2da695(0x11b)](_0x2695bc);}else{if(_0x4d17ed[0x0][_0x2da695(0x1ea)]==_0x2da695(0x1dd))var _0x2695bc=users[_0x2da695(0x1dd)];else{if(_0x4d17ed[0x0]['language']==_0x2da695(0x1ff))var _0x2695bc=users[_0x2da695(0x1ff)];else{if(_0x4d17ed[0x0][_0x2da695(0x1ea)]==_0x2da695(0x197))var _0x2695bc=users[_0x2da695(0x197)];else{if(_0x4d17ed[0x0][_0x2da695(0x1ea)]==_0x2da695(0x10f))var _0x2695bc=users[_0x2da695(0x10f)];else{if(_0x4d17ed[0x0][_0x2da695(0x1ea)]==_0x2da695(0x101))var _0x2695bc=users[_0x2da695(0x219)];else{if(_0x4d17ed[0x0][_0x2da695(0x1ea)]==_0x2da695(0x192))var _0x2695bc=users['Chinese'];else{if(_0x4d17ed[0x0][_0x2da695(0x1ea)]=='Arabic\x20(ae)')var _0x2695bc=users[_0x2da695(0x1c5)];}}}}}}}_0x80ad48[_0x2da695(0x11e)](_0x2da695(0x13a),{'success':_0x1ccad5[_0x2da695(0x13f)](_0x2da695(0x128)),'errors':_0x1ccad5['flash'](_0x2da695(0xd8)),'role':_0x2904e7,'profile':_0x213099,'customer':_0x42d247,'warehouse':_0x180a47,'product':_0x2639b7,'user':_0x4f9e38,'master_shop':_0x4d17ed,'unit':_0x5c1ea5,'language':_0x2695bc});}catch(_0x1608de){console[_0x2da695(0x11b)](_0x1608de);}});async function dataUpdate(_0x552dca,_0x585088,_0x217ef4){var _0x147f26=a0_0x376c37;return await warehouse['updateOne']({'_id':_0x552dca,'product_details._id':_0x585088},{'$set':{'product_details.$.product_stock':_0x217ef4}}),await warehouse[_0x147f26(0x183)](_0x552dca);}router[a0_0x376c37(0xd4)](a0_0x376c37(0x15e),auth,async(_0x3e0aa8,_0x131974)=>{var _0x1b3b77=a0_0x376c37;try{const _0x2263e6=_0x3e0aa8[_0x1b3b77(0x112)]['id'],{invoice:_0x5f2648,warehouse_name:_0x5e3fe4,room:_0x526c1d}=_0x3e0aa8[_0x1b3b77(0x159)],_0x5561c3=await sales_finished[_0x1b3b77(0x14b)]({'invoice':_0x5f2648});for(let _0x4b870b=0x0;_0x4b870b<=_0x5561c3['sale_product'][_0x1b3b77(0x1ad)]-0x1;_0x4b870b++){const _0x4b6224=_0x5561c3[_0x1b3b77(0x18f)][_0x4b870b];var _0x1ec8ce=await warehouse[_0x1b3b77(0x14b)]({'name':_0x5e3fe4,'room':_0x4b6224[_0x1b3b77(0x158)]}),_0x1c0420=0x0;for(let _0x313264=0x0;_0x313264<=_0x1ec8ce[_0x1b3b77(0x143)][_0x1b3b77(0x1ad)]-0x1;_0x313264++){const _0x1013c8=_0x1ec8ce['product_details'][_0x313264];_0x1013c8[_0x1b3b77(0x15f)]==_0x4b6224[_0x1b3b77(0x175)]&&_0x1013c8[_0x1b3b77(0x146)]==_0x4b6224['uuid']&&(_0x1c0420=Math[_0x1b3b77(0x17b)](0x0,Math[_0x1b3b77(0xd3)](_0x1013c8[_0x1b3b77(0x131)])-Math[_0x1b3b77(0xd3)](_0x4b6224['quantity'])),await warehouse[_0x1b3b77(0x1d7)]({'_id':_0x1ec8ce['_id'][_0x1b3b77(0x203)](),'product_details._id':_0x1013c8[_0x1b3b77(0x15f)]['valueOf'](),'product_details.uuid':_0x4b6224[_0x1b3b77(0x146)]},{'$set':{'product_details.$.product_stock':_0x1c0420}}));}console[_0x1b3b77(0x11b)](typeof _0x4b6224[_0x1b3b77(0x140)]);if(typeof _0x4b6224[_0x1b3b77(0x140)]!=='undefined'){var _0x149a10=await staff[_0x1b3b77(0x183)](_0x4b6224[_0x1b3b77(0x140)]);console['log'](_0x1b3b77(0x118));var _0x5b2ffc=0x0;for(let _0x52090b=0x0;_0x52090b<=_0x149a10[_0x1b3b77(0x1af)][_0x1b3b77(0x1ad)]-0x1;_0x52090b++){const _0x4e76f1=_0x149a10[_0x1b3b77(0x1af)][_0x52090b];console[_0x1b3b77(0x11b)](_0x4b6224[_0x1b3b77(0x175)]+'\x20==\x20'+_0x4e76f1[_0x1b3b77(0x187)]+_0x1b3b77(0x181)+_0x4b6224[_0x1b3b77(0x15f)]+_0x1b3b77(0x186)+_0x4b6224[_0x1b3b77(0x15f)]),_0x4b6224['id_transaction_from']==_0x4e76f1[_0x1b3b77(0x187)]&&_0x4b6224[_0x1b3b77(0x15f)]==0x1&&(_0x4e76f1[_0x1b3b77(0x131)]=Math[_0x1b3b77(0xd3)](_0x4e76f1[_0x1b3b77(0x131)])+Math[_0x1b3b77(0xd3)](_0x4b6224[_0x1b3b77(0xfb)]),_0x5b2ffc++);}console[_0x1b3b77(0x11b)]('int',_0x5b2ffc),_0x5b2ffc=='0'&&(_0x149a10[_0x1b3b77(0x1af)]=_0x149a10[_0x1b3b77(0x1af)][_0x1b3b77(0x115)]({'product_name':_0x4b6224['product_name'],'product_stock':_0x4b6224[_0x1b3b77(0xfb)],'bay':_0x4b6224[_0x1b3b77(0x12f)],'level':_0x4b6224[_0x1b3b77(0xd2)],'product_code':_0x4b6224[_0x1b3b77(0x1bc)],'primary_code':_0x4b6224[_0x1b3b77(0x20c)],'secondary_code':_0x4b6224[_0x1b3b77(0x178)],'expiry_date':_0x4b6224[_0x1b3b77(0x1f5)],'production_date':_0x4b6224[_0x1b3b77(0x19d)],'maxProducts':_0x4b6224[_0x1b3b77(0x114)],'batch_code':_0x4b6224[_0x1b3b77(0x1fe)],'secondary_unit':_0x4b6224[_0x1b3b77(0x1c0)],'unit':_0x4b6224['unit'],'maxProducts':_0x4b6224[_0x1b3b77(0x114)],'maxPerUnit':_0x4b6224['maxperunit'],'invoice':_0x4b6224[_0x1b3b77(0x1c2)],'warehouse_id':_0x4b6224[_0x1b3b77(0x175)],'id_incoming':_0x4b6224[_0x1b3b77(0x15f)],'uuid':_0x4b6224['uuid'],'gross_price':_0x4b6224['gross_price'],'date_incoming':_0x4b6224['date_data'],'outgoing_invoice':_0x4b6224[_0x1b3b77(0x1bd)]}),await _0x149a10[_0x1b3b77(0x1a2)]());}}_0x5561c3[_0x1b3b77(0x209)]=_0x1b3b77(0x180);const _0xfb784e=await _0x5561c3[_0x1b3b77(0x1a2)](),_0x2236b6=await master_shop[_0x1b3b77(0x1b4)](),_0x1c5cfe=await email_settings[_0x1b3b77(0x14b)](),_0x5b3372=await supervisor_settings[_0x1b3b77(0x1b4)]();var _0x575f25=_0x5561c3[_0x1b3b77(0x18f)],_0x4f56d2='',_0x1ddad4;for(_0x1ddad4 in _0x575f25){_0x4f56d2+=_0x1b3b77(0x1f4)+_0x1b3b77(0x20d)+_0x575f25[_0x1ddad4][_0x1b3b77(0x1d6)]+'</td>'+_0x1b3b77(0x20d)+_0x575f25[_0x1ddad4][_0x1b3b77(0x1bc)]+_0x1b3b77(0x142)+_0x1b3b77(0x20d)+_0x575f25[_0x1ddad4][_0x1b3b77(0xfb)]+_0x1b3b77(0x142)+_0x1b3b77(0x20d)+_0x575f25[_0x1ddad4][_0x1b3b77(0xf3)]+'</td>'+_0x1b3b77(0x20d)+_0x575f25[_0x1ddad4][_0x1b3b77(0x1c0)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5561c3['warehouse_name']+_0x1b3b77(0x142)+_0x1b3b77(0x20d)+_0x575f25[_0x1ddad4][_0x1b3b77(0x158)]+_0x1b3b77(0x142)+_0x1b3b77(0x20d)+_0x575f25[_0x1ddad4][_0x1b3b77(0x12f)]+_0x1b3b77(0x142);}_0x3e0aa8[_0x1b3b77(0x13f)](_0x1b3b77(0x128),_0x1b3b77(0x1df)),_0x131974[_0x1b3b77(0x153)](_0x1b3b77(0x214)+_0x2263e6);}catch(_0x52ee42){console[_0x1b3b77(0x11b)](_0x52ee42);}}),router[a0_0x376c37(0x1c7)](a0_0x376c37(0x1ce),auth,async(_0x5dedf1,_0x7fc880)=>{var _0x142948=a0_0x376c37;try{const {username:_0x1dd2fd,email:_0x4337b4,role:_0x428ac1}=_0x5dedf1[_0x142948(0x135)],_0x2a52ae=_0x5dedf1[_0x142948(0x135)],_0x525dd4=await profile[_0x142948(0x14b)]({'email':_0x2a52ae['email']}),_0x5adc83=await master_shop['find'](),_0x437539=_0x5dedf1[_0x142948(0x112)]['id'],_0x541754=await sales_finished[_0x142948(0x183)](_0x437539);let _0x41ba8c=new Date(_0x541754[_0x142948(0x1f5)]),_0x4be794=('0'+_0x41ba8c['getDate']())['slice'](-0x2),_0x49c54b=('0'+(_0x41ba8c['getMonth']()+0x1))['slice'](-0x2),_0x317c0d=_0x41ba8c[_0x142948(0xff)](),_0x288a8c=_0x317c0d+'-'+_0x49c54b+'-'+_0x4be794;var _0x2eed7a=[_0x142948(0x1db),_0x142948(0x173)];const _0x1530a1=await warehouse[_0x142948(0x15c)]([{'$match':{'name':_0x541754[_0x142948(0x14a)],'room':_0x541754[_0x142948(0xf0)]}},{'$unwind':_0x142948(0xe6)},{'$group':{'_id':_0x142948(0x1be),'name':{'$first':_0x142948(0x1e1)},'product_stock':{'$first':_0x142948(0x21a)},'bay':{'$first':_0x142948(0x20a)},'bin':{'$first':_0x142948(0x13c)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x142948(0x163)},'primary_code':{'$first':_0x142948(0x133)},'secondary_code':{'$first':_0x142948(0x216)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x142948(0x1ca)},'rack':{'$first':_0x142948(0x1cb)}}}]),_0x434df2=await customer['find']({});let _0x1fde43;if(_0x2a52ae['role']=='staff'){const _0x11bd27=await staff[_0x142948(0x14b)]({'email':_0x2a52ae[_0x142948(0x151)]});_0x1fde43=await warehouse[_0x142948(0x15c)]([{'$match':{'status':'Enabled','name':_0x11bd27[_0x142948(0x1f1)]}},{'$group':{'_id':_0x142948(0x145),'name':{'$first':_0x142948(0x145)}}}]);}else _0x1fde43=await warehouse[_0x142948(0x15c)]([{'$match':{'status':_0x142948(0x185)}},{'$group':{'_id':_0x142948(0x145),'name':{'$first':_0x142948(0x145)}}}]);const _0x2cb12c=await product[_0x142948(0x1b4)]({});if(_0x5adc83[0x0][_0x142948(0x1ea)]==_0x142948(0x17d)){var _0x4dcd90=users[_0x142948(0x124)];console[_0x142948(0x11b)](_0x4dcd90);}else{if(_0x5adc83[0x0][_0x142948(0x1ea)]==_0x142948(0x1dd))var _0x4dcd90=users[_0x142948(0x1dd)];else{if(_0x5adc83[0x0][_0x142948(0x1ea)]==_0x142948(0x1ff))var _0x4dcd90=users[_0x142948(0x1ff)];else{if(_0x5adc83[0x0][_0x142948(0x1ea)]==_0x142948(0x197))var _0x4dcd90=users[_0x142948(0x197)];else{if(_0x5adc83[0x0][_0x142948(0x1ea)]==_0x142948(0x10f))var _0x4dcd90=users[_0x142948(0x10f)];else{if(_0x5adc83[0x0][_0x142948(0x1ea)]=='Portuguese\x20(BR)')var _0x4dcd90=users[_0x142948(0x219)];else{if(_0x5adc83[0x0][_0x142948(0x1ea)]=='Chinese')var _0x4dcd90=users[_0x142948(0x192)];else{if(_0x5adc83[0x0]['language']==_0x142948(0x1b3))var _0x4dcd90=users[_0x142948(0x1c5)];}}}}}}}_0x7fc880[_0x142948(0x11e)](_0x142948(0x1cd),{'success':_0x5dedf1['flash'](_0x142948(0x128)),'errors':_0x5dedf1[_0x142948(0x13f)](_0x142948(0xd8)),'role':_0x2a52ae,'profile':_0x525dd4,'customer':_0x434df2,'warehouse':_0x1fde43,'product':_0x1530a1,'user':_0x541754,'master_shop':_0x5adc83,'unit':_0x2cb12c,'language':_0x4dcd90,'rooms_data':_0x2eed7a,'ed_fullDate':_0x288a8c});}catch(_0x5e759c){console[_0x142948(0x11b)](_0x5e759c);}}),router[a0_0x376c37(0xd4)](a0_0x376c37(0x1ce),auth,async(_0x32fd3d,_0xe47446)=>{var _0x4500cf=a0_0x376c37;try{const _0x14214a=_0x32fd3d[_0x4500cf(0x112)]['id'],_0xeaab70=await sales_finished[_0x4500cf(0x14b)]({'_id':_0x32fd3d[_0x4500cf(0x112)]['id']}),_0x3fb2d1=await warehouse[_0x4500cf(0x14b)]({'name':_0xeaab70['warehouse_name'],'room':_0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0xf0)],'warehouse_category':_0x4500cf(0x1fa)}),{invoice:_0x3809f3,customer:_0x4907ce,date:_0x230c94,warehouse_name:_0x2ff883,product_name:_0x4808ed,stock:_0x509305,adjust_qty:_0xa5cda4,note:_0x304663,room:_0x3f5f44,primary_code:_0x3aa58e,secondary_code:_0x455662,prod_code:_0xed1cb0,level:_0x470dbf,isle:_0x5480ff,pallet:_0x4641c2,expiry_date:_0x1d693e}=_0x32fd3d[_0x4500cf(0x159)];if(typeof _0x4808ed==_0x4500cf(0x14e))var _0x53a164=[_0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x1d6)]],_0x382a36=[_0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x16c)]],_0x3dfeb5=[_0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x160)]],_0x27d9e6=[_0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x20c)]],_0x6ac496=[_0x32fd3d['body']['secondary_code']],_0x4a601c=[_0x32fd3d[_0x4500cf(0x159)]['prod_code']],_0x37d78c=[_0x32fd3d[_0x4500cf(0x159)]['level']],_0x8d0194=[_0x32fd3d[_0x4500cf(0x159)]['expiry_date']];else var _0x53a164=[..._0x32fd3d['body'][_0x4500cf(0x1d6)]],_0x382a36=[..._0x32fd3d[_0x4500cf(0x159)]['stock']],_0x3dfeb5=[..._0x32fd3d[_0x4500cf(0x159)]['adjust_qty']],_0x27d9e6=[..._0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x20c)]],_0x6ac496=[..._0x32fd3d['body']['secondary_code']],_0x4a601c=[..._0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x1c6)]],_0x37d78c=[..._0x32fd3d[_0x4500cf(0x159)]['level']],_0x8d0194=[..._0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x1f5)]];const _0x1fe2d5=_0x53a164['map'](_0x108aec=>{return _0x108aec={'product_name':_0x108aec};});_0x382a36[_0x4500cf(0x1e7)]((_0x585371,_0x345e06)=>{_0x1fe2d5[_0x345e06]['stock']=_0x585371;}),_0x3dfeb5[_0x4500cf(0x1e7)]((_0x4db3f6,_0x4caa8e)=>{var _0x398504=_0x4500cf;_0x1fe2d5[_0x4caa8e][_0x398504(0xfb)]=_0x4db3f6;}),_0x27d9e6[_0x4500cf(0x1e7)]((_0x2ec4b8,_0x4249c8)=>{var _0x56e879=_0x4500cf;_0x1fe2d5[_0x4249c8][_0x56e879(0x20c)]=_0x2ec4b8;}),_0x6ac496[_0x4500cf(0x1e7)]((_0x101b66,_0xa8cef1)=>{var _0x31291a=_0x4500cf;_0x1fe2d5[_0xa8cef1][_0x31291a(0x178)]=_0x101b66;}),_0x4a601c[_0x4500cf(0x1e7)]((_0x5d6ab7,_0x23e490)=>{var _0x552e89=_0x4500cf;_0x1fe2d5[_0x23e490][_0x552e89(0x1bc)]=_0x5d6ab7;}),_0x37d78c[_0x4500cf(0x1e7)]((_0x259e2c,_0x2fa257)=>{var _0x428c80=_0x4500cf;_0x1fe2d5[_0x2fa257][_0x428c80(0xd2)]=_0x259e2c;}),_0x8d0194['forEach']((_0xa93075,_0x4ca841)=>{var _0x477caa=_0x4500cf;_0x1fe2d5[_0x4ca841][_0x477caa(0x1f5)]=_0xa93075;});var _0x166649=0x0;_0x1fe2d5[_0x4500cf(0x1e7)](_0x51acb1=>{var _0xbfce17=_0x4500cf;console[_0xbfce17(0x11b)](_0xbfce17(0x1a9),_0x51acb1),(parseInt(_0x51acb1[_0xbfce17(0x16c)])<parseInt(_0x51acb1[_0xbfce17(0xfb)])||parseInt(_0x51acb1[_0xbfce17(0xfb)])==0x0)&&_0x166649++;});if(_0x166649!=0x0)return _0x32fd3d[_0x4500cf(0x13f)](_0x4500cf(0xd8),_0x4500cf(0x13d)),_0xe47446[_0x4500cf(0x153)](_0x4500cf(0x174));_0xeaab70[_0x4500cf(0x18f)][_0x4500cf(0x1e7)](_0x6b64bc=>{var _0x1252c1=_0x4500cf;const _0x36136d=_0x3fb2d1[_0x1252c1(0x143)][_0x1252c1(0x132)](_0x40a23f=>{var _0x2294ef=_0x1252c1;_0x40a23f[_0x2294ef(0x1d6)]==_0x6b64bc['product_name']&&_0x40a23f[_0x2294ef(0x12f)]==_0x6b64bc[_0x2294ef(0x12f)]&&(_0x40a23f[_0x2294ef(0x131)]=parseInt(_0x40a23f['product_stock'])+parseInt(_0x6b64bc['quantity']));});}),await _0x3fb2d1[_0x4500cf(0x1a2)]();const _0x2c1624=_0x1fe2d5[_0x4500cf(0x19c)](_0x4f6132=>_0x4f6132[_0x4500cf(0xfb)]!=='0'&&_0x4f6132['quantity']!=='');_0xeaab70[_0x4500cf(0x1c2)]=_0x3809f3,_0xeaab70[_0x4500cf(0x154)]=_0x4907ce,_0xeaab70[_0x4500cf(0xda)]=_0x230c94,_0xeaab70['warehouse_name']=_0x2ff883,_0xeaab70[_0x4500cf(0x18f)]=_0x2c1624,_0xeaab70[_0x4500cf(0x198)]=_0x304663,_0xeaab70['room']=_0x3f5f44;const _0xd7ba4c=await _0xeaab70[_0x4500cf(0x1a2)](),_0x25d481=await sales_finished['findOne']({'_id':_0x32fd3d['params']['id']}),_0x4f2040=await warehouse['findOne']({'name':_0x2ff883,'room':_0x3f5f44,'warehouse_category':_0x4500cf(0x1fa)});_0x25d481[_0x4500cf(0x18f)][_0x4500cf(0x1e7)](_0x2b3b98=>{var _0x1a5ee1=_0x4500cf;const _0x430b49=_0x4f2040['product_details'][_0x1a5ee1(0x132)](_0x800722=>{var _0x429906=_0x1a5ee1;_0x800722[_0x429906(0x1d6)]==_0x2b3b98['product_name']&&_0x800722[_0x429906(0x12f)]==_0x2b3b98[_0x429906(0x12f)]&&(_0x800722['product_stock']=parseInt(_0x800722[_0x429906(0x131)])-parseInt(_0x2b3b98[_0x429906(0xfb)]));});}),console['log']('final',_0x4f2040),await _0x4f2040['save']();const _0x4a90cd=await c_payment_data[_0x4500cf(0x14b)]({'invoice':_0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x1c2)]});_0x4a90cd[_0x4500cf(0x152)]=_0x32fd3d[_0x4500cf(0x159)][_0x4500cf(0x152)],await _0x4a90cd[_0x4500cf(0x1a2)](),_0x32fd3d[_0x4500cf(0x13f)]('success',_0x4500cf(0x1df)),_0xe47446[_0x4500cf(0x153)](_0x4500cf(0xd6));}catch(_0xa23cc1){console[_0x4500cf(0x11b)](_0xa23cc1);}}),router[a0_0x376c37(0xd4)]('/give_payment/:id',auth,async(_0x42c3d5,_0x4ef525)=>{var _0x26dcc8=a0_0x376c37;try{const _0xa845f3=_0x42c3d5[_0x26dcc8(0x112)]['id'],{invoice:_0x53867b,customer:_0x30bad7,receivable_amount:_0x85592d,received_amount:_0x1d10ec}=_0x42c3d5['body'],_0x502dc5=await sales[_0x26dcc8(0x183)](_0xa845f3);console['log'](_0x502dc5);var _0xeac998=_0x85592d-_0x1d10ec;console[_0x26dcc8(0x11b)](_0x1d10ec),_0x502dc5[_0x26dcc8(0x1d3)]=parseFloat(_0x1d10ec)+parseFloat(_0x502dc5[_0x26dcc8(0x1d3)]),_0x502dc5[_0x26dcc8(0x172)]=_0xeac998,console[_0x26dcc8(0x11b)](_0x502dc5);const _0x4b72fe=await _0x502dc5['save'](),_0x335d70=await c_payment_data[_0x26dcc8(0x14b)]({'invoice':_0x53867b});_0x335d70[_0x26dcc8(0xfc)]=_0xeac998,await _0x335d70[_0x26dcc8(0x1a2)]();let _0x3f2616=new Date(),_0x30303b=('0'+_0x3f2616[_0x26dcc8(0xf9)]())[_0x26dcc8(0x199)](-0x2),_0xf77fc3=('0'+(_0x3f2616['getMonth']()+0x1))[_0x26dcc8(0x199)](-0x2),_0x46976d=_0x3f2616[_0x26dcc8(0xff)](),_0x5310f9=_0x46976d+'-'+_0xf77fc3+'-'+_0x30303b;const _0xd7ca6a=new customer_payment({'invoice':_0x53867b,'date':_0x46976d+'-'+_0xf77fc3+'-'+_0x30303b,'customer':_0x30bad7,'reason':_0x26dcc8(0x122),'amount':_0x1d10ec}),_0x1f9984=await _0xd7ca6a[_0x26dcc8(0x1a2)]();_0x42c3d5[_0x26dcc8(0x13f)](_0x26dcc8(0x128),_0x26dcc8(0x193)),_0x4ef525['redirect'](_0x26dcc8(0x14c));}catch(_0xb020db){console[_0x26dcc8(0x11b)](_0xb020db);}}),router['get']('/invoice/:id',auth,async(_0x251ee4,_0x3f5c65)=>{var _0x22889c=a0_0x376c37;try{const {username:_0x57c8f1,email:_0x1a42be,role:_0x41755f}=_0x251ee4[_0x22889c(0x135)],_0x31d083=_0x251ee4[_0x22889c(0x135)],_0x47543f=await profile[_0x22889c(0x14b)]({'email':_0x31d083[_0x22889c(0x151)]}),_0x2e6a87=await master_shop[_0x22889c(0x1b4)]();console[_0x22889c(0x11b)](_0x22889c(0x166),_0x2e6a87);const _0x8e2a29=_0x251ee4[_0x22889c(0x112)]['id'],_0x3e0757=await sales[_0x22889c(0x183)](_0x8e2a29);console[_0x22889c(0x11b)](_0x3e0757);const _0x4704a7=await customer['findOne']({'name':_0x3e0757['customer']});console[_0x22889c(0x11b)](_0x4704a7);if(_0x2e6a87[0x0][_0x22889c(0x1ea)]==_0x22889c(0x17d)){var _0x1cacd8=users[_0x22889c(0x124)];console['log'](_0x1cacd8);}else{if(_0x2e6a87[0x0][_0x22889c(0x1ea)]==_0x22889c(0x1dd))var _0x1cacd8=users['Hindi'];else{if(_0x2e6a87[0x0][_0x22889c(0x1ea)]==_0x22889c(0x1ff))var _0x1cacd8=users[_0x22889c(0x1ff)];else{if(_0x2e6a87[0x0][_0x22889c(0x1ea)]=='Spanish')var _0x1cacd8=users[_0x22889c(0x197)];else{if(_0x2e6a87[0x0][_0x22889c(0x1ea)]==_0x22889c(0x10f))var _0x1cacd8=users[_0x22889c(0x10f)];else{if(_0x2e6a87[0x0][_0x22889c(0x1ea)]==_0x22889c(0x101))var _0x1cacd8=users[_0x22889c(0x219)];else{if(_0x2e6a87[0x0][_0x22889c(0x1ea)]==_0x22889c(0x192))var _0x1cacd8=users[_0x22889c(0x192)];else{if(_0x2e6a87[0x0][_0x22889c(0x1ea)]==_0x22889c(0x1b3))var _0x1cacd8=users['Arabic'];}}}}}}}_0x3f5c65['render'](_0x22889c(0x19f),{'success':_0x251ee4[_0x22889c(0x13f)](_0x22889c(0x128)),'errors':_0x251ee4[_0x22889c(0x13f)](_0x22889c(0xd8)),'role':_0x31d083,'profile':_0x47543f,'master_shop':_0x2e6a87,'customers':_0x4704a7,'sales':_0x3e0757,'language':_0x1cacd8});}catch(_0x45f557){console[_0x22889c(0x11b)](_0x45f557);}}),router[a0_0x376c37(0x1c7)]('/view/return_sales/:id',auth,async(_0x3b2a12,_0x216582)=>{var _0x4fd08d=a0_0x376c37;try{const {username:_0x2610d1,email:_0x3bd297,role:_0x42c4a7}=_0x3b2a12[_0x4fd08d(0x135)],_0x28b564=_0x3b2a12[_0x4fd08d(0x135)],_0x2ec368=await profile[_0x4fd08d(0x14b)]({'email':_0x28b564[_0x4fd08d(0x151)]}),_0x5d9f89=await master_shop[_0x4fd08d(0x1b4)](),_0x4fb39f=_0x3b2a12[_0x4fd08d(0x112)]['id'],_0x53498c=await sales_finished[_0x4fd08d(0x183)](_0x4fb39f),_0x18ad12=await warehouse['aggregate']([{'$match':{'name':_0x53498c[_0x4fd08d(0x14a)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4fd08d(0x1be),'name':{'$first':_0x4fd08d(0x1e1)},'product_stock':{'$first':_0x4fd08d(0x21a)},'bay':{'$first':_0x4fd08d(0x20a)},'bin':{'$first':_0x4fd08d(0x13c)},'type':{'$first':_0x4fd08d(0x1bb)},'floorlevel':{'$first':_0x4fd08d(0x163)},'primary_code':{'$first':_0x4fd08d(0x133)},'secondary_code':{'$first':_0x4fd08d(0x216)},'product_code':{'$first':_0x4fd08d(0x14f)},'storage':{'$first':_0x4fd08d(0x1ca)},'rack':{'$first':_0x4fd08d(0x1cb)},'expiry_date':{'$first':_0x4fd08d(0x1a5)},'production_date':{'$first':_0x4fd08d(0xdf)},'unit':{'$first':_0x4fd08d(0x179)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x4fd08d(0xee)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x4fd08d(0x10b)}}}]),_0x1d951a=await product[_0x4fd08d(0x1b4)]({}),_0x3846c6=await warehouse[_0x4fd08d(0x15c)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods','name':{'$ne':_0x4fd08d(0xe7),'$ne':_0x4fd08d(0x1c1)}}},{'$group':{'_id':_0x4fd08d(0x145),'name':{'$first':_0x4fd08d(0x145)}}},{'$sort':{'name':0x1}}]);var _0x2020b1=['Return\x20Rooms'];const _0xebde08=await warehouse[_0x4fd08d(0x15c)]([{'$match':{'status':_0x4fd08d(0x185),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0x4fd08d(0x145),'name':{'$first':_0x4fd08d(0x145)}}},{'$sort':{'name':0x1}}]);if(_0x5d9f89[0x0][_0x4fd08d(0x1ea)]==_0x4fd08d(0x17d)){var _0x293d46=users[_0x4fd08d(0x124)];console[_0x4fd08d(0x11b)](_0x293d46);}else{if(_0x5d9f89[0x0]['language']==_0x4fd08d(0x1dd))var _0x293d46=users[_0x4fd08d(0x1dd)];else{if(_0x5d9f89[0x0][_0x4fd08d(0x1ea)]==_0x4fd08d(0x1ff))var _0x293d46=users[_0x4fd08d(0x1ff)];else{if(_0x5d9f89[0x0][_0x4fd08d(0x1ea)]==_0x4fd08d(0x197))var _0x293d46=users[_0x4fd08d(0x197)];else{if(_0x5d9f89[0x0]['language']=='French')var _0x293d46=users[_0x4fd08d(0x10f)];else{if(_0x5d9f89[0x0][_0x4fd08d(0x1ea)]=='Portuguese\x20(BR)')var _0x293d46=users[_0x4fd08d(0x219)];else{if(_0x5d9f89[0x0]['language']=='Chinese')var _0x293d46=users[_0x4fd08d(0x192)];else{if(_0x5d9f89[0x0][_0x4fd08d(0x1ea)]==_0x4fd08d(0x1b3))var _0x293d46=users['Arabic'];}}}}}}}_0x216582[_0x4fd08d(0x11e)](_0x4fd08d(0xe4),{'success':_0x3b2a12['flash'](_0x4fd08d(0x128)),'errors':_0x3b2a12[_0x4fd08d(0x13f)](_0x4fd08d(0xd8)),'role':_0x28b564,'profile':_0x2ec368,'user':_0x53498c,'stock':_0x18ad12,'master_shop':_0x5d9f89,'unit':_0x1d951a,'language':_0x293d46,'warehouses':_0x3846c6,'rooms':_0x2020b1,'warehouse_QA':_0xebde08});}catch(_0x195a51){console[_0x4fd08d(0x11b)](_0x195a51),_0x216582[_0x4fd08d(0x1f7)](0xc8)[_0x4fd08d(0x121)]({'message':_0x195a51[_0x4fd08d(0x1f3)]});}}),router[a0_0x376c37(0xd4)](a0_0x376c37(0x155),auth,async(_0x1c6721,_0x1c4217)=>{var _0x5599ed=a0_0x376c37;if(_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x148)]=='QA')try{const {invoice:_0x414452,date:_0x44a32d,warehouse_name:_0x44b5e9,product_name:_0x599351,primary_code:_0x7583e3,secondary_code:_0x449646,product_code:_0x56bb0c,sales_quantity:_0x20b3aa,stocks:_0x547855,return_qty:_0x3325e6,Room_name:_0x239a02,to_warehouse_name_QA:_0x1de3c0,to_Room_name_QA:_0xb00bc0,note:_0x15b183,for_categorize:_0x490a5b,product_name_QA1:_0x3f6d9a}=_0x1c6721['body'];if(typeof _0x3f6d9a==_0x5599ed(0x14e))var _0x364305=[_0x1c6721['body'][_0x5599ed(0x17c)]],_0x5a13e0=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x205)]],_0xd0ce0e=[_0x1c6721['body'][_0x5599ed(0x18b)]],_0x345190=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x210)]],_0x6b698a=[_0x1c6721['body']['sales_quantity_QA']],_0x4f364b=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x19a)]],_0xacc1bb=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1b5)]],_0x52baf8=[_0x1c6721['body'][_0x5599ed(0x206)]],_0x4ae72e=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x13e)]],_0x324407=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x13b)]],_0x3cfb72=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0xd7)]],_0x3af787=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1bf)]],_0x2d8fed=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x113)]],_0x30669e=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1d8)]];else var _0x364305=[..._0x1c6721[_0x5599ed(0x159)]['product_name_QA1']],_0x5a13e0=[..._0x1c6721['body']['primary_code_QA']],_0xd0ce0e=[..._0x1c6721['body']['secondary_code_QA']],_0x345190=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x210)]],_0x6b698a=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x167)]],_0x4f364b=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x19a)]],_0xacc1bb=[..._0x1c6721[_0x5599ed(0x159)]['return_qty_QA']],_0x52baf8=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x206)]],_0x4ae72e=[..._0x1c6721[_0x5599ed(0x159)]['maxProducts_QA']],_0x324407=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x13b)]],_0x3cfb72=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0xd7)]],_0x3af787=[..._0x1c6721['body'][_0x5599ed(0x1bf)]],_0x2d8fed=[..._0x1c6721[_0x5599ed(0x159)]['production_date_QA']],_0x30669e=[..._0x1c6721['body'][_0x5599ed(0x1d8)]];const _0x2ae0a8=_0x364305[_0x5599ed(0x132)](_0x379cae=>{return _0x379cae={'product_name':_0x379cae};});_0x5a13e0['forEach']((_0x39e765,_0x48f2f6)=>{var _0x2144c8=_0x5599ed;_0x2ae0a8[_0x48f2f6][_0x2144c8(0x20c)]=_0x39e765;}),_0xd0ce0e[_0x5599ed(0x1e7)]((_0x5ae2be,_0xae4dae)=>{var _0x50caa7=_0x5599ed;_0x2ae0a8[_0xae4dae][_0x50caa7(0x178)]=_0x5ae2be;}),_0x345190[_0x5599ed(0x1e7)]((_0x40a720,_0x4dcc07)=>{var _0x1b36ca=_0x5599ed;_0x2ae0a8[_0x4dcc07][_0x1b36ca(0x1bc)]=_0x40a720;}),_0x6b698a[_0x5599ed(0x1e7)]((_0x2428fb,_0x256e80)=>{_0x2ae0a8[_0x256e80]['sale_qty']=_0x2428fb;}),_0x4f364b['forEach']((_0x211356,_0x249d98)=>{var _0x24d835=_0x5599ed;_0x2ae0a8[_0x249d98][_0x24d835(0x16c)]=_0x211356;}),_0xacc1bb[_0x5599ed(0x1e7)]((_0x45b57f,_0x42f22d)=>{var _0x5aaa5c=_0x5599ed;_0x2ae0a8[_0x42f22d][_0x5aaa5c(0x1de)]=_0x45b57f;}),_0x52baf8[_0x5599ed(0x1e7)]((_0x43b6b3,_0xf7ec8a)=>{var _0x45b38e=_0x5599ed;_0x2ae0a8[_0xf7ec8a][_0x45b38e(0x139)]=_0x43b6b3;}),_0x4ae72e[_0x5599ed(0x1e7)]((_0x140f3d,_0x3b774f)=>{var _0x38e0de=_0x5599ed;_0x2ae0a8[_0x3b774f][_0x38e0de(0x114)]=_0x140f3d;}),_0x324407[_0x5599ed(0x1e7)]((_0x2375bd,_0x231f3f)=>{var _0x3d6394=_0x5599ed;_0x2ae0a8[_0x231f3f][_0x3d6394(0x1fe)]=_0x2375bd;}),_0x3cfb72[_0x5599ed(0x1e7)]((_0x2aa518,_0xf6a03)=>{var _0x43ebcb=_0x5599ed;_0x2ae0a8[_0xf6a03][_0x43ebcb(0x1c0)]=_0x2aa518;}),_0x3af787[_0x5599ed(0x1e7)]((_0x21ee32,_0x34590d)=>{var _0x27cb9e=_0x5599ed;_0x2ae0a8[_0x34590d][_0x27cb9e(0xf3)]=_0x21ee32;}),_0x2d8fed['forEach']((_0x448cd5,_0x2f53e7)=>{var _0x22f946=_0x5599ed;_0x2ae0a8[_0x2f53e7][_0x22f946(0x19d)]=_0x448cd5;}),_0x30669e[_0x5599ed(0x1e7)]((_0x1ca400,_0x7ffdf2)=>{var _0x1ca901=_0x5599ed;_0x2ae0a8[_0x7ffdf2][_0x1ca901(0x1f5)]=_0x1ca400;});const _0x46945f=await sales_finished[_0x5599ed(0x14b)]({'invoice':_0x414452});_0x46945f[_0x5599ed(0x1b2)]=_0x5599ed(0x180);const _0xe17f76=await _0x46945f['save'](),_0xf2d91f=new sales_return_finished({'invoice':_0x414452,'customer':_0x1c6721['body'][_0x5599ed(0x154)],'date':_0x44a32d,'warehouse_name':_0x44b5e9,'room':_0x239a02,'ToWarehouse':_0x1de3c0,'ToRoom':_0xb00bc0,'return_sale_QA':_0x2ae0a8,'note':_0x15b183,'warehouse_cat':_0x490a5b}),_0x574a48=await _0xf2d91f['save'](),_0x4e8b7c=await sales_return_finished['findOne']({'invoice':_0x414452}),_0x4ff70f=await warehouse[_0x5599ed(0x14b)]({'name':_0x1de3c0,'room':_0xb00bc0});_0x4e8b7c[_0x5599ed(0x1ee)][_0x5599ed(0x1e7)](_0x4bbfff=>{var _0x382b87=_0x5599ed,_0x1d6617=0x0;const _0x4e92e2=_0x4ff70f[_0x382b87(0x143)][_0x382b87(0x132)](_0x416bc7=>{var _0x4e15cc=_0x382b87;_0x416bc7[_0x4e15cc(0x1d6)]==_0x4bbfff[_0x4e15cc(0x1d6)]&&_0x416bc7[_0x4e15cc(0x1f5)]==_0x4bbfff['expiry_date']&&_0x416bc7[_0x4e15cc(0x19d)]==_0x4bbfff[_0x4e15cc(0x19d)]&&_0x416bc7[_0x4e15cc(0x1fe)]==_0x4bbfff['batch_code']&&(_0x416bc7[_0x4e15cc(0x131)]=parseInt(_0x416bc7[_0x4e15cc(0x131)])+parseInt(_0x4bbfff[_0x4e15cc(0x1de)]),_0x1d6617++);});_0x1d6617=='0'&&(_0x4ff70f['product_details']=_0x4ff70f['product_details'][_0x382b87(0x115)]({'product_name':_0x4bbfff['product_name'],'product_stock':_0x4bbfff[_0x382b87(0x1de)],'primary_code':_0x4bbfff[_0x382b87(0x20c)],'secondary_code':_0x4bbfff[_0x382b87(0x178)],'product_code':_0x4bbfff['product_code'],'batch_code':_0x4bbfff['batch_code'],'maxPerUnit':_0x4bbfff[_0x382b87(0x139)],'production_date':_0x4bbfff['production_date'],'expiry_date':_0x4bbfff[_0x382b87(0x1f5)],'secondary_unit':_0x4bbfff['secondary_unit'],'unit':_0x4bbfff[_0x382b87(0xf3)],'maxProducts':_0x4bbfff[_0x382b87(0x114)],'bay':_0x4bbfff['bay']}));}),await _0x4ff70f[_0x5599ed(0x1a2)]();const _0x477a82=new c_payment_data({'invoice':_0x414452,'customer':_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x154)],'reason':'Sale\x20Return'});await _0x477a82['save']();const _0x186952=await master_shop[_0x5599ed(0x1b4)](),_0x2e6b8f=await email_settings[_0x5599ed(0x14b)](),_0x2d36a1=await customer[_0x5599ed(0x14b)]({'name':_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x154)]});_0x186952[0x0][_0x5599ed(0x1ab)]==0x1?(right_currency=_0x186952[0x0][_0x5599ed(0x11f)],left_currency=''):(right_currency='',left_currency=_0x186952[0x0][_0x5599ed(0x11f)]);var _0x3e6b5c=_0x364305,_0x166461=_0xacc1bb,_0x304136='',_0x523cbe;for(_0x523cbe in _0x3e6b5c){_0x304136+=_0x5599ed(0x1f4)+_0x5599ed(0x20d)+_0x3e6b5c[_0x523cbe]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x166461[_0x523cbe]+_0x5599ed(0x142)+_0x5599ed(0x1ed);}console['log']('product_list',_0x304136);let _0x30f4e8=nodemailer[_0x5599ed(0x1a1)]({'service':_0x5599ed(0x157),'auth':{'user':_0x2e6b8f['email'],'pass':_0x2e6b8f[_0x5599ed(0x18c)]}}),_0xb677bc={'from':_0x2e6b8f[_0x5599ed(0x151)],'to':_0x2d36a1[_0x5599ed(0x151)],'subject':_0x5599ed(0x191),'attachments':[{'filename':'Logo.png','path':__dirname+_0x5599ed(0x188)+_0x5599ed(0xe1)+_0x186952[0x0][_0x5599ed(0xe3)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x5599ed(0x177)+_0x5599ed(0x211)+_0x5599ed(0x1d0)+_0x5599ed(0x137)+_0x5599ed(0x1d0)+_0x5599ed(0x1fb)+'</div>'+_0x5599ed(0x1d0)+'<h2>\x20'+_0x186952[0x0][_0x5599ed(0x12b)]+_0x5599ed(0x1c3)+_0x5599ed(0x215)+_0x5599ed(0x215)+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x414452+'\x20'+_0x5599ed(0x1a3)+'\x20Order\x20Date\x20:\x20'+_0x44a32d+'\x20'+_0x5599ed(0x100)+_0x5599ed(0x212)+'</div>'+_0x5599ed(0xf2)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5599ed(0x1f4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x5599ed(0x201)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x5599ed(0x164)+_0x5599ed(0x1ed)+_0x5599ed(0x1c9)+_0x5599ed(0x1a7)+'\x20'+_0x304136+'\x20'+_0x5599ed(0x1a4)+'</table>'+_0x5599ed(0x1d0)+_0x5599ed(0xe0)+_0x5599ed(0xdc)+_0x186952[0x0][_0x5599ed(0x12b)]+_0x5599ed(0x212)+_0x5599ed(0x215)+'</div>'+_0x5599ed(0x129)};_0x30f4e8[_0x5599ed(0x149)](_0xb677bc,function(_0x19581e,_0xc30a75){var _0x1bc8e2=_0x5599ed;_0x19581e?(console['log'](_0x19581e),console['log'](_0x1bc8e2(0x196))):console['log'](_0x1bc8e2(0x194));}),_0x1c6721[_0x5599ed(0x13f)](_0x5599ed(0x128),_0x5599ed(0x1a8)),_0x1c4217[_0x5599ed(0x153)](_0x5599ed(0xd6));}catch(_0x9f1230){_0x1c4217[_0x5599ed(0x1f7)](0xc8)[_0x5599ed(0x121)]({'message1':_0x9f1230[_0x5599ed(0x1f3)]});}else{if(_0x1c6721['body'][_0x5599ed(0x148)]=='GS')try{const {invoice:_0x4678cf,date:_0x221d03,warehouse_name:_0x5256cf,product_name:_0x519a5e,primary_code:_0x3c17f4,secondary_code:_0x7586db,product_code:_0x5710e6,sales_quantity:_0x193adf,stocks:_0x2c874c,return_qty:_0x139b13,Room_name:_0x46c793,to_warehouse_name:_0x13fbb0,to_Room_name:_0xba9f7c,note:_0x10de73,level:_0x3b0377,isle:_0x2554dd,pallet:_0x1b46a6,for_categorize:_0x4e6af9}=_0x1c6721[_0x5599ed(0x159)];if(typeof _0x519a5e=='string')var _0x364305=[_0x1c6721['body']['product_name']],_0x5a13e0=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x20c)]],_0xd0ce0e=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x178)]],_0x345190=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1bc)]],_0x6b698a=[_0x1c6721['body']['sales_quantity']],_0xacc1bb=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1de)]],_0x113e8f=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x12f)]],_0x52baf8=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x139)]],_0x4ae72e=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x114)]],_0x324407=[_0x1c6721[_0x5599ed(0x159)]['batch_code']],_0x3cfb72=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1c0)]],_0x3af787=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0xf3)]],_0x2d8fed=[_0x1c6721[_0x5599ed(0x159)]['production_date']],_0x30669e=[_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1f5)]];else var _0x364305=[..._0x1c6721['body'][_0x5599ed(0x1d6)]],_0x5a13e0=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x20c)]],_0xd0ce0e=[..._0x1c6721[_0x5599ed(0x159)]['secondary_code']],_0x345190=[..._0x1c6721['body'][_0x5599ed(0x1bc)]],_0x6b698a=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x18d)]],_0xacc1bb=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1de)]],_0x113e8f=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x12f)]],_0x52baf8=[..._0x1c6721['body']['maxPerUnit']],_0x4ae72e=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x114)]],_0x324407=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x1fe)]],_0x3cfb72=[..._0x1c6721['body']['secondary_unit']],_0x3af787=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0xf3)]],_0x2d8fed=[..._0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x19d)]],_0x30669e=[..._0x1c6721[_0x5599ed(0x159)]['expiry_date']];const _0x12e025=_0x364305[_0x5599ed(0x132)](_0xda8238=>{return _0xda8238={'product_name':_0xda8238};});_0x5a13e0['forEach']((_0x120825,_0x3d45dc)=>{var _0x19420a=_0x5599ed;_0x12e025[_0x3d45dc][_0x19420a(0x20c)]=_0x120825;}),_0xd0ce0e[_0x5599ed(0x1e7)]((_0x5661ea,_0x1e18dc)=>{var _0x53c648=_0x5599ed;_0x12e025[_0x1e18dc][_0x53c648(0x178)]=_0x5661ea;}),_0x345190[_0x5599ed(0x1e7)]((_0x4fcb47,_0x443d75)=>{_0x12e025[_0x443d75]['product_code']=_0x4fcb47;}),_0x6b698a[_0x5599ed(0x1e7)]((_0x69b854,_0x12a727)=>{var _0x3c07df=_0x5599ed;_0x12e025[_0x12a727][_0x3c07df(0x16f)]=_0x69b854;}),_0xacc1bb[_0x5599ed(0x1e7)]((_0x5bced0,_0x3f38bc)=>{_0x12e025[_0x3f38bc]['return_qty']=_0x5bced0;}),_0x113e8f[_0x5599ed(0x1e7)]((_0x14cfdb,_0x3b6b54)=>{_0x12e025[_0x3b6b54]['bay']=_0x14cfdb;}),_0x52baf8[_0x5599ed(0x1e7)]((_0x14af5f,_0xaf8949)=>{var _0xcf4c54=_0x5599ed;_0x12e025[_0xaf8949][_0xcf4c54(0x139)]=_0x14af5f;}),_0x4ae72e['forEach']((_0x4c9096,_0x35d1f5)=>{var _0x2cbf80=_0x5599ed;_0x12e025[_0x35d1f5][_0x2cbf80(0x114)]=_0x4c9096;}),_0x324407['forEach']((_0x483648,_0x432eca)=>{_0x12e025[_0x432eca]['batch_code']=_0x483648;}),_0x3cfb72[_0x5599ed(0x1e7)]((_0x3cb119,_0x3e0a8b)=>{var _0x54ab9f=_0x5599ed;_0x12e025[_0x3e0a8b][_0x54ab9f(0x1c0)]=_0x3cb119;}),_0x3af787['forEach']((_0x13ea94,_0x3e4df1)=>{var _0x4b204c=_0x5599ed;_0x12e025[_0x3e4df1][_0x4b204c(0xf3)]=_0x13ea94;}),_0x2d8fed[_0x5599ed(0x1e7)]((_0x3c0be5,_0x203e7d)=>{var _0x112d3e=_0x5599ed;_0x12e025[_0x203e7d][_0x112d3e(0x19d)]=_0x3c0be5;}),_0x30669e[_0x5599ed(0x1e7)]((_0x287311,_0x5cf800)=>{var _0x3d94fb=_0x5599ed;_0x12e025[_0x5cf800][_0x3d94fb(0x1f5)]=_0x287311;});var _0x3fdb28=0x0;_0x12e025['forEach'](_0x3956d1=>{var _0x4f2e61=_0x5599ed;(parseInt(_0x3956d1['sale_qty'])<parseInt(_0x3956d1['return_qty'])||parseInt(_0x3956d1['stock'])<parseInt(_0x3956d1[_0x4f2e61(0x1de)])&&parseInt(_0x3956d1[_0x4f2e61(0x16f)])>parseInt(_0x3956d1[_0x4f2e61(0x1de)])||parseInt(_0x3956d1['return_qty'])==0x0)&&_0x3fdb28++;});if(_0x3fdb28!=0x0)return _0x1c6721[_0x5599ed(0x13f)]('errors','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x1c4217[_0x5599ed(0x153)](_0x5599ed(0x174));const _0x21c272=await sales_finished[_0x5599ed(0x14b)]({'invoice':_0x4678cf});_0x21c272[_0x5599ed(0x1b2)]=_0x5599ed(0x180);const _0x5d27b3=await _0x21c272[_0x5599ed(0x1a2)](),_0x5d53f6=new sales_return_finished({'invoice':_0x4678cf,'customer':_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x154)],'date':_0x221d03,'warehouse_name':_0x5256cf,'room':_0x46c793,'ToWarehouse':_0x13fbb0,'ToRoom':_0xba9f7c,'return_sale':_0x12e025,'note':_0x10de73,'warehouse_cat':_0x4e6af9}),_0x249859=await _0x5d53f6[_0x5599ed(0x1a2)](),_0x17e884=await sales_return_finished[_0x5599ed(0x14b)]({'invoice':_0x4678cf}),_0x594400=await warehouse[_0x5599ed(0x14b)]({'name':_0x13fbb0,'room':_0xba9f7c,'warehouse_category':'Finished\x20Goods'});_0x17e884[_0x5599ed(0x1aa)][_0x5599ed(0x1e7)](_0x20fe00=>{var _0x50b269=_0x5599ed,_0x1d5887=0x0;const _0x1a495f=_0x594400['product_details'][_0x50b269(0x132)](_0x4c0537=>{var _0x2b383e=_0x50b269;_0x4c0537[_0x2b383e(0x1d6)]==_0x20fe00[_0x2b383e(0x1d6)]&&_0x4c0537[_0x2b383e(0x12f)]==_0x20fe00[_0x2b383e(0x12f)]&&_0x4c0537[_0x2b383e(0x1f5)]==_0x20fe00[_0x2b383e(0x1f5)]&&_0x4c0537[_0x2b383e(0x19d)]==_0x20fe00[_0x2b383e(0x19d)]&&_0x4c0537['batch_code']==_0x20fe00['batch_code']&&(_0x4c0537[_0x2b383e(0x131)]=parseInt(_0x4c0537[_0x2b383e(0x131)])+parseInt(_0x20fe00[_0x2b383e(0x1de)]),_0x1d5887++);});_0x1d5887=='0'&&(_0x594400[_0x50b269(0x143)]=_0x594400[_0x50b269(0x143)]['concat']({'product_name':_0x20fe00[_0x50b269(0x1d6)],'product_stock':_0x20fe00[_0x50b269(0x1de)],'primary_code':_0x20fe00[_0x50b269(0x20c)],'secondary_code':_0x20fe00['secondary_code'],'product_code':_0x20fe00[_0x50b269(0x1bc)],'bay':_0x20fe00['bay'],'batch_code':_0x20fe00['batch_code'],'maxPerUnit':_0x20fe00[_0x50b269(0x139)],'production_date':_0x20fe00[_0x50b269(0x19d)],'expiry_date':_0x20fe00[_0x50b269(0x1f5)],'secondary_unit':_0x20fe00[_0x50b269(0x1c0)],'unit':_0x20fe00[_0x50b269(0xf3)],'maxProducts':_0x20fe00[_0x50b269(0x114)]}));}),await _0x594400[_0x5599ed(0x1a2)](),console[_0x5599ed(0x11b)](_0x1c6721[_0x5599ed(0x159)]);const _0x1147d5=new c_payment_data({'invoice':_0x4678cf,'customer':_0x1c6721['body'][_0x5599ed(0x154)],'reason':_0x5599ed(0xfd)});await _0x1147d5[_0x5599ed(0x1a2)]();const _0x3baf02=await master_shop[_0x5599ed(0x1b4)]();console['log']('add\x20post',_0x3baf02[0x0][_0x5599ed(0xe3)]);const _0x5e6342=await email_settings[_0x5599ed(0x14b)](),_0x22d7f1=await customer[_0x5599ed(0x14b)]({'name':_0x1c6721[_0x5599ed(0x159)][_0x5599ed(0x154)]});console[_0x5599ed(0x11b)](_0x5599ed(0x182),_0x22d7f1);_0x3baf02[0x0][_0x5599ed(0x1ab)]==0x1?(right_currency=_0x3baf02[0x0][_0x5599ed(0x11f)],left_currency=''):(right_currency='',left_currency=_0x3baf02[0x0][_0x5599ed(0x11f)]);var _0x3e6b5c=_0x364305,_0x166461=_0xacc1bb,_0x304136='',_0x523cbe;for(_0x523cbe in _0x3e6b5c){_0x304136+='<tr>'+_0x5599ed(0x20d)+_0x3e6b5c[_0x523cbe]+_0x5599ed(0x142)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x166461[_0x523cbe]+_0x5599ed(0x142)+_0x5599ed(0x1ed);}console[_0x5599ed(0x11b)]('product_list',_0x304136);let _0xe761e0=nodemailer['createTransport']({'service':'gmail','auth':{'user':_0x5e6342['email'],'pass':_0x5e6342[_0x5599ed(0x18c)]}}),_0x44f22f={'from':_0x5e6342[_0x5599ed(0x151)],'to':_0x22d7f1[_0x5599ed(0x151)],'subject':_0x5599ed(0x191),'attachments':[{'filename':'Logo.png','path':__dirname+_0x5599ed(0x188)+'/upload/'+_0x3baf02[0x0][_0x5599ed(0xe3)],'cid':_0x5599ed(0x1f9)}],'html':'<!DOCTYPE\x20html>'+_0x5599ed(0x177)+'</head><body>'+'<div>'+_0x5599ed(0x137)+'<div>'+_0x5599ed(0x1fb)+_0x5599ed(0x215)+_0x5599ed(0x1d0)+_0x5599ed(0x170)+_0x3baf02[0x0][_0x5599ed(0x12b)]+_0x5599ed(0x1c3)+_0x5599ed(0x215)+_0x5599ed(0x215)+_0x5599ed(0x105)+'<div>'+_0x5599ed(0x126)+_0x5599ed(0xe5)+_0x4678cf+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x5599ed(0x195)+_0x221d03+'\x20'+_0x5599ed(0x100)+_0x5599ed(0x212)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5599ed(0x217)+_0x5599ed(0x1f4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x5599ed(0x201)+_0x5599ed(0x147)+_0x5599ed(0x164)+_0x5599ed(0x1ed)+_0x5599ed(0x1c9)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x304136+'\x20'+_0x5599ed(0x1a4)+_0x5599ed(0x1e4)+_0x5599ed(0x1d0)+_0x5599ed(0xe0)+_0x5599ed(0xdc)+_0x3baf02[0x0]['site_title']+'</h5>'+_0x5599ed(0x215)+'</div>'+_0x5599ed(0x129)};_0xe761e0[_0x5599ed(0x149)](_0x44f22f,function(_0x2bcdaf,_0x48ed7a){var _0x3a0a6d=_0x5599ed;_0x2bcdaf?(console[_0x3a0a6d(0x11b)](_0x2bcdaf),console['log'](_0x3a0a6d(0x196))):console[_0x3a0a6d(0x11b)](_0x3a0a6d(0x194));}),_0x1c6721['flash'](_0x5599ed(0x128),_0x5599ed(0x1a8)),_0x1c4217[_0x5599ed(0x153)](_0x5599ed(0xd6));}catch(_0x45e2f4){console[_0x5599ed(0x11b)](_0x45e2f4),_0x1c4217['status'](0xc8)[_0x5599ed(0x121)]({'message1':_0x45e2f4[_0x5599ed(0x1f3)]});}}}),router['get'](a0_0x376c37(0x108),auth,async(_0x23260f,_0x4f6a35)=>{var _0x5c9c35=a0_0x376c37;try{const {username:_0x4a28f9,email:_0x380d5f,role:_0x378615}=_0x23260f[_0x5c9c35(0x135)],_0x2bc8c4=_0x23260f[_0x5c9c35(0x135)],_0x24d361=await profile[_0x5c9c35(0x14b)]({'email':_0x2bc8c4[_0x5c9c35(0x151)]}),_0x41189d=await master_shop['find']();console['log'](_0x5c9c35(0x1e9),_0x41189d);const _0x2e706f=_0x23260f[_0x5c9c35(0x112)]['id'],_0x5586cc=await sales['findById'](_0x2e706f);console['log'](_0x5c9c35(0x1fc),_0x5586cc);if(_0x41189d[0x0][_0x5c9c35(0x1ea)]==_0x5c9c35(0x17d))var _0x2d5281=users[_0x5c9c35(0x124)];else{if(_0x41189d[0x0][_0x5c9c35(0x1ea)]==_0x5c9c35(0x1dd))var _0x2d5281=users[_0x5c9c35(0x1dd)];else{if(_0x41189d[0x0][_0x5c9c35(0x1ea)]=='German')var _0x2d5281=users[_0x5c9c35(0x1ff)];else{if(_0x41189d[0x0][_0x5c9c35(0x1ea)]==_0x5c9c35(0x197))var _0x2d5281=users[_0x5c9c35(0x197)];else{if(_0x41189d[0x0][_0x5c9c35(0x1ea)]=='French')var _0x2d5281=users[_0x5c9c35(0x10f)];else{if(_0x41189d[0x0][_0x5c9c35(0x1ea)]==_0x5c9c35(0x101))var _0x2d5281=users[_0x5c9c35(0x219)];else{if(_0x41189d[0x0]['language']=='Chinese')var _0x2d5281=users[_0x5c9c35(0x192)];else{if(_0x41189d[0x0][_0x5c9c35(0x1ea)]==_0x5c9c35(0x1b3))var _0x2d5281=users[_0x5c9c35(0x1c5)];}}}}}}}_0x4f6a35[_0x5c9c35(0x11e)](_0x5c9c35(0x116),{'success':_0x23260f[_0x5c9c35(0x13f)]('success'),'errors':_0x23260f[_0x5c9c35(0x13f)](_0x5c9c35(0xd8)),'role':_0x2bc8c4,'profile':_0x24d361,'alldata':_0x5586cc,'master_shop':_0x41189d,'language':_0x2d5281});}catch(_0x1248fa){console['log'](_0x1248fa);}}),router[a0_0x376c37(0xd4)](a0_0x376c37(0x21b),async(_0x12a4a0,_0x22c8ad)=>{var _0x1b2bac=a0_0x376c37;const {product_code:_0x36e6df,warehouse_name:_0x5b507a,rooms_data:_0x62e38f,Roomslist:_0x2a1e18,sales_category:_0x3f4a56}=_0x12a4a0[_0x1b2bac(0x159)],_0x1af4e0=_0x2a1e18['split'](','),_0x4012ef=[];async function _0x5c8623(_0x5eef76){var _0x2d570c=_0x1b2bac;const _0x1b01c5=await warehouse[_0x2d570c(0x15c)]([{'$match':{'name':_0x5b507a,'room':_0x5eef76}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x36e6df}},{'$group':{'_id':_0x2d570c(0x1be),'name':{'$first':_0x2d570c(0x1e1)},'product_stock':{'$first':_0x2d570c(0x21a)},'primary_code':{'$first':_0x2d570c(0x133)},'secondary_code':{'$first':_0x2d570c(0x216)},'product_code':{'$first':_0x2d570c(0x14f)},'level':{'$first':_0x2d570c(0x104)},'bay':{'$first':_0x2d570c(0x20a)},'type':{'$first':_0x2d570c(0x1bb)},'pallet':{'$first':_0x2d570c(0x163)},'unit':{'$first':_0x2d570c(0x179)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x2d570c(0x1ca)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2d570c(0x1a5)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x2d570c(0x10b)},'batch_code':{'$first':_0x2d570c(0xfe)},'product_cat':{'$first':_0x2d570c(0x10a)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2d570c(0x18a)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x2d570c(0x168)},'gross_price':{'$first':_0x2d570c(0x20f)},'sales_category':{'$first':'$product_details.sales_category'}}}]),_0x3970f0=await warehouse[_0x2d570c(0x15c)]([{'$match':{'name':_0x5b507a,'room':_0x5eef76}},{'$unwind':_0x2d570c(0xe6)},{'$match':{'product_details.secondary_code':_0x36e6df}},{'$group':{'_id':_0x2d570c(0x1be),'name':{'$first':_0x2d570c(0x1e1)},'product_stock':{'$first':_0x2d570c(0x21a)},'primary_code':{'$first':_0x2d570c(0x133)},'secondary_code':{'$first':_0x2d570c(0x216)},'product_code':{'$first':_0x2d570c(0x14f)},'level':{'$first':_0x2d570c(0x20a)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x2d570c(0x1bb)},'pallet':{'$first':_0x2d570c(0x163)},'unit':{'$first':_0x2d570c(0x179)},'secondary_unit':{'$first':_0x2d570c(0x1d5)},'storage':{'$first':_0x2d570c(0x1ca)},'rack':{'$first':_0x2d570c(0x1cb)},'expiry_date':{'$first':_0x2d570c(0x1a5)},'production_date':{'$first':_0x2d570c(0xdf)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x2d570c(0x10a)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x2d570c(0x125)},'uuid':{'$first':_0x2d570c(0x168)},'gross_price':{'$first':_0x2d570c(0x20f)},'sales_category':{'$first':_0x2d570c(0x1c4)}}}]);if(_0x1b01c5[_0x2d570c(0x1ad)]>0x0)_0x4012ef[_0x2d570c(0x134)](_0x1b01c5);else _0x3970f0[_0x2d570c(0x1ad)]>0x0&&_0x4012ef['push'](_0x3970f0);}const _0x2bcb5c=_0x1af4e0[_0x1b2bac(0x132)](_0x325848=>_0x5c8623(_0x325848));await Promise[_0x1b2bac(0x10c)](_0x2bcb5c),_0x22c8ad['json'](_0x4012ef);}),router['post'](a0_0x376c37(0xeb),async(_0x5e8421,_0x445e3c)=>{var _0x443c80=a0_0x376c37;const {product_code:_0x5a123d,warehouse_name:_0x4f0d2a,rooms_data:_0x3e8b31,Roomslist:_0x2f8027,sales_category:_0x326d77}=_0x5e8421['body'],_0x595fb2=_0x2f8027[_0x443c80(0x1b9)](','),_0x2295fa=[];async function _0x31846d(_0x187279){var _0x1f7622=_0x443c80;const _0x3823ca=await warehouse['aggregate']([{'$match':{'name':_0x4f0d2a,'room':_0x187279}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5a123d,'product_details.sales_category':_0x326d77,'product_details.type_products':_0x1f7622(0x11b)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1f7622(0x1e1)},'product_stock':{'$first':_0x1f7622(0x21a)},'primary_code':{'$first':_0x1f7622(0x133)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1f7622(0x14f)},'level':{'$first':_0x1f7622(0x104)},'bay':{'$first':_0x1f7622(0x20a)},'type':{'$first':_0x1f7622(0x1bb)},'pallet':{'$first':_0x1f7622(0x163)},'unit':{'$first':_0x1f7622(0x179)},'secondary_unit':{'$first':_0x1f7622(0x1d5)},'storage':{'$first':_0x1f7622(0x1ca)},'rack':{'$first':_0x1f7622(0x1cb)},'expiry_date':{'$first':_0x1f7622(0x1a5)},'production_date':{'$first':_0x1f7622(0xdf)},'maxPerUnit':{'$first':_0x1f7622(0x10b)},'batch_code':{'$first':_0x1f7622(0xfe)},'product_cat':{'$first':_0x1f7622(0x10a)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1f7622(0x18a)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x1f7622(0x168)},'gross_price':{'$first':_0x1f7622(0x20f)},'sales_category':{'$first':_0x1f7622(0x1c4)},'type_products':{'$first':'$product_details.type_products'}}}]);console[_0x1f7622(0x11b)]('log'+_0x1f7622(0x1ae)+_0x5a123d+'\x20<>\x20'+_0x326d77);const _0x4fb91b=await warehouse[_0x1f7622(0x15c)]([{'$match':{'name':_0x4f0d2a,'room':_0x187279}},{'$unwind':_0x1f7622(0xe6)},{'$match':{'product_details.secondary_code':_0x5a123d,'product_details.sales_category':_0x326d77,'product_details.type_products':_0x1f7622(0x11b)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1f7622(0x21a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1f7622(0x216)},'product_code':{'$first':_0x1f7622(0x14f)},'level':{'$first':_0x1f7622(0x20a)},'isle':{'$first':_0x1f7622(0x13c)},'type':{'$first':_0x1f7622(0x1bb)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1f7622(0x179)},'secondary_unit':{'$first':_0x1f7622(0x1d5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1f7622(0x1cb)},'expiry_date':{'$first':_0x1f7622(0x1a5)},'production_date':{'$first':_0x1f7622(0xdf)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x1f7622(0xfe)},'product_cat':{'$first':_0x1f7622(0x10a)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1f7622(0x18a)},'invoice':{'$first':_0x1f7622(0x125)},'uuid':{'$first':_0x1f7622(0x168)},'gross_price':{'$first':_0x1f7622(0x20f)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':_0x1f7622(0x17f)}}}]);if(_0x3823ca[_0x1f7622(0x1ad)]>0x0)_0x2295fa[_0x1f7622(0x134)](_0x3823ca);else _0x4fb91b[_0x1f7622(0x1ad)]>0x0&&_0x2295fa['push'](_0x4fb91b);}const _0xe192a2=_0x595fb2[_0x443c80(0x132)](_0x4c0a4f=>_0x31846d(_0x4c0a4f));await Promise[_0x443c80(0x10c)](_0xe192a2),_0x445e3c[_0x443c80(0x121)](_0x2295fa);}),router[a0_0x376c37(0xd4)]('/barcode_scanner_auto_data',async(_0x10dd68,_0xa605e2)=>{var _0x1f6ac2=a0_0x376c37;try{const {prduct_code:_0x1fca46,warehouse_data:_0x431edb,qty_req:_0x580583}=_0x10dd68[_0x1f6ac2(0x159)];let _0x32c468=_0x1fca46['split']('~'),_0x4735bf=_0x580583['split']('~'),_0x543cc8=[],_0x16649e=0x0;for(let _0xc8eb02=0x0;_0xc8eb02<=_0x32c468[_0x1f6ac2(0x1ad)]-0x1;_0xc8eb02++){const _0x1a10d4=_0x32c468[_0xc8eb02],_0x52d76e=_0x4735bf[_0xc8eb02],_0x13fa76=await warehouse[_0x1f6ac2(0x15c)]([{'$match':{'name':_0x431edb}},{'$unwind':_0x1f6ac2(0xe6)},{'$match':{'product_details.product_code':_0x1a10d4,'product_details.isAvailable':_0x1f6ac2(0x19e),'product_details.isUsed':_0x1f6ac2(0x1cf)}},{'$sort':{'product_details.date_received':0x1,'product_details.level':-0x1,'product_details.bay':-0x1}},{'$group':{'_id':_0x1f6ac2(0x1be),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1f6ac2(0x21a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1f6ac2(0x14f)},'level':{'$first':_0x1f6ac2(0x104)},'bay':{'$first':_0x1f6ac2(0x20a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1f6ac2(0x163)},'unit':{'$first':_0x1f6ac2(0x179)},'secondary_unit':{'$first':_0x1f6ac2(0x1d5)},'storage':{'$first':_0x1f6ac2(0x1ca)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x1f6ac2(0xfe)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x1f6ac2(0x125)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x1f6ac2(0x20f)},'sales_category':{'$first':_0x1f6ac2(0x1c4)},'date_received':{'$first':'$product_details.date_recieved'},'warehouse_id':{'$first':_0x1f6ac2(0xea)}}}]),_0x1e0399=_0x13fa76['sort']((_0x39b9cd,_0x24a3ea)=>new Date(_0x39b9cd[_0x1f6ac2(0xdd)])-new Date(_0x24a3ea[_0x1f6ac2(0xdd)]));let _0x1150c4=_0x52d76e;for(let _0x5ef944=0x0;_0x5ef944<=_0x1e0399[_0x1f6ac2(0x1ad)]-0x1&&_0x1150c4>0x0;_0x5ef944++){const _0x5b73ce=_0x1e0399[_0x5ef944];if(_0x5b73ce[_0x1f6ac2(0x1bc)]==_0x1a10d4){_0x543cc8[_0x16649e]={};const _0x11bb2d=parseInt(_0x5b73ce[_0x1f6ac2(0x131)]),_0x3a524d=0x0;let _0x14013f=_0x11bb2d-_0x3a524d,_0xf966e7=Math[_0x1f6ac2(0x202)](_0x1150c4,_0x14013f);console[_0x1f6ac2(0x11b)]('Distributing\x20'+_0xf966e7+_0x1f6ac2(0xef)+_0x431edb+',\x20room:\x20'+_0x5b73ce[_0x1f6ac2(0x19b)]+_0x1f6ac2(0x15d)+(_0x5b73ce[_0x1f6ac2(0xd2)]+_0x5b73ce[_0x1f6ac2(0x12f)])+_0x1f6ac2(0xf1)+_0x5b73ce[_0x1f6ac2(0xdd)]+_0x1f6ac2(0x1f0)+_0x5b73ce[_0x1f6ac2(0x1f6)]),_0x543cc8[_0x16649e][_0x1f6ac2(0xde)]=_0x5b73ce[_0x1f6ac2(0x187)]+'~'+_0x5b73ce[_0x1f6ac2(0x15f)]+'~'+_0xf966e7,_0x543cc8[_0x16649e][_0x1f6ac2(0x1d6)]=_0x5b73ce[_0x1f6ac2(0x1f6)],_0x543cc8[_0x16649e][_0x1f6ac2(0x1bc)]=_0x5b73ce[_0x1f6ac2(0x1bc)],_0x543cc8[_0x16649e][_0x1f6ac2(0x1e0)]=_0x5b73ce[_0x1f6ac2(0x1e0)],_0x543cc8[_0x16649e]['date_recieved']=_0x5b73ce['date_recieved'],_0x543cc8[_0x16649e][_0x1f6ac2(0x120)]=_0x5b73ce[_0x1f6ac2(0x120)],_0x543cc8[_0x16649e][_0x1f6ac2(0x146)]=_0x5b73ce[_0x1f6ac2(0x146)],_0x543cc8[_0x16649e][_0x1f6ac2(0xfb)]=_0xf966e7,_0x543cc8[_0x16649e]['unit']=_0x5b73ce[_0x1f6ac2(0xf3)],_0x543cc8[_0x16649e]['secondary_unit']=_0x5b73ce[_0x1f6ac2(0x1c0)],_0x543cc8[_0x16649e][_0x1f6ac2(0x20c)]=_0x5b73ce[_0x1f6ac2(0x20c)],_0x543cc8[_0x16649e][_0x1f6ac2(0x178)]=_0x5b73ce['secondary_code'],_0x543cc8[_0x16649e][_0x1f6ac2(0x1d2)]=_0x5b73ce['maxStocks'],_0x543cc8[_0x16649e][_0x1f6ac2(0x1fe)]=_0x5b73ce[_0x1f6ac2(0x1fe)],_0x543cc8[_0x16649e][_0x1f6ac2(0x1f5)]=_0x5b73ce[_0x1f6ac2(0x1f5)],_0x543cc8[_0x16649e]['production_date']=_0x5b73ce[_0x1f6ac2(0x19d)],_0x543cc8[_0x16649e]['maxperunit']=_0x5b73ce['maxperunit'],_0x543cc8[_0x16649e][_0x1f6ac2(0x1b1)]=_0x5b73ce[_0x1f6ac2(0x1b1)],_0x543cc8[_0x16649e][_0x1f6ac2(0x1c2)]=_0x5b73ce[_0x1f6ac2(0x1c2)],_0x543cc8[_0x16649e]['gross_price']=_0x5b73ce[_0x1f6ac2(0xed)],_0x543cc8[_0x16649e][_0x1f6ac2(0x158)]=_0x5b73ce[_0x1f6ac2(0x19b)],_0x543cc8[_0x16649e]['level']=_0x5b73ce[_0x1f6ac2(0xd2)],_0x543cc8[_0x16649e]['bay']=_0x5b73ce['bay'],_0x543cc8[_0x16649e][_0x1f6ac2(0x1f7)]=_0x1f6ac2(0x19e),console[_0x1f6ac2(0x11b)]('1',_0x16649e),_0x1150c4-=_0xf966e7,_0x16649e++;if(_0x1150c4<=0x0)break;}}if(_0x1150c4>0x0){var _0x355734=await product['findOne']({'product_code':_0x1a10d4});console[_0x1f6ac2(0x11b)]('2',_0x16649e),_0x543cc8[_0x16649e]={},_0x543cc8[_0x16649e][_0x1f6ac2(0x1d6)]=_0x355734[_0x1f6ac2(0x1f6)],_0x543cc8[_0x16649e]['product_code']=_0x1a10d4,_0x543cc8[_0x16649e][_0x1f6ac2(0x1e0)]=_0x355734['_id'][_0x1f6ac2(0x203)](),_0x543cc8[_0x16649e][_0x1f6ac2(0xfb)]=_0x1150c4,_0x543cc8[_0x16649e][_0x1f6ac2(0xf4)]=_0x355734[_0x1f6ac2(0xf3)],_0x543cc8[_0x16649e][_0x1f6ac2(0x1c0)]=_0x355734['second_unit'],_0x543cc8[_0x16649e][_0x1f6ac2(0x20c)]=_0x355734[_0x1f6ac2(0x20c)],_0x543cc8[_0x16649e][_0x1f6ac2(0x178)]=_0x355734['secondary_code'],_0x543cc8[_0x16649e][_0x1f6ac2(0x1d2)]=_0x355734[_0x1f6ac2(0x1d2)],_0x543cc8[_0x16649e][_0x1f6ac2(0x1ec)]=_0x355734[_0x1f6ac2(0x110)],_0x543cc8[_0x16649e][_0x1f6ac2(0xed)]=_0x355734[_0x1f6ac2(0xed)],_0x543cc8[_0x16649e][_0x1f6ac2(0x1f7)]=_0x1f6ac2(0x1cf),console[_0x1f6ac2(0x11b)](_0x1f6ac2(0xe2)+_0x1150c4+'\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20'+_0x16649e+_0x1f6ac2(0x1ae)+_0x1a10d4),_0x16649e++;}}_0xa605e2[_0x1f6ac2(0x121)](_0x543cc8);}catch(_0x4b34b7){console[_0x1f6ac2(0x11b)](_0x4b34b7);}}),router[a0_0x376c37(0xd4)](a0_0x376c37(0x1da),async(_0x375e2b,_0x58842d)=>{var _0x327e3e=a0_0x376c37;const {product_code:_0x4010f8}=_0x375e2b[_0x327e3e(0x159)];var _0x200361;const _0x440434=await product['aggregate']([{'$match':{'primary_code':_0x4010f8}},{'$group':{'_id':_0x327e3e(0xea),'name':{'$first':_0x327e3e(0x145)},'category':{'$first':'$category'},'brand':{'$first':_0x327e3e(0xf6)},'unit':{'$first':_0x327e3e(0x156)},'alertquantity':{'$first':_0x327e3e(0x1e3)},'product_code':{'$first':_0x327e3e(0x138)},'primary_code':{'$first':_0x327e3e(0x204)},'secondary_code':{'$first':_0x327e3e(0x150)},'maxStocks':{'$first':_0x327e3e(0x1ac)},'maxProdPerUnit':{'$first':_0x327e3e(0x16d)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x327e3e(0x213)},'gross_price':{'$first':'$gross_price'},'sales_category':{'$first':_0x327e3e(0x12c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x5b8f45=await product['aggregate']([{'$match':{'secondary_code':_0x4010f8}},{'$group':{'_id':_0x327e3e(0xea),'name':{'$first':_0x327e3e(0x145)},'category':{'$first':_0x327e3e(0x1e2)},'brand':{'$first':_0x327e3e(0xf6)},'unit':{'$first':_0x327e3e(0x156)},'alertquantity':{'$first':_0x327e3e(0x1e3)},'product_code':{'$first':_0x327e3e(0x138)},'primary_code':{'$first':_0x327e3e(0x204)},'secondary_code':{'$first':_0x327e3e(0x150)},'maxStocks':{'$first':_0x327e3e(0x1ac)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x327e3e(0x213)},'gross_price':{'$first':_0x327e3e(0x1fd)},'sales_category':{'$first':_0x327e3e(0x12c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x440434['length']>0x0)_0x200361=_0x440434;else _0x5b8f45[_0x327e3e(0x1ad)]>0x0&&(_0x200361=_0x5b8f45);_0x58842d[_0x327e3e(0x121)](_0x200361);}),router[a0_0x376c37(0xd4)](a0_0x376c37(0x141),async(_0x28df95,_0x45293d)=>{var _0x1cec9f=a0_0x376c37;try{const {group_id:_0x21c6ab,DRSI:_0x4b7ccc,dateofreq:_0x397d26,PO_number:_0xa408ac,date:_0x42416d,warehouse_name:_0x32b041,typevehicle:_0x44e587,deliverydate:_0x32b05d,driver:_0x47cba6,plate:_0x5b3adf,van:_0x115271,TSU:_0x6e6666,actual_delivery_date:_0x444f6b,TFU:_0x44621f,pull_out_date:_0x38139a,sales:_0x4e2241,Customer_data:_0x2381b4,note:_0x52d590}=_0x28df95[_0x1cec9f(0x159)],_0x41fc5b=mongoose['Types'][_0x1cec9f(0x144)];let _0x474d84=[];const _0x14e9b0=new invoice_for_outgoing();await _0x14e9b0['save']();const _0x58dcdf='OUT-'+_0x14e9b0['invoice_init'][_0x1cec9f(0x123)]()[_0x1cec9f(0xd0)](0x8,'0');if(typeof _0x21c6ab==_0x1cec9f(0x14e)){let _0x824124=_0x21c6ab[_0x1cec9f(0x1b9)]('~');var _0x224a28=_0x41fc5b(_0x824124[0x0]),_0x5c91b1=_0x41fc5b(_0x824124[0x1]),_0x58223c=_0x824124[0x2];let _0x334a16=0x0;const _0x25c780=await warehouse['aggregate']([{'$match':{'_id':_0x224a28}},{'$unwind':_0x1cec9f(0xe6)},{'$match':{'product_details._id':_0x5c91b1}}]);await warehouse[_0x1cec9f(0x1d7)]({'_id':_0x41fc5b(_0x224a28),'product_details._id':_0x41fc5b(_0x5c91b1)},{'$set':{'product_details.$.isUsed':'true'}}),_0x474d84[_0x334a16]={};for(let _0x4103f1=0x0;_0x4103f1<=_0x25c780[_0x1cec9f(0x1ad)]-0x1;_0x4103f1++){const _0x455ddb=_0x25c780[_0x4103f1];console['log'](_0x455ddb),_0x474d84[_0x334a16][_0x1cec9f(0x1f1)]=_0x455ddb[_0x1cec9f(0x1f6)],_0x474d84[_0x334a16][_0x1cec9f(0x1e0)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x1e0)],_0x474d84[_0x334a16]['product_name']=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x1d6)],_0x474d84[_0x334a16][_0x1cec9f(0x1bc)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x1bc)],_0x474d84[_0x334a16]['product_stock']=_0x58223c,_0x474d84[_0x334a16]['quantity']=_0x58223c,_0x474d84[_0x334a16]['unit']=_0x455ddb['product_details'][_0x1cec9f(0xf3)],_0x474d84[_0x334a16]['secondary_unit']=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x1c0)],_0x474d84[_0x334a16]['level']=_0x455ddb[_0x1cec9f(0x143)]['level'],_0x474d84[_0x334a16][_0x1cec9f(0x12f)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x12f)],_0x474d84[_0x334a16]['primary_code']=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x20c)],_0x474d84[_0x334a16][_0x1cec9f(0x178)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x178)],_0x474d84[_0x334a16][_0x1cec9f(0x1d2)]=_0x455ddb['product_details'][_0x1cec9f(0x1d2)],_0x474d84[_0x334a16][_0x1cec9f(0x1fe)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x1fe)],_0x474d84[_0x334a16][_0x1cec9f(0x1f5)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x1f5)],_0x474d84[_0x334a16][_0x1cec9f(0x19d)]=_0x455ddb['product_details']['production_date'],_0x474d84[_0x334a16][_0x1cec9f(0x1ec)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x1ec)],_0x474d84[_0x334a16]['product_cat']=_0x455ddb['product_details'][_0x1cec9f(0x1b1)],_0x474d84[_0x334a16][_0x1cec9f(0x158)]=_0x455ddb['room'],_0x474d84[_0x334a16][_0x1cec9f(0x1c2)]=_0x455ddb[_0x1cec9f(0x143)]['invoice'],_0x474d84[_0x334a16][_0x1cec9f(0x146)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x146)],_0x474d84[_0x334a16][_0x1cec9f(0xed)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0xed)],_0x474d84[_0x334a16][_0x1cec9f(0x120)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x162)],_0x474d84[_0x334a16][_0x1cec9f(0x1ef)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x1ef)],_0x474d84[_0x334a16]['sales_id']=_0x455ddb['product_details'][_0x1cec9f(0x162)],_0x474d84[_0x334a16]['warehouse_id']=_0x455ddb['_id'][_0x1cec9f(0x203)](),_0x474d84[_0x334a16][_0x1cec9f(0x11c)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x15f)][_0x1cec9f(0x203)](),_0x474d84[_0x334a16][_0x1cec9f(0x190)]=_0x1cec9f(0xd1),_0x474d84[_0x334a16][_0x1cec9f(0x140)]=_0x455ddb[_0x1cec9f(0x143)][_0x1cec9f(0x162)];}_0x474d84[_0x334a16]['outgoiug_inv']=_0x58dcdf;}else for(let _0x37fe33=0x0;_0x37fe33<=_0x21c6ab[_0x1cec9f(0x1ad)]-0x1;_0x37fe33++){const _0x1b3922=_0x21c6ab[_0x37fe33];let _0x3f4629=_0x1b3922[_0x1cec9f(0x1b9)]('~');console[_0x1cec9f(0x11b)](_0x3f4629);var _0x224a28=_0x41fc5b(_0x3f4629[0x0]),_0x5c91b1=_0x41fc5b(_0x3f4629[0x1]),_0x58223c=_0x3f4629[0x2];const _0xb1f786=await warehouse[_0x1cec9f(0x15c)]([{'$match':{'_id':_0x224a28}},{'$unwind':_0x1cec9f(0xe6)},{'$match':{'product_details._id':_0x5c91b1}}]);await warehouse[_0x1cec9f(0x1d7)]({'_id':_0x41fc5b(_0x224a28),'product_details._id':_0x41fc5b(_0x5c91b1)},{'$set':{'product_details.$.isUsed':_0x1cec9f(0x19e)}}),_0x474d84[_0x37fe33]={};for(let _0x550db1=0x0;_0x550db1<=_0xb1f786[_0x1cec9f(0x1ad)]-0x1;_0x550db1++){const _0x26cd72=_0xb1f786[_0x550db1];_0x474d84[_0x37fe33]['warehouse']=_0x26cd72[_0x1cec9f(0x1f6)],_0x474d84[_0x37fe33][_0x1cec9f(0x1e0)]=_0x26cd72['product_details'][_0x1cec9f(0x1e0)],_0x474d84[_0x37fe33][_0x1cec9f(0x1d6)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x1d6)],_0x474d84[_0x37fe33][_0x1cec9f(0x1bc)]=_0x26cd72['product_details'][_0x1cec9f(0x1bc)],_0x474d84[_0x37fe33][_0x1cec9f(0x131)]=_0x58223c,_0x474d84[_0x37fe33][_0x1cec9f(0xfb)]=_0x58223c,_0x474d84[_0x37fe33][_0x1cec9f(0xf3)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0xf3)],_0x474d84[_0x37fe33][_0x1cec9f(0x1c0)]=_0x26cd72['product_details']['secondary_unit'],_0x474d84[_0x37fe33][_0x1cec9f(0xd2)]=_0x26cd72[_0x1cec9f(0x143)]['level'],_0x474d84[_0x37fe33][_0x1cec9f(0x12f)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x12f)],_0x474d84[_0x37fe33][_0x1cec9f(0x20c)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x20c)],_0x474d84[_0x37fe33][_0x1cec9f(0x178)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x178)],_0x474d84[_0x37fe33]['maxStocks']=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x1d2)],_0x474d84[_0x37fe33][_0x1cec9f(0x1fe)]=_0x26cd72['product_details']['batch_code'],_0x474d84[_0x37fe33]['expiry_date']=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x1f5)],_0x474d84[_0x37fe33][_0x1cec9f(0x19d)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x19d)],_0x474d84[_0x37fe33][_0x1cec9f(0x1ec)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x1ec)],_0x474d84[_0x37fe33][_0x1cec9f(0x1b1)]=_0x26cd72['product_details'][_0x1cec9f(0x1b1)],_0x474d84[_0x37fe33]['room_name']=_0x26cd72[_0x1cec9f(0xf0)],_0x474d84[_0x37fe33]['invoice']=_0x26cd72[_0x1cec9f(0x143)]['invoice'],_0x474d84[_0x37fe33]['uuid']=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x146)],_0x474d84[_0x37fe33]['gross_price']=_0x26cd72[_0x1cec9f(0x143)]['gross_price'],_0x474d84[_0x37fe33][_0x1cec9f(0x120)]=_0x26cd72[_0x1cec9f(0x143)]['sales'],_0x474d84[_0x37fe33][_0x1cec9f(0x1ef)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x1ef)],_0x474d84[_0x37fe33][_0x1cec9f(0x1e6)]=_0x26cd72['product_details'][_0x1cec9f(0x162)],_0x474d84[_0x37fe33][_0x1cec9f(0x187)]=_0x26cd72[_0x1cec9f(0x15f)][_0x1cec9f(0x203)](),_0x474d84[_0x37fe33]['warehouse_id_detl']=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x15f)][_0x1cec9f(0x203)](),_0x474d84[_0x37fe33][_0x1cec9f(0x190)]='out',_0x474d84[_0x37fe33][_0x1cec9f(0x140)]=_0x26cd72[_0x1cec9f(0x143)][_0x1cec9f(0x162)];}_0x474d84[_0x37fe33][_0x1cec9f(0x218)]=_0x58dcdf;}for(let _0x860658=0x0;_0x860658<=_0x474d84[_0x1cec9f(0x1ad)]-0x1;_0x860658++){const _0x20ea2e=_0x474d84[_0x860658],_0x2a88a7=new warehouse_temporary(_0x20ea2e);await _0x2a88a7[_0x1cec9f(0x1a2)]();}const _0x4fae12=new sales_finished({'invoice':_0x58dcdf,'sales_data':_0x4e2241,'customer':_0x2381b4,'date':_0x42416d,'warehouse_name':_0x32b041,'sale_product':_0x474d84,'note':_0x52d590,'finalize':_0x1cec9f(0x103),'dateofreq':_0x397d26,'PO_number':_0xa408ac,'typevehicle':_0x44e587,'deliverydate':_0x32b05d,'driver':_0x47cba6,'plate':_0x5b3adf,'van':_0x115271,'DRSI':_0x4b7ccc,'TSU':_0x6e6666,'TFU':_0x44621f,'pullout_date':_0x38139a,'actualdelivery_date':_0x444f6b,'typeOfProducts':_0x1cec9f(0xf5)}),_0x392dd4=await _0x4fae12[_0x1cec9f(0x1a2)]();_0x28df95[_0x1cec9f(0x13f)]('success','Sales\x20Add\x20successfully'),_0x45293d['redirect']('/all_sales_finished/preview/'+_0x392dd4[_0x1cec9f(0x15f)]);}catch(_0x58e12d){console[_0x1cec9f(0x11b)](_0x58e12d);}}),module[a0_0x376c37(0xe9)]=router;function a0_0x2ac6(){var _0x563ad9=['stocks_QA','roomNamed','filter','production_date','true','sales_invoice','7624500SjLxMw','createTransport','save','<span\x20style=\x22float:\x20right;\x22>','</tbody>','$product_details.expiry_date','staff','<tbody\x20style=\x22text-align:\x20center;\x22>','sales\x20item\x20return\x20successfull','foreach\x20newproduct','return_sale','currency_placement','$maxStocks','length','\x20<>\x20','product_list','$customers_docs','product_cat','return_data','Arabic\x20(ae)','find','return_qty_QA','$return_data','../public/language/languages.json','$sale_product.bin','split','Sales\x20Add\x20successfully','$product_details.type','product_code','outgoing_invoice','$product_details._id','unit_QA','secondary_unit','Quality\x20Inspection','invoice','\x20</h2>','$product_details.sales_category','Arabic','prod_code','get','/view/add_sale/product','</thead>','$product_details.storage','$product_details.rack','$invoice','edit_sales_finished','/view/:id','false','<div>','$date','maxStocks','received_amount','OUTF-','$product_details.secondary_unit','product_name','updateOne','expiry_date_QA','795295TbzNNB','/barcode_scanner_auto','Ambient','level2','Hindi','return_qty','Sales\x20Update\x20successfully','product_id','$product_details.product_name','$category','$alertquantity','</table>','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','sales_id','forEach','max_per_unit','barcode\x20Product\x20master','language','3954090BloAIt','maxperunit','</tr>','return_sale_QA','date_recieved','\x20Name:\x20','warehouse','LOG-OUT-','message','<tr>','expiry_date','name','status','$finalize','logo','Finished\x20Goods','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','barcode\x20user_id','$gross_price','batch_code','German','purchases_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','min','valueOf','$primary_code','primary_code_QA','maxPerUnit_QA','$warehouse_name','16uFnmMr','finalize','$product_details.bay','$product.product_name','primary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','all_sales_finished_logs','$product_details.gross_price','product_code_QA','</head><body>','</h5>','$secondary_unit','/picking_list/pdf/','</div>','$product_details.secondary_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','outgoiug_inv','Portuguese','$product_details.product_stock','/barcode_scanner','padStart','out','level','abs','post','/view/add_sales','/all_sales_finished/view','secondary_unit_QA','errors','19814GoLGVO','date','catch','<h5>','date_received','group_ids','$product_details.production_date','<strong>\x20Regards\x20</strong>','/upload/','There\x20is\x20','image','return_sale_finished','\x20Order\x20Number\x20:\x20','$product_details','Return\x20Goods','logs','exports','$_id','/barcode_scanner_logs','floor','gross_price','$product_details.maxProducts','\x20units\x20to\x20warehouse:\x20','room','\x20Date:\x20','<table\x20style=\x22width:\x20100%\x20!important;\x22>','unit','standard_unit','own','$brand','product_date','$sale_product.type','getDate','4229816KGRYJk','quantity','amount','Sale\x20Return','$product_details.batch_code','getFullYear','</span>','Portuguese\x20(BR)','nodemailer','False','$product_details.level','<hr\x20class=\x22my-3\x22>','date_data','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/barcode/:id','all_sales_finished','$product_details.product_cat','$product_details.maxPerUnit','all','$sale_product.quantity','prod_cat','French','maxProdPerUnit','OUT-','params','production_date_QA','maxProducts','concat','all_sales_barcode','18NJnDQf','here','/all_sales_finished/preview/','Router','log','warehouse_id_detl','stock_data','render','currency','sales_category','json','Received\x20Payment\x20For\x20Sale','toString','English','$product_details.invoice','<h5\x20style=\x22text-align:\x20left;\x22>','$note','success','</body></html>','prod_invoice','site_title','$sales_category','/view','invoice_init','bay','../models/all_models','product_stock','map','$product_details.primary_code','push','user','423111fwaJoF','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_code','maxPerUnit','edit_sales_finished_view','batch_code_QA','$product_details.bin','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','maxProducts_QA','flash','agent_id','/process/view','</td>','product_details','ObjectId','$name','uuid','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','for_categorize','sendMail','warehouse_name','findOne','/all_sales/view','$sale_product.floorlevel','string','$product_details.product_code','$secondary_code','email','suppliers','redirect','customer','/view/return_sales/:id','$unit','gmail','room_name','body','carton','$product_details.room_name','aggregate',',\x20Location:\x20','/preview/:id','_id','adjust_qty','4438910cgtuoK','sales','$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','primary_unit','master','sales_quantity_QA','$product_details.uuid','79rdpVzI','$customer','add_sales_finished','stock','$maxProdPerUnit','match','sale_qty','<h2>\x20','RoomAssigned','due_amount','Enclosed','back','id_transaction_from','product_data','<html><head><title></title>','secondary_code','$product_details.unit','role','max','product_name_QA1','English\x20(US)','then','$product_details.type_products','True','\x20&&\x20','customer_data','findById','$sale_product.bay','Enabled','\x20==\x20','warehouse_id','/../public','product','$room','secondary_code_QA','password','sales_quantity','$sale_product','sale_product','data_type','Sale\x20Return\x20Mail','Chinese','payment\x20successfull','Email\x20sent\x20successfully','\x20Order\x20Date\x20:\x20','Error\x20Occurs','Spanish','note','slice'];a0_0x2ac6=function(){return _0x563ad9;};return a0_0x2ac6();}