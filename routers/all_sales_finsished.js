var a0_0x3524eb=a0_0x39a4;function a0_0x39a4(_0x518694,_0x2ed0df){var _0x4a250f=a0_0x4a25();return a0_0x39a4=function(_0x39a4c9,_0x2deba2){_0x39a4c9=_0x39a4c9-0x18a;var _0x5602ea=_0x4a250f[_0x39a4c9];return _0x5602ea;},a0_0x39a4(_0x518694,_0x2ed0df);}(function(_0x1dd3e4,_0x11c2f3){var _0x43865e=a0_0x39a4,_0x350081=_0x1dd3e4();while(!![]){try{var _0x3c8dd3=parseInt(_0x43865e(0x213))/0x1+-parseInt(_0x43865e(0x1af))/0x2*(-parseInt(_0x43865e(0x26c))/0x3)+-parseInt(_0x43865e(0x27c))/0x4*(-parseInt(_0x43865e(0x242))/0x5)+-parseInt(_0x43865e(0x27f))/0x6+parseInt(_0x43865e(0x1b5))/0x7*(-parseInt(_0x43865e(0x255))/0x8)+-parseInt(_0x43865e(0x19b))/0x9*(parseInt(_0x43865e(0x18d))/0xa)+parseInt(_0x43865e(0x1b6))/0xb*(parseInt(_0x43865e(0x2a0))/0xc);if(_0x3c8dd3===_0x11c2f3)break;else _0x350081['push'](_0x350081['shift']());}catch(_0x4cfac1){_0x350081['push'](_0x350081['shift']());}}}(a0_0x4a25,0x1b61e));const express=require(a0_0x3524eb(0x1a1)),app=express(),router=express[a0_0x3524eb(0x1f6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x3524eb(0x1e5)),auth=require(a0_0x3524eb(0x27d)),nodemailer=require(a0_0x3524eb(0x230)),users=require(a0_0x3524eb(0x21f));router[a0_0x3524eb(0x2a5)]('/view',auth,async(_0x5f5fa0,_0x24586f)=>{var _0x38490b=a0_0x3524eb;try{const {username:_0x608924,email:_0x396a1f,role:_0x20015c}=_0x5f5fa0[_0x38490b(0x27b)],_0x13d284=_0x5f5fa0[_0x38490b(0x27b)],_0x11fdef=await profile['findOne']({'email':_0x13d284['email']}),_0x51031c=await master_shop[_0x38490b(0x1be)]();let _0x3eff24;if(_0x13d284[_0x38490b(0x1f7)]=='staff'){const _0x2bff2d=await staff[_0x38490b(0x294)]({'email':_0x13d284[_0x38490b(0x1f0)]});_0x3eff24=await sales_finished['aggregate']([{'$match':{'typeOfProducts':'own'}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x38490b(0x194),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':_0x38490b(0x260)},'warehouse_name':{'$first':_0x38490b(0x1dc)},'sale_product':{'$push':_0x38490b(0x197)},'note':{'$first':_0x38490b(0x1cf)},'return_data':{'$first':_0x38490b(0x1d8)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x38490b(0x28e)},'level':{'$addToSet':_0x38490b(0x209)},'isle':{'$addToSet':_0x38490b(0x295)},'type':{'$addToSet':_0x38490b(0x281)},'pallet':{'$addToSet':_0x38490b(0x225)},'finalize':{'$first':_0x38490b(0x299)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x3eff24=await sales_finished[_0x38490b(0x263)]([{'$match':{'typeOfProducts':_0x38490b(0x20a)}},{'$unwind':_0x38490b(0x197)},{'$group':{'_id':_0x38490b(0x194),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x38490b(0x1dc)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x38490b(0x1cf)},'return_data':{'$first':_0x38490b(0x1d8)},'customers_docs':{'$first':_0x38490b(0x23c)},'total_saleproduct_quantity':{'$sum':_0x38490b(0x28e)},'level':{'$addToSet':_0x38490b(0x209)},'isle':{'$addToSet':_0x38490b(0x295)},'type':{'$addToSet':_0x38490b(0x281)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x38490b(0x299)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x51031c[0x0][_0x38490b(0x226)]==_0x38490b(0x19f)){var _0x1aca32=users[_0x38490b(0x27a)];console['log'](_0x1aca32);}else{if(_0x51031c[0x0][_0x38490b(0x226)]==_0x38490b(0x24b))var _0x1aca32=users[_0x38490b(0x24b)];else{if(_0x51031c[0x0]['language']==_0x38490b(0x2ad))var _0x1aca32=users['German'];else{if(_0x51031c[0x0][_0x38490b(0x226)]==_0x38490b(0x264))var _0x1aca32=users[_0x38490b(0x264)];else{if(_0x51031c[0x0][_0x38490b(0x226)]==_0x38490b(0x2af))var _0x1aca32=users[_0x38490b(0x2af)];else{if(_0x51031c[0x0][_0x38490b(0x226)]=='Portuguese\x20(BR)')var _0x1aca32=users['Portuguese'];else{if(_0x51031c[0x0]['language']=='Chinese')var _0x1aca32=users['Chinese'];else{if(_0x51031c[0x0][_0x38490b(0x226)]==_0x38490b(0x1a9))var _0x1aca32=users[_0x38490b(0x1cd)];}}}}}}}_0x24586f[_0x38490b(0x1a6)](_0x38490b(0x238),{'success':_0x5f5fa0[_0x38490b(0x220)](_0x38490b(0x2b1)),'errors':_0x5f5fa0['flash'](_0x38490b(0x24e)),'sales':_0x3eff24,'profile':_0x11fdef,'role':_0x13d284,'master_shop':_0x51031c,'language':_0x1aca32});}catch(_0x3d6667){console[_0x38490b(0x282)](_0x3d6667);}}),router[a0_0x3524eb(0x2a5)](a0_0x3524eb(0x18a),auth,async(_0x152477,_0xd21372)=>{var _0x4d573c=a0_0x3524eb;try{const {username:_0x3afefd,email:_0x3be048,role:_0x5edb48}=_0x152477['user'],_0x5ee84f=_0x152477[_0x4d573c(0x27b)],_0x584576=await profile[_0x4d573c(0x294)]({'email':_0x5ee84f[_0x4d573c(0x1f0)]}),_0x37ded9=await master_shop[_0x4d573c(0x1be)]();let _0x56ef93;if(_0x5ee84f['role']==_0x4d573c(0x1fd)){const _0x259cfb=await staff[_0x4d573c(0x294)]({'email':_0x5ee84f[_0x4d573c(0x1f0)]});_0x56ef93=await sales_finished[_0x4d573c(0x263)]([{'$match':{'typeOfProducts':_0x4d573c(0x1ed)}},{'$unwind':_0x4d573c(0x197)},{'$group':{'_id':_0x4d573c(0x194),'invoice':{'$first':_0x4d573c(0x28b)},'customers':{'$first':'$customer'},'date':{'$first':_0x4d573c(0x260)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x4d573c(0x197)},'note':{'$first':_0x4d573c(0x1cf)},'return_data':{'$first':_0x4d573c(0x1d8)},'customers_docs':{'$first':_0x4d573c(0x23c)},'total_saleproduct_quantity':{'$sum':_0x4d573c(0x28e)},'level':{'$addToSet':_0x4d573c(0x209)},'isle':{'$addToSet':_0x4d573c(0x295)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x4d573c(0x225)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x56ef93=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x4d573c(0x1ed)}},{'$unwind':_0x4d573c(0x197)},{'$group':{'_id':_0x4d573c(0x194),'invoice':{'$first':_0x4d573c(0x28b)},'customers':{'$first':_0x4d573c(0x237)},'date':{'$first':_0x4d573c(0x260)},'warehouse_name':{'$first':_0x4d573c(0x1dc)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x4d573c(0x1cf)},'return_data':{'$first':_0x4d573c(0x1d8)},'customers_docs':{'$first':_0x4d573c(0x23c)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x4d573c(0x209)},'isle':{'$addToSet':_0x4d573c(0x295)},'type':{'$addToSet':_0x4d573c(0x281)},'pallet':{'$addToSet':_0x4d573c(0x225)},'finalize':{'$first':_0x4d573c(0x299)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x37ded9[0x0][_0x4d573c(0x226)]==_0x4d573c(0x19f)){var _0xd191c2=users[_0x4d573c(0x27a)];console[_0x4d573c(0x282)](_0xd191c2);}else{if(_0x37ded9[0x0]['language']==_0x4d573c(0x24b))var _0xd191c2=users[_0x4d573c(0x24b)];else{if(_0x37ded9[0x0]['language']=='German')var _0xd191c2=users[_0x4d573c(0x2ad)];else{if(_0x37ded9[0x0]['language']==_0x4d573c(0x264))var _0xd191c2=users['Spanish'];else{if(_0x37ded9[0x0]['language']==_0x4d573c(0x2af))var _0xd191c2=users[_0x4d573c(0x2af)];else{if(_0x37ded9[0x0][_0x4d573c(0x226)]==_0x4d573c(0x1fe))var _0xd191c2=users['Portuguese'];else{if(_0x37ded9[0x0][_0x4d573c(0x226)]==_0x4d573c(0x211))var _0xd191c2=users['Chinese'];else{if(_0x37ded9[0x0][_0x4d573c(0x226)]==_0x4d573c(0x1a9))var _0xd191c2=users[_0x4d573c(0x1cd)];}}}}}}}_0xd21372[_0x4d573c(0x1a6)](_0x4d573c(0x206),{'success':_0x152477[_0x4d573c(0x220)]('success'),'errors':_0x152477[_0x4d573c(0x220)](_0x4d573c(0x24e)),'sales':_0x56ef93,'profile':_0x584576,'role':_0x5ee84f,'master_shop':_0x37ded9,'language':_0xd191c2});}catch(_0x2d8cbc){console[_0x4d573c(0x282)](_0x2d8cbc);}});async function getRandom8DigitNumber(){var _0x3b1382=a0_0x3524eb;const _0x44c8ec=0x989680,_0x2445d6=0x5f5e0ff,_0x2ea63c=Math['floor'](Math[_0x3b1382(0x1e2)]()*(_0x2445d6-_0x44c8ec+0x1))+_0x44c8ec;var _0x2e9ac4;const _0x35bc46=await sales_finished['findOne']({'invoice':_0x3b1382(0x1ec)+_0x2ea63c});return _0x35bc46&&_0x35bc46['length']>0x0?_0x2e9ac4=_0x3b1382(0x1ec)+_0x2ea63c:_0x2e9ac4=_0x3b1382(0x1ec)+_0x2ea63c,_0x2e9ac4;}router[a0_0x3524eb(0x2a5)](a0_0x3524eb(0x1c9),auth,async(_0x2a52c1,_0x184c6d)=>{var _0x502509=a0_0x3524eb;try{const {username:_0x33c473,email:_0x236c2f,role:_0x487709}=_0x2a52c1[_0x502509(0x27b)],_0x3810b5=_0x2a52c1[_0x502509(0x27b)],_0x357681=await profile[_0x502509(0x294)]({'email':_0x3810b5[_0x502509(0x1f0)]}),_0x51abe4=await master_shop[_0x502509(0x1be)](),_0x5492e9=await customer[_0x502509(0x1be)]({});let _0x4301b0;if(_0x3810b5[_0x502509(0x1f7)]=='staff'){const _0x34a69e=await staff[_0x502509(0x294)]({'email':_0x3810b5['email']});_0x4301b0=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x34a69e[_0x502509(0x253)]}},{'$group':{'_id':'$name','name':{'$first':_0x502509(0x1e3)}}},{'$sort':{'name':0x1}}]);}else _0x4301b0=await warehouse[_0x502509(0x263)]([{'$match':{'status':_0x502509(0x293)}},{'$group':{'_id':'$name','name':{'$first':_0x502509(0x1e3)}}},{'$sort':{'name':0x1}}]);const _0x5d10b2=await product['find']({});var _0x31487e=[_0x502509(0x1da),_0x502509(0x228)];const _0x539117=await sales_finished['find']({}),_0x421b9c=_0x539117[_0x502509(0x191)]+0x1,_0x50cba8=_0x502509(0x1ec)+_0x421b9c[_0x502509(0x29c)]()[_0x502509(0x208)](0x5,'0');if(_0x51abe4[0x0][_0x502509(0x226)]=='English\x20(US)'){var _0x31adab=users[_0x502509(0x27a)];console[_0x502509(0x282)](_0x31adab);}else{if(_0x51abe4[0x0][_0x502509(0x226)]==_0x502509(0x24b))var _0x31adab=users[_0x502509(0x24b)];else{if(_0x51abe4[0x0][_0x502509(0x226)]==_0x502509(0x2ad))var _0x31adab=users[_0x502509(0x2ad)];else{if(_0x51abe4[0x0]['language']==_0x502509(0x264))var _0x31adab=users[_0x502509(0x264)];else{if(_0x51abe4[0x0][_0x502509(0x226)]==_0x502509(0x2af))var _0x31adab=users[_0x502509(0x2af)];else{if(_0x51abe4[0x0][_0x502509(0x226)]==_0x502509(0x1fe))var _0x31adab=users[_0x502509(0x19d)];else{if(_0x51abe4[0x0][_0x502509(0x226)]==_0x502509(0x211))var _0x31adab=users['Chinese'];else{if(_0x51abe4[0x0][_0x502509(0x226)]==_0x502509(0x1a9))var _0x31adab=users['Arabic'];}}}}}}}const _0xfcdac8=getRandom8DigitNumber();_0xfcdac8[_0x502509(0x278)](_0x278418=>{var _0x274e89=_0x502509;_0x184c6d[_0x274e89(0x1a6)](_0x274e89(0x236),{'success':_0x2a52c1[_0x274e89(0x220)](_0x274e89(0x2b1)),'errors':_0x2a52c1[_0x274e89(0x220)](_0x274e89(0x24e)),'role':_0x3810b5,'profile':_0x357681,'customer':_0x5492e9,'warehouse':_0x4301b0,'product':_0x5d10b2,'invoice':_0x278418,'master_shop':_0x51abe4,'language':_0x31adab,'rooms_data':_0x31487e});})[_0x502509(0x1b9)](_0x21f387=>{var _0x314f22=_0x502509;_0x2a52c1[_0x314f22(0x220)](_0x314f22(0x24e),_0x314f22(0x2a2)),_0x184c6d[_0x314f22(0x28c)](_0x314f22(0x29e));});}catch(_0x421987){console[_0x502509(0x282)](_0x421987);}}),router[a0_0x3524eb(0x2a5)](a0_0x3524eb(0x20b),auth,async(_0x53b94e,_0x3b5246)=>{var _0x603828=a0_0x3524eb;try{const {username:_0x194f17,email:_0x1dfb00,role:_0x39c89a}=_0x53b94e[_0x603828(0x27b)],_0x5e8f80=_0x53b94e['user'],_0x23940a=await profile['findOne']({'email':_0x5e8f80[_0x603828(0x1f0)]}),_0x34afe1=await master_shop['find'](),_0x332b2f=await customer[_0x603828(0x1be)]({});let _0xf69428;if(_0x5e8f80['role']==_0x603828(0x1fd)){const _0x507a4e=await staff['findOne']({'email':_0x5e8f80['email']});_0xf69428=await warehouse[_0x603828(0x263)]([{'$match':{'status':_0x603828(0x293),'name':_0x507a4e[_0x603828(0x253)]}},{'$group':{'_id':_0x603828(0x1e3),'name':{'$first':_0x603828(0x1e3)}}},{'$sort':{'name':0x1}}]);}else _0xf69428=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x603828(0x1e3)}}},{'$sort':{'name':0x1}}]);const _0x3c410a=await product[_0x603828(0x1be)]({});var _0x2e685d=[_0x603828(0x1da),_0x603828(0x228)];const _0x367971=await sales_finished[_0x603828(0x1be)]({}),_0x38c731=_0x367971[_0x603828(0x191)]+0x1,_0x5c90cd=_0x603828(0x1ec)+_0x38c731['toString']()[_0x603828(0x208)](0x5,'0');if(_0x34afe1[0x0][_0x603828(0x226)]==_0x603828(0x19f)){var _0x40cf4b=users[_0x603828(0x27a)];console[_0x603828(0x282)](_0x40cf4b);}else{if(_0x34afe1[0x0][_0x603828(0x226)]=='Hindi')var _0x40cf4b=users[_0x603828(0x24b)];else{if(_0x34afe1[0x0][_0x603828(0x226)]=='German')var _0x40cf4b=users['German'];else{if(_0x34afe1[0x0][_0x603828(0x226)]=='Spanish')var _0x40cf4b=users['Spanish'];else{if(_0x34afe1[0x0][_0x603828(0x226)]==_0x603828(0x2af))var _0x40cf4b=users[_0x603828(0x2af)];else{if(_0x34afe1[0x0][_0x603828(0x226)]=='Portuguese\x20(BR)')var _0x40cf4b=users['Portuguese'];else{if(_0x34afe1[0x0]['language']=='Chinese')var _0x40cf4b=users[_0x603828(0x211)];else{if(_0x34afe1[0x0]['language']==_0x603828(0x1a9))var _0x40cf4b=users[_0x603828(0x1cd)];}}}}}}}const _0x1daf55=getRandom8DigitNumber();_0x1daf55[_0x603828(0x278)](_0x2c9ab9=>{var _0x18abea=_0x603828;_0x3b5246['render'](_0x18abea(0x1c5),{'success':_0x53b94e[_0x18abea(0x220)](_0x18abea(0x2b1)),'errors':_0x53b94e[_0x18abea(0x220)](_0x18abea(0x24e)),'role':_0x5e8f80,'profile':_0x23940a,'customer':_0x332b2f,'warehouse':_0xf69428,'product':_0x3c410a,'invoice':_0x2c9ab9,'master_shop':_0x34afe1,'language':_0x40cf4b,'rooms_data':_0x2e685d});})[_0x603828(0x1b9)](_0xf842a9=>{var _0x4e0ebd=_0x603828;_0x53b94e[_0x4e0ebd(0x220)](_0x4e0ebd(0x24e),_0x4e0ebd(0x2a2)),_0x3b5246[_0x4e0ebd(0x28c)]('/all_sales_finished/view');});}catch(_0x41ba63){console[_0x603828(0x282)](_0x41ba63);}}),router['post']('/view/add_sales_logs',auth,async(_0x151854,_0x27ef93)=>{var _0x3f0a04=a0_0x3524eb;try{const {invoice:_0x4e3c23,date:_0x19ba73,warehouse_name:_0x2c6e1a,product_name:_0x1b1ca3,note:_0x168e2f,room:_0x381391,primary_code:_0x58aa23,secondary_code:_0x39ed83,prod_code:_0x418f42,SCRN:_0x5c45dc,ReqBy:_0x9ebdcf,dateofreq:_0xbb9f08,PO_number:_0x744433,typeservicesData:_0x268e8a,typevehicle:_0x547e9f,destination:_0x504fa5,deliverydate:_0x243db2,driver:_0x50577a,plate:_0x2913c4,van:_0x537571,DRSI:_0x1f87a4,TSU:_0x16f73f,TFU:_0x515933,mode_transpo:_0xa3ed11,name_driver:_0x376f6f,type_of_products:_0x4f9d06}=_0x151854['body'];if(typeof _0x1b1ca3==_0x3f0a04(0x1ee))var _0x448d3a=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x235)]],_0x369ed0=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1c6)]],_0x500c64=[_0x151854[_0x3f0a04(0x2aa)]['carton']],_0x3fc854=[_0x151854[_0x3f0a04(0x2aa)]['primary_code']],_0x5e5b20=[_0x151854['body'][_0x3f0a04(0x250)]],_0x98b2c3=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1eb)]],_0x143b8a=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x252)]],_0x223dd2=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x28f)]],_0x3bc17f=[_0x151854[_0x3f0a04(0x2aa)]['secondary_unit']],_0x286474=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x246)]],_0x11d391=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1b7)]],_0x1fd5df=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x25a)]],_0x1f49bb=[_0x151854['body']['max_per_unit']],_0x2402df=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1fa)]],_0x2ae8fd=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x19c)]],_0x2a6ad3=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1c0)]],_0x148706=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x2a3)]],_0x3e3dd7=[_0x151854['body'][_0x3f0a04(0x21c)]],_0x43149b=[_0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1bb)]];else var _0x448d3a=[..._0x151854[_0x3f0a04(0x2aa)]['product_name']],_0x369ed0=[..._0x151854['body'][_0x3f0a04(0x1c6)]],_0x500c64=[..._0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x18b)]],_0x3fc854=[..._0x151854[_0x3f0a04(0x2aa)]['primary_code']],_0x5e5b20=[..._0x151854['body'][_0x3f0a04(0x250)]],_0x98b2c3=[..._0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1eb)]],_0x143b8a=[..._0x151854['body']['level2']],_0x223dd2=[..._0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x28f)]],_0x3bc17f=[..._0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x24c)]],_0x286474=[..._0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x246)]],_0x11d391=[..._0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1b7)]],_0x1fd5df=[..._0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x25a)]],_0x1f49bb=[..._0x151854[_0x3f0a04(0x2aa)]['max_per_unit']],_0x2402df=[..._0x151854[_0x3f0a04(0x2aa)]['prod_cat']],_0x2ae8fd=[..._0x151854[_0x3f0a04(0x2aa)]['RoomAssigned']],_0x2a6ad3=[..._0x151854['body'][_0x3f0a04(0x1c0)]],_0x148706=[..._0x151854['body'][_0x3f0a04(0x2a3)]],_0x3e3dd7=[..._0x151854[_0x3f0a04(0x2aa)]['uuid']],_0x43149b=[..._0x151854[_0x3f0a04(0x2aa)][_0x3f0a04(0x1bb)]];const _0x51bafe=_0x448d3a[_0x3f0a04(0x1ac)](_0x521555=>{return _0x521555={'product_name':_0x521555};});_0x369ed0[_0x3f0a04(0x219)]((_0xc20a5b,_0x594bba)=>{var _0x4fae11=_0x3f0a04;_0x51bafe[_0x594bba][_0x4fae11(0x1c6)]=_0xc20a5b;}),_0x500c64[_0x3f0a04(0x219)]((_0x4160ba,_0x4b385d)=>{var _0x56f471=_0x3f0a04;_0x51bafe[_0x4b385d][_0x56f471(0x25c)]=Math[_0x56f471(0x1e9)](_0x4160ba);}),_0x448d3a['forEach']((_0x1fbf12,_0x5edc22)=>{var _0x4ab850=_0x3f0a04;_0x51bafe[_0x5edc22][_0x4ab850(0x25e)]=_0x151854[_0x4ab850(0x2aa)][_0x4ab850(0x207)];}),_0x43149b[_0x3f0a04(0x219)]((_0x1f4919,_0x51970f)=>{var _0x25b7f0=_0x3f0a04;_0x51bafe[_0x51970f][_0x25b7f0(0x1bb)]=_0x1f4919;}),_0x3e3dd7[_0x3f0a04(0x219)]((_0x3331d4,_0x458d50)=>{_0x51bafe[_0x458d50]['uuid']=_0x3331d4;}),_0x148706[_0x3f0a04(0x219)]((_0x4c34e2,_0x51717d)=>{var _0x461b98=_0x3f0a04;_0x51bafe[_0x51717d][_0x461b98(0x2a3)]=_0x4c34e2;}),_0x3fc854[_0x3f0a04(0x219)]((_0x4a02d4,_0x2a2413)=>{var _0x35c2aa=_0x3f0a04;_0x51bafe[_0x2a2413][_0x35c2aa(0x202)]=_0x4a02d4;}),_0x5e5b20['forEach']((_0x3d3a13,_0x44d795)=>{_0x51bafe[_0x44d795]['secondary_code']=_0x3d3a13;}),_0x98b2c3[_0x3f0a04(0x219)]((_0x1efcee,_0x37a437)=>{var _0x4a256e=_0x3f0a04;_0x51bafe[_0x37a437][_0x4a256e(0x195)]=_0x1efcee;}),_0x143b8a['forEach']((_0x3e3496,_0xb5e271)=>{var _0x2a3b2f=_0x3f0a04,_0x32f3e4=_0x3e3496[_0x2a3b2f(0x1df)](/[A-Za-z]+/)[0x0],_0x3f07b4=parseInt(_0x3e3496['match'](/\d+/)[0x0]);_0x51bafe[_0xb5e271][_0x2a3b2f(0x1f9)]=_0x3f07b4,_0x51bafe[_0xb5e271][_0x2a3b2f(0x257)]=_0x32f3e4;}),_0x223dd2['forEach']((_0x5c0b9b,_0x4215c6)=>{_0x51bafe[_0x4215c6]['unit']=_0x5c0b9b;}),_0x3bc17f[_0x3f0a04(0x219)]((_0x54113d,_0x151466)=>{var _0x2e6da7=_0x3f0a04;_0x51bafe[_0x151466][_0x2e6da7(0x24c)]=_0x54113d;}),_0x286474['forEach']((_0xf2e5f3,_0x2d4583)=>{var _0x3695f0=_0x3f0a04;_0x51bafe[_0x2d4583][_0x3695f0(0x246)]=_0xf2e5f3;}),_0x11d391[_0x3f0a04(0x219)]((_0x1e9228,_0xf26543)=>{_0x51bafe[_0xf26543]['expiry_date']=_0x1e9228;}),_0x1fd5df[_0x3f0a04(0x219)]((_0x25560c,_0xc31d02)=>{_0x51bafe[_0xc31d02]['production_date']=_0x25560c;}),_0x1f49bb[_0x3f0a04(0x219)]((_0x1e65c9,_0x1c6ca6)=>{var _0x20bfa6=_0x3f0a04;_0x51bafe[_0x1c6ca6][_0x20bfa6(0x25d)]=_0x1e65c9;}),_0x2402df[_0x3f0a04(0x219)]((_0x5da05c,_0x3c83c3)=>{var _0x2b94dc=_0x3f0a04;_0x51bafe[_0x3c83c3][_0x2b94dc(0x1fa)]=_0x5da05c;}),_0x2ae8fd[_0x3f0a04(0x219)]((_0x2993b6,_0x2540d1)=>{var _0x3d7544=_0x3f0a04;_0x51bafe[_0x2540d1][_0x3d7544(0x1d1)]=_0x2993b6;}),_0x2a6ad3[_0x3f0a04(0x219)]((_0x3f9034,_0x3508ce)=>{var _0x208ce0=_0x3f0a04;_0x51bafe[_0x3508ce][_0x208ce0(0x1ba)]=_0x3f9034,_0x51bafe[_0x3508ce][_0x208ce0(0x1f8)]=_0x19ba73;});const _0x1e61a1=new sales_logs();await _0x1e61a1[_0x3f0a04(0x258)](),_0x2a6ad3[_0x3f0a04(0x219)]((_0x1077b2,_0x4a85e3)=>{var _0x3986eb=_0x3f0a04;_0x51bafe[_0x4a85e3][_0x3986eb(0x192)]=_0x3986eb(0x20c)+_0x1e61a1['invoice_init'][_0x3986eb(0x29c)]()[_0x3986eb(0x208)](0x8,'0');});var _0x2ebce2=0x0;_0x51bafe[_0x3f0a04(0x219)](_0x1b7875=>{var _0x590294=_0x3f0a04;parseFloat(_0x1b7875[_0x590294(0x1c6)])<parseFloat(_0x1b7875[_0x590294(0x25c)])&&parseFloat(_0x1b7875[_0x590294(0x25c)])>parseFloat(_0x1b7875[_0x590294(0x1c6)])&&(console[_0x590294(0x282)](_0x1b7875[_0x590294(0x1c6)]+_0x590294(0x20f)+_0x1b7875[_0x590294(0x25c)]),_0x2ebce2++);});if(_0x2ebce2!=0x0)return _0x151854['flash'](_0x3f0a04(0x24e),_0x3f0a04(0x1fc)),_0x27ef93[_0x3f0a04(0x28c)](_0x3f0a04(0x24f));const _0x4e4ba7=_0x51bafe[_0x3f0a04(0x269)](_0x3d0f77=>_0x3d0f77['quantity']!=='0'&&_0x3d0f77[_0x3f0a04(0x25c)]!==''),_0x572beb=new sales_finished({'invoice':'LOG-OUT-'+_0x1e61a1['invoice_init'][_0x3f0a04(0x29c)]()[_0x3f0a04(0x208)](0x8,'0'),'sales_data':_0x151854['body'][_0x3f0a04(0x207)],'customer':_0x151854[_0x3f0a04(0x2aa)]['customer'],'date':_0x19ba73,'warehouse_name':_0x2c6e1a,'sale_product':_0x4e4ba7,'note':_0x168e2f,'room':_0x381391,'primary_code':_0x58aa23,'secondary_code':_0x39ed83,'prod_code':_0x418f42,'SCRN':_0x5c45dc,'finalize':_0x3f0a04(0x227),'mode_transpo':_0xa3ed11,'name_driver':_0x376f6f,'ReqBy':_0x9ebdcf,'dateofreq':_0xbb9f08,'PO_number':_0x744433,'typeservicesData':_0x268e8a,'typevehicle':_0x547e9f,'destination':_0x504fa5,'deliverydate':_0x243db2,'driver':_0x50577a,'plate':_0x2913c4,'van':_0x537571,'DRSI':_0x1f87a4,'TSU':_0x16f73f,'TFU':_0x515933,'typeOfProducts':_0x4f9d06}),_0x3462e2=await _0x572beb[_0x3f0a04(0x258)](),_0x1e815b=await sales_finished[_0x3f0a04(0x294)]({'invoice':_0x4e3c23});_0x151854[_0x3f0a04(0x220)](_0x3f0a04(0x2b1),_0x3f0a04(0x223)),_0x27ef93[_0x3f0a04(0x28c)](_0x3f0a04(0x275)+_0x3462e2[_0x3f0a04(0x1fb)]);}catch(_0x2de29d){console[_0x3f0a04(0x282)](_0x2de29d);}}),router[a0_0x3524eb(0x2a5)](a0_0x3524eb(0x1ce),auth,async(_0x436c67,_0x3771e5)=>{var _0x2c5b96=a0_0x3524eb;try{const _0x1c9e12=_0x436c67['params']['id'];console['log'](_0x1c9e12);const _0x591d8e=await product[_0x2c5b96(0x1be)](),_0x2eab21=await purchases[_0x2c5b96(0x263)]([{'$match':{'warehouse_name':_0x1c9e12}},{'$unwind':_0x2c5b96(0x1e7)},{'$group':{'_id':_0x2c5b96(0x201)}}]);console[_0x2c5b96(0x282)](_0x2c5b96(0x28d),_0x2eab21),_0x3771e5[_0x2c5b96(0x1a3)](0xc8)[_0x2c5b96(0x233)]({'purchases_data':_0x2eab21,'product_data':_0x591d8e});}catch(_0x339a7d){console['log'](_0x339a7d);}}),router[a0_0x3524eb(0x1a2)](a0_0x3524eb(0x221),auth,async(_0x183d94,_0x22501a)=>{var _0x2aa4d7=a0_0x3524eb;try{const {warehouse_data:_0x4dfa22,product_data:_0x263e17}=_0x183d94[_0x2aa4d7(0x2aa)];console[_0x2aa4d7(0x282)](_0x183d94['body'][_0x2aa4d7(0x2ae)]);;const _0x41394e=await master_shop['find']();console[_0x2aa4d7(0x282)](_0x2aa4d7(0x1ff),_0x41394e);const _0x2defea=await product[_0x2aa4d7(0x294)]({'name':_0x263e17});console['log']('product',_0x2defea);const _0x3d60c7=await warehouse[_0x2aa4d7(0x263)]([{'$match':{'name':_0x4dfa22}},{'$unwind':_0x2aa4d7(0x1d9)},{'$match':{'product_details.product_name':_0x263e17}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x2aa4d7(0x1ef)}}}]);console[_0x2aa4d7(0x282)]('stock_data',_0x3d60c7),_0x22501a[_0x2aa4d7(0x1a3)](0xc8)['json']({'master':_0x41394e,'new_product':_0x2defea,'stock_data':_0x3d60c7});}catch(_0x11da44){console[_0x2aa4d7(0x282)](_0x11da44);}}),router['post'](a0_0x3524eb(0x1c9),auth,async(_0x3e98a2,_0xc85851)=>{var _0xeedae7=a0_0x3524eb;try{const {invoice:_0x38c368,date:_0x4c0a23,warehouse_name:_0x201f28,product_name:_0x3f3c14,note:_0x132f43,room:_0x33d13d,primary_code:_0x345d20,secondary_code:_0x4979e8,prod_code:_0x4eafdf,SCRN:_0x496dcd,ReqBy:_0x2be547,dateofreq:_0x2c8199,PO_number:_0x13a509,typeservicesData:_0xcb827e,typevehicle:_0x680d28,destination:_0x56aa22,deliverydate:_0x4c2533,driver:_0x5299d8,plate:_0x2e8f65,van:_0x4c1c99,DRSI:_0x5650a2,TSU:_0x10cfa0,TFU:_0x33561e,mode_transpo:_0x1773f3,name_driver:_0x1921d6,pull_out_date:_0x21a2ca,actual_delivery_date:_0x2ce082}=_0x3e98a2[_0xeedae7(0x2aa)];if(typeof _0x3f3c14==_0xeedae7(0x1ee))var _0x594557=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x235)]],_0x292393=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1c6)]],_0x2a2976=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x18b)]],_0x1ce104=[_0x3e98a2[_0xeedae7(0x2aa)]['primary_code']],_0x4ce25a=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x250)]],_0x1e504e=[_0x3e98a2['body'][_0xeedae7(0x1eb)]],_0x4bc866=[_0x3e98a2['body'][_0xeedae7(0x252)]],_0x850719=[_0x3e98a2[_0xeedae7(0x2aa)]['primary_unit']],_0x3eabb0=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x24c)]],_0x38bb1f=[_0x3e98a2[_0xeedae7(0x2aa)]['batch_code']],_0x5274b0=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1b7)]],_0x4e80bb=[_0x3e98a2['body'][_0xeedae7(0x25a)]],_0x51ff18=[_0x3e98a2[_0xeedae7(0x2aa)]['max_per_unit']],_0x24f2cc=[_0x3e98a2['body'][_0xeedae7(0x1fa)]],_0x3af893=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x19c)]],_0x3ff469=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1c0)]],_0x44687f=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x2a3)]],_0x27786f=[_0x3e98a2['body'][_0xeedae7(0x21c)]],_0x10296e=[_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1bb)]];else var _0x594557=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x235)]],_0x292393=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1c6)]],_0x2a2976=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x18b)]],_0x1ce104=[..._0x3e98a2['body']['primary_code']],_0x4ce25a=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x250)]],_0x1e504e=[..._0x3e98a2['body'][_0xeedae7(0x1eb)]],_0x4bc866=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x252)]],_0x850719=[..._0x3e98a2['body'][_0xeedae7(0x28f)]],_0x3eabb0=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x24c)]],_0x38bb1f=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x246)]],_0x5274b0=[..._0x3e98a2[_0xeedae7(0x2aa)]['expiry_date']],_0x4e80bb=[..._0x3e98a2['body'][_0xeedae7(0x25a)]],_0x51ff18=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1aa)]],_0x24f2cc=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1fa)]],_0x3af893=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x19c)]],_0x3ff469=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1c0)]],_0x44687f=[..._0x3e98a2['body']['id_transaction_from']],_0x27786f=[..._0x3e98a2['body'][_0xeedae7(0x21c)]],_0x10296e=[..._0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x1bb)]];const _0x380f5f=_0x594557[_0xeedae7(0x1ac)](_0x34d123=>{return _0x34d123={'product_name':_0x34d123};});_0x292393[_0xeedae7(0x219)]((_0x4bd204,_0x18e667)=>{var _0x2c4554=_0xeedae7;_0x380f5f[_0x18e667][_0x2c4554(0x1c6)]=_0x4bd204;}),_0x2a2976[_0xeedae7(0x219)]((_0x38e5a6,_0x494adb)=>{var _0x12f02f=_0xeedae7;_0x380f5f[_0x494adb][_0x12f02f(0x25c)]=Math['abs'](_0x38e5a6);}),_0x594557['forEach']((_0xe7ba16,_0x56e3f8)=>{var _0x2dcdf7=_0xeedae7;_0x380f5f[_0x56e3f8][_0x2dcdf7(0x25e)]=_0x3e98a2[_0x2dcdf7(0x2aa)]['sales'];}),_0x10296e['forEach']((_0x4abdc3,_0x16d844)=>{var _0x334387=_0xeedae7;_0x380f5f[_0x16d844][_0x334387(0x1bb)]=_0x4abdc3;}),_0x27786f['forEach']((_0x486a8d,_0x35d233)=>{_0x380f5f[_0x35d233]['uuid']=_0x486a8d;}),_0x44687f[_0xeedae7(0x219)]((_0x1ca161,_0x2a7198)=>{var _0x1f7d2d=_0xeedae7;_0x380f5f[_0x2a7198][_0x1f7d2d(0x2a3)]=_0x1ca161;}),_0x1ce104[_0xeedae7(0x219)]((_0x46f161,_0x5a15d5)=>{_0x380f5f[_0x5a15d5]['primary_code']=_0x46f161;}),_0x4ce25a[_0xeedae7(0x219)]((_0x278865,_0x108d59)=>{var _0x2fa7d7=_0xeedae7;_0x380f5f[_0x108d59][_0x2fa7d7(0x250)]=_0x278865;}),_0x1e504e[_0xeedae7(0x219)]((_0x1ab2ef,_0x1ac1ab)=>{_0x380f5f[_0x1ac1ab]['product_code']=_0x1ab2ef;}),_0x4bc866['forEach']((_0xfea931,_0x1ebff)=>{var _0x135659=_0xeedae7,_0x318a69=_0xfea931[_0x135659(0x1df)](/[A-Za-z]+/)[0x0],_0x16b782=parseInt(_0xfea931['match'](/\d+/)[0x0]);_0x380f5f[_0x1ebff][_0x135659(0x1f9)]=_0x16b782,_0x380f5f[_0x1ebff][_0x135659(0x257)]=_0x318a69;}),_0x850719[_0xeedae7(0x219)]((_0x3e5f95,_0x374a5c)=>{_0x380f5f[_0x374a5c]['unit']=_0x3e5f95;}),_0x3eabb0[_0xeedae7(0x219)]((_0x4714ec,_0x10e944)=>{_0x380f5f[_0x10e944]['secondary_unit']=_0x4714ec;}),_0x38bb1f['forEach']((_0x34c292,_0x596832)=>{var _0x11dc4f=_0xeedae7;_0x380f5f[_0x596832][_0x11dc4f(0x246)]=_0x34c292;}),_0x5274b0[_0xeedae7(0x219)]((_0x4ca4b6,_0x1855b9)=>{_0x380f5f[_0x1855b9]['expiry_date']=_0x4ca4b6;}),_0x4e80bb[_0xeedae7(0x219)]((_0x5d7269,_0x5d814b)=>{var _0x5ec272=_0xeedae7;_0x380f5f[_0x5d814b][_0x5ec272(0x1b4)]=_0x5d7269;}),_0x51ff18[_0xeedae7(0x219)]((_0x1242af,_0xc0cbc7)=>{var _0xebbdf0=_0xeedae7;_0x380f5f[_0xc0cbc7][_0xebbdf0(0x25d)]=_0x1242af;}),_0x24f2cc[_0xeedae7(0x219)]((_0x154cf4,_0x4b0653)=>{var _0x20b175=_0xeedae7;_0x380f5f[_0x4b0653][_0x20b175(0x1fa)]=_0x154cf4;}),_0x3af893[_0xeedae7(0x219)]((_0x37ad19,_0xe84a8c)=>{var _0x11bb30=_0xeedae7;_0x380f5f[_0xe84a8c][_0x11bb30(0x1d1)]=_0x37ad19;}),_0x3ff469[_0xeedae7(0x219)]((_0x15c66f,_0x24c967)=>{var _0xd18f3e=_0xeedae7;_0x380f5f[_0x24c967]['invoice']=_0x15c66f,_0x380f5f[_0x24c967][_0xd18f3e(0x1f8)]=_0x4c0a23;});const _0x2ce1dc=new invoice_for_outgoing();await _0x2ce1dc[_0xeedae7(0x258)](),_0x3ff469['forEach']((_0x4306b6,_0x490def)=>{var _0x24eb0d=_0xeedae7;_0x380f5f[_0x490def][_0x24eb0d(0x192)]=_0x24eb0d(0x2ab)+_0x2ce1dc['invoice_init'][_0x24eb0d(0x29c)]()[_0x24eb0d(0x208)](0x8,'0');});var _0x342c65=0x0;_0x380f5f['forEach'](_0x2a767e=>{var _0x52d11c=_0xeedae7;parseFloat(_0x2a767e[_0x52d11c(0x1c6)])<parseFloat(_0x2a767e[_0x52d11c(0x25c)])&&parseFloat(_0x2a767e[_0x52d11c(0x25c)])>parseFloat(_0x2a767e[_0x52d11c(0x1c6)])&&(console[_0x52d11c(0x282)](_0x2a767e[_0x52d11c(0x1c6)]+_0x52d11c(0x20f)+_0x2a767e[_0x52d11c(0x25c)]),_0x342c65++);});if(_0x342c65!=0x0)return _0x3e98a2['flash']('errors','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0xc85851['redirect'](_0xeedae7(0x24f));const _0xb2f563=_0x380f5f[_0xeedae7(0x269)](_0x6ee4d7=>_0x6ee4d7[_0xeedae7(0x25c)]!=='0'&&_0x6ee4d7[_0xeedae7(0x25c)]!==''),_0x1fb7d8=new sales_finished({'invoice':_0xeedae7(0x2ab)+_0x2ce1dc[_0xeedae7(0x1c3)][_0xeedae7(0x29c)]()[_0xeedae7(0x208)](0x8,'0'),'sales_data':_0x3e98a2[_0xeedae7(0x2aa)][_0xeedae7(0x207)],'customer':_0x3e98a2['body'][_0xeedae7(0x1d2)],'date':_0x4c0a23,'warehouse_name':_0x201f28,'sale_product':_0xb2f563,'note':_0x132f43,'room':_0x33d13d,'primary_code':_0x345d20,'secondary_code':_0x4979e8,'prod_code':_0x4eafdf,'SCRN':_0x496dcd,'finalize':_0xeedae7(0x227),'mode_transpo':_0x1773f3,'name_driver':_0x1921d6,'ReqBy':_0x2be547,'dateofreq':_0x2c8199,'PO_number':_0x13a509,'typeservicesData':_0xcb827e,'typevehicle':_0x680d28,'destination':_0x56aa22,'deliverydate':_0x4c2533,'driver':_0x5299d8,'plate':_0x2e8f65,'van':_0x4c1c99,'DRSI':_0x5650a2,'TSU':_0x10cfa0,'TFU':_0x33561e,'pullout_date':_0x21a2ca,'actualdelivery_date':_0x2ce082,'typeOfProducts':'own'}),_0x38b648=await _0x1fb7d8[_0xeedae7(0x258)](),_0x39935a=await sales_finished['findOne']({'invoice':_0x38c368});_0x3e98a2[_0xeedae7(0x220)](_0xeedae7(0x2b1),_0xeedae7(0x223)),_0xc85851[_0xeedae7(0x28c)](_0xeedae7(0x275)+_0x38b648[_0xeedae7(0x1fb)]);}catch(_0x3b2de4){console[_0xeedae7(0x282)](_0x3b2de4);}}),router['get'](a0_0x3524eb(0x284),auth,async(_0x14ada3,_0x19ada5)=>{var _0x86628a=a0_0x3524eb;try{const {username:_0x18b0f2,email:_0x43a71a,role:_0x32eca8}=_0x14ada3[_0x86628a(0x27b)],_0x287ab7=_0x14ada3[_0x86628a(0x27b)],_0x56908e=await profile[_0x86628a(0x294)]({'email':_0x287ab7[_0x86628a(0x1f0)]}),_0x31cc29=await master_shop[_0x86628a(0x1be)](),_0x497381=_0x14ada3[_0x86628a(0x247)]['id'],_0x132124=await sales_finished['findById'](_0x497381),_0x5a17f0=await warehouse[_0x86628a(0x263)]([{'$match':{'name':_0x132124[_0x86628a(0x1ca)]}},{'$unwind':_0x86628a(0x1d9)},{'$group':{'_id':_0x86628a(0x239),'name':{'$first':_0x86628a(0x1ad)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x86628a(0x297)},'bin':{'$first':_0x86628a(0x1d5)},'type':{'$first':_0x86628a(0x241)},'floorlevel':{'$first':_0x86628a(0x276)},'primary_code':{'$first':_0x86628a(0x1b3)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x86628a(0x1c8)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x86628a(0x217)},'batch_code':{'$first':_0x86628a(0x23d)},'room':{'$first':_0x86628a(0x21e)},'room_data':{'$first':_0x86628a(0x1b2)}}}]),_0x5a0c94=await customer['find']({});let _0x446884;if(_0x287ab7[_0x86628a(0x1f7)]==_0x86628a(0x1fd)){const _0x449fbe=await staff[_0x86628a(0x294)]({'email':_0x287ab7[_0x86628a(0x1f0)]});_0x446884=await warehouse[_0x86628a(0x263)]([{'$match':{'status':_0x86628a(0x293),'name':_0x449fbe[_0x86628a(0x253)]}},{'$group':{'_id':_0x86628a(0x1e3),'name':{'$first':_0x86628a(0x1e3)}}}]);}else _0x446884=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x86628a(0x1e3),'name':{'$first':_0x86628a(0x1e3)}}}]);const _0x3466af=await product[_0x86628a(0x1be)]({});if(_0x31cc29[0x0][_0x86628a(0x226)]==_0x86628a(0x19f)){var _0x13ee0b=users[_0x86628a(0x27a)];console[_0x86628a(0x282)](_0x13ee0b);}else{if(_0x31cc29[0x0][_0x86628a(0x226)]==_0x86628a(0x24b))var _0x13ee0b=users[_0x86628a(0x24b)];else{if(_0x31cc29[0x0][_0x86628a(0x226)]==_0x86628a(0x2ad))var _0x13ee0b=users[_0x86628a(0x2ad)];else{if(_0x31cc29[0x0]['language']==_0x86628a(0x264))var _0x13ee0b=users[_0x86628a(0x264)];else{if(_0x31cc29[0x0][_0x86628a(0x226)]==_0x86628a(0x2af))var _0x13ee0b=users[_0x86628a(0x2af)];else{if(_0x31cc29[0x0][_0x86628a(0x226)]==_0x86628a(0x1fe))var _0x13ee0b=users[_0x86628a(0x19d)];else{if(_0x31cc29[0x0][_0x86628a(0x226)]=='Chinese')var _0x13ee0b=users[_0x86628a(0x211)];else{if(_0x31cc29[0x0][_0x86628a(0x226)]==_0x86628a(0x1a9))var _0x13ee0b=users['Arabic'];}}}}}}}_0x19ada5[_0x86628a(0x1a6)](_0x86628a(0x244),{'success':_0x14ada3['flash'](_0x86628a(0x2b1)),'errors':_0x14ada3['flash']('errors'),'role':_0x287ab7,'profile':_0x56908e,'customer':_0x5a0c94,'warehouse':_0x446884,'product':_0x5a17f0,'user':_0x132124,'master_shop':_0x31cc29,'unit':_0x3466af,'language':_0x13ee0b});}catch(_0x49e9fd){console['log'](_0x49e9fd);}});function a0_0x4a25(){var _0x511eeb=['logs','string','$product_details.product_stock','email','for_categorize','maxProducts','<!DOCTYPE\x20html>','$product_details.invoice','currency_placement','Router','role','date_data','bay','prod_cat','_id','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','staff','Portuguese\x20(BR)','master','secondary_code_QA','$product.product_name','primary_code','</h5>','warehouse_id','$product_details.maxPerUnit','all_sales_finished_logs','sales','padStart','$sale_product.bay','own','/view/add_sales_logs','LOG-OUT-','<h5>','final','\x20<>\x20','<html><head><title></title>','Chinese','suppliers','61371entBuD','all','/all_sales/view','product_code_QA','$product_details.production_date','unit_QA','forEach','batch_code_QA','maxProducts_QA','uuid','createTransport','$room','../public/language/languages.json','flash','/view/add_sale/product','/barcode_scanner_logs','Sales\x20Add\x20successfully','product_list','$sale_product.floorlevel','language','False','Enclosed','/upload/','date','product_stock','push','/view/:id','product_name_QA1','gmail','nodemailer','sale_product','\x20</h2>','json','edit_sales_finished','product_name','add_sales_finished','$customer','all_sales_finished','$product_details._id','Finished\x20Goods','</thead>','$customers_docs','$product_details.batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$product_details.type','3110NwkETd','<h5\x20style=\x22text-align:\x20left;\x22>','edit_sales_finished_view','\x20==\x20','batch_code','params','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','<strong>\x20Regards\x20</strong>','Error\x20Occurs','Hindi','secondary_unit','$product_details.secondary_unit','errors','back','secondary_code','product_details','level2','warehouse','$product_details.product_cat','32ISxBNE','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','level','save','getDate','product_date','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','quantity','maxperunit','agent_id','</div>','$date','sales_invoice','amount','aggregate','Spanish','primary_code_QA','return_sale_finished','/invoice/:id','<hr\x20class=\x22my-3\x22>','filter','maxPerUnit','\x20&&\x20','3pMsxtg','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','sales_quantity','$product_details.maxProducts','valueOf','getFullYear','barcode\x20user_id','True','<span\x20style=\x22float:\x20right;\x22>','/all_sales_finished/preview/','$product_details.floorlevel','</td>','then','finalize','English','user','1096PeXWmF','../middleware/auth','received_amount','700416ZNVdqC','Logo.png','$sale_product.type','log','\x20Order\x20Date\x20:\x20','/preview/:id','maxPerUnit_QA','split','Sale\x20Return','</tbody>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','payment\x20successfull','$invoice','redirect','purchases_data','$sale_product.quantity','primary_unit','currency','$product_details.unit','sendMail','Enabled','findOne','$sale_product.bin','all_sales_barcode','$product_details.bay','$product_details.uuid','$finalize','</span>','adjust_qty','toString','findById','/all_sales_finished/view','sales\x20item\x20return\x20successfull','48vsyBTM','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','id_transaction_from','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','get','$product_details.sales_category','production_date_QA','/view/return_sales/:id','message','body','OUT-','undefined','German','product_data','French','image','success','<h2>\x20','sale_qty','/view_log','carton','</body></html>','1853080aPHhnW','unit','foreach\x20newproduct','due_amount','length','outgoing_invoice','</table>','$_id','product_code','Received\x20Payment\x20For\x20Sale','$sale_product','sales_quantity_QA','Email\x20sent\x20successfully','return_sale','9ruhkCi','RoomAssigned','Portuguese','getMonth','English\x20(US)','</tr>','express','post','status','$product_details.level','<table\x20style=\x22width:\x20100%\x20!important;\x22>','render','expiry_date_QA','\x20Order\x20Number\x20:\x20','Arabic\x20(ae)','max_per_unit','$product_details.storage','map','$product_details.product_name','logo','391702RgDxrE','<tbody\x20style=\x22text-align:\x20center;\x22>','<tr>','$product_details.room_name','$product_details.primary_code','production_date','121821ekSxKX','154451eBijhz','expiry_date','here','catch','invoice','gross_price','exports','$product_details.secondary_code','find','$product_details.expiry_date','prod_invoice','slice','$product_details.product_code','invoice_init','/barcode/:id','add_sales_finished_logs','stock','Return\x20Goods','$product_details.rack','/view/add_sales','warehouse_name','</head><body>','int','Arabic','/view/add_sales/:id','$note','concat','room_name','customer','return_sale_QA','Sale\x20Return\x20Mail','$product_details.bin','return_qty','room','$return_data','$product_details','Ambient','add\x20post','$warehouse_name','$product_details.gross_price','<div>','match','secondary_unit_QA','site_title','random','$name','$product_details.type_products','../models/all_models','Quality\x20Inspection','$product','Sales\x20Update\x20successfully','abs','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','prod_code','OUTF-'];a0_0x4a25=function(){return _0x511eeb;};return a0_0x4a25();}async function dataUpdate(_0x18fada,_0x5d585f,_0x1a7ee1){var _0x508d0f=a0_0x3524eb;return await warehouse['updateOne']({'_id':_0x18fada,'product_details._id':_0x5d585f},{'$set':{'product_details.$.product_stock':_0x1a7ee1}}),await warehouse[_0x508d0f(0x29d)](_0x18fada);}router['post']('/preview/:id',auth,async(_0x3d8a18,_0x38d731)=>{var _0x5bba00=a0_0x3524eb;try{const _0x115c82=_0x3d8a18[_0x5bba00(0x247)]['id'],{invoice:_0x3193da,warehouse_name:_0x5860e3,room:_0x1dce2e}=_0x3d8a18[_0x5bba00(0x2aa)],_0x9ade62=await sales_finished['findOne']({'invoice':_0x3193da});for(let _0x4a4b35=0x0;_0x4a4b35<=_0x9ade62[_0x5bba00(0x231)][_0x5bba00(0x191)]-0x1;_0x4a4b35++){const _0x1668f7=_0x9ade62[_0x5bba00(0x231)][_0x4a4b35];var _0x4553c4=await warehouse[_0x5bba00(0x294)]({'name':_0x5860e3,'room':_0x1668f7[_0x5bba00(0x1d1)]}),_0x1ab949=0x0;for(let _0x1abbf7=0x0;_0x1abbf7<=_0x4553c4[_0x5bba00(0x251)]['length']-0x1;_0x1abbf7++){const _0x2922e3=_0x4553c4['product_details'][_0x1abbf7];_0x2922e3[_0x5bba00(0x1fb)]==_0x1668f7[_0x5bba00(0x2a3)]&&_0x2922e3[_0x5bba00(0x21c)]==_0x1668f7['uuid']&&(_0x1ab949=Math['max'](0x0,Math[_0x5bba00(0x1e9)](_0x2922e3['product_stock'])-Math[_0x5bba00(0x1e9)](_0x1668f7[_0x5bba00(0x25c)])),await warehouse['updateOne']({'_id':_0x4553c4[_0x5bba00(0x1fb)][_0x5bba00(0x270)](),'product_details._id':_0x2922e3['_id']['valueOf'](),'product_details.uuid':_0x1668f7[_0x5bba00(0x21c)]},{'$set':{'product_details.$.product_stock':_0x1ab949}}));}console['log'](typeof _0x1668f7[_0x5bba00(0x25e)]);if(typeof _0x1668f7[_0x5bba00(0x25e)]!==_0x5bba00(0x2ac)){var _0x240a9a=await staff[_0x5bba00(0x29d)](_0x1668f7[_0x5bba00(0x25e)]);console[_0x5bba00(0x282)](_0x5bba00(0x1b8));var _0x29e693=0x0;for(let _0x1262ef=0x0;_0x1262ef<=_0x240a9a[_0x5bba00(0x224)]['length']-0x1;_0x1262ef++){const _0x4cdd5f=_0x240a9a[_0x5bba00(0x224)][_0x1262ef];console[_0x5bba00(0x282)](_0x1668f7[_0x5bba00(0x2a3)]+_0x5bba00(0x245)+_0x4cdd5f[_0x5bba00(0x204)]+_0x5bba00(0x26b)+_0x1668f7[_0x5bba00(0x1fb)]+_0x5bba00(0x245)+_0x1668f7[_0x5bba00(0x1fb)]),_0x1668f7[_0x5bba00(0x2a3)]==_0x4cdd5f[_0x5bba00(0x204)]&&_0x1668f7['_id']==0x1&&(_0x4cdd5f['product_stock']=Math[_0x5bba00(0x1e9)](_0x4cdd5f['product_stock'])+Math[_0x5bba00(0x1e9)](_0x1668f7[_0x5bba00(0x25c)]),_0x29e693++);}console[_0x5bba00(0x282)](_0x5bba00(0x1cc),_0x29e693),_0x29e693=='0'&&(_0x240a9a[_0x5bba00(0x224)]=_0x240a9a[_0x5bba00(0x224)][_0x5bba00(0x1d0)]({'product_name':_0x1668f7[_0x5bba00(0x235)],'product_stock':_0x1668f7[_0x5bba00(0x25c)],'bay':_0x1668f7['bay'],'level':_0x1668f7[_0x5bba00(0x257)],'product_code':_0x1668f7['product_code'],'primary_code':_0x1668f7[_0x5bba00(0x202)],'secondary_code':_0x1668f7[_0x5bba00(0x250)],'expiry_date':_0x1668f7[_0x5bba00(0x1b7)],'production_date':_0x1668f7[_0x5bba00(0x1b4)],'maxProducts':_0x1668f7[_0x5bba00(0x1f2)],'batch_code':_0x1668f7[_0x5bba00(0x246)],'secondary_unit':_0x1668f7[_0x5bba00(0x24c)],'unit':_0x1668f7[_0x5bba00(0x18e)],'maxProducts':_0x1668f7[_0x5bba00(0x1f2)],'maxPerUnit':_0x1668f7[_0x5bba00(0x25d)],'invoice':_0x1668f7['invoice'],'warehouse_id':_0x1668f7[_0x5bba00(0x2a3)],'id_incoming':_0x1668f7[_0x5bba00(0x1fb)],'uuid':_0x1668f7[_0x5bba00(0x21c)],'gross_price':_0x1668f7['gross_price'],'date_incoming':_0x1668f7['date_data'],'outgoing_invoice':_0x1668f7[_0x5bba00(0x192)]}),await _0x240a9a['save']());}}_0x9ade62[_0x5bba00(0x279)]='True';const _0x557bb5=await _0x9ade62[_0x5bba00(0x258)](),_0xbf50cf=await master_shop[_0x5bba00(0x1be)](),_0x8f824e=await email_settings['findOne'](),_0x16129c=await supervisor_settings[_0x5bba00(0x1be)]();var _0x3a98f2=_0x9ade62[_0x5bba00(0x231)],_0x31df33='',_0x8bd8b3;for(_0x8bd8b3 in _0x3a98f2){_0x31df33+=_0x5bba00(0x1b1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3a98f2[_0x8bd8b3]['product_name']+_0x5bba00(0x277)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3a98f2[_0x8bd8b3]['product_code']+'</td>'+_0x5bba00(0x2a1)+_0x3a98f2[_0x8bd8b3]['quantity']+_0x5bba00(0x277)+_0x5bba00(0x2a1)+_0x3a98f2[_0x8bd8b3]['unit']+_0x5bba00(0x277)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3a98f2[_0x8bd8b3][_0x5bba00(0x24c)]+_0x5bba00(0x277)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9ade62['warehouse_name']+_0x5bba00(0x277)+_0x5bba00(0x2a1)+_0x3a98f2[_0x8bd8b3][_0x5bba00(0x1d1)]+'</td>'+_0x5bba00(0x2a1)+_0x3a98f2[_0x8bd8b3][_0x5bba00(0x1f9)]+'</td>';}_0x3d8a18[_0x5bba00(0x220)]('success',_0x5bba00(0x1e8)),_0x38d731[_0x5bba00(0x28c)]('/picking_list/pdf/'+_0x115c82);}catch(_0x5cec58){console['log'](_0x5cec58);}}),router['get'](a0_0x3524eb(0x22d),auth,async(_0x25bcae,_0x57144b)=>{var _0x2b6f6f=a0_0x3524eb;try{const {username:_0x4fd93c,email:_0x3f63bc,role:_0xa87814}=_0x25bcae[_0x2b6f6f(0x27b)],_0x12fb8a=_0x25bcae[_0x2b6f6f(0x27b)],_0x45aa2f=await profile[_0x2b6f6f(0x294)]({'email':_0x12fb8a['email']}),_0x5360b8=await master_shop['find'](),_0x4435f6=_0x25bcae[_0x2b6f6f(0x247)]['id'],_0x3b91e4=await sales_finished[_0x2b6f6f(0x29d)](_0x4435f6);let _0x10980a=new Date(_0x3b91e4[_0x2b6f6f(0x1b7)]),_0xe18476=('0'+_0x10980a[_0x2b6f6f(0x259)]())[_0x2b6f6f(0x1c1)](-0x2),_0x5396a7=('0'+(_0x10980a[_0x2b6f6f(0x19e)]()+0x1))[_0x2b6f6f(0x1c1)](-0x2),_0x2a2ca7=_0x10980a[_0x2b6f6f(0x271)](),_0x4d9eda=_0x2a2ca7+'-'+_0x5396a7+'-'+_0xe18476;var _0xc13d9d=[_0x2b6f6f(0x1da),_0x2b6f6f(0x228)];const _0x14eb39=await warehouse['aggregate']([{'$match':{'name':_0x3b91e4[_0x2b6f6f(0x1ca)],'room':_0x3b91e4[_0x2b6f6f(0x1d7)]}},{'$unwind':_0x2b6f6f(0x1d9)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2b6f6f(0x1ad)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2b6f6f(0x297)},'bin':{'$first':_0x2b6f6f(0x1d5)},'type':{'$first':_0x2b6f6f(0x241)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2b6f6f(0x1ab)},'rack':{'$first':_0x2b6f6f(0x1c8)}}}]),_0x43a7c0=await customer[_0x2b6f6f(0x1be)]({});let _0x731cd8;if(_0x12fb8a[_0x2b6f6f(0x1f7)]==_0x2b6f6f(0x1fd)){const _0x43bd06=await staff[_0x2b6f6f(0x294)]({'email':_0x12fb8a[_0x2b6f6f(0x1f0)]});_0x731cd8=await warehouse[_0x2b6f6f(0x263)]([{'$match':{'status':_0x2b6f6f(0x293),'name':_0x43bd06['warehouse']}},{'$group':{'_id':_0x2b6f6f(0x1e3),'name':{'$first':_0x2b6f6f(0x1e3)}}}]);}else _0x731cd8=await warehouse['aggregate']([{'$match':{'status':_0x2b6f6f(0x293)}},{'$group':{'_id':_0x2b6f6f(0x1e3),'name':{'$first':_0x2b6f6f(0x1e3)}}}]);const _0x37a07e=await product['find']({});if(_0x5360b8[0x0][_0x2b6f6f(0x226)]=='English\x20(US)'){var _0x55dbda=users[_0x2b6f6f(0x27a)];console[_0x2b6f6f(0x282)](_0x55dbda);}else{if(_0x5360b8[0x0][_0x2b6f6f(0x226)]==_0x2b6f6f(0x24b))var _0x55dbda=users[_0x2b6f6f(0x24b)];else{if(_0x5360b8[0x0][_0x2b6f6f(0x226)]==_0x2b6f6f(0x2ad))var _0x55dbda=users['German'];else{if(_0x5360b8[0x0][_0x2b6f6f(0x226)]==_0x2b6f6f(0x264))var _0x55dbda=users[_0x2b6f6f(0x264)];else{if(_0x5360b8[0x0][_0x2b6f6f(0x226)]==_0x2b6f6f(0x2af))var _0x55dbda=users[_0x2b6f6f(0x2af)];else{if(_0x5360b8[0x0][_0x2b6f6f(0x226)]==_0x2b6f6f(0x1fe))var _0x55dbda=users[_0x2b6f6f(0x19d)];else{if(_0x5360b8[0x0][_0x2b6f6f(0x226)]=='Chinese')var _0x55dbda=users[_0x2b6f6f(0x211)];else{if(_0x5360b8[0x0][_0x2b6f6f(0x226)]=='Arabic\x20(ae)')var _0x55dbda=users['Arabic'];}}}}}}}_0x57144b['render'](_0x2b6f6f(0x234),{'success':_0x25bcae[_0x2b6f6f(0x220)](_0x2b6f6f(0x2b1)),'errors':_0x25bcae[_0x2b6f6f(0x220)](_0x2b6f6f(0x24e)),'role':_0x12fb8a,'profile':_0x45aa2f,'customer':_0x43a7c0,'warehouse':_0x731cd8,'product':_0x14eb39,'user':_0x3b91e4,'master_shop':_0x5360b8,'unit':_0x37a07e,'language':_0x55dbda,'rooms_data':_0xc13d9d,'ed_fullDate':_0x4d9eda});}catch(_0x3b6b7f){console['log'](_0x3b6b7f);}}),router[a0_0x3524eb(0x1a2)](a0_0x3524eb(0x22d),auth,async(_0x515e76,_0xcf2630)=>{var _0x4c9673=a0_0x3524eb;try{const _0x5dd0a6=_0x515e76[_0x4c9673(0x247)]['id'],_0x3dd399=await sales_finished['findOne']({'_id':_0x515e76[_0x4c9673(0x247)]['id']}),_0x1f3003=await warehouse['findOne']({'name':_0x3dd399[_0x4c9673(0x1ca)],'room':_0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x1d7)],'warehouse_category':_0x4c9673(0x23a)}),{invoice:_0xdfe7c2,customer:_0x418a8b,date:_0x4045eb,warehouse_name:_0x4a2684,product_name:_0x2a0d43,stock:_0x515afd,adjust_qty:_0x2934aa,note:_0x5c7e5c,room:_0x3d0d26,primary_code:_0x428eb6,secondary_code:_0x5f2901,prod_code:_0x4c499e,level:_0x1c8c51,isle:_0x5aeb88,pallet:_0x69e960,expiry_date:_0xaa0558}=_0x515e76['body'];if(typeof _0x2a0d43=='string')var _0x5d7f05=[_0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x235)]],_0x15656c=[_0x515e76['body'][_0x4c9673(0x1c6)]],_0x3c8234=[_0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x29b)]],_0x1ac4d6=[_0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x202)]],_0x15d86c=[_0x515e76[_0x4c9673(0x2aa)]['secondary_code']],_0x2f97e4=[_0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x1eb)]],_0x211822=[_0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x257)]],_0xdfb13a=[_0x515e76['body'][_0x4c9673(0x1b7)]];else var _0x5d7f05=[..._0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x235)]],_0x15656c=[..._0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x1c6)]],_0x3c8234=[..._0x515e76['body']['adjust_qty']],_0x1ac4d6=[..._0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x202)]],_0x15d86c=[..._0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x250)]],_0x2f97e4=[..._0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x1eb)]],_0x211822=[..._0x515e76['body']['level']],_0xdfb13a=[..._0x515e76[_0x4c9673(0x2aa)]['expiry_date']];const _0x139494=_0x5d7f05[_0x4c9673(0x1ac)](_0xc12547=>{return _0xc12547={'product_name':_0xc12547};});_0x15656c[_0x4c9673(0x219)]((_0x42370b,_0x215ee4)=>{var _0x3f0ebb=_0x4c9673;_0x139494[_0x215ee4][_0x3f0ebb(0x1c6)]=_0x42370b;}),_0x3c8234['forEach']((_0x2dc118,_0x596d2b)=>{var _0x591d40=_0x4c9673;_0x139494[_0x596d2b][_0x591d40(0x25c)]=_0x2dc118;}),_0x1ac4d6['forEach']((_0x2a4ae2,_0x282648)=>{_0x139494[_0x282648]['primary_code']=_0x2a4ae2;}),_0x15d86c[_0x4c9673(0x219)]((_0x5f564c,_0x2fc68f)=>{var _0x1c5680=_0x4c9673;_0x139494[_0x2fc68f][_0x1c5680(0x250)]=_0x5f564c;}),_0x2f97e4[_0x4c9673(0x219)]((_0x58d1b0,_0x5d34c3)=>{var _0x20537d=_0x4c9673;_0x139494[_0x5d34c3][_0x20537d(0x195)]=_0x58d1b0;}),_0x211822[_0x4c9673(0x219)]((_0x31c627,_0x50c4e5)=>{var _0x4ac27c=_0x4c9673;_0x139494[_0x50c4e5][_0x4ac27c(0x257)]=_0x31c627;}),_0xdfb13a[_0x4c9673(0x219)]((_0x200bd1,_0x578255)=>{var _0x105b08=_0x4c9673;_0x139494[_0x578255][_0x105b08(0x1b7)]=_0x200bd1;});var _0x1abbe0=0x0;_0x139494['forEach'](_0x1451e9=>{var _0x569882=_0x4c9673;console['log'](_0x569882(0x18f),_0x1451e9),(parseInt(_0x1451e9[_0x569882(0x1c6)])<parseInt(_0x1451e9['quantity'])||parseInt(_0x1451e9[_0x569882(0x25c)])==0x0)&&_0x1abbe0++;});if(_0x1abbe0!=0x0)return _0x515e76[_0x4c9673(0x220)](_0x4c9673(0x24e),_0x4c9673(0x248)),_0xcf2630[_0x4c9673(0x28c)]('back');_0x3dd399['sale_product']['forEach'](_0x1f44ed=>{var _0x562d13=_0x4c9673;const _0x57543e=_0x1f3003['product_details'][_0x562d13(0x1ac)](_0x1afbb1=>{var _0x4576b5=_0x562d13;_0x1afbb1[_0x4576b5(0x235)]==_0x1f44ed[_0x4576b5(0x235)]&&_0x1afbb1[_0x4576b5(0x1f9)]==_0x1f44ed['bay']&&(_0x1afbb1[_0x4576b5(0x22b)]=parseInt(_0x1afbb1[_0x4576b5(0x22b)])+parseInt(_0x1f44ed[_0x4576b5(0x25c)]));});}),await _0x1f3003[_0x4c9673(0x258)]();const _0xf883f4=_0x139494[_0x4c9673(0x269)](_0x3f549b=>_0x3f549b[_0x4c9673(0x25c)]!=='0'&&_0x3f549b[_0x4c9673(0x25c)]!=='');_0x3dd399[_0x4c9673(0x1ba)]=_0xdfe7c2,_0x3dd399[_0x4c9673(0x1d2)]=_0x418a8b,_0x3dd399[_0x4c9673(0x22a)]=_0x4045eb,_0x3dd399[_0x4c9673(0x1ca)]=_0x4a2684,_0x3dd399[_0x4c9673(0x231)]=_0xf883f4,_0x3dd399['note']=_0x5c7e5c,_0x3dd399['room']=_0x3d0d26;const _0x4f3e8d=await _0x3dd399[_0x4c9673(0x258)](),_0x522ba0=await sales_finished[_0x4c9673(0x294)]({'_id':_0x515e76[_0x4c9673(0x247)]['id']}),_0x38b3a2=await warehouse[_0x4c9673(0x294)]({'name':_0x4a2684,'room':_0x3d0d26,'warehouse_category':'Finished\x20Goods'});_0x522ba0[_0x4c9673(0x231)]['forEach'](_0x465c77=>{var _0x52c6b7=_0x4c9673;const _0x26fdc7=_0x38b3a2['product_details'][_0x52c6b7(0x1ac)](_0x12618a=>{var _0x2844aa=_0x52c6b7;_0x12618a[_0x2844aa(0x235)]==_0x465c77[_0x2844aa(0x235)]&&_0x12618a['bay']==_0x465c77[_0x2844aa(0x1f9)]&&(_0x12618a[_0x2844aa(0x22b)]=parseInt(_0x12618a[_0x2844aa(0x22b)])-parseInt(_0x465c77[_0x2844aa(0x25c)]));});}),console['log'](_0x4c9673(0x20e),_0x38b3a2),await _0x38b3a2['save']();const _0xe87864=await c_payment_data[_0x4c9673(0x294)]({'invoice':_0x515e76[_0x4c9673(0x2aa)][_0x4c9673(0x1ba)]});_0xe87864[_0x4c9673(0x212)]=_0x515e76['body'][_0x4c9673(0x212)],await _0xe87864[_0x4c9673(0x258)](),_0x515e76[_0x4c9673(0x220)]('success',_0x4c9673(0x1e8)),_0xcf2630[_0x4c9673(0x28c)]('/all_sales_finished/view');}catch(_0x2bae6b){console[_0x4c9673(0x282)](_0x2bae6b);}}),router[a0_0x3524eb(0x1a2)]('/give_payment/:id',auth,async(_0x8166cc,_0x44248c)=>{var _0x4d8583=a0_0x3524eb;try{const _0x24f643=_0x8166cc[_0x4d8583(0x247)]['id'],{invoice:_0xe212cd,customer:_0xc34f9,receivable_amount:_0x7dca71,received_amount:_0x408883}=_0x8166cc[_0x4d8583(0x2aa)],_0x559d2f=await sales[_0x4d8583(0x29d)](_0x24f643);console['log'](_0x559d2f);var _0x86c74e=_0x7dca71-_0x408883;console['log'](_0x408883),_0x559d2f[_0x4d8583(0x27e)]=parseFloat(_0x408883)+parseFloat(_0x559d2f[_0x4d8583(0x27e)]),_0x559d2f[_0x4d8583(0x190)]=_0x86c74e,console[_0x4d8583(0x282)](_0x559d2f);const _0x3fe49e=await _0x559d2f['save'](),_0x128285=await c_payment_data['findOne']({'invoice':_0xe212cd});_0x128285[_0x4d8583(0x262)]=_0x86c74e,await _0x128285[_0x4d8583(0x258)]();let _0x7ac1=new Date(),_0x12329a=('0'+_0x7ac1['getDate']())[_0x4d8583(0x1c1)](-0x2),_0x4d32b5=('0'+(_0x7ac1[_0x4d8583(0x19e)]()+0x1))[_0x4d8583(0x1c1)](-0x2),_0x1778ab=_0x7ac1['getFullYear'](),_0x42f264=_0x1778ab+'-'+_0x4d32b5+'-'+_0x12329a;const _0x23bd99=new customer_payment({'invoice':_0xe212cd,'date':_0x1778ab+'-'+_0x4d32b5+'-'+_0x12329a,'customer':_0xc34f9,'reason':_0x4d8583(0x196),'amount':_0x408883}),_0x53d7ad=await _0x23bd99[_0x4d8583(0x258)]();_0x8166cc['flash'](_0x4d8583(0x2b1),_0x4d8583(0x28a)),_0x44248c[_0x4d8583(0x28c)](_0x4d8583(0x215));}catch(_0x55a95b){console[_0x4d8583(0x282)](_0x55a95b);}}),router['get'](a0_0x3524eb(0x267),auth,async(_0x46dcd4,_0x45d398)=>{var _0x43deed=a0_0x3524eb;try{const {username:_0x3985c8,email:_0x501276,role:_0x4a2835}=_0x46dcd4[_0x43deed(0x27b)],_0x4f38d2=_0x46dcd4[_0x43deed(0x27b)],_0x4acb83=await profile[_0x43deed(0x294)]({'email':_0x4f38d2[_0x43deed(0x1f0)]}),_0x58d64d=await master_shop[_0x43deed(0x1be)]();console['log'](_0x43deed(0x1ff),_0x58d64d);const _0x51ce87=_0x46dcd4[_0x43deed(0x247)]['id'],_0x32549d=await sales[_0x43deed(0x29d)](_0x51ce87);console[_0x43deed(0x282)](_0x32549d);const _0x36ed28=await customer[_0x43deed(0x294)]({'name':_0x32549d[_0x43deed(0x1d2)]});console[_0x43deed(0x282)](_0x36ed28);if(_0x58d64d[0x0][_0x43deed(0x226)]==_0x43deed(0x19f)){var _0x123d36=users[_0x43deed(0x27a)];console[_0x43deed(0x282)](_0x123d36);}else{if(_0x58d64d[0x0]['language']==_0x43deed(0x24b))var _0x123d36=users[_0x43deed(0x24b)];else{if(_0x58d64d[0x0][_0x43deed(0x226)]==_0x43deed(0x2ad))var _0x123d36=users['German'];else{if(_0x58d64d[0x0][_0x43deed(0x226)]==_0x43deed(0x264))var _0x123d36=users[_0x43deed(0x264)];else{if(_0x58d64d[0x0][_0x43deed(0x226)]==_0x43deed(0x2af))var _0x123d36=users[_0x43deed(0x2af)];else{if(_0x58d64d[0x0]['language']==_0x43deed(0x1fe))var _0x123d36=users[_0x43deed(0x19d)];else{if(_0x58d64d[0x0][_0x43deed(0x226)]==_0x43deed(0x211))var _0x123d36=users['Chinese'];else{if(_0x58d64d[0x0]['language']=='Arabic\x20(ae)')var _0x123d36=users[_0x43deed(0x1cd)];}}}}}}}_0x45d398[_0x43deed(0x1a6)](_0x43deed(0x261),{'success':_0x46dcd4[_0x43deed(0x220)](_0x43deed(0x2b1)),'errors':_0x46dcd4[_0x43deed(0x220)](_0x43deed(0x24e)),'role':_0x4f38d2,'profile':_0x4acb83,'master_shop':_0x58d64d,'customers':_0x36ed28,'sales':_0x32549d,'language':_0x123d36});}catch(_0x321f7a){console[_0x43deed(0x282)](_0x321f7a);}}),router[a0_0x3524eb(0x2a5)](a0_0x3524eb(0x2a8),auth,async(_0x142da4,_0x4d6b0e)=>{var _0x1ea7b0=a0_0x3524eb;try{const {username:_0x51b91b,email:_0x1c5d9d,role:_0x587be1}=_0x142da4[_0x1ea7b0(0x27b)],_0x2338ab=_0x142da4[_0x1ea7b0(0x27b)],_0x21a026=await profile['findOne']({'email':_0x2338ab[_0x1ea7b0(0x1f0)]}),_0x354e95=await master_shop[_0x1ea7b0(0x1be)](),_0x852576=_0x142da4['params']['id'],_0x48d28f=await sales_finished[_0x1ea7b0(0x29d)](_0x852576),_0x1bb05a=await warehouse[_0x1ea7b0(0x263)]([{'$match':{'name':_0x48d28f[_0x1ea7b0(0x1ca)]}},{'$unwind':_0x1ea7b0(0x1d9)},{'$group':{'_id':_0x1ea7b0(0x239),'name':{'$first':_0x1ea7b0(0x1ad)},'product_stock':{'$first':_0x1ea7b0(0x1ef)},'bay':{'$first':_0x1ea7b0(0x297)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1ea7b0(0x276)},'primary_code':{'$first':_0x1ea7b0(0x1b3)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1ea7b0(0x1c2)},'storage':{'$first':_0x1ea7b0(0x1ab)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1ea7b0(0x1bf)},'production_date':{'$first':_0x1ea7b0(0x217)},'unit':{'$first':_0x1ea7b0(0x291)},'secondary_unit':{'$first':_0x1ea7b0(0x24d)},'maxProducts':{'$first':_0x1ea7b0(0x26f)},'batch_code':{'$first':_0x1ea7b0(0x23d)},'maxPerUnit':{'$first':_0x1ea7b0(0x205)}}}]),_0x3f0832=await product[_0x1ea7b0(0x1be)]({}),_0x215493=await warehouse[_0x1ea7b0(0x263)]([{'$match':{'status':_0x1ea7b0(0x293),'warehouse_category':_0x1ea7b0(0x23a),'name':{'$ne':_0x1ea7b0(0x1c7),'$ne':_0x1ea7b0(0x1e6)}}},{'$group':{'_id':_0x1ea7b0(0x1e3),'name':{'$first':_0x1ea7b0(0x1e3)}}},{'$sort':{'name':0x1}}]);var _0x1af22f=['Return\x20Rooms'];const _0x4e2950=await warehouse[_0x1ea7b0(0x263)]([{'$match':{'status':'Enabled','name':_0x1ea7b0(0x1e6)}},{'$group':{'_id':_0x1ea7b0(0x1e3),'name':{'$first':_0x1ea7b0(0x1e3)}}},{'$sort':{'name':0x1}}]);if(_0x354e95[0x0][_0x1ea7b0(0x226)]=='English\x20(US)'){var _0x41d3ed=users[_0x1ea7b0(0x27a)];console[_0x1ea7b0(0x282)](_0x41d3ed);}else{if(_0x354e95[0x0][_0x1ea7b0(0x226)]=='Hindi')var _0x41d3ed=users['Hindi'];else{if(_0x354e95[0x0]['language']==_0x1ea7b0(0x2ad))var _0x41d3ed=users['German'];else{if(_0x354e95[0x0]['language']==_0x1ea7b0(0x264))var _0x41d3ed=users['Spanish'];else{if(_0x354e95[0x0][_0x1ea7b0(0x226)]==_0x1ea7b0(0x2af))var _0x41d3ed=users[_0x1ea7b0(0x2af)];else{if(_0x354e95[0x0][_0x1ea7b0(0x226)]==_0x1ea7b0(0x1fe))var _0x41d3ed=users[_0x1ea7b0(0x19d)];else{if(_0x354e95[0x0][_0x1ea7b0(0x226)]==_0x1ea7b0(0x211))var _0x41d3ed=users[_0x1ea7b0(0x211)];else{if(_0x354e95[0x0][_0x1ea7b0(0x226)]=='Arabic\x20(ae)')var _0x41d3ed=users[_0x1ea7b0(0x1cd)];}}}}}}}_0x4d6b0e[_0x1ea7b0(0x1a6)](_0x1ea7b0(0x266),{'success':_0x142da4[_0x1ea7b0(0x220)](_0x1ea7b0(0x2b1)),'errors':_0x142da4[_0x1ea7b0(0x220)](_0x1ea7b0(0x24e)),'role':_0x2338ab,'profile':_0x21a026,'user':_0x48d28f,'stock':_0x1bb05a,'master_shop':_0x354e95,'unit':_0x3f0832,'language':_0x41d3ed,'warehouses':_0x215493,'rooms':_0x1af22f,'warehouse_QA':_0x4e2950});}catch(_0x4a4e3a){console[_0x1ea7b0(0x282)](_0x4a4e3a),_0x4d6b0e['status'](0xc8)[_0x1ea7b0(0x233)]({'message':_0x4a4e3a[_0x1ea7b0(0x2a9)]});}}),router[a0_0x3524eb(0x1a2)](a0_0x3524eb(0x2a8),auth,async(_0x3b3168,_0x314a35)=>{var _0x281d31=a0_0x3524eb;if(_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1f1)]=='QA')try{const {invoice:_0x1279c7,date:_0x237a3c,warehouse_name:_0x54c22d,product_name:_0x4a4f94,primary_code:_0x5c0819,secondary_code:_0x5451a7,product_code:_0x3bc024,sales_quantity:_0x5b84ad,stocks:_0x281c60,return_qty:_0x525f12,Room_name:_0x1772b4,to_warehouse_name_QA:_0x2f31d3,to_Room_name_QA:_0x5bce2b,note:_0x189a47,for_categorize:_0x5cb2d8,product_name_QA1:_0x252cad}=_0x3b3168[_0x281d31(0x2aa)];if(typeof _0x252cad==_0x281d31(0x1ee))var _0x378ca1=[_0x3b3168['body'][_0x281d31(0x22e)]],_0x55b608=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x265)]],_0x1332cd=[_0x3b3168['body'][_0x281d31(0x200)]],_0x4b8d44=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x216)]],_0x5c730f=[_0x3b3168['body'][_0x281d31(0x198)]],_0x5caf32=[_0x3b3168['body']['stocks_QA']],_0x3a6021=[_0x3b3168[_0x281d31(0x2aa)]['return_qty_QA']],_0x550343=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x285)]],_0x4b291a=[_0x3b3168[_0x281d31(0x2aa)]['maxProducts_QA']],_0x2e1e9f=[_0x3b3168[_0x281d31(0x2aa)]['batch_code_QA']],_0x1a8f19=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1e0)]],_0x41e99c=[_0x3b3168['body'][_0x281d31(0x218)]],_0x5343d3=[_0x3b3168['body'][_0x281d31(0x2a7)]],_0x5eead6=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1a7)]];else var _0x378ca1=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x22e)]],_0x55b608=[..._0x3b3168[_0x281d31(0x2aa)]['primary_code_QA']],_0x1332cd=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x200)]],_0x4b8d44=[..._0x3b3168[_0x281d31(0x2aa)]['product_code_QA']],_0x5c730f=[..._0x3b3168[_0x281d31(0x2aa)]['sales_quantity_QA']],_0x5caf32=[..._0x3b3168['body']['stocks_QA']],_0x3a6021=[..._0x3b3168['body']['return_qty_QA']],_0x550343=[..._0x3b3168[_0x281d31(0x2aa)]['maxPerUnit_QA']],_0x4b291a=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x21b)]],_0x2e1e9f=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x21a)]],_0x1a8f19=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1e0)]],_0x41e99c=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x218)]],_0x5343d3=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x2a7)]],_0x5eead6=[..._0x3b3168['body']['expiry_date_QA']];const _0x16178e=_0x378ca1[_0x281d31(0x1ac)](_0x7ec5b0=>{return _0x7ec5b0={'product_name':_0x7ec5b0};});_0x55b608[_0x281d31(0x219)]((_0x5b8dc5,_0x5d3721)=>{var _0x3a3cc4=_0x281d31;_0x16178e[_0x5d3721][_0x3a3cc4(0x202)]=_0x5b8dc5;}),_0x1332cd[_0x281d31(0x219)]((_0xd0499,_0x8143a3)=>{var _0x1d8e9e=_0x281d31;_0x16178e[_0x8143a3][_0x1d8e9e(0x250)]=_0xd0499;}),_0x4b8d44[_0x281d31(0x219)]((_0x4b7575,_0xf416ee)=>{_0x16178e[_0xf416ee]['product_code']=_0x4b7575;}),_0x5c730f[_0x281d31(0x219)]((_0x25a260,_0x3629c9)=>{var _0xcf1dd2=_0x281d31;_0x16178e[_0x3629c9][_0xcf1dd2(0x2b3)]=_0x25a260;}),_0x5caf32['forEach']((_0x25e258,_0xcee193)=>{var _0x28d744=_0x281d31;_0x16178e[_0xcee193][_0x28d744(0x1c6)]=_0x25e258;}),_0x3a6021[_0x281d31(0x219)]((_0x4c4d0d,_0x420594)=>{_0x16178e[_0x420594]['return_qty']=_0x4c4d0d;}),_0x550343[_0x281d31(0x219)]((_0x3c4be2,_0x4dda74)=>{var _0x207164=_0x281d31;_0x16178e[_0x4dda74][_0x207164(0x26a)]=_0x3c4be2;}),_0x4b291a[_0x281d31(0x219)]((_0x529edc,_0x4dc604)=>{var _0x3d474f=_0x281d31;_0x16178e[_0x4dc604][_0x3d474f(0x1f2)]=_0x529edc;}),_0x2e1e9f['forEach']((_0x4db119,_0x48260b)=>{var _0x42c075=_0x281d31;_0x16178e[_0x48260b][_0x42c075(0x246)]=_0x4db119;}),_0x1a8f19[_0x281d31(0x219)]((_0x59f0b5,_0x519068)=>{var _0x2c0e5f=_0x281d31;_0x16178e[_0x519068][_0x2c0e5f(0x24c)]=_0x59f0b5;}),_0x41e99c[_0x281d31(0x219)]((_0x4c6f2f,_0x3d3f98)=>{var _0x4e0d41=_0x281d31;_0x16178e[_0x3d3f98][_0x4e0d41(0x18e)]=_0x4c6f2f;}),_0x5343d3[_0x281d31(0x219)]((_0x399c35,_0x21929a)=>{var _0x482ea7=_0x281d31;_0x16178e[_0x21929a][_0x482ea7(0x1b4)]=_0x399c35;}),_0x5eead6[_0x281d31(0x219)]((_0x1727ce,_0x4da438)=>{var _0x274670=_0x281d31;_0x16178e[_0x4da438][_0x274670(0x1b7)]=_0x1727ce;});const _0x29dbd8=await sales_finished[_0x281d31(0x294)]({'invoice':_0x1279c7});_0x29dbd8['return_data']='True';const _0x1c4f14=await _0x29dbd8['save'](),_0x2ca048=new sales_return_finished({'invoice':_0x1279c7,'customer':_0x3b3168['body'][_0x281d31(0x1d2)],'date':_0x237a3c,'warehouse_name':_0x54c22d,'room':_0x1772b4,'ToWarehouse':_0x2f31d3,'ToRoom':_0x5bce2b,'return_sale_QA':_0x16178e,'note':_0x189a47,'warehouse_cat':_0x5cb2d8}),_0x94ddb9=await _0x2ca048[_0x281d31(0x258)](),_0x411af0=await sales_return_finished[_0x281d31(0x294)]({'invoice':_0x1279c7}),_0x3dbe48=await warehouse[_0x281d31(0x294)]({'name':_0x2f31d3,'room':_0x5bce2b});_0x411af0[_0x281d31(0x1d3)][_0x281d31(0x219)](_0x11840a=>{var _0x12a302=_0x281d31,_0x21f2cb=0x0;const _0x44c36d=_0x3dbe48[_0x12a302(0x251)]['map'](_0x308abe=>{var _0x5c7b77=_0x12a302;_0x308abe['product_name']==_0x11840a[_0x5c7b77(0x235)]&&_0x308abe['expiry_date']==_0x11840a[_0x5c7b77(0x1b7)]&&_0x308abe['production_date']==_0x11840a[_0x5c7b77(0x1b4)]&&_0x308abe[_0x5c7b77(0x246)]==_0x11840a[_0x5c7b77(0x246)]&&(_0x308abe[_0x5c7b77(0x22b)]=parseInt(_0x308abe['product_stock'])+parseInt(_0x11840a[_0x5c7b77(0x1d6)]),_0x21f2cb++);});_0x21f2cb=='0'&&(_0x3dbe48[_0x12a302(0x251)]=_0x3dbe48['product_details']['concat']({'product_name':_0x11840a[_0x12a302(0x235)],'product_stock':_0x11840a[_0x12a302(0x1d6)],'primary_code':_0x11840a[_0x12a302(0x202)],'secondary_code':_0x11840a['secondary_code'],'product_code':_0x11840a[_0x12a302(0x195)],'batch_code':_0x11840a[_0x12a302(0x246)],'maxPerUnit':_0x11840a['maxPerUnit'],'production_date':_0x11840a[_0x12a302(0x1b4)],'expiry_date':_0x11840a[_0x12a302(0x1b7)],'secondary_unit':_0x11840a[_0x12a302(0x24c)],'unit':_0x11840a[_0x12a302(0x18e)],'maxProducts':_0x11840a[_0x12a302(0x1f2)],'bay':_0x11840a['bay']}));}),await _0x3dbe48[_0x281d31(0x258)]();const _0x5425ac=new c_payment_data({'invoice':_0x1279c7,'customer':_0x3b3168['body'][_0x281d31(0x1d2)],'reason':_0x281d31(0x287)});await _0x5425ac[_0x281d31(0x258)]();const _0x3a6ac0=await master_shop[_0x281d31(0x1be)](),_0x19842c=await email_settings[_0x281d31(0x294)](),_0x5452b9=await customer[_0x281d31(0x294)]({'name':_0x3b3168[_0x281d31(0x2aa)]['customer']});_0x3a6ac0[0x0][_0x281d31(0x1f5)]==0x1?(right_currency=_0x3a6ac0[0x0][_0x281d31(0x290)],left_currency=''):(right_currency='',left_currency=_0x3a6ac0[0x0]['currency']);var _0x1c64e3=_0x378ca1,_0x421466=_0x3a6021,_0x39cea1='',_0x662cd8;for(_0x662cd8 in _0x1c64e3){_0x39cea1+=_0x281d31(0x1b1)+_0x281d31(0x2a1)+_0x1c64e3[_0x662cd8]+_0x281d31(0x277)+_0x281d31(0x2a1)+_0x421466[_0x662cd8]+_0x281d31(0x277)+_0x281d31(0x1a0);}console[_0x281d31(0x282)](_0x281d31(0x224),_0x39cea1);let _0x24ff48=nodemailer['createTransport']({'service':_0x281d31(0x22f),'auth':{'user':_0x19842c[_0x281d31(0x1f0)],'pass':_0x19842c['password']}}),_0x1642fe={'from':_0x19842c[_0x281d31(0x1f0)],'to':_0x5452b9[_0x281d31(0x1f0)],'subject':_0x281d31(0x1d4),'attachments':[{'filename':_0x281d31(0x280),'path':__dirname+_0x281d31(0x23f)+_0x281d31(0x229)+_0x3a6ac0[0x0]['image'],'cid':_0x281d31(0x1ae)}],'html':_0x281d31(0x1f3)+_0x281d31(0x210)+_0x281d31(0x1cb)+'<div>'+_0x281d31(0x26d)+_0x281d31(0x1de)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x281d31(0x25f)+'<div>'+'<h2>\x20'+_0x3a6ac0[0x0][_0x281d31(0x1e1)]+'\x20</h2>'+_0x281d31(0x25f)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x281d31(0x1de)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x281d31(0x1a8)+_0x1279c7+'\x20'+_0x281d31(0x274)+'\x20Order\x20Date\x20:\x20'+_0x237a3c+'\x20'+_0x281d31(0x29a)+_0x281d31(0x203)+'</div>'+_0x281d31(0x1a5)+_0x281d31(0x289)+_0x281d31(0x1b1)+_0x281d31(0x256)+_0x281d31(0x23e)+_0x281d31(0x2a4)+_0x281d31(0x240)+_0x281d31(0x1a0)+_0x281d31(0x23b)+_0x281d31(0x1b0)+'\x20'+_0x39cea1+'\x20'+'</tbody>'+_0x281d31(0x193)+_0x281d31(0x1de)+_0x281d31(0x249)+_0x281d31(0x20d)+_0x3a6ac0[0x0]['site_title']+_0x281d31(0x203)+_0x281d31(0x25f)+'</div>'+_0x281d31(0x18c)};_0x24ff48[_0x281d31(0x292)](_0x1642fe,function(_0x4ab22d,_0x433af9){var _0x32bfb6=_0x281d31;_0x4ab22d?(console[_0x32bfb6(0x282)](_0x4ab22d),console[_0x32bfb6(0x282)]('Error\x20Occurs')):console['log'](_0x32bfb6(0x199));}),_0x3b3168[_0x281d31(0x220)]('success',_0x281d31(0x29f)),_0x314a35[_0x281d31(0x28c)]('/all_sales_finished/view');}catch(_0x2bfe7f){_0x314a35[_0x281d31(0x1a3)](0xc8)[_0x281d31(0x233)]({'message1':_0x2bfe7f[_0x281d31(0x2a9)]});}else{if(_0x3b3168[_0x281d31(0x2aa)]['for_categorize']=='GS')try{const {invoice:_0x15035a,date:_0x24a4f2,warehouse_name:_0x45170f,product_name:_0x2262db,primary_code:_0x1fd34f,secondary_code:_0x2412f0,product_code:_0x425d47,sales_quantity:_0x2392e6,stocks:_0x4303fc,return_qty:_0x17bb73,Room_name:_0x2ac4e6,to_warehouse_name:_0x4dcb2f,to_Room_name:_0xb375ab,note:_0x2d2407,level:_0x331be1,isle:_0x4c8b32,pallet:_0x1fdaff,for_categorize:_0x4fbced}=_0x3b3168[_0x281d31(0x2aa)];if(typeof _0x2262db==_0x281d31(0x1ee))var _0x378ca1=[_0x3b3168['body'][_0x281d31(0x235)]],_0x55b608=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x202)]],_0x1332cd=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x250)]],_0x4b8d44=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x195)]],_0x5c730f=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x26e)]],_0x3a6021=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1d6)]],_0x166252=[_0x3b3168[_0x281d31(0x2aa)]['bay']],_0x550343=[_0x3b3168['body'][_0x281d31(0x26a)]],_0x4b291a=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1f2)]],_0x2e1e9f=[_0x3b3168[_0x281d31(0x2aa)]['batch_code']],_0x1a8f19=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x24c)]],_0x41e99c=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x18e)]],_0x5343d3=[_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1b4)]],_0x5eead6=[_0x3b3168['body'][_0x281d31(0x1b7)]];else var _0x378ca1=[..._0x3b3168['body']['product_name']],_0x55b608=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x202)]],_0x1332cd=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x250)]],_0x4b8d44=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x195)]],_0x5c730f=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x26e)]],_0x3a6021=[..._0x3b3168['body']['return_qty']],_0x166252=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1f9)]],_0x550343=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x26a)]],_0x4b291a=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1f2)]],_0x2e1e9f=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x246)]],_0x1a8f19=[..._0x3b3168['body']['secondary_unit']],_0x41e99c=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x18e)]],_0x5343d3=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1b4)]],_0x5eead6=[..._0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1b7)]];const _0x19a2f8=_0x378ca1['map'](_0x3a8219=>{return _0x3a8219={'product_name':_0x3a8219};});_0x55b608['forEach']((_0x5b0ca0,_0x51530c)=>{var _0x179205=_0x281d31;_0x19a2f8[_0x51530c][_0x179205(0x202)]=_0x5b0ca0;}),_0x1332cd['forEach']((_0x257b38,_0x3e5c46)=>{_0x19a2f8[_0x3e5c46]['secondary_code']=_0x257b38;}),_0x4b8d44['forEach']((_0x4aac70,_0x4e03da)=>{var _0x6309cf=_0x281d31;_0x19a2f8[_0x4e03da][_0x6309cf(0x195)]=_0x4aac70;}),_0x5c730f[_0x281d31(0x219)]((_0x5a1849,_0x4588aa)=>{var _0x486424=_0x281d31;_0x19a2f8[_0x4588aa][_0x486424(0x2b3)]=_0x5a1849;}),_0x3a6021[_0x281d31(0x219)]((_0x440a3a,_0x23365b)=>{var _0x4437fb=_0x281d31;_0x19a2f8[_0x23365b][_0x4437fb(0x1d6)]=_0x440a3a;}),_0x166252[_0x281d31(0x219)]((_0x341664,_0x277df5)=>{var _0xf59dc6=_0x281d31;_0x19a2f8[_0x277df5][_0xf59dc6(0x1f9)]=_0x341664;}),_0x550343[_0x281d31(0x219)]((_0x78528d,_0x3fe098)=>{var _0x1a74fe=_0x281d31;_0x19a2f8[_0x3fe098][_0x1a74fe(0x26a)]=_0x78528d;}),_0x4b291a[_0x281d31(0x219)]((_0x2f599e,_0x2376f0)=>{var _0x47722e=_0x281d31;_0x19a2f8[_0x2376f0][_0x47722e(0x1f2)]=_0x2f599e;}),_0x2e1e9f[_0x281d31(0x219)]((_0x3a8ac3,_0xeeac0d)=>{var _0x38a2e7=_0x281d31;_0x19a2f8[_0xeeac0d][_0x38a2e7(0x246)]=_0x3a8ac3;}),_0x1a8f19[_0x281d31(0x219)]((_0x4f3558,_0x22b480)=>{var _0x3464ba=_0x281d31;_0x19a2f8[_0x22b480][_0x3464ba(0x24c)]=_0x4f3558;}),_0x41e99c[_0x281d31(0x219)]((_0x253391,_0x5ae167)=>{var _0x597d14=_0x281d31;_0x19a2f8[_0x5ae167][_0x597d14(0x18e)]=_0x253391;}),_0x5343d3['forEach']((_0x3e0ef1,_0x11cb9b)=>{_0x19a2f8[_0x11cb9b]['production_date']=_0x3e0ef1;}),_0x5eead6[_0x281d31(0x219)]((_0x3b2df8,_0x57c48b)=>{_0x19a2f8[_0x57c48b]['expiry_date']=_0x3b2df8;});var _0x4249c6=0x0;_0x19a2f8['forEach'](_0x7b3e72=>{var _0xd0899d=_0x281d31;(parseInt(_0x7b3e72['sale_qty'])<parseInt(_0x7b3e72[_0xd0899d(0x1d6)])||parseInt(_0x7b3e72[_0xd0899d(0x1c6)])<parseInt(_0x7b3e72[_0xd0899d(0x1d6)])&&parseInt(_0x7b3e72[_0xd0899d(0x2b3)])>parseInt(_0x7b3e72['return_qty'])||parseInt(_0x7b3e72['return_qty'])==0x0)&&_0x4249c6++;});if(_0x4249c6!=0x0)return _0x3b3168['flash'](_0x281d31(0x24e),_0x281d31(0x25b)),_0x314a35['redirect'](_0x281d31(0x24f));const _0xf67d9b=await sales_finished[_0x281d31(0x294)]({'invoice':_0x15035a});_0xf67d9b['return_data']=_0x281d31(0x273);const _0x88633d=await _0xf67d9b[_0x281d31(0x258)](),_0x6bf8ab=new sales_return_finished({'invoice':_0x15035a,'customer':_0x3b3168['body'][_0x281d31(0x1d2)],'date':_0x24a4f2,'warehouse_name':_0x45170f,'room':_0x2ac4e6,'ToWarehouse':_0x4dcb2f,'ToRoom':_0xb375ab,'return_sale':_0x19a2f8,'note':_0x2d2407,'warehouse_cat':_0x4fbced}),_0x4af32a=await _0x6bf8ab['save'](),_0x2cd873=await sales_return_finished['findOne']({'invoice':_0x15035a}),_0x301976=await warehouse[_0x281d31(0x294)]({'name':_0x4dcb2f,'room':_0xb375ab,'warehouse_category':'Finished\x20Goods'});_0x2cd873[_0x281d31(0x19a)][_0x281d31(0x219)](_0x326bcf=>{var _0x228e29=_0x281d31,_0x2f2136=0x0;const _0x165fe6=_0x301976[_0x228e29(0x251)][_0x228e29(0x1ac)](_0x3ebc01=>{var _0x3c4b4b=_0x228e29;_0x3ebc01[_0x3c4b4b(0x235)]==_0x326bcf[_0x3c4b4b(0x235)]&&_0x3ebc01[_0x3c4b4b(0x1f9)]==_0x326bcf['bay']&&_0x3ebc01[_0x3c4b4b(0x1b7)]==_0x326bcf[_0x3c4b4b(0x1b7)]&&_0x3ebc01[_0x3c4b4b(0x1b4)]==_0x326bcf[_0x3c4b4b(0x1b4)]&&_0x3ebc01[_0x3c4b4b(0x246)]==_0x326bcf[_0x3c4b4b(0x246)]&&(_0x3ebc01[_0x3c4b4b(0x22b)]=parseInt(_0x3ebc01[_0x3c4b4b(0x22b)])+parseInt(_0x326bcf['return_qty']),_0x2f2136++);});_0x2f2136=='0'&&(_0x301976[_0x228e29(0x251)]=_0x301976['product_details'][_0x228e29(0x1d0)]({'product_name':_0x326bcf[_0x228e29(0x235)],'product_stock':_0x326bcf[_0x228e29(0x1d6)],'primary_code':_0x326bcf[_0x228e29(0x202)],'secondary_code':_0x326bcf[_0x228e29(0x250)],'product_code':_0x326bcf[_0x228e29(0x195)],'bay':_0x326bcf[_0x228e29(0x1f9)],'batch_code':_0x326bcf[_0x228e29(0x246)],'maxPerUnit':_0x326bcf[_0x228e29(0x26a)],'production_date':_0x326bcf['production_date'],'expiry_date':_0x326bcf[_0x228e29(0x1b7)],'secondary_unit':_0x326bcf[_0x228e29(0x24c)],'unit':_0x326bcf[_0x228e29(0x18e)],'maxProducts':_0x326bcf[_0x228e29(0x1f2)]}));}),await _0x301976[_0x281d31(0x258)](),console['log'](_0x3b3168['body']);const _0x12c28c=new c_payment_data({'invoice':_0x15035a,'customer':_0x3b3168[_0x281d31(0x2aa)]['customer'],'reason':_0x281d31(0x287)});await _0x12c28c['save']();const _0x5ca426=await master_shop[_0x281d31(0x1be)]();console[_0x281d31(0x282)](_0x281d31(0x1db),_0x5ca426[0x0][_0x281d31(0x2b0)]);const _0x14d65f=await email_settings[_0x281d31(0x294)](),_0xb35949=await customer[_0x281d31(0x294)]({'name':_0x3b3168[_0x281d31(0x2aa)][_0x281d31(0x1d2)]});console[_0x281d31(0x282)]('customer_data',_0xb35949);_0x5ca426[0x0]['currency_placement']==0x1?(right_currency=_0x5ca426[0x0][_0x281d31(0x290)],left_currency=''):(right_currency='',left_currency=_0x5ca426[0x0][_0x281d31(0x290)]);var _0x1c64e3=_0x378ca1,_0x421466=_0x3a6021,_0x39cea1='',_0x662cd8;for(_0x662cd8 in _0x1c64e3){_0x39cea1+=_0x281d31(0x1b1)+_0x281d31(0x2a1)+_0x1c64e3[_0x662cd8]+_0x281d31(0x277)+_0x281d31(0x2a1)+_0x421466[_0x662cd8]+_0x281d31(0x277)+_0x281d31(0x1a0);}console[_0x281d31(0x282)](_0x281d31(0x224),_0x39cea1);let _0x3de2dc=nodemailer[_0x281d31(0x21d)]({'service':_0x281d31(0x22f),'auth':{'user':_0x14d65f[_0x281d31(0x1f0)],'pass':_0x14d65f['password']}}),_0x177dd3={'from':_0x14d65f[_0x281d31(0x1f0)],'to':_0xb35949['email'],'subject':_0x281d31(0x1d4),'attachments':[{'filename':'Logo.png','path':__dirname+_0x281d31(0x23f)+_0x281d31(0x229)+_0x5ca426[0x0][_0x281d31(0x2b0)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x281d31(0x210)+_0x281d31(0x1cb)+_0x281d31(0x1de)+_0x281d31(0x26d)+_0x281d31(0x1de)+_0x281d31(0x1ea)+'</div>'+_0x281d31(0x1de)+_0x281d31(0x2b2)+_0x5ca426[0x0][_0x281d31(0x1e1)]+_0x281d31(0x232)+_0x281d31(0x25f)+_0x281d31(0x25f)+_0x281d31(0x268)+_0x281d31(0x1de)+_0x281d31(0x243)+'\x20Order\x20Number\x20:\x20'+_0x15035a+'\x20'+_0x281d31(0x274)+_0x281d31(0x283)+_0x24a4f2+'\x20'+_0x281d31(0x29a)+_0x281d31(0x203)+_0x281d31(0x25f)+_0x281d31(0x1a5)+_0x281d31(0x289)+_0x281d31(0x1b1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x281d31(0x23e)+_0x281d31(0x2a4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x281d31(0x1a0)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x39cea1+'\x20'+_0x281d31(0x288)+'</table>'+_0x281d31(0x1de)+_0x281d31(0x249)+_0x281d31(0x20d)+_0x5ca426[0x0][_0x281d31(0x1e1)]+_0x281d31(0x203)+'</div>'+_0x281d31(0x25f)+_0x281d31(0x18c)};_0x3de2dc[_0x281d31(0x292)](_0x177dd3,function(_0x462df2,_0x3b26fa){var _0x4c27f4=_0x281d31;_0x462df2?(console['log'](_0x462df2),console[_0x4c27f4(0x282)](_0x4c27f4(0x24a))):console[_0x4c27f4(0x282)](_0x4c27f4(0x199));}),_0x3b3168['flash'](_0x281d31(0x2b1),_0x281d31(0x29f)),_0x314a35[_0x281d31(0x28c)](_0x281d31(0x29e));}catch(_0x261ae3){console['log'](_0x261ae3),_0x314a35[_0x281d31(0x1a3)](0xc8)['json']({'message1':_0x261ae3[_0x281d31(0x2a9)]});}}}),router[a0_0x3524eb(0x2a5)](a0_0x3524eb(0x1c4),auth,async(_0x5a0911,_0x25ed24)=>{var _0xe8c47b=a0_0x3524eb;try{const {username:_0x4a4c76,email:_0x418a00,role:_0xe0765a}=_0x5a0911[_0xe8c47b(0x27b)],_0x5e4ce6=_0x5a0911[_0xe8c47b(0x27b)],_0x1d13c0=await profile[_0xe8c47b(0x294)]({'email':_0x5e4ce6[_0xe8c47b(0x1f0)]}),_0x2b1947=await master_shop['find']();console['log']('barcode\x20Product\x20master',_0x2b1947);const _0x2d1b98=_0x5a0911[_0xe8c47b(0x247)]['id'],_0x4df184=await sales[_0xe8c47b(0x29d)](_0x2d1b98);console[_0xe8c47b(0x282)](_0xe8c47b(0x272),_0x4df184);if(_0x2b1947[0x0][_0xe8c47b(0x226)]==_0xe8c47b(0x19f))var _0x116214=users[_0xe8c47b(0x27a)];else{if(_0x2b1947[0x0][_0xe8c47b(0x226)]=='Hindi')var _0x116214=users[_0xe8c47b(0x24b)];else{if(_0x2b1947[0x0]['language']==_0xe8c47b(0x2ad))var _0x116214=users['German'];else{if(_0x2b1947[0x0][_0xe8c47b(0x226)]=='Spanish')var _0x116214=users[_0xe8c47b(0x264)];else{if(_0x2b1947[0x0][_0xe8c47b(0x226)]==_0xe8c47b(0x2af))var _0x116214=users[_0xe8c47b(0x2af)];else{if(_0x2b1947[0x0][_0xe8c47b(0x226)]=='Portuguese\x20(BR)')var _0x116214=users[_0xe8c47b(0x19d)];else{if(_0x2b1947[0x0]['language']=='Chinese')var _0x116214=users[_0xe8c47b(0x211)];else{if(_0x2b1947[0x0]['language']==_0xe8c47b(0x1a9))var _0x116214=users[_0xe8c47b(0x1cd)];}}}}}}}_0x25ed24[_0xe8c47b(0x1a6)](_0xe8c47b(0x296),{'success':_0x5a0911[_0xe8c47b(0x220)]('success'),'errors':_0x5a0911[_0xe8c47b(0x220)](_0xe8c47b(0x24e)),'role':_0x5e4ce6,'profile':_0x1d13c0,'alldata':_0x4df184,'master_shop':_0x2b1947,'language':_0x116214});}catch(_0xb9db21){console[_0xe8c47b(0x282)](_0xb9db21);}}),router['post']('/barcode_scanner',async(_0xf9017d,_0x22e9e0)=>{var _0x2c9caf=a0_0x3524eb;const {product_code:_0x4fcd41,warehouse_name:_0x3683b4,rooms_data:_0x3185f3,Roomslist:_0x3409c9,sales_category:_0x18a847}=_0xf9017d[_0x2c9caf(0x2aa)],_0x862047=_0x3409c9[_0x2c9caf(0x286)](','),_0x58c979=[];async function _0x25dc34(_0x8d006b){var _0x231bf6=_0x2c9caf;const _0x5a3854=await warehouse[_0x231bf6(0x263)]([{'$match':{'name':_0x3683b4,'room':_0x8d006b}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x4fcd41}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x231bf6(0x1ad)},'product_stock':{'$first':_0x231bf6(0x1ef)},'primary_code':{'$first':_0x231bf6(0x1b3)},'secondary_code':{'$first':_0x231bf6(0x1bd)},'product_code':{'$first':_0x231bf6(0x1c2)},'level':{'$first':_0x231bf6(0x1a4)},'bay':{'$first':_0x231bf6(0x297)},'type':{'$first':_0x231bf6(0x241)},'pallet':{'$first':_0x231bf6(0x276)},'unit':{'$first':_0x231bf6(0x291)},'secondary_unit':{'$first':_0x231bf6(0x24d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x231bf6(0x1c8)},'expiry_date':{'$first':_0x231bf6(0x1bf)},'production_date':{'$first':_0x231bf6(0x217)},'maxPerUnit':{'$first':_0x231bf6(0x205)},'batch_code':{'$first':_0x231bf6(0x23d)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x231bf6(0x21e)},'invoice':{'$first':_0x231bf6(0x1f4)},'uuid':{'$first':_0x231bf6(0x298)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x231bf6(0x2a6)}}}]),_0x665cb1=await warehouse['aggregate']([{'$match':{'name':_0x3683b4,'room':_0x8d006b}},{'$unwind':_0x231bf6(0x1d9)},{'$match':{'product_details.secondary_code':_0x4fcd41}},{'$group':{'_id':_0x231bf6(0x239),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x231bf6(0x1ef)},'primary_code':{'$first':_0x231bf6(0x1b3)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x231bf6(0x1c2)},'level':{'$first':_0x231bf6(0x297)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x231bf6(0x276)},'unit':{'$first':_0x231bf6(0x291)},'secondary_unit':{'$first':_0x231bf6(0x24d)},'storage':{'$first':_0x231bf6(0x1ab)},'rack':{'$first':_0x231bf6(0x1c8)},'expiry_date':{'$first':_0x231bf6(0x1bf)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x231bf6(0x205)},'batch_code':{'$first':_0x231bf6(0x23d)},'product_cat':{'$first':_0x231bf6(0x254)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x231bf6(0x2a6)}}}]);if(_0x5a3854['length']>0x0)_0x58c979[_0x231bf6(0x22c)](_0x5a3854);else _0x665cb1[_0x231bf6(0x191)]>0x0&&_0x58c979[_0x231bf6(0x22c)](_0x665cb1);}const _0x2e4424=_0x862047[_0x2c9caf(0x1ac)](_0x1534cc=>_0x25dc34(_0x1534cc));await Promise[_0x2c9caf(0x214)](_0x2e4424),_0x22e9e0[_0x2c9caf(0x233)](_0x58c979);}),router[a0_0x3524eb(0x1a2)](a0_0x3524eb(0x222),async(_0x23c1c1,_0x430fb8)=>{var _0x918b5c=a0_0x3524eb;const {product_code:_0x4e534c,warehouse_name:_0x1db06c,rooms_data:_0x395616,Roomslist:_0x17f615,sales_category:_0x3dc2d4}=_0x23c1c1[_0x918b5c(0x2aa)],_0x49761d=_0x17f615[_0x918b5c(0x286)](','),_0x72b293=[];async function _0x330ad4(_0x5273a7){var _0x43618b=_0x918b5c;const _0x190f11=await warehouse[_0x43618b(0x263)]([{'$match':{'name':_0x1db06c,'room':_0x5273a7}},{'$unwind':_0x43618b(0x1d9)},{'$match':{'product_details.primary_code':_0x4e534c,'product_details.sales_category':_0x3dc2d4,'product_details.type_products':_0x43618b(0x282)}},{'$group':{'_id':_0x43618b(0x239),'name':{'$first':_0x43618b(0x1ad)},'product_stock':{'$first':_0x43618b(0x1ef)},'primary_code':{'$first':_0x43618b(0x1b3)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x43618b(0x1c2)},'level':{'$first':'$product_details.level'},'bay':{'$first':_0x43618b(0x297)},'type':{'$first':_0x43618b(0x241)},'pallet':{'$first':_0x43618b(0x276)},'unit':{'$first':_0x43618b(0x291)},'secondary_unit':{'$first':_0x43618b(0x24d)},'storage':{'$first':_0x43618b(0x1ab)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x43618b(0x1bf)},'production_date':{'$first':_0x43618b(0x217)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x43618b(0x23d)},'product_cat':{'$first':_0x43618b(0x254)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x43618b(0x21e)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x43618b(0x298)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x43618b(0x2a6)},'type_products':{'$first':_0x43618b(0x1e4)}}}]);console[_0x43618b(0x282)](_0x43618b(0x282)+_0x43618b(0x20f)+_0x4e534c+_0x43618b(0x20f)+_0x3dc2d4);const _0x1b4ccc=await warehouse[_0x43618b(0x263)]([{'$match':{'name':_0x1db06c,'room':_0x5273a7}},{'$unwind':_0x43618b(0x1d9)},{'$match':{'product_details.secondary_code':_0x4e534c,'product_details.sales_category':_0x3dc2d4,'product_details.type_products':_0x43618b(0x282)}},{'$group':{'_id':_0x43618b(0x239),'name':{'$first':_0x43618b(0x1ad)},'product_stock':{'$first':_0x43618b(0x1ef)},'primary_code':{'$first':_0x43618b(0x1b3)},'secondary_code':{'$first':_0x43618b(0x1bd)},'product_code':{'$first':_0x43618b(0x1c2)},'level':{'$first':_0x43618b(0x297)},'isle':{'$first':_0x43618b(0x1d5)},'type':{'$first':_0x43618b(0x241)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x43618b(0x24d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x43618b(0x1bf)},'production_date':{'$first':_0x43618b(0x217)},'maxPerUnit':{'$first':_0x43618b(0x205)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x43618b(0x254)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x43618b(0x1f4)},'uuid':{'$first':_0x43618b(0x298)},'gross_price':{'$first':_0x43618b(0x1dd)},'sales_category':{'$first':_0x43618b(0x2a6)},'type_products':{'$first':_0x43618b(0x1e4)}}}]);if(_0x190f11[_0x43618b(0x191)]>0x0)_0x72b293[_0x43618b(0x22c)](_0x190f11);else _0x1b4ccc[_0x43618b(0x191)]>0x0&&_0x72b293['push'](_0x1b4ccc);}const _0x16100b=_0x49761d[_0x918b5c(0x1ac)](_0x101d2b=>_0x330ad4(_0x101d2b));await Promise[_0x918b5c(0x214)](_0x16100b),_0x430fb8[_0x918b5c(0x233)](_0x72b293);}),module[a0_0x3524eb(0x1bc)]=router;