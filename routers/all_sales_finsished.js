var a0_0x4e7a4a=a0_0xf583;(function(_0x5d78eb,_0x3d938d){var _0x36d235=a0_0xf583,_0x340c96=_0x5d78eb();while(!![]){try{var _0xc1e651=-parseInt(_0x36d235(0x1aa))/0x1+-parseInt(_0x36d235(0xb6))/0x2+parseInt(_0x36d235(0xba))/0x3+-parseInt(_0x36d235(0x13d))/0x4+-parseInt(_0x36d235(0x177))/0x5+-parseInt(_0x36d235(0xdf))/0x6+parseInt(_0x36d235(0xf9))/0x7;if(_0xc1e651===_0x3d938d)break;else _0x340c96['push'](_0x340c96['shift']());}catch(_0x122518){_0x340c96['push'](_0x340c96['shift']());}}}(a0_0x3331,0x63be7));function a0_0xf583(_0x12cbd,_0x46632a){var _0x3331ea=a0_0x3331();return a0_0xf583=function(_0xf58389,_0x162827){_0xf58389=_0xf58389-0x9c;var _0x2afe78=_0x3331ea[_0xf58389];return _0x2afe78;},a0_0xf583(_0x12cbd,_0x46632a);}const express=require(a0_0x4e7a4a(0xf2)),app=express(),router=express[a0_0x4e7a4a(0xb4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x4e7a4a(0x13c)),auth=require(a0_0x4e7a4a(0x108)),nodemailer=require('nodemailer'),users=require('../public/language/languages.json');router[a0_0x4e7a4a(0xb1)](a0_0x4e7a4a(0x180),auth,async(_0x8ef0ab,_0x2448d1)=>{var _0xfc7ad=a0_0x4e7a4a;try{const {username:_0x489958,email:_0x2f193a,role:_0x38c3e5}=_0x8ef0ab['user'],_0x50628a=_0x8ef0ab[_0xfc7ad(0xc9)],_0xe3f71b=await profile[_0xfc7ad(0x10a)]({'email':_0x50628a[_0xfc7ad(0x190)]}),_0xb1c6c4=await master_shop[_0xfc7ad(0x103)]();let _0x2d2b56;if(_0x50628a[_0xfc7ad(0x135)]==_0xfc7ad(0x1a8)){const _0x4c08c8=await staff[_0xfc7ad(0x10a)]({'email':_0x50628a['email']});_0x2d2b56=await sales_finished[_0xfc7ad(0xfa)]([{'$match':{'typeOfProducts':_0xfc7ad(0xd5)}},{'$unwind':_0xfc7ad(0x10d)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':_0xfc7ad(0x13a)},'date':{'$first':_0xfc7ad(0xe9)},'warehouse_name':{'$first':_0xfc7ad(0xa9)},'sale_product':{'$push':_0xfc7ad(0x10d)},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0xfc7ad(0x191)},'total_saleproduct_quantity':{'$sum':_0xfc7ad(0x10b)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0xfc7ad(0xd1)},'type':{'$addToSet':_0xfc7ad(0x109)},'pallet':{'$addToSet':_0xfc7ad(0x186)},'finalize':{'$first':_0xfc7ad(0x188)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x2d2b56=await sales_finished[_0xfc7ad(0xfa)]([{'$match':{'typeOfProducts':_0xfc7ad(0xd5)}},{'$unwind':_0xfc7ad(0x10d)},{'$group':{'_id':'$_id','invoice':{'$first':_0xfc7ad(0xfd)},'customers':{'$first':_0xfc7ad(0x13a)},'date':{'$first':_0xfc7ad(0xe9)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0xfc7ad(0x10d)},'note':{'$first':_0xfc7ad(0x12b)},'return_data':{'$first':_0xfc7ad(0x1a0)},'customers_docs':{'$first':_0xfc7ad(0x191)},'total_saleproduct_quantity':{'$sum':_0xfc7ad(0x10b)},'level':{'$addToSet':_0xfc7ad(0x196)},'isle':{'$addToSet':_0xfc7ad(0xd1)},'type':{'$addToSet':_0xfc7ad(0x109)},'pallet':{'$addToSet':_0xfc7ad(0x186)},'finalize':{'$first':_0xfc7ad(0x188)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0xb1c6c4[0x0]['language']==_0xfc7ad(0x161)){var _0x57cb43=users['English'];console[_0xfc7ad(0xc3)](_0x57cb43);}else{if(_0xb1c6c4[0x0][_0xfc7ad(0x192)]=='Hindi')var _0x57cb43=users[_0xfc7ad(0xc8)];else{if(_0xb1c6c4[0x0][_0xfc7ad(0x192)]==_0xfc7ad(0x1b1))var _0x57cb43=users[_0xfc7ad(0x1b1)];else{if(_0xb1c6c4[0x0][_0xfc7ad(0x192)]==_0xfc7ad(0x19a))var _0x57cb43=users['Spanish'];else{if(_0xb1c6c4[0x0][_0xfc7ad(0x192)]==_0xfc7ad(0x157))var _0x57cb43=users[_0xfc7ad(0x157)];else{if(_0xb1c6c4[0x0][_0xfc7ad(0x192)]==_0xfc7ad(0x130))var _0x57cb43=users[_0xfc7ad(0x10c)];else{if(_0xb1c6c4[0x0][_0xfc7ad(0x192)]==_0xfc7ad(0x12c))var _0x57cb43=users[_0xfc7ad(0x12c)];else{if(_0xb1c6c4[0x0][_0xfc7ad(0x192)]==_0xfc7ad(0x170))var _0x57cb43=users['Arabic'];}}}}}}}_0x2448d1[_0xfc7ad(0x173)](_0xfc7ad(0x14e),{'success':_0x8ef0ab['flash'](_0xfc7ad(0x9c)),'errors':_0x8ef0ab[_0xfc7ad(0x1a9)](_0xfc7ad(0x179)),'sales':_0x2d2b56,'profile':_0xe3f71b,'role':_0x50628a,'master_shop':_0xb1c6c4,'language':_0x57cb43});}catch(_0x285eff){console[_0xfc7ad(0xc3)](_0x285eff);}}),router[a0_0x4e7a4a(0xb1)]('/view_log',auth,async(_0x4914a7,_0x2910f7)=>{var _0x38a1f4=a0_0x4e7a4a;try{const {username:_0x166a67,email:_0x591e76,role:_0x383743}=_0x4914a7[_0x38a1f4(0xc9)],_0x5754a4=_0x4914a7[_0x38a1f4(0xc9)],_0x2b3305=await profile[_0x38a1f4(0x10a)]({'email':_0x5754a4[_0x38a1f4(0x190)]}),_0x4493a5=await master_shop[_0x38a1f4(0x103)]();let _0x120036;if(_0x5754a4[_0x38a1f4(0x135)]==_0x38a1f4(0x1a8)){const _0x5156a2=await staff['findOne']({'email':_0x5754a4[_0x38a1f4(0x190)]});_0x120036=await sales_finished[_0x38a1f4(0xfa)]([{'$match':{'typeOfProducts':_0x38a1f4(0x185)}},{'$unwind':_0x38a1f4(0x10d)},{'$group':{'_id':_0x38a1f4(0xb9),'invoice':{'$first':_0x38a1f4(0xfd)},'customers':{'$first':_0x38a1f4(0x13a)},'date':{'$first':_0x38a1f4(0xe9)},'warehouse_name':{'$first':_0x38a1f4(0xa9)},'sale_product':{'$push':_0x38a1f4(0x10d)},'note':{'$first':'$note'},'return_data':{'$first':_0x38a1f4(0x1a0)},'customers_docs':{'$first':_0x38a1f4(0x191)},'total_saleproduct_quantity':{'$sum':_0x38a1f4(0x10b)},'level':{'$addToSet':_0x38a1f4(0x196)},'isle':{'$addToSet':_0x38a1f4(0xd1)},'type':{'$addToSet':_0x38a1f4(0x109)},'pallet':{'$addToSet':_0x38a1f4(0x186)},'finalize':{'$first':_0x38a1f4(0x188)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x120036=await sales_finished[_0x38a1f4(0xfa)]([{'$match':{'typeOfProducts':_0x38a1f4(0x185)}},{'$unwind':_0x38a1f4(0x10d)},{'$group':{'_id':_0x38a1f4(0xb9),'invoice':{'$first':_0x38a1f4(0xfd)},'customers':{'$first':_0x38a1f4(0x13a)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x38a1f4(0xa9)},'sale_product':{'$push':_0x38a1f4(0x10d)},'note':{'$first':_0x38a1f4(0x12b)},'return_data':{'$first':_0x38a1f4(0x1a0)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x38a1f4(0x10b)},'level':{'$addToSet':_0x38a1f4(0x196)},'isle':{'$addToSet':_0x38a1f4(0xd1)},'type':{'$addToSet':_0x38a1f4(0x109)},'pallet':{'$addToSet':_0x38a1f4(0x186)},'finalize':{'$first':_0x38a1f4(0x188)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x4493a5[0x0][_0x38a1f4(0x192)]=='English\x20(US)'){var _0x492a14=users[_0x38a1f4(0xce)];console[_0x38a1f4(0xc3)](_0x492a14);}else{if(_0x4493a5[0x0][_0x38a1f4(0x192)]==_0x38a1f4(0xc8))var _0x492a14=users[_0x38a1f4(0xc8)];else{if(_0x4493a5[0x0][_0x38a1f4(0x192)]==_0x38a1f4(0x1b1))var _0x492a14=users[_0x38a1f4(0x1b1)];else{if(_0x4493a5[0x0][_0x38a1f4(0x192)]==_0x38a1f4(0x19a))var _0x492a14=users['Spanish'];else{if(_0x4493a5[0x0][_0x38a1f4(0x192)]=='French')var _0x492a14=users['French'];else{if(_0x4493a5[0x0]['language']=='Portuguese\x20(BR)')var _0x492a14=users['Portuguese'];else{if(_0x4493a5[0x0]['language']==_0x38a1f4(0x12c))var _0x492a14=users['Chinese'];else{if(_0x4493a5[0x0]['language']==_0x38a1f4(0x170))var _0x492a14=users[_0x38a1f4(0x16b)];}}}}}}}_0x2910f7[_0x38a1f4(0x173)]('all_sales_finished_logs',{'success':_0x4914a7[_0x38a1f4(0x1a9)](_0x38a1f4(0x9c)),'errors':_0x4914a7[_0x38a1f4(0x1a9)](_0x38a1f4(0x179)),'sales':_0x120036,'profile':_0x2b3305,'role':_0x5754a4,'master_shop':_0x4493a5,'language':_0x492a14});}catch(_0x199b25){console[_0x38a1f4(0xc3)](_0x199b25);}});async function getRandom8DigitNumber(){var _0x4f0f08=a0_0x4e7a4a;const _0x30b53e=0x989680,_0x43a348=0x5f5e0ff,_0x2f1b19=Math['floor'](Math[_0x4f0f08(0xae)]()*(_0x43a348-_0x30b53e+0x1))+_0x30b53e;var _0x47a16d;const _0x1f2c9e=await sales_finished['findOne']({'invoice':_0x4f0f08(0x14a)+_0x2f1b19});return _0x1f2c9e&&_0x1f2c9e[_0x4f0f08(0x153)]>0x0?_0x47a16d='OUTF-'+_0x2f1b19:_0x47a16d=_0x4f0f08(0x14a)+_0x2f1b19,_0x47a16d;}router[a0_0x4e7a4a(0xb1)](a0_0x4e7a4a(0x11d),auth,async(_0x34873a,_0x29259e)=>{var _0x3c25be=a0_0x4e7a4a;try{const {username:_0x5aea86,email:_0x47b097,role:_0x35ee34}=_0x34873a[_0x3c25be(0xc9)],_0xce565b=_0x34873a['user'],_0x2f3252=await profile[_0x3c25be(0x10a)]({'email':_0xce565b['email']}),_0x17d4b9=await master_shop[_0x3c25be(0x103)](),_0x541188=await customer[_0x3c25be(0x103)]({});let _0x39e84b;if(_0xce565b['role']==_0x3c25be(0x1a8)){const _0x2257bd=await staff[_0x3c25be(0x10a)]({'email':_0xce565b['email']});_0x39e84b=await warehouse[_0x3c25be(0xfa)]([{'$match':{'status':_0x3c25be(0x16a),'name':_0x2257bd[_0x3c25be(0xd0)]}},{'$group':{'_id':_0x3c25be(0xdd),'name':{'$first':_0x3c25be(0xdd)}}},{'$sort':{'name':0x1}}]);}else _0x39e84b=await warehouse[_0x3c25be(0xfa)]([{'$match':{'status':_0x3c25be(0x16a)}},{'$group':{'_id':'$name','name':{'$first':_0x3c25be(0xdd)}}},{'$sort':{'name':0x1}}]);const _0xbee6f9=await product[_0x3c25be(0x103)]({});var _0x251298=[_0x3c25be(0xbd),_0x3c25be(0x184)];const _0x2bb3c1=await sales_finished[_0x3c25be(0x103)]({}),_0x2aff6f=_0x2bb3c1['length']+0x1,_0x5269f2=_0x3c25be(0x14a)+_0x2aff6f[_0x3c25be(0x9d)]()[_0x3c25be(0x181)](0x5,'0');if(_0x17d4b9[0x0][_0x3c25be(0x192)]==_0x3c25be(0x161)){var _0xc619df=users[_0x3c25be(0xce)];console['log'](_0xc619df);}else{if(_0x17d4b9[0x0][_0x3c25be(0x192)]==_0x3c25be(0xc8))var _0xc619df=users['Hindi'];else{if(_0x17d4b9[0x0]['language']=='German')var _0xc619df=users['German'];else{if(_0x17d4b9[0x0]['language']==_0x3c25be(0x19a))var _0xc619df=users['Spanish'];else{if(_0x17d4b9[0x0][_0x3c25be(0x192)]==_0x3c25be(0x157))var _0xc619df=users[_0x3c25be(0x157)];else{if(_0x17d4b9[0x0][_0x3c25be(0x192)]==_0x3c25be(0x130))var _0xc619df=users[_0x3c25be(0x10c)];else{if(_0x17d4b9[0x0]['language']==_0x3c25be(0x12c))var _0xc619df=users['Chinese'];else{if(_0x17d4b9[0x0]['language']==_0x3c25be(0x170))var _0xc619df=users[_0x3c25be(0x16b)];}}}}}}}const _0x20fccb=getRandom8DigitNumber();_0x20fccb[_0x3c25be(0x15b)](_0x2187ac=>{var _0x491995=_0x3c25be;_0x29259e['render'](_0x491995(0x16e),{'success':_0x34873a[_0x491995(0x1a9)](_0x491995(0x9c)),'errors':_0x34873a[_0x491995(0x1a9)](_0x491995(0x179)),'role':_0xce565b,'profile':_0x2f3252,'customer':_0x541188,'warehouse':_0x39e84b,'product':_0xbee6f9,'invoice':_0x2187ac,'master_shop':_0x17d4b9,'language':_0xc619df,'rooms_data':_0x251298});})[_0x3c25be(0xd8)](_0xfb0ead=>{var _0x551d6d=_0x3c25be;_0x34873a[_0x551d6d(0x1a9)](_0x551d6d(0x179),_0x551d6d(0x1b5)),_0x29259e[_0x551d6d(0x18b)](_0x551d6d(0x168));});}catch(_0x15d999){console['log'](_0x15d999);}}),router['get'](a0_0x4e7a4a(0x139),auth,async(_0x359970,_0x12a897)=>{var _0x3d88de=a0_0x4e7a4a;try{const {username:_0x1a3054,email:_0x4602de,role:_0x335913}=_0x359970['user'],_0x18e4c8=_0x359970[_0x3d88de(0xc9)],_0xcb7229=await profile[_0x3d88de(0x10a)]({'email':_0x18e4c8[_0x3d88de(0x190)]}),_0x29bc78=await master_shop[_0x3d88de(0x103)](),_0x47618e=await customer[_0x3d88de(0x103)]({});let _0x488c76;if(_0x18e4c8[_0x3d88de(0x135)]==_0x3d88de(0x1a8)){const _0x293fe8=await staff[_0x3d88de(0x10a)]({'email':_0x18e4c8[_0x3d88de(0x190)]});_0x488c76=await warehouse[_0x3d88de(0xfa)]([{'$match':{'status':_0x3d88de(0x16a),'name':_0x293fe8[_0x3d88de(0xd0)]}},{'$group':{'_id':_0x3d88de(0xdd),'name':{'$first':_0x3d88de(0xdd)}}},{'$sort':{'name':0x1}}]);}else _0x488c76=await warehouse[_0x3d88de(0xfa)]([{'$match':{'status':_0x3d88de(0x16a)}},{'$group':{'_id':'$name','name':{'$first':_0x3d88de(0xdd)}}},{'$sort':{'name':0x1}}]);const _0x2c90b2=await product[_0x3d88de(0x103)]({});var _0x395252=[_0x3d88de(0xbd),_0x3d88de(0x184)];const _0x47ea55=await sales_finished[_0x3d88de(0x103)]({}),_0x4180dc=_0x47ea55[_0x3d88de(0x153)]+0x1,_0x47e44a='OUTF-'+_0x4180dc[_0x3d88de(0x9d)]()[_0x3d88de(0x181)](0x5,'0');if(_0x29bc78[0x0][_0x3d88de(0x192)]==_0x3d88de(0x161)){var _0xd81453=users[_0x3d88de(0xce)];console[_0x3d88de(0xc3)](_0xd81453);}else{if(_0x29bc78[0x0][_0x3d88de(0x192)]==_0x3d88de(0xc8))var _0xd81453=users['Hindi'];else{if(_0x29bc78[0x0][_0x3d88de(0x192)]=='German')var _0xd81453=users[_0x3d88de(0x1b1)];else{if(_0x29bc78[0x0]['language']==_0x3d88de(0x19a))var _0xd81453=users[_0x3d88de(0x19a)];else{if(_0x29bc78[0x0][_0x3d88de(0x192)]==_0x3d88de(0x157))var _0xd81453=users[_0x3d88de(0x157)];else{if(_0x29bc78[0x0][_0x3d88de(0x192)]==_0x3d88de(0x130))var _0xd81453=users[_0x3d88de(0x10c)];else{if(_0x29bc78[0x0][_0x3d88de(0x192)]==_0x3d88de(0x12c))var _0xd81453=users['Chinese'];else{if(_0x29bc78[0x0][_0x3d88de(0x192)]==_0x3d88de(0x170))var _0xd81453=users[_0x3d88de(0x16b)];}}}}}}}const _0x509d11=getRandom8DigitNumber();_0x509d11[_0x3d88de(0x15b)](_0x24096b=>{var _0x2f0801=_0x3d88de;_0x12a897[_0x2f0801(0x173)]('add_sales_finished_logs',{'success':_0x359970[_0x2f0801(0x1a9)](_0x2f0801(0x9c)),'errors':_0x359970[_0x2f0801(0x1a9)]('errors'),'role':_0x18e4c8,'profile':_0xcb7229,'customer':_0x47618e,'warehouse':_0x488c76,'product':_0x2c90b2,'invoice':_0x24096b,'master_shop':_0x29bc78,'language':_0xd81453,'rooms_data':_0x395252});})[_0x3d88de(0xd8)](_0x2027f6=>{var _0xec4ab9=_0x3d88de;_0x359970[_0xec4ab9(0x1a9)](_0xec4ab9(0x179),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x12a897['redirect'](_0xec4ab9(0x168));});}catch(_0x142a7d){console['log'](_0x142a7d);}}),router[a0_0x4e7a4a(0xbc)](a0_0x4e7a4a(0x139),auth,async(_0x321d22,_0x111543)=>{var _0x2a8377=a0_0x4e7a4a;try{const {invoice:_0x2c9265,date:_0x2a592e,warehouse_name:_0x39b72a,product_name:_0x205425,note:_0x5f1bf4,room:_0x5a6239,primary_code:_0x62758b,secondary_code:_0x3a29b4,prod_code:_0x3960d9,SCRN:_0xf4739e,ReqBy:_0x4663e1,dateofreq:_0x4244c2,PO_number:_0x605102,typeservicesData:_0x1cf036,typevehicle:_0x1156fb,destination:_0x1d4d72,deliverydate:_0xa1625a,driver:_0x32bf21,plate:_0x918355,van:_0x5ca136,DRSI:_0x3aa2b4,TSU:_0x185be4,TFU:_0x19fb2d,mode_transpo:_0x40833a,name_driver:_0x58eb97,type_of_products:_0x333a30}=_0x321d22[_0x2a8377(0x124)];if(typeof _0x205425=='string')var _0x3e6d5f=[_0x321d22['body'][_0x2a8377(0x9e)]],_0x29a535=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x187)]],_0x526474=[_0x321d22['body'][_0x2a8377(0x126)]],_0x485d99=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0xac)]],_0x27a2dd=[_0x321d22['body'][_0x2a8377(0xbe)]],_0x1b6e0a=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x16d)]],_0x159d44=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x18d)]],_0x30baae=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x12d)]],_0x561aaa=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x162)]],_0x364fd5=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x133)]],_0x588b3a=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x158)]],_0x33f5ff=[_0x321d22['body'][_0x2a8377(0x151)]],_0x3c8454=[_0x321d22['body'][_0x2a8377(0xa5)]],_0x424710=[_0x321d22['body'][_0x2a8377(0x17d)]],_0x1ea0aa=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x14d)]],_0x3d6195=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x171)]],_0xce6b71=[_0x321d22[_0x2a8377(0x124)][_0x2a8377(0x11b)]],_0x1299e4=[_0x321d22['body']['uuid']],_0x341ef5=[_0x321d22[_0x2a8377(0x124)]['gross_price']];else var _0x3e6d5f=[..._0x321d22[_0x2a8377(0x124)][_0x2a8377(0x9e)]],_0x29a535=[..._0x321d22['body'][_0x2a8377(0x187)]],_0x526474=[..._0x321d22[_0x2a8377(0x124)]['carton']],_0x485d99=[..._0x321d22[_0x2a8377(0x124)][_0x2a8377(0xac)]],_0x27a2dd=[..._0x321d22[_0x2a8377(0x124)]['secondary_code']],_0x1b6e0a=[..._0x321d22[_0x2a8377(0x124)][_0x2a8377(0x16d)]],_0x159d44=[..._0x321d22[_0x2a8377(0x124)]['level2']],_0x30baae=[..._0x321d22['body'][_0x2a8377(0x12d)]],_0x561aaa=[..._0x321d22[_0x2a8377(0x124)][_0x2a8377(0x162)]],_0x364fd5=[..._0x321d22['body'][_0x2a8377(0x133)]],_0x588b3a=[..._0x321d22[_0x2a8377(0x124)][_0x2a8377(0x158)]],_0x33f5ff=[..._0x321d22[_0x2a8377(0x124)]['product_date']],_0x3c8454=[..._0x321d22[_0x2a8377(0x124)][_0x2a8377(0xa5)]],_0x424710=[..._0x321d22[_0x2a8377(0x124)][_0x2a8377(0x17d)]],_0x1ea0aa=[..._0x321d22['body'][_0x2a8377(0x14d)]],_0x3d6195=[..._0x321d22['body'][_0x2a8377(0x171)]],_0xce6b71=[..._0x321d22['body'][_0x2a8377(0x11b)]],_0x1299e4=[..._0x321d22['body'][_0x2a8377(0xdc)]],_0x341ef5=[..._0x321d22[_0x2a8377(0x124)][_0x2a8377(0xe7)]];const _0x11cee3=_0x3e6d5f[_0x2a8377(0x175)](_0x358e7d=>{return _0x358e7d={'product_name':_0x358e7d};});_0x29a535[_0x2a8377(0x9f)]((_0x1749c7,_0x4abee9)=>{var _0xb03895=_0x2a8377;_0x11cee3[_0x4abee9][_0xb03895(0x187)]=_0x1749c7;}),_0x526474[_0x2a8377(0x9f)]((_0x322249,_0xa899d2)=>{var _0x5ebdee=_0x2a8377;_0x11cee3[_0xa899d2][_0x5ebdee(0x129)]=Math[_0x5ebdee(0x1bb)](_0x322249);}),_0x3e6d5f[_0x2a8377(0x9f)]((_0x2eab00,_0x3cefae)=>{var _0x522dbc=_0x2a8377;_0x11cee3[_0x3cefae][_0x522dbc(0x166)]=_0x321d22[_0x522dbc(0x124)][_0x522dbc(0x19b)];}),_0x341ef5[_0x2a8377(0x9f)]((_0x1846b7,_0x4a295b)=>{var _0x1fbc76=_0x2a8377;_0x11cee3[_0x4a295b][_0x1fbc76(0xe7)]=_0x1846b7;}),_0x1299e4[_0x2a8377(0x9f)]((_0x2c8214,_0x435c0f)=>{var _0x591afe=_0x2a8377;_0x11cee3[_0x435c0f][_0x591afe(0xdc)]=_0x2c8214;}),_0xce6b71[_0x2a8377(0x9f)]((_0x1a3314,_0x2070be)=>{var _0x3fb141=_0x2a8377;_0x11cee3[_0x2070be][_0x3fb141(0x11b)]=_0x1a3314;}),_0x485d99[_0x2a8377(0x9f)]((_0x547263,_0x88e938)=>{var _0x387059=_0x2a8377;_0x11cee3[_0x88e938][_0x387059(0xac)]=_0x547263;}),_0x27a2dd[_0x2a8377(0x9f)]((_0x2ef071,_0x4e5e44)=>{var _0x4ee45f=_0x2a8377;_0x11cee3[_0x4e5e44][_0x4ee45f(0xbe)]=_0x2ef071;}),_0x1b6e0a[_0x2a8377(0x9f)]((_0x47d9df,_0x566f23)=>{_0x11cee3[_0x566f23]['product_code']=_0x47d9df;}),_0x159d44[_0x2a8377(0x9f)]((_0x38f246,_0xcaa21d)=>{var _0x1ce686=_0x2a8377,_0x4f9588=_0x38f246[_0x1ce686(0x1a5)](/[A-Za-z]+/)[0x0],_0x194648=parseInt(_0x38f246[_0x1ce686(0x1a5)](/\d+/)[0x0]);_0x11cee3[_0xcaa21d][_0x1ce686(0x17f)]=_0x194648,_0x11cee3[_0xcaa21d]['level']=_0x4f9588;}),_0x30baae['forEach']((_0x22187f,_0x359b68)=>{var _0x24ee2b=_0x2a8377;_0x11cee3[_0x359b68][_0x24ee2b(0x110)]=_0x22187f;}),_0x561aaa[_0x2a8377(0x9f)]((_0x17d7ce,_0xe0a119)=>{var _0x586a97=_0x2a8377;_0x11cee3[_0xe0a119][_0x586a97(0x162)]=_0x17d7ce;}),_0x364fd5[_0x2a8377(0x9f)]((_0x676c52,_0xa3c237)=>{var _0x4ed34f=_0x2a8377;_0x11cee3[_0xa3c237][_0x4ed34f(0x133)]=_0x676c52;}),_0x588b3a[_0x2a8377(0x9f)]((_0x10a4f5,_0x2526ba)=>{var _0xdeac13=_0x2a8377;_0x11cee3[_0x2526ba][_0xdeac13(0x158)]=_0x10a4f5;}),_0x33f5ff[_0x2a8377(0x9f)]((_0x5c60ce,_0x4bf357)=>{var _0x331ded=_0x2a8377;_0x11cee3[_0x4bf357][_0x331ded(0x13b)]=_0x5c60ce;}),_0x3c8454[_0x2a8377(0x9f)]((_0xf47e62,_0x36e8aa)=>{var _0x49b8ca=_0x2a8377;_0x11cee3[_0x36e8aa][_0x49b8ca(0xef)]=_0xf47e62;}),_0x424710[_0x2a8377(0x9f)]((_0x2bb7a4,_0x104cd3)=>{var _0x57b16a=_0x2a8377;_0x11cee3[_0x104cd3][_0x57b16a(0x17d)]=_0x2bb7a4;}),_0x1ea0aa[_0x2a8377(0x9f)]((_0x3d740f,_0x574ba0)=>{_0x11cee3[_0x574ba0]['room_name']=_0x3d740f;}),_0x3d6195[_0x2a8377(0x9f)]((_0x31084d,_0x216db0)=>{var _0xebac3f=_0x2a8377;_0x11cee3[_0x216db0]['invoice']=_0x31084d,_0x11cee3[_0x216db0][_0xebac3f(0xaa)]=_0x2a592e;});const _0x7ea75d=new sales_logs();await _0x7ea75d[_0x2a8377(0x107)](),_0x3d6195[_0x2a8377(0x9f)]((_0x303432,_0xb419a4)=>{var _0x422657=_0x2a8377;_0x11cee3[_0xb419a4][_0x422657(0x155)]=_0x422657(0x11f)+_0x7ea75d['invoice_init'][_0x422657(0x9d)]()[_0x422657(0x181)](0x8,'0');});var _0x5f361c=0x0;_0x11cee3[_0x2a8377(0x9f)](_0x17c86e=>{var _0x37308e=_0x2a8377;parseFloat(_0x17c86e[_0x37308e(0x187)])<parseFloat(_0x17c86e[_0x37308e(0x129)])&&parseFloat(_0x17c86e[_0x37308e(0x129)])>parseFloat(_0x17c86e[_0x37308e(0x187)])&&(console['log'](_0x17c86e[_0x37308e(0x187)]+_0x37308e(0xf6)+_0x17c86e['quantity']),_0x5f361c++);});if(_0x5f361c!=0x0)return _0x321d22[_0x2a8377(0x1a9)](_0x2a8377(0x179),_0x2a8377(0xe4)),_0x111543[_0x2a8377(0x18b)]('back');const _0x2e11d7=_0x11cee3[_0x2a8377(0x182)](_0x49ad71=>_0x49ad71[_0x2a8377(0x129)]!=='0'&&_0x49ad71[_0x2a8377(0x129)]!==''),_0x257c11=new sales_finished({'invoice':_0x2a8377(0x11f)+_0x7ea75d['invoice_init']['toString']()[_0x2a8377(0x181)](0x8,'0'),'sales_data':_0x321d22['body']['sales'],'customer':_0x321d22['body'][_0x2a8377(0xe2)],'date':_0x2a592e,'warehouse_name':_0x39b72a,'sale_product':_0x2e11d7,'note':_0x5f1bf4,'room':_0x5a6239,'primary_code':_0x62758b,'secondary_code':_0x3a29b4,'prod_code':_0x3960d9,'SCRN':_0xf4739e,'finalize':'False','mode_transpo':_0x40833a,'name_driver':_0x58eb97,'ReqBy':_0x4663e1,'dateofreq':_0x4244c2,'PO_number':_0x605102,'typeservicesData':_0x1cf036,'typevehicle':_0x1156fb,'destination':_0x1d4d72,'deliverydate':_0xa1625a,'driver':_0x32bf21,'plate':_0x918355,'van':_0x5ca136,'DRSI':_0x3aa2b4,'TSU':_0x185be4,'TFU':_0x19fb2d,'typeOfProducts':_0x333a30}),_0x1c1789=await _0x257c11['save'](),_0x108f66=await sales_finished[_0x2a8377(0x10a)]({'invoice':_0x2c9265});_0x321d22[_0x2a8377(0x1a9)](_0x2a8377(0x9c),'Sales\x20Add\x20successfully'),_0x111543[_0x2a8377(0x18b)]('/all_sales_finished/preview/'+_0x1c1789[_0x2a8377(0x194)]);}catch(_0x283e71){console[_0x2a8377(0xc3)](_0x283e71);}}),router[a0_0x4e7a4a(0xb1)](a0_0x4e7a4a(0xcd),auth,async(_0x38084f,_0x216aa5)=>{var _0x26acb7=a0_0x4e7a4a;try{const _0x4bffd3=_0x38084f['params']['id'];console[_0x26acb7(0xc3)](_0x4bffd3);const _0x3bf6b5=await product['find'](),_0x417d0a=await purchases[_0x26acb7(0xfa)]([{'$match':{'warehouse_name':_0x4bffd3}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]);console[_0x26acb7(0xc3)](_0x26acb7(0xa8),_0x417d0a),_0x216aa5[_0x26acb7(0x15d)](0xc8)[_0x26acb7(0xeb)]({'purchases_data':_0x417d0a,'product_data':_0x3bf6b5});}catch(_0x20019a){console[_0x26acb7(0xc3)](_0x20019a);}}),router[a0_0x4e7a4a(0xbc)]('/view/add_sale/product',auth,async(_0x3700fd,_0x2af25a)=>{var _0x535855=a0_0x4e7a4a;try{const {warehouse_data:_0x3bbd8d,product_data:_0x5296a3}=_0x3700fd['body'];console[_0x535855(0xc3)](_0x3700fd[_0x535855(0x124)][_0x535855(0xa7)]);;const _0x5a4118=await master_shop[_0x535855(0x103)]();console['log']('master',_0x5a4118);const _0x4194f1=await product[_0x535855(0x10a)]({'name':_0x5296a3});console[_0x535855(0xc3)](_0x535855(0x17b),_0x4194f1);const _0xc74d1a=await warehouse[_0x535855(0xfa)]([{'$match':{'name':_0x3bbd8d}},{'$unwind':_0x535855(0x127)},{'$match':{'product_details.product_name':_0x5296a3}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x535855(0xf4)}}}]);console[_0x535855(0xc3)](_0x535855(0x138),_0xc74d1a),_0x2af25a[_0x535855(0x15d)](0xc8)[_0x535855(0xeb)]({'master':_0x5a4118,'new_product':_0x4194f1,'stock_data':_0xc74d1a});}catch(_0x266622){console[_0x535855(0xc3)](_0x266622);}}),router[a0_0x4e7a4a(0xbc)]('/view/add_sales',auth,async(_0x437daf,_0x3c885a)=>{var _0x3d0979=a0_0x4e7a4a;try{const {invoice:_0x2f35ea,date:_0x177df8,warehouse_name:_0x160516,product_name:_0x4fe0d2,note:_0x212f67,room:_0x521428,primary_code:_0x4bb671,secondary_code:_0x284731,prod_code:_0xe507e1,SCRN:_0x294d3c,ReqBy:_0x5d2b86,dateofreq:_0x1adade,PO_number:_0xcd19c1,typeservicesData:_0x56ae4c,typevehicle:_0x1dae43,destination:_0x440ab4,deliverydate:_0x57fa35,driver:_0x4b479d,plate:_0x46cf29,van:_0x97f6a3,DRSI:_0x79bb1c,TSU:_0x46ba36,TFU:_0x2baf68,mode_transpo:_0x5caa9b,name_driver:_0x206523,pull_out_date:_0x1f07f1,actual_delivery_date:_0x5c2923}=_0x437daf['body'];if(typeof _0x4fe0d2==_0x3d0979(0x105))var _0x3d64f8=[_0x437daf[_0x3d0979(0x124)][_0x3d0979(0x9e)]],_0x1c2540=[_0x437daf[_0x3d0979(0x124)]['stock']],_0x3e1b74=[_0x437daf[_0x3d0979(0x124)]['carton']],_0x580257=[_0x437daf[_0x3d0979(0x124)][_0x3d0979(0xac)]],_0x1a151a=[_0x437daf[_0x3d0979(0x124)][_0x3d0979(0xbe)]],_0x3db45a=[_0x437daf['body'][_0x3d0979(0x16d)]],_0x4f28b8=[_0x437daf[_0x3d0979(0x124)]['level2']],_0x21c396=[_0x437daf[_0x3d0979(0x124)][_0x3d0979(0x12d)]],_0x647f18=[_0x437daf[_0x3d0979(0x124)]['secondary_unit']],_0x47ef20=[_0x437daf[_0x3d0979(0x124)][_0x3d0979(0x133)]],_0x26a951=[_0x437daf[_0x3d0979(0x124)][_0x3d0979(0x158)]],_0x7c5042=[_0x437daf[_0x3d0979(0x124)]['product_date']],_0x2d8fe0=[_0x437daf[_0x3d0979(0x124)]['max_per_unit']],_0x5d8320=[_0x437daf[_0x3d0979(0x124)]['prod_cat']],_0x2ada23=[_0x437daf[_0x3d0979(0x124)]['RoomAssigned']],_0x10dcd6=[_0x437daf['body'][_0x3d0979(0x171)]],_0x372151=[_0x437daf[_0x3d0979(0x124)]['id_transaction_from']],_0x44d644=[_0x437daf['body']['uuid']],_0x146235=[_0x437daf[_0x3d0979(0x124)]['gross_price']];else var _0x3d64f8=[..._0x437daf[_0x3d0979(0x124)]['product_name']],_0x1c2540=[..._0x437daf[_0x3d0979(0x124)]['stock']],_0x3e1b74=[..._0x437daf[_0x3d0979(0x124)]['carton']],_0x580257=[..._0x437daf[_0x3d0979(0x124)]['primary_code']],_0x1a151a=[..._0x437daf[_0x3d0979(0x124)]['secondary_code']],_0x3db45a=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x16d)]],_0x4f28b8=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x18d)]],_0x21c396=[..._0x437daf['body'][_0x3d0979(0x12d)]],_0x647f18=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x162)]],_0x47ef20=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x133)]],_0x26a951=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x158)]],_0x7c5042=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x151)]],_0x2d8fe0=[..._0x437daf['body'][_0x3d0979(0xa5)]],_0x5d8320=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x17d)]],_0x2ada23=[..._0x437daf[_0x3d0979(0x124)]['RoomAssigned']],_0x10dcd6=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x171)]],_0x372151=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0x11b)]],_0x44d644=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0xdc)]],_0x146235=[..._0x437daf[_0x3d0979(0x124)][_0x3d0979(0xe7)]];const _0x5026ba=_0x3d64f8[_0x3d0979(0x175)](_0x1f10c5=>{return _0x1f10c5={'product_name':_0x1f10c5};});_0x1c2540[_0x3d0979(0x9f)]((_0x50223f,_0x55fe28)=>{var _0x51474c=_0x3d0979;_0x5026ba[_0x55fe28][_0x51474c(0x187)]=_0x50223f;}),_0x3e1b74['forEach']((_0x457ec8,_0x17bfa7)=>{var _0x4a584b=_0x3d0979;_0x5026ba[_0x17bfa7][_0x4a584b(0x129)]=Math[_0x4a584b(0x1bb)](_0x457ec8);}),_0x3d64f8[_0x3d0979(0x9f)]((_0x169fc4,_0x4313d3)=>{var _0x19e300=_0x3d0979;_0x5026ba[_0x4313d3][_0x19e300(0x166)]=_0x437daf['body'][_0x19e300(0x19b)];}),_0x146235[_0x3d0979(0x9f)]((_0x4d3378,_0x252cce)=>{_0x5026ba[_0x252cce]['gross_price']=_0x4d3378;}),_0x44d644[_0x3d0979(0x9f)]((_0x491537,_0xd3e15)=>{_0x5026ba[_0xd3e15]['uuid']=_0x491537;}),_0x372151[_0x3d0979(0x9f)]((_0x454b19,_0x2fcc7c)=>{var _0x2e588e=_0x3d0979;_0x5026ba[_0x2fcc7c][_0x2e588e(0x11b)]=_0x454b19;}),_0x580257[_0x3d0979(0x9f)]((_0x32e03d,_0x42282f)=>{var _0x52f918=_0x3d0979;_0x5026ba[_0x42282f][_0x52f918(0xac)]=_0x32e03d;}),_0x1a151a[_0x3d0979(0x9f)]((_0x137d49,_0x2c2824)=>{var _0x1a4bff=_0x3d0979;_0x5026ba[_0x2c2824][_0x1a4bff(0xbe)]=_0x137d49;}),_0x3db45a[_0x3d0979(0x9f)]((_0x2a663f,_0x3ea7af)=>{var _0x576166=_0x3d0979;_0x5026ba[_0x3ea7af][_0x576166(0x143)]=_0x2a663f;}),_0x4f28b8[_0x3d0979(0x9f)]((_0x38acd6,_0x219f75)=>{var _0x4d7acb=_0x3d0979,_0x57e202=_0x38acd6['match'](/[A-Za-z]+/)[0x0],_0x4b50d2=parseInt(_0x38acd6[_0x4d7acb(0x1a5)](/\d+/)[0x0]);_0x5026ba[_0x219f75][_0x4d7acb(0x17f)]=_0x4b50d2,_0x5026ba[_0x219f75][_0x4d7acb(0x189)]=_0x57e202;}),_0x21c396[_0x3d0979(0x9f)]((_0x518de5,_0x397500)=>{var _0x45886c=_0x3d0979;_0x5026ba[_0x397500][_0x45886c(0x110)]=_0x518de5;}),_0x647f18[_0x3d0979(0x9f)]((_0x5ab86f,_0x35f5fc)=>{var _0x411616=_0x3d0979;_0x5026ba[_0x35f5fc][_0x411616(0x162)]=_0x5ab86f;}),_0x47ef20[_0x3d0979(0x9f)]((_0x3fd2dd,_0x2385c2)=>{var _0x2965f0=_0x3d0979;_0x5026ba[_0x2385c2][_0x2965f0(0x133)]=_0x3fd2dd;}),_0x26a951[_0x3d0979(0x9f)]((_0x5a824a,_0x529a07)=>{var _0x5506e6=_0x3d0979;_0x5026ba[_0x529a07][_0x5506e6(0x158)]=_0x5a824a;}),_0x7c5042[_0x3d0979(0x9f)]((_0x172389,_0x1d9a4c)=>{_0x5026ba[_0x1d9a4c]['production_date']=_0x172389;}),_0x2d8fe0['forEach']((_0x12fd39,_0x4d47fe)=>{var _0x4e3051=_0x3d0979;_0x5026ba[_0x4d47fe][_0x4e3051(0xef)]=_0x12fd39;}),_0x5d8320[_0x3d0979(0x9f)]((_0x41f4b3,_0x318b4a)=>{_0x5026ba[_0x318b4a]['prod_cat']=_0x41f4b3;}),_0x2ada23[_0x3d0979(0x9f)]((_0x1c06ea,_0xb32c48)=>{var _0x310625=_0x3d0979;_0x5026ba[_0xb32c48][_0x310625(0xff)]=_0x1c06ea;}),_0x10dcd6[_0x3d0979(0x9f)]((_0x2ddef2,_0x481f85)=>{var _0x47e2e9=_0x3d0979;_0x5026ba[_0x481f85]['invoice']=_0x2ddef2,_0x5026ba[_0x481f85][_0x47e2e9(0xaa)]=_0x177df8;});const _0x3c8872=new invoice_for_outgoing();await _0x3c8872[_0x3d0979(0x107)](),_0x10dcd6[_0x3d0979(0x9f)]((_0x3cb6e5,_0x15478f)=>{var _0x4ffb13=_0x3d0979;_0x5026ba[_0x15478f][_0x4ffb13(0x155)]=_0x4ffb13(0x116)+_0x3c8872[_0x4ffb13(0x122)]['toString']()[_0x4ffb13(0x181)](0x8,'0');});var _0x194b32=0x0;_0x5026ba[_0x3d0979(0x9f)](_0x4adfc4=>{var _0x1150e4=_0x3d0979;parseFloat(_0x4adfc4[_0x1150e4(0x187)])<parseFloat(_0x4adfc4[_0x1150e4(0x129)])&&parseFloat(_0x4adfc4[_0x1150e4(0x129)])>parseFloat(_0x4adfc4[_0x1150e4(0x187)])&&(console[_0x1150e4(0xc3)](_0x4adfc4[_0x1150e4(0x187)]+_0x1150e4(0xf6)+_0x4adfc4[_0x1150e4(0x129)]),_0x194b32++);});if(_0x194b32!=0x0)return _0x437daf[_0x3d0979(0x1a9)]('errors',_0x3d0979(0xe4)),_0x3c885a['redirect']('back');const _0x570d51=_0x5026ba[_0x3d0979(0x182)](_0x126f47=>_0x126f47[_0x3d0979(0x129)]!=='0'&&_0x126f47[_0x3d0979(0x129)]!==''),_0x1f7c3c=new sales_finished({'invoice':_0x3d0979(0x116)+_0x3c8872[_0x3d0979(0x122)][_0x3d0979(0x9d)]()[_0x3d0979(0x181)](0x8,'0'),'sales_data':_0x437daf[_0x3d0979(0x124)][_0x3d0979(0x19b)],'customer':_0x437daf[_0x3d0979(0x124)][_0x3d0979(0xe2)],'date':_0x177df8,'warehouse_name':_0x160516,'sale_product':_0x570d51,'note':_0x212f67,'room':_0x521428,'primary_code':_0x4bb671,'secondary_code':_0x284731,'prod_code':_0xe507e1,'SCRN':_0x294d3c,'finalize':_0x3d0979(0x19d),'mode_transpo':_0x5caa9b,'name_driver':_0x206523,'ReqBy':_0x5d2b86,'dateofreq':_0x1adade,'PO_number':_0xcd19c1,'typeservicesData':_0x56ae4c,'typevehicle':_0x1dae43,'destination':_0x440ab4,'deliverydate':_0x57fa35,'driver':_0x4b479d,'plate':_0x46cf29,'van':_0x97f6a3,'DRSI':_0x79bb1c,'TSU':_0x46ba36,'TFU':_0x2baf68,'pullout_date':_0x1f07f1,'actualdelivery_date':_0x5c2923,'typeOfProducts':_0x3d0979(0xd5)}),_0x54754d=await _0x1f7c3c[_0x3d0979(0x107)](),_0x3bdd90=await sales_finished['findOne']({'invoice':_0x2f35ea});_0x437daf[_0x3d0979(0x1a9)](_0x3d0979(0x9c),_0x3d0979(0xc5)),_0x3c885a[_0x3d0979(0x18b)]('/all_sales_finished/preview/'+_0x54754d[_0x3d0979(0x194)]);}catch(_0x37987b){console[_0x3d0979(0xc3)](_0x37987b);}}),router['get'](a0_0x4e7a4a(0xf3),auth,async(_0x819038,_0x31751f)=>{var _0x4e1c43=a0_0x4e7a4a;try{const {username:_0x1eb62b,email:_0x57be38,role:_0x5659a1}=_0x819038['user'],_0xe1a2df=_0x819038[_0x4e1c43(0xc9)],_0x3f3205=await profile[_0x4e1c43(0x10a)]({'email':_0xe1a2df[_0x4e1c43(0x190)]}),_0x5c961e=await master_shop['find'](),_0x40c194=_0x819038[_0x4e1c43(0xcf)]['id'],_0x539cc9=await sales_finished[_0x4e1c43(0xf8)](_0x40c194),_0x544a52=await warehouse[_0x4e1c43(0xfa)]([{'$match':{'name':_0x539cc9[_0x4e1c43(0x118)]}},{'$unwind':_0x4e1c43(0x127)},{'$group':{'_id':_0x4e1c43(0xa1),'name':{'$first':_0x4e1c43(0x10e)},'product_stock':{'$first':_0x4e1c43(0xf4)},'bay':{'$first':_0x4e1c43(0x1b2)},'bin':{'$first':_0x4e1c43(0xc2)},'type':{'$first':_0x4e1c43(0x14b)},'floorlevel':{'$first':_0x4e1c43(0x154)},'primary_code':{'$first':_0x4e1c43(0xc6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4e1c43(0xb8)},'storage':{'$first':_0x4e1c43(0x11a)},'rack':{'$first':_0x4e1c43(0x125)},'expiry_date':{'$first':_0x4e1c43(0xfb)},'production_date':{'$first':_0x4e1c43(0x1b8)},'batch_code':{'$first':_0x4e1c43(0x18c)},'room':{'$first':_0x4e1c43(0xbf)},'room_data':{'$first':_0x4e1c43(0xf1)}}}]),_0x42a0ab=await customer[_0x4e1c43(0x103)]({});let _0x172b0f;if(_0xe1a2df[_0x4e1c43(0x135)]==_0x4e1c43(0x1a8)){const _0x5ccc82=await staff['findOne']({'email':_0xe1a2df[_0x4e1c43(0x190)]});_0x172b0f=await warehouse[_0x4e1c43(0xfa)]([{'$match':{'status':_0x4e1c43(0x16a),'name':_0x5ccc82[_0x4e1c43(0xd0)]}},{'$group':{'_id':_0x4e1c43(0xdd),'name':{'$first':_0x4e1c43(0xdd)}}}]);}else _0x172b0f=await warehouse[_0x4e1c43(0xfa)]([{'$match':{'status':_0x4e1c43(0x16a)}},{'$group':{'_id':_0x4e1c43(0xdd),'name':{'$first':_0x4e1c43(0xdd)}}}]);const _0x2384be=await product[_0x4e1c43(0x103)]({});if(_0x5c961e[0x0][_0x4e1c43(0x192)]==_0x4e1c43(0x161)){var _0x51a1b7=users[_0x4e1c43(0xce)];console[_0x4e1c43(0xc3)](_0x51a1b7);}else{if(_0x5c961e[0x0][_0x4e1c43(0x192)]=='Hindi')var _0x51a1b7=users[_0x4e1c43(0xc8)];else{if(_0x5c961e[0x0][_0x4e1c43(0x192)]=='German')var _0x51a1b7=users[_0x4e1c43(0x1b1)];else{if(_0x5c961e[0x0][_0x4e1c43(0x192)]=='Spanish')var _0x51a1b7=users['Spanish'];else{if(_0x5c961e[0x0][_0x4e1c43(0x192)]=='French')var _0x51a1b7=users[_0x4e1c43(0x157)];else{if(_0x5c961e[0x0]['language']=='Portuguese\x20(BR)')var _0x51a1b7=users['Portuguese'];else{if(_0x5c961e[0x0][_0x4e1c43(0x192)]==_0x4e1c43(0x12c))var _0x51a1b7=users[_0x4e1c43(0x12c)];else{if(_0x5c961e[0x0][_0x4e1c43(0x192)]=='Arabic\x20(ae)')var _0x51a1b7=users['Arabic'];}}}}}}}_0x31751f[_0x4e1c43(0x173)](_0x4e1c43(0xe3),{'success':_0x819038[_0x4e1c43(0x1a9)](_0x4e1c43(0x9c)),'errors':_0x819038[_0x4e1c43(0x1a9)]('errors'),'role':_0xe1a2df,'profile':_0x3f3205,'customer':_0x42a0ab,'warehouse':_0x172b0f,'product':_0x544a52,'user':_0x539cc9,'master_shop':_0x5c961e,'unit':_0x2384be,'language':_0x51a1b7});}catch(_0x247036){console[_0x4e1c43(0xc3)](_0x247036);}});async function dataUpdate(_0x38ecbb,_0x58e465,_0x829af5){var _0x45b31a=a0_0x4e7a4a;return await warehouse['updateOne']({'_id':_0x38ecbb,'product_details._id':_0x58e465},{'$set':{'product_details.$.product_stock':_0x829af5}}),await warehouse[_0x45b31a(0xf8)](_0x38ecbb);}function a0_0x3331(){var _0x38587f=['<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','/view/add_sales/:id','English','params','warehouse','$sale_product.bin','\x20&&\x20','secondary_unit_QA','sales\x20item\x20return\x20successfull','own','maxPerUnit_QA','sales_quantity','catch','</td>','currency_placement','$product_details.product_cat','uuid','$name','<h5>','380850KRMrUz','$product_details.unit','$product_details.sales_category','customer','edit_sales_finished_view','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','<h2>\x20','getMonth','gross_price','master','$date','Finished\x20Goods','json','stocks_QA','gmail','return_qty_QA','maxperunit','$product_details.level','$product_details.room_name','express','/preview/:id','$product_details.product_stock','received_amount','\x20<>\x20','sale_product','findById','10748507GLdpOf','aggregate','$product_details.expiry_date','</body></html>','$invoice','push','room_name','<strong>\x20Regards\x20</strong>','date','undefined','find','final','string','add\x20post','save','../middleware/auth','$sale_product.type','findOne','$sale_product.quantity','Portuguese','$sale_product','$product_details.product_name','split','unit','all','\x20</h2>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','warehouse_id','OUT-','slice','warehouse_name','batch_code_QA','$product_details.storage','id_transaction_from','maxProducts_QA','/view/add_sales','foreach\x20newproduct','LOG-OUT-','payment\x20successfull','max','invoice_init','site_title','body','$product_details.rack','carton','$product_details','Sales\x20Update\x20successfully','quantity','logo','$note','Chinese','primary_unit','<tr>','$product_details.maxPerUnit','Portuguese\x20(BR)','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','currency','batch_code','$product_details.type_products','role','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','secondary_code_QA','stock_data','/view/add_sales_logs','$customer','production_date','../models/all_models','1663432iJvrtB','Sale\x20Return\x20Mail','Sale\x20Return','room','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','product_code','\x20Order\x20Number\x20:\x20','</h5>','for_categorize','</div>','adjust_qty','<html><head><title></title>','OUTF-','$product_details.type','<tbody\x20style=\x22text-align:\x20center;\x22>','RoomAssigned','all_sales_finished','return_sale','</tbody>','product_date','amount','length','$product_details.floorlevel','outgoing_invoice','Error\x20Occurs','French','expiry_date','return_sale_finished','$product_details.invoice','then','return_sale_QA','status','unit_QA','/invoice/:id','exports','English\x20(US)','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','createTransport','/barcode/:id','agent_id','</span>','/all_sales_finished/view','Email\x20sent\x20successfully','Enabled','Arabic','<hr\x20class=\x22my-3\x22>','prod_code','add_sales_finished','/upload/','Arabic\x20(ae)','prod_invoice','/all_sales/view','render','note','map','<h5\x20style=\x22text-align:\x20left;\x22>','1437465MbHGUy','invoice','errors','back','product','production_date_QA','prod_cat','product_list','bay','/view','padStart','filter','sendMail','Enclosed','logs','$sale_product.floorlevel','stock','$finalize','level','image','redirect','$product_details.batch_code','level2','/../public','sales_invoice','email','$customers_docs','language','all_sales_barcode','_id','Logo.png','$sale_product.bay','</thead>','\x20Order\x20Date\x20:\x20','maxProducts','Spanish','sales','$product_details.maxProducts','False','barcode\x20user_id','sales_quantity_QA','$return_data','</table>','</head><body>','product_name_QA1','maxPerUnit','match','<span\x20style=\x22float:\x20right;\x22>','Return\x20Goods','staff','flash','448480MfMsyA','finalize','concat','message','expiry_date_QA','password','<table\x20style=\x22width:\x20100%\x20!important;\x22>','German','$product_details.bay','/view/:id','Quality\x20Inspection','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<!DOCTYPE\x20html>','</tr>','$product_details.production_date','return_data','/view/return_sales/:id','abs','success','toString','product_name','forEach','product_details','$product_details._id','$product_details.secondary_code','Return\x20Rooms','/barcode_scanner','max_per_unit','$product_details.secondary_unit','product_data','purchases_data','$warehouse_name','date_data','Received\x20Payment\x20For\x20Sale','primary_code','$product_details.gross_price','random','$product_details.uuid','return_qty','get','/picking_list/pdf/','getDate','Router','edit_sales_finished','576776zyLSou','\x20==\x20','$product_details.product_code','$_id','1130232LGcGpM','True','post','Ambient','secondary_code','$room','<div>','sale_qty','$product_details.bin','log','product_stock','Sales\x20Add\x20successfully','$product_details.primary_code','barcode\x20Product\x20master','Hindi','user','primary_code_QA','suppliers'];a0_0x3331=function(){return _0x38587f;};return a0_0x3331();}router['post'](a0_0x4e7a4a(0xf3),auth,async(_0x3e61b1,_0x18740b)=>{var _0x503e62=a0_0x4e7a4a;try{const _0x3c5551=_0x3e61b1[_0x503e62(0xcf)]['id'],{invoice:_0xc671f3,warehouse_name:_0x1079e8,room:_0x498275}=_0x3e61b1['body'],_0x4f5f65=await sales_finished[_0x503e62(0x10a)]({'invoice':_0xc671f3});for(let _0x1a0fbf=0x0;_0x1a0fbf<=_0x4f5f65[_0x503e62(0xf7)][_0x503e62(0x153)]-0x1;_0x1a0fbf++){const _0x2a7c17=_0x4f5f65[_0x503e62(0xf7)][_0x1a0fbf];var _0x30d780=await warehouse[_0x503e62(0x10a)]({'name':_0x1079e8,'room':_0x2a7c17[_0x503e62(0xff)]}),_0x1f9054=0x0;for(let _0x225542=0x0;_0x225542<=_0x30d780[_0x503e62(0xa0)]['length']-0x1;_0x225542++){const _0x2593be=_0x30d780[_0x503e62(0xa0)][_0x225542];_0x2593be[_0x503e62(0x194)]==_0x2a7c17[_0x503e62(0x11b)]&&_0x2593be['uuid']==_0x2a7c17['uuid']&&(_0x1f9054=Math[_0x503e62(0x121)](0x0,Math[_0x503e62(0x1bb)](_0x2593be[_0x503e62(0xc4)])-Math[_0x503e62(0x1bb)](_0x2a7c17[_0x503e62(0x129)])),await warehouse['updateOne']({'_id':_0x30d780[_0x503e62(0x194)]['valueOf'](),'product_details._id':_0x2593be['_id']['valueOf'](),'product_details.uuid':_0x2a7c17[_0x503e62(0xdc)]},{'$set':{'product_details.$.product_stock':_0x1f9054}}));}console[_0x503e62(0xc3)](typeof _0x2a7c17['agent_id']);if(typeof _0x2a7c17['agent_id']!==_0x503e62(0x102)){var _0x52ea67=await staff[_0x503e62(0xf8)](_0x2a7c17['agent_id']);console[_0x503e62(0xc3)]('here');var _0x23c327=0x0;for(let _0x44ea46=0x0;_0x44ea46<=_0x52ea67['product_list']['length']-0x1;_0x44ea46++){const _0x49ed1a=_0x52ea67[_0x503e62(0x17e)][_0x44ea46];console[_0x503e62(0xc3)](_0x2a7c17[_0x503e62(0x11b)]+_0x503e62(0xb7)+_0x49ed1a[_0x503e62(0x115)]+_0x503e62(0xd2)+_0x2a7c17[_0x503e62(0x194)]+'\x20==\x20'+_0x2a7c17['_id']),_0x2a7c17['id_transaction_from']==_0x49ed1a['warehouse_id']&&_0x2a7c17['_id']==0x1&&(_0x49ed1a['product_stock']=Math[_0x503e62(0x1bb)](_0x49ed1a[_0x503e62(0xc4)])+Math['abs'](_0x2a7c17[_0x503e62(0x129)]),_0x23c327++);}console[_0x503e62(0xc3)]('int',_0x23c327),_0x23c327=='0'&&(_0x52ea67[_0x503e62(0x17e)]=_0x52ea67['product_list'][_0x503e62(0x1ac)]({'product_name':_0x2a7c17[_0x503e62(0x9e)],'product_stock':_0x2a7c17[_0x503e62(0x129)],'bay':_0x2a7c17[_0x503e62(0x17f)],'level':_0x2a7c17[_0x503e62(0x189)],'product_code':_0x2a7c17[_0x503e62(0x143)],'primary_code':_0x2a7c17[_0x503e62(0xac)],'secondary_code':_0x2a7c17[_0x503e62(0xbe)],'expiry_date':_0x2a7c17['expiry_date'],'production_date':_0x2a7c17[_0x503e62(0x13b)],'maxProducts':_0x2a7c17[_0x503e62(0x199)],'batch_code':_0x2a7c17[_0x503e62(0x133)],'secondary_unit':_0x2a7c17['secondary_unit'],'unit':_0x2a7c17[_0x503e62(0x110)],'maxProducts':_0x2a7c17[_0x503e62(0x199)],'maxPerUnit':_0x2a7c17[_0x503e62(0xef)],'invoice':_0x2a7c17['invoice'],'warehouse_id':_0x2a7c17[_0x503e62(0x11b)],'id_incoming':_0x2a7c17['_id'],'uuid':_0x2a7c17[_0x503e62(0xdc)],'gross_price':_0x2a7c17[_0x503e62(0xe7)],'date_incoming':_0x2a7c17[_0x503e62(0xaa)],'outgoing_invoice':_0x2a7c17[_0x503e62(0x155)]}),await _0x52ea67[_0x503e62(0x107)]());}}_0x4f5f65[_0x503e62(0x1ab)]=_0x503e62(0xbb);const _0x5c8c08=await _0x4f5f65['save'](),_0x3a6acd=await master_shop['find'](),_0x13002a=await email_settings[_0x503e62(0x10a)](),_0x5a4457=await supervisor_settings['find']();var _0x494f90=_0x4f5f65['sale_product'],_0xe921e0='',_0x2979d6;for(_0x2979d6 in _0x494f90){_0xe921e0+=_0x503e62(0x12e)+_0x503e62(0x131)+_0x494f90[_0x2979d6][_0x503e62(0x9e)]+_0x503e62(0xd9)+_0x503e62(0x131)+_0x494f90[_0x2979d6]['product_code']+'</td>'+_0x503e62(0x131)+_0x494f90[_0x2979d6][_0x503e62(0x129)]+_0x503e62(0xd9)+_0x503e62(0x131)+_0x494f90[_0x2979d6][_0x503e62(0x110)]+_0x503e62(0xd9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x494f90[_0x2979d6]['secondary_unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4f5f65[_0x503e62(0x118)]+_0x503e62(0xd9)+_0x503e62(0x131)+_0x494f90[_0x2979d6][_0x503e62(0xff)]+'</td>'+_0x503e62(0x131)+_0x494f90[_0x2979d6][_0x503e62(0x17f)]+_0x503e62(0xd9);}_0x3e61b1['flash']('success',_0x503e62(0x128)),_0x18740b['redirect'](_0x503e62(0xb2)+_0x3c5551);}catch(_0x3ec11b){console[_0x503e62(0xc3)](_0x3ec11b);}}),router[a0_0x4e7a4a(0xb1)]('/view/:id',auth,async(_0x4ca1ee,_0x525bae)=>{var _0x3b5025=a0_0x4e7a4a;try{const {username:_0x142462,email:_0x1980a6,role:_0x539580}=_0x4ca1ee[_0x3b5025(0xc9)],_0x35439c=_0x4ca1ee[_0x3b5025(0xc9)],_0x115503=await profile['findOne']({'email':_0x35439c[_0x3b5025(0x190)]}),_0x119c44=await master_shop[_0x3b5025(0x103)](),_0x208e39=_0x4ca1ee[_0x3b5025(0xcf)]['id'],_0xa02ee0=await sales_finished[_0x3b5025(0xf8)](_0x208e39);let _0x2943d0=new Date(_0xa02ee0['expiry_date']),_0x2cafea=('0'+_0x2943d0[_0x3b5025(0xb3)]())['slice'](-0x2),_0x527c48=('0'+(_0x2943d0[_0x3b5025(0xe6)]()+0x1))[_0x3b5025(0x117)](-0x2),_0x446ed0=_0x2943d0['getFullYear'](),_0x50fa7a=_0x446ed0+'-'+_0x527c48+'-'+_0x2cafea;var _0x56fe01=[_0x3b5025(0xbd),_0x3b5025(0x184)];const _0x63fd52=await warehouse[_0x3b5025(0xfa)]([{'$match':{'name':_0xa02ee0[_0x3b5025(0x118)],'room':_0xa02ee0['room']}},{'$unwind':_0x3b5025(0x127)},{'$group':{'_id':_0x3b5025(0xa1),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3b5025(0xf4)},'bay':{'$first':_0x3b5025(0x1b2)},'bin':{'$first':_0x3b5025(0xc2)},'type':{'$first':_0x3b5025(0x14b)},'floorlevel':{'$first':_0x3b5025(0x154)},'primary_code':{'$first':_0x3b5025(0xc6)},'secondary_code':{'$first':_0x3b5025(0xa2)},'product_code':{'$first':_0x3b5025(0xb8)},'storage':{'$first':_0x3b5025(0x11a)},'rack':{'$first':_0x3b5025(0x125)}}}]),_0x324213=await customer[_0x3b5025(0x103)]({});let _0xb0450a;if(_0x35439c[_0x3b5025(0x135)]==_0x3b5025(0x1a8)){const _0x19e3b8=await staff[_0x3b5025(0x10a)]({'email':_0x35439c[_0x3b5025(0x190)]});_0xb0450a=await warehouse[_0x3b5025(0xfa)]([{'$match':{'status':_0x3b5025(0x16a),'name':_0x19e3b8[_0x3b5025(0xd0)]}},{'$group':{'_id':_0x3b5025(0xdd),'name':{'$first':_0x3b5025(0xdd)}}}]);}else _0xb0450a=await warehouse[_0x3b5025(0xfa)]([{'$match':{'status':_0x3b5025(0x16a)}},{'$group':{'_id':_0x3b5025(0xdd),'name':{'$first':_0x3b5025(0xdd)}}}]);const _0x4e8c83=await product['find']({});if(_0x119c44[0x0][_0x3b5025(0x192)]==_0x3b5025(0x161)){var _0x148bc0=users[_0x3b5025(0xce)];console[_0x3b5025(0xc3)](_0x148bc0);}else{if(_0x119c44[0x0][_0x3b5025(0x192)]=='Hindi')var _0x148bc0=users[_0x3b5025(0xc8)];else{if(_0x119c44[0x0]['language']==_0x3b5025(0x1b1))var _0x148bc0=users[_0x3b5025(0x1b1)];else{if(_0x119c44[0x0][_0x3b5025(0x192)]==_0x3b5025(0x19a))var _0x148bc0=users[_0x3b5025(0x19a)];else{if(_0x119c44[0x0][_0x3b5025(0x192)]==_0x3b5025(0x157))var _0x148bc0=users[_0x3b5025(0x157)];else{if(_0x119c44[0x0]['language']=='Portuguese\x20(BR)')var _0x148bc0=users[_0x3b5025(0x10c)];else{if(_0x119c44[0x0][_0x3b5025(0x192)]==_0x3b5025(0x12c))var _0x148bc0=users['Chinese'];else{if(_0x119c44[0x0][_0x3b5025(0x192)]==_0x3b5025(0x170))var _0x148bc0=users[_0x3b5025(0x16b)];}}}}}}}_0x525bae[_0x3b5025(0x173)](_0x3b5025(0xb5),{'success':_0x4ca1ee[_0x3b5025(0x1a9)]('success'),'errors':_0x4ca1ee[_0x3b5025(0x1a9)]('errors'),'role':_0x35439c,'profile':_0x115503,'customer':_0x324213,'warehouse':_0xb0450a,'product':_0x63fd52,'user':_0xa02ee0,'master_shop':_0x119c44,'unit':_0x4e8c83,'language':_0x148bc0,'rooms_data':_0x56fe01,'ed_fullDate':_0x50fa7a});}catch(_0x324bfe){console['log'](_0x324bfe);}}),router[a0_0x4e7a4a(0xbc)](a0_0x4e7a4a(0x1b3),auth,async(_0x5924b3,_0x5abf90)=>{var _0x27c0e2=a0_0x4e7a4a;try{const _0x5986be=_0x5924b3[_0x27c0e2(0xcf)]['id'],_0x511176=await sales_finished[_0x27c0e2(0x10a)]({'_id':_0x5924b3[_0x27c0e2(0xcf)]['id']}),_0x515fd3=await warehouse[_0x27c0e2(0x10a)]({'name':_0x511176[_0x27c0e2(0x118)],'room':_0x5924b3[_0x27c0e2(0x124)]['room'],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x236954,customer:_0x1798df,date:_0x2ba8b5,warehouse_name:_0x36dc2f,product_name:_0x36d5dc,stock:_0xf6d420,adjust_qty:_0xe9e680,note:_0xd0c431,room:_0x6b9799,primary_code:_0x5df76d,secondary_code:_0x46940f,prod_code:_0x173fad,level:_0x17e00e,isle:_0x4de819,pallet:_0x387fef,expiry_date:_0x1030b8}=_0x5924b3[_0x27c0e2(0x124)];if(typeof _0x36d5dc==_0x27c0e2(0x105))var _0x1a9da2=[_0x5924b3[_0x27c0e2(0x124)]['product_name']],_0x32b297=[_0x5924b3[_0x27c0e2(0x124)][_0x27c0e2(0x187)]],_0x59540f=[_0x5924b3['body'][_0x27c0e2(0x148)]],_0x388330=[_0x5924b3[_0x27c0e2(0x124)][_0x27c0e2(0xac)]],_0x26ca0f=[_0x5924b3['body']['secondary_code']],_0x2e10b4=[_0x5924b3[_0x27c0e2(0x124)]['prod_code']],_0x440376=[_0x5924b3['body'][_0x27c0e2(0x189)]],_0x3034c2=[_0x5924b3['body'][_0x27c0e2(0x158)]];else var _0x1a9da2=[..._0x5924b3[_0x27c0e2(0x124)]['product_name']],_0x32b297=[..._0x5924b3['body'][_0x27c0e2(0x187)]],_0x59540f=[..._0x5924b3[_0x27c0e2(0x124)]['adjust_qty']],_0x388330=[..._0x5924b3[_0x27c0e2(0x124)][_0x27c0e2(0xac)]],_0x26ca0f=[..._0x5924b3['body'][_0x27c0e2(0xbe)]],_0x2e10b4=[..._0x5924b3[_0x27c0e2(0x124)][_0x27c0e2(0x16d)]],_0x440376=[..._0x5924b3[_0x27c0e2(0x124)]['level']],_0x3034c2=[..._0x5924b3[_0x27c0e2(0x124)][_0x27c0e2(0x158)]];const _0xdc810e=_0x1a9da2[_0x27c0e2(0x175)](_0x52871d=>{return _0x52871d={'product_name':_0x52871d};});_0x32b297[_0x27c0e2(0x9f)]((_0x482f54,_0x35be0f)=>{_0xdc810e[_0x35be0f]['stock']=_0x482f54;}),_0x59540f[_0x27c0e2(0x9f)]((_0x1f8e3a,_0x584698)=>{var _0x14ce6a=_0x27c0e2;_0xdc810e[_0x584698][_0x14ce6a(0x129)]=_0x1f8e3a;}),_0x388330['forEach']((_0x3f96b7,_0x5395b2)=>{var _0x39a4db=_0x27c0e2;_0xdc810e[_0x5395b2][_0x39a4db(0xac)]=_0x3f96b7;}),_0x26ca0f[_0x27c0e2(0x9f)]((_0x3ed997,_0x4cebbb)=>{var _0x7f4367=_0x27c0e2;_0xdc810e[_0x4cebbb][_0x7f4367(0xbe)]=_0x3ed997;}),_0x2e10b4['forEach']((_0x37a765,_0x3241e4)=>{var _0x562049=_0x27c0e2;_0xdc810e[_0x3241e4][_0x562049(0x143)]=_0x37a765;}),_0x440376[_0x27c0e2(0x9f)]((_0x1d9b60,_0x285f72)=>{_0xdc810e[_0x285f72]['level']=_0x1d9b60;}),_0x3034c2[_0x27c0e2(0x9f)]((_0x2f4ff8,_0x17ff20)=>{var _0x345fe4=_0x27c0e2;_0xdc810e[_0x17ff20][_0x345fe4(0x158)]=_0x2f4ff8;});var _0x2aaade=0x0;_0xdc810e[_0x27c0e2(0x9f)](_0x24581c=>{var _0x1baaaa=_0x27c0e2;console[_0x1baaaa(0xc3)](_0x1baaaa(0x11e),_0x24581c),(parseInt(_0x24581c[_0x1baaaa(0x187)])<parseInt(_0x24581c[_0x1baaaa(0x129)])||parseInt(_0x24581c[_0x1baaaa(0x129)])==0x0)&&_0x2aaade++;});if(_0x2aaade!=0x0)return _0x5924b3[_0x27c0e2(0x1a9)](_0x27c0e2(0x179),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x5abf90[_0x27c0e2(0x18b)]('back');_0x511176[_0x27c0e2(0xf7)]['forEach'](_0x27d7d2=>{var _0x12ec87=_0x27c0e2;const _0x20bf53=_0x515fd3['product_details'][_0x12ec87(0x175)](_0x5ab0e9=>{var _0x3cf68b=_0x12ec87;_0x5ab0e9[_0x3cf68b(0x9e)]==_0x27d7d2[_0x3cf68b(0x9e)]&&_0x5ab0e9[_0x3cf68b(0x17f)]==_0x27d7d2[_0x3cf68b(0x17f)]&&(_0x5ab0e9['product_stock']=parseInt(_0x5ab0e9[_0x3cf68b(0xc4)])+parseInt(_0x27d7d2['quantity']));});}),await _0x515fd3['save']();const _0x23db3c=_0xdc810e[_0x27c0e2(0x182)](_0x2cc6a5=>_0x2cc6a5[_0x27c0e2(0x129)]!=='0'&&_0x2cc6a5[_0x27c0e2(0x129)]!=='');_0x511176[_0x27c0e2(0x178)]=_0x236954,_0x511176[_0x27c0e2(0xe2)]=_0x1798df,_0x511176[_0x27c0e2(0x101)]=_0x2ba8b5,_0x511176[_0x27c0e2(0x118)]=_0x36dc2f,_0x511176['sale_product']=_0x23db3c,_0x511176[_0x27c0e2(0x174)]=_0xd0c431,_0x511176[_0x27c0e2(0x140)]=_0x6b9799;const _0x4f9044=await _0x511176[_0x27c0e2(0x107)](),_0x38899b=await sales_finished[_0x27c0e2(0x10a)]({'_id':_0x5924b3[_0x27c0e2(0xcf)]['id']}),_0x2724a4=await warehouse[_0x27c0e2(0x10a)]({'name':_0x36dc2f,'room':_0x6b9799,'warehouse_category':_0x27c0e2(0xea)});_0x38899b[_0x27c0e2(0xf7)][_0x27c0e2(0x9f)](_0x25b4c6=>{var _0x5efd4f=_0x27c0e2;const _0x17935a=_0x2724a4[_0x5efd4f(0xa0)]['map'](_0x385e47=>{var _0x54dcca=_0x5efd4f;_0x385e47[_0x54dcca(0x9e)]==_0x25b4c6[_0x54dcca(0x9e)]&&_0x385e47[_0x54dcca(0x17f)]==_0x25b4c6[_0x54dcca(0x17f)]&&(_0x385e47[_0x54dcca(0xc4)]=parseInt(_0x385e47[_0x54dcca(0xc4)])-parseInt(_0x25b4c6['quantity']));});}),console[_0x27c0e2(0xc3)](_0x27c0e2(0x104),_0x2724a4),await _0x2724a4[_0x27c0e2(0x107)]();const _0x1a5a30=await c_payment_data[_0x27c0e2(0x10a)]({'invoice':_0x5924b3['body'][_0x27c0e2(0x178)]});_0x1a5a30[_0x27c0e2(0xcb)]=_0x5924b3[_0x27c0e2(0x124)][_0x27c0e2(0xcb)],await _0x1a5a30[_0x27c0e2(0x107)](),_0x5924b3['flash']('success',_0x27c0e2(0x128)),_0x5abf90[_0x27c0e2(0x18b)](_0x27c0e2(0x168));}catch(_0x21e2c2){console['log'](_0x21e2c2);}}),router[a0_0x4e7a4a(0xbc)]('/give_payment/:id',auth,async(_0x1b6076,_0x1770ae)=>{var _0x5efb4c=a0_0x4e7a4a;try{const _0xd58ae3=_0x1b6076[_0x5efb4c(0xcf)]['id'],{invoice:_0x1d06be,customer:_0x1ada25,receivable_amount:_0x4c0f9a,received_amount:_0x307681}=_0x1b6076[_0x5efb4c(0x124)],_0x41e913=await sales[_0x5efb4c(0xf8)](_0xd58ae3);console['log'](_0x41e913);var _0x157156=_0x4c0f9a-_0x307681;console[_0x5efb4c(0xc3)](_0x307681),_0x41e913['received_amount']=parseFloat(_0x307681)+parseFloat(_0x41e913[_0x5efb4c(0xf5)]),_0x41e913['due_amount']=_0x157156,console[_0x5efb4c(0xc3)](_0x41e913);const _0x5d5ed4=await _0x41e913[_0x5efb4c(0x107)](),_0x445976=await c_payment_data[_0x5efb4c(0x10a)]({'invoice':_0x1d06be});_0x445976[_0x5efb4c(0x152)]=_0x157156,await _0x445976['save']();let _0x921923=new Date(),_0x45fc2f=('0'+_0x921923[_0x5efb4c(0xb3)]())[_0x5efb4c(0x117)](-0x2),_0x107ab0=('0'+(_0x921923[_0x5efb4c(0xe6)]()+0x1))[_0x5efb4c(0x117)](-0x2),_0x324e1f=_0x921923['getFullYear'](),_0x3295d5=_0x324e1f+'-'+_0x107ab0+'-'+_0x45fc2f;const _0x8c6e56=new customer_payment({'invoice':_0x1d06be,'date':_0x324e1f+'-'+_0x107ab0+'-'+_0x45fc2f,'customer':_0x1ada25,'reason':_0x5efb4c(0xab),'amount':_0x307681}),_0x1e4089=await _0x8c6e56[_0x5efb4c(0x107)]();_0x1b6076['flash'](_0x5efb4c(0x9c),_0x5efb4c(0x120)),_0x1770ae[_0x5efb4c(0x18b)](_0x5efb4c(0x172));}catch(_0x547c82){console[_0x5efb4c(0xc3)](_0x547c82);}}),router['get'](a0_0x4e7a4a(0x15f),auth,async(_0x57ff53,_0x321412)=>{var _0x20f428=a0_0x4e7a4a;try{const {username:_0x3afaf3,email:_0x429e0e,role:_0x1712cf}=_0x57ff53[_0x20f428(0xc9)],_0x5e593c=_0x57ff53[_0x20f428(0xc9)],_0x3ad35e=await profile[_0x20f428(0x10a)]({'email':_0x5e593c[_0x20f428(0x190)]}),_0x2f8769=await master_shop['find']();console[_0x20f428(0xc3)](_0x20f428(0xe8),_0x2f8769);const _0x53b4c1=_0x57ff53[_0x20f428(0xcf)]['id'],_0x24e7cb=await sales[_0x20f428(0xf8)](_0x53b4c1);console[_0x20f428(0xc3)](_0x24e7cb);const _0x57c857=await customer[_0x20f428(0x10a)]({'name':_0x24e7cb['customer']});console[_0x20f428(0xc3)](_0x57c857);if(_0x2f8769[0x0][_0x20f428(0x192)]==_0x20f428(0x161)){var _0x252edb=users[_0x20f428(0xce)];console[_0x20f428(0xc3)](_0x252edb);}else{if(_0x2f8769[0x0][_0x20f428(0x192)]=='Hindi')var _0x252edb=users[_0x20f428(0xc8)];else{if(_0x2f8769[0x0][_0x20f428(0x192)]==_0x20f428(0x1b1))var _0x252edb=users[_0x20f428(0x1b1)];else{if(_0x2f8769[0x0]['language']==_0x20f428(0x19a))var _0x252edb=users[_0x20f428(0x19a)];else{if(_0x2f8769[0x0]['language']==_0x20f428(0x157))var _0x252edb=users[_0x20f428(0x157)];else{if(_0x2f8769[0x0]['language']==_0x20f428(0x130))var _0x252edb=users[_0x20f428(0x10c)];else{if(_0x2f8769[0x0][_0x20f428(0x192)]==_0x20f428(0x12c))var _0x252edb=users['Chinese'];else{if(_0x2f8769[0x0]['language']==_0x20f428(0x170))var _0x252edb=users[_0x20f428(0x16b)];}}}}}}}_0x321412[_0x20f428(0x173)](_0x20f428(0x18f),{'success':_0x57ff53['flash']('success'),'errors':_0x57ff53['flash'](_0x20f428(0x179)),'role':_0x5e593c,'profile':_0x3ad35e,'master_shop':_0x2f8769,'customers':_0x57c857,'sales':_0x24e7cb,'language':_0x252edb});}catch(_0x276297){console[_0x20f428(0xc3)](_0x276297);}}),router[a0_0x4e7a4a(0xb1)](a0_0x4e7a4a(0x1ba),auth,async(_0x53d123,_0x26b26b)=>{var _0x14d6a6=a0_0x4e7a4a;try{const {username:_0xdf49db,email:_0x391758,role:_0x224778}=_0x53d123['user'],_0x4a8dd3=_0x53d123[_0x14d6a6(0xc9)],_0x5f4542=await profile['findOne']({'email':_0x4a8dd3[_0x14d6a6(0x190)]}),_0x41fe09=await master_shop[_0x14d6a6(0x103)](),_0x475778=_0x53d123['params']['id'],_0xebfa4a=await sales_finished[_0x14d6a6(0xf8)](_0x475778),_0x58a511=await warehouse['aggregate']([{'$match':{'name':_0xebfa4a[_0x14d6a6(0x118)]}},{'$unwind':_0x14d6a6(0x127)},{'$group':{'_id':_0x14d6a6(0xa1),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x14d6a6(0xf4)},'bay':{'$first':_0x14d6a6(0x1b2)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x14d6a6(0x14b)},'floorlevel':{'$first':_0x14d6a6(0x154)},'primary_code':{'$first':_0x14d6a6(0xc6)},'secondary_code':{'$first':_0x14d6a6(0xa2)},'product_code':{'$first':_0x14d6a6(0xb8)},'storage':{'$first':_0x14d6a6(0x11a)},'rack':{'$first':_0x14d6a6(0x125)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x14d6a6(0x1b8)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x14d6a6(0xa6)},'maxProducts':{'$first':_0x14d6a6(0x19c)},'batch_code':{'$first':_0x14d6a6(0x18c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0xbf64f8=await product[_0x14d6a6(0x103)]({}),_0x5384fb=await warehouse[_0x14d6a6(0xfa)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods','name':{'$ne':_0x14d6a6(0x1a7),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':_0x14d6a6(0xdd),'name':{'$first':_0x14d6a6(0xdd)}}},{'$sort':{'name':0x1}}]);var _0x4059b1=[_0x14d6a6(0xa3)];const _0x13d586=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x14d6a6(0x1b4)}},{'$group':{'_id':_0x14d6a6(0xdd),'name':{'$first':_0x14d6a6(0xdd)}}},{'$sort':{'name':0x1}}]);if(_0x41fe09[0x0][_0x14d6a6(0x192)]=='English\x20(US)'){var _0x57403e=users['English'];console[_0x14d6a6(0xc3)](_0x57403e);}else{if(_0x41fe09[0x0][_0x14d6a6(0x192)]==_0x14d6a6(0xc8))var _0x57403e=users[_0x14d6a6(0xc8)];else{if(_0x41fe09[0x0]['language']==_0x14d6a6(0x1b1))var _0x57403e=users[_0x14d6a6(0x1b1)];else{if(_0x41fe09[0x0]['language']==_0x14d6a6(0x19a))var _0x57403e=users[_0x14d6a6(0x19a)];else{if(_0x41fe09[0x0][_0x14d6a6(0x192)]==_0x14d6a6(0x157))var _0x57403e=users[_0x14d6a6(0x157)];else{if(_0x41fe09[0x0][_0x14d6a6(0x192)]=='Portuguese\x20(BR)')var _0x57403e=users[_0x14d6a6(0x10c)];else{if(_0x41fe09[0x0][_0x14d6a6(0x192)]==_0x14d6a6(0x12c))var _0x57403e=users[_0x14d6a6(0x12c)];else{if(_0x41fe09[0x0]['language']==_0x14d6a6(0x170))var _0x57403e=users['Arabic'];}}}}}}}_0x26b26b[_0x14d6a6(0x173)](_0x14d6a6(0x159),{'success':_0x53d123['flash'](_0x14d6a6(0x9c)),'errors':_0x53d123[_0x14d6a6(0x1a9)](_0x14d6a6(0x179)),'role':_0x4a8dd3,'profile':_0x5f4542,'user':_0xebfa4a,'stock':_0x58a511,'master_shop':_0x41fe09,'unit':_0xbf64f8,'language':_0x57403e,'warehouses':_0x5384fb,'rooms':_0x4059b1,'warehouse_QA':_0x13d586});}catch(_0x479722){console['log'](_0x479722),_0x26b26b['status'](0xc8)[_0x14d6a6(0xeb)]({'message':_0x479722[_0x14d6a6(0x1ad)]});}}),router[a0_0x4e7a4a(0xbc)](a0_0x4e7a4a(0x1ba),auth,async(_0x524d35,_0x5dfa6a)=>{var _0x336354=a0_0x4e7a4a;if(_0x524d35[_0x336354(0x124)][_0x336354(0x146)]=='QA')try{const {invoice:_0x27b69d,date:_0x32f556,warehouse_name:_0x2a1b73,product_name:_0x44e5a7,primary_code:_0x2f1e51,secondary_code:_0x70b5bf,product_code:_0x5ac1e0,sales_quantity:_0x597feb,stocks:_0x371f99,return_qty:_0x1b5dbe,Room_name:_0x31d988,to_warehouse_name_QA:_0x2c26aa,to_Room_name_QA:_0x4efdaa,note:_0x1df88b,for_categorize:_0x353b32,product_name_QA1:_0x3cd5c4}=_0x524d35['body'];if(typeof _0x3cd5c4==_0x336354(0x105))var _0x416ce5=[_0x524d35['body'][_0x336354(0x1a3)]],_0xd0471b=[_0x524d35[_0x336354(0x124)][_0x336354(0xca)]],_0x173d5c=[_0x524d35['body'][_0x336354(0x137)]],_0x166ede=[_0x524d35[_0x336354(0x124)]['product_code_QA']],_0x49252c=[_0x524d35[_0x336354(0x124)][_0x336354(0x19f)]],_0x147ffc=[_0x524d35['body'][_0x336354(0xec)]],_0x59f827=[_0x524d35[_0x336354(0x124)][_0x336354(0xee)]],_0x17c996=[_0x524d35[_0x336354(0x124)][_0x336354(0xd6)]],_0x5799ea=[_0x524d35['body'][_0x336354(0x11c)]],_0x5c6325=[_0x524d35[_0x336354(0x124)][_0x336354(0x119)]],_0xf14084=[_0x524d35[_0x336354(0x124)][_0x336354(0xd3)]],_0x23a5b6=[_0x524d35[_0x336354(0x124)]['unit_QA']],_0x4a9fd7=[_0x524d35['body'][_0x336354(0x17c)]],_0x3ab79f=[_0x524d35[_0x336354(0x124)]['expiry_date_QA']];else var _0x416ce5=[..._0x524d35['body'][_0x336354(0x1a3)]],_0xd0471b=[..._0x524d35[_0x336354(0x124)][_0x336354(0xca)]],_0x173d5c=[..._0x524d35[_0x336354(0x124)][_0x336354(0x137)]],_0x166ede=[..._0x524d35[_0x336354(0x124)]['product_code_QA']],_0x49252c=[..._0x524d35[_0x336354(0x124)][_0x336354(0x19f)]],_0x147ffc=[..._0x524d35[_0x336354(0x124)]['stocks_QA']],_0x59f827=[..._0x524d35['body'][_0x336354(0xee)]],_0x17c996=[..._0x524d35[_0x336354(0x124)][_0x336354(0xd6)]],_0x5799ea=[..._0x524d35[_0x336354(0x124)][_0x336354(0x11c)]],_0x5c6325=[..._0x524d35['body']['batch_code_QA']],_0xf14084=[..._0x524d35['body'][_0x336354(0xd3)]],_0x23a5b6=[..._0x524d35[_0x336354(0x124)][_0x336354(0x15e)]],_0x4a9fd7=[..._0x524d35['body'][_0x336354(0x17c)]],_0x3ab79f=[..._0x524d35[_0x336354(0x124)][_0x336354(0x1ae)]];const _0x49b6dd=_0x416ce5[_0x336354(0x175)](_0x3a89fb=>{return _0x3a89fb={'product_name':_0x3a89fb};});_0xd0471b[_0x336354(0x9f)]((_0x1e18e8,_0x1b52fe)=>{var _0x99b358=_0x336354;_0x49b6dd[_0x1b52fe][_0x99b358(0xac)]=_0x1e18e8;}),_0x173d5c[_0x336354(0x9f)]((_0x269399,_0x11ca15)=>{var _0x1eb199=_0x336354;_0x49b6dd[_0x11ca15][_0x1eb199(0xbe)]=_0x269399;}),_0x166ede['forEach']((_0x9f7df7,_0x554f3d)=>{var _0x4cc8bf=_0x336354;_0x49b6dd[_0x554f3d][_0x4cc8bf(0x143)]=_0x9f7df7;}),_0x49252c['forEach']((_0x3ff2ab,_0x25582e)=>{var _0x5debc3=_0x336354;_0x49b6dd[_0x25582e][_0x5debc3(0xc1)]=_0x3ff2ab;}),_0x147ffc[_0x336354(0x9f)]((_0x2cd753,_0x106d57)=>{_0x49b6dd[_0x106d57]['stock']=_0x2cd753;}),_0x59f827[_0x336354(0x9f)]((_0x4566b8,_0x20f4ad)=>{var _0x1e0010=_0x336354;_0x49b6dd[_0x20f4ad][_0x1e0010(0xb0)]=_0x4566b8;}),_0x17c996['forEach']((_0xf0eb47,_0x2e605e)=>{var _0x12ef61=_0x336354;_0x49b6dd[_0x2e605e][_0x12ef61(0x1a4)]=_0xf0eb47;}),_0x5799ea['forEach']((_0x599b17,_0x50a9f9)=>{var _0x3a1b26=_0x336354;_0x49b6dd[_0x50a9f9][_0x3a1b26(0x199)]=_0x599b17;}),_0x5c6325['forEach']((_0x2af045,_0x2e2145)=>{var _0x543387=_0x336354;_0x49b6dd[_0x2e2145][_0x543387(0x133)]=_0x2af045;}),_0xf14084[_0x336354(0x9f)]((_0x5edc5f,_0x277ecb)=>{var _0x2463fe=_0x336354;_0x49b6dd[_0x277ecb][_0x2463fe(0x162)]=_0x5edc5f;}),_0x23a5b6[_0x336354(0x9f)]((_0x225f49,_0x27040e)=>{var _0x412299=_0x336354;_0x49b6dd[_0x27040e][_0x412299(0x110)]=_0x225f49;}),_0x4a9fd7[_0x336354(0x9f)]((_0xa6976c,_0x398f7d)=>{var _0x42f9f1=_0x336354;_0x49b6dd[_0x398f7d][_0x42f9f1(0x13b)]=_0xa6976c;}),_0x3ab79f[_0x336354(0x9f)]((_0x372633,_0x4b41b4)=>{var _0x10ef3d=_0x336354;_0x49b6dd[_0x4b41b4][_0x10ef3d(0x158)]=_0x372633;});const _0x66a253=await sales_finished[_0x336354(0x10a)]({'invoice':_0x27b69d});_0x66a253[_0x336354(0x1b9)]='True';const _0x21a7a5=await _0x66a253[_0x336354(0x107)](),_0x3fc32e=new sales_return_finished({'invoice':_0x27b69d,'customer':_0x524d35[_0x336354(0x124)][_0x336354(0xe2)],'date':_0x32f556,'warehouse_name':_0x2a1b73,'room':_0x31d988,'ToWarehouse':_0x2c26aa,'ToRoom':_0x4efdaa,'return_sale_QA':_0x49b6dd,'note':_0x1df88b,'warehouse_cat':_0x353b32}),_0x138f7f=await _0x3fc32e[_0x336354(0x107)](),_0x2d642e=await sales_return_finished['findOne']({'invoice':_0x27b69d}),_0x594eaa=await warehouse[_0x336354(0x10a)]({'name':_0x2c26aa,'room':_0x4efdaa});_0x2d642e[_0x336354(0x15c)][_0x336354(0x9f)](_0x4d6b06=>{var _0x2d822a=_0x336354,_0x4a84a9=0x0;const _0x2eaf21=_0x594eaa[_0x2d822a(0xa0)][_0x2d822a(0x175)](_0x139836=>{var _0x170b77=_0x2d822a;_0x139836[_0x170b77(0x9e)]==_0x4d6b06['product_name']&&_0x139836[_0x170b77(0x158)]==_0x4d6b06['expiry_date']&&_0x139836['production_date']==_0x4d6b06[_0x170b77(0x13b)]&&_0x139836[_0x170b77(0x133)]==_0x4d6b06[_0x170b77(0x133)]&&(_0x139836[_0x170b77(0xc4)]=parseInt(_0x139836['product_stock'])+parseInt(_0x4d6b06[_0x170b77(0xb0)]),_0x4a84a9++);});_0x4a84a9=='0'&&(_0x594eaa['product_details']=_0x594eaa['product_details'][_0x2d822a(0x1ac)]({'product_name':_0x4d6b06['product_name'],'product_stock':_0x4d6b06[_0x2d822a(0xb0)],'primary_code':_0x4d6b06[_0x2d822a(0xac)],'secondary_code':_0x4d6b06[_0x2d822a(0xbe)],'product_code':_0x4d6b06[_0x2d822a(0x143)],'batch_code':_0x4d6b06[_0x2d822a(0x133)],'maxPerUnit':_0x4d6b06[_0x2d822a(0x1a4)],'production_date':_0x4d6b06[_0x2d822a(0x13b)],'expiry_date':_0x4d6b06[_0x2d822a(0x158)],'secondary_unit':_0x4d6b06[_0x2d822a(0x162)],'unit':_0x4d6b06[_0x2d822a(0x110)],'maxProducts':_0x4d6b06[_0x2d822a(0x199)],'bay':_0x4d6b06[_0x2d822a(0x17f)]}));}),await _0x594eaa['save']();const _0x3a6471=new c_payment_data({'invoice':_0x27b69d,'customer':_0x524d35['body']['customer'],'reason':'Sale\x20Return'});await _0x3a6471['save']();const _0x4def09=await master_shop[_0x336354(0x103)](),_0x1f9943=await email_settings[_0x336354(0x10a)](),_0x93fc1=await customer['findOne']({'name':_0x524d35[_0x336354(0x124)][_0x336354(0xe2)]});_0x4def09[0x0][_0x336354(0xda)]==0x1?(right_currency=_0x4def09[0x0][_0x336354(0x132)],left_currency=''):(right_currency='',left_currency=_0x4def09[0x0]['currency']);var _0x49790f=_0x416ce5,_0x4d0ebf=_0x59f827,_0xcad578='',_0x379773;for(_0x379773 in _0x49790f){_0xcad578+=_0x336354(0x12e)+_0x336354(0x131)+_0x49790f[_0x379773]+_0x336354(0xd9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4d0ebf[_0x379773]+'</td>'+_0x336354(0x1b7);}console[_0x336354(0xc3)](_0x336354(0x17e),_0xcad578);let _0x156b34=nodemailer[_0x336354(0x164)]({'service':_0x336354(0xed),'auth':{'user':_0x1f9943[_0x336354(0x190)],'pass':_0x1f9943[_0x336354(0x1af)]}}),_0x2ddade={'from':_0x1f9943[_0x336354(0x190)],'to':_0x93fc1['email'],'subject':_0x336354(0x13e),'attachments':[{'filename':'Logo.png','path':__dirname+_0x336354(0x18e)+_0x336354(0x16f)+_0x4def09[0x0][_0x336354(0x18a)],'cid':_0x336354(0x12a)}],'html':_0x336354(0x1b6)+_0x336354(0x149)+_0x336354(0x1a2)+'<div>'+_0x336354(0x113)+_0x336354(0xc0)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x336354(0x147)+_0x336354(0xc0)+_0x336354(0xe5)+_0x4def09[0x0][_0x336354(0x123)]+_0x336354(0x112)+_0x336354(0x147)+_0x336354(0x147)+_0x336354(0x16c)+_0x336354(0xc0)+_0x336354(0x176)+'\x20Order\x20Number\x20:\x20'+_0x27b69d+'\x20'+_0x336354(0x1a6)+'\x20Order\x20Date\x20:\x20'+_0x32f556+'\x20'+'</span>'+'</h5>'+_0x336354(0x147)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x336354(0x142)+_0x336354(0xcc)+_0x336354(0x163)+_0x336354(0x114)+_0x336354(0x1b7)+_0x336354(0x197)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0xcad578+'\x20'+_0x336354(0x150)+_0x336354(0x1a1)+_0x336354(0xc0)+_0x336354(0x100)+_0x336354(0xde)+_0x4def09[0x0][_0x336354(0x123)]+'</h5>'+_0x336354(0x147)+'</div>'+_0x336354(0xfc)};_0x156b34[_0x336354(0x183)](_0x2ddade,function(_0x3401b6,_0x14854b){var _0x401851=_0x336354;_0x3401b6?(console[_0x401851(0xc3)](_0x3401b6),console[_0x401851(0xc3)]('Error\x20Occurs')):console[_0x401851(0xc3)](_0x401851(0x169));}),_0x524d35[_0x336354(0x1a9)](_0x336354(0x9c),_0x336354(0xd4)),_0x5dfa6a[_0x336354(0x18b)](_0x336354(0x168));}catch(_0x48ae5b){_0x5dfa6a[_0x336354(0x15d)](0xc8)['json']({'message1':_0x48ae5b[_0x336354(0x1ad)]});}else{if(_0x524d35['body'][_0x336354(0x146)]=='GS')try{const {invoice:_0x2ea723,date:_0x4cb636,warehouse_name:_0x54406e,product_name:_0x46b7a5,primary_code:_0x2ed172,secondary_code:_0x47a1a0,product_code:_0x3af576,sales_quantity:_0x4c0be5,stocks:_0x433335,return_qty:_0x348a0f,Room_name:_0x574439,to_warehouse_name:_0x28c641,to_Room_name:_0x5a27f4,note:_0x36fe53,level:_0xb3b1,isle:_0x4a712d,pallet:_0xc96499,for_categorize:_0x4003c5}=_0x524d35['body'];if(typeof _0x46b7a5=='string')var _0x416ce5=[_0x524d35[_0x336354(0x124)][_0x336354(0x9e)]],_0xd0471b=[_0x524d35[_0x336354(0x124)][_0x336354(0xac)]],_0x173d5c=[_0x524d35[_0x336354(0x124)][_0x336354(0xbe)]],_0x166ede=[_0x524d35[_0x336354(0x124)][_0x336354(0x143)]],_0x49252c=[_0x524d35[_0x336354(0x124)][_0x336354(0xd7)]],_0x59f827=[_0x524d35[_0x336354(0x124)][_0x336354(0xb0)]],_0xe9e79a=[_0x524d35[_0x336354(0x124)]['bay']],_0x17c996=[_0x524d35[_0x336354(0x124)][_0x336354(0x1a4)]],_0x5799ea=[_0x524d35[_0x336354(0x124)][_0x336354(0x199)]],_0x5c6325=[_0x524d35[_0x336354(0x124)][_0x336354(0x133)]],_0xf14084=[_0x524d35[_0x336354(0x124)]['secondary_unit']],_0x23a5b6=[_0x524d35[_0x336354(0x124)][_0x336354(0x110)]],_0x4a9fd7=[_0x524d35['body'][_0x336354(0x13b)]],_0x3ab79f=[_0x524d35['body']['expiry_date']];else var _0x416ce5=[..._0x524d35[_0x336354(0x124)]['product_name']],_0xd0471b=[..._0x524d35['body'][_0x336354(0xac)]],_0x173d5c=[..._0x524d35[_0x336354(0x124)][_0x336354(0xbe)]],_0x166ede=[..._0x524d35[_0x336354(0x124)][_0x336354(0x143)]],_0x49252c=[..._0x524d35[_0x336354(0x124)][_0x336354(0xd7)]],_0x59f827=[..._0x524d35['body'][_0x336354(0xb0)]],_0xe9e79a=[..._0x524d35[_0x336354(0x124)][_0x336354(0x17f)]],_0x17c996=[..._0x524d35[_0x336354(0x124)]['maxPerUnit']],_0x5799ea=[..._0x524d35[_0x336354(0x124)][_0x336354(0x199)]],_0x5c6325=[..._0x524d35['body'][_0x336354(0x133)]],_0xf14084=[..._0x524d35['body']['secondary_unit']],_0x23a5b6=[..._0x524d35[_0x336354(0x124)][_0x336354(0x110)]],_0x4a9fd7=[..._0x524d35[_0x336354(0x124)][_0x336354(0x13b)]],_0x3ab79f=[..._0x524d35[_0x336354(0x124)][_0x336354(0x158)]];const _0x2450c2=_0x416ce5['map'](_0x30abb2=>{return _0x30abb2={'product_name':_0x30abb2};});_0xd0471b[_0x336354(0x9f)]((_0x54571e,_0x5dab4b)=>{_0x2450c2[_0x5dab4b]['primary_code']=_0x54571e;}),_0x173d5c[_0x336354(0x9f)]((_0x40509d,_0x5c52c0)=>{_0x2450c2[_0x5c52c0]['secondary_code']=_0x40509d;}),_0x166ede['forEach']((_0x261921,_0x3abc36)=>{var _0x2a8147=_0x336354;_0x2450c2[_0x3abc36][_0x2a8147(0x143)]=_0x261921;}),_0x49252c[_0x336354(0x9f)]((_0x2640c2,_0x563586)=>{var _0x2bdfa3=_0x336354;_0x2450c2[_0x563586][_0x2bdfa3(0xc1)]=_0x2640c2;}),_0x59f827['forEach']((_0xa3fd8e,_0x54c51a)=>{var _0x1f57aa=_0x336354;_0x2450c2[_0x54c51a][_0x1f57aa(0xb0)]=_0xa3fd8e;}),_0xe9e79a[_0x336354(0x9f)]((_0x21354d,_0x5cbb98)=>{_0x2450c2[_0x5cbb98]['bay']=_0x21354d;}),_0x17c996['forEach']((_0x24134b,_0x43a596)=>{_0x2450c2[_0x43a596]['maxPerUnit']=_0x24134b;}),_0x5799ea[_0x336354(0x9f)]((_0x5a0b4d,_0x2cdc06)=>{_0x2450c2[_0x2cdc06]['maxProducts']=_0x5a0b4d;}),_0x5c6325[_0x336354(0x9f)]((_0x5508b3,_0x41c2d6)=>{var _0x68fcaa=_0x336354;_0x2450c2[_0x41c2d6][_0x68fcaa(0x133)]=_0x5508b3;}),_0xf14084[_0x336354(0x9f)]((_0x5bff6d,_0x26f736)=>{var _0x272fc7=_0x336354;_0x2450c2[_0x26f736][_0x272fc7(0x162)]=_0x5bff6d;}),_0x23a5b6[_0x336354(0x9f)]((_0x48003f,_0x120d05)=>{_0x2450c2[_0x120d05]['unit']=_0x48003f;}),_0x4a9fd7[_0x336354(0x9f)]((_0xaceb59,_0x4ebea6)=>{_0x2450c2[_0x4ebea6]['production_date']=_0xaceb59;}),_0x3ab79f[_0x336354(0x9f)]((_0x5f5041,_0x198500)=>{_0x2450c2[_0x198500]['expiry_date']=_0x5f5041;});var _0x5ba713=0x0;_0x2450c2[_0x336354(0x9f)](_0x2db06c=>{var _0x5b5281=_0x336354;(parseInt(_0x2db06c[_0x5b5281(0xc1)])<parseInt(_0x2db06c[_0x5b5281(0xb0)])||parseInt(_0x2db06c[_0x5b5281(0x187)])<parseInt(_0x2db06c['return_qty'])&&parseInt(_0x2db06c[_0x5b5281(0xc1)])>parseInt(_0x2db06c[_0x5b5281(0xb0)])||parseInt(_0x2db06c['return_qty'])==0x0)&&_0x5ba713++;});if(_0x5ba713!=0x0)return _0x524d35[_0x336354(0x1a9)](_0x336354(0x179),_0x336354(0x136)),_0x5dfa6a['redirect'](_0x336354(0x17a));const _0x558c20=await sales_finished[_0x336354(0x10a)]({'invoice':_0x2ea723});_0x558c20[_0x336354(0x1b9)]=_0x336354(0xbb);const _0x438b8a=await _0x558c20[_0x336354(0x107)](),_0x17c78e=new sales_return_finished({'invoice':_0x2ea723,'customer':_0x524d35[_0x336354(0x124)][_0x336354(0xe2)],'date':_0x4cb636,'warehouse_name':_0x54406e,'room':_0x574439,'ToWarehouse':_0x28c641,'ToRoom':_0x5a27f4,'return_sale':_0x2450c2,'note':_0x36fe53,'warehouse_cat':_0x4003c5}),_0x2eda43=await _0x17c78e[_0x336354(0x107)](),_0x20561d=await sales_return_finished[_0x336354(0x10a)]({'invoice':_0x2ea723}),_0x240be0=await warehouse[_0x336354(0x10a)]({'name':_0x28c641,'room':_0x5a27f4,'warehouse_category':_0x336354(0xea)});_0x20561d[_0x336354(0x14f)]['forEach'](_0x59eca1=>{var _0x1ee835=_0x336354,_0x4d4992=0x0;const _0x59c340=_0x240be0[_0x1ee835(0xa0)]['map'](_0x33a04d=>{var _0x52eb91=_0x1ee835;_0x33a04d[_0x52eb91(0x9e)]==_0x59eca1[_0x52eb91(0x9e)]&&_0x33a04d[_0x52eb91(0x17f)]==_0x59eca1[_0x52eb91(0x17f)]&&_0x33a04d[_0x52eb91(0x158)]==_0x59eca1[_0x52eb91(0x158)]&&_0x33a04d[_0x52eb91(0x13b)]==_0x59eca1[_0x52eb91(0x13b)]&&_0x33a04d[_0x52eb91(0x133)]==_0x59eca1[_0x52eb91(0x133)]&&(_0x33a04d[_0x52eb91(0xc4)]=parseInt(_0x33a04d[_0x52eb91(0xc4)])+parseInt(_0x59eca1[_0x52eb91(0xb0)]),_0x4d4992++);});_0x4d4992=='0'&&(_0x240be0[_0x1ee835(0xa0)]=_0x240be0[_0x1ee835(0xa0)][_0x1ee835(0x1ac)]({'product_name':_0x59eca1[_0x1ee835(0x9e)],'product_stock':_0x59eca1[_0x1ee835(0xb0)],'primary_code':_0x59eca1[_0x1ee835(0xac)],'secondary_code':_0x59eca1[_0x1ee835(0xbe)],'product_code':_0x59eca1['product_code'],'bay':_0x59eca1[_0x1ee835(0x17f)],'batch_code':_0x59eca1[_0x1ee835(0x133)],'maxPerUnit':_0x59eca1[_0x1ee835(0x1a4)],'production_date':_0x59eca1['production_date'],'expiry_date':_0x59eca1[_0x1ee835(0x158)],'secondary_unit':_0x59eca1[_0x1ee835(0x162)],'unit':_0x59eca1[_0x1ee835(0x110)],'maxProducts':_0x59eca1['maxProducts']}));}),await _0x240be0[_0x336354(0x107)](),console[_0x336354(0xc3)](_0x524d35[_0x336354(0x124)]);const _0x1c00a7=new c_payment_data({'invoice':_0x2ea723,'customer':_0x524d35[_0x336354(0x124)][_0x336354(0xe2)],'reason':_0x336354(0x13f)});await _0x1c00a7[_0x336354(0x107)]();const _0x497638=await master_shop[_0x336354(0x103)]();console[_0x336354(0xc3)](_0x336354(0x106),_0x497638[0x0][_0x336354(0x18a)]);const _0x2f46ad=await email_settings[_0x336354(0x10a)](),_0x5a8219=await customer[_0x336354(0x10a)]({'name':_0x524d35[_0x336354(0x124)][_0x336354(0xe2)]});console[_0x336354(0xc3)]('customer_data',_0x5a8219);_0x497638[0x0]['currency_placement']==0x1?(right_currency=_0x497638[0x0][_0x336354(0x132)],left_currency=''):(right_currency='',left_currency=_0x497638[0x0]['currency']);var _0x49790f=_0x416ce5,_0x4d0ebf=_0x59f827,_0xcad578='',_0x379773;for(_0x379773 in _0x49790f){_0xcad578+='<tr>'+_0x336354(0x131)+_0x49790f[_0x379773]+_0x336354(0xd9)+_0x336354(0x131)+_0x4d0ebf[_0x379773]+_0x336354(0xd9)+_0x336354(0x1b7);}console[_0x336354(0xc3)](_0x336354(0x17e),_0xcad578);let _0x2bc193=nodemailer[_0x336354(0x164)]({'service':_0x336354(0xed),'auth':{'user':_0x2f46ad['email'],'pass':_0x2f46ad[_0x336354(0x1af)]}}),_0x46b6c0={'from':_0x2f46ad['email'],'to':_0x5a8219[_0x336354(0x190)],'subject':_0x336354(0x13e),'attachments':[{'filename':_0x336354(0x195),'path':__dirname+'/../public'+_0x336354(0x16f)+_0x497638[0x0]['image'],'cid':_0x336354(0x12a)}],'html':_0x336354(0x1b6)+_0x336354(0x149)+_0x336354(0x1a2)+_0x336354(0xc0)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x336354(0xc0)+_0x336354(0x141)+_0x336354(0x147)+_0x336354(0xc0)+_0x336354(0xe5)+_0x497638[0x0][_0x336354(0x123)]+_0x336354(0x112)+_0x336354(0x147)+_0x336354(0x147)+_0x336354(0x16c)+_0x336354(0xc0)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x336354(0x144)+_0x2ea723+'\x20'+_0x336354(0x1a6)+_0x336354(0x198)+_0x4cb636+'\x20'+_0x336354(0x167)+_0x336354(0x145)+_0x336354(0x147)+_0x336354(0x1b0)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x336354(0x142)+_0x336354(0xcc)+_0x336354(0x163)+_0x336354(0x114)+_0x336354(0x1b7)+_0x336354(0x197)+_0x336354(0x14c)+'\x20'+_0xcad578+'\x20'+'</tbody>'+_0x336354(0x1a1)+'<div>'+_0x336354(0x100)+_0x336354(0xde)+_0x497638[0x0][_0x336354(0x123)]+_0x336354(0x145)+_0x336354(0x147)+'</div>'+_0x336354(0xfc)};_0x2bc193[_0x336354(0x183)](_0x46b6c0,function(_0x3a9e05,_0x27752d){var _0x1886cc=_0x336354;_0x3a9e05?(console[_0x1886cc(0xc3)](_0x3a9e05),console[_0x1886cc(0xc3)](_0x1886cc(0x156))):console[_0x1886cc(0xc3)](_0x1886cc(0x169));}),_0x524d35[_0x336354(0x1a9)](_0x336354(0x9c),_0x336354(0xd4)),_0x5dfa6a[_0x336354(0x18b)](_0x336354(0x168));}catch(_0x4a2002){console['log'](_0x4a2002),_0x5dfa6a[_0x336354(0x15d)](0xc8)['json']({'message1':_0x4a2002[_0x336354(0x1ad)]});}}}),router[a0_0x4e7a4a(0xb1)](a0_0x4e7a4a(0x165),auth,async(_0x596e11,_0x5a69b3)=>{var _0x501538=a0_0x4e7a4a;try{const {username:_0x1ec627,email:_0xf3fec0,role:_0x50cb12}=_0x596e11[_0x501538(0xc9)],_0x1ff89b=_0x596e11['user'],_0x292fd2=await profile[_0x501538(0x10a)]({'email':_0x1ff89b[_0x501538(0x190)]}),_0x40a76f=await master_shop[_0x501538(0x103)]();console[_0x501538(0xc3)](_0x501538(0xc7),_0x40a76f);const _0x30cc65=_0x596e11[_0x501538(0xcf)]['id'],_0x5cf340=await sales[_0x501538(0xf8)](_0x30cc65);console['log'](_0x501538(0x19e),_0x5cf340);if(_0x40a76f[0x0][_0x501538(0x192)]==_0x501538(0x161))var _0x448512=users[_0x501538(0xce)];else{if(_0x40a76f[0x0][_0x501538(0x192)]==_0x501538(0xc8))var _0x448512=users[_0x501538(0xc8)];else{if(_0x40a76f[0x0][_0x501538(0x192)]==_0x501538(0x1b1))var _0x448512=users[_0x501538(0x1b1)];else{if(_0x40a76f[0x0]['language']==_0x501538(0x19a))var _0x448512=users['Spanish'];else{if(_0x40a76f[0x0][_0x501538(0x192)]==_0x501538(0x157))var _0x448512=users[_0x501538(0x157)];else{if(_0x40a76f[0x0][_0x501538(0x192)]==_0x501538(0x130))var _0x448512=users[_0x501538(0x10c)];else{if(_0x40a76f[0x0][_0x501538(0x192)]==_0x501538(0x12c))var _0x448512=users[_0x501538(0x12c)];else{if(_0x40a76f[0x0][_0x501538(0x192)]=='Arabic\x20(ae)')var _0x448512=users['Arabic'];}}}}}}}_0x5a69b3[_0x501538(0x173)](_0x501538(0x193),{'success':_0x596e11[_0x501538(0x1a9)](_0x501538(0x9c)),'errors':_0x596e11['flash'](_0x501538(0x179)),'role':_0x1ff89b,'profile':_0x292fd2,'alldata':_0x5cf340,'master_shop':_0x40a76f,'language':_0x448512});}catch(_0x42b66b){console[_0x501538(0xc3)](_0x42b66b);}}),router[a0_0x4e7a4a(0xbc)](a0_0x4e7a4a(0xa4),async(_0x471339,_0x214632)=>{var _0x23aa22=a0_0x4e7a4a;const {product_code:_0x3d21aa,warehouse_name:_0x26b8ac,rooms_data:_0x61237f,Roomslist:_0x16b9b8,sales_category:_0xe6ad9e}=_0x471339[_0x23aa22(0x124)],_0x53d3f8=_0x16b9b8[_0x23aa22(0x10f)](','),_0x48ee2a=[];async function _0x24f5b9(_0x32de49){var _0x3add20=_0x23aa22;const _0x317e9b=await warehouse['aggregate']([{'$match':{'name':_0x26b8ac,'room':_0x32de49}},{'$unwind':_0x3add20(0x127)},{'$match':{'product_details.primary_code':_0x3d21aa}},{'$group':{'_id':_0x3add20(0xa1),'name':{'$first':_0x3add20(0x10e)},'product_stock':{'$first':_0x3add20(0xf4)},'primary_code':{'$first':_0x3add20(0xc6)},'secondary_code':{'$first':_0x3add20(0xa2)},'product_code':{'$first':_0x3add20(0xb8)},'level':{'$first':_0x3add20(0xf0)},'bay':{'$first':_0x3add20(0x1b2)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x3add20(0xe0)},'secondary_unit':{'$first':_0x3add20(0xa6)},'storage':{'$first':_0x3add20(0x11a)},'rack':{'$first':_0x3add20(0x125)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3add20(0x1b8)},'maxPerUnit':{'$first':_0x3add20(0x12f)},'batch_code':{'$first':_0x3add20(0x18c)},'product_cat':{'$first':_0x3add20(0xdb)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x3add20(0x15a)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x3add20(0xe1)}}}]),_0x3d381d=await warehouse[_0x3add20(0xfa)]([{'$match':{'name':_0x26b8ac,'room':_0x32de49}},{'$unwind':_0x3add20(0x127)},{'$match':{'product_details.secondary_code':_0x3d21aa}},{'$group':{'_id':_0x3add20(0xa1),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3add20(0xf4)},'primary_code':{'$first':_0x3add20(0xc6)},'secondary_code':{'$first':_0x3add20(0xa2)},'product_code':{'$first':_0x3add20(0xb8)},'level':{'$first':_0x3add20(0x1b2)},'isle':{'$first':_0x3add20(0xc2)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x3add20(0xe0)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3add20(0x11a)},'rack':{'$first':_0x3add20(0x125)},'expiry_date':{'$first':_0x3add20(0xfb)},'production_date':{'$first':_0x3add20(0x1b8)},'maxPerUnit':{'$first':_0x3add20(0x12f)},'batch_code':{'$first':_0x3add20(0x18c)},'product_cat':{'$first':_0x3add20(0xdb)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3add20(0xbf)},'invoice':{'$first':_0x3add20(0x15a)},'uuid':{'$first':_0x3add20(0xaf)},'gross_price':{'$first':_0x3add20(0xad)},'sales_category':{'$first':'$product_details.sales_category'}}}]);if(_0x317e9b[_0x3add20(0x153)]>0x0)_0x48ee2a[_0x3add20(0xfe)](_0x317e9b);else _0x3d381d[_0x3add20(0x153)]>0x0&&_0x48ee2a[_0x3add20(0xfe)](_0x3d381d);}const _0x52b4aa=_0x53d3f8[_0x23aa22(0x175)](_0x22f708=>_0x24f5b9(_0x22f708));await Promise['all'](_0x52b4aa),_0x214632[_0x23aa22(0xeb)](_0x48ee2a);}),router[a0_0x4e7a4a(0xbc)]('/barcode_scanner_logs',async(_0xb515a1,_0x3a528b)=>{var _0x52aa95=a0_0x4e7a4a;const {product_code:_0x5e42d8,warehouse_name:_0x2a446c,rooms_data:_0x5e1971,Roomslist:_0x12eb01,sales_category:_0x644cb5}=_0xb515a1[_0x52aa95(0x124)],_0x1b9a0c=_0x12eb01[_0x52aa95(0x10f)](','),_0x4b5f7f=[];async function _0x155db7(_0x4065d9){var _0x5ae5ce=_0x52aa95;const _0x2a197a=await warehouse[_0x5ae5ce(0xfa)]([{'$match':{'name':_0x2a446c,'room':_0x4065d9}},{'$unwind':_0x5ae5ce(0x127)},{'$match':{'product_details.primary_code':_0x5e42d8,'product_details.sales_category':_0x644cb5,'product_details.type_products':_0x5ae5ce(0xc3)}},{'$group':{'_id':_0x5ae5ce(0xa1),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5ae5ce(0xf4)},'primary_code':{'$first':_0x5ae5ce(0xc6)},'secondary_code':{'$first':_0x5ae5ce(0xa2)},'product_code':{'$first':_0x5ae5ce(0xb8)},'level':{'$first':_0x5ae5ce(0xf0)},'bay':{'$first':_0x5ae5ce(0x1b2)},'type':{'$first':_0x5ae5ce(0x14b)},'pallet':{'$first':_0x5ae5ce(0x154)},'unit':{'$first':_0x5ae5ce(0xe0)},'secondary_unit':{'$first':_0x5ae5ce(0xa6)},'storage':{'$first':_0x5ae5ce(0x11a)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5ae5ce(0xfb)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x5ae5ce(0x12f)},'batch_code':{'$first':_0x5ae5ce(0x18c)},'product_cat':{'$first':_0x5ae5ce(0xdb)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x5ae5ce(0x15a)},'uuid':{'$first':_0x5ae5ce(0xaf)},'gross_price':{'$first':_0x5ae5ce(0xad)},'sales_category':{'$first':_0x5ae5ce(0xe1)},'type_products':{'$first':_0x5ae5ce(0x134)}}}]);console[_0x5ae5ce(0xc3)](_0x5ae5ce(0xc3)+_0x5ae5ce(0xf6)+_0x5e42d8+_0x5ae5ce(0xf6)+_0x644cb5);const _0x29920f=await warehouse['aggregate']([{'$match':{'name':_0x2a446c,'room':_0x4065d9}},{'$unwind':_0x5ae5ce(0x127)},{'$match':{'product_details.secondary_code':_0x5e42d8,'product_details.sales_category':_0x644cb5,'product_details.type_products':_0x5ae5ce(0xc3)}},{'$group':{'_id':_0x5ae5ce(0xa1),'name':{'$first':_0x5ae5ce(0x10e)},'product_stock':{'$first':_0x5ae5ce(0xf4)},'primary_code':{'$first':_0x5ae5ce(0xc6)},'secondary_code':{'$first':_0x5ae5ce(0xa2)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5ae5ce(0x1b2)},'isle':{'$first':_0x5ae5ce(0xc2)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5ae5ce(0xe0)},'secondary_unit':{'$first':_0x5ae5ce(0xa6)},'storage':{'$first':_0x5ae5ce(0x11a)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5ae5ce(0xfb)},'production_date':{'$first':_0x5ae5ce(0x1b8)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x5ae5ce(0x18c)},'product_cat':{'$first':_0x5ae5ce(0xdb)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x5ae5ce(0xbf)},'invoice':{'$first':_0x5ae5ce(0x15a)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x5ae5ce(0xad)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':_0x5ae5ce(0x134)}}}]);if(_0x2a197a['length']>0x0)_0x4b5f7f[_0x5ae5ce(0xfe)](_0x2a197a);else _0x29920f['length']>0x0&&_0x4b5f7f['push'](_0x29920f);}const _0x2298cc=_0x1b9a0c[_0x52aa95(0x175)](_0x418cef=>_0x155db7(_0x418cef));await Promise[_0x52aa95(0x111)](_0x2298cc),_0x3a528b[_0x52aa95(0xeb)](_0x4b5f7f);}),module[a0_0x4e7a4a(0x160)]=router;