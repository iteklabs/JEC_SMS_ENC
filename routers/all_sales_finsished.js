var a0_0x4505f7=a0_0x24dd;(function(_0x30d0a0,_0x46ebfc){var _0x91ff05=a0_0x24dd,_0x2bc085=_0x30d0a0();while(!![]){try{var _0x3644aa=parseInt(_0x91ff05(0xc1))/0x1*(parseInt(_0x91ff05(0x12d))/0x2)+-parseInt(_0x91ff05(0xba))/0x3+parseInt(_0x91ff05(0x186))/0x4+-parseInt(_0x91ff05(0x8c))/0x5*(parseInt(_0x91ff05(0x98))/0x6)+-parseInt(_0x91ff05(0x115))/0x7+-parseInt(_0x91ff05(0x153))/0x8+-parseInt(_0x91ff05(0x138))/0x9*(-parseInt(_0x91ff05(0xb7))/0xa);if(_0x3644aa===_0x46ebfc)break;else _0x2bc085['push'](_0x2bc085['shift']());}catch(_0x2fc722){_0x2bc085['push'](_0x2bc085['shift']());}}}(a0_0x990b,0x970e0));const express=require(a0_0x4505f7(0x1b6)),app=express(),router=express[a0_0x4505f7(0x13f)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require(a0_0x4505f7(0x16a)),auth=require('../middleware/auth'),nodemailer=require(a0_0x4505f7(0xdb)),users=require(a0_0x4505f7(0xf1)),mongoose=require(a0_0x4505f7(0x11c));router[a0_0x4505f7(0x11f)](a0_0x4505f7(0x17c),auth,async(_0x7b1029,_0x4eb766)=>{var _0x5890ac=a0_0x4505f7;try{const {username:_0x382f09,email:_0x4c40c2,role:_0x1931ef}=_0x7b1029[_0x5890ac(0xb3)],_0x136955=_0x7b1029[_0x5890ac(0xb3)],_0x27b9bc=await profile['findOne']({'email':_0x136955[_0x5890ac(0x171)]}),_0x18205b=await master_shop['find']();let _0x5d6d3f;if(_0x136955[_0x5890ac(0x81)]==_0x5890ac(0x1c0)){const _0x1fd686=await staff[_0x5890ac(0x7b)]({'email':_0x136955['email']});_0x5d6d3f=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x5890ac(0x114)}},{'$unwind':_0x5890ac(0x1a2)},{'$group':{'_id':_0x5890ac(0xad),'invoice':{'$first':_0x5890ac(0x9d)},'customers':{'$first':_0x5890ac(0x1b8)},'date':{'$first':_0x5890ac(0x19a)},'warehouse_name':{'$first':_0x5890ac(0x116)},'sale_product':{'$push':'$sale_product'},'note':{'$first':'$note'},'return_data':{'$first':_0x5890ac(0xee)},'customers_docs':{'$first':_0x5890ac(0x121)},'total_saleproduct_quantity':{'$sum':_0x5890ac(0x1b2)},'level':{'$addToSet':_0x5890ac(0x131)},'isle':{'$addToSet':_0x5890ac(0x9e)},'type':{'$addToSet':_0x5890ac(0x129)},'pallet':{'$addToSet':_0x5890ac(0x18f)},'finalize':{'$first':_0x5890ac(0xf8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x5d6d3f=await sales_finished[_0x5890ac(0x85)]([{'$match':{'typeOfProducts':'own'}},{'$unwind':_0x5890ac(0x1a2)},{'$group':{'_id':_0x5890ac(0xad),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':_0x5890ac(0x19a)},'warehouse_name':{'$first':_0x5890ac(0x116)},'sale_product':{'$push':_0x5890ac(0x1a2)},'note':{'$first':_0x5890ac(0x175)},'return_data':{'$first':_0x5890ac(0xee)},'customers_docs':{'$first':_0x5890ac(0x121)},'total_saleproduct_quantity':{'$sum':_0x5890ac(0x1b2)},'level':{'$addToSet':_0x5890ac(0x131)},'isle':{'$addToSet':_0x5890ac(0x9e)},'type':{'$addToSet':_0x5890ac(0x129)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x5890ac(0xf8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x18205b[0x0][_0x5890ac(0x158)]=='English\x20(US)'){var _0x2206ee=users[_0x5890ac(0x108)];console[_0x5890ac(0x135)](_0x2206ee);}else{if(_0x18205b[0x0][_0x5890ac(0x158)]==_0x5890ac(0xcf))var _0x2206ee=users[_0x5890ac(0xcf)];else{if(_0x18205b[0x0][_0x5890ac(0x158)]=='German')var _0x2206ee=users[_0x5890ac(0xac)];else{if(_0x18205b[0x0][_0x5890ac(0x158)]==_0x5890ac(0xe1))var _0x2206ee=users[_0x5890ac(0xe1)];else{if(_0x18205b[0x0][_0x5890ac(0x158)]==_0x5890ac(0x128))var _0x2206ee=users['French'];else{if(_0x18205b[0x0][_0x5890ac(0x158)]==_0x5890ac(0x1a9))var _0x2206ee=users[_0x5890ac(0x127)];else{if(_0x18205b[0x0][_0x5890ac(0x158)]==_0x5890ac(0x165))var _0x2206ee=users['Chinese'];else{if(_0x18205b[0x0]['language']==_0x5890ac(0x1a0))var _0x2206ee=users[_0x5890ac(0x198)];}}}}}}}_0x4eb766[_0x5890ac(0x14d)]('all_sales_finished',{'success':_0x7b1029[_0x5890ac(0x112)]('success'),'errors':_0x7b1029['flash'](_0x5890ac(0x79)),'sales':_0x5d6d3f,'profile':_0x27b9bc,'role':_0x136955,'master_shop':_0x18205b,'language':_0x2206ee});}catch(_0xa861eb){console['log'](_0xa861eb);}}),router['get'](a0_0x4505f7(0xea),auth,async(_0x1bbdbd,_0x3fd90b)=>{var _0xe10b2e=a0_0x4505f7;try{const {username:_0x3dd371,email:_0x2a20d9,role:_0xd3ff31}=_0x1bbdbd[_0xe10b2e(0xb3)],_0x397c15=_0x1bbdbd[_0xe10b2e(0xb3)],_0x36773a=await profile[_0xe10b2e(0x7b)]({'email':_0x397c15[_0xe10b2e(0x171)]}),_0x4042ac=await master_shop[_0xe10b2e(0xf9)]();let _0x5e4348;if(_0x397c15[_0xe10b2e(0x81)]==_0xe10b2e(0x1c0)){const _0x4d72b5=await staff[_0xe10b2e(0x7b)]({'email':_0x397c15[_0xe10b2e(0x171)]});_0x5e4348=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0xe10b2e(0x18c)}},{'$unwind':_0xe10b2e(0x1a2)},{'$group':{'_id':_0xe10b2e(0xad),'invoice':{'$first':_0xe10b2e(0x9d)},'customers':{'$first':_0xe10b2e(0x1b8)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0xe10b2e(0x116)},'sale_product':{'$push':_0xe10b2e(0x1a2)},'note':{'$first':_0xe10b2e(0x175)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0xe10b2e(0x1b2)},'level':{'$addToSet':_0xe10b2e(0x131)},'isle':{'$addToSet':_0xe10b2e(0x9e)},'type':{'$addToSet':_0xe10b2e(0x129)},'pallet':{'$addToSet':_0xe10b2e(0x18f)},'finalize':{'$first':_0xe10b2e(0xf8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x5e4348=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0xe10b2e(0x18c)}},{'$unwind':_0xe10b2e(0x1a2)},{'$group':{'_id':'$_id','invoice':{'$first':_0xe10b2e(0x9d)},'customers':{'$first':_0xe10b2e(0x1b8)},'date':{'$first':_0xe10b2e(0x19a)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0xe10b2e(0x1a2)},'note':{'$first':_0xe10b2e(0x175)},'return_data':{'$first':_0xe10b2e(0xee)},'customers_docs':{'$first':_0xe10b2e(0x121)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0xe10b2e(0x131)},'isle':{'$addToSet':_0xe10b2e(0x9e)},'type':{'$addToSet':_0xe10b2e(0x129)},'pallet':{'$addToSet':_0xe10b2e(0x18f)},'finalize':{'$first':_0xe10b2e(0xf8)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x4042ac[0x0]['language']==_0xe10b2e(0x184)){var _0x45e949=users[_0xe10b2e(0x108)];console['log'](_0x45e949);}else{if(_0x4042ac[0x0][_0xe10b2e(0x158)]==_0xe10b2e(0xcf))var _0x45e949=users[_0xe10b2e(0xcf)];else{if(_0x4042ac[0x0]['language']==_0xe10b2e(0xac))var _0x45e949=users[_0xe10b2e(0xac)];else{if(_0x4042ac[0x0][_0xe10b2e(0x158)]==_0xe10b2e(0xe1))var _0x45e949=users[_0xe10b2e(0xe1)];else{if(_0x4042ac[0x0][_0xe10b2e(0x158)]==_0xe10b2e(0x128))var _0x45e949=users[_0xe10b2e(0x128)];else{if(_0x4042ac[0x0][_0xe10b2e(0x158)]=='Portuguese\x20(BR)')var _0x45e949=users[_0xe10b2e(0x127)];else{if(_0x4042ac[0x0]['language']==_0xe10b2e(0x165))var _0x45e949=users[_0xe10b2e(0x165)];else{if(_0x4042ac[0x0]['language']==_0xe10b2e(0x1a0))var _0x45e949=users[_0xe10b2e(0x198)];}}}}}}}_0x3fd90b[_0xe10b2e(0x14d)](_0xe10b2e(0x167),{'success':_0x1bbdbd[_0xe10b2e(0x112)](_0xe10b2e(0x192)),'errors':_0x1bbdbd[_0xe10b2e(0x112)](_0xe10b2e(0x79)),'sales':_0x5e4348,'profile':_0x36773a,'role':_0x397c15,'master_shop':_0x4042ac,'language':_0x45e949});}catch(_0x55d7af){console['log'](_0x55d7af);}});function a0_0x24dd(_0x10bab0,_0x41b7ad){var _0x990b78=a0_0x990b();return a0_0x24dd=function(_0x24dd0b,_0x35447e){_0x24dd0b=_0x24dd0b-0x79;var _0x2923b4=_0x990b78[_0x24dd0b];return _0x2923b4;},a0_0x24dd(_0x10bab0,_0x41b7ad);}async function getRandom8DigitNumber(){var _0x11452d=a0_0x4505f7;const _0x513866=0x989680,_0x657f23=0x5f5e0ff,_0x2ed825=Math[_0x11452d(0x10a)](Math[_0x11452d(0x16d)]()*(_0x657f23-_0x513866+0x1))+_0x513866;var _0x473fdd;const _0x3624ed=await sales_finished[_0x11452d(0x7b)]({'invoice':_0x11452d(0x8d)+_0x2ed825});return _0x3624ed&&_0x3624ed['length']>0x0?_0x473fdd=_0x11452d(0x8d)+_0x2ed825:_0x473fdd=_0x11452d(0x8d)+_0x2ed825,_0x473fdd;}router[a0_0x4505f7(0x11f)](a0_0x4505f7(0xb0),auth,async(_0xa83bb6,_0x527db9)=>{var _0x599784=a0_0x4505f7;try{const {username:_0x1d8086,email:_0x5daf76,role:_0x46b64c}=_0xa83bb6[_0x599784(0xb3)],_0x1d7356=_0xa83bb6[_0x599784(0xb3)],_0x48a709=await profile['findOne']({'email':_0x1d7356[_0x599784(0x171)]}),_0x44a888=await master_shop[_0x599784(0xf9)](),_0x2cd37d=await customer[_0x599784(0xf9)]({});let _0x5af9f2;if(_0x1d7356['role']==_0x599784(0x1c0)){const _0x4d16e1=await staff[_0x599784(0x7b)]({'email':_0x1d7356[_0x599784(0x171)]});_0x5af9f2=await warehouse[_0x599784(0x85)]([{'$match':{'status':_0x599784(0x15d),'name':_0x4d16e1[_0x599784(0xe9)]}},{'$group':{'_id':_0x599784(0x94),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x5af9f2=await warehouse[_0x599784(0x85)]([{'$match':{'status':_0x599784(0x15d)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x5a7680=await product[_0x599784(0xf9)]({});var _0xf41d85=[_0x599784(0x13c),_0x599784(0x1c3)];const _0x30ab90=await sales_finished[_0x599784(0xf9)]({}),_0x33d2b3=_0x30ab90['length']+0x1,_0x1c8c8f=_0x599784(0x8d)+_0x33d2b3[_0x599784(0x177)]()[_0x599784(0xde)](0x5,'0');if(_0x44a888[0x0][_0x599784(0x158)]=='English\x20(US)'){var _0x2217e9=users[_0x599784(0x108)];console[_0x599784(0x135)](_0x2217e9);}else{if(_0x44a888[0x0]['language']==_0x599784(0xcf))var _0x2217e9=users[_0x599784(0xcf)];else{if(_0x44a888[0x0][_0x599784(0x158)]=='German')var _0x2217e9=users['German'];else{if(_0x44a888[0x0][_0x599784(0x158)]==_0x599784(0xe1))var _0x2217e9=users[_0x599784(0xe1)];else{if(_0x44a888[0x0][_0x599784(0x158)]==_0x599784(0x128))var _0x2217e9=users[_0x599784(0x128)];else{if(_0x44a888[0x0][_0x599784(0x158)]==_0x599784(0x1a9))var _0x2217e9=users[_0x599784(0x127)];else{if(_0x44a888[0x0][_0x599784(0x158)]==_0x599784(0x165))var _0x2217e9=users[_0x599784(0x165)];else{if(_0x44a888[0x0][_0x599784(0x158)]==_0x599784(0x1a0))var _0x2217e9=users[_0x599784(0x198)];}}}}}}}const _0x2ea5a9=getRandom8DigitNumber();_0x2ea5a9[_0x599784(0xcd)](_0x505ad2=>{var _0x527980=_0x599784;_0x527db9[_0x527980(0x14d)]('add_sales_finished',{'success':_0xa83bb6[_0x527980(0x112)]('success'),'errors':_0xa83bb6[_0x527980(0x112)](_0x527980(0x79)),'role':_0x1d7356,'profile':_0x48a709,'customer':_0x2cd37d,'warehouse':_0x5af9f2,'product':_0x5a7680,'invoice':_0x505ad2,'master_shop':_0x44a888,'language':_0x2217e9,'rooms_data':_0xf41d85});})[_0x599784(0xaa)](_0x3286f5=>{var _0x449af7=_0x599784;_0xa83bb6[_0x449af7(0x112)]('errors',_0x449af7(0x95)),_0x527db9[_0x449af7(0x106)]('/all_sales_finished/view');});}catch(_0x1439cb){console[_0x599784(0x135)](_0x1439cb);}}),router[a0_0x4505f7(0x11f)](a0_0x4505f7(0x150),auth,async(_0x3cd34f,_0x4d71f6)=>{var _0x1576d1=a0_0x4505f7;try{const {username:_0xcc729d,email:_0x4f486b,role:_0x52fe1e}=_0x3cd34f['user'],_0x1a43c1=_0x3cd34f['user'],_0x3a7813=await profile[_0x1576d1(0x7b)]({'email':_0x1a43c1['email']}),_0x17790e=await master_shop[_0x1576d1(0xf9)](),_0x3cf069=await customer['find']({});let _0x2735ca;if(_0x1a43c1[_0x1576d1(0x81)]==_0x1576d1(0x1c0)){const _0x31183f=await staff[_0x1576d1(0x7b)]({'email':_0x1a43c1[_0x1576d1(0x171)]});_0x2735ca=await warehouse[_0x1576d1(0x85)]([{'$match':{'status':_0x1576d1(0x15d),'name':_0x31183f[_0x1576d1(0xe9)]}},{'$group':{'_id':_0x1576d1(0x94),'name':{'$first':_0x1576d1(0x94)}}},{'$sort':{'name':0x1}}]);}else _0x2735ca=await warehouse['aggregate']([{'$match':{'status':_0x1576d1(0x15d)}},{'$group':{'_id':_0x1576d1(0x94),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0xd4b963=await product['find']({});var _0xeeec63=['Ambient',_0x1576d1(0x1c3)];const _0x2eee7a=await sales_finished['find']({}),_0x4240d7=_0x2eee7a[_0x1576d1(0x19e)]+0x1,_0x2e18a8='OUTF-'+_0x4240d7[_0x1576d1(0x177)]()['padStart'](0x5,'0');if(_0x17790e[0x0][_0x1576d1(0x158)]=='English\x20(US)'){var _0x48c16b=users[_0x1576d1(0x108)];console['log'](_0x48c16b);}else{if(_0x17790e[0x0][_0x1576d1(0x158)]=='Hindi')var _0x48c16b=users[_0x1576d1(0xcf)];else{if(_0x17790e[0x0][_0x1576d1(0x158)]==_0x1576d1(0xac))var _0x48c16b=users[_0x1576d1(0xac)];else{if(_0x17790e[0x0][_0x1576d1(0x158)]==_0x1576d1(0xe1))var _0x48c16b=users['Spanish'];else{if(_0x17790e[0x0][_0x1576d1(0x158)]==_0x1576d1(0x128))var _0x48c16b=users[_0x1576d1(0x128)];else{if(_0x17790e[0x0][_0x1576d1(0x158)]=='Portuguese\x20(BR)')var _0x48c16b=users[_0x1576d1(0x127)];else{if(_0x17790e[0x0][_0x1576d1(0x158)]==_0x1576d1(0x165))var _0x48c16b=users[_0x1576d1(0x165)];else{if(_0x17790e[0x0]['language']=='Arabic\x20(ae)')var _0x48c16b=users['Arabic'];}}}}}}}const _0x2f6984=getRandom8DigitNumber();_0x2f6984[_0x1576d1(0xcd)](_0x4e871b=>{var _0x461686=_0x1576d1;_0x4d71f6['render'](_0x461686(0x8b),{'success':_0x3cd34f[_0x461686(0x112)]('success'),'errors':_0x3cd34f[_0x461686(0x112)](_0x461686(0x79)),'role':_0x1a43c1,'profile':_0x3a7813,'customer':_0x3cf069,'warehouse':_0x2735ca,'product':_0xd4b963,'invoice':_0x4e871b,'master_shop':_0x17790e,'language':_0x48c16b,'rooms_data':_0xeeec63});})[_0x1576d1(0xaa)](_0x2a95ad=>{var _0x18d1b1=_0x1576d1;_0x3cd34f[_0x18d1b1(0x112)](_0x18d1b1(0x79),_0x18d1b1(0x95)),_0x4d71f6['redirect']('/all_sales_finished/view');});}catch(_0x5d95bf){console['log'](_0x5d95bf);}}),router['post']('/view/add_sales_logs',auth,async(_0x4904b0,_0x57b6f4)=>{var _0x3959eb=a0_0x4505f7;try{const {invoice:_0x7086fc,date:_0x4798ed,warehouse_name:_0x5d926f,product_name:_0x25b998,note:_0x5bac00,room:_0x5dc4a2,primary_code:_0x41f511,secondary_code:_0x54756c,prod_code:_0x2ed930,SCRN:_0x1a3ad2,ReqBy:_0x5ade33,dateofreq:_0x41d3b6,PO_number:_0x3ea97f,typeservicesData:_0x588ec6,typevehicle:_0x357940,destination:_0x50a16c,deliverydate:_0x26a2fb,driver:_0x1ad033,plate:_0x34b191,van:_0x52e336,DRSI:_0x5cffff,TSU:_0x2f2f2a,TFU:_0x31174f,mode_transpo:_0xdc567a,name_driver:_0x6034d0,type_of_products:_0x471864}=_0x4904b0[_0x3959eb(0xf4)];if(typeof _0x25b998==_0x3959eb(0x134))var _0x596e97=[_0x4904b0['body'][_0x3959eb(0xa6)]],_0x524822=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0xbf)]],_0xb463fc=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0xe8)]],_0x21f193=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x168)]],_0x2743c7=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x100)]],_0x41af80=[_0x4904b0[_0x3959eb(0xf4)]['prod_code']],_0x48ea64=[_0x4904b0['body'][_0x3959eb(0x137)]],_0x388c9f=[_0x4904b0['body'][_0x3959eb(0x132)]],_0x362024=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x1a8)]],_0x40800a=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x16e)]],_0xe3ca4=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x119)]],_0x180958=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x1a7)]],_0x331ef9=[_0x4904b0['body'][_0x3959eb(0x1be)]],_0x1e6942=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x1b9)]],_0x4bfe3a=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0xf5)]],_0x4cff63=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0xed)]],_0x435fce=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0xda)]],_0x3e571b=[_0x4904b0['body'][_0x3959eb(0x197)]],_0x10d81d=[_0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0xc5)]];else var _0x596e97=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0xa6)]],_0x524822=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0xbf)]],_0xb463fc=[..._0x4904b0['body'][_0x3959eb(0xe8)]],_0x21f193=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x168)]],_0x2743c7=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x100)]],_0x41af80=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x1c4)]],_0x48ea64=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x137)]],_0x388c9f=[..._0x4904b0[_0x3959eb(0xf4)]['primary_unit']],_0x362024=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x1a8)]],_0x40800a=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x16e)]],_0xe3ca4=[..._0x4904b0['body'][_0x3959eb(0x119)]],_0x180958=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x1a7)]],_0x331ef9=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x1be)]],_0x1e6942=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x1b9)]],_0x4bfe3a=[..._0x4904b0['body']['RoomAssigned']],_0x4cff63=[..._0x4904b0['body'][_0x3959eb(0xed)]],_0x435fce=[..._0x4904b0['body'][_0x3959eb(0xda)]],_0x3e571b=[..._0x4904b0[_0x3959eb(0xf4)][_0x3959eb(0x197)]],_0x10d81d=[..._0x4904b0[_0x3959eb(0xf4)]['gross_price']];const _0x5d38fc=_0x596e97[_0x3959eb(0xb5)](_0x483e7d=>{return _0x483e7d={'product_name':_0x483e7d};});_0x524822[_0x3959eb(0x18b)]((_0x544954,_0x143965)=>{var _0x466a97=_0x3959eb;_0x5d38fc[_0x143965][_0x466a97(0xbf)]=_0x544954;}),_0xb463fc[_0x3959eb(0x18b)]((_0x146eb0,_0x2ddfc9)=>{var _0x2dc3e4=_0x3959eb;_0x5d38fc[_0x2ddfc9][_0x2dc3e4(0x87)]=Math[_0x2dc3e4(0x133)](_0x146eb0);}),_0x596e97['forEach']((_0x3ae836,_0x543d65)=>{var _0x483dcb=_0x3959eb;_0x5d38fc[_0x543d65][_0x483dcb(0x130)]=_0x4904b0[_0x483dcb(0xf4)][_0x483dcb(0x11e)];}),_0x10d81d['forEach']((_0x4bcf41,_0x482138)=>{var _0x512c56=_0x3959eb;_0x5d38fc[_0x482138][_0x512c56(0xc5)]=_0x4bcf41;}),_0x3e571b[_0x3959eb(0x18b)]((_0x1c2e93,_0x6ad5f2)=>{var _0x246fc1=_0x3959eb;_0x5d38fc[_0x6ad5f2][_0x246fc1(0x197)]=_0x1c2e93;}),_0x435fce[_0x3959eb(0x18b)]((_0x1fd819,_0x4e74f8)=>{var _0x42391d=_0x3959eb;_0x5d38fc[_0x4e74f8][_0x42391d(0xda)]=_0x1fd819;}),_0x21f193[_0x3959eb(0x18b)]((_0xe933a7,_0x3e74bc)=>{var _0x30b674=_0x3959eb;_0x5d38fc[_0x3e74bc][_0x30b674(0x168)]=_0xe933a7;}),_0x2743c7[_0x3959eb(0x18b)]((_0x28ffd1,_0x4e777e)=>{var _0x38d5d0=_0x3959eb;_0x5d38fc[_0x4e777e][_0x38d5d0(0x100)]=_0x28ffd1;}),_0x41af80[_0x3959eb(0x18b)]((_0x58a8a3,_0x385ea6)=>{var _0x38cfc9=_0x3959eb;_0x5d38fc[_0x385ea6][_0x38cfc9(0xbb)]=_0x58a8a3;}),_0x48ea64[_0x3959eb(0x18b)]((_0x57f5e8,_0x18d68b)=>{var _0x1a6d38=_0x3959eb,_0x1220fa=_0x57f5e8[_0x1a6d38(0x19f)](/[A-Za-z]+/)[0x0],_0x15d05a=parseInt(_0x57f5e8[_0x1a6d38(0x19f)](/\d+/)[0x0]);_0x5d38fc[_0x18d68b][_0x1a6d38(0x17f)]=_0x15d05a,_0x5d38fc[_0x18d68b]['level']=_0x1220fa;}),_0x388c9f[_0x3959eb(0x18b)]((_0x4d8c33,_0x5ad3b9)=>{_0x5d38fc[_0x5ad3b9]['unit']=_0x4d8c33;}),_0x362024[_0x3959eb(0x18b)]((_0x131b7c,_0x363ab2)=>{var _0x172bdc=_0x3959eb;_0x5d38fc[_0x363ab2][_0x172bdc(0x1a8)]=_0x131b7c;}),_0x40800a[_0x3959eb(0x18b)]((_0x1aee0c,_0x2dc32b)=>{var _0x55b3bc=_0x3959eb;_0x5d38fc[_0x2dc32b][_0x55b3bc(0x16e)]=_0x1aee0c;}),_0xe3ca4[_0x3959eb(0x18b)]((_0x133f03,_0x5536b7)=>{_0x5d38fc[_0x5536b7]['expiry_date']=_0x133f03;}),_0x180958['forEach']((_0x9eac7c,_0x2f8542)=>{_0x5d38fc[_0x2f8542]['production_date']=_0x9eac7c;}),_0x331ef9['forEach']((_0x470b87,_0x1b09a4)=>{_0x5d38fc[_0x1b09a4]['maxperunit']=_0x470b87;}),_0x1e6942[_0x3959eb(0x18b)]((_0x582fd4,_0x461263)=>{var _0x12c37c=_0x3959eb;_0x5d38fc[_0x461263][_0x12c37c(0x1b9)]=_0x582fd4;}),_0x4bfe3a[_0x3959eb(0x18b)]((_0x2e5748,_0x3b884a)=>{_0x5d38fc[_0x3b884a]['room_name']=_0x2e5748;}),_0x4cff63[_0x3959eb(0x18b)]((_0x1dd166,_0x209f0b)=>{var _0x43f7cb=_0x3959eb;_0x5d38fc[_0x209f0b][_0x43f7cb(0x146)]=_0x1dd166,_0x5d38fc[_0x209f0b][_0x43f7cb(0x10e)]=_0x4798ed;});const _0x494577=new sales_logs();await _0x494577['save'](),_0x4cff63['forEach']((_0x385e79,_0x133fc2)=>{var _0x80c48a=_0x3959eb;_0x5d38fc[_0x133fc2]['outgoing_invoice']=_0x80c48a(0x1bc)+_0x494577[_0x80c48a(0x122)]['toString']()['padStart'](0x8,'0');});var _0xeae51f=0x0;_0x5d38fc[_0x3959eb(0x18b)](_0x1457f3=>{var _0x220390=_0x3959eb;parseFloat(_0x1457f3[_0x220390(0xbf)])<parseFloat(_0x1457f3['quantity'])&&parseFloat(_0x1457f3[_0x220390(0x87)])>parseFloat(_0x1457f3[_0x220390(0xbf)])&&(console[_0x220390(0x135)](_0x1457f3[_0x220390(0xbf)]+_0x220390(0xa7)+_0x1457f3[_0x220390(0x87)]),_0xeae51f++);});if(_0xeae51f!=0x0)return _0x4904b0['flash'](_0x3959eb(0x79),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x57b6f4[_0x3959eb(0x106)](_0x3959eb(0x7c));const _0x5440e6=_0x5d38fc[_0x3959eb(0x13e)](_0x152fe6=>_0x152fe6[_0x3959eb(0x87)]!=='0'&&_0x152fe6[_0x3959eb(0x87)]!==''),_0x9510d2=new sales_finished({'invoice':_0x3959eb(0x1bc)+_0x494577[_0x3959eb(0x122)][_0x3959eb(0x177)]()[_0x3959eb(0xde)](0x8,'0'),'sales_data':_0x4904b0['body'][_0x3959eb(0x11e)],'customer':_0x4904b0[_0x3959eb(0xf4)]['customer'],'date':_0x4798ed,'warehouse_name':_0x5d926f,'sale_product':_0x5440e6,'note':_0x5bac00,'room':_0x5dc4a2,'primary_code':_0x41f511,'secondary_code':_0x54756c,'prod_code':_0x2ed930,'SCRN':_0x1a3ad2,'finalize':_0x3959eb(0xec),'mode_transpo':_0xdc567a,'name_driver':_0x6034d0,'ReqBy':_0x5ade33,'dateofreq':_0x41d3b6,'PO_number':_0x3ea97f,'typeservicesData':_0x588ec6,'typevehicle':_0x357940,'destination':_0x50a16c,'deliverydate':_0x26a2fb,'driver':_0x1ad033,'plate':_0x34b191,'van':_0x52e336,'DRSI':_0x5cffff,'TSU':_0x2f2f2a,'TFU':_0x31174f,'typeOfProducts':_0x471864}),_0x2e6118=await _0x9510d2[_0x3959eb(0xc2)](),_0x10925e=await sales_finished['findOne']({'invoice':_0x7086fc});_0x4904b0[_0x3959eb(0x112)](_0x3959eb(0x192),'Sales\x20Add\x20successfully'),_0x57b6f4[_0x3959eb(0x106)](_0x3959eb(0x1b0)+_0x2e6118[_0x3959eb(0x9f)]);}catch(_0x245c44){console[_0x3959eb(0x135)](_0x245c44);}}),router[a0_0x4505f7(0x11f)](a0_0x4505f7(0x141),auth,async(_0x50eec6,_0x1a3742)=>{var _0x4f14ee=a0_0x4505f7;try{const _0x2617f7=_0x50eec6[_0x4f14ee(0x113)]['id'];console['log'](_0x2617f7);const _0x3d3e30=await product[_0x4f14ee(0xf9)](),_0x31f066=await purchases[_0x4f14ee(0x85)]([{'$match':{'warehouse_name':_0x2617f7}},{'$unwind':'$product'},{'$group':{'_id':_0x4f14ee(0x12e)}}]);console['log']('purchases_data',_0x31f066),_0x1a3742['status'](0xc8)[_0x4f14ee(0x1b3)]({'purchases_data':_0x31f066,'product_data':_0x3d3e30});}catch(_0x436533){console[_0x4f14ee(0x135)](_0x436533);}}),router[a0_0x4505f7(0xb2)](a0_0x4505f7(0x10c),auth,async(_0x3edbdc,_0x12f568)=>{var _0x18ab49=a0_0x4505f7;try{const {warehouse_data:_0x570c98,product_data:_0x2a33a0}=_0x3edbdc[_0x18ab49(0xf4)];console[_0x18ab49(0x135)](_0x3edbdc[_0x18ab49(0xf4)][_0x18ab49(0x12a)]);;const _0x2da092=await master_shop['find']();console[_0x18ab49(0x135)](_0x18ab49(0x1b7),_0x2da092);const _0x1ff56e=await product[_0x18ab49(0x7b)]({'name':_0x2a33a0});console[_0x18ab49(0x135)]('product',_0x1ff56e);const _0x572bea=await warehouse[_0x18ab49(0x85)]([{'$match':{'name':_0x570c98}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x2a33a0}},{'$group':{'_id':_0x18ab49(0xd0),'product_stock':{'$first':_0x18ab49(0x1b5)}}}]);console[_0x18ab49(0x135)](_0x18ab49(0x104),_0x572bea),_0x12f568[_0x18ab49(0x189)](0xc8)['json']({'master':_0x2da092,'new_product':_0x1ff56e,'stock_data':_0x572bea});}catch(_0x4cd1b7){console['log'](_0x4cd1b7);}}),router[a0_0x4505f7(0xb2)](a0_0x4505f7(0xb0),auth,async(_0x2e45d3,_0x3e0f63)=>{var _0x112441=a0_0x4505f7;try{const {invoice:_0x530eca,date:_0x3fee82,warehouse_name:_0x4a1688,product_name:_0x1f67de,note:_0x4cc616,room:_0x400346,primary_code:_0x26290f,secondary_code:_0xb7a374,prod_code:_0x47b9cf,SCRN:_0xde0f1c,ReqBy:_0xebd248,dateofreq:_0x13386a,PO_number:_0x5766fa,typeservicesData:_0x265896,typevehicle:_0x22388d,destination:_0xbb01f7,deliverydate:_0x5ba4b9,driver:_0x2614be,plate:_0x26fcf7,van:_0x218479,DRSI:_0x149233,TSU:_0x506812,TFU:_0x4cf3c5,mode_transpo:_0x366596,name_driver:_0x2d995b,pull_out_date:_0x3ca817,actual_delivery_date:_0x4f734a}=_0x2e45d3[_0x112441(0xf4)];_0x3e0f63[_0x112441(0x1b3)](_0x2e45d3['body']);return;if(typeof _0x1f67de=='string')var _0x47c10e=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0xa6)]],_0x808c3f=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0xbf)]],_0x4e9c9b=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0xe8)]],_0x19509b=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x168)]],_0x138c0d=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x100)]],_0x55555a=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x1c4)]],_0x31f560=[_0x2e45d3['body'][_0x112441(0x137)]],_0x507289=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x132)]],_0x570025=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x1a8)]],_0x24510f=[_0x2e45d3[_0x112441(0xf4)]['batch_code']],_0x2255fc=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x119)]],_0x2a3c6b=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x1a7)]],_0xdebe69=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x1be)]],_0x2c1d8b=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x1b9)]],_0x51dc74=[_0x2e45d3['body'][_0x112441(0xf5)]],_0x295d4c=[_0x2e45d3['body'][_0x112441(0xed)]],_0x40b62e=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0xda)]],_0x5effac=[_0x2e45d3[_0x112441(0xf4)][_0x112441(0x197)]],_0x55e732=[_0x2e45d3['body'][_0x112441(0xc5)]];else var _0x47c10e=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0xa6)]],_0x808c3f=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0xbf)]],_0x4e9c9b=[..._0x2e45d3['body'][_0x112441(0xe8)]],_0x19509b=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0x168)]],_0x138c0d=[..._0x2e45d3['body'][_0x112441(0x100)]],_0x55555a=[..._0x2e45d3['body']['prod_code']],_0x31f560=[..._0x2e45d3['body'][_0x112441(0x137)]],_0x507289=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0x132)]],_0x570025=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0x1a8)]],_0x24510f=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0x16e)]],_0x2255fc=[..._0x2e45d3[_0x112441(0xf4)]['expiry_date']],_0x2a3c6b=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0x1a7)]],_0xdebe69=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0x1be)]],_0x2c1d8b=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0x1b9)]],_0x51dc74=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0xf5)]],_0x295d4c=[..._0x2e45d3[_0x112441(0xf4)]['prod_invoice']],_0x40b62e=[..._0x2e45d3[_0x112441(0xf4)]['id_transaction_from']],_0x5effac=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0x197)]],_0x55e732=[..._0x2e45d3[_0x112441(0xf4)][_0x112441(0xc5)]];const _0xb5122a=_0x47c10e[_0x112441(0xb5)](_0x33b763=>{return _0x33b763={'product_name':_0x33b763};});_0x808c3f[_0x112441(0x18b)]((_0x19bc88,_0x4207d7)=>{var _0xb5bfc3=_0x112441;_0xb5122a[_0x4207d7][_0xb5bfc3(0xbf)]=_0x19bc88;}),_0x4e9c9b[_0x112441(0x18b)]((_0x508fba,_0x21584b)=>{var _0xa20957=_0x112441;_0xb5122a[_0x21584b][_0xa20957(0x87)]=Math['abs'](_0x508fba);}),_0x47c10e[_0x112441(0x18b)]((_0x1d57e4,_0x30b28a)=>{var _0x4e80fb=_0x112441;_0xb5122a[_0x30b28a][_0x4e80fb(0x130)]=_0x2e45d3[_0x4e80fb(0xf4)][_0x4e80fb(0x11e)];}),_0x55e732[_0x112441(0x18b)]((_0x5c4726,_0xc2af1e)=>{var _0x11c0f6=_0x112441;_0xb5122a[_0xc2af1e][_0x11c0f6(0xc5)]=_0x5c4726;}),_0x5effac[_0x112441(0x18b)]((_0x226f88,_0x5004cd)=>{var _0x2ca7e6=_0x112441;_0xb5122a[_0x5004cd][_0x2ca7e6(0x197)]=_0x226f88;}),_0x40b62e[_0x112441(0x18b)]((_0x1071a5,_0x3c69b6)=>{var _0x30cd41=_0x112441;_0xb5122a[_0x3c69b6][_0x30cd41(0xda)]=_0x1071a5;}),_0x19509b[_0x112441(0x18b)]((_0x26e8a5,_0x10b69a)=>{var _0x4510a7=_0x112441;_0xb5122a[_0x10b69a][_0x4510a7(0x168)]=_0x26e8a5;}),_0x138c0d[_0x112441(0x18b)]((_0x4529cc,_0x72746f)=>{var _0x101bdb=_0x112441;_0xb5122a[_0x72746f][_0x101bdb(0x100)]=_0x4529cc;}),_0x55555a[_0x112441(0x18b)]((_0x39b2aa,_0x391f61)=>{var _0x40a861=_0x112441;_0xb5122a[_0x391f61][_0x40a861(0xbb)]=_0x39b2aa;}),_0x31f560[_0x112441(0x18b)]((_0x3a7238,_0x90e1af)=>{var _0x1f03ac=_0x112441,_0x1d15d5=_0x3a7238[_0x1f03ac(0x19f)](/[A-Za-z]+/)[0x0],_0x5c501d=parseInt(_0x3a7238[_0x1f03ac(0x19f)](/\d+/)[0x0]);_0xb5122a[_0x90e1af]['bay']=_0x5c501d,_0xb5122a[_0x90e1af][_0x1f03ac(0x1bd)]=_0x1d15d5;}),_0x507289['forEach']((_0x1cfa73,_0x50d2f4)=>{var _0x47d8d7=_0x112441;_0xb5122a[_0x50d2f4][_0x47d8d7(0xf6)]=_0x1cfa73;}),_0x570025[_0x112441(0x18b)]((_0xbe0884,_0x4296c6)=>{_0xb5122a[_0x4296c6]['secondary_unit']=_0xbe0884;}),_0x24510f['forEach']((_0x7708db,_0x23dddd)=>{var _0x57a15e=_0x112441;_0xb5122a[_0x23dddd][_0x57a15e(0x16e)]=_0x7708db;}),_0x2255fc['forEach']((_0xf015a0,_0x9f1e24)=>{var _0x15755c=_0x112441;_0xb5122a[_0x9f1e24][_0x15755c(0x119)]=_0xf015a0;}),_0x2a3c6b[_0x112441(0x18b)]((_0x495f90,_0x22ea58)=>{_0xb5122a[_0x22ea58]['production_date']=_0x495f90;}),_0xdebe69['forEach']((_0x43bcb8,_0xde64a8)=>{var _0xe9775=_0x112441;_0xb5122a[_0xde64a8][_0xe9775(0x86)]=_0x43bcb8;}),_0x2c1d8b[_0x112441(0x18b)]((_0x5cfb01,_0x40949d)=>{var _0x430886=_0x112441;_0xb5122a[_0x40949d][_0x430886(0x1b9)]=_0x5cfb01;}),_0x51dc74[_0x112441(0x18b)]((_0x144cf0,_0x5d71ea)=>{var _0x52d551=_0x112441;_0xb5122a[_0x5d71ea][_0x52d551(0xd4)]=_0x144cf0;}),_0x295d4c[_0x112441(0x18b)]((_0x26dc04,_0x3f1db9)=>{var _0x2b8d13=_0x112441;_0xb5122a[_0x3f1db9][_0x2b8d13(0x146)]=_0x26dc04,_0xb5122a[_0x3f1db9]['date_data']=_0x3fee82;});const _0x17a95a=new invoice_for_outgoing();await _0x17a95a['save'](),_0x295d4c[_0x112441(0x18b)]((_0x2f97ae,_0x207935)=>{var _0x1141ed=_0x112441;_0xb5122a[_0x207935][_0x1141ed(0x1a4)]=_0x1141ed(0x111)+_0x17a95a[_0x1141ed(0x122)][_0x1141ed(0x177)]()[_0x1141ed(0xde)](0x8,'0');});var _0x4b2299=0x0;_0xb5122a[_0x112441(0x18b)](_0x171c93=>{var _0x3550e3=_0x112441;parseFloat(_0x171c93[_0x3550e3(0xbf)])<parseFloat(_0x171c93[_0x3550e3(0x87)])&&parseFloat(_0x171c93[_0x3550e3(0x87)])>parseFloat(_0x171c93[_0x3550e3(0xbf)])&&(console[_0x3550e3(0x135)](_0x171c93[_0x3550e3(0xbf)]+_0x3550e3(0xa7)+_0x171c93[_0x3550e3(0x87)]),_0x4b2299++);});if(_0x4b2299!=0x0)return _0x2e45d3[_0x112441(0x112)](_0x112441(0x79),_0x112441(0x102)),_0x3e0f63[_0x112441(0x106)](_0x112441(0x7c));const _0x5b8118=_0xb5122a[_0x112441(0x13e)](_0x2740c6=>_0x2740c6[_0x112441(0x87)]!=='0'&&_0x2740c6['quantity']!==''),_0x10d72b=new sales_finished({'invoice':_0x112441(0x111)+_0x17a95a[_0x112441(0x122)]['toString']()[_0x112441(0xde)](0x8,'0'),'sales_data':_0x2e45d3[_0x112441(0xf4)][_0x112441(0x11e)],'customer':_0x2e45d3['body']['customer'],'date':_0x3fee82,'warehouse_name':_0x4a1688,'sale_product':_0x5b8118,'note':_0x4cc616,'room':_0x400346,'primary_code':_0x26290f,'secondary_code':_0xb7a374,'prod_code':_0x47b9cf,'SCRN':_0xde0f1c,'finalize':_0x112441(0xec),'mode_transpo':_0x366596,'name_driver':_0x2d995b,'ReqBy':_0xebd248,'dateofreq':_0x13386a,'PO_number':_0x5766fa,'typeservicesData':_0x265896,'typevehicle':_0x22388d,'destination':_0xbb01f7,'deliverydate':_0x5ba4b9,'driver':_0x2614be,'plate':_0x26fcf7,'van':_0x218479,'DRSI':_0x149233,'TSU':_0x506812,'TFU':_0x4cf3c5,'pullout_date':_0x3ca817,'actualdelivery_date':_0x4f734a,'typeOfProducts':_0x112441(0x114)}),_0x472d2e=await _0x10d72b[_0x112441(0xc2)](),_0x772993=await sales_finished['findOne']({'invoice':_0x530eca});_0x2e45d3[_0x112441(0x112)](_0x112441(0x192),_0x112441(0x1c2)),_0x3e0f63['redirect'](_0x112441(0x1b0)+_0x472d2e[_0x112441(0x9f)]);}catch(_0x155441){console[_0x112441(0x135)](_0x155441);}}),router['get'](a0_0x4505f7(0x18e),auth,async(_0x3310f0,_0x1b3c30)=>{var _0x1afe43=a0_0x4505f7;try{const {username:_0x3e65b8,email:_0x30f55e,role:_0xb3e48c}=_0x3310f0[_0x1afe43(0xb3)],_0x5c040a=_0x3310f0['user'],_0x43c1de=await profile[_0x1afe43(0x7b)]({'email':_0x5c040a[_0x1afe43(0x171)]}),_0x443538=await master_shop['find'](),_0x330262=_0x3310f0['params']['id'],_0x313932=await sales_finished[_0x1afe43(0xfb)](_0x330262),_0x590e81=await warehouse['aggregate']([{'$match':{'name':_0x313932[_0x1afe43(0x19d)]}},{'$unwind':_0x1afe43(0x16f)},{'$group':{'_id':_0x1afe43(0x15a),'name':{'$first':_0x1afe43(0xd0)},'product_stock':{'$first':_0x1afe43(0x1b5)},'bay':{'$first':_0x1afe43(0xa4)},'bin':{'$first':_0x1afe43(0x9a)},'type':{'$first':_0x1afe43(0x181)},'floorlevel':{'$first':_0x1afe43(0x143)},'primary_code':{'$first':_0x1afe43(0x126)},'secondary_code':{'$first':_0x1afe43(0x12b)},'product_code':{'$first':_0x1afe43(0xd6)},'storage':{'$first':_0x1afe43(0xf2)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1afe43(0xe0)},'production_date':{'$first':_0x1afe43(0x193)},'batch_code':{'$first':_0x1afe43(0xb9)},'room':{'$first':_0x1afe43(0x83)},'room_data':{'$first':_0x1afe43(0x7e)}}}]),_0x511bd4=await customer[_0x1afe43(0xf9)]({});let _0x3a7fc5;if(_0x5c040a[_0x1afe43(0x81)]==_0x1afe43(0x1c0)){const _0x2b93f0=await staff[_0x1afe43(0x7b)]({'email':_0x5c040a[_0x1afe43(0x171)]});_0x3a7fc5=await warehouse[_0x1afe43(0x85)]([{'$match':{'status':_0x1afe43(0x15d),'name':_0x2b93f0['warehouse']}},{'$group':{'_id':_0x1afe43(0x94),'name':{'$first':_0x1afe43(0x94)}}}]);}else _0x3a7fc5=await warehouse[_0x1afe43(0x85)]([{'$match':{'status':_0x1afe43(0x15d)}},{'$group':{'_id':_0x1afe43(0x94),'name':{'$first':_0x1afe43(0x94)}}}]);const _0x161205=await product[_0x1afe43(0xf9)]({});if(_0x443538[0x0][_0x1afe43(0x158)]==_0x1afe43(0x184)){var _0x3636e5=users['English'];console['log'](_0x3636e5);}else{if(_0x443538[0x0][_0x1afe43(0x158)]=='Hindi')var _0x3636e5=users[_0x1afe43(0xcf)];else{if(_0x443538[0x0][_0x1afe43(0x158)]==_0x1afe43(0xac))var _0x3636e5=users[_0x1afe43(0xac)];else{if(_0x443538[0x0][_0x1afe43(0x158)]==_0x1afe43(0xe1))var _0x3636e5=users[_0x1afe43(0xe1)];else{if(_0x443538[0x0]['language']==_0x1afe43(0x128))var _0x3636e5=users[_0x1afe43(0x128)];else{if(_0x443538[0x0][_0x1afe43(0x158)]==_0x1afe43(0x1a9))var _0x3636e5=users[_0x1afe43(0x127)];else{if(_0x443538[0x0][_0x1afe43(0x158)]==_0x1afe43(0x165))var _0x3636e5=users[_0x1afe43(0x165)];else{if(_0x443538[0x0][_0x1afe43(0x158)]==_0x1afe43(0x1a0))var _0x3636e5=users[_0x1afe43(0x198)];}}}}}}}_0x1b3c30[_0x1afe43(0x14d)]('edit_sales_finished_view',{'success':_0x3310f0[_0x1afe43(0x112)]('success'),'errors':_0x3310f0[_0x1afe43(0x112)](_0x1afe43(0x79)),'role':_0x5c040a,'profile':_0x43c1de,'customer':_0x511bd4,'warehouse':_0x3a7fc5,'product':_0x590e81,'user':_0x313932,'master_shop':_0x443538,'unit':_0x161205,'language':_0x3636e5});}catch(_0xd5a52f){console[_0x1afe43(0x135)](_0xd5a52f);}});async function dataUpdate(_0x36467a,_0x35a403,_0x45d769){var _0x1b9686=a0_0x4505f7;return await warehouse['updateOne']({'_id':_0x36467a,'product_details._id':_0x35a403},{'$set':{'product_details.$.product_stock':_0x45d769}}),await warehouse[_0x1b9686(0xfb)](_0x36467a);}function a0_0x990b(){var _0x1d76c7=['secondary_unit_QA','$sale_product','production_date','outgoing_invoice','<hr\x20class=\x22my-3\x22>','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','product_date','secondary_unit','Portuguese\x20(BR)','/barcode_scanner_auto','\x20Date:\x20','note','site_title','</div>','$product_details.invoice','/all_sales_finished/preview/','customer','$sale_product.quantity','json','received_amount','$product_details.product_stock','express','master','$customer','prod_cat','Sale\x20Return','/view/return_sales/:id','LOG-OUT-','level','max_per_unit','getMonth','staff','Sale\x20Return\x20Mail','Sales\x20Add\x20successfully','Enclosed','prod_code','errors','maxProducts_QA','findOne','back','$product_details.maxPerUnit','$product_details.room_name','add\x20post','out','role','push','$room','sales_id','aggregate','maxperunit','quantity','currency','return_sale_finished','$product_details.sales_category','add_sales_finished_logs','4469665esMgxg','OUTF-','$sales_category','</body></html>','product_stock','$product_details.uuid','$product_code','currency_placement','$name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','product_code_QA','Distributing\x20','6wlxxmf','return_sale','$product_details.bin','product_cat','True','$invoice','$sale_product.bin','_id','/picking_list/pdf/','</tbody>','getFullYear','concat','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','product_name','\x20<>\x20','$product_details.type_products','<div>','catch','$product_details.level','German','$_id','return_qty_QA','<span\x20style=\x22float:\x20right;\x22>','/view/add_sales','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','post','user','standard_unit','map','<tbody\x20style=\x22text-align:\x20center;\x22>','30NTKckd','return_qty','$product_details.batch_code','778419tZYPqc','product_code','false','</td>','$product_details.unit','stock','There\x20is\x20','1FWRjPo','save','Return\x20Rooms','warehouse_id_detl','gross_price','Sales\x20Update\x20successfully','Error\x20Occurs','adjust_qty','<tr>','/upload/','$product_details.date_recieved','amount','then','sales_category','Hindi','$product_details.product_name','sale_product','</span>','$secondary_code','room_name','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.product_code','product_name_QA1','maxProducts','Quality\x20Inspection','id_transaction_from','nodemailer','barcode\x20user_id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','padStart','stocks_QA','$product_details.expiry_date','Spanish','production_date_QA','product_details','return_sale_QA','getDate','<h5>','sales_quantity_QA','carton','warehouse','/view_log','Received\x20Payment\x20For\x20Sale','False','prod_invoice','$return_data','roomNamed','<h5\x20style=\x22text-align:\x20left;\x22>','../public/language/languages.json','$product_details.storage','message','body','RoomAssigned','unit','<html><head><title></title>','$finalize','find','Email\x20sent\x20successfully','findById','maxStocks','</tr>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','gmail','secondary_code','Logo.png','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','Finished\x20Goods','stock_data','undefined','redirect','date_recieved','English','suppliers','floor','</thead>','/view/add_sale/product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','date_data','$unit','valueOf','OUT-','flash','params','own','6609141oIaTsb','$warehouse_name','sales\x20item\x20return\x20successfull','customer_data','expiry_date','</head><body>','ObjectId','mongoose','all_sales_barcode','sales','get','<!DOCTYPE\x20html>','$customers_docs','invoice_init','maxPerUnit_QA','warehouse_id','<strong>\x20Regards\x20</strong>','$product_details.primary_code','Portuguese','French','$sale_product.type','product_data','$product_details.secondary_code','$alertquantity','968514gcXBGE','$product.product_name','$product_details.secondary_unit','agent_id','$sale_product.bay','primary_unit','abs','string','log','maxPerUnit','level2','5744943kvQpRp','$product_details.product_cat','unit_QA','$product_details.gross_price','Ambient','max','filter','Router','$product_details.rack','/view/add_sales/:id','all','$product_details.floorlevel','product_id','edit_sales_finished','invoice','$maxStocks','data_type','sales_quantity','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$maxProdPerUnit','sales_invoice','render','primary_code_QA','$secondary_unit','/view/add_sales_logs','/all_sales/view','Return\x20Goods','5604688AUHbGf','secondary_code_QA','image','<h2>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','language','updateOne','$product_details._id','\x20==\x20','/all_sales_finished/view','Enabled','date_received','second_unit','split','expiry_date_QA','</table>','$gross_price','\x20Order\x20Date\x20:\x20','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','all_sales_finished_logs','primary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','../models/all_models','/../public','here','random','batch_code','$product_details',',\x20Location:\x20','email','createTransport','group_ids','finalize','$note','room','toString','maxProdPerUnit','slice','/view/:id','$category','/view','$product_details.maxProducts','outgoiug_inv','bay','for_categorize','$product_details.type','due_amount','true','English\x20(US)','logo','4070548NAGAvm','sale_qty','sendMail','status','</h5>','forEach','logs','\x20</h2>','/preview/:id','$sale_product.floorlevel','product_list','foreach\x20newproduct','success','$product_details.production_date','batch_code_QA','return_data','date','uuid','Arabic','name','$date','final','$brand','warehouse_name','length','match','Arabic\x20(ae)'];a0_0x990b=function(){return _0x1d76c7;};return a0_0x990b();}router[a0_0x4505f7(0xb2)]('/preview/:id',auth,async(_0x103e80,_0x5d1791)=>{var _0x295f7a=a0_0x4505f7;try{const _0x576740=_0x103e80[_0x295f7a(0x113)]['id'],{invoice:_0x5ea458,warehouse_name:_0x3581fe,room:_0x13748d}=_0x103e80[_0x295f7a(0xf4)],_0x376972=await sales_finished[_0x295f7a(0x7b)]({'invoice':_0x5ea458});for(let _0x2fb59f=0x0;_0x2fb59f<=_0x376972[_0x295f7a(0xd1)][_0x295f7a(0x19e)]-0x1;_0x2fb59f++){const _0x1b7115=_0x376972['sale_product'][_0x2fb59f];var _0x5caebe=await warehouse['findOne']({'name':_0x3581fe,'room':_0x1b7115[_0x295f7a(0xd4)]}),_0x1f3043=0x0;for(let _0x2e23d2=0x0;_0x2e23d2<=_0x5caebe[_0x295f7a(0xe3)][_0x295f7a(0x19e)]-0x1;_0x2e23d2++){const _0x162372=_0x5caebe[_0x295f7a(0xe3)][_0x2e23d2];_0x162372[_0x295f7a(0x9f)]==_0x1b7115[_0x295f7a(0xda)]&&_0x162372[_0x295f7a(0x197)]==_0x1b7115['uuid']&&(_0x1f3043=Math[_0x295f7a(0x13d)](0x0,Math[_0x295f7a(0x133)](_0x162372['product_stock'])-Math[_0x295f7a(0x133)](_0x1b7115['quantity'])),await warehouse[_0x295f7a(0x159)]({'_id':_0x5caebe[_0x295f7a(0x9f)][_0x295f7a(0x110)](),'product_details._id':_0x162372[_0x295f7a(0x9f)][_0x295f7a(0x110)](),'product_details.uuid':_0x1b7115['uuid']},{'$set':{'product_details.$.product_stock':_0x1f3043}}));}console[_0x295f7a(0x135)](typeof _0x1b7115[_0x295f7a(0x130)]);if(typeof _0x1b7115[_0x295f7a(0x130)]!==_0x295f7a(0x105)){var _0x33fbd8=await staff['findById'](_0x1b7115[_0x295f7a(0x130)]);console[_0x295f7a(0x135)](_0x295f7a(0x16c));var _0x289434=0x0;for(let _0x2b6eaa=0x0;_0x2b6eaa<=_0x33fbd8[_0x295f7a(0x190)]['length']-0x1;_0x2b6eaa++){const _0x505df1=_0x33fbd8[_0x295f7a(0x190)][_0x2b6eaa];console[_0x295f7a(0x135)](_0x1b7115[_0x295f7a(0xda)]+_0x295f7a(0x15b)+_0x505df1[_0x295f7a(0x124)]+'\x20&&\x20'+_0x1b7115[_0x295f7a(0x9f)]+_0x295f7a(0x15b)+_0x1b7115[_0x295f7a(0x9f)]),_0x1b7115[_0x295f7a(0xda)]==_0x505df1[_0x295f7a(0x124)]&&_0x1b7115[_0x295f7a(0x9f)]==0x1&&(_0x505df1[_0x295f7a(0x90)]=Math[_0x295f7a(0x133)](_0x505df1[_0x295f7a(0x90)])+Math[_0x295f7a(0x133)](_0x1b7115[_0x295f7a(0x87)]),_0x289434++);}console[_0x295f7a(0x135)]('int',_0x289434),_0x289434=='0'&&(_0x33fbd8[_0x295f7a(0x190)]=_0x33fbd8[_0x295f7a(0x190)][_0x295f7a(0xa3)]({'product_name':_0x1b7115[_0x295f7a(0xa6)],'product_stock':_0x1b7115[_0x295f7a(0x87)],'bay':_0x1b7115[_0x295f7a(0x17f)],'level':_0x1b7115[_0x295f7a(0x1bd)],'product_code':_0x1b7115['product_code'],'primary_code':_0x1b7115[_0x295f7a(0x168)],'secondary_code':_0x1b7115['secondary_code'],'expiry_date':_0x1b7115[_0x295f7a(0x119)],'production_date':_0x1b7115[_0x295f7a(0x1a3)],'maxProducts':_0x1b7115[_0x295f7a(0xd8)],'batch_code':_0x1b7115['batch_code'],'secondary_unit':_0x1b7115['secondary_unit'],'unit':_0x1b7115[_0x295f7a(0xf6)],'maxProducts':_0x1b7115[_0x295f7a(0xd8)],'maxPerUnit':_0x1b7115['maxperunit'],'invoice':_0x1b7115[_0x295f7a(0x146)],'warehouse_id':_0x1b7115[_0x295f7a(0xda)],'id_incoming':_0x1b7115['_id'],'uuid':_0x1b7115['uuid'],'gross_price':_0x1b7115['gross_price'],'date_incoming':_0x1b7115['date_data'],'outgoing_invoice':_0x1b7115[_0x295f7a(0x1a4)]}),await _0x33fbd8[_0x295f7a(0xc2)]());}}_0x376972[_0x295f7a(0x174)]=_0x295f7a(0x9c);const _0x5f4b5e=await _0x376972[_0x295f7a(0xc2)](),_0x1ae9a5=await master_shop['find'](),_0x235cef=await email_settings['findOne'](),_0x5232d6=await supervisor_settings['find']();var _0x3cd52e=_0x376972['sale_product'],_0x10dbde='',_0x581398;for(_0x581398 in _0x3cd52e){_0x10dbde+=_0x295f7a(0xc9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3cd52e[_0x581398]['product_name']+'</td>'+_0x295f7a(0x169)+_0x3cd52e[_0x581398][_0x295f7a(0xbb)]+_0x295f7a(0xbd)+_0x295f7a(0x169)+_0x3cd52e[_0x581398][_0x295f7a(0x87)]+_0x295f7a(0xbd)+_0x295f7a(0x169)+_0x3cd52e[_0x581398][_0x295f7a(0xf6)]+_0x295f7a(0xbd)+_0x295f7a(0x169)+_0x3cd52e[_0x581398][_0x295f7a(0x1a8)]+'</td>'+_0x295f7a(0x169)+_0x376972['warehouse_name']+_0x295f7a(0xbd)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3cd52e[_0x581398]['room_name']+_0x295f7a(0xbd)+_0x295f7a(0x169)+_0x3cd52e[_0x581398]['bay']+_0x295f7a(0xbd);}_0x103e80['flash'](_0x295f7a(0x192),_0x295f7a(0xc6)),_0x5d1791[_0x295f7a(0x106)](_0x295f7a(0xa0)+_0x576740);}catch(_0x25d874){console[_0x295f7a(0x135)](_0x25d874);}}),router[a0_0x4505f7(0x11f)](a0_0x4505f7(0x17a),auth,async(_0x5d08ca,_0x4b4b9c)=>{var _0x596af4=a0_0x4505f7;try{const {username:_0x5c2c06,email:_0x5da7a3,role:_0x2fcc19}=_0x5d08ca[_0x596af4(0xb3)],_0xf9f9a7=_0x5d08ca[_0x596af4(0xb3)],_0x5c5a11=await profile['findOne']({'email':_0xf9f9a7[_0x596af4(0x171)]}),_0x441b7a=await master_shop[_0x596af4(0xf9)](),_0x2bdb67=_0x5d08ca['params']['id'],_0x30da74=await sales_finished[_0x596af4(0xfb)](_0x2bdb67);let _0x525f2f=new Date(_0x30da74[_0x596af4(0x119)]),_0x75131d=('0'+_0x525f2f[_0x596af4(0xe5)]())[_0x596af4(0x179)](-0x2),_0x5bd209=('0'+(_0x525f2f[_0x596af4(0x1bf)]()+0x1))['slice'](-0x2),_0x1b2af3=_0x525f2f[_0x596af4(0xa2)](),_0x53e6e1=_0x1b2af3+'-'+_0x5bd209+'-'+_0x75131d;var _0xbdfca6=['Ambient',_0x596af4(0x1c3)];const _0x44854d=await warehouse[_0x596af4(0x85)]([{'$match':{'name':_0x30da74[_0x596af4(0x19d)],'room':_0x30da74[_0x596af4(0x176)]}},{'$unwind':_0x596af4(0x16f)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x596af4(0x1b5)},'bay':{'$first':_0x596af4(0xa4)},'bin':{'$first':_0x596af4(0x9a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x596af4(0x126)},'secondary_code':{'$first':_0x596af4(0x12b)},'product_code':{'$first':_0x596af4(0xd6)},'storage':{'$first':_0x596af4(0xf2)},'rack':{'$first':_0x596af4(0x140)}}}]),_0x3cd245=await customer[_0x596af4(0xf9)]({});let _0x32601f;if(_0xf9f9a7[_0x596af4(0x81)]=='staff'){const _0x1cccb5=await staff['findOne']({'email':_0xf9f9a7[_0x596af4(0x171)]});_0x32601f=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x1cccb5[_0x596af4(0xe9)]}},{'$group':{'_id':_0x596af4(0x94),'name':{'$first':_0x596af4(0x94)}}}]);}else _0x32601f=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x596af4(0x94),'name':{'$first':'$name'}}}]);const _0x15e11c=await product[_0x596af4(0xf9)]({});if(_0x441b7a[0x0][_0x596af4(0x158)]==_0x596af4(0x184)){var _0x158e5d=users[_0x596af4(0x108)];console[_0x596af4(0x135)](_0x158e5d);}else{if(_0x441b7a[0x0][_0x596af4(0x158)]=='Hindi')var _0x158e5d=users[_0x596af4(0xcf)];else{if(_0x441b7a[0x0][_0x596af4(0x158)]==_0x596af4(0xac))var _0x158e5d=users['German'];else{if(_0x441b7a[0x0][_0x596af4(0x158)]==_0x596af4(0xe1))var _0x158e5d=users['Spanish'];else{if(_0x441b7a[0x0][_0x596af4(0x158)]==_0x596af4(0x128))var _0x158e5d=users['French'];else{if(_0x441b7a[0x0][_0x596af4(0x158)]=='Portuguese\x20(BR)')var _0x158e5d=users['Portuguese'];else{if(_0x441b7a[0x0]['language']=='Chinese')var _0x158e5d=users[_0x596af4(0x165)];else{if(_0x441b7a[0x0]['language']==_0x596af4(0x1a0))var _0x158e5d=users[_0x596af4(0x198)];}}}}}}}_0x4b4b9c[_0x596af4(0x14d)](_0x596af4(0x145),{'success':_0x5d08ca['flash'](_0x596af4(0x192)),'errors':_0x5d08ca['flash'](_0x596af4(0x79)),'role':_0xf9f9a7,'profile':_0x5c5a11,'customer':_0x3cd245,'warehouse':_0x32601f,'product':_0x44854d,'user':_0x30da74,'master_shop':_0x441b7a,'unit':_0x15e11c,'language':_0x158e5d,'rooms_data':_0xbdfca6,'ed_fullDate':_0x53e6e1});}catch(_0x150ce2){console[_0x596af4(0x135)](_0x150ce2);}}),router[a0_0x4505f7(0xb2)](a0_0x4505f7(0x17a),auth,async(_0x370235,_0x1ab241)=>{var _0x2ef448=a0_0x4505f7;try{const _0x5b23e7=_0x370235[_0x2ef448(0x113)]['id'],_0x57ff3c=await sales_finished['findOne']({'_id':_0x370235[_0x2ef448(0x113)]['id']}),_0x381039=await warehouse['findOne']({'name':_0x57ff3c[_0x2ef448(0x19d)],'room':_0x370235[_0x2ef448(0xf4)][_0x2ef448(0x176)],'warehouse_category':_0x2ef448(0x103)}),{invoice:_0x141bf2,customer:_0x5405bd,date:_0x47ceb3,warehouse_name:_0xb4c8c1,product_name:_0x23cbd1,stock:_0xaa0912,adjust_qty:_0x2dd4f6,note:_0x1bcc28,room:_0x4fa2f9,primary_code:_0x1a21f4,secondary_code:_0x5de957,prod_code:_0x130df4,level:_0x547adb,isle:_0x3a2353,pallet:_0x1d0b7f,expiry_date:_0x484bb8}=_0x370235[_0x2ef448(0xf4)];if(typeof _0x23cbd1==_0x2ef448(0x134))var _0x5709f8=[_0x370235[_0x2ef448(0xf4)][_0x2ef448(0xa6)]],_0x3c563c=[_0x370235['body'][_0x2ef448(0xbf)]],_0x10b5c2=[_0x370235[_0x2ef448(0xf4)][_0x2ef448(0xc8)]],_0x10d5a2=[_0x370235[_0x2ef448(0xf4)][_0x2ef448(0x168)]],_0x302564=[_0x370235[_0x2ef448(0xf4)][_0x2ef448(0x100)]],_0x274fa0=[_0x370235['body']['prod_code']],_0x155ae9=[_0x370235[_0x2ef448(0xf4)][_0x2ef448(0x1bd)]],_0x4ea516=[_0x370235[_0x2ef448(0xf4)]['expiry_date']];else var _0x5709f8=[..._0x370235[_0x2ef448(0xf4)][_0x2ef448(0xa6)]],_0x3c563c=[..._0x370235[_0x2ef448(0xf4)][_0x2ef448(0xbf)]],_0x10b5c2=[..._0x370235['body'][_0x2ef448(0xc8)]],_0x10d5a2=[..._0x370235[_0x2ef448(0xf4)][_0x2ef448(0x168)]],_0x302564=[..._0x370235[_0x2ef448(0xf4)][_0x2ef448(0x100)]],_0x274fa0=[..._0x370235[_0x2ef448(0xf4)]['prod_code']],_0x155ae9=[..._0x370235[_0x2ef448(0xf4)]['level']],_0x4ea516=[..._0x370235['body'][_0x2ef448(0x119)]];const _0x49f7f7=_0x5709f8['map'](_0x409b73=>{return _0x409b73={'product_name':_0x409b73};});_0x3c563c['forEach']((_0x1fae2a,_0x1b6fa2)=>{var _0x6a07a7=_0x2ef448;_0x49f7f7[_0x1b6fa2][_0x6a07a7(0xbf)]=_0x1fae2a;}),_0x10b5c2[_0x2ef448(0x18b)]((_0x2952d6,_0x40fbb4)=>{var _0xc223ca=_0x2ef448;_0x49f7f7[_0x40fbb4][_0xc223ca(0x87)]=_0x2952d6;}),_0x10d5a2[_0x2ef448(0x18b)]((_0x19d23a,_0x53941b)=>{var _0x708fae=_0x2ef448;_0x49f7f7[_0x53941b][_0x708fae(0x168)]=_0x19d23a;}),_0x302564['forEach']((_0x1f5d18,_0x557637)=>{var _0x2eef5b=_0x2ef448;_0x49f7f7[_0x557637][_0x2eef5b(0x100)]=_0x1f5d18;}),_0x274fa0['forEach']((_0x21246d,_0x3169b8)=>{var _0xa8187e=_0x2ef448;_0x49f7f7[_0x3169b8][_0xa8187e(0xbb)]=_0x21246d;}),_0x155ae9[_0x2ef448(0x18b)]((_0x1285c9,_0x3f9270)=>{var _0x42a4ca=_0x2ef448;_0x49f7f7[_0x3f9270][_0x42a4ca(0x1bd)]=_0x1285c9;}),_0x4ea516[_0x2ef448(0x18b)]((_0x5d130c,_0x45fd93)=>{_0x49f7f7[_0x45fd93]['expiry_date']=_0x5d130c;});var _0x377c1d=0x0;_0x49f7f7[_0x2ef448(0x18b)](_0x429783=>{var _0x3ad4d1=_0x2ef448;console[_0x3ad4d1(0x135)](_0x3ad4d1(0x191),_0x429783),(parseInt(_0x429783[_0x3ad4d1(0xbf)])<parseInt(_0x429783[_0x3ad4d1(0x87)])||parseInt(_0x429783[_0x3ad4d1(0x87)])==0x0)&&_0x377c1d++;});if(_0x377c1d!=0x0)return _0x370235['flash'](_0x2ef448(0x79),_0x2ef448(0xd5)),_0x1ab241[_0x2ef448(0x106)]('back');_0x57ff3c[_0x2ef448(0xd1)][_0x2ef448(0x18b)](_0x4ff06f=>{var _0x1f8685=_0x2ef448;const _0xb7d223=_0x381039[_0x1f8685(0xe3)][_0x1f8685(0xb5)](_0x2e84c2=>{var _0x4c62d0=_0x1f8685;_0x2e84c2[_0x4c62d0(0xa6)]==_0x4ff06f[_0x4c62d0(0xa6)]&&_0x2e84c2['bay']==_0x4ff06f[_0x4c62d0(0x17f)]&&(_0x2e84c2[_0x4c62d0(0x90)]=parseInt(_0x2e84c2[_0x4c62d0(0x90)])+parseInt(_0x4ff06f['quantity']));});}),await _0x381039[_0x2ef448(0xc2)]();const _0x345d4=_0x49f7f7[_0x2ef448(0x13e)](_0x57560a=>_0x57560a['quantity']!=='0'&&_0x57560a[_0x2ef448(0x87)]!=='');_0x57ff3c[_0x2ef448(0x146)]=_0x141bf2,_0x57ff3c[_0x2ef448(0x1b1)]=_0x5405bd,_0x57ff3c[_0x2ef448(0x196)]=_0x47ceb3,_0x57ff3c[_0x2ef448(0x19d)]=_0xb4c8c1,_0x57ff3c[_0x2ef448(0xd1)]=_0x345d4,_0x57ff3c[_0x2ef448(0x1ac)]=_0x1bcc28,_0x57ff3c['room']=_0x4fa2f9;const _0x4c3ac4=await _0x57ff3c[_0x2ef448(0xc2)](),_0x55a04f=await sales_finished[_0x2ef448(0x7b)]({'_id':_0x370235['params']['id']}),_0x1d8089=await warehouse['findOne']({'name':_0xb4c8c1,'room':_0x4fa2f9,'warehouse_category':_0x2ef448(0x103)});_0x55a04f[_0x2ef448(0xd1)][_0x2ef448(0x18b)](_0x3f74f0=>{var _0x3070c2=_0x2ef448;const _0x32b5a2=_0x1d8089[_0x3070c2(0xe3)][_0x3070c2(0xb5)](_0x26fddb=>{var _0x288f7d=_0x3070c2;_0x26fddb[_0x288f7d(0xa6)]==_0x3f74f0[_0x288f7d(0xa6)]&&_0x26fddb['bay']==_0x3f74f0['bay']&&(_0x26fddb['product_stock']=parseInt(_0x26fddb[_0x288f7d(0x90)])-parseInt(_0x3f74f0[_0x288f7d(0x87)]));});}),console['log'](_0x2ef448(0x19b),_0x1d8089),await _0x1d8089[_0x2ef448(0xc2)]();const _0x2dccb4=await c_payment_data['findOne']({'invoice':_0x370235[_0x2ef448(0xf4)]['invoice']});_0x2dccb4[_0x2ef448(0x109)]=_0x370235[_0x2ef448(0xf4)][_0x2ef448(0x109)],await _0x2dccb4[_0x2ef448(0xc2)](),_0x370235[_0x2ef448(0x112)](_0x2ef448(0x192),_0x2ef448(0xc6)),_0x1ab241[_0x2ef448(0x106)](_0x2ef448(0x15c));}catch(_0x352cea){console['log'](_0x352cea);}}),router['post']('/give_payment/:id',auth,async(_0x2e2354,_0x391c17)=>{var _0x22bd6e=a0_0x4505f7;try{const _0x1ce9d2=_0x2e2354[_0x22bd6e(0x113)]['id'],{invoice:_0x1e1e89,customer:_0x2d8fb5,receivable_amount:_0x36aef3,received_amount:_0x3a3fad}=_0x2e2354[_0x22bd6e(0xf4)],_0x4e3dfa=await sales['findById'](_0x1ce9d2);console[_0x22bd6e(0x135)](_0x4e3dfa);var _0x1504c3=_0x36aef3-_0x3a3fad;console['log'](_0x3a3fad),_0x4e3dfa[_0x22bd6e(0x1b4)]=parseFloat(_0x3a3fad)+parseFloat(_0x4e3dfa[_0x22bd6e(0x1b4)]),_0x4e3dfa[_0x22bd6e(0x182)]=_0x1504c3,console[_0x22bd6e(0x135)](_0x4e3dfa);const _0x30b81c=await _0x4e3dfa['save'](),_0x2e0f4a=await c_payment_data[_0x22bd6e(0x7b)]({'invoice':_0x1e1e89});_0x2e0f4a[_0x22bd6e(0xcc)]=_0x1504c3,await _0x2e0f4a[_0x22bd6e(0xc2)]();let _0x5c7316=new Date(),_0x178820=('0'+_0x5c7316[_0x22bd6e(0xe5)]())['slice'](-0x2),_0x12e132=('0'+(_0x5c7316[_0x22bd6e(0x1bf)]()+0x1))[_0x22bd6e(0x179)](-0x2),_0x3b3a60=_0x5c7316[_0x22bd6e(0xa2)](),_0x3410c2=_0x3b3a60+'-'+_0x12e132+'-'+_0x178820;const _0xf9c38c=new customer_payment({'invoice':_0x1e1e89,'date':_0x3b3a60+'-'+_0x12e132+'-'+_0x178820,'customer':_0x2d8fb5,'reason':_0x22bd6e(0xeb),'amount':_0x3a3fad}),_0x189d3a=await _0xf9c38c[_0x22bd6e(0xc2)]();_0x2e2354['flash']('success','payment\x20successfull'),_0x391c17['redirect'](_0x22bd6e(0x151));}catch(_0x1341fc){console[_0x22bd6e(0x135)](_0x1341fc);}}),router[a0_0x4505f7(0x11f)]('/invoice/:id',auth,async(_0x3a692e,_0x47f648)=>{var _0x36bce4=a0_0x4505f7;try{const {username:_0x4f48b3,email:_0x4959c4,role:_0x8067f}=_0x3a692e[_0x36bce4(0xb3)],_0x5dfdca=_0x3a692e['user'],_0x84c2e3=await profile[_0x36bce4(0x7b)]({'email':_0x5dfdca[_0x36bce4(0x171)]}),_0x53e6ae=await master_shop['find']();console[_0x36bce4(0x135)](_0x36bce4(0x1b7),_0x53e6ae);const _0x595bd4=_0x3a692e[_0x36bce4(0x113)]['id'],_0x46d157=await sales[_0x36bce4(0xfb)](_0x595bd4);console[_0x36bce4(0x135)](_0x46d157);const _0x4ece20=await customer[_0x36bce4(0x7b)]({'name':_0x46d157[_0x36bce4(0x1b1)]});console[_0x36bce4(0x135)](_0x4ece20);if(_0x53e6ae[0x0]['language']=='English\x20(US)'){var _0x2b6dd5=users[_0x36bce4(0x108)];console[_0x36bce4(0x135)](_0x2b6dd5);}else{if(_0x53e6ae[0x0]['language']==_0x36bce4(0xcf))var _0x2b6dd5=users[_0x36bce4(0xcf)];else{if(_0x53e6ae[0x0][_0x36bce4(0x158)]==_0x36bce4(0xac))var _0x2b6dd5=users[_0x36bce4(0xac)];else{if(_0x53e6ae[0x0][_0x36bce4(0x158)]==_0x36bce4(0xe1))var _0x2b6dd5=users['Spanish'];else{if(_0x53e6ae[0x0]['language']==_0x36bce4(0x128))var _0x2b6dd5=users['French'];else{if(_0x53e6ae[0x0][_0x36bce4(0x158)]==_0x36bce4(0x1a9))var _0x2b6dd5=users['Portuguese'];else{if(_0x53e6ae[0x0][_0x36bce4(0x158)]=='Chinese')var _0x2b6dd5=users[_0x36bce4(0x165)];else{if(_0x53e6ae[0x0][_0x36bce4(0x158)]==_0x36bce4(0x1a0))var _0x2b6dd5=users[_0x36bce4(0x198)];}}}}}}}_0x47f648['render'](_0x36bce4(0x14c),{'success':_0x3a692e[_0x36bce4(0x112)](_0x36bce4(0x192)),'errors':_0x3a692e[_0x36bce4(0x112)](_0x36bce4(0x79)),'role':_0x5dfdca,'profile':_0x84c2e3,'master_shop':_0x53e6ae,'customers':_0x4ece20,'sales':_0x46d157,'language':_0x2b6dd5});}catch(_0x943a4b){console[_0x36bce4(0x135)](_0x943a4b);}}),router['get'](a0_0x4505f7(0x1bb),auth,async(_0xbeb0e5,_0x220bd4)=>{var _0x8c479d=a0_0x4505f7;try{const {username:_0x44aeb6,email:_0x14ebac,role:_0x24008e}=_0xbeb0e5[_0x8c479d(0xb3)],_0x398ae8=_0xbeb0e5[_0x8c479d(0xb3)],_0x2bbb1d=await profile[_0x8c479d(0x7b)]({'email':_0x398ae8['email']}),_0x5e627e=await master_shop[_0x8c479d(0xf9)](),_0x49e384=_0xbeb0e5[_0x8c479d(0x113)]['id'],_0x5c9eae=await sales_finished['findById'](_0x49e384),_0x3fb6e0=await warehouse[_0x8c479d(0x85)]([{'$match':{'name':_0x5c9eae[_0x8c479d(0x19d)]}},{'$unwind':_0x8c479d(0x16f)},{'$group':{'_id':_0x8c479d(0x15a),'name':{'$first':_0x8c479d(0xd0)},'product_stock':{'$first':_0x8c479d(0x1b5)},'bay':{'$first':_0x8c479d(0xa4)},'bin':{'$first':_0x8c479d(0x9a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x8c479d(0x143)},'primary_code':{'$first':_0x8c479d(0x126)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x8c479d(0xd6)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x8c479d(0x140)},'expiry_date':{'$first':_0x8c479d(0xe0)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':_0x8c479d(0xbe)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x8c479d(0x17d)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x155946=await product[_0x8c479d(0xf9)]({}),_0x513343=await warehouse['aggregate']([{'$match':{'status':_0x8c479d(0x15d),'warehouse_category':_0x8c479d(0x103),'name':{'$ne':_0x8c479d(0x152),'$ne':_0x8c479d(0xd9)}}},{'$group':{'_id':_0x8c479d(0x94),'name':{'$first':_0x8c479d(0x94)}}},{'$sort':{'name':0x1}}]);var _0x567f4b=[_0x8c479d(0xc3)];const _0x104218=await warehouse[_0x8c479d(0x85)]([{'$match':{'status':'Enabled','name':_0x8c479d(0xd9)}},{'$group':{'_id':_0x8c479d(0x94),'name':{'$first':_0x8c479d(0x94)}}},{'$sort':{'name':0x1}}]);if(_0x5e627e[0x0][_0x8c479d(0x158)]==_0x8c479d(0x184)){var _0x4c0ed5=users['English'];console[_0x8c479d(0x135)](_0x4c0ed5);}else{if(_0x5e627e[0x0][_0x8c479d(0x158)]==_0x8c479d(0xcf))var _0x4c0ed5=users['Hindi'];else{if(_0x5e627e[0x0][_0x8c479d(0x158)]==_0x8c479d(0xac))var _0x4c0ed5=users[_0x8c479d(0xac)];else{if(_0x5e627e[0x0][_0x8c479d(0x158)]==_0x8c479d(0xe1))var _0x4c0ed5=users[_0x8c479d(0xe1)];else{if(_0x5e627e[0x0]['language']==_0x8c479d(0x128))var _0x4c0ed5=users[_0x8c479d(0x128)];else{if(_0x5e627e[0x0][_0x8c479d(0x158)]==_0x8c479d(0x1a9))var _0x4c0ed5=users[_0x8c479d(0x127)];else{if(_0x5e627e[0x0][_0x8c479d(0x158)]==_0x8c479d(0x165))var _0x4c0ed5=users[_0x8c479d(0x165)];else{if(_0x5e627e[0x0][_0x8c479d(0x158)]==_0x8c479d(0x1a0))var _0x4c0ed5=users[_0x8c479d(0x198)];}}}}}}}_0x220bd4[_0x8c479d(0x14d)](_0x8c479d(0x89),{'success':_0xbeb0e5['flash'](_0x8c479d(0x192)),'errors':_0xbeb0e5['flash'](_0x8c479d(0x79)),'role':_0x398ae8,'profile':_0x2bbb1d,'user':_0x5c9eae,'stock':_0x3fb6e0,'master_shop':_0x5e627e,'unit':_0x155946,'language':_0x4c0ed5,'warehouses':_0x513343,'rooms':_0x567f4b,'warehouse_QA':_0x104218});}catch(_0x31b672){console[_0x8c479d(0x135)](_0x31b672),_0x220bd4[_0x8c479d(0x189)](0xc8)[_0x8c479d(0x1b3)]({'message':_0x31b672[_0x8c479d(0xf3)]});}}),router[a0_0x4505f7(0xb2)](a0_0x4505f7(0x1bb),auth,async(_0x4c37da,_0x348534)=>{var _0x2dceac=a0_0x4505f7;if(_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x180)]=='QA')try{const {invoice:_0x44d6a2,date:_0x4a7ed8,warehouse_name:_0x336685,product_name:_0x326083,primary_code:_0x7bf3fe,secondary_code:_0x5bc528,product_code:_0x3e4704,sales_quantity:_0x58ae19,stocks:_0x5a9b71,return_qty:_0x556bb4,Room_name:_0x49d38c,to_warehouse_name_QA:_0x17c710,to_Room_name_QA:_0x545aaa,note:_0x4310f7,for_categorize:_0x2ab03f,product_name_QA1:_0x3ae6e5}=_0x4c37da[_0x2dceac(0xf4)];if(typeof _0x3ae6e5==_0x2dceac(0x134))var _0x52e183=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xd7)]],_0x39d602=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x14e)]],_0x5854a7=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x154)]],_0x3e9e85=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x96)]],_0x521d86=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xe7)]],_0x1b63ad=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xdf)]],_0xb9128d=[_0x4c37da['body'][_0x2dceac(0xae)]],_0x353f4c=[_0x4c37da['body'][_0x2dceac(0x123)]],_0x273587=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x7a)]],_0x39aa65=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x194)]],_0x49d4bd=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x1a1)]],_0x1e0cd6=[_0x4c37da['body']['unit_QA']],_0x28367e=[_0x4c37da[_0x2dceac(0xf4)]['production_date_QA']],_0x2f30b9=[_0x4c37da['body'][_0x2dceac(0x161)]];else var _0x52e183=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xd7)]],_0x39d602=[..._0x4c37da['body'][_0x2dceac(0x14e)]],_0x5854a7=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x154)]],_0x3e9e85=[..._0x4c37da['body']['product_code_QA']],_0x521d86=[..._0x4c37da['body'][_0x2dceac(0xe7)]],_0x1b63ad=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xdf)]],_0xb9128d=[..._0x4c37da['body'][_0x2dceac(0xae)]],_0x353f4c=[..._0x4c37da[_0x2dceac(0xf4)]['maxPerUnit_QA']],_0x273587=[..._0x4c37da['body'][_0x2dceac(0x7a)]],_0x39aa65=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x194)]],_0x49d4bd=[..._0x4c37da['body'][_0x2dceac(0x1a1)]],_0x1e0cd6=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x13a)]],_0x28367e=[..._0x4c37da['body'][_0x2dceac(0xe2)]],_0x2f30b9=[..._0x4c37da['body'][_0x2dceac(0x161)]];const _0x5659d1=_0x52e183[_0x2dceac(0xb5)](_0x2fe710=>{return _0x2fe710={'product_name':_0x2fe710};});_0x39d602[_0x2dceac(0x18b)]((_0x41c82d,_0x30c5e8)=>{var _0x57c33d=_0x2dceac;_0x5659d1[_0x30c5e8][_0x57c33d(0x168)]=_0x41c82d;}),_0x5854a7[_0x2dceac(0x18b)]((_0x5dcf81,_0x62867b)=>{var _0x56ae33=_0x2dceac;_0x5659d1[_0x62867b][_0x56ae33(0x100)]=_0x5dcf81;}),_0x3e9e85['forEach']((_0x35150b,_0x3956ff)=>{var _0x47abfc=_0x2dceac;_0x5659d1[_0x3956ff][_0x47abfc(0xbb)]=_0x35150b;}),_0x521d86[_0x2dceac(0x18b)]((_0x191aed,_0x3d8b92)=>{var _0x5b9bb8=_0x2dceac;_0x5659d1[_0x3d8b92][_0x5b9bb8(0x187)]=_0x191aed;}),_0x1b63ad[_0x2dceac(0x18b)]((_0x386975,_0x2bd958)=>{_0x5659d1[_0x2bd958]['stock']=_0x386975;}),_0xb9128d['forEach']((_0x1f6e99,_0x5150a8)=>{var _0x249006=_0x2dceac;_0x5659d1[_0x5150a8][_0x249006(0xb8)]=_0x1f6e99;}),_0x353f4c[_0x2dceac(0x18b)]((_0x136ef3,_0x47fe3e)=>{var _0x239775=_0x2dceac;_0x5659d1[_0x47fe3e][_0x239775(0x136)]=_0x136ef3;}),_0x273587[_0x2dceac(0x18b)]((_0x5b408f,_0x55c128)=>{var _0x3ccd5f=_0x2dceac;_0x5659d1[_0x55c128][_0x3ccd5f(0xd8)]=_0x5b408f;}),_0x39aa65['forEach']((_0x3f5302,_0x345069)=>{var _0x138406=_0x2dceac;_0x5659d1[_0x345069][_0x138406(0x16e)]=_0x3f5302;}),_0x49d4bd[_0x2dceac(0x18b)]((_0x1f2470,_0x118ff6)=>{var _0x4dd953=_0x2dceac;_0x5659d1[_0x118ff6][_0x4dd953(0x1a8)]=_0x1f2470;}),_0x1e0cd6[_0x2dceac(0x18b)]((_0x50d7bc,_0x45e6ff)=>{_0x5659d1[_0x45e6ff]['unit']=_0x50d7bc;}),_0x28367e[_0x2dceac(0x18b)]((_0x30ba58,_0x1e295e)=>{_0x5659d1[_0x1e295e]['production_date']=_0x30ba58;}),_0x2f30b9[_0x2dceac(0x18b)]((_0x5ed743,_0x2e6b43)=>{var _0x4399c8=_0x2dceac;_0x5659d1[_0x2e6b43][_0x4399c8(0x119)]=_0x5ed743;});const _0x2b88e9=await sales_finished[_0x2dceac(0x7b)]({'invoice':_0x44d6a2});_0x2b88e9[_0x2dceac(0x195)]='True';const _0x124545=await _0x2b88e9['save'](),_0x17c021=new sales_return_finished({'invoice':_0x44d6a2,'customer':_0x4c37da['body'][_0x2dceac(0x1b1)],'date':_0x4a7ed8,'warehouse_name':_0x336685,'room':_0x49d38c,'ToWarehouse':_0x17c710,'ToRoom':_0x545aaa,'return_sale_QA':_0x5659d1,'note':_0x4310f7,'warehouse_cat':_0x2ab03f}),_0x3cb794=await _0x17c021[_0x2dceac(0xc2)](),_0x2a2d06=await sales_return_finished[_0x2dceac(0x7b)]({'invoice':_0x44d6a2}),_0x3a52f0=await warehouse[_0x2dceac(0x7b)]({'name':_0x17c710,'room':_0x545aaa});_0x2a2d06[_0x2dceac(0xe4)]['forEach'](_0x13f8fe=>{var _0xadd86d=_0x2dceac,_0x5c7630=0x0;const _0x153010=_0x3a52f0[_0xadd86d(0xe3)][_0xadd86d(0xb5)](_0x39b637=>{var _0x43ec28=_0xadd86d;_0x39b637[_0x43ec28(0xa6)]==_0x13f8fe[_0x43ec28(0xa6)]&&_0x39b637['expiry_date']==_0x13f8fe[_0x43ec28(0x119)]&&_0x39b637['production_date']==_0x13f8fe[_0x43ec28(0x1a3)]&&_0x39b637['batch_code']==_0x13f8fe[_0x43ec28(0x16e)]&&(_0x39b637[_0x43ec28(0x90)]=parseInt(_0x39b637[_0x43ec28(0x90)])+parseInt(_0x13f8fe[_0x43ec28(0xb8)]),_0x5c7630++);});_0x5c7630=='0'&&(_0x3a52f0[_0xadd86d(0xe3)]=_0x3a52f0['product_details']['concat']({'product_name':_0x13f8fe[_0xadd86d(0xa6)],'product_stock':_0x13f8fe[_0xadd86d(0xb8)],'primary_code':_0x13f8fe['primary_code'],'secondary_code':_0x13f8fe[_0xadd86d(0x100)],'product_code':_0x13f8fe['product_code'],'batch_code':_0x13f8fe[_0xadd86d(0x16e)],'maxPerUnit':_0x13f8fe[_0xadd86d(0x136)],'production_date':_0x13f8fe['production_date'],'expiry_date':_0x13f8fe['expiry_date'],'secondary_unit':_0x13f8fe[_0xadd86d(0x1a8)],'unit':_0x13f8fe[_0xadd86d(0xf6)],'maxProducts':_0x13f8fe['maxProducts'],'bay':_0x13f8fe[_0xadd86d(0x17f)]}));}),await _0x3a52f0[_0x2dceac(0xc2)]();const _0x6c895f=new c_payment_data({'invoice':_0x44d6a2,'customer':_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x1b1)],'reason':_0x2dceac(0x1ba)});await _0x6c895f['save']();const _0x534fac=await master_shop[_0x2dceac(0xf9)](),_0xfa2393=await email_settings[_0x2dceac(0x7b)](),_0x11b66d=await customer['findOne']({'name':_0x4c37da[_0x2dceac(0xf4)]['customer']});_0x534fac[0x0][_0x2dceac(0x93)]==0x1?(right_currency=_0x534fac[0x0][_0x2dceac(0x88)],left_currency=''):(right_currency='',left_currency=_0x534fac[0x0]['currency']);var _0x152d6f=_0x52e183,_0x4ec686=_0xb9128d,_0x178ea5='',_0x349a6f;for(_0x349a6f in _0x152d6f){_0x178ea5+=_0x2dceac(0xc9)+_0x2dceac(0x169)+_0x152d6f[_0x349a6f]+_0x2dceac(0xbd)+_0x2dceac(0x169)+_0x4ec686[_0x349a6f]+_0x2dceac(0xbd)+_0x2dceac(0xfd);}console[_0x2dceac(0x135)](_0x2dceac(0x190),_0x178ea5);let _0x81d0e=nodemailer[_0x2dceac(0x172)]({'service':_0x2dceac(0xff),'auth':{'user':_0xfa2393[_0x2dceac(0x171)],'pass':_0xfa2393['password']}}),_0xf0e442={'from':_0xfa2393[_0x2dceac(0x171)],'to':_0x11b66d[_0x2dceac(0x171)],'subject':_0x2dceac(0x1c1),'attachments':[{'filename':_0x2dceac(0x101),'path':__dirname+_0x2dceac(0x16b)+_0x2dceac(0xca)+_0x534fac[0x0][_0x2dceac(0x155)],'cid':_0x2dceac(0x185)}],'html':_0x2dceac(0x120)+_0x2dceac(0xf7)+_0x2dceac(0x11a)+_0x2dceac(0xa9)+_0x2dceac(0x14a)+_0x2dceac(0xa9)+_0x2dceac(0xb1)+_0x2dceac(0x1ae)+'<div>'+_0x2dceac(0x156)+_0x534fac[0x0][_0x2dceac(0x1ad)]+_0x2dceac(0x18d)+_0x2dceac(0x1ae)+_0x2dceac(0x1ae)+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x44d6a2+'\x20'+_0x2dceac(0xaf)+_0x2dceac(0x164)+_0x4a7ed8+'\x20'+_0x2dceac(0xd2)+_0x2dceac(0x18a)+_0x2dceac(0x1ae)+_0x2dceac(0xdd)+_0x2dceac(0xfe)+_0x2dceac(0xc9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2dceac(0x166)+_0x2dceac(0x157)+_0x2dceac(0x10d)+_0x2dceac(0xfd)+_0x2dceac(0x10b)+_0x2dceac(0xb6)+'\x20'+_0x178ea5+'\x20'+'</tbody>'+_0x2dceac(0x162)+'<div>'+_0x2dceac(0x125)+_0x2dceac(0xe6)+_0x534fac[0x0][_0x2dceac(0x1ad)]+_0x2dceac(0x18a)+_0x2dceac(0x1ae)+_0x2dceac(0x1ae)+_0x2dceac(0x8f)};_0x81d0e[_0x2dceac(0x188)](_0xf0e442,function(_0x5d7646,_0xc4b7){var _0x235687=_0x2dceac;_0x5d7646?(console[_0x235687(0x135)](_0x5d7646),console[_0x235687(0x135)](_0x235687(0xc7))):console[_0x235687(0x135)](_0x235687(0xfa));}),_0x4c37da['flash']('success',_0x2dceac(0x117)),_0x348534[_0x2dceac(0x106)]('/all_sales_finished/view');}catch(_0x47da1a){_0x348534[_0x2dceac(0x189)](0xc8)[_0x2dceac(0x1b3)]({'message1':_0x47da1a[_0x2dceac(0xf3)]});}else{if(_0x4c37da['body'][_0x2dceac(0x180)]=='GS')try{const {invoice:_0x102936,date:_0xc114b3,warehouse_name:_0x1fe643,product_name:_0x2a099e,primary_code:_0x4a47d8,secondary_code:_0x14132d,product_code:_0x484215,sales_quantity:_0x32dd64,stocks:_0x105a3f,return_qty:_0x2ecdfb,Room_name:_0x340bee,to_warehouse_name:_0x2e9128,to_Room_name:_0x59e9d3,note:_0xfa96c5,level:_0x45ed49,isle:_0x232fff,pallet:_0x4b1509,for_categorize:_0x4af694}=_0x4c37da[_0x2dceac(0xf4)];if(typeof _0x2a099e==_0x2dceac(0x134))var _0x52e183=[_0x4c37da['body'][_0x2dceac(0xa6)]],_0x39d602=[_0x4c37da['body'][_0x2dceac(0x168)]],_0x5854a7=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x100)]],_0x3e9e85=[_0x4c37da['body'][_0x2dceac(0xbb)]],_0x521d86=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x149)]],_0xb9128d=[_0x4c37da[_0x2dceac(0xf4)]['return_qty']],_0x5b094d=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x17f)]],_0x353f4c=[_0x4c37da[_0x2dceac(0xf4)]['maxPerUnit']],_0x273587=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xd8)]],_0x39aa65=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x16e)]],_0x49d4bd=[_0x4c37da['body'][_0x2dceac(0x1a8)]],_0x1e0cd6=[_0x4c37da['body'][_0x2dceac(0xf6)]],_0x28367e=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x1a3)]],_0x2f30b9=[_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x119)]];else var _0x52e183=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xa6)]],_0x39d602=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x168)]],_0x5854a7=[..._0x4c37da[_0x2dceac(0xf4)]['secondary_code']],_0x3e9e85=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xbb)]],_0x521d86=[..._0x4c37da['body'][_0x2dceac(0x149)]],_0xb9128d=[..._0x4c37da[_0x2dceac(0xf4)]['return_qty']],_0x5b094d=[..._0x4c37da[_0x2dceac(0xf4)]['bay']],_0x353f4c=[..._0x4c37da[_0x2dceac(0xf4)]['maxPerUnit']],_0x273587=[..._0x4c37da['body'][_0x2dceac(0xd8)]],_0x39aa65=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x16e)]],_0x49d4bd=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x1a8)]],_0x1e0cd6=[..._0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0xf6)]],_0x28367e=[..._0x4c37da['body'][_0x2dceac(0x1a3)]],_0x2f30b9=[..._0x4c37da[_0x2dceac(0xf4)]['expiry_date']];const _0x4496cc=_0x52e183['map'](_0x5a8dc9=>{return _0x5a8dc9={'product_name':_0x5a8dc9};});_0x39d602[_0x2dceac(0x18b)]((_0x105632,_0x469bf0)=>{_0x4496cc[_0x469bf0]['primary_code']=_0x105632;}),_0x5854a7[_0x2dceac(0x18b)]((_0x45bf93,_0xea2b36)=>{var _0xd1f21=_0x2dceac;_0x4496cc[_0xea2b36][_0xd1f21(0x100)]=_0x45bf93;}),_0x3e9e85[_0x2dceac(0x18b)]((_0x5c0874,_0xe4320e)=>{_0x4496cc[_0xe4320e]['product_code']=_0x5c0874;}),_0x521d86[_0x2dceac(0x18b)]((_0x444686,_0x51cd99)=>{var _0x9afbbd=_0x2dceac;_0x4496cc[_0x51cd99][_0x9afbbd(0x187)]=_0x444686;}),_0xb9128d['forEach']((_0x35530e,_0x5dd27a)=>{var _0x26dc2a=_0x2dceac;_0x4496cc[_0x5dd27a][_0x26dc2a(0xb8)]=_0x35530e;}),_0x5b094d[_0x2dceac(0x18b)]((_0x309863,_0x56af44)=>{var _0x1f2ce1=_0x2dceac;_0x4496cc[_0x56af44][_0x1f2ce1(0x17f)]=_0x309863;}),_0x353f4c[_0x2dceac(0x18b)]((_0x282c19,_0x87c640)=>{var _0x4a194c=_0x2dceac;_0x4496cc[_0x87c640][_0x4a194c(0x136)]=_0x282c19;}),_0x273587[_0x2dceac(0x18b)]((_0x549606,_0x26baff)=>{var _0x2849ef=_0x2dceac;_0x4496cc[_0x26baff][_0x2849ef(0xd8)]=_0x549606;}),_0x39aa65[_0x2dceac(0x18b)]((_0xb0c11a,_0x3130f4)=>{var _0x562dfe=_0x2dceac;_0x4496cc[_0x3130f4][_0x562dfe(0x16e)]=_0xb0c11a;}),_0x49d4bd['forEach']((_0x4b5f49,_0x20b785)=>{_0x4496cc[_0x20b785]['secondary_unit']=_0x4b5f49;}),_0x1e0cd6['forEach']((_0x359c28,_0x4746db)=>{var _0x3d7479=_0x2dceac;_0x4496cc[_0x4746db][_0x3d7479(0xf6)]=_0x359c28;}),_0x28367e[_0x2dceac(0x18b)]((_0xcc52a1,_0x26b653)=>{var _0x3e7fd5=_0x2dceac;_0x4496cc[_0x26b653][_0x3e7fd5(0x1a3)]=_0xcc52a1;}),_0x2f30b9[_0x2dceac(0x18b)]((_0x82741f,_0x4fb5e2)=>{var _0x112b25=_0x2dceac;_0x4496cc[_0x4fb5e2][_0x112b25(0x119)]=_0x82741f;});var _0x42c2f8=0x0;_0x4496cc['forEach'](_0x5a8ad0=>{var _0x49a5db=_0x2dceac;(parseInt(_0x5a8ad0[_0x49a5db(0x187)])<parseInt(_0x5a8ad0[_0x49a5db(0xb8)])||parseInt(_0x5a8ad0[_0x49a5db(0xbf)])<parseInt(_0x5a8ad0[_0x49a5db(0xb8)])&&parseInt(_0x5a8ad0[_0x49a5db(0x187)])>parseInt(_0x5a8ad0[_0x49a5db(0xb8)])||parseInt(_0x5a8ad0[_0x49a5db(0xb8)])==0x0)&&_0x42c2f8++;});if(_0x42c2f8!=0x0)return _0x4c37da[_0x2dceac(0x112)](_0x2dceac(0x79),_0x2dceac(0x1a6)),_0x348534['redirect']('back');const _0x31bad2=await sales_finished[_0x2dceac(0x7b)]({'invoice':_0x102936});_0x31bad2[_0x2dceac(0x195)]='True';const _0x4d3eaf=await _0x31bad2[_0x2dceac(0xc2)](),_0x522948=new sales_return_finished({'invoice':_0x102936,'customer':_0x4c37da[_0x2dceac(0xf4)]['customer'],'date':_0xc114b3,'warehouse_name':_0x1fe643,'room':_0x340bee,'ToWarehouse':_0x2e9128,'ToRoom':_0x59e9d3,'return_sale':_0x4496cc,'note':_0xfa96c5,'warehouse_cat':_0x4af694}),_0x5d0c9b=await _0x522948['save'](),_0x44dc74=await sales_return_finished[_0x2dceac(0x7b)]({'invoice':_0x102936}),_0x51bd5e=await warehouse[_0x2dceac(0x7b)]({'name':_0x2e9128,'room':_0x59e9d3,'warehouse_category':_0x2dceac(0x103)});_0x44dc74[_0x2dceac(0x99)][_0x2dceac(0x18b)](_0x528d6d=>{var _0x3c581e=_0x2dceac,_0x5ee0b3=0x0;const _0x1086c8=_0x51bd5e['product_details']['map'](_0x9d0d2a=>{var _0x31919c=a0_0x24dd;_0x9d0d2a['product_name']==_0x528d6d[_0x31919c(0xa6)]&&_0x9d0d2a['bay']==_0x528d6d[_0x31919c(0x17f)]&&_0x9d0d2a[_0x31919c(0x119)]==_0x528d6d[_0x31919c(0x119)]&&_0x9d0d2a[_0x31919c(0x1a3)]==_0x528d6d[_0x31919c(0x1a3)]&&_0x9d0d2a['batch_code']==_0x528d6d[_0x31919c(0x16e)]&&(_0x9d0d2a[_0x31919c(0x90)]=parseInt(_0x9d0d2a[_0x31919c(0x90)])+parseInt(_0x528d6d[_0x31919c(0xb8)]),_0x5ee0b3++);});_0x5ee0b3=='0'&&(_0x51bd5e['product_details']=_0x51bd5e['product_details']['concat']({'product_name':_0x528d6d[_0x3c581e(0xa6)],'product_stock':_0x528d6d['return_qty'],'primary_code':_0x528d6d[_0x3c581e(0x168)],'secondary_code':_0x528d6d['secondary_code'],'product_code':_0x528d6d[_0x3c581e(0xbb)],'bay':_0x528d6d[_0x3c581e(0x17f)],'batch_code':_0x528d6d[_0x3c581e(0x16e)],'maxPerUnit':_0x528d6d[_0x3c581e(0x136)],'production_date':_0x528d6d[_0x3c581e(0x1a3)],'expiry_date':_0x528d6d['expiry_date'],'secondary_unit':_0x528d6d[_0x3c581e(0x1a8)],'unit':_0x528d6d[_0x3c581e(0xf6)],'maxProducts':_0x528d6d['maxProducts']}));}),await _0x51bd5e[_0x2dceac(0xc2)](),console[_0x2dceac(0x135)](_0x4c37da[_0x2dceac(0xf4)]);const _0x235cb4=new c_payment_data({'invoice':_0x102936,'customer':_0x4c37da[_0x2dceac(0xf4)][_0x2dceac(0x1b1)],'reason':_0x2dceac(0x1ba)});await _0x235cb4[_0x2dceac(0xc2)]();const _0x446128=await master_shop[_0x2dceac(0xf9)]();console['log'](_0x2dceac(0x7f),_0x446128[0x0][_0x2dceac(0x155)]);const _0x5dfe89=await email_settings[_0x2dceac(0x7b)](),_0x2c9a56=await customer[_0x2dceac(0x7b)]({'name':_0x4c37da['body'][_0x2dceac(0x1b1)]});console['log'](_0x2dceac(0x118),_0x2c9a56);_0x446128[0x0]['currency_placement']==0x1?(right_currency=_0x446128[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x446128[0x0][_0x2dceac(0x88)]);var _0x152d6f=_0x52e183,_0x4ec686=_0xb9128d,_0x178ea5='',_0x349a6f;for(_0x349a6f in _0x152d6f){_0x178ea5+=_0x2dceac(0xc9)+_0x2dceac(0x169)+_0x152d6f[_0x349a6f]+_0x2dceac(0xbd)+_0x2dceac(0x169)+_0x4ec686[_0x349a6f]+_0x2dceac(0xbd)+_0x2dceac(0xfd);}console[_0x2dceac(0x135)](_0x2dceac(0x190),_0x178ea5);let _0x504c88=nodemailer['createTransport']({'service':_0x2dceac(0xff),'auth':{'user':_0x5dfe89[_0x2dceac(0x171)],'pass':_0x5dfe89['password']}}),_0x1c0e82={'from':_0x5dfe89[_0x2dceac(0x171)],'to':_0x2c9a56[_0x2dceac(0x171)],'subject':_0x2dceac(0x1c1),'attachments':[{'filename':_0x2dceac(0x101),'path':__dirname+_0x2dceac(0x16b)+_0x2dceac(0xca)+_0x446128[0x0]['image'],'cid':'logo'}],'html':_0x2dceac(0x120)+_0x2dceac(0xf7)+_0x2dceac(0x11a)+_0x2dceac(0xa9)+_0x2dceac(0x14a)+'<div>'+_0x2dceac(0xb1)+_0x2dceac(0x1ae)+'<div>'+_0x2dceac(0x156)+_0x446128[0x0][_0x2dceac(0x1ad)]+'\x20</h2>'+'</div>'+'</div>'+_0x2dceac(0x1a5)+_0x2dceac(0xa9)+_0x2dceac(0xf0)+'\x20Order\x20Number\x20:\x20'+_0x102936+'\x20'+_0x2dceac(0xaf)+_0x2dceac(0x164)+_0xc114b3+'\x20'+_0x2dceac(0xd2)+_0x2dceac(0x18a)+_0x2dceac(0x1ae)+_0x2dceac(0xdd)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2dceac(0xc9)+_0x2dceac(0xa5)+_0x2dceac(0x166)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x2dceac(0x10d)+_0x2dceac(0xfd)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x178ea5+'\x20'+_0x2dceac(0xa1)+_0x2dceac(0x162)+_0x2dceac(0xa9)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x446128[0x0][_0x2dceac(0x1ad)]+_0x2dceac(0x18a)+_0x2dceac(0x1ae)+_0x2dceac(0x1ae)+_0x2dceac(0x8f)};_0x504c88['sendMail'](_0x1c0e82,function(_0x434ede,_0x1154c4){var _0x162215=_0x2dceac;_0x434ede?(console[_0x162215(0x135)](_0x434ede),console['log'](_0x162215(0xc7))):console[_0x162215(0x135)](_0x162215(0xfa));}),_0x4c37da[_0x2dceac(0x112)](_0x2dceac(0x192),_0x2dceac(0x117)),_0x348534[_0x2dceac(0x106)](_0x2dceac(0x15c));}catch(_0x501af3){console['log'](_0x501af3),_0x348534[_0x2dceac(0x189)](0xc8)[_0x2dceac(0x1b3)]({'message1':_0x501af3[_0x2dceac(0xf3)]});}}}),router[a0_0x4505f7(0x11f)]('/barcode/:id',auth,async(_0x2ecc9c,_0x1e46e2)=>{var _0x437a38=a0_0x4505f7;try{const {username:_0x2bee5b,email:_0x2fd59f,role:_0x508862}=_0x2ecc9c[_0x437a38(0xb3)],_0x19d9d0=_0x2ecc9c[_0x437a38(0xb3)],_0x5b904a=await profile[_0x437a38(0x7b)]({'email':_0x19d9d0[_0x437a38(0x171)]}),_0x548ead=await master_shop['find']();console[_0x437a38(0x135)]('barcode\x20Product\x20master',_0x548ead);const _0x2a4930=_0x2ecc9c['params']['id'],_0x4eea9a=await sales[_0x437a38(0xfb)](_0x2a4930);console[_0x437a38(0x135)](_0x437a38(0xdc),_0x4eea9a);if(_0x548ead[0x0][_0x437a38(0x158)]==_0x437a38(0x184))var _0x18838b=users[_0x437a38(0x108)];else{if(_0x548ead[0x0][_0x437a38(0x158)]==_0x437a38(0xcf))var _0x18838b=users[_0x437a38(0xcf)];else{if(_0x548ead[0x0][_0x437a38(0x158)]==_0x437a38(0xac))var _0x18838b=users['German'];else{if(_0x548ead[0x0]['language']==_0x437a38(0xe1))var _0x18838b=users[_0x437a38(0xe1)];else{if(_0x548ead[0x0]['language']==_0x437a38(0x128))var _0x18838b=users[_0x437a38(0x128)];else{if(_0x548ead[0x0][_0x437a38(0x158)]=='Portuguese\x20(BR)')var _0x18838b=users[_0x437a38(0x127)];else{if(_0x548ead[0x0][_0x437a38(0x158)]==_0x437a38(0x165))var _0x18838b=users['Chinese'];else{if(_0x548ead[0x0][_0x437a38(0x158)]==_0x437a38(0x1a0))var _0x18838b=users[_0x437a38(0x198)];}}}}}}}_0x1e46e2[_0x437a38(0x14d)](_0x437a38(0x11d),{'success':_0x2ecc9c[_0x437a38(0x112)](_0x437a38(0x192)),'errors':_0x2ecc9c['flash']('errors'),'role':_0x19d9d0,'profile':_0x5b904a,'alldata':_0x4eea9a,'master_shop':_0x548ead,'language':_0x18838b});}catch(_0x2d578a){console[_0x437a38(0x135)](_0x2d578a);}}),router[a0_0x4505f7(0xb2)]('/barcode_scanner',async(_0x1e91d0,_0x2b2025)=>{var _0x273397=a0_0x4505f7;const {product_code:_0x4969d4,warehouse_name:_0x2b2065,rooms_data:_0x12d5d9,Roomslist:_0x2056b3,sales_category:_0x57d7a4}=_0x1e91d0['body'],_0x343b3a=_0x2056b3[_0x273397(0x160)](','),_0x2c0ee9=[];async function _0x4d6582(_0x3937a1){var _0x42c5b0=_0x273397;const _0x2e5293=await warehouse['aggregate']([{'$match':{'name':_0x2b2065,'room':_0x3937a1}},{'$unwind':_0x42c5b0(0x16f)},{'$match':{'product_details.primary_code':_0x4969d4}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x42c5b0(0xd0)},'product_stock':{'$first':_0x42c5b0(0x1b5)},'primary_code':{'$first':_0x42c5b0(0x126)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x42c5b0(0xd6)},'level':{'$first':_0x42c5b0(0xab)},'bay':{'$first':_0x42c5b0(0xa4)},'type':{'$first':_0x42c5b0(0x181)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x42c5b0(0xbe)},'secondary_unit':{'$first':_0x42c5b0(0x12f)},'storage':{'$first':_0x42c5b0(0xf2)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x42c5b0(0xe0)},'production_date':{'$first':_0x42c5b0(0x193)},'maxPerUnit':{'$first':_0x42c5b0(0x7d)},'batch_code':{'$first':_0x42c5b0(0xb9)},'product_cat':{'$first':_0x42c5b0(0x139)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x42c5b0(0x83)},'invoice':{'$first':_0x42c5b0(0x1af)},'uuid':{'$first':_0x42c5b0(0x91)},'gross_price':{'$first':_0x42c5b0(0x13b)},'sales_category':{'$first':_0x42c5b0(0x8a)}}}]),_0x5eca47=await warehouse[_0x42c5b0(0x85)]([{'$match':{'name':_0x2b2065,'room':_0x3937a1}},{'$unwind':_0x42c5b0(0x16f)},{'$match':{'product_details.secondary_code':_0x4969d4}},{'$group':{'_id':_0x42c5b0(0x15a),'name':{'$first':_0x42c5b0(0xd0)},'product_stock':{'$first':_0x42c5b0(0x1b5)},'primary_code':{'$first':_0x42c5b0(0x126)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x42c5b0(0xd6)},'level':{'$first':_0x42c5b0(0xa4)},'isle':{'$first':_0x42c5b0(0x9a)},'type':{'$first':_0x42c5b0(0x181)},'pallet':{'$first':_0x42c5b0(0x143)},'unit':{'$first':_0x42c5b0(0xbe)},'secondary_unit':{'$first':_0x42c5b0(0x12f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x42c5b0(0x140)},'expiry_date':{'$first':_0x42c5b0(0xe0)},'production_date':{'$first':_0x42c5b0(0x193)},'maxPerUnit':{'$first':_0x42c5b0(0x7d)},'batch_code':{'$first':_0x42c5b0(0xb9)},'product_cat':{'$first':_0x42c5b0(0x139)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x42c5b0(0x83)},'invoice':{'$first':_0x42c5b0(0x1af)},'uuid':{'$first':_0x42c5b0(0x91)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x42c5b0(0x8a)}}}]);if(_0x2e5293[_0x42c5b0(0x19e)]>0x0)_0x2c0ee9[_0x42c5b0(0x82)](_0x2e5293);else _0x5eca47[_0x42c5b0(0x19e)]>0x0&&_0x2c0ee9[_0x42c5b0(0x82)](_0x5eca47);}const _0x4ea09c=_0x343b3a[_0x273397(0xb5)](_0x22d28e=>_0x4d6582(_0x22d28e));await Promise[_0x273397(0x142)](_0x4ea09c),_0x2b2025[_0x273397(0x1b3)](_0x2c0ee9);}),router[a0_0x4505f7(0xb2)]('/barcode_scanner_logs',async(_0x378553,_0x20be9c)=>{var _0x4b206a=a0_0x4505f7;const {product_code:_0x21b2c6,warehouse_name:_0x724069,rooms_data:_0x19b823,Roomslist:_0x133d4a,sales_category:_0x32e9eb}=_0x378553[_0x4b206a(0xf4)],_0x5ad886=_0x133d4a[_0x4b206a(0x160)](','),_0x4ec507=[];async function _0x2b7389(_0x48a69a){var _0x401251=_0x4b206a;const _0x415a02=await warehouse[_0x401251(0x85)]([{'$match':{'name':_0x724069,'room':_0x48a69a}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x21b2c6,'product_details.sales_category':_0x32e9eb,'product_details.type_products':_0x401251(0x135)}},{'$group':{'_id':_0x401251(0x15a),'name':{'$first':_0x401251(0xd0)},'product_stock':{'$first':_0x401251(0x1b5)},'primary_code':{'$first':_0x401251(0x126)},'secondary_code':{'$first':_0x401251(0x12b)},'product_code':{'$first':_0x401251(0xd6)},'level':{'$first':_0x401251(0xab)},'bay':{'$first':_0x401251(0xa4)},'type':{'$first':_0x401251(0x181)},'pallet':{'$first':_0x401251(0x143)},'unit':{'$first':_0x401251(0xbe)},'secondary_unit':{'$first':_0x401251(0x12f)},'storage':{'$first':_0x401251(0xf2)},'rack':{'$first':_0x401251(0x140)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x401251(0x193)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x401251(0xb9)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x401251(0x1af)},'uuid':{'$first':_0x401251(0x91)},'gross_price':{'$first':_0x401251(0x13b)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':_0x401251(0xa8)}}}]);console[_0x401251(0x135)]('log'+_0x401251(0xa7)+_0x21b2c6+_0x401251(0xa7)+_0x32e9eb);const _0x3d889d=await warehouse[_0x401251(0x85)]([{'$match':{'name':_0x724069,'room':_0x48a69a}},{'$unwind':_0x401251(0x16f)},{'$match':{'product_details.secondary_code':_0x21b2c6,'product_details.sales_category':_0x32e9eb,'product_details.type_products':_0x401251(0x135)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x401251(0x1b5)},'primary_code':{'$first':_0x401251(0x126)},'secondary_code':{'$first':_0x401251(0x12b)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x401251(0xa4)},'isle':{'$first':_0x401251(0x9a)},'type':{'$first':_0x401251(0x181)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x401251(0xbe)},'secondary_unit':{'$first':_0x401251(0x12f)},'storage':{'$first':_0x401251(0xf2)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x401251(0xe0)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x401251(0x7d)},'batch_code':{'$first':_0x401251(0xb9)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x401251(0x13b)},'sales_category':{'$first':_0x401251(0x8a)},'type_products':{'$first':_0x401251(0xa8)}}}]);if(_0x415a02[_0x401251(0x19e)]>0x0)_0x4ec507[_0x401251(0x82)](_0x415a02);else _0x3d889d[_0x401251(0x19e)]>0x0&&_0x4ec507[_0x401251(0x82)](_0x3d889d);}const _0x5e6a5c=_0x5ad886[_0x4b206a(0xb5)](_0x50103e=>_0x2b7389(_0x50103e));await Promise[_0x4b206a(0x142)](_0x5e6a5c),_0x20be9c[_0x4b206a(0x1b3)](_0x4ec507);}),router[a0_0x4505f7(0xb2)]('/barcode_scanner_auto_data',async(_0x6a9a7f,_0x3710c9)=>{var _0x513bc6=a0_0x4505f7;try{const {prduct_code:_0x4c132d,warehouse_data:_0x480bcc,qty_req:_0x3a1fd4}=_0x6a9a7f[_0x513bc6(0xf4)];let _0x20eb93=_0x4c132d[_0x513bc6(0x160)]('~'),_0x1d4fed=_0x3a1fd4[_0x513bc6(0x160)]('~'),_0x9767f4=[],_0x1db160=0x0;for(let _0x3908e2=0x0;_0x3908e2<=_0x20eb93[_0x513bc6(0x19e)]-0x1;_0x3908e2++){const _0x3c577c=_0x20eb93[_0x3908e2],_0x358a48=_0x1d4fed[_0x3908e2],_0x3b6482=await warehouse[_0x513bc6(0x85)]([{'$match':{'name':_0x480bcc}},{'$unwind':_0x513bc6(0x16f)},{'$match':{'product_details.product_code':_0x3c577c,'product_details.isAvailable':_0x513bc6(0x183),'product_details.isUsed':_0x513bc6(0xbc)}},{'$sort':{'product_details.date_received':0x1,'product_details.level':-0x1,'product_details.bay':-0x1}},{'$group':{'_id':_0x513bc6(0x15a),'name':{'$first':_0x513bc6(0xd0)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x513bc6(0x126)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x513bc6(0xd6)},'level':{'$first':'$product_details.level'},'bay':{'$first':'$product_details.bay'},'type':{'$first':_0x513bc6(0x181)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x513bc6(0xbe)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x513bc6(0xf2)},'rack':{'$first':_0x513bc6(0x140)},'expiry_date':{'$first':_0x513bc6(0xe0)},'production_date':{'$first':_0x513bc6(0x193)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x513bc6(0xb9)},'product_cat':{'$first':_0x513bc6(0x139)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x513bc6(0x83)},'invoice':{'$first':_0x513bc6(0x1af)},'uuid':{'$first':_0x513bc6(0x91)},'gross_price':{'$first':_0x513bc6(0x13b)},'sales_category':{'$first':_0x513bc6(0x8a)},'date_received':{'$first':_0x513bc6(0xcb)},'warehouse_id':{'$first':_0x513bc6(0xad)}}}]),_0x249d12=_0x3b6482['sort']((_0x4f7a85,_0x459749)=>new Date(_0x4f7a85[_0x513bc6(0x15e)])-new Date(_0x459749['date_received']));let _0x18f860=_0x358a48;for(let _0x25cdb9=0x0;_0x25cdb9<=_0x249d12[_0x513bc6(0x19e)]-0x1&&_0x18f860>0x0;_0x25cdb9++){const _0x3cb7ab=_0x249d12[_0x25cdb9];if(_0x3cb7ab[_0x513bc6(0xbb)]==_0x3c577c){_0x9767f4[_0x1db160]={};const _0x4ee485=parseInt(_0x3cb7ab[_0x513bc6(0x90)]),_0x3830fe=0x0;let _0x3ffe90=_0x4ee485-_0x3830fe,_0x1aed23=Math['min'](_0x18f860,_0x3ffe90);console['log'](_0x513bc6(0x97)+_0x1aed23+'\x20units\x20to\x20warehouse:\x20'+_0x480bcc+',\x20room:\x20'+_0x3cb7ab['roomNamed']+_0x513bc6(0x170)+(_0x3cb7ab['level']+_0x3cb7ab[_0x513bc6(0x17f)])+_0x513bc6(0x1ab)+_0x3cb7ab[_0x513bc6(0x15e)]+'\x20Name:\x20'+_0x3cb7ab[_0x513bc6(0x199)]),_0x9767f4[_0x1db160][_0x513bc6(0x173)]=_0x3cb7ab[_0x513bc6(0x124)]+'~'+_0x3cb7ab['_id']+'~'+_0x1aed23,_0x9767f4[_0x1db160][_0x513bc6(0xa6)]=_0x3cb7ab[_0x513bc6(0x199)],_0x9767f4[_0x1db160]['product_code']=_0x3cb7ab['product_code'],_0x9767f4[_0x1db160][_0x513bc6(0x144)]=_0x3cb7ab['product_id'],_0x9767f4[_0x1db160][_0x513bc6(0x107)]=_0x3cb7ab[_0x513bc6(0x107)],_0x9767f4[_0x1db160][_0x513bc6(0xce)]=_0x3cb7ab[_0x513bc6(0xce)],_0x9767f4[_0x1db160][_0x513bc6(0x197)]=_0x3cb7ab[_0x513bc6(0x197)],_0x9767f4[_0x1db160][_0x513bc6(0x87)]=_0x1aed23,_0x9767f4[_0x1db160][_0x513bc6(0xf6)]=_0x3cb7ab[_0x513bc6(0xf6)],_0x9767f4[_0x1db160]['secondary_unit']=_0x3cb7ab['secondary_unit'],_0x9767f4[_0x1db160][_0x513bc6(0x168)]=_0x3cb7ab['primary_code'],_0x9767f4[_0x1db160][_0x513bc6(0x100)]=_0x3cb7ab['secondary_code'],_0x9767f4[_0x1db160][_0x513bc6(0xfc)]=_0x3cb7ab['maxStocks'],_0x9767f4[_0x1db160][_0x513bc6(0x16e)]=_0x3cb7ab[_0x513bc6(0x16e)],_0x9767f4[_0x1db160][_0x513bc6(0x119)]=_0x3cb7ab[_0x513bc6(0x119)],_0x9767f4[_0x1db160][_0x513bc6(0x1a3)]=_0x3cb7ab[_0x513bc6(0x1a3)],_0x9767f4[_0x1db160]['maxperunit']=_0x3cb7ab['maxperunit'],_0x9767f4[_0x1db160]['product_cat']=_0x3cb7ab['product_cat'],_0x9767f4[_0x1db160][_0x513bc6(0x146)]=_0x3cb7ab[_0x513bc6(0x146)],_0x9767f4[_0x1db160][_0x513bc6(0xc5)]=_0x3cb7ab[_0x513bc6(0xc5)],_0x9767f4[_0x1db160]['room_name']=_0x3cb7ab[_0x513bc6(0xef)],_0x9767f4[_0x1db160][_0x513bc6(0x1bd)]=_0x3cb7ab[_0x513bc6(0x1bd)],_0x9767f4[_0x1db160][_0x513bc6(0x17f)]=_0x3cb7ab[_0x513bc6(0x17f)],_0x9767f4[_0x1db160][_0x513bc6(0x189)]=_0x513bc6(0x183),console[_0x513bc6(0x135)]('1',_0x1db160),_0x18f860-=_0x1aed23,_0x1db160++;if(_0x18f860<=0x0)break;}}if(_0x18f860>0x0){var _0x438035=await product['findOne']({'product_code':_0x3c577c});console[_0x513bc6(0x135)]('2',_0x1db160),_0x9767f4[_0x1db160]={},_0x9767f4[_0x1db160]['product_name']=_0x438035[_0x513bc6(0x199)],_0x9767f4[_0x1db160][_0x513bc6(0xbb)]=_0x3c577c,_0x9767f4[_0x1db160]['product_id']=_0x438035[_0x513bc6(0x9f)][_0x513bc6(0x110)](),_0x9767f4[_0x1db160][_0x513bc6(0x87)]=_0x18f860,_0x9767f4[_0x1db160][_0x513bc6(0xb4)]=_0x438035[_0x513bc6(0xf6)],_0x9767f4[_0x1db160][_0x513bc6(0x1a8)]=_0x438035[_0x513bc6(0x15f)],_0x9767f4[_0x1db160][_0x513bc6(0x168)]=_0x438035['primary_code'],_0x9767f4[_0x1db160][_0x513bc6(0x100)]=_0x438035['secondary_code'],_0x9767f4[_0x1db160]['maxStocks']=_0x438035['maxStocks'],_0x9767f4[_0x1db160][_0x513bc6(0x86)]=_0x438035[_0x513bc6(0x178)],_0x9767f4[_0x1db160][_0x513bc6(0xc5)]=_0x438035['gross_price'],_0x9767f4[_0x1db160]['status']=_0x513bc6(0xbc),console[_0x513bc6(0x135)](_0x513bc6(0xc0)+_0x18f860+'\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20'+_0x1db160+_0x513bc6(0xa7)+_0x3c577c),_0x1db160++;}}_0x3710c9[_0x513bc6(0x1b3)](_0x9767f4);}catch(_0xdd18f9){console[_0x513bc6(0x135)](_0xdd18f9);}}),router[a0_0x4505f7(0xb2)](a0_0x4505f7(0x1aa),async(_0x1f3582,_0x1cfd56)=>{var _0x358dea=a0_0x4505f7;const {product_code:_0x526df8}=_0x1f3582[_0x358dea(0xf4)];var _0x480579;const _0x298ef4=await product['aggregate']([{'$match':{'primary_code':_0x526df8}},{'$group':{'_id':_0x358dea(0xad),'name':{'$first':'$name'},'category':{'$first':_0x358dea(0x17b)},'brand':{'$first':_0x358dea(0x19c)},'unit':{'$first':_0x358dea(0x10f)},'alertquantity':{'$first':_0x358dea(0x12c)},'product_code':{'$first':_0x358dea(0x92)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x358dea(0x147)},'maxProdPerUnit':{'$first':_0x358dea(0x14b)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x358dea(0x14f)},'gross_price':{'$first':_0x358dea(0x163)},'sales_category':{'$first':'$sales_category'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x58ebc9=await product[_0x358dea(0x85)]([{'$match':{'secondary_code':_0x526df8}},{'$group':{'_id':_0x358dea(0xad),'name':{'$first':_0x358dea(0x94)},'category':{'$first':_0x358dea(0x17b)},'brand':{'$first':_0x358dea(0x19c)},'unit':{'$first':_0x358dea(0x10f)},'alertquantity':{'$first':_0x358dea(0x12c)},'product_code':{'$first':_0x358dea(0x92)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x358dea(0xd3)},'maxStocks':{'$first':_0x358dea(0x147)},'maxProdPerUnit':{'$first':_0x358dea(0x14b)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'},'gross_price':{'$first':_0x358dea(0x163)},'sales_category':{'$first':_0x358dea(0x8e)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x298ef4[_0x358dea(0x19e)]>0x0)_0x480579=_0x298ef4;else _0x58ebc9[_0x358dea(0x19e)]>0x0&&(_0x480579=_0x58ebc9);_0x1cfd56['json'](_0x480579);}),router[a0_0x4505f7(0xb2)]('/process/view',async(_0x191b0b,_0x3725a4)=>{var _0x1ad5f1=a0_0x4505f7;try{const {group_id:_0xe4b49d,DRSI:_0x32e633,dateofreq:_0x1ae48f,PO_number:_0x136ab1,date:_0x3bd5a0,warehouse_name:_0x1e9958,typevehicle:_0x4a3900,deliverydate:_0x36f23c,driver:_0x1a6459,plate:_0x1866f5,van:_0x345bbb,TSU:_0x197ba8,actual_delivery_date:_0x54e7b7,TFU:_0x409e0e,pull_out_date:_0x3ac6a2,sales:_0x2d27f2,Customer_data:_0x201e6f,note:_0x2a04ce}=_0x191b0b[_0x1ad5f1(0xf4)],_0x1ceb32=mongoose['Types'][_0x1ad5f1(0x11b)];let _0x51b7d4=[];const _0x2720bd=new invoice_for_outgoing();await _0x2720bd[_0x1ad5f1(0xc2)]();const _0x7707c7=_0x1ad5f1(0x111)+_0x2720bd[_0x1ad5f1(0x122)]['toString']()[_0x1ad5f1(0xde)](0x8,'0');if(typeof _0xe4b49d=='string'){let _0x1155bb=_0xe4b49d[_0x1ad5f1(0x160)]('~');var _0xaa7e07=_0x1ceb32(_0x1155bb[0x0]),_0x1a03f3=_0x1ceb32(_0x1155bb[0x1]),_0x539c5b=_0x1155bb[0x2];let _0x2751b3=0x0;const _0x1f36d3=await warehouse['aggregate']([{'$match':{'_id':_0xaa7e07}},{'$unwind':'$product_details'},{'$match':{'product_details._id':_0x1a03f3}}]);await warehouse[_0x1ad5f1(0x159)]({'_id':_0x1ceb32(_0xaa7e07),'product_details._id':_0x1ceb32(_0x1a03f3)},{'$set':{'product_details.$.isUsed':_0x1ad5f1(0x183)}}),_0x51b7d4[_0x2751b3]={};for(let _0x4b17d0=0x0;_0x4b17d0<=_0x1f36d3[_0x1ad5f1(0x19e)]-0x1;_0x4b17d0++){const _0x58d784=_0x1f36d3[_0x4b17d0];console[_0x1ad5f1(0x135)](_0x58d784),_0x51b7d4[_0x2751b3][_0x1ad5f1(0xe9)]=_0x58d784[_0x1ad5f1(0x199)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x144)]=_0x58d784['product_details']['product_id'],_0x51b7d4[_0x2751b3][_0x1ad5f1(0xa6)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0xa6)],_0x51b7d4[_0x2751b3]['product_code']=_0x58d784[_0x1ad5f1(0xe3)]['product_code'],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x90)]=_0x539c5b,_0x51b7d4[_0x2751b3][_0x1ad5f1(0x87)]=_0x539c5b,_0x51b7d4[_0x2751b3][_0x1ad5f1(0xf6)]=_0x58d784['product_details']['unit'],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x1a8)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x1a8)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x1bd)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x1bd)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x17f)]=_0x58d784['product_details'][_0x1ad5f1(0x17f)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x168)]=_0x58d784[_0x1ad5f1(0xe3)]['primary_code'],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x100)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x100)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0xfc)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0xfc)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x16e)]=_0x58d784['product_details'][_0x1ad5f1(0x16e)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x119)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x119)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x1a3)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x1a3)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x86)]=_0x58d784[_0x1ad5f1(0xe3)]['maxperunit'],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x9b)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x9b)],_0x51b7d4[_0x2751b3]['room_name']=_0x58d784[_0x1ad5f1(0x176)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x146)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x146)],_0x51b7d4[_0x2751b3]['uuid']=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x197)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0xc5)]=_0x58d784[_0x1ad5f1(0xe3)]['gross_price'],_0x51b7d4[_0x2751b3][_0x1ad5f1(0xce)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x11e)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x107)]=_0x58d784[_0x1ad5f1(0xe3)][_0x1ad5f1(0x107)],_0x51b7d4[_0x2751b3]['sales_id']=_0x58d784['product_details'][_0x1ad5f1(0x11e)],_0x51b7d4[_0x2751b3][_0x1ad5f1(0x124)]=_0x58d784[_0x1ad5f1(0x9f)]['valueOf'](),_0x51b7d4[_0x2751b3][_0x1ad5f1(0xc4)]=_0x58d784['product_details']['_id'][_0x1ad5f1(0x110)](),_0x51b7d4[_0x2751b3][_0x1ad5f1(0x148)]=_0x1ad5f1(0x80),_0x51b7d4[_0x2751b3]['agent_id']=_0x58d784[_0x1ad5f1(0xe3)]['sales'];}_0x51b7d4[_0x2751b3][_0x1ad5f1(0x17e)]=_0x7707c7;}else for(let _0x5dd2c6=0x0;_0x5dd2c6<=_0xe4b49d[_0x1ad5f1(0x19e)]-0x1;_0x5dd2c6++){const _0x58e2eb=_0xe4b49d[_0x5dd2c6];let _0x373939=_0x58e2eb[_0x1ad5f1(0x160)]('~');console[_0x1ad5f1(0x135)](_0x373939);var _0xaa7e07=_0x1ceb32(_0x373939[0x0]),_0x1a03f3=_0x1ceb32(_0x373939[0x1]),_0x539c5b=_0x373939[0x2];const _0x20caf4=await warehouse[_0x1ad5f1(0x85)]([{'$match':{'_id':_0xaa7e07}},{'$unwind':_0x1ad5f1(0x16f)},{'$match':{'product_details._id':_0x1a03f3}}]);await warehouse[_0x1ad5f1(0x159)]({'_id':_0x1ceb32(_0xaa7e07),'product_details._id':_0x1ceb32(_0x1a03f3)},{'$set':{'product_details.$.isUsed':_0x1ad5f1(0x183)}}),_0x51b7d4[_0x5dd2c6]={};for(let _0x53190b=0x0;_0x53190b<=_0x20caf4[_0x1ad5f1(0x19e)]-0x1;_0x53190b++){const _0x468f58=_0x20caf4[_0x53190b];_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0xe9)]=_0x468f58[_0x1ad5f1(0x199)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x144)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x144)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0xa6)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0xa6)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0xbb)]=_0x468f58[_0x1ad5f1(0xe3)]['product_code'],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x90)]=_0x539c5b,_0x51b7d4[_0x5dd2c6]['quantity']=_0x539c5b,_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0xf6)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0xf6)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x1a8)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x1a8)],_0x51b7d4[_0x5dd2c6]['level']=_0x468f58['product_details'][_0x1ad5f1(0x1bd)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x17f)]=_0x468f58['product_details']['bay'],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x168)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x168)],_0x51b7d4[_0x5dd2c6]['secondary_code']=_0x468f58['product_details'][_0x1ad5f1(0x100)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0xfc)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0xfc)],_0x51b7d4[_0x5dd2c6]['batch_code']=_0x468f58['product_details'][_0x1ad5f1(0x16e)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x119)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x119)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x1a3)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x1a3)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x86)]=_0x468f58[_0x1ad5f1(0xe3)]['maxperunit'],_0x51b7d4[_0x5dd2c6]['product_cat']=_0x468f58[_0x1ad5f1(0xe3)]['product_cat'],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0xd4)]=_0x468f58[_0x1ad5f1(0x176)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x146)]=_0x468f58[_0x1ad5f1(0xe3)]['invoice'],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x197)]=_0x468f58[_0x1ad5f1(0xe3)]['uuid'],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0xc5)]=_0x468f58['product_details'][_0x1ad5f1(0xc5)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0xce)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x11e)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x107)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x107)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x84)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x11e)],_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x124)]=_0x468f58[_0x1ad5f1(0x9f)][_0x1ad5f1(0x110)](),_0x51b7d4[_0x5dd2c6]['warehouse_id_detl']=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x9f)][_0x1ad5f1(0x110)](),_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x148)]=_0x1ad5f1(0x80),_0x51b7d4[_0x5dd2c6][_0x1ad5f1(0x130)]=_0x468f58[_0x1ad5f1(0xe3)][_0x1ad5f1(0x11e)];}_0x51b7d4[_0x5dd2c6]['outgoiug_inv']=_0x7707c7;}for(let _0x36e851=0x0;_0x36e851<=_0x51b7d4[_0x1ad5f1(0x19e)]-0x1;_0x36e851++){const _0x44ad9b=_0x51b7d4[_0x36e851],_0xc6238b=new warehouse_temporary(_0x44ad9b);await _0xc6238b['save']();}const _0x56d71f=new sales_finished({'invoice':_0x7707c7,'sales_data':_0x2d27f2,'customer':_0x201e6f,'date':_0x3bd5a0,'warehouse_name':_0x1e9958,'sale_product':_0x51b7d4,'note':_0x2a04ce,'finalize':_0x1ad5f1(0xec),'dateofreq':_0x1ae48f,'PO_number':_0x136ab1,'typevehicle':_0x4a3900,'deliverydate':_0x36f23c,'driver':_0x1a6459,'plate':_0x1866f5,'van':_0x345bbb,'DRSI':_0x32e633,'TSU':_0x197ba8,'TFU':_0x409e0e,'pullout_date':_0x3ac6a2,'actualdelivery_date':_0x54e7b7,'typeOfProducts':_0x1ad5f1(0x114)}),_0x57faac=await _0x56d71f[_0x1ad5f1(0xc2)]();_0x191b0b['flash']('success','Sales\x20Add\x20successfully'),_0x3725a4[_0x1ad5f1(0x106)](_0x1ad5f1(0x1b0)+_0x57faac[_0x1ad5f1(0x9f)]);}catch(_0x31771e){console[_0x1ad5f1(0x135)](_0x31771e);}}),module['exports']=router;