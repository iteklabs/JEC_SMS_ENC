var a0_0x5cdbc7=a0_0x421a;(function(_0x5c3c6e,_0x2c4be1){var _0x280769=a0_0x421a,_0x2da770=_0x5c3c6e();while(!![]){try{var _0x232972=-parseInt(_0x280769(0x269))/0x1*(parseInt(_0x280769(0x262))/0x2)+-parseInt(_0x280769(0x305))/0x3*(-parseInt(_0x280769(0x252))/0x4)+-parseInt(_0x280769(0x260))/0x5*(-parseInt(_0x280769(0x302))/0x6)+-parseInt(_0x280769(0x239))/0x7*(parseInt(_0x280769(0x28c))/0x8)+-parseInt(_0x280769(0x1e1))/0x9+-parseInt(_0x280769(0x2c3))/0xa*(parseInt(_0x280769(0x247))/0xb)+-parseInt(_0x280769(0x2f4))/0xc*(-parseInt(_0x280769(0x27a))/0xd);if(_0x232972===_0x2c4be1)break;else _0x2da770['push'](_0x2da770['shift']());}catch(_0x29189f){_0x2da770['push'](_0x2da770['shift']());}}}(a0_0x8b16,0x9ea92));const express=require(a0_0x5cdbc7(0x242)),app=express(),router=express[a0_0x5cdbc7(0x2fd)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require(a0_0x5cdbc7(0x2b3)),auth=require(a0_0x5cdbc7(0x20c)),nodemailer=require('nodemailer'),users=require(a0_0x5cdbc7(0x2b5)),mongoose=require(a0_0x5cdbc7(0x257));router[a0_0x5cdbc7(0x2b2)]('/view',auth,async(_0x16be83,_0x20518b)=>{var _0x4861ab=a0_0x5cdbc7;try{const {username:_0x556930,email:_0x3e16db,role:_0x101256}=_0x16be83['user'],_0x6730f2=_0x16be83[_0x4861ab(0x2b4)],_0x1e8d46=await profile[_0x4861ab(0x1ff)]({'email':_0x6730f2[_0x4861ab(0x248)]}),_0x64db70=await master_shop[_0x4861ab(0x218)]();let _0x3013c7;if(_0x6730f2['role']==_0x4861ab(0x222)){const _0x3a38ef=await staff[_0x4861ab(0x1ff)]({'email':_0x6730f2[_0x4861ab(0x248)]});_0x3013c7=await sales_finished[_0x4861ab(0x25e)]([{'$match':{'typeOfProducts':_0x4861ab(0x1e7)}},{'$unwind':_0x4861ab(0x251)},{'$group':{'_id':_0x4861ab(0x231),'invoice':{'$first':_0x4861ab(0x1f3)},'customers':{'$first':_0x4861ab(0x1e8)},'date':{'$first':_0x4861ab(0x23b)},'warehouse_name':{'$first':_0x4861ab(0x202)},'sale_product':{'$push':_0x4861ab(0x251)},'note':{'$first':_0x4861ab(0x2ce)},'return_data':{'$first':_0x4861ab(0x2af)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x4861ab(0x307)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x4861ab(0x2f3)},'type':{'$addToSet':_0x4861ab(0x324)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x4861ab(0x298)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x3013c7=await sales_finished[_0x4861ab(0x25e)]([{'$match':{'typeOfProducts':'own'}},{'$unwind':_0x4861ab(0x251)},{'$group':{'_id':_0x4861ab(0x231),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x4861ab(0x1e8)},'date':{'$first':_0x4861ab(0x23b)},'warehouse_name':{'$first':_0x4861ab(0x202)},'sale_product':{'$push':_0x4861ab(0x251)},'note':{'$first':_0x4861ab(0x2ce)},'return_data':{'$first':_0x4861ab(0x2af)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x4861ab(0x307)},'level':{'$addToSet':_0x4861ab(0x276)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x4861ab(0x324)},'pallet':{'$addToSet':_0x4861ab(0x2cd)},'finalize':{'$first':_0x4861ab(0x298)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x64db70[0x0][_0x4861ab(0x210)]==_0x4861ab(0x1f2)){var _0x5487b7=users[_0x4861ab(0x299)];console[_0x4861ab(0x2d2)](_0x5487b7);}else{if(_0x64db70[0x0][_0x4861ab(0x210)]==_0x4861ab(0x28a))var _0x5487b7=users['Hindi'];else{if(_0x64db70[0x0][_0x4861ab(0x210)]==_0x4861ab(0x26c))var _0x5487b7=users[_0x4861ab(0x26c)];else{if(_0x64db70[0x0][_0x4861ab(0x210)]=='Spanish')var _0x5487b7=users[_0x4861ab(0x2c0)];else{if(_0x64db70[0x0][_0x4861ab(0x210)]==_0x4861ab(0x1fa))var _0x5487b7=users['French'];else{if(_0x64db70[0x0][_0x4861ab(0x210)]=='Portuguese\x20(BR)')var _0x5487b7=users['Portuguese'];else{if(_0x64db70[0x0][_0x4861ab(0x210)]==_0x4861ab(0x286))var _0x5487b7=users[_0x4861ab(0x286)];else{if(_0x64db70[0x0]['language']==_0x4861ab(0x21d))var _0x5487b7=users[_0x4861ab(0x21c)];}}}}}}}_0x20518b[_0x4861ab(0x2bf)](_0x4861ab(0x207),{'success':_0x16be83[_0x4861ab(0x21f)](_0x4861ab(0x2f6)),'errors':_0x16be83[_0x4861ab(0x21f)](_0x4861ab(0x243)),'sales':_0x3013c7,'profile':_0x1e8d46,'role':_0x6730f2,'master_shop':_0x64db70,'language':_0x5487b7});}catch(_0x2332fd){console[_0x4861ab(0x2d2)](_0x2332fd);}}),router['get'](a0_0x5cdbc7(0x2bd),auth,async(_0x252275,_0x1055f6)=>{var _0x613421=a0_0x5cdbc7;try{const {username:_0x3011da,email:_0x346b3e,role:_0x34d4fd}=_0x252275[_0x613421(0x2b4)],_0x1f2c7a=_0x252275[_0x613421(0x2b4)],_0x2bdadc=await profile[_0x613421(0x1ff)]({'email':_0x1f2c7a['email']}),_0x302982=await master_shop[_0x613421(0x218)]();let _0x220fd6;if(_0x1f2c7a[_0x613421(0x234)]==_0x613421(0x222)){const _0x130432=await staff[_0x613421(0x1ff)]({'email':_0x1f2c7a['email']});_0x220fd6=await sales_finished[_0x613421(0x25e)]([{'$match':{'typeOfProducts':'logs'}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x613421(0x231),'invoice':{'$first':_0x613421(0x1f3)},'customers':{'$first':_0x613421(0x1e8)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x613421(0x202)},'sale_product':{'$push':_0x613421(0x251)},'note':{'$first':_0x613421(0x2ce)},'return_data':{'$first':_0x613421(0x2af)},'customers_docs':{'$first':_0x613421(0x326)},'total_saleproduct_quantity':{'$sum':_0x613421(0x307)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x613421(0x2f3)},'type':{'$addToSet':_0x613421(0x324)},'pallet':{'$addToSet':_0x613421(0x2cd)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x220fd6=await sales_finished[_0x613421(0x25e)]([{'$match':{'typeOfProducts':_0x613421(0x29a)}},{'$unwind':_0x613421(0x251)},{'$group':{'_id':'$_id','invoice':{'$first':_0x613421(0x1f3)},'customers':{'$first':_0x613421(0x1e8)},'date':{'$first':_0x613421(0x23b)},'warehouse_name':{'$first':_0x613421(0x202)},'sale_product':{'$push':_0x613421(0x251)},'note':{'$first':_0x613421(0x2ce)},'return_data':{'$first':_0x613421(0x2af)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x613421(0x307)},'level':{'$addToSet':_0x613421(0x276)},'isle':{'$addToSet':_0x613421(0x2f3)},'type':{'$addToSet':_0x613421(0x324)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x613421(0x298)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x302982[0x0][_0x613421(0x210)]==_0x613421(0x1f2)){var _0x4f63a7=users[_0x613421(0x299)];console[_0x613421(0x2d2)](_0x4f63a7);}else{if(_0x302982[0x0][_0x613421(0x210)]=='Hindi')var _0x4f63a7=users[_0x613421(0x28a)];else{if(_0x302982[0x0]['language']==_0x613421(0x26c))var _0x4f63a7=users[_0x613421(0x26c)];else{if(_0x302982[0x0][_0x613421(0x210)]==_0x613421(0x2c0))var _0x4f63a7=users[_0x613421(0x2c0)];else{if(_0x302982[0x0][_0x613421(0x210)]==_0x613421(0x1fa))var _0x4f63a7=users[_0x613421(0x1fa)];else{if(_0x302982[0x0][_0x613421(0x210)]=='Portuguese\x20(BR)')var _0x4f63a7=users['Portuguese'];else{if(_0x302982[0x0]['language']==_0x613421(0x286))var _0x4f63a7=users[_0x613421(0x286)];else{if(_0x302982[0x0][_0x613421(0x210)]==_0x613421(0x21d))var _0x4f63a7=users[_0x613421(0x21c)];}}}}}}}_0x1055f6[_0x613421(0x2bf)]('all_sales_finished_logs',{'success':_0x252275[_0x613421(0x21f)](_0x613421(0x2f6)),'errors':_0x252275[_0x613421(0x21f)](_0x613421(0x243)),'sales':_0x220fd6,'profile':_0x2bdadc,'role':_0x1f2c7a,'master_shop':_0x302982,'language':_0x4f63a7});}catch(_0x4047f9){console[_0x613421(0x2d2)](_0x4047f9);}});function a0_0x421a(_0x4dec6c,_0x445ec0){var _0x8b1603=a0_0x8b16();return a0_0x421a=function(_0x421a9f,_0xaebd89){_0x421a9f=_0x421a9f-0x1df;var _0x45d967=_0x8b1603[_0x421a9f];return _0x45d967;},a0_0x421a(_0x4dec6c,_0x445ec0);}async function getRandom8DigitNumber(){var _0x4bc066=a0_0x5cdbc7;const _0x74e144=0x989680,_0x3f9cc8=0x5f5e0ff,_0x4baece=Math['floor'](Math[_0x4bc066(0x292)]()*(_0x3f9cc8-_0x74e144+0x1))+_0x74e144;var _0x35ba99;const _0x49ac6f=await sales_finished[_0x4bc066(0x1ff)]({'invoice':_0x4bc066(0x214)+_0x4baece});return _0x49ac6f&&_0x49ac6f[_0x4bc066(0x316)]>0x0?_0x35ba99=_0x4bc066(0x214)+_0x4baece:_0x35ba99=_0x4bc066(0x214)+_0x4baece,_0x35ba99;}router[a0_0x5cdbc7(0x2b2)](a0_0x5cdbc7(0x31b),auth,async(_0xe61501,_0x3070de)=>{var _0x48b74d=a0_0x5cdbc7;try{const {username:_0x31d540,email:_0x163ccf,role:_0xe0c024}=_0xe61501[_0x48b74d(0x2b4)],_0x30194b=_0xe61501[_0x48b74d(0x2b4)],_0x4e1a2a=await profile[_0x48b74d(0x1ff)]({'email':_0x30194b[_0x48b74d(0x248)]}),_0x19e73c=await master_shop['find'](),_0x465b43=await customer[_0x48b74d(0x218)]({});let _0x19ef96;if(_0x30194b[_0x48b74d(0x234)]==_0x48b74d(0x222)){const _0x43b5c1=await staff[_0x48b74d(0x1ff)]({'email':_0x30194b[_0x48b74d(0x248)]});_0x19ef96=await warehouse[_0x48b74d(0x25e)]([{'$match':{'status':_0x48b74d(0x25a),'name':_0x43b5c1[_0x48b74d(0x30e)]}},{'$group':{'_id':_0x48b74d(0x2c6),'name':{'$first':_0x48b74d(0x2c6)}}},{'$sort':{'name':0x1}}]);}else _0x19ef96=await warehouse[_0x48b74d(0x25e)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x48b74d(0x2c6),'name':{'$first':_0x48b74d(0x2c6)}}},{'$sort':{'name':0x1}}]);const _0x3cf70f=await product[_0x48b74d(0x218)]({});var _0x7f5acf=[_0x48b74d(0x28e),_0x48b74d(0x26b)];const _0x3bf644=await sales_finished[_0x48b74d(0x218)]({}),_0x7af71e=_0x3bf644[_0x48b74d(0x316)]+0x1,_0x5d00bb=_0x48b74d(0x214)+_0x7af71e[_0x48b74d(0x2e3)]()[_0x48b74d(0x24a)](0x5,'0');if(_0x19e73c[0x0][_0x48b74d(0x210)]==_0x48b74d(0x1f2)){var _0x3b1817=users[_0x48b74d(0x299)];console[_0x48b74d(0x2d2)](_0x3b1817);}else{if(_0x19e73c[0x0][_0x48b74d(0x210)]=='Hindi')var _0x3b1817=users[_0x48b74d(0x28a)];else{if(_0x19e73c[0x0][_0x48b74d(0x210)]=='German')var _0x3b1817=users['German'];else{if(_0x19e73c[0x0][_0x48b74d(0x210)]==_0x48b74d(0x2c0))var _0x3b1817=users[_0x48b74d(0x2c0)];else{if(_0x19e73c[0x0][_0x48b74d(0x210)]=='French')var _0x3b1817=users[_0x48b74d(0x1fa)];else{if(_0x19e73c[0x0][_0x48b74d(0x210)]=='Portuguese\x20(BR)')var _0x3b1817=users[_0x48b74d(0x2f2)];else{if(_0x19e73c[0x0][_0x48b74d(0x210)]==_0x48b74d(0x286))var _0x3b1817=users[_0x48b74d(0x286)];else{if(_0x19e73c[0x0][_0x48b74d(0x210)]==_0x48b74d(0x21d))var _0x3b1817=users[_0x48b74d(0x21c)];}}}}}}}const _0x1eeed5=getRandom8DigitNumber();_0x1eeed5['then'](_0x34598b=>{var _0x464d7b=_0x48b74d;_0x3070de[_0x464d7b(0x2bf)](_0x464d7b(0x2f0),{'success':_0xe61501[_0x464d7b(0x21f)]('success'),'errors':_0xe61501['flash'](_0x464d7b(0x243)),'role':_0x30194b,'profile':_0x4e1a2a,'customer':_0x465b43,'warehouse':_0x19ef96,'product':_0x3cf70f,'invoice':_0x34598b,'master_shop':_0x19e73c,'language':_0x3b1817,'rooms_data':_0x7f5acf});})['catch'](_0x33ce28=>{var _0x567eb7=_0x48b74d;_0xe61501[_0x567eb7(0x21f)](_0x567eb7(0x243),_0x567eb7(0x268)),_0x3070de[_0x567eb7(0x2ad)](_0x567eb7(0x228));});}catch(_0x374fdc){console[_0x48b74d(0x2d2)](_0x374fdc);}}),router['get']('/view/add_sales_logs',auth,async(_0x2271a,_0x163666)=>{var _0x1091d3=a0_0x5cdbc7;try{const {username:_0x3c247d,email:_0x4adcc1,role:_0x1a3735}=_0x2271a[_0x1091d3(0x2b4)],_0xe4abf8=_0x2271a[_0x1091d3(0x2b4)],_0x9d10af=await profile[_0x1091d3(0x1ff)]({'email':_0xe4abf8['email']}),_0x4221f6=await master_shop['find'](),_0x4bed01=await customer[_0x1091d3(0x218)]({});let _0x532212;if(_0xe4abf8[_0x1091d3(0x234)]==_0x1091d3(0x222)){const _0x11c7a3=await staff[_0x1091d3(0x1ff)]({'email':_0xe4abf8[_0x1091d3(0x248)]});_0x532212=await warehouse[_0x1091d3(0x25e)]([{'$match':{'status':_0x1091d3(0x25a),'name':_0x11c7a3[_0x1091d3(0x30e)]}},{'$group':{'_id':'$name','name':{'$first':_0x1091d3(0x2c6)}}},{'$sort':{'name':0x1}}]);}else _0x532212=await warehouse[_0x1091d3(0x25e)]([{'$match':{'status':_0x1091d3(0x25a)}},{'$group':{'_id':_0x1091d3(0x2c6),'name':{'$first':_0x1091d3(0x2c6)}}},{'$sort':{'name':0x1}}]);const _0x173b39=await product[_0x1091d3(0x218)]({});var _0x353c12=[_0x1091d3(0x28e),_0x1091d3(0x26b)];const _0x2a5921=await sales_finished['find']({}),_0x516b95=_0x2a5921[_0x1091d3(0x316)]+0x1,_0xc5db81=_0x1091d3(0x214)+_0x516b95['toString']()[_0x1091d3(0x24a)](0x5,'0');if(_0x4221f6[0x0][_0x1091d3(0x210)]==_0x1091d3(0x1f2)){var _0x185153=users[_0x1091d3(0x299)];console[_0x1091d3(0x2d2)](_0x185153);}else{if(_0x4221f6[0x0]['language']==_0x1091d3(0x28a))var _0x185153=users['Hindi'];else{if(_0x4221f6[0x0][_0x1091d3(0x210)]==_0x1091d3(0x26c))var _0x185153=users[_0x1091d3(0x26c)];else{if(_0x4221f6[0x0][_0x1091d3(0x210)]==_0x1091d3(0x2c0))var _0x185153=users[_0x1091d3(0x2c0)];else{if(_0x4221f6[0x0][_0x1091d3(0x210)]==_0x1091d3(0x1fa))var _0x185153=users[_0x1091d3(0x1fa)];else{if(_0x4221f6[0x0]['language']==_0x1091d3(0x2a5))var _0x185153=users[_0x1091d3(0x2f2)];else{if(_0x4221f6[0x0][_0x1091d3(0x210)]==_0x1091d3(0x286))var _0x185153=users[_0x1091d3(0x286)];else{if(_0x4221f6[0x0][_0x1091d3(0x210)]=='Arabic\x20(ae)')var _0x185153=users[_0x1091d3(0x21c)];}}}}}}}const _0x17b353=getRandom8DigitNumber();_0x17b353[_0x1091d3(0x1fb)](_0x3b82b0=>{var _0x56d3e0=_0x1091d3;_0x163666['render'](_0x56d3e0(0x30b),{'success':_0x2271a[_0x56d3e0(0x21f)](_0x56d3e0(0x2f6)),'errors':_0x2271a[_0x56d3e0(0x21f)](_0x56d3e0(0x243)),'role':_0xe4abf8,'profile':_0x9d10af,'customer':_0x4bed01,'warehouse':_0x532212,'product':_0x173b39,'invoice':_0x3b82b0,'master_shop':_0x4221f6,'language':_0x185153,'rooms_data':_0x353c12});})[_0x1091d3(0x20f)](_0x266560=>{var _0x1fae2b=_0x1091d3;_0x2271a[_0x1fae2b(0x21f)](_0x1fae2b(0x243),_0x1fae2b(0x268)),_0x163666[_0x1fae2b(0x2ad)]('/all_sales_finished/view');});}catch(_0xef5644){console[_0x1091d3(0x2d2)](_0xef5644);}}),router[a0_0x5cdbc7(0x2a6)](a0_0x5cdbc7(0x258),auth,async(_0x4f2c8a,_0x20b9ff)=>{var _0x3648d5=a0_0x5cdbc7;try{const {invoice:_0x778268,date:_0x4ae0ee,warehouse_name:_0x51fded,product_name:_0x320713,note:_0x5a92c3,room:_0x1121ff,primary_code:_0x523b08,secondary_code:_0x14cce4,prod_code:_0x9906cf,SCRN:_0x4e47bc,ReqBy:_0x25f0d7,dateofreq:_0x523d78,PO_number:_0x224029,typeservicesData:_0x234d9b,typevehicle:_0x46d39f,destination:_0x341008,deliverydate:_0xa99956,driver:_0x5429c2,plate:_0xeea892,van:_0x269cf2,DRSI:_0x486e61,TSU:_0x54c30a,TFU:_0x57bd49,mode_transpo:_0x3f1142,name_driver:_0x298190,type_of_products:_0x480930}=_0x4f2c8a[_0x3648d5(0x219)];if(typeof _0x320713==_0x3648d5(0x1f1))var _0x232501=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x2a3)]],_0x42cf48=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x221)]],_0x2254c3=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x238)]],_0x397105=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x2a8)]],_0x2ae6b6=[_0x4f2c8a[_0x3648d5(0x219)]['secondary_code']],_0x3fd597=[_0x4f2c8a[_0x3648d5(0x219)]['prod_code']],_0x360dd2=[_0x4f2c8a[_0x3648d5(0x219)]['level2']],_0x13cb97=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x227)]],_0x4e2be7=[_0x4f2c8a[_0x3648d5(0x219)]['secondary_unit']],_0x409d35=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x229)]],_0x21765a=[_0x4f2c8a[_0x3648d5(0x219)]['expiry_date']],_0x16f959=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x23e)]],_0x45adcb=[_0x4f2c8a[_0x3648d5(0x219)]['max_per_unit']],_0x41cad5=[_0x4f2c8a[_0x3648d5(0x219)]['prod_cat']],_0x694ca2=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x2dd)]],_0x6e4b36=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x30f)]],_0x47c2be=[_0x4f2c8a['body']['id_transaction_from']],_0x350fcf=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x281)]],_0x3e657a=[_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x30a)]];else var _0x232501=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x2a3)]],_0x42cf48=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x221)]],_0x2254c3=[..._0x4f2c8a[_0x3648d5(0x219)]['carton']],_0x397105=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x2a8)]],_0x2ae6b6=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x24c)]],_0x3fd597=[..._0x4f2c8a[_0x3648d5(0x219)]['prod_code']],_0x360dd2=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x328)]],_0x13cb97=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x227)]],_0x4e2be7=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x320)]],_0x409d35=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x229)]],_0x21765a=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x1ed)]],_0x16f959=[..._0x4f2c8a['body'][_0x3648d5(0x23e)]],_0x45adcb=[..._0x4f2c8a['body'][_0x3648d5(0x237)]],_0x41cad5=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x279)]],_0x694ca2=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x2dd)]],_0x6e4b36=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x30f)]],_0x47c2be=[..._0x4f2c8a[_0x3648d5(0x219)]['id_transaction_from']],_0x350fcf=[..._0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x281)]],_0x3e657a=[..._0x4f2c8a[_0x3648d5(0x219)]['gross_price']];const _0xf1ab6=_0x232501[_0x3648d5(0x25d)](_0x5acc0f=>{return _0x5acc0f={'product_name':_0x5acc0f};});_0x42cf48[_0x3648d5(0x27b)]((_0x20ca94,_0x309f8a)=>{var _0x1198cb=_0x3648d5;_0xf1ab6[_0x309f8a][_0x1198cb(0x221)]=_0x20ca94;}),_0x2254c3[_0x3648d5(0x27b)]((_0x3686c2,_0x4f77d7)=>{var _0x39b2fa=_0x3648d5;_0xf1ab6[_0x4f77d7]['quantity']=Math[_0x39b2fa(0x1f6)](_0x3686c2);}),_0x232501['forEach']((_0xccaaa1,_0xee4a93)=>{var _0x4097ce=_0x3648d5;_0xf1ab6[_0xee4a93][_0x4097ce(0x295)]=_0x4f2c8a['body'][_0x4097ce(0x232)];}),_0x3e657a['forEach']((_0xee738e,_0x140a22)=>{_0xf1ab6[_0x140a22]['gross_price']=_0xee738e;}),_0x350fcf[_0x3648d5(0x27b)]((_0x40c80c,_0x17d363)=>{var _0x444914=_0x3648d5;_0xf1ab6[_0x17d363][_0x444914(0x281)]=_0x40c80c;}),_0x47c2be['forEach']((_0x1e1b19,_0xa8c678)=>{var _0xe3fa6b=_0x3648d5;_0xf1ab6[_0xa8c678][_0xe3fa6b(0x2e8)]=_0x1e1b19;}),_0x397105['forEach']((_0x4f2d0d,_0x533abb)=>{var _0x477ea1=_0x3648d5;_0xf1ab6[_0x533abb][_0x477ea1(0x2a8)]=_0x4f2d0d;}),_0x2ae6b6[_0x3648d5(0x27b)]((_0x575529,_0x36b793)=>{_0xf1ab6[_0x36b793]['secondary_code']=_0x575529;}),_0x3fd597['forEach']((_0x5962a4,_0x101d98)=>{_0xf1ab6[_0x101d98]['product_code']=_0x5962a4;}),_0x360dd2['forEach']((_0xf41b5e,_0x4c2250)=>{var _0x53cd97=_0x3648d5,_0x8a01f0=_0xf41b5e[_0x53cd97(0x1ef)](/[A-Za-z]+/)[0x0],_0x61514b=parseInt(_0xf41b5e[_0x53cd97(0x1ef)](/\d+/)[0x0]);_0xf1ab6[_0x4c2250][_0x53cd97(0x23a)]=_0x61514b,_0xf1ab6[_0x4c2250]['level']=_0x8a01f0;}),_0x13cb97[_0x3648d5(0x27b)]((_0x7ee12f,_0x5ba8c9)=>{var _0x29f7e9=_0x3648d5;_0xf1ab6[_0x5ba8c9][_0x29f7e9(0x273)]=_0x7ee12f;}),_0x4e2be7[_0x3648d5(0x27b)]((_0x450925,_0xb1187)=>{var _0x10652f=_0x3648d5;_0xf1ab6[_0xb1187][_0x10652f(0x320)]=_0x450925;}),_0x409d35[_0x3648d5(0x27b)]((_0x7ae25c,_0x4c20d7)=>{var _0x5b2843=_0x3648d5;_0xf1ab6[_0x4c20d7][_0x5b2843(0x229)]=_0x7ae25c;}),_0x21765a['forEach']((_0x16b8f2,_0xdf0028)=>{var _0x16808d=_0x3648d5;_0xf1ab6[_0xdf0028][_0x16808d(0x1ed)]=_0x16b8f2;}),_0x16f959[_0x3648d5(0x27b)]((_0x262232,_0x411485)=>{var _0x5845ae=_0x3648d5;_0xf1ab6[_0x411485][_0x5845ae(0x264)]=_0x262232;}),_0x45adcb[_0x3648d5(0x27b)]((_0x366a3b,_0x325e0c)=>{var _0x3dbc00=_0x3648d5;_0xf1ab6[_0x325e0c][_0x3dbc00(0x2d5)]=_0x366a3b;}),_0x41cad5[_0x3648d5(0x27b)]((_0x57a27b,_0xe8249)=>{_0xf1ab6[_0xe8249]['prod_cat']=_0x57a27b;}),_0x694ca2['forEach']((_0x5f1ded,_0x5b31f8)=>{_0xf1ab6[_0x5b31f8]['room_name']=_0x5f1ded;}),_0x6e4b36[_0x3648d5(0x27b)]((_0x51c3ae,_0x102e53)=>{var _0xad0500=_0x3648d5;_0xf1ab6[_0x102e53][_0xad0500(0x24b)]=_0x51c3ae,_0xf1ab6[_0x102e53][_0xad0500(0x310)]=_0x4ae0ee;});const _0x2413f0=new sales_logs();await _0x2413f0['save'](),_0x6e4b36[_0x3648d5(0x27b)]((_0x3f2aaa,_0x6f2b88)=>{var _0x3eb3d8=_0x3648d5;_0xf1ab6[_0x6f2b88]['outgoing_invoice']='LOG-OUT-'+_0x2413f0[_0x3eb3d8(0x259)]['toString']()[_0x3eb3d8(0x24a)](0x8,'0');});var _0x1be5c9=0x0;_0xf1ab6[_0x3648d5(0x27b)](_0x4dbc27=>{var _0x130d34=_0x3648d5;parseFloat(_0x4dbc27[_0x130d34(0x221)])<parseFloat(_0x4dbc27[_0x130d34(0x2f8)])&&parseFloat(_0x4dbc27[_0x130d34(0x2f8)])>parseFloat(_0x4dbc27[_0x130d34(0x221)])&&(console[_0x130d34(0x2d2)](_0x4dbc27[_0x130d34(0x221)]+'\x20<>\x20'+_0x4dbc27[_0x130d34(0x2f8)]),_0x1be5c9++);});if(_0x1be5c9!=0x0)return _0x4f2c8a[_0x3648d5(0x21f)](_0x3648d5(0x243),_0x3648d5(0x322)),_0x20b9ff['redirect']('back');const _0xbd687e=_0xf1ab6['filter'](_0x138558=>_0x138558['quantity']!=='0'&&_0x138558[_0x3648d5(0x2f8)]!==''),_0x3a5cda=new sales_finished({'invoice':_0x3648d5(0x26f)+_0x2413f0[_0x3648d5(0x259)][_0x3648d5(0x2e3)]()['padStart'](0x8,'0'),'sales_data':_0x4f2c8a[_0x3648d5(0x219)][_0x3648d5(0x232)],'customer':_0x4f2c8a[_0x3648d5(0x219)]['customer'],'date':_0x4ae0ee,'warehouse_name':_0x51fded,'sale_product':_0xbd687e,'note':_0x5a92c3,'room':_0x1121ff,'primary_code':_0x523b08,'secondary_code':_0x14cce4,'prod_code':_0x9906cf,'SCRN':_0x4e47bc,'finalize':'False','mode_transpo':_0x3f1142,'name_driver':_0x298190,'ReqBy':_0x25f0d7,'dateofreq':_0x523d78,'PO_number':_0x224029,'typeservicesData':_0x234d9b,'typevehicle':_0x46d39f,'destination':_0x341008,'deliverydate':_0xa99956,'driver':_0x5429c2,'plate':_0xeea892,'van':_0x269cf2,'DRSI':_0x486e61,'TSU':_0x54c30a,'TFU':_0x57bd49,'typeOfProducts':_0x480930}),_0x2c3736=await _0x3a5cda['save'](),_0x34892e=await sales_finished['findOne']({'invoice':_0x778268});_0x4f2c8a[_0x3648d5(0x21f)]('success',_0x3648d5(0x20b)),_0x20b9ff[_0x3648d5(0x2ad)]('/all_sales_finished/preview/'+_0x2c3736[_0x3648d5(0x26e)]);}catch(_0x410ab6){console['log'](_0x410ab6);}}),router[a0_0x5cdbc7(0x2b2)](a0_0x5cdbc7(0x1f4),auth,async(_0x46d8c7,_0x11392f)=>{var _0x4df2b1=a0_0x5cdbc7;try{const _0x3c9e16=_0x46d8c7[_0x4df2b1(0x1ee)]['id'];console['log'](_0x3c9e16);const _0x3e42dd=await product[_0x4df2b1(0x218)](),_0x9fa39f=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3c9e16}},{'$unwind':_0x4df2b1(0x293)},{'$group':{'_id':'$product.product_name'}}]);console['log'](_0x4df2b1(0x28f),_0x9fa39f),_0x11392f[_0x4df2b1(0x2be)](0xc8)['json']({'purchases_data':_0x9fa39f,'product_data':_0x3e42dd});}catch(_0x156bcf){console[_0x4df2b1(0x2d2)](_0x156bcf);}}),router[a0_0x5cdbc7(0x2a6)](a0_0x5cdbc7(0x2f7),auth,async(_0x37fa8f,_0xf01dc0)=>{var _0x33517a=a0_0x5cdbc7;try{const {warehouse_data:_0xe2e280,product_data:_0x30441c}=_0x37fa8f[_0x33517a(0x219)];console[_0x33517a(0x2d2)](_0x37fa8f['body']['product_data']);;const _0x593ae6=await master_shop['find']();console[_0x33517a(0x2d2)](_0x33517a(0x20a),_0x593ae6);const _0x1816b0=await product[_0x33517a(0x1ff)]({'name':_0x30441c});console['log'](_0x33517a(0x1df),_0x1816b0);const _0x18efe5=await warehouse['aggregate']([{'$match':{'name':_0xe2e280}},{'$unwind':_0x33517a(0x2d8)},{'$match':{'product_details.product_name':_0x30441c}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x33517a(0x25f)}}}]);console['log'](_0x33517a(0x284),_0x18efe5),_0xf01dc0[_0x33517a(0x2be)](0xc8)[_0x33517a(0x296)]({'master':_0x593ae6,'new_product':_0x1816b0,'stock_data':_0x18efe5});}catch(_0x1011d2){console[_0x33517a(0x2d2)](_0x1011d2);}}),router[a0_0x5cdbc7(0x2a6)](a0_0x5cdbc7(0x31b),auth,async(_0x2b3688,_0x540cc1)=>{var _0x52adb1=a0_0x5cdbc7;try{const {invoice:_0x55d5fe,date:_0x479530,warehouse_name:_0x53dd17,product_name:_0x466f86,note:_0x98c7b5,room:_0x18bd0c,primary_code:_0x392971,secondary_code:_0x575d3c,prod_code:_0x1c19b5,SCRN:_0x499b8b,ReqBy:_0x588181,dateofreq:_0x123996,PO_number:_0x2bd6cf,typeservicesData:_0x513e2c,typevehicle:_0x92a4e6,destination:_0x49f5fc,deliverydate:_0x3f1e21,driver:_0x1b394b,plate:_0x4f8d6f,van:_0x4609c7,DRSI:_0x291253,TSU:_0x5330b0,TFU:_0x4e1190,mode_transpo:_0x49a265,name_driver:_0xa9561c,pull_out_date:_0x39b34d,actual_delivery_date:_0x14fa5e}=_0x2b3688[_0x52adb1(0x219)];_0x540cc1[_0x52adb1(0x296)](_0x2b3688[_0x52adb1(0x219)]);return;if(typeof _0x466f86==_0x52adb1(0x1f1))var _0x2a7dfe=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x2a3)]],_0x1f2bef=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x221)]],_0x32d7ce=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x238)]],_0x1f1360=[_0x2b3688[_0x52adb1(0x219)]['primary_code']],_0x396446=[_0x2b3688['body'][_0x52adb1(0x24c)]],_0xef8652=[_0x2b3688['body'][_0x52adb1(0x2f1)]],_0x576a0c=[_0x2b3688['body'][_0x52adb1(0x328)]],_0xf32184=[_0x2b3688[_0x52adb1(0x219)]['primary_unit']],_0x31e10f=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x320)]],_0x1226fa=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x229)]],_0x114a0d=[_0x2b3688[_0x52adb1(0x219)]['expiry_date']],_0x1ee301=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x23e)]],_0x2fc670=[_0x2b3688['body'][_0x52adb1(0x237)]],_0x21bc98=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x279)]],_0x168248=[_0x2b3688['body'][_0x52adb1(0x2dd)]],_0x4a2956=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x30f)]],_0x44e6b3=[_0x2b3688['body'][_0x52adb1(0x2e8)]],_0x3d04f1=[_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x281)]],_0x516d33=[_0x2b3688[_0x52adb1(0x219)]['gross_price']];else var _0x2a7dfe=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x2a3)]],_0x1f2bef=[..._0x2b3688[_0x52adb1(0x219)]['stock']],_0x32d7ce=[..._0x2b3688['body'][_0x52adb1(0x238)]],_0x1f1360=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x2a8)]],_0x396446=[..._0x2b3688['body']['secondary_code']],_0xef8652=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x2f1)]],_0x576a0c=[..._0x2b3688['body'][_0x52adb1(0x328)]],_0xf32184=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x227)]],_0x31e10f=[..._0x2b3688[_0x52adb1(0x219)]['secondary_unit']],_0x1226fa=[..._0x2b3688['body'][_0x52adb1(0x229)]],_0x114a0d=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x1ed)]],_0x1ee301=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x23e)]],_0x2fc670=[..._0x2b3688['body']['max_per_unit']],_0x21bc98=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x279)]],_0x168248=[..._0x2b3688['body'][_0x52adb1(0x2dd)]],_0x4a2956=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x30f)]],_0x44e6b3=[..._0x2b3688[_0x52adb1(0x219)]['id_transaction_from']],_0x3d04f1=[..._0x2b3688['body'][_0x52adb1(0x281)]],_0x516d33=[..._0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x30a)]];const _0x4a8777=_0x2a7dfe[_0x52adb1(0x25d)](_0x2ff92f=>{return _0x2ff92f={'product_name':_0x2ff92f};});_0x1f2bef['forEach']((_0x4f75ca,_0x194bab)=>{var _0x5a568e=_0x52adb1;_0x4a8777[_0x194bab][_0x5a568e(0x221)]=_0x4f75ca;}),_0x32d7ce[_0x52adb1(0x27b)]((_0x44af17,_0x4c1fb1)=>{var _0x545e56=_0x52adb1;_0x4a8777[_0x4c1fb1]['quantity']=Math[_0x545e56(0x1f6)](_0x44af17);}),_0x2a7dfe['forEach']((_0x2a968d,_0x35e7d7)=>{var _0x5ba48b=_0x52adb1;_0x4a8777[_0x35e7d7]['agent_id']=_0x2b3688[_0x5ba48b(0x219)]['sales'];}),_0x516d33[_0x52adb1(0x27b)]((_0x310900,_0x37086e)=>{var _0x310bd4=_0x52adb1;_0x4a8777[_0x37086e][_0x310bd4(0x30a)]=_0x310900;}),_0x3d04f1['forEach']((_0x5ba8f9,_0x1d94f5)=>{var _0xbd2a0d=_0x52adb1;_0x4a8777[_0x1d94f5][_0xbd2a0d(0x281)]=_0x5ba8f9;}),_0x44e6b3[_0x52adb1(0x27b)]((_0x3398ed,_0x51e3f9)=>{var _0x492be6=_0x52adb1;_0x4a8777[_0x51e3f9][_0x492be6(0x2e8)]=_0x3398ed;}),_0x1f1360['forEach']((_0x9a9423,_0x4e3fc9)=>{var _0x13cc81=_0x52adb1;_0x4a8777[_0x4e3fc9][_0x13cc81(0x2a8)]=_0x9a9423;}),_0x396446[_0x52adb1(0x27b)]((_0x8e007c,_0x343128)=>{_0x4a8777[_0x343128]['secondary_code']=_0x8e007c;}),_0xef8652['forEach']((_0x27f698,_0x2533df)=>{var _0x4e0f63=_0x52adb1;_0x4a8777[_0x2533df][_0x4e0f63(0x2b9)]=_0x27f698;}),_0x576a0c['forEach']((_0x5bd18a,_0x20337e)=>{var _0x3184de=_0x52adb1,_0x43b65c=_0x5bd18a['match'](/[A-Za-z]+/)[0x0],_0x4c32b4=parseInt(_0x5bd18a[_0x3184de(0x1ef)](/\d+/)[0x0]);_0x4a8777[_0x20337e]['bay']=_0x4c32b4,_0x4a8777[_0x20337e]['level']=_0x43b65c;}),_0xf32184['forEach']((_0x44e12b,_0x1fc8ca)=>{var _0x2498ce=_0x52adb1;_0x4a8777[_0x1fc8ca][_0x2498ce(0x273)]=_0x44e12b;}),_0x31e10f['forEach']((_0x2566d8,_0x53cf76)=>{var _0x3c6fa9=_0x52adb1;_0x4a8777[_0x53cf76][_0x3c6fa9(0x320)]=_0x2566d8;}),_0x1226fa[_0x52adb1(0x27b)]((_0x331666,_0x3ad170)=>{var _0x48a893=_0x52adb1;_0x4a8777[_0x3ad170][_0x48a893(0x229)]=_0x331666;}),_0x114a0d[_0x52adb1(0x27b)]((_0xcc290b,_0x2247a5)=>{var _0x112206=_0x52adb1;_0x4a8777[_0x2247a5][_0x112206(0x1ed)]=_0xcc290b;}),_0x1ee301['forEach']((_0x3b2e54,_0x57fcfa)=>{var _0x116033=_0x52adb1;_0x4a8777[_0x57fcfa][_0x116033(0x264)]=_0x3b2e54;}),_0x2fc670[_0x52adb1(0x27b)]((_0x2e66b2,_0x1f88c6)=>{var _0x46a0d2=_0x52adb1;_0x4a8777[_0x1f88c6][_0x46a0d2(0x2d5)]=_0x2e66b2;}),_0x21bc98[_0x52adb1(0x27b)]((_0x2f7c89,_0xd722b5)=>{var _0x20fb2f=_0x52adb1;_0x4a8777[_0xd722b5][_0x20fb2f(0x279)]=_0x2f7c89;}),_0x168248[_0x52adb1(0x27b)]((_0x179b67,_0x2b176a)=>{var _0x2c863e=_0x52adb1;_0x4a8777[_0x2b176a][_0x2c863e(0x314)]=_0x179b67;}),_0x4a2956[_0x52adb1(0x27b)]((_0x6a642d,_0x453213)=>{var _0x209326=_0x52adb1;_0x4a8777[_0x453213][_0x209326(0x24b)]=_0x6a642d,_0x4a8777[_0x453213][_0x209326(0x310)]=_0x479530;});const _0x394c15=new invoice_for_outgoing();await _0x394c15['save'](),_0x4a2956[_0x52adb1(0x27b)]((_0x3a0a25,_0x31de20)=>{var _0x230da0=_0x52adb1;_0x4a8777[_0x31de20][_0x230da0(0x275)]=_0x230da0(0x233)+_0x394c15[_0x230da0(0x259)][_0x230da0(0x2e3)]()[_0x230da0(0x24a)](0x8,'0');});var _0x299072=0x0;_0x4a8777[_0x52adb1(0x27b)](_0x49f7bd=>{var _0x358c45=_0x52adb1;parseFloat(_0x49f7bd[_0x358c45(0x221)])<parseFloat(_0x49f7bd[_0x358c45(0x2f8)])&&parseFloat(_0x49f7bd[_0x358c45(0x2f8)])>parseFloat(_0x49f7bd[_0x358c45(0x221)])&&(console['log'](_0x49f7bd[_0x358c45(0x221)]+'\x20<>\x20'+_0x49f7bd[_0x358c45(0x2f8)]),_0x299072++);});if(_0x299072!=0x0)return _0x2b3688[_0x52adb1(0x21f)]('errors',_0x52adb1(0x322)),_0x540cc1['redirect'](_0x52adb1(0x304));const _0x45c4f6=_0x4a8777[_0x52adb1(0x308)](_0x3177d5=>_0x3177d5[_0x52adb1(0x2f8)]!=='0'&&_0x3177d5['quantity']!==''),_0x39fd30=new sales_finished({'invoice':_0x52adb1(0x233)+_0x394c15['invoice_init'][_0x52adb1(0x2e3)]()[_0x52adb1(0x24a)](0x8,'0'),'sales_data':_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x232)],'customer':_0x2b3688[_0x52adb1(0x219)][_0x52adb1(0x32c)],'date':_0x479530,'warehouse_name':_0x53dd17,'sale_product':_0x45c4f6,'note':_0x98c7b5,'room':_0x18bd0c,'primary_code':_0x392971,'secondary_code':_0x575d3c,'prod_code':_0x1c19b5,'SCRN':_0x499b8b,'finalize':_0x52adb1(0x321),'mode_transpo':_0x49a265,'name_driver':_0xa9561c,'ReqBy':_0x588181,'dateofreq':_0x123996,'PO_number':_0x2bd6cf,'typeservicesData':_0x513e2c,'typevehicle':_0x92a4e6,'destination':_0x49f5fc,'deliverydate':_0x3f1e21,'driver':_0x1b394b,'plate':_0x4f8d6f,'van':_0x4609c7,'DRSI':_0x291253,'TSU':_0x5330b0,'TFU':_0x4e1190,'pullout_date':_0x39b34d,'actualdelivery_date':_0x14fa5e,'typeOfProducts':_0x52adb1(0x1e7)}),_0x24111d=await _0x39fd30[_0x52adb1(0x2b1)](),_0x1183fe=await sales_finished[_0x52adb1(0x1ff)]({'invoice':_0x55d5fe});_0x2b3688[_0x52adb1(0x21f)](_0x52adb1(0x2f6),'Sales\x20Add\x20successfully'),_0x540cc1[_0x52adb1(0x2ad)](_0x52adb1(0x2a1)+_0x24111d[_0x52adb1(0x26e)]);}catch(_0x4a5e1){console[_0x52adb1(0x2d2)](_0x4a5e1);}}),router[a0_0x5cdbc7(0x2b2)](a0_0x5cdbc7(0x297),auth,async(_0x50d170,_0x27c2b4)=>{var _0x176890=a0_0x5cdbc7;try{const {username:_0xd3a953,email:_0x3622c3,role:_0x44490a}=_0x50d170[_0x176890(0x2b4)],_0x492bb6=_0x50d170[_0x176890(0x2b4)],_0x3511c5=await profile[_0x176890(0x1ff)]({'email':_0x492bb6['email']}),_0x30f959=await master_shop['find'](),_0x11f5eb=_0x50d170[_0x176890(0x1ee)]['id'],_0x294cc4=await sales_finished[_0x176890(0x2c7)](_0x11f5eb),_0x199d50=await warehouse[_0x176890(0x25e)]([{'$match':{'name':_0x294cc4[_0x176890(0x1f7)]}},{'$unwind':_0x176890(0x2d8)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x176890(0x2ca)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x176890(0x261)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x176890(0x31e)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x176890(0x1e9)},'production_date':{'$first':_0x176890(0x2fc)},'batch_code':{'$first':_0x176890(0x2e2)},'room':{'$first':_0x176890(0x2d6)},'room_data':{'$first':_0x176890(0x29f)}}}]),_0x2d978f=await customer[_0x176890(0x218)]({});let _0x24f15c;if(_0x492bb6[_0x176890(0x234)]==_0x176890(0x222)){const _0x34fb60=await staff['findOne']({'email':_0x492bb6['email']});_0x24f15c=await warehouse[_0x176890(0x25e)]([{'$match':{'status':_0x176890(0x25a),'name':_0x34fb60[_0x176890(0x30e)]}},{'$group':{'_id':'$name','name':{'$first':_0x176890(0x2c6)}}}]);}else _0x24f15c=await warehouse['aggregate']([{'$match':{'status':_0x176890(0x25a)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x3961a0=await product[_0x176890(0x218)]({});if(_0x30f959[0x0][_0x176890(0x210)]=='English\x20(US)'){var _0x334c95=users[_0x176890(0x299)];console[_0x176890(0x2d2)](_0x334c95);}else{if(_0x30f959[0x0][_0x176890(0x210)]==_0x176890(0x28a))var _0x334c95=users[_0x176890(0x28a)];else{if(_0x30f959[0x0][_0x176890(0x210)]==_0x176890(0x26c))var _0x334c95=users['German'];else{if(_0x30f959[0x0][_0x176890(0x210)]==_0x176890(0x2c0))var _0x334c95=users[_0x176890(0x2c0)];else{if(_0x30f959[0x0][_0x176890(0x210)]==_0x176890(0x1fa))var _0x334c95=users['French'];else{if(_0x30f959[0x0][_0x176890(0x210)]=='Portuguese\x20(BR)')var _0x334c95=users[_0x176890(0x2f2)];else{if(_0x30f959[0x0]['language']==_0x176890(0x286))var _0x334c95=users[_0x176890(0x286)];else{if(_0x30f959[0x0][_0x176890(0x210)]==_0x176890(0x21d))var _0x334c95=users[_0x176890(0x21c)];}}}}}}}_0x27c2b4[_0x176890(0x2bf)]('edit_sales_finished_view',{'success':_0x50d170[_0x176890(0x21f)](_0x176890(0x2f6)),'errors':_0x50d170['flash'](_0x176890(0x243)),'role':_0x492bb6,'profile':_0x3511c5,'customer':_0x2d978f,'warehouse':_0x24f15c,'product':_0x199d50,'user':_0x294cc4,'master_shop':_0x30f959,'unit':_0x3961a0,'language':_0x334c95});}catch(_0x131853){console[_0x176890(0x2d2)](_0x131853);}});async function dataUpdate(_0x20f742,_0x1ec8f5,_0x410d5d){var _0x39b61d=a0_0x5cdbc7;return await warehouse[_0x39b61d(0x249)]({'_id':_0x20f742,'product_details._id':_0x1ec8f5},{'$set':{'product_details.$.product_stock':_0x410d5d}}),await warehouse[_0x39b61d(0x2c7)](_0x20f742);}function a0_0x8b16(){var _0x171c9d=['</body></html>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','prod_cat','65GmZzlQ','forEach','maxPerUnit','stocks_QA','Error\x20Occurs','$alertquantity','Finished\x20Goods','uuid','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','return_sale_finished','stock_data','/upload/','Chinese','$product_details.unit','currency','Sale\x20Return','Hindi','foreach\x20newproduct','8alLtdb','sendMail','Ambient','purchases_data','There\x20is\x20','finalize','random','$product','</td>','agent_id','json','/preview/:id','$finalize','English','logs','$product_code','<html><head><title></title>','message','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$product_details.room_name','<span\x20style=\x22float:\x20right;\x22>','/all_sales_finished/preview/','final','product_name','name','Portuguese\x20(BR)','post','sale_qty','primary_code','/all_sales/view','product_name_QA1','$brand','Sale\x20Return\x20Mail','redirect','$product_details.maxPerUnit','$return_data','$product_details.type','save','get','../models/all_models','user','../public/language/languages.json','</div>','return_data','secondary_code_QA','product_code','product_id','$product_details.product_name','<tr>','/view_log','status','render','Spanish','/barcode_scanner','product_code_QA','12576810dNVkHb','$product_details.floorlevel','/picking_list/pdf/','$name','findById','</table>','$primary_code','$product_details.bin','site_title','batch_code_QA','$sale_product.floorlevel','$note','$gross_price','min','warehouse_id_detl','log','$maxStocks','<div>','maxperunit','$room','maxProdPerUnit','$product_details','$product_details.type_products','</thead>','Distributing\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','RoomAssigned','$product_details.storage','false','Logo.png','maxPerUnit_QA','$product_details.batch_code','toString','valueOf','\x20Date:\x20','<!DOCTYPE\x20html>','data_type','id_transaction_from','$product_details.sales_category','\x20Order\x20Date\x20:\x20','received_amount','exports','return_sale_QA','return_qty_QA','second_unit','add_sales_finished','prod_code','Portuguese','$sale_product.bin','8481624eBlduA','secondary_unit_QA','success','/view/add_sale/product','quantity','$secondary_unit','$product_details._id','<hr\x20class=\x22my-3\x22>','$product_details.production_date','Router','product_list','customer_data','sales\x20item\x20return\x20successfull','\x20</h2>','1006116ElQcUO','sales_quantity','back','22377mZDrGg','$sales_category','$sale_product.quantity','filter','push','gross_price','add_sales_finished_logs','password','$secondary_code','warehouse','prod_invoice','date_data','adjust_qty','level','split','room_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','length','$unit','getDate','$product_details.gross_price','expiry_date_QA','/view/add_sales','$product_details.rack','\x20<>\x20','$product_details.product_code','concat','secondary_unit','False','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','product_details','$sale_product.type','sales_category','$customers_docs','/barcode/:id','level2','/barcode_scanner_auto_data','\x20Order\x20Number\x20:\x20','Sales\x20Update\x20successfully','customer','primary_code_QA','sales_id','Received\x20Payment\x20For\x20Sale','product','return_qty','9313497VbKIFC','out','<h2>\x20','warehouse_id','gmail','sales_invoice','own','$customer','$product_details.expiry_date','standard_unit','production_date_QA','max','expiry_date','params','match','</h5>','string','English\x20(US)','$invoice','/view/add_sales/:id','createTransport','abs','warehouse_name','group_ids','$product_details.level','French','then','product_cat','</head><body>','sort','findOne','\x20==\x20','room','$warehouse_name','$product_details.maxProducts','all_sales_barcode','date_received','$product_details.secondary_code','all_sales_finished','here','\x20units\x20to\x20warehouse:\x20','master','Sales\x20Add\x20successfully','../middleware/auth','sales_quantity_QA','unit_QA','catch','language','roomNamed','maxStocks','\x20Name:\x20','OUTF-','/view/:id','for_categorize','Return\x20Goods','find','body','</span>','true','Arabic','Arabic\x20(ae)','barcode\x20Product\x20master','flash','amount','stock','staff','$product_details.uuid','/barcode_scanner_logs','all','/invoice/:id','primary_unit','/all_sales_finished/view','batch_code','<h5\x20style=\x22text-align:\x20left;\x22>','product_stock','$category','getFullYear','$product_details.product_cat','getMonth','/process/view','$_id','sales','OUT-','role','date_recieved','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','max_per_unit','carton','745381WJbTsC','bay','$date','Return\x20Rooms',',\x20room:\x20','product_date','slice','sale_product','$product_details.invoice','express','errors',',\x20Location:\x20','\x20&&\x20','Email\x20sent\x20successfully','11RcDIgI','email','updateOne','padStart','invoice','secondary_code','True','/../public','$product_details.bay','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$sale_product','244rcXRDH','image','maxProducts','/view/return_sales/:id','due_amount','mongoose','/view/add_sales_logs','invoice_init','Enabled','</tr>','maxProducts_QA','map','aggregate','$product_details.product_stock','10PuvnTO','$product_details.primary_code','1020caHmGZ','outgoiug_inv','production_date','ObjectId','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<strong>\x20Regards\x20</strong>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','2501iPCtzO','$product_details.secondary_unit','Enclosed','German','<tbody\x20style=\x22text-align:\x20center;\x22>','_id','LOG-OUT-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','logo','undefined','unit','suppliers','outgoing_invoice','$sale_product.bay'];a0_0x8b16=function(){return _0x171c9d;};return a0_0x8b16();}router[a0_0x5cdbc7(0x2a6)](a0_0x5cdbc7(0x297),auth,async(_0x21dc84,_0x182169)=>{var _0x53c756=a0_0x5cdbc7;try{const _0xfbbd79=_0x21dc84[_0x53c756(0x1ee)]['id'],{invoice:_0x36e146,warehouse_name:_0x74c833,room:_0x388e7f}=_0x21dc84['body'],_0x129476=await sales_finished['findOne']({'invoice':_0x36e146});for(let _0xe91eb8=0x0;_0xe91eb8<=_0x129476[_0x53c756(0x240)][_0x53c756(0x316)]-0x1;_0xe91eb8++){const _0x15f0e7=_0x129476[_0x53c756(0x240)][_0xe91eb8];var _0x44c917=await warehouse[_0x53c756(0x1ff)]({'name':_0x74c833,'room':_0x15f0e7[_0x53c756(0x314)]}),_0x10629f=0x0;for(let _0x5631ed=0x0;_0x5631ed<=_0x44c917['product_details']['length']-0x1;_0x5631ed++){const _0x1ec85a=_0x44c917[_0x53c756(0x323)][_0x5631ed];_0x1ec85a[_0x53c756(0x26e)]==_0x15f0e7[_0x53c756(0x2e8)]&&_0x1ec85a[_0x53c756(0x281)]==_0x15f0e7[_0x53c756(0x281)]&&(_0x10629f=Math[_0x53c756(0x1ec)](0x0,Math[_0x53c756(0x1f6)](_0x1ec85a['product_stock'])-Math[_0x53c756(0x1f6)](_0x15f0e7[_0x53c756(0x2f8)])),await warehouse[_0x53c756(0x249)]({'_id':_0x44c917[_0x53c756(0x26e)][_0x53c756(0x2e4)](),'product_details._id':_0x1ec85a['_id'][_0x53c756(0x2e4)](),'product_details.uuid':_0x15f0e7[_0x53c756(0x281)]},{'$set':{'product_details.$.product_stock':_0x10629f}}));}console[_0x53c756(0x2d2)](typeof _0x15f0e7['agent_id']);if(typeof _0x15f0e7['agent_id']!==_0x53c756(0x272)){var _0x4486bd=await staff['findById'](_0x15f0e7[_0x53c756(0x295)]);console[_0x53c756(0x2d2)](_0x53c756(0x208));var _0x35a452=0x0;for(let _0x137445=0x0;_0x137445<=_0x4486bd['product_list'][_0x53c756(0x316)]-0x1;_0x137445++){const _0x40d760=_0x4486bd[_0x53c756(0x2fe)][_0x137445];console['log'](_0x15f0e7[_0x53c756(0x2e8)]+'\x20==\x20'+_0x40d760[_0x53c756(0x1e4)]+_0x53c756(0x245)+_0x15f0e7[_0x53c756(0x26e)]+_0x53c756(0x200)+_0x15f0e7[_0x53c756(0x26e)]),_0x15f0e7[_0x53c756(0x2e8)]==_0x40d760[_0x53c756(0x1e4)]&&_0x15f0e7[_0x53c756(0x26e)]==0x1&&(_0x40d760[_0x53c756(0x22b)]=Math[_0x53c756(0x1f6)](_0x40d760['product_stock'])+Math[_0x53c756(0x1f6)](_0x15f0e7['quantity']),_0x35a452++);}console[_0x53c756(0x2d2)]('int',_0x35a452),_0x35a452=='0'&&(_0x4486bd[_0x53c756(0x2fe)]=_0x4486bd[_0x53c756(0x2fe)][_0x53c756(0x31f)]({'product_name':_0x15f0e7['product_name'],'product_stock':_0x15f0e7['quantity'],'bay':_0x15f0e7[_0x53c756(0x23a)],'level':_0x15f0e7[_0x53c756(0x312)],'product_code':_0x15f0e7['product_code'],'primary_code':_0x15f0e7[_0x53c756(0x2a8)],'secondary_code':_0x15f0e7['secondary_code'],'expiry_date':_0x15f0e7['expiry_date'],'production_date':_0x15f0e7[_0x53c756(0x264)],'maxProducts':_0x15f0e7[_0x53c756(0x254)],'batch_code':_0x15f0e7[_0x53c756(0x229)],'secondary_unit':_0x15f0e7[_0x53c756(0x320)],'unit':_0x15f0e7[_0x53c756(0x273)],'maxProducts':_0x15f0e7[_0x53c756(0x254)],'maxPerUnit':_0x15f0e7[_0x53c756(0x2d5)],'invoice':_0x15f0e7[_0x53c756(0x24b)],'warehouse_id':_0x15f0e7['id_transaction_from'],'id_incoming':_0x15f0e7[_0x53c756(0x26e)],'uuid':_0x15f0e7['uuid'],'gross_price':_0x15f0e7[_0x53c756(0x30a)],'date_incoming':_0x15f0e7[_0x53c756(0x310)],'outgoing_invoice':_0x15f0e7[_0x53c756(0x275)]}),await _0x4486bd[_0x53c756(0x2b1)]());}}_0x129476[_0x53c756(0x291)]=_0x53c756(0x24d);const _0x39098b=await _0x129476[_0x53c756(0x2b1)](),_0x361810=await master_shop['find'](),_0x507a2c=await email_settings[_0x53c756(0x1ff)](),_0x25be83=await supervisor_settings['find']();var _0x504a28=_0x129476[_0x53c756(0x240)],_0x14327f='',_0x3311af;for(_0x3311af in _0x504a28){_0x14327f+=_0x53c756(0x2bc)+_0x53c756(0x278)+_0x504a28[_0x3311af][_0x53c756(0x2a3)]+_0x53c756(0x294)+_0x53c756(0x278)+_0x504a28[_0x3311af]['product_code']+_0x53c756(0x294)+_0x53c756(0x278)+_0x504a28[_0x3311af][_0x53c756(0x2f8)]+_0x53c756(0x294)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x504a28[_0x3311af][_0x53c756(0x273)]+_0x53c756(0x294)+_0x53c756(0x278)+_0x504a28[_0x3311af][_0x53c756(0x320)]+_0x53c756(0x294)+_0x53c756(0x278)+_0x129476[_0x53c756(0x1f7)]+_0x53c756(0x294)+_0x53c756(0x278)+_0x504a28[_0x3311af][_0x53c756(0x314)]+_0x53c756(0x294)+_0x53c756(0x278)+_0x504a28[_0x3311af][_0x53c756(0x23a)]+_0x53c756(0x294);}_0x21dc84[_0x53c756(0x21f)]('success',_0x53c756(0x32b)),_0x182169['redirect'](_0x53c756(0x2c5)+_0xfbbd79);}catch(_0x4e1493){console[_0x53c756(0x2d2)](_0x4e1493);}}),router[a0_0x5cdbc7(0x2b2)](a0_0x5cdbc7(0x215),auth,async(_0x48379f,_0x3701ca)=>{var _0x5d0b95=a0_0x5cdbc7;try{const {username:_0x5ea3bb,email:_0x14f099,role:_0x2a1923}=_0x48379f[_0x5d0b95(0x2b4)],_0xe53836=_0x48379f[_0x5d0b95(0x2b4)],_0x2ad3db=await profile[_0x5d0b95(0x1ff)]({'email':_0xe53836['email']}),_0x1ce516=await master_shop['find'](),_0xf60f86=_0x48379f[_0x5d0b95(0x1ee)]['id'],_0x3ca7e6=await sales_finished[_0x5d0b95(0x2c7)](_0xf60f86);let _0xc6d6df=new Date(_0x3ca7e6[_0x5d0b95(0x1ed)]),_0x87ff0c=('0'+_0xc6d6df[_0x5d0b95(0x318)]())['slice'](-0x2),_0x59e80d=('0'+(_0xc6d6df[_0x5d0b95(0x22f)]()+0x1))[_0x5d0b95(0x23f)](-0x2),_0x2a32a2=_0xc6d6df[_0x5d0b95(0x22d)](),_0x500d20=_0x2a32a2+'-'+_0x59e80d+'-'+_0x87ff0c;var _0x56fae3=['Ambient','Enclosed'];const _0x4f53c2=await warehouse[_0x5d0b95(0x25e)]([{'$match':{'name':_0x3ca7e6[_0x5d0b95(0x1f7)],'room':_0x3ca7e6[_0x5d0b95(0x201)]}},{'$unwind':_0x5d0b95(0x2d8)},{'$group':{'_id':_0x5d0b95(0x2fa),'name':{'$first':_0x5d0b95(0x2bb)},'product_stock':{'$first':_0x5d0b95(0x25f)},'bay':{'$first':_0x5d0b95(0x24f)},'bin':{'$first':_0x5d0b95(0x2ca)},'type':{'$first':_0x5d0b95(0x2b0)},'floorlevel':{'$first':_0x5d0b95(0x2c4)},'primary_code':{'$first':_0x5d0b95(0x261)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5d0b95(0x31e)},'storage':{'$first':_0x5d0b95(0x2de)},'rack':{'$first':_0x5d0b95(0x31c)}}}]),_0x49b21e=await customer['find']({});let _0x1c7622;if(_0xe53836[_0x5d0b95(0x234)]==_0x5d0b95(0x222)){const _0x4dab19=await staff[_0x5d0b95(0x1ff)]({'email':_0xe53836[_0x5d0b95(0x248)]});_0x1c7622=await warehouse[_0x5d0b95(0x25e)]([{'$match':{'status':_0x5d0b95(0x25a),'name':_0x4dab19[_0x5d0b95(0x30e)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x1c7622=await warehouse[_0x5d0b95(0x25e)]([{'$match':{'status':_0x5d0b95(0x25a)}},{'$group':{'_id':_0x5d0b95(0x2c6),'name':{'$first':_0x5d0b95(0x2c6)}}}]);const _0x66230a=await product['find']({});if(_0x1ce516[0x0]['language']=='English\x20(US)'){var _0xcca6d5=users[_0x5d0b95(0x299)];console['log'](_0xcca6d5);}else{if(_0x1ce516[0x0][_0x5d0b95(0x210)]==_0x5d0b95(0x28a))var _0xcca6d5=users[_0x5d0b95(0x28a)];else{if(_0x1ce516[0x0][_0x5d0b95(0x210)]==_0x5d0b95(0x26c))var _0xcca6d5=users['German'];else{if(_0x1ce516[0x0]['language']=='Spanish')var _0xcca6d5=users[_0x5d0b95(0x2c0)];else{if(_0x1ce516[0x0]['language']==_0x5d0b95(0x1fa))var _0xcca6d5=users[_0x5d0b95(0x1fa)];else{if(_0x1ce516[0x0][_0x5d0b95(0x210)]==_0x5d0b95(0x2a5))var _0xcca6d5=users[_0x5d0b95(0x2f2)];else{if(_0x1ce516[0x0][_0x5d0b95(0x210)]==_0x5d0b95(0x286))var _0xcca6d5=users[_0x5d0b95(0x286)];else{if(_0x1ce516[0x0][_0x5d0b95(0x210)]=='Arabic\x20(ae)')var _0xcca6d5=users[_0x5d0b95(0x21c)];}}}}}}}_0x3701ca[_0x5d0b95(0x2bf)]('edit_sales_finished',{'success':_0x48379f[_0x5d0b95(0x21f)](_0x5d0b95(0x2f6)),'errors':_0x48379f[_0x5d0b95(0x21f)](_0x5d0b95(0x243)),'role':_0xe53836,'profile':_0x2ad3db,'customer':_0x49b21e,'warehouse':_0x1c7622,'product':_0x4f53c2,'user':_0x3ca7e6,'master_shop':_0x1ce516,'unit':_0x66230a,'language':_0xcca6d5,'rooms_data':_0x56fae3,'ed_fullDate':_0x500d20});}catch(_0x208c50){console[_0x5d0b95(0x2d2)](_0x208c50);}}),router[a0_0x5cdbc7(0x2a6)](a0_0x5cdbc7(0x215),auth,async(_0x118de2,_0x5ecd9d)=>{var _0x1c4585=a0_0x5cdbc7;try{const _0x4949f3=_0x118de2[_0x1c4585(0x1ee)]['id'],_0x27410f=await sales_finished[_0x1c4585(0x1ff)]({'_id':_0x118de2[_0x1c4585(0x1ee)]['id']}),_0x5d6c82=await warehouse['findOne']({'name':_0x27410f['warehouse_name'],'room':_0x118de2[_0x1c4585(0x219)][_0x1c4585(0x201)],'warehouse_category':_0x1c4585(0x280)}),{invoice:_0x3c4293,customer:_0x58340b,date:_0x6a7e83,warehouse_name:_0x18dd8f,product_name:_0x2fbe22,stock:_0x205c62,adjust_qty:_0x2132e4,note:_0x515ad7,room:_0x4c87cb,primary_code:_0x2a4516,secondary_code:_0x4bb680,prod_code:_0x593aba,level:_0xe2f5e2,isle:_0x142e5f,pallet:_0x15e6d5,expiry_date:_0x157218}=_0x118de2[_0x1c4585(0x219)];if(typeof _0x2fbe22=='string')var _0x1655f7=[_0x118de2[_0x1c4585(0x219)][_0x1c4585(0x2a3)]],_0x5efe8b=[_0x118de2['body'][_0x1c4585(0x221)]],_0x50ca42=[_0x118de2[_0x1c4585(0x219)][_0x1c4585(0x311)]],_0x2f496c=[_0x118de2['body'][_0x1c4585(0x2a8)]],_0x1a02fa=[_0x118de2[_0x1c4585(0x219)]['secondary_code']],_0x32903f=[_0x118de2[_0x1c4585(0x219)][_0x1c4585(0x2f1)]],_0x46ea31=[_0x118de2['body']['level']],_0x38b136=[_0x118de2[_0x1c4585(0x219)][_0x1c4585(0x1ed)]];else var _0x1655f7=[..._0x118de2[_0x1c4585(0x219)][_0x1c4585(0x2a3)]],_0x5efe8b=[..._0x118de2[_0x1c4585(0x219)]['stock']],_0x50ca42=[..._0x118de2[_0x1c4585(0x219)][_0x1c4585(0x311)]],_0x2f496c=[..._0x118de2[_0x1c4585(0x219)]['primary_code']],_0x1a02fa=[..._0x118de2[_0x1c4585(0x219)][_0x1c4585(0x24c)]],_0x32903f=[..._0x118de2[_0x1c4585(0x219)][_0x1c4585(0x2f1)]],_0x46ea31=[..._0x118de2[_0x1c4585(0x219)][_0x1c4585(0x312)]],_0x38b136=[..._0x118de2[_0x1c4585(0x219)]['expiry_date']];const _0x2f7bd2=_0x1655f7['map'](_0x158130=>{return _0x158130={'product_name':_0x158130};});_0x5efe8b[_0x1c4585(0x27b)]((_0x97bc2d,_0x916df0)=>{_0x2f7bd2[_0x916df0]['stock']=_0x97bc2d;}),_0x50ca42['forEach']((_0x46424c,_0x122e22)=>{var _0x450908=_0x1c4585;_0x2f7bd2[_0x122e22][_0x450908(0x2f8)]=_0x46424c;}),_0x2f496c[_0x1c4585(0x27b)]((_0x190b4b,_0x373e37)=>{var _0x5bdaaa=_0x1c4585;_0x2f7bd2[_0x373e37][_0x5bdaaa(0x2a8)]=_0x190b4b;}),_0x1a02fa[_0x1c4585(0x27b)]((_0x2a44b9,_0x516a17)=>{_0x2f7bd2[_0x516a17]['secondary_code']=_0x2a44b9;}),_0x32903f['forEach']((_0x10d3c8,_0x41aa0d)=>{var _0x5b2d1a=_0x1c4585;_0x2f7bd2[_0x41aa0d][_0x5b2d1a(0x2b9)]=_0x10d3c8;}),_0x46ea31[_0x1c4585(0x27b)]((_0x2a6d27,_0x2b0860)=>{var _0x590231=_0x1c4585;_0x2f7bd2[_0x2b0860][_0x590231(0x312)]=_0x2a6d27;}),_0x38b136[_0x1c4585(0x27b)]((_0x3279fa,_0x295914)=>{_0x2f7bd2[_0x295914]['expiry_date']=_0x3279fa;});var _0x3e7bb1=0x0;_0x2f7bd2[_0x1c4585(0x27b)](_0x121354=>{var _0x1ada28=_0x1c4585;console[_0x1ada28(0x2d2)](_0x1ada28(0x28b),_0x121354),(parseInt(_0x121354[_0x1ada28(0x221)])<parseInt(_0x121354[_0x1ada28(0x2f8)])||parseInt(_0x121354[_0x1ada28(0x2f8)])==0x0)&&_0x3e7bb1++;});if(_0x3e7bb1!=0x0)return _0x118de2['flash'](_0x1c4585(0x243),_0x1c4585(0x282)),_0x5ecd9d['redirect'](_0x1c4585(0x304));_0x27410f[_0x1c4585(0x240)][_0x1c4585(0x27b)](_0x175227=>{var _0x33e80a=_0x1c4585;const _0xbeb50a=_0x5d6c82[_0x33e80a(0x323)][_0x33e80a(0x25d)](_0x111c8b=>{var _0x27c990=_0x33e80a;_0x111c8b[_0x27c990(0x2a3)]==_0x175227['product_name']&&_0x111c8b['bay']==_0x175227[_0x27c990(0x23a)]&&(_0x111c8b[_0x27c990(0x22b)]=parseInt(_0x111c8b[_0x27c990(0x22b)])+parseInt(_0x175227['quantity']));});}),await _0x5d6c82['save']();const _0x1317aa=_0x2f7bd2[_0x1c4585(0x308)](_0x35ddf4=>_0x35ddf4[_0x1c4585(0x2f8)]!=='0'&&_0x35ddf4[_0x1c4585(0x2f8)]!=='');_0x27410f[_0x1c4585(0x24b)]=_0x3c4293,_0x27410f[_0x1c4585(0x32c)]=_0x58340b,_0x27410f['date']=_0x6a7e83,_0x27410f[_0x1c4585(0x1f7)]=_0x18dd8f,_0x27410f[_0x1c4585(0x240)]=_0x1317aa,_0x27410f['note']=_0x515ad7,_0x27410f[_0x1c4585(0x201)]=_0x4c87cb;const _0x571d62=await _0x27410f[_0x1c4585(0x2b1)](),_0x11045b=await sales_finished['findOne']({'_id':_0x118de2[_0x1c4585(0x1ee)]['id']}),_0x56ac56=await warehouse[_0x1c4585(0x1ff)]({'name':_0x18dd8f,'room':_0x4c87cb,'warehouse_category':_0x1c4585(0x280)});_0x11045b[_0x1c4585(0x240)][_0x1c4585(0x27b)](_0x202588=>{var _0x8c7251=_0x1c4585;const _0x1981d5=_0x56ac56[_0x8c7251(0x323)]['map'](_0x546422=>{var _0x1eeb3d=_0x8c7251;_0x546422[_0x1eeb3d(0x2a3)]==_0x202588['product_name']&&_0x546422[_0x1eeb3d(0x23a)]==_0x202588['bay']&&(_0x546422['product_stock']=parseInt(_0x546422[_0x1eeb3d(0x22b)])-parseInt(_0x202588[_0x1eeb3d(0x2f8)]));});}),console['log'](_0x1c4585(0x2a2),_0x56ac56),await _0x56ac56['save']();const _0x443a84=await c_payment_data[_0x1c4585(0x1ff)]({'invoice':_0x118de2['body'][_0x1c4585(0x24b)]});_0x443a84[_0x1c4585(0x274)]=_0x118de2[_0x1c4585(0x219)][_0x1c4585(0x274)],await _0x443a84[_0x1c4585(0x2b1)](),_0x118de2['flash'](_0x1c4585(0x2f6),'Sales\x20Update\x20successfully'),_0x5ecd9d['redirect'](_0x1c4585(0x228));}catch(_0x398da3){console[_0x1c4585(0x2d2)](_0x398da3);}}),router[a0_0x5cdbc7(0x2a6)]('/give_payment/:id',auth,async(_0x257d6c,_0x58142a)=>{var _0x550aac=a0_0x5cdbc7;try{const _0xb1592e=_0x257d6c['params']['id'],{invoice:_0x58ca33,customer:_0x2af3f4,receivable_amount:_0x17cf45,received_amount:_0x3c9fc2}=_0x257d6c[_0x550aac(0x219)],_0x5288f1=await sales['findById'](_0xb1592e);console[_0x550aac(0x2d2)](_0x5288f1);var _0xe47a4c=_0x17cf45-_0x3c9fc2;console['log'](_0x3c9fc2),_0x5288f1['received_amount']=parseFloat(_0x3c9fc2)+parseFloat(_0x5288f1[_0x550aac(0x2eb)]),_0x5288f1[_0x550aac(0x256)]=_0xe47a4c,console[_0x550aac(0x2d2)](_0x5288f1);const _0x34dc74=await _0x5288f1[_0x550aac(0x2b1)](),_0x3cb80e=await c_payment_data[_0x550aac(0x1ff)]({'invoice':_0x58ca33});_0x3cb80e[_0x550aac(0x220)]=_0xe47a4c,await _0x3cb80e[_0x550aac(0x2b1)]();let _0x1f3c37=new Date(),_0x4bbbbd=('0'+_0x1f3c37[_0x550aac(0x318)]())[_0x550aac(0x23f)](-0x2),_0x1854ce=('0'+(_0x1f3c37[_0x550aac(0x22f)]()+0x1))[_0x550aac(0x23f)](-0x2),_0x541a73=_0x1f3c37[_0x550aac(0x22d)](),_0x12d766=_0x541a73+'-'+_0x1854ce+'-'+_0x4bbbbd;const _0x1c3680=new customer_payment({'invoice':_0x58ca33,'date':_0x541a73+'-'+_0x1854ce+'-'+_0x4bbbbd,'customer':_0x2af3f4,'reason':_0x550aac(0x32f),'amount':_0x3c9fc2}),_0x477f64=await _0x1c3680[_0x550aac(0x2b1)]();_0x257d6c[_0x550aac(0x21f)](_0x550aac(0x2f6),'payment\x20successfull'),_0x58142a[_0x550aac(0x2ad)](_0x550aac(0x2a9));}catch(_0x265a4c){console['log'](_0x265a4c);}}),router['get'](a0_0x5cdbc7(0x226),auth,async(_0xaa040a,_0x48584b)=>{var _0x5df4fc=a0_0x5cdbc7;try{const {username:_0x2bceb1,email:_0x2ac909,role:_0x4a5a0b}=_0xaa040a[_0x5df4fc(0x2b4)],_0x4935f0=_0xaa040a[_0x5df4fc(0x2b4)],_0x4f826c=await profile['findOne']({'email':_0x4935f0['email']}),_0x307883=await master_shop[_0x5df4fc(0x218)]();console[_0x5df4fc(0x2d2)](_0x5df4fc(0x20a),_0x307883);const _0x3a48a4=_0xaa040a[_0x5df4fc(0x1ee)]['id'],_0x526dca=await sales['findById'](_0x3a48a4);console[_0x5df4fc(0x2d2)](_0x526dca);const _0x191c81=await customer['findOne']({'name':_0x526dca[_0x5df4fc(0x32c)]});console[_0x5df4fc(0x2d2)](_0x191c81);if(_0x307883[0x0][_0x5df4fc(0x210)]=='English\x20(US)'){var _0x4e2198=users[_0x5df4fc(0x299)];console[_0x5df4fc(0x2d2)](_0x4e2198);}else{if(_0x307883[0x0][_0x5df4fc(0x210)]==_0x5df4fc(0x28a))var _0x4e2198=users['Hindi'];else{if(_0x307883[0x0][_0x5df4fc(0x210)]=='German')var _0x4e2198=users[_0x5df4fc(0x26c)];else{if(_0x307883[0x0][_0x5df4fc(0x210)]=='Spanish')var _0x4e2198=users[_0x5df4fc(0x2c0)];else{if(_0x307883[0x0][_0x5df4fc(0x210)]==_0x5df4fc(0x1fa))var _0x4e2198=users['French'];else{if(_0x307883[0x0][_0x5df4fc(0x210)]=='Portuguese\x20(BR)')var _0x4e2198=users[_0x5df4fc(0x2f2)];else{if(_0x307883[0x0][_0x5df4fc(0x210)]==_0x5df4fc(0x286))var _0x4e2198=users[_0x5df4fc(0x286)];else{if(_0x307883[0x0]['language']==_0x5df4fc(0x21d))var _0x4e2198=users[_0x5df4fc(0x21c)];}}}}}}}_0x48584b[_0x5df4fc(0x2bf)](_0x5df4fc(0x1e6),{'success':_0xaa040a[_0x5df4fc(0x21f)]('success'),'errors':_0xaa040a[_0x5df4fc(0x21f)](_0x5df4fc(0x243)),'role':_0x4935f0,'profile':_0x4f826c,'master_shop':_0x307883,'customers':_0x191c81,'sales':_0x526dca,'language':_0x4e2198});}catch(_0x22a5b6){console[_0x5df4fc(0x2d2)](_0x22a5b6);}}),router[a0_0x5cdbc7(0x2b2)](a0_0x5cdbc7(0x255),auth,async(_0x5e6d2e,_0x2a3542)=>{var _0x202575=a0_0x5cdbc7;try{const {username:_0x306f05,email:_0x1c655b,role:_0x447d17}=_0x5e6d2e[_0x202575(0x2b4)],_0x27cc39=_0x5e6d2e['user'],_0x2404ee=await profile[_0x202575(0x1ff)]({'email':_0x27cc39[_0x202575(0x248)]}),_0x2fefe0=await master_shop[_0x202575(0x218)](),_0x132b25=_0x5e6d2e['params']['id'],_0xb33f=await sales_finished['findById'](_0x132b25),_0x5101e0=await warehouse['aggregate']([{'$match':{'name':_0xb33f[_0x202575(0x1f7)]}},{'$unwind':_0x202575(0x2d8)},{'$group':{'_id':_0x202575(0x2fa),'name':{'$first':_0x202575(0x2bb)},'product_stock':{'$first':_0x202575(0x25f)},'bay':{'$first':_0x202575(0x24f)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x202575(0x2b0)},'floorlevel':{'$first':_0x202575(0x2c4)},'primary_code':{'$first':_0x202575(0x261)},'secondary_code':{'$first':_0x202575(0x206)},'product_code':{'$first':_0x202575(0x31e)},'storage':{'$first':_0x202575(0x2de)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x202575(0x1e9)},'production_date':{'$first':_0x202575(0x2fc)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x202575(0x26a)},'maxProducts':{'$first':_0x202575(0x203)},'batch_code':{'$first':_0x202575(0x2e2)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x311037=await product[_0x202575(0x218)]({}),_0x1eb60f=await warehouse[_0x202575(0x25e)]([{'$match':{'status':_0x202575(0x25a),'warehouse_category':_0x202575(0x280),'name':{'$ne':_0x202575(0x217),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':_0x202575(0x2c6),'name':{'$first':_0x202575(0x2c6)}}},{'$sort':{'name':0x1}}]);var _0x6f6e53=[_0x202575(0x23c)];const _0x54d35a=await warehouse[_0x202575(0x25e)]([{'$match':{'status':_0x202575(0x25a),'name':'Quality\x20Inspection'}},{'$group':{'_id':'$name','name':{'$first':_0x202575(0x2c6)}}},{'$sort':{'name':0x1}}]);if(_0x2fefe0[0x0]['language']=='English\x20(US)'){var _0x2c6bfc=users[_0x202575(0x299)];console[_0x202575(0x2d2)](_0x2c6bfc);}else{if(_0x2fefe0[0x0][_0x202575(0x210)]=='Hindi')var _0x2c6bfc=users[_0x202575(0x28a)];else{if(_0x2fefe0[0x0][_0x202575(0x210)]=='German')var _0x2c6bfc=users[_0x202575(0x26c)];else{if(_0x2fefe0[0x0][_0x202575(0x210)]==_0x202575(0x2c0))var _0x2c6bfc=users['Spanish'];else{if(_0x2fefe0[0x0]['language']==_0x202575(0x1fa))var _0x2c6bfc=users[_0x202575(0x1fa)];else{if(_0x2fefe0[0x0][_0x202575(0x210)]==_0x202575(0x2a5))var _0x2c6bfc=users[_0x202575(0x2f2)];else{if(_0x2fefe0[0x0][_0x202575(0x210)]=='Chinese')var _0x2c6bfc=users[_0x202575(0x286)];else{if(_0x2fefe0[0x0][_0x202575(0x210)]==_0x202575(0x21d))var _0x2c6bfc=users[_0x202575(0x21c)];}}}}}}}_0x2a3542[_0x202575(0x2bf)](_0x202575(0x283),{'success':_0x5e6d2e[_0x202575(0x21f)]('success'),'errors':_0x5e6d2e[_0x202575(0x21f)]('errors'),'role':_0x27cc39,'profile':_0x2404ee,'user':_0xb33f,'stock':_0x5101e0,'master_shop':_0x2fefe0,'unit':_0x311037,'language':_0x2c6bfc,'warehouses':_0x1eb60f,'rooms':_0x6f6e53,'warehouse_QA':_0x54d35a});}catch(_0x311f32){console[_0x202575(0x2d2)](_0x311f32),_0x2a3542['status'](0xc8)[_0x202575(0x296)]({'message':_0x311f32[_0x202575(0x29d)]});}}),router[a0_0x5cdbc7(0x2a6)](a0_0x5cdbc7(0x255),auth,async(_0x56d761,_0x4b8af3)=>{var _0x2e39bf=a0_0x5cdbc7;if(_0x56d761['body'][_0x2e39bf(0x216)]=='QA')try{const {invoice:_0x393548,date:_0x47e796,warehouse_name:_0x359f80,product_name:_0x236237,primary_code:_0x534755,secondary_code:_0x6ef046,product_code:_0x4672c1,sales_quantity:_0x5800df,stocks:_0x308aaa,return_qty:_0x168037,Room_name:_0x12a468,to_warehouse_name_QA:_0x42cfd8,to_Room_name_QA:_0x557a67,note:_0x4554fa,for_categorize:_0x834212,product_name_QA1:_0x157b3a}=_0x56d761['body'];if(typeof _0x157b3a==_0x2e39bf(0x1f1))var _0x11f930=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2aa)]],_0x40764d=[_0x56d761[_0x2e39bf(0x219)]['primary_code_QA']],_0x2e8e77=[_0x56d761['body'][_0x2e39bf(0x2b8)]],_0xf147b1=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2c2)]],_0x509712=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x20d)]],_0x51719c=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x27d)]],_0x11fa5d=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2ee)]],_0x2356ba=[_0x56d761['body'][_0x2e39bf(0x2e1)]],_0xddeb36=[_0x56d761['body'][_0x2e39bf(0x25c)]],_0x4e415c=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2cc)]],_0x2bffbf=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2f5)]],_0x413d9f=[_0x56d761['body'][_0x2e39bf(0x20e)]],_0x897c2d=[_0x56d761['body'][_0x2e39bf(0x1eb)]],_0x502f8a=[_0x56d761[_0x2e39bf(0x219)]['expiry_date_QA']];else var _0x11f930=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2aa)]],_0x40764d=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x32d)]],_0x2e8e77=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2b8)]],_0xf147b1=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2c2)]],_0x509712=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x20d)]],_0x51719c=[..._0x56d761['body'][_0x2e39bf(0x27d)]],_0x11fa5d=[..._0x56d761['body'][_0x2e39bf(0x2ee)]],_0x2356ba=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2e1)]],_0xddeb36=[..._0x56d761['body'][_0x2e39bf(0x25c)]],_0x4e415c=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2cc)]],_0x2bffbf=[..._0x56d761[_0x2e39bf(0x219)]['secondary_unit_QA']],_0x413d9f=[..._0x56d761['body'][_0x2e39bf(0x20e)]],_0x897c2d=[..._0x56d761['body'][_0x2e39bf(0x1eb)]],_0x502f8a=[..._0x56d761['body'][_0x2e39bf(0x31a)]];const _0x354647=_0x11f930['map'](_0x4339f9=>{return _0x4339f9={'product_name':_0x4339f9};});_0x40764d[_0x2e39bf(0x27b)]((_0x4b95a5,_0x235fcb)=>{_0x354647[_0x235fcb]['primary_code']=_0x4b95a5;}),_0x2e8e77[_0x2e39bf(0x27b)]((_0x5ca665,_0x356df7)=>{var _0x4948c6=_0x2e39bf;_0x354647[_0x356df7][_0x4948c6(0x24c)]=_0x5ca665;}),_0xf147b1[_0x2e39bf(0x27b)]((_0x590f1d,_0x5f261f)=>{var _0x4c8d9b=_0x2e39bf;_0x354647[_0x5f261f][_0x4c8d9b(0x2b9)]=_0x590f1d;}),_0x509712['forEach']((_0x587439,_0x3dcf5e)=>{var _0x140799=_0x2e39bf;_0x354647[_0x3dcf5e][_0x140799(0x2a7)]=_0x587439;}),_0x51719c['forEach']((_0x185e70,_0x391818)=>{var _0x4d95ca=_0x2e39bf;_0x354647[_0x391818][_0x4d95ca(0x221)]=_0x185e70;}),_0x11fa5d[_0x2e39bf(0x27b)]((_0x3ccfd8,_0x1ad101)=>{var _0x5aabfc=_0x2e39bf;_0x354647[_0x1ad101][_0x5aabfc(0x1e0)]=_0x3ccfd8;}),_0x2356ba[_0x2e39bf(0x27b)]((_0x460878,_0x2dba74)=>{var _0x44a2c4=_0x2e39bf;_0x354647[_0x2dba74][_0x44a2c4(0x27c)]=_0x460878;}),_0xddeb36['forEach']((_0xfb4de7,_0x54da34)=>{var _0x493625=_0x2e39bf;_0x354647[_0x54da34][_0x493625(0x254)]=_0xfb4de7;}),_0x4e415c[_0x2e39bf(0x27b)]((_0x2dc80a,_0x4696f0)=>{var _0xa2957c=_0x2e39bf;_0x354647[_0x4696f0][_0xa2957c(0x229)]=_0x2dc80a;}),_0x2bffbf['forEach']((_0x103aad,_0x2d1379)=>{_0x354647[_0x2d1379]['secondary_unit']=_0x103aad;}),_0x413d9f[_0x2e39bf(0x27b)]((_0x3e5a1b,_0x490cba)=>{var _0x291aed=_0x2e39bf;_0x354647[_0x490cba][_0x291aed(0x273)]=_0x3e5a1b;}),_0x897c2d[_0x2e39bf(0x27b)]((_0x2f2344,_0x43abfe)=>{var _0x5bc02f=_0x2e39bf;_0x354647[_0x43abfe][_0x5bc02f(0x264)]=_0x2f2344;}),_0x502f8a[_0x2e39bf(0x27b)]((_0xeaa669,_0x2e4689)=>{var _0x2b3ef7=_0x2e39bf;_0x354647[_0x2e4689][_0x2b3ef7(0x1ed)]=_0xeaa669;});const _0x1f0f42=await sales_finished['findOne']({'invoice':_0x393548});_0x1f0f42['return_data']=_0x2e39bf(0x24d);const _0x859394=await _0x1f0f42[_0x2e39bf(0x2b1)](),_0x182f7a=new sales_return_finished({'invoice':_0x393548,'customer':_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x32c)],'date':_0x47e796,'warehouse_name':_0x359f80,'room':_0x12a468,'ToWarehouse':_0x42cfd8,'ToRoom':_0x557a67,'return_sale_QA':_0x354647,'note':_0x4554fa,'warehouse_cat':_0x834212}),_0x2d97d6=await _0x182f7a[_0x2e39bf(0x2b1)](),_0x38bc4d=await sales_return_finished[_0x2e39bf(0x1ff)]({'invoice':_0x393548}),_0x3fdc43=await warehouse[_0x2e39bf(0x1ff)]({'name':_0x42cfd8,'room':_0x557a67});_0x38bc4d[_0x2e39bf(0x2ed)][_0x2e39bf(0x27b)](_0xb2d390=>{var _0x3e37fa=_0x2e39bf,_0xc84421=0x0;const _0x430fa2=_0x3fdc43['product_details'][_0x3e37fa(0x25d)](_0x5296aa=>{var _0x53af57=_0x3e37fa;_0x5296aa['product_name']==_0xb2d390[_0x53af57(0x2a3)]&&_0x5296aa[_0x53af57(0x1ed)]==_0xb2d390[_0x53af57(0x1ed)]&&_0x5296aa[_0x53af57(0x264)]==_0xb2d390['production_date']&&_0x5296aa[_0x53af57(0x229)]==_0xb2d390[_0x53af57(0x229)]&&(_0x5296aa[_0x53af57(0x22b)]=parseInt(_0x5296aa[_0x53af57(0x22b)])+parseInt(_0xb2d390[_0x53af57(0x1e0)]),_0xc84421++);});_0xc84421=='0'&&(_0x3fdc43[_0x3e37fa(0x323)]=_0x3fdc43[_0x3e37fa(0x323)][_0x3e37fa(0x31f)]({'product_name':_0xb2d390[_0x3e37fa(0x2a3)],'product_stock':_0xb2d390[_0x3e37fa(0x1e0)],'primary_code':_0xb2d390[_0x3e37fa(0x2a8)],'secondary_code':_0xb2d390[_0x3e37fa(0x24c)],'product_code':_0xb2d390[_0x3e37fa(0x2b9)],'batch_code':_0xb2d390[_0x3e37fa(0x229)],'maxPerUnit':_0xb2d390['maxPerUnit'],'production_date':_0xb2d390[_0x3e37fa(0x264)],'expiry_date':_0xb2d390['expiry_date'],'secondary_unit':_0xb2d390[_0x3e37fa(0x320)],'unit':_0xb2d390[_0x3e37fa(0x273)],'maxProducts':_0xb2d390['maxProducts'],'bay':_0xb2d390['bay']}));}),await _0x3fdc43[_0x2e39bf(0x2b1)]();const _0x180239=new c_payment_data({'invoice':_0x393548,'customer':_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x32c)],'reason':_0x2e39bf(0x289)});await _0x180239[_0x2e39bf(0x2b1)]();const _0x1e01e4=await master_shop[_0x2e39bf(0x218)](),_0x3b4e53=await email_settings[_0x2e39bf(0x1ff)](),_0x3390eb=await customer[_0x2e39bf(0x1ff)]({'name':_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x32c)]});_0x1e01e4[0x0]['currency_placement']==0x1?(right_currency=_0x1e01e4[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x1e01e4[0x0][_0x2e39bf(0x288)]);var _0x4e3cef=_0x11f930,_0x107e43=_0x11fa5d,_0x49e0db='',_0x55d708;for(_0x55d708 in _0x4e3cef){_0x49e0db+='<tr>'+_0x2e39bf(0x278)+_0x4e3cef[_0x55d708]+_0x2e39bf(0x294)+_0x2e39bf(0x278)+_0x107e43[_0x55d708]+_0x2e39bf(0x294)+'</tr>';}console['log'](_0x2e39bf(0x2fe),_0x49e0db);let _0x4afbf2=nodemailer[_0x2e39bf(0x1f5)]({'service':_0x2e39bf(0x1e5),'auth':{'user':_0x3b4e53[_0x2e39bf(0x248)],'pass':_0x3b4e53['password']}}),_0x2b9498={'from':_0x3b4e53[_0x2e39bf(0x248)],'to':_0x3390eb['email'],'subject':_0x2e39bf(0x2ac),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2e39bf(0x24e)+_0x2e39bf(0x285)+_0x1e01e4[0x0][_0x2e39bf(0x253)],'cid':_0x2e39bf(0x271)}],'html':_0x2e39bf(0x2e6)+_0x2e39bf(0x29c)+_0x2e39bf(0x1fd)+_0x2e39bf(0x2d4)+_0x2e39bf(0x250)+_0x2e39bf(0x2d4)+_0x2e39bf(0x266)+_0x2e39bf(0x2b6)+_0x2e39bf(0x2d4)+_0x2e39bf(0x1e3)+_0x1e01e4[0x0][_0x2e39bf(0x2cb)]+_0x2e39bf(0x301)+_0x2e39bf(0x2b6)+_0x2e39bf(0x2b6)+_0x2e39bf(0x2fb)+_0x2e39bf(0x2d4)+_0x2e39bf(0x22a)+_0x2e39bf(0x32a)+_0x393548+'\x20'+_0x2e39bf(0x2a0)+_0x2e39bf(0x2ea)+_0x47e796+'\x20'+_0x2e39bf(0x21a)+_0x2e39bf(0x1f0)+_0x2e39bf(0x2b6)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2e39bf(0x315)+_0x2e39bf(0x2bc)+_0x2e39bf(0x270)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x2e39bf(0x2dc)+'</tr>'+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x49e0db+'\x20'+'</tbody>'+'</table>'+'<div>'+_0x2e39bf(0x267)+'<h5>'+_0x1e01e4[0x0][_0x2e39bf(0x2cb)]+_0x2e39bf(0x1f0)+_0x2e39bf(0x2b6)+_0x2e39bf(0x2b6)+_0x2e39bf(0x277)};_0x4afbf2[_0x2e39bf(0x28d)](_0x2b9498,function(_0x360b31,_0x18053a){var _0x464815=_0x2e39bf;_0x360b31?(console[_0x464815(0x2d2)](_0x360b31),console[_0x464815(0x2d2)](_0x464815(0x27e))):console[_0x464815(0x2d2)]('Email\x20sent\x20successfully');}),_0x56d761['flash'](_0x2e39bf(0x2f6),_0x2e39bf(0x300)),_0x4b8af3['redirect'](_0x2e39bf(0x228));}catch(_0x495e29){_0x4b8af3['status'](0xc8)[_0x2e39bf(0x296)]({'message1':_0x495e29[_0x2e39bf(0x29d)]});}else{if(_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x216)]=='GS')try{const {invoice:_0x556d72,date:_0x36eeea,warehouse_name:_0x2e4947,product_name:_0x2cf3b3,primary_code:_0x47cd49,secondary_code:_0x3eebbe,product_code:_0x110b13,sales_quantity:_0x3205f2,stocks:_0x30bb2e,return_qty:_0x4d54b2,Room_name:_0x123811,to_warehouse_name:_0x285aec,to_Room_name:_0x1471fd,note:_0x50be1e,level:_0x598642,isle:_0x3302b9,pallet:_0x27fba2,for_categorize:_0x430633}=_0x56d761[_0x2e39bf(0x219)];if(typeof _0x2cf3b3==_0x2e39bf(0x1f1))var _0x11f930=[_0x56d761['body']['product_name']],_0x40764d=[_0x56d761[_0x2e39bf(0x219)]['primary_code']],_0x2e8e77=[_0x56d761[_0x2e39bf(0x219)]['secondary_code']],_0xf147b1=[_0x56d761[_0x2e39bf(0x219)]['product_code']],_0x509712=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x303)]],_0x11fa5d=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x1e0)]],_0x1d397e=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x23a)]],_0x2356ba=[_0x56d761['body'][_0x2e39bf(0x27c)]],_0xddeb36=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x254)]],_0x4e415c=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x229)]],_0x2bffbf=[_0x56d761[_0x2e39bf(0x219)]['secondary_unit']],_0x413d9f=[_0x56d761['body']['unit']],_0x897c2d=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x264)]],_0x502f8a=[_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x1ed)]];else var _0x11f930=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x2a3)]],_0x40764d=[..._0x56d761[_0x2e39bf(0x219)]['primary_code']],_0x2e8e77=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x24c)]],_0xf147b1=[..._0x56d761[_0x2e39bf(0x219)]['product_code']],_0x509712=[..._0x56d761['body'][_0x2e39bf(0x303)]],_0x11fa5d=[..._0x56d761['body'][_0x2e39bf(0x1e0)]],_0x1d397e=[..._0x56d761['body']['bay']],_0x2356ba=[..._0x56d761[_0x2e39bf(0x219)]['maxPerUnit']],_0xddeb36=[..._0x56d761[_0x2e39bf(0x219)]['maxProducts']],_0x4e415c=[..._0x56d761['body'][_0x2e39bf(0x229)]],_0x2bffbf=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x320)]],_0x413d9f=[..._0x56d761[_0x2e39bf(0x219)]['unit']],_0x897c2d=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x264)]],_0x502f8a=[..._0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x1ed)]];const _0x2b5ae2=_0x11f930[_0x2e39bf(0x25d)](_0x54f537=>{return _0x54f537={'product_name':_0x54f537};});_0x40764d['forEach']((_0x1b5fd0,_0x388780)=>{var _0x399ce9=_0x2e39bf;_0x2b5ae2[_0x388780][_0x399ce9(0x2a8)]=_0x1b5fd0;}),_0x2e8e77[_0x2e39bf(0x27b)]((_0x5718fb,_0xaf1a60)=>{var _0x25a647=_0x2e39bf;_0x2b5ae2[_0xaf1a60][_0x25a647(0x24c)]=_0x5718fb;}),_0xf147b1[_0x2e39bf(0x27b)]((_0x7abb71,_0x24e96c)=>{var _0x3a898f=_0x2e39bf;_0x2b5ae2[_0x24e96c][_0x3a898f(0x2b9)]=_0x7abb71;}),_0x509712[_0x2e39bf(0x27b)]((_0x4f0b42,_0x4c2152)=>{var _0x435fbc=_0x2e39bf;_0x2b5ae2[_0x4c2152][_0x435fbc(0x2a7)]=_0x4f0b42;}),_0x11fa5d[_0x2e39bf(0x27b)]((_0x2d0d52,_0x2e5b02)=>{var _0x328939=_0x2e39bf;_0x2b5ae2[_0x2e5b02][_0x328939(0x1e0)]=_0x2d0d52;}),_0x1d397e['forEach']((_0x5da455,_0x4781ca)=>{var _0x4be64d=_0x2e39bf;_0x2b5ae2[_0x4781ca][_0x4be64d(0x23a)]=_0x5da455;}),_0x2356ba[_0x2e39bf(0x27b)]((_0x4b0b03,_0x5ae1cc)=>{var _0x5934cd=_0x2e39bf;_0x2b5ae2[_0x5ae1cc][_0x5934cd(0x27c)]=_0x4b0b03;}),_0xddeb36[_0x2e39bf(0x27b)]((_0x353c6d,_0x12da42)=>{var _0x4dabaa=_0x2e39bf;_0x2b5ae2[_0x12da42][_0x4dabaa(0x254)]=_0x353c6d;}),_0x4e415c[_0x2e39bf(0x27b)]((_0x1bf4fd,_0x36f789)=>{var _0x430e46=_0x2e39bf;_0x2b5ae2[_0x36f789][_0x430e46(0x229)]=_0x1bf4fd;}),_0x2bffbf[_0x2e39bf(0x27b)]((_0x101801,_0x40645c)=>{var _0x5e9464=_0x2e39bf;_0x2b5ae2[_0x40645c][_0x5e9464(0x320)]=_0x101801;}),_0x413d9f[_0x2e39bf(0x27b)]((_0x5bcfed,_0x366689)=>{var _0x4e2b57=_0x2e39bf;_0x2b5ae2[_0x366689][_0x4e2b57(0x273)]=_0x5bcfed;}),_0x897c2d[_0x2e39bf(0x27b)]((_0xb43e8,_0x397996)=>{var _0x26245f=_0x2e39bf;_0x2b5ae2[_0x397996][_0x26245f(0x264)]=_0xb43e8;}),_0x502f8a['forEach']((_0x59165e,_0x466a6b)=>{var _0x5ca2be=_0x2e39bf;_0x2b5ae2[_0x466a6b][_0x5ca2be(0x1ed)]=_0x59165e;});var _0x4e6b06=0x0;_0x2b5ae2['forEach'](_0x428a87=>{var _0x1fbeb9=_0x2e39bf;(parseInt(_0x428a87[_0x1fbeb9(0x2a7)])<parseInt(_0x428a87[_0x1fbeb9(0x1e0)])||parseInt(_0x428a87[_0x1fbeb9(0x221)])<parseInt(_0x428a87['return_qty'])&&parseInt(_0x428a87[_0x1fbeb9(0x2a7)])>parseInt(_0x428a87['return_qty'])||parseInt(_0x428a87[_0x1fbeb9(0x1e0)])==0x0)&&_0x4e6b06++;});if(_0x4e6b06!=0x0)return _0x56d761[_0x2e39bf(0x21f)]('errors',_0x2e39bf(0x236)),_0x4b8af3[_0x2e39bf(0x2ad)](_0x2e39bf(0x304));const _0x31d192=await sales_finished[_0x2e39bf(0x1ff)]({'invoice':_0x556d72});_0x31d192[_0x2e39bf(0x2b7)]=_0x2e39bf(0x24d);const _0x1dbc71=await _0x31d192[_0x2e39bf(0x2b1)](),_0x1c5c99=new sales_return_finished({'invoice':_0x556d72,'customer':_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x32c)],'date':_0x36eeea,'warehouse_name':_0x2e4947,'room':_0x123811,'ToWarehouse':_0x285aec,'ToRoom':_0x1471fd,'return_sale':_0x2b5ae2,'note':_0x50be1e,'warehouse_cat':_0x430633}),_0x20c47b=await _0x1c5c99[_0x2e39bf(0x2b1)](),_0x240527=await sales_return_finished[_0x2e39bf(0x1ff)]({'invoice':_0x556d72}),_0x5a7b16=await warehouse[_0x2e39bf(0x1ff)]({'name':_0x285aec,'room':_0x1471fd,'warehouse_category':'Finished\x20Goods'});_0x240527['return_sale'][_0x2e39bf(0x27b)](_0x2ecf89=>{var _0x488af3=_0x2e39bf,_0x37eeab=0x0;const _0x4197d6=_0x5a7b16[_0x488af3(0x323)][_0x488af3(0x25d)](_0x5c1eb6=>{var _0xac499d=_0x488af3;_0x5c1eb6[_0xac499d(0x2a3)]==_0x2ecf89['product_name']&&_0x5c1eb6[_0xac499d(0x23a)]==_0x2ecf89[_0xac499d(0x23a)]&&_0x5c1eb6[_0xac499d(0x1ed)]==_0x2ecf89[_0xac499d(0x1ed)]&&_0x5c1eb6[_0xac499d(0x264)]==_0x2ecf89['production_date']&&_0x5c1eb6[_0xac499d(0x229)]==_0x2ecf89[_0xac499d(0x229)]&&(_0x5c1eb6['product_stock']=parseInt(_0x5c1eb6[_0xac499d(0x22b)])+parseInt(_0x2ecf89['return_qty']),_0x37eeab++);});_0x37eeab=='0'&&(_0x5a7b16[_0x488af3(0x323)]=_0x5a7b16[_0x488af3(0x323)][_0x488af3(0x31f)]({'product_name':_0x2ecf89[_0x488af3(0x2a3)],'product_stock':_0x2ecf89[_0x488af3(0x1e0)],'primary_code':_0x2ecf89[_0x488af3(0x2a8)],'secondary_code':_0x2ecf89[_0x488af3(0x24c)],'product_code':_0x2ecf89[_0x488af3(0x2b9)],'bay':_0x2ecf89['bay'],'batch_code':_0x2ecf89[_0x488af3(0x229)],'maxPerUnit':_0x2ecf89[_0x488af3(0x27c)],'production_date':_0x2ecf89[_0x488af3(0x264)],'expiry_date':_0x2ecf89[_0x488af3(0x1ed)],'secondary_unit':_0x2ecf89[_0x488af3(0x320)],'unit':_0x2ecf89[_0x488af3(0x273)],'maxProducts':_0x2ecf89[_0x488af3(0x254)]}));}),await _0x5a7b16[_0x2e39bf(0x2b1)](),console[_0x2e39bf(0x2d2)](_0x56d761[_0x2e39bf(0x219)]);const _0x4f473d=new c_payment_data({'invoice':_0x556d72,'customer':_0x56d761['body'][_0x2e39bf(0x32c)],'reason':_0x2e39bf(0x289)});await _0x4f473d[_0x2e39bf(0x2b1)]();const _0x3f1a13=await master_shop[_0x2e39bf(0x218)]();console[_0x2e39bf(0x2d2)]('add\x20post',_0x3f1a13[0x0][_0x2e39bf(0x253)]);const _0x1bf65c=await email_settings['findOne'](),_0x43c68c=await customer['findOne']({'name':_0x56d761[_0x2e39bf(0x219)][_0x2e39bf(0x32c)]});console[_0x2e39bf(0x2d2)](_0x2e39bf(0x2ff),_0x43c68c);_0x3f1a13[0x0]['currency_placement']==0x1?(right_currency=_0x3f1a13[0x0][_0x2e39bf(0x288)],left_currency=''):(right_currency='',left_currency=_0x3f1a13[0x0][_0x2e39bf(0x288)]);var _0x4e3cef=_0x11f930,_0x107e43=_0x11fa5d,_0x49e0db='',_0x55d708;for(_0x55d708 in _0x4e3cef){_0x49e0db+=_0x2e39bf(0x2bc)+_0x2e39bf(0x278)+_0x4e3cef[_0x55d708]+_0x2e39bf(0x294)+_0x2e39bf(0x278)+_0x107e43[_0x55d708]+_0x2e39bf(0x294)+_0x2e39bf(0x25b);}console[_0x2e39bf(0x2d2)]('product_list',_0x49e0db);let _0x11691a=nodemailer[_0x2e39bf(0x1f5)]({'service':'gmail','auth':{'user':_0x1bf65c[_0x2e39bf(0x248)],'pass':_0x1bf65c[_0x2e39bf(0x30c)]}}),_0x5e3256={'from':_0x1bf65c[_0x2e39bf(0x248)],'to':_0x43c68c[_0x2e39bf(0x248)],'subject':_0x2e39bf(0x2ac),'attachments':[{'filename':_0x2e39bf(0x2e0),'path':__dirname+'/../public'+_0x2e39bf(0x285)+_0x3f1a13[0x0][_0x2e39bf(0x253)],'cid':_0x2e39bf(0x271)}],'html':'<!DOCTYPE\x20html>'+_0x2e39bf(0x29c)+'</head><body>'+_0x2e39bf(0x2d4)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x2e39bf(0x266)+_0x2e39bf(0x2b6)+'<div>'+_0x2e39bf(0x1e3)+_0x3f1a13[0x0][_0x2e39bf(0x2cb)]+_0x2e39bf(0x301)+_0x2e39bf(0x2b6)+'</div>'+_0x2e39bf(0x2fb)+_0x2e39bf(0x2d4)+_0x2e39bf(0x22a)+'\x20Order\x20Number\x20:\x20'+_0x556d72+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2e39bf(0x2ea)+_0x36eeea+'\x20'+_0x2e39bf(0x21a)+_0x2e39bf(0x1f0)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2e39bf(0x315)+_0x2e39bf(0x2bc)+_0x2e39bf(0x270)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x2e39bf(0x29e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x2e39bf(0x25b)+_0x2e39bf(0x2da)+_0x2e39bf(0x26d)+'\x20'+_0x49e0db+'\x20'+'</tbody>'+_0x2e39bf(0x2c8)+_0x2e39bf(0x2d4)+_0x2e39bf(0x267)+'<h5>'+_0x3f1a13[0x0][_0x2e39bf(0x2cb)]+'</h5>'+_0x2e39bf(0x2b6)+'</div>'+_0x2e39bf(0x277)};_0x11691a[_0x2e39bf(0x28d)](_0x5e3256,function(_0x423995,_0x2f00de){var _0x487457=_0x2e39bf;_0x423995?(console[_0x487457(0x2d2)](_0x423995),console[_0x487457(0x2d2)]('Error\x20Occurs')):console[_0x487457(0x2d2)](_0x487457(0x246));}),_0x56d761['flash'](_0x2e39bf(0x2f6),_0x2e39bf(0x300)),_0x4b8af3['redirect'](_0x2e39bf(0x228));}catch(_0xa3d382){console['log'](_0xa3d382),_0x4b8af3['status'](0xc8)[_0x2e39bf(0x296)]({'message1':_0xa3d382[_0x2e39bf(0x29d)]});}}}),router[a0_0x5cdbc7(0x2b2)](a0_0x5cdbc7(0x327),auth,async(_0x3dacf5,_0x141568)=>{var _0x44fb25=a0_0x5cdbc7;try{const {username:_0x2300de,email:_0x24e3c5,role:_0x4de451}=_0x3dacf5[_0x44fb25(0x2b4)],_0x228951=_0x3dacf5['user'],_0x1d6c28=await profile[_0x44fb25(0x1ff)]({'email':_0x228951['email']}),_0x265ba=await master_shop[_0x44fb25(0x218)]();console[_0x44fb25(0x2d2)](_0x44fb25(0x21e),_0x265ba);const _0x59034e=_0x3dacf5[_0x44fb25(0x1ee)]['id'],_0x359ac0=await sales[_0x44fb25(0x2c7)](_0x59034e);console[_0x44fb25(0x2d2)]('barcode\x20user_id',_0x359ac0);if(_0x265ba[0x0][_0x44fb25(0x210)]=='English\x20(US)')var _0x2d89fe=users['English'];else{if(_0x265ba[0x0]['language']==_0x44fb25(0x28a))var _0x2d89fe=users['Hindi'];else{if(_0x265ba[0x0][_0x44fb25(0x210)]=='German')var _0x2d89fe=users['German'];else{if(_0x265ba[0x0][_0x44fb25(0x210)]==_0x44fb25(0x2c0))var _0x2d89fe=users[_0x44fb25(0x2c0)];else{if(_0x265ba[0x0][_0x44fb25(0x210)]==_0x44fb25(0x1fa))var _0x2d89fe=users[_0x44fb25(0x1fa)];else{if(_0x265ba[0x0][_0x44fb25(0x210)]==_0x44fb25(0x2a5))var _0x2d89fe=users['Portuguese'];else{if(_0x265ba[0x0][_0x44fb25(0x210)]==_0x44fb25(0x286))var _0x2d89fe=users['Chinese'];else{if(_0x265ba[0x0]['language']=='Arabic\x20(ae)')var _0x2d89fe=users[_0x44fb25(0x21c)];}}}}}}}_0x141568[_0x44fb25(0x2bf)](_0x44fb25(0x204),{'success':_0x3dacf5['flash'](_0x44fb25(0x2f6)),'errors':_0x3dacf5[_0x44fb25(0x21f)](_0x44fb25(0x243)),'role':_0x228951,'profile':_0x1d6c28,'alldata':_0x359ac0,'master_shop':_0x265ba,'language':_0x2d89fe});}catch(_0x380c4c){console[_0x44fb25(0x2d2)](_0x380c4c);}}),router[a0_0x5cdbc7(0x2a6)](a0_0x5cdbc7(0x2c1),async(_0x44e78b,_0x1d51b8)=>{var _0x1e98af=a0_0x5cdbc7;const {product_code:_0x13e041,warehouse_name:_0x25b657,rooms_data:_0x1935d8,Roomslist:_0x7b42ac,sales_category:_0x2a427c}=_0x44e78b[_0x1e98af(0x219)],_0x4feda3=_0x7b42ac['split'](','),_0x604580=[];async function _0x97abb9(_0x1962f9){var _0x175e9b=_0x1e98af;const _0x3a1def=await warehouse[_0x175e9b(0x25e)]([{'$match':{'name':_0x25b657,'room':_0x1962f9}},{'$unwind':_0x175e9b(0x2d8)},{'$match':{'product_details.primary_code':_0x13e041}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x175e9b(0x25f)},'primary_code':{'$first':_0x175e9b(0x261)},'secondary_code':{'$first':_0x175e9b(0x206)},'product_code':{'$first':_0x175e9b(0x31e)},'level':{'$first':_0x175e9b(0x1f9)},'bay':{'$first':_0x175e9b(0x24f)},'type':{'$first':_0x175e9b(0x2b0)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x175e9b(0x26a)},'storage':{'$first':_0x175e9b(0x2de)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x175e9b(0x1e9)},'production_date':{'$first':_0x175e9b(0x2fc)},'maxPerUnit':{'$first':_0x175e9b(0x2ae)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x175e9b(0x22e)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x175e9b(0x2d6)},'invoice':{'$first':_0x175e9b(0x241)},'uuid':{'$first':_0x175e9b(0x223)},'gross_price':{'$first':_0x175e9b(0x319)},'sales_category':{'$first':_0x175e9b(0x2e9)}}}]),_0x2fc96e=await warehouse[_0x175e9b(0x25e)]([{'$match':{'name':_0x25b657,'room':_0x1962f9}},{'$unwind':_0x175e9b(0x2d8)},{'$match':{'product_details.secondary_code':_0x13e041}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x175e9b(0x25f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x175e9b(0x31e)},'level':{'$first':_0x175e9b(0x24f)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x175e9b(0x2c4)},'unit':{'$first':_0x175e9b(0x287)},'secondary_unit':{'$first':_0x175e9b(0x26a)},'storage':{'$first':_0x175e9b(0x2de)},'rack':{'$first':_0x175e9b(0x31c)},'expiry_date':{'$first':_0x175e9b(0x1e9)},'production_date':{'$first':_0x175e9b(0x2fc)},'maxPerUnit':{'$first':_0x175e9b(0x2ae)},'batch_code':{'$first':_0x175e9b(0x2e2)},'product_cat':{'$first':_0x175e9b(0x22e)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x175e9b(0x2d6)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x175e9b(0x223)},'gross_price':{'$first':_0x175e9b(0x319)},'sales_category':{'$first':_0x175e9b(0x2e9)}}}]);if(_0x3a1def['length']>0x0)_0x604580['push'](_0x3a1def);else _0x2fc96e[_0x175e9b(0x316)]>0x0&&_0x604580[_0x175e9b(0x309)](_0x2fc96e);}const _0x10d95f=_0x4feda3[_0x1e98af(0x25d)](_0x511894=>_0x97abb9(_0x511894));await Promise[_0x1e98af(0x225)](_0x10d95f),_0x1d51b8[_0x1e98af(0x296)](_0x604580);}),router['post'](a0_0x5cdbc7(0x224),async(_0x124658,_0x23e32b)=>{var _0x1d9453=a0_0x5cdbc7;const {product_code:_0x26b812,warehouse_name:_0x449344,rooms_data:_0x3b0498,Roomslist:_0x3df084,sales_category:_0x398a2b}=_0x124658[_0x1d9453(0x219)],_0x269c13=_0x3df084['split'](','),_0x1ed153=[];async function _0x51629a(_0x78bf2c){var _0x2baed9=_0x1d9453;const _0x3b2c64=await warehouse['aggregate']([{'$match':{'name':_0x449344,'room':_0x78bf2c}},{'$unwind':_0x2baed9(0x2d8)},{'$match':{'product_details.primary_code':_0x26b812,'product_details.sales_category':_0x398a2b,'product_details.type_products':_0x2baed9(0x2d2)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2baed9(0x25f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2baed9(0x206)},'product_code':{'$first':_0x2baed9(0x31e)},'level':{'$first':_0x2baed9(0x1f9)},'bay':{'$first':_0x2baed9(0x24f)},'type':{'$first':_0x2baed9(0x2b0)},'pallet':{'$first':_0x2baed9(0x2c4)},'unit':{'$first':_0x2baed9(0x287)},'secondary_unit':{'$first':_0x2baed9(0x26a)},'storage':{'$first':_0x2baed9(0x2de)},'rack':{'$first':_0x2baed9(0x31c)},'expiry_date':{'$first':_0x2baed9(0x1e9)},'production_date':{'$first':_0x2baed9(0x2fc)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2baed9(0x2e2)},'product_cat':{'$first':_0x2baed9(0x22e)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2baed9(0x2d6)},'invoice':{'$first':_0x2baed9(0x241)},'uuid':{'$first':_0x2baed9(0x223)},'gross_price':{'$first':_0x2baed9(0x319)},'sales_category':{'$first':_0x2baed9(0x2e9)},'type_products':{'$first':_0x2baed9(0x2d9)}}}]);console[_0x2baed9(0x2d2)]('log'+_0x2baed9(0x31d)+_0x26b812+_0x2baed9(0x31d)+_0x398a2b);const _0xbc252a=await warehouse['aggregate']([{'$match':{'name':_0x449344,'room':_0x78bf2c}},{'$unwind':_0x2baed9(0x2d8)},{'$match':{'product_details.secondary_code':_0x26b812,'product_details.sales_category':_0x398a2b,'product_details.type_products':'log'}},{'$group':{'_id':_0x2baed9(0x2fa),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2baed9(0x25f)},'primary_code':{'$first':_0x2baed9(0x261)},'secondary_code':{'$first':_0x2baed9(0x206)},'product_code':{'$first':_0x2baed9(0x31e)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x2baed9(0x2ca)},'type':{'$first':_0x2baed9(0x2b0)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2baed9(0x287)},'secondary_unit':{'$first':_0x2baed9(0x26a)},'storage':{'$first':_0x2baed9(0x2de)},'rack':{'$first':_0x2baed9(0x31c)},'expiry_date':{'$first':_0x2baed9(0x1e9)},'production_date':{'$first':_0x2baed9(0x2fc)},'maxPerUnit':{'$first':_0x2baed9(0x2ae)},'batch_code':{'$first':_0x2baed9(0x2e2)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2baed9(0x2d6)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x2baed9(0x223)},'gross_price':{'$first':_0x2baed9(0x319)},'sales_category':{'$first':_0x2baed9(0x2e9)},'type_products':{'$first':_0x2baed9(0x2d9)}}}]);if(_0x3b2c64['length']>0x0)_0x1ed153[_0x2baed9(0x309)](_0x3b2c64);else _0xbc252a[_0x2baed9(0x316)]>0x0&&_0x1ed153[_0x2baed9(0x309)](_0xbc252a);}const _0x5d2949=_0x269c13['map'](_0x243a6f=>_0x51629a(_0x243a6f));await Promise[_0x1d9453(0x225)](_0x5d2949),_0x23e32b[_0x1d9453(0x296)](_0x1ed153);}),router[a0_0x5cdbc7(0x2a6)](a0_0x5cdbc7(0x329),async(_0x379822,_0x3e72c1)=>{var _0x5b5fa1=a0_0x5cdbc7;try{const {prduct_code:_0x1c0f02,warehouse_data:_0x55309d,qty_req:_0xb8ee71}=_0x379822[_0x5b5fa1(0x219)];let _0x1ef0a4=_0x1c0f02[_0x5b5fa1(0x313)]('~'),_0x1b34cd=_0xb8ee71['split']('~'),_0x2feef2=[],_0x499f69=0x0;for(let _0x214233=0x0;_0x214233<=_0x1ef0a4['length']-0x1;_0x214233++){const _0x157e83=_0x1ef0a4[_0x214233],_0x439e94=_0x1b34cd[_0x214233],_0x1ba4ba=await warehouse[_0x5b5fa1(0x25e)]([{'$match':{'name':_0x55309d}},{'$unwind':_0x5b5fa1(0x2d8)},{'$match':{'product_details.product_code':_0x157e83,'product_details.isAvailable':_0x5b5fa1(0x21b),'product_details.isUsed':'false'}},{'$sort':{'product_details.date_received':0x1}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5b5fa1(0x2bb)},'product_stock':{'$first':_0x5b5fa1(0x25f)},'primary_code':{'$first':_0x5b5fa1(0x261)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5b5fa1(0x1f9)},'bay':{'$first':'$product_details.bay'},'type':{'$first':_0x5b5fa1(0x2b0)},'pallet':{'$first':_0x5b5fa1(0x2c4)},'unit':{'$first':_0x5b5fa1(0x287)},'secondary_unit':{'$first':_0x5b5fa1(0x26a)},'storage':{'$first':_0x5b5fa1(0x2de)},'rack':{'$first':_0x5b5fa1(0x31c)},'expiry_date':{'$first':_0x5b5fa1(0x1e9)},'production_date':{'$first':_0x5b5fa1(0x2fc)},'maxPerUnit':{'$first':_0x5b5fa1(0x2ae)},'batch_code':{'$first':_0x5b5fa1(0x2e2)},'product_cat':{'$first':_0x5b5fa1(0x22e)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x5b5fa1(0x2d6)},'invoice':{'$first':_0x5b5fa1(0x241)},'uuid':{'$first':_0x5b5fa1(0x223)},'gross_price':{'$first':_0x5b5fa1(0x319)},'sales_category':{'$first':_0x5b5fa1(0x2e9)},'date_received':{'$first':'$product_details.date_recieved'},'warehouse_id':{'$first':_0x5b5fa1(0x231)}}}]),_0x2faedf=_0x1ba4ba[_0x5b5fa1(0x1fe)]((_0x356cf1,_0x35320a)=>new Date(_0x356cf1[_0x5b5fa1(0x205)])-new Date(_0x35320a[_0x5b5fa1(0x205)]));let _0x7dc405=_0x439e94;for(let _0x3290c6=0x0;_0x3290c6<=_0x2faedf[_0x5b5fa1(0x316)]-0x1&&_0x7dc405>0x0;_0x3290c6++){const _0x32758c=_0x2faedf[_0x3290c6];if(_0x32758c[_0x5b5fa1(0x2b9)]==_0x157e83){_0x2feef2[_0x499f69]={};const _0x22bd6a=parseInt(_0x32758c[_0x5b5fa1(0x22b)]),_0xbebbb5=0x0;let _0x4cb0ea=_0x22bd6a-_0xbebbb5,_0x52fd43=Math[_0x5b5fa1(0x2d0)](_0x7dc405,_0x4cb0ea);console[_0x5b5fa1(0x2d2)](_0x5b5fa1(0x2db)+_0x52fd43+_0x5b5fa1(0x209)+_0x55309d+_0x5b5fa1(0x23d)+_0x32758c[_0x5b5fa1(0x211)]+_0x5b5fa1(0x244)+(_0x32758c[_0x5b5fa1(0x312)]+_0x32758c[_0x5b5fa1(0x23a)])+_0x5b5fa1(0x2e5)+_0x32758c[_0x5b5fa1(0x205)]+_0x5b5fa1(0x213)+_0x32758c[_0x5b5fa1(0x2a4)]),_0x2feef2[_0x499f69][_0x5b5fa1(0x1f8)]=_0x32758c['warehouse_id']+'~'+_0x32758c[_0x5b5fa1(0x26e)]+'~'+_0x52fd43,_0x2feef2[_0x499f69][_0x5b5fa1(0x2a3)]=_0x32758c[_0x5b5fa1(0x2a4)],_0x2feef2[_0x499f69][_0x5b5fa1(0x2b9)]=_0x32758c[_0x5b5fa1(0x2b9)],_0x2feef2[_0x499f69]['product_id']=_0x32758c[_0x5b5fa1(0x2ba)],_0x2feef2[_0x499f69]['date_recieved']=_0x32758c[_0x5b5fa1(0x235)],_0x2feef2[_0x499f69][_0x5b5fa1(0x325)]=_0x32758c['sales_category'],_0x2feef2[_0x499f69][_0x5b5fa1(0x281)]=_0x32758c[_0x5b5fa1(0x281)],_0x2feef2[_0x499f69][_0x5b5fa1(0x2f8)]=_0x52fd43,_0x2feef2[_0x499f69][_0x5b5fa1(0x273)]=_0x32758c[_0x5b5fa1(0x273)],_0x2feef2[_0x499f69][_0x5b5fa1(0x320)]=_0x32758c[_0x5b5fa1(0x320)],_0x2feef2[_0x499f69][_0x5b5fa1(0x2a8)]=_0x32758c[_0x5b5fa1(0x2a8)],_0x2feef2[_0x499f69][_0x5b5fa1(0x24c)]=_0x32758c[_0x5b5fa1(0x24c)],_0x2feef2[_0x499f69][_0x5b5fa1(0x212)]=_0x32758c[_0x5b5fa1(0x212)],_0x2feef2[_0x499f69][_0x5b5fa1(0x229)]=_0x32758c[_0x5b5fa1(0x229)],_0x2feef2[_0x499f69][_0x5b5fa1(0x1ed)]=_0x32758c[_0x5b5fa1(0x1ed)],_0x2feef2[_0x499f69]['production_date']=_0x32758c[_0x5b5fa1(0x264)],_0x2feef2[_0x499f69]['maxperunit']=_0x32758c[_0x5b5fa1(0x2d5)],_0x2feef2[_0x499f69]['product_cat']=_0x32758c[_0x5b5fa1(0x1fc)],_0x2feef2[_0x499f69][_0x5b5fa1(0x24b)]=_0x32758c[_0x5b5fa1(0x24b)],_0x2feef2[_0x499f69][_0x5b5fa1(0x30a)]=_0x32758c[_0x5b5fa1(0x30a)],_0x2feef2[_0x499f69][_0x5b5fa1(0x314)]=_0x32758c['roomNamed'],_0x2feef2[_0x499f69][_0x5b5fa1(0x312)]=_0x32758c[_0x5b5fa1(0x312)],_0x2feef2[_0x499f69][_0x5b5fa1(0x23a)]=_0x32758c[_0x5b5fa1(0x23a)],_0x2feef2[_0x499f69]['status']=_0x5b5fa1(0x21b),console[_0x5b5fa1(0x2d2)]('1',_0x499f69),_0x7dc405-=_0x52fd43,_0x499f69++;if(_0x7dc405<=0x0)break;}}if(_0x7dc405>0x0){var _0x23f697=await product[_0x5b5fa1(0x1ff)]({'product_code':_0x157e83});console[_0x5b5fa1(0x2d2)]('2',_0x499f69),_0x2feef2[_0x499f69]={},_0x2feef2[_0x499f69][_0x5b5fa1(0x2a3)]=_0x23f697['name'],_0x2feef2[_0x499f69][_0x5b5fa1(0x2b9)]=_0x157e83,_0x2feef2[_0x499f69]['product_id']=_0x23f697['_id'][_0x5b5fa1(0x2e4)](),_0x2feef2[_0x499f69]['quantity']=_0x7dc405,_0x2feef2[_0x499f69][_0x5b5fa1(0x1ea)]=_0x23f697[_0x5b5fa1(0x273)],_0x2feef2[_0x499f69]['secondary_unit']=_0x23f697[_0x5b5fa1(0x2ef)],_0x2feef2[_0x499f69][_0x5b5fa1(0x2a8)]=_0x23f697[_0x5b5fa1(0x2a8)],_0x2feef2[_0x499f69][_0x5b5fa1(0x24c)]=_0x23f697[_0x5b5fa1(0x24c)],_0x2feef2[_0x499f69][_0x5b5fa1(0x212)]=_0x23f697[_0x5b5fa1(0x212)],_0x2feef2[_0x499f69]['maxperunit']=_0x23f697[_0x5b5fa1(0x2d7)],_0x2feef2[_0x499f69][_0x5b5fa1(0x30a)]=_0x23f697[_0x5b5fa1(0x30a)],_0x2feef2[_0x499f69][_0x5b5fa1(0x2be)]=_0x5b5fa1(0x2df),console[_0x5b5fa1(0x2d2)](_0x5b5fa1(0x290)+_0x7dc405+'\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20'+_0x499f69+'\x20<>\x20'+_0x157e83),_0x499f69++;}}_0x3e72c1[_0x5b5fa1(0x296)](_0x2feef2);}catch(_0x1229dd){console[_0x5b5fa1(0x2d2)](_0x1229dd);}}),router[a0_0x5cdbc7(0x2a6)]('/barcode_scanner_auto',async(_0x1a3586,_0x5047ae)=>{var _0x2b2a71=a0_0x5cdbc7;const {product_code:_0x27b8b1}=_0x1a3586[_0x2b2a71(0x219)];var _0x5cd0e1;const _0x1c2d93=await product[_0x2b2a71(0x25e)]([{'$match':{'primary_code':_0x27b8b1}},{'$group':{'_id':_0x2b2a71(0x231),'name':{'$first':_0x2b2a71(0x2c6)},'category':{'$first':'$category'},'brand':{'$first':_0x2b2a71(0x2ab)},'unit':{'$first':_0x2b2a71(0x317)},'alertquantity':{'$first':_0x2b2a71(0x27f)},'product_code':{'$first':_0x2b2a71(0x29b)},'primary_code':{'$first':_0x2b2a71(0x2c9)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x2b2a71(0x2f9)},'gross_price':{'$first':_0x2b2a71(0x2cf)},'sales_category':{'$first':_0x2b2a71(0x306)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x6ca6f0=await product['aggregate']([{'$match':{'secondary_code':_0x27b8b1}},{'$group':{'_id':'$_id','name':{'$first':_0x2b2a71(0x2c6)},'category':{'$first':_0x2b2a71(0x22c)},'brand':{'$first':_0x2b2a71(0x2ab)},'unit':{'$first':_0x2b2a71(0x317)},'alertquantity':{'$first':_0x2b2a71(0x27f)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x2b2a71(0x2c9)},'secondary_code':{'$first':_0x2b2a71(0x30d)},'maxStocks':{'$first':_0x2b2a71(0x2d3)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'},'gross_price':{'$first':_0x2b2a71(0x2cf)},'sales_category':{'$first':_0x2b2a71(0x306)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x1c2d93['length']>0x0)_0x5cd0e1=_0x1c2d93;else _0x6ca6f0[_0x2b2a71(0x316)]>0x0&&(_0x5cd0e1=_0x6ca6f0);_0x5047ae[_0x2b2a71(0x296)](_0x5cd0e1);}),router['post'](a0_0x5cdbc7(0x230),async(_0x4f0eab,_0x560d2a)=>{var _0x1fdb90=a0_0x5cdbc7;try{const {group_id:_0x4dfd47,DRSI:_0x2e2b96,dateofreq:_0x113cca,PO_number:_0x5a1513,date:_0x2ec26c,warehouse_name:_0x11eca2,typevehicle:_0x370a2f,deliverydate:_0x19f084,driver:_0x47972c,plate:_0x10aacc,van:_0x4d98ef,TSU:_0x54dd44,actual_delivery_date:_0x36faf7,TFU:_0x22ffca,pull_out_date:_0x50e2e9,sales:_0x55af7d,Customer_data:_0x3ef095,note:_0x22633d}=_0x4f0eab['body'],_0x2eb08f=mongoose['Types'][_0x1fdb90(0x265)];let _0x1486a9=[];const _0x5b2a3c=new invoice_for_outgoing();await _0x5b2a3c[_0x1fdb90(0x2b1)]();const _0x2a4b28=_0x1fdb90(0x233)+_0x5b2a3c[_0x1fdb90(0x259)][_0x1fdb90(0x2e3)]()['padStart'](0x8,'0');if(typeof _0x4dfd47=='string'){let _0x32d2cf=_0x4dfd47[_0x1fdb90(0x313)]('~');var _0xa14c54=_0x2eb08f(_0x32d2cf[0x0]),_0x3697da=_0x2eb08f(_0x32d2cf[0x1]),_0xf364a5=_0x32d2cf[0x2];let _0x493244=0x0;const _0x368568=await warehouse[_0x1fdb90(0x25e)]([{'$match':{'_id':_0xa14c54}},{'$unwind':_0x1fdb90(0x2d8)},{'$match':{'product_details._id':_0x3697da}}]);await warehouse[_0x1fdb90(0x249)]({'_id':_0x2eb08f(_0xa14c54),'product_details._id':_0x2eb08f(_0x3697da)},{'$set':{'product_details.$.isUsed':'true'}}),_0x1486a9[_0x493244]={};for(let _0x550518=0x0;_0x550518<=_0x368568[_0x1fdb90(0x316)]-0x1;_0x550518++){const _0x348762=_0x368568[_0x550518];console[_0x1fdb90(0x2d2)](_0x348762),_0x1486a9[_0x493244][_0x1fdb90(0x30e)]=_0x348762[_0x1fdb90(0x2a4)],_0x1486a9[_0x493244][_0x1fdb90(0x2ba)]=_0x348762['product_details'][_0x1fdb90(0x2ba)],_0x1486a9[_0x493244][_0x1fdb90(0x2a3)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x2a3)],_0x1486a9[_0x493244][_0x1fdb90(0x2b9)]=_0x348762['product_details']['product_code'],_0x1486a9[_0x493244]['product_stock']=_0xf364a5,_0x1486a9[_0x493244][_0x1fdb90(0x2f8)]=_0xf364a5,_0x1486a9[_0x493244]['unit']=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x273)],_0x1486a9[_0x493244][_0x1fdb90(0x320)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x320)],_0x1486a9[_0x493244][_0x1fdb90(0x312)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x312)],_0x1486a9[_0x493244][_0x1fdb90(0x23a)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x23a)],_0x1486a9[_0x493244][_0x1fdb90(0x2a8)]=_0x348762[_0x1fdb90(0x323)]['primary_code'],_0x1486a9[_0x493244][_0x1fdb90(0x24c)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x24c)],_0x1486a9[_0x493244][_0x1fdb90(0x212)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x212)],_0x1486a9[_0x493244][_0x1fdb90(0x229)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x229)],_0x1486a9[_0x493244]['expiry_date']=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x1ed)],_0x1486a9[_0x493244][_0x1fdb90(0x264)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x264)],_0x1486a9[_0x493244][_0x1fdb90(0x2d5)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x2d5)],_0x1486a9[_0x493244][_0x1fdb90(0x1fc)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x1fc)],_0x1486a9[_0x493244][_0x1fdb90(0x314)]=_0x348762[_0x1fdb90(0x201)],_0x1486a9[_0x493244][_0x1fdb90(0x24b)]=_0x348762['product_details'][_0x1fdb90(0x24b)],_0x1486a9[_0x493244][_0x1fdb90(0x281)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x281)],_0x1486a9[_0x493244]['gross_price']=_0x348762['product_details'][_0x1fdb90(0x30a)],_0x1486a9[_0x493244][_0x1fdb90(0x325)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x232)],_0x1486a9[_0x493244][_0x1fdb90(0x235)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x235)],_0x1486a9[_0x493244][_0x1fdb90(0x32e)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x232)],_0x1486a9[_0x493244][_0x1fdb90(0x1e4)]=_0x348762['_id'][_0x1fdb90(0x2e4)](),_0x1486a9[_0x493244][_0x1fdb90(0x2d1)]=_0x348762[_0x1fdb90(0x323)][_0x1fdb90(0x26e)][_0x1fdb90(0x2e4)](),_0x1486a9[_0x493244]['data_type']=_0x1fdb90(0x1e2),_0x1486a9[_0x493244][_0x1fdb90(0x295)]=_0x348762['product_details'][_0x1fdb90(0x232)];}_0x1486a9[_0x493244][_0x1fdb90(0x263)]=_0x2a4b28;}else for(let _0x4e0a55=0x0;_0x4e0a55<=_0x4dfd47[_0x1fdb90(0x316)]-0x1;_0x4e0a55++){const _0x214173=_0x4dfd47[_0x4e0a55];let _0x39dc77=_0x214173['split']('~');console[_0x1fdb90(0x2d2)](_0x39dc77);var _0xa14c54=_0x2eb08f(_0x39dc77[0x0]),_0x3697da=_0x2eb08f(_0x39dc77[0x1]),_0xf364a5=_0x39dc77[0x2];const _0x742bf9=await warehouse['aggregate']([{'$match':{'_id':_0xa14c54}},{'$unwind':_0x1fdb90(0x2d8)},{'$match':{'product_details._id':_0x3697da}}]);await warehouse[_0x1fdb90(0x249)]({'_id':_0x2eb08f(_0xa14c54),'product_details._id':_0x2eb08f(_0x3697da)},{'$set':{'product_details.$.isUsed':_0x1fdb90(0x21b)}}),_0x1486a9[_0x4e0a55]={};for(let _0x1645b3=0x0;_0x1645b3<=_0x742bf9[_0x1fdb90(0x316)]-0x1;_0x1645b3++){const _0x139cc2=_0x742bf9[_0x1645b3];_0x1486a9[_0x4e0a55]['warehouse']=_0x139cc2[_0x1fdb90(0x2a4)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x2ba)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x2ba)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x2a3)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x2a3)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x2b9)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x2b9)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x22b)]=_0xf364a5,_0x1486a9[_0x4e0a55]['quantity']=_0xf364a5,_0x1486a9[_0x4e0a55][_0x1fdb90(0x273)]=_0x139cc2['product_details'][_0x1fdb90(0x273)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x320)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x320)],_0x1486a9[_0x4e0a55]['level']=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x312)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x23a)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x23a)],_0x1486a9[_0x4e0a55]['primary_code']=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x2a8)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x24c)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x24c)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x212)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x212)],_0x1486a9[_0x4e0a55]['batch_code']=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x229)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x1ed)]=_0x139cc2['product_details'][_0x1fdb90(0x1ed)],_0x1486a9[_0x4e0a55]['production_date']=_0x139cc2['product_details'][_0x1fdb90(0x264)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x2d5)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x2d5)],_0x1486a9[_0x4e0a55]['product_cat']=_0x139cc2[_0x1fdb90(0x323)]['product_cat'],_0x1486a9[_0x4e0a55][_0x1fdb90(0x314)]=_0x139cc2[_0x1fdb90(0x201)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x24b)]=_0x139cc2[_0x1fdb90(0x323)]['invoice'],_0x1486a9[_0x4e0a55][_0x1fdb90(0x281)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x281)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x30a)]=_0x139cc2['product_details'][_0x1fdb90(0x30a)],_0x1486a9[_0x4e0a55]['sales_category']=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x232)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x235)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x235)],_0x1486a9[_0x4e0a55][_0x1fdb90(0x32e)]=_0x139cc2[_0x1fdb90(0x323)]['sales'],_0x1486a9[_0x4e0a55]['warehouse_id']=_0x139cc2[_0x1fdb90(0x26e)]['valueOf'](),_0x1486a9[_0x4e0a55][_0x1fdb90(0x2d1)]=_0x139cc2[_0x1fdb90(0x323)]['_id']['valueOf'](),_0x1486a9[_0x4e0a55][_0x1fdb90(0x2e7)]=_0x1fdb90(0x1e2),_0x1486a9[_0x4e0a55][_0x1fdb90(0x295)]=_0x139cc2[_0x1fdb90(0x323)][_0x1fdb90(0x232)];}_0x1486a9[_0x4e0a55][_0x1fdb90(0x263)]=_0x2a4b28;}for(let _0x2844c7=0x0;_0x2844c7<=_0x1486a9['length']-0x1;_0x2844c7++){const _0x5b7ec8=_0x1486a9[_0x2844c7],_0x5366df=new warehouse_temporary(_0x5b7ec8);await _0x5366df[_0x1fdb90(0x2b1)]();}const _0x1896fc=new sales_finished({'invoice':_0x2a4b28,'sales_data':_0x55af7d,'customer':_0x3ef095,'date':_0x2ec26c,'warehouse_name':_0x11eca2,'sale_product':_0x1486a9,'note':_0x22633d,'finalize':_0x1fdb90(0x321),'dateofreq':_0x113cca,'PO_number':_0x5a1513,'typevehicle':_0x370a2f,'deliverydate':_0x19f084,'driver':_0x47972c,'plate':_0x10aacc,'van':_0x4d98ef,'DRSI':_0x2e2b96,'TSU':_0x54dd44,'TFU':_0x22ffca,'pullout_date':_0x50e2e9,'actualdelivery_date':_0x36faf7,'typeOfProducts':_0x1fdb90(0x1e7)}),_0x36e8fa=await _0x1896fc['save']();_0x4f0eab[_0x1fdb90(0x21f)](_0x1fdb90(0x2f6),_0x1fdb90(0x20b)),_0x560d2a[_0x1fdb90(0x2ad)](_0x1fdb90(0x2a1)+_0x36e8fa['_id']);}catch(_0x3b136a){console[_0x1fdb90(0x2d2)](_0x3b136a);}}),module[a0_0x5cdbc7(0x2ec)]=router;