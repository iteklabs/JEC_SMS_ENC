var a0_0x1676be=a0_0x470d;(function(_0x15c0a6,_0x5994b6){var _0x4cc76f=a0_0x470d,_0x5a842a=_0x15c0a6();while(!![]){try{var _0x29cf1d=-parseInt(_0x4cc76f(0x1dd))/0x1*(parseInt(_0x4cc76f(0x1d2))/0x2)+-parseInt(_0x4cc76f(0x264))/0x3+parseInt(_0x4cc76f(0x223))/0x4*(-parseInt(_0x4cc76f(0x2a6))/0x5)+parseInt(_0x4cc76f(0x25c))/0x6*(parseInt(_0x4cc76f(0x2b6))/0x7)+parseInt(_0x4cc76f(0x2b4))/0x8*(parseInt(_0x4cc76f(0x2a0))/0x9)+parseInt(_0x4cc76f(0x209))/0xa*(parseInt(_0x4cc76f(0x186))/0xb)+-parseInt(_0x4cc76f(0x2ba))/0xc*(-parseInt(_0x4cc76f(0x205))/0xd);if(_0x29cf1d===_0x5994b6)break;else _0x5a842a['push'](_0x5a842a['shift']());}catch(_0x53b784){_0x5a842a['push'](_0x5a842a['shift']());}}}(a0_0x5372,0x23a9d));function a0_0x470d(_0x303794,_0xf35663){var _0x5372dd=a0_0x5372();return a0_0x470d=function(_0x470d2b,_0x324d60){_0x470d2b=_0x470d2b-0x170;var _0x111759=_0x5372dd[_0x470d2b];return _0x111759;},a0_0x470d(_0x303794,_0xf35663);}const express=require(a0_0x1676be(0x202)),app=express(),router=express[a0_0x1676be(0x20f)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require(a0_0x1676be(0x27f)),auth=require(a0_0x1676be(0x288)),nodemailer=require('nodemailer'),users=require('../public/language/languages.json'),mongoose=require(a0_0x1676be(0x2aa));router[a0_0x1676be(0x1ac)]('/view',auth,async(_0x2b592f,_0x2504bf)=>{var _0x4537df=a0_0x1676be;try{const {username:_0x17ff4d,email:_0x590876,role:_0x510e44}=_0x2b592f['user'],_0x58b267=_0x2b592f['user'],_0x31f893=await profile['findOne']({'email':_0x58b267['email']}),_0x505a9b=await master_shop['find']();let _0x4aeb39;if(_0x58b267[_0x4537df(0x292)]==_0x4537df(0x252)){const _0x51ca51=await staff[_0x4537df(0x29f)]({'email':_0x58b267[_0x4537df(0x25e)]});_0x4aeb39=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x4537df(0x246)}},{'$unwind':_0x4537df(0x184)},{'$group':{'_id':_0x4537df(0x224),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x4537df(0x24c)},'date':{'$first':_0x4537df(0x1ce)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x4537df(0x184)},'note':{'$first':_0x4537df(0x192)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x4537df(0x21e)},'total_saleproduct_quantity':{'$sum':_0x4537df(0x1a0)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x4537df(0x22c)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x4537df(0x226)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x4aeb39=await sales_finished['aggregate']([{'$match':{'typeOfProducts':'own'}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x4537df(0x224),'invoice':{'$first':_0x4537df(0x271)},'customers':{'$first':_0x4537df(0x24c)},'date':{'$first':_0x4537df(0x1ce)},'warehouse_name':{'$first':_0x4537df(0x1e5)},'sale_product':{'$push':_0x4537df(0x184)},'note':{'$first':_0x4537df(0x192)},'return_data':{'$first':_0x4537df(0x201)},'customers_docs':{'$first':_0x4537df(0x21e)},'total_saleproduct_quantity':{'$sum':_0x4537df(0x1a0)},'level':{'$addToSet':_0x4537df(0x25d)},'isle':{'$addToSet':_0x4537df(0x22c)},'type':{'$addToSet':_0x4537df(0x1b8)},'pallet':{'$addToSet':_0x4537df(0x182)},'finalize':{'$first':_0x4537df(0x226)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x505a9b[0x0][_0x4537df(0x22d)]=='English\x20(US)'){var _0x1b87cb=users[_0x4537df(0x257)];console[_0x4537df(0x212)](_0x1b87cb);}else{if(_0x505a9b[0x0][_0x4537df(0x22d)]==_0x4537df(0x183))var _0x1b87cb=users[_0x4537df(0x183)];else{if(_0x505a9b[0x0][_0x4537df(0x22d)]==_0x4537df(0x258))var _0x1b87cb=users['German'];else{if(_0x505a9b[0x0][_0x4537df(0x22d)]==_0x4537df(0x285))var _0x1b87cb=users['Spanish'];else{if(_0x505a9b[0x0][_0x4537df(0x22d)]==_0x4537df(0x26e))var _0x1b87cb=users[_0x4537df(0x26e)];else{if(_0x505a9b[0x0]['language']==_0x4537df(0x1c5))var _0x1b87cb=users['Portuguese'];else{if(_0x505a9b[0x0][_0x4537df(0x22d)]==_0x4537df(0x1bc))var _0x1b87cb=users['Chinese'];else{if(_0x505a9b[0x0][_0x4537df(0x22d)]==_0x4537df(0x1b1))var _0x1b87cb=users['Arabic'];}}}}}}}_0x2504bf['render'](_0x4537df(0x293),{'success':_0x2b592f['flash'](_0x4537df(0x1a4)),'errors':_0x2b592f[_0x4537df(0x1af)](_0x4537df(0x261)),'sales':_0x4aeb39,'profile':_0x31f893,'role':_0x58b267,'master_shop':_0x505a9b,'language':_0x1b87cb});}catch(_0xd7d78e){console['log'](_0xd7d78e);}}),router[a0_0x1676be(0x1ac)](a0_0x1676be(0x22e),auth,async(_0x2bb710,_0xaaee75)=>{var _0xd1a8d0=a0_0x1676be;try{const {username:_0x464681,email:_0x464d8e,role:_0x83bd1c}=_0x2bb710[_0xd1a8d0(0x260)],_0x3cab58=_0x2bb710[_0xd1a8d0(0x260)],_0x5ed398=await profile[_0xd1a8d0(0x29f)]({'email':_0x3cab58[_0xd1a8d0(0x25e)]}),_0x3655d0=await master_shop[_0xd1a8d0(0x195)]();let _0x21946a;if(_0x3cab58[_0xd1a8d0(0x292)]==_0xd1a8d0(0x252)){const _0x19142e=await staff[_0xd1a8d0(0x29f)]({'email':_0x3cab58[_0xd1a8d0(0x25e)]});_0x21946a=await sales_finished[_0xd1a8d0(0x24f)]([{'$match':{'typeOfProducts':'logs'}},{'$unwind':_0xd1a8d0(0x184)},{'$group':{'_id':_0xd1a8d0(0x224),'invoice':{'$first':'$invoice'},'customers':{'$first':_0xd1a8d0(0x24c)},'date':{'$first':_0xd1a8d0(0x1ce)},'warehouse_name':{'$first':_0xd1a8d0(0x1e5)},'sale_product':{'$push':_0xd1a8d0(0x184)},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0xd1a8d0(0x1a0)},'level':{'$addToSet':_0xd1a8d0(0x25d)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0xd1a8d0(0x1b8)},'pallet':{'$addToSet':_0xd1a8d0(0x182)},'finalize':{'$first':_0xd1a8d0(0x226)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x21946a=await sales_finished[_0xd1a8d0(0x24f)]([{'$match':{'typeOfProducts':_0xd1a8d0(0x1d8)}},{'$unwind':_0xd1a8d0(0x184)},{'$group':{'_id':_0xd1a8d0(0x224),'invoice':{'$first':_0xd1a8d0(0x271)},'customers':{'$first':_0xd1a8d0(0x24c)},'date':{'$first':_0xd1a8d0(0x1ce)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0xd1a8d0(0x184)},'note':{'$first':_0xd1a8d0(0x192)},'return_data':{'$first':_0xd1a8d0(0x201)},'customers_docs':{'$first':_0xd1a8d0(0x21e)},'total_saleproduct_quantity':{'$sum':_0xd1a8d0(0x1a0)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0xd1a8d0(0x22c)},'type':{'$addToSet':_0xd1a8d0(0x1b8)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0xd1a8d0(0x226)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x3655d0[0x0][_0xd1a8d0(0x22d)]==_0xd1a8d0(0x276)){var _0x6ed13c=users[_0xd1a8d0(0x257)];console[_0xd1a8d0(0x212)](_0x6ed13c);}else{if(_0x3655d0[0x0][_0xd1a8d0(0x22d)]==_0xd1a8d0(0x183))var _0x6ed13c=users[_0xd1a8d0(0x183)];else{if(_0x3655d0[0x0]['language']=='German')var _0x6ed13c=users[_0xd1a8d0(0x258)];else{if(_0x3655d0[0x0][_0xd1a8d0(0x22d)]==_0xd1a8d0(0x285))var _0x6ed13c=users[_0xd1a8d0(0x285)];else{if(_0x3655d0[0x0][_0xd1a8d0(0x22d)]==_0xd1a8d0(0x26e))var _0x6ed13c=users[_0xd1a8d0(0x26e)];else{if(_0x3655d0[0x0]['language']==_0xd1a8d0(0x1c5))var _0x6ed13c=users[_0xd1a8d0(0x29d)];else{if(_0x3655d0[0x0][_0xd1a8d0(0x22d)]==_0xd1a8d0(0x1bc))var _0x6ed13c=users[_0xd1a8d0(0x1bc)];else{if(_0x3655d0[0x0][_0xd1a8d0(0x22d)]=='Arabic\x20(ae)')var _0x6ed13c=users['Arabic'];}}}}}}}_0xaaee75['render'](_0xd1a8d0(0x26d),{'success':_0x2bb710['flash'](_0xd1a8d0(0x1a4)),'errors':_0x2bb710[_0xd1a8d0(0x1af)]('errors'),'sales':_0x21946a,'profile':_0x5ed398,'role':_0x3cab58,'master_shop':_0x3655d0,'language':_0x6ed13c});}catch(_0x51e133){console['log'](_0x51e133);}});async function getRandom8DigitNumber(){var _0x3e6a2b=a0_0x1676be;const _0x195547=0x989680,_0x4c5aa0=0x5f5e0ff,_0x3cd548=Math[_0x3e6a2b(0x19d)](Math[_0x3e6a2b(0x283)]()*(_0x4c5aa0-_0x195547+0x1))+_0x195547;var _0x1a78a2;const _0x57f50d=await sales_finished[_0x3e6a2b(0x29f)]({'invoice':_0x3e6a2b(0x281)+_0x3cd548});return _0x57f50d&&_0x57f50d['length']>0x0?_0x1a78a2=_0x3e6a2b(0x281)+_0x3cd548:_0x1a78a2=_0x3e6a2b(0x281)+_0x3cd548,_0x1a78a2;}router[a0_0x1676be(0x1ac)](a0_0x1676be(0x23f),auth,async(_0x235ba0,_0x4dcfce)=>{var _0xc4330=a0_0x1676be;try{const {username:_0x3e4500,email:_0x4b7818,role:_0xf4de7f}=_0x235ba0[_0xc4330(0x260)],_0x36c2fe=_0x235ba0[_0xc4330(0x260)],_0x35fb84=await profile['findOne']({'email':_0x36c2fe[_0xc4330(0x25e)]}),_0x2c4e7a=await master_shop[_0xc4330(0x195)](),_0x43db92=await customer['find']({});let _0x3ddd0e;if(_0x36c2fe['role']=='staff'){const _0x2ec3bb=await staff[_0xc4330(0x29f)]({'email':_0x36c2fe['email']});_0x3ddd0e=await warehouse[_0xc4330(0x24f)]([{'$match':{'status':'Enabled','name':_0x2ec3bb['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0xc4330(0x1fe)}}},{'$sort':{'name':0x1}}]);}else _0x3ddd0e=await warehouse[_0xc4330(0x24f)]([{'$match':{'status':_0xc4330(0x210)}},{'$group':{'_id':_0xc4330(0x1fe),'name':{'$first':_0xc4330(0x1fe)}}},{'$sort':{'name':0x1}}]);const _0x14feab=await product[_0xc4330(0x195)]({});var _0x522908=[_0xc4330(0x27b),_0xc4330(0x177)];const _0x3d0f31=await sales_finished[_0xc4330(0x195)]({}),_0xc36680=_0x3d0f31[_0xc4330(0x19a)]+0x1,_0x88a88='OUTF-'+_0xc36680[_0xc4330(0x1a2)]()[_0xc4330(0x18d)](0x5,'0');if(_0x2c4e7a[0x0][_0xc4330(0x22d)]==_0xc4330(0x276)){var _0x4f8522=users[_0xc4330(0x257)];console[_0xc4330(0x212)](_0x4f8522);}else{if(_0x2c4e7a[0x0]['language']==_0xc4330(0x183))var _0x4f8522=users[_0xc4330(0x183)];else{if(_0x2c4e7a[0x0][_0xc4330(0x22d)]==_0xc4330(0x258))var _0x4f8522=users[_0xc4330(0x258)];else{if(_0x2c4e7a[0x0][_0xc4330(0x22d)]==_0xc4330(0x285))var _0x4f8522=users[_0xc4330(0x285)];else{if(_0x2c4e7a[0x0]['language']==_0xc4330(0x26e))var _0x4f8522=users['French'];else{if(_0x2c4e7a[0x0][_0xc4330(0x22d)]=='Portuguese\x20(BR)')var _0x4f8522=users[_0xc4330(0x29d)];else{if(_0x2c4e7a[0x0][_0xc4330(0x22d)]=='Chinese')var _0x4f8522=users[_0xc4330(0x1bc)];else{if(_0x2c4e7a[0x0][_0xc4330(0x22d)]==_0xc4330(0x1b1))var _0x4f8522=users['Arabic'];}}}}}}}const _0x1467be=getRandom8DigitNumber();_0x1467be[_0xc4330(0x1da)](_0xdc6c27=>{var _0x155bda=_0xc4330;_0x4dcfce[_0x155bda(0x24d)]('add_sales_finished',{'success':_0x235ba0['flash'](_0x155bda(0x1a4)),'errors':_0x235ba0[_0x155bda(0x1af)](_0x155bda(0x261)),'role':_0x36c2fe,'profile':_0x35fb84,'customer':_0x43db92,'warehouse':_0x3ddd0e,'product':_0x14feab,'invoice':_0xdc6c27,'master_shop':_0x2c4e7a,'language':_0x4f8522,'rooms_data':_0x522908});})[_0xc4330(0x2bf)](_0x5ae962=>{var _0x9332a8=_0xc4330;_0x235ba0[_0x9332a8(0x1af)](_0x9332a8(0x261),_0x9332a8(0x1e4)),_0x4dcfce[_0x9332a8(0x26b)]('/all_sales_finished/view');});}catch(_0x50538f){console[_0xc4330(0x212)](_0x50538f);}}),router[a0_0x1676be(0x1ac)](a0_0x1676be(0x245),auth,async(_0x1ac7aa,_0x28c5a9)=>{var _0x28c7b0=a0_0x1676be;try{const {username:_0x5542ff,email:_0x47c878,role:_0x32dbb9}=_0x1ac7aa[_0x28c7b0(0x260)],_0x14c2ca=_0x1ac7aa['user'],_0x45318d=await profile[_0x28c7b0(0x29f)]({'email':_0x14c2ca[_0x28c7b0(0x25e)]}),_0x14dba7=await master_shop[_0x28c7b0(0x195)](),_0x62df70=await customer[_0x28c7b0(0x195)]({});let _0x41fd1a;if(_0x14c2ca[_0x28c7b0(0x292)]==_0x28c7b0(0x252)){const _0xa59e90=await staff[_0x28c7b0(0x29f)]({'email':_0x14c2ca[_0x28c7b0(0x25e)]});_0x41fd1a=await warehouse[_0x28c7b0(0x24f)]([{'$match':{'status':_0x28c7b0(0x210),'name':_0xa59e90['warehouse']}},{'$group':{'_id':_0x28c7b0(0x1fe),'name':{'$first':_0x28c7b0(0x1fe)}}},{'$sort':{'name':0x1}}]);}else _0x41fd1a=await warehouse[_0x28c7b0(0x24f)]([{'$match':{'status':_0x28c7b0(0x210)}},{'$group':{'_id':_0x28c7b0(0x1fe),'name':{'$first':_0x28c7b0(0x1fe)}}},{'$sort':{'name':0x1}}]);const _0x4fa6ef=await product[_0x28c7b0(0x195)]({});var _0x46fd44=['Ambient','Enclosed'];const _0x7cc9=await sales_finished[_0x28c7b0(0x195)]({}),_0x525383=_0x7cc9[_0x28c7b0(0x19a)]+0x1,_0x172841=_0x28c7b0(0x281)+_0x525383[_0x28c7b0(0x1a2)]()['padStart'](0x5,'0');if(_0x14dba7[0x0][_0x28c7b0(0x22d)]==_0x28c7b0(0x276)){var _0x4570e2=users[_0x28c7b0(0x257)];console[_0x28c7b0(0x212)](_0x4570e2);}else{if(_0x14dba7[0x0][_0x28c7b0(0x22d)]==_0x28c7b0(0x183))var _0x4570e2=users[_0x28c7b0(0x183)];else{if(_0x14dba7[0x0][_0x28c7b0(0x22d)]==_0x28c7b0(0x258))var _0x4570e2=users[_0x28c7b0(0x258)];else{if(_0x14dba7[0x0][_0x28c7b0(0x22d)]=='Spanish')var _0x4570e2=users['Spanish'];else{if(_0x14dba7[0x0][_0x28c7b0(0x22d)]=='French')var _0x4570e2=users[_0x28c7b0(0x26e)];else{if(_0x14dba7[0x0][_0x28c7b0(0x22d)]==_0x28c7b0(0x1c5))var _0x4570e2=users[_0x28c7b0(0x29d)];else{if(_0x14dba7[0x0][_0x28c7b0(0x22d)]==_0x28c7b0(0x1bc))var _0x4570e2=users[_0x28c7b0(0x1bc)];else{if(_0x14dba7[0x0][_0x28c7b0(0x22d)]=='Arabic\x20(ae)')var _0x4570e2=users[_0x28c7b0(0x218)];}}}}}}}const _0x5d0924=getRandom8DigitNumber();_0x5d0924[_0x28c7b0(0x1da)](_0x5066da=>{var _0xffe3c6=_0x28c7b0;_0x28c5a9['render'](_0xffe3c6(0x1ab),{'success':_0x1ac7aa[_0xffe3c6(0x1af)](_0xffe3c6(0x1a4)),'errors':_0x1ac7aa['flash'](_0xffe3c6(0x261)),'role':_0x14c2ca,'profile':_0x45318d,'customer':_0x62df70,'warehouse':_0x41fd1a,'product':_0x4fa6ef,'invoice':_0x5066da,'master_shop':_0x14dba7,'language':_0x4570e2,'rooms_data':_0x46fd44});})[_0x28c7b0(0x2bf)](_0x2054fd=>{var _0x51cf77=_0x28c7b0;_0x1ac7aa[_0x51cf77(0x1af)](_0x51cf77(0x261),_0x51cf77(0x1e4)),_0x28c5a9['redirect'](_0x51cf77(0x214));});}catch(_0x39f7d0){console[_0x28c7b0(0x212)](_0x39f7d0);}}),router['post'](a0_0x1676be(0x245),auth,async(_0x3996e4,_0x2989a6)=>{var _0x5c0327=a0_0x1676be;try{const {invoice:_0x23d3e5,date:_0x2fb4c9,warehouse_name:_0x25d72e,product_name:_0x173681,note:_0x3e9328,room:_0x4db86f,primary_code:_0x281ff0,secondary_code:_0x18f3ce,prod_code:_0x39ac9e,SCRN:_0x5efd94,ReqBy:_0x371ceb,dateofreq:_0x4b48e5,PO_number:_0x8eba3f,typeservicesData:_0x3d00e2,typevehicle:_0x2dfe2c,destination:_0x24c2e3,deliverydate:_0x2a015b,driver:_0x1b2885,plate:_0x3d6991,van:_0x312202,DRSI:_0x2e3cf5,TSU:_0x4a2822,TFU:_0xa7abae,mode_transpo:_0x2961f0,name_driver:_0x2ca485,type_of_products:_0x94b69c}=_0x3996e4[_0x5c0327(0x272)];if(typeof _0x173681==_0x5c0327(0x1b7))var _0xbe2271=[_0x3996e4['body'][_0x5c0327(0x1c4)]],_0x1da04b=[_0x3996e4['body']['stock']],_0x120795=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x26f)]],_0x56e507=[_0x3996e4[_0x5c0327(0x272)]['primary_code']],_0x3bca14=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1d4)]],_0x578a7d=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1e8)]],_0x545166=[_0x3996e4['body'][_0x5c0327(0x23e)]],_0x272db8=[_0x3996e4[_0x5c0327(0x272)]['primary_unit']],_0x9d13a7=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x243)]],_0x4f44ad=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1b0)]],_0xf430d5=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1ef)]],_0x3e0643=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1d3)]],_0xcfa45c=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x193)]],_0x35325f=[_0x3996e4[_0x5c0327(0x272)]['prod_cat']],_0x1a7ea7=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1df)]],_0x2f113f=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1ca)]],_0x468aa7=[_0x3996e4[_0x5c0327(0x272)]['id_transaction_from']],_0x46d27a=[_0x3996e4[_0x5c0327(0x272)]['uuid']],_0x5036aa=[_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x277)]];else var _0xbe2271=[..._0x3996e4['body'][_0x5c0327(0x1c4)]],_0x1da04b=[..._0x3996e4['body'][_0x5c0327(0x18f)]],_0x120795=[..._0x3996e4['body'][_0x5c0327(0x26f)]],_0x56e507=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x273)]],_0x3bca14=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1d4)]],_0x578a7d=[..._0x3996e4[_0x5c0327(0x272)]['prod_code']],_0x545166=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x23e)]],_0x272db8=[..._0x3996e4[_0x5c0327(0x272)]['primary_unit']],_0x9d13a7=[..._0x3996e4['body'][_0x5c0327(0x243)]],_0x4f44ad=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1b0)]],_0xf430d5=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1ef)]],_0x3e0643=[..._0x3996e4[_0x5c0327(0x272)]['product_date']],_0xcfa45c=[..._0x3996e4[_0x5c0327(0x272)]['max_per_unit']],_0x35325f=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x247)]],_0x1a7ea7=[..._0x3996e4['body'][_0x5c0327(0x1df)]],_0x2f113f=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1ca)]],_0x468aa7=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1ad)]],_0x46d27a=[..._0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x1fc)]],_0x5036aa=[..._0x3996e4[_0x5c0327(0x272)]['gross_price']];const _0x672408=_0xbe2271[_0x5c0327(0x286)](_0x500017=>{return _0x500017={'product_name':_0x500017};});_0x1da04b['forEach']((_0x51ba15,_0x129c6c)=>{var _0xb9d3f6=_0x5c0327;_0x672408[_0x129c6c][_0xb9d3f6(0x18f)]=_0x51ba15;}),_0x120795[_0x5c0327(0x2a7)]((_0x1b1aa3,_0x6d03c8)=>{var _0x5964f6=_0x5c0327;_0x672408[_0x6d03c8]['quantity']=Math[_0x5964f6(0x256)](_0x1b1aa3);}),_0xbe2271[_0x5c0327(0x2a7)]((_0x12e819,_0x587b63)=>{var _0x3910eb=_0x5c0327;_0x672408[_0x587b63][_0x3910eb(0x211)]=_0x3996e4[_0x3910eb(0x272)]['sales'];}),_0x5036aa[_0x5c0327(0x2a7)]((_0x3077f6,_0x36158c)=>{var _0x51edf8=_0x5c0327;_0x672408[_0x36158c][_0x51edf8(0x277)]=_0x3077f6;}),_0x46d27a[_0x5c0327(0x2a7)]((_0x269cf8,_0x4addc2)=>{var _0x2a0c1d=_0x5c0327;_0x672408[_0x4addc2][_0x2a0c1d(0x1fc)]=_0x269cf8;}),_0x468aa7[_0x5c0327(0x2a7)]((_0xf6bb99,_0x133a3d)=>{var _0x237799=_0x5c0327;_0x672408[_0x133a3d][_0x237799(0x1ad)]=_0xf6bb99;}),_0x56e507[_0x5c0327(0x2a7)]((_0x3a155b,_0x14eae7)=>{var _0x53b3f6=_0x5c0327;_0x672408[_0x14eae7][_0x53b3f6(0x273)]=_0x3a155b;}),_0x3bca14['forEach']((_0x1585fb,_0x1afd6b)=>{var _0xaea841=_0x5c0327;_0x672408[_0x1afd6b][_0xaea841(0x1d4)]=_0x1585fb;}),_0x578a7d[_0x5c0327(0x2a7)]((_0x348b43,_0x2e097c)=>{var _0x342d8e=_0x5c0327;_0x672408[_0x2e097c][_0x342d8e(0x2b1)]=_0x348b43;}),_0x545166[_0x5c0327(0x2a7)]((_0x1a571d,_0x5cb1a7)=>{var _0x125394=_0x5c0327,_0x295a39=_0x1a571d[_0x125394(0x275)](/[A-Za-z]+/)[0x0],_0x261bfc=parseInt(_0x1a571d[_0x125394(0x275)](/\d+/)[0x0]);_0x672408[_0x5cb1a7][_0x125394(0x27d)]=_0x261bfc,_0x672408[_0x5cb1a7]['level']=_0x295a39;}),_0x272db8[_0x5c0327(0x2a7)]((_0x277778,_0x11b6a0)=>{var _0x3ad2f4=_0x5c0327;_0x672408[_0x11b6a0][_0x3ad2f4(0x191)]=_0x277778;}),_0x9d13a7[_0x5c0327(0x2a7)]((_0x1a3741,_0x5932d5)=>{var _0x5a8a01=_0x5c0327;_0x672408[_0x5932d5][_0x5a8a01(0x243)]=_0x1a3741;}),_0x4f44ad[_0x5c0327(0x2a7)]((_0x3e02bf,_0x61368d)=>{_0x672408[_0x61368d]['batch_code']=_0x3e02bf;}),_0xf430d5[_0x5c0327(0x2a7)]((_0x2ccb9d,_0x9566a3)=>{var _0x380c90=_0x5c0327;_0x672408[_0x9566a3][_0x380c90(0x1ef)]=_0x2ccb9d;}),_0x3e0643[_0x5c0327(0x2a7)]((_0x5cfdc9,_0x302437)=>{var _0x776393=_0x5c0327;_0x672408[_0x302437][_0x776393(0x228)]=_0x5cfdc9;}),_0xcfa45c[_0x5c0327(0x2a7)]((_0x578ab3,_0x56624c)=>{var _0x10133c=_0x5c0327;_0x672408[_0x56624c][_0x10133c(0x1c3)]=_0x578ab3;}),_0x35325f['forEach']((_0x14177a,_0x5660c0)=>{var _0x25add1=_0x5c0327;_0x672408[_0x5660c0][_0x25add1(0x247)]=_0x14177a;}),_0x1a7ea7[_0x5c0327(0x2a7)]((_0x1a809d,_0x183605)=>{var _0x565aaf=_0x5c0327;_0x672408[_0x183605][_0x565aaf(0x1f9)]=_0x1a809d;}),_0x2f113f[_0x5c0327(0x2a7)]((_0x2390a0,_0x502691)=>{var _0x5b29bd=_0x5c0327;_0x672408[_0x502691][_0x5b29bd(0x1d7)]=_0x2390a0,_0x672408[_0x502691][_0x5b29bd(0x251)]=_0x2fb4c9;});const _0x511b55=new sales_logs();await _0x511b55[_0x5c0327(0x290)](),_0x2f113f[_0x5c0327(0x2a7)]((_0x4c3ff5,_0x2349af)=>{var _0x305c13=_0x5c0327;_0x672408[_0x2349af]['outgoing_invoice']=_0x305c13(0x1ae)+_0x511b55[_0x305c13(0x287)][_0x305c13(0x1a2)]()[_0x305c13(0x18d)](0x8,'0');});var _0x192a27=0x0;_0x672408[_0x5c0327(0x2a7)](_0x15161a=>{var _0x2b6580=_0x5c0327;parseFloat(_0x15161a['stock'])<parseFloat(_0x15161a['quantity'])&&parseFloat(_0x15161a[_0x2b6580(0x219)])>parseFloat(_0x15161a[_0x2b6580(0x18f)])&&(console[_0x2b6580(0x212)](_0x15161a['stock']+_0x2b6580(0x2ab)+_0x15161a[_0x2b6580(0x219)]),_0x192a27++);});if(_0x192a27!=0x0)return _0x3996e4[_0x5c0327(0x1af)]('errors','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x2989a6['redirect'](_0x5c0327(0x231));const _0x1e33ab=_0x672408['filter'](_0x5038d8=>_0x5038d8[_0x5c0327(0x219)]!=='0'&&_0x5038d8[_0x5c0327(0x219)]!==''),_0x4fe6a2=new sales_finished({'invoice':_0x5c0327(0x1ae)+_0x511b55[_0x5c0327(0x287)][_0x5c0327(0x1a2)]()[_0x5c0327(0x18d)](0x8,'0'),'sales_data':_0x3996e4[_0x5c0327(0x272)][_0x5c0327(0x244)],'customer':_0x3996e4[_0x5c0327(0x272)]['customer'],'date':_0x2fb4c9,'warehouse_name':_0x25d72e,'sale_product':_0x1e33ab,'note':_0x3e9328,'room':_0x4db86f,'primary_code':_0x281ff0,'secondary_code':_0x18f3ce,'prod_code':_0x39ac9e,'SCRN':_0x5efd94,'finalize':_0x5c0327(0x26c),'mode_transpo':_0x2961f0,'name_driver':_0x2ca485,'ReqBy':_0x371ceb,'dateofreq':_0x4b48e5,'PO_number':_0x8eba3f,'typeservicesData':_0x3d00e2,'typevehicle':_0x2dfe2c,'destination':_0x24c2e3,'deliverydate':_0x2a015b,'driver':_0x1b2885,'plate':_0x3d6991,'van':_0x312202,'DRSI':_0x2e3cf5,'TSU':_0x4a2822,'TFU':_0xa7abae,'typeOfProducts':_0x94b69c}),_0x2bb541=await _0x4fe6a2[_0x5c0327(0x290)](),_0x2e8959=await sales_finished[_0x5c0327(0x29f)]({'invoice':_0x23d3e5});_0x3996e4['flash'](_0x5c0327(0x1a4),_0x5c0327(0x21a)),_0x2989a6[_0x5c0327(0x26b)](_0x5c0327(0x1b2)+_0x2bb541['_id']);}catch(_0x135f00){console[_0x5c0327(0x212)](_0x135f00);}}),router[a0_0x1676be(0x1ac)](a0_0x1676be(0x2ae),auth,async(_0x2bd6f4,_0x10ac17)=>{var _0x2e03d6=a0_0x1676be;try{const _0x4b25ae=_0x2bd6f4[_0x2e03d6(0x2ad)]['id'];console[_0x2e03d6(0x212)](_0x4b25ae);const _0x5400d6=await product[_0x2e03d6(0x195)](),_0x575c56=await purchases[_0x2e03d6(0x24f)]([{'$match':{'warehouse_name':_0x4b25ae}},{'$unwind':_0x2e03d6(0x19e)},{'$group':{'_id':'$product.product_name'}}]);console[_0x2e03d6(0x212)](_0x2e03d6(0x29e),_0x575c56),_0x10ac17[_0x2e03d6(0x235)](0xc8)['json']({'purchases_data':_0x575c56,'product_data':_0x5400d6});}catch(_0x1883d4){console[_0x2e03d6(0x212)](_0x1883d4);}}),router[a0_0x1676be(0x28b)](a0_0x1676be(0x1a5),auth,async(_0x4e4f2a,_0x3fe030)=>{var _0x1b0302=a0_0x1676be;try{const {warehouse_data:_0x195157,product_data:_0x5e2422}=_0x4e4f2a[_0x1b0302(0x272)];console[_0x1b0302(0x212)](_0x4e4f2a['body'][_0x1b0302(0x216)]);;const _0x3021ba=await master_shop[_0x1b0302(0x195)]();console['log'](_0x1b0302(0x1f8),_0x3021ba);const _0x145eb1=await product[_0x1b0302(0x29f)]({'name':_0x5e2422});console[_0x1b0302(0x212)]('product',_0x145eb1);const _0x4ad715=await warehouse['aggregate']([{'$match':{'name':_0x195157}},{'$unwind':_0x1b0302(0x2ac)},{'$match':{'product_details.product_name':_0x5e2422}},{'$group':{'_id':_0x1b0302(0x28f),'product_stock':{'$first':_0x1b0302(0x22f)}}}]);console[_0x1b0302(0x212)](_0x1b0302(0x1dc),_0x4ad715),_0x3fe030['status'](0xc8)[_0x1b0302(0x1a6)]({'master':_0x3021ba,'new_product':_0x145eb1,'stock_data':_0x4ad715});}catch(_0x1daca2){console['log'](_0x1daca2);}}),router[a0_0x1676be(0x28b)](a0_0x1676be(0x23f),auth,async(_0x594368,_0xe6430f)=>{var _0x30aef9=a0_0x1676be;try{const {invoice:_0x188942,date:_0x1de5f6,warehouse_name:_0xf3c7e3,product_name:_0x311477,note:_0x45d8a3,room:_0x5a543f,primary_code:_0x50a816,secondary_code:_0x515253,prod_code:_0x42401d,SCRN:_0x1ace54,ReqBy:_0x77782c,dateofreq:_0xa6961c,PO_number:_0x22fdb3,typeservicesData:_0x385a94,typevehicle:_0x348da5,destination:_0x2415b9,deliverydate:_0x394b05,driver:_0x1a1006,plate:_0x51d377,van:_0x210043,DRSI:_0x399ff2,TSU:_0x142471,TFU:_0x2ab3fe,mode_transpo:_0x5aadec,name_driver:_0xe69a72,pull_out_date:_0x415f1c,actual_delivery_date:_0x15ac69}=_0x594368[_0x30aef9(0x272)];_0xe6430f[_0x30aef9(0x1a6)](_0x594368[_0x30aef9(0x272)]);return;if(typeof _0x311477==_0x30aef9(0x1b7))var _0x29f46f=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x1c4)]],_0x3873de=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x18f)]],_0x17ae0c=[_0x594368['body']['carton']],_0x178447=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x273)]],_0x43ba2d=[_0x594368[_0x30aef9(0x272)]['secondary_code']],_0x32b232=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x1e8)]],_0x2e1fb4=[_0x594368[_0x30aef9(0x272)]['level2']],_0x42010b=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x279)]],_0x574ae5=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x243)]],_0x3ed049=[_0x594368[_0x30aef9(0x272)]['batch_code']],_0x4635af=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x1ef)]],_0x224a05=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x1d3)]],_0x290813=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x193)]],_0x370f07=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x247)]],_0x1a9f39=[_0x594368['body'][_0x30aef9(0x1df)]],_0x1ae2f7=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x1ca)]],_0x275174=[_0x594368['body'][_0x30aef9(0x1ad)]],_0x517140=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x1fc)]],_0x5ce470=[_0x594368[_0x30aef9(0x272)][_0x30aef9(0x277)]];else var _0x29f46f=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x1c4)]],_0x3873de=[..._0x594368[_0x30aef9(0x272)]['stock']],_0x17ae0c=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x26f)]],_0x178447=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x273)]],_0x43ba2d=[..._0x594368[_0x30aef9(0x272)]['secondary_code']],_0x32b232=[..._0x594368['body'][_0x30aef9(0x1e8)]],_0x2e1fb4=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x23e)]],_0x42010b=[..._0x594368[_0x30aef9(0x272)]['primary_unit']],_0x574ae5=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x243)]],_0x3ed049=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x1b0)]],_0x4635af=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x1ef)]],_0x224a05=[..._0x594368['body']['product_date']],_0x290813=[..._0x594368['body']['max_per_unit']],_0x370f07=[..._0x594368[_0x30aef9(0x272)]['prod_cat']],_0x1a9f39=[..._0x594368[_0x30aef9(0x272)]['RoomAssigned']],_0x1ae2f7=[..._0x594368[_0x30aef9(0x272)]['prod_invoice']],_0x275174=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x1ad)]],_0x517140=[..._0x594368[_0x30aef9(0x272)][_0x30aef9(0x1fc)]],_0x5ce470=[..._0x594368[_0x30aef9(0x272)]['gross_price']];const _0x434d16=_0x29f46f[_0x30aef9(0x286)](_0x4ba161=>{return _0x4ba161={'product_name':_0x4ba161};});_0x3873de[_0x30aef9(0x2a7)]((_0x865077,_0x363f53)=>{var _0x4606ae=_0x30aef9;_0x434d16[_0x363f53][_0x4606ae(0x18f)]=_0x865077;}),_0x17ae0c[_0x30aef9(0x2a7)]((_0x1f8384,_0x35e461)=>{var _0x27f334=_0x30aef9;_0x434d16[_0x35e461][_0x27f334(0x219)]=Math['abs'](_0x1f8384);}),_0x29f46f[_0x30aef9(0x2a7)]((_0x135095,_0x2f3fa1)=>{var _0xc9120d=_0x30aef9;_0x434d16[_0x2f3fa1]['agent_id']=_0x594368[_0xc9120d(0x272)][_0xc9120d(0x244)];}),_0x5ce470[_0x30aef9(0x2a7)]((_0x23fa02,_0x549b89)=>{var _0x2616a1=_0x30aef9;_0x434d16[_0x549b89][_0x2616a1(0x277)]=_0x23fa02;}),_0x517140[_0x30aef9(0x2a7)]((_0x35d2dc,_0x5c19b7)=>{var _0x45c44=_0x30aef9;_0x434d16[_0x5c19b7][_0x45c44(0x1fc)]=_0x35d2dc;}),_0x275174['forEach']((_0xbd5827,_0x4d1a5e)=>{var _0x1a4b53=_0x30aef9;_0x434d16[_0x4d1a5e][_0x1a4b53(0x1ad)]=_0xbd5827;}),_0x178447[_0x30aef9(0x2a7)]((_0x1779f4,_0x493adf)=>{var _0x9f805b=_0x30aef9;_0x434d16[_0x493adf][_0x9f805b(0x273)]=_0x1779f4;}),_0x43ba2d[_0x30aef9(0x2a7)]((_0x33e746,_0x1f6b3d)=>{var _0x4a0fdf=_0x30aef9;_0x434d16[_0x1f6b3d][_0x4a0fdf(0x1d4)]=_0x33e746;}),_0x32b232[_0x30aef9(0x2a7)]((_0x443f40,_0x12d427)=>{_0x434d16[_0x12d427]['product_code']=_0x443f40;}),_0x2e1fb4[_0x30aef9(0x2a7)]((_0x4c25cd,_0x8f79c8)=>{var _0x1cb6ff=_0x30aef9,_0xbb5703=_0x4c25cd[_0x1cb6ff(0x275)](/[A-Za-z]+/)[0x0],_0x5f4e8e=parseInt(_0x4c25cd[_0x1cb6ff(0x275)](/\d+/)[0x0]);_0x434d16[_0x8f79c8][_0x1cb6ff(0x27d)]=_0x5f4e8e,_0x434d16[_0x8f79c8][_0x1cb6ff(0x1e7)]=_0xbb5703;}),_0x42010b[_0x30aef9(0x2a7)]((_0x3e297a,_0x359bfd)=>{var _0x1f22ed=_0x30aef9;_0x434d16[_0x359bfd][_0x1f22ed(0x191)]=_0x3e297a;}),_0x574ae5['forEach']((_0x29fe2f,_0x4cf0f3)=>{var _0x13d41a=_0x30aef9;_0x434d16[_0x4cf0f3][_0x13d41a(0x243)]=_0x29fe2f;}),_0x3ed049[_0x30aef9(0x2a7)]((_0x1da391,_0x3ebbb0)=>{var _0x4589e6=_0x30aef9;_0x434d16[_0x3ebbb0][_0x4589e6(0x1b0)]=_0x1da391;}),_0x4635af[_0x30aef9(0x2a7)]((_0x1d16d4,_0x4935ca)=>{var _0x19c940=_0x30aef9;_0x434d16[_0x4935ca][_0x19c940(0x1ef)]=_0x1d16d4;}),_0x224a05[_0x30aef9(0x2a7)]((_0x46eae0,_0xecc673)=>{_0x434d16[_0xecc673]['production_date']=_0x46eae0;}),_0x290813[_0x30aef9(0x2a7)]((_0x1d13c1,_0x2cb992)=>{var _0x543643=_0x30aef9;_0x434d16[_0x2cb992][_0x543643(0x1c3)]=_0x1d13c1;}),_0x370f07[_0x30aef9(0x2a7)]((_0x2ff40c,_0x1876f2)=>{var _0x37bd68=_0x30aef9;_0x434d16[_0x1876f2][_0x37bd68(0x247)]=_0x2ff40c;}),_0x1a9f39[_0x30aef9(0x2a7)]((_0x24579d,_0x5f117a)=>{_0x434d16[_0x5f117a]['room_name']=_0x24579d;}),_0x1ae2f7[_0x30aef9(0x2a7)]((_0x1f7f31,_0x40882c)=>{var _0x319b3a=_0x30aef9;_0x434d16[_0x40882c][_0x319b3a(0x1d7)]=_0x1f7f31,_0x434d16[_0x40882c][_0x319b3a(0x251)]=_0x1de5f6;});const _0x1c5589=new invoice_for_outgoing();await _0x1c5589[_0x30aef9(0x290)](),_0x1ae2f7[_0x30aef9(0x2a7)]((_0x3fcb0e,_0x222e6e)=>{var _0xddad95=_0x30aef9;_0x434d16[_0x222e6e]['outgoing_invoice']='OUT-'+_0x1c5589[_0xddad95(0x287)][_0xddad95(0x1a2)]()[_0xddad95(0x18d)](0x8,'0');});var _0x21d143=0x0;_0x434d16[_0x30aef9(0x2a7)](_0x4e2ad6=>{var _0x3a7e26=_0x30aef9;parseFloat(_0x4e2ad6[_0x3a7e26(0x18f)])<parseFloat(_0x4e2ad6['quantity'])&&parseFloat(_0x4e2ad6[_0x3a7e26(0x219)])>parseFloat(_0x4e2ad6[_0x3a7e26(0x18f)])&&(console[_0x3a7e26(0x212)](_0x4e2ad6[_0x3a7e26(0x18f)]+_0x3a7e26(0x2ab)+_0x4e2ad6['quantity']),_0x21d143++);});if(_0x21d143!=0x0)return _0x594368['flash']('errors',_0x30aef9(0x2a3)),_0xe6430f['redirect']('back');const _0x1c479c=_0x434d16[_0x30aef9(0x208)](_0x3cf755=>_0x3cf755[_0x30aef9(0x219)]!=='0'&&_0x3cf755[_0x30aef9(0x219)]!==''),_0x501b3c=new sales_finished({'invoice':_0x30aef9(0x280)+_0x1c5589[_0x30aef9(0x287)][_0x30aef9(0x1a2)]()[_0x30aef9(0x18d)](0x8,'0'),'sales_data':_0x594368['body'][_0x30aef9(0x244)],'customer':_0x594368[_0x30aef9(0x272)]['customer'],'date':_0x1de5f6,'warehouse_name':_0xf3c7e3,'sale_product':_0x1c479c,'note':_0x45d8a3,'room':_0x5a543f,'primary_code':_0x50a816,'secondary_code':_0x515253,'prod_code':_0x42401d,'SCRN':_0x1ace54,'finalize':'False','mode_transpo':_0x5aadec,'name_driver':_0xe69a72,'ReqBy':_0x77782c,'dateofreq':_0xa6961c,'PO_number':_0x22fdb3,'typeservicesData':_0x385a94,'typevehicle':_0x348da5,'destination':_0x2415b9,'deliverydate':_0x394b05,'driver':_0x1a1006,'plate':_0x51d377,'van':_0x210043,'DRSI':_0x399ff2,'TSU':_0x142471,'TFU':_0x2ab3fe,'pullout_date':_0x415f1c,'actualdelivery_date':_0x15ac69,'typeOfProducts':_0x30aef9(0x246)}),_0x3ceb65=await _0x501b3c['save'](),_0x177a21=await sales_finished[_0x30aef9(0x29f)]({'invoice':_0x188942});_0x594368[_0x30aef9(0x1af)]('success','Sales\x20Add\x20successfully'),_0xe6430f[_0x30aef9(0x26b)](_0x30aef9(0x1b2)+_0x3ceb65[_0x30aef9(0x299)]);}catch(_0x4811ca){console['log'](_0x4811ca);}}),router[a0_0x1676be(0x1ac)](a0_0x1676be(0x28e),auth,async(_0x89b500,_0x213ecb)=>{var _0x5efbaf=a0_0x1676be;try{const {username:_0x35eb46,email:_0x33a396,role:_0x2e2c9b}=_0x89b500[_0x5efbaf(0x260)],_0x1d2038=_0x89b500['user'],_0x449e27=await profile[_0x5efbaf(0x29f)]({'email':_0x1d2038[_0x5efbaf(0x25e)]}),_0x571ada=await master_shop[_0x5efbaf(0x195)](),_0x31d832=_0x89b500[_0x5efbaf(0x2ad)]['id'],_0x35c449=await sales_finished['findById'](_0x31d832),_0x2f670a=await warehouse[_0x5efbaf(0x24f)]([{'$match':{'name':_0x35c449[_0x5efbaf(0x268)]}},{'$unwind':_0x5efbaf(0x2ac)},{'$group':{'_id':_0x5efbaf(0x173),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5efbaf(0x174)},'primary_code':{'$first':_0x5efbaf(0x19b)},'secondary_code':{'$first':_0x5efbaf(0x1c1)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5efbaf(0x1b9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x5efbaf(0x221)},'room':{'$first':_0x5efbaf(0x199)},'room_data':{'$first':_0x5efbaf(0x297)}}}]),_0x532941=await customer[_0x5efbaf(0x195)]({});let _0x5f111e;if(_0x1d2038[_0x5efbaf(0x292)]==_0x5efbaf(0x252)){const _0x4af45c=await staff[_0x5efbaf(0x29f)]({'email':_0x1d2038[_0x5efbaf(0x25e)]});_0x5f111e=await warehouse[_0x5efbaf(0x24f)]([{'$match':{'status':_0x5efbaf(0x210),'name':_0x4af45c[_0x5efbaf(0x220)]}},{'$group':{'_id':_0x5efbaf(0x1fe),'name':{'$first':_0x5efbaf(0x1fe)}}}]);}else _0x5f111e=await warehouse[_0x5efbaf(0x24f)]([{'$match':{'status':_0x5efbaf(0x210)}},{'$group':{'_id':_0x5efbaf(0x1fe),'name':{'$first':_0x5efbaf(0x1fe)}}}]);const _0x1ae3db=await product['find']({});if(_0x571ada[0x0][_0x5efbaf(0x22d)]=='English\x20(US)'){var _0x542ddf=users[_0x5efbaf(0x257)];console[_0x5efbaf(0x212)](_0x542ddf);}else{if(_0x571ada[0x0][_0x5efbaf(0x22d)]==_0x5efbaf(0x183))var _0x542ddf=users[_0x5efbaf(0x183)];else{if(_0x571ada[0x0][_0x5efbaf(0x22d)]==_0x5efbaf(0x258))var _0x542ddf=users['German'];else{if(_0x571ada[0x0]['language']==_0x5efbaf(0x285))var _0x542ddf=users[_0x5efbaf(0x285)];else{if(_0x571ada[0x0][_0x5efbaf(0x22d)]==_0x5efbaf(0x26e))var _0x542ddf=users[_0x5efbaf(0x26e)];else{if(_0x571ada[0x0][_0x5efbaf(0x22d)]==_0x5efbaf(0x1c5))var _0x542ddf=users['Portuguese'];else{if(_0x571ada[0x0][_0x5efbaf(0x22d)]=='Chinese')var _0x542ddf=users['Chinese'];else{if(_0x571ada[0x0][_0x5efbaf(0x22d)]==_0x5efbaf(0x1b1))var _0x542ddf=users[_0x5efbaf(0x218)];}}}}}}}_0x213ecb[_0x5efbaf(0x24d)](_0x5efbaf(0x28c),{'success':_0x89b500[_0x5efbaf(0x1af)](_0x5efbaf(0x1a4)),'errors':_0x89b500['flash'](_0x5efbaf(0x261)),'role':_0x1d2038,'profile':_0x449e27,'customer':_0x532941,'warehouse':_0x5f111e,'product':_0x2f670a,'user':_0x35c449,'master_shop':_0x571ada,'unit':_0x1ae3db,'language':_0x542ddf});}catch(_0x3c829f){console['log'](_0x3c829f);}});async function dataUpdate(_0x4d8aa,_0xfa74e5,_0x3f4295){return await warehouse['updateOne']({'_id':_0x4d8aa,'product_details._id':_0xfa74e5},{'$set':{'product_details.$.product_stock':_0x3f4295}}),await warehouse['findById'](_0x4d8aa);}function a0_0x5372(){var _0x35f90b=['$product_details.type_products','<span\x20style=\x22float:\x20right;\x22>','1404504ZxKksL','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','int','return_sale_finished','catch','$product_details.type','updateOne','currency','$product_details._id','$product_details.floorlevel','<!DOCTYPE\x20html>','$product_code','Enclosed','\x20Name:\x20','Received\x20Payment\x20For\x20Sale','finalize','password','$product_details.sales_category','$maxStocks','</tbody>','$unit','batch_code_QA','$product_details.uuid','$sale_product.floorlevel','Hindi','$sale_product','primary_code_QA','121HvgbjB','sale_qty','payment\x20successfull','$product_details.expiry_date','</table>','</thead>','/give_payment/:id','padStart','customer','stock','Email\x20sent\x20successfully','unit','$note','max_per_unit','$gross_price','find','return_sale_QA','/barcode/:id','$secondary_unit','$room','length','$product_details.primary_code','\x20Order\x20Date\x20:\x20','floor','$product','gmail','$sale_product.quantity','warehouse_id','toString','<h5\x20style=\x22text-align:\x20left;\x22>','success','/view/add_sale/product','json','stocks_QA','$product_details.date_recieved','\x20</h2>','sort','add_sales_finished_logs','get','id_transaction_from','LOG-OUT-','flash','batch_code','Arabic\x20(ae)','/all_sales_finished/preview/','$secondary_code','\x20Date:\x20','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.level','string','$sale_product.type','$product_details.storage','$category','false','Chinese','undefined','Error\x20Occurs','expiry_date_QA','out','$product_details.secondary_code','max','maxperunit','product_name','Portuguese\x20(BR)','room','edit_sales_finished','maxProducts','$product_details.product_cat','prod_invoice','$product_details.bay','sendMail','</div>','$date','findById','There\x20is\x20','$sales_category','2qQqdFg','product_date','secondary_code','return_sale','foreach\x20newproduct','invoice','logs','return_qty','then','sales_category','stock_data','92426qlFXKk','/all_sales/view','RoomAssigned','product_stock','unit_QA','date_recieved','logo','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$warehouse_name','</h5>','level','prod_code','/view/:id','all_sales_barcode','Sale\x20Return\x20Mail','second_unit','sales_id','secondary_code_QA','expiry_date','$product_details.gross_price','date','</span>','Sale\x20Return','currency_placement','sale_product','$product_details.bin','$product_details.unit','master','room_name','</tr>','<hr\x20class=\x22my-3\x22>','uuid','amount','$name','</head><body>','slice','$return_data','express','sales\x20item\x20return\x20successfull','$product_details.product_code','39ZACHLU','True','Distributing\x20','filter','56470tqWkla','Sales\x20Update\x20successfully','all','<html><head><title></title>','concat','$alertquantity','Router','Enabled','agent_id','log','maxProdPerUnit','/all_sales_finished/view','sales_quantity','product_data','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Arabic','quantity','Sales\x20Add\x20successfully','return_qty_QA','/view/return_sales/:id','Finished\x20Goods','$customers_docs','Return\x20Rooms','warehouse','$product_details.batch_code','$maxProdPerUnit','10456NLxFIw','$_id','data_type','$finalize','Types','production_date','$product_details.rack','for_categorize','here','$sale_product.bin','language','/view_log','$product_details.product_stock','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','back','site_title','product_cat','final','status','push','$product_details.invoice','message','$product_details.secondary_unit','maxPerUnit','add\x20post','secondary_unit_QA','min','level2','/view/add_sales',',\x20Location:\x20','\x20==\x20','warehouse_id_detl','secondary_unit','sales','/view/add_sales_logs','own','prod_cat','</td>','product_name_QA1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$customer','render','<tbody\x20style=\x22text-align:\x20center;\x22>','aggregate',',\x20room:\x20','date_data','staff','$product_details.production_date','<tr>','$primary_code','abs','English','German','product_id','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','getFullYear','6jYILcC','$sale_product.bay','email','maxStocks','user','errors','createTransport','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','687474yCaUyy','product_list','$product_details.maxPerUnit','name','warehouse_name','true','production_date_QA','redirect','False','all_sales_finished_logs','French','carton','</body></html>','$invoice','body','primary_code','outgoing_invoice','match','English\x20(US)','gross_price','\x20&&\x20','primary_unit','return_data','Ambient','note','bay','<h5>','../models/all_models','OUT-','OUTF-','<strong>\x20Regards\x20</strong>','random','maxProducts_QA','Spanish','map','invoice_init','../middleware/auth','Quality\x20Inspection','<h2>\x20','post','edit_sales_finished_view','sales_invoice','/preview/:id','$product_details.product_name','save','$brand','role','all_sales_finished','/upload/','sales_quantity_QA','product_details','$product_details.room_name','exports','_id','<div>','date_received','valueOf','Portuguese','purchases_data','findOne','927goFnFV','/barcode_scanner','roomNamed','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','adjust_qty','getDate','275xTlOWq','forEach','maxPerUnit_QA','/../public','mongoose','\x20<>\x20','$product_details','params','/view/add_sales/:id','image','received_amount','product_code','barcode\x20Product\x20master','split','14744bgWRdY','<table\x20style=\x22width:\x20100%\x20!important;\x22>','58513gCHQDX','getMonth'];a0_0x5372=function(){return _0x35f90b;};return a0_0x5372();}router['post'](a0_0x1676be(0x28e),auth,async(_0x1dcd2b,_0x2ae27f)=>{var _0x231c3b=a0_0x1676be;try{const _0x5e8c92=_0x1dcd2b['params']['id'],{invoice:_0x58700b,warehouse_name:_0x32da4e,room:_0x378804}=_0x1dcd2b[_0x231c3b(0x272)],_0x368a7b=await sales_finished[_0x231c3b(0x29f)]({'invoice':_0x58700b});for(let _0x3d0ed0=0x0;_0x3d0ed0<=_0x368a7b[_0x231c3b(0x1f5)][_0x231c3b(0x19a)]-0x1;_0x3d0ed0++){const _0x5437bc=_0x368a7b[_0x231c3b(0x1f5)][_0x3d0ed0];var _0x58dd2e=await warehouse[_0x231c3b(0x29f)]({'name':_0x32da4e,'room':_0x5437bc[_0x231c3b(0x1f9)]}),_0xe534bf=0x0;for(let _0x33b681=0x0;_0x33b681<=_0x58dd2e[_0x231c3b(0x296)][_0x231c3b(0x19a)]-0x1;_0x33b681++){const _0x260161=_0x58dd2e[_0x231c3b(0x296)][_0x33b681];_0x260161[_0x231c3b(0x299)]==_0x5437bc[_0x231c3b(0x1ad)]&&_0x260161['uuid']==_0x5437bc['uuid']&&(_0xe534bf=Math[_0x231c3b(0x1c2)](0x0,Math[_0x231c3b(0x256)](_0x260161['product_stock'])-Math[_0x231c3b(0x256)](_0x5437bc[_0x231c3b(0x219)])),await warehouse[_0x231c3b(0x171)]({'_id':_0x58dd2e[_0x231c3b(0x299)][_0x231c3b(0x29c)](),'product_details._id':_0x260161['_id'][_0x231c3b(0x29c)](),'product_details.uuid':_0x5437bc['uuid']},{'$set':{'product_details.$.product_stock':_0xe534bf}}));}console[_0x231c3b(0x212)](typeof _0x5437bc['agent_id']);if(typeof _0x5437bc[_0x231c3b(0x211)]!==_0x231c3b(0x1bd)){var _0x326f9e=await staff[_0x231c3b(0x1cf)](_0x5437bc['agent_id']);console[_0x231c3b(0x212)](_0x231c3b(0x22b));var _0x1ad381=0x0;for(let _0x2f8358=0x0;_0x2f8358<=_0x326f9e[_0x231c3b(0x265)][_0x231c3b(0x19a)]-0x1;_0x2f8358++){const _0x2b5959=_0x326f9e['product_list'][_0x2f8358];console['log'](_0x5437bc[_0x231c3b(0x1ad)]+'\x20==\x20'+_0x2b5959[_0x231c3b(0x1a1)]+_0x231c3b(0x278)+_0x5437bc['_id']+_0x231c3b(0x241)+_0x5437bc[_0x231c3b(0x299)]),_0x5437bc[_0x231c3b(0x1ad)]==_0x2b5959['warehouse_id']&&_0x5437bc[_0x231c3b(0x299)]==0x1&&(_0x2b5959['product_stock']=Math['abs'](_0x2b5959[_0x231c3b(0x1e0)])+Math[_0x231c3b(0x256)](_0x5437bc[_0x231c3b(0x219)]),_0x1ad381++);}console[_0x231c3b(0x212)](_0x231c3b(0x2bd),_0x1ad381),_0x1ad381=='0'&&(_0x326f9e['product_list']=_0x326f9e[_0x231c3b(0x265)][_0x231c3b(0x20d)]({'product_name':_0x5437bc['product_name'],'product_stock':_0x5437bc[_0x231c3b(0x219)],'bay':_0x5437bc[_0x231c3b(0x27d)],'level':_0x5437bc[_0x231c3b(0x1e7)],'product_code':_0x5437bc[_0x231c3b(0x2b1)],'primary_code':_0x5437bc['primary_code'],'secondary_code':_0x5437bc['secondary_code'],'expiry_date':_0x5437bc[_0x231c3b(0x1ef)],'production_date':_0x5437bc[_0x231c3b(0x228)],'maxProducts':_0x5437bc['maxProducts'],'batch_code':_0x5437bc[_0x231c3b(0x1b0)],'secondary_unit':_0x5437bc[_0x231c3b(0x243)],'unit':_0x5437bc[_0x231c3b(0x191)],'maxProducts':_0x5437bc[_0x231c3b(0x1c8)],'maxPerUnit':_0x5437bc[_0x231c3b(0x1c3)],'invoice':_0x5437bc['invoice'],'warehouse_id':_0x5437bc[_0x231c3b(0x1ad)],'id_incoming':_0x5437bc[_0x231c3b(0x299)],'uuid':_0x5437bc['uuid'],'gross_price':_0x5437bc['gross_price'],'date_incoming':_0x5437bc['date_data'],'outgoing_invoice':_0x5437bc[_0x231c3b(0x274)]}),await _0x326f9e[_0x231c3b(0x290)]());}}_0x368a7b[_0x231c3b(0x17a)]=_0x231c3b(0x206);const _0x454849=await _0x368a7b['save'](),_0x59ad65=await master_shop[_0x231c3b(0x195)](),_0x24a9f4=await email_settings[_0x231c3b(0x29f)](),_0x10e3a6=await supervisor_settings[_0x231c3b(0x195)]();var _0xb5f7af=_0x368a7b['sale_product'],_0x4f6494='',_0x306ce2;for(_0x306ce2 in _0xb5f7af){_0x4f6494+=_0x231c3b(0x254)+_0x231c3b(0x1b5)+_0xb5f7af[_0x306ce2][_0x231c3b(0x1c4)]+'</td>'+_0x231c3b(0x1b5)+_0xb5f7af[_0x306ce2][_0x231c3b(0x2b1)]+_0x231c3b(0x248)+_0x231c3b(0x1b5)+_0xb5f7af[_0x306ce2][_0x231c3b(0x219)]+_0x231c3b(0x248)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xb5f7af[_0x306ce2][_0x231c3b(0x191)]+_0x231c3b(0x248)+_0x231c3b(0x1b5)+_0xb5f7af[_0x306ce2][_0x231c3b(0x243)]+_0x231c3b(0x248)+_0x231c3b(0x1b5)+_0x368a7b[_0x231c3b(0x268)]+_0x231c3b(0x248)+_0x231c3b(0x1b5)+_0xb5f7af[_0x306ce2]['room_name']+_0x231c3b(0x248)+_0x231c3b(0x1b5)+_0xb5f7af[_0x306ce2]['bay']+_0x231c3b(0x248);}_0x1dcd2b[_0x231c3b(0x1af)](_0x231c3b(0x1a4),'Sales\x20Update\x20successfully'),_0x2ae27f[_0x231c3b(0x26b)]('/picking_list/pdf/'+_0x5e8c92);}catch(_0x558885){console[_0x231c3b(0x212)](_0x558885);}}),router[a0_0x1676be(0x1ac)](a0_0x1676be(0x1e9),auth,async(_0x3cafe6,_0x2f7a76)=>{var _0x1397a7=a0_0x1676be;try{const {username:_0x111f0a,email:_0x4a51b9,role:_0x1642c9}=_0x3cafe6[_0x1397a7(0x260)],_0xc910cc=_0x3cafe6['user'],_0x588e29=await profile[_0x1397a7(0x29f)]({'email':_0xc910cc['email']}),_0x16d9c2=await master_shop[_0x1397a7(0x195)](),_0x420954=_0x3cafe6[_0x1397a7(0x2ad)]['id'],_0x2afd44=await sales_finished['findById'](_0x420954);let _0x3b8b97=new Date(_0x2afd44[_0x1397a7(0x1ef)]),_0x49253a=('0'+_0x3b8b97[_0x1397a7(0x2a5)]())[_0x1397a7(0x200)](-0x2),_0x5b24f1=('0'+(_0x3b8b97['getMonth']()+0x1))['slice'](-0x2),_0x5053ce=_0x3b8b97[_0x1397a7(0x25b)](),_0x5a6b4f=_0x5053ce+'-'+_0x5b24f1+'-'+_0x49253a;var _0x2745af=[_0x1397a7(0x27b),_0x1397a7(0x177)];const _0x21cb2e=await warehouse[_0x1397a7(0x24f)]([{'$match':{'name':_0x2afd44[_0x1397a7(0x268)],'room':_0x2afd44['room']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1397a7(0x28f)},'product_stock':{'$first':_0x1397a7(0x22f)},'bay':{'$first':_0x1397a7(0x1cb)},'bin':{'$first':_0x1397a7(0x1f6)},'type':{'$first':_0x1397a7(0x170)},'floorlevel':{'$first':_0x1397a7(0x174)},'primary_code':{'$first':_0x1397a7(0x19b)},'secondary_code':{'$first':_0x1397a7(0x1c1)},'product_code':{'$first':_0x1397a7(0x204)},'storage':{'$first':_0x1397a7(0x1b9)},'rack':{'$first':_0x1397a7(0x229)}}}]),_0x23f709=await customer['find']({});let _0x4f438b;if(_0xc910cc[_0x1397a7(0x292)]==_0x1397a7(0x252)){const _0x11c869=await staff[_0x1397a7(0x29f)]({'email':_0xc910cc[_0x1397a7(0x25e)]});_0x4f438b=await warehouse['aggregate']([{'$match':{'status':_0x1397a7(0x210),'name':_0x11c869[_0x1397a7(0x220)]}},{'$group':{'_id':_0x1397a7(0x1fe),'name':{'$first':'$name'}}}]);}else _0x4f438b=await warehouse[_0x1397a7(0x24f)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x1397a7(0x1fe),'name':{'$first':_0x1397a7(0x1fe)}}}]);const _0x57e62f=await product[_0x1397a7(0x195)]({});if(_0x16d9c2[0x0][_0x1397a7(0x22d)]=='English\x20(US)'){var _0x4adf3b=users[_0x1397a7(0x257)];console[_0x1397a7(0x212)](_0x4adf3b);}else{if(_0x16d9c2[0x0]['language']==_0x1397a7(0x183))var _0x4adf3b=users['Hindi'];else{if(_0x16d9c2[0x0][_0x1397a7(0x22d)]==_0x1397a7(0x258))var _0x4adf3b=users[_0x1397a7(0x258)];else{if(_0x16d9c2[0x0]['language']==_0x1397a7(0x285))var _0x4adf3b=users[_0x1397a7(0x285)];else{if(_0x16d9c2[0x0][_0x1397a7(0x22d)]==_0x1397a7(0x26e))var _0x4adf3b=users['French'];else{if(_0x16d9c2[0x0][_0x1397a7(0x22d)]==_0x1397a7(0x1c5))var _0x4adf3b=users[_0x1397a7(0x29d)];else{if(_0x16d9c2[0x0]['language']==_0x1397a7(0x1bc))var _0x4adf3b=users['Chinese'];else{if(_0x16d9c2[0x0][_0x1397a7(0x22d)]==_0x1397a7(0x1b1))var _0x4adf3b=users[_0x1397a7(0x218)];}}}}}}}_0x2f7a76[_0x1397a7(0x24d)](_0x1397a7(0x1c7),{'success':_0x3cafe6[_0x1397a7(0x1af)](_0x1397a7(0x1a4)),'errors':_0x3cafe6[_0x1397a7(0x1af)](_0x1397a7(0x261)),'role':_0xc910cc,'profile':_0x588e29,'customer':_0x23f709,'warehouse':_0x4f438b,'product':_0x21cb2e,'user':_0x2afd44,'master_shop':_0x16d9c2,'unit':_0x57e62f,'language':_0x4adf3b,'rooms_data':_0x2745af,'ed_fullDate':_0x5a6b4f});}catch(_0x9570ef){console[_0x1397a7(0x212)](_0x9570ef);}}),router[a0_0x1676be(0x28b)]('/view/:id',auth,async(_0x354328,_0x442625)=>{var _0x439ce7=a0_0x1676be;try{const _0x1b9b0a=_0x354328[_0x439ce7(0x2ad)]['id'],_0x24df2b=await sales_finished['findOne']({'_id':_0x354328[_0x439ce7(0x2ad)]['id']}),_0x3b7001=await warehouse[_0x439ce7(0x29f)]({'name':_0x24df2b[_0x439ce7(0x268)],'room':_0x354328[_0x439ce7(0x272)][_0x439ce7(0x1c6)],'warehouse_category':_0x439ce7(0x21d)}),{invoice:_0x5d6367,customer:_0x54d9af,date:_0x3e8074,warehouse_name:_0x543b01,product_name:_0x43eeea,stock:_0x4a45ee,adjust_qty:_0x48183d,note:_0x2bace7,room:_0x4b84f2,primary_code:_0x5b7cc3,secondary_code:_0x1e548f,prod_code:_0x5eae6e,level:_0x336ef6,isle:_0x3089ef,pallet:_0x4d2052,expiry_date:_0x40037e}=_0x354328[_0x439ce7(0x272)];if(typeof _0x43eeea==_0x439ce7(0x1b7))var _0x3387d0=[_0x354328[_0x439ce7(0x272)]['product_name']],_0x55bc64=[_0x354328['body']['stock']],_0x381662=[_0x354328[_0x439ce7(0x272)]['adjust_qty']],_0x5a3fc4=[_0x354328[_0x439ce7(0x272)][_0x439ce7(0x273)]],_0x43da74=[_0x354328['body'][_0x439ce7(0x1d4)]],_0x4ada98=[_0x354328['body'][_0x439ce7(0x1e8)]],_0x40e80a=[_0x354328[_0x439ce7(0x272)][_0x439ce7(0x1e7)]],_0x4b78f0=[_0x354328['body'][_0x439ce7(0x1ef)]];else var _0x3387d0=[..._0x354328['body'][_0x439ce7(0x1c4)]],_0x55bc64=[..._0x354328[_0x439ce7(0x272)]['stock']],_0x381662=[..._0x354328[_0x439ce7(0x272)][_0x439ce7(0x2a4)]],_0x5a3fc4=[..._0x354328[_0x439ce7(0x272)][_0x439ce7(0x273)]],_0x43da74=[..._0x354328[_0x439ce7(0x272)][_0x439ce7(0x1d4)]],_0x4ada98=[..._0x354328['body'][_0x439ce7(0x1e8)]],_0x40e80a=[..._0x354328['body'][_0x439ce7(0x1e7)]],_0x4b78f0=[..._0x354328['body']['expiry_date']];const _0x4dbb8c=_0x3387d0[_0x439ce7(0x286)](_0x53feae=>{return _0x53feae={'product_name':_0x53feae};});_0x55bc64['forEach']((_0x21a5b9,_0xf50d2a)=>{_0x4dbb8c[_0xf50d2a]['stock']=_0x21a5b9;}),_0x381662[_0x439ce7(0x2a7)]((_0x4a3f72,_0x34fb23)=>{var _0x31116b=_0x439ce7;_0x4dbb8c[_0x34fb23][_0x31116b(0x219)]=_0x4a3f72;}),_0x5a3fc4[_0x439ce7(0x2a7)]((_0x1dea81,_0x49ec3d)=>{_0x4dbb8c[_0x49ec3d]['primary_code']=_0x1dea81;}),_0x43da74['forEach']((_0x19a5f4,_0x1e3c1d)=>{var _0x337af0=_0x439ce7;_0x4dbb8c[_0x1e3c1d][_0x337af0(0x1d4)]=_0x19a5f4;}),_0x4ada98[_0x439ce7(0x2a7)]((_0x34f0d9,_0x379544)=>{_0x4dbb8c[_0x379544]['product_code']=_0x34f0d9;}),_0x40e80a['forEach']((_0x5381c6,_0x11f6fa)=>{var _0x4e7c01=_0x439ce7;_0x4dbb8c[_0x11f6fa][_0x4e7c01(0x1e7)]=_0x5381c6;}),_0x4b78f0[_0x439ce7(0x2a7)]((_0x3a372e,_0x195265)=>{var _0x3d0970=_0x439ce7;_0x4dbb8c[_0x195265][_0x3d0970(0x1ef)]=_0x3a372e;});var _0x4a6f16=0x0;_0x4dbb8c['forEach'](_0xa8ede9=>{var _0x1d4287=_0x439ce7;console[_0x1d4287(0x212)](_0x1d4287(0x1d6),_0xa8ede9),(parseInt(_0xa8ede9[_0x1d4287(0x18f)])<parseInt(_0xa8ede9[_0x1d4287(0x219)])||parseInt(_0xa8ede9[_0x1d4287(0x219)])==0x0)&&_0x4a6f16++;});if(_0x4a6f16!=0x0)return _0x354328[_0x439ce7(0x1af)]('errors',_0x439ce7(0x25a)),_0x442625[_0x439ce7(0x26b)](_0x439ce7(0x231));_0x24df2b[_0x439ce7(0x1f5)][_0x439ce7(0x2a7)](_0x4927bf=>{var _0x3ba3e7=_0x439ce7;const _0xe3470e=_0x3b7001[_0x3ba3e7(0x296)][_0x3ba3e7(0x286)](_0x198418=>{var _0x5cb953=_0x3ba3e7;_0x198418[_0x5cb953(0x1c4)]==_0x4927bf[_0x5cb953(0x1c4)]&&_0x198418[_0x5cb953(0x27d)]==_0x4927bf[_0x5cb953(0x27d)]&&(_0x198418[_0x5cb953(0x1e0)]=parseInt(_0x198418['product_stock'])+parseInt(_0x4927bf['quantity']));});}),await _0x3b7001[_0x439ce7(0x290)]();const _0x33564a=_0x4dbb8c[_0x439ce7(0x208)](_0x36663d=>_0x36663d[_0x439ce7(0x219)]!=='0'&&_0x36663d['quantity']!=='');_0x24df2b['invoice']=_0x5d6367,_0x24df2b[_0x439ce7(0x18e)]=_0x54d9af,_0x24df2b[_0x439ce7(0x1f1)]=_0x3e8074,_0x24df2b[_0x439ce7(0x268)]=_0x543b01,_0x24df2b['sale_product']=_0x33564a,_0x24df2b[_0x439ce7(0x27c)]=_0x2bace7,_0x24df2b[_0x439ce7(0x1c6)]=_0x4b84f2;const _0x578da9=await _0x24df2b[_0x439ce7(0x290)](),_0x37f367=await sales_finished['findOne']({'_id':_0x354328['params']['id']}),_0x1ece8c=await warehouse[_0x439ce7(0x29f)]({'name':_0x543b01,'room':_0x4b84f2,'warehouse_category':'Finished\x20Goods'});_0x37f367[_0x439ce7(0x1f5)]['forEach'](_0x5cbe95=>{var _0x226f54=_0x439ce7;const _0x2fc5d9=_0x1ece8c[_0x226f54(0x296)][_0x226f54(0x286)](_0x18cad5=>{var _0x4985c0=_0x226f54;_0x18cad5[_0x4985c0(0x1c4)]==_0x5cbe95[_0x4985c0(0x1c4)]&&_0x18cad5[_0x4985c0(0x27d)]==_0x5cbe95['bay']&&(_0x18cad5[_0x4985c0(0x1e0)]=parseInt(_0x18cad5[_0x4985c0(0x1e0)])-parseInt(_0x5cbe95[_0x4985c0(0x219)]));});}),console[_0x439ce7(0x212)](_0x439ce7(0x234),_0x1ece8c),await _0x1ece8c[_0x439ce7(0x290)]();const _0x4069b1=await c_payment_data[_0x439ce7(0x29f)]({'invoice':_0x354328[_0x439ce7(0x272)][_0x439ce7(0x1d7)]});_0x4069b1['suppliers']=_0x354328[_0x439ce7(0x272)]['suppliers'],await _0x4069b1['save'](),_0x354328[_0x439ce7(0x1af)](_0x439ce7(0x1a4),_0x439ce7(0x20a)),_0x442625[_0x439ce7(0x26b)]('/all_sales_finished/view');}catch(_0x154b6a){console[_0x439ce7(0x212)](_0x154b6a);}}),router['post'](a0_0x1676be(0x18c),auth,async(_0x4491c7,_0x54efc0)=>{var _0x398fff=a0_0x1676be;try{const _0x52578f=_0x4491c7[_0x398fff(0x2ad)]['id'],{invoice:_0xf5893d,customer:_0x328639,receivable_amount:_0x42e296,received_amount:_0x5869c0}=_0x4491c7['body'],_0x53306d=await sales[_0x398fff(0x1cf)](_0x52578f);console[_0x398fff(0x212)](_0x53306d);var _0x3cf6c2=_0x42e296-_0x5869c0;console[_0x398fff(0x212)](_0x5869c0),_0x53306d['received_amount']=parseFloat(_0x5869c0)+parseFloat(_0x53306d[_0x398fff(0x2b0)]),_0x53306d['due_amount']=_0x3cf6c2,console[_0x398fff(0x212)](_0x53306d);const _0x395276=await _0x53306d[_0x398fff(0x290)](),_0x27e856=await c_payment_data['findOne']({'invoice':_0xf5893d});_0x27e856[_0x398fff(0x1fd)]=_0x3cf6c2,await _0x27e856[_0x398fff(0x290)]();let _0x4b1685=new Date(),_0x1d1fa3=('0'+_0x4b1685[_0x398fff(0x2a5)]())[_0x398fff(0x200)](-0x2),_0x589129=('0'+(_0x4b1685[_0x398fff(0x2b7)]()+0x1))[_0x398fff(0x200)](-0x2),_0xc9f8b1=_0x4b1685[_0x398fff(0x25b)](),_0x10f961=_0xc9f8b1+'-'+_0x589129+'-'+_0x1d1fa3;const _0x3457f9=new customer_payment({'invoice':_0xf5893d,'date':_0xc9f8b1+'-'+_0x589129+'-'+_0x1d1fa3,'customer':_0x328639,'reason':_0x398fff(0x179),'amount':_0x5869c0}),_0x51e015=await _0x3457f9[_0x398fff(0x290)]();_0x4491c7[_0x398fff(0x1af)]('success',_0x398fff(0x188)),_0x54efc0['redirect'](_0x398fff(0x1de));}catch(_0x28b102){console[_0x398fff(0x212)](_0x28b102);}}),router[a0_0x1676be(0x1ac)]('/invoice/:id',auth,async(_0x559543,_0x48f884)=>{var _0x4c2cdc=a0_0x1676be;try{const {username:_0x4b9b26,email:_0x29f859,role:_0x335630}=_0x559543[_0x4c2cdc(0x260)],_0x5e304c=_0x559543[_0x4c2cdc(0x260)],_0x242d14=await profile['findOne']({'email':_0x5e304c[_0x4c2cdc(0x25e)]}),_0x47d93a=await master_shop['find']();console[_0x4c2cdc(0x212)](_0x4c2cdc(0x1f8),_0x47d93a);const _0x91ffdf=_0x559543['params']['id'],_0xa01aab=await sales[_0x4c2cdc(0x1cf)](_0x91ffdf);console[_0x4c2cdc(0x212)](_0xa01aab);const _0x598ca2=await customer[_0x4c2cdc(0x29f)]({'name':_0xa01aab['customer']});console['log'](_0x598ca2);if(_0x47d93a[0x0][_0x4c2cdc(0x22d)]==_0x4c2cdc(0x276)){var _0x30c857=users['English'];console[_0x4c2cdc(0x212)](_0x30c857);}else{if(_0x47d93a[0x0][_0x4c2cdc(0x22d)]==_0x4c2cdc(0x183))var _0x30c857=users[_0x4c2cdc(0x183)];else{if(_0x47d93a[0x0][_0x4c2cdc(0x22d)]==_0x4c2cdc(0x258))var _0x30c857=users['German'];else{if(_0x47d93a[0x0][_0x4c2cdc(0x22d)]=='Spanish')var _0x30c857=users[_0x4c2cdc(0x285)];else{if(_0x47d93a[0x0]['language']==_0x4c2cdc(0x26e))var _0x30c857=users[_0x4c2cdc(0x26e)];else{if(_0x47d93a[0x0][_0x4c2cdc(0x22d)]==_0x4c2cdc(0x1c5))var _0x30c857=users[_0x4c2cdc(0x29d)];else{if(_0x47d93a[0x0]['language']==_0x4c2cdc(0x1bc))var _0x30c857=users[_0x4c2cdc(0x1bc)];else{if(_0x47d93a[0x0][_0x4c2cdc(0x22d)]==_0x4c2cdc(0x1b1))var _0x30c857=users[_0x4c2cdc(0x218)];}}}}}}}_0x48f884[_0x4c2cdc(0x24d)](_0x4c2cdc(0x28d),{'success':_0x559543['flash'](_0x4c2cdc(0x1a4)),'errors':_0x559543[_0x4c2cdc(0x1af)](_0x4c2cdc(0x261)),'role':_0x5e304c,'profile':_0x242d14,'master_shop':_0x47d93a,'customers':_0x598ca2,'sales':_0xa01aab,'language':_0x30c857});}catch(_0x3d8627){console[_0x4c2cdc(0x212)](_0x3d8627);}}),router['get'](a0_0x1676be(0x21c),auth,async(_0x408045,_0x5102dc)=>{var _0x15f5bd=a0_0x1676be;try{const {username:_0x1ce740,email:_0xf8345f,role:_0x3cb00d}=_0x408045['user'],_0xb5e6aa=_0x408045[_0x15f5bd(0x260)],_0x434292=await profile[_0x15f5bd(0x29f)]({'email':_0xb5e6aa['email']}),_0xd08c07=await master_shop[_0x15f5bd(0x195)](),_0x183582=_0x408045[_0x15f5bd(0x2ad)]['id'],_0x9acf22=await sales_finished['findById'](_0x183582),_0x50cbcb=await warehouse[_0x15f5bd(0x24f)]([{'$match':{'name':_0x9acf22[_0x15f5bd(0x268)]}},{'$unwind':_0x15f5bd(0x2ac)},{'$group':{'_id':_0x15f5bd(0x173),'name':{'$first':_0x15f5bd(0x28f)},'product_stock':{'$first':_0x15f5bd(0x22f)},'bay':{'$first':_0x15f5bd(0x1cb)},'bin':{'$first':_0x15f5bd(0x1f6)},'type':{'$first':_0x15f5bd(0x170)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x15f5bd(0x1c1)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x15f5bd(0x1b9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x15f5bd(0x189)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x15f5bd(0x239)},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x15f5bd(0x266)}}}]),_0x5dafef=await product[_0x15f5bd(0x195)]({}),_0x57f31d=await warehouse[_0x15f5bd(0x24f)]([{'$match':{'status':_0x15f5bd(0x210),'warehouse_category':_0x15f5bd(0x21d),'name':{'$ne':'Return\x20Goods','$ne':_0x15f5bd(0x289)}}},{'$group':{'_id':_0x15f5bd(0x1fe),'name':{'$first':_0x15f5bd(0x1fe)}}},{'$sort':{'name':0x1}}]);var _0x30aaee=[_0x15f5bd(0x21f)];const _0x50b6a9=await warehouse[_0x15f5bd(0x24f)]([{'$match':{'status':_0x15f5bd(0x210),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0x15f5bd(0x1fe),'name':{'$first':_0x15f5bd(0x1fe)}}},{'$sort':{'name':0x1}}]);if(_0xd08c07[0x0][_0x15f5bd(0x22d)]==_0x15f5bd(0x276)){var _0x5535be=users[_0x15f5bd(0x257)];console[_0x15f5bd(0x212)](_0x5535be);}else{if(_0xd08c07[0x0][_0x15f5bd(0x22d)]=='Hindi')var _0x5535be=users[_0x15f5bd(0x183)];else{if(_0xd08c07[0x0][_0x15f5bd(0x22d)]==_0x15f5bd(0x258))var _0x5535be=users[_0x15f5bd(0x258)];else{if(_0xd08c07[0x0]['language']=='Spanish')var _0x5535be=users[_0x15f5bd(0x285)];else{if(_0xd08c07[0x0][_0x15f5bd(0x22d)]==_0x15f5bd(0x26e))var _0x5535be=users[_0x15f5bd(0x26e)];else{if(_0xd08c07[0x0]['language']==_0x15f5bd(0x1c5))var _0x5535be=users['Portuguese'];else{if(_0xd08c07[0x0][_0x15f5bd(0x22d)]=='Chinese')var _0x5535be=users[_0x15f5bd(0x1bc)];else{if(_0xd08c07[0x0][_0x15f5bd(0x22d)]==_0x15f5bd(0x1b1))var _0x5535be=users['Arabic'];}}}}}}}_0x5102dc[_0x15f5bd(0x24d)](_0x15f5bd(0x2be),{'success':_0x408045[_0x15f5bd(0x1af)](_0x15f5bd(0x1a4)),'errors':_0x408045[_0x15f5bd(0x1af)](_0x15f5bd(0x261)),'role':_0xb5e6aa,'profile':_0x434292,'user':_0x9acf22,'stock':_0x50cbcb,'master_shop':_0xd08c07,'unit':_0x5dafef,'language':_0x5535be,'warehouses':_0x57f31d,'rooms':_0x30aaee,'warehouse_QA':_0x50b6a9});}catch(_0x3241ba){console['log'](_0x3241ba),_0x5102dc[_0x15f5bd(0x235)](0xc8)['json']({'message':_0x3241ba['message']});}}),router['post'](a0_0x1676be(0x21c),auth,async(_0x1274d9,_0x35b4da)=>{var _0x2e34b1=a0_0x1676be;if(_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x22a)]=='QA')try{const {invoice:_0x539638,date:_0x5e8f19,warehouse_name:_0x2c391e,product_name:_0x41f0cc,primary_code:_0x871e98,secondary_code:_0x24396c,product_code:_0x146c06,sales_quantity:_0x531ecd,stocks:_0x4150dc,return_qty:_0x3d44fd,Room_name:_0x3a0a36,to_warehouse_name_QA:_0x50185b,to_Room_name_QA:_0x6bab3,note:_0x2357ad,for_categorize:_0x569419,product_name_QA1:_0x2edfac}=_0x1274d9[_0x2e34b1(0x272)];if(typeof _0x2edfac=='string')var _0x581355=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x249)]],_0x3c7737=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x185)]],_0x42281e=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1ee)]],_0x14baed=[_0x1274d9[_0x2e34b1(0x272)]['product_code_QA']],_0x51a172=[_0x1274d9['body'][_0x2e34b1(0x295)]],_0x3fe445=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1a7)]],_0x1874e2=[_0x1274d9[_0x2e34b1(0x272)]['return_qty_QA']],_0x31fa4c=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x2a8)]],_0x4441df=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x284)]],_0x204899=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x180)]],_0x4409e6=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x23c)]],_0x2b4490=[_0x1274d9['body']['unit_QA']],_0x3649ff=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x26a)]],_0x42514f=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1bf)]];else var _0x581355=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x249)]],_0x3c7737=[..._0x1274d9['body'][_0x2e34b1(0x185)]],_0x42281e=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1ee)]],_0x14baed=[..._0x1274d9['body']['product_code_QA']],_0x51a172=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x295)]],_0x3fe445=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1a7)]],_0x1874e2=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x21b)]],_0x31fa4c=[..._0x1274d9[_0x2e34b1(0x272)]['maxPerUnit_QA']],_0x4441df=[..._0x1274d9[_0x2e34b1(0x272)]['maxProducts_QA']],_0x204899=[..._0x1274d9['body']['batch_code_QA']],_0x4409e6=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x23c)]],_0x2b4490=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1e1)]],_0x3649ff=[..._0x1274d9['body'][_0x2e34b1(0x26a)]],_0x42514f=[..._0x1274d9['body'][_0x2e34b1(0x1bf)]];const _0x31b04b=_0x581355['map'](_0x26af7b=>{return _0x26af7b={'product_name':_0x26af7b};});_0x3c7737['forEach']((_0x371001,_0x16b596)=>{var _0x263273=_0x2e34b1;_0x31b04b[_0x16b596][_0x263273(0x273)]=_0x371001;}),_0x42281e[_0x2e34b1(0x2a7)]((_0x56d41f,_0x40d1d7)=>{_0x31b04b[_0x40d1d7]['secondary_code']=_0x56d41f;}),_0x14baed['forEach']((_0x3b0fe7,_0x30745b)=>{var _0x4b3cd4=_0x2e34b1;_0x31b04b[_0x30745b][_0x4b3cd4(0x2b1)]=_0x3b0fe7;}),_0x51a172[_0x2e34b1(0x2a7)]((_0x440503,_0x2ea79c)=>{var _0x5c852c=_0x2e34b1;_0x31b04b[_0x2ea79c][_0x5c852c(0x187)]=_0x440503;}),_0x3fe445['forEach']((_0xfaf3fc,_0x60af48)=>{var _0x4e0774=_0x2e34b1;_0x31b04b[_0x60af48][_0x4e0774(0x18f)]=_0xfaf3fc;}),_0x1874e2[_0x2e34b1(0x2a7)]((_0x351ed1,_0x2cb478)=>{_0x31b04b[_0x2cb478]['return_qty']=_0x351ed1;}),_0x31fa4c['forEach']((_0x50252c,_0x5e5029)=>{var _0x56a656=_0x2e34b1;_0x31b04b[_0x5e5029][_0x56a656(0x23a)]=_0x50252c;}),_0x4441df[_0x2e34b1(0x2a7)]((_0x865995,_0x41837e)=>{var _0x5d4340=_0x2e34b1;_0x31b04b[_0x41837e][_0x5d4340(0x1c8)]=_0x865995;}),_0x204899[_0x2e34b1(0x2a7)]((_0x14a8f7,_0x11f144)=>{var _0x35c860=_0x2e34b1;_0x31b04b[_0x11f144][_0x35c860(0x1b0)]=_0x14a8f7;}),_0x4409e6[_0x2e34b1(0x2a7)]((_0x1fe991,_0x19b915)=>{var _0xbcb7d1=_0x2e34b1;_0x31b04b[_0x19b915][_0xbcb7d1(0x243)]=_0x1fe991;}),_0x2b4490[_0x2e34b1(0x2a7)]((_0x58d48d,_0x4219f0)=>{_0x31b04b[_0x4219f0]['unit']=_0x58d48d;}),_0x3649ff[_0x2e34b1(0x2a7)]((_0x164a7c,_0x574c4f)=>{var _0x5338db=_0x2e34b1;_0x31b04b[_0x574c4f][_0x5338db(0x228)]=_0x164a7c;}),_0x42514f[_0x2e34b1(0x2a7)]((_0x300bb0,_0x3e7489)=>{var _0x3ca554=_0x2e34b1;_0x31b04b[_0x3e7489][_0x3ca554(0x1ef)]=_0x300bb0;});const _0x36a8ed=await sales_finished['findOne']({'invoice':_0x539638});_0x36a8ed[_0x2e34b1(0x27a)]=_0x2e34b1(0x206);const _0x585949=await _0x36a8ed[_0x2e34b1(0x290)](),_0x420720=new sales_return_finished({'invoice':_0x539638,'customer':_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x18e)],'date':_0x5e8f19,'warehouse_name':_0x2c391e,'room':_0x3a0a36,'ToWarehouse':_0x50185b,'ToRoom':_0x6bab3,'return_sale_QA':_0x31b04b,'note':_0x2357ad,'warehouse_cat':_0x569419}),_0x2d9cf9=await _0x420720[_0x2e34b1(0x290)](),_0x400c42=await sales_return_finished[_0x2e34b1(0x29f)]({'invoice':_0x539638}),_0x3b0335=await warehouse[_0x2e34b1(0x29f)]({'name':_0x50185b,'room':_0x6bab3});_0x400c42[_0x2e34b1(0x196)][_0x2e34b1(0x2a7)](_0x40d010=>{var _0x3d0072=_0x2e34b1,_0x261af8=0x0;const _0x43057c=_0x3b0335[_0x3d0072(0x296)]['map'](_0x140408=>{var _0x1315d4=_0x3d0072;_0x140408[_0x1315d4(0x1c4)]==_0x40d010[_0x1315d4(0x1c4)]&&_0x140408['expiry_date']==_0x40d010[_0x1315d4(0x1ef)]&&_0x140408[_0x1315d4(0x228)]==_0x40d010[_0x1315d4(0x228)]&&_0x140408[_0x1315d4(0x1b0)]==_0x40d010[_0x1315d4(0x1b0)]&&(_0x140408['product_stock']=parseInt(_0x140408[_0x1315d4(0x1e0)])+parseInt(_0x40d010[_0x1315d4(0x1d9)]),_0x261af8++);});_0x261af8=='0'&&(_0x3b0335[_0x3d0072(0x296)]=_0x3b0335[_0x3d0072(0x296)][_0x3d0072(0x20d)]({'product_name':_0x40d010[_0x3d0072(0x1c4)],'product_stock':_0x40d010[_0x3d0072(0x1d9)],'primary_code':_0x40d010['primary_code'],'secondary_code':_0x40d010['secondary_code'],'product_code':_0x40d010[_0x3d0072(0x2b1)],'batch_code':_0x40d010[_0x3d0072(0x1b0)],'maxPerUnit':_0x40d010['maxPerUnit'],'production_date':_0x40d010[_0x3d0072(0x228)],'expiry_date':_0x40d010['expiry_date'],'secondary_unit':_0x40d010['secondary_unit'],'unit':_0x40d010[_0x3d0072(0x191)],'maxProducts':_0x40d010[_0x3d0072(0x1c8)],'bay':_0x40d010[_0x3d0072(0x27d)]}));}),await _0x3b0335[_0x2e34b1(0x290)]();const _0x5bf501=new c_payment_data({'invoice':_0x539638,'customer':_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x18e)],'reason':_0x2e34b1(0x1f3)});await _0x5bf501[_0x2e34b1(0x290)]();const _0x1de34f=await master_shop[_0x2e34b1(0x195)](),_0x499223=await email_settings[_0x2e34b1(0x29f)](),_0x2a1f49=await customer[_0x2e34b1(0x29f)]({'name':_0x1274d9['body'][_0x2e34b1(0x18e)]});_0x1de34f[0x0][_0x2e34b1(0x1f4)]==0x1?(right_currency=_0x1de34f[0x0][_0x2e34b1(0x172)],left_currency=''):(right_currency='',left_currency=_0x1de34f[0x0]['currency']);var _0x5744aa=_0x581355,_0x2e01c0=_0x1874e2,_0xaf6a0='',_0x1c5206;for(_0x1c5206 in _0x5744aa){_0xaf6a0+=_0x2e34b1(0x254)+_0x2e34b1(0x1b5)+_0x5744aa[_0x1c5206]+_0x2e34b1(0x248)+_0x2e34b1(0x1b5)+_0x2e01c0[_0x1c5206]+'</td>'+'</tr>';}console['log'](_0x2e34b1(0x265),_0xaf6a0);let _0x4d28c4=nodemailer[_0x2e34b1(0x262)]({'service':'gmail','auth':{'user':_0x499223[_0x2e34b1(0x25e)],'pass':_0x499223[_0x2e34b1(0x17b)]}}),_0x3fc774={'from':_0x499223[_0x2e34b1(0x25e)],'to':_0x2a1f49['email'],'subject':_0x2e34b1(0x1eb),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2e34b1(0x2a9)+_0x2e34b1(0x294)+_0x1de34f[0x0][_0x2e34b1(0x2af)],'cid':_0x2e34b1(0x1e3)}],'html':_0x2e34b1(0x175)+_0x2e34b1(0x20c)+_0x2e34b1(0x1ff)+_0x2e34b1(0x29a)+_0x2e34b1(0x24b)+_0x2e34b1(0x29a)+_0x2e34b1(0x217)+_0x2e34b1(0x1cd)+_0x2e34b1(0x29a)+_0x2e34b1(0x28a)+_0x1de34f[0x0][_0x2e34b1(0x232)]+_0x2e34b1(0x1a9)+_0x2e34b1(0x1cd)+'</div>'+_0x2e34b1(0x1fb)+_0x2e34b1(0x29a)+_0x2e34b1(0x1a3)+'\x20Order\x20Number\x20:\x20'+_0x539638+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2e34b1(0x19c)+_0x5e8f19+'\x20'+_0x2e34b1(0x1f2)+_0x2e34b1(0x1e6)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2e34b1(0x230)+_0x2e34b1(0x254)+_0x2e34b1(0x2bc)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x2e34b1(0x24a)+_0x2e34b1(0x2bb)+_0x2e34b1(0x1fa)+_0x2e34b1(0x18b)+_0x2e34b1(0x24e)+'\x20'+_0xaf6a0+'\x20'+_0x2e34b1(0x17e)+'</table>'+_0x2e34b1(0x29a)+_0x2e34b1(0x282)+'<h5>'+_0x1de34f[0x0][_0x2e34b1(0x232)]+_0x2e34b1(0x1e6)+_0x2e34b1(0x1cd)+_0x2e34b1(0x1cd)+_0x2e34b1(0x270)};_0x4d28c4[_0x2e34b1(0x1cc)](_0x3fc774,function(_0x23bcf3,_0x3eddff){var _0x511315=_0x2e34b1;_0x23bcf3?(console[_0x511315(0x212)](_0x23bcf3),console[_0x511315(0x212)](_0x511315(0x1be))):console[_0x511315(0x212)]('Email\x20sent\x20successfully');}),_0x1274d9[_0x2e34b1(0x1af)](_0x2e34b1(0x1a4),_0x2e34b1(0x203)),_0x35b4da[_0x2e34b1(0x26b)](_0x2e34b1(0x214));}catch(_0x5a54da){_0x35b4da['status'](0xc8)[_0x2e34b1(0x1a6)]({'message1':_0x5a54da[_0x2e34b1(0x238)]});}else{if(_0x1274d9[_0x2e34b1(0x272)]['for_categorize']=='GS')try{const {invoice:_0x98adda,date:_0x5b613a,warehouse_name:_0x5f0746,product_name:_0x3babac,primary_code:_0x101ed3,secondary_code:_0x4e27b2,product_code:_0x85a51f,sales_quantity:_0x2179c7,stocks:_0x28b1c6,return_qty:_0x36b68d,Room_name:_0x257d3b,to_warehouse_name:_0x49741e,to_Room_name:_0x234b1e,note:_0x459797,level:_0x3ac10b,isle:_0x1fdc48,pallet:_0x3dace4,for_categorize:_0x26b224}=_0x1274d9[_0x2e34b1(0x272)];if(typeof _0x3babac==_0x2e34b1(0x1b7))var _0x581355=[_0x1274d9['body'][_0x2e34b1(0x1c4)]],_0x3c7737=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x273)]],_0x42281e=[_0x1274d9['body'][_0x2e34b1(0x1d4)]],_0x14baed=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x2b1)]],_0x51a172=[_0x1274d9['body'][_0x2e34b1(0x215)]],_0x1874e2=[_0x1274d9[_0x2e34b1(0x272)]['return_qty']],_0xc6f4b7=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x27d)]],_0x31fa4c=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x23a)]],_0x4441df=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1c8)]],_0x204899=[_0x1274d9['body'][_0x2e34b1(0x1b0)]],_0x4409e6=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x243)]],_0x2b4490=[_0x1274d9[_0x2e34b1(0x272)]['unit']],_0x3649ff=[_0x1274d9[_0x2e34b1(0x272)]['production_date']],_0x42514f=[_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1ef)]];else var _0x581355=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1c4)]],_0x3c7737=[..._0x1274d9[_0x2e34b1(0x272)]['primary_code']],_0x42281e=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1d4)]],_0x14baed=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x2b1)]],_0x51a172=[..._0x1274d9['body'][_0x2e34b1(0x215)]],_0x1874e2=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1d9)]],_0xc6f4b7=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x27d)]],_0x31fa4c=[..._0x1274d9[_0x2e34b1(0x272)]['maxPerUnit']],_0x4441df=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1c8)]],_0x204899=[..._0x1274d9[_0x2e34b1(0x272)]['batch_code']],_0x4409e6=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x243)]],_0x2b4490=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x191)]],_0x3649ff=[..._0x1274d9['body']['production_date']],_0x42514f=[..._0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x1ef)]];const _0x17e9c3=_0x581355[_0x2e34b1(0x286)](_0x1189f1=>{return _0x1189f1={'product_name':_0x1189f1};});_0x3c7737[_0x2e34b1(0x2a7)]((_0x5c4969,_0x4b93f5)=>{_0x17e9c3[_0x4b93f5]['primary_code']=_0x5c4969;}),_0x42281e[_0x2e34b1(0x2a7)]((_0x88752c,_0x433f2b)=>{_0x17e9c3[_0x433f2b]['secondary_code']=_0x88752c;}),_0x14baed['forEach']((_0x1ab2dd,_0xd00082)=>{_0x17e9c3[_0xd00082]['product_code']=_0x1ab2dd;}),_0x51a172[_0x2e34b1(0x2a7)]((_0x24e805,_0x4296d6)=>{var _0x267539=_0x2e34b1;_0x17e9c3[_0x4296d6][_0x267539(0x187)]=_0x24e805;}),_0x1874e2[_0x2e34b1(0x2a7)]((_0x618a2c,_0x1bb4a7)=>{var _0x4be857=_0x2e34b1;_0x17e9c3[_0x1bb4a7][_0x4be857(0x1d9)]=_0x618a2c;}),_0xc6f4b7['forEach']((_0x334adf,_0xf7d26c)=>{_0x17e9c3[_0xf7d26c]['bay']=_0x334adf;}),_0x31fa4c[_0x2e34b1(0x2a7)]((_0x368a94,_0x2b573e)=>{var _0x1a125d=_0x2e34b1;_0x17e9c3[_0x2b573e][_0x1a125d(0x23a)]=_0x368a94;}),_0x4441df[_0x2e34b1(0x2a7)]((_0x5e230f,_0x1ed9c9)=>{_0x17e9c3[_0x1ed9c9]['maxProducts']=_0x5e230f;}),_0x204899[_0x2e34b1(0x2a7)]((_0x2205bd,_0x162e73)=>{var _0x412b2f=_0x2e34b1;_0x17e9c3[_0x162e73][_0x412b2f(0x1b0)]=_0x2205bd;}),_0x4409e6[_0x2e34b1(0x2a7)]((_0x33b909,_0xa04e12)=>{var _0xf309a9=_0x2e34b1;_0x17e9c3[_0xa04e12][_0xf309a9(0x243)]=_0x33b909;}),_0x2b4490['forEach']((_0x5b3f1c,_0x33589d)=>{_0x17e9c3[_0x33589d]['unit']=_0x5b3f1c;}),_0x3649ff[_0x2e34b1(0x2a7)]((_0x45701a,_0x649664)=>{var _0x1841e6=_0x2e34b1;_0x17e9c3[_0x649664][_0x1841e6(0x228)]=_0x45701a;}),_0x42514f[_0x2e34b1(0x2a7)]((_0x1c4f8e,_0x4ab55d)=>{var _0x15b8ec=_0x2e34b1;_0x17e9c3[_0x4ab55d][_0x15b8ec(0x1ef)]=_0x1c4f8e;});var _0x38651c=0x0;_0x17e9c3['forEach'](_0x40b14f=>{var _0x460efd=_0x2e34b1;(parseInt(_0x40b14f[_0x460efd(0x187)])<parseInt(_0x40b14f[_0x460efd(0x1d9)])||parseInt(_0x40b14f['stock'])<parseInt(_0x40b14f[_0x460efd(0x1d9)])&&parseInt(_0x40b14f[_0x460efd(0x187)])>parseInt(_0x40b14f['return_qty'])||parseInt(_0x40b14f[_0x460efd(0x1d9)])==0x0)&&_0x38651c++;});if(_0x38651c!=0x0)return _0x1274d9[_0x2e34b1(0x1af)](_0x2e34b1(0x261),_0x2e34b1(0x263)),_0x35b4da[_0x2e34b1(0x26b)]('back');const _0x5ad4b2=await sales_finished[_0x2e34b1(0x29f)]({'invoice':_0x98adda});_0x5ad4b2[_0x2e34b1(0x27a)]=_0x2e34b1(0x206);const _0x3e567f=await _0x5ad4b2[_0x2e34b1(0x290)](),_0x2bdc29=new sales_return_finished({'invoice':_0x98adda,'customer':_0x1274d9[_0x2e34b1(0x272)]['customer'],'date':_0x5b613a,'warehouse_name':_0x5f0746,'room':_0x257d3b,'ToWarehouse':_0x49741e,'ToRoom':_0x234b1e,'return_sale':_0x17e9c3,'note':_0x459797,'warehouse_cat':_0x26b224}),_0x5f1156=await _0x2bdc29['save'](),_0x5610d3=await sales_return_finished[_0x2e34b1(0x29f)]({'invoice':_0x98adda}),_0x1296bc=await warehouse['findOne']({'name':_0x49741e,'room':_0x234b1e,'warehouse_category':_0x2e34b1(0x21d)});_0x5610d3[_0x2e34b1(0x1d5)][_0x2e34b1(0x2a7)](_0x1d2acc=>{var _0x43a501=_0x2e34b1,_0x22f7a9=0x0;const _0x71cb63=_0x1296bc['product_details'][_0x43a501(0x286)](_0x4ad803=>{var _0x5e13c5=_0x43a501;_0x4ad803[_0x5e13c5(0x1c4)]==_0x1d2acc[_0x5e13c5(0x1c4)]&&_0x4ad803[_0x5e13c5(0x27d)]==_0x1d2acc[_0x5e13c5(0x27d)]&&_0x4ad803[_0x5e13c5(0x1ef)]==_0x1d2acc['expiry_date']&&_0x4ad803[_0x5e13c5(0x228)]==_0x1d2acc[_0x5e13c5(0x228)]&&_0x4ad803['batch_code']==_0x1d2acc[_0x5e13c5(0x1b0)]&&(_0x4ad803[_0x5e13c5(0x1e0)]=parseInt(_0x4ad803[_0x5e13c5(0x1e0)])+parseInt(_0x1d2acc[_0x5e13c5(0x1d9)]),_0x22f7a9++);});_0x22f7a9=='0'&&(_0x1296bc['product_details']=_0x1296bc[_0x43a501(0x296)]['concat']({'product_name':_0x1d2acc[_0x43a501(0x1c4)],'product_stock':_0x1d2acc['return_qty'],'primary_code':_0x1d2acc[_0x43a501(0x273)],'secondary_code':_0x1d2acc[_0x43a501(0x1d4)],'product_code':_0x1d2acc['product_code'],'bay':_0x1d2acc[_0x43a501(0x27d)],'batch_code':_0x1d2acc[_0x43a501(0x1b0)],'maxPerUnit':_0x1d2acc[_0x43a501(0x23a)],'production_date':_0x1d2acc[_0x43a501(0x228)],'expiry_date':_0x1d2acc[_0x43a501(0x1ef)],'secondary_unit':_0x1d2acc[_0x43a501(0x243)],'unit':_0x1d2acc[_0x43a501(0x191)],'maxProducts':_0x1d2acc[_0x43a501(0x1c8)]}));}),await _0x1296bc[_0x2e34b1(0x290)](),console['log'](_0x1274d9[_0x2e34b1(0x272)]);const _0x5b2327=new c_payment_data({'invoice':_0x98adda,'customer':_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x18e)],'reason':_0x2e34b1(0x1f3)});await _0x5b2327[_0x2e34b1(0x290)]();const _0x44d236=await master_shop[_0x2e34b1(0x195)]();console[_0x2e34b1(0x212)](_0x2e34b1(0x23b),_0x44d236[0x0][_0x2e34b1(0x2af)]);const _0x5886d0=await email_settings[_0x2e34b1(0x29f)](),_0x4768c4=await customer[_0x2e34b1(0x29f)]({'name':_0x1274d9[_0x2e34b1(0x272)][_0x2e34b1(0x18e)]});console[_0x2e34b1(0x212)]('customer_data',_0x4768c4);_0x44d236[0x0]['currency_placement']==0x1?(right_currency=_0x44d236[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x44d236[0x0]['currency']);var _0x5744aa=_0x581355,_0x2e01c0=_0x1874e2,_0xaf6a0='',_0x1c5206;for(_0x1c5206 in _0x5744aa){_0xaf6a0+='<tr>'+_0x2e34b1(0x1b5)+_0x5744aa[_0x1c5206]+_0x2e34b1(0x248)+_0x2e34b1(0x1b5)+_0x2e01c0[_0x1c5206]+_0x2e34b1(0x248)+_0x2e34b1(0x1fa);}console[_0x2e34b1(0x212)](_0x2e34b1(0x265),_0xaf6a0);let _0x44ce2e=nodemailer[_0x2e34b1(0x262)]({'service':_0x2e34b1(0x19f),'auth':{'user':_0x5886d0[_0x2e34b1(0x25e)],'pass':_0x5886d0[_0x2e34b1(0x17b)]}}),_0x2e6b3a={'from':_0x5886d0[_0x2e34b1(0x25e)],'to':_0x4768c4[_0x2e34b1(0x25e)],'subject':_0x2e34b1(0x1eb),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2e34b1(0x2a9)+_0x2e34b1(0x294)+_0x44d236[0x0]['image'],'cid':_0x2e34b1(0x1e3)}],'html':_0x2e34b1(0x175)+_0x2e34b1(0x20c)+_0x2e34b1(0x1ff)+_0x2e34b1(0x29a)+_0x2e34b1(0x24b)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2e34b1(0x1cd)+'<div>'+_0x2e34b1(0x28a)+_0x44d236[0x0]['site_title']+_0x2e34b1(0x1a9)+_0x2e34b1(0x1cd)+_0x2e34b1(0x1cd)+_0x2e34b1(0x1fb)+_0x2e34b1(0x29a)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x98adda+'\x20'+_0x2e34b1(0x2b9)+_0x2e34b1(0x19c)+_0x5b613a+'\x20'+'</span>'+_0x2e34b1(0x1e6)+'</div>'+_0x2e34b1(0x2b5)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2e34b1(0x254)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x2e34b1(0x24a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x2e34b1(0x1fa)+_0x2e34b1(0x18b)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0xaf6a0+'\x20'+'</tbody>'+_0x2e34b1(0x18a)+_0x2e34b1(0x29a)+_0x2e34b1(0x282)+_0x2e34b1(0x27e)+_0x44d236[0x0]['site_title']+_0x2e34b1(0x1e6)+_0x2e34b1(0x1cd)+'</div>'+'</body></html>'};_0x44ce2e[_0x2e34b1(0x1cc)](_0x2e6b3a,function(_0x20424a,_0x4a975d){var _0x4221c2=_0x2e34b1;_0x20424a?(console[_0x4221c2(0x212)](_0x20424a),console[_0x4221c2(0x212)](_0x4221c2(0x1be))):console['log'](_0x4221c2(0x190));}),_0x1274d9[_0x2e34b1(0x1af)](_0x2e34b1(0x1a4),_0x2e34b1(0x203)),_0x35b4da['redirect'](_0x2e34b1(0x214));}catch(_0x4c0c36){console[_0x2e34b1(0x212)](_0x4c0c36),_0x35b4da['status'](0xc8)['json']({'message1':_0x4c0c36['message']});}}}),router['get'](a0_0x1676be(0x197),auth,async(_0x58797b,_0x48333b)=>{var _0x140dde=a0_0x1676be;try{const {username:_0x323a60,email:_0x22ca75,role:_0xb6a923}=_0x58797b[_0x140dde(0x260)],_0x5c2f68=_0x58797b[_0x140dde(0x260)],_0x5a5a9f=await profile[_0x140dde(0x29f)]({'email':_0x5c2f68['email']}),_0x10a698=await master_shop[_0x140dde(0x195)]();console[_0x140dde(0x212)](_0x140dde(0x2b2),_0x10a698);const _0x1ebf3a=_0x58797b[_0x140dde(0x2ad)]['id'],_0x21acd3=await sales['findById'](_0x1ebf3a);console[_0x140dde(0x212)]('barcode\x20user_id',_0x21acd3);if(_0x10a698[0x0]['language']==_0x140dde(0x276))var _0x44c09b=users[_0x140dde(0x257)];else{if(_0x10a698[0x0][_0x140dde(0x22d)]==_0x140dde(0x183))var _0x44c09b=users[_0x140dde(0x183)];else{if(_0x10a698[0x0][_0x140dde(0x22d)]==_0x140dde(0x258))var _0x44c09b=users[_0x140dde(0x258)];else{if(_0x10a698[0x0][_0x140dde(0x22d)]=='Spanish')var _0x44c09b=users['Spanish'];else{if(_0x10a698[0x0]['language']==_0x140dde(0x26e))var _0x44c09b=users[_0x140dde(0x26e)];else{if(_0x10a698[0x0][_0x140dde(0x22d)]==_0x140dde(0x1c5))var _0x44c09b=users['Portuguese'];else{if(_0x10a698[0x0][_0x140dde(0x22d)]==_0x140dde(0x1bc))var _0x44c09b=users[_0x140dde(0x1bc)];else{if(_0x10a698[0x0][_0x140dde(0x22d)]==_0x140dde(0x1b1))var _0x44c09b=users[_0x140dde(0x218)];}}}}}}}_0x48333b[_0x140dde(0x24d)](_0x140dde(0x1ea),{'success':_0x58797b[_0x140dde(0x1af)]('success'),'errors':_0x58797b[_0x140dde(0x1af)](_0x140dde(0x261)),'role':_0x5c2f68,'profile':_0x5a5a9f,'alldata':_0x21acd3,'master_shop':_0x10a698,'language':_0x44c09b});}catch(_0xc70e16){console[_0x140dde(0x212)](_0xc70e16);}}),router[a0_0x1676be(0x28b)](a0_0x1676be(0x2a1),async(_0x23642a,_0x505cc4)=>{var _0x5ebaf=a0_0x1676be;const {product_code:_0x3d0fcd,warehouse_name:_0x229ef2,rooms_data:_0x1589a2,Roomslist:_0xb3a2c3,sales_category:_0x3fb396}=_0x23642a[_0x5ebaf(0x272)],_0xdb4c4d=_0xb3a2c3[_0x5ebaf(0x2b3)](','),_0x4db83e=[];async function _0x23066e(_0xf69657){var _0x143b31=_0x5ebaf;const _0x55e063=await warehouse[_0x143b31(0x24f)]([{'$match':{'name':_0x229ef2,'room':_0xf69657}},{'$unwind':_0x143b31(0x2ac)},{'$match':{'product_details.primary_code':_0x3d0fcd}},{'$group':{'_id':_0x143b31(0x173),'name':{'$first':_0x143b31(0x28f)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x143b31(0x19b)},'secondary_code':{'$first':_0x143b31(0x1c1)},'product_code':{'$first':_0x143b31(0x204)},'level':{'$first':_0x143b31(0x1b6)},'bay':{'$first':'$product_details.bay'},'type':{'$first':_0x143b31(0x170)},'pallet':{'$first':_0x143b31(0x174)},'unit':{'$first':_0x143b31(0x1f7)},'secondary_unit':{'$first':_0x143b31(0x239)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x143b31(0x229)},'expiry_date':{'$first':_0x143b31(0x189)},'production_date':{'$first':_0x143b31(0x253)},'maxPerUnit':{'$first':_0x143b31(0x266)},'batch_code':{'$first':_0x143b31(0x221)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x143b31(0x199)},'invoice':{'$first':_0x143b31(0x237)},'uuid':{'$first':_0x143b31(0x181)},'gross_price':{'$first':_0x143b31(0x1f0)},'sales_category':{'$first':'$product_details.sales_category'}}}]),_0x4eac0c=await warehouse[_0x143b31(0x24f)]([{'$match':{'name':_0x229ef2,'room':_0xf69657}},{'$unwind':_0x143b31(0x2ac)},{'$match':{'product_details.secondary_code':_0x3d0fcd}},{'$group':{'_id':_0x143b31(0x173),'name':{'$first':_0x143b31(0x28f)},'product_stock':{'$first':_0x143b31(0x22f)},'primary_code':{'$first':_0x143b31(0x19b)},'secondary_code':{'$first':_0x143b31(0x1c1)},'product_code':{'$first':_0x143b31(0x204)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x143b31(0x1f6)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x143b31(0x174)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x143b31(0x239)},'storage':{'$first':_0x143b31(0x1b9)},'rack':{'$first':_0x143b31(0x229)},'expiry_date':{'$first':_0x143b31(0x189)},'production_date':{'$first':_0x143b31(0x253)},'maxPerUnit':{'$first':_0x143b31(0x266)},'batch_code':{'$first':_0x143b31(0x221)},'product_cat':{'$first':_0x143b31(0x1c9)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x143b31(0x199)},'invoice':{'$first':_0x143b31(0x237)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x143b31(0x1f0)},'sales_category':{'$first':_0x143b31(0x17c)}}}]);if(_0x55e063['length']>0x0)_0x4db83e['push'](_0x55e063);else _0x4eac0c['length']>0x0&&_0x4db83e[_0x143b31(0x236)](_0x4eac0c);}const _0x316942=_0xdb4c4d[_0x5ebaf(0x286)](_0x215b0b=>_0x23066e(_0x215b0b));await Promise[_0x5ebaf(0x20b)](_0x316942),_0x505cc4[_0x5ebaf(0x1a6)](_0x4db83e);}),router[a0_0x1676be(0x28b)]('/barcode_scanner_logs',async(_0x567fb9,_0x502ef2)=>{var _0x269ec5=a0_0x1676be;const {product_code:_0x4f3a21,warehouse_name:_0x35c13b,rooms_data:_0x467e74,Roomslist:_0x29efc5,sales_category:_0x235385}=_0x567fb9[_0x269ec5(0x272)],_0x1879e3=_0x29efc5[_0x269ec5(0x2b3)](','),_0x51b8dc=[];async function _0x524285(_0x51fc3a){var _0x566e9c=_0x269ec5;const _0x2d8ee9=await warehouse[_0x566e9c(0x24f)]([{'$match':{'name':_0x35c13b,'room':_0x51fc3a}},{'$unwind':_0x566e9c(0x2ac)},{'$match':{'product_details.primary_code':_0x4f3a21,'product_details.sales_category':_0x235385,'product_details.type_products':_0x566e9c(0x212)}},{'$group':{'_id':_0x566e9c(0x173),'name':{'$first':_0x566e9c(0x28f)},'product_stock':{'$first':_0x566e9c(0x22f)},'primary_code':{'$first':_0x566e9c(0x19b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x566e9c(0x204)},'level':{'$first':'$product_details.level'},'bay':{'$first':_0x566e9c(0x1cb)},'type':{'$first':_0x566e9c(0x170)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x566e9c(0x1f7)},'secondary_unit':{'$first':_0x566e9c(0x239)},'storage':{'$first':_0x566e9c(0x1b9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x566e9c(0x189)},'production_date':{'$first':_0x566e9c(0x253)},'maxPerUnit':{'$first':_0x566e9c(0x266)},'batch_code':{'$first':_0x566e9c(0x221)},'product_cat':{'$first':_0x566e9c(0x1c9)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x566e9c(0x199)},'invoice':{'$first':_0x566e9c(0x237)},'uuid':{'$first':_0x566e9c(0x181)},'gross_price':{'$first':_0x566e9c(0x1f0)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':'$product_details.type_products'}}}]);console['log']('log'+_0x566e9c(0x2ab)+_0x4f3a21+'\x20<>\x20'+_0x235385);const _0x4820ca=await warehouse[_0x566e9c(0x24f)]([{'$match':{'name':_0x35c13b,'room':_0x51fc3a}},{'$unwind':_0x566e9c(0x2ac)},{'$match':{'product_details.secondary_code':_0x4f3a21,'product_details.sales_category':_0x235385,'product_details.type_products':_0x566e9c(0x212)}},{'$group':{'_id':_0x566e9c(0x173),'name':{'$first':_0x566e9c(0x28f)},'product_stock':{'$first':_0x566e9c(0x22f)},'primary_code':{'$first':_0x566e9c(0x19b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x566e9c(0x204)},'level':{'$first':_0x566e9c(0x1cb)},'isle':{'$first':_0x566e9c(0x1f6)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x566e9c(0x1f7)},'secondary_unit':{'$first':_0x566e9c(0x239)},'storage':{'$first':_0x566e9c(0x1b9)},'rack':{'$first':_0x566e9c(0x229)},'expiry_date':{'$first':_0x566e9c(0x189)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x566e9c(0x221)},'product_cat':{'$first':_0x566e9c(0x1c9)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x566e9c(0x199)},'invoice':{'$first':_0x566e9c(0x237)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x566e9c(0x1f0)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':_0x566e9c(0x2b8)}}}]);if(_0x2d8ee9[_0x566e9c(0x19a)]>0x0)_0x51b8dc[_0x566e9c(0x236)](_0x2d8ee9);else _0x4820ca[_0x566e9c(0x19a)]>0x0&&_0x51b8dc[_0x566e9c(0x236)](_0x4820ca);}const _0x30653f=_0x1879e3[_0x269ec5(0x286)](_0x1988b7=>_0x524285(_0x1988b7));await Promise[_0x269ec5(0x20b)](_0x30653f),_0x502ef2[_0x269ec5(0x1a6)](_0x51b8dc);}),router[a0_0x1676be(0x28b)]('/barcode_scanner_auto_data',async(_0x3be74b,_0xd0b183)=>{var _0x593293=a0_0x1676be;try{const {prduct_code:_0x197bff,warehouse_data:_0x25b907,qty_req:_0x1b79de}=_0x3be74b[_0x593293(0x272)];let _0x584b01=_0x197bff[_0x593293(0x2b3)]('~'),_0x218f54=_0x1b79de[_0x593293(0x2b3)]('~'),_0x5ee16f=[],_0x582dab=0x0;for(let _0x37e5d4=0x0;_0x37e5d4<=_0x584b01[_0x593293(0x19a)]-0x1;_0x37e5d4++){const _0x532236=_0x584b01[_0x37e5d4],_0x527c24=_0x218f54[_0x37e5d4],_0x47904d=await warehouse['aggregate']([{'$match':{'name':_0x25b907}},{'$unwind':_0x593293(0x2ac)},{'$match':{'product_details.product_code':_0x532236,'product_details.isAvailable':_0x593293(0x269),'product_details.isUsed':_0x593293(0x1bb)}},{'$sort':{'product_details.date_received':0x1}},{'$group':{'_id':_0x593293(0x173),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x593293(0x22f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x593293(0x1c1)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x593293(0x1b6)},'bay':{'$first':_0x593293(0x1cb)},'type':{'$first':_0x593293(0x170)},'pallet':{'$first':_0x593293(0x174)},'unit':{'$first':_0x593293(0x1f7)},'secondary_unit':{'$first':_0x593293(0x239)},'storage':{'$first':_0x593293(0x1b9)},'rack':{'$first':_0x593293(0x229)},'expiry_date':{'$first':_0x593293(0x189)},'production_date':{'$first':_0x593293(0x253)},'maxPerUnit':{'$first':_0x593293(0x266)},'batch_code':{'$first':_0x593293(0x221)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x593293(0x237)},'uuid':{'$first':_0x593293(0x181)},'gross_price':{'$first':_0x593293(0x1f0)},'sales_category':{'$first':'$product_details.sales_category'},'date_received':{'$first':_0x593293(0x1a8)},'warehouse_id':{'$first':_0x593293(0x224)}}}]),_0x2b4ef6=_0x47904d[_0x593293(0x1aa)]((_0x241c44,_0x437e37)=>new Date(_0x241c44[_0x593293(0x29b)])-new Date(_0x437e37[_0x593293(0x29b)]));let _0x3792ba=_0x527c24;for(let _0x47892b=0x0;_0x47892b<=_0x2b4ef6[_0x593293(0x19a)]-0x1&&_0x3792ba>0x0;_0x47892b++){const _0x2f6ea6=_0x2b4ef6[_0x47892b];if(_0x2f6ea6[_0x593293(0x2b1)]==_0x532236){_0x5ee16f[_0x582dab]={};const _0x2e21a9=parseInt(_0x2f6ea6[_0x593293(0x1e0)]),_0x3fb2f7=0x0;let _0x567a90=_0x2e21a9-_0x3fb2f7,_0x32eaf1=Math[_0x593293(0x23d)](_0x3792ba,_0x567a90);console[_0x593293(0x212)](_0x593293(0x207)+_0x32eaf1+'\x20units\x20to\x20warehouse:\x20'+_0x25b907+_0x593293(0x250)+_0x2f6ea6[_0x593293(0x2a2)]+_0x593293(0x240)+(_0x2f6ea6[_0x593293(0x1e7)]+_0x2f6ea6['bay'])+_0x593293(0x1b4)+_0x2f6ea6[_0x593293(0x29b)]+_0x593293(0x178)+_0x2f6ea6[_0x593293(0x267)]),_0x5ee16f[_0x582dab]['group_ids']=_0x2f6ea6[_0x593293(0x1a1)]+'~'+_0x2f6ea6[_0x593293(0x299)]+'~'+_0x32eaf1,_0x5ee16f[_0x582dab]['product_name']=_0x2f6ea6[_0x593293(0x267)],_0x5ee16f[_0x582dab][_0x593293(0x2b1)]=_0x2f6ea6['product_code'],_0x5ee16f[_0x582dab][_0x593293(0x259)]=_0x2f6ea6['product_id'],_0x5ee16f[_0x582dab][_0x593293(0x1e2)]=_0x2f6ea6[_0x593293(0x1e2)],_0x5ee16f[_0x582dab][_0x593293(0x1db)]=_0x2f6ea6['sales_category'],_0x5ee16f[_0x582dab]['uuid']=_0x2f6ea6['uuid'],_0x5ee16f[_0x582dab][_0x593293(0x219)]=_0x32eaf1,_0x5ee16f[_0x582dab][_0x593293(0x191)]=_0x2f6ea6[_0x593293(0x191)],_0x5ee16f[_0x582dab][_0x593293(0x243)]=_0x2f6ea6[_0x593293(0x243)],_0x5ee16f[_0x582dab]['primary_code']=_0x2f6ea6[_0x593293(0x273)],_0x5ee16f[_0x582dab][_0x593293(0x1d4)]=_0x2f6ea6['secondary_code'],_0x5ee16f[_0x582dab]['maxStocks']=_0x2f6ea6[_0x593293(0x25f)],_0x5ee16f[_0x582dab][_0x593293(0x1b0)]=_0x2f6ea6[_0x593293(0x1b0)],_0x5ee16f[_0x582dab][_0x593293(0x1ef)]=_0x2f6ea6[_0x593293(0x1ef)],_0x5ee16f[_0x582dab][_0x593293(0x228)]=_0x2f6ea6[_0x593293(0x228)],_0x5ee16f[_0x582dab][_0x593293(0x1c3)]=_0x2f6ea6[_0x593293(0x1c3)],_0x5ee16f[_0x582dab][_0x593293(0x233)]=_0x2f6ea6['product_cat'],_0x5ee16f[_0x582dab]['invoice']=_0x2f6ea6[_0x593293(0x1d7)],_0x5ee16f[_0x582dab][_0x593293(0x277)]=_0x2f6ea6[_0x593293(0x277)],_0x5ee16f[_0x582dab][_0x593293(0x1f9)]=_0x2f6ea6[_0x593293(0x2a2)],_0x5ee16f[_0x582dab]['level']=_0x2f6ea6[_0x593293(0x1e7)],_0x5ee16f[_0x582dab][_0x593293(0x27d)]=_0x2f6ea6['bay'],_0x5ee16f[_0x582dab]['status']=_0x593293(0x269),console[_0x593293(0x212)]('1',_0x582dab),_0x3792ba-=_0x32eaf1,_0x582dab++;if(_0x3792ba<=0x0)break;}}if(_0x3792ba>0x0){var _0x314835=await product[_0x593293(0x29f)]({'product_code':_0x532236});console[_0x593293(0x212)]('2',_0x582dab),_0x5ee16f[_0x582dab]={},_0x5ee16f[_0x582dab]['product_name']=_0x314835[_0x593293(0x267)],_0x5ee16f[_0x582dab]['product_code']=_0x532236,_0x5ee16f[_0x582dab][_0x593293(0x259)]=_0x314835[_0x593293(0x299)][_0x593293(0x29c)](),_0x5ee16f[_0x582dab]['quantity']=_0x3792ba,_0x5ee16f[_0x582dab]['standard_unit']=_0x314835[_0x593293(0x191)],_0x5ee16f[_0x582dab]['secondary_unit']=_0x314835[_0x593293(0x1ec)],_0x5ee16f[_0x582dab][_0x593293(0x273)]=_0x314835[_0x593293(0x273)],_0x5ee16f[_0x582dab][_0x593293(0x1d4)]=_0x314835[_0x593293(0x1d4)],_0x5ee16f[_0x582dab]['maxStocks']=_0x314835[_0x593293(0x25f)],_0x5ee16f[_0x582dab]['maxperunit']=_0x314835[_0x593293(0x213)],_0x5ee16f[_0x582dab][_0x593293(0x277)]=_0x314835[_0x593293(0x277)],_0x5ee16f[_0x582dab][_0x593293(0x235)]=_0x593293(0x1bb),console[_0x593293(0x212)](_0x593293(0x1d0)+_0x3792ba+'\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20'+_0x582dab+_0x593293(0x2ab)+_0x532236),_0x582dab++;}}_0xd0b183[_0x593293(0x1a6)](_0x5ee16f);}catch(_0x365c37){console['log'](_0x365c37);}}),router[a0_0x1676be(0x28b)]('/barcode_scanner_auto',async(_0x2a2d7a,_0x9f7404)=>{var _0x57c8b4=a0_0x1676be;const {product_code:_0x4d5642}=_0x2a2d7a['body'];var _0x18e2fc;const _0x1084ee=await product[_0x57c8b4(0x24f)]([{'$match':{'primary_code':_0x4d5642}},{'$group':{'_id':_0x57c8b4(0x224),'name':{'$first':_0x57c8b4(0x1fe)},'category':{'$first':'$category'},'brand':{'$first':_0x57c8b4(0x291)},'unit':{'$first':_0x57c8b4(0x17f)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x57c8b4(0x255)},'secondary_code':{'$first':_0x57c8b4(0x1b3)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x57c8b4(0x222)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x57c8b4(0x198)},'gross_price':{'$first':_0x57c8b4(0x194)},'sales_category':{'$first':_0x57c8b4(0x1d1)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x533a8e=await product[_0x57c8b4(0x24f)]([{'$match':{'secondary_code':_0x4d5642}},{'$group':{'_id':_0x57c8b4(0x224),'name':{'$first':_0x57c8b4(0x1fe)},'category':{'$first':_0x57c8b4(0x1ba)},'brand':{'$first':_0x57c8b4(0x291)},'unit':{'$first':_0x57c8b4(0x17f)},'alertquantity':{'$first':_0x57c8b4(0x20e)},'product_code':{'$first':_0x57c8b4(0x176)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x57c8b4(0x1b3)},'maxStocks':{'$first':_0x57c8b4(0x17d)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x57c8b4(0x198)},'gross_price':{'$first':_0x57c8b4(0x194)},'sales_category':{'$first':_0x57c8b4(0x1d1)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x1084ee[_0x57c8b4(0x19a)]>0x0)_0x18e2fc=_0x1084ee;else _0x533a8e[_0x57c8b4(0x19a)]>0x0&&(_0x18e2fc=_0x533a8e);_0x9f7404[_0x57c8b4(0x1a6)](_0x18e2fc);}),router[a0_0x1676be(0x28b)]('/process/view',async(_0x4a6fd3,_0xf7c993)=>{var _0x518fc9=a0_0x1676be;try{const {group_id:_0x509cb4,DRSI:_0x5a4aa5,dateofreq:_0x4a4a87,PO_number:_0x12e453,date:_0x2bf0e2,warehouse_name:_0x39d11a,typevehicle:_0x43dbd0,deliverydate:_0x29dbee,driver:_0x5d91d6,plate:_0x5db4cc,van:_0x1e5229,TSU:_0x54ce0a,actual_delivery_date:_0x3dd883,TFU:_0x31df55,pull_out_date:_0x320100,sales:_0x1002f7,Customer_data:_0x21e22a,note:_0x4bce94}=_0x4a6fd3[_0x518fc9(0x272)],_0x1b6810=mongoose[_0x518fc9(0x227)]['ObjectId'];let _0x2c3104=[];const _0x11e793=new invoice_for_outgoing();await _0x11e793[_0x518fc9(0x290)]();const _0x4e2cff=_0x518fc9(0x280)+_0x11e793[_0x518fc9(0x287)][_0x518fc9(0x1a2)]()[_0x518fc9(0x18d)](0x8,'0');if(typeof _0x509cb4==_0x518fc9(0x1b7)){let _0x25dc4f=_0x509cb4[_0x518fc9(0x2b3)]('~');var _0x3f1e0d=_0x1b6810(_0x25dc4f[0x0]),_0x49d212=_0x1b6810(_0x25dc4f[0x1]),_0x8d016=_0x25dc4f[0x2];let _0x3af84d=0x0;const _0x17133e=await warehouse[_0x518fc9(0x24f)]([{'$match':{'_id':_0x3f1e0d}},{'$unwind':'$product_details'},{'$match':{'product_details._id':_0x49d212}}]);await warehouse[_0x518fc9(0x171)]({'_id':_0x1b6810(_0x3f1e0d),'product_details._id':_0x1b6810(_0x49d212)},{'$set':{'product_details.$.isUsed':'true'}}),_0x2c3104[_0x3af84d]={};for(let _0x47d1ce=0x0;_0x47d1ce<=_0x17133e[_0x518fc9(0x19a)]-0x1;_0x47d1ce++){const _0x7531f5=_0x17133e[_0x47d1ce];console[_0x518fc9(0x212)](_0x7531f5),_0x2c3104[_0x3af84d]['warehouse']=_0x7531f5[_0x518fc9(0x267)],_0x2c3104[_0x3af84d][_0x518fc9(0x259)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x259)],_0x2c3104[_0x3af84d][_0x518fc9(0x1c4)]=_0x7531f5['product_details'][_0x518fc9(0x1c4)],_0x2c3104[_0x3af84d]['product_code']=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x2b1)],_0x2c3104[_0x3af84d][_0x518fc9(0x1e0)]=_0x8d016,_0x2c3104[_0x3af84d][_0x518fc9(0x219)]=_0x8d016,_0x2c3104[_0x3af84d][_0x518fc9(0x191)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x191)],_0x2c3104[_0x3af84d]['secondary_unit']=_0x7531f5['product_details'][_0x518fc9(0x243)],_0x2c3104[_0x3af84d][_0x518fc9(0x1e7)]=_0x7531f5[_0x518fc9(0x296)]['level'],_0x2c3104[_0x3af84d][_0x518fc9(0x27d)]=_0x7531f5[_0x518fc9(0x296)]['bay'],_0x2c3104[_0x3af84d][_0x518fc9(0x273)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x273)],_0x2c3104[_0x3af84d][_0x518fc9(0x1d4)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x1d4)],_0x2c3104[_0x3af84d]['maxStocks']=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x25f)],_0x2c3104[_0x3af84d]['batch_code']=_0x7531f5[_0x518fc9(0x296)]['batch_code'],_0x2c3104[_0x3af84d][_0x518fc9(0x1ef)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x1ef)],_0x2c3104[_0x3af84d][_0x518fc9(0x228)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x228)],_0x2c3104[_0x3af84d]['maxperunit']=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x1c3)],_0x2c3104[_0x3af84d]['product_cat']=_0x7531f5[_0x518fc9(0x296)]['product_cat'],_0x2c3104[_0x3af84d]['room_name']=_0x7531f5['room'],_0x2c3104[_0x3af84d][_0x518fc9(0x1d7)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x1d7)],_0x2c3104[_0x3af84d]['uuid']=_0x7531f5['product_details']['uuid'],_0x2c3104[_0x3af84d][_0x518fc9(0x277)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x277)],_0x2c3104[_0x3af84d][_0x518fc9(0x1db)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x244)],_0x2c3104[_0x3af84d][_0x518fc9(0x1e2)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x1e2)],_0x2c3104[_0x3af84d][_0x518fc9(0x1ed)]=_0x7531f5[_0x518fc9(0x296)][_0x518fc9(0x244)],_0x2c3104[_0x3af84d]['warehouse_id']=_0x7531f5[_0x518fc9(0x299)][_0x518fc9(0x29c)](),_0x2c3104[_0x3af84d][_0x518fc9(0x242)]=_0x7531f5['product_details'][_0x518fc9(0x299)][_0x518fc9(0x29c)](),_0x2c3104[_0x3af84d]['data_type']='out',_0x2c3104[_0x3af84d]['agent_id']=_0x7531f5['product_details'][_0x518fc9(0x244)];}_0x2c3104[_0x3af84d]['outgoiug_inv']=_0x4e2cff;}else for(let _0x24e7ee=0x0;_0x24e7ee<=_0x509cb4[_0x518fc9(0x19a)]-0x1;_0x24e7ee++){const _0x4c9657=_0x509cb4[_0x24e7ee];let _0x4296b7=_0x4c9657[_0x518fc9(0x2b3)]('~');console[_0x518fc9(0x212)](_0x4296b7);var _0x3f1e0d=_0x1b6810(_0x4296b7[0x0]),_0x49d212=_0x1b6810(_0x4296b7[0x1]),_0x8d016=_0x4296b7[0x2];const _0x155fad=await warehouse['aggregate']([{'$match':{'_id':_0x3f1e0d}},{'$unwind':_0x518fc9(0x2ac)},{'$match':{'product_details._id':_0x49d212}}]);await warehouse[_0x518fc9(0x171)]({'_id':_0x1b6810(_0x3f1e0d),'product_details._id':_0x1b6810(_0x49d212)},{'$set':{'product_details.$.isUsed':_0x518fc9(0x269)}}),_0x2c3104[_0x24e7ee]={};for(let _0xac5652=0x0;_0xac5652<=_0x155fad[_0x518fc9(0x19a)]-0x1;_0xac5652++){const _0x4a5f17=_0x155fad[_0xac5652];_0x2c3104[_0x24e7ee][_0x518fc9(0x220)]=_0x4a5f17[_0x518fc9(0x267)],_0x2c3104[_0x24e7ee][_0x518fc9(0x259)]=_0x4a5f17[_0x518fc9(0x296)]['product_id'],_0x2c3104[_0x24e7ee][_0x518fc9(0x1c4)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x1c4)],_0x2c3104[_0x24e7ee]['product_code']=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x2b1)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1e0)]=_0x8d016,_0x2c3104[_0x24e7ee][_0x518fc9(0x219)]=_0x8d016,_0x2c3104[_0x24e7ee]['unit']=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x191)],_0x2c3104[_0x24e7ee]['secondary_unit']=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x243)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1e7)]=_0x4a5f17['product_details'][_0x518fc9(0x1e7)],_0x2c3104[_0x24e7ee]['bay']=_0x4a5f17[_0x518fc9(0x296)]['bay'],_0x2c3104[_0x24e7ee][_0x518fc9(0x273)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x273)],_0x2c3104[_0x24e7ee]['secondary_code']=_0x4a5f17['product_details'][_0x518fc9(0x1d4)],_0x2c3104[_0x24e7ee][_0x518fc9(0x25f)]=_0x4a5f17['product_details'][_0x518fc9(0x25f)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1b0)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x1b0)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1ef)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x1ef)],_0x2c3104[_0x24e7ee]['production_date']=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x228)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1c3)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x1c3)],_0x2c3104[_0x24e7ee][_0x518fc9(0x233)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x233)],_0x2c3104[_0x24e7ee]['room_name']=_0x4a5f17[_0x518fc9(0x1c6)],_0x2c3104[_0x24e7ee]['invoice']=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x1d7)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1fc)]=_0x4a5f17['product_details']['uuid'],_0x2c3104[_0x24e7ee]['gross_price']=_0x4a5f17[_0x518fc9(0x296)]['gross_price'],_0x2c3104[_0x24e7ee][_0x518fc9(0x1db)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x244)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1e2)]=_0x4a5f17['product_details'][_0x518fc9(0x1e2)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1ed)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x244)],_0x2c3104[_0x24e7ee][_0x518fc9(0x1a1)]=_0x4a5f17[_0x518fc9(0x299)]['valueOf'](),_0x2c3104[_0x24e7ee]['warehouse_id_detl']=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x299)][_0x518fc9(0x29c)](),_0x2c3104[_0x24e7ee][_0x518fc9(0x225)]=_0x518fc9(0x1c0),_0x2c3104[_0x24e7ee][_0x518fc9(0x211)]=_0x4a5f17[_0x518fc9(0x296)][_0x518fc9(0x244)];}_0x2c3104[_0x24e7ee]['outgoiug_inv']=_0x4e2cff;}for(let _0x2e4a2a=0x0;_0x2e4a2a<=_0x2c3104[_0x518fc9(0x19a)]-0x1;_0x2e4a2a++){const _0x448475=_0x2c3104[_0x2e4a2a],_0x467892=new warehouse_temporary(_0x448475);await _0x467892[_0x518fc9(0x290)]();}const _0x1cbeb2=new sales_finished({'invoice':_0x4e2cff,'sales_data':_0x1002f7,'customer':_0x21e22a,'date':_0x2bf0e2,'warehouse_name':_0x39d11a,'sale_product':_0x2c3104,'note':_0x4bce94,'finalize':_0x518fc9(0x26c),'dateofreq':_0x4a4a87,'PO_number':_0x12e453,'typevehicle':_0x43dbd0,'deliverydate':_0x29dbee,'driver':_0x5d91d6,'plate':_0x5db4cc,'van':_0x1e5229,'DRSI':_0x5a4aa5,'TSU':_0x54ce0a,'TFU':_0x31df55,'pullout_date':_0x320100,'actualdelivery_date':_0x3dd883,'typeOfProducts':_0x518fc9(0x246)}),_0x4451c7=await _0x1cbeb2[_0x518fc9(0x290)]();_0x4a6fd3[_0x518fc9(0x1af)](_0x518fc9(0x1a4),'Sales\x20Add\x20successfully'),_0xf7c993[_0x518fc9(0x26b)](_0x518fc9(0x1b2)+_0x4451c7['_id']);}catch(_0x24c746){console[_0x518fc9(0x212)](_0x24c746);}}),module[a0_0x1676be(0x298)]=router;