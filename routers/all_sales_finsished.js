var a0_0x40efbc=a0_0x2e5d;function a0_0x2e5d(_0x36856e,_0x31f5c3){var _0x19adb9=a0_0x19ad();return a0_0x2e5d=function(_0x2e5d19,_0x22b349){_0x2e5d19=_0x2e5d19-0x109;var _0x405a22=_0x19adb9[_0x2e5d19];return _0x405a22;},a0_0x2e5d(_0x36856e,_0x31f5c3);}function a0_0x19ad(){var _0x34735a=['\x20==\x20','return_qty','find','<h5>','return_data','customer_data','invoice_init','$unit','master','group_ids','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','return_sale_QA','<div>','$customer','Sales\x20Add\x20successfully','amount','user','sales_id','$product_code','$product_details','mongoose','production_date_QA','$product_details.uuid','updateOne','548808zOnxwi','ObjectId','role','$warehouse_name','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','primary_code','sale_product','Received\x20Payment\x20For\x20Sale','customer','$alertquantity','secondary_code','<h2>\x20','Chinese','/give_payment/:id','\x20<>\x20','date_received','Sale\x20Return','all_sales_finished','/view/return_sales/:id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','logo','/all_sales/view','prod_invoice','return_qty_QA','3795shiuSU','sales_invoice','$sale_product.floorlevel','here','2050820rVSEwA','RoomAssigned','English\x20(US)','note','status','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$product_details.date_recieved','floor','$sale_product.quantity','expiry_date_QA','redirect','sales_quantity','currency','product_list','purchases_data','Hindi','sale_qty','random','batch_code_QA','success','stock','split',',\x20Location:\x20','Arabic\x20(ae)','body','aggregate','../models/all_models','</tr>','8350WJrxfh','maxPerUnit','roomNamed','<h5\x20style=\x22text-align:\x20left;\x22>','room_name','invoice','1587411fxunHo','$name','Router','email','warehouse_id_detl','then','express','concat','date_recieved','forEach','abs','return_sale','$product_details.floorlevel','id_transaction_from','$product_details._id','post','\x20Order\x20Date\x20:\x20','$product_details.product_cat','/view/add_sale/product','quantity','Spanish','$customers_docs','$return_data','filter','json','\x20Name:\x20','_id','slice','sales\x20item\x20return\x20successfull','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','stocks_QA','received_amount','edit_sales_finished_view','warehouse_name','$product_details.bay','carton','$product_details.batch_code','Arabic','nodemailer','/view_log','Quality\x20Inspection','</body></html>','English','currency_placement','/all_sales_finished/view','17222dEHzeZ','getFullYear','match','level2','\x20Order\x20Number\x20:\x20','prod_cat','Return\x20Goods','errors','logs','date','/barcode/:id','Email\x20sent\x20successfully','$finalize','/view/:id','maxperunit','room','$maxProdPerUnit','$product_details.rack','agent_id','/upload/','/view','add\x20post','map','$invoice','$product_details.gross_price','/../public','407626DheAvh','$product_details.bin','7TsgdEs','12gippfF','/process/view','$gross_price','due_amount','length','createTransport','product_code','false','getDate','adjust_qty','sales_category','$product','/preview/:id','\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.\x20<>\x20\x20','$product_details.product_name','sales_quantity_QA','/barcode_scanner_auto_data','../public/language/languages.json','site_title','language','outgoing_invoice','</thead>','product_date','Finished\x20Goods','product_cat','product_name_QA1','Error\x20Occurs','maxStocks','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','Distributing\x20','image','save','</head><body>','<html><head><title></title>','sales','$product_details.product_code','<!DOCTYPE\x20html>','outgoiug_inv','$_id','staff','/view/add_sales_logs','$sales_category','Sale\x20Return\x20Mail','level','secondary_unit_QA','/view/add_sales','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Enclosed','edit_sales_finished','true','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product.product_name','expiry_date','\x20Date:\x20','OUT-','$note','product_data','$brand','</div>','Enabled','get','batch_code','$primary_code','product','/invoice/:id','/all_sales_finished/preview/','$product_details.sales_category','primary_code_QA','$product_details.expiry_date','barcode\x20user_id','\x20units\x20to\x20warehouse:\x20','maxProducts','$product_details.secondary_code','$date','$maxStocks','secondary_code_QA','$sale_product.bay','standard_unit','Portuguese\x20(BR)','message','$category','findOne','$sale_product.bin','params','product_name','valueOf','gross_price','prod_code','maxProducts_QA','$product_details.storage','product_details','back','</tbody>','</h5>','add_sales_finished_logs','unit','$sale_product.type','production_date','primary_unit','<span\x20style=\x22float:\x20right;\x22>','$product_details.primary_code','finalize','</span>','gmail','return_sale_finished','date_data','$product_details.type','second_unit','stock_data','<table\x20style=\x22width:\x20100%\x20!important;\x22>','LOG-OUT-','$product_details.production_date','string','$product_details.unit','Ambient','log','$secondary_unit','secondary_unit','payment\x20successfull','1103216oLQOTD','<tbody\x20style=\x22text-align:\x20center;\x22>','Logo.png','sendMail','min','exports','$room','add_sales_finished','\x20</h2>','/view/add_sales/:id','<strong>\x20Regards\x20</strong>','final','$product_details.invoice','$sale_product','findById','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Sales\x20Update\x20successfully','product_id','warehouse_id','unit_QA','all','catch','$product_details.maxPerUnit','8sMslbd','German','</table>','Portuguese','</td>','max_per_unit','French','<hr\x20class=\x22my-3\x22>','$secondary_code','render','warehouse','uuid','$product_details.secondary_unit','../middleware/auth','own','product_stock','maxPerUnit_QA','all_sales_finished_logs','flash','toString','padStart','$product_details.level','$product_details.maxProducts','name','data_type','bay','OUTF-','getMonth','password','Types','for_categorize','$product_details.type_products','<tr>','$product_details.product_stock'];a0_0x19ad=function(){return _0x34735a;};return a0_0x19ad();}(function(_0xa73cdf,_0xe967c1){var _0xee1c16=a0_0x2e5d,_0x285be8=_0xa73cdf();while(!![]){try{var _0x3b8daa=-parseInt(_0xee1c16(0x1f4))/0x1+-parseInt(_0xee1c16(0x20e))/0x2*(parseInt(_0xee1c16(0x211))/0x3)+parseInt(_0xee1c16(0x136))/0x4+parseInt(_0xee1c16(0x1a3))/0x5+-parseInt(_0xee1c16(0x187))/0x6*(-parseInt(_0xee1c16(0x210))/0x7)+parseInt(_0xee1c16(0x14d))/0x8*(parseInt(_0xee1c16(0x1c6))/0x9)+-parseInt(_0xee1c16(0x1c0))/0xa*(-parseInt(_0xee1c16(0x19f))/0xb);if(_0x3b8daa===_0xe967c1)break;else _0x285be8['push'](_0x285be8['shift']());}catch(_0x1b663f){_0x285be8['push'](_0x285be8['shift']());}}}(a0_0x19ad,0x63f48));const express=require(a0_0x40efbc(0x1cc)),app=express(),router=express[a0_0x40efbc(0x1c8)](),{profile,master_shop,product,warehouse,staff,customer,purchases,sales,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs,warehouse_temporary,warehouse_validation_setup}=require(a0_0x40efbc(0x1be)),auth=require(a0_0x40efbc(0x15a)),nodemailer=require(a0_0x40efbc(0x1ed)),users=require(a0_0x40efbc(0x222)),mongoose=require(a0_0x40efbc(0x183));router[a0_0x40efbc(0x24d)](a0_0x40efbc(0x208),auth,async(_0x2044df,_0x103974)=>{var _0x3dbfe4=a0_0x40efbc;try{const {username:_0x1fd95c,email:_0x1a6f3b,role:_0x521828}=_0x2044df['user'],_0x68f8cd=_0x2044df[_0x3dbfe4(0x17f)],_0x3fba36=await profile[_0x3dbfe4(0x110)]({'email':_0x68f8cd[_0x3dbfe4(0x1c9)]}),_0x4019e6=await master_shop['find']();let _0x21c9d8;if(_0x68f8cd[_0x3dbfe4(0x189)]==_0x3dbfe4(0x238)){const _0x5b7f02=await staff[_0x3dbfe4(0x110)]({'email':_0x68f8cd[_0x3dbfe4(0x1c9)]});_0x21c9d8=await sales_finished[_0x3dbfe4(0x1bd)]([{'$match':{'typeOfProducts':_0x3dbfe4(0x15b)}},{'$unwind':_0x3dbfe4(0x143)},{'$group':{'_id':_0x3dbfe4(0x237),'invoice':{'$first':_0x3dbfe4(0x20b)},'customers':{'$first':_0x3dbfe4(0x17c)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x3dbfe4(0x18a)},'sale_product':{'$push':_0x3dbfe4(0x143)},'note':{'$first':_0x3dbfe4(0x248)},'return_data':{'$first':_0x3dbfe4(0x1dc)},'customers_docs':{'$first':_0x3dbfe4(0x1db)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x3dbfe4(0x111)},'type':{'$addToSet':_0x3dbfe4(0x11f)},'pallet':{'$addToSet':_0x3dbfe4(0x1a1)},'finalize':{'$first':_0x3dbfe4(0x200)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x21c9d8=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x3dbfe4(0x15b)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x3dbfe4(0x237),'invoice':{'$first':_0x3dbfe4(0x20b)},'customers':{'$first':_0x3dbfe4(0x17c)},'date':{'$first':_0x3dbfe4(0x25a)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x3dbfe4(0x143)},'note':{'$first':_0x3dbfe4(0x248)},'return_data':{'$first':_0x3dbfe4(0x1dc)},'customers_docs':{'$first':_0x3dbfe4(0x1db)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x3dbfe4(0x10b)},'isle':{'$addToSet':_0x3dbfe4(0x111)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x3dbfe4(0x1a1)},'finalize':{'$first':_0x3dbfe4(0x200)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x4019e6[0x0]['language']==_0x3dbfe4(0x1a5)){var _0x4dae2a=users[_0x3dbfe4(0x1f1)];console['log'](_0x4dae2a);}else{if(_0x4019e6[0x0][_0x3dbfe4(0x224)]==_0x3dbfe4(0x1b3))var _0x4dae2a=users[_0x3dbfe4(0x1b3)];else{if(_0x4019e6[0x0]['language']=='German')var _0x4dae2a=users[_0x3dbfe4(0x14e)];else{if(_0x4019e6[0x0][_0x3dbfe4(0x224)]==_0x3dbfe4(0x1da))var _0x4dae2a=users['Spanish'];else{if(_0x4019e6[0x0][_0x3dbfe4(0x224)]=='French')var _0x4dae2a=users[_0x3dbfe4(0x153)];else{if(_0x4019e6[0x0]['language']==_0x3dbfe4(0x10d))var _0x4dae2a=users['Portuguese'];else{if(_0x4019e6[0x0][_0x3dbfe4(0x224)]==_0x3dbfe4(0x193))var _0x4dae2a=users['Chinese'];else{if(_0x4019e6[0x0][_0x3dbfe4(0x224)]=='Arabic\x20(ae)')var _0x4dae2a=users['Arabic'];}}}}}}}_0x103974[_0x3dbfe4(0x156)](_0x3dbfe4(0x198),{'success':_0x2044df[_0x3dbfe4(0x15f)]('success'),'errors':_0x2044df[_0x3dbfe4(0x15f)](_0x3dbfe4(0x1fb)),'sales':_0x21c9d8,'profile':_0x3fba36,'role':_0x68f8cd,'master_shop':_0x4019e6,'language':_0x4dae2a});}catch(_0x129d02){console[_0x3dbfe4(0x132)](_0x129d02);}}),router['get'](a0_0x40efbc(0x1ee),auth,async(_0x1c099c,_0x511cba)=>{var _0x27c28e=a0_0x40efbc;try{const {username:_0x20baa1,email:_0x2c62a3,role:_0xc91b5e}=_0x1c099c['user'],_0x596dd0=_0x1c099c[_0x27c28e(0x17f)],_0x1c2c93=await profile[_0x27c28e(0x110)]({'email':_0x596dd0[_0x27c28e(0x1c9)]}),_0x3d39f1=await master_shop[_0x27c28e(0x171)]();let _0x2efb0f;if(_0x596dd0[_0x27c28e(0x189)]==_0x27c28e(0x238)){const _0x559d71=await staff[_0x27c28e(0x110)]({'email':_0x596dd0['email']});_0x2efb0f=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x27c28e(0x1fc)}},{'$unwind':_0x27c28e(0x143)},{'$group':{'_id':_0x27c28e(0x237),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x27c28e(0x17c)},'date':{'$first':_0x27c28e(0x25a)},'warehouse_name':{'$first':_0x27c28e(0x18a)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x27c28e(0x248)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x27c28e(0x1db)},'total_saleproduct_quantity':{'$sum':_0x27c28e(0x1ac)},'level':{'$addToSet':_0x27c28e(0x10b)},'isle':{'$addToSet':_0x27c28e(0x111)},'type':{'$addToSet':_0x27c28e(0x11f)},'pallet':{'$addToSet':_0x27c28e(0x1a1)},'finalize':{'$first':_0x27c28e(0x200)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x2efb0f=await sales_finished[_0x27c28e(0x1bd)]([{'$match':{'typeOfProducts':_0x27c28e(0x1fc)}},{'$unwind':_0x27c28e(0x143)},{'$group':{'_id':_0x27c28e(0x237),'invoice':{'$first':_0x27c28e(0x20b)},'customers':{'$first':_0x27c28e(0x17c)},'date':{'$first':_0x27c28e(0x25a)},'warehouse_name':{'$first':_0x27c28e(0x18a)},'sale_product':{'$push':_0x27c28e(0x143)},'note':{'$first':_0x27c28e(0x248)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x27c28e(0x1db)},'total_saleproduct_quantity':{'$sum':_0x27c28e(0x1ac)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x27c28e(0x11f)},'pallet':{'$addToSet':_0x27c28e(0x1a1)},'finalize':{'$first':_0x27c28e(0x200)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x3d39f1[0x0][_0x27c28e(0x224)]=='English\x20(US)'){var _0x84988b=users[_0x27c28e(0x1f1)];console[_0x27c28e(0x132)](_0x84988b);}else{if(_0x3d39f1[0x0][_0x27c28e(0x224)]==_0x27c28e(0x1b3))var _0x84988b=users['Hindi'];else{if(_0x3d39f1[0x0][_0x27c28e(0x224)]==_0x27c28e(0x14e))var _0x84988b=users[_0x27c28e(0x14e)];else{if(_0x3d39f1[0x0][_0x27c28e(0x224)]==_0x27c28e(0x1da))var _0x84988b=users['Spanish'];else{if(_0x3d39f1[0x0]['language']==_0x27c28e(0x153))var _0x84988b=users[_0x27c28e(0x153)];else{if(_0x3d39f1[0x0][_0x27c28e(0x224)]==_0x27c28e(0x10d))var _0x84988b=users['Portuguese'];else{if(_0x3d39f1[0x0]['language']==_0x27c28e(0x193))var _0x84988b=users[_0x27c28e(0x193)];else{if(_0x3d39f1[0x0][_0x27c28e(0x224)]==_0x27c28e(0x1bb))var _0x84988b=users[_0x27c28e(0x1ec)];}}}}}}}_0x511cba['render'](_0x27c28e(0x15e),{'success':_0x1c099c[_0x27c28e(0x15f)]('success'),'errors':_0x1c099c[_0x27c28e(0x15f)](_0x27c28e(0x1fb)),'sales':_0x2efb0f,'profile':_0x1c2c93,'role':_0x596dd0,'master_shop':_0x3d39f1,'language':_0x84988b});}catch(_0x329ea2){console[_0x27c28e(0x132)](_0x329ea2);}});async function getRandom8DigitNumber(){var _0x3bfe9d=a0_0x40efbc;const _0x215d5c=0x989680,_0x411ee9=0x5f5e0ff,_0x442126=Math[_0x3bfe9d(0x1ab)](Math[_0x3bfe9d(0x1b5)]()*(_0x411ee9-_0x215d5c+0x1))+_0x215d5c;var _0x247c3c;const _0x5c0fd6=await sales_finished[_0x3bfe9d(0x110)]({'invoice':_0x3bfe9d(0x167)+_0x442126});return _0x5c0fd6&&_0x5c0fd6[_0x3bfe9d(0x215)]>0x0?_0x247c3c=_0x3bfe9d(0x167)+_0x442126:_0x247c3c='OUTF-'+_0x442126,_0x247c3c;}router[a0_0x40efbc(0x24d)]('/view/add_sales',auth,async(_0x2482f2,_0x269211)=>{var _0x19721d=a0_0x40efbc;try{const {username:_0x310bc0,email:_0x424f84,role:_0x6439bf}=_0x2482f2[_0x19721d(0x17f)],_0x210b7c=_0x2482f2[_0x19721d(0x17f)],_0x33099c=await profile[_0x19721d(0x110)]({'email':_0x210b7c[_0x19721d(0x1c9)]}),_0x10cffc=await master_shop['find'](),_0x14be65=await customer[_0x19721d(0x171)]({});let _0x31fc9b;if(_0x210b7c[_0x19721d(0x189)]==_0x19721d(0x238)){const _0x528332=await staff[_0x19721d(0x110)]({'email':_0x210b7c['email']});_0x31fc9b=await warehouse[_0x19721d(0x1bd)]([{'$match':{'status':_0x19721d(0x24c),'name':_0x528332['warehouse']}},{'$group':{'_id':_0x19721d(0x1c7),'name':{'$first':_0x19721d(0x1c7)}}},{'$sort':{'name':0x1}}]);}else _0x31fc9b=await warehouse[_0x19721d(0x1bd)]([{'$match':{'status':_0x19721d(0x24c)}},{'$group':{'_id':_0x19721d(0x1c7),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x44f0bd=await product['find']({});var _0x546f23=[_0x19721d(0x131),_0x19721d(0x240)];const _0x24a9e9=await sales_finished[_0x19721d(0x171)]({}),_0x13a90e=_0x24a9e9[_0x19721d(0x215)]+0x1,_0x2685ba=_0x19721d(0x167)+_0x13a90e[_0x19721d(0x160)]()[_0x19721d(0x161)](0x5,'0');if(_0x10cffc[0x0]['language']==_0x19721d(0x1a5)){var _0x436437=users[_0x19721d(0x1f1)];console[_0x19721d(0x132)](_0x436437);}else{if(_0x10cffc[0x0][_0x19721d(0x224)]==_0x19721d(0x1b3))var _0x436437=users['Hindi'];else{if(_0x10cffc[0x0][_0x19721d(0x224)]==_0x19721d(0x14e))var _0x436437=users['German'];else{if(_0x10cffc[0x0][_0x19721d(0x224)]=='Spanish')var _0x436437=users[_0x19721d(0x1da)];else{if(_0x10cffc[0x0][_0x19721d(0x224)]==_0x19721d(0x153))var _0x436437=users['French'];else{if(_0x10cffc[0x0][_0x19721d(0x224)]==_0x19721d(0x10d))var _0x436437=users[_0x19721d(0x150)];else{if(_0x10cffc[0x0][_0x19721d(0x224)]==_0x19721d(0x193))var _0x436437=users[_0x19721d(0x193)];else{if(_0x10cffc[0x0]['language']==_0x19721d(0x1bb))var _0x436437=users[_0x19721d(0x1ec)];}}}}}}}const _0x2c2ec7=getRandom8DigitNumber();_0x2c2ec7[_0x19721d(0x1cb)](_0x3419fb=>{var _0x2bf949=_0x19721d;_0x269211[_0x2bf949(0x156)](_0x2bf949(0x13d),{'success':_0x2482f2['flash'](_0x2bf949(0x1b7)),'errors':_0x2482f2[_0x2bf949(0x15f)]('errors'),'role':_0x210b7c,'profile':_0x33099c,'customer':_0x14be65,'warehouse':_0x31fc9b,'product':_0x44f0bd,'invoice':_0x3419fb,'master_shop':_0x10cffc,'language':_0x436437,'rooms_data':_0x546f23});})[_0x19721d(0x14b)](_0x39bcb0=>{var _0x486452=_0x19721d;_0x2482f2[_0x486452(0x15f)](_0x486452(0x1fb),_0x486452(0x23f)),_0x269211['redirect']('/all_sales_finished/view');});}catch(_0x6acb09){console[_0x19721d(0x132)](_0x6acb09);}}),router['get'](a0_0x40efbc(0x239),auth,async(_0x131cf4,_0x218d74)=>{var _0x45878d=a0_0x40efbc;try{const {username:_0x1b4ebf,email:_0x510ab3,role:_0x1c74f4}=_0x131cf4[_0x45878d(0x17f)],_0x9e16da=_0x131cf4[_0x45878d(0x17f)],_0x1e235f=await profile['findOne']({'email':_0x9e16da[_0x45878d(0x1c9)]}),_0x512d6e=await master_shop[_0x45878d(0x171)](),_0x437bd8=await customer[_0x45878d(0x171)]({});let _0x228e0e;if(_0x9e16da[_0x45878d(0x189)]=='staff'){const _0x8ac327=await staff[_0x45878d(0x110)]({'email':_0x9e16da[_0x45878d(0x1c9)]});_0x228e0e=await warehouse[_0x45878d(0x1bd)]([{'$match':{'status':'Enabled','name':_0x8ac327[_0x45878d(0x157)]}},{'$group':{'_id':'$name','name':{'$first':_0x45878d(0x1c7)}}},{'$sort':{'name':0x1}}]);}else _0x228e0e=await warehouse[_0x45878d(0x1bd)]([{'$match':{'status':_0x45878d(0x24c)}},{'$group':{'_id':'$name','name':{'$first':_0x45878d(0x1c7)}}},{'$sort':{'name':0x1}}]);const _0x2ef4ff=await product[_0x45878d(0x171)]({});var _0x2398aa=[_0x45878d(0x131),'Enclosed'];const _0x13f34b=await sales_finished['find']({}),_0x1ed742=_0x13f34b[_0x45878d(0x215)]+0x1,_0x209a56='OUTF-'+_0x1ed742['toString']()[_0x45878d(0x161)](0x5,'0');if(_0x512d6e[0x0][_0x45878d(0x224)]==_0x45878d(0x1a5)){var _0x4dac90=users[_0x45878d(0x1f1)];console[_0x45878d(0x132)](_0x4dac90);}else{if(_0x512d6e[0x0][_0x45878d(0x224)]==_0x45878d(0x1b3))var _0x4dac90=users[_0x45878d(0x1b3)];else{if(_0x512d6e[0x0][_0x45878d(0x224)]==_0x45878d(0x14e))var _0x4dac90=users[_0x45878d(0x14e)];else{if(_0x512d6e[0x0][_0x45878d(0x224)]==_0x45878d(0x1da))var _0x4dac90=users[_0x45878d(0x1da)];else{if(_0x512d6e[0x0][_0x45878d(0x224)]=='French')var _0x4dac90=users[_0x45878d(0x153)];else{if(_0x512d6e[0x0]['language']==_0x45878d(0x10d))var _0x4dac90=users[_0x45878d(0x150)];else{if(_0x512d6e[0x0][_0x45878d(0x224)]=='Chinese')var _0x4dac90=users['Chinese'];else{if(_0x512d6e[0x0]['language']==_0x45878d(0x1bb))var _0x4dac90=users['Arabic'];}}}}}}}const _0x1b7fad=getRandom8DigitNumber();_0x1b7fad['then'](_0x455d7e=>{var _0x16b5eb=_0x45878d;_0x218d74[_0x16b5eb(0x156)](_0x16b5eb(0x11d),{'success':_0x131cf4['flash']('success'),'errors':_0x131cf4[_0x16b5eb(0x15f)](_0x16b5eb(0x1fb)),'role':_0x9e16da,'profile':_0x1e235f,'customer':_0x437bd8,'warehouse':_0x228e0e,'product':_0x2ef4ff,'invoice':_0x455d7e,'master_shop':_0x512d6e,'language':_0x4dac90,'rooms_data':_0x2398aa});})['catch'](_0x31bd6c=>{var _0x4113dc=_0x45878d;_0x131cf4[_0x4113dc(0x15f)]('errors',_0x4113dc(0x23f)),_0x218d74['redirect'](_0x4113dc(0x1f3));});}catch(_0x13db6d){console[_0x45878d(0x132)](_0x13db6d);}}),router['post'](a0_0x40efbc(0x239),auth,async(_0x475bf9,_0x2e5fd1)=>{var _0x46e3a7=a0_0x40efbc;try{const {invoice:_0x2e795d,date:_0x5a20e6,warehouse_name:_0x13259d,product_name:_0xcabafb,note:_0x39f157,room:_0x3d14f3,primary_code:_0x2fac4d,secondary_code:_0xd81ffb,prod_code:_0x5478ff,SCRN:_0x499101,ReqBy:_0x5bb970,dateofreq:_0x59f32a,PO_number:_0x4ff9c9,typeservicesData:_0x4a4d21,typevehicle:_0x20f0d0,destination:_0x51ef2a,deliverydate:_0x36af33,driver:_0x4d9132,plate:_0x6cac3d,van:_0x5ac059,DRSI:_0x31be53,TSU:_0x11d58c,TFU:_0x56a86e,mode_transpo:_0x59dcaa,name_driver:_0x2be035,type_of_products:_0xfd4b0a}=_0x475bf9['body'];if(typeof _0xcabafb==_0x46e3a7(0x12f))var _0x559118=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x113)]],_0x219f69=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x1b8)]],_0x17557c=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x1ea)]],_0x1cb457=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x18c)]],_0x4d24fc=[_0x475bf9['body'][_0x46e3a7(0x191)]],_0x4c8d24=[_0x475bf9['body'][_0x46e3a7(0x116)]],_0x458ad8=[_0x475bf9[_0x46e3a7(0x1bc)]['level2']],_0x4ea39c=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x121)]],_0xec8cdf=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x134)]],_0x3d1a9c=[_0x475bf9[_0x46e3a7(0x1bc)]['batch_code']],_0x2518a2=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x245)]],_0x5b7497=[_0x475bf9['body'][_0x46e3a7(0x227)]],_0x14bd30=[_0x475bf9['body'][_0x46e3a7(0x152)]],_0x17649c=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x1f9)]],_0x22e9b8=[_0x475bf9[_0x46e3a7(0x1bc)]['RoomAssigned']],_0x394701=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x19d)]],_0x91b9c3=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x1d3)]],_0x4fe7ec=[_0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x158)]],_0x57ee81=[_0x475bf9[_0x46e3a7(0x1bc)]['gross_price']];else var _0x559118=[..._0x475bf9[_0x46e3a7(0x1bc)]['product_name']],_0x219f69=[..._0x475bf9['body']['stock']],_0x17557c=[..._0x475bf9['body']['carton']],_0x1cb457=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x18c)]],_0x4d24fc=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x191)]],_0x4c8d24=[..._0x475bf9[_0x46e3a7(0x1bc)]['prod_code']],_0x458ad8=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x1f7)]],_0x4ea39c=[..._0x475bf9['body'][_0x46e3a7(0x121)]],_0xec8cdf=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x134)]],_0x3d1a9c=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x24e)]],_0x2518a2=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x245)]],_0x5b7497=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x227)]],_0x14bd30=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x152)]],_0x17649c=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x1f9)]],_0x22e9b8=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x1a4)]],_0x394701=[..._0x475bf9[_0x46e3a7(0x1bc)]['prod_invoice']],_0x91b9c3=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x1d3)]],_0x4fe7ec=[..._0x475bf9[_0x46e3a7(0x1bc)]['uuid']],_0x57ee81=[..._0x475bf9[_0x46e3a7(0x1bc)][_0x46e3a7(0x115)]];const _0x3ce640=_0x559118['map'](_0x289201=>{return _0x289201={'product_name':_0x289201};});_0x219f69[_0x46e3a7(0x1cf)]((_0x294cf9,_0x1f0340)=>{var _0x2364ed=_0x46e3a7;_0x3ce640[_0x1f0340][_0x2364ed(0x1b8)]=_0x294cf9;}),_0x17557c[_0x46e3a7(0x1cf)]((_0xb544f5,_0x2fcf98)=>{var _0x91ab0=_0x46e3a7;_0x3ce640[_0x2fcf98][_0x91ab0(0x1d9)]=Math['abs'](_0xb544f5);}),_0x559118[_0x46e3a7(0x1cf)]((_0x44a36a,_0x139f1e)=>{var _0x48eae5=_0x46e3a7;_0x3ce640[_0x139f1e]['agent_id']=_0x475bf9['body'][_0x48eae5(0x233)];}),_0x57ee81['forEach']((_0x4a2db9,_0x564fc5)=>{_0x3ce640[_0x564fc5]['gross_price']=_0x4a2db9;}),_0x4fe7ec[_0x46e3a7(0x1cf)]((_0x314fb4,_0x403fe7)=>{var _0x1d710c=_0x46e3a7;_0x3ce640[_0x403fe7][_0x1d710c(0x158)]=_0x314fb4;}),_0x91b9c3[_0x46e3a7(0x1cf)]((_0x4ec1e3,_0x12beb9)=>{var _0x4694c2=_0x46e3a7;_0x3ce640[_0x12beb9][_0x4694c2(0x1d3)]=_0x4ec1e3;}),_0x1cb457['forEach']((_0x405720,_0xa3037e)=>{var _0x29431a=_0x46e3a7;_0x3ce640[_0xa3037e][_0x29431a(0x18c)]=_0x405720;}),_0x4d24fc[_0x46e3a7(0x1cf)]((_0x3f67e9,_0xa91666)=>{var _0x7e753c=_0x46e3a7;_0x3ce640[_0xa91666][_0x7e753c(0x191)]=_0x3f67e9;}),_0x4c8d24[_0x46e3a7(0x1cf)]((_0x1a3f70,_0x1e9e94)=>{var _0x57e90d=_0x46e3a7;_0x3ce640[_0x1e9e94][_0x57e90d(0x217)]=_0x1a3f70;}),_0x458ad8[_0x46e3a7(0x1cf)]((_0x39b882,_0x36270e)=>{var _0x5322ad=_0x46e3a7,_0x47e3f6=_0x39b882[_0x5322ad(0x1f6)](/[A-Za-z]+/)[0x0],_0xcf38b3=parseInt(_0x39b882[_0x5322ad(0x1f6)](/\d+/)[0x0]);_0x3ce640[_0x36270e]['bay']=_0xcf38b3,_0x3ce640[_0x36270e][_0x5322ad(0x23c)]=_0x47e3f6;}),_0x4ea39c['forEach']((_0x215d53,_0xa305fa)=>{var _0x5ac4d5=_0x46e3a7;_0x3ce640[_0xa305fa][_0x5ac4d5(0x11e)]=_0x215d53;}),_0xec8cdf['forEach']((_0x566ec3,_0x2c4ed0)=>{_0x3ce640[_0x2c4ed0]['secondary_unit']=_0x566ec3;}),_0x3d1a9c[_0x46e3a7(0x1cf)]((_0x31bb51,_0x14cd6b)=>{var _0x397fb1=_0x46e3a7;_0x3ce640[_0x14cd6b][_0x397fb1(0x24e)]=_0x31bb51;}),_0x2518a2[_0x46e3a7(0x1cf)]((_0x53676b,_0xe2bbe0)=>{_0x3ce640[_0xe2bbe0]['expiry_date']=_0x53676b;}),_0x5b7497[_0x46e3a7(0x1cf)]((_0x2ddbb1,_0x3d79b4)=>{_0x3ce640[_0x3d79b4]['production_date']=_0x2ddbb1;}),_0x14bd30['forEach']((_0xa4dede,_0x5331b4)=>{_0x3ce640[_0x5331b4]['maxperunit']=_0xa4dede;}),_0x17649c['forEach']((_0x34d30b,_0xd741b0)=>{_0x3ce640[_0xd741b0]['prod_cat']=_0x34d30b;}),_0x22e9b8[_0x46e3a7(0x1cf)]((_0x383248,_0x1e7cb3)=>{var _0x327dbd=_0x46e3a7;_0x3ce640[_0x1e7cb3][_0x327dbd(0x1c4)]=_0x383248;}),_0x394701[_0x46e3a7(0x1cf)]((_0x592e24,_0x2c0e49)=>{var _0x165613=_0x46e3a7;_0x3ce640[_0x2c0e49][_0x165613(0x1c5)]=_0x592e24,_0x3ce640[_0x2c0e49][_0x165613(0x128)]=_0x5a20e6;});const _0x311a8c=new sales_logs();await _0x311a8c[_0x46e3a7(0x230)](),_0x394701[_0x46e3a7(0x1cf)]((_0x195a0a,_0x2864e6)=>{var _0x4439bd=_0x46e3a7;_0x3ce640[_0x2864e6][_0x4439bd(0x225)]=_0x4439bd(0x12d)+_0x311a8c['invoice_init']['toString']()[_0x4439bd(0x161)](0x8,'0');});var _0x53fda5=0x0;_0x3ce640[_0x46e3a7(0x1cf)](_0x36b8d4=>{var _0x53fcbb=_0x46e3a7;parseFloat(_0x36b8d4[_0x53fcbb(0x1b8)])<parseFloat(_0x36b8d4[_0x53fcbb(0x1d9)])&&parseFloat(_0x36b8d4[_0x53fcbb(0x1d9)])>parseFloat(_0x36b8d4['stock'])&&(console[_0x53fcbb(0x132)](_0x36b8d4['stock']+_0x53fcbb(0x195)+_0x36b8d4[_0x53fcbb(0x1d9)]),_0x53fda5++);});if(_0x53fda5!=0x0)return _0x475bf9[_0x46e3a7(0x15f)](_0x46e3a7(0x1fb),_0x46e3a7(0x18b)),_0x2e5fd1['redirect'](_0x46e3a7(0x11a));const _0x3d4193=_0x3ce640['filter'](_0x9fb411=>_0x9fb411[_0x46e3a7(0x1d9)]!=='0'&&_0x9fb411[_0x46e3a7(0x1d9)]!==''),_0x32db6f=new sales_finished({'invoice':_0x46e3a7(0x12d)+_0x311a8c[_0x46e3a7(0x175)][_0x46e3a7(0x160)]()[_0x46e3a7(0x161)](0x8,'0'),'sales_data':_0x475bf9['body'][_0x46e3a7(0x233)],'customer':_0x475bf9[_0x46e3a7(0x1bc)]['customer'],'date':_0x5a20e6,'warehouse_name':_0x13259d,'sale_product':_0x3d4193,'note':_0x39f157,'room':_0x3d14f3,'primary_code':_0x2fac4d,'secondary_code':_0xd81ffb,'prod_code':_0x5478ff,'SCRN':_0x499101,'finalize':'False','mode_transpo':_0x59dcaa,'name_driver':_0x2be035,'ReqBy':_0x5bb970,'dateofreq':_0x59f32a,'PO_number':_0x4ff9c9,'typeservicesData':_0x4a4d21,'typevehicle':_0x20f0d0,'destination':_0x51ef2a,'deliverydate':_0x36af33,'driver':_0x4d9132,'plate':_0x6cac3d,'van':_0x5ac059,'DRSI':_0x31be53,'TSU':_0x11d58c,'TFU':_0x56a86e,'typeOfProducts':_0xfd4b0a}),_0x57c573=await _0x32db6f[_0x46e3a7(0x230)](),_0x491380=await sales_finished[_0x46e3a7(0x110)]({'invoice':_0x2e795d});_0x475bf9['flash'](_0x46e3a7(0x1b7),_0x46e3a7(0x17d)),_0x2e5fd1[_0x46e3a7(0x1ae)](_0x46e3a7(0x252)+_0x57c573['_id']);}catch(_0x2d4059){console[_0x46e3a7(0x132)](_0x2d4059);}}),router[a0_0x40efbc(0x24d)](a0_0x40efbc(0x13f),auth,async(_0x10898b,_0x2364a6)=>{var _0x54a597=a0_0x40efbc;try{const _0x1e4a52=_0x10898b[_0x54a597(0x112)]['id'];console['log'](_0x1e4a52);const _0x1e9dce=await product[_0x54a597(0x171)](),_0x5ea948=await purchases[_0x54a597(0x1bd)]([{'$match':{'warehouse_name':_0x1e4a52}},{'$unwind':_0x54a597(0x21c)},{'$group':{'_id':_0x54a597(0x244)}}]);console[_0x54a597(0x132)](_0x54a597(0x1b2),_0x5ea948),_0x2364a6[_0x54a597(0x1a7)](0xc8)[_0x54a597(0x1de)]({'purchases_data':_0x5ea948,'product_data':_0x1e9dce});}catch(_0x316d24){console[_0x54a597(0x132)](_0x316d24);}}),router['post'](a0_0x40efbc(0x1d8),auth,async(_0x54c996,_0x53d9f0)=>{var _0x1ce755=a0_0x40efbc;try{const {warehouse_data:_0x13dae6,product_data:_0xb26475}=_0x54c996[_0x1ce755(0x1bc)];console[_0x1ce755(0x132)](_0x54c996[_0x1ce755(0x1bc)][_0x1ce755(0x249)]);;const _0x455d3f=await master_shop[_0x1ce755(0x171)]();console[_0x1ce755(0x132)](_0x1ce755(0x177),_0x455d3f);const _0x4268be=await product[_0x1ce755(0x110)]({'name':_0xb26475});console['log'](_0x1ce755(0x250),_0x4268be);const _0xcb8138=await warehouse[_0x1ce755(0x1bd)]([{'$match':{'name':_0x13dae6}},{'$unwind':_0x1ce755(0x182)},{'$match':{'product_details.product_name':_0xb26475}},{'$group':{'_id':_0x1ce755(0x21f),'product_stock':{'$first':_0x1ce755(0x16e)}}}]);console[_0x1ce755(0x132)](_0x1ce755(0x12b),_0xcb8138),_0x53d9f0[_0x1ce755(0x1a7)](0xc8)[_0x1ce755(0x1de)]({'master':_0x455d3f,'new_product':_0x4268be,'stock_data':_0xcb8138});}catch(_0x4f67d3){console['log'](_0x4f67d3);}}),router[a0_0x40efbc(0x1d5)](a0_0x40efbc(0x23e),auth,async(_0xa53200,_0x44206c)=>{var _0xf577e=a0_0x40efbc;try{const {invoice:_0x25f27f,date:_0x1eba86,warehouse_name:_0x158e86,product_name:_0x32fe44,note:_0x23db78,room:_0x2111ae,primary_code:_0x1c2f0f,secondary_code:_0x4ab2fd,prod_code:_0x5b1453,SCRN:_0xc4fd9,ReqBy:_0x5e6ae1,dateofreq:_0x53304c,PO_number:_0x214fbd,typeservicesData:_0xec8836,typevehicle:_0x557b52,destination:_0x433908,deliverydate:_0xa04f0a,driver:_0x2589ce,plate:_0x233caf,van:_0x25dfc5,DRSI:_0x145dee,TSU:_0x4f83d2,TFU:_0x2ba23b,mode_transpo:_0x256f16,name_driver:_0x80187b,pull_out_date:_0x175113,actual_delivery_date:_0x178f02}=_0xa53200['body'];_0x44206c[_0xf577e(0x1de)](_0xa53200['body']);return;if(typeof _0x32fe44=='string')var _0x4346f7=[_0xa53200['body'][_0xf577e(0x113)]],_0x327786=[_0xa53200[_0xf577e(0x1bc)]['stock']],_0x4b7a96=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x1ea)]],_0xdbf10a=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x18c)]],_0x59ad55=[_0xa53200[_0xf577e(0x1bc)]['secondary_code']],_0x455419=[_0xa53200['body'][_0xf577e(0x116)]],_0x487220=[_0xa53200['body'][_0xf577e(0x1f7)]],_0x5400fd=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x121)]],_0x4f723c=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x134)]],_0x49805f=[_0xa53200[_0xf577e(0x1bc)]['batch_code']],_0x277b4e=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x245)]],_0x4f2f35=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x227)]],_0x4c9a3a=[_0xa53200['body']['max_per_unit']],_0xbc8c9=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x1f9)]],_0x2075b4=[_0xa53200[_0xf577e(0x1bc)]['RoomAssigned']],_0x64a096=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x19d)]],_0x44e6d3=[_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x1d3)]],_0x1f2197=[_0xa53200[_0xf577e(0x1bc)]['uuid']],_0x4ff062=[_0xa53200[_0xf577e(0x1bc)]['gross_price']];else var _0x4346f7=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x113)]],_0x327786=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x1b8)]],_0x4b7a96=[..._0xa53200['body'][_0xf577e(0x1ea)]],_0xdbf10a=[..._0xa53200['body'][_0xf577e(0x18c)]],_0x59ad55=[..._0xa53200[_0xf577e(0x1bc)]['secondary_code']],_0x455419=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x116)]],_0x487220=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x1f7)]],_0x5400fd=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x121)]],_0x4f723c=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x134)]],_0x49805f=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x24e)]],_0x277b4e=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x245)]],_0x4f2f35=[..._0xa53200[_0xf577e(0x1bc)]['product_date']],_0x4c9a3a=[..._0xa53200[_0xf577e(0x1bc)]['max_per_unit']],_0xbc8c9=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x1f9)]],_0x2075b4=[..._0xa53200[_0xf577e(0x1bc)]['RoomAssigned']],_0x64a096=[..._0xa53200[_0xf577e(0x1bc)]['prod_invoice']],_0x44e6d3=[..._0xa53200[_0xf577e(0x1bc)][_0xf577e(0x1d3)]],_0x1f2197=[..._0xa53200[_0xf577e(0x1bc)]['uuid']],_0x4ff062=[..._0xa53200['body'][_0xf577e(0x115)]];const _0x479287=_0x4346f7['map'](_0x2893ad=>{return _0x2893ad={'product_name':_0x2893ad};});_0x327786['forEach']((_0x13beb5,_0x2d4460)=>{var _0xb5f087=_0xf577e;_0x479287[_0x2d4460][_0xb5f087(0x1b8)]=_0x13beb5;}),_0x4b7a96[_0xf577e(0x1cf)]((_0x8fe9cd,_0x326576)=>{var _0x22a80e=_0xf577e;_0x479287[_0x326576][_0x22a80e(0x1d9)]=Math[_0x22a80e(0x1d0)](_0x8fe9cd);}),_0x4346f7[_0xf577e(0x1cf)]((_0x5a3e92,_0x1963b3)=>{var _0x3391f4=_0xf577e;_0x479287[_0x1963b3]['agent_id']=_0xa53200[_0x3391f4(0x1bc)][_0x3391f4(0x233)];}),_0x4ff062[_0xf577e(0x1cf)]((_0x44a144,_0x1d17aa)=>{var _0x1b89f6=_0xf577e;_0x479287[_0x1d17aa][_0x1b89f6(0x115)]=_0x44a144;}),_0x1f2197[_0xf577e(0x1cf)]((_0x443afe,_0x4408cb)=>{_0x479287[_0x4408cb]['uuid']=_0x443afe;}),_0x44e6d3[_0xf577e(0x1cf)]((_0x38af47,_0x17bd98)=>{_0x479287[_0x17bd98]['id_transaction_from']=_0x38af47;}),_0xdbf10a[_0xf577e(0x1cf)]((_0xe99f93,_0x164d65)=>{var _0x3ec47d=_0xf577e;_0x479287[_0x164d65][_0x3ec47d(0x18c)]=_0xe99f93;}),_0x59ad55[_0xf577e(0x1cf)]((_0x520cdb,_0x3fd6d8)=>{var _0x5b1b8b=_0xf577e;_0x479287[_0x3fd6d8][_0x5b1b8b(0x191)]=_0x520cdb;}),_0x455419['forEach']((_0x52ea43,_0x59b30c)=>{var _0x1ef291=_0xf577e;_0x479287[_0x59b30c][_0x1ef291(0x217)]=_0x52ea43;}),_0x487220[_0xf577e(0x1cf)]((_0x365b6f,_0x5f1c1f)=>{var _0x17e83b=_0xf577e,_0x3d0cf4=_0x365b6f['match'](/[A-Za-z]+/)[0x0],_0x4a9a8d=parseInt(_0x365b6f[_0x17e83b(0x1f6)](/\d+/)[0x0]);_0x479287[_0x5f1c1f][_0x17e83b(0x166)]=_0x4a9a8d,_0x479287[_0x5f1c1f]['level']=_0x3d0cf4;}),_0x5400fd[_0xf577e(0x1cf)]((_0xd53d9e,_0xc40a52)=>{var _0x2b8bc8=_0xf577e;_0x479287[_0xc40a52][_0x2b8bc8(0x11e)]=_0xd53d9e;}),_0x4f723c[_0xf577e(0x1cf)]((_0x494985,_0x911b33)=>{var _0x41b445=_0xf577e;_0x479287[_0x911b33][_0x41b445(0x134)]=_0x494985;}),_0x49805f[_0xf577e(0x1cf)]((_0x5ba39c,_0x39e1b4)=>{var _0x5eae77=_0xf577e;_0x479287[_0x39e1b4][_0x5eae77(0x24e)]=_0x5ba39c;}),_0x277b4e[_0xf577e(0x1cf)]((_0x4cda5c,_0x4cb246)=>{var _0x36c0fa=_0xf577e;_0x479287[_0x4cb246][_0x36c0fa(0x245)]=_0x4cda5c;}),_0x4f2f35[_0xf577e(0x1cf)]((_0x3f549f,_0x9ca05e)=>{_0x479287[_0x9ca05e]['production_date']=_0x3f549f;}),_0x4c9a3a[_0xf577e(0x1cf)]((_0x3a8f56,_0x5bd23e)=>{var _0x2b5d4d=_0xf577e;_0x479287[_0x5bd23e][_0x2b5d4d(0x202)]=_0x3a8f56;}),_0xbc8c9[_0xf577e(0x1cf)]((_0x553503,_0x3b9cdd)=>{var _0xd8c0d8=_0xf577e;_0x479287[_0x3b9cdd][_0xd8c0d8(0x1f9)]=_0x553503;}),_0x2075b4[_0xf577e(0x1cf)]((_0x1a1807,_0x15d696)=>{var _0x49b507=_0xf577e;_0x479287[_0x15d696][_0x49b507(0x1c4)]=_0x1a1807;}),_0x64a096[_0xf577e(0x1cf)]((_0x2150c1,_0x12f03b)=>{var _0x3fb8ec=_0xf577e;_0x479287[_0x12f03b]['invoice']=_0x2150c1,_0x479287[_0x12f03b][_0x3fb8ec(0x128)]=_0x1eba86;});const _0x2127cd=new invoice_for_outgoing();await _0x2127cd['save'](),_0x64a096[_0xf577e(0x1cf)]((_0x485596,_0x35ce68)=>{var _0x4b4dd2=_0xf577e;_0x479287[_0x35ce68][_0x4b4dd2(0x225)]='OUT-'+_0x2127cd['invoice_init'][_0x4b4dd2(0x160)]()[_0x4b4dd2(0x161)](0x8,'0');});var _0x45bf82=0x0;_0x479287['forEach'](_0xb3bd2f=>{var _0x1fe452=_0xf577e;parseFloat(_0xb3bd2f[_0x1fe452(0x1b8)])<parseFloat(_0xb3bd2f[_0x1fe452(0x1d9)])&&parseFloat(_0xb3bd2f['quantity'])>parseFloat(_0xb3bd2f[_0x1fe452(0x1b8)])&&(console[_0x1fe452(0x132)](_0xb3bd2f[_0x1fe452(0x1b8)]+'\x20<>\x20'+_0xb3bd2f[_0x1fe452(0x1d9)]),_0x45bf82++);});if(_0x45bf82!=0x0)return _0xa53200[_0xf577e(0x15f)](_0xf577e(0x1fb),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x44206c[_0xf577e(0x1ae)](_0xf577e(0x11a));const _0x1274a1=_0x479287[_0xf577e(0x1dd)](_0x15ac3f=>_0x15ac3f[_0xf577e(0x1d9)]!=='0'&&_0x15ac3f[_0xf577e(0x1d9)]!==''),_0x3c06d4=new sales_finished({'invoice':'OUT-'+_0x2127cd[_0xf577e(0x175)][_0xf577e(0x160)]()[_0xf577e(0x161)](0x8,'0'),'sales_data':_0xa53200['body'][_0xf577e(0x233)],'customer':_0xa53200[_0xf577e(0x1bc)][_0xf577e(0x18f)],'date':_0x1eba86,'warehouse_name':_0x158e86,'sale_product':_0x1274a1,'note':_0x23db78,'room':_0x2111ae,'primary_code':_0x1c2f0f,'secondary_code':_0x4ab2fd,'prod_code':_0x5b1453,'SCRN':_0xc4fd9,'finalize':'False','mode_transpo':_0x256f16,'name_driver':_0x80187b,'ReqBy':_0x5e6ae1,'dateofreq':_0x53304c,'PO_number':_0x214fbd,'typeservicesData':_0xec8836,'typevehicle':_0x557b52,'destination':_0x433908,'deliverydate':_0xa04f0a,'driver':_0x2589ce,'plate':_0x233caf,'van':_0x25dfc5,'DRSI':_0x145dee,'TSU':_0x4f83d2,'TFU':_0x2ba23b,'pullout_date':_0x175113,'actualdelivery_date':_0x178f02,'typeOfProducts':_0xf577e(0x15b)}),_0x1405fe=await _0x3c06d4['save'](),_0x2538f2=await sales_finished[_0xf577e(0x110)]({'invoice':_0x25f27f});_0xa53200['flash'](_0xf577e(0x1b7),'Sales\x20Add\x20successfully'),_0x44206c[_0xf577e(0x1ae)](_0xf577e(0x252)+_0x1405fe[_0xf577e(0x1e0)]);}catch(_0x41aaac){console[_0xf577e(0x132)](_0x41aaac);}}),router[a0_0x40efbc(0x24d)](a0_0x40efbc(0x21d),auth,async(_0x275a4d,_0x568b38)=>{var _0x43230d=a0_0x40efbc;try{const {username:_0x47ca11,email:_0x55cdab,role:_0x48e69f}=_0x275a4d[_0x43230d(0x17f)],_0x1ca04b=_0x275a4d['user'],_0x36bb05=await profile[_0x43230d(0x110)]({'email':_0x1ca04b[_0x43230d(0x1c9)]}),_0xf90442=await master_shop['find'](),_0x45fba6=_0x275a4d[_0x43230d(0x112)]['id'],_0x447e38=await sales_finished[_0x43230d(0x144)](_0x45fba6),_0x105667=await warehouse[_0x43230d(0x1bd)]([{'$match':{'name':_0x447e38[_0x43230d(0x1e8)]}},{'$unwind':_0x43230d(0x182)},{'$group':{'_id':_0x43230d(0x1d4),'name':{'$first':_0x43230d(0x21f)},'product_stock':{'$first':_0x43230d(0x16e)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x43230d(0x20f)},'type':{'$first':_0x43230d(0x129)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x43230d(0x259)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x43230d(0x118)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x43230d(0x255)},'production_date':{'$first':_0x43230d(0x12e)},'batch_code':{'$first':_0x43230d(0x1eb)},'room':{'$first':_0x43230d(0x13c)},'room_data':{'$first':'$product_details.room_name'}}}]),_0x114f26=await customer[_0x43230d(0x171)]({});let _0x212d3d;if(_0x1ca04b[_0x43230d(0x189)]==_0x43230d(0x238)){const _0x37d7d1=await staff[_0x43230d(0x110)]({'email':_0x1ca04b[_0x43230d(0x1c9)]});_0x212d3d=await warehouse[_0x43230d(0x1bd)]([{'$match':{'status':_0x43230d(0x24c),'name':_0x37d7d1['warehouse']}},{'$group':{'_id':_0x43230d(0x1c7),'name':{'$first':'$name'}}}]);}else _0x212d3d=await warehouse[_0x43230d(0x1bd)]([{'$match':{'status':_0x43230d(0x24c)}},{'$group':{'_id':_0x43230d(0x1c7),'name':{'$first':_0x43230d(0x1c7)}}}]);const _0x2f2883=await product[_0x43230d(0x171)]({});if(_0xf90442[0x0][_0x43230d(0x224)]==_0x43230d(0x1a5)){var _0x415d5a=users[_0x43230d(0x1f1)];console['log'](_0x415d5a);}else{if(_0xf90442[0x0][_0x43230d(0x224)]==_0x43230d(0x1b3))var _0x415d5a=users[_0x43230d(0x1b3)];else{if(_0xf90442[0x0]['language']==_0x43230d(0x14e))var _0x415d5a=users[_0x43230d(0x14e)];else{if(_0xf90442[0x0][_0x43230d(0x224)]=='Spanish')var _0x415d5a=users['Spanish'];else{if(_0xf90442[0x0]['language']=='French')var _0x415d5a=users[_0x43230d(0x153)];else{if(_0xf90442[0x0][_0x43230d(0x224)]=='Portuguese\x20(BR)')var _0x415d5a=users[_0x43230d(0x150)];else{if(_0xf90442[0x0]['language']=='Chinese')var _0x415d5a=users[_0x43230d(0x193)];else{if(_0xf90442[0x0][_0x43230d(0x224)]==_0x43230d(0x1bb))var _0x415d5a=users[_0x43230d(0x1ec)];}}}}}}}_0x568b38[_0x43230d(0x156)](_0x43230d(0x1e7),{'success':_0x275a4d[_0x43230d(0x15f)]('success'),'errors':_0x275a4d['flash'](_0x43230d(0x1fb)),'role':_0x1ca04b,'profile':_0x36bb05,'customer':_0x114f26,'warehouse':_0x212d3d,'product':_0x105667,'user':_0x447e38,'master_shop':_0xf90442,'unit':_0x2f2883,'language':_0x415d5a});}catch(_0x578d10){console[_0x43230d(0x132)](_0x578d10);}});async function dataUpdate(_0x5c5875,_0xc3313a,_0x1ca177){var _0x29c720=a0_0x40efbc;return await warehouse[_0x29c720(0x186)]({'_id':_0x5c5875,'product_details._id':_0xc3313a},{'$set':{'product_details.$.product_stock':_0x1ca177}}),await warehouse['findById'](_0x5c5875);}router['post'](a0_0x40efbc(0x21d),auth,async(_0x1cde80,_0x1227fb)=>{var _0x15e45e=a0_0x40efbc;try{const _0x5cd769=_0x1cde80[_0x15e45e(0x112)]['id'],{invoice:_0x3398ad,warehouse_name:_0x3915a8,room:_0x442960}=_0x1cde80[_0x15e45e(0x1bc)],_0x4e8467=await sales_finished['findOne']({'invoice':_0x3398ad});for(let _0x1df4bd=0x0;_0x1df4bd<=_0x4e8467[_0x15e45e(0x18d)][_0x15e45e(0x215)]-0x1;_0x1df4bd++){const _0x1a68eb=_0x4e8467[_0x15e45e(0x18d)][_0x1df4bd];var _0x255097=await warehouse[_0x15e45e(0x110)]({'name':_0x3915a8,'room':_0x1a68eb[_0x15e45e(0x1c4)]}),_0x1b623d=0x0;for(let _0x2a0bf0=0x0;_0x2a0bf0<=_0x255097[_0x15e45e(0x119)][_0x15e45e(0x215)]-0x1;_0x2a0bf0++){const _0x515379=_0x255097[_0x15e45e(0x119)][_0x2a0bf0];_0x515379[_0x15e45e(0x1e0)]==_0x1a68eb[_0x15e45e(0x1d3)]&&_0x515379[_0x15e45e(0x158)]==_0x1a68eb[_0x15e45e(0x158)]&&(_0x1b623d=Math['max'](0x0,Math[_0x15e45e(0x1d0)](_0x515379['product_stock'])-Math[_0x15e45e(0x1d0)](_0x1a68eb[_0x15e45e(0x1d9)])),await warehouse[_0x15e45e(0x186)]({'_id':_0x255097[_0x15e45e(0x1e0)]['valueOf'](),'product_details._id':_0x515379['_id'][_0x15e45e(0x114)](),'product_details.uuid':_0x1a68eb[_0x15e45e(0x158)]},{'$set':{'product_details.$.product_stock':_0x1b623d}}));}console[_0x15e45e(0x132)](typeof _0x1a68eb[_0x15e45e(0x206)]);if(typeof _0x1a68eb[_0x15e45e(0x206)]!=='undefined'){var _0x16cb24=await staff[_0x15e45e(0x144)](_0x1a68eb[_0x15e45e(0x206)]);console[_0x15e45e(0x132)](_0x15e45e(0x1a2));var _0x563742=0x0;for(let _0x1f1874=0x0;_0x1f1874<=_0x16cb24[_0x15e45e(0x1b1)]['length']-0x1;_0x1f1874++){const _0x25b28b=_0x16cb24[_0x15e45e(0x1b1)][_0x1f1874];console[_0x15e45e(0x132)](_0x1a68eb['id_transaction_from']+'\x20==\x20'+_0x25b28b[_0x15e45e(0x148)]+'\x20&&\x20'+_0x1a68eb[_0x15e45e(0x1e0)]+_0x15e45e(0x16f)+_0x1a68eb[_0x15e45e(0x1e0)]),_0x1a68eb[_0x15e45e(0x1d3)]==_0x25b28b['warehouse_id']&&_0x1a68eb[_0x15e45e(0x1e0)]==0x1&&(_0x25b28b[_0x15e45e(0x15c)]=Math[_0x15e45e(0x1d0)](_0x25b28b['product_stock'])+Math[_0x15e45e(0x1d0)](_0x1a68eb['quantity']),_0x563742++);}console[_0x15e45e(0x132)]('int',_0x563742),_0x563742=='0'&&(_0x16cb24[_0x15e45e(0x1b1)]=_0x16cb24['product_list'][_0x15e45e(0x1cd)]({'product_name':_0x1a68eb[_0x15e45e(0x113)],'product_stock':_0x1a68eb[_0x15e45e(0x1d9)],'bay':_0x1a68eb[_0x15e45e(0x166)],'level':_0x1a68eb[_0x15e45e(0x23c)],'product_code':_0x1a68eb[_0x15e45e(0x217)],'primary_code':_0x1a68eb['primary_code'],'secondary_code':_0x1a68eb[_0x15e45e(0x191)],'expiry_date':_0x1a68eb['expiry_date'],'production_date':_0x1a68eb[_0x15e45e(0x120)],'maxProducts':_0x1a68eb[_0x15e45e(0x258)],'batch_code':_0x1a68eb[_0x15e45e(0x24e)],'secondary_unit':_0x1a68eb['secondary_unit'],'unit':_0x1a68eb[_0x15e45e(0x11e)],'maxProducts':_0x1a68eb['maxProducts'],'maxPerUnit':_0x1a68eb[_0x15e45e(0x202)],'invoice':_0x1a68eb[_0x15e45e(0x1c5)],'warehouse_id':_0x1a68eb[_0x15e45e(0x1d3)],'id_incoming':_0x1a68eb[_0x15e45e(0x1e0)],'uuid':_0x1a68eb['uuid'],'gross_price':_0x1a68eb['gross_price'],'date_incoming':_0x1a68eb[_0x15e45e(0x128)],'outgoing_invoice':_0x1a68eb['outgoing_invoice']}),await _0x16cb24['save']());}}_0x4e8467[_0x15e45e(0x124)]=_0x15e45e(0x1e3);const _0x4a6553=await _0x4e8467[_0x15e45e(0x230)](),_0xbd5e00=await master_shop[_0x15e45e(0x171)](),_0x484626=await email_settings[_0x15e45e(0x110)](),_0x2c2374=await supervisor_settings[_0x15e45e(0x171)]();var _0x467dd2=_0x4e8467[_0x15e45e(0x18d)],_0x3c1bfe='',_0x34db10;for(_0x34db10 in _0x467dd2){_0x3c1bfe+='<tr>'+_0x15e45e(0x243)+_0x467dd2[_0x34db10][_0x15e45e(0x113)]+_0x15e45e(0x151)+_0x15e45e(0x243)+_0x467dd2[_0x34db10][_0x15e45e(0x217)]+_0x15e45e(0x151)+_0x15e45e(0x243)+_0x467dd2[_0x34db10][_0x15e45e(0x1d9)]+_0x15e45e(0x151)+_0x15e45e(0x243)+_0x467dd2[_0x34db10][_0x15e45e(0x11e)]+_0x15e45e(0x151)+_0x15e45e(0x243)+_0x467dd2[_0x34db10]['secondary_unit']+_0x15e45e(0x151)+_0x15e45e(0x243)+_0x4e8467[_0x15e45e(0x1e8)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x467dd2[_0x34db10][_0x15e45e(0x1c4)]+'</td>'+_0x15e45e(0x243)+_0x467dd2[_0x34db10][_0x15e45e(0x166)]+'</td>';}_0x1cde80[_0x15e45e(0x15f)](_0x15e45e(0x1b7),_0x15e45e(0x146)),_0x1227fb['redirect']('/picking_list/pdf/'+_0x5cd769);}catch(_0x5e731){console[_0x15e45e(0x132)](_0x5e731);}}),router[a0_0x40efbc(0x24d)]('/view/:id',auth,async(_0xbdd958,_0x29ac89)=>{var _0x5462c8=a0_0x40efbc;try{const {username:_0x1695ae,email:_0x41252c,role:_0x557f17}=_0xbdd958[_0x5462c8(0x17f)],_0x23864d=_0xbdd958[_0x5462c8(0x17f)],_0x4977bb=await profile[_0x5462c8(0x110)]({'email':_0x23864d['email']}),_0x350275=await master_shop[_0x5462c8(0x171)](),_0x396845=_0xbdd958[_0x5462c8(0x112)]['id'],_0x5e6c90=await sales_finished[_0x5462c8(0x144)](_0x396845);let _0xf610c0=new Date(_0x5e6c90[_0x5462c8(0x245)]),_0x238c60=('0'+_0xf610c0[_0x5462c8(0x219)]())[_0x5462c8(0x1e1)](-0x2),_0x11bd1c=('0'+(_0xf610c0[_0x5462c8(0x168)]()+0x1))['slice'](-0x2),_0x3f6c7c=_0xf610c0['getFullYear'](),_0x12025b=_0x3f6c7c+'-'+_0x11bd1c+'-'+_0x238c60;var _0x496168=[_0x5462c8(0x131),_0x5462c8(0x240)];const _0x45ac76=await warehouse['aggregate']([{'$match':{'name':_0x5e6c90[_0x5462c8(0x1e8)],'room':_0x5e6c90['room']}},{'$unwind':_0x5462c8(0x182)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5462c8(0x21f)},'product_stock':{'$first':_0x5462c8(0x16e)},'bay':{'$first':_0x5462c8(0x1e9)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5462c8(0x129)},'floorlevel':{'$first':_0x5462c8(0x1d2)},'primary_code':{'$first':_0x5462c8(0x123)},'secondary_code':{'$first':_0x5462c8(0x259)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5462c8(0x118)},'rack':{'$first':_0x5462c8(0x205)}}}]),_0x27d4bd=await customer['find']({});let _0x11324e;if(_0x23864d[_0x5462c8(0x189)]=='staff'){const _0x3572f3=await staff[_0x5462c8(0x110)]({'email':_0x23864d[_0x5462c8(0x1c9)]});_0x11324e=await warehouse[_0x5462c8(0x1bd)]([{'$match':{'status':_0x5462c8(0x24c),'name':_0x3572f3[_0x5462c8(0x157)]}},{'$group':{'_id':_0x5462c8(0x1c7),'name':{'$first':_0x5462c8(0x1c7)}}}]);}else _0x11324e=await warehouse[_0x5462c8(0x1bd)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x5462c8(0x1c7),'name':{'$first':_0x5462c8(0x1c7)}}}]);const _0xbab4d5=await product['find']({});if(_0x350275[0x0][_0x5462c8(0x224)]==_0x5462c8(0x1a5)){var _0x553f7a=users['English'];console['log'](_0x553f7a);}else{if(_0x350275[0x0][_0x5462c8(0x224)]=='Hindi')var _0x553f7a=users['Hindi'];else{if(_0x350275[0x0]['language']==_0x5462c8(0x14e))var _0x553f7a=users[_0x5462c8(0x14e)];else{if(_0x350275[0x0]['language']=='Spanish')var _0x553f7a=users['Spanish'];else{if(_0x350275[0x0][_0x5462c8(0x224)]==_0x5462c8(0x153))var _0x553f7a=users[_0x5462c8(0x153)];else{if(_0x350275[0x0][_0x5462c8(0x224)]==_0x5462c8(0x10d))var _0x553f7a=users[_0x5462c8(0x150)];else{if(_0x350275[0x0][_0x5462c8(0x224)]=='Chinese')var _0x553f7a=users[_0x5462c8(0x193)];else{if(_0x350275[0x0][_0x5462c8(0x224)]==_0x5462c8(0x1bb))var _0x553f7a=users[_0x5462c8(0x1ec)];}}}}}}}_0x29ac89['render'](_0x5462c8(0x241),{'success':_0xbdd958[_0x5462c8(0x15f)](_0x5462c8(0x1b7)),'errors':_0xbdd958[_0x5462c8(0x15f)](_0x5462c8(0x1fb)),'role':_0x23864d,'profile':_0x4977bb,'customer':_0x27d4bd,'warehouse':_0x11324e,'product':_0x45ac76,'user':_0x5e6c90,'master_shop':_0x350275,'unit':_0xbab4d5,'language':_0x553f7a,'rooms_data':_0x496168,'ed_fullDate':_0x12025b});}catch(_0x30f218){console['log'](_0x30f218);}}),router[a0_0x40efbc(0x1d5)](a0_0x40efbc(0x201),auth,async(_0x103cf3,_0x2e8757)=>{var _0x3294bd=a0_0x40efbc;try{const _0x2c2b06=_0x103cf3[_0x3294bd(0x112)]['id'],_0x1967e0=await sales_finished[_0x3294bd(0x110)]({'_id':_0x103cf3[_0x3294bd(0x112)]['id']}),_0x4cf9d2=await warehouse[_0x3294bd(0x110)]({'name':_0x1967e0['warehouse_name'],'room':_0x103cf3['body'][_0x3294bd(0x203)],'warehouse_category':_0x3294bd(0x228)}),{invoice:_0x432a73,customer:_0x2421c4,date:_0x280d38,warehouse_name:_0x1310a2,product_name:_0x29a847,stock:_0x2cbb16,adjust_qty:_0x894d74,note:_0x2f2e56,room:_0x131b90,primary_code:_0x43990a,secondary_code:_0x24294e,prod_code:_0x2f0a6c,level:_0x15a51c,isle:_0x2255f2,pallet:_0x4ae16f,expiry_date:_0x38f445}=_0x103cf3[_0x3294bd(0x1bc)];if(typeof _0x29a847==_0x3294bd(0x12f))var _0x4feaf5=[_0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x113)]],_0x31d108=[_0x103cf3['body'][_0x3294bd(0x1b8)]],_0x52f46f=[_0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x21a)]],_0x84f9a0=[_0x103cf3[_0x3294bd(0x1bc)]['primary_code']],_0x57fd3c=[_0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x191)]],_0x3c0235=[_0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x116)]],_0x4f919e=[_0x103cf3['body'][_0x3294bd(0x23c)]],_0x47caee=[_0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x245)]];else var _0x4feaf5=[..._0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x113)]],_0x31d108=[..._0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x1b8)]],_0x52f46f=[..._0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x21a)]],_0x84f9a0=[..._0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x18c)]],_0x57fd3c=[..._0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x191)]],_0x3c0235=[..._0x103cf3[_0x3294bd(0x1bc)]['prod_code']],_0x4f919e=[..._0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x23c)]],_0x47caee=[..._0x103cf3[_0x3294bd(0x1bc)][_0x3294bd(0x245)]];const _0x5aa318=_0x4feaf5[_0x3294bd(0x20a)](_0x4feef1=>{return _0x4feef1={'product_name':_0x4feef1};});_0x31d108[_0x3294bd(0x1cf)]((_0x8b6dd9,_0x2fccf8)=>{var _0x52d691=_0x3294bd;_0x5aa318[_0x2fccf8][_0x52d691(0x1b8)]=_0x8b6dd9;}),_0x52f46f['forEach']((_0x5a6b32,_0x5effc6)=>{var _0x1118ff=_0x3294bd;_0x5aa318[_0x5effc6][_0x1118ff(0x1d9)]=_0x5a6b32;}),_0x84f9a0['forEach']((_0x8c930b,_0x37a60b)=>{var _0x10a05b=_0x3294bd;_0x5aa318[_0x37a60b][_0x10a05b(0x18c)]=_0x8c930b;}),_0x57fd3c['forEach']((_0x165943,_0xd36f63)=>{_0x5aa318[_0xd36f63]['secondary_code']=_0x165943;}),_0x3c0235[_0x3294bd(0x1cf)]((_0x5a0087,_0x33ea84)=>{_0x5aa318[_0x33ea84]['product_code']=_0x5a0087;}),_0x4f919e['forEach']((_0x1ac749,_0x394dae)=>{var _0x22d55d=_0x3294bd;_0x5aa318[_0x394dae][_0x22d55d(0x23c)]=_0x1ac749;}),_0x47caee['forEach']((_0x5b914e,_0x5a36c5)=>{var _0x2cb1c4=_0x3294bd;_0x5aa318[_0x5a36c5][_0x2cb1c4(0x245)]=_0x5b914e;});var _0x2b2304=0x0;_0x5aa318['forEach'](_0x1b68d6=>{var _0x335a5e=_0x3294bd;console[_0x335a5e(0x132)]('foreach\x20newproduct',_0x1b68d6),(parseInt(_0x1b68d6['stock'])<parseInt(_0x1b68d6[_0x335a5e(0x1d9)])||parseInt(_0x1b68d6[_0x335a5e(0x1d9)])==0x0)&&_0x2b2304++;});if(_0x2b2304!=0x0)return _0x103cf3[_0x3294bd(0x15f)]('errors',_0x3294bd(0x145)),_0x2e8757[_0x3294bd(0x1ae)](_0x3294bd(0x11a));_0x1967e0[_0x3294bd(0x18d)][_0x3294bd(0x1cf)](_0x444b88=>{var _0x26019a=_0x3294bd;const _0xfd0843=_0x4cf9d2[_0x26019a(0x119)][_0x26019a(0x20a)](_0x3568df=>{var _0x4e3755=_0x26019a;_0x3568df[_0x4e3755(0x113)]==_0x444b88[_0x4e3755(0x113)]&&_0x3568df[_0x4e3755(0x166)]==_0x444b88['bay']&&(_0x3568df[_0x4e3755(0x15c)]=parseInt(_0x3568df[_0x4e3755(0x15c)])+parseInt(_0x444b88['quantity']));});}),await _0x4cf9d2[_0x3294bd(0x230)]();const _0x28ae58=_0x5aa318['filter'](_0x1d324c=>_0x1d324c[_0x3294bd(0x1d9)]!=='0'&&_0x1d324c[_0x3294bd(0x1d9)]!=='');_0x1967e0['invoice']=_0x432a73,_0x1967e0[_0x3294bd(0x18f)]=_0x2421c4,_0x1967e0[_0x3294bd(0x1fd)]=_0x280d38,_0x1967e0['warehouse_name']=_0x1310a2,_0x1967e0[_0x3294bd(0x18d)]=_0x28ae58,_0x1967e0[_0x3294bd(0x1a6)]=_0x2f2e56,_0x1967e0[_0x3294bd(0x203)]=_0x131b90;const _0x1d86e9=await _0x1967e0[_0x3294bd(0x230)](),_0x1bddab=await sales_finished[_0x3294bd(0x110)]({'_id':_0x103cf3['params']['id']}),_0x3e0821=await warehouse[_0x3294bd(0x110)]({'name':_0x1310a2,'room':_0x131b90,'warehouse_category':'Finished\x20Goods'});_0x1bddab[_0x3294bd(0x18d)]['forEach'](_0x55b7e4=>{var _0x4ae19d=_0x3294bd;const _0x481a6a=_0x3e0821[_0x4ae19d(0x119)][_0x4ae19d(0x20a)](_0x3e6e2c=>{var _0xce1c45=_0x4ae19d;_0x3e6e2c[_0xce1c45(0x113)]==_0x55b7e4['product_name']&&_0x3e6e2c[_0xce1c45(0x166)]==_0x55b7e4[_0xce1c45(0x166)]&&(_0x3e6e2c[_0xce1c45(0x15c)]=parseInt(_0x3e6e2c[_0xce1c45(0x15c)])-parseInt(_0x55b7e4[_0xce1c45(0x1d9)]));});}),console[_0x3294bd(0x132)](_0x3294bd(0x141),_0x3e0821),await _0x3e0821[_0x3294bd(0x230)]();const _0x214930=await c_payment_data[_0x3294bd(0x110)]({'invoice':_0x103cf3['body'][_0x3294bd(0x1c5)]});_0x214930['suppliers']=_0x103cf3[_0x3294bd(0x1bc)]['suppliers'],await _0x214930[_0x3294bd(0x230)](),_0x103cf3[_0x3294bd(0x15f)]('success','Sales\x20Update\x20successfully'),_0x2e8757['redirect']('/all_sales_finished/view');}catch(_0x893590){console[_0x3294bd(0x132)](_0x893590);}}),router[a0_0x40efbc(0x1d5)](a0_0x40efbc(0x194),auth,async(_0x457c34,_0x141abf)=>{var _0x24b6db=a0_0x40efbc;try{const _0x37c153=_0x457c34['params']['id'],{invoice:_0x476e0a,customer:_0x405588,receivable_amount:_0x4d5942,received_amount:_0x3b22b0}=_0x457c34['body'],_0x3a9bc2=await sales['findById'](_0x37c153);console[_0x24b6db(0x132)](_0x3a9bc2);var _0x427243=_0x4d5942-_0x3b22b0;console[_0x24b6db(0x132)](_0x3b22b0),_0x3a9bc2[_0x24b6db(0x1e6)]=parseFloat(_0x3b22b0)+parseFloat(_0x3a9bc2[_0x24b6db(0x1e6)]),_0x3a9bc2[_0x24b6db(0x214)]=_0x427243,console['log'](_0x3a9bc2);const _0x9630bd=await _0x3a9bc2[_0x24b6db(0x230)](),_0x37bce7=await c_payment_data['findOne']({'invoice':_0x476e0a});_0x37bce7[_0x24b6db(0x17e)]=_0x427243,await _0x37bce7['save']();let _0x25a505=new Date(),_0x410c34=('0'+_0x25a505[_0x24b6db(0x219)]())[_0x24b6db(0x1e1)](-0x2),_0x2f5603=('0'+(_0x25a505[_0x24b6db(0x168)]()+0x1))['slice'](-0x2),_0x1affd3=_0x25a505[_0x24b6db(0x1f5)](),_0x1610b4=_0x1affd3+'-'+_0x2f5603+'-'+_0x410c34;const _0x3723e4=new customer_payment({'invoice':_0x476e0a,'date':_0x1affd3+'-'+_0x2f5603+'-'+_0x410c34,'customer':_0x405588,'reason':_0x24b6db(0x18e),'amount':_0x3b22b0}),_0x112490=await _0x3723e4[_0x24b6db(0x230)]();_0x457c34[_0x24b6db(0x15f)](_0x24b6db(0x1b7),_0x24b6db(0x135)),_0x141abf[_0x24b6db(0x1ae)](_0x24b6db(0x19c));}catch(_0x2f1758){console[_0x24b6db(0x132)](_0x2f1758);}}),router[a0_0x40efbc(0x24d)](a0_0x40efbc(0x251),auth,async(_0x2a2e59,_0x52a5ba)=>{var _0x388fe8=a0_0x40efbc;try{const {username:_0x5e7cc0,email:_0x51abf9,role:_0x643e93}=_0x2a2e59[_0x388fe8(0x17f)],_0x185cd1=_0x2a2e59[_0x388fe8(0x17f)],_0x34d09c=await profile[_0x388fe8(0x110)]({'email':_0x185cd1[_0x388fe8(0x1c9)]}),_0x369184=await master_shop['find']();console[_0x388fe8(0x132)]('master',_0x369184);const _0x2715b8=_0x2a2e59[_0x388fe8(0x112)]['id'],_0x4fc979=await sales[_0x388fe8(0x144)](_0x2715b8);console[_0x388fe8(0x132)](_0x4fc979);const _0x3a9829=await customer[_0x388fe8(0x110)]({'name':_0x4fc979[_0x388fe8(0x18f)]});console[_0x388fe8(0x132)](_0x3a9829);if(_0x369184[0x0]['language']==_0x388fe8(0x1a5)){var _0x10556c=users[_0x388fe8(0x1f1)];console[_0x388fe8(0x132)](_0x10556c);}else{if(_0x369184[0x0]['language']==_0x388fe8(0x1b3))var _0x10556c=users['Hindi'];else{if(_0x369184[0x0][_0x388fe8(0x224)]==_0x388fe8(0x14e))var _0x10556c=users[_0x388fe8(0x14e)];else{if(_0x369184[0x0][_0x388fe8(0x224)]==_0x388fe8(0x1da))var _0x10556c=users[_0x388fe8(0x1da)];else{if(_0x369184[0x0][_0x388fe8(0x224)]==_0x388fe8(0x153))var _0x10556c=users[_0x388fe8(0x153)];else{if(_0x369184[0x0]['language']=='Portuguese\x20(BR)')var _0x10556c=users[_0x388fe8(0x150)];else{if(_0x369184[0x0][_0x388fe8(0x224)]==_0x388fe8(0x193))var _0x10556c=users[_0x388fe8(0x193)];else{if(_0x369184[0x0]['language']==_0x388fe8(0x1bb))var _0x10556c=users['Arabic'];}}}}}}}_0x52a5ba[_0x388fe8(0x156)](_0x388fe8(0x1a0),{'success':_0x2a2e59['flash']('success'),'errors':_0x2a2e59[_0x388fe8(0x15f)](_0x388fe8(0x1fb)),'role':_0x185cd1,'profile':_0x34d09c,'master_shop':_0x369184,'customers':_0x3a9829,'sales':_0x4fc979,'language':_0x10556c});}catch(_0x4ac0cd){console['log'](_0x4ac0cd);}}),router[a0_0x40efbc(0x24d)](a0_0x40efbc(0x199),auth,async(_0x6637a,_0x4df15b)=>{var _0x1b5437=a0_0x40efbc;try{const {username:_0x446211,email:_0x5bba0e,role:_0x48359d}=_0x6637a[_0x1b5437(0x17f)],_0x2eb29c=_0x6637a[_0x1b5437(0x17f)],_0x1abc28=await profile['findOne']({'email':_0x2eb29c[_0x1b5437(0x1c9)]}),_0x135f5a=await master_shop[_0x1b5437(0x171)](),_0xd4f617=_0x6637a[_0x1b5437(0x112)]['id'],_0x4c7e43=await sales_finished[_0x1b5437(0x144)](_0xd4f617),_0x1e6a6d=await warehouse[_0x1b5437(0x1bd)]([{'$match':{'name':_0x4c7e43[_0x1b5437(0x1e8)]}},{'$unwind':_0x1b5437(0x182)},{'$group':{'_id':_0x1b5437(0x1d4),'name':{'$first':_0x1b5437(0x21f)},'product_stock':{'$first':_0x1b5437(0x16e)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1b5437(0x20f)},'type':{'$first':_0x1b5437(0x129)},'floorlevel':{'$first':_0x1b5437(0x1d2)},'primary_code':{'$first':_0x1b5437(0x123)},'secondary_code':{'$first':_0x1b5437(0x259)},'product_code':{'$first':_0x1b5437(0x234)},'storage':{'$first':_0x1b5437(0x118)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1b5437(0x255)},'production_date':{'$first':_0x1b5437(0x12e)},'unit':{'$first':_0x1b5437(0x130)},'secondary_unit':{'$first':_0x1b5437(0x159)},'maxProducts':{'$first':_0x1b5437(0x163)},'batch_code':{'$first':_0x1b5437(0x1eb)},'maxPerUnit':{'$first':_0x1b5437(0x14c)}}}]),_0x2e984a=await product[_0x1b5437(0x171)]({}),_0x436ebb=await warehouse['aggregate']([{'$match':{'status':_0x1b5437(0x24c),'warehouse_category':_0x1b5437(0x228),'name':{'$ne':_0x1b5437(0x1fa),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':_0x1b5437(0x1c7),'name':{'$first':_0x1b5437(0x1c7)}}},{'$sort':{'name':0x1}}]);var _0x25c706=['Return\x20Rooms'];const _0x404745=await warehouse[_0x1b5437(0x1bd)]([{'$match':{'status':'Enabled','name':_0x1b5437(0x1ef)}},{'$group':{'_id':'$name','name':{'$first':_0x1b5437(0x1c7)}}},{'$sort':{'name':0x1}}]);if(_0x135f5a[0x0]['language']=='English\x20(US)'){var _0x319277=users[_0x1b5437(0x1f1)];console[_0x1b5437(0x132)](_0x319277);}else{if(_0x135f5a[0x0]['language']==_0x1b5437(0x1b3))var _0x319277=users['Hindi'];else{if(_0x135f5a[0x0]['language']==_0x1b5437(0x14e))var _0x319277=users[_0x1b5437(0x14e)];else{if(_0x135f5a[0x0][_0x1b5437(0x224)]=='Spanish')var _0x319277=users[_0x1b5437(0x1da)];else{if(_0x135f5a[0x0][_0x1b5437(0x224)]==_0x1b5437(0x153))var _0x319277=users['French'];else{if(_0x135f5a[0x0]['language']==_0x1b5437(0x10d))var _0x319277=users[_0x1b5437(0x150)];else{if(_0x135f5a[0x0]['language']==_0x1b5437(0x193))var _0x319277=users[_0x1b5437(0x193)];else{if(_0x135f5a[0x0][_0x1b5437(0x224)]=='Arabic\x20(ae)')var _0x319277=users[_0x1b5437(0x1ec)];}}}}}}}_0x4df15b[_0x1b5437(0x156)](_0x1b5437(0x127),{'success':_0x6637a[_0x1b5437(0x15f)]('success'),'errors':_0x6637a[_0x1b5437(0x15f)]('errors'),'role':_0x2eb29c,'profile':_0x1abc28,'user':_0x4c7e43,'stock':_0x1e6a6d,'master_shop':_0x135f5a,'unit':_0x2e984a,'language':_0x319277,'warehouses':_0x436ebb,'rooms':_0x25c706,'warehouse_QA':_0x404745});}catch(_0x24987b){console[_0x1b5437(0x132)](_0x24987b),_0x4df15b[_0x1b5437(0x1a7)](0xc8)['json']({'message':_0x24987b[_0x1b5437(0x10e)]});}}),router[a0_0x40efbc(0x1d5)](a0_0x40efbc(0x199),auth,async(_0x278d9e,_0x1632f7)=>{var _0x110e89=a0_0x40efbc;if(_0x278d9e[_0x110e89(0x1bc)]['for_categorize']=='QA')try{const {invoice:_0x447a61,date:_0x16a611,warehouse_name:_0x2b593d,product_name:_0x498294,primary_code:_0x39f6ea,secondary_code:_0x519fbb,product_code:_0x3f9202,sales_quantity:_0x458be7,stocks:_0x3a1553,return_qty:_0x496060,Room_name:_0x583192,to_warehouse_name_QA:_0x295bd3,to_Room_name_QA:_0x109cc7,note:_0x2fa484,for_categorize:_0xccc4c5,product_name_QA1:_0xcb1f1d}=_0x278d9e[_0x110e89(0x1bc)];if(typeof _0xcb1f1d==_0x110e89(0x12f))var _0x2eb759=[_0x278d9e['body'][_0x110e89(0x22a)]],_0x1f3c93=[_0x278d9e['body'][_0x110e89(0x254)]],_0x3452d4=[_0x278d9e['body'][_0x110e89(0x10a)]],_0x57e3c3=[_0x278d9e[_0x110e89(0x1bc)]['product_code_QA']],_0x56d10d=[_0x278d9e['body']['sales_quantity_QA']],_0x1fd087=[_0x278d9e['body'][_0x110e89(0x1e5)]],_0x3849f0=[_0x278d9e[_0x110e89(0x1bc)]['return_qty_QA']],_0x1e1183=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x15d)]],_0x34c386=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x117)]],_0x516b9b=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x1b6)]],_0x316ea9=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x23d)]],_0x1e0601=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x149)]],_0x727e00=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x184)]],_0x57c47e=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x1ad)]];else var _0x2eb759=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x22a)]],_0x1f3c93=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x254)]],_0x3452d4=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x10a)]],_0x57e3c3=[..._0x278d9e[_0x110e89(0x1bc)]['product_code_QA']],_0x56d10d=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x220)]],_0x1fd087=[..._0x278d9e[_0x110e89(0x1bc)]['stocks_QA']],_0x3849f0=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x19e)]],_0x1e1183=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x15d)]],_0x34c386=[..._0x278d9e['body'][_0x110e89(0x117)]],_0x516b9b=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x1b6)]],_0x316ea9=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x23d)]],_0x1e0601=[..._0x278d9e[_0x110e89(0x1bc)]['unit_QA']],_0x727e00=[..._0x278d9e['body'][_0x110e89(0x184)]],_0x57c47e=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x1ad)]];const _0x3322b7=_0x2eb759['map'](_0x131d61=>{return _0x131d61={'product_name':_0x131d61};});_0x1f3c93[_0x110e89(0x1cf)]((_0x2a8af9,_0x3e2978)=>{var _0x2aa04d=_0x110e89;_0x3322b7[_0x3e2978][_0x2aa04d(0x18c)]=_0x2a8af9;}),_0x3452d4[_0x110e89(0x1cf)]((_0x10fd91,_0x337004)=>{var _0x46dd79=_0x110e89;_0x3322b7[_0x337004][_0x46dd79(0x191)]=_0x10fd91;}),_0x57e3c3['forEach']((_0x251f7c,_0x2f7b4e)=>{_0x3322b7[_0x2f7b4e]['product_code']=_0x251f7c;}),_0x56d10d['forEach']((_0x27fbd8,_0x578ae8)=>{var _0x1b3776=_0x110e89;_0x3322b7[_0x578ae8][_0x1b3776(0x1b4)]=_0x27fbd8;}),_0x1fd087[_0x110e89(0x1cf)]((_0x277477,_0x241148)=>{var _0x28472b=_0x110e89;_0x3322b7[_0x241148][_0x28472b(0x1b8)]=_0x277477;}),_0x3849f0[_0x110e89(0x1cf)]((_0xe75ac4,_0x1d5cfe)=>{var _0xcdbc3e=_0x110e89;_0x3322b7[_0x1d5cfe][_0xcdbc3e(0x170)]=_0xe75ac4;}),_0x1e1183[_0x110e89(0x1cf)]((_0x1a53d7,_0x51418d)=>{var _0x9027aa=_0x110e89;_0x3322b7[_0x51418d][_0x9027aa(0x1c1)]=_0x1a53d7;}),_0x34c386[_0x110e89(0x1cf)]((_0x360229,_0x20850e)=>{var _0x62a0e7=_0x110e89;_0x3322b7[_0x20850e][_0x62a0e7(0x258)]=_0x360229;}),_0x516b9b[_0x110e89(0x1cf)]((_0x421192,_0x289daf)=>{var _0x2da90a=_0x110e89;_0x3322b7[_0x289daf][_0x2da90a(0x24e)]=_0x421192;}),_0x316ea9[_0x110e89(0x1cf)]((_0xbb3a23,_0x2e4ab1)=>{var _0x38f854=_0x110e89;_0x3322b7[_0x2e4ab1][_0x38f854(0x134)]=_0xbb3a23;}),_0x1e0601[_0x110e89(0x1cf)]((_0x166631,_0x14eb9b)=>{_0x3322b7[_0x14eb9b]['unit']=_0x166631;}),_0x727e00['forEach']((_0x47bf27,_0x2c2f96)=>{var _0x5b2ce8=_0x110e89;_0x3322b7[_0x2c2f96][_0x5b2ce8(0x120)]=_0x47bf27;}),_0x57c47e[_0x110e89(0x1cf)]((_0x3d84eb,_0x7ff414)=>{var _0x5b1047=_0x110e89;_0x3322b7[_0x7ff414][_0x5b1047(0x245)]=_0x3d84eb;});const _0xdd7d2e=await sales_finished['findOne']({'invoice':_0x447a61});_0xdd7d2e[_0x110e89(0x173)]=_0x110e89(0x1e3);const _0x1ee621=await _0xdd7d2e[_0x110e89(0x230)](),_0x109046=new sales_return_finished({'invoice':_0x447a61,'customer':_0x278d9e[_0x110e89(0x1bc)]['customer'],'date':_0x16a611,'warehouse_name':_0x2b593d,'room':_0x583192,'ToWarehouse':_0x295bd3,'ToRoom':_0x109cc7,'return_sale_QA':_0x3322b7,'note':_0x2fa484,'warehouse_cat':_0xccc4c5}),_0x423ebd=await _0x109046[_0x110e89(0x230)](),_0x184700=await sales_return_finished[_0x110e89(0x110)]({'invoice':_0x447a61}),_0x2367a8=await warehouse[_0x110e89(0x110)]({'name':_0x295bd3,'room':_0x109cc7});_0x184700[_0x110e89(0x17a)][_0x110e89(0x1cf)](_0x177097=>{var _0x5c1382=_0x110e89,_0x299243=0x0;const _0x571296=_0x2367a8[_0x5c1382(0x119)][_0x5c1382(0x20a)](_0x37cd01=>{var _0x9de050=_0x5c1382;_0x37cd01[_0x9de050(0x113)]==_0x177097[_0x9de050(0x113)]&&_0x37cd01['expiry_date']==_0x177097[_0x9de050(0x245)]&&_0x37cd01['production_date']==_0x177097['production_date']&&_0x37cd01[_0x9de050(0x24e)]==_0x177097[_0x9de050(0x24e)]&&(_0x37cd01['product_stock']=parseInt(_0x37cd01[_0x9de050(0x15c)])+parseInt(_0x177097[_0x9de050(0x170)]),_0x299243++);});_0x299243=='0'&&(_0x2367a8[_0x5c1382(0x119)]=_0x2367a8[_0x5c1382(0x119)][_0x5c1382(0x1cd)]({'product_name':_0x177097[_0x5c1382(0x113)],'product_stock':_0x177097['return_qty'],'primary_code':_0x177097[_0x5c1382(0x18c)],'secondary_code':_0x177097[_0x5c1382(0x191)],'product_code':_0x177097[_0x5c1382(0x217)],'batch_code':_0x177097[_0x5c1382(0x24e)],'maxPerUnit':_0x177097[_0x5c1382(0x1c1)],'production_date':_0x177097[_0x5c1382(0x120)],'expiry_date':_0x177097['expiry_date'],'secondary_unit':_0x177097['secondary_unit'],'unit':_0x177097[_0x5c1382(0x11e)],'maxProducts':_0x177097[_0x5c1382(0x258)],'bay':_0x177097[_0x5c1382(0x166)]}));}),await _0x2367a8[_0x110e89(0x230)]();const _0x199c69=new c_payment_data({'invoice':_0x447a61,'customer':_0x278d9e[_0x110e89(0x1bc)]['customer'],'reason':_0x110e89(0x197)});await _0x199c69[_0x110e89(0x230)]();const _0x127cca=await master_shop[_0x110e89(0x171)](),_0x58f24e=await email_settings[_0x110e89(0x110)](),_0xeafd42=await customer['findOne']({'name':_0x278d9e['body']['customer']});_0x127cca[0x0][_0x110e89(0x1f2)]==0x1?(right_currency=_0x127cca[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x127cca[0x0][_0x110e89(0x1b0)]);var _0x2a7725=_0x2eb759,_0x27140d=_0x3849f0,_0x484b4a='',_0x4fb312;for(_0x4fb312 in _0x2a7725){_0x484b4a+=_0x110e89(0x16d)+_0x110e89(0x243)+_0x2a7725[_0x4fb312]+'</td>'+_0x110e89(0x243)+_0x27140d[_0x4fb312]+'</td>'+_0x110e89(0x1bf);}console[_0x110e89(0x132)](_0x110e89(0x1b1),_0x484b4a);let _0x2e0b1d=nodemailer[_0x110e89(0x216)]({'service':_0x110e89(0x126),'auth':{'user':_0x58f24e[_0x110e89(0x1c9)],'pass':_0x58f24e[_0x110e89(0x169)]}}),_0x1eaf80={'from':_0x58f24e[_0x110e89(0x1c9)],'to':_0xeafd42['email'],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x110e89(0x138),'path':__dirname+_0x110e89(0x20d)+_0x110e89(0x207)+_0x127cca[0x0][_0x110e89(0x22f)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x110e89(0x231)+_0x110e89(0x17b)+_0x110e89(0x19a)+_0x110e89(0x17b)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x110e89(0x17b)+'<h2>\x20'+_0x127cca[0x0][_0x110e89(0x223)]+_0x110e89(0x13e)+_0x110e89(0x24b)+'</div>'+_0x110e89(0x154)+'<div>'+_0x110e89(0x1c3)+_0x110e89(0x1f8)+_0x447a61+'\x20'+_0x110e89(0x122)+'\x20Order\x20Date\x20:\x20'+_0x16a611+'\x20'+_0x110e89(0x125)+_0x110e89(0x11c)+'</div>'+_0x110e89(0x12c)+_0x110e89(0x1a8)+_0x110e89(0x16d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x110e89(0x22d)+_0x110e89(0x179)+_0x110e89(0x1a9)+_0x110e89(0x1bf)+_0x110e89(0x226)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x484b4a+'\x20'+_0x110e89(0x11b)+_0x110e89(0x14f)+_0x110e89(0x17b)+_0x110e89(0x140)+_0x110e89(0x172)+_0x127cca[0x0][_0x110e89(0x223)]+_0x110e89(0x11c)+_0x110e89(0x24b)+_0x110e89(0x24b)+'</body></html>'};_0x2e0b1d[_0x110e89(0x139)](_0x1eaf80,function(_0x1c9ee5,_0x4e296b){var _0x34cf93=_0x110e89;_0x1c9ee5?(console[_0x34cf93(0x132)](_0x1c9ee5),console[_0x34cf93(0x132)](_0x34cf93(0x22b))):console[_0x34cf93(0x132)](_0x34cf93(0x1ff));}),_0x278d9e[_0x110e89(0x15f)](_0x110e89(0x1b7),_0x110e89(0x1e2)),_0x1632f7[_0x110e89(0x1ae)](_0x110e89(0x1f3));}catch(_0x564481){_0x1632f7['status'](0xc8)['json']({'message1':_0x564481['message']});}else{if(_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x16b)]=='GS')try{const {invoice:_0x1e76ae,date:_0x3c7dde,warehouse_name:_0x1cb12c,product_name:_0x2cbafd,primary_code:_0x4c49f8,secondary_code:_0x42b5ce,product_code:_0x412a91,sales_quantity:_0x1c7727,stocks:_0x8d46ff,return_qty:_0x9362dd,Room_name:_0xcb40f7,to_warehouse_name:_0x5fc887,to_Room_name:_0x9bfccf,note:_0x5c8c69,level:_0x4a132e,isle:_0x2c788e,pallet:_0x262e9a,for_categorize:_0x5d555d}=_0x278d9e[_0x110e89(0x1bc)];if(typeof _0x2cbafd==_0x110e89(0x12f))var _0x2eb759=[_0x278d9e['body'][_0x110e89(0x113)]],_0x1f3c93=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x18c)]],_0x3452d4=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x191)]],_0x57e3c3=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x217)]],_0x56d10d=[_0x278d9e['body'][_0x110e89(0x1af)]],_0x3849f0=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x170)]],_0x18aeb9=[_0x278d9e['body'][_0x110e89(0x166)]],_0x1e1183=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x1c1)]],_0x34c386=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x258)]],_0x516b9b=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x24e)]],_0x316ea9=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x134)]],_0x1e0601=[_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x11e)]],_0x727e00=[_0x278d9e['body']['production_date']],_0x57c47e=[_0x278d9e[_0x110e89(0x1bc)]['expiry_date']];else var _0x2eb759=[..._0x278d9e['body'][_0x110e89(0x113)]],_0x1f3c93=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x18c)]],_0x3452d4=[..._0x278d9e[_0x110e89(0x1bc)]['secondary_code']],_0x57e3c3=[..._0x278d9e['body']['product_code']],_0x56d10d=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x1af)]],_0x3849f0=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x170)]],_0x18aeb9=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x166)]],_0x1e1183=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x1c1)]],_0x34c386=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x258)]],_0x516b9b=[..._0x278d9e['body'][_0x110e89(0x24e)]],_0x316ea9=[..._0x278d9e['body']['secondary_unit']],_0x1e0601=[..._0x278d9e[_0x110e89(0x1bc)]['unit']],_0x727e00=[..._0x278d9e[_0x110e89(0x1bc)]['production_date']],_0x57c47e=[..._0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x245)]];const _0x41ef65=_0x2eb759[_0x110e89(0x20a)](_0x288d8f=>{return _0x288d8f={'product_name':_0x288d8f};});_0x1f3c93[_0x110e89(0x1cf)]((_0x183fee,_0x5789d2)=>{var _0x10f543=_0x110e89;_0x41ef65[_0x5789d2][_0x10f543(0x18c)]=_0x183fee;}),_0x3452d4[_0x110e89(0x1cf)]((_0x14a61,_0x3aba80)=>{var _0x52a1ee=_0x110e89;_0x41ef65[_0x3aba80][_0x52a1ee(0x191)]=_0x14a61;}),_0x57e3c3[_0x110e89(0x1cf)]((_0x5203d4,_0x5eb5d8)=>{var _0x2f4218=_0x110e89;_0x41ef65[_0x5eb5d8][_0x2f4218(0x217)]=_0x5203d4;}),_0x56d10d[_0x110e89(0x1cf)]((_0x14d845,_0x5bd6d7)=>{var _0xa69e1a=_0x110e89;_0x41ef65[_0x5bd6d7][_0xa69e1a(0x1b4)]=_0x14d845;}),_0x3849f0[_0x110e89(0x1cf)]((_0x22742d,_0x3f1272)=>{_0x41ef65[_0x3f1272]['return_qty']=_0x22742d;}),_0x18aeb9[_0x110e89(0x1cf)]((_0x20d07b,_0x18cb24)=>{var _0x231060=_0x110e89;_0x41ef65[_0x18cb24][_0x231060(0x166)]=_0x20d07b;}),_0x1e1183[_0x110e89(0x1cf)]((_0x3b9855,_0x1cf58a)=>{var _0x35148f=_0x110e89;_0x41ef65[_0x1cf58a][_0x35148f(0x1c1)]=_0x3b9855;}),_0x34c386['forEach']((_0x51d0b6,_0x3a6606)=>{_0x41ef65[_0x3a6606]['maxProducts']=_0x51d0b6;}),_0x516b9b['forEach']((_0x5a6f3e,_0x43ec1e)=>{var _0x160dc1=_0x110e89;_0x41ef65[_0x43ec1e][_0x160dc1(0x24e)]=_0x5a6f3e;}),_0x316ea9[_0x110e89(0x1cf)]((_0x4cb979,_0xacfbe9)=>{var _0x1442b6=_0x110e89;_0x41ef65[_0xacfbe9][_0x1442b6(0x134)]=_0x4cb979;}),_0x1e0601[_0x110e89(0x1cf)]((_0x33026d,_0x53e4e7)=>{_0x41ef65[_0x53e4e7]['unit']=_0x33026d;}),_0x727e00[_0x110e89(0x1cf)]((_0x2f6720,_0x19e2f0)=>{var _0x5a9fa4=_0x110e89;_0x41ef65[_0x19e2f0][_0x5a9fa4(0x120)]=_0x2f6720;}),_0x57c47e[_0x110e89(0x1cf)]((_0x40f53a,_0xaebd34)=>{_0x41ef65[_0xaebd34]['expiry_date']=_0x40f53a;});var _0x118cdf=0x0;_0x41ef65['forEach'](_0x189683=>{var _0x27d176=_0x110e89;(parseInt(_0x189683[_0x27d176(0x1b4)])<parseInt(_0x189683[_0x27d176(0x170)])||parseInt(_0x189683[_0x27d176(0x1b8)])<parseInt(_0x189683[_0x27d176(0x170)])&&parseInt(_0x189683['sale_qty'])>parseInt(_0x189683['return_qty'])||parseInt(_0x189683[_0x27d176(0x170)])==0x0)&&_0x118cdf++;});if(_0x118cdf!=0x0)return _0x278d9e[_0x110e89(0x15f)]('errors','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x1632f7['redirect']('back');const _0x28b82c=await sales_finished[_0x110e89(0x110)]({'invoice':_0x1e76ae});_0x28b82c['return_data']=_0x110e89(0x1e3);const _0xdafe08=await _0x28b82c[_0x110e89(0x230)](),_0x53bb33=new sales_return_finished({'invoice':_0x1e76ae,'customer':_0x278d9e['body']['customer'],'date':_0x3c7dde,'warehouse_name':_0x1cb12c,'room':_0xcb40f7,'ToWarehouse':_0x5fc887,'ToRoom':_0x9bfccf,'return_sale':_0x41ef65,'note':_0x5c8c69,'warehouse_cat':_0x5d555d}),_0x3c45a2=await _0x53bb33[_0x110e89(0x230)](),_0x4219f0=await sales_return_finished['findOne']({'invoice':_0x1e76ae}),_0x5f0ef0=await warehouse[_0x110e89(0x110)]({'name':_0x5fc887,'room':_0x9bfccf,'warehouse_category':_0x110e89(0x228)});_0x4219f0[_0x110e89(0x1d1)]['forEach'](_0x34c47a=>{var _0x4a6ed4=_0x110e89,_0x28c40c=0x0;const _0x55d183=_0x5f0ef0[_0x4a6ed4(0x119)][_0x4a6ed4(0x20a)](_0x5eb94a=>{var _0xec0f08=_0x4a6ed4;_0x5eb94a[_0xec0f08(0x113)]==_0x34c47a[_0xec0f08(0x113)]&&_0x5eb94a[_0xec0f08(0x166)]==_0x34c47a['bay']&&_0x5eb94a[_0xec0f08(0x245)]==_0x34c47a[_0xec0f08(0x245)]&&_0x5eb94a['production_date']==_0x34c47a[_0xec0f08(0x120)]&&_0x5eb94a[_0xec0f08(0x24e)]==_0x34c47a[_0xec0f08(0x24e)]&&(_0x5eb94a[_0xec0f08(0x15c)]=parseInt(_0x5eb94a['product_stock'])+parseInt(_0x34c47a['return_qty']),_0x28c40c++);});_0x28c40c=='0'&&(_0x5f0ef0[_0x4a6ed4(0x119)]=_0x5f0ef0[_0x4a6ed4(0x119)][_0x4a6ed4(0x1cd)]({'product_name':_0x34c47a[_0x4a6ed4(0x113)],'product_stock':_0x34c47a[_0x4a6ed4(0x170)],'primary_code':_0x34c47a[_0x4a6ed4(0x18c)],'secondary_code':_0x34c47a[_0x4a6ed4(0x191)],'product_code':_0x34c47a[_0x4a6ed4(0x217)],'bay':_0x34c47a['bay'],'batch_code':_0x34c47a[_0x4a6ed4(0x24e)],'maxPerUnit':_0x34c47a['maxPerUnit'],'production_date':_0x34c47a[_0x4a6ed4(0x120)],'expiry_date':_0x34c47a[_0x4a6ed4(0x245)],'secondary_unit':_0x34c47a[_0x4a6ed4(0x134)],'unit':_0x34c47a['unit'],'maxProducts':_0x34c47a[_0x4a6ed4(0x258)]}));}),await _0x5f0ef0[_0x110e89(0x230)](),console[_0x110e89(0x132)](_0x278d9e[_0x110e89(0x1bc)]);const _0x3a603f=new c_payment_data({'invoice':_0x1e76ae,'customer':_0x278d9e[_0x110e89(0x1bc)][_0x110e89(0x18f)],'reason':_0x110e89(0x197)});await _0x3a603f['save']();const _0x1f088e=await master_shop[_0x110e89(0x171)]();console[_0x110e89(0x132)](_0x110e89(0x209),_0x1f088e[0x0][_0x110e89(0x22f)]);const _0x48b2f3=await email_settings[_0x110e89(0x110)](),_0x1e5be3=await customer['findOne']({'name':_0x278d9e['body'][_0x110e89(0x18f)]});console[_0x110e89(0x132)](_0x110e89(0x174),_0x1e5be3);_0x1f088e[0x0][_0x110e89(0x1f2)]==0x1?(right_currency=_0x1f088e[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x1f088e[0x0][_0x110e89(0x1b0)]);var _0x2a7725=_0x2eb759,_0x27140d=_0x3849f0,_0x484b4a='',_0x4fb312;for(_0x4fb312 in _0x2a7725){_0x484b4a+=_0x110e89(0x16d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2a7725[_0x4fb312]+_0x110e89(0x151)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x27140d[_0x4fb312]+_0x110e89(0x151)+'</tr>';}console['log'](_0x110e89(0x1b1),_0x484b4a);let _0xb6167e=nodemailer[_0x110e89(0x216)]({'service':_0x110e89(0x126),'auth':{'user':_0x48b2f3[_0x110e89(0x1c9)],'pass':_0x48b2f3[_0x110e89(0x169)]}}),_0x1d6f0b={'from':_0x48b2f3[_0x110e89(0x1c9)],'to':_0x1e5be3[_0x110e89(0x1c9)],'subject':_0x110e89(0x23b),'attachments':[{'filename':'Logo.png','path':__dirname+_0x110e89(0x20d)+'/upload/'+_0x1f088e[0x0][_0x110e89(0x22f)],'cid':_0x110e89(0x19b)}],'html':_0x110e89(0x235)+_0x110e89(0x232)+_0x110e89(0x231)+_0x110e89(0x17b)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x110e89(0x17b)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x110e89(0x24b)+_0x110e89(0x17b)+_0x110e89(0x192)+_0x1f088e[0x0][_0x110e89(0x223)]+_0x110e89(0x13e)+'</div>'+_0x110e89(0x24b)+_0x110e89(0x154)+_0x110e89(0x17b)+_0x110e89(0x1c3)+_0x110e89(0x1f8)+_0x1e76ae+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x110e89(0x1d6)+_0x3c7dde+'\x20'+_0x110e89(0x125)+'</h5>'+'</div>'+_0x110e89(0x12c)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x110e89(0x16d)+_0x110e89(0x1e4)+_0x110e89(0x22d)+_0x110e89(0x179)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+'</tr>'+'</thead>'+_0x110e89(0x137)+'\x20'+_0x484b4a+'\x20'+_0x110e89(0x11b)+'</table>'+_0x110e89(0x17b)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x1f088e[0x0]['site_title']+_0x110e89(0x11c)+'</div>'+_0x110e89(0x24b)+_0x110e89(0x1f0)};_0xb6167e[_0x110e89(0x139)](_0x1d6f0b,function(_0x5ed4cc,_0x354bf8){var _0x3559cc=_0x110e89;_0x5ed4cc?(console[_0x3559cc(0x132)](_0x5ed4cc),console[_0x3559cc(0x132)]('Error\x20Occurs')):console[_0x3559cc(0x132)](_0x3559cc(0x1ff));}),_0x278d9e[_0x110e89(0x15f)]('success',_0x110e89(0x1e2)),_0x1632f7[_0x110e89(0x1ae)](_0x110e89(0x1f3));}catch(_0x4eb526){console[_0x110e89(0x132)](_0x4eb526),_0x1632f7[_0x110e89(0x1a7)](0xc8)[_0x110e89(0x1de)]({'message1':_0x4eb526[_0x110e89(0x10e)]});}}}),router['get'](a0_0x40efbc(0x1fe),auth,async(_0x272f55,_0x3ed4eb)=>{var _0x4706dc=a0_0x40efbc;try{const {username:_0x293056,email:_0x5ca914,role:_0x245dcf}=_0x272f55[_0x4706dc(0x17f)],_0x478e31=_0x272f55[_0x4706dc(0x17f)],_0x250003=await profile[_0x4706dc(0x110)]({'email':_0x478e31[_0x4706dc(0x1c9)]}),_0x4a2d33=await master_shop[_0x4706dc(0x171)]();console[_0x4706dc(0x132)]('barcode\x20Product\x20master',_0x4a2d33);const _0x6c7462=_0x272f55[_0x4706dc(0x112)]['id'],_0x2ab551=await sales['findById'](_0x6c7462);console[_0x4706dc(0x132)](_0x4706dc(0x256),_0x2ab551);if(_0x4a2d33[0x0][_0x4706dc(0x224)]==_0x4706dc(0x1a5))var _0x1c9c62=users[_0x4706dc(0x1f1)];else{if(_0x4a2d33[0x0][_0x4706dc(0x224)]==_0x4706dc(0x1b3))var _0x1c9c62=users[_0x4706dc(0x1b3)];else{if(_0x4a2d33[0x0][_0x4706dc(0x224)]==_0x4706dc(0x14e))var _0x1c9c62=users['German'];else{if(_0x4a2d33[0x0][_0x4706dc(0x224)]==_0x4706dc(0x1da))var _0x1c9c62=users[_0x4706dc(0x1da)];else{if(_0x4a2d33[0x0]['language']==_0x4706dc(0x153))var _0x1c9c62=users['French'];else{if(_0x4a2d33[0x0][_0x4706dc(0x224)]==_0x4706dc(0x10d))var _0x1c9c62=users[_0x4706dc(0x150)];else{if(_0x4a2d33[0x0][_0x4706dc(0x224)]==_0x4706dc(0x193))var _0x1c9c62=users[_0x4706dc(0x193)];else{if(_0x4a2d33[0x0]['language']==_0x4706dc(0x1bb))var _0x1c9c62=users['Arabic'];}}}}}}}_0x3ed4eb[_0x4706dc(0x156)]('all_sales_barcode',{'success':_0x272f55['flash'](_0x4706dc(0x1b7)),'errors':_0x272f55[_0x4706dc(0x15f)]('errors'),'role':_0x478e31,'profile':_0x250003,'alldata':_0x2ab551,'master_shop':_0x4a2d33,'language':_0x1c9c62});}catch(_0x1a57b4){console[_0x4706dc(0x132)](_0x1a57b4);}}),router[a0_0x40efbc(0x1d5)]('/barcode_scanner',async(_0x2aeeb7,_0x1d9341)=>{var _0x5ae154=a0_0x40efbc;const {product_code:_0x311398,warehouse_name:_0x33181b,rooms_data:_0x284d3e,Roomslist:_0x31efc2,sales_category:_0x43e48f}=_0x2aeeb7[_0x5ae154(0x1bc)],_0xc3ca98=_0x31efc2[_0x5ae154(0x1b9)](','),_0x20f7c1=[];async function _0x4726c3(_0x55d045){var _0x595b8b=_0x5ae154;const _0x3fe06a=await warehouse[_0x595b8b(0x1bd)]([{'$match':{'name':_0x33181b,'room':_0x55d045}},{'$unwind':_0x595b8b(0x182)},{'$match':{'product_details.primary_code':_0x311398}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x595b8b(0x21f)},'product_stock':{'$first':_0x595b8b(0x16e)},'primary_code':{'$first':_0x595b8b(0x123)},'secondary_code':{'$first':_0x595b8b(0x259)},'product_code':{'$first':_0x595b8b(0x234)},'level':{'$first':_0x595b8b(0x162)},'bay':{'$first':_0x595b8b(0x1e9)},'type':{'$first':_0x595b8b(0x129)},'pallet':{'$first':_0x595b8b(0x1d2)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x595b8b(0x118)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x595b8b(0x255)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x595b8b(0x14c)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x595b8b(0x13c)},'invoice':{'$first':_0x595b8b(0x142)},'uuid':{'$first':_0x595b8b(0x185)},'gross_price':{'$first':_0x595b8b(0x20c)},'sales_category':{'$first':'$product_details.sales_category'}}}]),_0x211055=await warehouse['aggregate']([{'$match':{'name':_0x33181b,'room':_0x55d045}},{'$unwind':_0x595b8b(0x182)},{'$match':{'product_details.secondary_code':_0x311398}},{'$group':{'_id':_0x595b8b(0x1d4),'name':{'$first':_0x595b8b(0x21f)},'product_stock':{'$first':_0x595b8b(0x16e)},'primary_code':{'$first':_0x595b8b(0x123)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x595b8b(0x1e9)},'isle':{'$first':_0x595b8b(0x20f)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x595b8b(0x130)},'secondary_unit':{'$first':_0x595b8b(0x159)},'storage':{'$first':_0x595b8b(0x118)},'rack':{'$first':_0x595b8b(0x205)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x595b8b(0x14c)},'batch_code':{'$first':_0x595b8b(0x1eb)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x595b8b(0x13c)},'invoice':{'$first':_0x595b8b(0x142)},'uuid':{'$first':_0x595b8b(0x185)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':'$product_details.sales_category'}}}]);if(_0x3fe06a['length']>0x0)_0x20f7c1['push'](_0x3fe06a);else _0x211055[_0x595b8b(0x215)]>0x0&&_0x20f7c1['push'](_0x211055);}const _0x6e78e2=_0xc3ca98[_0x5ae154(0x20a)](_0x3135fd=>_0x4726c3(_0x3135fd));await Promise['all'](_0x6e78e2),_0x1d9341['json'](_0x20f7c1);}),router[a0_0x40efbc(0x1d5)]('/barcode_scanner_logs',async(_0x5de019,_0x2e9c26)=>{var _0x1e8208=a0_0x40efbc;const {product_code:_0x1f48dc,warehouse_name:_0x2a3d1c,rooms_data:_0x2042a9,Roomslist:_0xf94bc,sales_category:_0x28443b}=_0x5de019[_0x1e8208(0x1bc)],_0x151a1b=_0xf94bc[_0x1e8208(0x1b9)](','),_0x1437cf=[];async function _0x1ac009(_0x1dfe73){var _0x55f2b9=_0x1e8208;const _0x11c1e5=await warehouse[_0x55f2b9(0x1bd)]([{'$match':{'name':_0x2a3d1c,'room':_0x1dfe73}},{'$unwind':_0x55f2b9(0x182)},{'$match':{'product_details.primary_code':_0x1f48dc,'product_details.sales_category':_0x28443b,'product_details.type_products':_0x55f2b9(0x132)}},{'$group':{'_id':_0x55f2b9(0x1d4),'name':{'$first':_0x55f2b9(0x21f)},'product_stock':{'$first':_0x55f2b9(0x16e)},'primary_code':{'$first':_0x55f2b9(0x123)},'secondary_code':{'$first':_0x55f2b9(0x259)},'product_code':{'$first':_0x55f2b9(0x234)},'level':{'$first':_0x55f2b9(0x162)},'bay':{'$first':'$product_details.bay'},'type':{'$first':_0x55f2b9(0x129)},'pallet':{'$first':_0x55f2b9(0x1d2)},'unit':{'$first':_0x55f2b9(0x130)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x55f2b9(0x118)},'rack':{'$first':_0x55f2b9(0x205)},'expiry_date':{'$first':_0x55f2b9(0x255)},'production_date':{'$first':_0x55f2b9(0x12e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x55f2b9(0x1eb)},'product_cat':{'$first':_0x55f2b9(0x1d7)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x55f2b9(0x142)},'uuid':{'$first':_0x55f2b9(0x185)},'gross_price':{'$first':'$product_details.gross_price'},'sales_category':{'$first':_0x55f2b9(0x253)},'type_products':{'$first':_0x55f2b9(0x16c)}}}]);console[_0x55f2b9(0x132)](_0x55f2b9(0x132)+_0x55f2b9(0x195)+_0x1f48dc+_0x55f2b9(0x195)+_0x28443b);const _0x25aa97=await warehouse[_0x55f2b9(0x1bd)]([{'$match':{'name':_0x2a3d1c,'room':_0x1dfe73}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x1f48dc,'product_details.sales_category':_0x28443b,'product_details.type_products':_0x55f2b9(0x132)}},{'$group':{'_id':_0x55f2b9(0x1d4),'name':{'$first':_0x55f2b9(0x21f)},'product_stock':{'$first':_0x55f2b9(0x16e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x55f2b9(0x259)},'product_code':{'$first':_0x55f2b9(0x234)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x55f2b9(0x129)},'pallet':{'$first':_0x55f2b9(0x1d2)},'unit':{'$first':_0x55f2b9(0x130)},'secondary_unit':{'$first':_0x55f2b9(0x159)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x55f2b9(0x205)},'expiry_date':{'$first':_0x55f2b9(0x255)},'production_date':{'$first':_0x55f2b9(0x12e)},'maxPerUnit':{'$first':_0x55f2b9(0x14c)},'batch_code':{'$first':_0x55f2b9(0x1eb)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x55f2b9(0x13c)},'invoice':{'$first':'$product_details.invoice'},'uuid':{'$first':_0x55f2b9(0x185)},'gross_price':{'$first':_0x55f2b9(0x20c)},'sales_category':{'$first':_0x55f2b9(0x253)},'type_products':{'$first':_0x55f2b9(0x16c)}}}]);if(_0x11c1e5[_0x55f2b9(0x215)]>0x0)_0x1437cf['push'](_0x11c1e5);else _0x25aa97[_0x55f2b9(0x215)]>0x0&&_0x1437cf['push'](_0x25aa97);}const _0x1087c1=_0x151a1b[_0x1e8208(0x20a)](_0x440118=>_0x1ac009(_0x440118));await Promise[_0x1e8208(0x14a)](_0x1087c1),_0x2e9c26[_0x1e8208(0x1de)](_0x1437cf);}),router['post'](a0_0x40efbc(0x221),async(_0x2674ba,_0x126319)=>{var _0x96ca7d=a0_0x40efbc;try{const {prduct_code:_0x45309e,warehouse_data:_0x4b77cb,qty_req:_0x1b8cb7}=_0x2674ba['body'];let _0x551af0=_0x45309e[_0x96ca7d(0x1b9)]('~'),_0x32c0ed=_0x1b8cb7[_0x96ca7d(0x1b9)]('~'),_0x470bda=[],_0x3c051d=0x0;for(let _0x289599=0x0;_0x289599<=_0x551af0[_0x96ca7d(0x215)]-0x1;_0x289599++){const _0x17b105=_0x551af0[_0x289599],_0x27e985=_0x32c0ed[_0x289599],_0x59f1c3=await warehouse[_0x96ca7d(0x1bd)]([{'$match':{'name':_0x4b77cb}},{'$unwind':_0x96ca7d(0x182)},{'$match':{'product_details.product_code':_0x17b105,'product_details.isAvailable':_0x96ca7d(0x242),'product_details.isUsed':_0x96ca7d(0x218)}},{'$sort':{'product_details.date_received':0x1,'product_details.level':-0x1,'product_details.bay':-0x1}},{'$group':{'_id':_0x96ca7d(0x1d4),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x96ca7d(0x16e)},'primary_code':{'$first':_0x96ca7d(0x123)},'secondary_code':{'$first':_0x96ca7d(0x259)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x96ca7d(0x162)},'bay':{'$first':_0x96ca7d(0x1e9)},'type':{'$first':_0x96ca7d(0x129)},'pallet':{'$first':_0x96ca7d(0x1d2)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x96ca7d(0x118)},'rack':{'$first':_0x96ca7d(0x205)},'expiry_date':{'$first':_0x96ca7d(0x255)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x96ca7d(0x14c)},'batch_code':{'$first':_0x96ca7d(0x1eb)},'product_cat':{'$first':_0x96ca7d(0x1d7)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x96ca7d(0x13c)},'invoice':{'$first':_0x96ca7d(0x142)},'uuid':{'$first':_0x96ca7d(0x185)},'gross_price':{'$first':_0x96ca7d(0x20c)},'sales_category':{'$first':'$product_details.sales_category'},'date_received':{'$first':_0x96ca7d(0x1aa)},'warehouse_id':{'$first':_0x96ca7d(0x237)}}}]),_0x4d98bc=_0x59f1c3['sort']((_0xcde7b3,_0x8614d5)=>new Date(_0xcde7b3['date_received'])-new Date(_0x8614d5['date_received']));let _0x46b5ea=_0x27e985;for(let _0x494518=0x0;_0x494518<=_0x4d98bc[_0x96ca7d(0x215)]-0x1&&_0x46b5ea>0x0;_0x494518++){const _0x5f17d4=_0x4d98bc[_0x494518];if(_0x5f17d4[_0x96ca7d(0x217)]==_0x17b105){_0x470bda[_0x3c051d]={};const _0x4f2d86=parseInt(_0x5f17d4[_0x96ca7d(0x15c)]),_0x3c9a83=0x0;let _0x5efe37=_0x4f2d86-_0x3c9a83,_0xae055e=Math[_0x96ca7d(0x13a)](_0x46b5ea,_0x5efe37);console[_0x96ca7d(0x132)](_0x96ca7d(0x22e)+_0xae055e+_0x96ca7d(0x257)+_0x4b77cb+',\x20room:\x20'+_0x5f17d4[_0x96ca7d(0x1c2)]+_0x96ca7d(0x1ba)+(_0x5f17d4[_0x96ca7d(0x23c)]+_0x5f17d4[_0x96ca7d(0x166)])+_0x96ca7d(0x246)+_0x5f17d4[_0x96ca7d(0x196)]+_0x96ca7d(0x1df)+_0x5f17d4[_0x96ca7d(0x164)]),_0x470bda[_0x3c051d][_0x96ca7d(0x178)]=_0x5f17d4[_0x96ca7d(0x148)]+'~'+_0x5f17d4['_id']+'~'+_0xae055e,_0x470bda[_0x3c051d][_0x96ca7d(0x113)]=_0x5f17d4['name'],_0x470bda[_0x3c051d]['product_code']=_0x5f17d4[_0x96ca7d(0x217)],_0x470bda[_0x3c051d][_0x96ca7d(0x147)]=_0x5f17d4['product_id'],_0x470bda[_0x3c051d][_0x96ca7d(0x1ce)]=_0x5f17d4['date_recieved'],_0x470bda[_0x3c051d][_0x96ca7d(0x21b)]=_0x5f17d4[_0x96ca7d(0x21b)],_0x470bda[_0x3c051d]['uuid']=_0x5f17d4[_0x96ca7d(0x158)],_0x470bda[_0x3c051d][_0x96ca7d(0x1d9)]=_0xae055e,_0x470bda[_0x3c051d][_0x96ca7d(0x11e)]=_0x5f17d4['unit'],_0x470bda[_0x3c051d]['secondary_unit']=_0x5f17d4[_0x96ca7d(0x134)],_0x470bda[_0x3c051d][_0x96ca7d(0x18c)]=_0x5f17d4[_0x96ca7d(0x18c)],_0x470bda[_0x3c051d][_0x96ca7d(0x191)]=_0x5f17d4[_0x96ca7d(0x191)],_0x470bda[_0x3c051d][_0x96ca7d(0x22c)]=_0x5f17d4[_0x96ca7d(0x22c)],_0x470bda[_0x3c051d][_0x96ca7d(0x24e)]=_0x5f17d4['batch_code'],_0x470bda[_0x3c051d][_0x96ca7d(0x245)]=_0x5f17d4[_0x96ca7d(0x245)],_0x470bda[_0x3c051d][_0x96ca7d(0x120)]=_0x5f17d4[_0x96ca7d(0x120)],_0x470bda[_0x3c051d][_0x96ca7d(0x202)]=_0x5f17d4[_0x96ca7d(0x202)],_0x470bda[_0x3c051d][_0x96ca7d(0x229)]=_0x5f17d4[_0x96ca7d(0x229)],_0x470bda[_0x3c051d]['invoice']=_0x5f17d4[_0x96ca7d(0x1c5)],_0x470bda[_0x3c051d][_0x96ca7d(0x115)]=_0x5f17d4[_0x96ca7d(0x115)],_0x470bda[_0x3c051d][_0x96ca7d(0x1c4)]=_0x5f17d4[_0x96ca7d(0x1c2)],_0x470bda[_0x3c051d]['level']=_0x5f17d4[_0x96ca7d(0x23c)],_0x470bda[_0x3c051d][_0x96ca7d(0x166)]=_0x5f17d4[_0x96ca7d(0x166)],_0x470bda[_0x3c051d][_0x96ca7d(0x1a7)]=_0x96ca7d(0x242),console[_0x96ca7d(0x132)]('1',_0x3c051d),_0x46b5ea-=_0xae055e,_0x3c051d++;if(_0x46b5ea<=0x0)break;}}if(_0x46b5ea>0x0){var _0x4579b9=await product[_0x96ca7d(0x110)]({'product_code':_0x17b105});console[_0x96ca7d(0x132)]('2',_0x3c051d),_0x470bda[_0x3c051d]={},_0x470bda[_0x3c051d][_0x96ca7d(0x113)]=_0x4579b9['name'],_0x470bda[_0x3c051d]['product_code']=_0x17b105,_0x470bda[_0x3c051d][_0x96ca7d(0x147)]=_0x4579b9[_0x96ca7d(0x1e0)][_0x96ca7d(0x114)](),_0x470bda[_0x3c051d]['quantity']=_0x46b5ea,_0x470bda[_0x3c051d][_0x96ca7d(0x10c)]=_0x4579b9[_0x96ca7d(0x11e)],_0x470bda[_0x3c051d][_0x96ca7d(0x134)]=_0x4579b9[_0x96ca7d(0x12a)],_0x470bda[_0x3c051d][_0x96ca7d(0x18c)]=_0x4579b9[_0x96ca7d(0x18c)],_0x470bda[_0x3c051d]['secondary_code']=_0x4579b9[_0x96ca7d(0x191)],_0x470bda[_0x3c051d][_0x96ca7d(0x22c)]=_0x4579b9[_0x96ca7d(0x22c)],_0x470bda[_0x3c051d][_0x96ca7d(0x202)]=_0x4579b9['maxProdPerUnit'],_0x470bda[_0x3c051d][_0x96ca7d(0x115)]=_0x4579b9['gross_price'],_0x470bda[_0x3c051d]['status']=_0x96ca7d(0x218),console[_0x96ca7d(0x132)]('There\x20is\x20'+_0x46b5ea+_0x96ca7d(0x21e)+_0x3c051d+_0x96ca7d(0x195)+_0x17b105),_0x3c051d++;}}_0x126319['json'](_0x470bda);}catch(_0x26b2e7){console[_0x96ca7d(0x132)](_0x26b2e7);}}),router[a0_0x40efbc(0x1d5)]('/barcode_scanner_auto',async(_0x12d6c4,_0x505612)=>{var _0x39cdd4=a0_0x40efbc;const {product_code:_0x1d00dc}=_0x12d6c4['body'];var _0x256466;const _0x44aae5=await product[_0x39cdd4(0x1bd)]([{'$match':{'primary_code':_0x1d00dc}},{'$group':{'_id':_0x39cdd4(0x237),'name':{'$first':'$name'},'category':{'$first':_0x39cdd4(0x10f)},'brand':{'$first':_0x39cdd4(0x24a)},'unit':{'$first':_0x39cdd4(0x176)},'alertquantity':{'$first':_0x39cdd4(0x190)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x39cdd4(0x24f)},'secondary_code':{'$first':_0x39cdd4(0x155)},'maxStocks':{'$first':_0x39cdd4(0x109)},'maxProdPerUnit':{'$first':_0x39cdd4(0x204)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x39cdd4(0x133)},'gross_price':{'$first':_0x39cdd4(0x213)},'sales_category':{'$first':_0x39cdd4(0x23a)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x3e3444=await product[_0x39cdd4(0x1bd)]([{'$match':{'secondary_code':_0x1d00dc}},{'$group':{'_id':_0x39cdd4(0x237),'name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':_0x39cdd4(0x24a)},'unit':{'$first':_0x39cdd4(0x176)},'alertquantity':{'$first':_0x39cdd4(0x190)},'product_code':{'$first':_0x39cdd4(0x181)},'primary_code':{'$first':_0x39cdd4(0x24f)},'secondary_code':{'$first':_0x39cdd4(0x155)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x39cdd4(0x204)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x39cdd4(0x133)},'gross_price':{'$first':_0x39cdd4(0x213)},'sales_category':{'$first':_0x39cdd4(0x23a)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x44aae5[_0x39cdd4(0x215)]>0x0)_0x256466=_0x44aae5;else _0x3e3444[_0x39cdd4(0x215)]>0x0&&(_0x256466=_0x3e3444);_0x505612[_0x39cdd4(0x1de)](_0x256466);}),router['post'](a0_0x40efbc(0x212),async(_0x1af8a9,_0x406cc5)=>{var _0x57ad5b=a0_0x40efbc;try{const {group_id:_0x38676b,DRSI:_0x37ea72,dateofreq:_0x5403e1,PO_number:_0x5dc799,date:_0x438349,warehouse_name:_0x2ff0b3,typevehicle:_0xa7e09b,deliverydate:_0x40e36c,driver:_0x219039,plate:_0xfb2807,van:_0xac678,TSU:_0x43343e,actual_delivery_date:_0x1321c1,TFU:_0x4fa063,pull_out_date:_0x35a471,sales:_0x3b4f8a,Customer_data:_0x1fd5ef,note:_0xcaed8a}=_0x1af8a9[_0x57ad5b(0x1bc)],_0x428bf7=mongoose[_0x57ad5b(0x16a)][_0x57ad5b(0x188)];let _0x471c0d=[];const _0x542e99=new invoice_for_outgoing();await _0x542e99[_0x57ad5b(0x230)]();const _0x1b774b=_0x57ad5b(0x247)+_0x542e99[_0x57ad5b(0x175)][_0x57ad5b(0x160)]()[_0x57ad5b(0x161)](0x8,'0');if(typeof _0x38676b==_0x57ad5b(0x12f)){let _0x13f130=_0x38676b[_0x57ad5b(0x1b9)]('~');var _0x132141=_0x428bf7(_0x13f130[0x0]),_0x1dc3b4=_0x428bf7(_0x13f130[0x1]),_0x40ef22=_0x13f130[0x2];let _0x17e56f=0x0;const _0x663378=await warehouse[_0x57ad5b(0x1bd)]([{'$match':{'_id':_0x132141}},{'$unwind':_0x57ad5b(0x182)},{'$match':{'product_details._id':_0x1dc3b4}}]);await warehouse[_0x57ad5b(0x186)]({'_id':_0x428bf7(_0x132141),'product_details._id':_0x428bf7(_0x1dc3b4)},{'$set':{'product_details.$.isUsed':_0x57ad5b(0x242)}}),_0x471c0d[_0x17e56f]={};for(let _0x5342cf=0x0;_0x5342cf<=_0x663378[_0x57ad5b(0x215)]-0x1;_0x5342cf++){const _0x2f08d7=_0x663378[_0x5342cf];console[_0x57ad5b(0x132)](_0x2f08d7),_0x471c0d[_0x17e56f][_0x57ad5b(0x157)]=_0x2f08d7['name'],_0x471c0d[_0x17e56f][_0x57ad5b(0x147)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x147)],_0x471c0d[_0x17e56f][_0x57ad5b(0x113)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x113)],_0x471c0d[_0x17e56f]['product_code']=_0x2f08d7['product_details'][_0x57ad5b(0x217)],_0x471c0d[_0x17e56f][_0x57ad5b(0x15c)]=_0x40ef22,_0x471c0d[_0x17e56f][_0x57ad5b(0x1d9)]=_0x40ef22,_0x471c0d[_0x17e56f][_0x57ad5b(0x11e)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x11e)],_0x471c0d[_0x17e56f][_0x57ad5b(0x134)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x134)],_0x471c0d[_0x17e56f][_0x57ad5b(0x23c)]=_0x2f08d7['product_details'][_0x57ad5b(0x23c)],_0x471c0d[_0x17e56f][_0x57ad5b(0x166)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x166)],_0x471c0d[_0x17e56f][_0x57ad5b(0x18c)]=_0x2f08d7[_0x57ad5b(0x119)]['primary_code'],_0x471c0d[_0x17e56f]['secondary_code']=_0x2f08d7[_0x57ad5b(0x119)]['secondary_code'],_0x471c0d[_0x17e56f][_0x57ad5b(0x22c)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x22c)],_0x471c0d[_0x17e56f]['batch_code']=_0x2f08d7['product_details'][_0x57ad5b(0x24e)],_0x471c0d[_0x17e56f][_0x57ad5b(0x245)]=_0x2f08d7['product_details'][_0x57ad5b(0x245)],_0x471c0d[_0x17e56f][_0x57ad5b(0x120)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x120)],_0x471c0d[_0x17e56f][_0x57ad5b(0x202)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x202)],_0x471c0d[_0x17e56f]['product_cat']=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x229)],_0x471c0d[_0x17e56f][_0x57ad5b(0x1c4)]=_0x2f08d7[_0x57ad5b(0x203)],_0x471c0d[_0x17e56f][_0x57ad5b(0x1c5)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x1c5)],_0x471c0d[_0x17e56f][_0x57ad5b(0x158)]=_0x2f08d7[_0x57ad5b(0x119)]['uuid'],_0x471c0d[_0x17e56f][_0x57ad5b(0x115)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x115)],_0x471c0d[_0x17e56f]['sales_category']=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x233)],_0x471c0d[_0x17e56f][_0x57ad5b(0x1ce)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x1ce)],_0x471c0d[_0x17e56f][_0x57ad5b(0x180)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x233)],_0x471c0d[_0x17e56f]['warehouse_id']=_0x2f08d7['_id'][_0x57ad5b(0x114)](),_0x471c0d[_0x17e56f][_0x57ad5b(0x1ca)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x1e0)][_0x57ad5b(0x114)](),_0x471c0d[_0x17e56f][_0x57ad5b(0x165)]='out',_0x471c0d[_0x17e56f][_0x57ad5b(0x206)]=_0x2f08d7[_0x57ad5b(0x119)][_0x57ad5b(0x233)];}_0x471c0d[_0x17e56f]['outgoiug_inv']=_0x1b774b;}else for(let _0x25ab6d=0x0;_0x25ab6d<=_0x38676b[_0x57ad5b(0x215)]-0x1;_0x25ab6d++){const _0x2e9a29=_0x38676b[_0x25ab6d];let _0x2264c0=_0x2e9a29[_0x57ad5b(0x1b9)]('~');console[_0x57ad5b(0x132)](_0x2264c0);var _0x132141=_0x428bf7(_0x2264c0[0x0]),_0x1dc3b4=_0x428bf7(_0x2264c0[0x1]),_0x40ef22=_0x2264c0[0x2];const _0x389be5=await warehouse['aggregate']([{'$match':{'_id':_0x132141}},{'$unwind':_0x57ad5b(0x182)},{'$match':{'product_details._id':_0x1dc3b4}}]);await warehouse['updateOne']({'_id':_0x428bf7(_0x132141),'product_details._id':_0x428bf7(_0x1dc3b4)},{'$set':{'product_details.$.isUsed':_0x57ad5b(0x242)}}),_0x471c0d[_0x25ab6d]={};for(let _0x1f0271=0x0;_0x1f0271<=_0x389be5[_0x57ad5b(0x215)]-0x1;_0x1f0271++){const _0x2523ad=_0x389be5[_0x1f0271];_0x471c0d[_0x25ab6d][_0x57ad5b(0x157)]=_0x2523ad[_0x57ad5b(0x164)],_0x471c0d[_0x25ab6d]['product_id']=_0x2523ad[_0x57ad5b(0x119)]['product_id'],_0x471c0d[_0x25ab6d][_0x57ad5b(0x113)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x113)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x217)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x217)],_0x471c0d[_0x25ab6d]['product_stock']=_0x40ef22,_0x471c0d[_0x25ab6d][_0x57ad5b(0x1d9)]=_0x40ef22,_0x471c0d[_0x25ab6d][_0x57ad5b(0x11e)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x11e)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x134)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x134)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x23c)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x23c)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x166)]=_0x2523ad[_0x57ad5b(0x119)]['bay'],_0x471c0d[_0x25ab6d][_0x57ad5b(0x18c)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x18c)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x191)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x191)],_0x471c0d[_0x25ab6d]['maxStocks']=_0x2523ad['product_details']['maxStocks'],_0x471c0d[_0x25ab6d]['batch_code']=_0x2523ad['product_details'][_0x57ad5b(0x24e)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x245)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x245)],_0x471c0d[_0x25ab6d]['production_date']=_0x2523ad['product_details'][_0x57ad5b(0x120)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x202)]=_0x2523ad[_0x57ad5b(0x119)]['maxperunit'],_0x471c0d[_0x25ab6d][_0x57ad5b(0x229)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x229)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x1c4)]=_0x2523ad[_0x57ad5b(0x203)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x1c5)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x1c5)],_0x471c0d[_0x25ab6d]['uuid']=_0x2523ad[_0x57ad5b(0x119)]['uuid'],_0x471c0d[_0x25ab6d][_0x57ad5b(0x115)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x115)],_0x471c0d[_0x25ab6d]['sales_category']=_0x2523ad['product_details'][_0x57ad5b(0x233)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x1ce)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x1ce)],_0x471c0d[_0x25ab6d]['sales_id']=_0x2523ad['product_details'][_0x57ad5b(0x233)],_0x471c0d[_0x25ab6d][_0x57ad5b(0x148)]=_0x2523ad[_0x57ad5b(0x1e0)]['valueOf'](),_0x471c0d[_0x25ab6d][_0x57ad5b(0x1ca)]=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x1e0)][_0x57ad5b(0x114)](),_0x471c0d[_0x25ab6d]['data_type']='out',_0x471c0d[_0x25ab6d]['agent_id']=_0x2523ad[_0x57ad5b(0x119)][_0x57ad5b(0x233)];}_0x471c0d[_0x25ab6d][_0x57ad5b(0x236)]=_0x1b774b;}for(let _0x39826c=0x0;_0x39826c<=_0x471c0d[_0x57ad5b(0x215)]-0x1;_0x39826c++){const _0x17cb4c=_0x471c0d[_0x39826c],_0x5893e0=new warehouse_temporary(_0x17cb4c);await _0x5893e0['save']();}const _0x208bf3=new sales_finished({'invoice':_0x1b774b,'sales_data':_0x3b4f8a,'customer':_0x1fd5ef,'date':_0x438349,'warehouse_name':_0x2ff0b3,'sale_product':_0x471c0d,'note':_0xcaed8a,'finalize':'False','dateofreq':_0x5403e1,'PO_number':_0x5dc799,'typevehicle':_0xa7e09b,'deliverydate':_0x40e36c,'driver':_0x219039,'plate':_0xfb2807,'van':_0xac678,'DRSI':_0x37ea72,'TSU':_0x43343e,'TFU':_0x4fa063,'pullout_date':_0x35a471,'actualdelivery_date':_0x1321c1,'typeOfProducts':_0x57ad5b(0x15b)}),_0x1c8a39=await _0x208bf3[_0x57ad5b(0x230)]();_0x1af8a9[_0x57ad5b(0x15f)]('success',_0x57ad5b(0x17d)),_0x406cc5[_0x57ad5b(0x1ae)](_0x57ad5b(0x252)+_0x1c8a39[_0x57ad5b(0x1e0)]);}catch(_0x125101){console['log'](_0x125101);}}),module[a0_0x40efbc(0x13b)]=router;