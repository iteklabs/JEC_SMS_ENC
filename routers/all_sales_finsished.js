var a0_0x4f5d6d=a0_0x3f1c;(function(_0x5e0c65,_0x70b22e){var _0x166d2c=a0_0x3f1c,_0x3682fa=_0x5e0c65();while(!![]){try{var _0x4dce5a=-parseInt(_0x166d2c(0x15a))/0x1+parseInt(_0x166d2c(0x151))/0x2+parseInt(_0x166d2c(0x104))/0x3+-parseInt(_0x166d2c(0x94))/0x4+-parseInt(_0x166d2c(0x84))/0x5+-parseInt(_0x166d2c(0xea))/0x6+parseInt(_0x166d2c(0x75))/0x7;if(_0x4dce5a===_0x70b22e)break;else _0x3682fa['push'](_0x3682fa['shift']());}catch(_0x30995f){_0x3682fa['push'](_0x3682fa['shift']());}}}(a0_0x304a,0xdb085));function a0_0x3f1c(_0x5f3111,_0x468a02){var _0x304a01=a0_0x304a();return a0_0x3f1c=function(_0x3f1cba,_0x129bf2){_0x3f1cba=_0x3f1cba-0x6b;var _0x1f1b69=_0x304a01[_0x3f1cba];return _0x1f1b69;},a0_0x3f1c(_0x5f3111,_0x468a02);}const express=require(a0_0x4f5d6d(0xb6)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings,invoice_for_outgoing,sales_logs}=require(a0_0x4f5d6d(0xa8)),auth=require(a0_0x4f5d6d(0x12c)),nodemailer=require(a0_0x4f5d6d(0x16e)),users=require(a0_0x4f5d6d(0xff));router['get'](a0_0x4f5d6d(0x9c),auth,async(_0x220472,_0x4e3d0e)=>{var _0x1cbfe4=a0_0x4f5d6d;try{const {username:_0x1be8dd,email:_0x29b538,role:_0x7a7994}=_0x220472[_0x1cbfe4(0x14b)],_0x460107=_0x220472[_0x1cbfe4(0x14b)],_0x26446d=await profile[_0x1cbfe4(0xe4)]({'email':_0x460107[_0x1cbfe4(0x134)]}),_0x431be6=await master_shop[_0x1cbfe4(0x80)]();let _0x3c3951;if(_0x460107[_0x1cbfe4(0x12e)]==_0x1cbfe4(0x145)){const _0x46873d=await staff[_0x1cbfe4(0xe4)]({'email':_0x460107[_0x1cbfe4(0x134)]});_0x3c3951=await sales_finished[_0x1cbfe4(0x155)]([{'$match':{'typeOfProducts':_0x1cbfe4(0x136)}},{'$unwind':_0x1cbfe4(0x90)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':_0x1cbfe4(0xe2)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x1cbfe4(0x90)},'note':{'$first':_0x1cbfe4(0x176)},'return_data':{'$first':_0x1cbfe4(0x128)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x1cbfe4(0x125)},'level':{'$addToSet':_0x1cbfe4(0x131)},'isle':{'$addToSet':_0x1cbfe4(0x130)},'type':{'$addToSet':_0x1cbfe4(0xd7)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x1cbfe4(0x13b)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x3c3951=await sales_finished['aggregate']([{'$match':{'typeOfProducts':_0x1cbfe4(0x136)}},{'$unwind':_0x1cbfe4(0x90)},{'$group':{'_id':_0x1cbfe4(0xb1),'invoice':{'$first':_0x1cbfe4(0xbf)},'customers':{'$first':_0x1cbfe4(0xe2)},'date':{'$first':_0x1cbfe4(0x9e)},'warehouse_name':{'$first':_0x1cbfe4(0x89)},'sale_product':{'$push':_0x1cbfe4(0x90)},'note':{'$first':_0x1cbfe4(0x176)},'return_data':{'$first':_0x1cbfe4(0x128)},'customers_docs':{'$first':_0x1cbfe4(0x71)},'total_saleproduct_quantity':{'$sum':_0x1cbfe4(0x125)},'level':{'$addToSet':_0x1cbfe4(0x131)},'isle':{'$addToSet':_0x1cbfe4(0x130)},'type':{'$addToSet':_0x1cbfe4(0xd7)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x431be6[0x0][_0x1cbfe4(0x135)]==_0x1cbfe4(0x10a)){var _0x3c9bba=users['English'];console[_0x1cbfe4(0x114)](_0x3c9bba);}else{if(_0x431be6[0x0][_0x1cbfe4(0x135)]==_0x1cbfe4(0xd9))var _0x3c9bba=users[_0x1cbfe4(0xd9)];else{if(_0x431be6[0x0]['language']==_0x1cbfe4(0xba))var _0x3c9bba=users['German'];else{if(_0x431be6[0x0][_0x1cbfe4(0x135)]==_0x1cbfe4(0xd8))var _0x3c9bba=users['Spanish'];else{if(_0x431be6[0x0][_0x1cbfe4(0x135)]==_0x1cbfe4(0xed))var _0x3c9bba=users[_0x1cbfe4(0xed)];else{if(_0x431be6[0x0][_0x1cbfe4(0x135)]==_0x1cbfe4(0xe8))var _0x3c9bba=users['Portuguese'];else{if(_0x431be6[0x0][_0x1cbfe4(0x135)]==_0x1cbfe4(0xe6))var _0x3c9bba=users[_0x1cbfe4(0xe6)];else{if(_0x431be6[0x0][_0x1cbfe4(0x135)]==_0x1cbfe4(0x107))var _0x3c9bba=users[_0x1cbfe4(0x16a)];}}}}}}}_0x4e3d0e[_0x1cbfe4(0x17a)](_0x1cbfe4(0xd0),{'success':_0x220472[_0x1cbfe4(0xf4)](_0x1cbfe4(0x158)),'errors':_0x220472[_0x1cbfe4(0xf4)](_0x1cbfe4(0x183)),'sales':_0x3c3951,'profile':_0x26446d,'role':_0x460107,'master_shop':_0x431be6,'language':_0x3c9bba});}catch(_0x482eb5){console[_0x1cbfe4(0x114)](_0x482eb5);}}),router[a0_0x4f5d6d(0x11d)](a0_0x4f5d6d(0x100),auth,async(_0x16ce20,_0x15a3fc)=>{var _0x368b9a=a0_0x4f5d6d;try{const {username:_0x266b84,email:_0x3e2c4a,role:_0xf64e0b}=_0x16ce20[_0x368b9a(0x14b)],_0x23e544=_0x16ce20[_0x368b9a(0x14b)],_0x233119=await profile[_0x368b9a(0xe4)]({'email':_0x23e544[_0x368b9a(0x134)]}),_0x48d52c=await master_shop[_0x368b9a(0x80)]();let _0x5d19d5;if(_0x23e544[_0x368b9a(0x12e)]==_0x368b9a(0x145)){const _0xca8ca2=await staff[_0x368b9a(0xe4)]({'email':_0x23e544[_0x368b9a(0x134)]});_0x5d19d5=await sales_finished[_0x368b9a(0x155)]([{'$match':{'typeOfProducts':_0x368b9a(0x170)}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x368b9a(0xb1),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x368b9a(0xe2)},'date':{'$first':_0x368b9a(0x9e)},'warehouse_name':{'$first':_0x368b9a(0x89)},'sale_product':{'$push':_0x368b9a(0x90)},'note':{'$first':_0x368b9a(0x176)},'return_data':{'$first':_0x368b9a(0x128)},'customers_docs':{'$first':_0x368b9a(0x71)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x368b9a(0x130)},'type':{'$addToSet':_0x368b9a(0xd7)},'pallet':{'$addToSet':_0x368b9a(0x11b)},'finalize':{'$first':_0x368b9a(0x13b)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x5d19d5=await sales_finished[_0x368b9a(0x155)]([{'$match':{'typeOfProducts':_0x368b9a(0x170)}},{'$unwind':_0x368b9a(0x90)},{'$group':{'_id':_0x368b9a(0xb1),'invoice':{'$first':_0x368b9a(0xbf)},'customers':{'$first':_0x368b9a(0xe2)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x368b9a(0x89)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x368b9a(0x176)},'return_data':{'$first':_0x368b9a(0x128)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x368b9a(0x125)},'level':{'$addToSet':_0x368b9a(0x131)},'isle':{'$addToSet':_0x368b9a(0x130)},'type':{'$addToSet':_0x368b9a(0xd7)},'pallet':{'$addToSet':_0x368b9a(0x11b)},'finalize':{'$first':_0x368b9a(0x13b)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x48d52c[0x0][_0x368b9a(0x135)]==_0x368b9a(0x10a)){var _0x819387=users[_0x368b9a(0x14d)];console[_0x368b9a(0x114)](_0x819387);}else{if(_0x48d52c[0x0][_0x368b9a(0x135)]=='Hindi')var _0x819387=users['Hindi'];else{if(_0x48d52c[0x0]['language']==_0x368b9a(0xba))var _0x819387=users[_0x368b9a(0xba)];else{if(_0x48d52c[0x0]['language']==_0x368b9a(0xd8))var _0x819387=users[_0x368b9a(0xd8)];else{if(_0x48d52c[0x0][_0x368b9a(0x135)]==_0x368b9a(0xed))var _0x819387=users[_0x368b9a(0xed)];else{if(_0x48d52c[0x0][_0x368b9a(0x135)]=='Portuguese\x20(BR)')var _0x819387=users[_0x368b9a(0xc7)];else{if(_0x48d52c[0x0][_0x368b9a(0x135)]=='Chinese')var _0x819387=users['Chinese'];else{if(_0x48d52c[0x0]['language']=='Arabic\x20(ae)')var _0x819387=users[_0x368b9a(0x16a)];}}}}}}}_0x15a3fc[_0x368b9a(0x17a)](_0x368b9a(0x7a),{'success':_0x16ce20[_0x368b9a(0xf4)]('success'),'errors':_0x16ce20[_0x368b9a(0xf4)]('errors'),'sales':_0x5d19d5,'profile':_0x233119,'role':_0x23e544,'master_shop':_0x48d52c,'language':_0x819387});}catch(_0x586157){console[_0x368b9a(0x114)](_0x586157);}});async function getRandom8DigitNumber(){var _0x5db51f=a0_0x4f5d6d;const _0x4aabea=0x989680,_0x46d875=0x5f5e0ff,_0x569597=Math['floor'](Math[_0x5db51f(0x166)]()*(_0x46d875-_0x4aabea+0x1))+_0x4aabea;var _0x4ab833;const _0x174c0e=await sales_finished['findOne']({'invoice':_0x5db51f(0x101)+_0x569597});return _0x174c0e&&_0x174c0e[_0x5db51f(0x78)]>0x0?_0x4ab833=_0x5db51f(0x101)+_0x569597:_0x4ab833=_0x5db51f(0x101)+_0x569597,_0x4ab833;}function a0_0x304a(){var _0x4d8e4a=['Hindi','bay','all','prod_invoice','</thead>','agent_id','\x20==\x20','product_stock','filter','$customer','level2','findOne','json','Chinese','$product_details.maxProducts','Portuguese\x20(BR)','outgoing_invoice','6083982KbDywO','$product_details.expiry_date','suppliers','French','forEach','product_list','product','date_data','createTransport','unit_QA','flash','add\x20post','Enabled','match','$product_details.invoice','$product_details.floorlevel','getMonth','$product_details.uuid','$product_details.product_cat','$product_details.product_name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','../public/language/languages.json','/view_log','OUTF-','return_sale_QA','sales\x20item\x20return\x20successfull','401514MuaEEA','/../public','edit_sales_finished_view','Arabic\x20(ae)','primary_code','<h2>\x20','English\x20(US)','message','product_code','\x20</h2>','</h5>','$product_details.sales_category','$product_details','maxPerUnit_QA','Sale\x20Return','return_qty','log','$product_details._id','invoice','<tbody\x20style=\x22text-align:\x20center;\x22>','note','\x20&&\x20','/preview/:id','$sale_product.floorlevel','warehouse','get','True','customer','slice','product_name_QA1','concat','LOG-OUT-','$product_details.level','$sale_product.quantity','maxperunit','prod_code','$return_data','/view/add_sales_logs','image','</div>','../middleware/auth','sendMail','role','Ambient','$sale_product.bin','$sale_product.bay','params','$product_details.storage','email','language','own','secondary_code_QA','maxPerUnit','level','getFullYear','$finalize','gross_price','push','$product_details.production_date','production_date','sales','valueOf','id_transaction_from','secondary_unit','Email\x20sent\x20successfully','staff','split','received_amount','/barcode/:id','$product_details.bin','padStart','user','$product_details.secondary_unit','English','/view/add_sale/product','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','return_data','538410KFoKuB','$room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','gmail','aggregate','/all_sales_finished/preview/','redirect','success','$product_details.primary_code','986969TzsxEf','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','back','due_amount','carton','edit_sales_finished','Logo.png','expiry_date_QA','sale_product','post','$name','return_sale','random','add_sales_finished_logs','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','all_sales_barcode','Arabic','secondary_code','/barcode_scanner_logs','<div>','nodemailer','warehouse_name','logs','/view/:id','$product_details.type_products','product_name','Sales\x20Update\x20successfully','unit','$note','return_qty_QA','for_categorize','max','render','primary_unit','findById','product_code_QA','final','<!DOCTYPE\x20html>','OUT-','catch','room_name','errors','warehouse_id','sales_quantity','$product_details.maxPerUnit','<h5\x20style=\x22text-align:\x20left;\x22>','Sale\x20Return\x20Mail','getDate','body','batch_code_QA','</table>','$customers_docs','uuid','product_details','<h5>','32662672pqKfql','secondary_unit_QA','product_date','length','<table\x20style=\x22width:\x20100%\x20!important;\x22>','all_sales_finished_logs','</head><body>','$product_details.product_code','exports','$product_details.product_stock','/all_sales_finished/view','find','<tr>','/upload/','sales_quantity_QA','8836200RRMWzj','quantity','toString','status','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$warehouse_name','product_data','Sales\x20Add\x20successfully','Finished\x20Goods','string','<html><head><title></title>','/invoice/:id','$sale_product','RoomAssigned','amount','production_date_QA','1615104qcKzDN','updateOne','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','_id','max_per_unit','stock','</span>','/view','expiry_date','$date','map','Quality\x20Inspection','adjust_qty','\x20Order\x20Number\x20:\x20','date','save','sale_qty','Error\x20Occurs','$product_details.gross_price','../models/all_models','finalize','<strong>\x20Regards\x20</strong>','<hr\x20class=\x22my-3\x22>','customer_data','prod_cat','barcode\x20user_id','invoice_init','</tbody>','$_id','/view/return_sales/:id','/give_payment/:id','currency','</body></html>','express','\x20<>\x20','$product_details.unit','</td>','German','logo','$product_details.type','/picking_list/pdf/','$product_details.secondary_code','$invoice','batch_code','</tr>','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','add_sales_finished','int','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Portuguese','primary_code_QA','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.rack','master','maxProducts','maxProducts_QA','abs','$product_details.batch_code','all_sales_finished','\x20Order\x20Date\x20:\x20','then','site_title','Enclosed','Return\x20Rooms','room','$sale_product.type','Spanish'];a0_0x304a=function(){return _0x4d8e4a;};return a0_0x304a();}router[a0_0x4f5d6d(0x11d)]('/view/add_sales',auth,async(_0x152813,_0x3ca60f)=>{var _0x147092=a0_0x4f5d6d;try{const {username:_0x5cbd39,email:_0x23d1f4,role:_0x2a5ea8}=_0x152813[_0x147092(0x14b)],_0xd1ff66=_0x152813[_0x147092(0x14b)],_0x4ddab0=await profile['findOne']({'email':_0xd1ff66[_0x147092(0x134)]}),_0x5b1216=await master_shop[_0x147092(0x80)](),_0x168c56=await customer[_0x147092(0x80)]({});let _0xa7204f;if(_0xd1ff66[_0x147092(0x12e)]==_0x147092(0x145)){const _0x905a9a=await staff[_0x147092(0xe4)]({'email':_0xd1ff66['email']});_0xa7204f=await warehouse[_0x147092(0x155)]([{'$match':{'status':_0x147092(0xf6),'name':_0x905a9a[_0x147092(0x11c)]}},{'$group':{'_id':_0x147092(0x164),'name':{'$first':_0x147092(0x164)}}},{'$sort':{'name':0x1}}]);}else _0xa7204f=await warehouse['aggregate']([{'$match':{'status':_0x147092(0xf6)}},{'$group':{'_id':_0x147092(0x164),'name':{'$first':_0x147092(0x164)}}},{'$sort':{'name':0x1}}]);const _0x143f58=await product[_0x147092(0x80)]({});var _0x2d5ad5=[_0x147092(0x12f),'Enclosed'];const _0x50495b=await sales_finished[_0x147092(0x80)]({}),_0x199115=_0x50495b[_0x147092(0x78)]+0x1,_0x14f14d='OUTF-'+_0x199115[_0x147092(0x86)]()['padStart'](0x5,'0');if(_0x5b1216[0x0][_0x147092(0x135)]==_0x147092(0x10a)){var _0x1c03d1=users[_0x147092(0x14d)];console[_0x147092(0x114)](_0x1c03d1);}else{if(_0x5b1216[0x0][_0x147092(0x135)]==_0x147092(0xd9))var _0x1c03d1=users['Hindi'];else{if(_0x5b1216[0x0][_0x147092(0x135)]==_0x147092(0xba))var _0x1c03d1=users['German'];else{if(_0x5b1216[0x0]['language']=='Spanish')var _0x1c03d1=users[_0x147092(0xd8)];else{if(_0x5b1216[0x0]['language']=='French')var _0x1c03d1=users[_0x147092(0xed)];else{if(_0x5b1216[0x0][_0x147092(0x135)]=='Portuguese\x20(BR)')var _0x1c03d1=users[_0x147092(0xc7)];else{if(_0x5b1216[0x0][_0x147092(0x135)]==_0x147092(0xe6))var _0x1c03d1=users[_0x147092(0xe6)];else{if(_0x5b1216[0x0]['language']==_0x147092(0x107))var _0x1c03d1=users[_0x147092(0x16a)];}}}}}}}const _0x3e50b2=getRandom8DigitNumber();_0x3e50b2[_0x147092(0xd2)](_0x1c60ab=>{var _0x586f02=_0x147092;_0x3ca60f['render'](_0x586f02(0xc4),{'success':_0x152813[_0x586f02(0xf4)](_0x586f02(0x158)),'errors':_0x152813[_0x586f02(0xf4)]('errors'),'role':_0xd1ff66,'profile':_0x4ddab0,'customer':_0x168c56,'warehouse':_0xa7204f,'product':_0x143f58,'invoice':_0x1c60ab,'master_shop':_0x5b1216,'language':_0x1c03d1,'rooms_data':_0x2d5ad5});})['catch'](_0x1aa050=>{var _0x3dfcc5=_0x147092;_0x152813[_0x3dfcc5(0xf4)](_0x3dfcc5(0x183),_0x3dfcc5(0xfe)),_0x3ca60f[_0x3dfcc5(0x157)](_0x3dfcc5(0x7f));});}catch(_0x5909bb){console[_0x147092(0x114)](_0x5909bb);}}),router['get']('/view/add_sales_logs',auth,async(_0x4ebdbc,_0x2e1046)=>{var _0x1013dd=a0_0x4f5d6d;try{const {username:_0x26498d,email:_0x12066a,role:_0x5af320}=_0x4ebdbc['user'],_0x549988=_0x4ebdbc['user'],_0x2051e4=await profile[_0x1013dd(0xe4)]({'email':_0x549988[_0x1013dd(0x134)]}),_0x547198=await master_shop[_0x1013dd(0x80)](),_0x4b2771=await customer[_0x1013dd(0x80)]({});let _0x709ff9;if(_0x549988[_0x1013dd(0x12e)]==_0x1013dd(0x145)){const _0x136385=await staff[_0x1013dd(0xe4)]({'email':_0x549988[_0x1013dd(0x134)]});_0x709ff9=await warehouse['aggregate']([{'$match':{'status':_0x1013dd(0xf6),'name':_0x136385[_0x1013dd(0x11c)]}},{'$group':{'_id':_0x1013dd(0x164),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x709ff9=await warehouse['aggregate']([{'$match':{'status':_0x1013dd(0xf6)}},{'$group':{'_id':_0x1013dd(0x164),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x196a8d=await product[_0x1013dd(0x80)]({});var _0x2281cc=['Ambient',_0x1013dd(0xd4)];const _0xaa5d13=await sales_finished[_0x1013dd(0x80)]({}),_0x55e21b=_0xaa5d13['length']+0x1,_0x5412d2=_0x1013dd(0x101)+_0x55e21b['toString']()[_0x1013dd(0x14a)](0x5,'0');if(_0x547198[0x0][_0x1013dd(0x135)]=='English\x20(US)'){var _0x294f54=users['English'];console[_0x1013dd(0x114)](_0x294f54);}else{if(_0x547198[0x0]['language']=='Hindi')var _0x294f54=users[_0x1013dd(0xd9)];else{if(_0x547198[0x0][_0x1013dd(0x135)]==_0x1013dd(0xba))var _0x294f54=users['German'];else{if(_0x547198[0x0][_0x1013dd(0x135)]==_0x1013dd(0xd8))var _0x294f54=users[_0x1013dd(0xd8)];else{if(_0x547198[0x0][_0x1013dd(0x135)]==_0x1013dd(0xed))var _0x294f54=users[_0x1013dd(0xed)];else{if(_0x547198[0x0][_0x1013dd(0x135)]==_0x1013dd(0xe8))var _0x294f54=users[_0x1013dd(0xc7)];else{if(_0x547198[0x0][_0x1013dd(0x135)]=='Chinese')var _0x294f54=users['Chinese'];else{if(_0x547198[0x0][_0x1013dd(0x135)]==_0x1013dd(0x107))var _0x294f54=users[_0x1013dd(0x16a)];}}}}}}}const _0x809fae=getRandom8DigitNumber();_0x809fae[_0x1013dd(0xd2)](_0x52f6f5=>{var _0xf584fe=_0x1013dd;_0x2e1046[_0xf584fe(0x17a)](_0xf584fe(0x167),{'success':_0x4ebdbc['flash'](_0xf584fe(0x158)),'errors':_0x4ebdbc[_0xf584fe(0xf4)](_0xf584fe(0x183)),'role':_0x549988,'profile':_0x2051e4,'customer':_0x4b2771,'warehouse':_0x709ff9,'product':_0x196a8d,'invoice':_0x52f6f5,'master_shop':_0x547198,'language':_0x294f54,'rooms_data':_0x2281cc});})[_0x1013dd(0x181)](_0x3ce115=>{var _0x3abe3c=_0x1013dd;_0x4ebdbc['flash']('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2e1046[_0x3abe3c(0x157)](_0x3abe3c(0x7f));});}catch(_0x4bbd49){console[_0x1013dd(0x114)](_0x4bbd49);}}),router[a0_0x4f5d6d(0x163)](a0_0x4f5d6d(0x129),auth,async(_0x587d27,_0x486e30)=>{var _0x23406d=a0_0x4f5d6d;try{const {invoice:_0x23499f,date:_0x4bbd6b,warehouse_name:_0x18e8df,product_name:_0x4433ae,note:_0x1870a9,room:_0x346f30,primary_code:_0x28e6d1,secondary_code:_0x43190c,prod_code:_0x534cc3,SCRN:_0x123c35,ReqBy:_0x531012,dateofreq:_0x1113d3,PO_number:_0x453fff,typeservicesData:_0x4c4962,typevehicle:_0x4bd211,destination:_0x5a2703,deliverydate:_0x4d21cc,driver:_0x240ae3,plate:_0x1662b8,van:_0x1efa0d,DRSI:_0x53b1ae,TSU:_0x57cf9d,TFU:_0x11a8d3,mode_transpo:_0x495827,name_driver:_0x5e9add,type_of_products:_0xf0cabd}=_0x587d27[_0x23406d(0x6e)];if(typeof _0x4433ae=='string')var _0x1fa6b0=[_0x587d27['body'][_0x23406d(0x173)]],_0x3d0259=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x9a)]],_0x28392f=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x15e)]],_0x5f2d95=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x108)]],_0x2bb579=[_0x587d27[_0x23406d(0x6e)]['secondary_code']],_0x144e5d=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x127)]],_0x44e37a=[_0x587d27['body'][_0x23406d(0xe3)]],_0x2f9a29=[_0x587d27['body']['primary_unit']],_0x3f217e=[_0x587d27[_0x23406d(0x6e)]['secondary_unit']],_0x28fcd3=[_0x587d27['body'][_0x23406d(0xc0)]],_0x1b77a7=[_0x587d27['body'][_0x23406d(0x9d)]],_0x329a83=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x77)]],_0x57aa2e=[_0x587d27['body']['max_per_unit']],_0x3ccddc=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0xad)]],_0x3e137e=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x91)]],_0x69f9ea=[_0x587d27[_0x23406d(0x6e)]['prod_invoice']],_0x2e7130=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x142)]],_0x260ee1=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x72)]],_0x286567=[_0x587d27[_0x23406d(0x6e)][_0x23406d(0x13c)]];else var _0x1fa6b0=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x173)]],_0x3d0259=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x9a)]],_0x28392f=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x15e)]],_0x5f2d95=[..._0x587d27['body'][_0x23406d(0x108)]],_0x2bb579=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x16b)]],_0x144e5d=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x127)]],_0x44e37a=[..._0x587d27[_0x23406d(0x6e)]['level2']],_0x2f9a29=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x17b)]],_0x3f217e=[..._0x587d27['body'][_0x23406d(0x143)]],_0x28fcd3=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0xc0)]],_0x1b77a7=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x9d)]],_0x329a83=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x77)]],_0x57aa2e=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x99)]],_0x3ccddc=[..._0x587d27['body'][_0x23406d(0xad)]],_0x3e137e=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0x91)]],_0x69f9ea=[..._0x587d27[_0x23406d(0x6e)][_0x23406d(0xdc)]],_0x2e7130=[..._0x587d27['body']['id_transaction_from']],_0x260ee1=[..._0x587d27['body']['uuid']],_0x286567=[..._0x587d27[_0x23406d(0x6e)]['gross_price']];const _0x431dee=_0x1fa6b0[_0x23406d(0x9f)](_0x112d55=>{return _0x112d55={'product_name':_0x112d55};});_0x3d0259['forEach']((_0x83daaa,_0x32d2f1)=>{var _0x1116aa=_0x23406d;_0x431dee[_0x32d2f1][_0x1116aa(0x9a)]=_0x83daaa;}),_0x28392f[_0x23406d(0xee)]((_0x36ce15,_0x1d90dd)=>{var _0x28e101=_0x23406d;_0x431dee[_0x1d90dd]['quantity']=Math[_0x28e101(0xce)](_0x36ce15);}),_0x1fa6b0[_0x23406d(0xee)]((_0x544300,_0x5f49bd)=>{var _0x15c172=_0x23406d;_0x431dee[_0x5f49bd][_0x15c172(0xde)]=_0x587d27[_0x15c172(0x6e)][_0x15c172(0x140)];}),_0x286567[_0x23406d(0xee)]((_0x533896,_0x7f7113)=>{_0x431dee[_0x7f7113]['gross_price']=_0x533896;}),_0x260ee1[_0x23406d(0xee)]((_0x22192a,_0x4167de)=>{_0x431dee[_0x4167de]['uuid']=_0x22192a;}),_0x2e7130[_0x23406d(0xee)]((_0x13437b,_0x10e455)=>{var _0x4b80bf=_0x23406d;_0x431dee[_0x10e455][_0x4b80bf(0x142)]=_0x13437b;}),_0x5f2d95[_0x23406d(0xee)]((_0x14b969,_0x3838b2)=>{var _0xfce674=_0x23406d;_0x431dee[_0x3838b2][_0xfce674(0x108)]=_0x14b969;}),_0x2bb579[_0x23406d(0xee)]((_0x11d5a2,_0xa6119c)=>{var _0x1d8455=_0x23406d;_0x431dee[_0xa6119c][_0x1d8455(0x16b)]=_0x11d5a2;}),_0x144e5d[_0x23406d(0xee)]((_0x41d062,_0x57a3cc)=>{_0x431dee[_0x57a3cc]['product_code']=_0x41d062;}),_0x44e37a['forEach']((_0x278e9e,_0x73e254)=>{var _0xedae33=_0x23406d,_0x5a06e0=_0x278e9e[_0xedae33(0xf7)](/[A-Za-z]+/)[0x0],_0x3288a1=parseInt(_0x278e9e['match'](/\d+/)[0x0]);_0x431dee[_0x73e254][_0xedae33(0xda)]=_0x3288a1,_0x431dee[_0x73e254][_0xedae33(0x139)]=_0x5a06e0;}),_0x2f9a29[_0x23406d(0xee)]((_0x16a05a,_0x3730f1)=>{var _0x166656=_0x23406d;_0x431dee[_0x3730f1][_0x166656(0x175)]=_0x16a05a;}),_0x3f217e['forEach']((_0x45ebb4,_0x3a3428)=>{var _0x40b38e=_0x23406d;_0x431dee[_0x3a3428][_0x40b38e(0x143)]=_0x45ebb4;}),_0x28fcd3[_0x23406d(0xee)]((_0x26f208,_0x2cbbbd)=>{var _0x7e8227=_0x23406d;_0x431dee[_0x2cbbbd][_0x7e8227(0xc0)]=_0x26f208;}),_0x1b77a7[_0x23406d(0xee)]((_0x12148e,_0x53fc08)=>{var _0x574355=_0x23406d;_0x431dee[_0x53fc08][_0x574355(0x9d)]=_0x12148e;}),_0x329a83[_0x23406d(0xee)]((_0x3bf4cf,_0x224ee4)=>{_0x431dee[_0x224ee4]['production_date']=_0x3bf4cf;}),_0x57aa2e['forEach']((_0x458b49,_0xb325b3)=>{var _0x139660=_0x23406d;_0x431dee[_0xb325b3][_0x139660(0x126)]=_0x458b49;}),_0x3ccddc[_0x23406d(0xee)]((_0x592d71,_0x2a6281)=>{var _0xd7c1a6=_0x23406d;_0x431dee[_0x2a6281][_0xd7c1a6(0xad)]=_0x592d71;}),_0x3e137e['forEach']((_0x12bb9d,_0x4c6485)=>{_0x431dee[_0x4c6485]['room_name']=_0x12bb9d;}),_0x69f9ea[_0x23406d(0xee)]((_0xe37990,_0x293402)=>{var _0x4e4e8b=_0x23406d;_0x431dee[_0x293402][_0x4e4e8b(0x116)]=_0xe37990,_0x431dee[_0x293402]['date_data']=_0x4bbd6b;});const _0x231715=new sales_logs();await _0x231715['save'](),_0x69f9ea['forEach']((_0x462678,_0x4bf427)=>{var _0x420ba5=_0x23406d;_0x431dee[_0x4bf427][_0x420ba5(0xe9)]=_0x420ba5(0x123)+_0x231715[_0x420ba5(0xaf)][_0x420ba5(0x86)]()['padStart'](0x8,'0');});var _0x2f44db=0x0;_0x431dee[_0x23406d(0xee)](_0x1b6ccf=>{var _0x255df2=_0x23406d;parseFloat(_0x1b6ccf[_0x255df2(0x9a)])<parseFloat(_0x1b6ccf['quantity'])&&parseFloat(_0x1b6ccf[_0x255df2(0x85)])>parseFloat(_0x1b6ccf[_0x255df2(0x9a)])&&(console[_0x255df2(0x114)](_0x1b6ccf[_0x255df2(0x9a)]+_0x255df2(0xb7)+_0x1b6ccf[_0x255df2(0x85)]),_0x2f44db++);});if(_0x2f44db!=0x0)return _0x587d27['flash'](_0x23406d(0x183),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x486e30[_0x23406d(0x157)](_0x23406d(0x15c));const _0x62c9c2=_0x431dee[_0x23406d(0xe1)](_0x1cc8fa=>_0x1cc8fa['quantity']!=='0'&&_0x1cc8fa[_0x23406d(0x85)]!==''),_0x17e99a=new sales_finished({'invoice':_0x23406d(0x123)+_0x231715['invoice_init'][_0x23406d(0x86)]()['padStart'](0x8,'0'),'sales_data':_0x587d27[_0x23406d(0x6e)][_0x23406d(0x140)],'customer':_0x587d27[_0x23406d(0x6e)][_0x23406d(0x11f)],'date':_0x4bbd6b,'warehouse_name':_0x18e8df,'sale_product':_0x62c9c2,'note':_0x1870a9,'room':_0x346f30,'primary_code':_0x28e6d1,'secondary_code':_0x43190c,'prod_code':_0x534cc3,'SCRN':_0x123c35,'finalize':'False','mode_transpo':_0x495827,'name_driver':_0x5e9add,'ReqBy':_0x531012,'dateofreq':_0x1113d3,'PO_number':_0x453fff,'typeservicesData':_0x4c4962,'typevehicle':_0x4bd211,'destination':_0x5a2703,'deliverydate':_0x4d21cc,'driver':_0x240ae3,'plate':_0x1662b8,'van':_0x1efa0d,'DRSI':_0x53b1ae,'TSU':_0x57cf9d,'TFU':_0x11a8d3,'typeOfProducts':_0xf0cabd}),_0x8dbb57=await _0x17e99a[_0x23406d(0xa4)](),_0x2c78d1=await sales_finished['findOne']({'invoice':_0x23499f});_0x587d27[_0x23406d(0xf4)](_0x23406d(0x158),_0x23406d(0x8b)),_0x486e30[_0x23406d(0x157)](_0x23406d(0x156)+_0x8dbb57[_0x23406d(0x98)]);}catch(_0x18a008){console[_0x23406d(0x114)](_0x18a008);}}),router[a0_0x4f5d6d(0x11d)]('/view/add_sales/:id',auth,async(_0x308368,_0x2593da)=>{var _0x4dfbfd=a0_0x4f5d6d;try{const _0x13ea4d=_0x308368[_0x4dfbfd(0x132)]['id'];console[_0x4dfbfd(0x114)](_0x13ea4d);const _0xda28d8=await product[_0x4dfbfd(0x80)](),_0x3d6832=await purchases[_0x4dfbfd(0x155)]([{'$match':{'warehouse_name':_0x13ea4d}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]);console[_0x4dfbfd(0x114)]('purchases_data',_0x3d6832),_0x2593da[_0x4dfbfd(0x87)](0xc8)['json']({'purchases_data':_0x3d6832,'product_data':_0xda28d8});}catch(_0x5aa5c4){console[_0x4dfbfd(0x114)](_0x5aa5c4);}}),router[a0_0x4f5d6d(0x163)](a0_0x4f5d6d(0x14e),auth,async(_0x1ef4a5,_0x1e87ec)=>{var _0x379574=a0_0x4f5d6d;try{const {warehouse_data:_0x150294,product_data:_0x156bab}=_0x1ef4a5[_0x379574(0x6e)];console[_0x379574(0x114)](_0x1ef4a5['body'][_0x379574(0x8a)]);;const _0x5dc166=await master_shop[_0x379574(0x80)]();console[_0x379574(0x114)](_0x379574(0xcb),_0x5dc166);const _0x27ba0a=await product[_0x379574(0xe4)]({'name':_0x156bab});console['log'](_0x379574(0xf0),_0x27ba0a);const _0x34d6f6=await warehouse[_0x379574(0x155)]([{'$match':{'name':_0x150294}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x156bab}},{'$group':{'_id':_0x379574(0xfd),'product_stock':{'$first':_0x379574(0x7e)}}}]);console[_0x379574(0x114)]('stock_data',_0x34d6f6),_0x1e87ec[_0x379574(0x87)](0xc8)[_0x379574(0xe5)]({'master':_0x5dc166,'new_product':_0x27ba0a,'stock_data':_0x34d6f6});}catch(_0x385ba1){console[_0x379574(0x114)](_0x385ba1);}}),router[a0_0x4f5d6d(0x163)]('/view/add_sales',auth,async(_0x28f6f1,_0x260b60)=>{var _0x33ced1=a0_0x4f5d6d;try{const {invoice:_0x3f4179,date:_0x2576c8,warehouse_name:_0x18c2e5,product_name:_0x1b6a71,note:_0x5e388d,room:_0x57c3ca,primary_code:_0x4f792e,secondary_code:_0x594c67,prod_code:_0x104294,SCRN:_0x3d40de,ReqBy:_0xfa0c5a,dateofreq:_0x2f3b7e,PO_number:_0x730d1d,typeservicesData:_0x511bae,typevehicle:_0xeff563,destination:_0x49bf41,deliverydate:_0xf23ca,driver:_0x1c380e,plate:_0x5b36b8,van:_0x23321f,DRSI:_0xa02b76,TSU:_0x424df6,TFU:_0x876aba,mode_transpo:_0x430383,name_driver:_0x1982df,pull_out_date:_0x152b68,actual_delivery_date:_0x25d1ea}=_0x28f6f1[_0x33ced1(0x6e)];if(typeof _0x1b6a71==_0x33ced1(0x8d))var _0x4e1c2e=[_0x28f6f1[_0x33ced1(0x6e)]['product_name']],_0x2b6871=[_0x28f6f1['body'][_0x33ced1(0x9a)]],_0x52beac=[_0x28f6f1['body'][_0x33ced1(0x15e)]],_0x44eafd=[_0x28f6f1[_0x33ced1(0x6e)]['primary_code']],_0x938c2a=[_0x28f6f1['body'][_0x33ced1(0x16b)]],_0x26edd5=[_0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x127)]],_0x13508d=[_0x28f6f1['body'][_0x33ced1(0xe3)]],_0x3abe49=[_0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x17b)]],_0x5ca3c2=[_0x28f6f1['body'][_0x33ced1(0x143)]],_0x53849a=[_0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0xc0)]],_0x4296e3=[_0x28f6f1['body'][_0x33ced1(0x9d)]],_0x275c24=[_0x28f6f1['body'][_0x33ced1(0x77)]],_0x25721b=[_0x28f6f1[_0x33ced1(0x6e)]['max_per_unit']],_0x44a410=[_0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0xad)]],_0x285dc2=[_0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x91)]],_0x1b0fc7=[_0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0xdc)]],_0x438896=[_0x28f6f1['body'][_0x33ced1(0x142)]],_0x4f7c77=[_0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x72)]],_0x43a3a4=[_0x28f6f1[_0x33ced1(0x6e)]['gross_price']];else var _0x4e1c2e=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x173)]],_0x2b6871=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x9a)]],_0x52beac=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x15e)]],_0x44eafd=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x108)]],_0x938c2a=[..._0x28f6f1[_0x33ced1(0x6e)]['secondary_code']],_0x26edd5=[..._0x28f6f1[_0x33ced1(0x6e)]['prod_code']],_0x13508d=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0xe3)]],_0x3abe49=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x17b)]],_0x5ca3c2=[..._0x28f6f1[_0x33ced1(0x6e)]['secondary_unit']],_0x53849a=[..._0x28f6f1['body'][_0x33ced1(0xc0)]],_0x4296e3=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x9d)]],_0x275c24=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x77)]],_0x25721b=[..._0x28f6f1['body'][_0x33ced1(0x99)]],_0x44a410=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0xad)]],_0x285dc2=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x91)]],_0x1b0fc7=[..._0x28f6f1['body'][_0x33ced1(0xdc)]],_0x438896=[..._0x28f6f1['body']['id_transaction_from']],_0x4f7c77=[..._0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x72)]],_0x43a3a4=[..._0x28f6f1['body'][_0x33ced1(0x13c)]];const _0x1fd0ae=_0x4e1c2e[_0x33ced1(0x9f)](_0x26f390=>{return _0x26f390={'product_name':_0x26f390};});_0x2b6871[_0x33ced1(0xee)]((_0x523475,_0x3b25c3)=>{var _0x56e6b2=_0x33ced1;_0x1fd0ae[_0x3b25c3][_0x56e6b2(0x9a)]=_0x523475;}),_0x52beac['forEach']((_0x24e7ad,_0x25c8c0)=>{var _0x2b6e30=_0x33ced1;_0x1fd0ae[_0x25c8c0][_0x2b6e30(0x85)]=Math[_0x2b6e30(0xce)](_0x24e7ad);}),_0x4e1c2e[_0x33ced1(0xee)]((_0x19166f,_0x2e76e6)=>{var _0x4d4f53=_0x33ced1;_0x1fd0ae[_0x2e76e6][_0x4d4f53(0xde)]=_0x28f6f1[_0x4d4f53(0x6e)][_0x4d4f53(0x140)];}),_0x43a3a4[_0x33ced1(0xee)]((_0x2dbc40,_0x39a837)=>{var _0x586de5=_0x33ced1;_0x1fd0ae[_0x39a837][_0x586de5(0x13c)]=_0x2dbc40;}),_0x4f7c77['forEach']((_0x3cd6d4,_0x36d52f)=>{var _0x34e850=_0x33ced1;_0x1fd0ae[_0x36d52f][_0x34e850(0x72)]=_0x3cd6d4;}),_0x438896['forEach']((_0x4e1cad,_0x29ce9a)=>{var _0x4efc44=_0x33ced1;_0x1fd0ae[_0x29ce9a][_0x4efc44(0x142)]=_0x4e1cad;}),_0x44eafd['forEach']((_0x46a5b7,_0x53f9c2)=>{var _0x8860dd=_0x33ced1;_0x1fd0ae[_0x53f9c2][_0x8860dd(0x108)]=_0x46a5b7;}),_0x938c2a[_0x33ced1(0xee)]((_0xb2bcb,_0x24d972)=>{var _0x4bd96b=_0x33ced1;_0x1fd0ae[_0x24d972][_0x4bd96b(0x16b)]=_0xb2bcb;}),_0x26edd5[_0x33ced1(0xee)]((_0x10d4c,_0x3bd06e)=>{var _0x478da0=_0x33ced1;_0x1fd0ae[_0x3bd06e][_0x478da0(0x10c)]=_0x10d4c;}),_0x13508d[_0x33ced1(0xee)]((_0x5e13e6,_0x12da33)=>{var _0x10f036=_0x33ced1,_0x2241a1=_0x5e13e6[_0x10f036(0xf7)](/[A-Za-z]+/)[0x0],_0x5ea0c2=parseInt(_0x5e13e6['match'](/\d+/)[0x0]);_0x1fd0ae[_0x12da33][_0x10f036(0xda)]=_0x5ea0c2,_0x1fd0ae[_0x12da33][_0x10f036(0x139)]=_0x2241a1;}),_0x3abe49[_0x33ced1(0xee)]((_0xdd8a6c,_0x57e18f)=>{var _0x4b4c8d=_0x33ced1;_0x1fd0ae[_0x57e18f][_0x4b4c8d(0x175)]=_0xdd8a6c;}),_0x5ca3c2['forEach']((_0xc4fb78,_0x349e66)=>{var _0x2b88b3=_0x33ced1;_0x1fd0ae[_0x349e66][_0x2b88b3(0x143)]=_0xc4fb78;}),_0x53849a[_0x33ced1(0xee)]((_0x18180d,_0x556ec0)=>{var _0x57d03d=_0x33ced1;_0x1fd0ae[_0x556ec0][_0x57d03d(0xc0)]=_0x18180d;}),_0x4296e3[_0x33ced1(0xee)]((_0x2007d8,_0x12909f)=>{var _0x454210=_0x33ced1;_0x1fd0ae[_0x12909f][_0x454210(0x9d)]=_0x2007d8;}),_0x275c24[_0x33ced1(0xee)]((_0x1ecbe1,_0x1b05f5)=>{var _0x62f460=_0x33ced1;_0x1fd0ae[_0x1b05f5][_0x62f460(0x13f)]=_0x1ecbe1;}),_0x25721b[_0x33ced1(0xee)]((_0x503e58,_0x469646)=>{var _0x1d6b73=_0x33ced1;_0x1fd0ae[_0x469646][_0x1d6b73(0x126)]=_0x503e58;}),_0x44a410[_0x33ced1(0xee)]((_0x2beb3a,_0x28dcbe)=>{_0x1fd0ae[_0x28dcbe]['prod_cat']=_0x2beb3a;}),_0x285dc2['forEach']((_0x532567,_0x57b6b3)=>{var _0x312c60=_0x33ced1;_0x1fd0ae[_0x57b6b3][_0x312c60(0x182)]=_0x532567;}),_0x1b0fc7[_0x33ced1(0xee)]((_0x5be30d,_0x2465c0)=>{var _0x4d56c4=_0x33ced1;_0x1fd0ae[_0x2465c0][_0x4d56c4(0x116)]=_0x5be30d,_0x1fd0ae[_0x2465c0][_0x4d56c4(0xf1)]=_0x2576c8;});const _0x2ac368=new invoice_for_outgoing();await _0x2ac368[_0x33ced1(0xa4)](),_0x1b0fc7['forEach']((_0x281162,_0xc20422)=>{var _0x32d69a=_0x33ced1;_0x1fd0ae[_0xc20422]['outgoing_invoice']=_0x32d69a(0x180)+_0x2ac368['invoice_init'][_0x32d69a(0x86)]()[_0x32d69a(0x14a)](0x8,'0');});var _0x340d28=0x0;_0x1fd0ae[_0x33ced1(0xee)](_0x2f2469=>{var _0x201849=_0x33ced1;parseFloat(_0x2f2469[_0x201849(0x9a)])<parseFloat(_0x2f2469[_0x201849(0x85)])&&parseFloat(_0x2f2469[_0x201849(0x85)])>parseFloat(_0x2f2469[_0x201849(0x9a)])&&(console[_0x201849(0x114)](_0x2f2469['stock']+_0x201849(0xb7)+_0x2f2469[_0x201849(0x85)]),_0x340d28++);});if(_0x340d28!=0x0)return _0x28f6f1[_0x33ced1(0xf4)](_0x33ced1(0x183),_0x33ced1(0x168)),_0x260b60['redirect'](_0x33ced1(0x15c));const _0xc68131=_0x1fd0ae['filter'](_0x28e20a=>_0x28e20a[_0x33ced1(0x85)]!=='0'&&_0x28e20a[_0x33ced1(0x85)]!==''),_0x4004f4=new sales_finished({'invoice':'OUT-'+_0x2ac368[_0x33ced1(0xaf)][_0x33ced1(0x86)]()['padStart'](0x8,'0'),'sales_data':_0x28f6f1[_0x33ced1(0x6e)][_0x33ced1(0x140)],'customer':_0x28f6f1[_0x33ced1(0x6e)]['customer'],'date':_0x2576c8,'warehouse_name':_0x18c2e5,'sale_product':_0xc68131,'note':_0x5e388d,'room':_0x57c3ca,'primary_code':_0x4f792e,'secondary_code':_0x594c67,'prod_code':_0x104294,'SCRN':_0x3d40de,'finalize':'False','mode_transpo':_0x430383,'name_driver':_0x1982df,'ReqBy':_0xfa0c5a,'dateofreq':_0x2f3b7e,'PO_number':_0x730d1d,'typeservicesData':_0x511bae,'typevehicle':_0xeff563,'destination':_0x49bf41,'deliverydate':_0xf23ca,'driver':_0x1c380e,'plate':_0x5b36b8,'van':_0x23321f,'DRSI':_0xa02b76,'TSU':_0x424df6,'TFU':_0x876aba,'pullout_date':_0x152b68,'actualdelivery_date':_0x25d1ea,'typeOfProducts':'own'}),_0x45cd1c=await _0x4004f4['save'](),_0x584519=await sales_finished['findOne']({'invoice':_0x3f4179});_0x28f6f1['flash'](_0x33ced1(0x158),_0x33ced1(0x8b)),_0x260b60['redirect'](_0x33ced1(0x156)+_0x45cd1c[_0x33ced1(0x98)]);}catch(_0x2d68df){console[_0x33ced1(0x114)](_0x2d68df);}}),router[a0_0x4f5d6d(0x11d)](a0_0x4f5d6d(0x11a),auth,async(_0x8aa543,_0x33cbd6)=>{var _0x2826c6=a0_0x4f5d6d;try{const {username:_0x45d497,email:_0x16a9f8,role:_0x3854b2}=_0x8aa543[_0x2826c6(0x14b)],_0x23fc1d=_0x8aa543[_0x2826c6(0x14b)],_0x4cf544=await profile[_0x2826c6(0xe4)]({'email':_0x23fc1d[_0x2826c6(0x134)]}),_0x52020b=await master_shop[_0x2826c6(0x80)](),_0x303b39=_0x8aa543['params']['id'],_0x1c2baf=await sales_finished['findById'](_0x303b39),_0xc88778=await warehouse[_0x2826c6(0x155)]([{'$match':{'name':_0x1c2baf[_0x2826c6(0x16f)]}},{'$unwind':_0x2826c6(0x110)},{'$group':{'_id':_0x2826c6(0x115),'name':{'$first':_0x2826c6(0xfd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2826c6(0xc2)},'bin':{'$first':_0x2826c6(0x149)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x2826c6(0xf9)},'primary_code':{'$first':_0x2826c6(0x159)},'secondary_code':{'$first':_0x2826c6(0xbe)},'product_code':{'$first':_0x2826c6(0x7c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2826c6(0xca)},'expiry_date':{'$first':_0x2826c6(0xeb)},'production_date':{'$first':_0x2826c6(0x13e)},'batch_code':{'$first':_0x2826c6(0xcf)},'room':{'$first':'$room'},'room_data':{'$first':'$product_details.room_name'}}}]),_0x4a3a22=await customer[_0x2826c6(0x80)]({});let _0x518746;if(_0x23fc1d['role']==_0x2826c6(0x145)){const _0x482e26=await staff[_0x2826c6(0xe4)]({'email':_0x23fc1d[_0x2826c6(0x134)]});_0x518746=await warehouse[_0x2826c6(0x155)]([{'$match':{'status':_0x2826c6(0xf6),'name':_0x482e26[_0x2826c6(0x11c)]}},{'$group':{'_id':_0x2826c6(0x164),'name':{'$first':_0x2826c6(0x164)}}}]);}else _0x518746=await warehouse[_0x2826c6(0x155)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x2826c6(0x164),'name':{'$first':_0x2826c6(0x164)}}}]);const _0x19ed16=await product['find']({});if(_0x52020b[0x0][_0x2826c6(0x135)]==_0x2826c6(0x10a)){var _0x4631af=users['English'];console['log'](_0x4631af);}else{if(_0x52020b[0x0][_0x2826c6(0x135)]==_0x2826c6(0xd9))var _0x4631af=users[_0x2826c6(0xd9)];else{if(_0x52020b[0x0][_0x2826c6(0x135)]==_0x2826c6(0xba))var _0x4631af=users[_0x2826c6(0xba)];else{if(_0x52020b[0x0][_0x2826c6(0x135)]==_0x2826c6(0xd8))var _0x4631af=users['Spanish'];else{if(_0x52020b[0x0][_0x2826c6(0x135)]==_0x2826c6(0xed))var _0x4631af=users[_0x2826c6(0xed)];else{if(_0x52020b[0x0][_0x2826c6(0x135)]==_0x2826c6(0xe8))var _0x4631af=users[_0x2826c6(0xc7)];else{if(_0x52020b[0x0][_0x2826c6(0x135)]=='Chinese')var _0x4631af=users['Chinese'];else{if(_0x52020b[0x0][_0x2826c6(0x135)]==_0x2826c6(0x107))var _0x4631af=users[_0x2826c6(0x16a)];}}}}}}}_0x33cbd6['render'](_0x2826c6(0x106),{'success':_0x8aa543[_0x2826c6(0xf4)](_0x2826c6(0x158)),'errors':_0x8aa543[_0x2826c6(0xf4)](_0x2826c6(0x183)),'role':_0x23fc1d,'profile':_0x4cf544,'customer':_0x4a3a22,'warehouse':_0x518746,'product':_0xc88778,'user':_0x1c2baf,'master_shop':_0x52020b,'unit':_0x19ed16,'language':_0x4631af});}catch(_0x5e6ea0){console[_0x2826c6(0x114)](_0x5e6ea0);}});async function dataUpdate(_0x4c53d0,_0x2c3a09,_0x225933){var _0x556f60=a0_0x4f5d6d;return await warehouse[_0x556f60(0x95)]({'_id':_0x4c53d0,'product_details._id':_0x2c3a09},{'$set':{'product_details.$.product_stock':_0x225933}}),await warehouse[_0x556f60(0x17c)](_0x4c53d0);}router[a0_0x4f5d6d(0x163)](a0_0x4f5d6d(0x11a),auth,async(_0x3bcd25,_0x5167b4)=>{var _0x2aa013=a0_0x4f5d6d;try{const _0x1f4190=_0x3bcd25[_0x2aa013(0x132)]['id'],{invoice:_0x2379c2,warehouse_name:_0x5ac449,room:_0xdbbe8e}=_0x3bcd25[_0x2aa013(0x6e)],_0x8f056e=await sales_finished['findOne']({'invoice':_0x2379c2});for(let _0x4c35fd=0x0;_0x4c35fd<=_0x8f056e['sale_product'][_0x2aa013(0x78)]-0x1;_0x4c35fd++){const _0x593a3c=_0x8f056e[_0x2aa013(0x162)][_0x4c35fd];var _0x53fc32=await warehouse['findOne']({'name':_0x5ac449,'room':_0x593a3c[_0x2aa013(0x182)]}),_0x4b2577=0x0;for(let _0x8d693a=0x0;_0x8d693a<=_0x53fc32[_0x2aa013(0x73)]['length']-0x1;_0x8d693a++){const _0x3de19f=_0x53fc32[_0x2aa013(0x73)][_0x8d693a];_0x3de19f[_0x2aa013(0x98)]==_0x593a3c[_0x2aa013(0x142)]&&_0x3de19f[_0x2aa013(0x72)]==_0x593a3c[_0x2aa013(0x72)]&&(_0x4b2577=Math[_0x2aa013(0x179)](0x0,Math[_0x2aa013(0xce)](_0x3de19f['product_stock'])-Math['abs'](_0x593a3c[_0x2aa013(0x85)])),await warehouse[_0x2aa013(0x95)]({'_id':_0x53fc32[_0x2aa013(0x98)][_0x2aa013(0x141)](),'product_details._id':_0x3de19f[_0x2aa013(0x98)][_0x2aa013(0x141)](),'product_details.uuid':_0x593a3c[_0x2aa013(0x72)]},{'$set':{'product_details.$.product_stock':_0x4b2577}}));}console[_0x2aa013(0x114)](typeof _0x593a3c[_0x2aa013(0xde)]);if(typeof _0x593a3c[_0x2aa013(0xde)]!=='undefined'){var _0xf33e1b=await staff[_0x2aa013(0x17c)](_0x593a3c[_0x2aa013(0xde)]);console[_0x2aa013(0x114)]('here');var _0x3d5095=0x0;for(let _0x8feb9a=0x0;_0x8feb9a<=_0xf33e1b[_0x2aa013(0xef)][_0x2aa013(0x78)]-0x1;_0x8feb9a++){const _0xe44079=_0xf33e1b[_0x2aa013(0xef)][_0x8feb9a];console['log'](_0x593a3c['id_transaction_from']+_0x2aa013(0xdf)+_0xe44079[_0x2aa013(0x184)]+_0x2aa013(0x119)+_0x593a3c['_id']+_0x2aa013(0xdf)+_0x593a3c['_id']),_0x593a3c[_0x2aa013(0x142)]==_0xe44079[_0x2aa013(0x184)]&&_0x593a3c[_0x2aa013(0x98)]==0x1&&(_0xe44079[_0x2aa013(0xe0)]=Math[_0x2aa013(0xce)](_0xe44079[_0x2aa013(0xe0)])+Math[_0x2aa013(0xce)](_0x593a3c[_0x2aa013(0x85)]),_0x3d5095++);}console[_0x2aa013(0x114)](_0x2aa013(0xc5),_0x3d5095),_0x3d5095=='0'&&(_0xf33e1b[_0x2aa013(0xef)]=_0xf33e1b['product_list'][_0x2aa013(0x122)]({'product_name':_0x593a3c['product_name'],'product_stock':_0x593a3c['quantity'],'bay':_0x593a3c[_0x2aa013(0xda)],'level':_0x593a3c['level'],'product_code':_0x593a3c[_0x2aa013(0x10c)],'primary_code':_0x593a3c[_0x2aa013(0x108)],'secondary_code':_0x593a3c[_0x2aa013(0x16b)],'expiry_date':_0x593a3c[_0x2aa013(0x9d)],'production_date':_0x593a3c[_0x2aa013(0x13f)],'maxProducts':_0x593a3c[_0x2aa013(0xcc)],'batch_code':_0x593a3c[_0x2aa013(0xc0)],'secondary_unit':_0x593a3c[_0x2aa013(0x143)],'unit':_0x593a3c[_0x2aa013(0x175)],'maxProducts':_0x593a3c['maxProducts'],'maxPerUnit':_0x593a3c[_0x2aa013(0x126)],'invoice':_0x593a3c[_0x2aa013(0x116)],'warehouse_id':_0x593a3c[_0x2aa013(0x142)],'id_incoming':_0x593a3c[_0x2aa013(0x98)],'uuid':_0x593a3c[_0x2aa013(0x72)],'gross_price':_0x593a3c[_0x2aa013(0x13c)],'date_incoming':_0x593a3c[_0x2aa013(0xf1)],'outgoing_invoice':_0x593a3c[_0x2aa013(0xe9)]}),await _0xf33e1b[_0x2aa013(0xa4)]());}}_0x8f056e[_0x2aa013(0xa9)]='True';const _0x3aee9a=await _0x8f056e['save'](),_0x4bb043=await master_shop[_0x2aa013(0x80)](),_0x3b31ca=await email_settings[_0x2aa013(0xe4)](),_0x56338a=await supervisor_settings['find']();var _0xebcd8c=_0x8f056e[_0x2aa013(0x162)],_0xcb9e11='',_0x22b0da;for(_0x22b0da in _0xebcd8c){_0xcb9e11+=_0x2aa013(0x81)+_0x2aa013(0xc6)+_0xebcd8c[_0x22b0da]['product_name']+'</td>'+_0x2aa013(0xc6)+_0xebcd8c[_0x22b0da]['product_code']+_0x2aa013(0xb9)+_0x2aa013(0xc6)+_0xebcd8c[_0x22b0da][_0x2aa013(0x85)]+_0x2aa013(0xb9)+_0x2aa013(0xc6)+_0xebcd8c[_0x22b0da][_0x2aa013(0x175)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xebcd8c[_0x22b0da]['secondary_unit']+'</td>'+_0x2aa013(0xc6)+_0x8f056e[_0x2aa013(0x16f)]+_0x2aa013(0xb9)+_0x2aa013(0xc6)+_0xebcd8c[_0x22b0da][_0x2aa013(0x182)]+_0x2aa013(0xb9)+_0x2aa013(0xc6)+_0xebcd8c[_0x22b0da][_0x2aa013(0xda)]+'</td>';}_0x3bcd25['flash'](_0x2aa013(0x158),'Sales\x20Update\x20successfully'),_0x5167b4['redirect'](_0x2aa013(0xbd)+_0x1f4190);}catch(_0x941ef1){console[_0x2aa013(0x114)](_0x941ef1);}}),router[a0_0x4f5d6d(0x11d)]('/view/:id',auth,async(_0x3550f2,_0x402d59)=>{var _0x29d95c=a0_0x4f5d6d;try{const {username:_0x2cae08,email:_0x23dc6f,role:_0x1e299b}=_0x3550f2[_0x29d95c(0x14b)],_0x34048a=_0x3550f2[_0x29d95c(0x14b)],_0x285035=await profile[_0x29d95c(0xe4)]({'email':_0x34048a[_0x29d95c(0x134)]}),_0x1cf6d3=await master_shop[_0x29d95c(0x80)](),_0x24479e=_0x3550f2[_0x29d95c(0x132)]['id'],_0x56ee90=await sales_finished[_0x29d95c(0x17c)](_0x24479e);let _0x54eefd=new Date(_0x56ee90[_0x29d95c(0x9d)]),_0x1d22d9=('0'+_0x54eefd[_0x29d95c(0x6d)]())[_0x29d95c(0x120)](-0x2),_0x93db55=('0'+(_0x54eefd[_0x29d95c(0xfa)]()+0x1))[_0x29d95c(0x120)](-0x2),_0x1a1c01=_0x54eefd[_0x29d95c(0x13a)](),_0x45edf4=_0x1a1c01+'-'+_0x93db55+'-'+_0x1d22d9;var _0x58eba7=['Ambient','Enclosed'];const _0x37dee9=await warehouse[_0x29d95c(0x155)]([{'$match':{'name':_0x56ee90[_0x29d95c(0x16f)],'room':_0x56ee90['room']}},{'$unwind':_0x29d95c(0x110)},{'$group':{'_id':_0x29d95c(0x115),'name':{'$first':_0x29d95c(0xfd)},'product_stock':{'$first':_0x29d95c(0x7e)},'bay':{'$first':_0x29d95c(0xc2)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x29d95c(0xbc)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x29d95c(0x159)},'secondary_code':{'$first':_0x29d95c(0xbe)},'product_code':{'$first':_0x29d95c(0x7c)},'storage':{'$first':_0x29d95c(0x133)},'rack':{'$first':_0x29d95c(0xca)}}}]),_0x4ed98e=await customer[_0x29d95c(0x80)]({});let _0x20876e;if(_0x34048a[_0x29d95c(0x12e)]=='staff'){const _0x18bf76=await staff['findOne']({'email':_0x34048a['email']});_0x20876e=await warehouse[_0x29d95c(0x155)]([{'$match':{'status':_0x29d95c(0xf6),'name':_0x18bf76[_0x29d95c(0x11c)]}},{'$group':{'_id':_0x29d95c(0x164),'name':{'$first':_0x29d95c(0x164)}}}]);}else _0x20876e=await warehouse[_0x29d95c(0x155)]([{'$match':{'status':_0x29d95c(0xf6)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x1d9d0c=await product[_0x29d95c(0x80)]({});if(_0x1cf6d3[0x0]['language']=='English\x20(US)'){var _0x599105=users['English'];console['log'](_0x599105);}else{if(_0x1cf6d3[0x0][_0x29d95c(0x135)]==_0x29d95c(0xd9))var _0x599105=users[_0x29d95c(0xd9)];else{if(_0x1cf6d3[0x0][_0x29d95c(0x135)]==_0x29d95c(0xba))var _0x599105=users[_0x29d95c(0xba)];else{if(_0x1cf6d3[0x0]['language']==_0x29d95c(0xd8))var _0x599105=users[_0x29d95c(0xd8)];else{if(_0x1cf6d3[0x0]['language']==_0x29d95c(0xed))var _0x599105=users[_0x29d95c(0xed)];else{if(_0x1cf6d3[0x0][_0x29d95c(0x135)]==_0x29d95c(0xe8))var _0x599105=users[_0x29d95c(0xc7)];else{if(_0x1cf6d3[0x0][_0x29d95c(0x135)]==_0x29d95c(0xe6))var _0x599105=users[_0x29d95c(0xe6)];else{if(_0x1cf6d3[0x0]['language']==_0x29d95c(0x107))var _0x599105=users['Arabic'];}}}}}}}_0x402d59[_0x29d95c(0x17a)](_0x29d95c(0x15f),{'success':_0x3550f2[_0x29d95c(0xf4)]('success'),'errors':_0x3550f2[_0x29d95c(0xf4)]('errors'),'role':_0x34048a,'profile':_0x285035,'customer':_0x4ed98e,'warehouse':_0x20876e,'product':_0x37dee9,'user':_0x56ee90,'master_shop':_0x1cf6d3,'unit':_0x1d9d0c,'language':_0x599105,'rooms_data':_0x58eba7,'ed_fullDate':_0x45edf4});}catch(_0x5b5eed){console[_0x29d95c(0x114)](_0x5b5eed);}}),router[a0_0x4f5d6d(0x163)](a0_0x4f5d6d(0x171),auth,async(_0x1cdc97,_0x4a4175)=>{var _0x3c6848=a0_0x4f5d6d;try{const _0x19e0d6=_0x1cdc97[_0x3c6848(0x132)]['id'],_0x48fa91=await sales_finished[_0x3c6848(0xe4)]({'_id':_0x1cdc97[_0x3c6848(0x132)]['id']}),_0x4c0306=await warehouse[_0x3c6848(0xe4)]({'name':_0x48fa91[_0x3c6848(0x16f)],'room':_0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0xd6)],'warehouse_category':_0x3c6848(0x8c)}),{invoice:_0xd2bbb8,customer:_0x562d0f,date:_0x29fac4,warehouse_name:_0x532635,product_name:_0x1e82d4,stock:_0x4040ee,adjust_qty:_0x900613,note:_0x6189e6,room:_0x5e82d7,primary_code:_0x49f0b8,secondary_code:_0x43f6f4,prod_code:_0x484557,level:_0x2368ac,isle:_0x5022fa,pallet:_0x18956c,expiry_date:_0x21e0bf}=_0x1cdc97[_0x3c6848(0x6e)];if(typeof _0x1e82d4=='string')var _0x430f12=[_0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0x173)]],_0x51adbf=[_0x1cdc97['body'][_0x3c6848(0x9a)]],_0x16ad0e=[_0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0xa1)]],_0x46f3ed=[_0x1cdc97['body']['primary_code']],_0x3e0c34=[_0x1cdc97['body'][_0x3c6848(0x16b)]],_0x465098=[_0x1cdc97['body'][_0x3c6848(0x127)]],_0xd294b1=[_0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0x139)]],_0x3d952a=[_0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0x9d)]];else var _0x430f12=[..._0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0x173)]],_0x51adbf=[..._0x1cdc97[_0x3c6848(0x6e)]['stock']],_0x16ad0e=[..._0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0xa1)]],_0x46f3ed=[..._0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0x108)]],_0x3e0c34=[..._0x1cdc97['body'][_0x3c6848(0x16b)]],_0x465098=[..._0x1cdc97['body'][_0x3c6848(0x127)]],_0xd294b1=[..._0x1cdc97['body'][_0x3c6848(0x139)]],_0x3d952a=[..._0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0x9d)]];const _0x55c21a=_0x430f12[_0x3c6848(0x9f)](_0x8ebff5=>{return _0x8ebff5={'product_name':_0x8ebff5};});_0x51adbf['forEach']((_0x2d46ad,_0x14743e)=>{_0x55c21a[_0x14743e]['stock']=_0x2d46ad;}),_0x16ad0e[_0x3c6848(0xee)]((_0x54038b,_0x5f3ec9)=>{var _0x1de004=_0x3c6848;_0x55c21a[_0x5f3ec9][_0x1de004(0x85)]=_0x54038b;}),_0x46f3ed[_0x3c6848(0xee)]((_0x2921ba,_0x4deabb)=>{var _0x3c0ef3=_0x3c6848;_0x55c21a[_0x4deabb][_0x3c0ef3(0x108)]=_0x2921ba;}),_0x3e0c34[_0x3c6848(0xee)]((_0x13ac78,_0x278a05)=>{var _0x83f005=_0x3c6848;_0x55c21a[_0x278a05][_0x83f005(0x16b)]=_0x13ac78;}),_0x465098[_0x3c6848(0xee)]((_0xe2d90b,_0x534d05)=>{_0x55c21a[_0x534d05]['product_code']=_0xe2d90b;}),_0xd294b1[_0x3c6848(0xee)]((_0x1abdbd,_0x4a07ba)=>{var _0x3ea4c9=_0x3c6848;_0x55c21a[_0x4a07ba][_0x3ea4c9(0x139)]=_0x1abdbd;}),_0x3d952a[_0x3c6848(0xee)]((_0x49a546,_0x145298)=>{_0x55c21a[_0x145298]['expiry_date']=_0x49a546;});var _0x5f0c63=0x0;_0x55c21a[_0x3c6848(0xee)](_0x59280e=>{var _0x4f365f=_0x3c6848;console[_0x4f365f(0x114)]('foreach\x20newproduct',_0x59280e),(parseInt(_0x59280e[_0x4f365f(0x9a)])<parseInt(_0x59280e[_0x4f365f(0x85)])||parseInt(_0x59280e[_0x4f365f(0x85)])==0x0)&&_0x5f0c63++;});if(_0x5f0c63!=0x0)return _0x1cdc97['flash'](_0x3c6848(0x183),_0x3c6848(0x88)),_0x4a4175[_0x3c6848(0x157)]('back');_0x48fa91[_0x3c6848(0x162)][_0x3c6848(0xee)](_0x31c3f4=>{var _0x1b849d=_0x3c6848;const _0x4b4d55=_0x4c0306['product_details'][_0x1b849d(0x9f)](_0x122dda=>{var _0x444cf2=_0x1b849d;_0x122dda[_0x444cf2(0x173)]==_0x31c3f4[_0x444cf2(0x173)]&&_0x122dda[_0x444cf2(0xda)]==_0x31c3f4[_0x444cf2(0xda)]&&(_0x122dda[_0x444cf2(0xe0)]=parseInt(_0x122dda['product_stock'])+parseInt(_0x31c3f4[_0x444cf2(0x85)]));});}),await _0x4c0306[_0x3c6848(0xa4)]();const _0x16dc52=_0x55c21a[_0x3c6848(0xe1)](_0xe4db7=>_0xe4db7['quantity']!=='0'&&_0xe4db7[_0x3c6848(0x85)]!=='');_0x48fa91[_0x3c6848(0x116)]=_0xd2bbb8,_0x48fa91[_0x3c6848(0x11f)]=_0x562d0f,_0x48fa91[_0x3c6848(0xa3)]=_0x29fac4,_0x48fa91[_0x3c6848(0x16f)]=_0x532635,_0x48fa91[_0x3c6848(0x162)]=_0x16dc52,_0x48fa91[_0x3c6848(0x118)]=_0x6189e6,_0x48fa91[_0x3c6848(0xd6)]=_0x5e82d7;const _0x8b96d3=await _0x48fa91[_0x3c6848(0xa4)](),_0x2f7524=await sales_finished[_0x3c6848(0xe4)]({'_id':_0x1cdc97[_0x3c6848(0x132)]['id']}),_0x2e0957=await warehouse[_0x3c6848(0xe4)]({'name':_0x532635,'room':_0x5e82d7,'warehouse_category':_0x3c6848(0x8c)});_0x2f7524[_0x3c6848(0x162)][_0x3c6848(0xee)](_0xc729f4=>{var _0x296a93=_0x3c6848;const _0x46a2d4=_0x2e0957[_0x296a93(0x73)]['map'](_0x502008=>{var _0x282496=_0x296a93;_0x502008['product_name']==_0xc729f4['product_name']&&_0x502008['bay']==_0xc729f4[_0x282496(0xda)]&&(_0x502008[_0x282496(0xe0)]=parseInt(_0x502008[_0x282496(0xe0)])-parseInt(_0xc729f4[_0x282496(0x85)]));});}),console[_0x3c6848(0x114)](_0x3c6848(0x17e),_0x2e0957),await _0x2e0957[_0x3c6848(0xa4)]();const _0x1f82fd=await c_payment_data[_0x3c6848(0xe4)]({'invoice':_0x1cdc97[_0x3c6848(0x6e)][_0x3c6848(0x116)]});_0x1f82fd[_0x3c6848(0xec)]=_0x1cdc97['body']['suppliers'],await _0x1f82fd[_0x3c6848(0xa4)](),_0x1cdc97[_0x3c6848(0xf4)](_0x3c6848(0x158),_0x3c6848(0x174)),_0x4a4175[_0x3c6848(0x157)](_0x3c6848(0x7f));}catch(_0x450c6a){console[_0x3c6848(0x114)](_0x450c6a);}}),router[a0_0x4f5d6d(0x163)](a0_0x4f5d6d(0xb3),auth,async(_0x4c6229,_0x243b83)=>{var _0x11480c=a0_0x4f5d6d;try{const _0x18ef7e=_0x4c6229[_0x11480c(0x132)]['id'],{invoice:_0x2f3cff,customer:_0x44f587,receivable_amount:_0xf0b851,received_amount:_0xc1b508}=_0x4c6229[_0x11480c(0x6e)],_0x29ba88=await sales[_0x11480c(0x17c)](_0x18ef7e);console[_0x11480c(0x114)](_0x29ba88);var _0x4f0b9f=_0xf0b851-_0xc1b508;console['log'](_0xc1b508),_0x29ba88[_0x11480c(0x147)]=parseFloat(_0xc1b508)+parseFloat(_0x29ba88[_0x11480c(0x147)]),_0x29ba88[_0x11480c(0x15d)]=_0x4f0b9f,console[_0x11480c(0x114)](_0x29ba88);const _0x3bd079=await _0x29ba88[_0x11480c(0xa4)](),_0x48408b=await c_payment_data[_0x11480c(0xe4)]({'invoice':_0x2f3cff});_0x48408b[_0x11480c(0x92)]=_0x4f0b9f,await _0x48408b['save']();let _0x20cd7=new Date(),_0x249ff1=('0'+_0x20cd7['getDate']())[_0x11480c(0x120)](-0x2),_0xa2c8c0=('0'+(_0x20cd7['getMonth']()+0x1))[_0x11480c(0x120)](-0x2),_0x3bd06f=_0x20cd7[_0x11480c(0x13a)](),_0x42d588=_0x3bd06f+'-'+_0xa2c8c0+'-'+_0x249ff1;const _0xc1385a=new customer_payment({'invoice':_0x2f3cff,'date':_0x3bd06f+'-'+_0xa2c8c0+'-'+_0x249ff1,'customer':_0x44f587,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0xc1b508}),_0x179c81=await _0xc1385a[_0x11480c(0xa4)]();_0x4c6229['flash'](_0x11480c(0x158),'payment\x20successfull'),_0x243b83['redirect']('/all_sales/view');}catch(_0x5e55dd){console[_0x11480c(0x114)](_0x5e55dd);}}),router[a0_0x4f5d6d(0x11d)](a0_0x4f5d6d(0x8f),auth,async(_0x4bb9f6,_0x1b18ab)=>{var _0x11610f=a0_0x4f5d6d;try{const {username:_0x3f443c,email:_0x233242,role:_0x4f1a3d}=_0x4bb9f6[_0x11610f(0x14b)],_0x1b438d=_0x4bb9f6[_0x11610f(0x14b)],_0x2be525=await profile[_0x11610f(0xe4)]({'email':_0x1b438d['email']}),_0x271422=await master_shop[_0x11610f(0x80)]();console['log'](_0x11610f(0xcb),_0x271422);const _0x41f27b=_0x4bb9f6[_0x11610f(0x132)]['id'],_0x1c4d11=await sales['findById'](_0x41f27b);console['log'](_0x1c4d11);const _0x417dc2=await customer[_0x11610f(0xe4)]({'name':_0x1c4d11[_0x11610f(0x11f)]});console[_0x11610f(0x114)](_0x417dc2);if(_0x271422[0x0]['language']==_0x11610f(0x10a)){var _0x59a0c9=users[_0x11610f(0x14d)];console[_0x11610f(0x114)](_0x59a0c9);}else{if(_0x271422[0x0][_0x11610f(0x135)]==_0x11610f(0xd9))var _0x59a0c9=users[_0x11610f(0xd9)];else{if(_0x271422[0x0][_0x11610f(0x135)]=='German')var _0x59a0c9=users[_0x11610f(0xba)];else{if(_0x271422[0x0][_0x11610f(0x135)]==_0x11610f(0xd8))var _0x59a0c9=users[_0x11610f(0xd8)];else{if(_0x271422[0x0][_0x11610f(0x135)]==_0x11610f(0xed))var _0x59a0c9=users[_0x11610f(0xed)];else{if(_0x271422[0x0][_0x11610f(0x135)]==_0x11610f(0xe8))var _0x59a0c9=users[_0x11610f(0xc7)];else{if(_0x271422[0x0][_0x11610f(0x135)]==_0x11610f(0xe6))var _0x59a0c9=users[_0x11610f(0xe6)];else{if(_0x271422[0x0][_0x11610f(0x135)]==_0x11610f(0x107))var _0x59a0c9=users[_0x11610f(0x16a)];}}}}}}}_0x1b18ab[_0x11610f(0x17a)]('sales_invoice',{'success':_0x4bb9f6[_0x11610f(0xf4)](_0x11610f(0x158)),'errors':_0x4bb9f6[_0x11610f(0xf4)](_0x11610f(0x183)),'role':_0x1b438d,'profile':_0x2be525,'master_shop':_0x271422,'customers':_0x417dc2,'sales':_0x1c4d11,'language':_0x59a0c9});}catch(_0x569997){console[_0x11610f(0x114)](_0x569997);}}),router[a0_0x4f5d6d(0x11d)](a0_0x4f5d6d(0xb2),auth,async(_0x1d6782,_0x4be926)=>{var _0x17fcaa=a0_0x4f5d6d;try{const {username:_0x148851,email:_0xe64b29,role:_0x2c9982}=_0x1d6782[_0x17fcaa(0x14b)],_0x1ca2c6=_0x1d6782[_0x17fcaa(0x14b)],_0x21feda=await profile[_0x17fcaa(0xe4)]({'email':_0x1ca2c6[_0x17fcaa(0x134)]}),_0x3a6d8d=await master_shop[_0x17fcaa(0x80)](),_0xce1b0d=_0x1d6782[_0x17fcaa(0x132)]['id'],_0x45d3a2=await sales_finished['findById'](_0xce1b0d),_0x20ff0c=await warehouse[_0x17fcaa(0x155)]([{'$match':{'name':_0x45d3a2[_0x17fcaa(0x16f)]}},{'$unwind':_0x17fcaa(0x110)},{'$group':{'_id':_0x17fcaa(0x115),'name':{'$first':_0x17fcaa(0xfd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x17fcaa(0x149)},'type':{'$first':_0x17fcaa(0xbc)},'floorlevel':{'$first':_0x17fcaa(0xf9)},'primary_code':{'$first':_0x17fcaa(0x159)},'secondary_code':{'$first':_0x17fcaa(0xbe)},'product_code':{'$first':_0x17fcaa(0x7c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x17fcaa(0xca)},'expiry_date':{'$first':_0x17fcaa(0xeb)},'production_date':{'$first':_0x17fcaa(0x13e)},'unit':{'$first':_0x17fcaa(0xb8)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x17fcaa(0xe7)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x17fcaa(0x186)}}}]),_0x3857f9=await product[_0x17fcaa(0x80)]({}),_0x129dcc=await warehouse[_0x17fcaa(0x155)]([{'$match':{'status':'Enabled','warehouse_category':_0x17fcaa(0x8c),'name':{'$ne':'Return\x20Goods','$ne':_0x17fcaa(0xa0)}}},{'$group':{'_id':'$name','name':{'$first':_0x17fcaa(0x164)}}},{'$sort':{'name':0x1}}]);var _0x442eda=[_0x17fcaa(0xd5)];const _0x5d1503=await warehouse[_0x17fcaa(0x155)]([{'$match':{'status':_0x17fcaa(0xf6),'name':_0x17fcaa(0xa0)}},{'$group':{'_id':_0x17fcaa(0x164),'name':{'$first':_0x17fcaa(0x164)}}},{'$sort':{'name':0x1}}]);if(_0x3a6d8d[0x0][_0x17fcaa(0x135)]==_0x17fcaa(0x10a)){var _0x1f9ff1=users[_0x17fcaa(0x14d)];console['log'](_0x1f9ff1);}else{if(_0x3a6d8d[0x0]['language']=='Hindi')var _0x1f9ff1=users[_0x17fcaa(0xd9)];else{if(_0x3a6d8d[0x0][_0x17fcaa(0x135)]==_0x17fcaa(0xba))var _0x1f9ff1=users[_0x17fcaa(0xba)];else{if(_0x3a6d8d[0x0]['language']==_0x17fcaa(0xd8))var _0x1f9ff1=users[_0x17fcaa(0xd8)];else{if(_0x3a6d8d[0x0]['language']==_0x17fcaa(0xed))var _0x1f9ff1=users['French'];else{if(_0x3a6d8d[0x0]['language']==_0x17fcaa(0xe8))var _0x1f9ff1=users[_0x17fcaa(0xc7)];else{if(_0x3a6d8d[0x0][_0x17fcaa(0x135)]==_0x17fcaa(0xe6))var _0x1f9ff1=users[_0x17fcaa(0xe6)];else{if(_0x3a6d8d[0x0][_0x17fcaa(0x135)]==_0x17fcaa(0x107))var _0x1f9ff1=users[_0x17fcaa(0x16a)];}}}}}}}_0x4be926[_0x17fcaa(0x17a)]('return_sale_finished',{'success':_0x1d6782['flash'](_0x17fcaa(0x158)),'errors':_0x1d6782['flash'](_0x17fcaa(0x183)),'role':_0x1ca2c6,'profile':_0x21feda,'user':_0x45d3a2,'stock':_0x20ff0c,'master_shop':_0x3a6d8d,'unit':_0x3857f9,'language':_0x1f9ff1,'warehouses':_0x129dcc,'rooms':_0x442eda,'warehouse_QA':_0x5d1503});}catch(_0x571801){console[_0x17fcaa(0x114)](_0x571801),_0x4be926[_0x17fcaa(0x87)](0xc8)[_0x17fcaa(0xe5)]({'message':_0x571801[_0x17fcaa(0x10b)]});}}),router[a0_0x4f5d6d(0x163)](a0_0x4f5d6d(0xb2),auth,async(_0x4ce1ef,_0x4d5b5b)=>{var _0xe7adc1=a0_0x4f5d6d;if(_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x178)]=='QA')try{const {invoice:_0x46bccc,date:_0x11b489,warehouse_name:_0x620d0d,product_name:_0x1f2e25,primary_code:_0x514b02,secondary_code:_0x2f3e3b,product_code:_0x5ad4c2,sales_quantity:_0x1fe05d,stocks:_0x4df1b1,return_qty:_0x3a2729,Room_name:_0x59b7fd,to_warehouse_name_QA:_0x23c791,to_Room_name_QA:_0x40204a,note:_0x5acac9,for_categorize:_0x457054,product_name_QA1:_0x5d444e}=_0x4ce1ef[_0xe7adc1(0x6e)];if(typeof _0x5d444e==_0xe7adc1(0x8d))var _0x5d0c3a=[_0x4ce1ef['body'][_0xe7adc1(0x121)]],_0xd55b22=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0xc8)]],_0x46f893=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x137)]],_0x500de9=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x17d)]],_0x5383e5=[_0x4ce1ef['body'][_0xe7adc1(0x83)]],_0x13d9f2=[_0x4ce1ef[_0xe7adc1(0x6e)]['stocks_QA']],_0x4916a1=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x177)]],_0x3ff164=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x111)]],_0x2939fd=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0xcd)]],_0x1a5a64=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x6f)]],_0x24f3e8=[_0x4ce1ef['body'][_0xe7adc1(0x76)]],_0x364394=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0xf3)]],_0x4e15db=[_0x4ce1ef['body'][_0xe7adc1(0x93)]],_0x19b208=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x161)]];else var _0x5d0c3a=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x121)]],_0xd55b22=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0xc8)]],_0x46f893=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x137)]],_0x500de9=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x17d)]],_0x5383e5=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x83)]],_0x13d9f2=[..._0x4ce1ef[_0xe7adc1(0x6e)]['stocks_QA']],_0x4916a1=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x177)]],_0x3ff164=[..._0x4ce1ef[_0xe7adc1(0x6e)]['maxPerUnit_QA']],_0x2939fd=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0xcd)]],_0x1a5a64=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x6f)]],_0x24f3e8=[..._0x4ce1ef[_0xe7adc1(0x6e)]['secondary_unit_QA']],_0x364394=[..._0x4ce1ef[_0xe7adc1(0x6e)]['unit_QA']],_0x4e15db=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x93)]],_0x19b208=[..._0x4ce1ef['body'][_0xe7adc1(0x161)]];const _0x4d7a62=_0x5d0c3a[_0xe7adc1(0x9f)](_0x19ce42=>{return _0x19ce42={'product_name':_0x19ce42};});_0xd55b22[_0xe7adc1(0xee)]((_0x933037,_0x5aae17)=>{var _0x3f6701=_0xe7adc1;_0x4d7a62[_0x5aae17][_0x3f6701(0x108)]=_0x933037;}),_0x46f893['forEach']((_0x5196b7,_0x2397bf)=>{var _0x3a56b6=_0xe7adc1;_0x4d7a62[_0x2397bf][_0x3a56b6(0x16b)]=_0x5196b7;}),_0x500de9['forEach']((_0x303076,_0x42537c)=>{var _0xb84002=_0xe7adc1;_0x4d7a62[_0x42537c][_0xb84002(0x10c)]=_0x303076;}),_0x5383e5[_0xe7adc1(0xee)]((_0x43d722,_0x5110e4)=>{var _0xbf9be3=_0xe7adc1;_0x4d7a62[_0x5110e4][_0xbf9be3(0xa5)]=_0x43d722;}),_0x13d9f2[_0xe7adc1(0xee)]((_0x2f420d,_0xccd028)=>{var _0x128b1c=_0xe7adc1;_0x4d7a62[_0xccd028][_0x128b1c(0x9a)]=_0x2f420d;}),_0x4916a1[_0xe7adc1(0xee)]((_0x4f942c,_0x1ca2b9)=>{var _0x1cc487=_0xe7adc1;_0x4d7a62[_0x1ca2b9][_0x1cc487(0x113)]=_0x4f942c;}),_0x3ff164[_0xe7adc1(0xee)]((_0x43e5fb,_0x37569b)=>{_0x4d7a62[_0x37569b]['maxPerUnit']=_0x43e5fb;}),_0x2939fd['forEach']((_0x41855b,_0x50fc93)=>{var _0xae549f=_0xe7adc1;_0x4d7a62[_0x50fc93][_0xae549f(0xcc)]=_0x41855b;}),_0x1a5a64[_0xe7adc1(0xee)]((_0x59a421,_0x48307c)=>{var _0x52be06=_0xe7adc1;_0x4d7a62[_0x48307c][_0x52be06(0xc0)]=_0x59a421;}),_0x24f3e8[_0xe7adc1(0xee)]((_0x21d4a6,_0x3b24dc)=>{_0x4d7a62[_0x3b24dc]['secondary_unit']=_0x21d4a6;}),_0x364394[_0xe7adc1(0xee)]((_0x6b36f9,_0x340af2)=>{var _0x4db091=_0xe7adc1;_0x4d7a62[_0x340af2][_0x4db091(0x175)]=_0x6b36f9;}),_0x4e15db[_0xe7adc1(0xee)]((_0x37ed83,_0x198edc)=>{_0x4d7a62[_0x198edc]['production_date']=_0x37ed83;}),_0x19b208['forEach']((_0x2d4609,_0x37ae2b)=>{var _0x4cc1f9=_0xe7adc1;_0x4d7a62[_0x37ae2b][_0x4cc1f9(0x9d)]=_0x2d4609;});const _0x1c8da2=await sales_finished[_0xe7adc1(0xe4)]({'invoice':_0x46bccc});_0x1c8da2[_0xe7adc1(0x150)]=_0xe7adc1(0x11e);const _0x5ade34=await _0x1c8da2[_0xe7adc1(0xa4)](),_0x329da2=new sales_return_finished({'invoice':_0x46bccc,'customer':_0x4ce1ef['body'][_0xe7adc1(0x11f)],'date':_0x11b489,'warehouse_name':_0x620d0d,'room':_0x59b7fd,'ToWarehouse':_0x23c791,'ToRoom':_0x40204a,'return_sale_QA':_0x4d7a62,'note':_0x5acac9,'warehouse_cat':_0x457054}),_0x13f6fe=await _0x329da2[_0xe7adc1(0xa4)](),_0x121314=await sales_return_finished[_0xe7adc1(0xe4)]({'invoice':_0x46bccc}),_0x53560a=await warehouse[_0xe7adc1(0xe4)]({'name':_0x23c791,'room':_0x40204a});_0x121314[_0xe7adc1(0x102)][_0xe7adc1(0xee)](_0x249315=>{var _0x5ab6ef=_0xe7adc1,_0x400f02=0x0;const _0x1bc998=_0x53560a[_0x5ab6ef(0x73)][_0x5ab6ef(0x9f)](_0x16c5a7=>{var _0x40b1b9=_0x5ab6ef;_0x16c5a7[_0x40b1b9(0x173)]==_0x249315[_0x40b1b9(0x173)]&&_0x16c5a7[_0x40b1b9(0x9d)]==_0x249315['expiry_date']&&_0x16c5a7[_0x40b1b9(0x13f)]==_0x249315['production_date']&&_0x16c5a7[_0x40b1b9(0xc0)]==_0x249315[_0x40b1b9(0xc0)]&&(_0x16c5a7[_0x40b1b9(0xe0)]=parseInt(_0x16c5a7[_0x40b1b9(0xe0)])+parseInt(_0x249315['return_qty']),_0x400f02++);});_0x400f02=='0'&&(_0x53560a[_0x5ab6ef(0x73)]=_0x53560a[_0x5ab6ef(0x73)][_0x5ab6ef(0x122)]({'product_name':_0x249315['product_name'],'product_stock':_0x249315[_0x5ab6ef(0x113)],'primary_code':_0x249315[_0x5ab6ef(0x108)],'secondary_code':_0x249315[_0x5ab6ef(0x16b)],'product_code':_0x249315['product_code'],'batch_code':_0x249315[_0x5ab6ef(0xc0)],'maxPerUnit':_0x249315[_0x5ab6ef(0x138)],'production_date':_0x249315['production_date'],'expiry_date':_0x249315['expiry_date'],'secondary_unit':_0x249315[_0x5ab6ef(0x143)],'unit':_0x249315[_0x5ab6ef(0x175)],'maxProducts':_0x249315[_0x5ab6ef(0xcc)],'bay':_0x249315[_0x5ab6ef(0xda)]}));}),await _0x53560a[_0xe7adc1(0xa4)]();const _0x5311a8=new c_payment_data({'invoice':_0x46bccc,'customer':_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x11f)],'reason':_0xe7adc1(0x112)});await _0x5311a8[_0xe7adc1(0xa4)]();const _0x430a2b=await master_shop[_0xe7adc1(0x80)](),_0x2f40a3=await email_settings[_0xe7adc1(0xe4)](),_0x20f714=await customer[_0xe7adc1(0xe4)]({'name':_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x11f)]});_0x430a2b[0x0]['currency_placement']==0x1?(right_currency=_0x430a2b[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x430a2b[0x0][_0xe7adc1(0xb4)]);var _0x58b8bc=_0x5d0c3a,_0x17fafe=_0x4916a1,_0x50156b='',_0x22461a;for(_0x22461a in _0x58b8bc){_0x50156b+=_0xe7adc1(0x81)+_0xe7adc1(0xc6)+_0x58b8bc[_0x22461a]+'</td>'+_0xe7adc1(0xc6)+_0x17fafe[_0x22461a]+_0xe7adc1(0xb9)+_0xe7adc1(0xc1);}console[_0xe7adc1(0x114)](_0xe7adc1(0xef),_0x50156b);let _0x218229=nodemailer[_0xe7adc1(0xf2)]({'service':_0xe7adc1(0x154),'auth':{'user':_0x2f40a3['email'],'pass':_0x2f40a3['password']}}),_0x1cc348={'from':_0x2f40a3[_0xe7adc1(0x134)],'to':_0x20f714['email'],'subject':_0xe7adc1(0x6c),'attachments':[{'filename':_0xe7adc1(0x160),'path':__dirname+_0xe7adc1(0x105)+_0xe7adc1(0x82)+_0x430a2b[0x0][_0xe7adc1(0x12a)],'cid':_0xe7adc1(0xbb)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0xe7adc1(0x7b)+_0xe7adc1(0x16d)+_0xe7adc1(0x14f)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+_0xe7adc1(0x109)+_0x430a2b[0x0][_0xe7adc1(0xd3)]+_0xe7adc1(0x10d)+_0xe7adc1(0x12b)+_0xe7adc1(0x12b)+_0xe7adc1(0xab)+_0xe7adc1(0x16d)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0xe7adc1(0xa2)+_0x46bccc+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0xe7adc1(0xd1)+_0x11b489+'\x20'+_0xe7adc1(0x9b)+_0xe7adc1(0x10e)+_0xe7adc1(0x12b)+_0xe7adc1(0x79)+_0xe7adc1(0xc9)+_0xe7adc1(0x81)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0xe7adc1(0x153)+_0xe7adc1(0xc1)+_0xe7adc1(0xdd)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x50156b+'\x20'+_0xe7adc1(0xb0)+_0xe7adc1(0x70)+_0xe7adc1(0x16d)+_0xe7adc1(0xaa)+_0xe7adc1(0x74)+_0x430a2b[0x0][_0xe7adc1(0xd3)]+'</h5>'+_0xe7adc1(0x12b)+'</div>'+_0xe7adc1(0xb5)};_0x218229[_0xe7adc1(0x12d)](_0x1cc348,function(_0x42a8d4,_0x3cd991){var _0x26dff9=_0xe7adc1;_0x42a8d4?(console[_0x26dff9(0x114)](_0x42a8d4),console[_0x26dff9(0x114)](_0x26dff9(0xa6))):console[_0x26dff9(0x114)](_0x26dff9(0x144));}),_0x4ce1ef[_0xe7adc1(0xf4)]('success',_0xe7adc1(0x103)),_0x4d5b5b[_0xe7adc1(0x157)]('/all_sales_finished/view');}catch(_0x82bd2d){_0x4d5b5b[_0xe7adc1(0x87)](0xc8)[_0xe7adc1(0xe5)]({'message1':_0x82bd2d[_0xe7adc1(0x10b)]});}else{if(_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x178)]=='GS')try{const {invoice:_0x455b18,date:_0x53d9bd,warehouse_name:_0x205a3e,product_name:_0x3f7e11,primary_code:_0x8ec9de,secondary_code:_0x46f671,product_code:_0x123457,sales_quantity:_0x4e92fa,stocks:_0x32af1a,return_qty:_0x56d1f6,Room_name:_0x3d90e8,to_warehouse_name:_0x220f9e,to_Room_name:_0x578ac6,note:_0x401c28,level:_0x10d577,isle:_0x1a1fff,pallet:_0x523742,for_categorize:_0x39f6b0}=_0x4ce1ef[_0xe7adc1(0x6e)];if(typeof _0x3f7e11==_0xe7adc1(0x8d))var _0x5d0c3a=[_0x4ce1ef[_0xe7adc1(0x6e)]['product_name']],_0xd55b22=[_0x4ce1ef[_0xe7adc1(0x6e)]['primary_code']],_0x46f893=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x16b)]],_0x500de9=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x10c)]],_0x5383e5=[_0x4ce1ef['body'][_0xe7adc1(0x185)]],_0x4916a1=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x113)]],_0x3fe524=[_0x4ce1ef['body']['bay']],_0x3ff164=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x138)]],_0x2939fd=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0xcc)]],_0x1a5a64=[_0x4ce1ef[_0xe7adc1(0x6e)]['batch_code']],_0x24f3e8=[_0x4ce1ef['body']['secondary_unit']],_0x364394=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x175)]],_0x4e15db=[_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x13f)]],_0x19b208=[_0x4ce1ef['body'][_0xe7adc1(0x9d)]];else var _0x5d0c3a=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x173)]],_0xd55b22=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x108)]],_0x46f893=[..._0x4ce1ef['body']['secondary_code']],_0x500de9=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x10c)]],_0x5383e5=[..._0x4ce1ef[_0xe7adc1(0x6e)]['sales_quantity']],_0x4916a1=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x113)]],_0x3fe524=[..._0x4ce1ef['body'][_0xe7adc1(0xda)]],_0x3ff164=[..._0x4ce1ef['body']['maxPerUnit']],_0x2939fd=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0xcc)]],_0x1a5a64=[..._0x4ce1ef[_0xe7adc1(0x6e)]['batch_code']],_0x24f3e8=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x143)]],_0x364394=[..._0x4ce1ef[_0xe7adc1(0x6e)]['unit']],_0x4e15db=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x13f)]],_0x19b208=[..._0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x9d)]];const _0x2570fc=_0x5d0c3a[_0xe7adc1(0x9f)](_0x4988bf=>{return _0x4988bf={'product_name':_0x4988bf};});_0xd55b22[_0xe7adc1(0xee)]((_0x5dca21,_0x107075)=>{var _0x3acb57=_0xe7adc1;_0x2570fc[_0x107075][_0x3acb57(0x108)]=_0x5dca21;}),_0x46f893[_0xe7adc1(0xee)]((_0x471bb1,_0x3ace5d)=>{var _0x38b8ff=_0xe7adc1;_0x2570fc[_0x3ace5d][_0x38b8ff(0x16b)]=_0x471bb1;}),_0x500de9[_0xe7adc1(0xee)]((_0x25d90e,_0x45f749)=>{_0x2570fc[_0x45f749]['product_code']=_0x25d90e;}),_0x5383e5['forEach']((_0x4fd6af,_0x4ddb97)=>{var _0x11eeff=_0xe7adc1;_0x2570fc[_0x4ddb97][_0x11eeff(0xa5)]=_0x4fd6af;}),_0x4916a1[_0xe7adc1(0xee)]((_0x172f68,_0x17e917)=>{var _0x3bff48=_0xe7adc1;_0x2570fc[_0x17e917][_0x3bff48(0x113)]=_0x172f68;}),_0x3fe524[_0xe7adc1(0xee)]((_0x5f093c,_0x3f9719)=>{var _0x470cd2=_0xe7adc1;_0x2570fc[_0x3f9719][_0x470cd2(0xda)]=_0x5f093c;}),_0x3ff164['forEach']((_0x47a42b,_0x5e3e32)=>{_0x2570fc[_0x5e3e32]['maxPerUnit']=_0x47a42b;}),_0x2939fd['forEach']((_0x1031a7,_0x3321aa)=>{var _0xb7eea5=_0xe7adc1;_0x2570fc[_0x3321aa][_0xb7eea5(0xcc)]=_0x1031a7;}),_0x1a5a64['forEach']((_0x4e2eef,_0x117e1b)=>{var _0x44a7c8=_0xe7adc1;_0x2570fc[_0x117e1b][_0x44a7c8(0xc0)]=_0x4e2eef;}),_0x24f3e8['forEach']((_0x2e15c2,_0x54d0a5)=>{_0x2570fc[_0x54d0a5]['secondary_unit']=_0x2e15c2;}),_0x364394[_0xe7adc1(0xee)]((_0x1a1b01,_0x151f03)=>{var _0x50631a=_0xe7adc1;_0x2570fc[_0x151f03][_0x50631a(0x175)]=_0x1a1b01;}),_0x4e15db[_0xe7adc1(0xee)]((_0x4bee14,_0x404406)=>{var _0x3012fb=_0xe7adc1;_0x2570fc[_0x404406][_0x3012fb(0x13f)]=_0x4bee14;}),_0x19b208[_0xe7adc1(0xee)]((_0x556187,_0xdd40c0)=>{var _0x1c038e=_0xe7adc1;_0x2570fc[_0xdd40c0][_0x1c038e(0x9d)]=_0x556187;});var _0xbe15ed=0x0;_0x2570fc['forEach'](_0x34a2d1=>{var _0x489dac=_0xe7adc1;(parseInt(_0x34a2d1[_0x489dac(0xa5)])<parseInt(_0x34a2d1[_0x489dac(0x113)])||parseInt(_0x34a2d1[_0x489dac(0x9a)])<parseInt(_0x34a2d1[_0x489dac(0x113)])&&parseInt(_0x34a2d1['sale_qty'])>parseInt(_0x34a2d1[_0x489dac(0x113)])||parseInt(_0x34a2d1[_0x489dac(0x113)])==0x0)&&_0xbe15ed++;});if(_0xbe15ed!=0x0)return _0x4ce1ef['flash'](_0xe7adc1(0x183),_0xe7adc1(0x15b)),_0x4d5b5b['redirect'](_0xe7adc1(0x15c));const _0x2c3b76=await sales_finished[_0xe7adc1(0xe4)]({'invoice':_0x455b18});_0x2c3b76[_0xe7adc1(0x150)]=_0xe7adc1(0x11e);const _0x48d124=await _0x2c3b76[_0xe7adc1(0xa4)](),_0x1db4db=new sales_return_finished({'invoice':_0x455b18,'customer':_0x4ce1ef['body'][_0xe7adc1(0x11f)],'date':_0x53d9bd,'warehouse_name':_0x205a3e,'room':_0x3d90e8,'ToWarehouse':_0x220f9e,'ToRoom':_0x578ac6,'return_sale':_0x2570fc,'note':_0x401c28,'warehouse_cat':_0x39f6b0}),_0x3963b8=await _0x1db4db[_0xe7adc1(0xa4)](),_0x3e1ae3=await sales_return_finished['findOne']({'invoice':_0x455b18}),_0xb838f0=await warehouse[_0xe7adc1(0xe4)]({'name':_0x220f9e,'room':_0x578ac6,'warehouse_category':_0xe7adc1(0x8c)});_0x3e1ae3[_0xe7adc1(0x165)][_0xe7adc1(0xee)](_0x473367=>{var _0x4bfe18=_0xe7adc1,_0x49a61f=0x0;const _0x5d8314=_0xb838f0[_0x4bfe18(0x73)][_0x4bfe18(0x9f)](_0x4e960e=>{var _0x57fac6=_0x4bfe18;_0x4e960e[_0x57fac6(0x173)]==_0x473367[_0x57fac6(0x173)]&&_0x4e960e[_0x57fac6(0xda)]==_0x473367['bay']&&_0x4e960e['expiry_date']==_0x473367['expiry_date']&&_0x4e960e[_0x57fac6(0x13f)]==_0x473367[_0x57fac6(0x13f)]&&_0x4e960e[_0x57fac6(0xc0)]==_0x473367[_0x57fac6(0xc0)]&&(_0x4e960e[_0x57fac6(0xe0)]=parseInt(_0x4e960e[_0x57fac6(0xe0)])+parseInt(_0x473367[_0x57fac6(0x113)]),_0x49a61f++);});_0x49a61f=='0'&&(_0xb838f0[_0x4bfe18(0x73)]=_0xb838f0[_0x4bfe18(0x73)][_0x4bfe18(0x122)]({'product_name':_0x473367['product_name'],'product_stock':_0x473367[_0x4bfe18(0x113)],'primary_code':_0x473367['primary_code'],'secondary_code':_0x473367[_0x4bfe18(0x16b)],'product_code':_0x473367['product_code'],'bay':_0x473367['bay'],'batch_code':_0x473367[_0x4bfe18(0xc0)],'maxPerUnit':_0x473367[_0x4bfe18(0x138)],'production_date':_0x473367[_0x4bfe18(0x13f)],'expiry_date':_0x473367[_0x4bfe18(0x9d)],'secondary_unit':_0x473367['secondary_unit'],'unit':_0x473367[_0x4bfe18(0x175)],'maxProducts':_0x473367['maxProducts']}));}),await _0xb838f0[_0xe7adc1(0xa4)](),console[_0xe7adc1(0x114)](_0x4ce1ef[_0xe7adc1(0x6e)]);const _0x7530f8=new c_payment_data({'invoice':_0x455b18,'customer':_0x4ce1ef[_0xe7adc1(0x6e)][_0xe7adc1(0x11f)],'reason':_0xe7adc1(0x112)});await _0x7530f8[_0xe7adc1(0xa4)]();const _0x53b99e=await master_shop[_0xe7adc1(0x80)]();console[_0xe7adc1(0x114)](_0xe7adc1(0xf5),_0x53b99e[0x0][_0xe7adc1(0x12a)]);const _0x4b59c9=await email_settings[_0xe7adc1(0xe4)](),_0x1a5c4e=await customer['findOne']({'name':_0x4ce1ef[_0xe7adc1(0x6e)]['customer']});console[_0xe7adc1(0x114)](_0xe7adc1(0xac),_0x1a5c4e);_0x53b99e[0x0]['currency_placement']==0x1?(right_currency=_0x53b99e[0x0][_0xe7adc1(0xb4)],left_currency=''):(right_currency='',left_currency=_0x53b99e[0x0][_0xe7adc1(0xb4)]);var _0x58b8bc=_0x5d0c3a,_0x17fafe=_0x4916a1,_0x50156b='',_0x22461a;for(_0x22461a in _0x58b8bc){_0x50156b+=_0xe7adc1(0x81)+_0xe7adc1(0xc6)+_0x58b8bc[_0x22461a]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x17fafe[_0x22461a]+_0xe7adc1(0xb9)+_0xe7adc1(0xc1);}console['log'](_0xe7adc1(0xef),_0x50156b);let _0x48d766=nodemailer[_0xe7adc1(0xf2)]({'service':_0xe7adc1(0x154),'auth':{'user':_0x4b59c9[_0xe7adc1(0x134)],'pass':_0x4b59c9['password']}}),_0x1e337={'from':_0x4b59c9[_0xe7adc1(0x134)],'to':_0x1a5c4e[_0xe7adc1(0x134)],'subject':_0xe7adc1(0x6c),'attachments':[{'filename':_0xe7adc1(0x160),'path':__dirname+_0xe7adc1(0x105)+_0xe7adc1(0x82)+_0x53b99e[0x0][_0xe7adc1(0x12a)],'cid':_0xe7adc1(0xbb)}],'html':_0xe7adc1(0x17f)+_0xe7adc1(0x8e)+_0xe7adc1(0x7b)+_0xe7adc1(0x16d)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0xe7adc1(0x16d)+_0xe7adc1(0x96)+_0xe7adc1(0x12b)+'<div>'+_0xe7adc1(0x109)+_0x53b99e[0x0][_0xe7adc1(0xd3)]+_0xe7adc1(0x10d)+'</div>'+_0xe7adc1(0x12b)+_0xe7adc1(0xab)+_0xe7adc1(0x16d)+_0xe7adc1(0x6b)+'\x20Order\x20Number\x20:\x20'+_0x455b18+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x53d9bd+'\x20'+_0xe7adc1(0x9b)+'</h5>'+_0xe7adc1(0x12b)+_0xe7adc1(0x79)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xe7adc1(0x81)+_0xe7adc1(0x97)+_0xe7adc1(0xc3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+'</tr>'+'</thead>'+_0xe7adc1(0x117)+'\x20'+_0x50156b+'\x20'+'</tbody>'+_0xe7adc1(0x70)+_0xe7adc1(0x16d)+'<strong>\x20Regards\x20</strong>'+_0xe7adc1(0x74)+_0x53b99e[0x0][_0xe7adc1(0xd3)]+_0xe7adc1(0x10e)+_0xe7adc1(0x12b)+'</div>'+'</body></html>'};_0x48d766[_0xe7adc1(0x12d)](_0x1e337,function(_0x2f0a76,_0xe399ab){var _0x19d90c=_0xe7adc1;_0x2f0a76?(console[_0x19d90c(0x114)](_0x2f0a76),console[_0x19d90c(0x114)](_0x19d90c(0xa6))):console[_0x19d90c(0x114)](_0x19d90c(0x144));}),_0x4ce1ef[_0xe7adc1(0xf4)]('success',_0xe7adc1(0x103)),_0x4d5b5b[_0xe7adc1(0x157)]('/all_sales_finished/view');}catch(_0x3f3151){console[_0xe7adc1(0x114)](_0x3f3151),_0x4d5b5b[_0xe7adc1(0x87)](0xc8)[_0xe7adc1(0xe5)]({'message1':_0x3f3151['message']});}}}),router[a0_0x4f5d6d(0x11d)](a0_0x4f5d6d(0x148),auth,async(_0x130120,_0x252dea)=>{var _0x2ca522=a0_0x4f5d6d;try{const {username:_0x1449bd,email:_0x266e3a,role:_0x12b27f}=_0x130120['user'],_0x4e7c8a=_0x130120[_0x2ca522(0x14b)],_0x239963=await profile[_0x2ca522(0xe4)]({'email':_0x4e7c8a[_0x2ca522(0x134)]}),_0x8cc7bd=await master_shop[_0x2ca522(0x80)]();console[_0x2ca522(0x114)]('barcode\x20Product\x20master',_0x8cc7bd);const _0xcd701a=_0x130120[_0x2ca522(0x132)]['id'],_0x3b9571=await sales[_0x2ca522(0x17c)](_0xcd701a);console[_0x2ca522(0x114)](_0x2ca522(0xae),_0x3b9571);if(_0x8cc7bd[0x0][_0x2ca522(0x135)]==_0x2ca522(0x10a))var _0x22593c=users[_0x2ca522(0x14d)];else{if(_0x8cc7bd[0x0][_0x2ca522(0x135)]==_0x2ca522(0xd9))var _0x22593c=users[_0x2ca522(0xd9)];else{if(_0x8cc7bd[0x0][_0x2ca522(0x135)]==_0x2ca522(0xba))var _0x22593c=users[_0x2ca522(0xba)];else{if(_0x8cc7bd[0x0][_0x2ca522(0x135)]==_0x2ca522(0xd8))var _0x22593c=users[_0x2ca522(0xd8)];else{if(_0x8cc7bd[0x0][_0x2ca522(0x135)]==_0x2ca522(0xed))var _0x22593c=users[_0x2ca522(0xed)];else{if(_0x8cc7bd[0x0]['language']==_0x2ca522(0xe8))var _0x22593c=users[_0x2ca522(0xc7)];else{if(_0x8cc7bd[0x0][_0x2ca522(0x135)]==_0x2ca522(0xe6))var _0x22593c=users[_0x2ca522(0xe6)];else{if(_0x8cc7bd[0x0][_0x2ca522(0x135)]==_0x2ca522(0x107))var _0x22593c=users[_0x2ca522(0x16a)];}}}}}}}_0x252dea['render'](_0x2ca522(0x169),{'success':_0x130120[_0x2ca522(0xf4)]('success'),'errors':_0x130120[_0x2ca522(0xf4)](_0x2ca522(0x183)),'role':_0x4e7c8a,'profile':_0x239963,'alldata':_0x3b9571,'master_shop':_0x8cc7bd,'language':_0x22593c});}catch(_0x3a0060){console['log'](_0x3a0060);}}),router['post']('/barcode_scanner',async(_0x1f226c,_0x427eb0)=>{var _0x5109af=a0_0x4f5d6d;const {product_code:_0x4519d3,warehouse_name:_0x1a5fc3,rooms_data:_0xfbc1d1,Roomslist:_0x3d198e,sales_category:_0x44e937}=_0x1f226c[_0x5109af(0x6e)],_0x50b4ba=_0x3d198e[_0x5109af(0x146)](','),_0x17a8ca=[];async function _0x584998(_0x5eca77){var _0x11311c=_0x5109af;const _0x505e6c=await warehouse[_0x11311c(0x155)]([{'$match':{'name':_0x1a5fc3,'room':_0x5eca77}},{'$unwind':_0x11311c(0x110)},{'$match':{'product_details.primary_code':_0x4519d3}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x11311c(0xfd)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x11311c(0x159)},'secondary_code':{'$first':_0x11311c(0xbe)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x11311c(0x124)},'bay':{'$first':_0x11311c(0xc2)},'type':{'$first':_0x11311c(0xbc)},'pallet':{'$first':_0x11311c(0xf9)},'unit':{'$first':_0x11311c(0xb8)},'secondary_unit':{'$first':_0x11311c(0x14c)},'storage':{'$first':_0x11311c(0x133)},'rack':{'$first':_0x11311c(0xca)},'expiry_date':{'$first':_0x11311c(0xeb)},'production_date':{'$first':_0x11311c(0x13e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x11311c(0xcf)},'product_cat':{'$first':_0x11311c(0xfc)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x11311c(0xf8)},'uuid':{'$first':_0x11311c(0xfb)},'gross_price':{'$first':_0x11311c(0xa7)},'sales_category':{'$first':_0x11311c(0x10f)}}}]),_0x5cf874=await warehouse[_0x11311c(0x155)]([{'$match':{'name':_0x1a5fc3,'room':_0x5eca77}},{'$unwind':_0x11311c(0x110)},{'$match':{'product_details.secondary_code':_0x4519d3}},{'$group':{'_id':_0x11311c(0x115),'name':{'$first':_0x11311c(0xfd)},'product_stock':{'$first':_0x11311c(0x7e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x11311c(0xbe)},'product_code':{'$first':_0x11311c(0x7c)},'level':{'$first':_0x11311c(0xc2)},'isle':{'$first':_0x11311c(0x149)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x11311c(0xb8)},'secondary_unit':{'$first':_0x11311c(0x14c)},'storage':{'$first':_0x11311c(0x133)},'rack':{'$first':_0x11311c(0xca)},'expiry_date':{'$first':_0x11311c(0xeb)},'production_date':{'$first':_0x11311c(0x13e)},'maxPerUnit':{'$first':_0x11311c(0x186)},'batch_code':{'$first':_0x11311c(0xcf)},'product_cat':{'$first':_0x11311c(0xfc)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x11311c(0x152)},'invoice':{'$first':_0x11311c(0xf8)},'uuid':{'$first':_0x11311c(0xfb)},'gross_price':{'$first':_0x11311c(0xa7)},'sales_category':{'$first':_0x11311c(0x10f)}}}]);if(_0x505e6c['length']>0x0)_0x17a8ca[_0x11311c(0x13d)](_0x505e6c);else _0x5cf874[_0x11311c(0x78)]>0x0&&_0x17a8ca[_0x11311c(0x13d)](_0x5cf874);}const _0x566a06=_0x50b4ba[_0x5109af(0x9f)](_0x41fa05=>_0x584998(_0x41fa05));await Promise[_0x5109af(0xdb)](_0x566a06),_0x427eb0[_0x5109af(0xe5)](_0x17a8ca);}),router[a0_0x4f5d6d(0x163)](a0_0x4f5d6d(0x16c),async(_0x2ebf8e,_0x1eb10f)=>{var _0x557a64=a0_0x4f5d6d;const {product_code:_0xe2f23c,warehouse_name:_0x543fe9,rooms_data:_0x8394cf,Roomslist:_0xfb8122,sales_category:_0xc9cc90}=_0x2ebf8e['body'],_0xbb034b=_0xfb8122[_0x557a64(0x146)](','),_0x2a5371=[];async function _0x3ea09c(_0x50b051){var _0x45c999=_0x557a64;const _0x9c1182=await warehouse[_0x45c999(0x155)]([{'$match':{'name':_0x543fe9,'room':_0x50b051}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0xe2f23c,'product_details.sales_category':_0xc9cc90,'product_details.type_products':_0x45c999(0x114)}},{'$group':{'_id':_0x45c999(0x115),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x45c999(0x7e)},'primary_code':{'$first':_0x45c999(0x159)},'secondary_code':{'$first':_0x45c999(0xbe)},'product_code':{'$first':_0x45c999(0x7c)},'level':{'$first':_0x45c999(0x124)},'bay':{'$first':'$product_details.bay'},'type':{'$first':_0x45c999(0xbc)},'pallet':{'$first':_0x45c999(0xf9)},'unit':{'$first':_0x45c999(0xb8)},'secondary_unit':{'$first':_0x45c999(0x14c)},'storage':{'$first':_0x45c999(0x133)},'rack':{'$first':_0x45c999(0xca)},'expiry_date':{'$first':_0x45c999(0xeb)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x45c999(0x186)},'batch_code':{'$first':_0x45c999(0xcf)},'product_cat':{'$first':_0x45c999(0xfc)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x45c999(0x152)},'invoice':{'$first':_0x45c999(0xf8)},'uuid':{'$first':_0x45c999(0xfb)},'gross_price':{'$first':_0x45c999(0xa7)},'sales_category':{'$first':'$product_details.sales_category'},'type_products':{'$first':_0x45c999(0x172)}}}]);console[_0x45c999(0x114)](_0x45c999(0x114)+_0x45c999(0xb7)+_0xe2f23c+'\x20<>\x20'+_0xc9cc90);const _0x2c12b0=await warehouse[_0x45c999(0x155)]([{'$match':{'name':_0x543fe9,'room':_0x50b051}},{'$unwind':_0x45c999(0x110)},{'$match':{'product_details.secondary_code':_0xe2f23c,'product_details.sales_category':_0xc9cc90,'product_details.type_products':_0x45c999(0x114)}},{'$group':{'_id':_0x45c999(0x115),'name':{'$first':_0x45c999(0xfd)},'product_stock':{'$first':_0x45c999(0x7e)},'primary_code':{'$first':_0x45c999(0x159)},'secondary_code':{'$first':_0x45c999(0xbe)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x45c999(0xc2)},'isle':{'$first':_0x45c999(0x149)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x45c999(0xf9)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x45c999(0x14c)},'storage':{'$first':_0x45c999(0x133)},'rack':{'$first':_0x45c999(0xca)},'expiry_date':{'$first':_0x45c999(0xeb)},'production_date':{'$first':_0x45c999(0x13e)},'maxPerUnit':{'$first':_0x45c999(0x186)},'batch_code':{'$first':_0x45c999(0xcf)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x45c999(0xf8)},'uuid':{'$first':'$product_details.uuid'},'gross_price':{'$first':_0x45c999(0xa7)},'sales_category':{'$first':_0x45c999(0x10f)},'type_products':{'$first':_0x45c999(0x172)}}}]);if(_0x9c1182['length']>0x0)_0x2a5371[_0x45c999(0x13d)](_0x9c1182);else _0x2c12b0['length']>0x0&&_0x2a5371[_0x45c999(0x13d)](_0x2c12b0);}const _0x185958=_0xbb034b[_0x557a64(0x9f)](_0x5e826e=>_0x3ea09c(_0x5e826e));await Promise['all'](_0x185958),_0x1eb10f[_0x557a64(0xe5)](_0x2a5371);}),module[a0_0x4f5d6d(0x7d)]=router;