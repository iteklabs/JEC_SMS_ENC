function a0_0x2d52(_0x3df4d9,_0xf58e9){const _0xaa0790=a0_0xaa07();return a0_0x2d52=function(_0x2d52f2,_0x391a9e){_0x2d52f2=_0x2d52f2-0x1d2;let _0x5133a9=_0xaa0790[_0x2d52f2];return _0x5133a9;},a0_0x2d52(_0x3df4d9,_0xf58e9);}const a0_0x45fc9d=a0_0x2d52;(function(_0x40856e,_0x74b4d6){const _0x47bd84=a0_0x2d52,_0x4367e6=_0x40856e();while(!![]){try{const _0x3a5166=parseInt(_0x47bd84(0x22c))/0x1+parseInt(_0x47bd84(0x1ed))/0x2+parseInt(_0x47bd84(0x1d4))/0x3*(-parseInt(_0x47bd84(0x22d))/0x4)+-parseInt(_0x47bd84(0x214))/0x5*(-parseInt(_0x47bd84(0x1e1))/0x6)+parseInt(_0x47bd84(0x223))/0x7+-parseInt(_0x47bd84(0x203))/0x8+parseInt(_0x47bd84(0x228))/0x9*(-parseInt(_0x47bd84(0x20b))/0xa);if(_0x3a5166===_0x74b4d6)break;else _0x4367e6['push'](_0x4367e6['shift']());}catch(_0x2ae267){_0x4367e6['push'](_0x4367e6['shift']());}}}(a0_0xaa07,0x1aade));const express=require(a0_0x45fc9d(0x1df)),app=express(),router=express[a0_0x45fc9d(0x245)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,purchases_return_finished}=require(a0_0x45fc9d(0x241)),auth=require(a0_0x45fc9d(0x1fc)),users=require(a0_0x45fc9d(0x206));router[a0_0x45fc9d(0x1de)](a0_0x45fc9d(0x202),auth,async(_0x2e3ca6,_0x25a231)=>{const _0x33562a=a0_0x45fc9d;try{const {username:_0x506597,email:_0x14291c,role:_0x45cafc}=_0x2e3ca6['user'],_0x6ad322=_0x2e3ca6['user'],_0x4cda0f=await profile[_0x33562a(0x1e0)]({'email':_0x6ad322[_0x33562a(0x1d3)]}),_0x34f320=await master_shop[_0x33562a(0x20e)]();console[_0x33562a(0x200)]('master',_0x34f320);const _0x54722d=await purchases_return_finished[_0x33562a(0x246)]([{'$lookup':{'from':_0x33562a(0x225),'localField':_0x33562a(0x225),'foreignField':'name','as':_0x33562a(0x210)}},{'$unwind':_0x33562a(0x1db)},{'$unwind':'$supplier_docs'},{'$group':{'_id':_0x33562a(0x1ea),'invoice':{'$first':'$invoice'},'date':{'$first':_0x33562a(0x23a)},'suppliers':{'$first':_0x33562a(0x1e8)},'warehouse_name':{'$first':_0x33562a(0x1f9)},'product_name':{'$first':_0x33562a(0x1f4)},'return_qty':{'$first':_0x33562a(0x23c)},'price':{'$first':_0x33562a(0x209)},'total':{'$sum':_0x33562a(0x219)},'note':{'$first':_0x33562a(0x20a)},'total_amount':{'$first':_0x33562a(0x1fd)},'discount':{'$first':_0x33562a(0x218)},'receivable':{'$first':_0x33562a(0x204)},'received':{'$first':_0x33562a(0x201)},'due_amount':{'$first':'$due_amount'},'mobile':{'$first':_0x33562a(0x208)},'email':{'$first':'$supplier_docs.email'},'address':{'$first':_0x33562a(0x1dc)},'return_sum_qty':{'$sum':'$return_product.return_qty'}}}]);console[_0x33562a(0x200)](_0x54722d);if(_0x34f320[0x0][_0x33562a(0x248)]==_0x33562a(0x1f6)){var _0x410924=users[_0x33562a(0x240)];console[_0x33562a(0x200)](_0x410924);}else{if(_0x34f320[0x0][_0x33562a(0x248)]==_0x33562a(0x21a))var _0x410924=users['Hindi'];else{if(_0x34f320[0x0][_0x33562a(0x248)]==_0x33562a(0x23f))var _0x410924=users['German'];else{if(_0x34f320[0x0][_0x33562a(0x248)]=='Spanish')var _0x410924=users[_0x33562a(0x1fa)];else{if(_0x34f320[0x0]['language']==_0x33562a(0x22a))var _0x410924=users[_0x33562a(0x22a)];else{if(_0x34f320[0x0][_0x33562a(0x248)]=='Portuguese\x20(BR)')var _0x410924=users[_0x33562a(0x23d)];else{if(_0x34f320[0x0][_0x33562a(0x248)]==_0x33562a(0x22f))var _0x410924=users[_0x33562a(0x22f)];else{if(_0x34f320[0x0][_0x33562a(0x248)]==_0x33562a(0x1e2))var _0x410924=users[_0x33562a(0x237)];}}}}}}}_0x25a231[_0x33562a(0x1f1)](_0x33562a(0x1d8),{'success':_0x2e3ca6[_0x33562a(0x1ee)](_0x33562a(0x1d7)),'errors':_0x2e3ca6['flash'](_0x33562a(0x21b)),'role':_0x6ad322,'profile':_0x4cda0f,'master_shop':_0x34f320,'user':_0x54722d,'language':_0x410924});}catch(_0x41c4ae){console[_0x33562a(0x200)](_0x41c4ae);}}),router[a0_0x45fc9d(0x1de)](a0_0x45fc9d(0x1f0),auth,async(_0x444a3b,_0x21e0d3)=>{const _0x335202=a0_0x45fc9d;try{const {username:_0x404457,email:_0x97bb42,role:_0x2cf023}=_0x444a3b['user'],_0x326dc3=_0x444a3b[_0x335202(0x1e5)],_0x12f68c=await profile[_0x335202(0x1e0)]({'email':_0x326dc3[_0x335202(0x1d3)]}),_0xeec3de=await product['find']({}),_0x5a8e1c=await master_shop[_0x335202(0x20e)](),_0x518465=_0x444a3b[_0x335202(0x1f7)]['id'],_0x372bb6=await purchases_return_finished[_0x335202(0x224)](_0x518465),_0x9c825a=await warehouse[_0x335202(0x246)]([{'$match':{'name':_0x372bb6[_0x335202(0x1d2)],'room':_0x372bb6[_0x335202(0x21d)],'warehouse_category':_0x335202(0x1e9)}},{'$unwind':_0x335202(0x1f3)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x335202(0x212)},'bay':{'$first':_0x335202(0x220)},'bin':{'$first':_0x335202(0x213)},'type':{'$first':_0x335202(0x1ff)},'floorlevel':{'$first':_0x335202(0x227)},'primary_code':{'$first':_0x335202(0x233)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x335202(0x20c)},'storage':{'$first':_0x335202(0x21e)},'rack':{'$first':_0x335202(0x244)}}}]);warehouse_data=await warehouse[_0x335202(0x246)]([{'$match':{'status':'Enabled','name':_0x335202(0x21f),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x335202(0x24a),'name':{'$first':_0x335202(0x24a)}}},{'$sort':{'name':0x1}}]),console['log'](_0x335202(0x1e7),_0x9c825a);if(_0x5a8e1c[0x0][_0x335202(0x248)]=='English\x20(US)'){var _0x2dbf33=users[_0x335202(0x240)];console[_0x335202(0x200)](_0x2dbf33);}else{if(_0x5a8e1c[0x0][_0x335202(0x248)]==_0x335202(0x21a))var _0x2dbf33=users[_0x335202(0x21a)];else{if(_0x5a8e1c[0x0][_0x335202(0x248)]==_0x335202(0x23f))var _0x2dbf33=users[_0x335202(0x23f)];else{if(_0x5a8e1c[0x0]['language']==_0x335202(0x1fa))var _0x2dbf33=users[_0x335202(0x1fa)];else{if(_0x5a8e1c[0x0][_0x335202(0x248)]==_0x335202(0x22a))var _0x2dbf33=users[_0x335202(0x22a)];else{if(_0x5a8e1c[0x0]['language']==_0x335202(0x23b))var _0x2dbf33=users['Portuguese'];else{if(_0x5a8e1c[0x0]['language']=='Chinese')var _0x2dbf33=users[_0x335202(0x22f)];else{if(_0x5a8e1c[0x0][_0x335202(0x248)]==_0x335202(0x1e2))var _0x2dbf33=users[_0x335202(0x237)];}}}}}}}_0x21e0d3[_0x335202(0x1f1)](_0x335202(0x24b),{'success':_0x444a3b[_0x335202(0x1ee)](_0x335202(0x1d7)),'errors':_0x444a3b[_0x335202(0x1ee)]('errors'),'role':_0x326dc3,'master_shop':_0x5a8e1c,'profile':_0x12f68c,'user':_0x372bb6,'stock':_0x9c825a,'product':_0xeec3de,'language':_0x2dbf33,'warehouse':warehouse_data});}catch(_0x4e585a){console[_0x335202(0x200)](_0x4e585a);}}),router[a0_0x45fc9d(0x1d9)](a0_0x45fc9d(0x1f0),auth,async(_0x15c136,_0x4024b4)=>{const _0x344850=a0_0x45fc9d;try{const _0x3a6ef5=_0x15c136[_0x344850(0x1f7)]['id'],_0x5a82cd=await purchases_return_finished[_0x344850(0x1e0)]({'invoice':_0x15c136[_0x344850(0x20d)]['invoice']}),_0x52b440=await warehouse[_0x344850(0x1e0)]({'name':_0x5a82cd[_0x344850(0x229)],'room':_0x5a82cd[_0x344850(0x226)],'warehouse_category':_0x344850(0x1e9)}),{invoice:_0x11ea93,suppliers:_0x625b2d,date:_0x30e7dc,warehouse_name:_0xfd31bd,product_name:_0x3a19cf,purchase_quantity:_0x207e5b,stocks:_0x118222,return_qty:_0x501225,note:_0x2058d7,Room_name:_0x58482a,level:_0x5c4523,isle:_0x4218e5,pallet:_0x2c70f0,to_warehouse_name:_0x3a1c68,to_Room_name:_0x588b7a}=_0x15c136[_0x344850(0x20d)];if(typeof _0x3a19cf==_0x344850(0x1e3))var _0x55b12c=[_0x15c136['body'][_0x344850(0x1ec)]],_0x5d3542=[_0x15c136[_0x344850(0x20d)][_0x344850(0x243)]],_0x5bdcf0=[_0x15c136[_0x344850(0x20d)][_0x344850(0x1dd)]],_0x4f33da=[_0x15c136['body'][_0x344850(0x205)]],_0x8b064a=[_0x15c136[_0x344850(0x20d)]['level']],_0x550096=[_0x15c136[_0x344850(0x20d)][_0x344850(0x217)]],_0xf7f6c9=[_0x15c136['body'][_0x344850(0x242)]],_0x5a8da2=[_0x15c136['body'][_0x344850(0x1eb)]];else var _0x55b12c=[..._0x15c136['body'][_0x344850(0x1ec)]],_0x5d3542=[..._0x15c136[_0x344850(0x20d)][_0x344850(0x243)]],_0x5bdcf0=[..._0x15c136[_0x344850(0x20d)][_0x344850(0x1dd)]],_0x4f33da=[..._0x15c136[_0x344850(0x20d)][_0x344850(0x205)]],_0x8b064a=[..._0x15c136[_0x344850(0x20d)][_0x344850(0x23e)]],_0x550096=[..._0x15c136[_0x344850(0x20d)][_0x344850(0x217)]],_0xf7f6c9=[..._0x15c136[_0x344850(0x20d)]['primary_code_hide']],_0x5a8da2=[..._0x15c136[_0x344850(0x20d)][_0x344850(0x1eb)]];const _0x5ea7e5=_0x55b12c[_0x344850(0x216)](_0xcab859=>{return _0xcab859={'product_name':_0xcab859};});_0x5d3542[_0x344850(0x236)]((_0x3f23d2,_0x318aaf)=>{const _0x1fa63e=_0x344850;_0x5ea7e5[_0x318aaf][_0x1fa63e(0x243)]=_0x3f23d2;}),_0x5bdcf0[_0x344850(0x236)]((_0x3a7824,_0x6d54e0)=>{const _0x1f7d2e=_0x344850;_0x5ea7e5[_0x6d54e0][_0x1f7d2e(0x22e)]=_0x3a7824;}),_0x4f33da[_0x344850(0x236)]((_0x44dd75,_0x82c148)=>{const _0x1aaeec=_0x344850;_0x5ea7e5[_0x82c148][_0x1aaeec(0x205)]=_0x44dd75;}),_0x8b064a[_0x344850(0x236)]((_0x50dd7f,_0x5ce736)=>{_0x5ea7e5[_0x5ce736]['bay']=_0x50dd7f;}),_0x550096['forEach']((_0x55122e,_0x50dc51)=>{const _0x4f8b9e=_0x344850;_0x5ea7e5[_0x50dc51][_0x4f8b9e(0x239)]=_0x55122e;}),_0xf7f6c9['forEach']((_0x32f187,_0x39cf63)=>{const _0xcbfd99=_0x344850;_0x5ea7e5[_0x39cf63][_0xcbfd99(0x234)]=_0x32f187;}),_0x5a8da2['forEach']((_0x3b5889,_0x383575)=>{_0x5ea7e5[_0x383575]['secondary_code']=_0x3b5889;});var _0x2794e9=0x0;_0x5ea7e5['forEach'](_0x336624=>{const _0x32a62e=_0x344850;(parseInt(_0x336624[_0x32a62e(0x243)])<parseInt(_0x336624[_0x32a62e(0x205)])||parseInt(_0x336624[_0x32a62e(0x22e)])<parseInt(_0x336624[_0x32a62e(0x205)]))&&_0x2794e9++;});if(_0x2794e9!=0x0)return _0x15c136[_0x344850(0x1ee)]('errors','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty'),_0x4024b4[_0x344850(0x1da)](_0x344850(0x1fe));_0x5a82cd['return_product'][_0x344850(0x236)](_0x1f9576=>{const _0x89193f=_0x344850;if(_0x1f9576[_0x89193f(0x205)]>0x0){const _0x1c5948=_0x52b440[_0x89193f(0x231)][_0x89193f(0x216)](_0x1ba987=>{const _0x45a038=_0x89193f;_0x1ba987[_0x45a038(0x1ec)]==_0x1f9576['product_name']&&_0x1ba987['bay']==_0x1f9576[_0x45a038(0x1d6)]&&(_0x1ba987[_0x45a038(0x249)]=parseInt(_0x1ba987['product_stock'])+parseInt(_0x1f9576[_0x45a038(0x205)]));});}}),await _0x52b440[_0x344850(0x20f)](),_0x5a82cd[_0x344850(0x1f2)]=_0x11ea93,_0x5a82cd[_0x344850(0x225)]=_0x625b2d,_0x5a82cd['date']=_0x30e7dc,_0x5a82cd[_0x344850(0x1d2)]=_0xfd31bd,_0x5a82cd[_0x344850(0x215)]=_0x5ea7e5,_0x5a82cd[_0x344850(0x235)]=_0x2058d7,_0x5a82cd[_0x344850(0x21d)]=_0x58482a,_0x5a82cd['to_warehouse_name']=_0x3a1c68,_0x5a82cd[_0x344850(0x226)]=_0x588b7a;const _0x3e117e=await _0x5a82cd[_0x344850(0x20f)](),_0xc28a69=await purchases_return_finished[_0x344850(0x1e0)]({'invoice':_0x15c136[_0x344850(0x20d)][_0x344850(0x1f2)]}),_0x4dac1e=await warehouse[_0x344850(0x1e0)]({'name':_0x15c136[_0x344850(0x20d)][_0x344850(0x229)],'room':_0x15c136[_0x344850(0x20d)][_0x344850(0x1fb)],'warehouse_category':_0x344850(0x1e9)});_0xc28a69[_0x344850(0x215)][_0x344850(0x236)](_0x28bf13=>{const _0x517906=_0x344850;_0x4dac1e[_0x517906(0x231)][_0x517906(0x216)](_0x267a8=>{const _0x601a90=_0x517906;_0x267a8[_0x601a90(0x1ec)]==_0x28bf13[_0x601a90(0x1ec)]&&_0x267a8['bay']==_0x28bf13[_0x601a90(0x1d6)]&&(_0x267a8[_0x601a90(0x249)]=parseInt(_0x267a8[_0x601a90(0x249)])-parseInt(_0x28bf13['return_qty']));});}),await _0x4dac1e['save']();const _0x9ff45a=await s_payment_data[_0x344850(0x1e0)]({'invoice':_0x15c136[_0x344850(0x20d)]['invoice'],'reason':_0x344850(0x207)});await _0x9ff45a[_0x344850(0x20f)](),_0x15c136[_0x344850(0x1ee)](_0x344850(0x1d7),_0x344850(0x222)),_0x4024b4['redirect'](_0x344850(0x230));}catch(_0x46aa37){console['log'](_0x46aa37),_0x4024b4['status'](0xc8)[_0x344850(0x211)]({'message':_0x46aa37[_0x344850(0x1ef)]});}}),router[a0_0x45fc9d(0x1de)](a0_0x45fc9d(0x22b),auth,async(_0x4a3c27,_0x1f651b)=>{const _0x44aa30=a0_0x45fc9d;try{const {username:_0x12d78f,email:_0x40d3b1,role:_0x5dcf5c}=_0x4a3c27[_0x44aa30(0x1e5)],_0x54576b=_0x4a3c27['user'],_0x3892ea=await profile['findOne']({'email':_0x54576b[_0x44aa30(0x1d3)]}),_0x5123fa=await master_shop[_0x44aa30(0x20e)]();console['log'](_0x44aa30(0x1e6),_0x5123fa);const _0x5a99da=_0x4a3c27[_0x44aa30(0x1f7)]['id'],_0x9b6026=await purchases_return['findById'](_0x5a99da);console[_0x44aa30(0x200)](_0x9b6026);const _0x434380=await suppliers[_0x44aa30(0x1e0)]({'name':_0x9b6026['suppliers']});console['log'](_0x434380);if(_0x5123fa[0x0][_0x44aa30(0x248)]==_0x44aa30(0x1f6)){var _0x21431a=users[_0x44aa30(0x240)];console['log'](_0x21431a);}else{if(_0x5123fa[0x0]['language']==_0x44aa30(0x21a))var _0x21431a=users[_0x44aa30(0x21a)];else{if(_0x5123fa[0x0]['language']==_0x44aa30(0x23f))var _0x21431a=users['German'];else{if(_0x5123fa[0x0][_0x44aa30(0x248)]==_0x44aa30(0x1fa))var _0x21431a=users[_0x44aa30(0x1fa)];else{if(_0x5123fa[0x0][_0x44aa30(0x248)]=='French')var _0x21431a=users[_0x44aa30(0x22a)];else{if(_0x5123fa[0x0][_0x44aa30(0x248)]=='Portuguese\x20(BR)')var _0x21431a=users[_0x44aa30(0x23d)];else{if(_0x5123fa[0x0][_0x44aa30(0x248)]==_0x44aa30(0x22f))var _0x21431a=users[_0x44aa30(0x22f)];else{if(_0x5123fa[0x0]['language']==_0x44aa30(0x1e2))var _0x21431a=users['Arabic'];}}}}}}}_0x1f651b[_0x44aa30(0x1f1)]('return_purchase_invoice',{'success':_0x4a3c27[_0x44aa30(0x1ee)](_0x44aa30(0x1d7)),'errors':_0x4a3c27['flash'](_0x44aa30(0x21b)),'role':_0x54576b,'profile':_0x3892ea,'master_shop':_0x5123fa,'supplier':_0x434380,'purchase':_0x9b6026,'language':_0x21431a});}catch(_0x249420){console[_0x44aa30(0x200)](_0x249420);}}),router[a0_0x45fc9d(0x1d9)](a0_0x45fc9d(0x1f5),auth,async(_0x1b5ac8,_0x1ca6da)=>{const _0x3c2f62=a0_0x45fc9d;try{const _0x3cd228=_0x1b5ac8[_0x3c2f62(0x1f7)]['id'],{invoice:_0x176c74,suppliers:_0x1db0f6,receivable_amount:_0x3282f5,received_amount:_0x55a152}=_0x1b5ac8['body'],_0x17addf=await purchases_return[_0x3c2f62(0x224)](_0x3cd228);console[_0x3c2f62(0x200)](_0x17addf);var _0x67bacc=_0x3282f5-_0x55a152;console[_0x3c2f62(0x200)](_0x55a152),_0x17addf['received']=parseFloat(_0x55a152)+parseFloat(_0x17addf['received']),_0x17addf[_0x3c2f62(0x1e4)]=_0x67bacc,console['log'](_0x17addf);const _0x263d4c=await _0x17addf[_0x3c2f62(0x20f)](),_0x9f199b=await s_payment_data[_0x3c2f62(0x1e0)]({'invoice':_0x1b5ac8[_0x3c2f62(0x20d)]['invoice'],'reason':_0x3c2f62(0x207)});_0x9f199b[_0x3c2f62(0x21c)]=_0x67bacc,await _0x9f199b['save']();let _0x38a62b=new Date(),_0xf50663=('0'+_0x38a62b[_0x3c2f62(0x247)]())[_0x3c2f62(0x232)](-0x2),_0xeb019a=('0'+(_0x38a62b[_0x3c2f62(0x1d5)]()+0x1))['slice'](-0x2),_0x1b24e6=_0x38a62b[_0x3c2f62(0x221)](),_0x40caaf=_0x1b24e6+'-'+_0xeb019a+'-'+_0xf50663;const _0x18fa1f=new suppliers_payment({'invoice':_0x176c74,'date':_0x1b24e6+'-'+_0xeb019a+'-'+_0xf50663,'suppliers':_0x1db0f6,'reason':'Received\x20For\x20Purchase\x20Return','amount':_0x55a152}),_0x1031b1=await _0x18fa1f[_0x3c2f62(0x20f)]();_0x1b5ac8[_0x3c2f62(0x1ee)](_0x3c2f62(0x1d7),_0x3c2f62(0x238)),_0x1ca6da['redirect']('/purchases_return/view');}catch(_0x55c867){console[_0x3c2f62(0x200)](_0x55c867);}}),module[a0_0x45fc9d(0x1f8)]=router;function a0_0xaa07(){const _0x3f8c71=['$product_details.type','log','$received','/view','602304EibqZg','$receivable','return_qty','../public/language/languages.json','Purchase\x20Return','$supplier_docs.mobile','$return_product.price','$note','20jMpKcv','$product_details.product_code','body','find','save','supplier_docs','json','$product_details.product_stock','$product_details.bin','136745cqlNNn','return_product','map','product_code_hide','$discount','$return_product.total','Hindi','errors','amount','room','$product_details.storage','Return\x20Goods','$product_details.bay','getFullYear','purchase\x20return\x20successfully','1028923LeXzbe','findById','suppliers','to_room','$product_details.floorlevel','231741chgUyY','to_warehouse_name','French','/invoice/:id','112209jhJKlC','314264wMJEYA','stock_quantity','Chinese','/purchases_return_finished/view','product_details','slice','$product_details.primary_code','primary_code','note','forEach','Arabic','payment\x20successfull','product_code','$date','Portuguese\x20(BR)','$return_product.return_qty','Portuguese','level','German','English','../models/all_models','primary_code_hide','purchase_quantity','$product_details.rack','Router','aggregate','getDate','language','product_stock','$name','return_purchase_edit_finished','warehouse_name','email','6GpEEAW','getMonth','bay','success','purchases_return_finished','post','redirect','$return_product','$supplier_docs.address','stocks','get','express','findOne','6hpkLrL','Arabic\x20(ae)','string','due_amount','user','master','stock_data','$suppliers','Finished\x20Goods','$_id','secondary_code_hide','product_name','213298qnaWrK','flash','message','/view/:id','render','invoice','$product_details','$return_product.product_name','/receive_payment/:id','English\x20(US)','params','exports','$warehouse_name','Spanish','to_Room_name','../middleware/auth','$total_amount','back'];a0_0xaa07=function(){return _0x3f8c71;};return a0_0xaa07();}