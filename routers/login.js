const a0_0x500f44=a0_0x3431;function a0_0x4efb(){const _0x47a8f7=['findOne','status','/login','errors','flash','warehouse','email','your\x20password\x20is\x20wrong','1293woZqOC','cookie','body','7635447OIVbyu','account_category','params','853132cYfAiU','Router','8BdGpZe','13237140eQmMMW','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','compare','377122XnLhwz','login','sign','4221940wUhWfs','your\x20email\x20is\x20not\x20register','bcryptjs','render','login\x20master','find','success','/staff/view','role','280049zhfyed','2276puZiAe','username','exports','secret_key','validate','staff','redirect','log','/logout','jsonwebtoken','_id','78sRGvGT','type_of_acc_cat','password','/index','login\x20staff','Disabled','jwt','get','/staff/:id'];a0_0x4efb=function(){return _0x47a8f7;};return a0_0x4efb();}function a0_0x3431(_0x4e799a,_0xb6b890){const _0x4efb10=a0_0x4efb();return a0_0x3431=function(_0x34316a,_0x127a17){_0x34316a=_0x34316a-0xf7;let _0x165ef6=_0x4efb10[_0x34316a];return _0x165ef6;},a0_0x3431(_0x4e799a,_0xb6b890);}(function(_0x25ec24,_0x49415d){const _0x1a49ae=a0_0x3431,_0x10868e=_0x25ec24();while(!![]){try{const _0x20d4aa=-parseInt(_0x1a49ae(0x127))/0x1+parseInt(_0x1a49ae(0x121))/0x2+-parseInt(_0x1a49ae(0x11b))/0x3*(-parseInt(_0x1a49ae(0xff))/0x4)+-parseInt(_0x1a49ae(0x12a))/0x5+-parseInt(_0x1a49ae(0x10a))/0x6*(-parseInt(_0x1a49ae(0xfe))/0x7)+parseInt(_0x1a49ae(0x123))/0x8*(-parseInt(_0x1a49ae(0x11e))/0x9)+parseInt(_0x1a49ae(0x124))/0xa;if(_0x20d4aa===_0x49415d)break;else _0x10868e['push'](_0x10868e['shift']());}catch(_0x21db7a){_0x10868e['push'](_0x10868e['shift']());}}}(a0_0x4efb,0x6cd15));const express=require('express'),app=express(),router=express[a0_0x500f44(0x122)](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x500f44(0xf7)),jwt=require(a0_0x500f44(0x108)),auth=require('../middleware/auth');router[a0_0x500f44(0x111)]('/',async(_0x5415d0,_0x4fcf29)=>{const _0x13f218=a0_0x500f44;try{const _0x6a2a37=await master_shop[_0x13f218(0xfa)]();_0x4fcf29[_0x13f218(0xf8)](_0x13f218(0x128),{'success':_0x5415d0[_0x13f218(0x117)]('success'),'errors':_0x5415d0['flash'](_0x13f218(0x116)),'master_shop':_0x6a2a37});}catch(_0x352987){console[_0x13f218(0x106)](_0x352987);}}),router[a0_0x500f44(0x111)]('/validate',async(_0x1ce1fd,_0x5e7f80)=>{const _0x73e357=a0_0x500f44;try{const _0x3f779c=await master_shop['find']();_0x5e7f80[_0x73e357(0xf8)](_0x73e357(0x103),{'success':_0x1ce1fd[_0x73e357(0x117)]('success'),'errors':_0x1ce1fd[_0x73e357(0x117)](_0x73e357(0x116)),'master_shop':_0x3f779c});}catch(_0x48f143){console[_0x73e357(0x106)](_0x48f143);}}),router[a0_0x500f44(0x111)](a0_0x500f44(0x115),async(_0x3b6355,_0x19c379)=>{const _0xec079b=a0_0x500f44;try{const _0x3316f6=await master_shop[_0xec079b(0xfa)]();console[_0xec079b(0x106)](_0xec079b(0xf9),_0x3316f6),_0x19c379[_0xec079b(0xf8)](_0xec079b(0x128),{'success':_0x3b6355['flash'](_0xec079b(0xfb)),'errors':_0x3b6355[_0xec079b(0x117)](_0xec079b(0x116)),'master_shop':_0x3316f6});}catch(_0xb41b38){console[_0xec079b(0x106)](_0xb41b38);}}),router['post'](a0_0x500f44(0x115),async(_0x5e6372,_0x428c62)=>{const _0x61126b=a0_0x500f44;try{const _0x2561df=_0x5e6372[_0x61126b(0x11d)]['email'],_0x350c68=await sing_up[_0x61126b(0x113)]({'email':_0x2561df});if(!_0x350c68)return _0x5e6372[_0x61126b(0x117)](_0x61126b(0x116),_0x61126b(0x12b)),_0x428c62['redirect'](_0x61126b(0x115));const _0xfe823=await staff[_0x61126b(0x113)]({'email':_0x350c68[_0x61126b(0x119)]});var _0x1e0bbc=_0xfe823['account_category'],_0x1a9fc2=_0xfe823['type_of_acc_cat'],_0x2412a1=_0xfe823[_0x61126b(0x109)],_0x1adab3=_0xfe823['warehouse'];if(_0x350c68[_0x61126b(0xfd)]==_0x61126b(0x104)){const _0x53cbc4=await staff[_0x61126b(0x113)]({'email':_0x350c68['email']});if(_0x53cbc4['status']==_0x61126b(0x10f))return _0x5e6372[_0x61126b(0x117)]('errors',_0x61126b(0x125)),_0x428c62[_0x61126b(0x105)]('/login');_0x1e0bbc=_0x53cbc4[_0x61126b(0x11f)],_0x1a9fc2=_0x53cbc4[_0x61126b(0x10b)],_0x2412a1=_0x53cbc4[_0x61126b(0x109)],_0x1adab3=_0x53cbc4['warehouse'];}const _0x246e1f=_0x5e6372[_0x61126b(0x11d)][_0x61126b(0x10c)],_0x4dea98=await bcrypt[_0x61126b(0x126)](_0x246e1f,_0x350c68['password']);if(_0x4dea98==![])return _0x5e6372[_0x61126b(0x117)](_0x61126b(0x116),_0x61126b(0x11a)),_0x428c62[_0x61126b(0x105)](_0x61126b(0x115));const _0x3644de=jwt[_0x61126b(0x129)]({'username':_0x350c68['username'],'email':_0x350c68[_0x61126b(0x119)],'role':_0x350c68['role'],'account_category':_0x1e0bbc,'sales_category':_0x1a9fc2,'sttaff_id':_0x2412a1,'warehouse':_0x1adab3},process['env']['secret_key']);_0x428c62[_0x61126b(0x11c)]('jwt',_0x3644de,{'expires':new Date(0xe677d213a700)}),_0x5e6372['flash']('success','login\x20successfully'),_0x428c62[_0x61126b(0x105)](_0x61126b(0x10d));}catch(_0x21422b){console[_0x61126b(0x106)](_0x21422b);}}),router[a0_0x500f44(0x111)](a0_0x500f44(0x112),async(_0x272153,_0x1f19a1)=>{const _0x25d9de=a0_0x500f44;try{const _0x36055d=_0x272153[_0x25d9de(0x120)]['id'],_0x31f35a=await staff['findById']({'_id':_0x36055d});console[_0x25d9de(0x106)](_0x25d9de(0x10e),_0x31f35a);const _0xf9ed1c=await staff[_0x25d9de(0x113)]({'email':_0x31f35a[_0x25d9de(0x119)]}),_0x20aec4=await sing_up[_0x25d9de(0x113)]({'email':_0x31f35a[_0x25d9de(0x119)]});var _0x4296cf=_0xf9ed1c[_0x25d9de(0x11f)],_0xa63118=_0xf9ed1c[_0x25d9de(0x10b)],_0x1a1e8d=_0xf9ed1c[_0x25d9de(0x109)],_0x42efac=_0xf9ed1c[_0x25d9de(0x118)];if(_0x20aec4[_0x25d9de(0xfd)]=='staff'){const _0x16f799=await staff['findOne']({'email':_0x20aec4[_0x25d9de(0x119)]});if(_0x16f799[_0x25d9de(0x114)]==_0x25d9de(0x10f))return _0x272153[_0x25d9de(0x117)](_0x25d9de(0x116),_0x25d9de(0x125)),_0x1f19a1[_0x25d9de(0x105)](_0x25d9de(0xfc));_0x4296cf=_0x16f799[_0x25d9de(0x11f)],_0xa63118=_0x16f799[_0x25d9de(0x10b)],_0x1a1e8d=_0x16f799[_0x25d9de(0x109)],_0x42efac=_0x16f799[_0x25d9de(0x118)];}const _0x17bf07=jwt[_0x25d9de(0x129)]({'username':_0x20aec4[_0x25d9de(0x100)],'email':_0x20aec4[_0x25d9de(0x119)],'role':_0x20aec4[_0x25d9de(0xfd)],'account_category':_0x4296cf,'sales_category':_0xa63118,'sttaff_id':_0x1a1e8d,'warehouse':_0x42efac},process['env'][_0x25d9de(0x102)]);_0x1f19a1['cookie']('jwt',_0x17bf07,{'expires':new Date(0xe677d213a700)}),_0x272153[_0x25d9de(0x117)](_0x25d9de(0xfb),'login\x20successfully'),_0x1f19a1[_0x25d9de(0x105)]('/index');}catch(_0x28805c){console[_0x25d9de(0x106)](_0x28805c);}}),router[a0_0x500f44(0x111)](a0_0x500f44(0x107),(_0x2c9c34,_0xb102c9)=>{const _0x49dc2b=a0_0x500f44;_0xb102c9['clearCookie'](_0x49dc2b(0x110)),_0xb102c9['redirect'](_0x49dc2b(0x115));}),module[a0_0x500f44(0x101)]=router;