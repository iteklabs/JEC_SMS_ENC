const a0_0x4f0bfa=a0_0x365d;(function(_0x1fdfbc,_0x1aa220){const _0x291ab4=a0_0x365d,_0x1017b3=_0x1fdfbc();while(!![]){try{const _0x5f5c23=-parseInt(_0x291ab4(0x16f))/0x1+parseInt(_0x291ab4(0x16a))/0x2+parseInt(_0x291ab4(0x17b))/0x3+parseInt(_0x291ab4(0x175))/0x4+-parseInt(_0x291ab4(0x176))/0x5*(parseInt(_0x291ab4(0x14e))/0x6)+parseInt(_0x291ab4(0x151))/0x7+-parseInt(_0x291ab4(0x16d))/0x8;if(_0x5f5c23===_0x1aa220)break;else _0x1017b3['push'](_0x1017b3['shift']());}catch(_0x46c0d2){_0x1017b3['push'](_0x1017b3['shift']());}}}(a0_0x3ec7,0x3e838));function a0_0x365d(_0x2b24d8,_0x108e98){const _0x3ec717=a0_0x3ec7();return a0_0x365d=function(_0x365dcd,_0x2faa86){_0x365dcd=_0x365dcd-0x14d;let _0x2df5c3=_0x3ec717[_0x365dcd];return _0x2df5c3;},a0_0x365d(_0x2b24d8,_0x108e98);}const express=require(a0_0x4f0bfa(0x164)),app=express(),router=express['Router'](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x4f0bfa(0x166)),jwt=require(a0_0x4f0bfa(0x15e)),auth=require(a0_0x4f0bfa(0x169));router[a0_0x4f0bfa(0x159)]('/',async(_0x435c50,_0x55d990)=>{const _0x477af3=a0_0x4f0bfa;try{const _0x53e638=await master_shop[_0x477af3(0x15d)]();_0x55d990[_0x477af3(0x15a)](_0x477af3(0x152),{'success':_0x435c50[_0x477af3(0x174)](_0x477af3(0x16c)),'errors':_0x435c50['flash'](_0x477af3(0x165)),'master_shop':_0x53e638});}catch(_0xb920a7){console[_0x477af3(0x160)](_0xb920a7);}}),router[a0_0x4f0bfa(0x159)](a0_0x4f0bfa(0x17e),async(_0x597220,_0x41f77f)=>{const _0x42e93a=a0_0x4f0bfa;try{const _0x530745=await master_shop[_0x42e93a(0x15d)]();_0x41f77f['render'](_0x42e93a(0x161),{'success':_0x597220[_0x42e93a(0x174)]('success'),'errors':_0x597220[_0x42e93a(0x174)](_0x42e93a(0x165)),'master_shop':_0x530745});}catch(_0x2e3b64){console['log'](_0x2e3b64);}}),router[a0_0x4f0bfa(0x159)](a0_0x4f0bfa(0x16e),async(_0x173608,_0x3e90ed)=>{const _0x5093c8=a0_0x4f0bfa;try{const _0xd27d0=await master_shop['find']();console[_0x5093c8(0x160)](_0x5093c8(0x17d),_0xd27d0),_0x3e90ed[_0x5093c8(0x15a)](_0x5093c8(0x152),{'success':_0x173608[_0x5093c8(0x174)](_0x5093c8(0x16c)),'errors':_0x173608[_0x5093c8(0x174)]('errors'),'master_shop':_0xd27d0});}catch(_0x6cb6b7){console[_0x5093c8(0x160)](_0x6cb6b7);}}),router[a0_0x4f0bfa(0x155)]('/login',async(_0x2750e8,_0x45eb05)=>{const _0x2e3cb0=a0_0x4f0bfa;try{const _0x1df847=_0x2750e8['body'][_0x2e3cb0(0x14f)],_0x146f81=await sing_up[_0x2e3cb0(0x16b)]({'email':_0x1df847});if(!_0x146f81)return _0x2750e8[_0x2e3cb0(0x174)](_0x2e3cb0(0x165),_0x2e3cb0(0x162)),_0x45eb05[_0x2e3cb0(0x179)]('/login');const _0x4e982d=await staff['findOne']({'email':_0x146f81[_0x2e3cb0(0x14f)]});var _0x41c725=_0x4e982d['account_category'],_0x1e5b18=_0x4e982d[_0x2e3cb0(0x168)],_0x49f83a=_0x4e982d[_0x2e3cb0(0x156)],_0x11626f=_0x4e982d[_0x2e3cb0(0x153)];if(_0x146f81['role']==_0x2e3cb0(0x15b)){const _0x4efa6d=await staff[_0x2e3cb0(0x16b)]({'email':_0x146f81[_0x2e3cb0(0x14f)]});if(_0x4efa6d[_0x2e3cb0(0x178)]=='Disabled')return _0x2750e8[_0x2e3cb0(0x174)](_0x2e3cb0(0x165),'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.'),_0x45eb05[_0x2e3cb0(0x179)](_0x2e3cb0(0x16e));_0x41c725=_0x4efa6d[_0x2e3cb0(0x154)],_0x1e5b18=_0x4efa6d[_0x2e3cb0(0x168)],_0x49f83a=_0x4efa6d[_0x2e3cb0(0x156)],_0x11626f=_0x4efa6d[_0x2e3cb0(0x153)];}const _0x3b29b9=_0x2750e8[_0x2e3cb0(0x167)][_0x2e3cb0(0x15f)],_0x9b65b4=await bcrypt[_0x2e3cb0(0x181)](_0x3b29b9,_0x146f81[_0x2e3cb0(0x15f)]);if(_0x9b65b4==![])return _0x2750e8[_0x2e3cb0(0x174)]('errors',_0x2e3cb0(0x172)),_0x45eb05[_0x2e3cb0(0x179)](_0x2e3cb0(0x16e));const _0x3afb48=jwt[_0x2e3cb0(0x14d)]({'username':_0x146f81[_0x2e3cb0(0x180)],'email':_0x146f81['email'],'role':_0x146f81[_0x2e3cb0(0x17f)],'account_category':_0x41c725,'sales_category':_0x1e5b18,'sttaff_id':_0x49f83a,'warehouse':_0x11626f},process[_0x2e3cb0(0x177)][_0x2e3cb0(0x15c)]);_0x45eb05[_0x2e3cb0(0x17c)]('jwt',_0x3afb48,{'expires':new Date(0xe677d213a700)}),_0x2750e8[_0x2e3cb0(0x174)](_0x2e3cb0(0x16c),_0x2e3cb0(0x171)),_0x45eb05[_0x2e3cb0(0x179)](_0x2e3cb0(0x173));}catch(_0x1ecea3){console[_0x2e3cb0(0x160)](_0x1ecea3);}}),router[a0_0x4f0bfa(0x159)](a0_0x4f0bfa(0x170),async(_0x197207,_0x46c9fa)=>{const _0x260063=a0_0x4f0bfa;try{const _0x3931fe=_0x197207['params']['id'],_0x267c9c=await staff['findById']({'_id':_0x3931fe});_0x267c9c['status']=='Disabled'&&(_0x197207[_0x260063(0x174)]('errors',_0x260063(0x157)),_0x46c9fa[_0x260063(0x179)](_0x260063(0x17a)));const _0x3e2e3f=await sing_up['findOne']({'email':_0x267c9c[_0x260063(0x14f)]});var _0x1bbcf=_0x267c9c[_0x260063(0x163)];if(_0x3e2e3f['role']==_0x260063(0x15b)){const _0xb1b10d=await staff[_0x260063(0x16b)]({'name':_0x3e2e3f[_0x260063(0x158)]});_0x1bbcf=_0xb1b10d[_0x260063(0x163)];}const _0x816e9b=jwt['sign']({'username':_0x3e2e3f[_0x260063(0x180)],'email':_0x3e2e3f[_0x260063(0x14f)],'role':_0x3e2e3f['role'],'warehouse_category':_0x1bbcf},process[_0x260063(0x177)][_0x260063(0x15c)]);_0x46c9fa[_0x260063(0x17c)](_0x260063(0x150),_0x816e9b,{'expires':new Date(0xe677d213a700)}),_0x197207[_0x260063(0x174)](_0x260063(0x16c),'login\x20successfully'),_0x46c9fa[_0x260063(0x179)](_0x260063(0x173));}catch(_0x291947){console[_0x260063(0x160)](_0x291947);}}),router['get']('/logout',(_0x1f79f0,_0x43748d)=>{const _0x44076a=a0_0x4f0bfa;_0x43748d['clearCookie'](_0x44076a(0x150)),_0x43748d[_0x44076a(0x179)](_0x44076a(0x16e));}),module['exports']=router;function a0_0x3ec7(){const _0x538d4d=['warehouse','account_category','post','_id','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','name','get','render','staff','secret_key','find','jsonwebtoken','password','log','validate','your\x20email\x20is\x20not\x20register','warehouse_category','express','errors','bcryptjs','body','type_of_acc_cat','../middleware/auth','988030ERicCC','findOne','success','4632184vMLexU','/login','1527LlGAEL','/staff/:id','login\x20successfully','your\x20password\x20is\x20wrong','/index','flash','1985468vPANag','5UvtpcG','env','status','redirect','/staff/view','256884zPDDEH','cookie','login\x20master','/validate','role','username','compare','sign','2276286ohNgGO','email','jwt','979839sqAbXD','login'];a0_0x3ec7=function(){return _0x538d4d;};return a0_0x3ec7();}