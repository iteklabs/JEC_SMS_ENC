const a0_0x8df7b0=a0_0x2ad6;function a0_0x5f57(){const _0x927d43=['params','exports','your\x20email\x20is\x20not\x20register','email','success','../models/all_models','846332NDBvmn','account_category','your\x20password\x20is\x20wrong','1398SkZSms','clearCookie','secret_key','Disabled','/login','14803677puhDbV','../middleware/auth','/logout','status','role','log','body','login\x20successfully','2825200mEMscO','password','17815VuHWky','redirect','99wFpmNx','/index','sign','/validate','980557dsKZhu','jsonwebtoken','errors','jwt','10cWZWeL','28060RaYYEJ','4497976lCQSQl','staff','Router','type_of_acc_cat','username','cookie','warehouse','get','flash','findOne','validate','/staff/:id','_id','env','express','bcryptjs','render'];a0_0x5f57=function(){return _0x927d43;};return a0_0x5f57();}function a0_0x2ad6(_0x2f9246,_0x3309c0){const _0x5f573d=a0_0x5f57();return a0_0x2ad6=function(_0x2ad648,_0x292586){_0x2ad648=_0x2ad648-0xff;let _0x197572=_0x5f573d[_0x2ad648];return _0x197572;},a0_0x2ad6(_0x2f9246,_0x3309c0);}(function(_0x5d845a,_0x527da1){const _0x263c2b=a0_0x2ad6,_0x4515b3=_0x5d845a();while(!![]){try{const _0x5d2ac4=-parseInt(_0x263c2b(0x123))/0x1+-parseInt(_0x263c2b(0x10b))/0x2+parseInt(_0x263c2b(0x11f))/0x3*(-parseInt(_0x263c2b(0x128))/0x4)+parseInt(_0x263c2b(0x11d))/0x5*(parseInt(_0x263c2b(0x10e))/0x6)+parseInt(_0x263c2b(0x11b))/0x7+-parseInt(_0x263c2b(0x129))/0x8+parseInt(_0x263c2b(0x113))/0x9*(parseInt(_0x263c2b(0x127))/0xa);if(_0x5d2ac4===_0x527da1)break;else _0x4515b3['push'](_0x4515b3['shift']());}catch(_0x53d036){_0x4515b3['push'](_0x4515b3['shift']());}}}(a0_0x5f57,0xa64cf));const express=require(a0_0x8df7b0(0x102)),app=express(),router=express[a0_0x8df7b0(0x12b)](),{sing_up,staff,profile,master_shop}=require(a0_0x8df7b0(0x10a)),bcrypt=require(a0_0x8df7b0(0x103)),jwt=require(a0_0x8df7b0(0x124)),auth=require(a0_0x8df7b0(0x114));router[a0_0x8df7b0(0x130)]('/',async(_0x4c8970,_0x243fae)=>{const _0x3a08c0=a0_0x8df7b0;try{const _0x1ee501=await master_shop['find']();_0x243fae[_0x3a08c0(0x104)]('login',{'success':_0x4c8970['flash'](_0x3a08c0(0x109)),'errors':_0x4c8970[_0x3a08c0(0x131)](_0x3a08c0(0x125)),'master_shop':_0x1ee501});}catch(_0x3d2c6c){console[_0x3a08c0(0x118)](_0x3d2c6c);}}),router[a0_0x8df7b0(0x130)](a0_0x8df7b0(0x122),async(_0x344d40,_0x45f360)=>{const _0xb97cba=a0_0x8df7b0;try{const _0x15f2f4=await master_shop['find']();_0x45f360[_0xb97cba(0x104)](_0xb97cba(0x133),{'success':_0x344d40[_0xb97cba(0x131)](_0xb97cba(0x109)),'errors':_0x344d40[_0xb97cba(0x131)]('errors'),'master_shop':_0x15f2f4});}catch(_0x2ab358){console['log'](_0x2ab358);}}),router['get']('/login',async(_0xc943d8,_0x8998c2)=>{const _0x1051d3=a0_0x8df7b0;try{const _0x44adf1=await master_shop['find']();console[_0x1051d3(0x118)]('login\x20master',_0x44adf1),_0x8998c2['render']('login',{'success':_0xc943d8[_0x1051d3(0x131)](_0x1051d3(0x109)),'errors':_0xc943d8[_0x1051d3(0x131)](_0x1051d3(0x125)),'master_shop':_0x44adf1});}catch(_0x23f0f2){console['log'](_0x23f0f2);}}),router['post'](a0_0x8df7b0(0x112),async(_0x5b559b,_0x4e0a93)=>{const _0x9b5239=a0_0x8df7b0;try{const _0x2f2c1b=_0x5b559b[_0x9b5239(0x119)][_0x9b5239(0x108)],_0x1c8080=await sing_up['findOne']({'email':_0x2f2c1b});if(!_0x1c8080)return _0x5b559b[_0x9b5239(0x131)](_0x9b5239(0x125),_0x9b5239(0x107)),_0x4e0a93['redirect']('/login');const _0x54058e=await staff[_0x9b5239(0x132)]({'email':_0x1c8080[_0x9b5239(0x108)]});var _0x5c1a47=_0x54058e[_0x9b5239(0x10c)],_0x274aa5=_0x54058e[_0x9b5239(0x12c)],_0x2988e1=_0x54058e[_0x9b5239(0x100)],_0x3da0f0=_0x54058e[_0x9b5239(0x12f)];if(_0x1c8080[_0x9b5239(0x117)]==_0x9b5239(0x12a)){const _0x5a750d=await staff[_0x9b5239(0x132)]({'email':_0x1c8080[_0x9b5239(0x108)]});if(_0x5a750d['status']==_0x9b5239(0x111))return _0x5b559b['flash'](_0x9b5239(0x125),'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.'),_0x4e0a93[_0x9b5239(0x11e)](_0x9b5239(0x112));_0x5c1a47=_0x5a750d[_0x9b5239(0x10c)],_0x274aa5=_0x5a750d['type_of_acc_cat'],_0x2988e1=_0x5a750d[_0x9b5239(0x100)],_0x3da0f0=_0x5a750d[_0x9b5239(0x12f)];}const _0x1c0c34=_0x5b559b['body']['password'],_0x3d64a9=await bcrypt['compare'](_0x1c0c34,_0x1c8080[_0x9b5239(0x11c)]);if(_0x3d64a9==![])return _0x5b559b[_0x9b5239(0x131)](_0x9b5239(0x125),_0x9b5239(0x10d)),_0x4e0a93[_0x9b5239(0x11e)](_0x9b5239(0x112));const _0x13422a=jwt[_0x9b5239(0x121)]({'username':_0x1c8080[_0x9b5239(0x12d)],'email':_0x1c8080[_0x9b5239(0x108)],'role':_0x1c8080[_0x9b5239(0x117)],'account_category':_0x5c1a47,'sales_category':_0x274aa5,'sttaff_id':_0x2988e1,'warehouse':_0x3da0f0},process[_0x9b5239(0x101)][_0x9b5239(0x110)]);_0x4e0a93['cookie'](_0x9b5239(0x126),_0x13422a,{'expires':new Date(0xe677d213a700)}),_0x5b559b[_0x9b5239(0x131)](_0x9b5239(0x109),_0x9b5239(0x11a)),_0x4e0a93[_0x9b5239(0x11e)]('/index');}catch(_0x1ee272){console['log'](_0x1ee272);}}),router['get'](a0_0x8df7b0(0xff),async(_0x36d6d1,_0x390381)=>{const _0x198267=a0_0x8df7b0;try{const _0x321c42=_0x36d6d1[_0x198267(0x105)]['id'],_0x1f4808=await staff['findById']({'_id':_0x321c42});console[_0x198267(0x118)]('login\x20staff',_0x1f4808);const _0x193761=await staff[_0x198267(0x132)]({'email':_0x1f4808[_0x198267(0x108)]}),_0x563f7c=await sing_up[_0x198267(0x132)]({'email':_0x1f4808[_0x198267(0x108)]});var _0x59658c=_0x193761[_0x198267(0x10c)],_0x231ecb=_0x193761[_0x198267(0x12c)],_0x3000cf=_0x193761[_0x198267(0x100)],_0x10127f=_0x193761[_0x198267(0x12f)];if(_0x563f7c[_0x198267(0x117)]==_0x198267(0x12a)){const _0x1626df=await staff['findOne']({'email':_0x563f7c['email']});if(_0x1626df[_0x198267(0x116)]=='Disabled')return _0x36d6d1[_0x198267(0x131)](_0x198267(0x125),'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.'),_0x390381['redirect']('/staff/view');_0x59658c=_0x1626df[_0x198267(0x10c)],_0x231ecb=_0x1626df[_0x198267(0x12c)],_0x3000cf=_0x1626df[_0x198267(0x100)],_0x10127f=_0x1626df[_0x198267(0x12f)];}const _0x4c8a89=jwt[_0x198267(0x121)]({'username':_0x563f7c[_0x198267(0x12d)],'email':_0x563f7c['email'],'role':_0x563f7c[_0x198267(0x117)],'account_category':_0x59658c,'sales_category':_0x231ecb,'sttaff_id':_0x3000cf,'warehouse':_0x10127f},process[_0x198267(0x101)][_0x198267(0x110)]);_0x390381[_0x198267(0x12e)]('jwt',_0x4c8a89,{'expires':new Date(0xe677d213a700)}),_0x36d6d1['flash'](_0x198267(0x109),'login\x20successfully'),_0x390381[_0x198267(0x11e)](_0x198267(0x120));}catch(_0x3b6892){console[_0x198267(0x118)](_0x3b6892);}}),router[a0_0x8df7b0(0x130)](a0_0x8df7b0(0x115),(_0x3a4c40,_0x5c924a)=>{const _0x2da2fc=a0_0x8df7b0;_0x5c924a[_0x2da2fc(0x10f)](_0x2da2fc(0x126)),_0x5c924a[_0x2da2fc(0x11e)](_0x2da2fc(0x112));}),module[a0_0x8df7b0(0x106)]=router;