const a0_0x10e818=a0_0x3e9b;function a0_0x3e9b(_0x599377,_0x7eee63){const _0x440579=a0_0x4405();return a0_0x3e9b=function(_0x3e9b41,_0x5e11d4){_0x3e9b41=_0x3e9b41-0xe1;let _0x4f89fc=_0x440579[_0x3e9b41];return _0x4f89fc;},a0_0x3e9b(_0x599377,_0x7eee63);}(function(_0x4dccfa,_0x24afbd){const _0x424d1e=a0_0x3e9b,_0xb08426=_0x4dccfa();while(!![]){try{const _0x3c94b0=-parseInt(_0x424d1e(0xfa))/0x1*(parseInt(_0x424d1e(0xf0))/0x2)+parseInt(_0x424d1e(0x101))/0x3*(-parseInt(_0x424d1e(0xec))/0x4)+-parseInt(_0x424d1e(0x10c))/0x5*(-parseInt(_0x424d1e(0xf7))/0x6)+-parseInt(_0x424d1e(0xf4))/0x7+-parseInt(_0x424d1e(0x105))/0x8*(-parseInt(_0x424d1e(0xfd))/0x9)+-parseInt(_0x424d1e(0x110))/0xa+parseInt(_0x424d1e(0x113))/0xb;if(_0x3c94b0===_0x24afbd)break;else _0xb08426['push'](_0xb08426['shift']());}catch(_0x4ce884){_0xb08426['push'](_0xb08426['shift']());}}}(a0_0x4405,0x896bb));function a0_0x4405(){const _0x3e0513=['find','env','24klhkHn','username','errors','secret_key','7817691VzgyJF','Router','validate','113766hkBAWK','post','redirect','44393Gmzrsj','type_of_acc_cat','bcryptjs','9GBTdnA','_id','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','Disabled','1347909VaMnCQ','/logout','login','findById','2648056ULbaZx','success','cookie','warehouse','jsonwebtoken','role','/login','130Ktyaqz','login\x20successfully','flash','/validate','5431920ChzxHv','../models/all_models','express','26189966DFkDAi','status','jwt','sign','params','password','/index','staff','render','your\x20email\x20is\x20not\x20register','body','your\x20password\x20is\x20wrong','/staff/:id','log','findOne','get','email','account_category','login\x20staff','4WBxhcD','exports'];a0_0x4405=function(){return _0x3e0513;};return a0_0x4405();}const express=require(a0_0x10e818(0x112)),app=express(),router=express[a0_0x10e818(0xf5)](),{sing_up,staff,profile,master_shop}=require(a0_0x10e818(0x111)),bcrypt=require(a0_0x10e818(0xfc)),jwt=require(a0_0x10e818(0x109)),auth=require('../middleware/auth');router[a0_0x10e818(0xe8)]('/',async(_0x57c2a9,_0x3af13a)=>{const _0x40c561=a0_0x10e818;try{const _0x4c5a72=await master_shop['find']();_0x3af13a[_0x40c561(0xe1)](_0x40c561(0x103),{'success':_0x57c2a9['flash'](_0x40c561(0x106)),'errors':_0x57c2a9[_0x40c561(0x10e)](_0x40c561(0xf2)),'master_shop':_0x4c5a72});}catch(_0x5353d0){console['log'](_0x5353d0);}}),router[a0_0x10e818(0xe8)](a0_0x10e818(0x10f),async(_0x445deb,_0x22fbc9)=>{const _0x175b0d=a0_0x10e818;try{const _0x4611a1=await master_shop['find']();_0x22fbc9[_0x175b0d(0xe1)](_0x175b0d(0xf6),{'success':_0x445deb[_0x175b0d(0x10e)](_0x175b0d(0x106)),'errors':_0x445deb['flash'](_0x175b0d(0xf2)),'master_shop':_0x4611a1});}catch(_0x4e1e1d){console[_0x175b0d(0xe6)](_0x4e1e1d);}}),router['get'](a0_0x10e818(0x10b),async(_0x76cf31,_0x5a1b25)=>{const _0xd45107=a0_0x10e818;try{const _0x5a84c4=await master_shop[_0xd45107(0xee)]();console['log']('login\x20master',_0x5a84c4),_0x5a1b25['render']('login',{'success':_0x76cf31['flash']('success'),'errors':_0x76cf31[_0xd45107(0x10e)](_0xd45107(0xf2)),'master_shop':_0x5a84c4});}catch(_0x4fb9bf){console[_0xd45107(0xe6)](_0x4fb9bf);}}),router[a0_0x10e818(0xf8)]('/login',async(_0x4ba525,_0x9b5ea6)=>{const _0x167a97=a0_0x10e818;try{const _0x48c8fc=_0x4ba525[_0x167a97(0xe3)][_0x167a97(0xe9)],_0x12ae28=await sing_up['findOne']({'email':_0x48c8fc});if(!_0x12ae28)return _0x4ba525[_0x167a97(0x10e)](_0x167a97(0xf2),_0x167a97(0xe2)),_0x9b5ea6[_0x167a97(0xf9)]('/login');const _0x20e399=await staff[_0x167a97(0xe7)]({'email':_0x12ae28[_0x167a97(0xe9)]});var _0x4de3f0=_0x20e399['account_category'],_0x21187f=_0x20e399['type_of_acc_cat'],_0x21fe40=_0x20e399[_0x167a97(0xfe)],_0x4f5f12=_0x20e399['warehouse'];if(_0x12ae28[_0x167a97(0x10a)]=='staff'){const _0x3284f7=await staff['findOne']({'email':_0x12ae28[_0x167a97(0xe9)]});if(_0x3284f7[_0x167a97(0x114)]==_0x167a97(0x100))return _0x4ba525[_0x167a97(0x10e)](_0x167a97(0xf2),_0x167a97(0xff)),_0x9b5ea6[_0x167a97(0xf9)]('/login');_0x4de3f0=_0x3284f7[_0x167a97(0xea)],_0x21187f=_0x3284f7[_0x167a97(0xfb)],_0x21fe40=_0x3284f7[_0x167a97(0xfe)],_0x4f5f12=_0x3284f7[_0x167a97(0x108)];}const _0x34f3cf=_0x4ba525[_0x167a97(0xe3)][_0x167a97(0x118)],_0x4cce22=await bcrypt['compare'](_0x34f3cf,_0x12ae28['password']);if(_0x4cce22==![])return _0x4ba525[_0x167a97(0x10e)](_0x167a97(0xf2),_0x167a97(0xe4)),_0x9b5ea6[_0x167a97(0xf9)](_0x167a97(0x10b));const _0x1ffd9e=jwt[_0x167a97(0x116)]({'username':_0x12ae28['username'],'email':_0x12ae28[_0x167a97(0xe9)],'role':_0x12ae28[_0x167a97(0x10a)],'account_category':_0x4de3f0,'sales_category':_0x21187f,'sttaff_id':_0x21fe40,'warehouse':_0x4f5f12},process['env'][_0x167a97(0xf3)]);_0x9b5ea6[_0x167a97(0x107)](_0x167a97(0x115),_0x1ffd9e,{'expires':new Date(0xe677d213a700)}),_0x4ba525[_0x167a97(0x10e)](_0x167a97(0x106),_0x167a97(0x10d)),_0x9b5ea6[_0x167a97(0xf9)]('/index');}catch(_0x283c29){console[_0x167a97(0xe6)](_0x283c29);}}),router['get'](a0_0x10e818(0xe5),async(_0x13a6c1,_0xfcfa05)=>{const _0x2aabe2=a0_0x10e818;try{const _0x5d3691=_0x13a6c1[_0x2aabe2(0x117)]['id'],_0x4da4a0=await staff[_0x2aabe2(0x104)]({'_id':_0x5d3691});console[_0x2aabe2(0xe6)](_0x2aabe2(0xeb),_0x4da4a0);const _0x4c8a02=await staff['findOne']({'email':_0x4da4a0['email']}),_0xc73de2=await sing_up[_0x2aabe2(0xe7)]({'email':_0x4da4a0['email']});var _0x4b5cb0=_0x4c8a02[_0x2aabe2(0xea)],_0x264bfa=_0x4c8a02['type_of_acc_cat'],_0x504e38=_0x4c8a02['_id'],_0x211532=_0x4c8a02['warehouse'];if(_0xc73de2[_0x2aabe2(0x10a)]==_0x2aabe2(0x11a)){const _0x575346=await staff[_0x2aabe2(0xe7)]({'email':_0xc73de2[_0x2aabe2(0xe9)]});if(_0x575346[_0x2aabe2(0x114)]=='Disabled')return _0x13a6c1[_0x2aabe2(0x10e)](_0x2aabe2(0xf2),_0x2aabe2(0xff)),_0xfcfa05['redirect']('/staff/view');_0x4b5cb0=_0x575346['account_category'],_0x264bfa=_0x575346[_0x2aabe2(0xfb)],_0x504e38=_0x575346[_0x2aabe2(0xfe)],_0x211532=_0x575346[_0x2aabe2(0x108)];}const _0x4924f5=jwt[_0x2aabe2(0x116)]({'username':_0xc73de2[_0x2aabe2(0xf1)],'email':_0xc73de2[_0x2aabe2(0xe9)],'role':_0xc73de2['role'],'account_category':_0x4b5cb0,'sales_category':_0x264bfa,'sttaff_id':_0x504e38,'warehouse':_0x211532},process[_0x2aabe2(0xef)]['secret_key']);_0xfcfa05[_0x2aabe2(0x107)]('jwt',_0x4924f5,{'expires':new Date(0xe677d213a700)}),_0x13a6c1[_0x2aabe2(0x10e)](_0x2aabe2(0x106),_0x2aabe2(0x10d)),_0xfcfa05[_0x2aabe2(0xf9)](_0x2aabe2(0x119));}catch(_0x18660a){console['log'](_0x18660a);}}),router[a0_0x10e818(0xe8)](a0_0x10e818(0x102),(_0x126260,_0x24ab53)=>{const _0x36480e=a0_0x10e818;_0x24ab53['clearCookie']('jwt'),_0x24ab53[_0x36480e(0xf9)]('/login');}),module[a0_0x10e818(0xed)]=router;