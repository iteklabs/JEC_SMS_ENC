const a0_0x4853b9=a0_0x45d1;function a0_0x45d1(_0x519202,_0x2e82eb){const _0x2e684f=a0_0x2e68();return a0_0x45d1=function(_0x45d157,_0x406e8d){_0x45d157=_0x45d157-0x143;let _0x3a81ef=_0x2e684f[_0x45d157];return _0x3a81ef;},a0_0x45d1(_0x519202,_0x2e82eb);}function a0_0x2e68(){const _0x29583a=['role','findById','bcryptjs','_id','129oFyhKx','body','email','validate','post','/logout','31673420glbnWL','109240VvhiaU','log','compare','2076300mXxNxI','Disabled','login\x20staff','secret_key','/staff/:id','clearCookie','sign','find','Router','render','login','8445843ptBsbJ','get','5123382vCtCDq','express','/index','/login','password','success','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','cookie','staff','findOne','username','9dnvYOO','account_category','jsonwebtoken','login\x20successfully','redirect','errors','../middleware/auth','status','type_of_acc_cat','exports','env','780848NsbsRT','flash','5QgadsA','9832048PSvjCN','warehouse','jwt','/staff/view'];a0_0x2e68=function(){return _0x29583a;};return a0_0x2e68();}(function(_0xd4af6f,_0x6cf7ff){const _0xdafb80=a0_0x45d1,_0x51e284=_0xd4af6f();while(!![]){try{const _0x4b1d5f=parseInt(_0xdafb80(0x16a))/0x1+parseInt(_0xdafb80(0x147))/0x2+parseInt(_0xdafb80(0x175))/0x3*(parseInt(_0xdafb80(0x144))/0x4)+parseInt(_0xdafb80(0x16c))/0x5*(parseInt(_0xdafb80(0x154))/0x6)+-parseInt(_0xdafb80(0x152))/0x7+parseInt(_0xdafb80(0x16d))/0x8+parseInt(_0xdafb80(0x15f))/0x9*(-parseInt(_0xdafb80(0x143))/0xa);if(_0x4b1d5f===_0x6cf7ff)break;else _0x51e284['push'](_0x51e284['shift']());}catch(_0x54c594){_0x51e284['push'](_0x51e284['shift']());}}}(a0_0x2e68,0xab784));const express=require(a0_0x4853b9(0x155)),app=express(),router=express[a0_0x4853b9(0x14f)](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x4853b9(0x173)),jwt=require(a0_0x4853b9(0x161)),auth=require(a0_0x4853b9(0x165));router[a0_0x4853b9(0x153)]('/',async(_0x454e01,_0x340ed6)=>{const _0x33b6a6=a0_0x4853b9;try{const _0x6ea995=await master_shop[_0x33b6a6(0x14e)]();_0x340ed6[_0x33b6a6(0x150)](_0x33b6a6(0x151),{'success':_0x454e01['flash'](_0x33b6a6(0x159)),'errors':_0x454e01['flash'](_0x33b6a6(0x164)),'master_shop':_0x6ea995});}catch(_0x51e783){console[_0x33b6a6(0x145)](_0x51e783);}}),router[a0_0x4853b9(0x153)]('/validate',async(_0xab5b96,_0xff249f)=>{const _0x5eea96=a0_0x4853b9;try{const _0x29bba5=await master_shop[_0x5eea96(0x14e)]();_0xff249f[_0x5eea96(0x150)](_0x5eea96(0x178),{'success':_0xab5b96['flash']('success'),'errors':_0xab5b96[_0x5eea96(0x16b)]('errors'),'master_shop':_0x29bba5});}catch(_0xa06658){console['log'](_0xa06658);}}),router[a0_0x4853b9(0x153)](a0_0x4853b9(0x157),async(_0x2cf666,_0x2ddb4e)=>{const _0x238664=a0_0x4853b9;try{const _0x2c2759=await master_shop[_0x238664(0x14e)]();console[_0x238664(0x145)]('login\x20master',_0x2c2759),_0x2ddb4e[_0x238664(0x150)]('login',{'success':_0x2cf666[_0x238664(0x16b)](_0x238664(0x159)),'errors':_0x2cf666[_0x238664(0x16b)](_0x238664(0x164)),'master_shop':_0x2c2759});}catch(_0x3733c0){console[_0x238664(0x145)](_0x3733c0);}}),router[a0_0x4853b9(0x179)]('/login',async(_0x1a6015,_0x71ad3d)=>{const _0x14d00b=a0_0x4853b9;try{const _0x359ef9=_0x1a6015['body']['email'],_0x583320=await sing_up[_0x14d00b(0x15d)]({'email':_0x359ef9});if(!_0x583320)return _0x1a6015[_0x14d00b(0x16b)](_0x14d00b(0x164),'your\x20email\x20is\x20not\x20register'),_0x71ad3d[_0x14d00b(0x163)]('/login');const _0x283797=await staff[_0x14d00b(0x15d)]({'email':_0x583320[_0x14d00b(0x177)]});var _0x5991a5=_0x283797[_0x14d00b(0x160)],_0xf3d8c5=_0x283797[_0x14d00b(0x167)],_0x20d20c=_0x283797[_0x14d00b(0x174)],_0x41fe00=_0x283797['warehouse'];if(_0x583320[_0x14d00b(0x171)]==_0x14d00b(0x15c)){const _0x1d1f27=await staff[_0x14d00b(0x15d)]({'email':_0x583320[_0x14d00b(0x177)]});if(_0x1d1f27[_0x14d00b(0x166)]==_0x14d00b(0x148))return _0x1a6015['flash'](_0x14d00b(0x164),_0x14d00b(0x15a)),_0x71ad3d[_0x14d00b(0x163)](_0x14d00b(0x157));_0x5991a5=_0x1d1f27['account_category'],_0xf3d8c5=_0x1d1f27[_0x14d00b(0x167)],_0x20d20c=_0x1d1f27['_id'],_0x41fe00=_0x1d1f27[_0x14d00b(0x16e)];}const _0x4f1ec4=_0x1a6015[_0x14d00b(0x176)][_0x14d00b(0x158)],_0x18940c=await bcrypt[_0x14d00b(0x146)](_0x4f1ec4,_0x583320['password']);if(_0x18940c==![])return _0x1a6015[_0x14d00b(0x16b)](_0x14d00b(0x164),'your\x20password\x20is\x20wrong'),_0x71ad3d[_0x14d00b(0x163)](_0x14d00b(0x157));const _0x230698=jwt[_0x14d00b(0x14d)]({'username':_0x583320[_0x14d00b(0x15e)],'email':_0x583320[_0x14d00b(0x177)],'role':_0x583320[_0x14d00b(0x171)],'account_category':_0x5991a5,'sales_category':_0xf3d8c5,'sttaff_id':_0x20d20c,'warehouse':_0x41fe00},process['env'][_0x14d00b(0x14a)]);_0x71ad3d[_0x14d00b(0x15b)](_0x14d00b(0x16f),_0x230698,{'expires':new Date(0xe677d213a700)}),_0x1a6015[_0x14d00b(0x16b)](_0x14d00b(0x159),_0x14d00b(0x162)),_0x71ad3d[_0x14d00b(0x163)]('/index');}catch(_0x56d4bf){console[_0x14d00b(0x145)](_0x56d4bf);}}),router['get'](a0_0x4853b9(0x14b),async(_0x2f713e,_0x245245)=>{const _0x5ae3ac=a0_0x4853b9;try{const _0x1d9f15=_0x2f713e['params']['id'],_0x2796a0=await staff[_0x5ae3ac(0x172)]({'_id':_0x1d9f15});console[_0x5ae3ac(0x145)](_0x5ae3ac(0x149),_0x2796a0);const _0x3168bb=await staff[_0x5ae3ac(0x15d)]({'email':_0x2796a0[_0x5ae3ac(0x177)]}),_0x1f9ade=await sing_up['findOne']({'email':_0x2796a0[_0x5ae3ac(0x177)]});var _0x571537=_0x3168bb[_0x5ae3ac(0x160)],_0x1c358a=_0x3168bb[_0x5ae3ac(0x167)],_0x1d8bf9=_0x3168bb[_0x5ae3ac(0x174)],_0x13da79=_0x3168bb[_0x5ae3ac(0x16e)];if(_0x1f9ade[_0x5ae3ac(0x171)]==_0x5ae3ac(0x15c)){const _0x2cd01e=await staff['findOne']({'email':_0x1f9ade['email']});if(_0x2cd01e[_0x5ae3ac(0x166)]=='Disabled')return _0x2f713e['flash'](_0x5ae3ac(0x164),_0x5ae3ac(0x15a)),_0x245245[_0x5ae3ac(0x163)](_0x5ae3ac(0x170));_0x571537=_0x2cd01e[_0x5ae3ac(0x160)],_0x1c358a=_0x2cd01e['type_of_acc_cat'],_0x1d8bf9=_0x2cd01e[_0x5ae3ac(0x174)],_0x13da79=_0x2cd01e[_0x5ae3ac(0x16e)];}const _0xf5c618=jwt[_0x5ae3ac(0x14d)]({'username':_0x1f9ade['username'],'email':_0x1f9ade[_0x5ae3ac(0x177)],'role':_0x1f9ade[_0x5ae3ac(0x171)],'account_category':_0x571537,'sales_category':_0x1c358a,'sttaff_id':_0x1d8bf9,'warehouse':_0x13da79},process[_0x5ae3ac(0x169)][_0x5ae3ac(0x14a)]);_0x245245[_0x5ae3ac(0x15b)](_0x5ae3ac(0x16f),_0xf5c618,{'expires':new Date(0xe677d213a700)}),_0x2f713e[_0x5ae3ac(0x16b)](_0x5ae3ac(0x159),'login\x20successfully'),_0x245245[_0x5ae3ac(0x163)](_0x5ae3ac(0x156));}catch(_0x2e2d07){console['log'](_0x2e2d07);}}),router[a0_0x4853b9(0x153)](a0_0x4853b9(0x17a),(_0x29b090,_0x408629)=>{const _0xa9a591=a0_0x4853b9;_0x408629[_0xa9a591(0x14c)](_0xa9a591(0x16f)),_0x408629[_0xa9a591(0x163)]('/login');}),module[a0_0x4853b9(0x168)]=router;