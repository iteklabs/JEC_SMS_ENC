const a0_0x41bec1=a0_0x213d;(function(_0x120d2f,_0x19ba6a){const _0x4802e2=a0_0x213d,_0x133e47=_0x120d2f();while(!![]){try{const _0x103b71=-parseInt(_0x4802e2(0x132))/0x1+parseInt(_0x4802e2(0xf4))/0x2*(parseInt(_0x4802e2(0xf9))/0x3)+parseInt(_0x4802e2(0x13a))/0x4*(parseInt(_0x4802e2(0x120))/0x5)+-parseInt(_0x4802e2(0x117))/0x6*(parseInt(_0x4802e2(0x10c))/0x7)+parseInt(_0x4802e2(0xec))/0x8*(parseInt(_0x4802e2(0x111))/0x9)+parseInt(_0x4802e2(0x102))/0xa+-parseInt(_0x4802e2(0x136))/0xb;if(_0x103b71===_0x19ba6a)break;else _0x133e47['push'](_0x133e47['shift']());}catch(_0x571543){_0x133e47['push'](_0x133e47['shift']());}}}(a0_0x3503,0xef791));const express=require(a0_0x41bec1(0x103)),app=express(),router=express[a0_0x41bec1(0x10b)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up,invoice_sa,sales_sa,discount_volume_db}=require(a0_0x41bec1(0xfc)),auth=require(a0_0x41bec1(0x100)),users=require(a0_0x41bec1(0x134)),excelJS=require(a0_0x41bec1(0xdf)),xlsx=require('xlsx'),mongoose=require('mongoose'),multer=require(a0_0x41bec1(0x115)),storage=multer[a0_0x41bec1(0x114)]({'destination':(_0x2fdce9,_0x148ded,_0x372c7f)=>{const _0x3ecb13=a0_0x41bec1;_0x372c7f(null,_0x3ecb13(0xe9));},'filename':(_0x19a169,_0xc773cb,_0x34e649)=>{const _0x31b947=a0_0x41bec1;_0x34e649(null,Date[_0x31b947(0xe0)]()+'~'+_0xc773cb[_0x31b947(0x109)]);}}),upload=multer({'storage':storage});function a0_0x3503(){const _0x5f5c51=['141677lCzhCC','save','../public/language/languages.json','unit','5498108zSXhey','findById','English\x20(US)','success','12tSYPGU','French','Hindi','post','all_sales_sa','Types','exceljs','now','id_transaction','image','tmpisFG','adj_dicount_price','redirect','add_sales_sa','Spanish','no_per_unit','./public/sales_invoice','/add_sales_notes','/sales_sa/view_sales/','659992yIpjFT','price','log','json','Invoice\x20created\x20with\x20incremented\x20start\x20value:','/view_sales/:id','render','aggregate','1403914ntWBsv','English','find','user','findOne','3DhDBqf','forEach','Portuguese','../models/all_models','/product_data','totalprice','map','../middleware/auth','string','13017390WXXdRo','express','ObjectId','/customer_data','/getProductData','Portuguese\x20(BR)','_id','originalname','get','Router','14pNNSSv','getPrimUnitNo','body','secondary_unit','padStart','9sqvlAY','$product_list','Chinese','diskStorage','multer','toString','4659786uKhDhw','/volume_setup','Sales\x20add\x20successfully','id_transaction_from','/add_sales','totalPrice','Arabic\x20(ae)','file','quantity','1815755oMmDdL','errors','adj_discount','real_qty_unit_val','flash','language','view_sales_sa','true','email','conversion_data','invoice_starts','primary_code','prod_cat','Arabic','valueOf','conversion_unit','prod_name','German'];a0_0x3503=function(){return _0x5f5c51;};return a0_0x3503();}function a0_0x213d(_0x26cbcd,_0x4df70f){const _0x350300=a0_0x3503();return a0_0x213d=function(_0x213d17,_0x139f72){_0x213d17=_0x213d17-0xda;let _0x8d70f1=_0x350300[_0x213d17];return _0x8d70f1;},a0_0x213d(_0x26cbcd,_0x4df70f);}router[a0_0x41bec1(0x10a)]('/',auth,async(_0x343a76,_0x153fdc)=>{const _0x4886cd=a0_0x41bec1;try{const _0x5a6e6f=await master_shop['find'](),_0x55a934=_0x343a76[_0x4886cd(0xf7)],_0x1d7cc3=await profile[_0x4886cd(0xf8)]({'email':_0x55a934[_0x4886cd(0x128)]}),_0x130f87=await staff[_0x4886cd(0xf8)]({'email':_0x55a934[_0x4886cd(0x128)]}),_0x84abfa=await sales_sa['find']({'sales_staff_id':_0x130f87[_0x4886cd(0x108)]});if(_0x5a6e6f[0x0][_0x4886cd(0x125)]==_0x4886cd(0x138))var _0x5d1d53=users[_0x4886cd(0xf5)];else{if(_0x5a6e6f[0x0][_0x4886cd(0x125)]==_0x4886cd(0xdb))var _0x5d1d53=users['Hindi'];else{if(_0x5a6e6f[0x0][_0x4886cd(0x125)]==_0x4886cd(0x131))var _0x5d1d53=users[_0x4886cd(0x131)];else{if(_0x5a6e6f[0x0]['language']==_0x4886cd(0xe7))var _0x5d1d53=users[_0x4886cd(0xe7)];else{if(_0x5a6e6f[0x0][_0x4886cd(0x125)]==_0x4886cd(0xda))var _0x5d1d53=users[_0x4886cd(0xda)];else{if(_0x5a6e6f[0x0]['language']=='Portuguese\x20(BR)')var _0x5d1d53=users['Portuguese'];else{if(_0x5a6e6f[0x0]['language']==_0x4886cd(0x113))var _0x5d1d53=users[_0x4886cd(0x113)];else{if(_0x5a6e6f[0x0]['language']==_0x4886cd(0x11d))var _0x5d1d53=users[_0x4886cd(0x12d)];}}}}}}}_0x153fdc[_0x4886cd(0xf2)](_0x4886cd(0xdd),{'success':_0x343a76['flash'](_0x4886cd(0x139)),'errors':_0x343a76[_0x4886cd(0x124)](_0x4886cd(0x121)),'master_shop':_0x5a6e6f,'profile':_0x1d7cc3,'role':_0x55a934,'language':_0x5d1d53,'product_list':_0x130f87['product_list'],'sales_mine':_0x84abfa,'staff_arr':_0x130f87});}catch(_0x53bccc){console[_0x4886cd(0xee)](_0x53bccc);}}),router[a0_0x41bec1(0x10a)](a0_0x41bec1(0x11b),auth,async(_0x449756,_0x4e2390)=>{const _0x118036=a0_0x41bec1;try{const _0x4d62b9=await master_shop[_0x118036(0xf6)](),_0x4f8b49=_0x449756[_0x118036(0xf7)],_0x32f280=await profile[_0x118036(0xf8)]({'email':_0x4f8b49['email']}),_0x48b11f=await staff[_0x118036(0xf8)]({'email':_0x4f8b49[_0x118036(0x128)]}),_0x4f32fd=await customer[_0x118036(0xf6)]({'agent_id':_0x48b11f[_0x118036(0x108)]});if(_0x4d62b9[0x0][_0x118036(0x125)]==_0x118036(0x138))var _0x2c3068=users[_0x118036(0xf5)];else{if(_0x4d62b9[0x0][_0x118036(0x125)]==_0x118036(0xdb))var _0x2c3068=users[_0x118036(0xdb)];else{if(_0x4d62b9[0x0][_0x118036(0x125)]==_0x118036(0x131))var _0x2c3068=users[_0x118036(0x131)];else{if(_0x4d62b9[0x0]['language']==_0x118036(0xe7))var _0x2c3068=users[_0x118036(0xe7)];else{if(_0x4d62b9[0x0][_0x118036(0x125)]==_0x118036(0xda))var _0x2c3068=users[_0x118036(0xda)];else{if(_0x4d62b9[0x0][_0x118036(0x125)]==_0x118036(0x107))var _0x2c3068=users[_0x118036(0xfb)];else{if(_0x4d62b9[0x0][_0x118036(0x125)]==_0x118036(0x113))var _0x2c3068=users[_0x118036(0x113)];else{if(_0x4d62b9[0x0]['language']==_0x118036(0x11d))var _0x2c3068=users[_0x118036(0x12d)];}}}}}}}_0x4e2390[_0x118036(0xf2)](_0x118036(0xe6),{'success':_0x449756[_0x118036(0x124)](_0x118036(0x139)),'errors':_0x449756[_0x118036(0x124)](_0x118036(0x121)),'master_shop':_0x4d62b9,'profile':_0x32f280,'role':_0x4f8b49,'language':_0x2c3068,'customer':_0x4f32fd,'staff_arr':_0x48b11f});}catch(_0xea5540){console[_0x118036(0xee)](_0xea5540);}}),router[a0_0x41bec1(0x10a)](a0_0x41bec1(0xf1),auth,async(_0x3d72dd,_0x15a4dd)=>{const _0x5d844a=a0_0x41bec1;try{const _0x294512=await master_shop[_0x5d844a(0xf6)](),_0x5b5fad=_0x3d72dd[_0x5d844a(0xf7)],_0x592207=await profile[_0x5d844a(0xf8)]({'email':_0x5b5fad[_0x5d844a(0x128)]}),_0x2b9137=await staff['findOne']({'email':_0x5b5fad[_0x5d844a(0x128)]}),_0x43f5e7=await customer[_0x5d844a(0xf6)]({'agent_id':_0x2b9137['_id']}),_0xe3ce57=_0x3d72dd['params']['id'],_0x11977d=await sales_sa[_0x5d844a(0x137)](_0xe3ce57);if(_0x294512[0x0][_0x5d844a(0x125)]=='English\x20(US)')var _0x3a95c7=users['English'];else{if(_0x294512[0x0][_0x5d844a(0x125)]==_0x5d844a(0xdb))var _0x3a95c7=users[_0x5d844a(0xdb)];else{if(_0x294512[0x0]['language']==_0x5d844a(0x131))var _0x3a95c7=users[_0x5d844a(0x131)];else{if(_0x294512[0x0][_0x5d844a(0x125)]==_0x5d844a(0xe7))var _0x3a95c7=users['Spanish'];else{if(_0x294512[0x0][_0x5d844a(0x125)]==_0x5d844a(0xda))var _0x3a95c7=users[_0x5d844a(0xda)];else{if(_0x294512[0x0]['language']==_0x5d844a(0x107))var _0x3a95c7=users[_0x5d844a(0xfb)];else{if(_0x294512[0x0][_0x5d844a(0x125)]=='Chinese')var _0x3a95c7=users['Chinese'];else{if(_0x294512[0x0][_0x5d844a(0x125)]==_0x5d844a(0x11d))var _0x3a95c7=users[_0x5d844a(0x12d)];}}}}}}}_0x15a4dd[_0x5d844a(0xf2)](_0x5d844a(0x126),{'success':_0x3d72dd[_0x5d844a(0x124)](_0x5d844a(0x139)),'errors':_0x3d72dd[_0x5d844a(0x124)](_0x5d844a(0x121)),'master_shop':_0x294512,'profile':_0x592207,'role':_0x5b5fad,'language':_0x3a95c7,'customer':_0x43f5e7,'sales_sa':_0x11977d,'staff_arr':_0x2b9137});}catch(_0x305240){console[_0x5d844a(0xee)](_0x305240);}}),router[a0_0x41bec1(0xdc)](a0_0x41bec1(0x11b),auth,upload['single'](a0_0x41bec1(0xe2)),async(_0x171591,_0x9728a4)=>{const _0x507454=a0_0x41bec1;try{const {customer:_0x3ea472,date:_0x150065,prod_code:_0x1caf28,note:_0x3ba2cf,paid_status:_0x1061c6,DSI:_0x3149c2,cash_amount:_0x56979c,amount_data:_0xdd13c8,bank_data:_0x26dca7,check_no:_0x525ed3,due_date:_0x4ddf68}=_0x171591['body'],_0xeebdfc=_0x171591[_0x507454(0x11e)]['filename'];if(typeof _0x1caf28==_0x507454(0x101))var _0x18b909=[_0x171591['body']['prod_code']],_0x44421a=[_0x171591['body'][_0x507454(0x130)]],_0x8b1732=[_0x171591[_0x507454(0x10e)]['primary_code']],_0x403959=[_0x171591[_0x507454(0x10e)]['quantity']],_0x346b50=[_0x171591[_0x507454(0x10e)][_0x507454(0x135)]],_0x391da5=[_0x171591[_0x507454(0x10e)][_0x507454(0xed)]],_0x36c52c=[_0x171591[_0x507454(0x10e)][_0x507454(0x11c)]],_0x3ef794=[_0x171591[_0x507454(0x10e)][_0x507454(0xe1)]],_0x2931e6=[_0x171591[_0x507454(0x10e)][_0x507454(0xe4)]],_0x2d859d=[_0x171591['body']['tmpisFG']],_0xbd07d=[_0x171591[_0x507454(0x10e)][_0x507454(0xe8)]],_0x3c6937=[_0x171591[_0x507454(0x10e)][_0x507454(0x10d)]],_0x4fd1ac=[_0x171591['body']['prod_cat']],_0x49c64b=[_0x171591[_0x507454(0x10e)]['secondary_unit']],_0x3911a9=[_0x171591['body'][_0x507454(0x12f)]];else var _0x18b909=[..._0x171591[_0x507454(0x10e)]['prod_code']],_0x44421a=[..._0x171591[_0x507454(0x10e)][_0x507454(0x130)]],_0x8b1732=[..._0x171591[_0x507454(0x10e)][_0x507454(0x12b)]],_0x403959=[..._0x171591[_0x507454(0x10e)][_0x507454(0x11f)]],_0x346b50=[..._0x171591[_0x507454(0x10e)]['unit']],_0x391da5=[..._0x171591[_0x507454(0x10e)][_0x507454(0xed)]],_0x36c52c=[..._0x171591[_0x507454(0x10e)][_0x507454(0x11c)]],_0x3ef794=[..._0x171591[_0x507454(0x10e)][_0x507454(0xe1)]],_0x2931e6=[..._0x171591[_0x507454(0x10e)][_0x507454(0xe4)]],_0x2d859d=[..._0x171591[_0x507454(0x10e)][_0x507454(0xe3)]],_0xbd07d=[..._0x171591[_0x507454(0x10e)][_0x507454(0xe8)]],_0x3c6937=[..._0x171591[_0x507454(0x10e)][_0x507454(0x10d)]],_0x4fd1ac=[..._0x171591[_0x507454(0x10e)][_0x507454(0x12c)]],_0x49c64b=[..._0x171591['body']['secondary_unit']],_0x3911a9=[..._0x171591['body'][_0x507454(0x12f)]];const _0x4d551b=_0x18b909[_0x507454(0xff)](_0x632572=>{return _0x632572={'product_code':_0x632572};});_0x44421a[_0x507454(0xfa)]((_0x14408e,_0x5292df)=>{_0x4d551b[_0x5292df]['product_name']=_0x14408e;}),_0x8b1732[_0x507454(0xfa)]((_0x47c17c,_0x1e510e)=>{const _0x5c1246=_0x507454;_0x4d551b[_0x1e510e][_0x5c1246(0x12b)]=_0x47c17c;}),_0xbd07d[_0x507454(0xfa)]((_0x3b676b,_0x5bb8f6)=>{const _0x2267f3=_0x507454;_0x4d551b[_0x5bb8f6][_0x2267f3(0xe8)]=_0x3b676b;}),_0x403959[_0x507454(0xfa)]((_0x27ced7,_0x3b3502)=>{const _0x33a79f=_0x507454;_0x4d551b[_0x3b3502][_0x33a79f(0x11f)]=_0x27ced7;}),_0x346b50['forEach']((_0x4eebf5,_0x423944)=>{const _0x51d545=_0x507454;_0x4d551b[_0x423944][_0x51d545(0x135)]=_0x4eebf5;}),_0x391da5[_0x507454(0xfa)]((_0x426eed,_0x29798b)=>{const _0x482987=_0x507454;_0x4d551b[_0x29798b][_0x482987(0xed)]=_0x426eed;}),_0x36c52c[_0x507454(0xfa)]((_0x41d54e,_0x522572)=>{const _0x401143=_0x507454;_0x4d551b[_0x522572][_0x401143(0xfe)]=_0x41d54e;}),_0x3ef794[_0x507454(0xfa)]((_0xaa153c,_0xa9304a)=>{const _0x424e53=_0x507454;_0x4d551b[_0xa9304a][_0x424e53(0x11a)]=_0xaa153c;}),_0x2931e6[_0x507454(0xfa)]((_0x55cfa9,_0x34cb88)=>{const _0x35c94c=_0x507454;_0x4d551b[_0x34cb88][_0x35c94c(0x122)]=_0x55cfa9;}),_0x2d859d[_0x507454(0xfa)]((_0x34f83a,_0x1a42ce)=>{_0x4d551b[_0x1a42ce]['isFG']=_0x34f83a;}),_0x49c64b[_0x507454(0xfa)]((_0x2c657b,_0x3de6a5)=>{const _0xdc30d9=_0x507454;_0x4d551b[_0x3de6a5][_0xdc30d9(0x10f)]=_0x2c657b;}),_0x3c6937[_0x507454(0xfa)]((_0x2979da,_0x22ec55)=>{const _0x4b94a7=_0x507454;_0x4d551b[_0x22ec55][_0x4b94a7(0x123)]=_0x2979da;}),_0x4fd1ac[_0x507454(0xfa)]((_0x57732f,_0xef24ab)=>{const _0x19bbf7=_0x507454;_0x4d551b[_0xef24ab][_0x19bbf7(0x12c)]=_0x57732f;}),_0x3911a9[_0x507454(0xfa)]((_0x22f18e,_0x28abf6)=>{const _0x434fb6=_0x507454;_0x4d551b[_0x28abf6][_0x434fb6(0x129)]=_0x22f18e;});const _0x301c38=new invoice_sa();await _0x301c38[_0x507454(0x133)]();const _0x1d484d=_0x171591[_0x507454(0xf7)],_0x492bf8=await staff[_0x507454(0xf8)]({'email':_0x1d484d[_0x507454(0x128)]}),_0x51344e=new sales_sa({'invoice':_0x301c38[_0x507454(0x12a)]['toString']()[_0x507454(0x110)](0x8,'0'),'customer':_0x3ea472,'file':_0xeebdfc,'date':_0x150065,'sale_product':_0x4d551b,'note':_0x3ba2cf,'sales_staff_id':_0x492bf8[_0x507454(0x108)][_0x507454(0x12e)](),'paid':_0x1061c6,'dsi':_0x3149c2,'cash':_0x56979c,'amount':_0xdd13c8,'bank':_0x26dca7,'check_no':_0x525ed3,'due_date':_0x4ddf68}),_0x4e85fa=await _0x51344e[_0x507454(0x133)]();console[_0x507454(0xee)](_0x507454(0xf0),_0x301c38['invoice_starts'][_0x507454(0x116)]()[_0x507454(0x110)](0x8,'0'));const _0x3f72e0=mongoose['Types'][_0x507454(0x104)];_0x171591['flash'](_0x507454(0x139),'Sales\x20add\x20successfully'),_0x9728a4['redirect'](_0x507454(0xeb)+_0x4e85fa[_0x507454(0x108)]);}catch(_0x963104){console[_0x507454(0xee)](_0x963104);}}),router[a0_0x41bec1(0xdc)](a0_0x41bec1(0xea),auth,async(_0x1c24b6,_0x20d1b9)=>{const _0x4a3c22=a0_0x41bec1;try{const {date_data:_0x202481,note_data:_0x147d2f,status_data:_0x5601ed}=_0x1c24b6[_0x4a3c22(0x10e)],_0x3bb13d=new invoice_sa();await _0x3bb13d['save']();const _0x446e46=_0x1c24b6['user'],_0x53cfa8=await staff[_0x4a3c22(0xf8)]({'email':_0x446e46[_0x4a3c22(0x128)]}),_0x1d367c=new sales_sa({'invoice':_0x3bb13d[_0x4a3c22(0x12a)]['toString']()[_0x4a3c22(0x110)](0x8,'0'),'status_data':_0x5601ed,'date':_0x202481,'note':_0x147d2f,'sales_staff_id':_0x53cfa8[_0x4a3c22(0x108)][_0x4a3c22(0x12e)]()}),_0x2bf685=await _0x1d367c[_0x4a3c22(0x133)]();console[_0x4a3c22(0xee)]('Invoice\x20created\x20with\x20incremented\x20start\x20value:',_0x3bb13d[_0x4a3c22(0x12a)][_0x4a3c22(0x116)]()[_0x4a3c22(0x110)](0x8,'0'));const _0x2f1ccd=mongoose[_0x4a3c22(0xde)][_0x4a3c22(0x104)];_0x1c24b6[_0x4a3c22(0x124)](_0x4a3c22(0x139),_0x4a3c22(0x119)),_0x20d1b9[_0x4a3c22(0xe5)](_0x4a3c22(0xeb)+_0x2bf685[_0x4a3c22(0x108)]);}catch(_0x2973b1){console['log'](_0x2973b1);}}),router[a0_0x41bec1(0xdc)]('/product_list',auth,async(_0x37be70,_0x2b97f4)=>{const _0x354df6=a0_0x41bec1;try{const _0x158413=_0x37be70[_0x354df6(0xf7)],_0x5caba2=await profile[_0x354df6(0xf8)]({'email':_0x158413[_0x354df6(0x128)]}),_0x3b27bb=await staff[_0x354df6(0xf3)]([{'$match':{'email':_0x158413[_0x354df6(0x128)]}},{'$unwind':_0x354df6(0x112)},{'$match':{'product_list.isConfirm':_0x354df6(0x127)}}]);_0x2b97f4['json'](_0x3b27bb);}catch(_0x5f560d){}}),router[a0_0x41bec1(0xdc)](a0_0x41bec1(0x105),auth,async(_0x5964cc,_0x366233)=>{const _0x1e5f2a=a0_0x41bec1;try{const {customer_name:_0x2ee331}=_0x5964cc[_0x1e5f2a(0x10e)],_0x428383=await customer[_0x1e5f2a(0xf8)]({'name':_0x2ee331});_0x366233[_0x1e5f2a(0xef)](_0x428383);}catch(_0x45c0a4){}}),router['post'](a0_0x41bec1(0xfd),auth,async(_0x1a4c35,_0x218acf)=>{const _0x13e713=a0_0x41bec1;try{const _0x543b75=_0x1a4c35[_0x13e713(0xf7)],{id_data:_0x4ec3cb}=_0x1a4c35[_0x13e713(0x10e)],_0x39695b=await profile[_0x13e713(0xf8)]({'email':_0x543b75[_0x13e713(0x128)]}),_0x5e3796=mongoose[_0x13e713(0xde)]['ObjectId'];console[_0x13e713(0xee)](_0x5e3796(_0x4ec3cb));var _0xffe189=_0x5e3796(_0x4ec3cb);const _0x5f1b3f=await staff[_0x13e713(0xf3)]([{'$match':{'email':_0x543b75[_0x13e713(0x128)]}},{'$unwind':_0x13e713(0x112)},{'$match':{'product_list.isConfirm':_0x13e713(0x127),'product_list._id':_0xffe189}}]);_0x218acf[_0x13e713(0xef)](_0x5f1b3f);}catch(_0x25aeac){}}),router[a0_0x41bec1(0xdc)](a0_0x41bec1(0x118),auth,async(_0x4e182b,_0x3007ff)=>{const _0x559a34=a0_0x41bec1;try{const _0x316f0c=await discount_volume_db[_0x559a34(0xf8)]();_0x3007ff['json'](_0x316f0c);}catch(_0x57fd21){}}),router[a0_0x41bec1(0xdc)](a0_0x41bec1(0x106),auth,async(_0x48f9f4,_0x169cc6)=>{const _0xf6698b=a0_0x41bec1;try{const _0xfb96a6=await product[_0xf6698b(0xf6)]();_0x169cc6[_0xf6698b(0xef)](_0xfb96a6);}catch(_0x4e5ad2){}}),router[a0_0x41bec1(0xdc)]('/product_data_id',auth,async(_0x3103c3,_0xdf948e)=>{const _0x56d81c=a0_0x41bec1;try{const {id_data:_0x31b088}=_0x3103c3[_0x56d81c(0x10e)],_0xed1518=await product['findById'](_0x31b088);_0xdf948e['json'](_0xed1518);}catch(_0x234af5){}}),module['exports']=router;