const a0_0x137f57=a0_0x3009;(function(_0x424ab7,_0x43ad8d){const _0x21b800=a0_0x3009,_0xa81555=_0x424ab7();while(!![]){try{const _0x5b5078=parseInt(_0x21b800(0x133))/0x1+-parseInt(_0x21b800(0x124))/0x2*(-parseInt(_0x21b800(0x12a))/0x3)+parseInt(_0x21b800(0xff))/0x4*(-parseInt(_0x21b800(0x102))/0x5)+parseInt(_0x21b800(0x129))/0x6*(-parseInt(_0x21b800(0x103))/0x7)+-parseInt(_0x21b800(0x113))/0x8+parseInt(_0x21b800(0x100))/0x9*(-parseInt(_0x21b800(0x127))/0xa)+parseInt(_0x21b800(0x138))/0xb;if(_0x5b5078===_0x43ad8d)break;else _0xa81555['push'](_0xa81555['shift']());}catch(_0x2e5194){_0xa81555['push'](_0xa81555['shift']());}}}(a0_0x1161,0xd2472));function a0_0x3009(_0xd4c682,_0x557031){const _0x1161ae=a0_0x1161();return a0_0x3009=function(_0x30090f,_0x4d04bf){_0x30090f=_0x30090f-0xdd;let _0x1ca25b=_0x1161ae[_0x30090f];return _0x1ca25b;},a0_0x3009(_0xd4c682,_0x557031);}const express=require(a0_0x137f57(0x118)),app=express(),router=express[a0_0x137f57(0xfc)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up,invoice_sa,sales_sa,discount_volume_db}=require(a0_0x137f57(0xe7)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x137f57(0x121)),xlsx=require('xlsx'),mongoose=require('mongoose'),multer=require(a0_0x137f57(0x111)),storage=multer[a0_0x137f57(0x114)]({'destination':(_0x1b2167,_0x4575e1,_0x33f0ba)=>{const _0x4099c8=a0_0x137f57;_0x33f0ba(null,_0x4099c8(0xf6));},'filename':(_0x938246,_0x46737a,_0xa787cc)=>{const _0x585f5e=a0_0x137f57;_0xa787cc(null,Date[_0x585f5e(0x109)]()+'~'+_0x46737a[_0x585f5e(0xeb)]);}}),upload=multer({'storage':storage});router[a0_0x137f57(0x135)]('/',auth,async(_0x9f0e13,_0x1acc20)=>{const _0x13463e=a0_0x137f57;try{const _0x4ddbcb=await master_shop[_0x13463e(0x116)](),_0x58b0bd=_0x9f0e13['user'],_0x5a70d7=await profile[_0x13463e(0x11f)]({'email':_0x58b0bd[_0x13463e(0x125)]}),_0x9e9402=await staff[_0x13463e(0x11f)]({'email':_0x58b0bd[_0x13463e(0x125)]}),_0x5b0d6c=await sales_sa['find']({'sales_staff_id':_0x9e9402[_0x13463e(0xf9)]});if(_0x4ddbcb[0x0][_0x13463e(0x10f)]=='English\x20(US)')var _0x38e76f=users[_0x13463e(0x12b)];else{if(_0x4ddbcb[0x0][_0x13463e(0x10f)]==_0x13463e(0x117))var _0x38e76f=users[_0x13463e(0x117)];else{if(_0x4ddbcb[0x0][_0x13463e(0x10f)]==_0x13463e(0x126))var _0x38e76f=users[_0x13463e(0x126)];else{if(_0x4ddbcb[0x0][_0x13463e(0x10f)]=='Spanish')var _0x38e76f=users[_0x13463e(0xf7)];else{if(_0x4ddbcb[0x0]['language']==_0x13463e(0xe1))var _0x38e76f=users[_0x13463e(0xe1)];else{if(_0x4ddbcb[0x0][_0x13463e(0x10f)]==_0x13463e(0x132))var _0x38e76f=users[_0x13463e(0x12d)];else{if(_0x4ddbcb[0x0]['language']==_0x13463e(0xfd))var _0x38e76f=users['Chinese'];else{if(_0x4ddbcb[0x0][_0x13463e(0x10f)]=='Arabic\x20(ae)')var _0x38e76f=users[_0x13463e(0xf8)];}}}}}}}_0x1acc20[_0x13463e(0xfa)](_0x13463e(0x10e),{'success':_0x9f0e13[_0x13463e(0x136)]('success'),'errors':_0x9f0e13[_0x13463e(0x136)]('errors'),'master_shop':_0x4ddbcb,'profile':_0x5a70d7,'role':_0x58b0bd,'language':_0x38e76f,'product_list':_0x9e9402['product_list'],'sales_mine':_0x5b0d6c,'staff_arr':_0x9e9402});}catch(_0x49e6f7){console[_0x13463e(0xe6)](_0x49e6f7);}}),router[a0_0x137f57(0x135)](a0_0x137f57(0xdd),auth,async(_0x16a542,_0x3d23da)=>{const _0x2d4e3e=a0_0x137f57;try{const _0x177107=await master_shop['find'](),_0x3f99bc=_0x16a542[_0x2d4e3e(0x10d)],_0x58fa1e=await profile[_0x2d4e3e(0x11f)]({'email':_0x3f99bc[_0x2d4e3e(0x125)]}),_0xbe609b=await staff['findOne']({'email':_0x3f99bc['email']}),_0x53a5ab=await customer['find']({'agent_id':_0xbe609b['_id']});if(_0x177107[0x0]['language']=='English\x20(US)')var _0x18be04=users[_0x2d4e3e(0x12b)];else{if(_0x177107[0x0][_0x2d4e3e(0x10f)]==_0x2d4e3e(0x117))var _0x18be04=users[_0x2d4e3e(0x117)];else{if(_0x177107[0x0][_0x2d4e3e(0x10f)]=='German')var _0x18be04=users['German'];else{if(_0x177107[0x0][_0x2d4e3e(0x10f)]==_0x2d4e3e(0xf7))var _0x18be04=users[_0x2d4e3e(0xf7)];else{if(_0x177107[0x0][_0x2d4e3e(0x10f)]==_0x2d4e3e(0xe1))var _0x18be04=users[_0x2d4e3e(0xe1)];else{if(_0x177107[0x0][_0x2d4e3e(0x10f)]=='Portuguese\x20(BR)')var _0x18be04=users[_0x2d4e3e(0x12d)];else{if(_0x177107[0x0]['language']==_0x2d4e3e(0xfd))var _0x18be04=users['Chinese'];else{if(_0x177107[0x0][_0x2d4e3e(0x10f)]==_0x2d4e3e(0xe8))var _0x18be04=users['Arabic'];}}}}}}}_0x3d23da[_0x2d4e3e(0xfa)](_0x2d4e3e(0x12c),{'success':_0x16a542[_0x2d4e3e(0x136)](_0x2d4e3e(0x10b)),'errors':_0x16a542[_0x2d4e3e(0x136)]('errors'),'master_shop':_0x177107,'profile':_0x58fa1e,'role':_0x3f99bc,'language':_0x18be04,'customer':_0x53a5ab,'staff_arr':_0xbe609b});}catch(_0x2e352a){console[_0x2d4e3e(0xe6)](_0x2e352a);}}),router[a0_0x137f57(0x135)](a0_0x137f57(0x112),auth,async(_0x217fcd,_0x48f921)=>{const _0x1f1e2e=a0_0x137f57;try{const _0x4b5798=await master_shop['find'](),_0x299192=_0x217fcd['user'],_0x17ff1e=await profile['findOne']({'email':_0x299192['email']}),_0x483eff=await staff['findOne']({'email':_0x299192[_0x1f1e2e(0x125)]}),_0x4276e6=await customer[_0x1f1e2e(0x116)]({'agent_id':_0x483eff['_id']}),_0x206496=_0x217fcd['params']['id'],_0x36ab4b=await sales_sa['findById'](_0x206496);if(_0x4b5798[0x0]['language']=='English\x20(US)')var _0x1234a2=users[_0x1f1e2e(0x12b)];else{if(_0x4b5798[0x0][_0x1f1e2e(0x10f)]==_0x1f1e2e(0x117))var _0x1234a2=users[_0x1f1e2e(0x117)];else{if(_0x4b5798[0x0][_0x1f1e2e(0x10f)]==_0x1f1e2e(0x126))var _0x1234a2=users[_0x1f1e2e(0x126)];else{if(_0x4b5798[0x0][_0x1f1e2e(0x10f)]==_0x1f1e2e(0xf7))var _0x1234a2=users[_0x1f1e2e(0xf7)];else{if(_0x4b5798[0x0][_0x1f1e2e(0x10f)]==_0x1f1e2e(0xe1))var _0x1234a2=users[_0x1f1e2e(0xe1)];else{if(_0x4b5798[0x0][_0x1f1e2e(0x10f)]==_0x1f1e2e(0x132))var _0x1234a2=users[_0x1f1e2e(0x12d)];else{if(_0x4b5798[0x0][_0x1f1e2e(0x10f)]==_0x1f1e2e(0xfd))var _0x1234a2=users[_0x1f1e2e(0xfd)];else{if(_0x4b5798[0x0]['language']==_0x1f1e2e(0xe8))var _0x1234a2=users[_0x1f1e2e(0xf8)];}}}}}}}_0x48f921[_0x1f1e2e(0xfa)](_0x1f1e2e(0x115),{'success':_0x217fcd[_0x1f1e2e(0x136)](_0x1f1e2e(0x10b)),'errors':_0x217fcd[_0x1f1e2e(0x136)]('errors'),'master_shop':_0x4b5798,'profile':_0x17ff1e,'role':_0x299192,'language':_0x1234a2,'customer':_0x4276e6,'sales_sa':_0x36ab4b,'staff_arr':_0x483eff});}catch(_0x51b2a0){console[_0x1f1e2e(0xe6)](_0x51b2a0);}}),router[a0_0x137f57(0x11e)](a0_0x137f57(0xdd),auth,upload[a0_0x137f57(0x106)](a0_0x137f57(0x12f)),async(_0x211104,_0x20ec12)=>{const _0x444458=a0_0x137f57;try{const {customer:_0x14caaf,date:_0x3cc36d,prod_code:_0x4d73d6,note:_0x2038ff,paid_status:_0x19abcd,DSI:_0x3f685d,cash_amount:_0x226c8d,amount_data:_0x46c50a,bank_data:_0x3a0325,check_no:_0x4d7aa2,due_date:_0x3471ac}=_0x211104[_0x444458(0x131)],_0x3d81de=_0x211104[_0x444458(0x122)][_0x444458(0x134)];if(typeof _0x4d73d6==_0x444458(0xde))var _0x178746=[_0x211104[_0x444458(0x131)][_0x444458(0xee)]],_0x5c098f=[_0x211104['body'][_0x444458(0x10a)]],_0x11e077=[_0x211104['body'][_0x444458(0x107)]],_0x2cc7c4=[_0x211104['body'][_0x444458(0x130)]],_0x4b548d=[_0x211104[_0x444458(0x131)][_0x444458(0x128)]],_0x588cb8=[_0x211104[_0x444458(0x131)][_0x444458(0x10c)]],_0x3fa091=[_0x211104[_0x444458(0x131)][_0x444458(0xfe)]],_0x2f6f33=[_0x211104[_0x444458(0x131)][_0x444458(0x110)]],_0x1876f0=[_0x211104[_0x444458(0x131)]['adj_dicount_price']],_0x24bc54=[_0x211104['body'][_0x444458(0xdf)]],_0x4671b9=[_0x211104[_0x444458(0x131)]['no_per_unit']],_0xe0d622=[_0x211104['body'][_0x444458(0x101)]],_0x1ad4e9=[_0x211104[_0x444458(0x131)][_0x444458(0x108)]],_0x3d9ed0=[_0x211104[_0x444458(0x131)][_0x444458(0xf4)]],_0x4b4989=[_0x211104[_0x444458(0x131)]['conversion_unit']];else var _0x178746=[..._0x211104[_0x444458(0x131)][_0x444458(0xee)]],_0x5c098f=[..._0x211104['body'][_0x444458(0x10a)]],_0x11e077=[..._0x211104['body']['primary_code']],_0x2cc7c4=[..._0x211104[_0x444458(0x131)]['quantity']],_0x4b548d=[..._0x211104[_0x444458(0x131)][_0x444458(0x128)]],_0x588cb8=[..._0x211104['body']['price']],_0x3fa091=[..._0x211104['body']['totalPrice']],_0x2f6f33=[..._0x211104[_0x444458(0x131)][_0x444458(0x110)]],_0x1876f0=[..._0x211104[_0x444458(0x131)][_0x444458(0xfb)]],_0x24bc54=[..._0x211104[_0x444458(0x131)]['tmpisFG']],_0x4671b9=[..._0x211104[_0x444458(0x131)][_0x444458(0xe3)]],_0xe0d622=[..._0x211104[_0x444458(0x131)][_0x444458(0x101)]],_0x1ad4e9=[..._0x211104[_0x444458(0x131)][_0x444458(0x108)]],_0x3d9ed0=[..._0x211104['body']['secondary_unit']],_0x4b4989=[..._0x211104[_0x444458(0x131)]['conversion_unit']];const _0x134f9d=_0x178746[_0x444458(0x11b)](_0xccce5b=>{return _0xccce5b={'product_code':_0xccce5b};});_0x5c098f['forEach']((_0x38024c,_0x1c55ce)=>{_0x134f9d[_0x1c55ce]['product_name']=_0x38024c;}),_0x11e077[_0x444458(0x11c)]((_0x7bee53,_0x1ad8b9)=>{_0x134f9d[_0x1ad8b9]['primary_code']=_0x7bee53;}),_0x4671b9['forEach']((_0x5c16e8,_0x4074a5)=>{const _0x427632=_0x444458;_0x134f9d[_0x4074a5][_0x427632(0xe3)]=_0x5c16e8;}),_0x2cc7c4['forEach']((_0x5a214e,_0x16d39a)=>{const _0x526c42=_0x444458;_0x134f9d[_0x16d39a][_0x526c42(0x130)]=_0x5a214e;}),_0x4b548d[_0x444458(0x11c)]((_0x11507b,_0x4b5252)=>{const _0xbac8c3=_0x444458;_0x134f9d[_0x4b5252][_0xbac8c3(0x128)]=_0x11507b;}),_0x588cb8[_0x444458(0x11c)]((_0x3dce22,_0x3ce0bf)=>{_0x134f9d[_0x3ce0bf]['price']=_0x3dce22;}),_0x3fa091[_0x444458(0x11c)]((_0x492a2b,_0x4639fa)=>{_0x134f9d[_0x4639fa]['totalprice']=_0x492a2b;}),_0x2f6f33[_0x444458(0x11c)]((_0x4c6279,_0x42a05f)=>{const _0x5b855a=_0x444458;_0x134f9d[_0x42a05f][_0x5b855a(0x123)]=_0x4c6279;}),_0x1876f0[_0x444458(0x11c)]((_0x4d0bf4,_0x3fdf5b)=>{const _0x2dd607=_0x444458;_0x134f9d[_0x3fdf5b][_0x2dd607(0x11a)]=_0x4d0bf4;}),_0x24bc54[_0x444458(0x11c)]((_0x28569a,_0x2f257e)=>{const _0x29f9dd=_0x444458;_0x134f9d[_0x2f257e][_0x29f9dd(0xe0)]=_0x28569a;}),_0x3d9ed0[_0x444458(0x11c)]((_0x4bd13d,_0x1e727f)=>{const _0x22aea9=_0x444458;_0x134f9d[_0x1e727f][_0x22aea9(0xf4)]=_0x4bd13d;}),_0xe0d622[_0x444458(0x11c)]((_0x5ee134,_0x33340f)=>{const _0x3c11c0=_0x444458;_0x134f9d[_0x33340f][_0x3c11c0(0x104)]=_0x5ee134;}),_0x1ad4e9[_0x444458(0x11c)]((_0x468cd5,_0x39cc1f)=>{_0x134f9d[_0x39cc1f]['prod_cat']=_0x468cd5;}),_0x4b4989[_0x444458(0x11c)]((_0x56cfd5,_0x1a7839)=>{_0x134f9d[_0x1a7839]['conversion_data']=_0x56cfd5;});const _0x4fae2c=new invoice_sa();await _0x4fae2c['save']();const _0x3fa9b6=_0x211104[_0x444458(0x10d)],_0x346c41=await staff[_0x444458(0x11f)]({'email':_0x3fa9b6['email']}),_0x11b0ec=new sales_sa({'invoice':_0x4fae2c[_0x444458(0xed)][_0x444458(0xf3)]()[_0x444458(0x137)](0x8,'0'),'customer':_0x14caaf,'file':_0x3d81de,'date':_0x3cc36d,'sale_product':_0x134f9d,'note':_0x2038ff,'sales_staff_id':_0x346c41[_0x444458(0xf9)][_0x444458(0xea)](),'paid':_0x19abcd,'dsi':_0x3f685d,'cash':_0x226c8d,'amount':_0x46c50a,'bank':_0x3a0325,'check_no':_0x4d7aa2,'due_date':_0x3471ac}),_0x22aaea=await _0x11b0ec['save']();console[_0x444458(0xe6)](_0x444458(0xf5),_0x4fae2c[_0x444458(0xed)][_0x444458(0xf3)]()[_0x444458(0x137)](0x8,'0'));const _0x43a03b=mongoose['Types'][_0x444458(0xe2)];_0x211104['flash'](_0x444458(0x10b),'Sales\x20add\x20successfully'),_0x20ec12[_0x444458(0x11d)](_0x444458(0x139)+_0x22aaea[_0x444458(0xf9)]);}catch(_0x1b3f11){console[_0x444458(0xe6)](_0x1b3f11);}}),router['post']('/add_sales_notes',auth,async(_0x21f79b,_0x5ec779)=>{const _0x3cc9c8=a0_0x137f57;try{const {date_data:_0xceede0,note_data:_0x70eaf9,status_data:_0x40facb}=_0x21f79b['body'],_0x3c7383=new invoice_sa();await _0x3c7383[_0x3cc9c8(0xf2)]();const _0x2e7908=_0x21f79b[_0x3cc9c8(0x10d)],_0x4fd3d9=await staff[_0x3cc9c8(0x11f)]({'email':_0x2e7908['email']}),_0x1562a3=new sales_sa({'invoice':_0x3c7383[_0x3cc9c8(0xed)][_0x3cc9c8(0xf3)]()[_0x3cc9c8(0x137)](0x8,'0'),'status_data':_0x40facb,'date':_0xceede0,'note':_0x70eaf9,'sales_staff_id':_0x4fd3d9[_0x3cc9c8(0xf9)][_0x3cc9c8(0xea)]()}),_0x3b6e2=await _0x1562a3[_0x3cc9c8(0xf2)]();console[_0x3cc9c8(0xe6)]('Invoice\x20created\x20with\x20incremented\x20start\x20value:',_0x3c7383[_0x3cc9c8(0xed)][_0x3cc9c8(0xf3)]()[_0x3cc9c8(0x137)](0x8,'0'));const _0x4c9b08=mongoose['Types'][_0x3cc9c8(0xe2)];_0x21f79b[_0x3cc9c8(0x136)](_0x3cc9c8(0x10b),_0x3cc9c8(0xf0)),_0x5ec779[_0x3cc9c8(0x11d)]('/sales_sa/view_sales/'+_0x3b6e2[_0x3cc9c8(0xf9)]);}catch(_0x644661){console[_0x3cc9c8(0xe6)](_0x644661);}}),router[a0_0x137f57(0x11e)](a0_0x137f57(0xf1),auth,async(_0x3b391c,_0xb70069)=>{const _0x1177b4=a0_0x137f57;try{const _0x19c3db=_0x3b391c[_0x1177b4(0x10d)],_0x287ae9=await profile[_0x1177b4(0x11f)]({'email':_0x19c3db[_0x1177b4(0x125)]}),_0x5406cb=await staff[_0x1177b4(0x119)]([{'$match':{'email':_0x19c3db[_0x1177b4(0x125)]}},{'$unwind':_0x1177b4(0xe9)},{'$match':{'product_list.isConfirm':_0x1177b4(0x120)}}]);_0xb70069[_0x1177b4(0xef)](_0x5406cb);}catch(_0x2c51f7){}}),router[a0_0x137f57(0x11e)]('/customer_data',auth,async(_0x496beb,_0x42490f)=>{const _0x3a9b3b=a0_0x137f57;try{const {customer_name:_0x50cea6}=_0x496beb[_0x3a9b3b(0x131)],_0x4c671c=await customer[_0x3a9b3b(0x11f)]({'name':_0x50cea6});_0x42490f[_0x3a9b3b(0xef)](_0x4c671c);}catch(_0x4287cc){}}),router['post']('/product_data',auth,async(_0x4b0487,_0x224faf)=>{const _0x1d08d7=a0_0x137f57;try{const _0x5c311b=_0x4b0487[_0x1d08d7(0x10d)],{id_data:_0xe68e4}=_0x4b0487[_0x1d08d7(0x131)],_0x18ab19=await profile['findOne']({'email':_0x5c311b[_0x1d08d7(0x125)]}),_0x57fefd=mongoose[_0x1d08d7(0xec)][_0x1d08d7(0xe2)];console['log'](_0x57fefd(_0xe68e4));var _0x5afde9=_0x57fefd(_0xe68e4);const _0x2805f4=await staff['aggregate']([{'$match':{'email':_0x5c311b[_0x1d08d7(0x125)]}},{'$unwind':_0x1d08d7(0xe9)},{'$match':{'product_list.isConfirm':_0x1d08d7(0x120),'product_list._id':_0x5afde9}}]);_0x224faf[_0x1d08d7(0xef)](_0x2805f4);}catch(_0x425fc7){}}),router['post']('/volume_setup',auth,async(_0x5a4fd2,_0x5b2554)=>{const _0xcfa626=a0_0x137f57;try{const _0x4dd945=await discount_volume_db[_0xcfa626(0x11f)]();_0x5b2554[_0xcfa626(0xef)](_0x4dd945);}catch(_0x29f246){}}),router[a0_0x137f57(0x11e)](a0_0x137f57(0xe5),auth,async(_0x1e7f23,_0x3d6cd5)=>{const _0x5005af=a0_0x137f57;try{const _0x5345a9=await product['find']();_0x3d6cd5[_0x5005af(0xef)](_0x5345a9);}catch(_0x17b9da){}}),router['post'](a0_0x137f57(0x105),auth,async(_0x358e41,_0x1ae3a3)=>{const _0x52ef32=a0_0x137f57;try{const {id_data:_0x334ff9}=_0x358e41[_0x52ef32(0x131)],_0x49e956=await product[_0x52ef32(0xe4)](_0x334ff9);_0x1ae3a3[_0x52ef32(0xef)](_0x49e956);}catch(_0x286efe){}}),module[a0_0x137f57(0x12e)]=router;function a0_0x1161(){const _0x28f5b1=['language','id_transaction','multer','/view_sales/:id','12739272Kosdtk','diskStorage','view_sales_sa','find','Hindi','express','aggregate','adj_discount','map','forEach','redirect','post','findOne','true','exceljs','file','id_transaction_from','3434574XYaPHJ','email','German','370cMhaZd','unit','57588Akjtpx','3NAvzyM','English','add_sales_sa','Portuguese','exports','image','quantity','body','Portuguese\x20(BR)','343670ANDUEH','filename','get','flash','padStart','37740087agYRaI','/sales_sa/view_sales/','/add_sales','string','tmpisFG','isFG','French','ObjectId','no_per_unit','findById','/getProductData','log','../models/all_models','Arabic\x20(ae)','$product_list','valueOf','originalname','Types','invoice_starts','prod_code','json','Sales\x20add\x20successfully','/product_list','save','toString','secondary_unit','Invoice\x20created\x20with\x20incremented\x20start\x20value:','./public/sales_invoice','Spanish','Arabic','_id','render','adj_dicount_price','Router','Chinese','totalPrice','16qPizEd','108081ynhVwQ','getPrimUnitNo','1958560lewSXw','749GHmAKF','real_qty_unit_val','/product_data_id','single','primary_code','prod_cat','now','prod_name','success','price','user','all_sales_sa'];a0_0x1161=function(){return _0x28f5b1;};return a0_0x1161();}