const a0_0x56f037=a0_0x5cac;(function(_0x32b01f,_0x13b131){const _0x5ab1da=a0_0x5cac,_0x3a160b=_0x32b01f();while(!![]){try{const _0x159b51=-parseInt(_0x5ab1da(0x107))/0x1+-parseInt(_0x5ab1da(0x11c))/0x2+-parseInt(_0x5ab1da(0xe7))/0x3+-parseInt(_0x5ab1da(0x125))/0x4+parseInt(_0x5ab1da(0x106))/0x5*(-parseInt(_0x5ab1da(0xe1))/0x6)+parseInt(_0x5ab1da(0x10a))/0x7+parseInt(_0x5ab1da(0xe4))/0x8;if(_0x159b51===_0x13b131)break;else _0x3a160b['push'](_0x3a160b['shift']());}catch(_0x254d6d){_0x3a160b['push'](_0x3a160b['shift']());}}}(a0_0x5428,0x8ccbb));function a0_0x5cac(_0xd1c5e3,_0xb851c2){const _0x542839=a0_0x5428();return a0_0x5cac=function(_0x5cacdc,_0x20d2e5){_0x5cacdc=_0x5cacdc-0xd8;let _0x295cb7=_0x542839[_0x5cacdc];return _0x295cb7;},a0_0x5cac(_0xd1c5e3,_0xb851c2);}const express=require(a0_0x56f037(0xe5)),app=express(),router=express[a0_0x56f037(0xfd)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up,invoice_sa,sales_sa,discount_volume_db}=require('../models/all_models'),auth=require(a0_0x56f037(0x118)),users=require('../public/language/languages.json'),excelJS=require(a0_0x56f037(0x105)),xlsx=require('xlsx'),mongoose=require(a0_0x56f037(0xd9)),multer=require('multer'),storage=multer['diskStorage']({'destination':(_0x2d75b5,_0x1829f0,_0xf31615)=>{const _0x7902ef=a0_0x56f037;_0xf31615(null,_0x7902ef(0xec));},'filename':(_0x62778d,_0x2316df,_0x10fd6f)=>{const _0x1ed381=a0_0x56f037;_0x10fd6f(null,Date[_0x1ed381(0xd8)]()+'~'+_0x2316df[_0x1ed381(0xed)]);}}),upload=multer({'storage':storage});function a0_0x5428(){const _0xb3a839=['image','425280tFdxNh','errors','German','adj_dicount_price','all_sales_sa','Arabic','file','Invoice\x20created\x20with\x20incremented\x20start\x20value:','/product_list','2468892AaEErQ','$product_list','findOne','exports','render','Portuguese\x20(BR)','totalprice','Chinese','/sales_sa/view_sales/','prod_code','French','isFG','Portuguese','tmpisFG','primary_code','redirect','now','mongoose','Hindi','aggregate','conversion_unit','params','findById','English','invoice_starts','12NHiFNy','/view_sales/:id','log','26292328eGRnNm','express','body','983076XwrIGX','email','forEach','filename','adj_discount','./public/sales_invoice','originalname','no_per_unit','ObjectId','id_transaction_from','get','/add_sales_notes','English\x20(US)','getPrimUnitNo','/add_sales','save','/customer_data','prod_name','toString','_id','Sales\x20add\x20successfully','single','Router','unit','real_qty_unit_val','price','secondary_unit','totalPrice','Spanish','product_list','exceljs','2487505KOEluv','1021927OcEVio','success','product_name','3252494IFkSFS','json','add_sales_sa','Types','padStart','quantity','valueOf','flash','prod_cat','user','/getProductData','Arabic\x20(ae)','post','language','../middleware/auth','view_sales_sa','find'];a0_0x5428=function(){return _0xb3a839;};return a0_0x5428();}router['get']('/',auth,async(_0x20aaaf,_0x1f807f)=>{const _0x8d3eea=a0_0x56f037;try{const _0x43902e=await master_shop[_0x8d3eea(0x11a)](),_0x56738e=_0x20aaaf['user'],_0x55be62=await profile['findOne']({'email':_0x56738e[_0x8d3eea(0xe8)]}),_0x44eff9=await staff['findOne']({'email':_0x56738e['email']}),_0x9e00bb=await sales_sa[_0x8d3eea(0x11a)]({'sales_staff_id':_0x44eff9[_0x8d3eea(0xfa)]});if(_0x43902e[0x0]['language']==_0x8d3eea(0xf3))var _0xfad97d=users['English'];else{if(_0x43902e[0x0][_0x8d3eea(0x117)]==_0x8d3eea(0xda))var _0xfad97d=users[_0x8d3eea(0xda)];else{if(_0x43902e[0x0][_0x8d3eea(0x117)]==_0x8d3eea(0x11e))var _0xfad97d=users['German'];else{if(_0x43902e[0x0][_0x8d3eea(0x117)]=='Spanish')var _0xfad97d=users['Spanish'];else{if(_0x43902e[0x0][_0x8d3eea(0x117)]==_0x8d3eea(0x12f))var _0xfad97d=users[_0x8d3eea(0x12f)];else{if(_0x43902e[0x0][_0x8d3eea(0x117)]==_0x8d3eea(0x12a))var _0xfad97d=users[_0x8d3eea(0x131)];else{if(_0x43902e[0x0][_0x8d3eea(0x117)]==_0x8d3eea(0x12c))var _0xfad97d=users[_0x8d3eea(0x12c)];else{if(_0x43902e[0x0][_0x8d3eea(0x117)]==_0x8d3eea(0x115))var _0xfad97d=users['Arabic'];}}}}}}}_0x1f807f[_0x8d3eea(0x129)](_0x8d3eea(0x120),{'success':_0x20aaaf[_0x8d3eea(0x111)](_0x8d3eea(0x108)),'errors':_0x20aaaf[_0x8d3eea(0x111)](_0x8d3eea(0x11d)),'master_shop':_0x43902e,'profile':_0x55be62,'role':_0x56738e,'language':_0xfad97d,'product_list':_0x44eff9[_0x8d3eea(0x104)],'sales_mine':_0x9e00bb,'staff_arr':_0x44eff9});}catch(_0x15435e){console[_0x8d3eea(0xe3)](_0x15435e);}}),router[a0_0x56f037(0xf1)]('/add_sales',auth,async(_0x3cbe26,_0x32ad82)=>{const _0x595f7d=a0_0x56f037;try{const _0x53ae25=await master_shop[_0x595f7d(0x11a)](),_0x238b7e=_0x3cbe26[_0x595f7d(0x113)],_0xf2cd11=await profile[_0x595f7d(0x127)]({'email':_0x238b7e[_0x595f7d(0xe8)]}),_0x2f156a=await staff[_0x595f7d(0x127)]({'email':_0x238b7e['email']}),_0x3b1643=await customer[_0x595f7d(0x11a)]({'agent_id':_0x2f156a[_0x595f7d(0xfa)]});if(_0x53ae25[0x0]['language']==_0x595f7d(0xf3))var _0x167f47=users[_0x595f7d(0xdf)];else{if(_0x53ae25[0x0][_0x595f7d(0x117)]==_0x595f7d(0xda))var _0x167f47=users[_0x595f7d(0xda)];else{if(_0x53ae25[0x0]['language']==_0x595f7d(0x11e))var _0x167f47=users[_0x595f7d(0x11e)];else{if(_0x53ae25[0x0][_0x595f7d(0x117)]==_0x595f7d(0x103))var _0x167f47=users['Spanish'];else{if(_0x53ae25[0x0][_0x595f7d(0x117)]==_0x595f7d(0x12f))var _0x167f47=users[_0x595f7d(0x12f)];else{if(_0x53ae25[0x0][_0x595f7d(0x117)]==_0x595f7d(0x12a))var _0x167f47=users[_0x595f7d(0x131)];else{if(_0x53ae25[0x0][_0x595f7d(0x117)]==_0x595f7d(0x12c))var _0x167f47=users[_0x595f7d(0x12c)];else{if(_0x53ae25[0x0]['language']==_0x595f7d(0x115))var _0x167f47=users['Arabic'];}}}}}}}_0x32ad82[_0x595f7d(0x129)](_0x595f7d(0x10c),{'success':_0x3cbe26[_0x595f7d(0x111)](_0x595f7d(0x108)),'errors':_0x3cbe26[_0x595f7d(0x111)](_0x595f7d(0x11d)),'master_shop':_0x53ae25,'profile':_0xf2cd11,'role':_0x238b7e,'language':_0x167f47,'customer':_0x3b1643,'staff_arr':_0x2f156a});}catch(_0x531fb1){console[_0x595f7d(0xe3)](_0x531fb1);}}),router[a0_0x56f037(0xf1)](a0_0x56f037(0xe2),auth,async(_0x3c1f17,_0x4682d2)=>{const _0x37894d=a0_0x56f037;try{const _0x4e2b99=await master_shop[_0x37894d(0x11a)](),_0x3fc237=_0x3c1f17[_0x37894d(0x113)],_0x16612d=await profile['findOne']({'email':_0x3fc237[_0x37894d(0xe8)]}),_0xb951cb=await staff[_0x37894d(0x127)]({'email':_0x3fc237[_0x37894d(0xe8)]}),_0x5491b0=await customer[_0x37894d(0x11a)]({'agent_id':_0xb951cb[_0x37894d(0xfa)]}),_0x4d2cd7=_0x3c1f17[_0x37894d(0xdd)]['id'],_0xba8201=await sales_sa['findById'](_0x4d2cd7);if(_0x4e2b99[0x0]['language']=='English\x20(US)')var _0x4ffd4e=users['English'];else{if(_0x4e2b99[0x0][_0x37894d(0x117)]=='Hindi')var _0x4ffd4e=users[_0x37894d(0xda)];else{if(_0x4e2b99[0x0]['language']==_0x37894d(0x11e))var _0x4ffd4e=users['German'];else{if(_0x4e2b99[0x0][_0x37894d(0x117)]==_0x37894d(0x103))var _0x4ffd4e=users['Spanish'];else{if(_0x4e2b99[0x0][_0x37894d(0x117)]==_0x37894d(0x12f))var _0x4ffd4e=users['French'];else{if(_0x4e2b99[0x0]['language']==_0x37894d(0x12a))var _0x4ffd4e=users[_0x37894d(0x131)];else{if(_0x4e2b99[0x0]['language']==_0x37894d(0x12c))var _0x4ffd4e=users['Chinese'];else{if(_0x4e2b99[0x0][_0x37894d(0x117)]==_0x37894d(0x115))var _0x4ffd4e=users[_0x37894d(0x121)];}}}}}}}_0x4682d2[_0x37894d(0x129)](_0x37894d(0x119),{'success':_0x3c1f17[_0x37894d(0x111)](_0x37894d(0x108)),'errors':_0x3c1f17[_0x37894d(0x111)](_0x37894d(0x11d)),'master_shop':_0x4e2b99,'profile':_0x16612d,'role':_0x3fc237,'language':_0x4ffd4e,'customer':_0x5491b0,'sales_sa':_0xba8201,'staff_arr':_0xb951cb});}catch(_0x41c876){console['log'](_0x41c876);}}),router[a0_0x56f037(0x116)](a0_0x56f037(0xf5),auth,upload[a0_0x56f037(0xfc)](a0_0x56f037(0x11b)),async(_0x29deb6,_0x5c2c4b)=>{const _0x25eb42=a0_0x56f037;try{const {customer:_0x24f7f1,date:_0x36a85d,prod_code:_0x40ee95,note:_0x30e368,paid_status:_0x3c1fda,DSI:_0x32a5ee,cash_amount:_0x50c422,amount_data:_0x2e31e2,bank_data:_0x158312,check_no:_0x5ddca5,due_date:_0x1ee1ad}=_0x29deb6[_0x25eb42(0xe6)],_0x8252c4=_0x29deb6[_0x25eb42(0x122)][_0x25eb42(0xea)];if(typeof _0x40ee95=='string')var _0x51ef02=[_0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x12e)]],_0x25ddf1=[_0x29deb6['body'][_0x25eb42(0xf8)]],_0x561658=[_0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x133)]],_0x59f1be=[_0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x10f)]],_0x4e9b1d=[_0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0xfe)]],_0x14e356=[_0x29deb6['body'][_0x25eb42(0x100)]],_0x897920=[_0x29deb6[_0x25eb42(0xe6)]['totalPrice']],_0x23971a=[_0x29deb6[_0x25eb42(0xe6)]['id_transaction']],_0xd9644a=[_0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x11f)]],_0x507181=[_0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x132)]],_0x38a526=[_0x29deb6['body'][_0x25eb42(0xee)]],_0xe35605=[_0x29deb6[_0x25eb42(0xe6)]['getPrimUnitNo']],_0x9efaa2=[_0x29deb6['body'][_0x25eb42(0x112)]],_0x124dd3=[_0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x101)]],_0xdf2cb0=[_0x29deb6['body'][_0x25eb42(0xdc)]];else var _0x51ef02=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x12e)]],_0x25ddf1=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0xf8)]],_0x561658=[..._0x29deb6['body']['primary_code']],_0x59f1be=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x10f)]],_0x4e9b1d=[..._0x29deb6['body'][_0x25eb42(0xfe)]],_0x14e356=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x100)]],_0x897920=[..._0x29deb6['body'][_0x25eb42(0x102)]],_0x23971a=[..._0x29deb6[_0x25eb42(0xe6)]['id_transaction']],_0xd9644a=[..._0x29deb6[_0x25eb42(0xe6)]['adj_dicount_price']],_0x507181=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x132)]],_0x38a526=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0xee)]],_0xe35605=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0xf4)]],_0x9efaa2=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0x112)]],_0x124dd3=[..._0x29deb6['body'][_0x25eb42(0x101)]],_0xdf2cb0=[..._0x29deb6[_0x25eb42(0xe6)][_0x25eb42(0xdc)]];const _0x375cfe=_0x51ef02['map'](_0xd7c3e0=>{return _0xd7c3e0={'product_code':_0xd7c3e0};});_0x25ddf1[_0x25eb42(0xe9)]((_0x5d6c84,_0x5d40af)=>{const _0x2d72b3=_0x25eb42;_0x375cfe[_0x5d40af][_0x2d72b3(0x109)]=_0x5d6c84;}),_0x561658[_0x25eb42(0xe9)]((_0x110807,_0xf61b7b)=>{const _0x54b30f=_0x25eb42;_0x375cfe[_0xf61b7b][_0x54b30f(0x133)]=_0x110807;}),_0x38a526[_0x25eb42(0xe9)]((_0x58651c,_0x787328)=>{const _0x26c655=_0x25eb42;_0x375cfe[_0x787328][_0x26c655(0xee)]=_0x58651c;}),_0x59f1be[_0x25eb42(0xe9)]((_0x18140f,_0x267093)=>{_0x375cfe[_0x267093]['quantity']=_0x18140f;}),_0x4e9b1d[_0x25eb42(0xe9)]((_0x3a0fb4,_0xf8f256)=>{const _0x1788e4=_0x25eb42;_0x375cfe[_0xf8f256][_0x1788e4(0xfe)]=_0x3a0fb4;}),_0x14e356['forEach']((_0x9de7b2,_0x29ad8e)=>{_0x375cfe[_0x29ad8e]['price']=_0x9de7b2;}),_0x897920[_0x25eb42(0xe9)]((_0x2b99c2,_0xb3e9c)=>{const _0x3d3344=_0x25eb42;_0x375cfe[_0xb3e9c][_0x3d3344(0x12b)]=_0x2b99c2;}),_0x23971a[_0x25eb42(0xe9)]((_0x34672a,_0x5ba87d)=>{const _0x5dfea0=_0x25eb42;_0x375cfe[_0x5ba87d][_0x5dfea0(0xf0)]=_0x34672a;}),_0xd9644a[_0x25eb42(0xe9)]((_0x495e1b,_0x575d1d)=>{const _0x73a63e=_0x25eb42;_0x375cfe[_0x575d1d][_0x73a63e(0xeb)]=_0x495e1b;}),_0x507181['forEach']((_0x3cd488,_0x3ae0ca)=>{const _0x1011bb=_0x25eb42;_0x375cfe[_0x3ae0ca][_0x1011bb(0x130)]=_0x3cd488;}),_0x124dd3[_0x25eb42(0xe9)]((_0x579a78,_0x2e5893)=>{const _0x25ff26=_0x25eb42;_0x375cfe[_0x2e5893][_0x25ff26(0x101)]=_0x579a78;}),_0xe35605[_0x25eb42(0xe9)]((_0x22c6f8,_0x4d5ce5)=>{const _0x386bb8=_0x25eb42;_0x375cfe[_0x4d5ce5][_0x386bb8(0xff)]=_0x22c6f8;}),_0x9efaa2[_0x25eb42(0xe9)]((_0x407c67,_0x4afd66)=>{const _0xf758b1=_0x25eb42;_0x375cfe[_0x4afd66][_0xf758b1(0x112)]=_0x407c67;}),_0xdf2cb0['forEach']((_0x57dea7,_0x546372)=>{_0x375cfe[_0x546372]['conversion_data']=_0x57dea7;});const _0x1edc44=new invoice_sa();await _0x1edc44[_0x25eb42(0xf6)]();const _0x506877=_0x29deb6[_0x25eb42(0x113)],_0x2b3fe6=await staff[_0x25eb42(0x127)]({'email':_0x506877['email']}),_0x5f30d2=new sales_sa({'invoice':_0x1edc44['invoice_starts'][_0x25eb42(0xf9)]()[_0x25eb42(0x10e)](0x8,'0'),'customer':_0x24f7f1,'file':_0x8252c4,'date':_0x36a85d,'sale_product':_0x375cfe,'note':_0x30e368,'sales_staff_id':_0x2b3fe6[_0x25eb42(0xfa)][_0x25eb42(0x110)](),'paid':_0x3c1fda,'dsi':_0x32a5ee,'cash':_0x50c422,'amount':_0x2e31e2,'bank':_0x158312,'check_no':_0x5ddca5,'due_date':_0x1ee1ad}),_0x91b125=await _0x5f30d2[_0x25eb42(0xf6)]();console['log'](_0x25eb42(0x123),_0x1edc44[_0x25eb42(0xe0)][_0x25eb42(0xf9)]()['padStart'](0x8,'0'));const _0x431977=mongoose[_0x25eb42(0x10d)][_0x25eb42(0xef)];_0x29deb6[_0x25eb42(0x111)](_0x25eb42(0x108),_0x25eb42(0xfb)),_0x5c2c4b[_0x25eb42(0x134)](_0x25eb42(0x12d)+_0x91b125[_0x25eb42(0xfa)]);}catch(_0x157def){console[_0x25eb42(0xe3)](_0x157def);}}),router[a0_0x56f037(0x116)](a0_0x56f037(0xf2),auth,async(_0x4bcd6d,_0x13e9ce)=>{const _0x5bf2ae=a0_0x56f037;try{const {date_data:_0x56c8fc,note_data:_0x361a78,status_data:_0x115e92}=_0x4bcd6d[_0x5bf2ae(0xe6)],_0x429dee=new invoice_sa();await _0x429dee[_0x5bf2ae(0xf6)]();const _0x48a5e8=_0x4bcd6d[_0x5bf2ae(0x113)],_0x4b10c7=await staff[_0x5bf2ae(0x127)]({'email':_0x48a5e8['email']}),_0x2b7494=new sales_sa({'invoice':_0x429dee[_0x5bf2ae(0xe0)][_0x5bf2ae(0xf9)]()[_0x5bf2ae(0x10e)](0x8,'0'),'status_data':_0x115e92,'date':_0x56c8fc,'note':_0x361a78,'sales_staff_id':_0x4b10c7[_0x5bf2ae(0xfa)]['valueOf']()}),_0x3c3300=await _0x2b7494[_0x5bf2ae(0xf6)]();console[_0x5bf2ae(0xe3)](_0x5bf2ae(0x123),_0x429dee['invoice_starts']['toString']()[_0x5bf2ae(0x10e)](0x8,'0'));const _0x3156b6=mongoose['Types'][_0x5bf2ae(0xef)];_0x4bcd6d[_0x5bf2ae(0x111)](_0x5bf2ae(0x108),_0x5bf2ae(0xfb)),_0x13e9ce[_0x5bf2ae(0x134)](_0x5bf2ae(0x12d)+_0x3c3300[_0x5bf2ae(0xfa)]);}catch(_0x4801fd){console[_0x5bf2ae(0xe3)](_0x4801fd);}}),router[a0_0x56f037(0x116)](a0_0x56f037(0x124),auth,async(_0x451f7f,_0x14796c)=>{const _0x5c11ea=a0_0x56f037;try{const _0x22fdae=_0x451f7f['user'],_0x413560=await profile[_0x5c11ea(0x127)]({'email':_0x22fdae['email']}),_0x538026=await staff[_0x5c11ea(0xdb)]([{'$match':{'email':_0x22fdae[_0x5c11ea(0xe8)]}},{'$unwind':_0x5c11ea(0x126)},{'$match':{'product_list.isConfirm':'true'}}]);_0x14796c[_0x5c11ea(0x10b)](_0x538026);}catch(_0x3cb757){}}),router['post'](a0_0x56f037(0xf7),auth,async(_0x52dd82,_0x302881)=>{const _0x227188=a0_0x56f037;try{const {customer_name:_0x557285}=_0x52dd82[_0x227188(0xe6)],_0x1f66a7=await customer[_0x227188(0x127)]({'name':_0x557285});_0x302881[_0x227188(0x10b)](_0x1f66a7);}catch(_0x505867){}}),router[a0_0x56f037(0x116)]('/product_data',auth,async(_0x2469ef,_0x524286)=>{const _0x5cebc4=a0_0x56f037;try{const _0x3ec12d=_0x2469ef['user'],{id_data:_0x421caf}=_0x2469ef[_0x5cebc4(0xe6)],_0x1aedc8=await profile[_0x5cebc4(0x127)]({'email':_0x3ec12d[_0x5cebc4(0xe8)]}),_0xf20398=mongoose[_0x5cebc4(0x10d)][_0x5cebc4(0xef)];console[_0x5cebc4(0xe3)](_0xf20398(_0x421caf));var _0x1d436e=_0xf20398(_0x421caf);const _0x57527f=await staff[_0x5cebc4(0xdb)]([{'$match':{'email':_0x3ec12d[_0x5cebc4(0xe8)]}},{'$unwind':_0x5cebc4(0x126)},{'$match':{'product_list.isConfirm':'true','product_list._id':_0x1d436e}}]);_0x524286['json'](_0x57527f);}catch(_0x3b4a24){}}),router[a0_0x56f037(0x116)]('/volume_setup',auth,async(_0x65f3a3,_0x5f0b03)=>{const _0x37a139=a0_0x56f037;try{const _0x5b2410=await discount_volume_db[_0x37a139(0x127)]();_0x5f0b03['json'](_0x5b2410);}catch(_0x5a967e){}}),router[a0_0x56f037(0x116)](a0_0x56f037(0x114),auth,async(_0x3fab93,_0x5896e5)=>{try{const _0x43379b=await product['find']();_0x5896e5['json'](_0x43379b);}catch(_0x3855ef){}}),router[a0_0x56f037(0x116)]('/product_data_id',auth,async(_0xd4d25a,_0x3859e5)=>{const _0xec057d=a0_0x56f037;try{const {id_data:_0x32001a}=_0xd4d25a['body'],_0x20a172=await product[_0xec057d(0xde)](_0x32001a);_0x3859e5['json'](_0x20a172);}catch(_0x2d578a){}}),module[a0_0x56f037(0x128)]=router;