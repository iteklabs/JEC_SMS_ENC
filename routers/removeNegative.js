const a0_0x25911c=a0_0xc8a8;function a0_0x3e4b(){const _0x448928=['$product._id','errors','warehouse_data','data_adjustment','invoice','all','table\x20page','$product.to_quantity','/join','Router','length','$sale_product.invoice','/negative','../../models/all_models','$product.new_adjust_qty','7571673VGhVTK','$sale_product.quantity','945sicxCg','8056872WpDuIv','log','get','data_transfer','success','$sale_product._id','INCF-52068316','data_sales','$product_details.product_stock','14800005047429','modifiedCount','$product.id_transaction_id','updateMany','117751TyEkeY','json','$name','$product_details','$product.room_names','$product_details.product_code','$sale_product.product_name','map','warehouses','$product_details.product_name','$to_warehouse','$product.invoice','\x20documents\x20updated','125CbCuiW','$product.product_code','$sale_product.product_code','$product','$product.product_name','$sale_product.room_name','_id','$product_details.invoice','valueOf','$room','26392VQsNul','13400LggUVA','$invoice','$$invoice','aggregate','render','status','2SFVJaR','$sale_product','flash','53890MAbnjn','4141587KtRhHX','$warehouse_name','push'];a0_0x3e4b=function(){return _0x448928;};return a0_0x3e4b();}function a0_0xc8a8(_0x59d390,_0x131d98){const _0x3e4b45=a0_0x3e4b();return a0_0xc8a8=function(_0xc8a85c,_0x1d105f){_0xc8a85c=_0xc8a85c-0x11c;let _0x5e5c50=_0x3e4b45[_0xc8a85c];return _0x5e5c50;},a0_0xc8a8(_0x59d390,_0x131d98);}(function(_0x5091fd,_0xaff709){const _0x48514c=a0_0xc8a8,_0x4c4a27=_0x5091fd();while(!![]){try{const _0xefdca2=-parseInt(_0x48514c(0x127))/0x1*(-parseInt(_0x48514c(0x145))/0x2)+-parseInt(_0x48514c(0x149))/0x3+-parseInt(_0x48514c(0x13e))/0x4*(-parseInt(_0x48514c(0x134))/0x5)+parseInt(_0x48514c(0x15e))/0x6+parseInt(_0x48514c(0x15d))/0x7*(-parseInt(_0x48514c(0x13f))/0x8)+parseInt(_0x48514c(0x15b))/0x9+parseInt(_0x48514c(0x148))/0xa;if(_0xefdca2===_0xaff709)break;else _0x4c4a27['push'](_0x4c4a27['shift']());}catch(_0x3bcb8a){_0x4c4a27['push'](_0x4c4a27['shift']());}}}(a0_0x3e4b,0xd3509));const express=require('express'),app=express(),router=express[a0_0x25911c(0x155)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x25911c(0x159));router[a0_0x25911c(0x11c)](a0_0x25911c(0x158),async(_0x470de1,_0x360476)=>{const _0x661f77=a0_0x25911c;try{const _0x571ab3=await warehouse[_0x661f77(0x126)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x360476[_0x661f77(0x128)]({'status':_0x571ab3[_0x661f77(0x124)]+_0x661f77(0x133)});}catch(_0x8955ad){console[_0x661f77(0x15f)]('table\x20page',_0x8955ad),_0x360476[_0x661f77(0x144)](0xc8)[_0x661f77(0x128)]({'message':_0x8955ad['message']});}}),router[a0_0x25911c(0x11c)]('/checking',async(_0x3388c4,_0x7146a9)=>{const _0x2167ba=a0_0x25911c;try{const _0x13bffd=await warehouse[_0x2167ba(0x142)]([{'$unwind':_0x2167ba(0x12a)},{'$match':{'product_details.invoice':_0x2167ba(0x120),'product_details.primary_code':_0x2167ba(0x123)}},{'$group':{'_id':{'name':_0x2167ba(0x129),'room':_0x2167ba(0x13d)},'products':{'$push':_0x2167ba(0x12a)}}}]);_0x7146a9[_0x2167ba(0x128)](_0x13bffd);}catch(_0x484c81){console['log'](_0x2167ba(0x152),_0x484c81),_0x7146a9[_0x2167ba(0x144)](0xc8)[_0x2167ba(0x128)]({'message':_0x484c81['message']});}}),router[a0_0x25911c(0x11c)]('/warehouse_monitor',async(_0x4dd4e2,_0x5ec2b7)=>{const _0x4fe329=a0_0x25911c;_0x5ec2b7[_0x4fe329(0x143)]('monitor',{'success':_0x4dd4e2[_0x4fe329(0x147)](_0x4fe329(0x11e)),'errors':_0x4dd4e2[_0x4fe329(0x147)](_0x4fe329(0x14d))});}),router[a0_0x25911c(0x11c)](a0_0x25911c(0x154),async(_0x1bb98c,_0x3be113)=>{const _0x58a88b=a0_0x25911c;var _0x1ba2b8=await purchases[_0x58a88b(0x142)]([{'$lookup':{'from':_0x58a88b(0x12f),'let':{'invoice':_0x58a88b(0x140)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x58a88b(0x141),_0x58a88b(0x13b)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x58a88b(0x130),'product_code':_0x58a88b(0x12c),'quantity_available':_0x58a88b(0x122),'warehouse_name':_0x58a88b(0x129),'warehouse_room':_0x58a88b(0x13d),'invoice':_0x58a88b(0x13b)}}],'as':_0x58a88b(0x14e)}}]);_0x1ba2b8[_0x58a88b(0x121)]={},await Promise[_0x58a88b(0x151)](_0x1ba2b8[_0x58a88b(0x12e)](async _0xf0ae22=>{const _0x101a34=_0x58a88b;_0x1ba2b8[_0x101a34(0x121)][_0xf0ae22[_0x101a34(0x150)]]=[],await Promise[_0x101a34(0x151)](_0xf0ae22[_0x101a34(0x14e)][_0x101a34(0x12e)](async _0x42985f=>{const _0x5ed99f=_0x101a34,_0x4090e7=await sales[_0x5ed99f(0x142)]([{'$unwind':_0x5ed99f(0x146)},{'$match':{'sale_product.id_transaction_from':_0x42985f[_0x5ed99f(0x13a)][_0x5ed99f(0x13c)](),'sale_product.invoice':_0x42985f[_0x5ed99f(0x150)]}},{'$project':{'_id':_0x5ed99f(0x11f),'product_name':_0x5ed99f(0x12d),'product_code':_0x5ed99f(0x136),'quantity_available':_0x5ed99f(0x15c),'warehouse_name':'$warehouse_name','warehouse_room':_0x5ed99f(0x139),'product_invoice':_0x5ed99f(0x157),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x4090e7[_0x5ed99f(0x156)]>0x0&&_0x1ba2b8[_0x5ed99f(0x121)][_0xf0ae22['invoice']][_0x5ed99f(0x14b)](..._0x4090e7);}));})),_0x1ba2b8[_0x58a88b(0x121)]=_0x1ba2b8['data_sales'],_0x1ba2b8['data_adjustment']={},await Promise[_0x58a88b(0x151)](_0x1ba2b8['map'](async _0x4a8653=>{const _0x1edbb5=_0x58a88b;_0x1ba2b8[_0x1edbb5(0x14f)][_0x4a8653[_0x1edbb5(0x150)]]=[],await Promise['all'](_0x4a8653[_0x1edbb5(0x14e)]['map'](async _0x3c2225=>{const _0x14fc72=_0x1edbb5,_0x286e34=await adjustment[_0x14fc72(0x142)]([{'$unwind':_0x14fc72(0x137)},{'$match':{'product.id_transaction_from':_0x3c2225['_id'][_0x14fc72(0x13c)](),'product.invoice':_0x3c2225[_0x14fc72(0x150)]}},{'$project':{'_id':_0x14fc72(0x14c),'product_name':_0x14fc72(0x138),'product_code':_0x14fc72(0x135),'quantity_available':_0x14fc72(0x15a),'warehouse_name':_0x14fc72(0x14a),'warehouse_room':_0x14fc72(0x12b),'product_invoice':_0x14fc72(0x132),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from'}}]);_0x286e34[_0x14fc72(0x156)]>0x0&&_0x1ba2b8[_0x14fc72(0x14f)][_0x4a8653['invoice']]['push'](..._0x286e34);}));})),_0x1ba2b8[_0x58a88b(0x11d)]={},await Promise[_0x58a88b(0x151)](_0x1ba2b8[_0x58a88b(0x12e)](async _0x3340a7=>{const _0x563dd=_0x58a88b;_0x1ba2b8[_0x563dd(0x11d)][_0x3340a7['invoice']]=[],await Promise[_0x563dd(0x151)](_0x3340a7[_0x563dd(0x14e)]['map'](async _0x577e19=>{const _0x2a679e=_0x563dd,_0x16ded2=await transfers['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x577e19[_0x2a679e(0x13a)]['valueOf'](),'product.To_invoice':_0x577e19[_0x2a679e(0x150)]}},{'$project':{'_id':'$product._id','product_name':_0x2a679e(0x138),'product_code':_0x2a679e(0x135),'quantity_available':_0x2a679e(0x153),'warehouse_name':_0x2a679e(0x131),'warehouse_room':_0x2a679e(0x12b),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_id':_0x2a679e(0x125)}}]);console['log'](_0x16ded2),_0x16ded2[_0x2a679e(0x156)]>0x0&&_0x1ba2b8[_0x2a679e(0x11d)][_0x3340a7['invoice']][_0x2a679e(0x14b)](..._0x16ded2);}));})),_0x3be113['json']({'purchases_warehouse':_0x1ba2b8,'data_sales':_0x1ba2b8[_0x58a88b(0x121)],'data_adjustment':_0x1ba2b8[_0x58a88b(0x14f)],'data_transfer':_0x1ba2b8[_0x58a88b(0x11d)]});}),module['exports']=router;