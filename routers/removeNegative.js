const a0_0x29c66c=a0_0x1412;function a0_0x1412(_0x233305,_0x4d7560){const _0x47f273=a0_0x47f2();return a0_0x1412=function(_0x141264,_0xa936bc){_0x141264=_0x141264-0xdf;let _0x26ebea=_0x47f273[_0x141264];return _0x26ebea;},a0_0x1412(_0x233305,_0x4d7560);}function a0_0x47f2(){const _0x367e51=['$sale_product._id','$product.new_adjust_qty','message','Router','monitor','5CGleFt','render','4525842jakMwL','$to_warehouse','$product_details.product_code','425205CBwHbp','$sale_product.product_name','1572572QbuZOQ','status','warehouses','$sale_product','14800005047429','valueOf','exports','203790oVzHUO','data_sales','$product.product_code','INCF-52068316','json','$product_details._id','\x20documents\x20updated','get','/negative','$product','$product.id_transaction_from','$name','invoice','30201AFuctZ','$product.room_names','$product.to_quantity','$invoice','errors','$product._id','3638446XkGyDl','log','$product_details','$sale_product.invoice','_id','392FzPCWy','/join','updateMany','$warehouse_name','data_adjustment','warehouse_data','data_transfer','$product_details.product_stock','$product_details.invoice','176LIzDyd','all','$sale_product.product_code','$sale_product.id_transaction_from','flash','$product.to_room_name','$sale_product.room_name','push','aggregate','modifiedCount','length','$room','$product_details.product_name','137277eDYBVZ','map','2Nbmyzt','$product.id_transaction_id','../../models/all_models','table\x20page','/warehouse_monitor'];a0_0x47f2=function(){return _0x367e51;};return a0_0x47f2();}(function(_0x524ec5,_0x29c69f){const _0x4a3ae9=a0_0x1412,_0x40bd7b=_0x524ec5();while(!![]){try{const _0x5188f7=parseInt(_0x4a3ae9(0xf7))/0x1*(-parseInt(_0x4a3ae9(0x11a))/0x2)+-parseInt(_0x4a3ae9(0xe1))/0x3+parseInt(_0x4a3ae9(0xe3))/0x4*(parseInt(_0x4a3ae9(0x124))/0x5)+-parseInt(_0x4a3ae9(0x126))/0x6+parseInt(_0x4a3ae9(0xfd))/0x7+parseInt(_0x4a3ae9(0x102))/0x8*(parseInt(_0x4a3ae9(0x118))/0x9)+-parseInt(_0x4a3ae9(0xea))/0xa*(parseInt(_0x4a3ae9(0x10b))/0xb);if(_0x5188f7===_0x29c69f)break;else _0x40bd7b['push'](_0x40bd7b['shift']());}catch(_0x926de4){_0x40bd7b['push'](_0x40bd7b['shift']());}}}(a0_0x47f2,0x639cb));const express=require('express'),app=express(),router=express[a0_0x29c66c(0x122)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x29c66c(0x11c));router['get'](a0_0x29c66c(0xf2),async(_0x2c9adb,_0xfae00e)=>{const _0x5ef20b=a0_0x29c66c;try{const _0xed1b7f=await warehouse[_0x5ef20b(0x104)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0xfae00e[_0x5ef20b(0xee)]({'status':_0xed1b7f[_0x5ef20b(0x114)]+_0x5ef20b(0xf0)});}catch(_0x71e63b){console['log'](_0x5ef20b(0x11d),_0x71e63b),_0xfae00e[_0x5ef20b(0xe4)](0xc8)[_0x5ef20b(0xee)]({'message':_0x71e63b[_0x5ef20b(0x121)]});}}),router[a0_0x29c66c(0xf1)]('/checking',async(_0x3ecd2c,_0x3a9a8b)=>{const _0x3196ad=a0_0x29c66c;try{const _0x4d932d=await warehouse[_0x3196ad(0x113)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0x3196ad(0xed),'product_details.primary_code':_0x3196ad(0xe7)}},{'$group':{'_id':{'name':_0x3196ad(0xf5),'room':'$room'},'products':{'$push':_0x3196ad(0xff)}}}]);_0x3a9a8b[_0x3196ad(0xee)](_0x4d932d);}catch(_0xc7472){console[_0x3196ad(0xfe)](_0x3196ad(0x11d),_0xc7472),_0x3a9a8b[_0x3196ad(0xe4)](0xc8)['json']({'message':_0xc7472[_0x3196ad(0x121)]});}}),router[a0_0x29c66c(0xf1)](a0_0x29c66c(0x11e),async(_0x288988,_0x2609ad)=>{const _0x2bbd06=a0_0x29c66c;_0x2609ad[_0x2bbd06(0x125)](_0x2bbd06(0x123),{'success':_0x288988[_0x2bbd06(0x10f)]('success'),'errors':_0x288988[_0x2bbd06(0x10f)](_0x2bbd06(0xfb))});}),router['get'](a0_0x29c66c(0x103),async(_0x516a46,_0x5b7dba)=>{const _0x585436=a0_0x29c66c;var _0x9459b4=await purchases[_0x585436(0x113)]([{'$lookup':{'from':_0x585436(0xe5),'let':{'invoice':_0x585436(0xfa)},'pipeline':[{'$unwind':_0x585436(0xff)},{'$match':{'$expr':{'$eq':['$$invoice',_0x585436(0x10a)]}}},{'$project':{'_id':_0x585436(0xef),'product_name':_0x585436(0x117),'product_code':_0x585436(0xe0),'quantity_available':_0x585436(0x109),'warehouse_name':_0x585436(0xf5),'warehouse_room':_0x585436(0x116),'invoice':_0x585436(0x10a)}}],'as':'warehouse_data'}}]);_0x9459b4[_0x585436(0xeb)]={},await Promise['all'](_0x9459b4[_0x585436(0x119)](async _0x573652=>{const _0x16b547=_0x585436;_0x9459b4[_0x16b547(0xeb)][_0x573652[_0x16b547(0xf6)]]=[],await Promise[_0x16b547(0x10c)](_0x573652['warehouse_data'][_0x16b547(0x119)](async _0x238b88=>{const _0x19eb09=_0x16b547,_0x379834=await sales['aggregate']([{'$unwind':_0x19eb09(0xe6)},{'$match':{'sale_product.id_transaction_from':_0x238b88[_0x19eb09(0x101)][_0x19eb09(0xe8)](),'sale_product.invoice':_0x238b88['invoice']}},{'$project':{'_id':_0x19eb09(0x11f),'product_name':_0x19eb09(0xe2),'product_code':_0x19eb09(0x10d),'quantity_available':'$sale_product.quantity','warehouse_name':_0x19eb09(0x105),'warehouse_room':_0x19eb09(0x111),'product_invoice':_0x19eb09(0x100),'invoice':_0x19eb09(0xfa),'id_transaction_from':_0x19eb09(0x10e)}}]);_0x379834[_0x19eb09(0x115)]>0x0&&_0x9459b4[_0x19eb09(0xeb)][_0x573652[_0x19eb09(0xf6)]]['push'](..._0x379834);}));})),_0x9459b4[_0x585436(0xeb)]=_0x9459b4['data_sales'],_0x9459b4[_0x585436(0x106)]={},await Promise['all'](_0x9459b4['map'](async _0x48ca42=>{const _0x2389c7=_0x585436;_0x9459b4[_0x2389c7(0x106)][_0x48ca42['invoice']]=[],await Promise['all'](_0x48ca42[_0x2389c7(0x107)][_0x2389c7(0x119)](async _0x3dcb26=>{const _0x18fb95=_0x2389c7,_0x27ad35=await adjustment[_0x18fb95(0x113)]([{'$unwind':_0x18fb95(0xf3)},{'$match':{'product.id_transaction_from':_0x3dcb26[_0x18fb95(0x101)]['valueOf'](),'product.invoice':_0x3dcb26[_0x18fb95(0xf6)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x18fb95(0xec),'quantity_available':_0x18fb95(0x120),'warehouse_name':'$warehouse_name','warehouse_room':_0x18fb95(0xf8),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':_0x18fb95(0xf4)}}]);_0x27ad35[_0x18fb95(0x115)]>0x0&&_0x9459b4[_0x18fb95(0x106)][_0x48ca42[_0x18fb95(0xf6)]][_0x18fb95(0x112)](..._0x27ad35);}));})),_0x9459b4[_0x585436(0x108)]={},await Promise['all'](_0x9459b4[_0x585436(0x119)](async _0x97427f=>{const _0x3bc7ec=_0x585436;_0x9459b4['data_transfer'][_0x97427f['invoice']]=[],await Promise['all'](_0x97427f[_0x3bc7ec(0x107)][_0x3bc7ec(0x119)](async _0x3e0988=>{const _0x394ac4=_0x3bc7ec,_0x4e4516=await transfers[_0x394ac4(0x113)]([{'$unwind':_0x394ac4(0xf3)},{'$match':{'product.id_transaction_id':_0x3e0988[_0x394ac4(0x101)][_0x394ac4(0xe8)](),'product.To_invoice':_0x3e0988[_0x394ac4(0xf6)]}},{'$project':{'_id':_0x394ac4(0xfc),'product_name':'$product.product_name','product_code':_0x394ac4(0xec),'quantity_available':_0x394ac4(0xf9),'warehouse_name':_0x394ac4(0xdf),'warehouse_room':_0x394ac4(0xf8),'product_invoice':_0x394ac4(0x110),'invoice':'$invoice','id_transaction_id':_0x394ac4(0x11b)}}]);console[_0x394ac4(0xfe)](_0x4e4516),_0x4e4516[_0x394ac4(0x115)]>0x0&&_0x9459b4['data_transfer'][_0x97427f['invoice']]['push'](..._0x4e4516);}));})),_0x5b7dba['json']({'purchases_warehouse':_0x9459b4,'data_sales':_0x9459b4['data_sales'],'data_adjustment':_0x9459b4[_0x585436(0x106)],'data_transfer':_0x9459b4[_0x585436(0x108)]});}),module[a0_0x29c66c(0xe9)]=router;