const a0_0x1564c9=a0_0x17ab;function a0_0x17ab(_0x52554f,_0x233755){const _0x2d0fd8=a0_0x2d0f();return a0_0x17ab=function(_0x17ab53,_0x2f3094){_0x17ab53=_0x17ab53-0xac;let _0x107171=_0x2d0fd8[_0x17ab53];return _0x107171;},a0_0x17ab(_0x52554f,_0x233755);}(function(_0x3e3881,_0x155aec){const _0x16a337=a0_0x17ab,_0x51823a=_0x3e3881();while(!![]){try{const _0x2b6dcc=parseInt(_0x16a337(0xb3))/0x1+-parseInt(_0x16a337(0xe3))/0x2+parseInt(_0x16a337(0xe4))/0x3+parseInt(_0x16a337(0xdc))/0x4+parseInt(_0x16a337(0xdf))/0x5*(-parseInt(_0x16a337(0xb8))/0x6)+parseInt(_0x16a337(0xb7))/0x7+-parseInt(_0x16a337(0xd9))/0x8*(parseInt(_0x16a337(0xca))/0x9);if(_0x2b6dcc===_0x155aec)break;else _0x51823a['push'](_0x51823a['shift']());}catch(_0x10d14f){_0x51823a['push'](_0x51823a['shift']());}}}(a0_0x2d0f,0xa6f3c));function a0_0x2d0f(){const _0x29c12b=['95VgHNtH','INCF-52068316','message','render','1541306TTPwen','3351366ameHKr','$sale_product.product_name','$product.invoice','warehouse_data','$product_details.product_code','data_sales','$product.product_code','$product_details','all','$invoice','length','$sale_product._id','$name','$product_details._id','$product.product_name','express','$product.new_adjust_qty','/checking','$product.room_names','table\x20page','475508Tlfdma','map','push','Router','2811725gajHUH','115638cjzqVZ','$$invoice','/warehouse_monitor','success','14800005047429','_id','json','flash','$sale_product.invoice','$sale_product.quantity','$product._id','invoice','errors','$product','$product.to_room_name','$to_warehouse','$sale_product.room_name','$product_details.product_stock','92844EhSOeV','$warehouse_name','/negative','aggregate','$product.id_transaction_id','$sale_product.id_transaction_from','log','$sale_product.product_code','$product_details.product_name','data_adjustment','$product.to_quantity','exports','data_transfer','\x20documents\x20updated','valueOf','536ZELBgf','status','get','2070172eDYmtv','../../models/all_models','modifiedCount'];a0_0x2d0f=function(){return _0x29c12b;};return a0_0x2d0f();}const express=require(a0_0x1564c9(0xae)),app=express(),router=express[a0_0x1564c9(0xb6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x1564c9(0xdd));router[a0_0x1564c9(0xdb)](a0_0x1564c9(0xcc),async(_0x3dc4ec,_0x12e42d)=>{const _0x3aad2d=a0_0x1564c9;try{const _0x4f2dd9=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x12e42d[_0x3aad2d(0xbe)]({'status':_0x4f2dd9[_0x3aad2d(0xde)]+_0x3aad2d(0xd7)});}catch(_0x4ccaf8){console[_0x3aad2d(0xd0)](_0x3aad2d(0xb2),_0x4ccaf8),_0x12e42d[_0x3aad2d(0xda)](0xc8)[_0x3aad2d(0xbe)]({'message':_0x4ccaf8['message']});}}),router[a0_0x1564c9(0xdb)](a0_0x1564c9(0xb0),async(_0x39f736,_0x21f4f8)=>{const _0x2d6451=a0_0x1564c9;try{const _0x3e4d24=await warehouse[_0x2d6451(0xcd)]([{'$unwind':_0x2d6451(0xeb)},{'$match':{'product_details.invoice':_0x2d6451(0xe0),'product_details.primary_code':_0x2d6451(0xbc)}},{'$group':{'_id':{'name':'$name','room':'$room'},'products':{'$push':_0x2d6451(0xeb)}}}]);_0x21f4f8[_0x2d6451(0xbe)](_0x3e4d24);}catch(_0x1d16e0){console['log']('table\x20page',_0x1d16e0),_0x21f4f8[_0x2d6451(0xda)](0xc8)[_0x2d6451(0xbe)]({'message':_0x1d16e0[_0x2d6451(0xe1)]});}}),router[a0_0x1564c9(0xdb)](a0_0x1564c9(0xba),async(_0x2c5391,_0x654ad6)=>{const _0x25b7d5=a0_0x1564c9;_0x654ad6[_0x25b7d5(0xe2)]('monitor',{'success':_0x2c5391['flash'](_0x25b7d5(0xbb)),'errors':_0x2c5391[_0x25b7d5(0xbf)](_0x25b7d5(0xc4))});}),router[a0_0x1564c9(0xdb)]('/join',async(_0x3a2288,_0x44a0d6)=>{const _0xe4957b=a0_0x1564c9;var _0x2f9ad8=await purchases[_0xe4957b(0xcd)]([{'$lookup':{'from':'warehouses','let':{'invoice':_0xe4957b(0xed)},'pipeline':[{'$unwind':_0xe4957b(0xeb)},{'$match':{'$expr':{'$eq':[_0xe4957b(0xb9),'$product_details.invoice']}}},{'$project':{'_id':_0xe4957b(0xac),'product_name':_0xe4957b(0xd2),'product_code':_0xe4957b(0xe8),'quantity_available':_0xe4957b(0xc9),'warehouse_name':_0xe4957b(0xf0),'warehouse_room':'$room','invoice':'$product_details.invoice'}}],'as':_0xe4957b(0xe7)}}]);_0x2f9ad8[_0xe4957b(0xe9)]={},await Promise[_0xe4957b(0xec)](_0x2f9ad8[_0xe4957b(0xb4)](async _0x33fdc0=>{const _0x197078=_0xe4957b;_0x2f9ad8[_0x197078(0xe9)][_0x33fdc0[_0x197078(0xc3)]]=[],await Promise[_0x197078(0xec)](_0x33fdc0[_0x197078(0xe7)][_0x197078(0xb4)](async _0xb1b147=>{const _0x3c43b1=_0x197078,_0xd39735=await sales['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0xb1b147[_0x3c43b1(0xbd)][_0x3c43b1(0xd8)](),'sale_product.invoice':_0xb1b147['invoice']}},{'$project':{'_id':_0x3c43b1(0xef),'product_name':_0x3c43b1(0xe5),'product_code':_0x3c43b1(0xd1),'quantity_available':_0x3c43b1(0xc1),'warehouse_name':_0x3c43b1(0xcb),'warehouse_room':_0x3c43b1(0xc8),'product_invoice':_0x3c43b1(0xc0),'invoice':_0x3c43b1(0xed),'id_transaction_from':_0x3c43b1(0xcf)}}]);_0xd39735[_0x3c43b1(0xee)]>0x0&&_0x2f9ad8[_0x3c43b1(0xe9)][_0x33fdc0[_0x3c43b1(0xc3)]][_0x3c43b1(0xb5)](..._0xd39735);}));})),_0x2f9ad8[_0xe4957b(0xe9)]=_0x2f9ad8[_0xe4957b(0xe9)],_0x2f9ad8[_0xe4957b(0xd3)]={},await Promise[_0xe4957b(0xec)](_0x2f9ad8[_0xe4957b(0xb4)](async _0x266aad=>{const _0x58f18f=_0xe4957b;_0x2f9ad8[_0x58f18f(0xd3)][_0x266aad[_0x58f18f(0xc3)]]=[],await Promise['all'](_0x266aad[_0x58f18f(0xe7)][_0x58f18f(0xb4)](async _0x2c5a3c=>{const _0x258552=_0x58f18f,_0x175c67=await adjustment[_0x258552(0xcd)]([{'$unwind':_0x258552(0xc5)},{'$match':{'product.id_transaction_from':_0x2c5a3c[_0x258552(0xbd)][_0x258552(0xd8)](),'product.invoice':_0x2c5a3c[_0x258552(0xc3)]}},{'$project':{'_id':_0x258552(0xc2),'product_name':_0x258552(0xad),'product_code':_0x258552(0xea),'quantity_available':_0x258552(0xaf),'warehouse_name':_0x258552(0xcb),'warehouse_room':'$product.room_names','product_invoice':_0x258552(0xe6),'invoice':_0x258552(0xed),'id_transaction_from':'$product.id_transaction_from'}}]);_0x175c67[_0x258552(0xee)]>0x0&&_0x2f9ad8['data_adjustment'][_0x266aad[_0x258552(0xc3)]]['push'](..._0x175c67);}));})),_0x2f9ad8['data_transfer']={},await Promise[_0xe4957b(0xec)](_0x2f9ad8[_0xe4957b(0xb4)](async _0x45ac34=>{const _0x3e6dc7=_0xe4957b;_0x2f9ad8[_0x3e6dc7(0xd6)][_0x45ac34['invoice']]=[],await Promise[_0x3e6dc7(0xec)](_0x45ac34['warehouse_data'][_0x3e6dc7(0xb4)](async _0xca9ba3=>{const _0x3cf7f4=_0x3e6dc7,_0x6d57d5=await transfers[_0x3cf7f4(0xcd)]([{'$unwind':_0x3cf7f4(0xc5)},{'$match':{'product.id_transaction_id':_0xca9ba3['_id'][_0x3cf7f4(0xd8)](),'product.To_invoice':_0xca9ba3[_0x3cf7f4(0xc3)]}},{'$project':{'_id':_0x3cf7f4(0xc2),'product_name':'$product.product_name','product_code':_0x3cf7f4(0xea),'quantity_available':_0x3cf7f4(0xd4),'warehouse_name':_0x3cf7f4(0xc7),'warehouse_room':_0x3cf7f4(0xb1),'product_invoice':_0x3cf7f4(0xc6),'invoice':_0x3cf7f4(0xed),'id_transaction_id':_0x3cf7f4(0xce)}}]);console[_0x3cf7f4(0xd0)](_0x6d57d5),_0x6d57d5[_0x3cf7f4(0xee)]>0x0&&_0x2f9ad8[_0x3cf7f4(0xd6)][_0x45ac34[_0x3cf7f4(0xc3)]][_0x3cf7f4(0xb5)](..._0x6d57d5);}));})),_0x44a0d6[_0xe4957b(0xbe)]({'purchases_warehouse':_0x2f9ad8,'data_sales':_0x2f9ad8[_0xe4957b(0xe9)],'data_adjustment':_0x2f9ad8['data_adjustment'],'data_transfer':_0x2f9ad8[_0xe4957b(0xd6)]});}),module[a0_0x1564c9(0xd5)]=router;