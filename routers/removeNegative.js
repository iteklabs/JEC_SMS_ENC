function a0_0x1784(_0x2384d9,_0x5a07cd){const _0xc02da6=a0_0xc02d();return a0_0x1784=function(_0x178406,_0x1357b0){_0x178406=_0x178406-0x185;let _0x2b1490=_0xc02da6[_0x178406];return _0x2b1490;},a0_0x1784(_0x2384d9,_0x5a07cd);}function a0_0xc02d(){const _0x5dda22=['data_adjustment','$product_details.invoice','144lCdNUI','/checking','12IDnfZd','map','aggregate','$sale_product.product_name','511gzezRM','$product._id','$product.room_names','table\x20page','14800005047429','exports','1238410LhtZAh','data_sales','status','$product.invoice','$product.product_name','push','78352rVxnLo','$name','json','68007lOjrAn','$sale_product.room_name','warehouses','$sale_product._id','5989419LUrsGm','$product.to_quantity','7211720lsrXJW','$product.to_room_name','message','INCF-52068316','$sale_product','$sale_product.product_code','invoice','monitor','$product_details.product_code','get','$invoice','$product_details._id','success','warehouse_data','updateMany','flash','length','all','805121uZsaxP','$sale_product.id_transaction_from','$room','$product_details','log','$product_details.product_stock','$sale_product.quantity','\x20documents\x20updated','$product.id_transaction_from','$warehouse_name','$product','data_transfer','/warehouse_monitor','$to_warehouse','valueOf','$product.product_code','1491328cfeuKY'];a0_0xc02d=function(){return _0x5dda22;};return a0_0xc02d();}const a0_0x5517c3=a0_0x1784;(function(_0x13ad8f,_0xa80721){const _0x3edb63=a0_0x1784,_0x98aa78=_0x13ad8f();while(!![]){try{const _0x3c9f97=-parseInt(_0x3edb63(0x19d))/0x1+parseInt(_0x3edb63(0x1ad))/0x2+-parseInt(_0x3edb63(0x185))/0x3*(-parseInt(_0x3edb63(0x1b0))/0x4)+-parseInt(_0x3edb63(0x1bc))/0x5*(-parseInt(_0x3edb63(0x1b2))/0x6)+-parseInt(_0x3edb63(0x1b6))/0x7*(parseInt(_0x3edb63(0x1c2))/0x8)+-parseInt(_0x3edb63(0x189))/0x9+parseInt(_0x3edb63(0x18b))/0xa;if(_0x3c9f97===_0xa80721)break;else _0x98aa78['push'](_0x98aa78['shift']());}catch(_0x42ae33){_0x98aa78['push'](_0x98aa78['shift']());}}}(a0_0xc02d,0x90b46));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require('../../models/all_models');router[a0_0x5517c3(0x194)]('/negative',async(_0x3e021a,_0x5c67af)=>{const _0x452906=a0_0x5517c3;try{const _0x1372c0=await warehouse[_0x452906(0x199)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x5c67af[_0x452906(0x1c4)]({'status':_0x1372c0['modifiedCount']+_0x452906(0x1a4)});}catch(_0x401401){console['log'](_0x452906(0x1b9),_0x401401),_0x5c67af['status'](0xc8)[_0x452906(0x1c4)]({'message':_0x401401[_0x452906(0x18d)]});}}),router[a0_0x5517c3(0x194)](a0_0x5517c3(0x1b1),async(_0x45d342,_0x10de04)=>{const _0x484618=a0_0x5517c3;try{const _0x21d8bb=await warehouse[_0x484618(0x1b4)]([{'$unwind':_0x484618(0x1a0)},{'$match':{'product_details.invoice':_0x484618(0x18e),'product_details.primary_code':_0x484618(0x1ba)}},{'$group':{'_id':{'name':_0x484618(0x1c3),'room':_0x484618(0x19f)},'products':{'$push':_0x484618(0x1a0)}}}]);_0x10de04[_0x484618(0x1c4)](_0x21d8bb);}catch(_0x7d8d0f){console[_0x484618(0x1a1)](_0x484618(0x1b9),_0x7d8d0f),_0x10de04[_0x484618(0x1be)](0xc8)[_0x484618(0x1c4)]({'message':_0x7d8d0f[_0x484618(0x18d)]});}}),router[a0_0x5517c3(0x194)](a0_0x5517c3(0x1a9),async(_0x3e3f8c,_0xaa40fa)=>{const _0x13e4ac=a0_0x5517c3;_0xaa40fa['render'](_0x13e4ac(0x192),{'success':_0x3e3f8c[_0x13e4ac(0x19a)](_0x13e4ac(0x197)),'errors':_0x3e3f8c['flash']('errors')});}),router[a0_0x5517c3(0x194)]('/join',async(_0x2a5621,_0x3552d6)=>{const _0x2f852c=a0_0x5517c3;var _0x470903=await purchases[_0x2f852c(0x1b4)]([{'$lookup':{'from':_0x2f852c(0x187),'let':{'invoice':_0x2f852c(0x195)},'pipeline':[{'$unwind':_0x2f852c(0x1a0)},{'$match':{'$expr':{'$eq':['$$invoice',_0x2f852c(0x1af)]}}},{'$project':{'_id':_0x2f852c(0x196),'product_name':'$product_details.product_name','product_code':_0x2f852c(0x193),'quantity_available':_0x2f852c(0x1a2),'warehouse_name':_0x2f852c(0x1c3),'warehouse_room':_0x2f852c(0x19f),'invoice':_0x2f852c(0x1af)}}],'as':'warehouse_data'}}]);_0x470903[_0x2f852c(0x1bd)]={},await Promise['all'](_0x470903['map'](async _0x8ad0a7=>{const _0x49d9ee=_0x2f852c;_0x470903[_0x49d9ee(0x1bd)][_0x8ad0a7[_0x49d9ee(0x191)]]=[],await Promise[_0x49d9ee(0x19c)](_0x8ad0a7[_0x49d9ee(0x198)][_0x49d9ee(0x1b3)](async _0x18edf1=>{const _0xf0963e=_0x49d9ee,_0x2f7252=await sales['aggregate']([{'$unwind':_0xf0963e(0x18f)},{'$match':{'sale_product.id_transaction_from':_0x18edf1['_id'][_0xf0963e(0x1ab)](),'sale_product.invoice':_0x18edf1[_0xf0963e(0x191)]}},{'$project':{'_id':_0xf0963e(0x188),'product_name':_0xf0963e(0x1b5),'product_code':_0xf0963e(0x190),'quantity_available':_0xf0963e(0x1a3),'warehouse_name':_0xf0963e(0x1a6),'warehouse_room':_0xf0963e(0x186),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0xf0963e(0x19e)}}]);_0x2f7252[_0xf0963e(0x19b)]>0x0&&_0x470903[_0xf0963e(0x1bd)][_0x8ad0a7['invoice']][_0xf0963e(0x1c1)](..._0x2f7252);}));})),_0x470903[_0x2f852c(0x1bd)]=_0x470903['data_sales'],_0x470903[_0x2f852c(0x1ae)]={},await Promise[_0x2f852c(0x19c)](_0x470903[_0x2f852c(0x1b3)](async _0x353bd6=>{const _0x2aa4ab=_0x2f852c;_0x470903['data_adjustment'][_0x353bd6[_0x2aa4ab(0x191)]]=[],await Promise[_0x2aa4ab(0x19c)](_0x353bd6[_0x2aa4ab(0x198)][_0x2aa4ab(0x1b3)](async _0x78d3e=>{const _0x17fbf8=_0x2aa4ab,_0x4c05f8=await adjustment[_0x17fbf8(0x1b4)]([{'$unwind':_0x17fbf8(0x1a7)},{'$match':{'product.id_transaction_from':_0x78d3e['_id']['valueOf'](),'product.invoice':_0x78d3e[_0x17fbf8(0x191)]}},{'$project':{'_id':_0x17fbf8(0x1b7),'product_name':_0x17fbf8(0x1c0),'product_code':_0x17fbf8(0x1ac),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x17fbf8(0x1a6),'warehouse_room':_0x17fbf8(0x1b8),'product_invoice':_0x17fbf8(0x1bf),'invoice':'$invoice','id_transaction_from':_0x17fbf8(0x1a5)}}]);_0x4c05f8[_0x17fbf8(0x19b)]>0x0&&_0x470903[_0x17fbf8(0x1ae)][_0x353bd6['invoice']][_0x17fbf8(0x1c1)](..._0x4c05f8);}));})),_0x470903[_0x2f852c(0x1a8)]={},await Promise['all'](_0x470903[_0x2f852c(0x1b3)](async _0x33fe0e=>{const _0x27b04b=_0x2f852c;_0x470903['data_transfer'][_0x33fe0e[_0x27b04b(0x191)]]=[],await Promise[_0x27b04b(0x19c)](_0x33fe0e[_0x27b04b(0x198)]['map'](async _0x30b231=>{const _0x2009a5=_0x27b04b,_0xad38cb=await transfers[_0x2009a5(0x1b4)]([{'$unwind':_0x2009a5(0x1a7)},{'$match':{'product.id_transaction_id':_0x30b231['_id'][_0x2009a5(0x1ab)](),'product.To_invoice':_0x30b231[_0x2009a5(0x191)]}},{'$project':{'_id':_0x2009a5(0x1b7),'product_name':_0x2009a5(0x1c0),'product_code':_0x2009a5(0x1ac),'quantity_available':_0x2009a5(0x18a),'warehouse_name':_0x2009a5(0x1aa),'warehouse_room':_0x2009a5(0x1b8),'product_invoice':_0x2009a5(0x18c),'invoice':_0x2009a5(0x195),'id_transaction_id':'$product.id_transaction_id'}}]);console[_0x2009a5(0x1a1)](_0xad38cb),_0xad38cb['length']>0x0&&_0x470903[_0x2009a5(0x1a8)][_0x33fe0e[_0x2009a5(0x191)]]['push'](..._0xad38cb);}));})),_0x3552d6[_0x2f852c(0x1c4)]({'purchases_warehouse':_0x470903,'data_sales':_0x470903[_0x2f852c(0x1bd)],'data_adjustment':_0x470903['data_adjustment'],'data_transfer':_0x470903['data_transfer']});}),module[a0_0x5517c3(0x1bb)]=router;