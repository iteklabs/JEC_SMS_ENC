const a0_0x55dba1=a0_0x2905;function a0_0x33b6(){const _0x14452b=['_id','$sale_product.product_code','$warehouse_name','37704ldpiIh','json','$product._id','$product.invoice','data_sales','$sale_product._id','$sale_product.room_name','$sale_product','\x20documents\x20updated','map','flash','20DHKfqx','176889KaWyUr','render','../../models/all_models','status','success','warehouse_data','$product.id_transaction_id','1888452bJcgVf','INCF-52068316','$product.product_code','$invoice','875BMMVmg','aggregate','all','valueOf','push','$product.to_room_name','224050SlFJIQ','$product','data_transfer','exports','16StBiEt','$to_warehouse','$product.to_quantity','data_adjustment','19158780WUzYMb','$room','$sale_product.product_name','log','/checking','$sale_product.quantity','$product_details.invoice','message','14800005047429','express','$product_details.product_stock','$sale_product.invoice','Router','updateMany','/negative','$product_details.product_code','length','invoice','/warehouse_monitor','3492186INEjrK','255103KldMxC','$sale_product.id_transaction_from','$product_details','table\x20page','$product_details._id','get','$product.product_name'];a0_0x33b6=function(){return _0x14452b;};return a0_0x33b6();}(function(_0x9bacab,_0x4888fa){const _0xcb6595=a0_0x2905,_0xfe6c47=_0x9bacab();while(!![]){try{const _0x29c5ef=-parseInt(_0xcb6595(0xf5))/0x1+-parseInt(_0xcb6595(0xf4))/0x2+parseInt(_0xcb6595(0xc8))/0x3+parseInt(_0xcb6595(0xc7))/0x4*(-parseInt(_0xcb6595(0xd9))/0x5)+parseInt(_0xcb6595(0xff))/0x6*(parseInt(_0xcb6595(0xd3))/0x7)+-parseInt(_0xcb6595(0xdd))/0x8*(-parseInt(_0xcb6595(0xcf))/0x9)+parseInt(_0xcb6595(0xe1))/0xa;if(_0x29c5ef===_0x4888fa)break;else _0xfe6c47['push'](_0xfe6c47['shift']());}catch(_0x300bfa){_0xfe6c47['push'](_0xfe6c47['shift']());}}}(a0_0x33b6,0xe917f));const express=require(a0_0x55dba1(0xea)),app=express(),router=express[a0_0x55dba1(0xed)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x55dba1(0xca));function a0_0x2905(_0x385c12,_0xab6086){const _0x33b689=a0_0x33b6();return a0_0x2905=function(_0x290598,_0x2fc69c){_0x290598=_0x290598-0xc1;let _0x5a4434=_0x33b689[_0x290598];return _0x5a4434;},a0_0x2905(_0x385c12,_0xab6086);}router[a0_0x55dba1(0xfa)](a0_0x55dba1(0xef),async(_0x153247,_0x1878f5)=>{const _0x1ab022=a0_0x55dba1;try{const _0x46671f=await warehouse[_0x1ab022(0xee)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x1878f5[_0x1ab022(0x100)]({'status':_0x46671f['modifiedCount']+_0x1ab022(0xc4)});}catch(_0x520222){console[_0x1ab022(0xe4)](_0x1ab022(0xf8),_0x520222),_0x1878f5[_0x1ab022(0xcb)](0xc8)['json']({'message':_0x520222[_0x1ab022(0xe8)]});}}),router[a0_0x55dba1(0xfa)](a0_0x55dba1(0xe5),async(_0x4f1b18,_0x320c04)=>{const _0x23ad5c=a0_0x55dba1;try{const _0x1c3a32=await warehouse[_0x23ad5c(0xd4)]([{'$unwind':_0x23ad5c(0xf7)},{'$match':{'product_details.invoice':_0x23ad5c(0xd0),'product_details.primary_code':_0x23ad5c(0xe9)}},{'$group':{'_id':{'name':'$name','room':_0x23ad5c(0xe2)},'products':{'$push':_0x23ad5c(0xf7)}}}]);_0x320c04[_0x23ad5c(0x100)](_0x1c3a32);}catch(_0x2def1d){console[_0x23ad5c(0xe4)]('table\x20page',_0x2def1d),_0x320c04['status'](0xc8)[_0x23ad5c(0x100)]({'message':_0x2def1d[_0x23ad5c(0xe8)]});}}),router[a0_0x55dba1(0xfa)](a0_0x55dba1(0xf3),async(_0x5c91ab,_0x49430f)=>{const _0xdb0e3=a0_0x55dba1;_0x49430f[_0xdb0e3(0xc9)]('monitor',{'success':_0x5c91ab['flash'](_0xdb0e3(0xcc)),'errors':_0x5c91ab[_0xdb0e3(0xc6)]('errors')});}),router[a0_0x55dba1(0xfa)]('/join',async(_0x12246c,_0x278a3f)=>{const _0x419cf3=a0_0x55dba1;var _0x19e40e=await purchases['aggregate']([{'$lookup':{'from':'warehouses','let':{'invoice':_0x419cf3(0xd2)},'pipeline':[{'$unwind':_0x419cf3(0xf7)},{'$match':{'$expr':{'$eq':['$$invoice',_0x419cf3(0xe7)]}}},{'$project':{'_id':_0x419cf3(0xf9),'product_name':'$product_details.product_name','product_code':_0x419cf3(0xf0),'quantity_available':_0x419cf3(0xeb),'warehouse_name':'$name','warehouse_room':_0x419cf3(0xe2),'invoice':'$product_details.invoice'}}],'as':_0x419cf3(0xcd)}}]);_0x19e40e['data_sales']={},await Promise[_0x419cf3(0xd5)](_0x19e40e[_0x419cf3(0xc5)](async _0x19e9f9=>{const _0x115487=_0x419cf3;_0x19e40e[_0x115487(0x103)][_0x19e9f9[_0x115487(0xf2)]]=[],await Promise['all'](_0x19e9f9[_0x115487(0xcd)]['map'](async _0x49c21c=>{const _0xa33848=_0x115487,_0x3c5662=await sales['aggregate']([{'$unwind':_0xa33848(0xc3)},{'$match':{'sale_product.id_transaction_from':_0x49c21c[_0xa33848(0xfc)]['valueOf'](),'sale_product.invoice':_0x49c21c['invoice']}},{'$project':{'_id':_0xa33848(0xc1),'product_name':_0xa33848(0xe3),'product_code':_0xa33848(0xfd),'quantity_available':_0xa33848(0xe6),'warehouse_name':'$warehouse_name','warehouse_room':_0xa33848(0xc2),'product_invoice':_0xa33848(0xec),'invoice':'$invoice','id_transaction_from':_0xa33848(0xf6)}}]);_0x3c5662[_0xa33848(0xf1)]>0x0&&_0x19e40e['data_sales'][_0x19e9f9['invoice']]['push'](..._0x3c5662);}));})),_0x19e40e['data_sales']=_0x19e40e[_0x419cf3(0x103)],_0x19e40e['data_adjustment']={},await Promise['all'](_0x19e40e[_0x419cf3(0xc5)](async _0x1cd586=>{const _0x52c456=_0x419cf3;_0x19e40e[_0x52c456(0xe0)][_0x1cd586[_0x52c456(0xf2)]]=[],await Promise[_0x52c456(0xd5)](_0x1cd586[_0x52c456(0xcd)]['map'](async _0x41226f=>{const _0x10ae83=_0x52c456,_0x4a467c=await adjustment[_0x10ae83(0xd4)]([{'$unwind':_0x10ae83(0xda)},{'$match':{'product.id_transaction_from':_0x41226f[_0x10ae83(0xfc)]['valueOf'](),'product.invoice':_0x41226f[_0x10ae83(0xf2)]}},{'$project':{'_id':_0x10ae83(0x101),'product_name':_0x10ae83(0xfb),'product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':_0x10ae83(0xfe),'warehouse_room':'$product.room_names','product_invoice':_0x10ae83(0x102),'invoice':_0x10ae83(0xd2),'id_transaction_from':'$product.id_transaction_from'}}]);_0x4a467c[_0x10ae83(0xf1)]>0x0&&_0x19e40e[_0x10ae83(0xe0)][_0x1cd586[_0x10ae83(0xf2)]][_0x10ae83(0xd7)](..._0x4a467c);}));})),_0x19e40e[_0x419cf3(0xdb)]={},await Promise[_0x419cf3(0xd5)](_0x19e40e['map'](async _0x49c6ee=>{const _0x3a502e=_0x419cf3;_0x19e40e[_0x3a502e(0xdb)][_0x49c6ee[_0x3a502e(0xf2)]]=[],await Promise[_0x3a502e(0xd5)](_0x49c6ee['warehouse_data']['map'](async _0x56d5e9=>{const _0x4e1617=_0x3a502e,_0x39751b=await transfers[_0x4e1617(0xd4)]([{'$unwind':_0x4e1617(0xda)},{'$match':{'product.id_transaction_id':_0x56d5e9['_id'][_0x4e1617(0xd6)](),'product.To_invoice':_0x56d5e9[_0x4e1617(0xf2)]}},{'$project':{'_id':_0x4e1617(0x101),'product_name':_0x4e1617(0xfb),'product_code':_0x4e1617(0xd1),'quantity_available':_0x4e1617(0xdf),'warehouse_name':_0x4e1617(0xde),'warehouse_room':'$product.room_names','product_invoice':_0x4e1617(0xd8),'invoice':_0x4e1617(0xd2),'id_transaction_id':_0x4e1617(0xce)}}]);console[_0x4e1617(0xe4)](_0x39751b),_0x39751b['length']>0x0&&_0x19e40e[_0x4e1617(0xdb)][_0x49c6ee['invoice']][_0x4e1617(0xd7)](..._0x39751b);}));})),_0x278a3f[_0x419cf3(0x100)]({'purchases_warehouse':_0x19e40e,'data_sales':_0x19e40e[_0x419cf3(0x103)],'data_adjustment':_0x19e40e['data_adjustment'],'data_transfer':_0x19e40e[_0x419cf3(0xdb)]});}),module[a0_0x55dba1(0xdc)]=router;