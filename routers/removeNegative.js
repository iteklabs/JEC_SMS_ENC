const a0_0x409334=a0_0x1005;(function(_0x2d8431,_0x50dcd2){const _0x170acf=a0_0x1005,_0x2d0804=_0x2d8431();while(!![]){try{const _0x19d5c0=-parseInt(_0x170acf(0x20b))/0x1*(parseInt(_0x170acf(0x21e))/0x2)+-parseInt(_0x170acf(0x223))/0x3+-parseInt(_0x170acf(0x219))/0x4*(parseInt(_0x170acf(0x21a))/0x5)+-parseInt(_0x170acf(0x1fa))/0x6+-parseInt(_0x170acf(0x207))/0x7*(-parseInt(_0x170acf(0x205))/0x8)+parseInt(_0x170acf(0x210))/0x9*(-parseInt(_0x170acf(0x22d))/0xa)+-parseInt(_0x170acf(0x1fb))/0xb*(-parseInt(_0x170acf(0x225))/0xc);if(_0x19d5c0===_0x50dcd2)break;else _0x2d0804['push'](_0x2d0804['shift']());}catch(_0x4d7d43){_0x2d0804['push'](_0x2d0804['shift']());}}}(a0_0x4d48,0x76010));function a0_0x4d48(){const _0x3d247c=['5714842jWKMvZ','$product_details.product_code','$sale_product.product_name','modifiedCount','1hIERXz','$product.id_transaction_from','$sale_product.room_name','_id','Router','2817225ZvcXGG','$invoice','monitor','message','$room','$sale_product.product_code','$name','$product.room_names','$product.to_room_name','1465832UpNrSG','5FCGBMt','$warehouse_name','data_transfer','valueOf','1400152ngrfrh','/warehouse_monitor','$product','/checking','data_sales','340764SpdKAr','warehouse_data','5748780kvbwWa','/join','status','$product_details','$product_details._id','$product_details.product_name','all','$product.to_quantity','10eMdfnh','$sale_product.invoice','log','errors','$product._id','$product.id_transaction_id','express','../../models/all_models','length','push','get','json','flash','$product.product_name','updateMany','aggregate','data_adjustment','1662660SgJcCR','33ytkVJf','render','$$invoice','$product_details.invoice','invoice','success','map','$product_details.product_stock','14800005047429','$sale_product._id','8vpqBGp','$product.product_code'];a0_0x4d48=function(){return _0x3d247c;};return a0_0x4d48();}function a0_0x1005(_0x507f20,_0x2c9082){const _0x4d48dd=a0_0x4d48();return a0_0x1005=function(_0x10051e,_0x1b3fd0){_0x10051e=_0x10051e-0x1ea;let _0x312fb8=_0x4d48dd[_0x10051e];return _0x312fb8;},a0_0x1005(_0x507f20,_0x2c9082);}const express=require(a0_0x409334(0x1ef)),app=express(),router=express[a0_0x409334(0x20f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x409334(0x1f0));router[a0_0x409334(0x1f3)]('/negative',async(_0x142ae3,_0x59599c)=>{const _0x3956bb=a0_0x409334;try{const _0x5f2ccd=await warehouse[_0x3956bb(0x1f7)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x59599c[_0x3956bb(0x1f4)]({'status':_0x5f2ccd[_0x3956bb(0x20a)]+'\x20documents\x20updated'});}catch(_0x4a9969){console['log']('table\x20page',_0x4a9969),_0x59599c[_0x3956bb(0x227)](0xc8)[_0x3956bb(0x1f4)]({'message':_0x4a9969[_0x3956bb(0x213)]});}}),router[a0_0x409334(0x1f3)](a0_0x409334(0x221),async(_0x4e5948,_0x4146e9)=>{const _0x1b2652=a0_0x409334;try{const _0x13321e=await warehouse[_0x1b2652(0x1f8)]([{'$unwind':_0x1b2652(0x228)},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':_0x1b2652(0x203)}},{'$group':{'_id':{'name':_0x1b2652(0x216),'room':_0x1b2652(0x214)},'products':{'$push':_0x1b2652(0x228)}}}]);_0x4146e9[_0x1b2652(0x1f4)](_0x13321e);}catch(_0x1f7ae0){console[_0x1b2652(0x1eb)]('table\x20page',_0x1f7ae0),_0x4146e9[_0x1b2652(0x227)](0xc8)[_0x1b2652(0x1f4)]({'message':_0x1f7ae0[_0x1b2652(0x213)]});}}),router[a0_0x409334(0x1f3)](a0_0x409334(0x21f),async(_0x544be0,_0x44aa54)=>{const _0x2a0f87=a0_0x409334;_0x44aa54[_0x2a0f87(0x1fc)](_0x2a0f87(0x212),{'success':_0x544be0[_0x2a0f87(0x1f5)](_0x2a0f87(0x200)),'errors':_0x544be0['flash'](_0x2a0f87(0x1ec))});}),router[a0_0x409334(0x1f3)](a0_0x409334(0x226),async(_0x564625,_0x464b17)=>{const _0x1a8690=a0_0x409334;var _0x28ee5c=await purchases['aggregate']([{'$lookup':{'from':'warehouses','let':{'invoice':_0x1a8690(0x211)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x1a8690(0x1fd),_0x1a8690(0x1fe)]}}},{'$project':{'_id':_0x1a8690(0x229),'product_name':_0x1a8690(0x22a),'product_code':_0x1a8690(0x208),'quantity_available':_0x1a8690(0x202),'warehouse_name':_0x1a8690(0x216),'warehouse_room':_0x1a8690(0x214),'invoice':'$product_details.invoice'}}],'as':'warehouse_data'}}]);_0x28ee5c[_0x1a8690(0x222)]={},await Promise['all'](_0x28ee5c['map'](async _0xd0529=>{const _0x9a0d29=_0x1a8690;_0x28ee5c[_0x9a0d29(0x222)][_0xd0529[_0x9a0d29(0x1ff)]]=[],await Promise[_0x9a0d29(0x22b)](_0xd0529[_0x9a0d29(0x224)][_0x9a0d29(0x201)](async _0x38d941=>{const _0xd9054b=_0x9a0d29,_0x3160ab=await sales[_0xd9054b(0x1f8)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x38d941['_id'][_0xd9054b(0x21d)](),'sale_product.invoice':_0x38d941[_0xd9054b(0x1ff)]}},{'$project':{'_id':_0xd9054b(0x204),'product_name':_0xd9054b(0x209),'product_code':_0xd9054b(0x215),'quantity_available':'$sale_product.quantity','warehouse_name':_0xd9054b(0x21b),'warehouse_room':_0xd9054b(0x20d),'product_invoice':_0xd9054b(0x1ea),'invoice':_0xd9054b(0x211),'id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x3160ab[_0xd9054b(0x1f1)]>0x0&&_0x28ee5c[_0xd9054b(0x222)][_0xd0529[_0xd9054b(0x1ff)]]['push'](..._0x3160ab);}));})),_0x28ee5c[_0x1a8690(0x222)]=_0x28ee5c[_0x1a8690(0x222)],_0x28ee5c['data_adjustment']={},await Promise['all'](_0x28ee5c['map'](async _0x5d4959=>{const _0x230738=_0x1a8690;_0x28ee5c[_0x230738(0x1f9)][_0x5d4959['invoice']]=[],await Promise[_0x230738(0x22b)](_0x5d4959[_0x230738(0x224)]['map'](async _0x1b47ec=>{const _0x20733a=_0x230738,_0x3a4964=await adjustment[_0x20733a(0x1f8)]([{'$unwind':_0x20733a(0x220)},{'$match':{'product.id_transaction_from':_0x1b47ec[_0x20733a(0x20e)][_0x20733a(0x21d)](),'product.invoice':_0x1b47ec[_0x20733a(0x1ff)]}},{'$project':{'_id':_0x20733a(0x1ed),'product_name':_0x20733a(0x1f6),'product_code':_0x20733a(0x206),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x20733a(0x21b),'warehouse_room':_0x20733a(0x217),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':_0x20733a(0x20c)}}]);_0x3a4964['length']>0x0&&_0x28ee5c[_0x20733a(0x1f9)][_0x5d4959[_0x20733a(0x1ff)]][_0x20733a(0x1f2)](..._0x3a4964);}));})),_0x28ee5c['data_transfer']={},await Promise[_0x1a8690(0x22b)](_0x28ee5c[_0x1a8690(0x201)](async _0x2b2ebf=>{const _0x15f724=_0x1a8690;_0x28ee5c[_0x15f724(0x21c)][_0x2b2ebf[_0x15f724(0x1ff)]]=[],await Promise['all'](_0x2b2ebf[_0x15f724(0x224)][_0x15f724(0x201)](async _0x1c0d0b=>{const _0xf86a36=_0x15f724,_0x488b2d=await transfers[_0xf86a36(0x1f8)]([{'$unwind':_0xf86a36(0x220)},{'$match':{'product.id_transaction_id':_0x1c0d0b[_0xf86a36(0x20e)][_0xf86a36(0x21d)](),'product.To_invoice':_0x1c0d0b[_0xf86a36(0x1ff)]}},{'$project':{'_id':_0xf86a36(0x1ed),'product_name':_0xf86a36(0x1f6),'product_code':_0xf86a36(0x206),'quantity_available':_0xf86a36(0x22c),'warehouse_name':'$to_warehouse','warehouse_room':_0xf86a36(0x217),'product_invoice':_0xf86a36(0x218),'invoice':_0xf86a36(0x211),'id_transaction_id':_0xf86a36(0x1ee)}}]);console[_0xf86a36(0x1eb)](_0x488b2d),_0x488b2d[_0xf86a36(0x1f1)]>0x0&&_0x28ee5c[_0xf86a36(0x21c)][_0x2b2ebf[_0xf86a36(0x1ff)]]['push'](..._0x488b2d);}));})),_0x464b17[_0x1a8690(0x1f4)]({'purchases_warehouse':_0x28ee5c,'data_sales':_0x28ee5c[_0x1a8690(0x222)],'data_adjustment':_0x28ee5c[_0x1a8690(0x1f9)],'data_transfer':_0x28ee5c[_0x1a8690(0x21c)]});}),module['exports']=router;