const a0_0x10d1cb=a0_0x4659;function a0_0x4659(_0x5ecea3,_0x2b0d81){const _0xee3e64=a0_0xee3e();return a0_0x4659=function(_0x465938,_0x328f55){_0x465938=_0x465938-0x76;let _0x3c90bc=_0xee3e64[_0x465938];return _0x3c90bc;},a0_0x4659(_0x5ecea3,_0x2b0d81);}(function(_0x2fc799,_0x3fc415){const _0x270072=a0_0x4659,_0x46a8d9=_0x2fc799();while(!![]){try{const _0x20dbb0=-parseInt(_0x270072(0x9e))/0x1+-parseInt(_0x270072(0xad))/0x2+parseInt(_0x270072(0x81))/0x3*(-parseInt(_0x270072(0x90))/0x4)+parseInt(_0x270072(0x7d))/0x5*(-parseInt(_0x270072(0xac))/0x6)+-parseInt(_0x270072(0xaa))/0x7*(-parseInt(_0x270072(0xa6))/0x8)+parseInt(_0x270072(0x7c))/0x9+parseInt(_0x270072(0x7b))/0xa*(parseInt(_0x270072(0xa0))/0xb);if(_0x20dbb0===_0x3fc415)break;else _0x46a8d9['push'](_0x46a8d9['shift']());}catch(_0x5494e9){_0x46a8d9['push'](_0x46a8d9['shift']());}}}(a0_0xee3e,0x89a33));function a0_0xee3e(){const _0x1109bc=['modifiedCount','aggregate','$warehouse_name','$product_details','data_adjustment','updateMany','$name','json','$sale_product.quantity','$product._id','/join','invoice','$product.invoice','$invoice','$product.product_name','get','$product_details.product_name','success','1593660lNrCfd','9051597GKoysP','35CoCUHL','$product','14800005047429','exports','9yGNPnm','\x20documents\x20updated','valueOf','_id','$sale_product','flash','/negative','warehouses','table\x20page','express','data_sales','$product.room_names','errors','all','message','1113524SwVjme','map','$to_warehouse','/warehouse_monitor','warehouse_data','$product.to_room_name','$sale_product.room_name','$sale_product.product_code','status','$$invoice','$product_details.invoice','$product.product_code','/checking','$room','283228LOBRzP','$sale_product._id','121gnGybU','length','INCF-52068316','$sale_product.id_transaction_from','log','$product.new_adjust_qty','72mFUiAZ','push','data_transfer','monitor','446306onYGEm','$product_details.product_stock','843882oEAkQp','1331836oBYFWT','$product.to_quantity'];a0_0xee3e=function(){return _0x1109bc;};return a0_0xee3e();}const express=require(a0_0x10d1cb(0x8a)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require('../../models/all_models');router[a0_0x10d1cb(0x78)](a0_0x10d1cb(0x87),async(_0x181a65,_0x44b54a)=>{const _0x37ee5d=a0_0x10d1cb;try{const _0x2127e9=await warehouse[_0x37ee5d(0xb4)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x44b54a['json']({'status':_0x2127e9[_0x37ee5d(0xaf)]+_0x37ee5d(0x82)});}catch(_0x2ee947){console[_0x37ee5d(0xa4)](_0x37ee5d(0x89),_0x2ee947),_0x44b54a[_0x37ee5d(0x98)](0xc8)[_0x37ee5d(0xb6)]({'message':_0x2ee947[_0x37ee5d(0x8f)]});}}),router[a0_0x10d1cb(0x78)](a0_0x10d1cb(0x9c),async(_0x188aa5,_0xd4dcfd)=>{const _0x4c3284=a0_0x10d1cb;try{const _0xb7277e=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0x4c3284(0xa2),'product_details.primary_code':_0x4c3284(0x7f)}},{'$group':{'_id':{'name':_0x4c3284(0xb5),'room':_0x4c3284(0x9d)},'products':{'$push':'$product_details'}}}]);_0xd4dcfd[_0x4c3284(0xb6)](_0xb7277e);}catch(_0x2ca8fd){console['log'](_0x4c3284(0x89),_0x2ca8fd),_0xd4dcfd[_0x4c3284(0x98)](0xc8)['json']({'message':_0x2ca8fd[_0x4c3284(0x8f)]});}}),router[a0_0x10d1cb(0x78)](a0_0x10d1cb(0x93),async(_0x1a6002,_0x18fc13)=>{const _0x5207ce=a0_0x10d1cb;_0x18fc13['render'](_0x5207ce(0xa9),{'success':_0x1a6002[_0x5207ce(0x86)](_0x5207ce(0x7a)),'errors':_0x1a6002[_0x5207ce(0x86)](_0x5207ce(0x8d))});}),router[a0_0x10d1cb(0x78)](a0_0x10d1cb(0xb9),async(_0x67e7ee,_0x4f092c)=>{const _0x491557=a0_0x10d1cb;var _0x50f76d=await purchases[_0x491557(0xb0)]([{'$lookup':{'from':_0x491557(0x88),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x491557(0xb2)},{'$match':{'$expr':{'$eq':[_0x491557(0x99),_0x491557(0x9a)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x491557(0x79),'product_code':'$product_details.product_code','quantity_available':_0x491557(0xab),'warehouse_name':_0x491557(0xb5),'warehouse_room':_0x491557(0x9d),'invoice':'$product_details.invoice'}}],'as':_0x491557(0x94)}}]);_0x50f76d[_0x491557(0x8b)]={},await Promise[_0x491557(0x8e)](_0x50f76d[_0x491557(0x91)](async _0x546e62=>{const _0x19c2fd=_0x491557;_0x50f76d[_0x19c2fd(0x8b)][_0x546e62[_0x19c2fd(0xba)]]=[],await Promise[_0x19c2fd(0x8e)](_0x546e62[_0x19c2fd(0x94)][_0x19c2fd(0x91)](async _0x3dd440=>{const _0x4bbf06=_0x19c2fd,_0x281da0=await sales['aggregate']([{'$unwind':_0x4bbf06(0x85)},{'$match':{'sale_product.id_transaction_from':_0x3dd440[_0x4bbf06(0x84)][_0x4bbf06(0x83)](),'sale_product.invoice':_0x3dd440[_0x4bbf06(0xba)]}},{'$project':{'_id':_0x4bbf06(0x9f),'product_name':'$sale_product.product_name','product_code':_0x4bbf06(0x97),'quantity_available':_0x4bbf06(0xb7),'warehouse_name':_0x4bbf06(0xb1),'warehouse_room':_0x4bbf06(0x96),'product_invoice':'$sale_product.invoice','invoice':_0x4bbf06(0x76),'id_transaction_from':_0x4bbf06(0xa3)}}]);_0x281da0[_0x4bbf06(0xa1)]>0x0&&_0x50f76d[_0x4bbf06(0x8b)][_0x546e62[_0x4bbf06(0xba)]][_0x4bbf06(0xa7)](..._0x281da0);}));})),_0x50f76d[_0x491557(0x8b)]=_0x50f76d[_0x491557(0x8b)],_0x50f76d['data_adjustment']={},await Promise[_0x491557(0x8e)](_0x50f76d['map'](async _0x15c507=>{const _0x3694df=_0x491557;_0x50f76d[_0x3694df(0xb3)][_0x15c507[_0x3694df(0xba)]]=[],await Promise[_0x3694df(0x8e)](_0x15c507[_0x3694df(0x94)][_0x3694df(0x91)](async _0x3de58f=>{const _0x4767e9=_0x3694df,_0x26ac73=await adjustment[_0x4767e9(0xb0)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x3de58f[_0x4767e9(0x84)][_0x4767e9(0x83)](),'product.invoice':_0x3de58f['invoice']}},{'$project':{'_id':_0x4767e9(0xb8),'product_name':'$product.product_name','product_code':_0x4767e9(0x9b),'quantity_available':_0x4767e9(0xa5),'warehouse_name':_0x4767e9(0xb1),'warehouse_room':_0x4767e9(0x8c),'product_invoice':_0x4767e9(0xbb),'invoice':_0x4767e9(0x76),'id_transaction_from':'$product.id_transaction_from'}}]);_0x26ac73['length']>0x0&&_0x50f76d[_0x4767e9(0xb3)][_0x15c507[_0x4767e9(0xba)]][_0x4767e9(0xa7)](..._0x26ac73);}));})),_0x50f76d[_0x491557(0xa8)]={},await Promise[_0x491557(0x8e)](_0x50f76d[_0x491557(0x91)](async _0x52d3d9=>{const _0x21397d=_0x491557;_0x50f76d[_0x21397d(0xa8)][_0x52d3d9[_0x21397d(0xba)]]=[],await Promise[_0x21397d(0x8e)](_0x52d3d9[_0x21397d(0x94)][_0x21397d(0x91)](async _0x4ea5ae=>{const _0x4a0ce2=_0x21397d,_0x5bbd75=await transfers['aggregate']([{'$unwind':_0x4a0ce2(0x7e)},{'$match':{'product.id_transaction_id':_0x4ea5ae[_0x4a0ce2(0x84)][_0x4a0ce2(0x83)](),'product.To_invoice':_0x4ea5ae[_0x4a0ce2(0xba)]}},{'$project':{'_id':_0x4a0ce2(0xb8),'product_name':_0x4a0ce2(0x77),'product_code':_0x4a0ce2(0x9b),'quantity_available':_0x4a0ce2(0xae),'warehouse_name':_0x4a0ce2(0x92),'warehouse_room':_0x4a0ce2(0x8c),'product_invoice':_0x4a0ce2(0x95),'invoice':'$invoice','id_transaction_id':'$product.id_transaction_id'}}]);console[_0x4a0ce2(0xa4)](_0x5bbd75),_0x5bbd75[_0x4a0ce2(0xa1)]>0x0&&_0x50f76d['data_transfer'][_0x52d3d9['invoice']][_0x4a0ce2(0xa7)](..._0x5bbd75);}));})),_0x4f092c['json']({'purchases_warehouse':_0x50f76d,'data_sales':_0x50f76d['data_sales'],'data_adjustment':_0x50f76d['data_adjustment'],'data_transfer':_0x50f76d['data_transfer']});}),module[a0_0x10d1cb(0x80)]=router;