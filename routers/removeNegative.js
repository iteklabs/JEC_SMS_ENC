const a0_0x3a367b=a0_0x355f;(function(_0x52e02d,_0x185869){const _0x3975f7=a0_0x355f,_0x24e720=_0x52e02d();while(!![]){try{const _0x2cab0b=parseInt(_0x3975f7(0x182))/0x1*(parseInt(_0x3975f7(0x167))/0x2)+-parseInt(_0x3975f7(0x15a))/0x3+-parseInt(_0x3975f7(0x157))/0x4+-parseInt(_0x3975f7(0x16b))/0x5*(parseInt(_0x3975f7(0x18d))/0x6)+parseInt(_0x3975f7(0x177))/0x7*(-parseInt(_0x3975f7(0x18b))/0x8)+parseInt(_0x3975f7(0x159))/0x9*(-parseInt(_0x3975f7(0x175))/0xa)+parseInt(_0x3975f7(0x15f))/0xb*(parseInt(_0x3975f7(0x152))/0xc);if(_0x2cab0b===_0x185869)break;else _0x24e720['push'](_0x24e720['shift']());}catch(_0x36ff6c){_0x24e720['push'](_0x24e720['shift']());}}}(a0_0x3202,0x2a80d));const express=require(a0_0x3a367b(0x15e)),app=express(),router=express[a0_0x3a367b(0x156)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x3a367b(0x163));function a0_0x355f(_0x54b692,_0x1d677a){const _0x320210=a0_0x3202();return a0_0x355f=function(_0x355f9b,_0x43028f){_0x355f9b=_0x355f9b-0x14e;let _0x20f3d5=_0x320210[_0x355f9b];return _0x20f3d5;},a0_0x355f(_0x54b692,_0x1d677a);}router['get']('/negative',async(_0x4a0262,_0x1008fe)=>{const _0x183553=a0_0x3a367b;try{const _0x5eadb6=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x1008fe['json']({'status':_0x5eadb6['modifiedCount']+_0x183553(0x190)});}catch(_0x42fb74){console[_0x183553(0x14e)](_0x183553(0x16d),_0x42fb74),_0x1008fe[_0x183553(0x158)](0xc8)[_0x183553(0x187)]({'message':_0x42fb74[_0x183553(0x180)]});}}),router[a0_0x3a367b(0x17b)](a0_0x3a367b(0x191),async(_0x1ed919,_0x5bf972)=>{const _0x1f2e81=a0_0x3a367b;try{const _0x3c6bbb=await warehouse['aggregate']([{'$unwind':_0x1f2e81(0x176)},{'$match':{'product_details.invoice':_0x1f2e81(0x194),'product_details.primary_code':_0x1f2e81(0x181)}},{'$group':{'_id':{'name':_0x1f2e81(0x16f),'room':_0x1f2e81(0x16a)},'products':{'$push':_0x1f2e81(0x176)}}}]);_0x5bf972['json'](_0x3c6bbb);}catch(_0x53d00f){console[_0x1f2e81(0x14e)](_0x1f2e81(0x16d),_0x53d00f),_0x5bf972[_0x1f2e81(0x158)](0xc8)[_0x1f2e81(0x187)]({'message':_0x53d00f[_0x1f2e81(0x180)]});}}),router[a0_0x3a367b(0x17b)](a0_0x3a367b(0x151),async(_0x24bd7f,_0xfe013f)=>{const _0x4d906b=a0_0x3a367b;_0xfe013f[_0x4d906b(0x171)](_0x4d906b(0x184),{'success':_0x24bd7f[_0x4d906b(0x192)](_0x4d906b(0x168)),'errors':_0x24bd7f[_0x4d906b(0x192)]('errors')});}),router['get'](a0_0x3a367b(0x183),async(_0x1a48d7,_0x3ccee2)=>{const _0x59982f=a0_0x3a367b;var _0x4bf242=await purchases[_0x59982f(0x186)]([{'$lookup':{'from':_0x59982f(0x164),'let':{'invoice':_0x59982f(0x189)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x59982f(0x173),_0x59982f(0x17c)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x59982f(0x161),'product_code':_0x59982f(0x170),'quantity_available':_0x59982f(0x18a),'warehouse_name':_0x59982f(0x16f),'warehouse_room':_0x59982f(0x16a),'invoice':'$product_details.invoice'}}],'as':_0x59982f(0x15c)}}]);_0x4bf242[_0x59982f(0x18c)]={},await Promise[_0x59982f(0x17f)](_0x4bf242[_0x59982f(0x15d)](async _0x5b3b46=>{const _0x29bba2=_0x59982f;_0x4bf242['data_sales'][_0x5b3b46[_0x29bba2(0x178)]]=[],await Promise['all'](_0x5b3b46[_0x29bba2(0x15c)][_0x29bba2(0x15d)](async _0x402435=>{const _0x349e4c=_0x29bba2,_0x20ceb7=await sales[_0x349e4c(0x186)]([{'$unwind':_0x349e4c(0x18f)},{'$match':{'sale_product.id_transaction_from':_0x402435[_0x349e4c(0x160)]['valueOf'](),'sale_product.invoice':_0x402435[_0x349e4c(0x178)]}},{'$project':{'_id':_0x349e4c(0x14f),'product_name':_0x349e4c(0x15b),'product_code':'$sale_product.product_code','quantity_available':_0x349e4c(0x172),'warehouse_name':_0x349e4c(0x154),'warehouse_room':'$sale_product.room_name','product_invoice':_0x349e4c(0x16e),'invoice':_0x349e4c(0x189),'id_transaction_from':_0x349e4c(0x165)}}]);_0x20ceb7[_0x349e4c(0x174)]>0x0&&_0x4bf242['data_sales'][_0x5b3b46['invoice']]['push'](..._0x20ceb7);}));})),_0x4bf242['data_sales']=_0x4bf242[_0x59982f(0x18c)],_0x4bf242[_0x59982f(0x17e)]={},await Promise[_0x59982f(0x17f)](_0x4bf242[_0x59982f(0x15d)](async _0x1c8db8=>{const _0x22f11f=_0x59982f;_0x4bf242[_0x22f11f(0x17e)][_0x1c8db8[_0x22f11f(0x178)]]=[],await Promise['all'](_0x1c8db8[_0x22f11f(0x15c)][_0x22f11f(0x15d)](async _0x32289e=>{const _0x3d499d=_0x22f11f,_0x366609=await adjustment['aggregate']([{'$unwind':_0x3d499d(0x17d)},{'$match':{'product.id_transaction_from':_0x32289e['_id'][_0x3d499d(0x188)](),'product.invoice':_0x32289e[_0x3d499d(0x178)]}},{'$project':{'_id':'$product._id','product_name':_0x3d499d(0x153),'product_code':_0x3d499d(0x162),'quantity_available':_0x3d499d(0x169),'warehouse_name':_0x3d499d(0x154),'warehouse_room':_0x3d499d(0x150),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':_0x3d499d(0x179)}}]);_0x366609['length']>0x0&&_0x4bf242['data_adjustment'][_0x1c8db8[_0x3d499d(0x178)]][_0x3d499d(0x193)](..._0x366609);}));})),_0x4bf242[_0x59982f(0x155)]={},await Promise[_0x59982f(0x17f)](_0x4bf242['map'](async _0x36faef=>{const _0x2ac12c=_0x59982f;_0x4bf242[_0x2ac12c(0x155)][_0x36faef[_0x2ac12c(0x178)]]=[],await Promise[_0x2ac12c(0x17f)](_0x36faef[_0x2ac12c(0x15c)][_0x2ac12c(0x15d)](async _0x2248e7=>{const _0x3f3bfe=_0x2ac12c,_0x19f5cd=await transfers[_0x3f3bfe(0x186)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x2248e7[_0x3f3bfe(0x160)]['valueOf'](),'product.To_invoice':_0x2248e7[_0x3f3bfe(0x178)]}},{'$project':{'_id':_0x3f3bfe(0x17a),'product_name':_0x3f3bfe(0x153),'product_code':_0x3f3bfe(0x162),'quantity_available':_0x3f3bfe(0x166),'warehouse_name':_0x3f3bfe(0x18e),'warehouse_room':_0x3f3bfe(0x150),'product_invoice':_0x3f3bfe(0x185),'invoice':_0x3f3bfe(0x189),'id_transaction_id':'$product.id_transaction_id'}}]);console[_0x3f3bfe(0x14e)](_0x19f5cd),_0x19f5cd[_0x3f3bfe(0x174)]>0x0&&_0x4bf242[_0x3f3bfe(0x155)][_0x36faef['invoice']][_0x3f3bfe(0x193)](..._0x19f5cd);}));})),_0x3ccee2['json']({'purchases_warehouse':_0x4bf242,'data_sales':_0x4bf242[_0x59982f(0x18c)],'data_adjustment':_0x4bf242[_0x59982f(0x17e)],'data_transfer':_0x4bf242[_0x59982f(0x155)]});}),module[a0_0x3a367b(0x16c)]=router;function a0_0x3202(){const _0x16534c=['909570ZtWKVl','$to_warehouse','$sale_product','\x20documents\x20updated','/checking','flash','push','INCF-52068316','log','$sale_product._id','$product.room_names','/warehouse_monitor','2820QWQqwQ','$product.product_name','$warehouse_name','data_transfer','Router','1084188cvFcCP','status','9pYZjnw','771012OxJKDo','$sale_product.product_name','warehouse_data','map','express','46541bgjkzR','_id','$product_details.product_name','$product.product_code','../../models/all_models','warehouses','$sale_product.id_transaction_from','$product.to_quantity','26206fsSaYR','success','$product.new_adjust_qty','$room','10XFtDow','exports','table\x20page','$sale_product.invoice','$name','$product_details.product_code','render','$sale_product.quantity','$$invoice','length','103820jltenP','$product_details','17059PiBXpL','invoice','$product.id_transaction_from','$product._id','get','$product_details.invoice','$product','data_adjustment','all','message','14800005047429','26TXUcuz','/join','monitor','$product.to_room_name','aggregate','json','valueOf','$invoice','$product_details.product_stock','1048QFAUpZ','data_sales'];a0_0x3202=function(){return _0x16534c;};return a0_0x3202();}