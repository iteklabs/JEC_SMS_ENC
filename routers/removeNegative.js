const a0_0x5ef452=a0_0xdbc0;function a0_0x2cbe(){const _0x4a4d43=['data_adjustment','35885taTFiZ','$product_details.product_name','$product.id_transaction_id','get','success','_id','INCF-52068316','$sale_product._id','render','data_sales','exports','7425344fJSoZU','$sale_product.invoice','updateMany','../../models/all_models','data_transfer','$warehouse_name','2404493OWgNIw','572574MNwMQf','log','monitor','$product.product_code','modifiedCount','table\x20page','$sale_product.quantity','push','all','586516WmAgZV','warehouse_data','/warehouse_monitor','9VjkTHo','valueOf','$name','$product_details._id','express','$product.invoice','/negative','$sale_product.product_name','15ClqkKZ','errors','$product_details.invoice','$room','$product.to_quantity','aggregate','$product._id','247158nNjzXK','$product.room_names','status','$product.id_transaction_from','json','$product_details','$product_details.product_code','$invoice','$product','$sale_product','message','$to_warehouse','warehouses','flash','length','447750SbrvIL','Router','invoice','map'];a0_0x2cbe=function(){return _0x4a4d43;};return a0_0x2cbe();}function a0_0xdbc0(_0x578c86,_0x4b2144){const _0x2cbea9=a0_0x2cbe();return a0_0xdbc0=function(_0xdbc026,_0x44601a){_0xdbc026=_0xdbc026-0x1e8;let _0x14923f=_0x2cbea9[_0xdbc026];return _0x14923f;},a0_0xdbc0(_0x578c86,_0x4b2144);}(function(_0x5c6804,_0x307932){const _0x357894=a0_0xdbc0,_0x417838=_0x5c6804();while(!![]){try{const _0x117852=parseInt(_0x357894(0x210))/0x1+parseInt(_0x357894(0x20b))/0x2+parseInt(_0x357894(0x1fc))/0x3+parseInt(_0x357894(0x1ea))/0x4+-parseInt(_0x357894(0x1f5))/0x5*(-parseInt(_0x357894(0x222))/0x6)+parseInt(_0x357894(0x221))/0x7+parseInt(_0x357894(0x21b))/0x8*(-parseInt(_0x357894(0x1ed))/0x9);if(_0x117852===_0x307932)break;else _0x417838['push'](_0x417838['shift']());}catch(_0x58d603){_0x417838['push'](_0x417838['shift']());}}}(a0_0x2cbe,0x2e7b9));const express=require(a0_0x5ef452(0x1f1)),app=express(),router=express[a0_0x5ef452(0x20c)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x5ef452(0x21e));router[a0_0x5ef452(0x213)](a0_0x5ef452(0x1f3),async(_0x2017f6,_0x1127d6)=>{const _0x21dbd8=a0_0x5ef452;try{const _0xa0972e=await warehouse[_0x21dbd8(0x21d)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x1127d6['json']({'status':_0xa0972e[_0x21dbd8(0x226)]+'\x20documents\x20updated'});}catch(_0xde03db){console[_0x21dbd8(0x223)](_0x21dbd8(0x227),_0xde03db),_0x1127d6[_0x21dbd8(0x1fe)](0xc8)[_0x21dbd8(0x200)]({'message':_0xde03db['message']});}}),router[a0_0x5ef452(0x213)]('/checking',async(_0x4b568b,_0x4ee10b)=>{const _0x388feb=a0_0x5ef452;try{const _0x5f59ca=await warehouse['aggregate']([{'$unwind':_0x388feb(0x201)},{'$match':{'product_details.invoice':_0x388feb(0x216),'product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0x388feb(0x1ef),'room':_0x388feb(0x1f8)},'products':{'$push':_0x388feb(0x201)}}}]);_0x4ee10b[_0x388feb(0x200)](_0x5f59ca);}catch(_0x45f9c1){console['log']('table\x20page',_0x45f9c1),_0x4ee10b[_0x388feb(0x1fe)](0xc8)[_0x388feb(0x200)]({'message':_0x45f9c1[_0x388feb(0x206)]});}}),router['get'](a0_0x5ef452(0x1ec),async(_0x8b150b,_0x140ffb)=>{const _0x583c7c=a0_0x5ef452;_0x140ffb[_0x583c7c(0x218)](_0x583c7c(0x224),{'success':_0x8b150b[_0x583c7c(0x209)](_0x583c7c(0x214)),'errors':_0x8b150b[_0x583c7c(0x209)](_0x583c7c(0x1f6))});}),router[a0_0x5ef452(0x213)]('/join',async(_0x2c3251,_0x695ab8)=>{const _0xc4c89f=a0_0x5ef452;var _0x245040=await purchases[_0xc4c89f(0x1fa)]([{'$lookup':{'from':_0xc4c89f(0x208),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':['$$invoice',_0xc4c89f(0x1f7)]}}},{'$project':{'_id':_0xc4c89f(0x1f0),'product_name':_0xc4c89f(0x211),'product_code':_0xc4c89f(0x202),'quantity_available':'$product_details.product_stock','warehouse_name':_0xc4c89f(0x1ef),'warehouse_room':'$room','invoice':_0xc4c89f(0x1f7)}}],'as':_0xc4c89f(0x1eb)}}]);_0x245040[_0xc4c89f(0x219)]={},await Promise['all'](_0x245040['map'](async _0x25b47b=>{const _0x5b6339=_0xc4c89f;_0x245040[_0x5b6339(0x219)][_0x25b47b[_0x5b6339(0x20d)]]=[],await Promise['all'](_0x25b47b['warehouse_data'][_0x5b6339(0x20e)](async _0x5309a1=>{const _0x1422c0=_0x5b6339,_0x5acd15=await sales['aggregate']([{'$unwind':_0x1422c0(0x205)},{'$match':{'sale_product.id_transaction_from':_0x5309a1[_0x1422c0(0x215)][_0x1422c0(0x1ee)](),'sale_product.invoice':_0x5309a1[_0x1422c0(0x20d)]}},{'$project':{'_id':_0x1422c0(0x217),'product_name':_0x1422c0(0x1f4),'product_code':'$sale_product.product_code','quantity_available':_0x1422c0(0x228),'warehouse_name':_0x1422c0(0x220),'warehouse_room':'$sale_product.room_name','product_invoice':_0x1422c0(0x21c),'invoice':_0x1422c0(0x203),'id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x5acd15[_0x1422c0(0x20a)]>0x0&&_0x245040[_0x1422c0(0x219)][_0x25b47b[_0x1422c0(0x20d)]][_0x1422c0(0x1e8)](..._0x5acd15);}));})),_0x245040[_0xc4c89f(0x219)]=_0x245040[_0xc4c89f(0x219)],_0x245040[_0xc4c89f(0x20f)]={},await Promise[_0xc4c89f(0x1e9)](_0x245040[_0xc4c89f(0x20e)](async _0x5ceaf9=>{const _0x2cec98=_0xc4c89f;_0x245040[_0x2cec98(0x20f)][_0x5ceaf9['invoice']]=[],await Promise[_0x2cec98(0x1e9)](_0x5ceaf9['warehouse_data'][_0x2cec98(0x20e)](async _0x13cced=>{const _0x146091=_0x2cec98,_0x2f8f1b=await adjustment['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x13cced[_0x146091(0x215)][_0x146091(0x1ee)](),'product.invoice':_0x13cced[_0x146091(0x20d)]}},{'$project':{'_id':_0x146091(0x1fb),'product_name':'$product.product_name','product_code':_0x146091(0x225),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x146091(0x220),'warehouse_room':_0x146091(0x1fd),'product_invoice':_0x146091(0x1f2),'invoice':_0x146091(0x203),'id_transaction_from':_0x146091(0x1ff)}}]);_0x2f8f1b[_0x146091(0x20a)]>0x0&&_0x245040['data_adjustment'][_0x5ceaf9[_0x146091(0x20d)]][_0x146091(0x1e8)](..._0x2f8f1b);}));})),_0x245040['data_transfer']={},await Promise[_0xc4c89f(0x1e9)](_0x245040[_0xc4c89f(0x20e)](async _0x17bff6=>{const _0x2be048=_0xc4c89f;_0x245040[_0x2be048(0x21f)][_0x17bff6[_0x2be048(0x20d)]]=[],await Promise[_0x2be048(0x1e9)](_0x17bff6[_0x2be048(0x1eb)]['map'](async _0x4162b9=>{const _0x5b203b=_0x2be048,_0x10bc66=await transfers[_0x5b203b(0x1fa)]([{'$unwind':_0x5b203b(0x204)},{'$match':{'product.id_transaction_id':_0x4162b9[_0x5b203b(0x215)][_0x5b203b(0x1ee)](),'product.To_invoice':_0x4162b9[_0x5b203b(0x20d)]}},{'$project':{'_id':_0x5b203b(0x1fb),'product_name':'$product.product_name','product_code':_0x5b203b(0x225),'quantity_available':_0x5b203b(0x1f9),'warehouse_name':_0x5b203b(0x207),'warehouse_room':_0x5b203b(0x1fd),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_id':_0x5b203b(0x212)}}]);console[_0x5b203b(0x223)](_0x10bc66),_0x10bc66[_0x5b203b(0x20a)]>0x0&&_0x245040[_0x5b203b(0x21f)][_0x17bff6['invoice']][_0x5b203b(0x1e8)](..._0x10bc66);}));})),_0x695ab8[_0xc4c89f(0x200)]({'purchases_warehouse':_0x245040,'data_sales':_0x245040[_0xc4c89f(0x219)],'data_adjustment':_0x245040['data_adjustment'],'data_transfer':_0x245040['data_transfer']});}),module[a0_0x5ef452(0x21a)]=router;