const a0_0x17e5ca=a0_0x5ad5;function a0_0x5ad5(_0x160497,_0x53d33b){const _0x34ed89=a0_0x34ed();return a0_0x5ad5=function(_0x5ad586,_0x57391f){_0x5ad586=_0x5ad586-0x128;let _0x1ed9a0=_0x34ed89[_0x5ad586];return _0x1ed9a0;},a0_0x5ad5(_0x160497,_0x53d33b);}(function(_0x2de219,_0x11e7a6){const _0x2528b2=a0_0x5ad5,_0x11c794=_0x2de219();while(!![]){try{const _0x3105ea=-parseInt(_0x2528b2(0x129))/0x1+-parseInt(_0x2528b2(0x12c))/0x2*(parseInt(_0x2528b2(0x157))/0x3)+-parseInt(_0x2528b2(0x15d))/0x4*(-parseInt(_0x2528b2(0x14e))/0x5)+-parseInt(_0x2528b2(0x130))/0x6*(-parseInt(_0x2528b2(0x166))/0x7)+-parseInt(_0x2528b2(0x134))/0x8+-parseInt(_0x2528b2(0x160))/0x9+parseInt(_0x2528b2(0x139))/0xa*(parseInt(_0x2528b2(0x12a))/0xb);if(_0x3105ea===_0x11e7a6)break;else _0x11c794['push'](_0x11c794['shift']());}catch(_0x1add6a){_0x11c794['push'](_0x11c794['shift']());}}}(a0_0x34ed,0xd4ed9));function a0_0x34ed(){const _0x352e00=['warehouses','/warehouse_monitor','$product.invoice','39126kmpIlj','$product.product_code','length','push','5824704bhvToN','flash','Router','$product_details.invoice','$name','9770WomnqN','status','warehouse_data','$sale_product.product_code','_id','get','data_transfer','json','$product_details.product_stock','$product.to_quantity','modifiedCount','message','data_sales','$product.to_room_name','$product._id','$sale_product.room_name','$product.room_names','map','invoice','$product_details.product_name','INCF-52068316','116695ClbPpk','valueOf','all','data_adjustment','$product.new_adjust_qty','monitor','$product_details','exports','$product','65601llKxdP','aggregate','/checking','table\x20page','$product.product_name','$warehouse_name','28yQCBgr','$product_details.product_code','render','4727790hCDoyV','$product.id_transaction_from','$product.id_transaction_id','\x20documents\x20updated','/join','errors','1596FnPDfi','$invoice','express','$room','log','$sale_product.product_name','626880sqSgIu','18073wMJUpF','$sale_product.id_transaction_from','46alMEXR'];a0_0x34ed=function(){return _0x352e00;};return a0_0x34ed();}const express=require(a0_0x17e5ca(0x168)),app=express(),router=express[a0_0x17e5ca(0x136)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require('../../models/all_models');router['get']('/negative',async(_0xfe837e,_0xe19fcf)=>{const _0x31c496=a0_0x17e5ca;try{const _0x5fa46a=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0xe19fcf[_0x31c496(0x140)]({'status':_0x5fa46a[_0x31c496(0x143)]+_0x31c496(0x163)});}catch(_0x25e3e5){console[_0x31c496(0x16a)](_0x31c496(0x15a),_0x25e3e5),_0xe19fcf[_0x31c496(0x13a)](0xc8)[_0x31c496(0x140)]({'message':_0x25e3e5[_0x31c496(0x144)]});}}),router['get'](a0_0x17e5ca(0x159),async(_0x2097b2,_0xf114da)=>{const _0x4c6b98=a0_0x17e5ca;try{const _0x5aae85=await warehouse[_0x4c6b98(0x158)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0x4c6b98(0x14d),'product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0x4c6b98(0x138),'room':'$room'},'products':{'$push':'$product_details'}}}]);_0xf114da[_0x4c6b98(0x140)](_0x5aae85);}catch(_0x231bcd){console[_0x4c6b98(0x16a)](_0x4c6b98(0x15a),_0x231bcd),_0xf114da[_0x4c6b98(0x13a)](0xc8)[_0x4c6b98(0x140)]({'message':_0x231bcd['message']});}}),router[a0_0x17e5ca(0x13e)](a0_0x17e5ca(0x12e),async(_0x432f53,_0x30a75a)=>{const _0x2f1284=a0_0x17e5ca;_0x30a75a[_0x2f1284(0x15f)](_0x2f1284(0x153),{'success':_0x432f53[_0x2f1284(0x135)]('success'),'errors':_0x432f53['flash'](_0x2f1284(0x165))});}),router['get'](a0_0x17e5ca(0x164),async(_0x142a28,_0x2d3528)=>{const _0x1d8ee1=a0_0x17e5ca;var _0x276e92=await purchases[_0x1d8ee1(0x158)]([{'$lookup':{'from':_0x1d8ee1(0x12d),'let':{'invoice':_0x1d8ee1(0x167)},'pipeline':[{'$unwind':_0x1d8ee1(0x154)},{'$match':{'$expr':{'$eq':['$$invoice',_0x1d8ee1(0x137)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x1d8ee1(0x14c),'product_code':_0x1d8ee1(0x15e),'quantity_available':_0x1d8ee1(0x141),'warehouse_name':_0x1d8ee1(0x138),'warehouse_room':_0x1d8ee1(0x169),'invoice':_0x1d8ee1(0x137)}}],'as':_0x1d8ee1(0x13b)}}]);_0x276e92[_0x1d8ee1(0x145)]={},await Promise[_0x1d8ee1(0x150)](_0x276e92[_0x1d8ee1(0x14a)](async _0x33cc89=>{const _0x5328bc=_0x1d8ee1;_0x276e92[_0x5328bc(0x145)][_0x33cc89[_0x5328bc(0x14b)]]=[],await Promise[_0x5328bc(0x150)](_0x33cc89[_0x5328bc(0x13b)][_0x5328bc(0x14a)](async _0x54c97b=>{const _0x3315f1=_0x5328bc,_0x62e792=await sales[_0x3315f1(0x158)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x54c97b[_0x3315f1(0x13d)][_0x3315f1(0x14f)](),'sale_product.invoice':_0x54c97b[_0x3315f1(0x14b)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x3315f1(0x128),'product_code':_0x3315f1(0x13c),'quantity_available':'$sale_product.quantity','warehouse_name':_0x3315f1(0x15c),'warehouse_room':_0x3315f1(0x148),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x3315f1(0x12b)}}]);_0x62e792[_0x3315f1(0x132)]>0x0&&_0x276e92['data_sales'][_0x33cc89[_0x3315f1(0x14b)]][_0x3315f1(0x133)](..._0x62e792);}));})),_0x276e92[_0x1d8ee1(0x145)]=_0x276e92['data_sales'],_0x276e92[_0x1d8ee1(0x151)]={},await Promise[_0x1d8ee1(0x150)](_0x276e92[_0x1d8ee1(0x14a)](async _0x4fdea8=>{const _0x430a1e=_0x1d8ee1;_0x276e92[_0x430a1e(0x151)][_0x4fdea8[_0x430a1e(0x14b)]]=[],await Promise[_0x430a1e(0x150)](_0x4fdea8[_0x430a1e(0x13b)]['map'](async _0x5f1c96=>{const _0x2184e0=_0x430a1e,_0x41d87a=await adjustment[_0x2184e0(0x158)]([{'$unwind':_0x2184e0(0x156)},{'$match':{'product.id_transaction_from':_0x5f1c96['_id'][_0x2184e0(0x14f)](),'product.invoice':_0x5f1c96[_0x2184e0(0x14b)]}},{'$project':{'_id':_0x2184e0(0x147),'product_name':_0x2184e0(0x15b),'product_code':'$product.product_code','quantity_available':_0x2184e0(0x152),'warehouse_name':'$warehouse_name','warehouse_room':_0x2184e0(0x149),'product_invoice':_0x2184e0(0x12f),'invoice':_0x2184e0(0x167),'id_transaction_from':_0x2184e0(0x161)}}]);_0x41d87a[_0x2184e0(0x132)]>0x0&&_0x276e92[_0x2184e0(0x151)][_0x4fdea8[_0x2184e0(0x14b)]][_0x2184e0(0x133)](..._0x41d87a);}));})),_0x276e92['data_transfer']={},await Promise[_0x1d8ee1(0x150)](_0x276e92[_0x1d8ee1(0x14a)](async _0x47b09a=>{const _0x1164cd=_0x1d8ee1;_0x276e92[_0x1164cd(0x13f)][_0x47b09a[_0x1164cd(0x14b)]]=[],await Promise[_0x1164cd(0x150)](_0x47b09a['warehouse_data'][_0x1164cd(0x14a)](async _0x4e9c9a=>{const _0x4ce1b0=_0x1164cd,_0xa60ee0=await transfers[_0x4ce1b0(0x158)]([{'$unwind':_0x4ce1b0(0x156)},{'$match':{'product.id_transaction_id':_0x4e9c9a[_0x4ce1b0(0x13d)][_0x4ce1b0(0x14f)](),'product.To_invoice':_0x4e9c9a[_0x4ce1b0(0x14b)]}},{'$project':{'_id':_0x4ce1b0(0x147),'product_name':'$product.product_name','product_code':_0x4ce1b0(0x131),'quantity_available':_0x4ce1b0(0x142),'warehouse_name':'$to_warehouse','warehouse_room':_0x4ce1b0(0x149),'product_invoice':_0x4ce1b0(0x146),'invoice':_0x4ce1b0(0x167),'id_transaction_id':_0x4ce1b0(0x162)}}]);console['log'](_0xa60ee0),_0xa60ee0[_0x4ce1b0(0x132)]>0x0&&_0x276e92['data_transfer'][_0x47b09a['invoice']][_0x4ce1b0(0x133)](..._0xa60ee0);}));})),_0x2d3528[_0x1d8ee1(0x140)]({'purchases_warehouse':_0x276e92,'data_sales':_0x276e92['data_sales'],'data_adjustment':_0x276e92[_0x1d8ee1(0x151)],'data_transfer':_0x276e92[_0x1d8ee1(0x13f)]});}),module[a0_0x17e5ca(0x155)]=router;