const a0_0x3866e5=a0_0x219f;(function(_0x1d6645,_0x1da8dc){const _0x2e20bb=a0_0x219f,_0x1ea268=_0x1d6645();while(!![]){try{const _0x476dc5=parseInt(_0x2e20bb(0x1f7))/0x1+-parseInt(_0x2e20bb(0x1ee))/0x2*(parseInt(_0x2e20bb(0x1e6))/0x3)+parseInt(_0x2e20bb(0x206))/0x4+-parseInt(_0x2e20bb(0x1f2))/0x5+-parseInt(_0x2e20bb(0x1d1))/0x6+-parseInt(_0x2e20bb(0x1e2))/0x7+parseInt(_0x2e20bb(0x1f5))/0x8*(parseInt(_0x2e20bb(0x1e9))/0x9);if(_0x476dc5===_0x1da8dc)break;else _0x1ea268['push'](_0x1ea268['shift']());}catch(_0x2eb6bd){_0x1ea268['push'](_0x1ea268['shift']());}}}(a0_0x2107,0x31238));const express=require(a0_0x3866e5(0x1d5)),app=express(),router=express[a0_0x3866e5(0x1ff)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x3866e5(0x1cd));function a0_0x219f(_0x39d711,_0x2e86de){const _0x2107bc=a0_0x2107();return a0_0x219f=function(_0x219f35,_0x3eacf3){_0x219f35=_0x219f35-0x1c6;let _0x4601b9=_0x2107bc[_0x219f35];return _0x4601b9;},a0_0x219f(_0x39d711,_0x2e86de);}router[a0_0x3866e5(0x1fe)](a0_0x3866e5(0x1d0),async(_0x258a21,_0x11c63e)=>{const _0x2b924f=a0_0x3866e5;try{const _0xece2c3=await warehouse[_0x2b924f(0x1dd)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x11c63e['json']({'status':_0xece2c3[_0x2b924f(0x1dc)]+_0x2b924f(0x1da)});}catch(_0x3aa5f2){console[_0x2b924f(0x1f6)](_0x2b924f(0x1e5),_0x3aa5f2),_0x11c63e[_0x2b924f(0x1cf)](0xc8)[_0x2b924f(0x1db)]({'message':_0x3aa5f2[_0x2b924f(0x1ed)]});}}),router['get'](a0_0x3866e5(0x1d6),async(_0x143f80,_0x15b3bc)=>{const _0x9e6385=a0_0x3866e5;try{const _0x59eb4b=await warehouse[_0x9e6385(0x1d2)]([{'$unwind':_0x9e6385(0x1ce)},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':_0x9e6385(0x1ea)}},{'$group':{'_id':{'name':_0x9e6385(0x1cb),'room':_0x9e6385(0x1f4)},'products':{'$push':_0x9e6385(0x1ce)}}}]);_0x15b3bc[_0x9e6385(0x1db)](_0x59eb4b);}catch(_0x52a1d7){console[_0x9e6385(0x1f6)](_0x9e6385(0x1e5),_0x52a1d7),_0x15b3bc[_0x9e6385(0x1cf)](0xc8)[_0x9e6385(0x1db)]({'message':_0x52a1d7['message']});}}),router[a0_0x3866e5(0x1fe)](a0_0x3866e5(0x204),async(_0x24f0fd,_0x63f310)=>{const _0x43359b=a0_0x3866e5;_0x63f310[_0x43359b(0x1fd)](_0x43359b(0x1d7),{'success':_0x24f0fd[_0x43359b(0x1d8)](_0x43359b(0x1c6)),'errors':_0x24f0fd[_0x43359b(0x1d8)]('errors')});}),router[a0_0x3866e5(0x1fe)](a0_0x3866e5(0x1e1),async(_0x5caace,_0x525090)=>{const _0x44e696=a0_0x3866e5;var _0x51f6a1=await purchases['aggregate']([{'$lookup':{'from':_0x44e696(0x1e3),'let':{'invoice':_0x44e696(0x208)},'pipeline':[{'$unwind':_0x44e696(0x1ce)},{'$match':{'$expr':{'$eq':[_0x44e696(0x1fb),_0x44e696(0x1ca)]}}},{'$project':{'_id':_0x44e696(0x203),'product_name':_0x44e696(0x20b),'product_code':_0x44e696(0x1c8),'quantity_available':_0x44e696(0x200),'warehouse_name':_0x44e696(0x1cb),'warehouse_room':_0x44e696(0x1f4),'invoice':_0x44e696(0x1ca)}}],'as':_0x44e696(0x201)}}]);_0x51f6a1[_0x44e696(0x1ef)]={},await Promise['all'](_0x51f6a1['map'](async _0x5ccbd0=>{const _0xea7130=_0x44e696;_0x51f6a1['data_sales'][_0x5ccbd0['invoice']]=[],await Promise['all'](_0x5ccbd0[_0xea7130(0x201)][_0xea7130(0x1f9)](async _0xe05822=>{const _0x383028=_0xea7130,_0x3b7fa6=await sales[_0x383028(0x1d2)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0xe05822[_0x383028(0x1f1)][_0x383028(0x1e0)](),'sale_product.invoice':_0xe05822[_0x383028(0x1eb)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x383028(0x20a),'product_code':_0x383028(0x1fc),'quantity_available':_0x383028(0x1e7),'warehouse_name':_0x383028(0x1f3),'warehouse_room':_0x383028(0x20c),'product_invoice':'$sale_product.invoice','invoice':_0x383028(0x208),'id_transaction_from':_0x383028(0x1df)}}]);_0x3b7fa6[_0x383028(0x1ec)]>0x0&&_0x51f6a1[_0x383028(0x1ef)][_0x5ccbd0[_0x383028(0x1eb)]]['push'](..._0x3b7fa6);}));})),_0x51f6a1[_0x44e696(0x1ef)]=_0x51f6a1[_0x44e696(0x1ef)],_0x51f6a1[_0x44e696(0x1e4)]={},await Promise[_0x44e696(0x205)](_0x51f6a1[_0x44e696(0x1f9)](async _0x3b86f5=>{const _0x444a11=_0x44e696;_0x51f6a1[_0x444a11(0x1e4)][_0x3b86f5[_0x444a11(0x1eb)]]=[],await Promise[_0x444a11(0x205)](_0x3b86f5[_0x444a11(0x201)][_0x444a11(0x1f9)](async _0x2a9ad1=>{const _0x3bffb6=_0x444a11,_0x2c9a87=await adjustment['aggregate']([{'$unwind':_0x3bffb6(0x1d3)},{'$match':{'product.id_transaction_from':_0x2a9ad1[_0x3bffb6(0x1f1)][_0x3bffb6(0x1e0)](),'product.invoice':_0x2a9ad1[_0x3bffb6(0x1eb)]}},{'$project':{'_id':_0x3bffb6(0x1c9),'product_name':_0x3bffb6(0x1f8),'product_code':_0x3bffb6(0x207),'quantity_available':_0x3bffb6(0x1cc),'warehouse_name':_0x3bffb6(0x1f3),'warehouse_room':'$product.room_names','product_invoice':_0x3bffb6(0x1d4),'invoice':_0x3bffb6(0x208),'id_transaction_from':_0x3bffb6(0x1f0)}}]);_0x2c9a87[_0x3bffb6(0x1ec)]>0x0&&_0x51f6a1['data_adjustment'][_0x3b86f5[_0x3bffb6(0x1eb)]][_0x3bffb6(0x202)](..._0x2c9a87);}));})),_0x51f6a1['data_transfer']={},await Promise['all'](_0x51f6a1[_0x44e696(0x1f9)](async _0x23ec20=>{const _0x3d7238=_0x44e696;_0x51f6a1['data_transfer'][_0x23ec20[_0x3d7238(0x1eb)]]=[],await Promise[_0x3d7238(0x205)](_0x23ec20['warehouse_data']['map'](async _0xe0d10b=>{const _0x5209cf=_0x3d7238,_0x5b0605=await transfers['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0xe0d10b[_0x5209cf(0x1f1)][_0x5209cf(0x1e0)](),'product.To_invoice':_0xe0d10b[_0x5209cf(0x1eb)]}},{'$project':{'_id':_0x5209cf(0x1c9),'product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':_0x5209cf(0x1c7),'warehouse_name':_0x5209cf(0x1de),'warehouse_room':_0x5209cf(0x1fa),'product_invoice':_0x5209cf(0x1e8),'invoice':_0x5209cf(0x208),'id_transaction_id':_0x5209cf(0x1d9)}}]);console[_0x5209cf(0x1f6)](_0x5b0605),_0x5b0605['length']>0x0&&_0x51f6a1[_0x5209cf(0x209)][_0x23ec20[_0x5209cf(0x1eb)]]['push'](..._0x5b0605);}));})),_0x525090[_0x44e696(0x1db)]({'purchases_warehouse':_0x51f6a1,'data_sales':_0x51f6a1[_0x44e696(0x1ef)],'data_adjustment':_0x51f6a1['data_adjustment'],'data_transfer':_0x51f6a1[_0x44e696(0x209)]});}),module['exports']=router;function a0_0x2107(){const _0x1b8e83=['$product.id_transaction_id','\x20documents\x20updated','json','modifiedCount','updateMany','$to_warehouse','$sale_product.id_transaction_from','valueOf','/join','416605LWfSFR','warehouses','data_adjustment','table\x20page','51915aSGTVq','$sale_product.quantity','$product.to_room_name','9nMnJTw','14800005047429','invoice','length','message','12zVhusg','data_sales','$product.id_transaction_from','_id','1048895EnfSVz','$warehouse_name','$room','2301056qiXEuc','log','350219wAnYTp','$product.product_name','map','$product.room_names','$$invoice','$sale_product.product_code','render','get','Router','$product_details.product_stock','warehouse_data','push','$product_details._id','/warehouse_monitor','all','1210956mjSQWj','$product.product_code','$invoice','data_transfer','$sale_product.product_name','$product_details.product_name','$sale_product.room_name','success','$product.to_quantity','$product_details.product_code','$product._id','$product_details.invoice','$name','$product.new_adjust_qty','../../models/all_models','$product_details','status','/negative','2197164izyUiK','aggregate','$product','$product.invoice','express','/checking','monitor','flash'];a0_0x2107=function(){return _0x1b8e83;};return a0_0x2107();}