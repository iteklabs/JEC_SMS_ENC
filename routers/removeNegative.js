const a0_0x10e1f1=a0_0x53cc;function a0_0x53cc(_0x40dae6,_0x528fe4){const _0x3ba237=a0_0x3ba2();return a0_0x53cc=function(_0x53cc7c,_0x13a459){_0x53cc7c=_0x53cc7c-0xb4;let _0x5d1d63=_0x3ba237[_0x53cc7c];return _0x5d1d63;},a0_0x53cc(_0x40dae6,_0x528fe4);}function a0_0x3ba2(){const _0x36a0f3=['data_sales','$room','warehouse_data','$sale_product.room_name','177902xgvgAX','8635ZskVVw','success','aggregate','INCF-52068316','$product_details.product_stock','33QMpAza','json','$sale_product.quantity','4063950oLSjLS','/negative','data_adjustment','1847984hDZctn','all','$sale_product','exports','get','log','../../models/all_models','14800005047429','Router','invoice','modifiedCount','$to_warehouse','message','status','$product.id_transaction_id','warehouses','2335836TwqZzU','$product.to_quantity','table\x20page','$product_details.product_name','7Guvhed','$product.invoice','$product_details._id','$warehouse_name','$product.new_adjust_qty','$product_details','$$invoice','$sale_product.id_transaction_from','$product.to_room_name','$product.room_names','$product.product_name','164ddGjGt','data_transfer','map','/warehouse_monitor','$invoice','monitor','/join','\x20documents\x20updated','valueOf','$product_details.invoice','1304792CWeBjS','length','$product','push','_id','/checking','express','$name','$sale_product.invoice','$sale_product.product_name','20GSOxvZ','flash','$product._id','19528707uyJfjJ','$product_details.product_code'];a0_0x3ba2=function(){return _0x36a0f3;};return a0_0x3ba2();}(function(_0x30d3ab,_0x112e4a){const _0x5e8253=a0_0x53cc,_0x2b428c=_0x30d3ab();while(!![]){try{const _0xb10d30=parseInt(_0x5e8253(0xb7))/0x1+parseInt(_0x5e8253(0xca))/0x2*(parseInt(_0x5e8253(0xd0))/0x3)+-parseInt(_0x5e8253(0xf5))/0x4*(-parseInt(_0x5e8253(0xcb))/0x5)+-parseInt(_0x5e8253(0xe6))/0x6+parseInt(_0x5e8253(0xea))/0x7*(-parseInt(_0x5e8253(0xd6))/0x8)+-parseInt(_0x5e8253(0xd3))/0x9*(-parseInt(_0x5e8253(0xc1))/0xa)+-parseInt(_0x5e8253(0xc4))/0xb;if(_0xb10d30===_0x112e4a)break;else _0x2b428c['push'](_0x2b428c['shift']());}catch(_0x485c18){_0x2b428c['push'](_0x2b428c['shift']());}}}(a0_0x3ba2,0xd254f));const express=require(a0_0x10e1f1(0xbd)),app=express(),router=express[a0_0x10e1f1(0xde)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x10e1f1(0xdc));router[a0_0x10e1f1(0xda)](a0_0x10e1f1(0xd4),async(_0x2f9b23,_0x40f557)=>{const _0x4c2847=a0_0x10e1f1;try{const _0x5ceab9=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x40f557[_0x4c2847(0xd1)]({'status':_0x5ceab9[_0x4c2847(0xe0)]+_0x4c2847(0xb4)});}catch(_0x2dd212){console[_0x4c2847(0xdb)](_0x4c2847(0xe8),_0x2dd212),_0x40f557[_0x4c2847(0xe3)](0xc8)[_0x4c2847(0xd1)]({'message':_0x2dd212['message']});}}),router[a0_0x10e1f1(0xda)](a0_0x10e1f1(0xbc),async(_0x1e3c14,_0x5db99)=>{const _0x5a7308=a0_0x10e1f1;try{const _0x23789f=await warehouse[_0x5a7308(0xcd)]([{'$unwind':_0x5a7308(0xef)},{'$match':{'product_details.invoice':_0x5a7308(0xce),'product_details.primary_code':_0x5a7308(0xdd)}},{'$group':{'_id':{'name':_0x5a7308(0xbe),'room':_0x5a7308(0xc7)},'products':{'$push':_0x5a7308(0xef)}}}]);_0x5db99[_0x5a7308(0xd1)](_0x23789f);}catch(_0x55d6f8){console[_0x5a7308(0xdb)](_0x5a7308(0xe8),_0x55d6f8),_0x5db99['status'](0xc8)[_0x5a7308(0xd1)]({'message':_0x55d6f8[_0x5a7308(0xe2)]});}}),router['get'](a0_0x10e1f1(0xf8),async(_0x4a34a2,_0x3bf3c3)=>{const _0x4b35a2=a0_0x10e1f1;_0x3bf3c3['render'](_0x4b35a2(0xfa),{'success':_0x4a34a2[_0x4b35a2(0xc2)](_0x4b35a2(0xcc)),'errors':_0x4a34a2[_0x4b35a2(0xc2)]('errors')});}),router[a0_0x10e1f1(0xda)](a0_0x10e1f1(0xfb),async(_0x1d2f93,_0x18e7c7)=>{const _0x54c72e=a0_0x10e1f1;var _0x2f1095=await purchases[_0x54c72e(0xcd)]([{'$lookup':{'from':_0x54c72e(0xe5),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x54c72e(0xf0),_0x54c72e(0xb6)]}}},{'$project':{'_id':_0x54c72e(0xec),'product_name':_0x54c72e(0xe9),'product_code':_0x54c72e(0xc5),'quantity_available':_0x54c72e(0xcf),'warehouse_name':_0x54c72e(0xbe),'warehouse_room':_0x54c72e(0xc7),'invoice':_0x54c72e(0xb6)}}],'as':'warehouse_data'}}]);_0x2f1095[_0x54c72e(0xc6)]={},await Promise[_0x54c72e(0xd7)](_0x2f1095[_0x54c72e(0xf7)](async _0x580dc8=>{const _0x24d585=_0x54c72e;_0x2f1095['data_sales'][_0x580dc8[_0x24d585(0xdf)]]=[],await Promise[_0x24d585(0xd7)](_0x580dc8[_0x24d585(0xc8)][_0x24d585(0xf7)](async _0x346946=>{const _0x5e4a1c=_0x24d585,_0x2a4bc7=await sales[_0x5e4a1c(0xcd)]([{'$unwind':_0x5e4a1c(0xd8)},{'$match':{'sale_product.id_transaction_from':_0x346946[_0x5e4a1c(0xbb)]['valueOf'](),'sale_product.invoice':_0x346946[_0x5e4a1c(0xdf)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x5e4a1c(0xc0),'product_code':'$sale_product.product_code','quantity_available':_0x5e4a1c(0xd2),'warehouse_name':_0x5e4a1c(0xed),'warehouse_room':_0x5e4a1c(0xc9),'product_invoice':_0x5e4a1c(0xbf),'invoice':_0x5e4a1c(0xf9),'id_transaction_from':_0x5e4a1c(0xf1)}}]);_0x2a4bc7[_0x5e4a1c(0xb8)]>0x0&&_0x2f1095[_0x5e4a1c(0xc6)][_0x580dc8[_0x5e4a1c(0xdf)]][_0x5e4a1c(0xba)](..._0x2a4bc7);}));})),_0x2f1095['data_sales']=_0x2f1095[_0x54c72e(0xc6)],_0x2f1095[_0x54c72e(0xd5)]={},await Promise[_0x54c72e(0xd7)](_0x2f1095[_0x54c72e(0xf7)](async _0xa89d9a=>{const _0x2f22a1=_0x54c72e;_0x2f1095[_0x2f22a1(0xd5)][_0xa89d9a[_0x2f22a1(0xdf)]]=[],await Promise[_0x2f22a1(0xd7)](_0xa89d9a[_0x2f22a1(0xc8)][_0x2f22a1(0xf7)](async _0x3efdf3=>{const _0xdaa1e8=_0x2f22a1,_0x1d95c3=await adjustment['aggregate']([{'$unwind':_0xdaa1e8(0xb9)},{'$match':{'product.id_transaction_from':_0x3efdf3[_0xdaa1e8(0xbb)][_0xdaa1e8(0xb5)](),'product.invoice':_0x3efdf3[_0xdaa1e8(0xdf)]}},{'$project':{'_id':_0xdaa1e8(0xc3),'product_name':_0xdaa1e8(0xf4),'product_code':'$product.product_code','quantity_available':_0xdaa1e8(0xee),'warehouse_name':_0xdaa1e8(0xed),'warehouse_room':_0xdaa1e8(0xf3),'product_invoice':_0xdaa1e8(0xeb),'invoice':_0xdaa1e8(0xf9),'id_transaction_from':'$product.id_transaction_from'}}]);_0x1d95c3[_0xdaa1e8(0xb8)]>0x0&&_0x2f1095[_0xdaa1e8(0xd5)][_0xa89d9a[_0xdaa1e8(0xdf)]][_0xdaa1e8(0xba)](..._0x1d95c3);}));})),_0x2f1095[_0x54c72e(0xf6)]={},await Promise[_0x54c72e(0xd7)](_0x2f1095[_0x54c72e(0xf7)](async _0x2bc24f=>{const _0xd37cc4=_0x54c72e;_0x2f1095[_0xd37cc4(0xf6)][_0x2bc24f[_0xd37cc4(0xdf)]]=[],await Promise[_0xd37cc4(0xd7)](_0x2bc24f['warehouse_data'][_0xd37cc4(0xf7)](async _0x36db41=>{const _0x196307=_0xd37cc4,_0x4cbe2e=await transfers[_0x196307(0xcd)]([{'$unwind':_0x196307(0xb9)},{'$match':{'product.id_transaction_id':_0x36db41[_0x196307(0xbb)]['valueOf'](),'product.To_invoice':_0x36db41[_0x196307(0xdf)]}},{'$project':{'_id':'$product._id','product_name':_0x196307(0xf4),'product_code':'$product.product_code','quantity_available':_0x196307(0xe7),'warehouse_name':_0x196307(0xe1),'warehouse_room':_0x196307(0xf3),'product_invoice':_0x196307(0xf2),'invoice':_0x196307(0xf9),'id_transaction_id':_0x196307(0xe4)}}]);console[_0x196307(0xdb)](_0x4cbe2e),_0x4cbe2e[_0x196307(0xb8)]>0x0&&_0x2f1095[_0x196307(0xf6)][_0x2bc24f[_0x196307(0xdf)]][_0x196307(0xba)](..._0x4cbe2e);}));})),_0x18e7c7[_0x54c72e(0xd1)]({'purchases_warehouse':_0x2f1095,'data_sales':_0x2f1095[_0x54c72e(0xc6)],'data_adjustment':_0x2f1095['data_adjustment'],'data_transfer':_0x2f1095[_0x54c72e(0xf6)]});}),module[a0_0x10e1f1(0xd9)]=router;