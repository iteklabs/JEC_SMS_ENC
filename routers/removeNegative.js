const a0_0x1ae57d=a0_0x1289;function a0_0x1289(_0x335338,_0x50b9a7){const _0x2300db=a0_0x2300();return a0_0x1289=function(_0x1289b7,_0x276efc){_0x1289b7=_0x1289b7-0xc2;let _0x2e13cb=_0x2300db[_0x1289b7];return _0x2e13cb;},a0_0x1289(_0x335338,_0x50b9a7);}(function(_0x7228a9,_0x1b8864){const _0x504261=a0_0x1289,_0xaf8caa=_0x7228a9();while(!![]){try{const _0x3e5767=-parseInt(_0x504261(0xd0))/0x1*(-parseInt(_0x504261(0xdb))/0x2)+parseInt(_0x504261(0xda))/0x3+parseInt(_0x504261(0xc8))/0x4+-parseInt(_0x504261(0xcb))/0x5+-parseInt(_0x504261(0xc5))/0x6+-parseInt(_0x504261(0xd2))/0x7+parseInt(_0x504261(0x104))/0x8*(parseInt(_0x504261(0xd5))/0x9);if(_0x3e5767===_0x1b8864)break;else _0xaf8caa['push'](_0xaf8caa['shift']());}catch(_0x2cd8ff){_0xaf8caa['push'](_0xaf8caa['shift']());}}}(a0_0x2300,0x757d2));function a0_0x2300(){const _0x2515ea=['/negative','$product','_id','/checking','INCF-52068316','$product_details.product_stock','express','$product.product_name','$product.invoice','$product_details._id','message','valueOf','data_sales','success','log','modifiedCount','push','528PvqVqk','warehouse_data','data_transfer','$sale_product.product_code','$sale_product','warehouses','1105626easBeH','/warehouse_monitor','$product.product_code','1761192UzjIoF','$sale_product.quantity','$product_details.product_code','2597970jYWnPX','/join','get','map','length','7VGYeGt','invoice','684663DhOmMJ','$invoice','$to_warehouse','47493FXcwmB','json','$warehouse_name','$product_details.invoice','$sale_product.id_transaction_from','947316mIBFst','51016RbyLgk','$sale_product.room_name','table\x20page','aggregate','all','$product.new_adjust_qty','status','Router','../../models/all_models','$product_details','$product_details.product_name','$product.room_names','$product._id','$name','$room','flash','updateMany','data_adjustment','$product.to_room_name','$product.id_transaction_id','monitor','exports','$sale_product._id','$$invoice'];a0_0x2300=function(){return _0x2515ea;};return a0_0x2300();}const express=require(a0_0x1ae57d(0xf9)),app=express(),router=express[a0_0x1ae57d(0xe2)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x1ae57d(0xe3));router[a0_0x1ae57d(0xcd)](a0_0x1ae57d(0xf3),async(_0x5da643,_0x3e7bd)=>{const _0x40a1ad=a0_0x1ae57d;try{const _0x33ee65=await warehouse[_0x40a1ad(0xeb)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x3e7bd[_0x40a1ad(0xd6)]({'status':_0x33ee65[_0x40a1ad(0x102)]+'\x20documents\x20updated'});}catch(_0x17a0c4){console['log'](_0x40a1ad(0xdd),_0x17a0c4),_0x3e7bd[_0x40a1ad(0xe1)](0xc8)[_0x40a1ad(0xd6)]({'message':_0x17a0c4[_0x40a1ad(0xfd)]});}}),router[a0_0x1ae57d(0xcd)](a0_0x1ae57d(0xf6),async(_0x2c7da0,_0x1578a8)=>{const _0x4ebcfc=a0_0x1ae57d;try{const _0x16d032=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0x4ebcfc(0xf7),'product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0x4ebcfc(0xe8),'room':_0x4ebcfc(0xe9)},'products':{'$push':_0x4ebcfc(0xe4)}}}]);_0x1578a8['json'](_0x16d032);}catch(_0x38884e){console[_0x4ebcfc(0x101)](_0x4ebcfc(0xdd),_0x38884e),_0x1578a8[_0x4ebcfc(0xe1)](0xc8)['json']({'message':_0x38884e[_0x4ebcfc(0xfd)]});}}),router['get'](a0_0x1ae57d(0xc6),async(_0x5f1444,_0x477aef)=>{const _0x32e043=a0_0x1ae57d;_0x477aef['render'](_0x32e043(0xef),{'success':_0x5f1444[_0x32e043(0xea)](_0x32e043(0x100)),'errors':_0x5f1444[_0x32e043(0xea)]('errors')});}),router[a0_0x1ae57d(0xcd)](a0_0x1ae57d(0xcc),async(_0x4f8ab2,_0x1380fd)=>{const _0x42f7a4=a0_0x1ae57d;var _0x154189=await purchases[_0x42f7a4(0xde)]([{'$lookup':{'from':_0x42f7a4(0xc4),'let':{'invoice':_0x42f7a4(0xd3)},'pipeline':[{'$unwind':_0x42f7a4(0xe4)},{'$match':{'$expr':{'$eq':[_0x42f7a4(0xf2),_0x42f7a4(0xd8)]}}},{'$project':{'_id':_0x42f7a4(0xfc),'product_name':_0x42f7a4(0xe5),'product_code':_0x42f7a4(0xca),'quantity_available':_0x42f7a4(0xf8),'warehouse_name':_0x42f7a4(0xe8),'warehouse_room':_0x42f7a4(0xe9),'invoice':'$product_details.invoice'}}],'as':_0x42f7a4(0x105)}}]);_0x154189[_0x42f7a4(0xff)]={},await Promise[_0x42f7a4(0xdf)](_0x154189['map'](async _0x5ca936=>{const _0x1182f8=_0x42f7a4;_0x154189[_0x1182f8(0xff)][_0x5ca936[_0x1182f8(0xd1)]]=[],await Promise[_0x1182f8(0xdf)](_0x5ca936[_0x1182f8(0x105)]['map'](async _0x5cf300=>{const _0x1d6a5e=_0x1182f8,_0x71cbf=await sales['aggregate']([{'$unwind':_0x1d6a5e(0xc3)},{'$match':{'sale_product.id_transaction_from':_0x5cf300['_id']['valueOf'](),'sale_product.invoice':_0x5cf300[_0x1d6a5e(0xd1)]}},{'$project':{'_id':_0x1d6a5e(0xf1),'product_name':'$sale_product.product_name','product_code':_0x1d6a5e(0xc2),'quantity_available':_0x1d6a5e(0xc9),'warehouse_name':_0x1d6a5e(0xd7),'warehouse_room':_0x1d6a5e(0xdc),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x1d6a5e(0xd9)}}]);_0x71cbf['length']>0x0&&_0x154189['data_sales'][_0x5ca936[_0x1d6a5e(0xd1)]][_0x1d6a5e(0x103)](..._0x71cbf);}));})),_0x154189['data_sales']=_0x154189[_0x42f7a4(0xff)],_0x154189['data_adjustment']={},await Promise[_0x42f7a4(0xdf)](_0x154189[_0x42f7a4(0xce)](async _0x3c9e32=>{const _0xed1929=_0x42f7a4;_0x154189[_0xed1929(0xec)][_0x3c9e32[_0xed1929(0xd1)]]=[],await Promise['all'](_0x3c9e32['warehouse_data']['map'](async _0x2260c3=>{const _0x16fef3=_0xed1929,_0xf642af=await adjustment[_0x16fef3(0xde)]([{'$unwind':_0x16fef3(0xf4)},{'$match':{'product.id_transaction_from':_0x2260c3['_id']['valueOf'](),'product.invoice':_0x2260c3[_0x16fef3(0xd1)]}},{'$project':{'_id':'$product._id','product_name':_0x16fef3(0xfa),'product_code':_0x16fef3(0xc7),'quantity_available':_0x16fef3(0xe0),'warehouse_name':_0x16fef3(0xd7),'warehouse_room':_0x16fef3(0xe6),'product_invoice':_0x16fef3(0xfb),'invoice':_0x16fef3(0xd3),'id_transaction_from':'$product.id_transaction_from'}}]);_0xf642af[_0x16fef3(0xcf)]>0x0&&_0x154189[_0x16fef3(0xec)][_0x3c9e32['invoice']]['push'](..._0xf642af);}));})),_0x154189[_0x42f7a4(0x106)]={},await Promise['all'](_0x154189['map'](async _0x55c035=>{const _0x5c36c0=_0x42f7a4;_0x154189[_0x5c36c0(0x106)][_0x55c035[_0x5c36c0(0xd1)]]=[],await Promise[_0x5c36c0(0xdf)](_0x55c035[_0x5c36c0(0x105)][_0x5c36c0(0xce)](async _0x3c1ed1=>{const _0x598e27=_0x5c36c0,_0x4e9b2f=await transfers[_0x598e27(0xde)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x3c1ed1[_0x598e27(0xf5)][_0x598e27(0xfe)](),'product.To_invoice':_0x3c1ed1[_0x598e27(0xd1)]}},{'$project':{'_id':_0x598e27(0xe7),'product_name':_0x598e27(0xfa),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x598e27(0xd4),'warehouse_room':_0x598e27(0xe6),'product_invoice':_0x598e27(0xed),'invoice':_0x598e27(0xd3),'id_transaction_id':_0x598e27(0xee)}}]);console[_0x598e27(0x101)](_0x4e9b2f),_0x4e9b2f[_0x598e27(0xcf)]>0x0&&_0x154189[_0x598e27(0x106)][_0x55c035[_0x598e27(0xd1)]][_0x598e27(0x103)](..._0x4e9b2f);}));})),_0x1380fd[_0x42f7a4(0xd6)]({'purchases_warehouse':_0x154189,'data_sales':_0x154189[_0x42f7a4(0xff)],'data_adjustment':_0x154189[_0x42f7a4(0xec)],'data_transfer':_0x154189[_0x42f7a4(0x106)]});}),module[a0_0x1ae57d(0xf0)]=router;