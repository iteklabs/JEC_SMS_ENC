const a0_0x378c87=a0_0x195b;function a0_0x1d99(){const _0x119941=['date_recieved','bay','product_name','20ochJqN','product_stock','nodemailer','Arabic\x20(ae)','39753VZjChE','production_date','out','level','/confirm_data','email','get','data_type','concat','batch_code','cancel','false','render','invoice','product_cat','English\x20(US)','map','5808720plMBXI','room_name','isConfirm','2224190QvGRVW','product_details','expiry_date','user','language','24SnAdbg','primary_code','Hindi','path','isUsed','11141960CbCWMX','1036029knTOyc','product_code','findOne','log','flash','length','find','French','inc','Arabic','save','maxperunit','27VEASWS','secondary_code','true','isAvailable','maxStocks','Portuguese\x20(BR)','secondary_unit','split','post','7503112HwUWMf','unit','/view/','_id','success','json','express','Portuguese','warehouse_id_detl','body','Chinese','uuid','2082451xMHCTI','../middleware/auth','exports','Spanish','warehouse','German'];a0_0x1d99=function(){return _0x119941;};return a0_0x1d99();}(function(_0x34e9af,_0x2faab5){const _0x388db2=a0_0x195b,_0x48c2c3=_0x34e9af();while(!![]){try{const _0x50b7e9=-parseInt(_0x388db2(0x13b))/0x1+parseInt(_0x388db2(0x14f))/0x2+-parseInt(_0x388db2(0x10d))/0x3*(-parseInt(_0x388db2(0x137))/0x4)+parseInt(_0x388db2(0x14c))/0x5+parseInt(_0x388db2(0x107))/0x6*(parseInt(_0x388db2(0x12e))/0x7)+-parseInt(_0x388db2(0x122))/0x8+parseInt(_0x388db2(0x119))/0x9*(-parseInt(_0x388db2(0x10c))/0xa);if(_0x50b7e9===_0x2faab5)break;else _0x48c2c3['push'](_0x48c2c3['shift']());}catch(_0x5c09a6){_0x48c2c3['push'](_0x48c2c3['shift']());}}}(a0_0x1d99,0xd4798));const express=require(a0_0x378c87(0x128)),app=express(),router=express['Router'](),{warehouse_validation_setup,master_shop,profile,warehouse,warehouse_temporary}=require('../models/all_models'),auth=require(a0_0x378c87(0x12f)),nodemailer=require(a0_0x378c87(0x139));var ejs=require('ejs');const path=require(a0_0x378c87(0x10a)),users=require('../public/language/languages.json');function a0_0x195b(_0x10120a,_0x54a92d){const _0x1d998d=a0_0x1d99();return a0_0x195b=function(_0x195bc0,_0x2e1dda){_0x195bc0=_0x195bc0-0x106;let _0x3de26e=_0x1d998d[_0x195bc0];return _0x3de26e;},a0_0x195b(_0x10120a,_0x54a92d);}router[a0_0x378c87(0x141)](a0_0x378c87(0x124),auth,async(_0x2f4ec3,_0xf5cefb)=>{const _0x29d952=a0_0x378c87;try{const {username:_0x3037d6,email:_0x1d2c55,role:_0x5cf227}=_0x2f4ec3[_0x29d952(0x152)],_0x56a9c4=_0x2f4ec3[_0x29d952(0x152)],_0x27d4ed=await profile[_0x29d952(0x10f)]({'email':_0x56a9c4[_0x29d952(0x140)]}),_0x4dacda=await master_shop[_0x29d952(0x113)]();if(_0x4dacda[0x0][_0x29d952(0x106)]==_0x29d952(0x14a))var _0x7e9578=users['English'];else{if(_0x4dacda[0x0][_0x29d952(0x106)]==_0x29d952(0x109))var _0x7e9578=users[_0x29d952(0x109)];else{if(_0x4dacda[0x0]['language']==_0x29d952(0x133))var _0x7e9578=users[_0x29d952(0x133)];else{if(_0x4dacda[0x0][_0x29d952(0x106)]==_0x29d952(0x131))var _0x7e9578=users[_0x29d952(0x131)];else{if(_0x4dacda[0x0]['language']=='French')var _0x7e9578=users[_0x29d952(0x114)];else{if(_0x4dacda[0x0]['language']==_0x29d952(0x11e))var _0x7e9578=users[_0x29d952(0x129)];else{if(_0x4dacda[0x0][_0x29d952(0x106)]==_0x29d952(0x12c))var _0x7e9578=users['Chinese'];else{if(_0x4dacda[0x0][_0x29d952(0x106)]==_0x29d952(0x13a))var _0x7e9578=users[_0x29d952(0x116)];}}}}}}}_0xf5cefb[_0x29d952(0x147)]('warehouse_checking',{'success':_0x2f4ec3['flash'](_0x29d952(0x126)),'errors':_0x2f4ec3[_0x29d952(0x111)]('errors'),'profile':_0x27d4ed,'master_shop':_0x4dacda,'role':_0x56a9c4,'language':_0x7e9578});}catch(_0x29a4e4){console['log'](_0x29a4e4);}}),router['post']('/check_to_confirm',auth,async(_0x318f94,_0xd723b)=>{const _0x50361f=a0_0x378c87;try{const {product_code:_0x4098ee,type_of_process:_0x1652ef}=_0x318f94[_0x50361f(0x12b)];var _0x1ae89d=_0x4098ee[_0x50361f(0x120)]('~');const _0x52868c=_0x1ae89d[0x0],_0x30ae5d=_0x1ae89d[0x1],_0x3a7fc3=_0x1ae89d[0x2],_0x4f4ebb=_0x1ae89d[0x3],_0x5bc201=await warehouse_temporary['find']({'warehouse':_0x52868c,'room_name':_0x30ae5d,'level':_0x3a7fc3,'bay':_0x4f4ebb,'data_type':_0x1652ef,'isConfirm':'false'});_0xd723b['json'](_0x5bc201);}catch(_0x26f8c6){console[_0x50361f(0x110)](_0x26f8c6);}}),router['post'](a0_0x378c87(0x13f),auth,async(_0x422869,_0x45cab0)=>{const _0xd6e7d5=a0_0x378c87;try{const {id_data:_0xd67faa}=_0x422869['body'],_0x4e1de9=await warehouse_temporary['find']({'_id':_0xd67faa});for(let _0x5677b4=0x0;_0x5677b4<=_0x4e1de9[_0xd6e7d5(0x112)]-0x1;_0x5677b4++){const _0x46a07b=_0x4e1de9[_0x5677b4];var _0x25004c=0x0;if(_0x46a07b[_0xd6e7d5(0x142)]==_0xd6e7d5(0x115)){var _0x463348=await warehouse['findOne']({'name':_0x46a07b[_0xd6e7d5(0x132)],'room':_0x46a07b['room_name']});const _0xf949df=_0x463348[_0xd6e7d5(0x150)][_0xd6e7d5(0x14b)](_0x27a968=>{const _0x9b923=_0xd6e7d5;_0x27a968['product_name']==_0x46a07b[_0x9b923(0x136)]&&_0x27a968[_0x9b923(0x108)]==_0x46a07b[_0x9b923(0x108)]&&_0x27a968['secondary_code']==_0x46a07b['secondary_code']&&_0x27a968['product_code']==_0x46a07b['product_code']&&_0x27a968[_0x9b923(0x135)]==_0x46a07b['bay']&&_0x27a968[_0x9b923(0x13e)]==_0x46a07b[_0x9b923(0x13e)]&&_0x27a968['date_recieved']==_0x46a07b['date_recieved']&&(_0x27a968[_0x9b923(0x138)]=parseInt(_0x27a968[_0x9b923(0x138)])+parseInt(_0x46a07b['product_stock']),_0x25004c++);});_0x25004c=='0'&&(_0x463348[_0xd6e7d5(0x150)]=_0x463348['product_details'][_0xd6e7d5(0x143)]({'product_name':_0x46a07b['product_name'],'product_stock':_0x46a07b['product_stock'],'primary_code':_0x46a07b[_0xd6e7d5(0x108)],'secondary_code':_0x46a07b[_0xd6e7d5(0x11a)],'product_code':_0x46a07b['product_code'],'bay':_0x46a07b[_0xd6e7d5(0x135)],'level':_0x46a07b[_0xd6e7d5(0x13e)],'maxProducts':_0x46a07b[_0xd6e7d5(0x11d)],'unit':_0x46a07b[_0xd6e7d5(0x123)],'secondary_unit':_0x46a07b[_0xd6e7d5(0x11f)],'maxPerUnit':_0x46a07b['maxperunit'],'alertQTY':_0x46a07b['alertQTY'],'production_date':_0x46a07b['production_date'],'expiry_date':_0x46a07b[_0xd6e7d5(0x151)],'batch_code':_0x46a07b[_0xd6e7d5(0x144)],'invoice':_0x46a07b[_0xd6e7d5(0x148)],'product_cat':_0x46a07b[_0xd6e7d5(0x149)],'uuid':_0x46a07b[_0xd6e7d5(0x12d)],'gross_price':_0x46a07b['gross_price'],'date_recieved':_0x46a07b[_0xd6e7d5(0x134)],'isAvailable':'true','isUsed':_0xd6e7d5(0x146),'warehouse_id_temp_inc':_0x46a07b['_id']})),_0x4e1de9[_0x5677b4][_0xd6e7d5(0x14e)]=_0xd6e7d5(0x11b),await _0x4e1de9[_0x5677b4][_0xd6e7d5(0x117)](),await _0x463348['save']();}else{if(_0x46a07b[_0xd6e7d5(0x142)]==_0xd6e7d5(0x13d)){var _0x463348=await warehouse[_0xd6e7d5(0x10f)]({'name':_0x46a07b[_0xd6e7d5(0x132)],'room':_0x46a07b['room_name']});const _0x4b4adb=_0x463348[_0xd6e7d5(0x150)][_0xd6e7d5(0x14b)](_0x3cf2f0=>{const _0x117220=_0xd6e7d5;_0x3cf2f0[_0x117220(0x136)]==_0x46a07b['product_name']&&_0x3cf2f0['primary_code']==_0x46a07b[_0x117220(0x108)]&&_0x3cf2f0['secondary_code']==_0x46a07b[_0x117220(0x11a)]&&_0x3cf2f0[_0x117220(0x10e)]==_0x46a07b[_0x117220(0x10e)]&&_0x3cf2f0[_0x117220(0x125)]==_0x46a07b[_0x117220(0x12a)]&&(_0x3cf2f0[_0x117220(0x138)]=parseInt(_0x3cf2f0['product_stock'])-parseInt(_0x46a07b[_0x117220(0x138)]),_0x3cf2f0['product_stock']==0x0?(_0x3cf2f0[_0x117220(0x11c)]=_0x117220(0x146),_0x4e1de9[_0x5677b4][_0x117220(0x11c)]=_0x117220(0x146),_0x4e1de9[_0x5677b4][_0x117220(0x10b)]=_0x117220(0x11b)):_0x4e1de9[_0x5677b4][_0x117220(0x10b)]=_0x117220(0x146),_0x3cf2f0[_0x117220(0x10b)]=_0x117220(0x146),_0x25004c++);});_0x4e1de9[_0x5677b4][_0xd6e7d5(0x14e)]=_0xd6e7d5(0x11b),await _0x4e1de9[_0x5677b4]['save'](),await _0x463348[_0xd6e7d5(0x117)]();}}}_0x45cab0[_0xd6e7d5(0x127)]({'data_main':_0x4e1de9,'data_warehouse':_0x463348});}catch(_0x499d4b){console[_0xd6e7d5(0x110)](_0x499d4b);}}),router[a0_0x378c87(0x121)]('/cancel_data',auth,async(_0x35a974,_0x2a4f12)=>{const _0x5225bb=a0_0x378c87;try{const {id_data:_0x414d84}=_0x35a974['body'],_0x5999da=await warehouse_temporary[_0x5225bb(0x113)]({'_id':_0x414d84});for(let _0x544299=0x0;_0x544299<=_0x5999da[_0x5225bb(0x112)]-0x1;_0x544299++){const _0x396b1f=_0x5999da[_0x544299];var _0x568cb=0x0;if(_0x396b1f['data_type']=='inc'){var _0x11c107=await warehouse[_0x5225bb(0x10f)]({'name':_0x396b1f[_0x5225bb(0x132)],'room':_0x396b1f[_0x5225bb(0x14d)]});const _0x55f688=_0x11c107['product_details'][_0x5225bb(0x14b)](_0x182965=>{const _0x55e36b=_0x5225bb;_0x182965[_0x55e36b(0x136)]==_0x396b1f[_0x55e36b(0x136)]&&_0x182965['primary_code']==_0x396b1f[_0x55e36b(0x108)]&&_0x182965['secondary_code']==_0x396b1f[_0x55e36b(0x11a)]&&_0x182965[_0x55e36b(0x10e)]==_0x396b1f['product_code']&&_0x182965[_0x55e36b(0x135)]==_0x396b1f['bay']&&_0x182965[_0x55e36b(0x13e)]==_0x396b1f[_0x55e36b(0x13e)]&&_0x182965[_0x55e36b(0x134)]==_0x396b1f[_0x55e36b(0x134)]&&(_0x182965[_0x55e36b(0x138)]=parseInt(_0x182965[_0x55e36b(0x138)])+parseInt(_0x396b1f['product_stock']),_0x568cb++);});_0x568cb=='0'&&(_0x11c107[_0x5225bb(0x150)]=_0x11c107[_0x5225bb(0x150)][_0x5225bb(0x143)]({'product_name':_0x396b1f[_0x5225bb(0x136)],'product_stock':_0x396b1f[_0x5225bb(0x138)],'primary_code':_0x396b1f[_0x5225bb(0x108)],'secondary_code':_0x396b1f[_0x5225bb(0x11a)],'product_code':_0x396b1f[_0x5225bb(0x10e)],'bay':_0x396b1f[_0x5225bb(0x135)],'level':_0x396b1f[_0x5225bb(0x13e)],'maxProducts':_0x396b1f[_0x5225bb(0x11d)],'unit':_0x396b1f['unit'],'secondary_unit':_0x396b1f[_0x5225bb(0x11f)],'maxPerUnit':_0x396b1f[_0x5225bb(0x118)],'alertQTY':_0x396b1f['alertQTY'],'production_date':_0x396b1f[_0x5225bb(0x13c)],'expiry_date':_0x396b1f[_0x5225bb(0x151)],'batch_code':_0x396b1f[_0x5225bb(0x144)],'invoice':_0x396b1f[_0x5225bb(0x148)],'product_cat':_0x396b1f[_0x5225bb(0x149)],'uuid':_0x396b1f['uuid'],'gross_price':_0x396b1f['gross_price'],'date_recieved':_0x396b1f[_0x5225bb(0x134)],'isAvailable':_0x5225bb(0x11b),'isUsed':'false','warehouse_id_temp_inc':_0x396b1f[_0x5225bb(0x125)]})),_0x5999da[_0x544299][_0x5225bb(0x14e)]=_0x5225bb(0x11b),await _0x5999da[_0x544299][_0x5225bb(0x117)](),await _0x11c107[_0x5225bb(0x117)]();}else{if(_0x396b1f[_0x5225bb(0x142)]==_0x5225bb(0x13d)){var _0x11c107=await warehouse[_0x5225bb(0x10f)]({'name':_0x396b1f[_0x5225bb(0x132)],'room':_0x396b1f[_0x5225bb(0x14d)]});const _0x3a787a=_0x11c107[_0x5225bb(0x150)][_0x5225bb(0x14b)](_0x4aa7d2=>{const _0x3232cd=_0x5225bb;_0x4aa7d2[_0x3232cd(0x136)]==_0x396b1f['product_name']&&_0x4aa7d2[_0x3232cd(0x108)]==_0x396b1f[_0x3232cd(0x108)]&&_0x4aa7d2[_0x3232cd(0x11a)]==_0x396b1f[_0x3232cd(0x11a)]&&_0x4aa7d2[_0x3232cd(0x10e)]==_0x396b1f[_0x3232cd(0x10e)]&&_0x4aa7d2[_0x3232cd(0x125)]==_0x396b1f[_0x3232cd(0x12a)]&&(_0x4aa7d2[_0x3232cd(0x11c)]=_0x3232cd(0x11b),_0x5999da[_0x544299][_0x3232cd(0x11c)]=_0x3232cd(0x145),_0x5999da[_0x544299][_0x3232cd(0x10b)]=_0x3232cd(0x11b),_0x4aa7d2[_0x3232cd(0x10b)]='false',_0x568cb++);});_0x5999da[_0x544299][_0x5225bb(0x14e)]='true',await _0x5999da[_0x544299][_0x5225bb(0x117)](),await _0x11c107[_0x5225bb(0x117)]();}}}_0x2a4f12['json']({'data_main':_0x5999da,'data_warehouse':_0x11c107});}catch(_0x277ffa){console[_0x5225bb(0x110)](_0x277ffa);}}),module[a0_0x378c87(0x130)]=router;