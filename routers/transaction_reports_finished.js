var a0_0x137953=a0_0x107e;function a0_0x5cfa(){var _0x491c8d=['params','$product_details.production_date','$product_details.invoice','$sale_product._id','$product_details.product_stock','$product.new_adjust_qty','data_adjustment','/viewdata_og_fg/:id','/reports','$product.expiry_date','786828vVrSFM','post','Arabic\x20(ae)','$sale_product.production_date','warehouse_data','$product_details','../models/all_models','express','../public/language/languages.json','$product.to_quantity','$product','5gEpoXC','7607976xJJkUz','warehouses','46646wrqDbd','view_table','log','aggregate','Finished\x20Goods','_id','Portuguese\x20(BR)','French','$sale_product.expiry_date','$sale_product','transaction_finished_raw','exports','$name','push','$product.product_code','$product.to_room_name','German','$product.unit','errors','$product_details.product_name','$product.product_name','$product_details.unit','$product.id_transaction','Hindi','data_transfer','$product.production_date','Arabic','/viewFG','email','$product_details.expiry_date','Spanish','/viewdata_inc_fg/:id','$sale_product.room_name','/view','success','$product_details.product_code','json','Enabled','view_og_table','map','$sale_product.product_code','11338104rgGuEc','Raw\x20Materials','length','Router','$$invoice','$warehouse_name','all','$product.room_names','1202276VzZYQm','transaction_finished','body','Chinese','$sale_product.quantity','6220158HWdblt','findOne','$product.id_transaction_from','$product.invoice','$sale_product.product_name','valueOf','data_sales','$date','flash','$to_warehouse','../middleware/auth','$sale_product.unit','$invoice','$product_details._id','English','$product._id','render','language','find','1102836EAOfVE','$sale_product.invoice','nodemailer','Portuguese','$product.id_transaction_id','user','view_tf_table','invoice','get','English\x20(US)','$sale_product.id_transaction_from','$room'];a0_0x5cfa=function(){return _0x491c8d;};return a0_0x5cfa();}(function(_0x2d9f8e,_0x196123){var _0x25c784=a0_0x107e,_0x4f16d5=_0x2d9f8e();while(!![]){try{var _0x23064e=-parseInt(_0x25c784(0x23d))/0x1+-parseInt(_0x25c784(0x1f4))/0x2+-parseInt(_0x25c784(0x1e6))/0x3+-parseInt(_0x25c784(0x225))/0x4*(-parseInt(_0x25c784(0x1f1))/0x5)+parseInt(_0x25c784(0x1f2))/0x6+-parseInt(_0x25c784(0x22a))/0x7+parseInt(_0x25c784(0x21d))/0x8;if(_0x23064e===_0x196123)break;else _0x4f16d5['push'](_0x4f16d5['shift']());}catch(_0x5eaf02){_0x4f16d5['push'](_0x4f16d5['shift']());}}}(a0_0x5cfa,0xad0bf));const express=require(a0_0x137953(0x1ed)),app=express(),router=express[a0_0x137953(0x220)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x137953(0x1ec)),auth=require(a0_0x137953(0x234)),users=require(a0_0x137953(0x1ee)),nodemailer=require(a0_0x137953(0x23f));function a0_0x107e(_0x453b6d,_0x384fe7){var _0x5cfacf=a0_0x5cfa();return a0_0x107e=function(_0x107e6d,_0x2953a4){_0x107e6d=_0x107e6d-0x1d8;var _0x1c5afb=_0x5cfacf[_0x107e6d];return _0x1c5afb;},a0_0x107e(_0x453b6d,_0x384fe7);}router[a0_0x137953(0x1d8)](a0_0x137953(0x215),auth,async(_0x4d1a72,_0x1d0e21)=>{var _0x1cda75=a0_0x137953;try{const {username:_0x3f4fae,email:_0x107bee,role:_0xe48a73}=_0x4d1a72['user'],_0x47b374=_0x4d1a72[_0x1cda75(0x242)],_0x5a2d39=await profile['findOne']({'email':_0x47b374[_0x1cda75(0x210)]}),_0x11eb7f=await master_shop[_0x1cda75(0x23c)](),_0x4993ad=await warehouse[_0x1cda75(0x1f7)]([{'$match':{'status':_0x1cda75(0x219),'warehouse_category':_0x1cda75(0x1f8)}},{'$group':{'_id':'$name','name':{'$first':_0x1cda75(0x200)}}}]);if(_0x11eb7f[0x0][_0x1cda75(0x23b)]==_0x1cda75(0x1d9))var _0x3eafb4=users[_0x1cda75(0x238)];else{if(_0x11eb7f[0x0][_0x1cda75(0x23b)]==_0x1cda75(0x20b))var _0x3eafb4=users['Hindi'];else{if(_0x11eb7f[0x0][_0x1cda75(0x23b)]=='German')var _0x3eafb4=users[_0x1cda75(0x204)];else{if(_0x11eb7f[0x0]['language']=='Spanish')var _0x3eafb4=users[_0x1cda75(0x212)];else{if(_0x11eb7f[0x0][_0x1cda75(0x23b)]=='French')var _0x3eafb4=users[_0x1cda75(0x1fb)];else{if(_0x11eb7f[0x0]['language']==_0x1cda75(0x1fa))var _0x3eafb4=users[_0x1cda75(0x240)];else{if(_0x11eb7f[0x0][_0x1cda75(0x23b)]==_0x1cda75(0x228))var _0x3eafb4=users[_0x1cda75(0x228)];else{if(_0x11eb7f[0x0][_0x1cda75(0x23b)]=='Arabic\x20(ae)')var _0x3eafb4=users[_0x1cda75(0x20e)];}}}}}}}_0x1d0e21[_0x1cda75(0x23a)](_0x1cda75(0x226),{'success':_0x4d1a72[_0x1cda75(0x232)](_0x1cda75(0x216)),'errors':_0x4d1a72['flash'](_0x1cda75(0x206)),'role':_0x47b374,'profile':_0x5a2d39,'master_shop':_0x11eb7f,'dataProcess':_0x4993ad,'language':_0x3eafb4});}catch(_0x3576c9){console['log'](_0x3576c9);}}),router[a0_0x137953(0x1e7)](a0_0x137953(0x1e4),auth,async(_0x54fa65,_0x3349cf)=>{var _0x4a4b4a=a0_0x137953;const {product_category:_0x3965e,transaction_category:_0x5862be,transaction_date_from:_0xba9795,transaction_date_to:_0x43fa01,warehouse_category:_0x4d76ec,item_code:_0x7c8b8f}=_0x54fa65[_0x4a4b4a(0x227)];console[_0x4a4b4a(0x1f6)](_0x4d76ec);if(_0x3965e=='rm'){if(_0x4d76ec==_0x4a4b4a(0x223)){var _0x1d29c8=await purchases[_0x4a4b4a(0x1f7)]([{'$match':{'date':{'$gte':_0xba9795,'$lte':_0x43fa01}}},{'$lookup':{'from':_0x4a4b4a(0x1f3),'let':{'invoice':_0x4a4b4a(0x236)},'pipeline':[{'$unwind':_0x4a4b4a(0x1eb)},{'$match':{'$expr':{'$eq':[_0x4a4b4a(0x221),_0x4a4b4a(0x1de)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x4a4b4a(0x207),'product_code':_0x4a4b4a(0x217),'quantity_available':_0x4a4b4a(0x1e0),'warehouse_name':_0x4a4b4a(0x200),'warehouse_room':_0x4a4b4a(0x1db),'invoice':_0x4a4b4a(0x1de),'production_date':_0x4a4b4a(0x1dd),'expiry_date':_0x4a4b4a(0x211),'UOM':_0x4a4b4a(0x209)}}],'as':_0x4a4b4a(0x1ea)}}]);_0x1d29c8[_0x4a4b4a(0x230)]={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x3b099c=>{var _0x2810b9=_0x4a4b4a;_0x1d29c8[_0x2810b9(0x230)][_0x3b099c[_0x2810b9(0x244)]]=[],await Promise[_0x2810b9(0x223)](_0x3b099c[_0x2810b9(0x1ea)]['map'](async _0x5a3a99=>{var _0x44a318=_0x2810b9;const _0xe80664=await sales[_0x44a318(0x1f7)]([{'$unwind':_0x44a318(0x1fd)},{'$match':{'sale_product.id_transaction_from':_0x5a3a99['_id'][_0x44a318(0x22f)](),'sale_product.invoice':_0x5a3a99[_0x44a318(0x244)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x44a318(0x22e),'product_code':_0x44a318(0x21c),'quantity_available':'$sale_product.quantity','warehouse_name':_0x44a318(0x222),'warehouse_room':_0x44a318(0x214),'product_invoice':_0x44a318(0x23e),'invoice':'$invoice','id_transaction_from':_0x44a318(0x1da),'date':_0x44a318(0x231),'production_date':_0x44a318(0x1e9),'expiry_date':_0x44a318(0x1fc),'UOM':_0x44a318(0x235)}}]);_0xe80664[_0x44a318(0x21f)]>0x0&&_0x1d29c8[_0x44a318(0x230)][_0x3b099c['invoice']][_0x44a318(0x201)](..._0xe80664);}));})),_0x1d29c8['data_sales']=_0x1d29c8['data_sales'],_0x1d29c8['data_adjustment']={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x13de92=>{var _0xd780f4=_0x4a4b4a;_0x1d29c8[_0xd780f4(0x1e2)][_0x13de92[_0xd780f4(0x244)]]=[],await Promise[_0xd780f4(0x223)](_0x13de92[_0xd780f4(0x1ea)][_0xd780f4(0x21b)](async _0x2955b7=>{var _0x4bec32=_0xd780f4;const _0x1803ef=await adjustment[_0x4bec32(0x1f7)]([{'$unwind':_0x4bec32(0x1f0)},{'$match':{'product.id_transaction_from':_0x2955b7[_0x4bec32(0x1f9)][_0x4bec32(0x22f)](),'product.invoice':_0x2955b7[_0x4bec32(0x244)]}},{'$project':{'_id':_0x4bec32(0x239),'product_name':'$product.product_name','product_code':_0x4bec32(0x202),'quantity_available':_0x4bec32(0x1e1),'warehouse_name':_0x4bec32(0x222),'warehouse_room':_0x4bec32(0x224),'product_invoice':_0x4bec32(0x22d),'invoice':'$invoice','id_transaction_from':_0x4bec32(0x22c),'date':_0x4bec32(0x231),'production_date':_0x4bec32(0x20d),'expiry_date':_0x4bec32(0x1e5),'UOM':_0x4bec32(0x205)}}]);_0x1803ef['length']>0x0&&_0x1d29c8[_0x4bec32(0x1e2)][_0x13de92[_0x4bec32(0x244)]]['push'](..._0x1803ef);}));})),_0x1d29c8[_0x4a4b4a(0x20c)]={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8['map'](async _0x356c2e=>{var _0x427271=_0x4a4b4a;_0x1d29c8[_0x427271(0x20c)][_0x356c2e[_0x427271(0x244)]]=[],await Promise[_0x427271(0x223)](_0x356c2e['warehouse_data'][_0x427271(0x21b)](async _0x3c0e78=>{var _0x4e6898=_0x427271;const _0xc41865=await transfers[_0x4e6898(0x1f7)]([{'$unwind':_0x4e6898(0x1f0)},{'$match':{'product.id_transaction_id':_0x3c0e78[_0x4e6898(0x1f9)][_0x4e6898(0x22f)](),'product.To_invoice':_0x3c0e78[_0x4e6898(0x244)]}},{'$project':{'_id':_0x4e6898(0x239),'product_name':_0x4e6898(0x208),'product_code':_0x4e6898(0x202),'quantity_available':_0x4e6898(0x1ef),'warehouse_name':'$to_warehouse','warehouse_room':'$product.room_names','product_invoice':_0x4e6898(0x203),'invoice':_0x4e6898(0x236),'id_transaction_from':_0x4e6898(0x241),'date':'$date','production_date':_0x4e6898(0x20d),'expiry_date':'$product.expiry_date','UOM':_0x4e6898(0x205)}}]);_0xc41865[_0x4e6898(0x21f)]>0x0&&_0x1d29c8[_0x4e6898(0x20c)][_0x356c2e[_0x4e6898(0x244)]][_0x4e6898(0x201)](..._0xc41865);}));})),_0x3349cf[_0x4a4b4a(0x218)]({'purchases_warehouse':_0x1d29c8,'data_sales':_0x1d29c8[_0x4a4b4a(0x230)],'data_adjustment':_0x1d29c8[_0x4a4b4a(0x1e2)],'data_transfer':_0x1d29c8[_0x4a4b4a(0x20c)]});}else{var _0x1d29c8=await purchases[_0x4a4b4a(0x1f7)]([{'$match':{'warehouse_name':_0x4d76ec,'date':{'$gte':_0xba9795,'$lte':_0x43fa01}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x4a4b4a(0x236)},'pipeline':[{'$unwind':_0x4a4b4a(0x1eb)},{'$match':{'$expr':{'$eq':[_0x4a4b4a(0x221),_0x4a4b4a(0x1de)]}}},{'$project':{'_id':_0x4a4b4a(0x237),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':_0x4a4b4a(0x1e0),'warehouse_name':_0x4a4b4a(0x200),'warehouse_room':_0x4a4b4a(0x1db),'invoice':_0x4a4b4a(0x1de),'production_date':_0x4a4b4a(0x1dd),'expiry_date':_0x4a4b4a(0x211),'UOM':_0x4a4b4a(0x209)}}],'as':_0x4a4b4a(0x1ea)}}]);_0x1d29c8[_0x4a4b4a(0x230)]={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x38bc0f=>{var _0x49ea93=_0x4a4b4a;_0x1d29c8[_0x49ea93(0x230)][_0x38bc0f[_0x49ea93(0x244)]]=[],await Promise[_0x49ea93(0x223)](_0x38bc0f[_0x49ea93(0x1ea)][_0x49ea93(0x21b)](async _0x39e973=>{var _0x1bc3b7=_0x49ea93;const _0x5e82d0=await sales['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x39e973[_0x1bc3b7(0x1f9)][_0x1bc3b7(0x22f)](),'sale_product.invoice':_0x39e973[_0x1bc3b7(0x244)]}},{'$project':{'_id':_0x1bc3b7(0x1df),'product_name':_0x1bc3b7(0x22e),'product_code':_0x1bc3b7(0x21c),'quantity_available':_0x1bc3b7(0x229),'warehouse_name':_0x1bc3b7(0x222),'warehouse_room':_0x1bc3b7(0x214),'product_invoice':_0x1bc3b7(0x23e),'invoice':_0x1bc3b7(0x236),'id_transaction_from':_0x1bc3b7(0x1da),'date':_0x1bc3b7(0x231),'production_date':'$sale_product.production_date','expiry_date':'$sale_product.expiry_date','UOM':_0x1bc3b7(0x235)}}]);_0x5e82d0[_0x1bc3b7(0x21f)]>0x0&&_0x1d29c8[_0x1bc3b7(0x230)][_0x38bc0f[_0x1bc3b7(0x244)]]['push'](..._0x5e82d0);}));})),_0x1d29c8[_0x4a4b4a(0x230)]=_0x1d29c8['data_sales'],_0x1d29c8[_0x4a4b4a(0x1e2)]={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x562f74=>{var _0x546413=_0x4a4b4a;_0x1d29c8['data_adjustment'][_0x562f74['invoice']]=[],await Promise[_0x546413(0x223)](_0x562f74[_0x546413(0x1ea)][_0x546413(0x21b)](async _0x5e04cf=>{var _0x4182bb=_0x546413;const _0x53dcc4=await adjustment[_0x4182bb(0x1f7)]([{'$unwind':_0x4182bb(0x1f0)},{'$match':{'product.id_transaction_from':_0x5e04cf[_0x4182bb(0x1f9)][_0x4182bb(0x22f)](),'product.invoice':_0x5e04cf['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x4182bb(0x208),'product_code':'$product.product_code','quantity_available':_0x4182bb(0x1e1),'warehouse_name':_0x4182bb(0x222),'warehouse_room':'$product.room_names','product_invoice':_0x4182bb(0x22d),'invoice':_0x4182bb(0x236),'id_transaction_from':_0x4182bb(0x22c),'date':_0x4182bb(0x231),'production_date':_0x4182bb(0x20d),'expiry_date':_0x4182bb(0x1e5),'UOM':_0x4182bb(0x205)}}]);_0x53dcc4[_0x4182bb(0x21f)]>0x0&&_0x1d29c8[_0x4182bb(0x1e2)][_0x562f74[_0x4182bb(0x244)]][_0x4182bb(0x201)](..._0x53dcc4);}));})),_0x1d29c8[_0x4a4b4a(0x20c)]={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x1cf87e=>{var _0x339d31=_0x4a4b4a;_0x1d29c8[_0x339d31(0x20c)][_0x1cf87e['invoice']]=[],await Promise[_0x339d31(0x223)](_0x1cf87e['warehouse_data']['map'](async _0x66dbdc=>{var _0x463c1b=_0x339d31;const _0x2cbcf1=await transfers[_0x463c1b(0x1f7)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x66dbdc[_0x463c1b(0x1f9)][_0x463c1b(0x22f)](),'product.To_invoice':_0x66dbdc[_0x463c1b(0x244)]}},{'$project':{'_id':'$product._id','product_name':_0x463c1b(0x208),'product_code':'$product.product_code','quantity_available':_0x463c1b(0x1ef),'warehouse_name':_0x463c1b(0x233),'warehouse_room':'$product.room_names','product_invoice':_0x463c1b(0x203),'invoice':_0x463c1b(0x236),'id_transaction_from':'$product.id_transaction_id','date':_0x463c1b(0x231),'production_date':_0x463c1b(0x20d),'expiry_date':_0x463c1b(0x1e5),'UOM':_0x463c1b(0x205)}}]);_0x2cbcf1[_0x463c1b(0x21f)]>0x0&&_0x1d29c8[_0x463c1b(0x20c)][_0x1cf87e[_0x463c1b(0x244)]][_0x463c1b(0x201)](..._0x2cbcf1);}));})),_0x3349cf[_0x4a4b4a(0x218)]({'purchases_warehouse':_0x1d29c8,'data_sales':_0x1d29c8[_0x4a4b4a(0x230)],'data_adjustment':_0x1d29c8['data_adjustment'],'data_transfer':_0x1d29c8[_0x4a4b4a(0x20c)]});}}else{if(_0x4d76ec=='all'){var _0x1d29c8=await purchases_finished[_0x4a4b4a(0x1f7)]([{'$match':{'date':{'$gte':_0xba9795,'$lte':_0x43fa01}}},{'$lookup':{'from':_0x4a4b4a(0x1f3),'let':{'invoice':_0x4a4b4a(0x236)},'pipeline':[{'$unwind':_0x4a4b4a(0x1eb)},{'$match':{'$expr':{'$eq':[_0x4a4b4a(0x221),_0x4a4b4a(0x1de)]}}},{'$project':{'_id':_0x4a4b4a(0x237),'product_name':_0x4a4b4a(0x207),'product_code':_0x4a4b4a(0x217),'quantity_available':_0x4a4b4a(0x1e0),'warehouse_name':_0x4a4b4a(0x200),'warehouse_room':'$room','invoice':_0x4a4b4a(0x1de),'production_date':_0x4a4b4a(0x1dd),'expiry_date':_0x4a4b4a(0x211),'UOM':_0x4a4b4a(0x209)}}],'as':_0x4a4b4a(0x1ea)}}]);_0x1d29c8[_0x4a4b4a(0x230)]={},await Promise['all'](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x33e668=>{var _0x326238=_0x4a4b4a;_0x1d29c8[_0x326238(0x230)][_0x33e668[_0x326238(0x244)]]=[],await Promise['all'](_0x33e668[_0x326238(0x1ea)][_0x326238(0x21b)](async _0x1cbb75=>{var _0x3a1354=_0x326238;const _0x3877a5=await sales_finished['aggregate']([{'$unwind':_0x3a1354(0x1fd)},{'$match':{'sale_product.id_transaction_from':_0x1cbb75[_0x3a1354(0x1f9)]['valueOf'](),'sale_product.invoice':_0x1cbb75[_0x3a1354(0x244)]}},{'$project':{'_id':_0x3a1354(0x1df),'product_name':'$sale_product.product_name','product_code':_0x3a1354(0x21c),'quantity_available':_0x3a1354(0x229),'warehouse_name':_0x3a1354(0x222),'warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':_0x3a1354(0x236),'id_transaction_from':_0x3a1354(0x1da),'date':_0x3a1354(0x231),'production_date':_0x3a1354(0x1e9),'expiry_date':'$sale_product.expiry_date','UOM':_0x3a1354(0x235)}}]);_0x3877a5[_0x3a1354(0x21f)]>0x0&&_0x1d29c8[_0x3a1354(0x230)][_0x33e668[_0x3a1354(0x244)]][_0x3a1354(0x201)](..._0x3877a5);}));})),_0x1d29c8[_0x4a4b4a(0x230)]=_0x1d29c8[_0x4a4b4a(0x230)],_0x1d29c8['data_adjustment']={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x1ebcb3=>{var _0x1e5404=_0x4a4b4a;_0x1d29c8[_0x1e5404(0x1e2)][_0x1ebcb3[_0x1e5404(0x244)]]=[],await Promise['all'](_0x1ebcb3[_0x1e5404(0x1ea)][_0x1e5404(0x21b)](async _0x51964d=>{var _0x20d43c=_0x1e5404;const _0x137ed8=await adjustment_finished[_0x20d43c(0x1f7)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x51964d['_id'][_0x20d43c(0x22f)](),'product.invoice':_0x51964d[_0x20d43c(0x244)]}},{'$project':{'_id':'$product._id','product_name':_0x20d43c(0x208),'product_code':_0x20d43c(0x202),'quantity_available':_0x20d43c(0x1e1),'warehouse_name':_0x20d43c(0x222),'warehouse_room':_0x20d43c(0x224),'product_invoice':'$product.invoice','invoice':_0x20d43c(0x236),'id_transaction_from':_0x20d43c(0x22c),'date':_0x20d43c(0x231),'production_date':_0x20d43c(0x20d),'expiry_date':_0x20d43c(0x1e5),'UOM':_0x20d43c(0x205)}}]);_0x137ed8[_0x20d43c(0x21f)]>0x0&&_0x1d29c8[_0x20d43c(0x1e2)][_0x1ebcb3[_0x20d43c(0x244)]][_0x20d43c(0x201)](..._0x137ed8);}));})),_0x1d29c8[_0x4a4b4a(0x20c)]={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x48e358=>{var _0x28dfd0=_0x4a4b4a;_0x1d29c8[_0x28dfd0(0x20c)][_0x48e358[_0x28dfd0(0x244)]]=[],await Promise['all'](_0x48e358['warehouse_data']['map'](async _0x3c7ed0=>{var _0x5401cb=_0x28dfd0;const _0x2af406=await transfers_finished['aggregate']([{'$unwind':_0x5401cb(0x1f0)},{'$match':{'product.id_transaction':_0x3c7ed0['_id'][_0x5401cb(0x22f)](),'product.from_invoice':_0x3c7ed0[_0x5401cb(0x244)]}},{'$project':{'_id':_0x5401cb(0x239),'product_name':_0x5401cb(0x208),'product_code':'$product.product_code','quantity_available':_0x5401cb(0x1ef),'warehouse_name':_0x5401cb(0x233),'warehouse_room':_0x5401cb(0x224),'product_invoice':_0x5401cb(0x203),'invoice':_0x5401cb(0x236),'id_transaction_from':_0x5401cb(0x20a),'date':_0x5401cb(0x231),'production_date':'$product.production_date','expiry_date':_0x5401cb(0x1e5),'UOM':_0x5401cb(0x205)}}]);_0x2af406[_0x5401cb(0x21f)]>0x0&&_0x1d29c8['data_transfer'][_0x48e358[_0x5401cb(0x244)]][_0x5401cb(0x201)](..._0x2af406);}));})),_0x3349cf[_0x4a4b4a(0x218)]({'purchases_warehouse':_0x1d29c8,'data_sales':_0x1d29c8[_0x4a4b4a(0x230)],'data_adjustment':_0x1d29c8[_0x4a4b4a(0x1e2)],'data_transfer':_0x1d29c8[_0x4a4b4a(0x20c)]});}else{var _0x1d29c8=await purchases_finished[_0x4a4b4a(0x1f7)]([{'$match':{'warehouse_name':_0x4d76ec,'date':{'$gte':_0xba9795,'$lte':_0x43fa01}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x4a4b4a(0x236)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':['$$invoice',_0x4a4b4a(0x1de)]}}},{'$project':{'_id':_0x4a4b4a(0x237),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':_0x4a4b4a(0x1e0),'warehouse_name':_0x4a4b4a(0x200),'warehouse_room':_0x4a4b4a(0x1db),'invoice':'$product_details.invoice','production_date':_0x4a4b4a(0x1dd),'expiry_date':'$product_details.expiry_date','UOM':_0x4a4b4a(0x209)}}],'as':_0x4a4b4a(0x1ea)}}]);_0x1d29c8['data_sales']={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x178807=>{var _0x5bb1bf=_0x4a4b4a;_0x1d29c8[_0x5bb1bf(0x230)][_0x178807[_0x5bb1bf(0x244)]]=[],await Promise[_0x5bb1bf(0x223)](_0x178807['warehouse_data'][_0x5bb1bf(0x21b)](async _0x598825=>{var _0x9322e9=_0x5bb1bf;const _0x270d1e=await sales_finished[_0x9322e9(0x1f7)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x598825[_0x9322e9(0x1f9)][_0x9322e9(0x22f)](),'sale_product.invoice':_0x598825['invoice']}},{'$project':{'_id':_0x9322e9(0x1df),'product_name':'$sale_product.product_name','product_code':_0x9322e9(0x21c),'quantity_available':_0x9322e9(0x229),'warehouse_name':_0x9322e9(0x222),'warehouse_room':'$sale_product.room_name','product_invoice':_0x9322e9(0x23e),'invoice':'$invoice','id_transaction_from':_0x9322e9(0x1da),'date':_0x9322e9(0x231),'production_date':_0x9322e9(0x1e9),'expiry_date':_0x9322e9(0x1fc),'UOM':_0x9322e9(0x235)}}]);_0x270d1e[_0x9322e9(0x21f)]>0x0&&_0x1d29c8['data_sales'][_0x178807[_0x9322e9(0x244)]]['push'](..._0x270d1e);}));})),_0x1d29c8[_0x4a4b4a(0x230)]=_0x1d29c8['data_sales'],_0x1d29c8[_0x4a4b4a(0x1e2)]={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x3fd4c0=>{var _0x225754=_0x4a4b4a;_0x1d29c8[_0x225754(0x1e2)][_0x3fd4c0[_0x225754(0x244)]]=[],await Promise['all'](_0x3fd4c0[_0x225754(0x1ea)][_0x225754(0x21b)](async _0xebcc6b=>{var _0x5175c3=_0x225754;const _0x590d0f=await adjustment_finished[_0x5175c3(0x1f7)]([{'$unwind':_0x5175c3(0x1f0)},{'$match':{'product.id_transaction_from':_0xebcc6b[_0x5175c3(0x1f9)]['valueOf'](),'product.invoice':_0xebcc6b[_0x5175c3(0x244)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x5175c3(0x202),'quantity_available':_0x5175c3(0x1e1),'warehouse_name':_0x5175c3(0x222),'warehouse_room':_0x5175c3(0x224),'product_invoice':'$product.invoice','invoice':_0x5175c3(0x236),'id_transaction_from':_0x5175c3(0x22c),'date':_0x5175c3(0x231),'production_date':_0x5175c3(0x20d),'expiry_date':_0x5175c3(0x1e5),'UOM':'$product.unit'}}]);_0x590d0f[_0x5175c3(0x21f)]>0x0&&_0x1d29c8[_0x5175c3(0x1e2)][_0x3fd4c0[_0x5175c3(0x244)]][_0x5175c3(0x201)](..._0x590d0f);}));})),_0x1d29c8['data_transfer']={},await Promise[_0x4a4b4a(0x223)](_0x1d29c8[_0x4a4b4a(0x21b)](async _0x29261d=>{var _0x43ae72=_0x4a4b4a;_0x1d29c8[_0x43ae72(0x20c)][_0x29261d[_0x43ae72(0x244)]]=[],await Promise[_0x43ae72(0x223)](_0x29261d['warehouse_data'][_0x43ae72(0x21b)](async _0x5c26ce=>{var _0x585a8b=_0x43ae72;const _0x43792c=await transfers_finished[_0x585a8b(0x1f7)]([{'$unwind':_0x585a8b(0x1f0)},{'$match':{'product.id_transaction':_0x5c26ce[_0x585a8b(0x1f9)][_0x585a8b(0x22f)](),'product.from_invoice':_0x5c26ce[_0x585a8b(0x244)]}},{'$project':{'_id':'$product._id','product_name':_0x585a8b(0x208),'product_code':_0x585a8b(0x202),'quantity_available':_0x585a8b(0x1ef),'warehouse_name':_0x585a8b(0x233),'warehouse_room':_0x585a8b(0x224),'product_invoice':_0x585a8b(0x203),'invoice':'$invoice','id_transaction_from':_0x585a8b(0x20a),'date':_0x585a8b(0x231),'production_date':_0x585a8b(0x20d),'expiry_date':_0x585a8b(0x1e5),'UOM':_0x585a8b(0x205)}}]);_0x43792c['length']>0x0&&_0x1d29c8[_0x585a8b(0x20c)][_0x29261d[_0x585a8b(0x244)]][_0x585a8b(0x201)](..._0x43792c);}));})),_0x3349cf[_0x4a4b4a(0x218)]({'purchases_warehouse':_0x1d29c8,'data_sales':_0x1d29c8['data_sales'],'data_adjustment':_0x1d29c8[_0x4a4b4a(0x1e2)],'data_transfer':_0x1d29c8['data_transfer']});}}}),router['get'](a0_0x137953(0x213),auth,async(_0x3326fe,_0x5f2ac6)=>{var _0xc80705=a0_0x137953;try{const _0x3d0124=_0x3326fe[_0xc80705(0x1dc)]['id'];var _0x5dacff=await purchases_finished['findById'](_0x3d0124);const _0x51e5c2=await master_shop[_0xc80705(0x23c)](),_0x3e4311=_0x3326fe[_0xc80705(0x242)],_0x43ddb8=await profile[_0xc80705(0x22b)]({'email':_0x3e4311[_0xc80705(0x210)]});if(_0x51e5c2[0x0]['language']==_0xc80705(0x1d9))var _0x289081=users['English'];else{if(_0x51e5c2[0x0][_0xc80705(0x23b)]==_0xc80705(0x20b))var _0x289081=users[_0xc80705(0x20b)];else{if(_0x51e5c2[0x0]['language']==_0xc80705(0x204))var _0x289081=users[_0xc80705(0x204)];else{if(_0x51e5c2[0x0][_0xc80705(0x23b)]==_0xc80705(0x212))var _0x289081=users[_0xc80705(0x212)];else{if(_0x51e5c2[0x0][_0xc80705(0x23b)]==_0xc80705(0x1fb))var _0x289081=users[_0xc80705(0x1fb)];else{if(_0x51e5c2[0x0][_0xc80705(0x23b)]==_0xc80705(0x1fa))var _0x289081=users[_0xc80705(0x240)];else{if(_0x51e5c2[0x0]['language']==_0xc80705(0x228))var _0x289081=users[_0xc80705(0x228)];else{if(_0x51e5c2[0x0]['language']=='Arabic\x20(ae)')var _0x289081=users[_0xc80705(0x20e)];}}}}}}}_0x5f2ac6[_0xc80705(0x23a)](_0xc80705(0x1f5),{'success':_0x3326fe[_0xc80705(0x232)](_0xc80705(0x216)),'errors':_0x3326fe[_0xc80705(0x232)]('errors'),'master_shop':_0x51e5c2,'profile':_0x43ddb8,'role':_0x3e4311,'language':_0x289081,'data':_0x5dacff});}catch(_0x33e511){_0x5f2ac6['json'](_0x33e511);}}),router[a0_0x137953(0x1d8)](a0_0x137953(0x1e3),auth,async(_0x26a31c,_0x162a9d)=>{var _0x349628=a0_0x137953;try{const _0x120104=_0x26a31c[_0x349628(0x1dc)]['id'];var _0x4f3f6e=await sales_finished['findById'](_0x120104);const _0x1785d0=await master_shop[_0x349628(0x23c)](),_0x37095b=_0x26a31c[_0x349628(0x242)],_0x35bb64=await profile[_0x349628(0x22b)]({'email':_0x37095b[_0x349628(0x210)]});if(_0x1785d0[0x0][_0x349628(0x23b)]==_0x349628(0x1d9))var _0x193dc1=users[_0x349628(0x238)];else{if(_0x1785d0[0x0][_0x349628(0x23b)]==_0x349628(0x20b))var _0x193dc1=users['Hindi'];else{if(_0x1785d0[0x0]['language']==_0x349628(0x204))var _0x193dc1=users['German'];else{if(_0x1785d0[0x0][_0x349628(0x23b)]==_0x349628(0x212))var _0x193dc1=users[_0x349628(0x212)];else{if(_0x1785d0[0x0]['language']==_0x349628(0x1fb))var _0x193dc1=users['French'];else{if(_0x1785d0[0x0]['language']=='Portuguese\x20(BR)')var _0x193dc1=users[_0x349628(0x240)];else{if(_0x1785d0[0x0]['language']==_0x349628(0x228))var _0x193dc1=users[_0x349628(0x228)];else{if(_0x1785d0[0x0][_0x349628(0x23b)]==_0x349628(0x1e8))var _0x193dc1=users[_0x349628(0x20e)];}}}}}}}_0x162a9d[_0x349628(0x23a)](_0x349628(0x21a),{'success':_0x26a31c[_0x349628(0x232)]('success'),'errors':_0x26a31c['flash'](_0x349628(0x206)),'master_shop':_0x1785d0,'profile':_0x35bb64,'role':_0x37095b,'language':_0x193dc1,'data':_0x4f3f6e});}catch(_0x5a1924){_0x162a9d[_0x349628(0x218)](_0x5a1924);}}),router['get']('/viewdata_tf_fg/:id',auth,async(_0x206b5e,_0x292f98)=>{var _0x4aea3f=a0_0x137953;try{const _0x4437ed=_0x206b5e['params']['id'];var _0x1725e5=await transfers_finished['findById'](_0x4437ed);const _0x1a223f=await master_shop[_0x4aea3f(0x23c)](),_0x666c1c=_0x206b5e[_0x4aea3f(0x242)],_0x364c33=await profile[_0x4aea3f(0x22b)]({'email':_0x666c1c[_0x4aea3f(0x210)]});if(_0x1a223f[0x0][_0x4aea3f(0x23b)]=='English\x20(US)')var _0x458812=users[_0x4aea3f(0x238)];else{if(_0x1a223f[0x0]['language']==_0x4aea3f(0x20b))var _0x458812=users[_0x4aea3f(0x20b)];else{if(_0x1a223f[0x0][_0x4aea3f(0x23b)]==_0x4aea3f(0x204))var _0x458812=users[_0x4aea3f(0x204)];else{if(_0x1a223f[0x0][_0x4aea3f(0x23b)]==_0x4aea3f(0x212))var _0x458812=users[_0x4aea3f(0x212)];else{if(_0x1a223f[0x0][_0x4aea3f(0x23b)]==_0x4aea3f(0x1fb))var _0x458812=users[_0x4aea3f(0x1fb)];else{if(_0x1a223f[0x0]['language']=='Portuguese\x20(BR)')var _0x458812=users[_0x4aea3f(0x240)];else{if(_0x1a223f[0x0]['language']==_0x4aea3f(0x228))var _0x458812=users[_0x4aea3f(0x228)];else{if(_0x1a223f[0x0]['language']=='Arabic\x20(ae)')var _0x458812=users['Arabic'];}}}}}}}_0x292f98[_0x4aea3f(0x23a)](_0x4aea3f(0x243),{'success':_0x206b5e[_0x4aea3f(0x232)](_0x4aea3f(0x216)),'errors':_0x206b5e[_0x4aea3f(0x232)](_0x4aea3f(0x206)),'master_shop':_0x1a223f,'profile':_0x364c33,'role':_0x666c1c,'language':_0x458812,'data':_0x1725e5});}catch(_0xe8ae8f){_0x292f98[_0x4aea3f(0x218)](_0xe8ae8f);}}),router[a0_0x137953(0x1d8)](a0_0x137953(0x20f),auth,async(_0x32263e,_0x4085e6)=>{var _0x30b113=a0_0x137953;try{const {username:_0x52cba0,email:_0x3397e2,role:_0x1982e3}=_0x32263e[_0x30b113(0x242)],_0x1186a4=_0x32263e[_0x30b113(0x242)],_0x37c0c5=await profile[_0x30b113(0x22b)]({'email':_0x1186a4[_0x30b113(0x210)]}),_0x2aca3a=await master_shop[_0x30b113(0x23c)](),_0x5ee3d2=await warehouse[_0x30b113(0x1f7)]([{'$match':{'status':'Enabled','warehouse_category':_0x30b113(0x21e)}},{'$group':{'_id':_0x30b113(0x200),'name':{'$first':_0x30b113(0x200)}}}]);if(_0x2aca3a[0x0]['language']=='English\x20(US)')var _0x27de03=users[_0x30b113(0x238)];else{if(_0x2aca3a[0x0][_0x30b113(0x23b)]==_0x30b113(0x20b))var _0x27de03=users[_0x30b113(0x20b)];else{if(_0x2aca3a[0x0]['language']==_0x30b113(0x204))var _0x27de03=users[_0x30b113(0x204)];else{if(_0x2aca3a[0x0][_0x30b113(0x23b)]==_0x30b113(0x212))var _0x27de03=users[_0x30b113(0x212)];else{if(_0x2aca3a[0x0]['language']==_0x30b113(0x1fb))var _0x27de03=users['French'];else{if(_0x2aca3a[0x0][_0x30b113(0x23b)]=='Portuguese\x20(BR)')var _0x27de03=users[_0x30b113(0x240)];else{if(_0x2aca3a[0x0][_0x30b113(0x23b)]=='Chinese')var _0x27de03=users[_0x30b113(0x228)];else{if(_0x2aca3a[0x0][_0x30b113(0x23b)]==_0x30b113(0x1e8))var _0x27de03=users[_0x30b113(0x20e)];}}}}}}}_0x4085e6[_0x30b113(0x23a)](_0x30b113(0x1fe),{'success':_0x32263e[_0x30b113(0x232)](_0x30b113(0x216)),'errors':_0x32263e[_0x30b113(0x232)](_0x30b113(0x206)),'role':_0x1186a4,'profile':_0x37c0c5,'master_shop':_0x2aca3a,'dataProcess':_0x5ee3d2,'language':_0x27de03});}catch(_0x4f29cd){console[_0x30b113(0x1f6)](_0x4f29cd);}}),module[a0_0x137953(0x1ff)]=router;