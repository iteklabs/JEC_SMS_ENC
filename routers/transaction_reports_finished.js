var a0_0x4cf982=a0_0x4a4b;function a0_0x4a4b(_0x5651b2,_0x422eea){var _0x3b1641=a0_0x3b16();return a0_0x4a4b=function(_0x4a4bc8,_0x4c6435){_0x4a4bc8=_0x4a4bc8-0xc9;var _0x398e4d=_0x3b1641[_0x4a4bc8];return _0x398e4d;},a0_0x4a4b(_0x5651b2,_0x422eea);}(function(_0x1a3d5b,_0x2cddf9){var _0x3c6923=a0_0x4a4b,_0x240c80=_0x1a3d5b();while(!![]){try{var _0x47aba0=parseInt(_0x3c6923(0x102))/0x1*(parseInt(_0x3c6923(0xe2))/0x2)+-parseInt(_0x3c6923(0xd1))/0x3+parseInt(_0x3c6923(0xca))/0x4+parseInt(_0x3c6923(0x12f))/0x5+-parseInt(_0x3c6923(0x105))/0x6*(parseInt(_0x3c6923(0xff))/0x7)+-parseInt(_0x3c6923(0xf9))/0x8*(parseInt(_0x3c6923(0x131))/0x9)+parseInt(_0x3c6923(0x11b))/0xa;if(_0x47aba0===_0x2cddf9)break;else _0x240c80['push'](_0x240c80['shift']());}catch(_0x91809e){_0x240c80['push'](_0x240c80['shift']());}}}(a0_0x3b16,0x72b87));const express=require(a0_0x4cf982(0x11c)),app=express(),router=express[a0_0x4cf982(0x12d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require('../models/all_models'),auth=require(a0_0x4cf982(0x122)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4cf982(0x134));function a0_0x3b16(){var _0x1da7e2=['$product._id','$product.unit','/viewFG','params','user','Router','get','243685qfebCn','body','50013YwpsAv','all','$product_details.expiry_date','nodemailer','render','1361764hnyMNo','$product.expiry_date','$sale_product.id_transaction_from','view_og_table','$date','success','German','1172208UtEYPI','$sale_product.room_name','language','/viewdata_og_fg/:id','$sale_product.invoice','json','findOne','English','$invoice','$$invoice','/viewdata_tf_fg/:id','email','data_adjustment','$product','$name','$product.id_transaction_from','$sale_product.product_code','196BVKHst','length','$to_warehouse','find','Chinese','/reports','$product.production_date','$warehouse_name','Arabic\x20(ae)','log','$product_details._id','$product_details.product_name','warehouse_data','Arabic','$sale_product','$sale_product.quantity','$product_details','$product_details.production_date','English\x20(US)','findById','$sale_product.production_date','/viewdata_inc_fg/:id','$sale_product.product_name','584WsGGpY','$product.to_quantity','$product_details.product_stock','$product.id_transaction_id','Portuguese\x20(BR)','$sale_product._id','35ciAafb','flash','$product.invoice','3317SuJAdf','map','$product.new_adjust_qty','1079328nnAdQE','$product.product_code','Enabled','view_tf_table','valueOf','$product_details.product_code','transaction_finished','aggregate','$product_details.invoice','$product.room_names','data_transfer','_id','$product.product_name','warehouses','$product.id_transaction','Hindi','$sale_product.unit','Spanish','$product_details.unit','view_table','transaction_finished_raw','$product.to_room_name','14514880GXWOFV','express','Raw\x20Materials','invoice','$sale_product.expiry_date','$room','exports','../middleware/auth','push','data_sales','Portuguese','French','errors'];a0_0x3b16=function(){return _0x1da7e2;};return a0_0x3b16();}router['get']('/view',auth,async(_0x41ffee,_0x10d6a0)=>{var _0xc85be8=a0_0x4cf982;try{const {username:_0x1df605,email:_0x2962c5,role:_0x2fdc17}=_0x41ffee[_0xc85be8(0x12c)],_0x3f4426=_0x41ffee[_0xc85be8(0x12c)],_0x563f85=await profile[_0xc85be8(0xd7)]({'email':_0x3f4426[_0xc85be8(0xdc)]}),_0x32b96b=await master_shop[_0xc85be8(0xe5)](),_0x19b159=await warehouse[_0xc85be8(0x10c)]([{'$match':{'status':_0xc85be8(0x107),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0xc85be8(0xdf),'name':{'$first':'$name'}}}]);if(_0x32b96b[0x0][_0xc85be8(0xd3)]==_0xc85be8(0xf4))var _0x5e4044=users[_0xc85be8(0xd8)];else{if(_0x32b96b[0x0]['language']==_0xc85be8(0x114))var _0x5e4044=users[_0xc85be8(0x114)];else{if(_0x32b96b[0x0][_0xc85be8(0xd3)]==_0xc85be8(0xd0))var _0x5e4044=users[_0xc85be8(0xd0)];else{if(_0x32b96b[0x0][_0xc85be8(0xd3)]=='Spanish')var _0x5e4044=users[_0xc85be8(0x116)];else{if(_0x32b96b[0x0][_0xc85be8(0xd3)]==_0xc85be8(0x126))var _0x5e4044=users[_0xc85be8(0x126)];else{if(_0x32b96b[0x0][_0xc85be8(0xd3)]==_0xc85be8(0xfd))var _0x5e4044=users[_0xc85be8(0x125)];else{if(_0x32b96b[0x0][_0xc85be8(0xd3)]==_0xc85be8(0xe6))var _0x5e4044=users[_0xc85be8(0xe6)];else{if(_0x32b96b[0x0]['language']=='Arabic\x20(ae)')var _0x5e4044=users[_0xc85be8(0xef)];}}}}}}}_0x10d6a0['render'](_0xc85be8(0x10b),{'success':_0x41ffee[_0xc85be8(0x100)]('success'),'errors':_0x41ffee[_0xc85be8(0x100)]('errors'),'role':_0x3f4426,'profile':_0x563f85,'master_shop':_0x32b96b,'dataProcess':_0x19b159,'language':_0x5e4044});}catch(_0x4c3f7e){console['log'](_0x4c3f7e);}}),router['post'](a0_0x4cf982(0xe7),auth,async(_0x402cf3,_0x10ae90)=>{var _0x233d95=a0_0x4cf982;const {product_category:_0x424f61,transaction_category:_0x194936,transaction_date_from:_0x24b72a,transaction_date_to:_0x3a62d0,warehouse_category:_0x4d1449,item_code:_0x53adbe}=_0x402cf3[_0x233d95(0x130)];console[_0x233d95(0xeb)](_0x4d1449);if(_0x424f61=='rm'){if(_0x4d1449==_0x233d95(0x132)){var _0x199bc5=await purchases[_0x233d95(0x10c)]([{'$match':{'date':{'$gte':_0x24b72a,'$lte':_0x3a62d0}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x233d95(0xd9)},'pipeline':[{'$unwind':_0x233d95(0xf2)},{'$match':{'$expr':{'$eq':[_0x233d95(0xda),_0x233d95(0x10d)]}}},{'$project':{'_id':_0x233d95(0xec),'product_name':'$product_details.product_name','product_code':_0x233d95(0x10a),'quantity_available':_0x233d95(0xfb),'warehouse_name':_0x233d95(0xdf),'warehouse_room':_0x233d95(0x120),'invoice':_0x233d95(0x10d),'production_date':'$product_details.production_date','expiry_date':_0x233d95(0x133),'UOM':_0x233d95(0x117)}}],'as':_0x233d95(0xee)}}]);_0x199bc5[_0x233d95(0x124)]={},await Promise[_0x233d95(0x132)](_0x199bc5[_0x233d95(0x103)](async _0x5a3f48=>{var _0x5909d5=_0x233d95;_0x199bc5['data_sales'][_0x5a3f48[_0x5909d5(0x11e)]]=[],await Promise[_0x5909d5(0x132)](_0x5a3f48[_0x5909d5(0xee)][_0x5909d5(0x103)](async _0x4f7458=>{var _0x59a67e=_0x5909d5;const _0x1e8ba4=await sales[_0x59a67e(0x10c)]([{'$unwind':_0x59a67e(0xf0)},{'$match':{'sale_product.id_transaction_from':_0x4f7458[_0x59a67e(0x110)][_0x59a67e(0x109)](),'sale_product.invoice':_0x4f7458[_0x59a67e(0x11e)]}},{'$project':{'_id':'$sale_product._id','product_name':'$sale_product.product_name','product_code':'$sale_product.product_code','quantity_available':_0x59a67e(0xf1),'warehouse_name':_0x59a67e(0xe9),'warehouse_room':_0x59a67e(0xd2),'product_invoice':_0x59a67e(0xd5),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0x59a67e(0xce),'production_date':'$sale_product.production_date','expiry_date':_0x59a67e(0x11f),'UOM':_0x59a67e(0x115)}}]);_0x1e8ba4[_0x59a67e(0xe3)]>0x0&&_0x199bc5['data_sales'][_0x5a3f48['invoice']][_0x59a67e(0x123)](..._0x1e8ba4);}));})),_0x199bc5['data_sales']=_0x199bc5['data_sales'],_0x199bc5['data_adjustment']={},await Promise[_0x233d95(0x132)](_0x199bc5['map'](async _0x578dd3=>{var _0x59c600=_0x233d95;_0x199bc5[_0x59c600(0xdd)][_0x578dd3['invoice']]=[],await Promise['all'](_0x578dd3[_0x59c600(0xee)][_0x59c600(0x103)](async _0x3ac424=>{var _0x4533b1=_0x59c600;const _0x37fe3f=await adjustment[_0x4533b1(0x10c)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x3ac424['_id'][_0x4533b1(0x109)](),'product.invoice':_0x3ac424[_0x4533b1(0x11e)]}},{'$project':{'_id':'$product._id','product_name':_0x4533b1(0x111),'product_code':_0x4533b1(0x106),'quantity_available':_0x4533b1(0x104),'warehouse_name':'$warehouse_name','warehouse_room':_0x4533b1(0x10e),'product_invoice':_0x4533b1(0x101),'invoice':_0x4533b1(0xd9),'id_transaction_from':_0x4533b1(0xe0),'date':_0x4533b1(0xce),'production_date':_0x4533b1(0xe8),'expiry_date':_0x4533b1(0xcb),'UOM':_0x4533b1(0x129)}}]);_0x37fe3f[_0x4533b1(0xe3)]>0x0&&_0x199bc5[_0x4533b1(0xdd)][_0x578dd3['invoice']]['push'](..._0x37fe3f);}));})),_0x199bc5[_0x233d95(0x10f)]={},await Promise[_0x233d95(0x132)](_0x199bc5['map'](async _0x4f2f65=>{var _0x48bced=_0x233d95;_0x199bc5[_0x48bced(0x10f)][_0x4f2f65[_0x48bced(0x11e)]]=[],await Promise[_0x48bced(0x132)](_0x4f2f65[_0x48bced(0xee)]['map'](async _0x2f7f79=>{var _0x88ee41=_0x48bced;const _0x1452d1=await transfers[_0x88ee41(0x10c)]([{'$unwind':_0x88ee41(0xde)},{'$match':{'product.id_transaction_id':_0x2f7f79[_0x88ee41(0x110)][_0x88ee41(0x109)](),'product.To_invoice':_0x2f7f79[_0x88ee41(0x11e)]}},{'$project':{'_id':_0x88ee41(0x128),'product_name':_0x88ee41(0x111),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x88ee41(0xe4),'warehouse_room':_0x88ee41(0x10e),'product_invoice':_0x88ee41(0x11a),'invoice':'$invoice','id_transaction_from':_0x88ee41(0xfc),'date':'$date','production_date':'$product.production_date','expiry_date':_0x88ee41(0xcb),'UOM':'$product.unit'}}]);_0x1452d1['length']>0x0&&_0x199bc5[_0x88ee41(0x10f)][_0x4f2f65[_0x88ee41(0x11e)]][_0x88ee41(0x123)](..._0x1452d1);}));})),_0x10ae90[_0x233d95(0xd6)]({'purchases_warehouse':_0x199bc5,'data_sales':_0x199bc5['data_sales'],'data_adjustment':_0x199bc5[_0x233d95(0xdd)],'data_transfer':_0x199bc5[_0x233d95(0x10f)]});}else{var _0x199bc5=await purchases[_0x233d95(0x10c)]([{'$match':{'warehouse_name':_0x4d1449,'date':{'$gte':_0x24b72a,'$lte':_0x3a62d0}}},{'$lookup':{'from':_0x233d95(0x112),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x233d95(0xf2)},{'$match':{'$expr':{'$eq':[_0x233d95(0xda),'$product_details.invoice']}}},{'$project':{'_id':_0x233d95(0xec),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':_0x233d95(0xfb),'warehouse_name':'$name','warehouse_room':'$room','invoice':_0x233d95(0x10d),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x233d95(0x117)}}],'as':_0x233d95(0xee)}}]);_0x199bc5[_0x233d95(0x124)]={},await Promise[_0x233d95(0x132)](_0x199bc5[_0x233d95(0x103)](async _0x587e1e=>{var _0x307253=_0x233d95;_0x199bc5[_0x307253(0x124)][_0x587e1e['invoice']]=[],await Promise['all'](_0x587e1e[_0x307253(0xee)][_0x307253(0x103)](async _0x3f6f98=>{var _0x36f87e=_0x307253;const _0x5736d5=await sales['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x3f6f98[_0x36f87e(0x110)][_0x36f87e(0x109)](),'sale_product.invoice':_0x3f6f98[_0x36f87e(0x11e)]}},{'$project':{'_id':_0x36f87e(0xfe),'product_name':_0x36f87e(0xf8),'product_code':_0x36f87e(0xe1),'quantity_available':_0x36f87e(0xf1),'warehouse_name':_0x36f87e(0xe9),'warehouse_room':_0x36f87e(0xd2),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x36f87e(0xcc),'date':_0x36f87e(0xce),'production_date':_0x36f87e(0xf6),'expiry_date':_0x36f87e(0x11f),'UOM':_0x36f87e(0x115)}}]);_0x5736d5[_0x36f87e(0xe3)]>0x0&&_0x199bc5[_0x36f87e(0x124)][_0x587e1e[_0x36f87e(0x11e)]][_0x36f87e(0x123)](..._0x5736d5);}));})),_0x199bc5['data_sales']=_0x199bc5[_0x233d95(0x124)],_0x199bc5['data_adjustment']={},await Promise[_0x233d95(0x132)](_0x199bc5[_0x233d95(0x103)](async _0x593ca0=>{var _0x5e5f96=_0x233d95;_0x199bc5['data_adjustment'][_0x593ca0[_0x5e5f96(0x11e)]]=[],await Promise[_0x5e5f96(0x132)](_0x593ca0[_0x5e5f96(0xee)][_0x5e5f96(0x103)](async _0x21f37e=>{var _0x53193b=_0x5e5f96;const _0x1339f0=await adjustment[_0x53193b(0x10c)]([{'$unwind':_0x53193b(0xde)},{'$match':{'product.id_transaction_from':_0x21f37e['_id'][_0x53193b(0x109)](),'product.invoice':_0x21f37e[_0x53193b(0x11e)]}},{'$project':{'_id':'$product._id','product_name':_0x53193b(0x111),'product_code':_0x53193b(0x106),'quantity_available':_0x53193b(0x104),'warehouse_name':_0x53193b(0xe9),'warehouse_room':_0x53193b(0x10e),'product_invoice':'$product.invoice','invoice':_0x53193b(0xd9),'id_transaction_from':_0x53193b(0xe0),'date':_0x53193b(0xce),'production_date':_0x53193b(0xe8),'expiry_date':_0x53193b(0xcb),'UOM':_0x53193b(0x129)}}]);_0x1339f0[_0x53193b(0xe3)]>0x0&&_0x199bc5[_0x53193b(0xdd)][_0x593ca0[_0x53193b(0x11e)]]['push'](..._0x1339f0);}));})),_0x199bc5[_0x233d95(0x10f)]={},await Promise[_0x233d95(0x132)](_0x199bc5[_0x233d95(0x103)](async _0x4e3388=>{var _0x434ea9=_0x233d95;_0x199bc5['data_transfer'][_0x4e3388['invoice']]=[],await Promise['all'](_0x4e3388[_0x434ea9(0xee)][_0x434ea9(0x103)](async _0x381174=>{var _0x58b7b6=_0x434ea9;const _0x3eb91d=await transfers[_0x58b7b6(0x10c)]([{'$unwind':_0x58b7b6(0xde)},{'$match':{'product.id_transaction_id':_0x381174['_id']['valueOf'](),'product.To_invoice':_0x381174[_0x58b7b6(0x11e)]}},{'$project':{'_id':_0x58b7b6(0x128),'product_name':_0x58b7b6(0x111),'product_code':_0x58b7b6(0x106),'quantity_available':_0x58b7b6(0xfa),'warehouse_name':'$to_warehouse','warehouse_room':'$product.room_names','product_invoice':'$product.to_room_name','invoice':_0x58b7b6(0xd9),'id_transaction_from':'$product.id_transaction_id','date':_0x58b7b6(0xce),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0x58b7b6(0x129)}}]);_0x3eb91d[_0x58b7b6(0xe3)]>0x0&&_0x199bc5['data_transfer'][_0x4e3388[_0x58b7b6(0x11e)]]['push'](..._0x3eb91d);}));})),_0x10ae90[_0x233d95(0xd6)]({'purchases_warehouse':_0x199bc5,'data_sales':_0x199bc5[_0x233d95(0x124)],'data_adjustment':_0x199bc5[_0x233d95(0xdd)],'data_transfer':_0x199bc5['data_transfer']});}}else{if(_0x4d1449==_0x233d95(0x132)){var _0x199bc5=await purchases_finished[_0x233d95(0x10c)]([{'$match':{'date':{'$gte':_0x24b72a,'$lte':_0x3a62d0}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x233d95(0xd9)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x233d95(0xda),_0x233d95(0x10d)]}}},{'$project':{'_id':_0x233d95(0xec),'product_name':_0x233d95(0xed),'product_code':_0x233d95(0x10a),'quantity_available':'$product_details.product_stock','warehouse_name':_0x233d95(0xdf),'warehouse_room':'$room','invoice':_0x233d95(0x10d),'production_date':_0x233d95(0xf3),'expiry_date':_0x233d95(0x133),'UOM':_0x233d95(0x117)}}],'as':_0x233d95(0xee)}}]);_0x199bc5['data_sales']={},await Promise[_0x233d95(0x132)](_0x199bc5['map'](async _0x39c379=>{var _0x4f2581=_0x233d95;_0x199bc5[_0x4f2581(0x124)][_0x39c379[_0x4f2581(0x11e)]]=[],await Promise[_0x4f2581(0x132)](_0x39c379['warehouse_data']['map'](async _0x108aeb=>{var _0x45bf22=_0x4f2581;const _0x30b593=await sales_finished[_0x45bf22(0x10c)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x108aeb['_id'][_0x45bf22(0x109)](),'sale_product.invoice':_0x108aeb[_0x45bf22(0x11e)]}},{'$project':{'_id':_0x45bf22(0xfe),'product_name':_0x45bf22(0xf8),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x45bf22(0xe9),'warehouse_room':_0x45bf22(0xd2),'product_invoice':_0x45bf22(0xd5),'invoice':_0x45bf22(0xd9),'id_transaction_from':_0x45bf22(0xcc),'date':_0x45bf22(0xce),'production_date':_0x45bf22(0xf6),'expiry_date':'$sale_product.expiry_date','UOM':_0x45bf22(0x115)}}]);_0x30b593['length']>0x0&&_0x199bc5[_0x45bf22(0x124)][_0x39c379[_0x45bf22(0x11e)]][_0x45bf22(0x123)](..._0x30b593);}));})),_0x199bc5[_0x233d95(0x124)]=_0x199bc5['data_sales'],_0x199bc5[_0x233d95(0xdd)]={},await Promise[_0x233d95(0x132)](_0x199bc5[_0x233d95(0x103)](async _0x1c7818=>{var _0x18d847=_0x233d95;_0x199bc5[_0x18d847(0xdd)][_0x1c7818[_0x18d847(0x11e)]]=[],await Promise[_0x18d847(0x132)](_0x1c7818[_0x18d847(0xee)][_0x18d847(0x103)](async _0x40b131=>{var _0x11cef3=_0x18d847;const _0x510d4b=await adjustment_finished[_0x11cef3(0x10c)]([{'$unwind':_0x11cef3(0xde)},{'$match':{'product.id_transaction_from':_0x40b131['_id']['valueOf'](),'product.invoice':_0x40b131[_0x11cef3(0x11e)]}},{'$project':{'_id':'$product._id','product_name':_0x11cef3(0x111),'product_code':_0x11cef3(0x106),'quantity_available':_0x11cef3(0x104),'warehouse_name':'$warehouse_name','warehouse_room':_0x11cef3(0x10e),'product_invoice':'$product.invoice','invoice':_0x11cef3(0xd9),'id_transaction_from':_0x11cef3(0xe0),'date':_0x11cef3(0xce),'production_date':_0x11cef3(0xe8),'expiry_date':'$product.expiry_date','UOM':_0x11cef3(0x129)}}]);_0x510d4b[_0x11cef3(0xe3)]>0x0&&_0x199bc5[_0x11cef3(0xdd)][_0x1c7818['invoice']]['push'](..._0x510d4b);}));})),_0x199bc5[_0x233d95(0x10f)]={},await Promise[_0x233d95(0x132)](_0x199bc5[_0x233d95(0x103)](async _0x18f610=>{var _0x40b038=_0x233d95;_0x199bc5[_0x40b038(0x10f)][_0x18f610['invoice']]=[],await Promise[_0x40b038(0x132)](_0x18f610['warehouse_data'][_0x40b038(0x103)](async _0x1a3489=>{var _0xb948c4=_0x40b038;const _0x5b6d01=await transfers_finished[_0xb948c4(0x10c)]([{'$unwind':_0xb948c4(0xde)},{'$match':{'product.id_transaction':_0x1a3489[_0xb948c4(0x110)][_0xb948c4(0x109)](),'product.from_invoice':_0x1a3489['invoice']}},{'$project':{'_id':_0xb948c4(0x128),'product_name':_0xb948c4(0x111),'product_code':_0xb948c4(0x106),'quantity_available':'$product.to_quantity','warehouse_name':_0xb948c4(0xe4),'warehouse_room':_0xb948c4(0x10e),'product_invoice':_0xb948c4(0x11a),'invoice':_0xb948c4(0xd9),'id_transaction_from':_0xb948c4(0x113),'date':_0xb948c4(0xce),'production_date':_0xb948c4(0xe8),'expiry_date':'$product.expiry_date','UOM':_0xb948c4(0x129)}}]);_0x5b6d01['length']>0x0&&_0x199bc5[_0xb948c4(0x10f)][_0x18f610[_0xb948c4(0x11e)]][_0xb948c4(0x123)](..._0x5b6d01);}));})),_0x10ae90[_0x233d95(0xd6)]({'purchases_warehouse':_0x199bc5,'data_sales':_0x199bc5[_0x233d95(0x124)],'data_adjustment':_0x199bc5['data_adjustment'],'data_transfer':_0x199bc5[_0x233d95(0x10f)]});}else{var _0x199bc5=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x4d1449,'date':{'$gte':_0x24b72a,'$lte':_0x3a62d0}}},{'$lookup':{'from':_0x233d95(0x112),'let':{'invoice':_0x233d95(0xd9)},'pipeline':[{'$unwind':_0x233d95(0xf2)},{'$match':{'$expr':{'$eq':[_0x233d95(0xda),_0x233d95(0x10d)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x233d95(0xed),'product_code':_0x233d95(0x10a),'quantity_available':_0x233d95(0xfb),'warehouse_name':_0x233d95(0xdf),'warehouse_room':_0x233d95(0x120),'invoice':_0x233d95(0x10d),'production_date':_0x233d95(0xf3),'expiry_date':_0x233d95(0x133),'UOM':_0x233d95(0x117)}}],'as':_0x233d95(0xee)}}]);_0x199bc5['data_sales']={},await Promise[_0x233d95(0x132)](_0x199bc5[_0x233d95(0x103)](async _0x3dafbd=>{var _0x5d75e0=_0x233d95;_0x199bc5[_0x5d75e0(0x124)][_0x3dafbd[_0x5d75e0(0x11e)]]=[],await Promise[_0x5d75e0(0x132)](_0x3dafbd[_0x5d75e0(0xee)]['map'](async _0x4cfadd=>{var _0x3cf0d9=_0x5d75e0;const _0x33fd40=await sales_finished[_0x3cf0d9(0x10c)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x4cfadd[_0x3cf0d9(0x110)]['valueOf'](),'sale_product.invoice':_0x4cfadd[_0x3cf0d9(0x11e)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x3cf0d9(0xf8),'product_code':'$sale_product.product_code','quantity_available':_0x3cf0d9(0xf1),'warehouse_name':'$warehouse_name','warehouse_room':_0x3cf0d9(0xd2),'product_invoice':_0x3cf0d9(0xd5),'invoice':'$invoice','id_transaction_from':_0x3cf0d9(0xcc),'date':_0x3cf0d9(0xce),'production_date':'$sale_product.production_date','expiry_date':_0x3cf0d9(0x11f),'UOM':'$sale_product.unit'}}]);_0x33fd40[_0x3cf0d9(0xe3)]>0x0&&_0x199bc5['data_sales'][_0x3dafbd['invoice']]['push'](..._0x33fd40);}));})),_0x199bc5[_0x233d95(0x124)]=_0x199bc5['data_sales'],_0x199bc5['data_adjustment']={},await Promise[_0x233d95(0x132)](_0x199bc5['map'](async _0x4a1a6b=>{var _0x146f5b=_0x233d95;_0x199bc5[_0x146f5b(0xdd)][_0x4a1a6b['invoice']]=[],await Promise[_0x146f5b(0x132)](_0x4a1a6b[_0x146f5b(0xee)]['map'](async _0x51f4e9=>{var _0x31e804=_0x146f5b;const _0x115f10=await adjustment_finished[_0x31e804(0x10c)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x51f4e9[_0x31e804(0x110)][_0x31e804(0x109)](),'product.invoice':_0x51f4e9[_0x31e804(0x11e)]}},{'$project':{'_id':_0x31e804(0x128),'product_name':_0x31e804(0x111),'product_code':_0x31e804(0x106),'quantity_available':_0x31e804(0x104),'warehouse_name':'$warehouse_name','warehouse_room':_0x31e804(0x10e),'product_invoice':_0x31e804(0x101),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':_0x31e804(0xce),'production_date':_0x31e804(0xe8),'expiry_date':_0x31e804(0xcb),'UOM':_0x31e804(0x129)}}]);_0x115f10[_0x31e804(0xe3)]>0x0&&_0x199bc5[_0x31e804(0xdd)][_0x4a1a6b[_0x31e804(0x11e)]][_0x31e804(0x123)](..._0x115f10);}));})),_0x199bc5[_0x233d95(0x10f)]={},await Promise[_0x233d95(0x132)](_0x199bc5[_0x233d95(0x103)](async _0x2319ca=>{var _0x3cd245=_0x233d95;_0x199bc5[_0x3cd245(0x10f)][_0x2319ca[_0x3cd245(0x11e)]]=[],await Promise[_0x3cd245(0x132)](_0x2319ca[_0x3cd245(0xee)]['map'](async _0x496bbf=>{var _0x596778=_0x3cd245;const _0x5632c5=await transfers_finished[_0x596778(0x10c)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x496bbf[_0x596778(0x110)][_0x596778(0x109)](),'product.from_invoice':_0x496bbf[_0x596778(0x11e)]}},{'$project':{'_id':_0x596778(0x128),'product_name':'$product.product_name','product_code':_0x596778(0x106),'quantity_available':'$product.to_quantity','warehouse_name':_0x596778(0xe4),'warehouse_room':_0x596778(0x10e),'product_invoice':'$product.to_room_name','invoice':_0x596778(0xd9),'id_transaction_from':_0x596778(0x113),'date':_0x596778(0xce),'production_date':_0x596778(0xe8),'expiry_date':_0x596778(0xcb),'UOM':_0x596778(0x129)}}]);_0x5632c5[_0x596778(0xe3)]>0x0&&_0x199bc5[_0x596778(0x10f)][_0x2319ca[_0x596778(0x11e)]][_0x596778(0x123)](..._0x5632c5);}));})),_0x10ae90['json']({'purchases_warehouse':_0x199bc5,'data_sales':_0x199bc5[_0x233d95(0x124)],'data_adjustment':_0x199bc5[_0x233d95(0xdd)],'data_transfer':_0x199bc5[_0x233d95(0x10f)]});}}}),router[a0_0x4cf982(0x12e)](a0_0x4cf982(0xf7),auth,async(_0x34efa5,_0x18c83a)=>{var _0x4919a0=a0_0x4cf982;try{const _0x1a376b=_0x34efa5[_0x4919a0(0x12b)]['id'];var _0x5d14fa=await purchases_finished[_0x4919a0(0xf5)](_0x1a376b);const _0x4d7c5c=await master_shop[_0x4919a0(0xe5)](),_0x10319b=_0x34efa5[_0x4919a0(0x12c)],_0x29c94a=await profile[_0x4919a0(0xd7)]({'email':_0x10319b['email']});if(_0x4d7c5c[0x0][_0x4919a0(0xd3)]==_0x4919a0(0xf4))var _0x31c32c=users['English'];else{if(_0x4d7c5c[0x0][_0x4919a0(0xd3)]==_0x4919a0(0x114))var _0x31c32c=users[_0x4919a0(0x114)];else{if(_0x4d7c5c[0x0][_0x4919a0(0xd3)]==_0x4919a0(0xd0))var _0x31c32c=users[_0x4919a0(0xd0)];else{if(_0x4d7c5c[0x0][_0x4919a0(0xd3)]==_0x4919a0(0x116))var _0x31c32c=users['Spanish'];else{if(_0x4d7c5c[0x0][_0x4919a0(0xd3)]==_0x4919a0(0x126))var _0x31c32c=users['French'];else{if(_0x4d7c5c[0x0]['language']=='Portuguese\x20(BR)')var _0x31c32c=users[_0x4919a0(0x125)];else{if(_0x4d7c5c[0x0][_0x4919a0(0xd3)]==_0x4919a0(0xe6))var _0x31c32c=users[_0x4919a0(0xe6)];else{if(_0x4d7c5c[0x0][_0x4919a0(0xd3)]=='Arabic\x20(ae)')var _0x31c32c=users['Arabic'];}}}}}}}_0x18c83a[_0x4919a0(0xc9)](_0x4919a0(0x118),{'success':_0x34efa5[_0x4919a0(0x100)]('success'),'errors':_0x34efa5['flash'](_0x4919a0(0x127)),'master_shop':_0x4d7c5c,'profile':_0x29c94a,'role':_0x10319b,'language':_0x31c32c,'data':_0x5d14fa});}catch(_0x594718){_0x18c83a['json'](_0x594718);}}),router[a0_0x4cf982(0x12e)](a0_0x4cf982(0xd4),auth,async(_0x3b30dc,_0x3a71ac)=>{var _0x79e0b0=a0_0x4cf982;try{const _0x2b3beb=_0x3b30dc[_0x79e0b0(0x12b)]['id'];var _0x208e5b=await sales_finished[_0x79e0b0(0xf5)](_0x2b3beb);const _0x42444c=await master_shop[_0x79e0b0(0xe5)](),_0x54483d=_0x3b30dc[_0x79e0b0(0x12c)],_0x50ed35=await profile[_0x79e0b0(0xd7)]({'email':_0x54483d[_0x79e0b0(0xdc)]});if(_0x42444c[0x0][_0x79e0b0(0xd3)]==_0x79e0b0(0xf4))var _0x31d79c=users[_0x79e0b0(0xd8)];else{if(_0x42444c[0x0][_0x79e0b0(0xd3)]==_0x79e0b0(0x114))var _0x31d79c=users['Hindi'];else{if(_0x42444c[0x0][_0x79e0b0(0xd3)]==_0x79e0b0(0xd0))var _0x31d79c=users[_0x79e0b0(0xd0)];else{if(_0x42444c[0x0]['language']==_0x79e0b0(0x116))var _0x31d79c=users['Spanish'];else{if(_0x42444c[0x0][_0x79e0b0(0xd3)]==_0x79e0b0(0x126))var _0x31d79c=users[_0x79e0b0(0x126)];else{if(_0x42444c[0x0][_0x79e0b0(0xd3)]==_0x79e0b0(0xfd))var _0x31d79c=users['Portuguese'];else{if(_0x42444c[0x0][_0x79e0b0(0xd3)]==_0x79e0b0(0xe6))var _0x31d79c=users['Chinese'];else{if(_0x42444c[0x0][_0x79e0b0(0xd3)]=='Arabic\x20(ae)')var _0x31d79c=users['Arabic'];}}}}}}}_0x3a71ac[_0x79e0b0(0xc9)](_0x79e0b0(0xcd),{'success':_0x3b30dc[_0x79e0b0(0x100)]('success'),'errors':_0x3b30dc['flash']('errors'),'master_shop':_0x42444c,'profile':_0x50ed35,'role':_0x54483d,'language':_0x31d79c,'data':_0x208e5b});}catch(_0x27a85a){_0x3a71ac[_0x79e0b0(0xd6)](_0x27a85a);}}),router[a0_0x4cf982(0x12e)](a0_0x4cf982(0xdb),auth,async(_0x3f3ca7,_0x181bfb)=>{var _0x45ffba=a0_0x4cf982;try{const _0x455d48=_0x3f3ca7[_0x45ffba(0x12b)]['id'];var _0x16c26e=await transfers_finished[_0x45ffba(0xf5)](_0x455d48);const _0x1811f2=await master_shop[_0x45ffba(0xe5)](),_0x17c591=_0x3f3ca7[_0x45ffba(0x12c)],_0x223635=await profile[_0x45ffba(0xd7)]({'email':_0x17c591[_0x45ffba(0xdc)]});if(_0x1811f2[0x0][_0x45ffba(0xd3)]==_0x45ffba(0xf4))var _0x5eb46a=users['English'];else{if(_0x1811f2[0x0]['language']==_0x45ffba(0x114))var _0x5eb46a=users['Hindi'];else{if(_0x1811f2[0x0][_0x45ffba(0xd3)]==_0x45ffba(0xd0))var _0x5eb46a=users['German'];else{if(_0x1811f2[0x0][_0x45ffba(0xd3)]=='Spanish')var _0x5eb46a=users[_0x45ffba(0x116)];else{if(_0x1811f2[0x0][_0x45ffba(0xd3)]==_0x45ffba(0x126))var _0x5eb46a=users['French'];else{if(_0x1811f2[0x0][_0x45ffba(0xd3)]=='Portuguese\x20(BR)')var _0x5eb46a=users[_0x45ffba(0x125)];else{if(_0x1811f2[0x0][_0x45ffba(0xd3)]=='Chinese')var _0x5eb46a=users[_0x45ffba(0xe6)];else{if(_0x1811f2[0x0][_0x45ffba(0xd3)]==_0x45ffba(0xea))var _0x5eb46a=users[_0x45ffba(0xef)];}}}}}}}_0x181bfb[_0x45ffba(0xc9)](_0x45ffba(0x108),{'success':_0x3f3ca7['flash'](_0x45ffba(0xcf)),'errors':_0x3f3ca7[_0x45ffba(0x100)](_0x45ffba(0x127)),'master_shop':_0x1811f2,'profile':_0x223635,'role':_0x17c591,'language':_0x5eb46a,'data':_0x16c26e});}catch(_0xb233cb){_0x181bfb[_0x45ffba(0xd6)](_0xb233cb);}}),router[a0_0x4cf982(0x12e)](a0_0x4cf982(0x12a),auth,async(_0x5a4e45,_0x12112c)=>{var _0x5dc512=a0_0x4cf982;try{const {username:_0x3fa2f1,email:_0x1ebe5b,role:_0x1bfcc8}=_0x5a4e45[_0x5dc512(0x12c)],_0x10cfde=_0x5a4e45[_0x5dc512(0x12c)],_0x1e8596=await profile[_0x5dc512(0xd7)]({'email':_0x10cfde[_0x5dc512(0xdc)]}),_0x3a82c6=await master_shop[_0x5dc512(0xe5)](),_0x409588=await warehouse[_0x5dc512(0x10c)]([{'$match':{'status':_0x5dc512(0x107),'warehouse_category':_0x5dc512(0x11d)}},{'$group':{'_id':_0x5dc512(0xdf),'name':{'$first':'$name'}}}]);if(_0x3a82c6[0x0]['language']==_0x5dc512(0xf4))var _0x31d38f=users[_0x5dc512(0xd8)];else{if(_0x3a82c6[0x0][_0x5dc512(0xd3)]==_0x5dc512(0x114))var _0x31d38f=users[_0x5dc512(0x114)];else{if(_0x3a82c6[0x0][_0x5dc512(0xd3)]==_0x5dc512(0xd0))var _0x31d38f=users['German'];else{if(_0x3a82c6[0x0][_0x5dc512(0xd3)]==_0x5dc512(0x116))var _0x31d38f=users['Spanish'];else{if(_0x3a82c6[0x0][_0x5dc512(0xd3)]==_0x5dc512(0x126))var _0x31d38f=users['French'];else{if(_0x3a82c6[0x0][_0x5dc512(0xd3)]=='Portuguese\x20(BR)')var _0x31d38f=users[_0x5dc512(0x125)];else{if(_0x3a82c6[0x0]['language']=='Chinese')var _0x31d38f=users[_0x5dc512(0xe6)];else{if(_0x3a82c6[0x0]['language']=='Arabic\x20(ae)')var _0x31d38f=users[_0x5dc512(0xef)];}}}}}}}_0x12112c[_0x5dc512(0xc9)](_0x5dc512(0x119),{'success':_0x5a4e45[_0x5dc512(0x100)]('success'),'errors':_0x5a4e45['flash']('errors'),'role':_0x10cfde,'profile':_0x1e8596,'master_shop':_0x3a82c6,'dataProcess':_0x409588,'language':_0x31d38f});}catch(_0x399897){console[_0x5dc512(0xeb)](_0x399897);}}),module[a0_0x4cf982(0x121)]=router;