var a0_0x1fcca4=a0_0x68fe;function a0_0x68fe(_0x275c8a,_0x1d57a4){var _0x5e8554=a0_0x5e85();return a0_0x68fe=function(_0x68feb1,_0x3b8150){_0x68feb1=_0x68feb1-0x135;var _0x281019=_0x5e8554[_0x68feb1];return _0x281019;},a0_0x68fe(_0x275c8a,_0x1d57a4);}(function(_0x50a5d4,_0x3803bd){var _0x761197=a0_0x68fe,_0xae8a95=_0x50a5d4();while(!![]){try{var _0x24ede5=-parseInt(_0x761197(0x19a))/0x1+-parseInt(_0x761197(0x14c))/0x2*(parseInt(_0x761197(0x15d))/0x3)+parseInt(_0x761197(0x14d))/0x4+parseInt(_0x761197(0x192))/0x5+-parseInt(_0x761197(0x19e))/0x6*(-parseInt(_0x761197(0x158))/0x7)+-parseInt(_0x761197(0x17d))/0x8*(parseInt(_0x761197(0x142))/0x9)+parseInt(_0x761197(0x151))/0xa*(parseInt(_0x761197(0x15b))/0xb);if(_0x24ede5===_0x3803bd)break;else _0xae8a95['push'](_0xae8a95['shift']());}catch(_0x2b3cc7){_0xae8a95['push'](_0xae8a95['shift']());}}}(a0_0x5e85,0xea251));const express=require(a0_0x1fcca4(0x14e)),app=express(),router=express[a0_0x1fcca4(0x146)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x1fcca4(0x17e)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x1fcca4(0x13a));router[a0_0x1fcca4(0x175)](a0_0x1fcca4(0x188),auth,async(_0x2ea573,_0x1b8e4f)=>{var _0x30d6dd=a0_0x1fcca4;try{const {username:_0x36c6f7,email:_0xba7fd,role:_0x2fe95c}=_0x2ea573['user'],_0x2baefe=_0x2ea573[_0x30d6dd(0x186)],_0x39a241=await profile[_0x30d6dd(0x143)]({'email':_0x2baefe['email']}),_0x4f61c7=await master_shop[_0x30d6dd(0x139)](),_0x2c816d=await warehouse['aggregate']([{'$match':{'status':_0x30d6dd(0x140),'warehouse_category':_0x30d6dd(0x172)}},{'$group':{'_id':_0x30d6dd(0x136),'name':{'$first':_0x30d6dd(0x136)}}}]);if(_0x4f61c7[0x0][_0x30d6dd(0x184)]==_0x30d6dd(0x167))var _0x1075c5=users[_0x30d6dd(0x15c)];else{if(_0x4f61c7[0x0][_0x30d6dd(0x184)]=='Hindi')var _0x1075c5=users['Hindi'];else{if(_0x4f61c7[0x0][_0x30d6dd(0x184)]==_0x30d6dd(0x19c))var _0x1075c5=users[_0x30d6dd(0x19c)];else{if(_0x4f61c7[0x0][_0x30d6dd(0x184)]==_0x30d6dd(0x16f))var _0x1075c5=users[_0x30d6dd(0x16f)];else{if(_0x4f61c7[0x0][_0x30d6dd(0x184)]==_0x30d6dd(0x14b))var _0x1075c5=users[_0x30d6dd(0x14b)];else{if(_0x4f61c7[0x0][_0x30d6dd(0x184)]==_0x30d6dd(0x17f))var _0x1075c5=users[_0x30d6dd(0x187)];else{if(_0x4f61c7[0x0][_0x30d6dd(0x184)]=='Chinese')var _0x1075c5=users[_0x30d6dd(0x180)];else{if(_0x4f61c7[0x0][_0x30d6dd(0x184)]==_0x30d6dd(0x16e))var _0x1075c5=users[_0x30d6dd(0x195)];}}}}}}}_0x1b8e4f[_0x30d6dd(0x1a2)](_0x30d6dd(0x157),{'success':_0x2ea573[_0x30d6dd(0x14a)]('success'),'errors':_0x2ea573[_0x30d6dd(0x14a)]('errors'),'role':_0x2baefe,'profile':_0x39a241,'master_shop':_0x4f61c7,'dataProcess':_0x2c816d,'language':_0x1075c5});}catch(_0x40ca79){console[_0x30d6dd(0x165)](_0x40ca79);}}),router[a0_0x1fcca4(0x185)](a0_0x1fcca4(0x191),auth,async(_0x4eb733,_0x233297)=>{var _0x5b0a24=a0_0x1fcca4;const {product_category:_0x593e4b,transaction_category:_0x1c8afe,transaction_date_from:_0x3eebfb,transaction_date_to:_0x174e04,warehouse_category:_0x48b5d4,item_code:_0xcad159}=_0x4eb733['body'];console[_0x5b0a24(0x165)](_0x48b5d4);if(_0x593e4b=='rm'){if(_0x48b5d4==_0x5b0a24(0x150)){var _0x5cbec3=await purchases[_0x5b0a24(0x141)]([{'$match':{'date':{'$gte':_0x3eebfb,'$lte':_0x174e04}}},{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x5b0a24(0x159)},{'$match':{'$expr':{'$eq':[_0x5b0a24(0x182),_0x5b0a24(0x193)]}}},{'$project':{'_id':_0x5b0a24(0x190),'product_name':'$product_details.product_name','product_code':_0x5b0a24(0x155),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':_0x5b0a24(0x1a1),'invoice':_0x5b0a24(0x193),'production_date':_0x5b0a24(0x18c),'expiry_date':_0x5b0a24(0x199),'UOM':_0x5b0a24(0x156)}}],'as':_0x5b0a24(0x169)}}]);_0x5cbec3[_0x5b0a24(0x13c)]={},await Promise[_0x5b0a24(0x150)](_0x5cbec3[_0x5b0a24(0x16b)](async _0x3a6291=>{var _0x316561=_0x5b0a24;_0x5cbec3[_0x316561(0x13c)][_0x3a6291[_0x316561(0x173)]]=[],await Promise[_0x316561(0x150)](_0x3a6291[_0x316561(0x169)]['map'](async _0x37c21e=>{var _0x4e9854=_0x316561;const _0x3b4c46=await sales['aggregate']([{'$unwind':_0x4e9854(0x170)},{'$match':{'sale_product.id_transaction_from':_0x37c21e[_0x4e9854(0x178)][_0x4e9854(0x197)](),'sale_product.invoice':_0x37c21e[_0x4e9854(0x173)]}},{'$project':{'_id':_0x4e9854(0x163),'product_name':_0x4e9854(0x162),'product_code':_0x4e9854(0x19d),'quantity_available':_0x4e9854(0x198),'warehouse_name':'$warehouse_name','warehouse_room':_0x4e9854(0x18e),'product_invoice':_0x4e9854(0x153),'invoice':_0x4e9854(0x18b),'id_transaction_from':_0x4e9854(0x1a0),'date':_0x4e9854(0x194),'production_date':'$sale_product.production_date','expiry_date':_0x4e9854(0x179),'UOM':_0x4e9854(0x183)}}]);_0x3b4c46[_0x4e9854(0x13e)]>0x0&&_0x5cbec3[_0x4e9854(0x13c)][_0x3a6291['invoice']][_0x4e9854(0x145)](..._0x3b4c46);}));})),_0x5cbec3['data_sales']=_0x5cbec3[_0x5b0a24(0x13c)],_0x5cbec3[_0x5b0a24(0x168)]={},await Promise[_0x5b0a24(0x150)](_0x5cbec3[_0x5b0a24(0x16b)](async _0xe811a7=>{var _0x31ecc6=_0x5b0a24;_0x5cbec3[_0x31ecc6(0x168)][_0xe811a7['invoice']]=[],await Promise['all'](_0xe811a7[_0x31ecc6(0x169)][_0x31ecc6(0x16b)](async _0x13400a=>{var _0x5f073c=_0x31ecc6;const _0x4a499d=await adjustment[_0x5f073c(0x141)]([{'$unwind':_0x5f073c(0x161)},{'$match':{'product.id_transaction_from':_0x13400a[_0x5f073c(0x178)]['valueOf'](),'product.invoice':_0x13400a[_0x5f073c(0x173)]}},{'$project':{'_id':_0x5f073c(0x166),'product_name':_0x5f073c(0x17b),'product_code':_0x5f073c(0x16c),'quantity_available':_0x5f073c(0x174),'warehouse_name':'$warehouse_name','warehouse_room':_0x5f073c(0x15e),'product_invoice':_0x5f073c(0x19f),'invoice':'$invoice','id_transaction_from':_0x5f073c(0x164),'date':_0x5f073c(0x194),'production_date':'$product.production_date','expiry_date':_0x5f073c(0x148),'UOM':_0x5f073c(0x18d)}}]);_0x4a499d[_0x5f073c(0x13e)]>0x0&&_0x5cbec3[_0x5f073c(0x168)][_0xe811a7['invoice']][_0x5f073c(0x145)](..._0x4a499d);}));})),_0x5cbec3[_0x5b0a24(0x177)]={},await Promise[_0x5b0a24(0x150)](_0x5cbec3[_0x5b0a24(0x16b)](async _0x4608eb=>{var _0x42707d=_0x5b0a24;_0x5cbec3[_0x42707d(0x177)][_0x4608eb[_0x42707d(0x173)]]=[],await Promise['all'](_0x4608eb[_0x42707d(0x169)][_0x42707d(0x16b)](async _0xb270e0=>{var _0x275c41=_0x42707d;const _0x4eca69=await transfers[_0x275c41(0x141)]([{'$unwind':_0x275c41(0x161)},{'$match':{'product.id_transaction_id':_0xb270e0[_0x275c41(0x178)][_0x275c41(0x197)](),'product.To_invoice':_0xb270e0['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x275c41(0x17b),'product_code':'$product.product_code','quantity_available':_0x275c41(0x196),'warehouse_name':_0x275c41(0x137),'warehouse_room':'$product.room_names','product_invoice':_0x275c41(0x138),'invoice':_0x275c41(0x18b),'id_transaction_from':_0x275c41(0x17a),'date':_0x275c41(0x194),'production_date':_0x275c41(0x19b),'expiry_date':_0x275c41(0x148),'UOM':'$product.unit'}}]);_0x4eca69[_0x275c41(0x13e)]>0x0&&_0x5cbec3[_0x275c41(0x177)][_0x4608eb[_0x275c41(0x173)]][_0x275c41(0x145)](..._0x4eca69);}));})),_0x233297[_0x5b0a24(0x15a)]({'purchases_warehouse':_0x5cbec3,'data_sales':_0x5cbec3[_0x5b0a24(0x13c)],'data_adjustment':_0x5cbec3[_0x5b0a24(0x168)],'data_transfer':_0x5cbec3[_0x5b0a24(0x177)]});}else{var _0x5cbec3=await purchases['aggregate']([{'$match':{'warehouse_name':_0x48b5d4,'date':{'$gte':_0x3eebfb,'$lte':_0x174e04}}},{'$lookup':{'from':_0x5b0a24(0x13b),'let':{'invoice':_0x5b0a24(0x18b)},'pipeline':[{'$unwind':_0x5b0a24(0x159)},{'$match':{'$expr':{'$eq':[_0x5b0a24(0x182),'$product_details.invoice']}}},{'$project':{'_id':_0x5b0a24(0x190),'product_name':'$product_details.product_name','product_code':_0x5b0a24(0x155),'quantity_available':_0x5b0a24(0x171),'warehouse_name':_0x5b0a24(0x136),'warehouse_room':_0x5b0a24(0x1a1),'invoice':_0x5b0a24(0x193),'production_date':_0x5b0a24(0x18c),'expiry_date':'$product_details.expiry_date','UOM':_0x5b0a24(0x156)}}],'as':_0x5b0a24(0x169)}}]);_0x5cbec3[_0x5b0a24(0x13c)]={},await Promise['all'](_0x5cbec3[_0x5b0a24(0x16b)](async _0x12dd55=>{var _0x291846=_0x5b0a24;_0x5cbec3[_0x291846(0x13c)][_0x12dd55['invoice']]=[],await Promise['all'](_0x12dd55[_0x291846(0x169)][_0x291846(0x16b)](async _0x21649e=>{var _0x15c3cc=_0x291846;const _0x291fc9=await sales[_0x15c3cc(0x141)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x21649e[_0x15c3cc(0x178)][_0x15c3cc(0x197)](),'sale_product.invoice':_0x21649e['invoice']}},{'$project':{'_id':_0x15c3cc(0x163),'product_name':_0x15c3cc(0x162),'product_code':_0x15c3cc(0x19d),'quantity_available':_0x15c3cc(0x198),'warehouse_name':_0x15c3cc(0x18a),'warehouse_room':_0x15c3cc(0x18e),'product_invoice':_0x15c3cc(0x153),'invoice':'$invoice','id_transaction_from':_0x15c3cc(0x1a0),'date':_0x15c3cc(0x194),'production_date':'$sale_product.production_date','expiry_date':_0x15c3cc(0x179),'UOM':_0x15c3cc(0x183)}}]);_0x291fc9[_0x15c3cc(0x13e)]>0x0&&_0x5cbec3['data_sales'][_0x12dd55['invoice']]['push'](..._0x291fc9);}));})),_0x5cbec3['data_sales']=_0x5cbec3[_0x5b0a24(0x13c)],_0x5cbec3[_0x5b0a24(0x168)]={},await Promise[_0x5b0a24(0x150)](_0x5cbec3[_0x5b0a24(0x16b)](async _0x3e1471=>{var _0x46820c=_0x5b0a24;_0x5cbec3[_0x46820c(0x168)][_0x3e1471['invoice']]=[],await Promise['all'](_0x3e1471[_0x46820c(0x169)]['map'](async _0x364ad1=>{var _0x57ec6e=_0x46820c;const _0x2c5f8a=await adjustment[_0x57ec6e(0x141)]([{'$unwind':_0x57ec6e(0x161)},{'$match':{'product.id_transaction_from':_0x364ad1[_0x57ec6e(0x178)]['valueOf'](),'product.invoice':_0x364ad1[_0x57ec6e(0x173)]}},{'$project':{'_id':_0x57ec6e(0x166),'product_name':_0x57ec6e(0x17b),'product_code':_0x57ec6e(0x16c),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x57ec6e(0x15e),'product_invoice':'$product.invoice','invoice':_0x57ec6e(0x18b),'id_transaction_from':_0x57ec6e(0x164),'date':_0x57ec6e(0x194),'production_date':_0x57ec6e(0x19b),'expiry_date':_0x57ec6e(0x148),'UOM':_0x57ec6e(0x18d)}}]);_0x2c5f8a[_0x57ec6e(0x13e)]>0x0&&_0x5cbec3[_0x57ec6e(0x168)][_0x3e1471[_0x57ec6e(0x173)]][_0x57ec6e(0x145)](..._0x2c5f8a);}));})),_0x5cbec3[_0x5b0a24(0x177)]={},await Promise[_0x5b0a24(0x150)](_0x5cbec3[_0x5b0a24(0x16b)](async _0x310dd4=>{var _0x522a0a=_0x5b0a24;_0x5cbec3[_0x522a0a(0x177)][_0x310dd4[_0x522a0a(0x173)]]=[],await Promise[_0x522a0a(0x150)](_0x310dd4['warehouse_data'][_0x522a0a(0x16b)](async _0x4b43ff=>{var _0x2374aa=_0x522a0a;const _0x12fad2=await transfers[_0x2374aa(0x141)]([{'$unwind':_0x2374aa(0x161)},{'$match':{'product.id_transaction_id':_0x4b43ff[_0x2374aa(0x178)][_0x2374aa(0x197)](),'product.To_invoice':_0x4b43ff[_0x2374aa(0x173)]}},{'$project':{'_id':_0x2374aa(0x166),'product_name':_0x2374aa(0x17b),'product_code':_0x2374aa(0x16c),'quantity_available':'$product.to_quantity','warehouse_name':_0x2374aa(0x137),'warehouse_room':_0x2374aa(0x15e),'product_invoice':_0x2374aa(0x138),'invoice':_0x2374aa(0x18b),'id_transaction_from':_0x2374aa(0x17a),'date':_0x2374aa(0x194),'production_date':_0x2374aa(0x19b),'expiry_date':_0x2374aa(0x148),'UOM':_0x2374aa(0x18d)}}]);_0x12fad2[_0x2374aa(0x13e)]>0x0&&_0x5cbec3[_0x2374aa(0x177)][_0x310dd4[_0x2374aa(0x173)]][_0x2374aa(0x145)](..._0x12fad2);}));})),_0x233297[_0x5b0a24(0x15a)]({'purchases_warehouse':_0x5cbec3,'data_sales':_0x5cbec3[_0x5b0a24(0x13c)],'data_adjustment':_0x5cbec3[_0x5b0a24(0x168)],'data_transfer':_0x5cbec3['data_transfer']});}}else{if(_0x48b5d4==_0x5b0a24(0x150)){var _0x5cbec3=await purchases_finished[_0x5b0a24(0x141)]([{'$match':{'date':{'$gte':_0x3eebfb,'$lte':_0x174e04}}},{'$lookup':{'from':_0x5b0a24(0x13b),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x5b0a24(0x182),_0x5b0a24(0x193)]}}},{'$project':{'_id':_0x5b0a24(0x190),'product_name':_0x5b0a24(0x135),'product_code':_0x5b0a24(0x155),'quantity_available':_0x5b0a24(0x171),'warehouse_name':'$name','warehouse_room':_0x5b0a24(0x1a1),'invoice':'$product_details.invoice','production_date':_0x5b0a24(0x18c),'expiry_date':_0x5b0a24(0x199),'UOM':_0x5b0a24(0x156)}}],'as':_0x5b0a24(0x169)}}]);_0x5cbec3['data_sales']={},await Promise['all'](_0x5cbec3[_0x5b0a24(0x16b)](async _0x55a195=>{var _0x16e852=_0x5b0a24;_0x5cbec3['data_sales'][_0x55a195[_0x16e852(0x173)]]=[],await Promise['all'](_0x55a195[_0x16e852(0x169)]['map'](async _0x314288=>{var _0x5f1816=_0x16e852;const _0x438e0d=await sales_finished['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x314288[_0x5f1816(0x178)]['valueOf'](),'sale_product.invoice':_0x314288[_0x5f1816(0x173)]}},{'$project':{'_id':_0x5f1816(0x163),'product_name':_0x5f1816(0x162),'product_code':'$sale_product.product_code','quantity_available':_0x5f1816(0x198),'warehouse_name':_0x5f1816(0x18a),'warehouse_room':_0x5f1816(0x18e),'product_invoice':_0x5f1816(0x153),'invoice':_0x5f1816(0x18b),'id_transaction_from':_0x5f1816(0x1a0),'date':_0x5f1816(0x194),'production_date':'$sale_product.production_date','expiry_date':_0x5f1816(0x179),'UOM':'$sale_product.unit'}}]);_0x438e0d['length']>0x0&&_0x5cbec3['data_sales'][_0x55a195[_0x5f1816(0x173)]][_0x5f1816(0x145)](..._0x438e0d);}));})),_0x5cbec3[_0x5b0a24(0x13c)]=_0x5cbec3['data_sales'],_0x5cbec3[_0x5b0a24(0x168)]={},await Promise['all'](_0x5cbec3[_0x5b0a24(0x16b)](async _0x5856e0=>{var _0x1ba410=_0x5b0a24;_0x5cbec3[_0x1ba410(0x168)][_0x5856e0[_0x1ba410(0x173)]]=[],await Promise['all'](_0x5856e0[_0x1ba410(0x169)][_0x1ba410(0x16b)](async _0x526208=>{var _0x2d8c86=_0x1ba410;const _0x2e1a07=await adjustment_finished['aggregate']([{'$unwind':_0x2d8c86(0x161)},{'$match':{'product.id_transaction_from':_0x526208[_0x2d8c86(0x178)][_0x2d8c86(0x197)](),'product.invoice':_0x526208[_0x2d8c86(0x173)]}},{'$project':{'_id':_0x2d8c86(0x166),'product_name':'$product.product_name','product_code':_0x2d8c86(0x16c),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x2d8c86(0x18a),'warehouse_room':_0x2d8c86(0x15e),'product_invoice':'$product.invoice','invoice':_0x2d8c86(0x18b),'id_transaction_from':_0x2d8c86(0x164),'date':_0x2d8c86(0x194),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0x2d8c86(0x18d)}}]);_0x2e1a07[_0x2d8c86(0x13e)]>0x0&&_0x5cbec3[_0x2d8c86(0x168)][_0x5856e0[_0x2d8c86(0x173)]]['push'](..._0x2e1a07);}));})),_0x5cbec3[_0x5b0a24(0x177)]={},await Promise[_0x5b0a24(0x150)](_0x5cbec3[_0x5b0a24(0x16b)](async _0x431ed4=>{var _0x2da953=_0x5b0a24;_0x5cbec3[_0x2da953(0x177)][_0x431ed4['invoice']]=[],await Promise[_0x2da953(0x150)](_0x431ed4[_0x2da953(0x169)][_0x2da953(0x16b)](async _0x167d07=>{var _0x2c8951=_0x2da953;const _0x2450f8=await transfers_finished['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x167d07['_id'][_0x2c8951(0x197)](),'product.from_invoice':_0x167d07[_0x2c8951(0x173)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x2c8951(0x16c),'quantity_available':_0x2c8951(0x196),'warehouse_name':_0x2c8951(0x137),'warehouse_room':_0x2c8951(0x15e),'product_invoice':_0x2c8951(0x138),'invoice':_0x2c8951(0x18b),'id_transaction_from':_0x2c8951(0x160),'date':_0x2c8951(0x194),'production_date':'$product.production_date','expiry_date':_0x2c8951(0x148),'UOM':'$product.unit'}}]);_0x2450f8[_0x2c8951(0x13e)]>0x0&&_0x5cbec3[_0x2c8951(0x177)][_0x431ed4['invoice']][_0x2c8951(0x145)](..._0x2450f8);}));})),_0x233297[_0x5b0a24(0x15a)]({'purchases_warehouse':_0x5cbec3,'data_sales':_0x5cbec3['data_sales'],'data_adjustment':_0x5cbec3[_0x5b0a24(0x168)],'data_transfer':_0x5cbec3[_0x5b0a24(0x177)]});}else{var _0x5cbec3=await purchases_finished[_0x5b0a24(0x141)]([{'$match':{'warehouse_name':_0x48b5d4,'date':{'$gte':_0x3eebfb,'$lte':_0x174e04}}},{'$lookup':{'from':_0x5b0a24(0x13b),'let':{'invoice':_0x5b0a24(0x18b)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x5b0a24(0x182),_0x5b0a24(0x193)]}}},{'$project':{'_id':_0x5b0a24(0x190),'product_name':_0x5b0a24(0x135),'product_code':_0x5b0a24(0x155),'quantity_available':_0x5b0a24(0x171),'warehouse_name':_0x5b0a24(0x136),'warehouse_room':_0x5b0a24(0x1a1),'invoice':_0x5b0a24(0x193),'production_date':_0x5b0a24(0x18c),'expiry_date':_0x5b0a24(0x199),'UOM':_0x5b0a24(0x156)}}],'as':_0x5b0a24(0x169)}}]);_0x5cbec3[_0x5b0a24(0x13c)]={},await Promise[_0x5b0a24(0x150)](_0x5cbec3[_0x5b0a24(0x16b)](async _0x30cd21=>{var _0x50d62f=_0x5b0a24;_0x5cbec3['data_sales'][_0x30cd21['invoice']]=[],await Promise[_0x50d62f(0x150)](_0x30cd21[_0x50d62f(0x169)][_0x50d62f(0x16b)](async _0x50fe64=>{var _0x5013=_0x50d62f;const _0x414683=await sales_finished[_0x5013(0x141)]([{'$unwind':_0x5013(0x170)},{'$match':{'sale_product.id_transaction_from':_0x50fe64[_0x5013(0x178)][_0x5013(0x197)](),'sale_product.invoice':_0x50fe64[_0x5013(0x173)]}},{'$project':{'_id':_0x5013(0x163),'product_name':_0x5013(0x162),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x5013(0x18a),'warehouse_room':_0x5013(0x18e),'product_invoice':'$sale_product.invoice','invoice':_0x5013(0x18b),'id_transaction_from':_0x5013(0x1a0),'date':'$date','production_date':_0x5013(0x147),'expiry_date':_0x5013(0x179),'UOM':_0x5013(0x183)}}]);_0x414683[_0x5013(0x13e)]>0x0&&_0x5cbec3['data_sales'][_0x30cd21[_0x5013(0x173)]][_0x5013(0x145)](..._0x414683);}));})),_0x5cbec3[_0x5b0a24(0x13c)]=_0x5cbec3['data_sales'],_0x5cbec3['data_adjustment']={},await Promise['all'](_0x5cbec3[_0x5b0a24(0x16b)](async _0x5e5e16=>{var _0x564df8=_0x5b0a24;_0x5cbec3['data_adjustment'][_0x5e5e16['invoice']]=[],await Promise['all'](_0x5e5e16[_0x564df8(0x169)][_0x564df8(0x16b)](async _0x2ea5e5=>{var _0x47c2d9=_0x564df8;const _0x3fe3db=await adjustment_finished['aggregate']([{'$unwind':_0x47c2d9(0x161)},{'$match':{'product.id_transaction_from':_0x2ea5e5['_id'][_0x47c2d9(0x197)](),'product.invoice':_0x2ea5e5[_0x47c2d9(0x173)]}},{'$project':{'_id':_0x47c2d9(0x166),'product_name':_0x47c2d9(0x17b),'product_code':_0x47c2d9(0x16c),'quantity_available':_0x47c2d9(0x174),'warehouse_name':_0x47c2d9(0x18a),'warehouse_room':_0x47c2d9(0x15e),'product_invoice':_0x47c2d9(0x19f),'invoice':_0x47c2d9(0x18b),'id_transaction_from':_0x47c2d9(0x164),'date':'$date','production_date':'$product.production_date','expiry_date':_0x47c2d9(0x148),'UOM':_0x47c2d9(0x18d)}}]);_0x3fe3db[_0x47c2d9(0x13e)]>0x0&&_0x5cbec3[_0x47c2d9(0x168)][_0x5e5e16['invoice']][_0x47c2d9(0x145)](..._0x3fe3db);}));})),_0x5cbec3[_0x5b0a24(0x177)]={},await Promise['all'](_0x5cbec3[_0x5b0a24(0x16b)](async _0x5c749f=>{var _0x1df269=_0x5b0a24;_0x5cbec3[_0x1df269(0x177)][_0x5c749f[_0x1df269(0x173)]]=[],await Promise[_0x1df269(0x150)](_0x5c749f[_0x1df269(0x169)]['map'](async _0x762fb1=>{var _0x4c2da9=_0x1df269;const _0x24e141=await transfers_finished[_0x4c2da9(0x141)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x762fb1['_id'][_0x4c2da9(0x197)](),'product.from_invoice':_0x762fb1['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x4c2da9(0x17b),'product_code':_0x4c2da9(0x16c),'quantity_available':_0x4c2da9(0x196),'warehouse_name':_0x4c2da9(0x137),'warehouse_room':_0x4c2da9(0x15e),'product_invoice':_0x4c2da9(0x138),'invoice':_0x4c2da9(0x18b),'id_transaction_from':_0x4c2da9(0x160),'date':_0x4c2da9(0x194),'production_date':_0x4c2da9(0x19b),'expiry_date':_0x4c2da9(0x148),'UOM':_0x4c2da9(0x18d)}}]);_0x24e141[_0x4c2da9(0x13e)]>0x0&&_0x5cbec3[_0x4c2da9(0x177)][_0x5c749f[_0x4c2da9(0x173)]][_0x4c2da9(0x145)](..._0x24e141);}));})),_0x233297[_0x5b0a24(0x15a)]({'purchases_warehouse':_0x5cbec3,'data_sales':_0x5cbec3[_0x5b0a24(0x13c)],'data_adjustment':_0x5cbec3['data_adjustment'],'data_transfer':_0x5cbec3[_0x5b0a24(0x177)]});}}}),router[a0_0x1fcca4(0x175)](a0_0x1fcca4(0x144),auth,async(_0x40313a,_0x45bb00)=>{var _0x654cd0=a0_0x1fcca4;try{const _0x58aec1=_0x40313a[_0x654cd0(0x149)]['id'];var _0x3d8b2d=await purchases_finished['findById'](_0x58aec1);const _0x502fa6=await master_shop['find'](),_0x485a91=_0x40313a[_0x654cd0(0x186)],_0x4d320b=await profile[_0x654cd0(0x143)]({'email':_0x485a91['email']});if(_0x502fa6[0x0][_0x654cd0(0x184)]=='English\x20(US)')var _0x1e4d77=users[_0x654cd0(0x15c)];else{if(_0x502fa6[0x0][_0x654cd0(0x184)]=='Hindi')var _0x1e4d77=users['Hindi'];else{if(_0x502fa6[0x0][_0x654cd0(0x184)]=='German')var _0x1e4d77=users[_0x654cd0(0x19c)];else{if(_0x502fa6[0x0][_0x654cd0(0x184)]=='Spanish')var _0x1e4d77=users[_0x654cd0(0x16f)];else{if(_0x502fa6[0x0][_0x654cd0(0x184)]=='French')var _0x1e4d77=users[_0x654cd0(0x14b)];else{if(_0x502fa6[0x0][_0x654cd0(0x184)]==_0x654cd0(0x17f))var _0x1e4d77=users['Portuguese'];else{if(_0x502fa6[0x0]['language']==_0x654cd0(0x180))var _0x1e4d77=users[_0x654cd0(0x180)];else{if(_0x502fa6[0x0][_0x654cd0(0x184)]==_0x654cd0(0x16e))var _0x1e4d77=users[_0x654cd0(0x195)];}}}}}}}_0x45bb00[_0x654cd0(0x1a2)](_0x654cd0(0x176),{'success':_0x40313a['flash'](_0x654cd0(0x16a)),'errors':_0x40313a[_0x654cd0(0x14a)](_0x654cd0(0x181)),'master_shop':_0x502fa6,'profile':_0x4d320b,'role':_0x485a91,'language':_0x1e4d77,'data':_0x3d8b2d});}catch(_0x224ac1){_0x45bb00[_0x654cd0(0x15a)](_0x224ac1);}}),router[a0_0x1fcca4(0x175)]('/viewdata_og_fg/:id',auth,async(_0x3c51df,_0x40e7db)=>{var _0x9efd24=a0_0x1fcca4;try{const _0x79d4a=_0x3c51df[_0x9efd24(0x149)]['id'];var _0x2d7b88=await sales_finished[_0x9efd24(0x16d)](_0x79d4a);const _0xe9963d=await master_shop[_0x9efd24(0x139)](),_0x4bbac0=_0x3c51df['user'],_0x2425fb=await profile[_0x9efd24(0x143)]({'email':_0x4bbac0['email']});if(_0xe9963d[0x0][_0x9efd24(0x184)]==_0x9efd24(0x167))var _0x15da1d=users[_0x9efd24(0x15c)];else{if(_0xe9963d[0x0]['language']==_0x9efd24(0x189))var _0x15da1d=users[_0x9efd24(0x189)];else{if(_0xe9963d[0x0][_0x9efd24(0x184)]==_0x9efd24(0x19c))var _0x15da1d=users[_0x9efd24(0x19c)];else{if(_0xe9963d[0x0][_0x9efd24(0x184)]==_0x9efd24(0x16f))var _0x15da1d=users[_0x9efd24(0x16f)];else{if(_0xe9963d[0x0][_0x9efd24(0x184)]==_0x9efd24(0x14b))var _0x15da1d=users[_0x9efd24(0x14b)];else{if(_0xe9963d[0x0][_0x9efd24(0x184)]=='Portuguese\x20(BR)')var _0x15da1d=users[_0x9efd24(0x187)];else{if(_0xe9963d[0x0][_0x9efd24(0x184)]==_0x9efd24(0x180))var _0x15da1d=users[_0x9efd24(0x180)];else{if(_0xe9963d[0x0][_0x9efd24(0x184)]=='Arabic\x20(ae)')var _0x15da1d=users['Arabic'];}}}}}}}_0x40e7db[_0x9efd24(0x1a2)](_0x9efd24(0x154),{'success':_0x3c51df[_0x9efd24(0x14a)](_0x9efd24(0x16a)),'errors':_0x3c51df[_0x9efd24(0x14a)](_0x9efd24(0x181)),'master_shop':_0xe9963d,'profile':_0x2425fb,'role':_0x4bbac0,'language':_0x15da1d,'data':_0x2d7b88});}catch(_0x384aca){_0x40e7db[_0x9efd24(0x15a)](_0x384aca);}}),router[a0_0x1fcca4(0x175)](a0_0x1fcca4(0x13f),auth,async(_0x196781,_0x105fa0)=>{var _0x49a338=a0_0x1fcca4;try{const _0x15fad8=_0x196781[_0x49a338(0x149)]['id'];var _0x1b4200=await transfers_finished['findById'](_0x15fad8);const _0x5a28bf=await master_shop[_0x49a338(0x139)](),_0x11cbca=_0x196781['user'],_0x54d0dc=await profile['findOne']({'email':_0x11cbca[_0x49a338(0x14f)]});if(_0x5a28bf[0x0][_0x49a338(0x184)]=='English\x20(US)')var _0x1dbaa8=users[_0x49a338(0x15c)];else{if(_0x5a28bf[0x0]['language']==_0x49a338(0x189))var _0x1dbaa8=users[_0x49a338(0x189)];else{if(_0x5a28bf[0x0][_0x49a338(0x184)]==_0x49a338(0x19c))var _0x1dbaa8=users[_0x49a338(0x19c)];else{if(_0x5a28bf[0x0][_0x49a338(0x184)]=='Spanish')var _0x1dbaa8=users[_0x49a338(0x16f)];else{if(_0x5a28bf[0x0][_0x49a338(0x184)]==_0x49a338(0x14b))var _0x1dbaa8=users['French'];else{if(_0x5a28bf[0x0][_0x49a338(0x184)]==_0x49a338(0x17f))var _0x1dbaa8=users['Portuguese'];else{if(_0x5a28bf[0x0][_0x49a338(0x184)]==_0x49a338(0x180))var _0x1dbaa8=users[_0x49a338(0x180)];else{if(_0x5a28bf[0x0]['language']==_0x49a338(0x16e))var _0x1dbaa8=users[_0x49a338(0x195)];}}}}}}}_0x105fa0[_0x49a338(0x1a2)](_0x49a338(0x152),{'success':_0x196781[_0x49a338(0x14a)](_0x49a338(0x16a)),'errors':_0x196781[_0x49a338(0x14a)](_0x49a338(0x181)),'master_shop':_0x5a28bf,'profile':_0x54d0dc,'role':_0x11cbca,'language':_0x1dbaa8,'data':_0x1b4200});}catch(_0x48970a){_0x105fa0[_0x49a338(0x15a)](_0x48970a);}}),router['get'](a0_0x1fcca4(0x13d),auth,async(_0x2d54a0,_0xc98697)=>{var _0x4c5dfc=a0_0x1fcca4;try{const {username:_0x3f69a4,email:_0x5596f4,role:_0x5a3e6b}=_0x2d54a0[_0x4c5dfc(0x186)],_0x30737d=_0x2d54a0['user'],_0x13cd90=await profile['findOne']({'email':_0x30737d[_0x4c5dfc(0x14f)]}),_0x29a695=await master_shop[_0x4c5dfc(0x139)](),_0x5afc35=await warehouse[_0x4c5dfc(0x141)]([{'$match':{'status':_0x4c5dfc(0x140),'warehouse_category':_0x4c5dfc(0x18f)}},{'$group':{'_id':_0x4c5dfc(0x136),'name':{'$first':_0x4c5dfc(0x136)}}}]);if(_0x29a695[0x0][_0x4c5dfc(0x184)]==_0x4c5dfc(0x167))var _0x1b9417=users['English'];else{if(_0x29a695[0x0]['language']==_0x4c5dfc(0x189))var _0x1b9417=users[_0x4c5dfc(0x189)];else{if(_0x29a695[0x0]['language']==_0x4c5dfc(0x19c))var _0x1b9417=users[_0x4c5dfc(0x19c)];else{if(_0x29a695[0x0]['language']==_0x4c5dfc(0x16f))var _0x1b9417=users[_0x4c5dfc(0x16f)];else{if(_0x29a695[0x0][_0x4c5dfc(0x184)]==_0x4c5dfc(0x14b))var _0x1b9417=users[_0x4c5dfc(0x14b)];else{if(_0x29a695[0x0][_0x4c5dfc(0x184)]=='Portuguese\x20(BR)')var _0x1b9417=users[_0x4c5dfc(0x187)];else{if(_0x29a695[0x0]['language']==_0x4c5dfc(0x180))var _0x1b9417=users['Chinese'];else{if(_0x29a695[0x0][_0x4c5dfc(0x184)]==_0x4c5dfc(0x16e))var _0x1b9417=users[_0x4c5dfc(0x195)];}}}}}}}_0xc98697['render'](_0x4c5dfc(0x15f),{'success':_0x2d54a0[_0x4c5dfc(0x14a)](_0x4c5dfc(0x16a)),'errors':_0x2d54a0[_0x4c5dfc(0x14a)](_0x4c5dfc(0x181)),'role':_0x30737d,'profile':_0x13cd90,'master_shop':_0x29a695,'dataProcess':_0x5afc35,'language':_0x1b9417});}catch(_0x44f523){console['log'](_0x44f523);}}),module[a0_0x1fcca4(0x17c)]=router;function a0_0x5e85(){var _0x3ffcb0=['Enabled','aggregate','126Btigns','findOne','/viewdata_inc_fg/:id','push','Router','$sale_product.production_date','$product.expiry_date','params','flash','French','4OfrmPt','6655612eWzJnn','express','email','all','1684610sGHfNA','view_tf_table','$sale_product.invoice','view_og_table','$product_details.product_code','$product_details.unit','transaction_finished','35ovCMOk','$product_details','json','22rAGOSN','English','1705713iXsCzN','$product.room_names','transaction_finished_raw','$product.id_transaction','$product','$sale_product.product_name','$sale_product._id','$product.id_transaction_from','log','$product._id','English\x20(US)','data_adjustment','warehouse_data','success','map','$product.product_code','findById','Arabic\x20(ae)','Spanish','$sale_product','$product_details.product_stock','Finished\x20Goods','invoice','$product.new_adjust_qty','get','view_table','data_transfer','_id','$sale_product.expiry_date','$product.id_transaction_id','$product.product_name','exports','516744OcqoyV','../models/all_models','Portuguese\x20(BR)','Chinese','errors','$$invoice','$sale_product.unit','language','post','user','Portuguese','/view','Hindi','$warehouse_name','$invoice','$product_details.production_date','$product.unit','$sale_product.room_name','Raw\x20Materials','$product_details._id','/reports','5733245iJwnSD','$product_details.invoice','$date','Arabic','$product.to_quantity','valueOf','$sale_product.quantity','$product_details.expiry_date','579178FMWbZe','$product.production_date','German','$sale_product.product_code','518646NnsDtA','$product.invoice','$sale_product.id_transaction_from','$room','render','$product_details.product_name','$name','$to_warehouse','$product.to_room_name','find','nodemailer','warehouses','data_sales','/viewFG','length','/viewdata_tf_fg/:id'];a0_0x5e85=function(){return _0x3ffcb0;};return a0_0x5e85();}