var a0_0x27c6b0=a0_0x1f60;(function(_0x1d65f6,_0x1ba7e2){var _0x19ac9c=a0_0x1f60,_0x564423=_0x1d65f6();while(!![]){try{var _0x5ee7ec=parseInt(_0x19ac9c(0x1c6))/0x1+parseInt(_0x19ac9c(0x19e))/0x2+-parseInt(_0x19ac9c(0x19c))/0x3*(-parseInt(_0x19ac9c(0x195))/0x4)+-parseInt(_0x19ac9c(0x1de))/0x5+parseInt(_0x19ac9c(0x1e1))/0x6+-parseInt(_0x19ac9c(0x1c0))/0x7+parseInt(_0x19ac9c(0x1c3))/0x8*(-parseInt(_0x19ac9c(0x1f8))/0x9);if(_0x5ee7ec===_0x1ba7e2)break;else _0x564423['push'](_0x564423['shift']());}catch(_0x34b0cc){_0x564423['push'](_0x564423['shift']());}}}(a0_0x4da5,0xc0e46));const express=require(a0_0x27c6b0(0x1a6)),app=express(),router=express[a0_0x27c6b0(0x1ea)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x27c6b0(0x1d7)),auth=require(a0_0x27c6b0(0x1df)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x27c6b0(0x1f0));function a0_0x1f60(_0x56ce5c,_0x273624){var _0x4da596=a0_0x4da5();return a0_0x1f60=function(_0x1f609e,_0x386907){_0x1f609e=_0x1f609e-0x195;var _0x53ccf5=_0x4da596[_0x1f609e];return _0x53ccf5;},a0_0x1f60(_0x56ce5c,_0x273624);}router[a0_0x27c6b0(0x1f1)](a0_0x27c6b0(0x1bd),auth,async(_0x585404,_0x5994d5)=>{var _0xacbbc3=a0_0x27c6b0;try{const {username:_0x3d2d90,email:_0x3445dc,role:_0x1c38b7}=_0x585404['user'],_0x17ca5c=_0x585404[_0xacbbc3(0x1db)],_0x5b57d1=await profile['findOne']({'email':_0x17ca5c[_0xacbbc3(0x1d8)]}),_0x485ddd=await master_shop['find'](),_0x26be60=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0xacbbc3(0x1ac),'name':{'$first':'$name'}}}]);if(_0x485ddd[0x0][_0xacbbc3(0x1e3)]=='English\x20(US)')var _0x581e09=users[_0xacbbc3(0x1c7)];else{if(_0x485ddd[0x0]['language']==_0xacbbc3(0x19f))var _0x581e09=users[_0xacbbc3(0x19f)];else{if(_0x485ddd[0x0][_0xacbbc3(0x1e3)]==_0xacbbc3(0x1d1))var _0x581e09=users[_0xacbbc3(0x1d1)];else{if(_0x485ddd[0x0][_0xacbbc3(0x1e3)]=='Spanish')var _0x581e09=users[_0xacbbc3(0x1bc)];else{if(_0x485ddd[0x0][_0xacbbc3(0x1e3)]=='French')var _0x581e09=users[_0xacbbc3(0x1fa)];else{if(_0x485ddd[0x0][_0xacbbc3(0x1e3)]==_0xacbbc3(0x1c8))var _0x581e09=users[_0xacbbc3(0x19a)];else{if(_0x485ddd[0x0]['language']=='Chinese')var _0x581e09=users[_0xacbbc3(0x1a1)];else{if(_0x485ddd[0x0][_0xacbbc3(0x1e3)]=='Arabic\x20(ae)')var _0x581e09=users['Arabic'];}}}}}}}_0x5994d5[_0xacbbc3(0x1af)](_0xacbbc3(0x1b1),{'success':_0x585404['flash'](_0xacbbc3(0x197)),'errors':_0x585404['flash'](_0xacbbc3(0x1e2)),'role':_0x17ca5c,'profile':_0x5b57d1,'master_shop':_0x485ddd,'dataProcess':_0x26be60,'language':_0x581e09});}catch(_0x3f5b80){console['log'](_0x3f5b80);}}),router[a0_0x27c6b0(0x1b5)]('/reports',auth,async(_0x20ae7c,_0x4469cf)=>{var _0x1b55ba=a0_0x27c6b0;const {product_category:_0xbb232b,transaction_category:_0x395a74,transaction_date_from:_0x4c1acc,transaction_date_to:_0x470244,warehouse_category:_0x2498db,item_code:_0x4ac98e}=_0x20ae7c[_0x1b55ba(0x1c2)];console[_0x1b55ba(0x1d4)](_0x2498db);if(_0xbb232b=='rm'){if(_0x2498db==_0x1b55ba(0x1d3)){var _0x95c57a=await purchases['aggregate']([{'$match':{'date':{'$gte':_0x4c1acc,'$lte':_0x470244}}},{'$lookup':{'from':_0x1b55ba(0x1ba),'let':{'invoice':_0x1b55ba(0x1b7)},'pipeline':[{'$unwind':_0x1b55ba(0x1ec)},{'$match':{'$expr':{'$eq':[_0x1b55ba(0x1c5),_0x1b55ba(0x1e4)]}}},{'$project':{'_id':_0x1b55ba(0x1b9),'product_name':'$product_details.product_name','product_code':_0x1b55ba(0x1a3),'quantity_available':_0x1b55ba(0x1e0),'warehouse_name':_0x1b55ba(0x1ac),'warehouse_room':_0x1b55ba(0x199),'invoice':_0x1b55ba(0x1e4),'production_date':_0x1b55ba(0x1f9),'expiry_date':'$product_details.expiry_date','UOM':_0x1b55ba(0x1eb)}}],'as':_0x1b55ba(0x1d6)}}]);_0x95c57a[_0x1b55ba(0x1e6)]={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0x29070d=>{var _0x354a14=_0x1b55ba;_0x95c57a[_0x354a14(0x1e6)][_0x29070d[_0x354a14(0x1f5)]]=[],await Promise[_0x354a14(0x1d3)](_0x29070d[_0x354a14(0x1d6)][_0x354a14(0x1ca)](async _0x49482e=>{var _0x581f5e=_0x354a14;const _0x3eca7a=await sales[_0x581f5e(0x1be)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x49482e[_0x581f5e(0x1e8)]['valueOf'](),'sale_product.invoice':_0x49482e['invoice']}},{'$project':{'_id':_0x581f5e(0x1e9),'product_name':_0x581f5e(0x1f3),'product_code':_0x581f5e(0x1f6),'quantity_available':_0x581f5e(0x1f4),'warehouse_name':_0x581f5e(0x1bf),'warehouse_room':_0x581f5e(0x1ef),'product_invoice':_0x581f5e(0x1e7),'invoice':_0x581f5e(0x1b7),'id_transaction_from':_0x581f5e(0x1ab),'date':_0x581f5e(0x1cc),'production_date':_0x581f5e(0x1a8),'expiry_date':'$sale_product.expiry_date','UOM':'$sale_product.unit'}}]);_0x3eca7a[_0x581f5e(0x1fb)]>0x0&&_0x95c57a[_0x581f5e(0x1e6)][_0x29070d['invoice']][_0x581f5e(0x1ee)](..._0x3eca7a);}));})),_0x95c57a[_0x1b55ba(0x1e6)]=_0x95c57a['data_sales'],_0x95c57a[_0x1b55ba(0x1cb)]={},await Promise['all'](_0x95c57a[_0x1b55ba(0x1ca)](async _0x534afd=>{var _0x3ce80a=_0x1b55ba;_0x95c57a[_0x3ce80a(0x1cb)][_0x534afd[_0x3ce80a(0x1f5)]]=[],await Promise['all'](_0x534afd[_0x3ce80a(0x1d6)]['map'](async _0x218571=>{var _0x2dc754=_0x3ce80a;const _0x2b619b=await adjustment[_0x2dc754(0x1be)]([{'$unwind':_0x2dc754(0x1b2)},{'$match':{'product.id_transaction_from':_0x218571[_0x2dc754(0x1e8)][_0x2dc754(0x1a2)](),'product.invoice':_0x218571[_0x2dc754(0x1f5)]}},{'$project':{'_id':_0x2dc754(0x1e5),'product_name':_0x2dc754(0x1b6),'product_code':_0x2dc754(0x1c4),'quantity_available':_0x2dc754(0x1a7),'warehouse_name':_0x2dc754(0x1bf),'warehouse_room':_0x2dc754(0x1c1),'product_invoice':_0x2dc754(0x1d0),'invoice':_0x2dc754(0x1b7),'id_transaction_from':_0x2dc754(0x1c9),'date':_0x2dc754(0x1cc),'production_date':_0x2dc754(0x1aa),'expiry_date':_0x2dc754(0x1ae),'UOM':_0x2dc754(0x1ce)}}]);_0x2b619b[_0x2dc754(0x1fb)]>0x0&&_0x95c57a['data_adjustment'][_0x534afd[_0x2dc754(0x1f5)]][_0x2dc754(0x1ee)](..._0x2b619b);}));})),_0x95c57a['data_transfer']={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0x422d5b=>{var _0x18ce6f=_0x1b55ba;_0x95c57a[_0x18ce6f(0x1d2)][_0x422d5b[_0x18ce6f(0x1f5)]]=[],await Promise[_0x18ce6f(0x1d3)](_0x422d5b[_0x18ce6f(0x1d6)]['map'](async _0x4300e8=>{var _0x47389b=_0x18ce6f;const _0x3355ff=await transfers[_0x47389b(0x1be)]([{'$unwind':_0x47389b(0x1b2)},{'$match':{'product.id_transaction_id':_0x4300e8[_0x47389b(0x1e8)][_0x47389b(0x1a2)](),'product.To_invoice':_0x4300e8['invoice']}},{'$project':{'_id':_0x47389b(0x1e5),'product_name':_0x47389b(0x1b6),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x47389b(0x1f7),'warehouse_room':_0x47389b(0x1c1),'product_invoice':_0x47389b(0x1a0),'invoice':_0x47389b(0x1b7),'id_transaction_from':_0x47389b(0x1a4),'date':_0x47389b(0x1cc),'production_date':'$product.production_date','expiry_date':_0x47389b(0x1ae),'UOM':_0x47389b(0x1ce)}}]);_0x3355ff['length']>0x0&&_0x95c57a['data_transfer'][_0x422d5b[_0x47389b(0x1f5)]][_0x47389b(0x1ee)](..._0x3355ff);}));})),_0x4469cf['json']({'purchases_warehouse':_0x95c57a,'data_sales':_0x95c57a[_0x1b55ba(0x1e6)],'data_adjustment':_0x95c57a[_0x1b55ba(0x1cb)],'data_transfer':_0x95c57a[_0x1b55ba(0x1d2)]});}else{var _0x95c57a=await purchases[_0x1b55ba(0x1be)]([{'$match':{'warehouse_name':_0x2498db,'date':{'$gte':_0x4c1acc,'$lte':_0x470244}}},{'$lookup':{'from':_0x1b55ba(0x1ba),'let':{'invoice':_0x1b55ba(0x1b7)},'pipeline':[{'$unwind':_0x1b55ba(0x1ec)},{'$match':{'$expr':{'$eq':[_0x1b55ba(0x1c5),'$product_details.invoice']}}},{'$project':{'_id':_0x1b55ba(0x1b9),'product_name':'$product_details.product_name','product_code':_0x1b55ba(0x1a3),'quantity_available':_0x1b55ba(0x1e0),'warehouse_name':_0x1b55ba(0x1ac),'warehouse_room':_0x1b55ba(0x199),'invoice':'$product_details.invoice','production_date':'$product_details.production_date','expiry_date':_0x1b55ba(0x196),'UOM':_0x1b55ba(0x1eb)}}],'as':_0x1b55ba(0x1d6)}}]);_0x95c57a[_0x1b55ba(0x1e6)]={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0x33f783=>{var _0xbd9991=_0x1b55ba;_0x95c57a[_0xbd9991(0x1e6)][_0x33f783[_0xbd9991(0x1f5)]]=[],await Promise[_0xbd9991(0x1d3)](_0x33f783[_0xbd9991(0x1d6)][_0xbd9991(0x1ca)](async _0x42dfd1=>{var _0x841a3d=_0xbd9991;const _0x53328b=await sales[_0x841a3d(0x1be)]([{'$unwind':_0x841a3d(0x1f2)},{'$match':{'sale_product.id_transaction_from':_0x42dfd1['_id'][_0x841a3d(0x1a2)](),'sale_product.invoice':_0x42dfd1['invoice']}},{'$project':{'_id':_0x841a3d(0x1e9),'product_name':_0x841a3d(0x1f3),'product_code':_0x841a3d(0x1f6),'quantity_available':_0x841a3d(0x1f4),'warehouse_name':'$warehouse_name','warehouse_room':_0x841a3d(0x1ef),'product_invoice':_0x841a3d(0x1e7),'invoice':'$invoice','id_transaction_from':_0x841a3d(0x1ab),'date':_0x841a3d(0x1cc),'production_date':_0x841a3d(0x1a8),'expiry_date':_0x841a3d(0x19b),'UOM':'$sale_product.unit'}}]);_0x53328b[_0x841a3d(0x1fb)]>0x0&&_0x95c57a[_0x841a3d(0x1e6)][_0x33f783[_0x841a3d(0x1f5)]][_0x841a3d(0x1ee)](..._0x53328b);}));})),_0x95c57a[_0x1b55ba(0x1e6)]=_0x95c57a['data_sales'],_0x95c57a[_0x1b55ba(0x1cb)]={},await Promise['all'](_0x95c57a[_0x1b55ba(0x1ca)](async _0x1d8c64=>{var _0x18eae7=_0x1b55ba;_0x95c57a['data_adjustment'][_0x1d8c64[_0x18eae7(0x1f5)]]=[],await Promise[_0x18eae7(0x1d3)](_0x1d8c64[_0x18eae7(0x1d6)]['map'](async _0x36b7e7=>{var _0x2dac2d=_0x18eae7;const _0x2e5938=await adjustment[_0x2dac2d(0x1be)]([{'$unwind':_0x2dac2d(0x1b2)},{'$match':{'product.id_transaction_from':_0x36b7e7[_0x2dac2d(0x1e8)][_0x2dac2d(0x1a2)](),'product.invoice':_0x36b7e7[_0x2dac2d(0x1f5)]}},{'$project':{'_id':_0x2dac2d(0x1e5),'product_name':_0x2dac2d(0x1b6),'product_code':_0x2dac2d(0x1c4),'quantity_available':_0x2dac2d(0x1a7),'warehouse_name':_0x2dac2d(0x1bf),'warehouse_room':'$product.room_names','product_invoice':_0x2dac2d(0x1d0),'invoice':'$invoice','id_transaction_from':_0x2dac2d(0x1c9),'date':_0x2dac2d(0x1cc),'production_date':_0x2dac2d(0x1aa),'expiry_date':_0x2dac2d(0x1ae),'UOM':_0x2dac2d(0x1ce)}}]);_0x2e5938[_0x2dac2d(0x1fb)]>0x0&&_0x95c57a[_0x2dac2d(0x1cb)][_0x1d8c64['invoice']][_0x2dac2d(0x1ee)](..._0x2e5938);}));})),_0x95c57a[_0x1b55ba(0x1d2)]={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0x3cafb7=>{var _0x205659=_0x1b55ba;_0x95c57a[_0x205659(0x1d2)][_0x3cafb7['invoice']]=[],await Promise['all'](_0x3cafb7['warehouse_data'][_0x205659(0x1ca)](async _0x3ee63a=>{var _0x5bf019=_0x205659;const _0x2343b0=await transfers['aggregate']([{'$unwind':_0x5bf019(0x1b2)},{'$match':{'product.id_transaction_id':_0x3ee63a[_0x5bf019(0x1e8)][_0x5bf019(0x1a2)](),'product.To_invoice':_0x3ee63a['invoice']}},{'$project':{'_id':_0x5bf019(0x1e5),'product_name':'$product.product_name','product_code':_0x5bf019(0x1c4),'quantity_available':'$product.to_quantity','warehouse_name':_0x5bf019(0x1f7),'warehouse_room':_0x5bf019(0x1c1),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x5bf019(0x1a4),'date':_0x5bf019(0x1cc),'production_date':'$product.production_date','expiry_date':_0x5bf019(0x1ae),'UOM':'$product.unit'}}]);_0x2343b0[_0x5bf019(0x1fb)]>0x0&&_0x95c57a[_0x5bf019(0x1d2)][_0x3cafb7['invoice']][_0x5bf019(0x1ee)](..._0x2343b0);}));})),_0x4469cf['json']({'purchases_warehouse':_0x95c57a,'data_sales':_0x95c57a[_0x1b55ba(0x1e6)],'data_adjustment':_0x95c57a[_0x1b55ba(0x1cb)],'data_transfer':_0x95c57a['data_transfer']});}}else{if(_0x2498db==_0x1b55ba(0x1d3)){var _0x95c57a=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x4c1acc,'$lte':_0x470244}}},{'$lookup':{'from':_0x1b55ba(0x1ba),'let':{'invoice':_0x1b55ba(0x1b7)},'pipeline':[{'$unwind':_0x1b55ba(0x1ec)},{'$match':{'$expr':{'$eq':[_0x1b55ba(0x1c5),_0x1b55ba(0x1e4)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x1b55ba(0x1a9),'product_code':_0x1b55ba(0x1a3),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':'$room','invoice':_0x1b55ba(0x1e4),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x1b55ba(0x1eb)}}],'as':'warehouse_data'}}]);_0x95c57a[_0x1b55ba(0x1e6)]={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0x2de0e7=>{var _0x27d2c3=_0x1b55ba;_0x95c57a[_0x27d2c3(0x1e6)][_0x2de0e7[_0x27d2c3(0x1f5)]]=[],await Promise[_0x27d2c3(0x1d3)](_0x2de0e7[_0x27d2c3(0x1d6)][_0x27d2c3(0x1ca)](async _0xc59ae0=>{var _0x40f7e9=_0x27d2c3;const _0xf1716e=await sales_finished[_0x40f7e9(0x1be)]([{'$unwind':_0x40f7e9(0x1f2)},{'$match':{'sale_product.id_transaction_from':_0xc59ae0[_0x40f7e9(0x1e8)][_0x40f7e9(0x1a2)](),'sale_product.invoice':_0xc59ae0[_0x40f7e9(0x1f5)]}},{'$project':{'_id':_0x40f7e9(0x1e9),'product_name':_0x40f7e9(0x1f3),'product_code':_0x40f7e9(0x1f6),'quantity_available':'$sale_product.quantity','warehouse_name':_0x40f7e9(0x1bf),'warehouse_room':_0x40f7e9(0x1ef),'product_invoice':_0x40f7e9(0x1e7),'invoice':'$invoice','id_transaction_from':_0x40f7e9(0x1ab),'date':_0x40f7e9(0x1cc),'production_date':_0x40f7e9(0x1a8),'expiry_date':_0x40f7e9(0x19b),'UOM':_0x40f7e9(0x198)}}]);_0xf1716e[_0x40f7e9(0x1fb)]>0x0&&_0x95c57a[_0x40f7e9(0x1e6)][_0x2de0e7[_0x40f7e9(0x1f5)]][_0x40f7e9(0x1ee)](..._0xf1716e);}));})),_0x95c57a['data_sales']=_0x95c57a[_0x1b55ba(0x1e6)],_0x95c57a[_0x1b55ba(0x1cb)]={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0x4dfb56=>{var _0x534189=_0x1b55ba;_0x95c57a[_0x534189(0x1cb)][_0x4dfb56[_0x534189(0x1f5)]]=[],await Promise[_0x534189(0x1d3)](_0x4dfb56[_0x534189(0x1d6)][_0x534189(0x1ca)](async _0x2ce37d=>{var _0x1bd572=_0x534189;const _0x39f965=await adjustment_finished['aggregate']([{'$unwind':_0x1bd572(0x1b2)},{'$match':{'product.id_transaction_from':_0x2ce37d['_id'][_0x1bd572(0x1a2)](),'product.invoice':_0x2ce37d[_0x1bd572(0x1f5)]}},{'$project':{'_id':'$product._id','product_name':_0x1bd572(0x1b6),'product_code':_0x1bd572(0x1c4),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x1bd572(0x1bf),'warehouse_room':_0x1bd572(0x1c1),'product_invoice':_0x1bd572(0x1d0),'invoice':'$invoice','id_transaction_from':_0x1bd572(0x1c9),'date':_0x1bd572(0x1cc),'production_date':_0x1bd572(0x1aa),'expiry_date':_0x1bd572(0x1ae),'UOM':'$product.unit'}}]);_0x39f965[_0x1bd572(0x1fb)]>0x0&&_0x95c57a[_0x1bd572(0x1cb)][_0x4dfb56[_0x1bd572(0x1f5)]][_0x1bd572(0x1ee)](..._0x39f965);}));})),_0x95c57a[_0x1b55ba(0x1d2)]={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0x3c4fe6=>{var _0x504abb=_0x1b55ba;_0x95c57a[_0x504abb(0x1d2)][_0x3c4fe6[_0x504abb(0x1f5)]]=[],await Promise[_0x504abb(0x1d3)](_0x3c4fe6[_0x504abb(0x1d6)][_0x504abb(0x1ca)](async _0x29e25b=>{var _0x25a0a9=_0x504abb;const _0x4f15f5=await transfers_finished[_0x25a0a9(0x1be)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x29e25b[_0x25a0a9(0x1e8)]['valueOf'](),'product.from_invoice':_0x29e25b[_0x25a0a9(0x1f5)]}},{'$project':{'_id':_0x25a0a9(0x1e5),'product_name':_0x25a0a9(0x1b6),'product_code':_0x25a0a9(0x1c4),'quantity_available':'$product.to_quantity','warehouse_name':_0x25a0a9(0x1f7),'warehouse_room':_0x25a0a9(0x1c1),'product_invoice':_0x25a0a9(0x1a0),'invoice':_0x25a0a9(0x1b7),'id_transaction_from':'$product.id_transaction','date':_0x25a0a9(0x1cc),'production_date':_0x25a0a9(0x1aa),'expiry_date':_0x25a0a9(0x1ae),'UOM':_0x25a0a9(0x1ce)}}]);_0x4f15f5[_0x25a0a9(0x1fb)]>0x0&&_0x95c57a[_0x25a0a9(0x1d2)][_0x3c4fe6['invoice']]['push'](..._0x4f15f5);}));})),_0x4469cf[_0x1b55ba(0x1bb)]({'purchases_warehouse':_0x95c57a,'data_sales':_0x95c57a['data_sales'],'data_adjustment':_0x95c57a[_0x1b55ba(0x1cb)],'data_transfer':_0x95c57a['data_transfer']});}else{var _0x95c57a=await purchases_finished[_0x1b55ba(0x1be)]([{'$match':{'warehouse_name':_0x2498db,'date':{'$gte':_0x4c1acc,'$lte':_0x470244}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x1b55ba(0x1b7)},'pipeline':[{'$unwind':_0x1b55ba(0x1ec)},{'$match':{'$expr':{'$eq':[_0x1b55ba(0x1c5),_0x1b55ba(0x1e4)]}}},{'$project':{'_id':_0x1b55ba(0x1b9),'product_name':_0x1b55ba(0x1a9),'product_code':_0x1b55ba(0x1a3),'quantity_available':_0x1b55ba(0x1e0),'warehouse_name':_0x1b55ba(0x1ac),'warehouse_room':_0x1b55ba(0x199),'invoice':_0x1b55ba(0x1e4),'production_date':_0x1b55ba(0x1f9),'expiry_date':_0x1b55ba(0x196),'UOM':_0x1b55ba(0x1eb)}}],'as':_0x1b55ba(0x1d6)}}]);_0x95c57a[_0x1b55ba(0x1e6)]={},await Promise['all'](_0x95c57a['map'](async _0x2c5431=>{var _0x1fcb1c=_0x1b55ba;_0x95c57a[_0x1fcb1c(0x1e6)][_0x2c5431[_0x1fcb1c(0x1f5)]]=[],await Promise[_0x1fcb1c(0x1d3)](_0x2c5431[_0x1fcb1c(0x1d6)][_0x1fcb1c(0x1ca)](async _0x14c24d=>{var _0x20fea1=_0x1fcb1c;const _0x58f48e=await sales_finished[_0x20fea1(0x1be)]([{'$unwind':_0x20fea1(0x1f2)},{'$match':{'sale_product.id_transaction_from':_0x14c24d[_0x20fea1(0x1e8)][_0x20fea1(0x1a2)](),'sale_product.invoice':_0x14c24d['invoice']}},{'$project':{'_id':_0x20fea1(0x1e9),'product_name':_0x20fea1(0x1f3),'product_code':_0x20fea1(0x1f6),'quantity_available':_0x20fea1(0x1f4),'warehouse_name':_0x20fea1(0x1bf),'warehouse_room':_0x20fea1(0x1ef),'product_invoice':'$sale_product.invoice','invoice':_0x20fea1(0x1b7),'id_transaction_from':_0x20fea1(0x1ab),'date':_0x20fea1(0x1cc),'production_date':_0x20fea1(0x1a8),'expiry_date':_0x20fea1(0x19b),'UOM':'$sale_product.unit'}}]);_0x58f48e[_0x20fea1(0x1fb)]>0x0&&_0x95c57a['data_sales'][_0x2c5431[_0x20fea1(0x1f5)]][_0x20fea1(0x1ee)](..._0x58f48e);}));})),_0x95c57a[_0x1b55ba(0x1e6)]=_0x95c57a[_0x1b55ba(0x1e6)],_0x95c57a[_0x1b55ba(0x1cb)]={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0xda22a9=>{var _0xa13a03=_0x1b55ba;_0x95c57a[_0xa13a03(0x1cb)][_0xda22a9['invoice']]=[],await Promise[_0xa13a03(0x1d3)](_0xda22a9[_0xa13a03(0x1d6)]['map'](async _0x4d5740=>{var _0x1a7446=_0xa13a03;const _0x25fff5=await adjustment_finished[_0x1a7446(0x1be)]([{'$unwind':_0x1a7446(0x1b2)},{'$match':{'product.id_transaction_from':_0x4d5740['_id']['valueOf'](),'product.invoice':_0x4d5740['invoice']}},{'$project':{'_id':_0x1a7446(0x1e5),'product_name':_0x1a7446(0x1b6),'product_code':_0x1a7446(0x1c4),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x1a7446(0x1bf),'warehouse_room':'$product.room_names','product_invoice':'$product.invoice','invoice':_0x1a7446(0x1b7),'id_transaction_from':_0x1a7446(0x1c9),'date':_0x1a7446(0x1cc),'production_date':_0x1a7446(0x1aa),'expiry_date':_0x1a7446(0x1ae),'UOM':'$product.unit'}}]);_0x25fff5[_0x1a7446(0x1fb)]>0x0&&_0x95c57a[_0x1a7446(0x1cb)][_0xda22a9['invoice']]['push'](..._0x25fff5);}));})),_0x95c57a[_0x1b55ba(0x1d2)]={},await Promise[_0x1b55ba(0x1d3)](_0x95c57a[_0x1b55ba(0x1ca)](async _0x58bd92=>{var _0xd0cf08=_0x1b55ba;_0x95c57a['data_transfer'][_0x58bd92['invoice']]=[],await Promise[_0xd0cf08(0x1d3)](_0x58bd92['warehouse_data'][_0xd0cf08(0x1ca)](async _0x46f915=>{var _0x5588f8=_0xd0cf08;const _0x6bc059=await transfers_finished[_0x5588f8(0x1be)]([{'$unwind':_0x5588f8(0x1b2)},{'$match':{'product.id_transaction':_0x46f915['_id']['valueOf'](),'product.from_invoice':_0x46f915[_0x5588f8(0x1f5)]}},{'$project':{'_id':_0x5588f8(0x1e5),'product_name':_0x5588f8(0x1b6),'product_code':_0x5588f8(0x1c4),'quantity_available':'$product.to_quantity','warehouse_name':'$to_warehouse','warehouse_room':_0x5588f8(0x1c1),'product_invoice':_0x5588f8(0x1a0),'invoice':'$invoice','id_transaction_from':_0x5588f8(0x1cd),'date':_0x5588f8(0x1cc),'production_date':'$product.production_date','expiry_date':_0x5588f8(0x1ae),'UOM':_0x5588f8(0x1ce)}}]);_0x6bc059[_0x5588f8(0x1fb)]>0x0&&_0x95c57a['data_transfer'][_0x58bd92[_0x5588f8(0x1f5)]][_0x5588f8(0x1ee)](..._0x6bc059);}));})),_0x4469cf[_0x1b55ba(0x1bb)]({'purchases_warehouse':_0x95c57a,'data_sales':_0x95c57a[_0x1b55ba(0x1e6)],'data_adjustment':_0x95c57a[_0x1b55ba(0x1cb)],'data_transfer':_0x95c57a[_0x1b55ba(0x1d2)]});}}}),router['get'](a0_0x27c6b0(0x1b3),auth,async(_0x9735f7,_0x1c2f99)=>{var _0x3de520=a0_0x27c6b0;try{const _0x3d7b74=_0x9735f7[_0x3de520(0x1dc)]['id'];var _0x200c89=await purchases_finished['findById'](_0x3d7b74);const _0x52dd1b=await master_shop['find'](),_0x2fd2b7=_0x9735f7['user'],_0x2e38db=await profile[_0x3de520(0x1ed)]({'email':_0x2fd2b7[_0x3de520(0x1d8)]});if(_0x52dd1b[0x0][_0x3de520(0x1e3)]==_0x3de520(0x1b4))var _0x3590cf=users[_0x3de520(0x1c7)];else{if(_0x52dd1b[0x0]['language']==_0x3de520(0x19f))var _0x3590cf=users[_0x3de520(0x19f)];else{if(_0x52dd1b[0x0][_0x3de520(0x1e3)]==_0x3de520(0x1d1))var _0x3590cf=users[_0x3de520(0x1d1)];else{if(_0x52dd1b[0x0][_0x3de520(0x1e3)]==_0x3de520(0x1bc))var _0x3590cf=users[_0x3de520(0x1bc)];else{if(_0x52dd1b[0x0][_0x3de520(0x1e3)]==_0x3de520(0x1fa))var _0x3590cf=users[_0x3de520(0x1fa)];else{if(_0x52dd1b[0x0]['language']==_0x3de520(0x1c8))var _0x3590cf=users[_0x3de520(0x19a)];else{if(_0x52dd1b[0x0][_0x3de520(0x1e3)]==_0x3de520(0x1a1))var _0x3590cf=users[_0x3de520(0x1a1)];else{if(_0x52dd1b[0x0][_0x3de520(0x1e3)]==_0x3de520(0x1a5))var _0x3590cf=users[_0x3de520(0x1d5)];}}}}}}}_0x1c2f99[_0x3de520(0x1af)]('view_table',{'success':_0x9735f7['flash'](_0x3de520(0x197)),'errors':_0x9735f7[_0x3de520(0x1b8)](_0x3de520(0x1e2)),'master_shop':_0x52dd1b,'profile':_0x2e38db,'role':_0x2fd2b7,'language':_0x3590cf,'data':_0x200c89});}catch(_0x9ae013){_0x1c2f99[_0x3de520(0x1bb)](_0x9ae013);}}),router[a0_0x27c6b0(0x1f1)]('/viewdata_og_fg/:id',auth,async(_0x5cf2dd,_0x2c88ac)=>{var _0xa141ce=a0_0x27c6b0;try{const _0x351036=_0x5cf2dd['params']['id'];var _0x287222=await sales_finished[_0xa141ce(0x1cf)](_0x351036);const _0x249870=await master_shop[_0xa141ce(0x1b0)](),_0x2e6e0e=_0x5cf2dd[_0xa141ce(0x1db)],_0x10a00a=await profile[_0xa141ce(0x1ed)]({'email':_0x2e6e0e[_0xa141ce(0x1d8)]});if(_0x249870[0x0][_0xa141ce(0x1e3)]==_0xa141ce(0x1b4))var _0x27aae2=users['English'];else{if(_0x249870[0x0][_0xa141ce(0x1e3)]=='Hindi')var _0x27aae2=users[_0xa141ce(0x19f)];else{if(_0x249870[0x0]['language']==_0xa141ce(0x1d1))var _0x27aae2=users[_0xa141ce(0x1d1)];else{if(_0x249870[0x0][_0xa141ce(0x1e3)]==_0xa141ce(0x1bc))var _0x27aae2=users[_0xa141ce(0x1bc)];else{if(_0x249870[0x0][_0xa141ce(0x1e3)]==_0xa141ce(0x1fa))var _0x27aae2=users[_0xa141ce(0x1fa)];else{if(_0x249870[0x0][_0xa141ce(0x1e3)]==_0xa141ce(0x1c8))var _0x27aae2=users[_0xa141ce(0x19a)];else{if(_0x249870[0x0][_0xa141ce(0x1e3)]==_0xa141ce(0x1a1))var _0x27aae2=users[_0xa141ce(0x1a1)];else{if(_0x249870[0x0][_0xa141ce(0x1e3)]=='Arabic\x20(ae)')var _0x27aae2=users['Arabic'];}}}}}}}_0x2c88ac['render'](_0xa141ce(0x1dd),{'success':_0x5cf2dd[_0xa141ce(0x1b8)](_0xa141ce(0x197)),'errors':_0x5cf2dd[_0xa141ce(0x1b8)](_0xa141ce(0x1e2)),'master_shop':_0x249870,'profile':_0x10a00a,'role':_0x2e6e0e,'language':_0x27aae2,'data':_0x287222});}catch(_0x29e0ab){_0x2c88ac[_0xa141ce(0x1bb)](_0x29e0ab);}}),router[a0_0x27c6b0(0x1f1)]('/viewdata_tf_fg/:id',auth,async(_0xdc50a4,_0x2e85e2)=>{var _0x5def8a=a0_0x27c6b0;try{const _0x39fc58=_0xdc50a4[_0x5def8a(0x1dc)]['id'];var _0xc698f3=await transfers_finished[_0x5def8a(0x1cf)](_0x39fc58);const _0x1e982c=await master_shop[_0x5def8a(0x1b0)](),_0x3957e4=_0xdc50a4[_0x5def8a(0x1db)],_0xa9cd36=await profile['findOne']({'email':_0x3957e4[_0x5def8a(0x1d8)]});if(_0x1e982c[0x0][_0x5def8a(0x1e3)]==_0x5def8a(0x1b4))var _0x59d474=users[_0x5def8a(0x1c7)];else{if(_0x1e982c[0x0][_0x5def8a(0x1e3)]==_0x5def8a(0x19f))var _0x59d474=users[_0x5def8a(0x19f)];else{if(_0x1e982c[0x0][_0x5def8a(0x1e3)]==_0x5def8a(0x1d1))var _0x59d474=users['German'];else{if(_0x1e982c[0x0][_0x5def8a(0x1e3)]==_0x5def8a(0x1bc))var _0x59d474=users[_0x5def8a(0x1bc)];else{if(_0x1e982c[0x0][_0x5def8a(0x1e3)]==_0x5def8a(0x1fa))var _0x59d474=users[_0x5def8a(0x1fa)];else{if(_0x1e982c[0x0][_0x5def8a(0x1e3)]=='Portuguese\x20(BR)')var _0x59d474=users[_0x5def8a(0x19a)];else{if(_0x1e982c[0x0][_0x5def8a(0x1e3)]=='Chinese')var _0x59d474=users['Chinese'];else{if(_0x1e982c[0x0]['language']=='Arabic\x20(ae)')var _0x59d474=users[_0x5def8a(0x1d5)];}}}}}}}_0x2e85e2[_0x5def8a(0x1af)]('view_tf_table',{'success':_0xdc50a4['flash'](_0x5def8a(0x197)),'errors':_0xdc50a4[_0x5def8a(0x1b8)](_0x5def8a(0x1e2)),'master_shop':_0x1e982c,'profile':_0xa9cd36,'role':_0x3957e4,'language':_0x59d474,'data':_0xc698f3});}catch(_0x4698c8){_0x2e85e2[_0x5def8a(0x1bb)](_0x4698c8);}}),router[a0_0x27c6b0(0x1f1)](a0_0x27c6b0(0x1d9),auth,async(_0x43d777,_0x346de8)=>{var _0x19c013=a0_0x27c6b0;try{const {username:_0x5aea61,email:_0x4c20b1,role:_0x412872}=_0x43d777[_0x19c013(0x1db)],_0x567779=_0x43d777[_0x19c013(0x1db)],_0x366ff6=await profile['findOne']({'email':_0x567779['email']}),_0x2593f0=await master_shop[_0x19c013(0x1b0)](),_0x6aa3b1=await warehouse[_0x19c013(0x1be)]([{'$match':{'status':_0x19c013(0x1ad),'warehouse_category':_0x19c013(0x1fc)}},{'$group':{'_id':_0x19c013(0x1ac),'name':{'$first':_0x19c013(0x1ac)}}}]);if(_0x2593f0[0x0]['language']==_0x19c013(0x1b4))var _0x579adc=users['English'];else{if(_0x2593f0[0x0][_0x19c013(0x1e3)]==_0x19c013(0x19f))var _0x579adc=users[_0x19c013(0x19f)];else{if(_0x2593f0[0x0]['language']==_0x19c013(0x1d1))var _0x579adc=users['German'];else{if(_0x2593f0[0x0]['language']=='Spanish')var _0x579adc=users[_0x19c013(0x1bc)];else{if(_0x2593f0[0x0][_0x19c013(0x1e3)]==_0x19c013(0x1fa))var _0x579adc=users[_0x19c013(0x1fa)];else{if(_0x2593f0[0x0][_0x19c013(0x1e3)]=='Portuguese\x20(BR)')var _0x579adc=users[_0x19c013(0x19a)];else{if(_0x2593f0[0x0]['language']==_0x19c013(0x1a1))var _0x579adc=users['Chinese'];else{if(_0x2593f0[0x0][_0x19c013(0x1e3)]==_0x19c013(0x1a5))var _0x579adc=users[_0x19c013(0x1d5)];}}}}}}}_0x346de8[_0x19c013(0x1af)](_0x19c013(0x1da),{'success':_0x43d777[_0x19c013(0x1b8)]('success'),'errors':_0x43d777[_0x19c013(0x1b8)]('errors'),'role':_0x567779,'profile':_0x366ff6,'master_shop':_0x2593f0,'dataProcess':_0x6aa3b1,'language':_0x579adc});}catch(_0x135147){console[_0x19c013(0x1d4)](_0x135147);}}),module[a0_0x27c6b0(0x19d)]=router;function a0_0x4da5(){var _0x3eaa14=['$to_warehouse','3474dvJstX','$product_details.production_date','French','length','Raw\x20Materials','4547744gpMluU','$product_details.expiry_date','success','$sale_product.unit','$room','Portuguese','$sale_product.expiry_date','3mwSWRe','exports','2559822YYGLNV','Hindi','$product.to_room_name','Chinese','valueOf','$product_details.product_code','$product.id_transaction_id','Arabic\x20(ae)','express','$product.new_adjust_qty','$sale_product.production_date','$product_details.product_name','$product.production_date','$sale_product.id_transaction_from','$name','Enabled','$product.expiry_date','render','find','transaction_finished','$product','/viewdata_inc_fg/:id','English\x20(US)','post','$product.product_name','$invoice','flash','$product_details._id','warehouses','json','Spanish','/view','aggregate','$warehouse_name','2132907awmcya','$product.room_names','body','72008HLWQid','$product.product_code','$$invoice','1552584WWteel','English','Portuguese\x20(BR)','$product.id_transaction_from','map','data_adjustment','$date','$product.id_transaction','$product.unit','findById','$product.invoice','German','data_transfer','all','log','Arabic','warehouse_data','../models/all_models','email','/viewFG','transaction_finished_raw','user','params','view_og_table','55680xenPRl','../middleware/auth','$product_details.product_stock','3665268htYVeE','errors','language','$product_details.invoice','$product._id','data_sales','$sale_product.invoice','_id','$sale_product._id','Router','$product_details.unit','$product_details','findOne','push','$sale_product.room_name','nodemailer','get','$sale_product','$sale_product.product_name','$sale_product.quantity','invoice','$sale_product.product_code'];a0_0x4da5=function(){return _0x3eaa14;};return a0_0x4da5();}