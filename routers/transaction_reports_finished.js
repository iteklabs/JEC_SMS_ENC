var a0_0xf640b7=a0_0xa6fe;function a0_0x3784(){var _0x3db282=['get','$sale_product._id','$product._id','transaction_finished','/viewFG','1900591FPxsOF','$to_warehouse','$product.new_adjust_qty','96864XLsScZ','$product_details.unit','$product.production_date','52440FuVBUf','log','$product_details.product_name','$product','errors','$product.invoice','express','German','length','params','body','data_adjustment','$sale_product.quantity','$product_details.invoice','json','$sale_product.product_code','$sale_product.room_name','$product.room_names','$room','../models/all_models','30HcmAns','$name','$product.unit','data_sales','$product.id_transaction_id','findOne','warehouse_data','Enabled','view_tf_table','render','164oxuOYj','Arabic','$product.to_room_name','Spanish','email','flash','1KOiMXs','Finished\x20Goods','$product.to_quantity','find','23102CLHmZn','/viewdata_og_fg/:id','$product_details.product_stock','Portuguese\x20(BR)','valueOf','Portuguese','105354RABVUZ','Arabic\x20(ae)','154yoMVNJ','success','/view','language','$product.expiry_date','view_table','aggregate','_id','$sale_product.product_name','Router','English\x20(US)','warehouses','../public/language/languages.json','French','$product_details.production_date','$product_details.product_code','$sale_product.invoice','push','$sale_product.expiry_date','$date','$product.id_transaction','$product.product_code','/viewdata_tf_fg/:id','data_transfer','findById','Raw\x20Materials','user','$product_details','$warehouse_name','$product.product_name','$sale_product.id_transaction_from','$product_details.expiry_date','map','all','nodemailer','$sale_product.production_date','invoice','$product.id_transaction_from','$sale_product.unit','$$invoice','/reports','Hindi','$product_details._id','30993GRBOMK','$sale_product','Chinese','$invoice','2785752QoyYpq','English'];a0_0x3784=function(){return _0x3db282;};return a0_0x3784();}(function(_0x1e5ff4,_0x1f8c6a){var _0x5f0fd0=a0_0xa6fe,_0x50fc77=_0x1e5ff4();while(!![]){try{var _0x3ddba8=-parseInt(_0x5f0fd0(0x200))/0x1*(parseInt(_0x5f0fd0(0x204))/0x2)+parseInt(_0x5f0fd0(0x237))/0x3*(-parseInt(_0x5f0fd0(0x1fa))/0x4)+parseInt(_0x5f0fd0(0x1f0))/0x5*(parseInt(_0x5f0fd0(0x1d9))/0x6)+parseInt(_0x5f0fd0(0x1d6))/0x7+parseInt(_0x5f0fd0(0x23b))/0x8+parseInt(_0x5f0fd0(0x20a))/0x9+parseInt(_0x5f0fd0(0x1dc))/0xa*(-parseInt(_0x5f0fd0(0x20c))/0xb);if(_0x3ddba8===_0x1f8c6a)break;else _0x50fc77['push'](_0x50fc77['shift']());}catch(_0x501ec3){_0x50fc77['push'](_0x50fc77['shift']());}}}(a0_0x3784,0x35a74));function a0_0xa6fe(_0x41b870,_0x5c9294){var _0x378459=a0_0x3784();return a0_0xa6fe=function(_0xa6fe89,_0x395f25){_0xa6fe89=_0xa6fe89-0x1d5;var _0x2503bb=_0x378459[_0xa6fe89];return _0x2503bb;},a0_0xa6fe(_0x41b870,_0x5c9294);}const express=require(a0_0xf640b7(0x1e2)),app=express(),router=express[a0_0xf640b7(0x215)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0xf640b7(0x1ef)),auth=require('../middleware/auth'),users=require(a0_0xf640b7(0x218)),nodemailer=require(a0_0xf640b7(0x22e));router[a0_0xf640b7(0x23d)](a0_0xf640b7(0x20e),auth,async(_0x5f2639,_0x38e0ea)=>{var _0x191fca=a0_0xf640b7;try{const {username:_0x1838e0,email:_0x5b2cfb,role:_0x4f4fc2}=_0x5f2639[_0x191fca(0x226)],_0x4d22c1=_0x5f2639[_0x191fca(0x226)],_0x9ed24b=await profile[_0x191fca(0x1f5)]({'email':_0x4d22c1[_0x191fca(0x1fe)]}),_0x1a0942=await master_shop['find'](),_0x438dd9=await warehouse['aggregate']([{'$match':{'status':_0x191fca(0x1f7),'warehouse_category':_0x191fca(0x201)}},{'$group':{'_id':_0x191fca(0x1f1),'name':{'$first':'$name'}}}]);if(_0x1a0942[0x0][_0x191fca(0x20f)]=='English\x20(US)')var _0x1f404d=users[_0x191fca(0x23c)];else{if(_0x1a0942[0x0][_0x191fca(0x20f)]=='Hindi')var _0x1f404d=users[_0x191fca(0x235)];else{if(_0x1a0942[0x0]['language']==_0x191fca(0x1e3))var _0x1f404d=users['German'];else{if(_0x1a0942[0x0][_0x191fca(0x20f)]==_0x191fca(0x1fd))var _0x1f404d=users['Spanish'];else{if(_0x1a0942[0x0][_0x191fca(0x20f)]=='French')var _0x1f404d=users[_0x191fca(0x219)];else{if(_0x1a0942[0x0][_0x191fca(0x20f)]==_0x191fca(0x207))var _0x1f404d=users[_0x191fca(0x209)];else{if(_0x1a0942[0x0][_0x191fca(0x20f)]==_0x191fca(0x239))var _0x1f404d=users[_0x191fca(0x239)];else{if(_0x1a0942[0x0]['language']=='Arabic\x20(ae)')var _0x1f404d=users[_0x191fca(0x1fb)];}}}}}}}_0x38e0ea[_0x191fca(0x1f9)](_0x191fca(0x240),{'success':_0x5f2639['flash'](_0x191fca(0x20d)),'errors':_0x5f2639[_0x191fca(0x1ff)](_0x191fca(0x1e0)),'role':_0x4d22c1,'profile':_0x9ed24b,'master_shop':_0x1a0942,'dataProcess':_0x438dd9,'language':_0x1f404d});}catch(_0x2b5dbd){console[_0x191fca(0x1dd)](_0x2b5dbd);}}),router['post'](a0_0xf640b7(0x234),auth,async(_0x887411,_0x77f931)=>{var _0x5af85d=a0_0xf640b7;const {product_category:_0x2376fa,transaction_category:_0x522bfc,transaction_date_from:_0x448eee,transaction_date_to:_0x895d42,warehouse_category:_0x190212,item_code:_0x356321}=_0x887411[_0x5af85d(0x1e6)];console['log'](_0x190212);if(_0x2376fa=='rm'){if(_0x190212==_0x5af85d(0x22d)){var _0x15d655=await purchases['aggregate']([{'$match':{'date':{'$gte':_0x448eee,'$lte':_0x895d42}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x5af85d(0x23a)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x5af85d(0x233),_0x5af85d(0x1e9)]}}},{'$project':{'_id':_0x5af85d(0x236),'product_name':'$product_details.product_name','product_code':_0x5af85d(0x21b),'quantity_available':'$product_details.product_stock','warehouse_name':_0x5af85d(0x1f1),'warehouse_room':_0x5af85d(0x1ee),'invoice':_0x5af85d(0x1e9),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x5af85d(0x1da)}}],'as':'warehouse_data'}}]);_0x15d655['data_sales']={},await Promise[_0x5af85d(0x22d)](_0x15d655[_0x5af85d(0x22c)](async _0x4e332d=>{var _0x3f50fd=_0x5af85d;_0x15d655[_0x3f50fd(0x1f3)][_0x4e332d[_0x3f50fd(0x230)]]=[],await Promise[_0x3f50fd(0x22d)](_0x4e332d[_0x3f50fd(0x1f6)]['map'](async _0x2c7c14=>{var _0x39bd52=_0x3f50fd;const _0x3a87dd=await sales[_0x39bd52(0x212)]([{'$unwind':_0x39bd52(0x238)},{'$match':{'sale_product.id_transaction_from':_0x2c7c14[_0x39bd52(0x213)][_0x39bd52(0x208)](),'sale_product.invoice':_0x2c7c14[_0x39bd52(0x230)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x39bd52(0x214),'product_code':_0x39bd52(0x1eb),'quantity_available':'$sale_product.quantity','warehouse_name':_0x39bd52(0x228),'warehouse_room':'$sale_product.room_name','product_invoice':_0x39bd52(0x21c),'invoice':_0x39bd52(0x23a),'id_transaction_from':_0x39bd52(0x22a),'date':_0x39bd52(0x21f),'production_date':'$sale_product.production_date','expiry_date':'$sale_product.expiry_date','UOM':_0x39bd52(0x232)}}]);_0x3a87dd[_0x39bd52(0x1e4)]>0x0&&_0x15d655[_0x39bd52(0x1f3)][_0x4e332d['invoice']][_0x39bd52(0x21d)](..._0x3a87dd);}));})),_0x15d655[_0x5af85d(0x1f3)]=_0x15d655[_0x5af85d(0x1f3)],_0x15d655[_0x5af85d(0x1e7)]={},await Promise[_0x5af85d(0x22d)](_0x15d655['map'](async _0x292924=>{var _0x419557=_0x5af85d;_0x15d655['data_adjustment'][_0x292924[_0x419557(0x230)]]=[],await Promise['all'](_0x292924[_0x419557(0x1f6)][_0x419557(0x22c)](async _0x13b148=>{var _0x5ae62b=_0x419557;const _0x408384=await adjustment[_0x5ae62b(0x212)]([{'$unwind':_0x5ae62b(0x1df)},{'$match':{'product.id_transaction_from':_0x13b148[_0x5ae62b(0x213)]['valueOf'](),'product.invoice':_0x13b148['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x5ae62b(0x229),'product_code':_0x5ae62b(0x221),'quantity_available':_0x5ae62b(0x1d8),'warehouse_name':_0x5ae62b(0x228),'warehouse_room':_0x5ae62b(0x1ed),'product_invoice':_0x5ae62b(0x1e1),'invoice':_0x5ae62b(0x23a),'id_transaction_from':_0x5ae62b(0x231),'date':_0x5ae62b(0x21f),'production_date':_0x5ae62b(0x1db),'expiry_date':_0x5ae62b(0x210),'UOM':_0x5ae62b(0x1f2)}}]);_0x408384['length']>0x0&&_0x15d655[_0x5ae62b(0x1e7)][_0x292924[_0x5ae62b(0x230)]][_0x5ae62b(0x21d)](..._0x408384);}));})),_0x15d655[_0x5af85d(0x223)]={},await Promise[_0x5af85d(0x22d)](_0x15d655['map'](async _0x2d98f7=>{var _0x1a9334=_0x5af85d;_0x15d655[_0x1a9334(0x223)][_0x2d98f7['invoice']]=[],await Promise[_0x1a9334(0x22d)](_0x2d98f7[_0x1a9334(0x1f6)][_0x1a9334(0x22c)](async _0x3d6ff1=>{var _0x5ae825=_0x1a9334;const _0x3aa76c=await transfers[_0x5ae825(0x212)]([{'$unwind':_0x5ae825(0x1df)},{'$match':{'product.id_transaction_id':_0x3d6ff1[_0x5ae825(0x213)][_0x5ae825(0x208)](),'product.To_invoice':_0x3d6ff1[_0x5ae825(0x230)]}},{'$project':{'_id':_0x5ae825(0x23f),'product_name':_0x5ae825(0x229),'product_code':_0x5ae825(0x221),'quantity_available':_0x5ae825(0x202),'warehouse_name':_0x5ae825(0x1d7),'warehouse_room':_0x5ae825(0x1ed),'product_invoice':_0x5ae825(0x1fc),'invoice':_0x5ae825(0x23a),'id_transaction_from':_0x5ae825(0x1f4),'date':'$date','production_date':_0x5ae825(0x1db),'expiry_date':'$product.expiry_date','UOM':_0x5ae825(0x1f2)}}]);_0x3aa76c[_0x5ae825(0x1e4)]>0x0&&_0x15d655[_0x5ae825(0x223)][_0x2d98f7['invoice']]['push'](..._0x3aa76c);}));})),_0x77f931[_0x5af85d(0x1ea)]({'purchases_warehouse':_0x15d655,'data_sales':_0x15d655[_0x5af85d(0x1f3)],'data_adjustment':_0x15d655[_0x5af85d(0x1e7)],'data_transfer':_0x15d655[_0x5af85d(0x223)]});}else{var _0x15d655=await purchases[_0x5af85d(0x212)]([{'$match':{'warehouse_name':_0x190212,'date':{'$gte':_0x448eee,'$lte':_0x895d42}}},{'$lookup':{'from':_0x5af85d(0x217),'let':{'invoice':_0x5af85d(0x23a)},'pipeline':[{'$unwind':_0x5af85d(0x227)},{'$match':{'$expr':{'$eq':[_0x5af85d(0x233),'$product_details.invoice']}}},{'$project':{'_id':_0x5af85d(0x236),'product_name':_0x5af85d(0x1de),'product_code':_0x5af85d(0x21b),'quantity_available':'$product_details.product_stock','warehouse_name':_0x5af85d(0x1f1),'warehouse_room':_0x5af85d(0x1ee),'invoice':_0x5af85d(0x1e9),'production_date':_0x5af85d(0x21a),'expiry_date':_0x5af85d(0x22b),'UOM':_0x5af85d(0x1da)}}],'as':_0x5af85d(0x1f6)}}]);_0x15d655[_0x5af85d(0x1f3)]={},await Promise[_0x5af85d(0x22d)](_0x15d655['map'](async _0x3c9387=>{var _0x53f420=_0x5af85d;_0x15d655[_0x53f420(0x1f3)][_0x3c9387[_0x53f420(0x230)]]=[],await Promise[_0x53f420(0x22d)](_0x3c9387['warehouse_data']['map'](async _0x6d8ac8=>{var _0x54f097=_0x53f420;const _0x29128b=await sales[_0x54f097(0x212)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x6d8ac8[_0x54f097(0x213)]['valueOf'](),'sale_product.invoice':_0x6d8ac8[_0x54f097(0x230)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x54f097(0x214),'product_code':_0x54f097(0x1eb),'quantity_available':_0x54f097(0x1e8),'warehouse_name':_0x54f097(0x228),'warehouse_room':_0x54f097(0x1ec),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0x54f097(0x21f),'production_date':_0x54f097(0x22f),'expiry_date':'$sale_product.expiry_date','UOM':'$sale_product.unit'}}]);_0x29128b[_0x54f097(0x1e4)]>0x0&&_0x15d655['data_sales'][_0x3c9387[_0x54f097(0x230)]][_0x54f097(0x21d)](..._0x29128b);}));})),_0x15d655[_0x5af85d(0x1f3)]=_0x15d655[_0x5af85d(0x1f3)],_0x15d655[_0x5af85d(0x1e7)]={},await Promise[_0x5af85d(0x22d)](_0x15d655[_0x5af85d(0x22c)](async _0x570809=>{var _0x225c59=_0x5af85d;_0x15d655['data_adjustment'][_0x570809[_0x225c59(0x230)]]=[],await Promise[_0x225c59(0x22d)](_0x570809[_0x225c59(0x1f6)][_0x225c59(0x22c)](async _0xe879ed=>{var _0x48d341=_0x225c59;const _0x16c341=await adjustment[_0x48d341(0x212)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0xe879ed['_id'][_0x48d341(0x208)](),'product.invoice':_0xe879ed[_0x48d341(0x230)]}},{'$project':{'_id':_0x48d341(0x23f),'product_name':'$product.product_name','product_code':_0x48d341(0x221),'quantity_available':_0x48d341(0x1d8),'warehouse_name':'$warehouse_name','warehouse_room':_0x48d341(0x1ed),'product_invoice':_0x48d341(0x1e1),'invoice':_0x48d341(0x23a),'id_transaction_from':_0x48d341(0x231),'date':_0x48d341(0x21f),'production_date':_0x48d341(0x1db),'expiry_date':_0x48d341(0x210),'UOM':'$product.unit'}}]);_0x16c341[_0x48d341(0x1e4)]>0x0&&_0x15d655['data_adjustment'][_0x570809[_0x48d341(0x230)]][_0x48d341(0x21d)](..._0x16c341);}));})),_0x15d655[_0x5af85d(0x223)]={},await Promise[_0x5af85d(0x22d)](_0x15d655[_0x5af85d(0x22c)](async _0x1c2237=>{var _0x227cf4=_0x5af85d;_0x15d655[_0x227cf4(0x223)][_0x1c2237[_0x227cf4(0x230)]]=[],await Promise[_0x227cf4(0x22d)](_0x1c2237[_0x227cf4(0x1f6)][_0x227cf4(0x22c)](async _0x28b292=>{var _0xbc70ab=_0x227cf4;const _0x19abe6=await transfers['aggregate']([{'$unwind':_0xbc70ab(0x1df)},{'$match':{'product.id_transaction_id':_0x28b292['_id'][_0xbc70ab(0x208)](),'product.To_invoice':_0x28b292[_0xbc70ab(0x230)]}},{'$project':{'_id':'$product._id','product_name':_0xbc70ab(0x229),'product_code':_0xbc70ab(0x221),'quantity_available':'$product.to_quantity','warehouse_name':_0xbc70ab(0x1d7),'warehouse_room':_0xbc70ab(0x1ed),'product_invoice':_0xbc70ab(0x1fc),'invoice':_0xbc70ab(0x23a),'id_transaction_from':_0xbc70ab(0x1f4),'date':_0xbc70ab(0x21f),'production_date':'$product.production_date','expiry_date':_0xbc70ab(0x210),'UOM':_0xbc70ab(0x1f2)}}]);_0x19abe6[_0xbc70ab(0x1e4)]>0x0&&_0x15d655['data_transfer'][_0x1c2237[_0xbc70ab(0x230)]][_0xbc70ab(0x21d)](..._0x19abe6);}));})),_0x77f931['json']({'purchases_warehouse':_0x15d655,'data_sales':_0x15d655[_0x5af85d(0x1f3)],'data_adjustment':_0x15d655[_0x5af85d(0x1e7)],'data_transfer':_0x15d655[_0x5af85d(0x223)]});}}else{if(_0x190212==_0x5af85d(0x22d)){var _0x15d655=await purchases_finished[_0x5af85d(0x212)]([{'$match':{'date':{'$gte':_0x448eee,'$lte':_0x895d42}}},{'$lookup':{'from':_0x5af85d(0x217),'let':{'invoice':_0x5af85d(0x23a)},'pipeline':[{'$unwind':_0x5af85d(0x227)},{'$match':{'$expr':{'$eq':[_0x5af85d(0x233),_0x5af85d(0x1e9)]}}},{'$project':{'_id':_0x5af85d(0x236),'product_name':_0x5af85d(0x1de),'product_code':_0x5af85d(0x21b),'quantity_available':_0x5af85d(0x206),'warehouse_name':_0x5af85d(0x1f1),'warehouse_room':_0x5af85d(0x1ee),'invoice':_0x5af85d(0x1e9),'production_date':_0x5af85d(0x21a),'expiry_date':'$product_details.expiry_date','UOM':_0x5af85d(0x1da)}}],'as':_0x5af85d(0x1f6)}}]);_0x15d655['data_sales']={},await Promise[_0x5af85d(0x22d)](_0x15d655[_0x5af85d(0x22c)](async _0x496f97=>{var _0x3328a8=_0x5af85d;_0x15d655[_0x3328a8(0x1f3)][_0x496f97['invoice']]=[],await Promise[_0x3328a8(0x22d)](_0x496f97[_0x3328a8(0x1f6)][_0x3328a8(0x22c)](async _0x73b64a=>{var _0x5e7597=_0x3328a8;const _0xadb206=await sales_finished[_0x5e7597(0x212)]([{'$unwind':_0x5e7597(0x238)},{'$match':{'sale_product.id_transaction_from':_0x73b64a[_0x5e7597(0x213)][_0x5e7597(0x208)](),'sale_product.invoice':_0x73b64a[_0x5e7597(0x230)]}},{'$project':{'_id':_0x5e7597(0x23e),'product_name':_0x5e7597(0x214),'product_code':_0x5e7597(0x1eb),'quantity_available':_0x5e7597(0x1e8),'warehouse_name':_0x5e7597(0x228),'warehouse_room':_0x5e7597(0x1ec),'product_invoice':_0x5e7597(0x21c),'invoice':'$invoice','id_transaction_from':_0x5e7597(0x22a),'date':'$date','production_date':_0x5e7597(0x22f),'expiry_date':'$sale_product.expiry_date','UOM':_0x5e7597(0x232)}}]);_0xadb206[_0x5e7597(0x1e4)]>0x0&&_0x15d655[_0x5e7597(0x1f3)][_0x496f97[_0x5e7597(0x230)]][_0x5e7597(0x21d)](..._0xadb206);}));})),_0x15d655[_0x5af85d(0x1f3)]=_0x15d655[_0x5af85d(0x1f3)],_0x15d655[_0x5af85d(0x1e7)]={},await Promise[_0x5af85d(0x22d)](_0x15d655[_0x5af85d(0x22c)](async _0x5daf7e=>{var _0x543506=_0x5af85d;_0x15d655[_0x543506(0x1e7)][_0x5daf7e[_0x543506(0x230)]]=[],await Promise[_0x543506(0x22d)](_0x5daf7e[_0x543506(0x1f6)][_0x543506(0x22c)](async _0x33f2e3=>{var _0x363777=_0x543506;const _0x5e90b5=await adjustment_finished[_0x363777(0x212)]([{'$unwind':_0x363777(0x1df)},{'$match':{'product.id_transaction_from':_0x33f2e3[_0x363777(0x213)][_0x363777(0x208)](),'product.invoice':_0x33f2e3['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x363777(0x229),'product_code':_0x363777(0x221),'quantity_available':_0x363777(0x1d8),'warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':'$product.invoice','invoice':_0x363777(0x23a),'id_transaction_from':'$product.id_transaction_from','date':_0x363777(0x21f),'production_date':_0x363777(0x1db),'expiry_date':_0x363777(0x210),'UOM':_0x363777(0x1f2)}}]);_0x5e90b5[_0x363777(0x1e4)]>0x0&&_0x15d655[_0x363777(0x1e7)][_0x5daf7e['invoice']]['push'](..._0x5e90b5);}));})),_0x15d655[_0x5af85d(0x223)]={},await Promise[_0x5af85d(0x22d)](_0x15d655['map'](async _0xe57e41=>{var _0x47bf70=_0x5af85d;_0x15d655[_0x47bf70(0x223)][_0xe57e41[_0x47bf70(0x230)]]=[],await Promise['all'](_0xe57e41[_0x47bf70(0x1f6)][_0x47bf70(0x22c)](async _0x5089d3=>{var _0x4cf62b=_0x47bf70;const _0x1ba650=await transfers_finished[_0x4cf62b(0x212)]([{'$unwind':_0x4cf62b(0x1df)},{'$match':{'product.id_transaction':_0x5089d3[_0x4cf62b(0x213)][_0x4cf62b(0x208)](),'product.from_invoice':_0x5089d3[_0x4cf62b(0x230)]}},{'$project':{'_id':_0x4cf62b(0x23f),'product_name':_0x4cf62b(0x229),'product_code':_0x4cf62b(0x221),'quantity_available':'$product.to_quantity','warehouse_name':_0x4cf62b(0x1d7),'warehouse_room':_0x4cf62b(0x1ed),'product_invoice':_0x4cf62b(0x1fc),'invoice':_0x4cf62b(0x23a),'id_transaction_from':_0x4cf62b(0x220),'date':_0x4cf62b(0x21f),'production_date':_0x4cf62b(0x1db),'expiry_date':_0x4cf62b(0x210),'UOM':_0x4cf62b(0x1f2)}}]);_0x1ba650[_0x4cf62b(0x1e4)]>0x0&&_0x15d655['data_transfer'][_0xe57e41[_0x4cf62b(0x230)]][_0x4cf62b(0x21d)](..._0x1ba650);}));})),_0x77f931['json']({'purchases_warehouse':_0x15d655,'data_sales':_0x15d655[_0x5af85d(0x1f3)],'data_adjustment':_0x15d655[_0x5af85d(0x1e7)],'data_transfer':_0x15d655[_0x5af85d(0x223)]});}else{var _0x15d655=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x190212,'date':{'$gte':_0x448eee,'$lte':_0x895d42}}},{'$lookup':{'from':_0x5af85d(0x217),'let':{'invoice':_0x5af85d(0x23a)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x5af85d(0x233),_0x5af85d(0x1e9)]}}},{'$project':{'_id':_0x5af85d(0x236),'product_name':_0x5af85d(0x1de),'product_code':_0x5af85d(0x21b),'quantity_available':_0x5af85d(0x206),'warehouse_name':_0x5af85d(0x1f1),'warehouse_room':_0x5af85d(0x1ee),'invoice':'$product_details.invoice','production_date':_0x5af85d(0x21a),'expiry_date':_0x5af85d(0x22b),'UOM':'$product_details.unit'}}],'as':_0x5af85d(0x1f6)}}]);_0x15d655[_0x5af85d(0x1f3)]={},await Promise['all'](_0x15d655[_0x5af85d(0x22c)](async _0xe6f9f2=>{var _0x45e7f6=_0x5af85d;_0x15d655[_0x45e7f6(0x1f3)][_0xe6f9f2['invoice']]=[],await Promise[_0x45e7f6(0x22d)](_0xe6f9f2['warehouse_data'][_0x45e7f6(0x22c)](async _0x5dee36=>{var _0x1cde05=_0x45e7f6;const _0x20968c=await sales_finished[_0x1cde05(0x212)]([{'$unwind':_0x1cde05(0x238)},{'$match':{'sale_product.id_transaction_from':_0x5dee36[_0x1cde05(0x213)][_0x1cde05(0x208)](),'sale_product.invoice':_0x5dee36[_0x1cde05(0x230)]}},{'$project':{'_id':_0x1cde05(0x23e),'product_name':_0x1cde05(0x214),'product_code':'$sale_product.product_code','quantity_available':_0x1cde05(0x1e8),'warehouse_name':_0x1cde05(0x228),'warehouse_room':_0x1cde05(0x1ec),'product_invoice':_0x1cde05(0x21c),'invoice':_0x1cde05(0x23a),'id_transaction_from':_0x1cde05(0x22a),'date':_0x1cde05(0x21f),'production_date':_0x1cde05(0x22f),'expiry_date':_0x1cde05(0x21e),'UOM':_0x1cde05(0x232)}}]);_0x20968c[_0x1cde05(0x1e4)]>0x0&&_0x15d655[_0x1cde05(0x1f3)][_0xe6f9f2[_0x1cde05(0x230)]]['push'](..._0x20968c);}));})),_0x15d655['data_sales']=_0x15d655[_0x5af85d(0x1f3)],_0x15d655[_0x5af85d(0x1e7)]={},await Promise[_0x5af85d(0x22d)](_0x15d655[_0x5af85d(0x22c)](async _0x152a41=>{var _0x54ecb5=_0x5af85d;_0x15d655[_0x54ecb5(0x1e7)][_0x152a41[_0x54ecb5(0x230)]]=[],await Promise[_0x54ecb5(0x22d)](_0x152a41[_0x54ecb5(0x1f6)]['map'](async _0x81aaf8=>{var _0x493cdb=_0x54ecb5;const _0x358cd8=await adjustment_finished[_0x493cdb(0x212)]([{'$unwind':_0x493cdb(0x1df)},{'$match':{'product.id_transaction_from':_0x81aaf8[_0x493cdb(0x213)]['valueOf'](),'product.invoice':_0x81aaf8[_0x493cdb(0x230)]}},{'$project':{'_id':_0x493cdb(0x23f),'product_name':_0x493cdb(0x229),'product_code':'$product.product_code','quantity_available':_0x493cdb(0x1d8),'warehouse_name':_0x493cdb(0x228),'warehouse_room':_0x493cdb(0x1ed),'product_invoice':_0x493cdb(0x1e1),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':'$product.production_date','expiry_date':_0x493cdb(0x210),'UOM':_0x493cdb(0x1f2)}}]);_0x358cd8[_0x493cdb(0x1e4)]>0x0&&_0x15d655[_0x493cdb(0x1e7)][_0x152a41[_0x493cdb(0x230)]][_0x493cdb(0x21d)](..._0x358cd8);}));})),_0x15d655[_0x5af85d(0x223)]={},await Promise[_0x5af85d(0x22d)](_0x15d655['map'](async _0x5b3d3b=>{var _0x5c7748=_0x5af85d;_0x15d655[_0x5c7748(0x223)][_0x5b3d3b[_0x5c7748(0x230)]]=[],await Promise['all'](_0x5b3d3b[_0x5c7748(0x1f6)][_0x5c7748(0x22c)](async _0x41564e=>{var _0x177065=_0x5c7748;const _0x10d62e=await transfers_finished[_0x177065(0x212)]([{'$unwind':_0x177065(0x1df)},{'$match':{'product.id_transaction':_0x41564e['_id'][_0x177065(0x208)](),'product.from_invoice':_0x41564e['invoice']}},{'$project':{'_id':_0x177065(0x23f),'product_name':_0x177065(0x229),'product_code':'$product.product_code','quantity_available':_0x177065(0x202),'warehouse_name':_0x177065(0x1d7),'warehouse_room':_0x177065(0x1ed),'product_invoice':_0x177065(0x1fc),'invoice':_0x177065(0x23a),'id_transaction_from':_0x177065(0x220),'date':_0x177065(0x21f),'production_date':_0x177065(0x1db),'expiry_date':_0x177065(0x210),'UOM':_0x177065(0x1f2)}}]);_0x10d62e[_0x177065(0x1e4)]>0x0&&_0x15d655['data_transfer'][_0x5b3d3b['invoice']]['push'](..._0x10d62e);}));})),_0x77f931[_0x5af85d(0x1ea)]({'purchases_warehouse':_0x15d655,'data_sales':_0x15d655[_0x5af85d(0x1f3)],'data_adjustment':_0x15d655[_0x5af85d(0x1e7)],'data_transfer':_0x15d655[_0x5af85d(0x223)]});}}}),router[a0_0xf640b7(0x23d)]('/viewdata_inc_fg/:id',auth,async(_0x2a1e36,_0x30143)=>{var _0x12f6ae=a0_0xf640b7;try{const _0x50f1f0=_0x2a1e36[_0x12f6ae(0x1e5)]['id'];var _0x431877=await purchases_finished[_0x12f6ae(0x224)](_0x50f1f0);const _0x561c84=await master_shop[_0x12f6ae(0x203)](),_0x19d91b=_0x2a1e36[_0x12f6ae(0x226)],_0x16684b=await profile[_0x12f6ae(0x1f5)]({'email':_0x19d91b[_0x12f6ae(0x1fe)]});if(_0x561c84[0x0][_0x12f6ae(0x20f)]==_0x12f6ae(0x216))var _0x32dc19=users['English'];else{if(_0x561c84[0x0]['language']==_0x12f6ae(0x235))var _0x32dc19=users['Hindi'];else{if(_0x561c84[0x0][_0x12f6ae(0x20f)]=='German')var _0x32dc19=users[_0x12f6ae(0x1e3)];else{if(_0x561c84[0x0]['language']==_0x12f6ae(0x1fd))var _0x32dc19=users[_0x12f6ae(0x1fd)];else{if(_0x561c84[0x0][_0x12f6ae(0x20f)]==_0x12f6ae(0x219))var _0x32dc19=users[_0x12f6ae(0x219)];else{if(_0x561c84[0x0]['language']==_0x12f6ae(0x207))var _0x32dc19=users[_0x12f6ae(0x209)];else{if(_0x561c84[0x0][_0x12f6ae(0x20f)]==_0x12f6ae(0x239))var _0x32dc19=users[_0x12f6ae(0x239)];else{if(_0x561c84[0x0][_0x12f6ae(0x20f)]==_0x12f6ae(0x20b))var _0x32dc19=users[_0x12f6ae(0x1fb)];}}}}}}}_0x30143['render'](_0x12f6ae(0x211),{'success':_0x2a1e36[_0x12f6ae(0x1ff)](_0x12f6ae(0x20d)),'errors':_0x2a1e36['flash'](_0x12f6ae(0x1e0)),'master_shop':_0x561c84,'profile':_0x16684b,'role':_0x19d91b,'language':_0x32dc19,'data':_0x431877});}catch(_0x515c4d){_0x30143[_0x12f6ae(0x1ea)](_0x515c4d);}}),router['get'](a0_0xf640b7(0x205),auth,async(_0xc450f5,_0x1a17d1)=>{var _0x4b83f3=a0_0xf640b7;try{const _0x342a2d=_0xc450f5[_0x4b83f3(0x1e5)]['id'];var _0xe7a948=await sales_finished['findById'](_0x342a2d);const _0x1394ce=await master_shop['find'](),_0x3466d2=_0xc450f5[_0x4b83f3(0x226)],_0x59c6a5=await profile[_0x4b83f3(0x1f5)]({'email':_0x3466d2['email']});if(_0x1394ce[0x0][_0x4b83f3(0x20f)]==_0x4b83f3(0x216))var _0x2579e1=users[_0x4b83f3(0x23c)];else{if(_0x1394ce[0x0][_0x4b83f3(0x20f)]==_0x4b83f3(0x235))var _0x2579e1=users['Hindi'];else{if(_0x1394ce[0x0][_0x4b83f3(0x20f)]==_0x4b83f3(0x1e3))var _0x2579e1=users['German'];else{if(_0x1394ce[0x0]['language']==_0x4b83f3(0x1fd))var _0x2579e1=users[_0x4b83f3(0x1fd)];else{if(_0x1394ce[0x0]['language']==_0x4b83f3(0x219))var _0x2579e1=users[_0x4b83f3(0x219)];else{if(_0x1394ce[0x0][_0x4b83f3(0x20f)]==_0x4b83f3(0x207))var _0x2579e1=users[_0x4b83f3(0x209)];else{if(_0x1394ce[0x0][_0x4b83f3(0x20f)]==_0x4b83f3(0x239))var _0x2579e1=users[_0x4b83f3(0x239)];else{if(_0x1394ce[0x0][_0x4b83f3(0x20f)]==_0x4b83f3(0x20b))var _0x2579e1=users[_0x4b83f3(0x1fb)];}}}}}}}_0x1a17d1[_0x4b83f3(0x1f9)]('view_og_table',{'success':_0xc450f5[_0x4b83f3(0x1ff)](_0x4b83f3(0x20d)),'errors':_0xc450f5[_0x4b83f3(0x1ff)](_0x4b83f3(0x1e0)),'master_shop':_0x1394ce,'profile':_0x59c6a5,'role':_0x3466d2,'language':_0x2579e1,'data':_0xe7a948});}catch(_0x7a5cb){_0x1a17d1[_0x4b83f3(0x1ea)](_0x7a5cb);}}),router[a0_0xf640b7(0x23d)](a0_0xf640b7(0x222),auth,async(_0x509c15,_0x1d2add)=>{var _0x25ab70=a0_0xf640b7;try{const _0x3d2ebb=_0x509c15[_0x25ab70(0x1e5)]['id'];var _0x4cf5d9=await transfers_finished[_0x25ab70(0x224)](_0x3d2ebb);const _0x13622d=await master_shop[_0x25ab70(0x203)](),_0x42801b=_0x509c15[_0x25ab70(0x226)],_0x15f31d=await profile[_0x25ab70(0x1f5)]({'email':_0x42801b[_0x25ab70(0x1fe)]});if(_0x13622d[0x0][_0x25ab70(0x20f)]==_0x25ab70(0x216))var _0xcf87d7=users[_0x25ab70(0x23c)];else{if(_0x13622d[0x0][_0x25ab70(0x20f)]==_0x25ab70(0x235))var _0xcf87d7=users[_0x25ab70(0x235)];else{if(_0x13622d[0x0]['language']=='German')var _0xcf87d7=users[_0x25ab70(0x1e3)];else{if(_0x13622d[0x0][_0x25ab70(0x20f)]==_0x25ab70(0x1fd))var _0xcf87d7=users[_0x25ab70(0x1fd)];else{if(_0x13622d[0x0]['language']==_0x25ab70(0x219))var _0xcf87d7=users['French'];else{if(_0x13622d[0x0][_0x25ab70(0x20f)]==_0x25ab70(0x207))var _0xcf87d7=users[_0x25ab70(0x209)];else{if(_0x13622d[0x0][_0x25ab70(0x20f)]=='Chinese')var _0xcf87d7=users['Chinese'];else{if(_0x13622d[0x0][_0x25ab70(0x20f)]==_0x25ab70(0x20b))var _0xcf87d7=users['Arabic'];}}}}}}}_0x1d2add['render'](_0x25ab70(0x1f8),{'success':_0x509c15[_0x25ab70(0x1ff)](_0x25ab70(0x20d)),'errors':_0x509c15[_0x25ab70(0x1ff)](_0x25ab70(0x1e0)),'master_shop':_0x13622d,'profile':_0x15f31d,'role':_0x42801b,'language':_0xcf87d7,'data':_0x4cf5d9});}catch(_0x4d2ffb){_0x1d2add[_0x25ab70(0x1ea)](_0x4d2ffb);}}),router[a0_0xf640b7(0x23d)](a0_0xf640b7(0x1d5),auth,async(_0x234625,_0x1d3041)=>{var _0x55a713=a0_0xf640b7;try{const {username:_0x47cea9,email:_0x216a83,role:_0x39dfd6}=_0x234625[_0x55a713(0x226)],_0x4ab334=_0x234625[_0x55a713(0x226)],_0x42655d=await profile[_0x55a713(0x1f5)]({'email':_0x4ab334[_0x55a713(0x1fe)]}),_0x27b02b=await master_shop[_0x55a713(0x203)](),_0x57f3c2=await warehouse['aggregate']([{'$match':{'status':_0x55a713(0x1f7),'warehouse_category':_0x55a713(0x225)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0x27b02b[0x0][_0x55a713(0x20f)]==_0x55a713(0x216))var _0x4a9a44=users[_0x55a713(0x23c)];else{if(_0x27b02b[0x0]['language']==_0x55a713(0x235))var _0x4a9a44=users[_0x55a713(0x235)];else{if(_0x27b02b[0x0][_0x55a713(0x20f)]==_0x55a713(0x1e3))var _0x4a9a44=users['German'];else{if(_0x27b02b[0x0]['language']==_0x55a713(0x1fd))var _0x4a9a44=users[_0x55a713(0x1fd)];else{if(_0x27b02b[0x0][_0x55a713(0x20f)]==_0x55a713(0x219))var _0x4a9a44=users[_0x55a713(0x219)];else{if(_0x27b02b[0x0]['language']=='Portuguese\x20(BR)')var _0x4a9a44=users[_0x55a713(0x209)];else{if(_0x27b02b[0x0][_0x55a713(0x20f)]=='Chinese')var _0x4a9a44=users[_0x55a713(0x239)];else{if(_0x27b02b[0x0][_0x55a713(0x20f)]=='Arabic\x20(ae)')var _0x4a9a44=users[_0x55a713(0x1fb)];}}}}}}}_0x1d3041[_0x55a713(0x1f9)]('transaction_finished_raw',{'success':_0x234625[_0x55a713(0x1ff)]('success'),'errors':_0x234625[_0x55a713(0x1ff)](_0x55a713(0x1e0)),'role':_0x4ab334,'profile':_0x42655d,'master_shop':_0x27b02b,'dataProcess':_0x57f3c2,'language':_0x4a9a44});}catch(_0x220e7d){console[_0x55a713(0x1dd)](_0x220e7d);}}),module['exports']=router;