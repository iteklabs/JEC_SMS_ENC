function a0_0x2599(_0x3bb554,_0x12896e){var _0x4d5da2=a0_0x4d5d();return a0_0x2599=function(_0x2599af,_0x1ee39e){_0x2599af=_0x2599af-0x1c3;var _0x39e1c2=_0x4d5da2[_0x2599af];return _0x39e1c2;},a0_0x2599(_0x3bb554,_0x12896e);}var a0_0x14358b=a0_0x2599;(function(_0x436bb6,_0x1c67a4){var _0x4e50e2=a0_0x2599,_0xbfcdd=_0x436bb6();while(!![]){try{var _0x23be95=parseInt(_0x4e50e2(0x203))/0x1+parseInt(_0x4e50e2(0x1d4))/0x2+-parseInt(_0x4e50e2(0x1e8))/0x3+-parseInt(_0x4e50e2(0x1cc))/0x4+parseInt(_0x4e50e2(0x200))/0x5+-parseInt(_0x4e50e2(0x1ca))/0x6+parseInt(_0x4e50e2(0x212))/0x7;if(_0x23be95===_0x1c67a4)break;else _0xbfcdd['push'](_0xbfcdd['shift']());}catch(_0x46bf55){_0xbfcdd['push'](_0xbfcdd['shift']());}}}(a0_0x4d5d,0x26eb3));function a0_0x4d5d(){var _0x3fcef0=['render','$product.to_room_name','$product.product_name','$sale_product.expiry_date','$sale_product.quantity','$sale_product.product_code','$warehouse_name','$product_details.product_name','Portuguese','data_sales','$sale_product','Arabic','$product.product_code','$product._id','165610pMgKtH','findOne','$product','31520uqgcop','success','express','map','German','$product.production_date','$product.id_transaction_id','$product.id_transaction_from','$sale_product.product_name','$product_details.product_stock','$product_details.invoice','$$invoice','Hindi','find','English\x20(US)','4022858CrbgFM','$product.room_names','params','$date','data_adjustment','findById','length','push','$sale_product._id','data_transfer','$product.invoice','../public/language/languages.json','$sale_product.room_name','view_og_table','view_tf_table','$product.id_transaction','json','Portuguese\x20(BR)','get','$sale_product.unit','nodemailer','English','warehouses','view_table','user','$product.unit','valueOf','$to_warehouse','/viewdata_og_fg/:id','$product_details._id','French','Enabled','730236YGKCOZ','$invoice','752744nNTbOd','log','$sale_product.invoice','_id','$product.to_quantity','$product_details.product_code','/view','/viewdata_tf_fg/:id','251674eBZIVs','errors','Spanish','Finished\x20Goods','Raw\x20Materials','/reports','$product_details','../models/all_models','$sale_product.production_date','email','invoice','Arabic\x20(ae)','language','$room','$product_details.production_date','all','Chinese','exports','warehouse_data','flash','887610DgKQJZ','$product_details.unit','post','aggregate','$product.new_adjust_qty','$product.expiry_date','transaction_finished_raw','$product_details.expiry_date','$sale_product.id_transaction_from','$name'];a0_0x4d5d=function(){return _0x3fcef0;};return a0_0x4d5d();}const express=require(a0_0x14358b(0x205)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x14358b(0x1db)),auth=require('../middleware/auth'),users=require(a0_0x14358b(0x21d)),nodemailer=require(a0_0x14358b(0x226));router[a0_0x14358b(0x224)](a0_0x14358b(0x1d2),auth,async(_0x3fe469,_0xd71e8e)=>{var _0x2e89f4=a0_0x14358b;try{const {username:_0x50fb60,email:_0x485411,role:_0x159024}=_0x3fe469[_0x2e89f4(0x22a)],_0x17a834=_0x3fe469[_0x2e89f4(0x22a)],_0x59ab32=await profile['findOne']({'email':_0x17a834[_0x2e89f4(0x1dd)]}),_0x3e63aa=await master_shop[_0x2e89f4(0x210)](),_0x3d55a0=await warehouse['aggregate']([{'$match':{'status':_0x2e89f4(0x1c9),'warehouse_category':_0x2e89f4(0x1d7)}},{'$group':{'_id':_0x2e89f4(0x1f1),'name':{'$first':_0x2e89f4(0x1f1)}}}]);if(_0x3e63aa[0x0]['language']==_0x2e89f4(0x211))var _0x494e4d=users[_0x2e89f4(0x227)];else{if(_0x3e63aa[0x0][_0x2e89f4(0x1e0)]==_0x2e89f4(0x20f))var _0x494e4d=users['Hindi'];else{if(_0x3e63aa[0x0]['language']==_0x2e89f4(0x207))var _0x494e4d=users[_0x2e89f4(0x207)];else{if(_0x3e63aa[0x0][_0x2e89f4(0x1e0)]==_0x2e89f4(0x1d6))var _0x494e4d=users[_0x2e89f4(0x1d6)];else{if(_0x3e63aa[0x0][_0x2e89f4(0x1e0)]=='French')var _0x494e4d=users['French'];else{if(_0x3e63aa[0x0][_0x2e89f4(0x1e0)]==_0x2e89f4(0x223))var _0x494e4d=users['Portuguese'];else{if(_0x3e63aa[0x0]['language']=='Chinese')var _0x494e4d=users[_0x2e89f4(0x1e4)];else{if(_0x3e63aa[0x0][_0x2e89f4(0x1e0)]==_0x2e89f4(0x1df))var _0x494e4d=users[_0x2e89f4(0x1fd)];}}}}}}}_0xd71e8e['render']('transaction_finished',{'success':_0x3fe469[_0x2e89f4(0x1e7)]('success'),'errors':_0x3fe469['flash'](_0x2e89f4(0x1d5)),'role':_0x17a834,'profile':_0x59ab32,'master_shop':_0x3e63aa,'dataProcess':_0x3d55a0,'language':_0x494e4d});}catch(_0x5401a1){console[_0x2e89f4(0x1cd)](_0x5401a1);}}),router[a0_0x14358b(0x1ea)](a0_0x14358b(0x1d9),auth,async(_0x7c8f10,_0x2b69dc)=>{var _0xfa2795=a0_0x14358b;const {product_category:_0x342ca2,transaction_category:_0x5da184,transaction_date_from:_0x141538,transaction_date_to:_0x42e6c6,warehouse_category:_0x576831,item_code:_0x3c6792}=_0x7c8f10['body'];console['log'](_0x576831);if(_0x342ca2=='rm'){if(_0x576831==_0xfa2795(0x1e3)){var _0x2df07c=await purchases[_0xfa2795(0x1eb)]([{'$match':{'date':{'$gte':_0x141538,'$lte':_0x42e6c6}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0xfa2795(0x1cb)},'pipeline':[{'$unwind':_0xfa2795(0x1da)},{'$match':{'$expr':{'$eq':[_0xfa2795(0x20e),_0xfa2795(0x20d)]}}},{'$project':{'_id':'$product_details._id','product_name':_0xfa2795(0x1f9),'product_code':'$product_details.product_code','quantity_available':_0xfa2795(0x20c),'warehouse_name':_0xfa2795(0x1f1),'warehouse_room':_0xfa2795(0x1e1),'invoice':_0xfa2795(0x20d),'production_date':_0xfa2795(0x1e2),'expiry_date':_0xfa2795(0x1ef),'UOM':_0xfa2795(0x1e9)}}],'as':_0xfa2795(0x1e6)}}]);_0x2df07c['data_sales']={},await Promise[_0xfa2795(0x1e3)](_0x2df07c[_0xfa2795(0x206)](async _0x2025b8=>{var _0x53f203=_0xfa2795;_0x2df07c['data_sales'][_0x2025b8[_0x53f203(0x1de)]]=[],await Promise[_0x53f203(0x1e3)](_0x2025b8[_0x53f203(0x1e6)]['map'](async _0x5087f1=>{var _0x2c7ef8=_0x53f203;const _0x3d2011=await sales[_0x2c7ef8(0x1eb)]([{'$unwind':_0x2c7ef8(0x1fc)},{'$match':{'sale_product.id_transaction_from':_0x5087f1['_id'][_0x2c7ef8(0x1c4)](),'sale_product.invoice':_0x5087f1['invoice']}},{'$project':{'_id':_0x2c7ef8(0x21a),'product_name':'$sale_product.product_name','product_code':_0x2c7ef8(0x1f7),'quantity_available':_0x2c7ef8(0x1f6),'warehouse_name':_0x2c7ef8(0x1f8),'warehouse_room':_0x2c7ef8(0x21e),'product_invoice':_0x2c7ef8(0x1ce),'invoice':_0x2c7ef8(0x1cb),'id_transaction_from':_0x2c7ef8(0x1f0),'date':_0x2c7ef8(0x215),'production_date':_0x2c7ef8(0x1dc),'expiry_date':_0x2c7ef8(0x1f5),'UOM':_0x2c7ef8(0x225)}}]);_0x3d2011[_0x2c7ef8(0x218)]>0x0&&_0x2df07c[_0x2c7ef8(0x1fb)][_0x2025b8['invoice']][_0x2c7ef8(0x219)](..._0x3d2011);}));})),_0x2df07c[_0xfa2795(0x1fb)]=_0x2df07c[_0xfa2795(0x1fb)],_0x2df07c['data_adjustment']={},await Promise[_0xfa2795(0x1e3)](_0x2df07c[_0xfa2795(0x206)](async _0xf186bd=>{var _0x5678c2=_0xfa2795;_0x2df07c['data_adjustment'][_0xf186bd[_0x5678c2(0x1de)]]=[],await Promise['all'](_0xf186bd[_0x5678c2(0x1e6)][_0x5678c2(0x206)](async _0x5c9bd8=>{var _0x3fe0b4=_0x5678c2;const _0x3b5518=await adjustment['aggregate']([{'$unwind':_0x3fe0b4(0x202)},{'$match':{'product.id_transaction_from':_0x5c9bd8[_0x3fe0b4(0x1cf)][_0x3fe0b4(0x1c4)](),'product.invoice':_0x5c9bd8[_0x3fe0b4(0x1de)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x3fe0b4(0x1fe),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x3fe0b4(0x213),'product_invoice':_0x3fe0b4(0x21c),'invoice':_0x3fe0b4(0x1cb),'id_transaction_from':_0x3fe0b4(0x20a),'date':_0x3fe0b4(0x215),'production_date':_0x3fe0b4(0x208),'expiry_date':'$product.expiry_date','UOM':_0x3fe0b4(0x1c3)}}]);_0x3b5518['length']>0x0&&_0x2df07c[_0x3fe0b4(0x216)][_0xf186bd['invoice']][_0x3fe0b4(0x219)](..._0x3b5518);}));})),_0x2df07c[_0xfa2795(0x21b)]={},await Promise[_0xfa2795(0x1e3)](_0x2df07c[_0xfa2795(0x206)](async _0x32bce5=>{var _0x25b153=_0xfa2795;_0x2df07c[_0x25b153(0x21b)][_0x32bce5['invoice']]=[],await Promise[_0x25b153(0x1e3)](_0x32bce5['warehouse_data']['map'](async _0x538335=>{var _0x9911ff=_0x25b153;const _0x1b2724=await transfers[_0x9911ff(0x1eb)]([{'$unwind':_0x9911ff(0x202)},{'$match':{'product.id_transaction_id':_0x538335[_0x9911ff(0x1cf)][_0x9911ff(0x1c4)](),'product.To_invoice':_0x538335[_0x9911ff(0x1de)]}},{'$project':{'_id':_0x9911ff(0x1ff),'product_name':_0x9911ff(0x1f4),'product_code':_0x9911ff(0x1fe),'quantity_available':_0x9911ff(0x1d0),'warehouse_name':_0x9911ff(0x1c5),'warehouse_room':_0x9911ff(0x213),'product_invoice':_0x9911ff(0x1f3),'invoice':_0x9911ff(0x1cb),'id_transaction_from':_0x9911ff(0x209),'date':_0x9911ff(0x215),'production_date':_0x9911ff(0x208),'expiry_date':_0x9911ff(0x1ed),'UOM':_0x9911ff(0x1c3)}}]);_0x1b2724[_0x9911ff(0x218)]>0x0&&_0x2df07c['data_transfer'][_0x32bce5[_0x9911ff(0x1de)]]['push'](..._0x1b2724);}));})),_0x2b69dc[_0xfa2795(0x222)]({'purchases_warehouse':_0x2df07c,'data_sales':_0x2df07c['data_sales'],'data_adjustment':_0x2df07c['data_adjustment'],'data_transfer':_0x2df07c[_0xfa2795(0x21b)]});}else{var _0x2df07c=await purchases['aggregate']([{'$match':{'warehouse_name':_0x576831,'date':{'$gte':_0x141538,'$lte':_0x42e6c6}}},{'$lookup':{'from':_0xfa2795(0x228),'let':{'invoice':_0xfa2795(0x1cb)},'pipeline':[{'$unwind':_0xfa2795(0x1da)},{'$match':{'$expr':{'$eq':[_0xfa2795(0x20e),_0xfa2795(0x20d)]}}},{'$project':{'_id':_0xfa2795(0x1c7),'product_name':'$product_details.product_name','product_code':_0xfa2795(0x1d1),'quantity_available':_0xfa2795(0x20c),'warehouse_name':_0xfa2795(0x1f1),'warehouse_room':_0xfa2795(0x1e1),'invoice':'$product_details.invoice','production_date':'$product_details.production_date','expiry_date':_0xfa2795(0x1ef),'UOM':'$product_details.unit'}}],'as':'warehouse_data'}}]);_0x2df07c[_0xfa2795(0x1fb)]={},await Promise[_0xfa2795(0x1e3)](_0x2df07c[_0xfa2795(0x206)](async _0x5d4736=>{var _0x2e1a21=_0xfa2795;_0x2df07c[_0x2e1a21(0x1fb)][_0x5d4736[_0x2e1a21(0x1de)]]=[],await Promise[_0x2e1a21(0x1e3)](_0x5d4736['warehouse_data'][_0x2e1a21(0x206)](async _0x55b232=>{var _0x42903f=_0x2e1a21;const _0x517c46=await sales['aggregate']([{'$unwind':_0x42903f(0x1fc)},{'$match':{'sale_product.id_transaction_from':_0x55b232['_id'][_0x42903f(0x1c4)](),'sale_product.invoice':_0x55b232['invoice']}},{'$project':{'_id':_0x42903f(0x21a),'product_name':_0x42903f(0x20b),'product_code':'$sale_product.product_code','quantity_available':_0x42903f(0x1f6),'warehouse_name':_0x42903f(0x1f8),'warehouse_room':_0x42903f(0x21e),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x42903f(0x1f0),'date':_0x42903f(0x215),'production_date':_0x42903f(0x1dc),'expiry_date':'$sale_product.expiry_date','UOM':_0x42903f(0x225)}}]);_0x517c46[_0x42903f(0x218)]>0x0&&_0x2df07c[_0x42903f(0x1fb)][_0x5d4736[_0x42903f(0x1de)]][_0x42903f(0x219)](..._0x517c46);}));})),_0x2df07c[_0xfa2795(0x1fb)]=_0x2df07c[_0xfa2795(0x1fb)],_0x2df07c['data_adjustment']={},await Promise[_0xfa2795(0x1e3)](_0x2df07c[_0xfa2795(0x206)](async _0x2df2cb=>{var _0x523f52=_0xfa2795;_0x2df07c[_0x523f52(0x216)][_0x2df2cb[_0x523f52(0x1de)]]=[],await Promise[_0x523f52(0x1e3)](_0x2df2cb[_0x523f52(0x1e6)][_0x523f52(0x206)](async _0x3dabc1=>{var _0x6db1e=_0x523f52;const _0x1b6729=await adjustment[_0x6db1e(0x1eb)]([{'$unwind':_0x6db1e(0x202)},{'$match':{'product.id_transaction_from':_0x3dabc1[_0x6db1e(0x1cf)][_0x6db1e(0x1c4)](),'product.invoice':_0x3dabc1['invoice']}},{'$project':{'_id':_0x6db1e(0x1ff),'product_name':_0x6db1e(0x1f4),'product_code':'$product.product_code','quantity_available':_0x6db1e(0x1ec),'warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':_0x6db1e(0x21c),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':_0x6db1e(0x215),'production_date':_0x6db1e(0x208),'expiry_date':_0x6db1e(0x1ed),'UOM':_0x6db1e(0x1c3)}}]);_0x1b6729['length']>0x0&&_0x2df07c[_0x6db1e(0x216)][_0x2df2cb[_0x6db1e(0x1de)]][_0x6db1e(0x219)](..._0x1b6729);}));})),_0x2df07c[_0xfa2795(0x21b)]={},await Promise[_0xfa2795(0x1e3)](_0x2df07c[_0xfa2795(0x206)](async _0x1b52ea=>{var _0x860f2=_0xfa2795;_0x2df07c[_0x860f2(0x21b)][_0x1b52ea[_0x860f2(0x1de)]]=[],await Promise[_0x860f2(0x1e3)](_0x1b52ea[_0x860f2(0x1e6)][_0x860f2(0x206)](async _0x314022=>{var _0x5dcf40=_0x860f2;const _0xfe6e06=await transfers['aggregate']([{'$unwind':_0x5dcf40(0x202)},{'$match':{'product.id_transaction_id':_0x314022[_0x5dcf40(0x1cf)][_0x5dcf40(0x1c4)](),'product.To_invoice':_0x314022[_0x5dcf40(0x1de)]}},{'$project':{'_id':'$product._id','product_name':_0x5dcf40(0x1f4),'product_code':_0x5dcf40(0x1fe),'quantity_available':_0x5dcf40(0x1d0),'warehouse_name':_0x5dcf40(0x1c5),'warehouse_room':_0x5dcf40(0x213),'product_invoice':_0x5dcf40(0x1f3),'invoice':_0x5dcf40(0x1cb),'id_transaction_from':_0x5dcf40(0x209),'date':_0x5dcf40(0x215),'production_date':_0x5dcf40(0x208),'expiry_date':'$product.expiry_date','UOM':_0x5dcf40(0x1c3)}}]);_0xfe6e06['length']>0x0&&_0x2df07c[_0x5dcf40(0x21b)][_0x1b52ea[_0x5dcf40(0x1de)]][_0x5dcf40(0x219)](..._0xfe6e06);}));})),_0x2b69dc[_0xfa2795(0x222)]({'purchases_warehouse':_0x2df07c,'data_sales':_0x2df07c[_0xfa2795(0x1fb)],'data_adjustment':_0x2df07c[_0xfa2795(0x216)],'data_transfer':_0x2df07c[_0xfa2795(0x21b)]});}}else{if(_0x576831==_0xfa2795(0x1e3)){var _0x2df07c=await purchases_finished[_0xfa2795(0x1eb)]([{'$match':{'date':{'$gte':_0x141538,'$lte':_0x42e6c6}}},{'$lookup':{'from':_0xfa2795(0x228),'let':{'invoice':_0xfa2795(0x1cb)},'pipeline':[{'$unwind':_0xfa2795(0x1da)},{'$match':{'$expr':{'$eq':[_0xfa2795(0x20e),'$product_details.invoice']}}},{'$project':{'_id':_0xfa2795(0x1c7),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':'$product_details.product_stock','warehouse_name':_0xfa2795(0x1f1),'warehouse_room':_0xfa2795(0x1e1),'invoice':_0xfa2795(0x20d),'production_date':_0xfa2795(0x1e2),'expiry_date':'$product_details.expiry_date','UOM':_0xfa2795(0x1e9)}}],'as':_0xfa2795(0x1e6)}}]);_0x2df07c[_0xfa2795(0x1fb)]={},await Promise[_0xfa2795(0x1e3)](_0x2df07c['map'](async _0x30424c=>{var _0x29d357=_0xfa2795;_0x2df07c['data_sales'][_0x30424c[_0x29d357(0x1de)]]=[],await Promise[_0x29d357(0x1e3)](_0x30424c[_0x29d357(0x1e6)][_0x29d357(0x206)](async _0x3eb287=>{var _0x2ec441=_0x29d357;const _0x1da11a=await sales_finished[_0x2ec441(0x1eb)]([{'$unwind':_0x2ec441(0x1fc)},{'$match':{'sale_product.id_transaction_from':_0x3eb287[_0x2ec441(0x1cf)][_0x2ec441(0x1c4)](),'sale_product.invoice':_0x3eb287[_0x2ec441(0x1de)]}},{'$project':{'_id':_0x2ec441(0x21a),'product_name':_0x2ec441(0x20b),'product_code':_0x2ec441(0x1f7),'quantity_available':'$sale_product.quantity','warehouse_name':_0x2ec441(0x1f8),'warehouse_room':_0x2ec441(0x21e),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x2ec441(0x1f0),'date':_0x2ec441(0x215),'production_date':_0x2ec441(0x1dc),'expiry_date':_0x2ec441(0x1f5),'UOM':'$sale_product.unit'}}]);_0x1da11a[_0x2ec441(0x218)]>0x0&&_0x2df07c[_0x2ec441(0x1fb)][_0x30424c['invoice']][_0x2ec441(0x219)](..._0x1da11a);}));})),_0x2df07c[_0xfa2795(0x1fb)]=_0x2df07c[_0xfa2795(0x1fb)],_0x2df07c[_0xfa2795(0x216)]={},await Promise['all'](_0x2df07c[_0xfa2795(0x206)](async _0x5cce18=>{var _0x16955f=_0xfa2795;_0x2df07c[_0x16955f(0x216)][_0x5cce18[_0x16955f(0x1de)]]=[],await Promise[_0x16955f(0x1e3)](_0x5cce18[_0x16955f(0x1e6)][_0x16955f(0x206)](async _0x8d997e=>{var _0x4a2a48=_0x16955f;const _0xc6a920=await adjustment_finished[_0x4a2a48(0x1eb)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x8d997e['_id'][_0x4a2a48(0x1c4)](),'product.invoice':_0x8d997e['invoice']}},{'$project':{'_id':_0x4a2a48(0x1ff),'product_name':'$product.product_name','product_code':_0x4a2a48(0x1fe),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x4a2a48(0x1f8),'warehouse_room':_0x4a2a48(0x213),'product_invoice':'$product.invoice','invoice':_0x4a2a48(0x1cb),'id_transaction_from':_0x4a2a48(0x20a),'date':_0x4a2a48(0x215),'production_date':_0x4a2a48(0x208),'expiry_date':'$product.expiry_date','UOM':_0x4a2a48(0x1c3)}}]);_0xc6a920[_0x4a2a48(0x218)]>0x0&&_0x2df07c['data_adjustment'][_0x5cce18[_0x4a2a48(0x1de)]][_0x4a2a48(0x219)](..._0xc6a920);}));})),_0x2df07c[_0xfa2795(0x21b)]={},await Promise['all'](_0x2df07c[_0xfa2795(0x206)](async _0x3e98bf=>{var _0x54cd78=_0xfa2795;_0x2df07c[_0x54cd78(0x21b)][_0x3e98bf['invoice']]=[],await Promise[_0x54cd78(0x1e3)](_0x3e98bf[_0x54cd78(0x1e6)][_0x54cd78(0x206)](async _0x38f678=>{var _0x382ea1=_0x54cd78;const _0xea45f9=await transfers_finished[_0x382ea1(0x1eb)]([{'$unwind':_0x382ea1(0x202)},{'$match':{'product.id_transaction':_0x38f678[_0x382ea1(0x1cf)][_0x382ea1(0x1c4)](),'product.from_invoice':_0x38f678[_0x382ea1(0x1de)]}},{'$project':{'_id':_0x382ea1(0x1ff),'product_name':_0x382ea1(0x1f4),'product_code':_0x382ea1(0x1fe),'quantity_available':_0x382ea1(0x1d0),'warehouse_name':_0x382ea1(0x1c5),'warehouse_room':'$product.room_names','product_invoice':_0x382ea1(0x1f3),'invoice':'$invoice','id_transaction_from':_0x382ea1(0x221),'date':_0x382ea1(0x215),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0x382ea1(0x1c3)}}]);_0xea45f9['length']>0x0&&_0x2df07c['data_transfer'][_0x3e98bf[_0x382ea1(0x1de)]]['push'](..._0xea45f9);}));})),_0x2b69dc[_0xfa2795(0x222)]({'purchases_warehouse':_0x2df07c,'data_sales':_0x2df07c['data_sales'],'data_adjustment':_0x2df07c[_0xfa2795(0x216)],'data_transfer':_0x2df07c[_0xfa2795(0x21b)]});}else{var _0x2df07c=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x576831,'date':{'$gte':_0x141538,'$lte':_0x42e6c6}}},{'$lookup':{'from':_0xfa2795(0x228),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0xfa2795(0x1da)},{'$match':{'$expr':{'$eq':['$$invoice',_0xfa2795(0x20d)]}}},{'$project':{'_id':_0xfa2795(0x1c7),'product_name':_0xfa2795(0x1f9),'product_code':_0xfa2795(0x1d1),'quantity_available':'$product_details.product_stock','warehouse_name':_0xfa2795(0x1f1),'warehouse_room':_0xfa2795(0x1e1),'invoice':_0xfa2795(0x20d),'production_date':_0xfa2795(0x1e2),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':_0xfa2795(0x1e6)}}]);_0x2df07c['data_sales']={},await Promise['all'](_0x2df07c[_0xfa2795(0x206)](async _0x40c4e3=>{var _0x52fe86=_0xfa2795;_0x2df07c[_0x52fe86(0x1fb)][_0x40c4e3['invoice']]=[],await Promise['all'](_0x40c4e3['warehouse_data'][_0x52fe86(0x206)](async _0x2fdcf1=>{var _0x381ead=_0x52fe86;const _0xbbc182=await sales_finished['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x2fdcf1[_0x381ead(0x1cf)][_0x381ead(0x1c4)](),'sale_product.invoice':_0x2fdcf1['invoice']}},{'$project':{'_id':_0x381ead(0x21a),'product_name':_0x381ead(0x20b),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':'$sale_product.room_name','product_invoice':_0x381ead(0x1ce),'invoice':_0x381ead(0x1cb),'id_transaction_from':_0x381ead(0x1f0),'date':_0x381ead(0x215),'production_date':'$sale_product.production_date','expiry_date':'$sale_product.expiry_date','UOM':_0x381ead(0x225)}}]);_0xbbc182[_0x381ead(0x218)]>0x0&&_0x2df07c[_0x381ead(0x1fb)][_0x40c4e3['invoice']]['push'](..._0xbbc182);}));})),_0x2df07c['data_sales']=_0x2df07c['data_sales'],_0x2df07c[_0xfa2795(0x216)]={},await Promise['all'](_0x2df07c[_0xfa2795(0x206)](async _0x44af96=>{var _0x2f352c=_0xfa2795;_0x2df07c[_0x2f352c(0x216)][_0x44af96['invoice']]=[],await Promise[_0x2f352c(0x1e3)](_0x44af96[_0x2f352c(0x1e6)][_0x2f352c(0x206)](async _0x39359d=>{var _0x1743a7=_0x2f352c;const _0x44e26f=await adjustment_finished[_0x1743a7(0x1eb)]([{'$unwind':_0x1743a7(0x202)},{'$match':{'product.id_transaction_from':_0x39359d[_0x1743a7(0x1cf)]['valueOf'](),'product.invoice':_0x39359d[_0x1743a7(0x1de)]}},{'$project':{'_id':_0x1743a7(0x1ff),'product_name':_0x1743a7(0x1f4),'product_code':_0x1743a7(0x1fe),'quantity_available':_0x1743a7(0x1ec),'warehouse_name':_0x1743a7(0x1f8),'warehouse_room':_0x1743a7(0x213),'product_invoice':_0x1743a7(0x21c),'invoice':_0x1743a7(0x1cb),'id_transaction_from':_0x1743a7(0x20a),'date':'$date','production_date':_0x1743a7(0x208),'expiry_date':_0x1743a7(0x1ed),'UOM':_0x1743a7(0x1c3)}}]);_0x44e26f['length']>0x0&&_0x2df07c[_0x1743a7(0x216)][_0x44af96[_0x1743a7(0x1de)]][_0x1743a7(0x219)](..._0x44e26f);}));})),_0x2df07c['data_transfer']={},await Promise[_0xfa2795(0x1e3)](_0x2df07c['map'](async _0x586a68=>{var _0x45a414=_0xfa2795;_0x2df07c['data_transfer'][_0x586a68[_0x45a414(0x1de)]]=[],await Promise['all'](_0x586a68[_0x45a414(0x1e6)][_0x45a414(0x206)](async _0x2be464=>{var _0xf9053c=_0x45a414;const _0x14e08f=await transfers_finished[_0xf9053c(0x1eb)]([{'$unwind':_0xf9053c(0x202)},{'$match':{'product.id_transaction':_0x2be464[_0xf9053c(0x1cf)][_0xf9053c(0x1c4)](),'product.from_invoice':_0x2be464[_0xf9053c(0x1de)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0xf9053c(0x1fe),'quantity_available':_0xf9053c(0x1d0),'warehouse_name':_0xf9053c(0x1c5),'warehouse_room':'$product.room_names','product_invoice':_0xf9053c(0x1f3),'invoice':_0xf9053c(0x1cb),'id_transaction_from':'$product.id_transaction','date':_0xf9053c(0x215),'production_date':_0xf9053c(0x208),'expiry_date':_0xf9053c(0x1ed),'UOM':'$product.unit'}}]);_0x14e08f[_0xf9053c(0x218)]>0x0&&_0x2df07c[_0xf9053c(0x21b)][_0x586a68[_0xf9053c(0x1de)]]['push'](..._0x14e08f);}));})),_0x2b69dc[_0xfa2795(0x222)]({'purchases_warehouse':_0x2df07c,'data_sales':_0x2df07c[_0xfa2795(0x1fb)],'data_adjustment':_0x2df07c[_0xfa2795(0x216)],'data_transfer':_0x2df07c[_0xfa2795(0x21b)]});}}}),router[a0_0x14358b(0x224)]('/viewdata_inc_fg/:id',auth,async(_0x56eb2b,_0x1b0bd0)=>{var _0x53d889=a0_0x14358b;try{const _0x5e93d6=_0x56eb2b[_0x53d889(0x214)]['id'];var _0x31e47b=await purchases_finished[_0x53d889(0x217)](_0x5e93d6);const _0x31d094=await master_shop[_0x53d889(0x210)](),_0xe4eae6=_0x56eb2b[_0x53d889(0x22a)],_0x352625=await profile[_0x53d889(0x201)]({'email':_0xe4eae6[_0x53d889(0x1dd)]});if(_0x31d094[0x0]['language']=='English\x20(US)')var _0x3c76dc=users[_0x53d889(0x227)];else{if(_0x31d094[0x0][_0x53d889(0x1e0)]==_0x53d889(0x20f))var _0x3c76dc=users[_0x53d889(0x20f)];else{if(_0x31d094[0x0][_0x53d889(0x1e0)]==_0x53d889(0x207))var _0x3c76dc=users['German'];else{if(_0x31d094[0x0][_0x53d889(0x1e0)]==_0x53d889(0x1d6))var _0x3c76dc=users[_0x53d889(0x1d6)];else{if(_0x31d094[0x0]['language']==_0x53d889(0x1c8))var _0x3c76dc=users[_0x53d889(0x1c8)];else{if(_0x31d094[0x0]['language']=='Portuguese\x20(BR)')var _0x3c76dc=users[_0x53d889(0x1fa)];else{if(_0x31d094[0x0][_0x53d889(0x1e0)]==_0x53d889(0x1e4))var _0x3c76dc=users[_0x53d889(0x1e4)];else{if(_0x31d094[0x0][_0x53d889(0x1e0)]==_0x53d889(0x1df))var _0x3c76dc=users['Arabic'];}}}}}}}_0x1b0bd0[_0x53d889(0x1f2)](_0x53d889(0x229),{'success':_0x56eb2b['flash'](_0x53d889(0x204)),'errors':_0x56eb2b[_0x53d889(0x1e7)]('errors'),'master_shop':_0x31d094,'profile':_0x352625,'role':_0xe4eae6,'language':_0x3c76dc,'data':_0x31e47b});}catch(_0x5158cb){_0x1b0bd0[_0x53d889(0x222)](_0x5158cb);}}),router[a0_0x14358b(0x224)](a0_0x14358b(0x1c6),auth,async(_0x44dfe6,_0x3a8f42)=>{var _0x319c92=a0_0x14358b;try{const _0x566644=_0x44dfe6[_0x319c92(0x214)]['id'];var _0x215901=await sales_finished['findById'](_0x566644);const _0x4da57a=await master_shop[_0x319c92(0x210)](),_0x9e8a9f=_0x44dfe6[_0x319c92(0x22a)],_0x444cb6=await profile[_0x319c92(0x201)]({'email':_0x9e8a9f['email']});if(_0x4da57a[0x0][_0x319c92(0x1e0)]==_0x319c92(0x211))var _0x441b6f=users[_0x319c92(0x227)];else{if(_0x4da57a[0x0]['language']=='Hindi')var _0x441b6f=users[_0x319c92(0x20f)];else{if(_0x4da57a[0x0]['language']=='German')var _0x441b6f=users['German'];else{if(_0x4da57a[0x0][_0x319c92(0x1e0)]==_0x319c92(0x1d6))var _0x441b6f=users[_0x319c92(0x1d6)];else{if(_0x4da57a[0x0][_0x319c92(0x1e0)]==_0x319c92(0x1c8))var _0x441b6f=users[_0x319c92(0x1c8)];else{if(_0x4da57a[0x0][_0x319c92(0x1e0)]==_0x319c92(0x223))var _0x441b6f=users[_0x319c92(0x1fa)];else{if(_0x4da57a[0x0]['language']==_0x319c92(0x1e4))var _0x441b6f=users[_0x319c92(0x1e4)];else{if(_0x4da57a[0x0][_0x319c92(0x1e0)]==_0x319c92(0x1df))var _0x441b6f=users['Arabic'];}}}}}}}_0x3a8f42[_0x319c92(0x1f2)](_0x319c92(0x21f),{'success':_0x44dfe6[_0x319c92(0x1e7)]('success'),'errors':_0x44dfe6['flash'](_0x319c92(0x1d5)),'master_shop':_0x4da57a,'profile':_0x444cb6,'role':_0x9e8a9f,'language':_0x441b6f,'data':_0x215901});}catch(_0xf9dc6e){_0x3a8f42['json'](_0xf9dc6e);}}),router[a0_0x14358b(0x224)](a0_0x14358b(0x1d3),auth,async(_0x234e16,_0x22d93c)=>{var _0x201c12=a0_0x14358b;try{const _0x293f6f=_0x234e16['params']['id'];var _0x6a670c=await transfers_finished[_0x201c12(0x217)](_0x293f6f);const _0x232ff5=await master_shop[_0x201c12(0x210)](),_0xdf6062=_0x234e16[_0x201c12(0x22a)],_0x217c21=await profile['findOne']({'email':_0xdf6062[_0x201c12(0x1dd)]});if(_0x232ff5[0x0][_0x201c12(0x1e0)]==_0x201c12(0x211))var _0x188da8=users[_0x201c12(0x227)];else{if(_0x232ff5[0x0][_0x201c12(0x1e0)]==_0x201c12(0x20f))var _0x188da8=users[_0x201c12(0x20f)];else{if(_0x232ff5[0x0][_0x201c12(0x1e0)]=='German')var _0x188da8=users[_0x201c12(0x207)];else{if(_0x232ff5[0x0][_0x201c12(0x1e0)]==_0x201c12(0x1d6))var _0x188da8=users['Spanish'];else{if(_0x232ff5[0x0][_0x201c12(0x1e0)]==_0x201c12(0x1c8))var _0x188da8=users[_0x201c12(0x1c8)];else{if(_0x232ff5[0x0][_0x201c12(0x1e0)]==_0x201c12(0x223))var _0x188da8=users[_0x201c12(0x1fa)];else{if(_0x232ff5[0x0][_0x201c12(0x1e0)]==_0x201c12(0x1e4))var _0x188da8=users[_0x201c12(0x1e4)];else{if(_0x232ff5[0x0]['language']==_0x201c12(0x1df))var _0x188da8=users['Arabic'];}}}}}}}_0x22d93c['render'](_0x201c12(0x220),{'success':_0x234e16[_0x201c12(0x1e7)](_0x201c12(0x204)),'errors':_0x234e16[_0x201c12(0x1e7)]('errors'),'master_shop':_0x232ff5,'profile':_0x217c21,'role':_0xdf6062,'language':_0x188da8,'data':_0x6a670c});}catch(_0x102dc5){_0x22d93c[_0x201c12(0x222)](_0x102dc5);}}),router['get']('/viewFG',auth,async(_0x14245e,_0x5132eb)=>{var _0x5a33af=a0_0x14358b;try{const {username:_0x3adca8,email:_0x11062b,role:_0xde09dd}=_0x14245e[_0x5a33af(0x22a)],_0x1a34b9=_0x14245e[_0x5a33af(0x22a)],_0x3e1e66=await profile[_0x5a33af(0x201)]({'email':_0x1a34b9['email']}),_0x38060b=await master_shop[_0x5a33af(0x210)](),_0x35cc90=await warehouse[_0x5a33af(0x1eb)]([{'$match':{'status':'Enabled','warehouse_category':_0x5a33af(0x1d8)}},{'$group':{'_id':'$name','name':{'$first':_0x5a33af(0x1f1)}}}]);if(_0x38060b[0x0][_0x5a33af(0x1e0)]==_0x5a33af(0x211))var _0x52f5e9=users['English'];else{if(_0x38060b[0x0][_0x5a33af(0x1e0)]==_0x5a33af(0x20f))var _0x52f5e9=users['Hindi'];else{if(_0x38060b[0x0][_0x5a33af(0x1e0)]==_0x5a33af(0x207))var _0x52f5e9=users[_0x5a33af(0x207)];else{if(_0x38060b[0x0][_0x5a33af(0x1e0)]==_0x5a33af(0x1d6))var _0x52f5e9=users['Spanish'];else{if(_0x38060b[0x0][_0x5a33af(0x1e0)]==_0x5a33af(0x1c8))var _0x52f5e9=users[_0x5a33af(0x1c8)];else{if(_0x38060b[0x0]['language']==_0x5a33af(0x223))var _0x52f5e9=users[_0x5a33af(0x1fa)];else{if(_0x38060b[0x0][_0x5a33af(0x1e0)]=='Chinese')var _0x52f5e9=users[_0x5a33af(0x1e4)];else{if(_0x38060b[0x0]['language']==_0x5a33af(0x1df))var _0x52f5e9=users['Arabic'];}}}}}}}_0x5132eb['render'](_0x5a33af(0x1ee),{'success':_0x14245e[_0x5a33af(0x1e7)]('success'),'errors':_0x14245e[_0x5a33af(0x1e7)](_0x5a33af(0x1d5)),'role':_0x1a34b9,'profile':_0x3e1e66,'master_shop':_0x38060b,'dataProcess':_0x35cc90,'language':_0x52f5e9});}catch(_0x4c6f31){console[_0x5a33af(0x1cd)](_0x4c6f31);}}),module[a0_0x14358b(0x1e5)]=router;