var a0_0x4b72f9=a0_0x4308;function a0_0x4308(_0x5efad8,_0x52cefb){var _0x299d9c=a0_0x299d();return a0_0x4308=function(_0x4308a0,_0x360842){_0x4308a0=_0x4308a0-0xe4;var _0x41fdde=_0x299d9c[_0x4308a0];return _0x41fdde;},a0_0x4308(_0x5efad8,_0x52cefb);}function a0_0x299d(){var _0x4194f6=['$product.new_adjust_qty','English\x20(US)','$product_details.product_stock','519265BExkfG','$product','view_og_table','valueOf','$sale_product.invoice','$product.product_code','json','params','data_sales','aggregate','$sale_product.quantity','Arabic\x20(ae)','$sale_product.production_date','$product_details.product_name','$to_warehouse','express','7YdnoDq','$$invoice','$product.id_transaction_from','126432QMJChP','map','$product.expiry_date','warehouse_data','German','post','$warehouse_name','Router','find','$product.id_transaction','data_transfer','$invoice','$name','success','invoice','$product_details.invoice','warehouses','$product_details.expiry_date','all','../public/language/languages.json','flash','/viewdata_tf_fg/:id','Spanish','/viewdata_og_fg/:id','nodemailer','Portuguese\x20(BR)','Enabled','$sale_product._id','../middleware/auth','_id','data_adjustment','Chinese','/view','user','errors','$product.invoice','$product_details.product_code','$product._id','$product_details.production_date','$product.id_transaction_id','email','render','$sale_product.room_name','$product_details.unit','1005876ADFfLK','Hindi','Portuguese','Arabic','transaction_finished','$sale_product.id_transaction_from','$product.production_date','findById','/viewdata_inc_fg/:id','$product_details','$product.to_quantity','$sale_product.unit','English','10764711xJQmFn','length','view_tf_table','$product.to_room_name','$product.unit','9BdnDeZ','log','$sale_product.product_code','$sale_product','Raw\x20Materials','French','language','body','$sale_product.expiry_date','$product_details._id','/reports','231612sqifyp','2385240SMoWPh','$product.room_names','$room','get','$product.product_name','push','findOne','$sale_product.product_name','$date','/viewFG','1041784xqPxBv'];a0_0x299d=function(){return _0x4194f6;};return a0_0x299d();}(function(_0x59f51c,_0x390923){var _0x2db917=a0_0x4308,_0x2dd6c6=_0x59f51c();while(!![]){try{var _0xea0bcf=-parseInt(_0x2db917(0x107))/0x1+-parseInt(_0x2db917(0xf8))/0x2+-parseInt(_0x2db917(0xed))/0x3*(parseInt(_0x2db917(0x103))/0x4)+parseInt(_0x2db917(0xf9))/0x5+parseInt(_0x2db917(0x146))/0x6*(parseInt(_0x2db917(0x117))/0x7)+-parseInt(_0x2db917(0x11a))/0x8+parseInt(_0x2db917(0xe8))/0x9;if(_0xea0bcf===_0x390923)break;else _0x2dd6c6['push'](_0x2dd6c6['shift']());}catch(_0x3cd0f6){_0x2dd6c6['push'](_0x2dd6c6['shift']());}}}(a0_0x299d,0x63bf0));const express=require(a0_0x4b72f9(0x116)),app=express(),router=express[a0_0x4b72f9(0x121)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require('../models/all_models'),auth=require(a0_0x4b72f9(0x136)),users=require(a0_0x4b72f9(0x12d)),nodemailer=require(a0_0x4b72f9(0x132));router[a0_0x4b72f9(0xfc)](a0_0x4b72f9(0x13a),auth,async(_0x172940,_0xd797c1)=>{var _0x42ecab=a0_0x4b72f9;try{const {username:_0x922206,email:_0x4e8707,role:_0x186602}=_0x172940[_0x42ecab(0x13b)],_0x335aae=_0x172940[_0x42ecab(0x13b)],_0xdb3ce5=await profile[_0x42ecab(0xff)]({'email':_0x335aae[_0x42ecab(0x142)]}),_0x2e98f0=await master_shop[_0x42ecab(0x122)](),_0x54e9f6=await warehouse[_0x42ecab(0x110)]([{'$match':{'status':_0x42ecab(0x134),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':_0x42ecab(0x126)}}}]);if(_0x2e98f0[0x0][_0x42ecab(0xf3)]==_0x42ecab(0x105))var _0x15b5da=users[_0x42ecab(0xe7)];else{if(_0x2e98f0[0x0][_0x42ecab(0xf3)]==_0x42ecab(0x147))var _0x15b5da=users['Hindi'];else{if(_0x2e98f0[0x0]['language']==_0x42ecab(0x11e))var _0x15b5da=users['German'];else{if(_0x2e98f0[0x0][_0x42ecab(0xf3)]=='Spanish')var _0x15b5da=users[_0x42ecab(0x130)];else{if(_0x2e98f0[0x0][_0x42ecab(0xf3)]==_0x42ecab(0xf2))var _0x15b5da=users[_0x42ecab(0xf2)];else{if(_0x2e98f0[0x0][_0x42ecab(0xf3)]==_0x42ecab(0x133))var _0x15b5da=users[_0x42ecab(0x148)];else{if(_0x2e98f0[0x0][_0x42ecab(0xf3)]==_0x42ecab(0x139))var _0x15b5da=users[_0x42ecab(0x139)];else{if(_0x2e98f0[0x0][_0x42ecab(0xf3)]=='Arabic\x20(ae)')var _0x15b5da=users[_0x42ecab(0x149)];}}}}}}}_0xd797c1[_0x42ecab(0x143)](_0x42ecab(0x14a),{'success':_0x172940[_0x42ecab(0x12e)](_0x42ecab(0x127)),'errors':_0x172940[_0x42ecab(0x12e)](_0x42ecab(0x13c)),'role':_0x335aae,'profile':_0xdb3ce5,'master_shop':_0x2e98f0,'dataProcess':_0x54e9f6,'language':_0x15b5da});}catch(_0x369a2a){console[_0x42ecab(0xee)](_0x369a2a);}}),router[a0_0x4b72f9(0x11f)](a0_0x4b72f9(0xf7),auth,async(_0x1065f1,_0x3041e7)=>{var _0x197d0c=a0_0x4b72f9;const {product_category:_0x2facb2,transaction_category:_0x4bd5be,transaction_date_from:_0x2d813d,transaction_date_to:_0x1a8444,warehouse_category:_0x595e54,item_code:_0x52d75d}=_0x1065f1[_0x197d0c(0xf4)];console[_0x197d0c(0xee)](_0x595e54);if(_0x2facb2=='rm'){if(_0x595e54==_0x197d0c(0x12c)){var _0x58ed11=await purchases[_0x197d0c(0x110)]([{'$match':{'date':{'$gte':_0x2d813d,'$lte':_0x1a8444}}},{'$lookup':{'from':_0x197d0c(0x12a),'let':{'invoice':_0x197d0c(0x125)},'pipeline':[{'$unwind':_0x197d0c(0xe4)},{'$match':{'$expr':{'$eq':[_0x197d0c(0x118),_0x197d0c(0x129)]}}},{'$project':{'_id':_0x197d0c(0xf6),'product_name':_0x197d0c(0x114),'product_code':_0x197d0c(0x13e),'quantity_available':_0x197d0c(0x106),'warehouse_name':'$name','warehouse_room':_0x197d0c(0xfb),'invoice':_0x197d0c(0x129),'production_date':_0x197d0c(0x140),'expiry_date':_0x197d0c(0x12b),'UOM':_0x197d0c(0x145)}}],'as':_0x197d0c(0x11d)}}]);_0x58ed11[_0x197d0c(0x10f)]={},await Promise[_0x197d0c(0x12c)](_0x58ed11[_0x197d0c(0x11b)](async _0x48d26c=>{var _0x5b455d=_0x197d0c;_0x58ed11[_0x5b455d(0x10f)][_0x48d26c[_0x5b455d(0x128)]]=[],await Promise[_0x5b455d(0x12c)](_0x48d26c[_0x5b455d(0x11d)][_0x5b455d(0x11b)](async _0x5bb5c3=>{var _0x43d553=_0x5b455d;const _0x1daf6a=await sales[_0x43d553(0x110)]([{'$unwind':_0x43d553(0xf0)},{'$match':{'sale_product.id_transaction_from':_0x5bb5c3[_0x43d553(0x137)]['valueOf'](),'sale_product.invoice':_0x5bb5c3[_0x43d553(0x128)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x43d553(0x100),'product_code':_0x43d553(0xef),'quantity_available':_0x43d553(0x111),'warehouse_name':_0x43d553(0x120),'warehouse_room':_0x43d553(0x144),'product_invoice':_0x43d553(0x10b),'invoice':_0x43d553(0x125),'id_transaction_from':_0x43d553(0x14b),'date':_0x43d553(0x101),'production_date':_0x43d553(0x113),'expiry_date':_0x43d553(0xf5),'UOM':_0x43d553(0xe6)}}]);_0x1daf6a['length']>0x0&&_0x58ed11[_0x43d553(0x10f)][_0x48d26c[_0x43d553(0x128)]][_0x43d553(0xfe)](..._0x1daf6a);}));})),_0x58ed11[_0x197d0c(0x10f)]=_0x58ed11[_0x197d0c(0x10f)],_0x58ed11[_0x197d0c(0x138)]={},await Promise[_0x197d0c(0x12c)](_0x58ed11[_0x197d0c(0x11b)](async _0x3e6a9b=>{var _0x40400b=_0x197d0c;_0x58ed11[_0x40400b(0x138)][_0x3e6a9b[_0x40400b(0x128)]]=[],await Promise[_0x40400b(0x12c)](_0x3e6a9b[_0x40400b(0x11d)][_0x40400b(0x11b)](async _0x41055e=>{var _0x2780d3=_0x40400b;const _0x4ed2a3=await adjustment[_0x2780d3(0x110)]([{'$unwind':_0x2780d3(0x108)},{'$match':{'product.id_transaction_from':_0x41055e[_0x2780d3(0x137)][_0x2780d3(0x10a)](),'product.invoice':_0x41055e[_0x2780d3(0x128)]}},{'$project':{'_id':_0x2780d3(0x13f),'product_name':_0x2780d3(0xfd),'product_code':_0x2780d3(0x10c),'quantity_available':_0x2780d3(0x104),'warehouse_name':_0x2780d3(0x120),'warehouse_room':'$product.room_names','product_invoice':_0x2780d3(0x13d),'invoice':_0x2780d3(0x125),'id_transaction_from':_0x2780d3(0x119),'date':_0x2780d3(0x101),'production_date':_0x2780d3(0x14c),'expiry_date':'$product.expiry_date','UOM':_0x2780d3(0xec)}}]);_0x4ed2a3[_0x2780d3(0xe9)]>0x0&&_0x58ed11[_0x2780d3(0x138)][_0x3e6a9b[_0x2780d3(0x128)]][_0x2780d3(0xfe)](..._0x4ed2a3);}));})),_0x58ed11[_0x197d0c(0x124)]={},await Promise[_0x197d0c(0x12c)](_0x58ed11[_0x197d0c(0x11b)](async _0x237c10=>{var _0x2b50c7=_0x197d0c;_0x58ed11[_0x2b50c7(0x124)][_0x237c10[_0x2b50c7(0x128)]]=[],await Promise[_0x2b50c7(0x12c)](_0x237c10[_0x2b50c7(0x11d)][_0x2b50c7(0x11b)](async _0x236500=>{var _0x4e4091=_0x2b50c7;const _0xa16c29=await transfers[_0x4e4091(0x110)]([{'$unwind':_0x4e4091(0x108)},{'$match':{'product.id_transaction_id':_0x236500['_id'][_0x4e4091(0x10a)](),'product.To_invoice':_0x236500[_0x4e4091(0x128)]}},{'$project':{'_id':_0x4e4091(0x13f),'product_name':_0x4e4091(0xfd),'product_code':_0x4e4091(0x10c),'quantity_available':_0x4e4091(0xe5),'warehouse_name':_0x4e4091(0x115),'warehouse_room':_0x4e4091(0xfa),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x4e4091(0x141),'date':_0x4e4091(0x101),'production_date':_0x4e4091(0x14c),'expiry_date':_0x4e4091(0x11c),'UOM':_0x4e4091(0xec)}}]);_0xa16c29[_0x4e4091(0xe9)]>0x0&&_0x58ed11[_0x4e4091(0x124)][_0x237c10[_0x4e4091(0x128)]]['push'](..._0xa16c29);}));})),_0x3041e7['json']({'purchases_warehouse':_0x58ed11,'data_sales':_0x58ed11[_0x197d0c(0x10f)],'data_adjustment':_0x58ed11[_0x197d0c(0x138)],'data_transfer':_0x58ed11[_0x197d0c(0x124)]});}else{var _0x58ed11=await purchases[_0x197d0c(0x110)]([{'$match':{'warehouse_name':_0x595e54,'date':{'$gte':_0x2d813d,'$lte':_0x1a8444}}},{'$lookup':{'from':_0x197d0c(0x12a),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x197d0c(0x118),_0x197d0c(0x129)]}}},{'$project':{'_id':_0x197d0c(0xf6),'product_name':_0x197d0c(0x114),'product_code':_0x197d0c(0x13e),'quantity_available':_0x197d0c(0x106),'warehouse_name':_0x197d0c(0x126),'warehouse_room':_0x197d0c(0xfb),'invoice':'$product_details.invoice','production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x197d0c(0x145)}}],'as':_0x197d0c(0x11d)}}]);_0x58ed11['data_sales']={},await Promise[_0x197d0c(0x12c)](_0x58ed11[_0x197d0c(0x11b)](async _0x4a9a97=>{var _0x5d844c=_0x197d0c;_0x58ed11[_0x5d844c(0x10f)][_0x4a9a97[_0x5d844c(0x128)]]=[],await Promise[_0x5d844c(0x12c)](_0x4a9a97[_0x5d844c(0x11d)][_0x5d844c(0x11b)](async _0x1d95d9=>{var _0x29184b=_0x5d844c;const _0x51b58c=await sales[_0x29184b(0x110)]([{'$unwind':_0x29184b(0xf0)},{'$match':{'sale_product.id_transaction_from':_0x1d95d9['_id'][_0x29184b(0x10a)](),'sale_product.invoice':_0x1d95d9[_0x29184b(0x128)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x29184b(0x100),'product_code':_0x29184b(0xef),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x29184b(0x144),'product_invoice':_0x29184b(0x10b),'invoice':_0x29184b(0x125),'id_transaction_from':_0x29184b(0x14b),'date':'$date','production_date':_0x29184b(0x113),'expiry_date':_0x29184b(0xf5),'UOM':'$sale_product.unit'}}]);_0x51b58c[_0x29184b(0xe9)]>0x0&&_0x58ed11[_0x29184b(0x10f)][_0x4a9a97[_0x29184b(0x128)]][_0x29184b(0xfe)](..._0x51b58c);}));})),_0x58ed11[_0x197d0c(0x10f)]=_0x58ed11['data_sales'],_0x58ed11['data_adjustment']={},await Promise[_0x197d0c(0x12c)](_0x58ed11[_0x197d0c(0x11b)](async _0x7ed2c3=>{var _0x3f8f83=_0x197d0c;_0x58ed11[_0x3f8f83(0x138)][_0x7ed2c3[_0x3f8f83(0x128)]]=[],await Promise[_0x3f8f83(0x12c)](_0x7ed2c3[_0x3f8f83(0x11d)][_0x3f8f83(0x11b)](async _0x31631f=>{var _0x2ab82d=_0x3f8f83;const _0x4ed246=await adjustment[_0x2ab82d(0x110)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x31631f[_0x2ab82d(0x137)][_0x2ab82d(0x10a)](),'product.invoice':_0x31631f[_0x2ab82d(0x128)]}},{'$project':{'_id':'$product._id','product_name':_0x2ab82d(0xfd),'product_code':_0x2ab82d(0x10c),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x2ab82d(0x120),'warehouse_room':_0x2ab82d(0xfa),'product_invoice':_0x2ab82d(0x13d),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':_0x2ab82d(0x14c),'expiry_date':_0x2ab82d(0x11c),'UOM':_0x2ab82d(0xec)}}]);_0x4ed246['length']>0x0&&_0x58ed11[_0x2ab82d(0x138)][_0x7ed2c3[_0x2ab82d(0x128)]][_0x2ab82d(0xfe)](..._0x4ed246);}));})),_0x58ed11[_0x197d0c(0x124)]={},await Promise[_0x197d0c(0x12c)](_0x58ed11['map'](async _0x20f8e7=>{var _0xe98f4c=_0x197d0c;_0x58ed11['data_transfer'][_0x20f8e7['invoice']]=[],await Promise[_0xe98f4c(0x12c)](_0x20f8e7[_0xe98f4c(0x11d)][_0xe98f4c(0x11b)](async _0x4bf6dd=>{var _0xecaa01=_0xe98f4c;const _0x2e2194=await transfers['aggregate']([{'$unwind':_0xecaa01(0x108)},{'$match':{'product.id_transaction_id':_0x4bf6dd[_0xecaa01(0x137)][_0xecaa01(0x10a)](),'product.To_invoice':_0x4bf6dd[_0xecaa01(0x128)]}},{'$project':{'_id':_0xecaa01(0x13f),'product_name':_0xecaa01(0xfd),'product_code':_0xecaa01(0x10c),'quantity_available':'$product.to_quantity','warehouse_name':_0xecaa01(0x115),'warehouse_room':'$product.room_names','product_invoice':_0xecaa01(0xeb),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_id','date':_0xecaa01(0x101),'production_date':'$product.production_date','expiry_date':_0xecaa01(0x11c),'UOM':_0xecaa01(0xec)}}]);_0x2e2194[_0xecaa01(0xe9)]>0x0&&_0x58ed11[_0xecaa01(0x124)][_0x20f8e7['invoice']]['push'](..._0x2e2194);}));})),_0x3041e7[_0x197d0c(0x10d)]({'purchases_warehouse':_0x58ed11,'data_sales':_0x58ed11['data_sales'],'data_adjustment':_0x58ed11[_0x197d0c(0x138)],'data_transfer':_0x58ed11[_0x197d0c(0x124)]});}}else{if(_0x595e54==_0x197d0c(0x12c)){var _0x58ed11=await purchases_finished[_0x197d0c(0x110)]([{'$match':{'date':{'$gte':_0x2d813d,'$lte':_0x1a8444}}},{'$lookup':{'from':_0x197d0c(0x12a),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x197d0c(0xe4)},{'$match':{'$expr':{'$eq':[_0x197d0c(0x118),_0x197d0c(0x129)]}}},{'$project':{'_id':_0x197d0c(0xf6),'product_name':_0x197d0c(0x114),'product_code':_0x197d0c(0x13e),'quantity_available':_0x197d0c(0x106),'warehouse_name':'$name','warehouse_room':_0x197d0c(0xfb),'invoice':_0x197d0c(0x129),'production_date':_0x197d0c(0x140),'expiry_date':_0x197d0c(0x12b),'UOM':_0x197d0c(0x145)}}],'as':_0x197d0c(0x11d)}}]);_0x58ed11[_0x197d0c(0x10f)]={},await Promise[_0x197d0c(0x12c)](_0x58ed11[_0x197d0c(0x11b)](async _0x5ec5d5=>{var _0x5cd6c9=_0x197d0c;_0x58ed11[_0x5cd6c9(0x10f)][_0x5ec5d5[_0x5cd6c9(0x128)]]=[],await Promise[_0x5cd6c9(0x12c)](_0x5ec5d5[_0x5cd6c9(0x11d)][_0x5cd6c9(0x11b)](async _0x476e7f=>{var _0x18b8ff=_0x5cd6c9;const _0x1b0156=await sales_finished[_0x18b8ff(0x110)]([{'$unwind':_0x18b8ff(0xf0)},{'$match':{'sale_product.id_transaction_from':_0x476e7f['_id'][_0x18b8ff(0x10a)](),'sale_product.invoice':_0x476e7f[_0x18b8ff(0x128)]}},{'$project':{'_id':_0x18b8ff(0x135),'product_name':_0x18b8ff(0x100),'product_code':_0x18b8ff(0xef),'quantity_available':_0x18b8ff(0x111),'warehouse_name':_0x18b8ff(0x120),'warehouse_room':_0x18b8ff(0x144),'product_invoice':_0x18b8ff(0x10b),'invoice':_0x18b8ff(0x125),'id_transaction_from':_0x18b8ff(0x14b),'date':'$date','production_date':_0x18b8ff(0x113),'expiry_date':_0x18b8ff(0xf5),'UOM':_0x18b8ff(0xe6)}}]);_0x1b0156[_0x18b8ff(0xe9)]>0x0&&_0x58ed11[_0x18b8ff(0x10f)][_0x5ec5d5[_0x18b8ff(0x128)]]['push'](..._0x1b0156);}));})),_0x58ed11['data_sales']=_0x58ed11[_0x197d0c(0x10f)],_0x58ed11['data_adjustment']={},await Promise['all'](_0x58ed11[_0x197d0c(0x11b)](async _0x32da86=>{var _0x841804=_0x197d0c;_0x58ed11[_0x841804(0x138)][_0x32da86[_0x841804(0x128)]]=[],await Promise[_0x841804(0x12c)](_0x32da86[_0x841804(0x11d)][_0x841804(0x11b)](async _0x6b8c8b=>{var _0x10371c=_0x841804;const _0x208743=await adjustment_finished[_0x10371c(0x110)]([{'$unwind':_0x10371c(0x108)},{'$match':{'product.id_transaction_from':_0x6b8c8b[_0x10371c(0x137)][_0x10371c(0x10a)](),'product.invoice':_0x6b8c8b[_0x10371c(0x128)]}},{'$project':{'_id':'$product._id','product_name':_0x10371c(0xfd),'product_code':_0x10371c(0x10c),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x10371c(0x120),'warehouse_room':'$product.room_names','product_invoice':_0x10371c(0x13d),'invoice':_0x10371c(0x125),'id_transaction_from':_0x10371c(0x119),'date':_0x10371c(0x101),'production_date':'$product.production_date','expiry_date':_0x10371c(0x11c),'UOM':_0x10371c(0xec)}}]);_0x208743[_0x10371c(0xe9)]>0x0&&_0x58ed11[_0x10371c(0x138)][_0x32da86[_0x10371c(0x128)]][_0x10371c(0xfe)](..._0x208743);}));})),_0x58ed11[_0x197d0c(0x124)]={},await Promise[_0x197d0c(0x12c)](_0x58ed11['map'](async _0x35817b=>{var _0x2cabff=_0x197d0c;_0x58ed11[_0x2cabff(0x124)][_0x35817b['invoice']]=[],await Promise[_0x2cabff(0x12c)](_0x35817b[_0x2cabff(0x11d)][_0x2cabff(0x11b)](async _0x53cbb5=>{var _0x14d343=_0x2cabff;const _0x5b2925=await transfers_finished['aggregate']([{'$unwind':_0x14d343(0x108)},{'$match':{'product.id_transaction':_0x53cbb5['_id']['valueOf'](),'product.from_invoice':_0x53cbb5[_0x14d343(0x128)]}},{'$project':{'_id':_0x14d343(0x13f),'product_name':_0x14d343(0xfd),'product_code':'$product.product_code','quantity_available':_0x14d343(0xe5),'warehouse_name':_0x14d343(0x115),'warehouse_room':_0x14d343(0xfa),'product_invoice':_0x14d343(0xeb),'invoice':_0x14d343(0x125),'id_transaction_from':_0x14d343(0x123),'date':_0x14d343(0x101),'production_date':_0x14d343(0x14c),'expiry_date':_0x14d343(0x11c),'UOM':'$product.unit'}}]);_0x5b2925[_0x14d343(0xe9)]>0x0&&_0x58ed11[_0x14d343(0x124)][_0x35817b[_0x14d343(0x128)]][_0x14d343(0xfe)](..._0x5b2925);}));})),_0x3041e7['json']({'purchases_warehouse':_0x58ed11,'data_sales':_0x58ed11[_0x197d0c(0x10f)],'data_adjustment':_0x58ed11['data_adjustment'],'data_transfer':_0x58ed11[_0x197d0c(0x124)]});}else{var _0x58ed11=await purchases_finished[_0x197d0c(0x110)]([{'$match':{'warehouse_name':_0x595e54,'date':{'$gte':_0x2d813d,'$lte':_0x1a8444}}},{'$lookup':{'from':_0x197d0c(0x12a),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x197d0c(0x118),_0x197d0c(0x129)]}}},{'$project':{'_id':_0x197d0c(0xf6),'product_name':'$product_details.product_name','product_code':_0x197d0c(0x13e),'quantity_available':_0x197d0c(0x106),'warehouse_name':_0x197d0c(0x126),'warehouse_room':_0x197d0c(0xfb),'invoice':_0x197d0c(0x129),'production_date':_0x197d0c(0x140),'expiry_date':'$product_details.expiry_date','UOM':_0x197d0c(0x145)}}],'as':_0x197d0c(0x11d)}}]);_0x58ed11['data_sales']={},await Promise[_0x197d0c(0x12c)](_0x58ed11['map'](async _0x1f531e=>{var _0x5b1b26=_0x197d0c;_0x58ed11[_0x5b1b26(0x10f)][_0x1f531e[_0x5b1b26(0x128)]]=[],await Promise[_0x5b1b26(0x12c)](_0x1f531e[_0x5b1b26(0x11d)]['map'](async _0x32d056=>{var _0x168040=_0x5b1b26;const _0x52a50e=await sales_finished['aggregate']([{'$unwind':_0x168040(0xf0)},{'$match':{'sale_product.id_transaction_from':_0x32d056['_id']['valueOf'](),'sale_product.invoice':_0x32d056[_0x168040(0x128)]}},{'$project':{'_id':_0x168040(0x135),'product_name':_0x168040(0x100),'product_code':_0x168040(0xef),'quantity_available':'$sale_product.quantity','warehouse_name':_0x168040(0x120),'warehouse_room':_0x168040(0x144),'product_invoice':_0x168040(0x10b),'invoice':_0x168040(0x125),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x168040(0x101),'production_date':_0x168040(0x113),'expiry_date':_0x168040(0xf5),'UOM':_0x168040(0xe6)}}]);_0x52a50e[_0x168040(0xe9)]>0x0&&_0x58ed11['data_sales'][_0x1f531e['invoice']]['push'](..._0x52a50e);}));})),_0x58ed11[_0x197d0c(0x10f)]=_0x58ed11['data_sales'],_0x58ed11[_0x197d0c(0x138)]={},await Promise[_0x197d0c(0x12c)](_0x58ed11[_0x197d0c(0x11b)](async _0x4c75bf=>{var _0x476233=_0x197d0c;_0x58ed11[_0x476233(0x138)][_0x4c75bf[_0x476233(0x128)]]=[],await Promise['all'](_0x4c75bf[_0x476233(0x11d)]['map'](async _0x40dc35=>{var _0x3974cc=_0x476233;const _0x3ddf8c=await adjustment_finished[_0x3974cc(0x110)]([{'$unwind':_0x3974cc(0x108)},{'$match':{'product.id_transaction_from':_0x40dc35[_0x3974cc(0x137)][_0x3974cc(0x10a)](),'product.invoice':_0x40dc35['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x3974cc(0xfd),'product_code':_0x3974cc(0x10c),'quantity_available':_0x3974cc(0x104),'warehouse_name':'$warehouse_name','warehouse_room':_0x3974cc(0xfa),'product_invoice':_0x3974cc(0x13d),'invoice':'$invoice','id_transaction_from':_0x3974cc(0x119),'date':_0x3974cc(0x101),'production_date':_0x3974cc(0x14c),'expiry_date':_0x3974cc(0x11c),'UOM':'$product.unit'}}]);_0x3ddf8c[_0x3974cc(0xe9)]>0x0&&_0x58ed11[_0x3974cc(0x138)][_0x4c75bf['invoice']][_0x3974cc(0xfe)](..._0x3ddf8c);}));})),_0x58ed11[_0x197d0c(0x124)]={},await Promise['all'](_0x58ed11['map'](async _0x2c0eb5=>{var _0xefa5e9=_0x197d0c;_0x58ed11[_0xefa5e9(0x124)][_0x2c0eb5[_0xefa5e9(0x128)]]=[],await Promise[_0xefa5e9(0x12c)](_0x2c0eb5[_0xefa5e9(0x11d)][_0xefa5e9(0x11b)](async _0x58b263=>{var _0x2a4c7e=_0xefa5e9;const _0x5cc4ff=await transfers_finished[_0x2a4c7e(0x110)]([{'$unwind':_0x2a4c7e(0x108)},{'$match':{'product.id_transaction':_0x58b263[_0x2a4c7e(0x137)][_0x2a4c7e(0x10a)](),'product.from_invoice':_0x58b263[_0x2a4c7e(0x128)]}},{'$project':{'_id':_0x2a4c7e(0x13f),'product_name':_0x2a4c7e(0xfd),'product_code':_0x2a4c7e(0x10c),'quantity_available':_0x2a4c7e(0xe5),'warehouse_name':_0x2a4c7e(0x115),'warehouse_room':_0x2a4c7e(0xfa),'product_invoice':_0x2a4c7e(0xeb),'invoice':'$invoice','id_transaction_from':_0x2a4c7e(0x123),'date':_0x2a4c7e(0x101),'production_date':'$product.production_date','expiry_date':_0x2a4c7e(0x11c),'UOM':_0x2a4c7e(0xec)}}]);_0x5cc4ff[_0x2a4c7e(0xe9)]>0x0&&_0x58ed11[_0x2a4c7e(0x124)][_0x2c0eb5[_0x2a4c7e(0x128)]][_0x2a4c7e(0xfe)](..._0x5cc4ff);}));})),_0x3041e7['json']({'purchases_warehouse':_0x58ed11,'data_sales':_0x58ed11[_0x197d0c(0x10f)],'data_adjustment':_0x58ed11[_0x197d0c(0x138)],'data_transfer':_0x58ed11['data_transfer']});}}}),router['get'](a0_0x4b72f9(0x14e),auth,async(_0x464e72,_0x1a493c)=>{var _0x3aa01d=a0_0x4b72f9;try{const _0x945d15=_0x464e72[_0x3aa01d(0x10e)]['id'];var _0x3aea70=await purchases_finished[_0x3aa01d(0x14d)](_0x945d15);const _0x4e93ae=await master_shop['find'](),_0x5d3153=_0x464e72['user'],_0x556d2b=await profile[_0x3aa01d(0xff)]({'email':_0x5d3153[_0x3aa01d(0x142)]});if(_0x4e93ae[0x0][_0x3aa01d(0xf3)]==_0x3aa01d(0x105))var _0x53a185=users[_0x3aa01d(0xe7)];else{if(_0x4e93ae[0x0][_0x3aa01d(0xf3)]=='Hindi')var _0x53a185=users[_0x3aa01d(0x147)];else{if(_0x4e93ae[0x0][_0x3aa01d(0xf3)]==_0x3aa01d(0x11e))var _0x53a185=users['German'];else{if(_0x4e93ae[0x0][_0x3aa01d(0xf3)]==_0x3aa01d(0x130))var _0x53a185=users['Spanish'];else{if(_0x4e93ae[0x0][_0x3aa01d(0xf3)]==_0x3aa01d(0xf2))var _0x53a185=users[_0x3aa01d(0xf2)];else{if(_0x4e93ae[0x0][_0x3aa01d(0xf3)]==_0x3aa01d(0x133))var _0x53a185=users[_0x3aa01d(0x148)];else{if(_0x4e93ae[0x0][_0x3aa01d(0xf3)]=='Chinese')var _0x53a185=users[_0x3aa01d(0x139)];else{if(_0x4e93ae[0x0][_0x3aa01d(0xf3)]==_0x3aa01d(0x112))var _0x53a185=users[_0x3aa01d(0x149)];}}}}}}}_0x1a493c[_0x3aa01d(0x143)]('view_table',{'success':_0x464e72[_0x3aa01d(0x12e)](_0x3aa01d(0x127)),'errors':_0x464e72[_0x3aa01d(0x12e)](_0x3aa01d(0x13c)),'master_shop':_0x4e93ae,'profile':_0x556d2b,'role':_0x5d3153,'language':_0x53a185,'data':_0x3aea70});}catch(_0x1568a9){_0x1a493c['json'](_0x1568a9);}}),router[a0_0x4b72f9(0xfc)](a0_0x4b72f9(0x131),auth,async(_0x41b23b,_0x1e3603)=>{var _0x3be6d1=a0_0x4b72f9;try{const _0x541382=_0x41b23b[_0x3be6d1(0x10e)]['id'];var _0xa5d9d5=await sales_finished['findById'](_0x541382);const _0x2dd850=await master_shop[_0x3be6d1(0x122)](),_0x5e79c2=_0x41b23b[_0x3be6d1(0x13b)],_0x5bb8da=await profile['findOne']({'email':_0x5e79c2['email']});if(_0x2dd850[0x0][_0x3be6d1(0xf3)]==_0x3be6d1(0x105))var _0x445769=users[_0x3be6d1(0xe7)];else{if(_0x2dd850[0x0][_0x3be6d1(0xf3)]=='Hindi')var _0x445769=users[_0x3be6d1(0x147)];else{if(_0x2dd850[0x0][_0x3be6d1(0xf3)]==_0x3be6d1(0x11e))var _0x445769=users['German'];else{if(_0x2dd850[0x0][_0x3be6d1(0xf3)]==_0x3be6d1(0x130))var _0x445769=users[_0x3be6d1(0x130)];else{if(_0x2dd850[0x0][_0x3be6d1(0xf3)]==_0x3be6d1(0xf2))var _0x445769=users[_0x3be6d1(0xf2)];else{if(_0x2dd850[0x0][_0x3be6d1(0xf3)]==_0x3be6d1(0x133))var _0x445769=users['Portuguese'];else{if(_0x2dd850[0x0]['language']=='Chinese')var _0x445769=users[_0x3be6d1(0x139)];else{if(_0x2dd850[0x0][_0x3be6d1(0xf3)]==_0x3be6d1(0x112))var _0x445769=users[_0x3be6d1(0x149)];}}}}}}}_0x1e3603[_0x3be6d1(0x143)](_0x3be6d1(0x109),{'success':_0x41b23b[_0x3be6d1(0x12e)]('success'),'errors':_0x41b23b[_0x3be6d1(0x12e)]('errors'),'master_shop':_0x2dd850,'profile':_0x5bb8da,'role':_0x5e79c2,'language':_0x445769,'data':_0xa5d9d5});}catch(_0x164b27){_0x1e3603[_0x3be6d1(0x10d)](_0x164b27);}}),router[a0_0x4b72f9(0xfc)](a0_0x4b72f9(0x12f),auth,async(_0x542ea6,_0x3ef17f)=>{var _0x2478f2=a0_0x4b72f9;try{const _0x3fa5cf=_0x542ea6['params']['id'];var _0x15995e=await transfers_finished[_0x2478f2(0x14d)](_0x3fa5cf);const _0x19c9f6=await master_shop['find'](),_0x2b80cd=_0x542ea6[_0x2478f2(0x13b)],_0x8c599=await profile[_0x2478f2(0xff)]({'email':_0x2b80cd[_0x2478f2(0x142)]});if(_0x19c9f6[0x0][_0x2478f2(0xf3)]==_0x2478f2(0x105))var _0x5eb9df=users[_0x2478f2(0xe7)];else{if(_0x19c9f6[0x0][_0x2478f2(0xf3)]==_0x2478f2(0x147))var _0x5eb9df=users[_0x2478f2(0x147)];else{if(_0x19c9f6[0x0][_0x2478f2(0xf3)]==_0x2478f2(0x11e))var _0x5eb9df=users[_0x2478f2(0x11e)];else{if(_0x19c9f6[0x0][_0x2478f2(0xf3)]==_0x2478f2(0x130))var _0x5eb9df=users['Spanish'];else{if(_0x19c9f6[0x0][_0x2478f2(0xf3)]==_0x2478f2(0xf2))var _0x5eb9df=users[_0x2478f2(0xf2)];else{if(_0x19c9f6[0x0]['language']==_0x2478f2(0x133))var _0x5eb9df=users[_0x2478f2(0x148)];else{if(_0x19c9f6[0x0][_0x2478f2(0xf3)]==_0x2478f2(0x139))var _0x5eb9df=users[_0x2478f2(0x139)];else{if(_0x19c9f6[0x0][_0x2478f2(0xf3)]==_0x2478f2(0x112))var _0x5eb9df=users[_0x2478f2(0x149)];}}}}}}}_0x3ef17f[_0x2478f2(0x143)](_0x2478f2(0xea),{'success':_0x542ea6[_0x2478f2(0x12e)](_0x2478f2(0x127)),'errors':_0x542ea6[_0x2478f2(0x12e)]('errors'),'master_shop':_0x19c9f6,'profile':_0x8c599,'role':_0x2b80cd,'language':_0x5eb9df,'data':_0x15995e});}catch(_0x4d811f){_0x3ef17f[_0x2478f2(0x10d)](_0x4d811f);}}),router[a0_0x4b72f9(0xfc)](a0_0x4b72f9(0x102),auth,async(_0x5a1ce3,_0x1db4fd)=>{var _0x106874=a0_0x4b72f9;try{const {username:_0x3b72f1,email:_0x370c1d,role:_0x2dfbea}=_0x5a1ce3['user'],_0x304fd0=_0x5a1ce3[_0x106874(0x13b)],_0x2f7f6a=await profile[_0x106874(0xff)]({'email':_0x304fd0['email']}),_0x5626dc=await master_shop[_0x106874(0x122)](),_0x1c35b8=await warehouse[_0x106874(0x110)]([{'$match':{'status':_0x106874(0x134),'warehouse_category':_0x106874(0xf1)}},{'$group':{'_id':'$name','name':{'$first':_0x106874(0x126)}}}]);if(_0x5626dc[0x0][_0x106874(0xf3)]==_0x106874(0x105))var _0xbbc6b5=users[_0x106874(0xe7)];else{if(_0x5626dc[0x0]['language']=='Hindi')var _0xbbc6b5=users[_0x106874(0x147)];else{if(_0x5626dc[0x0][_0x106874(0xf3)]==_0x106874(0x11e))var _0xbbc6b5=users[_0x106874(0x11e)];else{if(_0x5626dc[0x0][_0x106874(0xf3)]==_0x106874(0x130))var _0xbbc6b5=users[_0x106874(0x130)];else{if(_0x5626dc[0x0]['language']==_0x106874(0xf2))var _0xbbc6b5=users[_0x106874(0xf2)];else{if(_0x5626dc[0x0]['language']==_0x106874(0x133))var _0xbbc6b5=users['Portuguese'];else{if(_0x5626dc[0x0][_0x106874(0xf3)]==_0x106874(0x139))var _0xbbc6b5=users[_0x106874(0x139)];else{if(_0x5626dc[0x0]['language']==_0x106874(0x112))var _0xbbc6b5=users[_0x106874(0x149)];}}}}}}}_0x1db4fd[_0x106874(0x143)]('transaction_finished_raw',{'success':_0x5a1ce3[_0x106874(0x12e)](_0x106874(0x127)),'errors':_0x5a1ce3[_0x106874(0x12e)](_0x106874(0x13c)),'role':_0x304fd0,'profile':_0x2f7f6a,'master_shop':_0x5626dc,'dataProcess':_0x1c35b8,'language':_0xbbc6b5});}catch(_0x489781){console[_0x106874(0xee)](_0x489781);}}),module['exports']=router;