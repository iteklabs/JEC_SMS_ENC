var a0_0x3cfbdc=a0_0x211f;function a0_0x211f(_0x50067b,_0x229029){var _0x213698=a0_0x2136();return a0_0x211f=function(_0x211fb4,_0x46d19c){_0x211fb4=_0x211fb4-0x15c;var _0x51542a=_0x213698[_0x211fb4];return _0x51542a;},a0_0x211f(_0x50067b,_0x229029);}(function(_0x4e3471,_0x468f38){var _0x5e305d=a0_0x211f,_0x555eb1=_0x4e3471();while(!![]){try{var _0x33a0cf=parseInt(_0x5e305d(0x1be))/0x1*(-parseInt(_0x5e305d(0x1b7))/0x2)+-parseInt(_0x5e305d(0x17f))/0x3+parseInt(_0x5e305d(0x1ba))/0x4+-parseInt(_0x5e305d(0x1a3))/0x5+-parseInt(_0x5e305d(0x168))/0x6+-parseInt(_0x5e305d(0x15c))/0x7+parseInt(_0x5e305d(0x1a4))/0x8;if(_0x33a0cf===_0x468f38)break;else _0x555eb1['push'](_0x555eb1['shift']());}catch(_0x4983db){_0x555eb1['push'](_0x555eb1['shift']());}}}(a0_0x2136,0x228ee));const express=require(a0_0x3cfbdc(0x1b5)),app=express(),router=express[a0_0x3cfbdc(0x171)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x3cfbdc(0x177)),auth=require(a0_0x3cfbdc(0x1a7)),users=require(a0_0x3cfbdc(0x191)),nodemailer=require(a0_0x3cfbdc(0x1ac));function a0_0x2136(){var _0x1c2ff1=['errors','invoice','/viewdata_inc_fg/:id','$product.room_names','push','data_sales','/view','$sale_product.quantity','$product','$product_details.product_code','transaction_finished_raw','Arabic','$warehouse_name','$sale_product.unit','481470rVXOne','4442808bSQvDI','$product_details.product_name','$name','../middleware/auth','$product_details.invoice','aggregate','$date','data_adjustment','nodemailer','transaction_finished','$product.expiry_date','$product.to_quantity','length','email','English\x20(US)','$to_warehouse','$sale_product.room_name','express','data_transfer','46FpHBJU','get','Portuguese','577004FTupbi','/viewFG','$product_details.unit','_id','10869ncmbLi','all','German','$product._id','user','$sale_product.invoice','$product.production_date','Enabled','$sale_product','123123lTLUFm','/viewdata_tf_fg/:id','json','$invoice','post','English','$sale_product.product_name','/viewdata_og_fg/:id','$product.id_transaction','success','$product_details._id','$sale_product._id','35250ABsoAG','view_table','$product_details.product_stock','valueOf','findOne','$product.product_name','$product.unit','warehouse_data','$product_details.expiry_date','Router','map','$sale_product.product_code','flash','$sale_product.production_date','render','../models/all_models','$product.invoice','$product_details.production_date','$sale_product.id_transaction_from','exports','Hindi','/reports','view_og_table','564921kELyNs','$product.id_transaction_from','$room','Chinese','Spanish','language','Portuguese\x20(BR)','findById','$product.product_code','$product.new_adjust_qty','French','$product.to_room_name','Arabic\x20(ae)','find','view_tf_table','$sale_product.expiry_date','$product.id_transaction_id','$$invoice','../public/language/languages.json','$product_details','params','warehouses'];a0_0x2136=function(){return _0x1c2ff1;};return a0_0x2136();}router[a0_0x3cfbdc(0x1b8)](a0_0x3cfbdc(0x19b),auth,async(_0x455326,_0x152c96)=>{var _0x375ccb=a0_0x3cfbdc;try{const {username:_0x49ee1a,email:_0x1e1cc5,role:_0x549732}=_0x455326[_0x375ccb(0x1c2)],_0x44670e=_0x455326[_0x375ccb(0x1c2)],_0x420877=await profile[_0x375ccb(0x16c)]({'email':_0x44670e[_0x375ccb(0x1b1)]}),_0x55f99c=await master_shop[_0x375ccb(0x18c)](),_0x11b554=await warehouse[_0x375ccb(0x1a9)]([{'$match':{'status':_0x375ccb(0x1c5),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':_0x375ccb(0x1a6)}}}]);if(_0x55f99c[0x0][_0x375ccb(0x184)]==_0x375ccb(0x1b2))var _0x2d475a=users['English'];else{if(_0x55f99c[0x0]['language']=='Hindi')var _0x2d475a=users[_0x375ccb(0x17c)];else{if(_0x55f99c[0x0][_0x375ccb(0x184)]==_0x375ccb(0x1c0))var _0x2d475a=users[_0x375ccb(0x1c0)];else{if(_0x55f99c[0x0]['language']==_0x375ccb(0x183))var _0x2d475a=users[_0x375ccb(0x183)];else{if(_0x55f99c[0x0][_0x375ccb(0x184)]=='French')var _0x2d475a=users['French'];else{if(_0x55f99c[0x0][_0x375ccb(0x184)]==_0x375ccb(0x185))var _0x2d475a=users[_0x375ccb(0x1b9)];else{if(_0x55f99c[0x0]['language']==_0x375ccb(0x182))var _0x2d475a=users[_0x375ccb(0x182)];else{if(_0x55f99c[0x0]['language']==_0x375ccb(0x18b))var _0x2d475a=users[_0x375ccb(0x1a0)];}}}}}}}_0x152c96[_0x375ccb(0x176)](_0x375ccb(0x1ad),{'success':_0x455326[_0x375ccb(0x174)](_0x375ccb(0x165)),'errors':_0x455326[_0x375ccb(0x174)](_0x375ccb(0x195)),'role':_0x44670e,'profile':_0x420877,'master_shop':_0x55f99c,'dataProcess':_0x11b554,'language':_0x2d475a});}catch(_0x42a7d2){console['log'](_0x42a7d2);}}),router[a0_0x3cfbdc(0x160)](a0_0x3cfbdc(0x17d),auth,async(_0x2ea54c,_0x434448)=>{var _0x5bd152=a0_0x3cfbdc;const {product_category:_0x8f10cc,transaction_category:_0x22bdd2,transaction_date_from:_0x1e9359,transaction_date_to:_0x3a1b08,warehouse_category:_0x39b755,item_code:_0x5a782f}=_0x2ea54c['body'];console['log'](_0x39b755);if(_0x8f10cc=='rm'){if(_0x39b755==_0x5bd152(0x1bf)){var _0x387885=await purchases['aggregate']([{'$match':{'date':{'$gte':_0x1e9359,'$lte':_0x3a1b08}}},{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x5bd152(0x190),'$product_details.invoice']}}},{'$project':{'_id':_0x5bd152(0x166),'product_name':_0x5bd152(0x1a5),'product_code':_0x5bd152(0x19e),'quantity_available':'$product_details.product_stock','warehouse_name':_0x5bd152(0x1a6),'warehouse_room':_0x5bd152(0x181),'invoice':_0x5bd152(0x1a8),'production_date':_0x5bd152(0x179),'expiry_date':_0x5bd152(0x170),'UOM':_0x5bd152(0x1bc)}}],'as':'warehouse_data'}}]);_0x387885[_0x5bd152(0x19a)]={},await Promise[_0x5bd152(0x1bf)](_0x387885['map'](async _0xd63e7d=>{var _0x46172d=_0x5bd152;_0x387885['data_sales'][_0xd63e7d[_0x46172d(0x196)]]=[],await Promise[_0x46172d(0x1bf)](_0xd63e7d[_0x46172d(0x16f)][_0x46172d(0x172)](async _0x44b66c=>{var _0x36cac8=_0x46172d;const _0x456000=await sales['aggregate']([{'$unwind':_0x36cac8(0x1c6)},{'$match':{'sale_product.id_transaction_from':_0x44b66c['_id'][_0x36cac8(0x16b)](),'sale_product.invoice':_0x44b66c[_0x36cac8(0x196)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x36cac8(0x162),'product_code':_0x36cac8(0x173),'quantity_available':_0x36cac8(0x19c),'warehouse_name':_0x36cac8(0x1a1),'warehouse_room':_0x36cac8(0x1b4),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0x36cac8(0x1aa),'production_date':'$sale_product.production_date','expiry_date':'$sale_product.expiry_date','UOM':_0x36cac8(0x1a2)}}]);_0x456000[_0x36cac8(0x1b0)]>0x0&&_0x387885[_0x36cac8(0x19a)][_0xd63e7d[_0x36cac8(0x196)]][_0x36cac8(0x199)](..._0x456000);}));})),_0x387885[_0x5bd152(0x19a)]=_0x387885[_0x5bd152(0x19a)],_0x387885[_0x5bd152(0x1ab)]={},await Promise['all'](_0x387885[_0x5bd152(0x172)](async _0x1007b7=>{var _0x7663cc=_0x5bd152;_0x387885[_0x7663cc(0x1ab)][_0x1007b7[_0x7663cc(0x196)]]=[],await Promise[_0x7663cc(0x1bf)](_0x1007b7['warehouse_data'][_0x7663cc(0x172)](async _0x3e86b1=>{var _0x4dcd93=_0x7663cc;const _0x4fb157=await adjustment[_0x4dcd93(0x1a9)]([{'$unwind':_0x4dcd93(0x19d)},{'$match':{'product.id_transaction_from':_0x3e86b1[_0x4dcd93(0x1bd)][_0x4dcd93(0x16b)](),'product.invoice':_0x3e86b1[_0x4dcd93(0x196)]}},{'$project':{'_id':_0x4dcd93(0x1c1),'product_name':_0x4dcd93(0x16d),'product_code':'$product.product_code','quantity_available':_0x4dcd93(0x188),'warehouse_name':_0x4dcd93(0x1a1),'warehouse_room':'$product.room_names','product_invoice':_0x4dcd93(0x178),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':_0x4dcd93(0x1c4),'expiry_date':_0x4dcd93(0x1ae),'UOM':_0x4dcd93(0x16e)}}]);_0x4fb157[_0x4dcd93(0x1b0)]>0x0&&_0x387885[_0x4dcd93(0x1ab)][_0x1007b7['invoice']][_0x4dcd93(0x199)](..._0x4fb157);}));})),_0x387885[_0x5bd152(0x1b6)]={},await Promise['all'](_0x387885[_0x5bd152(0x172)](async _0x22c0e2=>{var _0x1397f6=_0x5bd152;_0x387885[_0x1397f6(0x1b6)][_0x22c0e2['invoice']]=[],await Promise['all'](_0x22c0e2[_0x1397f6(0x16f)]['map'](async _0x592185=>{var _0x33a435=_0x1397f6;const _0x3430ab=await transfers[_0x33a435(0x1a9)]([{'$unwind':_0x33a435(0x19d)},{'$match':{'product.id_transaction_id':_0x592185[_0x33a435(0x1bd)][_0x33a435(0x16b)](),'product.To_invoice':_0x592185[_0x33a435(0x196)]}},{'$project':{'_id':_0x33a435(0x1c1),'product_name':_0x33a435(0x16d),'product_code':_0x33a435(0x187),'quantity_available':_0x33a435(0x1af),'warehouse_name':_0x33a435(0x1b3),'warehouse_room':'$product.room_names','product_invoice':'$product.to_room_name','invoice':_0x33a435(0x15f),'id_transaction_from':_0x33a435(0x18f),'date':_0x33a435(0x1aa),'production_date':_0x33a435(0x1c4),'expiry_date':'$product.expiry_date','UOM':_0x33a435(0x16e)}}]);_0x3430ab['length']>0x0&&_0x387885[_0x33a435(0x1b6)][_0x22c0e2['invoice']][_0x33a435(0x199)](..._0x3430ab);}));})),_0x434448['json']({'purchases_warehouse':_0x387885,'data_sales':_0x387885[_0x5bd152(0x19a)],'data_adjustment':_0x387885['data_adjustment'],'data_transfer':_0x387885[_0x5bd152(0x1b6)]});}else{var _0x387885=await purchases[_0x5bd152(0x1a9)]([{'$match':{'warehouse_name':_0x39b755,'date':{'$gte':_0x1e9359,'$lte':_0x3a1b08}}},{'$lookup':{'from':_0x5bd152(0x194),'let':{'invoice':_0x5bd152(0x15f)},'pipeline':[{'$unwind':_0x5bd152(0x192)},{'$match':{'$expr':{'$eq':['$$invoice',_0x5bd152(0x1a8)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x5bd152(0x1a5),'product_code':_0x5bd152(0x19e),'quantity_available':_0x5bd152(0x16a),'warehouse_name':_0x5bd152(0x1a6),'warehouse_room':_0x5bd152(0x181),'invoice':_0x5bd152(0x1a8),'production_date':_0x5bd152(0x179),'expiry_date':'$product_details.expiry_date','UOM':_0x5bd152(0x1bc)}}],'as':'warehouse_data'}}]);_0x387885[_0x5bd152(0x19a)]={},await Promise['all'](_0x387885['map'](async _0x46f1f6=>{var _0x26c1b1=_0x5bd152;_0x387885[_0x26c1b1(0x19a)][_0x46f1f6['invoice']]=[],await Promise[_0x26c1b1(0x1bf)](_0x46f1f6[_0x26c1b1(0x16f)]['map'](async _0x27cd54=>{var _0x1622c3=_0x26c1b1;const _0x330707=await sales[_0x1622c3(0x1a9)]([{'$unwind':_0x1622c3(0x1c6)},{'$match':{'sale_product.id_transaction_from':_0x27cd54[_0x1622c3(0x1bd)][_0x1622c3(0x16b)](),'sale_product.invoice':_0x27cd54[_0x1622c3(0x196)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x1622c3(0x162),'product_code':'$sale_product.product_code','quantity_available':_0x1622c3(0x19c),'warehouse_name':_0x1622c3(0x1a1),'warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x1622c3(0x17a),'date':_0x1622c3(0x1aa),'production_date':_0x1622c3(0x175),'expiry_date':_0x1622c3(0x18e),'UOM':_0x1622c3(0x1a2)}}]);_0x330707[_0x1622c3(0x1b0)]>0x0&&_0x387885['data_sales'][_0x46f1f6[_0x1622c3(0x196)]]['push'](..._0x330707);}));})),_0x387885[_0x5bd152(0x19a)]=_0x387885['data_sales'],_0x387885[_0x5bd152(0x1ab)]={},await Promise[_0x5bd152(0x1bf)](_0x387885[_0x5bd152(0x172)](async _0x266c61=>{var _0x2a6e53=_0x5bd152;_0x387885[_0x2a6e53(0x1ab)][_0x266c61[_0x2a6e53(0x196)]]=[],await Promise[_0x2a6e53(0x1bf)](_0x266c61['warehouse_data'][_0x2a6e53(0x172)](async _0x25c8c1=>{var _0x42dc1c=_0x2a6e53;const _0x885ca8=await adjustment['aggregate']([{'$unwind':_0x42dc1c(0x19d)},{'$match':{'product.id_transaction_from':_0x25c8c1[_0x42dc1c(0x1bd)]['valueOf'](),'product.invoice':_0x25c8c1[_0x42dc1c(0x196)]}},{'$project':{'_id':'$product._id','product_name':_0x42dc1c(0x16d),'product_code':_0x42dc1c(0x187),'quantity_available':_0x42dc1c(0x188),'warehouse_name':'$warehouse_name','warehouse_room':_0x42dc1c(0x198),'product_invoice':'$product.invoice','invoice':_0x42dc1c(0x15f),'id_transaction_from':_0x42dc1c(0x180),'date':_0x42dc1c(0x1aa),'production_date':_0x42dc1c(0x1c4),'expiry_date':_0x42dc1c(0x1ae),'UOM':'$product.unit'}}]);_0x885ca8[_0x42dc1c(0x1b0)]>0x0&&_0x387885[_0x42dc1c(0x1ab)][_0x266c61[_0x42dc1c(0x196)]][_0x42dc1c(0x199)](..._0x885ca8);}));})),_0x387885[_0x5bd152(0x1b6)]={},await Promise['all'](_0x387885[_0x5bd152(0x172)](async _0xca5ad9=>{var _0x427380=_0x5bd152;_0x387885[_0x427380(0x1b6)][_0xca5ad9[_0x427380(0x196)]]=[],await Promise[_0x427380(0x1bf)](_0xca5ad9[_0x427380(0x16f)][_0x427380(0x172)](async _0x200e72=>{var _0x19932b=_0x427380;const _0x5029ee=await transfers['aggregate']([{'$unwind':_0x19932b(0x19d)},{'$match':{'product.id_transaction_id':_0x200e72[_0x19932b(0x1bd)]['valueOf'](),'product.To_invoice':_0x200e72[_0x19932b(0x196)]}},{'$project':{'_id':_0x19932b(0x1c1),'product_name':_0x19932b(0x16d),'product_code':_0x19932b(0x187),'quantity_available':_0x19932b(0x1af),'warehouse_name':_0x19932b(0x1b3),'warehouse_room':_0x19932b(0x198),'product_invoice':_0x19932b(0x18a),'invoice':_0x19932b(0x15f),'id_transaction_from':_0x19932b(0x18f),'date':'$date','production_date':_0x19932b(0x1c4),'expiry_date':_0x19932b(0x1ae),'UOM':_0x19932b(0x16e)}}]);_0x5029ee[_0x19932b(0x1b0)]>0x0&&_0x387885['data_transfer'][_0xca5ad9[_0x19932b(0x196)]][_0x19932b(0x199)](..._0x5029ee);}));})),_0x434448[_0x5bd152(0x15e)]({'purchases_warehouse':_0x387885,'data_sales':_0x387885['data_sales'],'data_adjustment':_0x387885[_0x5bd152(0x1ab)],'data_transfer':_0x387885[_0x5bd152(0x1b6)]});}}else{if(_0x39b755=='all'){var _0x387885=await purchases_finished[_0x5bd152(0x1a9)]([{'$match':{'date':{'$gte':_0x1e9359,'$lte':_0x3a1b08}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x5bd152(0x15f)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x5bd152(0x190),_0x5bd152(0x1a8)]}}},{'$project':{'_id':_0x5bd152(0x166),'product_name':_0x5bd152(0x1a5),'product_code':_0x5bd152(0x19e),'quantity_available':_0x5bd152(0x16a),'warehouse_name':_0x5bd152(0x1a6),'warehouse_room':_0x5bd152(0x181),'invoice':_0x5bd152(0x1a8),'production_date':_0x5bd152(0x179),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':'warehouse_data'}}]);_0x387885[_0x5bd152(0x19a)]={},await Promise[_0x5bd152(0x1bf)](_0x387885[_0x5bd152(0x172)](async _0x5426df=>{var _0x331a4f=_0x5bd152;_0x387885[_0x331a4f(0x19a)][_0x5426df[_0x331a4f(0x196)]]=[],await Promise['all'](_0x5426df[_0x331a4f(0x16f)][_0x331a4f(0x172)](async _0x59de4c=>{var _0x3ac012=_0x331a4f;const _0x498fb7=await sales_finished['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x59de4c[_0x3ac012(0x1bd)][_0x3ac012(0x16b)](),'sale_product.invoice':_0x59de4c[_0x3ac012(0x196)]}},{'$project':{'_id':'$sale_product._id','product_name':'$sale_product.product_name','product_code':'$sale_product.product_code','quantity_available':_0x3ac012(0x19c),'warehouse_name':'$warehouse_name','warehouse_room':_0x3ac012(0x1b4),'product_invoice':_0x3ac012(0x1c3),'invoice':_0x3ac012(0x15f),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x3ac012(0x1aa),'production_date':_0x3ac012(0x175),'expiry_date':_0x3ac012(0x18e),'UOM':_0x3ac012(0x1a2)}}]);_0x498fb7[_0x3ac012(0x1b0)]>0x0&&_0x387885[_0x3ac012(0x19a)][_0x5426df[_0x3ac012(0x196)]][_0x3ac012(0x199)](..._0x498fb7);}));})),_0x387885['data_sales']=_0x387885[_0x5bd152(0x19a)],_0x387885['data_adjustment']={},await Promise[_0x5bd152(0x1bf)](_0x387885[_0x5bd152(0x172)](async _0x60c501=>{var _0x25c1dc=_0x5bd152;_0x387885[_0x25c1dc(0x1ab)][_0x60c501[_0x25c1dc(0x196)]]=[],await Promise[_0x25c1dc(0x1bf)](_0x60c501[_0x25c1dc(0x16f)][_0x25c1dc(0x172)](async _0x4d661e=>{var _0x44936e=_0x25c1dc;const _0x302ba8=await adjustment_finished[_0x44936e(0x1a9)]([{'$unwind':_0x44936e(0x19d)},{'$match':{'product.id_transaction_from':_0x4d661e['_id'][_0x44936e(0x16b)](),'product.invoice':_0x4d661e[_0x44936e(0x196)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x44936e(0x187),'quantity_available':_0x44936e(0x188),'warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':_0x44936e(0x178),'invoice':_0x44936e(0x15f),'id_transaction_from':_0x44936e(0x180),'date':_0x44936e(0x1aa),'production_date':_0x44936e(0x1c4),'expiry_date':_0x44936e(0x1ae),'UOM':_0x44936e(0x16e)}}]);_0x302ba8[_0x44936e(0x1b0)]>0x0&&_0x387885[_0x44936e(0x1ab)][_0x60c501[_0x44936e(0x196)]][_0x44936e(0x199)](..._0x302ba8);}));})),_0x387885[_0x5bd152(0x1b6)]={},await Promise['all'](_0x387885[_0x5bd152(0x172)](async _0xc37642=>{var _0x23aa96=_0x5bd152;_0x387885[_0x23aa96(0x1b6)][_0xc37642[_0x23aa96(0x196)]]=[],await Promise[_0x23aa96(0x1bf)](_0xc37642[_0x23aa96(0x16f)][_0x23aa96(0x172)](async _0x10d8b5=>{var _0x222e56=_0x23aa96;const _0x58772e=await transfers_finished[_0x222e56(0x1a9)]([{'$unwind':_0x222e56(0x19d)},{'$match':{'product.id_transaction':_0x10d8b5[_0x222e56(0x1bd)][_0x222e56(0x16b)](),'product.from_invoice':_0x10d8b5[_0x222e56(0x196)]}},{'$project':{'_id':_0x222e56(0x1c1),'product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x222e56(0x1b3),'warehouse_room':'$product.room_names','product_invoice':'$product.to_room_name','invoice':_0x222e56(0x15f),'id_transaction_from':_0x222e56(0x164),'date':_0x222e56(0x1aa),'production_date':_0x222e56(0x1c4),'expiry_date':_0x222e56(0x1ae),'UOM':_0x222e56(0x16e)}}]);_0x58772e['length']>0x0&&_0x387885[_0x222e56(0x1b6)][_0xc37642[_0x222e56(0x196)]]['push'](..._0x58772e);}));})),_0x434448[_0x5bd152(0x15e)]({'purchases_warehouse':_0x387885,'data_sales':_0x387885[_0x5bd152(0x19a)],'data_adjustment':_0x387885[_0x5bd152(0x1ab)],'data_transfer':_0x387885[_0x5bd152(0x1b6)]});}else{var _0x387885=await purchases_finished[_0x5bd152(0x1a9)]([{'$match':{'warehouse_name':_0x39b755,'date':{'$gte':_0x1e9359,'$lte':_0x3a1b08}}},{'$lookup':{'from':_0x5bd152(0x194),'let':{'invoice':_0x5bd152(0x15f)},'pipeline':[{'$unwind':_0x5bd152(0x192)},{'$match':{'$expr':{'$eq':[_0x5bd152(0x190),_0x5bd152(0x1a8)]}}},{'$project':{'_id':_0x5bd152(0x166),'product_name':_0x5bd152(0x1a5),'product_code':_0x5bd152(0x19e),'quantity_available':_0x5bd152(0x16a),'warehouse_name':_0x5bd152(0x1a6),'warehouse_room':_0x5bd152(0x181),'invoice':_0x5bd152(0x1a8),'production_date':_0x5bd152(0x179),'expiry_date':_0x5bd152(0x170),'UOM':_0x5bd152(0x1bc)}}],'as':'warehouse_data'}}]);_0x387885[_0x5bd152(0x19a)]={},await Promise[_0x5bd152(0x1bf)](_0x387885[_0x5bd152(0x172)](async _0x2533fa=>{var _0x5de95a=_0x5bd152;_0x387885[_0x5de95a(0x19a)][_0x2533fa['invoice']]=[],await Promise[_0x5de95a(0x1bf)](_0x2533fa[_0x5de95a(0x16f)]['map'](async _0x1fba25=>{var _0x5204ed=_0x5de95a;const _0x558bc1=await sales_finished['aggregate']([{'$unwind':_0x5204ed(0x1c6)},{'$match':{'sale_product.id_transaction_from':_0x1fba25['_id']['valueOf'](),'sale_product.invoice':_0x1fba25[_0x5204ed(0x196)]}},{'$project':{'_id':_0x5204ed(0x167),'product_name':_0x5204ed(0x162),'product_code':_0x5204ed(0x173),'quantity_available':_0x5204ed(0x19c),'warehouse_name':_0x5204ed(0x1a1),'warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x5204ed(0x17a),'date':_0x5204ed(0x1aa),'production_date':'$sale_product.production_date','expiry_date':_0x5204ed(0x18e),'UOM':_0x5204ed(0x1a2)}}]);_0x558bc1[_0x5204ed(0x1b0)]>0x0&&_0x387885['data_sales'][_0x2533fa[_0x5204ed(0x196)]][_0x5204ed(0x199)](..._0x558bc1);}));})),_0x387885['data_sales']=_0x387885[_0x5bd152(0x19a)],_0x387885['data_adjustment']={},await Promise[_0x5bd152(0x1bf)](_0x387885[_0x5bd152(0x172)](async _0x832be8=>{var _0x33e1bf=_0x5bd152;_0x387885[_0x33e1bf(0x1ab)][_0x832be8[_0x33e1bf(0x196)]]=[],await Promise[_0x33e1bf(0x1bf)](_0x832be8[_0x33e1bf(0x16f)][_0x33e1bf(0x172)](async _0x101249=>{var _0x151d78=_0x33e1bf;const _0x8f390e=await adjustment_finished[_0x151d78(0x1a9)]([{'$unwind':_0x151d78(0x19d)},{'$match':{'product.id_transaction_from':_0x101249[_0x151d78(0x1bd)]['valueOf'](),'product.invoice':_0x101249[_0x151d78(0x196)]}},{'$project':{'_id':_0x151d78(0x1c1),'product_name':'$product.product_name','product_code':_0x151d78(0x187),'quantity_available':_0x151d78(0x188),'warehouse_name':_0x151d78(0x1a1),'warehouse_room':_0x151d78(0x198),'product_invoice':_0x151d78(0x178),'invoice':_0x151d78(0x15f),'id_transaction_from':_0x151d78(0x180),'date':_0x151d78(0x1aa),'production_date':_0x151d78(0x1c4),'expiry_date':'$product.expiry_date','UOM':_0x151d78(0x16e)}}]);_0x8f390e[_0x151d78(0x1b0)]>0x0&&_0x387885[_0x151d78(0x1ab)][_0x832be8[_0x151d78(0x196)]][_0x151d78(0x199)](..._0x8f390e);}));})),_0x387885[_0x5bd152(0x1b6)]={},await Promise[_0x5bd152(0x1bf)](_0x387885[_0x5bd152(0x172)](async _0x462a05=>{var _0x51398f=_0x5bd152;_0x387885[_0x51398f(0x1b6)][_0x462a05[_0x51398f(0x196)]]=[],await Promise[_0x51398f(0x1bf)](_0x462a05['warehouse_data'][_0x51398f(0x172)](async _0x4bf668=>{var _0x88eb10=_0x51398f;const _0x1dc862=await transfers_finished[_0x88eb10(0x1a9)]([{'$unwind':_0x88eb10(0x19d)},{'$match':{'product.id_transaction':_0x4bf668['_id'][_0x88eb10(0x16b)](),'product.from_invoice':_0x4bf668[_0x88eb10(0x196)]}},{'$project':{'_id':'$product._id','product_name':_0x88eb10(0x16d),'product_code':_0x88eb10(0x187),'quantity_available':_0x88eb10(0x1af),'warehouse_name':'$to_warehouse','warehouse_room':_0x88eb10(0x198),'product_invoice':_0x88eb10(0x18a),'invoice':_0x88eb10(0x15f),'id_transaction_from':'$product.id_transaction','date':'$date','production_date':_0x88eb10(0x1c4),'expiry_date':_0x88eb10(0x1ae),'UOM':_0x88eb10(0x16e)}}]);_0x1dc862['length']>0x0&&_0x387885[_0x88eb10(0x1b6)][_0x462a05[_0x88eb10(0x196)]][_0x88eb10(0x199)](..._0x1dc862);}));})),_0x434448[_0x5bd152(0x15e)]({'purchases_warehouse':_0x387885,'data_sales':_0x387885[_0x5bd152(0x19a)],'data_adjustment':_0x387885[_0x5bd152(0x1ab)],'data_transfer':_0x387885[_0x5bd152(0x1b6)]});}}}),router['get'](a0_0x3cfbdc(0x197),auth,async(_0x42ee53,_0x579e34)=>{var _0x59b395=a0_0x3cfbdc;try{const _0x59bac6=_0x42ee53['params']['id'];var _0x1b0bd9=await purchases_finished[_0x59b395(0x186)](_0x59bac6);const _0x151732=await master_shop[_0x59b395(0x18c)](),_0x2077b8=_0x42ee53[_0x59b395(0x1c2)],_0x4f6173=await profile[_0x59b395(0x16c)]({'email':_0x2077b8['email']});if(_0x151732[0x0][_0x59b395(0x184)]==_0x59b395(0x1b2))var _0x50ee17=users[_0x59b395(0x161)];else{if(_0x151732[0x0][_0x59b395(0x184)]=='Hindi')var _0x50ee17=users['Hindi'];else{if(_0x151732[0x0][_0x59b395(0x184)]==_0x59b395(0x1c0))var _0x50ee17=users[_0x59b395(0x1c0)];else{if(_0x151732[0x0][_0x59b395(0x184)]==_0x59b395(0x183))var _0x50ee17=users['Spanish'];else{if(_0x151732[0x0][_0x59b395(0x184)]==_0x59b395(0x189))var _0x50ee17=users[_0x59b395(0x189)];else{if(_0x151732[0x0]['language']==_0x59b395(0x185))var _0x50ee17=users[_0x59b395(0x1b9)];else{if(_0x151732[0x0][_0x59b395(0x184)]==_0x59b395(0x182))var _0x50ee17=users[_0x59b395(0x182)];else{if(_0x151732[0x0][_0x59b395(0x184)]=='Arabic\x20(ae)')var _0x50ee17=users[_0x59b395(0x1a0)];}}}}}}}_0x579e34[_0x59b395(0x176)](_0x59b395(0x169),{'success':_0x42ee53['flash'](_0x59b395(0x165)),'errors':_0x42ee53[_0x59b395(0x174)]('errors'),'master_shop':_0x151732,'profile':_0x4f6173,'role':_0x2077b8,'language':_0x50ee17,'data':_0x1b0bd9});}catch(_0x160101){_0x579e34[_0x59b395(0x15e)](_0x160101);}}),router[a0_0x3cfbdc(0x1b8)](a0_0x3cfbdc(0x163),auth,async(_0x148742,_0x3a4ae7)=>{var _0x545ecf=a0_0x3cfbdc;try{const _0x5b8c3b=_0x148742[_0x545ecf(0x193)]['id'];var _0x3eac5e=await sales_finished['findById'](_0x5b8c3b);const _0x27d05b=await master_shop[_0x545ecf(0x18c)](),_0xde5ff6=_0x148742[_0x545ecf(0x1c2)],_0x1b0a58=await profile[_0x545ecf(0x16c)]({'email':_0xde5ff6[_0x545ecf(0x1b1)]});if(_0x27d05b[0x0][_0x545ecf(0x184)]==_0x545ecf(0x1b2))var _0x5c618d=users[_0x545ecf(0x161)];else{if(_0x27d05b[0x0][_0x545ecf(0x184)]==_0x545ecf(0x17c))var _0x5c618d=users['Hindi'];else{if(_0x27d05b[0x0][_0x545ecf(0x184)]==_0x545ecf(0x1c0))var _0x5c618d=users['German'];else{if(_0x27d05b[0x0]['language']==_0x545ecf(0x183))var _0x5c618d=users['Spanish'];else{if(_0x27d05b[0x0][_0x545ecf(0x184)]==_0x545ecf(0x189))var _0x5c618d=users[_0x545ecf(0x189)];else{if(_0x27d05b[0x0]['language']=='Portuguese\x20(BR)')var _0x5c618d=users['Portuguese'];else{if(_0x27d05b[0x0]['language']=='Chinese')var _0x5c618d=users[_0x545ecf(0x182)];else{if(_0x27d05b[0x0][_0x545ecf(0x184)]=='Arabic\x20(ae)')var _0x5c618d=users[_0x545ecf(0x1a0)];}}}}}}}_0x3a4ae7[_0x545ecf(0x176)](_0x545ecf(0x17e),{'success':_0x148742[_0x545ecf(0x174)](_0x545ecf(0x165)),'errors':_0x148742[_0x545ecf(0x174)](_0x545ecf(0x195)),'master_shop':_0x27d05b,'profile':_0x1b0a58,'role':_0xde5ff6,'language':_0x5c618d,'data':_0x3eac5e});}catch(_0x5e5450){_0x3a4ae7[_0x545ecf(0x15e)](_0x5e5450);}}),router[a0_0x3cfbdc(0x1b8)](a0_0x3cfbdc(0x15d),auth,async(_0x4ff35b,_0x3cdba8)=>{var _0x22d197=a0_0x3cfbdc;try{const _0xdd0724=_0x4ff35b[_0x22d197(0x193)]['id'];var _0x309706=await transfers_finished['findById'](_0xdd0724);const _0x20571a=await master_shop[_0x22d197(0x18c)](),_0x2c2b94=_0x4ff35b['user'],_0x3a0eb0=await profile[_0x22d197(0x16c)]({'email':_0x2c2b94['email']});if(_0x20571a[0x0][_0x22d197(0x184)]==_0x22d197(0x1b2))var _0x3a2950=users[_0x22d197(0x161)];else{if(_0x20571a[0x0][_0x22d197(0x184)]==_0x22d197(0x17c))var _0x3a2950=users[_0x22d197(0x17c)];else{if(_0x20571a[0x0][_0x22d197(0x184)]==_0x22d197(0x1c0))var _0x3a2950=users[_0x22d197(0x1c0)];else{if(_0x20571a[0x0][_0x22d197(0x184)]==_0x22d197(0x183))var _0x3a2950=users[_0x22d197(0x183)];else{if(_0x20571a[0x0][_0x22d197(0x184)]==_0x22d197(0x189))var _0x3a2950=users[_0x22d197(0x189)];else{if(_0x20571a[0x0][_0x22d197(0x184)]==_0x22d197(0x185))var _0x3a2950=users[_0x22d197(0x1b9)];else{if(_0x20571a[0x0][_0x22d197(0x184)]==_0x22d197(0x182))var _0x3a2950=users['Chinese'];else{if(_0x20571a[0x0][_0x22d197(0x184)]==_0x22d197(0x18b))var _0x3a2950=users[_0x22d197(0x1a0)];}}}}}}}_0x3cdba8['render'](_0x22d197(0x18d),{'success':_0x4ff35b['flash'](_0x22d197(0x165)),'errors':_0x4ff35b[_0x22d197(0x174)](_0x22d197(0x195)),'master_shop':_0x20571a,'profile':_0x3a0eb0,'role':_0x2c2b94,'language':_0x3a2950,'data':_0x309706});}catch(_0x53d2a3){_0x3cdba8[_0x22d197(0x15e)](_0x53d2a3);}}),router[a0_0x3cfbdc(0x1b8)](a0_0x3cfbdc(0x1bb),auth,async(_0x311e66,_0x38d376)=>{var _0x12e23f=a0_0x3cfbdc;try{const {username:_0x155851,email:_0x3f7963,role:_0x417c24}=_0x311e66[_0x12e23f(0x1c2)],_0x30b12b=_0x311e66[_0x12e23f(0x1c2)],_0x270b2b=await profile[_0x12e23f(0x16c)]({'email':_0x30b12b[_0x12e23f(0x1b1)]}),_0x3cac85=await master_shop['find'](),_0x2fd8bd=await warehouse['aggregate']([{'$match':{'status':_0x12e23f(0x1c5),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x12e23f(0x1a6),'name':{'$first':'$name'}}}]);if(_0x3cac85[0x0]['language']==_0x12e23f(0x1b2))var _0x173027=users[_0x12e23f(0x161)];else{if(_0x3cac85[0x0][_0x12e23f(0x184)]==_0x12e23f(0x17c))var _0x173027=users[_0x12e23f(0x17c)];else{if(_0x3cac85[0x0][_0x12e23f(0x184)]=='German')var _0x173027=users['German'];else{if(_0x3cac85[0x0][_0x12e23f(0x184)]=='Spanish')var _0x173027=users[_0x12e23f(0x183)];else{if(_0x3cac85[0x0]['language']==_0x12e23f(0x189))var _0x173027=users[_0x12e23f(0x189)];else{if(_0x3cac85[0x0][_0x12e23f(0x184)]==_0x12e23f(0x185))var _0x173027=users[_0x12e23f(0x1b9)];else{if(_0x3cac85[0x0][_0x12e23f(0x184)]=='Chinese')var _0x173027=users['Chinese'];else{if(_0x3cac85[0x0][_0x12e23f(0x184)]==_0x12e23f(0x18b))var _0x173027=users[_0x12e23f(0x1a0)];}}}}}}}_0x38d376[_0x12e23f(0x176)](_0x12e23f(0x19f),{'success':_0x311e66[_0x12e23f(0x174)](_0x12e23f(0x165)),'errors':_0x311e66['flash']('errors'),'role':_0x30b12b,'profile':_0x270b2b,'master_shop':_0x3cac85,'dataProcess':_0x2fd8bd,'language':_0x173027});}catch(_0x35b18b){console['log'](_0x35b18b);}}),module[a0_0x3cfbdc(0x17b)]=router;