var a0_0x11c644=a0_0x48ac;function a0_0x48ac(_0x2bd4d9,_0x1124ad){var _0x50602f=a0_0x5060();return a0_0x48ac=function(_0x48acc5,_0x5f0ecb){_0x48acc5=_0x48acc5-0x191;var _0x2b7af9=_0x50602f[_0x48acc5];return _0x2b7af9;},a0_0x48ac(_0x2bd4d9,_0x1124ad);}(function(_0x446e73,_0x5ba6ef){var _0xe6159=a0_0x48ac,_0x5f0605=_0x446e73();while(!![]){try{var _0x319726=parseInt(_0xe6159(0x1c2))/0x1*(parseInt(_0xe6159(0x1ca))/0x2)+-parseInt(_0xe6159(0x1e4))/0x3+-parseInt(_0xe6159(0x1b1))/0x4*(-parseInt(_0xe6159(0x1b6))/0x5)+-parseInt(_0xe6159(0x197))/0x6+parseInt(_0xe6159(0x1e8))/0x7*(-parseInt(_0xe6159(0x1ed))/0x8)+-parseInt(_0xe6159(0x199))/0x9+parseInt(_0xe6159(0x1a9))/0xa;if(_0x319726===_0x5ba6ef)break;else _0x5f0605['push'](_0x5f0605['shift']());}catch(_0xa83a02){_0x5f0605['push'](_0x5f0605['shift']());}}}(a0_0x5060,0x62969));const express=require('express'),app=express(),router=express[a0_0x11c644(0x19a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require('../models/all_models'),auth=require(a0_0x11c644(0x1f9)),users=require(a0_0x11c644(0x1ef)),nodemailer=require(a0_0x11c644(0x1f1));router[a0_0x11c644(0x1b7)](a0_0x11c644(0x1e1),auth,async(_0x220e25,_0x4471b5)=>{var _0x3eb32c=a0_0x11c644;try{const {username:_0xc93fc6,email:_0x43ae27,role:_0x3d6251}=_0x220e25[_0x3eb32c(0x1da)],_0x59a51d=_0x220e25[_0x3eb32c(0x1da)],_0x47e7ad=await profile[_0x3eb32c(0x1ec)]({'email':_0x59a51d[_0x3eb32c(0x1ad)]}),_0x1b7ba0=await master_shop[_0x3eb32c(0x196)](),_0xb4b299=await warehouse[_0x3eb32c(0x1e3)]([{'$match':{'status':'Enabled','warehouse_category':_0x3eb32c(0x1cf)}},{'$group':{'_id':'$name','name':{'$first':_0x3eb32c(0x1f5)}}}]);if(_0x1b7ba0[0x0][_0x3eb32c(0x1d2)]==_0x3eb32c(0x1d6))var _0x50ecab=users[_0x3eb32c(0x1ae)];else{if(_0x1b7ba0[0x0][_0x3eb32c(0x1d2)]==_0x3eb32c(0x1db))var _0x50ecab=users[_0x3eb32c(0x1db)];else{if(_0x1b7ba0[0x0][_0x3eb32c(0x1d2)]=='German')var _0x50ecab=users[_0x3eb32c(0x192)];else{if(_0x1b7ba0[0x0][_0x3eb32c(0x1d2)]==_0x3eb32c(0x194))var _0x50ecab=users[_0x3eb32c(0x194)];else{if(_0x1b7ba0[0x0][_0x3eb32c(0x1d2)]==_0x3eb32c(0x1e6))var _0x50ecab=users[_0x3eb32c(0x1e6)];else{if(_0x1b7ba0[0x0]['language']==_0x3eb32c(0x1d0))var _0x50ecab=users[_0x3eb32c(0x1ee)];else{if(_0x1b7ba0[0x0][_0x3eb32c(0x1d2)]==_0x3eb32c(0x1c7))var _0x50ecab=users['Chinese'];else{if(_0x1b7ba0[0x0][_0x3eb32c(0x1d2)]==_0x3eb32c(0x1fb))var _0x50ecab=users[_0x3eb32c(0x1d5)];}}}}}}}_0x4471b5[_0x3eb32c(0x1bd)](_0x3eb32c(0x1cb),{'success':_0x220e25[_0x3eb32c(0x1f2)](_0x3eb32c(0x1ce)),'errors':_0x220e25['flash'](_0x3eb32c(0x1f6)),'role':_0x59a51d,'profile':_0x47e7ad,'master_shop':_0x1b7ba0,'dataProcess':_0xb4b299,'language':_0x50ecab});}catch(_0xa8ea65){console[_0x3eb32c(0x19f)](_0xa8ea65);}}),router[a0_0x11c644(0x1a5)](a0_0x11c644(0x1b0),auth,async(_0x2dbd08,_0x221d77)=>{var _0xc57c40=a0_0x11c644;const {product_category:_0x3d8452,transaction_category:_0x952029,transaction_date_from:_0x3b26c2,transaction_date_to:_0x4e4a83,warehouse_category:_0x2b2e5a,item_code:_0x26b2ea}=_0x2dbd08['body'];console[_0xc57c40(0x19f)](_0x2b2e5a);if(_0x3d8452=='rm'){if(_0x2b2e5a==_0xc57c40(0x1f0)){var _0x282639=await purchases[_0xc57c40(0x1e3)]([{'$match':{'date':{'$gte':_0x3b26c2,'$lte':_0x4e4a83}}},{'$lookup':{'from':_0xc57c40(0x1f8),'let':{'invoice':_0xc57c40(0x1eb)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0xc57c40(0x1dc),_0xc57c40(0x19b)]}}},{'$project':{'_id':_0xc57c40(0x1f7),'product_name':'$product_details.product_name','product_code':_0xc57c40(0x1a8),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':'$room','invoice':_0xc57c40(0x19b),'production_date':_0xc57c40(0x1ba),'expiry_date':_0xc57c40(0x1cd),'UOM':_0xc57c40(0x1d9)}}],'as':_0xc57c40(0x1f4)}}]);_0x282639['data_sales']={},await Promise[_0xc57c40(0x1f0)](_0x282639[_0xc57c40(0x1b4)](async _0x2c912f=>{var _0x53d338=_0xc57c40;_0x282639[_0x53d338(0x1d4)][_0x2c912f['invoice']]=[],await Promise[_0x53d338(0x1f0)](_0x2c912f['warehouse_data']['map'](async _0x4a6736=>{var _0xf60d4c=_0x53d338;const _0x41065e=await sales[_0xf60d4c(0x1e3)]([{'$unwind':_0xf60d4c(0x1a7)},{'$match':{'sale_product.id_transaction_from':_0x4a6736[_0xf60d4c(0x1cc)]['valueOf'](),'sale_product.invoice':_0x4a6736[_0xf60d4c(0x1df)]}},{'$project':{'_id':'$sale_product._id','product_name':_0xf60d4c(0x19e),'product_code':_0xf60d4c(0x1ac),'quantity_available':_0xf60d4c(0x1af),'warehouse_name':'$warehouse_name','warehouse_room':_0xf60d4c(0x1b2),'product_invoice':_0xf60d4c(0x1bb),'invoice':_0xf60d4c(0x1eb),'id_transaction_from':_0xf60d4c(0x195),'date':_0xf60d4c(0x1a1),'production_date':_0xf60d4c(0x1e5),'expiry_date':_0xf60d4c(0x1b3),'UOM':_0xf60d4c(0x1a2)}}]);_0x41065e['length']>0x0&&_0x282639[_0xf60d4c(0x1d4)][_0x2c912f[_0xf60d4c(0x1df)]][_0xf60d4c(0x1c1)](..._0x41065e);}));})),_0x282639[_0xc57c40(0x1d4)]=_0x282639[_0xc57c40(0x1d4)],_0x282639[_0xc57c40(0x1d8)]={},await Promise[_0xc57c40(0x1f0)](_0x282639['map'](async _0x251f8f=>{var _0x30b358=_0xc57c40;_0x282639['data_adjustment'][_0x251f8f['invoice']]=[],await Promise[_0x30b358(0x1f0)](_0x251f8f[_0x30b358(0x1f4)][_0x30b358(0x1b4)](async _0x5488bd=>{var _0x3c9313=_0x30b358;const _0x5e1ccd=await adjustment[_0x3c9313(0x1e3)]([{'$unwind':_0x3c9313(0x198)},{'$match':{'product.id_transaction_from':_0x5488bd[_0x3c9313(0x1cc)][_0x3c9313(0x1a6)](),'product.invoice':_0x5488bd[_0x3c9313(0x1df)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':_0x3c9313(0x1fa),'warehouse_name':_0x3c9313(0x19c),'warehouse_room':_0x3c9313(0x19d),'product_invoice':_0x3c9313(0x1d7),'invoice':_0x3c9313(0x1eb),'id_transaction_from':'$product.id_transaction_from','date':_0x3c9313(0x1a1),'production_date':_0x3c9313(0x1a3),'expiry_date':_0x3c9313(0x1d3),'UOM':'$product.unit'}}]);_0x5e1ccd[_0x3c9313(0x1dd)]>0x0&&_0x282639[_0x3c9313(0x1d8)][_0x251f8f[_0x3c9313(0x1df)]][_0x3c9313(0x1c1)](..._0x5e1ccd);}));})),_0x282639[_0xc57c40(0x1c8)]={},await Promise[_0xc57c40(0x1f0)](_0x282639[_0xc57c40(0x1b4)](async _0x2dfa36=>{var _0x10d24d=_0xc57c40;_0x282639[_0x10d24d(0x1c8)][_0x2dfa36['invoice']]=[],await Promise[_0x10d24d(0x1f0)](_0x2dfa36['warehouse_data'][_0x10d24d(0x1b4)](async _0x29b5e4=>{var _0x1322e1=_0x10d24d;const _0x3a0390=await transfers[_0x1322e1(0x1e3)]([{'$unwind':_0x1322e1(0x198)},{'$match':{'product.id_transaction_id':_0x29b5e4[_0x1322e1(0x1cc)]['valueOf'](),'product.To_invoice':_0x29b5e4[_0x1322e1(0x1df)]}},{'$project':{'_id':_0x1322e1(0x1c5),'product_name':_0x1322e1(0x1ab),'product_code':'$product.product_code','quantity_available':_0x1322e1(0x1b8),'warehouse_name':'$to_warehouse','warehouse_room':'$product.room_names','product_invoice':_0x1322e1(0x1aa),'invoice':_0x1322e1(0x1eb),'id_transaction_from':_0x1322e1(0x1a4),'date':'$date','production_date':_0x1322e1(0x1a3),'expiry_date':_0x1322e1(0x1d3),'UOM':_0x1322e1(0x1e2)}}]);_0x3a0390[_0x1322e1(0x1dd)]>0x0&&_0x282639[_0x1322e1(0x1c8)][_0x2dfa36['invoice']]['push'](..._0x3a0390);}));})),_0x221d77[_0xc57c40(0x1c4)]({'purchases_warehouse':_0x282639,'data_sales':_0x282639[_0xc57c40(0x1d4)],'data_adjustment':_0x282639[_0xc57c40(0x1d8)],'data_transfer':_0x282639[_0xc57c40(0x1c8)]});}else{var _0x282639=await purchases[_0xc57c40(0x1e3)]([{'$match':{'warehouse_name':_0x2b2e5a,'date':{'$gte':_0x3b26c2,'$lte':_0x4e4a83}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0xc57c40(0x1eb)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0xc57c40(0x1dc),_0xc57c40(0x19b)]}}},{'$project':{'_id':_0xc57c40(0x1f7),'product_name':_0xc57c40(0x1c0),'product_code':_0xc57c40(0x1a8),'quantity_available':_0xc57c40(0x1c3),'warehouse_name':_0xc57c40(0x1f5),'warehouse_room':_0xc57c40(0x1ea),'invoice':'$product_details.invoice','production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0xc57c40(0x1d9)}}],'as':_0xc57c40(0x1f4)}}]);_0x282639[_0xc57c40(0x1d4)]={},await Promise[_0xc57c40(0x1f0)](_0x282639[_0xc57c40(0x1b4)](async _0x5992a9=>{var _0x473768=_0xc57c40;_0x282639[_0x473768(0x1d4)][_0x5992a9[_0x473768(0x1df)]]=[],await Promise[_0x473768(0x1f0)](_0x5992a9[_0x473768(0x1f4)][_0x473768(0x1b4)](async _0x4354f7=>{var _0x1037e2=_0x473768;const _0x3b6e48=await sales[_0x1037e2(0x1e3)]([{'$unwind':_0x1037e2(0x1a7)},{'$match':{'sale_product.id_transaction_from':_0x4354f7['_id'][_0x1037e2(0x1a6)](),'sale_product.invoice':_0x4354f7[_0x1037e2(0x1df)]}},{'$project':{'_id':_0x1037e2(0x1a0),'product_name':_0x1037e2(0x19e),'product_code':_0x1037e2(0x1ac),'quantity_available':_0x1037e2(0x1af),'warehouse_name':_0x1037e2(0x19c),'warehouse_room':'$sale_product.room_name','product_invoice':_0x1037e2(0x1bb),'invoice':'$invoice','id_transaction_from':_0x1037e2(0x195),'date':_0x1037e2(0x1a1),'production_date':_0x1037e2(0x1e5),'expiry_date':_0x1037e2(0x1b3),'UOM':_0x1037e2(0x1a2)}}]);_0x3b6e48[_0x1037e2(0x1dd)]>0x0&&_0x282639['data_sales'][_0x5992a9[_0x1037e2(0x1df)]][_0x1037e2(0x1c1)](..._0x3b6e48);}));})),_0x282639[_0xc57c40(0x1d4)]=_0x282639[_0xc57c40(0x1d4)],_0x282639[_0xc57c40(0x1d8)]={},await Promise[_0xc57c40(0x1f0)](_0x282639[_0xc57c40(0x1b4)](async _0x5db639=>{var _0x4efa17=_0xc57c40;_0x282639[_0x4efa17(0x1d8)][_0x5db639[_0x4efa17(0x1df)]]=[],await Promise['all'](_0x5db639[_0x4efa17(0x1f4)][_0x4efa17(0x1b4)](async _0x536e4a=>{var _0x131331=_0x4efa17;const _0xce5af0=await adjustment['aggregate']([{'$unwind':_0x131331(0x198)},{'$match':{'product.id_transaction_from':_0x536e4a['_id'][_0x131331(0x1a6)](),'product.invoice':_0x536e4a['invoice']}},{'$project':{'_id':_0x131331(0x1c5),'product_name':_0x131331(0x1ab),'product_code':_0x131331(0x1bc),'quantity_available':_0x131331(0x1fa),'warehouse_name':_0x131331(0x19c),'warehouse_room':_0x131331(0x19d),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':_0x131331(0x191),'date':'$date','production_date':'$product.production_date','expiry_date':_0x131331(0x1d3),'UOM':'$product.unit'}}]);_0xce5af0[_0x131331(0x1dd)]>0x0&&_0x282639[_0x131331(0x1d8)][_0x5db639[_0x131331(0x1df)]]['push'](..._0xce5af0);}));})),_0x282639[_0xc57c40(0x1c8)]={},await Promise[_0xc57c40(0x1f0)](_0x282639[_0xc57c40(0x1b4)](async _0x90d02d=>{var _0x2d2b53=_0xc57c40;_0x282639[_0x2d2b53(0x1c8)][_0x90d02d[_0x2d2b53(0x1df)]]=[],await Promise[_0x2d2b53(0x1f0)](_0x90d02d[_0x2d2b53(0x1f4)]['map'](async _0x40f0f1=>{var _0x37797c=_0x2d2b53;const _0x37db54=await transfers['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x40f0f1[_0x37797c(0x1cc)][_0x37797c(0x1a6)](),'product.To_invoice':_0x40f0f1[_0x37797c(0x1df)]}},{'$project':{'_id':_0x37797c(0x1c5),'product_name':_0x37797c(0x1ab),'product_code':_0x37797c(0x1bc),'quantity_available':_0x37797c(0x1b8),'warehouse_name':_0x37797c(0x1b9),'warehouse_room':_0x37797c(0x19d),'product_invoice':_0x37797c(0x1aa),'invoice':_0x37797c(0x1eb),'id_transaction_from':_0x37797c(0x1a4),'date':_0x37797c(0x1a1),'production_date':'$product.production_date','expiry_date':_0x37797c(0x1d3),'UOM':_0x37797c(0x1e2)}}]);_0x37db54[_0x37797c(0x1dd)]>0x0&&_0x282639[_0x37797c(0x1c8)][_0x90d02d[_0x37797c(0x1df)]][_0x37797c(0x1c1)](..._0x37db54);}));})),_0x221d77[_0xc57c40(0x1c4)]({'purchases_warehouse':_0x282639,'data_sales':_0x282639[_0xc57c40(0x1d4)],'data_adjustment':_0x282639[_0xc57c40(0x1d8)],'data_transfer':_0x282639['data_transfer']});}}else{if(_0x2b2e5a==_0xc57c40(0x1f0)){var _0x282639=await purchases_finished[_0xc57c40(0x1e3)]([{'$match':{'date':{'$gte':_0x3b26c2,'$lte':_0x4e4a83}}},{'$lookup':{'from':_0xc57c40(0x1f8),'let':{'invoice':_0xc57c40(0x1eb)},'pipeline':[{'$unwind':_0xc57c40(0x1c6)},{'$match':{'$expr':{'$eq':[_0xc57c40(0x1dc),_0xc57c40(0x19b)]}}},{'$project':{'_id':_0xc57c40(0x1f7),'product_name':_0xc57c40(0x1c0),'product_code':_0xc57c40(0x1a8),'quantity_available':_0xc57c40(0x1c3),'warehouse_name':'$name','warehouse_room':_0xc57c40(0x1ea),'invoice':_0xc57c40(0x19b),'production_date':'$product_details.production_date','expiry_date':_0xc57c40(0x1cd),'UOM':_0xc57c40(0x1d9)}}],'as':_0xc57c40(0x1f4)}}]);_0x282639[_0xc57c40(0x1d4)]={},await Promise[_0xc57c40(0x1f0)](_0x282639['map'](async _0x251422=>{var _0x498d14=_0xc57c40;_0x282639[_0x498d14(0x1d4)][_0x251422[_0x498d14(0x1df)]]=[],await Promise[_0x498d14(0x1f0)](_0x251422['warehouse_data'][_0x498d14(0x1b4)](async _0xe1b350=>{var _0x327976=_0x498d14;const _0x1089c9=await sales_finished['aggregate']([{'$unwind':_0x327976(0x1a7)},{'$match':{'sale_product.id_transaction_from':_0xe1b350[_0x327976(0x1cc)][_0x327976(0x1a6)](),'sale_product.invoice':_0xe1b350['invoice']}},{'$project':{'_id':_0x327976(0x1a0),'product_name':_0x327976(0x19e),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x327976(0x19c),'warehouse_room':_0x327976(0x1b2),'product_invoice':'$sale_product.invoice','invoice':_0x327976(0x1eb),'id_transaction_from':_0x327976(0x195),'date':'$date','production_date':'$sale_product.production_date','expiry_date':'$sale_product.expiry_date','UOM':'$sale_product.unit'}}]);_0x1089c9[_0x327976(0x1dd)]>0x0&&_0x282639[_0x327976(0x1d4)][_0x251422[_0x327976(0x1df)]][_0x327976(0x1c1)](..._0x1089c9);}));})),_0x282639[_0xc57c40(0x1d4)]=_0x282639[_0xc57c40(0x1d4)],_0x282639[_0xc57c40(0x1d8)]={},await Promise[_0xc57c40(0x1f0)](_0x282639[_0xc57c40(0x1b4)](async _0x235cf8=>{var _0x3fcf4b=_0xc57c40;_0x282639[_0x3fcf4b(0x1d8)][_0x235cf8[_0x3fcf4b(0x1df)]]=[],await Promise[_0x3fcf4b(0x1f0)](_0x235cf8[_0x3fcf4b(0x1f4)][_0x3fcf4b(0x1b4)](async _0x4de0bd=>{var _0x4c7663=_0x3fcf4b;const _0x20abef=await adjustment_finished[_0x4c7663(0x1e3)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x4de0bd['_id'][_0x4c7663(0x1a6)](),'product.invoice':_0x4de0bd[_0x4c7663(0x1df)]}},{'$project':{'_id':_0x4c7663(0x1c5),'product_name':_0x4c7663(0x1ab),'product_code':_0x4c7663(0x1bc),'quantity_available':_0x4c7663(0x1fa),'warehouse_name':'$warehouse_name','warehouse_room':_0x4c7663(0x19d),'product_invoice':'$product.invoice','invoice':_0x4c7663(0x1eb),'id_transaction_from':_0x4c7663(0x191),'date':_0x4c7663(0x1a1),'production_date':'$product.production_date','expiry_date':_0x4c7663(0x1d3),'UOM':'$product.unit'}}]);_0x20abef['length']>0x0&&_0x282639[_0x4c7663(0x1d8)][_0x235cf8['invoice']]['push'](..._0x20abef);}));})),_0x282639['data_transfer']={},await Promise[_0xc57c40(0x1f0)](_0x282639[_0xc57c40(0x1b4)](async _0x1f0dfb=>{var _0x2ca611=_0xc57c40;_0x282639['data_transfer'][_0x1f0dfb[_0x2ca611(0x1df)]]=[],await Promise[_0x2ca611(0x1f0)](_0x1f0dfb['warehouse_data'][_0x2ca611(0x1b4)](async _0xc1999=>{var _0x448d64=_0x2ca611;const _0x5eaf6a=await transfers_finished[_0x448d64(0x1e3)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0xc1999[_0x448d64(0x1cc)][_0x448d64(0x1a6)](),'product.from_invoice':_0xc1999['invoice']}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x448d64(0x1bc),'quantity_available':_0x448d64(0x1b8),'warehouse_name':'$to_warehouse','warehouse_room':'$product.room_names','product_invoice':'$product.to_room_name','invoice':_0x448d64(0x1eb),'id_transaction_from':_0x448d64(0x1e9),'date':'$date','production_date':_0x448d64(0x1a3),'expiry_date':'$product.expiry_date','UOM':_0x448d64(0x1e2)}}]);_0x5eaf6a[_0x448d64(0x1dd)]>0x0&&_0x282639[_0x448d64(0x1c8)][_0x1f0dfb[_0x448d64(0x1df)]]['push'](..._0x5eaf6a);}));})),_0x221d77[_0xc57c40(0x1c4)]({'purchases_warehouse':_0x282639,'data_sales':_0x282639[_0xc57c40(0x1d4)],'data_adjustment':_0x282639[_0xc57c40(0x1d8)],'data_transfer':_0x282639[_0xc57c40(0x1c8)]});}else{var _0x282639=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x2b2e5a,'date':{'$gte':_0x3b26c2,'$lte':_0x4e4a83}}},{'$lookup':{'from':_0xc57c40(0x1f8),'let':{'invoice':_0xc57c40(0x1eb)},'pipeline':[{'$unwind':_0xc57c40(0x1c6)},{'$match':{'$expr':{'$eq':[_0xc57c40(0x1dc),_0xc57c40(0x19b)]}}},{'$project':{'_id':_0xc57c40(0x1f7),'product_name':_0xc57c40(0x1c0),'product_code':_0xc57c40(0x1a8),'quantity_available':_0xc57c40(0x1c3),'warehouse_name':_0xc57c40(0x1f5),'warehouse_room':_0xc57c40(0x1ea),'invoice':_0xc57c40(0x19b),'production_date':_0xc57c40(0x1ba),'expiry_date':_0xc57c40(0x1cd),'UOM':_0xc57c40(0x1d9)}}],'as':_0xc57c40(0x1f4)}}]);_0x282639[_0xc57c40(0x1d4)]={},await Promise['all'](_0x282639[_0xc57c40(0x1b4)](async _0x4f06ae=>{var _0xa0917e=_0xc57c40;_0x282639['data_sales'][_0x4f06ae[_0xa0917e(0x1df)]]=[],await Promise['all'](_0x4f06ae['warehouse_data'][_0xa0917e(0x1b4)](async _0x441672=>{var _0x4d4c22=_0xa0917e;const _0x32644a=await sales_finished[_0x4d4c22(0x1e3)]([{'$unwind':_0x4d4c22(0x1a7)},{'$match':{'sale_product.id_transaction_from':_0x441672['_id'][_0x4d4c22(0x1a6)](),'sale_product.invoice':_0x441672[_0x4d4c22(0x1df)]}},{'$project':{'_id':_0x4d4c22(0x1a0),'product_name':_0x4d4c22(0x19e),'product_code':_0x4d4c22(0x1ac),'quantity_available':_0x4d4c22(0x1af),'warehouse_name':_0x4d4c22(0x19c),'warehouse_room':_0x4d4c22(0x1b2),'product_invoice':'$sale_product.invoice','invoice':_0x4d4c22(0x1eb),'id_transaction_from':_0x4d4c22(0x195),'date':'$date','production_date':'$sale_product.production_date','expiry_date':_0x4d4c22(0x1b3),'UOM':_0x4d4c22(0x1a2)}}]);_0x32644a[_0x4d4c22(0x1dd)]>0x0&&_0x282639[_0x4d4c22(0x1d4)][_0x4f06ae[_0x4d4c22(0x1df)]][_0x4d4c22(0x1c1)](..._0x32644a);}));})),_0x282639['data_sales']=_0x282639[_0xc57c40(0x1d4)],_0x282639['data_adjustment']={},await Promise['all'](_0x282639[_0xc57c40(0x1b4)](async _0x468da2=>{var _0x468f91=_0xc57c40;_0x282639[_0x468f91(0x1d8)][_0x468da2[_0x468f91(0x1df)]]=[],await Promise['all'](_0x468da2['warehouse_data'][_0x468f91(0x1b4)](async _0x155d5=>{var _0x1534a6=_0x468f91;const _0x1d5ea7=await adjustment_finished['aggregate']([{'$unwind':_0x1534a6(0x198)},{'$match':{'product.id_transaction_from':_0x155d5['_id'][_0x1534a6(0x1a6)](),'product.invoice':_0x155d5[_0x1534a6(0x1df)]}},{'$project':{'_id':'$product._id','product_name':_0x1534a6(0x1ab),'product_code':'$product.product_code','quantity_available':_0x1534a6(0x1fa),'warehouse_name':_0x1534a6(0x19c),'warehouse_room':_0x1534a6(0x19d),'product_invoice':_0x1534a6(0x1d7),'invoice':_0x1534a6(0x1eb),'id_transaction_from':'$product.id_transaction_from','date':_0x1534a6(0x1a1),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0x1534a6(0x1e2)}}]);_0x1d5ea7[_0x1534a6(0x1dd)]>0x0&&_0x282639[_0x1534a6(0x1d8)][_0x468da2[_0x1534a6(0x1df)]][_0x1534a6(0x1c1)](..._0x1d5ea7);}));})),_0x282639[_0xc57c40(0x1c8)]={},await Promise['all'](_0x282639['map'](async _0xbc401=>{var _0x4db326=_0xc57c40;_0x282639[_0x4db326(0x1c8)][_0xbc401[_0x4db326(0x1df)]]=[],await Promise[_0x4db326(0x1f0)](_0xbc401[_0x4db326(0x1f4)][_0x4db326(0x1b4)](async _0x754a8b=>{var _0x219ff8=_0x4db326;const _0x4ed6fe=await transfers_finished[_0x219ff8(0x1e3)]([{'$unwind':_0x219ff8(0x198)},{'$match':{'product.id_transaction':_0x754a8b['_id'][_0x219ff8(0x1a6)](),'product.from_invoice':_0x754a8b['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x219ff8(0x1ab),'product_code':_0x219ff8(0x1bc),'quantity_available':_0x219ff8(0x1b8),'warehouse_name':'$to_warehouse','warehouse_room':_0x219ff8(0x19d),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':'$product.id_transaction','date':_0x219ff8(0x1a1),'production_date':_0x219ff8(0x1a3),'expiry_date':_0x219ff8(0x1d3),'UOM':_0x219ff8(0x1e2)}}]);_0x4ed6fe['length']>0x0&&_0x282639[_0x219ff8(0x1c8)][_0xbc401[_0x219ff8(0x1df)]]['push'](..._0x4ed6fe);}));})),_0x221d77['json']({'purchases_warehouse':_0x282639,'data_sales':_0x282639[_0xc57c40(0x1d4)],'data_adjustment':_0x282639['data_adjustment'],'data_transfer':_0x282639['data_transfer']});}}}),router[a0_0x11c644(0x1b7)]('/viewdata_inc_fg/:id',auth,async(_0x4bd7de,_0x1b2c54)=>{var _0x25e5e=a0_0x11c644;try{const _0x1e7258=_0x4bd7de[_0x25e5e(0x1be)]['id'];var _0x42fa67=await purchases_finished[_0x25e5e(0x193)](_0x1e7258);const _0x1e50db=await master_shop[_0x25e5e(0x196)](),_0x3b446b=_0x4bd7de[_0x25e5e(0x1da)],_0x3c0a0e=await profile[_0x25e5e(0x1ec)]({'email':_0x3b446b[_0x25e5e(0x1ad)]});if(_0x1e50db[0x0][_0x25e5e(0x1d2)]==_0x25e5e(0x1d6))var _0x3bc1d5=users['English'];else{if(_0x1e50db[0x0][_0x25e5e(0x1d2)]==_0x25e5e(0x1db))var _0x3bc1d5=users[_0x25e5e(0x1db)];else{if(_0x1e50db[0x0][_0x25e5e(0x1d2)]==_0x25e5e(0x192))var _0x3bc1d5=users['German'];else{if(_0x1e50db[0x0]['language']==_0x25e5e(0x194))var _0x3bc1d5=users[_0x25e5e(0x194)];else{if(_0x1e50db[0x0]['language']==_0x25e5e(0x1e6))var _0x3bc1d5=users[_0x25e5e(0x1e6)];else{if(_0x1e50db[0x0][_0x25e5e(0x1d2)]==_0x25e5e(0x1d0))var _0x3bc1d5=users['Portuguese'];else{if(_0x1e50db[0x0][_0x25e5e(0x1d2)]==_0x25e5e(0x1c7))var _0x3bc1d5=users['Chinese'];else{if(_0x1e50db[0x0][_0x25e5e(0x1d2)]=='Arabic\x20(ae)')var _0x3bc1d5=users[_0x25e5e(0x1d5)];}}}}}}}_0x1b2c54[_0x25e5e(0x1bd)]('view_table',{'success':_0x4bd7de[_0x25e5e(0x1f2)](_0x25e5e(0x1ce)),'errors':_0x4bd7de['flash'](_0x25e5e(0x1f6)),'master_shop':_0x1e50db,'profile':_0x3c0a0e,'role':_0x3b446b,'language':_0x3bc1d5,'data':_0x42fa67});}catch(_0x5aceea){_0x1b2c54[_0x25e5e(0x1c4)](_0x5aceea);}}),router['get'](a0_0x11c644(0x1f3),auth,async(_0x4c6156,_0xe4c228)=>{var _0x198dfd=a0_0x11c644;try{const _0x5294c2=_0x4c6156[_0x198dfd(0x1be)]['id'];var _0x1268d9=await sales_finished['findById'](_0x5294c2);const _0x46584c=await master_shop['find'](),_0x1311c6=_0x4c6156[_0x198dfd(0x1da)],_0x58b26f=await profile['findOne']({'email':_0x1311c6[_0x198dfd(0x1ad)]});if(_0x46584c[0x0]['language']=='English\x20(US)')var _0x2d3f9d=users[_0x198dfd(0x1ae)];else{if(_0x46584c[0x0][_0x198dfd(0x1d2)]==_0x198dfd(0x1db))var _0x2d3f9d=users['Hindi'];else{if(_0x46584c[0x0][_0x198dfd(0x1d2)]==_0x198dfd(0x192))var _0x2d3f9d=users['German'];else{if(_0x46584c[0x0]['language']==_0x198dfd(0x194))var _0x2d3f9d=users['Spanish'];else{if(_0x46584c[0x0][_0x198dfd(0x1d2)]==_0x198dfd(0x1e6))var _0x2d3f9d=users[_0x198dfd(0x1e6)];else{if(_0x46584c[0x0][_0x198dfd(0x1d2)]==_0x198dfd(0x1d0))var _0x2d3f9d=users[_0x198dfd(0x1ee)];else{if(_0x46584c[0x0][_0x198dfd(0x1d2)]==_0x198dfd(0x1c7))var _0x2d3f9d=users[_0x198dfd(0x1c7)];else{if(_0x46584c[0x0][_0x198dfd(0x1d2)]==_0x198dfd(0x1fb))var _0x2d3f9d=users[_0x198dfd(0x1d5)];}}}}}}}_0xe4c228[_0x198dfd(0x1bd)](_0x198dfd(0x1c9),{'success':_0x4c6156['flash']('success'),'errors':_0x4c6156[_0x198dfd(0x1f2)](_0x198dfd(0x1f6)),'master_shop':_0x46584c,'profile':_0x58b26f,'role':_0x1311c6,'language':_0x2d3f9d,'data':_0x1268d9});}catch(_0x5d1cf8){_0xe4c228[_0x198dfd(0x1c4)](_0x5d1cf8);}}),router['get'](a0_0x11c644(0x1e0),auth,async(_0x8de422,_0x50b94d)=>{var _0x1ce381=a0_0x11c644;try{const _0xad77f2=_0x8de422[_0x1ce381(0x1be)]['id'];var _0x4e25e9=await transfers_finished[_0x1ce381(0x193)](_0xad77f2);const _0x58e3a0=await master_shop['find'](),_0x42a8b1=_0x8de422['user'],_0x83189b=await profile[_0x1ce381(0x1ec)]({'email':_0x42a8b1[_0x1ce381(0x1ad)]});if(_0x58e3a0[0x0][_0x1ce381(0x1d2)]=='English\x20(US)')var _0x4744de=users['English'];else{if(_0x58e3a0[0x0][_0x1ce381(0x1d2)]==_0x1ce381(0x1db))var _0x4744de=users[_0x1ce381(0x1db)];else{if(_0x58e3a0[0x0][_0x1ce381(0x1d2)]==_0x1ce381(0x192))var _0x4744de=users[_0x1ce381(0x192)];else{if(_0x58e3a0[0x0][_0x1ce381(0x1d2)]==_0x1ce381(0x194))var _0x4744de=users[_0x1ce381(0x194)];else{if(_0x58e3a0[0x0][_0x1ce381(0x1d2)]=='French')var _0x4744de=users[_0x1ce381(0x1e6)];else{if(_0x58e3a0[0x0]['language']=='Portuguese\x20(BR)')var _0x4744de=users[_0x1ce381(0x1ee)];else{if(_0x58e3a0[0x0][_0x1ce381(0x1d2)]=='Chinese')var _0x4744de=users[_0x1ce381(0x1c7)];else{if(_0x58e3a0[0x0][_0x1ce381(0x1d2)]==_0x1ce381(0x1fb))var _0x4744de=users[_0x1ce381(0x1d5)];}}}}}}}_0x50b94d[_0x1ce381(0x1bd)](_0x1ce381(0x1de),{'success':_0x8de422[_0x1ce381(0x1f2)]('success'),'errors':_0x8de422['flash'](_0x1ce381(0x1f6)),'master_shop':_0x58e3a0,'profile':_0x83189b,'role':_0x42a8b1,'language':_0x4744de,'data':_0x4e25e9});}catch(_0x4e328c){_0x50b94d[_0x1ce381(0x1c4)](_0x4e328c);}}),router[a0_0x11c644(0x1b7)](a0_0x11c644(0x1b5),auth,async(_0x307a29,_0x17878b)=>{var _0x1cd695=a0_0x11c644;try{const {username:_0x4ac927,email:_0x55c492,role:_0x4980d1}=_0x307a29[_0x1cd695(0x1da)],_0x4a84c5=_0x307a29[_0x1cd695(0x1da)],_0x3a90da=await profile['findOne']({'email':_0x4a84c5['email']}),_0x3e9645=await master_shop[_0x1cd695(0x196)](),_0x48ac03=await warehouse[_0x1cd695(0x1e3)]([{'$match':{'status':'Enabled','warehouse_category':_0x1cd695(0x1e7)}},{'$group':{'_id':_0x1cd695(0x1f5),'name':{'$first':_0x1cd695(0x1f5)}}}]);if(_0x3e9645[0x0][_0x1cd695(0x1d2)]==_0x1cd695(0x1d6))var _0x3dd097=users[_0x1cd695(0x1ae)];else{if(_0x3e9645[0x0][_0x1cd695(0x1d2)]==_0x1cd695(0x1db))var _0x3dd097=users[_0x1cd695(0x1db)];else{if(_0x3e9645[0x0]['language']==_0x1cd695(0x192))var _0x3dd097=users[_0x1cd695(0x192)];else{if(_0x3e9645[0x0][_0x1cd695(0x1d2)]==_0x1cd695(0x194))var _0x3dd097=users[_0x1cd695(0x194)];else{if(_0x3e9645[0x0][_0x1cd695(0x1d2)]=='French')var _0x3dd097=users[_0x1cd695(0x1e6)];else{if(_0x3e9645[0x0][_0x1cd695(0x1d2)]==_0x1cd695(0x1d0))var _0x3dd097=users[_0x1cd695(0x1ee)];else{if(_0x3e9645[0x0][_0x1cd695(0x1d2)]==_0x1cd695(0x1c7))var _0x3dd097=users[_0x1cd695(0x1c7)];else{if(_0x3e9645[0x0][_0x1cd695(0x1d2)]==_0x1cd695(0x1fb))var _0x3dd097=users[_0x1cd695(0x1d5)];}}}}}}}_0x17878b['render'](_0x1cd695(0x1bf),{'success':_0x307a29[_0x1cd695(0x1f2)](_0x1cd695(0x1ce)),'errors':_0x307a29[_0x1cd695(0x1f2)](_0x1cd695(0x1f6)),'role':_0x4a84c5,'profile':_0x3a90da,'master_shop':_0x3e9645,'dataProcess':_0x48ac03,'language':_0x3dd097});}catch(_0x3bba05){console['log'](_0x3bba05);}}),module[a0_0x11c644(0x1d1)]=router;function a0_0x5060(){var _0x5a52d8=['data_transfer','view_og_table','8716GeJDIm','transaction_finished','_id','$product_details.expiry_date','success','Finished\x20Goods','Portuguese\x20(BR)','exports','language','$product.expiry_date','data_sales','Arabic','English\x20(US)','$product.invoice','data_adjustment','$product_details.unit','user','Hindi','$$invoice','length','view_tf_table','invoice','/viewdata_tf_fg/:id','/view','$product.unit','aggregate','690975PDbCTl','$sale_product.production_date','French','Raw\x20Materials','49RnUfFV','$product.id_transaction','$room','$invoice','findOne','415088IvBSkR','Portuguese','../public/language/languages.json','all','nodemailer','flash','/viewdata_og_fg/:id','warehouse_data','$name','errors','$product_details._id','warehouses','../middleware/auth','$product.new_adjust_qty','Arabic\x20(ae)','$product.id_transaction_from','German','findById','Spanish','$sale_product.id_transaction_from','find','2461734oAsZhM','$product','388152EOeoRD','Router','$product_details.invoice','$warehouse_name','$product.room_names','$sale_product.product_name','log','$sale_product._id','$date','$sale_product.unit','$product.production_date','$product.id_transaction_id','post','valueOf','$sale_product','$product_details.product_code','4412800jWZxBm','$product.to_room_name','$product.product_name','$sale_product.product_code','email','English','$sale_product.quantity','/reports','2242428GjnWGH','$sale_product.room_name','$sale_product.expiry_date','map','/viewFG','5sKzrYr','get','$product.to_quantity','$to_warehouse','$product_details.production_date','$sale_product.invoice','$product.product_code','render','params','transaction_finished_raw','$product_details.product_name','push','103KFLJpK','$product_details.product_stock','json','$product._id','$product_details','Chinese'];a0_0x5060=function(){return _0x5a52d8;};return a0_0x5060();}