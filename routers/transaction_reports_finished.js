var a0_0x5c0107=a0_0x11df;(function(_0x7c1a26,_0xbc5b9e){var _0x3a1b7b=a0_0x11df,_0x37e0cd=_0x7c1a26();while(!![]){try{var _0x4b56ee=parseInt(_0x3a1b7b(0x151))/0x1*(-parseInt(_0x3a1b7b(0x143))/0x2)+parseInt(_0x3a1b7b(0x14a))/0x3+parseInt(_0x3a1b7b(0x102))/0x4*(parseInt(_0x3a1b7b(0x136))/0x5)+parseInt(_0x3a1b7b(0x127))/0x6*(parseInt(_0x3a1b7b(0x118))/0x7)+parseInt(_0x3a1b7b(0x117))/0x8+parseInt(_0x3a1b7b(0x130))/0x9+parseInt(_0x3a1b7b(0x113))/0xa*(-parseInt(_0x3a1b7b(0xff))/0xb);if(_0x4b56ee===_0xbc5b9e)break;else _0x37e0cd['push'](_0x37e0cd['shift']());}catch(_0x559d0b){_0x37e0cd['push'](_0x37e0cd['shift']());}}}(a0_0x1e4f,0x9ba15));function a0_0x11df(_0x246e0e,_0x23b5af){var _0x1e4f2e=a0_0x1e4f();return a0_0x11df=function(_0x11df0f,_0x296074){_0x11df0f=_0x11df0f-0xe4;var _0x51adbf=_0x1e4f2e[_0x11df0f];return _0x51adbf;},a0_0x11df(_0x246e0e,_0x23b5af);}const express=require(a0_0x5c0107(0x112)),app=express(),router=express[a0_0x5c0107(0x128)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x5c0107(0x141)),auth=require(a0_0x5c0107(0x13d)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x5c0107(0xed));function a0_0x1e4f(){var _0x42cae4=['Enabled','view_table','json','$product.expiry_date','$product.id_transaction_id','$to_warehouse','transaction_finished_raw','$product.room_names','6OqMkLA','Router','$product_details.expiry_date','$invoice','$sale_product.invoice','$product_details','errors','$sale_product.room_name','$product.invoice','4101849SdnQrL','$product.to_room_name','$product.product_code','$date','Finished\x20Goods','/viewdata_og_fg/:id','85TtwrHg','email','_id','$product_details.unit','$name','Spanish','log','../middleware/auth','$product_details.product_code','params','warehouse_data','../models/all_models','$product_details.production_date','2PiZetP','French','$sale_product.quantity','$sale_product.product_code','data_adjustment','body','German','586608HOekRA','warehouses','$product_details.product_name','data_transfer','$product','flash','get','92357EbWvpc','view_tf_table','$product_details.product_stock','Portuguese','$product.id_transaction','/reports','$product_details.invoice','/viewdata_tf_fg/:id','$warehouse_name','data_sales','map','nodemailer','$product.production_date','transaction_finished','$product.id_transaction_from','$sale_product.unit','view_og_table','push','/viewFG','Portuguese\x20(BR)','$product.new_adjust_qty','all','user','Chinese','English','Raw\x20Materials','English\x20(US)','$sale_product.id_transaction_from','exports','682xhpEBh','$sale_product.production_date','Hindi','151720CRxTKd','/view','find','valueOf','findOne','invoice','language','$sale_product','Arabic','$product._id','findById','$product.to_quantity','$sale_product.product_name','Arabic\x20(ae)','success','render','express','371920YbvDQs','$sale_product.expiry_date','$$invoice','aggregate','5226912xlAtRW','7603757pzIuqJ','$sale_product._id','$product.unit','$product_details._id','$room','length','$product.product_name'];a0_0x1e4f=function(){return _0x42cae4;};return a0_0x1e4f();}router['get'](a0_0x5c0107(0x103),auth,async(_0x814150,_0x2a58eb)=>{var _0x487365=a0_0x5c0107;try{const {username:_0x3e3754,email:_0x194943,role:_0x179b54}=_0x814150[_0x487365(0xf8)],_0x17d8be=_0x814150[_0x487365(0xf8)],_0x17b998=await profile[_0x487365(0x106)]({'email':_0x17d8be[_0x487365(0x137)]}),_0x4bb21e=await master_shop[_0x487365(0x104)](),_0xefe777=await warehouse[_0x487365(0x116)]([{'$match':{'status':_0x487365(0x11f),'warehouse_category':_0x487365(0x134)}},{'$group':{'_id':'$name','name':{'$first':_0x487365(0x13a)}}}]);if(_0x4bb21e[0x0][_0x487365(0x108)]==_0x487365(0xfc))var _0x44a8b9=users[_0x487365(0xfa)];else{if(_0x4bb21e[0x0][_0x487365(0x108)]==_0x487365(0x101))var _0x44a8b9=users[_0x487365(0x101)];else{if(_0x4bb21e[0x0]['language']=='German')var _0x44a8b9=users[_0x487365(0x149)];else{if(_0x4bb21e[0x0]['language']==_0x487365(0x13b))var _0x44a8b9=users[_0x487365(0x13b)];else{if(_0x4bb21e[0x0][_0x487365(0x108)]==_0x487365(0x144))var _0x44a8b9=users['French'];else{if(_0x4bb21e[0x0]['language']=='Portuguese\x20(BR)')var _0x44a8b9=users[_0x487365(0xe5)];else{if(_0x4bb21e[0x0][_0x487365(0x108)]=='Chinese')var _0x44a8b9=users[_0x487365(0xf9)];else{if(_0x4bb21e[0x0][_0x487365(0x108)]==_0x487365(0x10f))var _0x44a8b9=users[_0x487365(0x10a)];}}}}}}}_0x2a58eb['render'](_0x487365(0xef),{'success':_0x814150[_0x487365(0x14f)](_0x487365(0x110)),'errors':_0x814150['flash'](_0x487365(0x12d)),'role':_0x17d8be,'profile':_0x17b998,'master_shop':_0x4bb21e,'dataProcess':_0xefe777,'language':_0x44a8b9});}catch(_0xc2bf2){console['log'](_0xc2bf2);}}),router['post'](a0_0x5c0107(0xe7),auth,async(_0x6811b0,_0x13bd4c)=>{var _0x4df44a=a0_0x5c0107;const {product_category:_0x33b872,transaction_category:_0xd8a7b0,transaction_date_from:_0x123faa,transaction_date_to:_0x21d076,warehouse_category:_0x442e42,item_code:_0x378143}=_0x6811b0[_0x4df44a(0x148)];console['log'](_0x442e42);if(_0x33b872=='rm'){if(_0x442e42=='all'){var _0xe84b7a=await purchases[_0x4df44a(0x116)]([{'$match':{'date':{'$gte':_0x123faa,'$lte':_0x21d076}}},{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x4df44a(0x12c)},{'$match':{'$expr':{'$eq':['$$invoice',_0x4df44a(0xe8)]}}},{'$project':{'_id':_0x4df44a(0x11b),'product_name':_0x4df44a(0x14c),'product_code':_0x4df44a(0x13e),'quantity_available':_0x4df44a(0xe4),'warehouse_name':'$name','warehouse_room':'$room','invoice':_0x4df44a(0xe8),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x4df44a(0x139)}}],'as':_0x4df44a(0x140)}}]);_0xe84b7a[_0x4df44a(0xeb)]={},await Promise[_0x4df44a(0xf7)](_0xe84b7a[_0x4df44a(0xec)](async _0x27d21e=>{var _0xcaf073=_0x4df44a;_0xe84b7a[_0xcaf073(0xeb)][_0x27d21e[_0xcaf073(0x107)]]=[],await Promise[_0xcaf073(0xf7)](_0x27d21e[_0xcaf073(0x140)][_0xcaf073(0xec)](async _0x56e57a=>{var _0x4cc937=_0xcaf073;const _0x483520=await sales[_0x4cc937(0x116)]([{'$unwind':_0x4cc937(0x109)},{'$match':{'sale_product.id_transaction_from':_0x56e57a[_0x4cc937(0x138)][_0x4cc937(0x105)](),'sale_product.invoice':_0x56e57a[_0x4cc937(0x107)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x4cc937(0x10e),'product_code':_0x4cc937(0x146),'quantity_available':'$sale_product.quantity','warehouse_name':_0x4cc937(0xea),'warehouse_room':'$sale_product.room_name','product_invoice':_0x4cc937(0x12b),'invoice':'$invoice','id_transaction_from':_0x4cc937(0xfd),'date':_0x4cc937(0x133),'production_date':_0x4cc937(0x100),'expiry_date':_0x4cc937(0x114),'UOM':_0x4cc937(0xf1)}}]);_0x483520[_0x4cc937(0x11d)]>0x0&&_0xe84b7a[_0x4cc937(0xeb)][_0x27d21e[_0x4cc937(0x107)]][_0x4cc937(0xf3)](..._0x483520);}));})),_0xe84b7a[_0x4df44a(0xeb)]=_0xe84b7a[_0x4df44a(0xeb)],_0xe84b7a[_0x4df44a(0x147)]={},await Promise[_0x4df44a(0xf7)](_0xe84b7a['map'](async _0x3827be=>{var _0x2cc2ac=_0x4df44a;_0xe84b7a[_0x2cc2ac(0x147)][_0x3827be[_0x2cc2ac(0x107)]]=[],await Promise[_0x2cc2ac(0xf7)](_0x3827be[_0x2cc2ac(0x140)][_0x2cc2ac(0xec)](async _0x423c02=>{var _0x38e53f=_0x2cc2ac;const _0x46dbca=await adjustment[_0x38e53f(0x116)]([{'$unwind':_0x38e53f(0x14e)},{'$match':{'product.id_transaction_from':_0x423c02[_0x38e53f(0x138)][_0x38e53f(0x105)](),'product.invoice':_0x423c02[_0x38e53f(0x107)]}},{'$project':{'_id':_0x38e53f(0x10b),'product_name':'$product.product_name','product_code':_0x38e53f(0x132),'quantity_available':_0x38e53f(0xf6),'warehouse_name':'$warehouse_name','warehouse_room':_0x38e53f(0x126),'product_invoice':_0x38e53f(0x12f),'invoice':'$invoice','id_transaction_from':_0x38e53f(0xf0),'date':'$date','production_date':'$product.production_date','expiry_date':_0x38e53f(0x122),'UOM':_0x38e53f(0x11a)}}]);_0x46dbca[_0x38e53f(0x11d)]>0x0&&_0xe84b7a[_0x38e53f(0x147)][_0x3827be[_0x38e53f(0x107)]]['push'](..._0x46dbca);}));})),_0xe84b7a['data_transfer']={},await Promise[_0x4df44a(0xf7)](_0xe84b7a[_0x4df44a(0xec)](async _0x5bf483=>{var _0xe8a8ca=_0x4df44a;_0xe84b7a[_0xe8a8ca(0x14d)][_0x5bf483[_0xe8a8ca(0x107)]]=[],await Promise[_0xe8a8ca(0xf7)](_0x5bf483[_0xe8a8ca(0x140)][_0xe8a8ca(0xec)](async _0x326995=>{var _0x52485e=_0xe8a8ca;const _0x269523=await transfers[_0x52485e(0x116)]([{'$unwind':_0x52485e(0x14e)},{'$match':{'product.id_transaction_id':_0x326995[_0x52485e(0x138)]['valueOf'](),'product.To_invoice':_0x326995['invoice']}},{'$project':{'_id':_0x52485e(0x10b),'product_name':_0x52485e(0x11e),'product_code':_0x52485e(0x132),'quantity_available':_0x52485e(0x10d),'warehouse_name':_0x52485e(0x124),'warehouse_room':_0x52485e(0x126),'product_invoice':_0x52485e(0x131),'invoice':_0x52485e(0x12a),'id_transaction_from':_0x52485e(0x123),'date':_0x52485e(0x133),'production_date':_0x52485e(0xee),'expiry_date':'$product.expiry_date','UOM':_0x52485e(0x11a)}}]);_0x269523['length']>0x0&&_0xe84b7a[_0x52485e(0x14d)][_0x5bf483[_0x52485e(0x107)]][_0x52485e(0xf3)](..._0x269523);}));})),_0x13bd4c[_0x4df44a(0x121)]({'purchases_warehouse':_0xe84b7a,'data_sales':_0xe84b7a['data_sales'],'data_adjustment':_0xe84b7a[_0x4df44a(0x147)],'data_transfer':_0xe84b7a[_0x4df44a(0x14d)]});}else{var _0xe84b7a=await purchases[_0x4df44a(0x116)]([{'$match':{'warehouse_name':_0x442e42,'date':{'$gte':_0x123faa,'$lte':_0x21d076}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x4df44a(0x12a)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':['$$invoice',_0x4df44a(0xe8)]}}},{'$project':{'_id':_0x4df44a(0x11b),'product_name':_0x4df44a(0x14c),'product_code':_0x4df44a(0x13e),'quantity_available':_0x4df44a(0xe4),'warehouse_name':_0x4df44a(0x13a),'warehouse_room':_0x4df44a(0x11c),'invoice':_0x4df44a(0xe8),'production_date':_0x4df44a(0x142),'expiry_date':_0x4df44a(0x129),'UOM':_0x4df44a(0x139)}}],'as':_0x4df44a(0x140)}}]);_0xe84b7a[_0x4df44a(0xeb)]={},await Promise[_0x4df44a(0xf7)](_0xe84b7a[_0x4df44a(0xec)](async _0x2cd86e=>{var _0xd655df=_0x4df44a;_0xe84b7a['data_sales'][_0x2cd86e[_0xd655df(0x107)]]=[],await Promise['all'](_0x2cd86e[_0xd655df(0x140)]['map'](async _0x3b19df=>{var _0x2d3558=_0xd655df;const _0x391b25=await sales[_0x2d3558(0x116)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x3b19df[_0x2d3558(0x138)]['valueOf'](),'sale_product.invoice':_0x3b19df[_0x2d3558(0x107)]}},{'$project':{'_id':_0x2d3558(0x119),'product_name':_0x2d3558(0x10e),'product_code':_0x2d3558(0x146),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x2d3558(0x12e),'product_invoice':'$sale_product.invoice','invoice':_0x2d3558(0x12a),'id_transaction_from':_0x2d3558(0xfd),'date':_0x2d3558(0x133),'production_date':_0x2d3558(0x100),'expiry_date':'$sale_product.expiry_date','UOM':_0x2d3558(0xf1)}}]);_0x391b25['length']>0x0&&_0xe84b7a[_0x2d3558(0xeb)][_0x2cd86e[_0x2d3558(0x107)]]['push'](..._0x391b25);}));})),_0xe84b7a['data_sales']=_0xe84b7a['data_sales'],_0xe84b7a[_0x4df44a(0x147)]={},await Promise[_0x4df44a(0xf7)](_0xe84b7a[_0x4df44a(0xec)](async _0x4cc218=>{var _0x912919=_0x4df44a;_0xe84b7a[_0x912919(0x147)][_0x4cc218[_0x912919(0x107)]]=[],await Promise[_0x912919(0xf7)](_0x4cc218['warehouse_data'][_0x912919(0xec)](async _0x469e7f=>{var _0x5423e7=_0x912919;const _0x98d462=await adjustment[_0x5423e7(0x116)]([{'$unwind':_0x5423e7(0x14e)},{'$match':{'product.id_transaction_from':_0x469e7f['_id'][_0x5423e7(0x105)](),'product.invoice':_0x469e7f['invoice']}},{'$project':{'_id':_0x5423e7(0x10b),'product_name':'$product.product_name','product_code':_0x5423e7(0x132),'quantity_available':_0x5423e7(0xf6),'warehouse_name':_0x5423e7(0xea),'warehouse_room':_0x5423e7(0x126),'product_invoice':_0x5423e7(0x12f),'invoice':_0x5423e7(0x12a),'id_transaction_from':'$product.id_transaction_from','date':_0x5423e7(0x133),'production_date':_0x5423e7(0xee),'expiry_date':'$product.expiry_date','UOM':_0x5423e7(0x11a)}}]);_0x98d462[_0x5423e7(0x11d)]>0x0&&_0xe84b7a['data_adjustment'][_0x4cc218[_0x5423e7(0x107)]][_0x5423e7(0xf3)](..._0x98d462);}));})),_0xe84b7a['data_transfer']={},await Promise[_0x4df44a(0xf7)](_0xe84b7a[_0x4df44a(0xec)](async _0x3b7ed0=>{var _0xf7dfc8=_0x4df44a;_0xe84b7a[_0xf7dfc8(0x14d)][_0x3b7ed0[_0xf7dfc8(0x107)]]=[],await Promise[_0xf7dfc8(0xf7)](_0x3b7ed0[_0xf7dfc8(0x140)][_0xf7dfc8(0xec)](async _0x5dd593=>{var _0x422839=_0xf7dfc8;const _0x2ecdc1=await transfers[_0x422839(0x116)]([{'$unwind':_0x422839(0x14e)},{'$match':{'product.id_transaction_id':_0x5dd593['_id'][_0x422839(0x105)](),'product.To_invoice':_0x5dd593[_0x422839(0x107)]}},{'$project':{'_id':_0x422839(0x10b),'product_name':_0x422839(0x11e),'product_code':'$product.product_code','quantity_available':_0x422839(0x10d),'warehouse_name':_0x422839(0x124),'warehouse_room':_0x422839(0x126),'product_invoice':_0x422839(0x131),'invoice':'$invoice','id_transaction_from':_0x422839(0x123),'date':_0x422839(0x133),'production_date':_0x422839(0xee),'expiry_date':_0x422839(0x122),'UOM':_0x422839(0x11a)}}]);_0x2ecdc1['length']>0x0&&_0xe84b7a['data_transfer'][_0x3b7ed0[_0x422839(0x107)]][_0x422839(0xf3)](..._0x2ecdc1);}));})),_0x13bd4c['json']({'purchases_warehouse':_0xe84b7a,'data_sales':_0xe84b7a[_0x4df44a(0xeb)],'data_adjustment':_0xe84b7a[_0x4df44a(0x147)],'data_transfer':_0xe84b7a[_0x4df44a(0x14d)]});}}else{if(_0x442e42==_0x4df44a(0xf7)){var _0xe84b7a=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x123faa,'$lte':_0x21d076}}},{'$lookup':{'from':_0x4df44a(0x14b),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x4df44a(0x12c)},{'$match':{'$expr':{'$eq':[_0x4df44a(0x115),_0x4df44a(0xe8)]}}},{'$project':{'_id':_0x4df44a(0x11b),'product_name':_0x4df44a(0x14c),'product_code':'$product_details.product_code','quantity_available':_0x4df44a(0xe4),'warehouse_name':_0x4df44a(0x13a),'warehouse_room':_0x4df44a(0x11c),'invoice':_0x4df44a(0xe8),'production_date':_0x4df44a(0x142),'expiry_date':'$product_details.expiry_date','UOM':_0x4df44a(0x139)}}],'as':_0x4df44a(0x140)}}]);_0xe84b7a[_0x4df44a(0xeb)]={},await Promise[_0x4df44a(0xf7)](_0xe84b7a[_0x4df44a(0xec)](async _0x14e16e=>{var _0x612b88=_0x4df44a;_0xe84b7a[_0x612b88(0xeb)][_0x14e16e[_0x612b88(0x107)]]=[],await Promise['all'](_0x14e16e[_0x612b88(0x140)][_0x612b88(0xec)](async _0x5ad059=>{var _0x22f616=_0x612b88;const _0x3b9d45=await sales_finished[_0x22f616(0x116)]([{'$unwind':_0x22f616(0x109)},{'$match':{'sale_product.id_transaction_from':_0x5ad059[_0x22f616(0x138)]['valueOf'](),'sale_product.invoice':_0x5ad059['invoice']}},{'$project':{'_id':'$sale_product._id','product_name':_0x22f616(0x10e),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x22f616(0xea),'warehouse_room':_0x22f616(0x12e),'product_invoice':_0x22f616(0x12b),'invoice':_0x22f616(0x12a),'id_transaction_from':_0x22f616(0xfd),'date':_0x22f616(0x133),'production_date':_0x22f616(0x100),'expiry_date':_0x22f616(0x114),'UOM':_0x22f616(0xf1)}}]);_0x3b9d45['length']>0x0&&_0xe84b7a[_0x22f616(0xeb)][_0x14e16e[_0x22f616(0x107)]]['push'](..._0x3b9d45);}));})),_0xe84b7a[_0x4df44a(0xeb)]=_0xe84b7a[_0x4df44a(0xeb)],_0xe84b7a[_0x4df44a(0x147)]={},await Promise[_0x4df44a(0xf7)](_0xe84b7a[_0x4df44a(0xec)](async _0x50e2ca=>{var _0x453436=_0x4df44a;_0xe84b7a[_0x453436(0x147)][_0x50e2ca['invoice']]=[],await Promise[_0x453436(0xf7)](_0x50e2ca[_0x453436(0x140)]['map'](async _0x11cc33=>{var _0x1b6974=_0x453436;const _0x45d47f=await adjustment_finished[_0x1b6974(0x116)]([{'$unwind':_0x1b6974(0x14e)},{'$match':{'product.id_transaction_from':_0x11cc33['_id'][_0x1b6974(0x105)](),'product.invoice':_0x11cc33['invoice']}},{'$project':{'_id':_0x1b6974(0x10b),'product_name':_0x1b6974(0x11e),'product_code':_0x1b6974(0x132),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x1b6974(0x126),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':_0x1b6974(0xf0),'date':'$date','production_date':_0x1b6974(0xee),'expiry_date':_0x1b6974(0x122),'UOM':_0x1b6974(0x11a)}}]);_0x45d47f[_0x1b6974(0x11d)]>0x0&&_0xe84b7a[_0x1b6974(0x147)][_0x50e2ca[_0x1b6974(0x107)]][_0x1b6974(0xf3)](..._0x45d47f);}));})),_0xe84b7a[_0x4df44a(0x14d)]={},await Promise[_0x4df44a(0xf7)](_0xe84b7a[_0x4df44a(0xec)](async _0x36a247=>{var _0x3fdc60=_0x4df44a;_0xe84b7a[_0x3fdc60(0x14d)][_0x36a247['invoice']]=[],await Promise[_0x3fdc60(0xf7)](_0x36a247[_0x3fdc60(0x140)][_0x3fdc60(0xec)](async _0x4c6bde=>{var _0x3e8c16=_0x3fdc60;const _0x10ec67=await transfers_finished['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x4c6bde['_id']['valueOf'](),'product.from_invoice':_0x4c6bde[_0x3e8c16(0x107)]}},{'$project':{'_id':_0x3e8c16(0x10b),'product_name':_0x3e8c16(0x11e),'product_code':_0x3e8c16(0x132),'quantity_available':_0x3e8c16(0x10d),'warehouse_name':_0x3e8c16(0x124),'warehouse_room':_0x3e8c16(0x126),'product_invoice':'$product.to_room_name','invoice':_0x3e8c16(0x12a),'id_transaction_from':_0x3e8c16(0xe6),'date':'$date','production_date':'$product.production_date','expiry_date':_0x3e8c16(0x122),'UOM':_0x3e8c16(0x11a)}}]);_0x10ec67[_0x3e8c16(0x11d)]>0x0&&_0xe84b7a[_0x3e8c16(0x14d)][_0x36a247[_0x3e8c16(0x107)]]['push'](..._0x10ec67);}));})),_0x13bd4c['json']({'purchases_warehouse':_0xe84b7a,'data_sales':_0xe84b7a[_0x4df44a(0xeb)],'data_adjustment':_0xe84b7a[_0x4df44a(0x147)],'data_transfer':_0xe84b7a[_0x4df44a(0x14d)]});}else{var _0xe84b7a=await purchases_finished[_0x4df44a(0x116)]([{'$match':{'warehouse_name':_0x442e42,'date':{'$gte':_0x123faa,'$lte':_0x21d076}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x4df44a(0x12a)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x4df44a(0x11b),'product_name':_0x4df44a(0x14c),'product_code':_0x4df44a(0x13e),'quantity_available':_0x4df44a(0xe4),'warehouse_name':'$name','warehouse_room':_0x4df44a(0x11c),'invoice':_0x4df44a(0xe8),'production_date':_0x4df44a(0x142),'expiry_date':_0x4df44a(0x129),'UOM':'$product_details.unit'}}],'as':'warehouse_data'}}]);_0xe84b7a[_0x4df44a(0xeb)]={},await Promise['all'](_0xe84b7a['map'](async _0x33ba2c=>{var _0x4ad7e7=_0x4df44a;_0xe84b7a['data_sales'][_0x33ba2c['invoice']]=[],await Promise['all'](_0x33ba2c[_0x4ad7e7(0x140)][_0x4ad7e7(0xec)](async _0x55eb15=>{var _0x336ad1=_0x4ad7e7;const _0x445b31=await sales_finished[_0x336ad1(0x116)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x55eb15[_0x336ad1(0x138)][_0x336ad1(0x105)](),'sale_product.invoice':_0x55eb15[_0x336ad1(0x107)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x336ad1(0x10e),'product_code':_0x336ad1(0x146),'quantity_available':_0x336ad1(0x145),'warehouse_name':_0x336ad1(0xea),'warehouse_room':_0x336ad1(0x12e),'product_invoice':_0x336ad1(0x12b),'invoice':_0x336ad1(0x12a),'id_transaction_from':_0x336ad1(0xfd),'date':_0x336ad1(0x133),'production_date':'$sale_product.production_date','expiry_date':'$sale_product.expiry_date','UOM':_0x336ad1(0xf1)}}]);_0x445b31['length']>0x0&&_0xe84b7a['data_sales'][_0x33ba2c[_0x336ad1(0x107)]]['push'](..._0x445b31);}));})),_0xe84b7a[_0x4df44a(0xeb)]=_0xe84b7a[_0x4df44a(0xeb)],_0xe84b7a[_0x4df44a(0x147)]={},await Promise['all'](_0xe84b7a[_0x4df44a(0xec)](async _0x3b91ee=>{var _0x58acbd=_0x4df44a;_0xe84b7a[_0x58acbd(0x147)][_0x3b91ee['invoice']]=[],await Promise[_0x58acbd(0xf7)](_0x3b91ee[_0x58acbd(0x140)]['map'](async _0x4bf98d=>{var _0x2ab45d=_0x58acbd;const _0x165672=await adjustment_finished[_0x2ab45d(0x116)]([{'$unwind':_0x2ab45d(0x14e)},{'$match':{'product.id_transaction_from':_0x4bf98d[_0x2ab45d(0x138)][_0x2ab45d(0x105)](),'product.invoice':_0x4bf98d['invoice']}},{'$project':{'_id':_0x2ab45d(0x10b),'product_name':_0x2ab45d(0x11e),'product_code':_0x2ab45d(0x132),'quantity_available':_0x2ab45d(0xf6),'warehouse_name':_0x2ab45d(0xea),'warehouse_room':_0x2ab45d(0x126),'product_invoice':'$product.invoice','invoice':_0x2ab45d(0x12a),'id_transaction_from':_0x2ab45d(0xf0),'date':_0x2ab45d(0x133),'production_date':_0x2ab45d(0xee),'expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x165672[_0x2ab45d(0x11d)]>0x0&&_0xe84b7a[_0x2ab45d(0x147)][_0x3b91ee[_0x2ab45d(0x107)]][_0x2ab45d(0xf3)](..._0x165672);}));})),_0xe84b7a['data_transfer']={},await Promise[_0x4df44a(0xf7)](_0xe84b7a['map'](async _0x411657=>{var _0x67e354=_0x4df44a;_0xe84b7a[_0x67e354(0x14d)][_0x411657[_0x67e354(0x107)]]=[],await Promise['all'](_0x411657[_0x67e354(0x140)][_0x67e354(0xec)](async _0x584f58=>{var _0x196fce=_0x67e354;const _0x30b17e=await transfers_finished['aggregate']([{'$unwind':_0x196fce(0x14e)},{'$match':{'product.id_transaction':_0x584f58[_0x196fce(0x138)][_0x196fce(0x105)](),'product.from_invoice':_0x584f58[_0x196fce(0x107)]}},{'$project':{'_id':'$product._id','product_name':_0x196fce(0x11e),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x196fce(0x124),'warehouse_room':'$product.room_names','product_invoice':_0x196fce(0x131),'invoice':_0x196fce(0x12a),'id_transaction_from':_0x196fce(0xe6),'date':_0x196fce(0x133),'production_date':'$product.production_date','expiry_date':_0x196fce(0x122),'UOM':_0x196fce(0x11a)}}]);_0x30b17e[_0x196fce(0x11d)]>0x0&&_0xe84b7a[_0x196fce(0x14d)][_0x411657[_0x196fce(0x107)]][_0x196fce(0xf3)](..._0x30b17e);}));})),_0x13bd4c[_0x4df44a(0x121)]({'purchases_warehouse':_0xe84b7a,'data_sales':_0xe84b7a[_0x4df44a(0xeb)],'data_adjustment':_0xe84b7a[_0x4df44a(0x147)],'data_transfer':_0xe84b7a[_0x4df44a(0x14d)]});}}}),router['get']('/viewdata_inc_fg/:id',auth,async(_0x181115,_0x256934)=>{var _0x338e6d=a0_0x5c0107;try{const _0x30c281=_0x181115[_0x338e6d(0x13f)]['id'];var _0x217f43=await purchases_finished[_0x338e6d(0x10c)](_0x30c281);const _0x5cb495=await master_shop['find'](),_0x29b630=_0x181115[_0x338e6d(0xf8)],_0x1ffa89=await profile[_0x338e6d(0x106)]({'email':_0x29b630['email']});if(_0x5cb495[0x0][_0x338e6d(0x108)]=='English\x20(US)')var _0x85ddfc=users[_0x338e6d(0xfa)];else{if(_0x5cb495[0x0]['language']=='Hindi')var _0x85ddfc=users[_0x338e6d(0x101)];else{if(_0x5cb495[0x0][_0x338e6d(0x108)]=='German')var _0x85ddfc=users[_0x338e6d(0x149)];else{if(_0x5cb495[0x0][_0x338e6d(0x108)]==_0x338e6d(0x13b))var _0x85ddfc=users['Spanish'];else{if(_0x5cb495[0x0]['language']==_0x338e6d(0x144))var _0x85ddfc=users[_0x338e6d(0x144)];else{if(_0x5cb495[0x0][_0x338e6d(0x108)]==_0x338e6d(0xf5))var _0x85ddfc=users[_0x338e6d(0xe5)];else{if(_0x5cb495[0x0]['language']==_0x338e6d(0xf9))var _0x85ddfc=users['Chinese'];else{if(_0x5cb495[0x0][_0x338e6d(0x108)]==_0x338e6d(0x10f))var _0x85ddfc=users[_0x338e6d(0x10a)];}}}}}}}_0x256934['render'](_0x338e6d(0x120),{'success':_0x181115[_0x338e6d(0x14f)](_0x338e6d(0x110)),'errors':_0x181115[_0x338e6d(0x14f)](_0x338e6d(0x12d)),'master_shop':_0x5cb495,'profile':_0x1ffa89,'role':_0x29b630,'language':_0x85ddfc,'data':_0x217f43});}catch(_0x5168e0){_0x256934[_0x338e6d(0x121)](_0x5168e0);}}),router[a0_0x5c0107(0x150)](a0_0x5c0107(0x135),auth,async(_0x319453,_0x21a6e6)=>{var _0x849bd2=a0_0x5c0107;try{const _0x3e5d2f=_0x319453[_0x849bd2(0x13f)]['id'];var _0x44eae9=await sales_finished[_0x849bd2(0x10c)](_0x3e5d2f);const _0x3221cd=await master_shop[_0x849bd2(0x104)](),_0x5f1de9=_0x319453['user'],_0x2aac64=await profile[_0x849bd2(0x106)]({'email':_0x5f1de9[_0x849bd2(0x137)]});if(_0x3221cd[0x0]['language']==_0x849bd2(0xfc))var _0x3cb08c=users[_0x849bd2(0xfa)];else{if(_0x3221cd[0x0][_0x849bd2(0x108)]=='Hindi')var _0x3cb08c=users[_0x849bd2(0x101)];else{if(_0x3221cd[0x0]['language']==_0x849bd2(0x149))var _0x3cb08c=users['German'];else{if(_0x3221cd[0x0][_0x849bd2(0x108)]=='Spanish')var _0x3cb08c=users[_0x849bd2(0x13b)];else{if(_0x3221cd[0x0][_0x849bd2(0x108)]==_0x849bd2(0x144))var _0x3cb08c=users[_0x849bd2(0x144)];else{if(_0x3221cd[0x0]['language']==_0x849bd2(0xf5))var _0x3cb08c=users[_0x849bd2(0xe5)];else{if(_0x3221cd[0x0]['language']==_0x849bd2(0xf9))var _0x3cb08c=users[_0x849bd2(0xf9)];else{if(_0x3221cd[0x0][_0x849bd2(0x108)]==_0x849bd2(0x10f))var _0x3cb08c=users[_0x849bd2(0x10a)];}}}}}}}_0x21a6e6[_0x849bd2(0x111)](_0x849bd2(0xf2),{'success':_0x319453[_0x849bd2(0x14f)]('success'),'errors':_0x319453[_0x849bd2(0x14f)](_0x849bd2(0x12d)),'master_shop':_0x3221cd,'profile':_0x2aac64,'role':_0x5f1de9,'language':_0x3cb08c,'data':_0x44eae9});}catch(_0x3b5dd9){_0x21a6e6[_0x849bd2(0x121)](_0x3b5dd9);}}),router['get'](a0_0x5c0107(0xe9),auth,async(_0xa1db48,_0x2d4f7c)=>{var _0x1322d4=a0_0x5c0107;try{const _0x191556=_0xa1db48['params']['id'];var _0x46f7fb=await transfers_finished['findById'](_0x191556);const _0x7d54b2=await master_shop[_0x1322d4(0x104)](),_0x46928a=_0xa1db48['user'],_0x29471e=await profile['findOne']({'email':_0x46928a['email']});if(_0x7d54b2[0x0][_0x1322d4(0x108)]==_0x1322d4(0xfc))var _0x3288e1=users[_0x1322d4(0xfa)];else{if(_0x7d54b2[0x0]['language']==_0x1322d4(0x101))var _0x3288e1=users['Hindi'];else{if(_0x7d54b2[0x0][_0x1322d4(0x108)]==_0x1322d4(0x149))var _0x3288e1=users[_0x1322d4(0x149)];else{if(_0x7d54b2[0x0]['language']==_0x1322d4(0x13b))var _0x3288e1=users['Spanish'];else{if(_0x7d54b2[0x0][_0x1322d4(0x108)]==_0x1322d4(0x144))var _0x3288e1=users[_0x1322d4(0x144)];else{if(_0x7d54b2[0x0][_0x1322d4(0x108)]==_0x1322d4(0xf5))var _0x3288e1=users[_0x1322d4(0xe5)];else{if(_0x7d54b2[0x0][_0x1322d4(0x108)]==_0x1322d4(0xf9))var _0x3288e1=users[_0x1322d4(0xf9)];else{if(_0x7d54b2[0x0][_0x1322d4(0x108)]==_0x1322d4(0x10f))var _0x3288e1=users[_0x1322d4(0x10a)];}}}}}}}_0x2d4f7c[_0x1322d4(0x111)](_0x1322d4(0x152),{'success':_0xa1db48[_0x1322d4(0x14f)]('success'),'errors':_0xa1db48[_0x1322d4(0x14f)](_0x1322d4(0x12d)),'master_shop':_0x7d54b2,'profile':_0x29471e,'role':_0x46928a,'language':_0x3288e1,'data':_0x46f7fb});}catch(_0xf6024f){_0x2d4f7c[_0x1322d4(0x121)](_0xf6024f);}}),router[a0_0x5c0107(0x150)](a0_0x5c0107(0xf4),auth,async(_0x43b48b,_0x1a5aef)=>{var _0x43d750=a0_0x5c0107;try{const {username:_0x49506f,email:_0x4c0242,role:_0x33c617}=_0x43b48b['user'],_0x11b0b2=_0x43b48b['user'],_0x41b469=await profile[_0x43d750(0x106)]({'email':_0x11b0b2[_0x43d750(0x137)]}),_0x195669=await master_shop[_0x43d750(0x104)](),_0x16a03=await warehouse['aggregate']([{'$match':{'status':_0x43d750(0x11f),'warehouse_category':_0x43d750(0xfb)}},{'$group':{'_id':_0x43d750(0x13a),'name':{'$first':_0x43d750(0x13a)}}}]);if(_0x195669[0x0][_0x43d750(0x108)]==_0x43d750(0xfc))var _0x3750cc=users[_0x43d750(0xfa)];else{if(_0x195669[0x0][_0x43d750(0x108)]=='Hindi')var _0x3750cc=users[_0x43d750(0x101)];else{if(_0x195669[0x0][_0x43d750(0x108)]==_0x43d750(0x149))var _0x3750cc=users[_0x43d750(0x149)];else{if(_0x195669[0x0]['language']=='Spanish')var _0x3750cc=users[_0x43d750(0x13b)];else{if(_0x195669[0x0]['language']=='French')var _0x3750cc=users['French'];else{if(_0x195669[0x0][_0x43d750(0x108)]==_0x43d750(0xf5))var _0x3750cc=users[_0x43d750(0xe5)];else{if(_0x195669[0x0][_0x43d750(0x108)]==_0x43d750(0xf9))var _0x3750cc=users[_0x43d750(0xf9)];else{if(_0x195669[0x0][_0x43d750(0x108)]==_0x43d750(0x10f))var _0x3750cc=users[_0x43d750(0x10a)];}}}}}}}_0x1a5aef['render'](_0x43d750(0x125),{'success':_0x43b48b[_0x43d750(0x14f)](_0x43d750(0x110)),'errors':_0x43b48b[_0x43d750(0x14f)](_0x43d750(0x12d)),'role':_0x11b0b2,'profile':_0x41b469,'master_shop':_0x195669,'dataProcess':_0x16a03,'language':_0x3750cc});}catch(_0x4e30a3){console[_0x43d750(0x13c)](_0x4e30a3);}}),module[a0_0x5c0107(0xfe)]=router;