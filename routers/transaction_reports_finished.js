var a0_0x4d89bb=a0_0x4160;(function(_0x4121d6,_0x4213a6){var _0xb8bf13=a0_0x4160,_0xe132c5=_0x4121d6();while(!![]){try{var _0x2c7462=-parseInt(_0xb8bf13(0xba))/0x1+-parseInt(_0xb8bf13(0xfd))/0x2+parseInt(_0xb8bf13(0x110))/0x3+parseInt(_0xb8bf13(0xe9))/0x4*(-parseInt(_0xb8bf13(0xf4))/0x5)+-parseInt(_0xb8bf13(0x108))/0x6+parseInt(_0xb8bf13(0x100))/0x7+parseInt(_0xb8bf13(0xac))/0x8;if(_0x2c7462===_0x4213a6)break;else _0xe132c5['push'](_0xe132c5['shift']());}catch(_0x4e1fc9){_0xe132c5['push'](_0xe132c5['shift']());}}}(a0_0x3029,0x91485));function a0_0x4160(_0x479ac9,_0x2129d6){var _0x302971=a0_0x3029();return a0_0x4160=function(_0x416014,_0x304d72){_0x416014=_0x416014-0xa9;var _0x1c797e=_0x302971[_0x416014];return _0x1c797e;},a0_0x4160(_0x479ac9,_0x2129d6);}function a0_0x3029(){var _0x189156=['render','$product.unit','language','English','German','2016KwFEPd','post','push','aggregate','warehouses','$sale_product._id','data_transfer','log','$name','$product.expiry_date','$sale_product.invoice','9590vcIZpf','$product_details.expiry_date','English\x20(US)','$product.id_transaction','Raw\x20Materials','data_adjustment','Router','warehouse_data','$product_details.production_date','353054enVqmq','/viewdata_inc_fg/:id','$product_details.product_stock','516964jedtLk','email','$to_warehouse','/viewFG','$sale_product.id_transaction_from','$product','find','$sale_product.room_name','1231842NWfwYM','express','$product.product_code','Enabled','user','$$invoice','$product.to_quantity','$invoice','790005gbdoFe','Chinese','$product.id_transaction_id','$product.product_name','errors','all','13290776JMBLzb','map','/viewdata_og_fg/:id','Hindi','transaction_finished_raw','params','$sale_product.production_date','$product.invoice','$product.production_date','$product.room_names','Arabic\x20(ae)','../public/language/languages.json','$product_details.product_name','body','54951UNIVTm','$sale_product.unit','/view','$room','exports','$sale_product.product_name','valueOf','json','nodemailer','view_tf_table','$product.id_transaction_from','../middleware/auth','Spanish','data_sales','$product_details.product_code','get','$date','Portuguese','flash','French','$product.to_room_name','$sale_product.expiry_date','$sale_product','view_og_table','$product_details._id','Portuguese\x20(BR)','$warehouse_name','findOne','success','$sale_product.product_code','findById','_id','$product._id','$product_details.unit','$product_details','$product_details.invoice','invoice','length','view_table','$product.new_adjust_qty','$sale_product.quantity','Arabic'];a0_0x3029=function(){return _0x189156;};return a0_0x3029();}const express=require(a0_0x4d89bb(0x109)),app=express(),router=express[a0_0x4d89bb(0xfa)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require('../models/all_models'),auth=require(a0_0x4d89bb(0xc5)),users=require(a0_0x4d89bb(0xb7)),nodemailer=require(a0_0x4d89bb(0xc2));router['get'](a0_0x4d89bb(0xbc),auth,async(_0x59946d,_0x37110e)=>{var _0xb9770c=a0_0x4d89bb;try{const {username:_0x1225c0,email:_0x140136,role:_0x1beb56}=_0x59946d['user'],_0x483b58=_0x59946d[_0xb9770c(0x10c)],_0x31e80f=await profile['findOne']({'email':_0x483b58[_0xb9770c(0x101)]}),_0x4242fd=await master_shop['find'](),_0x21d403=await warehouse['aggregate']([{'$match':{'status':_0xb9770c(0x10b),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0xb9770c(0xf1),'name':{'$first':_0xb9770c(0xf1)}}}]);if(_0x4242fd[0x0][_0xb9770c(0xe6)]==_0xb9770c(0xf6))var _0x13f408=users[_0xb9770c(0xe7)];else{if(_0x4242fd[0x0]['language']==_0xb9770c(0xaf))var _0x13f408=users[_0xb9770c(0xaf)];else{if(_0x4242fd[0x0]['language']==_0xb9770c(0xe8))var _0x13f408=users['German'];else{if(_0x4242fd[0x0][_0xb9770c(0xe6)]==_0xb9770c(0xc6))var _0x13f408=users['Spanish'];else{if(_0x4242fd[0x0][_0xb9770c(0xe6)]==_0xb9770c(0xcd))var _0x13f408=users[_0xb9770c(0xcd)];else{if(_0x4242fd[0x0][_0xb9770c(0xe6)]==_0xb9770c(0xd3))var _0x13f408=users['Portuguese'];else{if(_0x4242fd[0x0]['language']==_0xb9770c(0x111))var _0x13f408=users['Chinese'];else{if(_0x4242fd[0x0][_0xb9770c(0xe6)]=='Arabic\x20(ae)')var _0x13f408=users[_0xb9770c(0xe3)];}}}}}}}_0x37110e['render']('transaction_finished',{'success':_0x59946d[_0xb9770c(0xcc)](_0xb9770c(0xd6)),'errors':_0x59946d[_0xb9770c(0xcc)](_0xb9770c(0xaa)),'role':_0x483b58,'profile':_0x31e80f,'master_shop':_0x4242fd,'dataProcess':_0x21d403,'language':_0x13f408});}catch(_0x1f4258){console[_0xb9770c(0xf0)](_0x1f4258);}}),router[a0_0x4d89bb(0xea)]('/reports',auth,async(_0xeddfe7,_0x2c6394)=>{var _0x253ffc=a0_0x4d89bb;const {product_category:_0x5c4736,transaction_category:_0x16645c,transaction_date_from:_0x1ca675,transaction_date_to:_0x4ee4cc,warehouse_category:_0x33b682,item_code:_0x3c066b}=_0xeddfe7[_0x253ffc(0xb9)];console[_0x253ffc(0xf0)](_0x33b682);if(_0x5c4736=='rm'){if(_0x33b682==_0x253ffc(0xab)){var _0x552b4f=await purchases['aggregate']([{'$match':{'date':{'$gte':_0x1ca675,'$lte':_0x4ee4cc}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x253ffc(0x10f)},'pipeline':[{'$unwind':_0x253ffc(0xdc)},{'$match':{'$expr':{'$eq':[_0x253ffc(0x10d),'$product_details.invoice']}}},{'$project':{'_id':_0x253ffc(0xd2),'product_name':'$product_details.product_name','product_code':_0x253ffc(0xc8),'quantity_available':_0x253ffc(0xff),'warehouse_name':_0x253ffc(0xf1),'warehouse_room':_0x253ffc(0xbd),'invoice':_0x253ffc(0xdd),'production_date':_0x253ffc(0xfc),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':_0x253ffc(0xfb)}}]);_0x552b4f['data_sales']={},await Promise[_0x253ffc(0xab)](_0x552b4f[_0x253ffc(0xad)](async _0x599b04=>{var _0x570c59=_0x253ffc;_0x552b4f[_0x570c59(0xc7)][_0x599b04[_0x570c59(0xde)]]=[],await Promise[_0x570c59(0xab)](_0x599b04['warehouse_data'][_0x570c59(0xad)](async _0x1868c8=>{var _0x11a76d=_0x570c59;const _0x306de2=await sales[_0x11a76d(0xec)]([{'$unwind':_0x11a76d(0xd0)},{'$match':{'sale_product.id_transaction_from':_0x1868c8[_0x11a76d(0xd9)][_0x11a76d(0xc0)](),'sale_product.invoice':_0x1868c8[_0x11a76d(0xde)]}},{'$project':{'_id':'$sale_product._id','product_name':'$sale_product.product_name','product_code':_0x11a76d(0xd7),'quantity_available':_0x11a76d(0xe2),'warehouse_name':'$warehouse_name','warehouse_room':_0x11a76d(0x107),'product_invoice':'$sale_product.invoice','invoice':_0x11a76d(0x10f),'id_transaction_from':_0x11a76d(0x104),'date':_0x11a76d(0xca),'production_date':'$sale_product.production_date','expiry_date':_0x11a76d(0xcf),'UOM':'$sale_product.unit'}}]);_0x306de2['length']>0x0&&_0x552b4f[_0x11a76d(0xc7)][_0x599b04[_0x11a76d(0xde)]][_0x11a76d(0xeb)](..._0x306de2);}));})),_0x552b4f['data_sales']=_0x552b4f['data_sales'],_0x552b4f[_0x253ffc(0xf9)]={},await Promise[_0x253ffc(0xab)](_0x552b4f[_0x253ffc(0xad)](async _0x3842dc=>{var _0x24f701=_0x253ffc;_0x552b4f[_0x24f701(0xf9)][_0x3842dc[_0x24f701(0xde)]]=[],await Promise[_0x24f701(0xab)](_0x3842dc['warehouse_data'][_0x24f701(0xad)](async _0x474465=>{var _0xe5cde2=_0x24f701;const _0x3bcb0d=await adjustment[_0xe5cde2(0xec)]([{'$unwind':_0xe5cde2(0x105)},{'$match':{'product.id_transaction_from':_0x474465[_0xe5cde2(0xd9)][_0xe5cde2(0xc0)](),'product.invoice':_0x474465['invoice']}},{'$project':{'_id':_0xe5cde2(0xda),'product_name':_0xe5cde2(0xa9),'product_code':_0xe5cde2(0x10a),'quantity_available':_0xe5cde2(0xe1),'warehouse_name':_0xe5cde2(0xd4),'warehouse_room':_0xe5cde2(0xb5),'product_invoice':'$product.invoice','invoice':_0xe5cde2(0x10f),'id_transaction_from':'$product.id_transaction_from','date':_0xe5cde2(0xca),'production_date':_0xe5cde2(0xb4),'expiry_date':'$product.expiry_date','UOM':_0xe5cde2(0xe5)}}]);_0x3bcb0d[_0xe5cde2(0xdf)]>0x0&&_0x552b4f['data_adjustment'][_0x3842dc[_0xe5cde2(0xde)]][_0xe5cde2(0xeb)](..._0x3bcb0d);}));})),_0x552b4f[_0x253ffc(0xef)]={},await Promise['all'](_0x552b4f[_0x253ffc(0xad)](async _0x442793=>{var _0x4edb77=_0x253ffc;_0x552b4f[_0x4edb77(0xef)][_0x442793['invoice']]=[],await Promise[_0x4edb77(0xab)](_0x442793[_0x4edb77(0xfb)][_0x4edb77(0xad)](async _0x249267=>{var _0x372314=_0x4edb77;const _0x39cc71=await transfers[_0x372314(0xec)]([{'$unwind':_0x372314(0x105)},{'$match':{'product.id_transaction_id':_0x249267[_0x372314(0xd9)]['valueOf'](),'product.To_invoice':_0x249267['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x372314(0xa9),'product_code':_0x372314(0x10a),'quantity_available':'$product.to_quantity','warehouse_name':_0x372314(0x102),'warehouse_room':_0x372314(0xb5),'product_invoice':_0x372314(0xce),'invoice':_0x372314(0x10f),'id_transaction_from':_0x372314(0x112),'date':_0x372314(0xca),'production_date':_0x372314(0xb4),'expiry_date':'$product.expiry_date','UOM':_0x372314(0xe5)}}]);_0x39cc71['length']>0x0&&_0x552b4f[_0x372314(0xef)][_0x442793[_0x372314(0xde)]][_0x372314(0xeb)](..._0x39cc71);}));})),_0x2c6394[_0x253ffc(0xc1)]({'purchases_warehouse':_0x552b4f,'data_sales':_0x552b4f[_0x253ffc(0xc7)],'data_adjustment':_0x552b4f['data_adjustment'],'data_transfer':_0x552b4f[_0x253ffc(0xef)]});}else{var _0x552b4f=await purchases[_0x253ffc(0xec)]([{'$match':{'warehouse_name':_0x33b682,'date':{'$gte':_0x1ca675,'$lte':_0x4ee4cc}}},{'$lookup':{'from':_0x253ffc(0xed),'let':{'invoice':_0x253ffc(0x10f)},'pipeline':[{'$unwind':_0x253ffc(0xdc)},{'$match':{'$expr':{'$eq':['$$invoice',_0x253ffc(0xdd)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x253ffc(0xb8),'product_code':_0x253ffc(0xc8),'quantity_available':_0x253ffc(0xff),'warehouse_name':_0x253ffc(0xf1),'warehouse_room':_0x253ffc(0xbd),'invoice':_0x253ffc(0xdd),'production_date':_0x253ffc(0xfc),'expiry_date':_0x253ffc(0xf5),'UOM':_0x253ffc(0xdb)}}],'as':'warehouse_data'}}]);_0x552b4f[_0x253ffc(0xc7)]={},await Promise[_0x253ffc(0xab)](_0x552b4f['map'](async _0x805014=>{var _0x6f4a2b=_0x253ffc;_0x552b4f[_0x6f4a2b(0xc7)][_0x805014[_0x6f4a2b(0xde)]]=[],await Promise['all'](_0x805014[_0x6f4a2b(0xfb)][_0x6f4a2b(0xad)](async _0x2ad2c1=>{var _0x1779bd=_0x6f4a2b;const _0x5a14f4=await sales[_0x1779bd(0xec)]([{'$unwind':_0x1779bd(0xd0)},{'$match':{'sale_product.id_transaction_from':_0x2ad2c1[_0x1779bd(0xd9)][_0x1779bd(0xc0)](),'sale_product.invoice':_0x2ad2c1[_0x1779bd(0xde)]}},{'$project':{'_id':_0x1779bd(0xee),'product_name':'$sale_product.product_name','product_code':_0x1779bd(0xd7),'quantity_available':_0x1779bd(0xe2),'warehouse_name':_0x1779bd(0xd4),'warehouse_room':_0x1779bd(0x107),'product_invoice':_0x1779bd(0xf3),'invoice':_0x1779bd(0x10f),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x1779bd(0xca),'production_date':_0x1779bd(0xb2),'expiry_date':_0x1779bd(0xcf),'UOM':_0x1779bd(0xbb)}}]);_0x5a14f4[_0x1779bd(0xdf)]>0x0&&_0x552b4f[_0x1779bd(0xc7)][_0x805014[_0x1779bd(0xde)]][_0x1779bd(0xeb)](..._0x5a14f4);}));})),_0x552b4f['data_sales']=_0x552b4f['data_sales'],_0x552b4f[_0x253ffc(0xf9)]={},await Promise[_0x253ffc(0xab)](_0x552b4f[_0x253ffc(0xad)](async _0xdd135d=>{var _0x26fff2=_0x253ffc;_0x552b4f[_0x26fff2(0xf9)][_0xdd135d['invoice']]=[],await Promise[_0x26fff2(0xab)](_0xdd135d[_0x26fff2(0xfb)][_0x26fff2(0xad)](async _0x11e009=>{var _0x421bcf=_0x26fff2;const _0x1e76a8=await adjustment[_0x421bcf(0xec)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x11e009['_id'][_0x421bcf(0xc0)](),'product.invoice':_0x11e009[_0x421bcf(0xde)]}},{'$project':{'_id':_0x421bcf(0xda),'product_name':_0x421bcf(0xa9),'product_code':_0x421bcf(0x10a),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x421bcf(0xb5),'product_invoice':_0x421bcf(0xb3),'invoice':_0x421bcf(0x10f),'id_transaction_from':_0x421bcf(0xc4),'date':'$date','production_date':_0x421bcf(0xb4),'expiry_date':_0x421bcf(0xf2),'UOM':_0x421bcf(0xe5)}}]);_0x1e76a8['length']>0x0&&_0x552b4f['data_adjustment'][_0xdd135d[_0x421bcf(0xde)]][_0x421bcf(0xeb)](..._0x1e76a8);}));})),_0x552b4f[_0x253ffc(0xef)]={},await Promise[_0x253ffc(0xab)](_0x552b4f[_0x253ffc(0xad)](async _0x4e3efa=>{var _0x41b94e=_0x253ffc;_0x552b4f[_0x41b94e(0xef)][_0x4e3efa['invoice']]=[],await Promise[_0x41b94e(0xab)](_0x4e3efa[_0x41b94e(0xfb)][_0x41b94e(0xad)](async _0x22883f=>{var _0x154719=_0x41b94e;const _0x13bc95=await transfers[_0x154719(0xec)]([{'$unwind':_0x154719(0x105)},{'$match':{'product.id_transaction_id':_0x22883f['_id'][_0x154719(0xc0)](),'product.To_invoice':_0x22883f['invoice']}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x154719(0x10a),'quantity_available':_0x154719(0x10e),'warehouse_name':_0x154719(0x102),'warehouse_room':_0x154719(0xb5),'product_invoice':'$product.to_room_name','invoice':_0x154719(0x10f),'id_transaction_from':_0x154719(0x112),'date':_0x154719(0xca),'production_date':_0x154719(0xb4),'expiry_date':_0x154719(0xf2),'UOM':_0x154719(0xe5)}}]);_0x13bc95[_0x154719(0xdf)]>0x0&&_0x552b4f['data_transfer'][_0x4e3efa[_0x154719(0xde)]]['push'](..._0x13bc95);}));})),_0x2c6394[_0x253ffc(0xc1)]({'purchases_warehouse':_0x552b4f,'data_sales':_0x552b4f[_0x253ffc(0xc7)],'data_adjustment':_0x552b4f[_0x253ffc(0xf9)],'data_transfer':_0x552b4f[_0x253ffc(0xef)]});}}else{if(_0x33b682==_0x253ffc(0xab)){var _0x552b4f=await purchases_finished[_0x253ffc(0xec)]([{'$match':{'date':{'$gte':_0x1ca675,'$lte':_0x4ee4cc}}},{'$lookup':{'from':_0x253ffc(0xed),'let':{'invoice':_0x253ffc(0x10f)},'pipeline':[{'$unwind':_0x253ffc(0xdc)},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x253ffc(0xd2),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':'$product_details.product_stock','warehouse_name':_0x253ffc(0xf1),'warehouse_room':_0x253ffc(0xbd),'invoice':_0x253ffc(0xdd),'production_date':_0x253ffc(0xfc),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':_0x253ffc(0xfb)}}]);_0x552b4f[_0x253ffc(0xc7)]={},await Promise['all'](_0x552b4f['map'](async _0x13d2b2=>{var _0x1e49dd=_0x253ffc;_0x552b4f['data_sales'][_0x13d2b2[_0x1e49dd(0xde)]]=[],await Promise[_0x1e49dd(0xab)](_0x13d2b2['warehouse_data']['map'](async _0x18ae40=>{var _0x3b3807=_0x1e49dd;const _0x351fcf=await sales_finished['aggregate']([{'$unwind':_0x3b3807(0xd0)},{'$match':{'sale_product.id_transaction_from':_0x18ae40['_id'][_0x3b3807(0xc0)](),'sale_product.invoice':_0x18ae40[_0x3b3807(0xde)]}},{'$project':{'_id':_0x3b3807(0xee),'product_name':_0x3b3807(0xbf),'product_code':_0x3b3807(0xd7),'quantity_available':_0x3b3807(0xe2),'warehouse_name':_0x3b3807(0xd4),'warehouse_room':_0x3b3807(0x107),'product_invoice':'$sale_product.invoice','invoice':_0x3b3807(0x10f),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x3b3807(0xca),'production_date':_0x3b3807(0xb2),'expiry_date':_0x3b3807(0xcf),'UOM':_0x3b3807(0xbb)}}]);_0x351fcf['length']>0x0&&_0x552b4f['data_sales'][_0x13d2b2[_0x3b3807(0xde)]][_0x3b3807(0xeb)](..._0x351fcf);}));})),_0x552b4f[_0x253ffc(0xc7)]=_0x552b4f[_0x253ffc(0xc7)],_0x552b4f[_0x253ffc(0xf9)]={},await Promise[_0x253ffc(0xab)](_0x552b4f[_0x253ffc(0xad)](async _0x569abc=>{var _0xf19703=_0x253ffc;_0x552b4f[_0xf19703(0xf9)][_0x569abc['invoice']]=[],await Promise[_0xf19703(0xab)](_0x569abc[_0xf19703(0xfb)][_0xf19703(0xad)](async _0x6f30cc=>{var _0x1ab693=_0xf19703;const _0x3ac295=await adjustment_finished[_0x1ab693(0xec)]([{'$unwind':_0x1ab693(0x105)},{'$match':{'product.id_transaction_from':_0x6f30cc[_0x1ab693(0xd9)][_0x1ab693(0xc0)](),'product.invoice':_0x6f30cc[_0x1ab693(0xde)]}},{'$project':{'_id':'$product._id','product_name':_0x1ab693(0xa9),'product_code':_0x1ab693(0x10a),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x1ab693(0xb5),'product_invoice':'$product.invoice','invoice':_0x1ab693(0x10f),'id_transaction_from':_0x1ab693(0xc4),'date':_0x1ab693(0xca),'production_date':_0x1ab693(0xb4),'expiry_date':_0x1ab693(0xf2),'UOM':_0x1ab693(0xe5)}}]);_0x3ac295[_0x1ab693(0xdf)]>0x0&&_0x552b4f[_0x1ab693(0xf9)][_0x569abc[_0x1ab693(0xde)]][_0x1ab693(0xeb)](..._0x3ac295);}));})),_0x552b4f[_0x253ffc(0xef)]={},await Promise[_0x253ffc(0xab)](_0x552b4f[_0x253ffc(0xad)](async _0x15e232=>{var _0x7e9014=_0x253ffc;_0x552b4f[_0x7e9014(0xef)][_0x15e232['invoice']]=[],await Promise[_0x7e9014(0xab)](_0x15e232[_0x7e9014(0xfb)][_0x7e9014(0xad)](async _0x18ff46=>{var _0x329e9c=_0x7e9014;const _0x3d7761=await transfers_finished[_0x329e9c(0xec)]([{'$unwind':_0x329e9c(0x105)},{'$match':{'product.id_transaction':_0x18ff46[_0x329e9c(0xd9)][_0x329e9c(0xc0)](),'product.from_invoice':_0x18ff46[_0x329e9c(0xde)]}},{'$project':{'_id':_0x329e9c(0xda),'product_name':_0x329e9c(0xa9),'product_code':_0x329e9c(0x10a),'quantity_available':'$product.to_quantity','warehouse_name':_0x329e9c(0x102),'warehouse_room':_0x329e9c(0xb5),'product_invoice':_0x329e9c(0xce),'invoice':_0x329e9c(0x10f),'id_transaction_from':_0x329e9c(0xf7),'date':'$date','production_date':_0x329e9c(0xb4),'expiry_date':_0x329e9c(0xf2),'UOM':_0x329e9c(0xe5)}}]);_0x3d7761[_0x329e9c(0xdf)]>0x0&&_0x552b4f['data_transfer'][_0x15e232[_0x329e9c(0xde)]][_0x329e9c(0xeb)](..._0x3d7761);}));})),_0x2c6394[_0x253ffc(0xc1)]({'purchases_warehouse':_0x552b4f,'data_sales':_0x552b4f[_0x253ffc(0xc7)],'data_adjustment':_0x552b4f[_0x253ffc(0xf9)],'data_transfer':_0x552b4f['data_transfer']});}else{var _0x552b4f=await purchases_finished[_0x253ffc(0xec)]([{'$match':{'warehouse_name':_0x33b682,'date':{'$gte':_0x1ca675,'$lte':_0x4ee4cc}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x253ffc(0x10f)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x253ffc(0x10d),'$product_details.invoice']}}},{'$project':{'_id':_0x253ffc(0xd2),'product_name':_0x253ffc(0xb8),'product_code':'$product_details.product_code','quantity_available':_0x253ffc(0xff),'warehouse_name':_0x253ffc(0xf1),'warehouse_room':_0x253ffc(0xbd),'invoice':_0x253ffc(0xdd),'production_date':_0x253ffc(0xfc),'expiry_date':_0x253ffc(0xf5),'UOM':_0x253ffc(0xdb)}}],'as':_0x253ffc(0xfb)}}]);_0x552b4f[_0x253ffc(0xc7)]={},await Promise[_0x253ffc(0xab)](_0x552b4f['map'](async _0x26de44=>{var _0x20ec6f=_0x253ffc;_0x552b4f[_0x20ec6f(0xc7)][_0x26de44[_0x20ec6f(0xde)]]=[],await Promise['all'](_0x26de44['warehouse_data'][_0x20ec6f(0xad)](async _0x19ec8b=>{var _0x505857=_0x20ec6f;const _0x31697c=await sales_finished[_0x505857(0xec)]([{'$unwind':_0x505857(0xd0)},{'$match':{'sale_product.id_transaction_from':_0x19ec8b['_id']['valueOf'](),'sale_product.invoice':_0x19ec8b[_0x505857(0xde)]}},{'$project':{'_id':_0x505857(0xee),'product_name':'$sale_product.product_name','product_code':_0x505857(0xd7),'quantity_available':_0x505857(0xe2),'warehouse_name':_0x505857(0xd4),'warehouse_room':_0x505857(0x107),'product_invoice':_0x505857(0xf3),'invoice':_0x505857(0x10f),'id_transaction_from':_0x505857(0x104),'date':'$date','production_date':_0x505857(0xb2),'expiry_date':_0x505857(0xcf),'UOM':_0x505857(0xbb)}}]);_0x31697c[_0x505857(0xdf)]>0x0&&_0x552b4f[_0x505857(0xc7)][_0x26de44[_0x505857(0xde)]][_0x505857(0xeb)](..._0x31697c);}));})),_0x552b4f[_0x253ffc(0xc7)]=_0x552b4f[_0x253ffc(0xc7)],_0x552b4f[_0x253ffc(0xf9)]={},await Promise[_0x253ffc(0xab)](_0x552b4f[_0x253ffc(0xad)](async _0x112450=>{var _0x11d022=_0x253ffc;_0x552b4f['data_adjustment'][_0x112450[_0x11d022(0xde)]]=[],await Promise[_0x11d022(0xab)](_0x112450[_0x11d022(0xfb)]['map'](async _0x3d7514=>{var _0x408482=_0x11d022;const _0x46970d=await adjustment_finished[_0x408482(0xec)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x3d7514[_0x408482(0xd9)][_0x408482(0xc0)](),'product.invoice':_0x3d7514[_0x408482(0xde)]}},{'$project':{'_id':_0x408482(0xda),'product_name':_0x408482(0xa9),'product_code':_0x408482(0x10a),'quantity_available':_0x408482(0xe1),'warehouse_name':_0x408482(0xd4),'warehouse_room':_0x408482(0xb5),'product_invoice':_0x408482(0xb3),'invoice':'$invoice','id_transaction_from':_0x408482(0xc4),'date':'$date','production_date':'$product.production_date','expiry_date':_0x408482(0xf2),'UOM':_0x408482(0xe5)}}]);_0x46970d[_0x408482(0xdf)]>0x0&&_0x552b4f[_0x408482(0xf9)][_0x112450['invoice']][_0x408482(0xeb)](..._0x46970d);}));})),_0x552b4f[_0x253ffc(0xef)]={},await Promise[_0x253ffc(0xab)](_0x552b4f[_0x253ffc(0xad)](async _0x1b9d0e=>{var _0x391bd2=_0x253ffc;_0x552b4f[_0x391bd2(0xef)][_0x1b9d0e[_0x391bd2(0xde)]]=[],await Promise[_0x391bd2(0xab)](_0x1b9d0e['warehouse_data'][_0x391bd2(0xad)](async _0x422033=>{var _0x23fe90=_0x391bd2;const _0x3e3a9b=await transfers_finished[_0x23fe90(0xec)]([{'$unwind':_0x23fe90(0x105)},{'$match':{'product.id_transaction':_0x422033['_id'][_0x23fe90(0xc0)](),'product.from_invoice':_0x422033['invoice']}},{'$project':{'_id':_0x23fe90(0xda),'product_name':_0x23fe90(0xa9),'product_code':_0x23fe90(0x10a),'quantity_available':'$product.to_quantity','warehouse_name':_0x23fe90(0x102),'warehouse_room':_0x23fe90(0xb5),'product_invoice':'$product.to_room_name','invoice':_0x23fe90(0x10f),'id_transaction_from':_0x23fe90(0xf7),'date':'$date','production_date':'$product.production_date','expiry_date':_0x23fe90(0xf2),'UOM':_0x23fe90(0xe5)}}]);_0x3e3a9b[_0x23fe90(0xdf)]>0x0&&_0x552b4f['data_transfer'][_0x1b9d0e[_0x23fe90(0xde)]][_0x23fe90(0xeb)](..._0x3e3a9b);}));})),_0x2c6394['json']({'purchases_warehouse':_0x552b4f,'data_sales':_0x552b4f['data_sales'],'data_adjustment':_0x552b4f[_0x253ffc(0xf9)],'data_transfer':_0x552b4f[_0x253ffc(0xef)]});}}}),router['get'](a0_0x4d89bb(0xfe),auth,async(_0x207fbe,_0x39d1a5)=>{var _0x8edd8=a0_0x4d89bb;try{const _0x1c8357=_0x207fbe['params']['id'];var _0x552895=await purchases_finished[_0x8edd8(0xd8)](_0x1c8357);const _0x32b90f=await master_shop[_0x8edd8(0x106)](),_0x793f21=_0x207fbe[_0x8edd8(0x10c)],_0x532bde=await profile[_0x8edd8(0xd5)]({'email':_0x793f21[_0x8edd8(0x101)]});if(_0x32b90f[0x0][_0x8edd8(0xe6)]=='English\x20(US)')var _0x1273c3=users[_0x8edd8(0xe7)];else{if(_0x32b90f[0x0][_0x8edd8(0xe6)]==_0x8edd8(0xaf))var _0x1273c3=users[_0x8edd8(0xaf)];else{if(_0x32b90f[0x0][_0x8edd8(0xe6)]==_0x8edd8(0xe8))var _0x1273c3=users[_0x8edd8(0xe8)];else{if(_0x32b90f[0x0][_0x8edd8(0xe6)]=='Spanish')var _0x1273c3=users[_0x8edd8(0xc6)];else{if(_0x32b90f[0x0][_0x8edd8(0xe6)]==_0x8edd8(0xcd))var _0x1273c3=users[_0x8edd8(0xcd)];else{if(_0x32b90f[0x0][_0x8edd8(0xe6)]==_0x8edd8(0xd3))var _0x1273c3=users[_0x8edd8(0xcb)];else{if(_0x32b90f[0x0][_0x8edd8(0xe6)]==_0x8edd8(0x111))var _0x1273c3=users[_0x8edd8(0x111)];else{if(_0x32b90f[0x0][_0x8edd8(0xe6)]=='Arabic\x20(ae)')var _0x1273c3=users[_0x8edd8(0xe3)];}}}}}}}_0x39d1a5[_0x8edd8(0xe4)](_0x8edd8(0xe0),{'success':_0x207fbe['flash']('success'),'errors':_0x207fbe[_0x8edd8(0xcc)](_0x8edd8(0xaa)),'master_shop':_0x32b90f,'profile':_0x532bde,'role':_0x793f21,'language':_0x1273c3,'data':_0x552895});}catch(_0x172a27){_0x39d1a5[_0x8edd8(0xc1)](_0x172a27);}}),router[a0_0x4d89bb(0xc9)](a0_0x4d89bb(0xae),auth,async(_0x3d6729,_0x571f2e)=>{var _0x3949da=a0_0x4d89bb;try{const _0x2c735a=_0x3d6729['params']['id'];var _0x4c7eb2=await sales_finished['findById'](_0x2c735a);const _0x111b86=await master_shop['find'](),_0x500ae6=_0x3d6729['user'],_0x3f39a1=await profile[_0x3949da(0xd5)]({'email':_0x500ae6[_0x3949da(0x101)]});if(_0x111b86[0x0][_0x3949da(0xe6)]==_0x3949da(0xf6))var _0x5a70a1=users[_0x3949da(0xe7)];else{if(_0x111b86[0x0][_0x3949da(0xe6)]=='Hindi')var _0x5a70a1=users[_0x3949da(0xaf)];else{if(_0x111b86[0x0][_0x3949da(0xe6)]==_0x3949da(0xe8))var _0x5a70a1=users['German'];else{if(_0x111b86[0x0][_0x3949da(0xe6)]==_0x3949da(0xc6))var _0x5a70a1=users[_0x3949da(0xc6)];else{if(_0x111b86[0x0][_0x3949da(0xe6)]==_0x3949da(0xcd))var _0x5a70a1=users['French'];else{if(_0x111b86[0x0][_0x3949da(0xe6)]==_0x3949da(0xd3))var _0x5a70a1=users['Portuguese'];else{if(_0x111b86[0x0]['language']==_0x3949da(0x111))var _0x5a70a1=users[_0x3949da(0x111)];else{if(_0x111b86[0x0][_0x3949da(0xe6)]==_0x3949da(0xb6))var _0x5a70a1=users[_0x3949da(0xe3)];}}}}}}}_0x571f2e[_0x3949da(0xe4)](_0x3949da(0xd1),{'success':_0x3d6729[_0x3949da(0xcc)](_0x3949da(0xd6)),'errors':_0x3d6729['flash'](_0x3949da(0xaa)),'master_shop':_0x111b86,'profile':_0x3f39a1,'role':_0x500ae6,'language':_0x5a70a1,'data':_0x4c7eb2});}catch(_0x504eaa){_0x571f2e['json'](_0x504eaa);}}),router[a0_0x4d89bb(0xc9)]('/viewdata_tf_fg/:id',auth,async(_0x51af13,_0x2171be)=>{var _0x4df756=a0_0x4d89bb;try{const _0x3430a5=_0x51af13[_0x4df756(0xb1)]['id'];var _0x132c0b=await transfers_finished[_0x4df756(0xd8)](_0x3430a5);const _0x174b8e=await master_shop[_0x4df756(0x106)](),_0x5d6fc3=_0x51af13[_0x4df756(0x10c)],_0x31f06e=await profile['findOne']({'email':_0x5d6fc3[_0x4df756(0x101)]});if(_0x174b8e[0x0]['language']==_0x4df756(0xf6))var _0x26b8a6=users['English'];else{if(_0x174b8e[0x0][_0x4df756(0xe6)]==_0x4df756(0xaf))var _0x26b8a6=users[_0x4df756(0xaf)];else{if(_0x174b8e[0x0][_0x4df756(0xe6)]==_0x4df756(0xe8))var _0x26b8a6=users[_0x4df756(0xe8)];else{if(_0x174b8e[0x0][_0x4df756(0xe6)]==_0x4df756(0xc6))var _0x26b8a6=users[_0x4df756(0xc6)];else{if(_0x174b8e[0x0][_0x4df756(0xe6)]=='French')var _0x26b8a6=users[_0x4df756(0xcd)];else{if(_0x174b8e[0x0][_0x4df756(0xe6)]==_0x4df756(0xd3))var _0x26b8a6=users[_0x4df756(0xcb)];else{if(_0x174b8e[0x0][_0x4df756(0xe6)]==_0x4df756(0x111))var _0x26b8a6=users[_0x4df756(0x111)];else{if(_0x174b8e[0x0][_0x4df756(0xe6)]==_0x4df756(0xb6))var _0x26b8a6=users['Arabic'];}}}}}}}_0x2171be[_0x4df756(0xe4)](_0x4df756(0xc3),{'success':_0x51af13[_0x4df756(0xcc)](_0x4df756(0xd6)),'errors':_0x51af13[_0x4df756(0xcc)](_0x4df756(0xaa)),'master_shop':_0x174b8e,'profile':_0x31f06e,'role':_0x5d6fc3,'language':_0x26b8a6,'data':_0x132c0b});}catch(_0xb9def){_0x2171be[_0x4df756(0xc1)](_0xb9def);}}),router[a0_0x4d89bb(0xc9)](a0_0x4d89bb(0x103),auth,async(_0x3eb639,_0x3ab4bc)=>{var _0x287170=a0_0x4d89bb;try{const {username:_0x2459f0,email:_0x2b3977,role:_0x58d14b}=_0x3eb639[_0x287170(0x10c)],_0x398f9f=_0x3eb639[_0x287170(0x10c)],_0x50c38a=await profile['findOne']({'email':_0x398f9f[_0x287170(0x101)]}),_0x1fac97=await master_shop['find'](),_0x150e47=await warehouse[_0x287170(0xec)]([{'$match':{'status':_0x287170(0x10b),'warehouse_category':_0x287170(0xf8)}},{'$group':{'_id':_0x287170(0xf1),'name':{'$first':_0x287170(0xf1)}}}]);if(_0x1fac97[0x0][_0x287170(0xe6)]==_0x287170(0xf6))var _0x459271=users[_0x287170(0xe7)];else{if(_0x1fac97[0x0][_0x287170(0xe6)]==_0x287170(0xaf))var _0x459271=users[_0x287170(0xaf)];else{if(_0x1fac97[0x0][_0x287170(0xe6)]=='German')var _0x459271=users['German'];else{if(_0x1fac97[0x0][_0x287170(0xe6)]==_0x287170(0xc6))var _0x459271=users[_0x287170(0xc6)];else{if(_0x1fac97[0x0][_0x287170(0xe6)]==_0x287170(0xcd))var _0x459271=users[_0x287170(0xcd)];else{if(_0x1fac97[0x0][_0x287170(0xe6)]==_0x287170(0xd3))var _0x459271=users['Portuguese'];else{if(_0x1fac97[0x0][_0x287170(0xe6)]==_0x287170(0x111))var _0x459271=users[_0x287170(0x111)];else{if(_0x1fac97[0x0][_0x287170(0xe6)]==_0x287170(0xb6))var _0x459271=users[_0x287170(0xe3)];}}}}}}}_0x3ab4bc[_0x287170(0xe4)](_0x287170(0xb0),{'success':_0x3eb639[_0x287170(0xcc)](_0x287170(0xd6)),'errors':_0x3eb639[_0x287170(0xcc)](_0x287170(0xaa)),'role':_0x398f9f,'profile':_0x50c38a,'master_shop':_0x1fac97,'dataProcess':_0x150e47,'language':_0x459271});}catch(_0x3cf435){console[_0x287170(0xf0)](_0x3cf435);}}),module[a0_0x4d89bb(0xbe)]=router;