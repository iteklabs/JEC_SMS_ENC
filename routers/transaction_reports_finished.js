var a0_0x266b1f=a0_0x17a8;(function(_0xb4ff67,_0x41ffec){var _0x4ef3a6=a0_0x17a8,_0x599ac4=_0xb4ff67();while(!![]){try{var _0x3411cb=parseInt(_0x4ef3a6(0x160))/0x1+parseInt(_0x4ef3a6(0x180))/0x2*(-parseInt(_0x4ef3a6(0x181))/0x3)+parseInt(_0x4ef3a6(0x17d))/0x4*(-parseInt(_0x4ef3a6(0x18d))/0x5)+parseInt(_0x4ef3a6(0x1a6))/0x6+parseInt(_0x4ef3a6(0x172))/0x7*(-parseInt(_0x4ef3a6(0x165))/0x8)+-parseInt(_0x4ef3a6(0x1b9))/0x9*(-parseInt(_0x4ef3a6(0x1af))/0xa)+parseInt(_0x4ef3a6(0x1aa))/0xb;if(_0x3411cb===_0x41ffec)break;else _0x599ac4['push'](_0x599ac4['shift']());}catch(_0x17977c){_0x599ac4['push'](_0x599ac4['shift']());}}}(a0_0x41c5,0xae1f0));const express=require(a0_0x266b1f(0x166)),app=express(),router=express[a0_0x266b1f(0x173)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x266b1f(0x19f)),auth=require('../middleware/auth'),users=require(a0_0x266b1f(0x182)),nodemailer=require(a0_0x266b1f(0x176));function a0_0x17a8(_0x23d024,_0x47c06d){var _0x41c556=a0_0x41c5();return a0_0x17a8=function(_0x17a8bd,_0x2ca4dd){_0x17a8bd=_0x17a8bd-0x14e;var _0x29416e=_0x41c556[_0x17a8bd];return _0x29416e;},a0_0x17a8(_0x23d024,_0x47c06d);}router[a0_0x266b1f(0x190)](a0_0x266b1f(0x169),auth,async(_0x187df3,_0x47c976)=>{var _0x19ee0c=a0_0x266b1f;try{const {username:_0x22efed,email:_0x386c8a,role:_0x143883}=_0x187df3[_0x19ee0c(0x198)],_0xe32246=_0x187df3[_0x19ee0c(0x198)],_0x454df1=await profile['findOne']({'email':_0xe32246['email']}),_0x170cc7=await master_shop['find'](),_0x2d6295=await warehouse[_0x19ee0c(0x1b4)]([{'$match':{'status':_0x19ee0c(0x196),'warehouse_category':_0x19ee0c(0x18b)}},{'$group':{'_id':_0x19ee0c(0x18c),'name':{'$first':'$name'}}}]);if(_0x170cc7[0x0][_0x19ee0c(0x15d)]=='English\x20(US)')var _0x25cdf0=users[_0x19ee0c(0x1ab)];else{if(_0x170cc7[0x0][_0x19ee0c(0x15d)]=='Hindi')var _0x25cdf0=users[_0x19ee0c(0x19c)];else{if(_0x170cc7[0x0][_0x19ee0c(0x15d)]==_0x19ee0c(0x1ac))var _0x25cdf0=users['German'];else{if(_0x170cc7[0x0][_0x19ee0c(0x15d)]==_0x19ee0c(0x16a))var _0x25cdf0=users[_0x19ee0c(0x16a)];else{if(_0x170cc7[0x0][_0x19ee0c(0x15d)]==_0x19ee0c(0x199))var _0x25cdf0=users[_0x19ee0c(0x199)];else{if(_0x170cc7[0x0][_0x19ee0c(0x15d)]==_0x19ee0c(0x19e))var _0x25cdf0=users[_0x19ee0c(0x174)];else{if(_0x170cc7[0x0]['language']==_0x19ee0c(0x175))var _0x25cdf0=users[_0x19ee0c(0x175)];else{if(_0x170cc7[0x0][_0x19ee0c(0x15d)]==_0x19ee0c(0x18e))var _0x25cdf0=users[_0x19ee0c(0x185)];}}}}}}}_0x47c976[_0x19ee0c(0x14e)]('transaction_finished',{'success':_0x187df3[_0x19ee0c(0x17c)](_0x19ee0c(0x170)),'errors':_0x187df3[_0x19ee0c(0x17c)](_0x19ee0c(0x1b1)),'role':_0xe32246,'profile':_0x454df1,'master_shop':_0x170cc7,'dataProcess':_0x2d6295,'language':_0x25cdf0});}catch(_0x1cd75b){console[_0x19ee0c(0x16c)](_0x1cd75b);}}),router[a0_0x266b1f(0x1a3)](a0_0x266b1f(0x188),auth,async(_0x129a77,_0x35db5f)=>{var _0x38bd36=a0_0x266b1f;const {product_category:_0x405805,transaction_category:_0x24d6d4,transaction_date_from:_0xa14a73,transaction_date_to:_0xd43a37,warehouse_category:_0x5eb895,item_code:_0x4ab44f}=_0x129a77[_0x38bd36(0x197)];console[_0x38bd36(0x16c)](_0x5eb895);if(_0x405805=='rm'){if(_0x5eb895==_0x38bd36(0x19d)){var _0x5ed930=await purchases[_0x38bd36(0x1b4)]([{'$match':{'date':{'$gte':_0xa14a73,'$lte':_0xd43a37}}},{'$lookup':{'from':_0x38bd36(0x17b),'let':{'invoice':_0x38bd36(0x19a)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x38bd36(0x19b),_0x38bd36(0x191)]}}},{'$project':{'_id':_0x38bd36(0x1ba),'product_name':_0x38bd36(0x1ad),'product_code':_0x38bd36(0x1a7),'quantity_available':_0x38bd36(0x1a9),'warehouse_name':_0x38bd36(0x18c),'warehouse_room':_0x38bd36(0x18f),'invoice':_0x38bd36(0x191),'production_date':_0x38bd36(0x14f),'expiry_date':_0x38bd36(0x152),'UOM':'$product_details.unit'}}],'as':_0x38bd36(0x186)}}]);_0x5ed930[_0x38bd36(0x15e)]={},await Promise['all'](_0x5ed930['map'](async _0x39b1d3=>{var _0x3ba5eb=_0x38bd36;_0x5ed930[_0x3ba5eb(0x15e)][_0x39b1d3['invoice']]=[],await Promise[_0x3ba5eb(0x19d)](_0x39b1d3[_0x3ba5eb(0x186)]['map'](async _0x17ff4d=>{var _0x50ebb1=_0x3ba5eb;const _0x250508=await sales[_0x50ebb1(0x1b4)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x17ff4d[_0x50ebb1(0x1a0)][_0x50ebb1(0x187)](),'sale_product.invoice':_0x17ff4d[_0x50ebb1(0x1ae)]}},{'$project':{'_id':_0x50ebb1(0x1a8),'product_name':_0x50ebb1(0x1b2),'product_code':_0x50ebb1(0x154),'quantity_available':'$sale_product.quantity','warehouse_name':_0x50ebb1(0x189),'warehouse_room':_0x50ebb1(0x1a2),'product_invoice':_0x50ebb1(0x15b),'invoice':_0x50ebb1(0x19a),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x50ebb1(0x1b5),'production_date':'$sale_product.production_date','expiry_date':_0x50ebb1(0x179),'UOM':_0x50ebb1(0x1b7)}}]);_0x250508['length']>0x0&&_0x5ed930['data_sales'][_0x39b1d3[_0x50ebb1(0x1ae)]]['push'](..._0x250508);}));})),_0x5ed930[_0x38bd36(0x15e)]=_0x5ed930['data_sales'],_0x5ed930[_0x38bd36(0x16d)]={},await Promise[_0x38bd36(0x19d)](_0x5ed930[_0x38bd36(0x167)](async _0x30fee7=>{var _0x534d9e=_0x38bd36;_0x5ed930[_0x534d9e(0x16d)][_0x30fee7['invoice']]=[],await Promise[_0x534d9e(0x19d)](_0x30fee7[_0x534d9e(0x186)]['map'](async _0x1971a9=>{var _0x3afcd7=_0x534d9e;const _0x2178a3=await adjustment['aggregate']([{'$unwind':_0x3afcd7(0x1bc)},{'$match':{'product.id_transaction_from':_0x1971a9[_0x3afcd7(0x1a0)][_0x3afcd7(0x187)](),'product.invoice':_0x1971a9[_0x3afcd7(0x1ae)]}},{'$project':{'_id':'$product._id','product_name':_0x3afcd7(0x16e),'product_code':_0x3afcd7(0x171),'quantity_available':_0x3afcd7(0x17f),'warehouse_name':'$warehouse_name','warehouse_room':_0x3afcd7(0x15f),'product_invoice':_0x3afcd7(0x1bb),'invoice':'$invoice','id_transaction_from':_0x3afcd7(0x194),'date':_0x3afcd7(0x1b5),'production_date':_0x3afcd7(0x1b8),'expiry_date':_0x3afcd7(0x159),'UOM':_0x3afcd7(0x156)}}]);_0x2178a3[_0x3afcd7(0x150)]>0x0&&_0x5ed930[_0x3afcd7(0x16d)][_0x30fee7['invoice']]['push'](..._0x2178a3);}));})),_0x5ed930[_0x38bd36(0x162)]={},await Promise[_0x38bd36(0x19d)](_0x5ed930[_0x38bd36(0x167)](async _0x5115bd=>{var _0x497ba8=_0x38bd36;_0x5ed930['data_transfer'][_0x5115bd[_0x497ba8(0x1ae)]]=[],await Promise[_0x497ba8(0x19d)](_0x5115bd[_0x497ba8(0x186)][_0x497ba8(0x167)](async _0x20c7c1=>{var _0x9f38bf=_0x497ba8;const _0x3cfb4d=await transfers[_0x9f38bf(0x1b4)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x20c7c1[_0x9f38bf(0x1a0)][_0x9f38bf(0x187)](),'product.To_invoice':_0x20c7c1['invoice']}},{'$project':{'_id':_0x9f38bf(0x192),'product_name':'$product.product_name','product_code':_0x9f38bf(0x171),'quantity_available':_0x9f38bf(0x1a1),'warehouse_name':_0x9f38bf(0x158),'warehouse_room':_0x9f38bf(0x15f),'product_invoice':_0x9f38bf(0x195),'invoice':_0x9f38bf(0x19a),'id_transaction_from':_0x9f38bf(0x153),'date':'$date','production_date':_0x9f38bf(0x1b8),'expiry_date':_0x9f38bf(0x159),'UOM':_0x9f38bf(0x156)}}]);_0x3cfb4d['length']>0x0&&_0x5ed930[_0x9f38bf(0x162)][_0x5115bd[_0x9f38bf(0x1ae)]][_0x9f38bf(0x177)](..._0x3cfb4d);}));})),_0x35db5f[_0x38bd36(0x183)]({'purchases_warehouse':_0x5ed930,'data_sales':_0x5ed930['data_sales'],'data_adjustment':_0x5ed930['data_adjustment'],'data_transfer':_0x5ed930[_0x38bd36(0x162)]});}else{var _0x5ed930=await purchases[_0x38bd36(0x1b4)]([{'$match':{'warehouse_name':_0x5eb895,'date':{'$gte':_0xa14a73,'$lte':_0xd43a37}}},{'$lookup':{'from':_0x38bd36(0x17b),'let':{'invoice':_0x38bd36(0x19a)},'pipeline':[{'$unwind':_0x38bd36(0x184)},{'$match':{'$expr':{'$eq':['$$invoice',_0x38bd36(0x191)]}}},{'$project':{'_id':_0x38bd36(0x1ba),'product_name':_0x38bd36(0x1ad),'product_code':_0x38bd36(0x1a7),'quantity_available':_0x38bd36(0x1a9),'warehouse_name':'$name','warehouse_room':_0x38bd36(0x18f),'invoice':_0x38bd36(0x191),'production_date':_0x38bd36(0x14f),'expiry_date':_0x38bd36(0x152),'UOM':'$product_details.unit'}}],'as':_0x38bd36(0x186)}}]);_0x5ed930[_0x38bd36(0x15e)]={},await Promise[_0x38bd36(0x19d)](_0x5ed930[_0x38bd36(0x167)](async _0x1d953b=>{var _0x20e1d4=_0x38bd36;_0x5ed930[_0x20e1d4(0x15e)][_0x1d953b['invoice']]=[],await Promise[_0x20e1d4(0x19d)](_0x1d953b['warehouse_data']['map'](async _0x524d29=>{var _0x331286=_0x20e1d4;const _0x262a14=await sales[_0x331286(0x1b4)]([{'$unwind':_0x331286(0x151)},{'$match':{'sale_product.id_transaction_from':_0x524d29[_0x331286(0x1a0)][_0x331286(0x187)](),'sale_product.invoice':_0x524d29['invoice']}},{'$project':{'_id':_0x331286(0x1a8),'product_name':'$sale_product.product_name','product_code':_0x331286(0x154),'quantity_available':'$sale_product.quantity','warehouse_name':_0x331286(0x189),'warehouse_room':_0x331286(0x1a2),'product_invoice':_0x331286(0x15b),'invoice':_0x331286(0x19a),'id_transaction_from':_0x331286(0x1a5),'date':_0x331286(0x1b5),'production_date':_0x331286(0x17e),'expiry_date':_0x331286(0x179),'UOM':'$sale_product.unit'}}]);_0x262a14[_0x331286(0x150)]>0x0&&_0x5ed930[_0x331286(0x15e)][_0x1d953b[_0x331286(0x1ae)]]['push'](..._0x262a14);}));})),_0x5ed930[_0x38bd36(0x15e)]=_0x5ed930['data_sales'],_0x5ed930[_0x38bd36(0x16d)]={},await Promise[_0x38bd36(0x19d)](_0x5ed930[_0x38bd36(0x167)](async _0x1ec612=>{var _0x4b84d3=_0x38bd36;_0x5ed930[_0x4b84d3(0x16d)][_0x1ec612[_0x4b84d3(0x1ae)]]=[],await Promise[_0x4b84d3(0x19d)](_0x1ec612['warehouse_data'][_0x4b84d3(0x167)](async _0xdaf7c2=>{var _0x53e58f=_0x4b84d3;const _0x4e9048=await adjustment[_0x53e58f(0x1b4)]([{'$unwind':_0x53e58f(0x1bc)},{'$match':{'product.id_transaction_from':_0xdaf7c2[_0x53e58f(0x1a0)][_0x53e58f(0x187)](),'product.invoice':_0xdaf7c2[_0x53e58f(0x1ae)]}},{'$project':{'_id':_0x53e58f(0x192),'product_name':_0x53e58f(0x16e),'product_code':_0x53e58f(0x171),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x53e58f(0x15f),'product_invoice':_0x53e58f(0x1bb),'invoice':_0x53e58f(0x19a),'id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':_0x53e58f(0x1b8),'expiry_date':_0x53e58f(0x159),'UOM':_0x53e58f(0x156)}}]);_0x4e9048[_0x53e58f(0x150)]>0x0&&_0x5ed930[_0x53e58f(0x16d)][_0x1ec612[_0x53e58f(0x1ae)]]['push'](..._0x4e9048);}));})),_0x5ed930['data_transfer']={},await Promise[_0x38bd36(0x19d)](_0x5ed930[_0x38bd36(0x167)](async _0x24b281=>{var _0x3046a2=_0x38bd36;_0x5ed930[_0x3046a2(0x162)][_0x24b281[_0x3046a2(0x1ae)]]=[],await Promise['all'](_0x24b281[_0x3046a2(0x186)][_0x3046a2(0x167)](async _0x490f3f=>{var _0x23ca87=_0x3046a2;const _0x44a526=await transfers[_0x23ca87(0x1b4)]([{'$unwind':_0x23ca87(0x1bc)},{'$match':{'product.id_transaction_id':_0x490f3f[_0x23ca87(0x1a0)][_0x23ca87(0x187)](),'product.To_invoice':_0x490f3f[_0x23ca87(0x1ae)]}},{'$project':{'_id':_0x23ca87(0x192),'product_name':_0x23ca87(0x16e),'product_code':_0x23ca87(0x171),'quantity_available':'$product.to_quantity','warehouse_name':_0x23ca87(0x158),'warehouse_room':_0x23ca87(0x15f),'product_invoice':'$product.to_room_name','invoice':_0x23ca87(0x19a),'id_transaction_from':'$product.id_transaction_id','date':_0x23ca87(0x1b5),'production_date':_0x23ca87(0x1b8),'expiry_date':_0x23ca87(0x159),'UOM':'$product.unit'}}]);_0x44a526[_0x23ca87(0x150)]>0x0&&_0x5ed930[_0x23ca87(0x162)][_0x24b281[_0x23ca87(0x1ae)]][_0x23ca87(0x177)](..._0x44a526);}));})),_0x35db5f[_0x38bd36(0x183)]({'purchases_warehouse':_0x5ed930,'data_sales':_0x5ed930[_0x38bd36(0x15e)],'data_adjustment':_0x5ed930[_0x38bd36(0x16d)],'data_transfer':_0x5ed930[_0x38bd36(0x162)]});}}else{if(_0x5eb895==_0x38bd36(0x19d)){var _0x5ed930=await purchases_finished[_0x38bd36(0x1b4)]([{'$match':{'date':{'$gte':_0xa14a73,'$lte':_0xd43a37}}},{'$lookup':{'from':_0x38bd36(0x17b),'let':{'invoice':_0x38bd36(0x19a)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x38bd36(0x19b),_0x38bd36(0x191)]}}},{'$project':{'_id':_0x38bd36(0x1ba),'product_name':_0x38bd36(0x1ad),'product_code':'$product_details.product_code','quantity_available':_0x38bd36(0x1a9),'warehouse_name':_0x38bd36(0x18c),'warehouse_room':_0x38bd36(0x18f),'invoice':_0x38bd36(0x191),'production_date':_0x38bd36(0x14f),'expiry_date':_0x38bd36(0x152),'UOM':_0x38bd36(0x1b0)}}],'as':'warehouse_data'}}]);_0x5ed930['data_sales']={},await Promise[_0x38bd36(0x19d)](_0x5ed930['map'](async _0x3aea53=>{var _0x570273=_0x38bd36;_0x5ed930[_0x570273(0x15e)][_0x3aea53['invoice']]=[],await Promise[_0x570273(0x19d)](_0x3aea53[_0x570273(0x186)][_0x570273(0x167)](async _0x31b281=>{var _0x1f9fae=_0x570273;const _0x31532b=await sales_finished[_0x1f9fae(0x1b4)]([{'$unwind':_0x1f9fae(0x151)},{'$match':{'sale_product.id_transaction_from':_0x31b281[_0x1f9fae(0x1a0)][_0x1f9fae(0x187)](),'sale_product.invoice':_0x31b281['invoice']}},{'$project':{'_id':'$sale_product._id','product_name':_0x1f9fae(0x1b2),'product_code':_0x1f9fae(0x154),'quantity_available':_0x1f9fae(0x18a),'warehouse_name':'$warehouse_name','warehouse_room':'$sale_product.room_name','product_invoice':_0x1f9fae(0x15b),'invoice':_0x1f9fae(0x19a),'id_transaction_from':_0x1f9fae(0x1a5),'date':_0x1f9fae(0x1b5),'production_date':_0x1f9fae(0x17e),'expiry_date':_0x1f9fae(0x179),'UOM':_0x1f9fae(0x1b7)}}]);_0x31532b['length']>0x0&&_0x5ed930[_0x1f9fae(0x15e)][_0x3aea53[_0x1f9fae(0x1ae)]][_0x1f9fae(0x177)](..._0x31532b);}));})),_0x5ed930[_0x38bd36(0x15e)]=_0x5ed930[_0x38bd36(0x15e)],_0x5ed930['data_adjustment']={},await Promise[_0x38bd36(0x19d)](_0x5ed930['map'](async _0x2fb1c7=>{var _0x38f7ce=_0x38bd36;_0x5ed930[_0x38f7ce(0x16d)][_0x2fb1c7[_0x38f7ce(0x1ae)]]=[],await Promise[_0x38f7ce(0x19d)](_0x2fb1c7['warehouse_data'][_0x38f7ce(0x167)](async _0xf9581d=>{var _0x3a9a4b=_0x38f7ce;const _0x31ec5f=await adjustment_finished[_0x3a9a4b(0x1b4)]([{'$unwind':_0x3a9a4b(0x1bc)},{'$match':{'product.id_transaction_from':_0xf9581d[_0x3a9a4b(0x1a0)][_0x3a9a4b(0x187)](),'product.invoice':_0xf9581d[_0x3a9a4b(0x1ae)]}},{'$project':{'_id':_0x3a9a4b(0x192),'product_name':_0x3a9a4b(0x16e),'product_code':'$product.product_code','quantity_available':_0x3a9a4b(0x17f),'warehouse_name':_0x3a9a4b(0x189),'warehouse_room':_0x3a9a4b(0x15f),'product_invoice':_0x3a9a4b(0x1bb),'invoice':_0x3a9a4b(0x19a),'id_transaction_from':'$product.id_transaction_from','date':_0x3a9a4b(0x1b5),'production_date':_0x3a9a4b(0x1b8),'expiry_date':_0x3a9a4b(0x159),'UOM':_0x3a9a4b(0x156)}}]);_0x31ec5f[_0x3a9a4b(0x150)]>0x0&&_0x5ed930['data_adjustment'][_0x2fb1c7['invoice']][_0x3a9a4b(0x177)](..._0x31ec5f);}));})),_0x5ed930['data_transfer']={},await Promise[_0x38bd36(0x19d)](_0x5ed930[_0x38bd36(0x167)](async _0x178ce0=>{var _0x2935e9=_0x38bd36;_0x5ed930[_0x2935e9(0x162)][_0x178ce0[_0x2935e9(0x1ae)]]=[],await Promise[_0x2935e9(0x19d)](_0x178ce0[_0x2935e9(0x186)][_0x2935e9(0x167)](async _0x39b7a7=>{var _0x1f72d6=_0x2935e9;const _0x21948b=await transfers_finished[_0x1f72d6(0x1b4)]([{'$unwind':_0x1f72d6(0x1bc)},{'$match':{'product.id_transaction':_0x39b7a7[_0x1f72d6(0x1a0)]['valueOf'](),'product.from_invoice':_0x39b7a7['invoice']}},{'$project':{'_id':_0x1f72d6(0x192),'product_name':'$product.product_name','product_code':_0x1f72d6(0x171),'quantity_available':'$product.to_quantity','warehouse_name':_0x1f72d6(0x158),'warehouse_room':_0x1f72d6(0x15f),'product_invoice':_0x1f72d6(0x195),'invoice':_0x1f72d6(0x19a),'id_transaction_from':'$product.id_transaction','date':_0x1f72d6(0x1b5),'production_date':_0x1f72d6(0x1b8),'expiry_date':_0x1f72d6(0x159),'UOM':_0x1f72d6(0x156)}}]);_0x21948b[_0x1f72d6(0x150)]>0x0&&_0x5ed930[_0x1f72d6(0x162)][_0x178ce0[_0x1f72d6(0x1ae)]]['push'](..._0x21948b);}));})),_0x35db5f['json']({'purchases_warehouse':_0x5ed930,'data_sales':_0x5ed930[_0x38bd36(0x15e)],'data_adjustment':_0x5ed930[_0x38bd36(0x16d)],'data_transfer':_0x5ed930[_0x38bd36(0x162)]});}else{var _0x5ed930=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x5eb895,'date':{'$gte':_0xa14a73,'$lte':_0xd43a37}}},{'$lookup':{'from':_0x38bd36(0x17b),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x38bd36(0x184)},{'$match':{'$expr':{'$eq':[_0x38bd36(0x19b),_0x38bd36(0x191)]}}},{'$project':{'_id':_0x38bd36(0x1ba),'product_name':_0x38bd36(0x1ad),'product_code':_0x38bd36(0x1a7),'quantity_available':_0x38bd36(0x1a9),'warehouse_name':'$name','warehouse_room':'$room','invoice':_0x38bd36(0x191),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x38bd36(0x1b0)}}],'as':_0x38bd36(0x186)}}]);_0x5ed930[_0x38bd36(0x15e)]={},await Promise[_0x38bd36(0x19d)](_0x5ed930[_0x38bd36(0x167)](async _0x42164b=>{var _0x2c8b6e=_0x38bd36;_0x5ed930[_0x2c8b6e(0x15e)][_0x42164b[_0x2c8b6e(0x1ae)]]=[],await Promise[_0x2c8b6e(0x19d)](_0x42164b[_0x2c8b6e(0x186)][_0x2c8b6e(0x167)](async _0x41527b=>{var _0x3515e5=_0x2c8b6e;const _0x28ee20=await sales_finished[_0x3515e5(0x1b4)]([{'$unwind':_0x3515e5(0x151)},{'$match':{'sale_product.id_transaction_from':_0x41527b[_0x3515e5(0x1a0)]['valueOf'](),'sale_product.invoice':_0x41527b[_0x3515e5(0x1ae)]}},{'$project':{'_id':_0x3515e5(0x1a8),'product_name':_0x3515e5(0x1b2),'product_code':_0x3515e5(0x154),'quantity_available':'$sale_product.quantity','warehouse_name':_0x3515e5(0x189),'warehouse_room':_0x3515e5(0x1a2),'product_invoice':_0x3515e5(0x15b),'invoice':_0x3515e5(0x19a),'id_transaction_from':_0x3515e5(0x1a5),'date':_0x3515e5(0x1b5),'production_date':_0x3515e5(0x17e),'expiry_date':'$sale_product.expiry_date','UOM':_0x3515e5(0x1b7)}}]);_0x28ee20[_0x3515e5(0x150)]>0x0&&_0x5ed930[_0x3515e5(0x15e)][_0x42164b[_0x3515e5(0x1ae)]][_0x3515e5(0x177)](..._0x28ee20);}));})),_0x5ed930[_0x38bd36(0x15e)]=_0x5ed930[_0x38bd36(0x15e)],_0x5ed930[_0x38bd36(0x16d)]={},await Promise[_0x38bd36(0x19d)](_0x5ed930['map'](async _0x3ab0de=>{var _0x2ad638=_0x38bd36;_0x5ed930[_0x2ad638(0x16d)][_0x3ab0de[_0x2ad638(0x1ae)]]=[],await Promise[_0x2ad638(0x19d)](_0x3ab0de[_0x2ad638(0x186)][_0x2ad638(0x167)](async _0x1461e8=>{var _0x42a955=_0x2ad638;const _0x1a4d90=await adjustment_finished[_0x42a955(0x1b4)]([{'$unwind':_0x42a955(0x1bc)},{'$match':{'product.id_transaction_from':_0x1461e8[_0x42a955(0x1a0)][_0x42a955(0x187)](),'product.invoice':_0x1461e8[_0x42a955(0x1ae)]}},{'$project':{'_id':_0x42a955(0x192),'product_name':'$product.product_name','product_code':_0x42a955(0x171),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x42a955(0x189),'warehouse_room':_0x42a955(0x15f),'product_invoice':_0x42a955(0x1bb),'invoice':_0x42a955(0x19a),'id_transaction_from':_0x42a955(0x194),'date':'$date','production_date':_0x42a955(0x1b8),'expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x1a4d90[_0x42a955(0x150)]>0x0&&_0x5ed930[_0x42a955(0x16d)][_0x3ab0de[_0x42a955(0x1ae)]]['push'](..._0x1a4d90);}));})),_0x5ed930[_0x38bd36(0x162)]={},await Promise[_0x38bd36(0x19d)](_0x5ed930[_0x38bd36(0x167)](async _0x5a0b28=>{var _0x33b194=_0x38bd36;_0x5ed930[_0x33b194(0x162)][_0x5a0b28['invoice']]=[],await Promise[_0x33b194(0x19d)](_0x5a0b28[_0x33b194(0x186)][_0x33b194(0x167)](async _0xd53742=>{var _0x1be0da=_0x33b194;const _0x56523d=await transfers_finished['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0xd53742['_id']['valueOf'](),'product.from_invoice':_0xd53742['invoice']}},{'$project':{'_id':_0x1be0da(0x192),'product_name':_0x1be0da(0x16e),'product_code':'$product.product_code','quantity_available':_0x1be0da(0x1a1),'warehouse_name':_0x1be0da(0x158),'warehouse_room':'$product.room_names','product_invoice':_0x1be0da(0x195),'invoice':_0x1be0da(0x19a),'id_transaction_from':_0x1be0da(0x1a4),'date':'$date','production_date':_0x1be0da(0x1b8),'expiry_date':_0x1be0da(0x159),'UOM':_0x1be0da(0x156)}}]);_0x56523d[_0x1be0da(0x150)]>0x0&&_0x5ed930[_0x1be0da(0x162)][_0x5a0b28[_0x1be0da(0x1ae)]][_0x1be0da(0x177)](..._0x56523d);}));})),_0x35db5f[_0x38bd36(0x183)]({'purchases_warehouse':_0x5ed930,'data_sales':_0x5ed930[_0x38bd36(0x15e)],'data_adjustment':_0x5ed930[_0x38bd36(0x16d)],'data_transfer':_0x5ed930[_0x38bd36(0x162)]});}}}),router[a0_0x266b1f(0x190)](a0_0x266b1f(0x1b3),auth,async(_0x707858,_0x2b6f60)=>{var _0x5e6d75=a0_0x266b1f;try{const _0x20caef=_0x707858[_0x5e6d75(0x178)]['id'];var _0x3afae5=await purchases_finished['findById'](_0x20caef);const _0x41db85=await master_shop[_0x5e6d75(0x15c)](),_0xf3fc8d=_0x707858[_0x5e6d75(0x198)],_0x9030bd=await profile['findOne']({'email':_0xf3fc8d[_0x5e6d75(0x168)]});if(_0x41db85[0x0][_0x5e6d75(0x15d)]==_0x5e6d75(0x193))var _0x17b2e2=users['English'];else{if(_0x41db85[0x0][_0x5e6d75(0x15d)]==_0x5e6d75(0x19c))var _0x17b2e2=users[_0x5e6d75(0x19c)];else{if(_0x41db85[0x0]['language']==_0x5e6d75(0x1ac))var _0x17b2e2=users[_0x5e6d75(0x1ac)];else{if(_0x41db85[0x0][_0x5e6d75(0x15d)]=='Spanish')var _0x17b2e2=users['Spanish'];else{if(_0x41db85[0x0][_0x5e6d75(0x15d)]==_0x5e6d75(0x199))var _0x17b2e2=users[_0x5e6d75(0x199)];else{if(_0x41db85[0x0][_0x5e6d75(0x15d)]==_0x5e6d75(0x19e))var _0x17b2e2=users[_0x5e6d75(0x174)];else{if(_0x41db85[0x0][_0x5e6d75(0x15d)]=='Chinese')var _0x17b2e2=users[_0x5e6d75(0x175)];else{if(_0x41db85[0x0][_0x5e6d75(0x15d)]==_0x5e6d75(0x18e))var _0x17b2e2=users['Arabic'];}}}}}}}_0x2b6f60[_0x5e6d75(0x14e)](_0x5e6d75(0x15a),{'success':_0x707858[_0x5e6d75(0x17c)](_0x5e6d75(0x170)),'errors':_0x707858['flash']('errors'),'master_shop':_0x41db85,'profile':_0x9030bd,'role':_0xf3fc8d,'language':_0x17b2e2,'data':_0x3afae5});}catch(_0x269466){_0x2b6f60[_0x5e6d75(0x183)](_0x269466);}}),router[a0_0x266b1f(0x190)](a0_0x266b1f(0x1b6),auth,async(_0x3c304d,_0x1ef82d)=>{var _0xe1a06d=a0_0x266b1f;try{const _0x3042a6=_0x3c304d[_0xe1a06d(0x178)]['id'];var _0xc54011=await sales_finished[_0xe1a06d(0x16f)](_0x3042a6);const _0x25349f=await master_shop[_0xe1a06d(0x15c)](),_0x564105=_0x3c304d[_0xe1a06d(0x198)],_0x502a9b=await profile[_0xe1a06d(0x157)]({'email':_0x564105['email']});if(_0x25349f[0x0][_0xe1a06d(0x15d)]==_0xe1a06d(0x193))var _0x4d9a3b=users['English'];else{if(_0x25349f[0x0][_0xe1a06d(0x15d)]=='Hindi')var _0x4d9a3b=users['Hindi'];else{if(_0x25349f[0x0][_0xe1a06d(0x15d)]=='German')var _0x4d9a3b=users['German'];else{if(_0x25349f[0x0]['language']==_0xe1a06d(0x16a))var _0x4d9a3b=users[_0xe1a06d(0x16a)];else{if(_0x25349f[0x0]['language']==_0xe1a06d(0x199))var _0x4d9a3b=users[_0xe1a06d(0x199)];else{if(_0x25349f[0x0][_0xe1a06d(0x15d)]==_0xe1a06d(0x19e))var _0x4d9a3b=users[_0xe1a06d(0x174)];else{if(_0x25349f[0x0][_0xe1a06d(0x15d)]==_0xe1a06d(0x175))var _0x4d9a3b=users['Chinese'];else{if(_0x25349f[0x0][_0xe1a06d(0x15d)]=='Arabic\x20(ae)')var _0x4d9a3b=users[_0xe1a06d(0x185)];}}}}}}}_0x1ef82d[_0xe1a06d(0x14e)](_0xe1a06d(0x155),{'success':_0x3c304d[_0xe1a06d(0x17c)]('success'),'errors':_0x3c304d[_0xe1a06d(0x17c)](_0xe1a06d(0x1b1)),'master_shop':_0x25349f,'profile':_0x502a9b,'role':_0x564105,'language':_0x4d9a3b,'data':_0xc54011});}catch(_0x53e380){_0x1ef82d['json'](_0x53e380);}}),router[a0_0x266b1f(0x190)]('/viewdata_tf_fg/:id',auth,async(_0x1a74b4,_0x2c8ef5)=>{var _0xd2cc49=a0_0x266b1f;try{const _0x2f0b8b=_0x1a74b4[_0xd2cc49(0x178)]['id'];var _0x1b6643=await transfers_finished[_0xd2cc49(0x16f)](_0x2f0b8b);const _0x5d28d2=await master_shop[_0xd2cc49(0x15c)](),_0x26bc17=_0x1a74b4[_0xd2cc49(0x198)],_0x24a4d6=await profile['findOne']({'email':_0x26bc17['email']});if(_0x5d28d2[0x0]['language']=='English\x20(US)')var _0x138b04=users[_0xd2cc49(0x1ab)];else{if(_0x5d28d2[0x0][_0xd2cc49(0x15d)]=='Hindi')var _0x138b04=users[_0xd2cc49(0x19c)];else{if(_0x5d28d2[0x0]['language']==_0xd2cc49(0x1ac))var _0x138b04=users[_0xd2cc49(0x1ac)];else{if(_0x5d28d2[0x0][_0xd2cc49(0x15d)]==_0xd2cc49(0x16a))var _0x138b04=users[_0xd2cc49(0x16a)];else{if(_0x5d28d2[0x0]['language']==_0xd2cc49(0x199))var _0x138b04=users['French'];else{if(_0x5d28d2[0x0][_0xd2cc49(0x15d)]==_0xd2cc49(0x19e))var _0x138b04=users['Portuguese'];else{if(_0x5d28d2[0x0]['language']==_0xd2cc49(0x175))var _0x138b04=users[_0xd2cc49(0x175)];else{if(_0x5d28d2[0x0][_0xd2cc49(0x15d)]==_0xd2cc49(0x18e))var _0x138b04=users[_0xd2cc49(0x185)];}}}}}}}_0x2c8ef5[_0xd2cc49(0x14e)](_0xd2cc49(0x16b),{'success':_0x1a74b4[_0xd2cc49(0x17c)](_0xd2cc49(0x170)),'errors':_0x1a74b4[_0xd2cc49(0x17c)](_0xd2cc49(0x1b1)),'master_shop':_0x5d28d2,'profile':_0x24a4d6,'role':_0x26bc17,'language':_0x138b04,'data':_0x1b6643});}catch(_0x508515){_0x2c8ef5['json'](_0x508515);}}),router[a0_0x266b1f(0x190)](a0_0x266b1f(0x164),auth,async(_0x46ddee,_0x5f47d0)=>{var _0x21769c=a0_0x266b1f;try{const {username:_0x4c951c,email:_0x414cde,role:_0x257eb6}=_0x46ddee[_0x21769c(0x198)],_0x2edeff=_0x46ddee[_0x21769c(0x198)],_0x4de9ed=await profile[_0x21769c(0x157)]({'email':_0x2edeff[_0x21769c(0x168)]}),_0x1f6144=await master_shop[_0x21769c(0x15c)](),_0x59610e=await warehouse[_0x21769c(0x1b4)]([{'$match':{'status':_0x21769c(0x196),'warehouse_category':_0x21769c(0x163)}},{'$group':{'_id':_0x21769c(0x18c),'name':{'$first':'$name'}}}]);if(_0x1f6144[0x0][_0x21769c(0x15d)]=='English\x20(US)')var _0x1f5d98=users[_0x21769c(0x1ab)];else{if(_0x1f6144[0x0][_0x21769c(0x15d)]==_0x21769c(0x19c))var _0x1f5d98=users[_0x21769c(0x19c)];else{if(_0x1f6144[0x0][_0x21769c(0x15d)]==_0x21769c(0x1ac))var _0x1f5d98=users[_0x21769c(0x1ac)];else{if(_0x1f6144[0x0][_0x21769c(0x15d)]==_0x21769c(0x16a))var _0x1f5d98=users['Spanish'];else{if(_0x1f6144[0x0][_0x21769c(0x15d)]==_0x21769c(0x199))var _0x1f5d98=users[_0x21769c(0x199)];else{if(_0x1f6144[0x0]['language']==_0x21769c(0x19e))var _0x1f5d98=users['Portuguese'];else{if(_0x1f6144[0x0][_0x21769c(0x15d)]==_0x21769c(0x175))var _0x1f5d98=users[_0x21769c(0x175)];else{if(_0x1f6144[0x0][_0x21769c(0x15d)]==_0x21769c(0x18e))var _0x1f5d98=users[_0x21769c(0x185)];}}}}}}}_0x5f47d0['render'](_0x21769c(0x17a),{'success':_0x46ddee[_0x21769c(0x17c)]('success'),'errors':_0x46ddee[_0x21769c(0x17c)](_0x21769c(0x1b1)),'role':_0x2edeff,'profile':_0x4de9ed,'master_shop':_0x1f6144,'dataProcess':_0x59610e,'language':_0x1f5d98});}catch(_0x2aeede){console[_0x21769c(0x16c)](_0x2aeede);}}),module[a0_0x266b1f(0x161)]=router;function a0_0x41c5(){var _0x37b1a=['language','data_sales','$product.room_names','776871DKwtlF','exports','data_transfer','Raw\x20Materials','/viewFG','24JCVBmB','express','map','email','/view','Spanish','view_tf_table','log','data_adjustment','$product.product_name','findById','success','$product.product_code','3202822VEzmXb','Router','Portuguese','Chinese','nodemailer','push','params','$sale_product.expiry_date','transaction_finished_raw','warehouses','flash','584NBsHzG','$sale_product.production_date','$product.new_adjust_qty','38XDKUfL','225084qtTJUK','../public/language/languages.json','json','$product_details','Arabic','warehouse_data','valueOf','/reports','$warehouse_name','$sale_product.quantity','Finished\x20Goods','$name','9655UBxKhs','Arabic\x20(ae)','$room','get','$product_details.invoice','$product._id','English\x20(US)','$product.id_transaction_from','$product.to_room_name','Enabled','body','user','French','$invoice','$$invoice','Hindi','all','Portuguese\x20(BR)','../models/all_models','_id','$product.to_quantity','$sale_product.room_name','post','$product.id_transaction','$sale_product.id_transaction_from','8166522ZOSoGI','$product_details.product_code','$sale_product._id','$product_details.product_stock','2879987qqxpUP','English','German','$product_details.product_name','invoice','10MpvJWW','$product_details.unit','errors','$sale_product.product_name','/viewdata_inc_fg/:id','aggregate','$date','/viewdata_og_fg/:id','$sale_product.unit','$product.production_date','12541689pQJjhB','$product_details._id','$product.invoice','$product','render','$product_details.production_date','length','$sale_product','$product_details.expiry_date','$product.id_transaction_id','$sale_product.product_code','view_og_table','$product.unit','findOne','$to_warehouse','$product.expiry_date','view_table','$sale_product.invoice','find'];a0_0x41c5=function(){return _0x37b1a;};return a0_0x41c5();}