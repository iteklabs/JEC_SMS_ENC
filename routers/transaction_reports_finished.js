var a0_0x4470ee=a0_0x280c;(function(_0x13665b,_0x513c23){var _0x3fda9f=a0_0x280c,_0x597a5d=_0x13665b();while(!![]){try{var _0x1cda6b=-parseInt(_0x3fda9f(0xd4))/0x1*(parseInt(_0x3fda9f(0xfc))/0x2)+parseInt(_0x3fda9f(0xd0))/0x3*(-parseInt(_0x3fda9f(0xc7))/0x4)+-parseInt(_0x3fda9f(0xeb))/0x5*(-parseInt(_0x3fda9f(0xae))/0x6)+parseInt(_0x3fda9f(0xc5))/0x7+parseInt(_0x3fda9f(0xe1))/0x8+-parseInt(_0x3fda9f(0xef))/0x9+-parseInt(_0x3fda9f(0xda))/0xa*(-parseInt(_0x3fda9f(0xf0))/0xb);if(_0x1cda6b===_0x513c23)break;else _0x597a5d['push'](_0x597a5d['shift']());}catch(_0xdcf579){_0x597a5d['push'](_0x597a5d['shift']());}}}(a0_0x5763,0xa3617));function a0_0x5763(){var _0x14dbfe=['findById','$product.unit','length','15863ohotCW','$room','$product_details.expiry_date','warehouse_data','/viewdata_inc_fg/:id','findOne','39420NQaEQG','$invoice','$product_details._id','_id','view_og_table','errors','$product.to_quantity','3264976QFZazh','log','/viewdata_tf_fg/:id','exports','$product_details.invoice','$sale_product.product_code','invoice','$sale_product.invoice','$product_details.product_code','$to_warehouse','1405IMjBPr','language','$product.product_code','$product.invoice','8611749ZtbFKt','1254TGMTDI','warehouses','Enabled','$product.product_name','German','email','Hindi','$sale_product','../public/language/languages.json','all','Arabic','$sale_product.id_transaction_from','30FLNWQS','nodemailer','data_adjustment','$date','success','$sale_product._id','/viewdata_og_fg/:id','$sale_product.product_name','$sale_product.room_name','$product.expiry_date','$product.id_transaction_id','$product.room_names','get','user','transaction_finished','map','view_table','transaction_finished_raw','$product.id_transaction_from','find','$product.production_date','French','$sale_product.quantity','express','$product.id_transaction','$product.new_adjust_qty','$product.to_room_name','Portuguese\x20(BR)','$sale_product.expiry_date','$product_details.unit','../middleware/auth','data_sales','21696dQXpWc','render','json','aggregate','English\x20(US)','Raw\x20Materials','$product_details.product_name','$product_details','Finished\x20Goods','$warehouse_name','data_transfer','/view','params','$product._id','Chinese','flash','Portuguese','$product','$product_details.product_stock','post','Arabic\x20(ae)','push','valueOf','8126552Zloieb','$$invoice','2476HyuwvQ','$sale_product.production_date','English','Spanish','$sale_product.unit','/reports','$product_details.production_date','$name','view_tf_table','5673TSDcsx'];a0_0x5763=function(){return _0x14dbfe;};return a0_0x5763();}const express=require(a0_0x4470ee(0xa5)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require('../models/all_models'),auth=require(a0_0x4470ee(0xac)),users=require(a0_0x4470ee(0xf8)),nodemailer=require(a0_0x4470ee(0xfd));function a0_0x280c(_0x4be8d0,_0x3afdde){var _0x5763a9=a0_0x5763();return a0_0x280c=function(_0x280cd1,_0x8e9208){_0x280cd1=_0x280cd1-0x90;var _0x129170=_0x5763a9[_0x280cd1];return _0x129170;},a0_0x280c(_0x4be8d0,_0x3afdde);}router[a0_0x4470ee(0x9a)](a0_0x4470ee(0xb9),auth,async(_0x5985f3,_0xc1f642)=>{var _0x38d84a=a0_0x4470ee;try{const {username:_0xe78b75,email:_0x438341,role:_0xf6f930}=_0x5985f3[_0x38d84a(0x9b)],_0x57e142=_0x5985f3['user'],_0x2d7e78=await profile[_0x38d84a(0xd9)]({'email':_0x57e142['email']}),_0x276c11=await master_shop[_0x38d84a(0xa1)](),_0x1781d9=await warehouse[_0x38d84a(0xb1)]([{'$match':{'status':_0x38d84a(0xf2),'warehouse_category':_0x38d84a(0xb6)}},{'$group':{'_id':_0x38d84a(0xce),'name':{'$first':_0x38d84a(0xce)}}}]);if(_0x276c11[0x0][_0x38d84a(0xec)]==_0x38d84a(0xb2))var _0x2a440e=users[_0x38d84a(0xc9)];else{if(_0x276c11[0x0][_0x38d84a(0xec)]==_0x38d84a(0xf6))var _0x2a440e=users[_0x38d84a(0xf6)];else{if(_0x276c11[0x0][_0x38d84a(0xec)]==_0x38d84a(0xf4))var _0x2a440e=users[_0x38d84a(0xf4)];else{if(_0x276c11[0x0][_0x38d84a(0xec)]=='Spanish')var _0x2a440e=users['Spanish'];else{if(_0x276c11[0x0][_0x38d84a(0xec)]==_0x38d84a(0xa3))var _0x2a440e=users['French'];else{if(_0x276c11[0x0][_0x38d84a(0xec)]=='Portuguese\x20(BR)')var _0x2a440e=users[_0x38d84a(0xbe)];else{if(_0x276c11[0x0][_0x38d84a(0xec)]=='Chinese')var _0x2a440e=users[_0x38d84a(0xbc)];else{if(_0x276c11[0x0][_0x38d84a(0xec)]==_0x38d84a(0xc2))var _0x2a440e=users[_0x38d84a(0xfa)];}}}}}}}_0xc1f642[_0x38d84a(0xaf)](_0x38d84a(0x9c),{'success':_0x5985f3[_0x38d84a(0xbd)](_0x38d84a(0x92)),'errors':_0x5985f3[_0x38d84a(0xbd)](_0x38d84a(0xdf)),'role':_0x57e142,'profile':_0x2d7e78,'master_shop':_0x276c11,'dataProcess':_0x1781d9,'language':_0x2a440e});}catch(_0x5e6bd4){console[_0x38d84a(0xe2)](_0x5e6bd4);}}),router[a0_0x4470ee(0xc1)](a0_0x4470ee(0xcc),auth,async(_0x5c3a3d,_0x279449)=>{var _0xf2b365=a0_0x4470ee;const {product_category:_0x5924ee,transaction_category:_0x53d392,transaction_date_from:_0x32e07c,transaction_date_to:_0x129575,warehouse_category:_0x56991d,item_code:_0x21f972}=_0x5c3a3d['body'];console['log'](_0x56991d);if(_0x5924ee=='rm'){if(_0x56991d==_0xf2b365(0xf9)){var _0xc7e1c0=await purchases[_0xf2b365(0xb1)]([{'$match':{'date':{'$gte':_0x32e07c,'$lte':_0x129575}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0xf2b365(0xdb)},'pipeline':[{'$unwind':_0xf2b365(0xb5)},{'$match':{'$expr':{'$eq':[_0xf2b365(0xc6),_0xf2b365(0xe5)]}}},{'$project':{'_id':_0xf2b365(0xdc),'product_name':'$product_details.product_name','product_code':_0xf2b365(0xe9),'quantity_available':_0xf2b365(0xc0),'warehouse_name':_0xf2b365(0xce),'warehouse_room':'$room','invoice':_0xf2b365(0xe5),'production_date':'$product_details.production_date','expiry_date':_0xf2b365(0xd6),'UOM':_0xf2b365(0xab)}}],'as':'warehouse_data'}}]);_0xc7e1c0[_0xf2b365(0xad)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0[_0xf2b365(0x9d)](async _0x1ea0c5=>{var _0x1e0dd6=_0xf2b365;_0xc7e1c0[_0x1e0dd6(0xad)][_0x1ea0c5['invoice']]=[],await Promise[_0x1e0dd6(0xf9)](_0x1ea0c5[_0x1e0dd6(0xd7)][_0x1e0dd6(0x9d)](async _0x2fba84=>{var _0x47dc58=_0x1e0dd6;const _0x1097e0=await sales[_0x47dc58(0xb1)]([{'$unwind':_0x47dc58(0xf7)},{'$match':{'sale_product.id_transaction_from':_0x2fba84[_0x47dc58(0xdd)][_0x47dc58(0xc4)](),'sale_product.invoice':_0x2fba84['invoice']}},{'$project':{'_id':_0x47dc58(0x93),'product_name':_0x47dc58(0x95),'product_code':'$sale_product.product_code','quantity_available':_0x47dc58(0xa4),'warehouse_name':_0x47dc58(0xb7),'warehouse_room':_0x47dc58(0x96),'product_invoice':_0x47dc58(0xe8),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0x47dc58(0x91),'production_date':_0x47dc58(0xc8),'expiry_date':_0x47dc58(0xaa),'UOM':_0x47dc58(0xcb)}}]);_0x1097e0[_0x47dc58(0xd3)]>0x0&&_0xc7e1c0['data_sales'][_0x1ea0c5[_0x47dc58(0xe7)]][_0x47dc58(0xc3)](..._0x1097e0);}));})),_0xc7e1c0[_0xf2b365(0xad)]=_0xc7e1c0[_0xf2b365(0xad)],_0xc7e1c0[_0xf2b365(0x90)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0[_0xf2b365(0x9d)](async _0x2a9fa2=>{var _0x117e85=_0xf2b365;_0xc7e1c0[_0x117e85(0x90)][_0x2a9fa2['invoice']]=[],await Promise[_0x117e85(0xf9)](_0x2a9fa2['warehouse_data']['map'](async _0x5c1536=>{var _0x1b8069=_0x117e85;const _0x1b7700=await adjustment[_0x1b8069(0xb1)]([{'$unwind':_0x1b8069(0xbf)},{'$match':{'product.id_transaction_from':_0x5c1536[_0x1b8069(0xdd)][_0x1b8069(0xc4)](),'product.invoice':_0x5c1536[_0x1b8069(0xe7)]}},{'$project':{'_id':_0x1b8069(0xbb),'product_name':'$product.product_name','product_code':_0x1b8069(0xed),'quantity_available':_0x1b8069(0xa7),'warehouse_name':_0x1b8069(0xb7),'warehouse_room':_0x1b8069(0x99),'product_invoice':'$product.invoice','invoice':_0x1b8069(0xdb),'id_transaction_from':'$product.id_transaction_from','date':_0x1b8069(0x91),'production_date':_0x1b8069(0xa2),'expiry_date':'$product.expiry_date','UOM':_0x1b8069(0xd2)}}]);_0x1b7700[_0x1b8069(0xd3)]>0x0&&_0xc7e1c0[_0x1b8069(0x90)][_0x2a9fa2[_0x1b8069(0xe7)]]['push'](..._0x1b7700);}));})),_0xc7e1c0[_0xf2b365(0xb8)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0[_0xf2b365(0x9d)](async _0x38dbbc=>{var _0x3f81ea=_0xf2b365;_0xc7e1c0[_0x3f81ea(0xb8)][_0x38dbbc[_0x3f81ea(0xe7)]]=[],await Promise[_0x3f81ea(0xf9)](_0x38dbbc[_0x3f81ea(0xd7)][_0x3f81ea(0x9d)](async _0x2e3a62=>{var _0x4b7b06=_0x3f81ea;const _0xad034a=await transfers['aggregate']([{'$unwind':_0x4b7b06(0xbf)},{'$match':{'product.id_transaction_id':_0x2e3a62[_0x4b7b06(0xdd)][_0x4b7b06(0xc4)](),'product.To_invoice':_0x2e3a62[_0x4b7b06(0xe7)]}},{'$project':{'_id':_0x4b7b06(0xbb),'product_name':_0x4b7b06(0xf3),'product_code':'$product.product_code','quantity_available':_0x4b7b06(0xe0),'warehouse_name':_0x4b7b06(0xea),'warehouse_room':_0x4b7b06(0x99),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x4b7b06(0x98),'date':_0x4b7b06(0x91),'production_date':_0x4b7b06(0xa2),'expiry_date':_0x4b7b06(0x97),'UOM':_0x4b7b06(0xd2)}}]);_0xad034a['length']>0x0&&_0xc7e1c0[_0x4b7b06(0xb8)][_0x38dbbc['invoice']][_0x4b7b06(0xc3)](..._0xad034a);}));})),_0x279449['json']({'purchases_warehouse':_0xc7e1c0,'data_sales':_0xc7e1c0['data_sales'],'data_adjustment':_0xc7e1c0[_0xf2b365(0x90)],'data_transfer':_0xc7e1c0[_0xf2b365(0xb8)]});}else{var _0xc7e1c0=await purchases[_0xf2b365(0xb1)]([{'$match':{'warehouse_name':_0x56991d,'date':{'$gte':_0x32e07c,'$lte':_0x129575}}},{'$lookup':{'from':_0xf2b365(0xf1),'let':{'invoice':_0xf2b365(0xdb)},'pipeline':[{'$unwind':_0xf2b365(0xb5)},{'$match':{'$expr':{'$eq':[_0xf2b365(0xc6),_0xf2b365(0xe5)]}}},{'$project':{'_id':_0xf2b365(0xdc),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':_0xf2b365(0xc0),'warehouse_name':_0xf2b365(0xce),'warehouse_room':_0xf2b365(0xd5),'invoice':_0xf2b365(0xe5),'production_date':_0xf2b365(0xcd),'expiry_date':_0xf2b365(0xd6),'UOM':'$product_details.unit'}}],'as':_0xf2b365(0xd7)}}]);_0xc7e1c0[_0xf2b365(0xad)]={},await Promise['all'](_0xc7e1c0['map'](async _0x24bb0c=>{var _0x397896=_0xf2b365;_0xc7e1c0[_0x397896(0xad)][_0x24bb0c[_0x397896(0xe7)]]=[],await Promise[_0x397896(0xf9)](_0x24bb0c['warehouse_data'][_0x397896(0x9d)](async _0x5422ca=>{var _0x4d03ec=_0x397896;const _0x364455=await sales['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x5422ca['_id'][_0x4d03ec(0xc4)](),'sale_product.invoice':_0x5422ca[_0x4d03ec(0xe7)]}},{'$project':{'_id':_0x4d03ec(0x93),'product_name':_0x4d03ec(0x95),'product_code':_0x4d03ec(0xe6),'quantity_available':_0x4d03ec(0xa4),'warehouse_name':_0x4d03ec(0xb7),'warehouse_room':'$sale_product.room_name','product_invoice':_0x4d03ec(0xe8),'invoice':'$invoice','id_transaction_from':_0x4d03ec(0xfb),'date':_0x4d03ec(0x91),'production_date':_0x4d03ec(0xc8),'expiry_date':_0x4d03ec(0xaa),'UOM':_0x4d03ec(0xcb)}}]);_0x364455['length']>0x0&&_0xc7e1c0[_0x4d03ec(0xad)][_0x24bb0c['invoice']][_0x4d03ec(0xc3)](..._0x364455);}));})),_0xc7e1c0[_0xf2b365(0xad)]=_0xc7e1c0[_0xf2b365(0xad)],_0xc7e1c0[_0xf2b365(0x90)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0['map'](async _0x56dae0=>{var _0xeca75a=_0xf2b365;_0xc7e1c0['data_adjustment'][_0x56dae0[_0xeca75a(0xe7)]]=[],await Promise[_0xeca75a(0xf9)](_0x56dae0['warehouse_data']['map'](async _0x512f43=>{var _0x359ae4=_0xeca75a;const _0x54c296=await adjustment['aggregate']([{'$unwind':_0x359ae4(0xbf)},{'$match':{'product.id_transaction_from':_0x512f43['_id'][_0x359ae4(0xc4)](),'product.invoice':_0x512f43[_0x359ae4(0xe7)]}},{'$project':{'_id':_0x359ae4(0xbb),'product_name':_0x359ae4(0xf3),'product_code':_0x359ae4(0xed),'quantity_available':_0x359ae4(0xa7),'warehouse_name':_0x359ae4(0xb7),'warehouse_room':_0x359ae4(0x99),'product_invoice':_0x359ae4(0xee),'invoice':'$invoice','id_transaction_from':_0x359ae4(0xa0),'date':_0x359ae4(0x91),'production_date':'$product.production_date','expiry_date':_0x359ae4(0x97),'UOM':_0x359ae4(0xd2)}}]);_0x54c296['length']>0x0&&_0xc7e1c0[_0x359ae4(0x90)][_0x56dae0[_0x359ae4(0xe7)]][_0x359ae4(0xc3)](..._0x54c296);}));})),_0xc7e1c0[_0xf2b365(0xb8)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0['map'](async _0x2ba834=>{var _0x262347=_0xf2b365;_0xc7e1c0['data_transfer'][_0x2ba834[_0x262347(0xe7)]]=[],await Promise[_0x262347(0xf9)](_0x2ba834[_0x262347(0xd7)][_0x262347(0x9d)](async _0x415b96=>{var _0x517b4b=_0x262347;const _0x2f4b18=await transfers[_0x517b4b(0xb1)]([{'$unwind':_0x517b4b(0xbf)},{'$match':{'product.id_transaction_id':_0x415b96['_id'][_0x517b4b(0xc4)](),'product.To_invoice':_0x415b96[_0x517b4b(0xe7)]}},{'$project':{'_id':_0x517b4b(0xbb),'product_name':'$product.product_name','product_code':_0x517b4b(0xed),'quantity_available':_0x517b4b(0xe0),'warehouse_name':_0x517b4b(0xea),'warehouse_room':'$product.room_names','product_invoice':_0x517b4b(0xa8),'invoice':_0x517b4b(0xdb),'id_transaction_from':_0x517b4b(0x98),'date':_0x517b4b(0x91),'production_date':'$product.production_date','expiry_date':_0x517b4b(0x97),'UOM':_0x517b4b(0xd2)}}]);_0x2f4b18['length']>0x0&&_0xc7e1c0[_0x517b4b(0xb8)][_0x2ba834[_0x517b4b(0xe7)]][_0x517b4b(0xc3)](..._0x2f4b18);}));})),_0x279449[_0xf2b365(0xb0)]({'purchases_warehouse':_0xc7e1c0,'data_sales':_0xc7e1c0[_0xf2b365(0xad)],'data_adjustment':_0xc7e1c0[_0xf2b365(0x90)],'data_transfer':_0xc7e1c0[_0xf2b365(0xb8)]});}}else{if(_0x56991d=='all'){var _0xc7e1c0=await purchases_finished[_0xf2b365(0xb1)]([{'$match':{'date':{'$gte':_0x32e07c,'$lte':_0x129575}}},{'$lookup':{'from':_0xf2b365(0xf1),'let':{'invoice':_0xf2b365(0xdb)},'pipeline':[{'$unwind':_0xf2b365(0xb5)},{'$match':{'$expr':{'$eq':[_0xf2b365(0xc6),_0xf2b365(0xe5)]}}},{'$project':{'_id':'$product_details._id','product_name':_0xf2b365(0xb4),'product_code':_0xf2b365(0xe9),'quantity_available':_0xf2b365(0xc0),'warehouse_name':_0xf2b365(0xce),'warehouse_room':_0xf2b365(0xd5),'invoice':_0xf2b365(0xe5),'production_date':'$product_details.production_date','expiry_date':_0xf2b365(0xd6),'UOM':_0xf2b365(0xab)}}],'as':_0xf2b365(0xd7)}}]);_0xc7e1c0[_0xf2b365(0xad)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0[_0xf2b365(0x9d)](async _0x5a3cff=>{var _0x4d8cbc=_0xf2b365;_0xc7e1c0[_0x4d8cbc(0xad)][_0x5a3cff['invoice']]=[],await Promise[_0x4d8cbc(0xf9)](_0x5a3cff[_0x4d8cbc(0xd7)]['map'](async _0x4616e0=>{var _0x5a4143=_0x4d8cbc;const _0x20e1c5=await sales_finished[_0x5a4143(0xb1)]([{'$unwind':_0x5a4143(0xf7)},{'$match':{'sale_product.id_transaction_from':_0x4616e0[_0x5a4143(0xdd)][_0x5a4143(0xc4)](),'sale_product.invoice':_0x4616e0['invoice']}},{'$project':{'_id':_0x5a4143(0x93),'product_name':_0x5a4143(0x95),'product_code':_0x5a4143(0xe6),'quantity_available':_0x5a4143(0xa4),'warehouse_name':'$warehouse_name','warehouse_room':_0x5a4143(0x96),'product_invoice':'$sale_product.invoice','invoice':_0x5a4143(0xdb),'id_transaction_from':_0x5a4143(0xfb),'date':_0x5a4143(0x91),'production_date':_0x5a4143(0xc8),'expiry_date':_0x5a4143(0xaa),'UOM':_0x5a4143(0xcb)}}]);_0x20e1c5[_0x5a4143(0xd3)]>0x0&&_0xc7e1c0[_0x5a4143(0xad)][_0x5a3cff[_0x5a4143(0xe7)]][_0x5a4143(0xc3)](..._0x20e1c5);}));})),_0xc7e1c0[_0xf2b365(0xad)]=_0xc7e1c0[_0xf2b365(0xad)],_0xc7e1c0['data_adjustment']={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0[_0xf2b365(0x9d)](async _0x201f24=>{var _0x34939a=_0xf2b365;_0xc7e1c0[_0x34939a(0x90)][_0x201f24[_0x34939a(0xe7)]]=[],await Promise['all'](_0x201f24[_0x34939a(0xd7)][_0x34939a(0x9d)](async _0xbd0744=>{var _0x2e2052=_0x34939a;const _0x2992a7=await adjustment_finished[_0x2e2052(0xb1)]([{'$unwind':_0x2e2052(0xbf)},{'$match':{'product.id_transaction_from':_0xbd0744['_id']['valueOf'](),'product.invoice':_0xbd0744['invoice']}},{'$project':{'_id':_0x2e2052(0xbb),'product_name':_0x2e2052(0xf3),'product_code':_0x2e2052(0xed),'quantity_available':_0x2e2052(0xa7),'warehouse_name':_0x2e2052(0xb7),'warehouse_room':_0x2e2052(0x99),'product_invoice':_0x2e2052(0xee),'invoice':_0x2e2052(0xdb),'id_transaction_from':_0x2e2052(0xa0),'date':'$date','production_date':_0x2e2052(0xa2),'expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x2992a7[_0x2e2052(0xd3)]>0x0&&_0xc7e1c0[_0x2e2052(0x90)][_0x201f24['invoice']][_0x2e2052(0xc3)](..._0x2992a7);}));})),_0xc7e1c0[_0xf2b365(0xb8)]={},await Promise['all'](_0xc7e1c0[_0xf2b365(0x9d)](async _0x5aed80=>{var _0x1479d8=_0xf2b365;_0xc7e1c0[_0x1479d8(0xb8)][_0x5aed80[_0x1479d8(0xe7)]]=[],await Promise[_0x1479d8(0xf9)](_0x5aed80[_0x1479d8(0xd7)][_0x1479d8(0x9d)](async _0x599d30=>{var _0xce5b1b=_0x1479d8;const _0xdedbb2=await transfers_finished['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x599d30[_0xce5b1b(0xdd)][_0xce5b1b(0xc4)](),'product.from_invoice':_0x599d30[_0xce5b1b(0xe7)]}},{'$project':{'_id':'$product._id','product_name':_0xce5b1b(0xf3),'product_code':_0xce5b1b(0xed),'quantity_available':_0xce5b1b(0xe0),'warehouse_name':_0xce5b1b(0xea),'warehouse_room':_0xce5b1b(0x99),'product_invoice':_0xce5b1b(0xa8),'invoice':'$invoice','id_transaction_from':_0xce5b1b(0xa6),'date':_0xce5b1b(0x91),'production_date':_0xce5b1b(0xa2),'expiry_date':_0xce5b1b(0x97),'UOM':'$product.unit'}}]);_0xdedbb2[_0xce5b1b(0xd3)]>0x0&&_0xc7e1c0[_0xce5b1b(0xb8)][_0x5aed80[_0xce5b1b(0xe7)]][_0xce5b1b(0xc3)](..._0xdedbb2);}));})),_0x279449['json']({'purchases_warehouse':_0xc7e1c0,'data_sales':_0xc7e1c0[_0xf2b365(0xad)],'data_adjustment':_0xc7e1c0['data_adjustment'],'data_transfer':_0xc7e1c0[_0xf2b365(0xb8)]});}else{var _0xc7e1c0=await purchases_finished[_0xf2b365(0xb1)]([{'$match':{'warehouse_name':_0x56991d,'date':{'$gte':_0x32e07c,'$lte':_0x129575}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0xf2b365(0xdb)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':['$$invoice',_0xf2b365(0xe5)]}}},{'$project':{'_id':_0xf2b365(0xdc),'product_name':'$product_details.product_name','product_code':_0xf2b365(0xe9),'quantity_available':_0xf2b365(0xc0),'warehouse_name':_0xf2b365(0xce),'warehouse_room':'$room','invoice':_0xf2b365(0xe5),'production_date':_0xf2b365(0xcd),'expiry_date':_0xf2b365(0xd6),'UOM':_0xf2b365(0xab)}}],'as':'warehouse_data'}}]);_0xc7e1c0[_0xf2b365(0xad)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0[_0xf2b365(0x9d)](async _0x456347=>{var _0x4aaffa=_0xf2b365;_0xc7e1c0[_0x4aaffa(0xad)][_0x456347[_0x4aaffa(0xe7)]]=[],await Promise['all'](_0x456347[_0x4aaffa(0xd7)][_0x4aaffa(0x9d)](async _0xb6301c=>{var _0x21934d=_0x4aaffa;const _0x33d2c7=await sales_finished[_0x21934d(0xb1)]([{'$unwind':_0x21934d(0xf7)},{'$match':{'sale_product.id_transaction_from':_0xb6301c[_0x21934d(0xdd)][_0x21934d(0xc4)](),'sale_product.invoice':_0xb6301c[_0x21934d(0xe7)]}},{'$project':{'_id':_0x21934d(0x93),'product_name':'$sale_product.product_name','product_code':_0x21934d(0xe6),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x21934d(0x96),'product_invoice':_0x21934d(0xe8),'invoice':_0x21934d(0xdb),'id_transaction_from':_0x21934d(0xfb),'date':'$date','production_date':_0x21934d(0xc8),'expiry_date':_0x21934d(0xaa),'UOM':'$sale_product.unit'}}]);_0x33d2c7[_0x21934d(0xd3)]>0x0&&_0xc7e1c0[_0x21934d(0xad)][_0x456347['invoice']][_0x21934d(0xc3)](..._0x33d2c7);}));})),_0xc7e1c0[_0xf2b365(0xad)]=_0xc7e1c0[_0xf2b365(0xad)],_0xc7e1c0[_0xf2b365(0x90)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0[_0xf2b365(0x9d)](async _0xc31b83=>{var _0x365cf1=_0xf2b365;_0xc7e1c0['data_adjustment'][_0xc31b83[_0x365cf1(0xe7)]]=[],await Promise['all'](_0xc31b83[_0x365cf1(0xd7)]['map'](async _0x28594b=>{var _0x26b82b=_0x365cf1;const _0x1693c5=await adjustment_finished['aggregate']([{'$unwind':_0x26b82b(0xbf)},{'$match':{'product.id_transaction_from':_0x28594b[_0x26b82b(0xdd)][_0x26b82b(0xc4)](),'product.invoice':_0x28594b['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x26b82b(0xf3),'product_code':_0x26b82b(0xed),'quantity_available':_0x26b82b(0xa7),'warehouse_name':_0x26b82b(0xb7),'warehouse_room':_0x26b82b(0x99),'product_invoice':_0x26b82b(0xee),'invoice':_0x26b82b(0xdb),'id_transaction_from':_0x26b82b(0xa0),'date':'$date','production_date':'$product.production_date','expiry_date':_0x26b82b(0x97),'UOM':'$product.unit'}}]);_0x1693c5[_0x26b82b(0xd3)]>0x0&&_0xc7e1c0[_0x26b82b(0x90)][_0xc31b83[_0x26b82b(0xe7)]][_0x26b82b(0xc3)](..._0x1693c5);}));})),_0xc7e1c0[_0xf2b365(0xb8)]={},await Promise[_0xf2b365(0xf9)](_0xc7e1c0['map'](async _0x1f7029=>{var _0x5c2e0f=_0xf2b365;_0xc7e1c0[_0x5c2e0f(0xb8)][_0x1f7029[_0x5c2e0f(0xe7)]]=[],await Promise[_0x5c2e0f(0xf9)](_0x1f7029[_0x5c2e0f(0xd7)]['map'](async _0x5d7228=>{var _0x5e2e9b=_0x5c2e0f;const _0xa79d4f=await transfers_finished[_0x5e2e9b(0xb1)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x5d7228['_id'][_0x5e2e9b(0xc4)](),'product.from_invoice':_0x5d7228[_0x5e2e9b(0xe7)]}},{'$project':{'_id':_0x5e2e9b(0xbb),'product_name':_0x5e2e9b(0xf3),'product_code':'$product.product_code','quantity_available':_0x5e2e9b(0xe0),'warehouse_name':_0x5e2e9b(0xea),'warehouse_room':_0x5e2e9b(0x99),'product_invoice':_0x5e2e9b(0xa8),'invoice':'$invoice','id_transaction_from':_0x5e2e9b(0xa6),'date':_0x5e2e9b(0x91),'production_date':_0x5e2e9b(0xa2),'expiry_date':_0x5e2e9b(0x97),'UOM':'$product.unit'}}]);_0xa79d4f['length']>0x0&&_0xc7e1c0[_0x5e2e9b(0xb8)][_0x1f7029[_0x5e2e9b(0xe7)]][_0x5e2e9b(0xc3)](..._0xa79d4f);}));})),_0x279449[_0xf2b365(0xb0)]({'purchases_warehouse':_0xc7e1c0,'data_sales':_0xc7e1c0[_0xf2b365(0xad)],'data_adjustment':_0xc7e1c0[_0xf2b365(0x90)],'data_transfer':_0xc7e1c0[_0xf2b365(0xb8)]});}}}),router['get'](a0_0x4470ee(0xd8),auth,async(_0x5b506d,_0x3186cd)=>{var _0x4e1eab=a0_0x4470ee;try{const _0x107576=_0x5b506d['params']['id'];var _0x5aea0d=await purchases_finished['findById'](_0x107576);const _0xd397e8=await master_shop[_0x4e1eab(0xa1)](),_0x14c4ab=_0x5b506d[_0x4e1eab(0x9b)],_0x5712a8=await profile[_0x4e1eab(0xd9)]({'email':_0x14c4ab[_0x4e1eab(0xf5)]});if(_0xd397e8[0x0]['language']==_0x4e1eab(0xb2))var _0x149b13=users[_0x4e1eab(0xc9)];else{if(_0xd397e8[0x0][_0x4e1eab(0xec)]==_0x4e1eab(0xf6))var _0x149b13=users[_0x4e1eab(0xf6)];else{if(_0xd397e8[0x0][_0x4e1eab(0xec)]==_0x4e1eab(0xf4))var _0x149b13=users['German'];else{if(_0xd397e8[0x0][_0x4e1eab(0xec)]==_0x4e1eab(0xca))var _0x149b13=users['Spanish'];else{if(_0xd397e8[0x0][_0x4e1eab(0xec)]==_0x4e1eab(0xa3))var _0x149b13=users[_0x4e1eab(0xa3)];else{if(_0xd397e8[0x0][_0x4e1eab(0xec)]==_0x4e1eab(0xa9))var _0x149b13=users[_0x4e1eab(0xbe)];else{if(_0xd397e8[0x0]['language']==_0x4e1eab(0xbc))var _0x149b13=users['Chinese'];else{if(_0xd397e8[0x0][_0x4e1eab(0xec)]==_0x4e1eab(0xc2))var _0x149b13=users[_0x4e1eab(0xfa)];}}}}}}}_0x3186cd['render'](_0x4e1eab(0x9e),{'success':_0x5b506d[_0x4e1eab(0xbd)](_0x4e1eab(0x92)),'errors':_0x5b506d[_0x4e1eab(0xbd)](_0x4e1eab(0xdf)),'master_shop':_0xd397e8,'profile':_0x5712a8,'role':_0x14c4ab,'language':_0x149b13,'data':_0x5aea0d});}catch(_0x5c96d2){_0x3186cd[_0x4e1eab(0xb0)](_0x5c96d2);}}),router['get'](a0_0x4470ee(0x94),auth,async(_0x9717a3,_0x58e780)=>{var _0x548929=a0_0x4470ee;try{const _0x5b28ff=_0x9717a3['params']['id'];var _0x2192bd=await sales_finished[_0x548929(0xd1)](_0x5b28ff);const _0x2a3c6b=await master_shop[_0x548929(0xa1)](),_0x51ebf6=_0x9717a3['user'],_0x179d47=await profile[_0x548929(0xd9)]({'email':_0x51ebf6[_0x548929(0xf5)]});if(_0x2a3c6b[0x0][_0x548929(0xec)]==_0x548929(0xb2))var _0x2d0738=users[_0x548929(0xc9)];else{if(_0x2a3c6b[0x0][_0x548929(0xec)]==_0x548929(0xf6))var _0x2d0738=users[_0x548929(0xf6)];else{if(_0x2a3c6b[0x0][_0x548929(0xec)]==_0x548929(0xf4))var _0x2d0738=users[_0x548929(0xf4)];else{if(_0x2a3c6b[0x0][_0x548929(0xec)]==_0x548929(0xca))var _0x2d0738=users[_0x548929(0xca)];else{if(_0x2a3c6b[0x0]['language']==_0x548929(0xa3))var _0x2d0738=users[_0x548929(0xa3)];else{if(_0x2a3c6b[0x0]['language']==_0x548929(0xa9))var _0x2d0738=users[_0x548929(0xbe)];else{if(_0x2a3c6b[0x0]['language']=='Chinese')var _0x2d0738=users[_0x548929(0xbc)];else{if(_0x2a3c6b[0x0][_0x548929(0xec)]=='Arabic\x20(ae)')var _0x2d0738=users['Arabic'];}}}}}}}_0x58e780[_0x548929(0xaf)](_0x548929(0xde),{'success':_0x9717a3[_0x548929(0xbd)](_0x548929(0x92)),'errors':_0x9717a3[_0x548929(0xbd)](_0x548929(0xdf)),'master_shop':_0x2a3c6b,'profile':_0x179d47,'role':_0x51ebf6,'language':_0x2d0738,'data':_0x2192bd});}catch(_0x34d259){_0x58e780['json'](_0x34d259);}}),router[a0_0x4470ee(0x9a)](a0_0x4470ee(0xe3),auth,async(_0xa6e6cb,_0x33001e)=>{var _0x199be3=a0_0x4470ee;try{const _0x3ed12a=_0xa6e6cb[_0x199be3(0xba)]['id'];var _0xff57c3=await transfers_finished['findById'](_0x3ed12a);const _0x40022d=await master_shop[_0x199be3(0xa1)](),_0x67ec4e=_0xa6e6cb['user'],_0x565bfa=await profile['findOne']({'email':_0x67ec4e[_0x199be3(0xf5)]});if(_0x40022d[0x0][_0x199be3(0xec)]==_0x199be3(0xb2))var _0x1545e8=users['English'];else{if(_0x40022d[0x0][_0x199be3(0xec)]==_0x199be3(0xf6))var _0x1545e8=users['Hindi'];else{if(_0x40022d[0x0][_0x199be3(0xec)]==_0x199be3(0xf4))var _0x1545e8=users[_0x199be3(0xf4)];else{if(_0x40022d[0x0]['language']==_0x199be3(0xca))var _0x1545e8=users['Spanish'];else{if(_0x40022d[0x0][_0x199be3(0xec)]=='French')var _0x1545e8=users['French'];else{if(_0x40022d[0x0][_0x199be3(0xec)]=='Portuguese\x20(BR)')var _0x1545e8=users[_0x199be3(0xbe)];else{if(_0x40022d[0x0][_0x199be3(0xec)]==_0x199be3(0xbc))var _0x1545e8=users[_0x199be3(0xbc)];else{if(_0x40022d[0x0][_0x199be3(0xec)]=='Arabic\x20(ae)')var _0x1545e8=users[_0x199be3(0xfa)];}}}}}}}_0x33001e[_0x199be3(0xaf)](_0x199be3(0xcf),{'success':_0xa6e6cb[_0x199be3(0xbd)](_0x199be3(0x92)),'errors':_0xa6e6cb[_0x199be3(0xbd)](_0x199be3(0xdf)),'master_shop':_0x40022d,'profile':_0x565bfa,'role':_0x67ec4e,'language':_0x1545e8,'data':_0xff57c3});}catch(_0xaba26e){_0x33001e[_0x199be3(0xb0)](_0xaba26e);}}),router[a0_0x4470ee(0x9a)]('/viewFG',auth,async(_0x24227d,_0x42d475)=>{var _0x286e15=a0_0x4470ee;try{const {username:_0x480404,email:_0x28226f,role:_0xc6fb9c}=_0x24227d[_0x286e15(0x9b)],_0x3a682b=_0x24227d[_0x286e15(0x9b)],_0x42cfb4=await profile[_0x286e15(0xd9)]({'email':_0x3a682b[_0x286e15(0xf5)]}),_0x48eeab=await master_shop[_0x286e15(0xa1)](),_0x1a4805=await warehouse[_0x286e15(0xb1)]([{'$match':{'status':_0x286e15(0xf2),'warehouse_category':_0x286e15(0xb3)}},{'$group':{'_id':_0x286e15(0xce),'name':{'$first':_0x286e15(0xce)}}}]);if(_0x48eeab[0x0][_0x286e15(0xec)]==_0x286e15(0xb2))var _0x402aa1=users[_0x286e15(0xc9)];else{if(_0x48eeab[0x0][_0x286e15(0xec)]==_0x286e15(0xf6))var _0x402aa1=users[_0x286e15(0xf6)];else{if(_0x48eeab[0x0][_0x286e15(0xec)]==_0x286e15(0xf4))var _0x402aa1=users[_0x286e15(0xf4)];else{if(_0x48eeab[0x0][_0x286e15(0xec)]==_0x286e15(0xca))var _0x402aa1=users[_0x286e15(0xca)];else{if(_0x48eeab[0x0]['language']==_0x286e15(0xa3))var _0x402aa1=users[_0x286e15(0xa3)];else{if(_0x48eeab[0x0]['language']==_0x286e15(0xa9))var _0x402aa1=users[_0x286e15(0xbe)];else{if(_0x48eeab[0x0][_0x286e15(0xec)]==_0x286e15(0xbc))var _0x402aa1=users[_0x286e15(0xbc)];else{if(_0x48eeab[0x0][_0x286e15(0xec)]==_0x286e15(0xc2))var _0x402aa1=users[_0x286e15(0xfa)];}}}}}}}_0x42d475['render'](_0x286e15(0x9f),{'success':_0x24227d['flash']('success'),'errors':_0x24227d[_0x286e15(0xbd)](_0x286e15(0xdf)),'role':_0x3a682b,'profile':_0x42cfb4,'master_shop':_0x48eeab,'dataProcess':_0x1a4805,'language':_0x402aa1});}catch(_0x3f5af0){console[_0x286e15(0xe2)](_0x3f5af0);}}),module[a0_0x4470ee(0xe4)]=router;