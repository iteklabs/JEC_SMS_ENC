function a0_0x3ce5(_0xd4e591,_0x12dd4b){var _0x370b2=a0_0x370b();return a0_0x3ce5=function(_0x3ce578,_0x4549f9){_0x3ce578=_0x3ce578-0x1df;var _0x1f5bdd=_0x370b2[_0x3ce578];return _0x1f5bdd;},a0_0x3ce5(_0xd4e591,_0x12dd4b);}function a0_0x370b(){var _0x89d5fb=['$product.product_name','$product_details.expiry_date','view_table','$product.room_names','French','$product_details.product_code','Portuguese\x20(BR)','$room','exports','push','905583QoHTPc','Hindi','invoice','$product_details.product_stock','3805ePLoMe','errors','$sale_product.product_code','$product_details.production_date','/viewdata_inc_fg/:id','body','$product.to_room_name','$product.product_code','Portuguese','language','user','$product_details.product_name','$product.id_transaction_from','findById','$date','Arabic\x20(ae)','$product_details._id','$name','post','Spanish','valueOf','$sale_product.expiry_date','$product.new_adjust_qty','$$invoice','148632XRleNY','$warehouse_name','success','17DrWZfc','6924ipMmyV','../public/language/languages.json','$product.id_transaction_id','Chinese','$product._id','get','$sale_product.product_name','log','findOne','warehouses','3076955TmDQBl','$product.invoice','Enabled','3502683RSaPrM','English\x20(US)','$sale_product.unit','1056IXkHhL','data_transfer','Arabic','map','$sale_product._id','$to_warehouse','$sale_product.quantity','find','email','aggregate','$sale_product.invoice','/reports','data_sales','/view','json','$product.production_date','English','flash','$invoice','express','data_adjustment','warehouse_data','params','length','$product.unit','all','$product','nodemailer','view_og_table','$sale_product.production_date','render','Raw\x20Materials','$product_details','$sale_product.id_transaction_from','Finished\x20Goods','$product.expiry_date','transaction_finished_raw','/viewdata_og_fg/:id','$product_details.unit','German','$sale_product','/viewFG','_id','$product.id_transaction','$product_details.invoice','$sale_product.room_name','2168648dSbpPp'];a0_0x370b=function(){return _0x89d5fb;};return a0_0x370b();}var a0_0x3ed455=a0_0x3ce5;(function(_0x4ede49,_0x4bf92a){var _0x15f61c=a0_0x3ce5,_0x5b0683=_0x4ede49();while(!![]){try{var _0x45a3df=parseInt(_0x15f61c(0x23e))/0x1*(parseInt(_0x15f61c(0x1e6))/0x2)+parseInt(_0x15f61c(0x21f))/0x3+parseInt(_0x15f61c(0x214))/0x4+-parseInt(_0x15f61c(0x223))/0x5*(parseInt(_0x15f61c(0x23f))/0x6)+parseInt(_0x15f61c(0x1e0))/0x7+-parseInt(_0x15f61c(0x23b))/0x8+parseInt(_0x15f61c(0x1e3))/0x9;if(_0x45a3df===_0x4bf92a)break;else _0x5b0683['push'](_0x5b0683['shift']());}catch(_0x2579c0){_0x5b0683['push'](_0x5b0683['shift']());}}}(a0_0x370b,0xbfa52));const express=require(a0_0x3ed455(0x1f9)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x3ed455(0x240)),nodemailer=require(a0_0x3ed455(0x201));router[a0_0x3ed455(0x244)](a0_0x3ed455(0x1f3),auth,async(_0x5d9e30,_0x347b51)=>{var _0x2d42af=a0_0x3ed455;try{const {username:_0x58f9d9,email:_0x1b97da,role:_0x50890a}=_0x5d9e30['user'],_0x13854b=_0x5d9e30[_0x2d42af(0x22d)],_0x5225fe=await profile['findOne']({'email':_0x13854b[_0x2d42af(0x1ee)]}),_0x26f343=await master_shop[_0x2d42af(0x1ed)](),_0x3d5263=await warehouse[_0x2d42af(0x1ef)]([{'$match':{'status':_0x2d42af(0x1e2),'warehouse_category':_0x2d42af(0x208)}},{'$group':{'_id':_0x2d42af(0x234),'name':{'$first':_0x2d42af(0x234)}}}]);if(_0x26f343[0x0][_0x2d42af(0x22c)]=='English\x20(US)')var _0x4d3453=users[_0x2d42af(0x1f6)];else{if(_0x26f343[0x0][_0x2d42af(0x22c)]==_0x2d42af(0x220))var _0x4d3453=users[_0x2d42af(0x220)];else{if(_0x26f343[0x0][_0x2d42af(0x22c)]=='German')var _0x4d3453=users[_0x2d42af(0x20d)];else{if(_0x26f343[0x0][_0x2d42af(0x22c)]==_0x2d42af(0x236))var _0x4d3453=users['Spanish'];else{if(_0x26f343[0x0][_0x2d42af(0x22c)]==_0x2d42af(0x219))var _0x4d3453=users[_0x2d42af(0x219)];else{if(_0x26f343[0x0][_0x2d42af(0x22c)]==_0x2d42af(0x21b))var _0x4d3453=users[_0x2d42af(0x22b)];else{if(_0x26f343[0x0]['language']==_0x2d42af(0x242))var _0x4d3453=users[_0x2d42af(0x242)];else{if(_0x26f343[0x0]['language']==_0x2d42af(0x232))var _0x4d3453=users[_0x2d42af(0x1e8)];}}}}}}}_0x347b51[_0x2d42af(0x204)]('transaction_finished',{'success':_0x5d9e30[_0x2d42af(0x1f7)](_0x2d42af(0x23d)),'errors':_0x5d9e30[_0x2d42af(0x1f7)]('errors'),'role':_0x13854b,'profile':_0x5225fe,'master_shop':_0x26f343,'dataProcess':_0x3d5263,'language':_0x4d3453});}catch(_0x91091a){console[_0x2d42af(0x246)](_0x91091a);}}),router[a0_0x3ed455(0x235)](a0_0x3ed455(0x1f1),auth,async(_0x2f361c,_0x25517e)=>{var _0x92ec73=a0_0x3ed455;const {product_category:_0x4e366c,transaction_category:_0x50d7db,transaction_date_from:_0x5c402c,transaction_date_to:_0x1cd0d8,warehouse_category:_0x1e5baf,item_code:_0x3eced1}=_0x2f361c[_0x92ec73(0x228)];console[_0x92ec73(0x246)](_0x1e5baf);if(_0x4e366c=='rm'){if(_0x1e5baf==_0x92ec73(0x1ff)){var _0x13d814=await purchases[_0x92ec73(0x1ef)]([{'$match':{'date':{'$gte':_0x5c402c,'$lte':_0x1cd0d8}}},{'$lookup':{'from':_0x92ec73(0x1df),'let':{'invoice':_0x92ec73(0x1f8)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x92ec73(0x23a),_0x92ec73(0x212)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x92ec73(0x22e),'product_code':_0x92ec73(0x21a),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':_0x92ec73(0x21c),'invoice':_0x92ec73(0x212),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x92ec73(0x20c)}}],'as':_0x92ec73(0x1fb)}}]);_0x13d814[_0x92ec73(0x1f2)]={},await Promise['all'](_0x13d814[_0x92ec73(0x1e9)](async _0x4e65fc=>{var _0x171f8f=_0x92ec73;_0x13d814[_0x171f8f(0x1f2)][_0x4e65fc[_0x171f8f(0x221)]]=[],await Promise[_0x171f8f(0x1ff)](_0x4e65fc[_0x171f8f(0x1fb)]['map'](async _0xb746d5=>{var _0x3bf84a=_0x171f8f;const _0x2c2e53=await sales['aggregate']([{'$unwind':_0x3bf84a(0x20e)},{'$match':{'sale_product.id_transaction_from':_0xb746d5[_0x3bf84a(0x210)][_0x3bf84a(0x237)](),'sale_product.invoice':_0xb746d5[_0x3bf84a(0x221)]}},{'$project':{'_id':_0x3bf84a(0x1ea),'product_name':_0x3bf84a(0x245),'product_code':'$sale_product.product_code','quantity_available':_0x3bf84a(0x1ec),'warehouse_name':_0x3bf84a(0x23c),'warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':_0x3bf84a(0x1f8),'id_transaction_from':_0x3bf84a(0x207),'date':_0x3bf84a(0x231),'production_date':_0x3bf84a(0x203),'expiry_date':_0x3bf84a(0x238),'UOM':'$sale_product.unit'}}]);_0x2c2e53[_0x3bf84a(0x1fd)]>0x0&&_0x13d814[_0x3bf84a(0x1f2)][_0x4e65fc[_0x3bf84a(0x221)]][_0x3bf84a(0x21e)](..._0x2c2e53);}));})),_0x13d814[_0x92ec73(0x1f2)]=_0x13d814[_0x92ec73(0x1f2)],_0x13d814[_0x92ec73(0x1fa)]={},await Promise['all'](_0x13d814[_0x92ec73(0x1e9)](async _0x3d6d29=>{var _0x3a76c3=_0x92ec73;_0x13d814['data_adjustment'][_0x3d6d29[_0x3a76c3(0x221)]]=[],await Promise[_0x3a76c3(0x1ff)](_0x3d6d29[_0x3a76c3(0x1fb)][_0x3a76c3(0x1e9)](async _0x351c07=>{var _0x26f450=_0x3a76c3;const _0x23042e=await adjustment[_0x26f450(0x1ef)]([{'$unwind':_0x26f450(0x200)},{'$match':{'product.id_transaction_from':_0x351c07[_0x26f450(0x210)][_0x26f450(0x237)](),'product.invoice':_0x351c07[_0x26f450(0x221)]}},{'$project':{'_id':_0x26f450(0x243),'product_name':_0x26f450(0x215),'product_code':_0x26f450(0x22a),'quantity_available':_0x26f450(0x239),'warehouse_name':'$warehouse_name','warehouse_room':_0x26f450(0x218),'product_invoice':_0x26f450(0x1e1),'invoice':'$invoice','id_transaction_from':_0x26f450(0x22f),'date':_0x26f450(0x231),'production_date':_0x26f450(0x1f5),'expiry_date':_0x26f450(0x209),'UOM':'$product.unit'}}]);_0x23042e[_0x26f450(0x1fd)]>0x0&&_0x13d814['data_adjustment'][_0x3d6d29[_0x26f450(0x221)]]['push'](..._0x23042e);}));})),_0x13d814[_0x92ec73(0x1e7)]={},await Promise[_0x92ec73(0x1ff)](_0x13d814['map'](async _0x30c1d5=>{var _0xc52137=_0x92ec73;_0x13d814[_0xc52137(0x1e7)][_0x30c1d5[_0xc52137(0x221)]]=[],await Promise[_0xc52137(0x1ff)](_0x30c1d5['warehouse_data']['map'](async _0x3afd06=>{var _0x1c4406=_0xc52137;const _0x5c70f0=await transfers[_0x1c4406(0x1ef)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x3afd06[_0x1c4406(0x210)][_0x1c4406(0x237)](),'product.To_invoice':_0x3afd06[_0x1c4406(0x221)]}},{'$project':{'_id':_0x1c4406(0x243),'product_name':_0x1c4406(0x215),'product_code':_0x1c4406(0x22a),'quantity_available':'$product.to_quantity','warehouse_name':'$to_warehouse','warehouse_room':_0x1c4406(0x218),'product_invoice':_0x1c4406(0x229),'invoice':'$invoice','id_transaction_from':_0x1c4406(0x241),'date':_0x1c4406(0x231),'production_date':_0x1c4406(0x1f5),'expiry_date':_0x1c4406(0x209),'UOM':'$product.unit'}}]);_0x5c70f0[_0x1c4406(0x1fd)]>0x0&&_0x13d814[_0x1c4406(0x1e7)][_0x30c1d5[_0x1c4406(0x221)]][_0x1c4406(0x21e)](..._0x5c70f0);}));})),_0x25517e['json']({'purchases_warehouse':_0x13d814,'data_sales':_0x13d814['data_sales'],'data_adjustment':_0x13d814['data_adjustment'],'data_transfer':_0x13d814[_0x92ec73(0x1e7)]});}else{var _0x13d814=await purchases[_0x92ec73(0x1ef)]([{'$match':{'warehouse_name':_0x1e5baf,'date':{'$gte':_0x5c402c,'$lte':_0x1cd0d8}}},{'$lookup':{'from':_0x92ec73(0x1df),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x92ec73(0x23a),_0x92ec73(0x212)]}}},{'$project':{'_id':_0x92ec73(0x233),'product_name':_0x92ec73(0x22e),'product_code':_0x92ec73(0x21a),'quantity_available':_0x92ec73(0x222),'warehouse_name':_0x92ec73(0x234),'warehouse_room':'$room','invoice':_0x92ec73(0x212),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x92ec73(0x20c)}}],'as':_0x92ec73(0x1fb)}}]);_0x13d814[_0x92ec73(0x1f2)]={},await Promise[_0x92ec73(0x1ff)](_0x13d814[_0x92ec73(0x1e9)](async _0x2eb7fd=>{var _0x3732d6=_0x92ec73;_0x13d814[_0x3732d6(0x1f2)][_0x2eb7fd['invoice']]=[],await Promise[_0x3732d6(0x1ff)](_0x2eb7fd[_0x3732d6(0x1fb)]['map'](async _0x4942bb=>{var _0x36497b=_0x3732d6;const _0x1532fd=await sales['aggregate']([{'$unwind':_0x36497b(0x20e)},{'$match':{'sale_product.id_transaction_from':_0x4942bb['_id'][_0x36497b(0x237)](),'sale_product.invoice':_0x4942bb[_0x36497b(0x221)]}},{'$project':{'_id':_0x36497b(0x1ea),'product_name':_0x36497b(0x245),'product_code':_0x36497b(0x225),'quantity_available':_0x36497b(0x1ec),'warehouse_name':'$warehouse_name','warehouse_room':_0x36497b(0x213),'product_invoice':_0x36497b(0x1f0),'invoice':'$invoice','id_transaction_from':_0x36497b(0x207),'date':_0x36497b(0x231),'production_date':_0x36497b(0x203),'expiry_date':_0x36497b(0x238),'UOM':'$sale_product.unit'}}]);_0x1532fd[_0x36497b(0x1fd)]>0x0&&_0x13d814[_0x36497b(0x1f2)][_0x2eb7fd[_0x36497b(0x221)]][_0x36497b(0x21e)](..._0x1532fd);}));})),_0x13d814[_0x92ec73(0x1f2)]=_0x13d814['data_sales'],_0x13d814[_0x92ec73(0x1fa)]={},await Promise[_0x92ec73(0x1ff)](_0x13d814[_0x92ec73(0x1e9)](async _0x3ca9ee=>{var _0x35e412=_0x92ec73;_0x13d814[_0x35e412(0x1fa)][_0x3ca9ee[_0x35e412(0x221)]]=[],await Promise[_0x35e412(0x1ff)](_0x3ca9ee[_0x35e412(0x1fb)]['map'](async _0x13324b=>{var _0x4b28c1=_0x35e412;const _0x39d978=await adjustment['aggregate']([{'$unwind':_0x4b28c1(0x200)},{'$match':{'product.id_transaction_from':_0x13324b[_0x4b28c1(0x210)][_0x4b28c1(0x237)](),'product.invoice':_0x13324b[_0x4b28c1(0x221)]}},{'$project':{'_id':_0x4b28c1(0x243),'product_name':'$product.product_name','product_code':_0x4b28c1(0x22a),'quantity_available':_0x4b28c1(0x239),'warehouse_name':_0x4b28c1(0x23c),'warehouse_room':'$product.room_names','product_invoice':_0x4b28c1(0x1e1),'invoice':_0x4b28c1(0x1f8),'id_transaction_from':_0x4b28c1(0x22f),'date':_0x4b28c1(0x231),'production_date':_0x4b28c1(0x1f5),'expiry_date':'$product.expiry_date','UOM':_0x4b28c1(0x1fe)}}]);_0x39d978[_0x4b28c1(0x1fd)]>0x0&&_0x13d814[_0x4b28c1(0x1fa)][_0x3ca9ee['invoice']][_0x4b28c1(0x21e)](..._0x39d978);}));})),_0x13d814[_0x92ec73(0x1e7)]={},await Promise[_0x92ec73(0x1ff)](_0x13d814['map'](async _0x3b96ed=>{var _0x159d1e=_0x92ec73;_0x13d814['data_transfer'][_0x3b96ed[_0x159d1e(0x221)]]=[],await Promise['all'](_0x3b96ed[_0x159d1e(0x1fb)]['map'](async _0x38c228=>{var _0xb438b3=_0x159d1e;const _0x2127e2=await transfers[_0xb438b3(0x1ef)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x38c228[_0xb438b3(0x210)]['valueOf'](),'product.To_invoice':_0x38c228[_0xb438b3(0x221)]}},{'$project':{'_id':_0xb438b3(0x243),'product_name':_0xb438b3(0x215),'product_code':_0xb438b3(0x22a),'quantity_available':'$product.to_quantity','warehouse_name':_0xb438b3(0x1eb),'warehouse_room':_0xb438b3(0x218),'product_invoice':'$product.to_room_name','invoice':_0xb438b3(0x1f8),'id_transaction_from':_0xb438b3(0x241),'date':_0xb438b3(0x231),'production_date':_0xb438b3(0x1f5),'expiry_date':_0xb438b3(0x209),'UOM':_0xb438b3(0x1fe)}}]);_0x2127e2['length']>0x0&&_0x13d814[_0xb438b3(0x1e7)][_0x3b96ed['invoice']][_0xb438b3(0x21e)](..._0x2127e2);}));})),_0x25517e['json']({'purchases_warehouse':_0x13d814,'data_sales':_0x13d814[_0x92ec73(0x1f2)],'data_adjustment':_0x13d814['data_adjustment'],'data_transfer':_0x13d814[_0x92ec73(0x1e7)]});}}else{if(_0x1e5baf=='all'){var _0x13d814=await purchases_finished[_0x92ec73(0x1ef)]([{'$match':{'date':{'$gte':_0x5c402c,'$lte':_0x1cd0d8}}},{'$lookup':{'from':_0x92ec73(0x1df),'let':{'invoice':_0x92ec73(0x1f8)},'pipeline':[{'$unwind':_0x92ec73(0x206)},{'$match':{'$expr':{'$eq':[_0x92ec73(0x23a),_0x92ec73(0x212)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x92ec73(0x22e),'product_code':_0x92ec73(0x21a),'quantity_available':_0x92ec73(0x222),'warehouse_name':_0x92ec73(0x234),'warehouse_room':_0x92ec73(0x21c),'invoice':'$product_details.invoice','production_date':_0x92ec73(0x226),'expiry_date':_0x92ec73(0x216),'UOM':_0x92ec73(0x20c)}}],'as':_0x92ec73(0x1fb)}}]);_0x13d814[_0x92ec73(0x1f2)]={},await Promise[_0x92ec73(0x1ff)](_0x13d814[_0x92ec73(0x1e9)](async _0x44c4fd=>{var _0x5e2390=_0x92ec73;_0x13d814[_0x5e2390(0x1f2)][_0x44c4fd['invoice']]=[],await Promise[_0x5e2390(0x1ff)](_0x44c4fd[_0x5e2390(0x1fb)][_0x5e2390(0x1e9)](async _0x3ae7a4=>{var _0x5155b7=_0x5e2390;const _0x1bfe20=await sales_finished['aggregate']([{'$unwind':_0x5155b7(0x20e)},{'$match':{'sale_product.id_transaction_from':_0x3ae7a4[_0x5155b7(0x210)][_0x5155b7(0x237)](),'sale_product.invoice':_0x3ae7a4[_0x5155b7(0x221)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x5155b7(0x245),'product_code':_0x5155b7(0x225),'quantity_available':_0x5155b7(0x1ec),'warehouse_name':_0x5155b7(0x23c),'warehouse_room':_0x5155b7(0x213),'product_invoice':_0x5155b7(0x1f0),'invoice':_0x5155b7(0x1f8),'id_transaction_from':_0x5155b7(0x207),'date':'$date','production_date':_0x5155b7(0x203),'expiry_date':_0x5155b7(0x238),'UOM':'$sale_product.unit'}}]);_0x1bfe20[_0x5155b7(0x1fd)]>0x0&&_0x13d814[_0x5155b7(0x1f2)][_0x44c4fd[_0x5155b7(0x221)]]['push'](..._0x1bfe20);}));})),_0x13d814[_0x92ec73(0x1f2)]=_0x13d814[_0x92ec73(0x1f2)],_0x13d814[_0x92ec73(0x1fa)]={},await Promise['all'](_0x13d814[_0x92ec73(0x1e9)](async _0x1151a1=>{var _0x444e07=_0x92ec73;_0x13d814[_0x444e07(0x1fa)][_0x1151a1['invoice']]=[],await Promise['all'](_0x1151a1['warehouse_data']['map'](async _0x24c084=>{var _0x4751d1=_0x444e07;const _0x55d61b=await adjustment_finished[_0x4751d1(0x1ef)]([{'$unwind':_0x4751d1(0x200)},{'$match':{'product.id_transaction_from':_0x24c084[_0x4751d1(0x210)][_0x4751d1(0x237)](),'product.invoice':_0x24c084['invoice']}},{'$project':{'_id':_0x4751d1(0x243),'product_name':_0x4751d1(0x215),'product_code':_0x4751d1(0x22a),'quantity_available':_0x4751d1(0x239),'warehouse_name':_0x4751d1(0x23c),'warehouse_room':_0x4751d1(0x218),'product_invoice':_0x4751d1(0x1e1),'invoice':_0x4751d1(0x1f8),'id_transaction_from':'$product.id_transaction_from','date':_0x4751d1(0x231),'production_date':_0x4751d1(0x1f5),'expiry_date':_0x4751d1(0x209),'UOM':_0x4751d1(0x1fe)}}]);_0x55d61b[_0x4751d1(0x1fd)]>0x0&&_0x13d814[_0x4751d1(0x1fa)][_0x1151a1[_0x4751d1(0x221)]][_0x4751d1(0x21e)](..._0x55d61b);}));})),_0x13d814[_0x92ec73(0x1e7)]={},await Promise[_0x92ec73(0x1ff)](_0x13d814['map'](async _0x24cb77=>{var _0x44aa00=_0x92ec73;_0x13d814['data_transfer'][_0x24cb77[_0x44aa00(0x221)]]=[],await Promise[_0x44aa00(0x1ff)](_0x24cb77[_0x44aa00(0x1fb)][_0x44aa00(0x1e9)](async _0x3a0595=>{var _0xf4084c=_0x44aa00;const _0x3bdda4=await transfers_finished[_0xf4084c(0x1ef)]([{'$unwind':_0xf4084c(0x200)},{'$match':{'product.id_transaction':_0x3a0595['_id']['valueOf'](),'product.from_invoice':_0x3a0595[_0xf4084c(0x221)]}},{'$project':{'_id':_0xf4084c(0x243),'product_name':'$product.product_name','product_code':_0xf4084c(0x22a),'quantity_available':'$product.to_quantity','warehouse_name':'$to_warehouse','warehouse_room':_0xf4084c(0x218),'product_invoice':_0xf4084c(0x229),'invoice':_0xf4084c(0x1f8),'id_transaction_from':_0xf4084c(0x211),'date':_0xf4084c(0x231),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0xf4084c(0x1fe)}}]);_0x3bdda4[_0xf4084c(0x1fd)]>0x0&&_0x13d814['data_transfer'][_0x24cb77[_0xf4084c(0x221)]][_0xf4084c(0x21e)](..._0x3bdda4);}));})),_0x25517e[_0x92ec73(0x1f4)]({'purchases_warehouse':_0x13d814,'data_sales':_0x13d814[_0x92ec73(0x1f2)],'data_adjustment':_0x13d814[_0x92ec73(0x1fa)],'data_transfer':_0x13d814[_0x92ec73(0x1e7)]});}else{var _0x13d814=await purchases_finished[_0x92ec73(0x1ef)]([{'$match':{'warehouse_name':_0x1e5baf,'date':{'$gte':_0x5c402c,'$lte':_0x1cd0d8}}},{'$lookup':{'from':_0x92ec73(0x1df),'let':{'invoice':_0x92ec73(0x1f8)},'pipeline':[{'$unwind':_0x92ec73(0x206)},{'$match':{'$expr':{'$eq':[_0x92ec73(0x23a),'$product_details.invoice']}}},{'$project':{'_id':_0x92ec73(0x233),'product_name':_0x92ec73(0x22e),'product_code':_0x92ec73(0x21a),'quantity_available':_0x92ec73(0x222),'warehouse_name':_0x92ec73(0x234),'warehouse_room':_0x92ec73(0x21c),'invoice':_0x92ec73(0x212),'production_date':_0x92ec73(0x226),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':_0x92ec73(0x1fb)}}]);_0x13d814[_0x92ec73(0x1f2)]={},await Promise[_0x92ec73(0x1ff)](_0x13d814[_0x92ec73(0x1e9)](async _0x74a009=>{var _0x3355a0=_0x92ec73;_0x13d814['data_sales'][_0x74a009[_0x3355a0(0x221)]]=[],await Promise[_0x3355a0(0x1ff)](_0x74a009['warehouse_data'][_0x3355a0(0x1e9)](async _0x36eaf1=>{var _0xa71927=_0x3355a0;const _0x1df8d4=await sales_finished[_0xa71927(0x1ef)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x36eaf1[_0xa71927(0x210)][_0xa71927(0x237)](),'sale_product.invoice':_0x36eaf1[_0xa71927(0x221)]}},{'$project':{'_id':_0xa71927(0x1ea),'product_name':_0xa71927(0x245),'product_code':_0xa71927(0x225),'quantity_available':_0xa71927(0x1ec),'warehouse_name':_0xa71927(0x23c),'warehouse_room':_0xa71927(0x213),'product_invoice':'$sale_product.invoice','invoice':_0xa71927(0x1f8),'id_transaction_from':'$sale_product.id_transaction_from','date':_0xa71927(0x231),'production_date':_0xa71927(0x203),'expiry_date':'$sale_product.expiry_date','UOM':_0xa71927(0x1e5)}}]);_0x1df8d4[_0xa71927(0x1fd)]>0x0&&_0x13d814['data_sales'][_0x74a009['invoice']][_0xa71927(0x21e)](..._0x1df8d4);}));})),_0x13d814[_0x92ec73(0x1f2)]=_0x13d814[_0x92ec73(0x1f2)],_0x13d814[_0x92ec73(0x1fa)]={},await Promise[_0x92ec73(0x1ff)](_0x13d814[_0x92ec73(0x1e9)](async _0x581d2f=>{var _0x4fe05d=_0x92ec73;_0x13d814['data_adjustment'][_0x581d2f['invoice']]=[],await Promise[_0x4fe05d(0x1ff)](_0x581d2f[_0x4fe05d(0x1fb)]['map'](async _0x270959=>{var _0x3655a0=_0x4fe05d;const _0x17073a=await adjustment_finished[_0x3655a0(0x1ef)]([{'$unwind':_0x3655a0(0x200)},{'$match':{'product.id_transaction_from':_0x270959['_id'][_0x3655a0(0x237)](),'product.invoice':_0x270959[_0x3655a0(0x221)]}},{'$project':{'_id':_0x3655a0(0x243),'product_name':_0x3655a0(0x215),'product_code':_0x3655a0(0x22a),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x3655a0(0x23c),'warehouse_room':_0x3655a0(0x218),'product_invoice':'$product.invoice','invoice':_0x3655a0(0x1f8),'id_transaction_from':_0x3655a0(0x22f),'date':'$date','production_date':_0x3655a0(0x1f5),'expiry_date':_0x3655a0(0x209),'UOM':_0x3655a0(0x1fe)}}]);_0x17073a[_0x3655a0(0x1fd)]>0x0&&_0x13d814[_0x3655a0(0x1fa)][_0x581d2f[_0x3655a0(0x221)]]['push'](..._0x17073a);}));})),_0x13d814['data_transfer']={},await Promise[_0x92ec73(0x1ff)](_0x13d814[_0x92ec73(0x1e9)](async _0x1e3f1b=>{var _0x50bd8d=_0x92ec73;_0x13d814['data_transfer'][_0x1e3f1b[_0x50bd8d(0x221)]]=[],await Promise[_0x50bd8d(0x1ff)](_0x1e3f1b['warehouse_data'][_0x50bd8d(0x1e9)](async _0x5a8dd9=>{var _0x269fa0=_0x50bd8d;const _0x1d46b3=await transfers_finished['aggregate']([{'$unwind':_0x269fa0(0x200)},{'$match':{'product.id_transaction':_0x5a8dd9[_0x269fa0(0x210)][_0x269fa0(0x237)](),'product.from_invoice':_0x5a8dd9[_0x269fa0(0x221)]}},{'$project':{'_id':'$product._id','product_name':_0x269fa0(0x215),'product_code':_0x269fa0(0x22a),'quantity_available':'$product.to_quantity','warehouse_name':_0x269fa0(0x1eb),'warehouse_room':_0x269fa0(0x218),'product_invoice':_0x269fa0(0x229),'invoice':_0x269fa0(0x1f8),'id_transaction_from':'$product.id_transaction','date':_0x269fa0(0x231),'production_date':'$product.production_date','expiry_date':_0x269fa0(0x209),'UOM':_0x269fa0(0x1fe)}}]);_0x1d46b3['length']>0x0&&_0x13d814['data_transfer'][_0x1e3f1b[_0x269fa0(0x221)]][_0x269fa0(0x21e)](..._0x1d46b3);}));})),_0x25517e[_0x92ec73(0x1f4)]({'purchases_warehouse':_0x13d814,'data_sales':_0x13d814[_0x92ec73(0x1f2)],'data_adjustment':_0x13d814[_0x92ec73(0x1fa)],'data_transfer':_0x13d814[_0x92ec73(0x1e7)]});}}}),router[a0_0x3ed455(0x244)](a0_0x3ed455(0x227),auth,async(_0xa13ebd,_0x1f5c91)=>{var _0x287362=a0_0x3ed455;try{const _0xb0cf25=_0xa13ebd[_0x287362(0x1fc)]['id'];var _0x10fef7=await purchases_finished['findById'](_0xb0cf25);const _0x218492=await master_shop[_0x287362(0x1ed)](),_0x1734e5=_0xa13ebd[_0x287362(0x22d)],_0x15cb98=await profile['findOne']({'email':_0x1734e5[_0x287362(0x1ee)]});if(_0x218492[0x0][_0x287362(0x22c)]==_0x287362(0x1e4))var _0x309d8b=users['English'];else{if(_0x218492[0x0]['language']==_0x287362(0x220))var _0x309d8b=users[_0x287362(0x220)];else{if(_0x218492[0x0][_0x287362(0x22c)]=='German')var _0x309d8b=users[_0x287362(0x20d)];else{if(_0x218492[0x0][_0x287362(0x22c)]=='Spanish')var _0x309d8b=users[_0x287362(0x236)];else{if(_0x218492[0x0][_0x287362(0x22c)]==_0x287362(0x219))var _0x309d8b=users[_0x287362(0x219)];else{if(_0x218492[0x0][_0x287362(0x22c)]==_0x287362(0x21b))var _0x309d8b=users[_0x287362(0x22b)];else{if(_0x218492[0x0][_0x287362(0x22c)]==_0x287362(0x242))var _0x309d8b=users[_0x287362(0x242)];else{if(_0x218492[0x0][_0x287362(0x22c)]==_0x287362(0x232))var _0x309d8b=users['Arabic'];}}}}}}}_0x1f5c91[_0x287362(0x204)](_0x287362(0x217),{'success':_0xa13ebd['flash'](_0x287362(0x23d)),'errors':_0xa13ebd['flash'](_0x287362(0x224)),'master_shop':_0x218492,'profile':_0x15cb98,'role':_0x1734e5,'language':_0x309d8b,'data':_0x10fef7});}catch(_0x259f7d){_0x1f5c91[_0x287362(0x1f4)](_0x259f7d);}}),router[a0_0x3ed455(0x244)](a0_0x3ed455(0x20b),auth,async(_0x2bd545,_0xdfb403)=>{var _0x4f7b76=a0_0x3ed455;try{const _0x25f579=_0x2bd545[_0x4f7b76(0x1fc)]['id'];var _0x144143=await sales_finished[_0x4f7b76(0x230)](_0x25f579);const _0x29497c=await master_shop[_0x4f7b76(0x1ed)](),_0x1de2fe=_0x2bd545[_0x4f7b76(0x22d)],_0x96d6c7=await profile[_0x4f7b76(0x247)]({'email':_0x1de2fe[_0x4f7b76(0x1ee)]});if(_0x29497c[0x0][_0x4f7b76(0x22c)]==_0x4f7b76(0x1e4))var _0x28ad90=users['English'];else{if(_0x29497c[0x0][_0x4f7b76(0x22c)]==_0x4f7b76(0x220))var _0x28ad90=users['Hindi'];else{if(_0x29497c[0x0][_0x4f7b76(0x22c)]==_0x4f7b76(0x20d))var _0x28ad90=users[_0x4f7b76(0x20d)];else{if(_0x29497c[0x0]['language']=='Spanish')var _0x28ad90=users[_0x4f7b76(0x236)];else{if(_0x29497c[0x0]['language']==_0x4f7b76(0x219))var _0x28ad90=users[_0x4f7b76(0x219)];else{if(_0x29497c[0x0][_0x4f7b76(0x22c)]==_0x4f7b76(0x21b))var _0x28ad90=users[_0x4f7b76(0x22b)];else{if(_0x29497c[0x0][_0x4f7b76(0x22c)]==_0x4f7b76(0x242))var _0x28ad90=users[_0x4f7b76(0x242)];else{if(_0x29497c[0x0][_0x4f7b76(0x22c)]=='Arabic\x20(ae)')var _0x28ad90=users['Arabic'];}}}}}}}_0xdfb403[_0x4f7b76(0x204)](_0x4f7b76(0x202),{'success':_0x2bd545[_0x4f7b76(0x1f7)](_0x4f7b76(0x23d)),'errors':_0x2bd545[_0x4f7b76(0x1f7)](_0x4f7b76(0x224)),'master_shop':_0x29497c,'profile':_0x96d6c7,'role':_0x1de2fe,'language':_0x28ad90,'data':_0x144143});}catch(_0x4d7fb){_0xdfb403[_0x4f7b76(0x1f4)](_0x4d7fb);}}),router['get']('/viewdata_tf_fg/:id',auth,async(_0x667d74,_0x7203d9)=>{var _0x107434=a0_0x3ed455;try{const _0x7c710=_0x667d74['params']['id'];var _0x1022dd=await transfers_finished[_0x107434(0x230)](_0x7c710);const _0x1c2627=await master_shop['find'](),_0x576501=_0x667d74[_0x107434(0x22d)],_0x546966=await profile[_0x107434(0x247)]({'email':_0x576501[_0x107434(0x1ee)]});if(_0x1c2627[0x0][_0x107434(0x22c)]==_0x107434(0x1e4))var _0x5ae472=users['English'];else{if(_0x1c2627[0x0]['language']==_0x107434(0x220))var _0x5ae472=users[_0x107434(0x220)];else{if(_0x1c2627[0x0]['language']==_0x107434(0x20d))var _0x5ae472=users[_0x107434(0x20d)];else{if(_0x1c2627[0x0][_0x107434(0x22c)]==_0x107434(0x236))var _0x5ae472=users[_0x107434(0x236)];else{if(_0x1c2627[0x0][_0x107434(0x22c)]=='French')var _0x5ae472=users[_0x107434(0x219)];else{if(_0x1c2627[0x0][_0x107434(0x22c)]==_0x107434(0x21b))var _0x5ae472=users['Portuguese'];else{if(_0x1c2627[0x0][_0x107434(0x22c)]=='Chinese')var _0x5ae472=users[_0x107434(0x242)];else{if(_0x1c2627[0x0][_0x107434(0x22c)]==_0x107434(0x232))var _0x5ae472=users[_0x107434(0x1e8)];}}}}}}}_0x7203d9['render']('view_tf_table',{'success':_0x667d74['flash'](_0x107434(0x23d)),'errors':_0x667d74[_0x107434(0x1f7)]('errors'),'master_shop':_0x1c2627,'profile':_0x546966,'role':_0x576501,'language':_0x5ae472,'data':_0x1022dd});}catch(_0x1b5435){_0x7203d9[_0x107434(0x1f4)](_0x1b5435);}}),router[a0_0x3ed455(0x244)](a0_0x3ed455(0x20f),auth,async(_0x1f80bb,_0x453e9e)=>{var _0x2aa1e2=a0_0x3ed455;try{const {username:_0x1cfbf9,email:_0x1f4401,role:_0x4a9269}=_0x1f80bb['user'],_0x17c471=_0x1f80bb[_0x2aa1e2(0x22d)],_0x4cf007=await profile[_0x2aa1e2(0x247)]({'email':_0x17c471['email']}),_0x2b3c12=await master_shop[_0x2aa1e2(0x1ed)](),_0x390f14=await warehouse[_0x2aa1e2(0x1ef)]([{'$match':{'status':'Enabled','warehouse_category':_0x2aa1e2(0x205)}},{'$group':{'_id':_0x2aa1e2(0x234),'name':{'$first':_0x2aa1e2(0x234)}}}]);if(_0x2b3c12[0x0][_0x2aa1e2(0x22c)]==_0x2aa1e2(0x1e4))var _0x3cd7cb=users[_0x2aa1e2(0x1f6)];else{if(_0x2b3c12[0x0][_0x2aa1e2(0x22c)]==_0x2aa1e2(0x220))var _0x3cd7cb=users[_0x2aa1e2(0x220)];else{if(_0x2b3c12[0x0][_0x2aa1e2(0x22c)]==_0x2aa1e2(0x20d))var _0x3cd7cb=users[_0x2aa1e2(0x20d)];else{if(_0x2b3c12[0x0][_0x2aa1e2(0x22c)]==_0x2aa1e2(0x236))var _0x3cd7cb=users[_0x2aa1e2(0x236)];else{if(_0x2b3c12[0x0][_0x2aa1e2(0x22c)]==_0x2aa1e2(0x219))var _0x3cd7cb=users[_0x2aa1e2(0x219)];else{if(_0x2b3c12[0x0][_0x2aa1e2(0x22c)]==_0x2aa1e2(0x21b))var _0x3cd7cb=users[_0x2aa1e2(0x22b)];else{if(_0x2b3c12[0x0][_0x2aa1e2(0x22c)]=='Chinese')var _0x3cd7cb=users[_0x2aa1e2(0x242)];else{if(_0x2b3c12[0x0][_0x2aa1e2(0x22c)]==_0x2aa1e2(0x232))var _0x3cd7cb=users[_0x2aa1e2(0x1e8)];}}}}}}}_0x453e9e[_0x2aa1e2(0x204)](_0x2aa1e2(0x20a),{'success':_0x1f80bb[_0x2aa1e2(0x1f7)]('success'),'errors':_0x1f80bb[_0x2aa1e2(0x1f7)](_0x2aa1e2(0x224)),'role':_0x17c471,'profile':_0x4cf007,'master_shop':_0x2b3c12,'dataProcess':_0x390f14,'language':_0x3cd7cb});}catch(_0x1ab455){console[_0x2aa1e2(0x246)](_0x1ab455);}}),module[a0_0x3ed455(0x21d)]=router;