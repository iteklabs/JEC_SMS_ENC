var a0_0x1bc5db=a0_0x472f;function a0_0x472f(_0x539284,_0x3a3557){var _0x2f03f5=a0_0x2f03();return a0_0x472f=function(_0x472f52,_0x463903){_0x472f52=_0x472f52-0x198;var _0x5da8d4=_0x2f03f5[_0x472f52];return _0x5da8d4;},a0_0x472f(_0x539284,_0x3a3557);}(function(_0x1ae03c,_0x52918a){var _0x4b3b71=a0_0x472f,_0x47a57e=_0x1ae03c();while(!![]){try{var _0x5349d6=parseInt(_0x4b3b71(0x1fc))/0x1*(parseInt(_0x4b3b71(0x1c5))/0x2)+-parseInt(_0x4b3b71(0x1f2))/0x3*(parseInt(_0x4b3b71(0x1f0))/0x4)+-parseInt(_0x4b3b71(0x1e1))/0x5*(parseInt(_0x4b3b71(0x1b2))/0x6)+-parseInt(_0x4b3b71(0x1ea))/0x7*(-parseInt(_0x4b3b71(0x1ee))/0x8)+-parseInt(_0x4b3b71(0x1c1))/0x9+parseInt(_0x4b3b71(0x1ae))/0xa+parseInt(_0x4b3b71(0x1e0))/0xb*(-parseInt(_0x4b3b71(0x1c0))/0xc);if(_0x5349d6===_0x52918a)break;else _0x47a57e['push'](_0x47a57e['shift']());}catch(_0x224894){_0x47a57e['push'](_0x47a57e['shift']());}}}(a0_0x2f03,0xd15f5));const express=require(a0_0x1bc5db(0x1e7)),app=express(),router=express[a0_0x1bc5db(0x1bf)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x1bc5db(0x1f5)),auth=require(a0_0x1bc5db(0x1a0)),users=require(a0_0x1bc5db(0x1a6)),nodemailer=require(a0_0x1bc5db(0x1af));router[a0_0x1bc5db(0x1fe)](a0_0x1bc5db(0x203),auth,async(_0xe5a931,_0x32d284)=>{var _0x370987=a0_0x1bc5db;try{const {username:_0x20758f,email:_0x34414e,role:_0x12fe2c}=_0xe5a931['user'],_0x398192=_0xe5a931[_0x370987(0x1bb)],_0x553216=await profile[_0x370987(0x1aa)]({'email':_0x398192[_0x370987(0x19b)]}),_0x337264=await master_shop[_0x370987(0x1c9)](),_0x4b77e1=await warehouse[_0x370987(0x1c2)]([{'$match':{'status':_0x370987(0x1e3),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x370987(0x1a2),'name':{'$first':_0x370987(0x1a2)}}}]);if(_0x337264[0x0][_0x370987(0x1b5)]==_0x370987(0x1ff))var _0x2aa571=users[_0x370987(0x1fd)];else{if(_0x337264[0x0][_0x370987(0x1b5)]=='Hindi')var _0x2aa571=users['Hindi'];else{if(_0x337264[0x0][_0x370987(0x1b5)]==_0x370987(0x1bd))var _0x2aa571=users[_0x370987(0x1bd)];else{if(_0x337264[0x0]['language']=='Spanish')var _0x2aa571=users[_0x370987(0x1b3)];else{if(_0x337264[0x0][_0x370987(0x1b5)]==_0x370987(0x1e9))var _0x2aa571=users[_0x370987(0x1e9)];else{if(_0x337264[0x0]['language']==_0x370987(0x1b9))var _0x2aa571=users[_0x370987(0x1d5)];else{if(_0x337264[0x0][_0x370987(0x1b5)]==_0x370987(0x1e6))var _0x2aa571=users[_0x370987(0x1e6)];else{if(_0x337264[0x0][_0x370987(0x1b5)]=='Arabic\x20(ae)')var _0x2aa571=users['Arabic'];}}}}}}}_0x32d284['render']('transaction_finished',{'success':_0xe5a931['flash'](_0x370987(0x1b4)),'errors':_0xe5a931['flash'](_0x370987(0x1bc)),'role':_0x398192,'profile':_0x553216,'master_shop':_0x337264,'dataProcess':_0x4b77e1,'language':_0x2aa571});}catch(_0x11c3d2){console[_0x370987(0x19d)](_0x11c3d2);}}),router[a0_0x1bc5db(0x1d2)](a0_0x1bc5db(0x1e2),auth,async(_0xdb7624,_0x2b38a3)=>{var _0x57be12=a0_0x1bc5db;const {product_category:_0x8b5ea3,transaction_category:_0x38e685,transaction_date_from:_0x453e28,transaction_date_to:_0x47d3a9,warehouse_category:_0x143b79,item_code:_0x4c1fd6}=_0xdb7624[_0x57be12(0x1fa)];console[_0x57be12(0x19d)](_0x143b79);if(_0x8b5ea3=='rm'){if(_0x143b79==_0x57be12(0x1d7)){var _0x409ebe=await purchases[_0x57be12(0x1c2)]([{'$match':{'date':{'$gte':_0x453e28,'$lte':_0x47d3a9}}},{'$lookup':{'from':_0x57be12(0x1d6),'let':{'invoice':_0x57be12(0x1d0)},'pipeline':[{'$unwind':_0x57be12(0x1ec)},{'$match':{'$expr':{'$eq':[_0x57be12(0x201),_0x57be12(0x204)]}}},{'$project':{'_id':_0x57be12(0x1f4),'product_name':_0x57be12(0x1ef),'product_code':_0x57be12(0x19a),'quantity_available':_0x57be12(0x1ca),'warehouse_name':_0x57be12(0x1a2),'warehouse_room':_0x57be12(0x1a1),'invoice':'$product_details.invoice','production_date':'$product_details.production_date','expiry_date':_0x57be12(0x1ab),'UOM':_0x57be12(0x1e4)}}],'as':_0x57be12(0x1c6)}}]);_0x409ebe[_0x57be12(0x1a5)]={},await Promise['all'](_0x409ebe[_0x57be12(0x1db)](async _0x1a8d8=>{var _0x307a48=_0x57be12;_0x409ebe[_0x307a48(0x1a5)][_0x1a8d8[_0x307a48(0x1de)]]=[],await Promise['all'](_0x1a8d8['warehouse_data']['map'](async _0x392c55=>{var _0x19a9a1=_0x307a48;const _0x34f3a8=await sales[_0x19a9a1(0x1c2)]([{'$unwind':_0x19a9a1(0x1c3)},{'$match':{'sale_product.id_transaction_from':_0x392c55[_0x19a9a1(0x1cc)][_0x19a9a1(0x1ed)](),'sale_product.invoice':_0x392c55[_0x19a9a1(0x1de)]}},{'$project':{'_id':_0x19a9a1(0x1d3),'product_name':'$sale_product.product_name','product_code':_0x19a9a1(0x1dc),'quantity_available':'$sale_product.quantity','warehouse_name':_0x19a9a1(0x1f6),'warehouse_room':_0x19a9a1(0x198),'product_invoice':_0x19a9a1(0x205),'invoice':'$invoice','id_transaction_from':_0x19a9a1(0x1f9),'date':_0x19a9a1(0x206),'production_date':_0x19a9a1(0x1c7),'expiry_date':_0x19a9a1(0x1b8),'UOM':'$sale_product.unit'}}]);_0x34f3a8[_0x19a9a1(0x1d4)]>0x0&&_0x409ebe['data_sales'][_0x1a8d8['invoice']][_0x19a9a1(0x1ac)](..._0x34f3a8);}));})),_0x409ebe[_0x57be12(0x1a5)]=_0x409ebe[_0x57be12(0x1a5)],_0x409ebe[_0x57be12(0x199)]={},await Promise[_0x57be12(0x1d7)](_0x409ebe[_0x57be12(0x1db)](async _0x440a77=>{var _0xf70f46=_0x57be12;_0x409ebe[_0xf70f46(0x199)][_0x440a77['invoice']]=[],await Promise[_0xf70f46(0x1d7)](_0x440a77[_0xf70f46(0x1c6)]['map'](async _0x4d9c79=>{var _0x3079b5=_0xf70f46;const _0x125d06=await adjustment[_0x3079b5(0x1c2)]([{'$unwind':_0x3079b5(0x1b1)},{'$match':{'product.id_transaction_from':_0x4d9c79['_id'][_0x3079b5(0x1ed)](),'product.invoice':_0x4d9c79[_0x3079b5(0x1de)]}},{'$project':{'_id':_0x3079b5(0x1fb),'product_name':_0x3079b5(0x1f3),'product_code':_0x3079b5(0x1a3),'quantity_available':_0x3079b5(0x1cf),'warehouse_name':_0x3079b5(0x1f6),'warehouse_room':_0x3079b5(0x1d1),'product_invoice':'$product.invoice','invoice':_0x3079b5(0x1d0),'id_transaction_from':_0x3079b5(0x1dd),'date':_0x3079b5(0x206),'production_date':_0x3079b5(0x1ad),'expiry_date':_0x3079b5(0x19f),'UOM':'$product.unit'}}]);_0x125d06[_0x3079b5(0x1d4)]>0x0&&_0x409ebe['data_adjustment'][_0x440a77[_0x3079b5(0x1de)]][_0x3079b5(0x1ac)](..._0x125d06);}));})),_0x409ebe[_0x57be12(0x1b0)]={},await Promise[_0x57be12(0x1d7)](_0x409ebe[_0x57be12(0x1db)](async _0x436ad7=>{var _0x379d20=_0x57be12;_0x409ebe[_0x379d20(0x1b0)][_0x436ad7[_0x379d20(0x1de)]]=[],await Promise[_0x379d20(0x1d7)](_0x436ad7[_0x379d20(0x1c6)][_0x379d20(0x1db)](async _0x56b0b2=>{var _0x120950=_0x379d20;const _0x137860=await transfers[_0x120950(0x1c2)]([{'$unwind':_0x120950(0x1b1)},{'$match':{'product.id_transaction_id':_0x56b0b2[_0x120950(0x1cc)][_0x120950(0x1ed)](),'product.To_invoice':_0x56b0b2['invoice']}},{'$project':{'_id':_0x120950(0x1fb),'product_name':_0x120950(0x1f3),'product_code':_0x120950(0x1a3),'quantity_available':_0x120950(0x1e8),'warehouse_name':_0x120950(0x1a7),'warehouse_room':_0x120950(0x1d1),'product_invoice':_0x120950(0x1c8),'invoice':_0x120950(0x1d0),'id_transaction_from':_0x120950(0x1a4),'date':_0x120950(0x206),'production_date':_0x120950(0x1ad),'expiry_date':_0x120950(0x19f),'UOM':_0x120950(0x19c)}}]);_0x137860[_0x120950(0x1d4)]>0x0&&_0x409ebe[_0x120950(0x1b0)][_0x436ad7[_0x120950(0x1de)]][_0x120950(0x1ac)](..._0x137860);}));})),_0x2b38a3[_0x57be12(0x1be)]({'purchases_warehouse':_0x409ebe,'data_sales':_0x409ebe[_0x57be12(0x1a5)],'data_adjustment':_0x409ebe[_0x57be12(0x199)],'data_transfer':_0x409ebe[_0x57be12(0x1b0)]});}else{var _0x409ebe=await purchases[_0x57be12(0x1c2)]([{'$match':{'warehouse_name':_0x143b79,'date':{'$gte':_0x453e28,'$lte':_0x47d3a9}}},{'$lookup':{'from':_0x57be12(0x1d6),'let':{'invoice':_0x57be12(0x1d0)},'pipeline':[{'$unwind':_0x57be12(0x1ec)},{'$match':{'$expr':{'$eq':[_0x57be12(0x201),_0x57be12(0x204)]}}},{'$project':{'_id':_0x57be12(0x1f4),'product_name':_0x57be12(0x1ef),'product_code':_0x57be12(0x19a),'quantity_available':_0x57be12(0x1ca),'warehouse_name':_0x57be12(0x1a2),'warehouse_room':_0x57be12(0x1a1),'invoice':'$product_details.invoice','production_date':_0x57be12(0x1df),'expiry_date':_0x57be12(0x1ab),'UOM':_0x57be12(0x1e4)}}],'as':_0x57be12(0x1c6)}}]);_0x409ebe[_0x57be12(0x1a5)]={},await Promise[_0x57be12(0x1d7)](_0x409ebe['map'](async _0x2592aa=>{var _0x4fa907=_0x57be12;_0x409ebe['data_sales'][_0x2592aa['invoice']]=[],await Promise[_0x4fa907(0x1d7)](_0x2592aa[_0x4fa907(0x1c6)][_0x4fa907(0x1db)](async _0x27c987=>{var _0x4fd6d7=_0x4fa907;const _0x35fbf3=await sales[_0x4fd6d7(0x1c2)]([{'$unwind':_0x4fd6d7(0x1c3)},{'$match':{'sale_product.id_transaction_from':_0x27c987[_0x4fd6d7(0x1cc)]['valueOf'](),'sale_product.invoice':_0x27c987[_0x4fd6d7(0x1de)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x4fd6d7(0x202),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x4fd6d7(0x1f6),'warehouse_room':_0x4fd6d7(0x198),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x4fd6d7(0x1f9),'date':_0x4fd6d7(0x206),'production_date':'$sale_product.production_date','expiry_date':'$sale_product.expiry_date','UOM':_0x4fd6d7(0x1b7)}}]);_0x35fbf3['length']>0x0&&_0x409ebe[_0x4fd6d7(0x1a5)][_0x2592aa[_0x4fd6d7(0x1de)]][_0x4fd6d7(0x1ac)](..._0x35fbf3);}));})),_0x409ebe[_0x57be12(0x1a5)]=_0x409ebe['data_sales'],_0x409ebe[_0x57be12(0x199)]={},await Promise[_0x57be12(0x1d7)](_0x409ebe[_0x57be12(0x1db)](async _0x3e2c8a=>{var _0x46d706=_0x57be12;_0x409ebe[_0x46d706(0x199)][_0x3e2c8a[_0x46d706(0x1de)]]=[],await Promise[_0x46d706(0x1d7)](_0x3e2c8a['warehouse_data'][_0x46d706(0x1db)](async _0x4054b8=>{var _0x294ed1=_0x46d706;const _0x1eebce=await adjustment[_0x294ed1(0x1c2)]([{'$unwind':_0x294ed1(0x1b1)},{'$match':{'product.id_transaction_from':_0x4054b8['_id'][_0x294ed1(0x1ed)](),'product.invoice':_0x4054b8[_0x294ed1(0x1de)]}},{'$project':{'_id':_0x294ed1(0x1fb),'product_name':_0x294ed1(0x1f3),'product_code':'$product.product_code','quantity_available':_0x294ed1(0x1cf),'warehouse_name':_0x294ed1(0x1f6),'warehouse_room':_0x294ed1(0x1d1),'product_invoice':_0x294ed1(0x1cd),'invoice':'$invoice','id_transaction_from':_0x294ed1(0x1dd),'date':'$date','production_date':_0x294ed1(0x1ad),'expiry_date':'$product.expiry_date','UOM':_0x294ed1(0x19c)}}]);_0x1eebce['length']>0x0&&_0x409ebe[_0x294ed1(0x199)][_0x3e2c8a[_0x294ed1(0x1de)]][_0x294ed1(0x1ac)](..._0x1eebce);}));})),_0x409ebe[_0x57be12(0x1b0)]={},await Promise['all'](_0x409ebe['map'](async _0x568f77=>{var _0xe28347=_0x57be12;_0x409ebe[_0xe28347(0x1b0)][_0x568f77[_0xe28347(0x1de)]]=[],await Promise[_0xe28347(0x1d7)](_0x568f77[_0xe28347(0x1c6)][_0xe28347(0x1db)](async _0x7b4239=>{var _0x412bcf=_0xe28347;const _0xcc07d8=await transfers[_0x412bcf(0x1c2)]([{'$unwind':_0x412bcf(0x1b1)},{'$match':{'product.id_transaction_id':_0x7b4239['_id'][_0x412bcf(0x1ed)](),'product.To_invoice':_0x7b4239[_0x412bcf(0x1de)]}},{'$project':{'_id':_0x412bcf(0x1fb),'product_name':_0x412bcf(0x1f3),'product_code':_0x412bcf(0x1a3),'quantity_available':_0x412bcf(0x1e8),'warehouse_name':_0x412bcf(0x1a7),'warehouse_room':_0x412bcf(0x1d1),'product_invoice':_0x412bcf(0x1c8),'invoice':_0x412bcf(0x1d0),'id_transaction_from':_0x412bcf(0x1a4),'date':_0x412bcf(0x206),'production_date':_0x412bcf(0x1ad),'expiry_date':'$product.expiry_date','UOM':_0x412bcf(0x19c)}}]);_0xcc07d8[_0x412bcf(0x1d4)]>0x0&&_0x409ebe[_0x412bcf(0x1b0)][_0x568f77[_0x412bcf(0x1de)]][_0x412bcf(0x1ac)](..._0xcc07d8);}));})),_0x2b38a3[_0x57be12(0x1be)]({'purchases_warehouse':_0x409ebe,'data_sales':_0x409ebe[_0x57be12(0x1a5)],'data_adjustment':_0x409ebe['data_adjustment'],'data_transfer':_0x409ebe[_0x57be12(0x1b0)]});}}else{if(_0x143b79==_0x57be12(0x1d7)){var _0x409ebe=await purchases_finished[_0x57be12(0x1c2)]([{'$match':{'date':{'$gte':_0x453e28,'$lte':_0x47d3a9}}},{'$lookup':{'from':_0x57be12(0x1d6),'let':{'invoice':_0x57be12(0x1d0)},'pipeline':[{'$unwind':_0x57be12(0x1ec)},{'$match':{'$expr':{'$eq':[_0x57be12(0x201),_0x57be12(0x204)]}}},{'$project':{'_id':_0x57be12(0x1f4),'product_name':_0x57be12(0x1ef),'product_code':'$product_details.product_code','quantity_available':_0x57be12(0x1ca),'warehouse_name':_0x57be12(0x1a2),'warehouse_room':_0x57be12(0x1a1),'invoice':_0x57be12(0x204),'production_date':'$product_details.production_date','expiry_date':_0x57be12(0x1ab),'UOM':_0x57be12(0x1e4)}}],'as':_0x57be12(0x1c6)}}]);_0x409ebe['data_sales']={},await Promise['all'](_0x409ebe[_0x57be12(0x1db)](async _0x8e6b31=>{var _0x2ce6ce=_0x57be12;_0x409ebe[_0x2ce6ce(0x1a5)][_0x8e6b31['invoice']]=[],await Promise[_0x2ce6ce(0x1d7)](_0x8e6b31[_0x2ce6ce(0x1c6)][_0x2ce6ce(0x1db)](async _0x67125c=>{var _0x38da47=_0x2ce6ce;const _0x5c553c=await sales_finished[_0x38da47(0x1c2)]([{'$unwind':_0x38da47(0x1c3)},{'$match':{'sale_product.id_transaction_from':_0x67125c[_0x38da47(0x1cc)][_0x38da47(0x1ed)](),'sale_product.invoice':_0x67125c['invoice']}},{'$project':{'_id':'$sale_product._id','product_name':'$sale_product.product_name','product_code':_0x38da47(0x1dc),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x38da47(0x198),'product_invoice':'$sale_product.invoice','invoice':_0x38da47(0x1d0),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x38da47(0x206),'production_date':_0x38da47(0x1c7),'expiry_date':_0x38da47(0x1b8),'UOM':_0x38da47(0x1b7)}}]);_0x5c553c[_0x38da47(0x1d4)]>0x0&&_0x409ebe[_0x38da47(0x1a5)][_0x8e6b31[_0x38da47(0x1de)]][_0x38da47(0x1ac)](..._0x5c553c);}));})),_0x409ebe[_0x57be12(0x1a5)]=_0x409ebe['data_sales'],_0x409ebe[_0x57be12(0x199)]={},await Promise[_0x57be12(0x1d7)](_0x409ebe[_0x57be12(0x1db)](async _0x2b0593=>{var _0x683e51=_0x57be12;_0x409ebe[_0x683e51(0x199)][_0x2b0593[_0x683e51(0x1de)]]=[],await Promise['all'](_0x2b0593[_0x683e51(0x1c6)]['map'](async _0xd94581=>{var _0x4835fa=_0x683e51;const _0x377bb2=await adjustment_finished[_0x4835fa(0x1c2)]([{'$unwind':_0x4835fa(0x1b1)},{'$match':{'product.id_transaction_from':_0xd94581['_id'][_0x4835fa(0x1ed)](),'product.invoice':_0xd94581[_0x4835fa(0x1de)]}},{'$project':{'_id':_0x4835fa(0x1fb),'product_name':_0x4835fa(0x1f3),'product_code':_0x4835fa(0x1a3),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x4835fa(0x1f6),'warehouse_room':_0x4835fa(0x1d1),'product_invoice':_0x4835fa(0x1cd),'invoice':_0x4835fa(0x1d0),'id_transaction_from':_0x4835fa(0x1dd),'date':_0x4835fa(0x206),'production_date':_0x4835fa(0x1ad),'expiry_date':'$product.expiry_date','UOM':_0x4835fa(0x19c)}}]);_0x377bb2[_0x4835fa(0x1d4)]>0x0&&_0x409ebe[_0x4835fa(0x199)][_0x2b0593[_0x4835fa(0x1de)]][_0x4835fa(0x1ac)](..._0x377bb2);}));})),_0x409ebe[_0x57be12(0x1b0)]={},await Promise[_0x57be12(0x1d7)](_0x409ebe[_0x57be12(0x1db)](async _0x3b231c=>{var _0x135a8b=_0x57be12;_0x409ebe[_0x135a8b(0x1b0)][_0x3b231c[_0x135a8b(0x1de)]]=[],await Promise[_0x135a8b(0x1d7)](_0x3b231c[_0x135a8b(0x1c6)]['map'](async _0x2172ef=>{var _0xd33df3=_0x135a8b;const _0x3eaa38=await transfers_finished['aggregate']([{'$unwind':_0xd33df3(0x1b1)},{'$match':{'product.id_transaction':_0x2172ef[_0xd33df3(0x1cc)][_0xd33df3(0x1ed)](),'product.from_invoice':_0x2172ef[_0xd33df3(0x1de)]}},{'$project':{'_id':_0xd33df3(0x1fb),'product_name':_0xd33df3(0x1f3),'product_code':_0xd33df3(0x1a3),'quantity_available':'$product.to_quantity','warehouse_name':_0xd33df3(0x1a7),'warehouse_room':_0xd33df3(0x1d1),'product_invoice':_0xd33df3(0x1c8),'invoice':_0xd33df3(0x1d0),'id_transaction_from':_0xd33df3(0x1f1),'date':_0xd33df3(0x206),'production_date':_0xd33df3(0x1ad),'expiry_date':_0xd33df3(0x19f),'UOM':_0xd33df3(0x19c)}}]);_0x3eaa38[_0xd33df3(0x1d4)]>0x0&&_0x409ebe[_0xd33df3(0x1b0)][_0x3b231c['invoice']][_0xd33df3(0x1ac)](..._0x3eaa38);}));})),_0x2b38a3[_0x57be12(0x1be)]({'purchases_warehouse':_0x409ebe,'data_sales':_0x409ebe[_0x57be12(0x1a5)],'data_adjustment':_0x409ebe[_0x57be12(0x199)],'data_transfer':_0x409ebe[_0x57be12(0x1b0)]});}else{var _0x409ebe=await purchases_finished[_0x57be12(0x1c2)]([{'$match':{'warehouse_name':_0x143b79,'date':{'$gte':_0x453e28,'$lte':_0x47d3a9}}},{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x57be12(0x1ec)},{'$match':{'$expr':{'$eq':['$$invoice',_0x57be12(0x204)]}}},{'$project':{'_id':_0x57be12(0x1f4),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':'$product_details.product_stock','warehouse_name':_0x57be12(0x1a2),'warehouse_room':'$room','invoice':_0x57be12(0x204),'production_date':_0x57be12(0x1df),'expiry_date':_0x57be12(0x1ab),'UOM':'$product_details.unit'}}],'as':'warehouse_data'}}]);_0x409ebe[_0x57be12(0x1a5)]={},await Promise[_0x57be12(0x1d7)](_0x409ebe['map'](async _0x4fbfbe=>{var _0x6cf1e7=_0x57be12;_0x409ebe[_0x6cf1e7(0x1a5)][_0x4fbfbe['invoice']]=[],await Promise['all'](_0x4fbfbe[_0x6cf1e7(0x1c6)][_0x6cf1e7(0x1db)](async _0x2cbb1b=>{var _0x3a35f3=_0x6cf1e7;const _0x12f1f1=await sales_finished['aggregate']([{'$unwind':_0x3a35f3(0x1c3)},{'$match':{'sale_product.id_transaction_from':_0x2cbb1b[_0x3a35f3(0x1cc)][_0x3a35f3(0x1ed)](),'sale_product.invoice':_0x2cbb1b['invoice']}},{'$project':{'_id':'$sale_product._id','product_name':'$sale_product.product_name','product_code':_0x3a35f3(0x1dc),'quantity_available':_0x3a35f3(0x1a9),'warehouse_name':_0x3a35f3(0x1f6),'warehouse_room':_0x3a35f3(0x198),'product_invoice':_0x3a35f3(0x205),'invoice':'$invoice','id_transaction_from':_0x3a35f3(0x1f9),'date':'$date','production_date':_0x3a35f3(0x1c7),'expiry_date':_0x3a35f3(0x1b8),'UOM':_0x3a35f3(0x1b7)}}]);_0x12f1f1[_0x3a35f3(0x1d4)]>0x0&&_0x409ebe['data_sales'][_0x4fbfbe[_0x3a35f3(0x1de)]][_0x3a35f3(0x1ac)](..._0x12f1f1);}));})),_0x409ebe['data_sales']=_0x409ebe['data_sales'],_0x409ebe[_0x57be12(0x199)]={},await Promise[_0x57be12(0x1d7)](_0x409ebe[_0x57be12(0x1db)](async _0x45e061=>{var _0x34635e=_0x57be12;_0x409ebe[_0x34635e(0x199)][_0x45e061['invoice']]=[],await Promise[_0x34635e(0x1d7)](_0x45e061[_0x34635e(0x1c6)]['map'](async _0x4eabf1=>{var _0x393827=_0x34635e;const _0x33a2f7=await adjustment_finished[_0x393827(0x1c2)]([{'$unwind':_0x393827(0x1b1)},{'$match':{'product.id_transaction_from':_0x4eabf1[_0x393827(0x1cc)]['valueOf'](),'product.invoice':_0x4eabf1[_0x393827(0x1de)]}},{'$project':{'_id':_0x393827(0x1fb),'product_name':_0x393827(0x1f3),'product_code':_0x393827(0x1a3),'quantity_available':_0x393827(0x1cf),'warehouse_name':_0x393827(0x1f6),'warehouse_room':_0x393827(0x1d1),'product_invoice':_0x393827(0x1cd),'invoice':_0x393827(0x1d0),'id_transaction_from':_0x393827(0x1dd),'date':_0x393827(0x206),'production_date':_0x393827(0x1ad),'expiry_date':_0x393827(0x19f),'UOM':_0x393827(0x19c)}}]);_0x33a2f7[_0x393827(0x1d4)]>0x0&&_0x409ebe[_0x393827(0x199)][_0x45e061[_0x393827(0x1de)]]['push'](..._0x33a2f7);}));})),_0x409ebe[_0x57be12(0x1b0)]={},await Promise['all'](_0x409ebe[_0x57be12(0x1db)](async _0x16d3d8=>{var _0x3dff83=_0x57be12;_0x409ebe[_0x3dff83(0x1b0)][_0x16d3d8[_0x3dff83(0x1de)]]=[],await Promise['all'](_0x16d3d8[_0x3dff83(0x1c6)]['map'](async _0x415d56=>{var _0x5c642e=_0x3dff83;const _0x182514=await transfers_finished[_0x5c642e(0x1c2)]([{'$unwind':_0x5c642e(0x1b1)},{'$match':{'product.id_transaction':_0x415d56['_id'][_0x5c642e(0x1ed)](),'product.from_invoice':_0x415d56[_0x5c642e(0x1de)]}},{'$project':{'_id':_0x5c642e(0x1fb),'product_name':_0x5c642e(0x1f3),'product_code':_0x5c642e(0x1a3),'quantity_available':'$product.to_quantity','warehouse_name':_0x5c642e(0x1a7),'warehouse_room':_0x5c642e(0x1d1),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x5c642e(0x1f1),'date':'$date','production_date':'$product.production_date','expiry_date':_0x5c642e(0x19f),'UOM':_0x5c642e(0x19c)}}]);_0x182514[_0x5c642e(0x1d4)]>0x0&&_0x409ebe['data_transfer'][_0x16d3d8['invoice']]['push'](..._0x182514);}));})),_0x2b38a3[_0x57be12(0x1be)]({'purchases_warehouse':_0x409ebe,'data_sales':_0x409ebe[_0x57be12(0x1a5)],'data_adjustment':_0x409ebe['data_adjustment'],'data_transfer':_0x409ebe[_0x57be12(0x1b0)]});}}}),router[a0_0x1bc5db(0x1fe)](a0_0x1bc5db(0x1eb),auth,async(_0x530ac8,_0x47969c)=>{var _0x5d8b8a=a0_0x1bc5db;try{const _0x8cdadc=_0x530ac8[_0x5d8b8a(0x1c4)]['id'];var _0x29cc21=await purchases_finished['findById'](_0x8cdadc);const _0x31f4a3=await master_shop[_0x5d8b8a(0x1c9)](),_0x55ff19=_0x530ac8[_0x5d8b8a(0x1bb)],_0x357c74=await profile[_0x5d8b8a(0x1aa)]({'email':_0x55ff19[_0x5d8b8a(0x19b)]});if(_0x31f4a3[0x0]['language']==_0x5d8b8a(0x1ff))var _0x21b6b6=users[_0x5d8b8a(0x1fd)];else{if(_0x31f4a3[0x0][_0x5d8b8a(0x1b5)]==_0x5d8b8a(0x1ba))var _0x21b6b6=users[_0x5d8b8a(0x1ba)];else{if(_0x31f4a3[0x0]['language']==_0x5d8b8a(0x1bd))var _0x21b6b6=users[_0x5d8b8a(0x1bd)];else{if(_0x31f4a3[0x0][_0x5d8b8a(0x1b5)]==_0x5d8b8a(0x1b3))var _0x21b6b6=users['Spanish'];else{if(_0x31f4a3[0x0][_0x5d8b8a(0x1b5)]==_0x5d8b8a(0x1e9))var _0x21b6b6=users[_0x5d8b8a(0x1e9)];else{if(_0x31f4a3[0x0][_0x5d8b8a(0x1b5)]=='Portuguese\x20(BR)')var _0x21b6b6=users[_0x5d8b8a(0x1d5)];else{if(_0x31f4a3[0x0][_0x5d8b8a(0x1b5)]==_0x5d8b8a(0x1e6))var _0x21b6b6=users[_0x5d8b8a(0x1e6)];else{if(_0x31f4a3[0x0][_0x5d8b8a(0x1b5)]==_0x5d8b8a(0x1e5))var _0x21b6b6=users['Arabic'];}}}}}}}_0x47969c[_0x5d8b8a(0x1a8)](_0x5d8b8a(0x200),{'success':_0x530ac8[_0x5d8b8a(0x1b6)](_0x5d8b8a(0x1b4)),'errors':_0x530ac8[_0x5d8b8a(0x1b6)](_0x5d8b8a(0x1bc)),'master_shop':_0x31f4a3,'profile':_0x357c74,'role':_0x55ff19,'language':_0x21b6b6,'data':_0x29cc21});}catch(_0x464999){_0x47969c[_0x5d8b8a(0x1be)](_0x464999);}}),router[a0_0x1bc5db(0x1fe)]('/viewdata_og_fg/:id',auth,async(_0x385061,_0x431c93)=>{var _0x2073c2=a0_0x1bc5db;try{const _0x3836ac=_0x385061['params']['id'];var _0x260a4d=await sales_finished[_0x2073c2(0x19e)](_0x3836ac);const _0x5e0e06=await master_shop[_0x2073c2(0x1c9)](),_0x51259c=_0x385061['user'],_0x2dc2ee=await profile[_0x2073c2(0x1aa)]({'email':_0x51259c[_0x2073c2(0x19b)]});if(_0x5e0e06[0x0][_0x2073c2(0x1b5)]==_0x2073c2(0x1ff))var _0x29a186=users[_0x2073c2(0x1fd)];else{if(_0x5e0e06[0x0][_0x2073c2(0x1b5)]==_0x2073c2(0x1ba))var _0x29a186=users[_0x2073c2(0x1ba)];else{if(_0x5e0e06[0x0][_0x2073c2(0x1b5)]=='German')var _0x29a186=users[_0x2073c2(0x1bd)];else{if(_0x5e0e06[0x0][_0x2073c2(0x1b5)]==_0x2073c2(0x1b3))var _0x29a186=users['Spanish'];else{if(_0x5e0e06[0x0][_0x2073c2(0x1b5)]==_0x2073c2(0x1e9))var _0x29a186=users[_0x2073c2(0x1e9)];else{if(_0x5e0e06[0x0][_0x2073c2(0x1b5)]==_0x2073c2(0x1b9))var _0x29a186=users['Portuguese'];else{if(_0x5e0e06[0x0]['language']==_0x2073c2(0x1e6))var _0x29a186=users[_0x2073c2(0x1e6)];else{if(_0x5e0e06[0x0][_0x2073c2(0x1b5)]=='Arabic\x20(ae)')var _0x29a186=users[_0x2073c2(0x1d9)];}}}}}}}_0x431c93[_0x2073c2(0x1a8)](_0x2073c2(0x1f7),{'success':_0x385061['flash'](_0x2073c2(0x1b4)),'errors':_0x385061[_0x2073c2(0x1b6)](_0x2073c2(0x1bc)),'master_shop':_0x5e0e06,'profile':_0x2dc2ee,'role':_0x51259c,'language':_0x29a186,'data':_0x260a4d});}catch(_0x47e2e6){_0x431c93['json'](_0x47e2e6);}}),router[a0_0x1bc5db(0x1fe)](a0_0x1bc5db(0x1cb),auth,async(_0x142446,_0x5df272)=>{var _0x523a95=a0_0x1bc5db;try{const _0x4b2716=_0x142446[_0x523a95(0x1c4)]['id'];var _0x35aa1c=await transfers_finished[_0x523a95(0x19e)](_0x4b2716);const _0x43fc8b=await master_shop[_0x523a95(0x1c9)](),_0x1e305b=_0x142446[_0x523a95(0x1bb)],_0x2456e2=await profile[_0x523a95(0x1aa)]({'email':_0x1e305b[_0x523a95(0x19b)]});if(_0x43fc8b[0x0]['language']==_0x523a95(0x1ff))var _0xbb6ab6=users[_0x523a95(0x1fd)];else{if(_0x43fc8b[0x0]['language']==_0x523a95(0x1ba))var _0xbb6ab6=users[_0x523a95(0x1ba)];else{if(_0x43fc8b[0x0]['language']==_0x523a95(0x1bd))var _0xbb6ab6=users[_0x523a95(0x1bd)];else{if(_0x43fc8b[0x0]['language']==_0x523a95(0x1b3))var _0xbb6ab6=users[_0x523a95(0x1b3)];else{if(_0x43fc8b[0x0][_0x523a95(0x1b5)]=='French')var _0xbb6ab6=users[_0x523a95(0x1e9)];else{if(_0x43fc8b[0x0][_0x523a95(0x1b5)]==_0x523a95(0x1b9))var _0xbb6ab6=users[_0x523a95(0x1d5)];else{if(_0x43fc8b[0x0]['language']=='Chinese')var _0xbb6ab6=users['Chinese'];else{if(_0x43fc8b[0x0][_0x523a95(0x1b5)]==_0x523a95(0x1e5))var _0xbb6ab6=users[_0x523a95(0x1d9)];}}}}}}}_0x5df272[_0x523a95(0x1a8)](_0x523a95(0x1ce),{'success':_0x142446['flash']('success'),'errors':_0x142446[_0x523a95(0x1b6)](_0x523a95(0x1bc)),'master_shop':_0x43fc8b,'profile':_0x2456e2,'role':_0x1e305b,'language':_0xbb6ab6,'data':_0x35aa1c});}catch(_0x212dee){_0x5df272['json'](_0x212dee);}}),router[a0_0x1bc5db(0x1fe)]('/viewFG',auth,async(_0x26fc5b,_0x2da277)=>{var _0x2fdef4=a0_0x1bc5db;try{const {username:_0x2e3997,email:_0x63229f,role:_0x336ffc}=_0x26fc5b['user'],_0x9dae50=_0x26fc5b[_0x2fdef4(0x1bb)],_0x2f0e54=await profile[_0x2fdef4(0x1aa)]({'email':_0x9dae50['email']}),_0x3540cf=await master_shop[_0x2fdef4(0x1c9)](),_0x26d6e3=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x2fdef4(0x1da)}},{'$group':{'_id':_0x2fdef4(0x1a2),'name':{'$first':_0x2fdef4(0x1a2)}}}]);if(_0x3540cf[0x0][_0x2fdef4(0x1b5)]==_0x2fdef4(0x1ff))var _0x26f524=users[_0x2fdef4(0x1fd)];else{if(_0x3540cf[0x0][_0x2fdef4(0x1b5)]=='Hindi')var _0x26f524=users[_0x2fdef4(0x1ba)];else{if(_0x3540cf[0x0]['language']==_0x2fdef4(0x1bd))var _0x26f524=users[_0x2fdef4(0x1bd)];else{if(_0x3540cf[0x0][_0x2fdef4(0x1b5)]=='Spanish')var _0x26f524=users['Spanish'];else{if(_0x3540cf[0x0][_0x2fdef4(0x1b5)]==_0x2fdef4(0x1e9))var _0x26f524=users[_0x2fdef4(0x1e9)];else{if(_0x3540cf[0x0][_0x2fdef4(0x1b5)]=='Portuguese\x20(BR)')var _0x26f524=users[_0x2fdef4(0x1d5)];else{if(_0x3540cf[0x0][_0x2fdef4(0x1b5)]==_0x2fdef4(0x1e6))var _0x26f524=users[_0x2fdef4(0x1e6)];else{if(_0x3540cf[0x0]['language']==_0x2fdef4(0x1e5))var _0x26f524=users[_0x2fdef4(0x1d9)];}}}}}}}_0x2da277[_0x2fdef4(0x1a8)](_0x2fdef4(0x1d8),{'success':_0x26fc5b[_0x2fdef4(0x1b6)](_0x2fdef4(0x1b4)),'errors':_0x26fc5b[_0x2fdef4(0x1b6)]('errors'),'role':_0x9dae50,'profile':_0x2f0e54,'master_shop':_0x3540cf,'dataProcess':_0x26d6e3,'language':_0x26f524});}catch(_0x48bc2c){console[_0x2fdef4(0x19d)](_0x48bc2c);}}),module[a0_0x1bc5db(0x1f8)]=router;function a0_0x2f03(){var _0x2c27a4=['$sale_product.id_transaction_from','body','$product._id','1LQTGyT','English','get','English\x20(US)','view_table','$$invoice','$sale_product.product_name','/view','$product_details.invoice','$sale_product.invoice','$date','$sale_product.room_name','data_adjustment','$product_details.product_code','email','$product.unit','log','findById','$product.expiry_date','../middleware/auth','$room','$name','$product.product_code','$product.id_transaction_id','data_sales','../public/language/languages.json','$to_warehouse','render','$sale_product.quantity','findOne','$product_details.expiry_date','push','$product.production_date','14616800mDHCFc','nodemailer','data_transfer','$product','612108EzGNEc','Spanish','success','language','flash','$sale_product.unit','$sale_product.expiry_date','Portuguese\x20(BR)','Hindi','user','errors','German','json','Router','608448YzEmfh','11214657dbrROX','aggregate','$sale_product','params','2666834NPmKbj','warehouse_data','$sale_product.production_date','$product.to_room_name','find','$product_details.product_stock','/viewdata_tf_fg/:id','_id','$product.invoice','view_tf_table','$product.new_adjust_qty','$invoice','$product.room_names','post','$sale_product._id','length','Portuguese','warehouses','all','transaction_finished_raw','Arabic','Raw\x20Materials','map','$sale_product.product_code','$product.id_transaction_from','invoice','$product_details.production_date','44hmihpO','30hkBvyC','/reports','Enabled','$product_details.unit','Arabic\x20(ae)','Chinese','express','$product.to_quantity','French','20587BgWUMw','/viewdata_inc_fg/:id','$product_details','valueOf','2336mxPnIN','$product_details.product_name','4HqhJlM','$product.id_transaction','2205849HIcSYo','$product.product_name','$product_details._id','../models/all_models','$warehouse_name','view_og_table','exports'];a0_0x2f03=function(){return _0x2c27a4;};return a0_0x2f03();}