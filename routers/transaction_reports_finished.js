var a0_0x3b5d07=a0_0x5f3b;(function(_0x1d86f1,_0x4273f0){var _0x2ed2b9=a0_0x5f3b,_0x2b7dd9=_0x1d86f1();while(!![]){try{var _0x4a9085=-parseInt(_0x2ed2b9(0xa7))/0x1*(parseInt(_0x2ed2b9(0x107))/0x2)+-parseInt(_0x2ed2b9(0x104))/0x3*(parseInt(_0x2ed2b9(0xa3))/0x4)+-parseInt(_0x2ed2b9(0xcb))/0x5*(-parseInt(_0x2ed2b9(0xd6))/0x6)+-parseInt(_0x2ed2b9(0x9e))/0x7+parseInt(_0x2ed2b9(0x109))/0x8*(parseInt(_0x2ed2b9(0xc5))/0x9)+-parseInt(_0x2ed2b9(0xd4))/0xa*(-parseInt(_0x2ed2b9(0xb6))/0xb)+parseInt(_0x2ed2b9(0xb4))/0xc;if(_0x4a9085===_0x4273f0)break;else _0x2b7dd9['push'](_0x2b7dd9['shift']());}catch(_0x34dab9){_0x2b7dd9['push'](_0x2b7dd9['shift']());}}}(a0_0x53ad,0x4bd60));const express=require(a0_0x3b5d07(0xbb)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x3b5d07(0xfd)),auth=require(a0_0x3b5d07(0xa6)),users=require(a0_0x3b5d07(0xb1)),nodemailer=require(a0_0x3b5d07(0xa2));function a0_0x5f3b(_0x552e2a,_0x3f34aa){var _0x53ade5=a0_0x53ad();return a0_0x5f3b=function(_0x5f3bd6,_0x446ba2){_0x5f3bd6=_0x5f3bd6-0x9b;var _0x394408=_0x53ade5[_0x5f3bd6];return _0x394408;},a0_0x5f3b(_0x552e2a,_0x3f34aa);}function a0_0x53ad(){var _0x5c1f8a=['$product.unit','$product.product_name','map','body','log','103000KoJJVH','$sale_product.invoice','84DQCbIy','$product.id_transaction','$sale_product.product_code','aggregate','data_adjustment','English\x20(US)','params','$product.product_code','$to_warehouse','$product._id','Arabic\x20(ae)','$product.to_room_name','$product_details.expiry_date','warehouse_data','length','Spanish','Arabic','$product_details','$product.production_date','Portuguese\x20(BR)','transaction_finished','French','$name','render','success','$product_details.product_name','all','Raw\x20Materials','$product.id_transaction_id','language','user','view_tf_table','flash','invoice','find','German','$product.room_names','warehouses','errors','../models/all_models','/viewdata_og_fg/:id','$sale_product.quantity','view_table','$date','/view','$product.id_transaction_from','1574805RvtbuZ','$product.expiry_date','findById','146750RQFIdT','Portuguese','8PNDVss','/viewdata_tf_fg/:id','$product.to_quantity','$sale_product.unit','/viewdata_inc_fg/:id','1343335qXrjbl','data_transfer','email','$sale_product._id','nodemailer','4QVnzdP','$sale_product.expiry_date','valueOf','../middleware/auth','6CzYPDO','transaction_finished_raw','json','$product.new_adjust_qty','$product_details.production_date','/reports','$sale_product','$product_details.unit','exports','$product_details.product_code','../public/language/languages.json','push','get','9003828eGtApa','$sale_product.id_transaction_from','121jDrZCK','Finished\x20Goods','$$invoice','_id','Chinese','express','$product','$product_details._id','view_og_table','$product_details.invoice','$product.invoice','findOne','Enabled','$room','$invoice','1228707VchjAQ','$sale_product.production_date','Hindi','$warehouse_name','$sale_product.room_name','$product_details.product_stock','166990DpHYvj','English','data_sales','$sale_product.product_name'];a0_0x53ad=function(){return _0x5c1f8a;};return a0_0x53ad();}router[a0_0x3b5d07(0xb3)](a0_0x3b5d07(0x102),auth,async(_0x2acf09,_0x2c6f25)=>{var _0x24e84e=a0_0x3b5d07;try{const {username:_0x301905,email:_0x5f307a,role:_0xef836b}=_0x2acf09[_0x24e84e(0xf4)],_0x43d09d=_0x2acf09[_0x24e84e(0xf4)],_0x5a55e7=await profile[_0x24e84e(0xc1)]({'email':_0x43d09d['email']}),_0x4ca7a5=await master_shop[_0x24e84e(0xf8)](),_0xdb33e5=await warehouse[_0x24e84e(0xd9)]([{'$match':{'status':_0x24e84e(0xc2),'warehouse_category':_0x24e84e(0xb7)}},{'$group':{'_id':_0x24e84e(0xec),'name':{'$first':_0x24e84e(0xec)}}}]);if(_0x4ca7a5[0x0][_0x24e84e(0xf3)]=='English\x20(US)')var _0x28f046=users['English'];else{if(_0x4ca7a5[0x0][_0x24e84e(0xf3)]==_0x24e84e(0xc7))var _0x28f046=users[_0x24e84e(0xc7)];else{if(_0x4ca7a5[0x0]['language']==_0x24e84e(0xf9))var _0x28f046=users['German'];else{if(_0x4ca7a5[0x0][_0x24e84e(0xf3)]==_0x24e84e(0xe5))var _0x28f046=users[_0x24e84e(0xe5)];else{if(_0x4ca7a5[0x0][_0x24e84e(0xf3)]=='French')var _0x28f046=users['French'];else{if(_0x4ca7a5[0x0][_0x24e84e(0xf3)]==_0x24e84e(0xe9))var _0x28f046=users[_0x24e84e(0x108)];else{if(_0x4ca7a5[0x0][_0x24e84e(0xf3)]==_0x24e84e(0xba))var _0x28f046=users['Chinese'];else{if(_0x4ca7a5[0x0][_0x24e84e(0xf3)]==_0x24e84e(0xe0))var _0x28f046=users['Arabic'];}}}}}}}_0x2c6f25['render'](_0x24e84e(0xea),{'success':_0x2acf09['flash']('success'),'errors':_0x2acf09[_0x24e84e(0xf6)](_0x24e84e(0xfc)),'role':_0x43d09d,'profile':_0x5a55e7,'master_shop':_0x4ca7a5,'dataProcess':_0xdb33e5,'language':_0x28f046});}catch(_0x325ce7){console[_0x24e84e(0xd3)](_0x325ce7);}}),router['post'](a0_0x3b5d07(0xac),auth,async(_0x44ccef,_0x56d49b)=>{var _0x2b609f=a0_0x3b5d07;const {product_category:_0x3e2be5,transaction_category:_0x58a4aa,transaction_date_from:_0x50b48c,transaction_date_to:_0x23ce13,warehouse_category:_0x102071,item_code:_0x5f786b}=_0x44ccef[_0x2b609f(0xd2)];console[_0x2b609f(0xd3)](_0x102071);if(_0x3e2be5=='rm'){if(_0x102071=='all'){var _0x19412e=await purchases['aggregate']([{'$match':{'date':{'$gte':_0x50b48c,'$lte':_0x23ce13}}},{'$lookup':{'from':_0x2b609f(0xfb),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x2b609f(0xe7)},{'$match':{'$expr':{'$eq':[_0x2b609f(0xb8),'$product_details.invoice']}}},{'$project':{'_id':_0x2b609f(0xbd),'product_name':_0x2b609f(0xef),'product_code':_0x2b609f(0xb0),'quantity_available':_0x2b609f(0xca),'warehouse_name':_0x2b609f(0xec),'warehouse_room':_0x2b609f(0xc3),'invoice':_0x2b609f(0xbf),'production_date':_0x2b609f(0xab),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':_0x2b609f(0xe3)}}]);_0x19412e[_0x2b609f(0xcd)]={},await Promise[_0x2b609f(0xf0)](_0x19412e[_0x2b609f(0xd1)](async _0x4f8662=>{var _0x430f74=_0x2b609f;_0x19412e['data_sales'][_0x4f8662[_0x430f74(0xf7)]]=[],await Promise[_0x430f74(0xf0)](_0x4f8662[_0x430f74(0xe3)][_0x430f74(0xd1)](async _0x143933=>{var _0x5a0629=_0x430f74;const _0xe0686f=await sales[_0x5a0629(0xd9)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x143933['_id'][_0x5a0629(0xa5)](),'sale_product.invoice':_0x143933[_0x5a0629(0xf7)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x5a0629(0xce),'product_code':_0x5a0629(0xd8),'quantity_available':_0x5a0629(0xff),'warehouse_name':_0x5a0629(0xc8),'warehouse_room':'$sale_product.room_name','product_invoice':_0x5a0629(0xd5),'invoice':_0x5a0629(0xc4),'id_transaction_from':_0x5a0629(0xb5),'date':_0x5a0629(0x101),'production_date':'$sale_product.production_date','expiry_date':_0x5a0629(0xa4),'UOM':_0x5a0629(0x9c)}}]);_0xe0686f['length']>0x0&&_0x19412e[_0x5a0629(0xcd)][_0x4f8662['invoice']]['push'](..._0xe0686f);}));})),_0x19412e['data_sales']=_0x19412e[_0x2b609f(0xcd)],_0x19412e[_0x2b609f(0xda)]={},await Promise[_0x2b609f(0xf0)](_0x19412e['map'](async _0x2ec926=>{var _0x59a865=_0x2b609f;_0x19412e['data_adjustment'][_0x2ec926[_0x59a865(0xf7)]]=[],await Promise[_0x59a865(0xf0)](_0x2ec926[_0x59a865(0xe3)]['map'](async _0x21ede6=>{var _0x31704a=_0x59a865;const _0x2ad07e=await adjustment[_0x31704a(0xd9)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x21ede6[_0x31704a(0xb9)][_0x31704a(0xa5)](),'product.invoice':_0x21ede6[_0x31704a(0xf7)]}},{'$project':{'_id':_0x31704a(0xdf),'product_name':_0x31704a(0xd0),'product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x31704a(0xfa),'product_invoice':_0x31704a(0xc0),'invoice':_0x31704a(0xc4),'id_transaction_from':_0x31704a(0x103),'date':'$date','production_date':_0x31704a(0xe8),'expiry_date':_0x31704a(0x105),'UOM':'$product.unit'}}]);_0x2ad07e['length']>0x0&&_0x19412e['data_adjustment'][_0x2ec926[_0x31704a(0xf7)]]['push'](..._0x2ad07e);}));})),_0x19412e[_0x2b609f(0x9f)]={},await Promise[_0x2b609f(0xf0)](_0x19412e['map'](async _0x1f5d53=>{var _0x1c0248=_0x2b609f;_0x19412e[_0x1c0248(0x9f)][_0x1f5d53[_0x1c0248(0xf7)]]=[],await Promise[_0x1c0248(0xf0)](_0x1f5d53['warehouse_data'][_0x1c0248(0xd1)](async _0x3b74fc=>{var _0x100916=_0x1c0248;const _0x406f0b=await transfers['aggregate']([{'$unwind':_0x100916(0xbc)},{'$match':{'product.id_transaction_id':_0x3b74fc['_id'][_0x100916(0xa5)](),'product.To_invoice':_0x3b74fc['invoice']}},{'$project':{'_id':_0x100916(0xdf),'product_name':_0x100916(0xd0),'product_code':_0x100916(0xdd),'quantity_available':'$product.to_quantity','warehouse_name':_0x100916(0xde),'warehouse_room':'$product.room_names','product_invoice':_0x100916(0xe1),'invoice':_0x100916(0xc4),'id_transaction_from':_0x100916(0xf2),'date':_0x100916(0x101),'production_date':_0x100916(0xe8),'expiry_date':_0x100916(0x105),'UOM':'$product.unit'}}]);_0x406f0b['length']>0x0&&_0x19412e[_0x100916(0x9f)][_0x1f5d53[_0x100916(0xf7)]][_0x100916(0xb2)](..._0x406f0b);}));})),_0x56d49b[_0x2b609f(0xa9)]({'purchases_warehouse':_0x19412e,'data_sales':_0x19412e[_0x2b609f(0xcd)],'data_adjustment':_0x19412e[_0x2b609f(0xda)],'data_transfer':_0x19412e[_0x2b609f(0x9f)]});}else{var _0x19412e=await purchases['aggregate']([{'$match':{'warehouse_name':_0x102071,'date':{'$gte':_0x50b48c,'$lte':_0x23ce13}}},{'$lookup':{'from':_0x2b609f(0xfb),'let':{'invoice':_0x2b609f(0xc4)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x2b609f(0xb8),_0x2b609f(0xbf)]}}},{'$project':{'_id':_0x2b609f(0xbd),'product_name':_0x2b609f(0xef),'product_code':_0x2b609f(0xb0),'quantity_available':_0x2b609f(0xca),'warehouse_name':_0x2b609f(0xec),'warehouse_room':_0x2b609f(0xc3),'invoice':_0x2b609f(0xbf),'production_date':_0x2b609f(0xab),'expiry_date':_0x2b609f(0xe2),'UOM':'$product_details.unit'}}],'as':_0x2b609f(0xe3)}}]);_0x19412e['data_sales']={},await Promise['all'](_0x19412e[_0x2b609f(0xd1)](async _0x2e69c2=>{var _0x480164=_0x2b609f;_0x19412e[_0x480164(0xcd)][_0x2e69c2[_0x480164(0xf7)]]=[],await Promise[_0x480164(0xf0)](_0x2e69c2['warehouse_data'][_0x480164(0xd1)](async _0x3ad750=>{var _0xc3b92b=_0x480164;const _0x1c520d=await sales[_0xc3b92b(0xd9)]([{'$unwind':_0xc3b92b(0xad)},{'$match':{'sale_product.id_transaction_from':_0x3ad750['_id'][_0xc3b92b(0xa5)](),'sale_product.invoice':_0x3ad750[_0xc3b92b(0xf7)]}},{'$project':{'_id':'$sale_product._id','product_name':_0xc3b92b(0xce),'product_code':_0xc3b92b(0xd8),'quantity_available':_0xc3b92b(0xff),'warehouse_name':_0xc3b92b(0xc8),'warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':_0xc3b92b(0xc4),'id_transaction_from':'$sale_product.id_transaction_from','date':_0xc3b92b(0x101),'production_date':_0xc3b92b(0xc6),'expiry_date':_0xc3b92b(0xa4),'UOM':_0xc3b92b(0x9c)}}]);_0x1c520d[_0xc3b92b(0xe4)]>0x0&&_0x19412e['data_sales'][_0x2e69c2[_0xc3b92b(0xf7)]][_0xc3b92b(0xb2)](..._0x1c520d);}));})),_0x19412e['data_sales']=_0x19412e['data_sales'],_0x19412e[_0x2b609f(0xda)]={},await Promise[_0x2b609f(0xf0)](_0x19412e[_0x2b609f(0xd1)](async _0x235ad4=>{var _0x481b14=_0x2b609f;_0x19412e[_0x481b14(0xda)][_0x235ad4[_0x481b14(0xf7)]]=[],await Promise[_0x481b14(0xf0)](_0x235ad4[_0x481b14(0xe3)]['map'](async _0x585ca1=>{var _0x29716a=_0x481b14;const _0x1f8a12=await adjustment['aggregate']([{'$unwind':_0x29716a(0xbc)},{'$match':{'product.id_transaction_from':_0x585ca1[_0x29716a(0xb9)][_0x29716a(0xa5)](),'product.invoice':_0x585ca1[_0x29716a(0xf7)]}},{'$project':{'_id':_0x29716a(0xdf),'product_name':_0x29716a(0xd0),'product_code':_0x29716a(0xdd),'quantity_available':_0x29716a(0xaa),'warehouse_name':_0x29716a(0xc8),'warehouse_room':_0x29716a(0xfa),'product_invoice':'$product.invoice','invoice':_0x29716a(0xc4),'id_transaction_from':_0x29716a(0x103),'date':_0x29716a(0x101),'production_date':_0x29716a(0xe8),'expiry_date':_0x29716a(0x105),'UOM':_0x29716a(0xcf)}}]);_0x1f8a12[_0x29716a(0xe4)]>0x0&&_0x19412e[_0x29716a(0xda)][_0x235ad4['invoice']]['push'](..._0x1f8a12);}));})),_0x19412e['data_transfer']={},await Promise[_0x2b609f(0xf0)](_0x19412e[_0x2b609f(0xd1)](async _0x2fa409=>{var _0x1741d1=_0x2b609f;_0x19412e[_0x1741d1(0x9f)][_0x2fa409[_0x1741d1(0xf7)]]=[],await Promise[_0x1741d1(0xf0)](_0x2fa409[_0x1741d1(0xe3)][_0x1741d1(0xd1)](async _0x2eb723=>{var _0x4815a7=_0x1741d1;const _0x17064c=await transfers[_0x4815a7(0xd9)]([{'$unwind':_0x4815a7(0xbc)},{'$match':{'product.id_transaction_id':_0x2eb723['_id']['valueOf'](),'product.To_invoice':_0x2eb723[_0x4815a7(0xf7)]}},{'$project':{'_id':_0x4815a7(0xdf),'product_name':_0x4815a7(0xd0),'product_code':_0x4815a7(0xdd),'quantity_available':_0x4815a7(0x9b),'warehouse_name':'$to_warehouse','warehouse_room':_0x4815a7(0xfa),'product_invoice':_0x4815a7(0xe1),'invoice':_0x4815a7(0xc4),'id_transaction_from':_0x4815a7(0xf2),'date':_0x4815a7(0x101),'production_date':_0x4815a7(0xe8),'expiry_date':_0x4815a7(0x105),'UOM':_0x4815a7(0xcf)}}]);_0x17064c[_0x4815a7(0xe4)]>0x0&&_0x19412e[_0x4815a7(0x9f)][_0x2fa409[_0x4815a7(0xf7)]][_0x4815a7(0xb2)](..._0x17064c);}));})),_0x56d49b[_0x2b609f(0xa9)]({'purchases_warehouse':_0x19412e,'data_sales':_0x19412e[_0x2b609f(0xcd)],'data_adjustment':_0x19412e[_0x2b609f(0xda)],'data_transfer':_0x19412e[_0x2b609f(0x9f)]});}}else{if(_0x102071==_0x2b609f(0xf0)){var _0x19412e=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x50b48c,'$lte':_0x23ce13}}},{'$lookup':{'from':_0x2b609f(0xfb),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x2b609f(0xe7)},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x2b609f(0xbd),'product_name':_0x2b609f(0xef),'product_code':_0x2b609f(0xb0),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':'$room','invoice':'$product_details.invoice','production_date':_0x2b609f(0xab),'expiry_date':_0x2b609f(0xe2),'UOM':_0x2b609f(0xae)}}],'as':_0x2b609f(0xe3)}}]);_0x19412e[_0x2b609f(0xcd)]={},await Promise[_0x2b609f(0xf0)](_0x19412e['map'](async _0x4f9847=>{var _0x287a98=_0x2b609f;_0x19412e[_0x287a98(0xcd)][_0x4f9847[_0x287a98(0xf7)]]=[],await Promise['all'](_0x4f9847[_0x287a98(0xe3)][_0x287a98(0xd1)](async _0x3fa227=>{var _0x2b369a=_0x287a98;const _0x232141=await sales_finished[_0x2b369a(0xd9)]([{'$unwind':_0x2b369a(0xad)},{'$match':{'sale_product.id_transaction_from':_0x3fa227[_0x2b369a(0xb9)][_0x2b369a(0xa5)](),'sale_product.invoice':_0x3fa227[_0x2b369a(0xf7)]}},{'$project':{'_id':_0x2b369a(0xa1),'product_name':_0x2b369a(0xce),'product_code':_0x2b369a(0xd8),'quantity_available':_0x2b369a(0xff),'warehouse_name':'$warehouse_name','warehouse_room':_0x2b369a(0xc9),'product_invoice':_0x2b369a(0xd5),'invoice':_0x2b369a(0xc4),'id_transaction_from':_0x2b369a(0xb5),'date':'$date','production_date':_0x2b369a(0xc6),'expiry_date':_0x2b369a(0xa4),'UOM':_0x2b369a(0x9c)}}]);_0x232141[_0x2b369a(0xe4)]>0x0&&_0x19412e[_0x2b369a(0xcd)][_0x4f9847[_0x2b369a(0xf7)]][_0x2b369a(0xb2)](..._0x232141);}));})),_0x19412e[_0x2b609f(0xcd)]=_0x19412e['data_sales'],_0x19412e['data_adjustment']={},await Promise[_0x2b609f(0xf0)](_0x19412e[_0x2b609f(0xd1)](async _0x423c96=>{var _0x488319=_0x2b609f;_0x19412e[_0x488319(0xda)][_0x423c96['invoice']]=[],await Promise[_0x488319(0xf0)](_0x423c96[_0x488319(0xe3)][_0x488319(0xd1)](async _0x5f1441=>{var _0x232daf=_0x488319;const _0x26bec6=await adjustment_finished[_0x232daf(0xd9)]([{'$unwind':_0x232daf(0xbc)},{'$match':{'product.id_transaction_from':_0x5f1441[_0x232daf(0xb9)][_0x232daf(0xa5)](),'product.invoice':_0x5f1441[_0x232daf(0xf7)]}},{'$project':{'_id':'$product._id','product_name':_0x232daf(0xd0),'product_code':_0x232daf(0xdd),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x232daf(0xc8),'warehouse_room':_0x232daf(0xfa),'product_invoice':_0x232daf(0xc0),'invoice':_0x232daf(0xc4),'id_transaction_from':_0x232daf(0x103),'date':_0x232daf(0x101),'production_date':_0x232daf(0xe8),'expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x26bec6['length']>0x0&&_0x19412e[_0x232daf(0xda)][_0x423c96[_0x232daf(0xf7)]]['push'](..._0x26bec6);}));})),_0x19412e[_0x2b609f(0x9f)]={},await Promise[_0x2b609f(0xf0)](_0x19412e[_0x2b609f(0xd1)](async _0x2d945f=>{var _0x2fc59e=_0x2b609f;_0x19412e[_0x2fc59e(0x9f)][_0x2d945f[_0x2fc59e(0xf7)]]=[],await Promise[_0x2fc59e(0xf0)](_0x2d945f[_0x2fc59e(0xe3)][_0x2fc59e(0xd1)](async _0x4a48c4=>{var _0x150b5e=_0x2fc59e;const _0x2ad3b5=await transfers_finished['aggregate']([{'$unwind':_0x150b5e(0xbc)},{'$match':{'product.id_transaction':_0x4a48c4[_0x150b5e(0xb9)][_0x150b5e(0xa5)](),'product.from_invoice':_0x4a48c4['invoice']}},{'$project':{'_id':_0x150b5e(0xdf),'product_name':_0x150b5e(0xd0),'product_code':_0x150b5e(0xdd),'quantity_available':_0x150b5e(0x9b),'warehouse_name':'$to_warehouse','warehouse_room':_0x150b5e(0xfa),'product_invoice':_0x150b5e(0xe1),'invoice':_0x150b5e(0xc4),'id_transaction_from':_0x150b5e(0xd7),'date':_0x150b5e(0x101),'production_date':_0x150b5e(0xe8),'expiry_date':_0x150b5e(0x105),'UOM':'$product.unit'}}]);_0x2ad3b5['length']>0x0&&_0x19412e[_0x150b5e(0x9f)][_0x2d945f[_0x150b5e(0xf7)]][_0x150b5e(0xb2)](..._0x2ad3b5);}));})),_0x56d49b[_0x2b609f(0xa9)]({'purchases_warehouse':_0x19412e,'data_sales':_0x19412e[_0x2b609f(0xcd)],'data_adjustment':_0x19412e[_0x2b609f(0xda)],'data_transfer':_0x19412e[_0x2b609f(0x9f)]});}else{var _0x19412e=await purchases_finished[_0x2b609f(0xd9)]([{'$match':{'warehouse_name':_0x102071,'date':{'$gte':_0x50b48c,'$lte':_0x23ce13}}},{'$lookup':{'from':_0x2b609f(0xfb),'let':{'invoice':_0x2b609f(0xc4)},'pipeline':[{'$unwind':_0x2b609f(0xe7)},{'$match':{'$expr':{'$eq':['$$invoice',_0x2b609f(0xbf)]}}},{'$project':{'_id':_0x2b609f(0xbd),'product_name':'$product_details.product_name','product_code':_0x2b609f(0xb0),'quantity_available':'$product_details.product_stock','warehouse_name':_0x2b609f(0xec),'warehouse_room':_0x2b609f(0xc3),'invoice':_0x2b609f(0xbf),'production_date':_0x2b609f(0xab),'expiry_date':'$product_details.expiry_date','UOM':_0x2b609f(0xae)}}],'as':_0x2b609f(0xe3)}}]);_0x19412e['data_sales']={},await Promise['all'](_0x19412e[_0x2b609f(0xd1)](async _0x56f626=>{var _0x188709=_0x2b609f;_0x19412e[_0x188709(0xcd)][_0x56f626[_0x188709(0xf7)]]=[],await Promise['all'](_0x56f626[_0x188709(0xe3)]['map'](async _0x5607c4=>{var _0x37e6a3=_0x188709;const _0x1403dd=await sales_finished[_0x37e6a3(0xd9)]([{'$unwind':_0x37e6a3(0xad)},{'$match':{'sale_product.id_transaction_from':_0x5607c4[_0x37e6a3(0xb9)][_0x37e6a3(0xa5)](),'sale_product.invoice':_0x5607c4[_0x37e6a3(0xf7)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x37e6a3(0xce),'product_code':_0x37e6a3(0xd8),'quantity_available':_0x37e6a3(0xff),'warehouse_name':_0x37e6a3(0xc8),'warehouse_room':_0x37e6a3(0xc9),'product_invoice':_0x37e6a3(0xd5),'invoice':_0x37e6a3(0xc4),'id_transaction_from':_0x37e6a3(0xb5),'date':_0x37e6a3(0x101),'production_date':_0x37e6a3(0xc6),'expiry_date':_0x37e6a3(0xa4),'UOM':'$sale_product.unit'}}]);_0x1403dd[_0x37e6a3(0xe4)]>0x0&&_0x19412e[_0x37e6a3(0xcd)][_0x56f626['invoice']][_0x37e6a3(0xb2)](..._0x1403dd);}));})),_0x19412e['data_sales']=_0x19412e['data_sales'],_0x19412e[_0x2b609f(0xda)]={},await Promise[_0x2b609f(0xf0)](_0x19412e[_0x2b609f(0xd1)](async _0x4b0dd6=>{var _0x2acdc3=_0x2b609f;_0x19412e[_0x2acdc3(0xda)][_0x4b0dd6['invoice']]=[],await Promise[_0x2acdc3(0xf0)](_0x4b0dd6[_0x2acdc3(0xe3)][_0x2acdc3(0xd1)](async _0x4d3b72=>{var _0xb6e36d=_0x2acdc3;const _0x41480c=await adjustment_finished[_0xb6e36d(0xd9)]([{'$unwind':_0xb6e36d(0xbc)},{'$match':{'product.id_transaction_from':_0x4d3b72['_id'][_0xb6e36d(0xa5)](),'product.invoice':_0x4d3b72['invoice']}},{'$project':{'_id':_0xb6e36d(0xdf),'product_name':_0xb6e36d(0xd0),'product_code':_0xb6e36d(0xdd),'quantity_available':_0xb6e36d(0xaa),'warehouse_name':_0xb6e36d(0xc8),'warehouse_room':_0xb6e36d(0xfa),'product_invoice':'$product.invoice','invoice':_0xb6e36d(0xc4),'id_transaction_from':_0xb6e36d(0x103),'date':_0xb6e36d(0x101),'production_date':_0xb6e36d(0xe8),'expiry_date':_0xb6e36d(0x105),'UOM':'$product.unit'}}]);_0x41480c[_0xb6e36d(0xe4)]>0x0&&_0x19412e['data_adjustment'][_0x4b0dd6['invoice']][_0xb6e36d(0xb2)](..._0x41480c);}));})),_0x19412e['data_transfer']={},await Promise[_0x2b609f(0xf0)](_0x19412e['map'](async _0x1945c1=>{var _0x44319c=_0x2b609f;_0x19412e[_0x44319c(0x9f)][_0x1945c1[_0x44319c(0xf7)]]=[],await Promise['all'](_0x1945c1['warehouse_data'][_0x44319c(0xd1)](async _0x1d38af=>{var _0x102956=_0x44319c;const _0x5f30fb=await transfers_finished[_0x102956(0xd9)]([{'$unwind':_0x102956(0xbc)},{'$match':{'product.id_transaction':_0x1d38af[_0x102956(0xb9)][_0x102956(0xa5)](),'product.from_invoice':_0x1d38af[_0x102956(0xf7)]}},{'$project':{'_id':_0x102956(0xdf),'product_name':_0x102956(0xd0),'product_code':_0x102956(0xdd),'quantity_available':_0x102956(0x9b),'warehouse_name':_0x102956(0xde),'warehouse_room':'$product.room_names','product_invoice':_0x102956(0xe1),'invoice':_0x102956(0xc4),'id_transaction_from':_0x102956(0xd7),'date':_0x102956(0x101),'production_date':_0x102956(0xe8),'expiry_date':_0x102956(0x105),'UOM':'$product.unit'}}]);_0x5f30fb[_0x102956(0xe4)]>0x0&&_0x19412e[_0x102956(0x9f)][_0x1945c1[_0x102956(0xf7)]]['push'](..._0x5f30fb);}));})),_0x56d49b[_0x2b609f(0xa9)]({'purchases_warehouse':_0x19412e,'data_sales':_0x19412e[_0x2b609f(0xcd)],'data_adjustment':_0x19412e[_0x2b609f(0xda)],'data_transfer':_0x19412e['data_transfer']});}}}),router[a0_0x3b5d07(0xb3)](a0_0x3b5d07(0x9d),auth,async(_0x2557f0,_0x2b22f7)=>{var _0x71b0c1=a0_0x3b5d07;try{const _0x149d8b=_0x2557f0[_0x71b0c1(0xdc)]['id'];var _0x279fd5=await purchases_finished[_0x71b0c1(0x106)](_0x149d8b);const _0x5a8851=await master_shop['find'](),_0x2f14a7=_0x2557f0[_0x71b0c1(0xf4)],_0x56c7ac=await profile[_0x71b0c1(0xc1)]({'email':_0x2f14a7['email']});if(_0x5a8851[0x0][_0x71b0c1(0xf3)]==_0x71b0c1(0xdb))var _0x2f3f45=users['English'];else{if(_0x5a8851[0x0][_0x71b0c1(0xf3)]=='Hindi')var _0x2f3f45=users[_0x71b0c1(0xc7)];else{if(_0x5a8851[0x0][_0x71b0c1(0xf3)]=='German')var _0x2f3f45=users['German'];else{if(_0x5a8851[0x0][_0x71b0c1(0xf3)]==_0x71b0c1(0xe5))var _0x2f3f45=users[_0x71b0c1(0xe5)];else{if(_0x5a8851[0x0][_0x71b0c1(0xf3)]=='French')var _0x2f3f45=users[_0x71b0c1(0xeb)];else{if(_0x5a8851[0x0][_0x71b0c1(0xf3)]==_0x71b0c1(0xe9))var _0x2f3f45=users[_0x71b0c1(0x108)];else{if(_0x5a8851[0x0]['language']==_0x71b0c1(0xba))var _0x2f3f45=users[_0x71b0c1(0xba)];else{if(_0x5a8851[0x0][_0x71b0c1(0xf3)]==_0x71b0c1(0xe0))var _0x2f3f45=users['Arabic'];}}}}}}}_0x2b22f7[_0x71b0c1(0xed)](_0x71b0c1(0x100),{'success':_0x2557f0[_0x71b0c1(0xf6)]('success'),'errors':_0x2557f0[_0x71b0c1(0xf6)]('errors'),'master_shop':_0x5a8851,'profile':_0x56c7ac,'role':_0x2f14a7,'language':_0x2f3f45,'data':_0x279fd5});}catch(_0x3c14b7){_0x2b22f7[_0x71b0c1(0xa9)](_0x3c14b7);}}),router[a0_0x3b5d07(0xb3)](a0_0x3b5d07(0xfe),auth,async(_0x2a0cfa,_0x15dc33)=>{var _0x46e762=a0_0x3b5d07;try{const _0x4e3bd7=_0x2a0cfa[_0x46e762(0xdc)]['id'];var _0x22d109=await sales_finished[_0x46e762(0x106)](_0x4e3bd7);const _0x232a3f=await master_shop[_0x46e762(0xf8)](),_0x1c9832=_0x2a0cfa[_0x46e762(0xf4)],_0x3d7643=await profile[_0x46e762(0xc1)]({'email':_0x1c9832['email']});if(_0x232a3f[0x0][_0x46e762(0xf3)]==_0x46e762(0xdb))var _0x1b58e9=users[_0x46e762(0xcc)];else{if(_0x232a3f[0x0][_0x46e762(0xf3)]==_0x46e762(0xc7))var _0x1b58e9=users[_0x46e762(0xc7)];else{if(_0x232a3f[0x0][_0x46e762(0xf3)]=='German')var _0x1b58e9=users[_0x46e762(0xf9)];else{if(_0x232a3f[0x0][_0x46e762(0xf3)]==_0x46e762(0xe5))var _0x1b58e9=users[_0x46e762(0xe5)];else{if(_0x232a3f[0x0][_0x46e762(0xf3)]==_0x46e762(0xeb))var _0x1b58e9=users['French'];else{if(_0x232a3f[0x0][_0x46e762(0xf3)]==_0x46e762(0xe9))var _0x1b58e9=users[_0x46e762(0x108)];else{if(_0x232a3f[0x0][_0x46e762(0xf3)]==_0x46e762(0xba))var _0x1b58e9=users[_0x46e762(0xba)];else{if(_0x232a3f[0x0][_0x46e762(0xf3)]==_0x46e762(0xe0))var _0x1b58e9=users[_0x46e762(0xe6)];}}}}}}}_0x15dc33['render'](_0x46e762(0xbe),{'success':_0x2a0cfa[_0x46e762(0xf6)](_0x46e762(0xee)),'errors':_0x2a0cfa[_0x46e762(0xf6)](_0x46e762(0xfc)),'master_shop':_0x232a3f,'profile':_0x3d7643,'role':_0x1c9832,'language':_0x1b58e9,'data':_0x22d109});}catch(_0x1f31d3){_0x15dc33[_0x46e762(0xa9)](_0x1f31d3);}}),router['get'](a0_0x3b5d07(0x10a),auth,async(_0x302460,_0x76bd10)=>{var _0x18889f=a0_0x3b5d07;try{const _0x389577=_0x302460[_0x18889f(0xdc)]['id'];var _0x40bdab=await transfers_finished[_0x18889f(0x106)](_0x389577);const _0x7079e=await master_shop[_0x18889f(0xf8)](),_0x642f68=_0x302460[_0x18889f(0xf4)],_0x3f60cb=await profile['findOne']({'email':_0x642f68[_0x18889f(0xa0)]});if(_0x7079e[0x0][_0x18889f(0xf3)]==_0x18889f(0xdb))var _0x5f122d=users[_0x18889f(0xcc)];else{if(_0x7079e[0x0]['language']==_0x18889f(0xc7))var _0x5f122d=users['Hindi'];else{if(_0x7079e[0x0][_0x18889f(0xf3)]==_0x18889f(0xf9))var _0x5f122d=users[_0x18889f(0xf9)];else{if(_0x7079e[0x0][_0x18889f(0xf3)]==_0x18889f(0xe5))var _0x5f122d=users[_0x18889f(0xe5)];else{if(_0x7079e[0x0][_0x18889f(0xf3)]==_0x18889f(0xeb))var _0x5f122d=users['French'];else{if(_0x7079e[0x0][_0x18889f(0xf3)]=='Portuguese\x20(BR)')var _0x5f122d=users[_0x18889f(0x108)];else{if(_0x7079e[0x0][_0x18889f(0xf3)]=='Chinese')var _0x5f122d=users[_0x18889f(0xba)];else{if(_0x7079e[0x0][_0x18889f(0xf3)]=='Arabic\x20(ae)')var _0x5f122d=users[_0x18889f(0xe6)];}}}}}}}_0x76bd10[_0x18889f(0xed)](_0x18889f(0xf5),{'success':_0x302460[_0x18889f(0xf6)](_0x18889f(0xee)),'errors':_0x302460['flash'](_0x18889f(0xfc)),'master_shop':_0x7079e,'profile':_0x3f60cb,'role':_0x642f68,'language':_0x5f122d,'data':_0x40bdab});}catch(_0x5b24fd){_0x76bd10[_0x18889f(0xa9)](_0x5b24fd);}}),router[a0_0x3b5d07(0xb3)]('/viewFG',auth,async(_0x511a70,_0x2b1d13)=>{var _0x2aa198=a0_0x3b5d07;try{const {username:_0x420df0,email:_0x28778e,role:_0x3b266c}=_0x511a70[_0x2aa198(0xf4)],_0x63ef72=_0x511a70['user'],_0x5ac243=await profile[_0x2aa198(0xc1)]({'email':_0x63ef72[_0x2aa198(0xa0)]}),_0x313405=await master_shop[_0x2aa198(0xf8)](),_0x578f44=await warehouse[_0x2aa198(0xd9)]([{'$match':{'status':'Enabled','warehouse_category':_0x2aa198(0xf1)}},{'$group':{'_id':_0x2aa198(0xec),'name':{'$first':_0x2aa198(0xec)}}}]);if(_0x313405[0x0][_0x2aa198(0xf3)]==_0x2aa198(0xdb))var _0x11311c=users[_0x2aa198(0xcc)];else{if(_0x313405[0x0]['language']==_0x2aa198(0xc7))var _0x11311c=users[_0x2aa198(0xc7)];else{if(_0x313405[0x0][_0x2aa198(0xf3)]==_0x2aa198(0xf9))var _0x11311c=users[_0x2aa198(0xf9)];else{if(_0x313405[0x0][_0x2aa198(0xf3)]==_0x2aa198(0xe5))var _0x11311c=users[_0x2aa198(0xe5)];else{if(_0x313405[0x0][_0x2aa198(0xf3)]==_0x2aa198(0xeb))var _0x11311c=users[_0x2aa198(0xeb)];else{if(_0x313405[0x0][_0x2aa198(0xf3)]==_0x2aa198(0xe9))var _0x11311c=users[_0x2aa198(0x108)];else{if(_0x313405[0x0][_0x2aa198(0xf3)]==_0x2aa198(0xba))var _0x11311c=users[_0x2aa198(0xba)];else{if(_0x313405[0x0]['language']==_0x2aa198(0xe0))var _0x11311c=users[_0x2aa198(0xe6)];}}}}}}}_0x2b1d13[_0x2aa198(0xed)](_0x2aa198(0xa8),{'success':_0x511a70[_0x2aa198(0xf6)](_0x2aa198(0xee)),'errors':_0x511a70[_0x2aa198(0xf6)](_0x2aa198(0xfc)),'role':_0x63ef72,'profile':_0x5ac243,'master_shop':_0x313405,'dataProcess':_0x578f44,'language':_0x11311c});}catch(_0x511c4e){console[_0x2aa198(0xd3)](_0x511c4e);}}),module[a0_0x3b5d07(0xaf)]=router;