function a0_0x4f72(_0x727cb0,_0x258605){var _0x1c1b33=a0_0x1c1b();return a0_0x4f72=function(_0x4f72ec,_0x27f182){_0x4f72ec=_0x4f72ec-0x191;var _0x57c81f=_0x1c1b33[_0x4f72ec];return _0x57c81f;},a0_0x4f72(_0x727cb0,_0x258605);}var a0_0x33e13d=a0_0x4f72;(function(_0x413c08,_0x5e416e){var _0xa20727=a0_0x4f72,_0x92c2d0=_0x413c08();while(!![]){try{var _0x37e425=parseInt(_0xa20727(0x192))/0x1+-parseInt(_0xa20727(0x1d0))/0x2+-parseInt(_0xa20727(0x1ac))/0x3+-parseInt(_0xa20727(0x1ab))/0x4*(-parseInt(_0xa20727(0x1ef))/0x5)+-parseInt(_0xa20727(0x1be))/0x6*(parseInt(_0xa20727(0x1f7))/0x7)+-parseInt(_0xa20727(0x1e9))/0x8+parseInt(_0xa20727(0x1f5))/0x9;if(_0x37e425===_0x5e416e)break;else _0x92c2d0['push'](_0x92c2d0['shift']());}catch(_0x3d9f20){_0x92c2d0['push'](_0x92c2d0['shift']());}}}(a0_0x1c1b,0x922c5));const express=require(a0_0x33e13d(0x1a1)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x33e13d(0x1ee)),auth=require(a0_0x33e13d(0x1bb)),users=require(a0_0x33e13d(0x1a4)),nodemailer=require(a0_0x33e13d(0x1cd));router['get'](a0_0x33e13d(0x1e0),auth,async(_0x16c771,_0x18a990)=>{var _0x3a1a42=a0_0x33e13d;try{const {username:_0x54ca7e,email:_0x170cbf,role:_0x418b6c}=_0x16c771[_0x3a1a42(0x1d2)],_0x18d178=_0x16c771[_0x3a1a42(0x1d2)],_0x491c39=await profile['findOne']({'email':_0x18d178[_0x3a1a42(0x1b3)]}),_0x43a3d7=await master_shop['find'](),_0x410754=await warehouse[_0x3a1a42(0x1d3)]([{'$match':{'status':_0x3a1a42(0x194),'warehouse_category':_0x3a1a42(0x199)}},{'$group':{'_id':_0x3a1a42(0x1ca),'name':{'$first':_0x3a1a42(0x1ca)}}}]);if(_0x43a3d7[0x0][_0x3a1a42(0x19c)]==_0x3a1a42(0x1b5))var _0x2a8f2d=users[_0x3a1a42(0x1dc)];else{if(_0x43a3d7[0x0][_0x3a1a42(0x19c)]==_0x3a1a42(0x1cf))var _0x2a8f2d=users[_0x3a1a42(0x1cf)];else{if(_0x43a3d7[0x0][_0x3a1a42(0x19c)]==_0x3a1a42(0x198))var _0x2a8f2d=users[_0x3a1a42(0x198)];else{if(_0x43a3d7[0x0][_0x3a1a42(0x19c)]==_0x3a1a42(0x1dd))var _0x2a8f2d=users[_0x3a1a42(0x1dd)];else{if(_0x43a3d7[0x0]['language']==_0x3a1a42(0x19d))var _0x2a8f2d=users[_0x3a1a42(0x19d)];else{if(_0x43a3d7[0x0][_0x3a1a42(0x19c)]==_0x3a1a42(0x1d8))var _0x2a8f2d=users[_0x3a1a42(0x1e6)];else{if(_0x43a3d7[0x0]['language']==_0x3a1a42(0x1f4))var _0x2a8f2d=users[_0x3a1a42(0x1f4)];else{if(_0x43a3d7[0x0][_0x3a1a42(0x19c)]==_0x3a1a42(0x1bd))var _0x2a8f2d=users[_0x3a1a42(0x1a9)];}}}}}}}_0x18a990[_0x3a1a42(0x1d4)](_0x3a1a42(0x193),{'success':_0x16c771[_0x3a1a42(0x1d1)]('success'),'errors':_0x16c771[_0x3a1a42(0x1d1)](_0x3a1a42(0x1e1)),'role':_0x18d178,'profile':_0x491c39,'master_shop':_0x43a3d7,'dataProcess':_0x410754,'language':_0x2a8f2d});}catch(_0x1e3b25){console[_0x3a1a42(0x1ea)](_0x1e3b25);}}),router[a0_0x33e13d(0x1ba)](a0_0x33e13d(0x1c3),auth,async(_0x155606,_0x17c96b)=>{var _0x11262c=a0_0x33e13d;const {product_category:_0x34b388,transaction_category:_0x2abeb8,transaction_date_from:_0x3bb011,transaction_date_to:_0x5cd2f6,warehouse_category:_0x5171cc,item_code:_0x181c67}=_0x155606[_0x11262c(0x1e4)];console['log'](_0x5171cc);if(_0x34b388=='rm'){if(_0x5171cc=='all'){var _0x3b9fac=await purchases[_0x11262c(0x1d3)]([{'$match':{'date':{'$gte':_0x3bb011,'$lte':_0x5cd2f6}}},{'$lookup':{'from':_0x11262c(0x1e7),'let':{'invoice':_0x11262c(0x1b1)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x11262c(0x1ce),_0x11262c(0x1fb)]}}},{'$project':{'_id':_0x11262c(0x1fd),'product_name':'$product_details.product_name','product_code':_0x11262c(0x1d5),'quantity_available':_0x11262c(0x1f2),'warehouse_name':_0x11262c(0x1ca),'warehouse_room':_0x11262c(0x1fc),'invoice':_0x11262c(0x1fb),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x11262c(0x1de)}}],'as':_0x11262c(0x1a7)}}]);_0x3b9fac[_0x11262c(0x1b9)]={},await Promise[_0x11262c(0x19b)](_0x3b9fac[_0x11262c(0x19a)](async _0x4052b7=>{var _0x587d50=_0x11262c;_0x3b9fac['data_sales'][_0x4052b7[_0x587d50(0x1ae)]]=[],await Promise['all'](_0x4052b7[_0x587d50(0x1a7)][_0x587d50(0x19a)](async _0x2c7e62=>{var _0xe7f0f9=_0x587d50;const _0x146129=await sales[_0xe7f0f9(0x1d3)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x2c7e62[_0xe7f0f9(0x1a2)][_0xe7f0f9(0x1b0)](),'sale_product.invoice':_0x2c7e62['invoice']}},{'$project':{'_id':_0xe7f0f9(0x19f),'product_name':_0xe7f0f9(0x1ad),'product_code':_0xe7f0f9(0x1db),'quantity_available':_0xe7f0f9(0x1f9),'warehouse_name':'$warehouse_name','warehouse_room':_0xe7f0f9(0x1a8),'product_invoice':_0xe7f0f9(0x1d9),'invoice':_0xe7f0f9(0x1b1),'id_transaction_from':'$sale_product.id_transaction_from','date':_0xe7f0f9(0x1f1),'production_date':_0xe7f0f9(0x1f3),'expiry_date':_0xe7f0f9(0x1b2),'UOM':_0xe7f0f9(0x1a5)}}]);_0x146129[_0xe7f0f9(0x1c6)]>0x0&&_0x3b9fac[_0xe7f0f9(0x1b9)][_0x4052b7[_0xe7f0f9(0x1ae)]][_0xe7f0f9(0x1b4)](..._0x146129);}));})),_0x3b9fac[_0x11262c(0x1b9)]=_0x3b9fac['data_sales'],_0x3b9fac[_0x11262c(0x1c2)]={},await Promise[_0x11262c(0x19b)](_0x3b9fac[_0x11262c(0x19a)](async _0x33f47b=>{var _0x103d1b=_0x11262c;_0x3b9fac[_0x103d1b(0x1c2)][_0x33f47b[_0x103d1b(0x1ae)]]=[],await Promise['all'](_0x33f47b[_0x103d1b(0x1a7)][_0x103d1b(0x19a)](async _0x275a41=>{var _0x23ff0f=_0x103d1b;const _0x3bea05=await adjustment['aggregate']([{'$unwind':_0x23ff0f(0x19e)},{'$match':{'product.id_transaction_from':_0x275a41[_0x23ff0f(0x1a2)][_0x23ff0f(0x1b0)](),'product.invoice':_0x275a41[_0x23ff0f(0x1ae)]}},{'$project':{'_id':_0x23ff0f(0x1bc),'product_name':_0x23ff0f(0x1f0),'product_code':'$product.product_code','quantity_available':_0x23ff0f(0x1ec),'warehouse_name':_0x23ff0f(0x1b6),'warehouse_room':_0x23ff0f(0x1bf),'product_invoice':_0x23ff0f(0x1c4),'invoice':'$invoice','id_transaction_from':_0x23ff0f(0x195),'date':_0x23ff0f(0x1f1),'production_date':'$product.production_date','expiry_date':_0x23ff0f(0x197),'UOM':'$product.unit'}}]);_0x3bea05[_0x23ff0f(0x1c6)]>0x0&&_0x3b9fac[_0x23ff0f(0x1c2)][_0x33f47b[_0x23ff0f(0x1ae)]][_0x23ff0f(0x1b4)](..._0x3bea05);}));})),_0x3b9fac[_0x11262c(0x1cb)]={},await Promise[_0x11262c(0x19b)](_0x3b9fac[_0x11262c(0x19a)](async _0x217415=>{var _0x1d4f1c=_0x11262c;_0x3b9fac['data_transfer'][_0x217415[_0x1d4f1c(0x1ae)]]=[],await Promise['all'](_0x217415[_0x1d4f1c(0x1a7)][_0x1d4f1c(0x19a)](async _0x5c51b2=>{var _0x31d554=_0x1d4f1c;const _0xb296bd=await transfers[_0x31d554(0x1d3)]([{'$unwind':_0x31d554(0x19e)},{'$match':{'product.id_transaction_id':_0x5c51b2[_0x31d554(0x1a2)][_0x31d554(0x1b0)](),'product.To_invoice':_0x5c51b2[_0x31d554(0x1ae)]}},{'$project':{'_id':_0x31d554(0x1bc),'product_name':_0x31d554(0x1f0),'product_code':_0x31d554(0x1b8),'quantity_available':'$product.to_quantity','warehouse_name':'$to_warehouse','warehouse_room':'$product.room_names','product_invoice':_0x31d554(0x191),'invoice':_0x31d554(0x1b1),'id_transaction_from':_0x31d554(0x1df),'date':_0x31d554(0x1f1),'production_date':_0x31d554(0x1ed),'expiry_date':_0x31d554(0x197),'UOM':'$product.unit'}}]);_0xb296bd['length']>0x0&&_0x3b9fac['data_transfer'][_0x217415[_0x31d554(0x1ae)]][_0x31d554(0x1b4)](..._0xb296bd);}));})),_0x17c96b[_0x11262c(0x1d7)]({'purchases_warehouse':_0x3b9fac,'data_sales':_0x3b9fac[_0x11262c(0x1b9)],'data_adjustment':_0x3b9fac[_0x11262c(0x1c2)],'data_transfer':_0x3b9fac[_0x11262c(0x1cb)]});}else{var _0x3b9fac=await purchases[_0x11262c(0x1d3)]([{'$match':{'warehouse_name':_0x5171cc,'date':{'$gte':_0x3bb011,'$lte':_0x5cd2f6}}},{'$lookup':{'from':_0x11262c(0x1e7),'let':{'invoice':_0x11262c(0x1b1)},'pipeline':[{'$unwind':_0x11262c(0x1e8)},{'$match':{'$expr':{'$eq':[_0x11262c(0x1ce),_0x11262c(0x1fb)]}}},{'$project':{'_id':_0x11262c(0x1fd),'product_name':_0x11262c(0x1af),'product_code':_0x11262c(0x1d5),'quantity_available':_0x11262c(0x1f2),'warehouse_name':_0x11262c(0x1ca),'warehouse_room':_0x11262c(0x1fc),'invoice':_0x11262c(0x1fb),'production_date':_0x11262c(0x1c0),'expiry_date':_0x11262c(0x1f8),'UOM':_0x11262c(0x1de)}}],'as':_0x11262c(0x1a7)}}]);_0x3b9fac[_0x11262c(0x1b9)]={},await Promise[_0x11262c(0x19b)](_0x3b9fac['map'](async _0x392b29=>{var _0x3ac2c0=_0x11262c;_0x3b9fac[_0x3ac2c0(0x1b9)][_0x392b29[_0x3ac2c0(0x1ae)]]=[],await Promise[_0x3ac2c0(0x19b)](_0x392b29[_0x3ac2c0(0x1a7)][_0x3ac2c0(0x19a)](async _0x1b2695=>{var _0x3bf970=_0x3ac2c0;const _0x428543=await sales['aggregate']([{'$unwind':_0x3bf970(0x1c5)},{'$match':{'sale_product.id_transaction_from':_0x1b2695[_0x3bf970(0x1a2)]['valueOf'](),'sale_product.invoice':_0x1b2695['invoice']}},{'$project':{'_id':_0x3bf970(0x19f),'product_name':_0x3bf970(0x1ad),'product_code':_0x3bf970(0x1db),'quantity_available':_0x3bf970(0x1f9),'warehouse_name':_0x3bf970(0x1b6),'warehouse_room':'$sale_product.room_name','product_invoice':_0x3bf970(0x1d9),'invoice':_0x3bf970(0x1b1),'id_transaction_from':_0x3bf970(0x1f6),'date':'$date','production_date':_0x3bf970(0x1f3),'expiry_date':_0x3bf970(0x1b2),'UOM':_0x3bf970(0x1a5)}}]);_0x428543[_0x3bf970(0x1c6)]>0x0&&_0x3b9fac[_0x3bf970(0x1b9)][_0x392b29[_0x3bf970(0x1ae)]]['push'](..._0x428543);}));})),_0x3b9fac[_0x11262c(0x1b9)]=_0x3b9fac['data_sales'],_0x3b9fac[_0x11262c(0x1c2)]={},await Promise['all'](_0x3b9fac[_0x11262c(0x19a)](async _0x3a4b65=>{var _0x35bf57=_0x11262c;_0x3b9fac[_0x35bf57(0x1c2)][_0x3a4b65['invoice']]=[],await Promise[_0x35bf57(0x19b)](_0x3a4b65[_0x35bf57(0x1a7)][_0x35bf57(0x19a)](async _0x2139a3=>{var _0x3ebea2=_0x35bf57;const _0x5eec0c=await adjustment[_0x3ebea2(0x1d3)]([{'$unwind':_0x3ebea2(0x19e)},{'$match':{'product.id_transaction_from':_0x2139a3['_id'][_0x3ebea2(0x1b0)](),'product.invoice':_0x2139a3[_0x3ebea2(0x1ae)]}},{'$project':{'_id':'$product._id','product_name':_0x3ebea2(0x1f0),'product_code':'$product.product_code','quantity_available':_0x3ebea2(0x1ec),'warehouse_name':_0x3ebea2(0x1b6),'warehouse_room':_0x3ebea2(0x1bf),'product_invoice':_0x3ebea2(0x1c4),'invoice':_0x3ebea2(0x1b1),'id_transaction_from':'$product.id_transaction_from','date':_0x3ebea2(0x1f1),'production_date':_0x3ebea2(0x1ed),'expiry_date':_0x3ebea2(0x197),'UOM':_0x3ebea2(0x1e3)}}]);_0x5eec0c[_0x3ebea2(0x1c6)]>0x0&&_0x3b9fac[_0x3ebea2(0x1c2)][_0x3a4b65[_0x3ebea2(0x1ae)]]['push'](..._0x5eec0c);}));})),_0x3b9fac['data_transfer']={},await Promise['all'](_0x3b9fac[_0x11262c(0x19a)](async _0x5a23ca=>{var _0x1031bc=_0x11262c;_0x3b9fac[_0x1031bc(0x1cb)][_0x5a23ca[_0x1031bc(0x1ae)]]=[],await Promise[_0x1031bc(0x19b)](_0x5a23ca[_0x1031bc(0x1a7)][_0x1031bc(0x19a)](async _0x511ec1=>{var _0x407dcf=_0x1031bc;const _0x276992=await transfers[_0x407dcf(0x1d3)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x511ec1[_0x407dcf(0x1a2)][_0x407dcf(0x1b0)](),'product.To_invoice':_0x511ec1[_0x407dcf(0x1ae)]}},{'$project':{'_id':'$product._id','product_name':_0x407dcf(0x1f0),'product_code':_0x407dcf(0x1b8),'quantity_available':_0x407dcf(0x1a6),'warehouse_name':'$to_warehouse','warehouse_room':_0x407dcf(0x1bf),'product_invoice':_0x407dcf(0x191),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_id','date':_0x407dcf(0x1f1),'production_date':_0x407dcf(0x1ed),'expiry_date':_0x407dcf(0x197),'UOM':_0x407dcf(0x1e3)}}]);_0x276992[_0x407dcf(0x1c6)]>0x0&&_0x3b9fac[_0x407dcf(0x1cb)][_0x5a23ca[_0x407dcf(0x1ae)]]['push'](..._0x276992);}));})),_0x17c96b[_0x11262c(0x1d7)]({'purchases_warehouse':_0x3b9fac,'data_sales':_0x3b9fac['data_sales'],'data_adjustment':_0x3b9fac['data_adjustment'],'data_transfer':_0x3b9fac[_0x11262c(0x1cb)]});}}else{if(_0x5171cc=='all'){var _0x3b9fac=await purchases_finished[_0x11262c(0x1d3)]([{'$match':{'date':{'$gte':_0x3bb011,'$lte':_0x5cd2f6}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x11262c(0x1b1)},'pipeline':[{'$unwind':_0x11262c(0x1e8)},{'$match':{'$expr':{'$eq':[_0x11262c(0x1ce),_0x11262c(0x1fb)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x11262c(0x1af),'product_code':_0x11262c(0x1d5),'quantity_available':_0x11262c(0x1f2),'warehouse_name':'$name','warehouse_room':_0x11262c(0x1fc),'invoice':_0x11262c(0x1fb),'production_date':_0x11262c(0x1c0),'expiry_date':'$product_details.expiry_date','UOM':_0x11262c(0x1de)}}],'as':_0x11262c(0x1a7)}}]);_0x3b9fac['data_sales']={},await Promise[_0x11262c(0x19b)](_0x3b9fac['map'](async _0x255e8e=>{var _0x67f781=_0x11262c;_0x3b9fac[_0x67f781(0x1b9)][_0x255e8e[_0x67f781(0x1ae)]]=[],await Promise[_0x67f781(0x19b)](_0x255e8e[_0x67f781(0x1a7)]['map'](async _0x20e82e=>{var _0x2ee2a3=_0x67f781;const _0x2361bd=await sales_finished['aggregate']([{'$unwind':_0x2ee2a3(0x1c5)},{'$match':{'sale_product.id_transaction_from':_0x20e82e[_0x2ee2a3(0x1a2)]['valueOf'](),'sale_product.invoice':_0x20e82e[_0x2ee2a3(0x1ae)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x2ee2a3(0x1ad),'product_code':_0x2ee2a3(0x1db),'quantity_available':_0x2ee2a3(0x1f9),'warehouse_name':'$warehouse_name','warehouse_room':_0x2ee2a3(0x1a8),'product_invoice':_0x2ee2a3(0x1d9),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0x2ee2a3(0x1f1),'production_date':_0x2ee2a3(0x1f3),'expiry_date':'$sale_product.expiry_date','UOM':_0x2ee2a3(0x1a5)}}]);_0x2361bd['length']>0x0&&_0x3b9fac['data_sales'][_0x255e8e[_0x2ee2a3(0x1ae)]][_0x2ee2a3(0x1b4)](..._0x2361bd);}));})),_0x3b9fac[_0x11262c(0x1b9)]=_0x3b9fac['data_sales'],_0x3b9fac[_0x11262c(0x1c2)]={},await Promise['all'](_0x3b9fac[_0x11262c(0x19a)](async _0x3dc1df=>{var _0x45f5de=_0x11262c;_0x3b9fac[_0x45f5de(0x1c2)][_0x3dc1df[_0x45f5de(0x1ae)]]=[],await Promise[_0x45f5de(0x19b)](_0x3dc1df[_0x45f5de(0x1a7)][_0x45f5de(0x19a)](async _0x564fbd=>{var _0x613cba=_0x45f5de;const _0x49db36=await adjustment_finished['aggregate']([{'$unwind':_0x613cba(0x19e)},{'$match':{'product.id_transaction_from':_0x564fbd[_0x613cba(0x1a2)]['valueOf'](),'product.invoice':_0x564fbd[_0x613cba(0x1ae)]}},{'$project':{'_id':'$product._id','product_name':_0x613cba(0x1f0),'product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':_0x613cba(0x1b6),'warehouse_room':'$product.room_names','product_invoice':_0x613cba(0x1c4),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':_0x613cba(0x1f1),'production_date':_0x613cba(0x1ed),'expiry_date':_0x613cba(0x197),'UOM':'$product.unit'}}]);_0x49db36['length']>0x0&&_0x3b9fac['data_adjustment'][_0x3dc1df['invoice']][_0x613cba(0x1b4)](..._0x49db36);}));})),_0x3b9fac[_0x11262c(0x1cb)]={},await Promise[_0x11262c(0x19b)](_0x3b9fac[_0x11262c(0x19a)](async _0x48ef60=>{var _0x115cee=_0x11262c;_0x3b9fac[_0x115cee(0x1cb)][_0x48ef60[_0x115cee(0x1ae)]]=[],await Promise['all'](_0x48ef60['warehouse_data']['map'](async _0x5b5051=>{var _0x461348=_0x115cee;const _0x3ea92c=await transfers_finished[_0x461348(0x1d3)]([{'$unwind':_0x461348(0x19e)},{'$match':{'product.id_transaction':_0x5b5051['_id']['valueOf'](),'product.from_invoice':_0x5b5051[_0x461348(0x1ae)]}},{'$project':{'_id':'$product._id','product_name':_0x461348(0x1f0),'product_code':'$product.product_code','quantity_available':_0x461348(0x1a6),'warehouse_name':_0x461348(0x1d6),'warehouse_room':_0x461348(0x1bf),'product_invoice':_0x461348(0x191),'invoice':'$invoice','id_transaction_from':_0x461348(0x1c9),'date':'$date','production_date':_0x461348(0x1ed),'expiry_date':_0x461348(0x197),'UOM':_0x461348(0x1e3)}}]);_0x3ea92c['length']>0x0&&_0x3b9fac[_0x461348(0x1cb)][_0x48ef60['invoice']][_0x461348(0x1b4)](..._0x3ea92c);}));})),_0x17c96b['json']({'purchases_warehouse':_0x3b9fac,'data_sales':_0x3b9fac[_0x11262c(0x1b9)],'data_adjustment':_0x3b9fac['data_adjustment'],'data_transfer':_0x3b9fac['data_transfer']});}else{var _0x3b9fac=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x5171cc,'date':{'$gte':_0x3bb011,'$lte':_0x5cd2f6}}},{'$lookup':{'from':_0x11262c(0x1e7),'let':{'invoice':_0x11262c(0x1b1)},'pipeline':[{'$unwind':_0x11262c(0x1e8)},{'$match':{'$expr':{'$eq':[_0x11262c(0x1ce),'$product_details.invoice']}}},{'$project':{'_id':'$product_details._id','product_name':_0x11262c(0x1af),'product_code':_0x11262c(0x1d5),'quantity_available':_0x11262c(0x1f2),'warehouse_name':_0x11262c(0x1ca),'warehouse_room':_0x11262c(0x1fc),'invoice':'$product_details.invoice','production_date':_0x11262c(0x1c0),'expiry_date':_0x11262c(0x1f8),'UOM':_0x11262c(0x1de)}}],'as':'warehouse_data'}}]);_0x3b9fac[_0x11262c(0x1b9)]={},await Promise[_0x11262c(0x19b)](_0x3b9fac[_0x11262c(0x19a)](async _0x1d52b9=>{var _0x46ccde=_0x11262c;_0x3b9fac[_0x46ccde(0x1b9)][_0x1d52b9['invoice']]=[],await Promise[_0x46ccde(0x19b)](_0x1d52b9[_0x46ccde(0x1a7)]['map'](async _0x3912da=>{var _0x59bc62=_0x46ccde;const _0x51b2ca=await sales_finished['aggregate']([{'$unwind':_0x59bc62(0x1c5)},{'$match':{'sale_product.id_transaction_from':_0x3912da[_0x59bc62(0x1a2)][_0x59bc62(0x1b0)](),'sale_product.invoice':_0x3912da[_0x59bc62(0x1ae)]}},{'$project':{'_id':_0x59bc62(0x19f),'product_name':'$sale_product.product_name','product_code':_0x59bc62(0x1db),'quantity_available':_0x59bc62(0x1f9),'warehouse_name':_0x59bc62(0x1b6),'warehouse_room':_0x59bc62(0x1a8),'product_invoice':_0x59bc62(0x1d9),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0x59bc62(0x1f1),'production_date':_0x59bc62(0x1f3),'expiry_date':_0x59bc62(0x1b2),'UOM':_0x59bc62(0x1a5)}}]);_0x51b2ca[_0x59bc62(0x1c6)]>0x0&&_0x3b9fac['data_sales'][_0x1d52b9['invoice']][_0x59bc62(0x1b4)](..._0x51b2ca);}));})),_0x3b9fac[_0x11262c(0x1b9)]=_0x3b9fac[_0x11262c(0x1b9)],_0x3b9fac[_0x11262c(0x1c2)]={},await Promise[_0x11262c(0x19b)](_0x3b9fac[_0x11262c(0x19a)](async _0x46618f=>{var _0xefd570=_0x11262c;_0x3b9fac[_0xefd570(0x1c2)][_0x46618f[_0xefd570(0x1ae)]]=[],await Promise[_0xefd570(0x19b)](_0x46618f['warehouse_data']['map'](async _0xe70f7f=>{var _0x226328=_0xefd570;const _0xcca049=await adjustment_finished[_0x226328(0x1d3)]([{'$unwind':_0x226328(0x19e)},{'$match':{'product.id_transaction_from':_0xe70f7f[_0x226328(0x1a2)][_0x226328(0x1b0)](),'product.invoice':_0xe70f7f[_0x226328(0x1ae)]}},{'$project':{'_id':'$product._id','product_name':_0x226328(0x1f0),'product_code':_0x226328(0x1b8),'quantity_available':_0x226328(0x1ec),'warehouse_name':_0x226328(0x1b6),'warehouse_room':_0x226328(0x1bf),'product_invoice':_0x226328(0x1c4),'invoice':_0x226328(0x1b1),'id_transaction_from':_0x226328(0x195),'date':_0x226328(0x1f1),'production_date':_0x226328(0x1ed),'expiry_date':_0x226328(0x197),'UOM':'$product.unit'}}]);_0xcca049['length']>0x0&&_0x3b9fac[_0x226328(0x1c2)][_0x46618f[_0x226328(0x1ae)]][_0x226328(0x1b4)](..._0xcca049);}));})),_0x3b9fac[_0x11262c(0x1cb)]={},await Promise[_0x11262c(0x19b)](_0x3b9fac['map'](async _0x1b3a36=>{var _0x50f9e2=_0x11262c;_0x3b9fac[_0x50f9e2(0x1cb)][_0x1b3a36[_0x50f9e2(0x1ae)]]=[],await Promise[_0x50f9e2(0x19b)](_0x1b3a36[_0x50f9e2(0x1a7)]['map'](async _0x343b02=>{var _0x1d9fa2=_0x50f9e2;const _0x1c0651=await transfers_finished['aggregate']([{'$unwind':_0x1d9fa2(0x19e)},{'$match':{'product.id_transaction':_0x343b02[_0x1d9fa2(0x1a2)]['valueOf'](),'product.from_invoice':_0x343b02[_0x1d9fa2(0x1ae)]}},{'$project':{'_id':'$product._id','product_name':_0x1d9fa2(0x1f0),'product_code':_0x1d9fa2(0x1b8),'quantity_available':'$product.to_quantity','warehouse_name':_0x1d9fa2(0x1d6),'warehouse_room':_0x1d9fa2(0x1bf),'product_invoice':_0x1d9fa2(0x191),'invoice':_0x1d9fa2(0x1b1),'id_transaction_from':_0x1d9fa2(0x1c9),'date':_0x1d9fa2(0x1f1),'production_date':_0x1d9fa2(0x1ed),'expiry_date':_0x1d9fa2(0x197),'UOM':_0x1d9fa2(0x1e3)}}]);_0x1c0651[_0x1d9fa2(0x1c6)]>0x0&&_0x3b9fac[_0x1d9fa2(0x1cb)][_0x1b3a36[_0x1d9fa2(0x1ae)]]['push'](..._0x1c0651);}));})),_0x17c96b[_0x11262c(0x1d7)]({'purchases_warehouse':_0x3b9fac,'data_sales':_0x3b9fac['data_sales'],'data_adjustment':_0x3b9fac[_0x11262c(0x1c2)],'data_transfer':_0x3b9fac[_0x11262c(0x1cb)]});}}}),router[a0_0x33e13d(0x1fa)](a0_0x33e13d(0x1a0),auth,async(_0x4a5c87,_0x26cd26)=>{var _0x4510ac=a0_0x33e13d;try{const _0x5cd6d2=_0x4a5c87['params']['id'];var _0x519ef8=await purchases_finished[_0x4510ac(0x1c8)](_0x5cd6d2);const _0x260d58=await master_shop[_0x4510ac(0x1e2)](),_0x2b8b1c=_0x4a5c87[_0x4510ac(0x1d2)],_0x596a2c=await profile[_0x4510ac(0x1aa)]({'email':_0x2b8b1c[_0x4510ac(0x1b3)]});if(_0x260d58[0x0][_0x4510ac(0x19c)]==_0x4510ac(0x1b5))var _0x2e29ee=users[_0x4510ac(0x1dc)];else{if(_0x260d58[0x0]['language']=='Hindi')var _0x2e29ee=users[_0x4510ac(0x1cf)];else{if(_0x260d58[0x0]['language']==_0x4510ac(0x198))var _0x2e29ee=users[_0x4510ac(0x198)];else{if(_0x260d58[0x0][_0x4510ac(0x19c)]==_0x4510ac(0x1dd))var _0x2e29ee=users[_0x4510ac(0x1dd)];else{if(_0x260d58[0x0][_0x4510ac(0x19c)]=='French')var _0x2e29ee=users[_0x4510ac(0x19d)];else{if(_0x260d58[0x0][_0x4510ac(0x19c)]==_0x4510ac(0x1d8))var _0x2e29ee=users['Portuguese'];else{if(_0x260d58[0x0][_0x4510ac(0x19c)]==_0x4510ac(0x1f4))var _0x2e29ee=users[_0x4510ac(0x1f4)];else{if(_0x260d58[0x0][_0x4510ac(0x19c)]=='Arabic\x20(ae)')var _0x2e29ee=users[_0x4510ac(0x1a9)];}}}}}}}_0x26cd26['render'](_0x4510ac(0x1c7),{'success':_0x4a5c87[_0x4510ac(0x1d1)](_0x4510ac(0x1da)),'errors':_0x4a5c87[_0x4510ac(0x1d1)](_0x4510ac(0x1e1)),'master_shop':_0x260d58,'profile':_0x596a2c,'role':_0x2b8b1c,'language':_0x2e29ee,'data':_0x519ef8});}catch(_0x2681cb){_0x26cd26[_0x4510ac(0x1d7)](_0x2681cb);}}),router[a0_0x33e13d(0x1fa)](a0_0x33e13d(0x1c1),auth,async(_0x442d0a,_0x116d58)=>{var _0x426273=a0_0x33e13d;try{const _0x283295=_0x442d0a[_0x426273(0x1cc)]['id'];var _0x4a5024=await sales_finished['findById'](_0x283295);const _0x32e70a=await master_shop[_0x426273(0x1e2)](),_0xe4f71c=_0x442d0a[_0x426273(0x1d2)],_0x5ef73d=await profile['findOne']({'email':_0xe4f71c[_0x426273(0x1b3)]});if(_0x32e70a[0x0][_0x426273(0x19c)]==_0x426273(0x1b5))var _0x2dadab=users['English'];else{if(_0x32e70a[0x0][_0x426273(0x19c)]=='Hindi')var _0x2dadab=users[_0x426273(0x1cf)];else{if(_0x32e70a[0x0][_0x426273(0x19c)]=='German')var _0x2dadab=users['German'];else{if(_0x32e70a[0x0][_0x426273(0x19c)]=='Spanish')var _0x2dadab=users[_0x426273(0x1dd)];else{if(_0x32e70a[0x0]['language']==_0x426273(0x19d))var _0x2dadab=users['French'];else{if(_0x32e70a[0x0][_0x426273(0x19c)]==_0x426273(0x1d8))var _0x2dadab=users[_0x426273(0x1e6)];else{if(_0x32e70a[0x0][_0x426273(0x19c)]==_0x426273(0x1f4))var _0x2dadab=users[_0x426273(0x1f4)];else{if(_0x32e70a[0x0][_0x426273(0x19c)]=='Arabic\x20(ae)')var _0x2dadab=users[_0x426273(0x1a9)];}}}}}}}_0x116d58['render'](_0x426273(0x1a3),{'success':_0x442d0a[_0x426273(0x1d1)](_0x426273(0x1da)),'errors':_0x442d0a[_0x426273(0x1d1)]('errors'),'master_shop':_0x32e70a,'profile':_0x5ef73d,'role':_0xe4f71c,'language':_0x2dadab,'data':_0x4a5024});}catch(_0x58a6c3){_0x116d58[_0x426273(0x1d7)](_0x58a6c3);}}),router[a0_0x33e13d(0x1fa)](a0_0x33e13d(0x1eb),auth,async(_0x30367d,_0x3a4d72)=>{var _0x42a852=a0_0x33e13d;try{const _0x244098=_0x30367d[_0x42a852(0x1cc)]['id'];var _0x2ce39e=await transfers_finished['findById'](_0x244098);const _0x4e8088=await master_shop[_0x42a852(0x1e2)](),_0x23e277=_0x30367d['user'],_0x345259=await profile['findOne']({'email':_0x23e277[_0x42a852(0x1b3)]});if(_0x4e8088[0x0]['language']==_0x42a852(0x1b5))var _0x2343b0=users[_0x42a852(0x1dc)];else{if(_0x4e8088[0x0][_0x42a852(0x19c)]==_0x42a852(0x1cf))var _0x2343b0=users[_0x42a852(0x1cf)];else{if(_0x4e8088[0x0][_0x42a852(0x19c)]=='German')var _0x2343b0=users[_0x42a852(0x198)];else{if(_0x4e8088[0x0][_0x42a852(0x19c)]==_0x42a852(0x1dd))var _0x2343b0=users[_0x42a852(0x1dd)];else{if(_0x4e8088[0x0][_0x42a852(0x19c)]=='French')var _0x2343b0=users[_0x42a852(0x19d)];else{if(_0x4e8088[0x0][_0x42a852(0x19c)]==_0x42a852(0x1d8))var _0x2343b0=users[_0x42a852(0x1e6)];else{if(_0x4e8088[0x0]['language']==_0x42a852(0x1f4))var _0x2343b0=users[_0x42a852(0x1f4)];else{if(_0x4e8088[0x0]['language']=='Arabic\x20(ae)')var _0x2343b0=users['Arabic'];}}}}}}}_0x3a4d72[_0x42a852(0x1d4)]('view_tf_table',{'success':_0x30367d[_0x42a852(0x1d1)]('success'),'errors':_0x30367d[_0x42a852(0x1d1)]('errors'),'master_shop':_0x4e8088,'profile':_0x345259,'role':_0x23e277,'language':_0x2343b0,'data':_0x2ce39e});}catch(_0x483b7c){_0x3a4d72[_0x42a852(0x1d7)](_0x483b7c);}}),router[a0_0x33e13d(0x1fa)](a0_0x33e13d(0x1b7),auth,async(_0x214368,_0x2874c0)=>{var _0x22f07a=a0_0x33e13d;try{const {username:_0x3b908b,email:_0x371244,role:_0x40d7a8}=_0x214368[_0x22f07a(0x1d2)],_0x2b454a=_0x214368[_0x22f07a(0x1d2)],_0x198027=await profile[_0x22f07a(0x1aa)]({'email':_0x2b454a[_0x22f07a(0x1b3)]}),_0x8047a2=await master_shop[_0x22f07a(0x1e2)](),_0x138120=await warehouse[_0x22f07a(0x1d3)]([{'$match':{'status':_0x22f07a(0x194),'warehouse_category':_0x22f07a(0x196)}},{'$group':{'_id':'$name','name':{'$first':_0x22f07a(0x1ca)}}}]);if(_0x8047a2[0x0][_0x22f07a(0x19c)]==_0x22f07a(0x1b5))var _0x6fde8d=users[_0x22f07a(0x1dc)];else{if(_0x8047a2[0x0][_0x22f07a(0x19c)]=='Hindi')var _0x6fde8d=users['Hindi'];else{if(_0x8047a2[0x0]['language']==_0x22f07a(0x198))var _0x6fde8d=users[_0x22f07a(0x198)];else{if(_0x8047a2[0x0][_0x22f07a(0x19c)]=='Spanish')var _0x6fde8d=users[_0x22f07a(0x1dd)];else{if(_0x8047a2[0x0][_0x22f07a(0x19c)]==_0x22f07a(0x19d))var _0x6fde8d=users[_0x22f07a(0x19d)];else{if(_0x8047a2[0x0][_0x22f07a(0x19c)]==_0x22f07a(0x1d8))var _0x6fde8d=users[_0x22f07a(0x1e6)];else{if(_0x8047a2[0x0][_0x22f07a(0x19c)]==_0x22f07a(0x1f4))var _0x6fde8d=users[_0x22f07a(0x1f4)];else{if(_0x8047a2[0x0][_0x22f07a(0x19c)]=='Arabic\x20(ae)')var _0x6fde8d=users['Arabic'];}}}}}}}_0x2874c0[_0x22f07a(0x1d4)](_0x22f07a(0x1fe),{'success':_0x214368['flash'](_0x22f07a(0x1da)),'errors':_0x214368['flash']('errors'),'role':_0x2b454a,'profile':_0x198027,'master_shop':_0x8047a2,'dataProcess':_0x138120,'language':_0x6fde8d});}catch(_0x5da9f2){console[_0x22f07a(0x1ea)](_0x5da9f2);}}),module[a0_0x33e13d(0x1e5)]=router;function a0_0x1c1b(){var _0x3c6c3f=['6125770SuobEx','$product_details.expiry_date','$sale_product.quantity','get','$product_details.invoice','$room','$product_details._id','transaction_finished_raw','$product.to_room_name','1116268CjzPbV','transaction_finished','Enabled','$product.id_transaction_from','Raw\x20Materials','$product.expiry_date','German','Finished\x20Goods','map','all','language','French','$product','$sale_product._id','/viewdata_inc_fg/:id','express','_id','view_og_table','../public/language/languages.json','$sale_product.unit','$product.to_quantity','warehouse_data','$sale_product.room_name','Arabic','findOne','4DoIXAY','1669767JNXJtf','$sale_product.product_name','invoice','$product_details.product_name','valueOf','$invoice','$sale_product.expiry_date','email','push','English\x20(US)','$warehouse_name','/viewFG','$product.product_code','data_sales','post','../middleware/auth','$product._id','Arabic\x20(ae)','6yyMlTn','$product.room_names','$product_details.production_date','/viewdata_og_fg/:id','data_adjustment','/reports','$product.invoice','$sale_product','length','view_table','findById','$product.id_transaction','$name','data_transfer','params','nodemailer','$$invoice','Hindi','2006042MwRZXC','flash','user','aggregate','render','$product_details.product_code','$to_warehouse','json','Portuguese\x20(BR)','$sale_product.invoice','success','$sale_product.product_code','English','Spanish','$product_details.unit','$product.id_transaction_id','/view','errors','find','$product.unit','body','exports','Portuguese','warehouses','$product_details','4499616nPKrYs','log','/viewdata_tf_fg/:id','$product.new_adjust_qty','$product.production_date','../models/all_models','2405945EtdVdV','$product.product_name','$date','$product_details.product_stock','$sale_product.production_date','Chinese','17985960kOVafC','$sale_product.id_transaction_from'];a0_0x1c1b=function(){return _0x3c6c3f;};return a0_0x1c1b();}