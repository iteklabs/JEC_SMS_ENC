var a0_0x3d428d=a0_0xd8e1;(function(_0x32f157,_0x22f5d2){var _0xab341c=a0_0xd8e1,_0x141605=_0x32f157();while(!![]){try{var _0x34973d=-parseInt(_0xab341c(0x1a9))/0x1*(parseInt(_0xab341c(0x17e))/0x2)+-parseInt(_0xab341c(0x157))/0x3*(parseInt(_0xab341c(0x195))/0x4)+-parseInt(_0xab341c(0x174))/0x5*(-parseInt(_0xab341c(0x15d))/0x6)+parseInt(_0xab341c(0x153))/0x7+parseInt(_0xab341c(0x168))/0x8+parseInt(_0xab341c(0x17a))/0x9*(-parseInt(_0xab341c(0x171))/0xa)+parseInt(_0xab341c(0x152))/0xb;if(_0x34973d===_0x22f5d2)break;else _0x141605['push'](_0x141605['shift']());}catch(_0x44ab91){_0x141605['push'](_0x141605['shift']());}}}(a0_0x1f67,0x4560f));function a0_0x1f67(){var _0x19977a=['$product','Enabled','$sale_product.unit','transaction_finished','/viewdata_inc_fg/:id','valueOf','$sale_product.id_transaction_from','$sale_product._id','/reports','$product_details._id','$product.production_date','$product.new_adjust_qty','$product_details.product_code','/viewdata_tf_fg/:id','aggregate','$product.invoice','log','$product.id_transaction_from','post','5920222SofWQu','899633AhWUsK','$product_details.production_date','$sale_product.room_name','user','1103754KVgnnY','$sale_product.invoice','$product.product_code','Chinese','German','Portuguese','2011356WqQAiY','$product.unit','data_sales','render','view_og_table','$warehouse_name','get','view_tf_table','language','French','$product_details','4429256AMmEzQ','$product_details.product_stock','email','$product_details.product_name','find','Hindi','../models/all_models','$sale_product.product_code','warehouse_data','50IzCVKL','$date','flash','5THqhEN','$$invoice','$product.product_name','Raw\x20Materials','$product.to_room_name','data_transfer','896157HjawiH','$to_warehouse','exports','all','405646RLmiRu','map','$name','/viewFG','$sale_product.production_date','English\x20(US)','$sale_product.quantity','length','$sale_product.expiry_date','$sale_product','Spanish','English','express','view_table','_id','$room','push','$product.expiry_date','params','invoice','findById','$sale_product.product_name','$product._id','4pEjeNL','../middleware/auth','Finished\x20Goods','body','$product.to_quantity','$product.id_transaction_id','Portuguese\x20(BR)','$product_details.expiry_date','Arabic\x20(ae)','data_adjustment','json','$product_details.invoice','$invoice','success','nodemailer','Arabic','errors','$product.room_names','warehouses','findOne','2xrlhEs','$product_details.unit','../public/language/languages.json'];a0_0x1f67=function(){return _0x19977a;};return a0_0x1f67();}const express=require(a0_0x3d428d(0x18a)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x3d428d(0x16e)),auth=require(a0_0x3d428d(0x196)),users=require(a0_0x3d428d(0x1ab)),nodemailer=require(a0_0x3d428d(0x1a3));function a0_0xd8e1(_0x23a5c6,_0x368625){var _0x1f6786=a0_0x1f67();return a0_0xd8e1=function(_0xd8e150,_0x60b0a2){_0xd8e150=_0xd8e150-0x14b;var _0x21acf2=_0x1f6786[_0xd8e150];return _0x21acf2;},a0_0xd8e1(_0x23a5c6,_0x368625);}router[a0_0x3d428d(0x163)]('/view',auth,async(_0x692fb1,_0x57c034)=>{var _0xa73153=a0_0x3d428d;try{const {username:_0x3ae49c,email:_0x50c9cc,role:_0x56b23f}=_0x692fb1[_0xa73153(0x156)],_0x2b1b3d=_0x692fb1[_0xa73153(0x156)],_0x355b76=await profile['findOne']({'email':_0x2b1b3d[_0xa73153(0x16a)]}),_0x3ec631=await master_shop[_0xa73153(0x16c)](),_0x3655e7=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0xa73153(0x197)}},{'$group':{'_id':_0xa73153(0x180),'name':{'$first':_0xa73153(0x180)}}}]);if(_0x3ec631[0x0]['language']==_0xa73153(0x183))var _0x872129=users[_0xa73153(0x189)];else{if(_0x3ec631[0x0][_0xa73153(0x165)]==_0xa73153(0x16d))var _0x872129=users[_0xa73153(0x16d)];else{if(_0x3ec631[0x0][_0xa73153(0x165)]=='German')var _0x872129=users[_0xa73153(0x15b)];else{if(_0x3ec631[0x0][_0xa73153(0x165)]=='Spanish')var _0x872129=users['Spanish'];else{if(_0x3ec631[0x0]['language']==_0xa73153(0x166))var _0x872129=users[_0xa73153(0x166)];else{if(_0x3ec631[0x0][_0xa73153(0x165)]==_0xa73153(0x19b))var _0x872129=users[_0xa73153(0x15c)];else{if(_0x3ec631[0x0][_0xa73153(0x165)]==_0xa73153(0x15a))var _0x872129=users['Chinese'];else{if(_0x3ec631[0x0][_0xa73153(0x165)]==_0xa73153(0x19d))var _0x872129=users[_0xa73153(0x1a4)];}}}}}}}_0x57c034[_0xa73153(0x160)](_0xa73153(0x1af),{'success':_0x692fb1[_0xa73153(0x173)](_0xa73153(0x1a2)),'errors':_0x692fb1[_0xa73153(0x173)](_0xa73153(0x1a5)),'role':_0x2b1b3d,'profile':_0x355b76,'master_shop':_0x3ec631,'dataProcess':_0x3655e7,'language':_0x872129});}catch(_0x2d1497){console['log'](_0x2d1497);}}),router[a0_0x3d428d(0x151)](a0_0x3d428d(0x1b4),auth,async(_0x554fcc,_0x4474df)=>{var _0x468b8d=a0_0x3d428d;const {product_category:_0x384e50,transaction_category:_0x3f169b,transaction_date_from:_0x529a8e,transaction_date_to:_0x6c807d,warehouse_category:_0x177b5d,item_code:_0x4b01ec}=_0x554fcc[_0x468b8d(0x198)];console[_0x468b8d(0x14f)](_0x177b5d);if(_0x384e50=='rm'){if(_0x177b5d=='all'){var _0x306be4=await purchases[_0x468b8d(0x14d)]([{'$match':{'date':{'$gte':_0x529a8e,'$lte':_0x6c807d}}},{'$lookup':{'from':_0x468b8d(0x1a7),'let':{'invoice':_0x468b8d(0x1a1)},'pipeline':[{'$unwind':_0x468b8d(0x167)},{'$match':{'$expr':{'$eq':[_0x468b8d(0x175),'$product_details.invoice']}}},{'$project':{'_id':_0x468b8d(0x1b5),'product_name':_0x468b8d(0x16b),'product_code':_0x468b8d(0x14b),'quantity_available':'$product_details.product_stock','warehouse_name':_0x468b8d(0x180),'warehouse_room':_0x468b8d(0x18d),'invoice':_0x468b8d(0x1a0),'production_date':_0x468b8d(0x154),'expiry_date':_0x468b8d(0x19c),'UOM':_0x468b8d(0x1aa)}}],'as':'warehouse_data'}}]);_0x306be4['data_sales']={},await Promise['all'](_0x306be4[_0x468b8d(0x17f)](async _0x4c1f5e=>{var _0xc5ab1c=_0x468b8d;_0x306be4['data_sales'][_0x4c1f5e[_0xc5ab1c(0x191)]]=[],await Promise['all'](_0x4c1f5e['warehouse_data']['map'](async _0x30cdfe=>{var _0x3f0282=_0xc5ab1c;const _0x40f65f=await sales[_0x3f0282(0x14d)]([{'$unwind':_0x3f0282(0x187)},{'$match':{'sale_product.id_transaction_from':_0x30cdfe['_id'][_0x3f0282(0x1b1)](),'sale_product.invoice':_0x30cdfe[_0x3f0282(0x191)]}},{'$project':{'_id':_0x3f0282(0x1b3),'product_name':'$sale_product.product_name','product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x3f0282(0x162),'warehouse_room':_0x3f0282(0x155),'product_invoice':_0x3f0282(0x158),'invoice':_0x3f0282(0x1a1),'id_transaction_from':_0x3f0282(0x1b2),'date':_0x3f0282(0x172),'production_date':_0x3f0282(0x182),'expiry_date':_0x3f0282(0x186),'UOM':_0x3f0282(0x1ae)}}]);_0x40f65f['length']>0x0&&_0x306be4['data_sales'][_0x4c1f5e[_0x3f0282(0x191)]]['push'](..._0x40f65f);}));})),_0x306be4['data_sales']=_0x306be4[_0x468b8d(0x15f)],_0x306be4[_0x468b8d(0x19e)]={},await Promise[_0x468b8d(0x17d)](_0x306be4[_0x468b8d(0x17f)](async _0x2c6eef=>{var _0x9bed41=_0x468b8d;_0x306be4['data_adjustment'][_0x2c6eef['invoice']]=[],await Promise['all'](_0x2c6eef[_0x9bed41(0x170)]['map'](async _0x3ece8b=>{var _0x1b7866=_0x9bed41;const _0x13ee2c=await adjustment[_0x1b7866(0x14d)]([{'$unwind':_0x1b7866(0x1ac)},{'$match':{'product.id_transaction_from':_0x3ece8b[_0x1b7866(0x18c)][_0x1b7866(0x1b1)](),'product.invoice':_0x3ece8b['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x1b7866(0x176),'product_code':_0x1b7866(0x159),'quantity_available':_0x1b7866(0x1b7),'warehouse_name':_0x1b7866(0x162),'warehouse_room':'$product.room_names','product_invoice':_0x1b7866(0x14e),'invoice':_0x1b7866(0x1a1),'id_transaction_from':_0x1b7866(0x150),'date':_0x1b7866(0x172),'production_date':_0x1b7866(0x1b6),'expiry_date':_0x1b7866(0x18f),'UOM':_0x1b7866(0x15e)}}]);_0x13ee2c[_0x1b7866(0x185)]>0x0&&_0x306be4['data_adjustment'][_0x2c6eef[_0x1b7866(0x191)]][_0x1b7866(0x18e)](..._0x13ee2c);}));})),_0x306be4[_0x468b8d(0x179)]={},await Promise[_0x468b8d(0x17d)](_0x306be4[_0x468b8d(0x17f)](async _0x212266=>{var _0x3e54e2=_0x468b8d;_0x306be4[_0x3e54e2(0x179)][_0x212266['invoice']]=[],await Promise[_0x3e54e2(0x17d)](_0x212266[_0x3e54e2(0x170)][_0x3e54e2(0x17f)](async _0x476d8b=>{var _0x483e7b=_0x3e54e2;const _0x15347f=await transfers[_0x483e7b(0x14d)]([{'$unwind':_0x483e7b(0x1ac)},{'$match':{'product.id_transaction_id':_0x476d8b[_0x483e7b(0x18c)][_0x483e7b(0x1b1)](),'product.To_invoice':_0x476d8b[_0x483e7b(0x191)]}},{'$project':{'_id':_0x483e7b(0x194),'product_name':'$product.product_name','product_code':_0x483e7b(0x159),'quantity_available':_0x483e7b(0x199),'warehouse_name':_0x483e7b(0x17b),'warehouse_room':_0x483e7b(0x1a6),'product_invoice':_0x483e7b(0x178),'invoice':_0x483e7b(0x1a1),'id_transaction_from':'$product.id_transaction_id','date':_0x483e7b(0x172),'production_date':_0x483e7b(0x1b6),'expiry_date':_0x483e7b(0x18f),'UOM':'$product.unit'}}]);_0x15347f['length']>0x0&&_0x306be4[_0x483e7b(0x179)][_0x212266[_0x483e7b(0x191)]]['push'](..._0x15347f);}));})),_0x4474df['json']({'purchases_warehouse':_0x306be4,'data_sales':_0x306be4['data_sales'],'data_adjustment':_0x306be4[_0x468b8d(0x19e)],'data_transfer':_0x306be4[_0x468b8d(0x179)]});}else{var _0x306be4=await purchases[_0x468b8d(0x14d)]([{'$match':{'warehouse_name':_0x177b5d,'date':{'$gte':_0x529a8e,'$lte':_0x6c807d}}},{'$lookup':{'from':_0x468b8d(0x1a7),'let':{'invoice':_0x468b8d(0x1a1)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x468b8d(0x175),_0x468b8d(0x1a0)]}}},{'$project':{'_id':_0x468b8d(0x1b5),'product_name':_0x468b8d(0x16b),'product_code':_0x468b8d(0x14b),'quantity_available':'$product_details.product_stock','warehouse_name':_0x468b8d(0x180),'warehouse_room':'$room','invoice':_0x468b8d(0x1a0),'production_date':_0x468b8d(0x154),'expiry_date':_0x468b8d(0x19c),'UOM':'$product_details.unit'}}],'as':'warehouse_data'}}]);_0x306be4[_0x468b8d(0x15f)]={},await Promise[_0x468b8d(0x17d)](_0x306be4[_0x468b8d(0x17f)](async _0x5c010c=>{var _0x539f9c=_0x468b8d;_0x306be4[_0x539f9c(0x15f)][_0x5c010c[_0x539f9c(0x191)]]=[],await Promise[_0x539f9c(0x17d)](_0x5c010c[_0x539f9c(0x170)][_0x539f9c(0x17f)](async _0x6dcd75=>{var _0x4d3d5e=_0x539f9c;const _0x19c528=await sales['aggregate']([{'$unwind':_0x4d3d5e(0x187)},{'$match':{'sale_product.id_transaction_from':_0x6dcd75['_id'][_0x4d3d5e(0x1b1)](),'sale_product.invoice':_0x6dcd75[_0x4d3d5e(0x191)]}},{'$project':{'_id':_0x4d3d5e(0x1b3),'product_name':_0x4d3d5e(0x193),'product_code':_0x4d3d5e(0x16f),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x4d3d5e(0x155),'product_invoice':_0x4d3d5e(0x158),'invoice':_0x4d3d5e(0x1a1),'id_transaction_from':'$sale_product.id_transaction_from','date':'$date','production_date':_0x4d3d5e(0x182),'expiry_date':_0x4d3d5e(0x186),'UOM':'$sale_product.unit'}}]);_0x19c528[_0x4d3d5e(0x185)]>0x0&&_0x306be4[_0x4d3d5e(0x15f)][_0x5c010c[_0x4d3d5e(0x191)]][_0x4d3d5e(0x18e)](..._0x19c528);}));})),_0x306be4[_0x468b8d(0x15f)]=_0x306be4[_0x468b8d(0x15f)],_0x306be4[_0x468b8d(0x19e)]={},await Promise[_0x468b8d(0x17d)](_0x306be4['map'](async _0x5eabcf=>{var _0x3efa61=_0x468b8d;_0x306be4['data_adjustment'][_0x5eabcf['invoice']]=[],await Promise['all'](_0x5eabcf[_0x3efa61(0x170)]['map'](async _0x2e6b51=>{var _0x4c39a4=_0x3efa61;const _0x59f9d8=await adjustment['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x2e6b51['_id']['valueOf'](),'product.invoice':_0x2e6b51[_0x4c39a4(0x191)]}},{'$project':{'_id':_0x4c39a4(0x194),'product_name':_0x4c39a4(0x176),'product_code':'$product.product_code','quantity_available':_0x4c39a4(0x1b7),'warehouse_name':'$warehouse_name','warehouse_room':_0x4c39a4(0x1a6),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':'$product.production_date','expiry_date':_0x4c39a4(0x18f),'UOM':_0x4c39a4(0x15e)}}]);_0x59f9d8[_0x4c39a4(0x185)]>0x0&&_0x306be4['data_adjustment'][_0x5eabcf[_0x4c39a4(0x191)]][_0x4c39a4(0x18e)](..._0x59f9d8);}));})),_0x306be4['data_transfer']={},await Promise[_0x468b8d(0x17d)](_0x306be4['map'](async _0x69bac0=>{var _0x241f08=_0x468b8d;_0x306be4['data_transfer'][_0x69bac0[_0x241f08(0x191)]]=[],await Promise['all'](_0x69bac0[_0x241f08(0x170)]['map'](async _0x35749b=>{var _0x133230=_0x241f08;const _0x4954be=await transfers[_0x133230(0x14d)]([{'$unwind':_0x133230(0x1ac)},{'$match':{'product.id_transaction_id':_0x35749b[_0x133230(0x18c)][_0x133230(0x1b1)](),'product.To_invoice':_0x35749b['invoice']}},{'$project':{'_id':_0x133230(0x194),'product_name':_0x133230(0x176),'product_code':_0x133230(0x159),'quantity_available':_0x133230(0x199),'warehouse_name':_0x133230(0x17b),'warehouse_room':_0x133230(0x1a6),'product_invoice':_0x133230(0x178),'invoice':_0x133230(0x1a1),'id_transaction_from':_0x133230(0x19a),'date':'$date','production_date':_0x133230(0x1b6),'expiry_date':_0x133230(0x18f),'UOM':_0x133230(0x15e)}}]);_0x4954be[_0x133230(0x185)]>0x0&&_0x306be4[_0x133230(0x179)][_0x69bac0[_0x133230(0x191)]][_0x133230(0x18e)](..._0x4954be);}));})),_0x4474df[_0x468b8d(0x19f)]({'purchases_warehouse':_0x306be4,'data_sales':_0x306be4[_0x468b8d(0x15f)],'data_adjustment':_0x306be4[_0x468b8d(0x19e)],'data_transfer':_0x306be4['data_transfer']});}}else{if(_0x177b5d==_0x468b8d(0x17d)){var _0x306be4=await purchases_finished[_0x468b8d(0x14d)]([{'$match':{'date':{'$gte':_0x529a8e,'$lte':_0x6c807d}}},{'$lookup':{'from':_0x468b8d(0x1a7),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x468b8d(0x175),_0x468b8d(0x1a0)]}}},{'$project':{'_id':_0x468b8d(0x1b5),'product_name':_0x468b8d(0x16b),'product_code':_0x468b8d(0x14b),'quantity_available':_0x468b8d(0x169),'warehouse_name':_0x468b8d(0x180),'warehouse_room':_0x468b8d(0x18d),'invoice':_0x468b8d(0x1a0),'production_date':_0x468b8d(0x154),'expiry_date':'$product_details.expiry_date','UOM':_0x468b8d(0x1aa)}}],'as':'warehouse_data'}}]);_0x306be4['data_sales']={},await Promise[_0x468b8d(0x17d)](_0x306be4[_0x468b8d(0x17f)](async _0x18cadc=>{var _0x38674d=_0x468b8d;_0x306be4['data_sales'][_0x18cadc[_0x38674d(0x191)]]=[],await Promise[_0x38674d(0x17d)](_0x18cadc[_0x38674d(0x170)][_0x38674d(0x17f)](async _0x3c754d=>{var _0x3592e9=_0x38674d;const _0x32b326=await sales_finished['aggregate']([{'$unwind':_0x3592e9(0x187)},{'$match':{'sale_product.id_transaction_from':_0x3c754d[_0x3592e9(0x18c)][_0x3592e9(0x1b1)](),'sale_product.invoice':_0x3c754d[_0x3592e9(0x191)]}},{'$project':{'_id':_0x3592e9(0x1b3),'product_name':_0x3592e9(0x193),'product_code':_0x3592e9(0x16f),'quantity_available':_0x3592e9(0x184),'warehouse_name':_0x3592e9(0x162),'warehouse_room':_0x3592e9(0x155),'product_invoice':_0x3592e9(0x158),'invoice':_0x3592e9(0x1a1),'id_transaction_from':_0x3592e9(0x1b2),'date':_0x3592e9(0x172),'production_date':_0x3592e9(0x182),'expiry_date':_0x3592e9(0x186),'UOM':_0x3592e9(0x1ae)}}]);_0x32b326['length']>0x0&&_0x306be4['data_sales'][_0x18cadc[_0x3592e9(0x191)]][_0x3592e9(0x18e)](..._0x32b326);}));})),_0x306be4['data_sales']=_0x306be4[_0x468b8d(0x15f)],_0x306be4[_0x468b8d(0x19e)]={},await Promise['all'](_0x306be4[_0x468b8d(0x17f)](async _0x1c061d=>{var _0x5f19ff=_0x468b8d;_0x306be4[_0x5f19ff(0x19e)][_0x1c061d['invoice']]=[],await Promise[_0x5f19ff(0x17d)](_0x1c061d[_0x5f19ff(0x170)]['map'](async _0x3b996d=>{var _0x57c5b6=_0x5f19ff;const _0x3930ac=await adjustment_finished[_0x57c5b6(0x14d)]([{'$unwind':_0x57c5b6(0x1ac)},{'$match':{'product.id_transaction_from':_0x3b996d[_0x57c5b6(0x18c)][_0x57c5b6(0x1b1)](),'product.invoice':_0x3b996d[_0x57c5b6(0x191)]}},{'$project':{'_id':_0x57c5b6(0x194),'product_name':_0x57c5b6(0x176),'product_code':_0x57c5b6(0x159),'quantity_available':_0x57c5b6(0x1b7),'warehouse_name':'$warehouse_name','warehouse_room':_0x57c5b6(0x1a6),'product_invoice':_0x57c5b6(0x14e),'invoice':_0x57c5b6(0x1a1),'id_transaction_from':_0x57c5b6(0x150),'date':_0x57c5b6(0x172),'production_date':'$product.production_date','expiry_date':_0x57c5b6(0x18f),'UOM':_0x57c5b6(0x15e)}}]);_0x3930ac[_0x57c5b6(0x185)]>0x0&&_0x306be4[_0x57c5b6(0x19e)][_0x1c061d['invoice']][_0x57c5b6(0x18e)](..._0x3930ac);}));})),_0x306be4[_0x468b8d(0x179)]={},await Promise[_0x468b8d(0x17d)](_0x306be4[_0x468b8d(0x17f)](async _0x4109e5=>{var _0x460666=_0x468b8d;_0x306be4[_0x460666(0x179)][_0x4109e5[_0x460666(0x191)]]=[],await Promise[_0x460666(0x17d)](_0x4109e5['warehouse_data'][_0x460666(0x17f)](async _0x2168db=>{var _0x38f4ad=_0x460666;const _0x343587=await transfers_finished[_0x38f4ad(0x14d)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x2168db['_id'][_0x38f4ad(0x1b1)](),'product.from_invoice':_0x2168db[_0x38f4ad(0x191)]}},{'$project':{'_id':_0x38f4ad(0x194),'product_name':_0x38f4ad(0x176),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x38f4ad(0x17b),'warehouse_room':_0x38f4ad(0x1a6),'product_invoice':_0x38f4ad(0x178),'invoice':'$invoice','id_transaction_from':'$product.id_transaction','date':_0x38f4ad(0x172),'production_date':_0x38f4ad(0x1b6),'expiry_date':_0x38f4ad(0x18f),'UOM':_0x38f4ad(0x15e)}}]);_0x343587[_0x38f4ad(0x185)]>0x0&&_0x306be4['data_transfer'][_0x4109e5[_0x38f4ad(0x191)]][_0x38f4ad(0x18e)](..._0x343587);}));})),_0x4474df[_0x468b8d(0x19f)]({'purchases_warehouse':_0x306be4,'data_sales':_0x306be4[_0x468b8d(0x15f)],'data_adjustment':_0x306be4['data_adjustment'],'data_transfer':_0x306be4[_0x468b8d(0x179)]});}else{var _0x306be4=await purchases_finished[_0x468b8d(0x14d)]([{'$match':{'warehouse_name':_0x177b5d,'date':{'$gte':_0x529a8e,'$lte':_0x6c807d}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x468b8d(0x1a1)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':['$$invoice',_0x468b8d(0x1a0)]}}},{'$project':{'_id':_0x468b8d(0x1b5),'product_name':'$product_details.product_name','product_code':_0x468b8d(0x14b),'quantity_available':_0x468b8d(0x169),'warehouse_name':_0x468b8d(0x180),'warehouse_room':_0x468b8d(0x18d),'invoice':_0x468b8d(0x1a0),'production_date':_0x468b8d(0x154),'expiry_date':_0x468b8d(0x19c),'UOM':_0x468b8d(0x1aa)}}],'as':_0x468b8d(0x170)}}]);_0x306be4[_0x468b8d(0x15f)]={},await Promise[_0x468b8d(0x17d)](_0x306be4[_0x468b8d(0x17f)](async _0x1baac8=>{var _0x59947d=_0x468b8d;_0x306be4[_0x59947d(0x15f)][_0x1baac8[_0x59947d(0x191)]]=[],await Promise[_0x59947d(0x17d)](_0x1baac8[_0x59947d(0x170)][_0x59947d(0x17f)](async _0xe5a8b8=>{var _0xc95e25=_0x59947d;const _0x1fb9db=await sales_finished[_0xc95e25(0x14d)]([{'$unwind':_0xc95e25(0x187)},{'$match':{'sale_product.id_transaction_from':_0xe5a8b8[_0xc95e25(0x18c)]['valueOf'](),'sale_product.invoice':_0xe5a8b8['invoice']}},{'$project':{'_id':_0xc95e25(0x1b3),'product_name':_0xc95e25(0x193),'product_code':_0xc95e25(0x16f),'quantity_available':_0xc95e25(0x184),'warehouse_name':'$warehouse_name','warehouse_room':'$sale_product.room_name','product_invoice':_0xc95e25(0x158),'invoice':_0xc95e25(0x1a1),'id_transaction_from':_0xc95e25(0x1b2),'date':_0xc95e25(0x172),'production_date':_0xc95e25(0x182),'expiry_date':_0xc95e25(0x186),'UOM':_0xc95e25(0x1ae)}}]);_0x1fb9db[_0xc95e25(0x185)]>0x0&&_0x306be4[_0xc95e25(0x15f)][_0x1baac8['invoice']][_0xc95e25(0x18e)](..._0x1fb9db);}));})),_0x306be4['data_sales']=_0x306be4['data_sales'],_0x306be4[_0x468b8d(0x19e)]={},await Promise[_0x468b8d(0x17d)](_0x306be4[_0x468b8d(0x17f)](async _0xe32413=>{var _0x1dabbc=_0x468b8d;_0x306be4[_0x1dabbc(0x19e)][_0xe32413['invoice']]=[],await Promise[_0x1dabbc(0x17d)](_0xe32413[_0x1dabbc(0x170)]['map'](async _0x31d29d=>{var _0x4e96b2=_0x1dabbc;const _0x18f16a=await adjustment_finished['aggregate']([{'$unwind':_0x4e96b2(0x1ac)},{'$match':{'product.id_transaction_from':_0x31d29d[_0x4e96b2(0x18c)][_0x4e96b2(0x1b1)](),'product.invoice':_0x31d29d[_0x4e96b2(0x191)]}},{'$project':{'_id':_0x4e96b2(0x194),'product_name':'$product.product_name','product_code':_0x4e96b2(0x159),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x4e96b2(0x162),'warehouse_room':'$product.room_names','product_invoice':_0x4e96b2(0x14e),'invoice':_0x4e96b2(0x1a1),'id_transaction_from':_0x4e96b2(0x150),'date':_0x4e96b2(0x172),'production_date':_0x4e96b2(0x1b6),'expiry_date':_0x4e96b2(0x18f),'UOM':'$product.unit'}}]);_0x18f16a[_0x4e96b2(0x185)]>0x0&&_0x306be4['data_adjustment'][_0xe32413['invoice']]['push'](..._0x18f16a);}));})),_0x306be4[_0x468b8d(0x179)]={},await Promise['all'](_0x306be4['map'](async _0x52b46a=>{var _0x5767f1=_0x468b8d;_0x306be4[_0x5767f1(0x179)][_0x52b46a['invoice']]=[],await Promise['all'](_0x52b46a[_0x5767f1(0x170)][_0x5767f1(0x17f)](async _0x4911a2=>{var _0x50f9ab=_0x5767f1;const _0x3672b2=await transfers_finished['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x4911a2[_0x50f9ab(0x18c)][_0x50f9ab(0x1b1)](),'product.from_invoice':_0x4911a2['invoice']}},{'$project':{'_id':_0x50f9ab(0x194),'product_name':_0x50f9ab(0x176),'product_code':'$product.product_code','quantity_available':_0x50f9ab(0x199),'warehouse_name':'$to_warehouse','warehouse_room':_0x50f9ab(0x1a6),'product_invoice':_0x50f9ab(0x178),'invoice':_0x50f9ab(0x1a1),'id_transaction_from':'$product.id_transaction','date':_0x50f9ab(0x172),'production_date':_0x50f9ab(0x1b6),'expiry_date':_0x50f9ab(0x18f),'UOM':_0x50f9ab(0x15e)}}]);_0x3672b2[_0x50f9ab(0x185)]>0x0&&_0x306be4[_0x50f9ab(0x179)][_0x52b46a['invoice']][_0x50f9ab(0x18e)](..._0x3672b2);}));})),_0x4474df['json']({'purchases_warehouse':_0x306be4,'data_sales':_0x306be4[_0x468b8d(0x15f)],'data_adjustment':_0x306be4[_0x468b8d(0x19e)],'data_transfer':_0x306be4[_0x468b8d(0x179)]});}}}),router['get'](a0_0x3d428d(0x1b0),auth,async(_0x5e564a,_0x2c6fd0)=>{var _0x4fd0fb=a0_0x3d428d;try{const _0x155383=_0x5e564a[_0x4fd0fb(0x190)]['id'];var _0x56445d=await purchases_finished[_0x4fd0fb(0x192)](_0x155383);const _0x5119aa=await master_shop[_0x4fd0fb(0x16c)](),_0x15762e=_0x5e564a[_0x4fd0fb(0x156)],_0x5ef7d7=await profile[_0x4fd0fb(0x1a8)]({'email':_0x15762e[_0x4fd0fb(0x16a)]});if(_0x5119aa[0x0]['language']==_0x4fd0fb(0x183))var _0x415fcb=users[_0x4fd0fb(0x189)];else{if(_0x5119aa[0x0]['language']==_0x4fd0fb(0x16d))var _0x415fcb=users['Hindi'];else{if(_0x5119aa[0x0][_0x4fd0fb(0x165)]==_0x4fd0fb(0x15b))var _0x415fcb=users['German'];else{if(_0x5119aa[0x0][_0x4fd0fb(0x165)]==_0x4fd0fb(0x188))var _0x415fcb=users[_0x4fd0fb(0x188)];else{if(_0x5119aa[0x0][_0x4fd0fb(0x165)]=='French')var _0x415fcb=users[_0x4fd0fb(0x166)];else{if(_0x5119aa[0x0][_0x4fd0fb(0x165)]=='Portuguese\x20(BR)')var _0x415fcb=users[_0x4fd0fb(0x15c)];else{if(_0x5119aa[0x0][_0x4fd0fb(0x165)]==_0x4fd0fb(0x15a))var _0x415fcb=users[_0x4fd0fb(0x15a)];else{if(_0x5119aa[0x0][_0x4fd0fb(0x165)]==_0x4fd0fb(0x19d))var _0x415fcb=users[_0x4fd0fb(0x1a4)];}}}}}}}_0x2c6fd0['render'](_0x4fd0fb(0x18b),{'success':_0x5e564a[_0x4fd0fb(0x173)]('success'),'errors':_0x5e564a['flash']('errors'),'master_shop':_0x5119aa,'profile':_0x5ef7d7,'role':_0x15762e,'language':_0x415fcb,'data':_0x56445d});}catch(_0x38389b){_0x2c6fd0['json'](_0x38389b);}}),router[a0_0x3d428d(0x163)]('/viewdata_og_fg/:id',auth,async(_0x333e87,_0x43e691)=>{var _0x3573d4=a0_0x3d428d;try{const _0x5929f7=_0x333e87['params']['id'];var _0x272335=await sales_finished[_0x3573d4(0x192)](_0x5929f7);const _0x44b05c=await master_shop[_0x3573d4(0x16c)](),_0x227db5=_0x333e87[_0x3573d4(0x156)],_0x35a6b0=await profile['findOne']({'email':_0x227db5[_0x3573d4(0x16a)]});if(_0x44b05c[0x0]['language']==_0x3573d4(0x183))var _0x2291ef=users[_0x3573d4(0x189)];else{if(_0x44b05c[0x0]['language']==_0x3573d4(0x16d))var _0x2291ef=users[_0x3573d4(0x16d)];else{if(_0x44b05c[0x0][_0x3573d4(0x165)]==_0x3573d4(0x15b))var _0x2291ef=users['German'];else{if(_0x44b05c[0x0][_0x3573d4(0x165)]=='Spanish')var _0x2291ef=users[_0x3573d4(0x188)];else{if(_0x44b05c[0x0][_0x3573d4(0x165)]=='French')var _0x2291ef=users['French'];else{if(_0x44b05c[0x0][_0x3573d4(0x165)]=='Portuguese\x20(BR)')var _0x2291ef=users[_0x3573d4(0x15c)];else{if(_0x44b05c[0x0][_0x3573d4(0x165)]==_0x3573d4(0x15a))var _0x2291ef=users[_0x3573d4(0x15a)];else{if(_0x44b05c[0x0][_0x3573d4(0x165)]==_0x3573d4(0x19d))var _0x2291ef=users[_0x3573d4(0x1a4)];}}}}}}}_0x43e691['render'](_0x3573d4(0x161),{'success':_0x333e87[_0x3573d4(0x173)](_0x3573d4(0x1a2)),'errors':_0x333e87['flash'](_0x3573d4(0x1a5)),'master_shop':_0x44b05c,'profile':_0x35a6b0,'role':_0x227db5,'language':_0x2291ef,'data':_0x272335});}catch(_0x18639e){_0x43e691['json'](_0x18639e);}}),router[a0_0x3d428d(0x163)](a0_0x3d428d(0x14c),auth,async(_0x29781a,_0x43bba4)=>{var _0x185982=a0_0x3d428d;try{const _0x2329e6=_0x29781a[_0x185982(0x190)]['id'];var _0x1316fd=await transfers_finished[_0x185982(0x192)](_0x2329e6);const _0x1175bd=await master_shop[_0x185982(0x16c)](),_0x14d8b8=_0x29781a['user'],_0x2722e2=await profile['findOne']({'email':_0x14d8b8['email']});if(_0x1175bd[0x0][_0x185982(0x165)]==_0x185982(0x183))var _0x6b5fea=users['English'];else{if(_0x1175bd[0x0]['language']==_0x185982(0x16d))var _0x6b5fea=users[_0x185982(0x16d)];else{if(_0x1175bd[0x0][_0x185982(0x165)]=='German')var _0x6b5fea=users[_0x185982(0x15b)];else{if(_0x1175bd[0x0][_0x185982(0x165)]=='Spanish')var _0x6b5fea=users[_0x185982(0x188)];else{if(_0x1175bd[0x0]['language']==_0x185982(0x166))var _0x6b5fea=users[_0x185982(0x166)];else{if(_0x1175bd[0x0][_0x185982(0x165)]==_0x185982(0x19b))var _0x6b5fea=users[_0x185982(0x15c)];else{if(_0x1175bd[0x0][_0x185982(0x165)]==_0x185982(0x15a))var _0x6b5fea=users[_0x185982(0x15a)];else{if(_0x1175bd[0x0]['language']==_0x185982(0x19d))var _0x6b5fea=users['Arabic'];}}}}}}}_0x43bba4[_0x185982(0x160)](_0x185982(0x164),{'success':_0x29781a[_0x185982(0x173)]('success'),'errors':_0x29781a[_0x185982(0x173)](_0x185982(0x1a5)),'master_shop':_0x1175bd,'profile':_0x2722e2,'role':_0x14d8b8,'language':_0x6b5fea,'data':_0x1316fd});}catch(_0x3030bf){_0x43bba4[_0x185982(0x19f)](_0x3030bf);}}),router[a0_0x3d428d(0x163)](a0_0x3d428d(0x181),auth,async(_0x56f53e,_0x1e8921)=>{var _0x20768c=a0_0x3d428d;try{const {username:_0x503369,email:_0x46cd21,role:_0x1c131b}=_0x56f53e['user'],_0x4d4bea=_0x56f53e[_0x20768c(0x156)],_0x325c9d=await profile['findOne']({'email':_0x4d4bea['email']}),_0x3743bd=await master_shop[_0x20768c(0x16c)](),_0x452919=await warehouse[_0x20768c(0x14d)]([{'$match':{'status':_0x20768c(0x1ad),'warehouse_category':_0x20768c(0x177)}},{'$group':{'_id':_0x20768c(0x180),'name':{'$first':'$name'}}}]);if(_0x3743bd[0x0][_0x20768c(0x165)]==_0x20768c(0x183))var _0x540693=users[_0x20768c(0x189)];else{if(_0x3743bd[0x0]['language']==_0x20768c(0x16d))var _0x540693=users['Hindi'];else{if(_0x3743bd[0x0][_0x20768c(0x165)]==_0x20768c(0x15b))var _0x540693=users[_0x20768c(0x15b)];else{if(_0x3743bd[0x0]['language']==_0x20768c(0x188))var _0x540693=users[_0x20768c(0x188)];else{if(_0x3743bd[0x0][_0x20768c(0x165)]==_0x20768c(0x166))var _0x540693=users['French'];else{if(_0x3743bd[0x0][_0x20768c(0x165)]==_0x20768c(0x19b))var _0x540693=users['Portuguese'];else{if(_0x3743bd[0x0][_0x20768c(0x165)]==_0x20768c(0x15a))var _0x540693=users[_0x20768c(0x15a)];else{if(_0x3743bd[0x0][_0x20768c(0x165)]==_0x20768c(0x19d))var _0x540693=users[_0x20768c(0x1a4)];}}}}}}}_0x1e8921[_0x20768c(0x160)]('transaction_finished_raw',{'success':_0x56f53e[_0x20768c(0x173)](_0x20768c(0x1a2)),'errors':_0x56f53e[_0x20768c(0x173)]('errors'),'role':_0x4d4bea,'profile':_0x325c9d,'master_shop':_0x3743bd,'dataProcess':_0x452919,'language':_0x540693});}catch(_0x37e0a1){console['log'](_0x37e0a1);}}),module[a0_0x3d428d(0x17c)]=router;