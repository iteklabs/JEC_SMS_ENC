var a0_0xe570f9=a0_0x109d;function a0_0x109d(_0x164d8f,_0x217713){var _0x28b0c7=a0_0x28b0();return a0_0x109d=function(_0x109dfc,_0x9bd496){_0x109dfc=_0x109dfc-0x106;var _0xe4b1e1=_0x28b0c7[_0x109dfc];return _0xe4b1e1;},a0_0x109d(_0x164d8f,_0x217713);}(function(_0x2892d3,_0x2f06c1){var _0x144d99=a0_0x109d,_0x434810=_0x2892d3();while(!![]){try{var _0x26b3c7=parseInt(_0x144d99(0x140))/0x1+-parseInt(_0x144d99(0x131))/0x2+parseInt(_0x144d99(0x119))/0x3*(parseInt(_0x144d99(0x126))/0x4)+-parseInt(_0x144d99(0x167))/0x5*(parseInt(_0x144d99(0x13b))/0x6)+parseInt(_0x144d99(0x169))/0x7+-parseInt(_0x144d99(0x120))/0x8*(-parseInt(_0x144d99(0x127))/0x9)+-parseInt(_0x144d99(0x130))/0xa*(-parseInt(_0x144d99(0x16d))/0xb);if(_0x26b3c7===_0x2f06c1)break;else _0x434810['push'](_0x434810['shift']());}catch(_0x21f7a3){_0x434810['push'](_0x434810['shift']());}}}(a0_0x28b0,0x89636));const express=require(a0_0xe570f9(0x141)),app=express(),router=express[a0_0xe570f9(0x11a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require('../models/all_models'),auth=require(a0_0xe570f9(0x112)),users=require(a0_0xe570f9(0x156)),nodemailer=require(a0_0xe570f9(0x106));function a0_0x28b0(){var _0x1ea221=['904CNyFrY','/viewFG','Spanish','$sale_product.invoice','$product.product_code','$product.unit','24bkQVhA','31851wcTYDc','$product.new_adjust_qty','French','warehouse_data','$product_details.unit','email','$warehouse_name','$product_details.product_code','/viewdata_inc_fg/:id','2798090cZIZLf','1097024puWhks','English','all','push','$date','_id','flash','$product_details.production_date','$product.production_date','$sale_product.expiry_date','5832498RJkuxj','$product.expiry_date','data_adjustment','$sale_product._id','$to_warehouse','392765XVpXsH','express','$product','$product.id_transaction_id','German','$sale_product','render','$product_details.expiry_date','Raw\x20Materials','json','Arabic\x20(ae)','$product_details.product_name','$product_details._id','params','$product.to_room_name','Enabled','$product.room_names','$product_details.product_stock','$room','get','transaction_finished','$sale_product.id_transaction_from','../public/language/languages.json','Chinese','body','Portuguese','view_og_table','findById','Arabic','Portuguese\x20(BR)','aggregate','$product._id','$product_details.invoice','$sale_product.product_code','$sale_product.product_name','findOne','/viewdata_og_fg/:id','find','Hindi','5kuXmdl','$product_details','4032756noxqkT','language','log','length','11fbapBF','$product.invoice','English\x20(US)','Finished\x20Goods','nodemailer','exports','user','warehouses','success','$product.id_transaction_from','$sale_product.room_name','map','$product.product_name','$invoice','view_tf_table','valueOf','../middleware/auth','$name','$sale_product.production_date','$sale_product.quantity','$product.id_transaction','errors','$$invoice','217374sOhCTL','Router','data_transfer','$sale_product.unit','invoice','$product.to_quantity','data_sales'];a0_0x28b0=function(){return _0x1ea221;};return a0_0x28b0();}router[a0_0xe570f9(0x153)]('/view',auth,async(_0xe93986,_0x293719)=>{var _0x35dbdb=a0_0xe570f9;try{const {username:_0x1fc881,email:_0xc37d50,role:_0x3c6b18}=_0xe93986[_0x35dbdb(0x108)],_0x5f0a85=_0xe93986[_0x35dbdb(0x108)],_0x17bce0=await profile[_0x35dbdb(0x163)]({'email':_0x5f0a85[_0x35dbdb(0x12c)]}),_0x4aa0b4=await master_shop[_0x35dbdb(0x165)](),_0x3c5631=await warehouse['aggregate']([{'$match':{'status':_0x35dbdb(0x14f),'warehouse_category':_0x35dbdb(0x170)}},{'$group':{'_id':_0x35dbdb(0x113),'name':{'$first':_0x35dbdb(0x113)}}}]);if(_0x4aa0b4[0x0][_0x35dbdb(0x16a)]==_0x35dbdb(0x16f))var _0x8807b=users[_0x35dbdb(0x132)];else{if(_0x4aa0b4[0x0][_0x35dbdb(0x16a)]==_0x35dbdb(0x166))var _0x8807b=users[_0x35dbdb(0x166)];else{if(_0x4aa0b4[0x0]['language']==_0x35dbdb(0x144))var _0x8807b=users[_0x35dbdb(0x144)];else{if(_0x4aa0b4[0x0][_0x35dbdb(0x16a)]==_0x35dbdb(0x122))var _0x8807b=users[_0x35dbdb(0x122)];else{if(_0x4aa0b4[0x0]['language']==_0x35dbdb(0x129))var _0x8807b=users[_0x35dbdb(0x129)];else{if(_0x4aa0b4[0x0][_0x35dbdb(0x16a)]==_0x35dbdb(0x15d))var _0x8807b=users[_0x35dbdb(0x159)];else{if(_0x4aa0b4[0x0][_0x35dbdb(0x16a)]==_0x35dbdb(0x157))var _0x8807b=users[_0x35dbdb(0x157)];else{if(_0x4aa0b4[0x0][_0x35dbdb(0x16a)]=='Arabic\x20(ae)')var _0x8807b=users['Arabic'];}}}}}}}_0x293719[_0x35dbdb(0x146)](_0x35dbdb(0x154),{'success':_0xe93986['flash']('success'),'errors':_0xe93986['flash'](_0x35dbdb(0x117)),'role':_0x5f0a85,'profile':_0x17bce0,'master_shop':_0x4aa0b4,'dataProcess':_0x3c5631,'language':_0x8807b});}catch(_0x2c96fb){console[_0x35dbdb(0x16b)](_0x2c96fb);}}),router['post']('/reports',auth,async(_0xd93570,_0x5eb84a)=>{var _0x434afc=a0_0xe570f9;const {product_category:_0x4c5e93,transaction_category:_0x177b07,transaction_date_from:_0x117c32,transaction_date_to:_0x48a390,warehouse_category:_0x399daa,item_code:_0x50c61a}=_0xd93570[_0x434afc(0x158)];console[_0x434afc(0x16b)](_0x399daa);if(_0x4c5e93=='rm'){if(_0x399daa=='all'){var _0x1c8cfa=await purchases[_0x434afc(0x15e)]([{'$match':{'date':{'$gte':_0x117c32,'$lte':_0x48a390}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x434afc(0x10f)},'pipeline':[{'$unwind':_0x434afc(0x168)},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x434afc(0x14c),'product_name':_0x434afc(0x14b),'product_code':_0x434afc(0x12e),'quantity_available':_0x434afc(0x151),'warehouse_name':_0x434afc(0x113),'warehouse_room':_0x434afc(0x152),'invoice':_0x434afc(0x160),'production_date':_0x434afc(0x138),'expiry_date':_0x434afc(0x147),'UOM':_0x434afc(0x12b)}}],'as':_0x434afc(0x12a)}}]);_0x1c8cfa[_0x434afc(0x11f)]={},await Promise[_0x434afc(0x133)](_0x1c8cfa[_0x434afc(0x10d)](async _0x51b5d1=>{var _0xd5fd6b=_0x434afc;_0x1c8cfa[_0xd5fd6b(0x11f)][_0x51b5d1['invoice']]=[],await Promise['all'](_0x51b5d1[_0xd5fd6b(0x12a)][_0xd5fd6b(0x10d)](async _0x1f0461=>{var _0x2e9cd1=_0xd5fd6b;const _0x1041fd=await sales[_0x2e9cd1(0x15e)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x1f0461[_0x2e9cd1(0x136)]['valueOf'](),'sale_product.invoice':_0x1f0461[_0x2e9cd1(0x11d)]}},{'$project':{'_id':_0x2e9cd1(0x13e),'product_name':_0x2e9cd1(0x162),'product_code':_0x2e9cd1(0x161),'quantity_available':_0x2e9cd1(0x115),'warehouse_name':'$warehouse_name','warehouse_room':'$sale_product.room_name','product_invoice':_0x2e9cd1(0x123),'invoice':_0x2e9cd1(0x10f),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x2e9cd1(0x135),'production_date':_0x2e9cd1(0x114),'expiry_date':_0x2e9cd1(0x13a),'UOM':_0x2e9cd1(0x11c)}}]);_0x1041fd[_0x2e9cd1(0x16c)]>0x0&&_0x1c8cfa[_0x2e9cd1(0x11f)][_0x51b5d1[_0x2e9cd1(0x11d)]][_0x2e9cd1(0x134)](..._0x1041fd);}));})),_0x1c8cfa[_0x434afc(0x11f)]=_0x1c8cfa['data_sales'],_0x1c8cfa[_0x434afc(0x13d)]={},await Promise[_0x434afc(0x133)](_0x1c8cfa[_0x434afc(0x10d)](async _0x4cd233=>{var _0x2544e4=_0x434afc;_0x1c8cfa['data_adjustment'][_0x4cd233['invoice']]=[],await Promise[_0x2544e4(0x133)](_0x4cd233[_0x2544e4(0x12a)]['map'](async _0x144c99=>{var _0x10615e=_0x2544e4;const _0x28b5b5=await adjustment['aggregate']([{'$unwind':_0x10615e(0x142)},{'$match':{'product.id_transaction_from':_0x144c99[_0x10615e(0x136)]['valueOf'](),'product.invoice':_0x144c99['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x10615e(0x10e),'product_code':_0x10615e(0x124),'quantity_available':_0x10615e(0x128),'warehouse_name':_0x10615e(0x12d),'warehouse_room':_0x10615e(0x150),'product_invoice':_0x10615e(0x16e),'invoice':_0x10615e(0x10f),'id_transaction_from':_0x10615e(0x10b),'date':'$date','production_date':_0x10615e(0x139),'expiry_date':'$product.expiry_date','UOM':_0x10615e(0x125)}}]);_0x28b5b5[_0x10615e(0x16c)]>0x0&&_0x1c8cfa[_0x10615e(0x13d)][_0x4cd233[_0x10615e(0x11d)]][_0x10615e(0x134)](..._0x28b5b5);}));})),_0x1c8cfa[_0x434afc(0x11b)]={},await Promise[_0x434afc(0x133)](_0x1c8cfa['map'](async _0x353bfc=>{var _0x5a1df7=_0x434afc;_0x1c8cfa[_0x5a1df7(0x11b)][_0x353bfc[_0x5a1df7(0x11d)]]=[],await Promise[_0x5a1df7(0x133)](_0x353bfc['warehouse_data'][_0x5a1df7(0x10d)](async _0xbbb6a3=>{var _0x5c81c1=_0x5a1df7;const _0xba2cf=await transfers[_0x5c81c1(0x15e)]([{'$unwind':_0x5c81c1(0x142)},{'$match':{'product.id_transaction_id':_0xbbb6a3[_0x5c81c1(0x136)][_0x5c81c1(0x111)](),'product.To_invoice':_0xbbb6a3[_0x5c81c1(0x11d)]}},{'$project':{'_id':_0x5c81c1(0x15f),'product_name':_0x5c81c1(0x10e),'product_code':_0x5c81c1(0x124),'quantity_available':_0x5c81c1(0x11e),'warehouse_name':_0x5c81c1(0x13f),'warehouse_room':'$product.room_names','product_invoice':_0x5c81c1(0x14e),'invoice':'$invoice','id_transaction_from':_0x5c81c1(0x143),'date':'$date','production_date':_0x5c81c1(0x139),'expiry_date':_0x5c81c1(0x13c),'UOM':'$product.unit'}}]);_0xba2cf['length']>0x0&&_0x1c8cfa['data_transfer'][_0x353bfc[_0x5c81c1(0x11d)]]['push'](..._0xba2cf);}));})),_0x5eb84a[_0x434afc(0x149)]({'purchases_warehouse':_0x1c8cfa,'data_sales':_0x1c8cfa[_0x434afc(0x11f)],'data_adjustment':_0x1c8cfa[_0x434afc(0x13d)],'data_transfer':_0x1c8cfa[_0x434afc(0x11b)]});}else{var _0x1c8cfa=await purchases[_0x434afc(0x15e)]([{'$match':{'warehouse_name':_0x399daa,'date':{'$gte':_0x117c32,'$lte':_0x48a390}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x434afc(0x10f)},'pipeline':[{'$unwind':_0x434afc(0x168)},{'$match':{'$expr':{'$eq':[_0x434afc(0x118),_0x434afc(0x160)]}}},{'$project':{'_id':_0x434afc(0x14c),'product_name':_0x434afc(0x14b),'product_code':_0x434afc(0x12e),'quantity_available':_0x434afc(0x151),'warehouse_name':_0x434afc(0x113),'warehouse_room':_0x434afc(0x152),'invoice':_0x434afc(0x160),'production_date':'$product_details.production_date','expiry_date':_0x434afc(0x147),'UOM':_0x434afc(0x12b)}}],'as':_0x434afc(0x12a)}}]);_0x1c8cfa['data_sales']={},await Promise[_0x434afc(0x133)](_0x1c8cfa['map'](async _0x34bec0=>{var _0x1532e1=_0x434afc;_0x1c8cfa[_0x1532e1(0x11f)][_0x34bec0[_0x1532e1(0x11d)]]=[],await Promise['all'](_0x34bec0[_0x1532e1(0x12a)]['map'](async _0x994bd0=>{var _0xc22402=_0x1532e1;const _0x41d603=await sales[_0xc22402(0x15e)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x994bd0[_0xc22402(0x136)]['valueOf'](),'sale_product.invoice':_0x994bd0[_0xc22402(0x11d)]}},{'$project':{'_id':'$sale_product._id','product_name':'$sale_product.product_name','product_code':_0xc22402(0x161),'quantity_available':_0xc22402(0x115),'warehouse_name':_0xc22402(0x12d),'warehouse_room':_0xc22402(0x10c),'product_invoice':_0xc22402(0x123),'invoice':_0xc22402(0x10f),'id_transaction_from':'$sale_product.id_transaction_from','date':_0xc22402(0x135),'production_date':_0xc22402(0x114),'expiry_date':_0xc22402(0x13a),'UOM':'$sale_product.unit'}}]);_0x41d603[_0xc22402(0x16c)]>0x0&&_0x1c8cfa[_0xc22402(0x11f)][_0x34bec0['invoice']][_0xc22402(0x134)](..._0x41d603);}));})),_0x1c8cfa['data_sales']=_0x1c8cfa[_0x434afc(0x11f)],_0x1c8cfa['data_adjustment']={},await Promise[_0x434afc(0x133)](_0x1c8cfa[_0x434afc(0x10d)](async _0xfba2ec=>{var _0x394653=_0x434afc;_0x1c8cfa[_0x394653(0x13d)][_0xfba2ec['invoice']]=[],await Promise['all'](_0xfba2ec[_0x394653(0x12a)][_0x394653(0x10d)](async _0x82cba7=>{var _0x2abc1d=_0x394653;const _0x9ca16f=await adjustment['aggregate']([{'$unwind':_0x2abc1d(0x142)},{'$match':{'product.id_transaction_from':_0x82cba7[_0x2abc1d(0x136)]['valueOf'](),'product.invoice':_0x82cba7[_0x2abc1d(0x11d)]}},{'$project':{'_id':_0x2abc1d(0x15f),'product_name':_0x2abc1d(0x10e),'product_code':_0x2abc1d(0x124),'quantity_available':_0x2abc1d(0x128),'warehouse_name':_0x2abc1d(0x12d),'warehouse_room':_0x2abc1d(0x150),'product_invoice':'$product.invoice','invoice':_0x2abc1d(0x10f),'id_transaction_from':'$product.id_transaction_from','date':_0x2abc1d(0x135),'production_date':'$product.production_date','expiry_date':_0x2abc1d(0x13c),'UOM':_0x2abc1d(0x125)}}]);_0x9ca16f[_0x2abc1d(0x16c)]>0x0&&_0x1c8cfa[_0x2abc1d(0x13d)][_0xfba2ec[_0x2abc1d(0x11d)]][_0x2abc1d(0x134)](..._0x9ca16f);}));})),_0x1c8cfa[_0x434afc(0x11b)]={},await Promise['all'](_0x1c8cfa[_0x434afc(0x10d)](async _0x4929b0=>{var _0x58e72d=_0x434afc;_0x1c8cfa[_0x58e72d(0x11b)][_0x4929b0['invoice']]=[],await Promise[_0x58e72d(0x133)](_0x4929b0[_0x58e72d(0x12a)][_0x58e72d(0x10d)](async _0xe6cfd=>{var _0x3054b0=_0x58e72d;const _0x3a9790=await transfers[_0x3054b0(0x15e)]([{'$unwind':_0x3054b0(0x142)},{'$match':{'product.id_transaction_id':_0xe6cfd[_0x3054b0(0x136)]['valueOf'](),'product.To_invoice':_0xe6cfd['invoice']}},{'$project':{'_id':_0x3054b0(0x15f),'product_name':_0x3054b0(0x10e),'product_code':_0x3054b0(0x124),'quantity_available':'$product.to_quantity','warehouse_name':'$to_warehouse','warehouse_room':_0x3054b0(0x150),'product_invoice':'$product.to_room_name','invoice':_0x3054b0(0x10f),'id_transaction_from':'$product.id_transaction_id','date':_0x3054b0(0x135),'production_date':_0x3054b0(0x139),'expiry_date':_0x3054b0(0x13c),'UOM':_0x3054b0(0x125)}}]);_0x3a9790[_0x3054b0(0x16c)]>0x0&&_0x1c8cfa['data_transfer'][_0x4929b0['invoice']][_0x3054b0(0x134)](..._0x3a9790);}));})),_0x5eb84a[_0x434afc(0x149)]({'purchases_warehouse':_0x1c8cfa,'data_sales':_0x1c8cfa[_0x434afc(0x11f)],'data_adjustment':_0x1c8cfa[_0x434afc(0x13d)],'data_transfer':_0x1c8cfa[_0x434afc(0x11b)]});}}else{if(_0x399daa==_0x434afc(0x133)){var _0x1c8cfa=await purchases_finished[_0x434afc(0x15e)]([{'$match':{'date':{'$gte':_0x117c32,'$lte':_0x48a390}}},{'$lookup':{'from':_0x434afc(0x109),'let':{'invoice':_0x434afc(0x10f)},'pipeline':[{'$unwind':_0x434afc(0x168)},{'$match':{'$expr':{'$eq':[_0x434afc(0x118),_0x434afc(0x160)]}}},{'$project':{'_id':_0x434afc(0x14c),'product_name':'$product_details.product_name','product_code':_0x434afc(0x12e),'quantity_available':_0x434afc(0x151),'warehouse_name':_0x434afc(0x113),'warehouse_room':'$room','invoice':_0x434afc(0x160),'production_date':_0x434afc(0x138),'expiry_date':_0x434afc(0x147),'UOM':_0x434afc(0x12b)}}],'as':_0x434afc(0x12a)}}]);_0x1c8cfa[_0x434afc(0x11f)]={},await Promise['all'](_0x1c8cfa[_0x434afc(0x10d)](async _0x190311=>{var _0x1367b4=_0x434afc;_0x1c8cfa[_0x1367b4(0x11f)][_0x190311[_0x1367b4(0x11d)]]=[],await Promise[_0x1367b4(0x133)](_0x190311[_0x1367b4(0x12a)]['map'](async _0x2deb68=>{var _0x4f0520=_0x1367b4;const _0x5c608c=await sales_finished[_0x4f0520(0x15e)]([{'$unwind':_0x4f0520(0x145)},{'$match':{'sale_product.id_transaction_from':_0x2deb68['_id'][_0x4f0520(0x111)](),'sale_product.invoice':_0x2deb68[_0x4f0520(0x11d)]}},{'$project':{'_id':_0x4f0520(0x13e),'product_name':_0x4f0520(0x162),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x4f0520(0x10c),'product_invoice':'$sale_product.invoice','invoice':_0x4f0520(0x10f),'id_transaction_from':_0x4f0520(0x155),'date':'$date','production_date':_0x4f0520(0x114),'expiry_date':'$sale_product.expiry_date','UOM':'$sale_product.unit'}}]);_0x5c608c[_0x4f0520(0x16c)]>0x0&&_0x1c8cfa[_0x4f0520(0x11f)][_0x190311[_0x4f0520(0x11d)]][_0x4f0520(0x134)](..._0x5c608c);}));})),_0x1c8cfa['data_sales']=_0x1c8cfa['data_sales'],_0x1c8cfa[_0x434afc(0x13d)]={},await Promise[_0x434afc(0x133)](_0x1c8cfa[_0x434afc(0x10d)](async _0x16f3e4=>{var _0x46dfa9=_0x434afc;_0x1c8cfa[_0x46dfa9(0x13d)][_0x16f3e4[_0x46dfa9(0x11d)]]=[],await Promise['all'](_0x16f3e4[_0x46dfa9(0x12a)][_0x46dfa9(0x10d)](async _0x591739=>{var _0x2711d2=_0x46dfa9;const _0x454341=await adjustment_finished[_0x2711d2(0x15e)]([{'$unwind':_0x2711d2(0x142)},{'$match':{'product.id_transaction_from':_0x591739[_0x2711d2(0x136)][_0x2711d2(0x111)](),'product.invoice':_0x591739[_0x2711d2(0x11d)]}},{'$project':{'_id':_0x2711d2(0x15f),'product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':_0x2711d2(0x128),'warehouse_name':_0x2711d2(0x12d),'warehouse_room':'$product.room_names','product_invoice':_0x2711d2(0x16e),'invoice':_0x2711d2(0x10f),'id_transaction_from':_0x2711d2(0x10b),'date':_0x2711d2(0x135),'production_date':_0x2711d2(0x139),'expiry_date':_0x2711d2(0x13c),'UOM':_0x2711d2(0x125)}}]);_0x454341[_0x2711d2(0x16c)]>0x0&&_0x1c8cfa[_0x2711d2(0x13d)][_0x16f3e4[_0x2711d2(0x11d)]][_0x2711d2(0x134)](..._0x454341);}));})),_0x1c8cfa['data_transfer']={},await Promise[_0x434afc(0x133)](_0x1c8cfa[_0x434afc(0x10d)](async _0xc24f6c=>{var _0x1ce459=_0x434afc;_0x1c8cfa[_0x1ce459(0x11b)][_0xc24f6c['invoice']]=[],await Promise[_0x1ce459(0x133)](_0xc24f6c['warehouse_data'][_0x1ce459(0x10d)](async _0x16cdbf=>{var _0x1f1831=_0x1ce459;const _0x27f6ff=await transfers_finished[_0x1f1831(0x15e)]([{'$unwind':_0x1f1831(0x142)},{'$match':{'product.id_transaction':_0x16cdbf[_0x1f1831(0x136)][_0x1f1831(0x111)](),'product.from_invoice':_0x16cdbf[_0x1f1831(0x11d)]}},{'$project':{'_id':_0x1f1831(0x15f),'product_name':_0x1f1831(0x10e),'product_code':_0x1f1831(0x124),'quantity_available':_0x1f1831(0x11e),'warehouse_name':'$to_warehouse','warehouse_room':_0x1f1831(0x150),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x1f1831(0x116),'date':_0x1f1831(0x135),'production_date':_0x1f1831(0x139),'expiry_date':'$product.expiry_date','UOM':_0x1f1831(0x125)}}]);_0x27f6ff[_0x1f1831(0x16c)]>0x0&&_0x1c8cfa['data_transfer'][_0xc24f6c['invoice']][_0x1f1831(0x134)](..._0x27f6ff);}));})),_0x5eb84a['json']({'purchases_warehouse':_0x1c8cfa,'data_sales':_0x1c8cfa[_0x434afc(0x11f)],'data_adjustment':_0x1c8cfa[_0x434afc(0x13d)],'data_transfer':_0x1c8cfa[_0x434afc(0x11b)]});}else{var _0x1c8cfa=await purchases_finished[_0x434afc(0x15e)]([{'$match':{'warehouse_name':_0x399daa,'date':{'$gte':_0x117c32,'$lte':_0x48a390}}},{'$lookup':{'from':_0x434afc(0x109),'let':{'invoice':_0x434afc(0x10f)},'pipeline':[{'$unwind':_0x434afc(0x168)},{'$match':{'$expr':{'$eq':[_0x434afc(0x118),_0x434afc(0x160)]}}},{'$project':{'_id':_0x434afc(0x14c),'product_name':_0x434afc(0x14b),'product_code':_0x434afc(0x12e),'quantity_available':_0x434afc(0x151),'warehouse_name':'$name','warehouse_room':'$room','invoice':'$product_details.invoice','production_date':_0x434afc(0x138),'expiry_date':_0x434afc(0x147),'UOM':_0x434afc(0x12b)}}],'as':'warehouse_data'}}]);_0x1c8cfa[_0x434afc(0x11f)]={},await Promise[_0x434afc(0x133)](_0x1c8cfa[_0x434afc(0x10d)](async _0x142218=>{var _0x1ede83=_0x434afc;_0x1c8cfa[_0x1ede83(0x11f)][_0x142218[_0x1ede83(0x11d)]]=[],await Promise['all'](_0x142218[_0x1ede83(0x12a)][_0x1ede83(0x10d)](async _0x1526a6=>{var _0x1a5520=_0x1ede83;const _0x4ea030=await sales_finished[_0x1a5520(0x15e)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x1526a6['_id'][_0x1a5520(0x111)](),'sale_product.invoice':_0x1526a6[_0x1a5520(0x11d)]}},{'$project':{'_id':_0x1a5520(0x13e),'product_name':_0x1a5520(0x162),'product_code':_0x1a5520(0x161),'quantity_available':_0x1a5520(0x115),'warehouse_name':_0x1a5520(0x12d),'warehouse_room':_0x1a5520(0x10c),'product_invoice':_0x1a5520(0x123),'invoice':_0x1a5520(0x10f),'id_transaction_from':_0x1a5520(0x155),'date':'$date','production_date':_0x1a5520(0x114),'expiry_date':_0x1a5520(0x13a),'UOM':_0x1a5520(0x11c)}}]);_0x4ea030[_0x1a5520(0x16c)]>0x0&&_0x1c8cfa[_0x1a5520(0x11f)][_0x142218['invoice']]['push'](..._0x4ea030);}));})),_0x1c8cfa['data_sales']=_0x1c8cfa[_0x434afc(0x11f)],_0x1c8cfa[_0x434afc(0x13d)]={},await Promise[_0x434afc(0x133)](_0x1c8cfa['map'](async _0x27c199=>{var _0xb2901e=_0x434afc;_0x1c8cfa['data_adjustment'][_0x27c199[_0xb2901e(0x11d)]]=[],await Promise[_0xb2901e(0x133)](_0x27c199[_0xb2901e(0x12a)][_0xb2901e(0x10d)](async _0x4d97fd=>{var _0x3f1d42=_0xb2901e;const _0x560b84=await adjustment_finished[_0x3f1d42(0x15e)]([{'$unwind':_0x3f1d42(0x142)},{'$match':{'product.id_transaction_from':_0x4d97fd[_0x3f1d42(0x136)][_0x3f1d42(0x111)](),'product.invoice':_0x4d97fd[_0x3f1d42(0x11d)]}},{'$project':{'_id':_0x3f1d42(0x15f),'product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':_0x3f1d42(0x128),'warehouse_name':_0x3f1d42(0x12d),'warehouse_room':_0x3f1d42(0x150),'product_invoice':'$product.invoice','invoice':_0x3f1d42(0x10f),'id_transaction_from':_0x3f1d42(0x10b),'date':_0x3f1d42(0x135),'production_date':_0x3f1d42(0x139),'expiry_date':_0x3f1d42(0x13c),'UOM':_0x3f1d42(0x125)}}]);_0x560b84[_0x3f1d42(0x16c)]>0x0&&_0x1c8cfa[_0x3f1d42(0x13d)][_0x27c199[_0x3f1d42(0x11d)]][_0x3f1d42(0x134)](..._0x560b84);}));})),_0x1c8cfa[_0x434afc(0x11b)]={},await Promise['all'](_0x1c8cfa[_0x434afc(0x10d)](async _0x53af54=>{var _0x28dbf3=_0x434afc;_0x1c8cfa[_0x28dbf3(0x11b)][_0x53af54[_0x28dbf3(0x11d)]]=[],await Promise[_0x28dbf3(0x133)](_0x53af54[_0x28dbf3(0x12a)][_0x28dbf3(0x10d)](async _0x111c9b=>{var _0x1120ee=_0x28dbf3;const _0x1ad0e3=await transfers_finished['aggregate']([{'$unwind':_0x1120ee(0x142)},{'$match':{'product.id_transaction':_0x111c9b[_0x1120ee(0x136)][_0x1120ee(0x111)](),'product.from_invoice':_0x111c9b['invoice']}},{'$project':{'_id':_0x1120ee(0x15f),'product_name':_0x1120ee(0x10e),'product_code':_0x1120ee(0x124),'quantity_available':_0x1120ee(0x11e),'warehouse_name':'$to_warehouse','warehouse_room':_0x1120ee(0x150),'product_invoice':_0x1120ee(0x14e),'invoice':_0x1120ee(0x10f),'id_transaction_from':_0x1120ee(0x116),'date':_0x1120ee(0x135),'production_date':_0x1120ee(0x139),'expiry_date':'$product.expiry_date','UOM':_0x1120ee(0x125)}}]);_0x1ad0e3[_0x1120ee(0x16c)]>0x0&&_0x1c8cfa[_0x1120ee(0x11b)][_0x53af54[_0x1120ee(0x11d)]][_0x1120ee(0x134)](..._0x1ad0e3);}));})),_0x5eb84a[_0x434afc(0x149)]({'purchases_warehouse':_0x1c8cfa,'data_sales':_0x1c8cfa['data_sales'],'data_adjustment':_0x1c8cfa[_0x434afc(0x13d)],'data_transfer':_0x1c8cfa['data_transfer']});}}}),router['get'](a0_0xe570f9(0x12f),auth,async(_0x1afc85,_0x5f4149)=>{var _0x379420=a0_0xe570f9;try{const _0x26312f=_0x1afc85[_0x379420(0x14d)]['id'];var _0x23c99b=await purchases_finished[_0x379420(0x15b)](_0x26312f);const _0x559bcc=await master_shop[_0x379420(0x165)](),_0x1dc293=_0x1afc85['user'],_0x50ec41=await profile[_0x379420(0x163)]({'email':_0x1dc293['email']});if(_0x559bcc[0x0][_0x379420(0x16a)]==_0x379420(0x16f))var _0x54a3ba=users[_0x379420(0x132)];else{if(_0x559bcc[0x0][_0x379420(0x16a)]=='Hindi')var _0x54a3ba=users['Hindi'];else{if(_0x559bcc[0x0]['language']==_0x379420(0x144))var _0x54a3ba=users[_0x379420(0x144)];else{if(_0x559bcc[0x0]['language']==_0x379420(0x122))var _0x54a3ba=users[_0x379420(0x122)];else{if(_0x559bcc[0x0]['language']==_0x379420(0x129))var _0x54a3ba=users[_0x379420(0x129)];else{if(_0x559bcc[0x0][_0x379420(0x16a)]=='Portuguese\x20(BR)')var _0x54a3ba=users[_0x379420(0x159)];else{if(_0x559bcc[0x0][_0x379420(0x16a)]==_0x379420(0x157))var _0x54a3ba=users[_0x379420(0x157)];else{if(_0x559bcc[0x0]['language']=='Arabic\x20(ae)')var _0x54a3ba=users[_0x379420(0x15c)];}}}}}}}_0x5f4149['render']('view_table',{'success':_0x1afc85[_0x379420(0x137)](_0x379420(0x10a)),'errors':_0x1afc85[_0x379420(0x137)](_0x379420(0x117)),'master_shop':_0x559bcc,'profile':_0x50ec41,'role':_0x1dc293,'language':_0x54a3ba,'data':_0x23c99b});}catch(_0x203004){_0x5f4149[_0x379420(0x149)](_0x203004);}}),router[a0_0xe570f9(0x153)](a0_0xe570f9(0x164),auth,async(_0x1af600,_0x249738)=>{var _0x3652e8=a0_0xe570f9;try{const _0x44b5f4=_0x1af600[_0x3652e8(0x14d)]['id'];var _0x632eeb=await sales_finished[_0x3652e8(0x15b)](_0x44b5f4);const _0x533bb0=await master_shop['find'](),_0xd79bf=_0x1af600[_0x3652e8(0x108)],_0x5f1cc6=await profile[_0x3652e8(0x163)]({'email':_0xd79bf[_0x3652e8(0x12c)]});if(_0x533bb0[0x0]['language']=='English\x20(US)')var _0x269acf=users['English'];else{if(_0x533bb0[0x0][_0x3652e8(0x16a)]==_0x3652e8(0x166))var _0x269acf=users[_0x3652e8(0x166)];else{if(_0x533bb0[0x0][_0x3652e8(0x16a)]==_0x3652e8(0x144))var _0x269acf=users[_0x3652e8(0x144)];else{if(_0x533bb0[0x0][_0x3652e8(0x16a)]==_0x3652e8(0x122))var _0x269acf=users[_0x3652e8(0x122)];else{if(_0x533bb0[0x0][_0x3652e8(0x16a)]==_0x3652e8(0x129))var _0x269acf=users[_0x3652e8(0x129)];else{if(_0x533bb0[0x0][_0x3652e8(0x16a)]==_0x3652e8(0x15d))var _0x269acf=users['Portuguese'];else{if(_0x533bb0[0x0][_0x3652e8(0x16a)]==_0x3652e8(0x157))var _0x269acf=users[_0x3652e8(0x157)];else{if(_0x533bb0[0x0][_0x3652e8(0x16a)]==_0x3652e8(0x14a))var _0x269acf=users[_0x3652e8(0x15c)];}}}}}}}_0x249738[_0x3652e8(0x146)](_0x3652e8(0x15a),{'success':_0x1af600[_0x3652e8(0x137)](_0x3652e8(0x10a)),'errors':_0x1af600[_0x3652e8(0x137)](_0x3652e8(0x117)),'master_shop':_0x533bb0,'profile':_0x5f1cc6,'role':_0xd79bf,'language':_0x269acf,'data':_0x632eeb});}catch(_0x38fde7){_0x249738[_0x3652e8(0x149)](_0x38fde7);}}),router[a0_0xe570f9(0x153)]('/viewdata_tf_fg/:id',auth,async(_0x5bcd9a,_0x576401)=>{var _0x736c5a=a0_0xe570f9;try{const _0x5cbd2c=_0x5bcd9a['params']['id'];var _0x56e4f0=await transfers_finished[_0x736c5a(0x15b)](_0x5cbd2c);const _0x25b1d8=await master_shop[_0x736c5a(0x165)](),_0x1c0fb1=_0x5bcd9a[_0x736c5a(0x108)],_0x1c5a60=await profile[_0x736c5a(0x163)]({'email':_0x1c0fb1[_0x736c5a(0x12c)]});if(_0x25b1d8[0x0][_0x736c5a(0x16a)]=='English\x20(US)')var _0x2f9a4f=users[_0x736c5a(0x132)];else{if(_0x25b1d8[0x0][_0x736c5a(0x16a)]==_0x736c5a(0x166))var _0x2f9a4f=users['Hindi'];else{if(_0x25b1d8[0x0][_0x736c5a(0x16a)]=='German')var _0x2f9a4f=users[_0x736c5a(0x144)];else{if(_0x25b1d8[0x0][_0x736c5a(0x16a)]==_0x736c5a(0x122))var _0x2f9a4f=users[_0x736c5a(0x122)];else{if(_0x25b1d8[0x0]['language']==_0x736c5a(0x129))var _0x2f9a4f=users['French'];else{if(_0x25b1d8[0x0][_0x736c5a(0x16a)]==_0x736c5a(0x15d))var _0x2f9a4f=users[_0x736c5a(0x159)];else{if(_0x25b1d8[0x0][_0x736c5a(0x16a)]==_0x736c5a(0x157))var _0x2f9a4f=users[_0x736c5a(0x157)];else{if(_0x25b1d8[0x0][_0x736c5a(0x16a)]=='Arabic\x20(ae)')var _0x2f9a4f=users['Arabic'];}}}}}}}_0x576401[_0x736c5a(0x146)](_0x736c5a(0x110),{'success':_0x5bcd9a[_0x736c5a(0x137)](_0x736c5a(0x10a)),'errors':_0x5bcd9a[_0x736c5a(0x137)](_0x736c5a(0x117)),'master_shop':_0x25b1d8,'profile':_0x1c5a60,'role':_0x1c0fb1,'language':_0x2f9a4f,'data':_0x56e4f0});}catch(_0x1a8524){_0x576401[_0x736c5a(0x149)](_0x1a8524);}}),router[a0_0xe570f9(0x153)](a0_0xe570f9(0x121),auth,async(_0x30fec8,_0x20924e)=>{var _0x111d71=a0_0xe570f9;try{const {username:_0x2c0b8b,email:_0x4c090f,role:_0x435567}=_0x30fec8[_0x111d71(0x108)],_0x1fc8a4=_0x30fec8[_0x111d71(0x108)],_0x101c98=await profile[_0x111d71(0x163)]({'email':_0x1fc8a4['email']}),_0x30ac04=await master_shop[_0x111d71(0x165)](),_0x450689=await warehouse[_0x111d71(0x15e)]([{'$match':{'status':_0x111d71(0x14f),'warehouse_category':_0x111d71(0x148)}},{'$group':{'_id':_0x111d71(0x113),'name':{'$first':'$name'}}}]);if(_0x30ac04[0x0][_0x111d71(0x16a)]=='English\x20(US)')var _0x172f68=users['English'];else{if(_0x30ac04[0x0][_0x111d71(0x16a)]==_0x111d71(0x166))var _0x172f68=users[_0x111d71(0x166)];else{if(_0x30ac04[0x0][_0x111d71(0x16a)]=='German')var _0x172f68=users[_0x111d71(0x144)];else{if(_0x30ac04[0x0]['language']=='Spanish')var _0x172f68=users[_0x111d71(0x122)];else{if(_0x30ac04[0x0][_0x111d71(0x16a)]==_0x111d71(0x129))var _0x172f68=users[_0x111d71(0x129)];else{if(_0x30ac04[0x0]['language']==_0x111d71(0x15d))var _0x172f68=users[_0x111d71(0x159)];else{if(_0x30ac04[0x0]['language']==_0x111d71(0x157))var _0x172f68=users[_0x111d71(0x157)];else{if(_0x30ac04[0x0][_0x111d71(0x16a)]==_0x111d71(0x14a))var _0x172f68=users[_0x111d71(0x15c)];}}}}}}}_0x20924e[_0x111d71(0x146)]('transaction_finished_raw',{'success':_0x30fec8[_0x111d71(0x137)](_0x111d71(0x10a)),'errors':_0x30fec8[_0x111d71(0x137)](_0x111d71(0x117)),'role':_0x1fc8a4,'profile':_0x101c98,'master_shop':_0x30ac04,'dataProcess':_0x450689,'language':_0x172f68});}catch(_0x538c78){console[_0x111d71(0x16b)](_0x538c78);}}),module[a0_0xe570f9(0x107)]=router;