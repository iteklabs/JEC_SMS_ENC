var a0_0x240a0e=a0_0x4f1f;(function(_0x400938,_0x9b7903){var _0x551ea8=a0_0x4f1f,_0x344c41=_0x400938();while(!![]){try{var _0x4a25d0=-parseInt(_0x551ea8(0x9b))/0x1*(parseInt(_0x551ea8(0x143))/0x2)+parseInt(_0x551ea8(0x81))/0x3+-parseInt(_0x551ea8(0x130))/0x4+parseInt(_0x551ea8(0xa9))/0x5+-parseInt(_0x551ea8(0xf5))/0x6*(-parseInt(_0x551ea8(0xf8))/0x7)+parseInt(_0x551ea8(0x8a))/0x8*(-parseInt(_0x551ea8(0x142))/0x9)+parseInt(_0x551ea8(0xe4))/0xa;if(_0x4a25d0===_0x9b7903)break;else _0x344c41['push'](_0x344c41['shift']());}catch(_0x516151){_0x344c41['push'](_0x344c41['shift']());}}}(a0_0x42e1,0x46578));function a0_0x4f1f(_0x311039,_0x163d0b){var _0x42e184=a0_0x42e1();return a0_0x4f1f=function(_0x4f1f77,_0x4d6775){_0x4f1f77=_0x4f1f77-0x80;var _0x377a54=_0x42e184[_0x4f1f77];return _0x377a54;},a0_0x4f1f(_0x311039,_0x163d0b);}const express=require('express'),app=express(),router=express[a0_0x240a0e(0xec)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x240a0e(0xc6)),auth=require(a0_0x240a0e(0xdd)),users=require(a0_0x240a0e(0x124)),nodemailer=require(a0_0x240a0e(0x131));function a0_0x42e1(){var _0xbbc3c0=['params','string','edit_transfer_finished_view','/view/addlog','$product_details.invoice','product_details','push','Rack\x201','/view/add_transfer_logs','1980432AQQCIC','nodemailer','/transfer_finished/preview/','$product_details.floorlevel','$product_details.maxPerUnit','$date','Hindi','id_transaction','$product_details.secondary_code','\x20<=>\x20','\x20<>\x20','LOG-TRF-','from_prod_level2','bay','from_prod_qty','$product_details.type','from_room','TRFF-','5895VQXwbN','10CBtoFg','/view/choose_logs','here2','True','batch_code','/transfer/view','production_date','FROZEN\x20GOODS','$product_details.bay','to_room','1559412VLZsdY','French','transfer_data','max','staff','location2location','DRY\x20GOODS','from_quantity','errors','6224HLKoDz','log','post','/transfer_finished/view','$product_details.bin','date','$room','Product\x20Transfer\x20successfully','/view/:id','unit','secondary_code','undefined','from_room_name','/view','product_date','findById','from_invoice','82810TiPhIm','/picking_list/PDF_transfer/','$product.from_room_name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','RoomAssigned','English','$product_details.rack','Spanish','/CheckingWarehouse','Finished\x20Goods','exports','$product_details.product_stock','to_warehouse','warehouse','2482900TEQOJD','own','toString','to_bay','TRF-','catch','Transfer\x20Edit\x20Successfully','getFullYear','<tr>','/view/add_transfer_loc','Portuguese','prod_cat','$product_details.secondary_unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','to_floorlevel','language','bin2bin','maxProducts','English\x20(US)','map','secondary_unit','$product_details._id','invoice','$product_details.unit','abs','finalize','product','filter','getMonth','../models/all_models','Rack\x202','from_bay','product_code','findOne','length','find','error','product_code3','/view/add_transfer','role','floor','render','prod_name','An\x20error\x20occurred.','slice','message','/view/choose','Chinese','updateOne','$product','$name','</tr>','../middleware/auth','get','all','to_prod_level','$product.to_room_name','padStart','$product_details.product_code','3617750SxBwrT','from_level','to_room_name','forEach','Arabic\x20(ae)','_id','ToRoomAssigned','MaxStocks_data2','Router','split','$product_details.level','Portuguese\x20(BR)','flash','$product_details.expiry_date','email','transfer_finished','logs','6jEkrpB','product_name','body','2300963YKhDWL','redirect','json','product_stock','$to_warehouse','German','success','add_transfer_finished','Enclosed','user','primary_unit','$product_details.production_date','concat','status','To_invoice','Ambient','expiry_date','New_Qty_Converted','to_level','$invoice','maxPerUnit','back','then','invoice_init','$product_details.storage','match','note','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$_id','save','aggregate','$from_warehouse','/preview/:id','edit_transfer_finished','to_quantity','$product_details.primary_code','MaxStocks_data','$product_details','Arabic','$product_details.batch_code','Enabled','from_prod_level','$product_details.product_name','</td>','../public/language/languages.json','primary_code','from_warehouse'];a0_0x42e1=function(){return _0xbbc3c0;};return a0_0x42e1();}router[a0_0x240a0e(0xde)](a0_0x240a0e(0x97),auth,async(_0x4b5e93,_0x164e26)=>{var _0x43b158=a0_0x240a0e;try{const {username:_0x104cdc,email:_0x394649,role:_0x1fe104}=_0x4b5e93[_0x43b158(0x101)],_0x4a1d06=_0x4b5e93[_0x43b158(0x101)],_0x56c62d=await profile[_0x43b158(0xca)]({'email':_0x4a1d06['email']}),_0x3400cd=await master_shop['find']();let _0x208842;if(_0x4a1d06['role']==_0x43b158(0x85)){const _0x4b2c95=await staff[_0x43b158(0xca)]({'email':_0x4a1d06[_0x43b158(0xf2)]});_0x208842=await transfers_finished[_0x43b158(0xcc)]({'from_warehouse':_0x4b2c95[_0x43b158(0xa8)]});}else _0x208842=await transfers_finished[_0x43b158(0x116)]([{'$match':{'type_of_transaction':_0x43b158(0xaa)}},{'$unwind':_0x43b158(0xda)},{'$group':{'_id':_0x43b158(0x114),'invoice':{'$first':'$invoice'},'date':{'$first':_0x43b158(0x135)},'from_warehouse':{'$first':_0x43b158(0x117)},'to_warehouse':{'$first':_0x43b158(0xfc)},'from_room_name':{'$addToSet':_0x43b158(0x9d)},'to_room_name':{'$addToSet':_0x43b158(0xe1)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3400cd[0x0]['language']==_0x43b158(0xbb))var _0x46c632=users[_0x43b158(0xa0)];else{if(_0x3400cd[0x0][_0x43b158(0xb8)]=='Hindi')var _0x46c632=users[_0x43b158(0x136)];else{if(_0x3400cd[0x0][_0x43b158(0xb8)]==_0x43b158(0xfd))var _0x46c632=users[_0x43b158(0xfd)];else{if(_0x3400cd[0x0][_0x43b158(0xb8)]==_0x43b158(0xa2))var _0x46c632=users[_0x43b158(0xa2)];else{if(_0x3400cd[0x0][_0x43b158(0xb8)]==_0x43b158(0x82))var _0x46c632=users['French'];else{if(_0x3400cd[0x0][_0x43b158(0xb8)]==_0x43b158(0xef))var _0x46c632=users[_0x43b158(0xb3)];else{if(_0x3400cd[0x0][_0x43b158(0xb8)]==_0x43b158(0xd8))var _0x46c632=users[_0x43b158(0xd8)];else{if(_0x3400cd[0x0]['language']==_0x43b158(0xe8))var _0x46c632=users[_0x43b158(0x11e)];}}}}}}}_0x164e26[_0x43b158(0xd2)](_0x43b158(0xf3),{'success':_0x4b5e93['flash'](_0x43b158(0xfe)),'errors':_0x4b5e93[_0x43b158(0xf0)](_0x43b158(0x89)),'role':_0x4a1d06,'profile':_0x56c62d,'master_shop':_0x3400cd,'transfer':_0x208842,'language':_0x46c632});}catch(_0x47f7ae){console[_0x43b158(0x8b)](_0x47f7ae);}}),router['get']('/view_logs',auth,async(_0x1b391b,_0x1d2b85)=>{var _0x112e24=a0_0x240a0e;try{const {username:_0x445548,email:_0x4ad961,role:_0x44d771}=_0x1b391b[_0x112e24(0x101)],_0x50087e=_0x1b391b['user'],_0x5b7ff5=await profile[_0x112e24(0xca)]({'email':_0x50087e[_0x112e24(0xf2)]}),_0x536c2a=await master_shop[_0x112e24(0xcc)]();let _0x383659;if(_0x50087e[_0x112e24(0xd0)]=='staff'){const _0x5dcc1c=await staff[_0x112e24(0xca)]({'email':_0x50087e[_0x112e24(0xf2)]});_0x383659=await transfers_finished[_0x112e24(0xcc)]({'from_warehouse':_0x5dcc1c[_0x112e24(0xa8)]});}else _0x383659=await transfers_finished[_0x112e24(0x116)]([{'$match':{'type_of_transaction':_0x112e24(0xf4)}},{'$unwind':_0x112e24(0xda)},{'$group':{'_id':'$_id','invoice':{'$first':_0x112e24(0x10b)},'date':{'$first':_0x112e24(0x135)},'from_warehouse':{'$first':_0x112e24(0x117)},'to_warehouse':{'$first':_0x112e24(0xfc)},'from_room_name':{'$addToSet':_0x112e24(0x9d)},'to_room_name':{'$addToSet':_0x112e24(0xe1)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x536c2a[0x0][_0x112e24(0xb8)]==_0x112e24(0xbb))var _0x5685f2=users[_0x112e24(0xa0)];else{if(_0x536c2a[0x0]['language']==_0x112e24(0x136))var _0x5685f2=users[_0x112e24(0x136)];else{if(_0x536c2a[0x0][_0x112e24(0xb8)]==_0x112e24(0xfd))var _0x5685f2=users['German'];else{if(_0x536c2a[0x0][_0x112e24(0xb8)]=='Spanish')var _0x5685f2=users[_0x112e24(0xa2)];else{if(_0x536c2a[0x0][_0x112e24(0xb8)]==_0x112e24(0x82))var _0x5685f2=users[_0x112e24(0x82)];else{if(_0x536c2a[0x0][_0x112e24(0xb8)]==_0x112e24(0xef))var _0x5685f2=users['Portuguese'];else{if(_0x536c2a[0x0][_0x112e24(0xb8)]==_0x112e24(0xd8))var _0x5685f2=users[_0x112e24(0xd8)];else{if(_0x536c2a[0x0][_0x112e24(0xb8)]==_0x112e24(0xe8))var _0x5685f2=users[_0x112e24(0x11e)];}}}}}}}_0x1d2b85['render']('transfer_finished_logs',{'success':_0x1b391b[_0x112e24(0xf0)](_0x112e24(0xfe)),'errors':_0x1b391b[_0x112e24(0xf0)](_0x112e24(0x89)),'role':_0x50087e,'profile':_0x5b7ff5,'master_shop':_0x536c2a,'transfer':_0x383659,'language':_0x5685f2});}catch(_0x4ca9eb){console[_0x112e24(0x8b)](_0x4ca9eb);}});async function getRandom8DigitNumber(){var _0x1fb8ab=a0_0x240a0e;const _0x12b198=0x989680,_0x2497b0=0x5f5e0ff,_0x3c13c9=Math[_0x1fb8ab(0xd1)](Math['random']()*(_0x2497b0-_0x12b198+0x1))+_0x12b198;var _0x90b696;const _0x738eb3=await transfers_finished[_0x1fb8ab(0xca)]({'invoice':_0x1fb8ab(0x141)+_0x3c13c9});return _0x738eb3&&_0x738eb3[_0x1fb8ab(0xcb)]>0x0?_0x90b696=_0x1fb8ab(0x141)+_0x3c13c9:_0x90b696='TRFF-'+_0x3c13c9,_0x90b696;}router[a0_0x240a0e(0xde)]('/view/add_transfer',auth,async(_0x2fcd90,_0x15beda)=>{var _0xbcaf1c=a0_0x240a0e;try{const {username:_0xb4d425,email:_0x5cdce2,role:_0x2bbca0}=_0x2fcd90[_0xbcaf1c(0x101)],_0x2b25ee=_0x2fcd90['user'],_0x392181=await profile['findOne']({'email':_0x2b25ee[_0xbcaf1c(0xf2)]}),_0x6fb69c=await master_shop['find']();let _0x32a442;if(_0x2b25ee['role']=='staff'){const _0x5ae9c7=await staff['findOne']({'email':_0x2b25ee[_0xbcaf1c(0xf2)]});_0x32a442=await warehouse['aggregate']([{'$match':{'status':_0xbcaf1c(0x120),'name':_0x5ae9c7[_0xbcaf1c(0xa8)]}},{'$group':{'_id':_0xbcaf1c(0xdb),'name':{'$first':_0xbcaf1c(0xdb)}}}]);}else _0x32a442=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0xbcaf1c(0xdb),'name':{'$first':'$name'}}}]);const _0x1b6648=await transfers_finished[_0xbcaf1c(0xcc)]({}),_0x3c032e=_0x1b6648['length']+0x1,_0x51ef7e=_0xbcaf1c(0x141)+_0x3c032e[_0xbcaf1c(0xab)]()[_0xbcaf1c(0xe2)](0x5,'0');if(_0x6fb69c[0x0][_0xbcaf1c(0xb8)]=='English\x20(US)')var _0x526d5f=users['English'];else{if(_0x6fb69c[0x0]['language']=='Hindi')var _0x526d5f=users[_0xbcaf1c(0x136)];else{if(_0x6fb69c[0x0][_0xbcaf1c(0xb8)]==_0xbcaf1c(0xfd))var _0x526d5f=users[_0xbcaf1c(0xfd)];else{if(_0x6fb69c[0x0][_0xbcaf1c(0xb8)]==_0xbcaf1c(0xa2))var _0x526d5f=users['Spanish'];else{if(_0x6fb69c[0x0][_0xbcaf1c(0xb8)]==_0xbcaf1c(0x82))var _0x526d5f=users[_0xbcaf1c(0x82)];else{if(_0x6fb69c[0x0]['language']==_0xbcaf1c(0xef))var _0x526d5f=users[_0xbcaf1c(0xb3)];else{if(_0x6fb69c[0x0][_0xbcaf1c(0xb8)]==_0xbcaf1c(0xd8))var _0x526d5f=users['Chinese'];else{if(_0x6fb69c[0x0][_0xbcaf1c(0xb8)]==_0xbcaf1c(0xe8))var _0x526d5f=users[_0xbcaf1c(0x11e)];}}}}}}}const _0x222ddf=getRandom8DigitNumber();_0x222ddf[_0xbcaf1c(0x10e)](_0x20519f=>{var _0x40263f=_0xbcaf1c;_0x15beda['render'](_0x40263f(0xff),{'success':_0x2fcd90[_0x40263f(0xf0)](_0x40263f(0xfe)),'errors':_0x2fcd90[_0x40263f(0xf0)]('errors'),'role':_0x2b25ee,'profile':_0x392181,'master_shop':_0x6fb69c,'warehouse':_0x32a442,'language':_0x526d5f,'invoice':_0x20519f});})['catch'](_0xc6350=>{var _0x50b3b6=_0xbcaf1c;_0x2fcd90[_0x50b3b6(0xf0)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x15beda[_0x50b3b6(0xf9)](_0x50b3b6(0x148));});}catch(_0x4e6121){console[_0xbcaf1c(0x8b)](_0x4e6121);}}),router['get'](a0_0x240a0e(0xd7),auth,async(_0x16b295,_0x2edd13)=>{var _0x2daf04=a0_0x240a0e;try{const {username:_0x3dd4d6,email:_0x5e1c99,role:_0x331c03}=_0x16b295['user'],_0x328aec=_0x16b295['user'],_0x4cbc49=await profile[_0x2daf04(0xca)]({'email':_0x328aec[_0x2daf04(0xf2)]}),_0x3b53b4=await master_shop['find']();let _0x59231b;if(_0x328aec[_0x2daf04(0xd0)]==_0x2daf04(0x85)){const _0x5ae065=await staff[_0x2daf04(0xca)]({'email':_0x328aec[_0x2daf04(0xf2)]});_0x59231b=await warehouse[_0x2daf04(0x116)]([{'$match':{'status':_0x2daf04(0x120),'name':_0x5ae065['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0x2daf04(0xdb)}}}]);}else _0x59231b=await warehouse[_0x2daf04(0x116)]([{'$match':{'status':_0x2daf04(0x120)}},{'$group':{'_id':_0x2daf04(0xdb),'name':{'$first':'$name'}}}]);const _0x2e2b3b=await transfers_finished[_0x2daf04(0xcc)]({}),_0x146a36=_0x2e2b3b[_0x2daf04(0xcb)]+0x1,_0x1c4172=_0x2daf04(0x141)+_0x146a36[_0x2daf04(0xab)]()[_0x2daf04(0xe2)](0x5,'0');if(_0x3b53b4[0x0]['language']==_0x2daf04(0xbb))var _0x3b1857=users[_0x2daf04(0xa0)];else{if(_0x3b53b4[0x0]['language']==_0x2daf04(0x136))var _0x3b1857=users[_0x2daf04(0x136)];else{if(_0x3b53b4[0x0][_0x2daf04(0xb8)]==_0x2daf04(0xfd))var _0x3b1857=users[_0x2daf04(0xfd)];else{if(_0x3b53b4[0x0][_0x2daf04(0xb8)]==_0x2daf04(0xa2))var _0x3b1857=users[_0x2daf04(0xa2)];else{if(_0x3b53b4[0x0][_0x2daf04(0xb8)]==_0x2daf04(0x82))var _0x3b1857=users[_0x2daf04(0x82)];else{if(_0x3b53b4[0x0][_0x2daf04(0xb8)]==_0x2daf04(0xef))var _0x3b1857=users[_0x2daf04(0xb3)];else{if(_0x3b53b4[0x0][_0x2daf04(0xb8)]==_0x2daf04(0xd8))var _0x3b1857=users[_0x2daf04(0xd8)];else{if(_0x3b53b4[0x0]['language']==_0x2daf04(0xe8))var _0x3b1857=users['Arabic'];}}}}}}}const _0x1f730f=getRandom8DigitNumber();_0x1f730f[_0x2daf04(0x10e)](_0x1fb8e3=>{var _0x10ff72=_0x2daf04;_0x2edd13[_0x10ff72(0xd2)]('choos_transfer',{'success':_0x16b295['flash'](_0x10ff72(0xfe)),'errors':_0x16b295['flash'](_0x10ff72(0x89)),'role':_0x328aec,'profile':_0x4cbc49,'master_shop':_0x3b53b4,'warehouse':_0x59231b,'language':_0x3b1857,'invoice':_0x1fb8e3});})[_0x2daf04(0xae)](_0x3d265d=>{var _0x5db2a4=_0x2daf04;_0x16b295[_0x5db2a4(0xf0)]('errors',_0x5db2a4(0xb6)),_0x2edd13[_0x5db2a4(0xf9)](_0x5db2a4(0x148));});}catch(_0x36943f){console[_0x2daf04(0x8b)](_0x36943f);}}),router[a0_0x240a0e(0xde)](a0_0x240a0e(0x144),auth,async(_0x1e308d,_0x2f6053)=>{var _0xf7274b=a0_0x240a0e;try{const {username:_0x3ebe95,email:_0x4a2a39,role:_0x2d073d}=_0x1e308d[_0xf7274b(0x101)],_0xbfeedf=_0x1e308d['user'],_0x3cdcfd=await profile['findOne']({'email':_0xbfeedf[_0xf7274b(0xf2)]}),_0x3adcc8=await master_shop['find']();let _0x5072dc;if(_0xbfeedf['role']==_0xf7274b(0x85)){const _0x1b4402=await staff[_0xf7274b(0xca)]({'email':_0xbfeedf[_0xf7274b(0xf2)]});_0x5072dc=await warehouse[_0xf7274b(0x116)]([{'$match':{'status':_0xf7274b(0x120),'name':_0x1b4402[_0xf7274b(0xa8)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x5072dc=await warehouse[_0xf7274b(0x116)]([{'$match':{'status':_0xf7274b(0x120)}},{'$group':{'_id':_0xf7274b(0xdb),'name':{'$first':'$name'}}}]);const _0x4aaacc=await transfers_finished[_0xf7274b(0xcc)]({}),_0x855f09=_0x4aaacc[_0xf7274b(0xcb)]+0x1,_0x2abdd6=_0xf7274b(0x141)+_0x855f09['toString']()[_0xf7274b(0xe2)](0x5,'0');if(_0x3adcc8[0x0]['language']=='English\x20(US)')var _0x99c5a3=users[_0xf7274b(0xa0)];else{if(_0x3adcc8[0x0][_0xf7274b(0xb8)]==_0xf7274b(0x136))var _0x99c5a3=users[_0xf7274b(0x136)];else{if(_0x3adcc8[0x0][_0xf7274b(0xb8)]==_0xf7274b(0xfd))var _0x99c5a3=users[_0xf7274b(0xfd)];else{if(_0x3adcc8[0x0]['language']=='Spanish')var _0x99c5a3=users[_0xf7274b(0xa2)];else{if(_0x3adcc8[0x0]['language']==_0xf7274b(0x82))var _0x99c5a3=users[_0xf7274b(0x82)];else{if(_0x3adcc8[0x0]['language']==_0xf7274b(0xef))var _0x99c5a3=users[_0xf7274b(0xb3)];else{if(_0x3adcc8[0x0]['language']==_0xf7274b(0xd8))var _0x99c5a3=users[_0xf7274b(0xd8)];else{if(_0x3adcc8[0x0][_0xf7274b(0xb8)]=='Arabic\x20(ae)')var _0x99c5a3=users['Arabic'];}}}}}}}const _0x141dc1=getRandom8DigitNumber();_0x141dc1['then'](_0xb696e6=>{var _0x2f3b9f=_0xf7274b;_0x2f6053[_0x2f3b9f(0xd2)]('choos_transfer_logs',{'success':_0x1e308d[_0x2f3b9f(0xf0)]('success'),'errors':_0x1e308d[_0x2f3b9f(0xf0)](_0x2f3b9f(0x89)),'role':_0xbfeedf,'profile':_0x3cdcfd,'master_shop':_0x3adcc8,'warehouse':_0x5072dc,'language':_0x99c5a3,'invoice':_0xb696e6});})['catch'](_0xe3c519=>{var _0x1a7ab7=_0xf7274b;_0x1e308d[_0x1a7ab7(0xf0)](_0x1a7ab7(0x89),_0x1a7ab7(0xb6)),_0x2f6053[_0x1a7ab7(0xf9)](_0x1a7ab7(0x148));});}catch(_0x5ae381){console[_0xf7274b(0x8b)](_0x5ae381);}}),router[a0_0x240a0e(0x8c)](a0_0x240a0e(0x12f),auth,async(_0x55f054,_0x1510f4)=>{var _0x4b7203=a0_0x240a0e;try{const {date:_0x4a2ea4,from_warehouse:_0x42f3d1,FromRoom_name:_0x4b23e1,to_warehouse:_0x4b2426,ToRoom_name:_0x304455,prod_name:_0xa1bd31,from_prod_qty:_0x25a3bf,from_prod_level:_0x582a87,from_prod_isle:_0xa7d9dc,from_prod_pallet:_0x27f42d,to_prod_qty:_0x5acc86,to_prod_level:_0x248131,to_prod_isle:_0x3f18e9,to_prod_pallet:_0x1b7804,primary_code:_0x21830a,secondary_code:_0x671c98,product_code3:_0x191b49,note:_0x27c508,MaxStocks_data2:_0x125939,invoice:_0x28d845,expiry_date:_0x3f3728,PO_number:_0x3432e3,ReqBy:_0x64056b,dateofreq:_0x19da98,typeservicesData:_0x5eddd3,destination:_0x2454c7,deliverydate:_0x943beb,driver:_0xfb4de8,plate:_0x140ac2,van:_0x3d795d,DRSI:_0x2caa20,typevehicle:_0x145eda,TSU:_0x1642f0,TFU:_0x5ed550}=_0x55f054[_0x4b7203(0xf7)];if(typeof _0xa1bd31=='string')var _0x114a00=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xd3)]],_0x5cf49a=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x13e)]],_0x5d0f60=[_0x55f054['body'][_0x4b7203(0x13c)]],_0x4b167c=[_0x55f054['body'][_0x4b7203(0x109)]],_0x2f7b24=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xe0)]],_0x49e7f0=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x125)]],_0x4eed0d=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x94)]],_0x368d5c=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xce)]],_0x93131f=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xeb)]],_0x2b8dcf=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x102)]],_0x5622cd=[_0x55f054[_0x4b7203(0xf7)]['secondary_unit']],_0x25ae8d=[_0x55f054[_0x4b7203(0xf7)]['batch_code']],_0x1f6de6=[_0x55f054['body']['expiry_date']],_0x45bfd0=[_0x55f054['body']['product_date']],_0x5f3d86=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x11c)]],_0x1dfca7=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x10c)]],_0x33f02f=[_0x55f054[_0x4b7203(0xf7)]['prod_cat']],_0x1a3400=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x9f)]],_0x2c5f8f=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xea)]],_0x4847d3=[_0x55f054['body'][_0x4b7203(0x9a)]],_0x1b589e=[_0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x137)]];else var _0x114a00=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xd3)]],_0x5cf49a=[..._0x55f054[_0x4b7203(0xf7)]['from_prod_qty']],_0x5d0f60=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x13c)]],_0x4b167c=[..._0x55f054[_0x4b7203(0xf7)]['New_Qty_Converted']],_0x2f7b24=[..._0x55f054['body'][_0x4b7203(0xe0)]],_0x49e7f0=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x125)]],_0x4eed0d=[..._0x55f054['body'][_0x4b7203(0x94)]],_0x368d5c=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xce)]],_0x93131f=[..._0x55f054['body'][_0x4b7203(0xeb)]],_0x2b8dcf=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x102)]],_0x5622cd=[..._0x55f054[_0x4b7203(0xf7)]['secondary_unit']],_0x25ae8d=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x147)]],_0x1f6de6=[..._0x55f054['body'][_0x4b7203(0x108)]],_0x45bfd0=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x98)]],_0x5f3d86=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x11c)]],_0x1dfca7=[..._0x55f054['body'][_0x4b7203(0x10c)]],_0x33f02f=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xb4)]],_0x1a3400=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x9f)]],_0x2c5f8f=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0xea)]],_0x4847d3=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x9a)]],_0x1b589e=[..._0x55f054[_0x4b7203(0xf7)][_0x4b7203(0x137)]];const _0xe6abf6=_0x114a00[_0x4b7203(0xbc)](_0x3a6162=>{return _0x3a6162={'product_name':_0x3a6162};});_0x5cf49a[_0x4b7203(0xe7)]((_0x43bbe0,_0x1e3957)=>{var _0x93902d=_0x4b7203;_0xe6abf6[_0x1e3957][_0x93902d(0x88)]=_0x43bbe0;}),_0x5d0f60['forEach']((_0x25acbe,_0xc61db5)=>{var _0xf4d361=_0x4b7203,_0x3668c4=_0x25acbe[_0xf4d361(0x111)](/[A-Za-z]+/)[0x0],_0x34fbf9=parseInt(_0x25acbe[_0xf4d361(0x111)](/\d+/)[0x0]);_0xe6abf6[_0xc61db5][_0xf4d361(0xc8)]=_0x34fbf9,_0xe6abf6[_0xc61db5]['from_level']=_0x3668c4;}),_0x1b589e['forEach']((_0x462e8f,_0x275a09)=>{var _0x459285=_0x4b7203;_0xe6abf6[_0x275a09][_0x459285(0x137)]=_0x462e8f;}),_0x4847d3[_0x4b7203(0xe7)]((_0x5c7186,_0x8edf81)=>{_0xe6abf6[_0x8edf81]['from_invoice']=_0x5c7186;}),_0x4b167c[_0x4b7203(0xe7)]((_0x132dc3,_0x5093b1)=>{var _0x138764=_0x4b7203;_0xe6abf6[_0x5093b1][_0x138764(0x11a)]=_0x132dc3;}),_0x2f7b24[_0x4b7203(0xe7)]((_0x45030f,_0xdccb22)=>{var _0x1b9389=_0x4b7203,_0x5abc9c=_0x45030f[_0x1b9389(0x111)](/[A-Za-z]+/)[0x0],_0x53ea7a=parseInt(_0x45030f[_0x1b9389(0x111)](/\d+/)[0x0]);_0xe6abf6[_0xdccb22]['to_level']=_0x5abc9c,_0xe6abf6[_0xdccb22][_0x1b9389(0xac)]=_0x53ea7a;}),_0x49e7f0[_0x4b7203(0xe7)]((_0x20c79f,_0x4c9d0a)=>{_0xe6abf6[_0x4c9d0a]['primary_code']=_0x20c79f;}),_0x4eed0d[_0x4b7203(0xe7)]((_0x58a89d,_0xd2b741)=>{_0xe6abf6[_0xd2b741]['secondary_code']=_0x58a89d;}),_0x368d5c[_0x4b7203(0xe7)]((_0x40af84,_0x20b5f2)=>{_0xe6abf6[_0x20b5f2]['product_code']=_0x40af84;}),_0x93131f[_0x4b7203(0xe7)]((_0x3b8e68,_0x4c5266)=>{var _0x35753f=_0x4b7203;_0xe6abf6[_0x4c5266][_0x35753f(0xba)]=_0x3b8e68;}),_0x2b8dcf[_0x4b7203(0xe7)]((_0x1640a8,_0x4820d5)=>{var _0x362270=_0x4b7203;_0xe6abf6[_0x4820d5][_0x362270(0x93)]=_0x1640a8;}),_0x5622cd['forEach']((_0x2cfd88,_0x2a9cfe)=>{var _0x334b3e=_0x4b7203;_0xe6abf6[_0x2a9cfe][_0x334b3e(0xbd)]=_0x2cfd88;}),_0x25ae8d[_0x4b7203(0xe7)]((_0xdfa6e4,_0x1085db)=>{var _0x256221=_0x4b7203;_0xe6abf6[_0x1085db][_0x256221(0x147)]=_0xdfa6e4;}),_0x1f6de6[_0x4b7203(0xe7)]((_0x248464,_0x25c8f5)=>{_0xe6abf6[_0x25c8f5]['expiry_date']=_0x248464;}),_0x45bfd0[_0x4b7203(0xe7)]((_0x58d730,_0x114ac3)=>{var _0x7b4fe4=_0x4b7203;_0xe6abf6[_0x114ac3][_0x7b4fe4(0x149)]=_0x58d730;}),_0x5f3d86[_0x4b7203(0xe7)]((_0x5f3e22,_0x1e86b3)=>{var _0x5e9683=_0x4b7203;_0xe6abf6[_0x1e86b3][_0x5e9683(0xba)]=_0x5f3e22;}),_0x1dfca7[_0x4b7203(0xe7)]((_0x8f5422,_0x512c08)=>{_0xe6abf6[_0x512c08]['maxPerUnit']=_0x8f5422;}),_0x33f02f[_0x4b7203(0xe7)]((_0x209e23,_0x58565f)=>{var _0x26c430=_0x4b7203;_0xe6abf6[_0x58565f][_0x26c430(0xb4)]=_0x209e23;}),_0x1a3400[_0x4b7203(0xe7)]((_0x1c3963,_0xa936ca)=>{var _0x5a1be4=_0x4b7203;_0xe6abf6[_0xa936ca][_0x5a1be4(0x96)]=_0x1c3963;}),_0x2c5f8f['forEach']((_0x209eb2,_0x2b0e4e)=>{_0xe6abf6[_0x2b0e4e]['to_room_name']=_0x209eb2;});const _0x5e04a9=_0xe6abf6[_0x4b7203(0xc4)](_0x516e3e=>_0x516e3e[_0x4b7203(0x11a)]!=='0'&&_0x516e3e[_0x4b7203(0x11a)]!==''||_0x516e3e[_0x4b7203(0xb7)]!=='0'&&_0x516e3e['to_floorlevel']!=='');var _0x1b299d=0x0;_0x5e04a9[_0x4b7203(0xe7)](_0x3e5750=>{var _0x21aa48=_0x4b7203;parseInt(_0x3e5750[_0x21aa48(0x88)])<parseInt(_0x3e5750[_0x21aa48(0x11a)])&&_0x1b299d++;});if(_0x1b299d!=0x0)return _0x55f054[_0x4b7203(0xf0)]('errors',_0x4b7203(0x113)),_0x1510f4['redirect'](_0x4b7203(0x10d));const _0x19dc8a=new transfers_logs();await _0x19dc8a[_0x4b7203(0x115)]();for(let _0x55f819=0x0;_0x55f819<=_0x2c5f8f[_0x4b7203(0xcb)]-0x1;_0x55f819++){_0xe6abf6[_0x55f819][_0x4b7203(0x106)]=_0x4b7203(0x13b)+_0x19dc8a[_0x4b7203(0x10f)][_0x4b7203(0xab)]()[_0x4b7203(0xe2)](0x8,'0');}const _0x5ba56f=new transfers_finished({'date':_0x4a2ea4,'from_warehouse':_0x42f3d1,'to_warehouse':_0x42f3d1,'product':_0x5e04a9,'note':_0x27c508,'invoice':'LOG-TRF-'+_0x19dc8a['invoice_init'][_0x4b7203(0xab)]()['padStart'](0x8,'0'),'type_of_process':_0x4b7203(0xb9),'type_of_transaction':_0x4b7203(0xf4),'PO_number':_0x3432e3,'RequestedBy':_0x64056b,'DateofRequest':_0x19da98,'typeservices':_0x5eddd3,'destination':_0x2454c7,'deliverydate':_0x943beb,'driver':_0xfb4de8,'plate':_0x140ac2,'van':_0x3d795d,'DRSI':_0x2caa20,'typevehicle':_0x145eda,'TSU':_0x1642f0,'TFU':_0x5ed550}),_0x10b83d=await _0x5ba56f['save']();_0x55f054['flash'](_0x4b7203(0xfe),_0x4b7203(0x91)),_0x1510f4[_0x4b7203(0xf9)](_0x4b7203(0x132)+_0x10b83d[_0x4b7203(0xe9)]);}catch(_0x7ccd01){console['log'](_0x7ccd01),_0x1510f4['status'](0xc8)[_0x4b7203(0xfa)]({'errorMessage':_0x7ccd01[_0x4b7203(0xd6)]});}}),router[a0_0x240a0e(0x8c)](a0_0x240a0e(0x12a),auth,async(_0x59e56f,_0x4988f8)=>{var _0x13d8c8=a0_0x240a0e;try{const {date:_0x32695d,from_warehouse:_0x48b342,FromRoom_name:_0x3a5fba,to_warehouse:_0x23016a,ToRoom_name:_0x53ce92,prod_name:_0x13bf95,from_prod_qty:_0x36e650,from_prod_level:_0x25a449,from_prod_isle:_0xab4441,from_prod_pallet:_0x2b4cc7,to_prod_qty:_0x587d62,to_prod_level:_0x379110,to_prod_isle:_0x2066cd,to_prod_pallet:_0x1a001b,primary_code:_0xb3753e,secondary_code:_0x1b3cc6,product_code3:_0x419730,note:_0xd32206,MaxStocks_data2:_0x10b509,invoice:_0x1cc64d,expiry_date:_0x197b83,PO_number_loc:_0x336a05,ReqBy_loc:_0x70555a,dateofreq_loc:_0x1cb3f6,typeservices_loc_Data:_0x55598b,destination_loc:_0xd5a75e,deliverydate_loc:_0x44deea,driver_loc:_0x41222a,plate_loc:_0x54ae0c,van_loc:_0x198487,DRSI_loc:_0x215942,typevehicle_loc:_0x532ca6,TSU_loc:_0x4a72bb,TFU_loc:_0x42b0e4}=_0x59e56f[_0x13d8c8(0xf7)];if(typeof _0x13bf95==_0x13d8c8(0x128))var _0x329c30=[_0x59e56f['body'][_0x13d8c8(0xd3)]],_0x3379b9=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x13e)]],_0x4f4fd1=[_0x59e56f[_0x13d8c8(0xf7)]['from_prod_level2']],_0x24409d=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x109)]],_0x14917a=[_0x59e56f[_0x13d8c8(0xf7)]['to_prod_level']],_0x11e10e=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x125)]],_0x155e39=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x94)]],_0x1c9d42=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xce)]],_0x534c84=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xeb)]],_0x36ef50=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x102)]],_0x36ab3b=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xbd)]],_0x1d0a5c=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x147)]],_0x18d575=[_0x59e56f[_0x13d8c8(0xf7)]['expiry_date']],_0x49879a=[_0x59e56f['body']['product_date']],_0x5ebba7=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x11c)]],_0x4b0007=[_0x59e56f[_0x13d8c8(0xf7)]['maxPerUnit']],_0x115b10=[_0x59e56f['body']['prod_cat']],_0x52ad1a=[_0x59e56f[_0x13d8c8(0xf7)]['RoomAssigned']],_0x5c0d2e=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xea)]],_0x4983f1=[_0x59e56f['body']['from_invoice']],_0x629e9d=[_0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x137)]];else var _0x329c30=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xd3)]],_0x3379b9=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x13e)]],_0x4f4fd1=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x13c)]],_0x24409d=[..._0x59e56f['body'][_0x13d8c8(0x109)]],_0x14917a=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xe0)]],_0x11e10e=[..._0x59e56f['body'][_0x13d8c8(0x125)]],_0x155e39=[..._0x59e56f['body']['secondary_code']],_0x1c9d42=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xce)]],_0x534c84=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xeb)]],_0x36ef50=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x102)]],_0x36ab3b=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xbd)]],_0x1d0a5c=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x147)]],_0x18d575=[..._0x59e56f['body']['expiry_date']],_0x49879a=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x98)]],_0x5ebba7=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x11c)]],_0x4b0007=[..._0x59e56f['body']['maxPerUnit']],_0x115b10=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0xb4)]],_0x52ad1a=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x9f)]],_0x5c0d2e=[..._0x59e56f[_0x13d8c8(0xf7)]['ToRoomAssigned']],_0x4983f1=[..._0x59e56f['body'][_0x13d8c8(0x9a)]],_0x629e9d=[..._0x59e56f[_0x13d8c8(0xf7)][_0x13d8c8(0x137)]];const _0x560e0f=_0x329c30[_0x13d8c8(0xbc)](_0xfe402b=>{return _0xfe402b={'product_name':_0xfe402b};});_0x3379b9['forEach']((_0xa9f82f,_0x5ebc5f)=>{var _0x8be6a6=_0x13d8c8;_0x560e0f[_0x5ebc5f][_0x8be6a6(0x88)]=_0xa9f82f;}),_0x4f4fd1[_0x13d8c8(0xe7)]((_0x14bebf,_0x1abf18)=>{var _0x13a607=_0x13d8c8,_0x50d267=_0x14bebf[_0x13a607(0x111)](/[A-Za-z]+/)[0x0],_0x2a5870=parseInt(_0x14bebf['match'](/\d+/)[0x0]);_0x560e0f[_0x1abf18]['from_bay']=_0x2a5870,_0x560e0f[_0x1abf18][_0x13a607(0xe5)]=_0x50d267;}),_0x629e9d[_0x13d8c8(0xe7)]((_0x233802,_0x191434)=>{_0x560e0f[_0x191434]['id_transaction']=_0x233802;}),_0x4983f1[_0x13d8c8(0xe7)]((_0x4ea1f1,_0x10904d)=>{_0x560e0f[_0x10904d]['from_invoice']=_0x4ea1f1;}),_0x24409d[_0x13d8c8(0xe7)]((_0x1de466,_0x54bc2d)=>{var _0x10d666=_0x13d8c8;_0x560e0f[_0x54bc2d][_0x10d666(0x11a)]=_0x1de466;}),_0x14917a[_0x13d8c8(0xe7)]((_0xbceab5,_0x3ca599)=>{var _0x546dd4=_0x13d8c8,_0x43004d=_0xbceab5[_0x546dd4(0x111)](/[A-Za-z]+/)[0x0],_0x187dbe=parseInt(_0xbceab5['match'](/\d+/)[0x0]);_0x560e0f[_0x3ca599][_0x546dd4(0x10a)]=_0x43004d,_0x560e0f[_0x3ca599][_0x546dd4(0xac)]=_0x187dbe;}),_0x11e10e[_0x13d8c8(0xe7)]((_0x21268c,_0x483df7)=>{var _0x1956dc=_0x13d8c8;_0x560e0f[_0x483df7][_0x1956dc(0x125)]=_0x21268c;}),_0x155e39[_0x13d8c8(0xe7)]((_0x5d5e46,_0x2f2dbc)=>{var _0x20f89b=_0x13d8c8;_0x560e0f[_0x2f2dbc][_0x20f89b(0x94)]=_0x5d5e46;}),_0x1c9d42[_0x13d8c8(0xe7)]((_0x1dc7d8,_0x21e070)=>{var _0x426237=_0x13d8c8;_0x560e0f[_0x21e070][_0x426237(0xc9)]=_0x1dc7d8;}),_0x534c84[_0x13d8c8(0xe7)]((_0xd1c6c3,_0x5a97c4)=>{var _0x2e0d1c=_0x13d8c8;_0x560e0f[_0x5a97c4][_0x2e0d1c(0xba)]=_0xd1c6c3;}),_0x36ef50[_0x13d8c8(0xe7)]((_0x48ecc2,_0x264bb1)=>{var _0x1fa35e=_0x13d8c8;_0x560e0f[_0x264bb1][_0x1fa35e(0x93)]=_0x48ecc2;}),_0x36ab3b[_0x13d8c8(0xe7)]((_0x2443b8,_0x3889ae)=>{var _0x3684a5=_0x13d8c8;_0x560e0f[_0x3889ae][_0x3684a5(0xbd)]=_0x2443b8;}),_0x1d0a5c[_0x13d8c8(0xe7)]((_0x240857,_0x57d997)=>{var _0x59f76a=_0x13d8c8;_0x560e0f[_0x57d997][_0x59f76a(0x147)]=_0x240857;}),_0x18d575['forEach']((_0x235c88,_0x4e9e7b)=>{var _0x4a746b=_0x13d8c8;_0x560e0f[_0x4e9e7b][_0x4a746b(0x108)]=_0x235c88;}),_0x49879a['forEach']((_0x5bf111,_0x2ddfe6)=>{var _0x4fdf18=_0x13d8c8;_0x560e0f[_0x2ddfe6][_0x4fdf18(0x149)]=_0x5bf111;}),_0x5ebba7[_0x13d8c8(0xe7)]((_0x7bd85a,_0x272462)=>{var _0x63f1ee=_0x13d8c8;_0x560e0f[_0x272462][_0x63f1ee(0xba)]=_0x7bd85a;}),_0x4b0007[_0x13d8c8(0xe7)]((_0xb0359e,_0xbe77b3)=>{_0x560e0f[_0xbe77b3]['maxPerUnit']=_0xb0359e;}),_0x115b10[_0x13d8c8(0xe7)]((_0x53aa1e,_0x54ea26)=>{var _0x122860=_0x13d8c8;_0x560e0f[_0x54ea26][_0x122860(0xb4)]=_0x53aa1e;}),_0x52ad1a[_0x13d8c8(0xe7)]((_0x5b0259,_0xd454a)=>{var _0x5169f4=_0x13d8c8;_0x560e0f[_0xd454a][_0x5169f4(0x96)]=_0x5b0259;}),_0x5c0d2e[_0x13d8c8(0xe7)]((_0x1b8968,_0x2238c7)=>{_0x560e0f[_0x2238c7]['to_room_name']=_0x1b8968;});const _0x39b306=_0x560e0f[_0x13d8c8(0xc4)](_0x4cbe99=>_0x4cbe99[_0x13d8c8(0x11a)]!=='0'&&_0x4cbe99[_0x13d8c8(0x11a)]!==''||_0x4cbe99['to_floorlevel']!=='0'&&_0x4cbe99['to_floorlevel']!=='');var _0x45fae8=0x0;_0x39b306[_0x13d8c8(0xe7)](_0x568072=>{var _0x1b9fbf=_0x13d8c8;parseInt(_0x568072[_0x1b9fbf(0x88)])<parseInt(_0x568072[_0x1b9fbf(0x11a)])&&_0x45fae8++;});if(_0x45fae8!=0x0)return _0x59e56f[_0x13d8c8(0xf0)](_0x13d8c8(0x89),_0x13d8c8(0x113)),_0x4988f8[_0x13d8c8(0xf9)](_0x13d8c8(0x10d));const _0x1569f0=new transfers_logs();await _0x1569f0['save']();for(let _0x5e44cf=0x0;_0x5e44cf<=_0x5c0d2e[_0x13d8c8(0xcb)]-0x1;_0x5e44cf++){_0x560e0f[_0x5e44cf]['To_invoice']='LOG-TRF-'+_0x1569f0[_0x13d8c8(0x10f)][_0x13d8c8(0xab)]()[_0x13d8c8(0xe2)](0x8,'0');}const _0x2de6a9=new transfers_finished({'date':_0x32695d,'from_warehouse':_0x48b342,'to_warehouse':_0x23016a,'product':_0x39b306,'note':_0xd32206,'invoice':_0x13d8c8(0x13b)+_0x1569f0[_0x13d8c8(0x10f)]['toString']()['padStart'](0x8,'0'),'type_of_transaction':'logs','type_of_process':_0x13d8c8(0x86),'PO_number':_0x336a05,'RequestedBy':_0x70555a,'DateofRequest':_0x1cb3f6,'typeservices':_0x55598b,'destination':_0xd5a75e,'deliverydate':_0x44deea,'driver':_0x41222a,'plate':_0x54ae0c,'van':_0x198487,'DRSI':_0x215942,'typevehicle':_0x532ca6,'TSU':_0x4a72bb,'TFU':_0x42b0e4}),_0x302b24=await _0x2de6a9[_0x13d8c8(0x115)]();_0x59e56f[_0x13d8c8(0xf0)](_0x13d8c8(0xfe),_0x13d8c8(0x91)),_0x4988f8[_0x13d8c8(0xf9)](_0x13d8c8(0x132)+_0x302b24['_id']);}catch(_0x2bf883){console['log'](_0x2bf883),_0x4988f8[_0x13d8c8(0x105)](0xc8)[_0x13d8c8(0xfa)]({'errorMessage':_0x2bf883['message']});}}),router['post'](a0_0x240a0e(0xcf),auth,async(_0x1b6dfa,_0x3cf853)=>{var _0x521a71=a0_0x240a0e;try{const {date:_0x22280a,from_warehouse:_0x4730d7,FromRoom_name:_0x179c74,to_warehouse:_0x33089b,ToRoom_name:_0x21c4ef,prod_name:_0xcd7ae6,from_prod_qty:_0x45e9a8,from_prod_level:_0x37538c,from_prod_isle:_0x2e673f,from_prod_pallet:_0xae6c0e,to_prod_qty:_0x560cfe,to_prod_level:_0x5662f1,to_prod_isle:_0x5108a7,to_prod_pallet:_0x1123b8,primary_code:_0x51a59f,secondary_code:_0x39d5ca,product_code3:_0x5c18c7,note:_0x27a391,MaxStocks_data2:_0x5c899e,invoice:_0x166aa0,expiry_date:_0x420582,PO_number:_0x1ec352,ReqBy:_0x185a19,dateofreq:_0xe62227,typeservicesData:_0x11b75a,destination:_0x194f53,deliverydate:_0x4e02fa,driver:_0x5eb582,plate:_0x49b07e,van:_0x4a029b,DRSI:_0x240c80,typevehicle:_0x420fd7,TSU:_0x56c366,TFU:_0x23bc73}=_0x1b6dfa[_0x521a71(0xf7)];if(typeof _0xcd7ae6==_0x521a71(0x128))var _0x21641c=[_0x1b6dfa['body'][_0x521a71(0xd3)]],_0x481c39=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x13e)]],_0x21cbc7=[_0x1b6dfa[_0x521a71(0xf7)]['from_prod_level2']],_0x4e60ca=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x109)]],_0x1b28fa=[_0x1b6dfa['body'][_0x521a71(0xe0)]],_0x17f31b=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x125)]],_0x56b9fd=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x94)]],_0x4d521f=[_0x1b6dfa['body']['product_code3']],_0x5baeaa=[_0x1b6dfa[_0x521a71(0xf7)]['MaxStocks_data2']],_0x1306e5=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x102)]],_0x1bf65a=[_0x1b6dfa['body']['secondary_unit']],_0x2b70dc=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x147)]],_0x4905fe=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x108)]],_0x46e79b=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x98)]],_0x2dee58=[_0x1b6dfa[_0x521a71(0xf7)]['MaxStocks_data']],_0xcb8e0e=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x10c)]],_0xf02523=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0xb4)]],_0x4c8357=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x9f)]],_0x18bdc5=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0xea)]],_0x174997=[_0x1b6dfa['body'][_0x521a71(0x9a)]],_0x5c7182=[_0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x137)]];else var _0x21641c=[..._0x1b6dfa[_0x521a71(0xf7)]['prod_name']],_0x481c39=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x13e)]],_0x21cbc7=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x13c)]],_0x4e60ca=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x109)]],_0x1b28fa=[..._0x1b6dfa['body']['to_prod_level']],_0x17f31b=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x125)]],_0x56b9fd=[..._0x1b6dfa['body'][_0x521a71(0x94)]],_0x4d521f=[..._0x1b6dfa['body'][_0x521a71(0xce)]],_0x5baeaa=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0xeb)]],_0x1306e5=[..._0x1b6dfa['body'][_0x521a71(0x102)]],_0x1bf65a=[..._0x1b6dfa['body'][_0x521a71(0xbd)]],_0x2b70dc=[..._0x1b6dfa[_0x521a71(0xf7)]['batch_code']],_0x4905fe=[..._0x1b6dfa[_0x521a71(0xf7)]['expiry_date']],_0x46e79b=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x98)]],_0x2dee58=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x11c)]],_0xcb8e0e=[..._0x1b6dfa[_0x521a71(0xf7)]['maxPerUnit']],_0xf02523=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0xb4)]],_0x4c8357=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0x9f)]],_0x18bdc5=[..._0x1b6dfa[_0x521a71(0xf7)][_0x521a71(0xea)]],_0x174997=[..._0x1b6dfa[_0x521a71(0xf7)]['from_invoice']],_0x5c7182=[..._0x1b6dfa[_0x521a71(0xf7)]['id_transaction']];const _0x4b38fd=_0x21641c[_0x521a71(0xbc)](_0x2898b2=>{return _0x2898b2={'product_name':_0x2898b2};});_0x481c39[_0x521a71(0xe7)]((_0x483f8e,_0x2d7dd2)=>{var _0x3072d0=_0x521a71;_0x4b38fd[_0x2d7dd2][_0x3072d0(0x88)]=_0x483f8e;}),_0x21cbc7[_0x521a71(0xe7)]((_0x515299,_0xfbc7ce)=>{var _0x518d2c=_0x521a71,_0x45e824=_0x515299[_0x518d2c(0x111)](/[A-Za-z]+/)[0x0],_0x9c157b=parseInt(_0x515299[_0x518d2c(0x111)](/\d+/)[0x0]);_0x4b38fd[_0xfbc7ce][_0x518d2c(0xc8)]=_0x9c157b,_0x4b38fd[_0xfbc7ce][_0x518d2c(0xe5)]=_0x45e824;}),_0x5c7182['forEach']((_0x4c8883,_0x18879e)=>{var _0x1a9272=_0x521a71;_0x4b38fd[_0x18879e][_0x1a9272(0x137)]=_0x4c8883;}),_0x174997['forEach']((_0x30dd41,_0xfa22f)=>{_0x4b38fd[_0xfa22f]['from_invoice']=_0x30dd41;}),_0x4e60ca[_0x521a71(0xe7)]((_0x5a1cb8,_0x5df53f)=>{var _0xee1c29=_0x521a71;_0x4b38fd[_0x5df53f][_0xee1c29(0x11a)]=_0x5a1cb8;}),_0x1b28fa['forEach']((_0x2c7de6,_0x1f4721)=>{var _0x2849c4=_0x521a71,_0x18b256=_0x2c7de6[_0x2849c4(0x111)](/[A-Za-z]+/)[0x0],_0x1a5e86=parseInt(_0x2c7de6['match'](/\d+/)[0x0]);_0x4b38fd[_0x1f4721][_0x2849c4(0x10a)]=_0x18b256,_0x4b38fd[_0x1f4721][_0x2849c4(0xac)]=_0x1a5e86;}),_0x17f31b['forEach']((_0x17b2f7,_0x1cae41)=>{var _0x50f491=_0x521a71;_0x4b38fd[_0x1cae41][_0x50f491(0x125)]=_0x17b2f7;}),_0x56b9fd[_0x521a71(0xe7)]((_0x5799ab,_0x5d87bc)=>{var _0x3e5cda=_0x521a71;_0x4b38fd[_0x5d87bc][_0x3e5cda(0x94)]=_0x5799ab;}),_0x4d521f['forEach']((_0x10cc27,_0x23b9ee)=>{var _0x420e04=_0x521a71;_0x4b38fd[_0x23b9ee][_0x420e04(0xc9)]=_0x10cc27;}),_0x5baeaa[_0x521a71(0xe7)]((_0x2a3d10,_0x140682)=>{var _0xfbd8f3=_0x521a71;_0x4b38fd[_0x140682][_0xfbd8f3(0xba)]=_0x2a3d10;}),_0x1306e5[_0x521a71(0xe7)]((_0xfec6c7,_0x15d82e)=>{var _0x477f23=_0x521a71;_0x4b38fd[_0x15d82e][_0x477f23(0x93)]=_0xfec6c7;}),_0x1bf65a[_0x521a71(0xe7)]((_0xd66404,_0x48d8c1)=>{var _0x5d4e82=_0x521a71;_0x4b38fd[_0x48d8c1][_0x5d4e82(0xbd)]=_0xd66404;}),_0x2b70dc['forEach']((_0x58659f,_0x3fafa7)=>{var _0x5d48bb=_0x521a71;_0x4b38fd[_0x3fafa7][_0x5d48bb(0x147)]=_0x58659f;}),_0x4905fe[_0x521a71(0xe7)]((_0x27b46d,_0x159374)=>{var _0x3b9c74=_0x521a71;_0x4b38fd[_0x159374][_0x3b9c74(0x108)]=_0x27b46d;}),_0x46e79b[_0x521a71(0xe7)]((_0x20cc40,_0x1e2e57)=>{_0x4b38fd[_0x1e2e57]['production_date']=_0x20cc40;}),_0x2dee58[_0x521a71(0xe7)]((_0x403b2f,_0xddd868)=>{var _0x3f9952=_0x521a71;_0x4b38fd[_0xddd868][_0x3f9952(0xba)]=_0x403b2f;}),_0xcb8e0e[_0x521a71(0xe7)]((_0x3f48d3,_0x453d89)=>{var _0x35790c=_0x521a71;_0x4b38fd[_0x453d89][_0x35790c(0x10c)]=_0x3f48d3;}),_0xf02523[_0x521a71(0xe7)]((_0x16dc43,_0xaa2f4d)=>{_0x4b38fd[_0xaa2f4d]['prod_cat']=_0x16dc43;}),_0x4c8357['forEach']((_0x4f4a9e,_0x58e103)=>{_0x4b38fd[_0x58e103]['from_room_name']=_0x4f4a9e;}),_0x18bdc5[_0x521a71(0xe7)]((_0x1c7c40,_0x4c28ca)=>{_0x4b38fd[_0x4c28ca]['to_room_name']=_0x1c7c40;});const _0x1e3423=_0x4b38fd[_0x521a71(0xc4)](_0x21db0f=>_0x21db0f['to_quantity']!=='0'&&_0x21db0f[_0x521a71(0x11a)]!==''||_0x21db0f[_0x521a71(0xb7)]!=='0'&&_0x21db0f['to_floorlevel']!=='');var _0x493b3f=0x0;_0x1e3423[_0x521a71(0xe7)](_0x13bd9e=>{var _0x38979d=_0x521a71;parseInt(_0x13bd9e[_0x38979d(0x88)])<parseInt(_0x13bd9e[_0x38979d(0x11a)])&&_0x493b3f++;});if(_0x493b3f!=0x0)return _0x1b6dfa[_0x521a71(0xf0)](_0x521a71(0x89),_0x521a71(0x113)),_0x3cf853[_0x521a71(0xf9)](_0x521a71(0x10d));const _0x706bbe=new invoice_for_transfer();await _0x706bbe[_0x521a71(0x115)]();for(let _0x2b5fc8=0x0;_0x2b5fc8<=_0x18bdc5['length']-0x1;_0x2b5fc8++){_0x4b38fd[_0x2b5fc8][_0x521a71(0x106)]=_0x521a71(0xad)+_0x706bbe[_0x521a71(0x10f)]['toString']()[_0x521a71(0xe2)](0x8,'0');}const _0x2d1f48=new transfers_finished({'date':_0x22280a,'from_warehouse':_0x4730d7,'to_warehouse':_0x4730d7,'product':_0x1e3423,'note':_0x27a391,'invoice':_0x521a71(0xad)+_0x706bbe[_0x521a71(0x10f)][_0x521a71(0xab)]()[_0x521a71(0xe2)](0x8,'0'),'type_of_process':_0x521a71(0xb9),'type_of_transaction':'own','PO_number':_0x1ec352,'RequestedBy':_0x185a19,'DateofRequest':_0xe62227,'typeservices':_0x11b75a,'destination':_0x194f53,'deliverydate':_0x4e02fa,'driver':_0x5eb582,'plate':_0x49b07e,'van':_0x4a029b,'DRSI':_0x240c80,'typevehicle':_0x420fd7,'TSU':_0x56c366,'TFU':_0x23bc73}),_0x5796d6=await _0x2d1f48[_0x521a71(0x115)]();_0x1b6dfa[_0x521a71(0xf0)](_0x521a71(0xfe),_0x521a71(0x91)),_0x3cf853[_0x521a71(0xf9)](_0x521a71(0x132)+_0x5796d6[_0x521a71(0xe9)]);}catch(_0x4ad198){console[_0x521a71(0x8b)](_0x4ad198),_0x3cf853[_0x521a71(0x105)](0xc8)[_0x521a71(0xfa)]({'errorMessage':_0x4ad198['message']});}}),router[a0_0x240a0e(0x8c)](a0_0x240a0e(0xb2),auth,async(_0x545a83,_0x5d325e)=>{var _0x3ff67e=a0_0x240a0e;try{const {date:_0xd53fad,from_warehouse:_0x17ee70,FromRoom_name:_0x11add9,to_warehouse:_0x4feeab,ToRoom_name:_0x425a31,prod_name:_0x495a6c,from_prod_qty:_0x98f2c8,from_prod_level:_0x4a9cb1,from_prod_isle:_0x5ac559,from_prod_pallet:_0x48009f,to_prod_qty:_0x4e9648,to_prod_level:_0x36a3e0,to_prod_isle:_0x3008a1,to_prod_pallet:_0x2fa2b6,primary_code:_0x77d76,secondary_code:_0xcc4d60,product_code3:_0x493df7,note:_0x534e47,MaxStocks_data2:_0x33eef5,invoice:_0x4bbec4,expiry_date:_0x4c4b5c,PO_number_loc:_0x5e1487,ReqBy_loc:_0x2d4e51,dateofreq_loc:_0x380158,typeservices_loc_Data:_0x21f798,destination_loc:_0x33ba34,deliverydate_loc:_0x216122,driver_loc:_0x3f66c2,plate_loc:_0x250f06,van_loc:_0x9f3647,DRSI_loc:_0x15468a,typevehicle_loc:_0x353271,TSU_loc:_0x2e1674,TFU_loc:_0x56799f}=_0x545a83[_0x3ff67e(0xf7)];if(typeof _0x495a6c==_0x3ff67e(0x128))var _0x4b3387=[_0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0xd3)]],_0xe1bdc=[_0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x13e)]],_0x135fd2=[_0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x13c)]],_0x797d4e=[_0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x109)]],_0x4440c0=[_0x545a83['body'][_0x3ff67e(0xe0)]],_0x404bd4=[_0x545a83[_0x3ff67e(0xf7)]['primary_code']],_0x433427=[_0x545a83[_0x3ff67e(0xf7)]['secondary_code']],_0x9b3748=[_0x545a83['body']['product_code3']],_0x3a90aa=[_0x545a83[_0x3ff67e(0xf7)]['MaxStocks_data2']],_0x5a681e=[_0x545a83[_0x3ff67e(0xf7)]['primary_unit']],_0x148fc3=[_0x545a83[_0x3ff67e(0xf7)]['secondary_unit']],_0x359345=[_0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x147)]],_0x5b0a27=[_0x545a83['body'][_0x3ff67e(0x108)]],_0x4ddd94=[_0x545a83[_0x3ff67e(0xf7)]['product_date']],_0x272cae=[_0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x11c)]],_0x2f0eb5=[_0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x10c)]],_0x1b02f3=[_0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0xb4)]],_0x440ff9=[_0x545a83[_0x3ff67e(0xf7)]['RoomAssigned']],_0x1bccb4=[_0x545a83[_0x3ff67e(0xf7)]['ToRoomAssigned']],_0x1a8265=[_0x545a83[_0x3ff67e(0xf7)]['from_invoice']],_0x16b692=[_0x545a83['body'][_0x3ff67e(0x137)]];else var _0x4b3387=[..._0x545a83['body'][_0x3ff67e(0xd3)]],_0xe1bdc=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x13e)]],_0x135fd2=[..._0x545a83['body']['from_prod_level2']],_0x797d4e=[..._0x545a83['body'][_0x3ff67e(0x109)]],_0x4440c0=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0xe0)]],_0x404bd4=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x125)]],_0x433427=[..._0x545a83['body'][_0x3ff67e(0x94)]],_0x9b3748=[..._0x545a83[_0x3ff67e(0xf7)]['product_code3']],_0x3a90aa=[..._0x545a83['body'][_0x3ff67e(0xeb)]],_0x5a681e=[..._0x545a83[_0x3ff67e(0xf7)]['primary_unit']],_0x148fc3=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0xbd)]],_0x359345=[..._0x545a83[_0x3ff67e(0xf7)]['batch_code']],_0x5b0a27=[..._0x545a83['body'][_0x3ff67e(0x108)]],_0x4ddd94=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x98)]],_0x272cae=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x11c)]],_0x2f0eb5=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x10c)]],_0x1b02f3=[..._0x545a83['body'][_0x3ff67e(0xb4)]],_0x440ff9=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0x9f)]],_0x1bccb4=[..._0x545a83[_0x3ff67e(0xf7)][_0x3ff67e(0xea)]],_0x1a8265=[..._0x545a83['body'][_0x3ff67e(0x9a)]],_0x16b692=[..._0x545a83['body'][_0x3ff67e(0x137)]];const _0x4806df=_0x4b3387[_0x3ff67e(0xbc)](_0x250b9f=>{return _0x250b9f={'product_name':_0x250b9f};});_0xe1bdc[_0x3ff67e(0xe7)]((_0x5dbc7f,_0x54941d)=>{_0x4806df[_0x54941d]['from_quantity']=_0x5dbc7f;}),_0x135fd2[_0x3ff67e(0xe7)]((_0x14dd62,_0x391b45)=>{var _0x496e2b=_0x3ff67e,_0x331309=_0x14dd62[_0x496e2b(0x111)](/[A-Za-z]+/)[0x0],_0x3fdbcb=parseInt(_0x14dd62[_0x496e2b(0x111)](/\d+/)[0x0]);_0x4806df[_0x391b45][_0x496e2b(0xc8)]=_0x3fdbcb,_0x4806df[_0x391b45]['from_level']=_0x331309;}),_0x16b692[_0x3ff67e(0xe7)]((_0x49cd26,_0x30d928)=>{var _0xba74ed=_0x3ff67e;_0x4806df[_0x30d928][_0xba74ed(0x137)]=_0x49cd26;}),_0x1a8265[_0x3ff67e(0xe7)]((_0x19bc3a,_0x5f1346)=>{var _0x36394c=_0x3ff67e;_0x4806df[_0x5f1346][_0x36394c(0x9a)]=_0x19bc3a;}),_0x797d4e['forEach']((_0x1be56c,_0x37860d)=>{var _0x268c15=_0x3ff67e;_0x4806df[_0x37860d][_0x268c15(0x11a)]=_0x1be56c;}),_0x4440c0[_0x3ff67e(0xe7)]((_0x30e8e1,_0x205e2f)=>{var _0x1a8e5c=_0x3ff67e,_0x1f2a1e=_0x30e8e1['match'](/[A-Za-z]+/)[0x0],_0x487dbc=parseInt(_0x30e8e1[_0x1a8e5c(0x111)](/\d+/)[0x0]);_0x4806df[_0x205e2f]['to_level']=_0x1f2a1e,_0x4806df[_0x205e2f]['to_bay']=_0x487dbc;}),_0x404bd4[_0x3ff67e(0xe7)]((_0x1e4276,_0x5321ed)=>{_0x4806df[_0x5321ed]['primary_code']=_0x1e4276;}),_0x433427[_0x3ff67e(0xe7)]((_0x48805e,_0x5739d1)=>{var _0x4f06de=_0x3ff67e;_0x4806df[_0x5739d1][_0x4f06de(0x94)]=_0x48805e;}),_0x9b3748[_0x3ff67e(0xe7)]((_0x43bdc9,_0x22ee6b)=>{_0x4806df[_0x22ee6b]['product_code']=_0x43bdc9;}),_0x3a90aa[_0x3ff67e(0xe7)]((_0x23fdb0,_0x411624)=>{_0x4806df[_0x411624]['maxProducts']=_0x23fdb0;}),_0x5a681e[_0x3ff67e(0xe7)]((_0x5f17fa,_0x494c3e)=>{var _0x47a2ad=_0x3ff67e;_0x4806df[_0x494c3e][_0x47a2ad(0x93)]=_0x5f17fa;}),_0x148fc3['forEach']((_0x3e2cad,_0x14bb29)=>{_0x4806df[_0x14bb29]['secondary_unit']=_0x3e2cad;}),_0x359345[_0x3ff67e(0xe7)]((_0x1601e1,_0x357fd3)=>{var _0x10f801=_0x3ff67e;_0x4806df[_0x357fd3][_0x10f801(0x147)]=_0x1601e1;}),_0x5b0a27[_0x3ff67e(0xe7)]((_0x1e73c8,_0x475df8)=>{var _0x754288=_0x3ff67e;_0x4806df[_0x475df8][_0x754288(0x108)]=_0x1e73c8;}),_0x4ddd94[_0x3ff67e(0xe7)]((_0x22214b,_0xbd9a1)=>{var _0x2f6113=_0x3ff67e;_0x4806df[_0xbd9a1][_0x2f6113(0x149)]=_0x22214b;}),_0x272cae[_0x3ff67e(0xe7)]((_0x4192c8,_0x27bd01)=>{_0x4806df[_0x27bd01]['maxProducts']=_0x4192c8;}),_0x2f0eb5[_0x3ff67e(0xe7)]((_0x242e91,_0xb12118)=>{var _0x4039e0=_0x3ff67e;_0x4806df[_0xb12118][_0x4039e0(0x10c)]=_0x242e91;}),_0x1b02f3[_0x3ff67e(0xe7)]((_0x22eaa7,_0x412b78)=>{_0x4806df[_0x412b78]['prod_cat']=_0x22eaa7;}),_0x440ff9[_0x3ff67e(0xe7)]((_0x13af02,_0x2348b5)=>{var _0xcff0e6=_0x3ff67e;_0x4806df[_0x2348b5][_0xcff0e6(0x96)]=_0x13af02;}),_0x1bccb4['forEach']((_0x24b339,_0x34bf56)=>{_0x4806df[_0x34bf56]['to_room_name']=_0x24b339;});const _0x52963f=_0x4806df['filter'](_0x5850b7=>_0x5850b7[_0x3ff67e(0x11a)]!=='0'&&_0x5850b7['to_quantity']!==''||_0x5850b7[_0x3ff67e(0xb7)]!=='0'&&_0x5850b7[_0x3ff67e(0xb7)]!=='');var _0x28dfcc=0x0;_0x52963f['forEach'](_0x234a4d=>{var _0xbfa94a=_0x3ff67e;parseInt(_0x234a4d[_0xbfa94a(0x88)])<parseInt(_0x234a4d[_0xbfa94a(0x11a)])&&_0x28dfcc++;});if(_0x28dfcc!=0x0)return _0x545a83['flash'](_0x3ff67e(0x89),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x5d325e['redirect']('back');const _0x1b7f4e=new invoice_for_transfer();await _0x1b7f4e['save']();for(let _0x2d9a44=0x0;_0x2d9a44<=_0x1bccb4[_0x3ff67e(0xcb)]-0x1;_0x2d9a44++){_0x4806df[_0x2d9a44][_0x3ff67e(0x106)]='TRF-'+_0x1b7f4e[_0x3ff67e(0x10f)][_0x3ff67e(0xab)]()[_0x3ff67e(0xe2)](0x8,'0');}const _0x28f939=new transfers_finished({'date':_0xd53fad,'from_warehouse':_0x17ee70,'to_warehouse':_0x4feeab,'product':_0x52963f,'note':_0x534e47,'invoice':_0x3ff67e(0xad)+_0x1b7f4e[_0x3ff67e(0x10f)][_0x3ff67e(0xab)]()[_0x3ff67e(0xe2)](0x8,'0'),'type_of_transaction':_0x3ff67e(0xaa),'type_of_process':_0x3ff67e(0x86),'PO_number':_0x5e1487,'RequestedBy':_0x2d4e51,'DateofRequest':_0x380158,'typeservices':_0x21f798,'destination':_0x33ba34,'deliverydate':_0x216122,'driver':_0x3f66c2,'plate':_0x250f06,'van':_0x9f3647,'DRSI':_0x15468a,'typevehicle':_0x353271,'TSU':_0x2e1674,'TFU':_0x56799f}),_0x3fe9eb=await _0x28f939[_0x3ff67e(0x115)]();_0x545a83[_0x3ff67e(0xf0)](_0x3ff67e(0xfe),_0x3ff67e(0x91)),_0x5d325e['redirect']('/transfer_finished/preview/'+_0x3fe9eb[_0x3ff67e(0xe9)]);}catch(_0x17be20){console['log'](_0x17be20),_0x5d325e[_0x3ff67e(0x105)](0xc8)[_0x3ff67e(0xfa)]({'errorMessage':_0x17be20[_0x3ff67e(0xd6)]});}}),router[a0_0x240a0e(0xde)](a0_0x240a0e(0x118),auth,async(_0x1cf2cb,_0x5c02c7)=>{var _0x39b956=a0_0x240a0e;try{const {username:_0x36e787,email:_0x2e4895,role:_0x4c045b}=_0x1cf2cb[_0x39b956(0x101)],_0x4975ab=_0x1cf2cb['user'],_0x2cbfaf=await profile['findOne']({'email':_0x4975ab[_0x39b956(0xf2)]}),_0x4661dd=await master_shop[_0x39b956(0xcc)](),_0xa98bb7=await transfers_finished[_0x39b956(0x99)](_0x1cf2cb[_0x39b956(0x127)]['id']);let _0x1fc4ac;if(_0x4975ab[_0x39b956(0xd0)]=='staff'){const _0x2874cf=await staff[_0x39b956(0xca)]({'email':_0x4975ab[_0x39b956(0xf2)]});_0x1fc4ac=await warehouse[_0x39b956(0xcc)]({'status':_0x39b956(0x120),'name':_0x2874cf['warehouse'],'warehouse_category':_0x39b956(0xa4)});}else _0x1fc4ac=await warehouse['find']({'status':_0x39b956(0x120),'warehouse_category':'Finished\x20Goods'});const _0x684373=await warehouse[_0x39b956(0x116)]([{'$match':{'name':_0xa98bb7[_0x39b956(0x126)],'warehouse_category':_0x39b956(0xa4)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x39b956(0xbe),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x39b956(0xa6)},'bay':{'$first':_0x39b956(0x14b)},'bin':{'$first':_0x39b956(0x8e)},'type':{'$first':_0x39b956(0x13f)},'floorlevel':{'$first':_0x39b956(0x133)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x39b956(0xe3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x39b956(0xa1)},'expiry_date':{'$first':_0x39b956(0xf1)},'production_date':{'$first':_0x39b956(0x103)},'room':{'$first':_0x39b956(0x90)},'warehoue_name':{'$first':_0x39b956(0xdb)}}}]),_0x1376b0=await product['find']({});if(_0x4661dd[0x0]['language']=='English\x20(US)'){var _0x22b5f1=users[_0x39b956(0xa0)];console['log'](_0x22b5f1);}else{if(_0x4661dd[0x0][_0x39b956(0xb8)]==_0x39b956(0x136))var _0x22b5f1=users[_0x39b956(0x136)];else{if(_0x4661dd[0x0][_0x39b956(0xb8)]==_0x39b956(0xfd))var _0x22b5f1=users[_0x39b956(0xfd)];else{if(_0x4661dd[0x0][_0x39b956(0xb8)]==_0x39b956(0xa2))var _0x22b5f1=users[_0x39b956(0xa2)];else{if(_0x4661dd[0x0][_0x39b956(0xb8)]==_0x39b956(0x82))var _0x22b5f1=users[_0x39b956(0x82)];else{if(_0x4661dd[0x0][_0x39b956(0xb8)]==_0x39b956(0xef))var _0x22b5f1=users[_0x39b956(0xb3)];else{if(_0x4661dd[0x0]['language']=='Chinese')var _0x22b5f1=users[_0x39b956(0xd8)];else{if(_0x4661dd[0x0]['language']==_0x39b956(0xe8))var _0x22b5f1=users[_0x39b956(0x11e)];}}}}}}}_0x5c02c7['render'](_0x39b956(0x129),{'success':_0x1cf2cb[_0x39b956(0xf0)](_0x39b956(0xfe)),'errors':_0x1cf2cb['flash'](_0x39b956(0x89)),'role':_0x4975ab,'profile':_0x2cbfaf,'master_shop':_0x4661dd,'warehouse':_0x1fc4ac,'transfer':_0xa98bb7,'stock':_0x684373,'unit':_0x1376b0,'language':_0x22b5f1});}catch(_0xc1794f){console[_0x39b956(0x8b)](_0xc1794f);}}),router[a0_0x240a0e(0x8c)](a0_0x240a0e(0x118),auth,async(_0x413725,_0x39b094)=>{var _0x1ea55d=a0_0x240a0e;try{const {invoice:_0x1c5527,from_warehouse:_0xed2743,FromRoom_name:_0x3ef774,to_warehouse:_0x14c7a1,ToRoom_name:_0x5dd755}=_0x413725[_0x1ea55d(0xf7)],_0x2b5474=await transfers_finished[_0x1ea55d(0x99)](_0x413725[_0x1ea55d(0x127)]['id']),_0x31fc23=_0x2b5474[_0x1ea55d(0xc3)][_0x1ea55d(0xbc)](async _0x34a720=>{var _0x5776a0=_0x1ea55d;if(_0x34a720[_0x5776a0(0x11a)]>0x0){var _0xa5f618=await warehouse['findOne']({'name':_0xed2743,'room':_0x34a720[_0x5776a0(0x96)]});const _0x2bd742=_0xa5f618[_0x5776a0(0x12c)]['map'](_0x81ebf3=>{var _0x472d77=_0x5776a0;_0x81ebf3[_0x472d77(0xe9)]==_0x34a720[_0x472d77(0x137)]&&(_0x81ebf3['product_stock']=Math[_0x472d77(0x84)](0x0,Math['abs'](_0x81ebf3['product_stock'])-Math['abs'](_0x34a720[_0x472d77(0x11a)])),console[_0x472d77(0x8b)](_0x81ebf3[_0x472d77(0xfb)]));});}return _0xa5f618;});Promise[_0x1ea55d(0xdf)](_0x31fc23)[_0x1ea55d(0x10e)](async _0x2619b1=>{var _0x2fa98b=_0x1ea55d;try{for(const _0x1b0af0 of _0x2619b1){await _0x1b0af0['save']();}const _0x11d9d8=_0x2b5474['product'][_0x2fa98b(0xbc)](async _0x4925c5=>{var _0xe0769f=_0x2fa98b,_0x1f38c2=await warehouse['findOne']({'name':_0x14c7a1,'room':_0x4925c5[_0xe0769f(0xe6)]});if(_0x4925c5[_0xe0769f(0x11a)]>0x0){var _0x1ba146=0x0;const _0x26cb1f=_0x1f38c2[_0xe0769f(0x12c)][_0xe0769f(0xbc)](_0x11fc2d=>{var _0x3118ed=_0xe0769f;_0x11fc2d[_0x3118ed(0xf6)]==_0x4925c5[_0x3118ed(0xf6)]&&_0x11fc2d[_0x3118ed(0x13d)]==_0x4925c5[_0x3118ed(0xac)]&&_0x11fc2d[_0x3118ed(0x108)]==_0x4925c5['expiry_date']&&_0x11fc2d[_0x3118ed(0x149)]==_0x4925c5['production_date']&&_0x11fc2d[_0x3118ed(0x147)]==_0x4925c5[_0x3118ed(0x147)]&&_0x11fc2d[_0x3118ed(0xbf)]==_0x4925c5[_0x3118ed(0x106)]&&(typeof _0x4925c5[_0x3118ed(0x137)]==_0x3118ed(0x95)?(console[_0x3118ed(0x8b)](_0x3118ed(0x145),_0x11fc2d[_0x3118ed(0xfb)]+_0x3118ed(0x13a)+_0x11fc2d[_0x3118ed(0xe9)]+_0x3118ed(0x139)+Math[_0x3118ed(0xc1)](_0x11fc2d[_0x3118ed(0xfb)])+Math[_0x3118ed(0xc1)](_0x4925c5['to_quantity'])),_0x11fc2d['product_stock']=Math[_0x3118ed(0xc1)](_0x11fc2d[_0x3118ed(0xfb)])+Math[_0x3118ed(0xc1)](_0x4925c5[_0x3118ed(0x11a)])):_0x11fc2d[_0x3118ed(0xfb)]=Math[_0x3118ed(0xc1)](_0x11fc2d[_0x3118ed(0xfb)])+Math[_0x3118ed(0xc1)](_0x4925c5[_0x3118ed(0x11a)]),_0x1ba146++);});_0x1ba146=='0'&&(_0x1f38c2[_0xe0769f(0x12c)]=_0x1f38c2['product_details']['concat']({'product_name':_0x4925c5['product_name'],'product_stock':_0x4925c5[_0xe0769f(0x11a)],'bay':_0x4925c5[_0xe0769f(0xac)],'level':_0x4925c5['to_level'],'product_code':_0x4925c5['product_code'],'primary_code':_0x4925c5['primary_code'],'secondary_code':_0x4925c5[_0xe0769f(0x94)],'expiry_date':_0x4925c5['expiry_date'],'production_date':_0x4925c5['production_date'],'maxProducts':_0x4925c5[_0xe0769f(0xba)],'batch_code':_0x4925c5[_0xe0769f(0x147)],'secondary_unit':_0x4925c5['secondary_unit'],'unit':_0x4925c5[_0xe0769f(0x93)],'maxProducts':_0x4925c5['maxProducts'],'maxPerUnit':_0x4925c5[_0xe0769f(0x10c)],'invoice':_0x4925c5[_0xe0769f(0x106)]}));}return _0x1f38c2;});Promise[_0x2fa98b(0xdf)](_0x11d9d8)['then'](async _0x2e4629=>{var _0xb05dce=_0x2fa98b;try{console[_0xb05dce(0x8b)](_0x2b5474['type_of_process']);if(_0x2b5474['type_of_process']!=_0xb05dce(0x86))for(const _0x2ff412 of _0x2e4629){await warehouse[_0xb05dce(0xd9)]({'_id':_0x2ff412[_0xb05dce(0xe9)]},{'$addToSet':{'product_details':{'$each':_0x2ff412[_0xb05dce(0x12c)]}}});}_0x2b5474[_0xb05dce(0xc2)]=_0xb05dce(0x146);const _0x15d850=await _0x2b5474[_0xb05dce(0x115)](),_0x3e5c56=await master_shop['find'](),_0x35c28a=await email_settings[_0xb05dce(0xca)](),_0x4b7c7b=await supervisor_settings[_0xb05dce(0xcc)]();var _0x571a96=_0x2b5474['product'],_0x461cc7='',_0x59dedd;for(_0x59dedd in _0x571a96){var _0x1f2d31='FG';_0x2b5474['to_warehouse']==_0xb05dce(0x87)&&(_0x1f2d31='DG'),_0x461cc7+=_0xb05dce(0xb1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x571a96[_0x59dedd][_0xb05dce(0xf6)]+_0xb05dce(0x123)+_0xb05dce(0x9e)+_0x571a96[_0x59dedd][_0xb05dce(0xc9)]+_0xb05dce(0x123)+_0xb05dce(0x9e)+_0x571a96[_0x59dedd][_0xb05dce(0x11a)]+_0xb05dce(0x123)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x571a96[_0x59dedd][_0xb05dce(0x93)]+'</td>'+_0xb05dce(0x9e)+_0x571a96[_0x59dedd][_0xb05dce(0xbd)]+_0xb05dce(0x123)+_0xb05dce(0x9e)+_0x2b5474[_0xb05dce(0xa7)]+_0xb05dce(0x123)+_0xb05dce(0x9e)+_0x571a96[_0x59dedd][_0xb05dce(0xe6)]+_0xb05dce(0x123)+_0xb05dce(0x9e)+_0x1f2d31+_0x571a96[_0x59dedd][_0xb05dce(0xac)]+'</td>'+_0xb05dce(0xdc);}_0x413725[_0xb05dce(0xf0)]('success','Transfer\x20Finalize\x20Successfully'),_0x39b094[_0xb05dce(0xf9)](_0xb05dce(0x9c)+_0x15d850[_0xb05dce(0xe9)]);}catch(_0x57702b){console[_0xb05dce(0xcd)](_0x57702b),_0x39b094['status'](0x1f4)[_0xb05dce(0xfa)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x2fa98b(0xae)](_0x2e844f=>{var _0x14436f=_0x2fa98b;console[_0x14436f(0xcd)](_0x2e844f),_0x39b094[_0x14436f(0x105)](0x1f4)[_0x14436f(0xfa)]({'error':_0x14436f(0xd4)});});}catch(_0x1a2f51){console[_0x2fa98b(0xcd)](_0x1a2f51),_0x39b094['status'](0x1f4)[_0x2fa98b(0xfa)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x1ea55d(0xae)](_0x46de06=>{var _0xc7883e=_0x1ea55d;console[_0xc7883e(0xcd)](_0x46de06),_0x39b094['status'](0x1f4)[_0xc7883e(0xfa)]({'error':'An\x20error\x20occurred.'});});}catch(_0x4f1a45){_0x39b094['json']({'message':_0x4f1a45[_0x1ea55d(0xd6)]});}});function BayBinSelected(_0xbeb367,_0xd0bf68){var _0x267844=a0_0x240a0e,_0x4caaab=[];let _0x5bf2c1=[];var _0x47a0d1=[];if(_0xbeb367==_0x267844(0x87)){switch(_0xd0bf68){case _0x267844(0x12e):_0x4caaab=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x267844(0xc7):_0x4caaab=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x47a0d1=['DG'];}else{if(_0xbeb367==_0x267844(0x14a)){switch(_0xd0bf68){case'Rack\x201':_0x4caaab=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x267844(0xc7):_0x4caaab=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x47a0d1=['FG'];}}return{'levels':_0x4caaab,'identify':_0x47a0d1};}router[a0_0x240a0e(0xde)](a0_0x240a0e(0x92),auth,async(_0x5a6b95,_0x9e6b6)=>{var _0xc82346=a0_0x240a0e;try{const {username:_0x1907b9,email:_0x320c4c,role:_0x5a9c78}=_0x5a6b95[_0xc82346(0x101)],_0x5796e6=_0x5a6b95[_0xc82346(0x101)],_0x65393f=await profile['findOne']({'email':_0x5796e6[_0xc82346(0xf2)]}),_0x567e31=await master_shop[_0xc82346(0xcc)](),_0x264823=await transfers_finished[_0xc82346(0x99)](_0x5a6b95['params']['id']);let _0xe7c01a=new Date(_0x264823[_0xc82346(0x108)]),_0x4b50ed=('0'+_0xe7c01a['getDate']())[_0xc82346(0xd5)](-0x2),_0x4c8554=('0'+(_0xe7c01a[_0xc82346(0xc5)]()+0x1))[_0xc82346(0xd5)](-0x2),_0x400976=_0xe7c01a[_0xc82346(0xb0)](),_0x3d4f16=_0x400976+'-'+_0x4c8554+'-'+_0x4b50ed,_0x1787ca;if(_0x5796e6[_0xc82346(0xd0)]==_0xc82346(0x85)){const _0x57a879=await staff[_0xc82346(0xca)]({'email':_0x5796e6[_0xc82346(0xf2)]});_0x1787ca=await warehouse['find']({'status':_0xc82346(0x120),'name':_0x57a879[_0xc82346(0xa8)],'warehouse_category':_0xc82346(0xa4)});}else _0x1787ca=await warehouse['find']({'status':_0xc82346(0x120),'warehouse_category':_0xc82346(0xa4)});const _0x3a8ef6=await warehouse[_0xc82346(0x116)]([{'$match':{'name':_0x264823['from_warehouse'],'room':_0x264823[_0xc82346(0x140)]}},{'$unwind':_0xc82346(0x11d)},{'$group':{'_id':_0xc82346(0xbe),'name':{'$first':_0xc82346(0x122)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xc82346(0x14b)},'bin':{'$first':_0xc82346(0x8e)},'type':{'$first':_0xc82346(0x13f)},'floorlevel':{'$first':_0xc82346(0x133)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xc82346(0xe3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xc82346(0xa1)}}}]);var _0x173f15=[0x1,0x2,0x3,0x4],_0x8b5255=['A','B','C','D','E','F','G','H','I','J'],_0x1fe0a3=[_0xc82346(0x107),_0xc82346(0x100)];const _0x32434d=await product['find']({}),_0x347fc9=BayBinSelected(_0x264823[_0xc82346(0xa7)],_0x264823['to_room']);if(_0x567e31[0x0][_0xc82346(0xb8)]=='English\x20(US)'){var _0x2edd06=users[_0xc82346(0xa0)];console['log'](_0x2edd06);}else{if(_0x567e31[0x0][_0xc82346(0xb8)]==_0xc82346(0x136))var _0x2edd06=users[_0xc82346(0x136)];else{if(_0x567e31[0x0][_0xc82346(0xb8)]==_0xc82346(0xfd))var _0x2edd06=users['German'];else{if(_0x567e31[0x0][_0xc82346(0xb8)]==_0xc82346(0xa2))var _0x2edd06=users[_0xc82346(0xa2)];else{if(_0x567e31[0x0][_0xc82346(0xb8)]==_0xc82346(0x82))var _0x2edd06=users[_0xc82346(0x82)];else{if(_0x567e31[0x0][_0xc82346(0xb8)]==_0xc82346(0xef))var _0x2edd06=users[_0xc82346(0xb3)];else{if(_0x567e31[0x0][_0xc82346(0xb8)]==_0xc82346(0xd8))var _0x2edd06=users[_0xc82346(0xd8)];else{if(_0x567e31[0x0][_0xc82346(0xb8)]=='Arabic\x20(ae)')var _0x2edd06=users[_0xc82346(0x11e)];}}}}}}}_0x9e6b6[_0xc82346(0xd2)](_0xc82346(0x119),{'success':_0x5a6b95[_0xc82346(0xf0)](_0xc82346(0xfe)),'errors':_0x5a6b95['flash'](_0xc82346(0x89)),'role':_0x5796e6,'profile':_0x65393f,'master_shop':_0x567e31,'warehouse':_0x1787ca,'transfer':_0x264823,'stock':_0x3a8ef6,'unit':_0x32434d,'language':_0x2edd06,'levels':_0x173f15,'Isle':_0x8b5255,'rooms_data':_0x1fe0a3,'ed_fullDate':_0x3d4f16,'dataSelected':_0x347fc9});}catch(_0x362800){console[_0xc82346(0x8b)](_0x362800);}}),router[a0_0x240a0e(0x8c)](a0_0x240a0e(0x92),auth,async(_0xc3f1e8,_0x3fb361)=>{var _0x4142da=a0_0x240a0e;try{const _0x11c9f2=_0xc3f1e8[_0x4142da(0x127)]['id'];console[_0x4142da(0x8b)](_0xc3f1e8[_0x4142da(0xf7)]);const _0x130214=await transfers_finished[_0x4142da(0x99)](_0x11c9f2);console[_0x4142da(0x8b)](_0x4142da(0x83),_0x130214);const {date:_0x10323b,from_warehouse:_0x5a0dee,FromRoom_name:_0x23142b,to_warehouse:_0xcb631d,ToRoom_name:_0x575c8f,prod_name:_0x10847b,from_prod_qty:_0xf92e3d,from_prod_level:_0x5db5f8,from_prod_isle:_0x30f3cb,from_prod_pallet:_0x1ebf34,to_prod_qty:_0x42e18d,to_prod_level:_0x495dd3,to_prod_isle:_0x80364d,to_prod_pallet:_0x302f74,primary_code:_0x2697ca,secondary_code:_0x3888af,product_code3:_0x558937,note:_0x308683,invoice:_0x1b438c,expiry_date:_0x7c7d42}=_0xc3f1e8['body'];if(typeof _0x10847b=='string')var _0x825f52=[_0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0xd3)]],_0x3917bb=[_0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x13e)]],_0x4e39ce=[_0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x121)]],_0x5bb3cf=[_0xc3f1e8[_0x4142da(0xf7)]['to_prod_qty']],_0x136ac3=[_0xc3f1e8['body'][_0x4142da(0xe0)]],_0x1ae921=[_0xc3f1e8[_0x4142da(0xf7)]['primary_code']],_0x3fccd9=[_0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x94)]],_0x492e8e=[_0xc3f1e8['body'][_0x4142da(0xce)]],_0x8250a=[_0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0xeb)]],_0x1d311c=[_0xc3f1e8['body'][_0x4142da(0x93)]],_0x5810a5=[_0xc3f1e8['body'][_0x4142da(0xbd)]],_0x1fed6c=[_0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x147)]],_0x5724de=[_0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x108)]];else var _0x825f52=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0xd3)]],_0x3917bb=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x13e)]],_0x4e39ce=[..._0xc3f1e8[_0x4142da(0xf7)]['from_prod_level']],_0x5bb3cf=[..._0xc3f1e8['body']['to_prod_qty']],_0x136ac3=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0xe0)]],_0x1ae921=[..._0xc3f1e8[_0x4142da(0xf7)]['primary_code']],_0x3fccd9=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x94)]],_0x492e8e=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0xce)]],_0x8250a=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0xeb)]],_0x1d311c=[..._0xc3f1e8[_0x4142da(0xf7)]['unit']],_0x5810a5=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0xbd)]],_0x1fed6c=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x147)]],_0x5724de=[..._0xc3f1e8[_0x4142da(0xf7)][_0x4142da(0x108)]];const _0x44d26a=_0x825f52[_0x4142da(0xbc)](_0x284472=>{return _0x284472={'product_name':_0x284472};});_0x3917bb[_0x4142da(0xe7)]((_0x101d05,_0x1f0d0b)=>{var _0x36481c=_0x4142da;_0x44d26a[_0x1f0d0b][_0x36481c(0x88)]=_0x101d05;}),_0x4e39ce['forEach']((_0x2a5096,_0x3d70cb)=>{var _0x509091=_0x4142da;_0x44d26a[_0x3d70cb][_0x509091(0xc8)]=_0x2a5096;}),_0x5bb3cf[_0x4142da(0xe7)]((_0x387f75,_0x35800f)=>{var _0xc53dc3=_0x4142da;_0x44d26a[_0x35800f][_0xc53dc3(0x11a)]=_0x387f75;}),_0x136ac3[_0x4142da(0xe7)]((_0xacbc0d,_0x3e7da2)=>{var _0x4f2910=_0x4142da;_0x44d26a[_0x3e7da2][_0x4f2910(0xac)]=_0xacbc0d;}),_0x1ae921[_0x4142da(0xe7)]((_0x414588,_0x41433d)=>{_0x44d26a[_0x41433d]['primary_code']=_0x414588;}),_0x3fccd9['forEach']((_0x2dad94,_0x1b6529)=>{var _0x41f7bc=_0x4142da;_0x44d26a[_0x1b6529][_0x41f7bc(0x94)]=_0x2dad94;}),_0x492e8e[_0x4142da(0xe7)]((_0x3de061,_0xf34d66)=>{var _0x1fcc41=_0x4142da;_0x44d26a[_0xf34d66][_0x1fcc41(0xc9)]=_0x3de061;}),_0x8250a['forEach']((_0x4f9795,_0x4f6d0f)=>{_0x44d26a[_0x4f6d0f]['maxProducts']=_0x4f9795;}),_0x1d311c[_0x4142da(0xe7)]((_0x15d361,_0x11b506)=>{var _0x26ac53=_0x4142da;_0x44d26a[_0x11b506][_0x26ac53(0x93)]=_0x15d361;}),_0x5810a5['forEach']((_0x55f541,_0x525dbc)=>{var _0x3e1e7a=_0x4142da;_0x44d26a[_0x525dbc][_0x3e1e7a(0xbd)]=_0x55f541;}),_0x1fed6c[_0x4142da(0xe7)]((_0x4af688,_0x58a269)=>{var _0x1c04eb=_0x4142da;_0x44d26a[_0x58a269][_0x1c04eb(0x147)]=_0x4af688;}),_0x5724de['forEach']((_0x1ffa7a,_0x5af086)=>{_0x44d26a[_0x5af086]['expiry_date']=_0x1ffa7a;});const _0x2ea41d=_0x44d26a['filter'](_0x355b5a=>_0x355b5a[_0x4142da(0x11a)]!=='0'&&_0x355b5a[_0x4142da(0x11a)]!==''||_0x355b5a[_0x4142da(0xb7)]!=='0'&&_0x355b5a[_0x4142da(0xb7)]!=='');var _0x45445d=0x0;_0x2ea41d[_0x4142da(0xe7)](_0x2a87f9=>{var _0x3a6935=_0x4142da;parseInt(_0x2a87f9[_0x3a6935(0x88)])<parseInt(_0x2a87f9['to_quantity'])&&_0x45445d++;});if(_0x45445d!=0x0)return _0xc3f1e8[_0x4142da(0xf0)](_0x4142da(0x89),_0x4142da(0x113)),_0x3fb361['redirect'](_0x4142da(0x10d));const _0x33fd98=await warehouse['findOne']({'name':_0x130214[_0x4142da(0x126)],'room':_0x130214[_0x4142da(0x140)]});_0x130214[_0x4142da(0xc3)][_0x4142da(0xe7)](_0x76e182=>{var _0x4ee17a=_0x4142da;if(_0x76e182[_0x4ee17a(0x11a)]>0x0){const _0x31025f=_0x33fd98[_0x4ee17a(0x12c)]['map'](_0x1c824d=>{var _0x5841ac=_0x4ee17a;_0x1c824d[_0x5841ac(0xf6)]==_0x76e182[_0x5841ac(0xf6)]&&_0x1c824d[_0x5841ac(0x13d)]==_0x76e182['from_bay']&&(_0x1c824d[_0x5841ac(0xfb)]=parseInt(_0x1c824d[_0x5841ac(0xfb)])+parseInt(_0x76e182[_0x5841ac(0x11a)]));});}}),await _0x33fd98['save']();const _0x2206e2=await warehouse[_0x4142da(0xca)]({'name':_0x130214[_0x4142da(0xa7)],'room':_0x130214[_0x4142da(0x80)]});_0x130214['product'][_0x4142da(0xe7)](_0x244c46=>{var _0x501ad1=_0x4142da;if(_0x244c46[_0x501ad1(0x11a)]>0x0){const _0x1f26b0=_0x2206e2['product_details']['map'](_0x105dfd=>{var _0x1e4341=_0x501ad1;_0x105dfd[_0x1e4341(0xf6)]==_0x244c46[_0x1e4341(0xf6)]&&_0x105dfd['bay']==_0x244c46[_0x1e4341(0xac)]&&(_0x105dfd[_0x1e4341(0xfb)]=parseInt(_0x105dfd[_0x1e4341(0xfb)])-parseInt(_0x244c46['to_quantity']));});}}),await _0x2206e2['save'](),_0x130214[_0x4142da(0x8f)]=_0x10323b,_0x130214['from_warehouse']=_0x5a0dee,_0x130214[_0x4142da(0xa7)]=_0xcb631d,_0x130214[_0x4142da(0xc3)]=_0x2ea41d,_0x130214[_0x4142da(0x112)]=_0x308683,_0x130214['invoice']=_0x1b438c;const _0x621f4c=await _0x130214['save'](),_0x556bd4=await warehouse[_0x4142da(0xca)]({'name':_0x5a0dee,'room':_0x23142b});_0x621f4c[_0x4142da(0xc3)][_0x4142da(0xe7)](_0x48b2b9=>{var _0xb270cc=_0x4142da;if(_0x48b2b9[_0xb270cc(0x11a)]>0x0){const _0x28988e=_0x556bd4[_0xb270cc(0x12c)]['map'](_0x420252=>{var _0x853e2c=_0xb270cc;_0x420252[_0x853e2c(0xf6)]==_0x48b2b9[_0x853e2c(0xf6)]&&_0x420252[_0x853e2c(0x13d)]==_0x48b2b9['from_bay']&&(_0x420252['product_stock']=parseInt(_0x420252[_0x853e2c(0xfb)])-parseInt(_0x48b2b9[_0x853e2c(0x11a)]));});}}),await _0x556bd4[_0x4142da(0x115)]();const _0x36ab2b=await warehouse['findOne']({'name':_0xcb631d,'room':_0x575c8f});_0x621f4c[_0x4142da(0xc3)]['forEach'](_0x12f5fc=>{var _0x4f6627=_0x4142da;if(_0x12f5fc[_0x4f6627(0x11a)]>0x0){var _0x598525=0x0;const _0x4e0bbd=_0x36ab2b['product_details'][_0x4f6627(0xbc)](_0x4029ff=>{var _0x38bf8b=_0x4f6627;_0x4029ff[_0x38bf8b(0xf6)]==_0x12f5fc['product_name']&&_0x4029ff[_0x38bf8b(0x13d)]==_0x12f5fc[_0x38bf8b(0xac)]&&(_0x4029ff[_0x38bf8b(0xfb)]=parseInt(_0x4029ff['product_stock'])+parseInt(_0x12f5fc[_0x38bf8b(0x11a)]),_0x598525++);});_0x598525=='0'&&(_0x36ab2b[_0x4f6627(0x12c)]=_0x36ab2b[_0x4f6627(0x12c)][_0x4f6627(0x104)]({'product_name':_0x12f5fc['product_name'],'product_stock':_0x12f5fc[_0x4f6627(0x11a)],'bay':_0x12f5fc[_0x4f6627(0xac)],'product_code':_0x12f5fc[_0x4f6627(0xc9)],'primary_code':_0x12f5fc['primary_code'],'secondary_code':_0x12f5fc[_0x4f6627(0x94)],'maxProducts':_0x12f5fc[_0x4f6627(0xba)]}));}}),await _0x36ab2b[_0x4142da(0x115)](),_0xc3f1e8[_0x4142da(0xf0)](_0x4142da(0xfe),_0x4142da(0xaf)),_0x3fb361[_0x4142da(0xf9)](_0x4142da(0x8d));}catch(_0xbe32e4){console[_0x4142da(0x8b)](_0xbe32e4);}}),router[a0_0x240a0e(0x8c)]('/barcode_scanner',async(_0x1f124d,_0x18c251)=>{var _0x4c639b=a0_0x240a0e;const {FromWareHouse:_0x5808ef,FromRoom:_0x25945d,ToWarehouse:_0x4560f0,ToRoom:_0x497f94,primary_code:_0x22d9c1,Roomslist:_0x208ea1}=_0x1f124d[_0x4c639b(0xf7)],_0x1f5c68=_0x208ea1[_0x4c639b(0xed)](','),_0x3c79ea=[];async function _0x5a0a88(_0x161233){var _0x5064ec=_0x4c639b;const _0x575848=await warehouse[_0x5064ec(0x116)]([{'$match':{'name':_0x5808ef,'room':_0x161233}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x22d9c1}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5064ec(0x122)},'instock':{'$first':_0x5064ec(0xa6)},'primary_code':{'$first':_0x5064ec(0x11b)},'secondary_code':{'$first':_0x5064ec(0x138)},'product_code':{'$first':_0x5064ec(0xe3)},'bay':{'$first':_0x5064ec(0x14b)},'level':{'$first':'$product_details.level'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5064ec(0xc0)},'secondary_unit':{'$first':_0x5064ec(0xb5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5064ec(0xa1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x5064ec(0x11f)},'maxPerUnit':{'$first':_0x5064ec(0x134)},'roomNamed':{'$first':_0x5064ec(0x90)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x5064ec(0x12b)}}}]),_0x41fc19=await warehouse[_0x5064ec(0x116)]([{'$match':{'name':_0x5808ef,'room':_0x161233}},{'$unwind':_0x5064ec(0x11d)},{'$match':{'product_details.secondary_code':_0x22d9c1}},{'$group':{'_id':_0x5064ec(0xbe),'name':{'$first':_0x5064ec(0x122)},'instock':{'$first':_0x5064ec(0xa6)},'primary_code':{'$first':_0x5064ec(0x11b)},'secondary_code':{'$first':_0x5064ec(0x138)},'product_code':{'$first':_0x5064ec(0xe3)},'bay':{'$first':'$product_details.bay'},'level':{'$first':_0x5064ec(0xee)},'type':{'$first':_0x5064ec(0x13f)},'pallet':{'$first':_0x5064ec(0x133)},'unit':{'$first':_0x5064ec(0xc0)},'secondary_unit':{'$first':_0x5064ec(0xb5)},'storage':{'$first':_0x5064ec(0x110)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5064ec(0xf1)},'production_date':{'$first':_0x5064ec(0x103)},'batch_code':{'$first':_0x5064ec(0x11f)},'maxPerUnit':{'$first':_0x5064ec(0x134)},'roomNamed':{'$first':_0x5064ec(0x90)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x5064ec(0x12b)}}}]);if(_0x575848[_0x5064ec(0xcb)]>0x0)_0x3c79ea[_0x5064ec(0x12d)](_0x575848);else _0x41fc19[_0x5064ec(0xcb)]>0x0&&_0x3c79ea[_0x5064ec(0x12d)](_0x41fc19);}const _0x4b8e48=_0x1f5c68['map'](_0x5e48a9=>_0x5a0a88(_0x5e48a9));await Promise[_0x4c639b(0xdf)](_0x4b8e48),_0x18c251[_0x4c639b(0xfa)](_0x3c79ea);}),router[a0_0x240a0e(0x8c)](a0_0x240a0e(0xa3),async(_0x4c486f,_0x25deea)=>{var _0x797af2=a0_0x240a0e;const {productCode:_0x523f00,bay:_0x167494,warehouses:_0x3682e7,room:_0xc8a892}=_0x4c486f['body'];console['log'](_0x4c486f[_0x797af2(0xf7)]);try{const _0x1b1bd7=await warehouse[_0x797af2(0x116)]([{'$match':{'name':_0x3682e7,'room':_0xc8a892}},{'$unwind':_0x797af2(0x11d)},{'$match':{'product_details.bay':parseInt(_0x167494)}},{'$group':{'_id':_0x797af2(0xbe),'name':{'$first':_0x797af2(0x122)},'product_stock':{'$first':_0x797af2(0xa6)},'bay':{'$first':_0x797af2(0x14b)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x25deea[_0x797af2(0x105)](0xc8)[_0x797af2(0xfa)](_0x1b1bd7);}catch(_0x413c21){_0x25deea[_0x797af2(0x105)](0x194)['json']({'message':_0x413c21[_0x797af2(0xd6)]});}}),module[a0_0x240a0e(0xa5)]=router;