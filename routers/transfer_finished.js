var a0_0x518cae=a0_0x13b6;(function(_0x614325,_0x4fdf69){var _0x4a12f6=a0_0x13b6,_0x249434=_0x614325();while(!![]){try{var _0x5734f7=parseInt(_0x4a12f6(0xfd))/0x1*(parseInt(_0x4a12f6(0xf9))/0x2)+parseInt(_0x4a12f6(0x189))/0x3*(parseInt(_0x4a12f6(0x108))/0x4)+-parseInt(_0x4a12f6(0xfe))/0x5*(parseInt(_0x4a12f6(0xe2))/0x6)+-parseInt(_0x4a12f6(0x14c))/0x7+-parseInt(_0x4a12f6(0x199))/0x8*(parseInt(_0x4a12f6(0x169))/0x9)+parseInt(_0x4a12f6(0x171))/0xa+parseInt(_0x4a12f6(0x14d))/0xb*(-parseInt(_0x4a12f6(0x11d))/0xc);if(_0x5734f7===_0x4fdf69)break;else _0x249434['push'](_0x249434['shift']());}catch(_0x32b248){_0x249434['push'](_0x249434['shift']());}}}(a0_0x1073,0xacd29));function a0_0x1073(){var _0x14df33=['/view_logs','/CheckingWarehouse','status','/view/addlog','get','519153QUlCYR','updateOne','random','Arabic','secondary_unit','edit_transfer_finished','here2','from_room','$product_details.product_code','Portuguese','An\x20error\x20occurred.','transfer_finished_logs','Chinese','from_prod_level2','unit','German','4148184zXSReD','filter','find','</tr>','invoice_init','$room','LOG-TRF-','Ambient','findOne','to_room','from_warehouse','product_stock','/view/choose_logs','then','to_bay','$date','back','<tr>','staff','secondary_code','transfer_finished','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','forEach','type_of_process','primary_unit','DRY\x20GOODS','6GQfSaa','language','params','map','TRFF-','to_room_name','product_details','Router','Hindi','expiry_date','$product','production_date','getDate','findById','TRF-','Finished\x20Goods','concat','floor','to_quantity','bin2bin','$_id','padStart','product_date','2JcmdFM','primary_code','/preview/:id','string','1403716UOotnn','782545dlchIE','error','body','aggregate','$invoice','getFullYear','finalize','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.bay','To_invoice','12FlDRil','$product_details.bin','from_invoice','own','$product_details.rack','$product_details.primary_code','length','id_transaction','Arabic\x20(ae)','log','slice','user','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.product_name','maxProducts','split','transfer_data','$product.from_room_name','$finalize','../models/all_models','/view/add_transfer_logs','3739524ucazRP','render','$product_details.batch_code','/transfer/view','json','</td>','RoomAssigned','Enabled','Spanish','bay','product','success','/view/add_transfer','$product_details.level','product_code3','English\x20(US)','to_level','match','flash','MaxStocks_data','_id','toString','$product_details.product_stock','express','/picking_list/PDF_transfer/','Product\x20Transfer\x20successfully','$name','prod_cat','to_floorlevel','from_quantity','catch','message','from_prod_qty','date','from_level','\x20<>\x20','undefined','/transfer_finished/preview/','$to_warehouse','product_code','$product_details.storage','Transfer\x20Edit\x20Successfully','MaxStocks_data2','save','French','$from_warehouse','ToRoomAssigned','6977110wpGePq','33IEOmKz','$product_details','$product_details.maxProducts','English','warehouse','logs','edit_transfer_finished_view','$product_details._id','prod_name','$product_details.invoice','$product_details.floorlevel','An\x20error\x20occurred\x20while\x20saving\x20data.','email','/transfer_finished/view','\x20<=>\x20','$product_details.secondary_unit','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','post','role','location2location','Enclosed','to_warehouse','abs','all','batch_code','redirect','max','$product_details.secondary_code','9zyBeQv','/view/:id','note','$product_details.unit','choos_transfer_logs','invoice','to_prod_qty','$product_details.type','13916550zzBymh','to_prod_level','from_bay','$product_details.production_date','choos_transfer','push','maxPerUnit','from_prod_level','FROZEN\x20GOODS','errors','product_name','New_Qty_Converted','from_room_name','$product_details.expiry_date','$product_details.maxPerUnit','Rack\x201','Rack\x202','Portuguese\x20(BR)','$product.to_room_name'];a0_0x1073=function(){return _0x14df33;};return a0_0x1073();}const express=require(a0_0x518cae(0x134)),app=express(),router=express[a0_0x518cae(0xe9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x518cae(0x11b)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x518cae(0x188)]('/view',auth,async(_0x10b54d,_0xe6ac)=>{var _0x3ef4d3=a0_0x518cae;try{const {username:_0x520c46,email:_0x3a67b0,role:_0x1cd73f}=_0x10b54d[_0x3ef4d3(0x113)],_0x15a075=_0x10b54d[_0x3ef4d3(0x113)],_0x1ec5bf=await profile[_0x3ef4d3(0xd0)]({'email':_0x15a075[_0x3ef4d3(0x159)]}),_0x2a8790=await master_shop[_0x3ef4d3(0x19b)]();let _0x158428;if(_0x15a075[_0x3ef4d3(0x15f)]==_0x3ef4d3(0xda)){const _0x73aa3d=await staff[_0x3ef4d3(0xd0)]({'email':_0x15a075['email']});_0x158428=await transfers_finished[_0x3ef4d3(0x19b)]({'from_warehouse':_0x73aa3d['warehouse']});}else _0x158428=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':'own'}},{'$unwind':_0x3ef4d3(0xec)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x3ef4d3(0xd7)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x3ef4d3(0x143)},'from_room_name':{'$addToSet':_0x3ef4d3(0x119)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x3ef4d3(0x11a)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2a8790[0x0][_0x3ef4d3(0xe3)]==_0x3ef4d3(0x12c))var _0xaade2e=users['English'];else{if(_0x2a8790[0x0]['language']==_0x3ef4d3(0xea))var _0xaade2e=users[_0x3ef4d3(0xea)];else{if(_0x2a8790[0x0][_0x3ef4d3(0xe3)]==_0x3ef4d3(0x198))var _0xaade2e=users['German'];else{if(_0x2a8790[0x0]['language']=='Spanish')var _0xaade2e=users['Spanish'];else{if(_0x2a8790[0x0][_0x3ef4d3(0xe3)]==_0x3ef4d3(0x149))var _0xaade2e=users[_0x3ef4d3(0x149)];else{if(_0x2a8790[0x0][_0x3ef4d3(0xe3)]=='Portuguese\x20(BR)')var _0xaade2e=users['Portuguese'];else{if(_0x2a8790[0x0][_0x3ef4d3(0xe3)]==_0x3ef4d3(0x195))var _0xaade2e=users[_0x3ef4d3(0x195)];else{if(_0x2a8790[0x0][_0x3ef4d3(0xe3)]==_0x3ef4d3(0x110))var _0xaade2e=users['Arabic'];}}}}}}}_0xe6ac[_0x3ef4d3(0x11e)](_0x3ef4d3(0xdc),{'success':_0x10b54d[_0x3ef4d3(0x12f)](_0x3ef4d3(0x128)),'errors':_0x10b54d['flash'](_0x3ef4d3(0x17a)),'role':_0x15a075,'profile':_0x1ec5bf,'master_shop':_0x2a8790,'transfer':_0x158428,'language':_0xaade2e});}catch(_0xbc432d){console['log'](_0xbc432d);}}),router[a0_0x518cae(0x188)](a0_0x518cae(0x184),auth,async(_0x196207,_0x9d004a)=>{var _0x4f1241=a0_0x518cae;try{const {username:_0x4a6090,email:_0x5d6b74,role:_0x391b22}=_0x196207['user'],_0xd9b16b=_0x196207[_0x4f1241(0x113)],_0x1e9da2=await profile[_0x4f1241(0xd0)]({'email':_0xd9b16b[_0x4f1241(0x159)]}),_0x32776b=await master_shop['find']();let _0x412c75;if(_0xd9b16b['role']=='staff'){const _0x23b286=await staff[_0x4f1241(0xd0)]({'email':_0xd9b16b[_0x4f1241(0x159)]});_0x412c75=await transfers_finished[_0x4f1241(0x19b)]({'from_warehouse':_0x23b286[_0x4f1241(0x151)]});}else _0x412c75=await transfers_finished[_0x4f1241(0x101)]([{'$match':{'type_of_transaction':_0x4f1241(0x152)}},{'$unwind':_0x4f1241(0xec)},{'$group':{'_id':_0x4f1241(0xf6),'invoice':{'$first':_0x4f1241(0x102)},'date':{'$first':_0x4f1241(0xd7)},'from_warehouse':{'$first':_0x4f1241(0x14a)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x4f1241(0x119)},'to_room_name':{'$addToSet':_0x4f1241(0x183)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x32776b[0x0][_0x4f1241(0xe3)]=='English\x20(US)')var _0x517681=users[_0x4f1241(0x150)];else{if(_0x32776b[0x0][_0x4f1241(0xe3)]==_0x4f1241(0xea))var _0x517681=users[_0x4f1241(0xea)];else{if(_0x32776b[0x0][_0x4f1241(0xe3)]==_0x4f1241(0x198))var _0x517681=users[_0x4f1241(0x198)];else{if(_0x32776b[0x0]['language']==_0x4f1241(0x125))var _0x517681=users[_0x4f1241(0x125)];else{if(_0x32776b[0x0][_0x4f1241(0xe3)]==_0x4f1241(0x149))var _0x517681=users[_0x4f1241(0x149)];else{if(_0x32776b[0x0][_0x4f1241(0xe3)]==_0x4f1241(0x182))var _0x517681=users[_0x4f1241(0x192)];else{if(_0x32776b[0x0][_0x4f1241(0xe3)]=='Chinese')var _0x517681=users['Chinese'];else{if(_0x32776b[0x0][_0x4f1241(0xe3)]==_0x4f1241(0x110))var _0x517681=users[_0x4f1241(0x18c)];}}}}}}}_0x9d004a[_0x4f1241(0x11e)](_0x4f1241(0x194),{'success':_0x196207[_0x4f1241(0x12f)](_0x4f1241(0x128)),'errors':_0x196207[_0x4f1241(0x12f)]('errors'),'role':_0xd9b16b,'profile':_0x1e9da2,'master_shop':_0x32776b,'transfer':_0x412c75,'language':_0x517681});}catch(_0x5ffe66){console[_0x4f1241(0x111)](_0x5ffe66);}});async function getRandom8DigitNumber(){var _0x293d21=a0_0x518cae;const _0x44d4bd=0x989680,_0x1e0dfd=0x5f5e0ff,_0x4795ce=Math[_0x293d21(0xf3)](Math[_0x293d21(0x18b)]()*(_0x1e0dfd-_0x44d4bd+0x1))+_0x44d4bd;var _0x1bd207;const _0x33a764=await transfers_finished[_0x293d21(0xd0)]({'invoice':_0x293d21(0xe6)+_0x4795ce});return _0x33a764&&_0x33a764[_0x293d21(0x10e)]>0x0?_0x1bd207='TRFF-'+_0x4795ce:_0x1bd207=_0x293d21(0xe6)+_0x4795ce,_0x1bd207;}router[a0_0x518cae(0x188)]('/view/add_transfer',auth,async(_0x1eb0bc,_0x5a1d21)=>{var _0x3c6618=a0_0x518cae;try{const {username:_0x7a0871,email:_0x553727,role:_0x1d657b}=_0x1eb0bc[_0x3c6618(0x113)],_0x2116a4=_0x1eb0bc[_0x3c6618(0x113)],_0x90a563=await profile[_0x3c6618(0xd0)]({'email':_0x2116a4[_0x3c6618(0x159)]}),_0x1b187e=await master_shop['find']();let _0x150fb9;if(_0x2116a4[_0x3c6618(0x15f)]==_0x3c6618(0xda)){const _0x5c1835=await staff[_0x3c6618(0xd0)]({'email':_0x2116a4['email']});_0x150fb9=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x5c1835[_0x3c6618(0x151)]}},{'$group':{'_id':_0x3c6618(0x137),'name':{'$first':'$name'}}}]);}else _0x150fb9=await warehouse[_0x3c6618(0x101)]([{'$match':{'status':_0x3c6618(0x124)}},{'$group':{'_id':'$name','name':{'$first':_0x3c6618(0x137)}}}]);const _0x1f3057=await transfers_finished['find']({}),_0x1dcec5=_0x1f3057['length']+0x1,_0x3ec8eb='TRFF-'+_0x1dcec5['toString']()[_0x3c6618(0xf7)](0x5,'0');if(_0x1b187e[0x0]['language']==_0x3c6618(0x12c))var _0x3fdc59=users[_0x3c6618(0x150)];else{if(_0x1b187e[0x0][_0x3c6618(0xe3)]==_0x3c6618(0xea))var _0x3fdc59=users[_0x3c6618(0xea)];else{if(_0x1b187e[0x0][_0x3c6618(0xe3)]==_0x3c6618(0x198))var _0x3fdc59=users['German'];else{if(_0x1b187e[0x0][_0x3c6618(0xe3)]==_0x3c6618(0x125))var _0x3fdc59=users[_0x3c6618(0x125)];else{if(_0x1b187e[0x0][_0x3c6618(0xe3)]==_0x3c6618(0x149))var _0x3fdc59=users[_0x3c6618(0x149)];else{if(_0x1b187e[0x0][_0x3c6618(0xe3)]==_0x3c6618(0x182))var _0x3fdc59=users[_0x3c6618(0x192)];else{if(_0x1b187e[0x0][_0x3c6618(0xe3)]==_0x3c6618(0x195))var _0x3fdc59=users[_0x3c6618(0x195)];else{if(_0x1b187e[0x0][_0x3c6618(0xe3)]==_0x3c6618(0x110))var _0x3fdc59=users[_0x3c6618(0x18c)];}}}}}}}const _0x2c9c9a=getRandom8DigitNumber();_0x2c9c9a[_0x3c6618(0xd5)](_0x6c448f=>{var _0x2c841b=_0x3c6618;_0x5a1d21[_0x2c841b(0x11e)]('add_transfer_finished',{'success':_0x1eb0bc[_0x2c841b(0x12f)]('success'),'errors':_0x1eb0bc['flash'](_0x2c841b(0x17a)),'role':_0x2116a4,'profile':_0x90a563,'master_shop':_0x1b187e,'warehouse':_0x150fb9,'language':_0x3fdc59,'invoice':_0x6c448f});})[_0x3c6618(0x13b)](_0x37af5f=>{var _0x4e568a=_0x3c6618;_0x1eb0bc[_0x4e568a(0x12f)](_0x4e568a(0x17a),_0x4e568a(0x105)),_0x5a1d21['redirect']('/transfer/view');});}catch(_0x251cde){console[_0x3c6618(0x111)](_0x251cde);}}),router[a0_0x518cae(0x188)]('/view/choose',auth,async(_0xe058a5,_0x5c4710)=>{var _0x1d5b15=a0_0x518cae;try{const {username:_0x5eda51,email:_0x5cd2f1,role:_0x32849f}=_0xe058a5[_0x1d5b15(0x113)],_0x1aa69f=_0xe058a5[_0x1d5b15(0x113)],_0x941b24=await profile['findOne']({'email':_0x1aa69f[_0x1d5b15(0x159)]}),_0x2e7fca=await master_shop[_0x1d5b15(0x19b)]();let _0x7c009b;if(_0x1aa69f[_0x1d5b15(0x15f)]=='staff'){const _0x317523=await staff[_0x1d5b15(0xd0)]({'email':_0x1aa69f[_0x1d5b15(0x159)]});_0x7c009b=await warehouse[_0x1d5b15(0x101)]([{'$match':{'status':_0x1d5b15(0x124),'name':_0x317523[_0x1d5b15(0x151)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x7c009b=await warehouse[_0x1d5b15(0x101)]([{'$match':{'status':_0x1d5b15(0x124)}},{'$group':{'_id':_0x1d5b15(0x137),'name':{'$first':_0x1d5b15(0x137)}}}]);const _0x30aecf=await transfers_finished[_0x1d5b15(0x19b)]({}),_0x478967=_0x30aecf[_0x1d5b15(0x10e)]+0x1,_0x5ebe18=_0x1d5b15(0xe6)+_0x478967[_0x1d5b15(0x132)]()['padStart'](0x5,'0');if(_0x2e7fca[0x0][_0x1d5b15(0xe3)]=='English\x20(US)')var _0x54de85=users['English'];else{if(_0x2e7fca[0x0]['language']==_0x1d5b15(0xea))var _0x54de85=users[_0x1d5b15(0xea)];else{if(_0x2e7fca[0x0][_0x1d5b15(0xe3)]==_0x1d5b15(0x198))var _0x54de85=users[_0x1d5b15(0x198)];else{if(_0x2e7fca[0x0][_0x1d5b15(0xe3)]==_0x1d5b15(0x125))var _0x54de85=users['Spanish'];else{if(_0x2e7fca[0x0]['language']==_0x1d5b15(0x149))var _0x54de85=users[_0x1d5b15(0x149)];else{if(_0x2e7fca[0x0][_0x1d5b15(0xe3)]==_0x1d5b15(0x182))var _0x54de85=users[_0x1d5b15(0x192)];else{if(_0x2e7fca[0x0][_0x1d5b15(0xe3)]==_0x1d5b15(0x195))var _0x54de85=users[_0x1d5b15(0x195)];else{if(_0x2e7fca[0x0]['language']==_0x1d5b15(0x110))var _0x54de85=users[_0x1d5b15(0x18c)];}}}}}}}const _0x557816=getRandom8DigitNumber();_0x557816[_0x1d5b15(0xd5)](_0x373bc3=>{var _0x4ffec0=_0x1d5b15;_0x5c4710[_0x4ffec0(0x11e)](_0x4ffec0(0x175),{'success':_0xe058a5['flash'](_0x4ffec0(0x128)),'errors':_0xe058a5['flash'](_0x4ffec0(0x17a)),'role':_0x1aa69f,'profile':_0x941b24,'master_shop':_0x2e7fca,'warehouse':_0x7c009b,'language':_0x54de85,'invoice':_0x373bc3});})[_0x1d5b15(0x13b)](_0x90ab12=>{var _0x45f443=_0x1d5b15;_0xe058a5[_0x45f443(0x12f)](_0x45f443(0x17a),_0x45f443(0x105)),_0x5c4710[_0x45f443(0x166)](_0x45f443(0x120));});}catch(_0x591f1b){console[_0x1d5b15(0x111)](_0x591f1b);}}),router[a0_0x518cae(0x188)](a0_0x518cae(0xd4),auth,async(_0x3d804a,_0x250698)=>{var _0x32da34=a0_0x518cae;try{const {username:_0x21d127,email:_0x9a245a,role:_0x5263bd}=_0x3d804a['user'],_0x3ead34=_0x3d804a[_0x32da34(0x113)],_0x293783=await profile[_0x32da34(0xd0)]({'email':_0x3ead34[_0x32da34(0x159)]}),_0x11f770=await master_shop[_0x32da34(0x19b)]();let _0x2c0dc3;if(_0x3ead34[_0x32da34(0x15f)]=='staff'){const _0x28a82f=await staff[_0x32da34(0xd0)]({'email':_0x3ead34[_0x32da34(0x159)]});_0x2c0dc3=await warehouse['aggregate']([{'$match':{'status':_0x32da34(0x124),'name':_0x28a82f['warehouse']}},{'$group':{'_id':_0x32da34(0x137),'name':{'$first':'$name'}}}]);}else _0x2c0dc3=await warehouse[_0x32da34(0x101)]([{'$match':{'status':_0x32da34(0x124)}},{'$group':{'_id':_0x32da34(0x137),'name':{'$first':_0x32da34(0x137)}}}]);const _0xf6bb56=await transfers_finished[_0x32da34(0x19b)]({}),_0x5b09bf=_0xf6bb56[_0x32da34(0x10e)]+0x1,_0x434539='TRFF-'+_0x5b09bf['toString']()[_0x32da34(0xf7)](0x5,'0');if(_0x11f770[0x0][_0x32da34(0xe3)]==_0x32da34(0x12c))var _0x1600fc=users[_0x32da34(0x150)];else{if(_0x11f770[0x0][_0x32da34(0xe3)]==_0x32da34(0xea))var _0x1600fc=users[_0x32da34(0xea)];else{if(_0x11f770[0x0][_0x32da34(0xe3)]=='German')var _0x1600fc=users[_0x32da34(0x198)];else{if(_0x11f770[0x0][_0x32da34(0xe3)]==_0x32da34(0x125))var _0x1600fc=users[_0x32da34(0x125)];else{if(_0x11f770[0x0][_0x32da34(0xe3)]=='French')var _0x1600fc=users[_0x32da34(0x149)];else{if(_0x11f770[0x0][_0x32da34(0xe3)]=='Portuguese\x20(BR)')var _0x1600fc=users[_0x32da34(0x192)];else{if(_0x11f770[0x0][_0x32da34(0xe3)]==_0x32da34(0x195))var _0x1600fc=users[_0x32da34(0x195)];else{if(_0x11f770[0x0][_0x32da34(0xe3)]==_0x32da34(0x110))var _0x1600fc=users[_0x32da34(0x18c)];}}}}}}}const _0x5df61b=getRandom8DigitNumber();_0x5df61b[_0x32da34(0xd5)](_0x3e9f70=>{var _0x4f70cf=_0x32da34;_0x250698[_0x4f70cf(0x11e)](_0x4f70cf(0x16d),{'success':_0x3d804a['flash'](_0x4f70cf(0x128)),'errors':_0x3d804a[_0x4f70cf(0x12f)](_0x4f70cf(0x17a)),'role':_0x3ead34,'profile':_0x293783,'master_shop':_0x11f770,'warehouse':_0x2c0dc3,'language':_0x1600fc,'invoice':_0x3e9f70});})[_0x32da34(0x13b)](_0x7f5907=>{var _0x283b0a=_0x32da34;_0x3d804a[_0x283b0a(0x12f)](_0x283b0a(0x17a),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x250698['redirect']('/transfer/view');});}catch(_0x367d85){console[_0x32da34(0x111)](_0x367d85);}}),router[a0_0x518cae(0x15e)](a0_0x518cae(0x11c),auth,async(_0x386856,_0x26af45)=>{var _0x21effb=a0_0x518cae;try{const {date:_0x2f1846,from_warehouse:_0x357e45,FromRoom_name:_0x204775,to_warehouse:_0x19ca8d,ToRoom_name:_0x1fd463,prod_name:_0x28b3cd,from_prod_qty:_0x244143,from_prod_level:_0x36c2b6,from_prod_isle:_0x35c505,from_prod_pallet:_0xfb30e,to_prod_qty:_0x35ff03,to_prod_level:_0x16c4b8,to_prod_isle:_0x5e766e,to_prod_pallet:_0x4f3573,primary_code:_0xcc6e57,secondary_code:_0x320e32,product_code3:_0x22940b,note:_0x2c397b,MaxStocks_data2:_0x225203,invoice:_0x20a871,expiry_date:_0xaa3a04,PO_number:_0x3bdbe5,ReqBy:_0x50fe94,dateofreq:_0x2f55ab,typeservicesData:_0x3b1166,destination:_0x1cfda9,deliverydate:_0x5f464e,driver:_0x44fd0e,plate:_0x1be970,van:_0x318f94,DRSI:_0x320e5b,typevehicle:_0x4704f2,TSU:_0x4088a0,TFU:_0x38f82c}=_0x386856[_0x21effb(0x100)];if(typeof _0x28b3cd==_0x21effb(0xfc))var _0x8951a3=[_0x386856[_0x21effb(0x100)][_0x21effb(0x155)]],_0x22cf35=[_0x386856[_0x21effb(0x100)][_0x21effb(0x13d)]],_0x637add=[_0x386856[_0x21effb(0x100)][_0x21effb(0x196)]],_0x207a52=[_0x386856[_0x21effb(0x100)][_0x21effb(0x17c)]],_0x44be31=[_0x386856[_0x21effb(0x100)][_0x21effb(0x172)]],_0x26912b=[_0x386856[_0x21effb(0x100)][_0x21effb(0xfa)]],_0x113327=[_0x386856[_0x21effb(0x100)]['secondary_code']],_0x79b21e=[_0x386856['body'][_0x21effb(0x12b)]],_0x373d13=[_0x386856[_0x21effb(0x100)][_0x21effb(0x147)]],_0x4f47ac=[_0x386856[_0x21effb(0x100)][_0x21effb(0xe0)]],_0x552fda=[_0x386856[_0x21effb(0x100)][_0x21effb(0x18d)]],_0x6b3f4f=[_0x386856[_0x21effb(0x100)][_0x21effb(0x165)]],_0x430db1=[_0x386856[_0x21effb(0x100)][_0x21effb(0xeb)]],_0x372516=[_0x386856['body'][_0x21effb(0xf8)]],_0x20fe63=[_0x386856['body'][_0x21effb(0x130)]],_0x2232e2=[_0x386856[_0x21effb(0x100)][_0x21effb(0x177)]],_0x2d2a4d=[_0x386856[_0x21effb(0x100)][_0x21effb(0x138)]],_0x570447=[_0x386856[_0x21effb(0x100)]['RoomAssigned']],_0x24eec2=[_0x386856[_0x21effb(0x100)]['ToRoomAssigned']],_0x1193a3=[_0x386856[_0x21effb(0x100)][_0x21effb(0x10a)]],_0x2bdbb7=[_0x386856[_0x21effb(0x100)]['id_transaction']];else var _0x8951a3=[..._0x386856[_0x21effb(0x100)]['prod_name']],_0x22cf35=[..._0x386856['body']['from_prod_qty']],_0x637add=[..._0x386856['body'][_0x21effb(0x196)]],_0x207a52=[..._0x386856[_0x21effb(0x100)][_0x21effb(0x17c)]],_0x44be31=[..._0x386856[_0x21effb(0x100)]['to_prod_level']],_0x26912b=[..._0x386856[_0x21effb(0x100)][_0x21effb(0xfa)]],_0x113327=[..._0x386856['body'][_0x21effb(0xdb)]],_0x79b21e=[..._0x386856['body']['product_code3']],_0x373d13=[..._0x386856[_0x21effb(0x100)]['MaxStocks_data2']],_0x4f47ac=[..._0x386856[_0x21effb(0x100)][_0x21effb(0xe0)]],_0x552fda=[..._0x386856[_0x21effb(0x100)]['secondary_unit']],_0x6b3f4f=[..._0x386856['body']['batch_code']],_0x430db1=[..._0x386856[_0x21effb(0x100)]['expiry_date']],_0x372516=[..._0x386856[_0x21effb(0x100)][_0x21effb(0xf8)]],_0x20fe63=[..._0x386856[_0x21effb(0x100)]['MaxStocks_data']],_0x2232e2=[..._0x386856[_0x21effb(0x100)][_0x21effb(0x177)]],_0x2d2a4d=[..._0x386856[_0x21effb(0x100)][_0x21effb(0x138)]],_0x570447=[..._0x386856[_0x21effb(0x100)][_0x21effb(0x123)]],_0x24eec2=[..._0x386856[_0x21effb(0x100)][_0x21effb(0x14b)]],_0x1193a3=[..._0x386856['body'][_0x21effb(0x10a)]],_0x2bdbb7=[..._0x386856[_0x21effb(0x100)]['id_transaction']];const _0x16de69=_0x8951a3['map'](_0x29a3fb=>{return _0x29a3fb={'product_name':_0x29a3fb};});_0x22cf35[_0x21effb(0xde)]((_0x1e0e8a,_0x22edfd)=>{var _0x132fc5=_0x21effb;_0x16de69[_0x22edfd][_0x132fc5(0x13a)]=_0x1e0e8a;}),_0x637add[_0x21effb(0xde)]((_0x6f173b,_0x246ed4)=>{var _0x37054d=_0x21effb,_0x521179=_0x6f173b['match'](/[A-Za-z]+/)[0x0],_0x156a9f=parseInt(_0x6f173b[_0x37054d(0x12e)](/\d+/)[0x0]);_0x16de69[_0x246ed4][_0x37054d(0x173)]=_0x156a9f,_0x16de69[_0x246ed4][_0x37054d(0x13f)]=_0x521179;}),_0x2bdbb7['forEach']((_0x419e3f,_0x988cd7)=>{var _0x468b59=_0x21effb;_0x16de69[_0x988cd7][_0x468b59(0x10f)]=_0x419e3f;}),_0x1193a3[_0x21effb(0xde)]((_0x3cebeb,_0x20eda6)=>{var _0x55c57b=_0x21effb;_0x16de69[_0x20eda6][_0x55c57b(0x10a)]=_0x3cebeb;}),_0x207a52[_0x21effb(0xde)]((_0x18375b,_0x2f0b25)=>{_0x16de69[_0x2f0b25]['to_quantity']=_0x18375b;}),_0x44be31[_0x21effb(0xde)]((_0x1cf7d2,_0x299ce5)=>{var _0x5440ea=_0x21effb,_0x3065ab=_0x1cf7d2[_0x5440ea(0x12e)](/[A-Za-z]+/)[0x0],_0x449281=parseInt(_0x1cf7d2[_0x5440ea(0x12e)](/\d+/)[0x0]);_0x16de69[_0x299ce5][_0x5440ea(0x12d)]=_0x3065ab,_0x16de69[_0x299ce5][_0x5440ea(0xd6)]=_0x449281;}),_0x26912b['forEach']((_0x50a56c,_0x34c2f0)=>{var _0xc145a2=_0x21effb;_0x16de69[_0x34c2f0][_0xc145a2(0xfa)]=_0x50a56c;}),_0x113327['forEach']((_0x5ca83e,_0x23337f)=>{var _0x24bd5e=_0x21effb;_0x16de69[_0x23337f][_0x24bd5e(0xdb)]=_0x5ca83e;}),_0x79b21e['forEach']((_0x159b66,_0x2a8a09)=>{var _0x391b88=_0x21effb;_0x16de69[_0x2a8a09][_0x391b88(0x144)]=_0x159b66;}),_0x373d13[_0x21effb(0xde)]((_0x54af33,_0x399a65)=>{_0x16de69[_0x399a65]['maxProducts']=_0x54af33;}),_0x4f47ac[_0x21effb(0xde)]((_0x31202f,_0x690b01)=>{_0x16de69[_0x690b01]['unit']=_0x31202f;}),_0x552fda[_0x21effb(0xde)]((_0x1bd791,_0x5d62e7)=>{var _0x365605=_0x21effb;_0x16de69[_0x5d62e7][_0x365605(0x18d)]=_0x1bd791;}),_0x6b3f4f[_0x21effb(0xde)]((_0x27abff,_0x3d7baf)=>{var _0x820e48=_0x21effb;_0x16de69[_0x3d7baf][_0x820e48(0x165)]=_0x27abff;}),_0x430db1[_0x21effb(0xde)]((_0xe0fb7f,_0x1b0a92)=>{var _0x3f59dd=_0x21effb;_0x16de69[_0x1b0a92][_0x3f59dd(0xeb)]=_0xe0fb7f;}),_0x372516['forEach']((_0x4fd2ec,_0x1d5b4d)=>{var _0x5f4ebc=_0x21effb;_0x16de69[_0x1d5b4d][_0x5f4ebc(0xed)]=_0x4fd2ec;}),_0x20fe63[_0x21effb(0xde)]((_0x599810,_0xc97bae)=>{var _0x4c4649=_0x21effb;_0x16de69[_0xc97bae][_0x4c4649(0x116)]=_0x599810;}),_0x2232e2['forEach']((_0x5c65d2,_0x1a0841)=>{var _0x215a4c=_0x21effb;_0x16de69[_0x1a0841][_0x215a4c(0x177)]=_0x5c65d2;}),_0x2d2a4d['forEach']((_0x12cec2,_0x4c1e77)=>{var _0x1d36b4=_0x21effb;_0x16de69[_0x4c1e77][_0x1d36b4(0x138)]=_0x12cec2;}),_0x570447['forEach']((_0x3db995,_0x2046f8)=>{var _0x1917d3=_0x21effb;_0x16de69[_0x2046f8][_0x1917d3(0x17d)]=_0x3db995;}),_0x24eec2['forEach']((_0x4281bf,_0xef6032)=>{var _0x5849fe=_0x21effb;_0x16de69[_0xef6032][_0x5849fe(0xe7)]=_0x4281bf;});const _0x3f3d3b=_0x16de69[_0x21effb(0x19a)](_0x37d77c=>_0x37d77c['to_quantity']!=='0'&&_0x37d77c[_0x21effb(0xf4)]!==''||_0x37d77c[_0x21effb(0x139)]!=='0'&&_0x37d77c[_0x21effb(0x139)]!=='');var _0x3fd5ef=0x0;_0x3f3d3b[_0x21effb(0xde)](_0x5dd45b=>{var _0x54a696=_0x21effb;parseInt(_0x5dd45b[_0x54a696(0x13a)])<parseInt(_0x5dd45b[_0x54a696(0xf4)])&&_0x3fd5ef++;});if(_0x3fd5ef!=0x0)return _0x386856[_0x21effb(0x12f)](_0x21effb(0x17a),_0x21effb(0x114)),_0x26af45[_0x21effb(0x166)](_0x21effb(0xd8));const _0x365d11=new transfers_logs();await _0x365d11[_0x21effb(0x148)]();for(let _0x26c3ef=0x0;_0x26c3ef<=_0x24eec2[_0x21effb(0x10e)]-0x1;_0x26c3ef++){_0x16de69[_0x26c3ef][_0x21effb(0x107)]=_0x21effb(0x19f)+_0x365d11[_0x21effb(0x19d)][_0x21effb(0x132)]()[_0x21effb(0xf7)](0x8,'0');}const _0x27775c=new transfers_finished({'date':_0x2f1846,'from_warehouse':_0x357e45,'to_warehouse':_0x357e45,'product':_0x3f3d3b,'note':_0x2c397b,'invoice':'LOG-TRF-'+_0x365d11[_0x21effb(0x19d)]['toString']()[_0x21effb(0xf7)](0x8,'0'),'type_of_process':_0x21effb(0xf5),'type_of_transaction':_0x21effb(0x152),'PO_number':_0x3bdbe5,'RequestedBy':_0x50fe94,'DateofRequest':_0x2f55ab,'typeservices':_0x3b1166,'destination':_0x1cfda9,'deliverydate':_0x5f464e,'driver':_0x44fd0e,'plate':_0x1be970,'van':_0x318f94,'DRSI':_0x320e5b,'typevehicle':_0x4704f2,'TSU':_0x4088a0,'TFU':_0x38f82c}),_0x36b39d=await _0x27775c[_0x21effb(0x148)]();_0x386856['flash'](_0x21effb(0x128),'Product\x20Transfer\x20successfully'),_0x26af45['redirect']('/transfer_finished/preview/'+_0x36b39d[_0x21effb(0x131)]);}catch(_0x4b40de){console['log'](_0x4b40de),_0x26af45['status'](0xc8)['json']({'errorMessage':_0x4b40de[_0x21effb(0x13c)]});}}),router['post'](a0_0x518cae(0x187),auth,async(_0x2aec40,_0x2e5fb6)=>{var _0x717977=a0_0x518cae;try{const {date:_0x51aafb,from_warehouse:_0x12b68d,FromRoom_name:_0x42c024,to_warehouse:_0x28081b,ToRoom_name:_0x3f6607,prod_name:_0x1f26e1,from_prod_qty:_0x3bcccc,from_prod_level:_0x29728a,from_prod_isle:_0x28a681,from_prod_pallet:_0x4aa920,to_prod_qty:_0x26ebb4,to_prod_level:_0x55a412,to_prod_isle:_0x18005e,to_prod_pallet:_0xd13614,primary_code:_0x52039c,secondary_code:_0x19cf5e,product_code3:_0x46a874,note:_0x5b6069,MaxStocks_data2:_0x16379a,invoice:_0x1346d8,expiry_date:_0x3eba4d,PO_number_loc:_0xe96c1a,ReqBy_loc:_0x56f2f8,dateofreq_loc:_0x26764a,typeservices_loc_Data:_0x3cc3e8,destination_loc:_0x396a57,deliverydate_loc:_0x1251b9,driver_loc:_0x27463e,plate_loc:_0x21bff8,van_loc:_0x2197c7,DRSI_loc:_0xe95895,typevehicle_loc:_0x33eacd,TSU_loc:_0x507371,TFU_loc:_0xc7c2f8}=_0x2aec40[_0x717977(0x100)];if(typeof _0x1f26e1==_0x717977(0xfc))var _0x3dc203=[_0x2aec40[_0x717977(0x100)][_0x717977(0x155)]],_0x598d91=[_0x2aec40[_0x717977(0x100)][_0x717977(0x13d)]],_0x1d67c8=[_0x2aec40[_0x717977(0x100)][_0x717977(0x196)]],_0x5d7522=[_0x2aec40[_0x717977(0x100)][_0x717977(0x17c)]],_0xdd0af1=[_0x2aec40[_0x717977(0x100)][_0x717977(0x172)]],_0x34b8eb=[_0x2aec40['body'][_0x717977(0xfa)]],_0x2a932d=[_0x2aec40[_0x717977(0x100)][_0x717977(0xdb)]],_0x1d8844=[_0x2aec40[_0x717977(0x100)][_0x717977(0x12b)]],_0x3206d1=[_0x2aec40['body'][_0x717977(0x147)]],_0x1e77f9=[_0x2aec40[_0x717977(0x100)][_0x717977(0xe0)]],_0x470f64=[_0x2aec40[_0x717977(0x100)][_0x717977(0x18d)]],_0x25bef4=[_0x2aec40['body'][_0x717977(0x165)]],_0x1b6102=[_0x2aec40[_0x717977(0x100)]['expiry_date']],_0x152aa1=[_0x2aec40[_0x717977(0x100)][_0x717977(0xf8)]],_0xb8510f=[_0x2aec40[_0x717977(0x100)][_0x717977(0x130)]],_0x520bbd=[_0x2aec40[_0x717977(0x100)][_0x717977(0x177)]],_0x36ae8a=[_0x2aec40[_0x717977(0x100)][_0x717977(0x138)]],_0x2fea0a=[_0x2aec40[_0x717977(0x100)][_0x717977(0x123)]],_0x27ad95=[_0x2aec40['body'][_0x717977(0x14b)]],_0x44d3aa=[_0x2aec40['body'][_0x717977(0x10a)]],_0x59ec40=[_0x2aec40[_0x717977(0x100)][_0x717977(0x10f)]];else var _0x3dc203=[..._0x2aec40[_0x717977(0x100)]['prod_name']],_0x598d91=[..._0x2aec40[_0x717977(0x100)][_0x717977(0x13d)]],_0x1d67c8=[..._0x2aec40[_0x717977(0x100)]['from_prod_level2']],_0x5d7522=[..._0x2aec40['body'][_0x717977(0x17c)]],_0xdd0af1=[..._0x2aec40[_0x717977(0x100)][_0x717977(0x172)]],_0x34b8eb=[..._0x2aec40[_0x717977(0x100)][_0x717977(0xfa)]],_0x2a932d=[..._0x2aec40['body'][_0x717977(0xdb)]],_0x1d8844=[..._0x2aec40[_0x717977(0x100)][_0x717977(0x12b)]],_0x3206d1=[..._0x2aec40[_0x717977(0x100)][_0x717977(0x147)]],_0x1e77f9=[..._0x2aec40[_0x717977(0x100)][_0x717977(0xe0)]],_0x470f64=[..._0x2aec40['body']['secondary_unit']],_0x25bef4=[..._0x2aec40['body'][_0x717977(0x165)]],_0x1b6102=[..._0x2aec40[_0x717977(0x100)][_0x717977(0xeb)]],_0x152aa1=[..._0x2aec40[_0x717977(0x100)]['product_date']],_0xb8510f=[..._0x2aec40[_0x717977(0x100)][_0x717977(0x130)]],_0x520bbd=[..._0x2aec40[_0x717977(0x100)][_0x717977(0x177)]],_0x36ae8a=[..._0x2aec40[_0x717977(0x100)]['prod_cat']],_0x2fea0a=[..._0x2aec40[_0x717977(0x100)]['RoomAssigned']],_0x27ad95=[..._0x2aec40[_0x717977(0x100)][_0x717977(0x14b)]],_0x44d3aa=[..._0x2aec40[_0x717977(0x100)]['from_invoice']],_0x59ec40=[..._0x2aec40[_0x717977(0x100)]['id_transaction']];const _0x223d02=_0x3dc203[_0x717977(0xe5)](_0x1ce4d5=>{return _0x1ce4d5={'product_name':_0x1ce4d5};});_0x598d91[_0x717977(0xde)]((_0x489903,_0x37a60c)=>{var _0x5d1613=_0x717977;_0x223d02[_0x37a60c][_0x5d1613(0x13a)]=_0x489903;}),_0x1d67c8[_0x717977(0xde)]((_0x4e233e,_0xade5fd)=>{var _0x260cd2=_0x717977,_0xcd0a5f=_0x4e233e[_0x260cd2(0x12e)](/[A-Za-z]+/)[0x0],_0x312fbe=parseInt(_0x4e233e[_0x260cd2(0x12e)](/\d+/)[0x0]);_0x223d02[_0xade5fd][_0x260cd2(0x173)]=_0x312fbe,_0x223d02[_0xade5fd][_0x260cd2(0x13f)]=_0xcd0a5f;}),_0x59ec40[_0x717977(0xde)]((_0x3aa0fd,_0x16a788)=>{var _0x2014dc=_0x717977;_0x223d02[_0x16a788][_0x2014dc(0x10f)]=_0x3aa0fd;}),_0x44d3aa[_0x717977(0xde)]((_0xb4b6cb,_0x37378a)=>{var _0x464158=_0x717977;_0x223d02[_0x37378a][_0x464158(0x10a)]=_0xb4b6cb;}),_0x5d7522[_0x717977(0xde)]((_0x3dfed1,_0x50f69d)=>{var _0x146497=_0x717977;_0x223d02[_0x50f69d][_0x146497(0xf4)]=_0x3dfed1;}),_0xdd0af1[_0x717977(0xde)]((_0x320bdd,_0x118f27)=>{var _0x14f276=_0x717977,_0x2ec5c5=_0x320bdd['match'](/[A-Za-z]+/)[0x0],_0x1a65a9=parseInt(_0x320bdd[_0x14f276(0x12e)](/\d+/)[0x0]);_0x223d02[_0x118f27][_0x14f276(0x12d)]=_0x2ec5c5,_0x223d02[_0x118f27]['to_bay']=_0x1a65a9;}),_0x34b8eb[_0x717977(0xde)]((_0x2bc086,_0x3e4973)=>{_0x223d02[_0x3e4973]['primary_code']=_0x2bc086;}),_0x2a932d[_0x717977(0xde)]((_0x4b1f2f,_0x19e2f4)=>{var _0x1ed353=_0x717977;_0x223d02[_0x19e2f4][_0x1ed353(0xdb)]=_0x4b1f2f;}),_0x1d8844[_0x717977(0xde)]((_0x229c02,_0x1306c1)=>{var _0x139392=_0x717977;_0x223d02[_0x1306c1][_0x139392(0x144)]=_0x229c02;}),_0x3206d1[_0x717977(0xde)]((_0x1f735c,_0x1f4fc1)=>{var _0x1f83c9=_0x717977;_0x223d02[_0x1f4fc1][_0x1f83c9(0x116)]=_0x1f735c;}),_0x1e77f9[_0x717977(0xde)]((_0x5b6116,_0x4aca8e)=>{var _0x5088af=_0x717977;_0x223d02[_0x4aca8e][_0x5088af(0x197)]=_0x5b6116;}),_0x470f64[_0x717977(0xde)]((_0x4d7dd1,_0xfc8bd9)=>{var _0x31d256=_0x717977;_0x223d02[_0xfc8bd9][_0x31d256(0x18d)]=_0x4d7dd1;}),_0x25bef4[_0x717977(0xde)]((_0xbd4142,_0x47416b)=>{var _0x2161e0=_0x717977;_0x223d02[_0x47416b][_0x2161e0(0x165)]=_0xbd4142;}),_0x1b6102[_0x717977(0xde)]((_0x333573,_0x516b7b)=>{var _0x1b2140=_0x717977;_0x223d02[_0x516b7b][_0x1b2140(0xeb)]=_0x333573;}),_0x152aa1['forEach']((_0x37b6b1,_0x54263f)=>{var _0x3941bb=_0x717977;_0x223d02[_0x54263f][_0x3941bb(0xed)]=_0x37b6b1;}),_0xb8510f[_0x717977(0xde)]((_0x2663da,_0x15367f)=>{var _0x1d7582=_0x717977;_0x223d02[_0x15367f][_0x1d7582(0x116)]=_0x2663da;}),_0x520bbd[_0x717977(0xde)]((_0x1d1b46,_0x4793f2)=>{var _0x2ea704=_0x717977;_0x223d02[_0x4793f2][_0x2ea704(0x177)]=_0x1d1b46;}),_0x36ae8a[_0x717977(0xde)]((_0x5f250e,_0x19de89)=>{var _0x4a5411=_0x717977;_0x223d02[_0x19de89][_0x4a5411(0x138)]=_0x5f250e;}),_0x2fea0a[_0x717977(0xde)]((_0x21ccbc,_0x2b1d28)=>{var _0x1963b3=_0x717977;_0x223d02[_0x2b1d28][_0x1963b3(0x17d)]=_0x21ccbc;}),_0x27ad95[_0x717977(0xde)]((_0x5392c6,_0x17fcd0)=>{var _0x1aeb87=_0x717977;_0x223d02[_0x17fcd0][_0x1aeb87(0xe7)]=_0x5392c6;});const _0x1e4fc4=_0x223d02['filter'](_0xae45b3=>_0xae45b3['to_quantity']!=='0'&&_0xae45b3[_0x717977(0xf4)]!==''||_0xae45b3['to_floorlevel']!=='0'&&_0xae45b3[_0x717977(0x139)]!=='');var _0x1db915=0x0;_0x1e4fc4['forEach'](_0x24f34d=>{var _0x5c71b6=_0x717977;parseInt(_0x24f34d[_0x5c71b6(0x13a)])<parseInt(_0x24f34d[_0x5c71b6(0xf4)])&&_0x1db915++;});if(_0x1db915!=0x0)return _0x2aec40[_0x717977(0x12f)](_0x717977(0x17a),_0x717977(0x114)),_0x2e5fb6[_0x717977(0x166)](_0x717977(0xd8));const _0x1a1b03=new transfers_logs();await _0x1a1b03['save']();for(let _0x428828=0x0;_0x428828<=_0x27ad95[_0x717977(0x10e)]-0x1;_0x428828++){_0x223d02[_0x428828][_0x717977(0x107)]=_0x717977(0x19f)+_0x1a1b03[_0x717977(0x19d)][_0x717977(0x132)]()['padStart'](0x8,'0');}const _0x31b943=new transfers_finished({'date':_0x51aafb,'from_warehouse':_0x12b68d,'to_warehouse':_0x28081b,'product':_0x1e4fc4,'note':_0x5b6069,'invoice':_0x717977(0x19f)+_0x1a1b03[_0x717977(0x19d)]['toString']()[_0x717977(0xf7)](0x8,'0'),'type_of_transaction':_0x717977(0x152),'type_of_process':_0x717977(0x160),'PO_number':_0xe96c1a,'RequestedBy':_0x56f2f8,'DateofRequest':_0x26764a,'typeservices':_0x3cc3e8,'destination':_0x396a57,'deliverydate':_0x1251b9,'driver':_0x27463e,'plate':_0x21bff8,'van':_0x2197c7,'DRSI':_0xe95895,'typevehicle':_0x33eacd,'TSU':_0x507371,'TFU':_0xc7c2f8}),_0x1efcfc=await _0x31b943[_0x717977(0x148)]();_0x2aec40[_0x717977(0x12f)](_0x717977(0x128),_0x717977(0x136)),_0x2e5fb6[_0x717977(0x166)](_0x717977(0x142)+_0x1efcfc[_0x717977(0x131)]);}catch(_0x4e6746){console['log'](_0x4e6746),_0x2e5fb6[_0x717977(0x186)](0xc8)[_0x717977(0x121)]({'errorMessage':_0x4e6746[_0x717977(0x13c)]});}}),router['post'](a0_0x518cae(0x129),auth,async(_0x336256,_0x51ab60)=>{var _0x13b3c5=a0_0x518cae;try{const {date:_0x38e64b,from_warehouse:_0x15fad5,FromRoom_name:_0x187466,to_warehouse:_0x43e2b7,ToRoom_name:_0x15411f,prod_name:_0xbaf710,from_prod_qty:_0x3657cc,from_prod_level:_0x1b57ff,from_prod_isle:_0x491c08,from_prod_pallet:_0x326f6f,to_prod_qty:_0x995ee9,to_prod_level:_0x1a7b39,to_prod_isle:_0x236197,to_prod_pallet:_0x4c8d9f,primary_code:_0x1179fa,secondary_code:_0x346543,product_code3:_0x3a8655,note:_0x386ada,MaxStocks_data2:_0xc8626,invoice:_0x44ecf2,expiry_date:_0x2683ac,PO_number:_0x2ab4bd,ReqBy:_0xae7185,dateofreq:_0x162832,typeservicesData:_0x16e3df,destination:_0x3e77e3,deliverydate:_0x6ea588,driver:_0x1a90b4,plate:_0x28c8e5,van:_0x2959ae,DRSI:_0x279c0b,typevehicle:_0x43799c,TSU:_0x7436eb,TFU:_0x5de099}=_0x336256[_0x13b3c5(0x100)];if(typeof _0xbaf710==_0x13b3c5(0xfc))var _0x1e4457=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x155)]],_0x6db2a9=[_0x336256[_0x13b3c5(0x100)]['from_prod_qty']],_0x304102=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x196)]],_0x55a7a5=[_0x336256['body'][_0x13b3c5(0x17c)]],_0xed0656=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x172)]],_0x2d8250=[_0x336256['body'][_0x13b3c5(0xfa)]],_0x3a3a04=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0xdb)]],_0x3b07f2=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x12b)]],_0x4c3378=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x147)]],_0x70bd7c=[_0x336256['body'][_0x13b3c5(0xe0)]],_0x7c50da=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x18d)]],_0x5248eb=[_0x336256['body'][_0x13b3c5(0x165)]],_0x362805=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0xeb)]],_0x55e998=[_0x336256['body'][_0x13b3c5(0xf8)]],_0x55c943=[_0x336256['body'][_0x13b3c5(0x130)]],_0xdb02ea=[_0x336256['body'][_0x13b3c5(0x177)]],_0x39fe77=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x138)]],_0x215776=[_0x336256['body']['RoomAssigned']],_0xa41fd7=[_0x336256[_0x13b3c5(0x100)]['ToRoomAssigned']],_0x1c6c51=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x10a)]],_0x212181=[_0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x10f)]];else var _0x1e4457=[..._0x336256[_0x13b3c5(0x100)]['prod_name']],_0x6db2a9=[..._0x336256[_0x13b3c5(0x100)]['from_prod_qty']],_0x304102=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x196)]],_0x55a7a5=[..._0x336256['body'][_0x13b3c5(0x17c)]],_0xed0656=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x172)]],_0x2d8250=[..._0x336256['body'][_0x13b3c5(0xfa)]],_0x3a3a04=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0xdb)]],_0x3b07f2=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x12b)]],_0x4c3378=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x147)]],_0x70bd7c=[..._0x336256[_0x13b3c5(0x100)]['primary_unit']],_0x7c50da=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x18d)]],_0x5248eb=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x165)]],_0x362805=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0xeb)]],_0x55e998=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0xf8)]],_0x55c943=[..._0x336256['body']['MaxStocks_data']],_0xdb02ea=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x177)]],_0x39fe77=[..._0x336256[_0x13b3c5(0x100)]['prod_cat']],_0x215776=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x123)]],_0xa41fd7=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x14b)]],_0x1c6c51=[..._0x336256['body'][_0x13b3c5(0x10a)]],_0x212181=[..._0x336256[_0x13b3c5(0x100)][_0x13b3c5(0x10f)]];const _0x27a5cc=_0x1e4457[_0x13b3c5(0xe5)](_0x7d1a93=>{return _0x7d1a93={'product_name':_0x7d1a93};});_0x6db2a9[_0x13b3c5(0xde)]((_0x3c3fd0,_0x443454)=>{_0x27a5cc[_0x443454]['from_quantity']=_0x3c3fd0;}),_0x304102['forEach']((_0x498c73,_0x317271)=>{var _0x2dff94=_0x13b3c5,_0x2e7638=_0x498c73[_0x2dff94(0x12e)](/[A-Za-z]+/)[0x0],_0x4f5ed7=parseInt(_0x498c73['match'](/\d+/)[0x0]);_0x27a5cc[_0x317271]['from_bay']=_0x4f5ed7,_0x27a5cc[_0x317271][_0x2dff94(0x13f)]=_0x2e7638;}),_0x212181[_0x13b3c5(0xde)]((_0x4cac41,_0x1b3b9d)=>{var _0x59f740=_0x13b3c5;_0x27a5cc[_0x1b3b9d][_0x59f740(0x10f)]=_0x4cac41;}),_0x1c6c51[_0x13b3c5(0xde)]((_0x53948d,_0x47a99b)=>{var _0x59cc61=_0x13b3c5;_0x27a5cc[_0x47a99b][_0x59cc61(0x10a)]=_0x53948d;}),_0x55a7a5['forEach']((_0x58b05d,_0x35392b)=>{var _0x199a62=_0x13b3c5;_0x27a5cc[_0x35392b][_0x199a62(0xf4)]=_0x58b05d;}),_0xed0656[_0x13b3c5(0xde)]((_0x42296b,_0x1692a4)=>{var _0x3f4bf0=_0x13b3c5,_0x5d9d96=_0x42296b[_0x3f4bf0(0x12e)](/[A-Za-z]+/)[0x0],_0x15009e=parseInt(_0x42296b[_0x3f4bf0(0x12e)](/\d+/)[0x0]);_0x27a5cc[_0x1692a4][_0x3f4bf0(0x12d)]=_0x5d9d96,_0x27a5cc[_0x1692a4][_0x3f4bf0(0xd6)]=_0x15009e;}),_0x2d8250[_0x13b3c5(0xde)]((_0xe62d71,_0x4c9b6c)=>{_0x27a5cc[_0x4c9b6c]['primary_code']=_0xe62d71;}),_0x3a3a04['forEach']((_0x96d0eb,_0x1499e5)=>{var _0x26bb01=_0x13b3c5;_0x27a5cc[_0x1499e5][_0x26bb01(0xdb)]=_0x96d0eb;}),_0x3b07f2[_0x13b3c5(0xde)]((_0x2c1442,_0x3ead41)=>{var _0x44e97a=_0x13b3c5;_0x27a5cc[_0x3ead41][_0x44e97a(0x144)]=_0x2c1442;}),_0x4c3378['forEach']((_0x41823d,_0x3e9708)=>{var _0x24f790=_0x13b3c5;_0x27a5cc[_0x3e9708][_0x24f790(0x116)]=_0x41823d;}),_0x70bd7c[_0x13b3c5(0xde)]((_0x1d4992,_0x4c662b)=>{var _0x211ad0=_0x13b3c5;_0x27a5cc[_0x4c662b][_0x211ad0(0x197)]=_0x1d4992;}),_0x7c50da['forEach']((_0x226e2d,_0x5d536d)=>{var _0x49251e=_0x13b3c5;_0x27a5cc[_0x5d536d][_0x49251e(0x18d)]=_0x226e2d;}),_0x5248eb[_0x13b3c5(0xde)]((_0x117303,_0x263867)=>{var _0x5b6c0c=_0x13b3c5;_0x27a5cc[_0x263867][_0x5b6c0c(0x165)]=_0x117303;}),_0x362805[_0x13b3c5(0xde)]((_0x2a24d0,_0x2cfd93)=>{var _0x53e24f=_0x13b3c5;_0x27a5cc[_0x2cfd93][_0x53e24f(0xeb)]=_0x2a24d0;}),_0x55e998[_0x13b3c5(0xde)]((_0x502927,_0x4155a1)=>{var _0x350df8=_0x13b3c5;_0x27a5cc[_0x4155a1][_0x350df8(0xed)]=_0x502927;}),_0x55c943[_0x13b3c5(0xde)]((_0x220526,_0x5e139d)=>{var _0xe998f3=_0x13b3c5;_0x27a5cc[_0x5e139d][_0xe998f3(0x116)]=_0x220526;}),_0xdb02ea[_0x13b3c5(0xde)]((_0xea2254,_0x37ee64)=>{_0x27a5cc[_0x37ee64]['maxPerUnit']=_0xea2254;}),_0x39fe77['forEach']((_0x15728a,_0x4448c2)=>{var _0x3d9b11=_0x13b3c5;_0x27a5cc[_0x4448c2][_0x3d9b11(0x138)]=_0x15728a;}),_0x215776[_0x13b3c5(0xde)]((_0x425c57,_0x510f2c)=>{var _0x51c797=_0x13b3c5;_0x27a5cc[_0x510f2c][_0x51c797(0x17d)]=_0x425c57;}),_0xa41fd7[_0x13b3c5(0xde)]((_0x4a8d08,_0x32af5d)=>{var _0x1ed892=_0x13b3c5;_0x27a5cc[_0x32af5d][_0x1ed892(0xe7)]=_0x4a8d08;});const _0x1f038d=_0x27a5cc[_0x13b3c5(0x19a)](_0xf31d41=>_0xf31d41[_0x13b3c5(0xf4)]!=='0'&&_0xf31d41[_0x13b3c5(0xf4)]!==''||_0xf31d41[_0x13b3c5(0x139)]!=='0'&&_0xf31d41[_0x13b3c5(0x139)]!=='');var _0x4691d6=0x0;_0x1f038d[_0x13b3c5(0xde)](_0x3763bc=>{var _0x1501a0=_0x13b3c5;parseInt(_0x3763bc['from_quantity'])<parseInt(_0x3763bc[_0x1501a0(0xf4)])&&_0x4691d6++;});if(_0x4691d6!=0x0)return _0x336256[_0x13b3c5(0x12f)](_0x13b3c5(0x17a),_0x13b3c5(0x114)),_0x51ab60[_0x13b3c5(0x166)](_0x13b3c5(0xd8));const _0x329acc=new invoice_for_transfer();await _0x329acc[_0x13b3c5(0x148)]();for(let _0x258374=0x0;_0x258374<=_0xa41fd7[_0x13b3c5(0x10e)]-0x1;_0x258374++){_0x27a5cc[_0x258374][_0x13b3c5(0x107)]=_0x13b3c5(0xf0)+_0x329acc[_0x13b3c5(0x19d)][_0x13b3c5(0x132)]()[_0x13b3c5(0xf7)](0x8,'0');}const _0x414125=new transfers_finished({'date':_0x38e64b,'from_warehouse':_0x15fad5,'to_warehouse':_0x15fad5,'product':_0x1f038d,'note':_0x386ada,'invoice':_0x13b3c5(0xf0)+_0x329acc[_0x13b3c5(0x19d)][_0x13b3c5(0x132)]()[_0x13b3c5(0xf7)](0x8,'0'),'type_of_process':_0x13b3c5(0xf5),'type_of_transaction':'own','PO_number':_0x2ab4bd,'RequestedBy':_0xae7185,'DateofRequest':_0x162832,'typeservices':_0x16e3df,'destination':_0x3e77e3,'deliverydate':_0x6ea588,'driver':_0x1a90b4,'plate':_0x28c8e5,'van':_0x2959ae,'DRSI':_0x279c0b,'typevehicle':_0x43799c,'TSU':_0x7436eb,'TFU':_0x5de099}),_0x1a2eb5=await _0x414125[_0x13b3c5(0x148)]();_0x336256['flash'](_0x13b3c5(0x128),_0x13b3c5(0x136)),_0x51ab60[_0x13b3c5(0x166)](_0x13b3c5(0x142)+_0x1a2eb5[_0x13b3c5(0x131)]);}catch(_0x50ad7b){console[_0x13b3c5(0x111)](_0x50ad7b),_0x51ab60[_0x13b3c5(0x186)](0xc8)[_0x13b3c5(0x121)]({'errorMessage':_0x50ad7b[_0x13b3c5(0x13c)]});}}),router[a0_0x518cae(0x15e)]('/view/add_transfer_loc',auth,async(_0x53e3d6,_0x495bc1)=>{var _0x4276fc=a0_0x518cae;try{const {date:_0x44ad2c,from_warehouse:_0x359de8,FromRoom_name:_0x14fc40,to_warehouse:_0x58cbce,ToRoom_name:_0x2397d9,prod_name:_0x4cf9d0,from_prod_qty:_0x528cd0,from_prod_level:_0x1cf243,from_prod_isle:_0x1a5ca,from_prod_pallet:_0x36c5fa,to_prod_qty:_0x3def62,to_prod_level:_0x29bbbf,to_prod_isle:_0x3eb84a,to_prod_pallet:_0xf50801,primary_code:_0x1b8e8d,secondary_code:_0x4fd28c,product_code3:_0x2623b6,note:_0x53e35f,MaxStocks_data2:_0x5e91c1,invoice:_0x360b8a,expiry_date:_0x517a6e,PO_number_loc:_0x23d782,ReqBy_loc:_0x1d3e20,dateofreq_loc:_0x484347,typeservices_loc_Data:_0x3fe45f,destination_loc:_0x3fd8e4,deliverydate_loc:_0x4ee42d,driver_loc:_0x32fddd,plate_loc:_0x45bf8c,van_loc:_0x123c04,DRSI_loc:_0x2509ac,typevehicle_loc:_0x287fb0,TSU_loc:_0x5027f5,TFU_loc:_0x1344d}=_0x53e3d6[_0x4276fc(0x100)];if(typeof _0x4cf9d0=='string')var _0x1498f1=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x155)]],_0x141e1a=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x13d)]],_0x59245f=[_0x53e3d6[_0x4276fc(0x100)]['from_prod_level2']],_0x1ea534=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x17c)]],_0x59ee68=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x172)]],_0x5a5654=[_0x53e3d6[_0x4276fc(0x100)]['primary_code']],_0x1d2150=[_0x53e3d6[_0x4276fc(0x100)]['secondary_code']],_0x35e80d=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x12b)]],_0x34b928=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x147)]],_0x257729=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0xe0)]],_0x1404c0=[_0x53e3d6[_0x4276fc(0x100)]['secondary_unit']],_0x619a2a=[_0x53e3d6[_0x4276fc(0x100)]['batch_code']],_0x30e634=[_0x53e3d6['body'][_0x4276fc(0xeb)]],_0x36452c=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0xf8)]],_0x258724=[_0x53e3d6[_0x4276fc(0x100)]['MaxStocks_data']],_0x2c8840=[_0x53e3d6['body'][_0x4276fc(0x177)]],_0x3f0aca=[_0x53e3d6['body'][_0x4276fc(0x138)]],_0x17df06=[_0x53e3d6['body'][_0x4276fc(0x123)]],_0x2185f8=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x14b)]],_0x1754bc=[_0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x10a)]],_0x268ef7=[_0x53e3d6[_0x4276fc(0x100)]['id_transaction']];else var _0x1498f1=[..._0x53e3d6[_0x4276fc(0x100)]['prod_name']],_0x141e1a=[..._0x53e3d6[_0x4276fc(0x100)]['from_prod_qty']],_0x59245f=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x196)]],_0x1ea534=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x17c)]],_0x59ee68=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x172)]],_0x5a5654=[..._0x53e3d6[_0x4276fc(0x100)]['primary_code']],_0x1d2150=[..._0x53e3d6[_0x4276fc(0x100)]['secondary_code']],_0x35e80d=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x12b)]],_0x34b928=[..._0x53e3d6['body']['MaxStocks_data2']],_0x257729=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0xe0)]],_0x1404c0=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x18d)]],_0x619a2a=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x165)]],_0x30e634=[..._0x53e3d6['body'][_0x4276fc(0xeb)]],_0x36452c=[..._0x53e3d6['body'][_0x4276fc(0xf8)]],_0x258724=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x130)]],_0x2c8840=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x177)]],_0x3f0aca=[..._0x53e3d6[_0x4276fc(0x100)]['prod_cat']],_0x17df06=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x123)]],_0x2185f8=[..._0x53e3d6[_0x4276fc(0x100)]['ToRoomAssigned']],_0x1754bc=[..._0x53e3d6[_0x4276fc(0x100)][_0x4276fc(0x10a)]],_0x268ef7=[..._0x53e3d6[_0x4276fc(0x100)]['id_transaction']];const _0x456d54=_0x1498f1[_0x4276fc(0xe5)](_0x403069=>{return _0x403069={'product_name':_0x403069};});_0x141e1a[_0x4276fc(0xde)]((_0x78e314,_0x5b2e55)=>{var _0x4009de=_0x4276fc;_0x456d54[_0x5b2e55][_0x4009de(0x13a)]=_0x78e314;}),_0x59245f[_0x4276fc(0xde)]((_0x5396e2,_0xbcd76a)=>{var _0x175f3c=_0x4276fc,_0x2f0cc3=_0x5396e2[_0x175f3c(0x12e)](/[A-Za-z]+/)[0x0],_0x42c3a3=parseInt(_0x5396e2['match'](/\d+/)[0x0]);_0x456d54[_0xbcd76a][_0x175f3c(0x173)]=_0x42c3a3,_0x456d54[_0xbcd76a]['from_level']=_0x2f0cc3;}),_0x268ef7['forEach']((_0x3354d1,_0x41f7ac)=>{var _0x437554=_0x4276fc;_0x456d54[_0x41f7ac][_0x437554(0x10f)]=_0x3354d1;}),_0x1754bc[_0x4276fc(0xde)]((_0x28f321,_0x5a32e3)=>{var _0x58675b=_0x4276fc;_0x456d54[_0x5a32e3][_0x58675b(0x10a)]=_0x28f321;}),_0x1ea534['forEach']((_0x570aad,_0x4b6966)=>{var _0x3cced6=_0x4276fc;_0x456d54[_0x4b6966][_0x3cced6(0xf4)]=_0x570aad;}),_0x59ee68[_0x4276fc(0xde)]((_0xb8e525,_0x4d0f50)=>{var _0x4d4912=_0x4276fc,_0x441ddc=_0xb8e525[_0x4d4912(0x12e)](/[A-Za-z]+/)[0x0],_0x54512e=parseInt(_0xb8e525[_0x4d4912(0x12e)](/\d+/)[0x0]);_0x456d54[_0x4d0f50][_0x4d4912(0x12d)]=_0x441ddc,_0x456d54[_0x4d0f50][_0x4d4912(0xd6)]=_0x54512e;}),_0x5a5654[_0x4276fc(0xde)]((_0x51b9a2,_0x54f61b)=>{var _0x5cc25f=_0x4276fc;_0x456d54[_0x54f61b][_0x5cc25f(0xfa)]=_0x51b9a2;}),_0x1d2150[_0x4276fc(0xde)]((_0x5d2983,_0x5820ed)=>{var _0x4a7abc=_0x4276fc;_0x456d54[_0x5820ed][_0x4a7abc(0xdb)]=_0x5d2983;}),_0x35e80d['forEach']((_0x4a1eb6,_0x38633b)=>{_0x456d54[_0x38633b]['product_code']=_0x4a1eb6;}),_0x34b928['forEach']((_0x5ae2cc,_0x1cc66c)=>{var _0x4d216c=_0x4276fc;_0x456d54[_0x1cc66c][_0x4d216c(0x116)]=_0x5ae2cc;}),_0x257729[_0x4276fc(0xde)]((_0x481187,_0x1e49ee)=>{_0x456d54[_0x1e49ee]['unit']=_0x481187;}),_0x1404c0[_0x4276fc(0xde)]((_0x22adc5,_0x5198ed)=>{_0x456d54[_0x5198ed]['secondary_unit']=_0x22adc5;}),_0x619a2a[_0x4276fc(0xde)]((_0x5782cc,_0x2ed257)=>{var _0x4900e3=_0x4276fc;_0x456d54[_0x2ed257][_0x4900e3(0x165)]=_0x5782cc;}),_0x30e634[_0x4276fc(0xde)]((_0x16a638,_0x1bcf7f)=>{var _0x5d1b2e=_0x4276fc;_0x456d54[_0x1bcf7f][_0x5d1b2e(0xeb)]=_0x16a638;}),_0x36452c[_0x4276fc(0xde)]((_0x5c8428,_0x4de444)=>{var _0x581909=_0x4276fc;_0x456d54[_0x4de444][_0x581909(0xed)]=_0x5c8428;}),_0x258724[_0x4276fc(0xde)]((_0x8a8fc1,_0x323518)=>{var _0x3b219f=_0x4276fc;_0x456d54[_0x323518][_0x3b219f(0x116)]=_0x8a8fc1;}),_0x2c8840[_0x4276fc(0xde)]((_0x89484,_0x349fb9)=>{var _0x4f711a=_0x4276fc;_0x456d54[_0x349fb9][_0x4f711a(0x177)]=_0x89484;}),_0x3f0aca['forEach']((_0x812e9d,_0x3c4b72)=>{_0x456d54[_0x3c4b72]['prod_cat']=_0x812e9d;}),_0x17df06[_0x4276fc(0xde)]((_0x14e7a2,_0x33818a)=>{_0x456d54[_0x33818a]['from_room_name']=_0x14e7a2;}),_0x2185f8[_0x4276fc(0xde)]((_0x27ff90,_0x243b0f)=>{var _0xef2eb4=_0x4276fc;_0x456d54[_0x243b0f][_0xef2eb4(0xe7)]=_0x27ff90;});const _0x489252=_0x456d54['filter'](_0x54d797=>_0x54d797['to_quantity']!=='0'&&_0x54d797[_0x4276fc(0xf4)]!==''||_0x54d797[_0x4276fc(0x139)]!=='0'&&_0x54d797[_0x4276fc(0x139)]!=='');var _0x56a4f2=0x0;_0x489252[_0x4276fc(0xde)](_0x1228f9=>{var _0x505b4d=_0x4276fc;parseInt(_0x1228f9[_0x505b4d(0x13a)])<parseInt(_0x1228f9[_0x505b4d(0xf4)])&&_0x56a4f2++;});if(_0x56a4f2!=0x0)return _0x53e3d6[_0x4276fc(0x12f)](_0x4276fc(0x17a),_0x4276fc(0x114)),_0x495bc1[_0x4276fc(0x166)](_0x4276fc(0xd8));const _0x2f9d80=new invoice_for_transfer();await _0x2f9d80[_0x4276fc(0x148)]();for(let _0x1e3c3d=0x0;_0x1e3c3d<=_0x2185f8['length']-0x1;_0x1e3c3d++){_0x456d54[_0x1e3c3d][_0x4276fc(0x107)]=_0x4276fc(0xf0)+_0x2f9d80[_0x4276fc(0x19d)][_0x4276fc(0x132)]()[_0x4276fc(0xf7)](0x8,'0');}const _0x542213=new transfers_finished({'date':_0x44ad2c,'from_warehouse':_0x359de8,'to_warehouse':_0x58cbce,'product':_0x489252,'note':_0x53e35f,'invoice':_0x4276fc(0xf0)+_0x2f9d80[_0x4276fc(0x19d)][_0x4276fc(0x132)]()['padStart'](0x8,'0'),'type_of_transaction':_0x4276fc(0x10b),'type_of_process':'location2location','PO_number':_0x23d782,'RequestedBy':_0x1d3e20,'DateofRequest':_0x484347,'typeservices':_0x3fe45f,'destination':_0x3fd8e4,'deliverydate':_0x4ee42d,'driver':_0x32fddd,'plate':_0x45bf8c,'van':_0x123c04,'DRSI':_0x2509ac,'typevehicle':_0x287fb0,'TSU':_0x5027f5,'TFU':_0x1344d}),_0x878742=await _0x542213[_0x4276fc(0x148)]();_0x53e3d6[_0x4276fc(0x12f)]('success',_0x4276fc(0x136)),_0x495bc1[_0x4276fc(0x166)](_0x4276fc(0x142)+_0x878742[_0x4276fc(0x131)]);}catch(_0x5419ee){console[_0x4276fc(0x111)](_0x5419ee),_0x495bc1[_0x4276fc(0x186)](0xc8)[_0x4276fc(0x121)]({'errorMessage':_0x5419ee[_0x4276fc(0x13c)]});}}),router['get'](a0_0x518cae(0xfb),auth,async(_0x25e2e6,_0x2dfee6)=>{var _0x6749f2=a0_0x518cae;try{const {username:_0xe511dd,email:_0x3b224a,role:_0x5cf75d}=_0x25e2e6[_0x6749f2(0x113)],_0x42b97f=_0x25e2e6[_0x6749f2(0x113)],_0xafc1c1=await profile[_0x6749f2(0xd0)]({'email':_0x42b97f[_0x6749f2(0x159)]}),_0x3d94ff=await master_shop[_0x6749f2(0x19b)](),_0x2c955d=await transfers_finished['findById'](_0x25e2e6[_0x6749f2(0xe4)]['id']);let _0x47fd9c;if(_0x42b97f[_0x6749f2(0x15f)]==_0x6749f2(0xda)){const _0x8d617c=await staff['findOne']({'email':_0x42b97f[_0x6749f2(0x159)]});_0x47fd9c=await warehouse[_0x6749f2(0x19b)]({'status':_0x6749f2(0x124),'name':_0x8d617c[_0x6749f2(0x151)],'warehouse_category':_0x6749f2(0xf1)});}else _0x47fd9c=await warehouse[_0x6749f2(0x19b)]({'status':_0x6749f2(0x124),'warehouse_category':_0x6749f2(0xf1)});const _0x73946c=await warehouse[_0x6749f2(0x101)]([{'$match':{'name':_0x2c955d['from_warehouse'],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x6749f2(0x14e)},{'$group':{'_id':_0x6749f2(0x154),'name':{'$first':_0x6749f2(0x115)},'product_stock':{'$first':_0x6749f2(0x133)},'bay':{'$first':_0x6749f2(0x106)},'bin':{'$first':_0x6749f2(0x109)},'type':{'$first':_0x6749f2(0x170)},'floorlevel':{'$first':_0x6749f2(0x157)},'primary_code':{'$first':_0x6749f2(0x10d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x6749f2(0x145)},'rack':{'$first':_0x6749f2(0x10c)},'expiry_date':{'$first':_0x6749f2(0x17e)},'production_date':{'$first':_0x6749f2(0x174)},'room':{'$first':_0x6749f2(0x19e)},'warehoue_name':{'$first':'$name'}}}]),_0x36b21d=await product[_0x6749f2(0x19b)]({});if(_0x3d94ff[0x0][_0x6749f2(0xe3)]==_0x6749f2(0x12c)){var _0x2c1ccc=users[_0x6749f2(0x150)];console['log'](_0x2c1ccc);}else{if(_0x3d94ff[0x0][_0x6749f2(0xe3)]=='Hindi')var _0x2c1ccc=users[_0x6749f2(0xea)];else{if(_0x3d94ff[0x0][_0x6749f2(0xe3)]==_0x6749f2(0x198))var _0x2c1ccc=users['German'];else{if(_0x3d94ff[0x0][_0x6749f2(0xe3)]==_0x6749f2(0x125))var _0x2c1ccc=users[_0x6749f2(0x125)];else{if(_0x3d94ff[0x0][_0x6749f2(0xe3)]==_0x6749f2(0x149))var _0x2c1ccc=users[_0x6749f2(0x149)];else{if(_0x3d94ff[0x0][_0x6749f2(0xe3)]=='Portuguese\x20(BR)')var _0x2c1ccc=users[_0x6749f2(0x192)];else{if(_0x3d94ff[0x0][_0x6749f2(0xe3)]==_0x6749f2(0x195))var _0x2c1ccc=users[_0x6749f2(0x195)];else{if(_0x3d94ff[0x0][_0x6749f2(0xe3)]==_0x6749f2(0x110))var _0x2c1ccc=users[_0x6749f2(0x18c)];}}}}}}}_0x2dfee6[_0x6749f2(0x11e)](_0x6749f2(0x153),{'success':_0x25e2e6['flash'](_0x6749f2(0x128)),'errors':_0x25e2e6[_0x6749f2(0x12f)]('errors'),'role':_0x42b97f,'profile':_0xafc1c1,'master_shop':_0x3d94ff,'warehouse':_0x47fd9c,'transfer':_0x2c955d,'stock':_0x73946c,'unit':_0x36b21d,'language':_0x2c1ccc});}catch(_0x4206db){console[_0x6749f2(0x111)](_0x4206db);}}),router['post'](a0_0x518cae(0xfb),auth,async(_0x3f8716,_0x44d934)=>{var _0x5b0803=a0_0x518cae;try{const {invoice:_0x1f8196,from_warehouse:_0x34ce3b,FromRoom_name:_0x52705a,to_warehouse:_0x57396e,ToRoom_name:_0x596f06}=_0x3f8716[_0x5b0803(0x100)],_0x370f6d=await transfers_finished[_0x5b0803(0xef)](_0x3f8716[_0x5b0803(0xe4)]['id']),_0x67ebbe=_0x370f6d[_0x5b0803(0x127)][_0x5b0803(0xe5)](async _0x424a38=>{var _0x1b24a2=_0x5b0803;if(_0x424a38[_0x1b24a2(0xf4)]>0x0){var _0x20e824=await warehouse['findOne']({'name':_0x34ce3b,'room':_0x424a38[_0x1b24a2(0x17d)]});const _0x8ae924=_0x20e824['product_details'][_0x1b24a2(0xe5)](_0x356641=>{var _0x925136=_0x1b24a2;_0x356641[_0x925136(0x131)]==_0x424a38[_0x925136(0x10f)]&&(_0x356641[_0x925136(0xd3)]=Math[_0x925136(0x167)](0x0,Math[_0x925136(0x163)](_0x356641['product_stock'])-Math[_0x925136(0x163)](_0x424a38['to_quantity'])),console[_0x925136(0x111)](_0x356641[_0x925136(0xd3)]));});}return _0x20e824;});Promise['all'](_0x67ebbe)[_0x5b0803(0xd5)](async _0xe29561=>{var _0x588d59=_0x5b0803;try{for(const _0x223228 of _0xe29561){await _0x223228[_0x588d59(0x148)]();}const _0x184fc3=_0x370f6d['product']['map'](async _0x529021=>{var _0xf7a516=_0x588d59,_0x2163d2=await warehouse[_0xf7a516(0xd0)]({'name':_0x57396e,'room':_0x529021[_0xf7a516(0xe7)]});if(_0x529021[_0xf7a516(0xf4)]>0x0){var _0x480e6f=0x0;const _0x6ad3dc=_0x2163d2[_0xf7a516(0xe8)]['map'](_0x5da904=>{var _0x224bd9=_0xf7a516;_0x5da904[_0x224bd9(0x17b)]==_0x529021[_0x224bd9(0x17b)]&&_0x5da904[_0x224bd9(0x126)]==_0x529021['to_bay']&&_0x5da904[_0x224bd9(0xeb)]==_0x529021[_0x224bd9(0xeb)]&&_0x5da904['production_date']==_0x529021['production_date']&&_0x5da904[_0x224bd9(0x165)]==_0x529021['batch_code']&&_0x5da904[_0x224bd9(0x16e)]==_0x529021[_0x224bd9(0x107)]&&(typeof _0x529021[_0x224bd9(0x10f)]==_0x224bd9(0x141)?(console[_0x224bd9(0x111)](_0x224bd9(0x18f),_0x5da904[_0x224bd9(0xd3)]+_0x224bd9(0x140)+_0x5da904[_0x224bd9(0x131)]+_0x224bd9(0x15b)+Math[_0x224bd9(0x163)](_0x5da904['product_stock'])+Math[_0x224bd9(0x163)](_0x529021[_0x224bd9(0xf4)])),_0x5da904['product_stock']=Math[_0x224bd9(0x163)](_0x5da904[_0x224bd9(0xd3)])+Math[_0x224bd9(0x163)](_0x529021['to_quantity'])):_0x5da904[_0x224bd9(0xd3)]=Math['abs'](_0x5da904['product_stock'])+Math['abs'](_0x529021[_0x224bd9(0xf4)]),_0x480e6f++);});_0x480e6f=='0'&&(_0x2163d2[_0xf7a516(0xe8)]=_0x2163d2[_0xf7a516(0xe8)][_0xf7a516(0xf2)]({'product_name':_0x529021[_0xf7a516(0x17b)],'product_stock':_0x529021['to_quantity'],'bay':_0x529021[_0xf7a516(0xd6)],'level':_0x529021[_0xf7a516(0x12d)],'product_code':_0x529021['product_code'],'primary_code':_0x529021['primary_code'],'secondary_code':_0x529021[_0xf7a516(0xdb)],'expiry_date':_0x529021[_0xf7a516(0xeb)],'production_date':_0x529021[_0xf7a516(0xed)],'maxProducts':_0x529021[_0xf7a516(0x116)],'batch_code':_0x529021[_0xf7a516(0x165)],'secondary_unit':_0x529021[_0xf7a516(0x18d)],'unit':_0x529021[_0xf7a516(0x197)],'maxProducts':_0x529021['maxProducts'],'maxPerUnit':_0x529021[_0xf7a516(0x177)],'invoice':_0x529021[_0xf7a516(0x107)]}));}return _0x2163d2;});Promise[_0x588d59(0x164)](_0x184fc3)['then'](async _0x2406c0=>{var _0x1b8e46=_0x588d59;try{console[_0x1b8e46(0x111)](_0x370f6d[_0x1b8e46(0xdf)]);if(_0x370f6d['type_of_process']!=_0x1b8e46(0x160))for(const _0x52ba81 of _0x2406c0){await warehouse[_0x1b8e46(0x18a)]({'_id':_0x52ba81[_0x1b8e46(0x131)]},{'$addToSet':{'product_details':{'$each':_0x52ba81[_0x1b8e46(0xe8)]}}});}_0x370f6d[_0x1b8e46(0x104)]='True';const _0x206676=await _0x370f6d['save'](),_0x8e4ce7=await master_shop[_0x1b8e46(0x19b)](),_0x49200b=await email_settings[_0x1b8e46(0xd0)](),_0x2d8a53=await supervisor_settings[_0x1b8e46(0x19b)]();var _0x58ca07=_0x370f6d[_0x1b8e46(0x127)],_0x1ac001='',_0x401f34;for(_0x401f34 in _0x58ca07){var _0x42c155='FG';_0x370f6d[_0x1b8e46(0x162)]==_0x1b8e46(0xe1)&&(_0x42c155='DG'),_0x1ac001+=_0x1b8e46(0xd9)+_0x1b8e46(0xdd)+_0x58ca07[_0x401f34][_0x1b8e46(0x17b)]+_0x1b8e46(0x122)+_0x1b8e46(0xdd)+_0x58ca07[_0x401f34][_0x1b8e46(0x144)]+_0x1b8e46(0x122)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x58ca07[_0x401f34][_0x1b8e46(0xf4)]+_0x1b8e46(0x122)+_0x1b8e46(0xdd)+_0x58ca07[_0x401f34][_0x1b8e46(0x197)]+_0x1b8e46(0x122)+_0x1b8e46(0xdd)+_0x58ca07[_0x401f34]['secondary_unit']+_0x1b8e46(0x122)+_0x1b8e46(0xdd)+_0x370f6d['to_warehouse']+_0x1b8e46(0x122)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x58ca07[_0x401f34]['to_room_name']+_0x1b8e46(0x122)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x42c155+_0x58ca07[_0x401f34]['to_bay']+_0x1b8e46(0x122)+_0x1b8e46(0x19c);}_0x3f8716[_0x1b8e46(0x12f)](_0x1b8e46(0x128),'Transfer\x20Finalize\x20Successfully'),_0x44d934[_0x1b8e46(0x166)](_0x1b8e46(0x135)+_0x206676[_0x1b8e46(0x131)]);}catch(_0x4eb625){console['error'](_0x4eb625),_0x44d934[_0x1b8e46(0x186)](0x1f4)[_0x1b8e46(0x121)]({'error':_0x1b8e46(0x15d)});}})[_0x588d59(0x13b)](_0x41458a=>{var _0x4a9db4=_0x588d59;console[_0x4a9db4(0xff)](_0x41458a),_0x44d934[_0x4a9db4(0x186)](0x1f4)[_0x4a9db4(0x121)]({'error':_0x4a9db4(0x193)});});}catch(_0x3f70c5){console[_0x588d59(0xff)](_0x3f70c5),_0x44d934['status'](0x1f4)[_0x588d59(0x121)]({'error':_0x588d59(0x158)});}})[_0x5b0803(0x13b)](_0x5c7a1f=>{var _0x362d1c=_0x5b0803;console[_0x362d1c(0xff)](_0x5c7a1f),_0x44d934[_0x362d1c(0x186)](0x1f4)[_0x362d1c(0x121)]({'error':_0x362d1c(0x193)});});}catch(_0xea2541){_0x44d934[_0x5b0803(0x121)]({'message':_0xea2541[_0x5b0803(0x13c)]});}});function BayBinSelected(_0x6b5e84,_0x38519b){var _0x543e9f=a0_0x518cae,_0x59cfda=[];let _0x3c5f2c=[];var _0x2ab282=[];if(_0x6b5e84==_0x543e9f(0xe1)){switch(_0x38519b){case _0x543e9f(0x180):_0x59cfda=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x543e9f(0x181):_0x59cfda=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x2ab282=['DG'];}else{if(_0x6b5e84==_0x543e9f(0x179)){switch(_0x38519b){case'Rack\x201':_0x59cfda=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x59cfda=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x2ab282=['FG'];}}return{'levels':_0x59cfda,'identify':_0x2ab282};}function a0_0x13b6(_0x41d60d,_0x2f02e0){var _0x1073e6=a0_0x1073();return a0_0x13b6=function(_0x13b6b7,_0x2567de){_0x13b6b7=_0x13b6b7-0xd0;var _0xa1821f=_0x1073e6[_0x13b6b7];return _0xa1821f;},a0_0x13b6(_0x41d60d,_0x2f02e0);}router[a0_0x518cae(0x188)](a0_0x518cae(0x16a),auth,async(_0x4659c1,_0x1c8f55)=>{var _0x1e2678=a0_0x518cae;try{const {username:_0x1c9131,email:_0xb4240,role:_0x2c88ad}=_0x4659c1['user'],_0x51f14c=_0x4659c1[_0x1e2678(0x113)],_0x3910c2=await profile['findOne']({'email':_0x51f14c['email']}),_0x5673f3=await master_shop[_0x1e2678(0x19b)](),_0x132e44=await transfers_finished[_0x1e2678(0xef)](_0x4659c1[_0x1e2678(0xe4)]['id']);let _0x368504=new Date(_0x132e44[_0x1e2678(0xeb)]),_0x5a560b=('0'+_0x368504[_0x1e2678(0xee)]())[_0x1e2678(0x112)](-0x2),_0x23eaf6=('0'+(_0x368504['getMonth']()+0x1))[_0x1e2678(0x112)](-0x2),_0x2abab6=_0x368504[_0x1e2678(0x103)](),_0x912811=_0x2abab6+'-'+_0x23eaf6+'-'+_0x5a560b,_0x3375b4;if(_0x51f14c[_0x1e2678(0x15f)]==_0x1e2678(0xda)){const _0x4dd4f6=await staff[_0x1e2678(0xd0)]({'email':_0x51f14c[_0x1e2678(0x159)]});_0x3375b4=await warehouse[_0x1e2678(0x19b)]({'status':'Enabled','name':_0x4dd4f6[_0x1e2678(0x151)],'warehouse_category':_0x1e2678(0xf1)});}else _0x3375b4=await warehouse[_0x1e2678(0x19b)]({'status':_0x1e2678(0x124),'warehouse_category':'Finished\x20Goods'});const _0x1f0db6=await warehouse[_0x1e2678(0x101)]([{'$match':{'name':_0x132e44[_0x1e2678(0xd2)],'room':_0x132e44[_0x1e2678(0x190)]}},{'$unwind':_0x1e2678(0x14e)},{'$group':{'_id':_0x1e2678(0x154),'name':{'$first':_0x1e2678(0x115)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1e2678(0x106)},'bin':{'$first':_0x1e2678(0x109)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1e2678(0x157)},'primary_code':{'$first':_0x1e2678(0x10d)},'secondary_code':{'$first':_0x1e2678(0x168)},'product_code':{'$first':_0x1e2678(0x191)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1e2678(0x10c)}}}]);var _0x163c28=[0x1,0x2,0x3,0x4],_0xace5a3=['A','B','C','D','E','F','G','H','I','J'],_0x241979=[_0x1e2678(0x1a0),_0x1e2678(0x161)];const _0x1aefcc=await product[_0x1e2678(0x19b)]({}),_0x350915=BayBinSelected(_0x132e44[_0x1e2678(0x162)],_0x132e44[_0x1e2678(0xd1)]);if(_0x5673f3[0x0][_0x1e2678(0xe3)]==_0x1e2678(0x12c)){var _0x49200a=users[_0x1e2678(0x150)];console['log'](_0x49200a);}else{if(_0x5673f3[0x0]['language']==_0x1e2678(0xea))var _0x49200a=users[_0x1e2678(0xea)];else{if(_0x5673f3[0x0]['language']=='German')var _0x49200a=users[_0x1e2678(0x198)];else{if(_0x5673f3[0x0][_0x1e2678(0xe3)]=='Spanish')var _0x49200a=users[_0x1e2678(0x125)];else{if(_0x5673f3[0x0][_0x1e2678(0xe3)]==_0x1e2678(0x149))var _0x49200a=users['French'];else{if(_0x5673f3[0x0][_0x1e2678(0xe3)]==_0x1e2678(0x182))var _0x49200a=users['Portuguese'];else{if(_0x5673f3[0x0][_0x1e2678(0xe3)]=='Chinese')var _0x49200a=users[_0x1e2678(0x195)];else{if(_0x5673f3[0x0][_0x1e2678(0xe3)]==_0x1e2678(0x110))var _0x49200a=users[_0x1e2678(0x18c)];}}}}}}}_0x1c8f55[_0x1e2678(0x11e)](_0x1e2678(0x18e),{'success':_0x4659c1['flash'](_0x1e2678(0x128)),'errors':_0x4659c1[_0x1e2678(0x12f)]('errors'),'role':_0x51f14c,'profile':_0x3910c2,'master_shop':_0x5673f3,'warehouse':_0x3375b4,'transfer':_0x132e44,'stock':_0x1f0db6,'unit':_0x1aefcc,'language':_0x49200a,'levels':_0x163c28,'Isle':_0xace5a3,'rooms_data':_0x241979,'ed_fullDate':_0x912811,'dataSelected':_0x350915});}catch(_0x27303d){console[_0x1e2678(0x111)](_0x27303d);}}),router['post'](a0_0x518cae(0x16a),auth,async(_0xe007db,_0x361e9c)=>{var _0x5418b2=a0_0x518cae;try{const _0x3c9027=_0xe007db[_0x5418b2(0xe4)]['id'];console[_0x5418b2(0x111)](_0xe007db[_0x5418b2(0x100)]);const _0x368a5f=await transfers_finished[_0x5418b2(0xef)](_0x3c9027);console[_0x5418b2(0x111)](_0x5418b2(0x118),_0x368a5f);const {date:_0x344075,from_warehouse:_0x639d31,FromRoom_name:_0x278d8e,to_warehouse:_0x3463e4,ToRoom_name:_0x705d,prod_name:_0x1fe9c2,from_prod_qty:_0x16b0c6,from_prod_level:_0x34f754,from_prod_isle:_0x18443e,from_prod_pallet:_0x8074a2,to_prod_qty:_0x10288f,to_prod_level:_0xde2b2f,to_prod_isle:_0x4a250e,to_prod_pallet:_0x539791,primary_code:_0x3fbe19,secondary_code:_0x1bccad,product_code3:_0x44dc06,note:_0xf9888,invoice:_0x3cee46,expiry_date:_0x4aca8a}=_0xe007db[_0x5418b2(0x100)];if(typeof _0x1fe9c2=='string')var _0x1b37a3=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0x155)]],_0x47ee8c=[_0xe007db[_0x5418b2(0x100)]['from_prod_qty']],_0x1a5ed6=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0x178)]],_0x4599d0=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0x16f)]],_0x1e775c=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0x172)]],_0x11e6aa=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0xfa)]],_0x2ab96d=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0xdb)]],_0x44c410=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0x12b)]],_0x289a7f=[_0xe007db[_0x5418b2(0x100)]['MaxStocks_data2']],_0x2c86d4=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0x197)]],_0x55dc31=[_0xe007db['body'][_0x5418b2(0x18d)]],_0x3dd479=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0x165)]],_0x1817e2=[_0xe007db[_0x5418b2(0x100)][_0x5418b2(0xeb)]];else var _0x1b37a3=[..._0xe007db['body'][_0x5418b2(0x155)]],_0x47ee8c=[..._0xe007db[_0x5418b2(0x100)]['from_prod_qty']],_0x1a5ed6=[..._0xe007db[_0x5418b2(0x100)][_0x5418b2(0x178)]],_0x4599d0=[..._0xe007db[_0x5418b2(0x100)]['to_prod_qty']],_0x1e775c=[..._0xe007db['body'][_0x5418b2(0x172)]],_0x11e6aa=[..._0xe007db[_0x5418b2(0x100)][_0x5418b2(0xfa)]],_0x2ab96d=[..._0xe007db[_0x5418b2(0x100)][_0x5418b2(0xdb)]],_0x44c410=[..._0xe007db[_0x5418b2(0x100)][_0x5418b2(0x12b)]],_0x289a7f=[..._0xe007db[_0x5418b2(0x100)][_0x5418b2(0x147)]],_0x2c86d4=[..._0xe007db[_0x5418b2(0x100)][_0x5418b2(0x197)]],_0x55dc31=[..._0xe007db[_0x5418b2(0x100)]['secondary_unit']],_0x3dd479=[..._0xe007db[_0x5418b2(0x100)]['batch_code']],_0x1817e2=[..._0xe007db[_0x5418b2(0x100)][_0x5418b2(0xeb)]];const _0x251c8d=_0x1b37a3['map'](_0x301dc6=>{return _0x301dc6={'product_name':_0x301dc6};});_0x47ee8c[_0x5418b2(0xde)]((_0x191a6b,_0x464ae7)=>{var _0x3ced38=_0x5418b2;_0x251c8d[_0x464ae7][_0x3ced38(0x13a)]=_0x191a6b;}),_0x1a5ed6['forEach']((_0x5b83b2,_0x422476)=>{_0x251c8d[_0x422476]['from_bay']=_0x5b83b2;}),_0x4599d0[_0x5418b2(0xde)]((_0x3d1f5d,_0x1896b9)=>{_0x251c8d[_0x1896b9]['to_quantity']=_0x3d1f5d;}),_0x1e775c['forEach']((_0x3a461b,_0xd998f5)=>{var _0x315226=_0x5418b2;_0x251c8d[_0xd998f5][_0x315226(0xd6)]=_0x3a461b;}),_0x11e6aa[_0x5418b2(0xde)]((_0x175ea8,_0x116dbc)=>{_0x251c8d[_0x116dbc]['primary_code']=_0x175ea8;}),_0x2ab96d[_0x5418b2(0xde)]((_0x149a66,_0x2f863a)=>{_0x251c8d[_0x2f863a]['secondary_code']=_0x149a66;}),_0x44c410['forEach']((_0x2e27cd,_0x475882)=>{_0x251c8d[_0x475882]['product_code']=_0x2e27cd;}),_0x289a7f[_0x5418b2(0xde)]((_0x19e9b6,_0x2877e4)=>{var _0x503cfe=_0x5418b2;_0x251c8d[_0x2877e4][_0x503cfe(0x116)]=_0x19e9b6;}),_0x2c86d4['forEach']((_0x42cf3e,_0x2caf53)=>{_0x251c8d[_0x2caf53]['unit']=_0x42cf3e;}),_0x55dc31[_0x5418b2(0xde)]((_0x57e4e2,_0xadcae8)=>{var _0x37f4e4=_0x5418b2;_0x251c8d[_0xadcae8][_0x37f4e4(0x18d)]=_0x57e4e2;}),_0x3dd479[_0x5418b2(0xde)]((_0xa1806d,_0x4b724a)=>{var _0x1c9a6a=_0x5418b2;_0x251c8d[_0x4b724a][_0x1c9a6a(0x165)]=_0xa1806d;}),_0x1817e2[_0x5418b2(0xde)]((_0xb9c166,_0x564990)=>{var _0x883aae=_0x5418b2;_0x251c8d[_0x564990][_0x883aae(0xeb)]=_0xb9c166;});const _0x2d704e=_0x251c8d[_0x5418b2(0x19a)](_0x4b9dfb=>_0x4b9dfb[_0x5418b2(0xf4)]!=='0'&&_0x4b9dfb[_0x5418b2(0xf4)]!==''||_0x4b9dfb[_0x5418b2(0x139)]!=='0'&&_0x4b9dfb[_0x5418b2(0x139)]!=='');var _0xdc1dec=0x0;_0x2d704e[_0x5418b2(0xde)](_0x376192=>{var _0x5cfc5c=_0x5418b2;parseInt(_0x376192[_0x5cfc5c(0x13a)])<parseInt(_0x376192[_0x5cfc5c(0xf4)])&&_0xdc1dec++;});if(_0xdc1dec!=0x0)return _0xe007db[_0x5418b2(0x12f)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x361e9c[_0x5418b2(0x166)](_0x5418b2(0xd8));const _0x26aec2=await warehouse[_0x5418b2(0xd0)]({'name':_0x368a5f['from_warehouse'],'room':_0x368a5f[_0x5418b2(0x190)]});_0x368a5f['product'][_0x5418b2(0xde)](_0x491060=>{var _0x220fa6=_0x5418b2;if(_0x491060[_0x220fa6(0xf4)]>0x0){const _0x3a3d09=_0x26aec2[_0x220fa6(0xe8)][_0x220fa6(0xe5)](_0x3c17dc=>{var _0x19f0ac=_0x220fa6;_0x3c17dc['product_name']==_0x491060[_0x19f0ac(0x17b)]&&_0x3c17dc[_0x19f0ac(0x126)]==_0x491060[_0x19f0ac(0x173)]&&(_0x3c17dc[_0x19f0ac(0xd3)]=parseInt(_0x3c17dc[_0x19f0ac(0xd3)])+parseInt(_0x491060[_0x19f0ac(0xf4)]));});}}),await _0x26aec2[_0x5418b2(0x148)]();const _0x523e05=await warehouse[_0x5418b2(0xd0)]({'name':_0x368a5f[_0x5418b2(0x162)],'room':_0x368a5f[_0x5418b2(0xd1)]});_0x368a5f['product']['forEach'](_0x15c164=>{var _0x392ae0=_0x5418b2;if(_0x15c164[_0x392ae0(0xf4)]>0x0){const _0x441325=_0x523e05['product_details'][_0x392ae0(0xe5)](_0x2660fa=>{var _0x4c6144=_0x392ae0;_0x2660fa[_0x4c6144(0x17b)]==_0x15c164[_0x4c6144(0x17b)]&&_0x2660fa[_0x4c6144(0x126)]==_0x15c164['to_bay']&&(_0x2660fa[_0x4c6144(0xd3)]=parseInt(_0x2660fa[_0x4c6144(0xd3)])-parseInt(_0x15c164['to_quantity']));});}}),await _0x523e05[_0x5418b2(0x148)](),_0x368a5f[_0x5418b2(0x13e)]=_0x344075,_0x368a5f[_0x5418b2(0xd2)]=_0x639d31,_0x368a5f[_0x5418b2(0x162)]=_0x3463e4,_0x368a5f[_0x5418b2(0x127)]=_0x2d704e,_0x368a5f[_0x5418b2(0x16b)]=_0xf9888,_0x368a5f[_0x5418b2(0x16e)]=_0x3cee46;const _0x15588d=await _0x368a5f[_0x5418b2(0x148)](),_0x10dd14=await warehouse[_0x5418b2(0xd0)]({'name':_0x639d31,'room':_0x278d8e});_0x15588d['product']['forEach'](_0x2a8bfc=>{var _0x493f0f=_0x5418b2;if(_0x2a8bfc['to_quantity']>0x0){const _0x4ae995=_0x10dd14[_0x493f0f(0xe8)][_0x493f0f(0xe5)](_0x25c8f3=>{var _0x55906b=_0x493f0f;_0x25c8f3[_0x55906b(0x17b)]==_0x2a8bfc[_0x55906b(0x17b)]&&_0x25c8f3[_0x55906b(0x126)]==_0x2a8bfc['from_bay']&&(_0x25c8f3['product_stock']=parseInt(_0x25c8f3[_0x55906b(0xd3)])-parseInt(_0x2a8bfc[_0x55906b(0xf4)]));});}}),await _0x10dd14['save']();const _0x490788=await warehouse[_0x5418b2(0xd0)]({'name':_0x3463e4,'room':_0x705d});_0x15588d[_0x5418b2(0x127)][_0x5418b2(0xde)](_0x39edc4=>{var _0x3c9a8e=_0x5418b2;if(_0x39edc4[_0x3c9a8e(0xf4)]>0x0){var _0x37a399=0x0;const _0x1a3744=_0x490788[_0x3c9a8e(0xe8)]['map'](_0x4097ef=>{var _0x490d36=_0x3c9a8e;_0x4097ef[_0x490d36(0x17b)]==_0x39edc4[_0x490d36(0x17b)]&&_0x4097ef[_0x490d36(0x126)]==_0x39edc4[_0x490d36(0xd6)]&&(_0x4097ef[_0x490d36(0xd3)]=parseInt(_0x4097ef[_0x490d36(0xd3)])+parseInt(_0x39edc4[_0x490d36(0xf4)]),_0x37a399++);});_0x37a399=='0'&&(_0x490788[_0x3c9a8e(0xe8)]=_0x490788[_0x3c9a8e(0xe8)][_0x3c9a8e(0xf2)]({'product_name':_0x39edc4[_0x3c9a8e(0x17b)],'product_stock':_0x39edc4[_0x3c9a8e(0xf4)],'bay':_0x39edc4[_0x3c9a8e(0xd6)],'product_code':_0x39edc4[_0x3c9a8e(0x144)],'primary_code':_0x39edc4[_0x3c9a8e(0xfa)],'secondary_code':_0x39edc4['secondary_code'],'maxProducts':_0x39edc4[_0x3c9a8e(0x116)]}));}}),await _0x490788[_0x5418b2(0x148)](),_0xe007db['flash']('success',_0x5418b2(0x146)),_0x361e9c[_0x5418b2(0x166)](_0x5418b2(0x15a));}catch(_0x5eb83d){console[_0x5418b2(0x111)](_0x5eb83d);}}),router['post']('/barcode_scanner',async(_0x31f38b,_0x13d00e)=>{var _0x185a85=a0_0x518cae;const {FromWareHouse:_0x453a19,FromRoom:_0x3e991b,ToWarehouse:_0x5323d9,ToRoom:_0x599f49,primary_code:_0x512f50,Roomslist:_0x312a56}=_0x31f38b[_0x185a85(0x100)],_0x4d9c44=_0x312a56[_0x185a85(0x117)](','),_0x75007e=[];async function _0x27c3eb(_0x943f34){var _0x5dcf15=_0x185a85;const _0x5efc8a=await warehouse['aggregate']([{'$match':{'name':_0x453a19,'room':_0x943f34}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x512f50}},{'$group':{'_id':_0x5dcf15(0x154),'name':{'$first':_0x5dcf15(0x115)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5dcf15(0x10d)},'secondary_code':{'$first':_0x5dcf15(0x168)},'product_code':{'$first':_0x5dcf15(0x191)},'bay':{'$first':'$product_details.bay'},'level':{'$first':_0x5dcf15(0x12a)},'type':{'$first':_0x5dcf15(0x170)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5dcf15(0x16c)},'secondary_unit':{'$first':_0x5dcf15(0x15c)},'storage':{'$first':_0x5dcf15(0x145)},'rack':{'$first':_0x5dcf15(0x10c)},'expiry_date':{'$first':_0x5dcf15(0x17e)},'production_date':{'$first':_0x5dcf15(0x174)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x5dcf15(0x17f)},'roomNamed':{'$first':_0x5dcf15(0x19e)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x5dcf15(0x156)}}}]),_0xc71781=await warehouse[_0x5dcf15(0x101)]([{'$match':{'name':_0x453a19,'room':_0x943f34}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x512f50}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5dcf15(0x115)},'instock':{'$first':_0x5dcf15(0x133)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5dcf15(0x168)},'product_code':{'$first':_0x5dcf15(0x191)},'bay':{'$first':_0x5dcf15(0x106)},'level':{'$first':'$product_details.level'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x5dcf15(0x157)},'unit':{'$first':_0x5dcf15(0x16c)},'secondary_unit':{'$first':_0x5dcf15(0x15c)},'storage':{'$first':_0x5dcf15(0x145)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5dcf15(0x174)},'batch_code':{'$first':_0x5dcf15(0x11f)},'maxPerUnit':{'$first':_0x5dcf15(0x17f)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x5dcf15(0x156)}}}]);if(_0x5efc8a[_0x5dcf15(0x10e)]>0x0)_0x75007e[_0x5dcf15(0x176)](_0x5efc8a);else _0xc71781[_0x5dcf15(0x10e)]>0x0&&_0x75007e['push'](_0xc71781);}const _0x2d0b8f=_0x4d9c44[_0x185a85(0xe5)](_0x2277f2=>_0x27c3eb(_0x2277f2));await Promise[_0x185a85(0x164)](_0x2d0b8f),_0x13d00e['json'](_0x75007e);}),router[a0_0x518cae(0x15e)](a0_0x518cae(0x185),async(_0x2fb49f,_0x3486f1)=>{var _0x1e0adc=a0_0x518cae;const {productCode:_0x2f6d36,bay:_0x52d4cd,warehouses:_0x29da5f,room:_0x163b1b}=_0x2fb49f[_0x1e0adc(0x100)];console['log'](_0x2fb49f['body']);try{const _0x453d95=await warehouse[_0x1e0adc(0x101)]([{'$match':{'name':_0x29da5f,'room':_0x163b1b}},{'$unwind':_0x1e0adc(0x14e)},{'$match':{'product_details.bay':parseInt(_0x52d4cd)}},{'$group':{'_id':_0x1e0adc(0x154),'name':{'$first':_0x1e0adc(0x115)},'product_stock':{'$first':_0x1e0adc(0x133)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x1e0adc(0x14f)}}}]);_0x3486f1[_0x1e0adc(0x186)](0xc8)[_0x1e0adc(0x121)](_0x453d95);}catch(_0x4ed66e){_0x3486f1[_0x1e0adc(0x186)](0x194)['json']({'message':_0x4ed66e['message']});}}),module['exports']=router;