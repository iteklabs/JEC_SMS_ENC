var a0_0x400b8e=a0_0x327f;(function(_0x56f45a,_0x4c2759){var _0xd260c0=a0_0x327f,_0x5c46e9=_0x56f45a();while(!![]){try{var _0x464b1d=-parseInt(_0xd260c0(0x202))/0x1+parseInt(_0xd260c0(0x23c))/0x2+-parseInt(_0xd260c0(0x1dd))/0x3+-parseInt(_0xd260c0(0x29b))/0x4+parseInt(_0xd260c0(0x21f))/0x5+-parseInt(_0xd260c0(0x20e))/0x6*(-parseInt(_0xd260c0(0x238))/0x7)+-parseInt(_0xd260c0(0x1f3))/0x8;if(_0x464b1d===_0x4c2759)break;else _0x5c46e9['push'](_0x5c46e9['shift']());}catch(_0x5745c5){_0x5c46e9['push'](_0x5c46e9['shift']());}}}(a0_0x18b6,0xba6a5));const express=require(a0_0x400b8e(0x1e8)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x400b8e(0x1e5)),auth=require(a0_0x400b8e(0x24c)),users=require(a0_0x400b8e(0x27e)),nodemailer=require(a0_0x400b8e(0x1d6));router['get']('/view',auth,async(_0x3528f7,_0x12a3ed)=>{var _0x47fdfe=a0_0x400b8e;try{const {username:_0x324765,email:_0x278fcf,role:_0x1c51ef}=_0x3528f7['user'],_0x39d3b9=_0x3528f7[_0x47fdfe(0x287)],_0x2d977d=await profile[_0x47fdfe(0x281)]({'email':_0x39d3b9[_0x47fdfe(0x290)]}),_0x3827d4=await master_shop[_0x47fdfe(0x1de)]();let _0x19e3a1;if(_0x39d3b9[_0x47fdfe(0x235)]==_0x47fdfe(0x268)){const _0x685606=await staff[_0x47fdfe(0x281)]({'email':_0x39d3b9[_0x47fdfe(0x290)]});_0x19e3a1=await transfers_finished[_0x47fdfe(0x1de)]({'from_warehouse':_0x685606[_0x47fdfe(0x218)]});}else _0x19e3a1=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x47fdfe(0x1e1)}},{'$unwind':_0x47fdfe(0x1d7)},{'$group':{'_id':_0x47fdfe(0x23e),'invoice':{'$first':'$invoice'},'date':{'$first':_0x47fdfe(0x1e2)},'from_warehouse':{'$first':_0x47fdfe(0x245)},'to_warehouse':{'$first':_0x47fdfe(0x20f)},'from_room_name':{'$addToSet':_0x47fdfe(0x295)},'to_room_name':{'$addToSet':_0x47fdfe(0x21b)},'finalize':{'$first':_0x47fdfe(0x29d)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3827d4[0x0]['language']==_0x47fdfe(0x1e7))var _0xa3942d=users[_0x47fdfe(0x205)];else{if(_0x3827d4[0x0][_0x47fdfe(0x224)]==_0x47fdfe(0x27f))var _0xa3942d=users['Hindi'];else{if(_0x3827d4[0x0][_0x47fdfe(0x224)]=='German')var _0xa3942d=users['German'];else{if(_0x3827d4[0x0][_0x47fdfe(0x224)]==_0x47fdfe(0x263))var _0xa3942d=users['Spanish'];else{if(_0x3827d4[0x0][_0x47fdfe(0x224)]==_0x47fdfe(0x288))var _0xa3942d=users[_0x47fdfe(0x288)];else{if(_0x3827d4[0x0][_0x47fdfe(0x224)]=='Portuguese\x20(BR)')var _0xa3942d=users[_0x47fdfe(0x291)];else{if(_0x3827d4[0x0]['language']==_0x47fdfe(0x1f7))var _0xa3942d=users[_0x47fdfe(0x1f7)];else{if(_0x3827d4[0x0][_0x47fdfe(0x224)]==_0x47fdfe(0x219))var _0xa3942d=users[_0x47fdfe(0x1ee)];}}}}}}}_0x12a3ed[_0x47fdfe(0x28c)](_0x47fdfe(0x236),{'success':_0x3528f7[_0x47fdfe(0x1eb)](_0x47fdfe(0x212)),'errors':_0x3528f7['flash'](_0x47fdfe(0x1f2)),'role':_0x39d3b9,'profile':_0x2d977d,'master_shop':_0x3827d4,'transfer':_0x19e3a1,'language':_0xa3942d});}catch(_0x1c7f71){console[_0x47fdfe(0x25a)](_0x1c7f71);}}),router['get'](a0_0x400b8e(0x22a),auth,async(_0x22abd6,_0x1fa87e)=>{var _0x30dee3=a0_0x400b8e;try{const {username:_0x30376b,email:_0x4cf818,role:_0x445834}=_0x22abd6[_0x30dee3(0x287)],_0x30f717=_0x22abd6[_0x30dee3(0x287)],_0xdc3542=await profile[_0x30dee3(0x281)]({'email':_0x30f717[_0x30dee3(0x290)]}),_0x477a3d=await master_shop[_0x30dee3(0x1de)]();let _0x2ed1fb;if(_0x30f717['role']==_0x30dee3(0x268)){const _0x58146d=await staff['findOne']({'email':_0x30f717[_0x30dee3(0x290)]});_0x2ed1fb=await transfers_finished[_0x30dee3(0x1de)]({'from_warehouse':_0x58146d[_0x30dee3(0x218)]});}else _0x2ed1fb=await transfers_finished[_0x30dee3(0x1d8)]([{'$match':{'type_of_transaction':_0x30dee3(0x1ed)}},{'$unwind':_0x30dee3(0x1d7)},{'$group':{'_id':_0x30dee3(0x23e),'invoice':{'$first':_0x30dee3(0x20a)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x30dee3(0x20f)},'from_room_name':{'$addToSet':_0x30dee3(0x295)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x30dee3(0x29d)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x477a3d[0x0]['language']==_0x30dee3(0x1e7))var _0x112f27=users[_0x30dee3(0x205)];else{if(_0x477a3d[0x0][_0x30dee3(0x224)]=='Hindi')var _0x112f27=users[_0x30dee3(0x27f)];else{if(_0x477a3d[0x0]['language']==_0x30dee3(0x1e9))var _0x112f27=users[_0x30dee3(0x1e9)];else{if(_0x477a3d[0x0][_0x30dee3(0x224)]==_0x30dee3(0x263))var _0x112f27=users[_0x30dee3(0x263)];else{if(_0x477a3d[0x0][_0x30dee3(0x224)]==_0x30dee3(0x288))var _0x112f27=users[_0x30dee3(0x288)];else{if(_0x477a3d[0x0][_0x30dee3(0x224)]==_0x30dee3(0x22f))var _0x112f27=users[_0x30dee3(0x291)];else{if(_0x477a3d[0x0][_0x30dee3(0x224)]==_0x30dee3(0x1f7))var _0x112f27=users[_0x30dee3(0x1f7)];else{if(_0x477a3d[0x0][_0x30dee3(0x224)]=='Arabic\x20(ae)')var _0x112f27=users[_0x30dee3(0x1ee)];}}}}}}}_0x1fa87e[_0x30dee3(0x28c)](_0x30dee3(0x237),{'success':_0x22abd6[_0x30dee3(0x1eb)](_0x30dee3(0x212)),'errors':_0x22abd6[_0x30dee3(0x1eb)](_0x30dee3(0x1f2)),'role':_0x30f717,'profile':_0xdc3542,'master_shop':_0x477a3d,'transfer':_0x2ed1fb,'language':_0x112f27});}catch(_0x3cc61b){console[_0x30dee3(0x25a)](_0x3cc61b);}});async function getRandom8DigitNumber(){var _0x1fd389=a0_0x400b8e;const _0x10b1e5=0x989680,_0x20ea72=0x5f5e0ff,_0x1324b4=Math[_0x1fd389(0x21d)](Math[_0x1fd389(0x230)]()*(_0x20ea72-_0x10b1e5+0x1))+_0x10b1e5;var _0x56e558;const _0x43167c=await transfers_finished['findOne']({'invoice':_0x1fd389(0x292)+_0x1324b4});return _0x43167c&&_0x43167c[_0x1fd389(0x20d)]>0x0?_0x56e558='TRFF-'+_0x1324b4:_0x56e558=_0x1fd389(0x292)+_0x1324b4,_0x56e558;}router['get']('/view/add_transfer',auth,async(_0x16444e,_0x157167)=>{var _0x4f10af=a0_0x400b8e;try{const {username:_0x179c13,email:_0x1cd199,role:_0x39dc27}=_0x16444e[_0x4f10af(0x287)],_0x2d9639=_0x16444e[_0x4f10af(0x287)],_0x2cf634=await profile[_0x4f10af(0x281)]({'email':_0x2d9639[_0x4f10af(0x290)]}),_0x65cd9c=await master_shop[_0x4f10af(0x1de)]();let _0x26a45e;if(_0x2d9639[_0x4f10af(0x235)]=='staff'){const _0x4644e0=await staff[_0x4f10af(0x281)]({'email':_0x2d9639[_0x4f10af(0x290)]});_0x26a45e=await warehouse[_0x4f10af(0x1d8)]([{'$match':{'status':_0x4f10af(0x240),'name':_0x4644e0[_0x4f10af(0x218)]}},{'$group':{'_id':'$name','name':{'$first':_0x4f10af(0x25e)}}}]);}else _0x26a45e=await warehouse['aggregate']([{'$match':{'status':_0x4f10af(0x240)}},{'$group':{'_id':_0x4f10af(0x25e),'name':{'$first':'$name'}}}]);const _0x57fe45=await transfers_finished['find']({}),_0x3bc163=_0x57fe45['length']+0x1,_0xb1a566=_0x4f10af(0x292)+_0x3bc163[_0x4f10af(0x232)]()[_0x4f10af(0x21a)](0x5,'0');if(_0x65cd9c[0x0][_0x4f10af(0x224)]==_0x4f10af(0x1e7))var _0x248605=users[_0x4f10af(0x205)];else{if(_0x65cd9c[0x0][_0x4f10af(0x224)]==_0x4f10af(0x27f))var _0x248605=users[_0x4f10af(0x27f)];else{if(_0x65cd9c[0x0][_0x4f10af(0x224)]==_0x4f10af(0x1e9))var _0x248605=users[_0x4f10af(0x1e9)];else{if(_0x65cd9c[0x0]['language']==_0x4f10af(0x263))var _0x248605=users['Spanish'];else{if(_0x65cd9c[0x0][_0x4f10af(0x224)]==_0x4f10af(0x288))var _0x248605=users[_0x4f10af(0x288)];else{if(_0x65cd9c[0x0][_0x4f10af(0x224)]==_0x4f10af(0x22f))var _0x248605=users[_0x4f10af(0x291)];else{if(_0x65cd9c[0x0]['language']=='Chinese')var _0x248605=users[_0x4f10af(0x1f7)];else{if(_0x65cd9c[0x0][_0x4f10af(0x224)]==_0x4f10af(0x219))var _0x248605=users['Arabic'];}}}}}}}const _0x596e7b=getRandom8DigitNumber();_0x596e7b[_0x4f10af(0x1df)](_0x185575=>{var _0x533bbd=_0x4f10af;_0x157167['render'](_0x533bbd(0x208),{'success':_0x16444e[_0x533bbd(0x1eb)](_0x533bbd(0x212)),'errors':_0x16444e[_0x533bbd(0x1eb)](_0x533bbd(0x1f2)),'role':_0x2d9639,'profile':_0x2cf634,'master_shop':_0x65cd9c,'warehouse':_0x26a45e,'language':_0x248605,'invoice':_0x185575});})[_0x4f10af(0x294)](_0x922537=>{var _0x118bd9=_0x4f10af;_0x16444e[_0x118bd9(0x1eb)](_0x118bd9(0x1f2),_0x118bd9(0x20b)),_0x157167['redirect'](_0x118bd9(0x298));});}catch(_0x25e3c4){console[_0x4f10af(0x25a)](_0x25e3c4);}}),router[a0_0x400b8e(0x24d)]('/view/choose',auth,async(_0x4e1774,_0x154773)=>{var _0x53e72=a0_0x400b8e;try{const {username:_0x2ed551,email:_0x3091c2,role:_0x4379e1}=_0x4e1774[_0x53e72(0x287)],_0x457945=_0x4e1774['user'],_0x40524a=await profile[_0x53e72(0x281)]({'email':_0x457945[_0x53e72(0x290)]}),_0xb6471a=await master_shop[_0x53e72(0x1de)]();let _0x4aa87f;if(_0x457945[_0x53e72(0x235)]==_0x53e72(0x268)){const _0x59bc57=await staff[_0x53e72(0x281)]({'email':_0x457945[_0x53e72(0x290)]});_0x4aa87f=await warehouse[_0x53e72(0x1d8)]([{'$match':{'status':_0x53e72(0x240),'name':_0x59bc57['warehouse']}},{'$group':{'_id':_0x53e72(0x25e),'name':{'$first':_0x53e72(0x25e)}}}]);}else _0x4aa87f=await warehouse['aggregate']([{'$match':{'status':_0x53e72(0x240)}},{'$group':{'_id':_0x53e72(0x25e),'name':{'$first':_0x53e72(0x25e)}}}]);const _0x2adb7f=await transfers_finished['find']({}),_0xaa983d=_0x2adb7f[_0x53e72(0x20d)]+0x1,_0x58a176=_0x53e72(0x292)+_0xaa983d[_0x53e72(0x232)]()['padStart'](0x5,'0');if(_0xb6471a[0x0][_0x53e72(0x224)]==_0x53e72(0x1e7))var _0xcc9e84=users['English'];else{if(_0xb6471a[0x0]['language']=='Hindi')var _0xcc9e84=users[_0x53e72(0x27f)];else{if(_0xb6471a[0x0][_0x53e72(0x224)]==_0x53e72(0x1e9))var _0xcc9e84=users[_0x53e72(0x1e9)];else{if(_0xb6471a[0x0][_0x53e72(0x224)]==_0x53e72(0x263))var _0xcc9e84=users['Spanish'];else{if(_0xb6471a[0x0][_0x53e72(0x224)]==_0x53e72(0x288))var _0xcc9e84=users[_0x53e72(0x288)];else{if(_0xb6471a[0x0][_0x53e72(0x224)]==_0x53e72(0x22f))var _0xcc9e84=users[_0x53e72(0x291)];else{if(_0xb6471a[0x0]['language']==_0x53e72(0x1f7))var _0xcc9e84=users[_0x53e72(0x1f7)];else{if(_0xb6471a[0x0][_0x53e72(0x224)]==_0x53e72(0x219))var _0xcc9e84=users[_0x53e72(0x1ee)];}}}}}}}const _0x2a2f86=getRandom8DigitNumber();_0x2a2f86[_0x53e72(0x1df)](_0x37595f=>{var _0x130f8a=_0x53e72;_0x154773[_0x130f8a(0x28c)](_0x130f8a(0x257),{'success':_0x4e1774[_0x130f8a(0x1eb)](_0x130f8a(0x212)),'errors':_0x4e1774[_0x130f8a(0x1eb)](_0x130f8a(0x1f2)),'role':_0x457945,'profile':_0x40524a,'master_shop':_0xb6471a,'warehouse':_0x4aa87f,'language':_0xcc9e84,'invoice':_0x37595f});})[_0x53e72(0x294)](_0x579e60=>{var _0x1752fc=_0x53e72;_0x4e1774[_0x1752fc(0x1eb)](_0x1752fc(0x1f2),_0x1752fc(0x20b)),_0x154773[_0x1752fc(0x226)](_0x1752fc(0x298));});}catch(_0x37048e){console['log'](_0x37048e);}}),router['get']('/view/choose_logs',auth,async(_0x258d5e,_0x41c8fb)=>{var _0x318bc9=a0_0x400b8e;try{const {username:_0x1b1c8b,email:_0x40fb7e,role:_0x4b4fbc}=_0x258d5e['user'],_0xbcce59=_0x258d5e[_0x318bc9(0x287)],_0x5088bf=await profile[_0x318bc9(0x281)]({'email':_0xbcce59[_0x318bc9(0x290)]}),_0x76bab=await master_shop['find']();let _0x55eef5;if(_0xbcce59['role']==_0x318bc9(0x268)){const _0x3eff87=await staff[_0x318bc9(0x281)]({'email':_0xbcce59[_0x318bc9(0x290)]});_0x55eef5=await warehouse[_0x318bc9(0x1d8)]([{'$match':{'status':_0x318bc9(0x240),'name':_0x3eff87[_0x318bc9(0x218)]}},{'$group':{'_id':'$name','name':{'$first':_0x318bc9(0x25e)}}}]);}else _0x55eef5=await warehouse['aggregate']([{'$match':{'status':_0x318bc9(0x240)}},{'$group':{'_id':_0x318bc9(0x25e),'name':{'$first':_0x318bc9(0x25e)}}}]);const _0x575fe6=await transfers_finished[_0x318bc9(0x1de)]({}),_0x3dd9d4=_0x575fe6['length']+0x1,_0x31cbf7=_0x318bc9(0x292)+_0x3dd9d4[_0x318bc9(0x232)]()[_0x318bc9(0x21a)](0x5,'0');if(_0x76bab[0x0][_0x318bc9(0x224)]==_0x318bc9(0x1e7))var _0x18a86c=users['English'];else{if(_0x76bab[0x0][_0x318bc9(0x224)]=='Hindi')var _0x18a86c=users[_0x318bc9(0x27f)];else{if(_0x76bab[0x0][_0x318bc9(0x224)]==_0x318bc9(0x1e9))var _0x18a86c=users[_0x318bc9(0x1e9)];else{if(_0x76bab[0x0]['language']==_0x318bc9(0x263))var _0x18a86c=users[_0x318bc9(0x263)];else{if(_0x76bab[0x0][_0x318bc9(0x224)]==_0x318bc9(0x288))var _0x18a86c=users[_0x318bc9(0x288)];else{if(_0x76bab[0x0][_0x318bc9(0x224)]=='Portuguese\x20(BR)')var _0x18a86c=users[_0x318bc9(0x291)];else{if(_0x76bab[0x0][_0x318bc9(0x224)]==_0x318bc9(0x1f7))var _0x18a86c=users[_0x318bc9(0x1f7)];else{if(_0x76bab[0x0][_0x318bc9(0x224)]==_0x318bc9(0x219))var _0x18a86c=users[_0x318bc9(0x1ee)];}}}}}}}const _0x469cc3=getRandom8DigitNumber();_0x469cc3[_0x318bc9(0x1df)](_0x3ef6ca=>{var _0x3a8f0e=_0x318bc9;_0x41c8fb[_0x3a8f0e(0x28c)](_0x3a8f0e(0x22c),{'success':_0x258d5e[_0x3a8f0e(0x1eb)](_0x3a8f0e(0x212)),'errors':_0x258d5e[_0x3a8f0e(0x1eb)](_0x3a8f0e(0x1f2)),'role':_0xbcce59,'profile':_0x5088bf,'master_shop':_0x76bab,'warehouse':_0x55eef5,'language':_0x18a86c,'invoice':_0x3ef6ca});})[_0x318bc9(0x294)](_0x4c048d=>{var _0x4fbd85=_0x318bc9;_0x258d5e['flash'](_0x4fbd85(0x1f2),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x41c8fb[_0x4fbd85(0x226)]('/transfer/view');});}catch(_0x4543cb){console[_0x318bc9(0x25a)](_0x4543cb);}}),router[a0_0x400b8e(0x23b)](a0_0x400b8e(0x253),auth,async(_0x368f18,_0xda074a)=>{var _0x4f05f2=a0_0x400b8e;try{const {date:_0x7c430e,from_warehouse:_0x6c7c3c,FromRoom_name:_0x434bc7,to_warehouse:_0x108d44,ToRoom_name:_0x2bbc4b,prod_name:_0x3a782c,from_prod_qty:_0x1233ea,from_prod_level:_0x29446f,from_prod_isle:_0x58ac09,from_prod_pallet:_0x2cc04d,to_prod_qty:_0x36b1da,to_prod_level:_0x1b2f28,to_prod_isle:_0x51ca12,to_prod_pallet:_0x5ad42f,primary_code:_0x2be4de,secondary_code:_0x4b3c7d,product_code3:_0x22ad0f,note:_0x45e931,MaxStocks_data2:_0x141cab,invoice:_0x4279e1,expiry_date:_0x50e139,PO_number:_0x493a0c,ReqBy:_0x5b8630,dateofreq:_0x3cf770,typeservicesData:_0x11fb25,destination:_0x141f80,deliverydate:_0x5924eb,driver:_0x4126d1,plate:_0x4bcca6,van:_0x45285d,DRSI:_0x196333,typevehicle:_0x48d1a6,TSU:_0x2c1466,TFU:_0x5af975}=_0x368f18['body'];if(typeof _0x3a782c==_0x4f05f2(0x28e))var _0x3f342c=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x1fc)]],_0x4672e8=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x25d)]],_0x503104=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x1dc)]],_0x2a7338=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x27b)]],_0x3b975b=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x258)]],_0x5146fa=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x274)]],_0x1f3d23=[_0x368f18['body'][_0x4f05f2(0x25c)]],_0x1e510e=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x239)]],_0x21740a=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x269)]],_0x46ab3d=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x27a)]],_0x1eb2cc=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x26f)]],_0x455f4b=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x248)]],_0x2492b4=[_0x368f18[_0x4f05f2(0x284)]['expiry_date']],_0x197a0c=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x256)]],_0x2c0c5d=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x29f)]],_0x5eecc9=[_0x368f18['body'][_0x4f05f2(0x1e0)]],_0x32294a=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x1ec)]],_0x1653aa=[_0x368f18['body'][_0x4f05f2(0x25f)]],_0x5b3129=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x216)]],_0x1f07ed=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x206)]],_0x52049b=[_0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x29c)]];else var _0x3f342c=[..._0x368f18['body'][_0x4f05f2(0x1fc)]],_0x4672e8=[..._0x368f18[_0x4f05f2(0x284)]['from_prod_qty']],_0x503104=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x1dc)]],_0x2a7338=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x27b)]],_0x3b975b=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x258)]],_0x5146fa=[..._0x368f18[_0x4f05f2(0x284)]['primary_code']],_0x1f3d23=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x25c)]],_0x1e510e=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x239)]],_0x21740a=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x269)]],_0x46ab3d=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x27a)]],_0x1eb2cc=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x26f)]],_0x455f4b=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x248)]],_0x2492b4=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x26d)]],_0x197a0c=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x256)]],_0x2c0c5d=[..._0x368f18['body'][_0x4f05f2(0x29f)]],_0x5eecc9=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x1e0)]],_0x32294a=[..._0x368f18[_0x4f05f2(0x284)]['prod_cat']],_0x1653aa=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x25f)]],_0x5b3129=[..._0x368f18[_0x4f05f2(0x284)]['ToRoomAssigned']],_0x1f07ed=[..._0x368f18[_0x4f05f2(0x284)][_0x4f05f2(0x206)]],_0x52049b=[..._0x368f18['body'][_0x4f05f2(0x29c)]];const _0x44fc48=_0x3f342c['map'](_0x2a57e6=>{return _0x2a57e6={'product_name':_0x2a57e6};});_0x4672e8['forEach']((_0xe3e835,_0x2bfbd8)=>{var _0x3ba050=_0x4f05f2;_0x44fc48[_0x2bfbd8][_0x3ba050(0x22e)]=_0xe3e835;}),_0x503104[_0x4f05f2(0x231)]((_0x27dafc,_0x241df8)=>{var _0x5bfad0=_0x4f05f2,_0x428bd9=_0x27dafc[_0x5bfad0(0x28a)](/[A-Za-z]+/)[0x0],_0x440555=parseInt(_0x27dafc[_0x5bfad0(0x28a)](/\d+/)[0x0]);_0x44fc48[_0x241df8][_0x5bfad0(0x233)]=_0x440555,_0x44fc48[_0x241df8][_0x5bfad0(0x289)]=_0x428bd9;}),_0x52049b[_0x4f05f2(0x231)]((_0x44a0d8,_0x114556)=>{var _0x5aeca3=_0x4f05f2;_0x44fc48[_0x114556][_0x5aeca3(0x29c)]=_0x44a0d8;}),_0x1f07ed[_0x4f05f2(0x231)]((_0xf7c38c,_0x1f645d)=>{var _0x43f2e3=_0x4f05f2;_0x44fc48[_0x1f645d][_0x43f2e3(0x206)]=_0xf7c38c;}),_0x2a7338['forEach']((_0x34ecba,_0x195a45)=>{var _0x3107d4=_0x4f05f2;_0x44fc48[_0x195a45][_0x3107d4(0x1f8)]=_0x34ecba;}),_0x3b975b[_0x4f05f2(0x231)]((_0x2a9e28,_0x716978)=>{var _0x1e01e1=_0x4f05f2,_0x44f7f9=_0x2a9e28[_0x1e01e1(0x28a)](/[A-Za-z]+/)[0x0],_0x2e8ccc=parseInt(_0x2a9e28[_0x1e01e1(0x28a)](/\d+/)[0x0]);_0x44fc48[_0x716978][_0x1e01e1(0x293)]=_0x44f7f9,_0x44fc48[_0x716978][_0x1e01e1(0x200)]=_0x2e8ccc;}),_0x5146fa['forEach']((_0x543139,_0x34205c)=>{_0x44fc48[_0x34205c]['primary_code']=_0x543139;}),_0x1f3d23[_0x4f05f2(0x231)]((_0x2b8674,_0x2af370)=>{var _0x8d2f17=_0x4f05f2;_0x44fc48[_0x2af370][_0x8d2f17(0x25c)]=_0x2b8674;}),_0x1e510e['forEach']((_0x5f097c,_0x476bbd)=>{var _0x358cf5=_0x4f05f2;_0x44fc48[_0x476bbd][_0x358cf5(0x277)]=_0x5f097c;}),_0x21740a['forEach']((_0x5d43bb,_0x41c79b)=>{var _0x344f62=_0x4f05f2;_0x44fc48[_0x41c79b][_0x344f62(0x254)]=_0x5d43bb;}),_0x46ab3d['forEach']((_0x11ba61,_0x2954dd)=>{_0x44fc48[_0x2954dd]['unit']=_0x11ba61;}),_0x1eb2cc[_0x4f05f2(0x231)]((_0x282438,_0x385383)=>{var _0x54906f=_0x4f05f2;_0x44fc48[_0x385383][_0x54906f(0x26f)]=_0x282438;}),_0x455f4b[_0x4f05f2(0x231)]((_0xda183a,_0x40ade5)=>{var _0x510f18=_0x4f05f2;_0x44fc48[_0x40ade5][_0x510f18(0x248)]=_0xda183a;}),_0x2492b4[_0x4f05f2(0x231)]((_0x4f6c4a,_0x16433c)=>{var _0x58bf9f=_0x4f05f2;_0x44fc48[_0x16433c][_0x58bf9f(0x26d)]=_0x4f6c4a;}),_0x197a0c[_0x4f05f2(0x231)]((_0x412b7e,_0x3e25da)=>{var _0x168019=_0x4f05f2;_0x44fc48[_0x3e25da][_0x168019(0x23f)]=_0x412b7e;}),_0x2c0c5d['forEach']((_0x3dd72a,_0x111084)=>{var _0x469b43=_0x4f05f2;_0x44fc48[_0x111084][_0x469b43(0x254)]=_0x3dd72a;}),_0x5eecc9[_0x4f05f2(0x231)]((_0x4ab6e9,_0x295a7b)=>{var _0x39d0f3=_0x4f05f2;_0x44fc48[_0x295a7b][_0x39d0f3(0x1e0)]=_0x4ab6e9;}),_0x32294a[_0x4f05f2(0x231)]((_0x28aadb,_0x5c5b3b)=>{var _0x32d0eb=_0x4f05f2;_0x44fc48[_0x5c5b3b][_0x32d0eb(0x1ec)]=_0x28aadb;}),_0x1653aa[_0x4f05f2(0x231)]((_0x2be19e,_0x5380c6)=>{var _0x2a5bd5=_0x4f05f2;_0x44fc48[_0x5380c6][_0x2a5bd5(0x222)]=_0x2be19e;}),_0x5b3129[_0x4f05f2(0x231)]((_0x52db57,_0x51b308)=>{var _0x3997cc=_0x4f05f2;_0x44fc48[_0x51b308][_0x3997cc(0x286)]=_0x52db57;});const _0x184e25=_0x44fc48[_0x4f05f2(0x251)](_0x99128b=>_0x99128b[_0x4f05f2(0x1f8)]!=='0'&&_0x99128b[_0x4f05f2(0x1f8)]!==''||_0x99128b[_0x4f05f2(0x1f6)]!=='0'&&_0x99128b[_0x4f05f2(0x1f6)]!=='');var _0x312424=0x0;_0x184e25[_0x4f05f2(0x231)](_0x4c964c=>{var _0x306e47=_0x4f05f2;parseInt(_0x4c964c[_0x306e47(0x22e)])<parseInt(_0x4c964c['to_quantity'])&&_0x312424++;});if(_0x312424!=0x0)return _0x368f18[_0x4f05f2(0x1eb)](_0x4f05f2(0x1f2),_0x4f05f2(0x1f4)),_0xda074a[_0x4f05f2(0x226)]('back');const _0x3d3425=new transfers_logs();await _0x3d3425['save']();for(let _0x32e97c=0x0;_0x32e97c<=_0x5b3129['length']-0x1;_0x32e97c++){_0x44fc48[_0x32e97c]['To_invoice']=_0x4f05f2(0x264)+_0x3d3425[_0x4f05f2(0x26b)][_0x4f05f2(0x232)]()[_0x4f05f2(0x21a)](0x8,'0');}const _0x3e0355=new transfers_finished({'date':_0x7c430e,'from_warehouse':_0x6c7c3c,'to_warehouse':_0x6c7c3c,'product':_0x184e25,'note':_0x45e931,'invoice':_0x4f05f2(0x264)+_0x3d3425['invoice_init']['toString']()['padStart'](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x4f05f2(0x1ed),'PO_number':_0x493a0c,'RequestedBy':_0x5b8630,'DateofRequest':_0x3cf770,'typeservices':_0x11fb25,'destination':_0x141f80,'deliverydate':_0x5924eb,'driver':_0x4126d1,'plate':_0x4bcca6,'van':_0x45285d,'DRSI':_0x196333,'typevehicle':_0x48d1a6,'TSU':_0x2c1466,'TFU':_0x5af975}),_0x593f2f=await _0x3e0355['save']();_0x368f18[_0x4f05f2(0x1eb)](_0x4f05f2(0x212),_0x4f05f2(0x1ef)),_0xda074a[_0x4f05f2(0x226)]('/transfer_finished/preview/'+_0x593f2f[_0x4f05f2(0x1f9)]);}catch(_0xca6b73){console[_0x4f05f2(0x25a)](_0xca6b73),_0xda074a['status'](0xc8)['json']({'errorMessage':_0xca6b73[_0x4f05f2(0x271)]});}}),router[a0_0x400b8e(0x23b)]('/view/addlog',auth,async(_0xa33c64,_0x49beb6)=>{var _0x4c81d9=a0_0x400b8e;try{const {date:_0x2d115b,from_warehouse:_0x13025a,FromRoom_name:_0x2554d4,to_warehouse:_0x4309f2,ToRoom_name:_0x420c8,prod_name:_0x42071f,from_prod_qty:_0x291ade,from_prod_level:_0x4d9c5f,from_prod_isle:_0x1a50fc,from_prod_pallet:_0x8e54a0,to_prod_qty:_0x2e50c2,to_prod_level:_0x2eeec8,to_prod_isle:_0x23d11d,to_prod_pallet:_0x3e99c2,primary_code:_0x5df126,secondary_code:_0x3e9b85,product_code3:_0xef6e02,note:_0x4c24dc,MaxStocks_data2:_0x570a4e,invoice:_0x3753d9,expiry_date:_0x42b688,PO_number_loc:_0x1b504c,ReqBy_loc:_0x485a3a,dateofreq_loc:_0x3c6c4a,typeservices_loc_Data:_0x33c8ac,destination_loc:_0x254b03,deliverydate_loc:_0x253b2f,driver_loc:_0x4a8f99,plate_loc:_0x75c44a,van_loc:_0x45d2d9,DRSI_loc:_0x52033a,typevehicle_loc:_0x7bef8,TSU_loc:_0x583593,TFU_loc:_0x2910b0}=_0xa33c64[_0x4c81d9(0x284)];if(typeof _0x42071f==_0x4c81d9(0x28e))var _0xc58448=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x1fc)]],_0x291872=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x25d)]],_0x485808=[_0xa33c64[_0x4c81d9(0x284)]['from_prod_level2']],_0x5080e9=[_0xa33c64['body'][_0x4c81d9(0x27b)]],_0x142f29=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x258)]],_0xa4f300=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x274)]],_0x2de2d6=[_0xa33c64['body']['secondary_code']],_0x38d28f=[_0xa33c64['body'][_0x4c81d9(0x239)]],_0x32bcf6=[_0xa33c64['body'][_0x4c81d9(0x269)]],_0x1928bc=[_0xa33c64[_0x4c81d9(0x284)]['primary_unit']],_0x1208ce=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x26f)]],_0x117a26=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x248)]],_0x5ffeea=[_0xa33c64['body'][_0x4c81d9(0x26d)]],_0x52b7ab=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x256)]],_0x3424f2=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x29f)]],_0x547f53=[_0xa33c64[_0x4c81d9(0x284)]['maxPerUnit']],_0x1824b6=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x1ec)]],_0x3d6dd4=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x25f)]],_0x1c5164=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x216)]],_0x285cfb=[_0xa33c64['body'][_0x4c81d9(0x206)]],_0x3a0390=[_0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x29c)]];else var _0xc58448=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x1fc)]],_0x291872=[..._0xa33c64[_0x4c81d9(0x284)]['from_prod_qty']],_0x485808=[..._0xa33c64['body'][_0x4c81d9(0x1dc)]],_0x5080e9=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x27b)]],_0x142f29=[..._0xa33c64['body'][_0x4c81d9(0x258)]],_0xa4f300=[..._0xa33c64['body'][_0x4c81d9(0x274)]],_0x2de2d6=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x25c)]],_0x38d28f=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x239)]],_0x32bcf6=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x269)]],_0x1928bc=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x27a)]],_0x1208ce=[..._0xa33c64['body']['secondary_unit']],_0x117a26=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x248)]],_0x5ffeea=[..._0xa33c64['body'][_0x4c81d9(0x26d)]],_0x52b7ab=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x256)]],_0x3424f2=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x29f)]],_0x547f53=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x1e0)]],_0x1824b6=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x1ec)]],_0x3d6dd4=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x25f)]],_0x1c5164=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x216)]],_0x285cfb=[..._0xa33c64[_0x4c81d9(0x284)][_0x4c81d9(0x206)]],_0x3a0390=[..._0xa33c64['body'][_0x4c81d9(0x29c)]];const _0x106fb8=_0xc58448['map'](_0x378467=>{return _0x378467={'product_name':_0x378467};});_0x291872[_0x4c81d9(0x231)]((_0xae1d61,_0x361a65)=>{var _0x44a2d7=_0x4c81d9;_0x106fb8[_0x361a65][_0x44a2d7(0x22e)]=_0xae1d61;}),_0x485808['forEach']((_0x52421c,_0x331473)=>{var _0x315c47=_0x4c81d9,_0x506c9a=_0x52421c[_0x315c47(0x28a)](/[A-Za-z]+/)[0x0],_0x3d051a=parseInt(_0x52421c[_0x315c47(0x28a)](/\d+/)[0x0]);_0x106fb8[_0x331473]['from_bay']=_0x3d051a,_0x106fb8[_0x331473][_0x315c47(0x289)]=_0x506c9a;}),_0x3a0390['forEach']((_0x2098b2,_0x17ed67)=>{var _0x2cb3a5=_0x4c81d9;_0x106fb8[_0x17ed67][_0x2cb3a5(0x29c)]=_0x2098b2;}),_0x285cfb['forEach']((_0x1d8924,_0x279c19)=>{var _0x2d0342=_0x4c81d9;_0x106fb8[_0x279c19][_0x2d0342(0x206)]=_0x1d8924;}),_0x5080e9['forEach']((_0x217780,_0x59a173)=>{_0x106fb8[_0x59a173]['to_quantity']=_0x217780;}),_0x142f29[_0x4c81d9(0x231)]((_0x409697,_0x318a0c)=>{var _0x428945=_0x4c81d9,_0x3f65dc=_0x409697[_0x428945(0x28a)](/[A-Za-z]+/)[0x0],_0x595b4c=parseInt(_0x409697['match'](/\d+/)[0x0]);_0x106fb8[_0x318a0c][_0x428945(0x293)]=_0x3f65dc,_0x106fb8[_0x318a0c][_0x428945(0x200)]=_0x595b4c;}),_0xa4f300[_0x4c81d9(0x231)]((_0x26fe68,_0x34766b)=>{var _0x2155b9=_0x4c81d9;_0x106fb8[_0x34766b][_0x2155b9(0x274)]=_0x26fe68;}),_0x2de2d6[_0x4c81d9(0x231)]((_0x433cb7,_0x3efa93)=>{var _0x5c809e=_0x4c81d9;_0x106fb8[_0x3efa93][_0x5c809e(0x25c)]=_0x433cb7;}),_0x38d28f[_0x4c81d9(0x231)]((_0x1a538f,_0x44e464)=>{_0x106fb8[_0x44e464]['product_code']=_0x1a538f;}),_0x32bcf6[_0x4c81d9(0x231)]((_0x40697e,_0x22cc19)=>{var _0x1840bc=_0x4c81d9;_0x106fb8[_0x22cc19][_0x1840bc(0x254)]=_0x40697e;}),_0x1928bc[_0x4c81d9(0x231)]((_0x3b8ec6,_0x46b4b7)=>{var _0x25fb65=_0x4c81d9;_0x106fb8[_0x46b4b7][_0x25fb65(0x1ea)]=_0x3b8ec6;}),_0x1208ce[_0x4c81d9(0x231)]((_0x5ffe92,_0x13ddb3)=>{var _0x58fc9d=_0x4c81d9;_0x106fb8[_0x13ddb3][_0x58fc9d(0x26f)]=_0x5ffe92;}),_0x117a26[_0x4c81d9(0x231)]((_0x1703b5,_0x26a335)=>{var _0x195608=_0x4c81d9;_0x106fb8[_0x26a335][_0x195608(0x248)]=_0x1703b5;}),_0x5ffeea['forEach']((_0x1fd820,_0x440136)=>{_0x106fb8[_0x440136]['expiry_date']=_0x1fd820;}),_0x52b7ab[_0x4c81d9(0x231)]((_0x151563,_0x2de686)=>{var _0x14868d=_0x4c81d9;_0x106fb8[_0x2de686][_0x14868d(0x23f)]=_0x151563;}),_0x3424f2[_0x4c81d9(0x231)]((_0x188ce6,_0x46a8f8)=>{var _0x27094d=_0x4c81d9;_0x106fb8[_0x46a8f8][_0x27094d(0x254)]=_0x188ce6;}),_0x547f53[_0x4c81d9(0x231)]((_0x338ec2,_0x4ef539)=>{var _0x25cc34=_0x4c81d9;_0x106fb8[_0x4ef539][_0x25cc34(0x1e0)]=_0x338ec2;}),_0x1824b6['forEach']((_0x2bbcd0,_0x489dc9)=>{_0x106fb8[_0x489dc9]['prod_cat']=_0x2bbcd0;}),_0x3d6dd4[_0x4c81d9(0x231)]((_0x5943df,_0x3d1113)=>{var _0x23c8e0=_0x4c81d9;_0x106fb8[_0x3d1113][_0x23c8e0(0x222)]=_0x5943df;}),_0x1c5164[_0x4c81d9(0x231)]((_0x590681,_0x22f7a5)=>{var _0x2d57cc=_0x4c81d9;_0x106fb8[_0x22f7a5][_0x2d57cc(0x286)]=_0x590681;});const _0x736599=_0x106fb8[_0x4c81d9(0x251)](_0x9224c9=>_0x9224c9[_0x4c81d9(0x1f8)]!=='0'&&_0x9224c9[_0x4c81d9(0x1f8)]!==''||_0x9224c9[_0x4c81d9(0x1f6)]!=='0'&&_0x9224c9[_0x4c81d9(0x1f6)]!=='');var _0x209ac5=0x0;_0x736599['forEach'](_0x554e7a=>{var _0x45921b=_0x4c81d9;parseInt(_0x554e7a[_0x45921b(0x22e)])<parseInt(_0x554e7a[_0x45921b(0x1f8)])&&_0x209ac5++;});if(_0x209ac5!=0x0)return _0xa33c64[_0x4c81d9(0x1eb)]('errors',_0x4c81d9(0x1f4)),_0x49beb6[_0x4c81d9(0x226)](_0x4c81d9(0x234));const _0x3c7472=new transfers_logs();await _0x3c7472[_0x4c81d9(0x1e4)]();for(let _0x520a30=0x0;_0x520a30<=_0x1c5164[_0x4c81d9(0x20d)]-0x1;_0x520a30++){_0x106fb8[_0x520a30][_0x4c81d9(0x1fb)]=_0x4c81d9(0x264)+_0x3c7472[_0x4c81d9(0x26b)][_0x4c81d9(0x232)]()[_0x4c81d9(0x21a)](0x8,'0');}const _0x441e85=new transfers_finished({'date':_0x2d115b,'from_warehouse':_0x13025a,'to_warehouse':_0x4309f2,'product':_0x736599,'note':_0x4c24dc,'invoice':_0x4c81d9(0x264)+_0x3c7472[_0x4c81d9(0x26b)]['toString']()[_0x4c81d9(0x21a)](0x8,'0'),'type_of_transaction':_0x4c81d9(0x1ed),'type_of_process':_0x4c81d9(0x1ff),'PO_number':_0x1b504c,'RequestedBy':_0x485a3a,'DateofRequest':_0x3c6c4a,'typeservices':_0x33c8ac,'destination':_0x254b03,'deliverydate':_0x253b2f,'driver':_0x4a8f99,'plate':_0x75c44a,'van':_0x45d2d9,'DRSI':_0x52033a,'typevehicle':_0x7bef8,'TSU':_0x583593,'TFU':_0x2910b0}),_0x39fb30=await _0x441e85[_0x4c81d9(0x1e4)]();_0xa33c64['flash'](_0x4c81d9(0x212),_0x4c81d9(0x1ef)),_0x49beb6['redirect'](_0x4c81d9(0x225)+_0x39fb30[_0x4c81d9(0x1f9)]);}catch(_0x5b4839){console['log'](_0x5b4839),_0x49beb6[_0x4c81d9(0x211)](0xc8)['json']({'errorMessage':_0x5b4839[_0x4c81d9(0x271)]});}}),router['post'](a0_0x400b8e(0x1d9),auth,async(_0x17aa5e,_0x23dce1)=>{var _0x162fc6=a0_0x400b8e;try{const {date:_0x2a9246,from_warehouse:_0x30d132,FromRoom_name:_0x10aa2d,to_warehouse:_0x8ec0b4,ToRoom_name:_0x14ede5,prod_name:_0x5c62d6,from_prod_qty:_0x15d763,from_prod_level:_0x5a4f7b,from_prod_isle:_0x3d46dc,from_prod_pallet:_0x2e8751,to_prod_qty:_0x20c7dc,to_prod_level:_0x2fa3a5,to_prod_isle:_0x60ca1,to_prod_pallet:_0x463a2c,primary_code:_0x4eec1f,secondary_code:_0x118e93,product_code3:_0x3113a8,note:_0x204a97,MaxStocks_data2:_0x238bcc,invoice:_0x45ea15,expiry_date:_0x13f8a7,PO_number:_0x220968,ReqBy:_0x56f1e5,dateofreq:_0x415113,typeservicesData:_0xb646d,destination:_0x4b12d5,deliverydate:_0x47a893,driver:_0x17191a,plate:_0x3f94db,van:_0x3d8baf,DRSI:_0x2c9fa2,typevehicle:_0x4f023c,TSU:_0x5d00a3,TFU:_0x3326f4}=_0x17aa5e[_0x162fc6(0x284)];if(typeof _0x5c62d6==_0x162fc6(0x28e))var _0x2727cc=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x1fc)]],_0x27190e=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x25d)]],_0x1c1dfc=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x1dc)]],_0x364ff8=[_0x17aa5e['body']['New_Qty_Converted']],_0x197823=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x258)]],_0x200636=[_0x17aa5e['body'][_0x162fc6(0x274)]],_0x481220=[_0x17aa5e[_0x162fc6(0x284)]['secondary_code']],_0x31c8b2=[_0x17aa5e['body'][_0x162fc6(0x239)]],_0x1c7a05=[_0x17aa5e['body'][_0x162fc6(0x269)]],_0xd0aa18=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x27a)]],_0x329640=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x26f)]],_0x2a4c43=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x248)]],_0x125e8b=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x26d)]],_0x8ff469=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x256)]],_0x2b43f5=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x29f)]],_0x2f7083=[_0x17aa5e['body'][_0x162fc6(0x1e0)]],_0x303e7f=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x1ec)]],_0x5a0b58=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x25f)]],_0x37a433=[_0x17aa5e['body'][_0x162fc6(0x216)]],_0x475a2e=[_0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x206)]],_0x3822e5=[_0x17aa5e['body'][_0x162fc6(0x29c)]];else var _0x2727cc=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x1fc)]],_0x27190e=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x25d)]],_0x1c1dfc=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x1dc)]],_0x364ff8=[..._0x17aa5e['body'][_0x162fc6(0x27b)]],_0x197823=[..._0x17aa5e['body']['to_prod_level']],_0x200636=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x274)]],_0x481220=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x25c)]],_0x31c8b2=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x239)]],_0x1c7a05=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x269)]],_0xd0aa18=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x27a)]],_0x329640=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x26f)]],_0x2a4c43=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x248)]],_0x125e8b=[..._0x17aa5e[_0x162fc6(0x284)]['expiry_date']],_0x8ff469=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x256)]],_0x2b43f5=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x29f)]],_0x2f7083=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x1e0)]],_0x303e7f=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x1ec)]],_0x5a0b58=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x25f)]],_0x37a433=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x216)]],_0x475a2e=[..._0x17aa5e[_0x162fc6(0x284)]['from_invoice']],_0x3822e5=[..._0x17aa5e[_0x162fc6(0x284)][_0x162fc6(0x29c)]];const _0x3a3da2=_0x2727cc['map'](_0x238f8b=>{return _0x238f8b={'product_name':_0x238f8b};});_0x27190e['forEach']((_0x40f1f6,_0x5c3d1e)=>{var _0x1d8c16=_0x162fc6;_0x3a3da2[_0x5c3d1e][_0x1d8c16(0x22e)]=_0x40f1f6;}),_0x1c1dfc[_0x162fc6(0x231)]((_0x34f616,_0x5d25f6)=>{var _0x314e42=_0x162fc6,_0x355f2f=_0x34f616[_0x314e42(0x28a)](/[A-Za-z]+/)[0x0],_0x374bcf=parseInt(_0x34f616['match'](/\d+/)[0x0]);_0x3a3da2[_0x5d25f6]['from_bay']=_0x374bcf,_0x3a3da2[_0x5d25f6][_0x314e42(0x289)]=_0x355f2f;}),_0x3822e5[_0x162fc6(0x231)]((_0x1b4984,_0x5c5968)=>{_0x3a3da2[_0x5c5968]['id_transaction']=_0x1b4984;}),_0x475a2e[_0x162fc6(0x231)]((_0x582f2b,_0x2e694a)=>{var _0x5768f9=_0x162fc6;_0x3a3da2[_0x2e694a][_0x5768f9(0x206)]=_0x582f2b;}),_0x364ff8[_0x162fc6(0x231)]((_0x5aa3c2,_0x435d97)=>{_0x3a3da2[_0x435d97]['to_quantity']=_0x5aa3c2;}),_0x197823['forEach']((_0x31ccfc,_0x82ae7b)=>{var _0x1e6bc6=_0x162fc6,_0x47ce7b=_0x31ccfc[_0x1e6bc6(0x28a)](/[A-Za-z]+/)[0x0],_0x371074=parseInt(_0x31ccfc['match'](/\d+/)[0x0]);_0x3a3da2[_0x82ae7b]['to_level']=_0x47ce7b,_0x3a3da2[_0x82ae7b][_0x1e6bc6(0x200)]=_0x371074;}),_0x200636['forEach']((_0x2418e0,_0x6ad95e)=>{var _0x497e37=_0x162fc6;_0x3a3da2[_0x6ad95e][_0x497e37(0x274)]=_0x2418e0;}),_0x481220['forEach']((_0x17e123,_0x1a7562)=>{_0x3a3da2[_0x1a7562]['secondary_code']=_0x17e123;}),_0x31c8b2[_0x162fc6(0x231)]((_0x571502,_0x4b182a)=>{var _0x162590=_0x162fc6;_0x3a3da2[_0x4b182a][_0x162590(0x277)]=_0x571502;}),_0x1c7a05[_0x162fc6(0x231)]((_0x2c8cac,_0x52ee80)=>{_0x3a3da2[_0x52ee80]['maxProducts']=_0x2c8cac;}),_0xd0aa18[_0x162fc6(0x231)]((_0x372e7b,_0x327905)=>{var _0x3612ba=_0x162fc6;_0x3a3da2[_0x327905][_0x3612ba(0x1ea)]=_0x372e7b;}),_0x329640[_0x162fc6(0x231)]((_0x42dc26,_0x531b81)=>{var _0x4b01e0=_0x162fc6;_0x3a3da2[_0x531b81][_0x4b01e0(0x26f)]=_0x42dc26;}),_0x2a4c43[_0x162fc6(0x231)]((_0xa8823,_0x5c00e9)=>{var _0x2ec41d=_0x162fc6;_0x3a3da2[_0x5c00e9][_0x2ec41d(0x248)]=_0xa8823;}),_0x125e8b['forEach']((_0x23dba6,_0x1b0361)=>{var _0x48dc0f=_0x162fc6;_0x3a3da2[_0x1b0361][_0x48dc0f(0x26d)]=_0x23dba6;}),_0x8ff469[_0x162fc6(0x231)]((_0x4a7aa2,_0x1a6660)=>{var _0x3e1ff5=_0x162fc6;_0x3a3da2[_0x1a6660][_0x3e1ff5(0x23f)]=_0x4a7aa2;}),_0x2b43f5[_0x162fc6(0x231)]((_0x557feb,_0x52d182)=>{var _0x335463=_0x162fc6;_0x3a3da2[_0x52d182][_0x335463(0x254)]=_0x557feb;}),_0x2f7083[_0x162fc6(0x231)]((_0x2fe2ac,_0x49b741)=>{_0x3a3da2[_0x49b741]['maxPerUnit']=_0x2fe2ac;}),_0x303e7f[_0x162fc6(0x231)]((_0x7560aa,_0x430735)=>{var _0x1fbdbf=_0x162fc6;_0x3a3da2[_0x430735][_0x1fbdbf(0x1ec)]=_0x7560aa;}),_0x5a0b58[_0x162fc6(0x231)]((_0x45bb3d,_0x1c48b7)=>{var _0x114562=_0x162fc6;_0x3a3da2[_0x1c48b7][_0x114562(0x222)]=_0x45bb3d;}),_0x37a433['forEach']((_0x475c52,_0x3bb41a)=>{var _0x1d33f7=_0x162fc6;_0x3a3da2[_0x3bb41a][_0x1d33f7(0x286)]=_0x475c52;});const _0x46e92f=_0x3a3da2[_0x162fc6(0x251)](_0x5f5cb4=>_0x5f5cb4[_0x162fc6(0x1f8)]!=='0'&&_0x5f5cb4[_0x162fc6(0x1f8)]!==''||_0x5f5cb4['to_floorlevel']!=='0'&&_0x5f5cb4[_0x162fc6(0x1f6)]!=='');var _0x1b890c=0x0;_0x46e92f['forEach'](_0x3b7afd=>{parseInt(_0x3b7afd['from_quantity'])<parseInt(_0x3b7afd['to_quantity'])&&_0x1b890c++;});if(_0x1b890c!=0x0)return _0x17aa5e[_0x162fc6(0x1eb)](_0x162fc6(0x1f2),_0x162fc6(0x1f4)),_0x23dce1['redirect']('back');const _0x3b1bb9=new invoice_for_transfer();await _0x3b1bb9[_0x162fc6(0x1e4)]();for(let _0x669848=0x0;_0x669848<=_0x37a433[_0x162fc6(0x20d)]-0x1;_0x669848++){_0x3a3da2[_0x669848][_0x162fc6(0x1fb)]=_0x162fc6(0x243)+_0x3b1bb9[_0x162fc6(0x26b)]['toString']()[_0x162fc6(0x21a)](0x8,'0');}const _0xf0f754=new transfers_finished({'date':_0x2a9246,'from_warehouse':_0x30d132,'to_warehouse':_0x30d132,'product':_0x46e92f,'note':_0x204a97,'invoice':_0x162fc6(0x243)+_0x3b1bb9[_0x162fc6(0x26b)][_0x162fc6(0x232)]()[_0x162fc6(0x21a)](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':'own','PO_number':_0x220968,'RequestedBy':_0x56f1e5,'DateofRequest':_0x415113,'typeservices':_0xb646d,'destination':_0x4b12d5,'deliverydate':_0x47a893,'driver':_0x17191a,'plate':_0x3f94db,'van':_0x3d8baf,'DRSI':_0x2c9fa2,'typevehicle':_0x4f023c,'TSU':_0x5d00a3,'TFU':_0x3326f4}),_0x10fc6d=await _0xf0f754['save']();_0x17aa5e['flash']('success',_0x162fc6(0x1ef)),_0x23dce1[_0x162fc6(0x226)](_0x162fc6(0x225)+_0x10fc6d['_id']);}catch(_0x2c559c){console[_0x162fc6(0x25a)](_0x2c559c),_0x23dce1[_0x162fc6(0x211)](0xc8)[_0x162fc6(0x217)]({'errorMessage':_0x2c559c[_0x162fc6(0x271)]});}}),router[a0_0x400b8e(0x23b)](a0_0x400b8e(0x255),auth,async(_0x1eeec7,_0xe8e4b2)=>{var _0x1af64a=a0_0x400b8e;try{const {date:_0x2da522,from_warehouse:_0x1c5872,FromRoom_name:_0x5933f1,to_warehouse:_0x133ff3,ToRoom_name:_0x27f2b4,prod_name:_0x5a3349,from_prod_qty:_0x12559f,from_prod_level:_0x427cf7,from_prod_isle:_0x4218fc,from_prod_pallet:_0x21ad48,to_prod_qty:_0x1e3653,to_prod_level:_0x14e1b3,to_prod_isle:_0x42e2da,to_prod_pallet:_0x59bb66,primary_code:_0x534ff6,secondary_code:_0x1f373a,product_code3:_0x4b93ac,note:_0x184755,MaxStocks_data2:_0x457edc,invoice:_0x23e878,expiry_date:_0x29ded6,PO_number_loc:_0x376643,ReqBy_loc:_0x28661c,dateofreq_loc:_0x2f9908,typeservices_loc_Data:_0x227648,destination_loc:_0x41cf35,deliverydate_loc:_0x49c61f,driver_loc:_0x41de9c,plate_loc:_0x36a3e2,van_loc:_0x3d4e50,DRSI_loc:_0x28fb97,typevehicle_loc:_0x3bcefc,TSU_loc:_0x164e01,TFU_loc:_0x2eb739}=_0x1eeec7[_0x1af64a(0x284)];if(typeof _0x5a3349==_0x1af64a(0x28e))var _0x3562e2=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x1fc)]],_0x4913f0=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x25d)]],_0x1cd74c=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x1dc)]],_0x11e7b7=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x27b)]],_0x56526a=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x258)]],_0x35a2be=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x274)]],_0x2f6ba8=[_0x1eeec7[_0x1af64a(0x284)]['secondary_code']],_0x18be99=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x239)]],_0x52537c=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x269)]],_0x2da083=[_0x1eeec7['body'][_0x1af64a(0x27a)]],_0x367ca2=[_0x1eeec7['body'][_0x1af64a(0x26f)]],_0x2f1ac3=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x248)]],_0xf24a34=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x26d)]],_0x18dbc7=[_0x1eeec7[_0x1af64a(0x284)]['product_date']],_0x4f1535=[_0x1eeec7[_0x1af64a(0x284)]['MaxStocks_data']],_0x3ea11=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x1e0)]],_0x160e79=[_0x1eeec7['body'][_0x1af64a(0x1ec)]],_0x47f07f=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x25f)]],_0x169142=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x216)]],_0x56e973=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x206)]],_0x209085=[_0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x29c)]];else var _0x3562e2=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x1fc)]],_0x4913f0=[..._0x1eeec7['body']['from_prod_qty']],_0x1cd74c=[..._0x1eeec7[_0x1af64a(0x284)]['from_prod_level2']],_0x11e7b7=[..._0x1eeec7['body'][_0x1af64a(0x27b)]],_0x56526a=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x258)]],_0x35a2be=[..._0x1eeec7[_0x1af64a(0x284)]['primary_code']],_0x2f6ba8=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x25c)]],_0x18be99=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x239)]],_0x52537c=[..._0x1eeec7['body'][_0x1af64a(0x269)]],_0x2da083=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x27a)]],_0x367ca2=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x26f)]],_0x2f1ac3=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x248)]],_0xf24a34=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x26d)]],_0x18dbc7=[..._0x1eeec7['body'][_0x1af64a(0x256)]],_0x4f1535=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x29f)]],_0x3ea11=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x1e0)]],_0x160e79=[..._0x1eeec7['body'][_0x1af64a(0x1ec)]],_0x47f07f=[..._0x1eeec7['body'][_0x1af64a(0x25f)]],_0x169142=[..._0x1eeec7[_0x1af64a(0x284)]['ToRoomAssigned']],_0x56e973=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x206)]],_0x209085=[..._0x1eeec7[_0x1af64a(0x284)][_0x1af64a(0x29c)]];const _0x502434=_0x3562e2[_0x1af64a(0x272)](_0x4c5649=>{return _0x4c5649={'product_name':_0x4c5649};});_0x4913f0[_0x1af64a(0x231)]((_0x5496a9,_0x384e1c)=>{var _0x583141=_0x1af64a;_0x502434[_0x384e1c][_0x583141(0x22e)]=_0x5496a9;}),_0x1cd74c[_0x1af64a(0x231)]((_0x1d501d,_0x27c336)=>{var _0x27f392=_0x1af64a,_0x3524b9=_0x1d501d[_0x27f392(0x28a)](/[A-Za-z]+/)[0x0],_0x43c4b3=parseInt(_0x1d501d[_0x27f392(0x28a)](/\d+/)[0x0]);_0x502434[_0x27c336]['from_bay']=_0x43c4b3,_0x502434[_0x27c336][_0x27f392(0x289)]=_0x3524b9;}),_0x209085[_0x1af64a(0x231)]((_0x509051,_0x48bb78)=>{var _0x37c13c=_0x1af64a;_0x502434[_0x48bb78][_0x37c13c(0x29c)]=_0x509051;}),_0x56e973[_0x1af64a(0x231)]((_0x59f6d8,_0x1c6007)=>{var _0xe221e1=_0x1af64a;_0x502434[_0x1c6007][_0xe221e1(0x206)]=_0x59f6d8;}),_0x11e7b7['forEach']((_0x5ca5bd,_0x3f6466)=>{var _0x384cdb=_0x1af64a;_0x502434[_0x3f6466][_0x384cdb(0x1f8)]=_0x5ca5bd;}),_0x56526a[_0x1af64a(0x231)]((_0x489872,_0x9f52c8)=>{var _0x4ca75f=_0x1af64a,_0x4d85d7=_0x489872['match'](/[A-Za-z]+/)[0x0],_0x4c05b9=parseInt(_0x489872[_0x4ca75f(0x28a)](/\d+/)[0x0]);_0x502434[_0x9f52c8][_0x4ca75f(0x293)]=_0x4d85d7,_0x502434[_0x9f52c8][_0x4ca75f(0x200)]=_0x4c05b9;}),_0x35a2be[_0x1af64a(0x231)]((_0x1bec65,_0x58e7a0)=>{var _0x5083e1=_0x1af64a;_0x502434[_0x58e7a0][_0x5083e1(0x274)]=_0x1bec65;}),_0x2f6ba8[_0x1af64a(0x231)]((_0x492c80,_0x3bb701)=>{var _0x92c539=_0x1af64a;_0x502434[_0x3bb701][_0x92c539(0x25c)]=_0x492c80;}),_0x18be99[_0x1af64a(0x231)]((_0x424ef2,_0x351abb)=>{_0x502434[_0x351abb]['product_code']=_0x424ef2;}),_0x52537c[_0x1af64a(0x231)]((_0x4c3f53,_0x20ac27)=>{var _0x2758c4=_0x1af64a;_0x502434[_0x20ac27][_0x2758c4(0x254)]=_0x4c3f53;}),_0x2da083[_0x1af64a(0x231)]((_0x436fe2,_0x7c9597)=>{_0x502434[_0x7c9597]['unit']=_0x436fe2;}),_0x367ca2['forEach']((_0x708742,_0x329188)=>{var _0x38b1f1=_0x1af64a;_0x502434[_0x329188][_0x38b1f1(0x26f)]=_0x708742;}),_0x2f1ac3[_0x1af64a(0x231)]((_0x17d45e,_0x28185e)=>{_0x502434[_0x28185e]['batch_code']=_0x17d45e;}),_0xf24a34['forEach']((_0x52884d,_0x4cdf39)=>{var _0x9f226a=_0x1af64a;_0x502434[_0x4cdf39][_0x9f226a(0x26d)]=_0x52884d;}),_0x18dbc7['forEach']((_0x25e737,_0x733e67)=>{var _0x5ef3fb=_0x1af64a;_0x502434[_0x733e67][_0x5ef3fb(0x23f)]=_0x25e737;}),_0x4f1535[_0x1af64a(0x231)]((_0x6c3ce5,_0x365aba)=>{var _0x370533=_0x1af64a;_0x502434[_0x365aba][_0x370533(0x254)]=_0x6c3ce5;}),_0x3ea11[_0x1af64a(0x231)]((_0x1fb7fc,_0x22cf85)=>{var _0x34aa9c=_0x1af64a;_0x502434[_0x22cf85][_0x34aa9c(0x1e0)]=_0x1fb7fc;}),_0x160e79[_0x1af64a(0x231)]((_0x3f0362,_0x20dbb0)=>{var _0x5f5672=_0x1af64a;_0x502434[_0x20dbb0][_0x5f5672(0x1ec)]=_0x3f0362;}),_0x47f07f[_0x1af64a(0x231)]((_0x4695d2,_0x1d87a0)=>{var _0x21fab5=_0x1af64a;_0x502434[_0x1d87a0][_0x21fab5(0x222)]=_0x4695d2;}),_0x169142['forEach']((_0x43a2f3,_0x4b3d78)=>{var _0x2152d1=_0x1af64a;_0x502434[_0x4b3d78][_0x2152d1(0x286)]=_0x43a2f3;});const _0x11e062=_0x502434[_0x1af64a(0x251)](_0x323ce4=>_0x323ce4[_0x1af64a(0x1f8)]!=='0'&&_0x323ce4[_0x1af64a(0x1f8)]!==''||_0x323ce4[_0x1af64a(0x1f6)]!=='0'&&_0x323ce4[_0x1af64a(0x1f6)]!=='');var _0x2c0dd5=0x0;_0x11e062['forEach'](_0x306dd0=>{var _0x33dcd7=_0x1af64a;parseInt(_0x306dd0[_0x33dcd7(0x22e)])<parseInt(_0x306dd0[_0x33dcd7(0x1f8)])&&_0x2c0dd5++;});if(_0x2c0dd5!=0x0)return _0x1eeec7[_0x1af64a(0x1eb)](_0x1af64a(0x1f2),_0x1af64a(0x1f4)),_0xe8e4b2[_0x1af64a(0x226)]('back');const _0x27f5ab=new invoice_for_transfer();await _0x27f5ab[_0x1af64a(0x1e4)]();for(let _0x241e40=0x0;_0x241e40<=_0x169142['length']-0x1;_0x241e40++){_0x502434[_0x241e40][_0x1af64a(0x1fb)]='TRF-'+_0x27f5ab[_0x1af64a(0x26b)][_0x1af64a(0x232)]()[_0x1af64a(0x21a)](0x8,'0');}const _0x52a525=new transfers_finished({'date':_0x2da522,'from_warehouse':_0x1c5872,'to_warehouse':_0x133ff3,'product':_0x11e062,'note':_0x184755,'invoice':'TRF-'+_0x27f5ab[_0x1af64a(0x26b)][_0x1af64a(0x232)]()[_0x1af64a(0x21a)](0x8,'0'),'type_of_transaction':_0x1af64a(0x1e1),'type_of_process':_0x1af64a(0x1ff),'PO_number':_0x376643,'RequestedBy':_0x28661c,'DateofRequest':_0x2f9908,'typeservices':_0x227648,'destination':_0x41cf35,'deliverydate':_0x49c61f,'driver':_0x41de9c,'plate':_0x36a3e2,'van':_0x3d4e50,'DRSI':_0x28fb97,'typevehicle':_0x3bcefc,'TSU':_0x164e01,'TFU':_0x2eb739}),_0x4324a4=await _0x52a525[_0x1af64a(0x1e4)]();_0x1eeec7['flash']('success',_0x1af64a(0x1ef)),_0xe8e4b2[_0x1af64a(0x226)]('/transfer_finished/preview/'+_0x4324a4[_0x1af64a(0x1f9)]);}catch(_0x509ca7){console['log'](_0x509ca7),_0xe8e4b2[_0x1af64a(0x211)](0xc8)[_0x1af64a(0x217)]({'errorMessage':_0x509ca7[_0x1af64a(0x271)]});}}),router[a0_0x400b8e(0x24d)](a0_0x400b8e(0x270),auth,async(_0x67e92a,_0x16662a)=>{var _0xbcacc2=a0_0x400b8e;try{const {username:_0x2c428b,email:_0x246a77,role:_0x58981d}=_0x67e92a[_0xbcacc2(0x287)],_0x22cdb2=_0x67e92a['user'],_0x142fa8=await profile[_0xbcacc2(0x281)]({'email':_0x22cdb2[_0xbcacc2(0x290)]}),_0x28b565=await master_shop['find'](),_0x4630dc=await transfers_finished['findById'](_0x67e92a[_0xbcacc2(0x261)]['id']);let _0x2ae82f;if(_0x22cdb2['role']=='staff'){const _0x22ff49=await staff[_0xbcacc2(0x281)]({'email':_0x22cdb2['email']});_0x2ae82f=await warehouse['find']({'status':_0xbcacc2(0x240),'name':_0x22ff49['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x2ae82f=await warehouse['find']({'status':_0xbcacc2(0x240),'warehouse_category':'Finished\x20Goods'});const _0x4a31aa=await warehouse[_0xbcacc2(0x1d8)]([{'$match':{'name':_0x4630dc[_0xbcacc2(0x221)],'warehouse_category':_0xbcacc2(0x1e3)}},{'$unwind':_0xbcacc2(0x23a)},{'$group':{'_id':_0xbcacc2(0x252),'name':{'$first':_0xbcacc2(0x22d)},'product_stock':{'$first':_0xbcacc2(0x259)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xbcacc2(0x241)},'floorlevel':{'$first':_0xbcacc2(0x23d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xbcacc2(0x280)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xbcacc2(0x1f1)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0xbcacc2(0x229)},'warehoue_name':{'$first':_0xbcacc2(0x25e)}}}]),_0x3de290=await product['find']({});if(_0x28b565[0x0]['language']==_0xbcacc2(0x1e7)){var _0x38f211=users['English'];console[_0xbcacc2(0x25a)](_0x38f211);}else{if(_0x28b565[0x0]['language']=='Hindi')var _0x38f211=users[_0xbcacc2(0x27f)];else{if(_0x28b565[0x0][_0xbcacc2(0x224)]=='German')var _0x38f211=users[_0xbcacc2(0x1e9)];else{if(_0x28b565[0x0][_0xbcacc2(0x224)]==_0xbcacc2(0x263))var _0x38f211=users[_0xbcacc2(0x263)];else{if(_0x28b565[0x0][_0xbcacc2(0x224)]==_0xbcacc2(0x288))var _0x38f211=users[_0xbcacc2(0x288)];else{if(_0x28b565[0x0][_0xbcacc2(0x224)]==_0xbcacc2(0x22f))var _0x38f211=users[_0xbcacc2(0x291)];else{if(_0x28b565[0x0][_0xbcacc2(0x224)]=='Chinese')var _0x38f211=users[_0xbcacc2(0x1f7)];else{if(_0x28b565[0x0][_0xbcacc2(0x224)]==_0xbcacc2(0x219))var _0x38f211=users[_0xbcacc2(0x1ee)];}}}}}}}_0x16662a[_0xbcacc2(0x28c)](_0xbcacc2(0x214),{'success':_0x67e92a[_0xbcacc2(0x1eb)](_0xbcacc2(0x212)),'errors':_0x67e92a[_0xbcacc2(0x1eb)](_0xbcacc2(0x1f2)),'role':_0x22cdb2,'profile':_0x142fa8,'master_shop':_0x28b565,'warehouse':_0x2ae82f,'transfer':_0x4630dc,'stock':_0x4a31aa,'unit':_0x3de290,'language':_0x38f211});}catch(_0x19c553){console[_0xbcacc2(0x25a)](_0x19c553);}}),router[a0_0x400b8e(0x23b)]('/preview/:id',auth,async(_0x3a9726,_0x3e7572)=>{var _0x115dfa=a0_0x400b8e;try{const {invoice:_0x1308d9,from_warehouse:_0x4498cf,FromRoom_name:_0x9fa291,to_warehouse:_0x57ff38,ToRoom_name:_0x1e2454}=_0x3a9726[_0x115dfa(0x284)],_0x5d5eb1=await transfers_finished[_0x115dfa(0x213)](_0x3a9726[_0x115dfa(0x261)]['id']),_0x4b22fa=_0x5d5eb1['product'][_0x115dfa(0x272)](async _0x32eea6=>{var _0x34a43a=_0x115dfa;if(_0x32eea6['to_quantity']>0x0){var _0x3d9c60=await warehouse[_0x34a43a(0x281)]({'name':_0x4498cf,'room':_0x32eea6[_0x34a43a(0x222)]});const _0x13a034=_0x3d9c60[_0x34a43a(0x28f)][_0x34a43a(0x272)](_0x48cbdb=>{var _0x423d1b=_0x34a43a;_0x48cbdb[_0x423d1b(0x1f9)]==_0x32eea6[_0x423d1b(0x29c)]&&(_0x48cbdb[_0x423d1b(0x278)]=Math[_0x423d1b(0x24f)](0x0,Math['abs'](_0x48cbdb[_0x423d1b(0x278)])-Math[_0x423d1b(0x265)](_0x32eea6[_0x423d1b(0x1f8)])),console[_0x423d1b(0x25a)](_0x48cbdb[_0x423d1b(0x278)]));});}return _0x3d9c60;});Promise[_0x115dfa(0x273)](_0x4b22fa)[_0x115dfa(0x1df)](async _0x2637ee=>{var _0x102237=_0x115dfa;try{for(const _0x556394 of _0x2637ee){await _0x556394['save']();}const _0x13a216=_0x5d5eb1['product'][_0x102237(0x272)](async _0x45ff35=>{var _0x4d9182=_0x102237,_0x2bcc59=await warehouse[_0x4d9182(0x281)]({'name':_0x57ff38,'room':_0x45ff35[_0x4d9182(0x286)]});if(_0x45ff35[_0x4d9182(0x1f8)]>0x0){var _0xf7747a=0x0;const _0x1b3558=_0x2bcc59[_0x4d9182(0x28f)][_0x4d9182(0x272)](_0x36bb74=>{var _0x41e989=_0x4d9182;_0x36bb74[_0x41e989(0x297)]==_0x45ff35[_0x41e989(0x297)]&&_0x36bb74[_0x41e989(0x279)]==_0x45ff35[_0x41e989(0x200)]&&_0x36bb74[_0x41e989(0x26d)]==_0x45ff35['expiry_date']&&_0x36bb74[_0x41e989(0x23f)]==_0x45ff35[_0x41e989(0x23f)]&&_0x36bb74[_0x41e989(0x248)]==_0x45ff35[_0x41e989(0x248)]&&_0x36bb74[_0x41e989(0x1f0)]==_0x45ff35[_0x41e989(0x1fb)]&&(typeof _0x45ff35[_0x41e989(0x29c)]==_0x41e989(0x283)?(console['log']('here2',_0x36bb74[_0x41e989(0x278)]+_0x41e989(0x29e)+_0x36bb74[_0x41e989(0x1f9)]+_0x41e989(0x247)+Math['abs'](_0x36bb74['product_stock'])+Math['abs'](_0x45ff35[_0x41e989(0x1f8)])),_0x36bb74['product_stock']=Math[_0x41e989(0x265)](_0x36bb74['product_stock'])+Math[_0x41e989(0x265)](_0x45ff35[_0x41e989(0x1f8)])):_0x36bb74[_0x41e989(0x278)]=Math[_0x41e989(0x265)](_0x36bb74['product_stock'])+Math['abs'](_0x45ff35[_0x41e989(0x1f8)]),_0xf7747a++);});_0xf7747a=='0'&&(_0x2bcc59['product_details']=_0x2bcc59['product_details'][_0x4d9182(0x223)]({'product_name':_0x45ff35[_0x4d9182(0x297)],'product_stock':_0x45ff35['to_quantity'],'bay':_0x45ff35[_0x4d9182(0x200)],'level':_0x45ff35[_0x4d9182(0x293)],'product_code':_0x45ff35[_0x4d9182(0x277)],'primary_code':_0x45ff35[_0x4d9182(0x274)],'secondary_code':_0x45ff35[_0x4d9182(0x25c)],'expiry_date':_0x45ff35[_0x4d9182(0x26d)],'production_date':_0x45ff35[_0x4d9182(0x23f)],'maxProducts':_0x45ff35['maxProducts'],'batch_code':_0x45ff35[_0x4d9182(0x248)],'secondary_unit':_0x45ff35[_0x4d9182(0x26f)],'unit':_0x45ff35[_0x4d9182(0x1ea)],'maxProducts':_0x45ff35[_0x4d9182(0x254)],'maxPerUnit':_0x45ff35[_0x4d9182(0x1e0)],'invoice':_0x45ff35[_0x4d9182(0x1fb)]}));}return _0x2bcc59;});Promise[_0x102237(0x273)](_0x13a216)['then'](async _0x3baf82=>{var _0x3cb9c5=_0x102237;try{console['log'](_0x5d5eb1['type_of_process']);if(_0x5d5eb1[_0x3cb9c5(0x210)]!=_0x3cb9c5(0x1ff))for(const _0x45d99a of _0x3baf82){await warehouse['updateOne']({'_id':_0x45d99a['_id']},{'$addToSet':{'product_details':{'$each':_0x45d99a[_0x3cb9c5(0x28f)]}}});}_0x5d5eb1[_0x3cb9c5(0x207)]='True';const _0x334bf2=await _0x5d5eb1[_0x3cb9c5(0x1e4)](),_0x2a6d6d=await master_shop[_0x3cb9c5(0x1de)](),_0x2d7eb2=await email_settings[_0x3cb9c5(0x281)](),_0x115508=await supervisor_settings[_0x3cb9c5(0x1de)]();var _0x188c5d=_0x5d5eb1[_0x3cb9c5(0x275)],_0x5e73bf='',_0x255254;for(_0x255254 in _0x188c5d){var _0x5ca40e='FG';_0x5d5eb1[_0x3cb9c5(0x1db)]==_0x3cb9c5(0x242)&&(_0x5ca40e='DG'),_0x5e73bf+=_0x3cb9c5(0x24e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x188c5d[_0x255254][_0x3cb9c5(0x297)]+_0x3cb9c5(0x29a)+_0x3cb9c5(0x299)+_0x188c5d[_0x255254][_0x3cb9c5(0x277)]+_0x3cb9c5(0x29a)+_0x3cb9c5(0x299)+_0x188c5d[_0x255254]['to_quantity']+_0x3cb9c5(0x29a)+_0x3cb9c5(0x299)+_0x188c5d[_0x255254]['unit']+_0x3cb9c5(0x29a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x188c5d[_0x255254]['secondary_unit']+'</td>'+_0x3cb9c5(0x299)+_0x5d5eb1[_0x3cb9c5(0x1db)]+_0x3cb9c5(0x29a)+_0x3cb9c5(0x299)+_0x188c5d[_0x255254][_0x3cb9c5(0x286)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5ca40e+_0x188c5d[_0x255254]['to_bay']+_0x3cb9c5(0x29a)+_0x3cb9c5(0x1fa);}_0x3a9726['flash']('success',_0x3cb9c5(0x20c)),_0x3e7572[_0x3cb9c5(0x226)](_0x3cb9c5(0x203)+_0x334bf2[_0x3cb9c5(0x1f9)]);}catch(_0x467e92){console[_0x3cb9c5(0x22b)](_0x467e92),_0x3e7572[_0x3cb9c5(0x211)](0x1f4)[_0x3cb9c5(0x217)]({'error':_0x3cb9c5(0x1e6)});}})[_0x102237(0x294)](_0x2b381f=>{var _0x557b83=_0x102237;console[_0x557b83(0x22b)](_0x2b381f),_0x3e7572[_0x557b83(0x211)](0x1f4)[_0x557b83(0x217)]({'error':_0x557b83(0x201)});});}catch(_0x5ba38c){console['error'](_0x5ba38c),_0x3e7572[_0x102237(0x211)](0x1f4)['json']({'error':_0x102237(0x267)});}})[_0x115dfa(0x294)](_0x37f04f=>{var _0x920987=_0x115dfa;console[_0x920987(0x22b)](_0x37f04f),_0x3e7572[_0x920987(0x211)](0x1f4)[_0x920987(0x217)]({'error':_0x920987(0x201)});});}catch(_0x251fff){_0x3e7572[_0x115dfa(0x217)]({'message':_0x251fff[_0x115dfa(0x271)]});}});function a0_0x327f(_0x2a5476,_0x196b58){var _0x18b661=a0_0x18b6();return a0_0x327f=function(_0x327f43,_0x56d587){_0x327f43=_0x327f43-0x1d6;var _0x1a1011=_0x18b661[_0x327f43];return _0x1a1011;},a0_0x327f(_0x2a5476,_0x196b58);}function BayBinSelected(_0x49a5eb,_0x1b313e){var _0x18ef4e=a0_0x400b8e,_0x49254e=[];let _0x3ed006=[];var _0x3da64e=[];if(_0x49a5eb==_0x18ef4e(0x242)){switch(_0x1b313e){case _0x18ef4e(0x1fe):_0x49254e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x18ef4e(0x244):_0x49254e=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3da64e=['DG'];}else{if(_0x49a5eb==_0x18ef4e(0x249)){switch(_0x1b313e){case _0x18ef4e(0x1fe):_0x49254e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x49254e=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3da64e=['FG'];}}return{'levels':_0x49254e,'identify':_0x3da64e};}function a0_0x18b6(){var _0x3b9466=['$finalize','\x20<>\x20','MaxStocks_data','$product_details.primary_code','nodemailer','$product','aggregate','/view/add_transfer','slice','to_warehouse','from_prod_level2','831186unQxoF','find','then','maxPerUnit','own','$date','Finished\x20Goods','save','../models/all_models','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','English\x20(US)','express','German','unit','flash','prod_cat','logs','Arabic','Product\x20Transfer\x20successfully','invoice','$product_details.storage','errors','1654872lqmBaj','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.batch_code','to_floorlevel','Chinese','to_quantity','_id','</tr>','To_invoice','prod_name','getFullYear','Rack\x201','location2location','to_bay','An\x20error\x20occurred.','1253904PfUyWZ','/picking_list/PDF_transfer/','$product_details.level','English','from_invoice','finalize','add_transfer_finished','Transfer\x20Edit\x20Successfully','$invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Transfer\x20Finalize\x20Successfully','length','4051086bKzYuf','$to_warehouse','type_of_process','status','success','findById','edit_transfer_finished_view','getMonth','ToRoomAssigned','json','warehouse','Arabic\x20(ae)','padStart','$product.to_room_name','$product_details.rack','floor','from_room','7391725cQeUbX','Enclosed','from_warehouse','from_room_name','concat','language','/transfer_finished/preview/','redirect','$product_details.secondary_unit','to_room','$room','/view_logs','error','choos_transfer_logs','$product_details.product_name','from_quantity','Portuguese\x20(BR)','random','forEach','toString','from_bay','back','role','transfer_finished','transfer_finished_logs','14NnxzCH','product_code3','$product_details','post','1688476EBIinW','$product_details.floorlevel','$_id','production_date','Enabled','$product_details.type','DRY\x20GOODS','TRF-','Rack\x202','$from_warehouse','$product_details.unit','\x20<=>\x20','batch_code','FROZEN\x20GOODS','$product_details.maxPerUnit','date','../middleware/auth','get','<tr>','max','/view/:id','filter','$product_details._id','/view/add_transfer_logs','maxProducts','/view/add_transfer_loc','product_date','choos_transfer','to_prod_level','$product_details.product_stock','log','$product_details.product_code','secondary_code','from_prod_qty','$name','RoomAssigned','$product_details.bin','params','$product_details.production_date','Spanish','LOG-TRF-','abs','$product_details.expiry_date','An\x20error\x20occurred\x20while\x20saving\x20data.','staff','MaxStocks_data2','$product_details.maxProducts','invoice_init','/transfer_finished/view','expiry_date','to_prod_qty','secondary_unit','/preview/:id','message','map','all','primary_code','product','Ambient','product_code','product_stock','bay','primary_unit','New_Qty_Converted','edit_transfer_finished','$product_details.invoice','../public/language/languages.json','Hindi','$product_details.secondary_code','findOne','$product_details.bay','undefined','body','push','to_room_name','user','French','from_level','match','/barcode_scanner','render','transfer_data','string','product_details','email','Portuguese','TRFF-','to_level','catch','$product.from_room_name','exports','product_name','/transfer/view','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</td>','4686252DMKlXL','id_transaction'];a0_0x18b6=function(){return _0x3b9466;};return a0_0x18b6();}router['get'](a0_0x400b8e(0x250),auth,async(_0x3d8cc3,_0xa4ab93)=>{var _0x25215b=a0_0x400b8e;try{const {username:_0x4cef6c,email:_0x3af696,role:_0x53db10}=_0x3d8cc3[_0x25215b(0x287)],_0x2b440f=_0x3d8cc3[_0x25215b(0x287)],_0x165a63=await profile[_0x25215b(0x281)]({'email':_0x2b440f['email']}),_0xcbbdba=await master_shop[_0x25215b(0x1de)](),_0x47d64b=await transfers_finished['findById'](_0x3d8cc3[_0x25215b(0x261)]['id']);let _0x554bdf=new Date(_0x47d64b['expiry_date']),_0x5c6f97=('0'+_0x554bdf['getDate']())[_0x25215b(0x1da)](-0x2),_0x25c884=('0'+(_0x554bdf[_0x25215b(0x215)]()+0x1))[_0x25215b(0x1da)](-0x2),_0xd5328c=_0x554bdf[_0x25215b(0x1fd)](),_0xf09e64=_0xd5328c+'-'+_0x25c884+'-'+_0x5c6f97,_0xff11b0;if(_0x2b440f[_0x25215b(0x235)]==_0x25215b(0x268)){const _0x2d2aa1=await staff['findOne']({'email':_0x2b440f['email']});_0xff11b0=await warehouse[_0x25215b(0x1de)]({'status':'Enabled','name':_0x2d2aa1['warehouse'],'warehouse_category':_0x25215b(0x1e3)});}else _0xff11b0=await warehouse[_0x25215b(0x1de)]({'status':'Enabled','warehouse_category':_0x25215b(0x1e3)});const _0x4f4c7c=await warehouse['aggregate']([{'$match':{'name':_0x47d64b[_0x25215b(0x221)],'room':_0x47d64b[_0x25215b(0x21e)]}},{'$unwind':_0x25215b(0x23a)},{'$group':{'_id':_0x25215b(0x252),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x25215b(0x259)},'bay':{'$first':_0x25215b(0x282)},'bin':{'$first':_0x25215b(0x260)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x25215b(0x23d)},'primary_code':{'$first':_0x25215b(0x2a0)},'secondary_code':{'$first':_0x25215b(0x280)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x25215b(0x21c)}}}]);var _0xe5af89=[0x1,0x2,0x3,0x4],_0x5bb9b9=['A','B','C','D','E','F','G','H','I','J'],_0x499d75=[_0x25215b(0x276),_0x25215b(0x220)];const _0x400a3a=await product[_0x25215b(0x1de)]({}),_0x1a3288=BayBinSelected(_0x47d64b[_0x25215b(0x1db)],_0x47d64b[_0x25215b(0x228)]);if(_0xcbbdba[0x0]['language']==_0x25215b(0x1e7)){var _0x3f23a0=users[_0x25215b(0x205)];console['log'](_0x3f23a0);}else{if(_0xcbbdba[0x0][_0x25215b(0x224)]==_0x25215b(0x27f))var _0x3f23a0=users[_0x25215b(0x27f)];else{if(_0xcbbdba[0x0][_0x25215b(0x224)]==_0x25215b(0x1e9))var _0x3f23a0=users[_0x25215b(0x1e9)];else{if(_0xcbbdba[0x0]['language']==_0x25215b(0x263))var _0x3f23a0=users[_0x25215b(0x263)];else{if(_0xcbbdba[0x0][_0x25215b(0x224)]==_0x25215b(0x288))var _0x3f23a0=users['French'];else{if(_0xcbbdba[0x0][_0x25215b(0x224)]=='Portuguese\x20(BR)')var _0x3f23a0=users[_0x25215b(0x291)];else{if(_0xcbbdba[0x0][_0x25215b(0x224)]==_0x25215b(0x1f7))var _0x3f23a0=users[_0x25215b(0x1f7)];else{if(_0xcbbdba[0x0][_0x25215b(0x224)]==_0x25215b(0x219))var _0x3f23a0=users[_0x25215b(0x1ee)];}}}}}}}_0xa4ab93[_0x25215b(0x28c)](_0x25215b(0x27c),{'success':_0x3d8cc3[_0x25215b(0x1eb)]('success'),'errors':_0x3d8cc3[_0x25215b(0x1eb)](_0x25215b(0x1f2)),'role':_0x2b440f,'profile':_0x165a63,'master_shop':_0xcbbdba,'warehouse':_0xff11b0,'transfer':_0x47d64b,'stock':_0x4f4c7c,'unit':_0x400a3a,'language':_0x3f23a0,'levels':_0xe5af89,'Isle':_0x5bb9b9,'rooms_data':_0x499d75,'ed_fullDate':_0xf09e64,'dataSelected':_0x1a3288});}catch(_0x331df0){console[_0x25215b(0x25a)](_0x331df0);}}),router['post'](a0_0x400b8e(0x250),auth,async(_0x3d2a33,_0x1df778)=>{var _0x51023d=a0_0x400b8e;try{const _0x11d008=_0x3d2a33[_0x51023d(0x261)]['id'];console[_0x51023d(0x25a)](_0x3d2a33[_0x51023d(0x284)]);const _0x831f26=await transfers_finished[_0x51023d(0x213)](_0x11d008);console['log'](_0x51023d(0x28d),_0x831f26);const {date:_0x5b9d48,from_warehouse:_0x55b187,FromRoom_name:_0x5da9cd,to_warehouse:_0x3c6989,ToRoom_name:_0x27003f,prod_name:_0x3ace6f,from_prod_qty:_0x4d15d5,from_prod_level:_0x299e1a,from_prod_isle:_0x3c1c6e,from_prod_pallet:_0x547018,to_prod_qty:_0x2aa226,to_prod_level:_0x1c0c76,to_prod_isle:_0x51a989,to_prod_pallet:_0xda5f10,primary_code:_0x3a4f5b,secondary_code:_0x3b72f8,product_code3:_0x21b964,note:_0x251aa1,invoice:_0x223742,expiry_date:_0x43f43a}=_0x3d2a33[_0x51023d(0x284)];if(typeof _0x3ace6f=='string')var _0x51139a=[_0x3d2a33[_0x51023d(0x284)]['prod_name']],_0x25b461=[_0x3d2a33[_0x51023d(0x284)][_0x51023d(0x25d)]],_0x4113ce=[_0x3d2a33[_0x51023d(0x284)]['from_prod_level']],_0x25662d=[_0x3d2a33[_0x51023d(0x284)]['to_prod_qty']],_0x521fe6=[_0x3d2a33[_0x51023d(0x284)][_0x51023d(0x258)]],_0x4c6e99=[_0x3d2a33[_0x51023d(0x284)][_0x51023d(0x274)]],_0x5742ae=[_0x3d2a33['body'][_0x51023d(0x25c)]],_0x222d51=[_0x3d2a33[_0x51023d(0x284)][_0x51023d(0x239)]],_0x5d87dd=[_0x3d2a33[_0x51023d(0x284)][_0x51023d(0x269)]],_0x3cf7fd=[_0x3d2a33[_0x51023d(0x284)][_0x51023d(0x1ea)]],_0x452240=[_0x3d2a33['body']['secondary_unit']],_0x131800=[_0x3d2a33[_0x51023d(0x284)][_0x51023d(0x248)]],_0x42af38=[_0x3d2a33[_0x51023d(0x284)][_0x51023d(0x26d)]];else var _0x51139a=[..._0x3d2a33[_0x51023d(0x284)][_0x51023d(0x1fc)]],_0x25b461=[..._0x3d2a33[_0x51023d(0x284)][_0x51023d(0x25d)]],_0x4113ce=[..._0x3d2a33[_0x51023d(0x284)]['from_prod_level']],_0x25662d=[..._0x3d2a33['body'][_0x51023d(0x26e)]],_0x521fe6=[..._0x3d2a33[_0x51023d(0x284)][_0x51023d(0x258)]],_0x4c6e99=[..._0x3d2a33[_0x51023d(0x284)][_0x51023d(0x274)]],_0x5742ae=[..._0x3d2a33[_0x51023d(0x284)][_0x51023d(0x25c)]],_0x222d51=[..._0x3d2a33[_0x51023d(0x284)][_0x51023d(0x239)]],_0x5d87dd=[..._0x3d2a33['body'][_0x51023d(0x269)]],_0x3cf7fd=[..._0x3d2a33['body']['unit']],_0x452240=[..._0x3d2a33['body'][_0x51023d(0x26f)]],_0x131800=[..._0x3d2a33[_0x51023d(0x284)][_0x51023d(0x248)]],_0x42af38=[..._0x3d2a33[_0x51023d(0x284)]['expiry_date']];const _0x6c1b11=_0x51139a['map'](_0x33be3a=>{return _0x33be3a={'product_name':_0x33be3a};});_0x25b461[_0x51023d(0x231)]((_0x29d2dd,_0x2a8dc9)=>{var _0x4e5737=_0x51023d;_0x6c1b11[_0x2a8dc9][_0x4e5737(0x22e)]=_0x29d2dd;}),_0x4113ce[_0x51023d(0x231)]((_0x46d4a7,_0x34d12d)=>{var _0x21bcb7=_0x51023d;_0x6c1b11[_0x34d12d][_0x21bcb7(0x233)]=_0x46d4a7;}),_0x25662d[_0x51023d(0x231)]((_0x4f9d57,_0x145eaf)=>{var _0x45706d=_0x51023d;_0x6c1b11[_0x145eaf][_0x45706d(0x1f8)]=_0x4f9d57;}),_0x521fe6[_0x51023d(0x231)]((_0x5f0090,_0x119662)=>{var _0x4de955=_0x51023d;_0x6c1b11[_0x119662][_0x4de955(0x200)]=_0x5f0090;}),_0x4c6e99[_0x51023d(0x231)]((_0x3b4dc0,_0x3f5bc5)=>{var _0x58b366=_0x51023d;_0x6c1b11[_0x3f5bc5][_0x58b366(0x274)]=_0x3b4dc0;}),_0x5742ae[_0x51023d(0x231)]((_0x9755fb,_0xcbc648)=>{var _0x3b2a77=_0x51023d;_0x6c1b11[_0xcbc648][_0x3b2a77(0x25c)]=_0x9755fb;}),_0x222d51[_0x51023d(0x231)]((_0x11ab05,_0xb1b651)=>{var _0x5cf066=_0x51023d;_0x6c1b11[_0xb1b651][_0x5cf066(0x277)]=_0x11ab05;}),_0x5d87dd[_0x51023d(0x231)]((_0x2ac6b0,_0x884346)=>{var _0x39ba69=_0x51023d;_0x6c1b11[_0x884346][_0x39ba69(0x254)]=_0x2ac6b0;}),_0x3cf7fd['forEach']((_0x1e8aa3,_0x2e836b)=>{var _0x303ea8=_0x51023d;_0x6c1b11[_0x2e836b][_0x303ea8(0x1ea)]=_0x1e8aa3;}),_0x452240['forEach']((_0x4760b4,_0x14f88f)=>{_0x6c1b11[_0x14f88f]['secondary_unit']=_0x4760b4;}),_0x131800['forEach']((_0x1bb434,_0xd3cff0)=>{var _0x5a79f6=_0x51023d;_0x6c1b11[_0xd3cff0][_0x5a79f6(0x248)]=_0x1bb434;}),_0x42af38['forEach']((_0x3dc3f8,_0x7465ea)=>{_0x6c1b11[_0x7465ea]['expiry_date']=_0x3dc3f8;});const _0x4e31b=_0x6c1b11[_0x51023d(0x251)](_0x26b2e5=>_0x26b2e5[_0x51023d(0x1f8)]!=='0'&&_0x26b2e5[_0x51023d(0x1f8)]!==''||_0x26b2e5['to_floorlevel']!=='0'&&_0x26b2e5[_0x51023d(0x1f6)]!=='');var _0xa1d5b9=0x0;_0x4e31b[_0x51023d(0x231)](_0x1943b1=>{var _0x870192=_0x51023d;parseInt(_0x1943b1[_0x870192(0x22e)])<parseInt(_0x1943b1[_0x870192(0x1f8)])&&_0xa1d5b9++;});if(_0xa1d5b9!=0x0)return _0x3d2a33[_0x51023d(0x1eb)](_0x51023d(0x1f2),_0x51023d(0x1f4)),_0x1df778[_0x51023d(0x226)]('back');const _0x3396ca=await warehouse['findOne']({'name':_0x831f26[_0x51023d(0x221)],'room':_0x831f26['from_room']});_0x831f26[_0x51023d(0x275)][_0x51023d(0x231)](_0x5e3573=>{var _0xac0aa3=_0x51023d;if(_0x5e3573[_0xac0aa3(0x1f8)]>0x0){const _0x2a3c0d=_0x3396ca['product_details'][_0xac0aa3(0x272)](_0xbf03c8=>{var _0x268088=_0xac0aa3;_0xbf03c8['product_name']==_0x5e3573[_0x268088(0x297)]&&_0xbf03c8[_0x268088(0x279)]==_0x5e3573['from_bay']&&(_0xbf03c8[_0x268088(0x278)]=parseInt(_0xbf03c8['product_stock'])+parseInt(_0x5e3573['to_quantity']));});}}),await _0x3396ca[_0x51023d(0x1e4)]();const _0x39dc1d=await warehouse[_0x51023d(0x281)]({'name':_0x831f26[_0x51023d(0x1db)],'room':_0x831f26[_0x51023d(0x228)]});_0x831f26[_0x51023d(0x275)][_0x51023d(0x231)](_0x137ae9=>{var _0x13c2ba=_0x51023d;if(_0x137ae9[_0x13c2ba(0x1f8)]>0x0){const _0x12afc0=_0x39dc1d['product_details'][_0x13c2ba(0x272)](_0x1578f8=>{var _0x2b5bdb=_0x13c2ba;_0x1578f8[_0x2b5bdb(0x297)]==_0x137ae9[_0x2b5bdb(0x297)]&&_0x1578f8[_0x2b5bdb(0x279)]==_0x137ae9[_0x2b5bdb(0x200)]&&(_0x1578f8[_0x2b5bdb(0x278)]=parseInt(_0x1578f8[_0x2b5bdb(0x278)])-parseInt(_0x137ae9[_0x2b5bdb(0x1f8)]));});}}),await _0x39dc1d[_0x51023d(0x1e4)](),_0x831f26[_0x51023d(0x24b)]=_0x5b9d48,_0x831f26[_0x51023d(0x221)]=_0x55b187,_0x831f26['to_warehouse']=_0x3c6989,_0x831f26[_0x51023d(0x275)]=_0x4e31b,_0x831f26['note']=_0x251aa1,_0x831f26[_0x51023d(0x1f0)]=_0x223742;const _0x17038d=await _0x831f26['save'](),_0x469c76=await warehouse[_0x51023d(0x281)]({'name':_0x55b187,'room':_0x5da9cd});_0x17038d[_0x51023d(0x275)][_0x51023d(0x231)](_0x23bd8a=>{var _0x26753f=_0x51023d;if(_0x23bd8a[_0x26753f(0x1f8)]>0x0){const _0x5cbe03=_0x469c76[_0x26753f(0x28f)]['map'](_0x59b50b=>{var _0x33d386=_0x26753f;_0x59b50b[_0x33d386(0x297)]==_0x23bd8a[_0x33d386(0x297)]&&_0x59b50b[_0x33d386(0x279)]==_0x23bd8a[_0x33d386(0x233)]&&(_0x59b50b[_0x33d386(0x278)]=parseInt(_0x59b50b[_0x33d386(0x278)])-parseInt(_0x23bd8a[_0x33d386(0x1f8)]));});}}),await _0x469c76['save']();const _0x2c1054=await warehouse[_0x51023d(0x281)]({'name':_0x3c6989,'room':_0x27003f});_0x17038d[_0x51023d(0x275)][_0x51023d(0x231)](_0x1b6bfe=>{var _0x305d14=_0x51023d;if(_0x1b6bfe[_0x305d14(0x1f8)]>0x0){var _0x5c7be2=0x0;const _0x12bc1b=_0x2c1054[_0x305d14(0x28f)][_0x305d14(0x272)](_0x2d4cc7=>{var _0x16cd08=_0x305d14;_0x2d4cc7[_0x16cd08(0x297)]==_0x1b6bfe[_0x16cd08(0x297)]&&_0x2d4cc7[_0x16cd08(0x279)]==_0x1b6bfe['to_bay']&&(_0x2d4cc7[_0x16cd08(0x278)]=parseInt(_0x2d4cc7[_0x16cd08(0x278)])+parseInt(_0x1b6bfe[_0x16cd08(0x1f8)]),_0x5c7be2++);});_0x5c7be2=='0'&&(_0x2c1054[_0x305d14(0x28f)]=_0x2c1054[_0x305d14(0x28f)][_0x305d14(0x223)]({'product_name':_0x1b6bfe[_0x305d14(0x297)],'product_stock':_0x1b6bfe['to_quantity'],'bay':_0x1b6bfe['to_bay'],'product_code':_0x1b6bfe[_0x305d14(0x277)],'primary_code':_0x1b6bfe[_0x305d14(0x274)],'secondary_code':_0x1b6bfe[_0x305d14(0x25c)],'maxProducts':_0x1b6bfe[_0x305d14(0x254)]}));}}),await _0x2c1054[_0x51023d(0x1e4)](),_0x3d2a33[_0x51023d(0x1eb)](_0x51023d(0x212),_0x51023d(0x209)),_0x1df778[_0x51023d(0x226)](_0x51023d(0x26c));}catch(_0x1c423d){console[_0x51023d(0x25a)](_0x1c423d);}}),router['post'](a0_0x400b8e(0x28b),async(_0x2bc0f6,_0x52d132)=>{var _0x4bc7a7=a0_0x400b8e;const {FromWareHouse:_0x2cf8ec,FromRoom:_0x4a2f18,ToWarehouse:_0x298b2b,ToRoom:_0x2a8a79,primary_code:_0x22b616,Roomslist:_0x127145}=_0x2bc0f6[_0x4bc7a7(0x284)],_0x203058=_0x127145['split'](','),_0x5391b8=[];async function _0x7579f5(_0x227d04){var _0x28f0e9=_0x4bc7a7;const _0x511acc=await warehouse[_0x28f0e9(0x1d8)]([{'$match':{'name':_0x2cf8ec,'room':_0x227d04}},{'$unwind':_0x28f0e9(0x23a)},{'$match':{'product_details.primary_code':_0x22b616}},{'$group':{'_id':_0x28f0e9(0x252),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x28f0e9(0x259)},'primary_code':{'$first':_0x28f0e9(0x2a0)},'secondary_code':{'$first':_0x28f0e9(0x280)},'product_code':{'$first':_0x28f0e9(0x25b)},'bay':{'$first':_0x28f0e9(0x282)},'level':{'$first':_0x28f0e9(0x204)},'type':{'$first':_0x28f0e9(0x241)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x28f0e9(0x246)},'secondary_unit':{'$first':_0x28f0e9(0x227)},'storage':{'$first':_0x28f0e9(0x1f1)},'rack':{'$first':_0x28f0e9(0x21c)},'expiry_date':{'$first':_0x28f0e9(0x266)},'production_date':{'$first':_0x28f0e9(0x262)},'batch_code':{'$first':_0x28f0e9(0x1f5)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x28f0e9(0x27d)}}}]),_0x4ddcba=await warehouse[_0x28f0e9(0x1d8)]([{'$match':{'name':_0x2cf8ec,'room':_0x227d04}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x22b616}},{'$group':{'_id':_0x28f0e9(0x252),'name':{'$first':_0x28f0e9(0x22d)},'instock':{'$first':_0x28f0e9(0x259)},'primary_code':{'$first':_0x28f0e9(0x2a0)},'secondary_code':{'$first':_0x28f0e9(0x280)},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':'$product_details.bay'},'level':{'$first':'$product_details.level'},'type':{'$first':_0x28f0e9(0x241)},'pallet':{'$first':_0x28f0e9(0x23d)},'unit':{'$first':_0x28f0e9(0x246)},'secondary_unit':{'$first':_0x28f0e9(0x227)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x28f0e9(0x21c)},'expiry_date':{'$first':_0x28f0e9(0x266)},'production_date':{'$first':_0x28f0e9(0x262)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x28f0e9(0x24a)},'roomNamed':{'$first':_0x28f0e9(0x229)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x28f0e9(0x27d)}}}]);if(_0x511acc[_0x28f0e9(0x20d)]>0x0)_0x5391b8[_0x28f0e9(0x285)](_0x511acc);else _0x4ddcba[_0x28f0e9(0x20d)]>0x0&&_0x5391b8[_0x28f0e9(0x285)](_0x4ddcba);}const _0x489183=_0x203058[_0x4bc7a7(0x272)](_0x4923e3=>_0x7579f5(_0x4923e3));await Promise[_0x4bc7a7(0x273)](_0x489183),_0x52d132[_0x4bc7a7(0x217)](_0x5391b8);}),router['post']('/CheckingWarehouse',async(_0x4d9dd2,_0x2a1fc7)=>{var _0x1a962d=a0_0x400b8e;const {productCode:_0x3524a3,bay:_0x403ac6,warehouses:_0x4ae1af,room:_0x3fd854}=_0x4d9dd2[_0x1a962d(0x284)];console['log'](_0x4d9dd2[_0x1a962d(0x284)]);try{const _0x1577e8=await warehouse['aggregate']([{'$match':{'name':_0x4ae1af,'room':_0x3fd854}},{'$unwind':_0x1a962d(0x23a)},{'$match':{'product_details.bay':parseInt(_0x403ac6)}},{'$group':{'_id':_0x1a962d(0x252),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1a962d(0x282)},'maxProducts':{'$first':_0x1a962d(0x26a)}}}]);_0x2a1fc7[_0x1a962d(0x211)](0xc8)['json'](_0x1577e8);}catch(_0x48125){_0x2a1fc7['status'](0x194)['json']({'message':_0x48125[_0x1a962d(0x271)]});}}),module[a0_0x400b8e(0x296)]=router;