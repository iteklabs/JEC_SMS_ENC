var a0_0x4fa854=a0_0xc8ab;(function(_0x244dcf,_0x41722d){var _0x53e5bb=a0_0xc8ab,_0x5d8de=_0x244dcf();while(!![]){try{var _0xf692fa=-parseInt(_0x53e5bb(0x147))/0x1+parseInt(_0x53e5bb(0x110))/0x2+-parseInt(_0x53e5bb(0x172))/0x3+parseInt(_0x53e5bb(0x10e))/0x4+-parseInt(_0x53e5bb(0x15d))/0x5+-parseInt(_0x53e5bb(0x198))/0x6+parseInt(_0x53e5bb(0x126))/0x7*(parseInt(_0x53e5bb(0xf2))/0x8);if(_0xf692fa===_0x41722d)break;else _0x5d8de['push'](_0x5d8de['shift']());}catch(_0x2c1e56){_0x5d8de['push'](_0x5d8de['shift']());}}}(a0_0x277d,0x8aef2));function a0_0xc8ab(_0x46fcbb,_0x56dbaa){var _0x277d52=a0_0x277d();return a0_0xc8ab=function(_0xc8ab42,_0x5e59c2){_0xc8ab42=_0xc8ab42-0xdb;var _0x308b22=_0x277d52[_0xc8ab42];return _0x308b22;},a0_0xc8ab(_0x46fcbb,_0x56dbaa);}const express=require(a0_0x4fa854(0x13a)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x4fa854(0x19c)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4fa854(0x14e));router[a0_0x4fa854(0x17c)](a0_0x4fa854(0x12a),auth,async(_0x18cd60,_0x1f40f7)=>{var _0x53af23=a0_0x4fa854;try{const {username:_0x526d8a,email:_0x2c5b48,role:_0x28bcc0}=_0x18cd60[_0x53af23(0xe3)],_0x345e63=_0x18cd60['user'],_0x52e808=await profile[_0x53af23(0x16c)]({'email':_0x345e63[_0x53af23(0x118)]}),_0x24408e=await master_shop[_0x53af23(0x11d)]();let _0x89cd03;if(_0x345e63[_0x53af23(0x16e)]=='staff'){const _0x595e40=await staff[_0x53af23(0x16c)]({'email':_0x345e63[_0x53af23(0x118)]});_0x89cd03=await transfers_finished[_0x53af23(0x11d)]({'from_warehouse':_0x595e40['warehouse']});}else _0x89cd03=await transfers_finished[_0x53af23(0x192)]([{'$match':{'type_of_transaction':_0x53af23(0xf9)}},{'$unwind':_0x53af23(0xf1)},{'$group':{'_id':_0x53af23(0x17f),'invoice':{'$first':'$invoice'},'date':{'$first':_0x53af23(0x11c)},'from_warehouse':{'$first':_0x53af23(0x189)},'to_warehouse':{'$first':_0x53af23(0x13b)},'from_room_name':{'$addToSet':_0x53af23(0x17e)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x53af23(0x19e)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x24408e[0x0]['language']==_0x53af23(0x14d))var _0x4eefc2=users['English'];else{if(_0x24408e[0x0]['language']=='Hindi')var _0x4eefc2=users[_0x53af23(0x150)];else{if(_0x24408e[0x0][_0x53af23(0x111)]==_0x53af23(0x104))var _0x4eefc2=users[_0x53af23(0x104)];else{if(_0x24408e[0x0][_0x53af23(0x111)]==_0x53af23(0xfd))var _0x4eefc2=users[_0x53af23(0xfd)];else{if(_0x24408e[0x0][_0x53af23(0x111)]==_0x53af23(0x103))var _0x4eefc2=users[_0x53af23(0x103)];else{if(_0x24408e[0x0][_0x53af23(0x111)]==_0x53af23(0x196))var _0x4eefc2=users[_0x53af23(0x127)];else{if(_0x24408e[0x0][_0x53af23(0x111)]==_0x53af23(0x131))var _0x4eefc2=users['Chinese'];else{if(_0x24408e[0x0]['language']==_0x53af23(0x157))var _0x4eefc2=users['Arabic'];}}}}}}}_0x1f40f7[_0x53af23(0x142)](_0x53af23(0xe1),{'success':_0x18cd60[_0x53af23(0x16b)]('success'),'errors':_0x18cd60['flash']('errors'),'role':_0x345e63,'profile':_0x52e808,'master_shop':_0x24408e,'transfer':_0x89cd03,'language':_0x4eefc2});}catch(_0x21a137){console['log'](_0x21a137);}}),router[a0_0x4fa854(0x17c)]('/view_logs',auth,async(_0x51e417,_0x16d490)=>{var _0x365b98=a0_0x4fa854;try{const {username:_0x19ca60,email:_0x50b88b,role:_0x4ea693}=_0x51e417[_0x365b98(0xe3)],_0x165c28=_0x51e417[_0x365b98(0xe3)],_0x7bbdcb=await profile['findOne']({'email':_0x165c28['email']}),_0x206d83=await master_shop['find']();let _0x442588;if(_0x165c28['role']=='staff'){const _0xaa917d=await staff[_0x365b98(0x16c)]({'email':_0x165c28[_0x365b98(0x118)]});_0x442588=await transfers_finished['find']({'from_warehouse':_0xaa917d[_0x365b98(0xff)]});}else _0x442588=await transfers_finished[_0x365b98(0x192)]([{'$match':{'type_of_transaction':_0x365b98(0x16a)}},{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x365b98(0x11c)},'from_warehouse':{'$first':_0x365b98(0x189)},'to_warehouse':{'$first':_0x365b98(0x13b)},'from_room_name':{'$addToSet':_0x365b98(0x17e)},'to_room_name':{'$addToSet':_0x365b98(0x12b)},'finalize':{'$first':_0x365b98(0x19e)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x206d83[0x0][_0x365b98(0x111)]==_0x365b98(0x14d))var _0x2dfc1a=users[_0x365b98(0x115)];else{if(_0x206d83[0x0][_0x365b98(0x111)]=='Hindi')var _0x2dfc1a=users['Hindi'];else{if(_0x206d83[0x0][_0x365b98(0x111)]==_0x365b98(0x104))var _0x2dfc1a=users[_0x365b98(0x104)];else{if(_0x206d83[0x0][_0x365b98(0x111)]==_0x365b98(0xfd))var _0x2dfc1a=users[_0x365b98(0xfd)];else{if(_0x206d83[0x0][_0x365b98(0x111)]=='French')var _0x2dfc1a=users[_0x365b98(0x103)];else{if(_0x206d83[0x0][_0x365b98(0x111)]=='Portuguese\x20(BR)')var _0x2dfc1a=users[_0x365b98(0x127)];else{if(_0x206d83[0x0][_0x365b98(0x111)]==_0x365b98(0x131))var _0x2dfc1a=users[_0x365b98(0x131)];else{if(_0x206d83[0x0][_0x365b98(0x111)]==_0x365b98(0x157))var _0x2dfc1a=users[_0x365b98(0x19f)];}}}}}}}_0x16d490[_0x365b98(0x142)](_0x365b98(0x151),{'success':_0x51e417[_0x365b98(0x16b)](_0x365b98(0x19b)),'errors':_0x51e417[_0x365b98(0x16b)](_0x365b98(0x134)),'role':_0x165c28,'profile':_0x7bbdcb,'master_shop':_0x206d83,'transfer':_0x442588,'language':_0x2dfc1a});}catch(_0x3e1905){console[_0x365b98(0x117)](_0x3e1905);}});async function getRandom8DigitNumber(){var _0x2d50f2=a0_0x4fa854;const _0x39da82=0x989680,_0x55e4f1=0x5f5e0ff,_0x567ffa=Math['floor'](Math[_0x2d50f2(0x160)]()*(_0x55e4f1-_0x39da82+0x1))+_0x39da82;var _0x16fbcc;const _0x55e10e=await transfers_finished['findOne']({'invoice':_0x2d50f2(0x128)+_0x567ffa});return _0x55e10e&&_0x55e10e[_0x2d50f2(0xf6)]>0x0?_0x16fbcc='TRFF-'+_0x567ffa:_0x16fbcc='TRFF-'+_0x567ffa,_0x16fbcc;}router[a0_0x4fa854(0x17c)](a0_0x4fa854(0x191),auth,async(_0x25aa54,_0x3e1532)=>{var _0x3fff92=a0_0x4fa854;try{const {username:_0xbfa7d8,email:_0x59f295,role:_0x19367f}=_0x25aa54['user'],_0x2a7886=_0x25aa54['user'],_0x2534cc=await profile[_0x3fff92(0x16c)]({'email':_0x2a7886['email']}),_0x325fb9=await master_shop[_0x3fff92(0x11d)]();let _0x4d3197;if(_0x2a7886[_0x3fff92(0x16e)]=='staff'){const _0x337d52=await staff[_0x3fff92(0x16c)]({'email':_0x2a7886[_0x3fff92(0x118)]});_0x4d3197=await warehouse['aggregate']([{'$match':{'status':_0x3fff92(0x136),'name':_0x337d52[_0x3fff92(0xff)]}},{'$group':{'_id':_0x3fff92(0xe2),'name':{'$first':_0x3fff92(0xe2)}}}]);}else _0x4d3197=await warehouse[_0x3fff92(0x192)]([{'$match':{'status':_0x3fff92(0x136)}},{'$group':{'_id':_0x3fff92(0xe2),'name':{'$first':_0x3fff92(0xe2)}}}]);const _0x5c6796=await transfers_finished[_0x3fff92(0x11d)]({}),_0x5359c6=_0x5c6796[_0x3fff92(0xf6)]+0x1,_0x349e39='TRFF-'+_0x5359c6[_0x3fff92(0x13f)]()[_0x3fff92(0xe6)](0x5,'0');if(_0x325fb9[0x0][_0x3fff92(0x111)]==_0x3fff92(0x14d))var _0x53b1b1=users[_0x3fff92(0x115)];else{if(_0x325fb9[0x0][_0x3fff92(0x111)]==_0x3fff92(0x150))var _0x53b1b1=users[_0x3fff92(0x150)];else{if(_0x325fb9[0x0][_0x3fff92(0x111)]==_0x3fff92(0x104))var _0x53b1b1=users[_0x3fff92(0x104)];else{if(_0x325fb9[0x0]['language']==_0x3fff92(0xfd))var _0x53b1b1=users[_0x3fff92(0xfd)];else{if(_0x325fb9[0x0]['language']=='French')var _0x53b1b1=users[_0x3fff92(0x103)];else{if(_0x325fb9[0x0][_0x3fff92(0x111)]=='Portuguese\x20(BR)')var _0x53b1b1=users[_0x3fff92(0x127)];else{if(_0x325fb9[0x0]['language']==_0x3fff92(0x131))var _0x53b1b1=users[_0x3fff92(0x131)];else{if(_0x325fb9[0x0][_0x3fff92(0x111)]=='Arabic\x20(ae)')var _0x53b1b1=users[_0x3fff92(0x19f)];}}}}}}}const _0x2332f6=getRandom8DigitNumber();_0x2332f6[_0x3fff92(0x10f)](_0x20dc75=>{var _0xe1de34=_0x3fff92;_0x3e1532['render']('add_transfer_finished',{'success':_0x25aa54[_0xe1de34(0x16b)](_0xe1de34(0x19b)),'errors':_0x25aa54[_0xe1de34(0x16b)](_0xe1de34(0x134)),'role':_0x2a7886,'profile':_0x2534cc,'master_shop':_0x325fb9,'warehouse':_0x4d3197,'language':_0x53b1b1,'invoice':_0x20dc75});})['catch'](_0x2742b7=>{var _0x2053c6=_0x3fff92;_0x25aa54[_0x2053c6(0x16b)](_0x2053c6(0x134),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x3e1532[_0x2053c6(0x13d)](_0x2053c6(0x185));});}catch(_0x548cff){console[_0x3fff92(0x117)](_0x548cff);}}),router[a0_0x4fa854(0x17c)](a0_0x4fa854(0x17b),auth,async(_0x5d28e0,_0x3e1b08)=>{var _0x2b3fd5=a0_0x4fa854;try{const {username:_0x4cc090,email:_0x5a5a39,role:_0x9ab7b6}=_0x5d28e0[_0x2b3fd5(0xe3)],_0x5da663=_0x5d28e0[_0x2b3fd5(0xe3)],_0x206c6d=await profile[_0x2b3fd5(0x16c)]({'email':_0x5da663['email']}),_0x3bd17a=await master_shop[_0x2b3fd5(0x11d)]();let _0xa20f1a;if(_0x5da663['role']=='staff'){const _0x1849d9=await staff[_0x2b3fd5(0x16c)]({'email':_0x5da663[_0x2b3fd5(0x118)]});_0xa20f1a=await warehouse[_0x2b3fd5(0x192)]([{'$match':{'status':_0x2b3fd5(0x136),'name':_0x1849d9[_0x2b3fd5(0xff)]}},{'$group':{'_id':_0x2b3fd5(0xe2),'name':{'$first':'$name'}}}]);}else _0xa20f1a=await warehouse[_0x2b3fd5(0x192)]([{'$match':{'status':_0x2b3fd5(0x136)}},{'$group':{'_id':_0x2b3fd5(0xe2),'name':{'$first':_0x2b3fd5(0xe2)}}}]);const _0x3581d0=await transfers_finished[_0x2b3fd5(0x11d)]({}),_0xedbadb=_0x3581d0[_0x2b3fd5(0xf6)]+0x1,_0x4ec800=_0x2b3fd5(0x128)+_0xedbadb[_0x2b3fd5(0x13f)]()['padStart'](0x5,'0');if(_0x3bd17a[0x0]['language']==_0x2b3fd5(0x14d))var _0x647e5e=users[_0x2b3fd5(0x115)];else{if(_0x3bd17a[0x0][_0x2b3fd5(0x111)]==_0x2b3fd5(0x150))var _0x647e5e=users['Hindi'];else{if(_0x3bd17a[0x0][_0x2b3fd5(0x111)]==_0x2b3fd5(0x104))var _0x647e5e=users['German'];else{if(_0x3bd17a[0x0][_0x2b3fd5(0x111)]=='Spanish')var _0x647e5e=users[_0x2b3fd5(0xfd)];else{if(_0x3bd17a[0x0][_0x2b3fd5(0x111)]==_0x2b3fd5(0x103))var _0x647e5e=users['French'];else{if(_0x3bd17a[0x0][_0x2b3fd5(0x111)]=='Portuguese\x20(BR)')var _0x647e5e=users[_0x2b3fd5(0x127)];else{if(_0x3bd17a[0x0][_0x2b3fd5(0x111)]==_0x2b3fd5(0x131))var _0x647e5e=users[_0x2b3fd5(0x131)];else{if(_0x3bd17a[0x0]['language']==_0x2b3fd5(0x157))var _0x647e5e=users[_0x2b3fd5(0x19f)];}}}}}}}const _0x57bc3f=getRandom8DigitNumber();_0x57bc3f[_0x2b3fd5(0x10f)](_0x3dd8ae=>{var _0x538dfc=_0x2b3fd5;_0x3e1b08[_0x538dfc(0x142)](_0x538dfc(0x140),{'success':_0x5d28e0[_0x538dfc(0x16b)]('success'),'errors':_0x5d28e0[_0x538dfc(0x16b)](_0x538dfc(0x134)),'role':_0x5da663,'profile':_0x206c6d,'master_shop':_0x3bd17a,'warehouse':_0xa20f1a,'language':_0x647e5e,'invoice':_0x3dd8ae});})['catch'](_0x8f0987=>{var _0x12c79a=_0x2b3fd5;_0x5d28e0[_0x12c79a(0x16b)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x3e1b08[_0x12c79a(0x13d)](_0x12c79a(0x185));});}catch(_0x4cf338){console[_0x2b3fd5(0x117)](_0x4cf338);}}),router[a0_0x4fa854(0x17c)](a0_0x4fa854(0x132),auth,async(_0x578c39,_0xb6cb5d)=>{var _0xb3933f=a0_0x4fa854;try{const {username:_0x4b94ee,email:_0x2b47a4,role:_0x1ffa8b}=_0x578c39[_0xb3933f(0xe3)],_0x155fda=_0x578c39[_0xb3933f(0xe3)],_0x395f64=await profile[_0xb3933f(0x16c)]({'email':_0x155fda[_0xb3933f(0x118)]}),_0xc0dde4=await master_shop[_0xb3933f(0x11d)]();let _0x3df2cd;if(_0x155fda[_0xb3933f(0x16e)]==_0xb3933f(0x138)){const _0x40f31a=await staff['findOne']({'email':_0x155fda[_0xb3933f(0x118)]});_0x3df2cd=await warehouse[_0xb3933f(0x192)]([{'$match':{'status':_0xb3933f(0x136),'name':_0x40f31a[_0xb3933f(0xff)]}},{'$group':{'_id':'$name','name':{'$first':_0xb3933f(0xe2)}}}]);}else _0x3df2cd=await warehouse[_0xb3933f(0x192)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x2334d7=await transfers_finished[_0xb3933f(0x11d)]({}),_0x3cb2db=_0x2334d7['length']+0x1,_0x51f7e3=_0xb3933f(0x128)+_0x3cb2db[_0xb3933f(0x13f)]()[_0xb3933f(0xe6)](0x5,'0');if(_0xc0dde4[0x0][_0xb3933f(0x111)]=='English\x20(US)')var _0x66fda2=users['English'];else{if(_0xc0dde4[0x0]['language']==_0xb3933f(0x150))var _0x66fda2=users[_0xb3933f(0x150)];else{if(_0xc0dde4[0x0][_0xb3933f(0x111)]==_0xb3933f(0x104))var _0x66fda2=users[_0xb3933f(0x104)];else{if(_0xc0dde4[0x0]['language']==_0xb3933f(0xfd))var _0x66fda2=users['Spanish'];else{if(_0xc0dde4[0x0][_0xb3933f(0x111)]=='French')var _0x66fda2=users['French'];else{if(_0xc0dde4[0x0][_0xb3933f(0x111)]==_0xb3933f(0x196))var _0x66fda2=users['Portuguese'];else{if(_0xc0dde4[0x0][_0xb3933f(0x111)]==_0xb3933f(0x131))var _0x66fda2=users['Chinese'];else{if(_0xc0dde4[0x0][_0xb3933f(0x111)]=='Arabic\x20(ae)')var _0x66fda2=users[_0xb3933f(0x19f)];}}}}}}}const _0x4b45b5=getRandom8DigitNumber();_0x4b45b5[_0xb3933f(0x10f)](_0x32d0f2=>{var _0x52db4f=_0xb3933f;_0xb6cb5d[_0x52db4f(0x142)](_0x52db4f(0x168),{'success':_0x578c39[_0x52db4f(0x16b)](_0x52db4f(0x19b)),'errors':_0x578c39[_0x52db4f(0x16b)](_0x52db4f(0x134)),'role':_0x155fda,'profile':_0x395f64,'master_shop':_0xc0dde4,'warehouse':_0x3df2cd,'language':_0x66fda2,'invoice':_0x32d0f2});})['catch'](_0x29ce5f=>{var _0x13d2b0=_0xb3933f;_0x578c39[_0x13d2b0(0x16b)](_0x13d2b0(0x134),_0x13d2b0(0x167)),_0xb6cb5d[_0x13d2b0(0x13d)]('/transfer/view');});}catch(_0x4e41d8){console['log'](_0x4e41d8);}}),router['post'](a0_0x4fa854(0x12d),auth,async(_0x23b737,_0x37d72c)=>{var _0x55152d=a0_0x4fa854;try{const {date:_0x4f5a79,from_warehouse:_0x416c35,FromRoom_name:_0x43ce27,to_warehouse:_0x77123b,ToRoom_name:_0x5b8a71,prod_name:_0x51d274,from_prod_qty:_0x2bb2b0,from_prod_level:_0x4852b7,from_prod_isle:_0x5b050c,from_prod_pallet:_0x460971,to_prod_qty:_0x2f9c89,to_prod_level:_0x2a6a98,to_prod_isle:_0x50dcdc,to_prod_pallet:_0x14316c,primary_code:_0x8c1743,secondary_code:_0xbaeef0,product_code3:_0x4d6e1b,note:_0x9fcb5,MaxStocks_data2:_0x44023c,invoice:_0x2eb49a,expiry_date:_0x432e72,PO_number:_0x3e73ec,ReqBy:_0x4e6d06,dateofreq:_0x460bc2,typeservicesData:_0x42d41b,destination:_0x215265,deliverydate:_0x22f4e5,driver:_0x34d817,plate:_0x3d7ee1,van:_0x2bd49b,DRSI:_0x500179,typevehicle:_0x48cb3b,TSU:_0xe72424,TFU:_0x2a1b6b}=_0x23b737[_0x55152d(0x148)];if(typeof _0x51d274==_0x55152d(0xee))var _0xe4694e=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x102)]],_0x2c22fb=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x143)]],_0x5c24f2=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x114)]],_0x3ea4ec=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x122)]],_0x39cc2f=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x144)]],_0xaf7d8f=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x19d)]],_0xb56078=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x179)]],_0x3cdcf0=[_0x23b737['body']['product_code3']],_0x3395d6=[_0x23b737['body'][_0x55152d(0x199)]],_0x50d32a=[_0x23b737[_0x55152d(0x148)]['primary_unit']],_0x59b804=[_0x23b737['body']['secondary_unit']],_0x110704=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x180)]],_0x54a461=[_0x23b737['body']['expiry_date']],_0x926702=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x177)]],_0x3741d5=[_0x23b737['body'][_0x55152d(0x165)]],_0x5bc53a=[_0x23b737[_0x55152d(0x148)][_0x55152d(0xde)]],_0x52b66c=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x195)]],_0x25710f=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x120)]],_0x53656e=[_0x23b737['body'][_0x55152d(0x163)]],_0x21d8c5=[_0x23b737[_0x55152d(0x148)][_0x55152d(0x17a)]],_0x11c7b7=[_0x23b737[_0x55152d(0x148)]['id_transaction']];else var _0xe4694e=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x102)]],_0x2c22fb=[..._0x23b737['body']['from_prod_qty']],_0x5c24f2=[..._0x23b737['body'][_0x55152d(0x114)]],_0x3ea4ec=[..._0x23b737[_0x55152d(0x148)]['New_Qty_Converted']],_0x39cc2f=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x144)]],_0xaf7d8f=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x19d)]],_0xb56078=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x179)]],_0x3cdcf0=[..._0x23b737['body']['product_code3']],_0x3395d6=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x199)]],_0x50d32a=[..._0x23b737['body']['primary_unit']],_0x59b804=[..._0x23b737['body'][_0x55152d(0x16f)]],_0x110704=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x180)]],_0x54a461=[..._0x23b737['body'][_0x55152d(0x170)]],_0x926702=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x177)]],_0x3741d5=[..._0x23b737['body'][_0x55152d(0x165)]],_0x5bc53a=[..._0x23b737[_0x55152d(0x148)]['maxPerUnit']],_0x52b66c=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x195)]],_0x25710f=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x120)]],_0x53656e=[..._0x23b737['body']['ToRoomAssigned']],_0x21d8c5=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x17a)]],_0x11c7b7=[..._0x23b737[_0x55152d(0x148)][_0x55152d(0x15f)]];const _0x1b0d20=_0xe4694e[_0x55152d(0x10d)](_0x59a4af=>{return _0x59a4af={'product_name':_0x59a4af};});_0x2c22fb[_0x55152d(0xe9)]((_0x483011,_0x49b1cc)=>{var _0x20237a=_0x55152d;_0x1b0d20[_0x49b1cc][_0x20237a(0x194)]=_0x483011;}),_0x5c24f2[_0x55152d(0xe9)]((_0x2c5bb5,_0x1cd6f8)=>{var _0x205a99=_0x55152d,_0x2b46a9=_0x2c5bb5[_0x205a99(0x10a)](/[A-Za-z]+/)[0x0],_0x3c74f8=parseInt(_0x2c5bb5[_0x205a99(0x10a)](/\d+/)[0x0]);_0x1b0d20[_0x1cd6f8][_0x205a99(0x197)]=_0x3c74f8,_0x1b0d20[_0x1cd6f8][_0x205a99(0xdf)]=_0x2b46a9;}),_0x11c7b7[_0x55152d(0xe9)]((_0x4f3093,_0x3e371d)=>{var _0x5e2a5e=_0x55152d;_0x1b0d20[_0x3e371d][_0x5e2a5e(0x15f)]=_0x4f3093;}),_0x21d8c5[_0x55152d(0xe9)]((_0x111fff,_0x58c57d)=>{var _0x2b2ee9=_0x55152d;_0x1b0d20[_0x58c57d][_0x2b2ee9(0x17a)]=_0x111fff;}),_0x3ea4ec['forEach']((_0x2d2638,_0x54ad27)=>{var _0x175fdc=_0x55152d;_0x1b0d20[_0x54ad27][_0x175fdc(0x12e)]=_0x2d2638;}),_0x39cc2f[_0x55152d(0xe9)]((_0x468349,_0x26e60b)=>{var _0x2b0255=_0x55152d,_0x20e9d3=_0x468349[_0x2b0255(0x10a)](/[A-Za-z]+/)[0x0],_0x1f40fc=parseInt(_0x468349[_0x2b0255(0x10a)](/\d+/)[0x0]);_0x1b0d20[_0x26e60b][_0x2b0255(0x15b)]=_0x20e9d3,_0x1b0d20[_0x26e60b][_0x2b0255(0x121)]=_0x1f40fc;}),_0xaf7d8f[_0x55152d(0xe9)]((_0x11879f,_0x204dde)=>{var _0x40c59e=_0x55152d;_0x1b0d20[_0x204dde][_0x40c59e(0x19d)]=_0x11879f;}),_0xb56078[_0x55152d(0xe9)]((_0x544821,_0xc83b67)=>{var _0x42c192=_0x55152d;_0x1b0d20[_0xc83b67][_0x42c192(0x179)]=_0x544821;}),_0x3cdcf0['forEach']((_0x38a499,_0x4b7782)=>{var _0x71f2aa=_0x55152d;_0x1b0d20[_0x4b7782][_0x71f2aa(0x18e)]=_0x38a499;}),_0x3395d6[_0x55152d(0xe9)]((_0x358b1e,_0x4090e1)=>{var _0x1b7b19=_0x55152d;_0x1b0d20[_0x4090e1][_0x1b7b19(0x17d)]=_0x358b1e;}),_0x50d32a['forEach']((_0x3c8e54,_0x5cbef9)=>{var _0x2e748b=_0x55152d;_0x1b0d20[_0x5cbef9][_0x2e748b(0x16d)]=_0x3c8e54;}),_0x59b804[_0x55152d(0xe9)]((_0xeb0cdb,_0x555f7d)=>{var _0x4e050b=_0x55152d;_0x1b0d20[_0x555f7d][_0x4e050b(0x16f)]=_0xeb0cdb;}),_0x110704[_0x55152d(0xe9)]((_0x32965a,_0x58ebd0)=>{var _0x1e29c3=_0x55152d;_0x1b0d20[_0x58ebd0][_0x1e29c3(0x180)]=_0x32965a;}),_0x54a461[_0x55152d(0xe9)]((_0x3877ad,_0x22c9a0)=>{var _0x2d4aa4=_0x55152d;_0x1b0d20[_0x22c9a0][_0x2d4aa4(0x170)]=_0x3877ad;}),_0x926702[_0x55152d(0xe9)]((_0x5483db,_0xb1b7b1)=>{_0x1b0d20[_0xb1b7b1]['production_date']=_0x5483db;}),_0x3741d5[_0x55152d(0xe9)]((_0x20c288,_0x330a54)=>{var _0x30aaf3=_0x55152d;_0x1b0d20[_0x330a54][_0x30aaf3(0x17d)]=_0x20c288;}),_0x5bc53a[_0x55152d(0xe9)]((_0x4f7eb7,_0x7963d8)=>{var _0x14828d=_0x55152d;_0x1b0d20[_0x7963d8][_0x14828d(0xde)]=_0x4f7eb7;}),_0x52b66c[_0x55152d(0xe9)]((_0x3c8fc0,_0x12b6e8)=>{var _0x49ba44=_0x55152d;_0x1b0d20[_0x12b6e8][_0x49ba44(0x195)]=_0x3c8fc0;}),_0x25710f['forEach']((_0x48bcc9,_0x373df0)=>{_0x1b0d20[_0x373df0]['from_room_name']=_0x48bcc9;}),_0x53656e[_0x55152d(0xe9)]((_0x4b620c,_0x38d7cd)=>{var _0xd19101=_0x55152d;_0x1b0d20[_0x38d7cd][_0xd19101(0x156)]=_0x4b620c;});const _0x2a37fd=_0x1b0d20[_0x55152d(0x166)](_0x1013dd=>_0x1013dd[_0x55152d(0x12e)]!=='0'&&_0x1013dd[_0x55152d(0x12e)]!==''||_0x1013dd['to_floorlevel']!=='0'&&_0x1013dd[_0x55152d(0x171)]!=='');var _0x301203=0x0;_0x2a37fd['forEach'](_0x517d74=>{var _0x4b3016=_0x55152d;parseInt(_0x517d74[_0x4b3016(0x194)])<parseInt(_0x517d74[_0x4b3016(0x12e)])&&_0x301203++;});if(_0x301203!=0x0)return _0x23b737[_0x55152d(0x16b)](_0x55152d(0x134),_0x55152d(0xf8)),_0x37d72c[_0x55152d(0x13d)](_0x55152d(0x13c));const _0x2e5781=new transfers_logs();await _0x2e5781['save']();for(let _0x30f8be=0x0;_0x30f8be<=_0x53656e[_0x55152d(0xf6)]-0x1;_0x30f8be++){_0x1b0d20[_0x30f8be]['To_invoice']=_0x55152d(0xf4)+_0x2e5781[_0x55152d(0x13e)][_0x55152d(0x13f)]()[_0x55152d(0xe6)](0x8,'0');}const _0x9acd7e=new transfers_finished({'date':_0x4f5a79,'from_warehouse':_0x416c35,'to_warehouse':_0x416c35,'product':_0x2a37fd,'note':_0x9fcb5,'invoice':_0x55152d(0xf4)+_0x2e5781[_0x55152d(0x13e)][_0x55152d(0x13f)]()[_0x55152d(0xe6)](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x55152d(0x16a),'PO_number':_0x3e73ec,'RequestedBy':_0x4e6d06,'DateofRequest':_0x460bc2,'typeservices':_0x42d41b,'destination':_0x215265,'deliverydate':_0x22f4e5,'driver':_0x34d817,'plate':_0x3d7ee1,'van':_0x2bd49b,'DRSI':_0x500179,'typevehicle':_0x48cb3b,'TSU':_0xe72424,'TFU':_0x2a1b6b}),_0x2e5f67=await _0x9acd7e[_0x55152d(0x106)]();_0x23b737[_0x55152d(0x16b)](_0x55152d(0x19b),'Product\x20Transfer\x20successfully'),_0x37d72c[_0x55152d(0x13d)]('/transfer_finished/preview/'+_0x2e5f67[_0x55152d(0x12c)]);}catch(_0x36d094){console['log'](_0x36d094),_0x37d72c[_0x55152d(0x14b)](0xc8)[_0x55152d(0x178)]({'errorMessage':_0x36d094[_0x55152d(0x125)]});}}),router[a0_0x4fa854(0x15c)](a0_0x4fa854(0x123),auth,async(_0x4a72e4,_0x3529d2)=>{var _0x15094f=a0_0x4fa854;try{const {date:_0x5c4975,from_warehouse:_0xbd9330,FromRoom_name:_0x212d14,to_warehouse:_0x149643,ToRoom_name:_0x5a7ef6,prod_name:_0x5b4bb7,from_prod_qty:_0x339197,from_prod_level:_0x589738,from_prod_isle:_0x3c89e3,from_prod_pallet:_0x338d12,to_prod_qty:_0x4d4aec,to_prod_level:_0x1fdb85,to_prod_isle:_0x52eb27,to_prod_pallet:_0x5bb4de,primary_code:_0x5e8cf6,secondary_code:_0x5ec7ca,product_code3:_0x25f72e,note:_0x5c72f8,MaxStocks_data2:_0x2e6f9e,invoice:_0x403977,expiry_date:_0x5a22ae,PO_number_loc:_0x47b23c,ReqBy_loc:_0x463e3a,dateofreq_loc:_0x249982,typeservices_loc_Data:_0x2a7333,destination_loc:_0x68623d,deliverydate_loc:_0x14a014,driver_loc:_0x43a0dd,plate_loc:_0x5ceced,van_loc:_0xb334ef,DRSI_loc:_0x14b3af,typevehicle_loc:_0x4dbd88,TSU_loc:_0x4a90a2,TFU_loc:_0x9fe866}=_0x4a72e4[_0x15094f(0x148)];if(typeof _0x5b4bb7==_0x15094f(0xee))var _0x1de133=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x102)]],_0x3c1eeb=[_0x4a72e4[_0x15094f(0x148)]['from_prod_qty']],_0x1bd25e=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x114)]],_0x50c23d=[_0x4a72e4['body'][_0x15094f(0x122)]],_0x3e66c5=[_0x4a72e4['body'][_0x15094f(0x144)]],_0x5bc4dd=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x19d)]],_0x4e2f3d=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x179)]],_0x58c7b1=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x18f)]],_0x2f6b24=[_0x4a72e4['body'][_0x15094f(0x199)]],_0x34da88=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x186)]],_0x218424=[_0x4a72e4['body'][_0x15094f(0x16f)]],_0x34e77f=[_0x4a72e4[_0x15094f(0x148)]['batch_code']],_0x3ddd9f=[_0x4a72e4[_0x15094f(0x148)]['expiry_date']],_0x35b91f=[_0x4a72e4[_0x15094f(0x148)]['product_date']],_0x168a0f=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x165)]],_0x178d44=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0xde)]],_0x397b6d=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x195)]],_0x573803=[_0x4a72e4[_0x15094f(0x148)]['RoomAssigned']],_0x424bd8=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x163)]],_0x5831b5=[_0x4a72e4[_0x15094f(0x148)][_0x15094f(0x17a)]],_0x2f7ff7=[_0x4a72e4[_0x15094f(0x148)]['id_transaction']];else var _0x1de133=[..._0x4a72e4[_0x15094f(0x148)]['prod_name']],_0x3c1eeb=[..._0x4a72e4['body'][_0x15094f(0x143)]],_0x1bd25e=[..._0x4a72e4['body'][_0x15094f(0x114)]],_0x50c23d=[..._0x4a72e4[_0x15094f(0x148)][_0x15094f(0x122)]],_0x3e66c5=[..._0x4a72e4[_0x15094f(0x148)][_0x15094f(0x144)]],_0x5bc4dd=[..._0x4a72e4[_0x15094f(0x148)][_0x15094f(0x19d)]],_0x4e2f3d=[..._0x4a72e4[_0x15094f(0x148)]['secondary_code']],_0x58c7b1=[..._0x4a72e4[_0x15094f(0x148)][_0x15094f(0x18f)]],_0x2f6b24=[..._0x4a72e4[_0x15094f(0x148)][_0x15094f(0x199)]],_0x34da88=[..._0x4a72e4['body'][_0x15094f(0x186)]],_0x218424=[..._0x4a72e4[_0x15094f(0x148)][_0x15094f(0x16f)]],_0x34e77f=[..._0x4a72e4[_0x15094f(0x148)][_0x15094f(0x180)]],_0x3ddd9f=[..._0x4a72e4[_0x15094f(0x148)][_0x15094f(0x170)]],_0x35b91f=[..._0x4a72e4[_0x15094f(0x148)]['product_date']],_0x168a0f=[..._0x4a72e4['body'][_0x15094f(0x165)]],_0x178d44=[..._0x4a72e4[_0x15094f(0x148)]['maxPerUnit']],_0x397b6d=[..._0x4a72e4['body']['prod_cat']],_0x573803=[..._0x4a72e4[_0x15094f(0x148)]['RoomAssigned']],_0x424bd8=[..._0x4a72e4['body'][_0x15094f(0x163)]],_0x5831b5=[..._0x4a72e4['body'][_0x15094f(0x17a)]],_0x2f7ff7=[..._0x4a72e4['body'][_0x15094f(0x15f)]];const _0x57e182=_0x1de133['map'](_0x2a0123=>{return _0x2a0123={'product_name':_0x2a0123};});_0x3c1eeb['forEach']((_0x3bdb03,_0x278707)=>{var _0x404eb3=_0x15094f;_0x57e182[_0x278707][_0x404eb3(0x194)]=_0x3bdb03;}),_0x1bd25e[_0x15094f(0xe9)]((_0x32330f,_0x2263f7)=>{var _0x59c4e8=_0x15094f,_0x470f60=_0x32330f[_0x59c4e8(0x10a)](/[A-Za-z]+/)[0x0],_0x2ae93a=parseInt(_0x32330f[_0x59c4e8(0x10a)](/\d+/)[0x0]);_0x57e182[_0x2263f7][_0x59c4e8(0x197)]=_0x2ae93a,_0x57e182[_0x2263f7][_0x59c4e8(0xdf)]=_0x470f60;}),_0x2f7ff7[_0x15094f(0xe9)]((_0x356ca5,_0x4e1a11)=>{var _0x177d48=_0x15094f;_0x57e182[_0x4e1a11][_0x177d48(0x15f)]=_0x356ca5;}),_0x5831b5[_0x15094f(0xe9)]((_0x131ad0,_0x12d982)=>{var _0x3c610f=_0x15094f;_0x57e182[_0x12d982][_0x3c610f(0x17a)]=_0x131ad0;}),_0x50c23d[_0x15094f(0xe9)]((_0x4d5021,_0x5579a3)=>{_0x57e182[_0x5579a3]['to_quantity']=_0x4d5021;}),_0x3e66c5[_0x15094f(0xe9)]((_0x2f846a,_0x498214)=>{var _0x2e05f3=_0x15094f,_0x1b4e5d=_0x2f846a['match'](/[A-Za-z]+/)[0x0],_0x50c201=parseInt(_0x2f846a[_0x2e05f3(0x10a)](/\d+/)[0x0]);_0x57e182[_0x498214][_0x2e05f3(0x15b)]=_0x1b4e5d,_0x57e182[_0x498214]['to_bay']=_0x50c201;}),_0x5bc4dd['forEach']((_0x1c823e,_0x27aa56)=>{_0x57e182[_0x27aa56]['primary_code']=_0x1c823e;}),_0x4e2f3d[_0x15094f(0xe9)]((_0x3c4de5,_0x5e451d)=>{var _0x3d02ad=_0x15094f;_0x57e182[_0x5e451d][_0x3d02ad(0x179)]=_0x3c4de5;}),_0x58c7b1[_0x15094f(0xe9)]((_0x57dfed,_0x1b7880)=>{_0x57e182[_0x1b7880]['product_code']=_0x57dfed;}),_0x2f6b24[_0x15094f(0xe9)]((_0x123fbc,_0x2dbbd0)=>{_0x57e182[_0x2dbbd0]['maxProducts']=_0x123fbc;}),_0x34da88['forEach']((_0x44bb68,_0xd11cac)=>{var _0x4d4be2=_0x15094f;_0x57e182[_0xd11cac][_0x4d4be2(0x16d)]=_0x44bb68;}),_0x218424[_0x15094f(0xe9)]((_0x36e299,_0x1f6276)=>{var _0x4a3c8c=_0x15094f;_0x57e182[_0x1f6276][_0x4a3c8c(0x16f)]=_0x36e299;}),_0x34e77f['forEach']((_0x2b2186,_0x3f61b7)=>{var _0x138181=_0x15094f;_0x57e182[_0x3f61b7][_0x138181(0x180)]=_0x2b2186;}),_0x3ddd9f[_0x15094f(0xe9)]((_0x31862e,_0x4ad4a0)=>{var _0x5b90b4=_0x15094f;_0x57e182[_0x4ad4a0][_0x5b90b4(0x170)]=_0x31862e;}),_0x35b91f[_0x15094f(0xe9)]((_0x10473b,_0x75c4b9)=>{var _0x37ddfb=_0x15094f;_0x57e182[_0x75c4b9][_0x37ddfb(0x18a)]=_0x10473b;}),_0x168a0f['forEach']((_0x37b267,_0x1d23e0)=>{var _0xb2221b=_0x15094f;_0x57e182[_0x1d23e0][_0xb2221b(0x17d)]=_0x37b267;}),_0x178d44[_0x15094f(0xe9)]((_0x6c823c,_0x1e8491)=>{var _0x3fcc59=_0x15094f;_0x57e182[_0x1e8491][_0x3fcc59(0xde)]=_0x6c823c;}),_0x397b6d[_0x15094f(0xe9)]((_0x3614bf,_0xdad4fa)=>{var _0x937758=_0x15094f;_0x57e182[_0xdad4fa][_0x937758(0x195)]=_0x3614bf;}),_0x573803[_0x15094f(0xe9)]((_0x3a5d11,_0x82f864)=>{_0x57e182[_0x82f864]['from_room_name']=_0x3a5d11;}),_0x424bd8[_0x15094f(0xe9)]((_0x31db75,_0x33d76b)=>{var _0x53a6b5=_0x15094f;_0x57e182[_0x33d76b][_0x53a6b5(0x156)]=_0x31db75;});const _0x406082=_0x57e182[_0x15094f(0x166)](_0x574719=>_0x574719[_0x15094f(0x12e)]!=='0'&&_0x574719['to_quantity']!==''||_0x574719[_0x15094f(0x171)]!=='0'&&_0x574719['to_floorlevel']!=='');var _0x19b947=0x0;_0x406082[_0x15094f(0xe9)](_0x264b7f=>{var _0x49bc3b=_0x15094f;parseInt(_0x264b7f[_0x49bc3b(0x194)])<parseInt(_0x264b7f[_0x49bc3b(0x12e)])&&_0x19b947++;});if(_0x19b947!=0x0)return _0x4a72e4[_0x15094f(0x16b)](_0x15094f(0x134),_0x15094f(0xf8)),_0x3529d2[_0x15094f(0x13d)]('back');const _0x3a81e4=new transfers_logs();await _0x3a81e4['save']();for(let _0x1798a9=0x0;_0x1798a9<=_0x424bd8[_0x15094f(0xf6)]-0x1;_0x1798a9++){_0x57e182[_0x1798a9]['To_invoice']='LOG-TRF-'+_0x3a81e4[_0x15094f(0x13e)][_0x15094f(0x13f)]()['padStart'](0x8,'0');}const _0x336fed=new transfers_finished({'date':_0x5c4975,'from_warehouse':_0xbd9330,'to_warehouse':_0x149643,'product':_0x406082,'note':_0x5c72f8,'invoice':_0x15094f(0xf4)+_0x3a81e4['invoice_init']['toString']()[_0x15094f(0xe6)](0x8,'0'),'type_of_transaction':_0x15094f(0x16a),'type_of_process':_0x15094f(0x15a),'PO_number':_0x47b23c,'RequestedBy':_0x463e3a,'DateofRequest':_0x249982,'typeservices':_0x2a7333,'destination':_0x68623d,'deliverydate':_0x14a014,'driver':_0x43a0dd,'plate':_0x5ceced,'van':_0xb334ef,'DRSI':_0x14b3af,'typevehicle':_0x4dbd88,'TSU':_0x4a90a2,'TFU':_0x9fe866}),_0x36d12f=await _0x336fed[_0x15094f(0x106)]();_0x4a72e4[_0x15094f(0x16b)](_0x15094f(0x19b),_0x15094f(0x174)),_0x3529d2[_0x15094f(0x13d)](_0x15094f(0xed)+_0x36d12f['_id']);}catch(_0x4468a5){console[_0x15094f(0x117)](_0x4468a5),_0x3529d2[_0x15094f(0x14b)](0xc8)[_0x15094f(0x178)]({'errorMessage':_0x4468a5['message']});}}),router[a0_0x4fa854(0x15c)]('/view/add_transfer',auth,async(_0x3f3b7c,_0x43c411)=>{var _0x67dc6c=a0_0x4fa854;try{const {date:_0x187c2f,from_warehouse:_0x55876c,FromRoom_name:_0x51e5bb,to_warehouse:_0x1d2b77,ToRoom_name:_0x44ede8,prod_name:_0x8f532d,from_prod_qty:_0x2196d4,from_prod_level:_0x41cb78,from_prod_isle:_0x14b95c,from_prod_pallet:_0x177a27,to_prod_qty:_0x270bdc,to_prod_level:_0x39870b,to_prod_isle:_0x2c9762,to_prod_pallet:_0x35c478,primary_code:_0x50f801,secondary_code:_0x189da9,product_code3:_0x3ad0dc,note:_0x3f1a49,MaxStocks_data2:_0x1c5ccf,invoice:_0x49fd79,expiry_date:_0x537f90,PO_number:_0x44cd3c,ReqBy:_0x4b2035,dateofreq:_0x5d8ffd,typeservicesData:_0x2e5e6b,destination:_0x214c13,deliverydate:_0x55faf0,driver:_0x595531,plate:_0x193e71,van:_0x11ed17,DRSI:_0x3e70cc,typevehicle:_0x5ab558,TSU:_0x2d5f0b,TFU:_0x42afde}=_0x3f3b7c[_0x67dc6c(0x148)];if(typeof _0x8f532d==_0x67dc6c(0xee))var _0x167c68=[_0x3f3b7c['body']['prod_name']],_0x3076ac=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x143)]],_0x1f08d3=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x114)]],_0x5dc0e9=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x122)]],_0x504ca4=[_0x3f3b7c[_0x67dc6c(0x148)]['to_prod_level']],_0x342e8a=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x19d)]],_0x43c233=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x179)]],_0x334d8d=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x18f)]],_0x31380a=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x199)]],_0x2371e4=[_0x3f3b7c[_0x67dc6c(0x148)]['primary_unit']],_0x2a590b=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x16f)]],_0x2d615d=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x180)]],_0x48cfbf=[_0x3f3b7c[_0x67dc6c(0x148)]['expiry_date']],_0x1dafcd=[_0x3f3b7c[_0x67dc6c(0x148)]['product_date']],_0x20e259=[_0x3f3b7c[_0x67dc6c(0x148)]['MaxStocks_data']],_0x52d053=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0xde)]],_0x368755=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x195)]],_0x1f0596=[_0x3f3b7c[_0x67dc6c(0x148)]['RoomAssigned']],_0x479fcb=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x163)]],_0x121eb1=[_0x3f3b7c['body'][_0x67dc6c(0x17a)]],_0x58cc83=[_0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x15f)]];else var _0x167c68=[..._0x3f3b7c['body'][_0x67dc6c(0x102)]],_0x3076ac=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x143)]],_0x1f08d3=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x114)]],_0x5dc0e9=[..._0x3f3b7c['body'][_0x67dc6c(0x122)]],_0x504ca4=[..._0x3f3b7c['body'][_0x67dc6c(0x144)]],_0x342e8a=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x19d)]],_0x43c233=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x179)]],_0x334d8d=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x18f)]],_0x31380a=[..._0x3f3b7c[_0x67dc6c(0x148)]['MaxStocks_data2']],_0x2371e4=[..._0x3f3b7c[_0x67dc6c(0x148)]['primary_unit']],_0x2a590b=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x16f)]],_0x2d615d=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x180)]],_0x48cfbf=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x170)]],_0x1dafcd=[..._0x3f3b7c['body'][_0x67dc6c(0x177)]],_0x20e259=[..._0x3f3b7c['body'][_0x67dc6c(0x165)]],_0x52d053=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0xde)]],_0x368755=[..._0x3f3b7c['body'][_0x67dc6c(0x195)]],_0x1f0596=[..._0x3f3b7c[_0x67dc6c(0x148)]['RoomAssigned']],_0x479fcb=[..._0x3f3b7c[_0x67dc6c(0x148)][_0x67dc6c(0x163)]],_0x121eb1=[..._0x3f3b7c['body']['from_invoice']],_0x58cc83=[..._0x3f3b7c['body'][_0x67dc6c(0x15f)]];const _0x1b75eb=_0x167c68['map'](_0x1365ea=>{return _0x1365ea={'product_name':_0x1365ea};});_0x3076ac[_0x67dc6c(0xe9)]((_0x384b5a,_0x51d6b6)=>{_0x1b75eb[_0x51d6b6]['from_quantity']=_0x384b5a;}),_0x1f08d3[_0x67dc6c(0xe9)]((_0x44dfbd,_0x2b6318)=>{var _0x49b054=_0x67dc6c,_0x36b895=_0x44dfbd['match'](/[A-Za-z]+/)[0x0],_0x16c589=parseInt(_0x44dfbd[_0x49b054(0x10a)](/\d+/)[0x0]);_0x1b75eb[_0x2b6318][_0x49b054(0x197)]=_0x16c589,_0x1b75eb[_0x2b6318]['from_level']=_0x36b895;}),_0x58cc83['forEach']((_0x1050df,_0x1ae85c)=>{var _0x2d9b55=_0x67dc6c;_0x1b75eb[_0x1ae85c][_0x2d9b55(0x15f)]=_0x1050df;}),_0x121eb1[_0x67dc6c(0xe9)]((_0x58d3fc,_0x4583b8)=>{var _0x310d3e=_0x67dc6c;_0x1b75eb[_0x4583b8][_0x310d3e(0x17a)]=_0x58d3fc;}),_0x5dc0e9[_0x67dc6c(0xe9)]((_0x2edbe9,_0xeca83e)=>{var _0x5d7424=_0x67dc6c;_0x1b75eb[_0xeca83e][_0x5d7424(0x12e)]=_0x2edbe9;}),_0x504ca4['forEach']((_0x2adae0,_0x410d44)=>{var _0x21fd48=_0x67dc6c,_0x383a20=_0x2adae0[_0x21fd48(0x10a)](/[A-Za-z]+/)[0x0],_0x8fa469=parseInt(_0x2adae0[_0x21fd48(0x10a)](/\d+/)[0x0]);_0x1b75eb[_0x410d44][_0x21fd48(0x15b)]=_0x383a20,_0x1b75eb[_0x410d44]['to_bay']=_0x8fa469;}),_0x342e8a[_0x67dc6c(0xe9)]((_0x4c46a1,_0x2767f2)=>{var _0x309cd1=_0x67dc6c;_0x1b75eb[_0x2767f2][_0x309cd1(0x19d)]=_0x4c46a1;}),_0x43c233['forEach']((_0x111f25,_0x3ae97b)=>{var _0x241600=_0x67dc6c;_0x1b75eb[_0x3ae97b][_0x241600(0x179)]=_0x111f25;}),_0x334d8d[_0x67dc6c(0xe9)]((_0xc867f,_0x1c26d3)=>{var _0x340aac=_0x67dc6c;_0x1b75eb[_0x1c26d3][_0x340aac(0x18e)]=_0xc867f;}),_0x31380a[_0x67dc6c(0xe9)]((_0x33861c,_0x88e5c8)=>{var _0x3ec31a=_0x67dc6c;_0x1b75eb[_0x88e5c8][_0x3ec31a(0x17d)]=_0x33861c;}),_0x2371e4[_0x67dc6c(0xe9)]((_0x3e8055,_0x360b38)=>{var _0x396665=_0x67dc6c;_0x1b75eb[_0x360b38][_0x396665(0x16d)]=_0x3e8055;}),_0x2a590b[_0x67dc6c(0xe9)]((_0x40b170,_0x3bd011)=>{var _0x48b092=_0x67dc6c;_0x1b75eb[_0x3bd011][_0x48b092(0x16f)]=_0x40b170;}),_0x2d615d[_0x67dc6c(0xe9)]((_0x26d534,_0x21481d)=>{var _0x42ca42=_0x67dc6c;_0x1b75eb[_0x21481d][_0x42ca42(0x180)]=_0x26d534;}),_0x48cfbf['forEach']((_0x59e5ac,_0x546d23)=>{var _0x279572=_0x67dc6c;_0x1b75eb[_0x546d23][_0x279572(0x170)]=_0x59e5ac;}),_0x1dafcd['forEach']((_0xa4a8c7,_0x54fc45)=>{var _0x55aee2=_0x67dc6c;_0x1b75eb[_0x54fc45][_0x55aee2(0x18a)]=_0xa4a8c7;}),_0x20e259[_0x67dc6c(0xe9)]((_0x5e0816,_0x4e87c1)=>{var _0x59939c=_0x67dc6c;_0x1b75eb[_0x4e87c1][_0x59939c(0x17d)]=_0x5e0816;}),_0x52d053['forEach']((_0xe92e5a,_0x35c481)=>{var _0x26c216=_0x67dc6c;_0x1b75eb[_0x35c481][_0x26c216(0xde)]=_0xe92e5a;}),_0x368755[_0x67dc6c(0xe9)]((_0x478c07,_0x4ddbda)=>{var _0x3f4568=_0x67dc6c;_0x1b75eb[_0x4ddbda][_0x3f4568(0x195)]=_0x478c07;}),_0x1f0596[_0x67dc6c(0xe9)]((_0x385be4,_0x5dfe69)=>{var _0x5c9eaf=_0x67dc6c;_0x1b75eb[_0x5dfe69][_0x5c9eaf(0xe8)]=_0x385be4;}),_0x479fcb['forEach']((_0x3c1c53,_0x278a88)=>{var _0x52d211=_0x67dc6c;_0x1b75eb[_0x278a88][_0x52d211(0x156)]=_0x3c1c53;});const _0x3293a9=_0x1b75eb[_0x67dc6c(0x166)](_0x234325=>_0x234325[_0x67dc6c(0x12e)]!=='0'&&_0x234325[_0x67dc6c(0x12e)]!==''||_0x234325[_0x67dc6c(0x171)]!=='0'&&_0x234325[_0x67dc6c(0x171)]!=='');var _0xbbd232=0x0;_0x3293a9[_0x67dc6c(0xe9)](_0x3a6c3f=>{var _0x24eb09=_0x67dc6c;parseInt(_0x3a6c3f[_0x24eb09(0x194)])<parseInt(_0x3a6c3f[_0x24eb09(0x12e)])&&_0xbbd232++;});if(_0xbbd232!=0x0)return _0x3f3b7c[_0x67dc6c(0x16b)](_0x67dc6c(0x134),_0x67dc6c(0xf8)),_0x43c411[_0x67dc6c(0x13d)]('back');const _0x430f28=new invoice_for_transfer();await _0x430f28[_0x67dc6c(0x106)]();for(let _0x58a899=0x0;_0x58a899<=_0x479fcb[_0x67dc6c(0xf6)]-0x1;_0x58a899++){_0x1b75eb[_0x58a899][_0x67dc6c(0xfe)]=_0x67dc6c(0xdc)+_0x430f28['invoice_init'][_0x67dc6c(0x13f)]()[_0x67dc6c(0xe6)](0x8,'0');}const _0x4bc9a6=new transfers_finished({'date':_0x187c2f,'from_warehouse':_0x55876c,'to_warehouse':_0x55876c,'product':_0x3293a9,'note':_0x3f1a49,'invoice':_0x67dc6c(0xdc)+_0x430f28[_0x67dc6c(0x13e)][_0x67dc6c(0x13f)]()[_0x67dc6c(0xe6)](0x8,'0'),'type_of_process':_0x67dc6c(0xfc),'type_of_transaction':'own','PO_number':_0x44cd3c,'RequestedBy':_0x4b2035,'DateofRequest':_0x5d8ffd,'typeservices':_0x2e5e6b,'destination':_0x214c13,'deliverydate':_0x55faf0,'driver':_0x595531,'plate':_0x193e71,'van':_0x11ed17,'DRSI':_0x3e70cc,'typevehicle':_0x5ab558,'TSU':_0x2d5f0b,'TFU':_0x42afde}),_0x4def70=await _0x4bc9a6[_0x67dc6c(0x106)]();_0x3f3b7c[_0x67dc6c(0x16b)]('success',_0x67dc6c(0x174)),_0x43c411[_0x67dc6c(0x13d)](_0x67dc6c(0xed)+_0x4def70['_id']);}catch(_0x113a33){console[_0x67dc6c(0x117)](_0x113a33),_0x43c411[_0x67dc6c(0x14b)](0xc8)[_0x67dc6c(0x178)]({'errorMessage':_0x113a33[_0x67dc6c(0x125)]});}}),router[a0_0x4fa854(0x15c)](a0_0x4fa854(0x181),auth,async(_0x438dde,_0x36f506)=>{var _0x1387a2=a0_0x4fa854;try{const {date:_0x1b820b,from_warehouse:_0x370e4d,FromRoom_name:_0x282978,to_warehouse:_0x3202f6,ToRoom_name:_0x284291,prod_name:_0x294741,from_prod_qty:_0x535c1d,from_prod_level:_0x18e726,from_prod_isle:_0x2a60da,from_prod_pallet:_0x1318c0,to_prod_qty:_0x2f6302,to_prod_level:_0x5a2645,to_prod_isle:_0x347d45,to_prod_pallet:_0x328e49,primary_code:_0x96658e,secondary_code:_0x31911a,product_code3:_0x216a6e,note:_0x5eacbe,MaxStocks_data2:_0x2a5f7f,invoice:_0x8ecba3,expiry_date:_0x5b6093,PO_number_loc:_0x38c6a8,ReqBy_loc:_0x411b49,dateofreq_loc:_0x3accac,typeservices_loc_Data:_0x4aca5f,destination_loc:_0x19d08e,deliverydate_loc:_0xebe7ee,driver_loc:_0x545282,plate_loc:_0x3d8ffc,van_loc:_0x1c74f7,DRSI_loc:_0x1e4081,typevehicle_loc:_0x1c5083,TSU_loc:_0x2bd930,TFU_loc:_0xab186b}=_0x438dde[_0x1387a2(0x148)];if(typeof _0x294741==_0x1387a2(0xee))var _0x4c857=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x102)]],_0x5172b3=[_0x438dde['body'][_0x1387a2(0x143)]],_0x2f2b0a=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x114)]],_0x2e5f19=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x122)]],_0x3e402c=[_0x438dde['body'][_0x1387a2(0x144)]],_0x20a562=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x19d)]],_0x24d6df=[_0x438dde[_0x1387a2(0x148)]['secondary_code']],_0x53ccfa=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x18f)]],_0x29a508=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x199)]],_0x25ba5f=[_0x438dde[_0x1387a2(0x148)]['primary_unit']],_0x3b93d5=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x16f)]],_0x3a6896=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x180)]],_0x3c93cb=[_0x438dde['body'][_0x1387a2(0x170)]],_0x591ab5=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x177)]],_0x8288fb=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x165)]],_0x2b874c=[_0x438dde['body'][_0x1387a2(0xde)]],_0x1463e0=[_0x438dde[_0x1387a2(0x148)]['prod_cat']],_0x145399=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x120)]],_0x2d9d53=[_0x438dde[_0x1387a2(0x148)]['ToRoomAssigned']],_0x5cb022=[_0x438dde[_0x1387a2(0x148)][_0x1387a2(0x17a)]],_0x546e52=[_0x438dde['body'][_0x1387a2(0x15f)]];else var _0x4c857=[..._0x438dde['body'][_0x1387a2(0x102)]],_0x5172b3=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x143)]],_0x2f2b0a=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x114)]],_0x2e5f19=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x122)]],_0x3e402c=[..._0x438dde['body'][_0x1387a2(0x144)]],_0x20a562=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x19d)]],_0x24d6df=[..._0x438dde['body'][_0x1387a2(0x179)]],_0x53ccfa=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x18f)]],_0x29a508=[..._0x438dde['body'][_0x1387a2(0x199)]],_0x25ba5f=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x186)]],_0x3b93d5=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x16f)]],_0x3a6896=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x180)]],_0x3c93cb=[..._0x438dde[_0x1387a2(0x148)]['expiry_date']],_0x591ab5=[..._0x438dde['body'][_0x1387a2(0x177)]],_0x8288fb=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x165)]],_0x2b874c=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0xde)]],_0x1463e0=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x195)]],_0x145399=[..._0x438dde[_0x1387a2(0x148)]['RoomAssigned']],_0x2d9d53=[..._0x438dde[_0x1387a2(0x148)][_0x1387a2(0x163)]],_0x5cb022=[..._0x438dde[_0x1387a2(0x148)]['from_invoice']],_0x546e52=[..._0x438dde[_0x1387a2(0x148)]['id_transaction']];const _0x5158ef=_0x4c857['map'](_0x48ebbc=>{return _0x48ebbc={'product_name':_0x48ebbc};});_0x5172b3[_0x1387a2(0xe9)]((_0x31067f,_0xf29349)=>{var _0x14566e=_0x1387a2;_0x5158ef[_0xf29349][_0x14566e(0x194)]=_0x31067f;}),_0x2f2b0a[_0x1387a2(0xe9)]((_0xa8f9ad,_0x501b25)=>{var _0x383e2e=_0x1387a2,_0x458a42=_0xa8f9ad[_0x383e2e(0x10a)](/[A-Za-z]+/)[0x0],_0x489219=parseInt(_0xa8f9ad[_0x383e2e(0x10a)](/\d+/)[0x0]);_0x5158ef[_0x501b25][_0x383e2e(0x197)]=_0x489219,_0x5158ef[_0x501b25][_0x383e2e(0xdf)]=_0x458a42;}),_0x546e52[_0x1387a2(0xe9)]((_0x5555e7,_0x2a45e9)=>{var _0x38be7b=_0x1387a2;_0x5158ef[_0x2a45e9][_0x38be7b(0x15f)]=_0x5555e7;}),_0x5cb022[_0x1387a2(0xe9)]((_0x15d416,_0x2133e8)=>{var _0x3d9cae=_0x1387a2;_0x5158ef[_0x2133e8][_0x3d9cae(0x17a)]=_0x15d416;}),_0x2e5f19[_0x1387a2(0xe9)]((_0x21db9f,_0x329fe5)=>{var _0x189c16=_0x1387a2;_0x5158ef[_0x329fe5][_0x189c16(0x12e)]=_0x21db9f;}),_0x3e402c['forEach']((_0x6b0368,_0x419c0f)=>{var _0x42a88b=_0x1387a2,_0x2d14c6=_0x6b0368['match'](/[A-Za-z]+/)[0x0],_0x5f420b=parseInt(_0x6b0368[_0x42a88b(0x10a)](/\d+/)[0x0]);_0x5158ef[_0x419c0f]['to_level']=_0x2d14c6,_0x5158ef[_0x419c0f]['to_bay']=_0x5f420b;}),_0x20a562[_0x1387a2(0xe9)]((_0x275ccc,_0x5d5340)=>{_0x5158ef[_0x5d5340]['primary_code']=_0x275ccc;}),_0x24d6df['forEach']((_0x1f98de,_0x2707db)=>{_0x5158ef[_0x2707db]['secondary_code']=_0x1f98de;}),_0x53ccfa[_0x1387a2(0xe9)]((_0x175ad1,_0x57cc54)=>{var _0x4cb10e=_0x1387a2;_0x5158ef[_0x57cc54][_0x4cb10e(0x18e)]=_0x175ad1;}),_0x29a508[_0x1387a2(0xe9)]((_0x420de1,_0x4bc3ec)=>{var _0xcdee=_0x1387a2;_0x5158ef[_0x4bc3ec][_0xcdee(0x17d)]=_0x420de1;}),_0x25ba5f['forEach']((_0x262e60,_0x529375)=>{var _0x71aeca=_0x1387a2;_0x5158ef[_0x529375][_0x71aeca(0x16d)]=_0x262e60;}),_0x3b93d5[_0x1387a2(0xe9)]((_0x54bf12,_0x5ef5d1)=>{_0x5158ef[_0x5ef5d1]['secondary_unit']=_0x54bf12;}),_0x3a6896[_0x1387a2(0xe9)]((_0x54f096,_0x255867)=>{var _0x3fac35=_0x1387a2;_0x5158ef[_0x255867][_0x3fac35(0x180)]=_0x54f096;}),_0x3c93cb['forEach']((_0x3bca34,_0x374fea)=>{var _0x46292d=_0x1387a2;_0x5158ef[_0x374fea][_0x46292d(0x170)]=_0x3bca34;}),_0x591ab5[_0x1387a2(0xe9)]((_0x119cdf,_0x3f8dce)=>{var _0x5ad129=_0x1387a2;_0x5158ef[_0x3f8dce][_0x5ad129(0x18a)]=_0x119cdf;}),_0x8288fb[_0x1387a2(0xe9)]((_0x24275d,_0x1d9941)=>{var _0x17599a=_0x1387a2;_0x5158ef[_0x1d9941][_0x17599a(0x17d)]=_0x24275d;}),_0x2b874c[_0x1387a2(0xe9)]((_0x527780,_0x2827d9)=>{_0x5158ef[_0x2827d9]['maxPerUnit']=_0x527780;}),_0x1463e0['forEach']((_0x1da78f,_0x4477f6)=>{var _0x246873=_0x1387a2;_0x5158ef[_0x4477f6][_0x246873(0x195)]=_0x1da78f;}),_0x145399[_0x1387a2(0xe9)]((_0x4b45ef,_0x236696)=>{var _0xdd29d0=_0x1387a2;_0x5158ef[_0x236696][_0xdd29d0(0xe8)]=_0x4b45ef;}),_0x2d9d53[_0x1387a2(0xe9)]((_0x344cd1,_0x560980)=>{var _0x26f8c4=_0x1387a2;_0x5158ef[_0x560980][_0x26f8c4(0x156)]=_0x344cd1;});const _0x2f96ea=_0x5158ef[_0x1387a2(0x166)](_0x54c363=>_0x54c363['to_quantity']!=='0'&&_0x54c363[_0x1387a2(0x12e)]!==''||_0x54c363[_0x1387a2(0x171)]!=='0'&&_0x54c363[_0x1387a2(0x171)]!=='');var _0x358b1a=0x0;_0x2f96ea[_0x1387a2(0xe9)](_0x5af650=>{var _0x51ae18=_0x1387a2;parseInt(_0x5af650[_0x51ae18(0x194)])<parseInt(_0x5af650[_0x51ae18(0x12e)])&&_0x358b1a++;});if(_0x358b1a!=0x0)return _0x438dde['flash']('errors',_0x1387a2(0xf8)),_0x36f506[_0x1387a2(0x13d)](_0x1387a2(0x13c));const _0x206931=new invoice_for_transfer();await _0x206931['save']();for(let _0x26b2ce=0x0;_0x26b2ce<=_0x2d9d53[_0x1387a2(0xf6)]-0x1;_0x26b2ce++){_0x5158ef[_0x26b2ce][_0x1387a2(0xfe)]=_0x1387a2(0xdc)+_0x206931[_0x1387a2(0x13e)][_0x1387a2(0x13f)]()[_0x1387a2(0xe6)](0x8,'0');}const _0x41ebc7=new transfers_finished({'date':_0x1b820b,'from_warehouse':_0x370e4d,'to_warehouse':_0x3202f6,'product':_0x2f96ea,'note':_0x5eacbe,'invoice':_0x1387a2(0xdc)+_0x206931['invoice_init'][_0x1387a2(0x13f)]()[_0x1387a2(0xe6)](0x8,'0'),'type_of_transaction':'own','type_of_process':_0x1387a2(0x15a),'PO_number':_0x38c6a8,'RequestedBy':_0x411b49,'DateofRequest':_0x3accac,'typeservices':_0x4aca5f,'destination':_0x19d08e,'deliverydate':_0xebe7ee,'driver':_0x545282,'plate':_0x3d8ffc,'van':_0x1c74f7,'DRSI':_0x1e4081,'typevehicle':_0x1c5083,'TSU':_0x2bd930,'TFU':_0xab186b}),_0x4b6eee=await _0x41ebc7[_0x1387a2(0x106)]();_0x438dde[_0x1387a2(0x16b)]('success','Product\x20Transfer\x20successfully'),_0x36f506[_0x1387a2(0x13d)](_0x1387a2(0xed)+_0x4b6eee[_0x1387a2(0x12c)]);}catch(_0x3b78e7){console[_0x1387a2(0x117)](_0x3b78e7),_0x36f506[_0x1387a2(0x14b)](0xc8)['json']({'errorMessage':_0x3b78e7[_0x1387a2(0x125)]});}}),router['get'](a0_0x4fa854(0x130),auth,async(_0x5e0bd3,_0x46f4a6)=>{var _0x15aabd=a0_0x4fa854;try{const {username:_0x4cdce6,email:_0x293114,role:_0xaf7714}=_0x5e0bd3[_0x15aabd(0xe3)],_0x379d23=_0x5e0bd3[_0x15aabd(0xe3)],_0x1ff583=await profile[_0x15aabd(0x16c)]({'email':_0x379d23['email']}),_0x2321b8=await master_shop['find'](),_0x276b14=await transfers_finished[_0x15aabd(0x175)](_0x5e0bd3['params']['id']);let _0x1931e1;if(_0x379d23[_0x15aabd(0x16e)]==_0x15aabd(0x138)){const _0x4c7e18=await staff[_0x15aabd(0x16c)]({'email':_0x379d23['email']});_0x1931e1=await warehouse[_0x15aabd(0x11d)]({'status':_0x15aabd(0x136),'name':_0x4c7e18[_0x15aabd(0xff)],'warehouse_category':_0x15aabd(0x100)});}else _0x1931e1=await warehouse[_0x15aabd(0x11d)]({'status':_0x15aabd(0x136),'warehouse_category':_0x15aabd(0x100)});const _0x5090ee=await warehouse[_0x15aabd(0x192)]([{'$match':{'name':_0x276b14['from_warehouse'],'warehouse_category':_0x15aabd(0x100)}},{'$unwind':_0x15aabd(0xe0)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x15aabd(0x184)},'product_stock':{'$first':_0x15aabd(0x11f)},'bay':{'$first':_0x15aabd(0x18c)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x15aabd(0x14c)},'floorlevel':{'$first':_0x15aabd(0x161)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x15aabd(0xe4)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x15aabd(0x190)},'production_date':{'$first':_0x15aabd(0xe5)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x15aabd(0xe2)}}}]),_0x1133d3=await product['find']({});if(_0x2321b8[0x0]['language']=='English\x20(US)'){var _0x3b545f=users['English'];console['log'](_0x3b545f);}else{if(_0x2321b8[0x0][_0x15aabd(0x111)]=='Hindi')var _0x3b545f=users[_0x15aabd(0x150)];else{if(_0x2321b8[0x0][_0x15aabd(0x111)]==_0x15aabd(0x104))var _0x3b545f=users['German'];else{if(_0x2321b8[0x0][_0x15aabd(0x111)]==_0x15aabd(0xfd))var _0x3b545f=users[_0x15aabd(0xfd)];else{if(_0x2321b8[0x0][_0x15aabd(0x111)]==_0x15aabd(0x103))var _0x3b545f=users[_0x15aabd(0x103)];else{if(_0x2321b8[0x0]['language']==_0x15aabd(0x196))var _0x3b545f=users['Portuguese'];else{if(_0x2321b8[0x0][_0x15aabd(0x111)]==_0x15aabd(0x131))var _0x3b545f=users[_0x15aabd(0x131)];else{if(_0x2321b8[0x0]['language']==_0x15aabd(0x157))var _0x3b545f=users['Arabic'];}}}}}}}_0x46f4a6['render'](_0x15aabd(0x159),{'success':_0x5e0bd3[_0x15aabd(0x16b)](_0x15aabd(0x19b)),'errors':_0x5e0bd3[_0x15aabd(0x16b)](_0x15aabd(0x134)),'role':_0x379d23,'profile':_0x1ff583,'master_shop':_0x2321b8,'warehouse':_0x1931e1,'transfer':_0x276b14,'stock':_0x5090ee,'unit':_0x1133d3,'language':_0x3b545f});}catch(_0x3fe41f){console['log'](_0x3fe41f);}}),router['post'](a0_0x4fa854(0x130),auth,async(_0x36a97a,_0x4345dd)=>{var _0x2f128d=a0_0x4fa854;try{const {invoice:_0x1ffa19,from_warehouse:_0x1b1d52,FromRoom_name:_0x5b6969,to_warehouse:_0x525470,ToRoom_name:_0x1ea711}=_0x36a97a[_0x2f128d(0x148)],_0x2dab15=await transfers_finished[_0x2f128d(0x175)](_0x36a97a['params']['id']),_0xc971=_0x2dab15[_0x2f128d(0x164)][_0x2f128d(0x10d)](async _0x7e055c=>{var _0x38f83c=_0x2f128d;if(_0x7e055c[_0x38f83c(0x12e)]>0x0){var _0x3547eb=await warehouse[_0x38f83c(0x16c)]({'name':_0x1b1d52,'room':_0x7e055c['from_room_name']});const _0x2ed931=_0x3547eb['product_details'][_0x38f83c(0x10d)](_0x24b890=>{var _0x1e74c9=_0x38f83c;_0x24b890['_id']==_0x7e055c[_0x1e74c9(0x15f)]&&(_0x24b890[_0x1e74c9(0xeb)]=Math[_0x1e74c9(0x149)](0x0,Math[_0x1e74c9(0x14a)](_0x24b890[_0x1e74c9(0xeb)])-Math[_0x1e74c9(0x14a)](_0x7e055c[_0x1e74c9(0x12e)])),console[_0x1e74c9(0x117)](_0x24b890[_0x1e74c9(0xeb)]));});}return _0x3547eb;});Promise['all'](_0xc971)[_0x2f128d(0x10f)](async _0x4cfee1=>{var _0x2a8472=_0x2f128d;try{for(const _0x51953a of _0x4cfee1){await _0x51953a[_0x2a8472(0x106)]();}const _0x296c12=_0x2dab15[_0x2a8472(0x164)][_0x2a8472(0x10d)](async _0x2133d9=>{var _0x51af39=_0x2a8472,_0x90790=await warehouse[_0x51af39(0x16c)]({'name':_0x525470,'room':_0x2133d9[_0x51af39(0x156)]});if(_0x2133d9[_0x51af39(0x12e)]>0x0){var _0x4348cb=0x0;const _0x3c3ccc=_0x90790[_0x51af39(0x187)][_0x51af39(0x10d)](_0x6a97d3=>{var _0x28cfde=_0x51af39;_0x6a97d3[_0x28cfde(0xea)]==_0x2133d9[_0x28cfde(0xea)]&&_0x6a97d3['bay']==_0x2133d9['to_bay']&&_0x6a97d3[_0x28cfde(0x170)]==_0x2133d9[_0x28cfde(0x170)]&&_0x6a97d3[_0x28cfde(0x18a)]==_0x2133d9[_0x28cfde(0x18a)]&&_0x6a97d3[_0x28cfde(0x180)]==_0x2133d9['batch_code']&&_0x6a97d3[_0x28cfde(0x183)]==_0x2133d9['To_invoice']&&(typeof _0x2133d9[_0x28cfde(0x15f)]==_0x28cfde(0x173)?(console[_0x28cfde(0x117)](_0x28cfde(0x158),_0x6a97d3[_0x28cfde(0xeb)]+_0x28cfde(0x188)+_0x6a97d3[_0x28cfde(0x12c)]+_0x28cfde(0x152)+Math[_0x28cfde(0x14a)](_0x6a97d3[_0x28cfde(0xeb)])+Math[_0x28cfde(0x14a)](_0x2133d9[_0x28cfde(0x12e)])),_0x6a97d3['product_stock']=Math['abs'](_0x6a97d3['product_stock'])+Math[_0x28cfde(0x14a)](_0x2133d9[_0x28cfde(0x12e)])):_0x6a97d3[_0x28cfde(0xeb)]=Math[_0x28cfde(0x14a)](_0x6a97d3[_0x28cfde(0xeb)])+Math[_0x28cfde(0x14a)](_0x2133d9[_0x28cfde(0x12e)]),_0x4348cb++);});_0x4348cb=='0'&&(_0x90790[_0x51af39(0x187)]=_0x90790[_0x51af39(0x187)][_0x51af39(0x14f)]({'product_name':_0x2133d9[_0x51af39(0xea)],'product_stock':_0x2133d9[_0x51af39(0x12e)],'bay':_0x2133d9[_0x51af39(0x121)],'level':_0x2133d9[_0x51af39(0x15b)],'product_code':_0x2133d9[_0x51af39(0x18e)],'primary_code':_0x2133d9['primary_code'],'secondary_code':_0x2133d9['secondary_code'],'expiry_date':_0x2133d9[_0x51af39(0x170)],'production_date':_0x2133d9['production_date'],'maxProducts':_0x2133d9[_0x51af39(0x17d)],'batch_code':_0x2133d9[_0x51af39(0x180)],'secondary_unit':_0x2133d9[_0x51af39(0x16f)],'unit':_0x2133d9[_0x51af39(0x16d)],'maxProducts':_0x2133d9[_0x51af39(0x17d)],'maxPerUnit':_0x2133d9['maxPerUnit'],'invoice':_0x2133d9['To_invoice']}));}return _0x90790;});Promise[_0x2a8472(0x112)](_0x296c12)[_0x2a8472(0x10f)](async _0x25e3f6=>{var _0x4eff0c=_0x2a8472;try{console[_0x4eff0c(0x117)](_0x2dab15[_0x4eff0c(0x105)]);if(_0x2dab15[_0x4eff0c(0x105)]!=_0x4eff0c(0x15a))for(const _0x472bf6 of _0x25e3f6){await warehouse[_0x4eff0c(0x154)]({'_id':_0x472bf6[_0x4eff0c(0x12c)]},{'$addToSet':{'product_details':{'$each':_0x472bf6['product_details']}}});}_0x2dab15['finalize']=_0x4eff0c(0x10b);const _0x32bcab=await _0x2dab15[_0x4eff0c(0x106)](),_0x301d67=await master_shop['find'](),_0x5bd9d7=await email_settings[_0x4eff0c(0x16c)](),_0x53033=await supervisor_settings[_0x4eff0c(0x11d)]();var _0x3e1b27=_0x2dab15[_0x4eff0c(0x164)],_0x385a66='',_0x320d66;for(_0x320d66 in _0x3e1b27){var _0x361541='FG';_0x2dab15[_0x4eff0c(0xec)]=='DRY\x20GOODS'&&(_0x361541='DG'),_0x385a66+=_0x4eff0c(0x162)+_0x4eff0c(0xdd)+_0x3e1b27[_0x320d66]['product_name']+'</td>'+_0x4eff0c(0xdd)+_0x3e1b27[_0x320d66][_0x4eff0c(0x18e)]+_0x4eff0c(0x153)+_0x4eff0c(0xdd)+_0x3e1b27[_0x320d66]['to_quantity']+'</td>'+_0x4eff0c(0xdd)+_0x3e1b27[_0x320d66][_0x4eff0c(0x16d)]+_0x4eff0c(0x153)+_0x4eff0c(0xdd)+_0x3e1b27[_0x320d66][_0x4eff0c(0x16f)]+_0x4eff0c(0x153)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2dab15[_0x4eff0c(0xec)]+_0x4eff0c(0x153)+_0x4eff0c(0xdd)+_0x3e1b27[_0x320d66][_0x4eff0c(0x156)]+_0x4eff0c(0x153)+_0x4eff0c(0xdd)+_0x361541+_0x3e1b27[_0x320d66][_0x4eff0c(0x121)]+_0x4eff0c(0x153)+_0x4eff0c(0x135);}_0x36a97a[_0x4eff0c(0x16b)](_0x4eff0c(0x19b),_0x4eff0c(0x10c)),_0x4345dd[_0x4eff0c(0x13d)](_0x4eff0c(0xf0)+_0x32bcab[_0x4eff0c(0x12c)]);}catch(_0x37f14f){console[_0x4eff0c(0x12f)](_0x37f14f),_0x4345dd['status'](0x1f4)[_0x4eff0c(0x178)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x2a8472(0xf3)](_0x47e35b=>{var _0x278f0d=_0x2a8472;console[_0x278f0d(0x12f)](_0x47e35b),_0x4345dd[_0x278f0d(0x14b)](0x1f4)[_0x278f0d(0x178)]({'error':'An\x20error\x20occurred.'});});}catch(_0x58cf83){console[_0x2a8472(0x12f)](_0x58cf83),_0x4345dd[_0x2a8472(0x14b)](0x1f4)[_0x2a8472(0x178)]({'error':_0x2a8472(0x155)});}})[_0x2f128d(0xf3)](_0x40fbb8=>{var _0x2d5458=_0x2f128d;console['error'](_0x40fbb8),_0x4345dd[_0x2d5458(0x14b)](0x1f4)[_0x2d5458(0x178)]({'error':_0x2d5458(0xfb)});});}catch(_0x513fb7){_0x4345dd['json']({'message':_0x513fb7[_0x2f128d(0x125)]});}});function BayBinSelected(_0x1abb8a,_0x1222f8){var _0xbcf56e=a0_0x4fa854,_0x46db73=[];let _0x2d0d1f=[];var _0x3eac1f=[];if(_0x1abb8a==_0xbcf56e(0x109)){switch(_0x1222f8){case'Rack\x201':_0x46db73=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x46db73=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3eac1f=['DG'];}else{if(_0x1abb8a==_0xbcf56e(0x139)){switch(_0x1222f8){case'Rack\x201':_0x46db73=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0xbcf56e(0x101):_0x46db73=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3eac1f=['FG'];}}return{'levels':_0x46db73,'identify':_0x3eac1f};}router[a0_0x4fa854(0x17c)]('/view/:id',auth,async(_0x33cb1a,_0x1a74f2)=>{var _0x3f1030=a0_0x4fa854;try{const {username:_0x3e03ec,email:_0x137804,role:_0x8b6f44}=_0x33cb1a[_0x3f1030(0xe3)],_0xcc15c9=_0x33cb1a[_0x3f1030(0xe3)],_0x1c44ac=await profile[_0x3f1030(0x16c)]({'email':_0xcc15c9[_0x3f1030(0x118)]}),_0x4230e3=await master_shop[_0x3f1030(0x11d)](),_0x11a671=await transfers_finished['findById'](_0x33cb1a['params']['id']);let _0x3b25c4=new Date(_0x11a671[_0x3f1030(0x170)]),_0x381fa1=('0'+_0x3b25c4[_0x3f1030(0x116)]())[_0x3f1030(0xef)](-0x2),_0x1df06e=('0'+(_0x3b25c4['getMonth']()+0x1))[_0x3f1030(0xef)](-0x2),_0x131738=_0x3b25c4[_0x3f1030(0x15e)](),_0x51ebca=_0x131738+'-'+_0x1df06e+'-'+_0x381fa1,_0x313863;if(_0xcc15c9[_0x3f1030(0x16e)]==_0x3f1030(0x138)){const _0x4dd7be=await staff[_0x3f1030(0x16c)]({'email':_0xcc15c9[_0x3f1030(0x118)]});_0x313863=await warehouse[_0x3f1030(0x11d)]({'status':_0x3f1030(0x136),'name':_0x4dd7be['warehouse'],'warehouse_category':_0x3f1030(0x100)});}else _0x313863=await warehouse[_0x3f1030(0x11d)]({'status':'Enabled','warehouse_category':'Finished\x20Goods'});const _0x2b6b2f=await warehouse[_0x3f1030(0x192)]([{'$match':{'name':_0x11a671[_0x3f1030(0xe7)],'room':_0x11a671[_0x3f1030(0x119)]}},{'$unwind':_0x3f1030(0xe0)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3f1030(0x11f)},'bay':{'$first':_0x3f1030(0x18c)},'bin':{'$first':_0x3f1030(0x19a)},'type':{'$first':_0x3f1030(0x14c)},'floorlevel':{'$first':_0x3f1030(0x161)},'primary_code':{'$first':_0x3f1030(0x193)},'secondary_code':{'$first':_0x3f1030(0x113)},'product_code':{'$first':_0x3f1030(0x11a)},'storage':{'$first':_0x3f1030(0xe4)},'rack':{'$first':_0x3f1030(0x141)}}}]);var _0x3115ab=[0x1,0x2,0x3,0x4],_0x3e6e87=['A','B','C','D','E','F','G','H','I','J'],_0x1156d9=[_0x3f1030(0x11e),'Enclosed'];const _0x42ae85=await product[_0x3f1030(0x11d)]({}),_0x1dbbef=BayBinSelected(_0x11a671[_0x3f1030(0xec)],_0x11a671[_0x3f1030(0x124)]);if(_0x4230e3[0x0][_0x3f1030(0x111)]=='English\x20(US)'){var _0x37424e=users[_0x3f1030(0x115)];console[_0x3f1030(0x117)](_0x37424e);}else{if(_0x4230e3[0x0]['language']==_0x3f1030(0x150))var _0x37424e=users[_0x3f1030(0x150)];else{if(_0x4230e3[0x0]['language']==_0x3f1030(0x104))var _0x37424e=users[_0x3f1030(0x104)];else{if(_0x4230e3[0x0][_0x3f1030(0x111)]==_0x3f1030(0xfd))var _0x37424e=users['Spanish'];else{if(_0x4230e3[0x0][_0x3f1030(0x111)]==_0x3f1030(0x103))var _0x37424e=users['French'];else{if(_0x4230e3[0x0][_0x3f1030(0x111)]=='Portuguese\x20(BR)')var _0x37424e=users['Portuguese'];else{if(_0x4230e3[0x0][_0x3f1030(0x111)]==_0x3f1030(0x131))var _0x37424e=users[_0x3f1030(0x131)];else{if(_0x4230e3[0x0][_0x3f1030(0x111)]==_0x3f1030(0x157))var _0x37424e=users[_0x3f1030(0x19f)];}}}}}}}_0x1a74f2[_0x3f1030(0x142)]('edit_transfer_finished',{'success':_0x33cb1a['flash']('success'),'errors':_0x33cb1a[_0x3f1030(0x16b)](_0x3f1030(0x134)),'role':_0xcc15c9,'profile':_0x1c44ac,'master_shop':_0x4230e3,'warehouse':_0x313863,'transfer':_0x11a671,'stock':_0x2b6b2f,'unit':_0x42ae85,'language':_0x37424e,'levels':_0x3115ab,'Isle':_0x3e6e87,'rooms_data':_0x1156d9,'ed_fullDate':_0x51ebca,'dataSelected':_0x1dbbef});}catch(_0x19c5ab){console[_0x3f1030(0x117)](_0x19c5ab);}}),router[a0_0x4fa854(0x15c)]('/view/:id',auth,async(_0x5e21b6,_0x3bcf80)=>{var _0x4a400a=a0_0x4fa854;try{const _0x5f12a7=_0x5e21b6[_0x4a400a(0xf5)]['id'];console['log'](_0x5e21b6[_0x4a400a(0x148)]);const _0x4ebab3=await transfers_finished['findById'](_0x5f12a7);console[_0x4a400a(0x117)]('transfer_data',_0x4ebab3);const {date:_0x214340,from_warehouse:_0x368491,FromRoom_name:_0x3c8486,to_warehouse:_0x42889a,ToRoom_name:_0x2a0a22,prod_name:_0x59db62,from_prod_qty:_0x40209b,from_prod_level:_0x424f0e,from_prod_isle:_0x3eab86,from_prod_pallet:_0x41b75a,to_prod_qty:_0x8d3326,to_prod_level:_0x3a4ae6,to_prod_isle:_0x4835db,to_prod_pallet:_0x3d9a90,primary_code:_0x586280,secondary_code:_0x245875,product_code3:_0x411fe3,note:_0x1e0fcd,invoice:_0x436015,expiry_date:_0x206e7c}=_0x5e21b6[_0x4a400a(0x148)];if(typeof _0x59db62==_0x4a400a(0xee))var _0x81bab7=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x102)]],_0xac4e4c=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x143)]],_0x5479da=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x11b)]],_0x26a672=[_0x5e21b6[_0x4a400a(0x148)]['to_prod_qty']],_0x1dabd3=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x144)]],_0xc58ee9=[_0x5e21b6['body'][_0x4a400a(0x19d)]],_0x5c5ede=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x179)]],_0x2b60b3=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x18f)]],_0x571abc=[_0x5e21b6['body'][_0x4a400a(0x199)]],_0x3555af=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x16d)]],_0x105c50=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x16f)]],_0x4f4fe1=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x180)]],_0x1a7ff6=[_0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x170)]];else var _0x81bab7=[..._0x5e21b6['body'][_0x4a400a(0x102)]],_0xac4e4c=[..._0x5e21b6['body']['from_prod_qty']],_0x5479da=[..._0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x11b)]],_0x26a672=[..._0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x145)]],_0x1dabd3=[..._0x5e21b6[_0x4a400a(0x148)]['to_prod_level']],_0xc58ee9=[..._0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x19d)]],_0x5c5ede=[..._0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x179)]],_0x2b60b3=[..._0x5e21b6[_0x4a400a(0x148)]['product_code3']],_0x571abc=[..._0x5e21b6['body'][_0x4a400a(0x199)]],_0x3555af=[..._0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x16d)]],_0x105c50=[..._0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x16f)]],_0x4f4fe1=[..._0x5e21b6[_0x4a400a(0x148)][_0x4a400a(0x180)]],_0x1a7ff6=[..._0x5e21b6['body'][_0x4a400a(0x170)]];const _0x3603ef=_0x81bab7[_0x4a400a(0x10d)](_0x86bc15=>{return _0x86bc15={'product_name':_0x86bc15};});_0xac4e4c[_0x4a400a(0xe9)]((_0x4132c7,_0x18205f)=>{_0x3603ef[_0x18205f]['from_quantity']=_0x4132c7;}),_0x5479da[_0x4a400a(0xe9)]((_0x420959,_0x1d8703)=>{var _0x3af77b=_0x4a400a;_0x3603ef[_0x1d8703][_0x3af77b(0x197)]=_0x420959;}),_0x26a672[_0x4a400a(0xe9)]((_0x37751e,_0x5e0028)=>{_0x3603ef[_0x5e0028]['to_quantity']=_0x37751e;}),_0x1dabd3['forEach']((_0x14d190,_0x90ef1b)=>{_0x3603ef[_0x90ef1b]['to_bay']=_0x14d190;}),_0xc58ee9[_0x4a400a(0xe9)]((_0x116f83,_0x5c654c)=>{var _0x3a38c2=_0x4a400a;_0x3603ef[_0x5c654c][_0x3a38c2(0x19d)]=_0x116f83;}),_0x5c5ede[_0x4a400a(0xe9)]((_0xe09b24,_0x43b529)=>{var _0x5124f9=_0x4a400a;_0x3603ef[_0x43b529][_0x5124f9(0x179)]=_0xe09b24;}),_0x2b60b3[_0x4a400a(0xe9)]((_0x398c6c,_0x3469bd)=>{var _0x4612c1=_0x4a400a;_0x3603ef[_0x3469bd][_0x4612c1(0x18e)]=_0x398c6c;}),_0x571abc[_0x4a400a(0xe9)]((_0x5321ba,_0x1898d9)=>{var _0x4b8469=_0x4a400a;_0x3603ef[_0x1898d9][_0x4b8469(0x17d)]=_0x5321ba;}),_0x3555af[_0x4a400a(0xe9)]((_0x28c8d2,_0x4ae63c)=>{var _0x317ff2=_0x4a400a;_0x3603ef[_0x4ae63c][_0x317ff2(0x16d)]=_0x28c8d2;}),_0x105c50[_0x4a400a(0xe9)]((_0x54df56,_0x6e1ec6)=>{var _0x3bc777=_0x4a400a;_0x3603ef[_0x6e1ec6][_0x3bc777(0x16f)]=_0x54df56;}),_0x4f4fe1[_0x4a400a(0xe9)]((_0x79da23,_0x22c209)=>{var _0x3a4673=_0x4a400a;_0x3603ef[_0x22c209][_0x3a4673(0x180)]=_0x79da23;}),_0x1a7ff6[_0x4a400a(0xe9)]((_0x509047,_0x43a7b9)=>{var _0x851975=_0x4a400a;_0x3603ef[_0x43a7b9][_0x851975(0x170)]=_0x509047;});const _0x38c647=_0x3603ef[_0x4a400a(0x166)](_0x3958ff=>_0x3958ff['to_quantity']!=='0'&&_0x3958ff[_0x4a400a(0x12e)]!==''||_0x3958ff[_0x4a400a(0x171)]!=='0'&&_0x3958ff[_0x4a400a(0x171)]!=='');var _0x5c7b6d=0x0;_0x38c647[_0x4a400a(0xe9)](_0x173466=>{var _0x4d70c9=_0x4a400a;parseInt(_0x173466['from_quantity'])<parseInt(_0x173466[_0x4d70c9(0x12e)])&&_0x5c7b6d++;});if(_0x5c7b6d!=0x0)return _0x5e21b6[_0x4a400a(0x16b)](_0x4a400a(0x134),_0x4a400a(0xf8)),_0x3bcf80[_0x4a400a(0x13d)](_0x4a400a(0x13c));const _0xb05edb=await warehouse[_0x4a400a(0x16c)]({'name':_0x4ebab3['from_warehouse'],'room':_0x4ebab3['from_room']});_0x4ebab3['product'][_0x4a400a(0xe9)](_0x4e76a3=>{var _0x529b8d=_0x4a400a;if(_0x4e76a3[_0x529b8d(0x12e)]>0x0){const _0x3e506a=_0xb05edb[_0x529b8d(0x187)][_0x529b8d(0x10d)](_0x4c0463=>{var _0xc9d14b=_0x529b8d;_0x4c0463['product_name']==_0x4e76a3[_0xc9d14b(0xea)]&&_0x4c0463[_0xc9d14b(0x108)]==_0x4e76a3['from_bay']&&(_0x4c0463[_0xc9d14b(0xeb)]=parseInt(_0x4c0463[_0xc9d14b(0xeb)])+parseInt(_0x4e76a3['to_quantity']));});}}),await _0xb05edb['save']();const _0x34a7c1=await warehouse['findOne']({'name':_0x4ebab3['to_warehouse'],'room':_0x4ebab3['to_room']});_0x4ebab3['product'][_0x4a400a(0xe9)](_0x109408=>{var _0x1a0daa=_0x4a400a;if(_0x109408['to_quantity']>0x0){const _0x17269d=_0x34a7c1[_0x1a0daa(0x187)][_0x1a0daa(0x10d)](_0x25da23=>{var _0x1ab1f1=_0x1a0daa;_0x25da23[_0x1ab1f1(0xea)]==_0x109408[_0x1ab1f1(0xea)]&&_0x25da23[_0x1ab1f1(0x108)]==_0x109408[_0x1ab1f1(0x121)]&&(_0x25da23[_0x1ab1f1(0xeb)]=parseInt(_0x25da23[_0x1ab1f1(0xeb)])-parseInt(_0x109408[_0x1ab1f1(0x12e)]));});}}),await _0x34a7c1[_0x4a400a(0x106)](),_0x4ebab3[_0x4a400a(0xf7)]=_0x214340,_0x4ebab3[_0x4a400a(0xe7)]=_0x368491,_0x4ebab3[_0x4a400a(0xec)]=_0x42889a,_0x4ebab3[_0x4a400a(0x164)]=_0x38c647,_0x4ebab3['note']=_0x1e0fcd,_0x4ebab3[_0x4a400a(0x183)]=_0x436015;const _0x5533c6=await _0x4ebab3['save'](),_0x3393e4=await warehouse[_0x4a400a(0x16c)]({'name':_0x368491,'room':_0x3c8486});_0x5533c6[_0x4a400a(0x164)][_0x4a400a(0xe9)](_0x5d20c4=>{var _0x527bf0=_0x4a400a;if(_0x5d20c4[_0x527bf0(0x12e)]>0x0){const _0x3acd51=_0x3393e4[_0x527bf0(0x187)][_0x527bf0(0x10d)](_0xb0eb17=>{var _0x368816=_0x527bf0;_0xb0eb17[_0x368816(0xea)]==_0x5d20c4[_0x368816(0xea)]&&_0xb0eb17['bay']==_0x5d20c4[_0x368816(0x197)]&&(_0xb0eb17[_0x368816(0xeb)]=parseInt(_0xb0eb17['product_stock'])-parseInt(_0x5d20c4[_0x368816(0x12e)]));});}}),await _0x3393e4['save']();const _0x2e2be6=await warehouse[_0x4a400a(0x16c)]({'name':_0x42889a,'room':_0x2a0a22});_0x5533c6['product'][_0x4a400a(0xe9)](_0x4fb695=>{var _0x2b5506=_0x4a400a;if(_0x4fb695[_0x2b5506(0x12e)]>0x0){var _0x4f0e2c=0x0;const _0x33921a=_0x2e2be6[_0x2b5506(0x187)][_0x2b5506(0x10d)](_0x4c2ec6=>{var _0x3ef485=_0x2b5506;_0x4c2ec6[_0x3ef485(0xea)]==_0x4fb695[_0x3ef485(0xea)]&&_0x4c2ec6[_0x3ef485(0x108)]==_0x4fb695[_0x3ef485(0x121)]&&(_0x4c2ec6[_0x3ef485(0xeb)]=parseInt(_0x4c2ec6[_0x3ef485(0xeb)])+parseInt(_0x4fb695['to_quantity']),_0x4f0e2c++);});_0x4f0e2c=='0'&&(_0x2e2be6['product_details']=_0x2e2be6[_0x2b5506(0x187)][_0x2b5506(0x14f)]({'product_name':_0x4fb695[_0x2b5506(0xea)],'product_stock':_0x4fb695[_0x2b5506(0x12e)],'bay':_0x4fb695[_0x2b5506(0x121)],'product_code':_0x4fb695[_0x2b5506(0x18e)],'primary_code':_0x4fb695[_0x2b5506(0x19d)],'secondary_code':_0x4fb695['secondary_code'],'maxProducts':_0x4fb695['maxProducts']}));}}),await _0x2e2be6[_0x4a400a(0x106)](),_0x5e21b6['flash'](_0x4a400a(0x19b),_0x4a400a(0x133)),_0x3bcf80[_0x4a400a(0x13d)]('/transfer_finished/view');}catch(_0xafa21b){console[_0x4a400a(0x117)](_0xafa21b);}}),router[a0_0x4fa854(0x15c)](a0_0x4fa854(0x18d),async(_0x37bc79,_0x528639)=>{var _0x487eec=a0_0x4fa854;const {FromWareHouse:_0x363614,FromRoom:_0x3e73f1,ToWarehouse:_0x540ab0,ToRoom:_0x51f5d9,primary_code:_0x4ba188,Roomslist:_0x45a0ea}=_0x37bc79['body'],_0x4e3ba0=_0x45a0ea['split'](','),_0x1c57bd=[];async function _0x3b2692(_0xe0d3a0){var _0x3713e9=a0_0xc8ab;const _0x357cca=await warehouse[_0x3713e9(0x192)]([{'$match':{'name':_0x363614,'room':_0xe0d3a0}},{'$unwind':_0x3713e9(0xe0)},{'$match':{'product_details.primary_code':_0x4ba188}},{'$group':{'_id':_0x3713e9(0x129),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x3713e9(0x11f)},'primary_code':{'$first':_0x3713e9(0x193)},'secondary_code':{'$first':_0x3713e9(0x113)},'product_code':{'$first':_0x3713e9(0x11a)},'bay':{'$first':_0x3713e9(0x18c)},'level':{'$first':_0x3713e9(0x18b)},'type':{'$first':_0x3713e9(0x14c)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3713e9(0xe4)},'rack':{'$first':_0x3713e9(0x141)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3713e9(0xe5)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x3713e9(0x146)},'roomNamed':{'$first':_0x3713e9(0x182)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x3713e9(0xfa)}}}]),_0x3e0f4e=await warehouse[_0x3713e9(0x192)]([{'$match':{'name':_0x363614,'room':_0xe0d3a0}},{'$unwind':_0x3713e9(0xe0)},{'$match':{'product_details.secondary_code':_0x4ba188}},{'$group':{'_id':_0x3713e9(0x129),'name':{'$first':_0x3713e9(0x184)},'instock':{'$first':_0x3713e9(0x11f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3713e9(0x113)},'product_code':{'$first':_0x3713e9(0x11a)},'bay':{'$first':_0x3713e9(0x18c)},'level':{'$first':_0x3713e9(0x18b)},'type':{'$first':_0x3713e9(0x14c)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x3713e9(0x169)},'secondary_unit':{'$first':_0x3713e9(0x176)},'storage':{'$first':_0x3713e9(0xe4)},'rack':{'$first':_0x3713e9(0x141)},'expiry_date':{'$first':_0x3713e9(0x190)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x3713e9(0x146)},'roomNamed':{'$first':_0x3713e9(0x182)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x3713e9(0xfa)}}}]);if(_0x357cca[_0x3713e9(0xf6)]>0x0)_0x1c57bd[_0x3713e9(0x107)](_0x357cca);else _0x3e0f4e[_0x3713e9(0xf6)]>0x0&&_0x1c57bd[_0x3713e9(0x107)](_0x3e0f4e);}const _0x4ff4f1=_0x4e3ba0['map'](_0x106db5=>_0x3b2692(_0x106db5));await Promise['all'](_0x4ff4f1),_0x528639[_0x487eec(0x178)](_0x1c57bd);}),router[a0_0x4fa854(0x15c)]('/CheckingWarehouse',async(_0x163241,_0x38d601)=>{var _0x4382ad=a0_0x4fa854;const {productCode:_0x2b277b,bay:_0x30d12,warehouses:_0x2245f4,room:_0x4149a2}=_0x163241[_0x4382ad(0x148)];console[_0x4382ad(0x117)](_0x163241[_0x4382ad(0x148)]);try{const _0x20a5fb=await warehouse[_0x4382ad(0x192)]([{'$match':{'name':_0x2245f4,'room':_0x4149a2}},{'$unwind':_0x4382ad(0xe0)},{'$match':{'product_details.bay':parseInt(_0x30d12)}},{'$group':{'_id':_0x4382ad(0x129),'name':{'$first':_0x4382ad(0x184)},'product_stock':{'$first':_0x4382ad(0x11f)},'bay':{'$first':_0x4382ad(0x18c)},'maxProducts':{'$first':_0x4382ad(0xdb)}}}]);_0x38d601[_0x4382ad(0x14b)](0xc8)[_0x4382ad(0x178)](_0x20a5fb);}catch(_0x156dfd){_0x38d601['status'](0x194)['json']({'message':_0x156dfd['message']});}}),module[a0_0x4fa854(0x137)]=router;function a0_0x277d(){var _0x129bb0=['to_level','post','4690040aGKzPf','getFullYear','id_transaction','random','$product_details.floorlevel','<tr>','ToRoomAssigned','product','MaxStocks_data','filter','There\x27s\x20a\x20error\x20in\x20this\x20transaction','choos_transfer_logs','$product_details.unit','logs','flash','findOne','unit','role','secondary_unit','expiry_date','to_floorlevel','59274ieXyKJ','undefined','Product\x20Transfer\x20successfully','findById','$product_details.secondary_unit','product_date','json','secondary_code','from_invoice','/view/choose','get','maxProducts','$product.from_room_name','$_id','batch_code','/view/add_transfer_loc','$room','invoice','$product_details.product_name','/transfer/view','primary_unit','product_details','\x20<>\x20','$from_warehouse','production_date','$product_details.level','$product_details.bay','/barcode_scanner','product_code','product_code3','$product_details.expiry_date','/view/add_transfer','aggregate','$product_details.primary_code','from_quantity','prod_cat','Portuguese\x20(BR)','from_bay','2202312dWVtBl','MaxStocks_data2','$product_details.bin','success','../models/all_models','primary_code','$finalize','Arabic','$product_details.maxProducts','TRF-','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','maxPerUnit','from_level','$product_details','transfer_finished','$name','user','$product_details.storage','$product_details.production_date','padStart','from_warehouse','from_room_name','forEach','product_name','product_stock','to_warehouse','/transfer_finished/preview/','string','slice','/picking_list/PDF_transfer/','$product','771992uTCijJ','catch','LOG-TRF-','params','length','date','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','own','$product_details.invoice','An\x20error\x20occurred.','bin2bin','Spanish','To_invoice','warehouse','Finished\x20Goods','Rack\x202','prod_name','French','German','type_of_process','save','push','bay','DRY\x20GOODS','match','True','Transfer\x20Finalize\x20Successfully','map','3464460LNEROV','then','296308FPjaWr','language','all','$product_details.secondary_code','from_prod_level2','English','getDate','log','email','from_room','$product_details.product_code','from_prod_level','$date','find','Ambient','$product_details.product_stock','RoomAssigned','to_bay','New_Qty_Converted','/view/addlog','to_room','message','70GIIhwy','Portuguese','TRFF-','$product_details._id','/view','$product.to_room_name','_id','/view/add_transfer_logs','to_quantity','error','/preview/:id','Chinese','/view/choose_logs','Transfer\x20Edit\x20Successfully','errors','</tr>','Enabled','exports','staff','FROZEN\x20GOODS','express','$to_warehouse','back','redirect','invoice_init','toString','choos_transfer','$product_details.rack','render','from_prod_qty','to_prod_level','to_prod_qty','$product_details.maxPerUnit','85367bPattQ','body','max','abs','status','$product_details.type','English\x20(US)','nodemailer','concat','Hindi','transfer_finished_logs','\x20<=>\x20','</td>','updateOne','An\x20error\x20occurred\x20while\x20saving\x20data.','to_room_name','Arabic\x20(ae)','here2','edit_transfer_finished_view','location2location'];a0_0x277d=function(){return _0x129bb0;};return a0_0x277d();}