var a0_0x228c30=a0_0x2853;function a0_0x2853(_0x43567d,_0x2725f4){var _0x4bc343=a0_0x4bc3();return a0_0x2853=function(_0x2853c9,_0x124c76){_0x2853c9=_0x2853c9-0xa0;var _0x31cf1b=_0x4bc343[_0x2853c9];return _0x31cf1b;},a0_0x2853(_0x43567d,_0x2725f4);}(function(_0x10e6b2,_0x49d94d){var _0x599273=a0_0x2853,_0x4825ba=_0x10e6b2();while(!![]){try{var _0x19236d=-parseInt(_0x599273(0x118))/0x1+-parseInt(_0x599273(0xff))/0x2*(-parseInt(_0x599273(0xf7))/0x3)+-parseInt(_0x599273(0xc1))/0x4+parseInt(_0x599273(0x161))/0x5*(parseInt(_0x599273(0xd0))/0x6)+-parseInt(_0x599273(0xf3))/0x7*(-parseInt(_0x599273(0xef))/0x8)+parseInt(_0x599273(0x137))/0x9+-parseInt(_0x599273(0xf9))/0xa;if(_0x19236d===_0x49d94d)break;else _0x4825ba['push'](_0x4825ba['shift']());}catch(_0x2124e4){_0x4825ba['push'](_0x4825ba['shift']());}}}(a0_0x4bc3,0x9aa79));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x228c30(0xb5)),nodemailer=require(a0_0x228c30(0x12c));router[a0_0x228c30(0xe8)](a0_0x228c30(0xb0),auth,async(_0x51c7dd,_0x24d3c2)=>{var _0x109102=a0_0x228c30;try{const {username:_0xd8df51,email:_0x2ec4f2,role:_0x559610}=_0x51c7dd[_0x109102(0x100)],_0x63f632=_0x51c7dd[_0x109102(0x100)],_0x21ab38=await profile[_0x109102(0x144)]({'email':_0x63f632[_0x109102(0x140)]}),_0x556086=await master_shop[_0x109102(0xc2)]();let _0x2422ea;if(_0x63f632['role']==_0x109102(0xfd)){const _0x2efa4b=await staff[_0x109102(0x144)]({'email':_0x63f632['email']});_0x2422ea=await transfers_finished['find']({'from_warehouse':_0x2efa4b['warehouse']});}else _0x2422ea=await transfers_finished[_0x109102(0x14b)]([{'$match':{'type_of_transaction':_0x109102(0x101)}},{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x109102(0xa6)},'date':{'$first':_0x109102(0x115)},'from_warehouse':{'$first':_0x109102(0x14e)},'to_warehouse':{'$first':_0x109102(0x14a)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x109102(0x15c)},'finalize':{'$first':_0x109102(0x155)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x556086[0x0][_0x109102(0xe6)]=='English\x20(US)')var _0x36bd=users['English'];else{if(_0x556086[0x0]['language']=='Hindi')var _0x36bd=users[_0x109102(0xf1)];else{if(_0x556086[0x0][_0x109102(0xe6)]==_0x109102(0x128))var _0x36bd=users[_0x109102(0x128)];else{if(_0x556086[0x0][_0x109102(0xe6)]==_0x109102(0xfc))var _0x36bd=users['Spanish'];else{if(_0x556086[0x0][_0x109102(0xe6)]==_0x109102(0xd4))var _0x36bd=users[_0x109102(0xd4)];else{if(_0x556086[0x0][_0x109102(0xe6)]==_0x109102(0xf5))var _0x36bd=users['Portuguese'];else{if(_0x556086[0x0][_0x109102(0xe6)]==_0x109102(0x138))var _0x36bd=users[_0x109102(0x138)];else{if(_0x556086[0x0]['language']==_0x109102(0x139))var _0x36bd=users[_0x109102(0x104)];}}}}}}}_0x24d3c2[_0x109102(0x157)]('transfer_finished',{'success':_0x51c7dd[_0x109102(0xc4)]('success'),'errors':_0x51c7dd['flash'](_0x109102(0xec)),'role':_0x63f632,'profile':_0x21ab38,'master_shop':_0x556086,'transfer':_0x2422ea,'language':_0x36bd});}catch(_0x28114f){console[_0x109102(0xb9)](_0x28114f);}}),router[a0_0x228c30(0xe8)]('/view_logs',auth,async(_0x1b07db,_0x50195f)=>{var _0x1e9fe6=a0_0x228c30;try{const {username:_0x227e0c,email:_0x5aa51c,role:_0x17e90e}=_0x1b07db['user'],_0x380809=_0x1b07db['user'],_0xe909ec=await profile['findOne']({'email':_0x380809[_0x1e9fe6(0x140)]}),_0x45afdb=await master_shop[_0x1e9fe6(0xc2)]();let _0x548727;if(_0x380809[_0x1e9fe6(0xd5)]==_0x1e9fe6(0xfd)){const _0x12f6d4=await staff[_0x1e9fe6(0x144)]({'email':_0x380809[_0x1e9fe6(0x140)]});_0x548727=await transfers_finished[_0x1e9fe6(0xc2)]({'from_warehouse':_0x12f6d4[_0x1e9fe6(0x15a)]});}else _0x548727=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x1e9fe6(0x11c)}},{'$unwind':_0x1e9fe6(0xbc)},{'$group':{'_id':_0x1e9fe6(0xfe),'invoice':{'$first':'$invoice'},'date':{'$first':_0x1e9fe6(0x115)},'from_warehouse':{'$first':_0x1e9fe6(0x14e)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x1e9fe6(0xa9)},'to_room_name':{'$addToSet':_0x1e9fe6(0x15c)},'finalize':{'$first':_0x1e9fe6(0x155)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x45afdb[0x0][_0x1e9fe6(0xe6)]==_0x1e9fe6(0x132))var _0x3153bb=users[_0x1e9fe6(0xaf)];else{if(_0x45afdb[0x0]['language']==_0x1e9fe6(0xf1))var _0x3153bb=users['Hindi'];else{if(_0x45afdb[0x0][_0x1e9fe6(0xe6)]==_0x1e9fe6(0x128))var _0x3153bb=users[_0x1e9fe6(0x128)];else{if(_0x45afdb[0x0][_0x1e9fe6(0xe6)]==_0x1e9fe6(0xfc))var _0x3153bb=users[_0x1e9fe6(0xfc)];else{if(_0x45afdb[0x0][_0x1e9fe6(0xe6)]==_0x1e9fe6(0xd4))var _0x3153bb=users['French'];else{if(_0x45afdb[0x0]['language']==_0x1e9fe6(0xf5))var _0x3153bb=users[_0x1e9fe6(0xcd)];else{if(_0x45afdb[0x0][_0x1e9fe6(0xe6)]==_0x1e9fe6(0x138))var _0x3153bb=users[_0x1e9fe6(0x138)];else{if(_0x45afdb[0x0][_0x1e9fe6(0xe6)]==_0x1e9fe6(0x139))var _0x3153bb=users[_0x1e9fe6(0x104)];}}}}}}}_0x50195f['render'](_0x1e9fe6(0xde),{'success':_0x1b07db[_0x1e9fe6(0xc4)](_0x1e9fe6(0x11a)),'errors':_0x1b07db[_0x1e9fe6(0xc4)](_0x1e9fe6(0xec)),'role':_0x380809,'profile':_0xe909ec,'master_shop':_0x45afdb,'transfer':_0x548727,'language':_0x3153bb});}catch(_0x2cf1cd){console[_0x1e9fe6(0xb9)](_0x2cf1cd);}});async function getRandom8DigitNumber(){var _0x597124=a0_0x228c30;const _0x40f341=0x989680,_0x353208=0x5f5e0ff,_0x2ee582=Math[_0x597124(0xc7)](Math['random']()*(_0x353208-_0x40f341+0x1))+_0x40f341;var _0x29e3d9;const _0x45a323=await transfers_finished[_0x597124(0x144)]({'invoice':'TRFF-'+_0x2ee582});return _0x45a323&&_0x45a323[_0x597124(0xc5)]>0x0?_0x29e3d9=_0x597124(0xfb)+_0x2ee582:_0x29e3d9=_0x597124(0xfb)+_0x2ee582,_0x29e3d9;}router[a0_0x228c30(0xe8)](a0_0x228c30(0x159),auth,async(_0x254451,_0x48cffd)=>{var _0x4a953a=a0_0x228c30;try{const {username:_0x10d38e,email:_0x279a99,role:_0x2fdbb8}=_0x254451['user'],_0x2ff8b4=_0x254451[_0x4a953a(0x100)],_0x3b8649=await profile[_0x4a953a(0x144)]({'email':_0x2ff8b4[_0x4a953a(0x140)]}),_0x412979=await master_shop[_0x4a953a(0xc2)]();let _0x3b6254;if(_0x2ff8b4['role']==_0x4a953a(0xfd)){const _0x3f10e2=await staff['findOne']({'email':_0x2ff8b4[_0x4a953a(0x140)]});_0x3b6254=await warehouse['aggregate']([{'$match':{'status':_0x4a953a(0xd7),'name':_0x3f10e2[_0x4a953a(0x15a)]}},{'$group':{'_id':'$name','name':{'$first':_0x4a953a(0xbb)}}}]);}else _0x3b6254=await warehouse[_0x4a953a(0x14b)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x4a953a(0xbb),'name':{'$first':_0x4a953a(0xbb)}}}]);const _0x3c1302=await transfers_finished[_0x4a953a(0xc2)]({}),_0x20700c=_0x3c1302['length']+0x1,_0x479458=_0x4a953a(0xfb)+_0x20700c[_0x4a953a(0x15f)]()[_0x4a953a(0xa8)](0x5,'0');if(_0x412979[0x0]['language']==_0x4a953a(0x132))var _0x5438eb=users[_0x4a953a(0xaf)];else{if(_0x412979[0x0]['language']==_0x4a953a(0xf1))var _0x5438eb=users[_0x4a953a(0xf1)];else{if(_0x412979[0x0]['language']=='German')var _0x5438eb=users[_0x4a953a(0x128)];else{if(_0x412979[0x0][_0x4a953a(0xe6)]==_0x4a953a(0xfc))var _0x5438eb=users[_0x4a953a(0xfc)];else{if(_0x412979[0x0][_0x4a953a(0xe6)]=='French')var _0x5438eb=users[_0x4a953a(0xd4)];else{if(_0x412979[0x0][_0x4a953a(0xe6)]==_0x4a953a(0xf5))var _0x5438eb=users[_0x4a953a(0xcd)];else{if(_0x412979[0x0][_0x4a953a(0xe6)]==_0x4a953a(0x138))var _0x5438eb=users[_0x4a953a(0x138)];else{if(_0x412979[0x0]['language']=='Arabic\x20(ae)')var _0x5438eb=users[_0x4a953a(0x104)];}}}}}}}const _0x494ae5=getRandom8DigitNumber();_0x494ae5[_0x4a953a(0xee)](_0x1d75f3=>{var _0x3a5301=_0x4a953a;_0x48cffd['render'](_0x3a5301(0xb3),{'success':_0x254451[_0x3a5301(0xc4)](_0x3a5301(0x11a)),'errors':_0x254451['flash']('errors'),'role':_0x2ff8b4,'profile':_0x3b8649,'master_shop':_0x412979,'warehouse':_0x3b6254,'language':_0x5438eb,'invoice':_0x1d75f3});})[_0x4a953a(0x11f)](_0xff0a45=>{var _0x5bc5cb=_0x4a953a;_0x254451['flash']('errors',_0x5bc5cb(0xdc)),_0x48cffd[_0x5bc5cb(0x164)]('/transfer/view');});}catch(_0x296170){console[_0x4a953a(0xb9)](_0x296170);}}),router['get'](a0_0x228c30(0xbf),auth,async(_0x1b11a6,_0x5c02df)=>{var _0x198c02=a0_0x228c30;try{const {username:_0x32642e,email:_0x43292c,role:_0x2c09fa}=_0x1b11a6[_0x198c02(0x100)],_0x54c092=_0x1b11a6['user'],_0x57a8ff=await profile['findOne']({'email':_0x54c092[_0x198c02(0x140)]}),_0x50dc31=await master_shop[_0x198c02(0xc2)]();let _0xc1a920;if(_0x54c092[_0x198c02(0xd5)]==_0x198c02(0xfd)){const _0x253749=await staff[_0x198c02(0x144)]({'email':_0x54c092[_0x198c02(0x140)]});_0xc1a920=await warehouse[_0x198c02(0x14b)]([{'$match':{'status':_0x198c02(0xd7),'name':_0x253749['warehouse']}},{'$group':{'_id':_0x198c02(0xbb),'name':{'$first':'$name'}}}]);}else _0xc1a920=await warehouse[_0x198c02(0x14b)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x198c02(0xbb),'name':{'$first':_0x198c02(0xbb)}}}]);const _0x2880e6=await transfers_finished[_0x198c02(0xc2)]({}),_0x3275bd=_0x2880e6[_0x198c02(0xc5)]+0x1,_0x4de370=_0x198c02(0xfb)+_0x3275bd[_0x198c02(0x15f)]()[_0x198c02(0xa8)](0x5,'0');if(_0x50dc31[0x0][_0x198c02(0xe6)]==_0x198c02(0x132))var _0x3044e0=users[_0x198c02(0xaf)];else{if(_0x50dc31[0x0]['language']==_0x198c02(0xf1))var _0x3044e0=users[_0x198c02(0xf1)];else{if(_0x50dc31[0x0][_0x198c02(0xe6)]==_0x198c02(0x128))var _0x3044e0=users['German'];else{if(_0x50dc31[0x0][_0x198c02(0xe6)]==_0x198c02(0xfc))var _0x3044e0=users['Spanish'];else{if(_0x50dc31[0x0][_0x198c02(0xe6)]=='French')var _0x3044e0=users[_0x198c02(0xd4)];else{if(_0x50dc31[0x0][_0x198c02(0xe6)]==_0x198c02(0xf5))var _0x3044e0=users[_0x198c02(0xcd)];else{if(_0x50dc31[0x0][_0x198c02(0xe6)]=='Chinese')var _0x3044e0=users[_0x198c02(0x138)];else{if(_0x50dc31[0x0][_0x198c02(0xe6)]==_0x198c02(0x139))var _0x3044e0=users['Arabic'];}}}}}}}const _0x26551c=getRandom8DigitNumber();_0x26551c[_0x198c02(0xee)](_0x137e60=>{var _0x1a2f7c=_0x198c02;_0x5c02df[_0x1a2f7c(0x157)](_0x1a2f7c(0x15e),{'success':_0x1b11a6[_0x1a2f7c(0xc4)](_0x1a2f7c(0x11a)),'errors':_0x1b11a6[_0x1a2f7c(0xc4)](_0x1a2f7c(0xec)),'role':_0x54c092,'profile':_0x57a8ff,'master_shop':_0x50dc31,'warehouse':_0xc1a920,'language':_0x3044e0,'invoice':_0x137e60});})[_0x198c02(0x11f)](_0x467b5f=>{var _0x116fa8=_0x198c02;_0x1b11a6[_0x116fa8(0xc4)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x5c02df['redirect']('/transfer/view');});}catch(_0x3aee58){console['log'](_0x3aee58);}}),router[a0_0x228c30(0xe8)]('/view/choose_logs',auth,async(_0x29e7c8,_0x406e27)=>{var _0x21f6a1=a0_0x228c30;try{const {username:_0x510715,email:_0x5af477,role:_0x5f5509}=_0x29e7c8[_0x21f6a1(0x100)],_0x39350b=_0x29e7c8[_0x21f6a1(0x100)],_0x58d5a7=await profile[_0x21f6a1(0x144)]({'email':_0x39350b[_0x21f6a1(0x140)]}),_0x8ef9ae=await master_shop[_0x21f6a1(0xc2)]();let _0x4657c1;if(_0x39350b[_0x21f6a1(0xd5)]=='staff'){const _0x290ccd=await staff[_0x21f6a1(0x144)]({'email':_0x39350b[_0x21f6a1(0x140)]});_0x4657c1=await warehouse['aggregate']([{'$match':{'status':_0x21f6a1(0xd7),'name':_0x290ccd[_0x21f6a1(0x15a)]}},{'$group':{'_id':_0x21f6a1(0xbb),'name':{'$first':_0x21f6a1(0xbb)}}}]);}else _0x4657c1=await warehouse[_0x21f6a1(0x14b)]([{'$match':{'status':_0x21f6a1(0xd7)}},{'$group':{'_id':_0x21f6a1(0xbb),'name':{'$first':_0x21f6a1(0xbb)}}}]);const _0x36211c=await transfers_finished['find']({}),_0x29ec5b=_0x36211c[_0x21f6a1(0xc5)]+0x1,_0x2fd3d8=_0x21f6a1(0xfb)+_0x29ec5b[_0x21f6a1(0x15f)]()['padStart'](0x5,'0');if(_0x8ef9ae[0x0]['language']==_0x21f6a1(0x132))var _0x2dfe6f=users['English'];else{if(_0x8ef9ae[0x0][_0x21f6a1(0xe6)]==_0x21f6a1(0xf1))var _0x2dfe6f=users['Hindi'];else{if(_0x8ef9ae[0x0][_0x21f6a1(0xe6)]==_0x21f6a1(0x128))var _0x2dfe6f=users[_0x21f6a1(0x128)];else{if(_0x8ef9ae[0x0][_0x21f6a1(0xe6)]==_0x21f6a1(0xfc))var _0x2dfe6f=users[_0x21f6a1(0xfc)];else{if(_0x8ef9ae[0x0]['language']==_0x21f6a1(0xd4))var _0x2dfe6f=users[_0x21f6a1(0xd4)];else{if(_0x8ef9ae[0x0]['language']==_0x21f6a1(0xf5))var _0x2dfe6f=users['Portuguese'];else{if(_0x8ef9ae[0x0][_0x21f6a1(0xe6)]==_0x21f6a1(0x138))var _0x2dfe6f=users[_0x21f6a1(0x138)];else{if(_0x8ef9ae[0x0][_0x21f6a1(0xe6)]=='Arabic\x20(ae)')var _0x2dfe6f=users[_0x21f6a1(0x104)];}}}}}}}const _0x4a045a=getRandom8DigitNumber();_0x4a045a[_0x21f6a1(0xee)](_0x39ce79=>{var _0x4ab9b0=_0x21f6a1;_0x406e27[_0x4ab9b0(0x157)]('choos_transfer_logs',{'success':_0x29e7c8['flash'](_0x4ab9b0(0x11a)),'errors':_0x29e7c8[_0x4ab9b0(0xc4)](_0x4ab9b0(0xec)),'role':_0x39350b,'profile':_0x58d5a7,'master_shop':_0x8ef9ae,'warehouse':_0x4657c1,'language':_0x2dfe6f,'invoice':_0x39ce79});})['catch'](_0x5f05d0=>{var _0x4172d7=_0x21f6a1;_0x29e7c8[_0x4172d7(0xc4)](_0x4172d7(0xec),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x406e27[_0x4172d7(0x164)](_0x4172d7(0x131));});}catch(_0x457197){console[_0x21f6a1(0xb9)](_0x457197);}}),router[a0_0x228c30(0xa1)]('/view/add_transfer_logs',auth,async(_0x517877,_0x2b06c4)=>{var _0x59a283=a0_0x228c30;try{const {date:_0x279995,from_warehouse:_0x2bf5e1,FromRoom_name:_0xb6c326,to_warehouse:_0x30680d,ToRoom_name:_0x253d02,prod_name:_0x2c7395,from_prod_qty:_0x23dc89,from_prod_level:_0x4e698,from_prod_isle:_0x19294f,from_prod_pallet:_0x428dd3,to_prod_qty:_0x1c4212,to_prod_level:_0x529020,to_prod_isle:_0xfe790d,to_prod_pallet:_0x1fe90e,primary_code:_0x1bd32f,secondary_code:_0x132f1b,product_code3:_0x5900f3,note:_0x4f1ecb,MaxStocks_data2:_0x1bec0f,invoice:_0x220f1e,expiry_date:_0x7333d4,PO_number:_0x413187,ReqBy:_0x51e676,dateofreq:_0x1b3fec,typeservicesData:_0x4821f0,destination:_0x10cf50,deliverydate:_0x27b1f2,driver:_0x171aec,plate:_0x18a8fa,van:_0x5e42a9,DRSI:_0x1c1ccc,typevehicle:_0x536b7c,TSU:_0xf3f5ee,TFU:_0x34ac7}=_0x517877['body'];if(typeof _0x2c7395=='string')var _0x35547f=[_0x517877['body'][_0x59a283(0x13d)]],_0x51b400=[_0x517877[_0x59a283(0xed)][_0x59a283(0x102)]],_0x59b974=[_0x517877[_0x59a283(0xed)][_0x59a283(0xac)]],_0x473200=[_0x517877['body']['New_Qty_Converted']],_0x12473f=[_0x517877[_0x59a283(0xed)][_0x59a283(0x120)]],_0x5b6863=[_0x517877['body'][_0x59a283(0xda)]],_0x44f9e5=[_0x517877['body'][_0x59a283(0x110)]],_0x315ab5=[_0x517877[_0x59a283(0xed)]['product_code3']],_0x17cdda=[_0x517877[_0x59a283(0xed)][_0x59a283(0xb2)]],_0x3debac=[_0x517877[_0x59a283(0xed)]['primary_unit']],_0x11c8b5=[_0x517877[_0x59a283(0xed)]['secondary_unit']],_0x2ff3a6=[_0x517877[_0x59a283(0xed)][_0x59a283(0x160)]],_0x1cda95=[_0x517877[_0x59a283(0xed)][_0x59a283(0x124)]],_0x44d780=[_0x517877['body'][_0x59a283(0xe0)]],_0x4a941b=[_0x517877[_0x59a283(0xed)][_0x59a283(0x114)]],_0x185122=[_0x517877[_0x59a283(0xed)][_0x59a283(0x10b)]],_0x45ff6d=[_0x517877[_0x59a283(0xed)][_0x59a283(0x13c)]],_0x34f28a=[_0x517877[_0x59a283(0xed)][_0x59a283(0x109)]],_0x5e140=[_0x517877['body'][_0x59a283(0x130)]],_0x1f5f5c=[_0x517877[_0x59a283(0xed)]['from_invoice']],_0x58eff6=[_0x517877['body'][_0x59a283(0x127)]];else var _0x35547f=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x13d)]],_0x51b400=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x102)]],_0x59b974=[..._0x517877['body'][_0x59a283(0xac)]],_0x473200=[..._0x517877[_0x59a283(0xed)]['New_Qty_Converted']],_0x12473f=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x120)]],_0x5b6863=[..._0x517877[_0x59a283(0xed)]['primary_code']],_0x44f9e5=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x110)]],_0x315ab5=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x15b)]],_0x17cdda=[..._0x517877[_0x59a283(0xed)]['MaxStocks_data2']],_0x3debac=[..._0x517877[_0x59a283(0xed)][_0x59a283(0xc3)]],_0x11c8b5=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x105)]],_0x2ff3a6=[..._0x517877[_0x59a283(0xed)]['batch_code']],_0x1cda95=[..._0x517877[_0x59a283(0xed)]['expiry_date']],_0x44d780=[..._0x517877[_0x59a283(0xed)]['product_date']],_0x4a941b=[..._0x517877[_0x59a283(0xed)]['MaxStocks_data']],_0x185122=[..._0x517877['body'][_0x59a283(0x10b)]],_0x45ff6d=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x13c)]],_0x34f28a=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x109)]],_0x5e140=[..._0x517877[_0x59a283(0xed)]['ToRoomAssigned']],_0x1f5f5c=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x119)]],_0x58eff6=[..._0x517877[_0x59a283(0xed)][_0x59a283(0x127)]];const _0x53c8d6=_0x35547f['map'](_0x5c415f=>{return _0x5c415f={'product_name':_0x5c415f};});_0x51b400['forEach']((_0x44baa7,_0x1f7266)=>{_0x53c8d6[_0x1f7266]['from_quantity']=_0x44baa7;}),_0x59b974[_0x59a283(0x151)]((_0x465b2a,_0xc06c15)=>{var _0x16a65c=_0x59a283,_0x1cefe6=_0x465b2a[_0x16a65c(0x15d)](/[A-Za-z]+/)[0x0],_0x112d91=parseInt(_0x465b2a[_0x16a65c(0x15d)](/\d+/)[0x0]);_0x53c8d6[_0xc06c15][_0x16a65c(0x163)]=_0x112d91,_0x53c8d6[_0xc06c15][_0x16a65c(0xba)]=_0x1cefe6;}),_0x58eff6[_0x59a283(0x151)]((_0x57eb80,_0x2ff2f4)=>{var _0x32fa73=_0x59a283;_0x53c8d6[_0x2ff2f4][_0x32fa73(0x127)]=_0x57eb80;}),_0x1f5f5c[_0x59a283(0x151)]((_0x38460c,_0x1c3454)=>{var _0x3d4d86=_0x59a283;_0x53c8d6[_0x1c3454][_0x3d4d86(0x119)]=_0x38460c;}),_0x473200[_0x59a283(0x151)]((_0x49e3b8,_0x311e0d)=>{var _0x5cf484=_0x59a283;_0x53c8d6[_0x311e0d][_0x5cf484(0xca)]=_0x49e3b8;}),_0x12473f[_0x59a283(0x151)]((_0x387bfd,_0x1847d1)=>{var _0x2f0828=_0x59a283,_0x50bc74=_0x387bfd[_0x2f0828(0x15d)](/[A-Za-z]+/)[0x0],_0x54bd75=parseInt(_0x387bfd[_0x2f0828(0x15d)](/\d+/)[0x0]);_0x53c8d6[_0x1847d1][_0x2f0828(0xbd)]=_0x50bc74,_0x53c8d6[_0x1847d1][_0x2f0828(0x121)]=_0x54bd75;}),_0x5b6863[_0x59a283(0x151)]((_0x3a5092,_0x9343aa)=>{var _0x145643=_0x59a283;_0x53c8d6[_0x9343aa][_0x145643(0xda)]=_0x3a5092;}),_0x44f9e5[_0x59a283(0x151)]((_0x16ae39,_0x540208)=>{var _0x557811=_0x59a283;_0x53c8d6[_0x540208][_0x557811(0x110)]=_0x16ae39;}),_0x315ab5[_0x59a283(0x151)]((_0x1e8979,_0x49f85c)=>{var _0x4fffbb=_0x59a283;_0x53c8d6[_0x49f85c][_0x4fffbb(0x146)]=_0x1e8979;}),_0x17cdda[_0x59a283(0x151)]((_0x3a9211,_0x3df145)=>{_0x53c8d6[_0x3df145]['maxProducts']=_0x3a9211;}),_0x3debac['forEach']((_0x17a28e,_0xeefc4b)=>{_0x53c8d6[_0xeefc4b]['unit']=_0x17a28e;}),_0x11c8b5['forEach']((_0x2b5fde,_0x2eb7d6)=>{_0x53c8d6[_0x2eb7d6]['secondary_unit']=_0x2b5fde;}),_0x2ff3a6[_0x59a283(0x151)]((_0x138fc1,_0x52ff26)=>{_0x53c8d6[_0x52ff26]['batch_code']=_0x138fc1;}),_0x1cda95['forEach']((_0x2bf410,_0x48ad87)=>{var _0x47db0a=_0x59a283;_0x53c8d6[_0x48ad87][_0x47db0a(0x124)]=_0x2bf410;}),_0x44d780[_0x59a283(0x151)]((_0x64bfa9,_0x581cfc)=>{var _0x998de9=_0x59a283;_0x53c8d6[_0x581cfc][_0x998de9(0x14f)]=_0x64bfa9;}),_0x4a941b['forEach']((_0xefcfab,_0x11ba53)=>{_0x53c8d6[_0x11ba53]['maxProducts']=_0xefcfab;}),_0x185122['forEach']((_0xc673bb,_0x219397)=>{var _0x2de213=_0x59a283;_0x53c8d6[_0x219397][_0x2de213(0x10b)]=_0xc673bb;}),_0x45ff6d[_0x59a283(0x151)]((_0x23275c,_0x570e5c)=>{_0x53c8d6[_0x570e5c]['prod_cat']=_0x23275c;}),_0x34f28a[_0x59a283(0x151)]((_0x45158f,_0x3021e8)=>{var _0x2f44f8=_0x59a283;_0x53c8d6[_0x3021e8][_0x2f44f8(0x126)]=_0x45158f;}),_0x5e140[_0x59a283(0x151)]((_0x13bd68,_0x1db074)=>{var _0x4dffca=_0x59a283;_0x53c8d6[_0x1db074][_0x4dffca(0xe1)]=_0x13bd68;});const _0x4b9cb9=_0x53c8d6[_0x59a283(0xb8)](_0xfb57eb=>_0xfb57eb[_0x59a283(0xca)]!=='0'&&_0xfb57eb[_0x59a283(0xca)]!==''||_0xfb57eb[_0x59a283(0xab)]!=='0'&&_0xfb57eb[_0x59a283(0xab)]!=='');var _0x2c5f4a=0x0;_0x4b9cb9[_0x59a283(0x151)](_0x57749c=>{var _0x595a45=_0x59a283;parseInt(_0x57749c[_0x595a45(0xf0)])<parseInt(_0x57749c[_0x595a45(0xca)])&&_0x2c5f4a++;});if(_0x2c5f4a!=0x0)return _0x517877[_0x59a283(0xc4)](_0x59a283(0xec),_0x59a283(0xe5)),_0x2b06c4[_0x59a283(0x164)](_0x59a283(0xa0));const _0x429bf2=new transfers_logs();await _0x429bf2[_0x59a283(0x162)]();for(let _0x19e4b9=0x0;_0x19e4b9<=_0x5e140[_0x59a283(0xc5)]-0x1;_0x19e4b9++){_0x53c8d6[_0x19e4b9]['To_invoice']=_0x59a283(0x103)+_0x429bf2['invoice_init'][_0x59a283(0x15f)]()[_0x59a283(0xa8)](0x8,'0');}const _0x235f66=new transfers_finished({'date':_0x279995,'from_warehouse':_0x2bf5e1,'to_warehouse':_0x2bf5e1,'product':_0x4b9cb9,'note':_0x4f1ecb,'invoice':'LOG-TRF-'+_0x429bf2[_0x59a283(0xcc)]['toString']()[_0x59a283(0xa8)](0x8,'0'),'type_of_process':_0x59a283(0x10f),'type_of_transaction':_0x59a283(0x11c),'PO_number':_0x413187,'RequestedBy':_0x51e676,'DateofRequest':_0x1b3fec,'typeservices':_0x4821f0,'destination':_0x10cf50,'deliverydate':_0x27b1f2,'driver':_0x171aec,'plate':_0x18a8fa,'van':_0x5e42a9,'DRSI':_0x1c1ccc,'typevehicle':_0x536b7c,'TSU':_0xf3f5ee,'TFU':_0x34ac7}),_0x1b81dc=await _0x235f66[_0x59a283(0x162)]();_0x517877['flash']('success',_0x59a283(0xdd)),_0x2b06c4[_0x59a283(0x164)](_0x59a283(0x12d)+_0x1b81dc[_0x59a283(0xf2)]);}catch(_0x514137){console[_0x59a283(0xb9)](_0x514137),_0x2b06c4[_0x59a283(0xea)](0xc8)[_0x59a283(0x13b)]({'errorMessage':_0x514137[_0x59a283(0xc9)]});}}),router[a0_0x228c30(0xa1)](a0_0x228c30(0x125),auth,async(_0x4c02e5,_0x420e66)=>{var _0x24dbef=a0_0x228c30;try{const {date:_0x1c7cea,from_warehouse:_0x2c2a12,FromRoom_name:_0x5b3944,to_warehouse:_0x37020a,ToRoom_name:_0x4e2eb4,prod_name:_0x378a26,from_prod_qty:_0x118eb3,from_prod_level:_0x4687b3,from_prod_isle:_0x3f6d62,from_prod_pallet:_0x40d490,to_prod_qty:_0x475b8d,to_prod_level:_0x32abbb,to_prod_isle:_0x1b869b,to_prod_pallet:_0x5aa8e0,primary_code:_0x51aeed,secondary_code:_0x5a74a3,product_code3:_0x5a6963,note:_0x14ebe6,MaxStocks_data2:_0x50dd0d,invoice:_0xe3455a,expiry_date:_0x536ebf,PO_number_loc:_0x79f41,ReqBy_loc:_0x20f4f9,dateofreq_loc:_0x2d5ae1,typeservices_loc_Data:_0xf7e3ea,destination_loc:_0x4226d1,deliverydate_loc:_0x36a9c1,driver_loc:_0x1160ab,plate_loc:_0x464f69,van_loc:_0x19f3ef,DRSI_loc:_0xff2479,typevehicle_loc:_0xb8a355,TSU_loc:_0x2fc6ba,TFU_loc:_0x1d1c5a}=_0x4c02e5[_0x24dbef(0xed)];if(typeof _0x378a26==_0x24dbef(0xad))var _0x5e286c=[_0x4c02e5[_0x24dbef(0xed)]['prod_name']],_0x1c07c7=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x102)]],_0x4885a1=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0xac)]],_0x52285b=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0xe3)]],_0x67c936=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x120)]],_0x450d8e=[_0x4c02e5['body']['primary_code']],_0x57453b=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x110)]],_0x4d3782=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x15b)]],_0x393f87=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0xb2)]],_0x4d491d=[_0x4c02e5['body']['primary_unit']],_0x513d9b=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x105)]],_0xfeaad4=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x160)]],_0x37be06=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x124)]],_0x4d1f32=[_0x4c02e5['body'][_0x24dbef(0xe0)]],_0xfa2bfd=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x114)]],_0x2c477f=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x10b)]],_0x304d72=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x13c)]],_0x3be459=[_0x4c02e5['body'][_0x24dbef(0x109)]],_0x476569=[_0x4c02e5['body'][_0x24dbef(0x130)]],_0x5e8060=[_0x4c02e5['body']['from_invoice']],_0x29ac09=[_0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x127)]];else var _0x5e286c=[..._0x4c02e5[_0x24dbef(0xed)]['prod_name']],_0x1c07c7=[..._0x4c02e5['body']['from_prod_qty']],_0x4885a1=[..._0x4c02e5['body'][_0x24dbef(0xac)]],_0x52285b=[..._0x4c02e5['body'][_0x24dbef(0xe3)]],_0x67c936=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x120)]],_0x450d8e=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0xda)]],_0x57453b=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x110)]],_0x4d3782=[..._0x4c02e5['body'][_0x24dbef(0x15b)]],_0x393f87=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0xb2)]],_0x4d491d=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0xc3)]],_0x513d9b=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x105)]],_0xfeaad4=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x160)]],_0x37be06=[..._0x4c02e5['body'][_0x24dbef(0x124)]],_0x4d1f32=[..._0x4c02e5[_0x24dbef(0xed)]['product_date']],_0xfa2bfd=[..._0x4c02e5['body'][_0x24dbef(0x114)]],_0x2c477f=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x10b)]],_0x304d72=[..._0x4c02e5['body'][_0x24dbef(0x13c)]],_0x3be459=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x109)]],_0x476569=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x130)]],_0x5e8060=[..._0x4c02e5[_0x24dbef(0xed)]['from_invoice']],_0x29ac09=[..._0x4c02e5[_0x24dbef(0xed)][_0x24dbef(0x127)]];const _0x42c0cc=_0x5e286c[_0x24dbef(0x11d)](_0x4bb31d=>{return _0x4bb31d={'product_name':_0x4bb31d};});_0x1c07c7['forEach']((_0x67c590,_0x5ca342)=>{var _0x5dd7fb=_0x24dbef;_0x42c0cc[_0x5ca342][_0x5dd7fb(0xf0)]=_0x67c590;}),_0x4885a1[_0x24dbef(0x151)]((_0x4d0374,_0x20e9f7)=>{var _0x35235b=_0x24dbef,_0x369945=_0x4d0374[_0x35235b(0x15d)](/[A-Za-z]+/)[0x0],_0x36aafd=parseInt(_0x4d0374[_0x35235b(0x15d)](/\d+/)[0x0]);_0x42c0cc[_0x20e9f7][_0x35235b(0x163)]=_0x36aafd,_0x42c0cc[_0x20e9f7][_0x35235b(0xba)]=_0x369945;}),_0x29ac09[_0x24dbef(0x151)]((_0x59a704,_0x494111)=>{var _0x3030ee=_0x24dbef;_0x42c0cc[_0x494111][_0x3030ee(0x127)]=_0x59a704;}),_0x5e8060['forEach']((_0x48ca4b,_0x2b21d2)=>{_0x42c0cc[_0x2b21d2]['from_invoice']=_0x48ca4b;}),_0x52285b[_0x24dbef(0x151)]((_0x36f6b7,_0x253173)=>{_0x42c0cc[_0x253173]['to_quantity']=_0x36f6b7;}),_0x67c936[_0x24dbef(0x151)]((_0x539063,_0x127c0d)=>{var _0x35ca0b=_0x24dbef,_0x2192d3=_0x539063[_0x35ca0b(0x15d)](/[A-Za-z]+/)[0x0],_0x23a5fe=parseInt(_0x539063[_0x35ca0b(0x15d)](/\d+/)[0x0]);_0x42c0cc[_0x127c0d][_0x35ca0b(0xbd)]=_0x2192d3,_0x42c0cc[_0x127c0d][_0x35ca0b(0x121)]=_0x23a5fe;}),_0x450d8e['forEach']((_0x44ce3a,_0x182637)=>{var _0x3221b4=_0x24dbef;_0x42c0cc[_0x182637][_0x3221b4(0xda)]=_0x44ce3a;}),_0x57453b[_0x24dbef(0x151)]((_0x52dfc0,_0x49f3e2)=>{var _0x275ba1=_0x24dbef;_0x42c0cc[_0x49f3e2][_0x275ba1(0x110)]=_0x52dfc0;}),_0x4d3782[_0x24dbef(0x151)]((_0x346eb0,_0x460bd5)=>{var _0x13d3fe=_0x24dbef;_0x42c0cc[_0x460bd5][_0x13d3fe(0x146)]=_0x346eb0;}),_0x393f87[_0x24dbef(0x151)]((_0x5296b8,_0x51e403)=>{var _0x26a780=_0x24dbef;_0x42c0cc[_0x51e403][_0x26a780(0xdb)]=_0x5296b8;}),_0x4d491d[_0x24dbef(0x151)]((_0x1f2050,_0x196de9)=>{var _0x31b64d=_0x24dbef;_0x42c0cc[_0x196de9][_0x31b64d(0x12e)]=_0x1f2050;}),_0x513d9b['forEach']((_0x5ab4e2,_0xe12a3f)=>{var _0x2cb17d=_0x24dbef;_0x42c0cc[_0xe12a3f][_0x2cb17d(0x105)]=_0x5ab4e2;}),_0xfeaad4[_0x24dbef(0x151)]((_0x3fc36d,_0x214d65)=>{var _0x11061d=_0x24dbef;_0x42c0cc[_0x214d65][_0x11061d(0x160)]=_0x3fc36d;}),_0x37be06['forEach']((_0x5dcc4f,_0xebefa8)=>{var _0x4136f9=_0x24dbef;_0x42c0cc[_0xebefa8][_0x4136f9(0x124)]=_0x5dcc4f;}),_0x4d1f32[_0x24dbef(0x151)]((_0x379dd8,_0x1c6eb5)=>{var _0x439b0e=_0x24dbef;_0x42c0cc[_0x1c6eb5][_0x439b0e(0x14f)]=_0x379dd8;}),_0xfa2bfd['forEach']((_0x52d479,_0x817d01)=>{var _0xb94686=_0x24dbef;_0x42c0cc[_0x817d01][_0xb94686(0xdb)]=_0x52d479;}),_0x2c477f[_0x24dbef(0x151)]((_0x29c4f1,_0x12eeca)=>{_0x42c0cc[_0x12eeca]['maxPerUnit']=_0x29c4f1;}),_0x304d72[_0x24dbef(0x151)]((_0x5ef501,_0x4f75ca)=>{_0x42c0cc[_0x4f75ca]['prod_cat']=_0x5ef501;}),_0x3be459[_0x24dbef(0x151)]((_0x35a356,_0x4fcdb7)=>{var _0x5683b7=_0x24dbef;_0x42c0cc[_0x4fcdb7][_0x5683b7(0x126)]=_0x35a356;}),_0x476569[_0x24dbef(0x151)]((_0xf94488,_0x57478d)=>{var _0x4ca7cd=_0x24dbef;_0x42c0cc[_0x57478d][_0x4ca7cd(0xe1)]=_0xf94488;});const _0x5de828=_0x42c0cc[_0x24dbef(0xb8)](_0x395b22=>_0x395b22[_0x24dbef(0xca)]!=='0'&&_0x395b22[_0x24dbef(0xca)]!==''||_0x395b22['to_floorlevel']!=='0'&&_0x395b22['to_floorlevel']!=='');var _0x57b10d=0x0;_0x5de828[_0x24dbef(0x151)](_0x4d3cab=>{var _0x425bc8=_0x24dbef;parseInt(_0x4d3cab[_0x425bc8(0xf0)])<parseInt(_0x4d3cab[_0x425bc8(0xca)])&&_0x57b10d++;});if(_0x57b10d!=0x0)return _0x4c02e5[_0x24dbef(0xc4)](_0x24dbef(0xec),_0x24dbef(0xe5)),_0x420e66[_0x24dbef(0x164)]('back');const _0xf670ae=new transfers_logs();await _0xf670ae[_0x24dbef(0x162)]();for(let _0x23117b=0x0;_0x23117b<=_0x476569['length']-0x1;_0x23117b++){_0x42c0cc[_0x23117b][_0x24dbef(0x145)]=_0x24dbef(0x103)+_0xf670ae[_0x24dbef(0xcc)]['toString']()[_0x24dbef(0xa8)](0x8,'0');}const _0x589a6c=new transfers_finished({'date':_0x1c7cea,'from_warehouse':_0x2c2a12,'to_warehouse':_0x37020a,'product':_0x5de828,'note':_0x14ebe6,'invoice':_0x24dbef(0x103)+_0xf670ae[_0x24dbef(0xcc)][_0x24dbef(0x15f)]()[_0x24dbef(0xa8)](0x8,'0'),'type_of_transaction':_0x24dbef(0x11c),'type_of_process':_0x24dbef(0x12a),'PO_number':_0x79f41,'RequestedBy':_0x20f4f9,'DateofRequest':_0x2d5ae1,'typeservices':_0xf7e3ea,'destination':_0x4226d1,'deliverydate':_0x36a9c1,'driver':_0x1160ab,'plate':_0x464f69,'van':_0x19f3ef,'DRSI':_0xff2479,'typevehicle':_0xb8a355,'TSU':_0x2fc6ba,'TFU':_0x1d1c5a}),_0x3ea410=await _0x589a6c['save']();_0x4c02e5['flash'](_0x24dbef(0x11a),_0x24dbef(0xdd)),_0x420e66[_0x24dbef(0x164)](_0x24dbef(0x12d)+_0x3ea410[_0x24dbef(0xf2)]);}catch(_0x5f3cd2){console[_0x24dbef(0xb9)](_0x5f3cd2),_0x420e66[_0x24dbef(0xea)](0xc8)[_0x24dbef(0x13b)]({'errorMessage':_0x5f3cd2[_0x24dbef(0xc9)]});}}),router[a0_0x228c30(0xa1)](a0_0x228c30(0x159),auth,async(_0x24fcd3,_0x2afc0c)=>{var _0xc306fd=a0_0x228c30;try{const {date:_0x4ea217,from_warehouse:_0x20b2c8,FromRoom_name:_0x5efea3,to_warehouse:_0x17fa26,ToRoom_name:_0x583ad5,prod_name:_0x2bb1a0,from_prod_qty:_0x454208,from_prod_level:_0x5639cb,from_prod_isle:_0x119cd6,from_prod_pallet:_0xa5808,to_prod_qty:_0x4e75ea,to_prod_level:_0x29d9b3,to_prod_isle:_0x44a22c,to_prod_pallet:_0x14b52e,primary_code:_0x9c73e0,secondary_code:_0x483e29,product_code3:_0x2cc58d,note:_0xb742b8,MaxStocks_data2:_0x26af28,invoice:_0x14a29e,expiry_date:_0x5dab04,PO_number:_0x369fcd,ReqBy:_0x571694,dateofreq:_0x4b8fdd,typeservicesData:_0x9093e9,destination:_0x5d9733,deliverydate:_0x219c9e,driver:_0x592722,plate:_0x4aa112,van:_0x30c401,DRSI:_0x1ff89b,typevehicle:_0x57e3e1,TSU:_0x563e31,TFU:_0x389d56}=_0x24fcd3[_0xc306fd(0xed)];if(typeof _0x2bb1a0=='string')var _0x50c67f=[_0x24fcd3['body'][_0xc306fd(0x13d)]],_0x332f96=[_0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x102)]],_0xdaa73b=[_0x24fcd3['body'][_0xc306fd(0xac)]],_0x346d93=[_0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0xe3)]],_0x2d99e6=[_0x24fcd3['body'][_0xc306fd(0x120)]],_0x3f42dd=[_0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0xda)]],_0x22c2de=[_0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x110)]],_0x45d709=[_0x24fcd3[_0xc306fd(0xed)]['product_code3']],_0x11885b=[_0x24fcd3[_0xc306fd(0xed)]['MaxStocks_data2']],_0x496793=[_0x24fcd3[_0xc306fd(0xed)]['primary_unit']],_0x20fcd0=[_0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x105)]],_0x232018=[_0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x160)]],_0x37e62a=[_0x24fcd3[_0xc306fd(0xed)]['expiry_date']],_0x458fa5=[_0x24fcd3['body']['product_date']],_0x8c511b=[_0x24fcd3['body'][_0xc306fd(0x114)]],_0x4ddcca=[_0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x10b)]],_0x3c3a72=[_0x24fcd3['body']['prod_cat']],_0x1fec29=[_0x24fcd3[_0xc306fd(0xed)]['RoomAssigned']],_0x4181bf=[_0x24fcd3['body'][_0xc306fd(0x130)]],_0x278f52=[_0x24fcd3['body'][_0xc306fd(0x119)]],_0xff5810=[_0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x127)]];else var _0x50c67f=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x13d)]],_0x332f96=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x102)]],_0xdaa73b=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0xac)]],_0x346d93=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0xe3)]],_0x2d99e6=[..._0x24fcd3[_0xc306fd(0xed)]['to_prod_level']],_0x3f42dd=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0xda)]],_0x22c2de=[..._0x24fcd3[_0xc306fd(0xed)]['secondary_code']],_0x45d709=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x15b)]],_0x11885b=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0xb2)]],_0x496793=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0xc3)]],_0x20fcd0=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x105)]],_0x232018=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x160)]],_0x37e62a=[..._0x24fcd3['body'][_0xc306fd(0x124)]],_0x458fa5=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0xe0)]],_0x8c511b=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x114)]],_0x4ddcca=[..._0x24fcd3['body'][_0xc306fd(0x10b)]],_0x3c3a72=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x13c)]],_0x1fec29=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x109)]],_0x4181bf=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x130)]],_0x278f52=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x119)]],_0xff5810=[..._0x24fcd3[_0xc306fd(0xed)][_0xc306fd(0x127)]];const _0xb3a361=_0x50c67f[_0xc306fd(0x11d)](_0x31137f=>{return _0x31137f={'product_name':_0x31137f};});_0x332f96[_0xc306fd(0x151)]((_0x49b5c5,_0x23451c)=>{_0xb3a361[_0x23451c]['from_quantity']=_0x49b5c5;}),_0xdaa73b[_0xc306fd(0x151)]((_0x3309d9,_0x1a2c4d)=>{var _0x23b363=_0xc306fd,_0x1c24ea=_0x3309d9[_0x23b363(0x15d)](/[A-Za-z]+/)[0x0],_0x54defd=parseInt(_0x3309d9[_0x23b363(0x15d)](/\d+/)[0x0]);_0xb3a361[_0x1a2c4d][_0x23b363(0x163)]=_0x54defd,_0xb3a361[_0x1a2c4d][_0x23b363(0xba)]=_0x1c24ea;}),_0xff5810[_0xc306fd(0x151)]((_0x2972f6,_0x154c2d)=>{var _0x2ceb4b=_0xc306fd;_0xb3a361[_0x154c2d][_0x2ceb4b(0x127)]=_0x2972f6;}),_0x278f52[_0xc306fd(0x151)]((_0xb0ba7d,_0x4784fa)=>{var _0x54678f=_0xc306fd;_0xb3a361[_0x4784fa][_0x54678f(0x119)]=_0xb0ba7d;}),_0x346d93['forEach']((_0x302b9f,_0x2e5d14)=>{var _0x41a587=_0xc306fd;_0xb3a361[_0x2e5d14][_0x41a587(0xca)]=_0x302b9f;}),_0x2d99e6['forEach']((_0x21b0b1,_0x2fed63)=>{var _0xba59ae=_0xc306fd,_0x1b8df8=_0x21b0b1['match'](/[A-Za-z]+/)[0x0],_0x25bb40=parseInt(_0x21b0b1[_0xba59ae(0x15d)](/\d+/)[0x0]);_0xb3a361[_0x2fed63][_0xba59ae(0xbd)]=_0x1b8df8,_0xb3a361[_0x2fed63][_0xba59ae(0x121)]=_0x25bb40;}),_0x3f42dd[_0xc306fd(0x151)]((_0x5d1803,_0x7e308)=>{var _0x203360=_0xc306fd;_0xb3a361[_0x7e308][_0x203360(0xda)]=_0x5d1803;}),_0x22c2de[_0xc306fd(0x151)]((_0x2a3d52,_0x19122e)=>{var _0x4bc304=_0xc306fd;_0xb3a361[_0x19122e][_0x4bc304(0x110)]=_0x2a3d52;}),_0x45d709['forEach']((_0x257025,_0x32119c)=>{_0xb3a361[_0x32119c]['product_code']=_0x257025;}),_0x11885b[_0xc306fd(0x151)]((_0x720605,_0xc4287d)=>{_0xb3a361[_0xc4287d]['maxProducts']=_0x720605;}),_0x496793[_0xc306fd(0x151)]((_0x738485,_0x400916)=>{var _0x264797=_0xc306fd;_0xb3a361[_0x400916][_0x264797(0x12e)]=_0x738485;}),_0x20fcd0[_0xc306fd(0x151)]((_0x4a919a,_0x1f5ca7)=>{var _0x22f031=_0xc306fd;_0xb3a361[_0x1f5ca7][_0x22f031(0x105)]=_0x4a919a;}),_0x232018['forEach']((_0x43915d,_0x3edd97)=>{var _0x501af1=_0xc306fd;_0xb3a361[_0x3edd97][_0x501af1(0x160)]=_0x43915d;}),_0x37e62a[_0xc306fd(0x151)]((_0x28a754,_0x38f277)=>{_0xb3a361[_0x38f277]['expiry_date']=_0x28a754;}),_0x458fa5[_0xc306fd(0x151)]((_0x115b31,_0x5ba116)=>{var _0x5c2455=_0xc306fd;_0xb3a361[_0x5ba116][_0x5c2455(0x14f)]=_0x115b31;}),_0x8c511b[_0xc306fd(0x151)]((_0x4397c4,_0x33f090)=>{var _0x52c4cb=_0xc306fd;_0xb3a361[_0x33f090][_0x52c4cb(0xdb)]=_0x4397c4;}),_0x4ddcca[_0xc306fd(0x151)]((_0x15143b,_0x32d4fe)=>{_0xb3a361[_0x32d4fe]['maxPerUnit']=_0x15143b;}),_0x3c3a72['forEach']((_0x3856b3,_0x1059f3)=>{var _0x57b157=_0xc306fd;_0xb3a361[_0x1059f3][_0x57b157(0x13c)]=_0x3856b3;}),_0x1fec29[_0xc306fd(0x151)]((_0x5ddba5,_0x3bd835)=>{var _0x62647b=_0xc306fd;_0xb3a361[_0x3bd835][_0x62647b(0x126)]=_0x5ddba5;}),_0x4181bf[_0xc306fd(0x151)]((_0x4c4ee5,_0x1cefb1)=>{var _0x30c72e=_0xc306fd;_0xb3a361[_0x1cefb1][_0x30c72e(0xe1)]=_0x4c4ee5;});const _0x5b8902=_0xb3a361[_0xc306fd(0xb8)](_0x5e12ae=>_0x5e12ae[_0xc306fd(0xca)]!=='0'&&_0x5e12ae[_0xc306fd(0xca)]!==''||_0x5e12ae[_0xc306fd(0xab)]!=='0'&&_0x5e12ae['to_floorlevel']!=='');var _0x459b35=0x0;_0x5b8902[_0xc306fd(0x151)](_0x48add5=>{var _0x331621=_0xc306fd;parseInt(_0x48add5[_0x331621(0xf0)])<parseInt(_0x48add5['to_quantity'])&&_0x459b35++;});if(_0x459b35!=0x0)return _0x24fcd3[_0xc306fd(0xc4)](_0xc306fd(0xec),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x2afc0c['redirect'](_0xc306fd(0xa0));const _0x109dbf=new invoice_for_transfer();await _0x109dbf[_0xc306fd(0x162)]();for(let _0x56489f=0x0;_0x56489f<=_0x4181bf[_0xc306fd(0xc5)]-0x1;_0x56489f++){_0xb3a361[_0x56489f]['To_invoice']=_0xc306fd(0xb4)+_0x109dbf[_0xc306fd(0xcc)][_0xc306fd(0x15f)]()[_0xc306fd(0xa8)](0x8,'0');}const _0x6f425a=new transfers_finished({'date':_0x4ea217,'from_warehouse':_0x20b2c8,'to_warehouse':_0x20b2c8,'product':_0x5b8902,'note':_0xb742b8,'invoice':_0xc306fd(0xb4)+_0x109dbf[_0xc306fd(0xcc)]['toString']()['padStart'](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0xc306fd(0x101),'PO_number':_0x369fcd,'RequestedBy':_0x571694,'DateofRequest':_0x4b8fdd,'typeservices':_0x9093e9,'destination':_0x5d9733,'deliverydate':_0x219c9e,'driver':_0x592722,'plate':_0x4aa112,'van':_0x30c401,'DRSI':_0x1ff89b,'typevehicle':_0x57e3e1,'TSU':_0x563e31,'TFU':_0x389d56}),_0x359029=await _0x6f425a[_0xc306fd(0x162)]();_0x24fcd3[_0xc306fd(0xc4)](_0xc306fd(0x11a),_0xc306fd(0xdd)),_0x2afc0c['redirect'](_0xc306fd(0x12d)+_0x359029['_id']);}catch(_0xc22009){console[_0xc306fd(0xb9)](_0xc22009),_0x2afc0c['status'](0xc8)[_0xc306fd(0x13b)]({'errorMessage':_0xc22009['message']});}}),router[a0_0x228c30(0xa1)](a0_0x228c30(0xe7),auth,async(_0x59e191,_0x53a142)=>{var _0x486711=a0_0x228c30;try{const {date:_0x4cb29a,from_warehouse:_0x2b6ef0,FromRoom_name:_0x29871f,to_warehouse:_0x127d21,ToRoom_name:_0x1ab479,prod_name:_0x6fe477,from_prod_qty:_0x1ea9a1,from_prod_level:_0x40a69f,from_prod_isle:_0x3ad3fa,from_prod_pallet:_0x6a45c3,to_prod_qty:_0xa2af4c,to_prod_level:_0x3a921b,to_prod_isle:_0xeae95a,to_prod_pallet:_0x2d3912,primary_code:_0x20da9f,secondary_code:_0x3e5945,product_code3:_0x55c7e9,note:_0x29f183,MaxStocks_data2:_0x5d9395,invoice:_0x18e266,expiry_date:_0x19b54e,PO_number_loc:_0x23867b,ReqBy_loc:_0x54a6ac,dateofreq_loc:_0x55ebf7,typeservices_loc_Data:_0x2d16ef,destination_loc:_0x323f5c,deliverydate_loc:_0x548e51,driver_loc:_0x5e12e7,plate_loc:_0x86325b,van_loc:_0x1d0608,DRSI_loc:_0x374f8c,typevehicle_loc:_0x5caec9,TSU_loc:_0x587f6f,TFU_loc:_0x500e0c}=_0x59e191['body'];if(typeof _0x6fe477==_0x486711(0xad))var _0x1ad5b9=[_0x59e191['body'][_0x486711(0x13d)]],_0xf19518=[_0x59e191[_0x486711(0xed)][_0x486711(0x102)]],_0x287579=[_0x59e191[_0x486711(0xed)]['from_prod_level2']],_0x528c8b=[_0x59e191['body'][_0x486711(0xe3)]],_0x1c2346=[_0x59e191[_0x486711(0xed)][_0x486711(0x120)]],_0x3cbf6f=[_0x59e191[_0x486711(0xed)]['primary_code']],_0x679ec2=[_0x59e191[_0x486711(0xed)][_0x486711(0x110)]],_0x5d4d5b=[_0x59e191[_0x486711(0xed)][_0x486711(0x15b)]],_0x1dde11=[_0x59e191[_0x486711(0xed)][_0x486711(0xb2)]],_0x197911=[_0x59e191[_0x486711(0xed)][_0x486711(0xc3)]],_0x1e9491=[_0x59e191[_0x486711(0xed)][_0x486711(0x105)]],_0x5ee2a7=[_0x59e191[_0x486711(0xed)][_0x486711(0x160)]],_0x5b8408=[_0x59e191['body'][_0x486711(0x124)]],_0xf7d157=[_0x59e191[_0x486711(0xed)][_0x486711(0xe0)]],_0x96811d=[_0x59e191['body']['MaxStocks_data']],_0xed0a02=[_0x59e191[_0x486711(0xed)][_0x486711(0x10b)]],_0x3f63fa=[_0x59e191[_0x486711(0xed)][_0x486711(0x13c)]],_0x599be1=[_0x59e191[_0x486711(0xed)][_0x486711(0x109)]],_0x2f7918=[_0x59e191[_0x486711(0xed)][_0x486711(0x130)]],_0x299077=[_0x59e191[_0x486711(0xed)][_0x486711(0x119)]],_0xe332af=[_0x59e191['body'][_0x486711(0x127)]];else var _0x1ad5b9=[..._0x59e191[_0x486711(0xed)][_0x486711(0x13d)]],_0xf19518=[..._0x59e191[_0x486711(0xed)][_0x486711(0x102)]],_0x287579=[..._0x59e191['body'][_0x486711(0xac)]],_0x528c8b=[..._0x59e191[_0x486711(0xed)]['New_Qty_Converted']],_0x1c2346=[..._0x59e191[_0x486711(0xed)][_0x486711(0x120)]],_0x3cbf6f=[..._0x59e191[_0x486711(0xed)]['primary_code']],_0x679ec2=[..._0x59e191['body']['secondary_code']],_0x5d4d5b=[..._0x59e191[_0x486711(0xed)][_0x486711(0x15b)]],_0x1dde11=[..._0x59e191[_0x486711(0xed)][_0x486711(0xb2)]],_0x197911=[..._0x59e191[_0x486711(0xed)][_0x486711(0xc3)]],_0x1e9491=[..._0x59e191[_0x486711(0xed)]['secondary_unit']],_0x5ee2a7=[..._0x59e191['body']['batch_code']],_0x5b8408=[..._0x59e191[_0x486711(0xed)]['expiry_date']],_0xf7d157=[..._0x59e191[_0x486711(0xed)][_0x486711(0xe0)]],_0x96811d=[..._0x59e191[_0x486711(0xed)][_0x486711(0x114)]],_0xed0a02=[..._0x59e191['body'][_0x486711(0x10b)]],_0x3f63fa=[..._0x59e191[_0x486711(0xed)][_0x486711(0x13c)]],_0x599be1=[..._0x59e191['body'][_0x486711(0x109)]],_0x2f7918=[..._0x59e191['body'][_0x486711(0x130)]],_0x299077=[..._0x59e191[_0x486711(0xed)][_0x486711(0x119)]],_0xe332af=[..._0x59e191[_0x486711(0xed)]['id_transaction']];const _0x1819c5=_0x1ad5b9[_0x486711(0x11d)](_0x3b462f=>{return _0x3b462f={'product_name':_0x3b462f};});_0xf19518[_0x486711(0x151)]((_0x56a8e9,_0xfec0fc)=>{var _0x54a587=_0x486711;_0x1819c5[_0xfec0fc][_0x54a587(0xf0)]=_0x56a8e9;}),_0x287579['forEach']((_0x4850bf,_0x342119)=>{var _0x19a600=_0x486711,_0x575acb=_0x4850bf[_0x19a600(0x15d)](/[A-Za-z]+/)[0x0],_0x510640=parseInt(_0x4850bf[_0x19a600(0x15d)](/\d+/)[0x0]);_0x1819c5[_0x342119][_0x19a600(0x163)]=_0x510640,_0x1819c5[_0x342119][_0x19a600(0xba)]=_0x575acb;}),_0xe332af[_0x486711(0x151)]((_0x1e41ee,_0x40db18)=>{var _0x24d437=_0x486711;_0x1819c5[_0x40db18][_0x24d437(0x127)]=_0x1e41ee;}),_0x299077[_0x486711(0x151)]((_0x19cf2a,_0x362163)=>{var _0x58919d=_0x486711;_0x1819c5[_0x362163][_0x58919d(0x119)]=_0x19cf2a;}),_0x528c8b[_0x486711(0x151)]((_0x1680a0,_0x53ca2f)=>{var _0x53c82a=_0x486711;_0x1819c5[_0x53ca2f][_0x53c82a(0xca)]=_0x1680a0;}),_0x1c2346[_0x486711(0x151)]((_0x142f92,_0x526a27)=>{var _0x389df9=_0x486711,_0x35801f=_0x142f92['match'](/[A-Za-z]+/)[0x0],_0x1060ee=parseInt(_0x142f92[_0x389df9(0x15d)](/\d+/)[0x0]);_0x1819c5[_0x526a27]['to_level']=_0x35801f,_0x1819c5[_0x526a27]['to_bay']=_0x1060ee;}),_0x3cbf6f['forEach']((_0x3f715a,_0x1e4849)=>{var _0x4f5ac6=_0x486711;_0x1819c5[_0x1e4849][_0x4f5ac6(0xda)]=_0x3f715a;}),_0x679ec2['forEach']((_0x76b74e,_0x4beb76)=>{var _0x8c28cc=_0x486711;_0x1819c5[_0x4beb76][_0x8c28cc(0x110)]=_0x76b74e;}),_0x5d4d5b[_0x486711(0x151)]((_0x1aadaa,_0xa4bf54)=>{_0x1819c5[_0xa4bf54]['product_code']=_0x1aadaa;}),_0x1dde11['forEach']((_0x5b3629,_0x19e6b3)=>{var _0x28d64a=_0x486711;_0x1819c5[_0x19e6b3][_0x28d64a(0xdb)]=_0x5b3629;}),_0x197911[_0x486711(0x151)]((_0x4d0501,_0x3962ec)=>{_0x1819c5[_0x3962ec]['unit']=_0x4d0501;}),_0x1e9491[_0x486711(0x151)]((_0x422f4e,_0x5ce6b7)=>{var _0x3a547e=_0x486711;_0x1819c5[_0x5ce6b7][_0x3a547e(0x105)]=_0x422f4e;}),_0x5ee2a7['forEach']((_0x4059d3,_0x522139)=>{_0x1819c5[_0x522139]['batch_code']=_0x4059d3;}),_0x5b8408['forEach']((_0x393f82,_0x5a4c87)=>{_0x1819c5[_0x5a4c87]['expiry_date']=_0x393f82;}),_0xf7d157[_0x486711(0x151)]((_0x53b2c0,_0x41bfa4)=>{var _0x3ea46d=_0x486711;_0x1819c5[_0x41bfa4][_0x3ea46d(0x14f)]=_0x53b2c0;}),_0x96811d[_0x486711(0x151)]((_0x21ead9,_0x3351fe)=>{var _0x1cf654=_0x486711;_0x1819c5[_0x3351fe][_0x1cf654(0xdb)]=_0x21ead9;}),_0xed0a02[_0x486711(0x151)]((_0x437bc7,_0x3ae422)=>{var _0x58d8e0=_0x486711;_0x1819c5[_0x3ae422][_0x58d8e0(0x10b)]=_0x437bc7;}),_0x3f63fa[_0x486711(0x151)]((_0x4e87ae,_0xe80cae)=>{var _0x515c6c=_0x486711;_0x1819c5[_0xe80cae][_0x515c6c(0x13c)]=_0x4e87ae;}),_0x599be1[_0x486711(0x151)]((_0x29c882,_0x4b63e5)=>{var _0x100986=_0x486711;_0x1819c5[_0x4b63e5][_0x100986(0x126)]=_0x29c882;}),_0x2f7918['forEach']((_0x2b10ca,_0x30e2ed)=>{_0x1819c5[_0x30e2ed]['to_room_name']=_0x2b10ca;});const _0x223a9b=_0x1819c5[_0x486711(0xb8)](_0x48cb8a=>_0x48cb8a[_0x486711(0xca)]!=='0'&&_0x48cb8a[_0x486711(0xca)]!==''||_0x48cb8a[_0x486711(0xab)]!=='0'&&_0x48cb8a[_0x486711(0xab)]!=='');var _0x8120dc=0x0;_0x223a9b['forEach'](_0x2f8ba2=>{var _0xc117d2=_0x486711;parseInt(_0x2f8ba2['from_quantity'])<parseInt(_0x2f8ba2[_0xc117d2(0xca)])&&_0x8120dc++;});if(_0x8120dc!=0x0)return _0x59e191[_0x486711(0xc4)](_0x486711(0xec),_0x486711(0xe5)),_0x53a142[_0x486711(0x164)](_0x486711(0xa0));const _0x28c846=new invoice_for_transfer();await _0x28c846['save']();for(let _0x54be50=0x0;_0x54be50<=_0x2f7918[_0x486711(0xc5)]-0x1;_0x54be50++){_0x1819c5[_0x54be50][_0x486711(0x145)]=_0x486711(0xb4)+_0x28c846[_0x486711(0xcc)][_0x486711(0x15f)]()[_0x486711(0xa8)](0x8,'0');}const _0x5a190e=new transfers_finished({'date':_0x4cb29a,'from_warehouse':_0x2b6ef0,'to_warehouse':_0x127d21,'product':_0x223a9b,'note':_0x29f183,'invoice':'TRF-'+_0x28c846[_0x486711(0xcc)][_0x486711(0x15f)]()[_0x486711(0xa8)](0x8,'0'),'type_of_transaction':'own','type_of_process':'location2location','PO_number':_0x23867b,'RequestedBy':_0x54a6ac,'DateofRequest':_0x55ebf7,'typeservices':_0x2d16ef,'destination':_0x323f5c,'deliverydate':_0x548e51,'driver':_0x5e12e7,'plate':_0x86325b,'van':_0x1d0608,'DRSI':_0x374f8c,'typevehicle':_0x5caec9,'TSU':_0x587f6f,'TFU':_0x500e0c}),_0x207f5c=await _0x5a190e[_0x486711(0x162)]();_0x59e191[_0x486711(0xc4)](_0x486711(0x11a),_0x486711(0xdd)),_0x53a142['redirect'](_0x486711(0x12d)+_0x207f5c[_0x486711(0xf2)]);}catch(_0x3ab201){console['log'](_0x3ab201),_0x53a142[_0x486711(0xea)](0xc8)[_0x486711(0x13b)]({'errorMessage':_0x3ab201['message']});}}),router[a0_0x228c30(0xe8)]('/preview/:id',auth,async(_0x37f788,_0x47d6f9)=>{var _0x466e64=a0_0x228c30;try{const {username:_0x377fcc,email:_0x54a26c,role:_0x2fad37}=_0x37f788[_0x466e64(0x100)],_0x57f4cd=_0x37f788[_0x466e64(0x100)],_0x38d9c8=await profile['findOne']({'email':_0x57f4cd[_0x466e64(0x140)]}),_0x14e9dd=await master_shop[_0x466e64(0xc2)](),_0x460b1f=await transfers_finished['findById'](_0x37f788[_0x466e64(0xf6)]['id']);let _0x54b172;if(_0x57f4cd[_0x466e64(0xd5)]==_0x466e64(0xfd)){const _0x2f05d8=await staff['findOne']({'email':_0x57f4cd[_0x466e64(0x140)]});_0x54b172=await warehouse[_0x466e64(0xc2)]({'status':_0x466e64(0xd7),'name':_0x2f05d8[_0x466e64(0x15a)],'warehouse_category':_0x466e64(0x10e)});}else _0x54b172=await warehouse[_0x466e64(0xc2)]({'status':_0x466e64(0xd7),'warehouse_category':_0x466e64(0x10e)});const _0x16ffe4=await warehouse['aggregate']([{'$match':{'name':_0x460b1f[_0x466e64(0xb7)],'warehouse_category':_0x466e64(0x10e)}},{'$unwind':_0x466e64(0x12f)},{'$group':{'_id':_0x466e64(0x112),'name':{'$first':_0x466e64(0xdf)},'product_stock':{'$first':_0x466e64(0xf8)},'bay':{'$first':_0x466e64(0xd9)},'bin':{'$first':_0x466e64(0x143)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x466e64(0xd3)},'primary_code':{'$first':_0x466e64(0x150)},'secondary_code':{'$first':_0x466e64(0x141)},'product_code':{'$first':_0x466e64(0x142)},'storage':{'$first':_0x466e64(0x14d)},'rack':{'$first':_0x466e64(0x13a)},'expiry_date':{'$first':_0x466e64(0x136)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x466e64(0x13f)},'warehoue_name':{'$first':_0x466e64(0xbb)}}}]),_0x7dff45=await product[_0x466e64(0xc2)]({});if(_0x14e9dd[0x0][_0x466e64(0xe6)]==_0x466e64(0x132)){var _0x488053=users['English'];console[_0x466e64(0xb9)](_0x488053);}else{if(_0x14e9dd[0x0][_0x466e64(0xe6)]=='Hindi')var _0x488053=users[_0x466e64(0xf1)];else{if(_0x14e9dd[0x0][_0x466e64(0xe6)]==_0x466e64(0x128))var _0x488053=users['German'];else{if(_0x14e9dd[0x0][_0x466e64(0xe6)]==_0x466e64(0xfc))var _0x488053=users[_0x466e64(0xfc)];else{if(_0x14e9dd[0x0][_0x466e64(0xe6)]=='French')var _0x488053=users[_0x466e64(0xd4)];else{if(_0x14e9dd[0x0][_0x466e64(0xe6)]==_0x466e64(0xf5))var _0x488053=users[_0x466e64(0xcd)];else{if(_0x14e9dd[0x0][_0x466e64(0xe6)]=='Chinese')var _0x488053=users[_0x466e64(0x138)];else{if(_0x14e9dd[0x0][_0x466e64(0xe6)]==_0x466e64(0x139))var _0x488053=users[_0x466e64(0x104)];}}}}}}}_0x47d6f9[_0x466e64(0x157)](_0x466e64(0x117),{'success':_0x37f788[_0x466e64(0xc4)](_0x466e64(0x11a)),'errors':_0x37f788['flash'](_0x466e64(0xec)),'role':_0x57f4cd,'profile':_0x38d9c8,'master_shop':_0x14e9dd,'warehouse':_0x54b172,'transfer':_0x460b1f,'stock':_0x16ffe4,'unit':_0x7dff45,'language':_0x488053});}catch(_0x24f64e){console['log'](_0x24f64e);}}),router[a0_0x228c30(0xa1)](a0_0x228c30(0xd6),auth,async(_0x32f133,_0x1d55e2)=>{var _0x227ed7=a0_0x228c30;try{const {invoice:_0x36f412,from_warehouse:_0x26ce9c,FromRoom_name:_0x116905,to_warehouse:_0x5e6cef,ToRoom_name:_0x5a6eb5}=_0x32f133['body'],_0x2e0c52=await transfers_finished[_0x227ed7(0xcf)](_0x32f133[_0x227ed7(0xf6)]['id']),_0x1331f2=_0x2e0c52[_0x227ed7(0xa7)][_0x227ed7(0x11d)](async _0x578a8a=>{var _0x10fd37=_0x227ed7;if(_0x578a8a[_0x10fd37(0xca)]>0x0){var _0x2611c2=await warehouse[_0x10fd37(0x144)]({'name':_0x26ce9c,'room':_0x578a8a[_0x10fd37(0x126)]});const _0x546eec=_0x2611c2[_0x10fd37(0xeb)]['map'](_0x1b7ff0=>{var _0x3ea9d2=_0x10fd37;_0x1b7ff0[_0x3ea9d2(0xf2)]==_0x578a8a[_0x3ea9d2(0x127)]&&(_0x1b7ff0[_0x3ea9d2(0xa4)]=Math['max'](0x0,Math['abs'](_0x1b7ff0[_0x3ea9d2(0xa4)])-Math[_0x3ea9d2(0x111)](_0x578a8a[_0x3ea9d2(0xca)])),console[_0x3ea9d2(0xb9)](_0x1b7ff0[_0x3ea9d2(0xa4)]));});}return _0x2611c2;});Promise[_0x227ed7(0xc0)](_0x1331f2)[_0x227ed7(0xee)](async _0x244907=>{var _0x114d27=_0x227ed7;try{for(const _0x4e13bd of _0x244907){await _0x4e13bd[_0x114d27(0x162)]();}const _0xc8a48e=_0x2e0c52[_0x114d27(0xa7)][_0x114d27(0x11d)](async _0x2d61a3=>{var _0xce74bd=_0x114d27,_0x42ef19=await warehouse['findOne']({'name':_0x5e6cef,'room':_0x2d61a3[_0xce74bd(0xe1)]});if(_0x2d61a3[_0xce74bd(0xca)]>0x0){var _0x4f650d=0x0;const _0x1f0d69=_0x42ef19[_0xce74bd(0xeb)][_0xce74bd(0x11d)](_0x461d6e=>{var _0xd10c73=_0xce74bd;_0x461d6e[_0xd10c73(0x13e)]==_0x2d61a3[_0xd10c73(0x13e)]&&_0x461d6e['bay']==_0x2d61a3[_0xd10c73(0x121)]&&_0x461d6e[_0xd10c73(0x124)]==_0x2d61a3['expiry_date']&&_0x461d6e[_0xd10c73(0x14f)]==_0x2d61a3[_0xd10c73(0x14f)]&&_0x461d6e['batch_code']==_0x2d61a3[_0xd10c73(0x160)]&&_0x461d6e[_0xd10c73(0x122)]==_0x2d61a3[_0xd10c73(0x145)]&&(typeof _0x2d61a3[_0xd10c73(0x127)]==_0xd10c73(0xe9)?(console['log'](_0xd10c73(0x116),_0x461d6e[_0xd10c73(0xa4)]+'\x20<>\x20'+_0x461d6e[_0xd10c73(0xf2)]+_0xd10c73(0xd1)+Math[_0xd10c73(0x111)](_0x461d6e['product_stock'])+Math['abs'](_0x2d61a3[_0xd10c73(0xca)])),_0x461d6e['product_stock']=Math['abs'](_0x461d6e[_0xd10c73(0xa4)])+Math[_0xd10c73(0x111)](_0x2d61a3['to_quantity'])):_0x461d6e[_0xd10c73(0xa4)]=Math[_0xd10c73(0x111)](_0x461d6e[_0xd10c73(0xa4)])+Math[_0xd10c73(0x111)](_0x2d61a3[_0xd10c73(0xca)]),_0x4f650d++);});_0x4f650d=='0'&&(_0x42ef19['product_details']=_0x42ef19[_0xce74bd(0xeb)][_0xce74bd(0xc8)]({'product_name':_0x2d61a3['product_name'],'product_stock':_0x2d61a3[_0xce74bd(0xca)],'bay':_0x2d61a3['to_bay'],'level':_0x2d61a3[_0xce74bd(0xbd)],'product_code':_0x2d61a3[_0xce74bd(0x146)],'primary_code':_0x2d61a3[_0xce74bd(0xda)],'secondary_code':_0x2d61a3[_0xce74bd(0x110)],'expiry_date':_0x2d61a3[_0xce74bd(0x124)],'production_date':_0x2d61a3[_0xce74bd(0x14f)],'maxProducts':_0x2d61a3[_0xce74bd(0xdb)],'batch_code':_0x2d61a3['batch_code'],'secondary_unit':_0x2d61a3['secondary_unit'],'unit':_0x2d61a3[_0xce74bd(0x12e)],'maxProducts':_0x2d61a3[_0xce74bd(0xdb)],'maxPerUnit':_0x2d61a3[_0xce74bd(0x10b)],'invoice':_0x2d61a3['To_invoice']}));}return _0x42ef19;});Promise[_0x114d27(0xc0)](_0xc8a48e)[_0x114d27(0xee)](async _0x2dfa82=>{var _0x6dd990=_0x114d27;try{console[_0x6dd990(0xb9)](_0x2e0c52['type_of_process']);if(_0x2e0c52[_0x6dd990(0xa5)]!='location2location')for(const _0x5c148c of _0x2dfa82){await warehouse[_0x6dd990(0xb6)]({'_id':_0x5c148c['_id']},{'$addToSet':{'product_details':{'$each':_0x5c148c[_0x6dd990(0xeb)]}}});}_0x2e0c52[_0x6dd990(0x152)]='True';const _0x3fbef8=await _0x2e0c52[_0x6dd990(0x162)](),_0x15d374=await master_shop['find'](),_0x1e63ab=await email_settings[_0x6dd990(0x144)](),_0x2a3d6b=await supervisor_settings[_0x6dd990(0xc2)]();var _0x91791c=_0x2e0c52['product'],_0x231d3e='',_0x1c75cf;for(_0x1c75cf in _0x91791c){var _0x52e0a9='FG';_0x2e0c52[_0x6dd990(0xd2)]==_0x6dd990(0xae)&&(_0x52e0a9='DG'),_0x231d3e+=_0x6dd990(0x148)+_0x6dd990(0x106)+_0x91791c[_0x1c75cf][_0x6dd990(0x13e)]+_0x6dd990(0x108)+_0x6dd990(0x106)+_0x91791c[_0x1c75cf][_0x6dd990(0x146)]+'</td>'+_0x6dd990(0x106)+_0x91791c[_0x1c75cf][_0x6dd990(0xca)]+_0x6dd990(0x108)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x91791c[_0x1c75cf][_0x6dd990(0x12e)]+_0x6dd990(0x108)+_0x6dd990(0x106)+_0x91791c[_0x1c75cf][_0x6dd990(0x105)]+_0x6dd990(0x108)+_0x6dd990(0x106)+_0x2e0c52['to_warehouse']+_0x6dd990(0x108)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x91791c[_0x1c75cf]['to_room_name']+_0x6dd990(0x108)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x52e0a9+_0x91791c[_0x1c75cf][_0x6dd990(0x121)]+_0x6dd990(0x108)+_0x6dd990(0x147);}_0x32f133[_0x6dd990(0xc4)](_0x6dd990(0x11a),'Transfer\x20Finalize\x20Successfully'),_0x1d55e2[_0x6dd990(0x164)]('/picking_list/PDF_transfer/'+_0x3fbef8['_id']);}catch(_0x596eac){console['error'](_0x596eac),_0x1d55e2[_0x6dd990(0xea)](0x1f4)[_0x6dd990(0x13b)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x114d27(0x11f)](_0x1d618d=>{var _0x577d96=_0x114d27;console[_0x577d96(0x149)](_0x1d618d),_0x1d55e2[_0x577d96(0xea)](0x1f4)[_0x577d96(0x13b)]({'error':_0x577d96(0xc6)});});}catch(_0x232969){console['error'](_0x232969),_0x1d55e2[_0x114d27(0xea)](0x1f4)[_0x114d27(0x13b)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x227ed7(0x11f)](_0x13e88c=>{var _0x575d71=_0x227ed7;console[_0x575d71(0x149)](_0x13e88c),_0x1d55e2[_0x575d71(0xea)](0x1f4)[_0x575d71(0x13b)]({'error':'An\x20error\x20occurred.'});});}catch(_0x18593e){_0x1d55e2[_0x227ed7(0x13b)]({'message':_0x18593e[_0x227ed7(0xc9)]});}});function BayBinSelected(_0x3270d8,_0x264789){var _0x29155e=a0_0x228c30,_0x1681fa=[];let _0x2fbb04=[];var _0x35e0ad=[];if(_0x3270d8=='DRY\x20GOODS'){switch(_0x264789){case'Rack\x201':_0x1681fa=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x29155e(0x153):_0x1681fa=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x35e0ad=['DG'];}else{if(_0x3270d8==_0x29155e(0x129)){switch(_0x264789){case _0x29155e(0xaa):_0x1681fa=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x29155e(0x153):_0x1681fa=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x35e0ad=['FG'];}}return{'levels':_0x1681fa,'identify':_0x35e0ad};}router[a0_0x228c30(0xe8)](a0_0x228c30(0xd8),auth,async(_0x1f97ec,_0x12afa3)=>{var _0x526c1c=a0_0x228c30;try{const {username:_0x2da388,email:_0x29d9e0,role:_0x23c934}=_0x1f97ec[_0x526c1c(0x100)],_0x3f3be0=_0x1f97ec[_0x526c1c(0x100)],_0x5c3878=await profile[_0x526c1c(0x144)]({'email':_0x3f3be0['email']}),_0x35979c=await master_shop[_0x526c1c(0xc2)](),_0xbf5dd2=await transfers_finished[_0x526c1c(0xcf)](_0x1f97ec[_0x526c1c(0xf6)]['id']);let _0x2a3e9d=new Date(_0xbf5dd2[_0x526c1c(0x124)]),_0x515d5a=('0'+_0x2a3e9d['getDate']())[_0x526c1c(0x14c)](-0x2),_0x52db93=('0'+(_0x2a3e9d[_0x526c1c(0xce)]()+0x1))[_0x526c1c(0x14c)](-0x2),_0x2f068f=_0x2a3e9d[_0x526c1c(0xe2)](),_0x42e858=_0x2f068f+'-'+_0x52db93+'-'+_0x515d5a,_0x348c31;if(_0x3f3be0[_0x526c1c(0xd5)]=='staff'){const _0xb92f2b=await staff[_0x526c1c(0x144)]({'email':_0x3f3be0[_0x526c1c(0x140)]});_0x348c31=await warehouse[_0x526c1c(0xc2)]({'status':_0x526c1c(0xd7),'name':_0xb92f2b[_0x526c1c(0x15a)],'warehouse_category':_0x526c1c(0x10e)});}else _0x348c31=await warehouse['find']({'status':'Enabled','warehouse_category':_0x526c1c(0x10e)});const _0x204474=await warehouse[_0x526c1c(0x14b)]([{'$match':{'name':_0xbf5dd2[_0x526c1c(0xb7)],'room':_0xbf5dd2[_0x526c1c(0x135)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x526c1c(0x112),'name':{'$first':_0x526c1c(0xdf)},'product_stock':{'$first':_0x526c1c(0xf8)},'bay':{'$first':_0x526c1c(0xd9)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x526c1c(0xf4)},'floorlevel':{'$first':_0x526c1c(0xd3)},'primary_code':{'$first':_0x526c1c(0x150)},'secondary_code':{'$first':_0x526c1c(0x141)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x526c1c(0x14d)},'rack':{'$first':_0x526c1c(0x13a)}}}]);var _0x5cfc33=[0x1,0x2,0x3,0x4],_0x9d87a0=['A','B','C','D','E','F','G','H','I','J'],_0x3e796c=[_0x526c1c(0x12b),_0x526c1c(0xcb)];const _0x1c18a9=await product[_0x526c1c(0xc2)]({}),_0x1c55e1=BayBinSelected(_0xbf5dd2['to_warehouse'],_0xbf5dd2[_0x526c1c(0x10c)]);if(_0x35979c[0x0]['language']==_0x526c1c(0x132)){var _0x5da138=users[_0x526c1c(0xaf)];console['log'](_0x5da138);}else{if(_0x35979c[0x0][_0x526c1c(0xe6)]==_0x526c1c(0xf1))var _0x5da138=users[_0x526c1c(0xf1)];else{if(_0x35979c[0x0][_0x526c1c(0xe6)]=='German')var _0x5da138=users[_0x526c1c(0x128)];else{if(_0x35979c[0x0][_0x526c1c(0xe6)]==_0x526c1c(0xfc))var _0x5da138=users[_0x526c1c(0xfc)];else{if(_0x35979c[0x0][_0x526c1c(0xe6)]==_0x526c1c(0xd4))var _0x5da138=users[_0x526c1c(0xd4)];else{if(_0x35979c[0x0][_0x526c1c(0xe6)]==_0x526c1c(0xf5))var _0x5da138=users[_0x526c1c(0xcd)];else{if(_0x35979c[0x0][_0x526c1c(0xe6)]==_0x526c1c(0x138))var _0x5da138=users[_0x526c1c(0x138)];else{if(_0x35979c[0x0]['language']==_0x526c1c(0x139))var _0x5da138=users[_0x526c1c(0x104)];}}}}}}}_0x12afa3[_0x526c1c(0x157)](_0x526c1c(0x10d),{'success':_0x1f97ec[_0x526c1c(0xc4)]('success'),'errors':_0x1f97ec['flash']('errors'),'role':_0x3f3be0,'profile':_0x5c3878,'master_shop':_0x35979c,'warehouse':_0x348c31,'transfer':_0xbf5dd2,'stock':_0x204474,'unit':_0x1c18a9,'language':_0x5da138,'levels':_0x5cfc33,'Isle':_0x9d87a0,'rooms_data':_0x3e796c,'ed_fullDate':_0x42e858,'dataSelected':_0x1c55e1});}catch(_0x18ed3e){console[_0x526c1c(0xb9)](_0x18ed3e);}}),router[a0_0x228c30(0xa1)](a0_0x228c30(0xd8),auth,async(_0x211530,_0x466f91)=>{var _0x52ec5c=a0_0x228c30;try{const _0x55defa=_0x211530[_0x52ec5c(0xf6)]['id'];console[_0x52ec5c(0xb9)](_0x211530[_0x52ec5c(0xed)]);const _0x421438=await transfers_finished['findById'](_0x55defa);console[_0x52ec5c(0xb9)](_0x52ec5c(0xfa),_0x421438);const {date:_0x446c5c,from_warehouse:_0x59cd4d,FromRoom_name:_0x2f38fe,to_warehouse:_0x31c9df,ToRoom_name:_0x13904a,prod_name:_0x86160e,from_prod_qty:_0x5e8678,from_prod_level:_0x21a6bf,from_prod_isle:_0x536527,from_prod_pallet:_0x42e8ea,to_prod_qty:_0x213772,to_prod_level:_0x35d555,to_prod_isle:_0x240c45,to_prod_pallet:_0x24e538,primary_code:_0x5a9a28,secondary_code:_0x1e5366,product_code3:_0x1015ee,note:_0x31a05a,invoice:_0x28aba9,expiry_date:_0x403395}=_0x211530[_0x52ec5c(0xed)];if(typeof _0x86160e=='string')var _0x3546d5=[_0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x13d)]],_0x31555e=[_0x211530[_0x52ec5c(0xed)]['from_prod_qty']],_0x26fb29=[_0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x11b)]],_0x522d5c=[_0x211530[_0x52ec5c(0xed)]['to_prod_qty']],_0x39b323=[_0x211530['body'][_0x52ec5c(0x120)]],_0x5693f5=[_0x211530[_0x52ec5c(0xed)][_0x52ec5c(0xda)]],_0xd450d8=[_0x211530[_0x52ec5c(0xed)]['secondary_code']],_0x5a90e0=[_0x211530[_0x52ec5c(0xed)]['product_code3']],_0x17ba0d=[_0x211530[_0x52ec5c(0xed)][_0x52ec5c(0xb2)]],_0x1f7d06=[_0x211530[_0x52ec5c(0xed)]['unit']],_0x3ca309=[_0x211530[_0x52ec5c(0xed)]['secondary_unit']],_0x576c03=[_0x211530[_0x52ec5c(0xed)]['batch_code']],_0x1d10f8=[_0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x124)]];else var _0x3546d5=[..._0x211530[_0x52ec5c(0xed)]['prod_name']],_0x31555e=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x102)]],_0x26fb29=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x11b)]],_0x522d5c=[..._0x211530['body']['to_prod_qty']],_0x39b323=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x120)]],_0x5693f5=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0xda)]],_0xd450d8=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x110)]],_0x5a90e0=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x15b)]],_0x17ba0d=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0xb2)]],_0x1f7d06=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x12e)]],_0x3ca309=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x105)]],_0x576c03=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x160)]],_0x1d10f8=[..._0x211530[_0x52ec5c(0xed)][_0x52ec5c(0x124)]];const _0x4ae590=_0x3546d5[_0x52ec5c(0x11d)](_0x48e381=>{return _0x48e381={'product_name':_0x48e381};});_0x31555e[_0x52ec5c(0x151)]((_0x4fc333,_0x20e51a)=>{var _0x4afc16=_0x52ec5c;_0x4ae590[_0x20e51a][_0x4afc16(0xf0)]=_0x4fc333;}),_0x26fb29['forEach']((_0x140b27,_0x3dfeb6)=>{_0x4ae590[_0x3dfeb6]['from_bay']=_0x140b27;}),_0x522d5c[_0x52ec5c(0x151)]((_0x203f6e,_0x4e7fcb)=>{var _0x322bbf=_0x52ec5c;_0x4ae590[_0x4e7fcb][_0x322bbf(0xca)]=_0x203f6e;}),_0x39b323[_0x52ec5c(0x151)]((_0x1e0d0a,_0x40c050)=>{_0x4ae590[_0x40c050]['to_bay']=_0x1e0d0a;}),_0x5693f5['forEach']((_0x3b3cf0,_0x1d468e)=>{var _0x2a9b82=_0x52ec5c;_0x4ae590[_0x1d468e][_0x2a9b82(0xda)]=_0x3b3cf0;}),_0xd450d8[_0x52ec5c(0x151)]((_0x5f5a9d,_0x21d944)=>{var _0x15d6ae=_0x52ec5c;_0x4ae590[_0x21d944][_0x15d6ae(0x110)]=_0x5f5a9d;}),_0x5a90e0['forEach']((_0x58d19e,_0x1d7039)=>{var _0x358370=_0x52ec5c;_0x4ae590[_0x1d7039][_0x358370(0x146)]=_0x58d19e;}),_0x17ba0d[_0x52ec5c(0x151)]((_0x199a0c,_0x5bf3d6)=>{var _0x3202d0=_0x52ec5c;_0x4ae590[_0x5bf3d6][_0x3202d0(0xdb)]=_0x199a0c;}),_0x1f7d06[_0x52ec5c(0x151)]((_0x48a6bd,_0x5cb9b7)=>{var _0x13cbd3=_0x52ec5c;_0x4ae590[_0x5cb9b7][_0x13cbd3(0x12e)]=_0x48a6bd;}),_0x3ca309['forEach']((_0x733005,_0x19965c)=>{var _0x5c396a=_0x52ec5c;_0x4ae590[_0x19965c][_0x5c396a(0x105)]=_0x733005;}),_0x576c03[_0x52ec5c(0x151)]((_0x3b4f36,_0xfbf85)=>{var _0x5db9b1=_0x52ec5c;_0x4ae590[_0xfbf85][_0x5db9b1(0x160)]=_0x3b4f36;}),_0x1d10f8[_0x52ec5c(0x151)]((_0x2f9887,_0x4c6c11)=>{_0x4ae590[_0x4c6c11]['expiry_date']=_0x2f9887;});const _0x2d1536=_0x4ae590['filter'](_0x38dd6e=>_0x38dd6e[_0x52ec5c(0xca)]!=='0'&&_0x38dd6e[_0x52ec5c(0xca)]!==''||_0x38dd6e[_0x52ec5c(0xab)]!=='0'&&_0x38dd6e[_0x52ec5c(0xab)]!=='');var _0x6ef706=0x0;_0x2d1536[_0x52ec5c(0x151)](_0x40f623=>{var _0x275433=_0x52ec5c;parseInt(_0x40f623[_0x275433(0xf0)])<parseInt(_0x40f623['to_quantity'])&&_0x6ef706++;});if(_0x6ef706!=0x0)return _0x211530[_0x52ec5c(0xc4)]('errors',_0x52ec5c(0xe5)),_0x466f91[_0x52ec5c(0x164)](_0x52ec5c(0xa0));const _0x4d229a=await warehouse['findOne']({'name':_0x421438[_0x52ec5c(0xb7)],'room':_0x421438[_0x52ec5c(0x135)]});_0x421438[_0x52ec5c(0xa7)][_0x52ec5c(0x151)](_0x1aa834=>{var _0x4b8eb9=_0x52ec5c;if(_0x1aa834[_0x4b8eb9(0xca)]>0x0){const _0x34e28d=_0x4d229a[_0x4b8eb9(0xeb)]['map'](_0x452bc3=>{var _0xfd6f7b=_0x4b8eb9;_0x452bc3[_0xfd6f7b(0x13e)]==_0x1aa834[_0xfd6f7b(0x13e)]&&_0x452bc3[_0xfd6f7b(0x10a)]==_0x1aa834[_0xfd6f7b(0x163)]&&(_0x452bc3[_0xfd6f7b(0xa4)]=parseInt(_0x452bc3[_0xfd6f7b(0xa4)])+parseInt(_0x1aa834[_0xfd6f7b(0xca)]));});}}),await _0x4d229a[_0x52ec5c(0x162)]();const _0x5462ac=await warehouse[_0x52ec5c(0x144)]({'name':_0x421438[_0x52ec5c(0xd2)],'room':_0x421438[_0x52ec5c(0x10c)]});_0x421438[_0x52ec5c(0xa7)][_0x52ec5c(0x151)](_0x17a8c5=>{var _0x50f068=_0x52ec5c;if(_0x17a8c5[_0x50f068(0xca)]>0x0){const _0x46a359=_0x5462ac[_0x50f068(0xeb)][_0x50f068(0x11d)](_0x4d173c=>{var _0x56e9c0=_0x50f068;_0x4d173c[_0x56e9c0(0x13e)]==_0x17a8c5[_0x56e9c0(0x13e)]&&_0x4d173c['bay']==_0x17a8c5[_0x56e9c0(0x121)]&&(_0x4d173c[_0x56e9c0(0xa4)]=parseInt(_0x4d173c[_0x56e9c0(0xa4)])-parseInt(_0x17a8c5['to_quantity']));});}}),await _0x5462ac['save'](),_0x421438[_0x52ec5c(0x11e)]=_0x446c5c,_0x421438[_0x52ec5c(0xb7)]=_0x59cd4d,_0x421438[_0x52ec5c(0xd2)]=_0x31c9df,_0x421438['product']=_0x2d1536,_0x421438['note']=_0x31a05a,_0x421438[_0x52ec5c(0x122)]=_0x28aba9;const _0xca37cf=await _0x421438[_0x52ec5c(0x162)](),_0x1605fb=await warehouse[_0x52ec5c(0x144)]({'name':_0x59cd4d,'room':_0x2f38fe});_0xca37cf[_0x52ec5c(0xa7)][_0x52ec5c(0x151)](_0x5f9f95=>{var _0x168542=_0x52ec5c;if(_0x5f9f95['to_quantity']>0x0){const _0x35dae1=_0x1605fb['product_details'][_0x168542(0x11d)](_0x1590e5=>{var _0x2051ff=_0x168542;_0x1590e5[_0x2051ff(0x13e)]==_0x5f9f95['product_name']&&_0x1590e5[_0x2051ff(0x10a)]==_0x5f9f95[_0x2051ff(0x163)]&&(_0x1590e5['product_stock']=parseInt(_0x1590e5['product_stock'])-parseInt(_0x5f9f95['to_quantity']));});}}),await _0x1605fb[_0x52ec5c(0x162)]();const _0x5405eb=await warehouse[_0x52ec5c(0x144)]({'name':_0x31c9df,'room':_0x13904a});_0xca37cf[_0x52ec5c(0xa7)]['forEach'](_0x2d253c=>{var _0x54b1ca=_0x52ec5c;if(_0x2d253c[_0x54b1ca(0xca)]>0x0){var _0x931cd9=0x0;const _0x3e17f8=_0x5405eb[_0x54b1ca(0xeb)][_0x54b1ca(0x11d)](_0x319e8c=>{var _0x33c47a=_0x54b1ca;_0x319e8c[_0x33c47a(0x13e)]==_0x2d253c[_0x33c47a(0x13e)]&&_0x319e8c[_0x33c47a(0x10a)]==_0x2d253c[_0x33c47a(0x121)]&&(_0x319e8c['product_stock']=parseInt(_0x319e8c['product_stock'])+parseInt(_0x2d253c['to_quantity']),_0x931cd9++);});_0x931cd9=='0'&&(_0x5405eb[_0x54b1ca(0xeb)]=_0x5405eb['product_details'][_0x54b1ca(0xc8)]({'product_name':_0x2d253c[_0x54b1ca(0x13e)],'product_stock':_0x2d253c['to_quantity'],'bay':_0x2d253c['to_bay'],'product_code':_0x2d253c['product_code'],'primary_code':_0x2d253c[_0x54b1ca(0xda)],'secondary_code':_0x2d253c[_0x54b1ca(0x110)],'maxProducts':_0x2d253c['maxProducts']}));}}),await _0x5405eb[_0x52ec5c(0x162)](),_0x211530['flash'](_0x52ec5c(0x11a),'Transfer\x20Edit\x20Successfully'),_0x466f91['redirect'](_0x52ec5c(0x123));}catch(_0x3be208){console[_0x52ec5c(0xb9)](_0x3be208);}}),router[a0_0x228c30(0xa1)](a0_0x228c30(0x154),async(_0x308988,_0x521469)=>{var _0x9efbde=a0_0x228c30;const {FromWareHouse:_0x151bc2,FromRoom:_0x3fab6e,ToWarehouse:_0x19cd11,ToRoom:_0x1aff67,primary_code:_0x3db842,Roomslist:_0x5ca5ae}=_0x308988['body'],_0x8ac087=_0x5ca5ae[_0x9efbde(0x158)](','),_0x1b7f66=[];async function _0x2a2119(_0x522aa6){var _0x35145d=_0x9efbde;const _0xc2afc0=await warehouse[_0x35145d(0x14b)]([{'$match':{'name':_0x151bc2,'room':_0x522aa6}},{'$unwind':_0x35145d(0x12f)},{'$match':{'product_details.primary_code':_0x3db842}},{'$group':{'_id':_0x35145d(0x112),'name':{'$first':_0x35145d(0xdf)},'instock':{'$first':_0x35145d(0xf8)},'primary_code':{'$first':_0x35145d(0x150)},'secondary_code':{'$first':_0x35145d(0x141)},'product_code':{'$first':_0x35145d(0x142)},'bay':{'$first':'$product_details.bay'},'level':{'$first':_0x35145d(0xb1)},'type':{'$first':_0x35145d(0xf4)},'pallet':{'$first':_0x35145d(0xd3)},'unit':{'$first':_0x35145d(0x113)},'secondary_unit':{'$first':_0x35145d(0xa3)},'storage':{'$first':_0x35145d(0x14d)},'rack':{'$first':_0x35145d(0x13a)},'expiry_date':{'$first':_0x35145d(0x136)},'production_date':{'$first':_0x35145d(0x156)},'batch_code':{'$first':_0x35145d(0x134)},'maxPerUnit':{'$first':_0x35145d(0xa2)},'roomNamed':{'$first':_0x35145d(0x13f)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x35145d(0x133)}}}]),_0xf8de9=await warehouse[_0x35145d(0x14b)]([{'$match':{'name':_0x151bc2,'room':_0x522aa6}},{'$unwind':_0x35145d(0x12f)},{'$match':{'product_details.secondary_code':_0x3db842}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x35145d(0xdf)},'instock':{'$first':_0x35145d(0xf8)},'primary_code':{'$first':_0x35145d(0x150)},'secondary_code':{'$first':_0x35145d(0x141)},'product_code':{'$first':_0x35145d(0x142)},'bay':{'$first':_0x35145d(0xd9)},'level':{'$first':_0x35145d(0xb1)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x35145d(0xd3)},'unit':{'$first':_0x35145d(0x113)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x35145d(0x14d)},'rack':{'$first':_0x35145d(0x13a)},'expiry_date':{'$first':_0x35145d(0x136)},'production_date':{'$first':_0x35145d(0x156)},'batch_code':{'$first':_0x35145d(0x134)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x35145d(0x13f)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x35145d(0x133)}}}]);if(_0xc2afc0[_0x35145d(0xc5)]>0x0)_0x1b7f66[_0x35145d(0xe4)](_0xc2afc0);else _0xf8de9[_0x35145d(0xc5)]>0x0&&_0x1b7f66[_0x35145d(0xe4)](_0xf8de9);}const _0x8a8185=_0x8ac087[_0x9efbde(0x11d)](_0xef2be5=>_0x2a2119(_0xef2be5));await Promise[_0x9efbde(0xc0)](_0x8a8185),_0x521469['json'](_0x1b7f66);}),router['post']('/CheckingWarehouse',async(_0xd2e922,_0x400bb1)=>{var _0x4d0afe=a0_0x228c30;const {productCode:_0x21fd31,bay:_0x1f58f3,warehouses:_0x4ff8ff,room:_0x35515f}=_0xd2e922[_0x4d0afe(0xed)];console[_0x4d0afe(0xb9)](_0xd2e922[_0x4d0afe(0xed)]);try{const _0x54458e=await warehouse[_0x4d0afe(0x14b)]([{'$match':{'name':_0x4ff8ff,'room':_0x35515f}},{'$unwind':_0x4d0afe(0x12f)},{'$match':{'product_details.bay':parseInt(_0x1f58f3)}},{'$group':{'_id':_0x4d0afe(0x112),'name':{'$first':_0x4d0afe(0xdf)},'product_stock':{'$first':_0x4d0afe(0xf8)},'bay':{'$first':_0x4d0afe(0xd9)},'maxProducts':{'$first':_0x4d0afe(0xbe)}}}]);_0x400bb1['status'](0xc8)[_0x4d0afe(0x13b)](_0x54458e);}catch(_0x512c06){_0x400bb1['status'](0x194)[_0x4d0afe(0x13b)]({'message':_0x512c06['message']});}}),module[a0_0x228c30(0x107)]=router;function a0_0x4bc3(){var _0x53ec0d=['padStart','$product.from_room_name','Rack\x201','to_floorlevel','from_prod_level2','string','DRY\x20GOODS','English','/view','$product_details.level','MaxStocks_data2','add_transfer_finished','TRF-','../public/language/languages.json','updateOne','from_warehouse','filter','log','from_level','$name','$product','to_level','$product_details.maxProducts','/view/choose','all','3244472ywSUCf','find','primary_unit','flash','length','An\x20error\x20occurred.','floor','concat','message','to_quantity','Enclosed','invoice_init','Portuguese','getMonth','findById','18LQEXQZ','\x20<=>\x20','to_warehouse','$product_details.floorlevel','French','role','/preview/:id','Enabled','/view/:id','$product_details.bay','primary_code','maxProducts','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Product\x20Transfer\x20successfully','transfer_finished_logs','$product_details.product_name','product_date','to_room_name','getFullYear','New_Qty_Converted','push','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','language','/view/add_transfer_loc','get','undefined','status','product_details','errors','body','then','1448656SFzDqE','from_quantity','Hindi','_id','7AlrwzQ','$product_details.type','Portuguese\x20(BR)','params','3zqcAnl','$product_details.product_stock','2033410pzIXOV','transfer_data','TRFF-','Spanish','staff','$_id','2398482ZzKuEc','user','own','from_prod_qty','LOG-TRF-','Arabic','secondary_unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','exports','</td>','RoomAssigned','bay','maxPerUnit','to_room','edit_transfer_finished','Finished\x20Goods','bin2bin','secondary_code','abs','$product_details._id','$product_details.unit','MaxStocks_data','$date','here2','edit_transfer_finished_view','712288jjDfKY','from_invoice','success','from_prod_level','logs','map','date','catch','to_prod_level','to_bay','invoice','/transfer_finished/view','expiry_date','/view/addlog','from_room_name','id_transaction','German','FROZEN\x20GOODS','location2location','Ambient','nodemailer','/transfer_finished/preview/','unit','$product_details','ToRoomAssigned','/transfer/view','English\x20(US)','$product_details.invoice','$product_details.batch_code','from_room','$product_details.expiry_date','3316752UGlCTW','Chinese','Arabic\x20(ae)','$product_details.rack','json','prod_cat','prod_name','product_name','$room','email','$product_details.secondary_code','$product_details.product_code','$product_details.bin','findOne','To_invoice','product_code','</tr>','<tr>','error','$to_warehouse','aggregate','slice','$product_details.storage','$from_warehouse','production_date','$product_details.primary_code','forEach','finalize','Rack\x202','/barcode_scanner','$finalize','$product_details.production_date','render','split','/view/add_transfer','warehouse','product_code3','$product.to_room_name','match','choos_transfer','toString','batch_code','1018935sksZCq','save','from_bay','redirect','back','post','$product_details.maxPerUnit','$product_details.secondary_unit','product_stock','type_of_process','$invoice','product'];a0_0x4bc3=function(){return _0x53ec0d;};return a0_0x4bc3();}