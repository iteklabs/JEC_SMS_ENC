var a0_0x90adfa=a0_0x4dd9;(function(_0xf7a234,_0x3bf82c){var _0x3b9db7=a0_0x4dd9,_0x1db0d3=_0xf7a234();while(!![]){try{var _0x5eec74=parseInt(_0x3b9db7(0xcc))/0x1+-parseInt(_0x3b9db7(0xd0))/0x2*(-parseInt(_0x3b9db7(0x12f))/0x3)+-parseInt(_0x3b9db7(0x123))/0x4+-parseInt(_0x3b9db7(0xc7))/0x5*(-parseInt(_0x3b9db7(0x131))/0x6)+-parseInt(_0x3b9db7(0x139))/0x7*(-parseInt(_0x3b9db7(0x125))/0x8)+-parseInt(_0x3b9db7(0xbb))/0x9+-parseInt(_0x3b9db7(0x10e))/0xa;if(_0x5eec74===_0x3bf82c)break;else _0x1db0d3['push'](_0x1db0d3['shift']());}catch(_0x5ba4fd){_0x1db0d3['push'](_0x1db0d3['shift']());}}}(a0_0x3ef8,0x99915));const express=require(a0_0x90adfa(0x102)),app=express(),router=express[a0_0x90adfa(0x164)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x90adfa(0xc6)),auth=require(a0_0x90adfa(0x110)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router['get'](a0_0x90adfa(0xc9),auth,async(_0x50f493,_0x47947c)=>{var _0x23618d=a0_0x90adfa;try{const {username:_0x57d688,email:_0x2fa899,role:_0x141c40}=_0x50f493[_0x23618d(0xec)],_0x10d090=_0x50f493[_0x23618d(0xec)],_0x1fb13b=await profile[_0x23618d(0x101)]({'email':_0x10d090[_0x23618d(0x106)]}),_0x5f31c0=await master_shop[_0x23618d(0x158)]();let _0x140764;if(_0x10d090[_0x23618d(0x16c)]==_0x23618d(0x159)){const _0x387e2f=await staff['findOne']({'email':_0x10d090[_0x23618d(0x106)]});_0x140764=await transfers_finished['find']({'from_warehouse':_0x387e2f[_0x23618d(0xf9)]});}else _0x140764=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x23618d(0x121)}},{'$unwind':_0x23618d(0xb8)},{'$group':{'_id':'$_id','invoice':{'$first':_0x23618d(0xf3)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x23618d(0xd7)},'to_warehouse':{'$first':_0x23618d(0xdc)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x23618d(0x162)},'finalize':{'$first':_0x23618d(0x166)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x5f31c0[0x0]['language']=='English\x20(US)')var _0xe55a9e=users['English'];else{if(_0x5f31c0[0x0][_0x23618d(0xcb)]==_0x23618d(0x145))var _0xe55a9e=users[_0x23618d(0x145)];else{if(_0x5f31c0[0x0]['language']=='German')var _0xe55a9e=users[_0x23618d(0x149)];else{if(_0x5f31c0[0x0][_0x23618d(0xcb)]==_0x23618d(0x171))var _0xe55a9e=users['Spanish'];else{if(_0x5f31c0[0x0][_0x23618d(0xcb)]==_0x23618d(0xf5))var _0xe55a9e=users[_0x23618d(0xf5)];else{if(_0x5f31c0[0x0][_0x23618d(0xcb)]==_0x23618d(0xfc))var _0xe55a9e=users['Portuguese'];else{if(_0x5f31c0[0x0][_0x23618d(0xcb)]==_0x23618d(0x14d))var _0xe55a9e=users[_0x23618d(0x14d)];else{if(_0x5f31c0[0x0]['language']==_0x23618d(0x140))var _0xe55a9e=users['Arabic'];}}}}}}}_0x47947c['render']('transfer_finished',{'success':_0x50f493[_0x23618d(0x153)]('success'),'errors':_0x50f493[_0x23618d(0x153)](_0x23618d(0x14b)),'role':_0x10d090,'profile':_0x1fb13b,'master_shop':_0x5f31c0,'transfer':_0x140764,'language':_0xe55a9e});}catch(_0x1f4118){console[_0x23618d(0x137)](_0x1f4118);}}),router[a0_0x90adfa(0xf4)](a0_0x90adfa(0xf7),auth,async(_0x1b59ce,_0x226578)=>{var _0x1a1679=a0_0x90adfa;try{const {username:_0x5446d6,email:_0x430783,role:_0x3b8144}=_0x1b59ce[_0x1a1679(0xec)],_0x246aed=_0x1b59ce['user'],_0x5d326e=await profile[_0x1a1679(0x101)]({'email':_0x246aed[_0x1a1679(0x106)]}),_0x30d414=await master_shop[_0x1a1679(0x158)]();let _0x5445dd;if(_0x246aed['role']==_0x1a1679(0x159)){const _0x36e183=await staff[_0x1a1679(0x101)]({'email':_0x246aed['email']});_0x5445dd=await transfers_finished[_0x1a1679(0x158)]({'from_warehouse':_0x36e183['warehouse']});}else _0x5445dd=await transfers_finished[_0x1a1679(0x126)]([{'$match':{'type_of_transaction':_0x1a1679(0xcd)}},{'$unwind':'$product'},{'$group':{'_id':_0x1a1679(0xfe),'invoice':{'$first':_0x1a1679(0xf3)},'date':{'$first':_0x1a1679(0x136)},'from_warehouse':{'$first':_0x1a1679(0xd7)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x1a1679(0xbe)},'to_room_name':{'$addToSet':_0x1a1679(0x162)},'finalize':{'$first':_0x1a1679(0x166)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x30d414[0x0]['language']==_0x1a1679(0x175))var _0x1af262=users[_0x1a1679(0xc5)];else{if(_0x30d414[0x0]['language']==_0x1a1679(0x145))var _0x1af262=users[_0x1a1679(0x145)];else{if(_0x30d414[0x0][_0x1a1679(0xcb)]==_0x1a1679(0x149))var _0x1af262=users['German'];else{if(_0x30d414[0x0][_0x1a1679(0xcb)]==_0x1a1679(0x171))var _0x1af262=users['Spanish'];else{if(_0x30d414[0x0]['language']=='French')var _0x1af262=users['French'];else{if(_0x30d414[0x0]['language']==_0x1a1679(0xfc))var _0x1af262=users['Portuguese'];else{if(_0x30d414[0x0][_0x1a1679(0xcb)]=='Chinese')var _0x1af262=users[_0x1a1679(0x14d)];else{if(_0x30d414[0x0][_0x1a1679(0xcb)]==_0x1a1679(0x140))var _0x1af262=users[_0x1a1679(0xef)];}}}}}}}_0x226578['render'](_0x1a1679(0xb6),{'success':_0x1b59ce[_0x1a1679(0x153)](_0x1a1679(0xff)),'errors':_0x1b59ce['flash'](_0x1a1679(0x14b)),'role':_0x246aed,'profile':_0x5d326e,'master_shop':_0x30d414,'transfer':_0x5445dd,'language':_0x1af262});}catch(_0xc6feaa){console[_0x1a1679(0x137)](_0xc6feaa);}});function a0_0x4dd9(_0x5b0bbd,_0xd76ea3){var _0x3ef81f=a0_0x3ef8();return a0_0x4dd9=function(_0x4dd915,_0x231fce){_0x4dd915=_0x4dd915-0xaf;var _0x5af9fa=_0x3ef81f[_0x4dd915];return _0x5af9fa;},a0_0x4dd9(_0x5b0bbd,_0xd76ea3);}async function getRandom8DigitNumber(){var _0x23e71c=a0_0x90adfa;const _0xbe08aa=0x989680,_0x494cab=0x5f5e0ff,_0x569bdb=Math[_0x23e71c(0x13f)](Math['random']()*(_0x494cab-_0xbe08aa+0x1))+_0xbe08aa;var _0x1765a8;const _0x38ac0f=await transfers_finished[_0x23e71c(0x101)]({'invoice':_0x23e71c(0x132)+_0x569bdb});return _0x38ac0f&&_0x38ac0f['length']>0x0?_0x1765a8=_0x23e71c(0x132)+_0x569bdb:_0x1765a8=_0x23e71c(0x132)+_0x569bdb,_0x1765a8;}router[a0_0x90adfa(0xf4)](a0_0x90adfa(0xe1),auth,async(_0x5c888e,_0x4d6ce1)=>{var _0x380bba=a0_0x90adfa;try{const {username:_0x5957fa,email:_0x1b0ca9,role:_0x18e37c}=_0x5c888e['user'],_0x5a854e=_0x5c888e[_0x380bba(0xec)],_0xdee723=await profile[_0x380bba(0x101)]({'email':_0x5a854e['email']}),_0x596bd3=await master_shop[_0x380bba(0x158)]();let _0x3dc8f6;if(_0x5a854e[_0x380bba(0x16c)]==_0x380bba(0x159)){const _0x3a27c8=await staff['findOne']({'email':_0x5a854e[_0x380bba(0x106)]});_0x3dc8f6=await warehouse[_0x380bba(0x126)]([{'$match':{'status':'Enabled','name':_0x3a27c8[_0x380bba(0xf9)]}},{'$group':{'_id':_0x380bba(0xed),'name':{'$first':_0x380bba(0xed)}}}]);}else _0x3dc8f6=await warehouse[_0x380bba(0x126)]([{'$match':{'status':_0x380bba(0x14c)}},{'$group':{'_id':_0x380bba(0xed),'name':{'$first':_0x380bba(0xed)}}}]);const _0x3f52e9=await transfers_finished['find']({}),_0x1c796b=_0x3f52e9[_0x380bba(0x124)]+0x1,_0xccf941=_0x380bba(0x132)+_0x1c796b[_0x380bba(0x116)]()['padStart'](0x5,'0');if(_0x596bd3[0x0][_0x380bba(0xcb)]=='English\x20(US)')var _0x4b5d84=users[_0x380bba(0xc5)];else{if(_0x596bd3[0x0][_0x380bba(0xcb)]==_0x380bba(0x145))var _0x4b5d84=users[_0x380bba(0x145)];else{if(_0x596bd3[0x0]['language']==_0x380bba(0x149))var _0x4b5d84=users[_0x380bba(0x149)];else{if(_0x596bd3[0x0][_0x380bba(0xcb)]==_0x380bba(0x171))var _0x4b5d84=users[_0x380bba(0x171)];else{if(_0x596bd3[0x0]['language']=='French')var _0x4b5d84=users['French'];else{if(_0x596bd3[0x0]['language']==_0x380bba(0xfc))var _0x4b5d84=users[_0x380bba(0x176)];else{if(_0x596bd3[0x0][_0x380bba(0xcb)]==_0x380bba(0x14d))var _0x4b5d84=users[_0x380bba(0x14d)];else{if(_0x596bd3[0x0][_0x380bba(0xcb)]==_0x380bba(0x140))var _0x4b5d84=users[_0x380bba(0xef)];}}}}}}}const _0x1d5e41=getRandom8DigitNumber();_0x1d5e41[_0x380bba(0xbf)](_0x32efc9=>{var _0x8e2e3=_0x380bba;_0x4d6ce1[_0x8e2e3(0xda)](_0x8e2e3(0x179),{'success':_0x5c888e[_0x8e2e3(0x153)](_0x8e2e3(0xff)),'errors':_0x5c888e[_0x8e2e3(0x153)](_0x8e2e3(0x14b)),'role':_0x5a854e,'profile':_0xdee723,'master_shop':_0x596bd3,'warehouse':_0x3dc8f6,'language':_0x4b5d84,'invoice':_0x32efc9});})['catch'](_0x4f56b4=>{var _0x47a7ea=_0x380bba;_0x5c888e[_0x47a7ea(0x153)](_0x47a7ea(0x14b),_0x47a7ea(0x104)),_0x4d6ce1[_0x47a7ea(0x103)](_0x47a7ea(0xe7));});}catch(_0x42afcc){console[_0x380bba(0x137)](_0x42afcc);}}),router['get']('/view/choose',auth,async(_0x26a20d,_0x1a9db8)=>{var _0x43a506=a0_0x90adfa;try{const {username:_0x10ebce,email:_0x17ff8c,role:_0x2c3860}=_0x26a20d[_0x43a506(0xec)],_0xe16890=_0x26a20d[_0x43a506(0xec)],_0x651488=await profile[_0x43a506(0x101)]({'email':_0xe16890[_0x43a506(0x106)]}),_0x3d4732=await master_shop[_0x43a506(0x158)]();let _0x519d1f;if(_0xe16890[_0x43a506(0x16c)]==_0x43a506(0x159)){const _0x51c1d3=await staff[_0x43a506(0x101)]({'email':_0xe16890['email']});_0x519d1f=await warehouse[_0x43a506(0x126)]([{'$match':{'status':_0x43a506(0x14c),'name':_0x51c1d3[_0x43a506(0xf9)]}},{'$group':{'_id':'$name','name':{'$first':_0x43a506(0xed)}}}]);}else _0x519d1f=await warehouse[_0x43a506(0x126)]([{'$match':{'status':_0x43a506(0x14c)}},{'$group':{'_id':_0x43a506(0xed),'name':{'$first':_0x43a506(0xed)}}}]);const _0x4b2773=await transfers_finished[_0x43a506(0x158)]({}),_0x4f3a17=_0x4b2773[_0x43a506(0x124)]+0x1,_0x40de6c=_0x43a506(0x132)+_0x4f3a17[_0x43a506(0x116)]()[_0x43a506(0xea)](0x5,'0');if(_0x3d4732[0x0]['language']==_0x43a506(0x175))var _0x3ac2c5=users[_0x43a506(0xc5)];else{if(_0x3d4732[0x0][_0x43a506(0xcb)]==_0x43a506(0x145))var _0x3ac2c5=users[_0x43a506(0x145)];else{if(_0x3d4732[0x0][_0x43a506(0xcb)]==_0x43a506(0x149))var _0x3ac2c5=users[_0x43a506(0x149)];else{if(_0x3d4732[0x0][_0x43a506(0xcb)]==_0x43a506(0x171))var _0x3ac2c5=users['Spanish'];else{if(_0x3d4732[0x0][_0x43a506(0xcb)]=='French')var _0x3ac2c5=users[_0x43a506(0xf5)];else{if(_0x3d4732[0x0][_0x43a506(0xcb)]==_0x43a506(0xfc))var _0x3ac2c5=users['Portuguese'];else{if(_0x3d4732[0x0][_0x43a506(0xcb)]==_0x43a506(0x14d))var _0x3ac2c5=users[_0x43a506(0x14d)];else{if(_0x3d4732[0x0][_0x43a506(0xcb)]=='Arabic\x20(ae)')var _0x3ac2c5=users[_0x43a506(0xef)];}}}}}}}const _0x24c914=getRandom8DigitNumber();_0x24c914[_0x43a506(0xbf)](_0x5aad6a=>{var _0x5d6caf=_0x43a506;_0x1a9db8[_0x5d6caf(0xda)](_0x5d6caf(0x156),{'success':_0x26a20d['flash'](_0x5d6caf(0xff)),'errors':_0x26a20d['flash'](_0x5d6caf(0x14b)),'role':_0xe16890,'profile':_0x651488,'master_shop':_0x3d4732,'warehouse':_0x519d1f,'language':_0x3ac2c5,'invoice':_0x5aad6a});})[_0x43a506(0x13e)](_0x2fc00f=>{var _0x247754=_0x43a506;_0x26a20d['flash'](_0x247754(0x14b),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1a9db8['redirect'](_0x247754(0xe7));});}catch(_0x1eb115){console['log'](_0x1eb115);}}),router[a0_0x90adfa(0xf4)]('/view/choose_logs',auth,async(_0x178e5c,_0x350eb4)=>{var _0x29c789=a0_0x90adfa;try{const {username:_0x467528,email:_0x2e7c1d,role:_0x4409db}=_0x178e5c[_0x29c789(0xec)],_0x2d9340=_0x178e5c[_0x29c789(0xec)],_0x5358b2=await profile[_0x29c789(0x101)]({'email':_0x2d9340['email']}),_0x37bce5=await master_shop['find']();let _0x3cb67a;if(_0x2d9340[_0x29c789(0x16c)]==_0x29c789(0x159)){const _0x38ae5a=await staff[_0x29c789(0x101)]({'email':_0x2d9340[_0x29c789(0x106)]});_0x3cb67a=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x38ae5a[_0x29c789(0xf9)]}},{'$group':{'_id':_0x29c789(0xed),'name':{'$first':_0x29c789(0xed)}}}]);}else _0x3cb67a=await warehouse['aggregate']([{'$match':{'status':_0x29c789(0x14c)}},{'$group':{'_id':'$name','name':{'$first':_0x29c789(0xed)}}}]);const _0x5e769a=await transfers_finished['find']({}),_0x1f6f3f=_0x5e769a['length']+0x1,_0x2efc8e=_0x29c789(0x132)+_0x1f6f3f['toString']()[_0x29c789(0xea)](0x5,'0');if(_0x37bce5[0x0][_0x29c789(0xcb)]==_0x29c789(0x175))var _0x1f5ca1=users[_0x29c789(0xc5)];else{if(_0x37bce5[0x0]['language']==_0x29c789(0x145))var _0x1f5ca1=users['Hindi'];else{if(_0x37bce5[0x0][_0x29c789(0xcb)]==_0x29c789(0x149))var _0x1f5ca1=users[_0x29c789(0x149)];else{if(_0x37bce5[0x0]['language']=='Spanish')var _0x1f5ca1=users['Spanish'];else{if(_0x37bce5[0x0][_0x29c789(0xcb)]==_0x29c789(0xf5))var _0x1f5ca1=users[_0x29c789(0xf5)];else{if(_0x37bce5[0x0][_0x29c789(0xcb)]=='Portuguese\x20(BR)')var _0x1f5ca1=users[_0x29c789(0x176)];else{if(_0x37bce5[0x0][_0x29c789(0xcb)]==_0x29c789(0x14d))var _0x1f5ca1=users[_0x29c789(0x14d)];else{if(_0x37bce5[0x0][_0x29c789(0xcb)]==_0x29c789(0x140))var _0x1f5ca1=users[_0x29c789(0xef)];}}}}}}}const _0x183c52=getRandom8DigitNumber();_0x183c52[_0x29c789(0xbf)](_0xec6b61=>{var _0x1bcd66=_0x29c789;_0x350eb4[_0x1bcd66(0xda)](_0x1bcd66(0xcf),{'success':_0x178e5c[_0x1bcd66(0x153)]('success'),'errors':_0x178e5c[_0x1bcd66(0x153)](_0x1bcd66(0x14b)),'role':_0x2d9340,'profile':_0x5358b2,'master_shop':_0x37bce5,'warehouse':_0x3cb67a,'language':_0x1f5ca1,'invoice':_0xec6b61});})[_0x29c789(0x13e)](_0x4f005b=>{var _0x4b98eb=_0x29c789;_0x178e5c[_0x4b98eb(0x153)]('errors',_0x4b98eb(0x104)),_0x350eb4[_0x4b98eb(0x103)]('/transfer/view');});}catch(_0x4a04d6){console[_0x29c789(0x137)](_0x4a04d6);}}),router[a0_0x90adfa(0x15a)]('/view/add_transfer_logs',auth,async(_0x5c78ed,_0x2e5b06)=>{var _0xb6c805=a0_0x90adfa;try{const {date:_0xbd9fe9,from_warehouse:_0x591164,FromRoom_name:_0x527d31,to_warehouse:_0x4a413d,ToRoom_name:_0x1639d1,prod_name:_0x3054dd,from_prod_qty:_0x51d73c,from_prod_level:_0x2d6a3f,from_prod_isle:_0x2c6c6c,from_prod_pallet:_0x38ccc4,to_prod_qty:_0x4339b6,to_prod_level:_0x5c8a93,to_prod_isle:_0x188271,to_prod_pallet:_0xa867e4,primary_code:_0x45655f,secondary_code:_0x4b5eea,product_code3:_0x2216cb,note:_0x40e479,MaxStocks_data2:_0x4fba03,invoice:_0x355c47,expiry_date:_0x483261,PO_number:_0xc3131c,ReqBy:_0xd4429e,dateofreq:_0x49c721,typeservicesData:_0x17b04e,destination:_0x491189,deliverydate:_0x437200,driver:_0x50e3a7,plate:_0x4044f3,van:_0x4bb2ea,DRSI:_0x11126d,typevehicle:_0x11fab4,TSU:_0x333a08,TFU:_0x4dc80e}=_0x5c78ed[_0xb6c805(0x118)];if(typeof _0x3054dd==_0xb6c805(0xb1))var _0x473869=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x12c)]],_0xd4f834=[_0x5c78ed['body'][_0xb6c805(0x169)]],_0x551ec6=[_0x5c78ed['body'][_0xb6c805(0x127)]],_0x34f9d8=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x172)]],_0x4063a8=[_0x5c78ed['body']['to_prod_level']],_0x4b8706=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xbc)]],_0x265c4f=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x167)]],_0x4000f5=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x10d)]],_0x479210=[_0x5c78ed['body']['MaxStocks_data2']],_0x318732=[_0x5c78ed['body'][_0xb6c805(0xbd)]],_0x34166e=[_0x5c78ed['body'][_0xb6c805(0xb7)]],_0x1aa3cb=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xe5)]],_0x57c4f1=[_0x5c78ed[_0xb6c805(0x118)]['expiry_date']],_0x33d790=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xde)]],_0x127222=[_0x5c78ed[_0xb6c805(0x118)]['MaxStocks_data']],_0x323e06=[_0x5c78ed['body'][_0xb6c805(0xe8)]],_0x1e3ce7=[_0x5c78ed['body']['prod_cat']],_0x1b7fbc=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xee)]],_0x390f72=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x178)]],_0x32495c=[_0x5c78ed['body']['from_invoice']],_0x3dd755=[_0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x15f)]];else var _0x473869=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x12c)]],_0xd4f834=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x169)]],_0x551ec6=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x127)]],_0x34f9d8=[..._0x5c78ed['body']['New_Qty_Converted']],_0x4063a8=[..._0x5c78ed[_0xb6c805(0x118)]['to_prod_level']],_0x4b8706=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xbc)]],_0x265c4f=[..._0x5c78ed[_0xb6c805(0x118)]['secondary_code']],_0x4000f5=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x10d)]],_0x479210=[..._0x5c78ed[_0xb6c805(0x118)]['MaxStocks_data2']],_0x318732=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xbd)]],_0x34166e=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xb7)]],_0x1aa3cb=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xe5)]],_0x57c4f1=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x13b)]],_0x33d790=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xde)]],_0x127222=[..._0x5c78ed['body'][_0xb6c805(0x151)]],_0x323e06=[..._0x5c78ed[_0xb6c805(0x118)]['maxPerUnit']],_0x1e3ce7=[..._0x5c78ed['body'][_0xb6c805(0x11c)]],_0x1b7fbc=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0xee)]],_0x390f72=[..._0x5c78ed[_0xb6c805(0x118)][_0xb6c805(0x178)]],_0x32495c=[..._0x5c78ed[_0xb6c805(0x118)]['from_invoice']],_0x3dd755=[..._0x5c78ed[_0xb6c805(0x118)]['id_transaction']];const _0x563cdc=_0x473869[_0xb6c805(0x13a)](_0x3cda13=>{return _0x3cda13={'product_name':_0x3cda13};});_0xd4f834['forEach']((_0x484d3a,_0x4b4308)=>{var _0x33ce37=_0xb6c805;_0x563cdc[_0x4b4308][_0x33ce37(0xaf)]=_0x484d3a;}),_0x551ec6[_0xb6c805(0xd4)]((_0x42a9e4,_0x2b7539)=>{var _0x3551e3=_0xb6c805,_0x175124=_0x42a9e4[_0x3551e3(0xd9)](/[A-Za-z]+/)[0x0],_0x40c10a=parseInt(_0x42a9e4[_0x3551e3(0xd9)](/\d+/)[0x0]);_0x563cdc[_0x2b7539][_0x3551e3(0xeb)]=_0x40c10a,_0x563cdc[_0x2b7539]['from_level']=_0x175124;}),_0x3dd755[_0xb6c805(0xd4)]((_0x260024,_0xf1275)=>{var _0x4b2b27=_0xb6c805;_0x563cdc[_0xf1275][_0x4b2b27(0x15f)]=_0x260024;}),_0x32495c[_0xb6c805(0xd4)]((_0x573805,_0x6b5a50)=>{var _0x16ad8b=_0xb6c805;_0x563cdc[_0x6b5a50][_0x16ad8b(0x114)]=_0x573805;}),_0x34f9d8['forEach']((_0x4beeb6,_0x6049a4)=>{var _0x5e7bd3=_0xb6c805;_0x563cdc[_0x6049a4][_0x5e7bd3(0x14f)]=_0x4beeb6;}),_0x4063a8[_0xb6c805(0xd4)]((_0x5808d0,_0x9551c6)=>{var _0x120157=_0xb6c805,_0x344f5d=_0x5808d0[_0x120157(0xd9)](/[A-Za-z]+/)[0x0],_0x39121d=parseInt(_0x5808d0[_0x120157(0xd9)](/\d+/)[0x0]);_0x563cdc[_0x9551c6][_0x120157(0x117)]=_0x344f5d,_0x563cdc[_0x9551c6]['to_bay']=_0x39121d;}),_0x4b8706[_0xb6c805(0xd4)]((_0xfbbbd,_0x1e940a)=>{var _0x4dd040=_0xb6c805;_0x563cdc[_0x1e940a][_0x4dd040(0xbc)]=_0xfbbbd;}),_0x265c4f[_0xb6c805(0xd4)]((_0xbc68c0,_0x368714)=>{var _0x55283b=_0xb6c805;_0x563cdc[_0x368714][_0x55283b(0x167)]=_0xbc68c0;}),_0x4000f5[_0xb6c805(0xd4)]((_0x8b67c9,_0x1c4b1e)=>{_0x563cdc[_0x1c4b1e]['product_code']=_0x8b67c9;}),_0x479210['forEach']((_0xf10824,_0x19cd11)=>{var _0x5f2e9d=_0xb6c805;_0x563cdc[_0x19cd11][_0x5f2e9d(0x115)]=_0xf10824;}),_0x318732['forEach']((_0x9e0752,_0x566fe4)=>{var _0x299b37=_0xb6c805;_0x563cdc[_0x566fe4][_0x299b37(0x16d)]=_0x9e0752;}),_0x34166e['forEach']((_0x4e227d,_0x44a423)=>{var _0x31196f=_0xb6c805;_0x563cdc[_0x44a423][_0x31196f(0xb7)]=_0x4e227d;}),_0x1aa3cb[_0xb6c805(0xd4)]((_0x198394,_0x224322)=>{_0x563cdc[_0x224322]['batch_code']=_0x198394;}),_0x57c4f1['forEach']((_0x4c1dbb,_0x41918f)=>{_0x563cdc[_0x41918f]['expiry_date']=_0x4c1dbb;}),_0x33d790[_0xb6c805(0xd4)]((_0xbbc9ca,_0x284a6d)=>{var _0x380da7=_0xb6c805;_0x563cdc[_0x284a6d][_0x380da7(0xc3)]=_0xbbc9ca;}),_0x127222[_0xb6c805(0xd4)]((_0x417508,_0x2ccf75)=>{var _0x163bc5=_0xb6c805;_0x563cdc[_0x2ccf75][_0x163bc5(0x115)]=_0x417508;}),_0x323e06[_0xb6c805(0xd4)]((_0x101ded,_0x32a403)=>{_0x563cdc[_0x32a403]['maxPerUnit']=_0x101ded;}),_0x1e3ce7[_0xb6c805(0xd4)]((_0x8d9039,_0x452989)=>{var _0x40b838=_0xb6c805;_0x563cdc[_0x452989][_0x40b838(0x11c)]=_0x8d9039;}),_0x1b7fbc[_0xb6c805(0xd4)]((_0x338a65,_0x24837e)=>{var _0x549196=_0xb6c805;_0x563cdc[_0x24837e][_0x549196(0x112)]=_0x338a65;}),_0x390f72['forEach']((_0x4c077a,_0x9494a1)=>{var _0x2912a5=_0xb6c805;_0x563cdc[_0x9494a1][_0x2912a5(0xe9)]=_0x4c077a;});const _0x276fd4=_0x563cdc['filter'](_0x52f23d=>_0x52f23d[_0xb6c805(0x14f)]!=='0'&&_0x52f23d[_0xb6c805(0x14f)]!==''||_0x52f23d[_0xb6c805(0xb2)]!=='0'&&_0x52f23d[_0xb6c805(0xb2)]!=='');var _0x5642e4=0x0;_0x276fd4[_0xb6c805(0xd4)](_0x4e7265=>{var _0x2b25a4=_0xb6c805;parseInt(_0x4e7265['from_quantity'])<parseInt(_0x4e7265[_0x2b25a4(0x14f)])&&_0x5642e4++;});if(_0x5642e4!=0x0)return _0x5c78ed[_0xb6c805(0x153)](_0xb6c805(0x14b),_0xb6c805(0x138)),_0x2e5b06['redirect'](_0xb6c805(0xfb));const _0x5a4be3=new transfers_logs();await _0x5a4be3[_0xb6c805(0x157)]();for(let _0x865b02=0x0;_0x865b02<=_0x390f72[_0xb6c805(0x124)]-0x1;_0x865b02++){_0x563cdc[_0x865b02][_0xb6c805(0x11b)]=_0xb6c805(0x14e)+_0x5a4be3['invoice_init'][_0xb6c805(0x116)]()['padStart'](0x8,'0');}const _0x5bae22=new transfers_finished({'date':_0xbd9fe9,'from_warehouse':_0x591164,'to_warehouse':_0x591164,'product':_0x276fd4,'note':_0x40e479,'invoice':_0xb6c805(0x14e)+_0x5a4be3['invoice_init'][_0xb6c805(0x116)]()[_0xb6c805(0xea)](0x8,'0'),'type_of_process':_0xb6c805(0x113),'type_of_transaction':_0xb6c805(0xcd),'PO_number':_0xc3131c,'RequestedBy':_0xd4429e,'DateofRequest':_0x49c721,'typeservices':_0x17b04e,'destination':_0x491189,'deliverydate':_0x437200,'driver':_0x50e3a7,'plate':_0x4044f3,'van':_0x4bb2ea,'DRSI':_0x11126d,'typevehicle':_0x11fab4,'TSU':_0x333a08,'TFU':_0x4dc80e}),_0x2c0886=await _0x5bae22['save']();_0x5c78ed[_0xb6c805(0x153)](_0xb6c805(0xff),_0xb6c805(0x160)),_0x2e5b06[_0xb6c805(0x103)](_0xb6c805(0x122)+_0x2c0886[_0xb6c805(0x174)]);}catch(_0x3fdc11){console[_0xb6c805(0x137)](_0x3fdc11),_0x2e5b06[_0xb6c805(0x143)](0xc8)[_0xb6c805(0xd6)]({'errorMessage':_0x3fdc11[_0xb6c805(0x148)]});}}),router[a0_0x90adfa(0x15a)](a0_0x90adfa(0x142),auth,async(_0x4b44e4,_0x2e9747)=>{var _0x29d5fa=a0_0x90adfa;try{const {date:_0x251ae8,from_warehouse:_0x184620,FromRoom_name:_0x177327,to_warehouse:_0x1d91d8,ToRoom_name:_0x44c00c,prod_name:_0x53186e,from_prod_qty:_0x1d2efd,from_prod_level:_0x48c5a1,from_prod_isle:_0x37d792,from_prod_pallet:_0x127e44,to_prod_qty:_0x368ad4,to_prod_level:_0x3a6799,to_prod_isle:_0x5f0482,to_prod_pallet:_0xd64f69,primary_code:_0x4b953a,secondary_code:_0x40f5e2,product_code3:_0x16ea66,note:_0x1b9cc2,MaxStocks_data2:_0x2c5b7b,invoice:_0x4d5a13,expiry_date:_0x3a0104,PO_number_loc:_0x294d4e,ReqBy_loc:_0x94877b,dateofreq_loc:_0x39f529,typeservices_loc_Data:_0x10dc94,destination_loc:_0x2617bd,deliverydate_loc:_0x2bb088,driver_loc:_0x40b4e5,plate_loc:_0x387c58,van_loc:_0x3e428e,DRSI_loc:_0x29ce94,typevehicle_loc:_0x39d2e7,TSU_loc:_0x42b117,TFU_loc:_0x7a5645}=_0x4b44e4[_0x29d5fa(0x118)];if(typeof _0x53186e==_0x29d5fa(0xb1))var _0x1695cc=[_0x4b44e4[_0x29d5fa(0x118)]['prod_name']],_0x2d75ff=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x169)]],_0x2828be=[_0x4b44e4[_0x29d5fa(0x118)]['from_prod_level2']],_0x48bcf2=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x172)]],_0x1a4a4d=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x168)]],_0x55f56e=[_0x4b44e4['body']['primary_code']],_0x4f9a4d=[_0x4b44e4[_0x29d5fa(0x118)]['secondary_code']],_0x24bc36=[_0x4b44e4['body'][_0x29d5fa(0x10d)]],_0x1ce1c8=[_0x4b44e4['body']['MaxStocks_data2']],_0x4d473a=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xbd)]],_0x2bb5ba=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xb7)]],_0x32753b=[_0x4b44e4['body']['batch_code']],_0x1b0f7b=[_0x4b44e4['body'][_0x29d5fa(0x13b)]],_0xb9f0c=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xde)]],_0x392a4a=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x151)]],_0xe70eca=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xe8)]],_0x1d07fe=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x11c)]],_0x11087c=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xee)]],_0x4dc4b2=[_0x4b44e4['body'][_0x29d5fa(0x178)]],_0x384c36=[_0x4b44e4[_0x29d5fa(0x118)]['from_invoice']],_0x204592=[_0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x15f)]];else var _0x1695cc=[..._0x4b44e4['body'][_0x29d5fa(0x12c)]],_0x2d75ff=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x169)]],_0x2828be=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x127)]],_0x48bcf2=[..._0x4b44e4['body']['New_Qty_Converted']],_0x1a4a4d=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x168)]],_0x55f56e=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xbc)]],_0x4f9a4d=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x167)]],_0x24bc36=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x10d)]],_0x1ce1c8=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x15e)]],_0x4d473a=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xbd)]],_0x2bb5ba=[..._0x4b44e4['body'][_0x29d5fa(0xb7)]],_0x32753b=[..._0x4b44e4[_0x29d5fa(0x118)]['batch_code']],_0x1b0f7b=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x13b)]],_0xb9f0c=[..._0x4b44e4[_0x29d5fa(0x118)]['product_date']],_0x392a4a=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x151)]],_0xe70eca=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xe8)]],_0x1d07fe=[..._0x4b44e4['body'][_0x29d5fa(0x11c)]],_0x11087c=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0xee)]],_0x4dc4b2=[..._0x4b44e4['body'][_0x29d5fa(0x178)]],_0x384c36=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x114)]],_0x204592=[..._0x4b44e4[_0x29d5fa(0x118)][_0x29d5fa(0x15f)]];const _0x180967=_0x1695cc['map'](_0x2b89c6=>{return _0x2b89c6={'product_name':_0x2b89c6};});_0x2d75ff[_0x29d5fa(0xd4)]((_0x4bb136,_0x3ed343)=>{var _0x257e0e=_0x29d5fa;_0x180967[_0x3ed343][_0x257e0e(0xaf)]=_0x4bb136;}),_0x2828be[_0x29d5fa(0xd4)]((_0x21400e,_0x31a37c)=>{var _0x1f5c3b=_0x29d5fa,_0x44928e=_0x21400e[_0x1f5c3b(0xd9)](/[A-Za-z]+/)[0x0],_0x5f4bbe=parseInt(_0x21400e[_0x1f5c3b(0xd9)](/\d+/)[0x0]);_0x180967[_0x31a37c][_0x1f5c3b(0xeb)]=_0x5f4bbe,_0x180967[_0x31a37c][_0x1f5c3b(0x155)]=_0x44928e;}),_0x204592[_0x29d5fa(0xd4)]((_0x579517,_0x1f4174)=>{_0x180967[_0x1f4174]['id_transaction']=_0x579517;}),_0x384c36[_0x29d5fa(0xd4)]((_0x4909c1,_0x1afd7c)=>{var _0x2c8288=_0x29d5fa;_0x180967[_0x1afd7c][_0x2c8288(0x114)]=_0x4909c1;}),_0x48bcf2[_0x29d5fa(0xd4)]((_0x702d4d,_0x121aa0)=>{var _0x4fe42c=_0x29d5fa;_0x180967[_0x121aa0][_0x4fe42c(0x14f)]=_0x702d4d;}),_0x1a4a4d[_0x29d5fa(0xd4)]((_0xc5b7c4,_0x1b8dce)=>{var _0xef272f=_0x29d5fa,_0x167229=_0xc5b7c4[_0xef272f(0xd9)](/[A-Za-z]+/)[0x0],_0x2a912f=parseInt(_0xc5b7c4[_0xef272f(0xd9)](/\d+/)[0x0]);_0x180967[_0x1b8dce][_0xef272f(0x117)]=_0x167229,_0x180967[_0x1b8dce][_0xef272f(0x12d)]=_0x2a912f;}),_0x55f56e['forEach']((_0x3cf912,_0x433147)=>{var _0x168807=_0x29d5fa;_0x180967[_0x433147][_0x168807(0xbc)]=_0x3cf912;}),_0x4f9a4d[_0x29d5fa(0xd4)]((_0x7fa2db,_0x27ff5e)=>{var _0x154638=_0x29d5fa;_0x180967[_0x27ff5e][_0x154638(0x167)]=_0x7fa2db;}),_0x24bc36[_0x29d5fa(0xd4)]((_0x332628,_0x3ae3c4)=>{_0x180967[_0x3ae3c4]['product_code']=_0x332628;}),_0x1ce1c8['forEach']((_0x500ce0,_0x4cccc5)=>{var _0x3311a1=_0x29d5fa;_0x180967[_0x4cccc5][_0x3311a1(0x115)]=_0x500ce0;}),_0x4d473a[_0x29d5fa(0xd4)]((_0x149585,_0x279449)=>{_0x180967[_0x279449]['unit']=_0x149585;}),_0x2bb5ba[_0x29d5fa(0xd4)]((_0x574450,_0x451f8b)=>{var _0x8e000e=_0x29d5fa;_0x180967[_0x451f8b][_0x8e000e(0xb7)]=_0x574450;}),_0x32753b[_0x29d5fa(0xd4)]((_0x1f18c6,_0x1f51e5)=>{var _0x70f3c2=_0x29d5fa;_0x180967[_0x1f51e5][_0x70f3c2(0xe5)]=_0x1f18c6;}),_0x1b0f7b[_0x29d5fa(0xd4)]((_0x2535fb,_0xa1b301)=>{_0x180967[_0xa1b301]['expiry_date']=_0x2535fb;}),_0xb9f0c[_0x29d5fa(0xd4)]((_0x486aaf,_0x1a1b9c)=>{var _0x14d937=_0x29d5fa;_0x180967[_0x1a1b9c][_0x14d937(0xc3)]=_0x486aaf;}),_0x392a4a[_0x29d5fa(0xd4)]((_0x2282c2,_0x446ce5)=>{var _0x11f72d=_0x29d5fa;_0x180967[_0x446ce5][_0x11f72d(0x115)]=_0x2282c2;}),_0xe70eca[_0x29d5fa(0xd4)]((_0x45be53,_0x3be3b0)=>{var _0x34e908=_0x29d5fa;_0x180967[_0x3be3b0][_0x34e908(0xe8)]=_0x45be53;}),_0x1d07fe['forEach']((_0x12c477,_0x5bdfbf)=>{var _0x13650a=_0x29d5fa;_0x180967[_0x5bdfbf][_0x13650a(0x11c)]=_0x12c477;}),_0x11087c[_0x29d5fa(0xd4)]((_0x4a6216,_0x258a3b)=>{var _0x38bbdf=_0x29d5fa;_0x180967[_0x258a3b][_0x38bbdf(0x112)]=_0x4a6216;}),_0x4dc4b2[_0x29d5fa(0xd4)]((_0x131ba3,_0xcb76f0)=>{_0x180967[_0xcb76f0]['to_room_name']=_0x131ba3;});const _0xe87d4b=_0x180967['filter'](_0xb1623e=>_0xb1623e[_0x29d5fa(0x14f)]!=='0'&&_0xb1623e[_0x29d5fa(0x14f)]!==''||_0xb1623e[_0x29d5fa(0xb2)]!=='0'&&_0xb1623e['to_floorlevel']!=='');var _0x3d78fe=0x0;_0xe87d4b[_0x29d5fa(0xd4)](_0x1844fe=>{var _0x361ba2=_0x29d5fa;parseInt(_0x1844fe['from_quantity'])<parseInt(_0x1844fe[_0x361ba2(0x14f)])&&_0x3d78fe++;});if(_0x3d78fe!=0x0)return _0x4b44e4[_0x29d5fa(0x153)](_0x29d5fa(0x14b),_0x29d5fa(0x138)),_0x2e9747[_0x29d5fa(0x103)](_0x29d5fa(0xfb));const _0x4e09d4=new transfers_logs();await _0x4e09d4['save']();for(let _0x5e56bb=0x0;_0x5e56bb<=_0x4dc4b2[_0x29d5fa(0x124)]-0x1;_0x5e56bb++){_0x180967[_0x5e56bb]['To_invoice']='LOG-TRF-'+_0x4e09d4[_0x29d5fa(0xf2)]['toString']()['padStart'](0x8,'0');}const _0x41a2c0=new transfers_finished({'date':_0x251ae8,'from_warehouse':_0x184620,'to_warehouse':_0x1d91d8,'product':_0xe87d4b,'note':_0x1b9cc2,'invoice':_0x29d5fa(0x14e)+_0x4e09d4[_0x29d5fa(0xf2)][_0x29d5fa(0x116)]()['padStart'](0x8,'0'),'type_of_transaction':_0x29d5fa(0xcd),'type_of_process':_0x29d5fa(0xc4),'PO_number':_0x294d4e,'RequestedBy':_0x94877b,'DateofRequest':_0x39f529,'typeservices':_0x10dc94,'destination':_0x2617bd,'deliverydate':_0x2bb088,'driver':_0x40b4e5,'plate':_0x387c58,'van':_0x3e428e,'DRSI':_0x29ce94,'typevehicle':_0x39d2e7,'TSU':_0x42b117,'TFU':_0x7a5645}),_0x330e72=await _0x41a2c0[_0x29d5fa(0x157)]();_0x4b44e4[_0x29d5fa(0x153)](_0x29d5fa(0xff),_0x29d5fa(0x160)),_0x2e9747[_0x29d5fa(0x103)](_0x29d5fa(0x122)+_0x330e72['_id']);}catch(_0x5bae60){console[_0x29d5fa(0x137)](_0x5bae60),_0x2e9747[_0x29d5fa(0x143)](0xc8)['json']({'errorMessage':_0x5bae60[_0x29d5fa(0x148)]});}}),router[a0_0x90adfa(0x15a)](a0_0x90adfa(0xe1),auth,async(_0x3d1e76,_0x4fc284)=>{var _0x2ebf6e=a0_0x90adfa;try{const {date:_0x31a3fd,from_warehouse:_0x555987,FromRoom_name:_0x316e93,to_warehouse:_0x49d2a0,ToRoom_name:_0x408541,prod_name:_0x123a17,from_prod_qty:_0x1d85bf,from_prod_level:_0x192cd9,from_prod_isle:_0x2d77ab,from_prod_pallet:_0x5e9636,to_prod_qty:_0x3225e5,to_prod_level:_0x4c10b7,to_prod_isle:_0xdd039f,to_prod_pallet:_0x4bbef3,primary_code:_0x294e69,secondary_code:_0x14c25e,product_code3:_0x18c0a4,note:_0x4553ea,MaxStocks_data2:_0x31bdad,invoice:_0x5243e2,expiry_date:_0x9cc546,PO_number:_0xc53ae0,ReqBy:_0x984f5b,dateofreq:_0x304ee2,typeservicesData:_0x3a3187,destination:_0x2988d9,deliverydate:_0x517933,driver:_0x10bcd9,plate:_0x115dfe,van:_0x1de69c,DRSI:_0xc8442a,typevehicle:_0x4a1053,TSU:_0x17cd37,TFU:_0xbfd281}=_0x3d1e76[_0x2ebf6e(0x118)];if(typeof _0x123a17==_0x2ebf6e(0xb1))var _0x28cbb1=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x12c)]],_0x42ffff=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x169)]],_0x10facc=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x127)]],_0x25ff10=[_0x3d1e76[_0x2ebf6e(0x118)]['New_Qty_Converted']],_0x15aeef=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x168)]],_0x4dd0d2=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0xbc)]],_0xfb1df5=[_0x3d1e76[_0x2ebf6e(0x118)]['secondary_code']],_0x5a5b22=[_0x3d1e76[_0x2ebf6e(0x118)]['product_code3']],_0x197113=[_0x3d1e76[_0x2ebf6e(0x118)]['MaxStocks_data2']],_0x5e125f=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0xbd)]],_0x169d07=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0xb7)]],_0x23d1ab=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0xe5)]],_0x482ca5=[_0x3d1e76['body'][_0x2ebf6e(0x13b)]],_0x321f39=[_0x3d1e76['body'][_0x2ebf6e(0xde)]],_0x1a3b22=[_0x3d1e76[_0x2ebf6e(0x118)]['MaxStocks_data']],_0x41df09=[_0x3d1e76['body'][_0x2ebf6e(0xe8)]],_0x188245=[_0x3d1e76['body'][_0x2ebf6e(0x11c)]],_0x15af76=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0xee)]],_0x5a0a70=[_0x3d1e76['body'][_0x2ebf6e(0x178)]],_0x41a2e0=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x114)]],_0x25eb16=[_0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x15f)]];else var _0x28cbb1=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x12c)]],_0x42ffff=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x169)]],_0x10facc=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x127)]],_0x25ff10=[..._0x3d1e76[_0x2ebf6e(0x118)]['New_Qty_Converted']],_0x15aeef=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x168)]],_0x4dd0d2=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0xbc)]],_0xfb1df5=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x167)]],_0x5a5b22=[..._0x3d1e76['body']['product_code3']],_0x197113=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x15e)]],_0x5e125f=[..._0x3d1e76[_0x2ebf6e(0x118)]['primary_unit']],_0x169d07=[..._0x3d1e76['body'][_0x2ebf6e(0xb7)]],_0x23d1ab=[..._0x3d1e76['body'][_0x2ebf6e(0xe5)]],_0x482ca5=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x13b)]],_0x321f39=[..._0x3d1e76['body'][_0x2ebf6e(0xde)]],_0x1a3b22=[..._0x3d1e76['body']['MaxStocks_data']],_0x41df09=[..._0x3d1e76[_0x2ebf6e(0x118)]['maxPerUnit']],_0x188245=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x11c)]],_0x15af76=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0xee)]],_0x5a0a70=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x178)]],_0x41a2e0=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x114)]],_0x25eb16=[..._0x3d1e76[_0x2ebf6e(0x118)][_0x2ebf6e(0x15f)]];const _0x19fb73=_0x28cbb1[_0x2ebf6e(0x13a)](_0x29d19f=>{return _0x29d19f={'product_name':_0x29d19f};});_0x42ffff[_0x2ebf6e(0xd4)]((_0x5960f0,_0x46ecac)=>{var _0x51bba4=_0x2ebf6e;_0x19fb73[_0x46ecac][_0x51bba4(0xaf)]=_0x5960f0;}),_0x10facc[_0x2ebf6e(0xd4)]((_0x19709d,_0x1bf393)=>{var _0x269124=_0x2ebf6e,_0x517792=_0x19709d[_0x269124(0xd9)](/[A-Za-z]+/)[0x0],_0x3565aa=parseInt(_0x19709d['match'](/\d+/)[0x0]);_0x19fb73[_0x1bf393][_0x269124(0xeb)]=_0x3565aa,_0x19fb73[_0x1bf393]['from_level']=_0x517792;}),_0x25eb16[_0x2ebf6e(0xd4)]((_0x523653,_0x1c2c99)=>{_0x19fb73[_0x1c2c99]['id_transaction']=_0x523653;}),_0x41a2e0['forEach']((_0x53ff80,_0x503fdd)=>{var _0x48351c=_0x2ebf6e;_0x19fb73[_0x503fdd][_0x48351c(0x114)]=_0x53ff80;}),_0x25ff10[_0x2ebf6e(0xd4)]((_0x5a9706,_0x14e721)=>{var _0x4d5f76=_0x2ebf6e;_0x19fb73[_0x14e721][_0x4d5f76(0x14f)]=_0x5a9706;}),_0x15aeef[_0x2ebf6e(0xd4)]((_0x1b11fc,_0x3ea8ec)=>{var _0x1197e3=_0x2ebf6e,_0x4b26b5=_0x1b11fc[_0x1197e3(0xd9)](/[A-Za-z]+/)[0x0],_0x3b89b0=parseInt(_0x1b11fc['match'](/\d+/)[0x0]);_0x19fb73[_0x3ea8ec][_0x1197e3(0x117)]=_0x4b26b5,_0x19fb73[_0x3ea8ec][_0x1197e3(0x12d)]=_0x3b89b0;}),_0x4dd0d2['forEach']((_0x5b7743,_0x4680ac)=>{var _0x2afc43=_0x2ebf6e;_0x19fb73[_0x4680ac][_0x2afc43(0xbc)]=_0x5b7743;}),_0xfb1df5['forEach']((_0x29758a,_0x5ae557)=>{_0x19fb73[_0x5ae557]['secondary_code']=_0x29758a;}),_0x5a5b22[_0x2ebf6e(0xd4)]((_0x20f307,_0x50cec7)=>{var _0x26f4af=_0x2ebf6e;_0x19fb73[_0x50cec7][_0x26f4af(0x109)]=_0x20f307;}),_0x197113[_0x2ebf6e(0xd4)]((_0x227685,_0x2f78ee)=>{var _0x2edb1e=_0x2ebf6e;_0x19fb73[_0x2f78ee][_0x2edb1e(0x115)]=_0x227685;}),_0x5e125f[_0x2ebf6e(0xd4)]((_0x2d283e,_0x2cac27)=>{_0x19fb73[_0x2cac27]['unit']=_0x2d283e;}),_0x169d07[_0x2ebf6e(0xd4)]((_0x555e68,_0x4e1e7d)=>{var _0x4f3e34=_0x2ebf6e;_0x19fb73[_0x4e1e7d][_0x4f3e34(0xb7)]=_0x555e68;}),_0x23d1ab['forEach']((_0x4e44f0,_0x5f4324)=>{var _0x1a0992=_0x2ebf6e;_0x19fb73[_0x5f4324][_0x1a0992(0xe5)]=_0x4e44f0;}),_0x482ca5[_0x2ebf6e(0xd4)]((_0xbebe31,_0x5930ef)=>{var _0x962f7e=_0x2ebf6e;_0x19fb73[_0x5930ef][_0x962f7e(0x13b)]=_0xbebe31;}),_0x321f39[_0x2ebf6e(0xd4)]((_0x389abe,_0x37191d)=>{var _0x4f6ba7=_0x2ebf6e;_0x19fb73[_0x37191d][_0x4f6ba7(0xc3)]=_0x389abe;}),_0x1a3b22[_0x2ebf6e(0xd4)]((_0x277cdc,_0x5c5b51)=>{_0x19fb73[_0x5c5b51]['maxProducts']=_0x277cdc;}),_0x41df09[_0x2ebf6e(0xd4)]((_0x2b8396,_0x56d55e)=>{var _0x1a05c0=_0x2ebf6e;_0x19fb73[_0x56d55e][_0x1a05c0(0xe8)]=_0x2b8396;}),_0x188245[_0x2ebf6e(0xd4)]((_0x1af34b,_0x2e1abb)=>{var _0x1f5458=_0x2ebf6e;_0x19fb73[_0x2e1abb][_0x1f5458(0x11c)]=_0x1af34b;}),_0x15af76[_0x2ebf6e(0xd4)]((_0x39cc59,_0x80d146)=>{var _0xc2b4d6=_0x2ebf6e;_0x19fb73[_0x80d146][_0xc2b4d6(0x112)]=_0x39cc59;}),_0x5a0a70[_0x2ebf6e(0xd4)]((_0x174dde,_0x6d727a)=>{_0x19fb73[_0x6d727a]['to_room_name']=_0x174dde;});const _0x3620f6=_0x19fb73[_0x2ebf6e(0x100)](_0x5e5ab2=>_0x5e5ab2[_0x2ebf6e(0x14f)]!=='0'&&_0x5e5ab2['to_quantity']!==''||_0x5e5ab2['to_floorlevel']!=='0'&&_0x5e5ab2[_0x2ebf6e(0xb2)]!=='');var _0x2bca99=0x0;_0x3620f6['forEach'](_0x412ac7=>{parseInt(_0x412ac7['from_quantity'])<parseInt(_0x412ac7['to_quantity'])&&_0x2bca99++;});if(_0x2bca99!=0x0)return _0x3d1e76[_0x2ebf6e(0x153)](_0x2ebf6e(0x14b),_0x2ebf6e(0x138)),_0x4fc284[_0x2ebf6e(0x103)](_0x2ebf6e(0xfb));const _0x3c0388=new invoice_for_transfer();await _0x3c0388[_0x2ebf6e(0x157)]();for(let _0x98a2b0=0x0;_0x98a2b0<=_0x5a0a70[_0x2ebf6e(0x124)]-0x1;_0x98a2b0++){_0x19fb73[_0x98a2b0][_0x2ebf6e(0x11b)]=_0x2ebf6e(0xba)+_0x3c0388['invoice_init']['toString']()[_0x2ebf6e(0xea)](0x8,'0');}const _0x481292=new transfers_finished({'date':_0x31a3fd,'from_warehouse':_0x555987,'to_warehouse':_0x555987,'product':_0x3620f6,'note':_0x4553ea,'invoice':'TRF-'+_0x3c0388['invoice_init']['toString']()[_0x2ebf6e(0xea)](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x2ebf6e(0x121),'PO_number':_0xc53ae0,'RequestedBy':_0x984f5b,'DateofRequest':_0x304ee2,'typeservices':_0x3a3187,'destination':_0x2988d9,'deliverydate':_0x517933,'driver':_0x10bcd9,'plate':_0x115dfe,'van':_0x1de69c,'DRSI':_0xc8442a,'typevehicle':_0x4a1053,'TSU':_0x17cd37,'TFU':_0xbfd281}),_0x2b259b=await _0x481292[_0x2ebf6e(0x157)]();_0x3d1e76[_0x2ebf6e(0x153)](_0x2ebf6e(0xff),_0x2ebf6e(0x160)),_0x4fc284[_0x2ebf6e(0x103)](_0x2ebf6e(0x122)+_0x2b259b[_0x2ebf6e(0x174)]);}catch(_0x4b905b){console[_0x2ebf6e(0x137)](_0x4b905b),_0x4fc284['status'](0xc8)[_0x2ebf6e(0xd6)]({'errorMessage':_0x4b905b[_0x2ebf6e(0x148)]});}}),router[a0_0x90adfa(0x15a)](a0_0x90adfa(0x129),auth,async(_0x2f3067,_0x3b99d0)=>{var _0x57b2fb=a0_0x90adfa;try{const {date:_0x5e7ca6,from_warehouse:_0x4a1175,FromRoom_name:_0x54df10,to_warehouse:_0x23119c,ToRoom_name:_0x1e733a,prod_name:_0x450412,from_prod_qty:_0x4d055b,from_prod_level:_0x5814c3,from_prod_isle:_0x229776,from_prod_pallet:_0x464626,to_prod_qty:_0x39efe7,to_prod_level:_0x3062f9,to_prod_isle:_0x15fdb1,to_prod_pallet:_0x52799f,primary_code:_0x5eb05c,secondary_code:_0x5436e5,product_code3:_0x2b48fc,note:_0xa7be1a,MaxStocks_data2:_0x10c4a0,invoice:_0x1617b1,expiry_date:_0x1ac5b8,PO_number_loc:_0x5a7d12,ReqBy_loc:_0x43f722,dateofreq_loc:_0x2cc954,typeservices_loc_Data:_0x5708a7,destination_loc:_0x180bce,deliverydate_loc:_0x3058be,driver_loc:_0x4fe514,plate_loc:_0x1544da,van_loc:_0x573ea3,DRSI_loc:_0x574048,typevehicle_loc:_0x7117d7,TSU_loc:_0x54ebdc,TFU_loc:_0x4547c8}=_0x2f3067[_0x57b2fb(0x118)];if(typeof _0x450412=='string')var _0x45a5fc=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x12c)]],_0x184487=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x169)]],_0x9c5c40=[_0x2f3067['body']['from_prod_level2']],_0x3c2485=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x172)]],_0x3b2d98=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x168)]],_0x5bbdff=[_0x2f3067['body'][_0x57b2fb(0xbc)]],_0x21d5a1=[_0x2f3067['body']['secondary_code']],_0x3507cf=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x10d)]],_0x3f1207=[_0x2f3067['body'][_0x57b2fb(0x15e)]],_0xe4cdbe=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0xbd)]],_0x4e3384=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0xb7)]],_0x45cf14=[_0x2f3067['body'][_0x57b2fb(0xe5)]],_0x5c0d41=[_0x2f3067['body'][_0x57b2fb(0x13b)]],_0x2c7e52=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0xde)]],_0x296fb1=[_0x2f3067[_0x57b2fb(0x118)]['MaxStocks_data']],_0x3a8daf=[_0x2f3067['body'][_0x57b2fb(0xe8)]],_0x45fb7e=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x11c)]],_0x11d04c=[_0x2f3067[_0x57b2fb(0x118)]['RoomAssigned']],_0x3c9a0c=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x178)]],_0x47a569=[_0x2f3067['body'][_0x57b2fb(0x114)]],_0xf17d54=[_0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x15f)]];else var _0x45a5fc=[..._0x2f3067['body'][_0x57b2fb(0x12c)]],_0x184487=[..._0x2f3067[_0x57b2fb(0x118)]['from_prod_qty']],_0x9c5c40=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x127)]],_0x3c2485=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x172)]],_0x3b2d98=[..._0x2f3067[_0x57b2fb(0x118)]['to_prod_level']],_0x5bbdff=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0xbc)]],_0x21d5a1=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x167)]],_0x3507cf=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x10d)]],_0x3f1207=[..._0x2f3067[_0x57b2fb(0x118)]['MaxStocks_data2']],_0xe4cdbe=[..._0x2f3067[_0x57b2fb(0x118)]['primary_unit']],_0x4e3384=[..._0x2f3067['body'][_0x57b2fb(0xb7)]],_0x45cf14=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0xe5)]],_0x5c0d41=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x13b)]],_0x2c7e52=[..._0x2f3067[_0x57b2fb(0x118)]['product_date']],_0x296fb1=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x151)]],_0x3a8daf=[..._0x2f3067[_0x57b2fb(0x118)]['maxPerUnit']],_0x45fb7e=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x11c)]],_0x11d04c=[..._0x2f3067[_0x57b2fb(0x118)]['RoomAssigned']],_0x3c9a0c=[..._0x2f3067[_0x57b2fb(0x118)][_0x57b2fb(0x178)]],_0x47a569=[..._0x2f3067[_0x57b2fb(0x118)]['from_invoice']],_0xf17d54=[..._0x2f3067['body'][_0x57b2fb(0x15f)]];const _0x4c5695=_0x45a5fc[_0x57b2fb(0x13a)](_0x3fcac8=>{return _0x3fcac8={'product_name':_0x3fcac8};});_0x184487['forEach']((_0xf211b4,_0x5e04ac)=>{_0x4c5695[_0x5e04ac]['from_quantity']=_0xf211b4;}),_0x9c5c40[_0x57b2fb(0xd4)]((_0x3cfafe,_0xc0d33c)=>{var _0x384306=_0x57b2fb,_0x82eeb7=_0x3cfafe['match'](/[A-Za-z]+/)[0x0],_0x1c6777=parseInt(_0x3cfafe[_0x384306(0xd9)](/\d+/)[0x0]);_0x4c5695[_0xc0d33c][_0x384306(0xeb)]=_0x1c6777,_0x4c5695[_0xc0d33c]['from_level']=_0x82eeb7;}),_0xf17d54[_0x57b2fb(0xd4)]((_0x1766e5,_0x3a52ec)=>{var _0x17a32a=_0x57b2fb;_0x4c5695[_0x3a52ec][_0x17a32a(0x15f)]=_0x1766e5;}),_0x47a569[_0x57b2fb(0xd4)]((_0x1ef080,_0x43bd5b)=>{var _0x50cded=_0x57b2fb;_0x4c5695[_0x43bd5b][_0x50cded(0x114)]=_0x1ef080;}),_0x3c2485[_0x57b2fb(0xd4)]((_0x18ee49,_0x5f1c56)=>{var _0x22a60d=_0x57b2fb;_0x4c5695[_0x5f1c56][_0x22a60d(0x14f)]=_0x18ee49;}),_0x3b2d98[_0x57b2fb(0xd4)]((_0x4ff63a,_0x3ad490)=>{var _0x12b4fe=_0x57b2fb,_0x18810d=_0x4ff63a[_0x12b4fe(0xd9)](/[A-Za-z]+/)[0x0],_0x1538f3=parseInt(_0x4ff63a[_0x12b4fe(0xd9)](/\d+/)[0x0]);_0x4c5695[_0x3ad490]['to_level']=_0x18810d,_0x4c5695[_0x3ad490][_0x12b4fe(0x12d)]=_0x1538f3;}),_0x5bbdff['forEach']((_0x50a830,_0x356f88)=>{var _0x64a25a=_0x57b2fb;_0x4c5695[_0x356f88][_0x64a25a(0xbc)]=_0x50a830;}),_0x21d5a1[_0x57b2fb(0xd4)]((_0x14bc89,_0x51e34a)=>{var _0xe809aa=_0x57b2fb;_0x4c5695[_0x51e34a][_0xe809aa(0x167)]=_0x14bc89;}),_0x3507cf[_0x57b2fb(0xd4)]((_0x2eddad,_0x480200)=>{var _0x5cc910=_0x57b2fb;_0x4c5695[_0x480200][_0x5cc910(0x109)]=_0x2eddad;}),_0x3f1207['forEach']((_0x26a51c,_0x337ecc)=>{var _0x2a2382=_0x57b2fb;_0x4c5695[_0x337ecc][_0x2a2382(0x115)]=_0x26a51c;}),_0xe4cdbe[_0x57b2fb(0xd4)]((_0x54db4e,_0x127a32)=>{_0x4c5695[_0x127a32]['unit']=_0x54db4e;}),_0x4e3384[_0x57b2fb(0xd4)]((_0x24b110,_0x10432c)=>{var _0x49430a=_0x57b2fb;_0x4c5695[_0x10432c][_0x49430a(0xb7)]=_0x24b110;}),_0x45cf14['forEach']((_0xd1f2b4,_0xf9efc0)=>{var _0x1788b5=_0x57b2fb;_0x4c5695[_0xf9efc0][_0x1788b5(0xe5)]=_0xd1f2b4;}),_0x5c0d41[_0x57b2fb(0xd4)]((_0xeeeb4a,_0x5f4875)=>{var _0x162be1=_0x57b2fb;_0x4c5695[_0x5f4875][_0x162be1(0x13b)]=_0xeeeb4a;}),_0x2c7e52[_0x57b2fb(0xd4)]((_0x1f9c6e,_0x446a25)=>{var _0x419387=_0x57b2fb;_0x4c5695[_0x446a25][_0x419387(0xc3)]=_0x1f9c6e;}),_0x296fb1['forEach']((_0x1c5f6c,_0xc02d56)=>{_0x4c5695[_0xc02d56]['maxProducts']=_0x1c5f6c;}),_0x3a8daf['forEach']((_0xdf9a7e,_0x3a5354)=>{var _0x2e43ca=_0x57b2fb;_0x4c5695[_0x3a5354][_0x2e43ca(0xe8)]=_0xdf9a7e;}),_0x45fb7e[_0x57b2fb(0xd4)]((_0x5b92ee,_0x9a8373)=>{var _0x3c23b1=_0x57b2fb;_0x4c5695[_0x9a8373][_0x3c23b1(0x11c)]=_0x5b92ee;}),_0x11d04c[_0x57b2fb(0xd4)]((_0x5c660f,_0xb31f7a)=>{var _0x2b2850=_0x57b2fb;_0x4c5695[_0xb31f7a][_0x2b2850(0x112)]=_0x5c660f;}),_0x3c9a0c[_0x57b2fb(0xd4)]((_0x2ef312,_0x31546c)=>{var _0x419f47=_0x57b2fb;_0x4c5695[_0x31546c][_0x419f47(0xe9)]=_0x2ef312;});const _0x92ad=_0x4c5695[_0x57b2fb(0x100)](_0x14a53c=>_0x14a53c[_0x57b2fb(0x14f)]!=='0'&&_0x14a53c[_0x57b2fb(0x14f)]!==''||_0x14a53c['to_floorlevel']!=='0'&&_0x14a53c[_0x57b2fb(0xb2)]!=='');var _0xc12ab0=0x0;_0x92ad['forEach'](_0x540b9e=>{parseInt(_0x540b9e['from_quantity'])<parseInt(_0x540b9e['to_quantity'])&&_0xc12ab0++;});if(_0xc12ab0!=0x0)return _0x2f3067[_0x57b2fb(0x153)](_0x57b2fb(0x14b),_0x57b2fb(0x138)),_0x3b99d0['redirect'](_0x57b2fb(0xfb));const _0xe284c3=new invoice_for_transfer();await _0xe284c3[_0x57b2fb(0x157)]();for(let _0x645cd=0x0;_0x645cd<=_0x3c9a0c[_0x57b2fb(0x124)]-0x1;_0x645cd++){_0x4c5695[_0x645cd]['To_invoice']='TRF-'+_0xe284c3[_0x57b2fb(0xf2)]['toString']()[_0x57b2fb(0xea)](0x8,'0');}const _0x2b342e=new transfers_finished({'date':_0x5e7ca6,'from_warehouse':_0x4a1175,'to_warehouse':_0x23119c,'product':_0x92ad,'note':_0xa7be1a,'invoice':'TRF-'+_0xe284c3[_0x57b2fb(0xf2)][_0x57b2fb(0x116)]()[_0x57b2fb(0xea)](0x8,'0'),'type_of_transaction':_0x57b2fb(0x121),'type_of_process':'location2location','PO_number':_0x5a7d12,'RequestedBy':_0x43f722,'DateofRequest':_0x2cc954,'typeservices':_0x5708a7,'destination':_0x180bce,'deliverydate':_0x3058be,'driver':_0x4fe514,'plate':_0x1544da,'van':_0x573ea3,'DRSI':_0x574048,'typevehicle':_0x7117d7,'TSU':_0x54ebdc,'TFU':_0x4547c8}),_0x3b017a=await _0x2b342e['save']();_0x2f3067[_0x57b2fb(0x153)]('success',_0x57b2fb(0x160)),_0x3b99d0['redirect'](_0x57b2fb(0x122)+_0x3b017a[_0x57b2fb(0x174)]);}catch(_0x7d1071){console[_0x57b2fb(0x137)](_0x7d1071),_0x3b99d0[_0x57b2fb(0x143)](0xc8)[_0x57b2fb(0xd6)]({'errorMessage':_0x7d1071[_0x57b2fb(0x148)]});}}),router['get'](a0_0x90adfa(0x16e),auth,async(_0x5c2844,_0x17c5b1)=>{var _0x2e7e07=a0_0x90adfa;try{const {username:_0x1445dd,email:_0x137238,role:_0x42b2ec}=_0x5c2844['user'],_0x42a97d=_0x5c2844[_0x2e7e07(0xec)],_0x158745=await profile['findOne']({'email':_0x42a97d[_0x2e7e07(0x106)]}),_0x574fa5=await master_shop['find'](),_0x554ab6=await transfers_finished[_0x2e7e07(0x161)](_0x5c2844[_0x2e7e07(0x14a)]['id']);let _0x3558f3;if(_0x42a97d[_0x2e7e07(0x16c)]=='staff'){const _0x40eda7=await staff[_0x2e7e07(0x101)]({'email':_0x42a97d[_0x2e7e07(0x106)]});_0x3558f3=await warehouse['find']({'status':_0x2e7e07(0x14c),'name':_0x40eda7[_0x2e7e07(0xf9)],'warehouse_category':'Finished\x20Goods'});}else _0x3558f3=await warehouse[_0x2e7e07(0x158)]({'status':_0x2e7e07(0x14c),'warehouse_category':_0x2e7e07(0xce)});const _0x39b1fa=await warehouse[_0x2e7e07(0x126)]([{'$match':{'name':_0x554ab6[_0x2e7e07(0xca)],'warehouse_category':_0x2e7e07(0xce)}},{'$unwind':_0x2e7e07(0x15b)},{'$group':{'_id':_0x2e7e07(0xd8),'name':{'$first':_0x2e7e07(0x130)},'product_stock':{'$first':_0x2e7e07(0xd3)},'bay':{'$first':_0x2e7e07(0x15d)},'bin':{'$first':_0x2e7e07(0x135)},'type':{'$first':_0x2e7e07(0x111)},'floorlevel':{'$first':_0x2e7e07(0x10c)},'primary_code':{'$first':_0x2e7e07(0xdf)},'secondary_code':{'$first':_0x2e7e07(0x134)},'product_code':{'$first':_0x2e7e07(0xc2)},'storage':{'$first':_0x2e7e07(0x108)},'rack':{'$first':_0x2e7e07(0x11a)},'expiry_date':{'$first':_0x2e7e07(0x12b)},'production_date':{'$first':_0x2e7e07(0x133)},'room':{'$first':_0x2e7e07(0x147)},'warehoue_name':{'$first':_0x2e7e07(0xed)}}}]),_0x2a3984=await product[_0x2e7e07(0x158)]({});if(_0x574fa5[0x0][_0x2e7e07(0xcb)]=='English\x20(US)'){var _0x3e6f57=users[_0x2e7e07(0xc5)];console[_0x2e7e07(0x137)](_0x3e6f57);}else{if(_0x574fa5[0x0][_0x2e7e07(0xcb)]==_0x2e7e07(0x145))var _0x3e6f57=users[_0x2e7e07(0x145)];else{if(_0x574fa5[0x0][_0x2e7e07(0xcb)]==_0x2e7e07(0x149))var _0x3e6f57=users[_0x2e7e07(0x149)];else{if(_0x574fa5[0x0][_0x2e7e07(0xcb)]=='Spanish')var _0x3e6f57=users[_0x2e7e07(0x171)];else{if(_0x574fa5[0x0][_0x2e7e07(0xcb)]==_0x2e7e07(0xf5))var _0x3e6f57=users[_0x2e7e07(0xf5)];else{if(_0x574fa5[0x0][_0x2e7e07(0xcb)]=='Portuguese\x20(BR)')var _0x3e6f57=users[_0x2e7e07(0x176)];else{if(_0x574fa5[0x0]['language']==_0x2e7e07(0x14d))var _0x3e6f57=users['Chinese'];else{if(_0x574fa5[0x0][_0x2e7e07(0xcb)]=='Arabic\x20(ae)')var _0x3e6f57=users[_0x2e7e07(0xef)];}}}}}}}_0x17c5b1[_0x2e7e07(0xda)](_0x2e7e07(0xe3),{'success':_0x5c2844[_0x2e7e07(0x153)](_0x2e7e07(0xff)),'errors':_0x5c2844['flash'](_0x2e7e07(0x14b)),'role':_0x42a97d,'profile':_0x158745,'master_shop':_0x574fa5,'warehouse':_0x3558f3,'transfer':_0x554ab6,'stock':_0x39b1fa,'unit':_0x2a3984,'language':_0x3e6f57});}catch(_0x2a8e9e){console['log'](_0x2a8e9e);}}),router[a0_0x90adfa(0x15a)](a0_0x90adfa(0x16e),auth,async(_0x3bcfea,_0x1ee9d3)=>{var _0xe4f4c4=a0_0x90adfa;try{const {invoice:_0x48e232,from_warehouse:_0x715a95,FromRoom_name:_0x2687d9,to_warehouse:_0xcb1662,ToRoom_name:_0x359d7e}=_0x3bcfea['body'],_0x3086d3=await transfers_finished[_0xe4f4c4(0x161)](_0x3bcfea['params']['id']),_0x43bacf=_0x3086d3['product']['map'](async _0x55a6a9=>{var _0x21c46e=_0xe4f4c4;if(_0x55a6a9[_0x21c46e(0x14f)]>0x0){var _0x5dbb5b=await warehouse[_0x21c46e(0x101)]({'name':_0x715a95,'room':_0x55a6a9[_0x21c46e(0x112)]});const _0x25ac46=_0x5dbb5b[_0x21c46e(0xfd)][_0x21c46e(0x13a)](_0xde8a9b=>{var _0x4c774e=_0x21c46e;_0xde8a9b['_id']==_0x55a6a9[_0x4c774e(0x15f)]&&(_0xde8a9b[_0x4c774e(0x165)]=Math[_0x4c774e(0x12a)](0x0,Math[_0x4c774e(0xb0)](_0xde8a9b[_0x4c774e(0x165)])-Math[_0x4c774e(0xb0)](_0x55a6a9[_0x4c774e(0x14f)])),console['log'](_0xde8a9b[_0x4c774e(0x165)]));});}return _0x5dbb5b;});Promise[_0xe4f4c4(0x152)](_0x43bacf)[_0xe4f4c4(0xbf)](async _0x2264bb=>{var _0x4b24b1=_0xe4f4c4;try{for(const _0x205299 of _0x2264bb){await _0x205299[_0x4b24b1(0x157)]();}const _0x2b3a66=_0x3086d3[_0x4b24b1(0x10a)][_0x4b24b1(0x13a)](async _0x4849f0=>{var _0x55277c=_0x4b24b1,_0x19e7a8=await warehouse[_0x55277c(0x101)]({'name':_0xcb1662,'room':_0x4849f0[_0x55277c(0xe9)]});if(_0x4849f0[_0x55277c(0x14f)]>0x0){var _0x482182=0x0;const _0x5be2b1=_0x19e7a8[_0x55277c(0xfd)][_0x55277c(0x13a)](_0x1503f8=>{var _0x45b3bd=_0x55277c;_0x1503f8[_0x45b3bd(0xe0)]==_0x4849f0[_0x45b3bd(0xe0)]&&_0x1503f8[_0x45b3bd(0x16b)]==_0x4849f0[_0x45b3bd(0x12d)]&&_0x1503f8[_0x45b3bd(0x13b)]==_0x4849f0[_0x45b3bd(0x13b)]&&_0x1503f8[_0x45b3bd(0xc3)]==_0x4849f0['production_date']&&_0x1503f8[_0x45b3bd(0xe5)]==_0x4849f0[_0x45b3bd(0xe5)]&&_0x1503f8[_0x45b3bd(0x154)]==_0x4849f0[_0x45b3bd(0x11b)]&&(typeof _0x4849f0['id_transaction']==_0x45b3bd(0xe2)?(console[_0x45b3bd(0x137)](_0x45b3bd(0x15c),_0x1503f8[_0x45b3bd(0x165)]+_0x45b3bd(0xd5)+_0x1503f8['_id']+_0x45b3bd(0xf8)+Math[_0x45b3bd(0xb0)](_0x1503f8[_0x45b3bd(0x165)])+Math['abs'](_0x4849f0[_0x45b3bd(0x14f)])),_0x1503f8[_0x45b3bd(0x165)]=Math[_0x45b3bd(0xb0)](_0x1503f8['product_stock'])+Math[_0x45b3bd(0xb0)](_0x4849f0[_0x45b3bd(0x14f)])):_0x1503f8[_0x45b3bd(0x165)]=Math[_0x45b3bd(0xb0)](_0x1503f8[_0x45b3bd(0x165)])+Math['abs'](_0x4849f0['to_quantity']),_0x482182++);});_0x482182=='0'&&(_0x19e7a8[_0x55277c(0xfd)]=_0x19e7a8[_0x55277c(0xfd)][_0x55277c(0x141)]({'product_name':_0x4849f0['product_name'],'product_stock':_0x4849f0[_0x55277c(0x14f)],'bay':_0x4849f0[_0x55277c(0x12d)],'level':_0x4849f0[_0x55277c(0x117)],'product_code':_0x4849f0[_0x55277c(0x109)],'primary_code':_0x4849f0[_0x55277c(0xbc)],'secondary_code':_0x4849f0[_0x55277c(0x167)],'expiry_date':_0x4849f0[_0x55277c(0x13b)],'production_date':_0x4849f0[_0x55277c(0xc3)],'maxProducts':_0x4849f0['maxProducts'],'batch_code':_0x4849f0[_0x55277c(0xe5)],'secondary_unit':_0x4849f0[_0x55277c(0xb7)],'unit':_0x4849f0[_0x55277c(0x16d)],'maxProducts':_0x4849f0['maxProducts'],'maxPerUnit':_0x4849f0['maxPerUnit'],'invoice':_0x4849f0['To_invoice']}));}return _0x19e7a8;});Promise[_0x4b24b1(0x152)](_0x2b3a66)['then'](async _0x4cc952=>{var _0xe0df79=_0x4b24b1;try{console[_0xe0df79(0x137)](_0x3086d3[_0xe0df79(0xc0)]);if(_0x3086d3[_0xe0df79(0xc0)]!=_0xe0df79(0xc4))for(const _0x1be1fb of _0x4cc952){await warehouse[_0xe0df79(0x10f)]({'_id':_0x1be1fb[_0xe0df79(0x174)]},{'$addToSet':{'product_details':{'$each':_0x1be1fb[_0xe0df79(0xfd)]}}});}_0x3086d3['finalize']=_0xe0df79(0x170);const _0x2b282b=await _0x3086d3[_0xe0df79(0x157)](),_0x58e139=await master_shop['find'](),_0x1d8de4=await email_settings['findOne'](),_0x509f35=await supervisor_settings['find']();var _0x1b86a2=_0x3086d3[_0xe0df79(0x10a)],_0x422e8b='',_0x72de18;for(_0x72de18 in _0x1b86a2){var _0x2e024b='FG';_0x3086d3[_0xe0df79(0xfa)]==_0xe0df79(0xdb)&&(_0x2e024b='DG'),_0x422e8b+=_0xe0df79(0x16f)+_0xe0df79(0x11f)+_0x1b86a2[_0x72de18][_0xe0df79(0xe0)]+_0xe0df79(0x12e)+_0xe0df79(0x11f)+_0x1b86a2[_0x72de18][_0xe0df79(0x109)]+_0xe0df79(0x12e)+_0xe0df79(0x11f)+_0x1b86a2[_0x72de18][_0xe0df79(0x14f)]+'</td>'+_0xe0df79(0x11f)+_0x1b86a2[_0x72de18][_0xe0df79(0x16d)]+_0xe0df79(0x12e)+_0xe0df79(0x11f)+_0x1b86a2[_0x72de18][_0xe0df79(0xb7)]+'</td>'+_0xe0df79(0x11f)+_0x3086d3[_0xe0df79(0xfa)]+_0xe0df79(0x12e)+_0xe0df79(0x11f)+_0x1b86a2[_0x72de18][_0xe0df79(0xe9)]+'</td>'+_0xe0df79(0x11f)+_0x2e024b+_0x1b86a2[_0x72de18][_0xe0df79(0x12d)]+'</td>'+_0xe0df79(0x11e);}_0x3bcfea[_0xe0df79(0x153)](_0xe0df79(0xff),'Transfer\x20Finalize\x20Successfully'),_0x1ee9d3['redirect'](_0xe0df79(0xb9)+_0x2b282b[_0xe0df79(0x174)]);}catch(_0x58ab4d){console['error'](_0x58ab4d),_0x1ee9d3['status'](0x1f4)[_0xe0df79(0xd6)]({'error':_0xe0df79(0xb3)});}})['catch'](_0x5d97f4=>{var _0x4bf3bf=_0x4b24b1;console[_0x4bf3bf(0xb5)](_0x5d97f4),_0x1ee9d3[_0x4bf3bf(0x143)](0x1f4)[_0x4bf3bf(0xd6)]({'error':_0x4bf3bf(0x13d)});});}catch(_0x211394){console[_0x4b24b1(0xb5)](_0x211394),_0x1ee9d3[_0x4b24b1(0x143)](0x1f4)[_0x4b24b1(0xd6)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0xe4f4c4(0x13e)](_0x4f74ee=>{var _0x1fadd2=_0xe4f4c4;console[_0x1fadd2(0xb5)](_0x4f74ee),_0x1ee9d3['status'](0x1f4)['json']({'error':_0x1fadd2(0x13d)});});}catch(_0x208664){_0x1ee9d3['json']({'message':_0x208664[_0xe4f4c4(0x148)]});}});function a0_0x3ef8(){var _0x559689=['Rack\x202','$product_details.maxPerUnit','invoice_init','$invoice','get','French','$product_details.invoice','/view_logs','\x20<=>\x20','warehouse','to_warehouse','back','Portuguese\x20(BR)','product_details','$_id','success','filter','findOne','express','redirect','There\x27s\x20a\x20error\x20in\x20this\x20transaction','to_room','email','$product_details.secondary_unit','$product_details.storage','product_code','product','Ambient','$product_details.floorlevel','product_code3','10342570MdKsyM','updateOne','../middleware/auth','$product_details.type','from_room_name','bin2bin','from_invoice','maxProducts','toString','to_level','body','$product_details.maxProducts','$product_details.rack','To_invoice','prod_cat','/barcode_scanner','</tr>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','note','own','/transfer_finished/preview/','673324MPvQOv','length','72jgMwoK','aggregate','from_prod_level2','$product_details.level','/view/add_transfer_loc','max','$product_details.expiry_date','prod_name','to_bay','</td>','3337395CfpQfr','$product_details.product_name','385242GKEqyf','TRFF-','$product_details.production_date','$product_details.secondary_code','$product_details.bin','$date','log','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','854805rHwrsz','map','expiry_date','/view/:id','An\x20error\x20occurred.','catch','floor','Arabic\x20(ae)','concat','/view/addlog','status','from_room','Hindi','split','$room','message','German','params','errors','Enabled','Chinese','LOG-TRF-','to_quantity','transfer_data','MaxStocks_data','all','flash','invoice','from_level','choos_transfer','save','find','staff','post','$product_details','here2','$product_details.bay','MaxStocks_data2','id_transaction','Product\x20Transfer\x20successfully','findById','$product.to_room_name','FROZEN\x20GOODS','Router','product_stock','$finalize','secondary_code','to_prod_level','from_prod_qty','from_prod_level','bay','role','unit','/preview/:id','<tr>','True','Spanish','New_Qty_Converted','getFullYear','_id','English\x20(US)','Portuguese','getMonth','ToRoomAssigned','add_transfer_finished','from_quantity','abs','string','to_floorlevel','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','to_prod_qty','error','transfer_finished_logs','secondary_unit','$product','/picking_list/PDF_transfer/','TRF-','9995040PeMgkF','primary_code','primary_unit','$product.from_room_name','then','type_of_process','getDate','$product_details.product_code','production_date','location2location','English','../models/all_models','5KeLXgM','slice','/view','from_warehouse','language','666454TpMVOc','logs','Finished\x20Goods','choos_transfer_logs','2yvTKeZ','/transfer_finished/view','edit_transfer_finished','$product_details.product_stock','forEach','\x20<>\x20','json','$from_warehouse','$product_details._id','match','render','DRY\x20GOODS','$to_warehouse','push','product_date','$product_details.primary_code','product_name','/view/add_transfer','undefined','edit_transfer_finished_view','$product_details.batch_code','batch_code','Rack\x201','/transfer/view','maxPerUnit','to_room_name','padStart','from_bay','user','$name','RoomAssigned','Arabic'];a0_0x3ef8=function(){return _0x559689;};return a0_0x3ef8();}function BayBinSelected(_0xbbbf1b,_0x3edb4d){var _0x53ce8a=a0_0x90adfa,_0x1aebcf=[];let _0x2ea172=[];var _0x10351a=[];if(_0xbbbf1b=='DRY\x20GOODS'){switch(_0x3edb4d){case _0x53ce8a(0xe6):_0x1aebcf=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x53ce8a(0xf0):_0x1aebcf=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x10351a=['DG'];}else{if(_0xbbbf1b==_0x53ce8a(0x163)){switch(_0x3edb4d){case _0x53ce8a(0xe6):_0x1aebcf=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x53ce8a(0xf0):_0x1aebcf=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x10351a=['FG'];}}return{'levels':_0x1aebcf,'identify':_0x10351a};}router[a0_0x90adfa(0xf4)](a0_0x90adfa(0x13c),auth,async(_0x5abfb7,_0x473876)=>{var _0x141be2=a0_0x90adfa;try{const {username:_0x140003,email:_0x3f354c,role:_0x531a21}=_0x5abfb7[_0x141be2(0xec)],_0x446f2c=_0x5abfb7[_0x141be2(0xec)],_0x4e4398=await profile[_0x141be2(0x101)]({'email':_0x446f2c['email']}),_0x33ee79=await master_shop[_0x141be2(0x158)](),_0x3781ad=await transfers_finished[_0x141be2(0x161)](_0x5abfb7[_0x141be2(0x14a)]['id']);let _0x12724a=new Date(_0x3781ad[_0x141be2(0x13b)]),_0x14c2ac=('0'+_0x12724a[_0x141be2(0xc1)]())[_0x141be2(0xc8)](-0x2),_0x3c5e65=('0'+(_0x12724a[_0x141be2(0x177)]()+0x1))['slice'](-0x2),_0x31e9fa=_0x12724a[_0x141be2(0x173)](),_0xc569f=_0x31e9fa+'-'+_0x3c5e65+'-'+_0x14c2ac,_0x26c092;if(_0x446f2c['role']==_0x141be2(0x159)){const _0x3dc5f4=await staff[_0x141be2(0x101)]({'email':_0x446f2c[_0x141be2(0x106)]});_0x26c092=await warehouse[_0x141be2(0x158)]({'status':_0x141be2(0x14c),'name':_0x3dc5f4[_0x141be2(0xf9)],'warehouse_category':_0x141be2(0xce)});}else _0x26c092=await warehouse['find']({'status':_0x141be2(0x14c),'warehouse_category':_0x141be2(0xce)});const _0x2a9f46=await warehouse[_0x141be2(0x126)]([{'$match':{'name':_0x3781ad['from_warehouse'],'room':_0x3781ad[_0x141be2(0x144)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x141be2(0xd8),'name':{'$first':_0x141be2(0x130)},'product_stock':{'$first':_0x141be2(0xd3)},'bay':{'$first':_0x141be2(0x15d)},'bin':{'$first':_0x141be2(0x135)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x141be2(0x10c)},'primary_code':{'$first':_0x141be2(0xdf)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x141be2(0x108)},'rack':{'$first':_0x141be2(0x11a)}}}]);var _0x4c12f6=[0x1,0x2,0x3,0x4],_0x26238f=['A','B','C','D','E','F','G','H','I','J'],_0x5cfa65=[_0x141be2(0x10b),'Enclosed'];const _0x401256=await product['find']({}),_0x3e3074=BayBinSelected(_0x3781ad[_0x141be2(0xfa)],_0x3781ad[_0x141be2(0x105)]);if(_0x33ee79[0x0][_0x141be2(0xcb)]==_0x141be2(0x175)){var _0x230412=users[_0x141be2(0xc5)];console[_0x141be2(0x137)](_0x230412);}else{if(_0x33ee79[0x0][_0x141be2(0xcb)]==_0x141be2(0x145))var _0x230412=users[_0x141be2(0x145)];else{if(_0x33ee79[0x0][_0x141be2(0xcb)]=='German')var _0x230412=users['German'];else{if(_0x33ee79[0x0][_0x141be2(0xcb)]==_0x141be2(0x171))var _0x230412=users[_0x141be2(0x171)];else{if(_0x33ee79[0x0]['language']=='French')var _0x230412=users[_0x141be2(0xf5)];else{if(_0x33ee79[0x0]['language']==_0x141be2(0xfc))var _0x230412=users['Portuguese'];else{if(_0x33ee79[0x0][_0x141be2(0xcb)]==_0x141be2(0x14d))var _0x230412=users[_0x141be2(0x14d)];else{if(_0x33ee79[0x0][_0x141be2(0xcb)]==_0x141be2(0x140))var _0x230412=users[_0x141be2(0xef)];}}}}}}}_0x473876[_0x141be2(0xda)](_0x141be2(0xd2),{'success':_0x5abfb7[_0x141be2(0x153)](_0x141be2(0xff)),'errors':_0x5abfb7['flash'](_0x141be2(0x14b)),'role':_0x446f2c,'profile':_0x4e4398,'master_shop':_0x33ee79,'warehouse':_0x26c092,'transfer':_0x3781ad,'stock':_0x2a9f46,'unit':_0x401256,'language':_0x230412,'levels':_0x4c12f6,'Isle':_0x26238f,'rooms_data':_0x5cfa65,'ed_fullDate':_0xc569f,'dataSelected':_0x3e3074});}catch(_0x34040b){console[_0x141be2(0x137)](_0x34040b);}}),router[a0_0x90adfa(0x15a)]('/view/:id',auth,async(_0x244a56,_0x46358f)=>{var _0x381512=a0_0x90adfa;try{const _0xb9753d=_0x244a56[_0x381512(0x14a)]['id'];console['log'](_0x244a56[_0x381512(0x118)]);const _0x34c9b5=await transfers_finished['findById'](_0xb9753d);console[_0x381512(0x137)](_0x381512(0x150),_0x34c9b5);const {date:_0x352b6b,from_warehouse:_0x1c6b83,FromRoom_name:_0x395770,to_warehouse:_0x5dd31e,ToRoom_name:_0x200fd8,prod_name:_0x3b868b,from_prod_qty:_0x2f6f08,from_prod_level:_0x50de3b,from_prod_isle:_0x28877d,from_prod_pallet:_0x25d8d8,to_prod_qty:_0x5ccb19,to_prod_level:_0xa5540d,to_prod_isle:_0x472201,to_prod_pallet:_0x1da743,primary_code:_0x488e79,secondary_code:_0x21c2bb,product_code3:_0x1d0025,note:_0x2bde07,invoice:_0x43c3ab,expiry_date:_0x48999f}=_0x244a56[_0x381512(0x118)];if(typeof _0x3b868b==_0x381512(0xb1))var _0xbae7d0=[_0x244a56[_0x381512(0x118)][_0x381512(0x12c)]],_0x3aa65e=[_0x244a56[_0x381512(0x118)][_0x381512(0x169)]],_0x4d189a=[_0x244a56[_0x381512(0x118)][_0x381512(0x16a)]],_0x326677=[_0x244a56[_0x381512(0x118)][_0x381512(0xb4)]],_0x14e79c=[_0x244a56['body'][_0x381512(0x168)]],_0x4b1575=[_0x244a56[_0x381512(0x118)]['primary_code']],_0xc50355=[_0x244a56['body'][_0x381512(0x167)]],_0x2cd1be=[_0x244a56['body'][_0x381512(0x10d)]],_0x4f789e=[_0x244a56[_0x381512(0x118)][_0x381512(0x15e)]],_0x1bebc9=[_0x244a56[_0x381512(0x118)]['unit']],_0xb8ee94=[_0x244a56[_0x381512(0x118)]['secondary_unit']],_0x510a94=[_0x244a56['body']['batch_code']],_0x3d389d=[_0x244a56[_0x381512(0x118)]['expiry_date']];else var _0xbae7d0=[..._0x244a56['body'][_0x381512(0x12c)]],_0x3aa65e=[..._0x244a56[_0x381512(0x118)][_0x381512(0x169)]],_0x4d189a=[..._0x244a56[_0x381512(0x118)][_0x381512(0x16a)]],_0x326677=[..._0x244a56[_0x381512(0x118)][_0x381512(0xb4)]],_0x14e79c=[..._0x244a56[_0x381512(0x118)][_0x381512(0x168)]],_0x4b1575=[..._0x244a56['body'][_0x381512(0xbc)]],_0xc50355=[..._0x244a56[_0x381512(0x118)][_0x381512(0x167)]],_0x2cd1be=[..._0x244a56[_0x381512(0x118)][_0x381512(0x10d)]],_0x4f789e=[..._0x244a56[_0x381512(0x118)][_0x381512(0x15e)]],_0x1bebc9=[..._0x244a56['body'][_0x381512(0x16d)]],_0xb8ee94=[..._0x244a56['body'][_0x381512(0xb7)]],_0x510a94=[..._0x244a56[_0x381512(0x118)]['batch_code']],_0x3d389d=[..._0x244a56[_0x381512(0x118)][_0x381512(0x13b)]];const _0x3e3d18=_0xbae7d0[_0x381512(0x13a)](_0x2a68d4=>{return _0x2a68d4={'product_name':_0x2a68d4};});_0x3aa65e['forEach']((_0x25a532,_0x287ad8)=>{var _0x2bf8a8=_0x381512;_0x3e3d18[_0x287ad8][_0x2bf8a8(0xaf)]=_0x25a532;}),_0x4d189a[_0x381512(0xd4)]((_0x92ddc7,_0x17ea0d)=>{var _0x5910d8=_0x381512;_0x3e3d18[_0x17ea0d][_0x5910d8(0xeb)]=_0x92ddc7;}),_0x326677[_0x381512(0xd4)]((_0x604c84,_0x4846ea)=>{var _0x808936=_0x381512;_0x3e3d18[_0x4846ea][_0x808936(0x14f)]=_0x604c84;}),_0x14e79c[_0x381512(0xd4)]((_0x41f6a9,_0x411a4d)=>{var _0x44113d=_0x381512;_0x3e3d18[_0x411a4d][_0x44113d(0x12d)]=_0x41f6a9;}),_0x4b1575[_0x381512(0xd4)]((_0x2184ca,_0x2c5e7c)=>{_0x3e3d18[_0x2c5e7c]['primary_code']=_0x2184ca;}),_0xc50355[_0x381512(0xd4)]((_0x2e8ad6,_0x577929)=>{var _0x5a9336=_0x381512;_0x3e3d18[_0x577929][_0x5a9336(0x167)]=_0x2e8ad6;}),_0x2cd1be[_0x381512(0xd4)]((_0x1174f0,_0x42bf24)=>{var _0x4e7490=_0x381512;_0x3e3d18[_0x42bf24][_0x4e7490(0x109)]=_0x1174f0;}),_0x4f789e[_0x381512(0xd4)]((_0x3ad7a4,_0x2b9f65)=>{var _0x1cb4d9=_0x381512;_0x3e3d18[_0x2b9f65][_0x1cb4d9(0x115)]=_0x3ad7a4;}),_0x1bebc9['forEach']((_0x18c81f,_0x55b2fe)=>{var _0x2343bf=_0x381512;_0x3e3d18[_0x55b2fe][_0x2343bf(0x16d)]=_0x18c81f;}),_0xb8ee94[_0x381512(0xd4)]((_0x3f1b07,_0x28e143)=>{var _0x4195ec=_0x381512;_0x3e3d18[_0x28e143][_0x4195ec(0xb7)]=_0x3f1b07;}),_0x510a94[_0x381512(0xd4)]((_0x5d910f,_0x101d11)=>{var _0x30629d=_0x381512;_0x3e3d18[_0x101d11][_0x30629d(0xe5)]=_0x5d910f;}),_0x3d389d[_0x381512(0xd4)]((_0x5f3907,_0x2efa29)=>{var _0x269900=_0x381512;_0x3e3d18[_0x2efa29][_0x269900(0x13b)]=_0x5f3907;});const _0x40f27d=_0x3e3d18[_0x381512(0x100)](_0x96621b=>_0x96621b[_0x381512(0x14f)]!=='0'&&_0x96621b[_0x381512(0x14f)]!==''||_0x96621b[_0x381512(0xb2)]!=='0'&&_0x96621b['to_floorlevel']!=='');var _0x23947c=0x0;_0x40f27d[_0x381512(0xd4)](_0x4e11be=>{var _0xdf53a7=_0x381512;parseInt(_0x4e11be[_0xdf53a7(0xaf)])<parseInt(_0x4e11be[_0xdf53a7(0x14f)])&&_0x23947c++;});if(_0x23947c!=0x0)return _0x244a56[_0x381512(0x153)](_0x381512(0x14b),_0x381512(0x138)),_0x46358f[_0x381512(0x103)](_0x381512(0xfb));const _0x4df1ad=await warehouse[_0x381512(0x101)]({'name':_0x34c9b5[_0x381512(0xca)],'room':_0x34c9b5[_0x381512(0x144)]});_0x34c9b5[_0x381512(0x10a)][_0x381512(0xd4)](_0x2c5280=>{var _0x1291cb=_0x381512;if(_0x2c5280['to_quantity']>0x0){const _0x134ad7=_0x4df1ad[_0x1291cb(0xfd)][_0x1291cb(0x13a)](_0xcc2642=>{var _0x107c0d=_0x1291cb;_0xcc2642[_0x107c0d(0xe0)]==_0x2c5280[_0x107c0d(0xe0)]&&_0xcc2642[_0x107c0d(0x16b)]==_0x2c5280[_0x107c0d(0xeb)]&&(_0xcc2642[_0x107c0d(0x165)]=parseInt(_0xcc2642[_0x107c0d(0x165)])+parseInt(_0x2c5280[_0x107c0d(0x14f)]));});}}),await _0x4df1ad[_0x381512(0x157)]();const _0x359b3f=await warehouse[_0x381512(0x101)]({'name':_0x34c9b5[_0x381512(0xfa)],'room':_0x34c9b5[_0x381512(0x105)]});_0x34c9b5[_0x381512(0x10a)][_0x381512(0xd4)](_0x3d2106=>{var _0x57b9e4=_0x381512;if(_0x3d2106['to_quantity']>0x0){const _0x19a5a6=_0x359b3f[_0x57b9e4(0xfd)][_0x57b9e4(0x13a)](_0x35755c=>{var _0x5dcb6a=_0x57b9e4;_0x35755c['product_name']==_0x3d2106[_0x5dcb6a(0xe0)]&&_0x35755c[_0x5dcb6a(0x16b)]==_0x3d2106[_0x5dcb6a(0x12d)]&&(_0x35755c[_0x5dcb6a(0x165)]=parseInt(_0x35755c[_0x5dcb6a(0x165)])-parseInt(_0x3d2106['to_quantity']));});}}),await _0x359b3f['save'](),_0x34c9b5['date']=_0x352b6b,_0x34c9b5[_0x381512(0xca)]=_0x1c6b83,_0x34c9b5[_0x381512(0xfa)]=_0x5dd31e,_0x34c9b5[_0x381512(0x10a)]=_0x40f27d,_0x34c9b5[_0x381512(0x120)]=_0x2bde07,_0x34c9b5[_0x381512(0x154)]=_0x43c3ab;const _0x30c617=await _0x34c9b5[_0x381512(0x157)](),_0x3adff7=await warehouse[_0x381512(0x101)]({'name':_0x1c6b83,'room':_0x395770});_0x30c617[_0x381512(0x10a)][_0x381512(0xd4)](_0x4e9a84=>{var _0x2bc078=_0x381512;if(_0x4e9a84[_0x2bc078(0x14f)]>0x0){const _0xc357c8=_0x3adff7[_0x2bc078(0xfd)]['map'](_0x24e6f7=>{var _0x3f41f6=_0x2bc078;_0x24e6f7[_0x3f41f6(0xe0)]==_0x4e9a84[_0x3f41f6(0xe0)]&&_0x24e6f7['bay']==_0x4e9a84['from_bay']&&(_0x24e6f7['product_stock']=parseInt(_0x24e6f7['product_stock'])-parseInt(_0x4e9a84[_0x3f41f6(0x14f)]));});}}),await _0x3adff7['save']();const _0x314f0f=await warehouse[_0x381512(0x101)]({'name':_0x5dd31e,'room':_0x200fd8});_0x30c617['product']['forEach'](_0x51a153=>{var _0x196f27=_0x381512;if(_0x51a153[_0x196f27(0x14f)]>0x0){var _0x214663=0x0;const _0x48b924=_0x314f0f['product_details'][_0x196f27(0x13a)](_0x1ac96c=>{var _0x6125e2=_0x196f27;_0x1ac96c[_0x6125e2(0xe0)]==_0x51a153[_0x6125e2(0xe0)]&&_0x1ac96c[_0x6125e2(0x16b)]==_0x51a153['to_bay']&&(_0x1ac96c['product_stock']=parseInt(_0x1ac96c[_0x6125e2(0x165)])+parseInt(_0x51a153[_0x6125e2(0x14f)]),_0x214663++);});_0x214663=='0'&&(_0x314f0f[_0x196f27(0xfd)]=_0x314f0f['product_details'][_0x196f27(0x141)]({'product_name':_0x51a153[_0x196f27(0xe0)],'product_stock':_0x51a153['to_quantity'],'bay':_0x51a153[_0x196f27(0x12d)],'product_code':_0x51a153['product_code'],'primary_code':_0x51a153[_0x196f27(0xbc)],'secondary_code':_0x51a153[_0x196f27(0x167)],'maxProducts':_0x51a153[_0x196f27(0x115)]}));}}),await _0x314f0f[_0x381512(0x157)](),_0x244a56[_0x381512(0x153)](_0x381512(0xff),'Transfer\x20Edit\x20Successfully'),_0x46358f[_0x381512(0x103)](_0x381512(0xd1));}catch(_0x5438dd){console[_0x381512(0x137)](_0x5438dd);}}),router[a0_0x90adfa(0x15a)](a0_0x90adfa(0x11d),async(_0x3d1dad,_0x298a6b)=>{var _0x13442a=a0_0x90adfa;const {FromWareHouse:_0xc541f4,FromRoom:_0x165465,ToWarehouse:_0x2f4c8f,ToRoom:_0x4cb042,primary_code:_0x3e38b3,Roomslist:_0x6db7a1}=_0x3d1dad[_0x13442a(0x118)],_0x298be1=_0x6db7a1[_0x13442a(0x146)](','),_0x4e6848=[];async function _0x27acb6(_0x21763b){var _0xde5526=_0x13442a;const _0x292a07=await warehouse[_0xde5526(0x126)]([{'$match':{'name':_0xc541f4,'room':_0x21763b}},{'$unwind':_0xde5526(0x15b)},{'$match':{'product_details.primary_code':_0x3e38b3}},{'$group':{'_id':_0xde5526(0xd8),'name':{'$first':_0xde5526(0x130)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xde5526(0xc2)},'bay':{'$first':_0xde5526(0x15d)},'level':{'$first':'$product_details.level'},'type':{'$first':_0xde5526(0x111)},'pallet':{'$first':_0xde5526(0x10c)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xde5526(0x107)},'storage':{'$first':_0xde5526(0x108)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xde5526(0x12b)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xde5526(0xe4)},'maxPerUnit':{'$first':_0xde5526(0xf1)},'roomNamed':{'$first':_0xde5526(0x147)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0xde5526(0xf6)}}}]),_0x52c5fd=await warehouse['aggregate']([{'$match':{'name':_0xc541f4,'room':_0x21763b}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3e38b3}},{'$group':{'_id':_0xde5526(0xd8),'name':{'$first':_0xde5526(0x130)},'instock':{'$first':_0xde5526(0xd3)},'primary_code':{'$first':_0xde5526(0xdf)},'secondary_code':{'$first':_0xde5526(0x134)},'product_code':{'$first':_0xde5526(0xc2)},'bay':{'$first':_0xde5526(0x15d)},'level':{'$first':_0xde5526(0x128)},'type':{'$first':_0xde5526(0x111)},'pallet':{'$first':_0xde5526(0x10c)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xde5526(0x107)},'storage':{'$first':_0xde5526(0x108)},'rack':{'$first':_0xde5526(0x11a)},'expiry_date':{'$first':_0xde5526(0x12b)},'production_date':{'$first':_0xde5526(0x133)},'batch_code':{'$first':_0xde5526(0xe4)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0xde5526(0x147)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0xde5526(0xf6)}}}]);if(_0x292a07['length']>0x0)_0x4e6848[_0xde5526(0xdd)](_0x292a07);else _0x52c5fd['length']>0x0&&_0x4e6848[_0xde5526(0xdd)](_0x52c5fd);}const _0x1c46dd=_0x298be1[_0x13442a(0x13a)](_0x3abb4b=>_0x27acb6(_0x3abb4b));await Promise[_0x13442a(0x152)](_0x1c46dd),_0x298a6b[_0x13442a(0xd6)](_0x4e6848);}),router[a0_0x90adfa(0x15a)]('/CheckingWarehouse',async(_0x409c6a,_0x5b40b1)=>{var _0x3b4ce3=a0_0x90adfa;const {productCode:_0x2e9413,bay:_0x512c6d,warehouses:_0x6730e8,room:_0x286019}=_0x409c6a[_0x3b4ce3(0x118)];console[_0x3b4ce3(0x137)](_0x409c6a['body']);try{const _0x300c00=await warehouse[_0x3b4ce3(0x126)]([{'$match':{'name':_0x6730e8,'room':_0x286019}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x512c6d)}},{'$group':{'_id':_0x3b4ce3(0xd8),'name':{'$first':_0x3b4ce3(0x130)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3b4ce3(0x15d)},'maxProducts':{'$first':_0x3b4ce3(0x119)}}}]);_0x5b40b1['status'](0xc8)[_0x3b4ce3(0xd6)](_0x300c00);}catch(_0x458cbf){_0x5b40b1[_0x3b4ce3(0x143)](0x194)[_0x3b4ce3(0xd6)]({'message':_0x458cbf[_0x3b4ce3(0x148)]});}}),module['exports']=router;