var a0_0x222e33=a0_0x57aa;function a0_0x534d(){var _0x1a3ad9=['from_prod_qty','TRFF-','<tr>','location2location','concat','$to_warehouse','</td>','findById','$product_details.secondary_unit','language','staff','$product_details','$product_details.storage','/view/:id','Chinese','primary_unit','../middleware/auth','Product\x20Transfer\x20successfully','from_bay','$product_details._id','MaxStocks_data','../models/all_models','An\x20error\x20occurred.','product_code','DRY\x20GOODS','product_details','English\x20(US)','production_date','To_invoice','Portuguese\x20(BR)','Rack\x201','Enclosed','$name','Portuguese','$product_details.floorlevel','697235EWjGez','type_of_process','/CheckingWarehouse','role','$finalize','/view/add_transfer','catch','from_warehouse','length','An\x20error\x20occurred\x20while\x20saving\x20data.','push','$product_details.secondary_code','redirect','from_quantity','getDate','</tr>','own','from_prod_level','Arabic','Finished\x20Goods','31234joXPXS','TRF-','$product_details.maxProducts','Hindi','get','error','batch_code','find','LOG-TRF-','transfer_finished_logs','success','product','flash','warehouse','$product_details.invoice','$from_warehouse','to_floorlevel','getMonth','$product_details.product_stock','111847RKnwJv','51CuWCdb','ToRoomAssigned','save','/transfer_finished/view','There\x27s\x20a\x20error\x20in\x20this\x20transaction','padStart','toString','prod_cat','$product_details.level','/view/add_transfer_logs','German','note','French','maxProducts','message','\x20<=>\x20','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','post','$product.from_room_name','$product_details.expiry_date','/preview/:id','/barcode_scanner','abs','split','getFullYear','maxPerUnit','nodemailer','from_level','transfer_finished','$room','email','match','expiry_date','here2','RoomAssigned','primary_code','from_room_name','$product_details.production_date','from_room','/transfer/view','exports','forEach','$product_details.bay','713118ZdCnOM','to_quantity','$product_details.product_name','json','English','$_id','Transfer\x20Finalize\x20Successfully','Rack\x202','to_room','render','bin2bin','prod_name','from_invoice','log','max','from_prod_level2','aggregate','back','filter','$product_details.product_code','choos_transfer','errors','secondary_unit','body','3009160dBomxX','$product_details.rack','New_Qty_Converted','edit_transfer_finished_view','$invoice','$product_details.bin','unit','$product_details.unit','to_warehouse','Enabled','11574VmPkxh','express','$product','invoice_init','logs','random','$product_details.primary_code','Arabic\x20(ae)','../public/language/languages.json','all','map','True','_id','186796qKPGTF','product_date','MaxStocks_data2','10BAEJPg','to_prod_qty','/transfer_finished/preview/','then','user','edit_transfer_finished','params','to_prod_level','/view/addlog','id_transaction','string','$date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.maxPerUnit','$product_details.type','to_room_name','1416zWVUdq','product_name','date','floor','slice','$product_details.batch_code','findOne','secondary_code','Transfer\x20Edit\x20Successfully','to_level','bay','Spanish','product_stock','product_code3','invoice','finalize','status','to_bay','$product.to_room_name'];a0_0x534d=function(){return _0x1a3ad9;};return a0_0x534d();}(function(_0x50b96d,_0x3b2f3f){var _0xbc7482=a0_0x57aa,_0x197717=_0x50b96d();while(!![]){try{var _0x44e26f=-parseInt(_0xbc7482(0x1df))/0x1+-parseInt(_0xbc7482(0x1cc))/0x2*(-parseInt(_0xbc7482(0x1e0))/0x3)+parseInt(_0xbc7482(0x23a))/0x4+-parseInt(_0xbc7482(0x23d))/0x5*(parseInt(_0xbc7482(0x20b))/0x6)+parseInt(_0xbc7482(0x1b8))/0x7+parseInt(_0xbc7482(0x24d))/0x8*(-parseInt(_0xbc7482(0x22d))/0x9)+parseInt(_0xbc7482(0x223))/0xa;if(_0x44e26f===_0x3b2f3f)break;else _0x197717['push'](_0x197717['shift']());}catch(_0x3fc657){_0x197717['push'](_0x197717['shift']());}}}(a0_0x534d,0x2116e));const express=require(a0_0x222e33(0x22e)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x222e33(0x275)),auth=require(a0_0x222e33(0x270)),users=require(a0_0x222e33(0x235)),nodemailer=require(a0_0x222e33(0x1fa));function a0_0x57aa(_0x163d4e,_0x233759){var _0x534d38=a0_0x534d();return a0_0x57aa=function(_0x57aa95,_0xf3c82c){_0x57aa95=_0x57aa95-0x1b0;var _0x5df507=_0x534d38[_0x57aa95];return _0x5df507;},a0_0x57aa(_0x163d4e,_0x233759);}router[a0_0x222e33(0x1d0)]('/view',auth,async(_0x449cb3,_0x1b0ba9)=>{var _0x11567d=a0_0x222e33;try{const {username:_0x4909fa,email:_0x30e9fa,role:_0x3b089b}=_0x449cb3[_0x11567d(0x241)],_0x5e1fd2=_0x449cb3[_0x11567d(0x241)],_0x59a4fa=await profile[_0x11567d(0x253)]({'email':_0x5e1fd2[_0x11567d(0x1fe)]}),_0x11f8cd=await master_shop['find']();let _0x4d82ff;if(_0x5e1fd2[_0x11567d(0x1bb)]==_0x11567d(0x26a)){const _0x43ccfd=await staff[_0x11567d(0x253)]({'email':_0x5e1fd2[_0x11567d(0x1fe)]});_0x4d82ff=await transfers_finished['find']({'from_warehouse':_0x43ccfd[_0x11567d(0x1d9)]});}else _0x4d82ff=await transfers_finished[_0x11567d(0x21b)]([{'$match':{'type_of_transaction':_0x11567d(0x1c8)}},{'$unwind':_0x11567d(0x22f)},{'$group':{'_id':_0x11567d(0x210),'invoice':{'$first':_0x11567d(0x227)},'date':{'$first':_0x11567d(0x248)},'from_warehouse':{'$first':_0x11567d(0x1db)},'to_warehouse':{'$first':_0x11567d(0x265)},'from_room_name':{'$addToSet':_0x11567d(0x1f2)},'to_room_name':{'$addToSet':_0x11567d(0x25f)},'finalize':{'$first':_0x11567d(0x1bc)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x11f8cd[0x0][_0x11567d(0x269)]==_0x11567d(0x27a))var _0x397119=users['English'];else{if(_0x11f8cd[0x0][_0x11567d(0x269)]==_0x11567d(0x1cf))var _0x397119=users['Hindi'];else{if(_0x11f8cd[0x0][_0x11567d(0x269)]=='German')var _0x397119=users[_0x11567d(0x1ea)];else{if(_0x11f8cd[0x0][_0x11567d(0x269)]==_0x11567d(0x258))var _0x397119=users['Spanish'];else{if(_0x11f8cd[0x0][_0x11567d(0x269)]==_0x11567d(0x1ec))var _0x397119=users[_0x11567d(0x1ec)];else{if(_0x11f8cd[0x0][_0x11567d(0x269)]==_0x11567d(0x1b2))var _0x397119=users[_0x11567d(0x1b6)];else{if(_0x11f8cd[0x0][_0x11567d(0x269)]==_0x11567d(0x26e))var _0x397119=users['Chinese'];else{if(_0x11f8cd[0x0]['language']==_0x11567d(0x234))var _0x397119=users[_0x11567d(0x1ca)];}}}}}}}_0x1b0ba9[_0x11567d(0x214)](_0x11567d(0x1fc),{'success':_0x449cb3[_0x11567d(0x1d8)](_0x11567d(0x1d6)),'errors':_0x449cb3[_0x11567d(0x1d8)](_0x11567d(0x220)),'role':_0x5e1fd2,'profile':_0x59a4fa,'master_shop':_0x11f8cd,'transfer':_0x4d82ff,'language':_0x397119});}catch(_0x1b4e30){console[_0x11567d(0x218)](_0x1b4e30);}}),router[a0_0x222e33(0x1d0)]('/view_logs',auth,async(_0x55bde4,_0x3ad4c0)=>{var _0x1a1968=a0_0x222e33;try{const {username:_0x53aa7c,email:_0x1ff330,role:_0x174f54}=_0x55bde4[_0x1a1968(0x241)],_0x378034=_0x55bde4[_0x1a1968(0x241)],_0x2780af=await profile[_0x1a1968(0x253)]({'email':_0x378034[_0x1a1968(0x1fe)]}),_0x11dc9c=await master_shop[_0x1a1968(0x1d3)]();let _0x60a483;if(_0x378034[_0x1a1968(0x1bb)]==_0x1a1968(0x26a)){const _0x1ab75b=await staff['findOne']({'email':_0x378034[_0x1a1968(0x1fe)]});_0x60a483=await transfers_finished[_0x1a1968(0x1d3)]({'from_warehouse':_0x1ab75b['warehouse']});}else _0x60a483=await transfers_finished[_0x1a1968(0x21b)]([{'$match':{'type_of_transaction':_0x1a1968(0x231)}},{'$unwind':_0x1a1968(0x22f)},{'$group':{'_id':_0x1a1968(0x210),'invoice':{'$first':'$invoice'},'date':{'$first':_0x1a1968(0x248)},'from_warehouse':{'$first':_0x1a1968(0x1db)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x1a1968(0x1f2)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x1a1968(0x1bc)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x11dc9c[0x0][_0x1a1968(0x269)]==_0x1a1968(0x27a))var _0x27ed67=users['English'];else{if(_0x11dc9c[0x0][_0x1a1968(0x269)]==_0x1a1968(0x1cf))var _0x27ed67=users[_0x1a1968(0x1cf)];else{if(_0x11dc9c[0x0][_0x1a1968(0x269)]==_0x1a1968(0x1ea))var _0x27ed67=users[_0x1a1968(0x1ea)];else{if(_0x11dc9c[0x0][_0x1a1968(0x269)]==_0x1a1968(0x258))var _0x27ed67=users['Spanish'];else{if(_0x11dc9c[0x0]['language']==_0x1a1968(0x1ec))var _0x27ed67=users['French'];else{if(_0x11dc9c[0x0][_0x1a1968(0x269)]=='Portuguese\x20(BR)')var _0x27ed67=users['Portuguese'];else{if(_0x11dc9c[0x0][_0x1a1968(0x269)]==_0x1a1968(0x26e))var _0x27ed67=users[_0x1a1968(0x26e)];else{if(_0x11dc9c[0x0][_0x1a1968(0x269)]==_0x1a1968(0x234))var _0x27ed67=users['Arabic'];}}}}}}}_0x3ad4c0[_0x1a1968(0x214)](_0x1a1968(0x1d5),{'success':_0x55bde4[_0x1a1968(0x1d8)](_0x1a1968(0x1d6)),'errors':_0x55bde4[_0x1a1968(0x1d8)]('errors'),'role':_0x378034,'profile':_0x2780af,'master_shop':_0x11dc9c,'transfer':_0x60a483,'language':_0x27ed67});}catch(_0x11b04a){console[_0x1a1968(0x218)](_0x11b04a);}});async function getRandom8DigitNumber(){var _0x87f82b=a0_0x222e33;const _0x4341da=0x989680,_0x1278b4=0x5f5e0ff,_0x35388b=Math[_0x87f82b(0x250)](Math[_0x87f82b(0x232)]()*(_0x1278b4-_0x4341da+0x1))+_0x4341da;var _0x18d3cc;const _0x42fb51=await transfers_finished[_0x87f82b(0x253)]({'invoice':_0x87f82b(0x261)+_0x35388b});return _0x42fb51&&_0x42fb51['length']>0x0?_0x18d3cc=_0x87f82b(0x261)+_0x35388b:_0x18d3cc=_0x87f82b(0x261)+_0x35388b,_0x18d3cc;}router[a0_0x222e33(0x1d0)]('/view/add_transfer',auth,async(_0x207308,_0x3a2379)=>{var _0x520743=a0_0x222e33;try{const {username:_0x39e690,email:_0x149477,role:_0x4cf950}=_0x207308[_0x520743(0x241)],_0x2b5ac7=_0x207308[_0x520743(0x241)],_0x397fab=await profile[_0x520743(0x253)]({'email':_0x2b5ac7['email']}),_0x55314c=await master_shop[_0x520743(0x1d3)]();let _0x325d4b;if(_0x2b5ac7['role']==_0x520743(0x26a)){const _0x434408=await staff[_0x520743(0x253)]({'email':_0x2b5ac7[_0x520743(0x1fe)]});_0x325d4b=await warehouse[_0x520743(0x21b)]([{'$match':{'status':_0x520743(0x22c),'name':_0x434408[_0x520743(0x1d9)]}},{'$group':{'_id':_0x520743(0x1b5),'name':{'$first':_0x520743(0x1b5)}}}]);}else _0x325d4b=await warehouse['aggregate']([{'$match':{'status':_0x520743(0x22c)}},{'$group':{'_id':_0x520743(0x1b5),'name':{'$first':_0x520743(0x1b5)}}}]);const _0x243092=await transfers_finished['find']({}),_0x327f6f=_0x243092['length']+0x1,_0x489824=_0x520743(0x261)+_0x327f6f[_0x520743(0x1e6)]()[_0x520743(0x1e5)](0x5,'0');if(_0x55314c[0x0]['language']==_0x520743(0x27a))var _0x267152=users[_0x520743(0x20f)];else{if(_0x55314c[0x0][_0x520743(0x269)]=='Hindi')var _0x267152=users[_0x520743(0x1cf)];else{if(_0x55314c[0x0]['language']==_0x520743(0x1ea))var _0x267152=users[_0x520743(0x1ea)];else{if(_0x55314c[0x0][_0x520743(0x269)]==_0x520743(0x258))var _0x267152=users[_0x520743(0x258)];else{if(_0x55314c[0x0]['language']==_0x520743(0x1ec))var _0x267152=users['French'];else{if(_0x55314c[0x0][_0x520743(0x269)]==_0x520743(0x1b2))var _0x267152=users[_0x520743(0x1b6)];else{if(_0x55314c[0x0][_0x520743(0x269)]==_0x520743(0x26e))var _0x267152=users[_0x520743(0x26e)];else{if(_0x55314c[0x0]['language']=='Arabic\x20(ae)')var _0x267152=users[_0x520743(0x1ca)];}}}}}}}const _0x14c29c=getRandom8DigitNumber();_0x14c29c[_0x520743(0x240)](_0x3b3d85=>{var _0x58e714=_0x520743;_0x3a2379[_0x58e714(0x214)]('add_transfer_finished',{'success':_0x207308[_0x58e714(0x1d8)](_0x58e714(0x1d6)),'errors':_0x207308[_0x58e714(0x1d8)](_0x58e714(0x220)),'role':_0x2b5ac7,'profile':_0x397fab,'master_shop':_0x55314c,'warehouse':_0x325d4b,'language':_0x267152,'invoice':_0x3b3d85});})['catch'](_0x4c48fd=>{var _0x2266ae=_0x520743;_0x207308[_0x2266ae(0x1d8)](_0x2266ae(0x220),_0x2266ae(0x1e4)),_0x3a2379[_0x2266ae(0x1c4)](_0x2266ae(0x207));});}catch(_0x37e4b7){console['log'](_0x37e4b7);}}),router[a0_0x222e33(0x1d0)]('/view/choose',auth,async(_0x344401,_0x3c048d)=>{var _0x2fb382=a0_0x222e33;try{const {username:_0x1fe975,email:_0x3ec4b2,role:_0x468662}=_0x344401[_0x2fb382(0x241)],_0x524528=_0x344401[_0x2fb382(0x241)],_0x52d323=await profile['findOne']({'email':_0x524528[_0x2fb382(0x1fe)]}),_0x10681f=await master_shop[_0x2fb382(0x1d3)]();let _0x1be7cb;if(_0x524528[_0x2fb382(0x1bb)]==_0x2fb382(0x26a)){const _0x2aad15=await staff[_0x2fb382(0x253)]({'email':_0x524528['email']});_0x1be7cb=await warehouse[_0x2fb382(0x21b)]([{'$match':{'status':_0x2fb382(0x22c),'name':_0x2aad15[_0x2fb382(0x1d9)]}},{'$group':{'_id':_0x2fb382(0x1b5),'name':{'$first':_0x2fb382(0x1b5)}}}]);}else _0x1be7cb=await warehouse[_0x2fb382(0x21b)]([{'$match':{'status':_0x2fb382(0x22c)}},{'$group':{'_id':_0x2fb382(0x1b5),'name':{'$first':_0x2fb382(0x1b5)}}}]);const _0x4681bf=await transfers_finished[_0x2fb382(0x1d3)]({}),_0x2a6a95=_0x4681bf[_0x2fb382(0x1c0)]+0x1,_0xc8bc42=_0x2fb382(0x261)+_0x2a6a95[_0x2fb382(0x1e6)]()[_0x2fb382(0x1e5)](0x5,'0');if(_0x10681f[0x0][_0x2fb382(0x269)]==_0x2fb382(0x27a))var _0x3efe5c=users[_0x2fb382(0x20f)];else{if(_0x10681f[0x0][_0x2fb382(0x269)]==_0x2fb382(0x1cf))var _0x3efe5c=users['Hindi'];else{if(_0x10681f[0x0][_0x2fb382(0x269)]==_0x2fb382(0x1ea))var _0x3efe5c=users[_0x2fb382(0x1ea)];else{if(_0x10681f[0x0][_0x2fb382(0x269)]==_0x2fb382(0x258))var _0x3efe5c=users[_0x2fb382(0x258)];else{if(_0x10681f[0x0][_0x2fb382(0x269)]==_0x2fb382(0x1ec))var _0x3efe5c=users[_0x2fb382(0x1ec)];else{if(_0x10681f[0x0][_0x2fb382(0x269)]==_0x2fb382(0x1b2))var _0x3efe5c=users[_0x2fb382(0x1b6)];else{if(_0x10681f[0x0][_0x2fb382(0x269)]==_0x2fb382(0x26e))var _0x3efe5c=users[_0x2fb382(0x26e)];else{if(_0x10681f[0x0][_0x2fb382(0x269)]==_0x2fb382(0x234))var _0x3efe5c=users[_0x2fb382(0x1ca)];}}}}}}}const _0x2e3954=getRandom8DigitNumber();_0x2e3954[_0x2fb382(0x240)](_0x574791=>{var _0x1b4874=_0x2fb382;_0x3c048d['render'](_0x1b4874(0x21f),{'success':_0x344401[_0x1b4874(0x1d8)](_0x1b4874(0x1d6)),'errors':_0x344401[_0x1b4874(0x1d8)](_0x1b4874(0x220)),'role':_0x524528,'profile':_0x52d323,'master_shop':_0x10681f,'warehouse':_0x1be7cb,'language':_0x3efe5c,'invoice':_0x574791});})['catch'](_0x138c83=>{var _0x6033da=_0x2fb382;_0x344401[_0x6033da(0x1d8)](_0x6033da(0x220),_0x6033da(0x1e4)),_0x3c048d['redirect']('/transfer/view');});}catch(_0x497dea){console[_0x2fb382(0x218)](_0x497dea);}}),router[a0_0x222e33(0x1d0)]('/view/choose_logs',auth,async(_0x468043,_0x1077fb)=>{var _0x1bfe5d=a0_0x222e33;try{const {username:_0x16e922,email:_0x5cd79f,role:_0x1bea84}=_0x468043['user'],_0x3d19dc=_0x468043[_0x1bfe5d(0x241)],_0x476e22=await profile[_0x1bfe5d(0x253)]({'email':_0x3d19dc['email']}),_0x29ea7e=await master_shop['find']();let _0x1e2284;if(_0x3d19dc[_0x1bfe5d(0x1bb)]=='staff'){const _0x192258=await staff['findOne']({'email':_0x3d19dc[_0x1bfe5d(0x1fe)]});_0x1e2284=await warehouse[_0x1bfe5d(0x21b)]([{'$match':{'status':_0x1bfe5d(0x22c),'name':_0x192258['warehouse']}},{'$group':{'_id':_0x1bfe5d(0x1b5),'name':{'$first':_0x1bfe5d(0x1b5)}}}]);}else _0x1e2284=await warehouse[_0x1bfe5d(0x21b)]([{'$match':{'status':_0x1bfe5d(0x22c)}},{'$group':{'_id':_0x1bfe5d(0x1b5),'name':{'$first':_0x1bfe5d(0x1b5)}}}]);const _0x370ddb=await transfers_finished[_0x1bfe5d(0x1d3)]({}),_0x5c8522=_0x370ddb['length']+0x1,_0x207054='TRFF-'+_0x5c8522[_0x1bfe5d(0x1e6)]()[_0x1bfe5d(0x1e5)](0x5,'0');if(_0x29ea7e[0x0][_0x1bfe5d(0x269)]==_0x1bfe5d(0x27a))var _0x4a3b13=users[_0x1bfe5d(0x20f)];else{if(_0x29ea7e[0x0][_0x1bfe5d(0x269)]==_0x1bfe5d(0x1cf))var _0x4a3b13=users[_0x1bfe5d(0x1cf)];else{if(_0x29ea7e[0x0][_0x1bfe5d(0x269)]=='German')var _0x4a3b13=users[_0x1bfe5d(0x1ea)];else{if(_0x29ea7e[0x0][_0x1bfe5d(0x269)]=='Spanish')var _0x4a3b13=users[_0x1bfe5d(0x258)];else{if(_0x29ea7e[0x0][_0x1bfe5d(0x269)]=='French')var _0x4a3b13=users[_0x1bfe5d(0x1ec)];else{if(_0x29ea7e[0x0][_0x1bfe5d(0x269)]=='Portuguese\x20(BR)')var _0x4a3b13=users[_0x1bfe5d(0x1b6)];else{if(_0x29ea7e[0x0][_0x1bfe5d(0x269)]=='Chinese')var _0x4a3b13=users[_0x1bfe5d(0x26e)];else{if(_0x29ea7e[0x0][_0x1bfe5d(0x269)]=='Arabic\x20(ae)')var _0x4a3b13=users[_0x1bfe5d(0x1ca)];}}}}}}}const _0xae7ec=getRandom8DigitNumber();_0xae7ec[_0x1bfe5d(0x240)](_0x3886af=>{var _0x461ae8=_0x1bfe5d;_0x1077fb[_0x461ae8(0x214)]('choos_transfer_logs',{'success':_0x468043[_0x461ae8(0x1d8)](_0x461ae8(0x1d6)),'errors':_0x468043[_0x461ae8(0x1d8)](_0x461ae8(0x220)),'role':_0x3d19dc,'profile':_0x476e22,'master_shop':_0x29ea7e,'warehouse':_0x1e2284,'language':_0x4a3b13,'invoice':_0x3886af});})['catch'](_0x3ef72b=>{var _0x3c5e94=_0x1bfe5d;_0x468043[_0x3c5e94(0x1d8)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1077fb[_0x3c5e94(0x1c4)](_0x3c5e94(0x207));});}catch(_0x3424d6){console[_0x1bfe5d(0x218)](_0x3424d6);}}),router[a0_0x222e33(0x1f1)](a0_0x222e33(0x1e9),auth,async(_0x30122c,_0x27f49a)=>{var _0xe1cc3b=a0_0x222e33;try{const {date:_0x5a811d,from_warehouse:_0x5ed66b,FromRoom_name:_0x36af26,to_warehouse:_0x2cdf28,ToRoom_name:_0x85ff0,prod_name:_0x46f55d,from_prod_qty:_0x3bec64,from_prod_level:_0x3bf7e4,from_prod_isle:_0x5b3952,from_prod_pallet:_0x4541c3,to_prod_qty:_0x39ac9a,to_prod_level:_0x48d6e2,to_prod_isle:_0x215c87,to_prod_pallet:_0x4bffca,primary_code:_0x481d70,secondary_code:_0x303a7c,product_code3:_0x4216ad,note:_0xf0762c,MaxStocks_data2:_0x26abc9,invoice:_0x542681,expiry_date:_0x2d29dd,PO_number:_0x2a9b82,ReqBy:_0x40af8d,dateofreq:_0x45220f,typeservicesData:_0x3584b2,destination:_0x1fd090,deliverydate:_0x3c2cdb,driver:_0x30c66d,plate:_0x386316,van:_0x2e146b,DRSI:_0x351446,typevehicle:_0x51f03d,TSU:_0x2ea1aa,TFU:_0x377931}=_0x30122c[_0xe1cc3b(0x222)];if(typeof _0x46f55d=='string')var _0x1a3398=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x216)]],_0x15ea53=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x260)]],_0x45a828=[_0x30122c['body']['from_prod_level2']],_0x49d388=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x225)]],_0x5da6f2=[_0x30122c[_0xe1cc3b(0x222)]['to_prod_level']],_0x1f1e05=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x203)]],_0x136e81=[_0x30122c['body'][_0xe1cc3b(0x254)]],_0xc3c2b2=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x25a)]],_0x5c796f=[_0x30122c[_0xe1cc3b(0x222)]['MaxStocks_data2']],_0x13576c=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x26f)]],_0x6dd12a=[_0x30122c[_0xe1cc3b(0x222)]['secondary_unit']],_0x310808=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x1d2)]],_0x42e337=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x200)]],_0x707f5d=[_0x30122c[_0xe1cc3b(0x222)]['product_date']],_0x52993e=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x274)]],_0x18f416=[_0x30122c[_0xe1cc3b(0x222)]['maxPerUnit']],_0x26b770=[_0x30122c['body'][_0xe1cc3b(0x1e7)]],_0x328cfd=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x202)]],_0x2071b0=[_0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x1e1)]],_0x540b07=[_0x30122c['body'][_0xe1cc3b(0x217)]],_0x18513b=[_0x30122c[_0xe1cc3b(0x222)]['id_transaction']];else var _0x1a3398=[..._0x30122c[_0xe1cc3b(0x222)]['prod_name']],_0x15ea53=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x260)]],_0x45a828=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x21a)]],_0x49d388=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x225)]],_0x5da6f2=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x244)]],_0x1f1e05=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x203)]],_0x136e81=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x254)]],_0xc3c2b2=[..._0x30122c[_0xe1cc3b(0x222)]['product_code3']],_0x5c796f=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x23c)]],_0x13576c=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x26f)]],_0x6dd12a=[..._0x30122c[_0xe1cc3b(0x222)]['secondary_unit']],_0x310808=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x1d2)]],_0x42e337=[..._0x30122c['body'][_0xe1cc3b(0x200)]],_0x707f5d=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x23b)]],_0x52993e=[..._0x30122c[_0xe1cc3b(0x222)]['MaxStocks_data']],_0x18f416=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x1f9)]],_0x26b770=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x1e7)]],_0x328cfd=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x202)]],_0x2071b0=[..._0x30122c[_0xe1cc3b(0x222)][_0xe1cc3b(0x1e1)]],_0x540b07=[..._0x30122c['body'][_0xe1cc3b(0x217)]],_0x18513b=[..._0x30122c['body'][_0xe1cc3b(0x246)]];const _0xbe4d9b=_0x1a3398[_0xe1cc3b(0x237)](_0x2f83e8=>{return _0x2f83e8={'product_name':_0x2f83e8};});_0x15ea53['forEach']((_0x4e8ae8,_0x211fd2)=>{_0xbe4d9b[_0x211fd2]['from_quantity']=_0x4e8ae8;}),_0x45a828[_0xe1cc3b(0x209)]((_0x4a3764,_0x3590d8)=>{var _0x2eafb7=_0xe1cc3b,_0x18fab3=_0x4a3764['match'](/[A-Za-z]+/)[0x0],_0x99cfc6=parseInt(_0x4a3764[_0x2eafb7(0x1ff)](/\d+/)[0x0]);_0xbe4d9b[_0x3590d8][_0x2eafb7(0x272)]=_0x99cfc6,_0xbe4d9b[_0x3590d8][_0x2eafb7(0x1fb)]=_0x18fab3;}),_0x18513b[_0xe1cc3b(0x209)]((_0x12747d,_0x5dc0a8)=>{var _0x241c97=_0xe1cc3b;_0xbe4d9b[_0x5dc0a8][_0x241c97(0x246)]=_0x12747d;}),_0x540b07[_0xe1cc3b(0x209)]((_0x451342,_0xc5f5f6)=>{_0xbe4d9b[_0xc5f5f6]['from_invoice']=_0x451342;}),_0x49d388[_0xe1cc3b(0x209)]((_0x12f55c,_0x1ec024)=>{var _0x4469f0=_0xe1cc3b;_0xbe4d9b[_0x1ec024][_0x4469f0(0x20c)]=_0x12f55c;}),_0x5da6f2[_0xe1cc3b(0x209)]((_0x327ff8,_0x3fb156)=>{var _0x939919=_0xe1cc3b,_0x2a6bd7=_0x327ff8[_0x939919(0x1ff)](/[A-Za-z]+/)[0x0],_0x816260=parseInt(_0x327ff8[_0x939919(0x1ff)](/\d+/)[0x0]);_0xbe4d9b[_0x3fb156][_0x939919(0x256)]=_0x2a6bd7,_0xbe4d9b[_0x3fb156][_0x939919(0x25e)]=_0x816260;}),_0x1f1e05['forEach']((_0x3ecb0a,_0x1c70dc)=>{var _0x19aefc=_0xe1cc3b;_0xbe4d9b[_0x1c70dc][_0x19aefc(0x203)]=_0x3ecb0a;}),_0x136e81[_0xe1cc3b(0x209)]((_0x2557a3,_0x13e0aa)=>{var _0xb97e1a=_0xe1cc3b;_0xbe4d9b[_0x13e0aa][_0xb97e1a(0x254)]=_0x2557a3;}),_0xc3c2b2[_0xe1cc3b(0x209)]((_0x114d56,_0x2d9a8d)=>{_0xbe4d9b[_0x2d9a8d]['product_code']=_0x114d56;}),_0x5c796f[_0xe1cc3b(0x209)]((_0x3d3ec6,_0x4f984b)=>{var _0x417f17=_0xe1cc3b;_0xbe4d9b[_0x4f984b][_0x417f17(0x1ed)]=_0x3d3ec6;}),_0x13576c[_0xe1cc3b(0x209)]((_0x5250ae,_0x295426)=>{var _0x349d46=_0xe1cc3b;_0xbe4d9b[_0x295426][_0x349d46(0x229)]=_0x5250ae;}),_0x6dd12a['forEach']((_0x44df52,_0x2bfe59)=>{var _0x549d45=_0xe1cc3b;_0xbe4d9b[_0x2bfe59][_0x549d45(0x221)]=_0x44df52;}),_0x310808[_0xe1cc3b(0x209)]((_0x3b0868,_0x180259)=>{var _0x1e7b3d=_0xe1cc3b;_0xbe4d9b[_0x180259][_0x1e7b3d(0x1d2)]=_0x3b0868;}),_0x42e337[_0xe1cc3b(0x209)]((_0x2c74be,_0x397286)=>{var _0x407fe4=_0xe1cc3b;_0xbe4d9b[_0x397286][_0x407fe4(0x200)]=_0x2c74be;}),_0x707f5d['forEach']((_0x517edb,_0x3854be)=>{var _0xa70fe6=_0xe1cc3b;_0xbe4d9b[_0x3854be][_0xa70fe6(0x1b0)]=_0x517edb;}),_0x52993e[_0xe1cc3b(0x209)]((_0x392bad,_0x44f3b4)=>{var _0x1f4c02=_0xe1cc3b;_0xbe4d9b[_0x44f3b4][_0x1f4c02(0x1ed)]=_0x392bad;}),_0x18f416[_0xe1cc3b(0x209)]((_0x47e44d,_0x3445d7)=>{var _0x407e82=_0xe1cc3b;_0xbe4d9b[_0x3445d7][_0x407e82(0x1f9)]=_0x47e44d;}),_0x26b770[_0xe1cc3b(0x209)]((_0x5b324e,_0x677216)=>{var _0xfcac9a=_0xe1cc3b;_0xbe4d9b[_0x677216][_0xfcac9a(0x1e7)]=_0x5b324e;}),_0x328cfd[_0xe1cc3b(0x209)]((_0x144799,_0xbf66b2)=>{var _0x109903=_0xe1cc3b;_0xbe4d9b[_0xbf66b2][_0x109903(0x204)]=_0x144799;}),_0x2071b0['forEach']((_0x1a9b50,_0x51cc90)=>{var _0x1ccd0f=_0xe1cc3b;_0xbe4d9b[_0x51cc90][_0x1ccd0f(0x24c)]=_0x1a9b50;});const _0x124ec6=_0xbe4d9b['filter'](_0x1a2a47=>_0x1a2a47['to_quantity']!=='0'&&_0x1a2a47[_0xe1cc3b(0x20c)]!==''||_0x1a2a47[_0xe1cc3b(0x1dc)]!=='0'&&_0x1a2a47[_0xe1cc3b(0x1dc)]!=='');var _0x5a73d2=0x0;_0x124ec6[_0xe1cc3b(0x209)](_0xa2e859=>{var _0x21cca9=_0xe1cc3b;parseInt(_0xa2e859[_0x21cca9(0x1c5)])<parseInt(_0xa2e859['to_quantity'])&&_0x5a73d2++;});if(_0x5a73d2!=0x0)return _0x30122c[_0xe1cc3b(0x1d8)](_0xe1cc3b(0x220),_0xe1cc3b(0x1f0)),_0x27f49a[_0xe1cc3b(0x1c4)]('back');const _0x498864=new transfers_logs();await _0x498864[_0xe1cc3b(0x1e2)]();for(let _0x218718=0x0;_0x218718<=_0x2071b0['length']-0x1;_0x218718++){_0xbe4d9b[_0x218718][_0xe1cc3b(0x1b1)]='LOG-TRF-'+_0x498864[_0xe1cc3b(0x230)]['toString']()['padStart'](0x8,'0');}const _0x100240=new transfers_finished({'date':_0x5a811d,'from_warehouse':_0x5ed66b,'to_warehouse':_0x5ed66b,'product':_0x124ec6,'note':_0xf0762c,'invoice':_0xe1cc3b(0x1d4)+_0x498864[_0xe1cc3b(0x230)][_0xe1cc3b(0x1e6)]()[_0xe1cc3b(0x1e5)](0x8,'0'),'type_of_process':_0xe1cc3b(0x215),'type_of_transaction':_0xe1cc3b(0x231),'PO_number':_0x2a9b82,'RequestedBy':_0x40af8d,'DateofRequest':_0x45220f,'typeservices':_0x3584b2,'destination':_0x1fd090,'deliverydate':_0x3c2cdb,'driver':_0x30c66d,'plate':_0x386316,'van':_0x2e146b,'DRSI':_0x351446,'typevehicle':_0x51f03d,'TSU':_0x2ea1aa,'TFU':_0x377931}),_0x2ab840=await _0x100240['save']();_0x30122c[_0xe1cc3b(0x1d8)](_0xe1cc3b(0x1d6),_0xe1cc3b(0x271)),_0x27f49a['redirect'](_0xe1cc3b(0x23f)+_0x2ab840[_0xe1cc3b(0x239)]);}catch(_0x29097c){console['log'](_0x29097c),_0x27f49a['status'](0xc8)[_0xe1cc3b(0x20e)]({'errorMessage':_0x29097c['message']});}}),router[a0_0x222e33(0x1f1)](a0_0x222e33(0x245),auth,async(_0x29c5e6,_0xfc351c)=>{var _0x38cb34=a0_0x222e33;try{const {date:_0x29b741,from_warehouse:_0x10a8ad,FromRoom_name:_0x2517aa,to_warehouse:_0x4b5e41,ToRoom_name:_0x351cf5,prod_name:_0x651e21,from_prod_qty:_0x3c9846,from_prod_level:_0x4f227c,from_prod_isle:_0x18712c,from_prod_pallet:_0x31ddcc,to_prod_qty:_0x4ebbf3,to_prod_level:_0x18cca0,to_prod_isle:_0x2b1861,to_prod_pallet:_0x2e06be,primary_code:_0x4e2124,secondary_code:_0x18285c,product_code3:_0xf01f00,note:_0x13e252,MaxStocks_data2:_0x13a911,invoice:_0x3f8d61,expiry_date:_0x1a85bc,PO_number_loc:_0x111546,ReqBy_loc:_0x659445,dateofreq_loc:_0x49e115,typeservices_loc_Data:_0x42bb90,destination_loc:_0x38a76e,deliverydate_loc:_0x24af08,driver_loc:_0x21abd7,plate_loc:_0x5af91d,van_loc:_0x523f79,DRSI_loc:_0x22af43,typevehicle_loc:_0x3654b2,TSU_loc:_0x1fd312,TFU_loc:_0xd2b4}=_0x29c5e6[_0x38cb34(0x222)];if(typeof _0x651e21=='string')var _0x44837f=[_0x29c5e6['body']['prod_name']],_0x5f5a17=[_0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x260)]],_0x4f73e9=[_0x29c5e6[_0x38cb34(0x222)]['from_prod_level2']],_0x3278bb=[_0x29c5e6['body']['New_Qty_Converted']],_0x779a2d=[_0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x244)]],_0x25e260=[_0x29c5e6[_0x38cb34(0x222)]['primary_code']],_0x4019cb=[_0x29c5e6['body'][_0x38cb34(0x254)]],_0x52f9c9=[_0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x25a)]],_0x4efb7f=[_0x29c5e6[_0x38cb34(0x222)]['MaxStocks_data2']],_0x3a00fc=[_0x29c5e6['body'][_0x38cb34(0x26f)]],_0x547796=[_0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x221)]],_0x3b9d89=[_0x29c5e6['body'][_0x38cb34(0x1d2)]],_0x4516c8=[_0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x200)]],_0x4a6d1e=[_0x29c5e6[_0x38cb34(0x222)]['product_date']],_0x8122b8=[_0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x274)]],_0x39b3e8=[_0x29c5e6['body'][_0x38cb34(0x1f9)]],_0x385b78=[_0x29c5e6['body']['prod_cat']],_0xa42691=[_0x29c5e6[_0x38cb34(0x222)]['RoomAssigned']],_0x541f1f=[_0x29c5e6['body'][_0x38cb34(0x1e1)]],_0x3febf5=[_0x29c5e6['body'][_0x38cb34(0x217)]],_0x321c1a=[_0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x246)]];else var _0x44837f=[..._0x29c5e6[_0x38cb34(0x222)]['prod_name']],_0x5f5a17=[..._0x29c5e6['body']['from_prod_qty']],_0x4f73e9=[..._0x29c5e6['body']['from_prod_level2']],_0x3278bb=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x225)]],_0x779a2d=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x244)]],_0x25e260=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x203)]],_0x4019cb=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x254)]],_0x52f9c9=[..._0x29c5e6[_0x38cb34(0x222)]['product_code3']],_0x4efb7f=[..._0x29c5e6['body'][_0x38cb34(0x23c)]],_0x3a00fc=[..._0x29c5e6['body'][_0x38cb34(0x26f)]],_0x547796=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x221)]],_0x3b9d89=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x1d2)]],_0x4516c8=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x200)]],_0x4a6d1e=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x23b)]],_0x8122b8=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x274)]],_0x39b3e8=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x1f9)]],_0x385b78=[..._0x29c5e6['body'][_0x38cb34(0x1e7)]],_0xa42691=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x202)]],_0x541f1f=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x1e1)]],_0x3febf5=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x217)]],_0x321c1a=[..._0x29c5e6[_0x38cb34(0x222)][_0x38cb34(0x246)]];const _0x4bc95=_0x44837f[_0x38cb34(0x237)](_0x3b351a=>{return _0x3b351a={'product_name':_0x3b351a};});_0x5f5a17['forEach']((_0x55ed1c,_0x23e20e)=>{var _0x442da4=_0x38cb34;_0x4bc95[_0x23e20e][_0x442da4(0x1c5)]=_0x55ed1c;}),_0x4f73e9[_0x38cb34(0x209)]((_0x48b364,_0x50d9ca)=>{var _0x1cb3dc=_0x38cb34,_0x4ba166=_0x48b364[_0x1cb3dc(0x1ff)](/[A-Za-z]+/)[0x0],_0x56ef3a=parseInt(_0x48b364[_0x1cb3dc(0x1ff)](/\d+/)[0x0]);_0x4bc95[_0x50d9ca]['from_bay']=_0x56ef3a,_0x4bc95[_0x50d9ca][_0x1cb3dc(0x1fb)]=_0x4ba166;}),_0x321c1a['forEach']((_0x3b3287,_0x4ed504)=>{_0x4bc95[_0x4ed504]['id_transaction']=_0x3b3287;}),_0x3febf5['forEach']((_0x1b95e3,_0x26ff4a)=>{_0x4bc95[_0x26ff4a]['from_invoice']=_0x1b95e3;}),_0x3278bb[_0x38cb34(0x209)]((_0x4b4737,_0x22d70b)=>{var _0x17c1e3=_0x38cb34;_0x4bc95[_0x22d70b][_0x17c1e3(0x20c)]=_0x4b4737;}),_0x779a2d[_0x38cb34(0x209)]((_0x212573,_0x50f15e)=>{var _0x445e28=_0x38cb34,_0x79bb61=_0x212573[_0x445e28(0x1ff)](/[A-Za-z]+/)[0x0],_0x61e989=parseInt(_0x212573[_0x445e28(0x1ff)](/\d+/)[0x0]);_0x4bc95[_0x50f15e][_0x445e28(0x256)]=_0x79bb61,_0x4bc95[_0x50f15e][_0x445e28(0x25e)]=_0x61e989;}),_0x25e260[_0x38cb34(0x209)]((_0x729adf,_0x27d30d)=>{_0x4bc95[_0x27d30d]['primary_code']=_0x729adf;}),_0x4019cb[_0x38cb34(0x209)]((_0x3e3d0c,_0x45d5b4)=>{_0x4bc95[_0x45d5b4]['secondary_code']=_0x3e3d0c;}),_0x52f9c9[_0x38cb34(0x209)]((_0x503831,_0x4caa33)=>{var _0x5ab181=_0x38cb34;_0x4bc95[_0x4caa33][_0x5ab181(0x277)]=_0x503831;}),_0x4efb7f[_0x38cb34(0x209)]((_0x3eb371,_0x2d4392)=>{var _0x58fda5=_0x38cb34;_0x4bc95[_0x2d4392][_0x58fda5(0x1ed)]=_0x3eb371;}),_0x3a00fc[_0x38cb34(0x209)]((_0x2a7833,_0x58fe8d)=>{var _0x4ba41d=_0x38cb34;_0x4bc95[_0x58fe8d][_0x4ba41d(0x229)]=_0x2a7833;}),_0x547796[_0x38cb34(0x209)]((_0x62d2d,_0x18f093)=>{var _0x2d5cec=_0x38cb34;_0x4bc95[_0x18f093][_0x2d5cec(0x221)]=_0x62d2d;}),_0x3b9d89[_0x38cb34(0x209)]((_0x315885,_0x576a66)=>{var _0x5823c9=_0x38cb34;_0x4bc95[_0x576a66][_0x5823c9(0x1d2)]=_0x315885;}),_0x4516c8[_0x38cb34(0x209)]((_0x4ba3db,_0x15cecb)=>{var _0x29b695=_0x38cb34;_0x4bc95[_0x15cecb][_0x29b695(0x200)]=_0x4ba3db;}),_0x4a6d1e[_0x38cb34(0x209)]((_0x2da247,_0x491258)=>{var _0x47b013=_0x38cb34;_0x4bc95[_0x491258][_0x47b013(0x1b0)]=_0x2da247;}),_0x8122b8[_0x38cb34(0x209)]((_0x2df0dc,_0x327313)=>{_0x4bc95[_0x327313]['maxProducts']=_0x2df0dc;}),_0x39b3e8[_0x38cb34(0x209)]((_0x6f9af7,_0xa5ce35)=>{var _0x34d10e=_0x38cb34;_0x4bc95[_0xa5ce35][_0x34d10e(0x1f9)]=_0x6f9af7;}),_0x385b78['forEach']((_0x990c8,_0x130f67)=>{var _0x32ebec=_0x38cb34;_0x4bc95[_0x130f67][_0x32ebec(0x1e7)]=_0x990c8;}),_0xa42691['forEach']((_0x17fbb6,_0x34c6a3)=>{var _0xae79a=_0x38cb34;_0x4bc95[_0x34c6a3][_0xae79a(0x204)]=_0x17fbb6;}),_0x541f1f['forEach']((_0x390d3c,_0x37b5df)=>{var _0x26ff4d=_0x38cb34;_0x4bc95[_0x37b5df][_0x26ff4d(0x24c)]=_0x390d3c;});const _0x4b7503=_0x4bc95['filter'](_0x299d84=>_0x299d84['to_quantity']!=='0'&&_0x299d84[_0x38cb34(0x20c)]!==''||_0x299d84[_0x38cb34(0x1dc)]!=='0'&&_0x299d84['to_floorlevel']!=='');var _0x25dd1b=0x0;_0x4b7503[_0x38cb34(0x209)](_0x14ad15=>{var _0x143075=_0x38cb34;parseInt(_0x14ad15[_0x143075(0x1c5)])<parseInt(_0x14ad15['to_quantity'])&&_0x25dd1b++;});if(_0x25dd1b!=0x0)return _0x29c5e6[_0x38cb34(0x1d8)]('errors',_0x38cb34(0x1f0)),_0xfc351c[_0x38cb34(0x1c4)](_0x38cb34(0x21c));const _0x5bf306=new transfers_logs();await _0x5bf306['save']();for(let _0x1bdeb2=0x0;_0x1bdeb2<=_0x541f1f['length']-0x1;_0x1bdeb2++){_0x4bc95[_0x1bdeb2]['To_invoice']='LOG-TRF-'+_0x5bf306[_0x38cb34(0x230)][_0x38cb34(0x1e6)]()[_0x38cb34(0x1e5)](0x8,'0');}const _0x6099b5=new transfers_finished({'date':_0x29b741,'from_warehouse':_0x10a8ad,'to_warehouse':_0x4b5e41,'product':_0x4b7503,'note':_0x13e252,'invoice':_0x38cb34(0x1d4)+_0x5bf306[_0x38cb34(0x230)][_0x38cb34(0x1e6)]()[_0x38cb34(0x1e5)](0x8,'0'),'type_of_transaction':'logs','type_of_process':_0x38cb34(0x263),'PO_number':_0x111546,'RequestedBy':_0x659445,'DateofRequest':_0x49e115,'typeservices':_0x42bb90,'destination':_0x38a76e,'deliverydate':_0x24af08,'driver':_0x21abd7,'plate':_0x5af91d,'van':_0x523f79,'DRSI':_0x22af43,'typevehicle':_0x3654b2,'TSU':_0x1fd312,'TFU':_0xd2b4}),_0x565a45=await _0x6099b5['save']();_0x29c5e6[_0x38cb34(0x1d8)](_0x38cb34(0x1d6),'Product\x20Transfer\x20successfully'),_0xfc351c['redirect']('/transfer_finished/preview/'+_0x565a45[_0x38cb34(0x239)]);}catch(_0x22b6ac){console[_0x38cb34(0x218)](_0x22b6ac),_0xfc351c[_0x38cb34(0x25d)](0xc8)['json']({'errorMessage':_0x22b6ac[_0x38cb34(0x1ee)]});}}),router[a0_0x222e33(0x1f1)](a0_0x222e33(0x1bd),auth,async(_0x473cb5,_0x403a9a)=>{var _0x753814=a0_0x222e33;try{const {date:_0x1cb7ce,from_warehouse:_0x14a10d,FromRoom_name:_0x337282,to_warehouse:_0x4eab7b,ToRoom_name:_0x25daa1,prod_name:_0x13519a,from_prod_qty:_0x7f035c,from_prod_level:_0x5c7436,from_prod_isle:_0x39684d,from_prod_pallet:_0x81fd01,to_prod_qty:_0x494ded,to_prod_level:_0x50cc40,to_prod_isle:_0x334727,to_prod_pallet:_0x579c12,primary_code:_0x392ffa,secondary_code:_0x502fef,product_code3:_0x25ba59,note:_0x4bc460,MaxStocks_data2:_0x6b156d,invoice:_0x3def79,expiry_date:_0x5b38f7,PO_number:_0x317b13,ReqBy:_0x525b72,dateofreq:_0x128a66,typeservicesData:_0x49a15e,destination:_0x285ed3,deliverydate:_0x1201e1,driver:_0x48c6ab,plate:_0x2e7c8e,van:_0x5cd01,DRSI:_0x49d357,typevehicle:_0x661fc1,TSU:_0x50bbc1,TFU:_0xff4896}=_0x473cb5[_0x753814(0x222)];if(typeof _0x13519a==_0x753814(0x247))var _0x1816ed=[_0x473cb5['body'][_0x753814(0x216)]],_0x36afae=[_0x473cb5[_0x753814(0x222)]['from_prod_qty']],_0x34ff19=[_0x473cb5[_0x753814(0x222)]['from_prod_level2']],_0x47a3fb=[_0x473cb5[_0x753814(0x222)][_0x753814(0x225)]],_0x54d8ab=[_0x473cb5[_0x753814(0x222)][_0x753814(0x244)]],_0x15bd56=[_0x473cb5[_0x753814(0x222)][_0x753814(0x203)]],_0xc7473d=[_0x473cb5[_0x753814(0x222)][_0x753814(0x254)]],_0x1a74b1=[_0x473cb5[_0x753814(0x222)][_0x753814(0x25a)]],_0x2b5d64=[_0x473cb5[_0x753814(0x222)][_0x753814(0x23c)]],_0xb4de5a=[_0x473cb5['body'][_0x753814(0x26f)]],_0x55ea79=[_0x473cb5[_0x753814(0x222)][_0x753814(0x221)]],_0x42bb62=[_0x473cb5[_0x753814(0x222)][_0x753814(0x1d2)]],_0x35fb50=[_0x473cb5[_0x753814(0x222)][_0x753814(0x200)]],_0x2a06ad=[_0x473cb5[_0x753814(0x222)][_0x753814(0x23b)]],_0x1d31de=[_0x473cb5['body'][_0x753814(0x274)]],_0x12c828=[_0x473cb5[_0x753814(0x222)][_0x753814(0x1f9)]],_0x1d3644=[_0x473cb5[_0x753814(0x222)][_0x753814(0x1e7)]],_0x38bcf5=[_0x473cb5['body'][_0x753814(0x202)]],_0x1cf679=[_0x473cb5[_0x753814(0x222)][_0x753814(0x1e1)]],_0x27f88b=[_0x473cb5['body'][_0x753814(0x217)]],_0x22db4d=[_0x473cb5[_0x753814(0x222)][_0x753814(0x246)]];else var _0x1816ed=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x216)]],_0x36afae=[..._0x473cb5[_0x753814(0x222)]['from_prod_qty']],_0x34ff19=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x21a)]],_0x47a3fb=[..._0x473cb5['body'][_0x753814(0x225)]],_0x54d8ab=[..._0x473cb5['body'][_0x753814(0x244)]],_0x15bd56=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x203)]],_0xc7473d=[..._0x473cb5[_0x753814(0x222)]['secondary_code']],_0x1a74b1=[..._0x473cb5[_0x753814(0x222)]['product_code3']],_0x2b5d64=[..._0x473cb5['body'][_0x753814(0x23c)]],_0xb4de5a=[..._0x473cb5[_0x753814(0x222)]['primary_unit']],_0x55ea79=[..._0x473cb5['body'][_0x753814(0x221)]],_0x42bb62=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x1d2)]],_0x35fb50=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x200)]],_0x2a06ad=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x23b)]],_0x1d31de=[..._0x473cb5['body']['MaxStocks_data']],_0x12c828=[..._0x473cb5['body'][_0x753814(0x1f9)]],_0x1d3644=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x1e7)]],_0x38bcf5=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x202)]],_0x1cf679=[..._0x473cb5[_0x753814(0x222)]['ToRoomAssigned']],_0x27f88b=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x217)]],_0x22db4d=[..._0x473cb5[_0x753814(0x222)][_0x753814(0x246)]];const _0x2bf6ee=_0x1816ed[_0x753814(0x237)](_0x2f85b0=>{return _0x2f85b0={'product_name':_0x2f85b0};});_0x36afae['forEach']((_0x296461,_0x2a33cc)=>{var _0x2458aa=_0x753814;_0x2bf6ee[_0x2a33cc][_0x2458aa(0x1c5)]=_0x296461;}),_0x34ff19[_0x753814(0x209)]((_0x1dca92,_0x310a65)=>{var _0x491b97=_0x753814,_0x39ac0c=_0x1dca92[_0x491b97(0x1ff)](/[A-Za-z]+/)[0x0],_0x5f8be5=parseInt(_0x1dca92[_0x491b97(0x1ff)](/\d+/)[0x0]);_0x2bf6ee[_0x310a65]['from_bay']=_0x5f8be5,_0x2bf6ee[_0x310a65][_0x491b97(0x1fb)]=_0x39ac0c;}),_0x22db4d[_0x753814(0x209)]((_0x16ab41,_0x326383)=>{var _0xb04f65=_0x753814;_0x2bf6ee[_0x326383][_0xb04f65(0x246)]=_0x16ab41;}),_0x27f88b['forEach']((_0x587792,_0x2f22fd)=>{_0x2bf6ee[_0x2f22fd]['from_invoice']=_0x587792;}),_0x47a3fb['forEach']((_0x2e20dc,_0x2008e9)=>{var _0x4059fb=_0x753814;_0x2bf6ee[_0x2008e9][_0x4059fb(0x20c)]=_0x2e20dc;}),_0x54d8ab[_0x753814(0x209)]((_0x48f320,_0x2b5760)=>{var _0x409b80=_0x753814,_0x233a7c=_0x48f320['match'](/[A-Za-z]+/)[0x0],_0x9a1814=parseInt(_0x48f320[_0x409b80(0x1ff)](/\d+/)[0x0]);_0x2bf6ee[_0x2b5760][_0x409b80(0x256)]=_0x233a7c,_0x2bf6ee[_0x2b5760]['to_bay']=_0x9a1814;}),_0x15bd56[_0x753814(0x209)]((_0xc8b530,_0x47a678)=>{_0x2bf6ee[_0x47a678]['primary_code']=_0xc8b530;}),_0xc7473d['forEach']((_0x4c9a3c,_0x2be298)=>{_0x2bf6ee[_0x2be298]['secondary_code']=_0x4c9a3c;}),_0x1a74b1[_0x753814(0x209)]((_0x5ceb6a,_0x2b621e)=>{var _0x5a8ae2=_0x753814;_0x2bf6ee[_0x2b621e][_0x5a8ae2(0x277)]=_0x5ceb6a;}),_0x2b5d64[_0x753814(0x209)]((_0x3d8e3c,_0x4fd4d9)=>{var _0x52a206=_0x753814;_0x2bf6ee[_0x4fd4d9][_0x52a206(0x1ed)]=_0x3d8e3c;}),_0xb4de5a['forEach']((_0x59c89f,_0x5868c6)=>{var _0x4e1103=_0x753814;_0x2bf6ee[_0x5868c6][_0x4e1103(0x229)]=_0x59c89f;}),_0x55ea79[_0x753814(0x209)]((_0x3904ae,_0x27014d)=>{var _0x193c9f=_0x753814;_0x2bf6ee[_0x27014d][_0x193c9f(0x221)]=_0x3904ae;}),_0x42bb62[_0x753814(0x209)]((_0x1905d2,_0x23957d)=>{var _0x391f3e=_0x753814;_0x2bf6ee[_0x23957d][_0x391f3e(0x1d2)]=_0x1905d2;}),_0x35fb50[_0x753814(0x209)]((_0x326ba8,_0x327033)=>{var _0x550ef2=_0x753814;_0x2bf6ee[_0x327033][_0x550ef2(0x200)]=_0x326ba8;}),_0x2a06ad[_0x753814(0x209)]((_0x3cee88,_0x4254f5)=>{_0x2bf6ee[_0x4254f5]['production_date']=_0x3cee88;}),_0x1d31de[_0x753814(0x209)]((_0x2b95ec,_0x21a4f5)=>{var _0x499717=_0x753814;_0x2bf6ee[_0x21a4f5][_0x499717(0x1ed)]=_0x2b95ec;}),_0x12c828[_0x753814(0x209)]((_0x2d1bb1,_0x3e45e1)=>{_0x2bf6ee[_0x3e45e1]['maxPerUnit']=_0x2d1bb1;}),_0x1d3644[_0x753814(0x209)]((_0x6353c2,_0xc0bf47)=>{var _0x51130d=_0x753814;_0x2bf6ee[_0xc0bf47][_0x51130d(0x1e7)]=_0x6353c2;}),_0x38bcf5[_0x753814(0x209)]((_0x1136ef,_0xeec363)=>{_0x2bf6ee[_0xeec363]['from_room_name']=_0x1136ef;}),_0x1cf679[_0x753814(0x209)]((_0x1f14b6,_0x378370)=>{var _0x5e324d=_0x753814;_0x2bf6ee[_0x378370][_0x5e324d(0x24c)]=_0x1f14b6;});const _0x44d6b4=_0x2bf6ee[_0x753814(0x21d)](_0x26a78d=>_0x26a78d[_0x753814(0x20c)]!=='0'&&_0x26a78d[_0x753814(0x20c)]!==''||_0x26a78d['to_floorlevel']!=='0'&&_0x26a78d[_0x753814(0x1dc)]!=='');var _0x2068b2=0x0;_0x44d6b4['forEach'](_0x13e4a1=>{var _0x378e0f=_0x753814;parseInt(_0x13e4a1[_0x378e0f(0x1c5)])<parseInt(_0x13e4a1['to_quantity'])&&_0x2068b2++;});if(_0x2068b2!=0x0)return _0x473cb5[_0x753814(0x1d8)]('errors',_0x753814(0x1f0)),_0x403a9a[_0x753814(0x1c4)](_0x753814(0x21c));const _0x2f6923=new invoice_for_transfer();await _0x2f6923['save']();for(let _0x2dcf14=0x0;_0x2dcf14<=_0x1cf679[_0x753814(0x1c0)]-0x1;_0x2dcf14++){_0x2bf6ee[_0x2dcf14]['To_invoice']=_0x753814(0x1cd)+_0x2f6923['invoice_init'][_0x753814(0x1e6)]()['padStart'](0x8,'0');}const _0x13d4ea=new transfers_finished({'date':_0x1cb7ce,'from_warehouse':_0x14a10d,'to_warehouse':_0x14a10d,'product':_0x44d6b4,'note':_0x4bc460,'invoice':_0x753814(0x1cd)+_0x2f6923[_0x753814(0x230)][_0x753814(0x1e6)]()[_0x753814(0x1e5)](0x8,'0'),'type_of_process':_0x753814(0x215),'type_of_transaction':'own','PO_number':_0x317b13,'RequestedBy':_0x525b72,'DateofRequest':_0x128a66,'typeservices':_0x49a15e,'destination':_0x285ed3,'deliverydate':_0x1201e1,'driver':_0x48c6ab,'plate':_0x2e7c8e,'van':_0x5cd01,'DRSI':_0x49d357,'typevehicle':_0x661fc1,'TSU':_0x50bbc1,'TFU':_0xff4896}),_0x53e2f9=await _0x13d4ea[_0x753814(0x1e2)]();_0x473cb5[_0x753814(0x1d8)](_0x753814(0x1d6),_0x753814(0x271)),_0x403a9a[_0x753814(0x1c4)](_0x753814(0x23f)+_0x53e2f9[_0x753814(0x239)]);}catch(_0x44d121){console['log'](_0x44d121),_0x403a9a[_0x753814(0x25d)](0xc8)['json']({'errorMessage':_0x44d121[_0x753814(0x1ee)]});}}),router[a0_0x222e33(0x1f1)]('/view/add_transfer_loc',auth,async(_0x3be91d,_0x42a6b4)=>{var _0x488681=a0_0x222e33;try{const {date:_0x23efd1,from_warehouse:_0x2617d8,FromRoom_name:_0x11835c,to_warehouse:_0x253425,ToRoom_name:_0xac87c3,prod_name:_0x3bf187,from_prod_qty:_0x56ea4a,from_prod_level:_0x1e77c2,from_prod_isle:_0x49e179,from_prod_pallet:_0xd1f9d4,to_prod_qty:_0x5630d5,to_prod_level:_0x24c241,to_prod_isle:_0x37f573,to_prod_pallet:_0x320d51,primary_code:_0xccb637,secondary_code:_0x2c1b06,product_code3:_0x528ab8,note:_0x52ae7e,MaxStocks_data2:_0x5dc4cf,invoice:_0x463db7,expiry_date:_0x306516,PO_number_loc:_0x2f4be9,ReqBy_loc:_0x8fa27b,dateofreq_loc:_0x235e5d,typeservices_loc_Data:_0x1e57ef,destination_loc:_0x41936e,deliverydate_loc:_0x6c241c,driver_loc:_0x948ef0,plate_loc:_0x55e004,van_loc:_0x5eadae,DRSI_loc:_0x3098c1,typevehicle_loc:_0x3d168c,TSU_loc:_0x12a6e1,TFU_loc:_0x5bfdd6}=_0x3be91d[_0x488681(0x222)];if(typeof _0x3bf187=='string')var _0x1d213d=[_0x3be91d[_0x488681(0x222)][_0x488681(0x216)]],_0x969260=[_0x3be91d[_0x488681(0x222)]['from_prod_qty']],_0x38a97b=[_0x3be91d[_0x488681(0x222)]['from_prod_level2']],_0x54987f=[_0x3be91d[_0x488681(0x222)][_0x488681(0x225)]],_0x7073fa=[_0x3be91d[_0x488681(0x222)][_0x488681(0x244)]],_0x1373dc=[_0x3be91d[_0x488681(0x222)][_0x488681(0x203)]],_0x5207ef=[_0x3be91d['body'][_0x488681(0x254)]],_0x435760=[_0x3be91d['body'][_0x488681(0x25a)]],_0x7f9fa7=[_0x3be91d[_0x488681(0x222)][_0x488681(0x23c)]],_0x3f7d37=[_0x3be91d['body'][_0x488681(0x26f)]],_0x484290=[_0x3be91d['body'][_0x488681(0x221)]],_0x167553=[_0x3be91d[_0x488681(0x222)][_0x488681(0x1d2)]],_0x403857=[_0x3be91d[_0x488681(0x222)][_0x488681(0x200)]],_0x278a12=[_0x3be91d[_0x488681(0x222)]['product_date']],_0x1e0d1f=[_0x3be91d[_0x488681(0x222)][_0x488681(0x274)]],_0x31786d=[_0x3be91d[_0x488681(0x222)]['maxPerUnit']],_0x1712c1=[_0x3be91d[_0x488681(0x222)][_0x488681(0x1e7)]],_0x4348da=[_0x3be91d['body']['RoomAssigned']],_0x5bc6e9=[_0x3be91d[_0x488681(0x222)][_0x488681(0x1e1)]],_0xae66a9=[_0x3be91d[_0x488681(0x222)]['from_invoice']],_0x4307bd=[_0x3be91d[_0x488681(0x222)]['id_transaction']];else var _0x1d213d=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x216)]],_0x969260=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x260)]],_0x38a97b=[..._0x3be91d[_0x488681(0x222)]['from_prod_level2']],_0x54987f=[..._0x3be91d[_0x488681(0x222)]['New_Qty_Converted']],_0x7073fa=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x244)]],_0x1373dc=[..._0x3be91d[_0x488681(0x222)]['primary_code']],_0x5207ef=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x254)]],_0x435760=[..._0x3be91d['body'][_0x488681(0x25a)]],_0x7f9fa7=[..._0x3be91d[_0x488681(0x222)]['MaxStocks_data2']],_0x3f7d37=[..._0x3be91d[_0x488681(0x222)]['primary_unit']],_0x484290=[..._0x3be91d[_0x488681(0x222)]['secondary_unit']],_0x167553=[..._0x3be91d['body'][_0x488681(0x1d2)]],_0x403857=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x200)]],_0x278a12=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x23b)]],_0x1e0d1f=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x274)]],_0x31786d=[..._0x3be91d['body'][_0x488681(0x1f9)]],_0x1712c1=[..._0x3be91d['body'][_0x488681(0x1e7)]],_0x4348da=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x202)]],_0x5bc6e9=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x1e1)]],_0xae66a9=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x217)]],_0x4307bd=[..._0x3be91d[_0x488681(0x222)][_0x488681(0x246)]];const _0x3699ca=_0x1d213d[_0x488681(0x237)](_0x1dc484=>{return _0x1dc484={'product_name':_0x1dc484};});_0x969260[_0x488681(0x209)]((_0x14796a,_0x1cf107)=>{var _0x491c88=_0x488681;_0x3699ca[_0x1cf107][_0x491c88(0x1c5)]=_0x14796a;}),_0x38a97b[_0x488681(0x209)]((_0x24d921,_0x36b30b)=>{var _0x3a6292=_0x488681,_0x2031d9=_0x24d921[_0x3a6292(0x1ff)](/[A-Za-z]+/)[0x0],_0x42da88=parseInt(_0x24d921[_0x3a6292(0x1ff)](/\d+/)[0x0]);_0x3699ca[_0x36b30b][_0x3a6292(0x272)]=_0x42da88,_0x3699ca[_0x36b30b][_0x3a6292(0x1fb)]=_0x2031d9;}),_0x4307bd[_0x488681(0x209)]((_0x45d4fc,_0x1ed1ff)=>{var _0x5e21c2=_0x488681;_0x3699ca[_0x1ed1ff][_0x5e21c2(0x246)]=_0x45d4fc;}),_0xae66a9[_0x488681(0x209)]((_0xdeab74,_0x1bad96)=>{var _0x53ebe6=_0x488681;_0x3699ca[_0x1bad96][_0x53ebe6(0x217)]=_0xdeab74;}),_0x54987f[_0x488681(0x209)]((_0x4776ce,_0x4e39ae)=>{_0x3699ca[_0x4e39ae]['to_quantity']=_0x4776ce;}),_0x7073fa[_0x488681(0x209)]((_0x139f67,_0x19f1d1)=>{var _0x464f30=_0x488681,_0x237109=_0x139f67['match'](/[A-Za-z]+/)[0x0],_0x18ccd3=parseInt(_0x139f67[_0x464f30(0x1ff)](/\d+/)[0x0]);_0x3699ca[_0x19f1d1]['to_level']=_0x237109,_0x3699ca[_0x19f1d1][_0x464f30(0x25e)]=_0x18ccd3;}),_0x1373dc[_0x488681(0x209)]((_0x4ea750,_0x2bc302)=>{_0x3699ca[_0x2bc302]['primary_code']=_0x4ea750;}),_0x5207ef[_0x488681(0x209)]((_0x26d4e1,_0x40f048)=>{_0x3699ca[_0x40f048]['secondary_code']=_0x26d4e1;}),_0x435760[_0x488681(0x209)]((_0x5e9101,_0x34488f)=>{var _0x23261a=_0x488681;_0x3699ca[_0x34488f][_0x23261a(0x277)]=_0x5e9101;}),_0x7f9fa7['forEach']((_0x42cf7c,_0x149954)=>{_0x3699ca[_0x149954]['maxProducts']=_0x42cf7c;}),_0x3f7d37[_0x488681(0x209)]((_0x2f9429,_0x470445)=>{var _0x34e16d=_0x488681;_0x3699ca[_0x470445][_0x34e16d(0x229)]=_0x2f9429;}),_0x484290['forEach']((_0x5d2e25,_0x5890ad)=>{var _0x354a4a=_0x488681;_0x3699ca[_0x5890ad][_0x354a4a(0x221)]=_0x5d2e25;}),_0x167553[_0x488681(0x209)]((_0x1c5540,_0x2e0711)=>{_0x3699ca[_0x2e0711]['batch_code']=_0x1c5540;}),_0x403857[_0x488681(0x209)]((_0x187155,_0x20e135)=>{var _0x2069ea=_0x488681;_0x3699ca[_0x20e135][_0x2069ea(0x200)]=_0x187155;}),_0x278a12[_0x488681(0x209)]((_0x4f388c,_0x1d945e)=>{_0x3699ca[_0x1d945e]['production_date']=_0x4f388c;}),_0x1e0d1f['forEach']((_0xf7257d,_0x139dbf)=>{_0x3699ca[_0x139dbf]['maxProducts']=_0xf7257d;}),_0x31786d['forEach']((_0x59337f,_0x177a53)=>{var _0x233792=_0x488681;_0x3699ca[_0x177a53][_0x233792(0x1f9)]=_0x59337f;}),_0x1712c1[_0x488681(0x209)]((_0x593d6c,_0x2f08d1)=>{var _0x48085d=_0x488681;_0x3699ca[_0x2f08d1][_0x48085d(0x1e7)]=_0x593d6c;}),_0x4348da[_0x488681(0x209)]((_0x160330,_0x16a1a0)=>{var _0x26f7c0=_0x488681;_0x3699ca[_0x16a1a0][_0x26f7c0(0x204)]=_0x160330;}),_0x5bc6e9[_0x488681(0x209)]((_0x164c1d,_0x2cdf3d)=>{var _0x2398c2=_0x488681;_0x3699ca[_0x2cdf3d][_0x2398c2(0x24c)]=_0x164c1d;});const _0x421c4d=_0x3699ca[_0x488681(0x21d)](_0x3363bd=>_0x3363bd[_0x488681(0x20c)]!=='0'&&_0x3363bd[_0x488681(0x20c)]!==''||_0x3363bd[_0x488681(0x1dc)]!=='0'&&_0x3363bd['to_floorlevel']!=='');var _0x169388=0x0;_0x421c4d[_0x488681(0x209)](_0x23aa8b=>{var _0x36b8aa=_0x488681;parseInt(_0x23aa8b[_0x36b8aa(0x1c5)])<parseInt(_0x23aa8b[_0x36b8aa(0x20c)])&&_0x169388++;});if(_0x169388!=0x0)return _0x3be91d[_0x488681(0x1d8)](_0x488681(0x220),_0x488681(0x1f0)),_0x42a6b4[_0x488681(0x1c4)](_0x488681(0x21c));const _0x55b898=new invoice_for_transfer();await _0x55b898['save']();for(let _0x8f318a=0x0;_0x8f318a<=_0x5bc6e9['length']-0x1;_0x8f318a++){_0x3699ca[_0x8f318a][_0x488681(0x1b1)]=_0x488681(0x1cd)+_0x55b898['invoice_init'][_0x488681(0x1e6)]()['padStart'](0x8,'0');}const _0x2d8f74=new transfers_finished({'date':_0x23efd1,'from_warehouse':_0x2617d8,'to_warehouse':_0x253425,'product':_0x421c4d,'note':_0x52ae7e,'invoice':_0x488681(0x1cd)+_0x55b898[_0x488681(0x230)][_0x488681(0x1e6)]()['padStart'](0x8,'0'),'type_of_transaction':_0x488681(0x1c8),'type_of_process':'location2location','PO_number':_0x2f4be9,'RequestedBy':_0x8fa27b,'DateofRequest':_0x235e5d,'typeservices':_0x1e57ef,'destination':_0x41936e,'deliverydate':_0x6c241c,'driver':_0x948ef0,'plate':_0x55e004,'van':_0x5eadae,'DRSI':_0x3098c1,'typevehicle':_0x3d168c,'TSU':_0x12a6e1,'TFU':_0x5bfdd6}),_0x2a657a=await _0x2d8f74[_0x488681(0x1e2)]();_0x3be91d['flash'](_0x488681(0x1d6),'Product\x20Transfer\x20successfully'),_0x42a6b4[_0x488681(0x1c4)]('/transfer_finished/preview/'+_0x2a657a['_id']);}catch(_0x4eee6e){console['log'](_0x4eee6e),_0x42a6b4[_0x488681(0x25d)](0xc8)[_0x488681(0x20e)]({'errorMessage':_0x4eee6e[_0x488681(0x1ee)]});}}),router[a0_0x222e33(0x1d0)](a0_0x222e33(0x1f4),auth,async(_0x5ec604,_0x1f1fa1)=>{var _0x452e8e=a0_0x222e33;try{const {username:_0x56b47d,email:_0x3a9a99,role:_0x3055db}=_0x5ec604[_0x452e8e(0x241)],_0x298e92=_0x5ec604['user'],_0x1f0872=await profile[_0x452e8e(0x253)]({'email':_0x298e92[_0x452e8e(0x1fe)]}),_0x30fe1b=await master_shop['find'](),_0x2f5233=await transfers_finished[_0x452e8e(0x267)](_0x5ec604[_0x452e8e(0x243)]['id']);let _0x569ee4;if(_0x298e92[_0x452e8e(0x1bb)]==_0x452e8e(0x26a)){const _0x36dec0=await staff[_0x452e8e(0x253)]({'email':_0x298e92[_0x452e8e(0x1fe)]});_0x569ee4=await warehouse[_0x452e8e(0x1d3)]({'status':'Enabled','name':_0x36dec0[_0x452e8e(0x1d9)],'warehouse_category':_0x452e8e(0x1cb)});}else _0x569ee4=await warehouse['find']({'status':_0x452e8e(0x22c),'warehouse_category':_0x452e8e(0x1cb)});const _0x355f8d=await warehouse['aggregate']([{'$match':{'name':_0x2f5233['from_warehouse'],'warehouse_category':_0x452e8e(0x1cb)}},{'$unwind':_0x452e8e(0x26b)},{'$group':{'_id':_0x452e8e(0x273),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x452e8e(0x1de)},'bay':{'$first':_0x452e8e(0x20a)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x452e8e(0x24b)},'floorlevel':{'$first':_0x452e8e(0x1b7)},'primary_code':{'$first':_0x452e8e(0x233)},'secondary_code':{'$first':_0x452e8e(0x1c3)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x452e8e(0x1f3)},'production_date':{'$first':_0x452e8e(0x205)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x452e8e(0x1b5)}}}]),_0x2ab326=await product['find']({});if(_0x30fe1b[0x0][_0x452e8e(0x269)]==_0x452e8e(0x27a)){var _0x440400=users['English'];console[_0x452e8e(0x218)](_0x440400);}else{if(_0x30fe1b[0x0]['language']==_0x452e8e(0x1cf))var _0x440400=users['Hindi'];else{if(_0x30fe1b[0x0][_0x452e8e(0x269)]==_0x452e8e(0x1ea))var _0x440400=users['German'];else{if(_0x30fe1b[0x0][_0x452e8e(0x269)]==_0x452e8e(0x258))var _0x440400=users['Spanish'];else{if(_0x30fe1b[0x0][_0x452e8e(0x269)]=='French')var _0x440400=users[_0x452e8e(0x1ec)];else{if(_0x30fe1b[0x0]['language']==_0x452e8e(0x1b2))var _0x440400=users[_0x452e8e(0x1b6)];else{if(_0x30fe1b[0x0]['language']=='Chinese')var _0x440400=users['Chinese'];else{if(_0x30fe1b[0x0][_0x452e8e(0x269)]==_0x452e8e(0x234))var _0x440400=users[_0x452e8e(0x1ca)];}}}}}}}_0x1f1fa1['render'](_0x452e8e(0x226),{'success':_0x5ec604[_0x452e8e(0x1d8)]('success'),'errors':_0x5ec604['flash'](_0x452e8e(0x220)),'role':_0x298e92,'profile':_0x1f0872,'master_shop':_0x30fe1b,'warehouse':_0x569ee4,'transfer':_0x2f5233,'stock':_0x355f8d,'unit':_0x2ab326,'language':_0x440400});}catch(_0x4d9235){console[_0x452e8e(0x218)](_0x4d9235);}}),router[a0_0x222e33(0x1f1)](a0_0x222e33(0x1f4),auth,async(_0x3b9d9f,_0x514369)=>{var _0x48de62=a0_0x222e33;try{const {invoice:_0x3f1c31,from_warehouse:_0x28aec9,FromRoom_name:_0x204f10,to_warehouse:_0x44512d,ToRoom_name:_0x4e7b53}=_0x3b9d9f['body'],_0x48ee4f=await transfers_finished[_0x48de62(0x267)](_0x3b9d9f['params']['id']),_0xaa0b97=_0x48ee4f[_0x48de62(0x1d7)][_0x48de62(0x237)](async _0x386de1=>{var _0x1a828f=_0x48de62;if(_0x386de1[_0x1a828f(0x20c)]>0x0){var _0x445fbb=await warehouse[_0x1a828f(0x253)]({'name':_0x28aec9,'room':_0x386de1['from_room_name']});const _0x399b6d=_0x445fbb[_0x1a828f(0x279)]['map'](_0x1659a8=>{var _0x53f09b=_0x1a828f;_0x1659a8[_0x53f09b(0x239)]==_0x386de1[_0x53f09b(0x246)]&&(_0x1659a8[_0x53f09b(0x259)]=Math[_0x53f09b(0x219)](0x0,Math[_0x53f09b(0x1f6)](_0x1659a8[_0x53f09b(0x259)])-Math['abs'](_0x386de1[_0x53f09b(0x20c)])),console[_0x53f09b(0x218)](_0x1659a8[_0x53f09b(0x259)]));});}return _0x445fbb;});Promise['all'](_0xaa0b97)[_0x48de62(0x240)](async _0x4c4b14=>{var _0x5d5b80=_0x48de62;try{for(const _0x109359 of _0x4c4b14){await _0x109359[_0x5d5b80(0x1e2)]();}const _0x502639=_0x48ee4f[_0x5d5b80(0x1d7)][_0x5d5b80(0x237)](async _0x2b1d34=>{var _0x3660e4=_0x5d5b80,_0x51b0ef=await warehouse[_0x3660e4(0x253)]({'name':_0x44512d,'room':_0x2b1d34[_0x3660e4(0x24c)]});if(_0x2b1d34[_0x3660e4(0x20c)]>0x0){var _0x5d7058=0x0;const _0x11f755=_0x51b0ef[_0x3660e4(0x279)]['map'](_0xd17dca=>{var _0x119a0f=_0x3660e4;_0xd17dca[_0x119a0f(0x24e)]==_0x2b1d34[_0x119a0f(0x24e)]&&_0xd17dca[_0x119a0f(0x257)]==_0x2b1d34[_0x119a0f(0x25e)]&&_0xd17dca[_0x119a0f(0x200)]==_0x2b1d34[_0x119a0f(0x200)]&&_0xd17dca['production_date']==_0x2b1d34[_0x119a0f(0x1b0)]&&_0xd17dca[_0x119a0f(0x1d2)]==_0x2b1d34['batch_code']&&_0xd17dca[_0x119a0f(0x25b)]==_0x2b1d34[_0x119a0f(0x1b1)]&&(typeof _0x2b1d34[_0x119a0f(0x246)]=='undefined'?(console[_0x119a0f(0x218)](_0x119a0f(0x201),_0xd17dca[_0x119a0f(0x259)]+'\x20<>\x20'+_0xd17dca[_0x119a0f(0x239)]+_0x119a0f(0x1ef)+Math[_0x119a0f(0x1f6)](_0xd17dca[_0x119a0f(0x259)])+Math['abs'](_0x2b1d34['to_quantity'])),_0xd17dca[_0x119a0f(0x259)]=Math[_0x119a0f(0x1f6)](_0xd17dca[_0x119a0f(0x259)])+Math[_0x119a0f(0x1f6)](_0x2b1d34[_0x119a0f(0x20c)])):_0xd17dca[_0x119a0f(0x259)]=Math[_0x119a0f(0x1f6)](_0xd17dca[_0x119a0f(0x259)])+Math['abs'](_0x2b1d34['to_quantity']),_0x5d7058++);});_0x5d7058=='0'&&(_0x51b0ef[_0x3660e4(0x279)]=_0x51b0ef[_0x3660e4(0x279)][_0x3660e4(0x264)]({'product_name':_0x2b1d34[_0x3660e4(0x24e)],'product_stock':_0x2b1d34[_0x3660e4(0x20c)],'bay':_0x2b1d34[_0x3660e4(0x25e)],'level':_0x2b1d34[_0x3660e4(0x256)],'product_code':_0x2b1d34[_0x3660e4(0x277)],'primary_code':_0x2b1d34[_0x3660e4(0x203)],'secondary_code':_0x2b1d34['secondary_code'],'expiry_date':_0x2b1d34[_0x3660e4(0x200)],'production_date':_0x2b1d34[_0x3660e4(0x1b0)],'maxProducts':_0x2b1d34[_0x3660e4(0x1ed)],'batch_code':_0x2b1d34[_0x3660e4(0x1d2)],'secondary_unit':_0x2b1d34[_0x3660e4(0x221)],'unit':_0x2b1d34[_0x3660e4(0x229)],'maxProducts':_0x2b1d34[_0x3660e4(0x1ed)],'maxPerUnit':_0x2b1d34[_0x3660e4(0x1f9)],'invoice':_0x2b1d34[_0x3660e4(0x1b1)]}));}return _0x51b0ef;});Promise[_0x5d5b80(0x236)](_0x502639)[_0x5d5b80(0x240)](async _0x410be4=>{var _0x4cd692=_0x5d5b80;try{console[_0x4cd692(0x218)](_0x48ee4f[_0x4cd692(0x1b9)]);if(_0x48ee4f['type_of_process']!=_0x4cd692(0x263))for(const _0x224c5a of _0x410be4){await warehouse['updateOne']({'_id':_0x224c5a[_0x4cd692(0x239)]},{'$addToSet':{'product_details':{'$each':_0x224c5a[_0x4cd692(0x279)]}}});}_0x48ee4f[_0x4cd692(0x25c)]=_0x4cd692(0x238);const _0x488062=await _0x48ee4f[_0x4cd692(0x1e2)](),_0x556c64=await master_shop[_0x4cd692(0x1d3)](),_0x3bf619=await email_settings['findOne'](),_0x412268=await supervisor_settings['find']();var _0x127c74=_0x48ee4f[_0x4cd692(0x1d7)],_0x24d001='',_0x2a304a;for(_0x2a304a in _0x127c74){var _0x1587e8='FG';_0x48ee4f[_0x4cd692(0x22b)]==_0x4cd692(0x278)&&(_0x1587e8='DG'),_0x24d001+=_0x4cd692(0x262)+_0x4cd692(0x249)+_0x127c74[_0x2a304a]['product_name']+'</td>'+_0x4cd692(0x249)+_0x127c74[_0x2a304a][_0x4cd692(0x277)]+_0x4cd692(0x266)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x127c74[_0x2a304a][_0x4cd692(0x20c)]+_0x4cd692(0x266)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x127c74[_0x2a304a][_0x4cd692(0x229)]+_0x4cd692(0x266)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x127c74[_0x2a304a][_0x4cd692(0x221)]+_0x4cd692(0x266)+_0x4cd692(0x249)+_0x48ee4f['to_warehouse']+_0x4cd692(0x266)+_0x4cd692(0x249)+_0x127c74[_0x2a304a][_0x4cd692(0x24c)]+'</td>'+_0x4cd692(0x249)+_0x1587e8+_0x127c74[_0x2a304a][_0x4cd692(0x25e)]+'</td>'+_0x4cd692(0x1c7);}_0x3b9d9f[_0x4cd692(0x1d8)]('success',_0x4cd692(0x211)),_0x514369['redirect']('/picking_list/PDF_transfer/'+_0x488062[_0x4cd692(0x239)]);}catch(_0x52455c){console[_0x4cd692(0x1d1)](_0x52455c),_0x514369[_0x4cd692(0x25d)](0x1f4)[_0x4cd692(0x20e)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x5d5b80(0x1be)](_0x2053c9=>{var _0x3bb1b5=_0x5d5b80;console[_0x3bb1b5(0x1d1)](_0x2053c9),_0x514369[_0x3bb1b5(0x25d)](0x1f4)[_0x3bb1b5(0x20e)]({'error':_0x3bb1b5(0x276)});});}catch(_0x317202){console[_0x5d5b80(0x1d1)](_0x317202),_0x514369[_0x5d5b80(0x25d)](0x1f4)[_0x5d5b80(0x20e)]({'error':_0x5d5b80(0x1c1)});}})['catch'](_0x4e5f88=>{var _0x1f4059=_0x48de62;console['error'](_0x4e5f88),_0x514369[_0x1f4059(0x25d)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0xf4f01){_0x514369['json']({'message':_0xf4f01[_0x48de62(0x1ee)]});}});function BayBinSelected(_0x367375,_0x34c96b){var _0x42697c=a0_0x222e33,_0x3c1413=[];let _0x2fbc56=[];var _0x231787=[];if(_0x367375==_0x42697c(0x278)){switch(_0x34c96b){case'Rack\x201':_0x3c1413=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x42697c(0x212):_0x3c1413=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x231787=['DG'];}else{if(_0x367375=='FROZEN\x20GOODS'){switch(_0x34c96b){case _0x42697c(0x1b3):_0x3c1413=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x3c1413=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x231787=['FG'];}}return{'levels':_0x3c1413,'identify':_0x231787};}router[a0_0x222e33(0x1d0)](a0_0x222e33(0x26d),auth,async(_0x167a86,_0x3b2ac3)=>{var _0x10cc0=a0_0x222e33;try{const {username:_0x19b6ab,email:_0x32a2a0,role:_0x529b42}=_0x167a86[_0x10cc0(0x241)],_0x48a82e=_0x167a86[_0x10cc0(0x241)],_0x293e3d=await profile[_0x10cc0(0x253)]({'email':_0x48a82e['email']}),_0x31d6fa=await master_shop[_0x10cc0(0x1d3)](),_0x1ddd29=await transfers_finished['findById'](_0x167a86[_0x10cc0(0x243)]['id']);let _0x5de146=new Date(_0x1ddd29[_0x10cc0(0x200)]),_0x2a7b5d=('0'+_0x5de146[_0x10cc0(0x1c6)]())['slice'](-0x2),_0x6464b1=('0'+(_0x5de146[_0x10cc0(0x1dd)]()+0x1))[_0x10cc0(0x251)](-0x2),_0x262dba=_0x5de146[_0x10cc0(0x1f8)](),_0x2036ce=_0x262dba+'-'+_0x6464b1+'-'+_0x2a7b5d,_0x1efbe5;if(_0x48a82e['role']==_0x10cc0(0x26a)){const _0x4b41ea=await staff[_0x10cc0(0x253)]({'email':_0x48a82e['email']});_0x1efbe5=await warehouse[_0x10cc0(0x1d3)]({'status':_0x10cc0(0x22c),'name':_0x4b41ea['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x1efbe5=await warehouse['find']({'status':_0x10cc0(0x22c),'warehouse_category':_0x10cc0(0x1cb)});const _0x45cab6=await warehouse[_0x10cc0(0x21b)]([{'$match':{'name':_0x1ddd29[_0x10cc0(0x1bf)],'room':_0x1ddd29[_0x10cc0(0x206)]}},{'$unwind':_0x10cc0(0x26b)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x10cc0(0x20d)},'product_stock':{'$first':_0x10cc0(0x1de)},'bay':{'$first':_0x10cc0(0x20a)},'bin':{'$first':_0x10cc0(0x228)},'type':{'$first':_0x10cc0(0x24b)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x10cc0(0x233)},'secondary_code':{'$first':_0x10cc0(0x1c3)},'product_code':{'$first':_0x10cc0(0x21e)},'storage':{'$first':_0x10cc0(0x26c)},'rack':{'$first':_0x10cc0(0x224)}}}]);var _0x162248=[0x1,0x2,0x3,0x4],_0x5b5950=['A','B','C','D','E','F','G','H','I','J'],_0x5b667a=['Ambient',_0x10cc0(0x1b4)];const _0x3ee17f=await product['find']({}),_0x48ab77=BayBinSelected(_0x1ddd29['to_warehouse'],_0x1ddd29[_0x10cc0(0x213)]);if(_0x31d6fa[0x0][_0x10cc0(0x269)]==_0x10cc0(0x27a)){var _0x235ff0=users[_0x10cc0(0x20f)];console[_0x10cc0(0x218)](_0x235ff0);}else{if(_0x31d6fa[0x0][_0x10cc0(0x269)]==_0x10cc0(0x1cf))var _0x235ff0=users[_0x10cc0(0x1cf)];else{if(_0x31d6fa[0x0][_0x10cc0(0x269)]==_0x10cc0(0x1ea))var _0x235ff0=users['German'];else{if(_0x31d6fa[0x0][_0x10cc0(0x269)]==_0x10cc0(0x258))var _0x235ff0=users['Spanish'];else{if(_0x31d6fa[0x0][_0x10cc0(0x269)]==_0x10cc0(0x1ec))var _0x235ff0=users[_0x10cc0(0x1ec)];else{if(_0x31d6fa[0x0][_0x10cc0(0x269)]==_0x10cc0(0x1b2))var _0x235ff0=users[_0x10cc0(0x1b6)];else{if(_0x31d6fa[0x0]['language']==_0x10cc0(0x26e))var _0x235ff0=users[_0x10cc0(0x26e)];else{if(_0x31d6fa[0x0]['language']==_0x10cc0(0x234))var _0x235ff0=users['Arabic'];}}}}}}}_0x3b2ac3[_0x10cc0(0x214)](_0x10cc0(0x242),{'success':_0x167a86[_0x10cc0(0x1d8)](_0x10cc0(0x1d6)),'errors':_0x167a86[_0x10cc0(0x1d8)](_0x10cc0(0x220)),'role':_0x48a82e,'profile':_0x293e3d,'master_shop':_0x31d6fa,'warehouse':_0x1efbe5,'transfer':_0x1ddd29,'stock':_0x45cab6,'unit':_0x3ee17f,'language':_0x235ff0,'levels':_0x162248,'Isle':_0x5b5950,'rooms_data':_0x5b667a,'ed_fullDate':_0x2036ce,'dataSelected':_0x48ab77});}catch(_0x4bb9dc){console[_0x10cc0(0x218)](_0x4bb9dc);}}),router['post'](a0_0x222e33(0x26d),auth,async(_0x1d68fb,_0x56b35a)=>{var _0x16a94e=a0_0x222e33;try{const _0xa02324=_0x1d68fb[_0x16a94e(0x243)]['id'];console[_0x16a94e(0x218)](_0x1d68fb[_0x16a94e(0x222)]);const _0x2f5607=await transfers_finished[_0x16a94e(0x267)](_0xa02324);console[_0x16a94e(0x218)]('transfer_data',_0x2f5607);const {date:_0x536bd1,from_warehouse:_0x5f3fe7,FromRoom_name:_0x255ab2,to_warehouse:_0x207d31,ToRoom_name:_0x4286,prod_name:_0x3174b2,from_prod_qty:_0x4fbc0c,from_prod_level:_0x50ee93,from_prod_isle:_0x38979e,from_prod_pallet:_0x4625d9,to_prod_qty:_0x19e325,to_prod_level:_0x451a8d,to_prod_isle:_0x359683,to_prod_pallet:_0x13f04d,primary_code:_0x3a8e1e,secondary_code:_0x1e97d5,product_code3:_0x17e259,note:_0x401d15,invoice:_0x53e42e,expiry_date:_0x14be14}=_0x1d68fb[_0x16a94e(0x222)];if(typeof _0x3174b2==_0x16a94e(0x247))var _0xca6630=[_0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x216)]],_0x46ea73=[_0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x260)]],_0x293722=[_0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x1c9)]],_0x2d30ef=[_0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x23e)]],_0x309943=[_0x1d68fb['body']['to_prod_level']],_0x459920=[_0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x203)]],_0x1661c3=[_0x1d68fb['body'][_0x16a94e(0x254)]],_0x4e9c69=[_0x1d68fb[_0x16a94e(0x222)]['product_code3']],_0x233114=[_0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x23c)]],_0x393d43=[_0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x229)]],_0x37c046=[_0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x221)]],_0x1fc542=[_0x1d68fb[_0x16a94e(0x222)]['batch_code']],_0x93581b=[_0x1d68fb['body'][_0x16a94e(0x200)]];else var _0xca6630=[..._0x1d68fb['body'][_0x16a94e(0x216)]],_0x46ea73=[..._0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x260)]],_0x293722=[..._0x1d68fb['body'][_0x16a94e(0x1c9)]],_0x2d30ef=[..._0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x23e)]],_0x309943=[..._0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x244)]],_0x459920=[..._0x1d68fb['body']['primary_code']],_0x1661c3=[..._0x1d68fb['body']['secondary_code']],_0x4e9c69=[..._0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x25a)]],_0x233114=[..._0x1d68fb['body'][_0x16a94e(0x23c)]],_0x393d43=[..._0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x229)]],_0x37c046=[..._0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x221)]],_0x1fc542=[..._0x1d68fb[_0x16a94e(0x222)][_0x16a94e(0x1d2)]],_0x93581b=[..._0x1d68fb[_0x16a94e(0x222)]['expiry_date']];const _0x2e8847=_0xca6630[_0x16a94e(0x237)](_0x42b104=>{return _0x42b104={'product_name':_0x42b104};});_0x46ea73[_0x16a94e(0x209)]((_0x4b20dc,_0x433e41)=>{var _0x1f0101=_0x16a94e;_0x2e8847[_0x433e41][_0x1f0101(0x1c5)]=_0x4b20dc;}),_0x293722['forEach']((_0x5b4cd7,_0xd95581)=>{_0x2e8847[_0xd95581]['from_bay']=_0x5b4cd7;}),_0x2d30ef[_0x16a94e(0x209)]((_0x293a1f,_0x3c7849)=>{var _0x3557e4=_0x16a94e;_0x2e8847[_0x3c7849][_0x3557e4(0x20c)]=_0x293a1f;}),_0x309943['forEach']((_0x1410ba,_0x180ffc)=>{var _0x2ee18e=_0x16a94e;_0x2e8847[_0x180ffc][_0x2ee18e(0x25e)]=_0x1410ba;}),_0x459920[_0x16a94e(0x209)]((_0x5aaa3d,_0x4ead25)=>{var _0x31cf92=_0x16a94e;_0x2e8847[_0x4ead25][_0x31cf92(0x203)]=_0x5aaa3d;}),_0x1661c3[_0x16a94e(0x209)]((_0x4e0d78,_0x348391)=>{var _0x169429=_0x16a94e;_0x2e8847[_0x348391][_0x169429(0x254)]=_0x4e0d78;}),_0x4e9c69[_0x16a94e(0x209)]((_0x44328a,_0x4bc2a7)=>{var _0x46e1b6=_0x16a94e;_0x2e8847[_0x4bc2a7][_0x46e1b6(0x277)]=_0x44328a;}),_0x233114[_0x16a94e(0x209)]((_0x28b58f,_0x22cfb5)=>{var _0x35ec47=_0x16a94e;_0x2e8847[_0x22cfb5][_0x35ec47(0x1ed)]=_0x28b58f;}),_0x393d43[_0x16a94e(0x209)]((_0x333a98,_0x5ebb37)=>{var _0x5d5501=_0x16a94e;_0x2e8847[_0x5ebb37][_0x5d5501(0x229)]=_0x333a98;}),_0x37c046[_0x16a94e(0x209)]((_0x13b316,_0x55d25c)=>{_0x2e8847[_0x55d25c]['secondary_unit']=_0x13b316;}),_0x1fc542[_0x16a94e(0x209)]((_0x5a4da1,_0xace4ee)=>{var _0x3bf7f4=_0x16a94e;_0x2e8847[_0xace4ee][_0x3bf7f4(0x1d2)]=_0x5a4da1;}),_0x93581b[_0x16a94e(0x209)]((_0x48e14e,_0x452dc8)=>{var _0x25e352=_0x16a94e;_0x2e8847[_0x452dc8][_0x25e352(0x200)]=_0x48e14e;});const _0x2daa08=_0x2e8847['filter'](_0x19409f=>_0x19409f[_0x16a94e(0x20c)]!=='0'&&_0x19409f[_0x16a94e(0x20c)]!==''||_0x19409f[_0x16a94e(0x1dc)]!=='0'&&_0x19409f[_0x16a94e(0x1dc)]!=='');var _0x9d24b3=0x0;_0x2daa08[_0x16a94e(0x209)](_0x579d33=>{var _0x14a9a=_0x16a94e;parseInt(_0x579d33[_0x14a9a(0x1c5)])<parseInt(_0x579d33[_0x14a9a(0x20c)])&&_0x9d24b3++;});if(_0x9d24b3!=0x0)return _0x1d68fb[_0x16a94e(0x1d8)]('errors',_0x16a94e(0x1f0)),_0x56b35a[_0x16a94e(0x1c4)](_0x16a94e(0x21c));const _0x14fd9f=await warehouse['findOne']({'name':_0x2f5607[_0x16a94e(0x1bf)],'room':_0x2f5607['from_room']});_0x2f5607[_0x16a94e(0x1d7)]['forEach'](_0x66520a=>{var _0x3d12b4=_0x16a94e;if(_0x66520a[_0x3d12b4(0x20c)]>0x0){const _0x36f104=_0x14fd9f['product_details']['map'](_0x49bb0b=>{var _0x4abe72=_0x3d12b4;_0x49bb0b[_0x4abe72(0x24e)]==_0x66520a[_0x4abe72(0x24e)]&&_0x49bb0b[_0x4abe72(0x257)]==_0x66520a[_0x4abe72(0x272)]&&(_0x49bb0b[_0x4abe72(0x259)]=parseInt(_0x49bb0b['product_stock'])+parseInt(_0x66520a[_0x4abe72(0x20c)]));});}}),await _0x14fd9f[_0x16a94e(0x1e2)]();const _0x8533eb=await warehouse[_0x16a94e(0x253)]({'name':_0x2f5607[_0x16a94e(0x22b)],'room':_0x2f5607[_0x16a94e(0x213)]});_0x2f5607[_0x16a94e(0x1d7)][_0x16a94e(0x209)](_0x5414c8=>{var _0x5fefc9=_0x16a94e;if(_0x5414c8[_0x5fefc9(0x20c)]>0x0){const _0x77d19d=_0x8533eb[_0x5fefc9(0x279)][_0x5fefc9(0x237)](_0x45bb16=>{var _0x5ab792=_0x5fefc9;_0x45bb16['product_name']==_0x5414c8[_0x5ab792(0x24e)]&&_0x45bb16[_0x5ab792(0x257)]==_0x5414c8['to_bay']&&(_0x45bb16[_0x5ab792(0x259)]=parseInt(_0x45bb16[_0x5ab792(0x259)])-parseInt(_0x5414c8[_0x5ab792(0x20c)]));});}}),await _0x8533eb[_0x16a94e(0x1e2)](),_0x2f5607[_0x16a94e(0x24f)]=_0x536bd1,_0x2f5607[_0x16a94e(0x1bf)]=_0x5f3fe7,_0x2f5607['to_warehouse']=_0x207d31,_0x2f5607[_0x16a94e(0x1d7)]=_0x2daa08,_0x2f5607[_0x16a94e(0x1eb)]=_0x401d15,_0x2f5607[_0x16a94e(0x25b)]=_0x53e42e;const _0x3d1b3f=await _0x2f5607[_0x16a94e(0x1e2)](),_0x1bce6a=await warehouse[_0x16a94e(0x253)]({'name':_0x5f3fe7,'room':_0x255ab2});_0x3d1b3f[_0x16a94e(0x1d7)]['forEach'](_0x53d8cd=>{var _0x1fa6d4=_0x16a94e;if(_0x53d8cd[_0x1fa6d4(0x20c)]>0x0){const _0x256327=_0x1bce6a[_0x1fa6d4(0x279)][_0x1fa6d4(0x237)](_0x398a03=>{var _0x51ae9c=_0x1fa6d4;_0x398a03['product_name']==_0x53d8cd[_0x51ae9c(0x24e)]&&_0x398a03[_0x51ae9c(0x257)]==_0x53d8cd[_0x51ae9c(0x272)]&&(_0x398a03['product_stock']=parseInt(_0x398a03['product_stock'])-parseInt(_0x53d8cd[_0x51ae9c(0x20c)]));});}}),await _0x1bce6a['save']();const _0x322dfa=await warehouse[_0x16a94e(0x253)]({'name':_0x207d31,'room':_0x4286});_0x3d1b3f[_0x16a94e(0x1d7)][_0x16a94e(0x209)](_0x4358b6=>{var _0x4e6789=_0x16a94e;if(_0x4358b6['to_quantity']>0x0){var _0x42bbfb=0x0;const _0x37fa2e=_0x322dfa[_0x4e6789(0x279)][_0x4e6789(0x237)](_0x43ee3c=>{var _0x197b3c=_0x4e6789;_0x43ee3c['product_name']==_0x4358b6['product_name']&&_0x43ee3c[_0x197b3c(0x257)]==_0x4358b6[_0x197b3c(0x25e)]&&(_0x43ee3c[_0x197b3c(0x259)]=parseInt(_0x43ee3c[_0x197b3c(0x259)])+parseInt(_0x4358b6[_0x197b3c(0x20c)]),_0x42bbfb++);});_0x42bbfb=='0'&&(_0x322dfa[_0x4e6789(0x279)]=_0x322dfa[_0x4e6789(0x279)][_0x4e6789(0x264)]({'product_name':_0x4358b6[_0x4e6789(0x24e)],'product_stock':_0x4358b6[_0x4e6789(0x20c)],'bay':_0x4358b6[_0x4e6789(0x25e)],'product_code':_0x4358b6[_0x4e6789(0x277)],'primary_code':_0x4358b6[_0x4e6789(0x203)],'secondary_code':_0x4358b6[_0x4e6789(0x254)],'maxProducts':_0x4358b6[_0x4e6789(0x1ed)]}));}}),await _0x322dfa['save'](),_0x1d68fb[_0x16a94e(0x1d8)]('success',_0x16a94e(0x255)),_0x56b35a[_0x16a94e(0x1c4)](_0x16a94e(0x1e3));}catch(_0x27419b){console[_0x16a94e(0x218)](_0x27419b);}}),router[a0_0x222e33(0x1f1)](a0_0x222e33(0x1f5),async(_0x438a9b,_0x1737ea)=>{var _0x2c7eba=a0_0x222e33;const {FromWareHouse:_0x5b83a1,FromRoom:_0x4fed5a,ToWarehouse:_0x4dbe88,ToRoom:_0x4b7852,primary_code:_0x4f8cae,Roomslist:_0x2a5a17}=_0x438a9b[_0x2c7eba(0x222)],_0x13274f=_0x2a5a17[_0x2c7eba(0x1f7)](','),_0xa452b5=[];async function _0x1ebd39(_0x3b303f){var _0x250f90=_0x2c7eba;const _0x37872e=await warehouse['aggregate']([{'$match':{'name':_0x5b83a1,'room':_0x3b303f}},{'$unwind':_0x250f90(0x26b)},{'$match':{'product_details.primary_code':_0x4f8cae}},{'$group':{'_id':_0x250f90(0x273),'name':{'$first':_0x250f90(0x20d)},'instock':{'$first':_0x250f90(0x1de)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x250f90(0x1c3)},'product_code':{'$first':_0x250f90(0x21e)},'bay':{'$first':_0x250f90(0x20a)},'level':{'$first':_0x250f90(0x1e8)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x250f90(0x1b7)},'unit':{'$first':_0x250f90(0x22a)},'secondary_unit':{'$first':_0x250f90(0x268)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x250f90(0x224)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x250f90(0x205)},'batch_code':{'$first':_0x250f90(0x252)},'maxPerUnit':{'$first':_0x250f90(0x24a)},'roomNamed':{'$first':_0x250f90(0x1fd)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x250f90(0x1da)}}}]),_0x4b4ae4=await warehouse[_0x250f90(0x21b)]([{'$match':{'name':_0x5b83a1,'room':_0x3b303f}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4f8cae}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x250f90(0x1de)},'primary_code':{'$first':_0x250f90(0x233)},'secondary_code':{'$first':_0x250f90(0x1c3)},'product_code':{'$first':_0x250f90(0x21e)},'bay':{'$first':_0x250f90(0x20a)},'level':{'$first':_0x250f90(0x1e8)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x250f90(0x1b7)},'unit':{'$first':_0x250f90(0x22a)},'secondary_unit':{'$first':_0x250f90(0x268)},'storage':{'$first':_0x250f90(0x26c)},'rack':{'$first':_0x250f90(0x224)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x250f90(0x205)},'batch_code':{'$first':_0x250f90(0x252)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x250f90(0x1fd)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x250f90(0x1da)}}}]);if(_0x37872e['length']>0x0)_0xa452b5[_0x250f90(0x1c2)](_0x37872e);else _0x4b4ae4['length']>0x0&&_0xa452b5[_0x250f90(0x1c2)](_0x4b4ae4);}const _0x2fcc9e=_0x13274f[_0x2c7eba(0x237)](_0x59b9bf=>_0x1ebd39(_0x59b9bf));await Promise[_0x2c7eba(0x236)](_0x2fcc9e),_0x1737ea[_0x2c7eba(0x20e)](_0xa452b5);}),router[a0_0x222e33(0x1f1)](a0_0x222e33(0x1ba),async(_0x5ac0f4,_0x31149a)=>{var _0x24205f=a0_0x222e33;const {productCode:_0x3cc3e3,bay:_0x409372,warehouses:_0x399068,room:_0x4fe4be}=_0x5ac0f4['body'];console[_0x24205f(0x218)](_0x5ac0f4[_0x24205f(0x222)]);try{const _0x35db00=await warehouse[_0x24205f(0x21b)]([{'$match':{'name':_0x399068,'room':_0x4fe4be}},{'$unwind':_0x24205f(0x26b)},{'$match':{'product_details.bay':parseInt(_0x409372)}},{'$group':{'_id':_0x24205f(0x273),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x24205f(0x20a)},'maxProducts':{'$first':_0x24205f(0x1ce)}}}]);_0x31149a[_0x24205f(0x25d)](0xc8)[_0x24205f(0x20e)](_0x35db00);}catch(_0x2ddb3b){_0x31149a[_0x24205f(0x25d)](0x194)[_0x24205f(0x20e)]({'message':_0x2ddb3b[_0x24205f(0x1ee)]});}}),module[a0_0x222e33(0x208)]=router;