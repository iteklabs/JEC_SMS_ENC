var a0_0x41b66d=a0_0x1670;(function(_0x70d6b7,_0x4c3ba8){var _0x291bbb=a0_0x1670,_0xf10bc=_0x70d6b7();while(!![]){try{var _0xe2838c=parseInt(_0x291bbb(0x13b))/0x1+-parseInt(_0x291bbb(0xe3))/0x2*(-parseInt(_0x291bbb(0x9f))/0x3)+parseInt(_0x291bbb(0xa1))/0x4+-parseInt(_0x291bbb(0x14a))/0x5+-parseInt(_0x291bbb(0xc4))/0x6+-parseInt(_0x291bbb(0xba))/0x7+-parseInt(_0x291bbb(0x99))/0x8;if(_0xe2838c===_0x4c3ba8)break;else _0xf10bc['push'](_0xf10bc['shift']());}catch(_0x2b66d6){_0xf10bc['push'](_0xf10bc['shift']());}}}(a0_0x3f57,0x5ebbe));const express=require(a0_0x41b66d(0xb4)),app=express(),router=express[a0_0x41b66d(0xce)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x41b66d(0x134)),auth=require(a0_0x41b66d(0x158)),users=require(a0_0x41b66d(0x142)),nodemailer=require(a0_0x41b66d(0x155));router[a0_0x41b66d(0xc7)](a0_0x41b66d(0x145),auth,async(_0x454459,_0xd18460)=>{var _0x575327=a0_0x41b66d;try{const {username:_0x23544b,email:_0x2eb457,role:_0x557824}=_0x454459[_0x575327(0x100)],_0x46b3d1=_0x454459[_0x575327(0x100)],_0x49850b=await profile[_0x575327(0x118)]({'email':_0x46b3d1['email']}),_0x519197=await master_shop[_0x575327(0x14b)]();let _0x57ce88;if(_0x46b3d1['role']=='staff'){const _0x32130c=await staff[_0x575327(0x118)]({'email':_0x46b3d1['email']});_0x57ce88=await transfers_finished[_0x575327(0x14b)]({'from_warehouse':_0x32130c[_0x575327(0xd1)]});}else _0x57ce88=await transfers_finished[_0x575327(0x94)]([{'$match':{'type_of_transaction':_0x575327(0xb1)}},{'$unwind':'$product'},{'$group':{'_id':_0x575327(0xb5),'invoice':{'$first':_0x575327(0x107)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x575327(0xe9)},'to_warehouse':{'$first':_0x575327(0x110)},'from_room_name':{'$addToSet':_0x575327(0xef)},'to_room_name':{'$addToSet':_0x575327(0xf1)},'finalize':{'$first':_0x575327(0xee)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x519197[0x0][_0x575327(0x13e)]==_0x575327(0x10c))var _0x5ec710=users[_0x575327(0xc9)];else{if(_0x519197[0x0][_0x575327(0x13e)]==_0x575327(0xc1))var _0x5ec710=users[_0x575327(0xc1)];else{if(_0x519197[0x0][_0x575327(0x13e)]==_0x575327(0x12f))var _0x5ec710=users[_0x575327(0x12f)];else{if(_0x519197[0x0][_0x575327(0x13e)]==_0x575327(0xeb))var _0x5ec710=users[_0x575327(0xeb)];else{if(_0x519197[0x0]['language']=='French')var _0x5ec710=users[_0x575327(0x113)];else{if(_0x519197[0x0][_0x575327(0x13e)]==_0x575327(0xe8))var _0x5ec710=users[_0x575327(0xbe)];else{if(_0x519197[0x0]['language']==_0x575327(0xcc))var _0x5ec710=users[_0x575327(0xcc)];else{if(_0x519197[0x0][_0x575327(0x13e)]==_0x575327(0x157))var _0x5ec710=users[_0x575327(0xd3)];}}}}}}}_0xd18460[_0x575327(0x9b)](_0x575327(0xbb),{'success':_0x454459[_0x575327(0x151)](_0x575327(0xab)),'errors':_0x454459[_0x575327(0x151)]('errors'),'role':_0x46b3d1,'profile':_0x49850b,'master_shop':_0x519197,'transfer':_0x57ce88,'language':_0x5ec710});}catch(_0x3d1329){console[_0x575327(0x105)](_0x3d1329);}}),router[a0_0x41b66d(0xc7)](a0_0x41b66d(0x11e),auth,async(_0x472653,_0x58d6fc)=>{var _0x4cb1ea=a0_0x41b66d;try{const {username:_0x245148,email:_0x5a1b06,role:_0x5dace7}=_0x472653['user'],_0x411289=_0x472653[_0x4cb1ea(0x100)],_0x3be988=await profile[_0x4cb1ea(0x118)]({'email':_0x411289[_0x4cb1ea(0x10f)]}),_0x2080a5=await master_shop['find']();let _0x1990b4;if(_0x411289['role']==_0x4cb1ea(0x103)){const _0xb99b0=await staff[_0x4cb1ea(0x118)]({'email':_0x411289[_0x4cb1ea(0x10f)]});_0x1990b4=await transfers_finished['find']({'from_warehouse':_0xb99b0[_0x4cb1ea(0xd1)]});}else _0x1990b4=await transfers_finished[_0x4cb1ea(0x94)]([{'$match':{'type_of_transaction':_0x4cb1ea(0xf4)}},{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x4cb1ea(0xd6)},'from_warehouse':{'$first':_0x4cb1ea(0xe9)},'to_warehouse':{'$first':_0x4cb1ea(0x110)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x4cb1ea(0xf1)},'finalize':{'$first':_0x4cb1ea(0xee)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2080a5[0x0][_0x4cb1ea(0x13e)]==_0x4cb1ea(0x10c))var _0x7ef288=users[_0x4cb1ea(0xc9)];else{if(_0x2080a5[0x0][_0x4cb1ea(0x13e)]==_0x4cb1ea(0xc1))var _0x7ef288=users[_0x4cb1ea(0xc1)];else{if(_0x2080a5[0x0][_0x4cb1ea(0x13e)]==_0x4cb1ea(0x12f))var _0x7ef288=users[_0x4cb1ea(0x12f)];else{if(_0x2080a5[0x0]['language']==_0x4cb1ea(0xeb))var _0x7ef288=users['Spanish'];else{if(_0x2080a5[0x0]['language']==_0x4cb1ea(0x113))var _0x7ef288=users[_0x4cb1ea(0x113)];else{if(_0x2080a5[0x0][_0x4cb1ea(0x13e)]==_0x4cb1ea(0xe8))var _0x7ef288=users[_0x4cb1ea(0xbe)];else{if(_0x2080a5[0x0][_0x4cb1ea(0x13e)]=='Chinese')var _0x7ef288=users['Chinese'];else{if(_0x2080a5[0x0][_0x4cb1ea(0x13e)]==_0x4cb1ea(0x157))var _0x7ef288=users[_0x4cb1ea(0xd3)];}}}}}}}_0x58d6fc['render'](_0x4cb1ea(0xfc),{'success':_0x472653[_0x4cb1ea(0x151)](_0x4cb1ea(0xab)),'errors':_0x472653[_0x4cb1ea(0x151)](_0x4cb1ea(0x98)),'role':_0x411289,'profile':_0x3be988,'master_shop':_0x2080a5,'transfer':_0x1990b4,'language':_0x7ef288});}catch(_0x335cca){console[_0x4cb1ea(0x105)](_0x335cca);}});async function getRandom8DigitNumber(){var _0x5d60d4=a0_0x41b66d;const _0xcfb41f=0x989680,_0xdd668e=0x5f5e0ff,_0x111162=Math[_0x5d60d4(0xe4)](Math[_0x5d60d4(0xf6)]()*(_0xdd668e-_0xcfb41f+0x1))+_0xcfb41f;var _0x4a600c;const _0x1d3e10=await transfers_finished['findOne']({'invoice':_0x5d60d4(0xcf)+_0x111162});return _0x1d3e10&&_0x1d3e10[_0x5d60d4(0x131)]>0x0?_0x4a600c='TRFF-'+_0x111162:_0x4a600c=_0x5d60d4(0xcf)+_0x111162,_0x4a600c;}function a0_0x1670(_0x1b6369,_0x114f98){var _0x3f578c=a0_0x3f57();return a0_0x1670=function(_0x167014,_0x59a332){_0x167014=_0x167014-0x8e;var _0x123a87=_0x3f578c[_0x167014];return _0x123a87;},a0_0x1670(_0x1b6369,_0x114f98);}router['get']('/view/add_transfer',auth,async(_0x5b5be6,_0x22e70a)=>{var _0x259c17=a0_0x41b66d;try{const {username:_0x1efe6b,email:_0x43993c,role:_0x226004}=_0x5b5be6[_0x259c17(0x100)],_0x835ff1=_0x5b5be6[_0x259c17(0x100)],_0x300e53=await profile[_0x259c17(0x118)]({'email':_0x835ff1[_0x259c17(0x10f)]}),_0x3225af=await master_shop[_0x259c17(0x14b)]();let _0x3b84e6;if(_0x835ff1[_0x259c17(0x135)]==_0x259c17(0x103)){const _0x341408=await staff[_0x259c17(0x118)]({'email':_0x835ff1['email']});_0x3b84e6=await warehouse[_0x259c17(0x94)]([{'$match':{'status':_0x259c17(0x12c),'name':_0x341408[_0x259c17(0xd1)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x3b84e6=await warehouse[_0x259c17(0x94)]([{'$match':{'status':_0x259c17(0x12c)}},{'$group':{'_id':_0x259c17(0x115),'name':{'$first':'$name'}}}]);const _0x5efa8b=await transfers_finished[_0x259c17(0x14b)]({}),_0x326a70=_0x5efa8b[_0x259c17(0x131)]+0x1,_0x5bfd6c='TRFF-'+_0x326a70[_0x259c17(0x136)]()[_0x259c17(0x97)](0x5,'0');if(_0x3225af[0x0][_0x259c17(0x13e)]==_0x259c17(0x10c))var _0x2c0697=users[_0x259c17(0xc9)];else{if(_0x3225af[0x0][_0x259c17(0x13e)]==_0x259c17(0xc1))var _0x2c0697=users['Hindi'];else{if(_0x3225af[0x0][_0x259c17(0x13e)]==_0x259c17(0x12f))var _0x2c0697=users[_0x259c17(0x12f)];else{if(_0x3225af[0x0][_0x259c17(0x13e)]=='Spanish')var _0x2c0697=users[_0x259c17(0xeb)];else{if(_0x3225af[0x0][_0x259c17(0x13e)]==_0x259c17(0x113))var _0x2c0697=users[_0x259c17(0x113)];else{if(_0x3225af[0x0][_0x259c17(0x13e)]==_0x259c17(0xe8))var _0x2c0697=users[_0x259c17(0xbe)];else{if(_0x3225af[0x0]['language']==_0x259c17(0xcc))var _0x2c0697=users[_0x259c17(0xcc)];else{if(_0x3225af[0x0][_0x259c17(0x13e)]=='Arabic\x20(ae)')var _0x2c0697=users[_0x259c17(0xd3)];}}}}}}}const _0x2c6b11=getRandom8DigitNumber();_0x2c6b11[_0x259c17(0x143)](_0x16e169=>{var _0x3cdf02=_0x259c17;_0x22e70a[_0x3cdf02(0x9b)](_0x3cdf02(0x10a),{'success':_0x5b5be6[_0x3cdf02(0x151)](_0x3cdf02(0xab)),'errors':_0x5b5be6['flash'](_0x3cdf02(0x98)),'role':_0x835ff1,'profile':_0x300e53,'master_shop':_0x3225af,'warehouse':_0x3b84e6,'language':_0x2c0697,'invoice':_0x16e169});})[_0x259c17(0xde)](_0x3712af=>{var _0x13f4c3=_0x259c17;_0x5b5be6[_0x13f4c3(0x151)](_0x13f4c3(0x98),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x22e70a[_0x13f4c3(0x10b)](_0x13f4c3(0x111));});}catch(_0x31d87b){console[_0x259c17(0x105)](_0x31d87b);}}),router['get'](a0_0x41b66d(0xd4),auth,async(_0x58844f,_0x5acdd5)=>{var _0x6233cd=a0_0x41b66d;try{const {username:_0x38765a,email:_0x1d2316,role:_0x5c0f8c}=_0x58844f[_0x6233cd(0x100)],_0x1ef04a=_0x58844f[_0x6233cd(0x100)],_0x104ac7=await profile[_0x6233cd(0x118)]({'email':_0x1ef04a[_0x6233cd(0x10f)]}),_0xe2e1c9=await master_shop['find']();let _0x12e97b;if(_0x1ef04a[_0x6233cd(0x135)]==_0x6233cd(0x103)){const _0x478e3e=await staff[_0x6233cd(0x118)]({'email':_0x1ef04a[_0x6233cd(0x10f)]});_0x12e97b=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x478e3e[_0x6233cd(0xd1)]}},{'$group':{'_id':_0x6233cd(0x115),'name':{'$first':_0x6233cd(0x115)}}}]);}else _0x12e97b=await warehouse[_0x6233cd(0x94)]([{'$match':{'status':_0x6233cd(0x12c)}},{'$group':{'_id':_0x6233cd(0x115),'name':{'$first':_0x6233cd(0x115)}}}]);const _0x31e08f=await transfers_finished[_0x6233cd(0x14b)]({}),_0x45bcd4=_0x31e08f[_0x6233cd(0x131)]+0x1,_0x5b23d9=_0x6233cd(0xcf)+_0x45bcd4['toString']()['padStart'](0x5,'0');if(_0xe2e1c9[0x0]['language']==_0x6233cd(0x10c))var _0x21212e=users[_0x6233cd(0xc9)];else{if(_0xe2e1c9[0x0]['language']=='Hindi')var _0x21212e=users[_0x6233cd(0xc1)];else{if(_0xe2e1c9[0x0][_0x6233cd(0x13e)]==_0x6233cd(0x12f))var _0x21212e=users[_0x6233cd(0x12f)];else{if(_0xe2e1c9[0x0]['language']==_0x6233cd(0xeb))var _0x21212e=users[_0x6233cd(0xeb)];else{if(_0xe2e1c9[0x0]['language']==_0x6233cd(0x113))var _0x21212e=users[_0x6233cd(0x113)];else{if(_0xe2e1c9[0x0][_0x6233cd(0x13e)]==_0x6233cd(0xe8))var _0x21212e=users[_0x6233cd(0xbe)];else{if(_0xe2e1c9[0x0][_0x6233cd(0x13e)]==_0x6233cd(0xcc))var _0x21212e=users[_0x6233cd(0xcc)];else{if(_0xe2e1c9[0x0][_0x6233cd(0x13e)]=='Arabic\x20(ae)')var _0x21212e=users[_0x6233cd(0xd3)];}}}}}}}const _0x443a2a=getRandom8DigitNumber();_0x443a2a['then'](_0x90d641=>{var _0x45eebc=_0x6233cd;_0x5acdd5[_0x45eebc(0x9b)](_0x45eebc(0xe1),{'success':_0x58844f['flash'](_0x45eebc(0xab)),'errors':_0x58844f[_0x45eebc(0x151)](_0x45eebc(0x98)),'role':_0x1ef04a,'profile':_0x104ac7,'master_shop':_0xe2e1c9,'warehouse':_0x12e97b,'language':_0x21212e,'invoice':_0x90d641});})[_0x6233cd(0xde)](_0x3ef0c5=>{var _0x3a1988=_0x6233cd;_0x58844f['flash']('errors',_0x3a1988(0x12d)),_0x5acdd5['redirect'](_0x3a1988(0x111));});}catch(_0x4b35dc){console[_0x6233cd(0x105)](_0x4b35dc);}}),router[a0_0x41b66d(0xc7)](a0_0x41b66d(0xbc),auth,async(_0x16be0b,_0x5a7ee1)=>{var _0x49dcdb=a0_0x41b66d;try{const {username:_0x54dae3,email:_0x345543,role:_0x258f7f}=_0x16be0b[_0x49dcdb(0x100)],_0xa7b351=_0x16be0b['user'],_0x4b94b9=await profile[_0x49dcdb(0x118)]({'email':_0xa7b351[_0x49dcdb(0x10f)]}),_0x2d5e02=await master_shop[_0x49dcdb(0x14b)]();let _0x1828bc;if(_0xa7b351[_0x49dcdb(0x135)]==_0x49dcdb(0x103)){const _0x21b68e=await staff[_0x49dcdb(0x118)]({'email':_0xa7b351[_0x49dcdb(0x10f)]});_0x1828bc=await warehouse['aggregate']([{'$match':{'status':_0x49dcdb(0x12c),'name':_0x21b68e['warehouse']}},{'$group':{'_id':_0x49dcdb(0x115),'name':{'$first':_0x49dcdb(0x115)}}}]);}else _0x1828bc=await warehouse[_0x49dcdb(0x94)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x49dcdb(0x115),'name':{'$first':_0x49dcdb(0x115)}}}]);const _0x15adc3=await transfers_finished[_0x49dcdb(0x14b)]({}),_0xda70a9=_0x15adc3[_0x49dcdb(0x131)]+0x1,_0x1ce4b7='TRFF-'+_0xda70a9['toString']()[_0x49dcdb(0x97)](0x5,'0');if(_0x2d5e02[0x0][_0x49dcdb(0x13e)]=='English\x20(US)')var _0x19df9b=users[_0x49dcdb(0xc9)];else{if(_0x2d5e02[0x0][_0x49dcdb(0x13e)]=='Hindi')var _0x19df9b=users[_0x49dcdb(0xc1)];else{if(_0x2d5e02[0x0][_0x49dcdb(0x13e)]==_0x49dcdb(0x12f))var _0x19df9b=users['German'];else{if(_0x2d5e02[0x0]['language']=='Spanish')var _0x19df9b=users[_0x49dcdb(0xeb)];else{if(_0x2d5e02[0x0][_0x49dcdb(0x13e)]=='French')var _0x19df9b=users[_0x49dcdb(0x113)];else{if(_0x2d5e02[0x0][_0x49dcdb(0x13e)]==_0x49dcdb(0xe8))var _0x19df9b=users[_0x49dcdb(0xbe)];else{if(_0x2d5e02[0x0][_0x49dcdb(0x13e)]==_0x49dcdb(0xcc))var _0x19df9b=users[_0x49dcdb(0xcc)];else{if(_0x2d5e02[0x0][_0x49dcdb(0x13e)]=='Arabic\x20(ae)')var _0x19df9b=users[_0x49dcdb(0xd3)];}}}}}}}const _0x26d185=getRandom8DigitNumber();_0x26d185[_0x49dcdb(0x143)](_0x5d02a7=>{var _0x1d1d55=_0x49dcdb;_0x5a7ee1[_0x1d1d55(0x9b)]('choos_transfer_logs',{'success':_0x16be0b[_0x1d1d55(0x151)](_0x1d1d55(0xab)),'errors':_0x16be0b[_0x1d1d55(0x151)](_0x1d1d55(0x98)),'role':_0xa7b351,'profile':_0x4b94b9,'master_shop':_0x2d5e02,'warehouse':_0x1828bc,'language':_0x19df9b,'invoice':_0x5d02a7});})[_0x49dcdb(0xde)](_0x27b047=>{var _0xcbea61=_0x49dcdb;_0x16be0b[_0xcbea61(0x151)](_0xcbea61(0x98),_0xcbea61(0x12d)),_0x5a7ee1[_0xcbea61(0x10b)](_0xcbea61(0x111));});}catch(_0x3f368e){console[_0x49dcdb(0x105)](_0x3f368e);}}),router['post'](a0_0x41b66d(0x101),auth,async(_0x3d1062,_0x18e55a)=>{var _0xa2c4f6=a0_0x41b66d;try{const {date:_0x4746fc,from_warehouse:_0xdea7a2,FromRoom_name:_0x35174a,to_warehouse:_0x12d1dc,ToRoom_name:_0x46ca7c,prod_name:_0x3d1925,from_prod_qty:_0x305721,from_prod_level:_0x26f8ae,from_prod_isle:_0x3ce0a8,from_prod_pallet:_0x5d4c3d,to_prod_qty:_0xd8ca2d,to_prod_level:_0x5119b6,to_prod_isle:_0x455c30,to_prod_pallet:_0x37030b,primary_code:_0x5be95d,secondary_code:_0x4f1467,product_code3:_0x41787d,note:_0x6400b1,MaxStocks_data2:_0x443411,invoice:_0x3c6448,expiry_date:_0x420676,PO_number:_0x12cfb0,ReqBy:_0x20dbf6,dateofreq:_0x14ac11,typeservicesData:_0x108951,destination:_0x54da92,deliverydate:_0x302146,driver:_0x2679a3,plate:_0x154fee,van:_0x13bf0f,DRSI:_0x4b2e6c,typevehicle:_0x1664de,TSU:_0x3ea1a7,TFU:_0x3f5b36}=_0x3d1062['body'];if(typeof _0x3d1925==_0xa2c4f6(0x147))var _0x19e239=[_0x3d1062[_0xa2c4f6(0xbf)]['prod_name']],_0x5d2acc=[_0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0xf0)]],_0xa1844f=[_0x3d1062['body'][_0xa2c4f6(0x9a)]],_0x20ff95=[_0x3d1062['body'][_0xa2c4f6(0xb3)]],_0x38473e=[_0x3d1062['body']['to_prod_level']],_0x2352e9=[_0x3d1062['body']['primary_code']],_0x56f374=[_0x3d1062['body'][_0xa2c4f6(0xa0)]],_0x113e53=[_0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x15b)]],_0x506e85=[_0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x140)]],_0x50d780=[_0x3d1062['body'][_0xa2c4f6(0xb7)]],_0x2aa232=[_0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x117)]],_0x1afb20=[_0x3d1062[_0xa2c4f6(0xbf)]['batch_code']],_0x133878=[_0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x154)]],_0x10461e=[_0x3d1062[_0xa2c4f6(0xbf)]['product_date']],_0x39bac3=[_0x3d1062[_0xa2c4f6(0xbf)]['MaxStocks_data']],_0x36dcf8=[_0x3d1062[_0xa2c4f6(0xbf)]['maxPerUnit']],_0x5ef84f=[_0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x116)]],_0x315812=[_0x3d1062['body']['RoomAssigned']],_0x16d814=[_0x3d1062['body'][_0xa2c4f6(0xd0)]],_0x14f117=[_0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x10e)]],_0x498acb=[_0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0xb6)]];else var _0x19e239=[..._0x3d1062[_0xa2c4f6(0xbf)]['prod_name']],_0x5d2acc=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0xf0)]],_0xa1844f=[..._0x3d1062['body'][_0xa2c4f6(0x9a)]],_0x20ff95=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0xb3)]],_0x38473e=[..._0x3d1062['body'][_0xa2c4f6(0x10d)]],_0x2352e9=[..._0x3d1062['body'][_0xa2c4f6(0xe2)]],_0x56f374=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0xa0)]],_0x113e53=[..._0x3d1062[_0xa2c4f6(0xbf)]['product_code3']],_0x506e85=[..._0x3d1062[_0xa2c4f6(0xbf)]['MaxStocks_data2']],_0x50d780=[..._0x3d1062['body']['primary_unit']],_0x2aa232=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x117)]],_0x1afb20=[..._0x3d1062[_0xa2c4f6(0xbf)]['batch_code']],_0x133878=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x154)]],_0x10461e=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0x9c)]],_0x39bac3=[..._0x3d1062['body']['MaxStocks_data']],_0x36dcf8=[..._0x3d1062[_0xa2c4f6(0xbf)]['maxPerUnit']],_0x5ef84f=[..._0x3d1062[_0xa2c4f6(0xbf)]['prod_cat']],_0x315812=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0xad)]],_0x16d814=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0xd0)]],_0x14f117=[..._0x3d1062['body']['from_invoice']],_0x498acb=[..._0x3d1062[_0xa2c4f6(0xbf)][_0xa2c4f6(0xb6)]];const _0x4f4c86=_0x19e239[_0xa2c4f6(0x102)](_0x45fbdd=>{return _0x45fbdd={'product_name':_0x45fbdd};});_0x5d2acc['forEach']((_0x1a911f,_0x19974d)=>{var _0x542096=_0xa2c4f6;_0x4f4c86[_0x19974d][_0x542096(0xc3)]=_0x1a911f;}),_0xa1844f[_0xa2c4f6(0xd5)]((_0x4a5f24,_0x2ddb38)=>{var _0x5aab8b=_0xa2c4f6,_0x24d4a3=_0x4a5f24[_0x5aab8b(0xca)](/[A-Za-z]+/)[0x0],_0xdb02de=parseInt(_0x4a5f24[_0x5aab8b(0xca)](/\d+/)[0x0]);_0x4f4c86[_0x2ddb38][_0x5aab8b(0xf3)]=_0xdb02de,_0x4f4c86[_0x2ddb38][_0x5aab8b(0x14f)]=_0x24d4a3;}),_0x498acb[_0xa2c4f6(0xd5)]((_0xbe3841,_0x34a905)=>{var _0x2c56b3=_0xa2c4f6;_0x4f4c86[_0x34a905][_0x2c56b3(0xb6)]=_0xbe3841;}),_0x14f117[_0xa2c4f6(0xd5)]((_0x8dab7c,_0x450872)=>{var _0x1bcbc8=_0xa2c4f6;_0x4f4c86[_0x450872][_0x1bcbc8(0x10e)]=_0x8dab7c;}),_0x20ff95[_0xa2c4f6(0xd5)]((_0x1369bf,_0x503f1a)=>{_0x4f4c86[_0x503f1a]['to_quantity']=_0x1369bf;}),_0x38473e[_0xa2c4f6(0xd5)]((_0xe3cfd9,_0x1d05ba)=>{var _0x2325c1=_0xa2c4f6,_0x18ceb8=_0xe3cfd9[_0x2325c1(0xca)](/[A-Za-z]+/)[0x0],_0x57d037=parseInt(_0xe3cfd9['match'](/\d+/)[0x0]);_0x4f4c86[_0x1d05ba][_0x2325c1(0x112)]=_0x18ceb8,_0x4f4c86[_0x1d05ba]['to_bay']=_0x57d037;}),_0x2352e9[_0xa2c4f6(0xd5)]((_0x2c18e6,_0x2681d2)=>{var _0x56b0be=_0xa2c4f6;_0x4f4c86[_0x2681d2][_0x56b0be(0xe2)]=_0x2c18e6;}),_0x56f374[_0xa2c4f6(0xd5)]((_0x3f133d,_0x593adf)=>{var _0x50df33=_0xa2c4f6;_0x4f4c86[_0x593adf][_0x50df33(0xa0)]=_0x3f133d;}),_0x113e53['forEach']((_0x535dd3,_0x322fab)=>{_0x4f4c86[_0x322fab]['product_code']=_0x535dd3;}),_0x506e85[_0xa2c4f6(0xd5)]((_0x32e30e,_0x3ccaea)=>{var _0x1671a9=_0xa2c4f6;_0x4f4c86[_0x3ccaea][_0x1671a9(0xdb)]=_0x32e30e;}),_0x50d780['forEach']((_0x52c094,_0x128639)=>{var _0x33fcb0=_0xa2c4f6;_0x4f4c86[_0x128639][_0x33fcb0(0xed)]=_0x52c094;}),_0x2aa232[_0xa2c4f6(0xd5)]((_0x3dd3c2,_0x5512f6)=>{var _0x1a5a3b=_0xa2c4f6;_0x4f4c86[_0x5512f6][_0x1a5a3b(0x117)]=_0x3dd3c2;}),_0x1afb20[_0xa2c4f6(0xd5)]((_0x465aa1,_0xa2b3b4)=>{var _0x4c4408=_0xa2c4f6;_0x4f4c86[_0xa2b3b4][_0x4c4408(0x121)]=_0x465aa1;}),_0x133878['forEach']((_0x2f71ec,_0x45bb5b)=>{var _0x33750a=_0xa2c4f6;_0x4f4c86[_0x45bb5b][_0x33750a(0x154)]=_0x2f71ec;}),_0x10461e['forEach']((_0x3d10b6,_0x4fefaf)=>{var _0x591730=_0xa2c4f6;_0x4f4c86[_0x4fefaf][_0x591730(0x14c)]=_0x3d10b6;}),_0x39bac3[_0xa2c4f6(0xd5)]((_0x1303cc,_0x19f6e4)=>{_0x4f4c86[_0x19f6e4]['maxProducts']=_0x1303cc;}),_0x36dcf8[_0xa2c4f6(0xd5)]((_0x5dec8d,_0x5cc55d)=>{var _0x27e14f=_0xa2c4f6;_0x4f4c86[_0x5cc55d][_0x27e14f(0xcb)]=_0x5dec8d;}),_0x5ef84f[_0xa2c4f6(0xd5)]((_0x3f62cb,_0x58c4d3)=>{var _0x32ab8a=_0xa2c4f6;_0x4f4c86[_0x58c4d3][_0x32ab8a(0x116)]=_0x3f62cb;}),_0x315812[_0xa2c4f6(0xd5)]((_0x36b87d,_0x7ac884)=>{_0x4f4c86[_0x7ac884]['from_room_name']=_0x36b87d;}),_0x16d814['forEach']((_0x3d582b,_0x20a9ef)=>{var _0xb0b51e=_0xa2c4f6;_0x4f4c86[_0x20a9ef][_0xb0b51e(0xf9)]=_0x3d582b;});const _0x31f1dc=_0x4f4c86['filter'](_0x567639=>_0x567639[_0xa2c4f6(0xa9)]!=='0'&&_0x567639[_0xa2c4f6(0xa9)]!==''||_0x567639['to_floorlevel']!=='0'&&_0x567639['to_floorlevel']!=='');var _0x2aaf04=0x0;_0x31f1dc['forEach'](_0x588966=>{parseInt(_0x588966['from_quantity'])<parseInt(_0x588966['to_quantity'])&&_0x2aaf04++;});if(_0x2aaf04!=0x0)return _0x3d1062['flash'](_0xa2c4f6(0x98),_0xa2c4f6(0x108)),_0x18e55a[_0xa2c4f6(0x10b)](_0xa2c4f6(0xc6));const _0x36586b=new transfers_logs();await _0x36586b[_0xa2c4f6(0xe5)]();for(let _0x3df7dc=0x0;_0x3df7dc<=_0x16d814[_0xa2c4f6(0x131)]-0x1;_0x3df7dc++){_0x4f4c86[_0x3df7dc]['To_invoice']=_0xa2c4f6(0xd2)+_0x36586b[_0xa2c4f6(0x137)][_0xa2c4f6(0x136)]()[_0xa2c4f6(0x97)](0x8,'0');}const _0x22620c=new transfers_finished({'date':_0x4746fc,'from_warehouse':_0xdea7a2,'to_warehouse':_0xdea7a2,'product':_0x31f1dc,'note':_0x6400b1,'invoice':_0xa2c4f6(0xd2)+_0x36586b[_0xa2c4f6(0x137)][_0xa2c4f6(0x136)]()['padStart'](0x8,'0'),'type_of_process':_0xa2c4f6(0xac),'type_of_transaction':_0xa2c4f6(0xf4),'PO_number':_0x12cfb0,'RequestedBy':_0x20dbf6,'DateofRequest':_0x14ac11,'typeservices':_0x108951,'destination':_0x54da92,'deliverydate':_0x302146,'driver':_0x2679a3,'plate':_0x154fee,'van':_0x13bf0f,'DRSI':_0x4b2e6c,'typevehicle':_0x1664de,'TSU':_0x3ea1a7,'TFU':_0x3f5b36}),_0x169866=await _0x22620c['save']();_0x3d1062[_0xa2c4f6(0x151)](_0xa2c4f6(0xab),'Product\x20Transfer\x20successfully'),_0x18e55a['redirect'](_0xa2c4f6(0xf8)+_0x169866[_0xa2c4f6(0xcd)]);}catch(_0x5c11df){console['log'](_0x5c11df),_0x18e55a['status'](0xc8)[_0xa2c4f6(0x128)]({'errorMessage':_0x5c11df['message']});}}),router['post']('/view/addlog',auth,async(_0x5e6d02,_0x1d4df0)=>{var _0x550eea=a0_0x41b66d;try{const {date:_0x277d54,from_warehouse:_0x3ad654,FromRoom_name:_0x442dad,to_warehouse:_0x51871b,ToRoom_name:_0x4e3edc,prod_name:_0x523ce4,from_prod_qty:_0x1a378b,from_prod_level:_0x4d86a8,from_prod_isle:_0x2b8094,from_prod_pallet:_0x5bc99c,to_prod_qty:_0x5c9853,to_prod_level:_0x2a7fac,to_prod_isle:_0x11de5a,to_prod_pallet:_0x46e3b6,primary_code:_0x48ea37,secondary_code:_0x504f56,product_code3:_0x4c194c,note:_0x49df26,MaxStocks_data2:_0x1e0dc3,invoice:_0x2320fd,expiry_date:_0x1d213b,PO_number_loc:_0x55358c,ReqBy_loc:_0x49750a,dateofreq_loc:_0x2f47c2,typeservices_loc_Data:_0x12df21,destination_loc:_0x17c928,deliverydate_loc:_0x362408,driver_loc:_0x4aaef3,plate_loc:_0x218f09,van_loc:_0x82a3c5,DRSI_loc:_0x5d21c2,typevehicle_loc:_0x51c2a0,TSU_loc:_0x3d880b,TFU_loc:_0x228a35}=_0x5e6d02[_0x550eea(0xbf)];if(typeof _0x523ce4==_0x550eea(0x147))var _0xc76819=[_0x5e6d02['body'][_0x550eea(0xa6)]],_0x11cf6d=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xf0)]],_0x5e0869=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x9a)]],_0x4b1ab5=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xb3)]],_0x2d3715=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x10d)]],_0x4af41a=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xe2)]],_0x222e5b=[_0x5e6d02['body']['secondary_code']],_0x5d7c87=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x15b)]],_0x2ef07e=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x140)]],_0x555ae0=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xb7)]],_0x5e295a=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x117)]],_0x5a3c58=[_0x5e6d02[_0x550eea(0xbf)]['batch_code']],_0xb3c5b7=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x154)]],_0x4c32bf=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x9c)]],_0x1f1953=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x14d)]],_0x11a965=[_0x5e6d02['body'][_0x550eea(0xcb)]],_0x543bef=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x116)]],_0x1080f7=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xad)]],_0x222c11=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xd0)]],_0x1720de=[_0x5e6d02[_0x550eea(0xbf)]['from_invoice']],_0x163cd1=[_0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xb6)]];else var _0xc76819=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xa6)]],_0x11cf6d=[..._0x5e6d02['body'][_0x550eea(0xf0)]],_0x5e0869=[..._0x5e6d02[_0x550eea(0xbf)]['from_prod_level2']],_0x4b1ab5=[..._0x5e6d02['body']['New_Qty_Converted']],_0x2d3715=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x10d)]],_0x4af41a=[..._0x5e6d02['body'][_0x550eea(0xe2)]],_0x222e5b=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xa0)]],_0x5d7c87=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x15b)]],_0x2ef07e=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x140)]],_0x555ae0=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xb7)]],_0x5e295a=[..._0x5e6d02[_0x550eea(0xbf)]['secondary_unit']],_0x5a3c58=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x121)]],_0xb3c5b7=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x154)]],_0x4c32bf=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x9c)]],_0x1f1953=[..._0x5e6d02['body'][_0x550eea(0x14d)]],_0x11a965=[..._0x5e6d02['body'][_0x550eea(0xcb)]],_0x543bef=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x116)]],_0x1080f7=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xad)]],_0x222c11=[..._0x5e6d02[_0x550eea(0xbf)]['ToRoomAssigned']],_0x1720de=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0x10e)]],_0x163cd1=[..._0x5e6d02[_0x550eea(0xbf)][_0x550eea(0xb6)]];const _0x52ba87=_0xc76819['map'](_0x2650c7=>{return _0x2650c7={'product_name':_0x2650c7};});_0x11cf6d[_0x550eea(0xd5)]((_0x75b1ab,_0x51a853)=>{_0x52ba87[_0x51a853]['from_quantity']=_0x75b1ab;}),_0x5e0869['forEach']((_0x1ebda6,_0x3c7538)=>{var _0x25b8a0=_0x550eea,_0x17c137=_0x1ebda6[_0x25b8a0(0xca)](/[A-Za-z]+/)[0x0],_0x16e321=parseInt(_0x1ebda6[_0x25b8a0(0xca)](/\d+/)[0x0]);_0x52ba87[_0x3c7538][_0x25b8a0(0xf3)]=_0x16e321,_0x52ba87[_0x3c7538][_0x25b8a0(0x14f)]=_0x17c137;}),_0x163cd1[_0x550eea(0xd5)]((_0x11e144,_0xc84d71)=>{var _0x2552d2=_0x550eea;_0x52ba87[_0xc84d71][_0x2552d2(0xb6)]=_0x11e144;}),_0x1720de[_0x550eea(0xd5)]((_0x8a8060,_0x586897)=>{var _0x4ca206=_0x550eea;_0x52ba87[_0x586897][_0x4ca206(0x10e)]=_0x8a8060;}),_0x4b1ab5[_0x550eea(0xd5)]((_0x263050,_0x48ea9a)=>{var _0x25d1a=_0x550eea;_0x52ba87[_0x48ea9a][_0x25d1a(0xa9)]=_0x263050;}),_0x2d3715['forEach']((_0x624148,_0x4b5549)=>{var _0x12ccc6=_0x550eea,_0x18b083=_0x624148[_0x12ccc6(0xca)](/[A-Za-z]+/)[0x0],_0x845917=parseInt(_0x624148[_0x12ccc6(0xca)](/\d+/)[0x0]);_0x52ba87[_0x4b5549][_0x12ccc6(0x112)]=_0x18b083,_0x52ba87[_0x4b5549]['to_bay']=_0x845917;}),_0x4af41a[_0x550eea(0xd5)]((_0x3801b6,_0x2a3dee)=>{var _0x352a5a=_0x550eea;_0x52ba87[_0x2a3dee][_0x352a5a(0xe2)]=_0x3801b6;}),_0x222e5b['forEach']((_0x19e7b2,_0x4779f7)=>{var _0x10a29d=_0x550eea;_0x52ba87[_0x4779f7][_0x10a29d(0xa0)]=_0x19e7b2;}),_0x5d7c87[_0x550eea(0xd5)]((_0xda56eb,_0x201ceb)=>{var _0x120ff0=_0x550eea;_0x52ba87[_0x201ceb][_0x120ff0(0x12a)]=_0xda56eb;}),_0x2ef07e['forEach']((_0x117e50,_0x47872a)=>{var _0x1725e4=_0x550eea;_0x52ba87[_0x47872a][_0x1725e4(0xdb)]=_0x117e50;}),_0x555ae0['forEach']((_0x3051e8,_0x2d3a41)=>{var _0x1810d1=_0x550eea;_0x52ba87[_0x2d3a41][_0x1810d1(0xed)]=_0x3051e8;}),_0x5e295a[_0x550eea(0xd5)]((_0x4d3572,_0x3a069f)=>{var _0x5ef0a8=_0x550eea;_0x52ba87[_0x3a069f][_0x5ef0a8(0x117)]=_0x4d3572;}),_0x5a3c58[_0x550eea(0xd5)]((_0x45889b,_0x6d287f)=>{var _0x2b7004=_0x550eea;_0x52ba87[_0x6d287f][_0x2b7004(0x121)]=_0x45889b;}),_0xb3c5b7[_0x550eea(0xd5)]((_0x52fd72,_0x128c51)=>{var _0x1a5867=_0x550eea;_0x52ba87[_0x128c51][_0x1a5867(0x154)]=_0x52fd72;}),_0x4c32bf[_0x550eea(0xd5)]((_0x1e7036,_0x39a779)=>{var _0x56e784=_0x550eea;_0x52ba87[_0x39a779][_0x56e784(0x14c)]=_0x1e7036;}),_0x1f1953['forEach']((_0x10e135,_0x4c4180)=>{var _0x300c5d=_0x550eea;_0x52ba87[_0x4c4180][_0x300c5d(0xdb)]=_0x10e135;}),_0x11a965[_0x550eea(0xd5)]((_0x482882,_0x38fcb5)=>{_0x52ba87[_0x38fcb5]['maxPerUnit']=_0x482882;}),_0x543bef[_0x550eea(0xd5)]((_0x3af9c7,_0xc0435f)=>{var _0x1a31e7=_0x550eea;_0x52ba87[_0xc0435f][_0x1a31e7(0x116)]=_0x3af9c7;}),_0x1080f7[_0x550eea(0xd5)]((_0xc4beb5,_0x586a00)=>{var _0x210165=_0x550eea;_0x52ba87[_0x586a00][_0x210165(0xec)]=_0xc4beb5;}),_0x222c11[_0x550eea(0xd5)]((_0x147e51,_0x5e82c6)=>{_0x52ba87[_0x5e82c6]['to_room_name']=_0x147e51;});const _0x561bb6=_0x52ba87[_0x550eea(0xea)](_0x548ebb=>_0x548ebb[_0x550eea(0xa9)]!=='0'&&_0x548ebb[_0x550eea(0xa9)]!==''||_0x548ebb[_0x550eea(0xf7)]!=='0'&&_0x548ebb[_0x550eea(0xf7)]!=='');var _0x3b8aad=0x0;_0x561bb6[_0x550eea(0xd5)](_0x36c7a9=>{var _0x584713=_0x550eea;parseInt(_0x36c7a9[_0x584713(0xc3)])<parseInt(_0x36c7a9[_0x584713(0xa9)])&&_0x3b8aad++;});if(_0x3b8aad!=0x0)return _0x5e6d02[_0x550eea(0x151)](_0x550eea(0x98),_0x550eea(0x108)),_0x1d4df0[_0x550eea(0x10b)](_0x550eea(0xc6));const _0x315e87=new transfers_logs();await _0x315e87['save']();for(let _0x3854ef=0x0;_0x3854ef<=_0x222c11[_0x550eea(0x131)]-0x1;_0x3854ef++){_0x52ba87[_0x3854ef][_0x550eea(0xae)]=_0x550eea(0xd2)+_0x315e87[_0x550eea(0x137)][_0x550eea(0x136)]()[_0x550eea(0x97)](0x8,'0');}const _0x329413=new transfers_finished({'date':_0x277d54,'from_warehouse':_0x3ad654,'to_warehouse':_0x51871b,'product':_0x561bb6,'note':_0x49df26,'invoice':_0x550eea(0xd2)+_0x315e87[_0x550eea(0x137)][_0x550eea(0x136)]()[_0x550eea(0x97)](0x8,'0'),'type_of_transaction':_0x550eea(0xf4),'type_of_process':_0x550eea(0xb8),'PO_number':_0x55358c,'RequestedBy':_0x49750a,'DateofRequest':_0x2f47c2,'typeservices':_0x12df21,'destination':_0x17c928,'deliverydate':_0x362408,'driver':_0x4aaef3,'plate':_0x218f09,'van':_0x82a3c5,'DRSI':_0x5d21c2,'typevehicle':_0x51c2a0,'TSU':_0x3d880b,'TFU':_0x228a35}),_0x2e62f3=await _0x329413[_0x550eea(0xe5)]();_0x5e6d02[_0x550eea(0x151)](_0x550eea(0xab),'Product\x20Transfer\x20successfully'),_0x1d4df0['redirect'](_0x550eea(0xf8)+_0x2e62f3[_0x550eea(0xcd)]);}catch(_0x1c2ef6){console[_0x550eea(0x105)](_0x1c2ef6),_0x1d4df0[_0x550eea(0xe7)](0xc8)[_0x550eea(0x128)]({'errorMessage':_0x1c2ef6[_0x550eea(0x119)]});}}),router[a0_0x41b66d(0xbd)](a0_0x41b66d(0x91),auth,async(_0x598afd,_0x1f2327)=>{var _0x4a6895=a0_0x41b66d;try{const {date:_0x330ec1,from_warehouse:_0x454c73,FromRoom_name:_0x597c51,to_warehouse:_0x589129,ToRoom_name:_0x30ea8c,prod_name:_0x4ff664,from_prod_qty:_0x3c9efb,from_prod_level:_0x2c16b7,from_prod_isle:_0x462f52,from_prod_pallet:_0x52e78b,to_prod_qty:_0x4504ab,to_prod_level:_0x5831fc,to_prod_isle:_0x2c9f77,to_prod_pallet:_0x49bff5,primary_code:_0xea122a,secondary_code:_0x4c4b35,product_code3:_0x336b70,note:_0x35c30b,MaxStocks_data2:_0x1fb7ff,invoice:_0x1d9355,expiry_date:_0x10ec10,PO_number:_0x34e1d4,ReqBy:_0x15655d,dateofreq:_0x4bf23d,typeservicesData:_0x479f9c,destination:_0x35e358,deliverydate:_0x4f2d95,driver:_0x41e0c7,plate:_0x5211c9,van:_0x5494a3,DRSI:_0x2540bb,typevehicle:_0x3b111f,TSU:_0x1e0816,TFU:_0xea9bf3}=_0x598afd[_0x4a6895(0xbf)];if(typeof _0x4ff664=='string')var _0x4d6ab8=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xa6)]],_0x107f49=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xf0)]],_0xe55e94=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x9a)]],_0xd82157=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xb3)]],_0xe3022f=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x10d)]],_0x36702c=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xe2)]],_0x3b1b84=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xa0)]],_0x50503c=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x15b)]],_0x17575c=[_0x598afd[_0x4a6895(0xbf)]['MaxStocks_data2']],_0x17af59=[_0x598afd['body'][_0x4a6895(0xb7)]],_0x204e0f=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x117)]],_0xa7ab51=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x121)]],_0xb17d42=[_0x598afd['body'][_0x4a6895(0x154)]],_0x3ebe98=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x9c)]],_0x8ad1de=[_0x598afd[_0x4a6895(0xbf)]['MaxStocks_data']],_0x4b8b2b=[_0x598afd[_0x4a6895(0xbf)]['maxPerUnit']],_0x43ee53=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x116)]],_0x171020=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xad)]],_0x160cbe=[_0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xd0)]],_0x219fd7=[_0x598afd[_0x4a6895(0xbf)]['from_invoice']],_0x2ec024=[_0x598afd['body']['id_transaction']];else var _0x4d6ab8=[..._0x598afd[_0x4a6895(0xbf)]['prod_name']],_0x107f49=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xf0)]],_0xe55e94=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x9a)]],_0xd82157=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xb3)]],_0xe3022f=[..._0x598afd[_0x4a6895(0xbf)]['to_prod_level']],_0x36702c=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xe2)]],_0x3b1b84=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xa0)]],_0x50503c=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x15b)]],_0x17575c=[..._0x598afd['body'][_0x4a6895(0x140)]],_0x17af59=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xb7)]],_0x204e0f=[..._0x598afd['body'][_0x4a6895(0x117)]],_0xa7ab51=[..._0x598afd['body']['batch_code']],_0xb17d42=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x154)]],_0x3ebe98=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x9c)]],_0x8ad1de=[..._0x598afd[_0x4a6895(0xbf)]['MaxStocks_data']],_0x4b8b2b=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xcb)]],_0x43ee53=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x116)]],_0x171020=[..._0x598afd[_0x4a6895(0xbf)]['RoomAssigned']],_0x160cbe=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xd0)]],_0x219fd7=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0x10e)]],_0x2ec024=[..._0x598afd[_0x4a6895(0xbf)][_0x4a6895(0xb6)]];const _0x505bb6=_0x4d6ab8['map'](_0x5c8891=>{return _0x5c8891={'product_name':_0x5c8891};});_0x107f49[_0x4a6895(0xd5)]((_0x14d6f0,_0x4c313a)=>{var _0x3534c9=_0x4a6895;_0x505bb6[_0x4c313a][_0x3534c9(0xc3)]=_0x14d6f0;}),_0xe55e94['forEach']((_0x382b61,_0x1fc60b)=>{var _0x9a6c8e=_0x4a6895,_0x27c2f3=_0x382b61[_0x9a6c8e(0xca)](/[A-Za-z]+/)[0x0],_0x1e40ff=parseInt(_0x382b61[_0x9a6c8e(0xca)](/\d+/)[0x0]);_0x505bb6[_0x1fc60b][_0x9a6c8e(0xf3)]=_0x1e40ff,_0x505bb6[_0x1fc60b][_0x9a6c8e(0x14f)]=_0x27c2f3;}),_0x2ec024[_0x4a6895(0xd5)]((_0x3eb0e5,_0x338662)=>{var _0x1ad9b5=_0x4a6895;_0x505bb6[_0x338662][_0x1ad9b5(0xb6)]=_0x3eb0e5;}),_0x219fd7['forEach']((_0x116008,_0x27c548)=>{var _0x3e2001=_0x4a6895;_0x505bb6[_0x27c548][_0x3e2001(0x10e)]=_0x116008;}),_0xd82157[_0x4a6895(0xd5)]((_0x50139e,_0x1ecad0)=>{var _0x56b270=_0x4a6895;_0x505bb6[_0x1ecad0][_0x56b270(0xa9)]=_0x50139e;}),_0xe3022f[_0x4a6895(0xd5)]((_0xc3e933,_0x26e75b)=>{var _0x1eceac=_0x4a6895,_0x1c964d=_0xc3e933['match'](/[A-Za-z]+/)[0x0],_0x589ab2=parseInt(_0xc3e933[_0x1eceac(0xca)](/\d+/)[0x0]);_0x505bb6[_0x26e75b]['to_level']=_0x1c964d,_0x505bb6[_0x26e75b][_0x1eceac(0xc2)]=_0x589ab2;}),_0x36702c[_0x4a6895(0xd5)]((_0x49de6f,_0x5156db)=>{var _0x51bb84=_0x4a6895;_0x505bb6[_0x5156db][_0x51bb84(0xe2)]=_0x49de6f;}),_0x3b1b84[_0x4a6895(0xd5)]((_0x4a3c47,_0x48d859)=>{_0x505bb6[_0x48d859]['secondary_code']=_0x4a3c47;}),_0x50503c[_0x4a6895(0xd5)]((_0x3c479f,_0x6de64d)=>{var _0xe89556=_0x4a6895;_0x505bb6[_0x6de64d][_0xe89556(0x12a)]=_0x3c479f;}),_0x17575c['forEach']((_0x447f54,_0x227e77)=>{_0x505bb6[_0x227e77]['maxProducts']=_0x447f54;}),_0x17af59[_0x4a6895(0xd5)]((_0x3a8e95,_0x2873ba)=>{var _0x35359e=_0x4a6895;_0x505bb6[_0x2873ba][_0x35359e(0xed)]=_0x3a8e95;}),_0x204e0f['forEach']((_0x2df2b5,_0x2c0f1e)=>{var _0x389374=_0x4a6895;_0x505bb6[_0x2c0f1e][_0x389374(0x117)]=_0x2df2b5;}),_0xa7ab51[_0x4a6895(0xd5)]((_0x497c7f,_0x3dc0c6)=>{var _0x2293be=_0x4a6895;_0x505bb6[_0x3dc0c6][_0x2293be(0x121)]=_0x497c7f;}),_0xb17d42[_0x4a6895(0xd5)]((_0x213d0d,_0x536b03)=>{var _0x519402=_0x4a6895;_0x505bb6[_0x536b03][_0x519402(0x154)]=_0x213d0d;}),_0x3ebe98[_0x4a6895(0xd5)]((_0x299e45,_0xde2178)=>{var _0x33bd9f=_0x4a6895;_0x505bb6[_0xde2178][_0x33bd9f(0x14c)]=_0x299e45;}),_0x8ad1de[_0x4a6895(0xd5)]((_0x1a90bc,_0x90ac9e)=>{var _0xe52fb6=_0x4a6895;_0x505bb6[_0x90ac9e][_0xe52fb6(0xdb)]=_0x1a90bc;}),_0x4b8b2b['forEach']((_0x4557d5,_0x5b544c)=>{var _0x456fae=_0x4a6895;_0x505bb6[_0x5b544c][_0x456fae(0xcb)]=_0x4557d5;}),_0x43ee53['forEach']((_0x3e000b,_0x39b90d)=>{var _0x7dc831=_0x4a6895;_0x505bb6[_0x39b90d][_0x7dc831(0x116)]=_0x3e000b;}),_0x171020[_0x4a6895(0xd5)]((_0x3f8cff,_0x29e74b)=>{var _0x45ace1=_0x4a6895;_0x505bb6[_0x29e74b][_0x45ace1(0xec)]=_0x3f8cff;}),_0x160cbe[_0x4a6895(0xd5)]((_0x4345af,_0x486e5c)=>{var _0x39f5f4=_0x4a6895;_0x505bb6[_0x486e5c][_0x39f5f4(0xf9)]=_0x4345af;});const _0x119a32=_0x505bb6[_0x4a6895(0xea)](_0x53c5c8=>_0x53c5c8[_0x4a6895(0xa9)]!=='0'&&_0x53c5c8[_0x4a6895(0xa9)]!==''||_0x53c5c8[_0x4a6895(0xf7)]!=='0'&&_0x53c5c8[_0x4a6895(0xf7)]!=='');var _0x28126c=0x0;_0x119a32[_0x4a6895(0xd5)](_0x31f29c=>{parseInt(_0x31f29c['from_quantity'])<parseInt(_0x31f29c['to_quantity'])&&_0x28126c++;});if(_0x28126c!=0x0)return _0x598afd[_0x4a6895(0x151)](_0x4a6895(0x98),_0x4a6895(0x108)),_0x1f2327['redirect'](_0x4a6895(0xc6));const _0x771830=new invoice_for_transfer();await _0x771830['save']();for(let _0x39f1a3=0x0;_0x39f1a3<=_0x160cbe[_0x4a6895(0x131)]-0x1;_0x39f1a3++){_0x505bb6[_0x39f1a3][_0x4a6895(0xae)]='TRF-'+_0x771830[_0x4a6895(0x137)][_0x4a6895(0x136)]()['padStart'](0x8,'0');}const _0x4a6449=new transfers_finished({'date':_0x330ec1,'from_warehouse':_0x454c73,'to_warehouse':_0x454c73,'product':_0x119a32,'note':_0x35c30b,'invoice':_0x4a6895(0x13d)+_0x771830[_0x4a6895(0x137)][_0x4a6895(0x136)]()['padStart'](0x8,'0'),'type_of_process':_0x4a6895(0xac),'type_of_transaction':_0x4a6895(0xb1),'PO_number':_0x34e1d4,'RequestedBy':_0x15655d,'DateofRequest':_0x4bf23d,'typeservices':_0x479f9c,'destination':_0x35e358,'deliverydate':_0x4f2d95,'driver':_0x41e0c7,'plate':_0x5211c9,'van':_0x5494a3,'DRSI':_0x2540bb,'typevehicle':_0x3b111f,'TSU':_0x1e0816,'TFU':_0xea9bf3}),_0x443c41=await _0x4a6449[_0x4a6895(0xe5)]();_0x598afd['flash'](_0x4a6895(0xab),_0x4a6895(0x149)),_0x1f2327[_0x4a6895(0x10b)]('/transfer_finished/preview/'+_0x443c41[_0x4a6895(0xcd)]);}catch(_0x506453){console[_0x4a6895(0x105)](_0x506453),_0x1f2327[_0x4a6895(0xe7)](0xc8)[_0x4a6895(0x128)]({'errorMessage':_0x506453[_0x4a6895(0x119)]});}}),router['post'](a0_0x41b66d(0x109),auth,async(_0x37840a,_0x492b96)=>{var _0x4884f9=a0_0x41b66d;try{const {date:_0x47f331,from_warehouse:_0x54daf4,FromRoom_name:_0x3483f9,to_warehouse:_0x3b7de1,ToRoom_name:_0x2ee0a3,prod_name:_0xbbfbab,from_prod_qty:_0x18e4c3,from_prod_level:_0x256cd3,from_prod_isle:_0x2344b9,from_prod_pallet:_0x10ebdf,to_prod_qty:_0x233b22,to_prod_level:_0x3dc3bf,to_prod_isle:_0x36c22d,to_prod_pallet:_0x398270,primary_code:_0x360283,secondary_code:_0x5d555c,product_code3:_0x5c0c64,note:_0x3a42c4,MaxStocks_data2:_0xf51082,invoice:_0xcde8ef,expiry_date:_0x184e52,PO_number_loc:_0x374bde,ReqBy_loc:_0x3126a7,dateofreq_loc:_0x4a1a3b,typeservices_loc_Data:_0xf38266,destination_loc:_0x5496ad,deliverydate_loc:_0x3b74c3,driver_loc:_0x25bf08,plate_loc:_0x1cef45,van_loc:_0x11a62c,DRSI_loc:_0x9281f2,typevehicle_loc:_0x47c22d,TSU_loc:_0x5a2df7,TFU_loc:_0x5be42b}=_0x37840a[_0x4884f9(0xbf)];if(typeof _0xbbfbab==_0x4884f9(0x147))var _0xe537e4=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xa6)]],_0x2fe653=[_0x37840a['body']['from_prod_qty']],_0x541402=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x9a)]],_0x814766=[_0x37840a[_0x4884f9(0xbf)]['New_Qty_Converted']],_0x17d1cb=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x10d)]],_0x42265e=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xe2)]],_0x909650=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xa0)]],_0x24f04f=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x15b)]],_0x555e6a=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x140)]],_0x447a27=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xb7)]],_0x59910a=[_0x37840a[_0x4884f9(0xbf)]['secondary_unit']],_0x53e998=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x121)]],_0x2996b0=[_0x37840a['body']['expiry_date']],_0x3c9dba=[_0x37840a['body']['product_date']],_0x303a6d=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x14d)]],_0x4299f2=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xcb)]],_0xda932d=[_0x37840a[_0x4884f9(0xbf)]['prod_cat']],_0x3c19a5=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xad)]],_0x557f46=[_0x37840a['body'][_0x4884f9(0xd0)]],_0x565916=[_0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x10e)]],_0x1c87e5=[_0x37840a['body'][_0x4884f9(0xb6)]];else var _0xe537e4=[..._0x37840a['body'][_0x4884f9(0xa6)]],_0x2fe653=[..._0x37840a['body'][_0x4884f9(0xf0)]],_0x541402=[..._0x37840a[_0x4884f9(0xbf)]['from_prod_level2']],_0x814766=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xb3)]],_0x17d1cb=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x10d)]],_0x42265e=[..._0x37840a['body']['primary_code']],_0x909650=[..._0x37840a['body'][_0x4884f9(0xa0)]],_0x24f04f=[..._0x37840a[_0x4884f9(0xbf)]['product_code3']],_0x555e6a=[..._0x37840a[_0x4884f9(0xbf)]['MaxStocks_data2']],_0x447a27=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xb7)]],_0x59910a=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x117)]],_0x53e998=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x121)]],_0x2996b0=[..._0x37840a['body']['expiry_date']],_0x3c9dba=[..._0x37840a['body'][_0x4884f9(0x9c)]],_0x303a6d=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x14d)]],_0x4299f2=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xcb)]],_0xda932d=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x116)]],_0x3c19a5=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xad)]],_0x557f46=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xd0)]],_0x565916=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0x10e)]],_0x1c87e5=[..._0x37840a[_0x4884f9(0xbf)][_0x4884f9(0xb6)]];const _0xcece5e=_0xe537e4[_0x4884f9(0x102)](_0x31ea81=>{return _0x31ea81={'product_name':_0x31ea81};});_0x2fe653[_0x4884f9(0xd5)]((_0x8de58c,_0x5f2dde)=>{_0xcece5e[_0x5f2dde]['from_quantity']=_0x8de58c;}),_0x541402[_0x4884f9(0xd5)]((_0xd2c6ee,_0x508f99)=>{var _0x53576e=_0x4884f9,_0x489ad1=_0xd2c6ee[_0x53576e(0xca)](/[A-Za-z]+/)[0x0],_0x24459b=parseInt(_0xd2c6ee['match'](/\d+/)[0x0]);_0xcece5e[_0x508f99][_0x53576e(0xf3)]=_0x24459b,_0xcece5e[_0x508f99][_0x53576e(0x14f)]=_0x489ad1;}),_0x1c87e5[_0x4884f9(0xd5)]((_0xc5bbe1,_0x1bd9a5)=>{var _0x375710=_0x4884f9;_0xcece5e[_0x1bd9a5][_0x375710(0xb6)]=_0xc5bbe1;}),_0x565916[_0x4884f9(0xd5)]((_0x2f9274,_0x5ce774)=>{_0xcece5e[_0x5ce774]['from_invoice']=_0x2f9274;}),_0x814766['forEach']((_0x503a3f,_0x34f586)=>{var _0x37286e=_0x4884f9;_0xcece5e[_0x34f586][_0x37286e(0xa9)]=_0x503a3f;}),_0x17d1cb[_0x4884f9(0xd5)]((_0x2dbbb8,_0x6ad530)=>{var _0x3823bd=_0x4884f9,_0x552fb5=_0x2dbbb8[_0x3823bd(0xca)](/[A-Za-z]+/)[0x0],_0x5ee2a1=parseInt(_0x2dbbb8['match'](/\d+/)[0x0]);_0xcece5e[_0x6ad530][_0x3823bd(0x112)]=_0x552fb5,_0xcece5e[_0x6ad530][_0x3823bd(0xc2)]=_0x5ee2a1;}),_0x42265e[_0x4884f9(0xd5)]((_0x6c01b3,_0x3afe53)=>{var _0x4b3b9b=_0x4884f9;_0xcece5e[_0x3afe53][_0x4b3b9b(0xe2)]=_0x6c01b3;}),_0x909650[_0x4884f9(0xd5)]((_0x53817f,_0xd44083)=>{var _0x561f50=_0x4884f9;_0xcece5e[_0xd44083][_0x561f50(0xa0)]=_0x53817f;}),_0x24f04f[_0x4884f9(0xd5)]((_0x119191,_0x59bb10)=>{var _0x423105=_0x4884f9;_0xcece5e[_0x59bb10][_0x423105(0x12a)]=_0x119191;}),_0x555e6a['forEach']((_0x29fdff,_0x71887d)=>{var _0x245fcd=_0x4884f9;_0xcece5e[_0x71887d][_0x245fcd(0xdb)]=_0x29fdff;}),_0x447a27[_0x4884f9(0xd5)]((_0xa7586b,_0x165270)=>{var _0x4eea59=_0x4884f9;_0xcece5e[_0x165270][_0x4eea59(0xed)]=_0xa7586b;}),_0x59910a['forEach']((_0x453793,_0x2715b2)=>{var _0x1664bd=_0x4884f9;_0xcece5e[_0x2715b2][_0x1664bd(0x117)]=_0x453793;}),_0x53e998[_0x4884f9(0xd5)]((_0x7dfbf2,_0x1388b9)=>{_0xcece5e[_0x1388b9]['batch_code']=_0x7dfbf2;}),_0x2996b0['forEach']((_0x2d8827,_0x5ac2e1)=>{_0xcece5e[_0x5ac2e1]['expiry_date']=_0x2d8827;}),_0x3c9dba[_0x4884f9(0xd5)]((_0x4d062f,_0x17389f)=>{var _0x20fcb9=_0x4884f9;_0xcece5e[_0x17389f][_0x20fcb9(0x14c)]=_0x4d062f;}),_0x303a6d[_0x4884f9(0xd5)]((_0x5b31dc,_0x339c9d)=>{_0xcece5e[_0x339c9d]['maxProducts']=_0x5b31dc;}),_0x4299f2[_0x4884f9(0xd5)]((_0x4f2aa0,_0x5e6ac5)=>{_0xcece5e[_0x5e6ac5]['maxPerUnit']=_0x4f2aa0;}),_0xda932d[_0x4884f9(0xd5)]((_0x589141,_0x1c0218)=>{var _0x3819d2=_0x4884f9;_0xcece5e[_0x1c0218][_0x3819d2(0x116)]=_0x589141;}),_0x3c19a5[_0x4884f9(0xd5)]((_0x284c2a,_0x25581b)=>{_0xcece5e[_0x25581b]['from_room_name']=_0x284c2a;}),_0x557f46[_0x4884f9(0xd5)]((_0x3f857f,_0x1da9a8)=>{var _0x3ad990=_0x4884f9;_0xcece5e[_0x1da9a8][_0x3ad990(0xf9)]=_0x3f857f;});const _0x12c11e=_0xcece5e['filter'](_0x2a8c69=>_0x2a8c69[_0x4884f9(0xa9)]!=='0'&&_0x2a8c69['to_quantity']!==''||_0x2a8c69['to_floorlevel']!=='0'&&_0x2a8c69[_0x4884f9(0xf7)]!=='');var _0x155737=0x0;_0x12c11e[_0x4884f9(0xd5)](_0x150f1b=>{var _0x2b1b3e=_0x4884f9;parseInt(_0x150f1b[_0x2b1b3e(0xc3)])<parseInt(_0x150f1b['to_quantity'])&&_0x155737++;});if(_0x155737!=0x0)return _0x37840a['flash'](_0x4884f9(0x98),_0x4884f9(0x108)),_0x492b96[_0x4884f9(0x10b)](_0x4884f9(0xc6));const _0x185f2c=new invoice_for_transfer();await _0x185f2c[_0x4884f9(0xe5)]();for(let _0x286373=0x0;_0x286373<=_0x557f46[_0x4884f9(0x131)]-0x1;_0x286373++){_0xcece5e[_0x286373]['To_invoice']='TRF-'+_0x185f2c[_0x4884f9(0x137)][_0x4884f9(0x136)]()['padStart'](0x8,'0');}const _0x437a81=new transfers_finished({'date':_0x47f331,'from_warehouse':_0x54daf4,'to_warehouse':_0x3b7de1,'product':_0x12c11e,'note':_0x3a42c4,'invoice':_0x4884f9(0x13d)+_0x185f2c['invoice_init'][_0x4884f9(0x136)]()[_0x4884f9(0x97)](0x8,'0'),'type_of_transaction':'own','type_of_process':_0x4884f9(0xb8),'PO_number':_0x374bde,'RequestedBy':_0x3126a7,'DateofRequest':_0x4a1a3b,'typeservices':_0xf38266,'destination':_0x5496ad,'deliverydate':_0x3b74c3,'driver':_0x25bf08,'plate':_0x1cef45,'van':_0x11a62c,'DRSI':_0x9281f2,'typevehicle':_0x47c22d,'TSU':_0x5a2df7,'TFU':_0x5be42b}),_0x27fe50=await _0x437a81[_0x4884f9(0xe5)]();_0x37840a[_0x4884f9(0x151)]('success',_0x4884f9(0x149)),_0x492b96['redirect'](_0x4884f9(0xf8)+_0x27fe50[_0x4884f9(0xcd)]);}catch(_0x21fb3a){console[_0x4884f9(0x105)](_0x21fb3a),_0x492b96[_0x4884f9(0xe7)](0xc8)[_0x4884f9(0x128)]({'errorMessage':_0x21fb3a[_0x4884f9(0x119)]});}}),router[a0_0x41b66d(0xc7)](a0_0x41b66d(0xfb),auth,async(_0x14f6de,_0x20191c)=>{var _0x79f3c2=a0_0x41b66d;try{const {username:_0x4b62b5,email:_0x186f4b,role:_0x23985b}=_0x14f6de[_0x79f3c2(0x100)],_0x87f216=_0x14f6de[_0x79f3c2(0x100)],_0x4c6651=await profile[_0x79f3c2(0x118)]({'email':_0x87f216[_0x79f3c2(0x10f)]}),_0x51e15b=await master_shop['find'](),_0x5f3c34=await transfers_finished['findById'](_0x14f6de[_0x79f3c2(0xb9)]['id']);let _0x3fafc4;if(_0x87f216[_0x79f3c2(0x135)]=='staff'){const _0x63125c=await staff[_0x79f3c2(0x118)]({'email':_0x87f216[_0x79f3c2(0x10f)]});_0x3fafc4=await warehouse[_0x79f3c2(0x14b)]({'status':_0x79f3c2(0x12c),'name':_0x63125c['warehouse'],'warehouse_category':_0x79f3c2(0x129)});}else _0x3fafc4=await warehouse[_0x79f3c2(0x14b)]({'status':_0x79f3c2(0x12c),'warehouse_category':_0x79f3c2(0x129)});const _0x28dbee=await warehouse[_0x79f3c2(0x94)]([{'$match':{'name':_0x5f3c34[_0x79f3c2(0xaa)],'warehouse_category':_0x79f3c2(0x129)}},{'$unwind':_0x79f3c2(0x13a)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x79f3c2(0xf2)},'product_stock':{'$first':_0x79f3c2(0x15a)},'bay':{'$first':_0x79f3c2(0x14e)},'bin':{'$first':_0x79f3c2(0x13f)},'type':{'$first':_0x79f3c2(0x11f)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x79f3c2(0xdd)},'secondary_code':{'$first':_0x79f3c2(0xc5)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x79f3c2(0x122)},'rack':{'$first':_0x79f3c2(0xa3)},'expiry_date':{'$first':_0x79f3c2(0xb0)},'production_date':{'$first':_0x79f3c2(0x9d)},'room':{'$first':_0x79f3c2(0x12e)},'warehoue_name':{'$first':_0x79f3c2(0x115)}}}]),_0x11406d=await product['find']({});if(_0x51e15b[0x0]['language']=='English\x20(US)'){var _0x41c73b=users['English'];console['log'](_0x41c73b);}else{if(_0x51e15b[0x0][_0x79f3c2(0x13e)]==_0x79f3c2(0xc1))var _0x41c73b=users[_0x79f3c2(0xc1)];else{if(_0x51e15b[0x0]['language']==_0x79f3c2(0x12f))var _0x41c73b=users[_0x79f3c2(0x12f)];else{if(_0x51e15b[0x0][_0x79f3c2(0x13e)]==_0x79f3c2(0xeb))var _0x41c73b=users[_0x79f3c2(0xeb)];else{if(_0x51e15b[0x0]['language']=='French')var _0x41c73b=users['French'];else{if(_0x51e15b[0x0][_0x79f3c2(0x13e)]==_0x79f3c2(0xe8))var _0x41c73b=users[_0x79f3c2(0xbe)];else{if(_0x51e15b[0x0][_0x79f3c2(0x13e)]==_0x79f3c2(0xcc))var _0x41c73b=users[_0x79f3c2(0xcc)];else{if(_0x51e15b[0x0]['language']==_0x79f3c2(0x157))var _0x41c73b=users[_0x79f3c2(0xd3)];}}}}}}}_0x20191c[_0x79f3c2(0x9b)]('edit_transfer_finished_view',{'success':_0x14f6de['flash'](_0x79f3c2(0xab)),'errors':_0x14f6de[_0x79f3c2(0x151)](_0x79f3c2(0x98)),'role':_0x87f216,'profile':_0x4c6651,'master_shop':_0x51e15b,'warehouse':_0x3fafc4,'transfer':_0x5f3c34,'stock':_0x28dbee,'unit':_0x11406d,'language':_0x41c73b});}catch(_0x47d9d1){console[_0x79f3c2(0x105)](_0x47d9d1);}}),router['post']('/preview/:id',auth,async(_0x56f766,_0x1c80e9)=>{var _0x5bd3e4=a0_0x41b66d;try{const {invoice:_0x481ca0,from_warehouse:_0x40893a,FromRoom_name:_0x1f08de,to_warehouse:_0x223110,ToRoom_name:_0x53ce01}=_0x56f766[_0x5bd3e4(0xbf)],_0x588829=await transfers_finished[_0x5bd3e4(0xc8)](_0x56f766[_0x5bd3e4(0xb9)]['id']),_0x4abcd5=_0x588829['product'][_0x5bd3e4(0x102)](async _0x26ab12=>{var _0x564f27=_0x5bd3e4;if(_0x26ab12[_0x564f27(0xa9)]>0x0){var _0x27f97f=await warehouse[_0x564f27(0x118)]({'name':_0x40893a,'room':_0x26ab12[_0x564f27(0xec)]});const _0x214efd=_0x27f97f[_0x564f27(0x96)][_0x564f27(0x102)](_0x22de10=>{var _0x2b18bb=_0x564f27;_0x22de10['_id']==_0x26ab12[_0x2b18bb(0xb6)]&&(_0x22de10[_0x2b18bb(0xfa)]=Math[_0x2b18bb(0x144)](0x0,Math[_0x2b18bb(0x9e)](_0x22de10[_0x2b18bb(0xfa)])-Math[_0x2b18bb(0x9e)](_0x26ab12[_0x2b18bb(0xa9)])),console[_0x2b18bb(0x105)](_0x22de10['product_stock']));});}return _0x27f97f;});Promise[_0x5bd3e4(0x120)](_0x4abcd5)['then'](async _0x56d7bb=>{var _0x36b506=_0x5bd3e4;try{for(const _0x3711f6 of _0x56d7bb){await _0x3711f6[_0x36b506(0xe5)]();}const _0x3aa78a=_0x588829[_0x36b506(0x11b)][_0x36b506(0x102)](async _0xcf27a2=>{var _0x441006=_0x36b506,_0x49425a=await warehouse[_0x441006(0x118)]({'name':_0x223110,'room':_0xcf27a2['to_room_name']});if(_0xcf27a2[_0x441006(0xa9)]>0x0){var _0x291c65=0x0;const _0x4532ed=_0x49425a[_0x441006(0x96)]['map'](_0x3322d1=>{var _0x561f7d=_0x441006;_0x3322d1[_0x561f7d(0x152)]==_0xcf27a2['product_name']&&_0x3322d1['bay']==_0xcf27a2[_0x561f7d(0xc2)]&&_0x3322d1[_0x561f7d(0x154)]==_0xcf27a2[_0x561f7d(0x154)]&&_0x3322d1[_0x561f7d(0x14c)]==_0xcf27a2[_0x561f7d(0x14c)]&&_0x3322d1[_0x561f7d(0x121)]==_0xcf27a2[_0x561f7d(0x121)]&&_0x3322d1[_0x561f7d(0xfe)]==_0xcf27a2['To_invoice']&&(typeof _0xcf27a2['id_transaction']==_0x561f7d(0xd9)?(console[_0x561f7d(0x105)](_0x561f7d(0x11c),_0x3322d1['product_stock']+_0x561f7d(0x150)+_0x3322d1[_0x561f7d(0xcd)]+'\x20<=>\x20'+Math[_0x561f7d(0x9e)](_0x3322d1[_0x561f7d(0xfa)])+Math[_0x561f7d(0x9e)](_0xcf27a2[_0x561f7d(0xa9)])),_0x3322d1['product_stock']=Math['abs'](_0x3322d1[_0x561f7d(0xfa)])+Math['abs'](_0xcf27a2[_0x561f7d(0xa9)])):_0x3322d1['product_stock']=Math[_0x561f7d(0x9e)](_0x3322d1[_0x561f7d(0xfa)])+Math[_0x561f7d(0x9e)](_0xcf27a2['to_quantity']),_0x291c65++);});_0x291c65=='0'&&(_0x49425a[_0x441006(0x96)]=_0x49425a[_0x441006(0x96)][_0x441006(0xdc)]({'product_name':_0xcf27a2[_0x441006(0x152)],'product_stock':_0xcf27a2[_0x441006(0xa9)],'bay':_0xcf27a2[_0x441006(0xc2)],'level':_0xcf27a2[_0x441006(0x112)],'product_code':_0xcf27a2[_0x441006(0x12a)],'primary_code':_0xcf27a2[_0x441006(0xe2)],'secondary_code':_0xcf27a2[_0x441006(0xa0)],'expiry_date':_0xcf27a2[_0x441006(0x154)],'production_date':_0xcf27a2[_0x441006(0x14c)],'maxProducts':_0xcf27a2['maxProducts'],'batch_code':_0xcf27a2[_0x441006(0x121)],'secondary_unit':_0xcf27a2['secondary_unit'],'unit':_0xcf27a2['unit'],'maxProducts':_0xcf27a2[_0x441006(0xdb)],'maxPerUnit':_0xcf27a2[_0x441006(0xcb)],'invoice':_0xcf27a2[_0x441006(0xae)]}));}return _0x49425a;});Promise[_0x36b506(0x120)](_0x3aa78a)[_0x36b506(0x143)](async _0x5b3e99=>{var _0x10b6a2=_0x36b506;try{console[_0x10b6a2(0x105)](_0x588829[_0x10b6a2(0x13c)]);if(_0x588829[_0x10b6a2(0x13c)]!=_0x10b6a2(0xb8))for(const _0x3c0692 of _0x5b3e99){await warehouse['updateOne']({'_id':_0x3c0692['_id']},{'$addToSet':{'product_details':{'$each':_0x3c0692[_0x10b6a2(0x96)]}}});}_0x588829[_0x10b6a2(0xa7)]='True';const _0x178051=await _0x588829[_0x10b6a2(0xe5)](),_0x46a93d=await master_shop['find'](),_0x3335ae=await email_settings[_0x10b6a2(0x118)](),_0x5a08c4=await supervisor_settings[_0x10b6a2(0x14b)]();var _0x3b17fc=_0x588829['product'],_0x574f8d='',_0x4e61bb;for(_0x4e61bb in _0x3b17fc){var _0x426365='FG';_0x588829[_0x10b6a2(0x141)]==_0x10b6a2(0x104)&&(_0x426365='DG'),_0x574f8d+=_0x10b6a2(0xda)+_0x10b6a2(0x146)+_0x3b17fc[_0x4e61bb]['product_name']+_0x10b6a2(0x92)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3b17fc[_0x4e61bb]['product_code']+_0x10b6a2(0x92)+_0x10b6a2(0x146)+_0x3b17fc[_0x4e61bb][_0x10b6a2(0xa9)]+_0x10b6a2(0x92)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3b17fc[_0x4e61bb]['unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3b17fc[_0x4e61bb][_0x10b6a2(0x117)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x588829[_0x10b6a2(0x141)]+_0x10b6a2(0x92)+_0x10b6a2(0x146)+_0x3b17fc[_0x4e61bb][_0x10b6a2(0xf9)]+_0x10b6a2(0x92)+_0x10b6a2(0x146)+_0x426365+_0x3b17fc[_0x4e61bb][_0x10b6a2(0xc2)]+_0x10b6a2(0x92)+_0x10b6a2(0x138);}_0x56f766[_0x10b6a2(0x151)]('success',_0x10b6a2(0x159)),_0x1c80e9[_0x10b6a2(0x10b)](_0x10b6a2(0xfd)+_0x178051[_0x10b6a2(0xcd)]);}catch(_0x575968){console[_0x10b6a2(0xd8)](_0x575968),_0x1c80e9[_0x10b6a2(0xe7)](0x1f4)[_0x10b6a2(0x128)]({'error':_0x10b6a2(0xe0)});}})[_0x36b506(0xde)](_0x505dc0=>{var _0x2c3d39=_0x36b506;console[_0x2c3d39(0xd8)](_0x505dc0),_0x1c80e9[_0x2c3d39(0xe7)](0x1f4)['json']({'error':_0x2c3d39(0x123)});});}catch(_0x437d9c){console['error'](_0x437d9c),_0x1c80e9[_0x36b506(0xe7)](0x1f4)[_0x36b506(0x128)]({'error':_0x36b506(0x93)});}})[_0x5bd3e4(0xde)](_0x201fda=>{var _0x5a373c=_0x5bd3e4;console[_0x5a373c(0xd8)](_0x201fda),_0x1c80e9['status'](0x1f4)[_0x5a373c(0x128)]({'error':'An\x20error\x20occurred.'});});}catch(_0x2bd1a3){_0x1c80e9[_0x5bd3e4(0x128)]({'message':_0x2bd1a3[_0x5bd3e4(0x119)]});}});function BayBinSelected(_0x204c73,_0x26d969){var _0x41b399=a0_0x41b66d,_0x26bd5c=[];let _0xdb294a=[];var _0x32702d=[];if(_0x204c73=='DRY\x20GOODS'){switch(_0x26d969){case _0x41b399(0xff):_0x26bd5c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x26bd5c=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x32702d=['DG'];}else{if(_0x204c73==_0x41b399(0xa5)){switch(_0x26d969){case'Rack\x201':_0x26bd5c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x41b399(0xd7):_0x26bd5c=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x32702d=['FG'];}}return{'levels':_0x26bd5c,'identify':_0x32702d};}function a0_0x3f57(){var _0x35b965=['$product_details.bay','from_level','\x20<>\x20','flash','product_name','$product_details.unit','expiry_date','nodemailer','/view/:id','Arabic\x20(ae)','../middleware/auth','Transfer\x20Finalize\x20Successfully','$product_details.product_stock','product_code3','$product_details.batch_code','getFullYear','split','/view/add_transfer','</td>','An\x20error\x20occurred\x20while\x20saving\x20data.','aggregate','note','product_details','padStart','errors','1888192EzBgla','from_prod_level2','render','product_date','$product_details.production_date','abs','6QcLDgP','secondary_code','1343300jHQHTr','bay','$product_details.rack','to_room','FROZEN\x20GOODS','prod_name','finalize','Transfer\x20Edit\x20Successfully','to_quantity','from_warehouse','success','bin2bin','RoomAssigned','To_invoice','exports','$product_details.expiry_date','own','$product_details._id','New_Qty_Converted','express','$_id','id_transaction','primary_unit','location2location','params','951867RRnaVz','transfer_finished','/view/choose_logs','post','Portuguese','body','$product_details.level','Hindi','to_bay','from_quantity','3646788tygJHd','$product_details.secondary_code','back','get','findById','English','match','maxPerUnit','Chinese','_id','Router','TRFF-','ToRoomAssigned','warehouse','LOG-TRF-','Arabic','/view/choose','forEach','$date','Rack\x202','error','undefined','<tr>','maxProducts','concat','$product_details.primary_code','catch','edit_transfer_finished','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','choos_transfer','primary_code','597220SYdIgf','floor','save','date','status','Portuguese\x20(BR)','$from_warehouse','filter','Spanish','from_room_name','unit','$finalize','$product.from_room_name','from_prod_qty','$product.to_room_name','$product_details.product_name','from_bay','logs','push','random','to_floorlevel','/transfer_finished/preview/','to_room_name','product_stock','/preview/:id','transfer_finished_logs','/picking_list/PDF_transfer/','invoice','Rack\x201','user','/view/add_transfer_logs','map','staff','DRY\x20GOODS','log','$product_details.secondary_unit','$invoice','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/view/add_transfer_loc','add_transfer_finished','redirect','English\x20(US)','to_prod_level','from_invoice','email','$to_warehouse','/transfer/view','to_level','French','$product_details.product_code','$name','prod_cat','secondary_unit','findOne','message','Ambient','product','here2','from_prod_level','/view_logs','$product_details.type','all','batch_code','$product_details.storage','An\x20error\x20occurred.','/CheckingWarehouse','from_room','$product_details.floorlevel','transfer_data','json','Finished\x20Goods','product_code','Enclosed','Enabled','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$room','German','$product_details.maxPerUnit','length','$product_details.maxProducts','/barcode_scanner','../models/all_models','role','toString','invoice_init','</tr>','$product_details.invoice','$product_details','522523ttUVEo','type_of_process','TRF-','language','$product_details.bin','MaxStocks_data2','to_warehouse','../public/language/languages.json','then','max','/view','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','string','to_prod_qty','Product\x20Transfer\x20successfully','438675TUQWMf','find','production_date','MaxStocks_data'];a0_0x3f57=function(){return _0x35b965;};return a0_0x3f57();}router[a0_0x41b66d(0xc7)](a0_0x41b66d(0x156),auth,async(_0x236513,_0x528916)=>{var _0x358c07=a0_0x41b66d;try{const {username:_0x3974f3,email:_0x42fbc1,role:_0x3fba75}=_0x236513[_0x358c07(0x100)],_0x5e22cd=_0x236513[_0x358c07(0x100)],_0x350562=await profile['findOne']({'email':_0x5e22cd[_0x358c07(0x10f)]}),_0x2ab427=await master_shop[_0x358c07(0x14b)](),_0x35abf5=await transfers_finished[_0x358c07(0xc8)](_0x236513[_0x358c07(0xb9)]['id']);let _0x3ded2b=new Date(_0x35abf5['expiry_date']),_0x393f5d=('0'+_0x3ded2b['getDate']())['slice'](-0x2),_0x33e756=('0'+(_0x3ded2b['getMonth']()+0x1))['slice'](-0x2),_0x42c712=_0x3ded2b[_0x358c07(0x8f)](),_0xb9f6e4=_0x42c712+'-'+_0x33e756+'-'+_0x393f5d,_0x21e161;if(_0x5e22cd['role']==_0x358c07(0x103)){const _0x412de3=await staff[_0x358c07(0x118)]({'email':_0x5e22cd[_0x358c07(0x10f)]});_0x21e161=await warehouse[_0x358c07(0x14b)]({'status':_0x358c07(0x12c),'name':_0x412de3['warehouse'],'warehouse_category':_0x358c07(0x129)});}else _0x21e161=await warehouse[_0x358c07(0x14b)]({'status':_0x358c07(0x12c),'warehouse_category':_0x358c07(0x129)});const _0x3d018e=await warehouse['aggregate']([{'$match':{'name':_0x35abf5[_0x358c07(0xaa)],'room':_0x35abf5[_0x358c07(0x125)]}},{'$unwind':_0x358c07(0x13a)},{'$group':{'_id':_0x358c07(0xb2),'name':{'$first':_0x358c07(0xf2)},'product_stock':{'$first':_0x358c07(0x15a)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x358c07(0x13f)},'type':{'$first':_0x358c07(0x11f)},'floorlevel':{'$first':_0x358c07(0x126)},'primary_code':{'$first':_0x358c07(0xdd)},'secondary_code':{'$first':_0x358c07(0xc5)},'product_code':{'$first':_0x358c07(0x114)},'storage':{'$first':_0x358c07(0x122)},'rack':{'$first':_0x358c07(0xa3)}}}]);var _0x46fd6a=[0x1,0x2,0x3,0x4],_0x686ae2=['A','B','C','D','E','F','G','H','I','J'],_0x11d882=[_0x358c07(0x11a),_0x358c07(0x12b)];const _0xcb05ab=await product['find']({}),_0x45185c=BayBinSelected(_0x35abf5[_0x358c07(0x141)],_0x35abf5[_0x358c07(0xa4)]);if(_0x2ab427[0x0]['language']==_0x358c07(0x10c)){var _0x3b56ec=users[_0x358c07(0xc9)];console[_0x358c07(0x105)](_0x3b56ec);}else{if(_0x2ab427[0x0][_0x358c07(0x13e)]=='Hindi')var _0x3b56ec=users['Hindi'];else{if(_0x2ab427[0x0]['language']==_0x358c07(0x12f))var _0x3b56ec=users[_0x358c07(0x12f)];else{if(_0x2ab427[0x0][_0x358c07(0x13e)]==_0x358c07(0xeb))var _0x3b56ec=users[_0x358c07(0xeb)];else{if(_0x2ab427[0x0][_0x358c07(0x13e)]=='French')var _0x3b56ec=users[_0x358c07(0x113)];else{if(_0x2ab427[0x0]['language']==_0x358c07(0xe8))var _0x3b56ec=users[_0x358c07(0xbe)];else{if(_0x2ab427[0x0]['language']=='Chinese')var _0x3b56ec=users['Chinese'];else{if(_0x2ab427[0x0]['language']==_0x358c07(0x157))var _0x3b56ec=users[_0x358c07(0xd3)];}}}}}}}_0x528916['render'](_0x358c07(0xdf),{'success':_0x236513[_0x358c07(0x151)](_0x358c07(0xab)),'errors':_0x236513[_0x358c07(0x151)](_0x358c07(0x98)),'role':_0x5e22cd,'profile':_0x350562,'master_shop':_0x2ab427,'warehouse':_0x21e161,'transfer':_0x35abf5,'stock':_0x3d018e,'unit':_0xcb05ab,'language':_0x3b56ec,'levels':_0x46fd6a,'Isle':_0x686ae2,'rooms_data':_0x11d882,'ed_fullDate':_0xb9f6e4,'dataSelected':_0x45185c});}catch(_0x341fc2){console['log'](_0x341fc2);}}),router[a0_0x41b66d(0xbd)](a0_0x41b66d(0x156),auth,async(_0x3dfece,_0x228fd7)=>{var _0x3f669c=a0_0x41b66d;try{const _0x4185a6=_0x3dfece[_0x3f669c(0xb9)]['id'];console[_0x3f669c(0x105)](_0x3dfece[_0x3f669c(0xbf)]);const _0x2fc746=await transfers_finished[_0x3f669c(0xc8)](_0x4185a6);console[_0x3f669c(0x105)](_0x3f669c(0x127),_0x2fc746);const {date:_0x361bf3,from_warehouse:_0x317f10,FromRoom_name:_0x517f53,to_warehouse:_0x5566c2,ToRoom_name:_0x25b936,prod_name:_0x247192,from_prod_qty:_0x75bdc9,from_prod_level:_0x25a65a,from_prod_isle:_0x5b3e35,from_prod_pallet:_0x236128,to_prod_qty:_0x19abf9,to_prod_level:_0x90e2cc,to_prod_isle:_0x118e94,to_prod_pallet:_0x4a356c,primary_code:_0x508f08,secondary_code:_0x2adefa,product_code3:_0x148af7,note:_0x3cc33a,invoice:_0x1523b2,expiry_date:_0x251a67}=_0x3dfece['body'];if(typeof _0x247192==_0x3f669c(0x147))var _0x217a3a=[_0x3dfece['body'][_0x3f669c(0xa6)]],_0x561656=[_0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0xf0)]],_0x48bc1d=[_0x3dfece['body'][_0x3f669c(0x11d)]],_0x3a48c4=[_0x3dfece[_0x3f669c(0xbf)]['to_prod_qty']],_0x26d08d=[_0x3dfece[_0x3f669c(0xbf)]['to_prod_level']],_0x4d4b64=[_0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0xe2)]],_0x30bc43=[_0x3dfece['body'][_0x3f669c(0xa0)]],_0x4ae38b=[_0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0x15b)]],_0x1df875=[_0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0x140)]],_0x2a1aee=[_0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0xed)]],_0x4d451e=[_0x3dfece['body'][_0x3f669c(0x117)]],_0x34295b=[_0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0x121)]],_0x224697=[_0x3dfece['body'][_0x3f669c(0x154)]];else var _0x217a3a=[..._0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0xa6)]],_0x561656=[..._0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0xf0)]],_0x48bc1d=[..._0x3dfece[_0x3f669c(0xbf)]['from_prod_level']],_0x3a48c4=[..._0x3dfece['body'][_0x3f669c(0x148)]],_0x26d08d=[..._0x3dfece[_0x3f669c(0xbf)]['to_prod_level']],_0x4d4b64=[..._0x3dfece['body']['primary_code']],_0x30bc43=[..._0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0xa0)]],_0x4ae38b=[..._0x3dfece['body'][_0x3f669c(0x15b)]],_0x1df875=[..._0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0x140)]],_0x2a1aee=[..._0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0xed)]],_0x4d451e=[..._0x3dfece[_0x3f669c(0xbf)][_0x3f669c(0x117)]],_0x34295b=[..._0x3dfece[_0x3f669c(0xbf)]['batch_code']],_0x224697=[..._0x3dfece['body'][_0x3f669c(0x154)]];const _0x101f2a=_0x217a3a[_0x3f669c(0x102)](_0x5bcb74=>{return _0x5bcb74={'product_name':_0x5bcb74};});_0x561656[_0x3f669c(0xd5)]((_0x52b9d9,_0x2e3c37)=>{var _0x578dc8=_0x3f669c;_0x101f2a[_0x2e3c37][_0x578dc8(0xc3)]=_0x52b9d9;}),_0x48bc1d[_0x3f669c(0xd5)]((_0x2ed7ec,_0x5c2adc)=>{var _0x1e97f7=_0x3f669c;_0x101f2a[_0x5c2adc][_0x1e97f7(0xf3)]=_0x2ed7ec;}),_0x3a48c4[_0x3f669c(0xd5)]((_0x2970c5,_0x44be46)=>{var _0xb25de2=_0x3f669c;_0x101f2a[_0x44be46][_0xb25de2(0xa9)]=_0x2970c5;}),_0x26d08d[_0x3f669c(0xd5)]((_0xa14b5b,_0x3bcc18)=>{var _0x270bc5=_0x3f669c;_0x101f2a[_0x3bcc18][_0x270bc5(0xc2)]=_0xa14b5b;}),_0x4d4b64[_0x3f669c(0xd5)]((_0x27596e,_0x379cc8)=>{var _0x28c4ac=_0x3f669c;_0x101f2a[_0x379cc8][_0x28c4ac(0xe2)]=_0x27596e;}),_0x30bc43['forEach']((_0x147448,_0x503d64)=>{var _0x5f1072=_0x3f669c;_0x101f2a[_0x503d64][_0x5f1072(0xa0)]=_0x147448;}),_0x4ae38b[_0x3f669c(0xd5)]((_0x3db718,_0x2ccbb3)=>{var _0x2149d4=_0x3f669c;_0x101f2a[_0x2ccbb3][_0x2149d4(0x12a)]=_0x3db718;}),_0x1df875['forEach']((_0x283f64,_0x161f80)=>{var _0x3200d6=_0x3f669c;_0x101f2a[_0x161f80][_0x3200d6(0xdb)]=_0x283f64;}),_0x2a1aee['forEach']((_0x373979,_0x188c83)=>{var _0x20d9e9=_0x3f669c;_0x101f2a[_0x188c83][_0x20d9e9(0xed)]=_0x373979;}),_0x4d451e[_0x3f669c(0xd5)]((_0x5905e6,_0x220480)=>{var _0x78324e=_0x3f669c;_0x101f2a[_0x220480][_0x78324e(0x117)]=_0x5905e6;}),_0x34295b['forEach']((_0x4367e9,_0x2eabd1)=>{_0x101f2a[_0x2eabd1]['batch_code']=_0x4367e9;}),_0x224697['forEach']((_0x40f4c4,_0x2dc877)=>{_0x101f2a[_0x2dc877]['expiry_date']=_0x40f4c4;});const _0x1e7fe3=_0x101f2a[_0x3f669c(0xea)](_0x364501=>_0x364501[_0x3f669c(0xa9)]!=='0'&&_0x364501['to_quantity']!==''||_0x364501[_0x3f669c(0xf7)]!=='0'&&_0x364501[_0x3f669c(0xf7)]!=='');var _0x255977=0x0;_0x1e7fe3[_0x3f669c(0xd5)](_0x5039e2=>{var _0x262ed1=_0x3f669c;parseInt(_0x5039e2[_0x262ed1(0xc3)])<parseInt(_0x5039e2[_0x262ed1(0xa9)])&&_0x255977++;});if(_0x255977!=0x0)return _0x3dfece[_0x3f669c(0x151)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x228fd7['redirect']('back');const _0x2553ac=await warehouse[_0x3f669c(0x118)]({'name':_0x2fc746[_0x3f669c(0xaa)],'room':_0x2fc746[_0x3f669c(0x125)]});_0x2fc746[_0x3f669c(0x11b)][_0x3f669c(0xd5)](_0x37f68c=>{var _0x375108=_0x3f669c;if(_0x37f68c[_0x375108(0xa9)]>0x0){const _0x4f872d=_0x2553ac['product_details'][_0x375108(0x102)](_0x55a307=>{var _0x54e3c0=_0x375108;_0x55a307[_0x54e3c0(0x152)]==_0x37f68c[_0x54e3c0(0x152)]&&_0x55a307['bay']==_0x37f68c[_0x54e3c0(0xf3)]&&(_0x55a307['product_stock']=parseInt(_0x55a307['product_stock'])+parseInt(_0x37f68c[_0x54e3c0(0xa9)]));});}}),await _0x2553ac[_0x3f669c(0xe5)]();const _0x169b0b=await warehouse[_0x3f669c(0x118)]({'name':_0x2fc746['to_warehouse'],'room':_0x2fc746['to_room']});_0x2fc746[_0x3f669c(0x11b)]['forEach'](_0x53c2e1=>{var _0x35a6b2=_0x3f669c;if(_0x53c2e1['to_quantity']>0x0){const _0x477041=_0x169b0b[_0x35a6b2(0x96)][_0x35a6b2(0x102)](_0x5f22d3=>{var _0x1e52f2=_0x35a6b2;_0x5f22d3[_0x1e52f2(0x152)]==_0x53c2e1[_0x1e52f2(0x152)]&&_0x5f22d3['bay']==_0x53c2e1['to_bay']&&(_0x5f22d3['product_stock']=parseInt(_0x5f22d3[_0x1e52f2(0xfa)])-parseInt(_0x53c2e1[_0x1e52f2(0xa9)]));});}}),await _0x169b0b[_0x3f669c(0xe5)](),_0x2fc746[_0x3f669c(0xe6)]=_0x361bf3,_0x2fc746['from_warehouse']=_0x317f10,_0x2fc746[_0x3f669c(0x141)]=_0x5566c2,_0x2fc746[_0x3f669c(0x11b)]=_0x1e7fe3,_0x2fc746[_0x3f669c(0x95)]=_0x3cc33a,_0x2fc746[_0x3f669c(0xfe)]=_0x1523b2;const _0x134359=await _0x2fc746[_0x3f669c(0xe5)](),_0x1037e2=await warehouse[_0x3f669c(0x118)]({'name':_0x317f10,'room':_0x517f53});_0x134359[_0x3f669c(0x11b)][_0x3f669c(0xd5)](_0x34a7f4=>{var _0x50e478=_0x3f669c;if(_0x34a7f4['to_quantity']>0x0){const _0x51298c=_0x1037e2[_0x50e478(0x96)][_0x50e478(0x102)](_0x2dab5b=>{var _0xac2504=_0x50e478;_0x2dab5b[_0xac2504(0x152)]==_0x34a7f4[_0xac2504(0x152)]&&_0x2dab5b[_0xac2504(0xa2)]==_0x34a7f4[_0xac2504(0xf3)]&&(_0x2dab5b[_0xac2504(0xfa)]=parseInt(_0x2dab5b[_0xac2504(0xfa)])-parseInt(_0x34a7f4[_0xac2504(0xa9)]));});}}),await _0x1037e2[_0x3f669c(0xe5)]();const _0x5d1cbc=await warehouse[_0x3f669c(0x118)]({'name':_0x5566c2,'room':_0x25b936});_0x134359[_0x3f669c(0x11b)][_0x3f669c(0xd5)](_0x54e259=>{var _0x53aa7f=_0x3f669c;if(_0x54e259[_0x53aa7f(0xa9)]>0x0){var _0x8b8c2d=0x0;const _0xea8df1=_0x5d1cbc[_0x53aa7f(0x96)]['map'](_0x2beedd=>{var _0x3f2a7b=_0x53aa7f;_0x2beedd[_0x3f2a7b(0x152)]==_0x54e259['product_name']&&_0x2beedd[_0x3f2a7b(0xa2)]==_0x54e259[_0x3f2a7b(0xc2)]&&(_0x2beedd[_0x3f2a7b(0xfa)]=parseInt(_0x2beedd[_0x3f2a7b(0xfa)])+parseInt(_0x54e259[_0x3f2a7b(0xa9)]),_0x8b8c2d++);});_0x8b8c2d=='0'&&(_0x5d1cbc[_0x53aa7f(0x96)]=_0x5d1cbc[_0x53aa7f(0x96)]['concat']({'product_name':_0x54e259[_0x53aa7f(0x152)],'product_stock':_0x54e259[_0x53aa7f(0xa9)],'bay':_0x54e259['to_bay'],'product_code':_0x54e259[_0x53aa7f(0x12a)],'primary_code':_0x54e259[_0x53aa7f(0xe2)],'secondary_code':_0x54e259[_0x53aa7f(0xa0)],'maxProducts':_0x54e259[_0x53aa7f(0xdb)]}));}}),await _0x5d1cbc[_0x3f669c(0xe5)](),_0x3dfece[_0x3f669c(0x151)]('success',_0x3f669c(0xa8)),_0x228fd7[_0x3f669c(0x10b)]('/transfer_finished/view');}catch(_0x1934c3){console[_0x3f669c(0x105)](_0x1934c3);}}),router[a0_0x41b66d(0xbd)](a0_0x41b66d(0x133),async(_0x8cb262,_0x319400)=>{var _0x1c7663=a0_0x41b66d;const {FromWareHouse:_0x4e8d1a,FromRoom:_0x532acf,ToWarehouse:_0x1b9325,ToRoom:_0x103291,primary_code:_0x336d06,Roomslist:_0x25b101}=_0x8cb262[_0x1c7663(0xbf)],_0x4052e5=_0x25b101[_0x1c7663(0x90)](','),_0x27d6d7=[];async function _0x1fc8e0(_0x249c4f){var _0x26eff4=_0x1c7663;const _0x515b96=await warehouse[_0x26eff4(0x94)]([{'$match':{'name':_0x4e8d1a,'room':_0x249c4f}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x336d06}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x26eff4(0xf2)},'instock':{'$first':_0x26eff4(0x15a)},'primary_code':{'$first':_0x26eff4(0xdd)},'secondary_code':{'$first':_0x26eff4(0xc5)},'product_code':{'$first':_0x26eff4(0x114)},'bay':{'$first':'$product_details.bay'},'level':{'$first':_0x26eff4(0xc0)},'type':{'$first':_0x26eff4(0x11f)},'pallet':{'$first':_0x26eff4(0x126)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x26eff4(0x106)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x26eff4(0xa3)},'expiry_date':{'$first':_0x26eff4(0xb0)},'production_date':{'$first':_0x26eff4(0x9d)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x26eff4(0x130)},'roomNamed':{'$first':_0x26eff4(0x12e)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x26eff4(0x139)}}}]),_0x553d60=await warehouse[_0x26eff4(0x94)]([{'$match':{'name':_0x4e8d1a,'room':_0x249c4f}},{'$unwind':_0x26eff4(0x13a)},{'$match':{'product_details.secondary_code':_0x336d06}},{'$group':{'_id':_0x26eff4(0xb2),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x26eff4(0x114)},'bay':{'$first':_0x26eff4(0x14e)},'level':{'$first':_0x26eff4(0xc0)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x26eff4(0x153)},'secondary_unit':{'$first':_0x26eff4(0x106)},'storage':{'$first':_0x26eff4(0x122)},'rack':{'$first':_0x26eff4(0xa3)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x26eff4(0x9d)},'batch_code':{'$first':_0x26eff4(0x8e)},'maxPerUnit':{'$first':_0x26eff4(0x130)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x26eff4(0x139)}}}]);if(_0x515b96[_0x26eff4(0x131)]>0x0)_0x27d6d7[_0x26eff4(0xf5)](_0x515b96);else _0x553d60[_0x26eff4(0x131)]>0x0&&_0x27d6d7[_0x26eff4(0xf5)](_0x553d60);}const _0x40d397=_0x4052e5[_0x1c7663(0x102)](_0xaaafe2=>_0x1fc8e0(_0xaaafe2));await Promise[_0x1c7663(0x120)](_0x40d397),_0x319400['json'](_0x27d6d7);}),router['post'](a0_0x41b66d(0x124),async(_0x2554d5,_0x5b4fd7)=>{var _0x47e825=a0_0x41b66d;const {productCode:_0x47a3a3,bay:_0x59d3dd,warehouses:_0x5c2423,room:_0x285213}=_0x2554d5[_0x47e825(0xbf)];console[_0x47e825(0x105)](_0x2554d5[_0x47e825(0xbf)]);try{const _0x5a07cf=await warehouse[_0x47e825(0x94)]([{'$match':{'name':_0x5c2423,'room':_0x285213}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x59d3dd)}},{'$group':{'_id':_0x47e825(0xb2),'name':{'$first':_0x47e825(0xf2)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x47e825(0x14e)},'maxProducts':{'$first':_0x47e825(0x132)}}}]);_0x5b4fd7[_0x47e825(0xe7)](0xc8)['json'](_0x5a07cf);}catch(_0x298067){_0x5b4fd7[_0x47e825(0xe7)](0x194)['json']({'message':_0x298067[_0x47e825(0x119)]});}}),module[a0_0x41b66d(0xaf)]=router;