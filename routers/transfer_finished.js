var a0_0x46b412=a0_0x1347;function a0_0x4dbd(){var _0x4939c9=['params','forEach','$product_details.bay','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','36640FAPgwk','711285sSgWhC','Transfer\x20Finalize\x20Successfully','323364XsSoLq','product_code3','error','</tr>','nodemailer','floor','$product_details.primary_code','/CheckingWarehouse','updateOne','$product.from_room_name','to_bay','map','random','here2','48LbZHci','TRFF-','$product_details.product_code','json','primary_code','\x20<>\x20','../public/language/languages.json','MaxStocks_data2','language','133tksWCv','from_level','string','$from_warehouse','secondary_unit','user','id_transaction','$product_details.secondary_code','$product_details.type','/transfer_finished/preview/','$to_warehouse','There\x27s\x20a\x20error\x20in\x20this\x20transaction','to_prod_qty','expiry_date','Enabled','invoice','batch_code','/view/add_transfer_logs','message','secondary_code','$product_details.level','Product\x20Transfer\x20successfully','2RryahM','from_room_name','to_warehouse','/view/add_transfer_loc','product_stock','flash','transfer_data','_id','Portuguese','to_room','to_level','Rack\x202','transfer_finished','$product_details.expiry_date','product_code','add_transfer_finished','express','findById','Enclosed','German','to_room_name','/view/addlog','then','8ZfIefy','DRY\x20GOODS','from_prod_level','to_prod_level','getFullYear','body','edit_transfer_finished','save','post','toString','$product_details.batch_code','maxPerUnit','Router','edit_transfer_finished_view','$product_details.floorlevel','production_date','to_floorlevel','undefined','$product_details.maxProducts','concat','$product_details.product_stock','$product_details.invoice','slice','True','$product_details.unit','push','English','own','from_room','$date','MaxStocks_data','/view/choose','1020080rWkXkQ','Hindi','Arabic\x20(ae)','<tr>','Chinese','FROZEN\x20GOODS','/preview/:id','product','$product_details','from_prod_level2','choos_transfer','LOG-TRF-','staff','481902crGObk','max','filter','prod_cat','note','Transfer\x20Edit\x20Successfully','$product','ToRoomAssigned','754656NmazZm','Rack\x201','$product_details.rack','abs','redirect','back','success','aggregate','New_Qty_Converted','role','TRF-','from_warehouse','type_of_process','status','invoice_init','all','catch','product_name','../middleware/auth','$product_details.secondary_unit','find','/barcode_scanner','$room','/view/:id','Spanish','$name','prod_name','render','email','Arabic','$_id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','RoomAssigned','to_quantity','split','maxProducts','location2location','$product_details.product_name','getDate','primary_unit','choos_transfer_logs','from_quantity','$finalize','from_prod_qty','get','warehouse','product_date','length','</td>','date','/transfer/view','$product_details._id','logs','errors','findOne','French','\x20<=>\x20','Finished\x20Goods','/picking_list/PDF_transfer/','log','$product_details.bin','$invoice','1836549uAKyPY','/view_logs','bay','/view','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/view/add_transfer','match','product_details','from_bay','To_invoice','$product_details.production_date','unit','from_invoice','transfer_finished_logs','English\x20(US)','63UjpWjT','Portuguese\x20(BR)','$product.to_room_name','padStart'];a0_0x4dbd=function(){return _0x4939c9;};return a0_0x4dbd();}function a0_0x1347(_0x4fbd1c,_0x77987d){var _0x4dbdf8=a0_0x4dbd();return a0_0x1347=function(_0x134759,_0x16824b){_0x134759=_0x134759-0x107;var _0x5ad486=_0x4dbdf8[_0x134759];return _0x5ad486;},a0_0x1347(_0x4fbd1c,_0x77987d);}(function(_0x41231e,_0xc4e013){var _0x31d01e=a0_0x1347,_0x1ca125=_0x41231e();while(!![]){try{var _0x32546a=parseInt(_0x31d01e(0x19d))/0x1*(parseInt(_0x31d01e(0x110))/0x2)+parseInt(_0x31d01e(0x170))/0x3+parseInt(_0x31d01e(0x1b4))/0x4*(-parseInt(_0x31d01e(0x16e))/0x5)+parseInt(_0x31d01e(0x118))/0x6+parseInt(_0x31d01e(0x187))/0x7*(-parseInt(_0x31d01e(0x16d))/0x8)+-parseInt(_0x31d01e(0x165))/0x9*(-parseInt(_0x31d01e(0x1d4))/0xa)+-parseInt(_0x31d01e(0x156))/0xb*(parseInt(_0x31d01e(0x17e))/0xc);if(_0x32546a===_0xc4e013)break;else _0x1ca125['push'](_0x1ca125['shift']());}catch(_0xb9bff9){_0x1ca125['push'](_0x1ca125['shift']());}}}(a0_0x4dbd,0x5f408));const express=require(a0_0x46b412(0x1ad)),app=express(),router=express[a0_0x46b412(0x1c0)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require('../models/all_models'),auth=require(a0_0x46b412(0x12a)),users=require(a0_0x46b412(0x184)),nodemailer=require(a0_0x46b412(0x174));router[a0_0x46b412(0x144)](a0_0x46b412(0x159),auth,async(_0x597f73,_0x55d3ed)=>{var _0x319574=a0_0x46b412;try{const {username:_0x526c9f,email:_0x3e936d,role:_0x5d9eb6}=_0x597f73[_0x319574(0x18c)],_0x2cb55e=_0x597f73[_0x319574(0x18c)],_0x564861=await profile['findOne']({'email':_0x2cb55e[_0x319574(0x134)]}),_0x417cc0=await master_shop[_0x319574(0x12c)]();let _0x1dd4d9;if(_0x2cb55e['role']=='staff'){const _0x18898d=await staff[_0x319574(0x14e)]({'email':_0x2cb55e[_0x319574(0x134)]});_0x1dd4d9=await transfers_finished[_0x319574(0x12c)]({'from_warehouse':_0x18898d[_0x319574(0x145)]});}else _0x1dd4d9=await transfers_finished[_0x319574(0x11f)]([{'$match':{'type_of_transaction':'own'}},{'$unwind':'$product'},{'$group':{'_id':_0x319574(0x136),'invoice':{'$first':_0x319574(0x155)},'date':{'$first':_0x319574(0x1d1)},'from_warehouse':{'$first':_0x319574(0x18a)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x319574(0x179)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x319574(0x142)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x417cc0[0x0][_0x319574(0x186)]==_0x319574(0x164))var _0x3bf50f=users[_0x319574(0x1ce)];else{if(_0x417cc0[0x0][_0x319574(0x186)]==_0x319574(0x1d5))var _0x3bf50f=users[_0x319574(0x1d5)];else{if(_0x417cc0[0x0][_0x319574(0x186)]==_0x319574(0x1b0))var _0x3bf50f=users[_0x319574(0x1b0)];else{if(_0x417cc0[0x0][_0x319574(0x186)]==_0x319574(0x130))var _0x3bf50f=users[_0x319574(0x130)];else{if(_0x417cc0[0x0]['language']==_0x319574(0x14f))var _0x3bf50f=users[_0x319574(0x14f)];else{if(_0x417cc0[0x0][_0x319574(0x186)]==_0x319574(0x166))var _0x3bf50f=users['Portuguese'];else{if(_0x417cc0[0x0]['language']==_0x319574(0x107))var _0x3bf50f=users[_0x319574(0x107)];else{if(_0x417cc0[0x0][_0x319574(0x186)]=='Arabic\x20(ae)')var _0x3bf50f=users['Arabic'];}}}}}}}_0x55d3ed[_0x319574(0x133)](_0x319574(0x1a9),{'success':_0x597f73[_0x319574(0x1a2)](_0x319574(0x11e)),'errors':_0x597f73['flash'](_0x319574(0x14d)),'role':_0x2cb55e,'profile':_0x564861,'master_shop':_0x417cc0,'transfer':_0x1dd4d9,'language':_0x3bf50f});}catch(_0x51fcbe){console[_0x319574(0x153)](_0x51fcbe);}}),router[a0_0x46b412(0x144)](a0_0x46b412(0x157),auth,async(_0x51cf39,_0x555c20)=>{var _0x2e0ba6=a0_0x46b412;try{const {username:_0x44974d,email:_0x268323,role:_0x216b7b}=_0x51cf39['user'],_0x55c671=_0x51cf39[_0x2e0ba6(0x18c)],_0x3e1a26=await profile['findOne']({'email':_0x55c671['email']}),_0x114a27=await master_shop['find']();let _0x44e0d9;if(_0x55c671[_0x2e0ba6(0x121)]==_0x2e0ba6(0x10f)){const _0x572498=await staff[_0x2e0ba6(0x14e)]({'email':_0x55c671[_0x2e0ba6(0x134)]});_0x44e0d9=await transfers_finished['find']({'from_warehouse':_0x572498[_0x2e0ba6(0x145)]});}else _0x44e0d9=await transfers_finished[_0x2e0ba6(0x11f)]([{'$match':{'type_of_transaction':_0x2e0ba6(0x14c)}},{'$unwind':_0x2e0ba6(0x116)},{'$group':{'_id':_0x2e0ba6(0x136),'invoice':{'$first':'$invoice'},'date':{'$first':_0x2e0ba6(0x1d1)},'from_warehouse':{'$first':_0x2e0ba6(0x18a)},'to_warehouse':{'$first':_0x2e0ba6(0x191)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x2e0ba6(0x167)},'finalize':{'$first':_0x2e0ba6(0x142)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x114a27[0x0][_0x2e0ba6(0x186)]==_0x2e0ba6(0x164))var _0x3f1e47=users[_0x2e0ba6(0x1ce)];else{if(_0x114a27[0x0][_0x2e0ba6(0x186)]==_0x2e0ba6(0x1d5))var _0x3f1e47=users['Hindi'];else{if(_0x114a27[0x0][_0x2e0ba6(0x186)]==_0x2e0ba6(0x1b0))var _0x3f1e47=users[_0x2e0ba6(0x1b0)];else{if(_0x114a27[0x0]['language']==_0x2e0ba6(0x130))var _0x3f1e47=users[_0x2e0ba6(0x130)];else{if(_0x114a27[0x0][_0x2e0ba6(0x186)]==_0x2e0ba6(0x14f))var _0x3f1e47=users[_0x2e0ba6(0x14f)];else{if(_0x114a27[0x0][_0x2e0ba6(0x186)]==_0x2e0ba6(0x166))var _0x3f1e47=users[_0x2e0ba6(0x1a5)];else{if(_0x114a27[0x0]['language']==_0x2e0ba6(0x107))var _0x3f1e47=users['Chinese'];else{if(_0x114a27[0x0][_0x2e0ba6(0x186)]==_0x2e0ba6(0x1d6))var _0x3f1e47=users[_0x2e0ba6(0x135)];}}}}}}}_0x555c20[_0x2e0ba6(0x133)](_0x2e0ba6(0x163),{'success':_0x51cf39[_0x2e0ba6(0x1a2)](_0x2e0ba6(0x11e)),'errors':_0x51cf39[_0x2e0ba6(0x1a2)](_0x2e0ba6(0x14d)),'role':_0x55c671,'profile':_0x3e1a26,'master_shop':_0x114a27,'transfer':_0x44e0d9,'language':_0x3f1e47});}catch(_0xf3b4f1){console[_0x2e0ba6(0x153)](_0xf3b4f1);}});async function getRandom8DigitNumber(){var _0x533b4c=a0_0x46b412;const _0x119436=0x989680,_0x4e0aed=0x5f5e0ff,_0x36ccab=Math[_0x533b4c(0x175)](Math[_0x533b4c(0x17c)]()*(_0x4e0aed-_0x119436+0x1))+_0x119436;var _0x8a8955;const _0x21bd89=await transfers_finished['findOne']({'invoice':'TRFF-'+_0x36ccab});return _0x21bd89&&_0x21bd89[_0x533b4c(0x147)]>0x0?_0x8a8955=_0x533b4c(0x17f)+_0x36ccab:_0x8a8955='TRFF-'+_0x36ccab,_0x8a8955;}router[a0_0x46b412(0x144)](a0_0x46b412(0x15b),auth,async(_0x5c9e1f,_0x422670)=>{var _0x47fa2b=a0_0x46b412;try{const {username:_0x4f4ba8,email:_0x3ef0cb,role:_0x439f0b}=_0x5c9e1f[_0x47fa2b(0x18c)],_0x30bcfa=_0x5c9e1f['user'],_0x45f4c8=await profile['findOne']({'email':_0x30bcfa['email']}),_0x5905b1=await master_shop[_0x47fa2b(0x12c)]();let _0x45d112;if(_0x30bcfa[_0x47fa2b(0x121)]==_0x47fa2b(0x10f)){const _0xe6fa2e=await staff[_0x47fa2b(0x14e)]({'email':_0x30bcfa['email']});_0x45d112=await warehouse[_0x47fa2b(0x11f)]([{'$match':{'status':_0x47fa2b(0x195),'name':_0xe6fa2e[_0x47fa2b(0x145)]}},{'$group':{'_id':_0x47fa2b(0x131),'name':{'$first':_0x47fa2b(0x131)}}}]);}else _0x45d112=await warehouse['aggregate']([{'$match':{'status':_0x47fa2b(0x195)}},{'$group':{'_id':_0x47fa2b(0x131),'name':{'$first':_0x47fa2b(0x131)}}}]);const _0x34caaf=await transfers_finished['find']({}),_0x1e78ec=_0x34caaf[_0x47fa2b(0x147)]+0x1,_0x42962f=_0x47fa2b(0x17f)+_0x1e78ec['toString']()[_0x47fa2b(0x168)](0x5,'0');if(_0x5905b1[0x0][_0x47fa2b(0x186)]==_0x47fa2b(0x164))var _0x3c58c5=users[_0x47fa2b(0x1ce)];else{if(_0x5905b1[0x0]['language']==_0x47fa2b(0x1d5))var _0x3c58c5=users[_0x47fa2b(0x1d5)];else{if(_0x5905b1[0x0][_0x47fa2b(0x186)]==_0x47fa2b(0x1b0))var _0x3c58c5=users[_0x47fa2b(0x1b0)];else{if(_0x5905b1[0x0][_0x47fa2b(0x186)]==_0x47fa2b(0x130))var _0x3c58c5=users[_0x47fa2b(0x130)];else{if(_0x5905b1[0x0][_0x47fa2b(0x186)]==_0x47fa2b(0x14f))var _0x3c58c5=users[_0x47fa2b(0x14f)];else{if(_0x5905b1[0x0][_0x47fa2b(0x186)]==_0x47fa2b(0x166))var _0x3c58c5=users['Portuguese'];else{if(_0x5905b1[0x0]['language']=='Chinese')var _0x3c58c5=users['Chinese'];else{if(_0x5905b1[0x0][_0x47fa2b(0x186)]==_0x47fa2b(0x1d6))var _0x3c58c5=users[_0x47fa2b(0x135)];}}}}}}}const _0x1bcfdb=getRandom8DigitNumber();_0x1bcfdb[_0x47fa2b(0x1b3)](_0x37fea4=>{var _0x7e2c8=_0x47fa2b;_0x422670[_0x7e2c8(0x133)](_0x7e2c8(0x1ac),{'success':_0x5c9e1f[_0x7e2c8(0x1a2)](_0x7e2c8(0x11e)),'errors':_0x5c9e1f[_0x7e2c8(0x1a2)](_0x7e2c8(0x14d)),'role':_0x30bcfa,'profile':_0x45f4c8,'master_shop':_0x5905b1,'warehouse':_0x45d112,'language':_0x3c58c5,'invoice':_0x37fea4});})['catch'](_0x400768=>{var _0x3c8e37=_0x47fa2b;_0x5c9e1f[_0x3c8e37(0x1a2)](_0x3c8e37(0x14d),_0x3c8e37(0x192)),_0x422670[_0x3c8e37(0x11c)](_0x3c8e37(0x14a));});}catch(_0x15749c){console[_0x47fa2b(0x153)](_0x15749c);}}),router[a0_0x46b412(0x144)](a0_0x46b412(0x1d3),auth,async(_0x5525ec,_0x4772c6)=>{var _0x1e01e9=a0_0x46b412;try{const {username:_0x2255d7,email:_0x8aa938,role:_0x5c5250}=_0x5525ec[_0x1e01e9(0x18c)],_0xd6569=_0x5525ec['user'],_0x2e7942=await profile[_0x1e01e9(0x14e)]({'email':_0xd6569[_0x1e01e9(0x134)]}),_0x457c3a=await master_shop[_0x1e01e9(0x12c)]();let _0x11d4b1;if(_0xd6569[_0x1e01e9(0x121)]==_0x1e01e9(0x10f)){const _0x2ebd3c=await staff[_0x1e01e9(0x14e)]({'email':_0xd6569['email']});_0x11d4b1=await warehouse[_0x1e01e9(0x11f)]([{'$match':{'status':_0x1e01e9(0x195),'name':_0x2ebd3c[_0x1e01e9(0x145)]}},{'$group':{'_id':_0x1e01e9(0x131),'name':{'$first':_0x1e01e9(0x131)}}}]);}else _0x11d4b1=await warehouse[_0x1e01e9(0x11f)]([{'$match':{'status':_0x1e01e9(0x195)}},{'$group':{'_id':_0x1e01e9(0x131),'name':{'$first':_0x1e01e9(0x131)}}}]);const _0x39a61d=await transfers_finished[_0x1e01e9(0x12c)]({}),_0x4ce222=_0x39a61d[_0x1e01e9(0x147)]+0x1,_0x374a33=_0x1e01e9(0x17f)+_0x4ce222[_0x1e01e9(0x1bd)]()[_0x1e01e9(0x168)](0x5,'0');if(_0x457c3a[0x0]['language']==_0x1e01e9(0x164))var _0x4b3748=users[_0x1e01e9(0x1ce)];else{if(_0x457c3a[0x0][_0x1e01e9(0x186)]==_0x1e01e9(0x1d5))var _0x4b3748=users[_0x1e01e9(0x1d5)];else{if(_0x457c3a[0x0]['language']==_0x1e01e9(0x1b0))var _0x4b3748=users['German'];else{if(_0x457c3a[0x0]['language']=='Spanish')var _0x4b3748=users[_0x1e01e9(0x130)];else{if(_0x457c3a[0x0]['language']=='French')var _0x4b3748=users['French'];else{if(_0x457c3a[0x0][_0x1e01e9(0x186)]==_0x1e01e9(0x166))var _0x4b3748=users[_0x1e01e9(0x1a5)];else{if(_0x457c3a[0x0][_0x1e01e9(0x186)]==_0x1e01e9(0x107))var _0x4b3748=users[_0x1e01e9(0x107)];else{if(_0x457c3a[0x0][_0x1e01e9(0x186)]==_0x1e01e9(0x1d6))var _0x4b3748=users[_0x1e01e9(0x135)];}}}}}}}const _0x3afe2a=getRandom8DigitNumber();_0x3afe2a['then'](_0x5a75bd=>{var _0x290ce8=_0x1e01e9;_0x4772c6['render'](_0x290ce8(0x10d),{'success':_0x5525ec['flash']('success'),'errors':_0x5525ec[_0x290ce8(0x1a2)](_0x290ce8(0x14d)),'role':_0xd6569,'profile':_0x2e7942,'master_shop':_0x457c3a,'warehouse':_0x11d4b1,'language':_0x4b3748,'invoice':_0x5a75bd});})[_0x1e01e9(0x128)](_0x24f2a5=>{var _0x372fe3=_0x1e01e9;_0x5525ec[_0x372fe3(0x1a2)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x4772c6[_0x372fe3(0x11c)](_0x372fe3(0x14a));});}catch(_0x25d668){console[_0x1e01e9(0x153)](_0x25d668);}}),router[a0_0x46b412(0x144)]('/view/choose_logs',auth,async(_0x5d57dd,_0x378e82)=>{var _0x2ebbc0=a0_0x46b412;try{const {username:_0x33fd27,email:_0x336de3,role:_0x502345}=_0x5d57dd['user'],_0xbb375a=_0x5d57dd[_0x2ebbc0(0x18c)],_0x26deb2=await profile[_0x2ebbc0(0x14e)]({'email':_0xbb375a[_0x2ebbc0(0x134)]}),_0x81a4ea=await master_shop[_0x2ebbc0(0x12c)]();let _0x928841;if(_0xbb375a[_0x2ebbc0(0x121)]=='staff'){const _0x3bed97=await staff[_0x2ebbc0(0x14e)]({'email':_0xbb375a['email']});_0x928841=await warehouse[_0x2ebbc0(0x11f)]([{'$match':{'status':_0x2ebbc0(0x195),'name':_0x3bed97[_0x2ebbc0(0x145)]}},{'$group':{'_id':'$name','name':{'$first':_0x2ebbc0(0x131)}}}]);}else _0x928841=await warehouse[_0x2ebbc0(0x11f)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x2ebbc0(0x131),'name':{'$first':_0x2ebbc0(0x131)}}}]);const _0x8c34ab=await transfers_finished[_0x2ebbc0(0x12c)]({}),_0x10366c=_0x8c34ab['length']+0x1,_0x2f70c4=_0x2ebbc0(0x17f)+_0x10366c[_0x2ebbc0(0x1bd)]()[_0x2ebbc0(0x168)](0x5,'0');if(_0x81a4ea[0x0]['language']==_0x2ebbc0(0x164))var _0x2df8df=users['English'];else{if(_0x81a4ea[0x0][_0x2ebbc0(0x186)]==_0x2ebbc0(0x1d5))var _0x2df8df=users[_0x2ebbc0(0x1d5)];else{if(_0x81a4ea[0x0]['language']==_0x2ebbc0(0x1b0))var _0x2df8df=users[_0x2ebbc0(0x1b0)];else{if(_0x81a4ea[0x0][_0x2ebbc0(0x186)]==_0x2ebbc0(0x130))var _0x2df8df=users['Spanish'];else{if(_0x81a4ea[0x0][_0x2ebbc0(0x186)]==_0x2ebbc0(0x14f))var _0x2df8df=users[_0x2ebbc0(0x14f)];else{if(_0x81a4ea[0x0][_0x2ebbc0(0x186)]==_0x2ebbc0(0x166))var _0x2df8df=users[_0x2ebbc0(0x1a5)];else{if(_0x81a4ea[0x0]['language']==_0x2ebbc0(0x107))var _0x2df8df=users[_0x2ebbc0(0x107)];else{if(_0x81a4ea[0x0][_0x2ebbc0(0x186)]==_0x2ebbc0(0x1d6))var _0x2df8df=users[_0x2ebbc0(0x135)];}}}}}}}const _0x47bb97=getRandom8DigitNumber();_0x47bb97[_0x2ebbc0(0x1b3)](_0x39e0b9=>{var _0x146845=_0x2ebbc0;_0x378e82[_0x146845(0x133)](_0x146845(0x140),{'success':_0x5d57dd['flash'](_0x146845(0x11e)),'errors':_0x5d57dd[_0x146845(0x1a2)]('errors'),'role':_0xbb375a,'profile':_0x26deb2,'master_shop':_0x81a4ea,'warehouse':_0x928841,'language':_0x2df8df,'invoice':_0x39e0b9});})[_0x2ebbc0(0x128)](_0x464b5e=>{var _0x52d2dd=_0x2ebbc0;_0x5d57dd[_0x52d2dd(0x1a2)](_0x52d2dd(0x14d),_0x52d2dd(0x192)),_0x378e82[_0x52d2dd(0x11c)](_0x52d2dd(0x14a));});}catch(_0x530143){console[_0x2ebbc0(0x153)](_0x530143);}}),router[a0_0x46b412(0x1bc)](a0_0x46b412(0x198),auth,async(_0x44623a,_0x32cffc)=>{var _0xa8ac63=a0_0x46b412;try{const {date:_0x27b1c2,from_warehouse:_0x25de87,FromRoom_name:_0x1ebbdb,to_warehouse:_0x1cba35,ToRoom_name:_0x191e95,prod_name:_0x4fdd18,from_prod_qty:_0x3399f6,from_prod_level:_0x1c4f4b,from_prod_isle:_0x598250,from_prod_pallet:_0x5ac3c7,to_prod_qty:_0x3388d7,to_prod_level:_0x2d4fce,to_prod_isle:_0x4719f0,to_prod_pallet:_0x52ef9d,primary_code:_0x4b8baf,secondary_code:_0x3288ef,product_code3:_0x2df6f8,note:_0x2a147,MaxStocks_data2:_0x2ea83d,invoice:_0xc58a86,expiry_date:_0x4bde56,PO_number:_0x1db3e8,ReqBy:_0x5187a1,dateofreq:_0xe90cb9,typeservicesData:_0x2c9a8b,destination:_0x11f6d1,deliverydate:_0x36b6ad,driver:_0x39e206,plate:_0xa438f9,van:_0x5bc413,DRSI:_0x47c5cb,typevehicle:_0xf30de6,TSU:_0x4ddfba,TFU:_0x352844}=_0x44623a[_0xa8ac63(0x1b9)];if(typeof _0x4fdd18==_0xa8ac63(0x189))var _0xd7d64c=[_0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x132)]],_0x3a4e73=[_0x44623a[_0xa8ac63(0x1b9)]['from_prod_qty']],_0x513e14=[_0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x10c)]],_0x132e37=[_0x44623a[_0xa8ac63(0x1b9)]['New_Qty_Converted']],_0x32b2e2=[_0x44623a['body'][_0xa8ac63(0x1b7)]],_0x1f5454=[_0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x182)]],_0xdb422c=[_0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x19a)]],_0x34410f=[_0x44623a['body'][_0xa8ac63(0x171)]],_0x266251=[_0x44623a['body'][_0xa8ac63(0x185)]],_0x106a9e=[_0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x13f)]],_0x3a6a72=[_0x44623a['body']['secondary_unit']],_0x466566=[_0x44623a[_0xa8ac63(0x1b9)]['batch_code']],_0x4ea023=[_0x44623a['body'][_0xa8ac63(0x194)]],_0x34780d=[_0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x146)]],_0x20bc94=[_0x44623a['body'][_0xa8ac63(0x1d2)]],_0x177cf0=[_0x44623a['body'][_0xa8ac63(0x1bf)]],_0x17e83d=[_0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x113)]],_0x45d5ab=[_0x44623a[_0xa8ac63(0x1b9)]['RoomAssigned']],_0x5c3f01=[_0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x117)]],_0x367523=[_0x44623a['body'][_0xa8ac63(0x162)]],_0x353f4d=[_0x44623a['body'][_0xa8ac63(0x18d)]];else var _0xd7d64c=[..._0x44623a['body'][_0xa8ac63(0x132)]],_0x3a4e73=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x143)]],_0x513e14=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x10c)]],_0x132e37=[..._0x44623a['body'][_0xa8ac63(0x120)]],_0x32b2e2=[..._0x44623a[_0xa8ac63(0x1b9)]['to_prod_level']],_0x1f5454=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x182)]],_0xdb422c=[..._0x44623a['body'][_0xa8ac63(0x19a)]],_0x34410f=[..._0x44623a[_0xa8ac63(0x1b9)]['product_code3']],_0x266251=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x185)]],_0x106a9e=[..._0x44623a[_0xa8ac63(0x1b9)]['primary_unit']],_0x3a6a72=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x18b)]],_0x466566=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x197)]],_0x4ea023=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x194)]],_0x34780d=[..._0x44623a['body'][_0xa8ac63(0x146)]],_0x20bc94=[..._0x44623a['body'][_0xa8ac63(0x1d2)]],_0x177cf0=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x1bf)]],_0x17e83d=[..._0x44623a[_0xa8ac63(0x1b9)]['prod_cat']],_0x45d5ab=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x138)]],_0x5c3f01=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x117)]],_0x367523=[..._0x44623a['body'][_0xa8ac63(0x162)]],_0x353f4d=[..._0x44623a[_0xa8ac63(0x1b9)][_0xa8ac63(0x18d)]];const _0x467ae7=_0xd7d64c[_0xa8ac63(0x17b)](_0x34d3fe=>{return _0x34d3fe={'product_name':_0x34d3fe};});_0x3a4e73['forEach']((_0x126e5e,_0x242c70)=>{_0x467ae7[_0x242c70]['from_quantity']=_0x126e5e;}),_0x513e14[_0xa8ac63(0x16a)]((_0x16f401,_0x44d134)=>{var _0x371092=_0xa8ac63,_0x21e202=_0x16f401[_0x371092(0x15c)](/[A-Za-z]+/)[0x0],_0x121ece=parseInt(_0x16f401['match'](/\d+/)[0x0]);_0x467ae7[_0x44d134][_0x371092(0x15e)]=_0x121ece,_0x467ae7[_0x44d134][_0x371092(0x188)]=_0x21e202;}),_0x353f4d[_0xa8ac63(0x16a)]((_0x564986,_0x2d90ff)=>{_0x467ae7[_0x2d90ff]['id_transaction']=_0x564986;}),_0x367523[_0xa8ac63(0x16a)]((_0x1bfa1f,_0x2bf866)=>{var _0x11575f=_0xa8ac63;_0x467ae7[_0x2bf866][_0x11575f(0x162)]=_0x1bfa1f;}),_0x132e37[_0xa8ac63(0x16a)]((_0x47e797,_0x289ecc)=>{var _0x3d420c=_0xa8ac63;_0x467ae7[_0x289ecc][_0x3d420c(0x139)]=_0x47e797;}),_0x32b2e2[_0xa8ac63(0x16a)]((_0x6f9714,_0x2273a2)=>{var _0x10bf2e=_0xa8ac63,_0x4a3f95=_0x6f9714[_0x10bf2e(0x15c)](/[A-Za-z]+/)[0x0],_0x1919f1=parseInt(_0x6f9714[_0x10bf2e(0x15c)](/\d+/)[0x0]);_0x467ae7[_0x2273a2][_0x10bf2e(0x1a7)]=_0x4a3f95,_0x467ae7[_0x2273a2][_0x10bf2e(0x17a)]=_0x1919f1;}),_0x1f5454[_0xa8ac63(0x16a)]((_0x4e07dd,_0x2d29b8)=>{var _0x598127=_0xa8ac63;_0x467ae7[_0x2d29b8][_0x598127(0x182)]=_0x4e07dd;}),_0xdb422c[_0xa8ac63(0x16a)]((_0x4fcaa4,_0x286207)=>{var _0x5f0f4e=_0xa8ac63;_0x467ae7[_0x286207][_0x5f0f4e(0x19a)]=_0x4fcaa4;}),_0x34410f[_0xa8ac63(0x16a)]((_0x5dc91f,_0x1425d8)=>{var _0x45d682=_0xa8ac63;_0x467ae7[_0x1425d8][_0x45d682(0x1ab)]=_0x5dc91f;}),_0x266251[_0xa8ac63(0x16a)]((_0x367140,_0x3a3c02)=>{var _0x4b0b3b=_0xa8ac63;_0x467ae7[_0x3a3c02][_0x4b0b3b(0x13b)]=_0x367140;}),_0x106a9e['forEach']((_0x45b777,_0x516424)=>{var _0x453f77=_0xa8ac63;_0x467ae7[_0x516424][_0x453f77(0x161)]=_0x45b777;}),_0x3a6a72[_0xa8ac63(0x16a)]((_0x55eed6,_0xd57b42)=>{_0x467ae7[_0xd57b42]['secondary_unit']=_0x55eed6;}),_0x466566[_0xa8ac63(0x16a)]((_0x48570f,_0x132273)=>{var _0x553bf4=_0xa8ac63;_0x467ae7[_0x132273][_0x553bf4(0x197)]=_0x48570f;}),_0x4ea023[_0xa8ac63(0x16a)]((_0xfade11,_0x467d51)=>{var _0x32425c=_0xa8ac63;_0x467ae7[_0x467d51][_0x32425c(0x194)]=_0xfade11;}),_0x34780d[_0xa8ac63(0x16a)]((_0x28f686,_0x3ed546)=>{var _0x4dcc17=_0xa8ac63;_0x467ae7[_0x3ed546][_0x4dcc17(0x1c3)]=_0x28f686;}),_0x20bc94[_0xa8ac63(0x16a)]((_0x2475a8,_0x2aae04)=>{_0x467ae7[_0x2aae04]['maxProducts']=_0x2475a8;}),_0x177cf0[_0xa8ac63(0x16a)]((_0x379414,_0x58f194)=>{var _0x1b17fd=_0xa8ac63;_0x467ae7[_0x58f194][_0x1b17fd(0x1bf)]=_0x379414;}),_0x17e83d['forEach']((_0x2bd528,_0x25a2c3)=>{_0x467ae7[_0x25a2c3]['prod_cat']=_0x2bd528;}),_0x45d5ab['forEach']((_0x42f280,_0xe4b30e)=>{_0x467ae7[_0xe4b30e]['from_room_name']=_0x42f280;}),_0x5c3f01['forEach']((_0x2a1faf,_0x2c6449)=>{_0x467ae7[_0x2c6449]['to_room_name']=_0x2a1faf;});const _0x268d9e=_0x467ae7[_0xa8ac63(0x112)](_0x10ce8e=>_0x10ce8e[_0xa8ac63(0x139)]!=='0'&&_0x10ce8e[_0xa8ac63(0x139)]!==''||_0x10ce8e[_0xa8ac63(0x1c4)]!=='0'&&_0x10ce8e[_0xa8ac63(0x1c4)]!=='');var _0x5cf354=0x0;_0x268d9e[_0xa8ac63(0x16a)](_0x57bad9=>{var _0x33e006=_0xa8ac63;parseInt(_0x57bad9[_0x33e006(0x141)])<parseInt(_0x57bad9[_0x33e006(0x139)])&&_0x5cf354++;});if(_0x5cf354!=0x0)return _0x44623a[_0xa8ac63(0x1a2)](_0xa8ac63(0x14d),_0xa8ac63(0x15a)),_0x32cffc[_0xa8ac63(0x11c)]('back');const _0x535669=new transfers_logs();await _0x535669[_0xa8ac63(0x1bb)]();for(let _0x132695=0x0;_0x132695<=_0x5c3f01[_0xa8ac63(0x147)]-0x1;_0x132695++){_0x467ae7[_0x132695][_0xa8ac63(0x15f)]=_0xa8ac63(0x10e)+_0x535669['invoice_init'][_0xa8ac63(0x1bd)]()['padStart'](0x8,'0');}const _0x3ed5cf=new transfers_finished({'date':_0x27b1c2,'from_warehouse':_0x25de87,'to_warehouse':_0x25de87,'product':_0x268d9e,'note':_0x2a147,'invoice':_0xa8ac63(0x10e)+_0x535669['invoice_init'][_0xa8ac63(0x1bd)]()[_0xa8ac63(0x168)](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0xa8ac63(0x14c),'PO_number':_0x1db3e8,'RequestedBy':_0x5187a1,'DateofRequest':_0xe90cb9,'typeservices':_0x2c9a8b,'destination':_0x11f6d1,'deliverydate':_0x36b6ad,'driver':_0x39e206,'plate':_0xa438f9,'van':_0x5bc413,'DRSI':_0x47c5cb,'typevehicle':_0xf30de6,'TSU':_0x4ddfba,'TFU':_0x352844}),_0x2581e4=await _0x3ed5cf[_0xa8ac63(0x1bb)]();_0x44623a[_0xa8ac63(0x1a2)](_0xa8ac63(0x11e),_0xa8ac63(0x19c)),_0x32cffc['redirect'](_0xa8ac63(0x190)+_0x2581e4[_0xa8ac63(0x1a4)]);}catch(_0xd6207b){console[_0xa8ac63(0x153)](_0xd6207b),_0x32cffc[_0xa8ac63(0x125)](0xc8)[_0xa8ac63(0x181)]({'errorMessage':_0xd6207b[_0xa8ac63(0x199)]});}}),router['post'](a0_0x46b412(0x1b2),auth,async(_0x448cef,_0x10e235)=>{var _0x550db6=a0_0x46b412;try{const {date:_0x48cf9a,from_warehouse:_0x2917c9,FromRoom_name:_0x6ccba6,to_warehouse:_0x5f1195,ToRoom_name:_0x23f924,prod_name:_0x1490f5,from_prod_qty:_0x753da7,from_prod_level:_0x76f4b1,from_prod_isle:_0x4fad79,from_prod_pallet:_0x4da79e,to_prod_qty:_0x461817,to_prod_level:_0xa727f9,to_prod_isle:_0x2ddafe,to_prod_pallet:_0x50b8e8,primary_code:_0x2813d2,secondary_code:_0x142a45,product_code3:_0x4f9ba4,note:_0x125d84,MaxStocks_data2:_0x4c7bcb,invoice:_0x4bd74c,expiry_date:_0x46af49,PO_number_loc:_0x34af24,ReqBy_loc:_0x8c0780,dateofreq_loc:_0x970dbc,typeservices_loc_Data:_0x547c87,destination_loc:_0x34d3e7,deliverydate_loc:_0x1ddeee,driver_loc:_0x2f70cb,plate_loc:_0x50aae5,van_loc:_0x47446b,DRSI_loc:_0x4ef851,typevehicle_loc:_0x27ea8e,TSU_loc:_0x5b8ebc,TFU_loc:_0x55d804}=_0x448cef[_0x550db6(0x1b9)];if(typeof _0x1490f5==_0x550db6(0x189))var _0x5cf74e=[_0x448cef['body'][_0x550db6(0x132)]],_0x5d33bd=[_0x448cef[_0x550db6(0x1b9)]['from_prod_qty']],_0x5f549d=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x10c)]],_0x1c25f2=[_0x448cef[_0x550db6(0x1b9)]['New_Qty_Converted']],_0x5c66c4=[_0x448cef['body'][_0x550db6(0x1b7)]],_0x34096b=[_0x448cef[_0x550db6(0x1b9)]['primary_code']],_0x42a362=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x19a)]],_0x132339=[_0x448cef['body']['product_code3']],_0x1473fc=[_0x448cef['body'][_0x550db6(0x185)]],_0x5c31f4=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x13f)]],_0x2345ce=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x18b)]],_0x286ba8=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x197)]],_0x159389=[_0x448cef['body'][_0x550db6(0x194)]],_0x12a3c0=[_0x448cef[_0x550db6(0x1b9)]['product_date']],_0x367f6a=[_0x448cef[_0x550db6(0x1b9)]['MaxStocks_data']],_0x429ead=[_0x448cef['body']['maxPerUnit']],_0xbf110a=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x113)]],_0x4a23ed=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x138)]],_0x275848=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x117)]],_0x763814=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x162)]],_0x46d7c9=[_0x448cef[_0x550db6(0x1b9)][_0x550db6(0x18d)]];else var _0x5cf74e=[..._0x448cef[_0x550db6(0x1b9)]['prod_name']],_0x5d33bd=[..._0x448cef[_0x550db6(0x1b9)][_0x550db6(0x143)]],_0x5f549d=[..._0x448cef['body'][_0x550db6(0x10c)]],_0x1c25f2=[..._0x448cef[_0x550db6(0x1b9)][_0x550db6(0x120)]],_0x5c66c4=[..._0x448cef['body'][_0x550db6(0x1b7)]],_0x34096b=[..._0x448cef[_0x550db6(0x1b9)][_0x550db6(0x182)]],_0x42a362=[..._0x448cef[_0x550db6(0x1b9)][_0x550db6(0x19a)]],_0x132339=[..._0x448cef[_0x550db6(0x1b9)]['product_code3']],_0x1473fc=[..._0x448cef[_0x550db6(0x1b9)][_0x550db6(0x185)]],_0x5c31f4=[..._0x448cef[_0x550db6(0x1b9)]['primary_unit']],_0x2345ce=[..._0x448cef['body']['secondary_unit']],_0x286ba8=[..._0x448cef[_0x550db6(0x1b9)][_0x550db6(0x197)]],_0x159389=[..._0x448cef['body'][_0x550db6(0x194)]],_0x12a3c0=[..._0x448cef[_0x550db6(0x1b9)]['product_date']],_0x367f6a=[..._0x448cef['body'][_0x550db6(0x1d2)]],_0x429ead=[..._0x448cef['body'][_0x550db6(0x1bf)]],_0xbf110a=[..._0x448cef[_0x550db6(0x1b9)][_0x550db6(0x113)]],_0x4a23ed=[..._0x448cef[_0x550db6(0x1b9)][_0x550db6(0x138)]],_0x275848=[..._0x448cef[_0x550db6(0x1b9)]['ToRoomAssigned']],_0x763814=[..._0x448cef['body'][_0x550db6(0x162)]],_0x46d7c9=[..._0x448cef['body']['id_transaction']];const _0x3633e1=_0x5cf74e[_0x550db6(0x17b)](_0x400ac5=>{return _0x400ac5={'product_name':_0x400ac5};});_0x5d33bd[_0x550db6(0x16a)]((_0x376a1d,_0x3f166e)=>{var _0x4fd487=_0x550db6;_0x3633e1[_0x3f166e][_0x4fd487(0x141)]=_0x376a1d;}),_0x5f549d[_0x550db6(0x16a)]((_0x1dca9a,_0x57f252)=>{var _0x209ce0=_0x550db6,_0x28bd45=_0x1dca9a[_0x209ce0(0x15c)](/[A-Za-z]+/)[0x0],_0x26b876=parseInt(_0x1dca9a[_0x209ce0(0x15c)](/\d+/)[0x0]);_0x3633e1[_0x57f252][_0x209ce0(0x15e)]=_0x26b876,_0x3633e1[_0x57f252][_0x209ce0(0x188)]=_0x28bd45;}),_0x46d7c9['forEach']((_0x31ccd5,_0x5ed3e4)=>{var _0x20b75f=_0x550db6;_0x3633e1[_0x5ed3e4][_0x20b75f(0x18d)]=_0x31ccd5;}),_0x763814[_0x550db6(0x16a)]((_0x3ec0d7,_0x535114)=>{_0x3633e1[_0x535114]['from_invoice']=_0x3ec0d7;}),_0x1c25f2['forEach']((_0x348d58,_0x34fa92)=>{var _0x42f114=_0x550db6;_0x3633e1[_0x34fa92][_0x42f114(0x139)]=_0x348d58;}),_0x5c66c4[_0x550db6(0x16a)]((_0x2b9fb4,_0x372092)=>{var _0x151f2f=_0x550db6,_0x2ff4f1=_0x2b9fb4['match'](/[A-Za-z]+/)[0x0],_0x5165a2=parseInt(_0x2b9fb4[_0x151f2f(0x15c)](/\d+/)[0x0]);_0x3633e1[_0x372092][_0x151f2f(0x1a7)]=_0x2ff4f1,_0x3633e1[_0x372092][_0x151f2f(0x17a)]=_0x5165a2;}),_0x34096b[_0x550db6(0x16a)]((_0x2fcc50,_0x1de243)=>{var _0x1dfe61=_0x550db6;_0x3633e1[_0x1de243][_0x1dfe61(0x182)]=_0x2fcc50;}),_0x42a362[_0x550db6(0x16a)]((_0x7eee27,_0x45dde7)=>{_0x3633e1[_0x45dde7]['secondary_code']=_0x7eee27;}),_0x132339[_0x550db6(0x16a)]((_0x47b318,_0xb44cd9)=>{var _0x3c2c60=_0x550db6;_0x3633e1[_0xb44cd9][_0x3c2c60(0x1ab)]=_0x47b318;}),_0x1473fc[_0x550db6(0x16a)]((_0x3e3a7c,_0x10c61f)=>{var _0x4dcee2=_0x550db6;_0x3633e1[_0x10c61f][_0x4dcee2(0x13b)]=_0x3e3a7c;}),_0x5c31f4[_0x550db6(0x16a)]((_0x1d52ef,_0x1633e8)=>{var _0x2f288c=_0x550db6;_0x3633e1[_0x1633e8][_0x2f288c(0x161)]=_0x1d52ef;}),_0x2345ce[_0x550db6(0x16a)]((_0x1c2f4a,_0x22c9f4)=>{_0x3633e1[_0x22c9f4]['secondary_unit']=_0x1c2f4a;}),_0x286ba8[_0x550db6(0x16a)]((_0x2256bc,_0x24ae6a)=>{var _0x2561be=_0x550db6;_0x3633e1[_0x24ae6a][_0x2561be(0x197)]=_0x2256bc;}),_0x159389[_0x550db6(0x16a)]((_0x2b036e,_0x2a5ff6)=>{var _0xa9fac8=_0x550db6;_0x3633e1[_0x2a5ff6][_0xa9fac8(0x194)]=_0x2b036e;}),_0x12a3c0['forEach']((_0x58fb0a,_0x5a8bd1)=>{_0x3633e1[_0x5a8bd1]['production_date']=_0x58fb0a;}),_0x367f6a[_0x550db6(0x16a)]((_0xdd3cb1,_0x13eaad)=>{var _0x5cc40e=_0x550db6;_0x3633e1[_0x13eaad][_0x5cc40e(0x13b)]=_0xdd3cb1;}),_0x429ead[_0x550db6(0x16a)]((_0x3d2bf5,_0x3c7127)=>{var _0x496489=_0x550db6;_0x3633e1[_0x3c7127][_0x496489(0x1bf)]=_0x3d2bf5;}),_0xbf110a[_0x550db6(0x16a)]((_0x3acd62,_0x353de0)=>{var _0x1c7f70=_0x550db6;_0x3633e1[_0x353de0][_0x1c7f70(0x113)]=_0x3acd62;}),_0x4a23ed[_0x550db6(0x16a)]((_0x17bc9d,_0x446a57)=>{_0x3633e1[_0x446a57]['from_room_name']=_0x17bc9d;}),_0x275848[_0x550db6(0x16a)]((_0x57ffa6,_0x1c2e4f)=>{var _0x143f8c=_0x550db6;_0x3633e1[_0x1c2e4f][_0x143f8c(0x1b1)]=_0x57ffa6;});const _0x8b6b0b=_0x3633e1['filter'](_0x5f56c3=>_0x5f56c3[_0x550db6(0x139)]!=='0'&&_0x5f56c3[_0x550db6(0x139)]!==''||_0x5f56c3[_0x550db6(0x1c4)]!=='0'&&_0x5f56c3[_0x550db6(0x1c4)]!=='');var _0x112f4d=0x0;_0x8b6b0b[_0x550db6(0x16a)](_0x1beab9=>{var _0x5ed84e=_0x550db6;parseInt(_0x1beab9[_0x5ed84e(0x141)])<parseInt(_0x1beab9[_0x5ed84e(0x139)])&&_0x112f4d++;});if(_0x112f4d!=0x0)return _0x448cef[_0x550db6(0x1a2)](_0x550db6(0x14d),_0x550db6(0x15a)),_0x10e235[_0x550db6(0x11c)]('back');const _0x2851d2=new transfers_logs();await _0x2851d2[_0x550db6(0x1bb)]();for(let _0x2048ab=0x0;_0x2048ab<=_0x275848[_0x550db6(0x147)]-0x1;_0x2048ab++){_0x3633e1[_0x2048ab][_0x550db6(0x15f)]='LOG-TRF-'+_0x2851d2['invoice_init'][_0x550db6(0x1bd)]()[_0x550db6(0x168)](0x8,'0');}const _0x3257dc=new transfers_finished({'date':_0x48cf9a,'from_warehouse':_0x2917c9,'to_warehouse':_0x5f1195,'product':_0x8b6b0b,'note':_0x125d84,'invoice':_0x550db6(0x10e)+_0x2851d2[_0x550db6(0x126)][_0x550db6(0x1bd)]()[_0x550db6(0x168)](0x8,'0'),'type_of_transaction':_0x550db6(0x14c),'type_of_process':_0x550db6(0x13c),'PO_number':_0x34af24,'RequestedBy':_0x8c0780,'DateofRequest':_0x970dbc,'typeservices':_0x547c87,'destination':_0x34d3e7,'deliverydate':_0x1ddeee,'driver':_0x2f70cb,'plate':_0x50aae5,'van':_0x47446b,'DRSI':_0x4ef851,'typevehicle':_0x27ea8e,'TSU':_0x5b8ebc,'TFU':_0x55d804}),_0x37584d=await _0x3257dc[_0x550db6(0x1bb)]();_0x448cef[_0x550db6(0x1a2)](_0x550db6(0x11e),_0x550db6(0x19c)),_0x10e235['redirect'](_0x550db6(0x190)+_0x37584d[_0x550db6(0x1a4)]);}catch(_0x1dbc50){console[_0x550db6(0x153)](_0x1dbc50),_0x10e235[_0x550db6(0x125)](0xc8)[_0x550db6(0x181)]({'errorMessage':_0x1dbc50[_0x550db6(0x199)]});}}),router[a0_0x46b412(0x1bc)]('/view/add_transfer',auth,async(_0x1971f8,_0x491ec4)=>{var _0xa29304=a0_0x46b412;try{const {date:_0x7495e8,from_warehouse:_0x4ce00a,FromRoom_name:_0x28f15d,to_warehouse:_0x1463e6,ToRoom_name:_0x31c826,prod_name:_0x4ed5ec,from_prod_qty:_0x36b896,from_prod_level:_0x23069a,from_prod_isle:_0x327d52,from_prod_pallet:_0x9de27a,to_prod_qty:_0x3a8eb6,to_prod_level:_0x11ceee,to_prod_isle:_0x2c6f65,to_prod_pallet:_0x16df9c,primary_code:_0x37d03a,secondary_code:_0x313d21,product_code3:_0x4305b1,note:_0x3f4c55,MaxStocks_data2:_0x4a1b6f,invoice:_0x285a4a,expiry_date:_0x5a9db8,PO_number:_0x2781e9,ReqBy:_0x36cd91,dateofreq:_0x735d06,typeservicesData:_0x120199,destination:_0x2a7d2a,deliverydate:_0x2c9146,driver:_0x4eaa2a,plate:_0x191024,van:_0xb9f51c,DRSI:_0x401709,typevehicle:_0x3317b9,TSU:_0x2a197c,TFU:_0x422099}=_0x1971f8[_0xa29304(0x1b9)];if(typeof _0x4ed5ec=='string')var _0xdeddd5=[_0x1971f8['body'][_0xa29304(0x132)]],_0x2cd8f8=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x143)]],_0x5795ee=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x10c)]],_0x1e0132=[_0x1971f8['body']['New_Qty_Converted']],_0x57d680=[_0x1971f8['body'][_0xa29304(0x1b7)]],_0x2d3474=[_0x1971f8[_0xa29304(0x1b9)]['primary_code']],_0x1a4a0f=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x19a)]],_0x26b227=[_0x1971f8['body'][_0xa29304(0x171)]],_0x1cb880=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x185)]],_0x2261b5=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x13f)]],_0x40c416=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x18b)]],_0x252b22=[_0x1971f8['body'][_0xa29304(0x197)]],_0x5ed300=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x194)]],_0x2de85a=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x146)]],_0x18d11d=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x1d2)]],_0x3782df=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x1bf)]],_0x4a1b91=[_0x1971f8[_0xa29304(0x1b9)]['prod_cat']],_0x370eb9=[_0x1971f8[_0xa29304(0x1b9)]['RoomAssigned']],_0x56be9f=[_0x1971f8[_0xa29304(0x1b9)]['ToRoomAssigned']],_0x45a349=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x162)]],_0x3624c7=[_0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x18d)]];else var _0xdeddd5=[..._0x1971f8[_0xa29304(0x1b9)]['prod_name']],_0x2cd8f8=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x143)]],_0x5795ee=[..._0x1971f8[_0xa29304(0x1b9)]['from_prod_level2']],_0x1e0132=[..._0x1971f8[_0xa29304(0x1b9)]['New_Qty_Converted']],_0x57d680=[..._0x1971f8['body'][_0xa29304(0x1b7)]],_0x2d3474=[..._0x1971f8['body'][_0xa29304(0x182)]],_0x1a4a0f=[..._0x1971f8['body'][_0xa29304(0x19a)]],_0x26b227=[..._0x1971f8['body']['product_code3']],_0x1cb880=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x185)]],_0x2261b5=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x13f)]],_0x40c416=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x18b)]],_0x252b22=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x197)]],_0x5ed300=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x194)]],_0x2de85a=[..._0x1971f8['body'][_0xa29304(0x146)]],_0x18d11d=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x1d2)]],_0x3782df=[..._0x1971f8['body'][_0xa29304(0x1bf)]],_0x4a1b91=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x113)]],_0x370eb9=[..._0x1971f8['body'][_0xa29304(0x138)]],_0x56be9f=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x117)]],_0x45a349=[..._0x1971f8['body']['from_invoice']],_0x3624c7=[..._0x1971f8[_0xa29304(0x1b9)][_0xa29304(0x18d)]];const _0x32e8ea=_0xdeddd5[_0xa29304(0x17b)](_0x20cee8=>{return _0x20cee8={'product_name':_0x20cee8};});_0x2cd8f8[_0xa29304(0x16a)]((_0x241ec1,_0x78b607)=>{var _0x89cc5e=_0xa29304;_0x32e8ea[_0x78b607][_0x89cc5e(0x141)]=_0x241ec1;}),_0x5795ee['forEach']((_0x571793,_0x4c20ba)=>{var _0x3fa89e=_0xa29304,_0x3ccc4c=_0x571793[_0x3fa89e(0x15c)](/[A-Za-z]+/)[0x0],_0x5266d2=parseInt(_0x571793[_0x3fa89e(0x15c)](/\d+/)[0x0]);_0x32e8ea[_0x4c20ba][_0x3fa89e(0x15e)]=_0x5266d2,_0x32e8ea[_0x4c20ba]['from_level']=_0x3ccc4c;}),_0x3624c7['forEach']((_0x5ce2a8,_0x1baaf7)=>{_0x32e8ea[_0x1baaf7]['id_transaction']=_0x5ce2a8;}),_0x45a349[_0xa29304(0x16a)]((_0x35e386,_0x5ef825)=>{var _0x265199=_0xa29304;_0x32e8ea[_0x5ef825][_0x265199(0x162)]=_0x35e386;}),_0x1e0132[_0xa29304(0x16a)]((_0x448915,_0x3782b0)=>{var _0x370d30=_0xa29304;_0x32e8ea[_0x3782b0][_0x370d30(0x139)]=_0x448915;}),_0x57d680[_0xa29304(0x16a)]((_0x32e520,_0x5df246)=>{var _0x23e02c=_0xa29304,_0x5dbd09=_0x32e520[_0x23e02c(0x15c)](/[A-Za-z]+/)[0x0],_0x35c4a5=parseInt(_0x32e520[_0x23e02c(0x15c)](/\d+/)[0x0]);_0x32e8ea[_0x5df246][_0x23e02c(0x1a7)]=_0x5dbd09,_0x32e8ea[_0x5df246][_0x23e02c(0x17a)]=_0x35c4a5;}),_0x2d3474['forEach']((_0x339dc5,_0x27eeb8)=>{var _0x14ebd3=_0xa29304;_0x32e8ea[_0x27eeb8][_0x14ebd3(0x182)]=_0x339dc5;}),_0x1a4a0f['forEach']((_0x36aeb0,_0xc4a74f)=>{var _0x2c8d55=_0xa29304;_0x32e8ea[_0xc4a74f][_0x2c8d55(0x19a)]=_0x36aeb0;}),_0x26b227[_0xa29304(0x16a)]((_0x269991,_0xcab852)=>{_0x32e8ea[_0xcab852]['product_code']=_0x269991;}),_0x1cb880[_0xa29304(0x16a)]((_0x5c9beb,_0x3e65d8)=>{var _0x4f6622=_0xa29304;_0x32e8ea[_0x3e65d8][_0x4f6622(0x13b)]=_0x5c9beb;}),_0x2261b5[_0xa29304(0x16a)]((_0x53e356,_0x24b996)=>{var _0x4f40e5=_0xa29304;_0x32e8ea[_0x24b996][_0x4f40e5(0x161)]=_0x53e356;}),_0x40c416['forEach']((_0x43a65c,_0x463f04)=>{var _0x13cb1c=_0xa29304;_0x32e8ea[_0x463f04][_0x13cb1c(0x18b)]=_0x43a65c;}),_0x252b22[_0xa29304(0x16a)]((_0x5f0cdd,_0x22c19d)=>{_0x32e8ea[_0x22c19d]['batch_code']=_0x5f0cdd;}),_0x5ed300[_0xa29304(0x16a)]((_0x5e60c2,_0x4604cf)=>{var _0x51ef21=_0xa29304;_0x32e8ea[_0x4604cf][_0x51ef21(0x194)]=_0x5e60c2;}),_0x2de85a['forEach']((_0x3eb171,_0x5b3726)=>{var _0x1b0f86=_0xa29304;_0x32e8ea[_0x5b3726][_0x1b0f86(0x1c3)]=_0x3eb171;}),_0x18d11d[_0xa29304(0x16a)]((_0x233dcc,_0x520ac4)=>{_0x32e8ea[_0x520ac4]['maxProducts']=_0x233dcc;}),_0x3782df[_0xa29304(0x16a)]((_0x5478f4,_0x93dce7)=>{_0x32e8ea[_0x93dce7]['maxPerUnit']=_0x5478f4;}),_0x4a1b91[_0xa29304(0x16a)]((_0x21ffe3,_0x2ca98c)=>{var _0x2335ea=_0xa29304;_0x32e8ea[_0x2ca98c][_0x2335ea(0x113)]=_0x21ffe3;}),_0x370eb9[_0xa29304(0x16a)]((_0x2acab6,_0x349a07)=>{var _0x2e3b35=_0xa29304;_0x32e8ea[_0x349a07][_0x2e3b35(0x19e)]=_0x2acab6;}),_0x56be9f[_0xa29304(0x16a)]((_0x40dddf,_0x503238)=>{_0x32e8ea[_0x503238]['to_room_name']=_0x40dddf;});const _0x5898df=_0x32e8ea[_0xa29304(0x112)](_0x2c84ab=>_0x2c84ab[_0xa29304(0x139)]!=='0'&&_0x2c84ab[_0xa29304(0x139)]!==''||_0x2c84ab['to_floorlevel']!=='0'&&_0x2c84ab[_0xa29304(0x1c4)]!=='');var _0x3d1859=0x0;_0x5898df[_0xa29304(0x16a)](_0x5c4fbc=>{var _0x24aaeb=_0xa29304;parseInt(_0x5c4fbc['from_quantity'])<parseInt(_0x5c4fbc[_0x24aaeb(0x139)])&&_0x3d1859++;});if(_0x3d1859!=0x0)return _0x1971f8[_0xa29304(0x1a2)](_0xa29304(0x14d),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x491ec4['redirect'](_0xa29304(0x11d));const _0x394bf8=new invoice_for_transfer();await _0x394bf8[_0xa29304(0x1bb)]();for(let _0x56b94a=0x0;_0x56b94a<=_0x56be9f[_0xa29304(0x147)]-0x1;_0x56b94a++){_0x32e8ea[_0x56b94a]['To_invoice']=_0xa29304(0x122)+_0x394bf8[_0xa29304(0x126)][_0xa29304(0x1bd)]()['padStart'](0x8,'0');}const _0x3a33c8=new transfers_finished({'date':_0x7495e8,'from_warehouse':_0x4ce00a,'to_warehouse':_0x4ce00a,'product':_0x5898df,'note':_0x3f4c55,'invoice':_0xa29304(0x122)+_0x394bf8[_0xa29304(0x126)][_0xa29304(0x1bd)]()[_0xa29304(0x168)](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0xa29304(0x1cf),'PO_number':_0x2781e9,'RequestedBy':_0x36cd91,'DateofRequest':_0x735d06,'typeservices':_0x120199,'destination':_0x2a7d2a,'deliverydate':_0x2c9146,'driver':_0x4eaa2a,'plate':_0x191024,'van':_0xb9f51c,'DRSI':_0x401709,'typevehicle':_0x3317b9,'TSU':_0x2a197c,'TFU':_0x422099}),_0x2c262f=await _0x3a33c8[_0xa29304(0x1bb)]();_0x1971f8[_0xa29304(0x1a2)](_0xa29304(0x11e),'Product\x20Transfer\x20successfully'),_0x491ec4[_0xa29304(0x11c)](_0xa29304(0x190)+_0x2c262f[_0xa29304(0x1a4)]);}catch(_0x1cb258){console[_0xa29304(0x153)](_0x1cb258),_0x491ec4[_0xa29304(0x125)](0xc8)[_0xa29304(0x181)]({'errorMessage':_0x1cb258[_0xa29304(0x199)]});}}),router[a0_0x46b412(0x1bc)](a0_0x46b412(0x1a0),auth,async(_0x307368,_0x1659cd)=>{var _0xdafd2a=a0_0x46b412;try{const {date:_0x77ce48,from_warehouse:_0x450a26,FromRoom_name:_0x500e9e,to_warehouse:_0x35d2e9,ToRoom_name:_0x31b651,prod_name:_0x2dcb1a,from_prod_qty:_0x5e1626,from_prod_level:_0x4a5892,from_prod_isle:_0x1985b2,from_prod_pallet:_0x48e27d,to_prod_qty:_0x3cc23e,to_prod_level:_0x4365d0,to_prod_isle:_0x47a60d,to_prod_pallet:_0x5c5960,primary_code:_0x597fae,secondary_code:_0x318a59,product_code3:_0x5bd528,note:_0x337998,MaxStocks_data2:_0x4636d8,invoice:_0x573bec,expiry_date:_0x22bc40,PO_number_loc:_0x5ce2a9,ReqBy_loc:_0x2c38f4,dateofreq_loc:_0x33d783,typeservices_loc_Data:_0x4009d6,destination_loc:_0xe7d5c5,deliverydate_loc:_0x480cd1,driver_loc:_0xb70a67,plate_loc:_0x5f1d88,van_loc:_0x29eb51,DRSI_loc:_0x275eae,typevehicle_loc:_0xd1fa18,TSU_loc:_0x48792c,TFU_loc:_0x62f2ea}=_0x307368[_0xdafd2a(0x1b9)];if(typeof _0x2dcb1a==_0xdafd2a(0x189))var _0x57c65b=[_0x307368['body']['prod_name']],_0xcc1fb1=[_0x307368['body'][_0xdafd2a(0x143)]],_0x49bd2d=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x10c)]],_0x5d59c3=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x120)]],_0x5ed2e6=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x1b7)]],_0x376b9d=[_0x307368['body'][_0xdafd2a(0x182)]],_0x44f9c5=[_0x307368[_0xdafd2a(0x1b9)]['secondary_code']],_0x128da3=[_0x307368['body'][_0xdafd2a(0x171)]],_0x3a0083=[_0x307368['body']['MaxStocks_data2']],_0x5c1ab5=[_0x307368['body'][_0xdafd2a(0x13f)]],_0x227b59=[_0x307368['body'][_0xdafd2a(0x18b)]],_0x2a039f=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x197)]],_0x320ecb=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x194)]],_0x2e7379=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x146)]],_0x76512d=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x1d2)]],_0x54c0f9=[_0x307368[_0xdafd2a(0x1b9)]['maxPerUnit']],_0x24e9b2=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x113)]],_0x5d7a18=[_0x307368[_0xdafd2a(0x1b9)]['RoomAssigned']],_0x5d2334=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x117)]],_0x1b1bb7=[_0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x162)]],_0x302373=[_0x307368['body'][_0xdafd2a(0x18d)]];else var _0x57c65b=[..._0x307368['body']['prod_name']],_0xcc1fb1=[..._0x307368[_0xdafd2a(0x1b9)]['from_prod_qty']],_0x49bd2d=[..._0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x10c)]],_0x5d59c3=[..._0x307368['body'][_0xdafd2a(0x120)]],_0x5ed2e6=[..._0x307368['body'][_0xdafd2a(0x1b7)]],_0x376b9d=[..._0x307368[_0xdafd2a(0x1b9)]['primary_code']],_0x44f9c5=[..._0x307368[_0xdafd2a(0x1b9)]['secondary_code']],_0x128da3=[..._0x307368[_0xdafd2a(0x1b9)]['product_code3']],_0x3a0083=[..._0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x185)]],_0x5c1ab5=[..._0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x13f)]],_0x227b59=[..._0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x18b)]],_0x2a039f=[..._0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x197)]],_0x320ecb=[..._0x307368[_0xdafd2a(0x1b9)]['expiry_date']],_0x2e7379=[..._0x307368[_0xdafd2a(0x1b9)]['product_date']],_0x76512d=[..._0x307368['body'][_0xdafd2a(0x1d2)]],_0x54c0f9=[..._0x307368[_0xdafd2a(0x1b9)]['maxPerUnit']],_0x24e9b2=[..._0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x113)]],_0x5d7a18=[..._0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x138)]],_0x5d2334=[..._0x307368['body'][_0xdafd2a(0x117)]],_0x1b1bb7=[..._0x307368['body'][_0xdafd2a(0x162)]],_0x302373=[..._0x307368[_0xdafd2a(0x1b9)][_0xdafd2a(0x18d)]];const _0x6d4ac3=_0x57c65b[_0xdafd2a(0x17b)](_0x73568b=>{return _0x73568b={'product_name':_0x73568b};});_0xcc1fb1['forEach']((_0x2e4081,_0x4f6199)=>{_0x6d4ac3[_0x4f6199]['from_quantity']=_0x2e4081;}),_0x49bd2d[_0xdafd2a(0x16a)]((_0x40374d,_0x2124af)=>{var _0x33be85=_0xdafd2a,_0x1c7b8e=_0x40374d[_0x33be85(0x15c)](/[A-Za-z]+/)[0x0],_0x37c8b7=parseInt(_0x40374d[_0x33be85(0x15c)](/\d+/)[0x0]);_0x6d4ac3[_0x2124af]['from_bay']=_0x37c8b7,_0x6d4ac3[_0x2124af][_0x33be85(0x188)]=_0x1c7b8e;}),_0x302373[_0xdafd2a(0x16a)]((_0x4aa5e8,_0x3a9ba8)=>{_0x6d4ac3[_0x3a9ba8]['id_transaction']=_0x4aa5e8;}),_0x1b1bb7['forEach']((_0x213741,_0x36abbd)=>{_0x6d4ac3[_0x36abbd]['from_invoice']=_0x213741;}),_0x5d59c3[_0xdafd2a(0x16a)]((_0x28f5d8,_0x40a773)=>{_0x6d4ac3[_0x40a773]['to_quantity']=_0x28f5d8;}),_0x5ed2e6[_0xdafd2a(0x16a)]((_0xf9481,_0x1dcc56)=>{var _0x38782b=_0xdafd2a,_0x299781=_0xf9481[_0x38782b(0x15c)](/[A-Za-z]+/)[0x0],_0x374ae2=parseInt(_0xf9481['match'](/\d+/)[0x0]);_0x6d4ac3[_0x1dcc56]['to_level']=_0x299781,_0x6d4ac3[_0x1dcc56][_0x38782b(0x17a)]=_0x374ae2;}),_0x376b9d[_0xdafd2a(0x16a)]((_0x10c159,_0x4fe539)=>{_0x6d4ac3[_0x4fe539]['primary_code']=_0x10c159;}),_0x44f9c5[_0xdafd2a(0x16a)]((_0x3dfa8e,_0x52bd4f)=>{var _0x20faef=_0xdafd2a;_0x6d4ac3[_0x52bd4f][_0x20faef(0x19a)]=_0x3dfa8e;}),_0x128da3[_0xdafd2a(0x16a)]((_0x4dc677,_0x4be372)=>{var _0x226622=_0xdafd2a;_0x6d4ac3[_0x4be372][_0x226622(0x1ab)]=_0x4dc677;}),_0x3a0083[_0xdafd2a(0x16a)]((_0x3683c9,_0x470cdf)=>{var _0x2455aa=_0xdafd2a;_0x6d4ac3[_0x470cdf][_0x2455aa(0x13b)]=_0x3683c9;}),_0x5c1ab5['forEach']((_0x21df3c,_0x2d77fc)=>{var _0x50dfc8=_0xdafd2a;_0x6d4ac3[_0x2d77fc][_0x50dfc8(0x161)]=_0x21df3c;}),_0x227b59[_0xdafd2a(0x16a)]((_0x245c05,_0x3fb5a4)=>{var _0x36d644=_0xdafd2a;_0x6d4ac3[_0x3fb5a4][_0x36d644(0x18b)]=_0x245c05;}),_0x2a039f[_0xdafd2a(0x16a)]((_0x3fd2cd,_0x4a5532)=>{_0x6d4ac3[_0x4a5532]['batch_code']=_0x3fd2cd;}),_0x320ecb[_0xdafd2a(0x16a)]((_0x545b05,_0x3f1bce)=>{var _0x2363f4=_0xdafd2a;_0x6d4ac3[_0x3f1bce][_0x2363f4(0x194)]=_0x545b05;}),_0x2e7379['forEach']((_0x4a5dd4,_0x393c75)=>{var _0x299201=_0xdafd2a;_0x6d4ac3[_0x393c75][_0x299201(0x1c3)]=_0x4a5dd4;}),_0x76512d['forEach']((_0xd95149,_0xda8abf)=>{_0x6d4ac3[_0xda8abf]['maxProducts']=_0xd95149;}),_0x54c0f9[_0xdafd2a(0x16a)]((_0x2f59fd,_0x3db3be)=>{var _0xff184c=_0xdafd2a;_0x6d4ac3[_0x3db3be][_0xff184c(0x1bf)]=_0x2f59fd;}),_0x24e9b2[_0xdafd2a(0x16a)]((_0xc9c498,_0x17a81a)=>{var _0x4ecaaa=_0xdafd2a;_0x6d4ac3[_0x17a81a][_0x4ecaaa(0x113)]=_0xc9c498;}),_0x5d7a18[_0xdafd2a(0x16a)]((_0x5752d8,_0x406341)=>{_0x6d4ac3[_0x406341]['from_room_name']=_0x5752d8;}),_0x5d2334[_0xdafd2a(0x16a)]((_0x174dd9,_0x48697e)=>{var _0x37eb1f=_0xdafd2a;_0x6d4ac3[_0x48697e][_0x37eb1f(0x1b1)]=_0x174dd9;});const _0x136f3c=_0x6d4ac3[_0xdafd2a(0x112)](_0x4f51a2=>_0x4f51a2[_0xdafd2a(0x139)]!=='0'&&_0x4f51a2[_0xdafd2a(0x139)]!==''||_0x4f51a2['to_floorlevel']!=='0'&&_0x4f51a2[_0xdafd2a(0x1c4)]!=='');var _0x29b276=0x0;_0x136f3c['forEach'](_0x1dae96=>{var _0x303e5b=_0xdafd2a;parseInt(_0x1dae96['from_quantity'])<parseInt(_0x1dae96[_0x303e5b(0x139)])&&_0x29b276++;});if(_0x29b276!=0x0)return _0x307368[_0xdafd2a(0x1a2)](_0xdafd2a(0x14d),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x1659cd['redirect']('back');const _0x5dc199=new invoice_for_transfer();await _0x5dc199[_0xdafd2a(0x1bb)]();for(let _0x570c06=0x0;_0x570c06<=_0x5d2334[_0xdafd2a(0x147)]-0x1;_0x570c06++){_0x6d4ac3[_0x570c06]['To_invoice']='TRF-'+_0x5dc199[_0xdafd2a(0x126)]['toString']()[_0xdafd2a(0x168)](0x8,'0');}const _0x24b81f=new transfers_finished({'date':_0x77ce48,'from_warehouse':_0x450a26,'to_warehouse':_0x35d2e9,'product':_0x136f3c,'note':_0x337998,'invoice':_0xdafd2a(0x122)+_0x5dc199[_0xdafd2a(0x126)][_0xdafd2a(0x1bd)]()[_0xdafd2a(0x168)](0x8,'0'),'type_of_transaction':'own','type_of_process':'location2location','PO_number':_0x5ce2a9,'RequestedBy':_0x2c38f4,'DateofRequest':_0x33d783,'typeservices':_0x4009d6,'destination':_0xe7d5c5,'deliverydate':_0x480cd1,'driver':_0xb70a67,'plate':_0x5f1d88,'van':_0x29eb51,'DRSI':_0x275eae,'typevehicle':_0xd1fa18,'TSU':_0x48792c,'TFU':_0x62f2ea}),_0x320a53=await _0x24b81f['save']();_0x307368[_0xdafd2a(0x1a2)](_0xdafd2a(0x11e),_0xdafd2a(0x19c)),_0x1659cd[_0xdafd2a(0x11c)](_0xdafd2a(0x190)+_0x320a53[_0xdafd2a(0x1a4)]);}catch(_0x28b3bf){console[_0xdafd2a(0x153)](_0x28b3bf),_0x1659cd[_0xdafd2a(0x125)](0xc8)[_0xdafd2a(0x181)]({'errorMessage':_0x28b3bf[_0xdafd2a(0x199)]});}}),router[a0_0x46b412(0x144)](a0_0x46b412(0x109),auth,async(_0x1fc739,_0x180110)=>{var _0x18e788=a0_0x46b412;try{const {username:_0xcd667a,email:_0x5bbe29,role:_0x61b80c}=_0x1fc739['user'],_0x5b9db8=_0x1fc739['user'],_0x555599=await profile['findOne']({'email':_0x5b9db8[_0x18e788(0x134)]}),_0x3c8e1c=await master_shop[_0x18e788(0x12c)](),_0x36f700=await transfers_finished[_0x18e788(0x1ae)](_0x1fc739[_0x18e788(0x169)]['id']);let _0x460d34;if(_0x5b9db8['role']==_0x18e788(0x10f)){const _0x3f68ef=await staff['findOne']({'email':_0x5b9db8[_0x18e788(0x134)]});_0x460d34=await warehouse['find']({'status':_0x18e788(0x195),'name':_0x3f68ef[_0x18e788(0x145)],'warehouse_category':_0x18e788(0x151)});}else _0x460d34=await warehouse[_0x18e788(0x12c)]({'status':_0x18e788(0x195),'warehouse_category':'Finished\x20Goods'});const _0x3b6138=await warehouse[_0x18e788(0x11f)]([{'$match':{'name':_0x36f700[_0x18e788(0x123)],'warehouse_category':_0x18e788(0x151)}},{'$unwind':_0x18e788(0x10b)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x18e788(0x16b)},'bin':{'$first':_0x18e788(0x154)},'type':{'$first':_0x18e788(0x18f)},'floorlevel':{'$first':_0x18e788(0x1c2)},'primary_code':{'$first':_0x18e788(0x176)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x18e788(0x11a)},'expiry_date':{'$first':_0x18e788(0x1aa)},'production_date':{'$first':_0x18e788(0x160)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x18e788(0x131)}}}]),_0x475d57=await product['find']({});if(_0x3c8e1c[0x0]['language']==_0x18e788(0x164)){var _0x1c1d51=users[_0x18e788(0x1ce)];console['log'](_0x1c1d51);}else{if(_0x3c8e1c[0x0]['language']==_0x18e788(0x1d5))var _0x1c1d51=users[_0x18e788(0x1d5)];else{if(_0x3c8e1c[0x0][_0x18e788(0x186)]==_0x18e788(0x1b0))var _0x1c1d51=users['German'];else{if(_0x3c8e1c[0x0][_0x18e788(0x186)]=='Spanish')var _0x1c1d51=users[_0x18e788(0x130)];else{if(_0x3c8e1c[0x0][_0x18e788(0x186)]==_0x18e788(0x14f))var _0x1c1d51=users[_0x18e788(0x14f)];else{if(_0x3c8e1c[0x0]['language']==_0x18e788(0x166))var _0x1c1d51=users[_0x18e788(0x1a5)];else{if(_0x3c8e1c[0x0]['language']==_0x18e788(0x107))var _0x1c1d51=users[_0x18e788(0x107)];else{if(_0x3c8e1c[0x0][_0x18e788(0x186)]==_0x18e788(0x1d6))var _0x1c1d51=users['Arabic'];}}}}}}}_0x180110[_0x18e788(0x133)](_0x18e788(0x1c1),{'success':_0x1fc739['flash'](_0x18e788(0x11e)),'errors':_0x1fc739['flash'](_0x18e788(0x14d)),'role':_0x5b9db8,'profile':_0x555599,'master_shop':_0x3c8e1c,'warehouse':_0x460d34,'transfer':_0x36f700,'stock':_0x3b6138,'unit':_0x475d57,'language':_0x1c1d51});}catch(_0x39578e){console[_0x18e788(0x153)](_0x39578e);}}),router[a0_0x46b412(0x1bc)](a0_0x46b412(0x109),auth,async(_0x10b225,_0x56dcef)=>{var _0x78c9bb=a0_0x46b412;try{const {invoice:_0x1001d2,from_warehouse:_0x4b44bb,FromRoom_name:_0x5c770d,to_warehouse:_0x9f1bc,ToRoom_name:_0x11a257}=_0x10b225[_0x78c9bb(0x1b9)],_0x861a1e=await transfers_finished['findById'](_0x10b225['params']['id']),_0x4c8bba=_0x861a1e[_0x78c9bb(0x10a)][_0x78c9bb(0x17b)](async _0x314fb9=>{var _0x4e0de8=_0x78c9bb;if(_0x314fb9[_0x4e0de8(0x139)]>0x0){var _0x376779=await warehouse['findOne']({'name':_0x4b44bb,'room':_0x314fb9[_0x4e0de8(0x19e)]});const _0x4fa3f1=_0x376779['product_details']['map'](_0x84bb79=>{var _0x53e067=_0x4e0de8;_0x84bb79['_id']==_0x314fb9[_0x53e067(0x18d)]&&(_0x84bb79['product_stock']=Math[_0x53e067(0x111)](0x0,Math[_0x53e067(0x11b)](_0x84bb79[_0x53e067(0x1a1)])-Math[_0x53e067(0x11b)](_0x314fb9['to_quantity'])),console[_0x53e067(0x153)](_0x84bb79[_0x53e067(0x1a1)]));});}return _0x376779;});Promise['all'](_0x4c8bba)[_0x78c9bb(0x1b3)](async _0x40f839=>{var _0x44e622=_0x78c9bb;try{for(const _0x321f5e of _0x40f839){await _0x321f5e[_0x44e622(0x1bb)]();}const _0x442d3a=_0x861a1e[_0x44e622(0x10a)][_0x44e622(0x17b)](async _0x2cc406=>{var _0x1317a6=_0x44e622,_0x138978=await warehouse[_0x1317a6(0x14e)]({'name':_0x9f1bc,'room':_0x2cc406[_0x1317a6(0x1b1)]});if(_0x2cc406[_0x1317a6(0x139)]>0x0){var _0x471863=0x0;const _0x4fcb58=_0x138978[_0x1317a6(0x15d)][_0x1317a6(0x17b)](_0x54f13f=>{var _0x39d3e9=_0x1317a6;_0x54f13f[_0x39d3e9(0x129)]==_0x2cc406[_0x39d3e9(0x129)]&&_0x54f13f['bay']==_0x2cc406[_0x39d3e9(0x17a)]&&_0x54f13f[_0x39d3e9(0x194)]==_0x2cc406[_0x39d3e9(0x194)]&&_0x54f13f[_0x39d3e9(0x1c3)]==_0x2cc406[_0x39d3e9(0x1c3)]&&_0x54f13f[_0x39d3e9(0x197)]==_0x2cc406[_0x39d3e9(0x197)]&&_0x54f13f[_0x39d3e9(0x196)]==_0x2cc406[_0x39d3e9(0x15f)]&&(typeof _0x2cc406[_0x39d3e9(0x18d)]==_0x39d3e9(0x1c5)?(console[_0x39d3e9(0x153)](_0x39d3e9(0x17d),_0x54f13f[_0x39d3e9(0x1a1)]+_0x39d3e9(0x183)+_0x54f13f[_0x39d3e9(0x1a4)]+_0x39d3e9(0x150)+Math[_0x39d3e9(0x11b)](_0x54f13f['product_stock'])+Math[_0x39d3e9(0x11b)](_0x2cc406[_0x39d3e9(0x139)])),_0x54f13f[_0x39d3e9(0x1a1)]=Math[_0x39d3e9(0x11b)](_0x54f13f[_0x39d3e9(0x1a1)])+Math[_0x39d3e9(0x11b)](_0x2cc406[_0x39d3e9(0x139)])):_0x54f13f[_0x39d3e9(0x1a1)]=Math[_0x39d3e9(0x11b)](_0x54f13f[_0x39d3e9(0x1a1)])+Math[_0x39d3e9(0x11b)](_0x2cc406[_0x39d3e9(0x139)]),_0x471863++);});_0x471863=='0'&&(_0x138978['product_details']=_0x138978[_0x1317a6(0x15d)][_0x1317a6(0x1c7)]({'product_name':_0x2cc406[_0x1317a6(0x129)],'product_stock':_0x2cc406[_0x1317a6(0x139)],'bay':_0x2cc406[_0x1317a6(0x17a)],'level':_0x2cc406[_0x1317a6(0x1a7)],'product_code':_0x2cc406['product_code'],'primary_code':_0x2cc406['primary_code'],'secondary_code':_0x2cc406[_0x1317a6(0x19a)],'expiry_date':_0x2cc406[_0x1317a6(0x194)],'production_date':_0x2cc406[_0x1317a6(0x1c3)],'maxProducts':_0x2cc406['maxProducts'],'batch_code':_0x2cc406['batch_code'],'secondary_unit':_0x2cc406[_0x1317a6(0x18b)],'unit':_0x2cc406['unit'],'maxProducts':_0x2cc406[_0x1317a6(0x13b)],'maxPerUnit':_0x2cc406[_0x1317a6(0x1bf)],'invoice':_0x2cc406['To_invoice']}));}return _0x138978;});Promise['all'](_0x442d3a)[_0x44e622(0x1b3)](async _0x45eed3=>{var _0x3fb33c=_0x44e622;try{console['log'](_0x861a1e['type_of_process']);if(_0x861a1e[_0x3fb33c(0x124)]!=_0x3fb33c(0x13c))for(const _0x341333 of _0x45eed3){await warehouse[_0x3fb33c(0x178)]({'_id':_0x341333[_0x3fb33c(0x1a4)]},{'$addToSet':{'product_details':{'$each':_0x341333[_0x3fb33c(0x15d)]}}});}_0x861a1e['finalize']=_0x3fb33c(0x1cb);const _0x3d0e16=await _0x861a1e['save'](),_0x4d563a=await master_shop[_0x3fb33c(0x12c)](),_0x509e6c=await email_settings[_0x3fb33c(0x14e)](),_0x1bbaf6=await supervisor_settings[_0x3fb33c(0x12c)]();var _0x35e206=_0x861a1e[_0x3fb33c(0x10a)],_0x441691='',_0x111bc5;for(_0x111bc5 in _0x35e206){var _0x2842f1='FG';_0x861a1e['to_warehouse']==_0x3fb33c(0x1b5)&&(_0x2842f1='DG'),_0x441691+=_0x3fb33c(0x1d7)+_0x3fb33c(0x137)+_0x35e206[_0x111bc5][_0x3fb33c(0x129)]+'</td>'+_0x3fb33c(0x137)+_0x35e206[_0x111bc5]['product_code']+_0x3fb33c(0x148)+_0x3fb33c(0x137)+_0x35e206[_0x111bc5][_0x3fb33c(0x139)]+_0x3fb33c(0x148)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x35e206[_0x111bc5][_0x3fb33c(0x161)]+_0x3fb33c(0x148)+_0x3fb33c(0x137)+_0x35e206[_0x111bc5]['secondary_unit']+_0x3fb33c(0x148)+_0x3fb33c(0x137)+_0x861a1e[_0x3fb33c(0x19f)]+_0x3fb33c(0x148)+_0x3fb33c(0x137)+_0x35e206[_0x111bc5]['to_room_name']+'</td>'+_0x3fb33c(0x137)+_0x2842f1+_0x35e206[_0x111bc5]['to_bay']+_0x3fb33c(0x148)+_0x3fb33c(0x173);}_0x10b225[_0x3fb33c(0x1a2)](_0x3fb33c(0x11e),_0x3fb33c(0x16f)),_0x56dcef[_0x3fb33c(0x11c)](_0x3fb33c(0x152)+_0x3d0e16['_id']);}catch(_0x5e70ac){console[_0x3fb33c(0x172)](_0x5e70ac),_0x56dcef[_0x3fb33c(0x125)](0x1f4)[_0x3fb33c(0x181)]({'error':_0x3fb33c(0x16c)});}})[_0x44e622(0x128)](_0x216ce3=>{var _0x24f28f=_0x44e622;console[_0x24f28f(0x172)](_0x216ce3),_0x56dcef[_0x24f28f(0x125)](0x1f4)[_0x24f28f(0x181)]({'error':'An\x20error\x20occurred.'});});}catch(_0x3e51c1){console['error'](_0x3e51c1),_0x56dcef[_0x44e622(0x125)](0x1f4)[_0x44e622(0x181)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x78c9bb(0x128)](_0x83022b=>{var _0x46063a=_0x78c9bb;console['error'](_0x83022b),_0x56dcef[_0x46063a(0x125)](0x1f4)[_0x46063a(0x181)]({'error':'An\x20error\x20occurred.'});});}catch(_0x441d3e){_0x56dcef[_0x78c9bb(0x181)]({'message':_0x441d3e[_0x78c9bb(0x199)]});}});function BayBinSelected(_0x1d1861,_0x1f22a9){var _0x397c60=a0_0x46b412,_0x14b520=[];let _0x56fee8=[];var _0x1689d8=[];if(_0x1d1861=='DRY\x20GOODS'){switch(_0x1f22a9){case _0x397c60(0x119):_0x14b520=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x397c60(0x1a8):_0x14b520=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x1689d8=['DG'];}else{if(_0x1d1861==_0x397c60(0x108)){switch(_0x1f22a9){case _0x397c60(0x119):_0x14b520=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x397c60(0x1a8):_0x14b520=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x1689d8=['FG'];}}return{'levels':_0x14b520,'identify':_0x1689d8};}router[a0_0x46b412(0x144)](a0_0x46b412(0x12f),auth,async(_0xb39c04,_0x52339a)=>{var _0x4baf9b=a0_0x46b412;try{const {username:_0x2cd7ea,email:_0x32ff48,role:_0x164559}=_0xb39c04[_0x4baf9b(0x18c)],_0x240728=_0xb39c04[_0x4baf9b(0x18c)],_0x34feea=await profile[_0x4baf9b(0x14e)]({'email':_0x240728[_0x4baf9b(0x134)]}),_0x16705f=await master_shop[_0x4baf9b(0x12c)](),_0x517e62=await transfers_finished['findById'](_0xb39c04['params']['id']);let _0x5cc347=new Date(_0x517e62[_0x4baf9b(0x194)]),_0xbd3912=('0'+_0x5cc347[_0x4baf9b(0x13e)]())[_0x4baf9b(0x1ca)](-0x2),_0x1b4247=('0'+(_0x5cc347['getMonth']()+0x1))[_0x4baf9b(0x1ca)](-0x2),_0x13c2de=_0x5cc347[_0x4baf9b(0x1b8)](),_0xa28545=_0x13c2de+'-'+_0x1b4247+'-'+_0xbd3912,_0x1e98e7;if(_0x240728[_0x4baf9b(0x121)]==_0x4baf9b(0x10f)){const _0x391843=await staff[_0x4baf9b(0x14e)]({'email':_0x240728['email']});_0x1e98e7=await warehouse[_0x4baf9b(0x12c)]({'status':_0x4baf9b(0x195),'name':_0x391843[_0x4baf9b(0x145)],'warehouse_category':'Finished\x20Goods'});}else _0x1e98e7=await warehouse['find']({'status':_0x4baf9b(0x195),'warehouse_category':_0x4baf9b(0x151)});const _0x17f744=await warehouse[_0x4baf9b(0x11f)]([{'$match':{'name':_0x517e62[_0x4baf9b(0x123)],'room':_0x517e62[_0x4baf9b(0x1d0)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4baf9b(0x14b),'name':{'$first':_0x4baf9b(0x13d)},'product_stock':{'$first':_0x4baf9b(0x1c8)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x4baf9b(0x154)},'type':{'$first':_0x4baf9b(0x18f)},'floorlevel':{'$first':_0x4baf9b(0x1c2)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4baf9b(0x18e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4baf9b(0x11a)}}}]);var _0x344cf1=[0x1,0x2,0x3,0x4],_0x2cd465=['A','B','C','D','E','F','G','H','I','J'],_0x38a954=['Ambient',_0x4baf9b(0x1af)];const _0x6d0e96=await product[_0x4baf9b(0x12c)]({}),_0x58a899=BayBinSelected(_0x517e62[_0x4baf9b(0x19f)],_0x517e62['to_room']);if(_0x16705f[0x0][_0x4baf9b(0x186)]==_0x4baf9b(0x164)){var _0x48b82c=users[_0x4baf9b(0x1ce)];console[_0x4baf9b(0x153)](_0x48b82c);}else{if(_0x16705f[0x0][_0x4baf9b(0x186)]==_0x4baf9b(0x1d5))var _0x48b82c=users[_0x4baf9b(0x1d5)];else{if(_0x16705f[0x0][_0x4baf9b(0x186)]==_0x4baf9b(0x1b0))var _0x48b82c=users[_0x4baf9b(0x1b0)];else{if(_0x16705f[0x0][_0x4baf9b(0x186)]=='Spanish')var _0x48b82c=users['Spanish'];else{if(_0x16705f[0x0]['language']=='French')var _0x48b82c=users[_0x4baf9b(0x14f)];else{if(_0x16705f[0x0][_0x4baf9b(0x186)]==_0x4baf9b(0x166))var _0x48b82c=users[_0x4baf9b(0x1a5)];else{if(_0x16705f[0x0][_0x4baf9b(0x186)]==_0x4baf9b(0x107))var _0x48b82c=users[_0x4baf9b(0x107)];else{if(_0x16705f[0x0][_0x4baf9b(0x186)]==_0x4baf9b(0x1d6))var _0x48b82c=users[_0x4baf9b(0x135)];}}}}}}}_0x52339a['render'](_0x4baf9b(0x1ba),{'success':_0xb39c04['flash'](_0x4baf9b(0x11e)),'errors':_0xb39c04[_0x4baf9b(0x1a2)]('errors'),'role':_0x240728,'profile':_0x34feea,'master_shop':_0x16705f,'warehouse':_0x1e98e7,'transfer':_0x517e62,'stock':_0x17f744,'unit':_0x6d0e96,'language':_0x48b82c,'levels':_0x344cf1,'Isle':_0x2cd465,'rooms_data':_0x38a954,'ed_fullDate':_0xa28545,'dataSelected':_0x58a899});}catch(_0x5d523d){console['log'](_0x5d523d);}}),router[a0_0x46b412(0x1bc)](a0_0x46b412(0x12f),auth,async(_0x5ef4b2,_0x398464)=>{var _0x53b52b=a0_0x46b412;try{const _0x179cdd=_0x5ef4b2[_0x53b52b(0x169)]['id'];console[_0x53b52b(0x153)](_0x5ef4b2[_0x53b52b(0x1b9)]);const _0x1b1242=await transfers_finished[_0x53b52b(0x1ae)](_0x179cdd);console[_0x53b52b(0x153)](_0x53b52b(0x1a3),_0x1b1242);const {date:_0x1f3d42,from_warehouse:_0x2cbd25,FromRoom_name:_0x388816,to_warehouse:_0x8be279,ToRoom_name:_0x7ab5e4,prod_name:_0x220d2d,from_prod_qty:_0xccef5b,from_prod_level:_0x29ba0a,from_prod_isle:_0x3692c6,from_prod_pallet:_0x4d53f9,to_prod_qty:_0x33a7ff,to_prod_level:_0x13b649,to_prod_isle:_0x17883a,to_prod_pallet:_0x20eb48,primary_code:_0x391e1d,secondary_code:_0x545f87,product_code3:_0x31334c,note:_0x2275ff,invoice:_0x2f2496,expiry_date:_0x17bf87}=_0x5ef4b2[_0x53b52b(0x1b9)];if(typeof _0x220d2d==_0x53b52b(0x189))var _0x203d44=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x132)]],_0x3e1368=[_0x5ef4b2[_0x53b52b(0x1b9)]['from_prod_qty']],_0x53fb63=[_0x5ef4b2['body'][_0x53b52b(0x1b6)]],_0x4c7288=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x193)]],_0xe4be0=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x1b7)]],_0x5e6c5b=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x182)]],_0xfd2e53=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x19a)]],_0xfcb0a3=[_0x5ef4b2['body'][_0x53b52b(0x171)]],_0x1a2939=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x185)]],_0xcb1e46=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x161)]],_0x1ea852=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x18b)]],_0x472216=[_0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x197)]],_0x1cc237=[_0x5ef4b2['body'][_0x53b52b(0x194)]];else var _0x203d44=[..._0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x132)]],_0x3e1368=[..._0x5ef4b2['body']['from_prod_qty']],_0x53fb63=[..._0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x1b6)]],_0x4c7288=[..._0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x193)]],_0xe4be0=[..._0x5ef4b2['body']['to_prod_level']],_0x5e6c5b=[..._0x5ef4b2[_0x53b52b(0x1b9)]['primary_code']],_0xfd2e53=[..._0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x19a)]],_0xfcb0a3=[..._0x5ef4b2[_0x53b52b(0x1b9)]['product_code3']],_0x1a2939=[..._0x5ef4b2['body'][_0x53b52b(0x185)]],_0xcb1e46=[..._0x5ef4b2[_0x53b52b(0x1b9)]['unit']],_0x1ea852=[..._0x5ef4b2[_0x53b52b(0x1b9)][_0x53b52b(0x18b)]],_0x472216=[..._0x5ef4b2['body'][_0x53b52b(0x197)]],_0x1cc237=[..._0x5ef4b2[_0x53b52b(0x1b9)]['expiry_date']];const _0x2cb471=_0x203d44[_0x53b52b(0x17b)](_0x1a2c3d=>{return _0x1a2c3d={'product_name':_0x1a2c3d};});_0x3e1368[_0x53b52b(0x16a)]((_0x33fa6f,_0x460e6b)=>{_0x2cb471[_0x460e6b]['from_quantity']=_0x33fa6f;}),_0x53fb63[_0x53b52b(0x16a)]((_0x491a35,_0x4693c0)=>{var _0x3c728e=_0x53b52b;_0x2cb471[_0x4693c0][_0x3c728e(0x15e)]=_0x491a35;}),_0x4c7288[_0x53b52b(0x16a)]((_0x4d13be,_0x2eec6e)=>{_0x2cb471[_0x2eec6e]['to_quantity']=_0x4d13be;}),_0xe4be0[_0x53b52b(0x16a)]((_0x4dfca4,_0x5a216f)=>{_0x2cb471[_0x5a216f]['to_bay']=_0x4dfca4;}),_0x5e6c5b[_0x53b52b(0x16a)]((_0x35ebf1,_0x34c10c)=>{_0x2cb471[_0x34c10c]['primary_code']=_0x35ebf1;}),_0xfd2e53[_0x53b52b(0x16a)]((_0x538803,_0x1ec4d9)=>{var _0x11ebf7=_0x53b52b;_0x2cb471[_0x1ec4d9][_0x11ebf7(0x19a)]=_0x538803;}),_0xfcb0a3[_0x53b52b(0x16a)]((_0xc122b4,_0x42ae21)=>{_0x2cb471[_0x42ae21]['product_code']=_0xc122b4;}),_0x1a2939[_0x53b52b(0x16a)]((_0x244310,_0x281a4c)=>{var _0x81bd96=_0x53b52b;_0x2cb471[_0x281a4c][_0x81bd96(0x13b)]=_0x244310;}),_0xcb1e46['forEach']((_0x34cfab,_0x1807d9)=>{var _0x2b38f8=_0x53b52b;_0x2cb471[_0x1807d9][_0x2b38f8(0x161)]=_0x34cfab;}),_0x1ea852[_0x53b52b(0x16a)]((_0x17f08f,_0x3fa4fa)=>{var _0x505cc7=_0x53b52b;_0x2cb471[_0x3fa4fa][_0x505cc7(0x18b)]=_0x17f08f;}),_0x472216[_0x53b52b(0x16a)]((_0xc4d84a,_0x5024a3)=>{var _0x5e6159=_0x53b52b;_0x2cb471[_0x5024a3][_0x5e6159(0x197)]=_0xc4d84a;}),_0x1cc237[_0x53b52b(0x16a)]((_0x85f24c,_0x44d129)=>{var _0x3e4779=_0x53b52b;_0x2cb471[_0x44d129][_0x3e4779(0x194)]=_0x85f24c;});const _0x25b612=_0x2cb471[_0x53b52b(0x112)](_0x5a5175=>_0x5a5175[_0x53b52b(0x139)]!=='0'&&_0x5a5175['to_quantity']!==''||_0x5a5175['to_floorlevel']!=='0'&&_0x5a5175[_0x53b52b(0x1c4)]!=='');var _0x35f277=0x0;_0x25b612[_0x53b52b(0x16a)](_0xc9351e=>{parseInt(_0xc9351e['from_quantity'])<parseInt(_0xc9351e['to_quantity'])&&_0x35f277++;});if(_0x35f277!=0x0)return _0x5ef4b2[_0x53b52b(0x1a2)](_0x53b52b(0x14d),_0x53b52b(0x15a)),_0x398464[_0x53b52b(0x11c)](_0x53b52b(0x11d));const _0xa3bd04=await warehouse[_0x53b52b(0x14e)]({'name':_0x1b1242[_0x53b52b(0x123)],'room':_0x1b1242[_0x53b52b(0x1d0)]});_0x1b1242[_0x53b52b(0x10a)][_0x53b52b(0x16a)](_0xad6d40=>{var _0x301206=_0x53b52b;if(_0xad6d40[_0x301206(0x139)]>0x0){const _0x52e1d0=_0xa3bd04['product_details'][_0x301206(0x17b)](_0x39ab5f=>{var _0x2804ae=_0x301206;_0x39ab5f[_0x2804ae(0x129)]==_0xad6d40[_0x2804ae(0x129)]&&_0x39ab5f[_0x2804ae(0x158)]==_0xad6d40['from_bay']&&(_0x39ab5f['product_stock']=parseInt(_0x39ab5f[_0x2804ae(0x1a1)])+parseInt(_0xad6d40['to_quantity']));});}}),await _0xa3bd04[_0x53b52b(0x1bb)]();const _0x6efd3d=await warehouse[_0x53b52b(0x14e)]({'name':_0x1b1242[_0x53b52b(0x19f)],'room':_0x1b1242[_0x53b52b(0x1a6)]});_0x1b1242['product'][_0x53b52b(0x16a)](_0x18fbe7=>{var _0x46b99a=_0x53b52b;if(_0x18fbe7[_0x46b99a(0x139)]>0x0){const _0x5c5dde=_0x6efd3d[_0x46b99a(0x15d)][_0x46b99a(0x17b)](_0x7e12ae=>{var _0x4f4d2f=_0x46b99a;_0x7e12ae[_0x4f4d2f(0x129)]==_0x18fbe7[_0x4f4d2f(0x129)]&&_0x7e12ae['bay']==_0x18fbe7[_0x4f4d2f(0x17a)]&&(_0x7e12ae[_0x4f4d2f(0x1a1)]=parseInt(_0x7e12ae[_0x4f4d2f(0x1a1)])-parseInt(_0x18fbe7[_0x4f4d2f(0x139)]));});}}),await _0x6efd3d['save'](),_0x1b1242[_0x53b52b(0x149)]=_0x1f3d42,_0x1b1242['from_warehouse']=_0x2cbd25,_0x1b1242[_0x53b52b(0x19f)]=_0x8be279,_0x1b1242[_0x53b52b(0x10a)]=_0x25b612,_0x1b1242[_0x53b52b(0x114)]=_0x2275ff,_0x1b1242['invoice']=_0x2f2496;const _0x1d8b3d=await _0x1b1242[_0x53b52b(0x1bb)](),_0x883a36=await warehouse['findOne']({'name':_0x2cbd25,'room':_0x388816});_0x1d8b3d[_0x53b52b(0x10a)][_0x53b52b(0x16a)](_0x3dce44=>{var _0x272a1c=_0x53b52b;if(_0x3dce44[_0x272a1c(0x139)]>0x0){const _0x6d1c62=_0x883a36['product_details']['map'](_0x3350e8=>{var _0x152cc9=_0x272a1c;_0x3350e8['product_name']==_0x3dce44[_0x152cc9(0x129)]&&_0x3350e8[_0x152cc9(0x158)]==_0x3dce44['from_bay']&&(_0x3350e8[_0x152cc9(0x1a1)]=parseInt(_0x3350e8[_0x152cc9(0x1a1)])-parseInt(_0x3dce44[_0x152cc9(0x139)]));});}}),await _0x883a36[_0x53b52b(0x1bb)]();const _0x33728e=await warehouse['findOne']({'name':_0x8be279,'room':_0x7ab5e4});_0x1d8b3d[_0x53b52b(0x10a)]['forEach'](_0x391923=>{var _0x1a7620=_0x53b52b;if(_0x391923[_0x1a7620(0x139)]>0x0){var _0x53bbef=0x0;const _0x2f0343=_0x33728e[_0x1a7620(0x15d)][_0x1a7620(0x17b)](_0x45b7f5=>{var _0x325d6f=_0x1a7620;_0x45b7f5[_0x325d6f(0x129)]==_0x391923[_0x325d6f(0x129)]&&_0x45b7f5[_0x325d6f(0x158)]==_0x391923[_0x325d6f(0x17a)]&&(_0x45b7f5['product_stock']=parseInt(_0x45b7f5[_0x325d6f(0x1a1)])+parseInt(_0x391923[_0x325d6f(0x139)]),_0x53bbef++);});_0x53bbef=='0'&&(_0x33728e[_0x1a7620(0x15d)]=_0x33728e[_0x1a7620(0x15d)][_0x1a7620(0x1c7)]({'product_name':_0x391923[_0x1a7620(0x129)],'product_stock':_0x391923[_0x1a7620(0x139)],'bay':_0x391923[_0x1a7620(0x17a)],'product_code':_0x391923['product_code'],'primary_code':_0x391923[_0x1a7620(0x182)],'secondary_code':_0x391923[_0x1a7620(0x19a)],'maxProducts':_0x391923[_0x1a7620(0x13b)]}));}}),await _0x33728e[_0x53b52b(0x1bb)](),_0x5ef4b2[_0x53b52b(0x1a2)](_0x53b52b(0x11e),_0x53b52b(0x115)),_0x398464['redirect']('/transfer_finished/view');}catch(_0x731c12){console[_0x53b52b(0x153)](_0x731c12);}}),router[a0_0x46b412(0x1bc)](a0_0x46b412(0x12d),async(_0x3bcde8,_0x3dc45e)=>{var _0x1521a3=a0_0x46b412;const {FromWareHouse:_0xe4f8b1,FromRoom:_0x3ebb8c,ToWarehouse:_0x14e46b,ToRoom:_0x43913d,primary_code:_0x51c12b,Roomslist:_0x2e81c9}=_0x3bcde8['body'],_0x1730a7=_0x2e81c9[_0x1521a3(0x13a)](','),_0x5a5fb4=[];async function _0x347e13(_0x2cc587){var _0x4f5f08=_0x1521a3;const _0x4bce27=await warehouse[_0x4f5f08(0x11f)]([{'$match':{'name':_0xe4f8b1,'room':_0x2cc587}},{'$unwind':_0x4f5f08(0x10b)},{'$match':{'product_details.primary_code':_0x51c12b}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4f5f08(0x13d)},'instock':{'$first':_0x4f5f08(0x1c8)},'primary_code':{'$first':_0x4f5f08(0x176)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x4f5f08(0x16b)},'level':{'$first':_0x4f5f08(0x19b)},'type':{'$first':_0x4f5f08(0x18f)},'pallet':{'$first':_0x4f5f08(0x1c2)},'unit':{'$first':_0x4f5f08(0x1cc)},'secondary_unit':{'$first':_0x4f5f08(0x12b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4f5f08(0x160)},'batch_code':{'$first':_0x4f5f08(0x1be)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x4f5f08(0x12e)},'prod_cat':{'$first':'P'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x125e81=await warehouse[_0x4f5f08(0x11f)]([{'$match':{'name':_0xe4f8b1,'room':_0x2cc587}},{'$unwind':_0x4f5f08(0x10b)},{'$match':{'product_details.secondary_code':_0x51c12b}},{'$group':{'_id':_0x4f5f08(0x14b),'name':{'$first':_0x4f5f08(0x13d)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x4f5f08(0x176)},'secondary_code':{'$first':_0x4f5f08(0x18e)},'product_code':{'$first':_0x4f5f08(0x180)},'bay':{'$first':_0x4f5f08(0x16b)},'level':{'$first':_0x4f5f08(0x19b)},'type':{'$first':_0x4f5f08(0x18f)},'pallet':{'$first':_0x4f5f08(0x1c2)},'unit':{'$first':_0x4f5f08(0x1cc)},'secondary_unit':{'$first':_0x4f5f08(0x12b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4f5f08(0x11a)},'expiry_date':{'$first':_0x4f5f08(0x1aa)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4f5f08(0x1be)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x4f5f08(0x12e)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x4f5f08(0x1c9)}}}]);if(_0x4bce27[_0x4f5f08(0x147)]>0x0)_0x5a5fb4[_0x4f5f08(0x1cd)](_0x4bce27);else _0x125e81[_0x4f5f08(0x147)]>0x0&&_0x5a5fb4[_0x4f5f08(0x1cd)](_0x125e81);}const _0x176a4f=_0x1730a7[_0x1521a3(0x17b)](_0x553aa5=>_0x347e13(_0x553aa5));await Promise[_0x1521a3(0x127)](_0x176a4f),_0x3dc45e[_0x1521a3(0x181)](_0x5a5fb4);}),router[a0_0x46b412(0x1bc)](a0_0x46b412(0x177),async(_0x1c1e8e,_0x4d59de)=>{var _0x3502f8=a0_0x46b412;const {productCode:_0x5d1922,bay:_0x669130,warehouses:_0x550292,room:_0x335a06}=_0x1c1e8e[_0x3502f8(0x1b9)];console[_0x3502f8(0x153)](_0x1c1e8e['body']);try{const _0x56f6d9=await warehouse[_0x3502f8(0x11f)]([{'$match':{'name':_0x550292,'room':_0x335a06}},{'$unwind':_0x3502f8(0x10b)},{'$match':{'product_details.bay':parseInt(_0x669130)}},{'$group':{'_id':_0x3502f8(0x14b),'name':{'$first':_0x3502f8(0x13d)},'product_stock':{'$first':_0x3502f8(0x1c8)},'bay':{'$first':_0x3502f8(0x16b)},'maxProducts':{'$first':_0x3502f8(0x1c6)}}}]);_0x4d59de['status'](0xc8)['json'](_0x56f6d9);}catch(_0x421397){_0x4d59de[_0x3502f8(0x125)](0x194)[_0x3502f8(0x181)]({'message':_0x421397['message']});}}),module['exports']=router;