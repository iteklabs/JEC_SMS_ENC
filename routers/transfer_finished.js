var a0_0x49b316=a0_0x590d;(function(_0x5a0fd4,_0x537552){var _0x5a3eff=a0_0x590d,_0x3537c5=_0x5a0fd4();while(!![]){try{var _0x306a5d=-parseInt(_0x5a3eff(0x22f))/0x1+-parseInt(_0x5a3eff(0x1e1))/0x2*(-parseInt(_0x5a3eff(0x245))/0x3)+parseInt(_0x5a3eff(0x21e))/0x4*(-parseInt(_0x5a3eff(0x25c))/0x5)+parseInt(_0x5a3eff(0x251))/0x6*(-parseInt(_0x5a3eff(0x25f))/0x7)+-parseInt(_0x5a3eff(0x25e))/0x8*(-parseInt(_0x5a3eff(0x221))/0x9)+-parseInt(_0x5a3eff(0x247))/0xa+parseInt(_0x5a3eff(0x219))/0xb;if(_0x306a5d===_0x537552)break;else _0x3537c5['push'](_0x3537c5['shift']());}catch(_0x2b9079){_0x3537c5['push'](_0x3537c5['shift']());}}}(a0_0xf332,0xa5159));const express=require('express'),app=express(),router=express[a0_0x49b316(0x23b)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x49b316(0x243)),auth=require(a0_0x49b316(0x1ef)),users=require(a0_0x49b316(0x236)),nodemailer=require(a0_0x49b316(0x20e));function a0_0x590d(_0x27a068,_0x535a32){var _0xf33220=a0_0xf332();return a0_0x590d=function(_0x590d35,_0x3c2109){_0x590d35=_0x590d35-0x1a2;var _0x488ecc=_0xf33220[_0x590d35];return _0x488ecc;},a0_0x590d(_0x27a068,_0x535a32);}router['get'](a0_0x49b316(0x1f9),auth,async(_0x10909d,_0x106016)=>{var _0x1b6943=a0_0x49b316;try{const {username:_0xe3c58a,email:_0x473aee,role:_0x21a940}=_0x10909d[_0x1b6943(0x229)],_0x5793d0=_0x10909d['user'],_0x482686=await profile[_0x1b6943(0x1d9)]({'email':_0x5793d0[_0x1b6943(0x1d1)]}),_0x236e9b=await master_shop['find']();let _0x355062;if(_0x5793d0[_0x1b6943(0x1c6)]==_0x1b6943(0x202)){const _0x426cbc=await staff['findOne']({'email':_0x5793d0['email']});_0x355062=await transfers_finished[_0x1b6943(0x1fb)]({'from_warehouse':_0x426cbc['warehouse']});}else _0x355062=await transfers_finished[_0x1b6943(0x1bf)]([{'$match':{'type_of_transaction':_0x1b6943(0x260)}},{'$unwind':_0x1b6943(0x220)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x1b6943(0x258)},'from_warehouse':{'$first':_0x1b6943(0x237)},'to_warehouse':{'$first':_0x1b6943(0x246)},'from_room_name':{'$addToSet':_0x1b6943(0x21c)},'to_room_name':{'$addToSet':_0x1b6943(0x262)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x236e9b[0x0][_0x1b6943(0x201)]=='English\x20(US)')var _0xa66824=users[_0x1b6943(0x242)];else{if(_0x236e9b[0x0][_0x1b6943(0x201)]==_0x1b6943(0x1fc))var _0xa66824=users[_0x1b6943(0x1fc)];else{if(_0x236e9b[0x0][_0x1b6943(0x201)]==_0x1b6943(0x1b8))var _0xa66824=users[_0x1b6943(0x1b8)];else{if(_0x236e9b[0x0][_0x1b6943(0x201)]=='Spanish')var _0xa66824=users[_0x1b6943(0x1b3)];else{if(_0x236e9b[0x0]['language']==_0x1b6943(0x1b9))var _0xa66824=users[_0x1b6943(0x1b9)];else{if(_0x236e9b[0x0][_0x1b6943(0x201)]==_0x1b6943(0x232))var _0xa66824=users[_0x1b6943(0x22d)];else{if(_0x236e9b[0x0]['language']==_0x1b6943(0x25a))var _0xa66824=users['Chinese'];else{if(_0x236e9b[0x0][_0x1b6943(0x201)]==_0x1b6943(0x22c))var _0xa66824=users[_0x1b6943(0x24b)];}}}}}}}_0x106016[_0x1b6943(0x1aa)]('transfer_finished',{'success':_0x10909d[_0x1b6943(0x268)](_0x1b6943(0x1b2)),'errors':_0x10909d[_0x1b6943(0x268)]('errors'),'role':_0x5793d0,'profile':_0x482686,'master_shop':_0x236e9b,'transfer':_0x355062,'language':_0xa66824});}catch(_0x344db6){console[_0x1b6943(0x1d5)](_0x344db6);}}),router['get']('/view_logs',auth,async(_0x5488d4,_0x5d75f2)=>{var _0x39b997=a0_0x49b316;try{const {username:_0x483504,email:_0x15ccb3,role:_0x8ecbc2}=_0x5488d4[_0x39b997(0x229)],_0x3923e6=_0x5488d4[_0x39b997(0x229)],_0x1ad31d=await profile['findOne']({'email':_0x3923e6[_0x39b997(0x1d1)]}),_0x1f8bce=await master_shop[_0x39b997(0x1fb)]();let _0x22ca84;if(_0x3923e6[_0x39b997(0x1c6)]=='staff'){const _0x17ba8f=await staff['findOne']({'email':_0x3923e6[_0x39b997(0x1d1)]});_0x22ca84=await transfers_finished[_0x39b997(0x1fb)]({'from_warehouse':_0x17ba8f[_0x39b997(0x25d)]});}else _0x22ca84=await transfers_finished[_0x39b997(0x1bf)]([{'$match':{'type_of_transaction':_0x39b997(0x1ad)}},{'$unwind':_0x39b997(0x220)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x39b997(0x258)},'from_warehouse':{'$first':_0x39b997(0x237)},'to_warehouse':{'$first':_0x39b997(0x246)},'from_room_name':{'$addToSet':_0x39b997(0x21c)},'to_room_name':{'$addToSet':_0x39b997(0x262)},'finalize':{'$first':_0x39b997(0x1bb)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x1f8bce[0x0]['language']==_0x39b997(0x1f3))var _0x14a6a9=users[_0x39b997(0x242)];else{if(_0x1f8bce[0x0]['language']==_0x39b997(0x1fc))var _0x14a6a9=users[_0x39b997(0x1fc)];else{if(_0x1f8bce[0x0][_0x39b997(0x201)]==_0x39b997(0x1b8))var _0x14a6a9=users[_0x39b997(0x1b8)];else{if(_0x1f8bce[0x0]['language']=='Spanish')var _0x14a6a9=users[_0x39b997(0x1b3)];else{if(_0x1f8bce[0x0][_0x39b997(0x201)]==_0x39b997(0x1b9))var _0x14a6a9=users['French'];else{if(_0x1f8bce[0x0]['language']==_0x39b997(0x232))var _0x14a6a9=users[_0x39b997(0x22d)];else{if(_0x1f8bce[0x0][_0x39b997(0x201)]==_0x39b997(0x25a))var _0x14a6a9=users[_0x39b997(0x25a)];else{if(_0x1f8bce[0x0][_0x39b997(0x201)]==_0x39b997(0x22c))var _0x14a6a9=users[_0x39b997(0x24b)];}}}}}}}_0x5d75f2[_0x39b997(0x1aa)](_0x39b997(0x264),{'success':_0x5488d4['flash'](_0x39b997(0x1b2)),'errors':_0x5488d4[_0x39b997(0x268)](_0x39b997(0x1a4)),'role':_0x3923e6,'profile':_0x1ad31d,'master_shop':_0x1f8bce,'transfer':_0x22ca84,'language':_0x14a6a9});}catch(_0x1bdf7d){console[_0x39b997(0x1d5)](_0x1bdf7d);}});async function getRandom8DigitNumber(){var _0x80c124=a0_0x49b316;const _0x46cf5b=0x989680,_0x420ffd=0x5f5e0ff,_0x5f4cec=Math[_0x80c124(0x1d8)](Math[_0x80c124(0x1c4)]()*(_0x420ffd-_0x46cf5b+0x1))+_0x46cf5b;var _0x75b0cd;const _0x52c9e6=await transfers_finished[_0x80c124(0x1d9)]({'invoice':'TRFF-'+_0x5f4cec});return _0x52c9e6&&_0x52c9e6[_0x80c124(0x233)]>0x0?_0x75b0cd='TRFF-'+_0x5f4cec:_0x75b0cd=_0x80c124(0x1ac)+_0x5f4cec,_0x75b0cd;}router[a0_0x49b316(0x20c)](a0_0x49b316(0x1e7),auth,async(_0x3c52ef,_0xb12518)=>{var _0x44d51a=a0_0x49b316;try{const {username:_0x4381ee,email:_0x5c7404,role:_0x2cdfc7}=_0x3c52ef['user'],_0x3c2a91=_0x3c52ef['user'],_0x10d76a=await profile[_0x44d51a(0x1d9)]({'email':_0x3c2a91[_0x44d51a(0x1d1)]}),_0x18412d=await master_shop[_0x44d51a(0x1fb)]();let _0x2125de;if(_0x3c2a91[_0x44d51a(0x1c6)]==_0x44d51a(0x202)){const _0x565f03=await staff['findOne']({'email':_0x3c2a91[_0x44d51a(0x1d1)]});_0x2125de=await warehouse[_0x44d51a(0x1bf)]([{'$match':{'status':_0x44d51a(0x1ff),'name':_0x565f03['warehouse']}},{'$group':{'_id':_0x44d51a(0x1ca),'name':{'$first':_0x44d51a(0x1ca)}}}]);}else _0x2125de=await warehouse['aggregate']([{'$match':{'status':_0x44d51a(0x1ff)}},{'$group':{'_id':'$name','name':{'$first':_0x44d51a(0x1ca)}}}]);const _0x18904e=await transfers_finished[_0x44d51a(0x1fb)]({}),_0x48880c=_0x18904e[_0x44d51a(0x233)]+0x1,_0x575b98=_0x44d51a(0x1ac)+_0x48880c['toString']()[_0x44d51a(0x1f1)](0x5,'0');if(_0x18412d[0x0]['language']==_0x44d51a(0x1f3))var _0xcd6115=users[_0x44d51a(0x242)];else{if(_0x18412d[0x0][_0x44d51a(0x201)]==_0x44d51a(0x1fc))var _0xcd6115=users[_0x44d51a(0x1fc)];else{if(_0x18412d[0x0][_0x44d51a(0x201)]=='German')var _0xcd6115=users['German'];else{if(_0x18412d[0x0][_0x44d51a(0x201)]==_0x44d51a(0x1b3))var _0xcd6115=users[_0x44d51a(0x1b3)];else{if(_0x18412d[0x0][_0x44d51a(0x201)]==_0x44d51a(0x1b9))var _0xcd6115=users[_0x44d51a(0x1b9)];else{if(_0x18412d[0x0][_0x44d51a(0x201)]=='Portuguese\x20(BR)')var _0xcd6115=users['Portuguese'];else{if(_0x18412d[0x0][_0x44d51a(0x201)]==_0x44d51a(0x25a))var _0xcd6115=users[_0x44d51a(0x25a)];else{if(_0x18412d[0x0][_0x44d51a(0x201)]==_0x44d51a(0x22c))var _0xcd6115=users['Arabic'];}}}}}}}const _0x5befac=getRandom8DigitNumber();_0x5befac[_0x44d51a(0x1e8)](_0x5744c8=>{var _0x106cf2=_0x44d51a;_0xb12518[_0x106cf2(0x1aa)]('add_transfer_finished',{'success':_0x3c52ef['flash'](_0x106cf2(0x1b2)),'errors':_0x3c52ef['flash'](_0x106cf2(0x1a4)),'role':_0x3c2a91,'profile':_0x10d76a,'master_shop':_0x18412d,'warehouse':_0x2125de,'language':_0xcd6115,'invoice':_0x5744c8});})[_0x44d51a(0x256)](_0x3cad43=>{var _0x24fe8e=_0x44d51a;_0x3c52ef[_0x24fe8e(0x268)](_0x24fe8e(0x1a4),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0xb12518['redirect']('/transfer/view');});}catch(_0x322f15){console['log'](_0x322f15);}}),router[a0_0x49b316(0x20c)](a0_0x49b316(0x261),auth,async(_0x19a1ad,_0x3742ab)=>{var _0x4d91ee=a0_0x49b316;try{const {username:_0x1ef06e,email:_0x414393,role:_0x50344f}=_0x19a1ad[_0x4d91ee(0x229)],_0x21b6be=_0x19a1ad['user'],_0x44260b=await profile['findOne']({'email':_0x21b6be[_0x4d91ee(0x1d1)]}),_0x409140=await master_shop[_0x4d91ee(0x1fb)]();let _0x3bbc7b;if(_0x21b6be['role']=='staff'){const _0x18055c=await staff[_0x4d91ee(0x1d9)]({'email':_0x21b6be['email']});_0x3bbc7b=await warehouse[_0x4d91ee(0x1bf)]([{'$match':{'status':_0x4d91ee(0x1ff),'name':_0x18055c[_0x4d91ee(0x25d)]}},{'$group':{'_id':_0x4d91ee(0x1ca),'name':{'$first':_0x4d91ee(0x1ca)}}}]);}else _0x3bbc7b=await warehouse[_0x4d91ee(0x1bf)]([{'$match':{'status':_0x4d91ee(0x1ff)}},{'$group':{'_id':_0x4d91ee(0x1ca),'name':{'$first':_0x4d91ee(0x1ca)}}}]);const _0x48ed21=await transfers_finished['find']({}),_0x2b123b=_0x48ed21[_0x4d91ee(0x233)]+0x1,_0x453124=_0x4d91ee(0x1ac)+_0x2b123b[_0x4d91ee(0x263)]()['padStart'](0x5,'0');if(_0x409140[0x0][_0x4d91ee(0x201)]==_0x4d91ee(0x1f3))var _0x23d0d9=users['English'];else{if(_0x409140[0x0]['language']==_0x4d91ee(0x1fc))var _0x23d0d9=users[_0x4d91ee(0x1fc)];else{if(_0x409140[0x0][_0x4d91ee(0x201)]==_0x4d91ee(0x1b8))var _0x23d0d9=users['German'];else{if(_0x409140[0x0][_0x4d91ee(0x201)]=='Spanish')var _0x23d0d9=users[_0x4d91ee(0x1b3)];else{if(_0x409140[0x0]['language']==_0x4d91ee(0x1b9))var _0x23d0d9=users['French'];else{if(_0x409140[0x0][_0x4d91ee(0x201)]==_0x4d91ee(0x232))var _0x23d0d9=users[_0x4d91ee(0x22d)];else{if(_0x409140[0x0][_0x4d91ee(0x201)]==_0x4d91ee(0x25a))var _0x23d0d9=users[_0x4d91ee(0x25a)];else{if(_0x409140[0x0][_0x4d91ee(0x201)]=='Arabic\x20(ae)')var _0x23d0d9=users[_0x4d91ee(0x24b)];}}}}}}}const _0x50ccbf=getRandom8DigitNumber();_0x50ccbf[_0x4d91ee(0x1e8)](_0x2f7d0c=>{var _0x1c6336=_0x4d91ee;_0x3742ab[_0x1c6336(0x1aa)](_0x1c6336(0x23f),{'success':_0x19a1ad[_0x1c6336(0x268)](_0x1c6336(0x1b2)),'errors':_0x19a1ad[_0x1c6336(0x268)](_0x1c6336(0x1a4)),'role':_0x21b6be,'profile':_0x44260b,'master_shop':_0x409140,'warehouse':_0x3bbc7b,'language':_0x23d0d9,'invoice':_0x2f7d0c});})['catch'](_0x3d9073=>{var _0x30fdb4=_0x4d91ee;_0x19a1ad[_0x30fdb4(0x268)](_0x30fdb4(0x1a4),_0x30fdb4(0x1d6)),_0x3742ab[_0x30fdb4(0x227)]('/transfer/view');});}catch(_0x31f03c){console['log'](_0x31f03c);}}),router[a0_0x49b316(0x20c)](a0_0x49b316(0x1da),auth,async(_0x3bb065,_0x2a5f7d)=>{var _0xda6b02=a0_0x49b316;try{const {username:_0x3838b7,email:_0x52e536,role:_0x3f4941}=_0x3bb065[_0xda6b02(0x229)],_0x431e11=_0x3bb065[_0xda6b02(0x229)],_0x5495c5=await profile[_0xda6b02(0x1d9)]({'email':_0x431e11[_0xda6b02(0x1d1)]}),_0x5cb2e1=await master_shop['find']();let _0x62e724;if(_0x431e11[_0xda6b02(0x1c6)]=='staff'){const _0x3365b7=await staff[_0xda6b02(0x1d9)]({'email':_0x431e11['email']});_0x62e724=await warehouse['aggregate']([{'$match':{'status':_0xda6b02(0x1ff),'name':_0x3365b7[_0xda6b02(0x25d)]}},{'$group':{'_id':_0xda6b02(0x1ca),'name':{'$first':_0xda6b02(0x1ca)}}}]);}else _0x62e724=await warehouse[_0xda6b02(0x1bf)]([{'$match':{'status':_0xda6b02(0x1ff)}},{'$group':{'_id':_0xda6b02(0x1ca),'name':{'$first':_0xda6b02(0x1ca)}}}]);const _0x3602e2=await transfers_finished[_0xda6b02(0x1fb)]({}),_0x1ecb2d=_0x3602e2['length']+0x1,_0x24eea8=_0xda6b02(0x1ac)+_0x1ecb2d[_0xda6b02(0x263)]()[_0xda6b02(0x1f1)](0x5,'0');if(_0x5cb2e1[0x0][_0xda6b02(0x201)]==_0xda6b02(0x1f3))var _0xab7b26=users[_0xda6b02(0x242)];else{if(_0x5cb2e1[0x0][_0xda6b02(0x201)]==_0xda6b02(0x1fc))var _0xab7b26=users[_0xda6b02(0x1fc)];else{if(_0x5cb2e1[0x0][_0xda6b02(0x201)]==_0xda6b02(0x1b8))var _0xab7b26=users[_0xda6b02(0x1b8)];else{if(_0x5cb2e1[0x0][_0xda6b02(0x201)]=='Spanish')var _0xab7b26=users[_0xda6b02(0x1b3)];else{if(_0x5cb2e1[0x0]['language']==_0xda6b02(0x1b9))var _0xab7b26=users['French'];else{if(_0x5cb2e1[0x0][_0xda6b02(0x201)]=='Portuguese\x20(BR)')var _0xab7b26=users[_0xda6b02(0x22d)];else{if(_0x5cb2e1[0x0][_0xda6b02(0x201)]==_0xda6b02(0x25a))var _0xab7b26=users[_0xda6b02(0x25a)];else{if(_0x5cb2e1[0x0][_0xda6b02(0x201)]==_0xda6b02(0x22c))var _0xab7b26=users['Arabic'];}}}}}}}const _0x2abf2c=getRandom8DigitNumber();_0x2abf2c[_0xda6b02(0x1e8)](_0xa1ab1=>{var _0x473f3b=_0xda6b02;_0x2a5f7d['render'](_0x473f3b(0x21f),{'success':_0x3bb065[_0x473f3b(0x268)]('success'),'errors':_0x3bb065[_0x473f3b(0x268)]('errors'),'role':_0x431e11,'profile':_0x5495c5,'master_shop':_0x5cb2e1,'warehouse':_0x62e724,'language':_0xab7b26,'invoice':_0xa1ab1});})['catch'](_0x2ae5b8=>{var _0x11c960=_0xda6b02;_0x3bb065[_0x11c960(0x268)](_0x11c960(0x1a4),_0x11c960(0x1d6)),_0x2a5f7d[_0x11c960(0x227)](_0x11c960(0x1f0));});}catch(_0x2c0575){console[_0xda6b02(0x1d5)](_0x2c0575);}}),router[a0_0x49b316(0x228)](a0_0x49b316(0x1f2),auth,async(_0x5499b6,_0x4eb9c2)=>{var _0x38bf92=a0_0x49b316;try{const {date:_0x4db007,from_warehouse:_0x1fa367,FromRoom_name:_0x15ba29,to_warehouse:_0x55f637,ToRoom_name:_0x42d25d,prod_name:_0x3712af,from_prod_qty:_0x485c73,from_prod_level:_0x4ed109,from_prod_isle:_0x368e2b,from_prod_pallet:_0x59fb71,to_prod_qty:_0x3cd76a,to_prod_level:_0x5c3c6c,to_prod_isle:_0x55a227,to_prod_pallet:_0x243c3b,primary_code:_0x504a01,secondary_code:_0x4c71fe,product_code3:_0x1c55f3,note:_0x33a23f,MaxStocks_data2:_0x41ad98,invoice:_0x4307d8,expiry_date:_0x283a7b,PO_number:_0x770612,ReqBy:_0x4cb17c,dateofreq:_0x20b336,typeservicesData:_0x414330,destination:_0x2fc6ac,deliverydate:_0x315dba,driver:_0x54fd4b,plate:_0x52f6df,van:_0x35c972,DRSI:_0x4b3e50,typevehicle:_0x274844,TSU:_0x122e5c,TFU:_0x4221ac}=_0x5499b6[_0x38bf92(0x23d)];if(typeof _0x3712af==_0x38bf92(0x26a))var _0x44d7e3=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x230)]],_0x379f6a=[_0x5499b6['body']['from_prod_qty']],_0x2ffdf0=[_0x5499b6[_0x38bf92(0x23d)]['from_prod_level2']],_0x4c4a4e=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x266)]],_0x4ca45f=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1ba)]],_0x243647=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1e9)]],_0x6efb4a=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x257)]],_0x20fc9b=[_0x5499b6['body'][_0x38bf92(0x222)]],_0x3e0475=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x210)]],_0x46c716=[_0x5499b6['body'][_0x38bf92(0x1f5)]],_0x391456=[_0x5499b6[_0x38bf92(0x23d)]['secondary_unit']],_0x2efcb7=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1fe)]],_0x4ee926=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x238)]],_0x20de96=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x23e)]],_0xe1ad03=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1e5)]],_0x39feb5=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1c0)]],_0x236128=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1a6)]],_0x1f6a34=[_0x5499b6['body']['RoomAssigned']],_0x115950=[_0x5499b6[_0x38bf92(0x23d)]['ToRoomAssigned']],_0x5a91f0=[_0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1b0)]],_0x181e83=[_0x5499b6['body']['id_transaction']];else var _0x44d7e3=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x230)]],_0x379f6a=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x255)]],_0x2ffdf0=[..._0x5499b6[_0x38bf92(0x23d)]['from_prod_level2']],_0x4c4a4e=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x266)]],_0x4ca45f=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1ba)]],_0x243647=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1e9)]],_0x6efb4a=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x257)]],_0x20fc9b=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x222)]],_0x3e0475=[..._0x5499b6['body']['MaxStocks_data2']],_0x46c716=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1f5)]],_0x391456=[..._0x5499b6['body']['secondary_unit']],_0x2efcb7=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1fe)]],_0x4ee926=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x238)]],_0x20de96=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x23e)]],_0xe1ad03=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1e5)]],_0x39feb5=[..._0x5499b6[_0x38bf92(0x23d)]['maxPerUnit']],_0x236128=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1a6)]],_0x1f6a34=[..._0x5499b6['body'][_0x38bf92(0x225)]],_0x115950=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x244)]],_0x5a91f0=[..._0x5499b6[_0x38bf92(0x23d)]['from_invoice']],_0x181e83=[..._0x5499b6[_0x38bf92(0x23d)][_0x38bf92(0x1a3)]];const _0x59ceed=_0x44d7e3[_0x38bf92(0x24f)](_0x24c130=>{return _0x24c130={'product_name':_0x24c130};});_0x379f6a[_0x38bf92(0x21d)]((_0x39dad2,_0x413b7c)=>{var _0x4bae81=_0x38bf92;_0x59ceed[_0x413b7c][_0x4bae81(0x1d7)]=_0x39dad2;}),_0x2ffdf0[_0x38bf92(0x21d)]((_0x3d3fe5,_0x538800)=>{var _0x498b37=_0x38bf92,_0xa8bab7=_0x3d3fe5[_0x498b37(0x21b)](/[A-Za-z]+/)[0x0],_0xd6e047=parseInt(_0x3d3fe5[_0x498b37(0x21b)](/\d+/)[0x0]);_0x59ceed[_0x538800][_0x498b37(0x22b)]=_0xd6e047,_0x59ceed[_0x538800][_0x498b37(0x241)]=_0xa8bab7;}),_0x181e83['forEach']((_0xb7ac83,_0x28afa5)=>{_0x59ceed[_0x28afa5]['id_transaction']=_0xb7ac83;}),_0x5a91f0[_0x38bf92(0x21d)]((_0x279825,_0xdcfa61)=>{_0x59ceed[_0xdcfa61]['from_invoice']=_0x279825;}),_0x4c4a4e[_0x38bf92(0x21d)]((_0x56fc15,_0x1104e5)=>{var _0x208f38=_0x38bf92;_0x59ceed[_0x1104e5][_0x208f38(0x1cc)]=_0x56fc15;}),_0x4ca45f[_0x38bf92(0x21d)]((_0xca48f1,_0x27dd01)=>{var _0xe2d2d=_0x38bf92,_0x56a48f=_0xca48f1['match'](/[A-Za-z]+/)[0x0],_0x357644=parseInt(_0xca48f1[_0xe2d2d(0x21b)](/\d+/)[0x0]);_0x59ceed[_0x27dd01][_0xe2d2d(0x224)]=_0x56a48f,_0x59ceed[_0x27dd01][_0xe2d2d(0x267)]=_0x357644;}),_0x243647[_0x38bf92(0x21d)]((_0x123499,_0x5c66c9)=>{var _0x2b97a4=_0x38bf92;_0x59ceed[_0x5c66c9][_0x2b97a4(0x1e9)]=_0x123499;}),_0x6efb4a['forEach']((_0x1f78f8,_0x25465a)=>{var _0xf06a36=_0x38bf92;_0x59ceed[_0x25465a][_0xf06a36(0x257)]=_0x1f78f8;}),_0x20fc9b[_0x38bf92(0x21d)]((_0x42812c,_0x37b57e)=>{_0x59ceed[_0x37b57e]['product_code']=_0x42812c;}),_0x3e0475['forEach']((_0x3e23ef,_0x19b774)=>{_0x59ceed[_0x19b774]['maxProducts']=_0x3e23ef;}),_0x46c716['forEach']((_0x3643a4,_0x33f4d1)=>{_0x59ceed[_0x33f4d1]['unit']=_0x3643a4;}),_0x391456['forEach']((_0x1d2d0a,_0x274dfa)=>{var _0x24257b=_0x38bf92;_0x59ceed[_0x274dfa][_0x24257b(0x1eb)]=_0x1d2d0a;}),_0x2efcb7[_0x38bf92(0x21d)]((_0x1d95a8,_0x360798)=>{var _0x42f105=_0x38bf92;_0x59ceed[_0x360798][_0x42f105(0x1fe)]=_0x1d95a8;}),_0x4ee926[_0x38bf92(0x21d)]((_0xaae17f,_0x83ec97)=>{_0x59ceed[_0x83ec97]['expiry_date']=_0xaae17f;}),_0x20de96[_0x38bf92(0x21d)]((_0x23cbe4,_0x2adad9)=>{_0x59ceed[_0x2adad9]['production_date']=_0x23cbe4;}),_0xe1ad03[_0x38bf92(0x21d)]((_0x50df8e,_0x3af70f)=>{var _0x5143af=_0x38bf92;_0x59ceed[_0x3af70f][_0x5143af(0x240)]=_0x50df8e;}),_0x39feb5[_0x38bf92(0x21d)]((_0x565848,_0x1accea)=>{var _0x597ff3=_0x38bf92;_0x59ceed[_0x1accea][_0x597ff3(0x1c0)]=_0x565848;}),_0x236128['forEach']((_0x89b8f7,_0x16b71e)=>{var _0x3eeb74=_0x38bf92;_0x59ceed[_0x16b71e][_0x3eeb74(0x1a6)]=_0x89b8f7;}),_0x1f6a34[_0x38bf92(0x21d)]((_0x1dd7c5,_0x51c66b)=>{_0x59ceed[_0x51c66b]['from_room_name']=_0x1dd7c5;}),_0x115950[_0x38bf92(0x21d)]((_0x3267f9,_0x17182d)=>{var _0x2f5e5c=_0x38bf92;_0x59ceed[_0x17182d][_0x2f5e5c(0x1b1)]=_0x3267f9;});const _0x4268d4=_0x59ceed[_0x38bf92(0x1cf)](_0x1443ee=>_0x1443ee[_0x38bf92(0x1cc)]!=='0'&&_0x1443ee['to_quantity']!==''||_0x1443ee[_0x38bf92(0x253)]!=='0'&&_0x1443ee[_0x38bf92(0x253)]!=='');var _0x25beac=0x0;_0x4268d4[_0x38bf92(0x21d)](_0x47a1aa=>{var _0x49f5d2=_0x38bf92;parseInt(_0x47a1aa[_0x49f5d2(0x1d7)])<parseInt(_0x47a1aa[_0x49f5d2(0x1cc)])&&_0x25beac++;});if(_0x25beac!=0x0)return _0x5499b6['flash'](_0x38bf92(0x1a4),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x4eb9c2['redirect'](_0x38bf92(0x1ed));const _0x4f33c5=new transfers_logs();await _0x4f33c5[_0x38bf92(0x20a)]();for(let _0x811cb1=0x0;_0x811cb1<=_0x115950[_0x38bf92(0x233)]-0x1;_0x811cb1++){_0x59ceed[_0x811cb1]['To_invoice']=_0x38bf92(0x25b)+_0x4f33c5[_0x38bf92(0x1ea)][_0x38bf92(0x263)]()[_0x38bf92(0x1f1)](0x8,'0');}const _0x1006d9=new transfers_finished({'date':_0x4db007,'from_warehouse':_0x1fa367,'to_warehouse':_0x1fa367,'product':_0x4268d4,'note':_0x33a23f,'invoice':_0x38bf92(0x25b)+_0x4f33c5[_0x38bf92(0x1ea)][_0x38bf92(0x263)]()['padStart'](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x38bf92(0x1ad),'PO_number':_0x770612,'RequestedBy':_0x4cb17c,'DateofRequest':_0x20b336,'typeservices':_0x414330,'destination':_0x2fc6ac,'deliverydate':_0x315dba,'driver':_0x54fd4b,'plate':_0x52f6df,'van':_0x35c972,'DRSI':_0x4b3e50,'typevehicle':_0x274844,'TSU':_0x122e5c,'TFU':_0x4221ac}),_0x424c12=await _0x1006d9[_0x38bf92(0x20a)]();_0x5499b6['flash'](_0x38bf92(0x1b2),_0x38bf92(0x1b4)),_0x4eb9c2[_0x38bf92(0x227)]('/transfer_finished/preview/'+_0x424c12[_0x38bf92(0x22e)]);}catch(_0x5390de){console[_0x38bf92(0x1d5)](_0x5390de),_0x4eb9c2[_0x38bf92(0x1ec)](0xc8)[_0x38bf92(0x1c9)]({'errorMessage':_0x5390de[_0x38bf92(0x226)]});}}),router[a0_0x49b316(0x228)](a0_0x49b316(0x249),auth,async(_0x2dc511,_0x34928b)=>{var _0x5872b8=a0_0x49b316;try{const {date:_0x3e4256,from_warehouse:_0xed16ca,FromRoom_name:_0x4c73c4,to_warehouse:_0x11274d,ToRoom_name:_0x225e91,prod_name:_0x5bfae4,from_prod_qty:_0x58465a,from_prod_level:_0xc0912e,from_prod_isle:_0x4e5e48,from_prod_pallet:_0x3fc66f,to_prod_qty:_0x369729,to_prod_level:_0x12b071,to_prod_isle:_0x43a86d,to_prod_pallet:_0xcbff9a,primary_code:_0x59a317,secondary_code:_0x11e3cb,product_code3:_0x39725c,note:_0x5eb9d9,MaxStocks_data2:_0x42f2ba,invoice:_0x4bdf86,expiry_date:_0x1945b0,PO_number_loc:_0x5b23ae,ReqBy_loc:_0x380d8f,dateofreq_loc:_0x4a35c4,typeservices_loc_Data:_0x18f7b4,destination_loc:_0x4e1318,deliverydate_loc:_0xf7edae,driver_loc:_0x3b39d1,plate_loc:_0x528533,van_loc:_0x4a75f5,DRSI_loc:_0x2975e1,typevehicle_loc:_0x110f0e,TSU_loc:_0x4da24d,TFU_loc:_0x5c5bfe}=_0x2dc511[_0x5872b8(0x23d)];if(typeof _0x5bfae4==_0x5872b8(0x26a))var _0x3e4b13=[_0x2dc511[_0x5872b8(0x23d)]['prod_name']],_0x41105f=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x255)]],_0x3357a9=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1a7)]],_0x17d077=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x266)]],_0x21a97a=[_0x2dc511['body'][_0x5872b8(0x1ba)]],_0x1ea01=[_0x2dc511['body']['primary_code']],_0x2ad782=[_0x2dc511['body'][_0x5872b8(0x257)]],_0x22e79e=[_0x2dc511[_0x5872b8(0x23d)]['product_code3']],_0x416034=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x210)]],_0x139161=[_0x2dc511[_0x5872b8(0x23d)]['primary_unit']],_0xd137bf=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1eb)]],_0x16c66a=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1fe)]],_0xa982e0=[_0x2dc511[_0x5872b8(0x23d)]['expiry_date']],_0x298e1d=[_0x2dc511['body'][_0x5872b8(0x23e)]],_0xd2380e=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1e5)]],_0x15294f=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1c0)]],_0x60d5b5=[_0x2dc511['body'][_0x5872b8(0x1a6)]],_0x10a21a=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x225)]],_0x34136e=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x244)]],_0x3edb6b=[_0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1b0)]],_0x2d1cfb=[_0x2dc511['body'][_0x5872b8(0x1a3)]];else var _0x3e4b13=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x230)]],_0x41105f=[..._0x2dc511[_0x5872b8(0x23d)]['from_prod_qty']],_0x3357a9=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1a7)]],_0x17d077=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x266)]],_0x21a97a=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1ba)]],_0x1ea01=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1e9)]],_0x2ad782=[..._0x2dc511['body'][_0x5872b8(0x257)]],_0x22e79e=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x222)]],_0x416034=[..._0x2dc511[_0x5872b8(0x23d)]['MaxStocks_data2']],_0x139161=[..._0x2dc511['body']['primary_unit']],_0xd137bf=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1eb)]],_0x16c66a=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1fe)]],_0xa982e0=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x238)]],_0x298e1d=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x23e)]],_0xd2380e=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1e5)]],_0x15294f=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x1c0)]],_0x60d5b5=[..._0x2dc511['body'][_0x5872b8(0x1a6)]],_0x10a21a=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x225)]],_0x34136e=[..._0x2dc511[_0x5872b8(0x23d)][_0x5872b8(0x244)]],_0x3edb6b=[..._0x2dc511[_0x5872b8(0x23d)]['from_invoice']],_0x2d1cfb=[..._0x2dc511['body']['id_transaction']];const _0x5c9165=_0x3e4b13[_0x5872b8(0x24f)](_0x230761=>{return _0x230761={'product_name':_0x230761};});_0x41105f[_0x5872b8(0x21d)]((_0x2a8dc5,_0x56f443)=>{var _0x25a596=_0x5872b8;_0x5c9165[_0x56f443][_0x25a596(0x1d7)]=_0x2a8dc5;}),_0x3357a9[_0x5872b8(0x21d)]((_0x35ec6d,_0x146592)=>{var _0xaf770f=_0x5872b8,_0x5112d6=_0x35ec6d[_0xaf770f(0x21b)](/[A-Za-z]+/)[0x0],_0x458cb4=parseInt(_0x35ec6d[_0xaf770f(0x21b)](/\d+/)[0x0]);_0x5c9165[_0x146592][_0xaf770f(0x22b)]=_0x458cb4,_0x5c9165[_0x146592]['from_level']=_0x5112d6;}),_0x2d1cfb[_0x5872b8(0x21d)]((_0x24319e,_0x22a50c)=>{_0x5c9165[_0x22a50c]['id_transaction']=_0x24319e;}),_0x3edb6b[_0x5872b8(0x21d)]((_0x129324,_0x1e946e)=>{_0x5c9165[_0x1e946e]['from_invoice']=_0x129324;}),_0x17d077[_0x5872b8(0x21d)]((_0x243039,_0x38d775)=>{_0x5c9165[_0x38d775]['to_quantity']=_0x243039;}),_0x21a97a[_0x5872b8(0x21d)]((_0x4693b9,_0x2f337d)=>{var _0x277c4a=_0x5872b8,_0xf4eba2=_0x4693b9[_0x277c4a(0x21b)](/[A-Za-z]+/)[0x0],_0x5bf09e=parseInt(_0x4693b9[_0x277c4a(0x21b)](/\d+/)[0x0]);_0x5c9165[_0x2f337d][_0x277c4a(0x224)]=_0xf4eba2,_0x5c9165[_0x2f337d][_0x277c4a(0x267)]=_0x5bf09e;}),_0x1ea01['forEach']((_0x4c17eb,_0x361ef5)=>{_0x5c9165[_0x361ef5]['primary_code']=_0x4c17eb;}),_0x2ad782[_0x5872b8(0x21d)]((_0x7f76ee,_0x3826d2)=>{_0x5c9165[_0x3826d2]['secondary_code']=_0x7f76ee;}),_0x22e79e['forEach']((_0x835236,_0x5a4d7c)=>{var _0x3f0136=_0x5872b8;_0x5c9165[_0x5a4d7c][_0x3f0136(0x1e0)]=_0x835236;}),_0x416034[_0x5872b8(0x21d)]((_0x1515d3,_0x29ab73)=>{_0x5c9165[_0x29ab73]['maxProducts']=_0x1515d3;}),_0x139161[_0x5872b8(0x21d)]((_0x1a90d9,_0x2cb2ee)=>{var _0x45b589=_0x5872b8;_0x5c9165[_0x2cb2ee][_0x45b589(0x21a)]=_0x1a90d9;}),_0xd137bf[_0x5872b8(0x21d)]((_0x638776,_0x56cb84)=>{_0x5c9165[_0x56cb84]['secondary_unit']=_0x638776;}),_0x16c66a[_0x5872b8(0x21d)]((_0x16acdc,_0x25225f)=>{var _0x429d5f=_0x5872b8;_0x5c9165[_0x25225f][_0x429d5f(0x1fe)]=_0x16acdc;}),_0xa982e0[_0x5872b8(0x21d)]((_0x2026af,_0x3d91f7)=>{var _0x5df202=_0x5872b8;_0x5c9165[_0x3d91f7][_0x5df202(0x238)]=_0x2026af;}),_0x298e1d[_0x5872b8(0x21d)]((_0x208ee4,_0x4c9c25)=>{_0x5c9165[_0x4c9c25]['production_date']=_0x208ee4;}),_0xd2380e[_0x5872b8(0x21d)]((_0x25a740,_0x3258e3)=>{var _0x455d19=_0x5872b8;_0x5c9165[_0x3258e3][_0x455d19(0x240)]=_0x25a740;}),_0x15294f[_0x5872b8(0x21d)]((_0xe4d66d,_0x2691e5)=>{var _0x2fdb99=_0x5872b8;_0x5c9165[_0x2691e5][_0x2fdb99(0x1c0)]=_0xe4d66d;}),_0x60d5b5[_0x5872b8(0x21d)]((_0x69bd73,_0x41b59e)=>{var _0x2d271d=_0x5872b8;_0x5c9165[_0x41b59e][_0x2d271d(0x1a6)]=_0x69bd73;}),_0x10a21a['forEach']((_0x2d87f4,_0x370d38)=>{var _0xef0cda=_0x5872b8;_0x5c9165[_0x370d38][_0xef0cda(0x1cd)]=_0x2d87f4;}),_0x34136e[_0x5872b8(0x21d)]((_0x1eadd0,_0x3d9ab5)=>{var _0x1c0a71=_0x5872b8;_0x5c9165[_0x3d9ab5][_0x1c0a71(0x1b1)]=_0x1eadd0;});const _0x3adf85=_0x5c9165[_0x5872b8(0x1cf)](_0x1133e0=>_0x1133e0[_0x5872b8(0x1cc)]!=='0'&&_0x1133e0['to_quantity']!==''||_0x1133e0[_0x5872b8(0x253)]!=='0'&&_0x1133e0[_0x5872b8(0x253)]!=='');var _0x1eda85=0x0;_0x3adf85[_0x5872b8(0x21d)](_0x227617=>{var _0x56ca3b=_0x5872b8;parseInt(_0x227617['from_quantity'])<parseInt(_0x227617[_0x56ca3b(0x1cc)])&&_0x1eda85++;});if(_0x1eda85!=0x0)return _0x2dc511[_0x5872b8(0x268)](_0x5872b8(0x1a4),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x34928b['redirect'](_0x5872b8(0x1ed));const _0x3334ac=new transfers_logs();await _0x3334ac[_0x5872b8(0x20a)]();for(let _0x38f0c9=0x0;_0x38f0c9<=_0x34136e[_0x5872b8(0x233)]-0x1;_0x38f0c9++){_0x5c9165[_0x38f0c9][_0x5872b8(0x1f6)]=_0x5872b8(0x25b)+_0x3334ac[_0x5872b8(0x1ea)][_0x5872b8(0x263)]()[_0x5872b8(0x1f1)](0x8,'0');}const _0x14468c=new transfers_finished({'date':_0x3e4256,'from_warehouse':_0xed16ca,'to_warehouse':_0x11274d,'product':_0x3adf85,'note':_0x5eb9d9,'invoice':_0x5872b8(0x25b)+_0x3334ac[_0x5872b8(0x1ea)][_0x5872b8(0x263)]()[_0x5872b8(0x1f1)](0x8,'0'),'type_of_transaction':_0x5872b8(0x1ad),'type_of_process':'location2location','PO_number':_0x5b23ae,'RequestedBy':_0x380d8f,'DateofRequest':_0x4a35c4,'typeservices':_0x18f7b4,'destination':_0x4e1318,'deliverydate':_0xf7edae,'driver':_0x3b39d1,'plate':_0x528533,'van':_0x4a75f5,'DRSI':_0x2975e1,'typevehicle':_0x110f0e,'TSU':_0x4da24d,'TFU':_0x5c5bfe}),_0x5a6456=await _0x14468c[_0x5872b8(0x20a)]();_0x2dc511[_0x5872b8(0x268)](_0x5872b8(0x1b2),_0x5872b8(0x1b4)),_0x34928b[_0x5872b8(0x227)]('/transfer_finished/preview/'+_0x5a6456[_0x5872b8(0x22e)]);}catch(_0x98271){console[_0x5872b8(0x1d5)](_0x98271),_0x34928b['status'](0xc8)[_0x5872b8(0x1c9)]({'errorMessage':_0x98271[_0x5872b8(0x226)]});}}),router[a0_0x49b316(0x228)](a0_0x49b316(0x1e7),auth,async(_0x14ec5f,_0x333da5)=>{var _0x18f943=a0_0x49b316;try{const {date:_0x1137a2,from_warehouse:_0x4ec786,FromRoom_name:_0x40fc12,to_warehouse:_0x131351,ToRoom_name:_0x50cc37,prod_name:_0x28e7b2,from_prod_qty:_0x1755a8,from_prod_level:_0x357d46,from_prod_isle:_0x5542b6,from_prod_pallet:_0x46d25f,to_prod_qty:_0x263b00,to_prod_level:_0x4f23e5,to_prod_isle:_0x388d0f,to_prod_pallet:_0x5397f9,primary_code:_0x569f00,secondary_code:_0x45745a,product_code3:_0x181f47,note:_0x4a76ad,MaxStocks_data2:_0x3efa34,invoice:_0x5b5173,expiry_date:_0x582fc7,PO_number:_0x936cb,ReqBy:_0x21bbbe,dateofreq:_0x37606c,typeservicesData:_0x4e1b33,destination:_0x3a5b73,deliverydate:_0x2c2e6f,driver:_0x322729,plate:_0x3e7577,van:_0x493089,DRSI:_0x2db9bc,typevehicle:_0x3310c8,TSU:_0x166be1,TFU:_0x213c71}=_0x14ec5f['body'];if(typeof _0x28e7b2=='string')var _0x24ef3b=[_0x14ec5f[_0x18f943(0x23d)]['prod_name']],_0x10188b=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x255)]],_0x1d25c6=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1a7)]],_0x128998=[_0x14ec5f['body'][_0x18f943(0x266)]],_0x2dbdbd=[_0x14ec5f[_0x18f943(0x23d)]['to_prod_level']],_0x2c0029=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1e9)]],_0x412371=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x257)]],_0x2537b9=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x222)]],_0x46aa68=[_0x14ec5f['body'][_0x18f943(0x210)]],_0x11addf=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1f5)]],_0x13f78b=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1eb)]],_0x2bc147=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1fe)]],_0x3cc561=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x238)]],_0x33027c=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x23e)]],_0x5afa8e=[_0x14ec5f[_0x18f943(0x23d)]['MaxStocks_data']],_0x144929=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1c0)]],_0x3736f0=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1a6)]],_0x5c3ead=[_0x14ec5f['body']['RoomAssigned']],_0x2d1ec3=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x244)]],_0x329063=[_0x14ec5f[_0x18f943(0x23d)]['from_invoice']],_0x5573a5=[_0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1a3)]];else var _0x24ef3b=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x230)]],_0x10188b=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x255)]],_0x1d25c6=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1a7)]],_0x128998=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x266)]],_0x2dbdbd=[..._0x14ec5f[_0x18f943(0x23d)]['to_prod_level']],_0x2c0029=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1e9)]],_0x412371=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x257)]],_0x2537b9=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x222)]],_0x46aa68=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x210)]],_0x11addf=[..._0x14ec5f['body'][_0x18f943(0x1f5)]],_0x13f78b=[..._0x14ec5f['body'][_0x18f943(0x1eb)]],_0x2bc147=[..._0x14ec5f[_0x18f943(0x23d)]['batch_code']],_0x3cc561=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x238)]],_0x33027c=[..._0x14ec5f['body'][_0x18f943(0x23e)]],_0x5afa8e=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1e5)]],_0x144929=[..._0x14ec5f[_0x18f943(0x23d)]['maxPerUnit']],_0x3736f0=[..._0x14ec5f[_0x18f943(0x23d)]['prod_cat']],_0x5c3ead=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x225)]],_0x2d1ec3=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x244)]],_0x329063=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1b0)]],_0x5573a5=[..._0x14ec5f[_0x18f943(0x23d)][_0x18f943(0x1a3)]];const _0x51b2e0=_0x24ef3b[_0x18f943(0x24f)](_0x469b4d=>{return _0x469b4d={'product_name':_0x469b4d};});_0x10188b[_0x18f943(0x21d)]((_0x509bc8,_0x4d7d9e)=>{var _0x10e026=_0x18f943;_0x51b2e0[_0x4d7d9e][_0x10e026(0x1d7)]=_0x509bc8;}),_0x1d25c6['forEach']((_0x3843de,_0x3364c2)=>{var _0x16ea18=_0x18f943,_0x345c16=_0x3843de[_0x16ea18(0x21b)](/[A-Za-z]+/)[0x0],_0x16a086=parseInt(_0x3843de['match'](/\d+/)[0x0]);_0x51b2e0[_0x3364c2][_0x16ea18(0x22b)]=_0x16a086,_0x51b2e0[_0x3364c2][_0x16ea18(0x241)]=_0x345c16;}),_0x5573a5[_0x18f943(0x21d)]((_0x180794,_0x215c80)=>{var _0x32c83b=_0x18f943;_0x51b2e0[_0x215c80][_0x32c83b(0x1a3)]=_0x180794;}),_0x329063[_0x18f943(0x21d)]((_0x424215,_0x4c9c76)=>{var _0x140578=_0x18f943;_0x51b2e0[_0x4c9c76][_0x140578(0x1b0)]=_0x424215;}),_0x128998[_0x18f943(0x21d)]((_0x3f6907,_0x50acb6)=>{var _0x1c04ba=_0x18f943;_0x51b2e0[_0x50acb6][_0x1c04ba(0x1cc)]=_0x3f6907;}),_0x2dbdbd[_0x18f943(0x21d)]((_0x179f5e,_0x243688)=>{var _0x133577=_0x18f943,_0x28fc92=_0x179f5e['match'](/[A-Za-z]+/)[0x0],_0x1ef2ef=parseInt(_0x179f5e['match'](/\d+/)[0x0]);_0x51b2e0[_0x243688][_0x133577(0x224)]=_0x28fc92,_0x51b2e0[_0x243688][_0x133577(0x267)]=_0x1ef2ef;}),_0x2c0029[_0x18f943(0x21d)]((_0x12a354,_0x4c786c)=>{_0x51b2e0[_0x4c786c]['primary_code']=_0x12a354;}),_0x412371['forEach']((_0x2c3696,_0x205e7d)=>{var _0x45cae5=_0x18f943;_0x51b2e0[_0x205e7d][_0x45cae5(0x257)]=_0x2c3696;}),_0x2537b9[_0x18f943(0x21d)]((_0x1f196f,_0x4df41b)=>{var _0x54a24d=_0x18f943;_0x51b2e0[_0x4df41b][_0x54a24d(0x1e0)]=_0x1f196f;}),_0x46aa68[_0x18f943(0x21d)]((_0x1af506,_0x259e33)=>{var _0x954f5b=_0x18f943;_0x51b2e0[_0x259e33][_0x954f5b(0x240)]=_0x1af506;}),_0x11addf[_0x18f943(0x21d)]((_0x5604b3,_0x515c11)=>{var _0x4a96ee=_0x18f943;_0x51b2e0[_0x515c11][_0x4a96ee(0x21a)]=_0x5604b3;}),_0x13f78b[_0x18f943(0x21d)]((_0x42293a,_0x1aebb0)=>{var _0x39ef82=_0x18f943;_0x51b2e0[_0x1aebb0][_0x39ef82(0x1eb)]=_0x42293a;}),_0x2bc147['forEach']((_0x309c89,_0x17337d)=>{var _0x39f336=_0x18f943;_0x51b2e0[_0x17337d][_0x39f336(0x1fe)]=_0x309c89;}),_0x3cc561[_0x18f943(0x21d)]((_0xfb0a4a,_0x5cadcf)=>{_0x51b2e0[_0x5cadcf]['expiry_date']=_0xfb0a4a;}),_0x33027c[_0x18f943(0x21d)]((_0x1d6a00,_0x223612)=>{var _0x2a55b2=_0x18f943;_0x51b2e0[_0x223612][_0x2a55b2(0x1c5)]=_0x1d6a00;}),_0x5afa8e[_0x18f943(0x21d)]((_0xa4744e,_0x39a0ec)=>{var _0x4d1058=_0x18f943;_0x51b2e0[_0x39a0ec][_0x4d1058(0x240)]=_0xa4744e;}),_0x144929['forEach']((_0x524a2c,_0x4b222f)=>{var _0x34b060=_0x18f943;_0x51b2e0[_0x4b222f][_0x34b060(0x1c0)]=_0x524a2c;}),_0x3736f0['forEach']((_0x206f25,_0x4d740d)=>{var _0x2669ae=_0x18f943;_0x51b2e0[_0x4d740d][_0x2669ae(0x1a6)]=_0x206f25;}),_0x5c3ead['forEach']((_0x1ea12a,_0x1f04b3)=>{var _0xa8c8d6=_0x18f943;_0x51b2e0[_0x1f04b3][_0xa8c8d6(0x1cd)]=_0x1ea12a;}),_0x2d1ec3[_0x18f943(0x21d)]((_0xd479af,_0xd32bb1)=>{var _0x51858c=_0x18f943;_0x51b2e0[_0xd32bb1][_0x51858c(0x1b1)]=_0xd479af;});const _0x34e5e4=_0x51b2e0[_0x18f943(0x1cf)](_0x40b5b0=>_0x40b5b0[_0x18f943(0x1cc)]!=='0'&&_0x40b5b0[_0x18f943(0x1cc)]!==''||_0x40b5b0['to_floorlevel']!=='0'&&_0x40b5b0[_0x18f943(0x253)]!=='');var _0x349a7d=0x0;_0x34e5e4[_0x18f943(0x21d)](_0xdd76f5=>{var _0x11c4ca=_0x18f943;parseInt(_0xdd76f5[_0x11c4ca(0x1d7)])<parseInt(_0xdd76f5['to_quantity'])&&_0x349a7d++;});if(_0x349a7d!=0x0)return _0x14ec5f['flash']('errors',_0x18f943(0x1a2)),_0x333da5[_0x18f943(0x227)](_0x18f943(0x1ed));const _0xcabe34=new invoice_for_transfer();await _0xcabe34['save']();for(let _0x2d9c97=0x0;_0x2d9c97<=_0x2d1ec3[_0x18f943(0x233)]-0x1;_0x2d9c97++){_0x51b2e0[_0x2d9c97][_0x18f943(0x1f6)]=_0x18f943(0x1c8)+_0xcabe34['invoice_init'][_0x18f943(0x263)]()['padStart'](0x8,'0');}const _0x5ab37e=new transfers_finished({'date':_0x1137a2,'from_warehouse':_0x4ec786,'to_warehouse':_0x4ec786,'product':_0x34e5e4,'note':_0x4a76ad,'invoice':_0x18f943(0x1c8)+_0xcabe34[_0x18f943(0x1ea)]['toString']()[_0x18f943(0x1f1)](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x18f943(0x260),'PO_number':_0x936cb,'RequestedBy':_0x21bbbe,'DateofRequest':_0x37606c,'typeservices':_0x4e1b33,'destination':_0x3a5b73,'deliverydate':_0x2c2e6f,'driver':_0x322729,'plate':_0x3e7577,'van':_0x493089,'DRSI':_0x2db9bc,'typevehicle':_0x3310c8,'TSU':_0x166be1,'TFU':_0x213c71}),_0x2856a9=await _0x5ab37e[_0x18f943(0x20a)]();_0x14ec5f[_0x18f943(0x268)](_0x18f943(0x1b2),_0x18f943(0x1b4)),_0x333da5[_0x18f943(0x227)]('/transfer_finished/preview/'+_0x2856a9['_id']);}catch(_0x140af6){console[_0x18f943(0x1d5)](_0x140af6),_0x333da5[_0x18f943(0x1ec)](0xc8)[_0x18f943(0x1c9)]({'errorMessage':_0x140af6['message']});}}),router['post'](a0_0x49b316(0x223),auth,async(_0x27d7af,_0x337bc5)=>{var _0x1d4a0a=a0_0x49b316;try{const {date:_0x2c7b17,from_warehouse:_0x4a4b96,FromRoom_name:_0x89587a,to_warehouse:_0x2cbf9b,ToRoom_name:_0x1b6f65,prod_name:_0x5b638c,from_prod_qty:_0x458fc2,from_prod_level:_0x1586c8,from_prod_isle:_0x3af01f,from_prod_pallet:_0x56eba8,to_prod_qty:_0x194fc2,to_prod_level:_0x32ad38,to_prod_isle:_0x201e9f,to_prod_pallet:_0x34acd7,primary_code:_0x1580aa,secondary_code:_0x421aab,product_code3:_0x101175,note:_0x5e4f12,MaxStocks_data2:_0xa1fbe1,invoice:_0x30a2e9,expiry_date:_0x251de8,PO_number_loc:_0x3f4fc2,ReqBy_loc:_0x2d30ef,dateofreq_loc:_0x4fc34f,typeservices_loc_Data:_0x444069,destination_loc:_0x4ce85e,deliverydate_loc:_0x27465e,driver_loc:_0x42f718,plate_loc:_0x473806,van_loc:_0x42f33a,DRSI_loc:_0x53ab1c,typevehicle_loc:_0x436cb2,TSU_loc:_0x5ec5de,TFU_loc:_0x2a6e38}=_0x27d7af[_0x1d4a0a(0x23d)];if(typeof _0x5b638c==_0x1d4a0a(0x26a))var _0x351690=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x230)]],_0xf1afac=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x255)]],_0x2b1476=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1a7)]],_0xd74d5e=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x266)]],_0x261ce6=[_0x27d7af['body'][_0x1d4a0a(0x1ba)]],_0x22ec94=[_0x27d7af['body'][_0x1d4a0a(0x1e9)]],_0x44e1b8=[_0x27d7af[_0x1d4a0a(0x23d)]['secondary_code']],_0x10306c=[_0x27d7af['body'][_0x1d4a0a(0x222)]],_0x2c7470=[_0x27d7af[_0x1d4a0a(0x23d)]['MaxStocks_data2']],_0x4f3a1b=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1f5)]],_0x5d9533=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1eb)]],_0x2ad071=[_0x27d7af[_0x1d4a0a(0x23d)]['batch_code']],_0x3315ce=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x238)]],_0x14b613=[_0x27d7af[_0x1d4a0a(0x23d)]['product_date']],_0x14459c=[_0x27d7af[_0x1d4a0a(0x23d)]['MaxStocks_data']],_0x262174=[_0x27d7af[_0x1d4a0a(0x23d)]['maxPerUnit']],_0x332835=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1a6)]],_0x355e89=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x225)]],_0x386c58=[_0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x244)]],_0x4b0de9=[_0x27d7af['body'][_0x1d4a0a(0x1b0)]],_0x17fac2=[_0x27d7af[_0x1d4a0a(0x23d)]['id_transaction']];else var _0x351690=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x230)]],_0xf1afac=[..._0x27d7af[_0x1d4a0a(0x23d)]['from_prod_qty']],_0x2b1476=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1a7)]],_0xd74d5e=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x266)]],_0x261ce6=[..._0x27d7af[_0x1d4a0a(0x23d)]['to_prod_level']],_0x22ec94=[..._0x27d7af[_0x1d4a0a(0x23d)]['primary_code']],_0x44e1b8=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x257)]],_0x10306c=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x222)]],_0x2c7470=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x210)]],_0x4f3a1b=[..._0x27d7af[_0x1d4a0a(0x23d)]['primary_unit']],_0x5d9533=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1eb)]],_0x2ad071=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1fe)]],_0x3315ce=[..._0x27d7af['body'][_0x1d4a0a(0x238)]],_0x14b613=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x23e)]],_0x14459c=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1e5)]],_0x262174=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1c0)]],_0x332835=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1a6)]],_0x355e89=[..._0x27d7af['body']['RoomAssigned']],_0x386c58=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x244)]],_0x4b0de9=[..._0x27d7af[_0x1d4a0a(0x23d)]['from_invoice']],_0x17fac2=[..._0x27d7af[_0x1d4a0a(0x23d)][_0x1d4a0a(0x1a3)]];const _0x35c58b=_0x351690[_0x1d4a0a(0x24f)](_0x372108=>{return _0x372108={'product_name':_0x372108};});_0xf1afac[_0x1d4a0a(0x21d)]((_0xe32135,_0x592204)=>{_0x35c58b[_0x592204]['from_quantity']=_0xe32135;}),_0x2b1476[_0x1d4a0a(0x21d)]((_0x3cf89d,_0x5eb359)=>{var _0x20da2b=_0x1d4a0a,_0x9dde3a=_0x3cf89d[_0x20da2b(0x21b)](/[A-Za-z]+/)[0x0],_0x4d65d4=parseInt(_0x3cf89d['match'](/\d+/)[0x0]);_0x35c58b[_0x5eb359][_0x20da2b(0x22b)]=_0x4d65d4,_0x35c58b[_0x5eb359][_0x20da2b(0x241)]=_0x9dde3a;}),_0x17fac2[_0x1d4a0a(0x21d)]((_0x51b0ff,_0xaf1841)=>{var _0x5e2885=_0x1d4a0a;_0x35c58b[_0xaf1841][_0x5e2885(0x1a3)]=_0x51b0ff;}),_0x4b0de9['forEach']((_0x5319cb,_0x592864)=>{_0x35c58b[_0x592864]['from_invoice']=_0x5319cb;}),_0xd74d5e[_0x1d4a0a(0x21d)]((_0x3efa3a,_0x3d0f63)=>{_0x35c58b[_0x3d0f63]['to_quantity']=_0x3efa3a;}),_0x261ce6['forEach']((_0x56beaf,_0x121280)=>{var _0x25e7ef=_0x1d4a0a,_0x551ac1=_0x56beaf[_0x25e7ef(0x21b)](/[A-Za-z]+/)[0x0],_0x504553=parseInt(_0x56beaf['match'](/\d+/)[0x0]);_0x35c58b[_0x121280][_0x25e7ef(0x224)]=_0x551ac1,_0x35c58b[_0x121280][_0x25e7ef(0x267)]=_0x504553;}),_0x22ec94[_0x1d4a0a(0x21d)]((_0x403ea7,_0x28e574)=>{_0x35c58b[_0x28e574]['primary_code']=_0x403ea7;}),_0x44e1b8[_0x1d4a0a(0x21d)]((_0x22e444,_0x4bb7e7)=>{_0x35c58b[_0x4bb7e7]['secondary_code']=_0x22e444;}),_0x10306c['forEach']((_0x2652b6,_0x443ca4)=>{var _0x556aae=_0x1d4a0a;_0x35c58b[_0x443ca4][_0x556aae(0x1e0)]=_0x2652b6;}),_0x2c7470[_0x1d4a0a(0x21d)]((_0x4d9178,_0x51667a)=>{var _0x1754d0=_0x1d4a0a;_0x35c58b[_0x51667a][_0x1754d0(0x240)]=_0x4d9178;}),_0x4f3a1b['forEach']((_0x14456d,_0x3a8fd9)=>{_0x35c58b[_0x3a8fd9]['unit']=_0x14456d;}),_0x5d9533['forEach']((_0x1c7648,_0x344716)=>{var _0x3786be=_0x1d4a0a;_0x35c58b[_0x344716][_0x3786be(0x1eb)]=_0x1c7648;}),_0x2ad071[_0x1d4a0a(0x21d)]((_0x576a8b,_0x5b6aba)=>{var _0x567cab=_0x1d4a0a;_0x35c58b[_0x5b6aba][_0x567cab(0x1fe)]=_0x576a8b;}),_0x3315ce[_0x1d4a0a(0x21d)]((_0x295d9c,_0x2e555d)=>{var _0x1ab7f3=_0x1d4a0a;_0x35c58b[_0x2e555d][_0x1ab7f3(0x238)]=_0x295d9c;}),_0x14b613[_0x1d4a0a(0x21d)]((_0x4b817e,_0x24a4ee)=>{var _0x1aeae2=_0x1d4a0a;_0x35c58b[_0x24a4ee][_0x1aeae2(0x1c5)]=_0x4b817e;}),_0x14459c[_0x1d4a0a(0x21d)]((_0x26b59a,_0x22d2e0)=>{var _0xa40e75=_0x1d4a0a;_0x35c58b[_0x22d2e0][_0xa40e75(0x240)]=_0x26b59a;}),_0x262174[_0x1d4a0a(0x21d)]((_0x219907,_0x17974f)=>{var _0x3bcbc8=_0x1d4a0a;_0x35c58b[_0x17974f][_0x3bcbc8(0x1c0)]=_0x219907;}),_0x332835[_0x1d4a0a(0x21d)]((_0x3138f2,_0xf7007b)=>{_0x35c58b[_0xf7007b]['prod_cat']=_0x3138f2;}),_0x355e89[_0x1d4a0a(0x21d)]((_0x12710d,_0x326a1a)=>{var _0x1315ed=_0x1d4a0a;_0x35c58b[_0x326a1a][_0x1315ed(0x1cd)]=_0x12710d;}),_0x386c58[_0x1d4a0a(0x21d)]((_0x4000e0,_0x1273ae)=>{var _0x447ffc=_0x1d4a0a;_0x35c58b[_0x1273ae][_0x447ffc(0x1b1)]=_0x4000e0;});const _0x44e2a7=_0x35c58b[_0x1d4a0a(0x1cf)](_0x5bfafc=>_0x5bfafc[_0x1d4a0a(0x1cc)]!=='0'&&_0x5bfafc[_0x1d4a0a(0x1cc)]!==''||_0x5bfafc[_0x1d4a0a(0x253)]!=='0'&&_0x5bfafc[_0x1d4a0a(0x253)]!=='');var _0x3e1910=0x0;_0x44e2a7[_0x1d4a0a(0x21d)](_0x828645=>{var _0x548921=_0x1d4a0a;parseInt(_0x828645[_0x548921(0x1d7)])<parseInt(_0x828645['to_quantity'])&&_0x3e1910++;});if(_0x3e1910!=0x0)return _0x27d7af[_0x1d4a0a(0x268)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x337bc5[_0x1d4a0a(0x227)](_0x1d4a0a(0x1ed));const _0x5aec47=new invoice_for_transfer();await _0x5aec47[_0x1d4a0a(0x20a)]();for(let _0x4d938e=0x0;_0x4d938e<=_0x386c58[_0x1d4a0a(0x233)]-0x1;_0x4d938e++){_0x35c58b[_0x4d938e][_0x1d4a0a(0x1f6)]=_0x1d4a0a(0x1c8)+_0x5aec47[_0x1d4a0a(0x1ea)][_0x1d4a0a(0x263)]()[_0x1d4a0a(0x1f1)](0x8,'0');}const _0x6b2b3c=new transfers_finished({'date':_0x2c7b17,'from_warehouse':_0x4a4b96,'to_warehouse':_0x2cbf9b,'product':_0x44e2a7,'note':_0x5e4f12,'invoice':_0x1d4a0a(0x1c8)+_0x5aec47['invoice_init'][_0x1d4a0a(0x263)]()[_0x1d4a0a(0x1f1)](0x8,'0'),'type_of_transaction':'own','type_of_process':_0x1d4a0a(0x24a),'PO_number':_0x3f4fc2,'RequestedBy':_0x2d30ef,'DateofRequest':_0x4fc34f,'typeservices':_0x444069,'destination':_0x4ce85e,'deliverydate':_0x27465e,'driver':_0x42f718,'plate':_0x473806,'van':_0x42f33a,'DRSI':_0x53ab1c,'typevehicle':_0x436cb2,'TSU':_0x5ec5de,'TFU':_0x2a6e38}),_0x7707a8=await _0x6b2b3c['save']();_0x27d7af[_0x1d4a0a(0x268)](_0x1d4a0a(0x1b2),_0x1d4a0a(0x1b4)),_0x337bc5[_0x1d4a0a(0x227)](_0x1d4a0a(0x1af)+_0x7707a8[_0x1d4a0a(0x22e)]);}catch(_0x5f02f9){console[_0x1d4a0a(0x1d5)](_0x5f02f9),_0x337bc5['status'](0xc8)[_0x1d4a0a(0x1c9)]({'errorMessage':_0x5f02f9[_0x1d4a0a(0x226)]});}}),router['get'](a0_0x49b316(0x1e2),auth,async(_0x4a499c,_0xdafc15)=>{var _0x572116=a0_0x49b316;try{const {username:_0x138ea1,email:_0x5d6694,role:_0x4fa9ca}=_0x4a499c[_0x572116(0x229)],_0x59bf15=_0x4a499c[_0x572116(0x229)],_0x3913cf=await profile[_0x572116(0x1d9)]({'email':_0x59bf15[_0x572116(0x1d1)]}),_0xa39237=await master_shop[_0x572116(0x1fb)](),_0x3aeffa=await transfers_finished[_0x572116(0x1ae)](_0x4a499c['params']['id']);let _0x4a11e0;if(_0x59bf15['role']==_0x572116(0x202)){const _0x13ab97=await staff['findOne']({'email':_0x59bf15['email']});_0x4a11e0=await warehouse[_0x572116(0x1fb)]({'status':_0x572116(0x1ff),'name':_0x13ab97['warehouse'],'warehouse_category':_0x572116(0x1c7)});}else _0x4a11e0=await warehouse[_0x572116(0x1fb)]({'status':_0x572116(0x1ff),'warehouse_category':_0x572116(0x1c7)});const _0x4b459e=await warehouse[_0x572116(0x1bf)]([{'$match':{'name':_0x3aeffa['from_warehouse'],'warehouse_category':_0x572116(0x1c7)}},{'$unwind':_0x572116(0x234)},{'$group':{'_id':_0x572116(0x216),'name':{'$first':_0x572116(0x1de)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x572116(0x1d0)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x572116(0x1a8)},'floorlevel':{'$first':_0x572116(0x203)},'primary_code':{'$first':_0x572116(0x1c2)},'secondary_code':{'$first':_0x572116(0x213)},'product_code':{'$first':_0x572116(0x248)},'storage':{'$first':_0x572116(0x208)},'rack':{'$first':_0x572116(0x211)},'expiry_date':{'$first':_0x572116(0x24c)},'production_date':{'$first':_0x572116(0x1dc)},'room':{'$first':_0x572116(0x22a)},'warehoue_name':{'$first':'$name'}}}]),_0x340859=await product[_0x572116(0x1fb)]({});if(_0xa39237[0x0][_0x572116(0x201)]==_0x572116(0x1f3)){var _0x43df50=users['English'];console['log'](_0x43df50);}else{if(_0xa39237[0x0][_0x572116(0x201)]=='Hindi')var _0x43df50=users['Hindi'];else{if(_0xa39237[0x0]['language']==_0x572116(0x1b8))var _0x43df50=users[_0x572116(0x1b8)];else{if(_0xa39237[0x0][_0x572116(0x201)]==_0x572116(0x1b3))var _0x43df50=users[_0x572116(0x1b3)];else{if(_0xa39237[0x0]['language']=='French')var _0x43df50=users['French'];else{if(_0xa39237[0x0][_0x572116(0x201)]==_0x572116(0x232))var _0x43df50=users[_0x572116(0x22d)];else{if(_0xa39237[0x0][_0x572116(0x201)]==_0x572116(0x25a))var _0x43df50=users['Chinese'];else{if(_0xa39237[0x0][_0x572116(0x201)]=='Arabic\x20(ae)')var _0x43df50=users[_0x572116(0x24b)];}}}}}}}_0xdafc15['render']('edit_transfer_finished_view',{'success':_0x4a499c[_0x572116(0x268)]('success'),'errors':_0x4a499c['flash']('errors'),'role':_0x59bf15,'profile':_0x3913cf,'master_shop':_0xa39237,'warehouse':_0x4a11e0,'transfer':_0x3aeffa,'stock':_0x4b459e,'unit':_0x340859,'language':_0x43df50});}catch(_0x1c26f5){console['log'](_0x1c26f5);}}),router[a0_0x49b316(0x228)]('/preview/:id',auth,async(_0x4d656a,_0x5a4858)=>{var _0x294d3d=a0_0x49b316;try{const {invoice:_0x38521c,from_warehouse:_0x4e705a,FromRoom_name:_0x41cfd0,to_warehouse:_0x14ed8e,ToRoom_name:_0x5adb07}=_0x4d656a['body'],_0x30eca6=await transfers_finished[_0x294d3d(0x1ae)](_0x4d656a[_0x294d3d(0x1ab)]['id']),_0x56bf78=_0x30eca6[_0x294d3d(0x209)][_0x294d3d(0x24f)](async _0x4a9445=>{var _0x2f93e3=_0x294d3d;if(_0x4a9445[_0x2f93e3(0x1cc)]>0x0){var _0x49713f=await warehouse['findOne']({'name':_0x4e705a,'room':_0x4a9445['from_room_name']});const _0x5e0e7b=_0x49713f[_0x2f93e3(0x206)][_0x2f93e3(0x24f)](_0x3c3033=>{var _0x65cc5d=_0x2f93e3;_0x3c3033['_id']==_0x4a9445[_0x65cc5d(0x1a3)]&&(_0x3c3033[_0x65cc5d(0x205)]=Math['max'](0x0,Math['abs'](_0x3c3033[_0x65cc5d(0x205)])-Math['abs'](_0x4a9445['to_quantity'])),console[_0x65cc5d(0x1d5)](_0x3c3033[_0x65cc5d(0x205)]));});}return _0x49713f;});Promise[_0x294d3d(0x1db)](_0x56bf78)[_0x294d3d(0x1e8)](async _0x5ca835=>{var _0x188a10=_0x294d3d;try{for(const _0x1a25f8 of _0x5ca835){await _0x1a25f8[_0x188a10(0x20a)]();}const _0xd2f0d2=_0x30eca6['product'][_0x188a10(0x24f)](async _0x502d10=>{var _0x21441c=_0x188a10,_0x5b0b50=await warehouse[_0x21441c(0x1d9)]({'name':_0x14ed8e,'room':_0x502d10[_0x21441c(0x1b1)]});if(_0x502d10['to_quantity']>0x0){var _0x2304b9=0x0;const _0x40d499=_0x5b0b50[_0x21441c(0x206)][_0x21441c(0x24f)](_0x4797bf=>{var _0x4412bd=_0x21441c;_0x4797bf[_0x4412bd(0x1f4)]==_0x502d10[_0x4412bd(0x1f4)]&&_0x4797bf[_0x4412bd(0x239)]==_0x502d10['to_bay']&&_0x4797bf[_0x4412bd(0x238)]==_0x502d10['expiry_date']&&_0x4797bf[_0x4412bd(0x1c5)]==_0x502d10['production_date']&&_0x4797bf['batch_code']==_0x502d10[_0x4412bd(0x1fe)]&&_0x4797bf[_0x4412bd(0x212)]==_0x502d10[_0x4412bd(0x1f6)]&&(typeof _0x502d10[_0x4412bd(0x1a3)]=='undefined'?(console[_0x4412bd(0x1d5)]('here2',_0x4797bf['product_stock']+_0x4412bd(0x1b5)+_0x4797bf[_0x4412bd(0x22e)]+_0x4412bd(0x204)+Math[_0x4412bd(0x1ce)](_0x4797bf[_0x4412bd(0x205)])+Math['abs'](_0x502d10['to_quantity'])),_0x4797bf[_0x4412bd(0x205)]=Math[_0x4412bd(0x1ce)](_0x4797bf[_0x4412bd(0x205)])+Math[_0x4412bd(0x1ce)](_0x502d10[_0x4412bd(0x1cc)])):_0x4797bf[_0x4412bd(0x205)]=Math[_0x4412bd(0x1ce)](_0x4797bf[_0x4412bd(0x205)])+Math['abs'](_0x502d10[_0x4412bd(0x1cc)]),_0x2304b9++);});_0x2304b9=='0'&&(_0x5b0b50[_0x21441c(0x206)]=_0x5b0b50[_0x21441c(0x206)][_0x21441c(0x1bc)]({'product_name':_0x502d10[_0x21441c(0x1f4)],'product_stock':_0x502d10[_0x21441c(0x1cc)],'bay':_0x502d10[_0x21441c(0x267)],'level':_0x502d10[_0x21441c(0x224)],'product_code':_0x502d10['product_code'],'primary_code':_0x502d10[_0x21441c(0x1e9)],'secondary_code':_0x502d10[_0x21441c(0x257)],'expiry_date':_0x502d10[_0x21441c(0x238)],'production_date':_0x502d10[_0x21441c(0x1c5)],'maxProducts':_0x502d10[_0x21441c(0x240)],'batch_code':_0x502d10[_0x21441c(0x1fe)],'secondary_unit':_0x502d10[_0x21441c(0x1eb)],'unit':_0x502d10[_0x21441c(0x21a)],'maxProducts':_0x502d10[_0x21441c(0x240)],'maxPerUnit':_0x502d10[_0x21441c(0x1c0)],'invoice':_0x502d10['To_invoice']}));}return _0x5b0b50;});Promise[_0x188a10(0x1db)](_0xd2f0d2)[_0x188a10(0x1e8)](async _0x55b60b=>{var _0x414344=_0x188a10;try{console[_0x414344(0x1d5)](_0x30eca6[_0x414344(0x1be)]);if(_0x30eca6[_0x414344(0x1be)]!='location2location')for(const _0x59301c of _0x55b60b){await warehouse[_0x414344(0x20f)]({'_id':_0x59301c[_0x414344(0x22e)]},{'$addToSet':{'product_details':{'$each':_0x59301c[_0x414344(0x206)]}}});}_0x30eca6[_0x414344(0x1a5)]=_0x414344(0x20d);const _0x11ea45=await _0x30eca6[_0x414344(0x20a)](),_0x3a065e=await master_shop['find'](),_0x54d6dc=await email_settings['findOne'](),_0x3d67b3=await supervisor_settings[_0x414344(0x1fb)]();var _0x3538bd=_0x30eca6[_0x414344(0x209)],_0x392b7c='',_0x560c43;for(_0x560c43 in _0x3538bd){var _0x50da32='FG';_0x30eca6[_0x414344(0x1f8)]=='DRY\x20GOODS'&&(_0x50da32='DG'),_0x392b7c+=_0x414344(0x1fa)+_0x414344(0x1c1)+_0x3538bd[_0x560c43]['product_name']+_0x414344(0x1fd)+_0x414344(0x1c1)+_0x3538bd[_0x560c43][_0x414344(0x1e0)]+_0x414344(0x1fd)+_0x414344(0x1c1)+_0x3538bd[_0x560c43]['to_quantity']+_0x414344(0x1fd)+_0x414344(0x1c1)+_0x3538bd[_0x560c43][_0x414344(0x21a)]+_0x414344(0x1fd)+_0x414344(0x1c1)+_0x3538bd[_0x560c43][_0x414344(0x1eb)]+_0x414344(0x1fd)+_0x414344(0x1c1)+_0x30eca6[_0x414344(0x1f8)]+_0x414344(0x1fd)+_0x414344(0x1c1)+_0x3538bd[_0x560c43][_0x414344(0x1b1)]+_0x414344(0x1fd)+_0x414344(0x1c1)+_0x50da32+_0x3538bd[_0x560c43]['to_bay']+_0x414344(0x1fd)+_0x414344(0x269);}_0x4d656a[_0x414344(0x268)](_0x414344(0x1b2),_0x414344(0x1dd)),_0x5a4858[_0x414344(0x227)](_0x414344(0x254)+_0x11ea45['_id']);}catch(_0x41e5e3){console[_0x414344(0x1ee)](_0x41e5e3),_0x5a4858[_0x414344(0x1ec)](0x1f4)['json']({'error':_0x414344(0x259)});}})[_0x188a10(0x256)](_0x45e025=>{var _0x59dad3=_0x188a10;console[_0x59dad3(0x1ee)](_0x45e025),_0x5a4858[_0x59dad3(0x1ec)](0x1f4)[_0x59dad3(0x1c9)]({'error':_0x59dad3(0x1df)});});}catch(_0x2a1519){console[_0x188a10(0x1ee)](_0x2a1519),_0x5a4858[_0x188a10(0x1ec)](0x1f4)[_0x188a10(0x1c9)]({'error':_0x188a10(0x1e6)});}})['catch'](_0x44137f=>{var _0x48d699=_0x294d3d;console['error'](_0x44137f),_0x5a4858[_0x48d699(0x1ec)](0x1f4)[_0x48d699(0x1c9)]({'error':_0x48d699(0x1df)});});}catch(_0x28a9a8){_0x5a4858[_0x294d3d(0x1c9)]({'message':_0x28a9a8[_0x294d3d(0x226)]});}});function BayBinSelected(_0x450d66,_0x582afb){var _0x2173db=a0_0x49b316,_0x3eb2ec=[];let _0x1a3a8b=[];var _0x12779d=[];if(_0x450d66==_0x2173db(0x23a)){switch(_0x582afb){case _0x2173db(0x1d2):_0x3eb2ec=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x2173db(0x215):_0x3eb2ec=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x12779d=['DG'];}else{if(_0x450d66=='FROZEN\x20GOODS'){switch(_0x582afb){case _0x2173db(0x1d2):_0x3eb2ec=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x3eb2ec=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x12779d=['FG'];}}return{'levels':_0x3eb2ec,'identify':_0x12779d};}router[a0_0x49b316(0x20c)](a0_0x49b316(0x23c),auth,async(_0x5132b6,_0xa7e07b)=>{var _0x27d921=a0_0x49b316;try{const {username:_0xa32613,email:_0x2d037f,role:_0x5bf42b}=_0x5132b6[_0x27d921(0x229)],_0x1e400b=_0x5132b6[_0x27d921(0x229)],_0x42e2b7=await profile['findOne']({'email':_0x1e400b[_0x27d921(0x1d1)]}),_0x3f0670=await master_shop[_0x27d921(0x1fb)](),_0x34ba8a=await transfers_finished['findById'](_0x5132b6[_0x27d921(0x1ab)]['id']);let _0x3ad98a=new Date(_0x34ba8a['expiry_date']),_0x384bd2=('0'+_0x3ad98a[_0x27d921(0x265)]())[_0x27d921(0x1c3)](-0x2),_0x3ed7c8=('0'+(_0x3ad98a[_0x27d921(0x1e4)]()+0x1))[_0x27d921(0x1c3)](-0x2),_0x460670=_0x3ad98a['getFullYear'](),_0x33f65d=_0x460670+'-'+_0x3ed7c8+'-'+_0x384bd2,_0x5a25d9;if(_0x1e400b['role']==_0x27d921(0x202)){const _0x159935=await staff[_0x27d921(0x1d9)]({'email':_0x1e400b[_0x27d921(0x1d1)]});_0x5a25d9=await warehouse[_0x27d921(0x1fb)]({'status':_0x27d921(0x1ff),'name':_0x159935[_0x27d921(0x25d)],'warehouse_category':_0x27d921(0x1c7)});}else _0x5a25d9=await warehouse['find']({'status':_0x27d921(0x1ff),'warehouse_category':_0x27d921(0x1c7)});const _0x3d020a=await warehouse[_0x27d921(0x1bf)]([{'$match':{'name':_0x34ba8a[_0x27d921(0x1b7)],'room':_0x34ba8a[_0x27d921(0x214)]}},{'$unwind':_0x27d921(0x234)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x27d921(0x1de)},'product_stock':{'$first':_0x27d921(0x231)},'bay':{'$first':_0x27d921(0x1d0)},'bin':{'$first':_0x27d921(0x1b6)},'type':{'$first':_0x27d921(0x1a8)},'floorlevel':{'$first':_0x27d921(0x203)},'primary_code':{'$first':_0x27d921(0x1c2)},'secondary_code':{'$first':_0x27d921(0x213)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x27d921(0x208)},'rack':{'$first':'$product_details.rack'}}}]);var _0xa067be=[0x1,0x2,0x3,0x4],_0x3402d0=['A','B','C','D','E','F','G','H','I','J'],_0x16cee2=[_0x27d921(0x1e3),_0x27d921(0x200)];const _0xedfed0=await product[_0x27d921(0x1fb)]({}),_0x2a3811=BayBinSelected(_0x34ba8a[_0x27d921(0x1f8)],_0x34ba8a['to_room']);if(_0x3f0670[0x0][_0x27d921(0x201)]==_0x27d921(0x1f3)){var _0x4afd5e=users[_0x27d921(0x242)];console[_0x27d921(0x1d5)](_0x4afd5e);}else{if(_0x3f0670[0x0]['language']==_0x27d921(0x1fc))var _0x4afd5e=users[_0x27d921(0x1fc)];else{if(_0x3f0670[0x0]['language']=='German')var _0x4afd5e=users[_0x27d921(0x1b8)];else{if(_0x3f0670[0x0][_0x27d921(0x201)]==_0x27d921(0x1b3))var _0x4afd5e=users['Spanish'];else{if(_0x3f0670[0x0][_0x27d921(0x201)]==_0x27d921(0x1b9))var _0x4afd5e=users[_0x27d921(0x1b9)];else{if(_0x3f0670[0x0][_0x27d921(0x201)]==_0x27d921(0x232))var _0x4afd5e=users[_0x27d921(0x22d)];else{if(_0x3f0670[0x0]['language']==_0x27d921(0x25a))var _0x4afd5e=users[_0x27d921(0x25a)];else{if(_0x3f0670[0x0]['language']=='Arabic\x20(ae)')var _0x4afd5e=users[_0x27d921(0x24b)];}}}}}}}_0xa7e07b[_0x27d921(0x1aa)](_0x27d921(0x250),{'success':_0x5132b6[_0x27d921(0x268)](_0x27d921(0x1b2)),'errors':_0x5132b6['flash'](_0x27d921(0x1a4)),'role':_0x1e400b,'profile':_0x42e2b7,'master_shop':_0x3f0670,'warehouse':_0x5a25d9,'transfer':_0x34ba8a,'stock':_0x3d020a,'unit':_0xedfed0,'language':_0x4afd5e,'levels':_0xa067be,'Isle':_0x3402d0,'rooms_data':_0x16cee2,'ed_fullDate':_0x33f65d,'dataSelected':_0x2a3811});}catch(_0x3e6893){console[_0x27d921(0x1d5)](_0x3e6893);}}),router[a0_0x49b316(0x228)](a0_0x49b316(0x23c),auth,async(_0x304b81,_0x120048)=>{var _0x28cdcf=a0_0x49b316;try{const _0x41e98e=_0x304b81[_0x28cdcf(0x1ab)]['id'];console[_0x28cdcf(0x1d5)](_0x304b81[_0x28cdcf(0x23d)]);const _0x2b476a=await transfers_finished[_0x28cdcf(0x1ae)](_0x41e98e);console['log']('transfer_data',_0x2b476a);const {date:_0x3c0e44,from_warehouse:_0x580b39,FromRoom_name:_0x5b1a16,to_warehouse:_0x221e31,ToRoom_name:_0x176903,prod_name:_0x2237e1,from_prod_qty:_0x3c651f,from_prod_level:_0x947ee,from_prod_isle:_0x3ead2b,from_prod_pallet:_0x3d1fa6,to_prod_qty:_0x40e387,to_prod_level:_0x391352,to_prod_isle:_0x17fe11,to_prod_pallet:_0x473177,primary_code:_0x16025c,secondary_code:_0x501d91,product_code3:_0x523fe2,note:_0x1af839,invoice:_0x4d16ed,expiry_date:_0x562670}=_0x304b81[_0x28cdcf(0x23d)];if(typeof _0x2237e1==_0x28cdcf(0x26a))var _0x28f524=[_0x304b81['body'][_0x28cdcf(0x230)]],_0x2715e0=[_0x304b81['body'][_0x28cdcf(0x255)]],_0x5e856b=[_0x304b81[_0x28cdcf(0x23d)]['from_prod_level']],_0xad6607=[_0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x217)]],_0x189f4a=[_0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x1ba)]],_0x2b4295=[_0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x1e9)]],_0x5984b6=[_0x304b81[_0x28cdcf(0x23d)]['secondary_code']],_0x1ce41b=[_0x304b81[_0x28cdcf(0x23d)]['product_code3']],_0x3e65cb=[_0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x210)]],_0x33608f=[_0x304b81[_0x28cdcf(0x23d)]['unit']],_0x278869=[_0x304b81['body'][_0x28cdcf(0x1eb)]],_0x14f17a=[_0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x1fe)]],_0x5f57d1=[_0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x238)]];else var _0x28f524=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x230)]],_0x2715e0=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x255)]],_0x5e856b=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x1bd)]],_0xad6607=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x217)]],_0x189f4a=[..._0x304b81['body'][_0x28cdcf(0x1ba)]],_0x2b4295=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x1e9)]],_0x5984b6=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x257)]],_0x1ce41b=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x222)]],_0x3e65cb=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x210)]],_0x33608f=[..._0x304b81[_0x28cdcf(0x23d)]['unit']],_0x278869=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x1eb)]],_0x14f17a=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x1fe)]],_0x5f57d1=[..._0x304b81[_0x28cdcf(0x23d)][_0x28cdcf(0x238)]];const _0x361e03=_0x28f524[_0x28cdcf(0x24f)](_0x50c7ab=>{return _0x50c7ab={'product_name':_0x50c7ab};});_0x2715e0[_0x28cdcf(0x21d)]((_0x2dfeb1,_0x246118)=>{var _0xc3e1fd=_0x28cdcf;_0x361e03[_0x246118][_0xc3e1fd(0x1d7)]=_0x2dfeb1;}),_0x5e856b[_0x28cdcf(0x21d)]((_0x1252bc,_0x1c4b9f)=>{var _0x20b45d=_0x28cdcf;_0x361e03[_0x1c4b9f][_0x20b45d(0x22b)]=_0x1252bc;}),_0xad6607[_0x28cdcf(0x21d)]((_0xb7137b,_0x139888)=>{var _0x216b08=_0x28cdcf;_0x361e03[_0x139888][_0x216b08(0x1cc)]=_0xb7137b;}),_0x189f4a['forEach']((_0x114442,_0xad48da)=>{var _0x27265d=_0x28cdcf;_0x361e03[_0xad48da][_0x27265d(0x267)]=_0x114442;}),_0x2b4295[_0x28cdcf(0x21d)]((_0x224a90,_0x1ceda5)=>{var _0x1d3b6c=_0x28cdcf;_0x361e03[_0x1ceda5][_0x1d3b6c(0x1e9)]=_0x224a90;}),_0x5984b6[_0x28cdcf(0x21d)]((_0x4aa762,_0x11d282)=>{_0x361e03[_0x11d282]['secondary_code']=_0x4aa762;}),_0x1ce41b[_0x28cdcf(0x21d)]((_0x1429b6,_0x46b994)=>{var _0x34ee81=_0x28cdcf;_0x361e03[_0x46b994][_0x34ee81(0x1e0)]=_0x1429b6;}),_0x3e65cb[_0x28cdcf(0x21d)]((_0x17e0d7,_0x2e6496)=>{_0x361e03[_0x2e6496]['maxProducts']=_0x17e0d7;}),_0x33608f[_0x28cdcf(0x21d)]((_0x34dc24,_0x26aa4f)=>{var _0x5bee92=_0x28cdcf;_0x361e03[_0x26aa4f][_0x5bee92(0x21a)]=_0x34dc24;}),_0x278869[_0x28cdcf(0x21d)]((_0x4b0fe5,_0x3845b5)=>{var _0x261a7f=_0x28cdcf;_0x361e03[_0x3845b5][_0x261a7f(0x1eb)]=_0x4b0fe5;}),_0x14f17a[_0x28cdcf(0x21d)]((_0x2c0c23,_0x49f9c7)=>{var _0x132666=_0x28cdcf;_0x361e03[_0x49f9c7][_0x132666(0x1fe)]=_0x2c0c23;}),_0x5f57d1[_0x28cdcf(0x21d)]((_0x23b78b,_0x280c87)=>{var _0x4ab259=_0x28cdcf;_0x361e03[_0x280c87][_0x4ab259(0x238)]=_0x23b78b;});const _0x417d0a=_0x361e03[_0x28cdcf(0x1cf)](_0x489bf3=>_0x489bf3['to_quantity']!=='0'&&_0x489bf3['to_quantity']!==''||_0x489bf3[_0x28cdcf(0x253)]!=='0'&&_0x489bf3['to_floorlevel']!=='');var _0x92348b=0x0;_0x417d0a[_0x28cdcf(0x21d)](_0x2cd92c=>{var _0x333da9=_0x28cdcf;parseInt(_0x2cd92c[_0x333da9(0x1d7)])<parseInt(_0x2cd92c[_0x333da9(0x1cc)])&&_0x92348b++;});if(_0x92348b!=0x0)return _0x304b81[_0x28cdcf(0x268)](_0x28cdcf(0x1a4),_0x28cdcf(0x1a2)),_0x120048[_0x28cdcf(0x227)]('back');const _0x290c2d=await warehouse[_0x28cdcf(0x1d9)]({'name':_0x2b476a[_0x28cdcf(0x1b7)],'room':_0x2b476a[_0x28cdcf(0x214)]});_0x2b476a[_0x28cdcf(0x209)][_0x28cdcf(0x21d)](_0x319a8e=>{var _0x289c9b=_0x28cdcf;if(_0x319a8e['to_quantity']>0x0){const _0x427927=_0x290c2d[_0x289c9b(0x206)][_0x289c9b(0x24f)](_0x4229c3=>{var _0x28658f=_0x289c9b;_0x4229c3[_0x28658f(0x1f4)]==_0x319a8e['product_name']&&_0x4229c3[_0x28658f(0x239)]==_0x319a8e[_0x28658f(0x22b)]&&(_0x4229c3['product_stock']=parseInt(_0x4229c3[_0x28658f(0x205)])+parseInt(_0x319a8e['to_quantity']));});}}),await _0x290c2d[_0x28cdcf(0x20a)]();const _0x3b7d98=await warehouse[_0x28cdcf(0x1d9)]({'name':_0x2b476a[_0x28cdcf(0x1f8)],'room':_0x2b476a['to_room']});_0x2b476a[_0x28cdcf(0x209)]['forEach'](_0x1c022d=>{var _0x399dd7=_0x28cdcf;if(_0x1c022d[_0x399dd7(0x1cc)]>0x0){const _0x59c659=_0x3b7d98[_0x399dd7(0x206)][_0x399dd7(0x24f)](_0x3f30bf=>{var _0x490c89=_0x399dd7;_0x3f30bf[_0x490c89(0x1f4)]==_0x1c022d[_0x490c89(0x1f4)]&&_0x3f30bf[_0x490c89(0x239)]==_0x1c022d[_0x490c89(0x267)]&&(_0x3f30bf[_0x490c89(0x205)]=parseInt(_0x3f30bf[_0x490c89(0x205)])-parseInt(_0x1c022d[_0x490c89(0x1cc)]));});}}),await _0x3b7d98[_0x28cdcf(0x20a)](),_0x2b476a['date']=_0x3c0e44,_0x2b476a['from_warehouse']=_0x580b39,_0x2b476a[_0x28cdcf(0x1f8)]=_0x221e31,_0x2b476a[_0x28cdcf(0x209)]=_0x417d0a,_0x2b476a['note']=_0x1af839,_0x2b476a[_0x28cdcf(0x212)]=_0x4d16ed;const _0x53368e=await _0x2b476a[_0x28cdcf(0x20a)](),_0x6a97da=await warehouse['findOne']({'name':_0x580b39,'room':_0x5b1a16});_0x53368e[_0x28cdcf(0x209)]['forEach'](_0x1617bd=>{var _0x33c49e=_0x28cdcf;if(_0x1617bd[_0x33c49e(0x1cc)]>0x0){const _0xe869a9=_0x6a97da['product_details'][_0x33c49e(0x24f)](_0x5bf8b0=>{var _0x2bb317=_0x33c49e;_0x5bf8b0[_0x2bb317(0x1f4)]==_0x1617bd[_0x2bb317(0x1f4)]&&_0x5bf8b0[_0x2bb317(0x239)]==_0x1617bd[_0x2bb317(0x22b)]&&(_0x5bf8b0[_0x2bb317(0x205)]=parseInt(_0x5bf8b0[_0x2bb317(0x205)])-parseInt(_0x1617bd[_0x2bb317(0x1cc)]));});}}),await _0x6a97da[_0x28cdcf(0x20a)]();const _0x3bc528=await warehouse[_0x28cdcf(0x1d9)]({'name':_0x221e31,'room':_0x176903});_0x53368e['product'][_0x28cdcf(0x21d)](_0xdea4be=>{var _0x5241e5=_0x28cdcf;if(_0xdea4be[_0x5241e5(0x1cc)]>0x0){var _0x3216fa=0x0;const _0x2dc7c5=_0x3bc528[_0x5241e5(0x206)][_0x5241e5(0x24f)](_0x14fbf9=>{var _0x50ef19=_0x5241e5;_0x14fbf9[_0x50ef19(0x1f4)]==_0xdea4be[_0x50ef19(0x1f4)]&&_0x14fbf9[_0x50ef19(0x239)]==_0xdea4be[_0x50ef19(0x267)]&&(_0x14fbf9['product_stock']=parseInt(_0x14fbf9[_0x50ef19(0x205)])+parseInt(_0xdea4be[_0x50ef19(0x1cc)]),_0x3216fa++);});_0x3216fa=='0'&&(_0x3bc528[_0x5241e5(0x206)]=_0x3bc528[_0x5241e5(0x206)][_0x5241e5(0x1bc)]({'product_name':_0xdea4be['product_name'],'product_stock':_0xdea4be['to_quantity'],'bay':_0xdea4be[_0x5241e5(0x267)],'product_code':_0xdea4be[_0x5241e5(0x1e0)],'primary_code':_0xdea4be[_0x5241e5(0x1e9)],'secondary_code':_0xdea4be['secondary_code'],'maxProducts':_0xdea4be[_0x5241e5(0x240)]}));}}),await _0x3bc528[_0x28cdcf(0x20a)](),_0x304b81['flash'](_0x28cdcf(0x1b2),'Transfer\x20Edit\x20Successfully'),_0x120048[_0x28cdcf(0x227)](_0x28cdcf(0x218));}catch(_0x4be0e6){console[_0x28cdcf(0x1d5)](_0x4be0e6);}}),router[a0_0x49b316(0x228)](a0_0x49b316(0x1f7),async(_0x5de17b,_0x26e596)=>{var _0x32d5f7=a0_0x49b316;const {FromWareHouse:_0x154385,FromRoom:_0x48cdce,ToWarehouse:_0x4ecf4a,ToRoom:_0x4f1da6,primary_code:_0x65399,Roomslist:_0x227cfb}=_0x5de17b[_0x32d5f7(0x23d)],_0xf4a723=_0x227cfb[_0x32d5f7(0x1a9)](','),_0x44ae6c=[];async function _0x597866(_0x53b377){var _0x45872d=_0x32d5f7;const _0x448c94=await warehouse['aggregate']([{'$match':{'name':_0x154385,'room':_0x53b377}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x65399}},{'$group':{'_id':_0x45872d(0x216),'name':{'$first':_0x45872d(0x1de)},'instock':{'$first':_0x45872d(0x231)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x45872d(0x213)},'product_code':{'$first':_0x45872d(0x248)},'bay':{'$first':_0x45872d(0x1d0)},'level':{'$first':_0x45872d(0x1d3)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x45872d(0x203)},'unit':{'$first':_0x45872d(0x1d4)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x45872d(0x208)},'rack':{'$first':_0x45872d(0x211)},'expiry_date':{'$first':_0x45872d(0x24c)},'production_date':{'$first':_0x45872d(0x1dc)},'batch_code':{'$first':_0x45872d(0x252)},'maxPerUnit':{'$first':_0x45872d(0x24e)},'roomNamed':{'$first':_0x45872d(0x22a)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x45872d(0x235)}}}]),_0x1bd568=await warehouse[_0x45872d(0x1bf)]([{'$match':{'name':_0x154385,'room':_0x53b377}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x65399}},{'$group':{'_id':_0x45872d(0x216),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x45872d(0x231)},'primary_code':{'$first':_0x45872d(0x1c2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x45872d(0x248)},'bay':{'$first':_0x45872d(0x1d0)},'level':{'$first':_0x45872d(0x1d3)},'type':{'$first':_0x45872d(0x1a8)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x45872d(0x1d4)},'secondary_unit':{'$first':_0x45872d(0x20b)},'storage':{'$first':_0x45872d(0x208)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x45872d(0x24c)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x45872d(0x252)},'maxPerUnit':{'$first':_0x45872d(0x24e)},'roomNamed':{'$first':_0x45872d(0x22a)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x45872d(0x235)}}}]);if(_0x448c94[_0x45872d(0x233)]>0x0)_0x44ae6c[_0x45872d(0x24d)](_0x448c94);else _0x1bd568[_0x45872d(0x233)]>0x0&&_0x44ae6c[_0x45872d(0x24d)](_0x1bd568);}const _0x2d51c4=_0xf4a723[_0x32d5f7(0x24f)](_0x3b60fe=>_0x597866(_0x3b60fe));await Promise['all'](_0x2d51c4),_0x26e596[_0x32d5f7(0x1c9)](_0x44ae6c);}),router[a0_0x49b316(0x228)](a0_0x49b316(0x207),async(_0x43234b,_0x2f0c99)=>{var _0x1fa4bf=a0_0x49b316;const {productCode:_0x4726c6,bay:_0xdff002,warehouses:_0x164899,room:_0x3dc4a7}=_0x43234b[_0x1fa4bf(0x23d)];console[_0x1fa4bf(0x1d5)](_0x43234b[_0x1fa4bf(0x23d)]);try{const _0x1707a9=await warehouse[_0x1fa4bf(0x1bf)]([{'$match':{'name':_0x164899,'room':_0x3dc4a7}},{'$unwind':_0x1fa4bf(0x234)},{'$match':{'product_details.bay':parseInt(_0xdff002)}},{'$group':{'_id':_0x1fa4bf(0x216),'name':{'$first':_0x1fa4bf(0x1de)},'product_stock':{'$first':_0x1fa4bf(0x231)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2f0c99[_0x1fa4bf(0x1ec)](0xc8)[_0x1fa4bf(0x1c9)](_0x1707a9);}catch(_0x2677ad){_0x2f0c99[_0x1fa4bf(0x1ec)](0x194)[_0x1fa4bf(0x1c9)]({'message':_0x2677ad[_0x1fa4bf(0x226)]});}}),module[a0_0x49b316(0x1cb)]=router;function a0_0xf332(){var _0x50e97a=['</tr>','string','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','id_transaction','errors','finalize','prod_cat','from_prod_level2','$product_details.type','split','render','params','TRFF-','logs','findById','/transfer_finished/preview/','from_invoice','to_room_name','success','Spanish','Product\x20Transfer\x20successfully','\x20<>\x20','$product_details.bin','from_warehouse','German','French','to_prod_level','$finalize','concat','from_prod_level','type_of_process','aggregate','maxPerUnit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.primary_code','slice','random','production_date','role','Finished\x20Goods','TRF-','json','$name','exports','to_quantity','from_room_name','abs','filter','$product_details.bay','email','Rack\x201','$product_details.level','$product_details.unit','log','There\x27s\x20a\x20error\x20in\x20this\x20transaction','from_quantity','floor','findOne','/view/choose_logs','all','$product_details.production_date','Transfer\x20Finalize\x20Successfully','$product_details.product_name','An\x20error\x20occurred.','product_code','74qcLJln','/preview/:id','Ambient','getMonth','MaxStocks_data','An\x20error\x20occurred\x20while\x20saving\x20data.','/view/add_transfer','then','primary_code','invoice_init','secondary_unit','status','back','error','../middleware/auth','/transfer/view','padStart','/view/add_transfer_logs','English\x20(US)','product_name','primary_unit','To_invoice','/barcode_scanner','to_warehouse','/view','<tr>','find','Hindi','</td>','batch_code','Enabled','Enclosed','language','staff','$product_details.floorlevel','\x20<=>\x20','product_stock','product_details','/CheckingWarehouse','$product_details.storage','product','save','$product_details.secondary_unit','get','True','nodemailer','updateOne','MaxStocks_data2','$product_details.rack','invoice','$product_details.secondary_code','from_room','Rack\x202','$product_details._id','to_prod_qty','/transfer_finished/view','443014ujyVmf','unit','match','$product.from_room_name','forEach','12EvyCoq','choos_transfer_logs','$product','3177XCPdMC','product_code3','/view/add_transfer_loc','to_level','RoomAssigned','message','redirect','post','user','$room','from_bay','Arabic\x20(ae)','Portuguese','_id','133297SeKjhY','prod_name','$product_details.product_stock','Portuguese\x20(BR)','length','$product_details','$product_details.invoice','../public/language/languages.json','$from_warehouse','expiry_date','bay','DRY\x20GOODS','Router','/view/:id','body','product_date','choos_transfer','maxProducts','from_level','English','../models/all_models','ToRoomAssigned','69657bRzakq','$to_warehouse','234460sPybUC','$product_details.product_code','/view/addlog','location2location','Arabic','$product_details.expiry_date','push','$product_details.maxPerUnit','map','edit_transfer_finished','18JZYtjU','$product_details.batch_code','to_floorlevel','/picking_list/PDF_transfer/','from_prod_qty','catch','secondary_code','$date','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','Chinese','LOG-TRF-','364085AjlTct','warehouse','12904vBoKlw','973903DdskDd','own','/view/choose','$product.to_room_name','toString','transfer_finished_logs','getDate','New_Qty_Converted','to_bay','flash'];a0_0xf332=function(){return _0x50e97a;};return a0_0xf332();}