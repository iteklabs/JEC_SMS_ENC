var a0_0x194685=a0_0x102f;function a0_0x3262(){var _0x1eac3c=['TRFF-','to_room','errors','product_code3','/view/choose_logs','own','role','/transfer_finished/preview/','407165AxYKAp','$product_details.bay','$to_warehouse','/view/choose','Ambient','$finalize','secondary_unit','64947bQNOPi','/view/:id','error','from_level','json','success','DRY\x20GOODS','432oPvYaO','$product_details.batch_code','warehouse','8581740hfSvmq','product_name','$product_details._id','get','email','redirect','$product_details.expiry_date','38CuDeXc','production_date','LOG-TRF-','$room','$product_details.product_name','forEach','$product_details.production_date','primary_code','id_transaction','/CheckingWarehouse','$product_details','English\x20(US)','from_prod_qty','/view/add_transfer_loc','$product_details.secondary_code','user','prod_name','Portuguese\x20(BR)','from_room_name','$product_details.product_stock','_id','German','transfer_finished','48hCLuXw','to_prod_qty','76755TmhNQh','note','Arabic','$product_details.type','toString','to_quantity','from_quantity','\x20<>\x20','Spanish','back','save','Arabic\x20(ae)','/picking_list/PDF_transfer/','/transfer_finished/view','655036xXfvZw','edit_transfer_finished','bay','maxProducts','from_warehouse','Rack\x201','staff','5sMfQbZ','type_of_process','MaxStocks_data','$product.from_room_name','padStart','string','body','findOne','$product_details.invoice','status','English','</td>','random','$product_details.maxProducts','$product','logs','$_id','An\x20error\x20occurred.','product_date','$invoice','getDate','Finished\x20Goods','Transfer\x20Finalize\x20Successfully','push','maxPerUnit','product_stock','unit','updateOne','split','finalize','language','$product_details.bin','slice','$date','to_bay','Router','length','log','To_invoice','TRF-','to_room_name','batch_code','Chinese','Rack\x202','$product_details.rack','bin2bin','filter','New_Qty_Converted','findById','Hindi','post','catch','then','all','from_invoice','map','product_code','match','<tr>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.primary_code','product','Product\x20Transfer\x20successfully','from_prod_level2','prod_cat','$product.to_room_name','message','from_bay','RoomAssigned','$product_details.unit','711783nolroy','choos_transfer','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','edit_transfer_finished_view','abs','to_prod_level','params','/view/add_transfer','here2','getMonth','aggregate','/view/addlog','MaxStocks_data2','invoice_init','product_details','An\x20error\x20occurred\x20while\x20saving\x20data.','$name','4522456vRiwXl','$product_details.maxPerUnit','location2location','primary_unit','../public/language/languages.json','concat','</tr>','\x20<=>\x20','to_level','Enabled','/transfer/view','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Portuguese','ToRoomAssigned','$product_details.product_code','max','render','from_prod_level','540UWaAAB','$from_warehouse','to_floorlevel','$product_details.secondary_unit','$product_details.storage','flash','$product_details.floorlevel','secondary_code','/view/add_transfer_logs','transfer_data','to_warehouse','expiry_date','French','find','$product_details.level','True'];a0_0x3262=function(){return _0x1eac3c;};return a0_0x3262();}(function(_0x503881,_0xd9ca91){var _0x40d8b7=a0_0x102f,_0x252936=_0x503881();while(!![]){try{var _0x34bc3a=parseInt(_0x40d8b7(0x1a3))/0x1+parseInt(_0x40d8b7(0x243))/0x2*(-parseInt(_0x40d8b7(0x232))/0x3)+parseInt(_0x40d8b7(0x201))/0x4*(parseInt(_0x40d8b7(0x1aa))/0x5)+-parseInt(_0x40d8b7(0x213))/0x6*(-parseInt(_0x40d8b7(0x25c))/0x7)+parseInt(_0x40d8b7(0x25a))/0x8*(parseInt(_0x40d8b7(0x1f0))/0x9)+-parseInt(_0x40d8b7(0x23c))/0xa+-parseInt(_0x40d8b7(0x22b))/0xb*(parseInt(_0x40d8b7(0x239))/0xc);if(_0x34bc3a===_0xd9ca91)break;else _0x252936['push'](_0x252936['shift']());}catch(_0x2c1b3c){_0x252936['push'](_0x252936['shift']());}}}(a0_0x3262,0x9d771));const express=require('express'),app=express(),router=express[a0_0x194685(0x1cd)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x194685(0x205)),nodemailer=require('nodemailer');router['get']('/view',auth,async(_0x42d43c,_0x111710)=>{var _0x1cb00=a0_0x194685;try{const {username:_0x530793,email:_0x23abe5,role:_0x3181f8}=_0x42d43c[_0x1cb00(0x252)],_0x54ac20=_0x42d43c[_0x1cb00(0x252)],_0x1f5998=await profile[_0x1cb00(0x1b1)]({'email':_0x54ac20['email']}),_0x3fc538=await master_shop[_0x1cb00(0x220)]();let _0x2cb56e;if(_0x54ac20[_0x1cb00(0x229)]=='staff'){const _0x4b2579=await staff[_0x1cb00(0x1b1)]({'email':_0x54ac20[_0x1cb00(0x240)]});_0x2cb56e=await transfers_finished[_0x1cb00(0x220)]({'from_warehouse':_0x4b2579[_0x1cb00(0x23b)]});}else _0x2cb56e=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x1cb00(0x228)}},{'$unwind':_0x1cb00(0x1b8)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1cb00(0x1bd)},'date':{'$first':_0x1cb00(0x1cb)},'from_warehouse':{'$first':_0x1cb00(0x214)},'to_warehouse':{'$first':_0x1cb00(0x22d)},'from_room_name':{'$addToSet':_0x1cb00(0x1ad)},'to_room_name':{'$addToSet':_0x1cb00(0x1eb)},'finalize':{'$first':_0x1cb00(0x230)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3fc538[0x0]['language']==_0x1cb00(0x24e))var _0x6ababf=users['English'];else{if(_0x3fc538[0x0]['language']=='Hindi')var _0x6ababf=users[_0x1cb00(0x1db)];else{if(_0x3fc538[0x0][_0x1cb00(0x1c8)]==_0x1cb00(0x258))var _0x6ababf=users[_0x1cb00(0x258)];else{if(_0x3fc538[0x0][_0x1cb00(0x1c8)]==_0x1cb00(0x19d))var _0x6ababf=users[_0x1cb00(0x19d)];else{if(_0x3fc538[0x0][_0x1cb00(0x1c8)]=='French')var _0x6ababf=users[_0x1cb00(0x21f)];else{if(_0x3fc538[0x0][_0x1cb00(0x1c8)]==_0x1cb00(0x254))var _0x6ababf=users[_0x1cb00(0x20d)];else{if(_0x3fc538[0x0][_0x1cb00(0x1c8)]==_0x1cb00(0x1d4))var _0x6ababf=users[_0x1cb00(0x1d4)];else{if(_0x3fc538[0x0][_0x1cb00(0x1c8)]=='Arabic\x20(ae)')var _0x6ababf=users[_0x1cb00(0x197)];}}}}}}}_0x111710[_0x1cb00(0x211)](_0x1cb00(0x259),{'success':_0x42d43c[_0x1cb00(0x218)](_0x1cb00(0x237)),'errors':_0x42d43c[_0x1cb00(0x218)](_0x1cb00(0x225)),'role':_0x54ac20,'profile':_0x1f5998,'master_shop':_0x3fc538,'transfer':_0x2cb56e,'language':_0x6ababf});}catch(_0x18d463){console[_0x1cb00(0x1cf)](_0x18d463);}}),router['get']('/view_logs',auth,async(_0x29f312,_0x51d18c)=>{var _0x2fe8c1=a0_0x194685;try{const {username:_0x2bd402,email:_0x537cab,role:_0x3c857d}=_0x29f312[_0x2fe8c1(0x252)],_0x5db4c1=_0x29f312[_0x2fe8c1(0x252)],_0x2a9303=await profile['findOne']({'email':_0x5db4c1[_0x2fe8c1(0x240)]}),_0x45eef4=await master_shop['find']();let _0x48a573;if(_0x5db4c1[_0x2fe8c1(0x229)]==_0x2fe8c1(0x1a9)){const _0x5200bb=await staff[_0x2fe8c1(0x1b1)]({'email':_0x5db4c1[_0x2fe8c1(0x240)]});_0x48a573=await transfers_finished['find']({'from_warehouse':_0x5200bb[_0x2fe8c1(0x23b)]});}else _0x48a573=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x2fe8c1(0x1b9)}},{'$unwind':_0x2fe8c1(0x1b8)},{'$group':{'_id':_0x2fe8c1(0x1ba),'invoice':{'$first':_0x2fe8c1(0x1bd)},'date':{'$first':_0x2fe8c1(0x1cb)},'from_warehouse':{'$first':_0x2fe8c1(0x214)},'to_warehouse':{'$first':_0x2fe8c1(0x22d)},'from_room_name':{'$addToSet':_0x2fe8c1(0x1ad)},'to_room_name':{'$addToSet':_0x2fe8c1(0x1eb)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x45eef4[0x0][_0x2fe8c1(0x1c8)]==_0x2fe8c1(0x24e))var _0x2aca82=users['English'];else{if(_0x45eef4[0x0]['language']==_0x2fe8c1(0x1db))var _0x2aca82=users[_0x2fe8c1(0x1db)];else{if(_0x45eef4[0x0]['language']=='German')var _0x2aca82=users[_0x2fe8c1(0x258)];else{if(_0x45eef4[0x0][_0x2fe8c1(0x1c8)]==_0x2fe8c1(0x19d))var _0x2aca82=users[_0x2fe8c1(0x19d)];else{if(_0x45eef4[0x0]['language']==_0x2fe8c1(0x21f))var _0x2aca82=users[_0x2fe8c1(0x21f)];else{if(_0x45eef4[0x0][_0x2fe8c1(0x1c8)]==_0x2fe8c1(0x254))var _0x2aca82=users['Portuguese'];else{if(_0x45eef4[0x0][_0x2fe8c1(0x1c8)]==_0x2fe8c1(0x1d4))var _0x2aca82=users['Chinese'];else{if(_0x45eef4[0x0]['language']==_0x2fe8c1(0x1a0))var _0x2aca82=users[_0x2fe8c1(0x197)];}}}}}}}_0x51d18c[_0x2fe8c1(0x211)]('transfer_finished_logs',{'success':_0x29f312[_0x2fe8c1(0x218)](_0x2fe8c1(0x237)),'errors':_0x29f312[_0x2fe8c1(0x218)](_0x2fe8c1(0x225)),'role':_0x5db4c1,'profile':_0x2a9303,'master_shop':_0x45eef4,'transfer':_0x48a573,'language':_0x2aca82});}catch(_0x2d77f9){console['log'](_0x2d77f9);}});function a0_0x102f(_0x3d907a,_0x1da23b){var _0x3262d5=a0_0x3262();return a0_0x102f=function(_0x102f53,_0x10491f){_0x102f53=_0x102f53-0x197;var _0x13740e=_0x3262d5[_0x102f53];return _0x13740e;},a0_0x102f(_0x3d907a,_0x1da23b);}async function getRandom8DigitNumber(){var _0x4ccbfc=a0_0x194685;const _0x5d972c=0x989680,_0x4bd1bc=0x5f5e0ff,_0x524aee=Math['floor'](Math[_0x4ccbfc(0x1b6)]()*(_0x4bd1bc-_0x5d972c+0x1))+_0x5d972c;var _0x1ba039;const _0x354c07=await transfers_finished[_0x4ccbfc(0x1b1)]({'invoice':_0x4ccbfc(0x223)+_0x524aee});return _0x354c07&&_0x354c07[_0x4ccbfc(0x1ce)]>0x0?_0x1ba039='TRFF-'+_0x524aee:_0x1ba039=_0x4ccbfc(0x223)+_0x524aee,_0x1ba039;}router[a0_0x194685(0x23f)](a0_0x194685(0x1f7),auth,async(_0x26a39f,_0x14cbf4)=>{var _0x37bfb8=a0_0x194685;try{const {username:_0x54367c,email:_0x54a67a,role:_0x331141}=_0x26a39f[_0x37bfb8(0x252)],_0x4e6f65=_0x26a39f[_0x37bfb8(0x252)],_0x1a9509=await profile[_0x37bfb8(0x1b1)]({'email':_0x4e6f65[_0x37bfb8(0x240)]}),_0x18a51e=await master_shop[_0x37bfb8(0x220)]();let _0x576679;if(_0x4e6f65[_0x37bfb8(0x229)]==_0x37bfb8(0x1a9)){const _0x48b597=await staff['findOne']({'email':_0x4e6f65['email']});_0x576679=await warehouse[_0x37bfb8(0x1fa)]([{'$match':{'status':'Enabled','name':_0x48b597['warehouse']}},{'$group':{'_id':_0x37bfb8(0x200),'name':{'$first':_0x37bfb8(0x200)}}}]);}else _0x576679=await warehouse['aggregate']([{'$match':{'status':_0x37bfb8(0x20a)}},{'$group':{'_id':_0x37bfb8(0x200),'name':{'$first':_0x37bfb8(0x200)}}}]);const _0x588aef=await transfers_finished['find']({}),_0xcda6f0=_0x588aef[_0x37bfb8(0x1ce)]+0x1,_0x5436a1=_0x37bfb8(0x223)+_0xcda6f0[_0x37bfb8(0x199)]()[_0x37bfb8(0x1ae)](0x5,'0');if(_0x18a51e[0x0][_0x37bfb8(0x1c8)]=='English\x20(US)')var _0x13ab7b=users['English'];else{if(_0x18a51e[0x0]['language']=='Hindi')var _0x13ab7b=users['Hindi'];else{if(_0x18a51e[0x0][_0x37bfb8(0x1c8)]==_0x37bfb8(0x258))var _0x13ab7b=users[_0x37bfb8(0x258)];else{if(_0x18a51e[0x0]['language']==_0x37bfb8(0x19d))var _0x13ab7b=users[_0x37bfb8(0x19d)];else{if(_0x18a51e[0x0][_0x37bfb8(0x1c8)]==_0x37bfb8(0x21f))var _0x13ab7b=users[_0x37bfb8(0x21f)];else{if(_0x18a51e[0x0][_0x37bfb8(0x1c8)]=='Portuguese\x20(BR)')var _0x13ab7b=users[_0x37bfb8(0x20d)];else{if(_0x18a51e[0x0][_0x37bfb8(0x1c8)]==_0x37bfb8(0x1d4))var _0x13ab7b=users[_0x37bfb8(0x1d4)];else{if(_0x18a51e[0x0][_0x37bfb8(0x1c8)]==_0x37bfb8(0x1a0))var _0x13ab7b=users[_0x37bfb8(0x197)];}}}}}}}const _0x122e25=getRandom8DigitNumber();_0x122e25[_0x37bfb8(0x1de)](_0x4d6b7d=>{var _0x4b5972=_0x37bfb8;_0x14cbf4[_0x4b5972(0x211)]('add_transfer_finished',{'success':_0x26a39f[_0x4b5972(0x218)]('success'),'errors':_0x26a39f['flash'](_0x4b5972(0x225)),'role':_0x4e6f65,'profile':_0x1a9509,'master_shop':_0x18a51e,'warehouse':_0x576679,'language':_0x13ab7b,'invoice':_0x4d6b7d});})[_0x37bfb8(0x1dd)](_0x56a5bd=>{var _0x179cde=_0x37bfb8;_0x26a39f[_0x179cde(0x218)](_0x179cde(0x225),_0x179cde(0x20c)),_0x14cbf4[_0x179cde(0x241)](_0x179cde(0x20b));});}catch(_0x285071){console[_0x37bfb8(0x1cf)](_0x285071);}}),router[a0_0x194685(0x23f)](a0_0x194685(0x22e),auth,async(_0x388807,_0x3292dc)=>{var _0x4c7e85=a0_0x194685;try{const {username:_0x40891f,email:_0x3fd1d7,role:_0x4257bb}=_0x388807[_0x4c7e85(0x252)],_0x4eb46d=_0x388807['user'],_0x13bf4e=await profile[_0x4c7e85(0x1b1)]({'email':_0x4eb46d['email']}),_0x3ff821=await master_shop[_0x4c7e85(0x220)]();let _0x48566b;if(_0x4eb46d[_0x4c7e85(0x229)]==_0x4c7e85(0x1a9)){const _0x1f5ba1=await staff['findOne']({'email':_0x4eb46d[_0x4c7e85(0x240)]});_0x48566b=await warehouse['aggregate']([{'$match':{'status':_0x4c7e85(0x20a),'name':_0x1f5ba1[_0x4c7e85(0x23b)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x48566b=await warehouse[_0x4c7e85(0x1fa)]([{'$match':{'status':_0x4c7e85(0x20a)}},{'$group':{'_id':_0x4c7e85(0x200),'name':{'$first':'$name'}}}]);const _0x5d86d9=await transfers_finished[_0x4c7e85(0x220)]({}),_0x561389=_0x5d86d9[_0x4c7e85(0x1ce)]+0x1,_0x3e7cde='TRFF-'+_0x561389['toString']()[_0x4c7e85(0x1ae)](0x5,'0');if(_0x3ff821[0x0][_0x4c7e85(0x1c8)]==_0x4c7e85(0x24e))var _0x33eacf=users[_0x4c7e85(0x1b4)];else{if(_0x3ff821[0x0][_0x4c7e85(0x1c8)]==_0x4c7e85(0x1db))var _0x33eacf=users[_0x4c7e85(0x1db)];else{if(_0x3ff821[0x0]['language']==_0x4c7e85(0x258))var _0x33eacf=users[_0x4c7e85(0x258)];else{if(_0x3ff821[0x0][_0x4c7e85(0x1c8)]=='Spanish')var _0x33eacf=users[_0x4c7e85(0x19d)];else{if(_0x3ff821[0x0][_0x4c7e85(0x1c8)]=='French')var _0x33eacf=users[_0x4c7e85(0x21f)];else{if(_0x3ff821[0x0]['language']==_0x4c7e85(0x254))var _0x33eacf=users['Portuguese'];else{if(_0x3ff821[0x0][_0x4c7e85(0x1c8)]==_0x4c7e85(0x1d4))var _0x33eacf=users[_0x4c7e85(0x1d4)];else{if(_0x3ff821[0x0]['language']=='Arabic\x20(ae)')var _0x33eacf=users['Arabic'];}}}}}}}const _0x57f9b0=getRandom8DigitNumber();_0x57f9b0[_0x4c7e85(0x1de)](_0x5ad96b=>{var _0x5dc49e=_0x4c7e85;_0x3292dc['render'](_0x5dc49e(0x1f1),{'success':_0x388807[_0x5dc49e(0x218)](_0x5dc49e(0x237)),'errors':_0x388807['flash'](_0x5dc49e(0x225)),'role':_0x4eb46d,'profile':_0x13bf4e,'master_shop':_0x3ff821,'warehouse':_0x48566b,'language':_0x33eacf,'invoice':_0x5ad96b});})[_0x4c7e85(0x1dd)](_0x23af7c=>{var _0x20defb=_0x4c7e85;_0x388807['flash'](_0x20defb(0x225),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x3292dc[_0x20defb(0x241)](_0x20defb(0x20b));});}catch(_0x5b6719){console['log'](_0x5b6719);}}),router['get'](a0_0x194685(0x227),auth,async(_0x5d7113,_0x26d15d)=>{var _0x1b579f=a0_0x194685;try{const {username:_0x29a6e9,email:_0x8f1524,role:_0x3e495c}=_0x5d7113[_0x1b579f(0x252)],_0x34e4dd=_0x5d7113[_0x1b579f(0x252)],_0x5b25c6=await profile['findOne']({'email':_0x34e4dd['email']}),_0x10ae68=await master_shop[_0x1b579f(0x220)]();let _0x4daa5b;if(_0x34e4dd[_0x1b579f(0x229)]==_0x1b579f(0x1a9)){const _0x375813=await staff[_0x1b579f(0x1b1)]({'email':_0x34e4dd[_0x1b579f(0x240)]});_0x4daa5b=await warehouse[_0x1b579f(0x1fa)]([{'$match':{'status':'Enabled','name':_0x375813[_0x1b579f(0x23b)]}},{'$group':{'_id':_0x1b579f(0x200),'name':{'$first':_0x1b579f(0x200)}}}]);}else _0x4daa5b=await warehouse[_0x1b579f(0x1fa)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x1b579f(0x200),'name':{'$first':_0x1b579f(0x200)}}}]);const _0x12b525=await transfers_finished[_0x1b579f(0x220)]({}),_0x1c865b=_0x12b525[_0x1b579f(0x1ce)]+0x1,_0x2ad147=_0x1b579f(0x223)+_0x1c865b['toString']()['padStart'](0x5,'0');if(_0x10ae68[0x0][_0x1b579f(0x1c8)]==_0x1b579f(0x24e))var _0x161cec=users[_0x1b579f(0x1b4)];else{if(_0x10ae68[0x0][_0x1b579f(0x1c8)]==_0x1b579f(0x1db))var _0x161cec=users[_0x1b579f(0x1db)];else{if(_0x10ae68[0x0][_0x1b579f(0x1c8)]==_0x1b579f(0x258))var _0x161cec=users[_0x1b579f(0x258)];else{if(_0x10ae68[0x0][_0x1b579f(0x1c8)]==_0x1b579f(0x19d))var _0x161cec=users['Spanish'];else{if(_0x10ae68[0x0][_0x1b579f(0x1c8)]=='French')var _0x161cec=users[_0x1b579f(0x21f)];else{if(_0x10ae68[0x0]['language']=='Portuguese\x20(BR)')var _0x161cec=users[_0x1b579f(0x20d)];else{if(_0x10ae68[0x0][_0x1b579f(0x1c8)]==_0x1b579f(0x1d4))var _0x161cec=users['Chinese'];else{if(_0x10ae68[0x0][_0x1b579f(0x1c8)]==_0x1b579f(0x1a0))var _0x161cec=users[_0x1b579f(0x197)];}}}}}}}const _0x51580f=getRandom8DigitNumber();_0x51580f[_0x1b579f(0x1de)](_0x4b997a=>{var _0x4a45f7=_0x1b579f;_0x26d15d[_0x4a45f7(0x211)]('choos_transfer_logs',{'success':_0x5d7113['flash'](_0x4a45f7(0x237)),'errors':_0x5d7113[_0x4a45f7(0x218)]('errors'),'role':_0x34e4dd,'profile':_0x5b25c6,'master_shop':_0x10ae68,'warehouse':_0x4daa5b,'language':_0x161cec,'invoice':_0x4b997a});})[_0x1b579f(0x1dd)](_0x2cffb4=>{var _0x2114f9=_0x1b579f;_0x5d7113[_0x2114f9(0x218)](_0x2114f9(0x225),_0x2114f9(0x20c)),_0x26d15d[_0x2114f9(0x241)]('/transfer/view');});}catch(_0x26b141){console[_0x1b579f(0x1cf)](_0x26b141);}}),router[a0_0x194685(0x1dc)](a0_0x194685(0x21b),auth,async(_0x9d31de,_0x4e324e)=>{var _0x1760ef=a0_0x194685;try{const {date:_0x26eb10,from_warehouse:_0x136dc3,FromRoom_name:_0x2bbe25,to_warehouse:_0x30d72b,ToRoom_name:_0x2c7765,prod_name:_0x2e73f4,from_prod_qty:_0x50ba70,from_prod_level:_0x466743,from_prod_isle:_0x48bb10,from_prod_pallet:_0x5a021c,to_prod_qty:_0xc9c6ee,to_prod_level:_0x15b24e,to_prod_isle:_0x3d41bb,to_prod_pallet:_0x109724,primary_code:_0x3744f4,secondary_code:_0x25cab2,product_code3:_0x565185,note:_0x10e179,MaxStocks_data2:_0x4895e7,invoice:_0x25506e,expiry_date:_0x17fddf,PO_number:_0x383c1e,ReqBy:_0x3501f2,dateofreq:_0x47bd4b,typeservicesData:_0x4ce55c,destination:_0x4eca52,deliverydate:_0x4cc72a,driver:_0x32fdcc,plate:_0x5dcc86,van:_0x26887d,DRSI:_0x4a3ac9,typevehicle:_0x4dc928,TSU:_0x45771a,TFU:_0x510b36}=_0x9d31de[_0x1760ef(0x1b0)];if(typeof _0x2e73f4==_0x1760ef(0x1af))var _0x5e9a3e=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x253)]],_0x2e2a00=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x24f)]],_0x5e6889=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1e9)]],_0x395eb8=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1d9)]],_0x14ae35=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1f5)]],_0xbbb045=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x24a)]],_0x33e121=[_0x9d31de['body'][_0x1760ef(0x21a)]],_0x41cfde=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x226)]],_0x52a2fe=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1fc)]],_0x587989=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x204)]],_0x312ed3=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x231)]],_0x5181ce=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1d3)]],_0x2eff39=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x21e)]],_0x3ea0fe=[_0x9d31de['body']['product_date']],_0x21769f=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1ac)]],_0x3dcd74=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1c2)]],_0x187127=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1ea)]],_0x1d8818=[_0x9d31de[_0x1760ef(0x1b0)]['RoomAssigned']],_0x1f6714=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x20e)]],_0x208706=[_0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1e0)]],_0x362d85=[_0x9d31de['body'][_0x1760ef(0x24b)]];else var _0x5e9a3e=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x253)]],_0x2e2a00=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x24f)]],_0x5e6889=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1e9)]],_0x395eb8=[..._0x9d31de[_0x1760ef(0x1b0)]['New_Qty_Converted']],_0x14ae35=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1f5)]],_0xbbb045=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x24a)]],_0x33e121=[..._0x9d31de['body']['secondary_code']],_0x41cfde=[..._0x9d31de[_0x1760ef(0x1b0)]['product_code3']],_0x52a2fe=[..._0x9d31de[_0x1760ef(0x1b0)]['MaxStocks_data2']],_0x587989=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x204)]],_0x312ed3=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x231)]],_0x5181ce=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1d3)]],_0x2eff39=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x21e)]],_0x3ea0fe=[..._0x9d31de['body']['product_date']],_0x21769f=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1ac)]],_0x3dcd74=[..._0x9d31de['body'][_0x1760ef(0x1c2)]],_0x187127=[..._0x9d31de['body'][_0x1760ef(0x1ea)]],_0x1d8818=[..._0x9d31de[_0x1760ef(0x1b0)]['RoomAssigned']],_0x1f6714=[..._0x9d31de[_0x1760ef(0x1b0)]['ToRoomAssigned']],_0x208706=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x1e0)]],_0x362d85=[..._0x9d31de[_0x1760ef(0x1b0)][_0x1760ef(0x24b)]];const _0x4cdccb=_0x5e9a3e['map'](_0x5d6401=>{return _0x5d6401={'product_name':_0x5d6401};});_0x2e2a00[_0x1760ef(0x248)]((_0x130ba2,_0x52db25)=>{var _0xfb209c=_0x1760ef;_0x4cdccb[_0x52db25][_0xfb209c(0x19b)]=_0x130ba2;}),_0x5e6889[_0x1760ef(0x248)]((_0x11ddfc,_0x38a50a)=>{var _0x5eab91=_0x1760ef,_0x395f20=_0x11ddfc[_0x5eab91(0x1e3)](/[A-Za-z]+/)[0x0],_0x21e0e4=parseInt(_0x11ddfc[_0x5eab91(0x1e3)](/\d+/)[0x0]);_0x4cdccb[_0x38a50a]['from_bay']=_0x21e0e4,_0x4cdccb[_0x38a50a][_0x5eab91(0x235)]=_0x395f20;}),_0x362d85[_0x1760ef(0x248)]((_0x1d8369,_0x57113c)=>{var _0x4db107=_0x1760ef;_0x4cdccb[_0x57113c][_0x4db107(0x24b)]=_0x1d8369;}),_0x208706[_0x1760ef(0x248)]((_0xe7dbf3,_0x4caab0)=>{var _0x4d0da6=_0x1760ef;_0x4cdccb[_0x4caab0][_0x4d0da6(0x1e0)]=_0xe7dbf3;}),_0x395eb8[_0x1760ef(0x248)]((_0x391166,_0x37085a)=>{var _0x6ac2fc=_0x1760ef;_0x4cdccb[_0x37085a][_0x6ac2fc(0x19a)]=_0x391166;}),_0x14ae35[_0x1760ef(0x248)]((_0x47a4dd,_0x32ecd6)=>{var _0x515fa5=_0x1760ef,_0x3d4068=_0x47a4dd['match'](/[A-Za-z]+/)[0x0],_0x57e16c=parseInt(_0x47a4dd['match'](/\d+/)[0x0]);_0x4cdccb[_0x32ecd6][_0x515fa5(0x209)]=_0x3d4068,_0x4cdccb[_0x32ecd6][_0x515fa5(0x1cc)]=_0x57e16c;}),_0xbbb045[_0x1760ef(0x248)]((_0x13c079,_0x360317)=>{_0x4cdccb[_0x360317]['primary_code']=_0x13c079;}),_0x33e121[_0x1760ef(0x248)]((_0x398d63,_0x47035b)=>{var _0x3320ae=_0x1760ef;_0x4cdccb[_0x47035b][_0x3320ae(0x21a)]=_0x398d63;}),_0x41cfde['forEach']((_0x4a6791,_0x5905e6)=>{var _0x321142=_0x1760ef;_0x4cdccb[_0x5905e6][_0x321142(0x1e2)]=_0x4a6791;}),_0x52a2fe['forEach']((_0x540671,_0x18e138)=>{var _0x11ade7=_0x1760ef;_0x4cdccb[_0x18e138][_0x11ade7(0x1a6)]=_0x540671;}),_0x587989[_0x1760ef(0x248)]((_0xb13422,_0x24f17a)=>{var _0x2c9744=_0x1760ef;_0x4cdccb[_0x24f17a][_0x2c9744(0x1c4)]=_0xb13422;}),_0x312ed3[_0x1760ef(0x248)]((_0x2737ad,_0x3c00b2)=>{var _0x1b7c53=_0x1760ef;_0x4cdccb[_0x3c00b2][_0x1b7c53(0x231)]=_0x2737ad;}),_0x5181ce['forEach']((_0x3b96fe,_0x7e1552)=>{var _0x4c2990=_0x1760ef;_0x4cdccb[_0x7e1552][_0x4c2990(0x1d3)]=_0x3b96fe;}),_0x2eff39[_0x1760ef(0x248)]((_0x216903,_0x8fba53)=>{var _0x282cc8=_0x1760ef;_0x4cdccb[_0x8fba53][_0x282cc8(0x21e)]=_0x216903;}),_0x3ea0fe[_0x1760ef(0x248)]((_0x5209a9,_0x16dcf3)=>{var _0x40a22f=_0x1760ef;_0x4cdccb[_0x16dcf3][_0x40a22f(0x244)]=_0x5209a9;}),_0x21769f[_0x1760ef(0x248)]((_0x297712,_0x35dedf)=>{var _0xe4f9ee=_0x1760ef;_0x4cdccb[_0x35dedf][_0xe4f9ee(0x1a6)]=_0x297712;}),_0x3dcd74[_0x1760ef(0x248)]((_0x1e14a6,_0x2e47b7)=>{var _0x1c488e=_0x1760ef;_0x4cdccb[_0x2e47b7][_0x1c488e(0x1c2)]=_0x1e14a6;}),_0x187127[_0x1760ef(0x248)]((_0x39e104,_0x68f515)=>{var _0x392545=_0x1760ef;_0x4cdccb[_0x68f515][_0x392545(0x1ea)]=_0x39e104;}),_0x1d8818['forEach']((_0x3aa9ae,_0xa7b82b)=>{var _0x5e431f=_0x1760ef;_0x4cdccb[_0xa7b82b][_0x5e431f(0x255)]=_0x3aa9ae;}),_0x1f6714['forEach']((_0x505156,_0x12b951)=>{var _0x17eeac=_0x1760ef;_0x4cdccb[_0x12b951][_0x17eeac(0x1d2)]=_0x505156;});const _0x6a2a51=_0x4cdccb['filter'](_0x29609b=>_0x29609b[_0x1760ef(0x19a)]!=='0'&&_0x29609b[_0x1760ef(0x19a)]!==''||_0x29609b[_0x1760ef(0x215)]!=='0'&&_0x29609b[_0x1760ef(0x215)]!=='');var _0x101d4e=0x0;_0x6a2a51[_0x1760ef(0x248)](_0x54b07d=>{var _0x53eca6=_0x1760ef;parseInt(_0x54b07d[_0x53eca6(0x19b)])<parseInt(_0x54b07d[_0x53eca6(0x19a)])&&_0x101d4e++;});if(_0x101d4e!=0x0)return _0x9d31de[_0x1760ef(0x218)](_0x1760ef(0x225),_0x1760ef(0x1e5)),_0x4e324e[_0x1760ef(0x241)](_0x1760ef(0x19e));const _0x13a09c=new transfers_logs();await _0x13a09c[_0x1760ef(0x19f)]();for(let _0x85fc2=0x0;_0x85fc2<=_0x1f6714[_0x1760ef(0x1ce)]-0x1;_0x85fc2++){_0x4cdccb[_0x85fc2][_0x1760ef(0x1d0)]=_0x1760ef(0x245)+_0x13a09c['invoice_init'][_0x1760ef(0x199)]()['padStart'](0x8,'0');}const _0x1f717d=new transfers_finished({'date':_0x26eb10,'from_warehouse':_0x136dc3,'to_warehouse':_0x136dc3,'product':_0x6a2a51,'note':_0x10e179,'invoice':'LOG-TRF-'+_0x13a09c[_0x1760ef(0x1fd)]['toString']()[_0x1760ef(0x1ae)](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x1760ef(0x1b9),'PO_number':_0x383c1e,'RequestedBy':_0x3501f2,'DateofRequest':_0x47bd4b,'typeservices':_0x4ce55c,'destination':_0x4eca52,'deliverydate':_0x4cc72a,'driver':_0x32fdcc,'plate':_0x5dcc86,'van':_0x26887d,'DRSI':_0x4a3ac9,'typevehicle':_0x4dc928,'TSU':_0x45771a,'TFU':_0x510b36}),_0x32b6fc=await _0x1f717d[_0x1760ef(0x19f)]();_0x9d31de['flash'](_0x1760ef(0x237),_0x1760ef(0x1e8)),_0x4e324e['redirect'](_0x1760ef(0x22a)+_0x32b6fc[_0x1760ef(0x257)]);}catch(_0x100dcb){console['log'](_0x100dcb),_0x4e324e[_0x1760ef(0x1b3)](0xc8)[_0x1760ef(0x236)]({'errorMessage':_0x100dcb[_0x1760ef(0x1ec)]});}}),router[a0_0x194685(0x1dc)](a0_0x194685(0x1fb),auth,async(_0x47e55c,_0x51f850)=>{var _0x5484e2=a0_0x194685;try{const {date:_0x231344,from_warehouse:_0x4e1e88,FromRoom_name:_0x3be07d,to_warehouse:_0x119a9d,ToRoom_name:_0x32624c,prod_name:_0x2deb3f,from_prod_qty:_0x18b09b,from_prod_level:_0x4296eb,from_prod_isle:_0x408aba,from_prod_pallet:_0x5bf47a,to_prod_qty:_0x3ada1c,to_prod_level:_0xaea456,to_prod_isle:_0x3f6ced,to_prod_pallet:_0x47985d,primary_code:_0x42b3b7,secondary_code:_0x28d586,product_code3:_0x15a07e,note:_0xc0424e,MaxStocks_data2:_0x3d660f,invoice:_0x1fd598,expiry_date:_0x23bc67,PO_number_loc:_0x6a07e7,ReqBy_loc:_0x269547,dateofreq_loc:_0x3b17f6,typeservices_loc_Data:_0x207212,destination_loc:_0x37cf5a,deliverydate_loc:_0x1fcdcd,driver_loc:_0x24b174,plate_loc:_0x229736,van_loc:_0x5e0c8e,DRSI_loc:_0x52920e,typevehicle_loc:_0x3e099b,TSU_loc:_0x38cced,TFU_loc:_0x24795e}=_0x47e55c[_0x5484e2(0x1b0)];if(typeof _0x2deb3f==_0x5484e2(0x1af))var _0xb44a44=[_0x47e55c['body'][_0x5484e2(0x253)]],_0x50f2c2=[_0x47e55c[_0x5484e2(0x1b0)]['from_prod_qty']],_0x3f0078=[_0x47e55c[_0x5484e2(0x1b0)]['from_prod_level2']],_0x287e7a=[_0x47e55c[_0x5484e2(0x1b0)]['New_Qty_Converted']],_0x512502=[_0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1f5)]],_0x4cfdc2=[_0x47e55c['body'][_0x5484e2(0x24a)]],_0x3ef79c=[_0x47e55c['body']['secondary_code']],_0x30873d=[_0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x226)]],_0x4c6e71=[_0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1fc)]],_0x2fad5a=[_0x47e55c[_0x5484e2(0x1b0)]['primary_unit']],_0x52db71=[_0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x231)]],_0x5e93f0=[_0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1d3)]],_0x41ad02=[_0x47e55c[_0x5484e2(0x1b0)]['expiry_date']],_0x5d554c=[_0x47e55c['body'][_0x5484e2(0x1bc)]],_0x46887f=[_0x47e55c['body'][_0x5484e2(0x1ac)]],_0x261a9f=[_0x47e55c['body'][_0x5484e2(0x1c2)]],_0x5e21de=[_0x47e55c[_0x5484e2(0x1b0)]['prod_cat']],_0x13c57e=[_0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1ee)]],_0x28e407=[_0x47e55c['body']['ToRoomAssigned']],_0x41912d=[_0x47e55c['body']['from_invoice']],_0x2d9799=[_0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x24b)]];else var _0xb44a44=[..._0x47e55c['body'][_0x5484e2(0x253)]],_0x50f2c2=[..._0x47e55c['body']['from_prod_qty']],_0x3f0078=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1e9)]],_0x287e7a=[..._0x47e55c['body'][_0x5484e2(0x1d9)]],_0x512502=[..._0x47e55c['body'][_0x5484e2(0x1f5)]],_0x4cfdc2=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x24a)]],_0x3ef79c=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x21a)]],_0x30873d=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x226)]],_0x4c6e71=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1fc)]],_0x2fad5a=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x204)]],_0x52db71=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x231)]],_0x5e93f0=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1d3)]],_0x41ad02=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x21e)]],_0x5d554c=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1bc)]],_0x46887f=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1ac)]],_0x261a9f=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1c2)]],_0x5e21de=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1ea)]],_0x13c57e=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1ee)]],_0x28e407=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x20e)]],_0x41912d=[..._0x47e55c[_0x5484e2(0x1b0)][_0x5484e2(0x1e0)]],_0x2d9799=[..._0x47e55c['body']['id_transaction']];const _0x5e8ad6=_0xb44a44['map'](_0x5d803e=>{return _0x5d803e={'product_name':_0x5d803e};});_0x50f2c2[_0x5484e2(0x248)]((_0x480099,_0x1c7175)=>{_0x5e8ad6[_0x1c7175]['from_quantity']=_0x480099;}),_0x3f0078['forEach']((_0xe143b4,_0x1e4a2d)=>{var _0x52ab36=_0x5484e2,_0x2c46ec=_0xe143b4[_0x52ab36(0x1e3)](/[A-Za-z]+/)[0x0],_0xed6b38=parseInt(_0xe143b4['match'](/\d+/)[0x0]);_0x5e8ad6[_0x1e4a2d][_0x52ab36(0x1ed)]=_0xed6b38,_0x5e8ad6[_0x1e4a2d][_0x52ab36(0x235)]=_0x2c46ec;}),_0x2d9799[_0x5484e2(0x248)]((_0x48ce85,_0x3e173f)=>{var _0x543075=_0x5484e2;_0x5e8ad6[_0x3e173f][_0x543075(0x24b)]=_0x48ce85;}),_0x41912d[_0x5484e2(0x248)]((_0x1f5537,_0x769fce)=>{var _0x1d28fa=_0x5484e2;_0x5e8ad6[_0x769fce][_0x1d28fa(0x1e0)]=_0x1f5537;}),_0x287e7a[_0x5484e2(0x248)]((_0x2d5e91,_0x2c0858)=>{_0x5e8ad6[_0x2c0858]['to_quantity']=_0x2d5e91;}),_0x512502[_0x5484e2(0x248)]((_0x1cdb3e,_0x1f3ed5)=>{var _0x522795=_0x5484e2,_0x5552ed=_0x1cdb3e[_0x522795(0x1e3)](/[A-Za-z]+/)[0x0],_0x27d237=parseInt(_0x1cdb3e[_0x522795(0x1e3)](/\d+/)[0x0]);_0x5e8ad6[_0x1f3ed5][_0x522795(0x209)]=_0x5552ed,_0x5e8ad6[_0x1f3ed5][_0x522795(0x1cc)]=_0x27d237;}),_0x4cfdc2['forEach']((_0x2b2cba,_0x6ddc14)=>{var _0x3db100=_0x5484e2;_0x5e8ad6[_0x6ddc14][_0x3db100(0x24a)]=_0x2b2cba;}),_0x3ef79c[_0x5484e2(0x248)]((_0x2e4b17,_0x55e72d)=>{var _0x56a038=_0x5484e2;_0x5e8ad6[_0x55e72d][_0x56a038(0x21a)]=_0x2e4b17;}),_0x30873d[_0x5484e2(0x248)]((_0xdab719,_0x30dac5)=>{var _0x3586b0=_0x5484e2;_0x5e8ad6[_0x30dac5][_0x3586b0(0x1e2)]=_0xdab719;}),_0x4c6e71[_0x5484e2(0x248)]((_0x240479,_0x5e564b)=>{var _0x25760e=_0x5484e2;_0x5e8ad6[_0x5e564b][_0x25760e(0x1a6)]=_0x240479;}),_0x2fad5a[_0x5484e2(0x248)]((_0x532398,_0x2456ab)=>{var _0x53e8c2=_0x5484e2;_0x5e8ad6[_0x2456ab][_0x53e8c2(0x1c4)]=_0x532398;}),_0x52db71['forEach']((_0xb66ac7,_0xf8bb90)=>{_0x5e8ad6[_0xf8bb90]['secondary_unit']=_0xb66ac7;}),_0x5e93f0[_0x5484e2(0x248)]((_0x5a1c72,_0x403067)=>{var _0x374f76=_0x5484e2;_0x5e8ad6[_0x403067][_0x374f76(0x1d3)]=_0x5a1c72;}),_0x41ad02[_0x5484e2(0x248)]((_0x4f6483,_0x43f862)=>{var _0x1f1404=_0x5484e2;_0x5e8ad6[_0x43f862][_0x1f1404(0x21e)]=_0x4f6483;}),_0x5d554c[_0x5484e2(0x248)]((_0x5d0f44,_0x3b8d1d)=>{var _0x11e738=_0x5484e2;_0x5e8ad6[_0x3b8d1d][_0x11e738(0x244)]=_0x5d0f44;}),_0x46887f['forEach']((_0x3dc9e5,_0x37bab6)=>{var _0x202712=_0x5484e2;_0x5e8ad6[_0x37bab6][_0x202712(0x1a6)]=_0x3dc9e5;}),_0x261a9f['forEach']((_0x1f0627,_0x48a02f)=>{var _0x3a907e=_0x5484e2;_0x5e8ad6[_0x48a02f][_0x3a907e(0x1c2)]=_0x1f0627;}),_0x5e21de[_0x5484e2(0x248)]((_0x5e11f0,_0x5a03f8)=>{var _0x31c380=_0x5484e2;_0x5e8ad6[_0x5a03f8][_0x31c380(0x1ea)]=_0x5e11f0;}),_0x13c57e['forEach']((_0x3ed7d6,_0x552ee1)=>{_0x5e8ad6[_0x552ee1]['from_room_name']=_0x3ed7d6;}),_0x28e407[_0x5484e2(0x248)]((_0x485171,_0x577da7)=>{var _0x13da82=_0x5484e2;_0x5e8ad6[_0x577da7][_0x13da82(0x1d2)]=_0x485171;});const _0x2cda3f=_0x5e8ad6['filter'](_0x5eeeed=>_0x5eeeed[_0x5484e2(0x19a)]!=='0'&&_0x5eeeed[_0x5484e2(0x19a)]!==''||_0x5eeeed[_0x5484e2(0x215)]!=='0'&&_0x5eeeed[_0x5484e2(0x215)]!=='');var _0x462191=0x0;_0x2cda3f[_0x5484e2(0x248)](_0x2b67a6=>{var _0x41f1c4=_0x5484e2;parseInt(_0x2b67a6[_0x41f1c4(0x19b)])<parseInt(_0x2b67a6[_0x41f1c4(0x19a)])&&_0x462191++;});if(_0x462191!=0x0)return _0x47e55c[_0x5484e2(0x218)]('errors',_0x5484e2(0x1e5)),_0x51f850[_0x5484e2(0x241)](_0x5484e2(0x19e));const _0x5d0d28=new transfers_logs();await _0x5d0d28[_0x5484e2(0x19f)]();for(let _0x2d4b8e=0x0;_0x2d4b8e<=_0x28e407[_0x5484e2(0x1ce)]-0x1;_0x2d4b8e++){_0x5e8ad6[_0x2d4b8e]['To_invoice']=_0x5484e2(0x245)+_0x5d0d28['invoice_init'][_0x5484e2(0x199)]()[_0x5484e2(0x1ae)](0x8,'0');}const _0x54b65c=new transfers_finished({'date':_0x231344,'from_warehouse':_0x4e1e88,'to_warehouse':_0x119a9d,'product':_0x2cda3f,'note':_0xc0424e,'invoice':'LOG-TRF-'+_0x5d0d28[_0x5484e2(0x1fd)]['toString']()[_0x5484e2(0x1ae)](0x8,'0'),'type_of_transaction':'logs','type_of_process':_0x5484e2(0x203),'PO_number':_0x6a07e7,'RequestedBy':_0x269547,'DateofRequest':_0x3b17f6,'typeservices':_0x207212,'destination':_0x37cf5a,'deliverydate':_0x1fcdcd,'driver':_0x24b174,'plate':_0x229736,'van':_0x5e0c8e,'DRSI':_0x52920e,'typevehicle':_0x3e099b,'TSU':_0x38cced,'TFU':_0x24795e}),_0x467a07=await _0x54b65c[_0x5484e2(0x19f)]();_0x47e55c[_0x5484e2(0x218)](_0x5484e2(0x237),_0x5484e2(0x1e8)),_0x51f850[_0x5484e2(0x241)](_0x5484e2(0x22a)+_0x467a07['_id']);}catch(_0x5d4250){console[_0x5484e2(0x1cf)](_0x5d4250),_0x51f850[_0x5484e2(0x1b3)](0xc8)[_0x5484e2(0x236)]({'errorMessage':_0x5d4250[_0x5484e2(0x1ec)]});}}),router[a0_0x194685(0x1dc)]('/view/add_transfer',auth,async(_0x41517f,_0x42538c)=>{var _0x445a94=a0_0x194685;try{const {date:_0x478034,from_warehouse:_0x6606b3,FromRoom_name:_0x229a73,to_warehouse:_0xafcf3c,ToRoom_name:_0x1853b9,prod_name:_0x28baf1,from_prod_qty:_0x447de3,from_prod_level:_0x327e77,from_prod_isle:_0x58f584,from_prod_pallet:_0x10f50d,to_prod_qty:_0x194c78,to_prod_level:_0x3d8b56,to_prod_isle:_0x511df6,to_prod_pallet:_0x12006a,primary_code:_0x455d73,secondary_code:_0x5b4479,product_code3:_0x4e9461,note:_0x426397,MaxStocks_data2:_0x2d9926,invoice:_0x319baf,expiry_date:_0x1eb232,PO_number:_0x30d7c6,ReqBy:_0x3dd414,dateofreq:_0x24a95f,typeservicesData:_0x146d04,destination:_0x4ddcbb,deliverydate:_0x314a8c,driver:_0x32a85d,plate:_0xd8c275,van:_0x3065e0,DRSI:_0x3975c8,typevehicle:_0x85758b,TSU:_0x94dca5,TFU:_0x19e495}=_0x41517f['body'];if(typeof _0x28baf1==_0x445a94(0x1af))var _0xd87b91=[_0x41517f[_0x445a94(0x1b0)]['prod_name']],_0x532973=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x24f)]],_0x6c547c=[_0x41517f[_0x445a94(0x1b0)]['from_prod_level2']],_0x52f3c9=[_0x41517f['body'][_0x445a94(0x1d9)]],_0x286747=[_0x41517f[_0x445a94(0x1b0)]['to_prod_level']],_0x1102ab=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x24a)]],_0x49e183=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x21a)]],_0x13c68f=[_0x41517f[_0x445a94(0x1b0)]['product_code3']],_0x48cf0e=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1fc)]],_0x555318=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x204)]],_0x4d34c8=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x231)]],_0x57fca4=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1d3)]],_0x2c525e=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x21e)]],_0x5a86e4=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1bc)]],_0x140ae8=[_0x41517f['body']['MaxStocks_data']],_0x4ce891=[_0x41517f[_0x445a94(0x1b0)]['maxPerUnit']],_0xe01f48=[_0x41517f[_0x445a94(0x1b0)]['prod_cat']],_0x46b385=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1ee)]],_0x2dfa56=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x20e)]],_0x1fac6f=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1e0)]],_0x3ddf95=[_0x41517f[_0x445a94(0x1b0)][_0x445a94(0x24b)]];else var _0xd87b91=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x253)]],_0x532973=[..._0x41517f['body'][_0x445a94(0x24f)]],_0x6c547c=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1e9)]],_0x52f3c9=[..._0x41517f[_0x445a94(0x1b0)]['New_Qty_Converted']],_0x286747=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1f5)]],_0x1102ab=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x24a)]],_0x49e183=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x21a)]],_0x13c68f=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x226)]],_0x48cf0e=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1fc)]],_0x555318=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x204)]],_0x4d34c8=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x231)]],_0x57fca4=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1d3)]],_0x2c525e=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x21e)]],_0x5a86e4=[..._0x41517f['body'][_0x445a94(0x1bc)]],_0x140ae8=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1ac)]],_0x4ce891=[..._0x41517f[_0x445a94(0x1b0)]['maxPerUnit']],_0xe01f48=[..._0x41517f[_0x445a94(0x1b0)]['prod_cat']],_0x46b385=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1ee)]],_0x2dfa56=[..._0x41517f['body'][_0x445a94(0x20e)]],_0x1fac6f=[..._0x41517f[_0x445a94(0x1b0)][_0x445a94(0x1e0)]],_0x3ddf95=[..._0x41517f['body']['id_transaction']];const _0x16bbfc=_0xd87b91[_0x445a94(0x1e1)](_0x4cf2e1=>{return _0x4cf2e1={'product_name':_0x4cf2e1};});_0x532973[_0x445a94(0x248)]((_0x185274,_0x56cf23)=>{var _0x4cf148=_0x445a94;_0x16bbfc[_0x56cf23][_0x4cf148(0x19b)]=_0x185274;}),_0x6c547c[_0x445a94(0x248)]((_0x5c882e,_0x2744ed)=>{var _0x44bdf0=_0x445a94,_0x2d52df=_0x5c882e['match'](/[A-Za-z]+/)[0x0],_0xcc3277=parseInt(_0x5c882e['match'](/\d+/)[0x0]);_0x16bbfc[_0x2744ed][_0x44bdf0(0x1ed)]=_0xcc3277,_0x16bbfc[_0x2744ed][_0x44bdf0(0x235)]=_0x2d52df;}),_0x3ddf95[_0x445a94(0x248)]((_0x444258,_0x13a4e8)=>{var _0x3cd17a=_0x445a94;_0x16bbfc[_0x13a4e8][_0x3cd17a(0x24b)]=_0x444258;}),_0x1fac6f[_0x445a94(0x248)]((_0x8b96d,_0x2bad00)=>{var _0x154af8=_0x445a94;_0x16bbfc[_0x2bad00][_0x154af8(0x1e0)]=_0x8b96d;}),_0x52f3c9['forEach']((_0x3ae30c,_0x3ee819)=>{var _0x54d707=_0x445a94;_0x16bbfc[_0x3ee819][_0x54d707(0x19a)]=_0x3ae30c;}),_0x286747['forEach']((_0x479947,_0x173b2f)=>{var _0x5f1a5d=_0x445a94,_0x5a848f=_0x479947[_0x5f1a5d(0x1e3)](/[A-Za-z]+/)[0x0],_0x204647=parseInt(_0x479947[_0x5f1a5d(0x1e3)](/\d+/)[0x0]);_0x16bbfc[_0x173b2f][_0x5f1a5d(0x209)]=_0x5a848f,_0x16bbfc[_0x173b2f]['to_bay']=_0x204647;}),_0x1102ab['forEach']((_0x4fc65e,_0x412278)=>{var _0x3feaf3=_0x445a94;_0x16bbfc[_0x412278][_0x3feaf3(0x24a)]=_0x4fc65e;}),_0x49e183[_0x445a94(0x248)]((_0x537299,_0x48c314)=>{_0x16bbfc[_0x48c314]['secondary_code']=_0x537299;}),_0x13c68f['forEach']((_0x11da7c,_0x35f63b)=>{var _0xcef979=_0x445a94;_0x16bbfc[_0x35f63b][_0xcef979(0x1e2)]=_0x11da7c;}),_0x48cf0e['forEach']((_0xc4ba43,_0x3f1aed)=>{var _0x369a68=_0x445a94;_0x16bbfc[_0x3f1aed][_0x369a68(0x1a6)]=_0xc4ba43;}),_0x555318['forEach']((_0x33cf6f,_0x176edb)=>{var _0xb104bd=_0x445a94;_0x16bbfc[_0x176edb][_0xb104bd(0x1c4)]=_0x33cf6f;}),_0x4d34c8['forEach']((_0x544bcd,_0x181453)=>{var _0x467289=_0x445a94;_0x16bbfc[_0x181453][_0x467289(0x231)]=_0x544bcd;}),_0x57fca4[_0x445a94(0x248)]((_0x46d7a1,_0x16c968)=>{var _0x30d214=_0x445a94;_0x16bbfc[_0x16c968][_0x30d214(0x1d3)]=_0x46d7a1;}),_0x2c525e[_0x445a94(0x248)]((_0x396259,_0x3f2c4c)=>{var _0x31d6de=_0x445a94;_0x16bbfc[_0x3f2c4c][_0x31d6de(0x21e)]=_0x396259;}),_0x5a86e4[_0x445a94(0x248)]((_0x58764f,_0x5577a1)=>{var _0x1726f3=_0x445a94;_0x16bbfc[_0x5577a1][_0x1726f3(0x244)]=_0x58764f;}),_0x140ae8[_0x445a94(0x248)]((_0x479b87,_0x3847e8)=>{_0x16bbfc[_0x3847e8]['maxProducts']=_0x479b87;}),_0x4ce891[_0x445a94(0x248)]((_0xabfd6c,_0x145923)=>{var _0x3315e6=_0x445a94;_0x16bbfc[_0x145923][_0x3315e6(0x1c2)]=_0xabfd6c;}),_0xe01f48[_0x445a94(0x248)]((_0x24d744,_0x3741c9)=>{var _0x41a423=_0x445a94;_0x16bbfc[_0x3741c9][_0x41a423(0x1ea)]=_0x24d744;}),_0x46b385[_0x445a94(0x248)]((_0x5e3db8,_0x184912)=>{var _0x425e49=_0x445a94;_0x16bbfc[_0x184912][_0x425e49(0x255)]=_0x5e3db8;}),_0x2dfa56[_0x445a94(0x248)]((_0x57cfd3,_0x51104e)=>{_0x16bbfc[_0x51104e]['to_room_name']=_0x57cfd3;});const _0x49435d=_0x16bbfc[_0x445a94(0x1d8)](_0x5d4400=>_0x5d4400[_0x445a94(0x19a)]!=='0'&&_0x5d4400[_0x445a94(0x19a)]!==''||_0x5d4400[_0x445a94(0x215)]!=='0'&&_0x5d4400[_0x445a94(0x215)]!=='');var _0x167aaf=0x0;_0x49435d[_0x445a94(0x248)](_0x8ee91f=>{var _0x288caf=_0x445a94;parseInt(_0x8ee91f['from_quantity'])<parseInt(_0x8ee91f[_0x288caf(0x19a)])&&_0x167aaf++;});if(_0x167aaf!=0x0)return _0x41517f[_0x445a94(0x218)](_0x445a94(0x225),_0x445a94(0x1e5)),_0x42538c[_0x445a94(0x241)](_0x445a94(0x19e));const _0x317832=new invoice_for_transfer();await _0x317832[_0x445a94(0x19f)]();for(let _0x202cf1=0x0;_0x202cf1<=_0x2dfa56[_0x445a94(0x1ce)]-0x1;_0x202cf1++){_0x16bbfc[_0x202cf1][_0x445a94(0x1d0)]='TRF-'+_0x317832[_0x445a94(0x1fd)][_0x445a94(0x199)]()[_0x445a94(0x1ae)](0x8,'0');}const _0x90fd53=new transfers_finished({'date':_0x478034,'from_warehouse':_0x6606b3,'to_warehouse':_0x6606b3,'product':_0x49435d,'note':_0x426397,'invoice':_0x445a94(0x1d1)+_0x317832[_0x445a94(0x1fd)][_0x445a94(0x199)]()[_0x445a94(0x1ae)](0x8,'0'),'type_of_process':_0x445a94(0x1d7),'type_of_transaction':_0x445a94(0x228),'PO_number':_0x30d7c6,'RequestedBy':_0x3dd414,'DateofRequest':_0x24a95f,'typeservices':_0x146d04,'destination':_0x4ddcbb,'deliverydate':_0x314a8c,'driver':_0x32a85d,'plate':_0xd8c275,'van':_0x3065e0,'DRSI':_0x3975c8,'typevehicle':_0x85758b,'TSU':_0x94dca5,'TFU':_0x19e495}),_0x3aabce=await _0x90fd53[_0x445a94(0x19f)]();_0x41517f[_0x445a94(0x218)](_0x445a94(0x237),_0x445a94(0x1e8)),_0x42538c[_0x445a94(0x241)](_0x445a94(0x22a)+_0x3aabce[_0x445a94(0x257)]);}catch(_0x599e84){console['log'](_0x599e84),_0x42538c[_0x445a94(0x1b3)](0xc8)['json']({'errorMessage':_0x599e84[_0x445a94(0x1ec)]});}}),router[a0_0x194685(0x1dc)](a0_0x194685(0x250),auth,async(_0x3b29de,_0x46a37f)=>{var _0x2ea402=a0_0x194685;try{const {date:_0x263ab7,from_warehouse:_0x3fe788,FromRoom_name:_0x1df090,to_warehouse:_0x3b90ea,ToRoom_name:_0x1fe211,prod_name:_0x317975,from_prod_qty:_0x5136ed,from_prod_level:_0xd0d89d,from_prod_isle:_0x5404f1,from_prod_pallet:_0x45a47c,to_prod_qty:_0x783ba1,to_prod_level:_0x2f7f6b,to_prod_isle:_0x76a66f,to_prod_pallet:_0x37673d,primary_code:_0x14c191,secondary_code:_0x4b49bc,product_code3:_0x116386,note:_0x163168,MaxStocks_data2:_0x4db11c,invoice:_0x5d19c4,expiry_date:_0x48c2af,PO_number_loc:_0x25fdfd,ReqBy_loc:_0xf455b5,dateofreq_loc:_0x59acfd,typeservices_loc_Data:_0x44d438,destination_loc:_0x23f90f,deliverydate_loc:_0x3e37f0,driver_loc:_0x289fed,plate_loc:_0xa795ef,van_loc:_0x562a57,DRSI_loc:_0x42c8b6,typevehicle_loc:_0x5cf0ad,TSU_loc:_0x14cb6a,TFU_loc:_0x2f2bd9}=_0x3b29de[_0x2ea402(0x1b0)];if(typeof _0x317975==_0x2ea402(0x1af))var _0x5ba408=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x253)]],_0x1e2635=[_0x3b29de[_0x2ea402(0x1b0)]['from_prod_qty']],_0x2b66e2=[_0x3b29de['body'][_0x2ea402(0x1e9)]],_0x5e3b7c=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1d9)]],_0x31c500=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1f5)]],_0x15b18d=[_0x3b29de['body'][_0x2ea402(0x24a)]],_0x2aaa19=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x21a)]],_0x4393c3=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x226)]],_0x2364fd=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1fc)]],_0x573da4=[_0x3b29de[_0x2ea402(0x1b0)]['primary_unit']],_0x4cd1c9=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x231)]],_0x2b38d8=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1d3)]],_0x42b70d=[_0x3b29de[_0x2ea402(0x1b0)]['expiry_date']],_0x4cf7af=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1bc)]],_0x3dcce1=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1ac)]],_0x2e23db=[_0x3b29de['body']['maxPerUnit']],_0x1aff3a=[_0x3b29de['body'][_0x2ea402(0x1ea)]],_0x2b270c=[_0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1ee)]],_0x633b97=[_0x3b29de['body'][_0x2ea402(0x20e)]],_0x5975dc=[_0x3b29de['body'][_0x2ea402(0x1e0)]],_0x168d07=[_0x3b29de[_0x2ea402(0x1b0)]['id_transaction']];else var _0x5ba408=[..._0x3b29de[_0x2ea402(0x1b0)]['prod_name']],_0x1e2635=[..._0x3b29de['body'][_0x2ea402(0x24f)]],_0x2b66e2=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1e9)]],_0x5e3b7c=[..._0x3b29de['body'][_0x2ea402(0x1d9)]],_0x31c500=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1f5)]],_0x15b18d=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x24a)]],_0x2aaa19=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x21a)]],_0x4393c3=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x226)]],_0x2364fd=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1fc)]],_0x573da4=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x204)]],_0x4cd1c9=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x231)]],_0x2b38d8=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1d3)]],_0x42b70d=[..._0x3b29de['body'][_0x2ea402(0x21e)]],_0x4cf7af=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1bc)]],_0x3dcce1=[..._0x3b29de['body'][_0x2ea402(0x1ac)]],_0x2e23db=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1c2)]],_0x1aff3a=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1ea)]],_0x2b270c=[..._0x3b29de['body'][_0x2ea402(0x1ee)]],_0x633b97=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x20e)]],_0x5975dc=[..._0x3b29de[_0x2ea402(0x1b0)][_0x2ea402(0x1e0)]],_0x168d07=[..._0x3b29de['body'][_0x2ea402(0x24b)]];const _0x16bb74=_0x5ba408[_0x2ea402(0x1e1)](_0x4c4d43=>{return _0x4c4d43={'product_name':_0x4c4d43};});_0x1e2635[_0x2ea402(0x248)]((_0x1a2383,_0xb44cde)=>{_0x16bb74[_0xb44cde]['from_quantity']=_0x1a2383;}),_0x2b66e2[_0x2ea402(0x248)]((_0x5eaefb,_0x98a0ac)=>{var _0x154ce4=_0x2ea402,_0x1a396a=_0x5eaefb[_0x154ce4(0x1e3)](/[A-Za-z]+/)[0x0],_0x51bd18=parseInt(_0x5eaefb[_0x154ce4(0x1e3)](/\d+/)[0x0]);_0x16bb74[_0x98a0ac][_0x154ce4(0x1ed)]=_0x51bd18,_0x16bb74[_0x98a0ac][_0x154ce4(0x235)]=_0x1a396a;}),_0x168d07[_0x2ea402(0x248)]((_0x587936,_0xb769ae)=>{_0x16bb74[_0xb769ae]['id_transaction']=_0x587936;}),_0x5975dc['forEach']((_0x3f1a66,_0x39c1fe)=>{_0x16bb74[_0x39c1fe]['from_invoice']=_0x3f1a66;}),_0x5e3b7c[_0x2ea402(0x248)]((_0x5dc534,_0x5c6ec7)=>{var _0x1c3475=_0x2ea402;_0x16bb74[_0x5c6ec7][_0x1c3475(0x19a)]=_0x5dc534;}),_0x31c500[_0x2ea402(0x248)]((_0x2a5fb4,_0x38c798)=>{var _0x250a76=_0x2ea402,_0x307c9e=_0x2a5fb4[_0x250a76(0x1e3)](/[A-Za-z]+/)[0x0],_0x51a277=parseInt(_0x2a5fb4[_0x250a76(0x1e3)](/\d+/)[0x0]);_0x16bb74[_0x38c798][_0x250a76(0x209)]=_0x307c9e,_0x16bb74[_0x38c798][_0x250a76(0x1cc)]=_0x51a277;}),_0x15b18d[_0x2ea402(0x248)]((_0x2c05bc,_0xc13929)=>{var _0x1a448b=_0x2ea402;_0x16bb74[_0xc13929][_0x1a448b(0x24a)]=_0x2c05bc;}),_0x2aaa19[_0x2ea402(0x248)]((_0x52cfbb,_0xad97eb)=>{_0x16bb74[_0xad97eb]['secondary_code']=_0x52cfbb;}),_0x4393c3['forEach']((_0x7fd16d,_0x27ba06)=>{var _0x3c8748=_0x2ea402;_0x16bb74[_0x27ba06][_0x3c8748(0x1e2)]=_0x7fd16d;}),_0x2364fd[_0x2ea402(0x248)]((_0x270d06,_0x5831b7)=>{_0x16bb74[_0x5831b7]['maxProducts']=_0x270d06;}),_0x573da4[_0x2ea402(0x248)]((_0x1d64d1,_0x5e8794)=>{var _0x2688b9=_0x2ea402;_0x16bb74[_0x5e8794][_0x2688b9(0x1c4)]=_0x1d64d1;}),_0x4cd1c9[_0x2ea402(0x248)]((_0x26a015,_0x214a66)=>{var _0x362f4e=_0x2ea402;_0x16bb74[_0x214a66][_0x362f4e(0x231)]=_0x26a015;}),_0x2b38d8[_0x2ea402(0x248)]((_0x26d969,_0x255001)=>{var _0xd883d4=_0x2ea402;_0x16bb74[_0x255001][_0xd883d4(0x1d3)]=_0x26d969;}),_0x42b70d[_0x2ea402(0x248)]((_0x4abfd7,_0x103718)=>{var _0x3be835=_0x2ea402;_0x16bb74[_0x103718][_0x3be835(0x21e)]=_0x4abfd7;}),_0x4cf7af[_0x2ea402(0x248)]((_0x15a736,_0x46f0c8)=>{var _0x2b8294=_0x2ea402;_0x16bb74[_0x46f0c8][_0x2b8294(0x244)]=_0x15a736;}),_0x3dcce1['forEach']((_0x111fce,_0x260040)=>{var _0x1996be=_0x2ea402;_0x16bb74[_0x260040][_0x1996be(0x1a6)]=_0x111fce;}),_0x2e23db[_0x2ea402(0x248)]((_0x5c56a4,_0x4a5207)=>{_0x16bb74[_0x4a5207]['maxPerUnit']=_0x5c56a4;}),_0x1aff3a[_0x2ea402(0x248)]((_0x374380,_0x3ed312)=>{var _0x3b2e3f=_0x2ea402;_0x16bb74[_0x3ed312][_0x3b2e3f(0x1ea)]=_0x374380;}),_0x2b270c[_0x2ea402(0x248)]((_0x592bc0,_0x44ce52)=>{_0x16bb74[_0x44ce52]['from_room_name']=_0x592bc0;}),_0x633b97['forEach']((_0x29aedb,_0x47fd66)=>{var _0x72656e=_0x2ea402;_0x16bb74[_0x47fd66][_0x72656e(0x1d2)]=_0x29aedb;});const _0x5d009f=_0x16bb74[_0x2ea402(0x1d8)](_0x5b3750=>_0x5b3750[_0x2ea402(0x19a)]!=='0'&&_0x5b3750[_0x2ea402(0x19a)]!==''||_0x5b3750[_0x2ea402(0x215)]!=='0'&&_0x5b3750[_0x2ea402(0x215)]!=='');var _0x48212a=0x0;_0x5d009f[_0x2ea402(0x248)](_0x13abe7=>{var _0x2c552f=_0x2ea402;parseInt(_0x13abe7[_0x2c552f(0x19b)])<parseInt(_0x13abe7[_0x2c552f(0x19a)])&&_0x48212a++;});if(_0x48212a!=0x0)return _0x3b29de[_0x2ea402(0x218)](_0x2ea402(0x225),_0x2ea402(0x1e5)),_0x46a37f['redirect']('back');const _0x3a6ad5=new invoice_for_transfer();await _0x3a6ad5[_0x2ea402(0x19f)]();for(let _0x5f0049=0x0;_0x5f0049<=_0x633b97[_0x2ea402(0x1ce)]-0x1;_0x5f0049++){_0x16bb74[_0x5f0049]['To_invoice']=_0x2ea402(0x1d1)+_0x3a6ad5['invoice_init'][_0x2ea402(0x199)]()[_0x2ea402(0x1ae)](0x8,'0');}const _0x3ccb15=new transfers_finished({'date':_0x263ab7,'from_warehouse':_0x3fe788,'to_warehouse':_0x3b90ea,'product':_0x5d009f,'note':_0x163168,'invoice':_0x2ea402(0x1d1)+_0x3a6ad5['invoice_init'][_0x2ea402(0x199)]()['padStart'](0x8,'0'),'type_of_transaction':_0x2ea402(0x228),'type_of_process':'location2location','PO_number':_0x25fdfd,'RequestedBy':_0xf455b5,'DateofRequest':_0x59acfd,'typeservices':_0x44d438,'destination':_0x23f90f,'deliverydate':_0x3e37f0,'driver':_0x289fed,'plate':_0xa795ef,'van':_0x562a57,'DRSI':_0x42c8b6,'typevehicle':_0x5cf0ad,'TSU':_0x14cb6a,'TFU':_0x2f2bd9}),_0x42a79e=await _0x3ccb15['save']();_0x3b29de['flash'](_0x2ea402(0x237),'Product\x20Transfer\x20successfully'),_0x46a37f[_0x2ea402(0x241)]('/transfer_finished/preview/'+_0x42a79e[_0x2ea402(0x257)]);}catch(_0x243022){console[_0x2ea402(0x1cf)](_0x243022),_0x46a37f[_0x2ea402(0x1b3)](0xc8)[_0x2ea402(0x236)]({'errorMessage':_0x243022[_0x2ea402(0x1ec)]});}}),router[a0_0x194685(0x23f)]('/preview/:id',auth,async(_0x4d942a,_0x165920)=>{var _0x2e120e=a0_0x194685;try{const {username:_0x1ad4f3,email:_0x23d776,role:_0x2a1b84}=_0x4d942a[_0x2e120e(0x252)],_0x44f234=_0x4d942a['user'],_0x1642c1=await profile[_0x2e120e(0x1b1)]({'email':_0x44f234[_0x2e120e(0x240)]}),_0x4505c6=await master_shop['find'](),_0x21cdfe=await transfers_finished[_0x2e120e(0x1da)](_0x4d942a[_0x2e120e(0x1f6)]['id']);let _0x453a66;if(_0x44f234[_0x2e120e(0x229)]=='staff'){const _0x3debe6=await staff[_0x2e120e(0x1b1)]({'email':_0x44f234[_0x2e120e(0x240)]});_0x453a66=await warehouse['find']({'status':_0x2e120e(0x20a),'name':_0x3debe6[_0x2e120e(0x23b)],'warehouse_category':'Finished\x20Goods'});}else _0x453a66=await warehouse[_0x2e120e(0x220)]({'status':'Enabled','warehouse_category':_0x2e120e(0x1bf)});const _0x1d1d9=await warehouse[_0x2e120e(0x1fa)]([{'$match':{'name':_0x21cdfe[_0x2e120e(0x1a7)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2e120e(0x23e),'name':{'$first':_0x2e120e(0x247)},'product_stock':{'$first':_0x2e120e(0x256)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2e120e(0x1e6)},'secondary_code':{'$first':_0x2e120e(0x251)},'product_code':{'$first':_0x2e120e(0x20f)},'storage':{'$first':_0x2e120e(0x217)},'rack':{'$first':_0x2e120e(0x1d6)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2e120e(0x249)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x2e120e(0x200)}}}]),_0x478d05=await product[_0x2e120e(0x220)]({});if(_0x4505c6[0x0][_0x2e120e(0x1c8)]=='English\x20(US)'){var _0x38b954=users[_0x2e120e(0x1b4)];console[_0x2e120e(0x1cf)](_0x38b954);}else{if(_0x4505c6[0x0][_0x2e120e(0x1c8)]==_0x2e120e(0x1db))var _0x38b954=users['Hindi'];else{if(_0x4505c6[0x0][_0x2e120e(0x1c8)]==_0x2e120e(0x258))var _0x38b954=users[_0x2e120e(0x258)];else{if(_0x4505c6[0x0]['language']==_0x2e120e(0x19d))var _0x38b954=users[_0x2e120e(0x19d)];else{if(_0x4505c6[0x0][_0x2e120e(0x1c8)]=='French')var _0x38b954=users[_0x2e120e(0x21f)];else{if(_0x4505c6[0x0][_0x2e120e(0x1c8)]==_0x2e120e(0x254))var _0x38b954=users[_0x2e120e(0x20d)];else{if(_0x4505c6[0x0][_0x2e120e(0x1c8)]==_0x2e120e(0x1d4))var _0x38b954=users[_0x2e120e(0x1d4)];else{if(_0x4505c6[0x0]['language']=='Arabic\x20(ae)')var _0x38b954=users['Arabic'];}}}}}}}_0x165920[_0x2e120e(0x211)](_0x2e120e(0x1f3),{'success':_0x4d942a[_0x2e120e(0x218)]('success'),'errors':_0x4d942a['flash'](_0x2e120e(0x225)),'role':_0x44f234,'profile':_0x1642c1,'master_shop':_0x4505c6,'warehouse':_0x453a66,'transfer':_0x21cdfe,'stock':_0x1d1d9,'unit':_0x478d05,'language':_0x38b954});}catch(_0x2f42e4){console['log'](_0x2f42e4);}}),router[a0_0x194685(0x1dc)]('/preview/:id',auth,async(_0x5567cd,_0x3cf554)=>{var _0x57fcf9=a0_0x194685;try{const {invoice:_0x262de6,from_warehouse:_0x4b1175,FromRoom_name:_0x4f626f,to_warehouse:_0x4fc17e,ToRoom_name:_0x3cb728}=_0x5567cd[_0x57fcf9(0x1b0)],_0x2f0837=await transfers_finished[_0x57fcf9(0x1da)](_0x5567cd['params']['id']),_0x3364f9=_0x2f0837[_0x57fcf9(0x1e7)][_0x57fcf9(0x1e1)](async _0x2f4af7=>{var _0x2463e7=_0x57fcf9;if(_0x2f4af7['to_quantity']>0x0){var _0x1de85b=await warehouse[_0x2463e7(0x1b1)]({'name':_0x4b1175,'room':_0x2f4af7[_0x2463e7(0x255)]});const _0x1adfda=_0x1de85b[_0x2463e7(0x1fe)][_0x2463e7(0x1e1)](_0x111e11=>{var _0xde24da=_0x2463e7;_0x111e11[_0xde24da(0x257)]==_0x2f4af7[_0xde24da(0x24b)]&&(_0x111e11[_0xde24da(0x1c3)]=Math[_0xde24da(0x210)](0x0,Math[_0xde24da(0x1f4)](_0x111e11['product_stock'])-Math['abs'](_0x2f4af7[_0xde24da(0x19a)])),console[_0xde24da(0x1cf)](_0x111e11['product_stock']));});}return _0x1de85b;});Promise['all'](_0x3364f9)['then'](async _0x4a033a=>{var _0x3c70dd=_0x57fcf9;try{for(const _0x5b3475 of _0x4a033a){await _0x5b3475[_0x3c70dd(0x19f)]();}const _0xa696e3=_0x2f0837[_0x3c70dd(0x1e7)]['map'](async _0x43de39=>{var _0x202286=_0x3c70dd,_0x6822f3=await warehouse['findOne']({'name':_0x4fc17e,'room':_0x43de39['to_room_name']});if(_0x43de39[_0x202286(0x19a)]>0x0){var _0x1b1dc9=0x0;const _0x503cea=_0x6822f3[_0x202286(0x1fe)][_0x202286(0x1e1)](_0x4e6b71=>{var _0x32d13f=_0x202286;_0x4e6b71[_0x32d13f(0x23d)]==_0x43de39[_0x32d13f(0x23d)]&&_0x4e6b71['bay']==_0x43de39[_0x32d13f(0x1cc)]&&_0x4e6b71[_0x32d13f(0x21e)]==_0x43de39['expiry_date']&&_0x4e6b71['production_date']==_0x43de39[_0x32d13f(0x244)]&&_0x4e6b71[_0x32d13f(0x1d3)]==_0x43de39[_0x32d13f(0x1d3)]&&_0x4e6b71['invoice']==_0x43de39[_0x32d13f(0x1d0)]&&(typeof _0x43de39[_0x32d13f(0x24b)]=='undefined'?(console[_0x32d13f(0x1cf)](_0x32d13f(0x1f8),_0x4e6b71[_0x32d13f(0x1c3)]+_0x32d13f(0x19c)+_0x4e6b71[_0x32d13f(0x257)]+_0x32d13f(0x208)+Math[_0x32d13f(0x1f4)](_0x4e6b71[_0x32d13f(0x1c3)])+Math[_0x32d13f(0x1f4)](_0x43de39['to_quantity'])),_0x4e6b71[_0x32d13f(0x1c3)]=Math[_0x32d13f(0x1f4)](_0x4e6b71[_0x32d13f(0x1c3)])+Math[_0x32d13f(0x1f4)](_0x43de39[_0x32d13f(0x19a)])):_0x4e6b71[_0x32d13f(0x1c3)]=Math['abs'](_0x4e6b71['product_stock'])+Math[_0x32d13f(0x1f4)](_0x43de39[_0x32d13f(0x19a)]),_0x1b1dc9++);});_0x1b1dc9=='0'&&(_0x6822f3[_0x202286(0x1fe)]=_0x6822f3['product_details'][_0x202286(0x206)]({'product_name':_0x43de39[_0x202286(0x23d)],'product_stock':_0x43de39[_0x202286(0x19a)],'bay':_0x43de39['to_bay'],'level':_0x43de39[_0x202286(0x209)],'product_code':_0x43de39['product_code'],'primary_code':_0x43de39[_0x202286(0x24a)],'secondary_code':_0x43de39[_0x202286(0x21a)],'expiry_date':_0x43de39[_0x202286(0x21e)],'production_date':_0x43de39[_0x202286(0x244)],'maxProducts':_0x43de39[_0x202286(0x1a6)],'batch_code':_0x43de39[_0x202286(0x1d3)],'secondary_unit':_0x43de39[_0x202286(0x231)],'unit':_0x43de39[_0x202286(0x1c4)],'maxProducts':_0x43de39['maxProducts'],'maxPerUnit':_0x43de39[_0x202286(0x1c2)],'invoice':_0x43de39[_0x202286(0x1d0)]}));}return _0x6822f3;});Promise[_0x3c70dd(0x1df)](_0xa696e3)['then'](async _0x1ac55a=>{var _0x11bef6=_0x3c70dd;try{console['log'](_0x2f0837['type_of_process']);if(_0x2f0837[_0x11bef6(0x1ab)]!=_0x11bef6(0x203))for(const _0x33ba1f of _0x1ac55a){await warehouse[_0x11bef6(0x1c5)]({'_id':_0x33ba1f[_0x11bef6(0x257)]},{'$addToSet':{'product_details':{'$each':_0x33ba1f[_0x11bef6(0x1fe)]}}});}_0x2f0837[_0x11bef6(0x1c7)]=_0x11bef6(0x222);const _0x46b749=await _0x2f0837[_0x11bef6(0x19f)](),_0x812fef=await master_shop[_0x11bef6(0x220)](),_0x488474=await email_settings[_0x11bef6(0x1b1)](),_0x504fbb=await supervisor_settings[_0x11bef6(0x220)]();var _0x428143=_0x2f0837[_0x11bef6(0x1e7)],_0x3eaddc='',_0x3fdf4c;for(_0x3fdf4c in _0x428143){var _0x39ccac='FG';_0x2f0837[_0x11bef6(0x21d)]==_0x11bef6(0x238)&&(_0x39ccac='DG'),_0x3eaddc+=_0x11bef6(0x1e4)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x428143[_0x3fdf4c]['product_name']+_0x11bef6(0x1b5)+_0x11bef6(0x1f2)+_0x428143[_0x3fdf4c][_0x11bef6(0x1e2)]+'</td>'+_0x11bef6(0x1f2)+_0x428143[_0x3fdf4c][_0x11bef6(0x19a)]+'</td>'+_0x11bef6(0x1f2)+_0x428143[_0x3fdf4c][_0x11bef6(0x1c4)]+_0x11bef6(0x1b5)+_0x11bef6(0x1f2)+_0x428143[_0x3fdf4c][_0x11bef6(0x231)]+_0x11bef6(0x1b5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2f0837[_0x11bef6(0x21d)]+'</td>'+_0x11bef6(0x1f2)+_0x428143[_0x3fdf4c][_0x11bef6(0x1d2)]+_0x11bef6(0x1b5)+_0x11bef6(0x1f2)+_0x39ccac+_0x428143[_0x3fdf4c]['to_bay']+'</td>'+_0x11bef6(0x207);}_0x5567cd[_0x11bef6(0x218)](_0x11bef6(0x237),_0x11bef6(0x1c0)),_0x3cf554[_0x11bef6(0x241)](_0x11bef6(0x1a1)+_0x46b749[_0x11bef6(0x257)]);}catch(_0x532581){console[_0x11bef6(0x234)](_0x532581),_0x3cf554[_0x11bef6(0x1b3)](0x1f4)['json']({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x3c70dd(0x1dd)](_0x4f7779=>{var _0x260b8b=_0x3c70dd;console['error'](_0x4f7779),_0x3cf554['status'](0x1f4)[_0x260b8b(0x236)]({'error':'An\x20error\x20occurred.'});});}catch(_0x3fb575){console['error'](_0x3fb575),_0x3cf554[_0x3c70dd(0x1b3)](0x1f4)[_0x3c70dd(0x236)]({'error':_0x3c70dd(0x1ff)});}})[_0x57fcf9(0x1dd)](_0x213505=>{var _0x99ca43=_0x57fcf9;console[_0x99ca43(0x234)](_0x213505),_0x3cf554['status'](0x1f4)['json']({'error':_0x99ca43(0x1bb)});});}catch(_0x465b26){_0x3cf554[_0x57fcf9(0x236)]({'message':_0x465b26[_0x57fcf9(0x1ec)]});}});function BayBinSelected(_0x1f4e74,_0x55720a){var _0x2c009d=a0_0x194685,_0x451735=[];let _0xcaceb3=[];var _0x23e964=[];if(_0x1f4e74=='DRY\x20GOODS'){switch(_0x55720a){case'Rack\x201':_0x451735=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x451735=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x23e964=['DG'];}else{if(_0x1f4e74=='FROZEN\x20GOODS'){switch(_0x55720a){case _0x2c009d(0x1a8):_0x451735=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x2c009d(0x1d5):_0x451735=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x23e964=['FG'];}}return{'levels':_0x451735,'identify':_0x23e964};}router[a0_0x194685(0x23f)](a0_0x194685(0x233),auth,async(_0x121c27,_0x3189c1)=>{var _0x29db9d=a0_0x194685;try{const {username:_0x1ea18f,email:_0xb48caf,role:_0x236970}=_0x121c27[_0x29db9d(0x252)],_0x93aeab=_0x121c27['user'],_0x1c886d=await profile[_0x29db9d(0x1b1)]({'email':_0x93aeab[_0x29db9d(0x240)]}),_0x19ad9c=await master_shop[_0x29db9d(0x220)](),_0x58556e=await transfers_finished[_0x29db9d(0x1da)](_0x121c27[_0x29db9d(0x1f6)]['id']);let _0x3752bb=new Date(_0x58556e['expiry_date']),_0x4f21dc=('0'+_0x3752bb[_0x29db9d(0x1be)]())[_0x29db9d(0x1ca)](-0x2),_0x2efefc=('0'+(_0x3752bb[_0x29db9d(0x1f9)]()+0x1))[_0x29db9d(0x1ca)](-0x2),_0x17ebfb=_0x3752bb['getFullYear'](),_0x34a6ed=_0x17ebfb+'-'+_0x2efefc+'-'+_0x4f21dc,_0x2920e2;if(_0x93aeab[_0x29db9d(0x229)]==_0x29db9d(0x1a9)){const _0x1e7680=await staff[_0x29db9d(0x1b1)]({'email':_0x93aeab[_0x29db9d(0x240)]});_0x2920e2=await warehouse[_0x29db9d(0x220)]({'status':_0x29db9d(0x20a),'name':_0x1e7680[_0x29db9d(0x23b)],'warehouse_category':_0x29db9d(0x1bf)});}else _0x2920e2=await warehouse['find']({'status':_0x29db9d(0x20a),'warehouse_category':_0x29db9d(0x1bf)});const _0x28766f=await warehouse['aggregate']([{'$match':{'name':_0x58556e[_0x29db9d(0x1a7)],'room':_0x58556e['from_room']}},{'$unwind':_0x29db9d(0x24d)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x29db9d(0x247)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x29db9d(0x1c9)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x29db9d(0x219)},'primary_code':{'$first':_0x29db9d(0x1e6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x29db9d(0x20f)},'storage':{'$first':_0x29db9d(0x217)},'rack':{'$first':_0x29db9d(0x1d6)}}}]);var _0x327f85=[0x1,0x2,0x3,0x4],_0x2f5d89=['A','B','C','D','E','F','G','H','I','J'],_0x41418f=[_0x29db9d(0x22f),'Enclosed'];const _0x292bfe=await product[_0x29db9d(0x220)]({}),_0x1ecd26=BayBinSelected(_0x58556e[_0x29db9d(0x21d)],_0x58556e['to_room']);if(_0x19ad9c[0x0][_0x29db9d(0x1c8)]==_0x29db9d(0x24e)){var _0x4bd117=users[_0x29db9d(0x1b4)];console['log'](_0x4bd117);}else{if(_0x19ad9c[0x0]['language']==_0x29db9d(0x1db))var _0x4bd117=users[_0x29db9d(0x1db)];else{if(_0x19ad9c[0x0][_0x29db9d(0x1c8)]==_0x29db9d(0x258))var _0x4bd117=users['German'];else{if(_0x19ad9c[0x0][_0x29db9d(0x1c8)]=='Spanish')var _0x4bd117=users['Spanish'];else{if(_0x19ad9c[0x0][_0x29db9d(0x1c8)]=='French')var _0x4bd117=users[_0x29db9d(0x21f)];else{if(_0x19ad9c[0x0]['language']=='Portuguese\x20(BR)')var _0x4bd117=users['Portuguese'];else{if(_0x19ad9c[0x0][_0x29db9d(0x1c8)]==_0x29db9d(0x1d4))var _0x4bd117=users['Chinese'];else{if(_0x19ad9c[0x0][_0x29db9d(0x1c8)]=='Arabic\x20(ae)')var _0x4bd117=users[_0x29db9d(0x197)];}}}}}}}_0x3189c1[_0x29db9d(0x211)](_0x29db9d(0x1a4),{'success':_0x121c27['flash'](_0x29db9d(0x237)),'errors':_0x121c27[_0x29db9d(0x218)]('errors'),'role':_0x93aeab,'profile':_0x1c886d,'master_shop':_0x19ad9c,'warehouse':_0x2920e2,'transfer':_0x58556e,'stock':_0x28766f,'unit':_0x292bfe,'language':_0x4bd117,'levels':_0x327f85,'Isle':_0x2f5d89,'rooms_data':_0x41418f,'ed_fullDate':_0x34a6ed,'dataSelected':_0x1ecd26});}catch(_0x5951db){console[_0x29db9d(0x1cf)](_0x5951db);}}),router['post']('/view/:id',auth,async(_0x10ab3b,_0xbd0988)=>{var _0xfcbc49=a0_0x194685;try{const _0x14e91f=_0x10ab3b['params']['id'];console[_0xfcbc49(0x1cf)](_0x10ab3b[_0xfcbc49(0x1b0)]);const _0xb32f39=await transfers_finished['findById'](_0x14e91f);console[_0xfcbc49(0x1cf)](_0xfcbc49(0x21c),_0xb32f39);const {date:_0xe8ce6f,from_warehouse:_0xe81dbe,FromRoom_name:_0x4fa19d,to_warehouse:_0x510665,ToRoom_name:_0x41e8e8,prod_name:_0x3c6326,from_prod_qty:_0x3ef97a,from_prod_level:_0x5d4a03,from_prod_isle:_0x20c2c9,from_prod_pallet:_0x59c364,to_prod_qty:_0x4edf95,to_prod_level:_0xab0471,to_prod_isle:_0x2b54b8,to_prod_pallet:_0x2723fb,primary_code:_0x149f57,secondary_code:_0xbe8e0f,product_code3:_0x129c75,note:_0x4c8719,invoice:_0x3c340c,expiry_date:_0x332e63}=_0x10ab3b['body'];if(typeof _0x3c6326==_0xfcbc49(0x1af))var _0x11abb3=[_0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x253)]],_0xaca37d=[_0x10ab3b[_0xfcbc49(0x1b0)]['from_prod_qty']],_0x28ce6a=[_0x10ab3b['body'][_0xfcbc49(0x212)]],_0x748fa1=[_0x10ab3b['body'][_0xfcbc49(0x25b)]],_0x384d85=[_0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x1f5)]],_0x15653e=[_0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x24a)]],_0x4048b6=[_0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x21a)]],_0x18ac40=[_0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x226)]],_0x3ca1da=[_0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x1fc)]],_0x5e83e2=[_0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x1c4)]],_0x3fc5bc=[_0x10ab3b['body'][_0xfcbc49(0x231)]],_0x4f7304=[_0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x1d3)]],_0x21f4e4=[_0x10ab3b['body'][_0xfcbc49(0x21e)]];else var _0x11abb3=[..._0x10ab3b['body']['prod_name']],_0xaca37d=[..._0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x24f)]],_0x28ce6a=[..._0x10ab3b[_0xfcbc49(0x1b0)]['from_prod_level']],_0x748fa1=[..._0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x25b)]],_0x384d85=[..._0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x1f5)]],_0x15653e=[..._0x10ab3b['body'][_0xfcbc49(0x24a)]],_0x4048b6=[..._0x10ab3b[_0xfcbc49(0x1b0)]['secondary_code']],_0x18ac40=[..._0x10ab3b[_0xfcbc49(0x1b0)]['product_code3']],_0x3ca1da=[..._0x10ab3b['body'][_0xfcbc49(0x1fc)]],_0x5e83e2=[..._0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x1c4)]],_0x3fc5bc=[..._0x10ab3b['body']['secondary_unit']],_0x4f7304=[..._0x10ab3b['body'][_0xfcbc49(0x1d3)]],_0x21f4e4=[..._0x10ab3b[_0xfcbc49(0x1b0)][_0xfcbc49(0x21e)]];const _0x4d2b81=_0x11abb3[_0xfcbc49(0x1e1)](_0x758820=>{return _0x758820={'product_name':_0x758820};});_0xaca37d[_0xfcbc49(0x248)]((_0x555fb7,_0x1f358f)=>{var _0x2cb903=_0xfcbc49;_0x4d2b81[_0x1f358f][_0x2cb903(0x19b)]=_0x555fb7;}),_0x28ce6a[_0xfcbc49(0x248)]((_0x27e4d6,_0x1744cf)=>{_0x4d2b81[_0x1744cf]['from_bay']=_0x27e4d6;}),_0x748fa1[_0xfcbc49(0x248)]((_0x343758,_0x4411fb)=>{var _0x2cf5b4=_0xfcbc49;_0x4d2b81[_0x4411fb][_0x2cf5b4(0x19a)]=_0x343758;}),_0x384d85[_0xfcbc49(0x248)]((_0x127420,_0x57d643)=>{var _0x48b8dd=_0xfcbc49;_0x4d2b81[_0x57d643][_0x48b8dd(0x1cc)]=_0x127420;}),_0x15653e[_0xfcbc49(0x248)]((_0x1cc42e,_0x4a1348)=>{var _0x16c3d5=_0xfcbc49;_0x4d2b81[_0x4a1348][_0x16c3d5(0x24a)]=_0x1cc42e;}),_0x4048b6[_0xfcbc49(0x248)]((_0x498656,_0x3cbeae)=>{var _0x105fe7=_0xfcbc49;_0x4d2b81[_0x3cbeae][_0x105fe7(0x21a)]=_0x498656;}),_0x18ac40['forEach']((_0x4f4e3e,_0x3cf339)=>{_0x4d2b81[_0x3cf339]['product_code']=_0x4f4e3e;}),_0x3ca1da[_0xfcbc49(0x248)]((_0x4b89c4,_0x158f6d)=>{_0x4d2b81[_0x158f6d]['maxProducts']=_0x4b89c4;}),_0x5e83e2[_0xfcbc49(0x248)]((_0x22c0af,_0x1ad7f6)=>{_0x4d2b81[_0x1ad7f6]['unit']=_0x22c0af;}),_0x3fc5bc[_0xfcbc49(0x248)]((_0x4c7346,_0x10f77d)=>{_0x4d2b81[_0x10f77d]['secondary_unit']=_0x4c7346;}),_0x4f7304[_0xfcbc49(0x248)]((_0x245746,_0x45a7be)=>{var _0x45eaea=_0xfcbc49;_0x4d2b81[_0x45a7be][_0x45eaea(0x1d3)]=_0x245746;}),_0x21f4e4[_0xfcbc49(0x248)]((_0xf9bae8,_0x49280a)=>{_0x4d2b81[_0x49280a]['expiry_date']=_0xf9bae8;});const _0x1ff7ed=_0x4d2b81[_0xfcbc49(0x1d8)](_0x3550e6=>_0x3550e6[_0xfcbc49(0x19a)]!=='0'&&_0x3550e6['to_quantity']!==''||_0x3550e6['to_floorlevel']!=='0'&&_0x3550e6[_0xfcbc49(0x215)]!=='');var _0x8115db=0x0;_0x1ff7ed[_0xfcbc49(0x248)](_0x18321b=>{var _0x161f61=_0xfcbc49;parseInt(_0x18321b[_0x161f61(0x19b)])<parseInt(_0x18321b[_0x161f61(0x19a)])&&_0x8115db++;});if(_0x8115db!=0x0)return _0x10ab3b[_0xfcbc49(0x218)]('errors',_0xfcbc49(0x1e5)),_0xbd0988[_0xfcbc49(0x241)](_0xfcbc49(0x19e));const _0x18db6f=await warehouse['findOne']({'name':_0xb32f39['from_warehouse'],'room':_0xb32f39['from_room']});_0xb32f39[_0xfcbc49(0x1e7)]['forEach'](_0x38b3b6=>{var _0x5d6115=_0xfcbc49;if(_0x38b3b6['to_quantity']>0x0){const _0x20bb69=_0x18db6f[_0x5d6115(0x1fe)][_0x5d6115(0x1e1)](_0x165b25=>{var _0x5bf0e0=_0x5d6115;_0x165b25[_0x5bf0e0(0x23d)]==_0x38b3b6[_0x5bf0e0(0x23d)]&&_0x165b25[_0x5bf0e0(0x1a5)]==_0x38b3b6['from_bay']&&(_0x165b25[_0x5bf0e0(0x1c3)]=parseInt(_0x165b25['product_stock'])+parseInt(_0x38b3b6[_0x5bf0e0(0x19a)]));});}}),await _0x18db6f[_0xfcbc49(0x19f)]();const _0x254255=await warehouse['findOne']({'name':_0xb32f39['to_warehouse'],'room':_0xb32f39[_0xfcbc49(0x224)]});_0xb32f39['product'][_0xfcbc49(0x248)](_0x24e9c4=>{var _0x454c26=_0xfcbc49;if(_0x24e9c4['to_quantity']>0x0){const _0x2cba6a=_0x254255[_0x454c26(0x1fe)][_0x454c26(0x1e1)](_0x3b9fbb=>{var _0x56f614=_0x454c26;_0x3b9fbb[_0x56f614(0x23d)]==_0x24e9c4['product_name']&&_0x3b9fbb[_0x56f614(0x1a5)]==_0x24e9c4[_0x56f614(0x1cc)]&&(_0x3b9fbb['product_stock']=parseInt(_0x3b9fbb[_0x56f614(0x1c3)])-parseInt(_0x24e9c4[_0x56f614(0x19a)]));});}}),await _0x254255['save'](),_0xb32f39['date']=_0xe8ce6f,_0xb32f39['from_warehouse']=_0xe81dbe,_0xb32f39['to_warehouse']=_0x510665,_0xb32f39[_0xfcbc49(0x1e7)]=_0x1ff7ed,_0xb32f39[_0xfcbc49(0x25d)]=_0x4c8719,_0xb32f39['invoice']=_0x3c340c;const _0x34acbf=await _0xb32f39[_0xfcbc49(0x19f)](),_0x4698be=await warehouse[_0xfcbc49(0x1b1)]({'name':_0xe81dbe,'room':_0x4fa19d});_0x34acbf[_0xfcbc49(0x1e7)][_0xfcbc49(0x248)](_0x564a2c=>{var _0xba6a4=_0xfcbc49;if(_0x564a2c[_0xba6a4(0x19a)]>0x0){const _0x1c8c1f=_0x4698be[_0xba6a4(0x1fe)][_0xba6a4(0x1e1)](_0xa9fd17=>{var _0x3f40c1=_0xba6a4;_0xa9fd17[_0x3f40c1(0x23d)]==_0x564a2c[_0x3f40c1(0x23d)]&&_0xa9fd17['bay']==_0x564a2c['from_bay']&&(_0xa9fd17[_0x3f40c1(0x1c3)]=parseInt(_0xa9fd17[_0x3f40c1(0x1c3)])-parseInt(_0x564a2c[_0x3f40c1(0x19a)]));});}}),await _0x4698be[_0xfcbc49(0x19f)]();const _0x18d0f2=await warehouse[_0xfcbc49(0x1b1)]({'name':_0x510665,'room':_0x41e8e8});_0x34acbf[_0xfcbc49(0x1e7)][_0xfcbc49(0x248)](_0x146228=>{var _0x1881f4=_0xfcbc49;if(_0x146228['to_quantity']>0x0){var _0x3d1311=0x0;const _0x3e9a45=_0x18d0f2[_0x1881f4(0x1fe)][_0x1881f4(0x1e1)](_0x541ea1=>{var _0x850d=_0x1881f4;_0x541ea1['product_name']==_0x146228[_0x850d(0x23d)]&&_0x541ea1[_0x850d(0x1a5)]==_0x146228[_0x850d(0x1cc)]&&(_0x541ea1[_0x850d(0x1c3)]=parseInt(_0x541ea1['product_stock'])+parseInt(_0x146228[_0x850d(0x19a)]),_0x3d1311++);});_0x3d1311=='0'&&(_0x18d0f2['product_details']=_0x18d0f2['product_details']['concat']({'product_name':_0x146228[_0x1881f4(0x23d)],'product_stock':_0x146228[_0x1881f4(0x19a)],'bay':_0x146228['to_bay'],'product_code':_0x146228[_0x1881f4(0x1e2)],'primary_code':_0x146228['primary_code'],'secondary_code':_0x146228[_0x1881f4(0x21a)],'maxProducts':_0x146228[_0x1881f4(0x1a6)]}));}}),await _0x18d0f2[_0xfcbc49(0x19f)](),_0x10ab3b['flash'](_0xfcbc49(0x237),'Transfer\x20Edit\x20Successfully'),_0xbd0988[_0xfcbc49(0x241)](_0xfcbc49(0x1a2));}catch(_0x5efdd8){console['log'](_0x5efdd8);}}),router[a0_0x194685(0x1dc)]('/barcode_scanner',async(_0x2432e9,_0x1180c5)=>{var _0x309ebe=a0_0x194685;const {FromWareHouse:_0x306671,FromRoom:_0x31069c,ToWarehouse:_0x477f9d,ToRoom:_0x3f24d5,primary_code:_0x14d375,Roomslist:_0x592695}=_0x2432e9[_0x309ebe(0x1b0)],_0x17dd51=_0x592695[_0x309ebe(0x1c6)](','),_0x4f9ce7=[];async function _0x1ba636(_0x4dcd64){var _0x300cc1=_0x309ebe;const _0x32d6c6=await warehouse[_0x300cc1(0x1fa)]([{'$match':{'name':_0x306671,'room':_0x4dcd64}},{'$unwind':_0x300cc1(0x24d)},{'$match':{'product_details.primary_code':_0x14d375}},{'$group':{'_id':_0x300cc1(0x23e),'name':{'$first':_0x300cc1(0x247)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x300cc1(0x1e6)},'secondary_code':{'$first':_0x300cc1(0x251)},'product_code':{'$first':_0x300cc1(0x20f)},'bay':{'$first':_0x300cc1(0x22c)},'level':{'$first':_0x300cc1(0x221)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x300cc1(0x219)},'unit':{'$first':_0x300cc1(0x1ef)},'secondary_unit':{'$first':_0x300cc1(0x216)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x300cc1(0x242)},'production_date':{'$first':_0x300cc1(0x249)},'batch_code':{'$first':_0x300cc1(0x23a)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x38dcca=await warehouse[_0x300cc1(0x1fa)]([{'$match':{'name':_0x306671,'room':_0x4dcd64}},{'$unwind':_0x300cc1(0x24d)},{'$match':{'product_details.secondary_code':_0x14d375}},{'$group':{'_id':_0x300cc1(0x23e),'name':{'$first':_0x300cc1(0x247)},'instock':{'$first':_0x300cc1(0x256)},'primary_code':{'$first':_0x300cc1(0x1e6)},'secondary_code':{'$first':_0x300cc1(0x251)},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x300cc1(0x22c)},'level':{'$first':_0x300cc1(0x221)},'type':{'$first':_0x300cc1(0x198)},'pallet':{'$first':_0x300cc1(0x219)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x300cc1(0x216)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x300cc1(0x23a)},'maxPerUnit':{'$first':_0x300cc1(0x202)},'roomNamed':{'$first':_0x300cc1(0x246)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x300cc1(0x1b2)}}}]);if(_0x32d6c6[_0x300cc1(0x1ce)]>0x0)_0x4f9ce7['push'](_0x32d6c6);else _0x38dcca[_0x300cc1(0x1ce)]>0x0&&_0x4f9ce7[_0x300cc1(0x1c1)](_0x38dcca);}const _0x288cdf=_0x17dd51[_0x309ebe(0x1e1)](_0x4b5a41=>_0x1ba636(_0x4b5a41));await Promise[_0x309ebe(0x1df)](_0x288cdf),_0x1180c5[_0x309ebe(0x236)](_0x4f9ce7);}),router[a0_0x194685(0x1dc)](a0_0x194685(0x24c),async(_0x55d943,_0xb0d127)=>{var _0x6cbc27=a0_0x194685;const {productCode:_0x4b52ff,bay:_0x3b29a2,warehouses:_0x1db078,room:_0x44b175}=_0x55d943[_0x6cbc27(0x1b0)];console[_0x6cbc27(0x1cf)](_0x55d943[_0x6cbc27(0x1b0)]);try{const _0x3ade5c=await warehouse[_0x6cbc27(0x1fa)]([{'$match':{'name':_0x1db078,'room':_0x44b175}},{'$unwind':_0x6cbc27(0x24d)},{'$match':{'product_details.bay':parseInt(_0x3b29a2)}},{'$group':{'_id':_0x6cbc27(0x23e),'name':{'$first':_0x6cbc27(0x247)},'product_stock':{'$first':_0x6cbc27(0x256)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x6cbc27(0x1b7)}}}]);_0xb0d127['status'](0xc8)[_0x6cbc27(0x236)](_0x3ade5c);}catch(_0x3b33d8){_0xb0d127['status'](0x194)['json']({'message':_0x3b33d8[_0x6cbc27(0x1ec)]});}}),module['exports']=router;