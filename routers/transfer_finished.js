var a0_0xbff34b=a0_0x5407;(function(_0x2a3890,_0x2ddf71){var _0xf8276c=a0_0x5407,_0x13f6dd=_0x2a3890();while(!![]){try{var _0x4f9f83=parseInt(_0xf8276c(0xcd))/0x1*(parseInt(_0xf8276c(0xc1))/0x2)+parseInt(_0xf8276c(0x112))/0x3*(parseInt(_0xf8276c(0xb1))/0x4)+-parseInt(_0xf8276c(0x126))/0x5+parseInt(_0xf8276c(0x166))/0x6*(-parseInt(_0xf8276c(0x104))/0x7)+-parseInt(_0xf8276c(0x143))/0x8*(-parseInt(_0xf8276c(0xc2))/0x9)+-parseInt(_0xf8276c(0x119))/0xa+parseInt(_0xf8276c(0xc8))/0xb;if(_0x4f9f83===_0x2ddf71)break;else _0x13f6dd['push'](_0x13f6dd['shift']());}catch(_0x3ab687){_0x13f6dd['push'](_0x13f6dd['shift']());}}}(a0_0xac0d,0xafd9b));const express=require(a0_0xbff34b(0xeb)),app=express(),router=express[a0_0xbff34b(0x108)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0xbff34b(0xbd)),auth=require('../middleware/auth'),users=require(a0_0xbff34b(0xb6)),nodemailer=require(a0_0xbff34b(0xc6));router[a0_0xbff34b(0x15f)]('/view',auth,async(_0x3970a7,_0x5c8e5c)=>{var _0x57f1a2=a0_0xbff34b;try{const {username:_0x20ac09,email:_0x5e4004,role:_0x5d7e39}=_0x3970a7[_0x57f1a2(0x13d)],_0x169573=_0x3970a7[_0x57f1a2(0x13d)],_0x5c65a0=await profile['findOne']({'email':_0x169573[_0x57f1a2(0x140)]}),_0xe86ffd=await master_shop['find']();let _0x533883;if(_0x169573[_0x57f1a2(0xf5)]==_0x57f1a2(0xc0)){const _0x25c234=await staff[_0x57f1a2(0xb7)]({'email':_0x169573[_0x57f1a2(0x140)]});_0x533883=await transfers_finished[_0x57f1a2(0x111)]({'from_warehouse':_0x25c234[_0x57f1a2(0xef)]});}else _0x533883=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x57f1a2(0xb5)}},{'$unwind':_0x57f1a2(0xe8)},{'$group':{'_id':_0x57f1a2(0xdd),'invoice':{'$first':_0x57f1a2(0x14a)},'date':{'$first':_0x57f1a2(0x139)},'from_warehouse':{'$first':_0x57f1a2(0xc3)},'to_warehouse':{'$first':_0x57f1a2(0xe2)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x57f1a2(0x136)},'finalize':{'$first':_0x57f1a2(0xee)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0xe86ffd[0x0][_0x57f1a2(0x13b)]==_0x57f1a2(0xb9))var _0x4d4f0b=users['English'];else{if(_0xe86ffd[0x0]['language']==_0x57f1a2(0x12e))var _0x4d4f0b=users[_0x57f1a2(0x12e)];else{if(_0xe86ffd[0x0][_0x57f1a2(0x13b)]==_0x57f1a2(0x127))var _0x4d4f0b=users['German'];else{if(_0xe86ffd[0x0][_0x57f1a2(0x13b)]==_0x57f1a2(0x10b))var _0x4d4f0b=users[_0x57f1a2(0x10b)];else{if(_0xe86ffd[0x0][_0x57f1a2(0x13b)]==_0x57f1a2(0x15b))var _0x4d4f0b=users[_0x57f1a2(0x15b)];else{if(_0xe86ffd[0x0][_0x57f1a2(0x13b)]==_0x57f1a2(0x11b))var _0x4d4f0b=users[_0x57f1a2(0x11f)];else{if(_0xe86ffd[0x0][_0x57f1a2(0x13b)]=='Chinese')var _0x4d4f0b=users[_0x57f1a2(0xf0)];else{if(_0xe86ffd[0x0][_0x57f1a2(0x13b)]==_0x57f1a2(0x9b))var _0x4d4f0b=users[_0x57f1a2(0x11e)];}}}}}}}_0x5c8e5c[_0x57f1a2(0x12b)](_0x57f1a2(0x165),{'success':_0x3970a7[_0x57f1a2(0x109)](_0x57f1a2(0x107)),'errors':_0x3970a7['flash'](_0x57f1a2(0x138)),'role':_0x169573,'profile':_0x5c65a0,'master_shop':_0xe86ffd,'transfer':_0x533883,'language':_0x4d4f0b});}catch(_0x21693b){console['log'](_0x21693b);}}),router[a0_0xbff34b(0x15f)](a0_0xbff34b(0x12a),auth,async(_0x5bb4ac,_0x488509)=>{var _0x129635=a0_0xbff34b;try{const {username:_0x357a53,email:_0x1f272b,role:_0xa5149a}=_0x5bb4ac[_0x129635(0x13d)],_0x1c4615=_0x5bb4ac[_0x129635(0x13d)],_0x2b70fc=await profile[_0x129635(0xb7)]({'email':_0x1c4615[_0x129635(0x140)]}),_0x150171=await master_shop[_0x129635(0x111)]();let _0x29e84a;if(_0x1c4615[_0x129635(0xf5)]==_0x129635(0xc0)){const _0x520145=await staff[_0x129635(0xb7)]({'email':_0x1c4615[_0x129635(0x140)]});_0x29e84a=await transfers_finished[_0x129635(0x111)]({'from_warehouse':_0x520145[_0x129635(0xef)]});}else _0x29e84a=await transfers_finished[_0x129635(0xd3)]([{'$match':{'type_of_transaction':_0x129635(0xa0)}},{'$unwind':_0x129635(0xe8)},{'$group':{'_id':_0x129635(0xdd),'invoice':{'$first':'$invoice'},'date':{'$first':_0x129635(0x139)},'from_warehouse':{'$first':_0x129635(0xc3)},'to_warehouse':{'$first':_0x129635(0xe2)},'from_room_name':{'$addToSet':_0x129635(0x163)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x129635(0xee)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x150171[0x0][_0x129635(0x13b)]==_0x129635(0xb9))var _0x440d14=users[_0x129635(0x15e)];else{if(_0x150171[0x0][_0x129635(0x13b)]==_0x129635(0x12e))var _0x440d14=users[_0x129635(0x12e)];else{if(_0x150171[0x0][_0x129635(0x13b)]==_0x129635(0x127))var _0x440d14=users[_0x129635(0x127)];else{if(_0x150171[0x0][_0x129635(0x13b)]=='Spanish')var _0x440d14=users['Spanish'];else{if(_0x150171[0x0][_0x129635(0x13b)]==_0x129635(0x15b))var _0x440d14=users[_0x129635(0x15b)];else{if(_0x150171[0x0][_0x129635(0x13b)]=='Portuguese\x20(BR)')var _0x440d14=users[_0x129635(0x11f)];else{if(_0x150171[0x0][_0x129635(0x13b)]==_0x129635(0xf0))var _0x440d14=users['Chinese'];else{if(_0x150171[0x0][_0x129635(0x13b)]==_0x129635(0x9b))var _0x440d14=users[_0x129635(0x11e)];}}}}}}}_0x488509[_0x129635(0x12b)](_0x129635(0x11a),{'success':_0x5bb4ac[_0x129635(0x109)](_0x129635(0x107)),'errors':_0x5bb4ac['flash']('errors'),'role':_0x1c4615,'profile':_0x2b70fc,'master_shop':_0x150171,'transfer':_0x29e84a,'language':_0x440d14});}catch(_0x187a6f){console[_0x129635(0x135)](_0x187a6f);}});function a0_0xac0d(){var _0x415c39=['prod_name','expiry_date','product_name','production_date','string','FROZEN\x20GOODS','id_transaction','to_room_name','$product_details.storage','toString','to_bay','save','/view/add_transfer','RoomAssigned','French','post','</tr>','English','get','$product_details.level','from_room','date','$product.from_room_name','Finished\x20Goods','transfer_finished','3288828ZCWJeA','New_Qty_Converted','True','/view/choose_logs','to_prod_qty','from_quantity','length','Arabic\x20(ae)','concat','from_prod_level','An\x20error\x20occurred\x20while\x20saving\x20data.','forEach','logs','$product_details.secondary_code','split','transfer_data','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','\x20<=>\x20','from_level','type_of_process','$product_details.expiry_date','from_invoice','from_bay','Transfer\x20Edit\x20Successfully','</td>','primary_code','/transfer_finished/preview/','$product_details.bin','bay','748460fSaorM','to_warehouse','LOG-TRF-','invoice','own','../public/language/languages.json','findOne','/view/addlog','English\x20(US)','/transfer_finished/view','batch_code','all','../models/all_models','from_prod_qty','An\x20error\x20occurred.','staff','21364GvcFMP','1143SqFEdD','$from_warehouse','push','/view/add_transfer_loc','nodemailer','primary_unit','19313250mIdWkH','$product_details.invoice','maxProducts','ToRoomAssigned','json','18cwgmRK','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','secondary_unit','invoice_init','match','floor','aggregate','product_details','padStart','to_level','prod_cat','$product_details.product_stock','then','\x20<>\x20','Product\x20Transfer\x20successfully','to_quantity','$_id','TRFF-','/view/choose','/view/add_transfer_logs','choos_transfer','$to_warehouse','MaxStocks_data2','to_room','secondary_code','status','$product_details.maxPerUnit','$product','findById','product_date','express','edit_transfer_finished_view','add_transfer_finished','$finalize','warehouse','Chinese','max','exports','$product_details.secondary_unit','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','role','DRY\x20GOODS','product_code','catch','$product_details.unit','$product_details._id','<tr>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.rack','/transfer/view','/preview/:id','error','to_prod_level','from_room_name','slice','7gigyxj','$product_details.type','Rack\x202','success','Router','flash','$room','Spanish','$product_details.product_name','bin2bin','body','message','redirect','find','3HvCJOK','$product_details.product_code','Enabled','random','product_code3','/CheckingWarehouse','$product_details.primary_code','8815420kIGRaj','transfer_finished_logs','Portuguese\x20(BR)','TRF-','abs','Arabic','Portuguese','Ambient','Rack\x201','Enclosed','getMonth','/picking_list/PDF_transfer/','unit','6162860YcIOxt','German','$product_details','_id','/view_logs','render','back','$product_details.bay','Hindi','product_stock','/view/:id','location2location','filter','params','from_warehouse','log','$product.to_room_name','/barcode_scanner','errors','$date','from_prod_level2','language','$product_details.production_date','user','product','to_floorlevel','email','$product_details.floorlevel','To_invoice','78576IogGFp','Transfer\x20Finalize\x20Successfully','note','$name','MaxStocks_data','map','undefined','$invoice','maxPerUnit','$product_details.batch_code'];a0_0xac0d=function(){return _0x415c39;};return a0_0xac0d();}async function getRandom8DigitNumber(){var _0x5abc70=a0_0xbff34b;const _0x42e34a=0x989680,_0x375988=0x5f5e0ff,_0x1dbb64=Math[_0x5abc70(0xd2)](Math[_0x5abc70(0x115)]()*(_0x375988-_0x42e34a+0x1))+_0x42e34a;var _0x285bd5;const _0x3d856d=await transfers_finished[_0x5abc70(0xb7)]({'invoice':_0x5abc70(0xde)+_0x1dbb64});return _0x3d856d&&_0x3d856d['length']>0x0?_0x285bd5='TRFF-'+_0x1dbb64:_0x285bd5=_0x5abc70(0xde)+_0x1dbb64,_0x285bd5;}function a0_0x5407(_0x5c388c,_0x2c0c3d){var _0xac0d4b=a0_0xac0d();return a0_0x5407=function(_0x5407f0,_0x931bf2){_0x5407f0=_0x5407f0-0x97;var _0x5243bd=_0xac0d4b[_0x5407f0];return _0x5243bd;},a0_0x5407(_0x5c388c,_0x2c0c3d);}router[a0_0xbff34b(0x15f)](a0_0xbff34b(0x159),auth,async(_0x549bb9,_0x6104b7)=>{var _0xde23a4=a0_0xbff34b;try{const {username:_0x1ef64d,email:_0x34c637,role:_0x532132}=_0x549bb9[_0xde23a4(0x13d)],_0x4411c5=_0x549bb9[_0xde23a4(0x13d)],_0x6a4586=await profile[_0xde23a4(0xb7)]({'email':_0x4411c5[_0xde23a4(0x140)]}),_0x14d188=await master_shop[_0xde23a4(0x111)]();let _0x233c02;if(_0x4411c5[_0xde23a4(0xf5)]=='staff'){const _0x2d128e=await staff[_0xde23a4(0xb7)]({'email':_0x4411c5[_0xde23a4(0x140)]});_0x233c02=await warehouse[_0xde23a4(0xd3)]([{'$match':{'status':_0xde23a4(0x114),'name':_0x2d128e[_0xde23a4(0xef)]}},{'$group':{'_id':_0xde23a4(0x146),'name':{'$first':_0xde23a4(0x146)}}}]);}else _0x233c02=await warehouse[_0xde23a4(0xd3)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0xde23a4(0x146),'name':{'$first':_0xde23a4(0x146)}}}]);const _0x31c9d1=await transfers_finished[_0xde23a4(0x111)]({}),_0x137649=_0x31c9d1[_0xde23a4(0x9a)]+0x1,_0x30c1b3=_0xde23a4(0xde)+_0x137649['toString']()[_0xde23a4(0xd5)](0x5,'0');if(_0x14d188[0x0][_0xde23a4(0x13b)]==_0xde23a4(0xb9))var _0x7d607d=users['English'];else{if(_0x14d188[0x0][_0xde23a4(0x13b)]==_0xde23a4(0x12e))var _0x7d607d=users[_0xde23a4(0x12e)];else{if(_0x14d188[0x0][_0xde23a4(0x13b)]==_0xde23a4(0x127))var _0x7d607d=users[_0xde23a4(0x127)];else{if(_0x14d188[0x0][_0xde23a4(0x13b)]==_0xde23a4(0x10b))var _0x7d607d=users[_0xde23a4(0x10b)];else{if(_0x14d188[0x0][_0xde23a4(0x13b)]==_0xde23a4(0x15b))var _0x7d607d=users[_0xde23a4(0x15b)];else{if(_0x14d188[0x0][_0xde23a4(0x13b)]==_0xde23a4(0x11b))var _0x7d607d=users[_0xde23a4(0x11f)];else{if(_0x14d188[0x0]['language']==_0xde23a4(0xf0))var _0x7d607d=users[_0xde23a4(0xf0)];else{if(_0x14d188[0x0][_0xde23a4(0x13b)]==_0xde23a4(0x9b))var _0x7d607d=users[_0xde23a4(0x11e)];}}}}}}}const _0x98c21b=getRandom8DigitNumber();_0x98c21b[_0xde23a4(0xd9)](_0x1a8cda=>{var _0x3d0835=_0xde23a4;_0x6104b7[_0x3d0835(0x12b)](_0x3d0835(0xed),{'success':_0x549bb9[_0x3d0835(0x109)](_0x3d0835(0x107)),'errors':_0x549bb9['flash']('errors'),'role':_0x4411c5,'profile':_0x6a4586,'master_shop':_0x14d188,'warehouse':_0x233c02,'language':_0x7d607d,'invoice':_0x1a8cda});})[_0xde23a4(0xf8)](_0x54b69a=>{var _0x2c0641=_0xde23a4;_0x549bb9[_0x2c0641(0x109)](_0x2c0641(0x138),_0x2c0641(0xfc)),_0x6104b7[_0x2c0641(0x110)](_0x2c0641(0xfe));});}catch(_0x193364){console['log'](_0x193364);}}),router[a0_0xbff34b(0x15f)](a0_0xbff34b(0xdf),auth,async(_0x1ce557,_0x22f4ff)=>{var _0x2b14ad=a0_0xbff34b;try{const {username:_0x3edb9c,email:_0x472a73,role:_0x2c635f}=_0x1ce557['user'],_0x146d88=_0x1ce557['user'],_0x5500db=await profile[_0x2b14ad(0xb7)]({'email':_0x146d88[_0x2b14ad(0x140)]}),_0x283e32=await master_shop[_0x2b14ad(0x111)]();let _0x3758bf;if(_0x146d88[_0x2b14ad(0xf5)]==_0x2b14ad(0xc0)){const _0x1b80f0=await staff[_0x2b14ad(0xb7)]({'email':_0x146d88[_0x2b14ad(0x140)]});_0x3758bf=await warehouse[_0x2b14ad(0xd3)]([{'$match':{'status':_0x2b14ad(0x114),'name':_0x1b80f0['warehouse']}},{'$group':{'_id':_0x2b14ad(0x146),'name':{'$first':_0x2b14ad(0x146)}}}]);}else _0x3758bf=await warehouse[_0x2b14ad(0xd3)]([{'$match':{'status':_0x2b14ad(0x114)}},{'$group':{'_id':_0x2b14ad(0x146),'name':{'$first':_0x2b14ad(0x146)}}}]);const _0x155ff8=await transfers_finished[_0x2b14ad(0x111)]({}),_0x18da65=_0x155ff8[_0x2b14ad(0x9a)]+0x1,_0x20370d='TRFF-'+_0x18da65[_0x2b14ad(0x156)]()['padStart'](0x5,'0');if(_0x283e32[0x0][_0x2b14ad(0x13b)]==_0x2b14ad(0xb9))var _0x34d7fa=users[_0x2b14ad(0x15e)];else{if(_0x283e32[0x0][_0x2b14ad(0x13b)]==_0x2b14ad(0x12e))var _0x34d7fa=users[_0x2b14ad(0x12e)];else{if(_0x283e32[0x0]['language']==_0x2b14ad(0x127))var _0x34d7fa=users['German'];else{if(_0x283e32[0x0][_0x2b14ad(0x13b)]==_0x2b14ad(0x10b))var _0x34d7fa=users['Spanish'];else{if(_0x283e32[0x0][_0x2b14ad(0x13b)]==_0x2b14ad(0x15b))var _0x34d7fa=users[_0x2b14ad(0x15b)];else{if(_0x283e32[0x0][_0x2b14ad(0x13b)]=='Portuguese\x20(BR)')var _0x34d7fa=users[_0x2b14ad(0x11f)];else{if(_0x283e32[0x0]['language']==_0x2b14ad(0xf0))var _0x34d7fa=users['Chinese'];else{if(_0x283e32[0x0][_0x2b14ad(0x13b)]=='Arabic\x20(ae)')var _0x34d7fa=users['Arabic'];}}}}}}}const _0x24c3d8=getRandom8DigitNumber();_0x24c3d8['then'](_0x5ab13d=>{var _0x395b02=_0x2b14ad;_0x22f4ff[_0x395b02(0x12b)](_0x395b02(0xe1),{'success':_0x1ce557['flash'](_0x395b02(0x107)),'errors':_0x1ce557['flash']('errors'),'role':_0x146d88,'profile':_0x5500db,'master_shop':_0x283e32,'warehouse':_0x3758bf,'language':_0x34d7fa,'invoice':_0x5ab13d});})['catch'](_0x5bf680=>{var _0x537aca=_0x2b14ad;_0x1ce557['flash'](_0x537aca(0x138),_0x537aca(0xfc)),_0x22f4ff[_0x537aca(0x110)](_0x537aca(0xfe));});}catch(_0x1adc6e){console[_0x2b14ad(0x135)](_0x1adc6e);}}),router[a0_0xbff34b(0x15f)](a0_0xbff34b(0x97),auth,async(_0xb7162,_0x20a121)=>{var _0x3c794b=a0_0xbff34b;try{const {username:_0x42b6c3,email:_0x31f763,role:_0x931ba8}=_0xb7162[_0x3c794b(0x13d)],_0x33a1c0=_0xb7162[_0x3c794b(0x13d)],_0x3b4c08=await profile[_0x3c794b(0xb7)]({'email':_0x33a1c0[_0x3c794b(0x140)]}),_0x1bc7ab=await master_shop['find']();let _0x3bf4e3;if(_0x33a1c0[_0x3c794b(0xf5)]==_0x3c794b(0xc0)){const _0x3b1463=await staff[_0x3c794b(0xb7)]({'email':_0x33a1c0[_0x3c794b(0x140)]});_0x3bf4e3=await warehouse[_0x3c794b(0xd3)]([{'$match':{'status':_0x3c794b(0x114),'name':_0x3b1463[_0x3c794b(0xef)]}},{'$group':{'_id':_0x3c794b(0x146),'name':{'$first':_0x3c794b(0x146)}}}]);}else _0x3bf4e3=await warehouse[_0x3c794b(0xd3)]([{'$match':{'status':_0x3c794b(0x114)}},{'$group':{'_id':_0x3c794b(0x146),'name':{'$first':_0x3c794b(0x146)}}}]);const _0x146ccf=await transfers_finished[_0x3c794b(0x111)]({}),_0x1b9d5c=_0x146ccf[_0x3c794b(0x9a)]+0x1,_0x2be311=_0x3c794b(0xde)+_0x1b9d5c[_0x3c794b(0x156)]()[_0x3c794b(0xd5)](0x5,'0');if(_0x1bc7ab[0x0][_0x3c794b(0x13b)]==_0x3c794b(0xb9))var _0x278000=users[_0x3c794b(0x15e)];else{if(_0x1bc7ab[0x0]['language']==_0x3c794b(0x12e))var _0x278000=users[_0x3c794b(0x12e)];else{if(_0x1bc7ab[0x0][_0x3c794b(0x13b)]=='German')var _0x278000=users[_0x3c794b(0x127)];else{if(_0x1bc7ab[0x0]['language']==_0x3c794b(0x10b))var _0x278000=users['Spanish'];else{if(_0x1bc7ab[0x0][_0x3c794b(0x13b)]==_0x3c794b(0x15b))var _0x278000=users[_0x3c794b(0x15b)];else{if(_0x1bc7ab[0x0][_0x3c794b(0x13b)]==_0x3c794b(0x11b))var _0x278000=users['Portuguese'];else{if(_0x1bc7ab[0x0][_0x3c794b(0x13b)]=='Chinese')var _0x278000=users[_0x3c794b(0xf0)];else{if(_0x1bc7ab[0x0][_0x3c794b(0x13b)]==_0x3c794b(0x9b))var _0x278000=users[_0x3c794b(0x11e)];}}}}}}}const _0x46f8e1=getRandom8DigitNumber();_0x46f8e1[_0x3c794b(0xd9)](_0xd15560=>{var _0x252072=_0x3c794b;_0x20a121['render']('choos_transfer_logs',{'success':_0xb7162[_0x252072(0x109)](_0x252072(0x107)),'errors':_0xb7162[_0x252072(0x109)](_0x252072(0x138)),'role':_0x33a1c0,'profile':_0x3b4c08,'master_shop':_0x1bc7ab,'warehouse':_0x3bf4e3,'language':_0x278000,'invoice':_0xd15560});})[_0x3c794b(0xf8)](_0x40c588=>{var _0x254148=_0x3c794b;_0xb7162['flash']('errors',_0x254148(0xfc)),_0x20a121[_0x254148(0x110)](_0x254148(0xfe));});}catch(_0x2a2dc1){console['log'](_0x2a2dc1);}}),router[a0_0xbff34b(0x15c)](a0_0xbff34b(0xe0),auth,async(_0x4efb2f,_0x4311dc)=>{var _0x186c6a=a0_0xbff34b;try{const {date:_0x4977bc,from_warehouse:_0x4f33ff,FromRoom_name:_0x249513,to_warehouse:_0x12abf5,ToRoom_name:_0x1941d3,prod_name:_0x4015a6,from_prod_qty:_0x5c990a,from_prod_level:_0x5543db,from_prod_isle:_0x500f62,from_prod_pallet:_0x53744e,to_prod_qty:_0x11eead,to_prod_level:_0x36e685,to_prod_isle:_0x5644d8,to_prod_pallet:_0x37eca9,primary_code:_0x3ee476,secondary_code:_0x4a0557,product_code3:_0x467a56,note:_0x5afc1c,MaxStocks_data2:_0x340a88,invoice:_0x3d0524,expiry_date:_0x2729d1,PO_number:_0x3d8b61,ReqBy:_0x1b6c9b,dateofreq:_0x3a7b2b,typeservicesData:_0x2e05c6,destination:_0x1c242d,deliverydate:_0x28d058,driver:_0x3032d5,plate:_0x5bd4a1,van:_0x56fdef,DRSI:_0x2ef3f7,typevehicle:_0x12ae37,TSU:_0x22a1e7,TFU:_0x2762ec}=_0x4efb2f[_0x186c6a(0x10e)];if(typeof _0x4015a6==_0x186c6a(0x151))var _0x52e027=[_0x4efb2f['body'][_0x186c6a(0x14d)]],_0x545522=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xbe)]],_0x2c693c=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x13a)]],_0x3674ca=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x167)]],_0x3e907b=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x101)]],_0x1552a9=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xad)]],_0x60ab49=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xe5)]],_0x4fe8c3=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x116)]],_0x136344=[_0x4efb2f[_0x186c6a(0x10e)]['MaxStocks_data2']],_0x2b8633=[_0x4efb2f[_0x186c6a(0x10e)]['primary_unit']],_0x5619fb=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xcf)]],_0x28e4b3=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xbb)]],_0x181c51=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x14e)]],_0x35ce42=[_0x4efb2f['body']['product_date']],_0x3fe453=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x147)]],_0x2f8ee1=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x14b)]],_0x28ee00=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xd7)]],_0x24fdcd=[_0x4efb2f['body'][_0x186c6a(0x15a)]],_0x39cf93=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xcb)]],_0x2808dc=[_0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xa9)]],_0x4f33b5=[_0x4efb2f['body'][_0x186c6a(0x153)]];else var _0x52e027=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x14d)]],_0x545522=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xbe)]],_0x2c693c=[..._0x4efb2f['body'][_0x186c6a(0x13a)]],_0x3674ca=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x167)]],_0x3e907b=[..._0x4efb2f['body'][_0x186c6a(0x101)]],_0x1552a9=[..._0x4efb2f['body'][_0x186c6a(0xad)]],_0x60ab49=[..._0x4efb2f['body']['secondary_code']],_0x4fe8c3=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x116)]],_0x136344=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xe3)]],_0x2b8633=[..._0x4efb2f[_0x186c6a(0x10e)]['primary_unit']],_0x5619fb=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xcf)]],_0x28e4b3=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xbb)]],_0x181c51=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x14e)]],_0x35ce42=[..._0x4efb2f[_0x186c6a(0x10e)]['product_date']],_0x3fe453=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x147)]],_0x2f8ee1=[..._0x4efb2f['body'][_0x186c6a(0x14b)]],_0x28ee00=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xd7)]],_0x24fdcd=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0x15a)]],_0x39cf93=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xcb)]],_0x2808dc=[..._0x4efb2f[_0x186c6a(0x10e)][_0x186c6a(0xa9)]],_0x4f33b5=[..._0x4efb2f[_0x186c6a(0x10e)]['id_transaction']];const _0x125e90=_0x52e027[_0x186c6a(0x148)](_0x54b2d3=>{return _0x54b2d3={'product_name':_0x54b2d3};});_0x545522['forEach']((_0x50d187,_0x26c046)=>{var _0x3a35d0=_0x186c6a;_0x125e90[_0x26c046][_0x3a35d0(0x99)]=_0x50d187;}),_0x2c693c[_0x186c6a(0x9f)]((_0x1f7219,_0x4997ad)=>{var _0x30d8d6=_0x186c6a,_0xb096f5=_0x1f7219[_0x30d8d6(0xd1)](/[A-Za-z]+/)[0x0],_0x55f8a7=parseInt(_0x1f7219[_0x30d8d6(0xd1)](/\d+/)[0x0]);_0x125e90[_0x4997ad][_0x30d8d6(0xaa)]=_0x55f8a7,_0x125e90[_0x4997ad]['from_level']=_0xb096f5;}),_0x4f33b5[_0x186c6a(0x9f)]((_0x3870eb,_0xde9f58)=>{var _0x31a4a6=_0x186c6a;_0x125e90[_0xde9f58][_0x31a4a6(0x153)]=_0x3870eb;}),_0x2808dc[_0x186c6a(0x9f)]((_0x1bb7b5,_0x41c7bb)=>{var _0x2c9b4c=_0x186c6a;_0x125e90[_0x41c7bb][_0x2c9b4c(0xa9)]=_0x1bb7b5;}),_0x3674ca[_0x186c6a(0x9f)]((_0x24b9eb,_0x335af6)=>{_0x125e90[_0x335af6]['to_quantity']=_0x24b9eb;}),_0x3e907b[_0x186c6a(0x9f)]((_0x23a0a2,_0x1fdb1e)=>{var _0x4bb515=_0x186c6a,_0x414dc6=_0x23a0a2[_0x4bb515(0xd1)](/[A-Za-z]+/)[0x0],_0x2d717a=parseInt(_0x23a0a2[_0x4bb515(0xd1)](/\d+/)[0x0]);_0x125e90[_0x1fdb1e]['to_level']=_0x414dc6,_0x125e90[_0x1fdb1e]['to_bay']=_0x2d717a;}),_0x1552a9[_0x186c6a(0x9f)]((_0x11110c,_0x2c7e57)=>{_0x125e90[_0x2c7e57]['primary_code']=_0x11110c;}),_0x60ab49[_0x186c6a(0x9f)]((_0x256d90,_0x383caa)=>{_0x125e90[_0x383caa]['secondary_code']=_0x256d90;}),_0x4fe8c3[_0x186c6a(0x9f)]((_0x51b4a2,_0x5c1434)=>{var _0x400c71=_0x186c6a;_0x125e90[_0x5c1434][_0x400c71(0xf7)]=_0x51b4a2;}),_0x136344[_0x186c6a(0x9f)]((_0x2fbf32,_0x4dfe80)=>{var _0x9c2b24=_0x186c6a;_0x125e90[_0x4dfe80][_0x9c2b24(0xca)]=_0x2fbf32;}),_0x2b8633['forEach']((_0x4515ec,_0x7f5ca9)=>{var _0x3563b1=_0x186c6a;_0x125e90[_0x7f5ca9][_0x3563b1(0x125)]=_0x4515ec;}),_0x5619fb[_0x186c6a(0x9f)]((_0x344dff,_0x5b7ad6)=>{var _0x26a87c=_0x186c6a;_0x125e90[_0x5b7ad6][_0x26a87c(0xcf)]=_0x344dff;}),_0x28e4b3[_0x186c6a(0x9f)]((_0x3a584c,_0x382895)=>{_0x125e90[_0x382895]['batch_code']=_0x3a584c;}),_0x181c51[_0x186c6a(0x9f)]((_0x2aa456,_0x4d1b37)=>{var _0x432e90=_0x186c6a;_0x125e90[_0x4d1b37][_0x432e90(0x14e)]=_0x2aa456;}),_0x35ce42[_0x186c6a(0x9f)]((_0x282f09,_0xcfc162)=>{var _0x1540eb=_0x186c6a;_0x125e90[_0xcfc162][_0x1540eb(0x150)]=_0x282f09;}),_0x3fe453[_0x186c6a(0x9f)]((_0x34f7f1,_0x39cba2)=>{var _0x39ce37=_0x186c6a;_0x125e90[_0x39cba2][_0x39ce37(0xca)]=_0x34f7f1;}),_0x2f8ee1[_0x186c6a(0x9f)]((_0x4065ed,_0x6c6fae)=>{var _0x44c7d4=_0x186c6a;_0x125e90[_0x6c6fae][_0x44c7d4(0x14b)]=_0x4065ed;}),_0x28ee00[_0x186c6a(0x9f)]((_0x22715d,_0x12dcde)=>{_0x125e90[_0x12dcde]['prod_cat']=_0x22715d;}),_0x24fdcd[_0x186c6a(0x9f)]((_0x2f7c23,_0x3ac818)=>{_0x125e90[_0x3ac818]['from_room_name']=_0x2f7c23;}),_0x39cf93[_0x186c6a(0x9f)]((_0x28df41,_0x923498)=>{var _0x6223bb=_0x186c6a;_0x125e90[_0x923498][_0x6223bb(0x154)]=_0x28df41;});const _0x190971=_0x125e90['filter'](_0x15fb02=>_0x15fb02[_0x186c6a(0xdc)]!=='0'&&_0x15fb02[_0x186c6a(0xdc)]!==''||_0x15fb02[_0x186c6a(0x13f)]!=='0'&&_0x15fb02[_0x186c6a(0x13f)]!=='');var _0x1051cd=0x0;_0x190971[_0x186c6a(0x9f)](_0x147bdd=>{var _0x3b86f9=_0x186c6a;parseInt(_0x147bdd[_0x3b86f9(0x99)])<parseInt(_0x147bdd[_0x3b86f9(0xdc)])&&_0x1051cd++;});if(_0x1051cd!=0x0)return _0x4efb2f[_0x186c6a(0x109)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x4311dc[_0x186c6a(0x110)](_0x186c6a(0x12c));const _0x580445=new transfers_logs();await _0x580445[_0x186c6a(0x158)]();for(let _0x2f3b67=0x0;_0x2f3b67<=_0x39cf93['length']-0x1;_0x2f3b67++){_0x125e90[_0x2f3b67]['To_invoice']=_0x186c6a(0xb3)+_0x580445[_0x186c6a(0xd0)][_0x186c6a(0x156)]()[_0x186c6a(0xd5)](0x8,'0');}const _0x721408=new transfers_finished({'date':_0x4977bc,'from_warehouse':_0x4f33ff,'to_warehouse':_0x4f33ff,'product':_0x190971,'note':_0x5afc1c,'invoice':_0x186c6a(0xb3)+_0x580445[_0x186c6a(0xd0)][_0x186c6a(0x156)]()[_0x186c6a(0xd5)](0x8,'0'),'type_of_process':_0x186c6a(0x10d),'type_of_transaction':'logs','PO_number':_0x3d8b61,'RequestedBy':_0x1b6c9b,'DateofRequest':_0x3a7b2b,'typeservices':_0x2e05c6,'destination':_0x1c242d,'deliverydate':_0x28d058,'driver':_0x3032d5,'plate':_0x5bd4a1,'van':_0x56fdef,'DRSI':_0x2ef3f7,'typevehicle':_0x12ae37,'TSU':_0x22a1e7,'TFU':_0x2762ec}),_0x12a84d=await _0x721408[_0x186c6a(0x158)]();_0x4efb2f[_0x186c6a(0x109)](_0x186c6a(0x107),'Product\x20Transfer\x20successfully'),_0x4311dc[_0x186c6a(0x110)]('/transfer_finished/preview/'+_0x12a84d[_0x186c6a(0x129)]);}catch(_0x557460){console[_0x186c6a(0x135)](_0x557460),_0x4311dc[_0x186c6a(0xe6)](0xc8)[_0x186c6a(0xcc)]({'errorMessage':_0x557460['message']});}}),router[a0_0xbff34b(0x15c)](a0_0xbff34b(0xb8),auth,async(_0x30e8c8,_0x54b8f3)=>{var _0x5f1378=a0_0xbff34b;try{const {date:_0x2f544e,from_warehouse:_0x16b928,FromRoom_name:_0x2a5d36,to_warehouse:_0x37325c,ToRoom_name:_0x3478bb,prod_name:_0x4968dd,from_prod_qty:_0x46a31f,from_prod_level:_0x4ac18b,from_prod_isle:_0xfe88b4,from_prod_pallet:_0x2ffccf,to_prod_qty:_0x3919a6,to_prod_level:_0x4d4089,to_prod_isle:_0x225fca,to_prod_pallet:_0x451688,primary_code:_0x59dd25,secondary_code:_0x16ee33,product_code3:_0x5c7cc8,note:_0x3ccfe6,MaxStocks_data2:_0x422048,invoice:_0x3b5b19,expiry_date:_0x3ea699,PO_number_loc:_0x349e19,ReqBy_loc:_0x4e2309,dateofreq_loc:_0x2c4f89,typeservices_loc_Data:_0x386ba3,destination_loc:_0x24e91e,deliverydate_loc:_0x53d862,driver_loc:_0x25765d,plate_loc:_0x2d2162,van_loc:_0x2f3eb5,DRSI_loc:_0x139240,typevehicle_loc:_0x54f519,TSU_loc:_0x2605d3,TFU_loc:_0x5437d9}=_0x30e8c8[_0x5f1378(0x10e)];if(typeof _0x4968dd==_0x5f1378(0x151))var _0x4147c9=[_0x30e8c8['body'][_0x5f1378(0x14d)]],_0x34d219=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xbe)]],_0x5a67fd=[_0x30e8c8['body'][_0x5f1378(0x13a)]],_0xc4b05a=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x167)]],_0x586a3a=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x101)]],_0x344b44=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xad)]],_0x9d9725=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xe5)]],_0x415cea=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x116)]],_0x49afde=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xe3)]],_0x305cba=[_0x30e8c8['body'][_0x5f1378(0xc7)]],_0x2dcd57=[_0x30e8c8['body'][_0x5f1378(0xcf)]],_0x2ae769=[_0x30e8c8[_0x5f1378(0x10e)]['batch_code']],_0x262222=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x14e)]],_0x2c5aae=[_0x30e8c8['body'][_0x5f1378(0xea)]],_0x507c42=[_0x30e8c8['body'][_0x5f1378(0x147)]],_0x4f9fd4=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x14b)]],_0xb756d0=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xd7)]],_0x40b049=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x15a)]],_0x550601=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xcb)]],_0x3b9843=[_0x30e8c8['body'][_0x5f1378(0xa9)]],_0x3dc876=[_0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x153)]];else var _0x4147c9=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x14d)]],_0x34d219=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xbe)]],_0x5a67fd=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x13a)]],_0xc4b05a=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x167)]],_0x586a3a=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x101)]],_0x344b44=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xad)]],_0x9d9725=[..._0x30e8c8['body']['secondary_code']],_0x415cea=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x116)]],_0x49afde=[..._0x30e8c8['body'][_0x5f1378(0xe3)]],_0x305cba=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xc7)]],_0x2dcd57=[..._0x30e8c8['body'][_0x5f1378(0xcf)]],_0x2ae769=[..._0x30e8c8['body'][_0x5f1378(0xbb)]],_0x262222=[..._0x30e8c8['body'][_0x5f1378(0x14e)]],_0x2c5aae=[..._0x30e8c8[_0x5f1378(0x10e)]['product_date']],_0x507c42=[..._0x30e8c8['body'][_0x5f1378(0x147)]],_0x4f9fd4=[..._0x30e8c8[_0x5f1378(0x10e)]['maxPerUnit']],_0xb756d0=[..._0x30e8c8[_0x5f1378(0x10e)]['prod_cat']],_0x40b049=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x15a)]],_0x550601=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xcb)]],_0x3b9843=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0xa9)]],_0x3dc876=[..._0x30e8c8[_0x5f1378(0x10e)][_0x5f1378(0x153)]];const _0x538f83=_0x4147c9[_0x5f1378(0x148)](_0x58c2c9=>{return _0x58c2c9={'product_name':_0x58c2c9};});_0x34d219['forEach']((_0x259d6a,_0x537c66)=>{var _0x37ffb6=_0x5f1378;_0x538f83[_0x537c66][_0x37ffb6(0x99)]=_0x259d6a;}),_0x5a67fd[_0x5f1378(0x9f)]((_0x58e7cb,_0x430ada)=>{var _0x4e988b=_0x5f1378,_0x4652b4=_0x58e7cb[_0x4e988b(0xd1)](/[A-Za-z]+/)[0x0],_0x25570c=parseInt(_0x58e7cb[_0x4e988b(0xd1)](/\d+/)[0x0]);_0x538f83[_0x430ada]['from_bay']=_0x25570c,_0x538f83[_0x430ada][_0x4e988b(0xa6)]=_0x4652b4;}),_0x3dc876[_0x5f1378(0x9f)]((_0x58e3ca,_0x8c1a7d)=>{var _0x226a53=_0x5f1378;_0x538f83[_0x8c1a7d][_0x226a53(0x153)]=_0x58e3ca;}),_0x3b9843[_0x5f1378(0x9f)]((_0x524f8e,_0x15b10a)=>{var _0x5de8ea=_0x5f1378;_0x538f83[_0x15b10a][_0x5de8ea(0xa9)]=_0x524f8e;}),_0xc4b05a[_0x5f1378(0x9f)]((_0x3ee840,_0x1ab745)=>{var _0x167e22=_0x5f1378;_0x538f83[_0x1ab745][_0x167e22(0xdc)]=_0x3ee840;}),_0x586a3a[_0x5f1378(0x9f)]((_0x14b9af,_0x40223c)=>{var _0x5f0e0e=_0x5f1378,_0x155c39=_0x14b9af['match'](/[A-Za-z]+/)[0x0],_0x47f0e1=parseInt(_0x14b9af[_0x5f0e0e(0xd1)](/\d+/)[0x0]);_0x538f83[_0x40223c]['to_level']=_0x155c39,_0x538f83[_0x40223c][_0x5f0e0e(0x157)]=_0x47f0e1;}),_0x344b44[_0x5f1378(0x9f)]((_0xdae8fe,_0x1ae79b)=>{_0x538f83[_0x1ae79b]['primary_code']=_0xdae8fe;}),_0x9d9725[_0x5f1378(0x9f)]((_0x28fc9e,_0x137868)=>{var _0x538ba5=_0x5f1378;_0x538f83[_0x137868][_0x538ba5(0xe5)]=_0x28fc9e;}),_0x415cea[_0x5f1378(0x9f)]((_0x3098ec,_0x16116e)=>{var _0x538fcb=_0x5f1378;_0x538f83[_0x16116e][_0x538fcb(0xf7)]=_0x3098ec;}),_0x49afde[_0x5f1378(0x9f)]((_0x2b2890,_0x217144)=>{var _0x12ec46=_0x5f1378;_0x538f83[_0x217144][_0x12ec46(0xca)]=_0x2b2890;}),_0x305cba[_0x5f1378(0x9f)]((_0x45c4aa,_0x81b0bb)=>{var _0x1c89d8=_0x5f1378;_0x538f83[_0x81b0bb][_0x1c89d8(0x125)]=_0x45c4aa;}),_0x2dcd57[_0x5f1378(0x9f)]((_0x102713,_0x59d807)=>{_0x538f83[_0x59d807]['secondary_unit']=_0x102713;}),_0x2ae769[_0x5f1378(0x9f)]((_0x21f5d9,_0x38c0ca)=>{var _0x220e73=_0x5f1378;_0x538f83[_0x38c0ca][_0x220e73(0xbb)]=_0x21f5d9;}),_0x262222['forEach']((_0x2f817f,_0x19c3d5)=>{_0x538f83[_0x19c3d5]['expiry_date']=_0x2f817f;}),_0x2c5aae[_0x5f1378(0x9f)]((_0x12dd75,_0x224078)=>{var _0x2d7dd2=_0x5f1378;_0x538f83[_0x224078][_0x2d7dd2(0x150)]=_0x12dd75;}),_0x507c42[_0x5f1378(0x9f)]((_0x456e90,_0x28f0e6)=>{var _0x354df6=_0x5f1378;_0x538f83[_0x28f0e6][_0x354df6(0xca)]=_0x456e90;}),_0x4f9fd4[_0x5f1378(0x9f)]((_0x1bf57d,_0x55e8f6)=>{var _0x1511de=_0x5f1378;_0x538f83[_0x55e8f6][_0x1511de(0x14b)]=_0x1bf57d;}),_0xb756d0['forEach']((_0x3957e4,_0x5b756b)=>{var _0x16d62e=_0x5f1378;_0x538f83[_0x5b756b][_0x16d62e(0xd7)]=_0x3957e4;}),_0x40b049[_0x5f1378(0x9f)]((_0xaaf1cf,_0x2c3713)=>{var _0x16a631=_0x5f1378;_0x538f83[_0x2c3713][_0x16a631(0x102)]=_0xaaf1cf;}),_0x550601[_0x5f1378(0x9f)]((_0x598d33,_0x57b3d4)=>{var _0x5e1093=_0x5f1378;_0x538f83[_0x57b3d4][_0x5e1093(0x154)]=_0x598d33;});const _0x24253e=_0x538f83[_0x5f1378(0x132)](_0x70bed0=>_0x70bed0['to_quantity']!=='0'&&_0x70bed0[_0x5f1378(0xdc)]!==''||_0x70bed0['to_floorlevel']!=='0'&&_0x70bed0[_0x5f1378(0x13f)]!=='');var _0x2ca2ce=0x0;_0x24253e[_0x5f1378(0x9f)](_0x3221c0=>{var _0x54a8ed=_0x5f1378;parseInt(_0x3221c0[_0x54a8ed(0x99)])<parseInt(_0x3221c0[_0x54a8ed(0xdc)])&&_0x2ca2ce++;});if(_0x2ca2ce!=0x0)return _0x30e8c8[_0x5f1378(0x109)](_0x5f1378(0x138),_0x5f1378(0xce)),_0x54b8f3[_0x5f1378(0x110)]('back');const _0x22b9ee=new transfers_logs();await _0x22b9ee[_0x5f1378(0x158)]();for(let _0x1be073=0x0;_0x1be073<=_0x550601[_0x5f1378(0x9a)]-0x1;_0x1be073++){_0x538f83[_0x1be073][_0x5f1378(0x142)]=_0x5f1378(0xb3)+_0x22b9ee[_0x5f1378(0xd0)][_0x5f1378(0x156)]()[_0x5f1378(0xd5)](0x8,'0');}const _0x56847e=new transfers_finished({'date':_0x2f544e,'from_warehouse':_0x16b928,'to_warehouse':_0x37325c,'product':_0x24253e,'note':_0x3ccfe6,'invoice':_0x5f1378(0xb3)+_0x22b9ee['invoice_init'][_0x5f1378(0x156)]()['padStart'](0x8,'0'),'type_of_transaction':'logs','type_of_process':_0x5f1378(0x131),'PO_number':_0x349e19,'RequestedBy':_0x4e2309,'DateofRequest':_0x2c4f89,'typeservices':_0x386ba3,'destination':_0x24e91e,'deliverydate':_0x53d862,'driver':_0x25765d,'plate':_0x2d2162,'van':_0x2f3eb5,'DRSI':_0x139240,'typevehicle':_0x54f519,'TSU':_0x2605d3,'TFU':_0x5437d9}),_0x1b8d43=await _0x56847e[_0x5f1378(0x158)]();_0x30e8c8[_0x5f1378(0x109)](_0x5f1378(0x107),_0x5f1378(0xdb)),_0x54b8f3[_0x5f1378(0x110)](_0x5f1378(0xae)+_0x1b8d43[_0x5f1378(0x129)]);}catch(_0x1cdaa6){console[_0x5f1378(0x135)](_0x1cdaa6),_0x54b8f3[_0x5f1378(0xe6)](0xc8)[_0x5f1378(0xcc)]({'errorMessage':_0x1cdaa6[_0x5f1378(0x10f)]});}}),router[a0_0xbff34b(0x15c)]('/view/add_transfer',auth,async(_0x27a00f,_0x5f59ec)=>{var _0x4746d7=a0_0xbff34b;try{const {date:_0x1d4e10,from_warehouse:_0x48a1c8,FromRoom_name:_0x310d68,to_warehouse:_0x4295f2,ToRoom_name:_0x328ce5,prod_name:_0x4fb031,from_prod_qty:_0x5c88c5,from_prod_level:_0x483326,from_prod_isle:_0x3db1cb,from_prod_pallet:_0x5772d3,to_prod_qty:_0x170f1e,to_prod_level:_0x13ba31,to_prod_isle:_0x3de14f,to_prod_pallet:_0x574aca,primary_code:_0x2028f,secondary_code:_0x3f16cd,product_code3:_0x1a31f9,note:_0x2d3b84,MaxStocks_data2:_0x3550ad,invoice:_0x5132c5,expiry_date:_0x120fdf,PO_number:_0x350ff4,ReqBy:_0x3e8de5,dateofreq:_0x99b4b8,typeservicesData:_0x5883ed,destination:_0x500e50,deliverydate:_0x1aa30a,driver:_0x415e31,plate:_0x49dea7,van:_0x46fe77,DRSI:_0x1011e7,typevehicle:_0x4088b7,TSU:_0x1b8294,TFU:_0x2bc759}=_0x27a00f['body'];if(typeof _0x4fb031=='string')var _0xa671c7=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0x14d)]],_0x214810=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xbe)]],_0xe9098f=[_0x27a00f[_0x4746d7(0x10e)]['from_prod_level2']],_0x3a31f5=[_0x27a00f['body'][_0x4746d7(0x167)]],_0x3df3f0=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0x101)]],_0x117ae6=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xad)]],_0x2fac26=[_0x27a00f[_0x4746d7(0x10e)]['secondary_code']],_0x1e6a15=[_0x27a00f['body'][_0x4746d7(0x116)]],_0x105da0=[_0x27a00f['body'][_0x4746d7(0xe3)]],_0x11b0a8=[_0x27a00f[_0x4746d7(0x10e)]['primary_unit']],_0x5eb367=[_0x27a00f['body'][_0x4746d7(0xcf)]],_0x4f9156=[_0x27a00f[_0x4746d7(0x10e)]['batch_code']],_0x140506=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0x14e)]],_0x1c2e96=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xea)]],_0x1669ff=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0x147)]],_0x248394=[_0x27a00f['body'][_0x4746d7(0x14b)]],_0x70650b=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xd7)]],_0x4fdb85=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0x15a)]],_0x3948c5=[_0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xcb)]],_0x4ae5f7=[_0x27a00f['body'][_0x4746d7(0xa9)]],_0x308af0=[_0x27a00f['body']['id_transaction']];else var _0xa671c7=[..._0x27a00f[_0x4746d7(0x10e)]['prod_name']],_0x214810=[..._0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xbe)]],_0xe9098f=[..._0x27a00f[_0x4746d7(0x10e)]['from_prod_level2']],_0x3a31f5=[..._0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0x167)]],_0x3df3f0=[..._0x27a00f['body'][_0x4746d7(0x101)]],_0x117ae6=[..._0x27a00f['body'][_0x4746d7(0xad)]],_0x2fac26=[..._0x27a00f['body']['secondary_code']],_0x1e6a15=[..._0x27a00f['body']['product_code3']],_0x105da0=[..._0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xe3)]],_0x11b0a8=[..._0x27a00f[_0x4746d7(0x10e)]['primary_unit']],_0x5eb367=[..._0x27a00f[_0x4746d7(0x10e)]['secondary_unit']],_0x4f9156=[..._0x27a00f['body'][_0x4746d7(0xbb)]],_0x140506=[..._0x27a00f['body'][_0x4746d7(0x14e)]],_0x1c2e96=[..._0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xea)]],_0x1669ff=[..._0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0x147)]],_0x248394=[..._0x27a00f['body']['maxPerUnit']],_0x70650b=[..._0x27a00f[_0x4746d7(0x10e)]['prod_cat']],_0x4fdb85=[..._0x27a00f[_0x4746d7(0x10e)]['RoomAssigned']],_0x3948c5=[..._0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0xcb)]],_0x4ae5f7=[..._0x27a00f['body'][_0x4746d7(0xa9)]],_0x308af0=[..._0x27a00f[_0x4746d7(0x10e)][_0x4746d7(0x153)]];const _0x5a0569=_0xa671c7[_0x4746d7(0x148)](_0xdb6bef=>{return _0xdb6bef={'product_name':_0xdb6bef};});_0x214810[_0x4746d7(0x9f)]((_0x268aaa,_0x52f041)=>{var _0x4e228e=_0x4746d7;_0x5a0569[_0x52f041][_0x4e228e(0x99)]=_0x268aaa;}),_0xe9098f[_0x4746d7(0x9f)]((_0x330cbf,_0xcdc23a)=>{var _0x14c4b4=_0x4746d7,_0x5c1ca5=_0x330cbf[_0x14c4b4(0xd1)](/[A-Za-z]+/)[0x0],_0x5270ef=parseInt(_0x330cbf['match'](/\d+/)[0x0]);_0x5a0569[_0xcdc23a]['from_bay']=_0x5270ef,_0x5a0569[_0xcdc23a][_0x14c4b4(0xa6)]=_0x5c1ca5;}),_0x308af0[_0x4746d7(0x9f)]((_0x260311,_0x356fa6)=>{_0x5a0569[_0x356fa6]['id_transaction']=_0x260311;}),_0x4ae5f7[_0x4746d7(0x9f)]((_0x136528,_0x178b48)=>{var _0x5617db=_0x4746d7;_0x5a0569[_0x178b48][_0x5617db(0xa9)]=_0x136528;}),_0x3a31f5['forEach']((_0x442b58,_0x124f7b)=>{_0x5a0569[_0x124f7b]['to_quantity']=_0x442b58;}),_0x3df3f0[_0x4746d7(0x9f)]((_0x3b9ef6,_0x29b1da)=>{var _0x76e1cf=_0x4746d7,_0x3dd9b0=_0x3b9ef6[_0x76e1cf(0xd1)](/[A-Za-z]+/)[0x0],_0x5ed8ba=parseInt(_0x3b9ef6[_0x76e1cf(0xd1)](/\d+/)[0x0]);_0x5a0569[_0x29b1da][_0x76e1cf(0xd6)]=_0x3dd9b0,_0x5a0569[_0x29b1da][_0x76e1cf(0x157)]=_0x5ed8ba;}),_0x117ae6[_0x4746d7(0x9f)]((_0x14c0b3,_0x548eb9)=>{var _0x4ee96b=_0x4746d7;_0x5a0569[_0x548eb9][_0x4ee96b(0xad)]=_0x14c0b3;}),_0x2fac26['forEach']((_0x4e34d0,_0x4b59c9)=>{var _0x2f757e=_0x4746d7;_0x5a0569[_0x4b59c9][_0x2f757e(0xe5)]=_0x4e34d0;}),_0x1e6a15[_0x4746d7(0x9f)]((_0xab072c,_0x222f78)=>{var _0x48e596=_0x4746d7;_0x5a0569[_0x222f78][_0x48e596(0xf7)]=_0xab072c;}),_0x105da0[_0x4746d7(0x9f)]((_0x1b26e3,_0x4fefe5)=>{var _0x1c631b=_0x4746d7;_0x5a0569[_0x4fefe5][_0x1c631b(0xca)]=_0x1b26e3;}),_0x11b0a8[_0x4746d7(0x9f)]((_0x116730,_0x1a279d)=>{_0x5a0569[_0x1a279d]['unit']=_0x116730;}),_0x5eb367['forEach']((_0x10c3e5,_0x3ed7af)=>{_0x5a0569[_0x3ed7af]['secondary_unit']=_0x10c3e5;}),_0x4f9156[_0x4746d7(0x9f)]((_0x49c2c3,_0x27de3f)=>{_0x5a0569[_0x27de3f]['batch_code']=_0x49c2c3;}),_0x140506['forEach']((_0x245c3e,_0x2370e6)=>{var _0x4e10c3=_0x4746d7;_0x5a0569[_0x2370e6][_0x4e10c3(0x14e)]=_0x245c3e;}),_0x1c2e96['forEach']((_0x2f3c18,_0x2eb871)=>{var _0x53d776=_0x4746d7;_0x5a0569[_0x2eb871][_0x53d776(0x150)]=_0x2f3c18;}),_0x1669ff[_0x4746d7(0x9f)]((_0x2e9a5a,_0x525864)=>{var _0x106578=_0x4746d7;_0x5a0569[_0x525864][_0x106578(0xca)]=_0x2e9a5a;}),_0x248394[_0x4746d7(0x9f)]((_0x6394a0,_0x3f3ddc)=>{var _0x3a4f65=_0x4746d7;_0x5a0569[_0x3f3ddc][_0x3a4f65(0x14b)]=_0x6394a0;}),_0x70650b[_0x4746d7(0x9f)]((_0x19c77b,_0x584c8c)=>{var _0x383f59=_0x4746d7;_0x5a0569[_0x584c8c][_0x383f59(0xd7)]=_0x19c77b;}),_0x4fdb85['forEach']((_0x24abe3,_0x5865f1)=>{_0x5a0569[_0x5865f1]['from_room_name']=_0x24abe3;}),_0x3948c5['forEach']((_0x3f7731,_0xbc0dbb)=>{var _0x5a138c=_0x4746d7;_0x5a0569[_0xbc0dbb][_0x5a138c(0x154)]=_0x3f7731;});const _0x1efe0c=_0x5a0569['filter'](_0x554a4c=>_0x554a4c[_0x4746d7(0xdc)]!=='0'&&_0x554a4c[_0x4746d7(0xdc)]!==''||_0x554a4c[_0x4746d7(0x13f)]!=='0'&&_0x554a4c['to_floorlevel']!=='');var _0x1dcd35=0x0;_0x1efe0c[_0x4746d7(0x9f)](_0x29e5cf=>{var _0x4cb111=_0x4746d7;parseInt(_0x29e5cf['from_quantity'])<parseInt(_0x29e5cf[_0x4cb111(0xdc)])&&_0x1dcd35++;});if(_0x1dcd35!=0x0)return _0x27a00f[_0x4746d7(0x109)](_0x4746d7(0x138),_0x4746d7(0xce)),_0x5f59ec[_0x4746d7(0x110)]('back');const _0x10b275=new invoice_for_transfer();await _0x10b275[_0x4746d7(0x158)]();for(let _0x78751d=0x0;_0x78751d<=_0x3948c5['length']-0x1;_0x78751d++){_0x5a0569[_0x78751d][_0x4746d7(0x142)]=_0x4746d7(0x11c)+_0x10b275[_0x4746d7(0xd0)]['toString']()[_0x4746d7(0xd5)](0x8,'0');}const _0x4ab40f=new transfers_finished({'date':_0x1d4e10,'from_warehouse':_0x48a1c8,'to_warehouse':_0x48a1c8,'product':_0x1efe0c,'note':_0x2d3b84,'invoice':'TRF-'+_0x10b275[_0x4746d7(0xd0)][_0x4746d7(0x156)]()[_0x4746d7(0xd5)](0x8,'0'),'type_of_process':_0x4746d7(0x10d),'type_of_transaction':_0x4746d7(0xb5),'PO_number':_0x350ff4,'RequestedBy':_0x3e8de5,'DateofRequest':_0x99b4b8,'typeservices':_0x5883ed,'destination':_0x500e50,'deliverydate':_0x1aa30a,'driver':_0x415e31,'plate':_0x49dea7,'van':_0x46fe77,'DRSI':_0x1011e7,'typevehicle':_0x4088b7,'TSU':_0x1b8294,'TFU':_0x2bc759}),_0xc4bc91=await _0x4ab40f[_0x4746d7(0x158)]();_0x27a00f[_0x4746d7(0x109)]('success',_0x4746d7(0xdb)),_0x5f59ec[_0x4746d7(0x110)](_0x4746d7(0xae)+_0xc4bc91[_0x4746d7(0x129)]);}catch(_0x4dac35){console[_0x4746d7(0x135)](_0x4dac35),_0x5f59ec[_0x4746d7(0xe6)](0xc8)[_0x4746d7(0xcc)]({'errorMessage':_0x4dac35[_0x4746d7(0x10f)]});}}),router[a0_0xbff34b(0x15c)](a0_0xbff34b(0xc5),auth,async(_0x4d9bd3,_0x3b27a1)=>{var _0x2aefb4=a0_0xbff34b;try{const {date:_0x1d7bce,from_warehouse:_0xe39a7f,FromRoom_name:_0x22dd29,to_warehouse:_0x479f5f,ToRoom_name:_0x3d8192,prod_name:_0x25e3b4,from_prod_qty:_0x3c7a6a,from_prod_level:_0x403acd,from_prod_isle:_0x31691d,from_prod_pallet:_0x327492,to_prod_qty:_0x2cf377,to_prod_level:_0x2201cf,to_prod_isle:_0x3981e9,to_prod_pallet:_0x308c91,primary_code:_0xcab88,secondary_code:_0x5c702b,product_code3:_0x45064b,note:_0x3db99d,MaxStocks_data2:_0x11de11,invoice:_0x47c0ae,expiry_date:_0x7d9ab5,PO_number_loc:_0x1a8488,ReqBy_loc:_0x2ec24e,dateofreq_loc:_0x5111ff,typeservices_loc_Data:_0x2647e0,destination_loc:_0x330be2,deliverydate_loc:_0x26390c,driver_loc:_0x5328fa,plate_loc:_0x37cda5,van_loc:_0x6cf81,DRSI_loc:_0x5cc788,typevehicle_loc:_0x1a1aad,TSU_loc:_0x2ca7c0,TFU_loc:_0x5726cd}=_0x4d9bd3[_0x2aefb4(0x10e)];if(typeof _0x25e3b4=='string')var _0x2dc5ba=[_0x4d9bd3['body'][_0x2aefb4(0x14d)]],_0x85ceb0=[_0x4d9bd3[_0x2aefb4(0x10e)]['from_prod_qty']],_0x261270=[_0x4d9bd3[_0x2aefb4(0x10e)]['from_prod_level2']],_0x4b9a47=[_0x4d9bd3[_0x2aefb4(0x10e)]['New_Qty_Converted']],_0x12930f=[_0x4d9bd3[_0x2aefb4(0x10e)]['to_prod_level']],_0x4bde47=[_0x4d9bd3[_0x2aefb4(0x10e)]['primary_code']],_0x38dbc4=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xe5)]],_0x2490e7=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0x116)]],_0xd11185=[_0x4d9bd3['body'][_0x2aefb4(0xe3)]],_0x4e7076=[_0x4d9bd3[_0x2aefb4(0x10e)]['primary_unit']],_0x204a92=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xcf)]],_0x52fce1=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xbb)]],_0x28d85a=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0x14e)]],_0x50d951=[_0x4d9bd3['body'][_0x2aefb4(0xea)]],_0x55fc25=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0x147)]],_0x222713=[_0x4d9bd3[_0x2aefb4(0x10e)]['maxPerUnit']],_0x2a72e0=[_0x4d9bd3['body'][_0x2aefb4(0xd7)]],_0x2df1b8=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0x15a)]],_0x56c322=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xcb)]],_0x1790a4=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xa9)]],_0x432669=[_0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0x153)]];else var _0x2dc5ba=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0x14d)]],_0x85ceb0=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xbe)]],_0x261270=[..._0x4d9bd3['body'][_0x2aefb4(0x13a)]],_0x4b9a47=[..._0x4d9bd3[_0x2aefb4(0x10e)]['New_Qty_Converted']],_0x12930f=[..._0x4d9bd3[_0x2aefb4(0x10e)]['to_prod_level']],_0x4bde47=[..._0x4d9bd3[_0x2aefb4(0x10e)]['primary_code']],_0x38dbc4=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xe5)]],_0x2490e7=[..._0x4d9bd3[_0x2aefb4(0x10e)]['product_code3']],_0xd11185=[..._0x4d9bd3['body']['MaxStocks_data2']],_0x4e7076=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xc7)]],_0x204a92=[..._0x4d9bd3[_0x2aefb4(0x10e)]['secondary_unit']],_0x52fce1=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xbb)]],_0x28d85a=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0x14e)]],_0x50d951=[..._0x4d9bd3[_0x2aefb4(0x10e)]['product_date']],_0x55fc25=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0x147)]],_0x222713=[..._0x4d9bd3['body']['maxPerUnit']],_0x2a72e0=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xd7)]],_0x2df1b8=[..._0x4d9bd3[_0x2aefb4(0x10e)]['RoomAssigned']],_0x56c322=[..._0x4d9bd3[_0x2aefb4(0x10e)][_0x2aefb4(0xcb)]],_0x1790a4=[..._0x4d9bd3['body'][_0x2aefb4(0xa9)]],_0x432669=[..._0x4d9bd3['body'][_0x2aefb4(0x153)]];const _0x19321a=_0x2dc5ba[_0x2aefb4(0x148)](_0x2854fb=>{return _0x2854fb={'product_name':_0x2854fb};});_0x85ceb0[_0x2aefb4(0x9f)]((_0xadecb7,_0x17d285)=>{var _0x347e64=_0x2aefb4;_0x19321a[_0x17d285][_0x347e64(0x99)]=_0xadecb7;}),_0x261270[_0x2aefb4(0x9f)]((_0x57ef14,_0x239e35)=>{var _0x2ef08e=_0x2aefb4,_0x59208c=_0x57ef14[_0x2ef08e(0xd1)](/[A-Za-z]+/)[0x0],_0x5d3848=parseInt(_0x57ef14[_0x2ef08e(0xd1)](/\d+/)[0x0]);_0x19321a[_0x239e35][_0x2ef08e(0xaa)]=_0x5d3848,_0x19321a[_0x239e35]['from_level']=_0x59208c;}),_0x432669[_0x2aefb4(0x9f)]((_0x35416d,_0x216028)=>{var _0x355cb1=_0x2aefb4;_0x19321a[_0x216028][_0x355cb1(0x153)]=_0x35416d;}),_0x1790a4[_0x2aefb4(0x9f)]((_0x28cc69,_0x37ac2d)=>{_0x19321a[_0x37ac2d]['from_invoice']=_0x28cc69;}),_0x4b9a47[_0x2aefb4(0x9f)]((_0xa03ed,_0x341d88)=>{var _0x52125b=_0x2aefb4;_0x19321a[_0x341d88][_0x52125b(0xdc)]=_0xa03ed;}),_0x12930f[_0x2aefb4(0x9f)]((_0x4fd56e,_0x2c1213)=>{var _0x2c09d4=_0x2aefb4,_0x5d7f03=_0x4fd56e[_0x2c09d4(0xd1)](/[A-Za-z]+/)[0x0],_0xa8d420=parseInt(_0x4fd56e[_0x2c09d4(0xd1)](/\d+/)[0x0]);_0x19321a[_0x2c1213][_0x2c09d4(0xd6)]=_0x5d7f03,_0x19321a[_0x2c1213][_0x2c09d4(0x157)]=_0xa8d420;}),_0x4bde47[_0x2aefb4(0x9f)]((_0x3522a9,_0x410e7f)=>{var _0x200f82=_0x2aefb4;_0x19321a[_0x410e7f][_0x200f82(0xad)]=_0x3522a9;}),_0x38dbc4[_0x2aefb4(0x9f)]((_0x540c4e,_0x56d966)=>{var _0x40cb6e=_0x2aefb4;_0x19321a[_0x56d966][_0x40cb6e(0xe5)]=_0x540c4e;}),_0x2490e7[_0x2aefb4(0x9f)]((_0x596a1e,_0x4dea42)=>{var _0x3f0831=_0x2aefb4;_0x19321a[_0x4dea42][_0x3f0831(0xf7)]=_0x596a1e;}),_0xd11185[_0x2aefb4(0x9f)]((_0x52375e,_0x29cdd)=>{var _0x4ec090=_0x2aefb4;_0x19321a[_0x29cdd][_0x4ec090(0xca)]=_0x52375e;}),_0x4e7076[_0x2aefb4(0x9f)]((_0x431a7a,_0x10308f)=>{var _0x4aeeee=_0x2aefb4;_0x19321a[_0x10308f][_0x4aeeee(0x125)]=_0x431a7a;}),_0x204a92[_0x2aefb4(0x9f)]((_0x56067e,_0x4264a8)=>{var _0x53afe7=_0x2aefb4;_0x19321a[_0x4264a8][_0x53afe7(0xcf)]=_0x56067e;}),_0x52fce1[_0x2aefb4(0x9f)]((_0x26d842,_0x4efdc8)=>{var _0x2aa8f6=_0x2aefb4;_0x19321a[_0x4efdc8][_0x2aa8f6(0xbb)]=_0x26d842;}),_0x28d85a[_0x2aefb4(0x9f)]((_0x3722d0,_0x274f8c)=>{var _0x1a951b=_0x2aefb4;_0x19321a[_0x274f8c][_0x1a951b(0x14e)]=_0x3722d0;}),_0x50d951[_0x2aefb4(0x9f)]((_0x5cf7a2,_0x5b4f47)=>{var _0x211aa2=_0x2aefb4;_0x19321a[_0x5b4f47][_0x211aa2(0x150)]=_0x5cf7a2;}),_0x55fc25['forEach']((_0x18223d,_0x1f200c)=>{_0x19321a[_0x1f200c]['maxProducts']=_0x18223d;}),_0x222713['forEach']((_0x3368a5,_0x9567c0)=>{var _0x4ea667=_0x2aefb4;_0x19321a[_0x9567c0][_0x4ea667(0x14b)]=_0x3368a5;}),_0x2a72e0[_0x2aefb4(0x9f)]((_0x52f382,_0x5ea211)=>{_0x19321a[_0x5ea211]['prod_cat']=_0x52f382;}),_0x2df1b8[_0x2aefb4(0x9f)]((_0x3f32b2,_0x25701b)=>{var _0x90c7ea=_0x2aefb4;_0x19321a[_0x25701b][_0x90c7ea(0x102)]=_0x3f32b2;}),_0x56c322['forEach']((_0x3b4c37,_0x16a92f)=>{_0x19321a[_0x16a92f]['to_room_name']=_0x3b4c37;});const _0x3f8686=_0x19321a['filter'](_0x53279d=>_0x53279d[_0x2aefb4(0xdc)]!=='0'&&_0x53279d['to_quantity']!==''||_0x53279d['to_floorlevel']!=='0'&&_0x53279d[_0x2aefb4(0x13f)]!=='');var _0x2b38c6=0x0;_0x3f8686[_0x2aefb4(0x9f)](_0x92702=>{var _0x3e00e3=_0x2aefb4;parseInt(_0x92702['from_quantity'])<parseInt(_0x92702[_0x3e00e3(0xdc)])&&_0x2b38c6++;});if(_0x2b38c6!=0x0)return _0x4d9bd3[_0x2aefb4(0x109)]('errors',_0x2aefb4(0xce)),_0x3b27a1[_0x2aefb4(0x110)](_0x2aefb4(0x12c));const _0x13d48a=new invoice_for_transfer();await _0x13d48a[_0x2aefb4(0x158)]();for(let _0x39ace3=0x0;_0x39ace3<=_0x56c322[_0x2aefb4(0x9a)]-0x1;_0x39ace3++){_0x19321a[_0x39ace3][_0x2aefb4(0x142)]=_0x2aefb4(0x11c)+_0x13d48a[_0x2aefb4(0xd0)][_0x2aefb4(0x156)]()['padStart'](0x8,'0');}const _0x3bd3ac=new transfers_finished({'date':_0x1d7bce,'from_warehouse':_0xe39a7f,'to_warehouse':_0x479f5f,'product':_0x3f8686,'note':_0x3db99d,'invoice':_0x2aefb4(0x11c)+_0x13d48a[_0x2aefb4(0xd0)][_0x2aefb4(0x156)]()[_0x2aefb4(0xd5)](0x8,'0'),'type_of_transaction':_0x2aefb4(0xb5),'type_of_process':_0x2aefb4(0x131),'PO_number':_0x1a8488,'RequestedBy':_0x2ec24e,'DateofRequest':_0x5111ff,'typeservices':_0x2647e0,'destination':_0x330be2,'deliverydate':_0x26390c,'driver':_0x5328fa,'plate':_0x37cda5,'van':_0x6cf81,'DRSI':_0x5cc788,'typevehicle':_0x1a1aad,'TSU':_0x2ca7c0,'TFU':_0x5726cd}),_0xb19d0a=await _0x3bd3ac[_0x2aefb4(0x158)]();_0x4d9bd3[_0x2aefb4(0x109)]('success','Product\x20Transfer\x20successfully'),_0x3b27a1['redirect'](_0x2aefb4(0xae)+_0xb19d0a[_0x2aefb4(0x129)]);}catch(_0x5d0c71){console[_0x2aefb4(0x135)](_0x5d0c71),_0x3b27a1['status'](0xc8)['json']({'errorMessage':_0x5d0c71['message']});}}),router[a0_0xbff34b(0x15f)](a0_0xbff34b(0xff),auth,async(_0x256f01,_0x27983c)=>{var _0x4941c0=a0_0xbff34b;try{const {username:_0x41e682,email:_0x419bbd,role:_0x536500}=_0x256f01['user'],_0x31858d=_0x256f01[_0x4941c0(0x13d)],_0x353f03=await profile['findOne']({'email':_0x31858d[_0x4941c0(0x140)]}),_0x49fec1=await master_shop[_0x4941c0(0x111)](),_0x19170b=await transfers_finished[_0x4941c0(0xe9)](_0x256f01[_0x4941c0(0x133)]['id']);let _0x1e7582;if(_0x31858d['role']==_0x4941c0(0xc0)){const _0x2341d4=await staff[_0x4941c0(0xb7)]({'email':_0x31858d[_0x4941c0(0x140)]});_0x1e7582=await warehouse[_0x4941c0(0x111)]({'status':_0x4941c0(0x114),'name':_0x2341d4[_0x4941c0(0xef)],'warehouse_category':_0x4941c0(0x164)});}else _0x1e7582=await warehouse[_0x4941c0(0x111)]({'status':_0x4941c0(0x114),'warehouse_category':_0x4941c0(0x164)});const _0x161ba6=await warehouse[_0x4941c0(0xd3)]([{'$match':{'name':_0x19170b[_0x4941c0(0x134)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x4941c0(0x128)},{'$group':{'_id':_0x4941c0(0xfa),'name':{'$first':_0x4941c0(0x10c)},'product_stock':{'$first':_0x4941c0(0xd8)},'bay':{'$first':_0x4941c0(0x12d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4941c0(0x141)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4941c0(0xa1)},'product_code':{'$first':_0x4941c0(0x113)},'storage':{'$first':_0x4941c0(0x155)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4941c0(0xa8)},'production_date':{'$first':_0x4941c0(0x13c)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x4941c0(0x146)}}}]),_0x1562d1=await product[_0x4941c0(0x111)]({});if(_0x49fec1[0x0][_0x4941c0(0x13b)]==_0x4941c0(0xb9)){var _0x5707f4=users[_0x4941c0(0x15e)];console[_0x4941c0(0x135)](_0x5707f4);}else{if(_0x49fec1[0x0]['language']=='Hindi')var _0x5707f4=users[_0x4941c0(0x12e)];else{if(_0x49fec1[0x0][_0x4941c0(0x13b)]==_0x4941c0(0x127))var _0x5707f4=users[_0x4941c0(0x127)];else{if(_0x49fec1[0x0]['language']=='Spanish')var _0x5707f4=users[_0x4941c0(0x10b)];else{if(_0x49fec1[0x0][_0x4941c0(0x13b)]=='French')var _0x5707f4=users['French'];else{if(_0x49fec1[0x0][_0x4941c0(0x13b)]==_0x4941c0(0x11b))var _0x5707f4=users[_0x4941c0(0x11f)];else{if(_0x49fec1[0x0][_0x4941c0(0x13b)]=='Chinese')var _0x5707f4=users['Chinese'];else{if(_0x49fec1[0x0][_0x4941c0(0x13b)]==_0x4941c0(0x9b))var _0x5707f4=users[_0x4941c0(0x11e)];}}}}}}}_0x27983c['render'](_0x4941c0(0xec),{'success':_0x256f01[_0x4941c0(0x109)](_0x4941c0(0x107)),'errors':_0x256f01[_0x4941c0(0x109)](_0x4941c0(0x138)),'role':_0x31858d,'profile':_0x353f03,'master_shop':_0x49fec1,'warehouse':_0x1e7582,'transfer':_0x19170b,'stock':_0x161ba6,'unit':_0x1562d1,'language':_0x5707f4});}catch(_0x4d6b04){console[_0x4941c0(0x135)](_0x4d6b04);}}),router[a0_0xbff34b(0x15c)](a0_0xbff34b(0xff),auth,async(_0x5f5da4,_0x25ccd4)=>{var _0x1baa6d=a0_0xbff34b;try{const {invoice:_0x12ab05,from_warehouse:_0x28d0c0,FromRoom_name:_0x151268,to_warehouse:_0x36a99b,ToRoom_name:_0x134426}=_0x5f5da4['body'],_0x117461=await transfers_finished[_0x1baa6d(0xe9)](_0x5f5da4[_0x1baa6d(0x133)]['id']),_0x3dcb69=_0x117461[_0x1baa6d(0x13e)][_0x1baa6d(0x148)](async _0x57395a=>{var _0x261046=_0x1baa6d;if(_0x57395a[_0x261046(0xdc)]>0x0){var _0x54da81=await warehouse['findOne']({'name':_0x28d0c0,'room':_0x57395a[_0x261046(0x102)]});const _0x14f56e=_0x54da81[_0x261046(0xd4)][_0x261046(0x148)](_0x3e911d=>{var _0x3fe090=_0x261046;_0x3e911d[_0x3fe090(0x129)]==_0x57395a[_0x3fe090(0x153)]&&(_0x3e911d[_0x3fe090(0x12f)]=Math[_0x3fe090(0xf1)](0x0,Math[_0x3fe090(0x11d)](_0x3e911d[_0x3fe090(0x12f)])-Math[_0x3fe090(0x11d)](_0x57395a[_0x3fe090(0xdc)])),console['log'](_0x3e911d[_0x3fe090(0x12f)]));});}return _0x54da81;});Promise[_0x1baa6d(0xbc)](_0x3dcb69)['then'](async _0x5f9c6=>{var _0x4a2a5e=_0x1baa6d;try{for(const _0x356749 of _0x5f9c6){await _0x356749['save']();}const _0x5b8e5f=_0x117461['product'][_0x4a2a5e(0x148)](async _0x245543=>{var _0x2dd893=_0x4a2a5e,_0x2abcad=await warehouse['findOne']({'name':_0x36a99b,'room':_0x245543[_0x2dd893(0x154)]});if(_0x245543['to_quantity']>0x0){var _0x149aba=0x0;const _0x490003=_0x2abcad[_0x2dd893(0xd4)][_0x2dd893(0x148)](_0xc5a8ff=>{var _0x53d551=_0x2dd893;_0xc5a8ff[_0x53d551(0x14f)]==_0x245543['product_name']&&_0xc5a8ff[_0x53d551(0xb0)]==_0x245543[_0x53d551(0x157)]&&_0xc5a8ff[_0x53d551(0x14e)]==_0x245543[_0x53d551(0x14e)]&&_0xc5a8ff[_0x53d551(0x150)]==_0x245543['production_date']&&_0xc5a8ff[_0x53d551(0xbb)]==_0x245543[_0x53d551(0xbb)]&&_0xc5a8ff[_0x53d551(0xb4)]==_0x245543[_0x53d551(0x142)]&&(typeof _0x245543[_0x53d551(0x153)]==_0x53d551(0x149)?(console[_0x53d551(0x135)]('here2',_0xc5a8ff[_0x53d551(0x12f)]+_0x53d551(0xda)+_0xc5a8ff[_0x53d551(0x129)]+_0x53d551(0xa5)+Math[_0x53d551(0x11d)](_0xc5a8ff[_0x53d551(0x12f)])+Math[_0x53d551(0x11d)](_0x245543['to_quantity'])),_0xc5a8ff['product_stock']=Math[_0x53d551(0x11d)](_0xc5a8ff['product_stock'])+Math[_0x53d551(0x11d)](_0x245543[_0x53d551(0xdc)])):_0xc5a8ff['product_stock']=Math[_0x53d551(0x11d)](_0xc5a8ff[_0x53d551(0x12f)])+Math[_0x53d551(0x11d)](_0x245543[_0x53d551(0xdc)]),_0x149aba++);});_0x149aba=='0'&&(_0x2abcad[_0x2dd893(0xd4)]=_0x2abcad['product_details'][_0x2dd893(0x9c)]({'product_name':_0x245543['product_name'],'product_stock':_0x245543[_0x2dd893(0xdc)],'bay':_0x245543[_0x2dd893(0x157)],'level':_0x245543[_0x2dd893(0xd6)],'product_code':_0x245543[_0x2dd893(0xf7)],'primary_code':_0x245543['primary_code'],'secondary_code':_0x245543[_0x2dd893(0xe5)],'expiry_date':_0x245543[_0x2dd893(0x14e)],'production_date':_0x245543[_0x2dd893(0x150)],'maxProducts':_0x245543[_0x2dd893(0xca)],'batch_code':_0x245543['batch_code'],'secondary_unit':_0x245543[_0x2dd893(0xcf)],'unit':_0x245543[_0x2dd893(0x125)],'maxProducts':_0x245543[_0x2dd893(0xca)],'maxPerUnit':_0x245543[_0x2dd893(0x14b)],'invoice':_0x245543[_0x2dd893(0x142)]}));}return _0x2abcad;});Promise[_0x4a2a5e(0xbc)](_0x5b8e5f)['then'](async _0x424332=>{var _0x2aef12=_0x4a2a5e;try{console[_0x2aef12(0x135)](_0x117461[_0x2aef12(0xa7)]);if(_0x117461[_0x2aef12(0xa7)]!='location2location')for(const _0x39e73d of _0x424332){await warehouse['updateOne']({'_id':_0x39e73d['_id']},{'$addToSet':{'product_details':{'$each':_0x39e73d[_0x2aef12(0xd4)]}}});}_0x117461['finalize']=_0x2aef12(0x168);const _0x26c745=await _0x117461[_0x2aef12(0x158)](),_0x4c0419=await master_shop[_0x2aef12(0x111)](),_0x1d4514=await email_settings[_0x2aef12(0xb7)](),_0x5e43b6=await supervisor_settings['find']();var _0x54c365=_0x117461[_0x2aef12(0x13e)],_0x37a141='',_0x1e7b9c;for(_0x1e7b9c in _0x54c365){var _0x102715='FG';_0x117461['to_warehouse']==_0x2aef12(0xf6)&&(_0x102715='DG'),_0x37a141+=_0x2aef12(0xfb)+_0x2aef12(0xa4)+_0x54c365[_0x1e7b9c]['product_name']+_0x2aef12(0xac)+_0x2aef12(0xa4)+_0x54c365[_0x1e7b9c][_0x2aef12(0xf7)]+_0x2aef12(0xac)+_0x2aef12(0xa4)+_0x54c365[_0x1e7b9c][_0x2aef12(0xdc)]+_0x2aef12(0xac)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54c365[_0x1e7b9c]['unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54c365[_0x1e7b9c]['secondary_unit']+'</td>'+_0x2aef12(0xa4)+_0x117461['to_warehouse']+_0x2aef12(0xac)+_0x2aef12(0xa4)+_0x54c365[_0x1e7b9c][_0x2aef12(0x154)]+_0x2aef12(0xac)+_0x2aef12(0xa4)+_0x102715+_0x54c365[_0x1e7b9c][_0x2aef12(0x157)]+'</td>'+_0x2aef12(0x15d);}_0x5f5da4[_0x2aef12(0x109)](_0x2aef12(0x107),_0x2aef12(0x144)),_0x25ccd4[_0x2aef12(0x110)](_0x2aef12(0x124)+_0x26c745['_id']);}catch(_0x3364c6){console['error'](_0x3364c6),_0x25ccd4[_0x2aef12(0xe6)](0x1f4)[_0x2aef12(0xcc)]({'error':_0x2aef12(0xf4)});}})[_0x4a2a5e(0xf8)](_0x20c317=>{var _0x2a918c=_0x4a2a5e;console['error'](_0x20c317),_0x25ccd4[_0x2a918c(0xe6)](0x1f4)[_0x2a918c(0xcc)]({'error':_0x2a918c(0xbf)});});}catch(_0x3b157f){console[_0x4a2a5e(0x100)](_0x3b157f),_0x25ccd4[_0x4a2a5e(0xe6)](0x1f4)[_0x4a2a5e(0xcc)]({'error':_0x4a2a5e(0x9e)});}})[_0x1baa6d(0xf8)](_0x149b50=>{var _0x4fc369=_0x1baa6d;console[_0x4fc369(0x100)](_0x149b50),_0x25ccd4['status'](0x1f4)[_0x4fc369(0xcc)]({'error':_0x4fc369(0xbf)});});}catch(_0x5d8f8d){_0x25ccd4[_0x1baa6d(0xcc)]({'message':_0x5d8f8d[_0x1baa6d(0x10f)]});}});function BayBinSelected(_0x341237,_0x4748c0){var _0x1aac52=a0_0xbff34b,_0x4cca11=[];let _0x23daea=[];var _0xafb1cb=[];if(_0x341237=='DRY\x20GOODS'){switch(_0x4748c0){case _0x1aac52(0x121):_0x4cca11=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x1aac52(0x106):_0x4cca11=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0xafb1cb=['DG'];}else{if(_0x341237==_0x1aac52(0x152)){switch(_0x4748c0){case _0x1aac52(0x121):_0x4cca11=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x4cca11=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0xafb1cb=['FG'];}}return{'levels':_0x4cca11,'identify':_0xafb1cb};}router['get'](a0_0xbff34b(0x130),auth,async(_0x21664a,_0x23c0e0)=>{var _0x5453df=a0_0xbff34b;try{const {username:_0x222be7,email:_0x3aea13,role:_0x490a63}=_0x21664a[_0x5453df(0x13d)],_0x5e4535=_0x21664a[_0x5453df(0x13d)],_0x3aba12=await profile[_0x5453df(0xb7)]({'email':_0x5e4535['email']}),_0x4dad84=await master_shop['find'](),_0x4ffe16=await transfers_finished['findById'](_0x21664a[_0x5453df(0x133)]['id']);let _0x245f34=new Date(_0x4ffe16[_0x5453df(0x14e)]),_0x254b4a=('0'+_0x245f34['getDate']())[_0x5453df(0x103)](-0x2),_0x53eb24=('0'+(_0x245f34[_0x5453df(0x123)]()+0x1))[_0x5453df(0x103)](-0x2),_0x58bf2d=_0x245f34['getFullYear'](),_0xaa98ed=_0x58bf2d+'-'+_0x53eb24+'-'+_0x254b4a,_0x323120;if(_0x5e4535['role']=='staff'){const _0x36638f=await staff[_0x5453df(0xb7)]({'email':_0x5e4535[_0x5453df(0x140)]});_0x323120=await warehouse['find']({'status':_0x5453df(0x114),'name':_0x36638f[_0x5453df(0xef)],'warehouse_category':_0x5453df(0x164)});}else _0x323120=await warehouse['find']({'status':_0x5453df(0x114),'warehouse_category':_0x5453df(0x164)});const _0x21b350=await warehouse[_0x5453df(0xd3)]([{'$match':{'name':_0x4ffe16[_0x5453df(0x134)],'room':_0x4ffe16[_0x5453df(0x161)]}},{'$unwind':_0x5453df(0x128)},{'$group':{'_id':_0x5453df(0xfa),'name':{'$first':_0x5453df(0x10c)},'product_stock':{'$first':_0x5453df(0xd8)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x5453df(0xaf)},'type':{'$first':_0x5453df(0x105)},'floorlevel':{'$first':_0x5453df(0x141)},'primary_code':{'$first':_0x5453df(0x118)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5453df(0x155)},'rack':{'$first':_0x5453df(0xfd)}}}]);var _0x28ec0f=[0x1,0x2,0x3,0x4],_0x4f1410=['A','B','C','D','E','F','G','H','I','J'],_0x91d316=[_0x5453df(0x120),_0x5453df(0x122)];const _0x4fe0f7=await product[_0x5453df(0x111)]({}),_0x1891d9=BayBinSelected(_0x4ffe16[_0x5453df(0xb2)],_0x4ffe16[_0x5453df(0xe4)]);if(_0x4dad84[0x0][_0x5453df(0x13b)]==_0x5453df(0xb9)){var _0x5a01cf=users[_0x5453df(0x15e)];console[_0x5453df(0x135)](_0x5a01cf);}else{if(_0x4dad84[0x0][_0x5453df(0x13b)]==_0x5453df(0x12e))var _0x5a01cf=users[_0x5453df(0x12e)];else{if(_0x4dad84[0x0][_0x5453df(0x13b)]==_0x5453df(0x127))var _0x5a01cf=users[_0x5453df(0x127)];else{if(_0x4dad84[0x0][_0x5453df(0x13b)]==_0x5453df(0x10b))var _0x5a01cf=users['Spanish'];else{if(_0x4dad84[0x0][_0x5453df(0x13b)]=='French')var _0x5a01cf=users[_0x5453df(0x15b)];else{if(_0x4dad84[0x0][_0x5453df(0x13b)]==_0x5453df(0x11b))var _0x5a01cf=users[_0x5453df(0x11f)];else{if(_0x4dad84[0x0][_0x5453df(0x13b)]==_0x5453df(0xf0))var _0x5a01cf=users['Chinese'];else{if(_0x4dad84[0x0][_0x5453df(0x13b)]==_0x5453df(0x9b))var _0x5a01cf=users['Arabic'];}}}}}}}_0x23c0e0[_0x5453df(0x12b)]('edit_transfer_finished',{'success':_0x21664a[_0x5453df(0x109)](_0x5453df(0x107)),'errors':_0x21664a[_0x5453df(0x109)]('errors'),'role':_0x5e4535,'profile':_0x3aba12,'master_shop':_0x4dad84,'warehouse':_0x323120,'transfer':_0x4ffe16,'stock':_0x21b350,'unit':_0x4fe0f7,'language':_0x5a01cf,'levels':_0x28ec0f,'Isle':_0x4f1410,'rooms_data':_0x91d316,'ed_fullDate':_0xaa98ed,'dataSelected':_0x1891d9});}catch(_0x21eae7){console[_0x5453df(0x135)](_0x21eae7);}}),router[a0_0xbff34b(0x15c)]('/view/:id',auth,async(_0x7a38b5,_0x6e5e7)=>{var _0x4b565b=a0_0xbff34b;try{const _0x53b972=_0x7a38b5['params']['id'];console[_0x4b565b(0x135)](_0x7a38b5[_0x4b565b(0x10e)]);const _0x54230b=await transfers_finished[_0x4b565b(0xe9)](_0x53b972);console['log'](_0x4b565b(0xa3),_0x54230b);const {date:_0x504353,from_warehouse:_0x10b922,FromRoom_name:_0x2389fb,to_warehouse:_0x50b34d,ToRoom_name:_0x4e3b57,prod_name:_0x2561ca,from_prod_qty:_0xccf98,from_prod_level:_0x30ee6d,from_prod_isle:_0x4dd12c,from_prod_pallet:_0x59e520,to_prod_qty:_0x1c1805,to_prod_level:_0x5c4d9f,to_prod_isle:_0x3af834,to_prod_pallet:_0x3e11c9,primary_code:_0xeb9138,secondary_code:_0xe0f255,product_code3:_0x28de7b,note:_0x3c08e7,invoice:_0x2945bc,expiry_date:_0x5a0c6d}=_0x7a38b5['body'];if(typeof _0x2561ca=='string')var _0x2750cf=[_0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0x14d)]],_0x2894da=[_0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0xbe)]],_0x15faa6=[_0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0x9d)]],_0x45e603=[_0x7a38b5['body'][_0x4b565b(0x98)]],_0xe1aa0a=[_0x7a38b5[_0x4b565b(0x10e)]['to_prod_level']],_0xcc8bf3=[_0x7a38b5['body']['primary_code']],_0x823379=[_0x7a38b5['body'][_0x4b565b(0xe5)]],_0x3e0505=[_0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0x116)]],_0x324c73=[_0x7a38b5['body'][_0x4b565b(0xe3)]],_0x22f41b=[_0x7a38b5[_0x4b565b(0x10e)]['unit']],_0x13a633=[_0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0xcf)]],_0xe102ea=[_0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0xbb)]],_0x3ed06d=[_0x7a38b5['body'][_0x4b565b(0x14e)]];else var _0x2750cf=[..._0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0x14d)]],_0x2894da=[..._0x7a38b5['body'][_0x4b565b(0xbe)]],_0x15faa6=[..._0x7a38b5['body'][_0x4b565b(0x9d)]],_0x45e603=[..._0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0x98)]],_0xe1aa0a=[..._0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0x101)]],_0xcc8bf3=[..._0x7a38b5[_0x4b565b(0x10e)]['primary_code']],_0x823379=[..._0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0xe5)]],_0x3e0505=[..._0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0x116)]],_0x324c73=[..._0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0xe3)]],_0x22f41b=[..._0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0x125)]],_0x13a633=[..._0x7a38b5[_0x4b565b(0x10e)]['secondary_unit']],_0xe102ea=[..._0x7a38b5[_0x4b565b(0x10e)][_0x4b565b(0xbb)]],_0x3ed06d=[..._0x7a38b5['body'][_0x4b565b(0x14e)]];const _0x5a5725=_0x2750cf[_0x4b565b(0x148)](_0x385f59=>{return _0x385f59={'product_name':_0x385f59};});_0x2894da['forEach']((_0x29ad4c,_0x350f52)=>{_0x5a5725[_0x350f52]['from_quantity']=_0x29ad4c;}),_0x15faa6[_0x4b565b(0x9f)]((_0x191456,_0x51878e)=>{var _0x5cc612=_0x4b565b;_0x5a5725[_0x51878e][_0x5cc612(0xaa)]=_0x191456;}),_0x45e603[_0x4b565b(0x9f)]((_0x362667,_0x1ee5b3)=>{var _0x2a13c9=_0x4b565b;_0x5a5725[_0x1ee5b3][_0x2a13c9(0xdc)]=_0x362667;}),_0xe1aa0a[_0x4b565b(0x9f)]((_0x320648,_0x7558b2)=>{_0x5a5725[_0x7558b2]['to_bay']=_0x320648;}),_0xcc8bf3['forEach']((_0x20527e,_0x4ba308)=>{var _0x47871a=_0x4b565b;_0x5a5725[_0x4ba308][_0x47871a(0xad)]=_0x20527e;}),_0x823379[_0x4b565b(0x9f)]((_0x289f74,_0x590e9a)=>{var _0x1bacb3=_0x4b565b;_0x5a5725[_0x590e9a][_0x1bacb3(0xe5)]=_0x289f74;}),_0x3e0505[_0x4b565b(0x9f)]((_0x117ea7,_0x51efac)=>{var _0x27b723=_0x4b565b;_0x5a5725[_0x51efac][_0x27b723(0xf7)]=_0x117ea7;}),_0x324c73[_0x4b565b(0x9f)]((_0x51911d,_0x3c2a2a)=>{var _0x1d623e=_0x4b565b;_0x5a5725[_0x3c2a2a][_0x1d623e(0xca)]=_0x51911d;}),_0x22f41b['forEach']((_0x170826,_0x53e54d)=>{var _0x352b30=_0x4b565b;_0x5a5725[_0x53e54d][_0x352b30(0x125)]=_0x170826;}),_0x13a633['forEach']((_0x2ef259,_0x4dd371)=>{var _0x12693c=_0x4b565b;_0x5a5725[_0x4dd371][_0x12693c(0xcf)]=_0x2ef259;}),_0xe102ea[_0x4b565b(0x9f)]((_0x3eee40,_0xc7c279)=>{_0x5a5725[_0xc7c279]['batch_code']=_0x3eee40;}),_0x3ed06d[_0x4b565b(0x9f)]((_0x2ebb13,_0x595c34)=>{var _0x20726e=_0x4b565b;_0x5a5725[_0x595c34][_0x20726e(0x14e)]=_0x2ebb13;});const _0x2f6102=_0x5a5725[_0x4b565b(0x132)](_0xf2dcc4=>_0xf2dcc4[_0x4b565b(0xdc)]!=='0'&&_0xf2dcc4[_0x4b565b(0xdc)]!==''||_0xf2dcc4[_0x4b565b(0x13f)]!=='0'&&_0xf2dcc4[_0x4b565b(0x13f)]!=='');var _0x1e8bf6=0x0;_0x2f6102[_0x4b565b(0x9f)](_0x4f8d14=>{parseInt(_0x4f8d14['from_quantity'])<parseInt(_0x4f8d14['to_quantity'])&&_0x1e8bf6++;});if(_0x1e8bf6!=0x0)return _0x7a38b5['flash'](_0x4b565b(0x138),_0x4b565b(0xce)),_0x6e5e7[_0x4b565b(0x110)](_0x4b565b(0x12c));const _0xd861a7=await warehouse[_0x4b565b(0xb7)]({'name':_0x54230b[_0x4b565b(0x134)],'room':_0x54230b[_0x4b565b(0x161)]});_0x54230b[_0x4b565b(0x13e)][_0x4b565b(0x9f)](_0x1588e7=>{var _0x6ae318=_0x4b565b;if(_0x1588e7[_0x6ae318(0xdc)]>0x0){const _0x4fd214=_0xd861a7[_0x6ae318(0xd4)]['map'](_0x5f1f06=>{var _0x422eb9=_0x6ae318;_0x5f1f06['product_name']==_0x1588e7[_0x422eb9(0x14f)]&&_0x5f1f06[_0x422eb9(0xb0)]==_0x1588e7[_0x422eb9(0xaa)]&&(_0x5f1f06['product_stock']=parseInt(_0x5f1f06[_0x422eb9(0x12f)])+parseInt(_0x1588e7[_0x422eb9(0xdc)]));});}}),await _0xd861a7[_0x4b565b(0x158)]();const _0x10f889=await warehouse[_0x4b565b(0xb7)]({'name':_0x54230b[_0x4b565b(0xb2)],'room':_0x54230b[_0x4b565b(0xe4)]});_0x54230b[_0x4b565b(0x13e)][_0x4b565b(0x9f)](_0x4281d6=>{var _0x52f168=_0x4b565b;if(_0x4281d6[_0x52f168(0xdc)]>0x0){const _0x16d830=_0x10f889['product_details'][_0x52f168(0x148)](_0x2e4e7d=>{var _0x4b465a=_0x52f168;_0x2e4e7d[_0x4b465a(0x14f)]==_0x4281d6['product_name']&&_0x2e4e7d[_0x4b465a(0xb0)]==_0x4281d6[_0x4b465a(0x157)]&&(_0x2e4e7d[_0x4b465a(0x12f)]=parseInt(_0x2e4e7d[_0x4b465a(0x12f)])-parseInt(_0x4281d6[_0x4b465a(0xdc)]));});}}),await _0x10f889['save'](),_0x54230b[_0x4b565b(0x162)]=_0x504353,_0x54230b['from_warehouse']=_0x10b922,_0x54230b[_0x4b565b(0xb2)]=_0x50b34d,_0x54230b[_0x4b565b(0x13e)]=_0x2f6102,_0x54230b[_0x4b565b(0x145)]=_0x3c08e7,_0x54230b[_0x4b565b(0xb4)]=_0x2945bc;const _0x35e9c7=await _0x54230b['save'](),_0xb64370=await warehouse[_0x4b565b(0xb7)]({'name':_0x10b922,'room':_0x2389fb});_0x35e9c7[_0x4b565b(0x13e)][_0x4b565b(0x9f)](_0x56294a=>{var _0x4709dc=_0x4b565b;if(_0x56294a[_0x4709dc(0xdc)]>0x0){const _0x5a2f83=_0xb64370[_0x4709dc(0xd4)][_0x4709dc(0x148)](_0x3e7169=>{var _0xd0db62=_0x4709dc;_0x3e7169[_0xd0db62(0x14f)]==_0x56294a[_0xd0db62(0x14f)]&&_0x3e7169[_0xd0db62(0xb0)]==_0x56294a[_0xd0db62(0xaa)]&&(_0x3e7169[_0xd0db62(0x12f)]=parseInt(_0x3e7169[_0xd0db62(0x12f)])-parseInt(_0x56294a['to_quantity']));});}}),await _0xb64370[_0x4b565b(0x158)]();const _0x1f6934=await warehouse[_0x4b565b(0xb7)]({'name':_0x50b34d,'room':_0x4e3b57});_0x35e9c7[_0x4b565b(0x13e)]['forEach'](_0x414002=>{var _0x41a54d=_0x4b565b;if(_0x414002[_0x41a54d(0xdc)]>0x0){var _0x190994=0x0;const _0x2249a5=_0x1f6934['product_details'][_0x41a54d(0x148)](_0x58a4e=>{var _0x500b6b=_0x41a54d;_0x58a4e[_0x500b6b(0x14f)]==_0x414002[_0x500b6b(0x14f)]&&_0x58a4e[_0x500b6b(0xb0)]==_0x414002[_0x500b6b(0x157)]&&(_0x58a4e[_0x500b6b(0x12f)]=parseInt(_0x58a4e[_0x500b6b(0x12f)])+parseInt(_0x414002[_0x500b6b(0xdc)]),_0x190994++);});_0x190994=='0'&&(_0x1f6934['product_details']=_0x1f6934[_0x41a54d(0xd4)][_0x41a54d(0x9c)]({'product_name':_0x414002[_0x41a54d(0x14f)],'product_stock':_0x414002[_0x41a54d(0xdc)],'bay':_0x414002[_0x41a54d(0x157)],'product_code':_0x414002[_0x41a54d(0xf7)],'primary_code':_0x414002['primary_code'],'secondary_code':_0x414002[_0x41a54d(0xe5)],'maxProducts':_0x414002[_0x41a54d(0xca)]}));}}),await _0x1f6934['save'](),_0x7a38b5[_0x4b565b(0x109)](_0x4b565b(0x107),_0x4b565b(0xab)),_0x6e5e7[_0x4b565b(0x110)](_0x4b565b(0xba));}catch(_0x237381){console['log'](_0x237381);}}),router['post'](a0_0xbff34b(0x137),async(_0x311686,_0x5decbb)=>{var _0x47253c=a0_0xbff34b;const {FromWareHouse:_0x80d99a,FromRoom:_0x2d511a,ToWarehouse:_0x5d8f7f,ToRoom:_0x2262e5,primary_code:_0x469108,Roomslist:_0x182fdc}=_0x311686[_0x47253c(0x10e)],_0x12c734=_0x182fdc[_0x47253c(0xa2)](','),_0xb5faab=[];async function _0x59b9a3(_0x48d139){var _0x546b29=_0x47253c;const _0x40106b=await warehouse['aggregate']([{'$match':{'name':_0x80d99a,'room':_0x48d139}},{'$unwind':_0x546b29(0x128)},{'$match':{'product_details.primary_code':_0x469108}},{'$group':{'_id':_0x546b29(0xfa),'name':{'$first':_0x546b29(0x10c)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x546b29(0x118)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x546b29(0x12d)},'level':{'$first':_0x546b29(0x160)},'type':{'$first':_0x546b29(0x105)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x546b29(0xf9)},'secondary_unit':{'$first':_0x546b29(0xf3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x546b29(0xa8)},'production_date':{'$first':_0x546b29(0x13c)},'batch_code':{'$first':_0x546b29(0x14c)},'maxPerUnit':{'$first':_0x546b29(0xe7)},'roomNamed':{'$first':_0x546b29(0x10a)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x546b29(0xc9)}}}]),_0x176911=await warehouse[_0x546b29(0xd3)]([{'$match':{'name':_0x80d99a,'room':_0x48d139}},{'$unwind':_0x546b29(0x128)},{'$match':{'product_details.secondary_code':_0x469108}},{'$group':{'_id':_0x546b29(0xfa),'name':{'$first':_0x546b29(0x10c)},'instock':{'$first':_0x546b29(0xd8)},'primary_code':{'$first':_0x546b29(0x118)},'secondary_code':{'$first':_0x546b29(0xa1)},'product_code':{'$first':_0x546b29(0x113)},'bay':{'$first':_0x546b29(0x12d)},'level':{'$first':'$product_details.level'},'type':{'$first':_0x546b29(0x105)},'pallet':{'$first':_0x546b29(0x141)},'unit':{'$first':_0x546b29(0xf9)},'secondary_unit':{'$first':_0x546b29(0xf3)},'storage':{'$first':_0x546b29(0x155)},'rack':{'$first':_0x546b29(0xfd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x546b29(0x13c)},'batch_code':{'$first':_0x546b29(0x14c)},'maxPerUnit':{'$first':_0x546b29(0xe7)},'roomNamed':{'$first':_0x546b29(0x10a)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x546b29(0xc9)}}}]);if(_0x40106b['length']>0x0)_0xb5faab[_0x546b29(0xc4)](_0x40106b);else _0x176911[_0x546b29(0x9a)]>0x0&&_0xb5faab['push'](_0x176911);}const _0x47b5f0=_0x12c734['map'](_0x4069d1=>_0x59b9a3(_0x4069d1));await Promise[_0x47253c(0xbc)](_0x47b5f0),_0x5decbb[_0x47253c(0xcc)](_0xb5faab);}),router[a0_0xbff34b(0x15c)](a0_0xbff34b(0x117),async(_0x23eae6,_0x511607)=>{var _0x4fb677=a0_0xbff34b;const {productCode:_0x118d5c,bay:_0x3a1e30,warehouses:_0x5e2b7e,room:_0x46dc2d}=_0x23eae6[_0x4fb677(0x10e)];console[_0x4fb677(0x135)](_0x23eae6[_0x4fb677(0x10e)]);try{const _0x53276f=await warehouse[_0x4fb677(0xd3)]([{'$match':{'name':_0x5e2b7e,'room':_0x46dc2d}},{'$unwind':_0x4fb677(0x128)},{'$match':{'product_details.bay':parseInt(_0x3a1e30)}},{'$group':{'_id':_0x4fb677(0xfa),'name':{'$first':_0x4fb677(0x10c)},'product_stock':{'$first':_0x4fb677(0xd8)},'bay':{'$first':_0x4fb677(0x12d)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x511607[_0x4fb677(0xe6)](0xc8)[_0x4fb677(0xcc)](_0x53276f);}catch(_0x45b4ec){_0x511607['status'](0x194)[_0x4fb677(0xcc)]({'message':_0x45b4ec[_0x4fb677(0x10f)]});}}),module[a0_0xbff34b(0xf2)]=router;