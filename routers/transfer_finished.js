function a0_0x13a3(){var _0x112794=['unit','role','bay','product_code','Router','$product_details.invoice','$product_details.product_stock','params','</td>','slice','$product_details.expiry_date','Finished\x20Goods','here2','product_code3','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','floor','concat','1086sGFgzo','Rack\x202','location2location','findById','secondary_code','catch','Ambient','own','email','forEach','random','FROZEN\x20GOODS','to_prod_level','to_bay','primary_code','maxProducts','$product.from_room_name','$product_details.secondary_unit','TRF-','Enclosed','$room','To_invoice','back','7615pAlmIY','from_warehouse','Hindi','secondary_unit','product_name','RoomAssigned','expiry_date','push','product_date','all','length','/view/addlog','$product_details.product_code','batch_code','$product_details.maxPerUnit','from_room','Enabled','date','to_level','transfer_finished_logs','redirect','/view_logs','French','body','MaxStocks_data2','post','$product_details.level','$_id','$invoice','render','52CPbcAR','$product_details.product_name','message','prod_name','map','split','abs','<tr>','from_bay','from_level','to_room_name','ToRoomAssigned','$product_details','$product_details.bin','to_warehouse','../models/all_models','$to_warehouse','type_of_process','user','from_quantity','New_Qty_Converted','Arabic','1475664dWbcWr','invoice','$finalize','/view/:id','$name','edit_transfer_finished_view','primary_unit','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','production_date','json','$date','84OjcbqD','id_transaction','toString','$from_warehouse','match','status','18193QOGoPt','Portuguese','to_room','True','$product_details.bay','product_details','5881766pcdkoB','findOne','/preview/:id','updateOne','maxPerUnit','$product','$product_details._id','$product_details.primary_code','nodemailer','Portuguese\x20(BR)','Chinese','prod_cat','\x20<>\x20','invoice_init','product_stock','find','flash','filter','from_room_name','/view/add_transfer_loc','27VwSaMk','choos_transfer','aggregate','There\x27s\x20a\x20error\x20in\x20this\x20transaction','from_invoice','transfer_data','Transfer\x20Edit\x20Successfully','product','$product_details.production_date','/transfer_finished/preview/','string','An\x20error\x20occurred.','bin2bin','get','then','$product_details.batch_code','_id','$product_details.type','language','1136910YZnYRF','error','padStart','save','getFullYear','transfer_finished','English','$product_details.maxProducts','logs','from_prod_qty','/view/choose_logs','from_prod_level2','Spanish','TRFF-','$product_details.floorlevel','LOG-TRF-','MaxStocks_data','$product_details.storage','$product.to_room_name','$product_details.rack','/view/add_transfer_logs','$product_details.secondary_code','warehouse','to_quantity','errors','English\x20(US)','/transfer/view','to_floorlevel','../public/language/languages.json','staff','Product\x20Transfer\x20successfully','/view/choose','Arabic\x20(ae)','1046796XlBudm','An\x20error\x20occurred\x20while\x20saving\x20data.','/view/add_transfer','success','from_prod_level','DRY\x20GOODS','7966qJbNfN','log','German','$product_details.unit','/barcode_scanner'];a0_0x13a3=function(){return _0x112794;};return a0_0x13a3();}var a0_0x48036d=a0_0x4df0;(function(_0x271e06,_0x283628){var _0x31ecc8=a0_0x4df0,_0x434d14=_0x271e06();while(!![]){try{var _0x26f093=-parseInt(_0x31ecc8(0x261))/0x1*(parseInt(_0x31ecc8(0x1f5))/0x2)+parseInt(_0x31ecc8(0x1ef))/0x3+parseInt(_0x31ecc8(0x240))/0x4*(parseInt(_0x31ecc8(0x222))/0x5)+parseInt(_0x31ecc8(0x20b))/0x6*(-parseInt(_0x31ecc8(0x267))/0x7)+-parseInt(_0x31ecc8(0x256))/0x8+parseInt(_0x31ecc8(0x281))/0x9*(parseInt(_0x31ecc8(0x294))/0xa)+parseInt(_0x31ecc8(0x26d))/0xb;if(_0x26f093===_0x283628)break;else _0x434d14['push'](_0x434d14['shift']());}catch(_0x4ed85b){_0x434d14['push'](_0x434d14['shift']());}}}(a0_0x13a3,0x3e455));function a0_0x4df0(_0x44b075,_0x1b2056){var _0x13a30c=a0_0x13a3();return a0_0x4df0=function(_0x4df09f,_0x55feec){_0x4df09f=_0x4df09f-0x1dc;var _0x5cb1db=_0x13a30c[_0x4df09f];return _0x5cb1db;},a0_0x4df0(_0x44b075,_0x1b2056);}const express=require('express'),app=express(),router=express[a0_0x48036d(0x1fe)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x48036d(0x24f)),auth=require('../middleware/auth'),users=require(a0_0x48036d(0x1ea)),nodemailer=require(a0_0x48036d(0x275));router[a0_0x48036d(0x28e)]('/view',auth,async(_0x459af2,_0x3910a1)=>{var _0x457395=a0_0x48036d;try{const {username:_0x5afe27,email:_0x11277d,role:_0x49b3f4}=_0x459af2['user'],_0x4dd446=_0x459af2[_0x457395(0x252)],_0x37ebaa=await profile[_0x457395(0x26e)]({'email':_0x4dd446[_0x457395(0x213)]}),_0x45313a=await master_shop['find']();let _0x3ac4db;if(_0x4dd446[_0x457395(0x1fb)]==_0x457395(0x1eb)){const _0x5aeeda=await staff[_0x457395(0x26e)]({'email':_0x4dd446[_0x457395(0x213)]});_0x3ac4db=await transfers_finished[_0x457395(0x27c)]({'from_warehouse':_0x5aeeda[_0x457395(0x1e4)]});}else _0x3ac4db=await transfers_finished[_0x457395(0x283)]([{'$match':{'type_of_transaction':_0x457395(0x212)}},{'$unwind':'$product'},{'$group':{'_id':_0x457395(0x23d),'invoice':{'$first':_0x457395(0x23e)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x457395(0x264)},'to_warehouse':{'$first':_0x457395(0x250)},'from_room_name':{'$addToSet':_0x457395(0x21b)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x457395(0x258)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x45313a[0x0][_0x457395(0x293)]==_0x457395(0x1e7))var _0x9be70b=users[_0x457395(0x29a)];else{if(_0x45313a[0x0][_0x457395(0x293)]==_0x457395(0x224))var _0x9be70b=users[_0x457395(0x224)];else{if(_0x45313a[0x0][_0x457395(0x293)]==_0x457395(0x1f7))var _0x9be70b=users[_0x457395(0x1f7)];else{if(_0x45313a[0x0][_0x457395(0x293)]==_0x457395(0x2a0))var _0x9be70b=users[_0x457395(0x2a0)];else{if(_0x45313a[0x0]['language']==_0x457395(0x238))var _0x9be70b=users['French'];else{if(_0x45313a[0x0][_0x457395(0x293)]==_0x457395(0x276))var _0x9be70b=users[_0x457395(0x268)];else{if(_0x45313a[0x0][_0x457395(0x293)]=='Chinese')var _0x9be70b=users[_0x457395(0x277)];else{if(_0x45313a[0x0]['language']==_0x457395(0x1ee))var _0x9be70b=users['Arabic'];}}}}}}}_0x3910a1['render'](_0x457395(0x299),{'success':_0x459af2['flash'](_0x457395(0x1f2)),'errors':_0x459af2[_0x457395(0x27d)](_0x457395(0x1e6)),'role':_0x4dd446,'profile':_0x37ebaa,'master_shop':_0x45313a,'transfer':_0x3ac4db,'language':_0x9be70b});}catch(_0x5b6091){console['log'](_0x5b6091);}}),router['get'](a0_0x48036d(0x237),auth,async(_0x1aa587,_0x3c2b4f)=>{var _0x45d10e=a0_0x48036d;try{const {username:_0x27285c,email:_0x251b33,role:_0x18dad9}=_0x1aa587[_0x45d10e(0x252)],_0xcd38ad=_0x1aa587['user'],_0x23e173=await profile[_0x45d10e(0x26e)]({'email':_0xcd38ad['email']}),_0x3c5d41=await master_shop[_0x45d10e(0x27c)]();let _0x3cd9f8;if(_0xcd38ad[_0x45d10e(0x1fb)]==_0x45d10e(0x1eb)){const _0x1aa622=await staff[_0x45d10e(0x26e)]({'email':_0xcd38ad[_0x45d10e(0x213)]});_0x3cd9f8=await transfers_finished[_0x45d10e(0x27c)]({'from_warehouse':_0x1aa622[_0x45d10e(0x1e4)]});}else _0x3cd9f8=await transfers_finished[_0x45d10e(0x283)]([{'$match':{'type_of_transaction':_0x45d10e(0x29c)}},{'$unwind':_0x45d10e(0x272)},{'$group':{'_id':_0x45d10e(0x23d),'invoice':{'$first':_0x45d10e(0x23e)},'date':{'$first':_0x45d10e(0x260)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x45d10e(0x250)},'from_room_name':{'$addToSet':_0x45d10e(0x21b)},'to_room_name':{'$addToSet':_0x45d10e(0x1e0)},'finalize':{'$first':_0x45d10e(0x258)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3c5d41[0x0][_0x45d10e(0x293)]==_0x45d10e(0x1e7))var _0x4ac5c1=users[_0x45d10e(0x29a)];else{if(_0x3c5d41[0x0]['language']==_0x45d10e(0x224))var _0x4ac5c1=users['Hindi'];else{if(_0x3c5d41[0x0][_0x45d10e(0x293)]==_0x45d10e(0x1f7))var _0x4ac5c1=users[_0x45d10e(0x1f7)];else{if(_0x3c5d41[0x0][_0x45d10e(0x293)]==_0x45d10e(0x2a0))var _0x4ac5c1=users[_0x45d10e(0x2a0)];else{if(_0x3c5d41[0x0][_0x45d10e(0x293)]==_0x45d10e(0x238))var _0x4ac5c1=users['French'];else{if(_0x3c5d41[0x0][_0x45d10e(0x293)]==_0x45d10e(0x276))var _0x4ac5c1=users[_0x45d10e(0x268)];else{if(_0x3c5d41[0x0][_0x45d10e(0x293)]==_0x45d10e(0x277))var _0x4ac5c1=users[_0x45d10e(0x277)];else{if(_0x3c5d41[0x0][_0x45d10e(0x293)]=='Arabic\x20(ae)')var _0x4ac5c1=users['Arabic'];}}}}}}}_0x3c2b4f[_0x45d10e(0x23f)](_0x45d10e(0x235),{'success':_0x1aa587[_0x45d10e(0x27d)](_0x45d10e(0x1f2)),'errors':_0x1aa587[_0x45d10e(0x27d)](_0x45d10e(0x1e6)),'role':_0xcd38ad,'profile':_0x23e173,'master_shop':_0x3c5d41,'transfer':_0x3cd9f8,'language':_0x4ac5c1});}catch(_0x4aa996){console[_0x45d10e(0x1f6)](_0x4aa996);}});async function getRandom8DigitNumber(){var _0x57cbe8=a0_0x48036d;const _0x429c53=0x989680,_0x4dbcb6=0x5f5e0ff,_0x1ae442=Math[_0x57cbe8(0x209)](Math[_0x57cbe8(0x215)]()*(_0x4dbcb6-_0x429c53+0x1))+_0x429c53;var _0x4b59cf;const _0x2d28fa=await transfers_finished[_0x57cbe8(0x26e)]({'invoice':_0x57cbe8(0x2a1)+_0x1ae442});return _0x2d28fa&&_0x2d28fa['length']>0x0?_0x4b59cf=_0x57cbe8(0x2a1)+_0x1ae442:_0x4b59cf=_0x57cbe8(0x2a1)+_0x1ae442,_0x4b59cf;}router['get'](a0_0x48036d(0x1f1),auth,async(_0x46a18b,_0x5df25f)=>{var _0x295994=a0_0x48036d;try{const {username:_0x5f5a9b,email:_0x40f4e0,role:_0x155c59}=_0x46a18b['user'],_0x118067=_0x46a18b['user'],_0xec58c5=await profile['findOne']({'email':_0x118067[_0x295994(0x213)]}),_0x5d796e=await master_shop[_0x295994(0x27c)]();let _0x3ac1b5;if(_0x118067[_0x295994(0x1fb)]==_0x295994(0x1eb)){const _0xfc7a98=await staff[_0x295994(0x26e)]({'email':_0x118067[_0x295994(0x213)]});_0x3ac1b5=await warehouse[_0x295994(0x283)]([{'$match':{'status':'Enabled','name':_0xfc7a98[_0x295994(0x1e4)]}},{'$group':{'_id':_0x295994(0x25a),'name':{'$first':'$name'}}}]);}else _0x3ac1b5=await warehouse[_0x295994(0x283)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x295994(0x25a),'name':{'$first':_0x295994(0x25a)}}}]);const _0x3c8f68=await transfers_finished[_0x295994(0x27c)]({}),_0x2a959b=_0x3c8f68[_0x295994(0x22c)]+0x1,_0xe4c72d=_0x295994(0x2a1)+_0x2a959b['toString']()[_0x295994(0x296)](0x5,'0');if(_0x5d796e[0x0][_0x295994(0x293)]==_0x295994(0x1e7))var _0x1a7a40=users[_0x295994(0x29a)];else{if(_0x5d796e[0x0]['language']=='Hindi')var _0x1a7a40=users[_0x295994(0x224)];else{if(_0x5d796e[0x0][_0x295994(0x293)]=='German')var _0x1a7a40=users[_0x295994(0x1f7)];else{if(_0x5d796e[0x0]['language']==_0x295994(0x2a0))var _0x1a7a40=users[_0x295994(0x2a0)];else{if(_0x5d796e[0x0][_0x295994(0x293)]=='French')var _0x1a7a40=users[_0x295994(0x238)];else{if(_0x5d796e[0x0][_0x295994(0x293)]==_0x295994(0x276))var _0x1a7a40=users['Portuguese'];else{if(_0x5d796e[0x0][_0x295994(0x293)]==_0x295994(0x277))var _0x1a7a40=users['Chinese'];else{if(_0x5d796e[0x0]['language']==_0x295994(0x1ee))var _0x1a7a40=users[_0x295994(0x255)];}}}}}}}const _0x9abb17=getRandom8DigitNumber();_0x9abb17[_0x295994(0x28f)](_0x2d83c1=>{var _0x5a4a46=_0x295994;_0x5df25f[_0x5a4a46(0x23f)]('add_transfer_finished',{'success':_0x46a18b['flash']('success'),'errors':_0x46a18b[_0x5a4a46(0x27d)](_0x5a4a46(0x1e6)),'role':_0x118067,'profile':_0xec58c5,'master_shop':_0x5d796e,'warehouse':_0x3ac1b5,'language':_0x1a7a40,'invoice':_0x2d83c1});})[_0x295994(0x210)](_0x2ddf76=>{var _0x318e12=_0x295994;_0x46a18b['flash'](_0x318e12(0x1e6),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x5df25f[_0x318e12(0x236)]('/transfer/view');});}catch(_0x463842){console['log'](_0x463842);}}),router[a0_0x48036d(0x28e)](a0_0x48036d(0x1ed),auth,async(_0xb8970e,_0x74a180)=>{var _0x4e0b2b=a0_0x48036d;try{const {username:_0x1f9110,email:_0xb31687,role:_0x990132}=_0xb8970e[_0x4e0b2b(0x252)],_0x4b0447=_0xb8970e['user'],_0x3f81bc=await profile[_0x4e0b2b(0x26e)]({'email':_0x4b0447[_0x4e0b2b(0x213)]}),_0x3adcd7=await master_shop[_0x4e0b2b(0x27c)]();let _0x54efab;if(_0x4b0447[_0x4e0b2b(0x1fb)]==_0x4e0b2b(0x1eb)){const _0x33b863=await staff[_0x4e0b2b(0x26e)]({'email':_0x4b0447[_0x4e0b2b(0x213)]});_0x54efab=await warehouse[_0x4e0b2b(0x283)]([{'$match':{'status':_0x4e0b2b(0x232),'name':_0x33b863[_0x4e0b2b(0x1e4)]}},{'$group':{'_id':_0x4e0b2b(0x25a),'name':{'$first':_0x4e0b2b(0x25a)}}}]);}else _0x54efab=await warehouse[_0x4e0b2b(0x283)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x4e0b2b(0x25a)}}}]);const _0x28a452=await transfers_finished[_0x4e0b2b(0x27c)]({}),_0x1dd36f=_0x28a452['length']+0x1,_0x1b4dec=_0x4e0b2b(0x2a1)+_0x1dd36f[_0x4e0b2b(0x263)]()[_0x4e0b2b(0x296)](0x5,'0');if(_0x3adcd7[0x0][_0x4e0b2b(0x293)]==_0x4e0b2b(0x1e7))var _0x3fa6cf=users[_0x4e0b2b(0x29a)];else{if(_0x3adcd7[0x0][_0x4e0b2b(0x293)]=='Hindi')var _0x3fa6cf=users[_0x4e0b2b(0x224)];else{if(_0x3adcd7[0x0]['language']==_0x4e0b2b(0x1f7))var _0x3fa6cf=users[_0x4e0b2b(0x1f7)];else{if(_0x3adcd7[0x0][_0x4e0b2b(0x293)]=='Spanish')var _0x3fa6cf=users[_0x4e0b2b(0x2a0)];else{if(_0x3adcd7[0x0][_0x4e0b2b(0x293)]==_0x4e0b2b(0x238))var _0x3fa6cf=users[_0x4e0b2b(0x238)];else{if(_0x3adcd7[0x0]['language']=='Portuguese\x20(BR)')var _0x3fa6cf=users[_0x4e0b2b(0x268)];else{if(_0x3adcd7[0x0][_0x4e0b2b(0x293)]==_0x4e0b2b(0x277))var _0x3fa6cf=users[_0x4e0b2b(0x277)];else{if(_0x3adcd7[0x0][_0x4e0b2b(0x293)]==_0x4e0b2b(0x1ee))var _0x3fa6cf=users['Arabic'];}}}}}}}const _0x17f29a=getRandom8DigitNumber();_0x17f29a[_0x4e0b2b(0x28f)](_0x186c05=>{var _0x319f94=_0x4e0b2b;_0x74a180[_0x319f94(0x23f)](_0x319f94(0x282),{'success':_0xb8970e[_0x319f94(0x27d)](_0x319f94(0x1f2)),'errors':_0xb8970e['flash']('errors'),'role':_0x4b0447,'profile':_0x3f81bc,'master_shop':_0x3adcd7,'warehouse':_0x54efab,'language':_0x3fa6cf,'invoice':_0x186c05});})[_0x4e0b2b(0x210)](_0x187a94=>{var _0x50bc1b=_0x4e0b2b;_0xb8970e[_0x50bc1b(0x27d)](_0x50bc1b(0x1e6),_0x50bc1b(0x284)),_0x74a180[_0x50bc1b(0x236)]('/transfer/view');});}catch(_0x3b2d9a){console[_0x4e0b2b(0x1f6)](_0x3b2d9a);}}),router[a0_0x48036d(0x28e)](a0_0x48036d(0x29e),auth,async(_0x41dbe7,_0x51e589)=>{var _0x3281f3=a0_0x48036d;try{const {username:_0x100882,email:_0xc9057c,role:_0x1e76ed}=_0x41dbe7[_0x3281f3(0x252)],_0x415adb=_0x41dbe7['user'],_0x53f16e=await profile[_0x3281f3(0x26e)]({'email':_0x415adb[_0x3281f3(0x213)]}),_0x4a9033=await master_shop[_0x3281f3(0x27c)]();let _0x8a1e9b;if(_0x415adb[_0x3281f3(0x1fb)]=='staff'){const _0x513e15=await staff[_0x3281f3(0x26e)]({'email':_0x415adb['email']});_0x8a1e9b=await warehouse['aggregate']([{'$match':{'status':_0x3281f3(0x232),'name':_0x513e15[_0x3281f3(0x1e4)]}},{'$group':{'_id':_0x3281f3(0x25a),'name':{'$first':'$name'}}}]);}else _0x8a1e9b=await warehouse[_0x3281f3(0x283)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x3281f3(0x25a),'name':{'$first':_0x3281f3(0x25a)}}}]);const _0x325ed5=await transfers_finished['find']({}),_0x2e05bd=_0x325ed5[_0x3281f3(0x22c)]+0x1,_0x24bbf3=_0x3281f3(0x2a1)+_0x2e05bd[_0x3281f3(0x263)]()[_0x3281f3(0x296)](0x5,'0');if(_0x4a9033[0x0][_0x3281f3(0x293)]=='English\x20(US)')var _0x16fa3b=users[_0x3281f3(0x29a)];else{if(_0x4a9033[0x0][_0x3281f3(0x293)]==_0x3281f3(0x224))var _0x16fa3b=users['Hindi'];else{if(_0x4a9033[0x0]['language']==_0x3281f3(0x1f7))var _0x16fa3b=users[_0x3281f3(0x1f7)];else{if(_0x4a9033[0x0][_0x3281f3(0x293)]=='Spanish')var _0x16fa3b=users[_0x3281f3(0x2a0)];else{if(_0x4a9033[0x0][_0x3281f3(0x293)]=='French')var _0x16fa3b=users[_0x3281f3(0x238)];else{if(_0x4a9033[0x0][_0x3281f3(0x293)]==_0x3281f3(0x276))var _0x16fa3b=users[_0x3281f3(0x268)];else{if(_0x4a9033[0x0][_0x3281f3(0x293)]==_0x3281f3(0x277))var _0x16fa3b=users[_0x3281f3(0x277)];else{if(_0x4a9033[0x0][_0x3281f3(0x293)]==_0x3281f3(0x1ee))var _0x16fa3b=users['Arabic'];}}}}}}}const _0x248567=getRandom8DigitNumber();_0x248567[_0x3281f3(0x28f)](_0x380596=>{var _0x3ec003=_0x3281f3;_0x51e589[_0x3ec003(0x23f)]('choos_transfer_logs',{'success':_0x41dbe7[_0x3ec003(0x27d)]('success'),'errors':_0x41dbe7[_0x3ec003(0x27d)](_0x3ec003(0x1e6)),'role':_0x415adb,'profile':_0x53f16e,'master_shop':_0x4a9033,'warehouse':_0x8a1e9b,'language':_0x16fa3b,'invoice':_0x380596});})[_0x3281f3(0x210)](_0x3c7799=>{var _0x5a1f96=_0x3281f3;_0x41dbe7[_0x5a1f96(0x27d)](_0x5a1f96(0x1e6),_0x5a1f96(0x284)),_0x51e589[_0x5a1f96(0x236)](_0x5a1f96(0x1e8));});}catch(_0x3d9560){console[_0x3281f3(0x1f6)](_0x3d9560);}}),router[a0_0x48036d(0x23b)](a0_0x48036d(0x1e2),auth,async(_0x4d81f6,_0x176c58)=>{var _0x4d1245=a0_0x48036d;try{const {date:_0x3ebc3e,from_warehouse:_0x2d6699,FromRoom_name:_0x3aecea,to_warehouse:_0x3d244d,ToRoom_name:_0x5beaa4,prod_name:_0x5291ce,from_prod_qty:_0x268d5b,from_prod_level:_0x96f7d5,from_prod_isle:_0x3553f7,from_prod_pallet:_0x5031c3,to_prod_qty:_0x426c73,to_prod_level:_0x2f1a0d,to_prod_isle:_0x2c0576,to_prod_pallet:_0x1e132b,primary_code:_0x1211ee,secondary_code:_0x3a672b,product_code3:_0x282ad7,note:_0x3d26f8,MaxStocks_data2:_0x574d91,invoice:_0x330e5f,expiry_date:_0x111995,PO_number:_0x36d276,ReqBy:_0x15566a,dateofreq:_0x2419ab,typeservicesData:_0x1ebe3c,destination:_0x889da2,deliverydate:_0x53e371,driver:_0x5792eb,plate:_0x57c4ae,van:_0x4e717a,DRSI:_0x419bc6,typevehicle:_0x30c7aa,TSU:_0x3d7000,TFU:_0x40ea7f}=_0x4d81f6[_0x4d1245(0x239)];if(typeof _0x5291ce==_0x4d1245(0x28b))var _0x2a1316=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x243)]],_0x7296ff=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x29d)]],_0x154e05=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x29f)]],_0x41a17a=[_0x4d81f6['body'][_0x4d1245(0x254)]],_0x5e4c9e=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x217)]],_0x419b45=[_0x4d81f6['body'][_0x4d1245(0x219)]],_0x38690c=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x20f)]],_0x435136=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x207)]],_0x12b969=[_0x4d81f6['body'][_0x4d1245(0x23a)]],_0x5c047f=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x25c)]],_0x4d8f43=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x225)]],_0x5a1092=[_0x4d81f6['body']['batch_code']],_0x3ea572=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x228)]],_0x30a953=[_0x4d81f6[_0x4d1245(0x239)]['product_date']],_0x4f6fce=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x1de)]],_0x23cb16=[_0x4d81f6['body'][_0x4d1245(0x271)]],_0x5ea5aa=[_0x4d81f6[_0x4d1245(0x239)]['prod_cat']],_0x44bf5d=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x227)]],_0x2e9282=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x24b)]],_0x595b62=[_0x4d81f6[_0x4d1245(0x239)]['from_invoice']],_0x2ef8fa=[_0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x262)]];else var _0x2a1316=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x243)]],_0x7296ff=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x29d)]],_0x154e05=[..._0x4d81f6['body'][_0x4d1245(0x29f)]],_0x41a17a=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x254)]],_0x5e4c9e=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x217)]],_0x419b45=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x219)]],_0x38690c=[..._0x4d81f6['body'][_0x4d1245(0x20f)]],_0x435136=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x207)]],_0x12b969=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x23a)]],_0x5c047f=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x25c)]],_0x4d8f43=[..._0x4d81f6['body'][_0x4d1245(0x225)]],_0x5a1092=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x22f)]],_0x3ea572=[..._0x4d81f6[_0x4d1245(0x239)]['expiry_date']],_0x30a953=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x22a)]],_0x4f6fce=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x1de)]],_0x23cb16=[..._0x4d81f6['body']['maxPerUnit']],_0x5ea5aa=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x278)]],_0x44bf5d=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x227)]],_0x2e9282=[..._0x4d81f6[_0x4d1245(0x239)]['ToRoomAssigned']],_0x595b62=[..._0x4d81f6['body'][_0x4d1245(0x285)]],_0x2ef8fa=[..._0x4d81f6[_0x4d1245(0x239)][_0x4d1245(0x262)]];const _0x4e4f56=_0x2a1316[_0x4d1245(0x244)](_0x45c292=>{return _0x45c292={'product_name':_0x45c292};});_0x7296ff[_0x4d1245(0x214)]((_0x39a6f6,_0x37af4f)=>{var _0x2bc62b=_0x4d1245;_0x4e4f56[_0x37af4f][_0x2bc62b(0x253)]=_0x39a6f6;}),_0x154e05[_0x4d1245(0x214)]((_0x48ecd2,_0x45a906)=>{var _0x5a26fb=_0x4d1245,_0x165df6=_0x48ecd2[_0x5a26fb(0x265)](/[A-Za-z]+/)[0x0],_0x26fd44=parseInt(_0x48ecd2[_0x5a26fb(0x265)](/\d+/)[0x0]);_0x4e4f56[_0x45a906][_0x5a26fb(0x248)]=_0x26fd44,_0x4e4f56[_0x45a906]['from_level']=_0x165df6;}),_0x2ef8fa['forEach']((_0x10b4b1,_0xb072eb)=>{_0x4e4f56[_0xb072eb]['id_transaction']=_0x10b4b1;}),_0x595b62[_0x4d1245(0x214)]((_0x53ed3e,_0x8625cb)=>{var _0x56c225=_0x4d1245;_0x4e4f56[_0x8625cb][_0x56c225(0x285)]=_0x53ed3e;}),_0x41a17a[_0x4d1245(0x214)]((_0x2033b1,_0x221c34)=>{var _0x41fb93=_0x4d1245;_0x4e4f56[_0x221c34][_0x41fb93(0x1e5)]=_0x2033b1;}),_0x5e4c9e[_0x4d1245(0x214)]((_0x183f1d,_0x418a5d)=>{var _0x2ffffa=_0x4d1245,_0x2f3f45=_0x183f1d['match'](/[A-Za-z]+/)[0x0],_0x54cab6=parseInt(_0x183f1d[_0x2ffffa(0x265)](/\d+/)[0x0]);_0x4e4f56[_0x418a5d][_0x2ffffa(0x234)]=_0x2f3f45,_0x4e4f56[_0x418a5d][_0x2ffffa(0x218)]=_0x54cab6;}),_0x419b45[_0x4d1245(0x214)]((_0x372a23,_0x16f8d2)=>{_0x4e4f56[_0x16f8d2]['primary_code']=_0x372a23;}),_0x38690c[_0x4d1245(0x214)]((_0x6ff8a3,_0x36ba20)=>{var _0x12cdf8=_0x4d1245;_0x4e4f56[_0x36ba20][_0x12cdf8(0x20f)]=_0x6ff8a3;}),_0x435136[_0x4d1245(0x214)]((_0x4e5e93,_0x47a734)=>{var _0x22ca3a=_0x4d1245;_0x4e4f56[_0x47a734][_0x22ca3a(0x1fd)]=_0x4e5e93;}),_0x12b969[_0x4d1245(0x214)]((_0x1223d4,_0x2e7431)=>{var _0x325638=_0x4d1245;_0x4e4f56[_0x2e7431][_0x325638(0x21a)]=_0x1223d4;}),_0x5c047f[_0x4d1245(0x214)]((_0x5b60ab,_0x1a5198)=>{var _0x37d33b=_0x4d1245;_0x4e4f56[_0x1a5198][_0x37d33b(0x1fa)]=_0x5b60ab;}),_0x4d8f43[_0x4d1245(0x214)]((_0x232b95,_0x327e7f)=>{var _0x53db8c=_0x4d1245;_0x4e4f56[_0x327e7f][_0x53db8c(0x225)]=_0x232b95;}),_0x5a1092['forEach']((_0x1d145b,_0xbd097)=>{var _0x5cc5ac=_0x4d1245;_0x4e4f56[_0xbd097][_0x5cc5ac(0x22f)]=_0x1d145b;}),_0x3ea572[_0x4d1245(0x214)]((_0x95911f,_0xba1418)=>{var _0x36d00c=_0x4d1245;_0x4e4f56[_0xba1418][_0x36d00c(0x228)]=_0x95911f;}),_0x30a953[_0x4d1245(0x214)]((_0x271234,_0xfc41e4)=>{var _0x2e3dfb=_0x4d1245;_0x4e4f56[_0xfc41e4][_0x2e3dfb(0x25e)]=_0x271234;}),_0x4f6fce[_0x4d1245(0x214)]((_0x3c3b14,_0x13e2f2)=>{var _0x3ba6d0=_0x4d1245;_0x4e4f56[_0x13e2f2][_0x3ba6d0(0x21a)]=_0x3c3b14;}),_0x23cb16[_0x4d1245(0x214)]((_0x497ff,_0x34f79e)=>{var _0x5b0edb=_0x4d1245;_0x4e4f56[_0x34f79e][_0x5b0edb(0x271)]=_0x497ff;}),_0x5ea5aa[_0x4d1245(0x214)]((_0x315dfc,_0x56650e)=>{var _0x1ea6e9=_0x4d1245;_0x4e4f56[_0x56650e][_0x1ea6e9(0x278)]=_0x315dfc;}),_0x44bf5d[_0x4d1245(0x214)]((_0x4f9548,_0x5e6fcc)=>{var _0x37c958=_0x4d1245;_0x4e4f56[_0x5e6fcc][_0x37c958(0x27f)]=_0x4f9548;}),_0x2e9282[_0x4d1245(0x214)]((_0xc53c89,_0x2200b3)=>{var _0x29c01a=_0x4d1245;_0x4e4f56[_0x2200b3][_0x29c01a(0x24a)]=_0xc53c89;});const _0x2c8310=_0x4e4f56['filter'](_0x569aa3=>_0x569aa3[_0x4d1245(0x1e5)]!=='0'&&_0x569aa3[_0x4d1245(0x1e5)]!==''||_0x569aa3['to_floorlevel']!=='0'&&_0x569aa3[_0x4d1245(0x1e9)]!=='');var _0x579d7e=0x0;_0x2c8310[_0x4d1245(0x214)](_0x3a90e5=>{var _0x211075=_0x4d1245;parseInt(_0x3a90e5[_0x211075(0x253)])<parseInt(_0x3a90e5['to_quantity'])&&_0x579d7e++;});if(_0x579d7e!=0x0)return _0x4d81f6[_0x4d1245(0x27d)](_0x4d1245(0x1e6),_0x4d1245(0x25d)),_0x176c58[_0x4d1245(0x236)]('back');const _0x439249=new transfers_logs();await _0x439249['save']();for(let _0x47ff21=0x0;_0x47ff21<=_0x2e9282[_0x4d1245(0x22c)]-0x1;_0x47ff21++){_0x4e4f56[_0x47ff21]['To_invoice']='LOG-TRF-'+_0x439249[_0x4d1245(0x27a)][_0x4d1245(0x263)]()['padStart'](0x8,'0');}const _0x1efa39=new transfers_finished({'date':_0x3ebc3e,'from_warehouse':_0x2d6699,'to_warehouse':_0x2d6699,'product':_0x2c8310,'note':_0x3d26f8,'invoice':_0x4d1245(0x1dd)+_0x439249[_0x4d1245(0x27a)][_0x4d1245(0x263)]()['padStart'](0x8,'0'),'type_of_process':_0x4d1245(0x28d),'type_of_transaction':_0x4d1245(0x29c),'PO_number':_0x36d276,'RequestedBy':_0x15566a,'DateofRequest':_0x2419ab,'typeservices':_0x1ebe3c,'destination':_0x889da2,'deliverydate':_0x53e371,'driver':_0x5792eb,'plate':_0x57c4ae,'van':_0x4e717a,'DRSI':_0x419bc6,'typevehicle':_0x30c7aa,'TSU':_0x3d7000,'TFU':_0x40ea7f}),_0x1ba931=await _0x1efa39[_0x4d1245(0x297)]();_0x4d81f6[_0x4d1245(0x27d)](_0x4d1245(0x1f2),_0x4d1245(0x1ec)),_0x176c58[_0x4d1245(0x236)](_0x4d1245(0x28a)+_0x1ba931[_0x4d1245(0x291)]);}catch(_0x504bf0){console[_0x4d1245(0x1f6)](_0x504bf0),_0x176c58[_0x4d1245(0x266)](0xc8)['json']({'errorMessage':_0x504bf0[_0x4d1245(0x242)]});}}),router[a0_0x48036d(0x23b)](a0_0x48036d(0x22d),auth,async(_0x2855b4,_0x206655)=>{var _0x4017bc=a0_0x48036d;try{const {date:_0x18553b,from_warehouse:_0x4b8514,FromRoom_name:_0x3e67c3,to_warehouse:_0x5cdda2,ToRoom_name:_0x4e2367,prod_name:_0x430dea,from_prod_qty:_0x38d395,from_prod_level:_0x566f2b,from_prod_isle:_0x7190aa,from_prod_pallet:_0x2a2cbb,to_prod_qty:_0x499514,to_prod_level:_0x233b90,to_prod_isle:_0x21a6da,to_prod_pallet:_0x2887e9,primary_code:_0x41133a,secondary_code:_0x46e508,product_code3:_0x80c036,note:_0xf0ef15,MaxStocks_data2:_0x2c61eb,invoice:_0x53a10f,expiry_date:_0x1c51d6,PO_number_loc:_0x1a5594,ReqBy_loc:_0x475476,dateofreq_loc:_0xdeeba7,typeservices_loc_Data:_0x52cd35,destination_loc:_0x1220d9,deliverydate_loc:_0x1a24a4,driver_loc:_0x3e62cd,plate_loc:_0x45417f,van_loc:_0xe698c7,DRSI_loc:_0x43c7a3,typevehicle_loc:_0xdfbf6b,TSU_loc:_0x40a4a1,TFU_loc:_0x2359ff}=_0x2855b4[_0x4017bc(0x239)];if(typeof _0x430dea==_0x4017bc(0x28b))var _0x155edf=[_0x2855b4['body']['prod_name']],_0x3d7e87=[_0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x29d)]],_0x1ff517=[_0x2855b4['body']['from_prod_level2']],_0x1c26a6=[_0x2855b4['body'][_0x4017bc(0x254)]],_0x4c4741=[_0x2855b4['body']['to_prod_level']],_0x4abe51=[_0x2855b4[_0x4017bc(0x239)]['primary_code']],_0xfa0703=[_0x2855b4[_0x4017bc(0x239)]['secondary_code']],_0x13a8fd=[_0x2855b4[_0x4017bc(0x239)]['product_code3']],_0x4f133b=[_0x2855b4['body']['MaxStocks_data2']],_0x1784d5=[_0x2855b4[_0x4017bc(0x239)]['primary_unit']],_0x1ac14e=[_0x2855b4['body'][_0x4017bc(0x225)]],_0x5157d8=[_0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x22f)]],_0x2f3aa8=[_0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x228)]],_0x13d4da=[_0x2855b4['body']['product_date']],_0xa5cb9f=[_0x2855b4['body']['MaxStocks_data']],_0x7efb08=[_0x2855b4['body'][_0x4017bc(0x271)]],_0x3c6e98=[_0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x278)]],_0x3002df=[_0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x227)]],_0x1ec9e2=[_0x2855b4[_0x4017bc(0x239)]['ToRoomAssigned']],_0x2dd70a=[_0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x285)]],_0x3ce6d3=[_0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x262)]];else var _0x155edf=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x243)]],_0x3d7e87=[..._0x2855b4['body'][_0x4017bc(0x29d)]],_0x1ff517=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x29f)]],_0x1c26a6=[..._0x2855b4[_0x4017bc(0x239)]['New_Qty_Converted']],_0x4c4741=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x217)]],_0x4abe51=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x219)]],_0xfa0703=[..._0x2855b4[_0x4017bc(0x239)]['secondary_code']],_0x13a8fd=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x207)]],_0x4f133b=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x23a)]],_0x1784d5=[..._0x2855b4[_0x4017bc(0x239)]['primary_unit']],_0x1ac14e=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x225)]],_0x5157d8=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x22f)]],_0x2f3aa8=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x228)]],_0x13d4da=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x22a)]],_0xa5cb9f=[..._0x2855b4[_0x4017bc(0x239)][_0x4017bc(0x1de)]],_0x7efb08=[..._0x2855b4[_0x4017bc(0x239)]['maxPerUnit']],_0x3c6e98=[..._0x2855b4[_0x4017bc(0x239)]['prod_cat']],_0x3002df=[..._0x2855b4['body']['RoomAssigned']],_0x1ec9e2=[..._0x2855b4[_0x4017bc(0x239)]['ToRoomAssigned']],_0x2dd70a=[..._0x2855b4[_0x4017bc(0x239)]['from_invoice']],_0x3ce6d3=[..._0x2855b4['body'][_0x4017bc(0x262)]];const _0x29e69b=_0x155edf[_0x4017bc(0x244)](_0x401741=>{return _0x401741={'product_name':_0x401741};});_0x3d7e87[_0x4017bc(0x214)]((_0x17dd7a,_0x19fc29)=>{var _0x4a926a=_0x4017bc;_0x29e69b[_0x19fc29][_0x4a926a(0x253)]=_0x17dd7a;}),_0x1ff517['forEach']((_0x48eccf,_0x10df09)=>{var _0x54fe97=_0x4017bc,_0xf17722=_0x48eccf[_0x54fe97(0x265)](/[A-Za-z]+/)[0x0],_0x2bcc12=parseInt(_0x48eccf[_0x54fe97(0x265)](/\d+/)[0x0]);_0x29e69b[_0x10df09][_0x54fe97(0x248)]=_0x2bcc12,_0x29e69b[_0x10df09][_0x54fe97(0x249)]=_0xf17722;}),_0x3ce6d3[_0x4017bc(0x214)]((_0x2c8345,_0x2d9a8f)=>{var _0x3b006b=_0x4017bc;_0x29e69b[_0x2d9a8f][_0x3b006b(0x262)]=_0x2c8345;}),_0x2dd70a[_0x4017bc(0x214)]((_0x35c2cf,_0x852d9c)=>{_0x29e69b[_0x852d9c]['from_invoice']=_0x35c2cf;}),_0x1c26a6[_0x4017bc(0x214)]((_0x3c8a3f,_0x3fd4e6)=>{var _0x4d5470=_0x4017bc;_0x29e69b[_0x3fd4e6][_0x4d5470(0x1e5)]=_0x3c8a3f;}),_0x4c4741['forEach']((_0x11ee0a,_0x3c0c9f)=>{var _0x18aa34=_0x4017bc,_0x37ad05=_0x11ee0a[_0x18aa34(0x265)](/[A-Za-z]+/)[0x0],_0x2c3122=parseInt(_0x11ee0a[_0x18aa34(0x265)](/\d+/)[0x0]);_0x29e69b[_0x3c0c9f][_0x18aa34(0x234)]=_0x37ad05,_0x29e69b[_0x3c0c9f][_0x18aa34(0x218)]=_0x2c3122;}),_0x4abe51[_0x4017bc(0x214)]((_0x43f147,_0x2906a3)=>{var _0x28801b=_0x4017bc;_0x29e69b[_0x2906a3][_0x28801b(0x219)]=_0x43f147;}),_0xfa0703[_0x4017bc(0x214)]((_0x5e9828,_0x5ad8dd)=>{var _0x2a9556=_0x4017bc;_0x29e69b[_0x5ad8dd][_0x2a9556(0x20f)]=_0x5e9828;}),_0x13a8fd[_0x4017bc(0x214)]((_0x58a5b1,_0x112249)=>{var _0x500d73=_0x4017bc;_0x29e69b[_0x112249][_0x500d73(0x1fd)]=_0x58a5b1;}),_0x4f133b[_0x4017bc(0x214)]((_0x3f214e,_0x370e8a)=>{var _0x225600=_0x4017bc;_0x29e69b[_0x370e8a][_0x225600(0x21a)]=_0x3f214e;}),_0x1784d5[_0x4017bc(0x214)]((_0x130634,_0xd5d82a)=>{var _0x273b66=_0x4017bc;_0x29e69b[_0xd5d82a][_0x273b66(0x1fa)]=_0x130634;}),_0x1ac14e[_0x4017bc(0x214)]((_0x1ea962,_0x2ccbee)=>{_0x29e69b[_0x2ccbee]['secondary_unit']=_0x1ea962;}),_0x5157d8['forEach']((_0x50aba8,_0xa444fc)=>{_0x29e69b[_0xa444fc]['batch_code']=_0x50aba8;}),_0x2f3aa8['forEach']((_0x599c37,_0x4ba0fb)=>{var _0x1351f7=_0x4017bc;_0x29e69b[_0x4ba0fb][_0x1351f7(0x228)]=_0x599c37;}),_0x13d4da[_0x4017bc(0x214)]((_0x4054cf,_0x9c875b)=>{var _0x593881=_0x4017bc;_0x29e69b[_0x9c875b][_0x593881(0x25e)]=_0x4054cf;}),_0xa5cb9f[_0x4017bc(0x214)]((_0x5b7f62,_0x4c2ea6)=>{var _0x110d7d=_0x4017bc;_0x29e69b[_0x4c2ea6][_0x110d7d(0x21a)]=_0x5b7f62;}),_0x7efb08[_0x4017bc(0x214)]((_0x104f91,_0x33f7ed)=>{_0x29e69b[_0x33f7ed]['maxPerUnit']=_0x104f91;}),_0x3c6e98[_0x4017bc(0x214)]((_0x15950c,_0x408c92)=>{var _0x2b39ab=_0x4017bc;_0x29e69b[_0x408c92][_0x2b39ab(0x278)]=_0x15950c;}),_0x3002df[_0x4017bc(0x214)]((_0x4ec6a3,_0x13f202)=>{var _0x3fc2f8=_0x4017bc;_0x29e69b[_0x13f202][_0x3fc2f8(0x27f)]=_0x4ec6a3;}),_0x1ec9e2[_0x4017bc(0x214)]((_0x3b78b1,_0x570041)=>{var _0x1f66cb=_0x4017bc;_0x29e69b[_0x570041][_0x1f66cb(0x24a)]=_0x3b78b1;});const _0x4d8b5d=_0x29e69b[_0x4017bc(0x27e)](_0x317c4b=>_0x317c4b[_0x4017bc(0x1e5)]!=='0'&&_0x317c4b[_0x4017bc(0x1e5)]!==''||_0x317c4b[_0x4017bc(0x1e9)]!=='0'&&_0x317c4b[_0x4017bc(0x1e9)]!=='');var _0x5335a6=0x0;_0x4d8b5d[_0x4017bc(0x214)](_0x12ca26=>{var _0x7db34e=_0x4017bc;parseInt(_0x12ca26['from_quantity'])<parseInt(_0x12ca26[_0x7db34e(0x1e5)])&&_0x5335a6++;});if(_0x5335a6!=0x0)return _0x2855b4[_0x4017bc(0x27d)]('errors',_0x4017bc(0x25d)),_0x206655[_0x4017bc(0x236)]('back');const _0x3c3798=new transfers_logs();await _0x3c3798['save']();for(let _0x2c2d64=0x0;_0x2c2d64<=_0x1ec9e2['length']-0x1;_0x2c2d64++){_0x29e69b[_0x2c2d64]['To_invoice']=_0x4017bc(0x1dd)+_0x3c3798[_0x4017bc(0x27a)][_0x4017bc(0x263)]()[_0x4017bc(0x296)](0x8,'0');}const _0x47d383=new transfers_finished({'date':_0x18553b,'from_warehouse':_0x4b8514,'to_warehouse':_0x5cdda2,'product':_0x4d8b5d,'note':_0xf0ef15,'invoice':_0x4017bc(0x1dd)+_0x3c3798[_0x4017bc(0x27a)][_0x4017bc(0x263)]()[_0x4017bc(0x296)](0x8,'0'),'type_of_transaction':_0x4017bc(0x29c),'type_of_process':_0x4017bc(0x20d),'PO_number':_0x1a5594,'RequestedBy':_0x475476,'DateofRequest':_0xdeeba7,'typeservices':_0x52cd35,'destination':_0x1220d9,'deliverydate':_0x1a24a4,'driver':_0x3e62cd,'plate':_0x45417f,'van':_0xe698c7,'DRSI':_0x43c7a3,'typevehicle':_0xdfbf6b,'TSU':_0x40a4a1,'TFU':_0x2359ff}),_0x20aebe=await _0x47d383[_0x4017bc(0x297)]();_0x2855b4[_0x4017bc(0x27d)]('success',_0x4017bc(0x1ec)),_0x206655[_0x4017bc(0x236)](_0x4017bc(0x28a)+_0x20aebe[_0x4017bc(0x291)]);}catch(_0xd87b76){console[_0x4017bc(0x1f6)](_0xd87b76),_0x206655[_0x4017bc(0x266)](0xc8)[_0x4017bc(0x25f)]({'errorMessage':_0xd87b76[_0x4017bc(0x242)]});}}),router[a0_0x48036d(0x23b)]('/view/add_transfer',auth,async(_0x3cbd80,_0xb28a20)=>{var _0x8339da=a0_0x48036d;try{const {date:_0x8109cc,from_warehouse:_0x255feb,FromRoom_name:_0x4a96b1,to_warehouse:_0x42cf42,ToRoom_name:_0x3dcbe7,prod_name:_0x3e661f,from_prod_qty:_0x569d51,from_prod_level:_0xfa4d86,from_prod_isle:_0x538998,from_prod_pallet:_0x14327b,to_prod_qty:_0x2a61d1,to_prod_level:_0x23d452,to_prod_isle:_0x17d392,to_prod_pallet:_0x553054,primary_code:_0xc64dc2,secondary_code:_0x2062c2,product_code3:_0x1514b3,note:_0x17928b,MaxStocks_data2:_0xd23bde,invoice:_0x8a9c85,expiry_date:_0x29f4ee,PO_number:_0x177ad4,ReqBy:_0x5dea47,dateofreq:_0x7075ac,typeservicesData:_0x33ac10,destination:_0x1f2783,deliverydate:_0x4522e6,driver:_0x9d32dc,plate:_0x3555fa,van:_0x5f506b,DRSI:_0x29eb95,typevehicle:_0x54af0c,TSU:_0x2b4bfd,TFU:_0x54e65a}=_0x3cbd80['body'];if(typeof _0x3e661f==_0x8339da(0x28b))var _0x1f971b=[_0x3cbd80['body'][_0x8339da(0x243)]],_0xfb27c2=[_0x3cbd80['body'][_0x8339da(0x29d)]],_0x45889c=[_0x3cbd80[_0x8339da(0x239)]['from_prod_level2']],_0x482050=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x254)]],_0xf68cf4=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x217)]],_0x377f59=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x219)]],_0x3006d9=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x20f)]],_0x91791f=[_0x3cbd80['body']['product_code3']],_0x5c830c=[_0x3cbd80['body'][_0x8339da(0x23a)]],_0xf8c0cd=[_0x3cbd80[_0x8339da(0x239)]['primary_unit']],_0x416f18=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x225)]],_0xc4282a=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x22f)]],_0x3c4a24=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x228)]],_0x49087e=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x22a)]],_0x5b0057=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x1de)]],_0xc90c2a=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x271)]],_0x27b045=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x278)]],_0x10b366=[_0x3cbd80[_0x8339da(0x239)]['RoomAssigned']],_0x281965=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x24b)]],_0x43d367=[_0x3cbd80[_0x8339da(0x239)][_0x8339da(0x285)]],_0x4628f9=[_0x3cbd80['body'][_0x8339da(0x262)]];else var _0x1f971b=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x243)]],_0xfb27c2=[..._0x3cbd80[_0x8339da(0x239)]['from_prod_qty']],_0x45889c=[..._0x3cbd80[_0x8339da(0x239)]['from_prod_level2']],_0x482050=[..._0x3cbd80[_0x8339da(0x239)]['New_Qty_Converted']],_0xf68cf4=[..._0x3cbd80['body'][_0x8339da(0x217)]],_0x377f59=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x219)]],_0x3006d9=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x20f)]],_0x91791f=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x207)]],_0x5c830c=[..._0x3cbd80[_0x8339da(0x239)]['MaxStocks_data2']],_0xf8c0cd=[..._0x3cbd80[_0x8339da(0x239)]['primary_unit']],_0x416f18=[..._0x3cbd80['body']['secondary_unit']],_0xc4282a=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x22f)]],_0x3c4a24=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x228)]],_0x49087e=[..._0x3cbd80['body'][_0x8339da(0x22a)]],_0x5b0057=[..._0x3cbd80[_0x8339da(0x239)]['MaxStocks_data']],_0xc90c2a=[..._0x3cbd80['body'][_0x8339da(0x271)]],_0x27b045=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x278)]],_0x10b366=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x227)]],_0x281965=[..._0x3cbd80['body']['ToRoomAssigned']],_0x43d367=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x285)]],_0x4628f9=[..._0x3cbd80[_0x8339da(0x239)][_0x8339da(0x262)]];const _0x19fe84=_0x1f971b[_0x8339da(0x244)](_0x4da15d=>{return _0x4da15d={'product_name':_0x4da15d};});_0xfb27c2[_0x8339da(0x214)]((_0x8dc7d3,_0x1cf049)=>{_0x19fe84[_0x1cf049]['from_quantity']=_0x8dc7d3;}),_0x45889c[_0x8339da(0x214)]((_0x171415,_0x4ea50d)=>{var _0x1f8f06=_0x8339da,_0x152117=_0x171415[_0x1f8f06(0x265)](/[A-Za-z]+/)[0x0],_0x428fe3=parseInt(_0x171415[_0x1f8f06(0x265)](/\d+/)[0x0]);_0x19fe84[_0x4ea50d][_0x1f8f06(0x248)]=_0x428fe3,_0x19fe84[_0x4ea50d][_0x1f8f06(0x249)]=_0x152117;}),_0x4628f9[_0x8339da(0x214)]((_0x14f47b,_0x176534)=>{var _0x2c7bb9=_0x8339da;_0x19fe84[_0x176534][_0x2c7bb9(0x262)]=_0x14f47b;}),_0x43d367[_0x8339da(0x214)]((_0x1c1d36,_0x38e55b)=>{_0x19fe84[_0x38e55b]['from_invoice']=_0x1c1d36;}),_0x482050[_0x8339da(0x214)]((_0x389e61,_0x593be9)=>{var _0x5c7dc6=_0x8339da;_0x19fe84[_0x593be9][_0x5c7dc6(0x1e5)]=_0x389e61;}),_0xf68cf4[_0x8339da(0x214)]((_0x4d71c9,_0x40d54d)=>{var _0x2a5e5b=_0x8339da,_0x19fdeb=_0x4d71c9[_0x2a5e5b(0x265)](/[A-Za-z]+/)[0x0],_0x583073=parseInt(_0x4d71c9[_0x2a5e5b(0x265)](/\d+/)[0x0]);_0x19fe84[_0x40d54d][_0x2a5e5b(0x234)]=_0x19fdeb,_0x19fe84[_0x40d54d][_0x2a5e5b(0x218)]=_0x583073;}),_0x377f59[_0x8339da(0x214)]((_0x4d81d9,_0x200ed2)=>{_0x19fe84[_0x200ed2]['primary_code']=_0x4d81d9;}),_0x3006d9['forEach']((_0x4163d3,_0x5ab5c0)=>{var _0x4560cd=_0x8339da;_0x19fe84[_0x5ab5c0][_0x4560cd(0x20f)]=_0x4163d3;}),_0x91791f[_0x8339da(0x214)]((_0x17600a,_0x3ce895)=>{_0x19fe84[_0x3ce895]['product_code']=_0x17600a;}),_0x5c830c[_0x8339da(0x214)]((_0x416f1b,_0x5ce585)=>{var _0x19733d=_0x8339da;_0x19fe84[_0x5ce585][_0x19733d(0x21a)]=_0x416f1b;}),_0xf8c0cd[_0x8339da(0x214)]((_0x4ae56a,_0x5c8633)=>{var _0x3c4433=_0x8339da;_0x19fe84[_0x5c8633][_0x3c4433(0x1fa)]=_0x4ae56a;}),_0x416f18[_0x8339da(0x214)]((_0x5f3489,_0x219d5b)=>{var _0x5f1d0a=_0x8339da;_0x19fe84[_0x219d5b][_0x5f1d0a(0x225)]=_0x5f3489;}),_0xc4282a[_0x8339da(0x214)]((_0x47bfac,_0x3acfc7)=>{_0x19fe84[_0x3acfc7]['batch_code']=_0x47bfac;}),_0x3c4a24[_0x8339da(0x214)]((_0x395cc6,_0x4889f5)=>{_0x19fe84[_0x4889f5]['expiry_date']=_0x395cc6;}),_0x49087e['forEach']((_0x52b568,_0x277daa)=>{var _0x2da5ff=_0x8339da;_0x19fe84[_0x277daa][_0x2da5ff(0x25e)]=_0x52b568;}),_0x5b0057[_0x8339da(0x214)]((_0x1d665e,_0x478839)=>{var _0x725582=_0x8339da;_0x19fe84[_0x478839][_0x725582(0x21a)]=_0x1d665e;}),_0xc90c2a['forEach']((_0x416add,_0x1bc11c)=>{var _0x1838a3=_0x8339da;_0x19fe84[_0x1bc11c][_0x1838a3(0x271)]=_0x416add;}),_0x27b045[_0x8339da(0x214)]((_0x3b50fb,_0x131fe8)=>{var _0x174ba2=_0x8339da;_0x19fe84[_0x131fe8][_0x174ba2(0x278)]=_0x3b50fb;}),_0x10b366[_0x8339da(0x214)]((_0x55da4a,_0x49bf49)=>{var _0x2a34cc=_0x8339da;_0x19fe84[_0x49bf49][_0x2a34cc(0x27f)]=_0x55da4a;}),_0x281965[_0x8339da(0x214)]((_0x1c1f5f,_0x208836)=>{var _0xb0f958=_0x8339da;_0x19fe84[_0x208836][_0xb0f958(0x24a)]=_0x1c1f5f;});const _0x52eb27=_0x19fe84['filter'](_0x21614d=>_0x21614d[_0x8339da(0x1e5)]!=='0'&&_0x21614d[_0x8339da(0x1e5)]!==''||_0x21614d['to_floorlevel']!=='0'&&_0x21614d[_0x8339da(0x1e9)]!=='');var _0x15e59b=0x0;_0x52eb27[_0x8339da(0x214)](_0x2f6069=>{var _0x441cab=_0x8339da;parseInt(_0x2f6069[_0x441cab(0x253)])<parseInt(_0x2f6069[_0x441cab(0x1e5)])&&_0x15e59b++;});if(_0x15e59b!=0x0)return _0x3cbd80['flash'](_0x8339da(0x1e6),_0x8339da(0x25d)),_0xb28a20[_0x8339da(0x236)](_0x8339da(0x221));const _0x2128af=new invoice_for_transfer();await _0x2128af[_0x8339da(0x297)]();for(let _0xaeefc6=0x0;_0xaeefc6<=_0x281965[_0x8339da(0x22c)]-0x1;_0xaeefc6++){_0x19fe84[_0xaeefc6][_0x8339da(0x220)]=_0x8339da(0x21d)+_0x2128af[_0x8339da(0x27a)][_0x8339da(0x263)]()[_0x8339da(0x296)](0x8,'0');}const _0x827a9a=new transfers_finished({'date':_0x8109cc,'from_warehouse':_0x255feb,'to_warehouse':_0x255feb,'product':_0x52eb27,'note':_0x17928b,'invoice':_0x8339da(0x21d)+_0x2128af[_0x8339da(0x27a)][_0x8339da(0x263)]()[_0x8339da(0x296)](0x8,'0'),'type_of_process':_0x8339da(0x28d),'type_of_transaction':_0x8339da(0x212),'PO_number':_0x177ad4,'RequestedBy':_0x5dea47,'DateofRequest':_0x7075ac,'typeservices':_0x33ac10,'destination':_0x1f2783,'deliverydate':_0x4522e6,'driver':_0x9d32dc,'plate':_0x3555fa,'van':_0x5f506b,'DRSI':_0x29eb95,'typevehicle':_0x54af0c,'TSU':_0x2b4bfd,'TFU':_0x54e65a}),_0x1d2b4b=await _0x827a9a[_0x8339da(0x297)]();_0x3cbd80[_0x8339da(0x27d)](_0x8339da(0x1f2),_0x8339da(0x1ec)),_0xb28a20[_0x8339da(0x236)](_0x8339da(0x28a)+_0x1d2b4b['_id']);}catch(_0x2d639c){console[_0x8339da(0x1f6)](_0x2d639c),_0xb28a20[_0x8339da(0x266)](0xc8)[_0x8339da(0x25f)]({'errorMessage':_0x2d639c[_0x8339da(0x242)]});}}),router[a0_0x48036d(0x23b)](a0_0x48036d(0x280),auth,async(_0x8bc0ed,_0x4d4242)=>{var _0x3a2917=a0_0x48036d;try{const {date:_0x340f95,from_warehouse:_0x232909,FromRoom_name:_0x3be4f6,to_warehouse:_0x3909a3,ToRoom_name:_0x17b1e4,prod_name:_0x9279af,from_prod_qty:_0x3355fd,from_prod_level:_0x3042ba,from_prod_isle:_0x10b919,from_prod_pallet:_0x5ab29c,to_prod_qty:_0x3c252,to_prod_level:_0x126262,to_prod_isle:_0x5381ea,to_prod_pallet:_0x54e645,primary_code:_0x2c9a4f,secondary_code:_0x383488,product_code3:_0x1360de,note:_0x136c4b,MaxStocks_data2:_0x3862e3,invoice:_0xf6b0c4,expiry_date:_0x3ffc53,PO_number_loc:_0x2ac3d3,ReqBy_loc:_0x31c2a1,dateofreq_loc:_0x3a2045,typeservices_loc_Data:_0x358af8,destination_loc:_0x1bb4cd,deliverydate_loc:_0x152570,driver_loc:_0x1abff3,plate_loc:_0x1ddb4c,van_loc:_0x59ba1d,DRSI_loc:_0xff5cd8,typevehicle_loc:_0x920a10,TSU_loc:_0x3dc273,TFU_loc:_0xef9fc}=_0x8bc0ed[_0x3a2917(0x239)];if(typeof _0x9279af=='string')var _0x5da419=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x243)]],_0x3a22eb=[_0x8bc0ed[_0x3a2917(0x239)]['from_prod_qty']],_0x1d2487=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x29f)]],_0x5526e7=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x254)]],_0x300224=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x217)]],_0x49b6ba=[_0x8bc0ed['body'][_0x3a2917(0x219)]],_0x36b353=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x20f)]],_0x7d047e=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x207)]],_0x541397=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x23a)]],_0xdd6be=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x25c)]],_0x1f66be=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x225)]],_0x3ef59a=[_0x8bc0ed['body']['batch_code']],_0x1ef438=[_0x8bc0ed['body'][_0x3a2917(0x228)]],_0x5785c7=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x22a)]],_0x4de90a=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x1de)]],_0x5ec076=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x271)]],_0x4d745f=[_0x8bc0ed[_0x3a2917(0x239)]['prod_cat']],_0x150079=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x227)]],_0x9ecfdf=[_0x8bc0ed[_0x3a2917(0x239)]['ToRoomAssigned']],_0x5cc801=[_0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x285)]],_0x215be8=[_0x8bc0ed['body'][_0x3a2917(0x262)]];else var _0x5da419=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x243)]],_0x3a22eb=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x29d)]],_0x1d2487=[..._0x8bc0ed['body'][_0x3a2917(0x29f)]],_0x5526e7=[..._0x8bc0ed['body']['New_Qty_Converted']],_0x300224=[..._0x8bc0ed['body'][_0x3a2917(0x217)]],_0x49b6ba=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x219)]],_0x36b353=[..._0x8bc0ed['body'][_0x3a2917(0x20f)]],_0x7d047e=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x207)]],_0x541397=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x23a)]],_0xdd6be=[..._0x8bc0ed['body'][_0x3a2917(0x25c)]],_0x1f66be=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x225)]],_0x3ef59a=[..._0x8bc0ed['body'][_0x3a2917(0x22f)]],_0x1ef438=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x228)]],_0x5785c7=[..._0x8bc0ed['body'][_0x3a2917(0x22a)]],_0x4de90a=[..._0x8bc0ed[_0x3a2917(0x239)]['MaxStocks_data']],_0x5ec076=[..._0x8bc0ed['body']['maxPerUnit']],_0x4d745f=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x278)]],_0x150079=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x227)]],_0x9ecfdf=[..._0x8bc0ed[_0x3a2917(0x239)]['ToRoomAssigned']],_0x5cc801=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x285)]],_0x215be8=[..._0x8bc0ed[_0x3a2917(0x239)][_0x3a2917(0x262)]];const _0xcab992=_0x5da419['map'](_0xe5b95d=>{return _0xe5b95d={'product_name':_0xe5b95d};});_0x3a22eb[_0x3a2917(0x214)]((_0x491d7d,_0x5b2839)=>{var _0x436c9b=_0x3a2917;_0xcab992[_0x5b2839][_0x436c9b(0x253)]=_0x491d7d;}),_0x1d2487[_0x3a2917(0x214)]((_0x32a0bf,_0x4c1984)=>{var _0x270c71=_0x3a2917,_0x2dea44=_0x32a0bf[_0x270c71(0x265)](/[A-Za-z]+/)[0x0],_0x3612d3=parseInt(_0x32a0bf[_0x270c71(0x265)](/\d+/)[0x0]);_0xcab992[_0x4c1984][_0x270c71(0x248)]=_0x3612d3,_0xcab992[_0x4c1984]['from_level']=_0x2dea44;}),_0x215be8[_0x3a2917(0x214)]((_0x208566,_0x21c749)=>{var _0x11d0de=_0x3a2917;_0xcab992[_0x21c749][_0x11d0de(0x262)]=_0x208566;}),_0x5cc801[_0x3a2917(0x214)]((_0x1336fc,_0x321cbc)=>{_0xcab992[_0x321cbc]['from_invoice']=_0x1336fc;}),_0x5526e7['forEach']((_0x386115,_0x1e6398)=>{var _0x32234e=_0x3a2917;_0xcab992[_0x1e6398][_0x32234e(0x1e5)]=_0x386115;}),_0x300224['forEach']((_0x138136,_0x5c7ff7)=>{var _0xc714dc=_0x3a2917,_0x44f6e1=_0x138136[_0xc714dc(0x265)](/[A-Za-z]+/)[0x0],_0x38e377=parseInt(_0x138136['match'](/\d+/)[0x0]);_0xcab992[_0x5c7ff7][_0xc714dc(0x234)]=_0x44f6e1,_0xcab992[_0x5c7ff7][_0xc714dc(0x218)]=_0x38e377;}),_0x49b6ba[_0x3a2917(0x214)]((_0x994e39,_0x5c2a53)=>{var _0x50aa80=_0x3a2917;_0xcab992[_0x5c2a53][_0x50aa80(0x219)]=_0x994e39;}),_0x36b353[_0x3a2917(0x214)]((_0x26011b,_0x1a6183)=>{_0xcab992[_0x1a6183]['secondary_code']=_0x26011b;}),_0x7d047e[_0x3a2917(0x214)]((_0x4e6644,_0x15b0b5)=>{var _0x2289bb=_0x3a2917;_0xcab992[_0x15b0b5][_0x2289bb(0x1fd)]=_0x4e6644;}),_0x541397[_0x3a2917(0x214)]((_0x1895ba,_0x2544cb)=>{_0xcab992[_0x2544cb]['maxProducts']=_0x1895ba;}),_0xdd6be[_0x3a2917(0x214)]((_0x45a897,_0x5a521d)=>{var _0x218a28=_0x3a2917;_0xcab992[_0x5a521d][_0x218a28(0x1fa)]=_0x45a897;}),_0x1f66be[_0x3a2917(0x214)]((_0x4e2574,_0x325f01)=>{_0xcab992[_0x325f01]['secondary_unit']=_0x4e2574;}),_0x3ef59a['forEach']((_0x4b8240,_0x1c1b6f)=>{_0xcab992[_0x1c1b6f]['batch_code']=_0x4b8240;}),_0x1ef438['forEach']((_0x444ea8,_0x30834c)=>{var _0x259623=_0x3a2917;_0xcab992[_0x30834c][_0x259623(0x228)]=_0x444ea8;}),_0x5785c7['forEach']((_0x215ee4,_0x148651)=>{var _0x33567f=_0x3a2917;_0xcab992[_0x148651][_0x33567f(0x25e)]=_0x215ee4;}),_0x4de90a[_0x3a2917(0x214)]((_0x90c9d8,_0x1896b3)=>{var _0x642a=_0x3a2917;_0xcab992[_0x1896b3][_0x642a(0x21a)]=_0x90c9d8;}),_0x5ec076[_0x3a2917(0x214)]((_0x5d0496,_0x2c3607)=>{var _0x3ab0b7=_0x3a2917;_0xcab992[_0x2c3607][_0x3ab0b7(0x271)]=_0x5d0496;}),_0x4d745f[_0x3a2917(0x214)]((_0x4d1841,_0x3ad6ef)=>{_0xcab992[_0x3ad6ef]['prod_cat']=_0x4d1841;}),_0x150079[_0x3a2917(0x214)]((_0x350f8d,_0x5af5e0)=>{var _0x45900d=_0x3a2917;_0xcab992[_0x5af5e0][_0x45900d(0x27f)]=_0x350f8d;}),_0x9ecfdf[_0x3a2917(0x214)]((_0x1b89be,_0x3d76dd)=>{var _0x5349e8=_0x3a2917;_0xcab992[_0x3d76dd][_0x5349e8(0x24a)]=_0x1b89be;});const _0x60f21=_0xcab992['filter'](_0x1c2990=>_0x1c2990[_0x3a2917(0x1e5)]!=='0'&&_0x1c2990[_0x3a2917(0x1e5)]!==''||_0x1c2990['to_floorlevel']!=='0'&&_0x1c2990[_0x3a2917(0x1e9)]!=='');var _0x14f28c=0x0;_0x60f21['forEach'](_0x44ba70=>{var _0x2d2ef7=_0x3a2917;parseInt(_0x44ba70[_0x2d2ef7(0x253)])<parseInt(_0x44ba70[_0x2d2ef7(0x1e5)])&&_0x14f28c++;});if(_0x14f28c!=0x0)return _0x8bc0ed[_0x3a2917(0x27d)]('errors',_0x3a2917(0x25d)),_0x4d4242[_0x3a2917(0x236)]('back');const _0x2cafd0=new invoice_for_transfer();await _0x2cafd0[_0x3a2917(0x297)]();for(let _0x16bce2=0x0;_0x16bce2<=_0x9ecfdf['length']-0x1;_0x16bce2++){_0xcab992[_0x16bce2][_0x3a2917(0x220)]='TRF-'+_0x2cafd0[_0x3a2917(0x27a)][_0x3a2917(0x263)]()['padStart'](0x8,'0');}const _0x5b3ba0=new transfers_finished({'date':_0x340f95,'from_warehouse':_0x232909,'to_warehouse':_0x3909a3,'product':_0x60f21,'note':_0x136c4b,'invoice':_0x3a2917(0x21d)+_0x2cafd0[_0x3a2917(0x27a)]['toString']()[_0x3a2917(0x296)](0x8,'0'),'type_of_transaction':_0x3a2917(0x212),'type_of_process':_0x3a2917(0x20d),'PO_number':_0x2ac3d3,'RequestedBy':_0x31c2a1,'DateofRequest':_0x3a2045,'typeservices':_0x358af8,'destination':_0x1bb4cd,'deliverydate':_0x152570,'driver':_0x1abff3,'plate':_0x1ddb4c,'van':_0x59ba1d,'DRSI':_0xff5cd8,'typevehicle':_0x920a10,'TSU':_0x3dc273,'TFU':_0xef9fc}),_0x43eda6=await _0x5b3ba0[_0x3a2917(0x297)]();_0x8bc0ed[_0x3a2917(0x27d)]('success',_0x3a2917(0x1ec)),_0x4d4242['redirect'](_0x3a2917(0x28a)+_0x43eda6[_0x3a2917(0x291)]);}catch(_0x314751){console[_0x3a2917(0x1f6)](_0x314751),_0x4d4242[_0x3a2917(0x266)](0xc8)[_0x3a2917(0x25f)]({'errorMessage':_0x314751['message']});}}),router[a0_0x48036d(0x28e)](a0_0x48036d(0x26f),auth,async(_0x4b9d51,_0x246cd9)=>{var _0x13721f=a0_0x48036d;try{const {username:_0x152005,email:_0x47bd56,role:_0x5b5066}=_0x4b9d51['user'],_0x453250=_0x4b9d51[_0x13721f(0x252)],_0xa8a511=await profile[_0x13721f(0x26e)]({'email':_0x453250[_0x13721f(0x213)]}),_0x1d9829=await master_shop[_0x13721f(0x27c)](),_0x2e55f3=await transfers_finished[_0x13721f(0x20e)](_0x4b9d51[_0x13721f(0x201)]['id']);let _0x2b59de;if(_0x453250[_0x13721f(0x1fb)]==_0x13721f(0x1eb)){const _0xf7c3d0=await staff['findOne']({'email':_0x453250['email']});_0x2b59de=await warehouse[_0x13721f(0x27c)]({'status':_0x13721f(0x232),'name':_0xf7c3d0[_0x13721f(0x1e4)],'warehouse_category':_0x13721f(0x205)});}else _0x2b59de=await warehouse[_0x13721f(0x27c)]({'status':'Enabled','warehouse_category':_0x13721f(0x205)});const _0x1c407e=await warehouse[_0x13721f(0x283)]([{'$match':{'name':_0x2e55f3[_0x13721f(0x223)],'warehouse_category':_0x13721f(0x205)}},{'$unwind':_0x13721f(0x24c)},{'$group':{'_id':_0x13721f(0x273),'name':{'$first':_0x13721f(0x241)},'product_stock':{'$first':_0x13721f(0x200)},'bay':{'$first':_0x13721f(0x26b)},'bin':{'$first':_0x13721f(0x24d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x13721f(0x1dc)},'primary_code':{'$first':_0x13721f(0x274)},'secondary_code':{'$first':_0x13721f(0x1e3)},'product_code':{'$first':_0x13721f(0x22e)},'storage':{'$first':_0x13721f(0x1df)},'rack':{'$first':_0x13721f(0x1e1)},'expiry_date':{'$first':_0x13721f(0x204)},'production_date':{'$first':_0x13721f(0x289)},'room':{'$first':'$room'},'warehoue_name':{'$first':'$name'}}}]),_0x1aa322=await product['find']({});if(_0x1d9829[0x0][_0x13721f(0x293)]=='English\x20(US)'){var _0x211c40=users[_0x13721f(0x29a)];console[_0x13721f(0x1f6)](_0x211c40);}else{if(_0x1d9829[0x0][_0x13721f(0x293)]==_0x13721f(0x224))var _0x211c40=users[_0x13721f(0x224)];else{if(_0x1d9829[0x0]['language']==_0x13721f(0x1f7))var _0x211c40=users[_0x13721f(0x1f7)];else{if(_0x1d9829[0x0]['language']==_0x13721f(0x2a0))var _0x211c40=users[_0x13721f(0x2a0)];else{if(_0x1d9829[0x0][_0x13721f(0x293)]==_0x13721f(0x238))var _0x211c40=users['French'];else{if(_0x1d9829[0x0][_0x13721f(0x293)]=='Portuguese\x20(BR)')var _0x211c40=users[_0x13721f(0x268)];else{if(_0x1d9829[0x0]['language']==_0x13721f(0x277))var _0x211c40=users[_0x13721f(0x277)];else{if(_0x1d9829[0x0]['language']==_0x13721f(0x1ee))var _0x211c40=users['Arabic'];}}}}}}}_0x246cd9['render'](_0x13721f(0x25b),{'success':_0x4b9d51[_0x13721f(0x27d)](_0x13721f(0x1f2)),'errors':_0x4b9d51[_0x13721f(0x27d)]('errors'),'role':_0x453250,'profile':_0xa8a511,'master_shop':_0x1d9829,'warehouse':_0x2b59de,'transfer':_0x2e55f3,'stock':_0x1c407e,'unit':_0x1aa322,'language':_0x211c40});}catch(_0x3ed4d9){console['log'](_0x3ed4d9);}}),router['post']('/preview/:id',auth,async(_0x1b64a7,_0x156013)=>{var _0x5bf7c9=a0_0x48036d;try{const {invoice:_0xc0bbad,from_warehouse:_0xece97f,FromRoom_name:_0x195016,to_warehouse:_0x19e51c,ToRoom_name:_0x293bcf}=_0x1b64a7[_0x5bf7c9(0x239)],_0x5594e2=await transfers_finished['findById'](_0x1b64a7[_0x5bf7c9(0x201)]['id']),_0x356b7c=_0x5594e2[_0x5bf7c9(0x288)][_0x5bf7c9(0x244)](async _0x218d02=>{var _0x25a491=_0x5bf7c9;if(_0x218d02[_0x25a491(0x1e5)]>0x0){var _0x566916=await warehouse[_0x25a491(0x26e)]({'name':_0xece97f,'room':_0x218d02[_0x25a491(0x27f)]});const _0x30f200=_0x566916[_0x25a491(0x26c)][_0x25a491(0x244)](_0x318827=>{var _0x345a2a=_0x25a491;_0x318827['_id']==_0x218d02['id_transaction']&&(_0x318827[_0x345a2a(0x27b)]=Math['max'](0x0,Math[_0x345a2a(0x246)](_0x318827[_0x345a2a(0x27b)])-Math[_0x345a2a(0x246)](_0x218d02[_0x345a2a(0x1e5)])),console[_0x345a2a(0x1f6)](_0x318827['product_stock']));});}return _0x566916;});Promise[_0x5bf7c9(0x22b)](_0x356b7c)[_0x5bf7c9(0x28f)](async _0x24267c=>{var _0x486220=_0x5bf7c9;try{for(const _0x5c6526 of _0x24267c){await _0x5c6526['save']();}const _0x580e23=_0x5594e2['product'][_0x486220(0x244)](async _0x5a19f0=>{var _0x29888b=_0x486220,_0x443562=await warehouse[_0x29888b(0x26e)]({'name':_0x19e51c,'room':_0x5a19f0[_0x29888b(0x24a)]});if(_0x5a19f0[_0x29888b(0x1e5)]>0x0){var _0x5d40ac=0x0;const _0x197cd6=_0x443562['product_details']['map'](_0x22cb3b=>{var _0x2bfb33=_0x29888b;_0x22cb3b[_0x2bfb33(0x226)]==_0x5a19f0[_0x2bfb33(0x226)]&&_0x22cb3b[_0x2bfb33(0x1fc)]==_0x5a19f0[_0x2bfb33(0x218)]&&_0x22cb3b[_0x2bfb33(0x228)]==_0x5a19f0[_0x2bfb33(0x228)]&&_0x22cb3b[_0x2bfb33(0x25e)]==_0x5a19f0[_0x2bfb33(0x25e)]&&_0x22cb3b[_0x2bfb33(0x22f)]==_0x5a19f0['batch_code']&&_0x22cb3b[_0x2bfb33(0x257)]==_0x5a19f0[_0x2bfb33(0x220)]&&(typeof _0x5a19f0[_0x2bfb33(0x262)]=='undefined'?(console['log'](_0x2bfb33(0x206),_0x22cb3b[_0x2bfb33(0x27b)]+_0x2bfb33(0x279)+_0x22cb3b[_0x2bfb33(0x291)]+'\x20<=>\x20'+Math[_0x2bfb33(0x246)](_0x22cb3b[_0x2bfb33(0x27b)])+Math[_0x2bfb33(0x246)](_0x5a19f0[_0x2bfb33(0x1e5)])),_0x22cb3b['product_stock']=Math['abs'](_0x22cb3b['product_stock'])+Math[_0x2bfb33(0x246)](_0x5a19f0['to_quantity'])):_0x22cb3b[_0x2bfb33(0x27b)]=Math[_0x2bfb33(0x246)](_0x22cb3b['product_stock'])+Math[_0x2bfb33(0x246)](_0x5a19f0[_0x2bfb33(0x1e5)]),_0x5d40ac++);});_0x5d40ac=='0'&&(_0x443562[_0x29888b(0x26c)]=_0x443562['product_details']['concat']({'product_name':_0x5a19f0[_0x29888b(0x226)],'product_stock':_0x5a19f0[_0x29888b(0x1e5)],'bay':_0x5a19f0[_0x29888b(0x218)],'level':_0x5a19f0[_0x29888b(0x234)],'product_code':_0x5a19f0[_0x29888b(0x1fd)],'primary_code':_0x5a19f0[_0x29888b(0x219)],'secondary_code':_0x5a19f0[_0x29888b(0x20f)],'expiry_date':_0x5a19f0['expiry_date'],'production_date':_0x5a19f0['production_date'],'maxProducts':_0x5a19f0[_0x29888b(0x21a)],'batch_code':_0x5a19f0[_0x29888b(0x22f)],'secondary_unit':_0x5a19f0[_0x29888b(0x225)],'unit':_0x5a19f0['unit'],'maxProducts':_0x5a19f0[_0x29888b(0x21a)],'maxPerUnit':_0x5a19f0[_0x29888b(0x271)],'invoice':_0x5a19f0[_0x29888b(0x220)]}));}return _0x443562;});Promise[_0x486220(0x22b)](_0x580e23)[_0x486220(0x28f)](async _0x7d6b5d=>{var _0xbf2a5=_0x486220;try{console[_0xbf2a5(0x1f6)](_0x5594e2[_0xbf2a5(0x251)]);if(_0x5594e2[_0xbf2a5(0x251)]!=_0xbf2a5(0x20d))for(const _0x7ff219 of _0x7d6b5d){await warehouse[_0xbf2a5(0x270)]({'_id':_0x7ff219[_0xbf2a5(0x291)]},{'$addToSet':{'product_details':{'$each':_0x7ff219[_0xbf2a5(0x26c)]}}});}_0x5594e2['finalize']=_0xbf2a5(0x26a);const _0x5df6b5=await _0x5594e2['save'](),_0x3ea640=await master_shop[_0xbf2a5(0x27c)](),_0x22f0eb=await email_settings[_0xbf2a5(0x26e)](),_0x16b8a8=await supervisor_settings['find']();var _0x2e9c9e=_0x5594e2[_0xbf2a5(0x288)],_0x24a55b='',_0x2eeef9;for(_0x2eeef9 in _0x2e9c9e){var _0x4f0029='FG';_0x5594e2['to_warehouse']==_0xbf2a5(0x1f4)&&(_0x4f0029='DG'),_0x24a55b+=_0xbf2a5(0x247)+_0xbf2a5(0x208)+_0x2e9c9e[_0x2eeef9][_0xbf2a5(0x226)]+_0xbf2a5(0x202)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2e9c9e[_0x2eeef9][_0xbf2a5(0x1fd)]+_0xbf2a5(0x202)+_0xbf2a5(0x208)+_0x2e9c9e[_0x2eeef9][_0xbf2a5(0x1e5)]+_0xbf2a5(0x202)+_0xbf2a5(0x208)+_0x2e9c9e[_0x2eeef9][_0xbf2a5(0x1fa)]+_0xbf2a5(0x202)+_0xbf2a5(0x208)+_0x2e9c9e[_0x2eeef9]['secondary_unit']+_0xbf2a5(0x202)+_0xbf2a5(0x208)+_0x5594e2['to_warehouse']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2e9c9e[_0x2eeef9]['to_room_name']+'</td>'+_0xbf2a5(0x208)+_0x4f0029+_0x2e9c9e[_0x2eeef9][_0xbf2a5(0x218)]+_0xbf2a5(0x202)+'</tr>';}_0x1b64a7[_0xbf2a5(0x27d)](_0xbf2a5(0x1f2),'Transfer\x20Finalize\x20Successfully'),_0x156013[_0xbf2a5(0x236)]('/picking_list/PDF_transfer/'+_0x5df6b5[_0xbf2a5(0x291)]);}catch(_0x2d03e6){console[_0xbf2a5(0x295)](_0x2d03e6),_0x156013[_0xbf2a5(0x266)](0x1f4)[_0xbf2a5(0x25f)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0x291289=>{var _0x5ae4ee=_0x486220;console['error'](_0x291289),_0x156013[_0x5ae4ee(0x266)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x47073f){console[_0x486220(0x295)](_0x47073f),_0x156013[_0x486220(0x266)](0x1f4)[_0x486220(0x25f)]({'error':_0x486220(0x1f0)});}})[_0x5bf7c9(0x210)](_0x4f2f9b=>{var _0x35d654=_0x5bf7c9;console['error'](_0x4f2f9b),_0x156013[_0x35d654(0x266)](0x1f4)[_0x35d654(0x25f)]({'error':_0x35d654(0x28c)});});}catch(_0x5cb439){_0x156013[_0x5bf7c9(0x25f)]({'message':_0x5cb439[_0x5bf7c9(0x242)]});}});function BayBinSelected(_0x167011,_0x472fa3){var _0x2a4b35=a0_0x48036d,_0x52ff02=[];let _0x782e0a=[];var _0x2a25b7=[];if(_0x167011==_0x2a4b35(0x1f4)){switch(_0x472fa3){case'Rack\x201':_0x52ff02=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x2a4b35(0x20c):_0x52ff02=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x2a25b7=['DG'];}else{if(_0x167011==_0x2a4b35(0x216)){switch(_0x472fa3){case'Rack\x201':_0x52ff02=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x2a4b35(0x20c):_0x52ff02=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x2a25b7=['FG'];}}return{'levels':_0x52ff02,'identify':_0x2a25b7};}router[a0_0x48036d(0x28e)](a0_0x48036d(0x259),auth,async(_0x547ed6,_0x14a49c)=>{var _0x236afb=a0_0x48036d;try{const {username:_0x5a401b,email:_0xb63fc,role:_0x4dfa83}=_0x547ed6['user'],_0x2054c9=_0x547ed6[_0x236afb(0x252)],_0x137e52=await profile[_0x236afb(0x26e)]({'email':_0x2054c9[_0x236afb(0x213)]}),_0x1f53c1=await master_shop[_0x236afb(0x27c)](),_0x57e751=await transfers_finished['findById'](_0x547ed6[_0x236afb(0x201)]['id']);let _0x385705=new Date(_0x57e751[_0x236afb(0x228)]),_0x373783=('0'+_0x385705['getDate']())[_0x236afb(0x203)](-0x2),_0x2e9b8c=('0'+(_0x385705['getMonth']()+0x1))[_0x236afb(0x203)](-0x2),_0xfc39f6=_0x385705[_0x236afb(0x298)](),_0x412992=_0xfc39f6+'-'+_0x2e9b8c+'-'+_0x373783,_0x481965;if(_0x2054c9[_0x236afb(0x1fb)]==_0x236afb(0x1eb)){const _0x4a4300=await staff['findOne']({'email':_0x2054c9[_0x236afb(0x213)]});_0x481965=await warehouse[_0x236afb(0x27c)]({'status':_0x236afb(0x232),'name':_0x4a4300[_0x236afb(0x1e4)],'warehouse_category':_0x236afb(0x205)});}else _0x481965=await warehouse['find']({'status':_0x236afb(0x232),'warehouse_category':_0x236afb(0x205)});const _0x13c81d=await warehouse[_0x236afb(0x283)]([{'$match':{'name':_0x57e751[_0x236afb(0x223)],'room':_0x57e751[_0x236afb(0x231)]}},{'$unwind':_0x236afb(0x24c)},{'$group':{'_id':_0x236afb(0x273),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x236afb(0x200)},'bay':{'$first':_0x236afb(0x26b)},'bin':{'$first':_0x236afb(0x24d)},'type':{'$first':_0x236afb(0x292)},'floorlevel':{'$first':_0x236afb(0x1dc)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x236afb(0x1e3)},'product_code':{'$first':_0x236afb(0x22e)},'storage':{'$first':_0x236afb(0x1df)},'rack':{'$first':_0x236afb(0x1e1)}}}]);var _0x319c0f=[0x1,0x2,0x3,0x4],_0x5f0260=['A','B','C','D','E','F','G','H','I','J'],_0x3f70b7=[_0x236afb(0x211),_0x236afb(0x21e)];const _0x40ff04=await product[_0x236afb(0x27c)]({}),_0x13a720=BayBinSelected(_0x57e751[_0x236afb(0x24e)],_0x57e751[_0x236afb(0x269)]);if(_0x1f53c1[0x0][_0x236afb(0x293)]==_0x236afb(0x1e7)){var _0x94d816=users[_0x236afb(0x29a)];console[_0x236afb(0x1f6)](_0x94d816);}else{if(_0x1f53c1[0x0][_0x236afb(0x293)]==_0x236afb(0x224))var _0x94d816=users[_0x236afb(0x224)];else{if(_0x1f53c1[0x0][_0x236afb(0x293)]==_0x236afb(0x1f7))var _0x94d816=users[_0x236afb(0x1f7)];else{if(_0x1f53c1[0x0][_0x236afb(0x293)]==_0x236afb(0x2a0))var _0x94d816=users[_0x236afb(0x2a0)];else{if(_0x1f53c1[0x0][_0x236afb(0x293)]=='French')var _0x94d816=users['French'];else{if(_0x1f53c1[0x0]['language']==_0x236afb(0x276))var _0x94d816=users[_0x236afb(0x268)];else{if(_0x1f53c1[0x0][_0x236afb(0x293)]==_0x236afb(0x277))var _0x94d816=users[_0x236afb(0x277)];else{if(_0x1f53c1[0x0]['language']==_0x236afb(0x1ee))var _0x94d816=users['Arabic'];}}}}}}}_0x14a49c['render']('edit_transfer_finished',{'success':_0x547ed6['flash'](_0x236afb(0x1f2)),'errors':_0x547ed6[_0x236afb(0x27d)](_0x236afb(0x1e6)),'role':_0x2054c9,'profile':_0x137e52,'master_shop':_0x1f53c1,'warehouse':_0x481965,'transfer':_0x57e751,'stock':_0x13c81d,'unit':_0x40ff04,'language':_0x94d816,'levels':_0x319c0f,'Isle':_0x5f0260,'rooms_data':_0x3f70b7,'ed_fullDate':_0x412992,'dataSelected':_0x13a720});}catch(_0x3b2691){console[_0x236afb(0x1f6)](_0x3b2691);}}),router[a0_0x48036d(0x23b)](a0_0x48036d(0x259),auth,async(_0x1e6ef3,_0xa36f)=>{var _0x1e3ab7=a0_0x48036d;try{const _0x52ead0=_0x1e6ef3[_0x1e3ab7(0x201)]['id'];console[_0x1e3ab7(0x1f6)](_0x1e6ef3['body']);const _0x4c6ec7=await transfers_finished['findById'](_0x52ead0);console[_0x1e3ab7(0x1f6)](_0x1e3ab7(0x286),_0x4c6ec7);const {date:_0x3d5883,from_warehouse:_0x392df8,FromRoom_name:_0xff63dc,to_warehouse:_0xffc09d,ToRoom_name:_0x2e1f32,prod_name:_0x1c683,from_prod_qty:_0x44b95e,from_prod_level:_0x2afb06,from_prod_isle:_0x2a121b,from_prod_pallet:_0x2d7753,to_prod_qty:_0x4ac41d,to_prod_level:_0x1a775b,to_prod_isle:_0x38ab9b,to_prod_pallet:_0x3fea54,primary_code:_0x5d85ae,secondary_code:_0x525db3,product_code3:_0x5ed826,note:_0x2266d8,invoice:_0x4e1c7e,expiry_date:_0xddb7f1}=_0x1e6ef3[_0x1e3ab7(0x239)];if(typeof _0x1c683==_0x1e3ab7(0x28b))var _0x240e39=[_0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x243)]],_0x337458=[_0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x29d)]],_0x10a92b=[_0x1e6ef3[_0x1e3ab7(0x239)]['from_prod_level']],_0x53f32d=[_0x1e6ef3[_0x1e3ab7(0x239)]['to_prod_qty']],_0x1e5ca7=[_0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x217)]],_0x16d5f4=[_0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x219)]],_0x3274c3=[_0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x20f)]],_0x21f10f=[_0x1e6ef3['body'][_0x1e3ab7(0x207)]],_0x1cf43d=[_0x1e6ef3['body'][_0x1e3ab7(0x23a)]],_0x3ca7da=[_0x1e6ef3['body'][_0x1e3ab7(0x1fa)]],_0x295cac=[_0x1e6ef3[_0x1e3ab7(0x239)]['secondary_unit']],_0x3dc9bc=[_0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x22f)]],_0x5e204b=[_0x1e6ef3[_0x1e3ab7(0x239)]['expiry_date']];else var _0x240e39=[..._0x1e6ef3['body'][_0x1e3ab7(0x243)]],_0x337458=[..._0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x29d)]],_0x10a92b=[..._0x1e6ef3['body'][_0x1e3ab7(0x1f3)]],_0x53f32d=[..._0x1e6ef3['body']['to_prod_qty']],_0x1e5ca7=[..._0x1e6ef3[_0x1e3ab7(0x239)]['to_prod_level']],_0x16d5f4=[..._0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x219)]],_0x3274c3=[..._0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x20f)]],_0x21f10f=[..._0x1e6ef3['body']['product_code3']],_0x1cf43d=[..._0x1e6ef3['body'][_0x1e3ab7(0x23a)]],_0x3ca7da=[..._0x1e6ef3[_0x1e3ab7(0x239)]['unit']],_0x295cac=[..._0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x225)]],_0x3dc9bc=[..._0x1e6ef3[_0x1e3ab7(0x239)][_0x1e3ab7(0x22f)]],_0x5e204b=[..._0x1e6ef3[_0x1e3ab7(0x239)]['expiry_date']];const _0x4b2806=_0x240e39[_0x1e3ab7(0x244)](_0x468976=>{return _0x468976={'product_name':_0x468976};});_0x337458[_0x1e3ab7(0x214)]((_0x1de6c7,_0x3b39d2)=>{var _0x502f85=_0x1e3ab7;_0x4b2806[_0x3b39d2][_0x502f85(0x253)]=_0x1de6c7;}),_0x10a92b['forEach']((_0x3caaf7,_0x3aa6ba)=>{var _0x368677=_0x1e3ab7;_0x4b2806[_0x3aa6ba][_0x368677(0x248)]=_0x3caaf7;}),_0x53f32d[_0x1e3ab7(0x214)]((_0x582796,_0x125f7e)=>{var _0x271bad=_0x1e3ab7;_0x4b2806[_0x125f7e][_0x271bad(0x1e5)]=_0x582796;}),_0x1e5ca7[_0x1e3ab7(0x214)]((_0x5e6ed3,_0x4c1c56)=>{var _0x1400f7=_0x1e3ab7;_0x4b2806[_0x4c1c56][_0x1400f7(0x218)]=_0x5e6ed3;}),_0x16d5f4['forEach']((_0x1f732f,_0x315ad8)=>{_0x4b2806[_0x315ad8]['primary_code']=_0x1f732f;}),_0x3274c3['forEach']((_0x1601f2,_0x25ad7b)=>{var _0x54c8c2=_0x1e3ab7;_0x4b2806[_0x25ad7b][_0x54c8c2(0x20f)]=_0x1601f2;}),_0x21f10f[_0x1e3ab7(0x214)]((_0x2c4c09,_0x5ec657)=>{_0x4b2806[_0x5ec657]['product_code']=_0x2c4c09;}),_0x1cf43d[_0x1e3ab7(0x214)]((_0x5ae59e,_0x4d8022)=>{var _0x15699a=_0x1e3ab7;_0x4b2806[_0x4d8022][_0x15699a(0x21a)]=_0x5ae59e;}),_0x3ca7da['forEach']((_0x3b5fc9,_0x8e57b1)=>{var _0x1eb6a7=_0x1e3ab7;_0x4b2806[_0x8e57b1][_0x1eb6a7(0x1fa)]=_0x3b5fc9;}),_0x295cac[_0x1e3ab7(0x214)]((_0x59fb7f,_0x8b365e)=>{var _0x4ddec9=_0x1e3ab7;_0x4b2806[_0x8b365e][_0x4ddec9(0x225)]=_0x59fb7f;}),_0x3dc9bc[_0x1e3ab7(0x214)]((_0x2713f6,_0x540e74)=>{var _0x597299=_0x1e3ab7;_0x4b2806[_0x540e74][_0x597299(0x22f)]=_0x2713f6;}),_0x5e204b[_0x1e3ab7(0x214)]((_0x212263,_0x5e3963)=>{var _0x1257f7=_0x1e3ab7;_0x4b2806[_0x5e3963][_0x1257f7(0x228)]=_0x212263;});const _0x2c743e=_0x4b2806[_0x1e3ab7(0x27e)](_0x351d08=>_0x351d08['to_quantity']!=='0'&&_0x351d08[_0x1e3ab7(0x1e5)]!==''||_0x351d08[_0x1e3ab7(0x1e9)]!=='0'&&_0x351d08[_0x1e3ab7(0x1e9)]!=='');var _0x2d0d62=0x0;_0x2c743e[_0x1e3ab7(0x214)](_0x1795a3=>{var _0x55bfe3=_0x1e3ab7;parseInt(_0x1795a3['from_quantity'])<parseInt(_0x1795a3[_0x55bfe3(0x1e5)])&&_0x2d0d62++;});if(_0x2d0d62!=0x0)return _0x1e6ef3[_0x1e3ab7(0x27d)](_0x1e3ab7(0x1e6),_0x1e3ab7(0x25d)),_0xa36f[_0x1e3ab7(0x236)]('back');const _0x42a8ec=await warehouse[_0x1e3ab7(0x26e)]({'name':_0x4c6ec7[_0x1e3ab7(0x223)],'room':_0x4c6ec7[_0x1e3ab7(0x231)]});_0x4c6ec7[_0x1e3ab7(0x288)][_0x1e3ab7(0x214)](_0xd5ba98=>{var _0x346ae6=_0x1e3ab7;if(_0xd5ba98['to_quantity']>0x0){const _0x3f5c0b=_0x42a8ec['product_details'][_0x346ae6(0x244)](_0x17b66f=>{var _0x1a2014=_0x346ae6;_0x17b66f[_0x1a2014(0x226)]==_0xd5ba98[_0x1a2014(0x226)]&&_0x17b66f['bay']==_0xd5ba98[_0x1a2014(0x248)]&&(_0x17b66f[_0x1a2014(0x27b)]=parseInt(_0x17b66f[_0x1a2014(0x27b)])+parseInt(_0xd5ba98[_0x1a2014(0x1e5)]));});}}),await _0x42a8ec['save']();const _0x57023d=await warehouse['findOne']({'name':_0x4c6ec7[_0x1e3ab7(0x24e)],'room':_0x4c6ec7[_0x1e3ab7(0x269)]});_0x4c6ec7[_0x1e3ab7(0x288)]['forEach'](_0x3b0f0a=>{var _0x241c7f=_0x1e3ab7;if(_0x3b0f0a[_0x241c7f(0x1e5)]>0x0){const _0x54f4e0=_0x57023d[_0x241c7f(0x26c)][_0x241c7f(0x244)](_0x327629=>{var _0xea6e30=_0x241c7f;_0x327629[_0xea6e30(0x226)]==_0x3b0f0a[_0xea6e30(0x226)]&&_0x327629[_0xea6e30(0x1fc)]==_0x3b0f0a['to_bay']&&(_0x327629[_0xea6e30(0x27b)]=parseInt(_0x327629[_0xea6e30(0x27b)])-parseInt(_0x3b0f0a[_0xea6e30(0x1e5)]));});}}),await _0x57023d['save'](),_0x4c6ec7[_0x1e3ab7(0x233)]=_0x3d5883,_0x4c6ec7['from_warehouse']=_0x392df8,_0x4c6ec7[_0x1e3ab7(0x24e)]=_0xffc09d,_0x4c6ec7['product']=_0x2c743e,_0x4c6ec7['note']=_0x2266d8,_0x4c6ec7[_0x1e3ab7(0x257)]=_0x4e1c7e;const _0x2dc1b7=await _0x4c6ec7[_0x1e3ab7(0x297)](),_0xf7207d=await warehouse[_0x1e3ab7(0x26e)]({'name':_0x392df8,'room':_0xff63dc});_0x2dc1b7[_0x1e3ab7(0x288)][_0x1e3ab7(0x214)](_0x1b3508=>{var _0x55b6e6=_0x1e3ab7;if(_0x1b3508[_0x55b6e6(0x1e5)]>0x0){const _0x24f03f=_0xf7207d['product_details'][_0x55b6e6(0x244)](_0x298858=>{var _0x52dcfe=_0x55b6e6;_0x298858['product_name']==_0x1b3508[_0x52dcfe(0x226)]&&_0x298858[_0x52dcfe(0x1fc)]==_0x1b3508[_0x52dcfe(0x248)]&&(_0x298858[_0x52dcfe(0x27b)]=parseInt(_0x298858[_0x52dcfe(0x27b)])-parseInt(_0x1b3508[_0x52dcfe(0x1e5)]));});}}),await _0xf7207d['save']();const _0x5ec112=await warehouse[_0x1e3ab7(0x26e)]({'name':_0xffc09d,'room':_0x2e1f32});_0x2dc1b7[_0x1e3ab7(0x288)][_0x1e3ab7(0x214)](_0x456900=>{var _0x8c852a=_0x1e3ab7;if(_0x456900[_0x8c852a(0x1e5)]>0x0){var _0x19fd9f=0x0;const _0x1d8063=_0x5ec112[_0x8c852a(0x26c)][_0x8c852a(0x244)](_0x22c8c9=>{var _0x298b69=_0x8c852a;_0x22c8c9[_0x298b69(0x226)]==_0x456900[_0x298b69(0x226)]&&_0x22c8c9[_0x298b69(0x1fc)]==_0x456900[_0x298b69(0x218)]&&(_0x22c8c9[_0x298b69(0x27b)]=parseInt(_0x22c8c9['product_stock'])+parseInt(_0x456900['to_quantity']),_0x19fd9f++);});_0x19fd9f=='0'&&(_0x5ec112[_0x8c852a(0x26c)]=_0x5ec112[_0x8c852a(0x26c)][_0x8c852a(0x20a)]({'product_name':_0x456900['product_name'],'product_stock':_0x456900[_0x8c852a(0x1e5)],'bay':_0x456900[_0x8c852a(0x218)],'product_code':_0x456900[_0x8c852a(0x1fd)],'primary_code':_0x456900[_0x8c852a(0x219)],'secondary_code':_0x456900[_0x8c852a(0x20f)],'maxProducts':_0x456900['maxProducts']}));}}),await _0x5ec112['save'](),_0x1e6ef3[_0x1e3ab7(0x27d)](_0x1e3ab7(0x1f2),_0x1e3ab7(0x287)),_0xa36f[_0x1e3ab7(0x236)]('/transfer_finished/view');}catch(_0x535db8){console['log'](_0x535db8);}}),router[a0_0x48036d(0x23b)](a0_0x48036d(0x1f9),async(_0x581dde,_0x340dac)=>{var _0x42e9d8=a0_0x48036d;const {FromWareHouse:_0x4b7534,FromRoom:_0x728068,ToWarehouse:_0x3c216d,ToRoom:_0x498756,primary_code:_0x314a32,Roomslist:_0x4aaa3f}=_0x581dde[_0x42e9d8(0x239)],_0x3cee26=_0x4aaa3f[_0x42e9d8(0x245)](','),_0x2b2b81=[];async function _0x3c806d(_0x259a18){var _0x2f7ec8=_0x42e9d8;const _0x39ec16=await warehouse[_0x2f7ec8(0x283)]([{'$match':{'name':_0x4b7534,'room':_0x259a18}},{'$unwind':_0x2f7ec8(0x24c)},{'$match':{'product_details.primary_code':_0x314a32}},{'$group':{'_id':_0x2f7ec8(0x273),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x2f7ec8(0x200)},'primary_code':{'$first':_0x2f7ec8(0x274)},'secondary_code':{'$first':_0x2f7ec8(0x1e3)},'product_code':{'$first':_0x2f7ec8(0x22e)},'bay':{'$first':_0x2f7ec8(0x26b)},'level':{'$first':_0x2f7ec8(0x23c)},'type':{'$first':_0x2f7ec8(0x292)},'pallet':{'$first':_0x2f7ec8(0x1dc)},'unit':{'$first':_0x2f7ec8(0x1f8)},'secondary_unit':{'$first':_0x2f7ec8(0x21c)},'storage':{'$first':_0x2f7ec8(0x1df)},'rack':{'$first':_0x2f7ec8(0x1e1)},'expiry_date':{'$first':_0x2f7ec8(0x204)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x2f7ec8(0x230)},'roomNamed':{'$first':_0x2f7ec8(0x21f)},'prod_cat':{'$first':'P'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x182c73=await warehouse[_0x2f7ec8(0x283)]([{'$match':{'name':_0x4b7534,'room':_0x259a18}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x314a32}},{'$group':{'_id':_0x2f7ec8(0x273),'name':{'$first':_0x2f7ec8(0x241)},'instock':{'$first':_0x2f7ec8(0x200)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2f7ec8(0x1e3)},'product_code':{'$first':_0x2f7ec8(0x22e)},'bay':{'$first':'$product_details.bay'},'level':{'$first':'$product_details.level'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2f7ec8(0x1f8)},'secondary_unit':{'$first':_0x2f7ec8(0x21c)},'storage':{'$first':_0x2f7ec8(0x1df)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2f7ec8(0x204)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2f7ec8(0x290)},'maxPerUnit':{'$first':_0x2f7ec8(0x230)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x2f7ec8(0x1ff)}}}]);if(_0x39ec16[_0x2f7ec8(0x22c)]>0x0)_0x2b2b81[_0x2f7ec8(0x229)](_0x39ec16);else _0x182c73[_0x2f7ec8(0x22c)]>0x0&&_0x2b2b81[_0x2f7ec8(0x229)](_0x182c73);}const _0x8836c7=_0x3cee26['map'](_0x1765f9=>_0x3c806d(_0x1765f9));await Promise['all'](_0x8836c7),_0x340dac[_0x42e9d8(0x25f)](_0x2b2b81);}),router[a0_0x48036d(0x23b)]('/CheckingWarehouse',async(_0x2fe986,_0x2a0d79)=>{var _0x92c995=a0_0x48036d;const {productCode:_0x54104c,bay:_0x2a90a8,warehouses:_0x494f84,room:_0x5c0f83}=_0x2fe986[_0x92c995(0x239)];console[_0x92c995(0x1f6)](_0x2fe986['body']);try{const _0x2cd1ec=await warehouse[_0x92c995(0x283)]([{'$match':{'name':_0x494f84,'room':_0x5c0f83}},{'$unwind':_0x92c995(0x24c)},{'$match':{'product_details.bay':parseInt(_0x2a90a8)}},{'$group':{'_id':_0x92c995(0x273),'name':{'$first':_0x92c995(0x241)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x92c995(0x26b)},'maxProducts':{'$first':_0x92c995(0x29b)}}}]);_0x2a0d79[_0x92c995(0x266)](0xc8)[_0x92c995(0x25f)](_0x2cd1ec);}catch(_0x12bd19){_0x2a0d79[_0x92c995(0x266)](0x194)['json']({'message':_0x12bd19['message']});}}),module['exports']=router;