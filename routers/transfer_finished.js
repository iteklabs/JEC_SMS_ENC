var a0_0x7fa587=a0_0x2713;(function(_0x394143,_0x37762d){var _0x15ba48=a0_0x2713,_0x3f668e=_0x394143();while(!![]){try{var _0x3dbae6=parseInt(_0x15ba48(0x18e))/0x1+-parseInt(_0x15ba48(0x208))/0x2+parseInt(_0x15ba48(0x178))/0x3*(-parseInt(_0x15ba48(0x14e))/0x4)+parseInt(_0x15ba48(0x1b5))/0x5*(-parseInt(_0x15ba48(0x146))/0x6)+-parseInt(_0x15ba48(0x1d0))/0x7+-parseInt(_0x15ba48(0x19b))/0x8+parseInt(_0x15ba48(0x153))/0x9;if(_0x3dbae6===_0x37762d)break;else _0x3f668e['push'](_0x3f668e['shift']());}catch(_0xda7a18){_0x3f668e['push'](_0x3f668e['shift']());}}}(a0_0x1cc7,0x584bb));const express=require('express'),app=express(),router=express[a0_0x7fa587(0x1de)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x7fa587(0x1bd)),auth=require(a0_0x7fa587(0x15d)),users=require(a0_0x7fa587(0x1a6)),nodemailer=require('nodemailer');function a0_0x2713(_0x1d1c0d,_0x295b2e){var _0x1cc7ca=a0_0x1cc7();return a0_0x2713=function(_0x271378,_0x34f4a2){_0x271378=_0x271378-0x146;var _0x203dac=_0x1cc7ca[_0x271378];return _0x203dac;},a0_0x2713(_0x1d1c0d,_0x295b2e);}function a0_0x1cc7(){var _0x5d2324=['forEach','product_stock','invoice_init','Hindi','from_level','type_of_process','$to_warehouse','/preview/:id','toString','bin2bin','getFullYear','$product_details.bin','\x20<>\x20','$product_details.production_date','to_room','floor','TRFF-','/transfer_finished/preview/','An\x20error\x20occurred\x20while\x20saving\x20data.','back','finalize','/view/add_transfer','$product_details','DRY\x20GOODS','then','/view/:id','$product.to_room_name','$product_details.bay','Rack\x202','status','ToRoomAssigned','batch_code','prod_cat','$date','Transfer\x20Edit\x20Successfully','email','English\x20(US)','1278668sjoMtV','primary_code','97782rVAhxr','from_bay','Arabic\x20(ae)','/transfer/view','True','Product\x20Transfer\x20successfully','user','Portuguese','573572loblHM','length','Ambient','Finished\x20Goods','padStart','13571118njfKeL','message','string','<tr>','Portuguese\x20(BR)','to_quantity','to_bay','prod_name','/view/addlog','$product_details.product_stock','../middleware/auth','to_prod_level','_id','slice','errors','from_room_name','error','$product_details.storage','params','findById','transfer_finished_logs','from_invoice','edit_transfer_finished_view','MaxStocks_data','To_invoice','$product_details.floorlevel','</td>','$product_details.maxPerUnit','from_prod_qty','Spanish','invoice','all','product_date','$product_details.batch_code','secondary_code','/CheckingWarehouse','exports','6OiOOqc','/barcode_scanner','Arabic','getDate','Chinese','product','save','$product_details.secondary_code','concat','product_code3','staff','French','to_warehouse','to_room_name','$product_details.unit','$_id','/picking_list/PDF_transfer/','$product_details.invoice','find','role','maxProducts','$name','566286OQCXGq','to_prod_qty','primary_unit','English','There\x27s\x20a\x20error\x20in\x20this\x20transaction','catch','aggregate','$product','location2location','map','to_floorlevel','$product_details.expiry_date','New_Qty_Converted','253392fktidN','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Transfer\x20Finalize\x20Successfully','findOne','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','expiry_date','json','TRF-','logs','$room','../public/language/languages.json','$product_details.primary_code','match','$from_warehouse','production_date','$product_details.type','choos_transfer_logs','add_transfer_finished','product_details','from_prod_level','get','log','warehouse','maxPerUnit','from_warehouse','75lUDQOc','Rack\x201','filter','product_code','$product_details.secondary_unit','$finalize','transfer_finished','bay','../models/all_models','redirect','/view/choose','own','product_name','$product_details.product_name','$invoice','render','push','from_quantity','$product_details.rack','German','LOG-TRF-','MaxStocks_data2','Enabled','post','abs','from_prod_level2','secondary_unit','3571960BzzxcD','RoomAssigned','flash','$product_details.product_code','$product_details.maxProducts','An\x20error\x20occurred.','language','success','/view','$product_details._id','id_transaction','split','transfer_data','note','Router','/view/add_transfer_logs','unit','body','to_level'];a0_0x1cc7=function(){return _0x5d2324;};return a0_0x1cc7();}router[a0_0x7fa587(0x1b0)](a0_0x7fa587(0x1d8),auth,async(_0x379d1d,_0x172751)=>{var _0x4339ec=a0_0x7fa587;try{const {username:_0x8b4e36,email:_0x217042,role:_0x21e664}=_0x379d1d[_0x4339ec(0x14c)],_0x2f862f=_0x379d1d['user'],_0x395d29=await profile[_0x4339ec(0x19e)]({'email':_0x2f862f[_0x4339ec(0x206)]}),_0x36cb17=await master_shop[_0x4339ec(0x18a)]();let _0x195dd6;if(_0x2f862f[_0x4339ec(0x18b)]=='staff'){const _0x3bf2f1=await staff[_0x4339ec(0x19e)]({'email':_0x2f862f[_0x4339ec(0x206)]});_0x195dd6=await transfers_finished['find']({'from_warehouse':_0x3bf2f1['warehouse']});}else _0x195dd6=await transfers_finished[_0x4339ec(0x194)]([{'$match':{'type_of_transaction':_0x4339ec(0x1c0)}},{'$unwind':_0x4339ec(0x195)},{'$group':{'_id':_0x4339ec(0x187),'invoice':{'$first':_0x4339ec(0x1c3)},'date':{'$first':_0x4339ec(0x204)},'from_warehouse':{'$first':_0x4339ec(0x1a9)},'to_warehouse':{'$first':_0x4339ec(0x1e9)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x4339ec(0x1fd)},'finalize':{'$first':_0x4339ec(0x1ba)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x36cb17[0x0][_0x4339ec(0x1d6)]==_0x4339ec(0x207))var _0x2a8103=users[_0x4339ec(0x191)];else{if(_0x36cb17[0x0]['language']==_0x4339ec(0x1e6))var _0x2a8103=users[_0x4339ec(0x1e6)];else{if(_0x36cb17[0x0]['language']==_0x4339ec(0x1c8))var _0x2a8103=users[_0x4339ec(0x1c8)];else{if(_0x36cb17[0x0]['language']=='Spanish')var _0x2a8103=users[_0x4339ec(0x170)];else{if(_0x36cb17[0x0][_0x4339ec(0x1d6)]==_0x4339ec(0x183))var _0x2a8103=users[_0x4339ec(0x183)];else{if(_0x36cb17[0x0][_0x4339ec(0x1d6)]==_0x4339ec(0x157))var _0x2a8103=users['Portuguese'];else{if(_0x36cb17[0x0][_0x4339ec(0x1d6)]==_0x4339ec(0x17c))var _0x2a8103=users[_0x4339ec(0x17c)];else{if(_0x36cb17[0x0][_0x4339ec(0x1d6)]==_0x4339ec(0x148))var _0x2a8103=users[_0x4339ec(0x17a)];}}}}}}}_0x172751[_0x4339ec(0x1c4)](_0x4339ec(0x1bb),{'success':_0x379d1d[_0x4339ec(0x1d2)](_0x4339ec(0x1d7)),'errors':_0x379d1d[_0x4339ec(0x1d2)](_0x4339ec(0x161)),'role':_0x2f862f,'profile':_0x395d29,'master_shop':_0x36cb17,'transfer':_0x195dd6,'language':_0x2a8103});}catch(_0x96c41e){console['log'](_0x96c41e);}}),router['get']('/view_logs',auth,async(_0x97aff7,_0x504d8d)=>{var _0x15cda6=a0_0x7fa587;try{const {username:_0x239996,email:_0xabe4f9,role:_0x48f09c}=_0x97aff7[_0x15cda6(0x14c)],_0x50dbc1=_0x97aff7['user'],_0x397a46=await profile[_0x15cda6(0x19e)]({'email':_0x50dbc1['email']}),_0x4fc5cc=await master_shop[_0x15cda6(0x18a)]();let _0x36c02a;if(_0x50dbc1[_0x15cda6(0x18b)]==_0x15cda6(0x182)){const _0x4fe853=await staff['findOne']({'email':_0x50dbc1[_0x15cda6(0x206)]});_0x36c02a=await transfers_finished[_0x15cda6(0x18a)]({'from_warehouse':_0x4fe853[_0x15cda6(0x1b2)]});}else _0x36c02a=await transfers_finished[_0x15cda6(0x194)]([{'$match':{'type_of_transaction':'logs'}},{'$unwind':'$product'},{'$group':{'_id':_0x15cda6(0x187),'invoice':{'$first':_0x15cda6(0x1c3)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x15cda6(0x1a9)},'to_warehouse':{'$first':_0x15cda6(0x1e9)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x15cda6(0x1fd)},'finalize':{'$first':_0x15cda6(0x1ba)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x4fc5cc[0x0][_0x15cda6(0x1d6)]=='English\x20(US)')var _0x4796c7=users[_0x15cda6(0x191)];else{if(_0x4fc5cc[0x0][_0x15cda6(0x1d6)]==_0x15cda6(0x1e6))var _0x4796c7=users['Hindi'];else{if(_0x4fc5cc[0x0]['language']==_0x15cda6(0x1c8))var _0x4796c7=users['German'];else{if(_0x4fc5cc[0x0][_0x15cda6(0x1d6)]==_0x15cda6(0x170))var _0x4796c7=users[_0x15cda6(0x170)];else{if(_0x4fc5cc[0x0]['language']==_0x15cda6(0x183))var _0x4796c7=users[_0x15cda6(0x183)];else{if(_0x4fc5cc[0x0][_0x15cda6(0x1d6)]==_0x15cda6(0x157))var _0x4796c7=users['Portuguese'];else{if(_0x4fc5cc[0x0]['language']==_0x15cda6(0x17c))var _0x4796c7=users[_0x15cda6(0x17c)];else{if(_0x4fc5cc[0x0]['language']==_0x15cda6(0x148))var _0x4796c7=users['Arabic'];}}}}}}}_0x504d8d['render'](_0x15cda6(0x167),{'success':_0x97aff7[_0x15cda6(0x1d2)](_0x15cda6(0x1d7)),'errors':_0x97aff7[_0x15cda6(0x1d2)]('errors'),'role':_0x50dbc1,'profile':_0x397a46,'master_shop':_0x4fc5cc,'transfer':_0x36c02a,'language':_0x4796c7});}catch(_0x50476a){console[_0x15cda6(0x1b1)](_0x50476a);}});async function getRandom8DigitNumber(){var _0x37d718=a0_0x7fa587;const _0x3b1168=0x989680,_0x157771=0x5f5e0ff,_0x5cf4d1=Math[_0x37d718(0x1f2)](Math['random']()*(_0x157771-_0x3b1168+0x1))+_0x3b1168;var _0x517acf;const _0x3badbc=await transfers_finished['findOne']({'invoice':_0x37d718(0x1f3)+_0x5cf4d1});return _0x3badbc&&_0x3badbc['length']>0x0?_0x517acf=_0x37d718(0x1f3)+_0x5cf4d1:_0x517acf=_0x37d718(0x1f3)+_0x5cf4d1,_0x517acf;}router[a0_0x7fa587(0x1b0)](a0_0x7fa587(0x1f8),auth,async(_0x1e279f,_0x521a24)=>{var _0x1388f1=a0_0x7fa587;try{const {username:_0x291505,email:_0xb168d6,role:_0x5e4dfb}=_0x1e279f[_0x1388f1(0x14c)],_0x172fc3=_0x1e279f[_0x1388f1(0x14c)],_0x803426=await profile['findOne']({'email':_0x172fc3[_0x1388f1(0x206)]}),_0x5d3f71=await master_shop[_0x1388f1(0x18a)]();let _0x5ecd9b;if(_0x172fc3[_0x1388f1(0x18b)]==_0x1388f1(0x182)){const _0x5ed3ed=await staff[_0x1388f1(0x19e)]({'email':_0x172fc3[_0x1388f1(0x206)]});_0x5ecd9b=await warehouse['aggregate']([{'$match':{'status':_0x1388f1(0x1cb),'name':_0x5ed3ed[_0x1388f1(0x1b2)]}},{'$group':{'_id':_0x1388f1(0x18d),'name':{'$first':_0x1388f1(0x18d)}}}]);}else _0x5ecd9b=await warehouse[_0x1388f1(0x194)]([{'$match':{'status':_0x1388f1(0x1cb)}},{'$group':{'_id':'$name','name':{'$first':_0x1388f1(0x18d)}}}]);const _0x5714f9=await transfers_finished['find']({}),_0x3b953b=_0x5714f9[_0x1388f1(0x14f)]+0x1,_0x43ae60=_0x1388f1(0x1f3)+_0x3b953b[_0x1388f1(0x1eb)]()[_0x1388f1(0x152)](0x5,'0');if(_0x5d3f71[0x0][_0x1388f1(0x1d6)]==_0x1388f1(0x207))var _0x5217ea=users[_0x1388f1(0x191)];else{if(_0x5d3f71[0x0][_0x1388f1(0x1d6)]==_0x1388f1(0x1e6))var _0x5217ea=users[_0x1388f1(0x1e6)];else{if(_0x5d3f71[0x0][_0x1388f1(0x1d6)]==_0x1388f1(0x1c8))var _0x5217ea=users[_0x1388f1(0x1c8)];else{if(_0x5d3f71[0x0]['language']==_0x1388f1(0x170))var _0x5217ea=users[_0x1388f1(0x170)];else{if(_0x5d3f71[0x0][_0x1388f1(0x1d6)]=='French')var _0x5217ea=users[_0x1388f1(0x183)];else{if(_0x5d3f71[0x0][_0x1388f1(0x1d6)]==_0x1388f1(0x157))var _0x5217ea=users[_0x1388f1(0x14d)];else{if(_0x5d3f71[0x0][_0x1388f1(0x1d6)]==_0x1388f1(0x17c))var _0x5217ea=users['Chinese'];else{if(_0x5d3f71[0x0][_0x1388f1(0x1d6)]=='Arabic\x20(ae)')var _0x5217ea=users[_0x1388f1(0x17a)];}}}}}}}const _0x2a6cdb=getRandom8DigitNumber();_0x2a6cdb[_0x1388f1(0x1fb)](_0x1bad38=>{var _0x927afc=_0x1388f1;_0x521a24[_0x927afc(0x1c4)](_0x927afc(0x1ad),{'success':_0x1e279f[_0x927afc(0x1d2)](_0x927afc(0x1d7)),'errors':_0x1e279f[_0x927afc(0x1d2)](_0x927afc(0x161)),'role':_0x172fc3,'profile':_0x803426,'master_shop':_0x5d3f71,'warehouse':_0x5ecd9b,'language':_0x5217ea,'invoice':_0x1bad38});})[_0x1388f1(0x193)](_0x16fe61=>{var _0xfb9016=_0x1388f1;_0x1e279f['flash'](_0xfb9016(0x161),_0xfb9016(0x192)),_0x521a24['redirect'](_0xfb9016(0x149));});}catch(_0x427d40){console['log'](_0x427d40);}}),router[a0_0x7fa587(0x1b0)](a0_0x7fa587(0x1bf),auth,async(_0x55a9cc,_0x582898)=>{var _0x364ad6=a0_0x7fa587;try{const {username:_0x6db736,email:_0x56594f,role:_0x30a95f}=_0x55a9cc['user'],_0x4298ef=_0x55a9cc['user'],_0x1b0ba3=await profile['findOne']({'email':_0x4298ef[_0x364ad6(0x206)]}),_0x4f2a85=await master_shop[_0x364ad6(0x18a)]();let _0x5a85dc;if(_0x4298ef[_0x364ad6(0x18b)]==_0x364ad6(0x182)){const _0x1e2c66=await staff['findOne']({'email':_0x4298ef[_0x364ad6(0x206)]});_0x5a85dc=await warehouse['aggregate']([{'$match':{'status':_0x364ad6(0x1cb),'name':_0x1e2c66[_0x364ad6(0x1b2)]}},{'$group':{'_id':'$name','name':{'$first':_0x364ad6(0x18d)}}}]);}else _0x5a85dc=await warehouse[_0x364ad6(0x194)]([{'$match':{'status':_0x364ad6(0x1cb)}},{'$group':{'_id':'$name','name':{'$first':_0x364ad6(0x18d)}}}]);const _0x5e9a89=await transfers_finished[_0x364ad6(0x18a)]({}),_0xaebfeb=_0x5e9a89[_0x364ad6(0x14f)]+0x1,_0x4681fd=_0x364ad6(0x1f3)+_0xaebfeb[_0x364ad6(0x1eb)]()[_0x364ad6(0x152)](0x5,'0');if(_0x4f2a85[0x0][_0x364ad6(0x1d6)]==_0x364ad6(0x207))var _0x44ac40=users['English'];else{if(_0x4f2a85[0x0][_0x364ad6(0x1d6)]==_0x364ad6(0x1e6))var _0x44ac40=users[_0x364ad6(0x1e6)];else{if(_0x4f2a85[0x0][_0x364ad6(0x1d6)]==_0x364ad6(0x1c8))var _0x44ac40=users[_0x364ad6(0x1c8)];else{if(_0x4f2a85[0x0][_0x364ad6(0x1d6)]==_0x364ad6(0x170))var _0x44ac40=users[_0x364ad6(0x170)];else{if(_0x4f2a85[0x0]['language']==_0x364ad6(0x183))var _0x44ac40=users[_0x364ad6(0x183)];else{if(_0x4f2a85[0x0][_0x364ad6(0x1d6)]==_0x364ad6(0x157))var _0x44ac40=users['Portuguese'];else{if(_0x4f2a85[0x0][_0x364ad6(0x1d6)]==_0x364ad6(0x17c))var _0x44ac40=users[_0x364ad6(0x17c)];else{if(_0x4f2a85[0x0][_0x364ad6(0x1d6)]==_0x364ad6(0x148))var _0x44ac40=users['Arabic'];}}}}}}}const _0x4097b5=getRandom8DigitNumber();_0x4097b5[_0x364ad6(0x1fb)](_0x3da8e2=>{var _0x3d1613=_0x364ad6;_0x582898['render']('choos_transfer',{'success':_0x55a9cc[_0x3d1613(0x1d2)]('success'),'errors':_0x55a9cc[_0x3d1613(0x1d2)](_0x3d1613(0x161)),'role':_0x4298ef,'profile':_0x1b0ba3,'master_shop':_0x4f2a85,'warehouse':_0x5a85dc,'language':_0x44ac40,'invoice':_0x3da8e2});})['catch'](_0x5ea784=>{var _0x8ff681=_0x364ad6;_0x55a9cc[_0x8ff681(0x1d2)]('errors',_0x8ff681(0x192)),_0x582898[_0x8ff681(0x1be)](_0x8ff681(0x149));});}catch(_0x4f6f13){console['log'](_0x4f6f13);}}),router[a0_0x7fa587(0x1b0)]('/view/choose_logs',auth,async(_0x4e574a,_0x512f03)=>{var _0xa714b0=a0_0x7fa587;try{const {username:_0x2e176a,email:_0xea9aa2,role:_0x13c91c}=_0x4e574a[_0xa714b0(0x14c)],_0x5aa478=_0x4e574a[_0xa714b0(0x14c)],_0x457b25=await profile['findOne']({'email':_0x5aa478[_0xa714b0(0x206)]}),_0x182e48=await master_shop[_0xa714b0(0x18a)]();let _0xb3dbdd;if(_0x5aa478[_0xa714b0(0x18b)]==_0xa714b0(0x182)){const _0x1945a6=await staff[_0xa714b0(0x19e)]({'email':_0x5aa478['email']});_0xb3dbdd=await warehouse[_0xa714b0(0x194)]([{'$match':{'status':'Enabled','name':_0x1945a6[_0xa714b0(0x1b2)]}},{'$group':{'_id':_0xa714b0(0x18d),'name':{'$first':_0xa714b0(0x18d)}}}]);}else _0xb3dbdd=await warehouse[_0xa714b0(0x194)]([{'$match':{'status':_0xa714b0(0x1cb)}},{'$group':{'_id':_0xa714b0(0x18d),'name':{'$first':_0xa714b0(0x18d)}}}]);const _0x41d3a0=await transfers_finished[_0xa714b0(0x18a)]({}),_0x43758e=_0x41d3a0[_0xa714b0(0x14f)]+0x1,_0x2f5794=_0xa714b0(0x1f3)+_0x43758e[_0xa714b0(0x1eb)]()['padStart'](0x5,'0');if(_0x182e48[0x0]['language']==_0xa714b0(0x207))var _0x485cdf=users[_0xa714b0(0x191)];else{if(_0x182e48[0x0][_0xa714b0(0x1d6)]==_0xa714b0(0x1e6))var _0x485cdf=users[_0xa714b0(0x1e6)];else{if(_0x182e48[0x0][_0xa714b0(0x1d6)]==_0xa714b0(0x1c8))var _0x485cdf=users[_0xa714b0(0x1c8)];else{if(_0x182e48[0x0][_0xa714b0(0x1d6)]==_0xa714b0(0x170))var _0x485cdf=users['Spanish'];else{if(_0x182e48[0x0][_0xa714b0(0x1d6)]==_0xa714b0(0x183))var _0x485cdf=users[_0xa714b0(0x183)];else{if(_0x182e48[0x0]['language']=='Portuguese\x20(BR)')var _0x485cdf=users['Portuguese'];else{if(_0x182e48[0x0][_0xa714b0(0x1d6)]=='Chinese')var _0x485cdf=users['Chinese'];else{if(_0x182e48[0x0][_0xa714b0(0x1d6)]==_0xa714b0(0x148))var _0x485cdf=users[_0xa714b0(0x17a)];}}}}}}}const _0x22aaa2=getRandom8DigitNumber();_0x22aaa2['then'](_0x3d12a1=>{var _0x352473=_0xa714b0;_0x512f03['render'](_0x352473(0x1ac),{'success':_0x4e574a['flash'](_0x352473(0x1d7)),'errors':_0x4e574a[_0x352473(0x1d2)]('errors'),'role':_0x5aa478,'profile':_0x457b25,'master_shop':_0x182e48,'warehouse':_0xb3dbdd,'language':_0x485cdf,'invoice':_0x3d12a1});})[_0xa714b0(0x193)](_0x4e2376=>{var _0x1830a6=_0xa714b0;_0x4e574a[_0x1830a6(0x1d2)](_0x1830a6(0x161),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x512f03[_0x1830a6(0x1be)]('/transfer/view');});}catch(_0x2048e3){console[_0xa714b0(0x1b1)](_0x2048e3);}}),router[a0_0x7fa587(0x1cc)](a0_0x7fa587(0x1df),auth,async(_0x30e773,_0x1cd2a3)=>{var _0x5114db=a0_0x7fa587;try{const {date:_0x14f74f,from_warehouse:_0x427ccf,FromRoom_name:_0x407186,to_warehouse:_0x48acc2,ToRoom_name:_0x4f5416,prod_name:_0x5113e0,from_prod_qty:_0xd009b,from_prod_level:_0x95553,from_prod_isle:_0x4b09fc,from_prod_pallet:_0x3fbf1d,to_prod_qty:_0x2a53fe,to_prod_level:_0x332a11,to_prod_isle:_0xd68c79,to_prod_pallet:_0x8ebae4,primary_code:_0x580c05,secondary_code:_0x5f1f38,product_code3:_0x4d3f4f,note:_0x53fd9a,MaxStocks_data2:_0x28ee26,invoice:_0x3e47e5,expiry_date:_0x2711ce,PO_number:_0x65670,ReqBy:_0x53f04c,dateofreq:_0x19d394,typeservicesData:_0x5aa84c,destination:_0x1eef62,deliverydate:_0x3e08b1,driver:_0x54c918,plate:_0x4719fb,van:_0x4aa2bb,DRSI:_0x2ec00b,typevehicle:_0x494ea3,TSU:_0x2cffd7,TFU:_0x4be157}=_0x30e773[_0x5114db(0x1e1)];if(typeof _0x5113e0==_0x5114db(0x155))var _0x225e56=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x15a)]],_0x17080b=[_0x30e773['body']['from_prod_qty']],_0x3b12ec=[_0x30e773[_0x5114db(0x1e1)]['from_prod_level2']],_0x3a661e=[_0x30e773[_0x5114db(0x1e1)]['New_Qty_Converted']],_0x36d616=[_0x30e773[_0x5114db(0x1e1)]['to_prod_level']],_0x37c9e0=[_0x30e773['body'][_0x5114db(0x209)]],_0x2dd52e=[_0x30e773['body'][_0x5114db(0x175)]],_0x1f9d4e=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x181)]],_0x40fa2f=[_0x30e773['body'][_0x5114db(0x1ca)]],_0x1c8d6b=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x190)]],_0x520d0c=[_0x30e773['body'][_0x5114db(0x1cf)]],_0x226d21=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x202)]],_0x80caaf=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x1a1)]],_0x52ffa8=[_0x30e773[_0x5114db(0x1e1)]['product_date']],_0x283bfa=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x16a)]],_0x3956b7=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x1b3)]],_0x4f9a3d=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x203)]],_0x84a0bb=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x1d1)]],_0x4a0359=[_0x30e773['body']['ToRoomAssigned']],_0x5582fc=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x168)]],_0x44501c=[_0x30e773[_0x5114db(0x1e1)][_0x5114db(0x1da)]];else var _0x225e56=[..._0x30e773['body'][_0x5114db(0x15a)]],_0x17080b=[..._0x30e773[_0x5114db(0x1e1)]['from_prod_qty']],_0x3b12ec=[..._0x30e773[_0x5114db(0x1e1)]['from_prod_level2']],_0x3a661e=[..._0x30e773[_0x5114db(0x1e1)][_0x5114db(0x19a)]],_0x36d616=[..._0x30e773['body']['to_prod_level']],_0x37c9e0=[..._0x30e773[_0x5114db(0x1e1)][_0x5114db(0x209)]],_0x2dd52e=[..._0x30e773['body']['secondary_code']],_0x1f9d4e=[..._0x30e773['body'][_0x5114db(0x181)]],_0x40fa2f=[..._0x30e773['body'][_0x5114db(0x1ca)]],_0x1c8d6b=[..._0x30e773['body'][_0x5114db(0x190)]],_0x520d0c=[..._0x30e773[_0x5114db(0x1e1)][_0x5114db(0x1cf)]],_0x226d21=[..._0x30e773[_0x5114db(0x1e1)]['batch_code']],_0x80caaf=[..._0x30e773['body'][_0x5114db(0x1a1)]],_0x52ffa8=[..._0x30e773[_0x5114db(0x1e1)][_0x5114db(0x173)]],_0x283bfa=[..._0x30e773[_0x5114db(0x1e1)][_0x5114db(0x16a)]],_0x3956b7=[..._0x30e773['body'][_0x5114db(0x1b3)]],_0x4f9a3d=[..._0x30e773[_0x5114db(0x1e1)]['prod_cat']],_0x84a0bb=[..._0x30e773[_0x5114db(0x1e1)][_0x5114db(0x1d1)]],_0x4a0359=[..._0x30e773['body']['ToRoomAssigned']],_0x5582fc=[..._0x30e773['body'][_0x5114db(0x168)]],_0x44501c=[..._0x30e773['body'][_0x5114db(0x1da)]];const _0xdcd1cc=_0x225e56[_0x5114db(0x197)](_0x38918d=>{return _0x38918d={'product_name':_0x38918d};});_0x17080b[_0x5114db(0x1e3)]((_0x43b19f,_0x30992d)=>{var _0x23bae0=_0x5114db;_0xdcd1cc[_0x30992d][_0x23bae0(0x1c6)]=_0x43b19f;}),_0x3b12ec[_0x5114db(0x1e3)]((_0xc5f582,_0xee5a16)=>{var _0x4ad672=_0x5114db,_0x4b7ee8=_0xc5f582[_0x4ad672(0x1a8)](/[A-Za-z]+/)[0x0],_0x219384=parseInt(_0xc5f582[_0x4ad672(0x1a8)](/\d+/)[0x0]);_0xdcd1cc[_0xee5a16][_0x4ad672(0x147)]=_0x219384,_0xdcd1cc[_0xee5a16][_0x4ad672(0x1e7)]=_0x4b7ee8;}),_0x44501c[_0x5114db(0x1e3)]((_0x5908dc,_0x1ed6b9)=>{var _0x21990a=_0x5114db;_0xdcd1cc[_0x1ed6b9][_0x21990a(0x1da)]=_0x5908dc;}),_0x5582fc[_0x5114db(0x1e3)]((_0x5b6097,_0x7af2c)=>{var _0x3f2a6b=_0x5114db;_0xdcd1cc[_0x7af2c][_0x3f2a6b(0x168)]=_0x5b6097;}),_0x3a661e[_0x5114db(0x1e3)]((_0xae00e6,_0x2d0432)=>{var _0x1e7f43=_0x5114db;_0xdcd1cc[_0x2d0432][_0x1e7f43(0x158)]=_0xae00e6;}),_0x36d616[_0x5114db(0x1e3)]((_0x9360fe,_0x466837)=>{var _0x4cc2b0=_0x5114db,_0x5ce815=_0x9360fe[_0x4cc2b0(0x1a8)](/[A-Za-z]+/)[0x0],_0x3e9d31=parseInt(_0x9360fe['match'](/\d+/)[0x0]);_0xdcd1cc[_0x466837]['to_level']=_0x5ce815,_0xdcd1cc[_0x466837][_0x4cc2b0(0x159)]=_0x3e9d31;}),_0x37c9e0[_0x5114db(0x1e3)]((_0x110c9e,_0x3f38b1)=>{_0xdcd1cc[_0x3f38b1]['primary_code']=_0x110c9e;}),_0x2dd52e[_0x5114db(0x1e3)]((_0x5c980a,_0x14f743)=>{var _0x2bb639=_0x5114db;_0xdcd1cc[_0x14f743][_0x2bb639(0x175)]=_0x5c980a;}),_0x1f9d4e[_0x5114db(0x1e3)]((_0x1e4e34,_0x5490c8)=>{var _0x230034=_0x5114db;_0xdcd1cc[_0x5490c8][_0x230034(0x1b8)]=_0x1e4e34;}),_0x40fa2f[_0x5114db(0x1e3)]((_0x100beb,_0x5c5c5d)=>{var _0x31a445=_0x5114db;_0xdcd1cc[_0x5c5c5d][_0x31a445(0x18c)]=_0x100beb;}),_0x1c8d6b[_0x5114db(0x1e3)]((_0x3385ba,_0x568fc8)=>{_0xdcd1cc[_0x568fc8]['unit']=_0x3385ba;}),_0x520d0c[_0x5114db(0x1e3)]((_0x5844dd,_0x40abb5)=>{var _0x4d8e95=_0x5114db;_0xdcd1cc[_0x40abb5][_0x4d8e95(0x1cf)]=_0x5844dd;}),_0x226d21[_0x5114db(0x1e3)]((_0x5f4d13,_0x6d2d34)=>{_0xdcd1cc[_0x6d2d34]['batch_code']=_0x5f4d13;}),_0x80caaf['forEach']((_0x39611e,_0x1d49a2)=>{var _0x399412=_0x5114db;_0xdcd1cc[_0x1d49a2][_0x399412(0x1a1)]=_0x39611e;}),_0x52ffa8[_0x5114db(0x1e3)]((_0x15d32e,_0x24e034)=>{var _0x502980=_0x5114db;_0xdcd1cc[_0x24e034][_0x502980(0x1aa)]=_0x15d32e;}),_0x283bfa[_0x5114db(0x1e3)]((_0x17022d,_0x194241)=>{_0xdcd1cc[_0x194241]['maxProducts']=_0x17022d;}),_0x3956b7[_0x5114db(0x1e3)]((_0x2eca5c,_0x4da691)=>{var _0x20a3d1=_0x5114db;_0xdcd1cc[_0x4da691][_0x20a3d1(0x1b3)]=_0x2eca5c;}),_0x4f9a3d[_0x5114db(0x1e3)]((_0x295589,_0x3532ae)=>{_0xdcd1cc[_0x3532ae]['prod_cat']=_0x295589;}),_0x84a0bb[_0x5114db(0x1e3)]((_0x2edefb,_0x7139fb)=>{_0xdcd1cc[_0x7139fb]['from_room_name']=_0x2edefb;}),_0x4a0359[_0x5114db(0x1e3)]((_0x3b728e,_0xce24e)=>{_0xdcd1cc[_0xce24e]['to_room_name']=_0x3b728e;});const _0xdb21d2=_0xdcd1cc[_0x5114db(0x1b7)](_0x4de1fe=>_0x4de1fe[_0x5114db(0x158)]!=='0'&&_0x4de1fe[_0x5114db(0x158)]!==''||_0x4de1fe[_0x5114db(0x198)]!=='0'&&_0x4de1fe[_0x5114db(0x198)]!=='');var _0x335bc4=0x0;_0xdb21d2['forEach'](_0x4b0b0f=>{var _0x17a68b=_0x5114db;parseInt(_0x4b0b0f['from_quantity'])<parseInt(_0x4b0b0f[_0x17a68b(0x158)])&&_0x335bc4++;});if(_0x335bc4!=0x0)return _0x30e773[_0x5114db(0x1d2)](_0x5114db(0x161),_0x5114db(0x19c)),_0x1cd2a3[_0x5114db(0x1be)](_0x5114db(0x1f6));const _0x567da2=new transfers_logs();await _0x567da2[_0x5114db(0x17e)]();for(let _0x4c8fc0=0x0;_0x4c8fc0<=_0x4a0359[_0x5114db(0x14f)]-0x1;_0x4c8fc0++){_0xdcd1cc[_0x4c8fc0][_0x5114db(0x16b)]=_0x5114db(0x1c9)+_0x567da2['invoice_init']['toString']()['padStart'](0x8,'0');}const _0x24457a=new transfers_finished({'date':_0x14f74f,'from_warehouse':_0x427ccf,'to_warehouse':_0x427ccf,'product':_0xdb21d2,'note':_0x53fd9a,'invoice':'LOG-TRF-'+_0x567da2['invoice_init'][_0x5114db(0x1eb)]()[_0x5114db(0x152)](0x8,'0'),'type_of_process':_0x5114db(0x1ec),'type_of_transaction':'logs','PO_number':_0x65670,'RequestedBy':_0x53f04c,'DateofRequest':_0x19d394,'typeservices':_0x5aa84c,'destination':_0x1eef62,'deliverydate':_0x3e08b1,'driver':_0x54c918,'plate':_0x4719fb,'van':_0x4aa2bb,'DRSI':_0x2ec00b,'typevehicle':_0x494ea3,'TSU':_0x2cffd7,'TFU':_0x4be157}),_0x238e63=await _0x24457a[_0x5114db(0x17e)]();_0x30e773[_0x5114db(0x1d2)]('success',_0x5114db(0x14b)),_0x1cd2a3[_0x5114db(0x1be)](_0x5114db(0x1f4)+_0x238e63['_id']);}catch(_0x16727a){console[_0x5114db(0x1b1)](_0x16727a),_0x1cd2a3[_0x5114db(0x200)](0xc8)['json']({'errorMessage':_0x16727a[_0x5114db(0x154)]});}}),router[a0_0x7fa587(0x1cc)](a0_0x7fa587(0x15b),auth,async(_0x15a402,_0x317f2c)=>{var _0x281dec=a0_0x7fa587;try{const {date:_0x2e9981,from_warehouse:_0x30a603,FromRoom_name:_0x28b7b3,to_warehouse:_0x614b0c,ToRoom_name:_0x48c4fe,prod_name:_0x2da56a,from_prod_qty:_0x359bab,from_prod_level:_0x2937dd,from_prod_isle:_0x315bff,from_prod_pallet:_0x212ebb,to_prod_qty:_0x300382,to_prod_level:_0x5af171,to_prod_isle:_0x5c3f5b,to_prod_pallet:_0x2f0c86,primary_code:_0x217de6,secondary_code:_0x1df3a7,product_code3:_0x4069a8,note:_0x522f85,MaxStocks_data2:_0x59843c,invoice:_0x44f160,expiry_date:_0xfe2a8d,PO_number_loc:_0x37f4fe,ReqBy_loc:_0x555dec,dateofreq_loc:_0x7dfef5,typeservices_loc_Data:_0x2551b4,destination_loc:_0xfcd88c,deliverydate_loc:_0x9db25b,driver_loc:_0x59ae60,plate_loc:_0x261ead,van_loc:_0x19c695,DRSI_loc:_0x37461e,typevehicle_loc:_0x481443,TSU_loc:_0x3a2a0e,TFU_loc:_0x3f5b11}=_0x15a402[_0x281dec(0x1e1)];if(typeof _0x2da56a==_0x281dec(0x155))var _0x1624b5=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x15a)]],_0x490a40=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x16f)]],_0xe8753a=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x1ce)]],_0x50d2d8=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x19a)]],_0x4b6f4f=[_0x15a402['body']['to_prod_level']],_0x7dc8dc=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x209)]],_0x40e562=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x175)]],_0x5cb082=[_0x15a402[_0x281dec(0x1e1)]['product_code3']],_0x94c0c=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x1ca)]],_0x4ec8f8=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x190)]],_0x466d54=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x1cf)]],_0x4c72e8=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x202)]],_0x562fb7=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x1a1)]],_0x3aabcf=[_0x15a402[_0x281dec(0x1e1)]['product_date']],_0x416d01=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x16a)]],_0x1c61e9=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x1b3)]],_0x56bc70=[_0x15a402[_0x281dec(0x1e1)]['prod_cat']],_0x4a8b58=[_0x15a402['body'][_0x281dec(0x1d1)]],_0xbc9b4a=[_0x15a402['body'][_0x281dec(0x201)]],_0x4256eb=[_0x15a402[_0x281dec(0x1e1)][_0x281dec(0x168)]],_0x451b11=[_0x15a402['body'][_0x281dec(0x1da)]];else var _0x1624b5=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x15a)]],_0x490a40=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x16f)]],_0xe8753a=[..._0x15a402['body'][_0x281dec(0x1ce)]],_0x50d2d8=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x19a)]],_0x4b6f4f=[..._0x15a402['body'][_0x281dec(0x15e)]],_0x7dc8dc=[..._0x15a402['body']['primary_code']],_0x40e562=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x175)]],_0x5cb082=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x181)]],_0x94c0c=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x1ca)]],_0x4ec8f8=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x190)]],_0x466d54=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x1cf)]],_0x4c72e8=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x202)]],_0x562fb7=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x1a1)]],_0x3aabcf=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x173)]],_0x416d01=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x16a)]],_0x1c61e9=[..._0x15a402['body'][_0x281dec(0x1b3)]],_0x56bc70=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x203)]],_0x4a8b58=[..._0x15a402['body']['RoomAssigned']],_0xbc9b4a=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x201)]],_0x4256eb=[..._0x15a402[_0x281dec(0x1e1)][_0x281dec(0x168)]],_0x451b11=[..._0x15a402['body']['id_transaction']];const _0x1dfcf5=_0x1624b5[_0x281dec(0x197)](_0x16bdca=>{return _0x16bdca={'product_name':_0x16bdca};});_0x490a40[_0x281dec(0x1e3)]((_0x4172e9,_0x41626a)=>{var _0x16f4e4=_0x281dec;_0x1dfcf5[_0x41626a][_0x16f4e4(0x1c6)]=_0x4172e9;}),_0xe8753a[_0x281dec(0x1e3)]((_0x3e4dc8,_0x5c1e1e)=>{var _0x1d7140=_0x281dec,_0x5a4ee3=_0x3e4dc8[_0x1d7140(0x1a8)](/[A-Za-z]+/)[0x0],_0x46b4d8=parseInt(_0x3e4dc8[_0x1d7140(0x1a8)](/\d+/)[0x0]);_0x1dfcf5[_0x5c1e1e]['from_bay']=_0x46b4d8,_0x1dfcf5[_0x5c1e1e][_0x1d7140(0x1e7)]=_0x5a4ee3;}),_0x451b11[_0x281dec(0x1e3)]((_0x54944a,_0x2f30e3)=>{_0x1dfcf5[_0x2f30e3]['id_transaction']=_0x54944a;}),_0x4256eb[_0x281dec(0x1e3)]((_0x1aa2cd,_0x3bafed)=>{var _0x3cab8f=_0x281dec;_0x1dfcf5[_0x3bafed][_0x3cab8f(0x168)]=_0x1aa2cd;}),_0x50d2d8['forEach']((_0x9d96e5,_0x423a0a)=>{var _0x3bfcc4=_0x281dec;_0x1dfcf5[_0x423a0a][_0x3bfcc4(0x158)]=_0x9d96e5;}),_0x4b6f4f['forEach']((_0x23870d,_0x6db34e)=>{var _0x5641c1=_0x281dec,_0x4a8848=_0x23870d[_0x5641c1(0x1a8)](/[A-Za-z]+/)[0x0],_0x2788ea=parseInt(_0x23870d[_0x5641c1(0x1a8)](/\d+/)[0x0]);_0x1dfcf5[_0x6db34e][_0x5641c1(0x1e2)]=_0x4a8848,_0x1dfcf5[_0x6db34e][_0x5641c1(0x159)]=_0x2788ea;}),_0x7dc8dc[_0x281dec(0x1e3)]((_0x5748ab,_0x3dcfcd)=>{var _0x4c32e0=_0x281dec;_0x1dfcf5[_0x3dcfcd][_0x4c32e0(0x209)]=_0x5748ab;}),_0x40e562[_0x281dec(0x1e3)]((_0x158e09,_0x45ddf9)=>{var _0x267e96=_0x281dec;_0x1dfcf5[_0x45ddf9][_0x267e96(0x175)]=_0x158e09;}),_0x5cb082['forEach']((_0x1d733b,_0x2eacfe)=>{var _0x52fd73=_0x281dec;_0x1dfcf5[_0x2eacfe][_0x52fd73(0x1b8)]=_0x1d733b;}),_0x94c0c[_0x281dec(0x1e3)]((_0x429485,_0x4249a1)=>{var _0x21ebf0=_0x281dec;_0x1dfcf5[_0x4249a1][_0x21ebf0(0x18c)]=_0x429485;}),_0x4ec8f8[_0x281dec(0x1e3)]((_0x4cb55e,_0x1fb552)=>{var _0x2e85=_0x281dec;_0x1dfcf5[_0x1fb552][_0x2e85(0x1e0)]=_0x4cb55e;}),_0x466d54[_0x281dec(0x1e3)]((_0x31ca98,_0x13faef)=>{var _0x53307b=_0x281dec;_0x1dfcf5[_0x13faef][_0x53307b(0x1cf)]=_0x31ca98;}),_0x4c72e8['forEach']((_0x327ec7,_0x5cb75d)=>{_0x1dfcf5[_0x5cb75d]['batch_code']=_0x327ec7;}),_0x562fb7[_0x281dec(0x1e3)]((_0x216a4f,_0x5b266b)=>{var _0xadbcf0=_0x281dec;_0x1dfcf5[_0x5b266b][_0xadbcf0(0x1a1)]=_0x216a4f;}),_0x3aabcf[_0x281dec(0x1e3)]((_0x41028b,_0x13f593)=>{_0x1dfcf5[_0x13f593]['production_date']=_0x41028b;}),_0x416d01['forEach']((_0x1b4736,_0x530c86)=>{_0x1dfcf5[_0x530c86]['maxProducts']=_0x1b4736;}),_0x1c61e9[_0x281dec(0x1e3)]((_0x11f01b,_0x288c4e)=>{var _0x1143fd=_0x281dec;_0x1dfcf5[_0x288c4e][_0x1143fd(0x1b3)]=_0x11f01b;}),_0x56bc70[_0x281dec(0x1e3)]((_0x2b41c,_0x45fff6)=>{var _0x485dda=_0x281dec;_0x1dfcf5[_0x45fff6][_0x485dda(0x203)]=_0x2b41c;}),_0x4a8b58[_0x281dec(0x1e3)]((_0x37cd68,_0x399c9b)=>{var _0x3dcc3c=_0x281dec;_0x1dfcf5[_0x399c9b][_0x3dcc3c(0x162)]=_0x37cd68;}),_0xbc9b4a['forEach']((_0x48d128,_0x27b0f4)=>{var _0x1caaf5=_0x281dec;_0x1dfcf5[_0x27b0f4][_0x1caaf5(0x185)]=_0x48d128;});const _0x378bb8=_0x1dfcf5['filter'](_0x61e888=>_0x61e888[_0x281dec(0x158)]!=='0'&&_0x61e888[_0x281dec(0x158)]!==''||_0x61e888[_0x281dec(0x198)]!=='0'&&_0x61e888[_0x281dec(0x198)]!=='');var _0x20c45f=0x0;_0x378bb8[_0x281dec(0x1e3)](_0x28d1b7=>{var _0xf8f6ca=_0x281dec;parseInt(_0x28d1b7['from_quantity'])<parseInt(_0x28d1b7[_0xf8f6ca(0x158)])&&_0x20c45f++;});if(_0x20c45f!=0x0)return _0x15a402[_0x281dec(0x1d2)](_0x281dec(0x161),_0x281dec(0x19c)),_0x317f2c['redirect'](_0x281dec(0x1f6));const _0x14b90c=new transfers_logs();await _0x14b90c[_0x281dec(0x17e)]();for(let _0x2db349=0x0;_0x2db349<=_0xbc9b4a[_0x281dec(0x14f)]-0x1;_0x2db349++){_0x1dfcf5[_0x2db349][_0x281dec(0x16b)]='LOG-TRF-'+_0x14b90c[_0x281dec(0x1e5)][_0x281dec(0x1eb)]()['padStart'](0x8,'0');}const _0x4f91e6=new transfers_finished({'date':_0x2e9981,'from_warehouse':_0x30a603,'to_warehouse':_0x614b0c,'product':_0x378bb8,'note':_0x522f85,'invoice':_0x281dec(0x1c9)+_0x14b90c['invoice_init']['toString']()[_0x281dec(0x152)](0x8,'0'),'type_of_transaction':_0x281dec(0x1a4),'type_of_process':_0x281dec(0x196),'PO_number':_0x37f4fe,'RequestedBy':_0x555dec,'DateofRequest':_0x7dfef5,'typeservices':_0x2551b4,'destination':_0xfcd88c,'deliverydate':_0x9db25b,'driver':_0x59ae60,'plate':_0x261ead,'van':_0x19c695,'DRSI':_0x37461e,'typevehicle':_0x481443,'TSU':_0x3a2a0e,'TFU':_0x3f5b11}),_0xde7b10=await _0x4f91e6[_0x281dec(0x17e)]();_0x15a402[_0x281dec(0x1d2)](_0x281dec(0x1d7),'Product\x20Transfer\x20successfully'),_0x317f2c[_0x281dec(0x1be)]('/transfer_finished/preview/'+_0xde7b10[_0x281dec(0x15f)]);}catch(_0x4efc35){console['log'](_0x4efc35),_0x317f2c[_0x281dec(0x200)](0xc8)['json']({'errorMessage':_0x4efc35[_0x281dec(0x154)]});}}),router[a0_0x7fa587(0x1cc)](a0_0x7fa587(0x1f8),auth,async(_0x3a0ad0,_0x3f7ee7)=>{var _0x4800ae=a0_0x7fa587;try{const {date:_0x9832f,from_warehouse:_0x40a38f,FromRoom_name:_0x1d2f57,to_warehouse:_0x426051,ToRoom_name:_0xb4f05a,prod_name:_0x126578,from_prod_qty:_0x2b7600,from_prod_level:_0xb154c9,from_prod_isle:_0x21d0df,from_prod_pallet:_0x3f2b95,to_prod_qty:_0x3a013f,to_prod_level:_0x11a7a8,to_prod_isle:_0x2bed4f,to_prod_pallet:_0x5cdb70,primary_code:_0x362e46,secondary_code:_0x49541b,product_code3:_0x3bcde3,note:_0x2f28e0,MaxStocks_data2:_0x5f199a,invoice:_0x95eb24,expiry_date:_0x1da3cd,PO_number:_0x138dd1,ReqBy:_0x3065e6,dateofreq:_0x40f186,typeservicesData:_0x578d3b,destination:_0x2b6ca7,deliverydate:_0x54af00,driver:_0x6ce41,plate:_0x4636e0,van:_0x4ba16e,DRSI:_0x797644,typevehicle:_0x42e208,TSU:_0x5f5e49,TFU:_0x5e7437}=_0x3a0ad0[_0x4800ae(0x1e1)];if(typeof _0x126578==_0x4800ae(0x155))var _0x166c48=[_0x3a0ad0['body'][_0x4800ae(0x15a)]],_0x46fb88=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x16f)]],_0x45e1e5=[_0x3a0ad0[_0x4800ae(0x1e1)]['from_prod_level2']],_0x5c0d22=[_0x3a0ad0['body'][_0x4800ae(0x19a)]],_0x3f0fa7=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x15e)]],_0x2b3019=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x209)]],_0x52d8d2=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x175)]],_0x2f926e=[_0x3a0ad0['body'][_0x4800ae(0x181)]],_0x439695=[_0x3a0ad0['body'][_0x4800ae(0x1ca)]],_0xce67d3=[_0x3a0ad0[_0x4800ae(0x1e1)]['primary_unit']],_0x2a9bae=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x1cf)]],_0x6bc235=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x202)]],_0xf1f51b=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x1a1)]],_0x43cff8=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x173)]],_0x2c2ef6=[_0x3a0ad0[_0x4800ae(0x1e1)]['MaxStocks_data']],_0x89aa56=[_0x3a0ad0['body']['maxPerUnit']],_0x233aaa=[_0x3a0ad0[_0x4800ae(0x1e1)]['prod_cat']],_0x282e66=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x1d1)]],_0x5a1983=[_0x3a0ad0[_0x4800ae(0x1e1)]['ToRoomAssigned']],_0x5d2725=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x168)]],_0x2eebca=[_0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x1da)]];else var _0x166c48=[..._0x3a0ad0[_0x4800ae(0x1e1)]['prod_name']],_0x46fb88=[..._0x3a0ad0['body']['from_prod_qty']],_0x45e1e5=[..._0x3a0ad0['body'][_0x4800ae(0x1ce)]],_0x5c0d22=[..._0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x19a)]],_0x3f0fa7=[..._0x3a0ad0[_0x4800ae(0x1e1)]['to_prod_level']],_0x2b3019=[..._0x3a0ad0['body'][_0x4800ae(0x209)]],_0x52d8d2=[..._0x3a0ad0['body'][_0x4800ae(0x175)]],_0x2f926e=[..._0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x181)]],_0x439695=[..._0x3a0ad0['body'][_0x4800ae(0x1ca)]],_0xce67d3=[..._0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x190)]],_0x2a9bae=[..._0x3a0ad0['body'][_0x4800ae(0x1cf)]],_0x6bc235=[..._0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x202)]],_0xf1f51b=[..._0x3a0ad0['body'][_0x4800ae(0x1a1)]],_0x43cff8=[..._0x3a0ad0['body'][_0x4800ae(0x173)]],_0x2c2ef6=[..._0x3a0ad0['body'][_0x4800ae(0x16a)]],_0x89aa56=[..._0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x1b3)]],_0x233aaa=[..._0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x203)]],_0x282e66=[..._0x3a0ad0[_0x4800ae(0x1e1)]['RoomAssigned']],_0x5a1983=[..._0x3a0ad0['body'][_0x4800ae(0x201)]],_0x5d2725=[..._0x3a0ad0[_0x4800ae(0x1e1)][_0x4800ae(0x168)]],_0x2eebca=[..._0x3a0ad0['body'][_0x4800ae(0x1da)]];const _0x50153a=_0x166c48[_0x4800ae(0x197)](_0x1b05fd=>{return _0x1b05fd={'product_name':_0x1b05fd};});_0x46fb88[_0x4800ae(0x1e3)]((_0x43b67b,_0x56882b)=>{_0x50153a[_0x56882b]['from_quantity']=_0x43b67b;}),_0x45e1e5[_0x4800ae(0x1e3)]((_0x3b6fae,_0x41d1b7)=>{var _0xe0aaf9=_0x4800ae,_0x5901d0=_0x3b6fae['match'](/[A-Za-z]+/)[0x0],_0x42384e=parseInt(_0x3b6fae[_0xe0aaf9(0x1a8)](/\d+/)[0x0]);_0x50153a[_0x41d1b7][_0xe0aaf9(0x147)]=_0x42384e,_0x50153a[_0x41d1b7][_0xe0aaf9(0x1e7)]=_0x5901d0;}),_0x2eebca['forEach']((_0x735a81,_0x4ad568)=>{var _0x1425c1=_0x4800ae;_0x50153a[_0x4ad568][_0x1425c1(0x1da)]=_0x735a81;}),_0x5d2725[_0x4800ae(0x1e3)]((_0x487d7a,_0x3dc316)=>{_0x50153a[_0x3dc316]['from_invoice']=_0x487d7a;}),_0x5c0d22[_0x4800ae(0x1e3)]((_0x2e7828,_0x1be28b)=>{var _0x4ddadb=_0x4800ae;_0x50153a[_0x1be28b][_0x4ddadb(0x158)]=_0x2e7828;}),_0x3f0fa7['forEach']((_0x31678a,_0x1be718)=>{var _0x27704b=_0x4800ae,_0x943a05=_0x31678a[_0x27704b(0x1a8)](/[A-Za-z]+/)[0x0],_0x110d3e=parseInt(_0x31678a[_0x27704b(0x1a8)](/\d+/)[0x0]);_0x50153a[_0x1be718][_0x27704b(0x1e2)]=_0x943a05,_0x50153a[_0x1be718][_0x27704b(0x159)]=_0x110d3e;}),_0x2b3019[_0x4800ae(0x1e3)]((_0x20c2c2,_0x1fa94c)=>{var _0x3c4d31=_0x4800ae;_0x50153a[_0x1fa94c][_0x3c4d31(0x209)]=_0x20c2c2;}),_0x52d8d2[_0x4800ae(0x1e3)]((_0xe0455a,_0x20c61a)=>{var _0x4414bc=_0x4800ae;_0x50153a[_0x20c61a][_0x4414bc(0x175)]=_0xe0455a;}),_0x2f926e[_0x4800ae(0x1e3)]((_0x1d1242,_0x58e33e)=>{var _0x639061=_0x4800ae;_0x50153a[_0x58e33e][_0x639061(0x1b8)]=_0x1d1242;}),_0x439695['forEach']((_0x3c8976,_0x11b292)=>{var _0x462994=_0x4800ae;_0x50153a[_0x11b292][_0x462994(0x18c)]=_0x3c8976;}),_0xce67d3['forEach']((_0x103306,_0x3c6ad2)=>{var _0x494776=_0x4800ae;_0x50153a[_0x3c6ad2][_0x494776(0x1e0)]=_0x103306;}),_0x2a9bae[_0x4800ae(0x1e3)]((_0x276362,_0xf0f450)=>{var _0x419d61=_0x4800ae;_0x50153a[_0xf0f450][_0x419d61(0x1cf)]=_0x276362;}),_0x6bc235[_0x4800ae(0x1e3)]((_0x4ead0d,_0x2e6194)=>{var _0x3a06af=_0x4800ae;_0x50153a[_0x2e6194][_0x3a06af(0x202)]=_0x4ead0d;}),_0xf1f51b[_0x4800ae(0x1e3)]((_0x14ebe6,_0x5a8adb)=>{var _0x190b75=_0x4800ae;_0x50153a[_0x5a8adb][_0x190b75(0x1a1)]=_0x14ebe6;}),_0x43cff8[_0x4800ae(0x1e3)]((_0x155beb,_0x46edea)=>{var _0x4aa362=_0x4800ae;_0x50153a[_0x46edea][_0x4aa362(0x1aa)]=_0x155beb;}),_0x2c2ef6[_0x4800ae(0x1e3)]((_0xef8ad3,_0x284043)=>{var _0x321364=_0x4800ae;_0x50153a[_0x284043][_0x321364(0x18c)]=_0xef8ad3;}),_0x89aa56[_0x4800ae(0x1e3)]((_0x2fa964,_0x3945e1)=>{var _0x10401d=_0x4800ae;_0x50153a[_0x3945e1][_0x10401d(0x1b3)]=_0x2fa964;}),_0x233aaa['forEach']((_0x5b694d,_0x3ce488)=>{var _0x4509a0=_0x4800ae;_0x50153a[_0x3ce488][_0x4509a0(0x203)]=_0x5b694d;}),_0x282e66['forEach']((_0x2133e7,_0x3b9713)=>{var _0x2f3614=_0x4800ae;_0x50153a[_0x3b9713][_0x2f3614(0x162)]=_0x2133e7;}),_0x5a1983[_0x4800ae(0x1e3)]((_0x5de1d5,_0x3a922c)=>{var _0x4cae23=_0x4800ae;_0x50153a[_0x3a922c][_0x4cae23(0x185)]=_0x5de1d5;});const _0x577acd=_0x50153a['filter'](_0x29c1e9=>_0x29c1e9[_0x4800ae(0x158)]!=='0'&&_0x29c1e9['to_quantity']!==''||_0x29c1e9[_0x4800ae(0x198)]!=='0'&&_0x29c1e9[_0x4800ae(0x198)]!=='');var _0x508349=0x0;_0x577acd[_0x4800ae(0x1e3)](_0xd9849b=>{var _0x17ebd4=_0x4800ae;parseInt(_0xd9849b[_0x17ebd4(0x1c6)])<parseInt(_0xd9849b[_0x17ebd4(0x158)])&&_0x508349++;});if(_0x508349!=0x0)return _0x3a0ad0[_0x4800ae(0x1d2)](_0x4800ae(0x161),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x3f7ee7[_0x4800ae(0x1be)](_0x4800ae(0x1f6));const _0x2e27dc=new invoice_for_transfer();await _0x2e27dc[_0x4800ae(0x17e)]();for(let _0x5f07ce=0x0;_0x5f07ce<=_0x5a1983[_0x4800ae(0x14f)]-0x1;_0x5f07ce++){_0x50153a[_0x5f07ce]['To_invoice']=_0x4800ae(0x1a3)+_0x2e27dc[_0x4800ae(0x1e5)]['toString']()[_0x4800ae(0x152)](0x8,'0');}const _0x5b001b=new transfers_finished({'date':_0x9832f,'from_warehouse':_0x40a38f,'to_warehouse':_0x40a38f,'product':_0x577acd,'note':_0x2f28e0,'invoice':_0x4800ae(0x1a3)+_0x2e27dc[_0x4800ae(0x1e5)]['toString']()[_0x4800ae(0x152)](0x8,'0'),'type_of_process':_0x4800ae(0x1ec),'type_of_transaction':_0x4800ae(0x1c0),'PO_number':_0x138dd1,'RequestedBy':_0x3065e6,'DateofRequest':_0x40f186,'typeservices':_0x578d3b,'destination':_0x2b6ca7,'deliverydate':_0x54af00,'driver':_0x6ce41,'plate':_0x4636e0,'van':_0x4ba16e,'DRSI':_0x797644,'typevehicle':_0x42e208,'TSU':_0x5f5e49,'TFU':_0x5e7437}),_0x95aa68=await _0x5b001b[_0x4800ae(0x17e)]();_0x3a0ad0['flash'](_0x4800ae(0x1d7),_0x4800ae(0x14b)),_0x3f7ee7['redirect'](_0x4800ae(0x1f4)+_0x95aa68[_0x4800ae(0x15f)]);}catch(_0x35fb94){console[_0x4800ae(0x1b1)](_0x35fb94),_0x3f7ee7[_0x4800ae(0x200)](0xc8)[_0x4800ae(0x1a2)]({'errorMessage':_0x35fb94['message']});}}),router[a0_0x7fa587(0x1cc)]('/view/add_transfer_loc',auth,async(_0xb19d7a,_0x134f56)=>{var _0x418757=a0_0x7fa587;try{const {date:_0xa73070,from_warehouse:_0x31abdb,FromRoom_name:_0x10742e,to_warehouse:_0x49a4f8,ToRoom_name:_0x44e341,prod_name:_0x4c95ee,from_prod_qty:_0x5e85d0,from_prod_level:_0x516657,from_prod_isle:_0x598fab,from_prod_pallet:_0x3ec3a5,to_prod_qty:_0x20469c,to_prod_level:_0x44e89a,to_prod_isle:_0x2b7dec,to_prod_pallet:_0x1a6afb,primary_code:_0x479f5b,secondary_code:_0x3b9f81,product_code3:_0x51b10d,note:_0x3c9454,MaxStocks_data2:_0x46a692,invoice:_0x1b324c,expiry_date:_0x5391b5,PO_number_loc:_0x53c4a4,ReqBy_loc:_0x5f5875,dateofreq_loc:_0xd914b7,typeservices_loc_Data:_0x3c3bd7,destination_loc:_0x594357,deliverydate_loc:_0x9da6a8,driver_loc:_0x2355a8,plate_loc:_0x35098f,van_loc:_0x5a188f,DRSI_loc:_0x1f6c84,typevehicle_loc:_0x3c19d,TSU_loc:_0x5c3d8e,TFU_loc:_0xb78918}=_0xb19d7a[_0x418757(0x1e1)];if(typeof _0x4c95ee==_0x418757(0x155))var _0x29f447=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x15a)]],_0x9bee05=[_0xb19d7a[_0x418757(0x1e1)]['from_prod_qty']],_0x8bf2c9=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x1ce)]],_0x28bc72=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x19a)]],_0xa3ea63=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x15e)]],_0xd908f8=[_0xb19d7a['body'][_0x418757(0x209)]],_0xfef9fa=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x175)]],_0x10402b=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x181)]],_0x519fb3=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x1ca)]],_0x25f4e6=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x190)]],_0x4efe89=[_0xb19d7a['body']['secondary_unit']],_0x5c27a5=[_0xb19d7a['body'][_0x418757(0x202)]],_0x312864=[_0xb19d7a['body']['expiry_date']],_0x5d739e=[_0xb19d7a[_0x418757(0x1e1)]['product_date']],_0x107b10=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x16a)]],_0x131bfe=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x1b3)]],_0x258622=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x203)]],_0x468ba7=[_0xb19d7a['body']['RoomAssigned']],_0x372244=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x201)]],_0x315b23=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x168)]],_0x1596cc=[_0xb19d7a[_0x418757(0x1e1)][_0x418757(0x1da)]];else var _0x29f447=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x15a)]],_0x9bee05=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x16f)]],_0x8bf2c9=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x1ce)]],_0x28bc72=[..._0xb19d7a['body']['New_Qty_Converted']],_0xa3ea63=[..._0xb19d7a[_0x418757(0x1e1)]['to_prod_level']],_0xd908f8=[..._0xb19d7a[_0x418757(0x1e1)]['primary_code']],_0xfef9fa=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x175)]],_0x10402b=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x181)]],_0x519fb3=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x1ca)]],_0x25f4e6=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x190)]],_0x4efe89=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x1cf)]],_0x5c27a5=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x202)]],_0x312864=[..._0xb19d7a[_0x418757(0x1e1)]['expiry_date']],_0x5d739e=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x173)]],_0x107b10=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x16a)]],_0x131bfe=[..._0xb19d7a[_0x418757(0x1e1)]['maxPerUnit']],_0x258622=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x203)]],_0x468ba7=[..._0xb19d7a[_0x418757(0x1e1)][_0x418757(0x1d1)]],_0x372244=[..._0xb19d7a['body'][_0x418757(0x201)]],_0x315b23=[..._0xb19d7a['body'][_0x418757(0x168)]],_0x1596cc=[..._0xb19d7a[_0x418757(0x1e1)]['id_transaction']];const _0x39ec57=_0x29f447[_0x418757(0x197)](_0x47439b=>{return _0x47439b={'product_name':_0x47439b};});_0x9bee05[_0x418757(0x1e3)]((_0x35b526,_0x33f6b9)=>{_0x39ec57[_0x33f6b9]['from_quantity']=_0x35b526;}),_0x8bf2c9[_0x418757(0x1e3)]((_0x140615,_0x56a20e)=>{var _0x2b6aa2=_0x418757,_0x54ce61=_0x140615['match'](/[A-Za-z]+/)[0x0],_0x404ec=parseInt(_0x140615[_0x2b6aa2(0x1a8)](/\d+/)[0x0]);_0x39ec57[_0x56a20e]['from_bay']=_0x404ec,_0x39ec57[_0x56a20e][_0x2b6aa2(0x1e7)]=_0x54ce61;}),_0x1596cc[_0x418757(0x1e3)]((_0x68f86f,_0x535664)=>{var _0x32874e=_0x418757;_0x39ec57[_0x535664][_0x32874e(0x1da)]=_0x68f86f;}),_0x315b23['forEach']((_0x13eed0,_0xa166e5)=>{var _0x241bc3=_0x418757;_0x39ec57[_0xa166e5][_0x241bc3(0x168)]=_0x13eed0;}),_0x28bc72[_0x418757(0x1e3)]((_0x43855f,_0x4937d5)=>{var _0x862ac=_0x418757;_0x39ec57[_0x4937d5][_0x862ac(0x158)]=_0x43855f;}),_0xa3ea63[_0x418757(0x1e3)]((_0x20aa2d,_0xb865e3)=>{var _0x2b108e=_0x418757,_0xf97951=_0x20aa2d['match'](/[A-Za-z]+/)[0x0],_0x54be0c=parseInt(_0x20aa2d['match'](/\d+/)[0x0]);_0x39ec57[_0xb865e3]['to_level']=_0xf97951,_0x39ec57[_0xb865e3][_0x2b108e(0x159)]=_0x54be0c;}),_0xd908f8['forEach']((_0x1a4ae2,_0x49726)=>{_0x39ec57[_0x49726]['primary_code']=_0x1a4ae2;}),_0xfef9fa[_0x418757(0x1e3)]((_0x301384,_0x152911)=>{_0x39ec57[_0x152911]['secondary_code']=_0x301384;}),_0x10402b['forEach']((_0x446d9f,_0x5c20e0)=>{var _0x3af522=_0x418757;_0x39ec57[_0x5c20e0][_0x3af522(0x1b8)]=_0x446d9f;}),_0x519fb3[_0x418757(0x1e3)]((_0x27e174,_0x5831e3)=>{var _0x31808c=_0x418757;_0x39ec57[_0x5831e3][_0x31808c(0x18c)]=_0x27e174;}),_0x25f4e6[_0x418757(0x1e3)]((_0x5233ef,_0xa8f33b)=>{_0x39ec57[_0xa8f33b]['unit']=_0x5233ef;}),_0x4efe89[_0x418757(0x1e3)]((_0x2c32a6,_0x2f6d13)=>{var _0x11717e=_0x418757;_0x39ec57[_0x2f6d13][_0x11717e(0x1cf)]=_0x2c32a6;}),_0x5c27a5[_0x418757(0x1e3)]((_0x195a24,_0x1318bb)=>{var _0x46cdf8=_0x418757;_0x39ec57[_0x1318bb][_0x46cdf8(0x202)]=_0x195a24;}),_0x312864[_0x418757(0x1e3)]((_0x1566c5,_0x34c7d6)=>{var _0x2b7433=_0x418757;_0x39ec57[_0x34c7d6][_0x2b7433(0x1a1)]=_0x1566c5;}),_0x5d739e[_0x418757(0x1e3)]((_0x3341ef,_0x1a7aa0)=>{var _0x253216=_0x418757;_0x39ec57[_0x1a7aa0][_0x253216(0x1aa)]=_0x3341ef;}),_0x107b10[_0x418757(0x1e3)]((_0x33fa4c,_0xe0d4b)=>{var _0x314339=_0x418757;_0x39ec57[_0xe0d4b][_0x314339(0x18c)]=_0x33fa4c;}),_0x131bfe[_0x418757(0x1e3)]((_0x878166,_0x50ea2e)=>{var _0x5dde9e=_0x418757;_0x39ec57[_0x50ea2e][_0x5dde9e(0x1b3)]=_0x878166;}),_0x258622[_0x418757(0x1e3)]((_0x2b7511,_0x5020cd)=>{var _0x1b6eb7=_0x418757;_0x39ec57[_0x5020cd][_0x1b6eb7(0x203)]=_0x2b7511;}),_0x468ba7[_0x418757(0x1e3)]((_0x85f79,_0x127213)=>{_0x39ec57[_0x127213]['from_room_name']=_0x85f79;}),_0x372244[_0x418757(0x1e3)]((_0x38adf7,_0xd4495a)=>{var _0x50d240=_0x418757;_0x39ec57[_0xd4495a][_0x50d240(0x185)]=_0x38adf7;});const _0x21796f=_0x39ec57[_0x418757(0x1b7)](_0x1e97ff=>_0x1e97ff[_0x418757(0x158)]!=='0'&&_0x1e97ff[_0x418757(0x158)]!==''||_0x1e97ff[_0x418757(0x198)]!=='0'&&_0x1e97ff[_0x418757(0x198)]!=='');var _0x2afe4f=0x0;_0x21796f['forEach'](_0x5a5dca=>{var _0x57faf5=_0x418757;parseInt(_0x5a5dca[_0x57faf5(0x1c6)])<parseInt(_0x5a5dca[_0x57faf5(0x158)])&&_0x2afe4f++;});if(_0x2afe4f!=0x0)return _0xb19d7a[_0x418757(0x1d2)](_0x418757(0x161),_0x418757(0x19c)),_0x134f56[_0x418757(0x1be)]('back');const _0xe7856c=new invoice_for_transfer();await _0xe7856c[_0x418757(0x17e)]();for(let _0x59f82f=0x0;_0x59f82f<=_0x372244[_0x418757(0x14f)]-0x1;_0x59f82f++){_0x39ec57[_0x59f82f]['To_invoice']=_0x418757(0x1a3)+_0xe7856c[_0x418757(0x1e5)][_0x418757(0x1eb)]()[_0x418757(0x152)](0x8,'0');}const _0x154c22=new transfers_finished({'date':_0xa73070,'from_warehouse':_0x31abdb,'to_warehouse':_0x49a4f8,'product':_0x21796f,'note':_0x3c9454,'invoice':_0x418757(0x1a3)+_0xe7856c['invoice_init'][_0x418757(0x1eb)]()[_0x418757(0x152)](0x8,'0'),'type_of_transaction':'own','type_of_process':'location2location','PO_number':_0x53c4a4,'RequestedBy':_0x5f5875,'DateofRequest':_0xd914b7,'typeservices':_0x3c3bd7,'destination':_0x594357,'deliverydate':_0x9da6a8,'driver':_0x2355a8,'plate':_0x35098f,'van':_0x5a188f,'DRSI':_0x1f6c84,'typevehicle':_0x3c19d,'TSU':_0x5c3d8e,'TFU':_0xb78918}),_0x1f20a5=await _0x154c22['save']();_0xb19d7a[_0x418757(0x1d2)](_0x418757(0x1d7),_0x418757(0x14b)),_0x134f56['redirect'](_0x418757(0x1f4)+_0x1f20a5[_0x418757(0x15f)]);}catch(_0xe27c48){console[_0x418757(0x1b1)](_0xe27c48),_0x134f56['status'](0xc8)[_0x418757(0x1a2)]({'errorMessage':_0xe27c48[_0x418757(0x154)]});}}),router[a0_0x7fa587(0x1b0)](a0_0x7fa587(0x1ea),auth,async(_0x33e2ec,_0x40fd42)=>{var _0x38e0e9=a0_0x7fa587;try{const {username:_0x814f3c,email:_0x55d9f8,role:_0x5efb0d}=_0x33e2ec['user'],_0x1a3c2b=_0x33e2ec[_0x38e0e9(0x14c)],_0x13813f=await profile[_0x38e0e9(0x19e)]({'email':_0x1a3c2b[_0x38e0e9(0x206)]}),_0x548ba2=await master_shop['find'](),_0x2e7948=await transfers_finished[_0x38e0e9(0x166)](_0x33e2ec['params']['id']);let _0x9a8c27;if(_0x1a3c2b[_0x38e0e9(0x18b)]==_0x38e0e9(0x182)){const _0x3a79cf=await staff[_0x38e0e9(0x19e)]({'email':_0x1a3c2b[_0x38e0e9(0x206)]});_0x9a8c27=await warehouse['find']({'status':_0x38e0e9(0x1cb),'name':_0x3a79cf[_0x38e0e9(0x1b2)],'warehouse_category':_0x38e0e9(0x151)});}else _0x9a8c27=await warehouse[_0x38e0e9(0x18a)]({'status':_0x38e0e9(0x1cb),'warehouse_category':'Finished\x20Goods'});const _0x2c2fc9=await warehouse[_0x38e0e9(0x194)]([{'$match':{'name':_0x2e7948[_0x38e0e9(0x1b4)],'warehouse_category':_0x38e0e9(0x151)}},{'$unwind':_0x38e0e9(0x1f9)},{'$group':{'_id':_0x38e0e9(0x1d9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x38e0e9(0x15c)},'bay':{'$first':_0x38e0e9(0x1fe)},'bin':{'$first':_0x38e0e9(0x1ee)},'type':{'$first':_0x38e0e9(0x1ab)},'floorlevel':{'$first':_0x38e0e9(0x16c)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x38e0e9(0x17f)},'product_code':{'$first':_0x38e0e9(0x1d3)},'storage':{'$first':_0x38e0e9(0x164)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x38e0e9(0x199)},'production_date':{'$first':_0x38e0e9(0x1f0)},'room':{'$first':_0x38e0e9(0x1a5)},'warehoue_name':{'$first':'$name'}}}]),_0x1b36a9=await product[_0x38e0e9(0x18a)]({});if(_0x548ba2[0x0][_0x38e0e9(0x1d6)]==_0x38e0e9(0x207)){var _0x143b36=users[_0x38e0e9(0x191)];console[_0x38e0e9(0x1b1)](_0x143b36);}else{if(_0x548ba2[0x0][_0x38e0e9(0x1d6)]==_0x38e0e9(0x1e6))var _0x143b36=users[_0x38e0e9(0x1e6)];else{if(_0x548ba2[0x0][_0x38e0e9(0x1d6)]=='German')var _0x143b36=users['German'];else{if(_0x548ba2[0x0][_0x38e0e9(0x1d6)]==_0x38e0e9(0x170))var _0x143b36=users[_0x38e0e9(0x170)];else{if(_0x548ba2[0x0][_0x38e0e9(0x1d6)]==_0x38e0e9(0x183))var _0x143b36=users['French'];else{if(_0x548ba2[0x0][_0x38e0e9(0x1d6)]==_0x38e0e9(0x157))var _0x143b36=users['Portuguese'];else{if(_0x548ba2[0x0][_0x38e0e9(0x1d6)]==_0x38e0e9(0x17c))var _0x143b36=users[_0x38e0e9(0x17c)];else{if(_0x548ba2[0x0][_0x38e0e9(0x1d6)]==_0x38e0e9(0x148))var _0x143b36=users[_0x38e0e9(0x17a)];}}}}}}}_0x40fd42['render'](_0x38e0e9(0x169),{'success':_0x33e2ec[_0x38e0e9(0x1d2)](_0x38e0e9(0x1d7)),'errors':_0x33e2ec[_0x38e0e9(0x1d2)](_0x38e0e9(0x161)),'role':_0x1a3c2b,'profile':_0x13813f,'master_shop':_0x548ba2,'warehouse':_0x9a8c27,'transfer':_0x2e7948,'stock':_0x2c2fc9,'unit':_0x1b36a9,'language':_0x143b36});}catch(_0x44bad9){console[_0x38e0e9(0x1b1)](_0x44bad9);}}),router['post'](a0_0x7fa587(0x1ea),auth,async(_0x223769,_0x2129e7)=>{var _0x47dc6a=a0_0x7fa587;try{const {invoice:_0x30d46f,from_warehouse:_0x130323,FromRoom_name:_0x552b56,to_warehouse:_0x588e13,ToRoom_name:_0x5df97c}=_0x223769[_0x47dc6a(0x1e1)],_0x563fc1=await transfers_finished[_0x47dc6a(0x166)](_0x223769[_0x47dc6a(0x165)]['id']),_0x4aedfd=_0x563fc1['product'][_0x47dc6a(0x197)](async _0x2fb8b1=>{var _0x5b22e0=_0x47dc6a;if(_0x2fb8b1[_0x5b22e0(0x158)]>0x0){var _0x3df0c3=await warehouse[_0x5b22e0(0x19e)]({'name':_0x130323,'room':_0x2fb8b1[_0x5b22e0(0x162)]});const _0x48e863=_0x3df0c3['product_details'][_0x5b22e0(0x197)](_0x15d47e=>{var _0x494f66=_0x5b22e0;_0x15d47e[_0x494f66(0x15f)]==_0x2fb8b1[_0x494f66(0x1da)]&&(_0x15d47e['product_stock']=Math['max'](0x0,Math[_0x494f66(0x1cd)](_0x15d47e[_0x494f66(0x1e4)])-Math[_0x494f66(0x1cd)](_0x2fb8b1['to_quantity'])),console[_0x494f66(0x1b1)](_0x15d47e[_0x494f66(0x1e4)]));});}return _0x3df0c3;});Promise[_0x47dc6a(0x172)](_0x4aedfd)[_0x47dc6a(0x1fb)](async _0x177146=>{var _0x1c18e6=_0x47dc6a;try{for(const _0x1c0962 of _0x177146){await _0x1c0962[_0x1c18e6(0x17e)]();}const _0x17b958=_0x563fc1['product'][_0x1c18e6(0x197)](async _0x1e0dce=>{var _0x2a01b2=_0x1c18e6,_0x383053=await warehouse[_0x2a01b2(0x19e)]({'name':_0x588e13,'room':_0x1e0dce[_0x2a01b2(0x185)]});if(_0x1e0dce[_0x2a01b2(0x158)]>0x0){var _0x100031=0x0;const _0x3062cc=_0x383053[_0x2a01b2(0x1ae)][_0x2a01b2(0x197)](_0x185afb=>{var _0x41e9d9=_0x2a01b2;_0x185afb['product_name']==_0x1e0dce[_0x41e9d9(0x1c1)]&&_0x185afb[_0x41e9d9(0x1bc)]==_0x1e0dce[_0x41e9d9(0x159)]&&_0x185afb['expiry_date']==_0x1e0dce[_0x41e9d9(0x1a1)]&&_0x185afb[_0x41e9d9(0x1aa)]==_0x1e0dce[_0x41e9d9(0x1aa)]&&_0x185afb['batch_code']==_0x1e0dce[_0x41e9d9(0x202)]&&_0x185afb[_0x41e9d9(0x171)]==_0x1e0dce[_0x41e9d9(0x16b)]&&(typeof _0x1e0dce[_0x41e9d9(0x1da)]=='undefined'?(console[_0x41e9d9(0x1b1)]('here2',_0x185afb[_0x41e9d9(0x1e4)]+_0x41e9d9(0x1ef)+_0x185afb[_0x41e9d9(0x15f)]+'\x20<=>\x20'+Math[_0x41e9d9(0x1cd)](_0x185afb[_0x41e9d9(0x1e4)])+Math[_0x41e9d9(0x1cd)](_0x1e0dce[_0x41e9d9(0x158)])),_0x185afb[_0x41e9d9(0x1e4)]=Math[_0x41e9d9(0x1cd)](_0x185afb[_0x41e9d9(0x1e4)])+Math['abs'](_0x1e0dce['to_quantity'])):_0x185afb['product_stock']=Math['abs'](_0x185afb[_0x41e9d9(0x1e4)])+Math[_0x41e9d9(0x1cd)](_0x1e0dce[_0x41e9d9(0x158)]),_0x100031++);});_0x100031=='0'&&(_0x383053['product_details']=_0x383053[_0x2a01b2(0x1ae)]['concat']({'product_name':_0x1e0dce[_0x2a01b2(0x1c1)],'product_stock':_0x1e0dce[_0x2a01b2(0x158)],'bay':_0x1e0dce[_0x2a01b2(0x159)],'level':_0x1e0dce[_0x2a01b2(0x1e2)],'product_code':_0x1e0dce[_0x2a01b2(0x1b8)],'primary_code':_0x1e0dce[_0x2a01b2(0x209)],'secondary_code':_0x1e0dce['secondary_code'],'expiry_date':_0x1e0dce[_0x2a01b2(0x1a1)],'production_date':_0x1e0dce[_0x2a01b2(0x1aa)],'maxProducts':_0x1e0dce[_0x2a01b2(0x18c)],'batch_code':_0x1e0dce['batch_code'],'secondary_unit':_0x1e0dce['secondary_unit'],'unit':_0x1e0dce[_0x2a01b2(0x1e0)],'maxProducts':_0x1e0dce['maxProducts'],'maxPerUnit':_0x1e0dce['maxPerUnit'],'invoice':_0x1e0dce[_0x2a01b2(0x16b)]}));}return _0x383053;});Promise[_0x1c18e6(0x172)](_0x17b958)['then'](async _0x1aeec0=>{var _0x562606=_0x1c18e6;try{console[_0x562606(0x1b1)](_0x563fc1[_0x562606(0x1e8)]);if(_0x563fc1[_0x562606(0x1e8)]!=_0x562606(0x196))for(const _0x16a506 of _0x1aeec0){await warehouse['updateOne']({'_id':_0x16a506[_0x562606(0x15f)]},{'$addToSet':{'product_details':{'$each':_0x16a506[_0x562606(0x1ae)]}}});}_0x563fc1[_0x562606(0x1f7)]=_0x562606(0x14a);const _0x5a998a=await _0x563fc1['save'](),_0x50cdac=await master_shop['find'](),_0x38f877=await email_settings[_0x562606(0x19e)](),_0x81411d=await supervisor_settings[_0x562606(0x18a)]();var _0x487432=_0x563fc1['product'],_0x57614b='',_0x5300e2;for(_0x5300e2 in _0x487432){var _0x18ab0c='FG';_0x563fc1[_0x562606(0x184)]==_0x562606(0x1fa)&&(_0x18ab0c='DG'),_0x57614b+=_0x562606(0x156)+_0x562606(0x1a0)+_0x487432[_0x5300e2]['product_name']+_0x562606(0x16d)+_0x562606(0x1a0)+_0x487432[_0x5300e2][_0x562606(0x1b8)]+_0x562606(0x16d)+_0x562606(0x1a0)+_0x487432[_0x5300e2][_0x562606(0x158)]+_0x562606(0x16d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x487432[_0x5300e2][_0x562606(0x1e0)]+_0x562606(0x16d)+_0x562606(0x1a0)+_0x487432[_0x5300e2][_0x562606(0x1cf)]+_0x562606(0x16d)+_0x562606(0x1a0)+_0x563fc1[_0x562606(0x184)]+_0x562606(0x16d)+_0x562606(0x1a0)+_0x487432[_0x5300e2][_0x562606(0x185)]+_0x562606(0x16d)+_0x562606(0x1a0)+_0x18ab0c+_0x487432[_0x5300e2]['to_bay']+_0x562606(0x16d)+'</tr>';}_0x223769[_0x562606(0x1d2)](_0x562606(0x1d7),_0x562606(0x19d)),_0x2129e7['redirect'](_0x562606(0x188)+_0x5a998a[_0x562606(0x15f)]);}catch(_0x444154){console['error'](_0x444154),_0x2129e7[_0x562606(0x200)](0x1f4)[_0x562606(0x1a2)]({'error':_0x562606(0x19f)});}})[_0x1c18e6(0x193)](_0x176cde=>{var _0x5e16fe=_0x1c18e6;console[_0x5e16fe(0x163)](_0x176cde),_0x2129e7[_0x5e16fe(0x200)](0x1f4)[_0x5e16fe(0x1a2)]({'error':_0x5e16fe(0x1d5)});});}catch(_0x188d30){console[_0x1c18e6(0x163)](_0x188d30),_0x2129e7['status'](0x1f4)[_0x1c18e6(0x1a2)]({'error':_0x1c18e6(0x1f5)});}})[_0x47dc6a(0x193)](_0x42d08e=>{var _0xe3ac60=_0x47dc6a;console['error'](_0x42d08e),_0x2129e7['status'](0x1f4)[_0xe3ac60(0x1a2)]({'error':_0xe3ac60(0x1d5)});});}catch(_0x181ad2){_0x2129e7[_0x47dc6a(0x1a2)]({'message':_0x181ad2[_0x47dc6a(0x154)]});}});function BayBinSelected(_0x3a94f0,_0x1acdb6){var _0x5e5a3a=a0_0x7fa587,_0x3b7869=[];let _0x562e69=[];var _0x31e1c0=[];if(_0x3a94f0==_0x5e5a3a(0x1fa)){switch(_0x1acdb6){case _0x5e5a3a(0x1b6):_0x3b7869=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x3b7869=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x31e1c0=['DG'];}else{if(_0x3a94f0=='FROZEN\x20GOODS'){switch(_0x1acdb6){case'Rack\x201':_0x3b7869=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x5e5a3a(0x1ff):_0x3b7869=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x31e1c0=['FG'];}}return{'levels':_0x3b7869,'identify':_0x31e1c0};}router[a0_0x7fa587(0x1b0)](a0_0x7fa587(0x1fc),auth,async(_0x3fe3de,_0x4c7c37)=>{var _0x536349=a0_0x7fa587;try{const {username:_0x441161,email:_0xd5828f,role:_0x2a55e7}=_0x3fe3de[_0x536349(0x14c)],_0x14e871=_0x3fe3de[_0x536349(0x14c)],_0x54827d=await profile['findOne']({'email':_0x14e871[_0x536349(0x206)]}),_0x24f863=await master_shop[_0x536349(0x18a)](),_0x2e71f3=await transfers_finished[_0x536349(0x166)](_0x3fe3de[_0x536349(0x165)]['id']);let _0x3e7cca=new Date(_0x2e71f3[_0x536349(0x1a1)]),_0x35439b=('0'+_0x3e7cca[_0x536349(0x17b)]())[_0x536349(0x160)](-0x2),_0x719b90=('0'+(_0x3e7cca['getMonth']()+0x1))[_0x536349(0x160)](-0x2),_0x27a502=_0x3e7cca[_0x536349(0x1ed)](),_0x5a65ff=_0x27a502+'-'+_0x719b90+'-'+_0x35439b,_0x55197e;if(_0x14e871['role']=='staff'){const _0x14970f=await staff['findOne']({'email':_0x14e871[_0x536349(0x206)]});_0x55197e=await warehouse['find']({'status':_0x536349(0x1cb),'name':_0x14970f[_0x536349(0x1b2)],'warehouse_category':'Finished\x20Goods'});}else _0x55197e=await warehouse[_0x536349(0x18a)]({'status':_0x536349(0x1cb),'warehouse_category':'Finished\x20Goods'});const _0x31e3dc=await warehouse[_0x536349(0x194)]([{'$match':{'name':_0x2e71f3[_0x536349(0x1b4)],'room':_0x2e71f3['from_room']}},{'$unwind':_0x536349(0x1f9)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x536349(0x1c2)},'product_stock':{'$first':_0x536349(0x15c)},'bay':{'$first':_0x536349(0x1fe)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x536349(0x1ab)},'floorlevel':{'$first':_0x536349(0x16c)},'primary_code':{'$first':_0x536349(0x1a7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x536349(0x1d3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x536349(0x1c7)}}}]);var _0x531c3d=[0x1,0x2,0x3,0x4],_0x33be2f=['A','B','C','D','E','F','G','H','I','J'],_0x4a387a=[_0x536349(0x150),'Enclosed'];const _0x1b9c2a=await product[_0x536349(0x18a)]({}),_0x57cbaf=BayBinSelected(_0x2e71f3[_0x536349(0x184)],_0x2e71f3[_0x536349(0x1f1)]);if(_0x24f863[0x0][_0x536349(0x1d6)]=='English\x20(US)'){var _0x2a9cdc=users[_0x536349(0x191)];console[_0x536349(0x1b1)](_0x2a9cdc);}else{if(_0x24f863[0x0][_0x536349(0x1d6)]==_0x536349(0x1e6))var _0x2a9cdc=users['Hindi'];else{if(_0x24f863[0x0][_0x536349(0x1d6)]==_0x536349(0x1c8))var _0x2a9cdc=users['German'];else{if(_0x24f863[0x0][_0x536349(0x1d6)]==_0x536349(0x170))var _0x2a9cdc=users[_0x536349(0x170)];else{if(_0x24f863[0x0][_0x536349(0x1d6)]==_0x536349(0x183))var _0x2a9cdc=users[_0x536349(0x183)];else{if(_0x24f863[0x0][_0x536349(0x1d6)]==_0x536349(0x157))var _0x2a9cdc=users[_0x536349(0x14d)];else{if(_0x24f863[0x0][_0x536349(0x1d6)]=='Chinese')var _0x2a9cdc=users[_0x536349(0x17c)];else{if(_0x24f863[0x0]['language']=='Arabic\x20(ae)')var _0x2a9cdc=users['Arabic'];}}}}}}}_0x4c7c37[_0x536349(0x1c4)]('edit_transfer_finished',{'success':_0x3fe3de['flash'](_0x536349(0x1d7)),'errors':_0x3fe3de[_0x536349(0x1d2)](_0x536349(0x161)),'role':_0x14e871,'profile':_0x54827d,'master_shop':_0x24f863,'warehouse':_0x55197e,'transfer':_0x2e71f3,'stock':_0x31e3dc,'unit':_0x1b9c2a,'language':_0x2a9cdc,'levels':_0x531c3d,'Isle':_0x33be2f,'rooms_data':_0x4a387a,'ed_fullDate':_0x5a65ff,'dataSelected':_0x57cbaf});}catch(_0x44a872){console[_0x536349(0x1b1)](_0x44a872);}}),router[a0_0x7fa587(0x1cc)](a0_0x7fa587(0x1fc),auth,async(_0x4daa81,_0x2523f5)=>{var _0x3c2884=a0_0x7fa587;try{const _0x344ede=_0x4daa81[_0x3c2884(0x165)]['id'];console[_0x3c2884(0x1b1)](_0x4daa81[_0x3c2884(0x1e1)]);const _0x4df318=await transfers_finished['findById'](_0x344ede);console[_0x3c2884(0x1b1)](_0x3c2884(0x1dc),_0x4df318);const {date:_0x6cca7e,from_warehouse:_0x536cbb,FromRoom_name:_0x38704d,to_warehouse:_0x37d44e,ToRoom_name:_0x3dbdd6,prod_name:_0x3a73e2,from_prod_qty:_0x1f9f41,from_prod_level:_0x1ed06c,from_prod_isle:_0x3e4cf5,from_prod_pallet:_0x2e3fa7,to_prod_qty:_0x1ba141,to_prod_level:_0x2ff4b0,to_prod_isle:_0x3f5ed3,to_prod_pallet:_0x4d849d,primary_code:_0x5d2080,secondary_code:_0x48055a,product_code3:_0x3eb6d0,note:_0x2e0bf7,invoice:_0x331922,expiry_date:_0x98224d}=_0x4daa81[_0x3c2884(0x1e1)];if(typeof _0x3a73e2==_0x3c2884(0x155))var _0x41fc97=[_0x4daa81[_0x3c2884(0x1e1)]['prod_name']],_0x49702c=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x16f)]],_0x3468be=[_0x4daa81[_0x3c2884(0x1e1)]['from_prod_level']],_0x431ae1=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x18f)]],_0x54fb3a=[_0x4daa81['body'][_0x3c2884(0x15e)]],_0x467c87=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x209)]],_0x3ce60f=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x175)]],_0x4e3e2a=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x181)]],_0x2dfc3f=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x1ca)]],_0x510db3=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x1e0)]],_0x463d78=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x1cf)]],_0x4a5eba=[_0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x202)]],_0x1eb906=[_0x4daa81[_0x3c2884(0x1e1)]['expiry_date']];else var _0x41fc97=[..._0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x15a)]],_0x49702c=[..._0x4daa81['body'][_0x3c2884(0x16f)]],_0x3468be=[..._0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x1af)]],_0x431ae1=[..._0x4daa81['body']['to_prod_qty']],_0x54fb3a=[..._0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x15e)]],_0x467c87=[..._0x4daa81['body'][_0x3c2884(0x209)]],_0x3ce60f=[..._0x4daa81['body']['secondary_code']],_0x4e3e2a=[..._0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x181)]],_0x2dfc3f=[..._0x4daa81['body'][_0x3c2884(0x1ca)]],_0x510db3=[..._0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x1e0)]],_0x463d78=[..._0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x1cf)]],_0x4a5eba=[..._0x4daa81[_0x3c2884(0x1e1)][_0x3c2884(0x202)]],_0x1eb906=[..._0x4daa81['body'][_0x3c2884(0x1a1)]];const _0x4f5625=_0x41fc97[_0x3c2884(0x197)](_0x18eef0=>{return _0x18eef0={'product_name':_0x18eef0};});_0x49702c[_0x3c2884(0x1e3)]((_0x242ae6,_0x28d3e5)=>{_0x4f5625[_0x28d3e5]['from_quantity']=_0x242ae6;}),_0x3468be['forEach']((_0x7e25a8,_0x220d28)=>{var _0x49d15a=_0x3c2884;_0x4f5625[_0x220d28][_0x49d15a(0x147)]=_0x7e25a8;}),_0x431ae1['forEach']((_0x173bd8,_0x4757ac)=>{var _0x107baa=_0x3c2884;_0x4f5625[_0x4757ac][_0x107baa(0x158)]=_0x173bd8;}),_0x54fb3a['forEach']((_0x178d4e,_0x4cbbe2)=>{var _0x28f9e5=_0x3c2884;_0x4f5625[_0x4cbbe2][_0x28f9e5(0x159)]=_0x178d4e;}),_0x467c87[_0x3c2884(0x1e3)]((_0x2df783,_0xbc560)=>{_0x4f5625[_0xbc560]['primary_code']=_0x2df783;}),_0x3ce60f[_0x3c2884(0x1e3)]((_0x5c04e9,_0x2b53d9)=>{_0x4f5625[_0x2b53d9]['secondary_code']=_0x5c04e9;}),_0x4e3e2a[_0x3c2884(0x1e3)]((_0x13a421,_0x48155e)=>{_0x4f5625[_0x48155e]['product_code']=_0x13a421;}),_0x2dfc3f[_0x3c2884(0x1e3)]((_0x4945fa,_0x2bca50)=>{var _0x2f0c08=_0x3c2884;_0x4f5625[_0x2bca50][_0x2f0c08(0x18c)]=_0x4945fa;}),_0x510db3[_0x3c2884(0x1e3)]((_0x580010,_0x30dadf)=>{var _0x1170c3=_0x3c2884;_0x4f5625[_0x30dadf][_0x1170c3(0x1e0)]=_0x580010;}),_0x463d78['forEach']((_0x2d938f,_0x35081b)=>{var _0x12b48e=_0x3c2884;_0x4f5625[_0x35081b][_0x12b48e(0x1cf)]=_0x2d938f;}),_0x4a5eba['forEach']((_0xb9cb80,_0xb3022e)=>{var _0x5363bc=_0x3c2884;_0x4f5625[_0xb3022e][_0x5363bc(0x202)]=_0xb9cb80;}),_0x1eb906[_0x3c2884(0x1e3)]((_0x23b3c3,_0x4179e3)=>{var _0x250ef7=_0x3c2884;_0x4f5625[_0x4179e3][_0x250ef7(0x1a1)]=_0x23b3c3;});const _0x131093=_0x4f5625[_0x3c2884(0x1b7)](_0x3f94ab=>_0x3f94ab['to_quantity']!=='0'&&_0x3f94ab[_0x3c2884(0x158)]!==''||_0x3f94ab[_0x3c2884(0x198)]!=='0'&&_0x3f94ab['to_floorlevel']!=='');var _0x2ba266=0x0;_0x131093[_0x3c2884(0x1e3)](_0x5eb43c=>{var _0x37ac79=_0x3c2884;parseInt(_0x5eb43c[_0x37ac79(0x1c6)])<parseInt(_0x5eb43c[_0x37ac79(0x158)])&&_0x2ba266++;});if(_0x2ba266!=0x0)return _0x4daa81[_0x3c2884(0x1d2)](_0x3c2884(0x161),_0x3c2884(0x19c)),_0x2523f5[_0x3c2884(0x1be)](_0x3c2884(0x1f6));const _0x1dca4a=await warehouse[_0x3c2884(0x19e)]({'name':_0x4df318[_0x3c2884(0x1b4)],'room':_0x4df318['from_room']});_0x4df318[_0x3c2884(0x17d)][_0x3c2884(0x1e3)](_0x58e451=>{if(_0x58e451['to_quantity']>0x0){const _0x2b7067=_0x1dca4a['product_details']['map'](_0xbb7bae=>{var _0x39dca5=a0_0x2713;_0xbb7bae[_0x39dca5(0x1c1)]==_0x58e451['product_name']&&_0xbb7bae[_0x39dca5(0x1bc)]==_0x58e451[_0x39dca5(0x147)]&&(_0xbb7bae[_0x39dca5(0x1e4)]=parseInt(_0xbb7bae[_0x39dca5(0x1e4)])+parseInt(_0x58e451['to_quantity']));});}}),await _0x1dca4a[_0x3c2884(0x17e)]();const _0x341256=await warehouse[_0x3c2884(0x19e)]({'name':_0x4df318[_0x3c2884(0x184)],'room':_0x4df318[_0x3c2884(0x1f1)]});_0x4df318[_0x3c2884(0x17d)][_0x3c2884(0x1e3)](_0x5bab3b=>{var _0x435ac9=_0x3c2884;if(_0x5bab3b[_0x435ac9(0x158)]>0x0){const _0x1931ab=_0x341256['product_details'][_0x435ac9(0x197)](_0x5c644b=>{var _0x5653fa=_0x435ac9;_0x5c644b[_0x5653fa(0x1c1)]==_0x5bab3b[_0x5653fa(0x1c1)]&&_0x5c644b['bay']==_0x5bab3b['to_bay']&&(_0x5c644b[_0x5653fa(0x1e4)]=parseInt(_0x5c644b[_0x5653fa(0x1e4)])-parseInt(_0x5bab3b[_0x5653fa(0x158)]));});}}),await _0x341256[_0x3c2884(0x17e)](),_0x4df318['date']=_0x6cca7e,_0x4df318[_0x3c2884(0x1b4)]=_0x536cbb,_0x4df318['to_warehouse']=_0x37d44e,_0x4df318['product']=_0x131093,_0x4df318[_0x3c2884(0x1dd)]=_0x2e0bf7,_0x4df318[_0x3c2884(0x171)]=_0x331922;const _0x3858e8=await _0x4df318[_0x3c2884(0x17e)](),_0x21f8a0=await warehouse[_0x3c2884(0x19e)]({'name':_0x536cbb,'room':_0x38704d});_0x3858e8[_0x3c2884(0x17d)][_0x3c2884(0x1e3)](_0x3ca974=>{var _0x225bb2=_0x3c2884;if(_0x3ca974[_0x225bb2(0x158)]>0x0){const _0x2cf0b5=_0x21f8a0[_0x225bb2(0x1ae)][_0x225bb2(0x197)](_0x39a3be=>{var _0x107d1a=_0x225bb2;_0x39a3be[_0x107d1a(0x1c1)]==_0x3ca974['product_name']&&_0x39a3be[_0x107d1a(0x1bc)]==_0x3ca974['from_bay']&&(_0x39a3be[_0x107d1a(0x1e4)]=parseInt(_0x39a3be[_0x107d1a(0x1e4)])-parseInt(_0x3ca974['to_quantity']));});}}),await _0x21f8a0['save']();const _0x39ac7b=await warehouse[_0x3c2884(0x19e)]({'name':_0x37d44e,'room':_0x3dbdd6});_0x3858e8[_0x3c2884(0x17d)]['forEach'](_0x4f65fd=>{var _0x17a9bb=_0x3c2884;if(_0x4f65fd[_0x17a9bb(0x158)]>0x0){var _0x245215=0x0;const _0x3451c4=_0x39ac7b['product_details'][_0x17a9bb(0x197)](_0xafafd2=>{var _0x5c2b90=_0x17a9bb;_0xafafd2[_0x5c2b90(0x1c1)]==_0x4f65fd[_0x5c2b90(0x1c1)]&&_0xafafd2[_0x5c2b90(0x1bc)]==_0x4f65fd['to_bay']&&(_0xafafd2[_0x5c2b90(0x1e4)]=parseInt(_0xafafd2[_0x5c2b90(0x1e4)])+parseInt(_0x4f65fd[_0x5c2b90(0x158)]),_0x245215++);});_0x245215=='0'&&(_0x39ac7b[_0x17a9bb(0x1ae)]=_0x39ac7b[_0x17a9bb(0x1ae)][_0x17a9bb(0x180)]({'product_name':_0x4f65fd[_0x17a9bb(0x1c1)],'product_stock':_0x4f65fd[_0x17a9bb(0x158)],'bay':_0x4f65fd[_0x17a9bb(0x159)],'product_code':_0x4f65fd[_0x17a9bb(0x1b8)],'primary_code':_0x4f65fd[_0x17a9bb(0x209)],'secondary_code':_0x4f65fd[_0x17a9bb(0x175)],'maxProducts':_0x4f65fd[_0x17a9bb(0x18c)]}));}}),await _0x39ac7b[_0x3c2884(0x17e)](),_0x4daa81[_0x3c2884(0x1d2)](_0x3c2884(0x1d7),_0x3c2884(0x205)),_0x2523f5['redirect']('/transfer_finished/view');}catch(_0x455997){console[_0x3c2884(0x1b1)](_0x455997);}}),router['post'](a0_0x7fa587(0x179),async(_0x2e5417,_0x422972)=>{var _0xb20732=a0_0x7fa587;const {FromWareHouse:_0x47c738,FromRoom:_0x5d2881,ToWarehouse:_0x100421,ToRoom:_0x3e2e18,primary_code:_0x4030ec,Roomslist:_0xf046b9}=_0x2e5417['body'],_0x65582c=_0xf046b9[_0xb20732(0x1db)](','),_0x51c191=[];async function _0x545f8e(_0x1f877c){var _0x526de6=_0xb20732;const _0x4511e8=await warehouse[_0x526de6(0x194)]([{'$match':{'name':_0x47c738,'room':_0x1f877c}},{'$unwind':_0x526de6(0x1f9)},{'$match':{'product_details.primary_code':_0x4030ec}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x526de6(0x15c)},'primary_code':{'$first':_0x526de6(0x1a7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x526de6(0x1d3)},'bay':{'$first':_0x526de6(0x1fe)},'level':{'$first':'$product_details.level'},'type':{'$first':_0x526de6(0x1ab)},'pallet':{'$first':_0x526de6(0x16c)},'unit':{'$first':_0x526de6(0x186)},'secondary_unit':{'$first':_0x526de6(0x1b9)},'storage':{'$first':_0x526de6(0x164)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x526de6(0x1f0)},'batch_code':{'$first':_0x526de6(0x174)},'maxPerUnit':{'$first':_0x526de6(0x16e)},'roomNamed':{'$first':_0x526de6(0x1a5)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x526de6(0x189)}}}]),_0x2a819d=await warehouse[_0x526de6(0x194)]([{'$match':{'name':_0x47c738,'room':_0x1f877c}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4030ec}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x526de6(0x1c2)},'instock':{'$first':_0x526de6(0x15c)},'primary_code':{'$first':_0x526de6(0x1a7)},'secondary_code':{'$first':_0x526de6(0x17f)},'product_code':{'$first':_0x526de6(0x1d3)},'bay':{'$first':_0x526de6(0x1fe)},'level':{'$first':'$product_details.level'},'type':{'$first':_0x526de6(0x1ab)},'pallet':{'$first':_0x526de6(0x16c)},'unit':{'$first':_0x526de6(0x186)},'secondary_unit':{'$first':_0x526de6(0x1b9)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x526de6(0x1c7)},'expiry_date':{'$first':_0x526de6(0x199)},'production_date':{'$first':_0x526de6(0x1f0)},'batch_code':{'$first':_0x526de6(0x174)},'maxPerUnit':{'$first':_0x526de6(0x16e)},'roomNamed':{'$first':_0x526de6(0x1a5)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x526de6(0x189)}}}]);if(_0x4511e8[_0x526de6(0x14f)]>0x0)_0x51c191[_0x526de6(0x1c5)](_0x4511e8);else _0x2a819d[_0x526de6(0x14f)]>0x0&&_0x51c191['push'](_0x2a819d);}const _0x41917d=_0x65582c[_0xb20732(0x197)](_0x5a6691=>_0x545f8e(_0x5a6691));await Promise['all'](_0x41917d),_0x422972[_0xb20732(0x1a2)](_0x51c191);}),router['post'](a0_0x7fa587(0x176),async(_0x22c343,_0x4fd4f3)=>{var _0x2e9b19=a0_0x7fa587;const {productCode:_0x1e6720,bay:_0x13205b,warehouses:_0xea4847,room:_0x528566}=_0x22c343['body'];console['log'](_0x22c343[_0x2e9b19(0x1e1)]);try{const _0x3a57a9=await warehouse[_0x2e9b19(0x194)]([{'$match':{'name':_0xea4847,'room':_0x528566}},{'$unwind':_0x2e9b19(0x1f9)},{'$match':{'product_details.bay':parseInt(_0x13205b)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2e9b19(0x1c2)},'product_stock':{'$first':_0x2e9b19(0x15c)},'bay':{'$first':_0x2e9b19(0x1fe)},'maxProducts':{'$first':_0x2e9b19(0x1d4)}}}]);_0x4fd4f3[_0x2e9b19(0x200)](0xc8)[_0x2e9b19(0x1a2)](_0x3a57a9);}catch(_0x40c7d2){_0x4fd4f3[_0x2e9b19(0x200)](0x194)[_0x2e9b19(0x1a2)]({'message':_0x40c7d2[_0x2e9b19(0x154)]});}}),module[a0_0x7fa587(0x177)]=router;