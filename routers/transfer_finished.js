var a0_0x1f9860=a0_0x108a;(function(_0x5abdda,_0x2e4081){var _0x7a4d1d=a0_0x108a,_0x432ca5=_0x5abdda();while(!![]){try{var _0x596deb=-parseInt(_0x7a4d1d(0x228))/0x1+parseInt(_0x7a4d1d(0x2af))/0x2+parseInt(_0x7a4d1d(0x20b))/0x3*(-parseInt(_0x7a4d1d(0x26c))/0x4)+-parseInt(_0x7a4d1d(0x206))/0x5*(parseInt(_0x7a4d1d(0x29f))/0x6)+parseInt(_0x7a4d1d(0x2bd))/0x7+parseInt(_0x7a4d1d(0x25b))/0x8*(-parseInt(_0x7a4d1d(0x229))/0x9)+parseInt(_0x7a4d1d(0x2a0))/0xa;if(_0x596deb===_0x2e4081)break;else _0x432ca5['push'](_0x432ca5['shift']());}catch(_0x24167a){_0x432ca5['push'](_0x432ca5['shift']());}}}(a0_0xc396,0xcce8e));function a0_0xc396(){var _0x4b8db7=['then','$product_details._id','from_bay','LOG-TRF-','success','from_room','Transfer\x20Edit\x20Successfully','../middleware/auth','type_of_process','TRF-','split','An\x20error\x20occurred\x20while\x20saving\x20data.','There\x27s\x20a\x20error\x20in\x20this\x20transaction','role','primary_code','$date','toString','abs','express','$product_details.bin','date','product_date','product_code','location2location','/view/addlog','error','$product_details','$product_details.secondary_code','push','invoice_init','$product.from_room_name','/CheckingWarehouse','Arabic\x20(ae)','$product_details.storage','FROZEN\x20GOODS','16SkLTnB','here2','_id','RoomAssigned','$product_details.product_stock','unit','expiry_date','find','slice','logs','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','post','padStart','$product_details.production_date','to_prod_qty','/preview/:id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','20708CABLUO','to_level','$finalize','production_date','catch','get','/view/choose','Enabled','$product','floor','body','transfer_finished_logs','from_invoice','Finished\x20Goods','product_details','own','Hindi','from_level','Rack\x202','to_room','errors','edit_transfer_finished_view','from_prod_level2','$product_details.primary_code','$invoice','edit_transfer_finished','json','from_quantity','$product_details.batch_code','MaxStocks_data2','$product_details.rack','$product_details.maxPerUnit','transfer_data','$product_details.secondary_unit','$name','flash','Enclosed','/transfer_finished/view','to_bay','staff','Chinese','$room','Portuguese','MaxStocks_data','New_Qty_Converted','$product_details.product_code','params','concat','/view_logs','/transfer/view','from_warehouse','11388DVdKFD','12304820jJXZBd','to_prod_level','$product.to_room_name','primary_unit','\x20<>\x20','updateOne','product','secondary_unit','all','$product_details.bay','Arabic','warehouse','message','French','maxPerUnit','1104010kBRaEK','True','English','map','batch_code','/view/add_transfer','to_room_name','id_transaction','note','choos_transfer_logs','findOne','back','TRFF-','$product_details.product_name','6226437hZjRiS','/view/add_transfer_loc','from_room_name','../public/language/languages.json','German','$product_details.floorlevel','/barcode_scanner','from_prod_qty','Product\x20Transfer\x20successfully','product_name','Portuguese\x20(BR)','../models/all_models','redirect','DRY\x20GOODS','bin2bin','render','$product_details.expiry_date','$product_details.level','forEach','<tr>','English\x20(US)','2225fvuWLu','product_stock','findById','Spanish','$product_details.unit','204TjHATW','match','maxProducts','\x20<=>\x20','/view/:id','prod_name','$product_details.type','</tr>','length','$from_warehouse','finalize','</td>','user','aggregate','An\x20error\x20occurred.','from_prod_level','/transfer_finished/preview/','exports','ToRoomAssigned','getMonth','to_warehouse','to_floorlevel','$product_details.invoice','status','$product_details.maxProducts','to_quantity','bay','product_code3','secondary_code','376232TacnpS','1169055tJHdIy','language','/view','invoice','email','save','string','choos_transfer','$to_warehouse','To_invoice','log','filter','undefined','$_id','prod_cat'];a0_0xc396=function(){return _0x4b8db7;};return a0_0xc396();}const express=require(a0_0x1f9860(0x24a)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x1f9860(0x1fc)),auth=require(a0_0x1f9860(0x23f)),users=require(a0_0x1f9860(0x1f4)),nodemailer=require('nodemailer');router['get'](a0_0x1f9860(0x22b),auth,async(_0x127ed8,_0x696977)=>{var _0x49c4b0=a0_0x1f9860;try{const {username:_0x2dacb4,email:_0x240501,role:_0x35202a}=_0x127ed8[_0x49c4b0(0x217)],_0x1c7320=_0x127ed8[_0x49c4b0(0x217)],_0x1a4efe=await profile[_0x49c4b0(0x2b9)]({'email':_0x1c7320[_0x49c4b0(0x22d)]}),_0x3b1ae4=await master_shop['find']();let _0x352127;if(_0x1c7320[_0x49c4b0(0x245)]==_0x49c4b0(0x293)){const _0x384fdc=await staff[_0x49c4b0(0x2b9)]({'email':_0x1c7320[_0x49c4b0(0x22d)]});_0x352127=await transfers_finished['find']({'from_warehouse':_0x384fdc[_0x49c4b0(0x2ab)]});}else _0x352127=await transfers_finished[_0x49c4b0(0x218)]([{'$match':{'type_of_transaction':_0x49c4b0(0x27b)}},{'$unwind':_0x49c4b0(0x274)},{'$group':{'_id':'$_id','invoice':{'$first':_0x49c4b0(0x284)},'date':{'$first':_0x49c4b0(0x247)},'from_warehouse':{'$first':_0x49c4b0(0x214)},'to_warehouse':{'$first':_0x49c4b0(0x231)},'from_room_name':{'$addToSet':_0x49c4b0(0x256)},'to_room_name':{'$addToSet':_0x49c4b0(0x2a2)},'finalize':{'$first':_0x49c4b0(0x26e)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3b1ae4[0x0][_0x49c4b0(0x22a)]==_0x49c4b0(0x205))var _0xa17bd2=users[_0x49c4b0(0x2b1)];else{if(_0x3b1ae4[0x0][_0x49c4b0(0x22a)]==_0x49c4b0(0x27c))var _0xa17bd2=users[_0x49c4b0(0x27c)];else{if(_0x3b1ae4[0x0][_0x49c4b0(0x22a)]==_0x49c4b0(0x1f5))var _0xa17bd2=users[_0x49c4b0(0x1f5)];else{if(_0x3b1ae4[0x0]['language']==_0x49c4b0(0x209))var _0xa17bd2=users['Spanish'];else{if(_0x3b1ae4[0x0][_0x49c4b0(0x22a)]==_0x49c4b0(0x2ad))var _0xa17bd2=users[_0x49c4b0(0x2ad)];else{if(_0x3b1ae4[0x0][_0x49c4b0(0x22a)]==_0x49c4b0(0x1fb))var _0xa17bd2=users[_0x49c4b0(0x296)];else{if(_0x3b1ae4[0x0][_0x49c4b0(0x22a)]==_0x49c4b0(0x294))var _0xa17bd2=users[_0x49c4b0(0x294)];else{if(_0x3b1ae4[0x0]['language']==_0x49c4b0(0x258))var _0xa17bd2=users['Arabic'];}}}}}}}_0x696977[_0x49c4b0(0x200)]('transfer_finished',{'success':_0x127ed8[_0x49c4b0(0x28f)](_0x49c4b0(0x23c)),'errors':_0x127ed8[_0x49c4b0(0x28f)](_0x49c4b0(0x280)),'role':_0x1c7320,'profile':_0x1a4efe,'master_shop':_0x3b1ae4,'transfer':_0x352127,'language':_0xa17bd2});}catch(_0x3ae71a){console['log'](_0x3ae71a);}}),router[a0_0x1f9860(0x271)](a0_0x1f9860(0x29c),auth,async(_0x479078,_0x43f74f)=>{var _0x18cecf=a0_0x1f9860;try{const {username:_0x185dc1,email:_0x1d923d,role:_0x1bce90}=_0x479078[_0x18cecf(0x217)],_0x4d882e=_0x479078[_0x18cecf(0x217)],_0x5cf78d=await profile[_0x18cecf(0x2b9)]({'email':_0x4d882e['email']}),_0x308883=await master_shop[_0x18cecf(0x262)]();let _0x1cd80d;if(_0x4d882e[_0x18cecf(0x245)]=='staff'){const _0x48dd43=await staff[_0x18cecf(0x2b9)]({'email':_0x4d882e[_0x18cecf(0x22d)]});_0x1cd80d=await transfers_finished['find']({'from_warehouse':_0x48dd43[_0x18cecf(0x2ab)]});}else _0x1cd80d=await transfers_finished[_0x18cecf(0x218)]([{'$match':{'type_of_transaction':'logs'}},{'$unwind':_0x18cecf(0x274)},{'$group':{'_id':_0x18cecf(0x236),'invoice':{'$first':_0x18cecf(0x284)},'date':{'$first':_0x18cecf(0x247)},'from_warehouse':{'$first':_0x18cecf(0x214)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x18cecf(0x256)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x18cecf(0x26e)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x308883[0x0][_0x18cecf(0x22a)]==_0x18cecf(0x205))var _0x1e92c0=users[_0x18cecf(0x2b1)];else{if(_0x308883[0x0][_0x18cecf(0x22a)]==_0x18cecf(0x27c))var _0x1e92c0=users[_0x18cecf(0x27c)];else{if(_0x308883[0x0][_0x18cecf(0x22a)]==_0x18cecf(0x1f5))var _0x1e92c0=users[_0x18cecf(0x1f5)];else{if(_0x308883[0x0]['language']==_0x18cecf(0x209))var _0x1e92c0=users['Spanish'];else{if(_0x308883[0x0][_0x18cecf(0x22a)]==_0x18cecf(0x2ad))var _0x1e92c0=users[_0x18cecf(0x2ad)];else{if(_0x308883[0x0][_0x18cecf(0x22a)]==_0x18cecf(0x1fb))var _0x1e92c0=users[_0x18cecf(0x296)];else{if(_0x308883[0x0][_0x18cecf(0x22a)]==_0x18cecf(0x294))var _0x1e92c0=users['Chinese'];else{if(_0x308883[0x0][_0x18cecf(0x22a)]==_0x18cecf(0x258))var _0x1e92c0=users[_0x18cecf(0x2aa)];}}}}}}}_0x43f74f[_0x18cecf(0x200)](_0x18cecf(0x277),{'success':_0x479078[_0x18cecf(0x28f)](_0x18cecf(0x23c)),'errors':_0x479078[_0x18cecf(0x28f)]('errors'),'role':_0x4d882e,'profile':_0x5cf78d,'master_shop':_0x308883,'transfer':_0x1cd80d,'language':_0x1e92c0});}catch(_0x1ba8d3){console['log'](_0x1ba8d3);}});async function getRandom8DigitNumber(){var _0x209c7c=a0_0x1f9860;const _0x1c4ad6=0x989680,_0x439c78=0x5f5e0ff,_0x3db21b=Math[_0x209c7c(0x275)](Math['random']()*(_0x439c78-_0x1c4ad6+0x1))+_0x1c4ad6;var _0xde4dd8;const _0x2c64a8=await transfers_finished[_0x209c7c(0x2b9)]({'invoice':_0x209c7c(0x2bb)+_0x3db21b});return _0x2c64a8&&_0x2c64a8[_0x209c7c(0x213)]>0x0?_0xde4dd8=_0x209c7c(0x2bb)+_0x3db21b:_0xde4dd8=_0x209c7c(0x2bb)+_0x3db21b,_0xde4dd8;}function a0_0x108a(_0x3a0189,_0x2a3993){var _0xc396aa=a0_0xc396();return a0_0x108a=function(_0x108a3e,_0x4fb66c){_0x108a3e=_0x108a3e-0x1f4;var _0x1b1c3e=_0xc396aa[_0x108a3e];return _0x1b1c3e;},a0_0x108a(_0x3a0189,_0x2a3993);}router[a0_0x1f9860(0x271)](a0_0x1f9860(0x2b4),auth,async(_0x2fcb9f,_0xa1516d)=>{var _0x4b78c2=a0_0x1f9860;try{const {username:_0x444b0b,email:_0x7b6913,role:_0x200a86}=_0x2fcb9f['user'],_0x17a3b0=_0x2fcb9f[_0x4b78c2(0x217)],_0x1ed004=await profile['findOne']({'email':_0x17a3b0['email']}),_0x102c97=await master_shop[_0x4b78c2(0x262)]();let _0x1599cb;if(_0x17a3b0[_0x4b78c2(0x245)]==_0x4b78c2(0x293)){const _0x17a286=await staff[_0x4b78c2(0x2b9)]({'email':_0x17a3b0['email']});_0x1599cb=await warehouse[_0x4b78c2(0x218)]([{'$match':{'status':_0x4b78c2(0x273),'name':_0x17a286['warehouse']}},{'$group':{'_id':_0x4b78c2(0x28e),'name':{'$first':_0x4b78c2(0x28e)}}}]);}else _0x1599cb=await warehouse[_0x4b78c2(0x218)]([{'$match':{'status':_0x4b78c2(0x273)}},{'$group':{'_id':'$name','name':{'$first':_0x4b78c2(0x28e)}}}]);const _0x36309f=await transfers_finished['find']({}),_0x3767e6=_0x36309f['length']+0x1,_0xf1efc4='TRFF-'+_0x3767e6[_0x4b78c2(0x248)]()['padStart'](0x5,'0');if(_0x102c97[0x0][_0x4b78c2(0x22a)]==_0x4b78c2(0x205))var _0x11420a=users['English'];else{if(_0x102c97[0x0][_0x4b78c2(0x22a)]==_0x4b78c2(0x27c))var _0x11420a=users[_0x4b78c2(0x27c)];else{if(_0x102c97[0x0]['language']=='German')var _0x11420a=users[_0x4b78c2(0x1f5)];else{if(_0x102c97[0x0]['language']==_0x4b78c2(0x209))var _0x11420a=users[_0x4b78c2(0x209)];else{if(_0x102c97[0x0]['language']==_0x4b78c2(0x2ad))var _0x11420a=users[_0x4b78c2(0x2ad)];else{if(_0x102c97[0x0]['language']=='Portuguese\x20(BR)')var _0x11420a=users[_0x4b78c2(0x296)];else{if(_0x102c97[0x0]['language']==_0x4b78c2(0x294))var _0x11420a=users[_0x4b78c2(0x294)];else{if(_0x102c97[0x0]['language']==_0x4b78c2(0x258))var _0x11420a=users['Arabic'];}}}}}}}const _0x378c4f=getRandom8DigitNumber();_0x378c4f['then'](_0x17c288=>{var _0xf9a8fb=_0x4b78c2;_0xa1516d[_0xf9a8fb(0x200)]('add_transfer_finished',{'success':_0x2fcb9f['flash'](_0xf9a8fb(0x23c)),'errors':_0x2fcb9f[_0xf9a8fb(0x28f)](_0xf9a8fb(0x280)),'role':_0x17a3b0,'profile':_0x1ed004,'master_shop':_0x102c97,'warehouse':_0x1599cb,'language':_0x11420a,'invoice':_0x17c288});})[_0x4b78c2(0x270)](_0x2638eb=>{var _0x50da81=_0x4b78c2;_0x2fcb9f[_0x50da81(0x28f)](_0x50da81(0x280),_0x50da81(0x244)),_0xa1516d[_0x50da81(0x1fd)](_0x50da81(0x29d));});}catch(_0x4686a8){console[_0x4b78c2(0x233)](_0x4686a8);}}),router[a0_0x1f9860(0x271)](a0_0x1f9860(0x272),auth,async(_0x475029,_0x3c8b0d)=>{var _0x3e12a8=a0_0x1f9860;try{const {username:_0x560abd,email:_0x141af7,role:_0x5b5cb2}=_0x475029['user'],_0x53a9b9=_0x475029[_0x3e12a8(0x217)],_0x25ff91=await profile[_0x3e12a8(0x2b9)]({'email':_0x53a9b9['email']}),_0x15f4d2=await master_shop[_0x3e12a8(0x262)]();let _0x4b3e8c;if(_0x53a9b9['role']==_0x3e12a8(0x293)){const _0x1bfcaa=await staff[_0x3e12a8(0x2b9)]({'email':_0x53a9b9[_0x3e12a8(0x22d)]});_0x4b3e8c=await warehouse[_0x3e12a8(0x218)]([{'$match':{'status':_0x3e12a8(0x273),'name':_0x1bfcaa['warehouse']}},{'$group':{'_id':_0x3e12a8(0x28e),'name':{'$first':'$name'}}}]);}else _0x4b3e8c=await warehouse[_0x3e12a8(0x218)]([{'$match':{'status':_0x3e12a8(0x273)}},{'$group':{'_id':'$name','name':{'$first':_0x3e12a8(0x28e)}}}]);const _0x3b8ad8=await transfers_finished[_0x3e12a8(0x262)]({}),_0x37b29a=_0x3b8ad8[_0x3e12a8(0x213)]+0x1,_0x7615e6=_0x3e12a8(0x2bb)+_0x37b29a[_0x3e12a8(0x248)]()[_0x3e12a8(0x267)](0x5,'0');if(_0x15f4d2[0x0][_0x3e12a8(0x22a)]==_0x3e12a8(0x205))var _0x3c9cab=users[_0x3e12a8(0x2b1)];else{if(_0x15f4d2[0x0][_0x3e12a8(0x22a)]==_0x3e12a8(0x27c))var _0x3c9cab=users[_0x3e12a8(0x27c)];else{if(_0x15f4d2[0x0][_0x3e12a8(0x22a)]==_0x3e12a8(0x1f5))var _0x3c9cab=users[_0x3e12a8(0x1f5)];else{if(_0x15f4d2[0x0][_0x3e12a8(0x22a)]==_0x3e12a8(0x209))var _0x3c9cab=users[_0x3e12a8(0x209)];else{if(_0x15f4d2[0x0][_0x3e12a8(0x22a)]=='French')var _0x3c9cab=users[_0x3e12a8(0x2ad)];else{if(_0x15f4d2[0x0][_0x3e12a8(0x22a)]==_0x3e12a8(0x1fb))var _0x3c9cab=users[_0x3e12a8(0x296)];else{if(_0x15f4d2[0x0][_0x3e12a8(0x22a)]==_0x3e12a8(0x294))var _0x3c9cab=users[_0x3e12a8(0x294)];else{if(_0x15f4d2[0x0][_0x3e12a8(0x22a)]=='Arabic\x20(ae)')var _0x3c9cab=users['Arabic'];}}}}}}}const _0x4638ca=getRandom8DigitNumber();_0x4638ca[_0x3e12a8(0x238)](_0x8cd010=>{var _0x6818d6=_0x3e12a8;_0x3c8b0d[_0x6818d6(0x200)](_0x6818d6(0x230),{'success':_0x475029[_0x6818d6(0x28f)]('success'),'errors':_0x475029[_0x6818d6(0x28f)](_0x6818d6(0x280)),'role':_0x53a9b9,'profile':_0x25ff91,'master_shop':_0x15f4d2,'warehouse':_0x4b3e8c,'language':_0x3c9cab,'invoice':_0x8cd010});})[_0x3e12a8(0x270)](_0x1c2166=>{var _0x4624ef=_0x3e12a8;_0x475029[_0x4624ef(0x28f)](_0x4624ef(0x280),_0x4624ef(0x244)),_0x3c8b0d['redirect'](_0x4624ef(0x29d));});}catch(_0x2c4cd9){console[_0x3e12a8(0x233)](_0x2c4cd9);}}),router['get']('/view/choose_logs',auth,async(_0x12d92d,_0x29e97a)=>{var _0x2aa27d=a0_0x1f9860;try{const {username:_0xc26ad0,email:_0x5de0af,role:_0x1cca78}=_0x12d92d[_0x2aa27d(0x217)],_0x22b51d=_0x12d92d[_0x2aa27d(0x217)],_0x4508a1=await profile['findOne']({'email':_0x22b51d['email']}),_0x521907=await master_shop[_0x2aa27d(0x262)]();let _0x540b57;if(_0x22b51d['role']==_0x2aa27d(0x293)){const _0x304ef9=await staff['findOne']({'email':_0x22b51d[_0x2aa27d(0x22d)]});_0x540b57=await warehouse[_0x2aa27d(0x218)]([{'$match':{'status':_0x2aa27d(0x273),'name':_0x304ef9[_0x2aa27d(0x2ab)]}},{'$group':{'_id':_0x2aa27d(0x28e),'name':{'$first':_0x2aa27d(0x28e)}}}]);}else _0x540b57=await warehouse[_0x2aa27d(0x218)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x2aa27d(0x28e),'name':{'$first':_0x2aa27d(0x28e)}}}]);const _0x49779a=await transfers_finished['find']({}),_0x5e06bb=_0x49779a[_0x2aa27d(0x213)]+0x1,_0x496c12=_0x2aa27d(0x2bb)+_0x5e06bb[_0x2aa27d(0x248)]()[_0x2aa27d(0x267)](0x5,'0');if(_0x521907[0x0][_0x2aa27d(0x22a)]==_0x2aa27d(0x205))var _0x56bf36=users[_0x2aa27d(0x2b1)];else{if(_0x521907[0x0][_0x2aa27d(0x22a)]=='Hindi')var _0x56bf36=users[_0x2aa27d(0x27c)];else{if(_0x521907[0x0][_0x2aa27d(0x22a)]==_0x2aa27d(0x1f5))var _0x56bf36=users['German'];else{if(_0x521907[0x0][_0x2aa27d(0x22a)]=='Spanish')var _0x56bf36=users[_0x2aa27d(0x209)];else{if(_0x521907[0x0][_0x2aa27d(0x22a)]=='French')var _0x56bf36=users['French'];else{if(_0x521907[0x0][_0x2aa27d(0x22a)]=='Portuguese\x20(BR)')var _0x56bf36=users[_0x2aa27d(0x296)];else{if(_0x521907[0x0][_0x2aa27d(0x22a)]==_0x2aa27d(0x294))var _0x56bf36=users[_0x2aa27d(0x294)];else{if(_0x521907[0x0][_0x2aa27d(0x22a)]==_0x2aa27d(0x258))var _0x56bf36=users['Arabic'];}}}}}}}const _0x5c7852=getRandom8DigitNumber();_0x5c7852[_0x2aa27d(0x238)](_0x14721e=>{var _0x5b47b6=_0x2aa27d;_0x29e97a[_0x5b47b6(0x200)](_0x5b47b6(0x2b8),{'success':_0x12d92d[_0x5b47b6(0x28f)](_0x5b47b6(0x23c)),'errors':_0x12d92d[_0x5b47b6(0x28f)](_0x5b47b6(0x280)),'role':_0x22b51d,'profile':_0x4508a1,'master_shop':_0x521907,'warehouse':_0x540b57,'language':_0x56bf36,'invoice':_0x14721e});})['catch'](_0x5218d1=>{var _0x2e9445=_0x2aa27d;_0x12d92d[_0x2e9445(0x28f)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x29e97a[_0x2e9445(0x1fd)](_0x2e9445(0x29d));});}catch(_0x2db915){console['log'](_0x2db915);}}),router[a0_0x1f9860(0x266)]('/view/add_transfer_logs',auth,async(_0x566d4b,_0x56fe0d)=>{var _0x966dd5=a0_0x1f9860;try{const {date:_0x4aed58,from_warehouse:_0x420432,FromRoom_name:_0x41cc71,to_warehouse:_0x38d84e,ToRoom_name:_0xb73b4e,prod_name:_0x173676,from_prod_qty:_0x1fcc9c,from_prod_level:_0x15c1a3,from_prod_isle:_0x22ed1d,from_prod_pallet:_0x2f1c77,to_prod_qty:_0x6ebaa5,to_prod_level:_0x1b2ac2,to_prod_isle:_0x590925,to_prod_pallet:_0x2729cf,primary_code:_0xa2c43,secondary_code:_0x5ca972,product_code3:_0x53e844,note:_0x39b0f8,MaxStocks_data2:_0x1e061e,invoice:_0x392d1d,expiry_date:_0xe39f6f,PO_number:_0x41adb9,ReqBy:_0x2d8789,dateofreq:_0x2b5451,typeservicesData:_0x43753a,destination:_0x2f941d,deliverydate:_0x1af385,driver:_0x4eaba5,plate:_0x32b3a3,van:_0x156a0c,DRSI:_0x15f0ee,typevehicle:_0x35e857,TSU:_0x98d09e,TFU:_0x29d6e0}=_0x566d4b['body'];if(typeof _0x173676=='string')var _0x424b8e=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x210)]],_0x48b7fd=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x1f8)]],_0x2debc5=[_0x566d4b[_0x966dd5(0x276)]['from_prod_level2']],_0x16ae38=[_0x566d4b['body']['New_Qty_Converted']],_0x54b92f=[_0x566d4b['body'][_0x966dd5(0x2a1)]],_0x44c3a2=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x246)]],_0x1158a0=[_0x566d4b['body'][_0x966dd5(0x227)]],_0x34da19=[_0x566d4b['body']['product_code3']],_0x1b6ef9=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x289)]],_0x438121=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x2a3)]],_0x572b72=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x2a7)]],_0x277c9d=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x2b3)]],_0x569ceb=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x261)]],_0x30d59c=[_0x566d4b['body'][_0x966dd5(0x24d)]],_0x5c149f=[_0x566d4b['body'][_0x966dd5(0x297)]],_0x2d1c99=[_0x566d4b[_0x966dd5(0x276)]['maxPerUnit']],_0x56dd01=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x237)]],_0x5dad49=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x25e)]],_0x2e23b3=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x21d)]],_0x1ad9bf=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x278)]],_0x1f2610=[_0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x2b6)]];else var _0x424b8e=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x210)]],_0x48b7fd=[..._0x566d4b['body']['from_prod_qty']],_0x2debc5=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x282)]],_0x16ae38=[..._0x566d4b[_0x966dd5(0x276)]['New_Qty_Converted']],_0x54b92f=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x2a1)]],_0x44c3a2=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x246)]],_0x1158a0=[..._0x566d4b['body'][_0x966dd5(0x227)]],_0x34da19=[..._0x566d4b[_0x966dd5(0x276)]['product_code3']],_0x1b6ef9=[..._0x566d4b[_0x966dd5(0x276)]['MaxStocks_data2']],_0x438121=[..._0x566d4b[_0x966dd5(0x276)]['primary_unit']],_0x572b72=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x2a7)]],_0x277c9d=[..._0x566d4b['body']['batch_code']],_0x569ceb=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x261)]],_0x30d59c=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x24d)]],_0x5c149f=[..._0x566d4b['body'][_0x966dd5(0x297)]],_0x2d1c99=[..._0x566d4b['body'][_0x966dd5(0x2ae)]],_0x56dd01=[..._0x566d4b['body'][_0x966dd5(0x237)]],_0x5dad49=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x25e)]],_0x2e23b3=[..._0x566d4b['body']['ToRoomAssigned']],_0x1ad9bf=[..._0x566d4b[_0x966dd5(0x276)][_0x966dd5(0x278)]],_0x1f2610=[..._0x566d4b['body'][_0x966dd5(0x2b6)]];const _0x38c33a=_0x424b8e[_0x966dd5(0x2b2)](_0x191064=>{return _0x191064={'product_name':_0x191064};});_0x48b7fd[_0x966dd5(0x203)]((_0x417a70,_0x45ae45)=>{var _0x5dac4c=_0x966dd5;_0x38c33a[_0x45ae45][_0x5dac4c(0x287)]=_0x417a70;}),_0x2debc5[_0x966dd5(0x203)]((_0x449057,_0x4abbff)=>{var _0x155a84=_0x966dd5,_0x145209=_0x449057[_0x155a84(0x20c)](/[A-Za-z]+/)[0x0],_0x37f173=parseInt(_0x449057[_0x155a84(0x20c)](/\d+/)[0x0]);_0x38c33a[_0x4abbff][_0x155a84(0x23a)]=_0x37f173,_0x38c33a[_0x4abbff][_0x155a84(0x27d)]=_0x145209;}),_0x1f2610['forEach']((_0x1b81f6,_0x5cb9f3)=>{var _0x1588e4=_0x966dd5;_0x38c33a[_0x5cb9f3][_0x1588e4(0x2b6)]=_0x1b81f6;}),_0x1ad9bf['forEach']((_0xf3d945,_0x3b9e7c)=>{var _0x10288b=_0x966dd5;_0x38c33a[_0x3b9e7c][_0x10288b(0x278)]=_0xf3d945;}),_0x16ae38[_0x966dd5(0x203)]((_0xbbf938,_0x520f35)=>{var _0x1c09b1=_0x966dd5;_0x38c33a[_0x520f35][_0x1c09b1(0x224)]=_0xbbf938;}),_0x54b92f[_0x966dd5(0x203)]((_0x3aa327,_0x104f0f)=>{var _0x449ed4=_0x966dd5,_0x484edd=_0x3aa327[_0x449ed4(0x20c)](/[A-Za-z]+/)[0x0],_0x56ee25=parseInt(_0x3aa327['match'](/\d+/)[0x0]);_0x38c33a[_0x104f0f]['to_level']=_0x484edd,_0x38c33a[_0x104f0f][_0x449ed4(0x292)]=_0x56ee25;}),_0x44c3a2[_0x966dd5(0x203)]((_0x16c598,_0x544dda)=>{_0x38c33a[_0x544dda]['primary_code']=_0x16c598;}),_0x1158a0['forEach']((_0x4b9cd9,_0x4488f5)=>{var _0x164575=_0x966dd5;_0x38c33a[_0x4488f5][_0x164575(0x227)]=_0x4b9cd9;}),_0x34da19[_0x966dd5(0x203)]((_0x5c10e8,_0x175a22)=>{var _0x30a5a1=_0x966dd5;_0x38c33a[_0x175a22][_0x30a5a1(0x24e)]=_0x5c10e8;}),_0x1b6ef9[_0x966dd5(0x203)]((_0x410aff,_0xfe3524)=>{var _0x101830=_0x966dd5;_0x38c33a[_0xfe3524][_0x101830(0x20d)]=_0x410aff;}),_0x438121[_0x966dd5(0x203)]((_0x3bc4a6,_0x5e1cf1)=>{var _0x5561bc=_0x966dd5;_0x38c33a[_0x5e1cf1][_0x5561bc(0x260)]=_0x3bc4a6;}),_0x572b72['forEach']((_0x1758d6,_0x159a97)=>{_0x38c33a[_0x159a97]['secondary_unit']=_0x1758d6;}),_0x277c9d['forEach']((_0x466020,_0x427f9d)=>{var _0x5a459a=_0x966dd5;_0x38c33a[_0x427f9d][_0x5a459a(0x2b3)]=_0x466020;}),_0x569ceb['forEach']((_0x39b2ee,_0x4c3d55)=>{_0x38c33a[_0x4c3d55]['expiry_date']=_0x39b2ee;}),_0x30d59c[_0x966dd5(0x203)]((_0x230cc7,_0x530ea0)=>{var _0x2530ee=_0x966dd5;_0x38c33a[_0x530ea0][_0x2530ee(0x26f)]=_0x230cc7;}),_0x5c149f[_0x966dd5(0x203)]((_0x1a6f8d,_0x4854b0)=>{var _0x46e36a=_0x966dd5;_0x38c33a[_0x4854b0][_0x46e36a(0x20d)]=_0x1a6f8d;}),_0x2d1c99[_0x966dd5(0x203)]((_0x3a06c5,_0x3b8f5c)=>{var _0x1b9e0f=_0x966dd5;_0x38c33a[_0x3b8f5c][_0x1b9e0f(0x2ae)]=_0x3a06c5;}),_0x56dd01[_0x966dd5(0x203)]((_0xe5e77,_0x2bd087)=>{_0x38c33a[_0x2bd087]['prod_cat']=_0xe5e77;}),_0x5dad49['forEach']((_0x58ed6d,_0x75dd86)=>{var _0x118583=_0x966dd5;_0x38c33a[_0x75dd86][_0x118583(0x2bf)]=_0x58ed6d;}),_0x2e23b3['forEach']((_0x53acda,_0x5b3509)=>{_0x38c33a[_0x5b3509]['to_room_name']=_0x53acda;});const _0x35c6a2=_0x38c33a[_0x966dd5(0x234)](_0x4bb656=>_0x4bb656['to_quantity']!=='0'&&_0x4bb656['to_quantity']!==''||_0x4bb656['to_floorlevel']!=='0'&&_0x4bb656[_0x966dd5(0x220)]!=='');var _0x48c9da=0x0;_0x35c6a2[_0x966dd5(0x203)](_0x4ea1a2=>{var _0x3ba0b8=_0x966dd5;parseInt(_0x4ea1a2[_0x3ba0b8(0x287)])<parseInt(_0x4ea1a2[_0x3ba0b8(0x224)])&&_0x48c9da++;});if(_0x48c9da!=0x0)return _0x566d4b[_0x966dd5(0x28f)](_0x966dd5(0x280),_0x966dd5(0x265)),_0x56fe0d[_0x966dd5(0x1fd)](_0x966dd5(0x2ba));const _0xd6e53b=new transfers_logs();await _0xd6e53b[_0x966dd5(0x22e)]();for(let _0x356f13=0x0;_0x356f13<=_0x2e23b3[_0x966dd5(0x213)]-0x1;_0x356f13++){_0x38c33a[_0x356f13][_0x966dd5(0x232)]=_0x966dd5(0x23b)+_0xd6e53b[_0x966dd5(0x255)]['toString']()[_0x966dd5(0x267)](0x8,'0');}const _0x58cf1c=new transfers_finished({'date':_0x4aed58,'from_warehouse':_0x420432,'to_warehouse':_0x420432,'product':_0x35c6a2,'note':_0x39b0f8,'invoice':_0x966dd5(0x23b)+_0xd6e53b['invoice_init']['toString']()[_0x966dd5(0x267)](0x8,'0'),'type_of_process':_0x966dd5(0x1ff),'type_of_transaction':_0x966dd5(0x264),'PO_number':_0x41adb9,'RequestedBy':_0x2d8789,'DateofRequest':_0x2b5451,'typeservices':_0x43753a,'destination':_0x2f941d,'deliverydate':_0x1af385,'driver':_0x4eaba5,'plate':_0x32b3a3,'van':_0x156a0c,'DRSI':_0x15f0ee,'typevehicle':_0x35e857,'TSU':_0x98d09e,'TFU':_0x29d6e0}),_0x1e7f2f=await _0x58cf1c['save']();_0x566d4b[_0x966dd5(0x28f)](_0x966dd5(0x23c),_0x966dd5(0x1f9)),_0x56fe0d[_0x966dd5(0x1fd)](_0x966dd5(0x21b)+_0x1e7f2f['_id']);}catch(_0x34f7fc){console[_0x966dd5(0x233)](_0x34f7fc),_0x56fe0d[_0x966dd5(0x222)](0xc8)[_0x966dd5(0x286)]({'errorMessage':_0x34f7fc['message']});}}),router[a0_0x1f9860(0x266)](a0_0x1f9860(0x250),auth,async(_0x57e5ef,_0x211740)=>{var _0x2b04a8=a0_0x1f9860;try{const {date:_0x47690f,from_warehouse:_0x2d1aa9,FromRoom_name:_0x4739fd,to_warehouse:_0x53f5dd,ToRoom_name:_0x436b71,prod_name:_0x2a9e11,from_prod_qty:_0x162d03,from_prod_level:_0x1e645a,from_prod_isle:_0x5e9f7e,from_prod_pallet:_0xd895cd,to_prod_qty:_0x5217d2,to_prod_level:_0x10767f,to_prod_isle:_0x45ee99,to_prod_pallet:_0x49cf2a,primary_code:_0x2bc87a,secondary_code:_0x5038a4,product_code3:_0x4e7201,note:_0x33cf32,MaxStocks_data2:_0x30c8da,invoice:_0xbe34eb,expiry_date:_0x1f83d6,PO_number_loc:_0x41f3b5,ReqBy_loc:_0x4976ae,dateofreq_loc:_0x25a999,typeservices_loc_Data:_0x51c012,destination_loc:_0x5f3b1c,deliverydate_loc:_0x4bc793,driver_loc:_0x8e8ae,plate_loc:_0x11f420,van_loc:_0x2353fa,DRSI_loc:_0x39b9fa,typevehicle_loc:_0x2a545d,TSU_loc:_0x16477b,TFU_loc:_0x4f1b30}=_0x57e5ef[_0x2b04a8(0x276)];if(typeof _0x2a9e11==_0x2b04a8(0x22f))var _0x195210=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x210)]],_0x28664d=[_0x57e5ef['body'][_0x2b04a8(0x1f8)]],_0x188d1e=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x282)]],_0x2b1d94=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x298)]],_0x115ee8=[_0x57e5ef[_0x2b04a8(0x276)]['to_prod_level']],_0x4e659e=[_0x57e5ef['body']['primary_code']],_0x463166=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x227)]],_0x40a483=[_0x57e5ef[_0x2b04a8(0x276)]['product_code3']],_0x40337e=[_0x57e5ef[_0x2b04a8(0x276)]['MaxStocks_data2']],_0x18e892=[_0x57e5ef['body'][_0x2b04a8(0x2a3)]],_0x278229=[_0x57e5ef[_0x2b04a8(0x276)]['secondary_unit']],_0x15c554=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x2b3)]],_0x21b32d=[_0x57e5ef[_0x2b04a8(0x276)]['expiry_date']],_0x37fadb=[_0x57e5ef[_0x2b04a8(0x276)]['product_date']],_0x2cd1d5=[_0x57e5ef[_0x2b04a8(0x276)]['MaxStocks_data']],_0x2d2ae7=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x2ae)]],_0x463047=[_0x57e5ef[_0x2b04a8(0x276)]['prod_cat']],_0xfb4359=[_0x57e5ef['body'][_0x2b04a8(0x25e)]],_0x39deff=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x21d)]],_0x56c525=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x278)]],_0x298b73=[_0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x2b6)]];else var _0x195210=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x210)]],_0x28664d=[..._0x57e5ef[_0x2b04a8(0x276)]['from_prod_qty']],_0x188d1e=[..._0x57e5ef['body'][_0x2b04a8(0x282)]],_0x2b1d94=[..._0x57e5ef[_0x2b04a8(0x276)]['New_Qty_Converted']],_0x115ee8=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x2a1)]],_0x4e659e=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x246)]],_0x463166=[..._0x57e5ef[_0x2b04a8(0x276)]['secondary_code']],_0x40a483=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x226)]],_0x40337e=[..._0x57e5ef['body'][_0x2b04a8(0x289)]],_0x18e892=[..._0x57e5ef['body'][_0x2b04a8(0x2a3)]],_0x278229=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x2a7)]],_0x15c554=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x2b3)]],_0x21b32d=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x261)]],_0x37fadb=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x24d)]],_0x2cd1d5=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x297)]],_0x2d2ae7=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x2ae)]],_0x463047=[..._0x57e5ef['body'][_0x2b04a8(0x237)]],_0xfb4359=[..._0x57e5ef[_0x2b04a8(0x276)]['RoomAssigned']],_0x39deff=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x21d)]],_0x56c525=[..._0x57e5ef['body'][_0x2b04a8(0x278)]],_0x298b73=[..._0x57e5ef[_0x2b04a8(0x276)][_0x2b04a8(0x2b6)]];const _0x5a7824=_0x195210[_0x2b04a8(0x2b2)](_0x5beaaa=>{return _0x5beaaa={'product_name':_0x5beaaa};});_0x28664d[_0x2b04a8(0x203)]((_0x2df5f9,_0x411c0d)=>{var _0x25a7d7=_0x2b04a8;_0x5a7824[_0x411c0d][_0x25a7d7(0x287)]=_0x2df5f9;}),_0x188d1e['forEach']((_0x4c27de,_0x26e9c2)=>{var _0x4ca139=_0x2b04a8,_0x4393be=_0x4c27de[_0x4ca139(0x20c)](/[A-Za-z]+/)[0x0],_0x21c82e=parseInt(_0x4c27de[_0x4ca139(0x20c)](/\d+/)[0x0]);_0x5a7824[_0x26e9c2][_0x4ca139(0x23a)]=_0x21c82e,_0x5a7824[_0x26e9c2][_0x4ca139(0x27d)]=_0x4393be;}),_0x298b73[_0x2b04a8(0x203)]((_0x4c7896,_0x4ef27d)=>{var _0x5eda59=_0x2b04a8;_0x5a7824[_0x4ef27d][_0x5eda59(0x2b6)]=_0x4c7896;}),_0x56c525[_0x2b04a8(0x203)]((_0x21fd60,_0x4ff7f4)=>{var _0x2b9f2b=_0x2b04a8;_0x5a7824[_0x4ff7f4][_0x2b9f2b(0x278)]=_0x21fd60;}),_0x2b1d94[_0x2b04a8(0x203)]((_0x32e3f5,_0x35c8b8)=>{var _0x3ed63a=_0x2b04a8;_0x5a7824[_0x35c8b8][_0x3ed63a(0x224)]=_0x32e3f5;}),_0x115ee8[_0x2b04a8(0x203)]((_0x3be906,_0x739148)=>{var _0x1c5e12=_0x2b04a8,_0x5711f1=_0x3be906[_0x1c5e12(0x20c)](/[A-Za-z]+/)[0x0],_0x2564cf=parseInt(_0x3be906[_0x1c5e12(0x20c)](/\d+/)[0x0]);_0x5a7824[_0x739148]['to_level']=_0x5711f1,_0x5a7824[_0x739148][_0x1c5e12(0x292)]=_0x2564cf;}),_0x4e659e[_0x2b04a8(0x203)]((_0x3be025,_0x3224a5)=>{var _0x1d1b28=_0x2b04a8;_0x5a7824[_0x3224a5][_0x1d1b28(0x246)]=_0x3be025;}),_0x463166[_0x2b04a8(0x203)]((_0x37cf7a,_0x2dc5c5)=>{var _0x45b35c=_0x2b04a8;_0x5a7824[_0x2dc5c5][_0x45b35c(0x227)]=_0x37cf7a;}),_0x40a483['forEach']((_0x23a0ac,_0x46cae9)=>{var _0x404ea8=_0x2b04a8;_0x5a7824[_0x46cae9][_0x404ea8(0x24e)]=_0x23a0ac;}),_0x40337e[_0x2b04a8(0x203)]((_0x354a21,_0x12c3a1)=>{var _0x36d161=_0x2b04a8;_0x5a7824[_0x12c3a1][_0x36d161(0x20d)]=_0x354a21;}),_0x18e892[_0x2b04a8(0x203)]((_0x56ae89,_0xc96deb)=>{var _0x297d87=_0x2b04a8;_0x5a7824[_0xc96deb][_0x297d87(0x260)]=_0x56ae89;}),_0x278229[_0x2b04a8(0x203)]((_0x3957a2,_0x4f20a1)=>{var _0x48ea23=_0x2b04a8;_0x5a7824[_0x4f20a1][_0x48ea23(0x2a7)]=_0x3957a2;}),_0x15c554['forEach']((_0x291edd,_0x1ff8a5)=>{_0x5a7824[_0x1ff8a5]['batch_code']=_0x291edd;}),_0x21b32d['forEach']((_0x2761a1,_0x1837ea)=>{var _0x5a77b2=_0x2b04a8;_0x5a7824[_0x1837ea][_0x5a77b2(0x261)]=_0x2761a1;}),_0x37fadb[_0x2b04a8(0x203)]((_0x53fa04,_0x416eea)=>{var _0x4278ce=_0x2b04a8;_0x5a7824[_0x416eea][_0x4278ce(0x26f)]=_0x53fa04;}),_0x2cd1d5['forEach']((_0x333224,_0x20ad51)=>{var _0x288c67=_0x2b04a8;_0x5a7824[_0x20ad51][_0x288c67(0x20d)]=_0x333224;}),_0x2d2ae7[_0x2b04a8(0x203)]((_0x496bb5,_0x17c959)=>{var _0x2a4f98=_0x2b04a8;_0x5a7824[_0x17c959][_0x2a4f98(0x2ae)]=_0x496bb5;}),_0x463047[_0x2b04a8(0x203)]((_0xcef0b,_0x5611ab)=>{_0x5a7824[_0x5611ab]['prod_cat']=_0xcef0b;}),_0xfb4359[_0x2b04a8(0x203)]((_0x8cde2d,_0x2a3719)=>{_0x5a7824[_0x2a3719]['from_room_name']=_0x8cde2d;}),_0x39deff['forEach']((_0x7d3fd0,_0x30b8d6)=>{var _0xaaac5a=_0x2b04a8;_0x5a7824[_0x30b8d6][_0xaaac5a(0x2b5)]=_0x7d3fd0;});const _0x28839a=_0x5a7824['filter'](_0x9cc2ed=>_0x9cc2ed[_0x2b04a8(0x224)]!=='0'&&_0x9cc2ed['to_quantity']!==''||_0x9cc2ed[_0x2b04a8(0x220)]!=='0'&&_0x9cc2ed[_0x2b04a8(0x220)]!=='');var _0x5f1f57=0x0;_0x28839a[_0x2b04a8(0x203)](_0xd3f6c8=>{var _0x5b2e35=_0x2b04a8;parseInt(_0xd3f6c8['from_quantity'])<parseInt(_0xd3f6c8[_0x5b2e35(0x224)])&&_0x5f1f57++;});if(_0x5f1f57!=0x0)return _0x57e5ef['flash'](_0x2b04a8(0x280),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x211740[_0x2b04a8(0x1fd)](_0x2b04a8(0x2ba));const _0x5250f6=new transfers_logs();await _0x5250f6['save']();for(let _0x15e107=0x0;_0x15e107<=_0x39deff['length']-0x1;_0x15e107++){_0x5a7824[_0x15e107][_0x2b04a8(0x232)]=_0x2b04a8(0x23b)+_0x5250f6[_0x2b04a8(0x255)][_0x2b04a8(0x248)]()[_0x2b04a8(0x267)](0x8,'0');}const _0x11407e=new transfers_finished({'date':_0x47690f,'from_warehouse':_0x2d1aa9,'to_warehouse':_0x53f5dd,'product':_0x28839a,'note':_0x33cf32,'invoice':_0x2b04a8(0x23b)+_0x5250f6[_0x2b04a8(0x255)]['toString']()[_0x2b04a8(0x267)](0x8,'0'),'type_of_transaction':_0x2b04a8(0x264),'type_of_process':_0x2b04a8(0x24f),'PO_number':_0x41f3b5,'RequestedBy':_0x4976ae,'DateofRequest':_0x25a999,'typeservices':_0x51c012,'destination':_0x5f3b1c,'deliverydate':_0x4bc793,'driver':_0x8e8ae,'plate':_0x11f420,'van':_0x2353fa,'DRSI':_0x39b9fa,'typevehicle':_0x2a545d,'TSU':_0x16477b,'TFU':_0x4f1b30}),_0x1efd19=await _0x11407e[_0x2b04a8(0x22e)]();_0x57e5ef['flash'](_0x2b04a8(0x23c),'Product\x20Transfer\x20successfully'),_0x211740[_0x2b04a8(0x1fd)]('/transfer_finished/preview/'+_0x1efd19[_0x2b04a8(0x25d)]);}catch(_0x1aa7d1){console[_0x2b04a8(0x233)](_0x1aa7d1),_0x211740[_0x2b04a8(0x222)](0xc8)[_0x2b04a8(0x286)]({'errorMessage':_0x1aa7d1[_0x2b04a8(0x2ac)]});}}),router[a0_0x1f9860(0x266)]('/view/add_transfer',auth,async(_0x1dd212,_0x56b7e4)=>{var _0x1363f0=a0_0x1f9860;try{const {date:_0xb696c0,from_warehouse:_0x494c69,FromRoom_name:_0x55cdfb,to_warehouse:_0x1f94e0,ToRoom_name:_0x471ce5,prod_name:_0x41e601,from_prod_qty:_0x8d660a,from_prod_level:_0x35a9eb,from_prod_isle:_0x40d3ca,from_prod_pallet:_0x1f01cb,to_prod_qty:_0x3d34df,to_prod_level:_0x8abe81,to_prod_isle:_0x213299,to_prod_pallet:_0x10819e,primary_code:_0x2abf53,secondary_code:_0x31f2e9,product_code3:_0xe69f0f,note:_0x347d64,MaxStocks_data2:_0x5716de,invoice:_0x521308,expiry_date:_0x3dc620,PO_number:_0x1bb795,ReqBy:_0x3c664b,dateofreq:_0x3beaf0,typeservicesData:_0x386926,destination:_0x2ba233,deliverydate:_0x16f40e,driver:_0x3bef7,plate:_0xda4c9f,van:_0x4ca83f,DRSI:_0x59f90a,typevehicle:_0xc13df8,TSU:_0x175104,TFU:_0x255ae2}=_0x1dd212[_0x1363f0(0x276)];if(typeof _0x41e601==_0x1363f0(0x22f))var _0x3f31ab=[_0x1dd212[_0x1363f0(0x276)]['prod_name']],_0x2cfb79=[_0x1dd212['body'][_0x1363f0(0x1f8)]],_0x44484d=[_0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x282)]],_0x36d7c5=[_0x1dd212[_0x1363f0(0x276)]['New_Qty_Converted']],_0x685d01=[_0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x2a1)]],_0x2ecf62=[_0x1dd212[_0x1363f0(0x276)]['primary_code']],_0xf67f7d=[_0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x227)]],_0x106213=[_0x1dd212['body']['product_code3']],_0x525789=[_0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x289)]],_0x18184d=[_0x1dd212['body'][_0x1363f0(0x2a3)]],_0x32c773=[_0x1dd212['body'][_0x1363f0(0x2a7)]],_0x2c62c0=[_0x1dd212['body']['batch_code']],_0x5f1a5c=[_0x1dd212['body']['expiry_date']],_0x59f969=[_0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x24d)]],_0x1d5b0e=[_0x1dd212[_0x1363f0(0x276)]['MaxStocks_data']],_0x146cc1=[_0x1dd212['body']['maxPerUnit']],_0x1dd58e=[_0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x237)]],_0x5530d6=[_0x1dd212['body'][_0x1363f0(0x25e)]],_0x4a9a9c=[_0x1dd212['body'][_0x1363f0(0x21d)]],_0x162039=[_0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x278)]],_0x3959e0=[_0x1dd212['body']['id_transaction']];else var _0x3f31ab=[..._0x1dd212['body'][_0x1363f0(0x210)]],_0x2cfb79=[..._0x1dd212[_0x1363f0(0x276)]['from_prod_qty']],_0x44484d=[..._0x1dd212[_0x1363f0(0x276)]['from_prod_level2']],_0x36d7c5=[..._0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x298)]],_0x685d01=[..._0x1dd212['body'][_0x1363f0(0x2a1)]],_0x2ecf62=[..._0x1dd212[_0x1363f0(0x276)]['primary_code']],_0xf67f7d=[..._0x1dd212['body'][_0x1363f0(0x227)]],_0x106213=[..._0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x226)]],_0x525789=[..._0x1dd212['body'][_0x1363f0(0x289)]],_0x18184d=[..._0x1dd212[_0x1363f0(0x276)]['primary_unit']],_0x32c773=[..._0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x2a7)]],_0x2c62c0=[..._0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x2b3)]],_0x5f1a5c=[..._0x1dd212['body'][_0x1363f0(0x261)]],_0x59f969=[..._0x1dd212['body'][_0x1363f0(0x24d)]],_0x1d5b0e=[..._0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x297)]],_0x146cc1=[..._0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x2ae)]],_0x1dd58e=[..._0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x237)]],_0x5530d6=[..._0x1dd212['body'][_0x1363f0(0x25e)]],_0x4a9a9c=[..._0x1dd212['body'][_0x1363f0(0x21d)]],_0x162039=[..._0x1dd212[_0x1363f0(0x276)][_0x1363f0(0x278)]],_0x3959e0=[..._0x1dd212['body']['id_transaction']];const _0x3e47b3=_0x3f31ab[_0x1363f0(0x2b2)](_0x26a3ef=>{return _0x26a3ef={'product_name':_0x26a3ef};});_0x2cfb79[_0x1363f0(0x203)]((_0x1c994c,_0xd02d9a)=>{_0x3e47b3[_0xd02d9a]['from_quantity']=_0x1c994c;}),_0x44484d[_0x1363f0(0x203)]((_0x11ea79,_0x125c4a)=>{var _0x92b29e=_0x1363f0,_0xc63ca=_0x11ea79[_0x92b29e(0x20c)](/[A-Za-z]+/)[0x0],_0x3945b7=parseInt(_0x11ea79[_0x92b29e(0x20c)](/\d+/)[0x0]);_0x3e47b3[_0x125c4a][_0x92b29e(0x23a)]=_0x3945b7,_0x3e47b3[_0x125c4a][_0x92b29e(0x27d)]=_0xc63ca;}),_0x3959e0[_0x1363f0(0x203)]((_0x331b33,_0x2f150f)=>{_0x3e47b3[_0x2f150f]['id_transaction']=_0x331b33;}),_0x162039[_0x1363f0(0x203)]((_0x23ae0b,_0x5f0ffe)=>{var _0x3a9a96=_0x1363f0;_0x3e47b3[_0x5f0ffe][_0x3a9a96(0x278)]=_0x23ae0b;}),_0x36d7c5[_0x1363f0(0x203)]((_0x34b7a1,_0x46cec6)=>{_0x3e47b3[_0x46cec6]['to_quantity']=_0x34b7a1;}),_0x685d01[_0x1363f0(0x203)]((_0x3edb17,_0xc5533b)=>{var _0x3b542b=_0x1363f0,_0xe548a5=_0x3edb17[_0x3b542b(0x20c)](/[A-Za-z]+/)[0x0],_0x16e965=parseInt(_0x3edb17[_0x3b542b(0x20c)](/\d+/)[0x0]);_0x3e47b3[_0xc5533b][_0x3b542b(0x26d)]=_0xe548a5,_0x3e47b3[_0xc5533b][_0x3b542b(0x292)]=_0x16e965;}),_0x2ecf62[_0x1363f0(0x203)]((_0x1a0167,_0x261807)=>{_0x3e47b3[_0x261807]['primary_code']=_0x1a0167;}),_0xf67f7d[_0x1363f0(0x203)]((_0x244986,_0xdf194a)=>{var _0x29ca32=_0x1363f0;_0x3e47b3[_0xdf194a][_0x29ca32(0x227)]=_0x244986;}),_0x106213['forEach']((_0x2ce8db,_0x2c475d)=>{var _0x59d3d6=_0x1363f0;_0x3e47b3[_0x2c475d][_0x59d3d6(0x24e)]=_0x2ce8db;}),_0x525789[_0x1363f0(0x203)]((_0x15ee55,_0x371b07)=>{var _0x3af9e0=_0x1363f0;_0x3e47b3[_0x371b07][_0x3af9e0(0x20d)]=_0x15ee55;}),_0x18184d[_0x1363f0(0x203)]((_0x4f0c71,_0x4bf6e8)=>{_0x3e47b3[_0x4bf6e8]['unit']=_0x4f0c71;}),_0x32c773['forEach']((_0x1aac4f,_0x5ed097)=>{var _0x40f1db=_0x1363f0;_0x3e47b3[_0x5ed097][_0x40f1db(0x2a7)]=_0x1aac4f;}),_0x2c62c0[_0x1363f0(0x203)]((_0x59fbba,_0x524304)=>{var _0x3623bf=_0x1363f0;_0x3e47b3[_0x524304][_0x3623bf(0x2b3)]=_0x59fbba;}),_0x5f1a5c[_0x1363f0(0x203)]((_0x4a1095,_0x1524e4)=>{var _0xe33651=_0x1363f0;_0x3e47b3[_0x1524e4][_0xe33651(0x261)]=_0x4a1095;}),_0x59f969[_0x1363f0(0x203)]((_0x280473,_0x2f2455)=>{var _0x469fe6=_0x1363f0;_0x3e47b3[_0x2f2455][_0x469fe6(0x26f)]=_0x280473;}),_0x1d5b0e['forEach']((_0xf247d,_0x14e8b1)=>{var _0x1d1d35=_0x1363f0;_0x3e47b3[_0x14e8b1][_0x1d1d35(0x20d)]=_0xf247d;}),_0x146cc1[_0x1363f0(0x203)]((_0x454b3b,_0xb1406a)=>{_0x3e47b3[_0xb1406a]['maxPerUnit']=_0x454b3b;}),_0x1dd58e['forEach']((_0x42d2b7,_0x4f0e20)=>{var _0x327f11=_0x1363f0;_0x3e47b3[_0x4f0e20][_0x327f11(0x237)]=_0x42d2b7;}),_0x5530d6[_0x1363f0(0x203)]((_0x1b2048,_0x2472a6)=>{var _0x2c6401=_0x1363f0;_0x3e47b3[_0x2472a6][_0x2c6401(0x2bf)]=_0x1b2048;}),_0x4a9a9c[_0x1363f0(0x203)]((_0x212cd2,_0x15c8c0)=>{var _0x545b5d=_0x1363f0;_0x3e47b3[_0x15c8c0][_0x545b5d(0x2b5)]=_0x212cd2;});const _0x17e1ff=_0x3e47b3[_0x1363f0(0x234)](_0x54257b=>_0x54257b['to_quantity']!=='0'&&_0x54257b[_0x1363f0(0x224)]!==''||_0x54257b[_0x1363f0(0x220)]!=='0'&&_0x54257b[_0x1363f0(0x220)]!=='');var _0x142ece=0x0;_0x17e1ff[_0x1363f0(0x203)](_0xe54c65=>{var _0xd6540b=_0x1363f0;parseInt(_0xe54c65[_0xd6540b(0x287)])<parseInt(_0xe54c65['to_quantity'])&&_0x142ece++;});if(_0x142ece!=0x0)return _0x1dd212[_0x1363f0(0x28f)]('errors',_0x1363f0(0x265)),_0x56b7e4['redirect'](_0x1363f0(0x2ba));const _0xdb019c=new invoice_for_transfer();await _0xdb019c[_0x1363f0(0x22e)]();for(let _0x2bdb36=0x0;_0x2bdb36<=_0x4a9a9c['length']-0x1;_0x2bdb36++){_0x3e47b3[_0x2bdb36][_0x1363f0(0x232)]='TRF-'+_0xdb019c['invoice_init'][_0x1363f0(0x248)]()[_0x1363f0(0x267)](0x8,'0');}const _0x3e4318=new transfers_finished({'date':_0xb696c0,'from_warehouse':_0x494c69,'to_warehouse':_0x494c69,'product':_0x17e1ff,'note':_0x347d64,'invoice':_0x1363f0(0x241)+_0xdb019c[_0x1363f0(0x255)][_0x1363f0(0x248)]()['padStart'](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x1363f0(0x27b),'PO_number':_0x1bb795,'RequestedBy':_0x3c664b,'DateofRequest':_0x3beaf0,'typeservices':_0x386926,'destination':_0x2ba233,'deliverydate':_0x16f40e,'driver':_0x3bef7,'plate':_0xda4c9f,'van':_0x4ca83f,'DRSI':_0x59f90a,'typevehicle':_0xc13df8,'TSU':_0x175104,'TFU':_0x255ae2}),_0x302db2=await _0x3e4318[_0x1363f0(0x22e)]();_0x1dd212['flash']('success','Product\x20Transfer\x20successfully'),_0x56b7e4['redirect'](_0x1363f0(0x21b)+_0x302db2[_0x1363f0(0x25d)]);}catch(_0x361485){console[_0x1363f0(0x233)](_0x361485),_0x56b7e4['status'](0xc8)[_0x1363f0(0x286)]({'errorMessage':_0x361485['message']});}}),router[a0_0x1f9860(0x266)](a0_0x1f9860(0x2be),auth,async(_0x2fea46,_0x1cf06f)=>{var _0x27e369=a0_0x1f9860;try{const {date:_0x5b6284,from_warehouse:_0x4d1b9d,FromRoom_name:_0x10bf07,to_warehouse:_0x4780bb,ToRoom_name:_0x3191eb,prod_name:_0x1e97a0,from_prod_qty:_0x350044,from_prod_level:_0x404642,from_prod_isle:_0x12b357,from_prod_pallet:_0x3608b6,to_prod_qty:_0x2f179b,to_prod_level:_0x5ed0e1,to_prod_isle:_0x3095a2,to_prod_pallet:_0x2937c7,primary_code:_0x1e4fc2,secondary_code:_0x57e40a,product_code3:_0x5656fb,note:_0x4560c9,MaxStocks_data2:_0x467d85,invoice:_0xd59b4,expiry_date:_0x247ebf,PO_number_loc:_0x39d32a,ReqBy_loc:_0x35d55a,dateofreq_loc:_0x4b538b,typeservices_loc_Data:_0x2d4fcc,destination_loc:_0x4278a2,deliverydate_loc:_0x4381e5,driver_loc:_0x390719,plate_loc:_0x4cb5f5,van_loc:_0x4d5497,DRSI_loc:_0x38fa1e,typevehicle_loc:_0x5b5a15,TSU_loc:_0x147c4d,TFU_loc:_0x1a3f6b}=_0x2fea46[_0x27e369(0x276)];if(typeof _0x1e97a0==_0x27e369(0x22f))var _0x1b9753=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x210)]],_0x5614b5=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x1f8)]],_0x5a2194=[_0x2fea46['body'][_0x27e369(0x282)]],_0x3bf50b=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x298)]],_0x2e9781=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x2a1)]],_0x2af87b=[_0x2fea46[_0x27e369(0x276)]['primary_code']],_0x2c456d=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x227)]],_0x7c1fc4=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x226)]],_0x9bfef7=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x289)]],_0x161316=[_0x2fea46[_0x27e369(0x276)]['primary_unit']],_0x511b11=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x2a7)]],_0xefb085=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x2b3)]],_0x493be3=[_0x2fea46['body'][_0x27e369(0x261)]],_0xac3b48=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x24d)]],_0x2ac494=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x297)]],_0x1930f8=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x2ae)]],_0x273f05=[_0x2fea46['body'][_0x27e369(0x237)]],_0x4b566c=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x25e)]],_0xf57073=[_0x2fea46['body'][_0x27e369(0x21d)]],_0x5f2364=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x278)]],_0x5dddd2=[_0x2fea46[_0x27e369(0x276)][_0x27e369(0x2b6)]];else var _0x1b9753=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x210)]],_0x5614b5=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x1f8)]],_0x5a2194=[..._0x2fea46[_0x27e369(0x276)]['from_prod_level2']],_0x3bf50b=[..._0x2fea46['body'][_0x27e369(0x298)]],_0x2e9781=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x2a1)]],_0x2af87b=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x246)]],_0x2c456d=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x227)]],_0x7c1fc4=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x226)]],_0x9bfef7=[..._0x2fea46[_0x27e369(0x276)]['MaxStocks_data2']],_0x161316=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x2a3)]],_0x511b11=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x2a7)]],_0xefb085=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x2b3)]],_0x493be3=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x261)]],_0xac3b48=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x24d)]],_0x2ac494=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x297)]],_0x1930f8=[..._0x2fea46['body'][_0x27e369(0x2ae)]],_0x273f05=[..._0x2fea46[_0x27e369(0x276)]['prod_cat']],_0x4b566c=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x25e)]],_0xf57073=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x21d)]],_0x5f2364=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x278)]],_0x5dddd2=[..._0x2fea46[_0x27e369(0x276)][_0x27e369(0x2b6)]];const _0xbbeaa2=_0x1b9753[_0x27e369(0x2b2)](_0x47138=>{return _0x47138={'product_name':_0x47138};});_0x5614b5[_0x27e369(0x203)]((_0x46dc9f,_0x2ed395)=>{var _0x3804bd=_0x27e369;_0xbbeaa2[_0x2ed395][_0x3804bd(0x287)]=_0x46dc9f;}),_0x5a2194['forEach']((_0x319fe2,_0x520d7a)=>{var _0x1fc557=_0x27e369,_0x39dc0b=_0x319fe2[_0x1fc557(0x20c)](/[A-Za-z]+/)[0x0],_0x6f0002=parseInt(_0x319fe2[_0x1fc557(0x20c)](/\d+/)[0x0]);_0xbbeaa2[_0x520d7a]['from_bay']=_0x6f0002,_0xbbeaa2[_0x520d7a][_0x1fc557(0x27d)]=_0x39dc0b;}),_0x5dddd2[_0x27e369(0x203)]((_0x109754,_0x4c6aa4)=>{_0xbbeaa2[_0x4c6aa4]['id_transaction']=_0x109754;}),_0x5f2364[_0x27e369(0x203)]((_0x4dfa8c,_0x1f6434)=>{_0xbbeaa2[_0x1f6434]['from_invoice']=_0x4dfa8c;}),_0x3bf50b[_0x27e369(0x203)]((_0x51c04e,_0x4d37fb)=>{var _0x40d0c3=_0x27e369;_0xbbeaa2[_0x4d37fb][_0x40d0c3(0x224)]=_0x51c04e;}),_0x2e9781[_0x27e369(0x203)]((_0x645b63,_0x1bea1c)=>{var _0x1902a3=_0x27e369,_0x50b6a0=_0x645b63[_0x1902a3(0x20c)](/[A-Za-z]+/)[0x0],_0x4e2399=parseInt(_0x645b63[_0x1902a3(0x20c)](/\d+/)[0x0]);_0xbbeaa2[_0x1bea1c][_0x1902a3(0x26d)]=_0x50b6a0,_0xbbeaa2[_0x1bea1c][_0x1902a3(0x292)]=_0x4e2399;}),_0x2af87b['forEach']((_0x13ba87,_0x57874b)=>{_0xbbeaa2[_0x57874b]['primary_code']=_0x13ba87;}),_0x2c456d['forEach']((_0x3a84c4,_0x1ac9ae)=>{var _0x28b950=_0x27e369;_0xbbeaa2[_0x1ac9ae][_0x28b950(0x227)]=_0x3a84c4;}),_0x7c1fc4['forEach']((_0x2c6712,_0x3fea65)=>{_0xbbeaa2[_0x3fea65]['product_code']=_0x2c6712;}),_0x9bfef7[_0x27e369(0x203)]((_0xcab840,_0x1ecf25)=>{var _0x3053c4=_0x27e369;_0xbbeaa2[_0x1ecf25][_0x3053c4(0x20d)]=_0xcab840;}),_0x161316[_0x27e369(0x203)]((_0x188890,_0x3cd3f1)=>{var _0x5d4928=_0x27e369;_0xbbeaa2[_0x3cd3f1][_0x5d4928(0x260)]=_0x188890;}),_0x511b11[_0x27e369(0x203)]((_0x9ec008,_0x640393)=>{_0xbbeaa2[_0x640393]['secondary_unit']=_0x9ec008;}),_0xefb085['forEach']((_0x3b88fa,_0x585186)=>{var _0x48f15c=_0x27e369;_0xbbeaa2[_0x585186][_0x48f15c(0x2b3)]=_0x3b88fa;}),_0x493be3[_0x27e369(0x203)]((_0x162fae,_0x594717)=>{var _0x9167e9=_0x27e369;_0xbbeaa2[_0x594717][_0x9167e9(0x261)]=_0x162fae;}),_0xac3b48[_0x27e369(0x203)]((_0x1b2513,_0x1377c8)=>{var _0x40d512=_0x27e369;_0xbbeaa2[_0x1377c8][_0x40d512(0x26f)]=_0x1b2513;}),_0x2ac494[_0x27e369(0x203)]((_0x362885,_0xf31b77)=>{_0xbbeaa2[_0xf31b77]['maxProducts']=_0x362885;}),_0x1930f8[_0x27e369(0x203)]((_0x228887,_0x512e29)=>{_0xbbeaa2[_0x512e29]['maxPerUnit']=_0x228887;}),_0x273f05['forEach']((_0x299584,_0x276b14)=>{_0xbbeaa2[_0x276b14]['prod_cat']=_0x299584;}),_0x4b566c['forEach']((_0x45b059,_0x3e901f)=>{var _0x296f0b=_0x27e369;_0xbbeaa2[_0x3e901f][_0x296f0b(0x2bf)]=_0x45b059;}),_0xf57073[_0x27e369(0x203)]((_0x3a7b34,_0x2f1520)=>{_0xbbeaa2[_0x2f1520]['to_room_name']=_0x3a7b34;});const _0x5e9c58=_0xbbeaa2['filter'](_0x13db8c=>_0x13db8c['to_quantity']!=='0'&&_0x13db8c[_0x27e369(0x224)]!==''||_0x13db8c[_0x27e369(0x220)]!=='0'&&_0x13db8c[_0x27e369(0x220)]!=='');var _0x24e2e3=0x0;_0x5e9c58[_0x27e369(0x203)](_0x2fdde3=>{var _0x281241=_0x27e369;parseInt(_0x2fdde3[_0x281241(0x287)])<parseInt(_0x2fdde3['to_quantity'])&&_0x24e2e3++;});if(_0x24e2e3!=0x0)return _0x2fea46[_0x27e369(0x28f)](_0x27e369(0x280),_0x27e369(0x265)),_0x1cf06f[_0x27e369(0x1fd)](_0x27e369(0x2ba));const _0x2f39b6=new invoice_for_transfer();await _0x2f39b6[_0x27e369(0x22e)]();for(let _0x299d1b=0x0;_0x299d1b<=_0xf57073['length']-0x1;_0x299d1b++){_0xbbeaa2[_0x299d1b][_0x27e369(0x232)]=_0x27e369(0x241)+_0x2f39b6[_0x27e369(0x255)][_0x27e369(0x248)]()[_0x27e369(0x267)](0x8,'0');}const _0x34dad0=new transfers_finished({'date':_0x5b6284,'from_warehouse':_0x4d1b9d,'to_warehouse':_0x4780bb,'product':_0x5e9c58,'note':_0x4560c9,'invoice':'TRF-'+_0x2f39b6[_0x27e369(0x255)]['toString']()[_0x27e369(0x267)](0x8,'0'),'type_of_transaction':'own','type_of_process':_0x27e369(0x24f),'PO_number':_0x39d32a,'RequestedBy':_0x35d55a,'DateofRequest':_0x4b538b,'typeservices':_0x2d4fcc,'destination':_0x4278a2,'deliverydate':_0x4381e5,'driver':_0x390719,'plate':_0x4cb5f5,'van':_0x4d5497,'DRSI':_0x38fa1e,'typevehicle':_0x5b5a15,'TSU':_0x147c4d,'TFU':_0x1a3f6b}),_0x281ea9=await _0x34dad0[_0x27e369(0x22e)]();_0x2fea46['flash'](_0x27e369(0x23c),'Product\x20Transfer\x20successfully'),_0x1cf06f['redirect'](_0x27e369(0x21b)+_0x281ea9[_0x27e369(0x25d)]);}catch(_0x1d0999){console[_0x27e369(0x233)](_0x1d0999),_0x1cf06f[_0x27e369(0x222)](0xc8)[_0x27e369(0x286)]({'errorMessage':_0x1d0999[_0x27e369(0x2ac)]});}}),router['get']('/preview/:id',auth,async(_0x457d04,_0x9436f5)=>{var _0x78653c=a0_0x1f9860;try{const {username:_0x46ce84,email:_0xa349e,role:_0x308428}=_0x457d04['user'],_0x617815=_0x457d04['user'],_0x128738=await profile[_0x78653c(0x2b9)]({'email':_0x617815[_0x78653c(0x22d)]}),_0x28af18=await master_shop['find'](),_0x2e92a4=await transfers_finished[_0x78653c(0x208)](_0x457d04[_0x78653c(0x29a)]['id']);let _0x3e37d5;if(_0x617815[_0x78653c(0x245)]=='staff'){const _0x47a420=await staff[_0x78653c(0x2b9)]({'email':_0x617815[_0x78653c(0x22d)]});_0x3e37d5=await warehouse[_0x78653c(0x262)]({'status':_0x78653c(0x273),'name':_0x47a420['warehouse'],'warehouse_category':_0x78653c(0x279)});}else _0x3e37d5=await warehouse[_0x78653c(0x262)]({'status':'Enabled','warehouse_category':_0x78653c(0x279)});const _0x3c9b31=await warehouse[_0x78653c(0x218)]([{'$match':{'name':_0x2e92a4[_0x78653c(0x29e)],'warehouse_category':_0x78653c(0x279)}},{'$unwind':_0x78653c(0x252)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x78653c(0x2bc)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x78653c(0x2a9)},'bin':{'$first':_0x78653c(0x24b)},'type':{'$first':_0x78653c(0x211)},'floorlevel':{'$first':_0x78653c(0x1f6)},'primary_code':{'$first':_0x78653c(0x283)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x78653c(0x299)},'storage':{'$first':_0x78653c(0x259)},'rack':{'$first':_0x78653c(0x28a)},'expiry_date':{'$first':_0x78653c(0x201)},'production_date':{'$first':_0x78653c(0x268)},'room':{'$first':'$room'},'warehoue_name':{'$first':'$name'}}}]),_0x553b56=await product[_0x78653c(0x262)]({});if(_0x28af18[0x0][_0x78653c(0x22a)]=='English\x20(US)'){var _0x4c00c7=users['English'];console[_0x78653c(0x233)](_0x4c00c7);}else{if(_0x28af18[0x0]['language']==_0x78653c(0x27c))var _0x4c00c7=users[_0x78653c(0x27c)];else{if(_0x28af18[0x0]['language']=='German')var _0x4c00c7=users['German'];else{if(_0x28af18[0x0][_0x78653c(0x22a)]==_0x78653c(0x209))var _0x4c00c7=users[_0x78653c(0x209)];else{if(_0x28af18[0x0][_0x78653c(0x22a)]==_0x78653c(0x2ad))var _0x4c00c7=users[_0x78653c(0x2ad)];else{if(_0x28af18[0x0]['language']==_0x78653c(0x1fb))var _0x4c00c7=users['Portuguese'];else{if(_0x28af18[0x0]['language']==_0x78653c(0x294))var _0x4c00c7=users[_0x78653c(0x294)];else{if(_0x28af18[0x0]['language']=='Arabic\x20(ae)')var _0x4c00c7=users['Arabic'];}}}}}}}_0x9436f5['render'](_0x78653c(0x281),{'success':_0x457d04[_0x78653c(0x28f)](_0x78653c(0x23c)),'errors':_0x457d04[_0x78653c(0x28f)](_0x78653c(0x280)),'role':_0x617815,'profile':_0x128738,'master_shop':_0x28af18,'warehouse':_0x3e37d5,'transfer':_0x2e92a4,'stock':_0x3c9b31,'unit':_0x553b56,'language':_0x4c00c7});}catch(_0x51f533){console[_0x78653c(0x233)](_0x51f533);}}),router[a0_0x1f9860(0x266)](a0_0x1f9860(0x26a),auth,async(_0x242e74,_0x2e99a1)=>{var _0x466755=a0_0x1f9860;try{const {invoice:_0x14581e,from_warehouse:_0x41115e,FromRoom_name:_0x19c8f4,to_warehouse:_0x48d547,ToRoom_name:_0x14e70a}=_0x242e74[_0x466755(0x276)],_0x5d4988=await transfers_finished[_0x466755(0x208)](_0x242e74[_0x466755(0x29a)]['id']),_0x585286=_0x5d4988['product']['map'](async _0x3ccaee=>{var _0x546c13=_0x466755;if(_0x3ccaee[_0x546c13(0x224)]>0x0){var _0xa7ae3b=await warehouse[_0x546c13(0x2b9)]({'name':_0x41115e,'room':_0x3ccaee[_0x546c13(0x2bf)]});const _0x110f74=_0xa7ae3b[_0x546c13(0x27a)]['map'](_0x2ba2f0=>{var _0x5296ac=_0x546c13;_0x2ba2f0['_id']==_0x3ccaee[_0x5296ac(0x2b6)]&&(_0x2ba2f0[_0x5296ac(0x207)]=Math['max'](0x0,Math[_0x5296ac(0x249)](_0x2ba2f0[_0x5296ac(0x207)])-Math[_0x5296ac(0x249)](_0x3ccaee[_0x5296ac(0x224)])),console[_0x5296ac(0x233)](_0x2ba2f0[_0x5296ac(0x207)]));});}return _0xa7ae3b;});Promise[_0x466755(0x2a8)](_0x585286)[_0x466755(0x238)](async _0x20fdc0=>{var _0xaecbf1=_0x466755;try{for(const _0x20f1e8 of _0x20fdc0){await _0x20f1e8[_0xaecbf1(0x22e)]();}const _0x5564f5=_0x5d4988[_0xaecbf1(0x2a6)][_0xaecbf1(0x2b2)](async _0x2cde45=>{var _0x7e4418=_0xaecbf1,_0x482534=await warehouse['findOne']({'name':_0x48d547,'room':_0x2cde45[_0x7e4418(0x2b5)]});if(_0x2cde45[_0x7e4418(0x224)]>0x0){var _0x3dfa27=0x0;const _0x3e03bc=_0x482534[_0x7e4418(0x27a)][_0x7e4418(0x2b2)](_0x4aa9ca=>{var _0xfb7786=_0x7e4418;_0x4aa9ca[_0xfb7786(0x1fa)]==_0x2cde45['product_name']&&_0x4aa9ca[_0xfb7786(0x225)]==_0x2cde45[_0xfb7786(0x292)]&&_0x4aa9ca[_0xfb7786(0x261)]==_0x2cde45['expiry_date']&&_0x4aa9ca[_0xfb7786(0x26f)]==_0x2cde45['production_date']&&_0x4aa9ca['batch_code']==_0x2cde45[_0xfb7786(0x2b3)]&&_0x4aa9ca[_0xfb7786(0x22c)]==_0x2cde45[_0xfb7786(0x232)]&&(typeof _0x2cde45[_0xfb7786(0x2b6)]==_0xfb7786(0x235)?(console[_0xfb7786(0x233)](_0xfb7786(0x25c),_0x4aa9ca['product_stock']+_0xfb7786(0x2a4)+_0x4aa9ca['_id']+_0xfb7786(0x20e)+Math['abs'](_0x4aa9ca['product_stock'])+Math[_0xfb7786(0x249)](_0x2cde45[_0xfb7786(0x224)])),_0x4aa9ca['product_stock']=Math[_0xfb7786(0x249)](_0x4aa9ca[_0xfb7786(0x207)])+Math['abs'](_0x2cde45[_0xfb7786(0x224)])):_0x4aa9ca[_0xfb7786(0x207)]=Math[_0xfb7786(0x249)](_0x4aa9ca[_0xfb7786(0x207)])+Math[_0xfb7786(0x249)](_0x2cde45['to_quantity']),_0x3dfa27++);});_0x3dfa27=='0'&&(_0x482534[_0x7e4418(0x27a)]=_0x482534[_0x7e4418(0x27a)][_0x7e4418(0x29b)]({'product_name':_0x2cde45[_0x7e4418(0x1fa)],'product_stock':_0x2cde45[_0x7e4418(0x224)],'bay':_0x2cde45[_0x7e4418(0x292)],'level':_0x2cde45['to_level'],'product_code':_0x2cde45[_0x7e4418(0x24e)],'primary_code':_0x2cde45[_0x7e4418(0x246)],'secondary_code':_0x2cde45[_0x7e4418(0x227)],'expiry_date':_0x2cde45['expiry_date'],'production_date':_0x2cde45[_0x7e4418(0x26f)],'maxProducts':_0x2cde45['maxProducts'],'batch_code':_0x2cde45[_0x7e4418(0x2b3)],'secondary_unit':_0x2cde45[_0x7e4418(0x2a7)],'unit':_0x2cde45['unit'],'maxProducts':_0x2cde45[_0x7e4418(0x20d)],'maxPerUnit':_0x2cde45[_0x7e4418(0x2ae)],'invoice':_0x2cde45[_0x7e4418(0x232)]}));}return _0x482534;});Promise['all'](_0x5564f5)[_0xaecbf1(0x238)](async _0x1688e5=>{var _0x4e357b=_0xaecbf1;try{console[_0x4e357b(0x233)](_0x5d4988['type_of_process']);if(_0x5d4988[_0x4e357b(0x240)]!=_0x4e357b(0x24f))for(const _0x359d33 of _0x1688e5){await warehouse[_0x4e357b(0x2a5)]({'_id':_0x359d33[_0x4e357b(0x25d)]},{'$addToSet':{'product_details':{'$each':_0x359d33['product_details']}}});}_0x5d4988[_0x4e357b(0x215)]=_0x4e357b(0x2b0);const _0x15fc42=await _0x5d4988[_0x4e357b(0x22e)](),_0x33235d=await master_shop[_0x4e357b(0x262)](),_0x49ca25=await email_settings[_0x4e357b(0x2b9)](),_0x15f747=await supervisor_settings['find']();var _0x52e036=_0x5d4988[_0x4e357b(0x2a6)],_0x2700a6='',_0x38e454;for(_0x38e454 in _0x52e036){var _0x2e4996='FG';_0x5d4988[_0x4e357b(0x21f)]==_0x4e357b(0x1fe)&&(_0x2e4996='DG'),_0x2700a6+=_0x4e357b(0x204)+_0x4e357b(0x26b)+_0x52e036[_0x38e454][_0x4e357b(0x1fa)]+_0x4e357b(0x216)+_0x4e357b(0x26b)+_0x52e036[_0x38e454][_0x4e357b(0x24e)]+_0x4e357b(0x216)+_0x4e357b(0x26b)+_0x52e036[_0x38e454]['to_quantity']+_0x4e357b(0x216)+_0x4e357b(0x26b)+_0x52e036[_0x38e454][_0x4e357b(0x260)]+_0x4e357b(0x216)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x52e036[_0x38e454][_0x4e357b(0x2a7)]+_0x4e357b(0x216)+_0x4e357b(0x26b)+_0x5d4988[_0x4e357b(0x21f)]+_0x4e357b(0x216)+_0x4e357b(0x26b)+_0x52e036[_0x38e454][_0x4e357b(0x2b5)]+'</td>'+_0x4e357b(0x26b)+_0x2e4996+_0x52e036[_0x38e454][_0x4e357b(0x292)]+_0x4e357b(0x216)+_0x4e357b(0x212);}_0x242e74[_0x4e357b(0x28f)](_0x4e357b(0x23c),'Transfer\x20Finalize\x20Successfully'),_0x2e99a1['redirect']('/picking_list/PDF_transfer/'+_0x15fc42[_0x4e357b(0x25d)]);}catch(_0x16ce48){console[_0x4e357b(0x251)](_0x16ce48),_0x2e99a1[_0x4e357b(0x222)](0x1f4)[_0x4e357b(0x286)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0xaecbf1(0x270)](_0x2abd51=>{var _0xb982bb=_0xaecbf1;console['error'](_0x2abd51),_0x2e99a1[_0xb982bb(0x222)](0x1f4)[_0xb982bb(0x286)]({'error':_0xb982bb(0x219)});});}catch(_0x3867e1){console[_0xaecbf1(0x251)](_0x3867e1),_0x2e99a1[_0xaecbf1(0x222)](0x1f4)['json']({'error':_0xaecbf1(0x243)});}})[_0x466755(0x270)](_0x22996c=>{var _0x2e3635=_0x466755;console[_0x2e3635(0x251)](_0x22996c),_0x2e99a1['status'](0x1f4)[_0x2e3635(0x286)]({'error':_0x2e3635(0x219)});});}catch(_0x4584c1){_0x2e99a1['json']({'message':_0x4584c1[_0x466755(0x2ac)]});}});function BayBinSelected(_0x2ba162,_0xcd0e8b){var _0x5efada=a0_0x1f9860,_0x25f88a=[];let _0x161715=[];var _0xc463af=[];if(_0x2ba162==_0x5efada(0x1fe)){switch(_0xcd0e8b){case'Rack\x201':_0x25f88a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x25f88a=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0xc463af=['DG'];}else{if(_0x2ba162==_0x5efada(0x25a)){switch(_0xcd0e8b){case'Rack\x201':_0x25f88a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x5efada(0x27e):_0x25f88a=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0xc463af=['FG'];}}return{'levels':_0x25f88a,'identify':_0xc463af};}router[a0_0x1f9860(0x271)](a0_0x1f9860(0x20f),auth,async(_0x5baf90,_0x366b52)=>{var _0x2f99f0=a0_0x1f9860;try{const {username:_0x5f5345,email:_0x190525,role:_0x5e7aa7}=_0x5baf90['user'],_0x13de5f=_0x5baf90[_0x2f99f0(0x217)],_0x3fb45c=await profile[_0x2f99f0(0x2b9)]({'email':_0x13de5f[_0x2f99f0(0x22d)]}),_0x275bfc=await master_shop[_0x2f99f0(0x262)](),_0x23a9f8=await transfers_finished[_0x2f99f0(0x208)](_0x5baf90[_0x2f99f0(0x29a)]['id']);let _0x4545bb=new Date(_0x23a9f8['expiry_date']),_0x438b2b=('0'+_0x4545bb['getDate']())[_0x2f99f0(0x263)](-0x2),_0x337571=('0'+(_0x4545bb[_0x2f99f0(0x21e)]()+0x1))['slice'](-0x2),_0x5ac48e=_0x4545bb['getFullYear'](),_0xbb8428=_0x5ac48e+'-'+_0x337571+'-'+_0x438b2b,_0x5d2685;if(_0x13de5f[_0x2f99f0(0x245)]=='staff'){const _0x55483e=await staff['findOne']({'email':_0x13de5f[_0x2f99f0(0x22d)]});_0x5d2685=await warehouse[_0x2f99f0(0x262)]({'status':'Enabled','name':_0x55483e[_0x2f99f0(0x2ab)],'warehouse_category':'Finished\x20Goods'});}else _0x5d2685=await warehouse['find']({'status':_0x2f99f0(0x273),'warehouse_category':'Finished\x20Goods'});const _0x262d7a=await warehouse[_0x2f99f0(0x218)]([{'$match':{'name':_0x23a9f8[_0x2f99f0(0x29e)],'room':_0x23a9f8[_0x2f99f0(0x23d)]}},{'$unwind':_0x2f99f0(0x252)},{'$group':{'_id':_0x2f99f0(0x239),'name':{'$first':_0x2f99f0(0x2bc)},'product_stock':{'$first':_0x2f99f0(0x25f)},'bay':{'$first':_0x2f99f0(0x2a9)},'bin':{'$first':_0x2f99f0(0x24b)},'type':{'$first':_0x2f99f0(0x211)},'floorlevel':{'$first':_0x2f99f0(0x1f6)},'primary_code':{'$first':_0x2f99f0(0x283)},'secondary_code':{'$first':_0x2f99f0(0x253)},'product_code':{'$first':_0x2f99f0(0x299)},'storage':{'$first':_0x2f99f0(0x259)},'rack':{'$first':_0x2f99f0(0x28a)}}}]);var _0x1f7899=[0x1,0x2,0x3,0x4],_0x40ab55=['A','B','C','D','E','F','G','H','I','J'],_0x5d9cad=['Ambient',_0x2f99f0(0x290)];const _0x4dd6f7=await product[_0x2f99f0(0x262)]({}),_0x35e964=BayBinSelected(_0x23a9f8['to_warehouse'],_0x23a9f8[_0x2f99f0(0x27f)]);if(_0x275bfc[0x0][_0x2f99f0(0x22a)]==_0x2f99f0(0x205)){var _0x53d052=users[_0x2f99f0(0x2b1)];console[_0x2f99f0(0x233)](_0x53d052);}else{if(_0x275bfc[0x0]['language']==_0x2f99f0(0x27c))var _0x53d052=users['Hindi'];else{if(_0x275bfc[0x0][_0x2f99f0(0x22a)]==_0x2f99f0(0x1f5))var _0x53d052=users[_0x2f99f0(0x1f5)];else{if(_0x275bfc[0x0][_0x2f99f0(0x22a)]=='Spanish')var _0x53d052=users[_0x2f99f0(0x209)];else{if(_0x275bfc[0x0]['language']==_0x2f99f0(0x2ad))var _0x53d052=users[_0x2f99f0(0x2ad)];else{if(_0x275bfc[0x0][_0x2f99f0(0x22a)]==_0x2f99f0(0x1fb))var _0x53d052=users[_0x2f99f0(0x296)];else{if(_0x275bfc[0x0][_0x2f99f0(0x22a)]=='Chinese')var _0x53d052=users[_0x2f99f0(0x294)];else{if(_0x275bfc[0x0]['language']==_0x2f99f0(0x258))var _0x53d052=users[_0x2f99f0(0x2aa)];}}}}}}}_0x366b52['render'](_0x2f99f0(0x285),{'success':_0x5baf90[_0x2f99f0(0x28f)]('success'),'errors':_0x5baf90['flash'](_0x2f99f0(0x280)),'role':_0x13de5f,'profile':_0x3fb45c,'master_shop':_0x275bfc,'warehouse':_0x5d2685,'transfer':_0x23a9f8,'stock':_0x262d7a,'unit':_0x4dd6f7,'language':_0x53d052,'levels':_0x1f7899,'Isle':_0x40ab55,'rooms_data':_0x5d9cad,'ed_fullDate':_0xbb8428,'dataSelected':_0x35e964});}catch(_0x13a41f){console[_0x2f99f0(0x233)](_0x13a41f);}}),router['post'](a0_0x1f9860(0x20f),auth,async(_0xdded8e,_0x3f047b)=>{var _0x38a565=a0_0x1f9860;try{const _0x4416f2=_0xdded8e['params']['id'];console[_0x38a565(0x233)](_0xdded8e[_0x38a565(0x276)]);const _0x2fdbb3=await transfers_finished[_0x38a565(0x208)](_0x4416f2);console[_0x38a565(0x233)](_0x38a565(0x28c),_0x2fdbb3);const {date:_0x1f895f,from_warehouse:_0x437383,FromRoom_name:_0x4f7a16,to_warehouse:_0x2b2cff,ToRoom_name:_0x4502d3,prod_name:_0x203301,from_prod_qty:_0x1544e9,from_prod_level:_0x331184,from_prod_isle:_0x33b1de,from_prod_pallet:_0x4fa9c6,to_prod_qty:_0x319c49,to_prod_level:_0x477d66,to_prod_isle:_0x482812,to_prod_pallet:_0xcb112f,primary_code:_0x1a54de,secondary_code:_0x21f693,product_code3:_0x325c8e,note:_0x4ec084,invoice:_0x5d3823,expiry_date:_0x727799}=_0xdded8e[_0x38a565(0x276)];if(typeof _0x203301==_0x38a565(0x22f))var _0x17c5ab=[_0xdded8e[_0x38a565(0x276)]['prod_name']],_0x70d7a9=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x1f8)]],_0x100c1e=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x21a)]],_0x5e91c0=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x269)]],_0x534349=[_0xdded8e[_0x38a565(0x276)]['to_prod_level']],_0x4fb16d=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x246)]],_0x1370cd=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x227)]],_0x2e7b6e=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x226)]],_0x42744a=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x289)]],_0xff60f1=[_0xdded8e['body']['unit']],_0x4270f4=[_0xdded8e['body']['secondary_unit']],_0x4b163c=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x2b3)]],_0x14d72d=[_0xdded8e[_0x38a565(0x276)][_0x38a565(0x261)]];else var _0x17c5ab=[..._0xdded8e[_0x38a565(0x276)][_0x38a565(0x210)]],_0x70d7a9=[..._0xdded8e['body'][_0x38a565(0x1f8)]],_0x100c1e=[..._0xdded8e['body'][_0x38a565(0x21a)]],_0x5e91c0=[..._0xdded8e['body'][_0x38a565(0x269)]],_0x534349=[..._0xdded8e['body'][_0x38a565(0x2a1)]],_0x4fb16d=[..._0xdded8e['body'][_0x38a565(0x246)]],_0x1370cd=[..._0xdded8e['body'][_0x38a565(0x227)]],_0x2e7b6e=[..._0xdded8e['body'][_0x38a565(0x226)]],_0x42744a=[..._0xdded8e['body']['MaxStocks_data2']],_0xff60f1=[..._0xdded8e['body'][_0x38a565(0x260)]],_0x4270f4=[..._0xdded8e[_0x38a565(0x276)]['secondary_unit']],_0x4b163c=[..._0xdded8e[_0x38a565(0x276)][_0x38a565(0x2b3)]],_0x14d72d=[..._0xdded8e[_0x38a565(0x276)]['expiry_date']];const _0x5a5df1=_0x17c5ab[_0x38a565(0x2b2)](_0x3794df=>{return _0x3794df={'product_name':_0x3794df};});_0x70d7a9[_0x38a565(0x203)]((_0x1e8116,_0x1d7a25)=>{var _0xc3dd71=_0x38a565;_0x5a5df1[_0x1d7a25][_0xc3dd71(0x287)]=_0x1e8116;}),_0x100c1e['forEach']((_0x2d1a85,_0x45c507)=>{var _0x365866=_0x38a565;_0x5a5df1[_0x45c507][_0x365866(0x23a)]=_0x2d1a85;}),_0x5e91c0[_0x38a565(0x203)]((_0x48b225,_0x4646ce)=>{var _0x11f382=_0x38a565;_0x5a5df1[_0x4646ce][_0x11f382(0x224)]=_0x48b225;}),_0x534349[_0x38a565(0x203)]((_0x57d370,_0x146308)=>{var _0x65e1cf=_0x38a565;_0x5a5df1[_0x146308][_0x65e1cf(0x292)]=_0x57d370;}),_0x4fb16d['forEach']((_0x1a4a63,_0x1a49bb)=>{var _0x32e129=_0x38a565;_0x5a5df1[_0x1a49bb][_0x32e129(0x246)]=_0x1a4a63;}),_0x1370cd['forEach']((_0xd96f43,_0x2fb9bf)=>{var _0x3d32ba=_0x38a565;_0x5a5df1[_0x2fb9bf][_0x3d32ba(0x227)]=_0xd96f43;}),_0x2e7b6e[_0x38a565(0x203)]((_0x17461c,_0x55dfc0)=>{var _0x45e588=_0x38a565;_0x5a5df1[_0x55dfc0][_0x45e588(0x24e)]=_0x17461c;}),_0x42744a[_0x38a565(0x203)]((_0x4d6c90,_0x5e57d6)=>{var _0x302d4f=_0x38a565;_0x5a5df1[_0x5e57d6][_0x302d4f(0x20d)]=_0x4d6c90;}),_0xff60f1[_0x38a565(0x203)]((_0x5d0190,_0x4a0972)=>{var _0x168655=_0x38a565;_0x5a5df1[_0x4a0972][_0x168655(0x260)]=_0x5d0190;}),_0x4270f4[_0x38a565(0x203)]((_0x329b7e,_0x5b86f9)=>{var _0x1e3643=_0x38a565;_0x5a5df1[_0x5b86f9][_0x1e3643(0x2a7)]=_0x329b7e;}),_0x4b163c[_0x38a565(0x203)]((_0x6e0ebc,_0x47147a)=>{var _0x4ad6c1=_0x38a565;_0x5a5df1[_0x47147a][_0x4ad6c1(0x2b3)]=_0x6e0ebc;}),_0x14d72d[_0x38a565(0x203)]((_0x56a65e,_0x4065c5)=>{_0x5a5df1[_0x4065c5]['expiry_date']=_0x56a65e;});const _0x3570f2=_0x5a5df1[_0x38a565(0x234)](_0x25fa0b=>_0x25fa0b['to_quantity']!=='0'&&_0x25fa0b[_0x38a565(0x224)]!==''||_0x25fa0b['to_floorlevel']!=='0'&&_0x25fa0b['to_floorlevel']!=='');var _0x4cdb68=0x0;_0x3570f2[_0x38a565(0x203)](_0x136bd9=>{var _0x524129=_0x38a565;parseInt(_0x136bd9[_0x524129(0x287)])<parseInt(_0x136bd9[_0x524129(0x224)])&&_0x4cdb68++;});if(_0x4cdb68!=0x0)return _0xdded8e[_0x38a565(0x28f)]('errors',_0x38a565(0x265)),_0x3f047b['redirect'](_0x38a565(0x2ba));const _0x14f215=await warehouse[_0x38a565(0x2b9)]({'name':_0x2fdbb3['from_warehouse'],'room':_0x2fdbb3[_0x38a565(0x23d)]});_0x2fdbb3[_0x38a565(0x2a6)][_0x38a565(0x203)](_0x39464f=>{var _0x37df0f=_0x38a565;if(_0x39464f[_0x37df0f(0x224)]>0x0){const _0x759c65=_0x14f215[_0x37df0f(0x27a)]['map'](_0x596996=>{var _0x21280c=_0x37df0f;_0x596996[_0x21280c(0x1fa)]==_0x39464f[_0x21280c(0x1fa)]&&_0x596996[_0x21280c(0x225)]==_0x39464f[_0x21280c(0x23a)]&&(_0x596996[_0x21280c(0x207)]=parseInt(_0x596996[_0x21280c(0x207)])+parseInt(_0x39464f[_0x21280c(0x224)]));});}}),await _0x14f215['save']();const _0x2f206e=await warehouse['findOne']({'name':_0x2fdbb3['to_warehouse'],'room':_0x2fdbb3[_0x38a565(0x27f)]});_0x2fdbb3[_0x38a565(0x2a6)][_0x38a565(0x203)](_0x193874=>{var _0x5b98c8=_0x38a565;if(_0x193874[_0x5b98c8(0x224)]>0x0){const _0x55d344=_0x2f206e[_0x5b98c8(0x27a)]['map'](_0x13173e=>{var _0x3428a5=_0x5b98c8;_0x13173e[_0x3428a5(0x1fa)]==_0x193874[_0x3428a5(0x1fa)]&&_0x13173e[_0x3428a5(0x225)]==_0x193874[_0x3428a5(0x292)]&&(_0x13173e[_0x3428a5(0x207)]=parseInt(_0x13173e['product_stock'])-parseInt(_0x193874[_0x3428a5(0x224)]));});}}),await _0x2f206e[_0x38a565(0x22e)](),_0x2fdbb3[_0x38a565(0x24c)]=_0x1f895f,_0x2fdbb3['from_warehouse']=_0x437383,_0x2fdbb3[_0x38a565(0x21f)]=_0x2b2cff,_0x2fdbb3[_0x38a565(0x2a6)]=_0x3570f2,_0x2fdbb3[_0x38a565(0x2b7)]=_0x4ec084,_0x2fdbb3[_0x38a565(0x22c)]=_0x5d3823;const _0x173029=await _0x2fdbb3['save'](),_0x19f731=await warehouse['findOne']({'name':_0x437383,'room':_0x4f7a16});_0x173029[_0x38a565(0x2a6)][_0x38a565(0x203)](_0x7f80fd=>{var _0x117635=_0x38a565;if(_0x7f80fd[_0x117635(0x224)]>0x0){const _0x249af7=_0x19f731[_0x117635(0x27a)]['map'](_0x1fd621=>{var _0x28531e=_0x117635;_0x1fd621[_0x28531e(0x1fa)]==_0x7f80fd[_0x28531e(0x1fa)]&&_0x1fd621[_0x28531e(0x225)]==_0x7f80fd[_0x28531e(0x23a)]&&(_0x1fd621[_0x28531e(0x207)]=parseInt(_0x1fd621[_0x28531e(0x207)])-parseInt(_0x7f80fd[_0x28531e(0x224)]));});}}),await _0x19f731[_0x38a565(0x22e)]();const _0x411903=await warehouse[_0x38a565(0x2b9)]({'name':_0x2b2cff,'room':_0x4502d3});_0x173029[_0x38a565(0x2a6)][_0x38a565(0x203)](_0x48cdf2=>{var _0x2c9d0c=_0x38a565;if(_0x48cdf2[_0x2c9d0c(0x224)]>0x0){var _0x2f74a3=0x0;const _0x2369b8=_0x411903['product_details'][_0x2c9d0c(0x2b2)](_0x172749=>{var _0xf7b330=_0x2c9d0c;_0x172749['product_name']==_0x48cdf2['product_name']&&_0x172749[_0xf7b330(0x225)]==_0x48cdf2[_0xf7b330(0x292)]&&(_0x172749[_0xf7b330(0x207)]=parseInt(_0x172749[_0xf7b330(0x207)])+parseInt(_0x48cdf2[_0xf7b330(0x224)]),_0x2f74a3++);});_0x2f74a3=='0'&&(_0x411903['product_details']=_0x411903['product_details']['concat']({'product_name':_0x48cdf2[_0x2c9d0c(0x1fa)],'product_stock':_0x48cdf2[_0x2c9d0c(0x224)],'bay':_0x48cdf2[_0x2c9d0c(0x292)],'product_code':_0x48cdf2[_0x2c9d0c(0x24e)],'primary_code':_0x48cdf2[_0x2c9d0c(0x246)],'secondary_code':_0x48cdf2[_0x2c9d0c(0x227)],'maxProducts':_0x48cdf2[_0x2c9d0c(0x20d)]}));}}),await _0x411903[_0x38a565(0x22e)](),_0xdded8e[_0x38a565(0x28f)](_0x38a565(0x23c),_0x38a565(0x23e)),_0x3f047b[_0x38a565(0x1fd)](_0x38a565(0x291));}catch(_0x4219f8){console['log'](_0x4219f8);}}),router[a0_0x1f9860(0x266)](a0_0x1f9860(0x1f7),async(_0xb819a4,_0x4ddd47)=>{var _0x2bdf2f=a0_0x1f9860;const {FromWareHouse:_0x3f5893,FromRoom:_0x47ca16,ToWarehouse:_0x4eaf27,ToRoom:_0x17606b,primary_code:_0x2dfda9,Roomslist:_0x26197d}=_0xb819a4[_0x2bdf2f(0x276)],_0x35bfa4=_0x26197d[_0x2bdf2f(0x242)](','),_0x24e064=[];async function _0x2b2f7f(_0x1a21b0){var _0x42ac7f=_0x2bdf2f;const _0x200c61=await warehouse[_0x42ac7f(0x218)]([{'$match':{'name':_0x3f5893,'room':_0x1a21b0}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2dfda9}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x42ac7f(0x2bc)},'instock':{'$first':_0x42ac7f(0x25f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x42ac7f(0x253)},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':'$product_details.bay'},'level':{'$first':_0x42ac7f(0x202)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x42ac7f(0x28d)},'storage':{'$first':_0x42ac7f(0x259)},'rack':{'$first':_0x42ac7f(0x28a)},'expiry_date':{'$first':_0x42ac7f(0x201)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x42ac7f(0x288)},'maxPerUnit':{'$first':_0x42ac7f(0x28b)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x42ac7f(0x221)}}}]),_0x2ca2df=await warehouse[_0x42ac7f(0x218)]([{'$match':{'name':_0x3f5893,'room':_0x1a21b0}},{'$unwind':_0x42ac7f(0x252)},{'$match':{'product_details.secondary_code':_0x2dfda9}},{'$group':{'_id':_0x42ac7f(0x239),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x42ac7f(0x25f)},'primary_code':{'$first':_0x42ac7f(0x283)},'secondary_code':{'$first':_0x42ac7f(0x253)},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x42ac7f(0x2a9)},'level':{'$first':_0x42ac7f(0x202)},'type':{'$first':_0x42ac7f(0x211)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x42ac7f(0x20a)},'secondary_unit':{'$first':_0x42ac7f(0x28d)},'storage':{'$first':_0x42ac7f(0x259)},'rack':{'$first':_0x42ac7f(0x28a)},'expiry_date':{'$first':_0x42ac7f(0x201)},'production_date':{'$first':_0x42ac7f(0x268)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x42ac7f(0x28b)},'roomNamed':{'$first':_0x42ac7f(0x295)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x42ac7f(0x221)}}}]);if(_0x200c61[_0x42ac7f(0x213)]>0x0)_0x24e064['push'](_0x200c61);else _0x2ca2df[_0x42ac7f(0x213)]>0x0&&_0x24e064[_0x42ac7f(0x254)](_0x2ca2df);}const _0x61f088=_0x35bfa4[_0x2bdf2f(0x2b2)](_0x40cd18=>_0x2b2f7f(_0x40cd18));await Promise[_0x2bdf2f(0x2a8)](_0x61f088),_0x4ddd47[_0x2bdf2f(0x286)](_0x24e064);}),router[a0_0x1f9860(0x266)](a0_0x1f9860(0x257),async(_0x4295ac,_0x5327b6)=>{var _0x3be61b=a0_0x1f9860;const {productCode:_0x4ae0dc,bay:_0x236f07,warehouses:_0x399570,room:_0x140b70}=_0x4295ac[_0x3be61b(0x276)];console[_0x3be61b(0x233)](_0x4295ac[_0x3be61b(0x276)]);try{const _0x2ca7db=await warehouse[_0x3be61b(0x218)]([{'$match':{'name':_0x399570,'room':_0x140b70}},{'$unwind':_0x3be61b(0x252)},{'$match':{'product_details.bay':parseInt(_0x236f07)}},{'$group':{'_id':_0x3be61b(0x239),'name':{'$first':_0x3be61b(0x2bc)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3be61b(0x2a9)},'maxProducts':{'$first':_0x3be61b(0x223)}}}]);_0x5327b6[_0x3be61b(0x222)](0xc8)[_0x3be61b(0x286)](_0x2ca7db);}catch(_0x54e40f){_0x5327b6[_0x3be61b(0x222)](0x194)[_0x3be61b(0x286)]({'message':_0x54e40f[_0x3be61b(0x2ac)]});}}),module[a0_0x1f9860(0x21c)]=router;