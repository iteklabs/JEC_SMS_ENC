var a0_0x17edbc=a0_0x1aca;function a0_0x29c2(){var _0x4b69a8=['There\x27s\x20a\x20error\x20in\x20this\x20transaction','from_prod_qty','flash','from_quantity','Arabic\x20(ae)','getMonth','MaxStocks_data','$finalize','$product_details.secondary_code','$invoice','to_room','400834RPjolB','product_code','from_level','$product_details.product_name','match','get','$product_details.product_code','</td>','Portuguese\x20(BR)','/view/add_transfer_loc','$product.to_room_name','$product_details.expiry_date','invoice_init','primary_unit','2266976eGjZej','RoomAssigned','$product_details.storage','post','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','render','to_bay','maxPerUnit','/view/choose','/preview/:id','to_floorlevel','$product_details._id','\x20<=>\x20','abs','Enabled','New_Qty_Converted','to_quantity','Router','language','Finished\x20Goods','$product.from_room_name','$product_details.primary_code','user','expiry_date','length','concat','../public/language/languages.json','product_name','German','LOG-TRF-','slice','back','$room','/view/addlog','production_date','to_level','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','params','Transfer\x20Edit\x20Successfully','warehouse','$product_details.rack','from_warehouse','/CheckingWarehouse','/view/choose_logs','/transfer_finished/view','all','An\x20error\x20occurred\x20while\x20saving\x20data.','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','from_room','2063700HpTmEV','<tr>','/view/add_transfer_logs','Enclosed','prod_name','findOne','bay','To_invoice','here2','English','FROZEN\x20GOODS','$product_details.floorlevel','Spanish','An\x20error\x20occurred.','\x20<>\x20','role','$to_warehouse','edit_transfer_finished_view','save','forEach','to_room_name','Chinese','error','string','to_prod_level','body','product_stock','toString','$product_details','finalize','logs','/view','product_code3','catch','$name','max','filter','$product_details.batch_code','to_prod_qty','transfer_finished_logs','date','random','$product_details.production_date','id_transaction','product','$product_details.product_stock','ToRoomAssigned','success','3BrBsEh','Rack\x202','to_warehouse','secondary_unit','from_room_name','maxProducts','choos_transfer_logs','$product_details.level','$_id','message','Product\x20Transfer\x20successfully','8cVazsm','from_invoice','/transfer/view','from_bay','TRFF-','Portuguese','type_of_process','unit','primary_code','getFullYear','864042GMDlyf','email','$product','find','bin2bin','express','TRF-','prod_cat','$from_warehouse','MaxStocks_data2','product_date','English\x20(US)','location2location','note','product_details','DRY\x20GOODS','push','errors','6054939VGdfht','own','_id','json','Hindi','1573796CNPleW','getDate','split','579754gOfoNK','log','transfer_finished','status','/view/add_transfer','French','batch_code','secondary_code','$product_details.bay','$product_details.maxPerUnit','/transfer_finished/preview/','/view/:id','$product_details.invoice','findById','from_prod_level2','padStart','$product_details.type','invoice','then','redirect','aggregate','Rack\x201','map','from_prod_level','staff','</tr>','Arabic','$product_details.bin','/picking_list/PDF_transfer/'];a0_0x29c2=function(){return _0x4b69a8;};return a0_0x29c2();}(function(_0x51aec8,_0x45de36){var _0xced22e=a0_0x1aca,_0x4ccd3b=_0x51aec8();while(!![]){try{var _0x3fd028=parseInt(_0xced22e(0x1a7))/0x1+parseInt(_0xced22e(0x1a4))/0x2*(-parseInt(_0xced22e(0x178))/0x3)+-parseInt(_0xced22e(0x1dd))/0x4+parseInt(_0xced22e(0x20e))/0x5+parseInt(_0xced22e(0x18d))/0x6+-parseInt(_0xced22e(0x1cf))/0x7*(-parseInt(_0xced22e(0x183))/0x8)+parseInt(_0xced22e(0x19f))/0x9;if(_0x3fd028===_0x45de36)break;else _0x4ccd3b['push'](_0x4ccd3b['shift']());}catch(_0x3fe3ac){_0x4ccd3b['push'](_0x4ccd3b['shift']());}}}(a0_0x29c2,0x7d37c));const express=require(a0_0x17edbc(0x192)),app=express(),router=express[a0_0x17edbc(0x1ee)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x17edbc(0x1f7)),nodemailer=require('nodemailer');function a0_0x1aca(_0x14b7e7,_0x5b24b1){var _0x29c25a=a0_0x29c2();return a0_0x1aca=function(_0x1aca06,_0x5343f0){_0x1aca06=_0x1aca06-0x169;var _0x56e828=_0x29c25a[_0x1aca06];return _0x56e828;},a0_0x1aca(_0x14b7e7,_0x5b24b1);}router[a0_0x17edbc(0x1d4)](a0_0x17edbc(0x22d),auth,async(_0xe5fc68,_0x4f63bd)=>{var _0x1b53f6=a0_0x17edbc;try{const {username:_0x2c5c08,email:_0xf6047a,role:_0x435a75}=_0xe5fc68[_0x1b53f6(0x1f3)],_0x10af78=_0xe5fc68[_0x1b53f6(0x1f3)],_0x195526=await profile[_0x1b53f6(0x213)]({'email':_0x10af78['email']}),_0x318af5=await master_shop[_0x1b53f6(0x190)]();let _0x21ec54;if(_0x10af78['role']==_0x1b53f6(0x1bf)){const _0x39220f=await staff['findOne']({'email':_0x10af78['email']});_0x21ec54=await transfers_finished[_0x1b53f6(0x190)]({'from_warehouse':_0x39220f[_0x1b53f6(0x204)]});}else _0x21ec54=await transfers_finished[_0x1b53f6(0x1bb)]([{'$match':{'type_of_transaction':_0x1b53f6(0x1a0)}},{'$unwind':'$product'},{'$group':{'_id':_0x1b53f6(0x180),'invoice':{'$first':_0x1b53f6(0x1cd)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x1b53f6(0x195)},'to_warehouse':{'$first':_0x1b53f6(0x21e)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x1b53f6(0x1d9)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x318af5[0x0][_0x1b53f6(0x1ef)]==_0x1b53f6(0x198))var _0x359703=users[_0x1b53f6(0x217)];else{if(_0x318af5[0x0][_0x1b53f6(0x1ef)]==_0x1b53f6(0x1a3))var _0x359703=users[_0x1b53f6(0x1a3)];else{if(_0x318af5[0x0][_0x1b53f6(0x1ef)]==_0x1b53f6(0x1f9))var _0x359703=users[_0x1b53f6(0x1f9)];else{if(_0x318af5[0x0][_0x1b53f6(0x1ef)]==_0x1b53f6(0x21a))var _0x359703=users[_0x1b53f6(0x21a)];else{if(_0x318af5[0x0][_0x1b53f6(0x1ef)]=='French')var _0x359703=users['French'];else{if(_0x318af5[0x0][_0x1b53f6(0x1ef)]=='Portuguese\x20(BR)')var _0x359703=users[_0x1b53f6(0x188)];else{if(_0x318af5[0x0][_0x1b53f6(0x1ef)]==_0x1b53f6(0x223))var _0x359703=users[_0x1b53f6(0x223)];else{if(_0x318af5[0x0][_0x1b53f6(0x1ef)]==_0x1b53f6(0x1c8))var _0x359703=users['Arabic'];}}}}}}}_0x4f63bd[_0x1b53f6(0x1e2)](_0x1b53f6(0x1a9),{'success':_0xe5fc68[_0x1b53f6(0x1c6)](_0x1b53f6(0x177)),'errors':_0xe5fc68[_0x1b53f6(0x1c6)]('errors'),'role':_0x10af78,'profile':_0x195526,'master_shop':_0x318af5,'transfer':_0x21ec54,'language':_0x359703});}catch(_0x1670f6){console[_0x1b53f6(0x1a8)](_0x1670f6);}}),router[a0_0x17edbc(0x1d4)]('/view_logs',auth,async(_0x526a6a,_0x4001aa)=>{var _0x33ba87=a0_0x17edbc;try{const {username:_0x10952b,email:_0x153445,role:_0x310aa8}=_0x526a6a[_0x33ba87(0x1f3)],_0xaa4ff6=_0x526a6a[_0x33ba87(0x1f3)],_0x380d3b=await profile[_0x33ba87(0x213)]({'email':_0xaa4ff6[_0x33ba87(0x18e)]}),_0x5ad389=await master_shop[_0x33ba87(0x190)]();let _0x1dd54d;if(_0xaa4ff6['role']==_0x33ba87(0x1bf)){const _0x21f7e6=await staff[_0x33ba87(0x213)]({'email':_0xaa4ff6['email']});_0x1dd54d=await transfers_finished['find']({'from_warehouse':_0x21f7e6[_0x33ba87(0x204)]});}else _0x1dd54d=await transfers_finished[_0x33ba87(0x1bb)]([{'$match':{'type_of_transaction':_0x33ba87(0x22c)}},{'$unwind':_0x33ba87(0x18f)},{'$group':{'_id':_0x33ba87(0x180),'invoice':{'$first':_0x33ba87(0x1cd)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x33ba87(0x21e)},'from_room_name':{'$addToSet':_0x33ba87(0x1f1)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x33ba87(0x1cb)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x5ad389[0x0][_0x33ba87(0x1ef)]==_0x33ba87(0x198))var _0x29184e=users[_0x33ba87(0x217)];else{if(_0x5ad389[0x0][_0x33ba87(0x1ef)]=='Hindi')var _0x29184e=users[_0x33ba87(0x1a3)];else{if(_0x5ad389[0x0][_0x33ba87(0x1ef)]==_0x33ba87(0x1f9))var _0x29184e=users[_0x33ba87(0x1f9)];else{if(_0x5ad389[0x0][_0x33ba87(0x1ef)]==_0x33ba87(0x21a))var _0x29184e=users[_0x33ba87(0x21a)];else{if(_0x5ad389[0x0]['language']==_0x33ba87(0x1ac))var _0x29184e=users[_0x33ba87(0x1ac)];else{if(_0x5ad389[0x0][_0x33ba87(0x1ef)]=='Portuguese\x20(BR)')var _0x29184e=users[_0x33ba87(0x188)];else{if(_0x5ad389[0x0]['language']=='Chinese')var _0x29184e=users[_0x33ba87(0x223)];else{if(_0x5ad389[0x0][_0x33ba87(0x1ef)]=='Arabic\x20(ae)')var _0x29184e=users[_0x33ba87(0x1c1)];}}}}}}}_0x4001aa[_0x33ba87(0x1e2)](_0x33ba87(0x16f),{'success':_0x526a6a['flash']('success'),'errors':_0x526a6a[_0x33ba87(0x1c6)](_0x33ba87(0x19e)),'role':_0xaa4ff6,'profile':_0x380d3b,'master_shop':_0x5ad389,'transfer':_0x1dd54d,'language':_0x29184e});}catch(_0x376dbe){console[_0x33ba87(0x1a8)](_0x376dbe);}});async function getRandom8DigitNumber(){var _0x5e4a7e=a0_0x17edbc;const _0x26ace0=0x989680,_0x283c6b=0x5f5e0ff,_0xd8dfdf=Math['floor'](Math[_0x5e4a7e(0x171)]()*(_0x283c6b-_0x26ace0+0x1))+_0x26ace0;var _0x18c557;const _0x5d899f=await transfers_finished[_0x5e4a7e(0x213)]({'invoice':_0x5e4a7e(0x187)+_0xd8dfdf});return _0x5d899f&&_0x5d899f[_0x5e4a7e(0x1f5)]>0x0?_0x18c557='TRFF-'+_0xd8dfdf:_0x18c557=_0x5e4a7e(0x187)+_0xd8dfdf,_0x18c557;}router['get'](a0_0x17edbc(0x1ab),auth,async(_0x2dea9c,_0x213994)=>{var _0x11a348=a0_0x17edbc;try{const {username:_0x51318d,email:_0x5dca6e,role:_0x40e594}=_0x2dea9c[_0x11a348(0x1f3)],_0x5701c3=_0x2dea9c['user'],_0x8f6329=await profile[_0x11a348(0x213)]({'email':_0x5701c3[_0x11a348(0x18e)]}),_0x1ee837=await master_shop['find']();let _0x1a955e;if(_0x5701c3['role']==_0x11a348(0x1bf)){const _0x4b71d8=await staff['findOne']({'email':_0x5701c3['email']});_0x1a955e=await warehouse[_0x11a348(0x1bb)]([{'$match':{'status':'Enabled','name':_0x4b71d8[_0x11a348(0x204)]}},{'$group':{'_id':_0x11a348(0x16a),'name':{'$first':_0x11a348(0x16a)}}}]);}else _0x1a955e=await warehouse[_0x11a348(0x1bb)]([{'$match':{'status':_0x11a348(0x1eb)}},{'$group':{'_id':_0x11a348(0x16a),'name':{'$first':_0x11a348(0x16a)}}}]);const _0x7fc6c7=await transfers_finished[_0x11a348(0x190)]({}),_0x11398c=_0x7fc6c7['length']+0x1,_0x142e90=_0x11a348(0x187)+_0x11398c[_0x11a348(0x229)]()['padStart'](0x5,'0');if(_0x1ee837[0x0]['language']==_0x11a348(0x198))var _0x3a28da=users['English'];else{if(_0x1ee837[0x0]['language']==_0x11a348(0x1a3))var _0x3a28da=users[_0x11a348(0x1a3)];else{if(_0x1ee837[0x0]['language']==_0x11a348(0x1f9))var _0x3a28da=users[_0x11a348(0x1f9)];else{if(_0x1ee837[0x0][_0x11a348(0x1ef)]==_0x11a348(0x21a))var _0x3a28da=users['Spanish'];else{if(_0x1ee837[0x0][_0x11a348(0x1ef)]=='French')var _0x3a28da=users['French'];else{if(_0x1ee837[0x0][_0x11a348(0x1ef)]==_0x11a348(0x1d7))var _0x3a28da=users[_0x11a348(0x188)];else{if(_0x1ee837[0x0][_0x11a348(0x1ef)]=='Chinese')var _0x3a28da=users[_0x11a348(0x223)];else{if(_0x1ee837[0x0][_0x11a348(0x1ef)]==_0x11a348(0x1c8))var _0x3a28da=users[_0x11a348(0x1c1)];}}}}}}}const _0x439925=getRandom8DigitNumber();_0x439925['then'](_0x26519e=>{var _0x192885=_0x11a348;_0x213994[_0x192885(0x1e2)]('add_transfer_finished',{'success':_0x2dea9c[_0x192885(0x1c6)](_0x192885(0x177)),'errors':_0x2dea9c[_0x192885(0x1c6)](_0x192885(0x19e)),'role':_0x5701c3,'profile':_0x8f6329,'master_shop':_0x1ee837,'warehouse':_0x1a955e,'language':_0x3a28da,'invoice':_0x26519e});})[_0x11a348(0x169)](_0x2a464b=>{var _0x476ffe=_0x11a348;_0x2dea9c['flash']('errors',_0x476ffe(0x1c4)),_0x213994['redirect'](_0x476ffe(0x185));});}catch(_0x87fe62){console[_0x11a348(0x1a8)](_0x87fe62);}}),router[a0_0x17edbc(0x1d4)](a0_0x17edbc(0x1e5),auth,async(_0x2e5df5,_0x51ef14)=>{var _0xb47950=a0_0x17edbc;try{const {username:_0x1ae1e0,email:_0x46db38,role:_0x56c490}=_0x2e5df5[_0xb47950(0x1f3)],_0x2dca8d=_0x2e5df5[_0xb47950(0x1f3)],_0x18a91f=await profile[_0xb47950(0x213)]({'email':_0x2dca8d[_0xb47950(0x18e)]}),_0x4a1692=await master_shop['find']();let _0x497fbf;if(_0x2dca8d[_0xb47950(0x21d)]==_0xb47950(0x1bf)){const _0x57d6e4=await staff[_0xb47950(0x213)]({'email':_0x2dca8d[_0xb47950(0x18e)]});_0x497fbf=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x57d6e4[_0xb47950(0x204)]}},{'$group':{'_id':_0xb47950(0x16a),'name':{'$first':_0xb47950(0x16a)}}}]);}else _0x497fbf=await warehouse[_0xb47950(0x1bb)]([{'$match':{'status':_0xb47950(0x1eb)}},{'$group':{'_id':_0xb47950(0x16a),'name':{'$first':_0xb47950(0x16a)}}}]);const _0xaac67b=await transfers_finished['find']({}),_0x3f304f=_0xaac67b[_0xb47950(0x1f5)]+0x1,_0x4acd2e=_0xb47950(0x187)+_0x3f304f['toString']()[_0xb47950(0x1b6)](0x5,'0');if(_0x4a1692[0x0][_0xb47950(0x1ef)]=='English\x20(US)')var _0x16e81d=users['English'];else{if(_0x4a1692[0x0][_0xb47950(0x1ef)]=='Hindi')var _0x16e81d=users[_0xb47950(0x1a3)];else{if(_0x4a1692[0x0][_0xb47950(0x1ef)]==_0xb47950(0x1f9))var _0x16e81d=users[_0xb47950(0x1f9)];else{if(_0x4a1692[0x0][_0xb47950(0x1ef)]==_0xb47950(0x21a))var _0x16e81d=users[_0xb47950(0x21a)];else{if(_0x4a1692[0x0][_0xb47950(0x1ef)]==_0xb47950(0x1ac))var _0x16e81d=users[_0xb47950(0x1ac)];else{if(_0x4a1692[0x0][_0xb47950(0x1ef)]==_0xb47950(0x1d7))var _0x16e81d=users[_0xb47950(0x188)];else{if(_0x4a1692[0x0][_0xb47950(0x1ef)]==_0xb47950(0x223))var _0x16e81d=users['Chinese'];else{if(_0x4a1692[0x0]['language']==_0xb47950(0x1c8))var _0x16e81d=users[_0xb47950(0x1c1)];}}}}}}}const _0x18095a=getRandom8DigitNumber();_0x18095a[_0xb47950(0x1b9)](_0x22915b=>{var _0x51bc06=_0xb47950;_0x51ef14['render']('choos_transfer',{'success':_0x2e5df5[_0x51bc06(0x1c6)](_0x51bc06(0x177)),'errors':_0x2e5df5['flash']('errors'),'role':_0x2dca8d,'profile':_0x18a91f,'master_shop':_0x4a1692,'warehouse':_0x497fbf,'language':_0x16e81d,'invoice':_0x22915b});})['catch'](_0x48b06e=>{var _0x53ed4e=_0xb47950;_0x2e5df5['flash'](_0x53ed4e(0x19e),_0x53ed4e(0x1c4)),_0x51ef14['redirect'](_0x53ed4e(0x185));});}catch(_0x239213){console['log'](_0x239213);}}),router['get'](a0_0x17edbc(0x208),auth,async(_0x3d5245,_0x3d5f25)=>{var _0x1a4ee8=a0_0x17edbc;try{const {username:_0x2e73a2,email:_0x345ff0,role:_0x4bb9ed}=_0x3d5245[_0x1a4ee8(0x1f3)],_0x59c8c1=_0x3d5245['user'],_0x129681=await profile[_0x1a4ee8(0x213)]({'email':_0x59c8c1[_0x1a4ee8(0x18e)]}),_0x5b1cab=await master_shop[_0x1a4ee8(0x190)]();let _0x4de56b;if(_0x59c8c1[_0x1a4ee8(0x21d)]==_0x1a4ee8(0x1bf)){const _0x1d42ca=await staff['findOne']({'email':_0x59c8c1['email']});_0x4de56b=await warehouse[_0x1a4ee8(0x1bb)]([{'$match':{'status':_0x1a4ee8(0x1eb),'name':_0x1d42ca[_0x1a4ee8(0x204)]}},{'$group':{'_id':_0x1a4ee8(0x16a),'name':{'$first':_0x1a4ee8(0x16a)}}}]);}else _0x4de56b=await warehouse[_0x1a4ee8(0x1bb)]([{'$match':{'status':_0x1a4ee8(0x1eb)}},{'$group':{'_id':_0x1a4ee8(0x16a),'name':{'$first':_0x1a4ee8(0x16a)}}}]);const _0x325b36=await transfers_finished[_0x1a4ee8(0x190)]({}),_0x601f69=_0x325b36[_0x1a4ee8(0x1f5)]+0x1,_0x20e1c6=_0x1a4ee8(0x187)+_0x601f69[_0x1a4ee8(0x229)]()['padStart'](0x5,'0');if(_0x5b1cab[0x0][_0x1a4ee8(0x1ef)]==_0x1a4ee8(0x198))var _0x13838d=users[_0x1a4ee8(0x217)];else{if(_0x5b1cab[0x0][_0x1a4ee8(0x1ef)]==_0x1a4ee8(0x1a3))var _0x13838d=users[_0x1a4ee8(0x1a3)];else{if(_0x5b1cab[0x0]['language']==_0x1a4ee8(0x1f9))var _0x13838d=users[_0x1a4ee8(0x1f9)];else{if(_0x5b1cab[0x0][_0x1a4ee8(0x1ef)]==_0x1a4ee8(0x21a))var _0x13838d=users['Spanish'];else{if(_0x5b1cab[0x0]['language']=='French')var _0x13838d=users['French'];else{if(_0x5b1cab[0x0][_0x1a4ee8(0x1ef)]==_0x1a4ee8(0x1d7))var _0x13838d=users[_0x1a4ee8(0x188)];else{if(_0x5b1cab[0x0][_0x1a4ee8(0x1ef)]=='Chinese')var _0x13838d=users[_0x1a4ee8(0x223)];else{if(_0x5b1cab[0x0][_0x1a4ee8(0x1ef)]==_0x1a4ee8(0x1c8))var _0x13838d=users[_0x1a4ee8(0x1c1)];}}}}}}}const _0x24a4ce=getRandom8DigitNumber();_0x24a4ce[_0x1a4ee8(0x1b9)](_0x41afb7=>{var _0x1aca9d=_0x1a4ee8;_0x3d5f25['render'](_0x1aca9d(0x17e),{'success':_0x3d5245[_0x1aca9d(0x1c6)](_0x1aca9d(0x177)),'errors':_0x3d5245[_0x1aca9d(0x1c6)]('errors'),'role':_0x59c8c1,'profile':_0x129681,'master_shop':_0x5b1cab,'warehouse':_0x4de56b,'language':_0x13838d,'invoice':_0x41afb7});})[_0x1a4ee8(0x169)](_0x3727c0=>{var _0x491fac=_0x1a4ee8;_0x3d5245[_0x491fac(0x1c6)]('errors',_0x491fac(0x1c4)),_0x3d5f25['redirect'](_0x491fac(0x185));});}catch(_0x22ac19){console['log'](_0x22ac19);}}),router[a0_0x17edbc(0x1e0)](a0_0x17edbc(0x210),auth,async(_0x123173,_0x2316ea)=>{var _0x2e563d=a0_0x17edbc;try{const {date:_0x3e0165,from_warehouse:_0x30b8a9,FromRoom_name:_0x29c57e,to_warehouse:_0x1d16f3,ToRoom_name:_0x4ab33d,prod_name:_0x13222d,from_prod_qty:_0x21e35b,from_prod_level:_0x19e420,from_prod_isle:_0x5f189d,from_prod_pallet:_0x5e7bd9,to_prod_qty:_0x1ee80c,to_prod_level:_0x2f4728,to_prod_isle:_0x3ef635,to_prod_pallet:_0x45af0c,primary_code:_0x2e6219,secondary_code:_0x1eea33,product_code3:_0x442d57,note:_0xd0a62d,MaxStocks_data2:_0x1eeea9,invoice:_0x10495d,expiry_date:_0x3d1392,PO_number:_0x1deff7,ReqBy:_0x9420fd,dateofreq:_0x50d3cd,typeservicesData:_0xca1a05,destination:_0x4f2755,deliverydate:_0x275fae,driver:_0x13221c,plate:_0x3164e3,van:_0x55262b,DRSI:_0x32edc4,typevehicle:_0x539be2,TSU:_0x5ab265,TFU:_0x4fe809}=_0x123173[_0x2e563d(0x227)];if(typeof _0x13222d=='string')var _0xf17fb6=[_0x123173[_0x2e563d(0x227)]['prod_name']],_0xfaf680=[_0x123173['body'][_0x2e563d(0x1c5)]],_0x4acd18=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x1b5)]],_0xc8d1dd=[_0x123173['body'][_0x2e563d(0x1ec)]],_0x20b88b=[_0x123173['body'][_0x2e563d(0x226)]],_0x4e6752=[_0x123173['body']['primary_code']],_0x2a064a=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x1ae)]],_0x547295=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x22e)]],_0xacb5a9=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x196)]],_0x3bc47b=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x1dc)]],_0x580e21=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x17b)]],_0x493a5d=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x1ad)]],_0x2bd2fa=[_0x123173['body']['expiry_date']],_0x4a330d=[_0x123173[_0x2e563d(0x227)]['product_date']],_0x2ee169=[_0x123173[_0x2e563d(0x227)]['MaxStocks_data']],_0x4bdc67=[_0x123173[_0x2e563d(0x227)]['maxPerUnit']],_0x3bea9b=[_0x123173['body']['prod_cat']],_0x700a34=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x1de)]],_0x28ba2b=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x176)]],_0x4860c4=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x184)]],_0x1b2574=[_0x123173[_0x2e563d(0x227)][_0x2e563d(0x173)]];else var _0xf17fb6=[..._0x123173['body']['prod_name']],_0xfaf680=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x1c5)]],_0x4acd18=[..._0x123173[_0x2e563d(0x227)]['from_prod_level2']],_0xc8d1dd=[..._0x123173['body'][_0x2e563d(0x1ec)]],_0x20b88b=[..._0x123173['body'][_0x2e563d(0x226)]],_0x4e6752=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x18b)]],_0x2a064a=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x1ae)]],_0x547295=[..._0x123173[_0x2e563d(0x227)]['product_code3']],_0xacb5a9=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x196)]],_0x3bc47b=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x1dc)]],_0x580e21=[..._0x123173['body']['secondary_unit']],_0x493a5d=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x1ad)]],_0x2bd2fa=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x1f4)]],_0x4a330d=[..._0x123173['body'][_0x2e563d(0x197)]],_0x2ee169=[..._0x123173['body']['MaxStocks_data']],_0x4bdc67=[..._0x123173['body'][_0x2e563d(0x1e4)]],_0x3bea9b=[..._0x123173[_0x2e563d(0x227)]['prod_cat']],_0x700a34=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x1de)]],_0x28ba2b=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x176)]],_0x4860c4=[..._0x123173[_0x2e563d(0x227)]['from_invoice']],_0x1b2574=[..._0x123173[_0x2e563d(0x227)][_0x2e563d(0x173)]];const _0xb75140=_0xf17fb6[_0x2e563d(0x1bd)](_0x5b60b2=>{return _0x5b60b2={'product_name':_0x5b60b2};});_0xfaf680[_0x2e563d(0x221)]((_0x31f786,_0x49d546)=>{_0xb75140[_0x49d546]['from_quantity']=_0x31f786;}),_0x4acd18[_0x2e563d(0x221)]((_0x5bf12e,_0x243786)=>{var _0x66ec9a=_0x2e563d,_0x2254f9=_0x5bf12e[_0x66ec9a(0x1d3)](/[A-Za-z]+/)[0x0],_0x3d4b23=parseInt(_0x5bf12e[_0x66ec9a(0x1d3)](/\d+/)[0x0]);_0xb75140[_0x243786][_0x66ec9a(0x186)]=_0x3d4b23,_0xb75140[_0x243786]['from_level']=_0x2254f9;}),_0x1b2574[_0x2e563d(0x221)]((_0x27eae2,_0x41089e)=>{var _0xd75347=_0x2e563d;_0xb75140[_0x41089e][_0xd75347(0x173)]=_0x27eae2;}),_0x4860c4[_0x2e563d(0x221)]((_0x52647a,_0xd7bc2d)=>{_0xb75140[_0xd7bc2d]['from_invoice']=_0x52647a;}),_0xc8d1dd[_0x2e563d(0x221)]((_0x43c967,_0x380a2c)=>{var _0x20a844=_0x2e563d;_0xb75140[_0x380a2c][_0x20a844(0x1ed)]=_0x43c967;}),_0x20b88b[_0x2e563d(0x221)]((_0x44cfe0,_0x370801)=>{var _0x4a0b3c=_0x2e563d,_0x7eb8cb=_0x44cfe0[_0x4a0b3c(0x1d3)](/[A-Za-z]+/)[0x0],_0x5725c6=parseInt(_0x44cfe0[_0x4a0b3c(0x1d3)](/\d+/)[0x0]);_0xb75140[_0x370801]['to_level']=_0x7eb8cb,_0xb75140[_0x370801]['to_bay']=_0x5725c6;}),_0x4e6752[_0x2e563d(0x221)]((_0x5ba56b,_0x511c84)=>{var _0x4f6d5e=_0x2e563d;_0xb75140[_0x511c84][_0x4f6d5e(0x18b)]=_0x5ba56b;}),_0x2a064a['forEach']((_0x1c5d2a,_0x4901a1)=>{var _0x48a908=_0x2e563d;_0xb75140[_0x4901a1][_0x48a908(0x1ae)]=_0x1c5d2a;}),_0x547295[_0x2e563d(0x221)]((_0x348cb4,_0x5e0f64)=>{var _0x248dd1=_0x2e563d;_0xb75140[_0x5e0f64][_0x248dd1(0x1d0)]=_0x348cb4;}),_0xacb5a9[_0x2e563d(0x221)]((_0x3d242b,_0x316907)=>{var _0x483a65=_0x2e563d;_0xb75140[_0x316907][_0x483a65(0x17d)]=_0x3d242b;}),_0x3bc47b[_0x2e563d(0x221)]((_0x4f6218,_0x482c23)=>{_0xb75140[_0x482c23]['unit']=_0x4f6218;}),_0x580e21[_0x2e563d(0x221)]((_0x58e5f2,_0x14004f)=>{var _0x35bc0c=_0x2e563d;_0xb75140[_0x14004f][_0x35bc0c(0x17b)]=_0x58e5f2;}),_0x493a5d[_0x2e563d(0x221)]((_0x11fdf0,_0x3a5d38)=>{var _0x29ea10=_0x2e563d;_0xb75140[_0x3a5d38][_0x29ea10(0x1ad)]=_0x11fdf0;}),_0x2bd2fa['forEach']((_0x5c5a8e,_0x5dc19b)=>{var _0x466fd2=_0x2e563d;_0xb75140[_0x5dc19b][_0x466fd2(0x1f4)]=_0x5c5a8e;}),_0x4a330d[_0x2e563d(0x221)]((_0x5da9bd,_0x4fd03e)=>{var _0x205299=_0x2e563d;_0xb75140[_0x4fd03e][_0x205299(0x1ff)]=_0x5da9bd;}),_0x2ee169[_0x2e563d(0x221)]((_0x1e4794,_0x517893)=>{var _0x1efeb7=_0x2e563d;_0xb75140[_0x517893][_0x1efeb7(0x17d)]=_0x1e4794;}),_0x4bdc67[_0x2e563d(0x221)]((_0x212bd6,_0x4558a9)=>{_0xb75140[_0x4558a9]['maxPerUnit']=_0x212bd6;}),_0x3bea9b[_0x2e563d(0x221)]((_0x3a9b72,_0x476737)=>{var _0x6a9a61=_0x2e563d;_0xb75140[_0x476737][_0x6a9a61(0x194)]=_0x3a9b72;}),_0x700a34[_0x2e563d(0x221)]((_0x109aec,_0x361147)=>{_0xb75140[_0x361147]['from_room_name']=_0x109aec;}),_0x28ba2b[_0x2e563d(0x221)]((_0x3d3afa,_0x217947)=>{_0xb75140[_0x217947]['to_room_name']=_0x3d3afa;});const _0x439a39=_0xb75140['filter'](_0x5e89cb=>_0x5e89cb[_0x2e563d(0x1ed)]!=='0'&&_0x5e89cb[_0x2e563d(0x1ed)]!==''||_0x5e89cb[_0x2e563d(0x1e7)]!=='0'&&_0x5e89cb[_0x2e563d(0x1e7)]!=='');var _0x421ef4=0x0;_0x439a39['forEach'](_0x3b0607=>{var _0x5df537=_0x2e563d;parseInt(_0x3b0607[_0x5df537(0x1c7)])<parseInt(_0x3b0607[_0x5df537(0x1ed)])&&_0x421ef4++;});if(_0x421ef4!=0x0)return _0x123173[_0x2e563d(0x1c6)](_0x2e563d(0x19e),_0x2e563d(0x201)),_0x2316ea[_0x2e563d(0x1ba)]('back');const _0x1a0180=new transfers_logs();await _0x1a0180['save']();for(let _0x3c1df9=0x0;_0x3c1df9<=_0x28ba2b[_0x2e563d(0x1f5)]-0x1;_0x3c1df9++){_0xb75140[_0x3c1df9][_0x2e563d(0x215)]='LOG-TRF-'+_0x1a0180['invoice_init']['toString']()[_0x2e563d(0x1b6)](0x8,'0');}const _0x1a390c=new transfers_finished({'date':_0x3e0165,'from_warehouse':_0x30b8a9,'to_warehouse':_0x30b8a9,'product':_0x439a39,'note':_0xd0a62d,'invoice':_0x2e563d(0x1fa)+_0x1a0180[_0x2e563d(0x1db)][_0x2e563d(0x229)]()['padStart'](0x8,'0'),'type_of_process':_0x2e563d(0x191),'type_of_transaction':_0x2e563d(0x22c),'PO_number':_0x1deff7,'RequestedBy':_0x9420fd,'DateofRequest':_0x50d3cd,'typeservices':_0xca1a05,'destination':_0x4f2755,'deliverydate':_0x275fae,'driver':_0x13221c,'plate':_0x3164e3,'van':_0x55262b,'DRSI':_0x32edc4,'typevehicle':_0x539be2,'TSU':_0x5ab265,'TFU':_0x4fe809}),_0x392295=await _0x1a390c[_0x2e563d(0x220)]();_0x123173[_0x2e563d(0x1c6)]('success',_0x2e563d(0x182)),_0x2316ea[_0x2e563d(0x1ba)]('/transfer_finished/preview/'+_0x392295[_0x2e563d(0x1a1)]);}catch(_0x23502d){console[_0x2e563d(0x1a8)](_0x23502d),_0x2316ea[_0x2e563d(0x1aa)](0xc8)[_0x2e563d(0x1a2)]({'errorMessage':_0x23502d[_0x2e563d(0x181)]});}}),router[a0_0x17edbc(0x1e0)](a0_0x17edbc(0x1fe),auth,async(_0x14848a,_0x3c8144)=>{var _0x4a6092=a0_0x17edbc;try{const {date:_0x30d637,from_warehouse:_0x558358,FromRoom_name:_0x521b6b,to_warehouse:_0x4eac9b,ToRoom_name:_0x3d3e62,prod_name:_0x3184a6,from_prod_qty:_0x49f548,from_prod_level:_0x15e57f,from_prod_isle:_0x2e3c3f,from_prod_pallet:_0x5bcfb1,to_prod_qty:_0x5a645e,to_prod_level:_0x55512d,to_prod_isle:_0x569fee,to_prod_pallet:_0x491537,primary_code:_0x173a9c,secondary_code:_0x79d587,product_code3:_0x2b7ae1,note:_0x16dcd6,MaxStocks_data2:_0x23862a,invoice:_0x33796e,expiry_date:_0x3d7706,PO_number_loc:_0x55845,ReqBy_loc:_0x5a3f39,dateofreq_loc:_0x5b502b,typeservices_loc_Data:_0x18905f,destination_loc:_0x4de1ad,deliverydate_loc:_0x2b72fd,driver_loc:_0x1e141a,plate_loc:_0x53fc7e,van_loc:_0x45b7d5,DRSI_loc:_0x633afc,typevehicle_loc:_0x16de37,TSU_loc:_0x1c3941,TFU_loc:_0x2286a8}=_0x14848a[_0x4a6092(0x227)];if(typeof _0x3184a6=='string')var _0x35aa03=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x212)]],_0x97af38=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1c5)]],_0x58a9c3=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1b5)]],_0x4e9605=[_0x14848a['body'][_0x4a6092(0x1ec)]],_0x4fd77b=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x226)]],_0x47ad15=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x18b)]],_0x296c58=[_0x14848a['body'][_0x4a6092(0x1ae)]],_0x2a1d32=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x22e)]],_0x3f0921=[_0x14848a[_0x4a6092(0x227)]['MaxStocks_data2']],_0x39d4b6=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1dc)]],_0x1e0695=[_0x14848a['body'][_0x4a6092(0x17b)]],_0x222fe7=[_0x14848a[_0x4a6092(0x227)]['batch_code']],_0x2445aa=[_0x14848a[_0x4a6092(0x227)]['expiry_date']],_0x5fdf88=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x197)]],_0x435b4=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1ca)]],_0x5645f1=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1e4)]],_0x3c0f73=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x194)]],_0x796cdc=[_0x14848a[_0x4a6092(0x227)]['RoomAssigned']],_0x1a30b1=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x176)]],_0x164f38=[_0x14848a[_0x4a6092(0x227)]['from_invoice']],_0x56c5bf=[_0x14848a[_0x4a6092(0x227)][_0x4a6092(0x173)]];else var _0x35aa03=[..._0x14848a[_0x4a6092(0x227)]['prod_name']],_0x97af38=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1c5)]],_0x58a9c3=[..._0x14848a['body'][_0x4a6092(0x1b5)]],_0x4e9605=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1ec)]],_0x4fd77b=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x226)]],_0x47ad15=[..._0x14848a[_0x4a6092(0x227)]['primary_code']],_0x296c58=[..._0x14848a[_0x4a6092(0x227)]['secondary_code']],_0x2a1d32=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x22e)]],_0x3f0921=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x196)]],_0x39d4b6=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1dc)]],_0x1e0695=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x17b)]],_0x222fe7=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1ad)]],_0x2445aa=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1f4)]],_0x5fdf88=[..._0x14848a[_0x4a6092(0x227)]['product_date']],_0x435b4=[..._0x14848a['body']['MaxStocks_data']],_0x5645f1=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1e4)]],_0x3c0f73=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x194)]],_0x796cdc=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x1de)]],_0x1a30b1=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x176)]],_0x164f38=[..._0x14848a[_0x4a6092(0x227)][_0x4a6092(0x184)]],_0x56c5bf=[..._0x14848a[_0x4a6092(0x227)]['id_transaction']];const _0x47be3a=_0x35aa03['map'](_0x372ebf=>{return _0x372ebf={'product_name':_0x372ebf};});_0x97af38[_0x4a6092(0x221)]((_0x13ab55,_0x3859bb)=>{var _0x5f331c=_0x4a6092;_0x47be3a[_0x3859bb][_0x5f331c(0x1c7)]=_0x13ab55;}),_0x58a9c3[_0x4a6092(0x221)]((_0x1944c4,_0x513003)=>{var _0x133e9b=_0x4a6092,_0xcdc0e3=_0x1944c4[_0x133e9b(0x1d3)](/[A-Za-z]+/)[0x0],_0xe5ee0e=parseInt(_0x1944c4['match'](/\d+/)[0x0]);_0x47be3a[_0x513003]['from_bay']=_0xe5ee0e,_0x47be3a[_0x513003][_0x133e9b(0x1d1)]=_0xcdc0e3;}),_0x56c5bf[_0x4a6092(0x221)]((_0x2fd1c1,_0x288772)=>{var _0x595ca5=_0x4a6092;_0x47be3a[_0x288772][_0x595ca5(0x173)]=_0x2fd1c1;}),_0x164f38[_0x4a6092(0x221)]((_0x466fa2,_0x351140)=>{var _0x17e290=_0x4a6092;_0x47be3a[_0x351140][_0x17e290(0x184)]=_0x466fa2;}),_0x4e9605[_0x4a6092(0x221)]((_0x1d2fb3,_0x454fad)=>{var _0x2e784c=_0x4a6092;_0x47be3a[_0x454fad][_0x2e784c(0x1ed)]=_0x1d2fb3;}),_0x4fd77b['forEach']((_0x5232f9,_0x24a0d3)=>{var _0x468f96=_0x4a6092,_0x338de3=_0x5232f9['match'](/[A-Za-z]+/)[0x0],_0x38de58=parseInt(_0x5232f9[_0x468f96(0x1d3)](/\d+/)[0x0]);_0x47be3a[_0x24a0d3]['to_level']=_0x338de3,_0x47be3a[_0x24a0d3][_0x468f96(0x1e3)]=_0x38de58;}),_0x47ad15['forEach']((_0x4092b2,_0x5464d3)=>{var _0x3cde6d=_0x4a6092;_0x47be3a[_0x5464d3][_0x3cde6d(0x18b)]=_0x4092b2;}),_0x296c58[_0x4a6092(0x221)]((_0x29a202,_0x28cb51)=>{_0x47be3a[_0x28cb51]['secondary_code']=_0x29a202;}),_0x2a1d32['forEach']((_0xc15ba4,_0x1e959c)=>{var _0x5b6a86=_0x4a6092;_0x47be3a[_0x1e959c][_0x5b6a86(0x1d0)]=_0xc15ba4;}),_0x3f0921[_0x4a6092(0x221)]((_0x358720,_0x996af6)=>{var _0x4231fc=_0x4a6092;_0x47be3a[_0x996af6][_0x4231fc(0x17d)]=_0x358720;}),_0x39d4b6[_0x4a6092(0x221)]((_0x455c6f,_0x2ebe5a)=>{var _0x2fea6c=_0x4a6092;_0x47be3a[_0x2ebe5a][_0x2fea6c(0x18a)]=_0x455c6f;}),_0x1e0695[_0x4a6092(0x221)]((_0x2dd864,_0x1acd99)=>{var _0x277c50=_0x4a6092;_0x47be3a[_0x1acd99][_0x277c50(0x17b)]=_0x2dd864;}),_0x222fe7[_0x4a6092(0x221)]((_0x277c0d,_0x32b088)=>{_0x47be3a[_0x32b088]['batch_code']=_0x277c0d;}),_0x2445aa['forEach']((_0x4f47e2,_0x8f28fe)=>{var _0x4d6ab5=_0x4a6092;_0x47be3a[_0x8f28fe][_0x4d6ab5(0x1f4)]=_0x4f47e2;}),_0x5fdf88[_0x4a6092(0x221)]((_0x3e32e2,_0x473794)=>{var _0x4cfb92=_0x4a6092;_0x47be3a[_0x473794][_0x4cfb92(0x1ff)]=_0x3e32e2;}),_0x435b4[_0x4a6092(0x221)]((_0x1795d2,_0x36cb81)=>{var _0x484c58=_0x4a6092;_0x47be3a[_0x36cb81][_0x484c58(0x17d)]=_0x1795d2;}),_0x5645f1[_0x4a6092(0x221)]((_0xcab3ba,_0x5ee7b0)=>{var _0x102b83=_0x4a6092;_0x47be3a[_0x5ee7b0][_0x102b83(0x1e4)]=_0xcab3ba;}),_0x3c0f73[_0x4a6092(0x221)]((_0x1fee5c,_0x78301b)=>{var _0x182fd8=_0x4a6092;_0x47be3a[_0x78301b][_0x182fd8(0x194)]=_0x1fee5c;}),_0x796cdc[_0x4a6092(0x221)]((_0x7053fb,_0x21035a)=>{var _0x42b5a6=_0x4a6092;_0x47be3a[_0x21035a][_0x42b5a6(0x17c)]=_0x7053fb;}),_0x1a30b1['forEach']((_0x151115,_0x55cc8a)=>{var _0x5e4f51=_0x4a6092;_0x47be3a[_0x55cc8a][_0x5e4f51(0x222)]=_0x151115;});const _0x337bab=_0x47be3a[_0x4a6092(0x16c)](_0x2f44b5=>_0x2f44b5[_0x4a6092(0x1ed)]!=='0'&&_0x2f44b5[_0x4a6092(0x1ed)]!==''||_0x2f44b5[_0x4a6092(0x1e7)]!=='0'&&_0x2f44b5['to_floorlevel']!=='');var _0x5cc2e5=0x0;_0x337bab['forEach'](_0x55c4d1=>{var _0x4cb4e7=_0x4a6092;parseInt(_0x55c4d1[_0x4cb4e7(0x1c7)])<parseInt(_0x55c4d1[_0x4cb4e7(0x1ed)])&&_0x5cc2e5++;});if(_0x5cc2e5!=0x0)return _0x14848a[_0x4a6092(0x1c6)](_0x4a6092(0x19e),_0x4a6092(0x201)),_0x3c8144['redirect'](_0x4a6092(0x1fc));const _0x596956=new transfers_logs();await _0x596956['save']();for(let _0x33632d=0x0;_0x33632d<=_0x1a30b1[_0x4a6092(0x1f5)]-0x1;_0x33632d++){_0x47be3a[_0x33632d][_0x4a6092(0x215)]=_0x4a6092(0x1fa)+_0x596956['invoice_init'][_0x4a6092(0x229)]()['padStart'](0x8,'0');}const _0x43073b=new transfers_finished({'date':_0x30d637,'from_warehouse':_0x558358,'to_warehouse':_0x4eac9b,'product':_0x337bab,'note':_0x16dcd6,'invoice':_0x4a6092(0x1fa)+_0x596956[_0x4a6092(0x1db)]['toString']()['padStart'](0x8,'0'),'type_of_transaction':_0x4a6092(0x22c),'type_of_process':_0x4a6092(0x199),'PO_number':_0x55845,'RequestedBy':_0x5a3f39,'DateofRequest':_0x5b502b,'typeservices':_0x18905f,'destination':_0x4de1ad,'deliverydate':_0x2b72fd,'driver':_0x1e141a,'plate':_0x53fc7e,'van':_0x45b7d5,'DRSI':_0x633afc,'typevehicle':_0x16de37,'TSU':_0x1c3941,'TFU':_0x2286a8}),_0x50d818=await _0x43073b[_0x4a6092(0x220)]();_0x14848a[_0x4a6092(0x1c6)]('success',_0x4a6092(0x182)),_0x3c8144[_0x4a6092(0x1ba)](_0x4a6092(0x1b1)+_0x50d818[_0x4a6092(0x1a1)]);}catch(_0x126707){console[_0x4a6092(0x1a8)](_0x126707),_0x3c8144['status'](0xc8)[_0x4a6092(0x1a2)]({'errorMessage':_0x126707[_0x4a6092(0x181)]});}}),router[a0_0x17edbc(0x1e0)](a0_0x17edbc(0x1ab),auth,async(_0x2ad858,_0x28e0ac)=>{var _0xe9e5bf=a0_0x17edbc;try{const {date:_0x562ac0,from_warehouse:_0x282897,FromRoom_name:_0xb42bad,to_warehouse:_0x415d61,ToRoom_name:_0x553736,prod_name:_0x2b1b07,from_prod_qty:_0xd9f7f0,from_prod_level:_0x35524c,from_prod_isle:_0x4bc20e,from_prod_pallet:_0x53b627,to_prod_qty:_0x3db642,to_prod_level:_0x24a17c,to_prod_isle:_0x11a004,to_prod_pallet:_0x4f545e,primary_code:_0x171a73,secondary_code:_0x134ec0,product_code3:_0x10e91f,note:_0x1c3f99,MaxStocks_data2:_0x2872c1,invoice:_0x91dc1a,expiry_date:_0x590306,PO_number:_0xbb74d0,ReqBy:_0x302616,dateofreq:_0x4c8559,typeservicesData:_0x77d60b,destination:_0x45bad6,deliverydate:_0xbf0b93,driver:_0x2433ef,plate:_0x1a7155,van:_0x3b98f8,DRSI:_0x89a256,typevehicle:_0x110eb6,TSU:_0x2e849b,TFU:_0x4cb5af}=_0x2ad858[_0xe9e5bf(0x227)];if(typeof _0x2b1b07==_0xe9e5bf(0x225))var _0x37428e=[_0x2ad858[_0xe9e5bf(0x227)]['prod_name']],_0x21ea96=[_0x2ad858[_0xe9e5bf(0x227)]['from_prod_qty']],_0x4cac52=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1b5)]],_0x40ea13=[_0x2ad858[_0xe9e5bf(0x227)]['New_Qty_Converted']],_0x24fee1=[_0x2ad858[_0xe9e5bf(0x227)]['to_prod_level']],_0x5edcac=[_0x2ad858['body'][_0xe9e5bf(0x18b)]],_0x52aba0=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1ae)]],_0x328a49=[_0x2ad858[_0xe9e5bf(0x227)]['product_code3']],_0x4e6a56=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x196)]],_0x3b5bc2=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1dc)]],_0x68206a=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x17b)]],_0x953b32=[_0x2ad858[_0xe9e5bf(0x227)]['batch_code']],_0x231d40=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1f4)]],_0xee645b=[_0x2ad858[_0xe9e5bf(0x227)]['product_date']],_0x35b9e0=[_0x2ad858['body'][_0xe9e5bf(0x1ca)]],_0x50248=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1e4)]],_0x393613=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x194)]],_0x43bb49=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1de)]],_0x2978a1=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x176)]],_0x431652=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x184)]],_0x3d4fe2=[_0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x173)]];else var _0x37428e=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x212)]],_0x21ea96=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1c5)]],_0x4cac52=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1b5)]],_0x40ea13=[..._0x2ad858[_0xe9e5bf(0x227)]['New_Qty_Converted']],_0x24fee1=[..._0x2ad858['body'][_0xe9e5bf(0x226)]],_0x5edcac=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x18b)]],_0x52aba0=[..._0x2ad858['body'][_0xe9e5bf(0x1ae)]],_0x328a49=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x22e)]],_0x4e6a56=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x196)]],_0x3b5bc2=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1dc)]],_0x68206a=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x17b)]],_0x953b32=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1ad)]],_0x231d40=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1f4)]],_0xee645b=[..._0x2ad858[_0xe9e5bf(0x227)]['product_date']],_0x35b9e0=[..._0x2ad858[_0xe9e5bf(0x227)]['MaxStocks_data']],_0x50248=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x1e4)]],_0x393613=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x194)]],_0x43bb49=[..._0x2ad858[_0xe9e5bf(0x227)]['RoomAssigned']],_0x2978a1=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x176)]],_0x431652=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x184)]],_0x3d4fe2=[..._0x2ad858[_0xe9e5bf(0x227)][_0xe9e5bf(0x173)]];const _0x414559=_0x37428e[_0xe9e5bf(0x1bd)](_0x396a5c=>{return _0x396a5c={'product_name':_0x396a5c};});_0x21ea96[_0xe9e5bf(0x221)]((_0x590124,_0x244dfe)=>{var _0x223e1f=_0xe9e5bf;_0x414559[_0x244dfe][_0x223e1f(0x1c7)]=_0x590124;}),_0x4cac52[_0xe9e5bf(0x221)]((_0x10d809,_0x5599b3)=>{var _0x179234=_0xe9e5bf,_0x384178=_0x10d809[_0x179234(0x1d3)](/[A-Za-z]+/)[0x0],_0x1d40c9=parseInt(_0x10d809[_0x179234(0x1d3)](/\d+/)[0x0]);_0x414559[_0x5599b3][_0x179234(0x186)]=_0x1d40c9,_0x414559[_0x5599b3][_0x179234(0x1d1)]=_0x384178;}),_0x3d4fe2[_0xe9e5bf(0x221)]((_0x4f6899,_0x37179b)=>{var _0x157f5f=_0xe9e5bf;_0x414559[_0x37179b][_0x157f5f(0x173)]=_0x4f6899;}),_0x431652[_0xe9e5bf(0x221)]((_0x469100,_0x51a197)=>{var _0xaa4207=_0xe9e5bf;_0x414559[_0x51a197][_0xaa4207(0x184)]=_0x469100;}),_0x40ea13['forEach']((_0x3fe479,_0x1f6510)=>{var _0x131e13=_0xe9e5bf;_0x414559[_0x1f6510][_0x131e13(0x1ed)]=_0x3fe479;}),_0x24fee1[_0xe9e5bf(0x221)]((_0xd8f193,_0xdae825)=>{var _0x30a290=_0xe9e5bf,_0x2517d1=_0xd8f193[_0x30a290(0x1d3)](/[A-Za-z]+/)[0x0],_0x100b35=parseInt(_0xd8f193['match'](/\d+/)[0x0]);_0x414559[_0xdae825][_0x30a290(0x200)]=_0x2517d1,_0x414559[_0xdae825][_0x30a290(0x1e3)]=_0x100b35;}),_0x5edcac[_0xe9e5bf(0x221)]((_0x5796eb,_0x216944)=>{var _0x3c6ef8=_0xe9e5bf;_0x414559[_0x216944][_0x3c6ef8(0x18b)]=_0x5796eb;}),_0x52aba0[_0xe9e5bf(0x221)]((_0x48eccf,_0xf9a4e7)=>{var _0x12ae1d=_0xe9e5bf;_0x414559[_0xf9a4e7][_0x12ae1d(0x1ae)]=_0x48eccf;}),_0x328a49[_0xe9e5bf(0x221)]((_0x6194e2,_0x11c3c1)=>{var _0x362a2f=_0xe9e5bf;_0x414559[_0x11c3c1][_0x362a2f(0x1d0)]=_0x6194e2;}),_0x4e6a56[_0xe9e5bf(0x221)]((_0x195b87,_0x4fb874)=>{var _0x36057c=_0xe9e5bf;_0x414559[_0x4fb874][_0x36057c(0x17d)]=_0x195b87;}),_0x3b5bc2[_0xe9e5bf(0x221)]((_0x2ae3ff,_0x5a2e7c)=>{var _0x2f68c2=_0xe9e5bf;_0x414559[_0x5a2e7c][_0x2f68c2(0x18a)]=_0x2ae3ff;}),_0x68206a[_0xe9e5bf(0x221)]((_0xd40a77,_0x22a885)=>{var _0x2b8949=_0xe9e5bf;_0x414559[_0x22a885][_0x2b8949(0x17b)]=_0xd40a77;}),_0x953b32[_0xe9e5bf(0x221)]((_0x1abd5f,_0xea45dc)=>{var _0x1baf25=_0xe9e5bf;_0x414559[_0xea45dc][_0x1baf25(0x1ad)]=_0x1abd5f;}),_0x231d40[_0xe9e5bf(0x221)]((_0x5f16f6,_0x4605b6)=>{var _0x40057d=_0xe9e5bf;_0x414559[_0x4605b6][_0x40057d(0x1f4)]=_0x5f16f6;}),_0xee645b[_0xe9e5bf(0x221)]((_0x4f2aa4,_0x47766b)=>{_0x414559[_0x47766b]['production_date']=_0x4f2aa4;}),_0x35b9e0[_0xe9e5bf(0x221)]((_0x326b68,_0x1ce162)=>{_0x414559[_0x1ce162]['maxProducts']=_0x326b68;}),_0x50248[_0xe9e5bf(0x221)]((_0x5e2139,_0x712d99)=>{var _0x405938=_0xe9e5bf;_0x414559[_0x712d99][_0x405938(0x1e4)]=_0x5e2139;}),_0x393613[_0xe9e5bf(0x221)]((_0x12f32f,_0x3e8aa2)=>{var _0x30e08d=_0xe9e5bf;_0x414559[_0x3e8aa2][_0x30e08d(0x194)]=_0x12f32f;}),_0x43bb49[_0xe9e5bf(0x221)]((_0x3fbf07,_0x10438a)=>{var _0x3ce121=_0xe9e5bf;_0x414559[_0x10438a][_0x3ce121(0x17c)]=_0x3fbf07;}),_0x2978a1[_0xe9e5bf(0x221)]((_0x4c7199,_0x56ea25)=>{_0x414559[_0x56ea25]['to_room_name']=_0x4c7199;});const _0x2a1e90=_0x414559['filter'](_0x3a7ef4=>_0x3a7ef4[_0xe9e5bf(0x1ed)]!=='0'&&_0x3a7ef4[_0xe9e5bf(0x1ed)]!==''||_0x3a7ef4[_0xe9e5bf(0x1e7)]!=='0'&&_0x3a7ef4[_0xe9e5bf(0x1e7)]!=='');var _0x10816d=0x0;_0x2a1e90[_0xe9e5bf(0x221)](_0x5dd05f=>{var _0x2e653a=_0xe9e5bf;parseInt(_0x5dd05f[_0x2e653a(0x1c7)])<parseInt(_0x5dd05f[_0x2e653a(0x1ed)])&&_0x10816d++;});if(_0x10816d!=0x0)return _0x2ad858['flash'](_0xe9e5bf(0x19e),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x28e0ac[_0xe9e5bf(0x1ba)](_0xe9e5bf(0x1fc));const _0x41d170=new invoice_for_transfer();await _0x41d170[_0xe9e5bf(0x220)]();for(let _0x44a7c9=0x0;_0x44a7c9<=_0x2978a1[_0xe9e5bf(0x1f5)]-0x1;_0x44a7c9++){_0x414559[_0x44a7c9][_0xe9e5bf(0x215)]=_0xe9e5bf(0x193)+_0x41d170[_0xe9e5bf(0x1db)]['toString']()[_0xe9e5bf(0x1b6)](0x8,'0');}const _0x5a5c8c=new transfers_finished({'date':_0x562ac0,'from_warehouse':_0x282897,'to_warehouse':_0x282897,'product':_0x2a1e90,'note':_0x1c3f99,'invoice':'TRF-'+_0x41d170[_0xe9e5bf(0x1db)][_0xe9e5bf(0x229)]()['padStart'](0x8,'0'),'type_of_process':_0xe9e5bf(0x191),'type_of_transaction':_0xe9e5bf(0x1a0),'PO_number':_0xbb74d0,'RequestedBy':_0x302616,'DateofRequest':_0x4c8559,'typeservices':_0x77d60b,'destination':_0x45bad6,'deliverydate':_0xbf0b93,'driver':_0x2433ef,'plate':_0x1a7155,'van':_0x3b98f8,'DRSI':_0x89a256,'typevehicle':_0x110eb6,'TSU':_0x2e849b,'TFU':_0x4cb5af}),_0x548ff5=await _0x5a5c8c['save']();_0x2ad858['flash'](_0xe9e5bf(0x177),_0xe9e5bf(0x182)),_0x28e0ac[_0xe9e5bf(0x1ba)]('/transfer_finished/preview/'+_0x548ff5[_0xe9e5bf(0x1a1)]);}catch(_0x347ec9){console[_0xe9e5bf(0x1a8)](_0x347ec9),_0x28e0ac['status'](0xc8)[_0xe9e5bf(0x1a2)]({'errorMessage':_0x347ec9[_0xe9e5bf(0x181)]});}}),router['post'](a0_0x17edbc(0x1d8),auth,async(_0x43cc94,_0x6ee6d6)=>{var _0x16db20=a0_0x17edbc;try{const {date:_0x2e0249,from_warehouse:_0x444f98,FromRoom_name:_0x37e88b,to_warehouse:_0x520ceb,ToRoom_name:_0x35618b,prod_name:_0x52375a,from_prod_qty:_0x4d2ec9,from_prod_level:_0x160e0c,from_prod_isle:_0x3b2051,from_prod_pallet:_0x2291c5,to_prod_qty:_0xef5b79,to_prod_level:_0x315275,to_prod_isle:_0x5bebe3,to_prod_pallet:_0x1f41b2,primary_code:_0x747a65,secondary_code:_0x25604e,product_code3:_0x28b4aa,note:_0x56ab69,MaxStocks_data2:_0x163a6a,invoice:_0x1de98f,expiry_date:_0x43e9da,PO_number_loc:_0x2abe2a,ReqBy_loc:_0x251757,dateofreq_loc:_0x2a7d93,typeservices_loc_Data:_0x3f506b,destination_loc:_0x3f278c,deliverydate_loc:_0x2a6215,driver_loc:_0x143729,plate_loc:_0x5451fb,van_loc:_0x8cc6ce,DRSI_loc:_0x3539e4,typevehicle_loc:_0x388098,TSU_loc:_0x5146eb,TFU_loc:_0x147ba4}=_0x43cc94['body'];if(typeof _0x52375a==_0x16db20(0x225))var _0x496859=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x212)]],_0x19f824=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1c5)]],_0x10770c=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1b5)]],_0x30a8f9=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1ec)]],_0x314f00=[_0x43cc94[_0x16db20(0x227)]['to_prod_level']],_0x153da7=[_0x43cc94['body'][_0x16db20(0x18b)]],_0x582445=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1ae)]],_0x33a052=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x22e)]],_0x4af445=[_0x43cc94['body'][_0x16db20(0x196)]],_0x5eaf92=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1dc)]],_0x1ad1e2=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x17b)]],_0x559834=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1ad)]],_0x27fe79=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1f4)]],_0x422576=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x197)]],_0x170a8c=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1ca)]],_0xb686dc=[_0x43cc94[_0x16db20(0x227)]['maxPerUnit']],_0x3298bb=[_0x43cc94['body']['prod_cat']],_0x42d260=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x1de)]],_0x5bfb91=[_0x43cc94[_0x16db20(0x227)]['ToRoomAssigned']],_0x250087=[_0x43cc94[_0x16db20(0x227)][_0x16db20(0x184)]],_0x23656f=[_0x43cc94[_0x16db20(0x227)]['id_transaction']];else var _0x496859=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x212)]],_0x19f824=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x1c5)]],_0x10770c=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x1b5)]],_0x30a8f9=[..._0x43cc94[_0x16db20(0x227)]['New_Qty_Converted']],_0x314f00=[..._0x43cc94[_0x16db20(0x227)]['to_prod_level']],_0x153da7=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x18b)]],_0x582445=[..._0x43cc94[_0x16db20(0x227)]['secondary_code']],_0x33a052=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x22e)]],_0x4af445=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x196)]],_0x5eaf92=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x1dc)]],_0x1ad1e2=[..._0x43cc94[_0x16db20(0x227)]['secondary_unit']],_0x559834=[..._0x43cc94[_0x16db20(0x227)]['batch_code']],_0x27fe79=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x1f4)]],_0x422576=[..._0x43cc94[_0x16db20(0x227)]['product_date']],_0x170a8c=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x1ca)]],_0xb686dc=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x1e4)]],_0x3298bb=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x194)]],_0x42d260=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x1de)]],_0x5bfb91=[..._0x43cc94['body'][_0x16db20(0x176)]],_0x250087=[..._0x43cc94['body'][_0x16db20(0x184)]],_0x23656f=[..._0x43cc94[_0x16db20(0x227)][_0x16db20(0x173)]];const _0x13487d=_0x496859[_0x16db20(0x1bd)](_0x441f7d=>{return _0x441f7d={'product_name':_0x441f7d};});_0x19f824[_0x16db20(0x221)]((_0x4c0a29,_0x2a7d3b)=>{var _0x1e535c=_0x16db20;_0x13487d[_0x2a7d3b][_0x1e535c(0x1c7)]=_0x4c0a29;}),_0x10770c['forEach']((_0x27f733,_0x1c8ac9)=>{var _0x273f26=_0x16db20,_0x3e6ce1=_0x27f733[_0x273f26(0x1d3)](/[A-Za-z]+/)[0x0],_0x419bf0=parseInt(_0x27f733[_0x273f26(0x1d3)](/\d+/)[0x0]);_0x13487d[_0x1c8ac9][_0x273f26(0x186)]=_0x419bf0,_0x13487d[_0x1c8ac9][_0x273f26(0x1d1)]=_0x3e6ce1;}),_0x23656f[_0x16db20(0x221)]((_0x302705,_0x1c4d44)=>{var _0x4d37c0=_0x16db20;_0x13487d[_0x1c4d44][_0x4d37c0(0x173)]=_0x302705;}),_0x250087['forEach']((_0x55a876,_0x75622c)=>{var _0x2e26b3=_0x16db20;_0x13487d[_0x75622c][_0x2e26b3(0x184)]=_0x55a876;}),_0x30a8f9[_0x16db20(0x221)]((_0x17a2b0,_0x1e6b1a)=>{var _0x110da8=_0x16db20;_0x13487d[_0x1e6b1a][_0x110da8(0x1ed)]=_0x17a2b0;}),_0x314f00['forEach']((_0x3b883f,_0x4d4ade)=>{var _0x3e90c2=_0x16db20,_0x59c1e5=_0x3b883f[_0x3e90c2(0x1d3)](/[A-Za-z]+/)[0x0],_0x1152fc=parseInt(_0x3b883f[_0x3e90c2(0x1d3)](/\d+/)[0x0]);_0x13487d[_0x4d4ade][_0x3e90c2(0x200)]=_0x59c1e5,_0x13487d[_0x4d4ade][_0x3e90c2(0x1e3)]=_0x1152fc;}),_0x153da7[_0x16db20(0x221)]((_0x4f1f3e,_0x49b460)=>{var _0x1af056=_0x16db20;_0x13487d[_0x49b460][_0x1af056(0x18b)]=_0x4f1f3e;}),_0x582445['forEach']((_0x2bae33,_0x2e3bb5)=>{_0x13487d[_0x2e3bb5]['secondary_code']=_0x2bae33;}),_0x33a052[_0x16db20(0x221)]((_0x269419,_0x289df1)=>{_0x13487d[_0x289df1]['product_code']=_0x269419;}),_0x4af445['forEach']((_0x411106,_0x2d0d7e)=>{var _0x276868=_0x16db20;_0x13487d[_0x2d0d7e][_0x276868(0x17d)]=_0x411106;}),_0x5eaf92[_0x16db20(0x221)]((_0x5a0a76,_0xa216ff)=>{_0x13487d[_0xa216ff]['unit']=_0x5a0a76;}),_0x1ad1e2['forEach']((_0x1fee21,_0x4d1311)=>{var _0x2732c8=_0x16db20;_0x13487d[_0x4d1311][_0x2732c8(0x17b)]=_0x1fee21;}),_0x559834[_0x16db20(0x221)]((_0x14cb5e,_0x398897)=>{var _0x2b85ad=_0x16db20;_0x13487d[_0x398897][_0x2b85ad(0x1ad)]=_0x14cb5e;}),_0x27fe79[_0x16db20(0x221)]((_0x4f1a28,_0x52f3d7)=>{var _0x3a0698=_0x16db20;_0x13487d[_0x52f3d7][_0x3a0698(0x1f4)]=_0x4f1a28;}),_0x422576[_0x16db20(0x221)]((_0x182b6b,_0x267476)=>{var _0x371d07=_0x16db20;_0x13487d[_0x267476][_0x371d07(0x1ff)]=_0x182b6b;}),_0x170a8c[_0x16db20(0x221)]((_0xd79f10,_0x43b24b)=>{var _0x44cf81=_0x16db20;_0x13487d[_0x43b24b][_0x44cf81(0x17d)]=_0xd79f10;}),_0xb686dc['forEach']((_0x3ef5fc,_0x35931c)=>{var _0x1b081a=_0x16db20;_0x13487d[_0x35931c][_0x1b081a(0x1e4)]=_0x3ef5fc;}),_0x3298bb[_0x16db20(0x221)]((_0x15804f,_0x2b9986)=>{var _0x57fdf1=_0x16db20;_0x13487d[_0x2b9986][_0x57fdf1(0x194)]=_0x15804f;}),_0x42d260[_0x16db20(0x221)]((_0xb1a81d,_0x403803)=>{var _0x3749c=_0x16db20;_0x13487d[_0x403803][_0x3749c(0x17c)]=_0xb1a81d;}),_0x5bfb91[_0x16db20(0x221)]((_0x3f299b,_0x56378c)=>{var _0x1e44f1=_0x16db20;_0x13487d[_0x56378c][_0x1e44f1(0x222)]=_0x3f299b;});const _0x41b151=_0x13487d['filter'](_0x154a60=>_0x154a60[_0x16db20(0x1ed)]!=='0'&&_0x154a60[_0x16db20(0x1ed)]!==''||_0x154a60[_0x16db20(0x1e7)]!=='0'&&_0x154a60[_0x16db20(0x1e7)]!=='');var _0x2d03bf=0x0;_0x41b151['forEach'](_0x4224d2=>{parseInt(_0x4224d2['from_quantity'])<parseInt(_0x4224d2['to_quantity'])&&_0x2d03bf++;});if(_0x2d03bf!=0x0)return _0x43cc94[_0x16db20(0x1c6)](_0x16db20(0x19e),_0x16db20(0x201)),_0x6ee6d6[_0x16db20(0x1ba)]('back');const _0x1c634b=new invoice_for_transfer();await _0x1c634b['save']();for(let _0x2905d3=0x0;_0x2905d3<=_0x5bfb91[_0x16db20(0x1f5)]-0x1;_0x2905d3++){_0x13487d[_0x2905d3][_0x16db20(0x215)]=_0x16db20(0x193)+_0x1c634b[_0x16db20(0x1db)][_0x16db20(0x229)]()['padStart'](0x8,'0');}const _0x5118fa=new transfers_finished({'date':_0x2e0249,'from_warehouse':_0x444f98,'to_warehouse':_0x520ceb,'product':_0x41b151,'note':_0x56ab69,'invoice':_0x16db20(0x193)+_0x1c634b[_0x16db20(0x1db)][_0x16db20(0x229)]()[_0x16db20(0x1b6)](0x8,'0'),'type_of_transaction':_0x16db20(0x1a0),'type_of_process':'location2location','PO_number':_0x2abe2a,'RequestedBy':_0x251757,'DateofRequest':_0x2a7d93,'typeservices':_0x3f506b,'destination':_0x3f278c,'deliverydate':_0x2a6215,'driver':_0x143729,'plate':_0x5451fb,'van':_0x8cc6ce,'DRSI':_0x3539e4,'typevehicle':_0x388098,'TSU':_0x5146eb,'TFU':_0x147ba4}),_0x1c0b9e=await _0x5118fa['save']();_0x43cc94[_0x16db20(0x1c6)](_0x16db20(0x177),'Product\x20Transfer\x20successfully'),_0x6ee6d6[_0x16db20(0x1ba)](_0x16db20(0x1b1)+_0x1c0b9e[_0x16db20(0x1a1)]);}catch(_0x3f3cf){console[_0x16db20(0x1a8)](_0x3f3cf),_0x6ee6d6[_0x16db20(0x1aa)](0xc8)[_0x16db20(0x1a2)]({'errorMessage':_0x3f3cf[_0x16db20(0x181)]});}}),router['get'](a0_0x17edbc(0x1e6),auth,async(_0x409c35,_0x37cb37)=>{var _0x4fbec0=a0_0x17edbc;try{const {username:_0x219819,email:_0xee4b43,role:_0x53ee90}=_0x409c35[_0x4fbec0(0x1f3)],_0x140da9=_0x409c35['user'],_0x2a734c=await profile[_0x4fbec0(0x213)]({'email':_0x140da9['email']}),_0x16e002=await master_shop['find'](),_0x346116=await transfers_finished['findById'](_0x409c35[_0x4fbec0(0x202)]['id']);let _0x42fd5e;if(_0x140da9[_0x4fbec0(0x21d)]==_0x4fbec0(0x1bf)){const _0x4aa361=await staff['findOne']({'email':_0x140da9['email']});_0x42fd5e=await warehouse['find']({'status':'Enabled','name':_0x4aa361[_0x4fbec0(0x204)],'warehouse_category':_0x4fbec0(0x1f0)});}else _0x42fd5e=await warehouse[_0x4fbec0(0x190)]({'status':_0x4fbec0(0x1eb),'warehouse_category':_0x4fbec0(0x1f0)});const _0x522a81=await warehouse[_0x4fbec0(0x1bb)]([{'$match':{'name':_0x346116[_0x4fbec0(0x206)],'warehouse_category':_0x4fbec0(0x1f0)}},{'$unwind':_0x4fbec0(0x22a)},{'$group':{'_id':_0x4fbec0(0x1e8),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4fbec0(0x175)},'bay':{'$first':_0x4fbec0(0x1af)},'bin':{'$first':_0x4fbec0(0x1c2)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4fbec0(0x219)},'primary_code':{'$first':_0x4fbec0(0x1f2)},'secondary_code':{'$first':_0x4fbec0(0x1cc)},'product_code':{'$first':_0x4fbec0(0x1d5)},'storage':{'$first':_0x4fbec0(0x1df)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4fbec0(0x172)},'room':{'$first':_0x4fbec0(0x1fd)},'warehoue_name':{'$first':'$name'}}}]),_0x46d430=await product[_0x4fbec0(0x190)]({});if(_0x16e002[0x0][_0x4fbec0(0x1ef)]==_0x4fbec0(0x198)){var _0x34b68f=users[_0x4fbec0(0x217)];console[_0x4fbec0(0x1a8)](_0x34b68f);}else{if(_0x16e002[0x0][_0x4fbec0(0x1ef)]==_0x4fbec0(0x1a3))var _0x34b68f=users[_0x4fbec0(0x1a3)];else{if(_0x16e002[0x0][_0x4fbec0(0x1ef)]==_0x4fbec0(0x1f9))var _0x34b68f=users[_0x4fbec0(0x1f9)];else{if(_0x16e002[0x0][_0x4fbec0(0x1ef)]=='Spanish')var _0x34b68f=users[_0x4fbec0(0x21a)];else{if(_0x16e002[0x0][_0x4fbec0(0x1ef)]==_0x4fbec0(0x1ac))var _0x34b68f=users[_0x4fbec0(0x1ac)];else{if(_0x16e002[0x0][_0x4fbec0(0x1ef)]==_0x4fbec0(0x1d7))var _0x34b68f=users[_0x4fbec0(0x188)];else{if(_0x16e002[0x0][_0x4fbec0(0x1ef)]==_0x4fbec0(0x223))var _0x34b68f=users[_0x4fbec0(0x223)];else{if(_0x16e002[0x0][_0x4fbec0(0x1ef)]==_0x4fbec0(0x1c8))var _0x34b68f=users[_0x4fbec0(0x1c1)];}}}}}}}_0x37cb37['render'](_0x4fbec0(0x21f),{'success':_0x409c35[_0x4fbec0(0x1c6)](_0x4fbec0(0x177)),'errors':_0x409c35[_0x4fbec0(0x1c6)](_0x4fbec0(0x19e)),'role':_0x140da9,'profile':_0x2a734c,'master_shop':_0x16e002,'warehouse':_0x42fd5e,'transfer':_0x346116,'stock':_0x522a81,'unit':_0x46d430,'language':_0x34b68f});}catch(_0x2c7cfb){console[_0x4fbec0(0x1a8)](_0x2c7cfb);}}),router['post']('/preview/:id',auth,async(_0x5a2b35,_0x5a6282)=>{var _0x4d10ed=a0_0x17edbc;try{const {invoice:_0xda6529,from_warehouse:_0x130f44,FromRoom_name:_0x483b4e,to_warehouse:_0x4e3c5b,ToRoom_name:_0x276103}=_0x5a2b35[_0x4d10ed(0x227)],_0x31a23f=await transfers_finished[_0x4d10ed(0x1b4)](_0x5a2b35[_0x4d10ed(0x202)]['id']),_0x665c77=_0x31a23f[_0x4d10ed(0x174)][_0x4d10ed(0x1bd)](async _0x5c7b25=>{var _0x52fe93=_0x4d10ed;if(_0x5c7b25[_0x52fe93(0x1ed)]>0x0){var _0x322180=await warehouse['findOne']({'name':_0x130f44,'room':_0x5c7b25[_0x52fe93(0x17c)]});const _0x32f2a4=_0x322180['product_details'][_0x52fe93(0x1bd)](_0x3e7152=>{var _0xa978f0=_0x52fe93;_0x3e7152[_0xa978f0(0x1a1)]==_0x5c7b25[_0xa978f0(0x173)]&&(_0x3e7152[_0xa978f0(0x228)]=Math[_0xa978f0(0x16b)](0x0,Math[_0xa978f0(0x1ea)](_0x3e7152[_0xa978f0(0x228)])-Math[_0xa978f0(0x1ea)](_0x5c7b25['to_quantity'])),console[_0xa978f0(0x1a8)](_0x3e7152['product_stock']));});}return _0x322180;});Promise[_0x4d10ed(0x20a)](_0x665c77)[_0x4d10ed(0x1b9)](async _0x148a13=>{var _0x5a334b=_0x4d10ed;try{for(const _0x3c1bea of _0x148a13){await _0x3c1bea[_0x5a334b(0x220)]();}const _0x257908=_0x31a23f[_0x5a334b(0x174)]['map'](async _0x2018f3=>{var _0x5f2d95=_0x5a334b,_0x51be1e=await warehouse[_0x5f2d95(0x213)]({'name':_0x4e3c5b,'room':_0x2018f3[_0x5f2d95(0x222)]});if(_0x2018f3[_0x5f2d95(0x1ed)]>0x0){var _0x22fb5a=0x0;const _0x647dc=_0x51be1e[_0x5f2d95(0x19b)][_0x5f2d95(0x1bd)](_0x132839=>{var _0x2e6132=_0x5f2d95;_0x132839['product_name']==_0x2018f3['product_name']&&_0x132839[_0x2e6132(0x214)]==_0x2018f3['to_bay']&&_0x132839[_0x2e6132(0x1f4)]==_0x2018f3[_0x2e6132(0x1f4)]&&_0x132839[_0x2e6132(0x1ff)]==_0x2018f3[_0x2e6132(0x1ff)]&&_0x132839[_0x2e6132(0x1ad)]==_0x2018f3[_0x2e6132(0x1ad)]&&_0x132839[_0x2e6132(0x1b8)]==_0x2018f3['To_invoice']&&(typeof _0x2018f3[_0x2e6132(0x173)]=='undefined'?(console['log'](_0x2e6132(0x216),_0x132839[_0x2e6132(0x228)]+_0x2e6132(0x21c)+_0x132839[_0x2e6132(0x1a1)]+_0x2e6132(0x1e9)+Math[_0x2e6132(0x1ea)](_0x132839[_0x2e6132(0x228)])+Math[_0x2e6132(0x1ea)](_0x2018f3[_0x2e6132(0x1ed)])),_0x132839['product_stock']=Math[_0x2e6132(0x1ea)](_0x132839['product_stock'])+Math['abs'](_0x2018f3[_0x2e6132(0x1ed)])):_0x132839[_0x2e6132(0x228)]=Math[_0x2e6132(0x1ea)](_0x132839[_0x2e6132(0x228)])+Math[_0x2e6132(0x1ea)](_0x2018f3['to_quantity']),_0x22fb5a++);});_0x22fb5a=='0'&&(_0x51be1e[_0x5f2d95(0x19b)]=_0x51be1e[_0x5f2d95(0x19b)]['concat']({'product_name':_0x2018f3[_0x5f2d95(0x1f8)],'product_stock':_0x2018f3[_0x5f2d95(0x1ed)],'bay':_0x2018f3[_0x5f2d95(0x1e3)],'level':_0x2018f3[_0x5f2d95(0x200)],'product_code':_0x2018f3[_0x5f2d95(0x1d0)],'primary_code':_0x2018f3['primary_code'],'secondary_code':_0x2018f3['secondary_code'],'expiry_date':_0x2018f3['expiry_date'],'production_date':_0x2018f3[_0x5f2d95(0x1ff)],'maxProducts':_0x2018f3[_0x5f2d95(0x17d)],'batch_code':_0x2018f3[_0x5f2d95(0x1ad)],'secondary_unit':_0x2018f3[_0x5f2d95(0x17b)],'unit':_0x2018f3['unit'],'maxProducts':_0x2018f3['maxProducts'],'maxPerUnit':_0x2018f3[_0x5f2d95(0x1e4)],'invoice':_0x2018f3[_0x5f2d95(0x215)]}));}return _0x51be1e;});Promise[_0x5a334b(0x20a)](_0x257908)[_0x5a334b(0x1b9)](async _0x4614d9=>{var _0x241e0a=_0x5a334b;try{console[_0x241e0a(0x1a8)](_0x31a23f[_0x241e0a(0x189)]);if(_0x31a23f[_0x241e0a(0x189)]!='location2location')for(const _0xc43153 of _0x4614d9){await warehouse['updateOne']({'_id':_0xc43153['_id']},{'$addToSet':{'product_details':{'$each':_0xc43153[_0x241e0a(0x19b)]}}});}_0x31a23f[_0x241e0a(0x22b)]='True';const _0x1526fe=await _0x31a23f[_0x241e0a(0x220)](),_0x4cb0d7=await master_shop['find'](),_0x2111d1=await email_settings[_0x241e0a(0x213)](),_0x813390=await supervisor_settings[_0x241e0a(0x190)]();var _0x54dac3=_0x31a23f[_0x241e0a(0x174)],_0xe5fddd='',_0x458437;for(_0x458437 in _0x54dac3){var _0x181739='FG';_0x31a23f[_0x241e0a(0x17a)]==_0x241e0a(0x19c)&&(_0x181739='DG'),_0xe5fddd+=_0x241e0a(0x20f)+_0x241e0a(0x20c)+_0x54dac3[_0x458437][_0x241e0a(0x1f8)]+_0x241e0a(0x1d6)+_0x241e0a(0x20c)+_0x54dac3[_0x458437][_0x241e0a(0x1d0)]+_0x241e0a(0x1d6)+_0x241e0a(0x20c)+_0x54dac3[_0x458437][_0x241e0a(0x1ed)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54dac3[_0x458437][_0x241e0a(0x18a)]+'</td>'+_0x241e0a(0x20c)+_0x54dac3[_0x458437][_0x241e0a(0x17b)]+_0x241e0a(0x1d6)+_0x241e0a(0x20c)+_0x31a23f[_0x241e0a(0x17a)]+_0x241e0a(0x1d6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54dac3[_0x458437]['to_room_name']+_0x241e0a(0x1d6)+_0x241e0a(0x20c)+_0x181739+_0x54dac3[_0x458437][_0x241e0a(0x1e3)]+_0x241e0a(0x1d6)+_0x241e0a(0x1c0);}_0x5a2b35['flash'](_0x241e0a(0x177),'Transfer\x20Finalize\x20Successfully'),_0x5a6282[_0x241e0a(0x1ba)](_0x241e0a(0x1c3)+_0x1526fe[_0x241e0a(0x1a1)]);}catch(_0x5b8e9b){console[_0x241e0a(0x224)](_0x5b8e9b),_0x5a6282['status'](0x1f4)[_0x241e0a(0x1a2)]({'error':_0x241e0a(0x1e1)});}})['catch'](_0x220752=>{var _0x1fcead=_0x5a334b;console[_0x1fcead(0x224)](_0x220752),_0x5a6282['status'](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x448626){console[_0x5a334b(0x224)](_0x448626),_0x5a6282[_0x5a334b(0x1aa)](0x1f4)['json']({'error':_0x5a334b(0x20b)});}})[_0x4d10ed(0x169)](_0x19b923=>{var _0x513c92=_0x4d10ed;console['error'](_0x19b923),_0x5a6282[_0x513c92(0x1aa)](0x1f4)[_0x513c92(0x1a2)]({'error':_0x513c92(0x21b)});});}catch(_0x5d2893){_0x5a6282['json']({'message':_0x5d2893[_0x4d10ed(0x181)]});}});function BayBinSelected(_0x4b6940,_0x5f3070){var _0x31f1f0=a0_0x17edbc,_0xa1e61e=[];let _0x51a3e1=[];var _0x53741f=[];if(_0x4b6940==_0x31f1f0(0x19c)){switch(_0x5f3070){case _0x31f1f0(0x1bc):_0xa1e61e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0xa1e61e=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x53741f=['DG'];}else{if(_0x4b6940==_0x31f1f0(0x218)){switch(_0x5f3070){case'Rack\x201':_0xa1e61e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x31f1f0(0x179):_0xa1e61e=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x53741f=['FG'];}}return{'levels':_0xa1e61e,'identify':_0x53741f};}router[a0_0x17edbc(0x1d4)](a0_0x17edbc(0x1b2),auth,async(_0x4be051,_0x50a956)=>{var _0x485c00=a0_0x17edbc;try{const {username:_0x5f359f,email:_0x117184,role:_0xb82015}=_0x4be051[_0x485c00(0x1f3)],_0x3a32eb=_0x4be051[_0x485c00(0x1f3)],_0x4dbf32=await profile[_0x485c00(0x213)]({'email':_0x3a32eb['email']}),_0x3d9516=await master_shop['find'](),_0x537893=await transfers_finished[_0x485c00(0x1b4)](_0x4be051[_0x485c00(0x202)]['id']);let _0x27fc3a=new Date(_0x537893[_0x485c00(0x1f4)]),_0x29d92d=('0'+_0x27fc3a[_0x485c00(0x1a5)]())[_0x485c00(0x1fb)](-0x2),_0x398bcb=('0'+(_0x27fc3a[_0x485c00(0x1c9)]()+0x1))[_0x485c00(0x1fb)](-0x2),_0xcbf7f7=_0x27fc3a[_0x485c00(0x18c)](),_0x3494cd=_0xcbf7f7+'-'+_0x398bcb+'-'+_0x29d92d,_0x4f2ebd;if(_0x3a32eb[_0x485c00(0x21d)]==_0x485c00(0x1bf)){const _0x274dbb=await staff[_0x485c00(0x213)]({'email':_0x3a32eb[_0x485c00(0x18e)]});_0x4f2ebd=await warehouse['find']({'status':_0x485c00(0x1eb),'name':_0x274dbb[_0x485c00(0x204)],'warehouse_category':_0x485c00(0x1f0)});}else _0x4f2ebd=await warehouse['find']({'status':'Enabled','warehouse_category':'Finished\x20Goods'});const _0x1142c2=await warehouse[_0x485c00(0x1bb)]([{'$match':{'name':_0x537893[_0x485c00(0x206)],'room':_0x537893[_0x485c00(0x20d)]}},{'$unwind':_0x485c00(0x22a)},{'$group':{'_id':_0x485c00(0x1e8),'name':{'$first':_0x485c00(0x1d2)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x485c00(0x1af)},'bin':{'$first':_0x485c00(0x1c2)},'type':{'$first':_0x485c00(0x1b7)},'floorlevel':{'$first':_0x485c00(0x219)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x485c00(0x1cc)},'product_code':{'$first':_0x485c00(0x1d5)},'storage':{'$first':_0x485c00(0x1df)},'rack':{'$first':_0x485c00(0x205)}}}]);var _0x58cc8e=[0x1,0x2,0x3,0x4],_0x454620=['A','B','C','D','E','F','G','H','I','J'],_0x3d8256=['Ambient',_0x485c00(0x211)];const _0x2d2f99=await product[_0x485c00(0x190)]({}),_0x12fa7d=BayBinSelected(_0x537893[_0x485c00(0x17a)],_0x537893[_0x485c00(0x1ce)]);if(_0x3d9516[0x0]['language']==_0x485c00(0x198)){var _0x5e690b=users[_0x485c00(0x217)];console[_0x485c00(0x1a8)](_0x5e690b);}else{if(_0x3d9516[0x0][_0x485c00(0x1ef)]==_0x485c00(0x1a3))var _0x5e690b=users[_0x485c00(0x1a3)];else{if(_0x3d9516[0x0]['language']==_0x485c00(0x1f9))var _0x5e690b=users[_0x485c00(0x1f9)];else{if(_0x3d9516[0x0][_0x485c00(0x1ef)]==_0x485c00(0x21a))var _0x5e690b=users['Spanish'];else{if(_0x3d9516[0x0][_0x485c00(0x1ef)]==_0x485c00(0x1ac))var _0x5e690b=users[_0x485c00(0x1ac)];else{if(_0x3d9516[0x0][_0x485c00(0x1ef)]=='Portuguese\x20(BR)')var _0x5e690b=users[_0x485c00(0x188)];else{if(_0x3d9516[0x0][_0x485c00(0x1ef)]==_0x485c00(0x223))var _0x5e690b=users[_0x485c00(0x223)];else{if(_0x3d9516[0x0][_0x485c00(0x1ef)]==_0x485c00(0x1c8))var _0x5e690b=users['Arabic'];}}}}}}}_0x50a956[_0x485c00(0x1e2)]('edit_transfer_finished',{'success':_0x4be051['flash'](_0x485c00(0x177)),'errors':_0x4be051['flash'](_0x485c00(0x19e)),'role':_0x3a32eb,'profile':_0x4dbf32,'master_shop':_0x3d9516,'warehouse':_0x4f2ebd,'transfer':_0x537893,'stock':_0x1142c2,'unit':_0x2d2f99,'language':_0x5e690b,'levels':_0x58cc8e,'Isle':_0x454620,'rooms_data':_0x3d8256,'ed_fullDate':_0x3494cd,'dataSelected':_0x12fa7d});}catch(_0x2890ae){console['log'](_0x2890ae);}}),router[a0_0x17edbc(0x1e0)](a0_0x17edbc(0x1b2),auth,async(_0x39db51,_0x48a67e)=>{var _0x344bc6=a0_0x17edbc;try{const _0x1b8905=_0x39db51[_0x344bc6(0x202)]['id'];console[_0x344bc6(0x1a8)](_0x39db51['body']);const _0x5f58fe=await transfers_finished[_0x344bc6(0x1b4)](_0x1b8905);console[_0x344bc6(0x1a8)]('transfer_data',_0x5f58fe);const {date:_0x145c46,from_warehouse:_0x9caeac,FromRoom_name:_0x2d3e77,to_warehouse:_0x10dd05,ToRoom_name:_0x3603bc,prod_name:_0x250bad,from_prod_qty:_0x539602,from_prod_level:_0x4015fe,from_prod_isle:_0x22adb6,from_prod_pallet:_0x59625c,to_prod_qty:_0x12e93c,to_prod_level:_0x405815,to_prod_isle:_0x4db63d,to_prod_pallet:_0x109555,primary_code:_0x507b31,secondary_code:_0x27611c,product_code3:_0x777e2b,note:_0x15ddb6,invoice:_0x2e1acf,expiry_date:_0x12c196}=_0x39db51[_0x344bc6(0x227)];if(typeof _0x250bad==_0x344bc6(0x225))var _0x42f27a=[_0x39db51[_0x344bc6(0x227)]['prod_name']],_0x48ddf2=[_0x39db51[_0x344bc6(0x227)]['from_prod_qty']],_0x12a28c=[_0x39db51[_0x344bc6(0x227)][_0x344bc6(0x1be)]],_0x5cdfbe=[_0x39db51[_0x344bc6(0x227)][_0x344bc6(0x16e)]],_0xd511f9=[_0x39db51[_0x344bc6(0x227)]['to_prod_level']],_0x53629f=[_0x39db51['body'][_0x344bc6(0x18b)]],_0x29edd0=[_0x39db51['body']['secondary_code']],_0x53a073=[_0x39db51[_0x344bc6(0x227)][_0x344bc6(0x22e)]],_0x4711ee=[_0x39db51['body'][_0x344bc6(0x196)]],_0x5b0d13=[_0x39db51[_0x344bc6(0x227)][_0x344bc6(0x18a)]],_0x38a01d=[_0x39db51['body'][_0x344bc6(0x17b)]],_0x408316=[_0x39db51[_0x344bc6(0x227)][_0x344bc6(0x1ad)]],_0x84ec94=[_0x39db51[_0x344bc6(0x227)][_0x344bc6(0x1f4)]];else var _0x42f27a=[..._0x39db51[_0x344bc6(0x227)][_0x344bc6(0x212)]],_0x48ddf2=[..._0x39db51[_0x344bc6(0x227)][_0x344bc6(0x1c5)]],_0x12a28c=[..._0x39db51[_0x344bc6(0x227)][_0x344bc6(0x1be)]],_0x5cdfbe=[..._0x39db51['body'][_0x344bc6(0x16e)]],_0xd511f9=[..._0x39db51[_0x344bc6(0x227)][_0x344bc6(0x226)]],_0x53629f=[..._0x39db51['body']['primary_code']],_0x29edd0=[..._0x39db51['body']['secondary_code']],_0x53a073=[..._0x39db51[_0x344bc6(0x227)][_0x344bc6(0x22e)]],_0x4711ee=[..._0x39db51[_0x344bc6(0x227)][_0x344bc6(0x196)]],_0x5b0d13=[..._0x39db51['body'][_0x344bc6(0x18a)]],_0x38a01d=[..._0x39db51[_0x344bc6(0x227)][_0x344bc6(0x17b)]],_0x408316=[..._0x39db51[_0x344bc6(0x227)]['batch_code']],_0x84ec94=[..._0x39db51[_0x344bc6(0x227)][_0x344bc6(0x1f4)]];const _0x44ea7c=_0x42f27a[_0x344bc6(0x1bd)](_0x38c6a4=>{return _0x38c6a4={'product_name':_0x38c6a4};});_0x48ddf2[_0x344bc6(0x221)]((_0x49f3a2,_0x32bd63)=>{var _0x269812=_0x344bc6;_0x44ea7c[_0x32bd63][_0x269812(0x1c7)]=_0x49f3a2;}),_0x12a28c[_0x344bc6(0x221)]((_0x39703d,_0x321d69)=>{_0x44ea7c[_0x321d69]['from_bay']=_0x39703d;}),_0x5cdfbe[_0x344bc6(0x221)]((_0xa3142e,_0x37630d)=>{_0x44ea7c[_0x37630d]['to_quantity']=_0xa3142e;}),_0xd511f9['forEach']((_0x2ae449,_0x239128)=>{var _0x111069=_0x344bc6;_0x44ea7c[_0x239128][_0x111069(0x1e3)]=_0x2ae449;}),_0x53629f[_0x344bc6(0x221)]((_0x27fd07,_0x5546c9)=>{var _0x1975d3=_0x344bc6;_0x44ea7c[_0x5546c9][_0x1975d3(0x18b)]=_0x27fd07;}),_0x29edd0['forEach']((_0x443af4,_0x3914e5)=>{var _0x5020b1=_0x344bc6;_0x44ea7c[_0x3914e5][_0x5020b1(0x1ae)]=_0x443af4;}),_0x53a073[_0x344bc6(0x221)]((_0x13b9e7,_0x428876)=>{_0x44ea7c[_0x428876]['product_code']=_0x13b9e7;}),_0x4711ee[_0x344bc6(0x221)]((_0x2545d5,_0x28f89c)=>{var _0x4bd762=_0x344bc6;_0x44ea7c[_0x28f89c][_0x4bd762(0x17d)]=_0x2545d5;}),_0x5b0d13[_0x344bc6(0x221)]((_0x553bc3,_0x4159f1)=>{var _0x564e8e=_0x344bc6;_0x44ea7c[_0x4159f1][_0x564e8e(0x18a)]=_0x553bc3;}),_0x38a01d[_0x344bc6(0x221)]((_0x3cd2a7,_0x4a437b)=>{var _0x34de46=_0x344bc6;_0x44ea7c[_0x4a437b][_0x34de46(0x17b)]=_0x3cd2a7;}),_0x408316['forEach']((_0x526a87,_0x14c1a9)=>{var _0x4abf92=_0x344bc6;_0x44ea7c[_0x14c1a9][_0x4abf92(0x1ad)]=_0x526a87;}),_0x84ec94[_0x344bc6(0x221)]((_0x3a408b,_0x208ba9)=>{_0x44ea7c[_0x208ba9]['expiry_date']=_0x3a408b;});const _0x2ff651=_0x44ea7c[_0x344bc6(0x16c)](_0x5ee782=>_0x5ee782[_0x344bc6(0x1ed)]!=='0'&&_0x5ee782[_0x344bc6(0x1ed)]!==''||_0x5ee782[_0x344bc6(0x1e7)]!=='0'&&_0x5ee782[_0x344bc6(0x1e7)]!=='');var _0x170f1b=0x0;_0x2ff651[_0x344bc6(0x221)](_0x551701=>{var _0x5cc86b=_0x344bc6;parseInt(_0x551701['from_quantity'])<parseInt(_0x551701[_0x5cc86b(0x1ed)])&&_0x170f1b++;});if(_0x170f1b!=0x0)return _0x39db51[_0x344bc6(0x1c6)](_0x344bc6(0x19e),_0x344bc6(0x201)),_0x48a67e[_0x344bc6(0x1ba)](_0x344bc6(0x1fc));const _0x3cc9d9=await warehouse[_0x344bc6(0x213)]({'name':_0x5f58fe[_0x344bc6(0x206)],'room':_0x5f58fe[_0x344bc6(0x20d)]});_0x5f58fe[_0x344bc6(0x174)][_0x344bc6(0x221)](_0x19e186=>{var _0x5d3db1=_0x344bc6;if(_0x19e186[_0x5d3db1(0x1ed)]>0x0){const _0x1065aa=_0x3cc9d9[_0x5d3db1(0x19b)][_0x5d3db1(0x1bd)](_0xe2a816=>{var _0x22a2da=_0x5d3db1;_0xe2a816[_0x22a2da(0x1f8)]==_0x19e186[_0x22a2da(0x1f8)]&&_0xe2a816[_0x22a2da(0x214)]==_0x19e186[_0x22a2da(0x186)]&&(_0xe2a816[_0x22a2da(0x228)]=parseInt(_0xe2a816[_0x22a2da(0x228)])+parseInt(_0x19e186['to_quantity']));});}}),await _0x3cc9d9[_0x344bc6(0x220)]();const _0x3141dd=await warehouse['findOne']({'name':_0x5f58fe[_0x344bc6(0x17a)],'room':_0x5f58fe[_0x344bc6(0x1ce)]});_0x5f58fe['product']['forEach'](_0x67f05b=>{var _0x5e1d75=_0x344bc6;if(_0x67f05b['to_quantity']>0x0){const _0x4982eb=_0x3141dd['product_details'][_0x5e1d75(0x1bd)](_0xb6f8d5=>{var _0x51990f=_0x5e1d75;_0xb6f8d5[_0x51990f(0x1f8)]==_0x67f05b['product_name']&&_0xb6f8d5['bay']==_0x67f05b[_0x51990f(0x1e3)]&&(_0xb6f8d5[_0x51990f(0x228)]=parseInt(_0xb6f8d5[_0x51990f(0x228)])-parseInt(_0x67f05b[_0x51990f(0x1ed)]));});}}),await _0x3141dd['save'](),_0x5f58fe[_0x344bc6(0x170)]=_0x145c46,_0x5f58fe[_0x344bc6(0x206)]=_0x9caeac,_0x5f58fe[_0x344bc6(0x17a)]=_0x10dd05,_0x5f58fe[_0x344bc6(0x174)]=_0x2ff651,_0x5f58fe[_0x344bc6(0x19a)]=_0x15ddb6,_0x5f58fe[_0x344bc6(0x1b8)]=_0x2e1acf;const _0x5ba62f=await _0x5f58fe[_0x344bc6(0x220)](),_0xdacf9=await warehouse['findOne']({'name':_0x9caeac,'room':_0x2d3e77});_0x5ba62f[_0x344bc6(0x174)][_0x344bc6(0x221)](_0x326175=>{var _0x471270=_0x344bc6;if(_0x326175[_0x471270(0x1ed)]>0x0){const _0x5e0085=_0xdacf9[_0x471270(0x19b)][_0x471270(0x1bd)](_0x4b9fa3=>{var _0x58f461=_0x471270;_0x4b9fa3[_0x58f461(0x1f8)]==_0x326175[_0x58f461(0x1f8)]&&_0x4b9fa3[_0x58f461(0x214)]==_0x326175[_0x58f461(0x186)]&&(_0x4b9fa3[_0x58f461(0x228)]=parseInt(_0x4b9fa3[_0x58f461(0x228)])-parseInt(_0x326175['to_quantity']));});}}),await _0xdacf9[_0x344bc6(0x220)]();const _0x34ba54=await warehouse[_0x344bc6(0x213)]({'name':_0x10dd05,'room':_0x3603bc});_0x5ba62f[_0x344bc6(0x174)]['forEach'](_0x2776c0=>{var _0x433fa7=_0x344bc6;if(_0x2776c0[_0x433fa7(0x1ed)]>0x0){var _0x32bf0f=0x0;const _0x258ad2=_0x34ba54[_0x433fa7(0x19b)][_0x433fa7(0x1bd)](_0x4b74de=>{var _0x333aef=_0x433fa7;_0x4b74de[_0x333aef(0x1f8)]==_0x2776c0['product_name']&&_0x4b74de[_0x333aef(0x214)]==_0x2776c0['to_bay']&&(_0x4b74de[_0x333aef(0x228)]=parseInt(_0x4b74de[_0x333aef(0x228)])+parseInt(_0x2776c0[_0x333aef(0x1ed)]),_0x32bf0f++);});_0x32bf0f=='0'&&(_0x34ba54[_0x433fa7(0x19b)]=_0x34ba54[_0x433fa7(0x19b)][_0x433fa7(0x1f6)]({'product_name':_0x2776c0['product_name'],'product_stock':_0x2776c0[_0x433fa7(0x1ed)],'bay':_0x2776c0[_0x433fa7(0x1e3)],'product_code':_0x2776c0[_0x433fa7(0x1d0)],'primary_code':_0x2776c0[_0x433fa7(0x18b)],'secondary_code':_0x2776c0['secondary_code'],'maxProducts':_0x2776c0[_0x433fa7(0x17d)]}));}}),await _0x34ba54[_0x344bc6(0x220)](),_0x39db51[_0x344bc6(0x1c6)](_0x344bc6(0x177),_0x344bc6(0x203)),_0x48a67e[_0x344bc6(0x1ba)](_0x344bc6(0x209));}catch(_0x4a0f92){console[_0x344bc6(0x1a8)](_0x4a0f92);}}),router[a0_0x17edbc(0x1e0)]('/barcode_scanner',async(_0x32932a,_0x407926)=>{var _0x3ea373=a0_0x17edbc;const {FromWareHouse:_0x356a2b,FromRoom:_0x5709d0,ToWarehouse:_0x4c313d,ToRoom:_0x40be7d,primary_code:_0x3463de,Roomslist:_0x29c8a8}=_0x32932a[_0x3ea373(0x227)],_0x482944=_0x29c8a8[_0x3ea373(0x1a6)](','),_0x3ba234=[];async function _0x4a96b5(_0xf8560d){var _0x3a73a9=_0x3ea373;const _0x487360=await warehouse[_0x3a73a9(0x1bb)]([{'$match':{'name':_0x356a2b,'room':_0xf8560d}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x3463de}},{'$group':{'_id':_0x3a73a9(0x1e8),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x3a73a9(0x175)},'primary_code':{'$first':_0x3a73a9(0x1f2)},'secondary_code':{'$first':_0x3a73a9(0x1cc)},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x3a73a9(0x1af)},'level':{'$first':'$product_details.level'},'type':{'$first':_0x3a73a9(0x1b7)},'pallet':{'$first':_0x3a73a9(0x219)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3a73a9(0x1df)},'rack':{'$first':_0x3a73a9(0x205)},'expiry_date':{'$first':_0x3a73a9(0x1da)},'production_date':{'$first':_0x3a73a9(0x172)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x3a73a9(0x1b0)},'roomNamed':{'$first':_0x3a73a9(0x1fd)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x3a73a9(0x1b3)}}}]),_0x5bea67=await warehouse[_0x3a73a9(0x1bb)]([{'$match':{'name':_0x356a2b,'room':_0xf8560d}},{'$unwind':_0x3a73a9(0x22a)},{'$match':{'product_details.secondary_code':_0x3463de}},{'$group':{'_id':_0x3a73a9(0x1e8),'name':{'$first':_0x3a73a9(0x1d2)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x3a73a9(0x1f2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3a73a9(0x1d5)},'bay':{'$first':_0x3a73a9(0x1af)},'level':{'$first':_0x3a73a9(0x17f)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3a73a9(0x219)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3a73a9(0x1df)},'rack':{'$first':_0x3a73a9(0x205)},'expiry_date':{'$first':_0x3a73a9(0x1da)},'production_date':{'$first':_0x3a73a9(0x172)},'batch_code':{'$first':_0x3a73a9(0x16d)},'maxPerUnit':{'$first':_0x3a73a9(0x1b0)},'roomNamed':{'$first':_0x3a73a9(0x1fd)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x3a73a9(0x1b3)}}}]);if(_0x487360['length']>0x0)_0x3ba234[_0x3a73a9(0x19d)](_0x487360);else _0x5bea67['length']>0x0&&_0x3ba234[_0x3a73a9(0x19d)](_0x5bea67);}const _0x36f593=_0x482944['map'](_0xdd400e=>_0x4a96b5(_0xdd400e));await Promise[_0x3ea373(0x20a)](_0x36f593),_0x407926[_0x3ea373(0x1a2)](_0x3ba234);}),router[a0_0x17edbc(0x1e0)](a0_0x17edbc(0x207),async(_0x492f5d,_0x51dd5a)=>{var _0x228aa8=a0_0x17edbc;const {productCode:_0x4273b6,bay:_0x4bf049,warehouses:_0x375903,room:_0x48556a}=_0x492f5d[_0x228aa8(0x227)];console['log'](_0x492f5d[_0x228aa8(0x227)]);try{const _0x5433f7=await warehouse[_0x228aa8(0x1bb)]([{'$match':{'name':_0x375903,'room':_0x48556a}},{'$unwind':_0x228aa8(0x22a)},{'$match':{'product_details.bay':parseInt(_0x4bf049)}},{'$group':{'_id':_0x228aa8(0x1e8),'name':{'$first':_0x228aa8(0x1d2)},'product_stock':{'$first':_0x228aa8(0x175)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x51dd5a[_0x228aa8(0x1aa)](0xc8)[_0x228aa8(0x1a2)](_0x5433f7);}catch(_0x17a931){_0x51dd5a[_0x228aa8(0x1aa)](0x194)['json']({'message':_0x17a931[_0x228aa8(0x181)]});}}),module['exports']=router;