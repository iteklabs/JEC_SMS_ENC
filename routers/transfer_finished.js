var a0_0x33775f=a0_0x3df3;function a0_0x3df3(_0x4d2c64,_0x280c12){var _0xd0b635=a0_0xd0b6();return a0_0x3df3=function(_0x3df3b5,_0x2085c9){_0x3df3b5=_0x3df3b5-0xbb;var _0x138e16=_0xd0b635[_0x3df3b5];return _0x138e16;},a0_0x3df3(_0x4d2c64,_0x280c12);}(function(_0x4860ae,_0x3cf6d2){var _0x36c0d8=a0_0x3df3,_0x2669a1=_0x4860ae();while(!![]){try{var _0x2045af=-parseInt(_0x36c0d8(0x117))/0x1*(parseInt(_0x36c0d8(0x15e))/0x2)+parseInt(_0x36c0d8(0xd8))/0x3+-parseInt(_0x36c0d8(0x167))/0x4+-parseInt(_0x36c0d8(0x160))/0x5*(-parseInt(_0x36c0d8(0x17b))/0x6)+-parseInt(_0x36c0d8(0xfe))/0x7+parseInt(_0x36c0d8(0xe2))/0x8+-parseInt(_0x36c0d8(0xcf))/0x9*(-parseInt(_0x36c0d8(0x145))/0xa);if(_0x2045af===_0x3cf6d2)break;else _0x2669a1['push'](_0x2669a1['shift']());}catch(_0x1f61bc){_0x2669a1['push'](_0x2669a1['shift']());}}}(a0_0xd0b6,0xd8efc));const express=require(a0_0x33775f(0x11a)),app=express(),router=express[a0_0x33775f(0x179)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require('../models/all_models'),auth=require(a0_0x33775f(0x132)),users=require(a0_0x33775f(0xe3)),nodemailer=require(a0_0x33775f(0x131));function a0_0xd0b6(){var _0x434746=['$product_details.product_code','$product_details.maxProducts','to_room','get','updateOne','back','location2location','random','11366397IQKsJq','$product_details.product_stock','from_bay','$product_details.primary_code','type_of_process','$product_details.secondary_code','$product_details.rack','message','$product.to_room_name','3590013KoqrOV','transfer_data','MaxStocks_data2','catch','user','id_transaction','push','to_room_name','toString','maxProducts','7307432jEiuaO','../public/language/languages.json','invoice_init','forEach','product_details','secondary_unit','$from_warehouse','$product_details.level','FROZEN\x20GOODS','to_prod_level','map','filter','date','maxPerUnit','RoomAssigned','slice','from_prod_level','$product.from_room_name','An\x20error\x20occurred\x20while\x20saving\x20data.','Transfer\x20Finalize\x20Successfully','flash','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.secondary_unit','MaxStocks_data','max','from_room','to_floorlevel','Portuguese\x20(BR)','4957855XtSTvO','from_warehouse','/view/add_transfer_loc','email','language','padStart','DRY\x20GOODS','/transfer/view','exports','json','$product_details.unit','undefined','$product_details.floorlevel','params','LOG-TRF-','abs','$name','/picking_list/PDF_transfer/','secondary_code','$product_details','English\x20(US)','product_name','edit_transfer_finished_view','$invoice','batch_code','160077PWXTut','ToRoomAssigned','transfer_finished_logs','express','redirect','$product_details.type','errors','from_prod_qty','to_level','Chinese','product_code3','To_invoice','$product','render','concat','product_code','all','product_date','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','from_room_name','$product_details._id','bin2bin','Spanish','invoice','English','bay','nodemailer','../middleware/auth','/view/add_transfer','True','prod_cat','An\x20error\x20occurred.','find','$product_details.expiry_date','/view','log','prod_name','$product_details.invoice','_id','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Enclosed','$finalize','split','aggregate','Ambient','/view/:id','10EqbZCx','Enabled','to_prod_qty','German','Hindi','unit','Rack\x202','then','$to_warehouse','TRF-','$product_details.storage','from_invoice','string','primary_code','$product_details.batch_code','product_stock','to_quantity','/view/choose','own','TRFF-','</td>','error','French','choos_transfer_logs','length','12wxXVYO','to_warehouse','430osrEqp','Arabic\x20(ae)','warehouse','Finished\x20Goods','post','Product\x20Transfer\x20successfully','Transfer\x20Edit\x20Successfully','6830560jFahTU','$date','/view/addlog','Rack\x201','New_Qty_Converted','findOne','production_date','from_level','success','/transfer_finished/preview/','/preview/:id','status','/view/add_transfer_logs','match','Portuguese','expiry_date','add_transfer_finished','role','Router','\x20<=>\x20','62226IuRUjL','/barcode_scanner','from_prod_level2','save','from_quantity','$product_details.product_name','primary_unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$_id','floor','getFullYear','body','$product_details.bay','product','to_bay','findById','staff','edit_transfer_finished','$product_details.bin','Arabic','logs','$room','/transfer_finished/view'];a0_0xd0b6=function(){return _0x434746;};return a0_0xd0b6();}router[a0_0x33775f(0xca)](a0_0x33775f(0x139),auth,async(_0x11ae9a,_0x545b85)=>{var _0x50c757=a0_0x33775f;try{const {username:_0x5f3940,email:_0x3abad5,role:_0x591881}=_0x11ae9a[_0x50c757(0xdc)],_0x3aacdc=_0x11ae9a[_0x50c757(0xdc)],_0x41a678=await profile['findOne']({'email':_0x3aacdc[_0x50c757(0x101)]}),_0x4d1690=await master_shop[_0x50c757(0x137)]();let _0x1c0699;if(_0x3aacdc[_0x50c757(0x178)]=='staff'){const _0xa789ea=await staff[_0x50c757(0x16c)]({'email':_0x3aacdc[_0x50c757(0x101)]});_0x1c0699=await transfers_finished[_0x50c757(0x137)]({'from_warehouse':_0xa789ea[_0x50c757(0x162)]});}else _0x1c0699=await transfers_finished[_0x50c757(0x142)]([{'$match':{'type_of_transaction':_0x50c757(0x157)}},{'$unwind':_0x50c757(0x123)},{'$group':{'_id':'$_id','invoice':{'$first':_0x50c757(0x115)},'date':{'$first':_0x50c757(0x168)},'from_warehouse':{'$first':_0x50c757(0xe8)},'to_warehouse':{'$first':_0x50c757(0x14d)},'from_room_name':{'$addToSet':_0x50c757(0xf3)},'to_room_name':{'$addToSet':_0x50c757(0xd7)},'finalize':{'$first':_0x50c757(0x140)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x4d1690[0x0]['language']==_0x50c757(0x112))var _0x15265c=users['English'];else{if(_0x4d1690[0x0][_0x50c757(0x102)]=='Hindi')var _0x15265c=users[_0x50c757(0x149)];else{if(_0x4d1690[0x0][_0x50c757(0x102)]=='German')var _0x15265c=users[_0x50c757(0x148)];else{if(_0x4d1690[0x0][_0x50c757(0x102)]=='Spanish')var _0x15265c=users['Spanish'];else{if(_0x4d1690[0x0]['language']==_0x50c757(0x15b))var _0x15265c=users[_0x50c757(0x15b)];else{if(_0x4d1690[0x0]['language']==_0x50c757(0xfd))var _0x15265c=users[_0x50c757(0x175)];else{if(_0x4d1690[0x0][_0x50c757(0x102)]=='Chinese')var _0x15265c=users['Chinese'];else{if(_0x4d1690[0x0]['language']==_0x50c757(0x161))var _0x15265c=users[_0x50c757(0xc3)];}}}}}}}_0x545b85[_0x50c757(0x124)]('transfer_finished',{'success':_0x11ae9a[_0x50c757(0xf6)](_0x50c757(0x16f)),'errors':_0x11ae9a[_0x50c757(0xf6)](_0x50c757(0x11d)),'role':_0x3aacdc,'profile':_0x41a678,'master_shop':_0x4d1690,'transfer':_0x1c0699,'language':_0x15265c});}catch(_0x4952c6){console['log'](_0x4952c6);}}),router[a0_0x33775f(0xca)]('/view_logs',auth,async(_0x1a4ec4,_0x444290)=>{var _0x348cb9=a0_0x33775f;try{const {username:_0x532cb4,email:_0x84b071,role:_0x626aa8}=_0x1a4ec4[_0x348cb9(0xdc)],_0x412ee3=_0x1a4ec4[_0x348cb9(0xdc)],_0x3d5550=await profile[_0x348cb9(0x16c)]({'email':_0x412ee3[_0x348cb9(0x101)]}),_0x61cb85=await master_shop['find']();let _0x180021;if(_0x412ee3[_0x348cb9(0x178)]==_0x348cb9(0xc0)){const _0xae69d7=await staff[_0x348cb9(0x16c)]({'email':_0x412ee3[_0x348cb9(0x101)]});_0x180021=await transfers_finished['find']({'from_warehouse':_0xae69d7[_0x348cb9(0x162)]});}else _0x180021=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':'logs'}},{'$unwind':_0x348cb9(0x123)},{'$group':{'_id':_0x348cb9(0x183),'invoice':{'$first':_0x348cb9(0x115)},'date':{'$first':_0x348cb9(0x168)},'from_warehouse':{'$first':_0x348cb9(0xe8)},'to_warehouse':{'$first':_0x348cb9(0x14d)},'from_room_name':{'$addToSet':_0x348cb9(0xf3)},'to_room_name':{'$addToSet':_0x348cb9(0xd7)},'finalize':{'$first':_0x348cb9(0x140)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x61cb85[0x0]['language']==_0x348cb9(0x112))var _0x2760e8=users[_0x348cb9(0x12f)];else{if(_0x61cb85[0x0][_0x348cb9(0x102)]==_0x348cb9(0x149))var _0x2760e8=users['Hindi'];else{if(_0x61cb85[0x0][_0x348cb9(0x102)]=='German')var _0x2760e8=users[_0x348cb9(0x148)];else{if(_0x61cb85[0x0][_0x348cb9(0x102)]==_0x348cb9(0x12d))var _0x2760e8=users[_0x348cb9(0x12d)];else{if(_0x61cb85[0x0][_0x348cb9(0x102)]==_0x348cb9(0x15b))var _0x2760e8=users[_0x348cb9(0x15b)];else{if(_0x61cb85[0x0]['language']=='Portuguese\x20(BR)')var _0x2760e8=users[_0x348cb9(0x175)];else{if(_0x61cb85[0x0][_0x348cb9(0x102)]==_0x348cb9(0x120))var _0x2760e8=users[_0x348cb9(0x120)];else{if(_0x61cb85[0x0][_0x348cb9(0x102)]==_0x348cb9(0x161))var _0x2760e8=users[_0x348cb9(0xc3)];}}}}}}}_0x444290[_0x348cb9(0x124)](_0x348cb9(0x119),{'success':_0x1a4ec4[_0x348cb9(0xf6)](_0x348cb9(0x16f)),'errors':_0x1a4ec4[_0x348cb9(0xf6)](_0x348cb9(0x11d)),'role':_0x412ee3,'profile':_0x3d5550,'master_shop':_0x61cb85,'transfer':_0x180021,'language':_0x2760e8});}catch(_0x406156){console[_0x348cb9(0x13a)](_0x406156);}});async function getRandom8DigitNumber(){var _0x28eb88=a0_0x33775f;const _0x25dc8f=0x989680,_0x49216d=0x5f5e0ff,_0x520e53=Math[_0x28eb88(0x184)](Math[_0x28eb88(0xce)]()*(_0x49216d-_0x25dc8f+0x1))+_0x25dc8f;var _0xb74193;const _0x318e46=await transfers_finished['findOne']({'invoice':_0x28eb88(0x158)+_0x520e53});return _0x318e46&&_0x318e46['length']>0x0?_0xb74193='TRFF-'+_0x520e53:_0xb74193=_0x28eb88(0x158)+_0x520e53,_0xb74193;}router[a0_0x33775f(0xca)](a0_0x33775f(0x133),auth,async(_0x5e9454,_0xe893e2)=>{var _0x473483=a0_0x33775f;try{const {username:_0x4ae9ba,email:_0x4b7c32,role:_0x4babaf}=_0x5e9454[_0x473483(0xdc)],_0x23267a=_0x5e9454[_0x473483(0xdc)],_0x1c2c6a=await profile[_0x473483(0x16c)]({'email':_0x23267a['email']}),_0x3f9d06=await master_shop['find']();let _0x1c8970;if(_0x23267a['role']=='staff'){const _0x54567b=await staff[_0x473483(0x16c)]({'email':_0x23267a[_0x473483(0x101)]});_0x1c8970=await warehouse[_0x473483(0x142)]([{'$match':{'status':_0x473483(0x146),'name':_0x54567b[_0x473483(0x162)]}},{'$group':{'_id':_0x473483(0x10e),'name':{'$first':_0x473483(0x10e)}}}]);}else _0x1c8970=await warehouse['aggregate']([{'$match':{'status':_0x473483(0x146)}},{'$group':{'_id':_0x473483(0x10e),'name':{'$first':_0x473483(0x10e)}}}]);const _0x1dd42f=await transfers_finished[_0x473483(0x137)]({}),_0x3dc8e8=_0x1dd42f[_0x473483(0x15d)]+0x1,_0x1ecdcb=_0x473483(0x158)+_0x3dc8e8['toString']()[_0x473483(0x103)](0x5,'0');if(_0x3f9d06[0x0][_0x473483(0x102)]==_0x473483(0x112))var _0x110f2a=users[_0x473483(0x12f)];else{if(_0x3f9d06[0x0][_0x473483(0x102)]=='Hindi')var _0x110f2a=users[_0x473483(0x149)];else{if(_0x3f9d06[0x0][_0x473483(0x102)]==_0x473483(0x148))var _0x110f2a=users[_0x473483(0x148)];else{if(_0x3f9d06[0x0][_0x473483(0x102)]==_0x473483(0x12d))var _0x110f2a=users[_0x473483(0x12d)];else{if(_0x3f9d06[0x0][_0x473483(0x102)]==_0x473483(0x15b))var _0x110f2a=users[_0x473483(0x15b)];else{if(_0x3f9d06[0x0][_0x473483(0x102)]=='Portuguese\x20(BR)')var _0x110f2a=users[_0x473483(0x175)];else{if(_0x3f9d06[0x0][_0x473483(0x102)]==_0x473483(0x120))var _0x110f2a=users[_0x473483(0x120)];else{if(_0x3f9d06[0x0][_0x473483(0x102)]=='Arabic\x20(ae)')var _0x110f2a=users[_0x473483(0xc3)];}}}}}}}const _0x3202be=getRandom8DigitNumber();_0x3202be[_0x473483(0x14c)](_0xeb5d86=>{var _0x199193=_0x473483;_0xe893e2['render'](_0x199193(0x177),{'success':_0x5e9454[_0x199193(0xf6)]('success'),'errors':_0x5e9454[_0x199193(0xf6)](_0x199193(0x11d)),'role':_0x23267a,'profile':_0x1c2c6a,'master_shop':_0x3f9d06,'warehouse':_0x1c8970,'language':_0x110f2a,'invoice':_0xeb5d86});})['catch'](_0x261ec6=>{var _0x5f45ce=_0x473483;_0x5e9454[_0x5f45ce(0xf6)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0xe893e2[_0x5f45ce(0x11b)](_0x5f45ce(0x105));});}catch(_0x50d13a){console[_0x473483(0x13a)](_0x50d13a);}}),router[a0_0x33775f(0xca)](a0_0x33775f(0x156),auth,async(_0x2d637c,_0x1d3eab)=>{var _0x2482d1=a0_0x33775f;try{const {username:_0x1966ab,email:_0x437ab8,role:_0x9ca4d0}=_0x2d637c['user'],_0x15ea47=_0x2d637c[_0x2482d1(0xdc)],_0x15ac84=await profile[_0x2482d1(0x16c)]({'email':_0x15ea47[_0x2482d1(0x101)]}),_0x15b9d9=await master_shop['find']();let _0x59e3fa;if(_0x15ea47[_0x2482d1(0x178)]==_0x2482d1(0xc0)){const _0x189ab2=await staff['findOne']({'email':_0x15ea47[_0x2482d1(0x101)]});_0x59e3fa=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x189ab2[_0x2482d1(0x162)]}},{'$group':{'_id':_0x2482d1(0x10e),'name':{'$first':_0x2482d1(0x10e)}}}]);}else _0x59e3fa=await warehouse[_0x2482d1(0x142)]([{'$match':{'status':_0x2482d1(0x146)}},{'$group':{'_id':_0x2482d1(0x10e),'name':{'$first':'$name'}}}]);const _0x282a40=await transfers_finished[_0x2482d1(0x137)]({}),_0x1e1dac=_0x282a40[_0x2482d1(0x15d)]+0x1,_0x2b48e2=_0x2482d1(0x158)+_0x1e1dac[_0x2482d1(0xe0)]()[_0x2482d1(0x103)](0x5,'0');if(_0x15b9d9[0x0][_0x2482d1(0x102)]==_0x2482d1(0x112))var _0x3fe4f2=users[_0x2482d1(0x12f)];else{if(_0x15b9d9[0x0][_0x2482d1(0x102)]=='Hindi')var _0x3fe4f2=users[_0x2482d1(0x149)];else{if(_0x15b9d9[0x0][_0x2482d1(0x102)]=='German')var _0x3fe4f2=users[_0x2482d1(0x148)];else{if(_0x15b9d9[0x0]['language']==_0x2482d1(0x12d))var _0x3fe4f2=users[_0x2482d1(0x12d)];else{if(_0x15b9d9[0x0][_0x2482d1(0x102)]==_0x2482d1(0x15b))var _0x3fe4f2=users[_0x2482d1(0x15b)];else{if(_0x15b9d9[0x0]['language']=='Portuguese\x20(BR)')var _0x3fe4f2=users[_0x2482d1(0x175)];else{if(_0x15b9d9[0x0][_0x2482d1(0x102)]==_0x2482d1(0x120))var _0x3fe4f2=users[_0x2482d1(0x120)];else{if(_0x15b9d9[0x0]['language']=='Arabic\x20(ae)')var _0x3fe4f2=users['Arabic'];}}}}}}}const _0x5935a1=getRandom8DigitNumber();_0x5935a1[_0x2482d1(0x14c)](_0x155497=>{var _0x2e4add=_0x2482d1;_0x1d3eab[_0x2e4add(0x124)]('choos_transfer',{'success':_0x2d637c[_0x2e4add(0xf6)](_0x2e4add(0x16f)),'errors':_0x2d637c[_0x2e4add(0xf6)](_0x2e4add(0x11d)),'role':_0x15ea47,'profile':_0x15ac84,'master_shop':_0x15b9d9,'warehouse':_0x59e3fa,'language':_0x3fe4f2,'invoice':_0x155497});})[_0x2482d1(0xdb)](_0x3458e5=>{var _0x3b9fad=_0x2482d1;_0x2d637c[_0x3b9fad(0xf6)](_0x3b9fad(0x11d),_0x3b9fad(0x182)),_0x1d3eab[_0x3b9fad(0x11b)](_0x3b9fad(0x105));});}catch(_0x1bbf49){console['log'](_0x1bbf49);}}),router[a0_0x33775f(0xca)]('/view/choose_logs',auth,async(_0x2ca1d4,_0xbbdd8b)=>{var _0x3ede00=a0_0x33775f;try{const {username:_0xf314cd,email:_0x2fc71d,role:_0x1abb06}=_0x2ca1d4['user'],_0x5de7fe=_0x2ca1d4[_0x3ede00(0xdc)],_0x44461d=await profile[_0x3ede00(0x16c)]({'email':_0x5de7fe[_0x3ede00(0x101)]}),_0xf8e707=await master_shop['find']();let _0x4525fa;if(_0x5de7fe[_0x3ede00(0x178)]==_0x3ede00(0xc0)){const _0x3a4a92=await staff[_0x3ede00(0x16c)]({'email':_0x5de7fe[_0x3ede00(0x101)]});_0x4525fa=await warehouse[_0x3ede00(0x142)]([{'$match':{'status':_0x3ede00(0x146),'name':_0x3a4a92[_0x3ede00(0x162)]}},{'$group':{'_id':'$name','name':{'$first':_0x3ede00(0x10e)}}}]);}else _0x4525fa=await warehouse['aggregate']([{'$match':{'status':_0x3ede00(0x146)}},{'$group':{'_id':'$name','name':{'$first':_0x3ede00(0x10e)}}}]);const _0x4a0c0e=await transfers_finished[_0x3ede00(0x137)]({}),_0x13a232=_0x4a0c0e[_0x3ede00(0x15d)]+0x1,_0x1d89c3=_0x3ede00(0x158)+_0x13a232[_0x3ede00(0xe0)]()[_0x3ede00(0x103)](0x5,'0');if(_0xf8e707[0x0][_0x3ede00(0x102)]==_0x3ede00(0x112))var _0x383c3a=users['English'];else{if(_0xf8e707[0x0]['language']==_0x3ede00(0x149))var _0x383c3a=users[_0x3ede00(0x149)];else{if(_0xf8e707[0x0][_0x3ede00(0x102)]==_0x3ede00(0x148))var _0x383c3a=users['German'];else{if(_0xf8e707[0x0]['language']==_0x3ede00(0x12d))var _0x383c3a=users[_0x3ede00(0x12d)];else{if(_0xf8e707[0x0][_0x3ede00(0x102)]==_0x3ede00(0x15b))var _0x383c3a=users[_0x3ede00(0x15b)];else{if(_0xf8e707[0x0][_0x3ede00(0x102)]==_0x3ede00(0xfd))var _0x383c3a=users['Portuguese'];else{if(_0xf8e707[0x0][_0x3ede00(0x102)]==_0x3ede00(0x120))var _0x383c3a=users['Chinese'];else{if(_0xf8e707[0x0][_0x3ede00(0x102)]=='Arabic\x20(ae)')var _0x383c3a=users[_0x3ede00(0xc3)];}}}}}}}const _0x3a6f4e=getRandom8DigitNumber();_0x3a6f4e[_0x3ede00(0x14c)](_0xb1b93c=>{var _0x7e8be7=_0x3ede00;_0xbbdd8b[_0x7e8be7(0x124)](_0x7e8be7(0x15c),{'success':_0x2ca1d4[_0x7e8be7(0xf6)](_0x7e8be7(0x16f)),'errors':_0x2ca1d4[_0x7e8be7(0xf6)](_0x7e8be7(0x11d)),'role':_0x5de7fe,'profile':_0x44461d,'master_shop':_0xf8e707,'warehouse':_0x4525fa,'language':_0x383c3a,'invoice':_0xb1b93c});})[_0x3ede00(0xdb)](_0x5205c2=>{var _0xbaa162=_0x3ede00;_0x2ca1d4[_0xbaa162(0xf6)](_0xbaa162(0x11d),_0xbaa162(0x182)),_0xbbdd8b[_0xbaa162(0x11b)](_0xbaa162(0x105));});}catch(_0x30dd57){console[_0x3ede00(0x13a)](_0x30dd57);}}),router[a0_0x33775f(0x164)](a0_0x33775f(0x173),auth,async(_0x27e855,_0x5cd36d)=>{var _0x1848d9=a0_0x33775f;try{const {date:_0x410da3,from_warehouse:_0x4f5173,FromRoom_name:_0xc84f95,to_warehouse:_0x382dc7,ToRoom_name:_0x4dfa10,prod_name:_0x45e909,from_prod_qty:_0x1ed731,from_prod_level:_0x4e5a5e,from_prod_isle:_0x170441,from_prod_pallet:_0x5a430c,to_prod_qty:_0x4b6500,to_prod_level:_0x4f603a,to_prod_isle:_0x55213e,to_prod_pallet:_0x1d8262,primary_code:_0xa45d31,secondary_code:_0x284979,product_code3:_0x17386f,note:_0x634421,MaxStocks_data2:_0x4fba32,invoice:_0x5432da,expiry_date:_0x2be706,PO_number:_0x1e7edb,ReqBy:_0x5942df,dateofreq:_0x1a9ba5,typeservicesData:_0x2323d9,destination:_0x2c19d8,deliverydate:_0x398d4e,driver:_0x506603,plate:_0xaa3a52,van:_0x4ed11c,DRSI:_0x3ed668,typevehicle:_0x3238bf,TSU:_0x31f1b8,TFU:_0x245eb6}=_0x27e855[_0x1848d9(0xbb)];if(typeof _0x45e909=='string')var _0x257862=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x13b)]],_0x6a0a72=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x11e)]],_0x1c7cdb=[_0x27e855[_0x1848d9(0xbb)]['from_prod_level2']],_0x3bdf13=[_0x27e855[_0x1848d9(0xbb)]['New_Qty_Converted']],_0xeb25be=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0xeb)]],_0xabbabb=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x152)]],_0x391043=[_0x27e855[_0x1848d9(0xbb)]['secondary_code']],_0x4b4054=[_0x27e855[_0x1848d9(0xbb)]['product_code3']],_0x3220f0=[_0x27e855['body'][_0x1848d9(0xda)]],_0x23026d=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x181)]],_0x5e4321=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0xe7)]],_0x1207c6=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x116)]],_0xc3fd84=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x176)]],_0x299af6=[_0x27e855[_0x1848d9(0xbb)]['product_date']],_0x243d9c=[_0x27e855[_0x1848d9(0xbb)]['MaxStocks_data']],_0x5f4255=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0xef)]],_0x40bab2=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x135)]],_0x3c65fd=[_0x27e855['body']['RoomAssigned']],_0xde868=[_0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x118)]],_0x45faee=[_0x27e855['body'][_0x1848d9(0x150)]],_0x25b743=[_0x27e855['body'][_0x1848d9(0xdd)]];else var _0x257862=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x13b)]],_0x6a0a72=[..._0x27e855['body'][_0x1848d9(0x11e)]],_0x1c7cdb=[..._0x27e855[_0x1848d9(0xbb)]['from_prod_level2']],_0x3bdf13=[..._0x27e855['body']['New_Qty_Converted']],_0xeb25be=[..._0x27e855[_0x1848d9(0xbb)]['to_prod_level']],_0xabbabb=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x152)]],_0x391043=[..._0x27e855['body']['secondary_code']],_0x4b4054=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x121)]],_0x3220f0=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0xda)]],_0x23026d=[..._0x27e855['body'][_0x1848d9(0x181)]],_0x5e4321=[..._0x27e855[_0x1848d9(0xbb)]['secondary_unit']],_0x1207c6=[..._0x27e855[_0x1848d9(0xbb)]['batch_code']],_0xc3fd84=[..._0x27e855[_0x1848d9(0xbb)]['expiry_date']],_0x299af6=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x128)]],_0x243d9c=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0xf9)]],_0x5f4255=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0xef)]],_0x40bab2=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x135)]],_0x3c65fd=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0xf0)]],_0xde868=[..._0x27e855[_0x1848d9(0xbb)]['ToRoomAssigned']],_0x45faee=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0x150)]],_0x25b743=[..._0x27e855[_0x1848d9(0xbb)][_0x1848d9(0xdd)]];const _0x3926ee=_0x257862[_0x1848d9(0xec)](_0x458a4f=>{return _0x458a4f={'product_name':_0x458a4f};});_0x6a0a72[_0x1848d9(0xe5)]((_0x3e564e,_0x1a45c7)=>{_0x3926ee[_0x1a45c7]['from_quantity']=_0x3e564e;}),_0x1c7cdb[_0x1848d9(0xe5)]((_0x53a169,_0x2cf28d)=>{var _0x3b8389=_0x1848d9,_0x33ef0a=_0x53a169[_0x3b8389(0x174)](/[A-Za-z]+/)[0x0],_0xc81feb=parseInt(_0x53a169[_0x3b8389(0x174)](/\d+/)[0x0]);_0x3926ee[_0x2cf28d][_0x3b8389(0xd1)]=_0xc81feb,_0x3926ee[_0x2cf28d][_0x3b8389(0x16e)]=_0x33ef0a;}),_0x25b743['forEach']((_0x4f52eb,_0x43f3b8)=>{var _0x473856=_0x1848d9;_0x3926ee[_0x43f3b8][_0x473856(0xdd)]=_0x4f52eb;}),_0x45faee[_0x1848d9(0xe5)]((_0x57cfb7,_0x357451)=>{var _0x5c2047=_0x1848d9;_0x3926ee[_0x357451][_0x5c2047(0x150)]=_0x57cfb7;}),_0x3bdf13[_0x1848d9(0xe5)]((_0x5734a4,_0x82de14)=>{var _0x1f4a78=_0x1848d9;_0x3926ee[_0x82de14][_0x1f4a78(0x155)]=_0x5734a4;}),_0xeb25be[_0x1848d9(0xe5)]((_0x171f8b,_0xdb1d8e)=>{var _0x44acd5=_0x1848d9,_0x2b80d8=_0x171f8b[_0x44acd5(0x174)](/[A-Za-z]+/)[0x0],_0x2d30dc=parseInt(_0x171f8b[_0x44acd5(0x174)](/\d+/)[0x0]);_0x3926ee[_0xdb1d8e][_0x44acd5(0x11f)]=_0x2b80d8,_0x3926ee[_0xdb1d8e][_0x44acd5(0xbe)]=_0x2d30dc;}),_0xabbabb[_0x1848d9(0xe5)]((_0x11e702,_0x492ff9)=>{var _0x211ca0=_0x1848d9;_0x3926ee[_0x492ff9][_0x211ca0(0x152)]=_0x11e702;}),_0x391043[_0x1848d9(0xe5)]((_0x3fa537,_0x326676)=>{_0x3926ee[_0x326676]['secondary_code']=_0x3fa537;}),_0x4b4054[_0x1848d9(0xe5)]((_0x12301d,_0x486019)=>{var _0x5c1e0f=_0x1848d9;_0x3926ee[_0x486019][_0x5c1e0f(0x126)]=_0x12301d;}),_0x3220f0[_0x1848d9(0xe5)]((_0x2a0e92,_0x35019b)=>{var _0x45a7a7=_0x1848d9;_0x3926ee[_0x35019b][_0x45a7a7(0xe1)]=_0x2a0e92;}),_0x23026d['forEach']((_0x1dfea5,_0x3d9b81)=>{var _0x553906=_0x1848d9;_0x3926ee[_0x3d9b81][_0x553906(0x14a)]=_0x1dfea5;}),_0x5e4321[_0x1848d9(0xe5)]((_0x5bd913,_0x959199)=>{var _0x1beb8e=_0x1848d9;_0x3926ee[_0x959199][_0x1beb8e(0xe7)]=_0x5bd913;}),_0x1207c6[_0x1848d9(0xe5)]((_0x3ef824,_0x3dd5e2)=>{var _0x2b0969=_0x1848d9;_0x3926ee[_0x3dd5e2][_0x2b0969(0x116)]=_0x3ef824;}),_0xc3fd84[_0x1848d9(0xe5)]((_0x11edb5,_0x3e69da)=>{var _0x27d057=_0x1848d9;_0x3926ee[_0x3e69da][_0x27d057(0x176)]=_0x11edb5;}),_0x299af6[_0x1848d9(0xe5)]((_0x1c64b1,_0x2d99d2)=>{var _0x11a00e=_0x1848d9;_0x3926ee[_0x2d99d2][_0x11a00e(0x16d)]=_0x1c64b1;}),_0x243d9c[_0x1848d9(0xe5)]((_0x450b0b,_0x5a8749)=>{_0x3926ee[_0x5a8749]['maxProducts']=_0x450b0b;}),_0x5f4255[_0x1848d9(0xe5)]((_0x3b9d33,_0x2e168c)=>{_0x3926ee[_0x2e168c]['maxPerUnit']=_0x3b9d33;}),_0x40bab2[_0x1848d9(0xe5)]((_0x31b50d,_0x281a82)=>{var _0x4f8488=_0x1848d9;_0x3926ee[_0x281a82][_0x4f8488(0x135)]=_0x31b50d;}),_0x3c65fd['forEach']((_0x5965e7,_0x1a857b)=>{_0x3926ee[_0x1a857b]['from_room_name']=_0x5965e7;}),_0xde868['forEach']((_0x274ca4,_0xd869a)=>{var _0x2cf608=_0x1848d9;_0x3926ee[_0xd869a][_0x2cf608(0xdf)]=_0x274ca4;});const _0x552366=_0x3926ee['filter'](_0x1d9a4a=>_0x1d9a4a[_0x1848d9(0x155)]!=='0'&&_0x1d9a4a[_0x1848d9(0x155)]!==''||_0x1d9a4a[_0x1848d9(0xfc)]!=='0'&&_0x1d9a4a['to_floorlevel']!=='');var _0x7fd8f5=0x0;_0x552366[_0x1848d9(0xe5)](_0x492792=>{var _0x3ac22e=_0x1848d9;parseInt(_0x492792[_0x3ac22e(0x17f)])<parseInt(_0x492792[_0x3ac22e(0x155)])&&_0x7fd8f5++;});if(_0x7fd8f5!=0x0)return _0x27e855['flash']('errors',_0x1848d9(0x13e)),_0x5cd36d[_0x1848d9(0x11b)](_0x1848d9(0xcc));const _0x3b17b7=new transfers_logs();await _0x3b17b7['save']();for(let _0x540fb7=0x0;_0x540fb7<=_0xde868['length']-0x1;_0x540fb7++){_0x3926ee[_0x540fb7][_0x1848d9(0x122)]=_0x1848d9(0x10c)+_0x3b17b7[_0x1848d9(0xe4)][_0x1848d9(0xe0)]()[_0x1848d9(0x103)](0x8,'0');}const _0x1082f5=new transfers_finished({'date':_0x410da3,'from_warehouse':_0x4f5173,'to_warehouse':_0x4f5173,'product':_0x552366,'note':_0x634421,'invoice':_0x1848d9(0x10c)+_0x3b17b7['invoice_init'][_0x1848d9(0xe0)]()['padStart'](0x8,'0'),'type_of_process':_0x1848d9(0x12c),'type_of_transaction':_0x1848d9(0xc4),'PO_number':_0x1e7edb,'RequestedBy':_0x5942df,'DateofRequest':_0x1a9ba5,'typeservices':_0x2323d9,'destination':_0x2c19d8,'deliverydate':_0x398d4e,'driver':_0x506603,'plate':_0xaa3a52,'van':_0x4ed11c,'DRSI':_0x3ed668,'typevehicle':_0x3238bf,'TSU':_0x31f1b8,'TFU':_0x245eb6}),_0x34dcdb=await _0x1082f5['save']();_0x27e855['flash']('success',_0x1848d9(0x165)),_0x5cd36d[_0x1848d9(0x11b)](_0x1848d9(0x170)+_0x34dcdb[_0x1848d9(0x13d)]);}catch(_0x4f0921){console[_0x1848d9(0x13a)](_0x4f0921),_0x5cd36d[_0x1848d9(0x172)](0xc8)['json']({'errorMessage':_0x4f0921[_0x1848d9(0xd6)]});}}),router['post'](a0_0x33775f(0x169),auth,async(_0x284815,_0x2732cd)=>{var _0x549c80=a0_0x33775f;try{const {date:_0x10dc45,from_warehouse:_0x27fd86,FromRoom_name:_0x1a7ba2,to_warehouse:_0x2996b9,ToRoom_name:_0x166fe6,prod_name:_0x36901f,from_prod_qty:_0x3a476b,from_prod_level:_0x3b51e6,from_prod_isle:_0x3fe7fa,from_prod_pallet:_0x52aa7c,to_prod_qty:_0x3d362f,to_prod_level:_0x395f78,to_prod_isle:_0x1baab0,to_prod_pallet:_0x233900,primary_code:_0x4c5fff,secondary_code:_0x454b81,product_code3:_0x16aa61,note:_0x832298,MaxStocks_data2:_0x17d570,invoice:_0x1f7194,expiry_date:_0xb3bb0c,PO_number_loc:_0x28e20f,ReqBy_loc:_0x3e456c,dateofreq_loc:_0x58a3de,typeservices_loc_Data:_0x2a31a4,destination_loc:_0x986f70,deliverydate_loc:_0x3fa98f,driver_loc:_0xd748b8,plate_loc:_0x39c80f,van_loc:_0x1465dd,DRSI_loc:_0x40ca95,typevehicle_loc:_0x344725,TSU_loc:_0x40e133,TFU_loc:_0x3f0898}=_0x284815[_0x549c80(0xbb)];if(typeof _0x36901f==_0x549c80(0x151))var _0x1d69d3=[_0x284815[_0x549c80(0xbb)][_0x549c80(0x13b)]],_0x163b92=[_0x284815[_0x549c80(0xbb)][_0x549c80(0x11e)]],_0x35eaeb=[_0x284815[_0x549c80(0xbb)][_0x549c80(0x17d)]],_0x3ece09=[_0x284815['body'][_0x549c80(0x16b)]],_0x68da02=[_0x284815['body']['to_prod_level']],_0x2483ca=[_0x284815['body'][_0x549c80(0x152)]],_0x542116=[_0x284815[_0x549c80(0xbb)][_0x549c80(0x110)]],_0x11f7f2=[_0x284815['body'][_0x549c80(0x121)]],_0x1073fb=[_0x284815['body']['MaxStocks_data2']],_0x4f200c=[_0x284815['body'][_0x549c80(0x181)]],_0x9cd8af=[_0x284815[_0x549c80(0xbb)][_0x549c80(0xe7)]],_0x599da7=[_0x284815[_0x549c80(0xbb)][_0x549c80(0x116)]],_0x325e82=[_0x284815['body'][_0x549c80(0x176)]],_0x21ca59=[_0x284815[_0x549c80(0xbb)][_0x549c80(0x128)]],_0x15da9a=[_0x284815[_0x549c80(0xbb)][_0x549c80(0xf9)]],_0x3f693a=[_0x284815['body'][_0x549c80(0xef)]],_0x9b7603=[_0x284815[_0x549c80(0xbb)][_0x549c80(0x135)]],_0x4b5333=[_0x284815[_0x549c80(0xbb)][_0x549c80(0xf0)]],_0x63385d=[_0x284815['body'][_0x549c80(0x118)]],_0xf8718b=[_0x284815[_0x549c80(0xbb)][_0x549c80(0x150)]],_0x33dd76=[_0x284815[_0x549c80(0xbb)][_0x549c80(0xdd)]];else var _0x1d69d3=[..._0x284815[_0x549c80(0xbb)]['prod_name']],_0x163b92=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0x11e)]],_0x35eaeb=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0x17d)]],_0x3ece09=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0x16b)]],_0x68da02=[..._0x284815['body']['to_prod_level']],_0x2483ca=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0x152)]],_0x542116=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0x110)]],_0x11f7f2=[..._0x284815[_0x549c80(0xbb)]['product_code3']],_0x1073fb=[..._0x284815[_0x549c80(0xbb)]['MaxStocks_data2']],_0x4f200c=[..._0x284815['body']['primary_unit']],_0x9cd8af=[..._0x284815[_0x549c80(0xbb)]['secondary_unit']],_0x599da7=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0x116)]],_0x325e82=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0x176)]],_0x21ca59=[..._0x284815[_0x549c80(0xbb)]['product_date']],_0x15da9a=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0xf9)]],_0x3f693a=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0xef)]],_0x9b7603=[..._0x284815[_0x549c80(0xbb)]['prod_cat']],_0x4b5333=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0xf0)]],_0x63385d=[..._0x284815[_0x549c80(0xbb)][_0x549c80(0x118)]],_0xf8718b=[..._0x284815['body'][_0x549c80(0x150)]],_0x33dd76=[..._0x284815['body']['id_transaction']];const _0x46b3c4=_0x1d69d3[_0x549c80(0xec)](_0xe1c8=>{return _0xe1c8={'product_name':_0xe1c8};});_0x163b92[_0x549c80(0xe5)]((_0x179caa,_0x1feda8)=>{var _0x392397=_0x549c80;_0x46b3c4[_0x1feda8][_0x392397(0x17f)]=_0x179caa;}),_0x35eaeb[_0x549c80(0xe5)]((_0x5ed1ef,_0x3063e5)=>{var _0x22e90b=_0x549c80,_0x3e8e90=_0x5ed1ef[_0x22e90b(0x174)](/[A-Za-z]+/)[0x0],_0x37f4c1=parseInt(_0x5ed1ef['match'](/\d+/)[0x0]);_0x46b3c4[_0x3063e5][_0x22e90b(0xd1)]=_0x37f4c1,_0x46b3c4[_0x3063e5][_0x22e90b(0x16e)]=_0x3e8e90;}),_0x33dd76[_0x549c80(0xe5)]((_0xaca8ae,_0x127fe9)=>{var _0x12ad3e=_0x549c80;_0x46b3c4[_0x127fe9][_0x12ad3e(0xdd)]=_0xaca8ae;}),_0xf8718b[_0x549c80(0xe5)]((_0x2d923e,_0x41b7de)=>{var _0x443509=_0x549c80;_0x46b3c4[_0x41b7de][_0x443509(0x150)]=_0x2d923e;}),_0x3ece09[_0x549c80(0xe5)]((_0x880b6e,_0x1a27df)=>{var _0x1d6bad=_0x549c80;_0x46b3c4[_0x1a27df][_0x1d6bad(0x155)]=_0x880b6e;}),_0x68da02[_0x549c80(0xe5)]((_0x48488b,_0x15c9d8)=>{var _0xfe66ad=_0x549c80,_0x299a43=_0x48488b[_0xfe66ad(0x174)](/[A-Za-z]+/)[0x0],_0x4df121=parseInt(_0x48488b['match'](/\d+/)[0x0]);_0x46b3c4[_0x15c9d8]['to_level']=_0x299a43,_0x46b3c4[_0x15c9d8][_0xfe66ad(0xbe)]=_0x4df121;}),_0x2483ca[_0x549c80(0xe5)]((_0x49109e,_0x245988)=>{var _0x637fe1=_0x549c80;_0x46b3c4[_0x245988][_0x637fe1(0x152)]=_0x49109e;}),_0x542116['forEach']((_0x45a92b,_0x3e054d)=>{var _0x582219=_0x549c80;_0x46b3c4[_0x3e054d][_0x582219(0x110)]=_0x45a92b;}),_0x11f7f2[_0x549c80(0xe5)]((_0x3c09cb,_0x12fbea)=>{var _0x3498d0=_0x549c80;_0x46b3c4[_0x12fbea][_0x3498d0(0x126)]=_0x3c09cb;}),_0x1073fb[_0x549c80(0xe5)]((_0x2eb99e,_0x287712)=>{var _0x284dba=_0x549c80;_0x46b3c4[_0x287712][_0x284dba(0xe1)]=_0x2eb99e;}),_0x4f200c['forEach']((_0x5ee482,_0x2a150d)=>{_0x46b3c4[_0x2a150d]['unit']=_0x5ee482;}),_0x9cd8af[_0x549c80(0xe5)]((_0x15bfbc,_0x4c9501)=>{var _0x3a0120=_0x549c80;_0x46b3c4[_0x4c9501][_0x3a0120(0xe7)]=_0x15bfbc;}),_0x599da7['forEach']((_0x26bfc1,_0x4d19c7)=>{var _0x5797f7=_0x549c80;_0x46b3c4[_0x4d19c7][_0x5797f7(0x116)]=_0x26bfc1;}),_0x325e82[_0x549c80(0xe5)]((_0x1bd9ca,_0x6ddaf4)=>{var _0x21ef2f=_0x549c80;_0x46b3c4[_0x6ddaf4][_0x21ef2f(0x176)]=_0x1bd9ca;}),_0x21ca59['forEach']((_0x4314d5,_0x1b010c)=>{var _0xac4c4f=_0x549c80;_0x46b3c4[_0x1b010c][_0xac4c4f(0x16d)]=_0x4314d5;}),_0x15da9a['forEach']((_0x2861ab,_0x25299f)=>{_0x46b3c4[_0x25299f]['maxProducts']=_0x2861ab;}),_0x3f693a[_0x549c80(0xe5)]((_0xa54ec4,_0x497c14)=>{_0x46b3c4[_0x497c14]['maxPerUnit']=_0xa54ec4;}),_0x9b7603[_0x549c80(0xe5)]((_0x420dde,_0x34215b)=>{var _0x4c221a=_0x549c80;_0x46b3c4[_0x34215b][_0x4c221a(0x135)]=_0x420dde;}),_0x4b5333['forEach']((_0x2a4c78,_0x287852)=>{var _0x48364c=_0x549c80;_0x46b3c4[_0x287852][_0x48364c(0x12a)]=_0x2a4c78;}),_0x63385d[_0x549c80(0xe5)]((_0x3b832c,_0x4d12bb)=>{var _0x2885c2=_0x549c80;_0x46b3c4[_0x4d12bb][_0x2885c2(0xdf)]=_0x3b832c;});const _0x2beed6=_0x46b3c4[_0x549c80(0xed)](_0x30271e=>_0x30271e[_0x549c80(0x155)]!=='0'&&_0x30271e['to_quantity']!==''||_0x30271e[_0x549c80(0xfc)]!=='0'&&_0x30271e[_0x549c80(0xfc)]!=='');var _0x11634f=0x0;_0x2beed6[_0x549c80(0xe5)](_0x4d1568=>{var _0x32cbc1=_0x549c80;parseInt(_0x4d1568[_0x32cbc1(0x17f)])<parseInt(_0x4d1568[_0x32cbc1(0x155)])&&_0x11634f++;});if(_0x11634f!=0x0)return _0x284815['flash'](_0x549c80(0x11d),_0x549c80(0x13e)),_0x2732cd[_0x549c80(0x11b)](_0x549c80(0xcc));const _0x46e47e=new transfers_logs();await _0x46e47e['save']();for(let _0x1001dd=0x0;_0x1001dd<=_0x63385d[_0x549c80(0x15d)]-0x1;_0x1001dd++){_0x46b3c4[_0x1001dd][_0x549c80(0x122)]=_0x549c80(0x10c)+_0x46e47e['invoice_init'][_0x549c80(0xe0)]()[_0x549c80(0x103)](0x8,'0');}const _0x23ca86=new transfers_finished({'date':_0x10dc45,'from_warehouse':_0x27fd86,'to_warehouse':_0x2996b9,'product':_0x2beed6,'note':_0x832298,'invoice':'LOG-TRF-'+_0x46e47e[_0x549c80(0xe4)][_0x549c80(0xe0)]()[_0x549c80(0x103)](0x8,'0'),'type_of_transaction':'logs','type_of_process':_0x549c80(0xcd),'PO_number':_0x28e20f,'RequestedBy':_0x3e456c,'DateofRequest':_0x58a3de,'typeservices':_0x2a31a4,'destination':_0x986f70,'deliverydate':_0x3fa98f,'driver':_0xd748b8,'plate':_0x39c80f,'van':_0x1465dd,'DRSI':_0x40ca95,'typevehicle':_0x344725,'TSU':_0x40e133,'TFU':_0x3f0898}),_0x556556=await _0x23ca86[_0x549c80(0x17e)]();_0x284815[_0x549c80(0xf6)](_0x549c80(0x16f),_0x549c80(0x165)),_0x2732cd[_0x549c80(0x11b)](_0x549c80(0x170)+_0x556556['_id']);}catch(_0x4ecbe0){console[_0x549c80(0x13a)](_0x4ecbe0),_0x2732cd[_0x549c80(0x172)](0xc8)[_0x549c80(0x107)]({'errorMessage':_0x4ecbe0[_0x549c80(0xd6)]});}}),router[a0_0x33775f(0x164)](a0_0x33775f(0x133),auth,async(_0x333c9c,_0x216eb0)=>{var _0x26e86b=a0_0x33775f;try{const {date:_0x33dbf7,from_warehouse:_0x2d0b23,FromRoom_name:_0x1760ab,to_warehouse:_0x5a2357,ToRoom_name:_0x82d426,prod_name:_0x38250c,from_prod_qty:_0x5a897f,from_prod_level:_0x3eb48c,from_prod_isle:_0xaffa3e,from_prod_pallet:_0x1a00bb,to_prod_qty:_0x127e31,to_prod_level:_0x459031,to_prod_isle:_0x281748,to_prod_pallet:_0x2b1fb8,primary_code:_0x2c2adf,secondary_code:_0x228ce8,product_code3:_0x453a08,note:_0xba375f,MaxStocks_data2:_0x387f5d,invoice:_0x309d2e,expiry_date:_0xad4ddb,PO_number:_0x259365,ReqBy:_0x1a68f4,dateofreq:_0x3e81f3,typeservicesData:_0x47e536,destination:_0x554b09,deliverydate:_0x1c4048,driver:_0xf60a0,plate:_0x124e4c,van:_0x4e1123,DRSI:_0x47c27e,typevehicle:_0x53352b,TSU:_0x49b966,TFU:_0x571adf}=_0x333c9c['body'];if(typeof _0x38250c=='string')var _0x485f3a=[_0x333c9c[_0x26e86b(0xbb)]['prod_name']],_0x5cdb11=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x11e)]],_0x558d86=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x17d)]],_0x3b3abb=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x16b)]],_0x34bfab=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0xeb)]],_0x44f163=[_0x333c9c[_0x26e86b(0xbb)]['primary_code']],_0x52a194=[_0x333c9c[_0x26e86b(0xbb)]['secondary_code']],_0x29ae2f=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x121)]],_0x160c1a=[_0x333c9c[_0x26e86b(0xbb)]['MaxStocks_data2']],_0x2e2ef2=[_0x333c9c[_0x26e86b(0xbb)]['primary_unit']],_0x4feb3d=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0xe7)]],_0x3f8001=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x116)]],_0x3bb055=[_0x333c9c[_0x26e86b(0xbb)]['expiry_date']],_0x4623e3=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x128)]],_0x5788e1=[_0x333c9c['body'][_0x26e86b(0xf9)]],_0x1e66de=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0xef)]],_0x454d48=[_0x333c9c['body'][_0x26e86b(0x135)]],_0x424da9=[_0x333c9c['body'][_0x26e86b(0xf0)]],_0xc6a82b=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x118)]],_0x7a8125=[_0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x150)]],_0x6ba52f=[_0x333c9c['body'][_0x26e86b(0xdd)]];else var _0x485f3a=[..._0x333c9c['body'][_0x26e86b(0x13b)]],_0x5cdb11=[..._0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x11e)]],_0x558d86=[..._0x333c9c['body'][_0x26e86b(0x17d)]],_0x3b3abb=[..._0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x16b)]],_0x34bfab=[..._0x333c9c['body'][_0x26e86b(0xeb)]],_0x44f163=[..._0x333c9c[_0x26e86b(0xbb)]['primary_code']],_0x52a194=[..._0x333c9c[_0x26e86b(0xbb)]['secondary_code']],_0x29ae2f=[..._0x333c9c[_0x26e86b(0xbb)]['product_code3']],_0x160c1a=[..._0x333c9c['body']['MaxStocks_data2']],_0x2e2ef2=[..._0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x181)]],_0x4feb3d=[..._0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0xe7)]],_0x3f8001=[..._0x333c9c['body'][_0x26e86b(0x116)]],_0x3bb055=[..._0x333c9c['body'][_0x26e86b(0x176)]],_0x4623e3=[..._0x333c9c['body'][_0x26e86b(0x128)]],_0x5788e1=[..._0x333c9c['body']['MaxStocks_data']],_0x1e66de=[..._0x333c9c['body'][_0x26e86b(0xef)]],_0x454d48=[..._0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x135)]],_0x424da9=[..._0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0xf0)]],_0xc6a82b=[..._0x333c9c['body'][_0x26e86b(0x118)]],_0x7a8125=[..._0x333c9c[_0x26e86b(0xbb)][_0x26e86b(0x150)]],_0x6ba52f=[..._0x333c9c['body'][_0x26e86b(0xdd)]];const _0x89a7c1=_0x485f3a[_0x26e86b(0xec)](_0x22d201=>{return _0x22d201={'product_name':_0x22d201};});_0x5cdb11[_0x26e86b(0xe5)]((_0x528c80,_0x163d9c)=>{var _0x14c033=_0x26e86b;_0x89a7c1[_0x163d9c][_0x14c033(0x17f)]=_0x528c80;}),_0x558d86[_0x26e86b(0xe5)]((_0x302e83,_0x567892)=>{var _0x1892f3=_0x26e86b,_0x57e861=_0x302e83[_0x1892f3(0x174)](/[A-Za-z]+/)[0x0],_0x293dda=parseInt(_0x302e83[_0x1892f3(0x174)](/\d+/)[0x0]);_0x89a7c1[_0x567892][_0x1892f3(0xd1)]=_0x293dda,_0x89a7c1[_0x567892][_0x1892f3(0x16e)]=_0x57e861;}),_0x6ba52f[_0x26e86b(0xe5)]((_0x222aaf,_0x87c9e4)=>{var _0x2bd053=_0x26e86b;_0x89a7c1[_0x87c9e4][_0x2bd053(0xdd)]=_0x222aaf;}),_0x7a8125[_0x26e86b(0xe5)]((_0x46924f,_0x528134)=>{_0x89a7c1[_0x528134]['from_invoice']=_0x46924f;}),_0x3b3abb[_0x26e86b(0xe5)]((_0x2b31ff,_0x517ab9)=>{var _0x5d5b48=_0x26e86b;_0x89a7c1[_0x517ab9][_0x5d5b48(0x155)]=_0x2b31ff;}),_0x34bfab[_0x26e86b(0xe5)]((_0x2301a1,_0x3bdb6e)=>{var _0x17b885=_0x26e86b,_0x44a288=_0x2301a1[_0x17b885(0x174)](/[A-Za-z]+/)[0x0],_0x2a18a3=parseInt(_0x2301a1[_0x17b885(0x174)](/\d+/)[0x0]);_0x89a7c1[_0x3bdb6e][_0x17b885(0x11f)]=_0x44a288,_0x89a7c1[_0x3bdb6e][_0x17b885(0xbe)]=_0x2a18a3;}),_0x44f163[_0x26e86b(0xe5)]((_0x3542b0,_0x4f3105)=>{_0x89a7c1[_0x4f3105]['primary_code']=_0x3542b0;}),_0x52a194['forEach']((_0x4ad118,_0x16fc11)=>{var _0x3b584e=_0x26e86b;_0x89a7c1[_0x16fc11][_0x3b584e(0x110)]=_0x4ad118;}),_0x29ae2f[_0x26e86b(0xe5)]((_0x131375,_0x4bc7c4)=>{_0x89a7c1[_0x4bc7c4]['product_code']=_0x131375;}),_0x160c1a[_0x26e86b(0xe5)]((_0x3d297d,_0x39b384)=>{var _0x32e838=_0x26e86b;_0x89a7c1[_0x39b384][_0x32e838(0xe1)]=_0x3d297d;}),_0x2e2ef2[_0x26e86b(0xe5)]((_0x30b95e,_0x2dff7f)=>{_0x89a7c1[_0x2dff7f]['unit']=_0x30b95e;}),_0x4feb3d[_0x26e86b(0xe5)]((_0x4736a1,_0x397c12)=>{var _0x2bc5fa=_0x26e86b;_0x89a7c1[_0x397c12][_0x2bc5fa(0xe7)]=_0x4736a1;}),_0x3f8001[_0x26e86b(0xe5)]((_0x1fab49,_0x318ce2)=>{var _0x4a2e6b=_0x26e86b;_0x89a7c1[_0x318ce2][_0x4a2e6b(0x116)]=_0x1fab49;}),_0x3bb055['forEach']((_0xd57b7,_0x326cfc)=>{var _0x1b9a94=_0x26e86b;_0x89a7c1[_0x326cfc][_0x1b9a94(0x176)]=_0xd57b7;}),_0x4623e3[_0x26e86b(0xe5)]((_0xcda483,_0x59d0c4)=>{var _0x3aaf9c=_0x26e86b;_0x89a7c1[_0x59d0c4][_0x3aaf9c(0x16d)]=_0xcda483;}),_0x5788e1[_0x26e86b(0xe5)]((_0x374601,_0xfe9327)=>{var _0x1683a3=_0x26e86b;_0x89a7c1[_0xfe9327][_0x1683a3(0xe1)]=_0x374601;}),_0x1e66de[_0x26e86b(0xe5)]((_0x18cc5f,_0x34fdab)=>{var _0x36726b=_0x26e86b;_0x89a7c1[_0x34fdab][_0x36726b(0xef)]=_0x18cc5f;}),_0x454d48[_0x26e86b(0xe5)]((_0x289b0c,_0x4dcdf5)=>{_0x89a7c1[_0x4dcdf5]['prod_cat']=_0x289b0c;}),_0x424da9['forEach']((_0x4ee279,_0x476858)=>{var _0x27680c=_0x26e86b;_0x89a7c1[_0x476858][_0x27680c(0x12a)]=_0x4ee279;}),_0xc6a82b['forEach']((_0x27e1ff,_0x5e023d)=>{var _0x25229c=_0x26e86b;_0x89a7c1[_0x5e023d][_0x25229c(0xdf)]=_0x27e1ff;});const _0x346c71=_0x89a7c1[_0x26e86b(0xed)](_0xc63f1b=>_0xc63f1b[_0x26e86b(0x155)]!=='0'&&_0xc63f1b[_0x26e86b(0x155)]!==''||_0xc63f1b['to_floorlevel']!=='0'&&_0xc63f1b[_0x26e86b(0xfc)]!=='');var _0x3512a5=0x0;_0x346c71['forEach'](_0x30221f=>{var _0x4633d5=_0x26e86b;parseInt(_0x30221f['from_quantity'])<parseInt(_0x30221f[_0x4633d5(0x155)])&&_0x3512a5++;});if(_0x3512a5!=0x0)return _0x333c9c[_0x26e86b(0xf6)](_0x26e86b(0x11d),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x216eb0[_0x26e86b(0x11b)]('back');const _0x38cd10=new invoice_for_transfer();await _0x38cd10[_0x26e86b(0x17e)]();for(let _0x26043f=0x0;_0x26043f<=_0xc6a82b[_0x26e86b(0x15d)]-0x1;_0x26043f++){_0x89a7c1[_0x26043f]['To_invoice']=_0x26e86b(0x14e)+_0x38cd10[_0x26e86b(0xe4)][_0x26e86b(0xe0)]()[_0x26e86b(0x103)](0x8,'0');}const _0x20b7a1=new transfers_finished({'date':_0x33dbf7,'from_warehouse':_0x2d0b23,'to_warehouse':_0x2d0b23,'product':_0x346c71,'note':_0xba375f,'invoice':'TRF-'+_0x38cd10[_0x26e86b(0xe4)][_0x26e86b(0xe0)]()['padStart'](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x26e86b(0x157),'PO_number':_0x259365,'RequestedBy':_0x1a68f4,'DateofRequest':_0x3e81f3,'typeservices':_0x47e536,'destination':_0x554b09,'deliverydate':_0x1c4048,'driver':_0xf60a0,'plate':_0x124e4c,'van':_0x4e1123,'DRSI':_0x47c27e,'typevehicle':_0x53352b,'TSU':_0x49b966,'TFU':_0x571adf}),_0x5413e7=await _0x20b7a1['save']();_0x333c9c[_0x26e86b(0xf6)](_0x26e86b(0x16f),_0x26e86b(0x165)),_0x216eb0[_0x26e86b(0x11b)]('/transfer_finished/preview/'+_0x5413e7['_id']);}catch(_0x231b76){console[_0x26e86b(0x13a)](_0x231b76),_0x216eb0[_0x26e86b(0x172)](0xc8)[_0x26e86b(0x107)]({'errorMessage':_0x231b76[_0x26e86b(0xd6)]});}}),router['post'](a0_0x33775f(0x100),auth,async(_0x5b2df1,_0x303b76)=>{var _0x3c02ef=a0_0x33775f;try{const {date:_0x1c32bb,from_warehouse:_0x3cafd,FromRoom_name:_0x4db270,to_warehouse:_0x263862,ToRoom_name:_0xb154c3,prod_name:_0x4267d9,from_prod_qty:_0x442800,from_prod_level:_0x48c4b3,from_prod_isle:_0xbfe22b,from_prod_pallet:_0x5a2ed3,to_prod_qty:_0xfcb504,to_prod_level:_0x3b6587,to_prod_isle:_0x4fecb4,to_prod_pallet:_0x3ba36d,primary_code:_0xd5e19c,secondary_code:_0x5947f4,product_code3:_0xd94272,note:_0x1bba81,MaxStocks_data2:_0x140088,invoice:_0x2c3508,expiry_date:_0xbb57d8,PO_number_loc:_0x374621,ReqBy_loc:_0x4a36a9,dateofreq_loc:_0x23d079,typeservices_loc_Data:_0x2eb85e,destination_loc:_0x1dc9a1,deliverydate_loc:_0x1cee7a,driver_loc:_0x1aa902,plate_loc:_0x404e05,van_loc:_0x1348d2,DRSI_loc:_0x36eef1,typevehicle_loc:_0x1aa68e,TSU_loc:_0x3b07c6,TFU_loc:_0x4d4c42}=_0x5b2df1[_0x3c02ef(0xbb)];if(typeof _0x4267d9=='string')var _0x289106=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x13b)]],_0x4b8a2c=[_0x5b2df1['body'][_0x3c02ef(0x11e)]],_0x61978d=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x17d)]],_0x20320e=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x16b)]],_0x210598=[_0x5b2df1[_0x3c02ef(0xbb)]['to_prod_level']],_0xb6c128=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x152)]],_0x38c8e0=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x110)]],_0x560501=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x121)]],_0x2e0de8=[_0x5b2df1['body'][_0x3c02ef(0xda)]],_0x3aa165=[_0x5b2df1['body']['primary_unit']],_0x148590=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0xe7)]],_0x42bc62=[_0x5b2df1[_0x3c02ef(0xbb)]['batch_code']],_0x4866a4=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x176)]],_0x401ca6=[_0x5b2df1['body']['product_date']],_0x31ee6c=[_0x5b2df1['body'][_0x3c02ef(0xf9)]],_0x2b8d35=[_0x5b2df1[_0x3c02ef(0xbb)]['maxPerUnit']],_0x59c7bb=[_0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x135)]],_0x524c84=[_0x5b2df1[_0x3c02ef(0xbb)]['RoomAssigned']],_0x1d5e8f=[_0x5b2df1['body'][_0x3c02ef(0x118)]],_0xdfe28c=[_0x5b2df1['body'][_0x3c02ef(0x150)]],_0x54eab8=[_0x5b2df1[_0x3c02ef(0xbb)]['id_transaction']];else var _0x289106=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x13b)]],_0x4b8a2c=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x11e)]],_0x61978d=[..._0x5b2df1['body'][_0x3c02ef(0x17d)]],_0x20320e=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x16b)]],_0x210598=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0xeb)]],_0xb6c128=[..._0x5b2df1['body'][_0x3c02ef(0x152)]],_0x38c8e0=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x110)]],_0x560501=[..._0x5b2df1[_0x3c02ef(0xbb)]['product_code3']],_0x2e0de8=[..._0x5b2df1[_0x3c02ef(0xbb)]['MaxStocks_data2']],_0x3aa165=[..._0x5b2df1['body']['primary_unit']],_0x148590=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0xe7)]],_0x42bc62=[..._0x5b2df1[_0x3c02ef(0xbb)]['batch_code']],_0x4866a4=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x176)]],_0x401ca6=[..._0x5b2df1[_0x3c02ef(0xbb)]['product_date']],_0x31ee6c=[..._0x5b2df1['body']['MaxStocks_data']],_0x2b8d35=[..._0x5b2df1['body'][_0x3c02ef(0xef)]],_0x59c7bb=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x135)]],_0x524c84=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0xf0)]],_0x1d5e8f=[..._0x5b2df1[_0x3c02ef(0xbb)]['ToRoomAssigned']],_0xdfe28c=[..._0x5b2df1[_0x3c02ef(0xbb)][_0x3c02ef(0x150)]],_0x54eab8=[..._0x5b2df1[_0x3c02ef(0xbb)]['id_transaction']];const _0x2fd45c=_0x289106['map'](_0x4ab17d=>{return _0x4ab17d={'product_name':_0x4ab17d};});_0x4b8a2c[_0x3c02ef(0xe5)]((_0x379521,_0x1f7134)=>{var _0x1a120f=_0x3c02ef;_0x2fd45c[_0x1f7134][_0x1a120f(0x17f)]=_0x379521;}),_0x61978d['forEach']((_0x5e1120,_0x7f71ff)=>{var _0x2b0d9=_0x3c02ef,_0x4baf77=_0x5e1120[_0x2b0d9(0x174)](/[A-Za-z]+/)[0x0],_0x32ecf6=parseInt(_0x5e1120[_0x2b0d9(0x174)](/\d+/)[0x0]);_0x2fd45c[_0x7f71ff][_0x2b0d9(0xd1)]=_0x32ecf6,_0x2fd45c[_0x7f71ff][_0x2b0d9(0x16e)]=_0x4baf77;}),_0x54eab8['forEach']((_0x14ff86,_0x4bb0a4)=>{var _0x241a48=_0x3c02ef;_0x2fd45c[_0x4bb0a4][_0x241a48(0xdd)]=_0x14ff86;}),_0xdfe28c[_0x3c02ef(0xe5)]((_0x2e01b4,_0x21e3bd)=>{var _0x4667cd=_0x3c02ef;_0x2fd45c[_0x21e3bd][_0x4667cd(0x150)]=_0x2e01b4;}),_0x20320e['forEach']((_0x928a99,_0x5c9e96)=>{var _0x28320f=_0x3c02ef;_0x2fd45c[_0x5c9e96][_0x28320f(0x155)]=_0x928a99;}),_0x210598[_0x3c02ef(0xe5)]((_0x5aca8e,_0x4b3199)=>{var _0x59cf0a=_0x3c02ef,_0x1b1555=_0x5aca8e['match'](/[A-Za-z]+/)[0x0],_0x4af9e6=parseInt(_0x5aca8e[_0x59cf0a(0x174)](/\d+/)[0x0]);_0x2fd45c[_0x4b3199][_0x59cf0a(0x11f)]=_0x1b1555,_0x2fd45c[_0x4b3199][_0x59cf0a(0xbe)]=_0x4af9e6;}),_0xb6c128[_0x3c02ef(0xe5)]((_0x29267c,_0x5ee8a1)=>{_0x2fd45c[_0x5ee8a1]['primary_code']=_0x29267c;}),_0x38c8e0[_0x3c02ef(0xe5)]((_0x3a73c0,_0x16c97d)=>{var _0x1a3e0b=_0x3c02ef;_0x2fd45c[_0x16c97d][_0x1a3e0b(0x110)]=_0x3a73c0;}),_0x560501[_0x3c02ef(0xe5)]((_0x39f405,_0x58f3b8)=>{var _0x59f704=_0x3c02ef;_0x2fd45c[_0x58f3b8][_0x59f704(0x126)]=_0x39f405;}),_0x2e0de8[_0x3c02ef(0xe5)]((_0x5f4a52,_0x3b4c16)=>{var _0x566500=_0x3c02ef;_0x2fd45c[_0x3b4c16][_0x566500(0xe1)]=_0x5f4a52;}),_0x3aa165[_0x3c02ef(0xe5)]((_0xa7987e,_0x115fdb)=>{var _0x199f9f=_0x3c02ef;_0x2fd45c[_0x115fdb][_0x199f9f(0x14a)]=_0xa7987e;}),_0x148590[_0x3c02ef(0xe5)]((_0x53dcf7,_0x4e7487)=>{var _0x179210=_0x3c02ef;_0x2fd45c[_0x4e7487][_0x179210(0xe7)]=_0x53dcf7;}),_0x42bc62[_0x3c02ef(0xe5)]((_0x31d2fe,_0x35d5a3)=>{var _0x3d15fa=_0x3c02ef;_0x2fd45c[_0x35d5a3][_0x3d15fa(0x116)]=_0x31d2fe;}),_0x4866a4[_0x3c02ef(0xe5)]((_0x4bb94d,_0x36bfdc)=>{var _0x5a6b12=_0x3c02ef;_0x2fd45c[_0x36bfdc][_0x5a6b12(0x176)]=_0x4bb94d;}),_0x401ca6[_0x3c02ef(0xe5)]((_0x4375dc,_0x2e135e)=>{var _0x1c60d5=_0x3c02ef;_0x2fd45c[_0x2e135e][_0x1c60d5(0x16d)]=_0x4375dc;}),_0x31ee6c['forEach']((_0x4b2972,_0x1d9357)=>{var _0xf770c1=_0x3c02ef;_0x2fd45c[_0x1d9357][_0xf770c1(0xe1)]=_0x4b2972;}),_0x2b8d35[_0x3c02ef(0xe5)]((_0x2680d1,_0x19f5f1)=>{var _0x253646=_0x3c02ef;_0x2fd45c[_0x19f5f1][_0x253646(0xef)]=_0x2680d1;}),_0x59c7bb['forEach']((_0x11708b,_0x33dfc2)=>{var _0x2beb6c=_0x3c02ef;_0x2fd45c[_0x33dfc2][_0x2beb6c(0x135)]=_0x11708b;}),_0x524c84['forEach']((_0x5a028d,_0x285612)=>{var _0x3fc064=_0x3c02ef;_0x2fd45c[_0x285612][_0x3fc064(0x12a)]=_0x5a028d;}),_0x1d5e8f[_0x3c02ef(0xe5)]((_0x43700a,_0x2be29f)=>{var _0x502cc0=_0x3c02ef;_0x2fd45c[_0x2be29f][_0x502cc0(0xdf)]=_0x43700a;});const _0x84366e=_0x2fd45c[_0x3c02ef(0xed)](_0x5464c6=>_0x5464c6[_0x3c02ef(0x155)]!=='0'&&_0x5464c6[_0x3c02ef(0x155)]!==''||_0x5464c6[_0x3c02ef(0xfc)]!=='0'&&_0x5464c6[_0x3c02ef(0xfc)]!=='');var _0x407ea8=0x0;_0x84366e[_0x3c02ef(0xe5)](_0x5d339a=>{var _0x18e9f5=_0x3c02ef;parseInt(_0x5d339a[_0x18e9f5(0x17f)])<parseInt(_0x5d339a[_0x18e9f5(0x155)])&&_0x407ea8++;});if(_0x407ea8!=0x0)return _0x5b2df1[_0x3c02ef(0xf6)](_0x3c02ef(0x11d),_0x3c02ef(0x13e)),_0x303b76['redirect'](_0x3c02ef(0xcc));const _0x54a429=new invoice_for_transfer();await _0x54a429[_0x3c02ef(0x17e)]();for(let _0x25fddd=0x0;_0x25fddd<=_0x1d5e8f['length']-0x1;_0x25fddd++){_0x2fd45c[_0x25fddd][_0x3c02ef(0x122)]=_0x3c02ef(0x14e)+_0x54a429['invoice_init']['toString']()['padStart'](0x8,'0');}const _0x3d0e3c=new transfers_finished({'date':_0x1c32bb,'from_warehouse':_0x3cafd,'to_warehouse':_0x263862,'product':_0x84366e,'note':_0x1bba81,'invoice':'TRF-'+_0x54a429[_0x3c02ef(0xe4)][_0x3c02ef(0xe0)]()[_0x3c02ef(0x103)](0x8,'0'),'type_of_transaction':_0x3c02ef(0x157),'type_of_process':'location2location','PO_number':_0x374621,'RequestedBy':_0x4a36a9,'DateofRequest':_0x23d079,'typeservices':_0x2eb85e,'destination':_0x1dc9a1,'deliverydate':_0x1cee7a,'driver':_0x1aa902,'plate':_0x404e05,'van':_0x1348d2,'DRSI':_0x36eef1,'typevehicle':_0x1aa68e,'TSU':_0x3b07c6,'TFU':_0x4d4c42}),_0x5c1c42=await _0x3d0e3c[_0x3c02ef(0x17e)]();_0x5b2df1['flash']('success',_0x3c02ef(0x165)),_0x303b76[_0x3c02ef(0x11b)](_0x3c02ef(0x170)+_0x5c1c42[_0x3c02ef(0x13d)]);}catch(_0x5de08e){console[_0x3c02ef(0x13a)](_0x5de08e),_0x303b76[_0x3c02ef(0x172)](0xc8)[_0x3c02ef(0x107)]({'errorMessage':_0x5de08e[_0x3c02ef(0xd6)]});}}),router[a0_0x33775f(0xca)](a0_0x33775f(0x171),auth,async(_0x2b21eb,_0x9b2bdd)=>{var _0xbdc789=a0_0x33775f;try{const {username:_0x49eb4b,email:_0x1ee326,role:_0x5e98a3}=_0x2b21eb['user'],_0x4fa62a=_0x2b21eb[_0xbdc789(0xdc)],_0x3f7b69=await profile[_0xbdc789(0x16c)]({'email':_0x4fa62a['email']}),_0x7cc520=await master_shop[_0xbdc789(0x137)](),_0x13ab17=await transfers_finished[_0xbdc789(0xbf)](_0x2b21eb[_0xbdc789(0x10b)]['id']);let _0x366cba;if(_0x4fa62a[_0xbdc789(0x178)]==_0xbdc789(0xc0)){const _0x16cdb6=await staff[_0xbdc789(0x16c)]({'email':_0x4fa62a[_0xbdc789(0x101)]});_0x366cba=await warehouse[_0xbdc789(0x137)]({'status':'Enabled','name':_0x16cdb6[_0xbdc789(0x162)],'warehouse_category':_0xbdc789(0x163)});}else _0x366cba=await warehouse[_0xbdc789(0x137)]({'status':_0xbdc789(0x146),'warehouse_category':'Finished\x20Goods'});const _0x257993=await warehouse[_0xbdc789(0x142)]([{'$match':{'name':_0x13ab17[_0xbdc789(0xff)],'warehouse_category':_0xbdc789(0x163)}},{'$unwind':_0xbdc789(0x111)},{'$group':{'_id':_0xbdc789(0x12b),'name':{'$first':_0xbdc789(0x180)},'product_stock':{'$first':_0xbdc789(0xd0)},'bay':{'$first':_0xbdc789(0xbc)},'bin':{'$first':_0xbdc789(0xc2)},'type':{'$first':_0xbdc789(0x11c)},'floorlevel':{'$first':_0xbdc789(0x10a)},'primary_code':{'$first':_0xbdc789(0xd2)},'secondary_code':{'$first':_0xbdc789(0xd4)},'product_code':{'$first':_0xbdc789(0xc7)},'storage':{'$first':_0xbdc789(0x14f)},'rack':{'$first':_0xbdc789(0xd5)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0xbdc789(0xc5)},'warehoue_name':{'$first':_0xbdc789(0x10e)}}}]),_0x585fac=await product['find']({});if(_0x7cc520[0x0][_0xbdc789(0x102)]==_0xbdc789(0x112)){var _0x392ff0=users[_0xbdc789(0x12f)];console[_0xbdc789(0x13a)](_0x392ff0);}else{if(_0x7cc520[0x0][_0xbdc789(0x102)]=='Hindi')var _0x392ff0=users['Hindi'];else{if(_0x7cc520[0x0][_0xbdc789(0x102)]==_0xbdc789(0x148))var _0x392ff0=users['German'];else{if(_0x7cc520[0x0][_0xbdc789(0x102)]=='Spanish')var _0x392ff0=users[_0xbdc789(0x12d)];else{if(_0x7cc520[0x0][_0xbdc789(0x102)]==_0xbdc789(0x15b))var _0x392ff0=users[_0xbdc789(0x15b)];else{if(_0x7cc520[0x0][_0xbdc789(0x102)]=='Portuguese\x20(BR)')var _0x392ff0=users[_0xbdc789(0x175)];else{if(_0x7cc520[0x0]['language']==_0xbdc789(0x120))var _0x392ff0=users[_0xbdc789(0x120)];else{if(_0x7cc520[0x0][_0xbdc789(0x102)]==_0xbdc789(0x161))var _0x392ff0=users['Arabic'];}}}}}}}_0x9b2bdd[_0xbdc789(0x124)](_0xbdc789(0x114),{'success':_0x2b21eb[_0xbdc789(0xf6)]('success'),'errors':_0x2b21eb[_0xbdc789(0xf6)](_0xbdc789(0x11d)),'role':_0x4fa62a,'profile':_0x3f7b69,'master_shop':_0x7cc520,'warehouse':_0x366cba,'transfer':_0x13ab17,'stock':_0x257993,'unit':_0x585fac,'language':_0x392ff0});}catch(_0x1671e9){console[_0xbdc789(0x13a)](_0x1671e9);}}),router[a0_0x33775f(0x164)](a0_0x33775f(0x171),auth,async(_0x4bda0e,_0xfcd367)=>{var _0x19187d=a0_0x33775f;try{const {invoice:_0x14b3b8,from_warehouse:_0x37624b,FromRoom_name:_0x5724e7,to_warehouse:_0x5cdd26,ToRoom_name:_0xd9eae4}=_0x4bda0e['body'],_0x472760=await transfers_finished[_0x19187d(0xbf)](_0x4bda0e[_0x19187d(0x10b)]['id']),_0x47dd57=_0x472760[_0x19187d(0xbd)][_0x19187d(0xec)](async _0x3f6630=>{var _0x321af6=_0x19187d;if(_0x3f6630[_0x321af6(0x155)]>0x0){var _0x267c9e=await warehouse[_0x321af6(0x16c)]({'name':_0x37624b,'room':_0x3f6630[_0x321af6(0x12a)]});const _0x10bb9d=_0x267c9e[_0x321af6(0xe6)]['map'](_0x19f433=>{var _0x4289c0=_0x321af6;_0x19f433[_0x4289c0(0x13d)]==_0x3f6630['id_transaction']&&(_0x19f433[_0x4289c0(0x154)]=Math[_0x4289c0(0xfa)](0x0,Math[_0x4289c0(0x10d)](_0x19f433[_0x4289c0(0x154)])-Math['abs'](_0x3f6630['to_quantity'])),console[_0x4289c0(0x13a)](_0x19f433[_0x4289c0(0x154)]));});}return _0x267c9e;});Promise[_0x19187d(0x127)](_0x47dd57)[_0x19187d(0x14c)](async _0x1e5eb0=>{var _0x3971f1=_0x19187d;try{for(const _0x591014 of _0x1e5eb0){await _0x591014['save']();}const _0x3e0c6f=_0x472760['product']['map'](async _0x3b99a1=>{var _0x2c255a=a0_0x3df3,_0xe0f25=await warehouse['findOne']({'name':_0x5cdd26,'room':_0x3b99a1[_0x2c255a(0xdf)]});if(_0x3b99a1[_0x2c255a(0x155)]>0x0){var _0x2b7efe=0x0;const _0x482ea6=_0xe0f25['product_details'][_0x2c255a(0xec)](_0x2feae1=>{var _0xc10968=_0x2c255a;_0x2feae1[_0xc10968(0x113)]==_0x3b99a1[_0xc10968(0x113)]&&_0x2feae1[_0xc10968(0x130)]==_0x3b99a1[_0xc10968(0xbe)]&&_0x2feae1[_0xc10968(0x176)]==_0x3b99a1[_0xc10968(0x176)]&&_0x2feae1[_0xc10968(0x16d)]==_0x3b99a1[_0xc10968(0x16d)]&&_0x2feae1[_0xc10968(0x116)]==_0x3b99a1[_0xc10968(0x116)]&&_0x2feae1['invoice']==_0x3b99a1[_0xc10968(0x122)]&&(typeof _0x3b99a1['id_transaction']==_0xc10968(0x109)?(console[_0xc10968(0x13a)]('here2',_0x2feae1['product_stock']+'\x20<>\x20'+_0x2feae1['_id']+_0xc10968(0x17a)+Math[_0xc10968(0x10d)](_0x2feae1['product_stock'])+Math[_0xc10968(0x10d)](_0x3b99a1['to_quantity'])),_0x2feae1['product_stock']=Math[_0xc10968(0x10d)](_0x2feae1['product_stock'])+Math['abs'](_0x3b99a1['to_quantity'])):_0x2feae1['product_stock']=Math[_0xc10968(0x10d)](_0x2feae1[_0xc10968(0x154)])+Math[_0xc10968(0x10d)](_0x3b99a1[_0xc10968(0x155)]),_0x2b7efe++);});_0x2b7efe=='0'&&(_0xe0f25[_0x2c255a(0xe6)]=_0xe0f25[_0x2c255a(0xe6)][_0x2c255a(0x125)]({'product_name':_0x3b99a1[_0x2c255a(0x113)],'product_stock':_0x3b99a1[_0x2c255a(0x155)],'bay':_0x3b99a1[_0x2c255a(0xbe)],'level':_0x3b99a1[_0x2c255a(0x11f)],'product_code':_0x3b99a1['product_code'],'primary_code':_0x3b99a1[_0x2c255a(0x152)],'secondary_code':_0x3b99a1[_0x2c255a(0x110)],'expiry_date':_0x3b99a1['expiry_date'],'production_date':_0x3b99a1[_0x2c255a(0x16d)],'maxProducts':_0x3b99a1[_0x2c255a(0xe1)],'batch_code':_0x3b99a1[_0x2c255a(0x116)],'secondary_unit':_0x3b99a1['secondary_unit'],'unit':_0x3b99a1[_0x2c255a(0x14a)],'maxProducts':_0x3b99a1['maxProducts'],'maxPerUnit':_0x3b99a1[_0x2c255a(0xef)],'invoice':_0x3b99a1['To_invoice']}));}return _0xe0f25;});Promise[_0x3971f1(0x127)](_0x3e0c6f)[_0x3971f1(0x14c)](async _0x38bf47=>{var _0x22b48d=_0x3971f1;try{console['log'](_0x472760[_0x22b48d(0xd3)]);if(_0x472760[_0x22b48d(0xd3)]!=_0x22b48d(0xcd))for(const _0x569ef4 of _0x38bf47){await warehouse[_0x22b48d(0xcb)]({'_id':_0x569ef4[_0x22b48d(0x13d)]},{'$addToSet':{'product_details':{'$each':_0x569ef4[_0x22b48d(0xe6)]}}});}_0x472760['finalize']=_0x22b48d(0x134);const _0x53ebc0=await _0x472760[_0x22b48d(0x17e)](),_0xfc2b33=await master_shop['find'](),_0x5b050a=await email_settings[_0x22b48d(0x16c)](),_0x1618ce=await supervisor_settings[_0x22b48d(0x137)]();var _0x206247=_0x472760[_0x22b48d(0xbd)],_0x4e23ef='',_0x316f3d;for(_0x316f3d in _0x206247){var _0x5201ad='FG';_0x472760[_0x22b48d(0x15f)]=='DRY\x20GOODS'&&(_0x5201ad='DG'),_0x4e23ef+='<tr>'+_0x22b48d(0xf7)+_0x206247[_0x316f3d][_0x22b48d(0x113)]+_0x22b48d(0x159)+_0x22b48d(0xf7)+_0x206247[_0x316f3d][_0x22b48d(0x126)]+_0x22b48d(0x159)+_0x22b48d(0xf7)+_0x206247[_0x316f3d][_0x22b48d(0x155)]+_0x22b48d(0x159)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x206247[_0x316f3d][_0x22b48d(0x14a)]+_0x22b48d(0x159)+_0x22b48d(0xf7)+_0x206247[_0x316f3d][_0x22b48d(0xe7)]+_0x22b48d(0x159)+_0x22b48d(0xf7)+_0x472760[_0x22b48d(0x15f)]+_0x22b48d(0x159)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x206247[_0x316f3d]['to_room_name']+_0x22b48d(0x159)+_0x22b48d(0xf7)+_0x5201ad+_0x206247[_0x316f3d]['to_bay']+_0x22b48d(0x159)+'</tr>';}_0x4bda0e[_0x22b48d(0xf6)](_0x22b48d(0x16f),_0x22b48d(0xf5)),_0xfcd367[_0x22b48d(0x11b)](_0x22b48d(0x10f)+_0x53ebc0['_id']);}catch(_0x417dee){console[_0x22b48d(0x15a)](_0x417dee),_0xfcd367['status'](0x1f4)[_0x22b48d(0x107)]({'error':_0x22b48d(0x129)});}})[_0x3971f1(0xdb)](_0x310ec0=>{var _0x5ace85=_0x3971f1;console[_0x5ace85(0x15a)](_0x310ec0),_0xfcd367[_0x5ace85(0x172)](0x1f4)[_0x5ace85(0x107)]({'error':_0x5ace85(0x136)});});}catch(_0x42c74c){console[_0x3971f1(0x15a)](_0x42c74c),_0xfcd367['status'](0x1f4)['json']({'error':_0x3971f1(0xf4)});}})[_0x19187d(0xdb)](_0x667935=>{var _0x19b9af=_0x19187d;console[_0x19b9af(0x15a)](_0x667935),_0xfcd367[_0x19b9af(0x172)](0x1f4)[_0x19b9af(0x107)]({'error':'An\x20error\x20occurred.'});});}catch(_0x299ef5){_0xfcd367[_0x19187d(0x107)]({'message':_0x299ef5[_0x19187d(0xd6)]});}});function BayBinSelected(_0x4cddf0,_0x5925dc){var _0xb2df79=a0_0x33775f,_0x1ac923=[];let _0x103841=[];var _0x47d4f4=[];if(_0x4cddf0==_0xb2df79(0x104)){switch(_0x5925dc){case _0xb2df79(0x16a):_0x1ac923=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0xb2df79(0x14b):_0x1ac923=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x47d4f4=['DG'];}else{if(_0x4cddf0==_0xb2df79(0xea)){switch(_0x5925dc){case _0xb2df79(0x16a):_0x1ac923=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0xb2df79(0x14b):_0x1ac923=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x47d4f4=['FG'];}}return{'levels':_0x1ac923,'identify':_0x47d4f4};}router[a0_0x33775f(0xca)]('/view/:id',auth,async(_0x5d3d73,_0x35fd4d)=>{var _0xfd14af=a0_0x33775f;try{const {username:_0x1175b4,email:_0x5f3f97,role:_0x1769d4}=_0x5d3d73['user'],_0x433643=_0x5d3d73[_0xfd14af(0xdc)],_0x5a8cf5=await profile[_0xfd14af(0x16c)]({'email':_0x433643[_0xfd14af(0x101)]}),_0x5f4480=await master_shop[_0xfd14af(0x137)](),_0x515d49=await transfers_finished[_0xfd14af(0xbf)](_0x5d3d73[_0xfd14af(0x10b)]['id']);let _0x5ae608=new Date(_0x515d49[_0xfd14af(0x176)]),_0x4322bf=('0'+_0x5ae608['getDate']())[_0xfd14af(0xf1)](-0x2),_0x27d652=('0'+(_0x5ae608['getMonth']()+0x1))[_0xfd14af(0xf1)](-0x2),_0x5d87c7=_0x5ae608[_0xfd14af(0x185)](),_0x315b2a=_0x5d87c7+'-'+_0x27d652+'-'+_0x4322bf,_0x331e23;if(_0x433643['role']=='staff'){const _0x53d4ff=await staff['findOne']({'email':_0x433643['email']});_0x331e23=await warehouse[_0xfd14af(0x137)]({'status':_0xfd14af(0x146),'name':_0x53d4ff['warehouse'],'warehouse_category':_0xfd14af(0x163)});}else _0x331e23=await warehouse['find']({'status':_0xfd14af(0x146),'warehouse_category':_0xfd14af(0x163)});const _0x2058af=await warehouse['aggregate']([{'$match':{'name':_0x515d49['from_warehouse'],'room':_0x515d49[_0xfd14af(0xfb)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0xfd14af(0x180)},'product_stock':{'$first':_0xfd14af(0xd0)},'bay':{'$first':_0xfd14af(0xbc)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xfd14af(0x11c)},'floorlevel':{'$first':_0xfd14af(0x10a)},'primary_code':{'$first':_0xfd14af(0xd2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xfd14af(0x14f)},'rack':{'$first':_0xfd14af(0xd5)}}}]);var _0x15150f=[0x1,0x2,0x3,0x4],_0x2a91dd=['A','B','C','D','E','F','G','H','I','J'],_0x16e3e0=[_0xfd14af(0x143),_0xfd14af(0x13f)];const _0x140570=await product['find']({}),_0x288507=BayBinSelected(_0x515d49[_0xfd14af(0x15f)],_0x515d49[_0xfd14af(0xc9)]);if(_0x5f4480[0x0][_0xfd14af(0x102)]==_0xfd14af(0x112)){var _0x23559c=users[_0xfd14af(0x12f)];console[_0xfd14af(0x13a)](_0x23559c);}else{if(_0x5f4480[0x0][_0xfd14af(0x102)]==_0xfd14af(0x149))var _0x23559c=users[_0xfd14af(0x149)];else{if(_0x5f4480[0x0]['language']==_0xfd14af(0x148))var _0x23559c=users[_0xfd14af(0x148)];else{if(_0x5f4480[0x0][_0xfd14af(0x102)]=='Spanish')var _0x23559c=users[_0xfd14af(0x12d)];else{if(_0x5f4480[0x0]['language']==_0xfd14af(0x15b))var _0x23559c=users['French'];else{if(_0x5f4480[0x0]['language']==_0xfd14af(0xfd))var _0x23559c=users['Portuguese'];else{if(_0x5f4480[0x0][_0xfd14af(0x102)]==_0xfd14af(0x120))var _0x23559c=users[_0xfd14af(0x120)];else{if(_0x5f4480[0x0][_0xfd14af(0x102)]==_0xfd14af(0x161))var _0x23559c=users[_0xfd14af(0xc3)];}}}}}}}_0x35fd4d[_0xfd14af(0x124)](_0xfd14af(0xc1),{'success':_0x5d3d73[_0xfd14af(0xf6)](_0xfd14af(0x16f)),'errors':_0x5d3d73[_0xfd14af(0xf6)](_0xfd14af(0x11d)),'role':_0x433643,'profile':_0x5a8cf5,'master_shop':_0x5f4480,'warehouse':_0x331e23,'transfer':_0x515d49,'stock':_0x2058af,'unit':_0x140570,'language':_0x23559c,'levels':_0x15150f,'Isle':_0x2a91dd,'rooms_data':_0x16e3e0,'ed_fullDate':_0x315b2a,'dataSelected':_0x288507});}catch(_0x4e0793){console['log'](_0x4e0793);}}),router['post'](a0_0x33775f(0x144),auth,async(_0x1e8b80,_0x39b6ec)=>{var _0x5a69ce=a0_0x33775f;try{const _0x400d19=_0x1e8b80[_0x5a69ce(0x10b)]['id'];console['log'](_0x1e8b80[_0x5a69ce(0xbb)]);const _0x564c78=await transfers_finished[_0x5a69ce(0xbf)](_0x400d19);console[_0x5a69ce(0x13a)](_0x5a69ce(0xd9),_0x564c78);const {date:_0x4cbca4,from_warehouse:_0x5f434e,FromRoom_name:_0x1b70f0,to_warehouse:_0x537da2,ToRoom_name:_0x3bb86e,prod_name:_0x444893,from_prod_qty:_0x7b4f5e,from_prod_level:_0x2d9520,from_prod_isle:_0x73af68,from_prod_pallet:_0x2c01c6,to_prod_qty:_0x3e6cae,to_prod_level:_0x2c685a,to_prod_isle:_0x4e0de3,to_prod_pallet:_0x12ff22,primary_code:_0x428612,secondary_code:_0x121027,product_code3:_0x2bf82e,note:_0x4aa7c8,invoice:_0x5aa94b,expiry_date:_0x3dbf71}=_0x1e8b80[_0x5a69ce(0xbb)];if(typeof _0x444893==_0x5a69ce(0x151))var _0x54fe6e=[_0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0x13b)]],_0x424ba5=[_0x1e8b80['body'][_0x5a69ce(0x11e)]],_0x40fdd2=[_0x1e8b80['body'][_0x5a69ce(0xf2)]],_0x535aa5=[_0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0x147)]],_0x350171=[_0x1e8b80[_0x5a69ce(0xbb)]['to_prod_level']],_0x155660=[_0x1e8b80['body']['primary_code']],_0xd4bfa4=[_0x1e8b80[_0x5a69ce(0xbb)]['secondary_code']],_0x115eef=[_0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0x121)]],_0x2fc31d=[_0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0xda)]],_0x1168ee=[_0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0x14a)]],_0x2d9629=[_0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0xe7)]],_0x43f1c5=[_0x1e8b80[_0x5a69ce(0xbb)]['batch_code']],_0x4d3a80=[_0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0x176)]];else var _0x54fe6e=[..._0x1e8b80[_0x5a69ce(0xbb)]['prod_name']],_0x424ba5=[..._0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0x11e)]],_0x40fdd2=[..._0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0xf2)]],_0x535aa5=[..._0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0x147)]],_0x350171=[..._0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0xeb)]],_0x155660=[..._0x1e8b80['body'][_0x5a69ce(0x152)]],_0xd4bfa4=[..._0x1e8b80[_0x5a69ce(0xbb)]['secondary_code']],_0x115eef=[..._0x1e8b80[_0x5a69ce(0xbb)]['product_code3']],_0x2fc31d=[..._0x1e8b80['body'][_0x5a69ce(0xda)]],_0x1168ee=[..._0x1e8b80['body'][_0x5a69ce(0x14a)]],_0x2d9629=[..._0x1e8b80['body']['secondary_unit']],_0x43f1c5=[..._0x1e8b80[_0x5a69ce(0xbb)]['batch_code']],_0x4d3a80=[..._0x1e8b80[_0x5a69ce(0xbb)][_0x5a69ce(0x176)]];const _0x23c17b=_0x54fe6e[_0x5a69ce(0xec)](_0x2c2ffc=>{return _0x2c2ffc={'product_name':_0x2c2ffc};});_0x424ba5[_0x5a69ce(0xe5)]((_0xb5e05f,_0x42f95)=>{var _0x660436=_0x5a69ce;_0x23c17b[_0x42f95][_0x660436(0x17f)]=_0xb5e05f;}),_0x40fdd2[_0x5a69ce(0xe5)]((_0x53adcc,_0x380853)=>{_0x23c17b[_0x380853]['from_bay']=_0x53adcc;}),_0x535aa5[_0x5a69ce(0xe5)]((_0x44b901,_0x344ecb)=>{_0x23c17b[_0x344ecb]['to_quantity']=_0x44b901;}),_0x350171[_0x5a69ce(0xe5)]((_0x1e643e,_0x515fed)=>{_0x23c17b[_0x515fed]['to_bay']=_0x1e643e;}),_0x155660[_0x5a69ce(0xe5)]((_0x446370,_0x550496)=>{var _0x4e9516=_0x5a69ce;_0x23c17b[_0x550496][_0x4e9516(0x152)]=_0x446370;}),_0xd4bfa4['forEach']((_0x149be5,_0x456d4e)=>{var _0x3337ae=_0x5a69ce;_0x23c17b[_0x456d4e][_0x3337ae(0x110)]=_0x149be5;}),_0x115eef[_0x5a69ce(0xe5)]((_0x13e395,_0x1e44e4)=>{_0x23c17b[_0x1e44e4]['product_code']=_0x13e395;}),_0x2fc31d[_0x5a69ce(0xe5)]((_0x4b444e,_0x24aca1)=>{var _0x273357=_0x5a69ce;_0x23c17b[_0x24aca1][_0x273357(0xe1)]=_0x4b444e;}),_0x1168ee['forEach']((_0x570479,_0x33de58)=>{var _0x13cb13=_0x5a69ce;_0x23c17b[_0x33de58][_0x13cb13(0x14a)]=_0x570479;}),_0x2d9629[_0x5a69ce(0xe5)]((_0x5dcd41,_0x360bfa)=>{var _0x5634be=_0x5a69ce;_0x23c17b[_0x360bfa][_0x5634be(0xe7)]=_0x5dcd41;}),_0x43f1c5[_0x5a69ce(0xe5)]((_0x254992,_0x4d8c0a)=>{var _0x3bbd31=_0x5a69ce;_0x23c17b[_0x4d8c0a][_0x3bbd31(0x116)]=_0x254992;}),_0x4d3a80['forEach']((_0x2ca4ea,_0x12525c)=>{var _0x409c97=_0x5a69ce;_0x23c17b[_0x12525c][_0x409c97(0x176)]=_0x2ca4ea;});const _0xcd39b6=_0x23c17b[_0x5a69ce(0xed)](_0x40b830=>_0x40b830[_0x5a69ce(0x155)]!=='0'&&_0x40b830[_0x5a69ce(0x155)]!==''||_0x40b830[_0x5a69ce(0xfc)]!=='0'&&_0x40b830['to_floorlevel']!=='');var _0x3a28e8=0x0;_0xcd39b6[_0x5a69ce(0xe5)](_0xb229d6=>{var _0x1f8bf2=_0x5a69ce;parseInt(_0xb229d6['from_quantity'])<parseInt(_0xb229d6[_0x1f8bf2(0x155)])&&_0x3a28e8++;});if(_0x3a28e8!=0x0)return _0x1e8b80[_0x5a69ce(0xf6)](_0x5a69ce(0x11d),_0x5a69ce(0x13e)),_0x39b6ec[_0x5a69ce(0x11b)](_0x5a69ce(0xcc));const _0x525459=await warehouse[_0x5a69ce(0x16c)]({'name':_0x564c78[_0x5a69ce(0xff)],'room':_0x564c78[_0x5a69ce(0xfb)]});_0x564c78[_0x5a69ce(0xbd)]['forEach'](_0x2cf1a2=>{var _0x75242d=_0x5a69ce;if(_0x2cf1a2[_0x75242d(0x155)]>0x0){const _0x582fe7=_0x525459[_0x75242d(0xe6)][_0x75242d(0xec)](_0x7be61b=>{var _0x10f9b6=_0x75242d;_0x7be61b[_0x10f9b6(0x113)]==_0x2cf1a2[_0x10f9b6(0x113)]&&_0x7be61b['bay']==_0x2cf1a2[_0x10f9b6(0xd1)]&&(_0x7be61b[_0x10f9b6(0x154)]=parseInt(_0x7be61b[_0x10f9b6(0x154)])+parseInt(_0x2cf1a2[_0x10f9b6(0x155)]));});}}),await _0x525459[_0x5a69ce(0x17e)]();const _0x479a7c=await warehouse[_0x5a69ce(0x16c)]({'name':_0x564c78['to_warehouse'],'room':_0x564c78[_0x5a69ce(0xc9)]});_0x564c78[_0x5a69ce(0xbd)]['forEach'](_0xcbc5f4=>{var _0x4ec56c=_0x5a69ce;if(_0xcbc5f4['to_quantity']>0x0){const _0x1b5347=_0x479a7c[_0x4ec56c(0xe6)][_0x4ec56c(0xec)](_0x3bc060=>{var _0x5a0aee=_0x4ec56c;_0x3bc060[_0x5a0aee(0x113)]==_0xcbc5f4['product_name']&&_0x3bc060[_0x5a0aee(0x130)]==_0xcbc5f4[_0x5a0aee(0xbe)]&&(_0x3bc060['product_stock']=parseInt(_0x3bc060['product_stock'])-parseInt(_0xcbc5f4[_0x5a0aee(0x155)]));});}}),await _0x479a7c[_0x5a69ce(0x17e)](),_0x564c78[_0x5a69ce(0xee)]=_0x4cbca4,_0x564c78[_0x5a69ce(0xff)]=_0x5f434e,_0x564c78[_0x5a69ce(0x15f)]=_0x537da2,_0x564c78['product']=_0xcd39b6,_0x564c78['note']=_0x4aa7c8,_0x564c78[_0x5a69ce(0x12e)]=_0x5aa94b;const _0x18db85=await _0x564c78[_0x5a69ce(0x17e)](),_0x5b23f4=await warehouse['findOne']({'name':_0x5f434e,'room':_0x1b70f0});_0x18db85['product'][_0x5a69ce(0xe5)](_0x5c6704=>{var _0x57896d=_0x5a69ce;if(_0x5c6704[_0x57896d(0x155)]>0x0){const _0x4185b8=_0x5b23f4[_0x57896d(0xe6)][_0x57896d(0xec)](_0x3a1729=>{var _0x56b79e=_0x57896d;_0x3a1729['product_name']==_0x5c6704[_0x56b79e(0x113)]&&_0x3a1729[_0x56b79e(0x130)]==_0x5c6704['from_bay']&&(_0x3a1729[_0x56b79e(0x154)]=parseInt(_0x3a1729[_0x56b79e(0x154)])-parseInt(_0x5c6704[_0x56b79e(0x155)]));});}}),await _0x5b23f4[_0x5a69ce(0x17e)]();const _0x28e80e=await warehouse[_0x5a69ce(0x16c)]({'name':_0x537da2,'room':_0x3bb86e});_0x18db85[_0x5a69ce(0xbd)][_0x5a69ce(0xe5)](_0x10cde9=>{var _0x57e698=_0x5a69ce;if(_0x10cde9[_0x57e698(0x155)]>0x0){var _0x2e5d78=0x0;const _0x376b77=_0x28e80e[_0x57e698(0xe6)]['map'](_0x52e17d=>{var _0x584486=_0x57e698;_0x52e17d[_0x584486(0x113)]==_0x10cde9['product_name']&&_0x52e17d[_0x584486(0x130)]==_0x10cde9['to_bay']&&(_0x52e17d[_0x584486(0x154)]=parseInt(_0x52e17d[_0x584486(0x154)])+parseInt(_0x10cde9[_0x584486(0x155)]),_0x2e5d78++);});_0x2e5d78=='0'&&(_0x28e80e[_0x57e698(0xe6)]=_0x28e80e[_0x57e698(0xe6)][_0x57e698(0x125)]({'product_name':_0x10cde9[_0x57e698(0x113)],'product_stock':_0x10cde9[_0x57e698(0x155)],'bay':_0x10cde9['to_bay'],'product_code':_0x10cde9['product_code'],'primary_code':_0x10cde9[_0x57e698(0x152)],'secondary_code':_0x10cde9[_0x57e698(0x110)],'maxProducts':_0x10cde9[_0x57e698(0xe1)]}));}}),await _0x28e80e[_0x5a69ce(0x17e)](),_0x1e8b80[_0x5a69ce(0xf6)](_0x5a69ce(0x16f),_0x5a69ce(0x166)),_0x39b6ec[_0x5a69ce(0x11b)](_0x5a69ce(0xc6));}catch(_0xaca37d){console[_0x5a69ce(0x13a)](_0xaca37d);}}),router[a0_0x33775f(0x164)](a0_0x33775f(0x17c),async(_0x266655,_0x1a83d0)=>{var _0x40d57a=a0_0x33775f;const {FromWareHouse:_0x137a41,FromRoom:_0x3c974a,ToWarehouse:_0x1fa76c,ToRoom:_0x525d83,primary_code:_0x2e9bb,Roomslist:_0x62f723}=_0x266655[_0x40d57a(0xbb)],_0x51f9b2=_0x62f723[_0x40d57a(0x141)](','),_0x562d46=[];async function _0x54c64f(_0x165ad4){var _0x221fe7=_0x40d57a;const _0x318a9f=await warehouse[_0x221fe7(0x142)]([{'$match':{'name':_0x137a41,'room':_0x165ad4}},{'$unwind':_0x221fe7(0x111)},{'$match':{'product_details.primary_code':_0x2e9bb}},{'$group':{'_id':_0x221fe7(0x12b),'name':{'$first':_0x221fe7(0x180)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x221fe7(0xd2)},'secondary_code':{'$first':_0x221fe7(0xd4)},'product_code':{'$first':_0x221fe7(0xc7)},'bay':{'$first':_0x221fe7(0xbc)},'level':{'$first':_0x221fe7(0xe9)},'type':{'$first':_0x221fe7(0x11c)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x221fe7(0x108)},'secondary_unit':{'$first':_0x221fe7(0xf8)},'storage':{'$first':_0x221fe7(0x14f)},'rack':{'$first':_0x221fe7(0xd5)},'expiry_date':{'$first':_0x221fe7(0x138)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x221fe7(0x153)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x221fe7(0xc5)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x221fe7(0x13c)}}}]),_0x43ea1c=await warehouse[_0x221fe7(0x142)]([{'$match':{'name':_0x137a41,'room':_0x165ad4}},{'$unwind':_0x221fe7(0x111)},{'$match':{'product_details.secondary_code':_0x2e9bb}},{'$group':{'_id':_0x221fe7(0x12b),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x221fe7(0xd0)},'primary_code':{'$first':_0x221fe7(0xd2)},'secondary_code':{'$first':_0x221fe7(0xd4)},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x221fe7(0xbc)},'level':{'$first':'$product_details.level'},'type':{'$first':_0x221fe7(0x11c)},'pallet':{'$first':_0x221fe7(0x10a)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x221fe7(0xf8)},'storage':{'$first':_0x221fe7(0x14f)},'rack':{'$first':_0x221fe7(0xd5)},'expiry_date':{'$first':_0x221fe7(0x138)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x221fe7(0x153)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x318a9f[_0x221fe7(0x15d)]>0x0)_0x562d46['push'](_0x318a9f);else _0x43ea1c[_0x221fe7(0x15d)]>0x0&&_0x562d46[_0x221fe7(0xde)](_0x43ea1c);}const _0x14bc88=_0x51f9b2[_0x40d57a(0xec)](_0x581349=>_0x54c64f(_0x581349));await Promise[_0x40d57a(0x127)](_0x14bc88),_0x1a83d0[_0x40d57a(0x107)](_0x562d46);}),router[a0_0x33775f(0x164)]('/CheckingWarehouse',async(_0x1baa8a,_0x3f3760)=>{var _0x21250a=a0_0x33775f;const {productCode:_0x41c8d2,bay:_0x5bfaef,warehouses:_0x220935,room:_0x343da6}=_0x1baa8a['body'];console[_0x21250a(0x13a)](_0x1baa8a['body']);try{const _0x30c7b4=await warehouse[_0x21250a(0x142)]([{'$match':{'name':_0x220935,'room':_0x343da6}},{'$unwind':_0x21250a(0x111)},{'$match':{'product_details.bay':parseInt(_0x5bfaef)}},{'$group':{'_id':_0x21250a(0x12b),'name':{'$first':_0x21250a(0x180)},'product_stock':{'$first':_0x21250a(0xd0)},'bay':{'$first':_0x21250a(0xbc)},'maxProducts':{'$first':_0x21250a(0xc8)}}}]);_0x3f3760[_0x21250a(0x172)](0xc8)[_0x21250a(0x107)](_0x30c7b4);}catch(_0x24b90e){_0x3f3760['status'](0x194)[_0x21250a(0x107)]({'message':_0x24b90e['message']});}}),module[a0_0x33775f(0x106)]=router;