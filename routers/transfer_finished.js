var a0_0x3f5a48=a0_0x405b;function a0_0x5991(){var _0x265658=['to_floorlevel','email','$product_details.rack','length','5018RRcLwW','FROZEN\x20GOODS','Finished\x20Goods','prod_cat','find','batch_code','add_transfer_finished','$product_details.bin','French','../models/all_models','$product.from_room_name','6846LQindX','from_prod_qty','$product_details.primary_code','map','random','from_room','German','render','message','New_Qty_Converted','id_transaction','\x20<=>\x20','from_quantity','341721YVfFOK','/picking_list/PDF_transfer/','True','exports','concat','success','primary_code','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','secondary_unit','Rack\x202','$product_details.secondary_unit','max','from_room_name','$product_details.invoice','$product_details._id','<tr>','$product_details.batch_code','276XCPYwq','$name','1323LqZKrM','$_id','To_invoice','/transfer/view','product_details','filter','$product','json','redirect','to_prod_level','role','product_stock','$product_details.unit','findOne','MaxStocks_data2','transfer_finished','An\x20error\x20occurred.','secondary_code','$invoice','/transfer_finished/view','Portuguese\x20(BR)','to_room','from_prod_level2','date','user','to_quantity','primary_unit','</tr>','$product_details','maxProducts','flash','4165QNojUx','updateOne','params','/transfer_finished/preview/','undefined','catch','An\x20error\x20occurred\x20while\x20saving\x20data.','product_code','$product_details.product_stock','from_warehouse','to_level','forEach','$product_details.bay','English','Transfer\x20Finalize\x20Successfully','/preview/:id','errors','expiry_date','string','to_room_name','Portuguese','note','error','Spanish','Chinese','abs','/view/:id','\x20<>\x20','/barcode_scanner','all','maxPerUnit','body','</td>','product_code3','split','$product_details.type','$product_details.production_date','findById','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/view/add_transfer','$product_details.secondary_code','6346656fuHwuf','Arabic\x20(ae)','$product.to_room_name','Arabic','then','$to_warehouse','save','$product_details.storage','to_prod_qty','log','floor','Product\x20Transfer\x20successfully','warehouse','DRY\x20GOODS','nodemailer','getMonth','$product_details.product_code','from_invoice','invoice_init','location2location','MaxStocks_data','Hindi','/view/add_transfer_logs','production_date','match','$room','$product_details.maxPerUnit','bay','unit','English\x20(US)','$finalize','170hBbqRu','586650yJeMFS','push','status','padStart','1052OlCRWX','bin2bin','to_bay','$product_details.product_name','from_prod_level','prod_name','/CheckingWarehouse','$product_details.expiry_date','staff','toString','$product_details.level','Enabled','$product_details.floorlevel','to_warehouse','$product_details.maxProducts','product','/view/add_transfer_loc','choos_transfer_logs','/view/addlog','ToRoomAssigned','aggregate','from_level','finalize','/view','product_date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','edit_transfer_finished_view','5031257tReoLy','$from_warehouse','type_of_process','Ambient','logs','language','back','RoomAssigned','from_bay','_id','/view_logs','transfer_finished_logs','own','LOG-TRF-','/view/choose_logs','getFullYear','Rack\x201','$date','TRFF-','TRF-','get','product_name','post','getDate'];a0_0x5991=function(){return _0x265658;};return a0_0x5991();}function a0_0x405b(_0x38451e,_0x254d3b){var _0x599173=a0_0x5991();return a0_0x405b=function(_0x405b3f,_0x46451b){_0x405b3f=_0x405b3f-0x134;var _0x21093f=_0x599173[_0x405b3f];return _0x21093f;},a0_0x405b(_0x38451e,_0x254d3b);}(function(_0x301c4e,_0x21cf19){var _0x548e6f=a0_0x405b,_0x408e37=_0x301c4e();while(!![]){try{var _0x2f2958=parseInt(_0x548e6f(0x14d))/0x1+parseInt(_0x548e6f(0x188))/0x2*(-parseInt(_0x548e6f(0x1b1))/0x3)+parseInt(_0x548e6f(0x151))/0x4*(parseInt(_0x548e6f(0x1d2))/0x5)+parseInt(_0x548e6f(0x193))/0x6*(parseInt(_0x548e6f(0x1b3))/0x7)+parseInt(_0x548e6f(0x1fb))/0x8+-parseInt(_0x548e6f(0x1a0))/0x9*(parseInt(_0x548e6f(0x14c))/0xa)+-parseInt(_0x548e6f(0x16c))/0xb;if(_0x2f2958===_0x21cf19)break;else _0x408e37['push'](_0x408e37['shift']());}catch(_0x53d006){_0x408e37['push'](_0x408e37['shift']());}}}(a0_0x5991,0x756fe));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x3f5a48(0x191)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x3f5a48(0x13b));router[a0_0x3f5a48(0x180)](a0_0x3f5a48(0x168),auth,async(_0x1c4e72,_0x2b9110)=>{var _0x3e816a=a0_0x3f5a48;try{const {username:_0x4c3643,email:_0x1d8045,role:_0x5a6c05}=_0x1c4e72['user'],_0x2eb520=_0x1c4e72[_0x3e816a(0x1cb)],_0xd846c0=await profile[_0x3e816a(0x1c0)]({'email':_0x2eb520[_0x3e816a(0x185)]}),_0x3661d9=await master_shop[_0x3e816a(0x18c)]();let _0x1359f4;if(_0x2eb520[_0x3e816a(0x1bd)]=='staff'){const _0x45fc7e=await staff['findOne']({'email':_0x2eb520['email']});_0x1359f4=await transfers_finished[_0x3e816a(0x18c)]({'from_warehouse':_0x45fc7e['warehouse']});}else _0x1359f4=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x3e816a(0x178)}},{'$unwind':_0x3e816a(0x1b9)},{'$group':{'_id':_0x3e816a(0x1b4),'invoice':{'$first':'$invoice'},'date':{'$first':_0x3e816a(0x17d)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x3e816a(0x192)},'to_room_name':{'$addToSet':_0x3e816a(0x1fd)},'finalize':{'$first':_0x3e816a(0x14b)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3661d9[0x0][_0x3e816a(0x171)]==_0x3e816a(0x14a))var _0x25a7e6=users[_0x3e816a(0x1df)];else{if(_0x3661d9[0x0]['language']==_0x3e816a(0x142))var _0x25a7e6=users[_0x3e816a(0x142)];else{if(_0x3661d9[0x0][_0x3e816a(0x171)]=='German')var _0x25a7e6=users['German'];else{if(_0x3661d9[0x0]['language']=='Spanish')var _0x25a7e6=users[_0x3e816a(0x1e9)];else{if(_0x3661d9[0x0][_0x3e816a(0x171)]==_0x3e816a(0x190))var _0x25a7e6=users['French'];else{if(_0x3661d9[0x0][_0x3e816a(0x171)]==_0x3e816a(0x1c7))var _0x25a7e6=users[_0x3e816a(0x1e6)];else{if(_0x3661d9[0x0][_0x3e816a(0x171)]=='Chinese')var _0x25a7e6=users[_0x3e816a(0x1ea)];else{if(_0x3661d9[0x0]['language']==_0x3e816a(0x1fc))var _0x25a7e6=users[_0x3e816a(0x1fe)];}}}}}}}_0x2b9110[_0x3e816a(0x19a)](_0x3e816a(0x1c2),{'success':_0x1c4e72[_0x3e816a(0x1d1)](_0x3e816a(0x1a5)),'errors':_0x1c4e72[_0x3e816a(0x1d1)](_0x3e816a(0x1e2)),'role':_0x2eb520,'profile':_0xd846c0,'master_shop':_0x3661d9,'transfer':_0x1359f4,'language':_0x25a7e6});}catch(_0x5a8ab0){console[_0x3e816a(0x136)](_0x5a8ab0);}}),router['get'](a0_0x3f5a48(0x176),auth,async(_0x302b60,_0x56ad85)=>{var _0x58db17=a0_0x3f5a48;try{const {username:_0x5a145f,email:_0x33215b,role:_0x1c8374}=_0x302b60['user'],_0x11cc8d=_0x302b60[_0x58db17(0x1cb)],_0x303c77=await profile['findOne']({'email':_0x11cc8d['email']}),_0x2113eb=await master_shop['find']();let _0xdacbb7;if(_0x11cc8d[_0x58db17(0x1bd)]==_0x58db17(0x159)){const _0xcc7b70=await staff[_0x58db17(0x1c0)]({'email':_0x11cc8d['email']});_0xdacbb7=await transfers_finished['find']({'from_warehouse':_0xcc7b70['warehouse']});}else _0xdacbb7=await transfers_finished[_0x58db17(0x165)]([{'$match':{'type_of_transaction':_0x58db17(0x170)}},{'$unwind':'$product'},{'$group':{'_id':_0x58db17(0x1b4),'invoice':{'$first':_0x58db17(0x1c5)},'date':{'$first':_0x58db17(0x17d)},'from_warehouse':{'$first':_0x58db17(0x16d)},'to_warehouse':{'$first':_0x58db17(0x200)},'from_room_name':{'$addToSet':_0x58db17(0x192)},'to_room_name':{'$addToSet':_0x58db17(0x1fd)},'finalize':{'$first':_0x58db17(0x14b)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2113eb[0x0][_0x58db17(0x171)]=='English\x20(US)')var _0x1b04da=users['English'];else{if(_0x2113eb[0x0]['language']==_0x58db17(0x142))var _0x1b04da=users[_0x58db17(0x142)];else{if(_0x2113eb[0x0][_0x58db17(0x171)]=='German')var _0x1b04da=users[_0x58db17(0x199)];else{if(_0x2113eb[0x0][_0x58db17(0x171)]==_0x58db17(0x1e9))var _0x1b04da=users[_0x58db17(0x1e9)];else{if(_0x2113eb[0x0][_0x58db17(0x171)]=='French')var _0x1b04da=users['French'];else{if(_0x2113eb[0x0][_0x58db17(0x171)]==_0x58db17(0x1c7))var _0x1b04da=users[_0x58db17(0x1e6)];else{if(_0x2113eb[0x0][_0x58db17(0x171)]=='Chinese')var _0x1b04da=users['Chinese'];else{if(_0x2113eb[0x0][_0x58db17(0x171)]=='Arabic\x20(ae)')var _0x1b04da=users[_0x58db17(0x1fe)];}}}}}}}_0x56ad85['render'](_0x58db17(0x177),{'success':_0x302b60[_0x58db17(0x1d1)](_0x58db17(0x1a5)),'errors':_0x302b60['flash'](_0x58db17(0x1e2)),'role':_0x11cc8d,'profile':_0x303c77,'master_shop':_0x2113eb,'transfer':_0xdacbb7,'language':_0x1b04da});}catch(_0x3693be){console[_0x58db17(0x136)](_0x3693be);}});async function getRandom8DigitNumber(){var _0x48b496=a0_0x3f5a48;const _0x97770=0x989680,_0x41ae3b=0x5f5e0ff,_0x58b8b3=Math[_0x48b496(0x137)](Math[_0x48b496(0x197)]()*(_0x41ae3b-_0x97770+0x1))+_0x97770;var _0x33575c;const _0x559542=await transfers_finished[_0x48b496(0x1c0)]({'invoice':'TRFF-'+_0x58b8b3});return _0x559542&&_0x559542[_0x48b496(0x187)]>0x0?_0x33575c=_0x48b496(0x17e)+_0x58b8b3:_0x33575c=_0x48b496(0x17e)+_0x58b8b3,_0x33575c;}router[a0_0x3f5a48(0x180)](a0_0x3f5a48(0x1f9),auth,async(_0x1f569f,_0x525a41)=>{var _0x349586=a0_0x3f5a48;try{const {username:_0x35fd4f,email:_0xbe217f,role:_0x2fa468}=_0x1f569f[_0x349586(0x1cb)],_0x419b1f=_0x1f569f[_0x349586(0x1cb)],_0x2eb735=await profile[_0x349586(0x1c0)]({'email':_0x419b1f[_0x349586(0x185)]}),_0x4ba871=await master_shop['find']();let _0x43156b;if(_0x419b1f[_0x349586(0x1bd)]==_0x349586(0x159)){const _0x5ea6ed=await staff[_0x349586(0x1c0)]({'email':_0x419b1f[_0x349586(0x185)]});_0x43156b=await warehouse[_0x349586(0x165)]([{'$match':{'status':_0x349586(0x15c),'name':_0x5ea6ed['warehouse']}},{'$group':{'_id':_0x349586(0x1b2),'name':{'$first':'$name'}}}]);}else _0x43156b=await warehouse[_0x349586(0x165)]([{'$match':{'status':_0x349586(0x15c)}},{'$group':{'_id':_0x349586(0x1b2),'name':{'$first':_0x349586(0x1b2)}}}]);const _0x516050=await transfers_finished[_0x349586(0x18c)]({}),_0x525b06=_0x516050[_0x349586(0x187)]+0x1,_0x2d170c=_0x349586(0x17e)+_0x525b06[_0x349586(0x15a)]()['padStart'](0x5,'0');if(_0x4ba871[0x0]['language']==_0x349586(0x14a))var _0x438f79=users[_0x349586(0x1df)];else{if(_0x4ba871[0x0]['language']==_0x349586(0x142))var _0x438f79=users['Hindi'];else{if(_0x4ba871[0x0]['language']=='German')var _0x438f79=users[_0x349586(0x199)];else{if(_0x4ba871[0x0][_0x349586(0x171)]==_0x349586(0x1e9))var _0x438f79=users[_0x349586(0x1e9)];else{if(_0x4ba871[0x0][_0x349586(0x171)]=='French')var _0x438f79=users[_0x349586(0x190)];else{if(_0x4ba871[0x0][_0x349586(0x171)]=='Portuguese\x20(BR)')var _0x438f79=users['Portuguese'];else{if(_0x4ba871[0x0][_0x349586(0x171)]==_0x349586(0x1ea))var _0x438f79=users[_0x349586(0x1ea)];else{if(_0x4ba871[0x0]['language']=='Arabic\x20(ae)')var _0x438f79=users['Arabic'];}}}}}}}const _0x303fca=getRandom8DigitNumber();_0x303fca[_0x349586(0x1ff)](_0x526671=>{var _0x139799=_0x349586;_0x525a41[_0x139799(0x19a)](_0x139799(0x18e),{'success':_0x1f569f['flash'](_0x139799(0x1a5)),'errors':_0x1f569f['flash'](_0x139799(0x1e2)),'role':_0x419b1f,'profile':_0x2eb735,'master_shop':_0x4ba871,'warehouse':_0x43156b,'language':_0x438f79,'invoice':_0x526671});})[_0x349586(0x1d7)](_0x1af7a1=>{var _0x53d14e=_0x349586;_0x1f569f[_0x53d14e(0x1d1)](_0x53d14e(0x1e2),_0x53d14e(0x1f8)),_0x525a41[_0x53d14e(0x1bb)](_0x53d14e(0x1b6));});}catch(_0x49a23f){console[_0x349586(0x136)](_0x49a23f);}}),router[a0_0x3f5a48(0x180)]('/view/choose',auth,async(_0x4c0b30,_0x755c48)=>{var _0x2124c6=a0_0x3f5a48;try{const {username:_0x122e82,email:_0x515593,role:_0x1d46dd}=_0x4c0b30[_0x2124c6(0x1cb)],_0x24fe8c=_0x4c0b30[_0x2124c6(0x1cb)],_0x2a38eb=await profile[_0x2124c6(0x1c0)]({'email':_0x24fe8c['email']}),_0x171938=await master_shop[_0x2124c6(0x18c)]();let _0x1f7d9c;if(_0x24fe8c[_0x2124c6(0x1bd)]=='staff'){const _0x25b7f1=await staff['findOne']({'email':_0x24fe8c[_0x2124c6(0x185)]});_0x1f7d9c=await warehouse[_0x2124c6(0x165)]([{'$match':{'status':'Enabled','name':_0x25b7f1['warehouse']}},{'$group':{'_id':_0x2124c6(0x1b2),'name':{'$first':_0x2124c6(0x1b2)}}}]);}else _0x1f7d9c=await warehouse[_0x2124c6(0x165)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x3a1425=await transfers_finished[_0x2124c6(0x18c)]({}),_0x2c1530=_0x3a1425[_0x2124c6(0x187)]+0x1,_0x44ca7c=_0x2124c6(0x17e)+_0x2c1530['toString']()[_0x2124c6(0x150)](0x5,'0');if(_0x171938[0x0][_0x2124c6(0x171)]==_0x2124c6(0x14a))var _0x1f52b1=users[_0x2124c6(0x1df)];else{if(_0x171938[0x0][_0x2124c6(0x171)]==_0x2124c6(0x142))var _0x1f52b1=users[_0x2124c6(0x142)];else{if(_0x171938[0x0][_0x2124c6(0x171)]==_0x2124c6(0x199))var _0x1f52b1=users[_0x2124c6(0x199)];else{if(_0x171938[0x0][_0x2124c6(0x171)]==_0x2124c6(0x1e9))var _0x1f52b1=users[_0x2124c6(0x1e9)];else{if(_0x171938[0x0]['language']=='French')var _0x1f52b1=users[_0x2124c6(0x190)];else{if(_0x171938[0x0]['language']=='Portuguese\x20(BR)')var _0x1f52b1=users[_0x2124c6(0x1e6)];else{if(_0x171938[0x0][_0x2124c6(0x171)]==_0x2124c6(0x1ea))var _0x1f52b1=users[_0x2124c6(0x1ea)];else{if(_0x171938[0x0]['language']==_0x2124c6(0x1fc))var _0x1f52b1=users['Arabic'];}}}}}}}const _0x2f9a25=getRandom8DigitNumber();_0x2f9a25[_0x2124c6(0x1ff)](_0x2ae8d4=>{var _0x19f1c7=_0x2124c6;_0x755c48[_0x19f1c7(0x19a)]('choos_transfer',{'success':_0x4c0b30[_0x19f1c7(0x1d1)]('success'),'errors':_0x4c0b30[_0x19f1c7(0x1d1)]('errors'),'role':_0x24fe8c,'profile':_0x2a38eb,'master_shop':_0x171938,'warehouse':_0x1f7d9c,'language':_0x1f52b1,'invoice':_0x2ae8d4});})['catch'](_0x2a5998=>{var _0x5e602c=_0x2124c6;_0x4c0b30[_0x5e602c(0x1d1)](_0x5e602c(0x1e2),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x755c48[_0x5e602c(0x1bb)](_0x5e602c(0x1b6));});}catch(_0x401696){console['log'](_0x401696);}}),router[a0_0x3f5a48(0x180)](a0_0x3f5a48(0x17a),auth,async(_0x14f833,_0x1256ce)=>{var _0x260c00=a0_0x3f5a48;try{const {username:_0x4ff5c7,email:_0x2b024f,role:_0x356191}=_0x14f833[_0x260c00(0x1cb)],_0x484f03=_0x14f833[_0x260c00(0x1cb)],_0x12ed3b=await profile[_0x260c00(0x1c0)]({'email':_0x484f03['email']}),_0x2f01f8=await master_shop['find']();let _0x4782b7;if(_0x484f03[_0x260c00(0x1bd)]==_0x260c00(0x159)){const _0x2047e8=await staff['findOne']({'email':_0x484f03[_0x260c00(0x185)]});_0x4782b7=await warehouse[_0x260c00(0x165)]([{'$match':{'status':_0x260c00(0x15c),'name':_0x2047e8[_0x260c00(0x139)]}},{'$group':{'_id':_0x260c00(0x1b2),'name':{'$first':_0x260c00(0x1b2)}}}]);}else _0x4782b7=await warehouse[_0x260c00(0x165)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x260c00(0x1b2),'name':{'$first':_0x260c00(0x1b2)}}}]);const _0x2ea00d=await transfers_finished['find']({}),_0x120a53=_0x2ea00d[_0x260c00(0x187)]+0x1,_0x10010e=_0x260c00(0x17e)+_0x120a53['toString']()[_0x260c00(0x150)](0x5,'0');if(_0x2f01f8[0x0][_0x260c00(0x171)]==_0x260c00(0x14a))var _0x142aeb=users[_0x260c00(0x1df)];else{if(_0x2f01f8[0x0][_0x260c00(0x171)]=='Hindi')var _0x142aeb=users[_0x260c00(0x142)];else{if(_0x2f01f8[0x0][_0x260c00(0x171)]==_0x260c00(0x199))var _0x142aeb=users['German'];else{if(_0x2f01f8[0x0][_0x260c00(0x171)]==_0x260c00(0x1e9))var _0x142aeb=users['Spanish'];else{if(_0x2f01f8[0x0][_0x260c00(0x171)]==_0x260c00(0x190))var _0x142aeb=users[_0x260c00(0x190)];else{if(_0x2f01f8[0x0][_0x260c00(0x171)]==_0x260c00(0x1c7))var _0x142aeb=users[_0x260c00(0x1e6)];else{if(_0x2f01f8[0x0]['language']==_0x260c00(0x1ea))var _0x142aeb=users[_0x260c00(0x1ea)];else{if(_0x2f01f8[0x0][_0x260c00(0x171)]==_0x260c00(0x1fc))var _0x142aeb=users[_0x260c00(0x1fe)];}}}}}}}const _0x1e6b27=getRandom8DigitNumber();_0x1e6b27[_0x260c00(0x1ff)](_0x3f0b94=>{var _0x4e3766=_0x260c00;_0x1256ce[_0x4e3766(0x19a)](_0x4e3766(0x162),{'success':_0x14f833[_0x4e3766(0x1d1)]('success'),'errors':_0x14f833[_0x4e3766(0x1d1)](_0x4e3766(0x1e2)),'role':_0x484f03,'profile':_0x12ed3b,'master_shop':_0x2f01f8,'warehouse':_0x4782b7,'language':_0x142aeb,'invoice':_0x3f0b94});})[_0x260c00(0x1d7)](_0x52c4d3=>{var _0x391816=_0x260c00;_0x14f833[_0x391816(0x1d1)](_0x391816(0x1e2),_0x391816(0x1f8)),_0x1256ce[_0x391816(0x1bb)](_0x391816(0x1b6));});}catch(_0x3aa00b){console[_0x260c00(0x136)](_0x3aa00b);}}),router['post'](a0_0x3f5a48(0x143),auth,async(_0x19f16d,_0x8cb530)=>{var _0xb35a60=a0_0x3f5a48;try{const {date:_0x468709,from_warehouse:_0x4c61e0,FromRoom_name:_0x26c56e,to_warehouse:_0x386a31,ToRoom_name:_0x4acf67,prod_name:_0x11331c,from_prod_qty:_0x116ea7,from_prod_level:_0x1b77c2,from_prod_isle:_0x20c026,from_prod_pallet:_0x163596,to_prod_qty:_0x114109,to_prod_level:_0x440c6e,to_prod_isle:_0x4faba4,to_prod_pallet:_0x331790,primary_code:_0x58d7ef,secondary_code:_0x4f7dea,product_code3:_0x391c57,note:_0x2bf5b7,MaxStocks_data2:_0x1f5778,invoice:_0x4992bc,expiry_date:_0x13b171,PO_number:_0x1e8902,ReqBy:_0x23fd56,dateofreq:_0x58597b,typeservicesData:_0xc92208,destination:_0x3dc06b,deliverydate:_0x4800b2,driver:_0x1c7e17,plate:_0x4898d4,van:_0x22bc56,DRSI:_0xd17c83,typevehicle:_0x514d1d,TSU:_0x19b1e9,TFU:_0x23596c}=_0x19f16d['body'];if(typeof _0x11331c==_0xb35a60(0x1e4))var _0x14c958=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x156)]],_0x4bf857=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x194)]],_0x3ebd05=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1c9)]],_0x578c8d=[_0x19f16d[_0xb35a60(0x1f1)]['New_Qty_Converted']],_0x2bf53b=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1bc)]],_0x41c313=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1a6)]],_0xf9e071=[_0x19f16d[_0xb35a60(0x1f1)]['secondary_code']],_0x475422=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1f3)]],_0x371859=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1c1)]],_0x42b84b=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1cd)]],_0x45e4d9=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1a8)]],_0x551cea=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x18d)]],_0x1c78fb=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1e3)]],_0x15127c=[_0x19f16d['body'][_0xb35a60(0x169)]],_0x4fe0cd=[_0x19f16d[_0xb35a60(0x1f1)]['MaxStocks_data']],_0x53ced5=[_0x19f16d['body'][_0xb35a60(0x1f0)]],_0x3fbad5=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x18b)]],_0x2604e8=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x173)]],_0x2d80b1=[_0x19f16d[_0xb35a60(0x1f1)]['ToRoomAssigned']],_0x1de317=[_0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x13e)]],_0x26da63=[_0x19f16d['body'][_0xb35a60(0x19d)]];else var _0x14c958=[..._0x19f16d['body'][_0xb35a60(0x156)]],_0x4bf857=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x194)]],_0x3ebd05=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1c9)]],_0x578c8d=[..._0x19f16d[_0xb35a60(0x1f1)]['New_Qty_Converted']],_0x2bf53b=[..._0x19f16d[_0xb35a60(0x1f1)]['to_prod_level']],_0x41c313=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1a6)]],_0xf9e071=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1c4)]],_0x475422=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1f3)]],_0x371859=[..._0x19f16d['body'][_0xb35a60(0x1c1)]],_0x42b84b=[..._0x19f16d[_0xb35a60(0x1f1)]['primary_unit']],_0x45e4d9=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1a8)]],_0x551cea=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x18d)]],_0x1c78fb=[..._0x19f16d['body'][_0xb35a60(0x1e3)]],_0x15127c=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x169)]],_0x4fe0cd=[..._0x19f16d['body'][_0xb35a60(0x141)]],_0x53ced5=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x1f0)]],_0x3fbad5=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x18b)]],_0x2604e8=[..._0x19f16d['body'][_0xb35a60(0x173)]],_0x2d80b1=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x164)]],_0x1de317=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x13e)]],_0x26da63=[..._0x19f16d[_0xb35a60(0x1f1)][_0xb35a60(0x19d)]];const _0x10fec5=_0x14c958[_0xb35a60(0x196)](_0x2bbeb6=>{return _0x2bbeb6={'product_name':_0x2bbeb6};});_0x4bf857[_0xb35a60(0x1dd)]((_0x401bc4,_0x4cf877)=>{var _0x385deb=_0xb35a60;_0x10fec5[_0x4cf877][_0x385deb(0x19f)]=_0x401bc4;}),_0x3ebd05[_0xb35a60(0x1dd)]((_0xfd6aaa,_0x41c222)=>{var _0x434f5f=_0xb35a60,_0x3f1976=_0xfd6aaa[_0x434f5f(0x145)](/[A-Za-z]+/)[0x0],_0x3cb437=parseInt(_0xfd6aaa['match'](/\d+/)[0x0]);_0x10fec5[_0x41c222][_0x434f5f(0x174)]=_0x3cb437,_0x10fec5[_0x41c222][_0x434f5f(0x166)]=_0x3f1976;}),_0x26da63['forEach']((_0x180690,_0x3dcd34)=>{var _0xc6ed4d=_0xb35a60;_0x10fec5[_0x3dcd34][_0xc6ed4d(0x19d)]=_0x180690;}),_0x1de317[_0xb35a60(0x1dd)]((_0x54e91c,_0x4a2e47)=>{_0x10fec5[_0x4a2e47]['from_invoice']=_0x54e91c;}),_0x578c8d[_0xb35a60(0x1dd)]((_0x2df6b7,_0x2747d1)=>{var _0x3cf334=_0xb35a60;_0x10fec5[_0x2747d1][_0x3cf334(0x1cc)]=_0x2df6b7;}),_0x2bf53b['forEach']((_0x20123a,_0x2f5db7)=>{var _0x27f61f=_0xb35a60,_0x145b00=_0x20123a['match'](/[A-Za-z]+/)[0x0],_0x40422f=parseInt(_0x20123a[_0x27f61f(0x145)](/\d+/)[0x0]);_0x10fec5[_0x2f5db7][_0x27f61f(0x1dc)]=_0x145b00,_0x10fec5[_0x2f5db7][_0x27f61f(0x153)]=_0x40422f;}),_0x41c313[_0xb35a60(0x1dd)]((_0x22cf26,_0x44f1c1)=>{var _0x331d74=_0xb35a60;_0x10fec5[_0x44f1c1][_0x331d74(0x1a6)]=_0x22cf26;}),_0xf9e071[_0xb35a60(0x1dd)]((_0x4c527b,_0x19de01)=>{_0x10fec5[_0x19de01]['secondary_code']=_0x4c527b;}),_0x475422[_0xb35a60(0x1dd)]((_0x10a773,_0x3cb0cc)=>{var _0x194324=_0xb35a60;_0x10fec5[_0x3cb0cc][_0x194324(0x1d9)]=_0x10a773;}),_0x371859[_0xb35a60(0x1dd)]((_0x29d688,_0x1884b7)=>{var _0x4162a0=_0xb35a60;_0x10fec5[_0x1884b7][_0x4162a0(0x1d0)]=_0x29d688;}),_0x42b84b[_0xb35a60(0x1dd)]((_0x6b8de,_0x12c527)=>{var _0x445d3a=_0xb35a60;_0x10fec5[_0x12c527][_0x445d3a(0x149)]=_0x6b8de;}),_0x45e4d9['forEach']((_0x4d89e1,_0x45bcf5)=>{_0x10fec5[_0x45bcf5]['secondary_unit']=_0x4d89e1;}),_0x551cea['forEach']((_0x54ac8f,_0x5b96ef)=>{var _0x59c303=_0xb35a60;_0x10fec5[_0x5b96ef][_0x59c303(0x18d)]=_0x54ac8f;}),_0x1c78fb[_0xb35a60(0x1dd)]((_0x2419fd,_0x2b705b)=>{var _0x5187c3=_0xb35a60;_0x10fec5[_0x2b705b][_0x5187c3(0x1e3)]=_0x2419fd;}),_0x15127c[_0xb35a60(0x1dd)]((_0x212658,_0x15f67c)=>{var _0x5b86ea=_0xb35a60;_0x10fec5[_0x15f67c][_0x5b86ea(0x144)]=_0x212658;}),_0x4fe0cd[_0xb35a60(0x1dd)]((_0x360c38,_0x31e0b8)=>{var _0x1b8b70=_0xb35a60;_0x10fec5[_0x31e0b8][_0x1b8b70(0x1d0)]=_0x360c38;}),_0x53ced5[_0xb35a60(0x1dd)]((_0xcc51cd,_0x4e5a8b)=>{_0x10fec5[_0x4e5a8b]['maxPerUnit']=_0xcc51cd;}),_0x3fbad5[_0xb35a60(0x1dd)]((_0x10a316,_0x487056)=>{var _0x293677=_0xb35a60;_0x10fec5[_0x487056][_0x293677(0x18b)]=_0x10a316;}),_0x2604e8[_0xb35a60(0x1dd)]((_0x5d45a8,_0x230ef8)=>{var _0x42ba6d=_0xb35a60;_0x10fec5[_0x230ef8][_0x42ba6d(0x1ac)]=_0x5d45a8;}),_0x2d80b1['forEach']((_0x161625,_0x47f416)=>{var _0x34fc83=_0xb35a60;_0x10fec5[_0x47f416][_0x34fc83(0x1e5)]=_0x161625;});const _0x3aa9e3=_0x10fec5[_0xb35a60(0x1b8)](_0xce183d=>_0xce183d[_0xb35a60(0x1cc)]!=='0'&&_0xce183d[_0xb35a60(0x1cc)]!==''||_0xce183d[_0xb35a60(0x184)]!=='0'&&_0xce183d[_0xb35a60(0x184)]!=='');var _0x473e33=0x0;_0x3aa9e3[_0xb35a60(0x1dd)](_0x5e5309=>{var _0x46ddda=_0xb35a60;parseInt(_0x5e5309['from_quantity'])<parseInt(_0x5e5309[_0x46ddda(0x1cc)])&&_0x473e33++;});if(_0x473e33!=0x0)return _0x19f16d[_0xb35a60(0x1d1)](_0xb35a60(0x1e2),_0xb35a60(0x1a7)),_0x8cb530[_0xb35a60(0x1bb)]('back');const _0x1e3db3=new transfers_logs();await _0x1e3db3[_0xb35a60(0x201)]();for(let _0x22f8c7=0x0;_0x22f8c7<=_0x2d80b1[_0xb35a60(0x187)]-0x1;_0x22f8c7++){_0x10fec5[_0x22f8c7][_0xb35a60(0x1b5)]='LOG-TRF-'+_0x1e3db3[_0xb35a60(0x13f)][_0xb35a60(0x15a)]()[_0xb35a60(0x150)](0x8,'0');}const _0xe959fb=new transfers_finished({'date':_0x468709,'from_warehouse':_0x4c61e0,'to_warehouse':_0x4c61e0,'product':_0x3aa9e3,'note':_0x2bf5b7,'invoice':_0xb35a60(0x179)+_0x1e3db3[_0xb35a60(0x13f)]['toString']()[_0xb35a60(0x150)](0x8,'0'),'type_of_process':_0xb35a60(0x152),'type_of_transaction':_0xb35a60(0x170),'PO_number':_0x1e8902,'RequestedBy':_0x23fd56,'DateofRequest':_0x58597b,'typeservices':_0xc92208,'destination':_0x3dc06b,'deliverydate':_0x4800b2,'driver':_0x1c7e17,'plate':_0x4898d4,'van':_0x22bc56,'DRSI':_0xd17c83,'typevehicle':_0x514d1d,'TSU':_0x19b1e9,'TFU':_0x23596c}),_0x19554b=await _0xe959fb['save']();_0x19f16d[_0xb35a60(0x1d1)](_0xb35a60(0x1a5),_0xb35a60(0x138)),_0x8cb530[_0xb35a60(0x1bb)](_0xb35a60(0x1d5)+_0x19554b[_0xb35a60(0x175)]);}catch(_0x2f2627){console['log'](_0x2f2627),_0x8cb530[_0xb35a60(0x14f)](0xc8)['json']({'errorMessage':_0x2f2627[_0xb35a60(0x19b)]});}}),router['post'](a0_0x3f5a48(0x163),auth,async(_0x5b9b16,_0x1741e4)=>{var _0x5d82e=a0_0x3f5a48;try{const {date:_0x11beef,from_warehouse:_0x2ff710,FromRoom_name:_0x4c899b,to_warehouse:_0x423860,ToRoom_name:_0x27a847,prod_name:_0x362668,from_prod_qty:_0x30fd41,from_prod_level:_0x87b423,from_prod_isle:_0x3a2a68,from_prod_pallet:_0xed8aca,to_prod_qty:_0x5f1e03,to_prod_level:_0x3569c7,to_prod_isle:_0x5c21cf,to_prod_pallet:_0x463a61,primary_code:_0xee90f5,secondary_code:_0x414ccc,product_code3:_0x35b5f9,note:_0x3da4d5,MaxStocks_data2:_0x1c88d4,invoice:_0x4501e5,expiry_date:_0x44dc96,PO_number_loc:_0x4f4213,ReqBy_loc:_0x55d635,dateofreq_loc:_0x30a2f1,typeservices_loc_Data:_0x73b6e6,destination_loc:_0x5105b6,deliverydate_loc:_0x43f49c,driver_loc:_0x30060b,plate_loc:_0x37f35a,van_loc:_0x1bf682,DRSI_loc:_0x3b2fb5,typevehicle_loc:_0x1bbd05,TSU_loc:_0x4e2467,TFU_loc:_0x3fda39}=_0x5b9b16[_0x5d82e(0x1f1)];if(typeof _0x362668==_0x5d82e(0x1e4))var _0xf80780=[_0x5b9b16[_0x5d82e(0x1f1)]['prod_name']],_0x1b1bae=[_0x5b9b16['body']['from_prod_qty']],_0x1bb23d=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1c9)]],_0xe72882=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x19c)]],_0x4a5851=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1bc)]],_0x1c1d8f=[_0x5b9b16['body'][_0x5d82e(0x1a6)]],_0x244f0c=[_0x5b9b16[_0x5d82e(0x1f1)]['secondary_code']],_0x5f1d37=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1f3)]],_0x2ed148=[_0x5b9b16['body']['MaxStocks_data2']],_0x2deca5=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1cd)]],_0x1f5ced=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1a8)]],_0x85eba6=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x18d)]],_0x23b351=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1e3)]],_0x1e6c3f=[_0x5b9b16[_0x5d82e(0x1f1)]['product_date']],_0x222088=[_0x5b9b16['body'][_0x5d82e(0x141)]],_0x18ceed=[_0x5b9b16[_0x5d82e(0x1f1)]['maxPerUnit']],_0x48ab2c=[_0x5b9b16[_0x5d82e(0x1f1)]['prod_cat']],_0x10c1c8=[_0x5b9b16['body'][_0x5d82e(0x173)]],_0x3bda6a=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x164)]],_0x49b001=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x13e)]],_0x5c67b0=[_0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x19d)]];else var _0xf80780=[..._0x5b9b16[_0x5d82e(0x1f1)]['prod_name']],_0x1b1bae=[..._0x5b9b16['body'][_0x5d82e(0x194)]],_0x1bb23d=[..._0x5b9b16['body'][_0x5d82e(0x1c9)]],_0xe72882=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x19c)]],_0x4a5851=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1bc)]],_0x1c1d8f=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1a6)]],_0x244f0c=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1c4)]],_0x5f1d37=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1f3)]],_0x2ed148=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x1c1)]],_0x2deca5=[..._0x5b9b16[_0x5d82e(0x1f1)]['primary_unit']],_0x1f5ced=[..._0x5b9b16[_0x5d82e(0x1f1)]['secondary_unit']],_0x85eba6=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x18d)]],_0x23b351=[..._0x5b9b16[_0x5d82e(0x1f1)]['expiry_date']],_0x1e6c3f=[..._0x5b9b16[_0x5d82e(0x1f1)]['product_date']],_0x222088=[..._0x5b9b16['body']['MaxStocks_data']],_0x18ceed=[..._0x5b9b16['body'][_0x5d82e(0x1f0)]],_0x48ab2c=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x18b)]],_0x10c1c8=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x173)]],_0x3bda6a=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x164)]],_0x49b001=[..._0x5b9b16[_0x5d82e(0x1f1)]['from_invoice']],_0x5c67b0=[..._0x5b9b16[_0x5d82e(0x1f1)][_0x5d82e(0x19d)]];const _0x5a6250=_0xf80780[_0x5d82e(0x196)](_0x9821c8=>{return _0x9821c8={'product_name':_0x9821c8};});_0x1b1bae['forEach']((_0x497619,_0xc16d4f)=>{var _0xa38dfc=_0x5d82e;_0x5a6250[_0xc16d4f][_0xa38dfc(0x19f)]=_0x497619;}),_0x1bb23d[_0x5d82e(0x1dd)]((_0x554acf,_0x2f6a45)=>{var _0x1ef183=_0x5d82e,_0xcc17b6=_0x554acf[_0x1ef183(0x145)](/[A-Za-z]+/)[0x0],_0x30c89e=parseInt(_0x554acf[_0x1ef183(0x145)](/\d+/)[0x0]);_0x5a6250[_0x2f6a45][_0x1ef183(0x174)]=_0x30c89e,_0x5a6250[_0x2f6a45][_0x1ef183(0x166)]=_0xcc17b6;}),_0x5c67b0[_0x5d82e(0x1dd)]((_0x3f2599,_0x581dca)=>{_0x5a6250[_0x581dca]['id_transaction']=_0x3f2599;}),_0x49b001['forEach']((_0x24eab8,_0x22d824)=>{var _0x4b04fa=_0x5d82e;_0x5a6250[_0x22d824][_0x4b04fa(0x13e)]=_0x24eab8;}),_0xe72882[_0x5d82e(0x1dd)]((_0x453706,_0x39ae6f)=>{_0x5a6250[_0x39ae6f]['to_quantity']=_0x453706;}),_0x4a5851['forEach']((_0x1b7b6b,_0x59fbf1)=>{var _0xf2c212=_0x5d82e,_0x50d098=_0x1b7b6b[_0xf2c212(0x145)](/[A-Za-z]+/)[0x0],_0x2d9f59=parseInt(_0x1b7b6b[_0xf2c212(0x145)](/\d+/)[0x0]);_0x5a6250[_0x59fbf1][_0xf2c212(0x1dc)]=_0x50d098,_0x5a6250[_0x59fbf1][_0xf2c212(0x153)]=_0x2d9f59;}),_0x1c1d8f[_0x5d82e(0x1dd)]((_0x4fce9f,_0xc43f49)=>{_0x5a6250[_0xc43f49]['primary_code']=_0x4fce9f;}),_0x244f0c[_0x5d82e(0x1dd)]((_0x27a100,_0x3cd888)=>{var _0x22c2a0=_0x5d82e;_0x5a6250[_0x3cd888][_0x22c2a0(0x1c4)]=_0x27a100;}),_0x5f1d37['forEach']((_0x23264f,_0x20ed87)=>{var _0x3426bb=_0x5d82e;_0x5a6250[_0x20ed87][_0x3426bb(0x1d9)]=_0x23264f;}),_0x2ed148['forEach']((_0x1eb433,_0x53fd40)=>{_0x5a6250[_0x53fd40]['maxProducts']=_0x1eb433;}),_0x2deca5['forEach']((_0x1a9fba,_0x45ad07)=>{var _0x53a76c=_0x5d82e;_0x5a6250[_0x45ad07][_0x53a76c(0x149)]=_0x1a9fba;}),_0x1f5ced['forEach']((_0x843f6,_0x2d38f7)=>{var _0x55fb55=_0x5d82e;_0x5a6250[_0x2d38f7][_0x55fb55(0x1a8)]=_0x843f6;}),_0x85eba6['forEach']((_0xc9e55b,_0x3c9988)=>{var _0x5d76c2=_0x5d82e;_0x5a6250[_0x3c9988][_0x5d76c2(0x18d)]=_0xc9e55b;}),_0x23b351['forEach']((_0x50ff82,_0x22e437)=>{_0x5a6250[_0x22e437]['expiry_date']=_0x50ff82;}),_0x1e6c3f['forEach']((_0x23767c,_0x1ba694)=>{var _0x684b57=_0x5d82e;_0x5a6250[_0x1ba694][_0x684b57(0x144)]=_0x23767c;}),_0x222088['forEach']((_0x2b22e8,_0x16fdeb)=>{var _0x26daa8=_0x5d82e;_0x5a6250[_0x16fdeb][_0x26daa8(0x1d0)]=_0x2b22e8;}),_0x18ceed[_0x5d82e(0x1dd)]((_0xfe6374,_0x466be3)=>{var _0x24e0cc=_0x5d82e;_0x5a6250[_0x466be3][_0x24e0cc(0x1f0)]=_0xfe6374;}),_0x48ab2c[_0x5d82e(0x1dd)]((_0x1663d9,_0x18808e)=>{_0x5a6250[_0x18808e]['prod_cat']=_0x1663d9;}),_0x10c1c8[_0x5d82e(0x1dd)]((_0x13ad01,_0x1b12c5)=>{var _0x5a1ecf=_0x5d82e;_0x5a6250[_0x1b12c5][_0x5a1ecf(0x1ac)]=_0x13ad01;}),_0x3bda6a[_0x5d82e(0x1dd)]((_0x5af2ea,_0x1baf74)=>{var _0xd8a3e5=_0x5d82e;_0x5a6250[_0x1baf74][_0xd8a3e5(0x1e5)]=_0x5af2ea;});const _0x1e83dd=_0x5a6250[_0x5d82e(0x1b8)](_0x3b466b=>_0x3b466b[_0x5d82e(0x1cc)]!=='0'&&_0x3b466b[_0x5d82e(0x1cc)]!==''||_0x3b466b[_0x5d82e(0x184)]!=='0'&&_0x3b466b[_0x5d82e(0x184)]!=='');var _0x2aba81=0x0;_0x1e83dd[_0x5d82e(0x1dd)](_0x36073e=>{var _0x512bef=_0x5d82e;parseInt(_0x36073e[_0x512bef(0x19f)])<parseInt(_0x36073e[_0x512bef(0x1cc)])&&_0x2aba81++;});if(_0x2aba81!=0x0)return _0x5b9b16[_0x5d82e(0x1d1)](_0x5d82e(0x1e2),_0x5d82e(0x1a7)),_0x1741e4[_0x5d82e(0x1bb)]('back');const _0x3589d2=new transfers_logs();await _0x3589d2[_0x5d82e(0x201)]();for(let _0x32e759=0x0;_0x32e759<=_0x3bda6a['length']-0x1;_0x32e759++){_0x5a6250[_0x32e759][_0x5d82e(0x1b5)]=_0x5d82e(0x179)+_0x3589d2[_0x5d82e(0x13f)]['toString']()[_0x5d82e(0x150)](0x8,'0');}const _0x247938=new transfers_finished({'date':_0x11beef,'from_warehouse':_0x2ff710,'to_warehouse':_0x423860,'product':_0x1e83dd,'note':_0x3da4d5,'invoice':_0x5d82e(0x179)+_0x3589d2[_0x5d82e(0x13f)][_0x5d82e(0x15a)]()[_0x5d82e(0x150)](0x8,'0'),'type_of_transaction':_0x5d82e(0x170),'type_of_process':_0x5d82e(0x140),'PO_number':_0x4f4213,'RequestedBy':_0x55d635,'DateofRequest':_0x30a2f1,'typeservices':_0x73b6e6,'destination':_0x5105b6,'deliverydate':_0x43f49c,'driver':_0x30060b,'plate':_0x37f35a,'van':_0x1bf682,'DRSI':_0x3b2fb5,'typevehicle':_0x1bbd05,'TSU':_0x4e2467,'TFU':_0x3fda39}),_0x22846f=await _0x247938[_0x5d82e(0x201)]();_0x5b9b16[_0x5d82e(0x1d1)]('success',_0x5d82e(0x138)),_0x1741e4[_0x5d82e(0x1bb)](_0x5d82e(0x1d5)+_0x22846f[_0x5d82e(0x175)]);}catch(_0x4bf212){console[_0x5d82e(0x136)](_0x4bf212),_0x1741e4[_0x5d82e(0x14f)](0xc8)[_0x5d82e(0x1ba)]({'errorMessage':_0x4bf212[_0x5d82e(0x19b)]});}}),router['post'](a0_0x3f5a48(0x1f9),auth,async(_0x4441c1,_0x54fc73)=>{var _0xa1c392=a0_0x3f5a48;try{const {date:_0x378bdc,from_warehouse:_0x30b1ea,FromRoom_name:_0x491d2b,to_warehouse:_0x193a30,ToRoom_name:_0x1564bb,prod_name:_0x4dccf1,from_prod_qty:_0x431abb,from_prod_level:_0x58bc32,from_prod_isle:_0x281ac2,from_prod_pallet:_0x4faf0e,to_prod_qty:_0x3c9f4e,to_prod_level:_0x3e0a59,to_prod_isle:_0x27e7c4,to_prod_pallet:_0x6a0818,primary_code:_0x529090,secondary_code:_0x546026,product_code3:_0x56786b,note:_0x5ac0f6,MaxStocks_data2:_0x44a715,invoice:_0x224541,expiry_date:_0x3974cf,PO_number:_0x399104,ReqBy:_0x50a292,dateofreq:_0x2e8b2d,typeservicesData:_0x186af4,destination:_0x13a61a,deliverydate:_0x333628,driver:_0x414911,plate:_0x404995,van:_0x3d2b6d,DRSI:_0x51c78b,typevehicle:_0x4f7902,TSU:_0x3195c3,TFU:_0x871394}=_0x4441c1[_0xa1c392(0x1f1)];if(typeof _0x4dccf1==_0xa1c392(0x1e4))var _0x53b586=[_0x4441c1[_0xa1c392(0x1f1)]['prod_name']],_0x402552=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x194)]],_0x2c4210=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1c9)]],_0xb84fc4=[_0x4441c1[_0xa1c392(0x1f1)]['New_Qty_Converted']],_0x2728e2=[_0x4441c1[_0xa1c392(0x1f1)]['to_prod_level']],_0x2ba327=[_0x4441c1[_0xa1c392(0x1f1)]['primary_code']],_0x5bed61=[_0x4441c1['body'][_0xa1c392(0x1c4)]],_0x470dd4=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1f3)]],_0x60d18e=[_0x4441c1['body']['MaxStocks_data2']],_0x2790c2=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1cd)]],_0x465137=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1a8)]],_0x4167e7=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x18d)]],_0x10f123=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1e3)]],_0x4de11b=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x169)]],_0x1930bf=[_0x4441c1[_0xa1c392(0x1f1)]['MaxStocks_data']],_0x5699a4=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1f0)]],_0xfaadc6=[_0x4441c1[_0xa1c392(0x1f1)]['prod_cat']],_0x84f329=[_0x4441c1['body'][_0xa1c392(0x173)]],_0x12c6f1=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x164)]],_0x3df20f=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x13e)]],_0x53112b=[_0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x19d)]];else var _0x53b586=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x156)]],_0x402552=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x194)]],_0x2c4210=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1c9)]],_0xb84fc4=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x19c)]],_0x2728e2=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1bc)]],_0x2ba327=[..._0x4441c1[_0xa1c392(0x1f1)]['primary_code']],_0x5bed61=[..._0x4441c1[_0xa1c392(0x1f1)]['secondary_code']],_0x470dd4=[..._0x4441c1['body'][_0xa1c392(0x1f3)]],_0x60d18e=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1c1)]],_0x2790c2=[..._0x4441c1[_0xa1c392(0x1f1)]['primary_unit']],_0x465137=[..._0x4441c1['body'][_0xa1c392(0x1a8)]],_0x4167e7=[..._0x4441c1[_0xa1c392(0x1f1)]['batch_code']],_0x10f123=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1e3)]],_0x4de11b=[..._0x4441c1['body'][_0xa1c392(0x169)]],_0x1930bf=[..._0x4441c1['body'][_0xa1c392(0x141)]],_0x5699a4=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x1f0)]],_0xfaadc6=[..._0x4441c1[_0xa1c392(0x1f1)]['prod_cat']],_0x84f329=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x173)]],_0x12c6f1=[..._0x4441c1[_0xa1c392(0x1f1)][_0xa1c392(0x164)]],_0x3df20f=[..._0x4441c1[_0xa1c392(0x1f1)]['from_invoice']],_0x53112b=[..._0x4441c1[_0xa1c392(0x1f1)]['id_transaction']];const _0x1f0940=_0x53b586['map'](_0x3d575f=>{return _0x3d575f={'product_name':_0x3d575f};});_0x402552[_0xa1c392(0x1dd)]((_0x3fd5d5,_0x5919de)=>{var _0x321577=_0xa1c392;_0x1f0940[_0x5919de][_0x321577(0x19f)]=_0x3fd5d5;}),_0x2c4210['forEach']((_0x1fa670,_0x31fedc)=>{var _0x1c4f48=_0xa1c392,_0xa8a8fa=_0x1fa670[_0x1c4f48(0x145)](/[A-Za-z]+/)[0x0],_0x4ebe44=parseInt(_0x1fa670[_0x1c4f48(0x145)](/\d+/)[0x0]);_0x1f0940[_0x31fedc]['from_bay']=_0x4ebe44,_0x1f0940[_0x31fedc][_0x1c4f48(0x166)]=_0xa8a8fa;}),_0x53112b[_0xa1c392(0x1dd)]((_0x20293e,_0x323abe)=>{var _0x51adf8=_0xa1c392;_0x1f0940[_0x323abe][_0x51adf8(0x19d)]=_0x20293e;}),_0x3df20f['forEach']((_0x548123,_0x358302)=>{var _0x2af51f=_0xa1c392;_0x1f0940[_0x358302][_0x2af51f(0x13e)]=_0x548123;}),_0xb84fc4['forEach']((_0x4baa3a,_0xee62)=>{_0x1f0940[_0xee62]['to_quantity']=_0x4baa3a;}),_0x2728e2['forEach']((_0x563955,_0x57a206)=>{var _0x498f50=_0xa1c392,_0x434393=_0x563955['match'](/[A-Za-z]+/)[0x0],_0x3b3610=parseInt(_0x563955['match'](/\d+/)[0x0]);_0x1f0940[_0x57a206][_0x498f50(0x1dc)]=_0x434393,_0x1f0940[_0x57a206]['to_bay']=_0x3b3610;}),_0x2ba327[_0xa1c392(0x1dd)]((_0x17b04d,_0x4e8f31)=>{_0x1f0940[_0x4e8f31]['primary_code']=_0x17b04d;}),_0x5bed61[_0xa1c392(0x1dd)]((_0x8ae6a0,_0xb4b5ab)=>{var _0x323ccd=_0xa1c392;_0x1f0940[_0xb4b5ab][_0x323ccd(0x1c4)]=_0x8ae6a0;}),_0x470dd4[_0xa1c392(0x1dd)]((_0x53d80c,_0x5749ef)=>{var _0x925fa7=_0xa1c392;_0x1f0940[_0x5749ef][_0x925fa7(0x1d9)]=_0x53d80c;}),_0x60d18e['forEach']((_0x2be931,_0x11e419)=>{var _0x5b3874=_0xa1c392;_0x1f0940[_0x11e419][_0x5b3874(0x1d0)]=_0x2be931;}),_0x2790c2[_0xa1c392(0x1dd)]((_0x4c5ade,_0x165493)=>{var _0x5a048c=_0xa1c392;_0x1f0940[_0x165493][_0x5a048c(0x149)]=_0x4c5ade;}),_0x465137[_0xa1c392(0x1dd)]((_0x3d8d5c,_0x162c3)=>{var _0x2e6650=_0xa1c392;_0x1f0940[_0x162c3][_0x2e6650(0x1a8)]=_0x3d8d5c;}),_0x4167e7['forEach']((_0x32cbbb,_0x118588)=>{var _0x47ffd1=_0xa1c392;_0x1f0940[_0x118588][_0x47ffd1(0x18d)]=_0x32cbbb;}),_0x10f123[_0xa1c392(0x1dd)]((_0x4340ff,_0x47fe89)=>{var _0x21c449=_0xa1c392;_0x1f0940[_0x47fe89][_0x21c449(0x1e3)]=_0x4340ff;}),_0x4de11b[_0xa1c392(0x1dd)]((_0x516cd6,_0x337291)=>{var _0x4664c9=_0xa1c392;_0x1f0940[_0x337291][_0x4664c9(0x144)]=_0x516cd6;}),_0x1930bf['forEach']((_0x3235ee,_0x3bf7f6)=>{var _0x33c767=_0xa1c392;_0x1f0940[_0x3bf7f6][_0x33c767(0x1d0)]=_0x3235ee;}),_0x5699a4['forEach']((_0x198bee,_0x5dd57c)=>{var _0x198b1c=_0xa1c392;_0x1f0940[_0x5dd57c][_0x198b1c(0x1f0)]=_0x198bee;}),_0xfaadc6[_0xa1c392(0x1dd)]((_0xdcf8c2,_0x296974)=>{var _0xd1f57c=_0xa1c392;_0x1f0940[_0x296974][_0xd1f57c(0x18b)]=_0xdcf8c2;}),_0x84f329[_0xa1c392(0x1dd)]((_0x3e2c59,_0xf9f4b)=>{_0x1f0940[_0xf9f4b]['from_room_name']=_0x3e2c59;}),_0x12c6f1[_0xa1c392(0x1dd)]((_0x31e90c,_0x5b6082)=>{var _0x3b0441=_0xa1c392;_0x1f0940[_0x5b6082][_0x3b0441(0x1e5)]=_0x31e90c;});const _0x4ea5df=_0x1f0940['filter'](_0xfc2368=>_0xfc2368[_0xa1c392(0x1cc)]!=='0'&&_0xfc2368[_0xa1c392(0x1cc)]!==''||_0xfc2368[_0xa1c392(0x184)]!=='0'&&_0xfc2368[_0xa1c392(0x184)]!=='');var _0x12af22=0x0;_0x4ea5df[_0xa1c392(0x1dd)](_0x38a46a=>{var _0x1aceb6=_0xa1c392;parseInt(_0x38a46a[_0x1aceb6(0x19f)])<parseInt(_0x38a46a[_0x1aceb6(0x1cc)])&&_0x12af22++;});if(_0x12af22!=0x0)return _0x4441c1[_0xa1c392(0x1d1)](_0xa1c392(0x1e2),_0xa1c392(0x1a7)),_0x54fc73[_0xa1c392(0x1bb)](_0xa1c392(0x172));const _0x336b3b=new invoice_for_transfer();await _0x336b3b['save']();for(let _0x46ba54=0x0;_0x46ba54<=_0x12c6f1['length']-0x1;_0x46ba54++){_0x1f0940[_0x46ba54][_0xa1c392(0x1b5)]='TRF-'+_0x336b3b[_0xa1c392(0x13f)][_0xa1c392(0x15a)]()[_0xa1c392(0x150)](0x8,'0');}const _0x451fd7=new transfers_finished({'date':_0x378bdc,'from_warehouse':_0x30b1ea,'to_warehouse':_0x30b1ea,'product':_0x4ea5df,'note':_0x5ac0f6,'invoice':_0xa1c392(0x17f)+_0x336b3b['invoice_init'][_0xa1c392(0x15a)]()['padStart'](0x8,'0'),'type_of_process':_0xa1c392(0x152),'type_of_transaction':_0xa1c392(0x178),'PO_number':_0x399104,'RequestedBy':_0x50a292,'DateofRequest':_0x2e8b2d,'typeservices':_0x186af4,'destination':_0x13a61a,'deliverydate':_0x333628,'driver':_0x414911,'plate':_0x404995,'van':_0x3d2b6d,'DRSI':_0x51c78b,'typevehicle':_0x4f7902,'TSU':_0x3195c3,'TFU':_0x871394}),_0x52e6b3=await _0x451fd7['save']();_0x4441c1['flash'](_0xa1c392(0x1a5),_0xa1c392(0x138)),_0x54fc73['redirect'](_0xa1c392(0x1d5)+_0x52e6b3['_id']);}catch(_0x13cf83){console[_0xa1c392(0x136)](_0x13cf83),_0x54fc73[_0xa1c392(0x14f)](0xc8)[_0xa1c392(0x1ba)]({'errorMessage':_0x13cf83['message']});}}),router[a0_0x3f5a48(0x182)](a0_0x3f5a48(0x161),auth,async(_0x4d507b,_0x152b02)=>{var _0x265869=a0_0x3f5a48;try{const {date:_0x3c98d4,from_warehouse:_0x4433cb,FromRoom_name:_0x2c6c32,to_warehouse:_0x38908d,ToRoom_name:_0x5ef100,prod_name:_0x4846ad,from_prod_qty:_0x4ce8a5,from_prod_level:_0x4991d6,from_prod_isle:_0x3530c5,from_prod_pallet:_0x5aaf93,to_prod_qty:_0x8de78,to_prod_level:_0x1bf81b,to_prod_isle:_0x32dae7,to_prod_pallet:_0x4bb85a,primary_code:_0x233a87,secondary_code:_0x3e6b9d,product_code3:_0x1a1012,note:_0xf999f3,MaxStocks_data2:_0x486219,invoice:_0xeb5773,expiry_date:_0x464753,PO_number_loc:_0x4ef5fb,ReqBy_loc:_0x2967af,dateofreq_loc:_0x3fd644,typeservices_loc_Data:_0x5739ae,destination_loc:_0x4752db,deliverydate_loc:_0x2f93ff,driver_loc:_0x361726,plate_loc:_0x3488be,van_loc:_0x71467d,DRSI_loc:_0x50af0a,typevehicle_loc:_0xf27983,TSU_loc:_0x5b91c1,TFU_loc:_0x52a230}=_0x4d507b[_0x265869(0x1f1)];if(typeof _0x4846ad==_0x265869(0x1e4))var _0x23883f=[_0x4d507b['body'][_0x265869(0x156)]],_0x3c61a7=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x194)]],_0x22f2e7=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x1c9)]],_0x119376=[_0x4d507b['body'][_0x265869(0x19c)]],_0x46cb9d=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x1bc)]],_0xbfd92a=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x1a6)]],_0x59137c=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x1c4)]],_0x52a807=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x1f3)]],_0x16cbc4=[_0x4d507b[_0x265869(0x1f1)]['MaxStocks_data2']],_0x40ef2e=[_0x4d507b['body'][_0x265869(0x1cd)]],_0x4ca848=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x1a8)]],_0x2c94dc=[_0x4d507b['body'][_0x265869(0x18d)]],_0x214ce9=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x1e3)]],_0x387f4e=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x169)]],_0x349a5e=[_0x4d507b['body'][_0x265869(0x141)]],_0x39fb51=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x1f0)]],_0x5dcdf9=[_0x4d507b[_0x265869(0x1f1)][_0x265869(0x18b)]],_0x383223=[_0x4d507b[_0x265869(0x1f1)]['RoomAssigned']],_0x46097b=[_0x4d507b[_0x265869(0x1f1)]['ToRoomAssigned']],_0x4efeb1=[_0x4d507b[_0x265869(0x1f1)]['from_invoice']],_0x2ab5c5=[_0x4d507b['body'][_0x265869(0x19d)]];else var _0x23883f=[..._0x4d507b['body']['prod_name']],_0x3c61a7=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x194)]],_0x22f2e7=[..._0x4d507b['body'][_0x265869(0x1c9)]],_0x119376=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x19c)]],_0x46cb9d=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x1bc)]],_0xbfd92a=[..._0x4d507b[_0x265869(0x1f1)]['primary_code']],_0x59137c=[..._0x4d507b[_0x265869(0x1f1)]['secondary_code']],_0x52a807=[..._0x4d507b[_0x265869(0x1f1)]['product_code3']],_0x16cbc4=[..._0x4d507b['body'][_0x265869(0x1c1)]],_0x40ef2e=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x1cd)]],_0x4ca848=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x1a8)]],_0x2c94dc=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x18d)]],_0x214ce9=[..._0x4d507b['body'][_0x265869(0x1e3)]],_0x387f4e=[..._0x4d507b['body']['product_date']],_0x349a5e=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x141)]],_0x39fb51=[..._0x4d507b['body'][_0x265869(0x1f0)]],_0x5dcdf9=[..._0x4d507b['body'][_0x265869(0x18b)]],_0x383223=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x173)]],_0x46097b=[..._0x4d507b[_0x265869(0x1f1)][_0x265869(0x164)]],_0x4efeb1=[..._0x4d507b[_0x265869(0x1f1)]['from_invoice']],_0x2ab5c5=[..._0x4d507b[_0x265869(0x1f1)]['id_transaction']];const _0xd8a3f3=_0x23883f[_0x265869(0x196)](_0x1bb762=>{return _0x1bb762={'product_name':_0x1bb762};});_0x3c61a7[_0x265869(0x1dd)]((_0x43ce03,_0x3f1571)=>{var _0x3ed05b=_0x265869;_0xd8a3f3[_0x3f1571][_0x3ed05b(0x19f)]=_0x43ce03;}),_0x22f2e7[_0x265869(0x1dd)]((_0x1e9786,_0x569a7e)=>{var _0x14d931=_0x265869,_0x3a5ed7=_0x1e9786[_0x14d931(0x145)](/[A-Za-z]+/)[0x0],_0x64ad5e=parseInt(_0x1e9786[_0x14d931(0x145)](/\d+/)[0x0]);_0xd8a3f3[_0x569a7e]['from_bay']=_0x64ad5e,_0xd8a3f3[_0x569a7e][_0x14d931(0x166)]=_0x3a5ed7;}),_0x2ab5c5[_0x265869(0x1dd)]((_0x465c77,_0x45ef4d)=>{var _0xb5c312=_0x265869;_0xd8a3f3[_0x45ef4d][_0xb5c312(0x19d)]=_0x465c77;}),_0x4efeb1['forEach']((_0x16e2b3,_0x379f20)=>{var _0x3577ad=_0x265869;_0xd8a3f3[_0x379f20][_0x3577ad(0x13e)]=_0x16e2b3;}),_0x119376['forEach']((_0xa7c119,_0xce8f03)=>{_0xd8a3f3[_0xce8f03]['to_quantity']=_0xa7c119;}),_0x46cb9d[_0x265869(0x1dd)]((_0x13817c,_0x1ef718)=>{var _0x11c230=_0x265869,_0x16c4c5=_0x13817c[_0x11c230(0x145)](/[A-Za-z]+/)[0x0],_0x1c0e4e=parseInt(_0x13817c[_0x11c230(0x145)](/\d+/)[0x0]);_0xd8a3f3[_0x1ef718]['to_level']=_0x16c4c5,_0xd8a3f3[_0x1ef718][_0x11c230(0x153)]=_0x1c0e4e;}),_0xbfd92a['forEach']((_0x1252e6,_0x59bb3b)=>{var _0x349c35=_0x265869;_0xd8a3f3[_0x59bb3b][_0x349c35(0x1a6)]=_0x1252e6;}),_0x59137c[_0x265869(0x1dd)]((_0x53a20d,_0xc287a4)=>{var _0x2f1e80=_0x265869;_0xd8a3f3[_0xc287a4][_0x2f1e80(0x1c4)]=_0x53a20d;}),_0x52a807[_0x265869(0x1dd)]((_0x12f19d,_0x5663fc)=>{var _0x215602=_0x265869;_0xd8a3f3[_0x5663fc][_0x215602(0x1d9)]=_0x12f19d;}),_0x16cbc4[_0x265869(0x1dd)]((_0x46b249,_0x525969)=>{var _0x38af54=_0x265869;_0xd8a3f3[_0x525969][_0x38af54(0x1d0)]=_0x46b249;}),_0x40ef2e['forEach']((_0x412821,_0x4fb86f)=>{var _0x61bc99=_0x265869;_0xd8a3f3[_0x4fb86f][_0x61bc99(0x149)]=_0x412821;}),_0x4ca848['forEach']((_0x2c729c,_0x26f627)=>{var _0x25f238=_0x265869;_0xd8a3f3[_0x26f627][_0x25f238(0x1a8)]=_0x2c729c;}),_0x2c94dc[_0x265869(0x1dd)]((_0x49ad01,_0x1b38c0)=>{var _0x1a608b=_0x265869;_0xd8a3f3[_0x1b38c0][_0x1a608b(0x18d)]=_0x49ad01;}),_0x214ce9['forEach']((_0x5cf731,_0x2ab168)=>{var _0x13ff21=_0x265869;_0xd8a3f3[_0x2ab168][_0x13ff21(0x1e3)]=_0x5cf731;}),_0x387f4e[_0x265869(0x1dd)]((_0x5326f4,_0x35b823)=>{_0xd8a3f3[_0x35b823]['production_date']=_0x5326f4;}),_0x349a5e[_0x265869(0x1dd)]((_0x8498c,_0xca508a)=>{var _0x38623b=_0x265869;_0xd8a3f3[_0xca508a][_0x38623b(0x1d0)]=_0x8498c;}),_0x39fb51[_0x265869(0x1dd)]((_0x3924e9,_0x484f7f)=>{var _0x523e93=_0x265869;_0xd8a3f3[_0x484f7f][_0x523e93(0x1f0)]=_0x3924e9;}),_0x5dcdf9['forEach']((_0x473bba,_0x107acf)=>{var _0x450d4f=_0x265869;_0xd8a3f3[_0x107acf][_0x450d4f(0x18b)]=_0x473bba;}),_0x383223[_0x265869(0x1dd)]((_0x152e97,_0x532a70)=>{var _0x39a6f5=_0x265869;_0xd8a3f3[_0x532a70][_0x39a6f5(0x1ac)]=_0x152e97;}),_0x46097b[_0x265869(0x1dd)]((_0x58851e,_0x391e72)=>{var _0x1ccf4e=_0x265869;_0xd8a3f3[_0x391e72][_0x1ccf4e(0x1e5)]=_0x58851e;});const _0x3ed6f1=_0xd8a3f3[_0x265869(0x1b8)](_0x54e3fe=>_0x54e3fe[_0x265869(0x1cc)]!=='0'&&_0x54e3fe['to_quantity']!==''||_0x54e3fe['to_floorlevel']!=='0'&&_0x54e3fe[_0x265869(0x184)]!=='');var _0x5b7cdf=0x0;_0x3ed6f1[_0x265869(0x1dd)](_0x162b07=>{var _0x25c6f8=_0x265869;parseInt(_0x162b07[_0x25c6f8(0x19f)])<parseInt(_0x162b07[_0x25c6f8(0x1cc)])&&_0x5b7cdf++;});if(_0x5b7cdf!=0x0)return _0x4d507b[_0x265869(0x1d1)](_0x265869(0x1e2),_0x265869(0x1a7)),_0x152b02[_0x265869(0x1bb)]('back');const _0x332cc2=new invoice_for_transfer();await _0x332cc2['save']();for(let _0x2030b0=0x0;_0x2030b0<=_0x46097b[_0x265869(0x187)]-0x1;_0x2030b0++){_0xd8a3f3[_0x2030b0][_0x265869(0x1b5)]=_0x265869(0x17f)+_0x332cc2[_0x265869(0x13f)][_0x265869(0x15a)]()[_0x265869(0x150)](0x8,'0');}const _0x39d363=new transfers_finished({'date':_0x3c98d4,'from_warehouse':_0x4433cb,'to_warehouse':_0x38908d,'product':_0x3ed6f1,'note':_0xf999f3,'invoice':_0x265869(0x17f)+_0x332cc2['invoice_init'][_0x265869(0x15a)]()['padStart'](0x8,'0'),'type_of_transaction':'own','type_of_process':_0x265869(0x140),'PO_number':_0x4ef5fb,'RequestedBy':_0x2967af,'DateofRequest':_0x3fd644,'typeservices':_0x5739ae,'destination':_0x4752db,'deliverydate':_0x2f93ff,'driver':_0x361726,'plate':_0x3488be,'van':_0x71467d,'DRSI':_0x50af0a,'typevehicle':_0xf27983,'TSU':_0x5b91c1,'TFU':_0x52a230}),_0x2bcca4=await _0x39d363[_0x265869(0x201)]();_0x4d507b[_0x265869(0x1d1)]('success',_0x265869(0x138)),_0x152b02[_0x265869(0x1bb)](_0x265869(0x1d5)+_0x2bcca4[_0x265869(0x175)]);}catch(_0x3eaa73){console[_0x265869(0x136)](_0x3eaa73),_0x152b02[_0x265869(0x14f)](0xc8)[_0x265869(0x1ba)]({'errorMessage':_0x3eaa73['message']});}}),router[a0_0x3f5a48(0x180)](a0_0x3f5a48(0x1e1),auth,async(_0x4f8b62,_0x3aa5ba)=>{var _0x4f6e12=a0_0x3f5a48;try{const {username:_0x224c41,email:_0x273095,role:_0x1a8f49}=_0x4f8b62[_0x4f6e12(0x1cb)],_0x4a1894=_0x4f8b62[_0x4f6e12(0x1cb)],_0x4aa206=await profile[_0x4f6e12(0x1c0)]({'email':_0x4a1894['email']}),_0x40e8c3=await master_shop[_0x4f6e12(0x18c)](),_0x114d5d=await transfers_finished[_0x4f6e12(0x1f7)](_0x4f8b62[_0x4f6e12(0x1d4)]['id']);let _0x48e698;if(_0x4a1894['role']=='staff'){const _0x2df86c=await staff['findOne']({'email':_0x4a1894['email']});_0x48e698=await warehouse['find']({'status':_0x4f6e12(0x15c),'name':_0x2df86c[_0x4f6e12(0x139)],'warehouse_category':'Finished\x20Goods'});}else _0x48e698=await warehouse['find']({'status':_0x4f6e12(0x15c),'warehouse_category':_0x4f6e12(0x18a)});const _0x2f1471=await warehouse[_0x4f6e12(0x165)]([{'$match':{'name':_0x114d5d[_0x4f6e12(0x1db)],'warehouse_category':_0x4f6e12(0x18a)}},{'$unwind':_0x4f6e12(0x1cf)},{'$group':{'_id':_0x4f6e12(0x1ae),'name':{'$first':_0x4f6e12(0x154)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4f6e12(0x1de)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4f6e12(0x1f5)},'floorlevel':{'$first':_0x4f6e12(0x15d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4f6e12(0x1fa)},'product_code':{'$first':_0x4f6e12(0x13d)},'storage':{'$first':_0x4f6e12(0x134)},'rack':{'$first':_0x4f6e12(0x186)},'expiry_date':{'$first':_0x4f6e12(0x158)},'production_date':{'$first':_0x4f6e12(0x1f6)},'room':{'$first':_0x4f6e12(0x146)},'warehoue_name':{'$first':_0x4f6e12(0x1b2)}}}]),_0x46ae9e=await product[_0x4f6e12(0x18c)]({});if(_0x40e8c3[0x0][_0x4f6e12(0x171)]==_0x4f6e12(0x14a)){var _0x56236a=users[_0x4f6e12(0x1df)];console[_0x4f6e12(0x136)](_0x56236a);}else{if(_0x40e8c3[0x0][_0x4f6e12(0x171)]==_0x4f6e12(0x142))var _0x56236a=users['Hindi'];else{if(_0x40e8c3[0x0][_0x4f6e12(0x171)]==_0x4f6e12(0x199))var _0x56236a=users[_0x4f6e12(0x199)];else{if(_0x40e8c3[0x0]['language']=='Spanish')var _0x56236a=users[_0x4f6e12(0x1e9)];else{if(_0x40e8c3[0x0][_0x4f6e12(0x171)]=='French')var _0x56236a=users[_0x4f6e12(0x190)];else{if(_0x40e8c3[0x0][_0x4f6e12(0x171)]=='Portuguese\x20(BR)')var _0x56236a=users[_0x4f6e12(0x1e6)];else{if(_0x40e8c3[0x0][_0x4f6e12(0x171)]==_0x4f6e12(0x1ea))var _0x56236a=users[_0x4f6e12(0x1ea)];else{if(_0x40e8c3[0x0][_0x4f6e12(0x171)]==_0x4f6e12(0x1fc))var _0x56236a=users[_0x4f6e12(0x1fe)];}}}}}}}_0x3aa5ba['render'](_0x4f6e12(0x16b),{'success':_0x4f8b62[_0x4f6e12(0x1d1)](_0x4f6e12(0x1a5)),'errors':_0x4f8b62[_0x4f6e12(0x1d1)]('errors'),'role':_0x4a1894,'profile':_0x4aa206,'master_shop':_0x40e8c3,'warehouse':_0x48e698,'transfer':_0x114d5d,'stock':_0x2f1471,'unit':_0x46ae9e,'language':_0x56236a});}catch(_0x12372f){console[_0x4f6e12(0x136)](_0x12372f);}}),router['post'](a0_0x3f5a48(0x1e1),auth,async(_0x4a97bd,_0x3cd03f)=>{var _0x211bb1=a0_0x3f5a48;try{const {invoice:_0x5d361f,from_warehouse:_0x595a7b,FromRoom_name:_0x2d4d4a,to_warehouse:_0x3d1dac,ToRoom_name:_0x2830f1}=_0x4a97bd['body'],_0x4f8b10=await transfers_finished['findById'](_0x4a97bd[_0x211bb1(0x1d4)]['id']),_0x3f3e13=_0x4f8b10[_0x211bb1(0x160)]['map'](async _0x2fe653=>{var _0x1b76a0=_0x211bb1;if(_0x2fe653[_0x1b76a0(0x1cc)]>0x0){var _0x30c4c0=await warehouse[_0x1b76a0(0x1c0)]({'name':_0x595a7b,'room':_0x2fe653[_0x1b76a0(0x1ac)]});const _0x35cf81=_0x30c4c0[_0x1b76a0(0x1b7)][_0x1b76a0(0x196)](_0x498380=>{var _0x444e08=_0x1b76a0;_0x498380[_0x444e08(0x175)]==_0x2fe653[_0x444e08(0x19d)]&&(_0x498380[_0x444e08(0x1be)]=Math[_0x444e08(0x1ab)](0x0,Math[_0x444e08(0x1eb)](_0x498380[_0x444e08(0x1be)])-Math['abs'](_0x2fe653[_0x444e08(0x1cc)])),console[_0x444e08(0x136)](_0x498380[_0x444e08(0x1be)]));});}return _0x30c4c0;});Promise[_0x211bb1(0x1ef)](_0x3f3e13)[_0x211bb1(0x1ff)](async _0xd6511c=>{var _0x236ea6=_0x211bb1;try{for(const _0x5f197f of _0xd6511c){await _0x5f197f[_0x236ea6(0x201)]();}const _0x560130=_0x4f8b10[_0x236ea6(0x160)]['map'](async _0x7d118d=>{var _0x550410=_0x236ea6,_0x167bb2=await warehouse[_0x550410(0x1c0)]({'name':_0x3d1dac,'room':_0x7d118d['to_room_name']});if(_0x7d118d[_0x550410(0x1cc)]>0x0){var _0x487b14=0x0;const _0x24fd1d=_0x167bb2[_0x550410(0x1b7)][_0x550410(0x196)](_0x567033=>{var _0x59eb11=_0x550410;_0x567033[_0x59eb11(0x181)]==_0x7d118d[_0x59eb11(0x181)]&&_0x567033['bay']==_0x7d118d['to_bay']&&_0x567033[_0x59eb11(0x1e3)]==_0x7d118d[_0x59eb11(0x1e3)]&&_0x567033[_0x59eb11(0x144)]==_0x7d118d[_0x59eb11(0x144)]&&_0x567033[_0x59eb11(0x18d)]==_0x7d118d[_0x59eb11(0x18d)]&&_0x567033['invoice']==_0x7d118d[_0x59eb11(0x1b5)]&&(typeof _0x7d118d[_0x59eb11(0x19d)]==_0x59eb11(0x1d6)?(console[_0x59eb11(0x136)]('here2',_0x567033['product_stock']+_0x59eb11(0x1ed)+_0x567033[_0x59eb11(0x175)]+_0x59eb11(0x19e)+Math[_0x59eb11(0x1eb)](_0x567033[_0x59eb11(0x1be)])+Math[_0x59eb11(0x1eb)](_0x7d118d[_0x59eb11(0x1cc)])),_0x567033['product_stock']=Math['abs'](_0x567033['product_stock'])+Math[_0x59eb11(0x1eb)](_0x7d118d[_0x59eb11(0x1cc)])):_0x567033[_0x59eb11(0x1be)]=Math[_0x59eb11(0x1eb)](_0x567033['product_stock'])+Math[_0x59eb11(0x1eb)](_0x7d118d[_0x59eb11(0x1cc)]),_0x487b14++);});_0x487b14=='0'&&(_0x167bb2[_0x550410(0x1b7)]=_0x167bb2[_0x550410(0x1b7)][_0x550410(0x1a4)]({'product_name':_0x7d118d[_0x550410(0x181)],'product_stock':_0x7d118d[_0x550410(0x1cc)],'bay':_0x7d118d[_0x550410(0x153)],'level':_0x7d118d['to_level'],'product_code':_0x7d118d[_0x550410(0x1d9)],'primary_code':_0x7d118d['primary_code'],'secondary_code':_0x7d118d[_0x550410(0x1c4)],'expiry_date':_0x7d118d[_0x550410(0x1e3)],'production_date':_0x7d118d[_0x550410(0x144)],'maxProducts':_0x7d118d[_0x550410(0x1d0)],'batch_code':_0x7d118d[_0x550410(0x18d)],'secondary_unit':_0x7d118d[_0x550410(0x1a8)],'unit':_0x7d118d['unit'],'maxProducts':_0x7d118d['maxProducts'],'maxPerUnit':_0x7d118d[_0x550410(0x1f0)],'invoice':_0x7d118d['To_invoice']}));}return _0x167bb2;});Promise['all'](_0x560130)[_0x236ea6(0x1ff)](async _0x5f16fb=>{var _0x723c1a=_0x236ea6;try{console[_0x723c1a(0x136)](_0x4f8b10['type_of_process']);if(_0x4f8b10[_0x723c1a(0x16e)]!=_0x723c1a(0x140))for(const _0x1f7faa of _0x5f16fb){await warehouse[_0x723c1a(0x1d3)]({'_id':_0x1f7faa['_id']},{'$addToSet':{'product_details':{'$each':_0x1f7faa['product_details']}}});}_0x4f8b10[_0x723c1a(0x167)]=_0x723c1a(0x1a2);const _0x331194=await _0x4f8b10[_0x723c1a(0x201)](),_0x2994a6=await master_shop[_0x723c1a(0x18c)](),_0x30f483=await email_settings[_0x723c1a(0x1c0)](),_0x463cd6=await supervisor_settings[_0x723c1a(0x18c)]();var _0x37a679=_0x4f8b10[_0x723c1a(0x160)],_0x1e03e3='',_0x193866;for(_0x193866 in _0x37a679){var _0xfa7f54='FG';_0x4f8b10[_0x723c1a(0x15e)]==_0x723c1a(0x13a)&&(_0xfa7f54='DG'),_0x1e03e3+=_0x723c1a(0x1af)+_0x723c1a(0x16a)+_0x37a679[_0x193866][_0x723c1a(0x181)]+_0x723c1a(0x1f2)+_0x723c1a(0x16a)+_0x37a679[_0x193866]['product_code']+_0x723c1a(0x1f2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x37a679[_0x193866]['to_quantity']+_0x723c1a(0x1f2)+_0x723c1a(0x16a)+_0x37a679[_0x193866]['unit']+'</td>'+_0x723c1a(0x16a)+_0x37a679[_0x193866][_0x723c1a(0x1a8)]+'</td>'+_0x723c1a(0x16a)+_0x4f8b10['to_warehouse']+_0x723c1a(0x1f2)+_0x723c1a(0x16a)+_0x37a679[_0x193866][_0x723c1a(0x1e5)]+_0x723c1a(0x1f2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfa7f54+_0x37a679[_0x193866][_0x723c1a(0x153)]+_0x723c1a(0x1f2)+_0x723c1a(0x1ce);}_0x4a97bd[_0x723c1a(0x1d1)]('success',_0x723c1a(0x1e0)),_0x3cd03f[_0x723c1a(0x1bb)](_0x723c1a(0x1a1)+_0x331194[_0x723c1a(0x175)]);}catch(_0x257e48){console[_0x723c1a(0x1e8)](_0x257e48),_0x3cd03f[_0x723c1a(0x14f)](0x1f4)[_0x723c1a(0x1ba)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x236ea6(0x1d7)](_0x3ee23c=>{var _0x3540e3=_0x236ea6;console[_0x3540e3(0x1e8)](_0x3ee23c),_0x3cd03f[_0x3540e3(0x14f)](0x1f4)[_0x3540e3(0x1ba)]({'error':'An\x20error\x20occurred.'});});}catch(_0x246293){console[_0x236ea6(0x1e8)](_0x246293),_0x3cd03f[_0x236ea6(0x14f)](0x1f4)[_0x236ea6(0x1ba)]({'error':_0x236ea6(0x1d8)});}})[_0x211bb1(0x1d7)](_0x3e6526=>{var _0x14a5ab=_0x211bb1;console[_0x14a5ab(0x1e8)](_0x3e6526),_0x3cd03f[_0x14a5ab(0x14f)](0x1f4)[_0x14a5ab(0x1ba)]({'error':_0x14a5ab(0x1c3)});});}catch(_0x5c46d8){_0x3cd03f[_0x211bb1(0x1ba)]({'message':_0x5c46d8[_0x211bb1(0x19b)]});}});function BayBinSelected(_0x372c56,_0x574266){var _0x1197b3=a0_0x3f5a48,_0x32fe08=[];let _0x31f2c8=[];var _0x4dd4fd=[];if(_0x372c56=='DRY\x20GOODS'){switch(_0x574266){case _0x1197b3(0x17c):_0x32fe08=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x1197b3(0x1a9):_0x32fe08=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x4dd4fd=['DG'];}else{if(_0x372c56==_0x1197b3(0x189)){switch(_0x574266){case _0x1197b3(0x17c):_0x32fe08=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x1197b3(0x1a9):_0x32fe08=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x4dd4fd=['FG'];}}return{'levels':_0x32fe08,'identify':_0x4dd4fd};}router[a0_0x3f5a48(0x180)]('/view/:id',auth,async(_0x3fcd68,_0x2ecaed)=>{var _0x48c012=a0_0x3f5a48;try{const {username:_0x4ac5a4,email:_0xab07ae,role:_0xa3b937}=_0x3fcd68[_0x48c012(0x1cb)],_0x3a736e=_0x3fcd68[_0x48c012(0x1cb)],_0x3df363=await profile[_0x48c012(0x1c0)]({'email':_0x3a736e[_0x48c012(0x185)]}),_0x33d9b3=await master_shop[_0x48c012(0x18c)](),_0x33b673=await transfers_finished['findById'](_0x3fcd68[_0x48c012(0x1d4)]['id']);let _0x159bf6=new Date(_0x33b673[_0x48c012(0x1e3)]),_0x2b55fb=('0'+_0x159bf6[_0x48c012(0x183)]())['slice'](-0x2),_0x331c76=('0'+(_0x159bf6[_0x48c012(0x13c)]()+0x1))['slice'](-0x2),_0x364585=_0x159bf6[_0x48c012(0x17b)](),_0x2c5896=_0x364585+'-'+_0x331c76+'-'+_0x2b55fb,_0x59ff8c;if(_0x3a736e[_0x48c012(0x1bd)]=='staff'){const _0x3dbf31=await staff[_0x48c012(0x1c0)]({'email':_0x3a736e['email']});_0x59ff8c=await warehouse[_0x48c012(0x18c)]({'status':_0x48c012(0x15c),'name':_0x3dbf31[_0x48c012(0x139)],'warehouse_category':_0x48c012(0x18a)});}else _0x59ff8c=await warehouse[_0x48c012(0x18c)]({'status':_0x48c012(0x15c),'warehouse_category':_0x48c012(0x18a)});const _0x52dc87=await warehouse[_0x48c012(0x165)]([{'$match':{'name':_0x33b673['from_warehouse'],'room':_0x33b673['from_room']}},{'$unwind':_0x48c012(0x1cf)},{'$group':{'_id':_0x48c012(0x1ae),'name':{'$first':_0x48c012(0x154)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x48c012(0x1de)},'bin':{'$first':_0x48c012(0x18f)},'type':{'$first':_0x48c012(0x1f5)},'floorlevel':{'$first':_0x48c012(0x15d)},'primary_code':{'$first':_0x48c012(0x195)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x48c012(0x134)},'rack':{'$first':_0x48c012(0x186)}}}]);var _0x5added=[0x1,0x2,0x3,0x4],_0x112d0b=['A','B','C','D','E','F','G','H','I','J'],_0x62e72=[_0x48c012(0x16f),'Enclosed'];const _0x3b1e80=await product[_0x48c012(0x18c)]({}),_0xd249bc=BayBinSelected(_0x33b673[_0x48c012(0x15e)],_0x33b673[_0x48c012(0x1c8)]);if(_0x33d9b3[0x0][_0x48c012(0x171)]==_0x48c012(0x14a)){var _0x12f511=users[_0x48c012(0x1df)];console['log'](_0x12f511);}else{if(_0x33d9b3[0x0][_0x48c012(0x171)]==_0x48c012(0x142))var _0x12f511=users[_0x48c012(0x142)];else{if(_0x33d9b3[0x0][_0x48c012(0x171)]==_0x48c012(0x199))var _0x12f511=users[_0x48c012(0x199)];else{if(_0x33d9b3[0x0][_0x48c012(0x171)]==_0x48c012(0x1e9))var _0x12f511=users['Spanish'];else{if(_0x33d9b3[0x0]['language']=='French')var _0x12f511=users[_0x48c012(0x190)];else{if(_0x33d9b3[0x0]['language']==_0x48c012(0x1c7))var _0x12f511=users[_0x48c012(0x1e6)];else{if(_0x33d9b3[0x0]['language']=='Chinese')var _0x12f511=users[_0x48c012(0x1ea)];else{if(_0x33d9b3[0x0][_0x48c012(0x171)]==_0x48c012(0x1fc))var _0x12f511=users[_0x48c012(0x1fe)];}}}}}}}_0x2ecaed[_0x48c012(0x19a)]('edit_transfer_finished',{'success':_0x3fcd68[_0x48c012(0x1d1)](_0x48c012(0x1a5)),'errors':_0x3fcd68['flash']('errors'),'role':_0x3a736e,'profile':_0x3df363,'master_shop':_0x33d9b3,'warehouse':_0x59ff8c,'transfer':_0x33b673,'stock':_0x52dc87,'unit':_0x3b1e80,'language':_0x12f511,'levels':_0x5added,'Isle':_0x112d0b,'rooms_data':_0x62e72,'ed_fullDate':_0x2c5896,'dataSelected':_0xd249bc});}catch(_0x324eaa){console[_0x48c012(0x136)](_0x324eaa);}}),router[a0_0x3f5a48(0x182)](a0_0x3f5a48(0x1ec),auth,async(_0x1c9f6d,_0x3ee10c)=>{var _0x75a4cb=a0_0x3f5a48;try{const _0x4d5ca8=_0x1c9f6d['params']['id'];console[_0x75a4cb(0x136)](_0x1c9f6d['body']);const _0x4d4a76=await transfers_finished['findById'](_0x4d5ca8);console['log']('transfer_data',_0x4d4a76);const {date:_0x47cc5b,from_warehouse:_0x5cfe68,FromRoom_name:_0x178ccf,to_warehouse:_0x33190,ToRoom_name:_0x571e6f,prod_name:_0x2ce362,from_prod_qty:_0x260554,from_prod_level:_0x5391f2,from_prod_isle:_0x2c4b53,from_prod_pallet:_0x3817a5,to_prod_qty:_0x545840,to_prod_level:_0x4c669,to_prod_isle:_0x45333b,to_prod_pallet:_0x16e15e,primary_code:_0x34739d,secondary_code:_0x2efcfe,product_code3:_0x1887b7,note:_0x40845a,invoice:_0x2ffbba,expiry_date:_0xcba397}=_0x1c9f6d[_0x75a4cb(0x1f1)];if(typeof _0x2ce362==_0x75a4cb(0x1e4))var _0x5ced94=[_0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x156)]],_0x5f383c=[_0x1c9f6d['body'][_0x75a4cb(0x194)]],_0x58508=[_0x1c9f6d[_0x75a4cb(0x1f1)]['from_prod_level']],_0x337376=[_0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x135)]],_0x225eb7=[_0x1c9f6d[_0x75a4cb(0x1f1)]['to_prod_level']],_0xc585f2=[_0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x1a6)]],_0x478688=[_0x1c9f6d['body'][_0x75a4cb(0x1c4)]],_0x43e3b3=[_0x1c9f6d['body']['product_code3']],_0x2e5a61=[_0x1c9f6d['body'][_0x75a4cb(0x1c1)]],_0x24e58b=[_0x1c9f6d['body'][_0x75a4cb(0x149)]],_0x4a403c=[_0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x1a8)]],_0x39fdb2=[_0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x18d)]],_0x591ccd=[_0x1c9f6d['body'][_0x75a4cb(0x1e3)]];else var _0x5ced94=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x156)]],_0x5f383c=[..._0x1c9f6d['body'][_0x75a4cb(0x194)]],_0x58508=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x155)]],_0x337376=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x135)]],_0x225eb7=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x1bc)]],_0xc585f2=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x1a6)]],_0x478688=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x1c4)]],_0x43e3b3=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x1f3)]],_0x2e5a61=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x1c1)]],_0x24e58b=[..._0x1c9f6d[_0x75a4cb(0x1f1)][_0x75a4cb(0x149)]],_0x4a403c=[..._0x1c9f6d[_0x75a4cb(0x1f1)]['secondary_unit']],_0x39fdb2=[..._0x1c9f6d['body']['batch_code']],_0x591ccd=[..._0x1c9f6d[_0x75a4cb(0x1f1)]['expiry_date']];const _0x3e57a3=_0x5ced94[_0x75a4cb(0x196)](_0x4ac400=>{return _0x4ac400={'product_name':_0x4ac400};});_0x5f383c[_0x75a4cb(0x1dd)]((_0x2f67db,_0x5c8081)=>{var _0x564042=_0x75a4cb;_0x3e57a3[_0x5c8081][_0x564042(0x19f)]=_0x2f67db;}),_0x58508[_0x75a4cb(0x1dd)]((_0x5b4f2e,_0x2bce7c)=>{var _0x2d1b31=_0x75a4cb;_0x3e57a3[_0x2bce7c][_0x2d1b31(0x174)]=_0x5b4f2e;}),_0x337376[_0x75a4cb(0x1dd)]((_0xac8c80,_0x2c2f57)=>{_0x3e57a3[_0x2c2f57]['to_quantity']=_0xac8c80;}),_0x225eb7[_0x75a4cb(0x1dd)]((_0x5be553,_0x6b07e4)=>{var _0x33187e=_0x75a4cb;_0x3e57a3[_0x6b07e4][_0x33187e(0x153)]=_0x5be553;}),_0xc585f2[_0x75a4cb(0x1dd)]((_0x3cd4e6,_0x2a6ed2)=>{var _0x3cd7c7=_0x75a4cb;_0x3e57a3[_0x2a6ed2][_0x3cd7c7(0x1a6)]=_0x3cd4e6;}),_0x478688['forEach']((_0x5ed605,_0x59122c)=>{_0x3e57a3[_0x59122c]['secondary_code']=_0x5ed605;}),_0x43e3b3[_0x75a4cb(0x1dd)]((_0x23a94f,_0x5ec4fa)=>{var _0x2af316=_0x75a4cb;_0x3e57a3[_0x5ec4fa][_0x2af316(0x1d9)]=_0x23a94f;}),_0x2e5a61['forEach']((_0x1623c2,_0xed6838)=>{var _0x44b7ae=_0x75a4cb;_0x3e57a3[_0xed6838][_0x44b7ae(0x1d0)]=_0x1623c2;}),_0x24e58b[_0x75a4cb(0x1dd)]((_0x3b4c31,_0x23959b)=>{var _0x4860c2=_0x75a4cb;_0x3e57a3[_0x23959b][_0x4860c2(0x149)]=_0x3b4c31;}),_0x4a403c['forEach']((_0x5a392f,_0x220714)=>{var _0x49b932=_0x75a4cb;_0x3e57a3[_0x220714][_0x49b932(0x1a8)]=_0x5a392f;}),_0x39fdb2[_0x75a4cb(0x1dd)]((_0x27b22f,_0x36ac33)=>{var _0x2df265=_0x75a4cb;_0x3e57a3[_0x36ac33][_0x2df265(0x18d)]=_0x27b22f;}),_0x591ccd[_0x75a4cb(0x1dd)]((_0x32f983,_0x344987)=>{_0x3e57a3[_0x344987]['expiry_date']=_0x32f983;});const _0xfd211a=_0x3e57a3[_0x75a4cb(0x1b8)](_0x2fbaa7=>_0x2fbaa7['to_quantity']!=='0'&&_0x2fbaa7[_0x75a4cb(0x1cc)]!==''||_0x2fbaa7['to_floorlevel']!=='0'&&_0x2fbaa7[_0x75a4cb(0x184)]!=='');var _0x576295=0x0;_0xfd211a[_0x75a4cb(0x1dd)](_0x377dcc=>{var _0x1d8039=_0x75a4cb;parseInt(_0x377dcc['from_quantity'])<parseInt(_0x377dcc[_0x1d8039(0x1cc)])&&_0x576295++;});if(_0x576295!=0x0)return _0x1c9f6d[_0x75a4cb(0x1d1)](_0x75a4cb(0x1e2),_0x75a4cb(0x1a7)),_0x3ee10c[_0x75a4cb(0x1bb)]('back');const _0x5bff49=await warehouse['findOne']({'name':_0x4d4a76[_0x75a4cb(0x1db)],'room':_0x4d4a76[_0x75a4cb(0x198)]});_0x4d4a76[_0x75a4cb(0x160)]['forEach'](_0x44713b=>{var _0x32cfed=_0x75a4cb;if(_0x44713b[_0x32cfed(0x1cc)]>0x0){const _0x1eb230=_0x5bff49['product_details'][_0x32cfed(0x196)](_0x1c3e0b=>{var _0x1da5e1=_0x32cfed;_0x1c3e0b[_0x1da5e1(0x181)]==_0x44713b[_0x1da5e1(0x181)]&&_0x1c3e0b[_0x1da5e1(0x148)]==_0x44713b[_0x1da5e1(0x174)]&&(_0x1c3e0b['product_stock']=parseInt(_0x1c3e0b[_0x1da5e1(0x1be)])+parseInt(_0x44713b[_0x1da5e1(0x1cc)]));});}}),await _0x5bff49[_0x75a4cb(0x201)]();const _0x4e1cd7=await warehouse['findOne']({'name':_0x4d4a76[_0x75a4cb(0x15e)],'room':_0x4d4a76[_0x75a4cb(0x1c8)]});_0x4d4a76[_0x75a4cb(0x160)][_0x75a4cb(0x1dd)](_0x236933=>{var _0x27176f=_0x75a4cb;if(_0x236933['to_quantity']>0x0){const _0x814b91=_0x4e1cd7[_0x27176f(0x1b7)]['map'](_0x349e6f=>{var _0x31d454=_0x27176f;_0x349e6f[_0x31d454(0x181)]==_0x236933[_0x31d454(0x181)]&&_0x349e6f[_0x31d454(0x148)]==_0x236933[_0x31d454(0x153)]&&(_0x349e6f[_0x31d454(0x1be)]=parseInt(_0x349e6f[_0x31d454(0x1be)])-parseInt(_0x236933['to_quantity']));});}}),await _0x4e1cd7[_0x75a4cb(0x201)](),_0x4d4a76[_0x75a4cb(0x1ca)]=_0x47cc5b,_0x4d4a76['from_warehouse']=_0x5cfe68,_0x4d4a76[_0x75a4cb(0x15e)]=_0x33190,_0x4d4a76[_0x75a4cb(0x160)]=_0xfd211a,_0x4d4a76[_0x75a4cb(0x1e7)]=_0x40845a,_0x4d4a76['invoice']=_0x2ffbba;const _0x590024=await _0x4d4a76[_0x75a4cb(0x201)](),_0x4044a6=await warehouse[_0x75a4cb(0x1c0)]({'name':_0x5cfe68,'room':_0x178ccf});_0x590024[_0x75a4cb(0x160)]['forEach'](_0x41f325=>{var _0x591724=_0x75a4cb;if(_0x41f325[_0x591724(0x1cc)]>0x0){const _0x281b17=_0x4044a6[_0x591724(0x1b7)][_0x591724(0x196)](_0x10c75d=>{var _0x4dbd8b=_0x591724;_0x10c75d[_0x4dbd8b(0x181)]==_0x41f325[_0x4dbd8b(0x181)]&&_0x10c75d[_0x4dbd8b(0x148)]==_0x41f325[_0x4dbd8b(0x174)]&&(_0x10c75d[_0x4dbd8b(0x1be)]=parseInt(_0x10c75d[_0x4dbd8b(0x1be)])-parseInt(_0x41f325['to_quantity']));});}}),await _0x4044a6[_0x75a4cb(0x201)]();const _0x25912b=await warehouse['findOne']({'name':_0x33190,'room':_0x571e6f});_0x590024[_0x75a4cb(0x160)][_0x75a4cb(0x1dd)](_0x346be7=>{var _0x3ef3e5=_0x75a4cb;if(_0x346be7['to_quantity']>0x0){var _0x324049=0x0;const _0xda31a6=_0x25912b[_0x3ef3e5(0x1b7)][_0x3ef3e5(0x196)](_0x8ee241=>{var _0x4b8132=_0x3ef3e5;_0x8ee241['product_name']==_0x346be7['product_name']&&_0x8ee241['bay']==_0x346be7[_0x4b8132(0x153)]&&(_0x8ee241[_0x4b8132(0x1be)]=parseInt(_0x8ee241[_0x4b8132(0x1be)])+parseInt(_0x346be7[_0x4b8132(0x1cc)]),_0x324049++);});_0x324049=='0'&&(_0x25912b[_0x3ef3e5(0x1b7)]=_0x25912b[_0x3ef3e5(0x1b7)][_0x3ef3e5(0x1a4)]({'product_name':_0x346be7[_0x3ef3e5(0x181)],'product_stock':_0x346be7['to_quantity'],'bay':_0x346be7[_0x3ef3e5(0x153)],'product_code':_0x346be7['product_code'],'primary_code':_0x346be7['primary_code'],'secondary_code':_0x346be7[_0x3ef3e5(0x1c4)],'maxProducts':_0x346be7[_0x3ef3e5(0x1d0)]}));}}),await _0x25912b[_0x75a4cb(0x201)](),_0x1c9f6d[_0x75a4cb(0x1d1)](_0x75a4cb(0x1a5),'Transfer\x20Edit\x20Successfully'),_0x3ee10c[_0x75a4cb(0x1bb)](_0x75a4cb(0x1c6));}catch(_0x199cdc){console['log'](_0x199cdc);}}),router['post'](a0_0x3f5a48(0x1ee),async(_0x3c5864,_0xdee2f6)=>{var _0x502cd4=a0_0x3f5a48;const {FromWareHouse:_0x3b31aa,FromRoom:_0x1b2b21,ToWarehouse:_0xb06ff5,ToRoom:_0xe04ddf,primary_code:_0x4e5b3c,Roomslist:_0x28b326}=_0x3c5864[_0x502cd4(0x1f1)],_0x4bb942=_0x28b326[_0x502cd4(0x1f4)](','),_0x3a8d3d=[];async function _0x572f0e(_0x14a824){var _0x2f142a=_0x502cd4;const _0x28c4b1=await warehouse['aggregate']([{'$match':{'name':_0x3b31aa,'room':_0x14a824}},{'$unwind':_0x2f142a(0x1cf)},{'$match':{'product_details.primary_code':_0x4e5b3c}},{'$group':{'_id':_0x2f142a(0x1ae),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x2f142a(0x1da)},'primary_code':{'$first':_0x2f142a(0x195)},'secondary_code':{'$first':_0x2f142a(0x1fa)},'product_code':{'$first':_0x2f142a(0x13d)},'bay':{'$first':_0x2f142a(0x1de)},'level':{'$first':_0x2f142a(0x15b)},'type':{'$first':_0x2f142a(0x1f5)},'pallet':{'$first':_0x2f142a(0x15d)},'unit':{'$first':_0x2f142a(0x1bf)},'secondary_unit':{'$first':_0x2f142a(0x1aa)},'storage':{'$first':_0x2f142a(0x134)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2f142a(0x158)},'production_date':{'$first':_0x2f142a(0x1f6)},'batch_code':{'$first':_0x2f142a(0x1b0)},'maxPerUnit':{'$first':_0x2f142a(0x147)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x2f142a(0x1ad)}}}]),_0x5e8782=await warehouse[_0x2f142a(0x165)]([{'$match':{'name':_0x3b31aa,'room':_0x14a824}},{'$unwind':_0x2f142a(0x1cf)},{'$match':{'product_details.secondary_code':_0x4e5b3c}},{'$group':{'_id':_0x2f142a(0x1ae),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2f142a(0x195)},'secondary_code':{'$first':_0x2f142a(0x1fa)},'product_code':{'$first':_0x2f142a(0x13d)},'bay':{'$first':_0x2f142a(0x1de)},'level':{'$first':_0x2f142a(0x15b)},'type':{'$first':_0x2f142a(0x1f5)},'pallet':{'$first':_0x2f142a(0x15d)},'unit':{'$first':_0x2f142a(0x1bf)},'secondary_unit':{'$first':_0x2f142a(0x1aa)},'storage':{'$first':_0x2f142a(0x134)},'rack':{'$first':_0x2f142a(0x186)},'expiry_date':{'$first':_0x2f142a(0x158)},'production_date':{'$first':_0x2f142a(0x1f6)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x2f142a(0x147)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x2f142a(0x1ad)}}}]);if(_0x28c4b1[_0x2f142a(0x187)]>0x0)_0x3a8d3d[_0x2f142a(0x14e)](_0x28c4b1);else _0x5e8782[_0x2f142a(0x187)]>0x0&&_0x3a8d3d[_0x2f142a(0x14e)](_0x5e8782);}const _0x27c2bf=_0x4bb942[_0x502cd4(0x196)](_0x2ad0d9=>_0x572f0e(_0x2ad0d9));await Promise[_0x502cd4(0x1ef)](_0x27c2bf),_0xdee2f6['json'](_0x3a8d3d);}),router[a0_0x3f5a48(0x182)](a0_0x3f5a48(0x157),async(_0x1e8c25,_0x4330ba)=>{var _0x49ab2c=a0_0x3f5a48;const {productCode:_0x14fa3e,bay:_0x3c8ae4,warehouses:_0x1ab1df,room:_0x4a0940}=_0x1e8c25[_0x49ab2c(0x1f1)];console['log'](_0x1e8c25[_0x49ab2c(0x1f1)]);try{const _0x29451a=await warehouse[_0x49ab2c(0x165)]([{'$match':{'name':_0x1ab1df,'room':_0x4a0940}},{'$unwind':_0x49ab2c(0x1cf)},{'$match':{'product_details.bay':parseInt(_0x3c8ae4)}},{'$group':{'_id':_0x49ab2c(0x1ae),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x49ab2c(0x1da)},'bay':{'$first':_0x49ab2c(0x1de)},'maxProducts':{'$first':_0x49ab2c(0x15f)}}}]);_0x4330ba[_0x49ab2c(0x14f)](0xc8)[_0x49ab2c(0x1ba)](_0x29451a);}catch(_0x20f0f3){_0x4330ba[_0x49ab2c(0x14f)](0x194)[_0x49ab2c(0x1ba)]({'message':_0x20f0f3[_0x49ab2c(0x19b)]});}}),module[a0_0x3f5a48(0x1a3)]=router;