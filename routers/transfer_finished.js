var a0_0x445aec=a0_0x23c9;(function(_0x4c1694,_0x20d8dd){var _0x18bc22=a0_0x23c9,_0x16df8e=_0x4c1694();while(!![]){try{var _0x2ee5a8=-parseInt(_0x18bc22(0x124))/0x1*(-parseInt(_0x18bc22(0x15e))/0x2)+-parseInt(_0x18bc22(0x198))/0x3*(parseInt(_0x18bc22(0x193))/0x4)+-parseInt(_0x18bc22(0x158))/0x5+parseInt(_0x18bc22(0x1b8))/0x6*(parseInt(_0x18bc22(0x1c3))/0x7)+-parseInt(_0x18bc22(0x12a))/0x8*(parseInt(_0x18bc22(0x1d1))/0x9)+parseInt(_0x18bc22(0x1b4))/0xa+parseInt(_0x18bc22(0x195))/0xb*(-parseInt(_0x18bc22(0x1ce))/0xc);if(_0x2ee5a8===_0x20d8dd)break;else _0x16df8e['push'](_0x16df8e['shift']());}catch(_0x283fcf){_0x16df8e['push'](_0x16df8e['shift']());}}}(a0_0x26e1,0x91982));const express=require(a0_0x445aec(0x1c5)),app=express(),router=express[a0_0x445aec(0x171)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x445aec(0x136)),auth=require(a0_0x445aec(0x11d)),users=require(a0_0x445aec(0x157)),nodemailer=require(a0_0x445aec(0x186));function a0_0x23c9(_0x184e7b,_0x10921d){var _0x26e13f=a0_0x26e1();return a0_0x23c9=function(_0x23c9dc,_0x2cadb3){_0x23c9dc=_0x23c9dc-0x111;var _0x137d79=_0x26e13f[_0x23c9dc];return _0x137d79;},a0_0x23c9(_0x184e7b,_0x10921d);}function a0_0x26e1(){var _0x5539f0=['forEach','floor','invoice_init','Chinese','date','getMonth','product_date','$product_details._id','findOne','RoomAssigned','11131700qsdWxH','abs','type_of_process','from_prod_level','505578azQbMp','French','transfer_data','padStart','$finalize','Arabic','user','$product_details','save','from_invoice','get','91hTLnKg','$product_details.rack','express','Portuguese\x20(BR)','edit_transfer_finished_view','$product.from_room_name','Enabled','An\x20error\x20occurred.','prod_name','batch_code','from_prod_level2','7193748kKzBWE','to_quantity','English\x20(US)','4381362UUwKGe','MaxStocks_data2','$product_details.bin','redirect','$product_details.storage','updateOne','Spanish','status','from_prod_qty','prod_cat','expiry_date','match','ToRoomAssigned','secondary_unit','Enclosed','$product_details.maxProducts','Product\x20Transfer\x20successfully','../middleware/auth','filter','string','New_Qty_Converted','flash','product_name','back','53929mTqAzE','finalize','<tr>','German','$product_details.invoice','choos_transfer','16SLGRQR','to_room_name','/barcode_scanner','$date','/view/addlog','product_stock','\x20<=>\x20','$_id','Rack\x201','to_prod_qty','$product_details.floorlevel','To_invoice','../models/all_models','Portuguese','transfer_finished','Transfer\x20Finalize\x20Successfully','production_date','max','all','location2location','to_level','language','/view/add_transfer_loc','/view/choose_logs','push','getDate','</td>','from_bay','aggregate','then','$room','success','$product_details.expiry_date','toString','from_room_name','slice','$product_details.maxPerUnit','id_transaction','to_warehouse','logs','catch','concat','$product_details.bay','from_room','json','../public/language/languages.json','4729935BSGNYE','$name','bay','getFullYear','$product_details.secondary_code','product_details','36XWqMtg','An\x20error\x20occurred\x20while\x20saving\x20data.','to_prod_level','$product_details.product_stock','_id','/transfer_finished/preview/','$product_details.product_code','staff','own','$product_details.unit','Arabic\x20(ae)','/CheckingWarehouse','primary_unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','role','warehouse','product_code','/transfer_finished/view','LOG-TRF-','Router','Ambient','post','MaxStocks_data','exports','Rack\x202','primary_code','$invoice','English','product','$product_details.level','map','DRY\x20GOODS','$product.to_room_name','length','TRF-','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/view/choose','Finished\x20Goods','invoice','product_code3','nodemailer','render','from_level','message','log','body','from_quantity','to_bay','There\x27s\x20a\x20error\x20in\x20this\x20transaction','to_floorlevel','secondary_code','Hindi','/transfer/view','180DAeEwg','$product_details.type','11gnGdIz','$from_warehouse','maxProducts','4257BwxBqk','$product','$product_details.product_name','from_warehouse','to_room','error','bin2bin','unit','$product_details.production_date','TRFF-','findById','find','maxPerUnit','params','errors','/view/:id','$product_details.primary_code','email'];a0_0x26e1=function(){return _0x5539f0;};return a0_0x26e1();}router[a0_0x445aec(0x1c2)]('/view',auth,async(_0x19b542,_0x5ac3d6)=>{var _0x181522=a0_0x445aec;try{const {username:_0x4a2b25,email:_0x3f1ab2,role:_0x27e8a4}=_0x19b542[_0x181522(0x1be)],_0x44511d=_0x19b542[_0x181522(0x1be)],_0x17e5a5=await profile[_0x181522(0x1b2)]({'email':_0x44511d['email']}),_0x11cddd=await master_shop[_0x181522(0x1a3)]();let _0x2d87a2;if(_0x44511d[_0x181522(0x16c)]==_0x181522(0x165)){const _0x4c7cc5=await staff[_0x181522(0x1b2)]({'email':_0x44511d[_0x181522(0x1a9)]});_0x2d87a2=await transfers_finished[_0x181522(0x1a3)]({'from_warehouse':_0x4c7cc5[_0x181522(0x16d)]});}else _0x2d87a2=await transfers_finished[_0x181522(0x146)]([{'$match':{'type_of_transaction':_0x181522(0x166)}},{'$unwind':_0x181522(0x199)},{'$group':{'_id':_0x181522(0x131),'invoice':{'$first':'$invoice'},'date':{'$first':_0x181522(0x12d)},'from_warehouse':{'$first':_0x181522(0x196)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x181522(0x1c8)},'to_room_name':{'$addToSet':_0x181522(0x17e)},'finalize':{'$first':_0x181522(0x1bc)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x11cddd[0x0][_0x181522(0x13f)]==_0x181522(0x1d0))var _0x366464=users[_0x181522(0x179)];else{if(_0x11cddd[0x0][_0x181522(0x13f)]==_0x181522(0x191))var _0x366464=users[_0x181522(0x191)];else{if(_0x11cddd[0x0][_0x181522(0x13f)]=='German')var _0x366464=users['German'];else{if(_0x11cddd[0x0][_0x181522(0x13f)]=='Spanish')var _0x366464=users['Spanish'];else{if(_0x11cddd[0x0]['language']==_0x181522(0x1b9))var _0x366464=users[_0x181522(0x1b9)];else{if(_0x11cddd[0x0][_0x181522(0x13f)]==_0x181522(0x1c6))var _0x366464=users[_0x181522(0x137)];else{if(_0x11cddd[0x0][_0x181522(0x13f)]==_0x181522(0x1ad))var _0x366464=users['Chinese'];else{if(_0x11cddd[0x0][_0x181522(0x13f)]=='Arabic\x20(ae)')var _0x366464=users['Arabic'];}}}}}}}_0x5ac3d6[_0x181522(0x187)](_0x181522(0x138),{'success':_0x19b542[_0x181522(0x121)](_0x181522(0x149)),'errors':_0x19b542[_0x181522(0x121)](_0x181522(0x1a6)),'role':_0x44511d,'profile':_0x17e5a5,'master_shop':_0x11cddd,'transfer':_0x2d87a2,'language':_0x366464});}catch(_0x16c5a9){console[_0x181522(0x18a)](_0x16c5a9);}}),router['get']('/view_logs',auth,async(_0x102dd0,_0x438c44)=>{var _0x474725=a0_0x445aec;try{const {username:_0x471af0,email:_0x172a16,role:_0x2d8898}=_0x102dd0['user'],_0x1faffe=_0x102dd0[_0x474725(0x1be)],_0x19c3ec=await profile[_0x474725(0x1b2)]({'email':_0x1faffe[_0x474725(0x1a9)]}),_0x56b285=await master_shop[_0x474725(0x1a3)]();let _0x1f8896;if(_0x1faffe[_0x474725(0x16c)]=='staff'){const _0x351610=await staff['findOne']({'email':_0x1faffe['email']});_0x1f8896=await transfers_finished[_0x474725(0x1a3)]({'from_warehouse':_0x351610['warehouse']});}else _0x1f8896=await transfers_finished[_0x474725(0x146)]([{'$match':{'type_of_transaction':_0x474725(0x151)}},{'$unwind':_0x474725(0x199)},{'$group':{'_id':_0x474725(0x131),'invoice':{'$first':_0x474725(0x178)},'date':{'$first':_0x474725(0x12d)},'from_warehouse':{'$first':_0x474725(0x196)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x474725(0x17e)},'finalize':{'$first':_0x474725(0x1bc)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x56b285[0x0][_0x474725(0x13f)]==_0x474725(0x1d0))var _0x1a6a54=users[_0x474725(0x179)];else{if(_0x56b285[0x0]['language']==_0x474725(0x191))var _0x1a6a54=users[_0x474725(0x191)];else{if(_0x56b285[0x0][_0x474725(0x13f)]==_0x474725(0x127))var _0x1a6a54=users[_0x474725(0x127)];else{if(_0x56b285[0x0][_0x474725(0x13f)]==_0x474725(0x112))var _0x1a6a54=users[_0x474725(0x112)];else{if(_0x56b285[0x0][_0x474725(0x13f)]==_0x474725(0x1b9))var _0x1a6a54=users[_0x474725(0x1b9)];else{if(_0x56b285[0x0][_0x474725(0x13f)]=='Portuguese\x20(BR)')var _0x1a6a54=users['Portuguese'];else{if(_0x56b285[0x0][_0x474725(0x13f)]==_0x474725(0x1ad))var _0x1a6a54=users[_0x474725(0x1ad)];else{if(_0x56b285[0x0]['language']==_0x474725(0x168))var _0x1a6a54=users[_0x474725(0x1bd)];}}}}}}}_0x438c44['render']('transfer_finished_logs',{'success':_0x102dd0[_0x474725(0x121)]('success'),'errors':_0x102dd0[_0x474725(0x121)]('errors'),'role':_0x1faffe,'profile':_0x19c3ec,'master_shop':_0x56b285,'transfer':_0x1f8896,'language':_0x1a6a54});}catch(_0x33f407){console[_0x474725(0x18a)](_0x33f407);}});async function getRandom8DigitNumber(){var _0x2c206c=a0_0x445aec;const _0x40fda6=0x989680,_0x324a21=0x5f5e0ff,_0x34b553=Math[_0x2c206c(0x1ab)](Math['random']()*(_0x324a21-_0x40fda6+0x1))+_0x40fda6;var _0x33fcee;const _0x3f0c37=await transfers_finished[_0x2c206c(0x1b2)]({'invoice':'TRFF-'+_0x34b553});return _0x3f0c37&&_0x3f0c37['length']>0x0?_0x33fcee='TRFF-'+_0x34b553:_0x33fcee=_0x2c206c(0x1a1)+_0x34b553,_0x33fcee;}router[a0_0x445aec(0x1c2)]('/view/add_transfer',auth,async(_0x16a93d,_0x51dc5a)=>{var _0x4e4f6d=a0_0x445aec;try{const {username:_0x285a0c,email:_0x6d6004,role:_0x20f48d}=_0x16a93d[_0x4e4f6d(0x1be)],_0x16c9dc=_0x16a93d[_0x4e4f6d(0x1be)],_0xac1e33=await profile[_0x4e4f6d(0x1b2)]({'email':_0x16c9dc[_0x4e4f6d(0x1a9)]}),_0x4c1971=await master_shop[_0x4e4f6d(0x1a3)]();let _0x1835a3;if(_0x16c9dc['role']=='staff'){const _0x4a3be1=await staff[_0x4e4f6d(0x1b2)]({'email':_0x16c9dc[_0x4e4f6d(0x1a9)]});_0x1835a3=await warehouse[_0x4e4f6d(0x146)]([{'$match':{'status':_0x4e4f6d(0x1c9),'name':_0x4a3be1[_0x4e4f6d(0x16d)]}},{'$group':{'_id':'$name','name':{'$first':_0x4e4f6d(0x159)}}}]);}else _0x1835a3=await warehouse[_0x4e4f6d(0x146)]([{'$match':{'status':_0x4e4f6d(0x1c9)}},{'$group':{'_id':_0x4e4f6d(0x159),'name':{'$first':'$name'}}}]);const _0x26d803=await transfers_finished[_0x4e4f6d(0x1a3)]({}),_0x43927f=_0x26d803['length']+0x1,_0x20c989='TRFF-'+_0x43927f[_0x4e4f6d(0x14b)]()[_0x4e4f6d(0x1bb)](0x5,'0');if(_0x4c1971[0x0][_0x4e4f6d(0x13f)]==_0x4e4f6d(0x1d0))var _0x51248b=users['English'];else{if(_0x4c1971[0x0][_0x4e4f6d(0x13f)]==_0x4e4f6d(0x191))var _0x51248b=users[_0x4e4f6d(0x191)];else{if(_0x4c1971[0x0]['language']==_0x4e4f6d(0x127))var _0x51248b=users[_0x4e4f6d(0x127)];else{if(_0x4c1971[0x0]['language']==_0x4e4f6d(0x112))var _0x51248b=users['Spanish'];else{if(_0x4c1971[0x0][_0x4e4f6d(0x13f)]==_0x4e4f6d(0x1b9))var _0x51248b=users[_0x4e4f6d(0x1b9)];else{if(_0x4c1971[0x0][_0x4e4f6d(0x13f)]=='Portuguese\x20(BR)')var _0x51248b=users[_0x4e4f6d(0x137)];else{if(_0x4c1971[0x0]['language']==_0x4e4f6d(0x1ad))var _0x51248b=users[_0x4e4f6d(0x1ad)];else{if(_0x4c1971[0x0]['language']==_0x4e4f6d(0x168))var _0x51248b=users[_0x4e4f6d(0x1bd)];}}}}}}}const _0x583591=getRandom8DigitNumber();_0x583591[_0x4e4f6d(0x147)](_0x269603=>{var _0x26f619=_0x4e4f6d;_0x51dc5a['render']('add_transfer_finished',{'success':_0x16a93d[_0x26f619(0x121)]('success'),'errors':_0x16a93d[_0x26f619(0x121)](_0x26f619(0x1a6)),'role':_0x16c9dc,'profile':_0xac1e33,'master_shop':_0x4c1971,'warehouse':_0x1835a3,'language':_0x51248b,'invoice':_0x269603});})[_0x4e4f6d(0x152)](_0x419739=>{var _0x8c2da9=_0x4e4f6d;_0x16a93d[_0x8c2da9(0x121)](_0x8c2da9(0x1a6),_0x8c2da9(0x18e)),_0x51dc5a['redirect'](_0x8c2da9(0x192));});}catch(_0x373d93){console[_0x4e4f6d(0x18a)](_0x373d93);}}),router[a0_0x445aec(0x1c2)](a0_0x445aec(0x182),auth,async(_0x438105,_0x1b92cc)=>{var _0x56a7f7=a0_0x445aec;try{const {username:_0x2aba26,email:_0x1bbece,role:_0x3cfb3f}=_0x438105['user'],_0x2d3ab6=_0x438105['user'],_0x367258=await profile['findOne']({'email':_0x2d3ab6[_0x56a7f7(0x1a9)]}),_0x46a8db=await master_shop[_0x56a7f7(0x1a3)]();let _0x5cbd5a;if(_0x2d3ab6[_0x56a7f7(0x16c)]=='staff'){const _0x29b58f=await staff[_0x56a7f7(0x1b2)]({'email':_0x2d3ab6['email']});_0x5cbd5a=await warehouse['aggregate']([{'$match':{'status':_0x56a7f7(0x1c9),'name':_0x29b58f[_0x56a7f7(0x16d)]}},{'$group':{'_id':'$name','name':{'$first':_0x56a7f7(0x159)}}}]);}else _0x5cbd5a=await warehouse[_0x56a7f7(0x146)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x56a7f7(0x159),'name':{'$first':_0x56a7f7(0x159)}}}]);const _0x4bf1f5=await transfers_finished['find']({}),_0x27d3e8=_0x4bf1f5[_0x56a7f7(0x17f)]+0x1,_0x3da1f6=_0x56a7f7(0x1a1)+_0x27d3e8['toString']()['padStart'](0x5,'0');if(_0x46a8db[0x0][_0x56a7f7(0x13f)]==_0x56a7f7(0x1d0))var _0x564b79=users[_0x56a7f7(0x179)];else{if(_0x46a8db[0x0]['language']==_0x56a7f7(0x191))var _0x564b79=users[_0x56a7f7(0x191)];else{if(_0x46a8db[0x0][_0x56a7f7(0x13f)]==_0x56a7f7(0x127))var _0x564b79=users[_0x56a7f7(0x127)];else{if(_0x46a8db[0x0][_0x56a7f7(0x13f)]=='Spanish')var _0x564b79=users[_0x56a7f7(0x112)];else{if(_0x46a8db[0x0]['language']==_0x56a7f7(0x1b9))var _0x564b79=users['French'];else{if(_0x46a8db[0x0]['language']==_0x56a7f7(0x1c6))var _0x564b79=users[_0x56a7f7(0x137)];else{if(_0x46a8db[0x0][_0x56a7f7(0x13f)]==_0x56a7f7(0x1ad))var _0x564b79=users[_0x56a7f7(0x1ad)];else{if(_0x46a8db[0x0][_0x56a7f7(0x13f)]=='Arabic\x20(ae)')var _0x564b79=users[_0x56a7f7(0x1bd)];}}}}}}}const _0x510d7a=getRandom8DigitNumber();_0x510d7a['then'](_0x15cc9c=>{var _0x3e0a67=_0x56a7f7;_0x1b92cc[_0x3e0a67(0x187)](_0x3e0a67(0x129),{'success':_0x438105['flash'](_0x3e0a67(0x149)),'errors':_0x438105['flash']('errors'),'role':_0x2d3ab6,'profile':_0x367258,'master_shop':_0x46a8db,'warehouse':_0x5cbd5a,'language':_0x564b79,'invoice':_0x15cc9c});})[_0x56a7f7(0x152)](_0x5ac61b=>{var _0x199f41=_0x56a7f7;_0x438105[_0x199f41(0x121)]('errors',_0x199f41(0x18e)),_0x1b92cc[_0x199f41(0x1d4)](_0x199f41(0x192));});}catch(_0x250172){console[_0x56a7f7(0x18a)](_0x250172);}}),router['get'](a0_0x445aec(0x141),auth,async(_0x2f8712,_0xd7b38a)=>{var _0x5973f1=a0_0x445aec;try{const {username:_0x341435,email:_0x421496,role:_0x1b7dc2}=_0x2f8712['user'],_0x1594b1=_0x2f8712[_0x5973f1(0x1be)],_0x3b8fa1=await profile[_0x5973f1(0x1b2)]({'email':_0x1594b1['email']}),_0x1ae15e=await master_shop[_0x5973f1(0x1a3)]();let _0x93f749;if(_0x1594b1[_0x5973f1(0x16c)]==_0x5973f1(0x165)){const _0x32bdf3=await staff[_0x5973f1(0x1b2)]({'email':_0x1594b1[_0x5973f1(0x1a9)]});_0x93f749=await warehouse['aggregate']([{'$match':{'status':_0x5973f1(0x1c9),'name':_0x32bdf3[_0x5973f1(0x16d)]}},{'$group':{'_id':'$name','name':{'$first':_0x5973f1(0x159)}}}]);}else _0x93f749=await warehouse['aggregate']([{'$match':{'status':_0x5973f1(0x1c9)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x4accba=await transfers_finished[_0x5973f1(0x1a3)]({}),_0x21f3a6=_0x4accba[_0x5973f1(0x17f)]+0x1,_0x122934=_0x5973f1(0x1a1)+_0x21f3a6['toString']()[_0x5973f1(0x1bb)](0x5,'0');if(_0x1ae15e[0x0][_0x5973f1(0x13f)]=='English\x20(US)')var _0x48fdde=users[_0x5973f1(0x179)];else{if(_0x1ae15e[0x0][_0x5973f1(0x13f)]==_0x5973f1(0x191))var _0x48fdde=users[_0x5973f1(0x191)];else{if(_0x1ae15e[0x0]['language']==_0x5973f1(0x127))var _0x48fdde=users['German'];else{if(_0x1ae15e[0x0][_0x5973f1(0x13f)]==_0x5973f1(0x112))var _0x48fdde=users[_0x5973f1(0x112)];else{if(_0x1ae15e[0x0][_0x5973f1(0x13f)]==_0x5973f1(0x1b9))var _0x48fdde=users['French'];else{if(_0x1ae15e[0x0][_0x5973f1(0x13f)]=='Portuguese\x20(BR)')var _0x48fdde=users[_0x5973f1(0x137)];else{if(_0x1ae15e[0x0][_0x5973f1(0x13f)]==_0x5973f1(0x1ad))var _0x48fdde=users[_0x5973f1(0x1ad)];else{if(_0x1ae15e[0x0][_0x5973f1(0x13f)]==_0x5973f1(0x168))var _0x48fdde=users['Arabic'];}}}}}}}const _0xb1a8ca=getRandom8DigitNumber();_0xb1a8ca[_0x5973f1(0x147)](_0xfb6bf7=>{var _0x12e92f=_0x5973f1;_0xd7b38a[_0x12e92f(0x187)]('choos_transfer_logs',{'success':_0x2f8712[_0x12e92f(0x121)](_0x12e92f(0x149)),'errors':_0x2f8712[_0x12e92f(0x121)](_0x12e92f(0x1a6)),'role':_0x1594b1,'profile':_0x3b8fa1,'master_shop':_0x1ae15e,'warehouse':_0x93f749,'language':_0x48fdde,'invoice':_0xfb6bf7});})[_0x5973f1(0x152)](_0x96703c=>{var _0x46974c=_0x5973f1;_0x2f8712[_0x46974c(0x121)](_0x46974c(0x1a6),_0x46974c(0x18e)),_0xd7b38a['redirect']('/transfer/view');});}catch(_0x4d87a8){console[_0x5973f1(0x18a)](_0x4d87a8);}}),router[a0_0x445aec(0x173)]('/view/add_transfer_logs',auth,async(_0x1d6f9b,_0x1379ab)=>{var _0x2c2dba=a0_0x445aec;try{const {date:_0x125b92,from_warehouse:_0x5bc24c,FromRoom_name:_0x4c7d00,to_warehouse:_0x2ca28b,ToRoom_name:_0x4dd142,prod_name:_0x323707,from_prod_qty:_0xeab641,from_prod_level:_0x37e15c,from_prod_isle:_0x5c3b48,from_prod_pallet:_0x21b9e0,to_prod_qty:_0xbba261,to_prod_level:_0x47b57a,to_prod_isle:_0x3a7a97,to_prod_pallet:_0x51f919,primary_code:_0x24477b,secondary_code:_0x697a3d,product_code3:_0x55ccf6,note:_0x2296da,MaxStocks_data2:_0x2a0245,invoice:_0x1caa58,expiry_date:_0x54dcd3,PO_number:_0x2ea8f9,ReqBy:_0x4cfb31,dateofreq:_0x22e124,typeservicesData:_0x13ed63,destination:_0x1b9094,deliverydate:_0x22a74a,driver:_0x4b2412,plate:_0x73c9e1,van:_0x51fb75,DRSI:_0x415228,typevehicle:_0x185c53,TSU:_0x233bf9,TFU:_0x1dbb35}=_0x1d6f9b[_0x2c2dba(0x18b)];if(typeof _0x323707==_0x2c2dba(0x11f))var _0x17e938=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1cb)]],_0x338582=[_0x1d6f9b['body'][_0x2c2dba(0x114)]],_0x45272e=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1cd)]],_0x4130e9=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x120)]],_0x407606=[_0x1d6f9b['body'][_0x2c2dba(0x160)]],_0x4d0fde=[_0x1d6f9b['body']['primary_code']],_0x138ef7=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x190)]],_0x415e1e=[_0x1d6f9b['body'][_0x2c2dba(0x185)]],_0x1ee9b7=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1d2)]],_0x16b7cc=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x16a)]],_0x29b0ee=[_0x1d6f9b['body'][_0x2c2dba(0x119)]],_0x3eebe2=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1cc)]],_0x1b73c0=[_0x1d6f9b['body'][_0x2c2dba(0x116)]],_0x2b13ff=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1b0)]],_0x1bb882=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x174)]],_0x3e999d=[_0x1d6f9b['body'][_0x2c2dba(0x1a4)]],_0x55e902=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x115)]],_0x23f7d0=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1b3)]],_0x190d66=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x118)]],_0x239d59=[_0x1d6f9b['body'][_0x2c2dba(0x1c1)]],_0x44e0aa=[_0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x14f)]];else var _0x17e938=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1cb)]],_0x338582=[..._0x1d6f9b[_0x2c2dba(0x18b)]['from_prod_qty']],_0x45272e=[..._0x1d6f9b['body'][_0x2c2dba(0x1cd)]],_0x4130e9=[..._0x1d6f9b['body'][_0x2c2dba(0x120)]],_0x407606=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x160)]],_0x4d0fde=[..._0x1d6f9b['body']['primary_code']],_0x138ef7=[..._0x1d6f9b['body'][_0x2c2dba(0x190)]],_0x415e1e=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x185)]],_0x1ee9b7=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1d2)]],_0x16b7cc=[..._0x1d6f9b[_0x2c2dba(0x18b)]['primary_unit']],_0x29b0ee=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x119)]],_0x3eebe2=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1cc)]],_0x1b73c0=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x116)]],_0x2b13ff=[..._0x1d6f9b[_0x2c2dba(0x18b)]['product_date']],_0x1bb882=[..._0x1d6f9b[_0x2c2dba(0x18b)]['MaxStocks_data']],_0x3e999d=[..._0x1d6f9b[_0x2c2dba(0x18b)]['maxPerUnit']],_0x55e902=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x115)]],_0x23f7d0=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x1b3)]],_0x190d66=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x118)]],_0x239d59=[..._0x1d6f9b['body'][_0x2c2dba(0x1c1)]],_0x44e0aa=[..._0x1d6f9b[_0x2c2dba(0x18b)][_0x2c2dba(0x14f)]];const _0x320ae6=_0x17e938['map'](_0x189e1d=>{return _0x189e1d={'product_name':_0x189e1d};});_0x338582['forEach']((_0x3c5c54,_0x78e9ed)=>{var _0x188129=_0x2c2dba;_0x320ae6[_0x78e9ed][_0x188129(0x18c)]=_0x3c5c54;}),_0x45272e[_0x2c2dba(0x1aa)]((_0xc954ee,_0x493f70)=>{var _0x1f88c8=_0x2c2dba,_0x60ff06=_0xc954ee[_0x1f88c8(0x117)](/[A-Za-z]+/)[0x0],_0x32515c=parseInt(_0xc954ee['match'](/\d+/)[0x0]);_0x320ae6[_0x493f70][_0x1f88c8(0x145)]=_0x32515c,_0x320ae6[_0x493f70]['from_level']=_0x60ff06;}),_0x44e0aa[_0x2c2dba(0x1aa)]((_0x3d1b1a,_0x2fc50d)=>{_0x320ae6[_0x2fc50d]['id_transaction']=_0x3d1b1a;}),_0x239d59[_0x2c2dba(0x1aa)]((_0x36f1be,_0x3f56a0)=>{_0x320ae6[_0x3f56a0]['from_invoice']=_0x36f1be;}),_0x4130e9[_0x2c2dba(0x1aa)]((_0x46516e,_0x33d551)=>{var _0x3c6212=_0x2c2dba;_0x320ae6[_0x33d551][_0x3c6212(0x1cf)]=_0x46516e;}),_0x407606['forEach']((_0x57a728,_0x2bee45)=>{var _0x1393c0=_0x2c2dba,_0x455e86=_0x57a728[_0x1393c0(0x117)](/[A-Za-z]+/)[0x0],_0x4389c=parseInt(_0x57a728['match'](/\d+/)[0x0]);_0x320ae6[_0x2bee45][_0x1393c0(0x13e)]=_0x455e86,_0x320ae6[_0x2bee45][_0x1393c0(0x18d)]=_0x4389c;}),_0x4d0fde[_0x2c2dba(0x1aa)]((_0x55506d,_0x48baea)=>{var _0x45afd9=_0x2c2dba;_0x320ae6[_0x48baea][_0x45afd9(0x177)]=_0x55506d;}),_0x138ef7[_0x2c2dba(0x1aa)]((_0x113d0b,_0x5cb1bf)=>{_0x320ae6[_0x5cb1bf]['secondary_code']=_0x113d0b;}),_0x415e1e['forEach']((_0x525c33,_0x1e4371)=>{var _0x139871=_0x2c2dba;_0x320ae6[_0x1e4371][_0x139871(0x16e)]=_0x525c33;}),_0x1ee9b7['forEach']((_0x360b79,_0x49b888)=>{var _0x1927d6=_0x2c2dba;_0x320ae6[_0x49b888][_0x1927d6(0x197)]=_0x360b79;}),_0x16b7cc['forEach']((_0x562c51,_0x243e2b)=>{var _0x577372=_0x2c2dba;_0x320ae6[_0x243e2b][_0x577372(0x19f)]=_0x562c51;}),_0x29b0ee['forEach']((_0x40aa65,_0x3e1c18)=>{var _0x23f794=_0x2c2dba;_0x320ae6[_0x3e1c18][_0x23f794(0x119)]=_0x40aa65;}),_0x3eebe2[_0x2c2dba(0x1aa)]((_0x247837,_0x4c7639)=>{var _0x3b31a5=_0x2c2dba;_0x320ae6[_0x4c7639][_0x3b31a5(0x1cc)]=_0x247837;}),_0x1b73c0[_0x2c2dba(0x1aa)]((_0x231245,_0x36ab11)=>{var _0x307c1f=_0x2c2dba;_0x320ae6[_0x36ab11][_0x307c1f(0x116)]=_0x231245;}),_0x2b13ff[_0x2c2dba(0x1aa)]((_0x1c97ff,_0x2a18ac)=>{var _0x482b0c=_0x2c2dba;_0x320ae6[_0x2a18ac][_0x482b0c(0x13a)]=_0x1c97ff;}),_0x1bb882[_0x2c2dba(0x1aa)]((_0x3755b7,_0x1ed1ff)=>{var _0x24b1ce=_0x2c2dba;_0x320ae6[_0x1ed1ff][_0x24b1ce(0x197)]=_0x3755b7;}),_0x3e999d['forEach']((_0x181941,_0x4420b7)=>{var _0x2def5=_0x2c2dba;_0x320ae6[_0x4420b7][_0x2def5(0x1a4)]=_0x181941;}),_0x55e902['forEach']((_0x4918c1,_0x4dfbf6)=>{var _0x33c1c5=_0x2c2dba;_0x320ae6[_0x4dfbf6][_0x33c1c5(0x115)]=_0x4918c1;}),_0x23f7d0[_0x2c2dba(0x1aa)]((_0x2079d1,_0x420041)=>{_0x320ae6[_0x420041]['from_room_name']=_0x2079d1;}),_0x190d66[_0x2c2dba(0x1aa)]((_0x56f41b,_0x7c07fc)=>{var _0x31006b=_0x2c2dba;_0x320ae6[_0x7c07fc][_0x31006b(0x12b)]=_0x56f41b;});const _0x14c92a=_0x320ae6[_0x2c2dba(0x11e)](_0x336b24=>_0x336b24[_0x2c2dba(0x1cf)]!=='0'&&_0x336b24[_0x2c2dba(0x1cf)]!==''||_0x336b24[_0x2c2dba(0x18f)]!=='0'&&_0x336b24[_0x2c2dba(0x18f)]!=='');var _0x3846c3=0x0;_0x14c92a['forEach'](_0x580d5a=>{var _0x2dff68=_0x2c2dba;parseInt(_0x580d5a[_0x2dff68(0x18c)])<parseInt(_0x580d5a['to_quantity'])&&_0x3846c3++;});if(_0x3846c3!=0x0)return _0x1d6f9b['flash'](_0x2c2dba(0x1a6),_0x2c2dba(0x181)),_0x1379ab['redirect'](_0x2c2dba(0x123));const _0x509d78=new transfers_logs();await _0x509d78[_0x2c2dba(0x1c0)]();for(let _0x5b9eb8=0x0;_0x5b9eb8<=_0x190d66[_0x2c2dba(0x17f)]-0x1;_0x5b9eb8++){_0x320ae6[_0x5b9eb8][_0x2c2dba(0x135)]=_0x2c2dba(0x170)+_0x509d78[_0x2c2dba(0x1ac)][_0x2c2dba(0x14b)]()['padStart'](0x8,'0');}const _0x50c6a2=new transfers_finished({'date':_0x125b92,'from_warehouse':_0x5bc24c,'to_warehouse':_0x5bc24c,'product':_0x14c92a,'note':_0x2296da,'invoice':_0x2c2dba(0x170)+_0x509d78[_0x2c2dba(0x1ac)]['toString']()[_0x2c2dba(0x1bb)](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x2c2dba(0x151),'PO_number':_0x2ea8f9,'RequestedBy':_0x4cfb31,'DateofRequest':_0x22e124,'typeservices':_0x13ed63,'destination':_0x1b9094,'deliverydate':_0x22a74a,'driver':_0x4b2412,'plate':_0x73c9e1,'van':_0x51fb75,'DRSI':_0x415228,'typevehicle':_0x185c53,'TSU':_0x233bf9,'TFU':_0x1dbb35}),_0x473efa=await _0x50c6a2[_0x2c2dba(0x1c0)]();_0x1d6f9b['flash'](_0x2c2dba(0x149),_0x2c2dba(0x11c)),_0x1379ab[_0x2c2dba(0x1d4)]('/transfer_finished/preview/'+_0x473efa[_0x2c2dba(0x162)]);}catch(_0x49d111){console[_0x2c2dba(0x18a)](_0x49d111),_0x1379ab['status'](0xc8)['json']({'errorMessage':_0x49d111[_0x2c2dba(0x189)]});}}),router[a0_0x445aec(0x173)](a0_0x445aec(0x12e),auth,async(_0x144203,_0x2ef0f4)=>{var _0x107056=a0_0x445aec;try{const {date:_0x405093,from_warehouse:_0x4c43a5,FromRoom_name:_0x357af6,to_warehouse:_0x1f3f64,ToRoom_name:_0x1ca0e3,prod_name:_0x5ec2ab,from_prod_qty:_0x39df5f,from_prod_level:_0x40df0e,from_prod_isle:_0x2c6375,from_prod_pallet:_0x300d63,to_prod_qty:_0x48096c,to_prod_level:_0x1f88ac,to_prod_isle:_0x3d2167,to_prod_pallet:_0xcb4263,primary_code:_0x4eb152,secondary_code:_0x49bd5d,product_code3:_0xdeebaa,note:_0x4cf8f7,MaxStocks_data2:_0x2c7e6b,invoice:_0x1c32b6,expiry_date:_0x3ce6ea,PO_number_loc:_0x4710c1,ReqBy_loc:_0x46edb4,dateofreq_loc:_0x5805c3,typeservices_loc_Data:_0x1a7b2d,destination_loc:_0x2af3b0,deliverydate_loc:_0x2e8d01,driver_loc:_0x4970b6,plate_loc:_0x5b9fe8,van_loc:_0x1f98fd,DRSI_loc:_0x2ec45f,typevehicle_loc:_0x1751b5,TSU_loc:_0x518288,TFU_loc:_0x598e26}=_0x144203[_0x107056(0x18b)];if(typeof _0x5ec2ab=='string')var _0x22b9ae=[_0x144203[_0x107056(0x18b)]['prod_name']],_0x20f4bb=[_0x144203['body'][_0x107056(0x114)]],_0x5d3dd9=[_0x144203['body']['from_prod_level2']],_0x30f652=[_0x144203[_0x107056(0x18b)]['New_Qty_Converted']],_0x41396f=[_0x144203[_0x107056(0x18b)]['to_prod_level']],_0x47a586=[_0x144203[_0x107056(0x18b)]['primary_code']],_0x3117c3=[_0x144203[_0x107056(0x18b)][_0x107056(0x190)]],_0x4527c3=[_0x144203[_0x107056(0x18b)][_0x107056(0x185)]],_0x1be260=[_0x144203[_0x107056(0x18b)][_0x107056(0x1d2)]],_0x14afa7=[_0x144203[_0x107056(0x18b)][_0x107056(0x16a)]],_0xbeb1d7=[_0x144203[_0x107056(0x18b)]['secondary_unit']],_0x350314=[_0x144203[_0x107056(0x18b)]['batch_code']],_0x496bc3=[_0x144203[_0x107056(0x18b)]['expiry_date']],_0xbe42d3=[_0x144203['body'][_0x107056(0x1b0)]],_0x20ae06=[_0x144203[_0x107056(0x18b)][_0x107056(0x174)]],_0x517a57=[_0x144203['body']['maxPerUnit']],_0x4aa643=[_0x144203[_0x107056(0x18b)][_0x107056(0x115)]],_0x1066fe=[_0x144203['body'][_0x107056(0x1b3)]],_0x2fc1c2=[_0x144203[_0x107056(0x18b)][_0x107056(0x118)]],_0x3f8e53=[_0x144203[_0x107056(0x18b)]['from_invoice']],_0x34058d=[_0x144203[_0x107056(0x18b)][_0x107056(0x14f)]];else var _0x22b9ae=[..._0x144203[_0x107056(0x18b)][_0x107056(0x1cb)]],_0x20f4bb=[..._0x144203[_0x107056(0x18b)][_0x107056(0x114)]],_0x5d3dd9=[..._0x144203[_0x107056(0x18b)][_0x107056(0x1cd)]],_0x30f652=[..._0x144203['body'][_0x107056(0x120)]],_0x41396f=[..._0x144203[_0x107056(0x18b)]['to_prod_level']],_0x47a586=[..._0x144203[_0x107056(0x18b)]['primary_code']],_0x3117c3=[..._0x144203['body']['secondary_code']],_0x4527c3=[..._0x144203[_0x107056(0x18b)]['product_code3']],_0x1be260=[..._0x144203[_0x107056(0x18b)][_0x107056(0x1d2)]],_0x14afa7=[..._0x144203[_0x107056(0x18b)][_0x107056(0x16a)]],_0xbeb1d7=[..._0x144203[_0x107056(0x18b)][_0x107056(0x119)]],_0x350314=[..._0x144203[_0x107056(0x18b)][_0x107056(0x1cc)]],_0x496bc3=[..._0x144203[_0x107056(0x18b)]['expiry_date']],_0xbe42d3=[..._0x144203['body'][_0x107056(0x1b0)]],_0x20ae06=[..._0x144203[_0x107056(0x18b)]['MaxStocks_data']],_0x517a57=[..._0x144203[_0x107056(0x18b)][_0x107056(0x1a4)]],_0x4aa643=[..._0x144203[_0x107056(0x18b)][_0x107056(0x115)]],_0x1066fe=[..._0x144203[_0x107056(0x18b)]['RoomAssigned']],_0x2fc1c2=[..._0x144203[_0x107056(0x18b)][_0x107056(0x118)]],_0x3f8e53=[..._0x144203[_0x107056(0x18b)][_0x107056(0x1c1)]],_0x34058d=[..._0x144203[_0x107056(0x18b)][_0x107056(0x14f)]];const _0x1297dc=_0x22b9ae[_0x107056(0x17c)](_0x2f4025=>{return _0x2f4025={'product_name':_0x2f4025};});_0x20f4bb[_0x107056(0x1aa)]((_0x22af48,_0x4335e4)=>{var _0x5af339=_0x107056;_0x1297dc[_0x4335e4][_0x5af339(0x18c)]=_0x22af48;}),_0x5d3dd9['forEach']((_0x4c0feb,_0x1806c4)=>{var _0x2e107e=_0x107056,_0x11a0a2=_0x4c0feb[_0x2e107e(0x117)](/[A-Za-z]+/)[0x0],_0x9c1a8=parseInt(_0x4c0feb[_0x2e107e(0x117)](/\d+/)[0x0]);_0x1297dc[_0x1806c4]['from_bay']=_0x9c1a8,_0x1297dc[_0x1806c4][_0x2e107e(0x188)]=_0x11a0a2;}),_0x34058d[_0x107056(0x1aa)]((_0x5aaed5,_0x18076f)=>{var _0x1a145a=_0x107056;_0x1297dc[_0x18076f][_0x1a145a(0x14f)]=_0x5aaed5;}),_0x3f8e53['forEach']((_0x53715e,_0x28af3f)=>{var _0x3e11e5=_0x107056;_0x1297dc[_0x28af3f][_0x3e11e5(0x1c1)]=_0x53715e;}),_0x30f652[_0x107056(0x1aa)]((_0x4a3456,_0xbd684a)=>{var _0x5e2ee8=_0x107056;_0x1297dc[_0xbd684a][_0x5e2ee8(0x1cf)]=_0x4a3456;}),_0x41396f[_0x107056(0x1aa)]((_0x38a7a9,_0x4d148f)=>{var _0xb0269=_0x107056,_0x142d26=_0x38a7a9['match'](/[A-Za-z]+/)[0x0],_0x5866c2=parseInt(_0x38a7a9[_0xb0269(0x117)](/\d+/)[0x0]);_0x1297dc[_0x4d148f][_0xb0269(0x13e)]=_0x142d26,_0x1297dc[_0x4d148f][_0xb0269(0x18d)]=_0x5866c2;}),_0x47a586[_0x107056(0x1aa)]((_0xb4404f,_0x4311ce)=>{var _0x1600e3=_0x107056;_0x1297dc[_0x4311ce][_0x1600e3(0x177)]=_0xb4404f;}),_0x3117c3[_0x107056(0x1aa)]((_0x47d11c,_0x263242)=>{var _0x1cad64=_0x107056;_0x1297dc[_0x263242][_0x1cad64(0x190)]=_0x47d11c;}),_0x4527c3[_0x107056(0x1aa)]((_0x341821,_0x198c3f)=>{var _0x5c088f=_0x107056;_0x1297dc[_0x198c3f][_0x5c088f(0x16e)]=_0x341821;}),_0x1be260[_0x107056(0x1aa)]((_0x3f38be,_0x1ff1f9)=>{_0x1297dc[_0x1ff1f9]['maxProducts']=_0x3f38be;}),_0x14afa7['forEach']((_0x2acf20,_0xae42e2)=>{_0x1297dc[_0xae42e2]['unit']=_0x2acf20;}),_0xbeb1d7[_0x107056(0x1aa)]((_0x403efd,_0x24e786)=>{var _0x211d40=_0x107056;_0x1297dc[_0x24e786][_0x211d40(0x119)]=_0x403efd;}),_0x350314[_0x107056(0x1aa)]((_0x4f0f09,_0x2ab16f)=>{var _0x37a281=_0x107056;_0x1297dc[_0x2ab16f][_0x37a281(0x1cc)]=_0x4f0f09;}),_0x496bc3[_0x107056(0x1aa)]((_0x31ca9d,_0x493996)=>{var _0x596774=_0x107056;_0x1297dc[_0x493996][_0x596774(0x116)]=_0x31ca9d;}),_0xbe42d3[_0x107056(0x1aa)]((_0x1b24ba,_0x33856e)=>{var _0xe54907=_0x107056;_0x1297dc[_0x33856e][_0xe54907(0x13a)]=_0x1b24ba;}),_0x20ae06[_0x107056(0x1aa)]((_0x50ad46,_0x229f1a)=>{var _0x4b41f6=_0x107056;_0x1297dc[_0x229f1a][_0x4b41f6(0x197)]=_0x50ad46;}),_0x517a57['forEach']((_0x7a18d6,_0xfd8c97)=>{_0x1297dc[_0xfd8c97]['maxPerUnit']=_0x7a18d6;}),_0x4aa643[_0x107056(0x1aa)]((_0x2d36e7,_0x2acf2d)=>{var _0x55e1f3=_0x107056;_0x1297dc[_0x2acf2d][_0x55e1f3(0x115)]=_0x2d36e7;}),_0x1066fe[_0x107056(0x1aa)]((_0x474231,_0x42c2cb)=>{var _0xbe7047=_0x107056;_0x1297dc[_0x42c2cb][_0xbe7047(0x14c)]=_0x474231;}),_0x2fc1c2[_0x107056(0x1aa)]((_0x2ab126,_0x4fa722)=>{var _0x5ab370=_0x107056;_0x1297dc[_0x4fa722][_0x5ab370(0x12b)]=_0x2ab126;});const _0x3ea171=_0x1297dc[_0x107056(0x11e)](_0x18714b=>_0x18714b[_0x107056(0x1cf)]!=='0'&&_0x18714b[_0x107056(0x1cf)]!==''||_0x18714b[_0x107056(0x18f)]!=='0'&&_0x18714b[_0x107056(0x18f)]!=='');var _0x5ae9cb=0x0;_0x3ea171[_0x107056(0x1aa)](_0x196491=>{var _0x2c8383=_0x107056;parseInt(_0x196491['from_quantity'])<parseInt(_0x196491[_0x2c8383(0x1cf)])&&_0x5ae9cb++;});if(_0x5ae9cb!=0x0)return _0x144203[_0x107056(0x121)]('errors',_0x107056(0x181)),_0x2ef0f4['redirect'](_0x107056(0x123));const _0x185944=new transfers_logs();await _0x185944[_0x107056(0x1c0)]();for(let _0x291214=0x0;_0x291214<=_0x2fc1c2[_0x107056(0x17f)]-0x1;_0x291214++){_0x1297dc[_0x291214][_0x107056(0x135)]='LOG-TRF-'+_0x185944[_0x107056(0x1ac)][_0x107056(0x14b)]()[_0x107056(0x1bb)](0x8,'0');}const _0x3e9435=new transfers_finished({'date':_0x405093,'from_warehouse':_0x4c43a5,'to_warehouse':_0x1f3f64,'product':_0x3ea171,'note':_0x4cf8f7,'invoice':'LOG-TRF-'+_0x185944[_0x107056(0x1ac)][_0x107056(0x14b)]()[_0x107056(0x1bb)](0x8,'0'),'type_of_transaction':_0x107056(0x151),'type_of_process':'location2location','PO_number':_0x4710c1,'RequestedBy':_0x46edb4,'DateofRequest':_0x5805c3,'typeservices':_0x1a7b2d,'destination':_0x2af3b0,'deliverydate':_0x2e8d01,'driver':_0x4970b6,'plate':_0x5b9fe8,'van':_0x1f98fd,'DRSI':_0x2ec45f,'typevehicle':_0x1751b5,'TSU':_0x518288,'TFU':_0x598e26}),_0x727bee=await _0x3e9435[_0x107056(0x1c0)]();_0x144203[_0x107056(0x121)](_0x107056(0x149),_0x107056(0x11c)),_0x2ef0f4['redirect']('/transfer_finished/preview/'+_0x727bee['_id']);}catch(_0x174b20){console[_0x107056(0x18a)](_0x174b20),_0x2ef0f4['status'](0xc8)[_0x107056(0x156)]({'errorMessage':_0x174b20[_0x107056(0x189)]});}}),router[a0_0x445aec(0x173)]('/view/add_transfer',auth,async(_0x551723,_0x510d43)=>{var _0xb90474=a0_0x445aec;try{const {date:_0x3917b3,from_warehouse:_0xe51ccd,FromRoom_name:_0x208dea,to_warehouse:_0x3daa5d,ToRoom_name:_0x42a3c9,prod_name:_0x29928e,from_prod_qty:_0x176f44,from_prod_level:_0x259d0f,from_prod_isle:_0x28313c,from_prod_pallet:_0x22abfc,to_prod_qty:_0x3bc6d2,to_prod_level:_0x32787a,to_prod_isle:_0x4abcc4,to_prod_pallet:_0x3f63f7,primary_code:_0x5e71f6,secondary_code:_0x167447,product_code3:_0x28cfd2,note:_0x2ec680,MaxStocks_data2:_0x1c9f2b,invoice:_0x563a44,expiry_date:_0xa9b96c,PO_number:_0x1ed4af,ReqBy:_0x35e447,dateofreq:_0x3de787,typeservicesData:_0xa0f927,destination:_0x5b7a5c,deliverydate:_0x2d3ce9,driver:_0x2ef365,plate:_0x214254,van:_0x6d5655,DRSI:_0x287ae5,typevehicle:_0xbff75f,TSU:_0x128a2a,TFU:_0x2da592}=_0x551723['body'];if(typeof _0x29928e==_0xb90474(0x11f))var _0x1835ce=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x1cb)]],_0xbcde7d=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x114)]],_0x245e1f=[_0x551723['body'][_0xb90474(0x1cd)]],_0x11463c=[_0x551723['body'][_0xb90474(0x120)]],_0x39e5fc=[_0x551723['body'][_0xb90474(0x160)]],_0x2d8dcd=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x177)]],_0x5820df=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x190)]],_0x5ee19c=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x185)]],_0x25550f=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x1d2)]],_0x5ac478=[_0x551723['body'][_0xb90474(0x16a)]],_0x13b15b=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x119)]],_0x16dac8=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x1cc)]],_0x504c94=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x116)]],_0xb6701f=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x1b0)]],_0x4054f5=[_0x551723[_0xb90474(0x18b)]['MaxStocks_data']],_0x159f98=[_0x551723[_0xb90474(0x18b)]['maxPerUnit']],_0x27c972=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x115)]],_0x1223e3=[_0x551723[_0xb90474(0x18b)][_0xb90474(0x1b3)]],_0x1dfeb8=[_0x551723['body']['ToRoomAssigned']],_0x3d80ec=[_0x551723[_0xb90474(0x18b)]['from_invoice']],_0x256e51=[_0x551723['body'][_0xb90474(0x14f)]];else var _0x1835ce=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x1cb)]],_0xbcde7d=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x114)]],_0x245e1f=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x1cd)]],_0x11463c=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x120)]],_0x39e5fc=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x160)]],_0x2d8dcd=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x177)]],_0x5820df=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x190)]],_0x5ee19c=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x185)]],_0x25550f=[..._0x551723['body'][_0xb90474(0x1d2)]],_0x5ac478=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x16a)]],_0x13b15b=[..._0x551723['body'][_0xb90474(0x119)]],_0x16dac8=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x1cc)]],_0x504c94=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x116)]],_0xb6701f=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x1b0)]],_0x4054f5=[..._0x551723[_0xb90474(0x18b)]['MaxStocks_data']],_0x159f98=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x1a4)]],_0x27c972=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x115)]],_0x1223e3=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x1b3)]],_0x1dfeb8=[..._0x551723[_0xb90474(0x18b)][_0xb90474(0x118)]],_0x3d80ec=[..._0x551723['body'][_0xb90474(0x1c1)]],_0x256e51=[..._0x551723[_0xb90474(0x18b)]['id_transaction']];const _0x17be44=_0x1835ce['map'](_0x3020ff=>{return _0x3020ff={'product_name':_0x3020ff};});_0xbcde7d[_0xb90474(0x1aa)]((_0x5090ea,_0x4e5280)=>{var _0x5431d9=_0xb90474;_0x17be44[_0x4e5280][_0x5431d9(0x18c)]=_0x5090ea;}),_0x245e1f[_0xb90474(0x1aa)]((_0x5db43f,_0x4dd4c4)=>{var _0x5b3e61=_0xb90474,_0x80f60b=_0x5db43f[_0x5b3e61(0x117)](/[A-Za-z]+/)[0x0],_0x5392aa=parseInt(_0x5db43f[_0x5b3e61(0x117)](/\d+/)[0x0]);_0x17be44[_0x4dd4c4][_0x5b3e61(0x145)]=_0x5392aa,_0x17be44[_0x4dd4c4][_0x5b3e61(0x188)]=_0x80f60b;}),_0x256e51[_0xb90474(0x1aa)]((_0x57366e,_0x535bec)=>{var _0x2b0641=_0xb90474;_0x17be44[_0x535bec][_0x2b0641(0x14f)]=_0x57366e;}),_0x3d80ec[_0xb90474(0x1aa)]((_0x4e5847,_0x5d7fb6)=>{var _0x486248=_0xb90474;_0x17be44[_0x5d7fb6][_0x486248(0x1c1)]=_0x4e5847;}),_0x11463c[_0xb90474(0x1aa)]((_0x51eb5d,_0x44fcf8)=>{var _0x21b08e=_0xb90474;_0x17be44[_0x44fcf8][_0x21b08e(0x1cf)]=_0x51eb5d;}),_0x39e5fc[_0xb90474(0x1aa)]((_0x108a30,_0x385347)=>{var _0x100099=_0xb90474,_0x48c50d=_0x108a30[_0x100099(0x117)](/[A-Za-z]+/)[0x0],_0xcad361=parseInt(_0x108a30[_0x100099(0x117)](/\d+/)[0x0]);_0x17be44[_0x385347]['to_level']=_0x48c50d,_0x17be44[_0x385347][_0x100099(0x18d)]=_0xcad361;}),_0x2d8dcd[_0xb90474(0x1aa)]((_0x162e8e,_0x57299e)=>{var _0x5b9a35=_0xb90474;_0x17be44[_0x57299e][_0x5b9a35(0x177)]=_0x162e8e;}),_0x5820df['forEach']((_0xe8885e,_0x505d74)=>{var _0x444233=_0xb90474;_0x17be44[_0x505d74][_0x444233(0x190)]=_0xe8885e;}),_0x5ee19c[_0xb90474(0x1aa)]((_0x3d8d79,_0x44eb8c)=>{var _0xcdd2eb=_0xb90474;_0x17be44[_0x44eb8c][_0xcdd2eb(0x16e)]=_0x3d8d79;}),_0x25550f['forEach']((_0x5da7e7,_0x45ea8a)=>{_0x17be44[_0x45ea8a]['maxProducts']=_0x5da7e7;}),_0x5ac478[_0xb90474(0x1aa)]((_0x5522d5,_0x3dc2b9)=>{_0x17be44[_0x3dc2b9]['unit']=_0x5522d5;}),_0x13b15b['forEach']((_0xdc591c,_0x17c722)=>{var _0x584e28=_0xb90474;_0x17be44[_0x17c722][_0x584e28(0x119)]=_0xdc591c;}),_0x16dac8[_0xb90474(0x1aa)]((_0x31215a,_0x5a38ef)=>{var _0x5c6d30=_0xb90474;_0x17be44[_0x5a38ef][_0x5c6d30(0x1cc)]=_0x31215a;}),_0x504c94[_0xb90474(0x1aa)]((_0x30b325,_0x1b2328)=>{_0x17be44[_0x1b2328]['expiry_date']=_0x30b325;}),_0xb6701f['forEach']((_0x80e96f,_0x198ce6)=>{var _0x1d1f48=_0xb90474;_0x17be44[_0x198ce6][_0x1d1f48(0x13a)]=_0x80e96f;}),_0x4054f5[_0xb90474(0x1aa)]((_0x3fe43d,_0x339be9)=>{var _0x296146=_0xb90474;_0x17be44[_0x339be9][_0x296146(0x197)]=_0x3fe43d;}),_0x159f98[_0xb90474(0x1aa)]((_0x206974,_0x1d7af9)=>{var _0x388a4d=_0xb90474;_0x17be44[_0x1d7af9][_0x388a4d(0x1a4)]=_0x206974;}),_0x27c972[_0xb90474(0x1aa)]((_0x1047e3,_0x284f78)=>{var _0xa5f729=_0xb90474;_0x17be44[_0x284f78][_0xa5f729(0x115)]=_0x1047e3;}),_0x1223e3['forEach']((_0x41d88b,_0x83a8e8)=>{var _0x4d5aa1=_0xb90474;_0x17be44[_0x83a8e8][_0x4d5aa1(0x14c)]=_0x41d88b;}),_0x1dfeb8['forEach']((_0x5d953a,_0x33b7bf)=>{var _0x13f891=_0xb90474;_0x17be44[_0x33b7bf][_0x13f891(0x12b)]=_0x5d953a;});const _0x18eb1a=_0x17be44[_0xb90474(0x11e)](_0x772b26=>_0x772b26[_0xb90474(0x1cf)]!=='0'&&_0x772b26['to_quantity']!==''||_0x772b26[_0xb90474(0x18f)]!=='0'&&_0x772b26[_0xb90474(0x18f)]!=='');var _0x142adb=0x0;_0x18eb1a[_0xb90474(0x1aa)](_0x1d4a57=>{var _0x5d117c=_0xb90474;parseInt(_0x1d4a57[_0x5d117c(0x18c)])<parseInt(_0x1d4a57['to_quantity'])&&_0x142adb++;});if(_0x142adb!=0x0)return _0x551723[_0xb90474(0x121)](_0xb90474(0x1a6),_0xb90474(0x181)),_0x510d43['redirect']('back');const _0x22a7ff=new invoice_for_transfer();await _0x22a7ff[_0xb90474(0x1c0)]();for(let _0x136943=0x0;_0x136943<=_0x1dfeb8['length']-0x1;_0x136943++){_0x17be44[_0x136943]['To_invoice']=_0xb90474(0x180)+_0x22a7ff[_0xb90474(0x1ac)][_0xb90474(0x14b)]()[_0xb90474(0x1bb)](0x8,'0');}const _0x154ea3=new transfers_finished({'date':_0x3917b3,'from_warehouse':_0xe51ccd,'to_warehouse':_0xe51ccd,'product':_0x18eb1a,'note':_0x2ec680,'invoice':_0xb90474(0x180)+_0x22a7ff['invoice_init'][_0xb90474(0x14b)]()[_0xb90474(0x1bb)](0x8,'0'),'type_of_process':_0xb90474(0x19e),'type_of_transaction':'own','PO_number':_0x1ed4af,'RequestedBy':_0x35e447,'DateofRequest':_0x3de787,'typeservices':_0xa0f927,'destination':_0x5b7a5c,'deliverydate':_0x2d3ce9,'driver':_0x2ef365,'plate':_0x214254,'van':_0x6d5655,'DRSI':_0x287ae5,'typevehicle':_0xbff75f,'TSU':_0x128a2a,'TFU':_0x2da592}),_0x20408b=await _0x154ea3[_0xb90474(0x1c0)]();_0x551723[_0xb90474(0x121)](_0xb90474(0x149),_0xb90474(0x11c)),_0x510d43[_0xb90474(0x1d4)]('/transfer_finished/preview/'+_0x20408b[_0xb90474(0x162)]);}catch(_0xa64092){console[_0xb90474(0x18a)](_0xa64092),_0x510d43[_0xb90474(0x113)](0xc8)[_0xb90474(0x156)]({'errorMessage':_0xa64092['message']});}}),router[a0_0x445aec(0x173)](a0_0x445aec(0x140),auth,async(_0x313fdf,_0x29e7c1)=>{var _0x25f5bf=a0_0x445aec;try{const {date:_0x25ba25,from_warehouse:_0x34a295,FromRoom_name:_0x4b5644,to_warehouse:_0xc62950,ToRoom_name:_0x93e5e4,prod_name:_0x16f016,from_prod_qty:_0x116e52,from_prod_level:_0x544b7a,from_prod_isle:_0x4c9ea1,from_prod_pallet:_0x2e0a4e,to_prod_qty:_0x147db0,to_prod_level:_0x5ed29e,to_prod_isle:_0x262f9d,to_prod_pallet:_0x49e1b4,primary_code:_0x309ed2,secondary_code:_0x2885db,product_code3:_0x5a9f84,note:_0xae6457,MaxStocks_data2:_0x228e50,invoice:_0xfb6f1b,expiry_date:_0xc76ed7,PO_number_loc:_0x57cece,ReqBy_loc:_0x5d5b4a,dateofreq_loc:_0x10792a,typeservices_loc_Data:_0x3ef47e,destination_loc:_0x1bcd85,deliverydate_loc:_0x15c3dc,driver_loc:_0x2bb03b,plate_loc:_0x4b954e,van_loc:_0x1e1c52,DRSI_loc:_0x5b9d2d,typevehicle_loc:_0x4bd6e2,TSU_loc:_0x499d79,TFU_loc:_0x376c24}=_0x313fdf['body'];if(typeof _0x16f016==_0x25f5bf(0x11f))var _0xf28412=[_0x313fdf['body'][_0x25f5bf(0x1cb)]],_0x54a2ec=[_0x313fdf[_0x25f5bf(0x18b)]['from_prod_qty']],_0x460ffb=[_0x313fdf['body'][_0x25f5bf(0x1cd)]],_0x5f130e=[_0x313fdf[_0x25f5bf(0x18b)]['New_Qty_Converted']],_0x26d071=[_0x313fdf['body'][_0x25f5bf(0x160)]],_0x123e92=[_0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x177)]],_0x2e9b81=[_0x313fdf['body'][_0x25f5bf(0x190)]],_0x21adb3=[_0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x185)]],_0x2cb3d3=[_0x313fdf['body'][_0x25f5bf(0x1d2)]],_0x4ee1f=[_0x313fdf['body']['primary_unit']],_0x36d381=[_0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x119)]],_0x4d8791=[_0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x1cc)]],_0x3d5814=[_0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x116)]],_0x412d72=[_0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x1b0)]],_0x294986=[_0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x174)]],_0x2b2180=[_0x313fdf['body'][_0x25f5bf(0x1a4)]],_0x1c33aa=[_0x313fdf['body'][_0x25f5bf(0x115)]],_0x4bde53=[_0x313fdf['body']['RoomAssigned']],_0x286309=[_0x313fdf['body'][_0x25f5bf(0x118)]],_0x2c4335=[_0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x1c1)]],_0x2d557d=[_0x313fdf['body'][_0x25f5bf(0x14f)]];else var _0xf28412=[..._0x313fdf['body'][_0x25f5bf(0x1cb)]],_0x54a2ec=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x114)]],_0x460ffb=[..._0x313fdf[_0x25f5bf(0x18b)]['from_prod_level2']],_0x5f130e=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x120)]],_0x26d071=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x160)]],_0x123e92=[..._0x313fdf[_0x25f5bf(0x18b)]['primary_code']],_0x2e9b81=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x190)]],_0x21adb3=[..._0x313fdf[_0x25f5bf(0x18b)]['product_code3']],_0x2cb3d3=[..._0x313fdf['body'][_0x25f5bf(0x1d2)]],_0x4ee1f=[..._0x313fdf[_0x25f5bf(0x18b)]['primary_unit']],_0x36d381=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x119)]],_0x4d8791=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x1cc)]],_0x3d5814=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x116)]],_0x412d72=[..._0x313fdf[_0x25f5bf(0x18b)]['product_date']],_0x294986=[..._0x313fdf['body']['MaxStocks_data']],_0x2b2180=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x1a4)]],_0x1c33aa=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x115)]],_0x4bde53=[..._0x313fdf[_0x25f5bf(0x18b)]['RoomAssigned']],_0x286309=[..._0x313fdf[_0x25f5bf(0x18b)][_0x25f5bf(0x118)]],_0x2c4335=[..._0x313fdf[_0x25f5bf(0x18b)]['from_invoice']],_0x2d557d=[..._0x313fdf['body'][_0x25f5bf(0x14f)]];const _0x1e9551=_0xf28412[_0x25f5bf(0x17c)](_0x5731de=>{return _0x5731de={'product_name':_0x5731de};});_0x54a2ec['forEach']((_0x2aea29,_0x8d6c0a)=>{var _0x40ee1e=_0x25f5bf;_0x1e9551[_0x8d6c0a][_0x40ee1e(0x18c)]=_0x2aea29;}),_0x460ffb[_0x25f5bf(0x1aa)]((_0x33d507,_0x2181e8)=>{var _0x35b0c0=_0x25f5bf,_0x39ca26=_0x33d507[_0x35b0c0(0x117)](/[A-Za-z]+/)[0x0],_0x3bb4be=parseInt(_0x33d507[_0x35b0c0(0x117)](/\d+/)[0x0]);_0x1e9551[_0x2181e8][_0x35b0c0(0x145)]=_0x3bb4be,_0x1e9551[_0x2181e8][_0x35b0c0(0x188)]=_0x39ca26;}),_0x2d557d[_0x25f5bf(0x1aa)]((_0x386f93,_0x5e6d11)=>{var _0x414b23=_0x25f5bf;_0x1e9551[_0x5e6d11][_0x414b23(0x14f)]=_0x386f93;}),_0x2c4335['forEach']((_0x281b51,_0x2a3504)=>{var _0x471a57=_0x25f5bf;_0x1e9551[_0x2a3504][_0x471a57(0x1c1)]=_0x281b51;}),_0x5f130e[_0x25f5bf(0x1aa)]((_0x4e7bae,_0x2c58fa)=>{var _0x329be6=_0x25f5bf;_0x1e9551[_0x2c58fa][_0x329be6(0x1cf)]=_0x4e7bae;}),_0x26d071[_0x25f5bf(0x1aa)]((_0xc03876,_0x274303)=>{var _0x48febd=_0x25f5bf,_0x155272=_0xc03876[_0x48febd(0x117)](/[A-Za-z]+/)[0x0],_0xc1477a=parseInt(_0xc03876['match'](/\d+/)[0x0]);_0x1e9551[_0x274303][_0x48febd(0x13e)]=_0x155272,_0x1e9551[_0x274303]['to_bay']=_0xc1477a;}),_0x123e92[_0x25f5bf(0x1aa)]((_0x4a698b,_0xe2950d)=>{var _0x1be263=_0x25f5bf;_0x1e9551[_0xe2950d][_0x1be263(0x177)]=_0x4a698b;}),_0x2e9b81['forEach']((_0x4852fc,_0x59119a)=>{var _0x2096da=_0x25f5bf;_0x1e9551[_0x59119a][_0x2096da(0x190)]=_0x4852fc;}),_0x21adb3[_0x25f5bf(0x1aa)]((_0x189e14,_0x9a62a5)=>{_0x1e9551[_0x9a62a5]['product_code']=_0x189e14;}),_0x2cb3d3[_0x25f5bf(0x1aa)]((_0x581c4a,_0x1dc7ae)=>{var _0x35d791=_0x25f5bf;_0x1e9551[_0x1dc7ae][_0x35d791(0x197)]=_0x581c4a;}),_0x4ee1f['forEach']((_0x543bc0,_0x1b28c8)=>{var _0x3f6dca=_0x25f5bf;_0x1e9551[_0x1b28c8][_0x3f6dca(0x19f)]=_0x543bc0;}),_0x36d381[_0x25f5bf(0x1aa)]((_0x4d34f1,_0x1050f)=>{var _0x2f6767=_0x25f5bf;_0x1e9551[_0x1050f][_0x2f6767(0x119)]=_0x4d34f1;}),_0x4d8791[_0x25f5bf(0x1aa)]((_0x539d5f,_0x1b9eff)=>{var _0x2652e2=_0x25f5bf;_0x1e9551[_0x1b9eff][_0x2652e2(0x1cc)]=_0x539d5f;}),_0x3d5814[_0x25f5bf(0x1aa)]((_0x2ad137,_0x5c5fae)=>{var _0x5e60d2=_0x25f5bf;_0x1e9551[_0x5c5fae][_0x5e60d2(0x116)]=_0x2ad137;}),_0x412d72[_0x25f5bf(0x1aa)]((_0x3e0e0a,_0x415e94)=>{var _0x4045e1=_0x25f5bf;_0x1e9551[_0x415e94][_0x4045e1(0x13a)]=_0x3e0e0a;}),_0x294986[_0x25f5bf(0x1aa)]((_0x2a8ad3,_0x49d77e)=>{var _0x271fad=_0x25f5bf;_0x1e9551[_0x49d77e][_0x271fad(0x197)]=_0x2a8ad3;}),_0x2b2180[_0x25f5bf(0x1aa)]((_0x5c6525,_0x2f98c2)=>{_0x1e9551[_0x2f98c2]['maxPerUnit']=_0x5c6525;}),_0x1c33aa[_0x25f5bf(0x1aa)]((_0x554669,_0xfcf391)=>{var _0x53168a=_0x25f5bf;_0x1e9551[_0xfcf391][_0x53168a(0x115)]=_0x554669;}),_0x4bde53['forEach']((_0xa69180,_0x1ad3e8)=>{var _0x33d384=_0x25f5bf;_0x1e9551[_0x1ad3e8][_0x33d384(0x14c)]=_0xa69180;}),_0x286309[_0x25f5bf(0x1aa)]((_0x6b749f,_0x2021a5)=>{var _0x3b4829=_0x25f5bf;_0x1e9551[_0x2021a5][_0x3b4829(0x12b)]=_0x6b749f;});const _0x3ba2c3=_0x1e9551[_0x25f5bf(0x11e)](_0x56fa2a=>_0x56fa2a[_0x25f5bf(0x1cf)]!=='0'&&_0x56fa2a[_0x25f5bf(0x1cf)]!==''||_0x56fa2a[_0x25f5bf(0x18f)]!=='0'&&_0x56fa2a[_0x25f5bf(0x18f)]!=='');var _0x326096=0x0;_0x3ba2c3[_0x25f5bf(0x1aa)](_0xa5385d=>{var _0x126ece=_0x25f5bf;parseInt(_0xa5385d[_0x126ece(0x18c)])<parseInt(_0xa5385d[_0x126ece(0x1cf)])&&_0x326096++;});if(_0x326096!=0x0)return _0x313fdf[_0x25f5bf(0x121)]('errors',_0x25f5bf(0x181)),_0x29e7c1[_0x25f5bf(0x1d4)](_0x25f5bf(0x123));const _0x3ba924=new invoice_for_transfer();await _0x3ba924[_0x25f5bf(0x1c0)]();for(let _0x4b0896=0x0;_0x4b0896<=_0x286309['length']-0x1;_0x4b0896++){_0x1e9551[_0x4b0896]['To_invoice']=_0x25f5bf(0x180)+_0x3ba924[_0x25f5bf(0x1ac)]['toString']()['padStart'](0x8,'0');}const _0x207543=new transfers_finished({'date':_0x25ba25,'from_warehouse':_0x34a295,'to_warehouse':_0xc62950,'product':_0x3ba2c3,'note':_0xae6457,'invoice':_0x25f5bf(0x180)+_0x3ba924['invoice_init'][_0x25f5bf(0x14b)]()[_0x25f5bf(0x1bb)](0x8,'0'),'type_of_transaction':'own','type_of_process':_0x25f5bf(0x13d),'PO_number':_0x57cece,'RequestedBy':_0x5d5b4a,'DateofRequest':_0x10792a,'typeservices':_0x3ef47e,'destination':_0x1bcd85,'deliverydate':_0x15c3dc,'driver':_0x2bb03b,'plate':_0x4b954e,'van':_0x1e1c52,'DRSI':_0x5b9d2d,'typevehicle':_0x4bd6e2,'TSU':_0x499d79,'TFU':_0x376c24}),_0x3ad949=await _0x207543[_0x25f5bf(0x1c0)]();_0x313fdf[_0x25f5bf(0x121)](_0x25f5bf(0x149),'Product\x20Transfer\x20successfully'),_0x29e7c1[_0x25f5bf(0x1d4)](_0x25f5bf(0x163)+_0x3ad949[_0x25f5bf(0x162)]);}catch(_0x2c0a75){console[_0x25f5bf(0x18a)](_0x2c0a75),_0x29e7c1['status'](0xc8)[_0x25f5bf(0x156)]({'errorMessage':_0x2c0a75[_0x25f5bf(0x189)]});}}),router['get']('/preview/:id',auth,async(_0x45c809,_0x31b412)=>{var _0x1b974e=a0_0x445aec;try{const {username:_0x5ef475,email:_0x5a0436,role:_0x380ba6}=_0x45c809['user'],_0x430962=_0x45c809['user'],_0x2a3978=await profile[_0x1b974e(0x1b2)]({'email':_0x430962[_0x1b974e(0x1a9)]}),_0x36664a=await master_shop[_0x1b974e(0x1a3)](),_0x13950b=await transfers_finished[_0x1b974e(0x1a2)](_0x45c809[_0x1b974e(0x1a5)]['id']);let _0x4b8829;if(_0x430962[_0x1b974e(0x16c)]=='staff'){const _0x351011=await staff[_0x1b974e(0x1b2)]({'email':_0x430962[_0x1b974e(0x1a9)]});_0x4b8829=await warehouse[_0x1b974e(0x1a3)]({'status':_0x1b974e(0x1c9),'name':_0x351011[_0x1b974e(0x16d)],'warehouse_category':_0x1b974e(0x183)});}else _0x4b8829=await warehouse[_0x1b974e(0x1a3)]({'status':'Enabled','warehouse_category':_0x1b974e(0x183)});const _0x2db583=await warehouse[_0x1b974e(0x146)]([{'$match':{'name':_0x13950b[_0x1b974e(0x19b)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x1b974e(0x1bf)},{'$group':{'_id':_0x1b974e(0x1b1),'name':{'$first':_0x1b974e(0x19a)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1b974e(0x154)},'bin':{'$first':_0x1b974e(0x1d3)},'type':{'$first':_0x1b974e(0x194)},'floorlevel':{'$first':_0x1b974e(0x134)},'primary_code':{'$first':_0x1b974e(0x1a8)},'secondary_code':{'$first':_0x1b974e(0x15c)},'product_code':{'$first':_0x1b974e(0x164)},'storage':{'$first':_0x1b974e(0x1d5)},'rack':{'$first':_0x1b974e(0x1c4)},'expiry_date':{'$first':_0x1b974e(0x14a)},'production_date':{'$first':_0x1b974e(0x1a0)},'room':{'$first':_0x1b974e(0x148)},'warehoue_name':{'$first':'$name'}}}]),_0x4dcd2c=await product[_0x1b974e(0x1a3)]({});if(_0x36664a[0x0]['language']==_0x1b974e(0x1d0)){var _0x746e1d=users[_0x1b974e(0x179)];console[_0x1b974e(0x18a)](_0x746e1d);}else{if(_0x36664a[0x0][_0x1b974e(0x13f)]==_0x1b974e(0x191))var _0x746e1d=users['Hindi'];else{if(_0x36664a[0x0][_0x1b974e(0x13f)]==_0x1b974e(0x127))var _0x746e1d=users[_0x1b974e(0x127)];else{if(_0x36664a[0x0][_0x1b974e(0x13f)]==_0x1b974e(0x112))var _0x746e1d=users[_0x1b974e(0x112)];else{if(_0x36664a[0x0][_0x1b974e(0x13f)]==_0x1b974e(0x1b9))var _0x746e1d=users[_0x1b974e(0x1b9)];else{if(_0x36664a[0x0]['language']==_0x1b974e(0x1c6))var _0x746e1d=users[_0x1b974e(0x137)];else{if(_0x36664a[0x0][_0x1b974e(0x13f)]==_0x1b974e(0x1ad))var _0x746e1d=users[_0x1b974e(0x1ad)];else{if(_0x36664a[0x0]['language']==_0x1b974e(0x168))var _0x746e1d=users[_0x1b974e(0x1bd)];}}}}}}}_0x31b412[_0x1b974e(0x187)](_0x1b974e(0x1c7),{'success':_0x45c809[_0x1b974e(0x121)](_0x1b974e(0x149)),'errors':_0x45c809[_0x1b974e(0x121)](_0x1b974e(0x1a6)),'role':_0x430962,'profile':_0x2a3978,'master_shop':_0x36664a,'warehouse':_0x4b8829,'transfer':_0x13950b,'stock':_0x2db583,'unit':_0x4dcd2c,'language':_0x746e1d});}catch(_0x4446cc){console[_0x1b974e(0x18a)](_0x4446cc);}}),router[a0_0x445aec(0x173)]('/preview/:id',auth,async(_0x4fe234,_0x4a3f3e)=>{var _0x32175c=a0_0x445aec;try{const {invoice:_0x4f19c2,from_warehouse:_0x32c3e0,FromRoom_name:_0x14ae9e,to_warehouse:_0x4f35e5,ToRoom_name:_0x43e409}=_0x4fe234[_0x32175c(0x18b)],_0x5dfd88=await transfers_finished[_0x32175c(0x1a2)](_0x4fe234[_0x32175c(0x1a5)]['id']),_0x578947=_0x5dfd88[_0x32175c(0x17a)]['map'](async _0x48ac67=>{var _0x1b4237=_0x32175c;if(_0x48ac67[_0x1b4237(0x1cf)]>0x0){var _0x233261=await warehouse['findOne']({'name':_0x32c3e0,'room':_0x48ac67[_0x1b4237(0x14c)]});const _0x491a9d=_0x233261[_0x1b4237(0x15d)]['map'](_0x10d90b=>{var _0x3085a9=_0x1b4237;_0x10d90b[_0x3085a9(0x162)]==_0x48ac67['id_transaction']&&(_0x10d90b['product_stock']=Math[_0x3085a9(0x13b)](0x0,Math['abs'](_0x10d90b[_0x3085a9(0x12f)])-Math[_0x3085a9(0x1b5)](_0x48ac67[_0x3085a9(0x1cf)])),console['log'](_0x10d90b[_0x3085a9(0x12f)]));});}return _0x233261;});Promise[_0x32175c(0x13c)](_0x578947)[_0x32175c(0x147)](async _0x49d467=>{var _0x9f20b0=_0x32175c;try{for(const _0xd20fda of _0x49d467){await _0xd20fda[_0x9f20b0(0x1c0)]();}const _0x5a99d1=_0x5dfd88['product']['map'](async _0x5f2757=>{var _0x16c1a9=_0x9f20b0,_0x5383da=await warehouse[_0x16c1a9(0x1b2)]({'name':_0x4f35e5,'room':_0x5f2757[_0x16c1a9(0x12b)]});if(_0x5f2757[_0x16c1a9(0x1cf)]>0x0){var _0x3821f9=0x0;const _0x92eac3=_0x5383da[_0x16c1a9(0x15d)][_0x16c1a9(0x17c)](_0x3fac10=>{var _0x5eb585=_0x16c1a9;_0x3fac10[_0x5eb585(0x122)]==_0x5f2757[_0x5eb585(0x122)]&&_0x3fac10[_0x5eb585(0x15a)]==_0x5f2757[_0x5eb585(0x18d)]&&_0x3fac10[_0x5eb585(0x116)]==_0x5f2757['expiry_date']&&_0x3fac10['production_date']==_0x5f2757[_0x5eb585(0x13a)]&&_0x3fac10[_0x5eb585(0x1cc)]==_0x5f2757[_0x5eb585(0x1cc)]&&_0x3fac10[_0x5eb585(0x184)]==_0x5f2757[_0x5eb585(0x135)]&&(typeof _0x5f2757[_0x5eb585(0x14f)]=='undefined'?(console[_0x5eb585(0x18a)]('here2',_0x3fac10[_0x5eb585(0x12f)]+'\x20<>\x20'+_0x3fac10['_id']+_0x5eb585(0x130)+Math[_0x5eb585(0x1b5)](_0x3fac10['product_stock'])+Math[_0x5eb585(0x1b5)](_0x5f2757['to_quantity'])),_0x3fac10[_0x5eb585(0x12f)]=Math['abs'](_0x3fac10[_0x5eb585(0x12f)])+Math[_0x5eb585(0x1b5)](_0x5f2757[_0x5eb585(0x1cf)])):_0x3fac10['product_stock']=Math[_0x5eb585(0x1b5)](_0x3fac10[_0x5eb585(0x12f)])+Math['abs'](_0x5f2757['to_quantity']),_0x3821f9++);});_0x3821f9=='0'&&(_0x5383da[_0x16c1a9(0x15d)]=_0x5383da[_0x16c1a9(0x15d)][_0x16c1a9(0x153)]({'product_name':_0x5f2757[_0x16c1a9(0x122)],'product_stock':_0x5f2757[_0x16c1a9(0x1cf)],'bay':_0x5f2757[_0x16c1a9(0x18d)],'level':_0x5f2757[_0x16c1a9(0x13e)],'product_code':_0x5f2757[_0x16c1a9(0x16e)],'primary_code':_0x5f2757['primary_code'],'secondary_code':_0x5f2757['secondary_code'],'expiry_date':_0x5f2757[_0x16c1a9(0x116)],'production_date':_0x5f2757[_0x16c1a9(0x13a)],'maxProducts':_0x5f2757[_0x16c1a9(0x197)],'batch_code':_0x5f2757[_0x16c1a9(0x1cc)],'secondary_unit':_0x5f2757[_0x16c1a9(0x119)],'unit':_0x5f2757[_0x16c1a9(0x19f)],'maxProducts':_0x5f2757[_0x16c1a9(0x197)],'maxPerUnit':_0x5f2757[_0x16c1a9(0x1a4)],'invoice':_0x5f2757[_0x16c1a9(0x135)]}));}return _0x5383da;});Promise[_0x9f20b0(0x13c)](_0x5a99d1)[_0x9f20b0(0x147)](async _0x406808=>{var _0x420eb2=_0x9f20b0;try{console[_0x420eb2(0x18a)](_0x5dfd88[_0x420eb2(0x1b6)]);if(_0x5dfd88['type_of_process']!=_0x420eb2(0x13d))for(const _0x2daf7c of _0x406808){await warehouse[_0x420eb2(0x111)]({'_id':_0x2daf7c['_id']},{'$addToSet':{'product_details':{'$each':_0x2daf7c[_0x420eb2(0x15d)]}}});}_0x5dfd88[_0x420eb2(0x125)]='True';const _0xd7d411=await _0x5dfd88[_0x420eb2(0x1c0)](),_0x2361fa=await master_shop['find'](),_0x710c01=await email_settings[_0x420eb2(0x1b2)](),_0x29e707=await supervisor_settings[_0x420eb2(0x1a3)]();var _0x4df4dd=_0x5dfd88[_0x420eb2(0x17a)],_0xc0730d='',_0x4ed746;for(_0x4ed746 in _0x4df4dd){var _0xddc04d='FG';_0x5dfd88[_0x420eb2(0x150)]==_0x420eb2(0x17d)&&(_0xddc04d='DG'),_0xc0730d+=_0x420eb2(0x126)+_0x420eb2(0x16b)+_0x4df4dd[_0x4ed746]['product_name']+_0x420eb2(0x144)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4df4dd[_0x4ed746][_0x420eb2(0x16e)]+'</td>'+_0x420eb2(0x16b)+_0x4df4dd[_0x4ed746][_0x420eb2(0x1cf)]+_0x420eb2(0x144)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4df4dd[_0x4ed746][_0x420eb2(0x19f)]+_0x420eb2(0x144)+_0x420eb2(0x16b)+_0x4df4dd[_0x4ed746]['secondary_unit']+_0x420eb2(0x144)+_0x420eb2(0x16b)+_0x5dfd88['to_warehouse']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4df4dd[_0x4ed746]['to_room_name']+_0x420eb2(0x144)+_0x420eb2(0x16b)+_0xddc04d+_0x4df4dd[_0x4ed746][_0x420eb2(0x18d)]+'</td>'+'</tr>';}_0x4fe234[_0x420eb2(0x121)](_0x420eb2(0x149),_0x420eb2(0x139)),_0x4a3f3e['redirect']('/picking_list/PDF_transfer/'+_0xd7d411[_0x420eb2(0x162)]);}catch(_0x12ae4a){console[_0x420eb2(0x19d)](_0x12ae4a),_0x4a3f3e[_0x420eb2(0x113)](0x1f4)[_0x420eb2(0x156)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x9f20b0(0x152)](_0x221e4c=>{var _0x4e9eb3=_0x9f20b0;console[_0x4e9eb3(0x19d)](_0x221e4c),_0x4a3f3e[_0x4e9eb3(0x113)](0x1f4)[_0x4e9eb3(0x156)]({'error':'An\x20error\x20occurred.'});});}catch(_0x33014f){console[_0x9f20b0(0x19d)](_0x33014f),_0x4a3f3e[_0x9f20b0(0x113)](0x1f4)[_0x9f20b0(0x156)]({'error':_0x9f20b0(0x15f)});}})[_0x32175c(0x152)](_0x21fbf2=>{var _0x3f58fb=_0x32175c;console[_0x3f58fb(0x19d)](_0x21fbf2),_0x4a3f3e['status'](0x1f4)[_0x3f58fb(0x156)]({'error':_0x3f58fb(0x1ca)});});}catch(_0x921d1b){_0x4a3f3e['json']({'message':_0x921d1b[_0x32175c(0x189)]});}});function BayBinSelected(_0x11aaa3,_0xac2da4){var _0x299186=a0_0x445aec,_0x45ba0e=[];let _0x5eb37d=[];var _0x3cff37=[];if(_0x11aaa3==_0x299186(0x17d)){switch(_0xac2da4){case _0x299186(0x132):_0x45ba0e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x299186(0x176):_0x45ba0e=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3cff37=['DG'];}else{if(_0x11aaa3=='FROZEN\x20GOODS'){switch(_0xac2da4){case _0x299186(0x132):_0x45ba0e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x299186(0x176):_0x45ba0e=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3cff37=['FG'];}}return{'levels':_0x45ba0e,'identify':_0x3cff37};}router[a0_0x445aec(0x1c2)](a0_0x445aec(0x1a7),auth,async(_0x13adaf,_0x567d0d)=>{var _0xf670f2=a0_0x445aec;try{const {username:_0x34204d,email:_0x116acb,role:_0x939cec}=_0x13adaf[_0xf670f2(0x1be)],_0x1e3b73=_0x13adaf[_0xf670f2(0x1be)],_0x41a170=await profile['findOne']({'email':_0x1e3b73[_0xf670f2(0x1a9)]}),_0x39fd8f=await master_shop['find'](),_0x22b505=await transfers_finished[_0xf670f2(0x1a2)](_0x13adaf['params']['id']);let _0x3986e6=new Date(_0x22b505[_0xf670f2(0x116)]),_0x217035=('0'+_0x3986e6[_0xf670f2(0x143)]())[_0xf670f2(0x14d)](-0x2),_0x119000=('0'+(_0x3986e6[_0xf670f2(0x1af)]()+0x1))[_0xf670f2(0x14d)](-0x2),_0x34b103=_0x3986e6[_0xf670f2(0x15b)](),_0x5c3e70=_0x34b103+'-'+_0x119000+'-'+_0x217035,_0x5abd0f;if(_0x1e3b73[_0xf670f2(0x16c)]==_0xf670f2(0x165)){const _0x2fa5ed=await staff[_0xf670f2(0x1b2)]({'email':_0x1e3b73['email']});_0x5abd0f=await warehouse[_0xf670f2(0x1a3)]({'status':_0xf670f2(0x1c9),'name':_0x2fa5ed[_0xf670f2(0x16d)],'warehouse_category':_0xf670f2(0x183)});}else _0x5abd0f=await warehouse[_0xf670f2(0x1a3)]({'status':_0xf670f2(0x1c9),'warehouse_category':_0xf670f2(0x183)});const _0x434faa=await warehouse[_0xf670f2(0x146)]([{'$match':{'name':_0x22b505['from_warehouse'],'room':_0x22b505[_0xf670f2(0x155)]}},{'$unwind':_0xf670f2(0x1bf)},{'$group':{'_id':_0xf670f2(0x1b1),'name':{'$first':_0xf670f2(0x19a)},'product_stock':{'$first':_0xf670f2(0x161)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xf670f2(0x134)},'primary_code':{'$first':_0xf670f2(0x1a8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xf670f2(0x164)},'storage':{'$first':_0xf670f2(0x1d5)},'rack':{'$first':_0xf670f2(0x1c4)}}}]);var _0x42acb1=[0x1,0x2,0x3,0x4],_0x30a34f=['A','B','C','D','E','F','G','H','I','J'],_0x1360f3=[_0xf670f2(0x172),_0xf670f2(0x11a)];const _0x451d11=await product[_0xf670f2(0x1a3)]({}),_0x18bcc1=BayBinSelected(_0x22b505[_0xf670f2(0x150)],_0x22b505[_0xf670f2(0x19c)]);if(_0x39fd8f[0x0][_0xf670f2(0x13f)]==_0xf670f2(0x1d0)){var _0x1cdc3e=users['English'];console['log'](_0x1cdc3e);}else{if(_0x39fd8f[0x0][_0xf670f2(0x13f)]==_0xf670f2(0x191))var _0x1cdc3e=users[_0xf670f2(0x191)];else{if(_0x39fd8f[0x0][_0xf670f2(0x13f)]==_0xf670f2(0x127))var _0x1cdc3e=users[_0xf670f2(0x127)];else{if(_0x39fd8f[0x0]['language']=='Spanish')var _0x1cdc3e=users['Spanish'];else{if(_0x39fd8f[0x0][_0xf670f2(0x13f)]==_0xf670f2(0x1b9))var _0x1cdc3e=users[_0xf670f2(0x1b9)];else{if(_0x39fd8f[0x0]['language']==_0xf670f2(0x1c6))var _0x1cdc3e=users['Portuguese'];else{if(_0x39fd8f[0x0]['language']==_0xf670f2(0x1ad))var _0x1cdc3e=users[_0xf670f2(0x1ad)];else{if(_0x39fd8f[0x0][_0xf670f2(0x13f)]==_0xf670f2(0x168))var _0x1cdc3e=users[_0xf670f2(0x1bd)];}}}}}}}_0x567d0d[_0xf670f2(0x187)]('edit_transfer_finished',{'success':_0x13adaf[_0xf670f2(0x121)](_0xf670f2(0x149)),'errors':_0x13adaf[_0xf670f2(0x121)](_0xf670f2(0x1a6)),'role':_0x1e3b73,'profile':_0x41a170,'master_shop':_0x39fd8f,'warehouse':_0x5abd0f,'transfer':_0x22b505,'stock':_0x434faa,'unit':_0x451d11,'language':_0x1cdc3e,'levels':_0x42acb1,'Isle':_0x30a34f,'rooms_data':_0x1360f3,'ed_fullDate':_0x5c3e70,'dataSelected':_0x18bcc1});}catch(_0x42e171){console[_0xf670f2(0x18a)](_0x42e171);}}),router['post'](a0_0x445aec(0x1a7),auth,async(_0x32516b,_0x149f7f)=>{var _0x2823ed=a0_0x445aec;try{const _0x7504b2=_0x32516b[_0x2823ed(0x1a5)]['id'];console[_0x2823ed(0x18a)](_0x32516b[_0x2823ed(0x18b)]);const _0x15e1c6=await transfers_finished[_0x2823ed(0x1a2)](_0x7504b2);console[_0x2823ed(0x18a)](_0x2823ed(0x1ba),_0x15e1c6);const {date:_0x2a00d2,from_warehouse:_0x8492bb,FromRoom_name:_0x162c55,to_warehouse:_0xa6d47e,ToRoom_name:_0x198d63,prod_name:_0x5668bb,from_prod_qty:_0x39dcaf,from_prod_level:_0x557eb1,from_prod_isle:_0x87d8a1,from_prod_pallet:_0x103200,to_prod_qty:_0x4ce804,to_prod_level:_0x27d7e3,to_prod_isle:_0xa1c74c,to_prod_pallet:_0x301108,primary_code:_0x9f7289,secondary_code:_0x290098,product_code3:_0x262ea5,note:_0x46c844,invoice:_0x11ea1e,expiry_date:_0x15726f}=_0x32516b[_0x2823ed(0x18b)];if(typeof _0x5668bb==_0x2823ed(0x11f))var _0x18c9ff=[_0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x1cb)]],_0x426ed9=[_0x32516b[_0x2823ed(0x18b)]['from_prod_qty']],_0x9b2238=[_0x32516b['body'][_0x2823ed(0x1b7)]],_0x1efa2b=[_0x32516b['body'][_0x2823ed(0x133)]],_0x2d8d38=[_0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x160)]],_0x1c0557=[_0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x177)]],_0x201ae7=[_0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x190)]],_0x79c954=[_0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x185)]],_0x31907e=[_0x32516b['body'][_0x2823ed(0x1d2)]],_0x2f5dda=[_0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x19f)]],_0x418a55=[_0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x119)]],_0x28f6e7=[_0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x1cc)]],_0x1252a9=[_0x32516b[_0x2823ed(0x18b)]['expiry_date']];else var _0x18c9ff=[..._0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x1cb)]],_0x426ed9=[..._0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x114)]],_0x9b2238=[..._0x32516b['body']['from_prod_level']],_0x1efa2b=[..._0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x133)]],_0x2d8d38=[..._0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x160)]],_0x1c0557=[..._0x32516b['body'][_0x2823ed(0x177)]],_0x201ae7=[..._0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x190)]],_0x79c954=[..._0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x185)]],_0x31907e=[..._0x32516b[_0x2823ed(0x18b)]['MaxStocks_data2']],_0x2f5dda=[..._0x32516b['body'][_0x2823ed(0x19f)]],_0x418a55=[..._0x32516b['body']['secondary_unit']],_0x28f6e7=[..._0x32516b[_0x2823ed(0x18b)][_0x2823ed(0x1cc)]],_0x1252a9=[..._0x32516b['body']['expiry_date']];const _0x535c69=_0x18c9ff[_0x2823ed(0x17c)](_0x17ebbc=>{return _0x17ebbc={'product_name':_0x17ebbc};});_0x426ed9[_0x2823ed(0x1aa)]((_0x3bcd72,_0x1b602f)=>{var _0x998eb0=_0x2823ed;_0x535c69[_0x1b602f][_0x998eb0(0x18c)]=_0x3bcd72;}),_0x9b2238['forEach']((_0x55fda0,_0x56aed7)=>{_0x535c69[_0x56aed7]['from_bay']=_0x55fda0;}),_0x1efa2b[_0x2823ed(0x1aa)]((_0x898a8b,_0x5a8093)=>{_0x535c69[_0x5a8093]['to_quantity']=_0x898a8b;}),_0x2d8d38[_0x2823ed(0x1aa)]((_0x5516d6,_0x4cb80e)=>{var _0x5cb449=_0x2823ed;_0x535c69[_0x4cb80e][_0x5cb449(0x18d)]=_0x5516d6;}),_0x1c0557['forEach']((_0x5b5124,_0x5c9067)=>{var _0x30d89e=_0x2823ed;_0x535c69[_0x5c9067][_0x30d89e(0x177)]=_0x5b5124;}),_0x201ae7[_0x2823ed(0x1aa)]((_0x4a22c8,_0x9e51ce)=>{var _0x142d20=_0x2823ed;_0x535c69[_0x9e51ce][_0x142d20(0x190)]=_0x4a22c8;}),_0x79c954['forEach']((_0x285c75,_0x511fd5)=>{_0x535c69[_0x511fd5]['product_code']=_0x285c75;}),_0x31907e[_0x2823ed(0x1aa)]((_0x4a5208,_0x584d4b)=>{_0x535c69[_0x584d4b]['maxProducts']=_0x4a5208;}),_0x2f5dda['forEach']((_0xeed176,_0x248384)=>{var _0x1e5679=_0x2823ed;_0x535c69[_0x248384][_0x1e5679(0x19f)]=_0xeed176;}),_0x418a55[_0x2823ed(0x1aa)]((_0x500c4,_0x288b08)=>{var _0x122dc1=_0x2823ed;_0x535c69[_0x288b08][_0x122dc1(0x119)]=_0x500c4;}),_0x28f6e7[_0x2823ed(0x1aa)]((_0x4b5d52,_0x38a68e)=>{_0x535c69[_0x38a68e]['batch_code']=_0x4b5d52;}),_0x1252a9[_0x2823ed(0x1aa)]((_0x2e839b,_0x5b4141)=>{var _0x5b61d5=_0x2823ed;_0x535c69[_0x5b4141][_0x5b61d5(0x116)]=_0x2e839b;});const _0x432f7b=_0x535c69['filter'](_0x41b74a=>_0x41b74a[_0x2823ed(0x1cf)]!=='0'&&_0x41b74a['to_quantity']!==''||_0x41b74a[_0x2823ed(0x18f)]!=='0'&&_0x41b74a[_0x2823ed(0x18f)]!=='');var _0x4e8bea=0x0;_0x432f7b['forEach'](_0x1c2c0d=>{var _0x565416=_0x2823ed;parseInt(_0x1c2c0d[_0x565416(0x18c)])<parseInt(_0x1c2c0d['to_quantity'])&&_0x4e8bea++;});if(_0x4e8bea!=0x0)return _0x32516b[_0x2823ed(0x121)](_0x2823ed(0x1a6),_0x2823ed(0x181)),_0x149f7f[_0x2823ed(0x1d4)](_0x2823ed(0x123));const _0x52fa2d=await warehouse['findOne']({'name':_0x15e1c6[_0x2823ed(0x19b)],'room':_0x15e1c6[_0x2823ed(0x155)]});_0x15e1c6[_0x2823ed(0x17a)][_0x2823ed(0x1aa)](_0x21cce3=>{var _0x23d87c=_0x2823ed;if(_0x21cce3['to_quantity']>0x0){const _0x5d27c3=_0x52fa2d[_0x23d87c(0x15d)][_0x23d87c(0x17c)](_0x5df751=>{var _0x476a30=_0x23d87c;_0x5df751[_0x476a30(0x122)]==_0x21cce3[_0x476a30(0x122)]&&_0x5df751['bay']==_0x21cce3[_0x476a30(0x145)]&&(_0x5df751['product_stock']=parseInt(_0x5df751[_0x476a30(0x12f)])+parseInt(_0x21cce3[_0x476a30(0x1cf)]));});}}),await _0x52fa2d['save']();const _0x32c3b3=await warehouse[_0x2823ed(0x1b2)]({'name':_0x15e1c6[_0x2823ed(0x150)],'room':_0x15e1c6[_0x2823ed(0x19c)]});_0x15e1c6[_0x2823ed(0x17a)][_0x2823ed(0x1aa)](_0xa2b99=>{var _0x28f7d0=_0x2823ed;if(_0xa2b99[_0x28f7d0(0x1cf)]>0x0){const _0x479ead=_0x32c3b3[_0x28f7d0(0x15d)][_0x28f7d0(0x17c)](_0x5cfdec=>{var _0x1616e8=_0x28f7d0;_0x5cfdec[_0x1616e8(0x122)]==_0xa2b99[_0x1616e8(0x122)]&&_0x5cfdec['bay']==_0xa2b99[_0x1616e8(0x18d)]&&(_0x5cfdec['product_stock']=parseInt(_0x5cfdec[_0x1616e8(0x12f)])-parseInt(_0xa2b99['to_quantity']));});}}),await _0x32c3b3[_0x2823ed(0x1c0)](),_0x15e1c6[_0x2823ed(0x1ae)]=_0x2a00d2,_0x15e1c6[_0x2823ed(0x19b)]=_0x8492bb,_0x15e1c6[_0x2823ed(0x150)]=_0xa6d47e,_0x15e1c6[_0x2823ed(0x17a)]=_0x432f7b,_0x15e1c6['note']=_0x46c844,_0x15e1c6[_0x2823ed(0x184)]=_0x11ea1e;const _0x522609=await _0x15e1c6['save'](),_0x383df4=await warehouse['findOne']({'name':_0x8492bb,'room':_0x162c55});_0x522609[_0x2823ed(0x17a)][_0x2823ed(0x1aa)](_0x311201=>{var _0x34f0e0=_0x2823ed;if(_0x311201[_0x34f0e0(0x1cf)]>0x0){const _0x25f303=_0x383df4[_0x34f0e0(0x15d)][_0x34f0e0(0x17c)](_0x2a2f2b=>{var _0x4e05d4=_0x34f0e0;_0x2a2f2b[_0x4e05d4(0x122)]==_0x311201[_0x4e05d4(0x122)]&&_0x2a2f2b[_0x4e05d4(0x15a)]==_0x311201[_0x4e05d4(0x145)]&&(_0x2a2f2b['product_stock']=parseInt(_0x2a2f2b[_0x4e05d4(0x12f)])-parseInt(_0x311201[_0x4e05d4(0x1cf)]));});}}),await _0x383df4['save']();const _0x50505d=await warehouse[_0x2823ed(0x1b2)]({'name':_0xa6d47e,'room':_0x198d63});_0x522609['product'][_0x2823ed(0x1aa)](_0x37d566=>{var _0x38e3ed=_0x2823ed;if(_0x37d566['to_quantity']>0x0){var _0x41b477=0x0;const _0x319528=_0x50505d[_0x38e3ed(0x15d)][_0x38e3ed(0x17c)](_0x42003c=>{var _0x490329=_0x38e3ed;_0x42003c['product_name']==_0x37d566[_0x490329(0x122)]&&_0x42003c[_0x490329(0x15a)]==_0x37d566[_0x490329(0x18d)]&&(_0x42003c['product_stock']=parseInt(_0x42003c['product_stock'])+parseInt(_0x37d566[_0x490329(0x1cf)]),_0x41b477++);});_0x41b477=='0'&&(_0x50505d[_0x38e3ed(0x15d)]=_0x50505d[_0x38e3ed(0x15d)][_0x38e3ed(0x153)]({'product_name':_0x37d566[_0x38e3ed(0x122)],'product_stock':_0x37d566[_0x38e3ed(0x1cf)],'bay':_0x37d566[_0x38e3ed(0x18d)],'product_code':_0x37d566[_0x38e3ed(0x16e)],'primary_code':_0x37d566[_0x38e3ed(0x177)],'secondary_code':_0x37d566['secondary_code'],'maxProducts':_0x37d566[_0x38e3ed(0x197)]}));}}),await _0x50505d[_0x2823ed(0x1c0)](),_0x32516b['flash']('success','Transfer\x20Edit\x20Successfully'),_0x149f7f[_0x2823ed(0x1d4)](_0x2823ed(0x16f));}catch(_0x1ad655){console[_0x2823ed(0x18a)](_0x1ad655);}}),router[a0_0x445aec(0x173)](a0_0x445aec(0x12c),async(_0x547c30,_0x3704f3)=>{var _0x627d4a=a0_0x445aec;const {FromWareHouse:_0xe41a6e,FromRoom:_0x567ddf,ToWarehouse:_0x206729,ToRoom:_0x4074db,primary_code:_0x103a13,Roomslist:_0x4b985a}=_0x547c30['body'],_0x204270=_0x4b985a['split'](','),_0x5257a7=[];async function _0x4cb09e(_0x473f94){var _0x45dbe4=a0_0x23c9;const _0x1ef6ad=await warehouse[_0x45dbe4(0x146)]([{'$match':{'name':_0xe41a6e,'room':_0x473f94}},{'$unwind':_0x45dbe4(0x1bf)},{'$match':{'product_details.primary_code':_0x103a13}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x45dbe4(0x19a)},'instock':{'$first':_0x45dbe4(0x161)},'primary_code':{'$first':_0x45dbe4(0x1a8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x45dbe4(0x164)},'bay':{'$first':_0x45dbe4(0x154)},'level':{'$first':_0x45dbe4(0x17b)},'type':{'$first':_0x45dbe4(0x194)},'pallet':{'$first':_0x45dbe4(0x134)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x45dbe4(0x1d5)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x45dbe4(0x14a)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x45dbe4(0x14e)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x45dbe4(0x128)}}}]),_0x4a1ccd=await warehouse[_0x45dbe4(0x146)]([{'$match':{'name':_0xe41a6e,'room':_0x473f94}},{'$unwind':_0x45dbe4(0x1bf)},{'$match':{'product_details.secondary_code':_0x103a13}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x45dbe4(0x19a)},'instock':{'$first':_0x45dbe4(0x161)},'primary_code':{'$first':_0x45dbe4(0x1a8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x45dbe4(0x154)},'level':{'$first':_0x45dbe4(0x17b)},'type':{'$first':_0x45dbe4(0x194)},'pallet':{'$first':_0x45dbe4(0x134)},'unit':{'$first':_0x45dbe4(0x167)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x45dbe4(0x1d5)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x45dbe4(0x14a)},'production_date':{'$first':_0x45dbe4(0x1a0)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x45dbe4(0x14e)},'roomNamed':{'$first':_0x45dbe4(0x148)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x45dbe4(0x128)}}}]);if(_0x1ef6ad[_0x45dbe4(0x17f)]>0x0)_0x5257a7[_0x45dbe4(0x142)](_0x1ef6ad);else _0x4a1ccd[_0x45dbe4(0x17f)]>0x0&&_0x5257a7[_0x45dbe4(0x142)](_0x4a1ccd);}const _0x4552fd=_0x204270[_0x627d4a(0x17c)](_0x367f11=>_0x4cb09e(_0x367f11));await Promise[_0x627d4a(0x13c)](_0x4552fd),_0x3704f3[_0x627d4a(0x156)](_0x5257a7);}),router[a0_0x445aec(0x173)](a0_0x445aec(0x169),async(_0x480ec9,_0x23191a)=>{var _0x5a26f4=a0_0x445aec;const {productCode:_0x1a8df6,bay:_0x5ae13a,warehouses:_0x492e7f,room:_0x41ae01}=_0x480ec9[_0x5a26f4(0x18b)];console[_0x5a26f4(0x18a)](_0x480ec9['body']);try{const _0x437f75=await warehouse['aggregate']([{'$match':{'name':_0x492e7f,'room':_0x41ae01}},{'$unwind':_0x5a26f4(0x1bf)},{'$match':{'product_details.bay':parseInt(_0x5ae13a)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5a26f4(0x161)},'bay':{'$first':_0x5a26f4(0x154)},'maxProducts':{'$first':_0x5a26f4(0x11b)}}}]);_0x23191a[_0x5a26f4(0x113)](0xc8)[_0x5a26f4(0x156)](_0x437f75);}catch(_0x2b1c94){_0x23191a['status'](0x194)[_0x5a26f4(0x156)]({'message':_0x2b1c94[_0x5a26f4(0x189)]});}}),module[a0_0x445aec(0x175)]=router;