var a0_0x1497c9=a0_0x2144;function a0_0x2144(_0x4a911a,_0x1e5b3d){var _0x4d5684=a0_0x4d56();return a0_0x2144=function(_0x214475,_0x466531){_0x214475=_0x214475-0x1ce;var _0x372ae0=_0x4d5684[_0x214475];return _0x372ae0;},a0_0x2144(_0x4a911a,_0x1e5b3d);}(function(_0x4ee79e,_0x1a3209){var _0x25a08b=a0_0x2144,_0x5158ae=_0x4ee79e();while(!![]){try{var _0x41673a=parseInt(_0x25a08b(0x259))/0x1*(parseInt(_0x25a08b(0x1ef))/0x2)+parseInt(_0x25a08b(0x236))/0x3*(parseInt(_0x25a08b(0x1d6))/0x4)+-parseInt(_0x25a08b(0x22c))/0x5+parseInt(_0x25a08b(0x293))/0x6*(-parseInt(_0x25a08b(0x258))/0x7)+parseInt(_0x25a08b(0x1df))/0x8+-parseInt(_0x25a08b(0x284))/0x9*(parseInt(_0x25a08b(0x1f0))/0xa)+parseInt(_0x25a08b(0x285))/0xb*(-parseInt(_0x25a08b(0x264))/0xc);if(_0x41673a===_0x1a3209)break;else _0x5158ae['push'](_0x5158ae['shift']());}catch(_0x3eff3c){_0x5158ae['push'](_0x5158ae['shift']());}}}(a0_0x4d56,0x64740));const express=require('express'),app=express(),router=express[a0_0x1497c9(0x1d5)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require('../models/all_models'),auth=require(a0_0x1497c9(0x253)),users=require(a0_0x1497c9(0x25b)),nodemailer=require(a0_0x1497c9(0x229));router['get'](a0_0x1497c9(0x216),auth,async(_0x391b84,_0x5530e5)=>{var _0x116edc=a0_0x1497c9;try{const {username:_0x3d1873,email:_0x2efd94,role:_0x6ddeb0}=_0x391b84[_0x116edc(0x27e)],_0x342c5b=_0x391b84['user'],_0x266a7f=await profile[_0x116edc(0x1ec)]({'email':_0x342c5b[_0x116edc(0x1e1)]}),_0x3441c5=await master_shop[_0x116edc(0x274)]();let _0x40b7d0;if(_0x342c5b[_0x116edc(0x200)]==_0x116edc(0x234)){const _0x39104a=await staff['findOne']({'email':_0x342c5b[_0x116edc(0x1e1)]});_0x40b7d0=await transfers_finished[_0x116edc(0x274)]({'from_warehouse':_0x39104a[_0x116edc(0x1eb)]});}else _0x40b7d0=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x116edc(0x28d)}},{'$unwind':_0x116edc(0x267)},{'$group':{'_id':_0x116edc(0x290),'invoice':{'$first':'$invoice'},'date':{'$first':_0x116edc(0x24f)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x116edc(0x256)},'to_room_name':{'$addToSet':_0x116edc(0x237)},'finalize':{'$first':_0x116edc(0x20a)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3441c5[0x0][_0x116edc(0x24c)]==_0x116edc(0x269))var _0x5d1315=users['English'];else{if(_0x3441c5[0x0]['language']==_0x116edc(0x25d))var _0x5d1315=users['Hindi'];else{if(_0x3441c5[0x0][_0x116edc(0x24c)]==_0x116edc(0x255))var _0x5d1315=users[_0x116edc(0x255)];else{if(_0x3441c5[0x0][_0x116edc(0x24c)]==_0x116edc(0x227))var _0x5d1315=users[_0x116edc(0x227)];else{if(_0x3441c5[0x0]['language']==_0x116edc(0x275))var _0x5d1315=users['French'];else{if(_0x3441c5[0x0]['language']==_0x116edc(0x25c))var _0x5d1315=users[_0x116edc(0x240)];else{if(_0x3441c5[0x0][_0x116edc(0x24c)]==_0x116edc(0x202))var _0x5d1315=users[_0x116edc(0x202)];else{if(_0x3441c5[0x0][_0x116edc(0x24c)]==_0x116edc(0x24b))var _0x5d1315=users[_0x116edc(0x273)];}}}}}}}_0x5530e5['render'](_0x116edc(0x28c),{'success':_0x391b84['flash']('success'),'errors':_0x391b84[_0x116edc(0x235)](_0x116edc(0x1e3)),'role':_0x342c5b,'profile':_0x266a7f,'master_shop':_0x3441c5,'transfer':_0x40b7d0,'language':_0x5d1315});}catch(_0x55df79){console[_0x116edc(0x276)](_0x55df79);}}),router['get'](a0_0x1497c9(0x23f),auth,async(_0x512492,_0x473544)=>{var _0x565aaa=a0_0x1497c9;try{const {username:_0x33c6b1,email:_0x885e72,role:_0x562f1b}=_0x512492[_0x565aaa(0x27e)],_0x5b61bb=_0x512492[_0x565aaa(0x27e)],_0x40f545=await profile[_0x565aaa(0x1ec)]({'email':_0x5b61bb['email']}),_0x2208bd=await master_shop[_0x565aaa(0x274)]();let _0x2c738d;if(_0x5b61bb[_0x565aaa(0x200)]=='staff'){const _0x2125f7=await staff[_0x565aaa(0x1ec)]({'email':_0x5b61bb[_0x565aaa(0x1e1)]});_0x2c738d=await transfers_finished[_0x565aaa(0x274)]({'from_warehouse':_0x2125f7['warehouse']});}else _0x2c738d=await transfers_finished[_0x565aaa(0x22d)]([{'$match':{'type_of_transaction':_0x565aaa(0x254)}},{'$unwind':_0x565aaa(0x267)},{'$group':{'_id':_0x565aaa(0x290),'invoice':{'$first':_0x565aaa(0x219)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x565aaa(0x1fa)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x565aaa(0x256)},'to_room_name':{'$addToSet':_0x565aaa(0x237)},'finalize':{'$first':_0x565aaa(0x20a)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2208bd[0x0][_0x565aaa(0x24c)]=='English\x20(US)')var _0x32b0ac=users['English'];else{if(_0x2208bd[0x0][_0x565aaa(0x24c)]==_0x565aaa(0x25d))var _0x32b0ac=users[_0x565aaa(0x25d)];else{if(_0x2208bd[0x0][_0x565aaa(0x24c)]==_0x565aaa(0x255))var _0x32b0ac=users[_0x565aaa(0x255)];else{if(_0x2208bd[0x0][_0x565aaa(0x24c)]==_0x565aaa(0x227))var _0x32b0ac=users[_0x565aaa(0x227)];else{if(_0x2208bd[0x0][_0x565aaa(0x24c)]==_0x565aaa(0x275))var _0x32b0ac=users[_0x565aaa(0x275)];else{if(_0x2208bd[0x0][_0x565aaa(0x24c)]==_0x565aaa(0x25c))var _0x32b0ac=users[_0x565aaa(0x240)];else{if(_0x2208bd[0x0]['language']==_0x565aaa(0x202))var _0x32b0ac=users[_0x565aaa(0x202)];else{if(_0x2208bd[0x0][_0x565aaa(0x24c)]==_0x565aaa(0x24b))var _0x32b0ac=users['Arabic'];}}}}}}}_0x473544[_0x565aaa(0x1da)](_0x565aaa(0x23a),{'success':_0x512492[_0x565aaa(0x235)](_0x565aaa(0x1f1)),'errors':_0x512492['flash']('errors'),'role':_0x5b61bb,'profile':_0x40f545,'master_shop':_0x2208bd,'transfer':_0x2c738d,'language':_0x32b0ac});}catch(_0x621ffd){console['log'](_0x621ffd);}});async function getRandom8DigitNumber(){var _0x30c945=a0_0x1497c9;const _0x5a9f81=0x989680,_0x252567=0x5f5e0ff,_0x31a51b=Math[_0x30c945(0x1f2)](Math[_0x30c945(0x217)]()*(_0x252567-_0x5a9f81+0x1))+_0x5a9f81;var _0x2d5d93;const _0x4c1bca=await transfers_finished['findOne']({'invoice':_0x30c945(0x278)+_0x31a51b});return _0x4c1bca&&_0x4c1bca[_0x30c945(0x1f7)]>0x0?_0x2d5d93=_0x30c945(0x278)+_0x31a51b:_0x2d5d93='TRFF-'+_0x31a51b,_0x2d5d93;}function a0_0x4d56(){var _0x5964a3=['$product_details.type','/view/add_transfer','1206955wokteV','aggregate','$product_details.secondary_unit','from_prod_level2','_id','back','exports','New_Qty_Converted','staff','flash','59487lnVyxD','$product.to_room_name','$product_details.product_stock','to_room_name','transfer_finished_logs','production_date','\x20<>\x20','finalize','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/view_logs','Portuguese','getMonth','product','$product_details','get','message','/CheckingWarehouse','$product_details.rack','TRF-','$product_details.primary_code','type_of_process','Arabic\x20(ae)','language','maxPerUnit','/preview/:id','$date','primary_unit','$product_details.invoice','Finished\x20Goods','../middleware/auth','logs','German','$product.from_room_name','prod_cat','63KjEoJd','5512qUHJxS','/transfer_finished/view','../public/language/languages.json','Portuguese\x20(BR)','Hindi','getFullYear','forEach','to_prod_level','secondary_unit','/transfer/view','findById','132cadjMX','string','then','$product','Rack\x201','English\x20(US)','</td>','maxProducts','status','$product_details.product_code','Enclosed','push','bin2bin','to_prod_qty','prod_name','Arabic','find','French','log','choos_transfer','TRFF-','secondary_code','$product_details.secondary_code','here2','$product_details._id','product_date','user','choos_transfer_logs','$product_details.floorlevel','True','body','abs','98019bJQpCt','392942KXdCtQ','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','redirect','/transfer_finished/preview/','An\x20error\x20occurred.','date','transfer_data','transfer_finished','own','unit','English','$_id','/view/addlog','$product_details.maxPerUnit','15378YYjeTG','to_level','to_quantity','edit_transfer_finished_view','location2location','product_stock','/view/choose_logs','from_bay','toString','/view/add_transfer_logs','batch_code','$room','to_floorlevel','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Router','164ZQUnsg','invoice','add_transfer_finished','to_bay','render','from_warehouse','Enabled','match','catch','4309072fAIrja','</tr>','email','padStart','errors','Product\x20Transfer\x20successfully','/view/:id','Transfer\x20Finalize\x20Successfully','to_room','from_quantity','$product_details.expiry_date','from_invoice','warehouse','findOne','$product_details.level','$product_details.production_date','12dFIvks','290UPsSSu','success','floor','from_level','concat','$name','post','length','filter','MaxStocks_data','$from_warehouse','to_warehouse','$product_details.batch_code','save','id_transaction','max','role','product_name','Chinese','expiry_date','$product_details.storage','all','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','Rack\x202','json','bay','$finalize','<tr>','/picking_list/PDF_transfer/','Ambient','LOG-TRF-','primary_code','map','ToRoomAssigned','$product_details.product_name','error','To_invoice','product_code','/view','random','getDate','$invoice','undefined','product_details','$product_details.bay','RoomAssigned','params','MaxStocks_data2','slice','updateOne','from_room_name','invoice_init','from_prod_qty','product_code3','from_prod_level','Spanish','$product_details.unit','nodemailer'];a0_0x4d56=function(){return _0x5964a3;};return a0_0x4d56();}router[a0_0x1497c9(0x244)]('/view/add_transfer',auth,async(_0x47d569,_0x382cb0)=>{var _0x4cf677=a0_0x1497c9;try{const {username:_0x29d17a,email:_0x1c540a,role:_0x1e5291}=_0x47d569[_0x4cf677(0x27e)],_0x4605f4=_0x47d569[_0x4cf677(0x27e)],_0x253720=await profile[_0x4cf677(0x1ec)]({'email':_0x4605f4['email']}),_0x1c7350=await master_shop[_0x4cf677(0x274)]();let _0xe8d228;if(_0x4605f4[_0x4cf677(0x200)]=='staff'){const _0x171ea7=await staff[_0x4cf677(0x1ec)]({'email':_0x4605f4[_0x4cf677(0x1e1)]});_0xe8d228=await warehouse[_0x4cf677(0x22d)]([{'$match':{'status':_0x4cf677(0x1dc),'name':_0x171ea7[_0x4cf677(0x1eb)]}},{'$group':{'_id':_0x4cf677(0x1f5),'name':{'$first':_0x4cf677(0x1f5)}}}]);}else _0xe8d228=await warehouse['aggregate']([{'$match':{'status':_0x4cf677(0x1dc)}},{'$group':{'_id':_0x4cf677(0x1f5),'name':{'$first':'$name'}}}]);const _0x11cc42=await transfers_finished[_0x4cf677(0x274)]({}),_0x98e82a=_0x11cc42[_0x4cf677(0x1f7)]+0x1,_0x192e27='TRFF-'+_0x98e82a[_0x4cf677(0x1cf)]()[_0x4cf677(0x1e2)](0x5,'0');if(_0x1c7350[0x0][_0x4cf677(0x24c)]==_0x4cf677(0x269))var _0x2bdf5f=users[_0x4cf677(0x28f)];else{if(_0x1c7350[0x0][_0x4cf677(0x24c)]==_0x4cf677(0x25d))var _0x2bdf5f=users['Hindi'];else{if(_0x1c7350[0x0][_0x4cf677(0x24c)]=='German')var _0x2bdf5f=users[_0x4cf677(0x255)];else{if(_0x1c7350[0x0][_0x4cf677(0x24c)]==_0x4cf677(0x227))var _0x2bdf5f=users[_0x4cf677(0x227)];else{if(_0x1c7350[0x0]['language']==_0x4cf677(0x275))var _0x2bdf5f=users[_0x4cf677(0x275)];else{if(_0x1c7350[0x0]['language']==_0x4cf677(0x25c))var _0x2bdf5f=users['Portuguese'];else{if(_0x1c7350[0x0][_0x4cf677(0x24c)]==_0x4cf677(0x202))var _0x2bdf5f=users[_0x4cf677(0x202)];else{if(_0x1c7350[0x0][_0x4cf677(0x24c)]=='Arabic\x20(ae)')var _0x2bdf5f=users[_0x4cf677(0x273)];}}}}}}}const _0x12ffb9=getRandom8DigitNumber();_0x12ffb9[_0x4cf677(0x266)](_0x3faeba=>{var _0x461af9=_0x4cf677;_0x382cb0[_0x461af9(0x1da)](_0x461af9(0x1d8),{'success':_0x47d569[_0x461af9(0x235)](_0x461af9(0x1f1)),'errors':_0x47d569[_0x461af9(0x235)](_0x461af9(0x1e3)),'role':_0x4605f4,'profile':_0x253720,'master_shop':_0x1c7350,'warehouse':_0xe8d228,'language':_0x2bdf5f,'invoice':_0x3faeba});})[_0x4cf677(0x1de)](_0x13a783=>{var _0x37f90a=_0x4cf677;_0x47d569[_0x37f90a(0x235)]('errors',_0x37f90a(0x1d4)),_0x382cb0['redirect'](_0x37f90a(0x262));});}catch(_0x5e08c8){console[_0x4cf677(0x276)](_0x5e08c8);}}),router[a0_0x1497c9(0x244)]('/view/choose',auth,async(_0x25cee8,_0xe9937c)=>{var _0x21e1ae=a0_0x1497c9;try{const {username:_0x2ce1af,email:_0x2ed646,role:_0x5b2d66}=_0x25cee8[_0x21e1ae(0x27e)],_0x5138b1=_0x25cee8['user'],_0x432d56=await profile[_0x21e1ae(0x1ec)]({'email':_0x5138b1['email']}),_0x41dfc7=await master_shop['find']();let _0xd60307;if(_0x5138b1[_0x21e1ae(0x200)]==_0x21e1ae(0x234)){const _0x49fb67=await staff[_0x21e1ae(0x1ec)]({'email':_0x5138b1[_0x21e1ae(0x1e1)]});_0xd60307=await warehouse[_0x21e1ae(0x22d)]([{'$match':{'status':_0x21e1ae(0x1dc),'name':_0x49fb67[_0x21e1ae(0x1eb)]}},{'$group':{'_id':_0x21e1ae(0x1f5),'name':{'$first':_0x21e1ae(0x1f5)}}}]);}else _0xd60307=await warehouse[_0x21e1ae(0x22d)]([{'$match':{'status':_0x21e1ae(0x1dc)}},{'$group':{'_id':'$name','name':{'$first':_0x21e1ae(0x1f5)}}}]);const _0x149627=await transfers_finished[_0x21e1ae(0x274)]({}),_0x73ead5=_0x149627[_0x21e1ae(0x1f7)]+0x1,_0x5b130a=_0x21e1ae(0x278)+_0x73ead5['toString']()[_0x21e1ae(0x1e2)](0x5,'0');if(_0x41dfc7[0x0][_0x21e1ae(0x24c)]==_0x21e1ae(0x269))var _0x169b6a=users[_0x21e1ae(0x28f)];else{if(_0x41dfc7[0x0]['language']==_0x21e1ae(0x25d))var _0x169b6a=users[_0x21e1ae(0x25d)];else{if(_0x41dfc7[0x0][_0x21e1ae(0x24c)]==_0x21e1ae(0x255))var _0x169b6a=users[_0x21e1ae(0x255)];else{if(_0x41dfc7[0x0][_0x21e1ae(0x24c)]==_0x21e1ae(0x227))var _0x169b6a=users[_0x21e1ae(0x227)];else{if(_0x41dfc7[0x0][_0x21e1ae(0x24c)]==_0x21e1ae(0x275))var _0x169b6a=users[_0x21e1ae(0x275)];else{if(_0x41dfc7[0x0][_0x21e1ae(0x24c)]==_0x21e1ae(0x25c))var _0x169b6a=users['Portuguese'];else{if(_0x41dfc7[0x0][_0x21e1ae(0x24c)]=='Chinese')var _0x169b6a=users['Chinese'];else{if(_0x41dfc7[0x0][_0x21e1ae(0x24c)]==_0x21e1ae(0x24b))var _0x169b6a=users[_0x21e1ae(0x273)];}}}}}}}const _0x1a1d79=getRandom8DigitNumber();_0x1a1d79['then'](_0x1f98aa=>{var _0x2931a5=_0x21e1ae;_0xe9937c[_0x2931a5(0x1da)](_0x2931a5(0x277),{'success':_0x25cee8['flash'](_0x2931a5(0x1f1)),'errors':_0x25cee8[_0x2931a5(0x235)](_0x2931a5(0x1e3)),'role':_0x5138b1,'profile':_0x432d56,'master_shop':_0x41dfc7,'warehouse':_0xd60307,'language':_0x169b6a,'invoice':_0x1f98aa});})[_0x21e1ae(0x1de)](_0x3958be=>{var _0x54f322=_0x21e1ae;_0x25cee8['flash'](_0x54f322(0x1e3),_0x54f322(0x1d4)),_0xe9937c['redirect'](_0x54f322(0x262));});}catch(_0x11754b){console[_0x21e1ae(0x276)](_0x11754b);}}),router[a0_0x1497c9(0x244)](a0_0x1497c9(0x299),auth,async(_0x16cc46,_0x33ff65)=>{var _0x15b56f=a0_0x1497c9;try{const {username:_0x406907,email:_0x9b3b1,role:_0xb46670}=_0x16cc46['user'],_0x3bf94b=_0x16cc46[_0x15b56f(0x27e)],_0xdd3c50=await profile[_0x15b56f(0x1ec)]({'email':_0x3bf94b[_0x15b56f(0x1e1)]}),_0x59780d=await master_shop[_0x15b56f(0x274)]();let _0x194b2c;if(_0x3bf94b[_0x15b56f(0x200)]==_0x15b56f(0x234)){const _0x378e10=await staff[_0x15b56f(0x1ec)]({'email':_0x3bf94b[_0x15b56f(0x1e1)]});_0x194b2c=await warehouse[_0x15b56f(0x22d)]([{'$match':{'status':_0x15b56f(0x1dc),'name':_0x378e10[_0x15b56f(0x1eb)]}},{'$group':{'_id':_0x15b56f(0x1f5),'name':{'$first':'$name'}}}]);}else _0x194b2c=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x15b56f(0x1f5),'name':{'$first':_0x15b56f(0x1f5)}}}]);const _0x333103=await transfers_finished[_0x15b56f(0x274)]({}),_0x44aa70=_0x333103[_0x15b56f(0x1f7)]+0x1,_0x24bb6c=_0x15b56f(0x278)+_0x44aa70['toString']()['padStart'](0x5,'0');if(_0x59780d[0x0]['language']==_0x15b56f(0x269))var _0xcde62a=users[_0x15b56f(0x28f)];else{if(_0x59780d[0x0][_0x15b56f(0x24c)]==_0x15b56f(0x25d))var _0xcde62a=users['Hindi'];else{if(_0x59780d[0x0][_0x15b56f(0x24c)]=='German')var _0xcde62a=users['German'];else{if(_0x59780d[0x0][_0x15b56f(0x24c)]==_0x15b56f(0x227))var _0xcde62a=users[_0x15b56f(0x227)];else{if(_0x59780d[0x0]['language']==_0x15b56f(0x275))var _0xcde62a=users[_0x15b56f(0x275)];else{if(_0x59780d[0x0][_0x15b56f(0x24c)]==_0x15b56f(0x25c))var _0xcde62a=users['Portuguese'];else{if(_0x59780d[0x0]['language']==_0x15b56f(0x202))var _0xcde62a=users[_0x15b56f(0x202)];else{if(_0x59780d[0x0][_0x15b56f(0x24c)]==_0x15b56f(0x24b))var _0xcde62a=users[_0x15b56f(0x273)];}}}}}}}const _0x1fa026=getRandom8DigitNumber();_0x1fa026['then'](_0x35e5a7=>{var _0x1a216a=_0x15b56f;_0x33ff65[_0x1a216a(0x1da)](_0x1a216a(0x27f),{'success':_0x16cc46['flash'](_0x1a216a(0x1f1)),'errors':_0x16cc46[_0x1a216a(0x235)]('errors'),'role':_0x3bf94b,'profile':_0xdd3c50,'master_shop':_0x59780d,'warehouse':_0x194b2c,'language':_0xcde62a,'invoice':_0x35e5a7});})[_0x15b56f(0x1de)](_0x226df8=>{var _0x5d635d=_0x15b56f;_0x16cc46[_0x5d635d(0x235)](_0x5d635d(0x1e3),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x33ff65[_0x5d635d(0x287)](_0x5d635d(0x262));});}catch(_0x39f128){console['log'](_0x39f128);}}),router[a0_0x1497c9(0x1f6)](a0_0x1497c9(0x1d0),auth,async(_0x31877a,_0x3844bf)=>{var _0x173dda=a0_0x1497c9;try{const {date:_0x598f85,from_warehouse:_0x1cdb8f,FromRoom_name:_0x13c6e8,to_warehouse:_0x5eadb4,ToRoom_name:_0xbb5075,prod_name:_0x3b0632,from_prod_qty:_0x270d79,from_prod_level:_0x1b4205,from_prod_isle:_0xc77440,from_prod_pallet:_0x8175d2,to_prod_qty:_0x51b4e0,to_prod_level:_0x2f03cb,to_prod_isle:_0x49a940,to_prod_pallet:_0x1e772c,primary_code:_0x5f0429,secondary_code:_0x58230f,product_code3:_0x14e5fd,note:_0x1ff5e4,MaxStocks_data2:_0x3119bb,invoice:_0x878a30,expiry_date:_0x51c2a7,PO_number:_0x23119e,ReqBy:_0x4e7914,dateofreq:_0x5716db,typeservicesData:_0x12b863,destination:_0x21a9ee,deliverydate:_0x1fcd0e,driver:_0x36d8a7,plate:_0x4a3645,van:_0x1a41b3,DRSI:_0x4d9f49,typevehicle:_0x34169f,TSU:_0x350ae6,TFU:_0x27d843}=_0x31877a[_0x173dda(0x282)];if(typeof _0x3b0632==_0x173dda(0x265))var _0x374bfe=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x272)]],_0xc4cba3=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x224)]],_0x37d7aa=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x22f)]],_0x4d8440=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x233)]],_0x1a456f=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x260)]],_0x435252=[_0x31877a['body'][_0x173dda(0x20f)]],_0x4aef7c=[_0x31877a[_0x173dda(0x282)]['secondary_code']],_0xcb4770=[_0x31877a[_0x173dda(0x282)]['product_code3']],_0x1d7248=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x21f)]],_0x1ad285=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x250)]],_0xb141f4=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x261)]],_0x2810a2=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x1d1)]],_0x2efda0=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x203)]],_0x116a8a=[_0x31877a[_0x173dda(0x282)]['product_date']],_0x17277f=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x1f9)]],_0x2e5857=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x24d)]],_0x208775=[_0x31877a['body'][_0x173dda(0x257)]],_0x1a9023=[_0x31877a[_0x173dda(0x282)]['RoomAssigned']],_0x4c9880=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x211)]],_0x24d540=[_0x31877a['body'][_0x173dda(0x1ea)]],_0xc79fdb=[_0x31877a[_0x173dda(0x282)][_0x173dda(0x1fe)]];else var _0x374bfe=[..._0x31877a['body']['prod_name']],_0xc4cba3=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x224)]],_0x37d7aa=[..._0x31877a[_0x173dda(0x282)]['from_prod_level2']],_0x4d8440=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x233)]],_0x1a456f=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x260)]],_0x435252=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x20f)]],_0x4aef7c=[..._0x31877a[_0x173dda(0x282)]['secondary_code']],_0xcb4770=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x225)]],_0x1d7248=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x21f)]],_0x1ad285=[..._0x31877a[_0x173dda(0x282)]['primary_unit']],_0xb141f4=[..._0x31877a['body'][_0x173dda(0x261)]],_0x2810a2=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x1d1)]],_0x2efda0=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x203)]],_0x116a8a=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x27d)]],_0x17277f=[..._0x31877a[_0x173dda(0x282)]['MaxStocks_data']],_0x2e5857=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x24d)]],_0x208775=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x257)]],_0x1a9023=[..._0x31877a[_0x173dda(0x282)]['RoomAssigned']],_0x4c9880=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x211)]],_0x24d540=[..._0x31877a[_0x173dda(0x282)][_0x173dda(0x1ea)]],_0xc79fdb=[..._0x31877a['body'][_0x173dda(0x1fe)]];const _0x31ff1c=_0x374bfe['map'](_0xcc101b=>{return _0xcc101b={'product_name':_0xcc101b};});_0xc4cba3[_0x173dda(0x25f)]((_0x51797b,_0x264342)=>{var _0x2776b8=_0x173dda;_0x31ff1c[_0x264342][_0x2776b8(0x1e8)]=_0x51797b;}),_0x37d7aa['forEach']((_0x576fce,_0x4610dc)=>{var _0x5a7e5c=_0x173dda,_0x47e852=_0x576fce[_0x5a7e5c(0x1dd)](/[A-Za-z]+/)[0x0],_0xe50886=parseInt(_0x576fce['match'](/\d+/)[0x0]);_0x31ff1c[_0x4610dc][_0x5a7e5c(0x1ce)]=_0xe50886,_0x31ff1c[_0x4610dc][_0x5a7e5c(0x1f3)]=_0x47e852;}),_0xc79fdb[_0x173dda(0x25f)]((_0x18c203,_0x3449db)=>{_0x31ff1c[_0x3449db]['id_transaction']=_0x18c203;}),_0x24d540['forEach']((_0x44a00d,_0x66eef1)=>{var _0x100341=_0x173dda;_0x31ff1c[_0x66eef1][_0x100341(0x1ea)]=_0x44a00d;}),_0x4d8440[_0x173dda(0x25f)]((_0x2136d9,_0x4486d1)=>{var _0xbec982=_0x173dda;_0x31ff1c[_0x4486d1][_0xbec982(0x295)]=_0x2136d9;}),_0x1a456f[_0x173dda(0x25f)]((_0x10cb15,_0x6ab414)=>{var _0x3d05b8=_0x173dda,_0x326d80=_0x10cb15[_0x3d05b8(0x1dd)](/[A-Za-z]+/)[0x0],_0x4c41c4=parseInt(_0x10cb15[_0x3d05b8(0x1dd)](/\d+/)[0x0]);_0x31ff1c[_0x6ab414][_0x3d05b8(0x294)]=_0x326d80,_0x31ff1c[_0x6ab414][_0x3d05b8(0x1d9)]=_0x4c41c4;}),_0x435252[_0x173dda(0x25f)]((_0x9ba362,_0xd3e62a)=>{_0x31ff1c[_0xd3e62a]['primary_code']=_0x9ba362;}),_0x4aef7c[_0x173dda(0x25f)]((_0x1e66f6,_0x477efb)=>{var _0x1dae26=_0x173dda;_0x31ff1c[_0x477efb][_0x1dae26(0x279)]=_0x1e66f6;}),_0xcb4770[_0x173dda(0x25f)]((_0xccbaa2,_0x3a4471)=>{var _0x233487=_0x173dda;_0x31ff1c[_0x3a4471][_0x233487(0x215)]=_0xccbaa2;}),_0x1d7248[_0x173dda(0x25f)]((_0xf679ff,_0xfc8e32)=>{var _0x58fedf=_0x173dda;_0x31ff1c[_0xfc8e32][_0x58fedf(0x26b)]=_0xf679ff;}),_0x1ad285['forEach']((_0x28289d,_0x3f8e91)=>{_0x31ff1c[_0x3f8e91]['unit']=_0x28289d;}),_0xb141f4['forEach']((_0x183a9b,_0x2f38f9)=>{var _0x201370=_0x173dda;_0x31ff1c[_0x2f38f9][_0x201370(0x261)]=_0x183a9b;}),_0x2810a2[_0x173dda(0x25f)]((_0x766668,_0x1eca16)=>{_0x31ff1c[_0x1eca16]['batch_code']=_0x766668;}),_0x2efda0[_0x173dda(0x25f)]((_0x1f9efd,_0x481be7)=>{_0x31ff1c[_0x481be7]['expiry_date']=_0x1f9efd;}),_0x116a8a[_0x173dda(0x25f)]((_0x4d3da6,_0x4d5ab8)=>{var _0x4d1115=_0x173dda;_0x31ff1c[_0x4d5ab8][_0x4d1115(0x23b)]=_0x4d3da6;}),_0x17277f['forEach']((_0x4749a7,_0x138640)=>{_0x31ff1c[_0x138640]['maxProducts']=_0x4749a7;}),_0x2e5857[_0x173dda(0x25f)]((_0x47b412,_0x7d8e1)=>{var _0xaab7a5=_0x173dda;_0x31ff1c[_0x7d8e1][_0xaab7a5(0x24d)]=_0x47b412;}),_0x208775['forEach']((_0x338df7,_0x14c10d)=>{_0x31ff1c[_0x14c10d]['prod_cat']=_0x338df7;}),_0x1a9023['forEach']((_0x3bc26e,_0x39a30a)=>{var _0x5d8180=_0x173dda;_0x31ff1c[_0x39a30a][_0x5d8180(0x222)]=_0x3bc26e;}),_0x4c9880['forEach']((_0x594c9c,_0x48d1bb)=>{var _0x3866d5=_0x173dda;_0x31ff1c[_0x48d1bb][_0x3866d5(0x239)]=_0x594c9c;});const _0x149045=_0x31ff1c[_0x173dda(0x1f8)](_0x2485f3=>_0x2485f3[_0x173dda(0x295)]!=='0'&&_0x2485f3[_0x173dda(0x295)]!==''||_0x2485f3[_0x173dda(0x1d3)]!=='0'&&_0x2485f3[_0x173dda(0x1d3)]!=='');var _0x3b10f8=0x0;_0x149045[_0x173dda(0x25f)](_0x550006=>{var _0x15eade=_0x173dda;parseInt(_0x550006[_0x15eade(0x1e8)])<parseInt(_0x550006['to_quantity'])&&_0x3b10f8++;});if(_0x3b10f8!=0x0)return _0x31877a[_0x173dda(0x235)](_0x173dda(0x1e3),_0x173dda(0x23e)),_0x3844bf['redirect'](_0x173dda(0x231));const _0x295fae=new transfers_logs();await _0x295fae[_0x173dda(0x1fd)]();for(let _0x598d13=0x0;_0x598d13<=_0x4c9880['length']-0x1;_0x598d13++){_0x31ff1c[_0x598d13][_0x173dda(0x214)]=_0x173dda(0x20e)+_0x295fae[_0x173dda(0x223)][_0x173dda(0x1cf)]()[_0x173dda(0x1e2)](0x8,'0');}const _0x23d580=new transfers_finished({'date':_0x598f85,'from_warehouse':_0x1cdb8f,'to_warehouse':_0x1cdb8f,'product':_0x149045,'note':_0x1ff5e4,'invoice':_0x173dda(0x20e)+_0x295fae[_0x173dda(0x223)][_0x173dda(0x1cf)]()[_0x173dda(0x1e2)](0x8,'0'),'type_of_process':_0x173dda(0x270),'type_of_transaction':_0x173dda(0x254),'PO_number':_0x23119e,'RequestedBy':_0x4e7914,'DateofRequest':_0x5716db,'typeservices':_0x12b863,'destination':_0x21a9ee,'deliverydate':_0x1fcd0e,'driver':_0x36d8a7,'plate':_0x4a3645,'van':_0x1a41b3,'DRSI':_0x4d9f49,'typevehicle':_0x34169f,'TSU':_0x350ae6,'TFU':_0x27d843}),_0x53e1be=await _0x23d580[_0x173dda(0x1fd)]();_0x31877a[_0x173dda(0x235)](_0x173dda(0x1f1),_0x173dda(0x1e4)),_0x3844bf[_0x173dda(0x287)](_0x173dda(0x288)+_0x53e1be[_0x173dda(0x230)]);}catch(_0x4733ba){console[_0x173dda(0x276)](_0x4733ba),_0x3844bf['status'](0xc8)[_0x173dda(0x208)]({'errorMessage':_0x4733ba['message']});}}),router['post'](a0_0x1497c9(0x291),auth,async(_0x25c824,_0xc5d1eb)=>{var _0x4eab08=a0_0x1497c9;try{const {date:_0x140dfb,from_warehouse:_0x4694d4,FromRoom_name:_0x5b9765,to_warehouse:_0x3dc470,ToRoom_name:_0x20b9ce,prod_name:_0x7a404e,from_prod_qty:_0x285dbf,from_prod_level:_0x32c298,from_prod_isle:_0x583f0c,from_prod_pallet:_0x766efa,to_prod_qty:_0x462149,to_prod_level:_0xfa7ef0,to_prod_isle:_0x3e1e22,to_prod_pallet:_0x5d4022,primary_code:_0x3d0eee,secondary_code:_0x1712f3,product_code3:_0x10011d,note:_0x23ec76,MaxStocks_data2:_0x239f0a,invoice:_0xf0e60d,expiry_date:_0x4105cc,PO_number_loc:_0x1c0f0,ReqBy_loc:_0x3fa597,dateofreq_loc:_0x262e00,typeservices_loc_Data:_0x322a60,destination_loc:_0x4902ea,deliverydate_loc:_0x1b77df,driver_loc:_0x61d8fe,plate_loc:_0x2fb23e,van_loc:_0x2ff98c,DRSI_loc:_0x1dc42d,typevehicle_loc:_0x404529,TSU_loc:_0x3fffff,TFU_loc:_0x11d8fa}=_0x25c824[_0x4eab08(0x282)];if(typeof _0x7a404e==_0x4eab08(0x265))var _0x1ad3d7=[_0x25c824[_0x4eab08(0x282)]['prod_name']],_0x4cf331=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x224)]],_0xce1c56=[_0x25c824[_0x4eab08(0x282)]['from_prod_level2']],_0x19c0aa=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x233)]],_0x10a5b8=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x260)]],_0x33b746=[_0x25c824['body']['primary_code']],_0x23a67c=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x279)]],_0xb41f1b=[_0x25c824[_0x4eab08(0x282)]['product_code3']],_0xeca776=[_0x25c824[_0x4eab08(0x282)]['MaxStocks_data2']],_0x3f664b=[_0x25c824['body']['primary_unit']],_0x403289=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x261)]],_0x1bef2a=[_0x25c824[_0x4eab08(0x282)]['batch_code']],_0x151e7d=[_0x25c824['body'][_0x4eab08(0x203)]],_0x570668=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x27d)]],_0x20e285=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x1f9)]],_0x4e8d0a=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x24d)]],_0x2579f5=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x257)]],_0xee89a4=[_0x25c824[_0x4eab08(0x282)]['RoomAssigned']],_0x4a266b=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x211)]],_0x275e70=[_0x25c824[_0x4eab08(0x282)]['from_invoice']],_0x647f52=[_0x25c824[_0x4eab08(0x282)][_0x4eab08(0x1fe)]];else var _0x1ad3d7=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x272)]],_0x4cf331=[..._0x25c824[_0x4eab08(0x282)]['from_prod_qty']],_0xce1c56=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x22f)]],_0x19c0aa=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x233)]],_0x10a5b8=[..._0x25c824['body'][_0x4eab08(0x260)]],_0x33b746=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x20f)]],_0x23a67c=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x279)]],_0xb41f1b=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x225)]],_0xeca776=[..._0x25c824['body']['MaxStocks_data2']],_0x3f664b=[..._0x25c824[_0x4eab08(0x282)]['primary_unit']],_0x403289=[..._0x25c824[_0x4eab08(0x282)]['secondary_unit']],_0x1bef2a=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x1d1)]],_0x151e7d=[..._0x25c824['body'][_0x4eab08(0x203)]],_0x570668=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x27d)]],_0x20e285=[..._0x25c824['body'][_0x4eab08(0x1f9)]],_0x4e8d0a=[..._0x25c824[_0x4eab08(0x282)]['maxPerUnit']],_0x2579f5=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x257)]],_0xee89a4=[..._0x25c824['body']['RoomAssigned']],_0x4a266b=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x211)]],_0x275e70=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x1ea)]],_0x647f52=[..._0x25c824[_0x4eab08(0x282)][_0x4eab08(0x1fe)]];const _0x8c7cfd=_0x1ad3d7['map'](_0x636241=>{return _0x636241={'product_name':_0x636241};});_0x4cf331[_0x4eab08(0x25f)]((_0x475fcd,_0x54a687)=>{_0x8c7cfd[_0x54a687]['from_quantity']=_0x475fcd;}),_0xce1c56[_0x4eab08(0x25f)]((_0x59fc48,_0x2ead3c)=>{var _0x127ad9=_0x4eab08,_0x45697f=_0x59fc48[_0x127ad9(0x1dd)](/[A-Za-z]+/)[0x0],_0x207feb=parseInt(_0x59fc48['match'](/\d+/)[0x0]);_0x8c7cfd[_0x2ead3c][_0x127ad9(0x1ce)]=_0x207feb,_0x8c7cfd[_0x2ead3c][_0x127ad9(0x1f3)]=_0x45697f;}),_0x647f52[_0x4eab08(0x25f)]((_0x2642ab,_0xd0b9f4)=>{var _0x41d224=_0x4eab08;_0x8c7cfd[_0xd0b9f4][_0x41d224(0x1fe)]=_0x2642ab;}),_0x275e70[_0x4eab08(0x25f)]((_0x470233,_0x4e7f45)=>{var _0x256763=_0x4eab08;_0x8c7cfd[_0x4e7f45][_0x256763(0x1ea)]=_0x470233;}),_0x19c0aa[_0x4eab08(0x25f)]((_0x4cace3,_0x43a8ac)=>{var _0x5b2626=_0x4eab08;_0x8c7cfd[_0x43a8ac][_0x5b2626(0x295)]=_0x4cace3;}),_0x10a5b8[_0x4eab08(0x25f)]((_0x25f244,_0x4bb3cc)=>{var _0x5ee87c=_0x4eab08,_0x5f111a=_0x25f244[_0x5ee87c(0x1dd)](/[A-Za-z]+/)[0x0],_0x5a96ea=parseInt(_0x25f244[_0x5ee87c(0x1dd)](/\d+/)[0x0]);_0x8c7cfd[_0x4bb3cc][_0x5ee87c(0x294)]=_0x5f111a,_0x8c7cfd[_0x4bb3cc][_0x5ee87c(0x1d9)]=_0x5a96ea;}),_0x33b746[_0x4eab08(0x25f)]((_0x589b36,_0x2888c)=>{var _0x92a4e7=_0x4eab08;_0x8c7cfd[_0x2888c][_0x92a4e7(0x20f)]=_0x589b36;}),_0x23a67c[_0x4eab08(0x25f)]((_0x1b02f6,_0x23f858)=>{_0x8c7cfd[_0x23f858]['secondary_code']=_0x1b02f6;}),_0xb41f1b[_0x4eab08(0x25f)]((_0x214fbd,_0x4579a5)=>{var _0x216f0a=_0x4eab08;_0x8c7cfd[_0x4579a5][_0x216f0a(0x215)]=_0x214fbd;}),_0xeca776[_0x4eab08(0x25f)]((_0x57782e,_0x2f90ff)=>{var _0x1ec6f3=_0x4eab08;_0x8c7cfd[_0x2f90ff][_0x1ec6f3(0x26b)]=_0x57782e;}),_0x3f664b['forEach']((_0x462867,_0x296557)=>{var _0x48d434=_0x4eab08;_0x8c7cfd[_0x296557][_0x48d434(0x28e)]=_0x462867;}),_0x403289['forEach']((_0x54fd13,_0xa201a9)=>{var _0x350554=_0x4eab08;_0x8c7cfd[_0xa201a9][_0x350554(0x261)]=_0x54fd13;}),_0x1bef2a[_0x4eab08(0x25f)]((_0x302af7,_0x214c1c)=>{var _0x1bb3e5=_0x4eab08;_0x8c7cfd[_0x214c1c][_0x1bb3e5(0x1d1)]=_0x302af7;}),_0x151e7d[_0x4eab08(0x25f)]((_0x4c3fe0,_0x48e12d)=>{var _0x4309d9=_0x4eab08;_0x8c7cfd[_0x48e12d][_0x4309d9(0x203)]=_0x4c3fe0;}),_0x570668['forEach']((_0x37012c,_0x57bbb5)=>{_0x8c7cfd[_0x57bbb5]['production_date']=_0x37012c;}),_0x20e285[_0x4eab08(0x25f)]((_0x7d1b65,_0x4764b2)=>{var _0x375abd=_0x4eab08;_0x8c7cfd[_0x4764b2][_0x375abd(0x26b)]=_0x7d1b65;}),_0x4e8d0a[_0x4eab08(0x25f)]((_0x32b729,_0x5672c9)=>{_0x8c7cfd[_0x5672c9]['maxPerUnit']=_0x32b729;}),_0x2579f5[_0x4eab08(0x25f)]((_0xdc35d5,_0x3158fc)=>{var _0x36aa0e=_0x4eab08;_0x8c7cfd[_0x3158fc][_0x36aa0e(0x257)]=_0xdc35d5;}),_0xee89a4[_0x4eab08(0x25f)]((_0x4e16df,_0x19734f)=>{_0x8c7cfd[_0x19734f]['from_room_name']=_0x4e16df;}),_0x4a266b[_0x4eab08(0x25f)]((_0x6f3f36,_0x402f64)=>{var _0xe18409=_0x4eab08;_0x8c7cfd[_0x402f64][_0xe18409(0x239)]=_0x6f3f36;});const _0x56e6ca=_0x8c7cfd[_0x4eab08(0x1f8)](_0x5a42a9=>_0x5a42a9[_0x4eab08(0x295)]!=='0'&&_0x5a42a9[_0x4eab08(0x295)]!==''||_0x5a42a9[_0x4eab08(0x1d3)]!=='0'&&_0x5a42a9['to_floorlevel']!=='');var _0x3e162e=0x0;_0x56e6ca[_0x4eab08(0x25f)](_0x4492e9=>{var _0x5735e1=_0x4eab08;parseInt(_0x4492e9[_0x5735e1(0x1e8)])<parseInt(_0x4492e9['to_quantity'])&&_0x3e162e++;});if(_0x3e162e!=0x0)return _0x25c824[_0x4eab08(0x235)]('errors',_0x4eab08(0x23e)),_0xc5d1eb[_0x4eab08(0x287)](_0x4eab08(0x231));const _0x9aaa4f=new transfers_logs();await _0x9aaa4f['save']();for(let _0x46bf9a=0x0;_0x46bf9a<=_0x4a266b['length']-0x1;_0x46bf9a++){_0x8c7cfd[_0x46bf9a][_0x4eab08(0x214)]=_0x4eab08(0x20e)+_0x9aaa4f[_0x4eab08(0x223)][_0x4eab08(0x1cf)]()[_0x4eab08(0x1e2)](0x8,'0');}const _0x5c3844=new transfers_finished({'date':_0x140dfb,'from_warehouse':_0x4694d4,'to_warehouse':_0x3dc470,'product':_0x56e6ca,'note':_0x23ec76,'invoice':'LOG-TRF-'+_0x9aaa4f[_0x4eab08(0x223)][_0x4eab08(0x1cf)]()[_0x4eab08(0x1e2)](0x8,'0'),'type_of_transaction':_0x4eab08(0x254),'type_of_process':'location2location','PO_number':_0x1c0f0,'RequestedBy':_0x3fa597,'DateofRequest':_0x262e00,'typeservices':_0x322a60,'destination':_0x4902ea,'deliverydate':_0x1b77df,'driver':_0x61d8fe,'plate':_0x2fb23e,'van':_0x2ff98c,'DRSI':_0x1dc42d,'typevehicle':_0x404529,'TSU':_0x3fffff,'TFU':_0x11d8fa}),_0x3f4902=await _0x5c3844[_0x4eab08(0x1fd)]();_0x25c824[_0x4eab08(0x235)](_0x4eab08(0x1f1),_0x4eab08(0x1e4)),_0xc5d1eb['redirect'](_0x4eab08(0x288)+_0x3f4902[_0x4eab08(0x230)]);}catch(_0x453399){console[_0x4eab08(0x276)](_0x453399),_0xc5d1eb[_0x4eab08(0x26c)](0xc8)['json']({'errorMessage':_0x453399[_0x4eab08(0x245)]});}}),router[a0_0x1497c9(0x1f6)](a0_0x1497c9(0x22b),auth,async(_0x555493,_0x3a85a2)=>{var _0x5d9adc=a0_0x1497c9;try{const {date:_0x44df19,from_warehouse:_0x1bbdbc,FromRoom_name:_0x39276c,to_warehouse:_0x29424f,ToRoom_name:_0x2667fd,prod_name:_0x50d89c,from_prod_qty:_0x4f2455,from_prod_level:_0x1cab2b,from_prod_isle:_0x44318b,from_prod_pallet:_0x48ecb9,to_prod_qty:_0x206ca8,to_prod_level:_0x4c8bc4,to_prod_isle:_0x206b71,to_prod_pallet:_0x40cb55,primary_code:_0x322691,secondary_code:_0x101f6b,product_code3:_0x3e9d55,note:_0x432ebd,MaxStocks_data2:_0x1a293e,invoice:_0x538e0e,expiry_date:_0x5edebb,PO_number:_0x110b71,ReqBy:_0x1dad91,dateofreq:_0x5e70f7,typeservicesData:_0x4dd7b1,destination:_0x564a06,deliverydate:_0x4887a1,driver:_0x3ae224,plate:_0x6c6d33,van:_0x52561b,DRSI:_0x44898b,typevehicle:_0x384324,TSU:_0x3c33b9,TFU:_0x573471}=_0x555493['body'];if(typeof _0x50d89c=='string')var _0x944ed=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x272)]],_0x506bc7=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x224)]],_0x423f09=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x22f)]],_0x35e9ab=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x233)]],_0x2e8627=[_0x555493[_0x5d9adc(0x282)]['to_prod_level']],_0x4f472d=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x20f)]],_0x315535=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x279)]],_0x2e8e3a=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x225)]],_0x1b4378=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x21f)]],_0x4810e7=[_0x555493['body'][_0x5d9adc(0x250)]],_0x703891=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x261)]],_0x1e1708=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x1d1)]],_0xc25a07=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x203)]],_0x2b2d6a=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x27d)]],_0x1b7f63=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x1f9)]],_0x3902b6=[_0x555493[_0x5d9adc(0x282)]['maxPerUnit']],_0x2eae1b=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x257)]],_0xb86a81=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x21d)]],_0x52a32d=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x211)]],_0x55aefa=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x1ea)]],_0x4003f5=[_0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x1fe)]];else var _0x944ed=[..._0x555493['body'][_0x5d9adc(0x272)]],_0x506bc7=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x224)]],_0x423f09=[..._0x555493['body'][_0x5d9adc(0x22f)]],_0x35e9ab=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x233)]],_0x2e8627=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x260)]],_0x4f472d=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x20f)]],_0x315535=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x279)]],_0x2e8e3a=[..._0x555493['body'][_0x5d9adc(0x225)]],_0x1b4378=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x21f)]],_0x4810e7=[..._0x555493['body'][_0x5d9adc(0x250)]],_0x703891=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x261)]],_0x1e1708=[..._0x555493['body'][_0x5d9adc(0x1d1)]],_0xc25a07=[..._0x555493[_0x5d9adc(0x282)]['expiry_date']],_0x2b2d6a=[..._0x555493['body'][_0x5d9adc(0x27d)]],_0x1b7f63=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x1f9)]],_0x3902b6=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x24d)]],_0x2eae1b=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x257)]],_0xb86a81=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x21d)]],_0x52a32d=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x211)]],_0x55aefa=[..._0x555493['body'][_0x5d9adc(0x1ea)]],_0x4003f5=[..._0x555493[_0x5d9adc(0x282)][_0x5d9adc(0x1fe)]];const _0x1af126=_0x944ed[_0x5d9adc(0x210)](_0x1d50c4=>{return _0x1d50c4={'product_name':_0x1d50c4};});_0x506bc7[_0x5d9adc(0x25f)]((_0x5b2877,_0x3d4f3a)=>{var _0x3bbc25=_0x5d9adc;_0x1af126[_0x3d4f3a][_0x3bbc25(0x1e8)]=_0x5b2877;}),_0x423f09['forEach']((_0x1f373e,_0x32120c)=>{var _0x4a71d0=_0x5d9adc,_0xbbe520=_0x1f373e[_0x4a71d0(0x1dd)](/[A-Za-z]+/)[0x0],_0x211884=parseInt(_0x1f373e['match'](/\d+/)[0x0]);_0x1af126[_0x32120c][_0x4a71d0(0x1ce)]=_0x211884,_0x1af126[_0x32120c][_0x4a71d0(0x1f3)]=_0xbbe520;}),_0x4003f5[_0x5d9adc(0x25f)]((_0x564bba,_0x441522)=>{var _0x2e2956=_0x5d9adc;_0x1af126[_0x441522][_0x2e2956(0x1fe)]=_0x564bba;}),_0x55aefa[_0x5d9adc(0x25f)]((_0x9aa50f,_0x53117a)=>{_0x1af126[_0x53117a]['from_invoice']=_0x9aa50f;}),_0x35e9ab[_0x5d9adc(0x25f)]((_0xe76143,_0x47278d)=>{var _0x81554a=_0x5d9adc;_0x1af126[_0x47278d][_0x81554a(0x295)]=_0xe76143;}),_0x2e8627['forEach']((_0x295ffe,_0x146702)=>{var _0x169a11=_0x5d9adc,_0x1f3b47=_0x295ffe['match'](/[A-Za-z]+/)[0x0],_0x5c21e0=parseInt(_0x295ffe[_0x169a11(0x1dd)](/\d+/)[0x0]);_0x1af126[_0x146702]['to_level']=_0x1f3b47,_0x1af126[_0x146702][_0x169a11(0x1d9)]=_0x5c21e0;}),_0x4f472d[_0x5d9adc(0x25f)]((_0x25cfb5,_0x53cd5a)=>{_0x1af126[_0x53cd5a]['primary_code']=_0x25cfb5;}),_0x315535['forEach']((_0x3d8415,_0x3474db)=>{_0x1af126[_0x3474db]['secondary_code']=_0x3d8415;}),_0x2e8e3a['forEach']((_0x30ce4b,_0x3e25c5)=>{var _0x255b03=_0x5d9adc;_0x1af126[_0x3e25c5][_0x255b03(0x215)]=_0x30ce4b;}),_0x1b4378[_0x5d9adc(0x25f)]((_0x4aa5f8,_0x28ccf8)=>{var _0x2bcb4b=_0x5d9adc;_0x1af126[_0x28ccf8][_0x2bcb4b(0x26b)]=_0x4aa5f8;}),_0x4810e7[_0x5d9adc(0x25f)]((_0xa03772,_0x511380)=>{_0x1af126[_0x511380]['unit']=_0xa03772;}),_0x703891['forEach']((_0x191de4,_0x35f980)=>{var _0xb7883=_0x5d9adc;_0x1af126[_0x35f980][_0xb7883(0x261)]=_0x191de4;}),_0x1e1708['forEach']((_0x48bb80,_0x500c1c)=>{var _0x2b93e6=_0x5d9adc;_0x1af126[_0x500c1c][_0x2b93e6(0x1d1)]=_0x48bb80;}),_0xc25a07[_0x5d9adc(0x25f)]((_0x3f1170,_0x25e533)=>{var _0x20e7b1=_0x5d9adc;_0x1af126[_0x25e533][_0x20e7b1(0x203)]=_0x3f1170;}),_0x2b2d6a[_0x5d9adc(0x25f)]((_0x3ead23,_0x342cc2)=>{_0x1af126[_0x342cc2]['production_date']=_0x3ead23;}),_0x1b7f63['forEach']((_0x40672f,_0x5e3297)=>{var _0x429c73=_0x5d9adc;_0x1af126[_0x5e3297][_0x429c73(0x26b)]=_0x40672f;}),_0x3902b6['forEach']((_0x299cc1,_0x1f8816)=>{var _0x19b2d8=_0x5d9adc;_0x1af126[_0x1f8816][_0x19b2d8(0x24d)]=_0x299cc1;}),_0x2eae1b[_0x5d9adc(0x25f)]((_0x5bcfba,_0x2faf56)=>{var _0x397441=_0x5d9adc;_0x1af126[_0x2faf56][_0x397441(0x257)]=_0x5bcfba;}),_0xb86a81[_0x5d9adc(0x25f)]((_0x5e69f4,_0x1c8cb4)=>{var _0x55b7e1=_0x5d9adc;_0x1af126[_0x1c8cb4][_0x55b7e1(0x222)]=_0x5e69f4;}),_0x52a32d[_0x5d9adc(0x25f)]((_0x34495d,_0x561693)=>{var _0x377866=_0x5d9adc;_0x1af126[_0x561693][_0x377866(0x239)]=_0x34495d;});const _0x53e59b=_0x1af126[_0x5d9adc(0x1f8)](_0x1f3cef=>_0x1f3cef[_0x5d9adc(0x295)]!=='0'&&_0x1f3cef[_0x5d9adc(0x295)]!==''||_0x1f3cef[_0x5d9adc(0x1d3)]!=='0'&&_0x1f3cef[_0x5d9adc(0x1d3)]!=='');var _0x56e527=0x0;_0x53e59b['forEach'](_0x449c87=>{parseInt(_0x449c87['from_quantity'])<parseInt(_0x449c87['to_quantity'])&&_0x56e527++;});if(_0x56e527!=0x0)return _0x555493[_0x5d9adc(0x235)](_0x5d9adc(0x1e3),_0x5d9adc(0x23e)),_0x3a85a2[_0x5d9adc(0x287)]('back');const _0x290929=new invoice_for_transfer();await _0x290929[_0x5d9adc(0x1fd)]();for(let _0x23bd13=0x0;_0x23bd13<=_0x52a32d['length']-0x1;_0x23bd13++){_0x1af126[_0x23bd13][_0x5d9adc(0x214)]=_0x5d9adc(0x248)+_0x290929[_0x5d9adc(0x223)][_0x5d9adc(0x1cf)]()[_0x5d9adc(0x1e2)](0x8,'0');}const _0x2112ca=new transfers_finished({'date':_0x44df19,'from_warehouse':_0x1bbdbc,'to_warehouse':_0x1bbdbc,'product':_0x53e59b,'note':_0x432ebd,'invoice':_0x5d9adc(0x248)+_0x290929['invoice_init']['toString']()[_0x5d9adc(0x1e2)](0x8,'0'),'type_of_process':_0x5d9adc(0x270),'type_of_transaction':'own','PO_number':_0x110b71,'RequestedBy':_0x1dad91,'DateofRequest':_0x5e70f7,'typeservices':_0x4dd7b1,'destination':_0x564a06,'deliverydate':_0x4887a1,'driver':_0x3ae224,'plate':_0x6c6d33,'van':_0x52561b,'DRSI':_0x44898b,'typevehicle':_0x384324,'TSU':_0x3c33b9,'TFU':_0x573471}),_0x2b870d=await _0x2112ca[_0x5d9adc(0x1fd)]();_0x555493[_0x5d9adc(0x235)](_0x5d9adc(0x1f1),_0x5d9adc(0x1e4)),_0x3a85a2[_0x5d9adc(0x287)](_0x5d9adc(0x288)+_0x2b870d[_0x5d9adc(0x230)]);}catch(_0xd12fa8){console[_0x5d9adc(0x276)](_0xd12fa8),_0x3a85a2['status'](0xc8)[_0x5d9adc(0x208)]({'errorMessage':_0xd12fa8['message']});}}),router[a0_0x1497c9(0x1f6)]('/view/add_transfer_loc',auth,async(_0x191f80,_0xd94321)=>{var _0x13d227=a0_0x1497c9;try{const {date:_0x457919,from_warehouse:_0x3db649,FromRoom_name:_0x514a97,to_warehouse:_0x1a5ef3,ToRoom_name:_0xf1df35,prod_name:_0x568e34,from_prod_qty:_0x209b1d,from_prod_level:_0x47080a,from_prod_isle:_0xe319b9,from_prod_pallet:_0x5a6623,to_prod_qty:_0x5915f9,to_prod_level:_0x3f1d5f,to_prod_isle:_0x356158,to_prod_pallet:_0x4c430b,primary_code:_0x4bba65,secondary_code:_0x1ab4fe,product_code3:_0x4be2ca,note:_0x36904e,MaxStocks_data2:_0x22a154,invoice:_0x3c2c83,expiry_date:_0x3c1e15,PO_number_loc:_0x1389af,ReqBy_loc:_0x18a816,dateofreq_loc:_0x355cb8,typeservices_loc_Data:_0x31a192,destination_loc:_0x4cbd83,deliverydate_loc:_0x469356,driver_loc:_0xca200c,plate_loc:_0x279abf,van_loc:_0x39c855,DRSI_loc:_0x284fd7,typevehicle_loc:_0x45ec42,TSU_loc:_0x29f5e1,TFU_loc:_0x4df1aa}=_0x191f80[_0x13d227(0x282)];if(typeof _0x568e34==_0x13d227(0x265))var _0x579219=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x272)]],_0x292003=[_0x191f80['body'][_0x13d227(0x224)]],_0xd04b00=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x22f)]],_0xb04495=[_0x191f80['body'][_0x13d227(0x233)]],_0x243ac8=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x260)]],_0x8a2919=[_0x191f80[_0x13d227(0x282)]['primary_code']],_0x437ecb=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x279)]],_0x32c395=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x225)]],_0x373439=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x21f)]],_0xe52baf=[_0x191f80['body'][_0x13d227(0x250)]],_0x383127=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x261)]],_0x4f736f=[_0x191f80['body'][_0x13d227(0x1d1)]],_0x549b19=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x203)]],_0x1d0f89=[_0x191f80[_0x13d227(0x282)]['product_date']],_0x5dc091=[_0x191f80[_0x13d227(0x282)]['MaxStocks_data']],_0x55adab=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x24d)]],_0x4189ee=[_0x191f80['body'][_0x13d227(0x257)]],_0x52635d=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x21d)]],_0x6cf1a3=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x211)]],_0xab8c68=[_0x191f80['body'][_0x13d227(0x1ea)]],_0x2d3d8d=[_0x191f80[_0x13d227(0x282)][_0x13d227(0x1fe)]];else var _0x579219=[..._0x191f80[_0x13d227(0x282)]['prod_name']],_0x292003=[..._0x191f80['body'][_0x13d227(0x224)]],_0xd04b00=[..._0x191f80[_0x13d227(0x282)][_0x13d227(0x22f)]],_0xb04495=[..._0x191f80['body']['New_Qty_Converted']],_0x243ac8=[..._0x191f80['body'][_0x13d227(0x260)]],_0x8a2919=[..._0x191f80[_0x13d227(0x282)]['primary_code']],_0x437ecb=[..._0x191f80[_0x13d227(0x282)][_0x13d227(0x279)]],_0x32c395=[..._0x191f80[_0x13d227(0x282)][_0x13d227(0x225)]],_0x373439=[..._0x191f80['body']['MaxStocks_data2']],_0xe52baf=[..._0x191f80['body'][_0x13d227(0x250)]],_0x383127=[..._0x191f80['body'][_0x13d227(0x261)]],_0x4f736f=[..._0x191f80[_0x13d227(0x282)]['batch_code']],_0x549b19=[..._0x191f80[_0x13d227(0x282)][_0x13d227(0x203)]],_0x1d0f89=[..._0x191f80[_0x13d227(0x282)][_0x13d227(0x27d)]],_0x5dc091=[..._0x191f80[_0x13d227(0x282)]['MaxStocks_data']],_0x55adab=[..._0x191f80[_0x13d227(0x282)][_0x13d227(0x24d)]],_0x4189ee=[..._0x191f80[_0x13d227(0x282)][_0x13d227(0x257)]],_0x52635d=[..._0x191f80[_0x13d227(0x282)]['RoomAssigned']],_0x6cf1a3=[..._0x191f80['body']['ToRoomAssigned']],_0xab8c68=[..._0x191f80[_0x13d227(0x282)]['from_invoice']],_0x2d3d8d=[..._0x191f80[_0x13d227(0x282)][_0x13d227(0x1fe)]];const _0x1eca6e=_0x579219[_0x13d227(0x210)](_0x17c7b0=>{return _0x17c7b0={'product_name':_0x17c7b0};});_0x292003[_0x13d227(0x25f)]((_0x4ae4d0,_0x454b05)=>{var _0x5ee693=_0x13d227;_0x1eca6e[_0x454b05][_0x5ee693(0x1e8)]=_0x4ae4d0;}),_0xd04b00[_0x13d227(0x25f)]((_0x478c2d,_0x1d6243)=>{var _0xff800b=_0x13d227,_0x3ca055=_0x478c2d[_0xff800b(0x1dd)](/[A-Za-z]+/)[0x0],_0x39603e=parseInt(_0x478c2d[_0xff800b(0x1dd)](/\d+/)[0x0]);_0x1eca6e[_0x1d6243][_0xff800b(0x1ce)]=_0x39603e,_0x1eca6e[_0x1d6243]['from_level']=_0x3ca055;}),_0x2d3d8d[_0x13d227(0x25f)]((_0xf0995d,_0x5cfc65)=>{var _0x48a8f9=_0x13d227;_0x1eca6e[_0x5cfc65][_0x48a8f9(0x1fe)]=_0xf0995d;}),_0xab8c68['forEach']((_0x11bfa2,_0x26f44c)=>{var _0x256dd6=_0x13d227;_0x1eca6e[_0x26f44c][_0x256dd6(0x1ea)]=_0x11bfa2;}),_0xb04495[_0x13d227(0x25f)]((_0xcff34d,_0xd32fb4)=>{var _0x141743=_0x13d227;_0x1eca6e[_0xd32fb4][_0x141743(0x295)]=_0xcff34d;}),_0x243ac8[_0x13d227(0x25f)]((_0x4fcea5,_0xbb938f)=>{var _0x4b1439=_0x13d227,_0xd47987=_0x4fcea5['match'](/[A-Za-z]+/)[0x0],_0x81e509=parseInt(_0x4fcea5['match'](/\d+/)[0x0]);_0x1eca6e[_0xbb938f][_0x4b1439(0x294)]=_0xd47987,_0x1eca6e[_0xbb938f]['to_bay']=_0x81e509;}),_0x8a2919[_0x13d227(0x25f)]((_0x5855ce,_0x39d63d)=>{var _0x5ce4f3=_0x13d227;_0x1eca6e[_0x39d63d][_0x5ce4f3(0x20f)]=_0x5855ce;}),_0x437ecb[_0x13d227(0x25f)]((_0x19673b,_0x4976e3)=>{var _0x2a662a=_0x13d227;_0x1eca6e[_0x4976e3][_0x2a662a(0x279)]=_0x19673b;}),_0x32c395[_0x13d227(0x25f)]((_0x249501,_0x4f60b8)=>{var _0x659f73=_0x13d227;_0x1eca6e[_0x4f60b8][_0x659f73(0x215)]=_0x249501;}),_0x373439[_0x13d227(0x25f)]((_0xe9c25,_0xc29108)=>{var _0x6d7de6=_0x13d227;_0x1eca6e[_0xc29108][_0x6d7de6(0x26b)]=_0xe9c25;}),_0xe52baf[_0x13d227(0x25f)]((_0x4c064c,_0x23be4a)=>{var _0x43808e=_0x13d227;_0x1eca6e[_0x23be4a][_0x43808e(0x28e)]=_0x4c064c;}),_0x383127[_0x13d227(0x25f)]((_0x40d671,_0x1f0d7c)=>{_0x1eca6e[_0x1f0d7c]['secondary_unit']=_0x40d671;}),_0x4f736f[_0x13d227(0x25f)]((_0x3dc54e,_0x47e1ac)=>{var _0x13d910=_0x13d227;_0x1eca6e[_0x47e1ac][_0x13d910(0x1d1)]=_0x3dc54e;}),_0x549b19[_0x13d227(0x25f)]((_0x2beeec,_0x47415c)=>{_0x1eca6e[_0x47415c]['expiry_date']=_0x2beeec;}),_0x1d0f89[_0x13d227(0x25f)]((_0x19a2e9,_0x2d4776)=>{var _0x4d4756=_0x13d227;_0x1eca6e[_0x2d4776][_0x4d4756(0x23b)]=_0x19a2e9;}),_0x5dc091['forEach']((_0x4849e5,_0x200b16)=>{_0x1eca6e[_0x200b16]['maxProducts']=_0x4849e5;}),_0x55adab[_0x13d227(0x25f)]((_0x139411,_0x42be7b)=>{var _0x285fc6=_0x13d227;_0x1eca6e[_0x42be7b][_0x285fc6(0x24d)]=_0x139411;}),_0x4189ee[_0x13d227(0x25f)]((_0x4db41,_0x25ab35)=>{var _0x3e24a5=_0x13d227;_0x1eca6e[_0x25ab35][_0x3e24a5(0x257)]=_0x4db41;}),_0x52635d[_0x13d227(0x25f)]((_0x2fc425,_0x4baef3)=>{_0x1eca6e[_0x4baef3]['from_room_name']=_0x2fc425;}),_0x6cf1a3[_0x13d227(0x25f)]((_0x4c8b61,_0x4d54b9)=>{var _0x26b0df=_0x13d227;_0x1eca6e[_0x4d54b9][_0x26b0df(0x239)]=_0x4c8b61;});const _0x3cf6ac=_0x1eca6e[_0x13d227(0x1f8)](_0x42c13f=>_0x42c13f['to_quantity']!=='0'&&_0x42c13f[_0x13d227(0x295)]!==''||_0x42c13f[_0x13d227(0x1d3)]!=='0'&&_0x42c13f[_0x13d227(0x1d3)]!=='');var _0x563b2d=0x0;_0x3cf6ac[_0x13d227(0x25f)](_0x3b05db=>{var _0x1953fa=_0x13d227;parseInt(_0x3b05db[_0x1953fa(0x1e8)])<parseInt(_0x3b05db['to_quantity'])&&_0x563b2d++;});if(_0x563b2d!=0x0)return _0x191f80[_0x13d227(0x235)](_0x13d227(0x1e3),_0x13d227(0x23e)),_0xd94321[_0x13d227(0x287)](_0x13d227(0x231));const _0x314f95=new invoice_for_transfer();await _0x314f95[_0x13d227(0x1fd)]();for(let _0x6483a5=0x0;_0x6483a5<=_0x6cf1a3[_0x13d227(0x1f7)]-0x1;_0x6483a5++){_0x1eca6e[_0x6483a5][_0x13d227(0x214)]=_0x13d227(0x248)+_0x314f95[_0x13d227(0x223)][_0x13d227(0x1cf)]()[_0x13d227(0x1e2)](0x8,'0');}const _0x443c7b=new transfers_finished({'date':_0x457919,'from_warehouse':_0x3db649,'to_warehouse':_0x1a5ef3,'product':_0x3cf6ac,'note':_0x36904e,'invoice':_0x13d227(0x248)+_0x314f95[_0x13d227(0x223)][_0x13d227(0x1cf)]()['padStart'](0x8,'0'),'type_of_transaction':_0x13d227(0x28d),'type_of_process':_0x13d227(0x297),'PO_number':_0x1389af,'RequestedBy':_0x18a816,'DateofRequest':_0x355cb8,'typeservices':_0x31a192,'destination':_0x4cbd83,'deliverydate':_0x469356,'driver':_0xca200c,'plate':_0x279abf,'van':_0x39c855,'DRSI':_0x284fd7,'typevehicle':_0x45ec42,'TSU':_0x29f5e1,'TFU':_0x4df1aa}),_0x559427=await _0x443c7b[_0x13d227(0x1fd)]();_0x191f80['flash']('success',_0x13d227(0x1e4)),_0xd94321['redirect']('/transfer_finished/preview/'+_0x559427[_0x13d227(0x230)]);}catch(_0x29b774){console[_0x13d227(0x276)](_0x29b774),_0xd94321['status'](0xc8)['json']({'errorMessage':_0x29b774['message']});}}),router[a0_0x1497c9(0x244)](a0_0x1497c9(0x24e),auth,async(_0xad0ead,_0x2da4b5)=>{var _0x22dd26=a0_0x1497c9;try{const {username:_0x42b1d0,email:_0x551982,role:_0x2e0048}=_0xad0ead[_0x22dd26(0x27e)],_0x5014f6=_0xad0ead['user'],_0x49b2d0=await profile[_0x22dd26(0x1ec)]({'email':_0x5014f6[_0x22dd26(0x1e1)]}),_0xcc64ca=await master_shop[_0x22dd26(0x274)](),_0x17c1cb=await transfers_finished[_0x22dd26(0x263)](_0xad0ead[_0x22dd26(0x21e)]['id']);let _0x3d95aa;if(_0x5014f6[_0x22dd26(0x200)]=='staff'){const _0x1fc7be=await staff[_0x22dd26(0x1ec)]({'email':_0x5014f6['email']});_0x3d95aa=await warehouse[_0x22dd26(0x274)]({'status':_0x22dd26(0x1dc),'name':_0x1fc7be[_0x22dd26(0x1eb)],'warehouse_category':'Finished\x20Goods'});}else _0x3d95aa=await warehouse[_0x22dd26(0x274)]({'status':_0x22dd26(0x1dc),'warehouse_category':_0x22dd26(0x252)});const _0x30b543=await warehouse[_0x22dd26(0x22d)]([{'$match':{'name':_0x17c1cb[_0x22dd26(0x1db)],'warehouse_category':_0x22dd26(0x252)}},{'$unwind':_0x22dd26(0x243)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x22dd26(0x212)},'product_stock':{'$first':_0x22dd26(0x238)},'bay':{'$first':_0x22dd26(0x21c)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x22dd26(0x22a)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x22dd26(0x249)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x22dd26(0x204)},'rack':{'$first':_0x22dd26(0x247)},'expiry_date':{'$first':_0x22dd26(0x1e9)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x22dd26(0x1d2)},'warehoue_name':{'$first':_0x22dd26(0x1f5)}}}]),_0x4112a8=await product[_0x22dd26(0x274)]({});if(_0xcc64ca[0x0][_0x22dd26(0x24c)]=='English\x20(US)'){var _0x47122b=users[_0x22dd26(0x28f)];console[_0x22dd26(0x276)](_0x47122b);}else{if(_0xcc64ca[0x0][_0x22dd26(0x24c)]==_0x22dd26(0x25d))var _0x47122b=users['Hindi'];else{if(_0xcc64ca[0x0][_0x22dd26(0x24c)]==_0x22dd26(0x255))var _0x47122b=users[_0x22dd26(0x255)];else{if(_0xcc64ca[0x0][_0x22dd26(0x24c)]=='Spanish')var _0x47122b=users[_0x22dd26(0x227)];else{if(_0xcc64ca[0x0]['language']==_0x22dd26(0x275))var _0x47122b=users[_0x22dd26(0x275)];else{if(_0xcc64ca[0x0][_0x22dd26(0x24c)]==_0x22dd26(0x25c))var _0x47122b=users[_0x22dd26(0x240)];else{if(_0xcc64ca[0x0][_0x22dd26(0x24c)]==_0x22dd26(0x202))var _0x47122b=users[_0x22dd26(0x202)];else{if(_0xcc64ca[0x0][_0x22dd26(0x24c)]==_0x22dd26(0x24b))var _0x47122b=users[_0x22dd26(0x273)];}}}}}}}_0x2da4b5[_0x22dd26(0x1da)](_0x22dd26(0x296),{'success':_0xad0ead[_0x22dd26(0x235)](_0x22dd26(0x1f1)),'errors':_0xad0ead[_0x22dd26(0x235)](_0x22dd26(0x1e3)),'role':_0x5014f6,'profile':_0x49b2d0,'master_shop':_0xcc64ca,'warehouse':_0x3d95aa,'transfer':_0x17c1cb,'stock':_0x30b543,'unit':_0x4112a8,'language':_0x47122b});}catch(_0x2f59fe){console[_0x22dd26(0x276)](_0x2f59fe);}}),router[a0_0x1497c9(0x1f6)](a0_0x1497c9(0x24e),auth,async(_0x2da556,_0x1b5889)=>{var _0x525a3b=a0_0x1497c9;try{const {invoice:_0x6c238,from_warehouse:_0x4f83de,FromRoom_name:_0x3d1d1e,to_warehouse:_0x4bccab,ToRoom_name:_0x2226fa}=_0x2da556['body'],_0x35f468=await transfers_finished[_0x525a3b(0x263)](_0x2da556[_0x525a3b(0x21e)]['id']),_0x5dda9f=_0x35f468[_0x525a3b(0x242)][_0x525a3b(0x210)](async _0x40f537=>{var _0x499edb=_0x525a3b;if(_0x40f537[_0x499edb(0x295)]>0x0){var _0x5c7074=await warehouse[_0x499edb(0x1ec)]({'name':_0x4f83de,'room':_0x40f537[_0x499edb(0x222)]});const _0x51fb13=_0x5c7074[_0x499edb(0x21b)][_0x499edb(0x210)](_0x4e5cc2=>{var _0x437625=_0x499edb;_0x4e5cc2[_0x437625(0x230)]==_0x40f537['id_transaction']&&(_0x4e5cc2['product_stock']=Math[_0x437625(0x1ff)](0x0,Math[_0x437625(0x283)](_0x4e5cc2[_0x437625(0x298)])-Math[_0x437625(0x283)](_0x40f537[_0x437625(0x295)])),console[_0x437625(0x276)](_0x4e5cc2[_0x437625(0x298)]));});}return _0x5c7074;});Promise[_0x525a3b(0x205)](_0x5dda9f)[_0x525a3b(0x266)](async _0x26d550=>{var _0x56d29e=_0x525a3b;try{for(const _0x308bcd of _0x26d550){await _0x308bcd[_0x56d29e(0x1fd)]();}const _0xcbaeab=_0x35f468['product']['map'](async _0x4d3a5d=>{var _0x5eaf0a=_0x56d29e,_0x4c21be=await warehouse[_0x5eaf0a(0x1ec)]({'name':_0x4bccab,'room':_0x4d3a5d[_0x5eaf0a(0x239)]});if(_0x4d3a5d[_0x5eaf0a(0x295)]>0x0){var _0x8d9752=0x0;const _0x33329e=_0x4c21be[_0x5eaf0a(0x21b)][_0x5eaf0a(0x210)](_0x5a2e15=>{var _0x3f0de6=_0x5eaf0a;_0x5a2e15['product_name']==_0x4d3a5d[_0x3f0de6(0x201)]&&_0x5a2e15[_0x3f0de6(0x209)]==_0x4d3a5d[_0x3f0de6(0x1d9)]&&_0x5a2e15[_0x3f0de6(0x203)]==_0x4d3a5d[_0x3f0de6(0x203)]&&_0x5a2e15[_0x3f0de6(0x23b)]==_0x4d3a5d['production_date']&&_0x5a2e15[_0x3f0de6(0x1d1)]==_0x4d3a5d['batch_code']&&_0x5a2e15[_0x3f0de6(0x1d7)]==_0x4d3a5d[_0x3f0de6(0x214)]&&(typeof _0x4d3a5d[_0x3f0de6(0x1fe)]==_0x3f0de6(0x21a)?(console[_0x3f0de6(0x276)](_0x3f0de6(0x27b),_0x5a2e15['product_stock']+_0x3f0de6(0x23c)+_0x5a2e15[_0x3f0de6(0x230)]+'\x20<=>\x20'+Math['abs'](_0x5a2e15[_0x3f0de6(0x298)])+Math[_0x3f0de6(0x283)](_0x4d3a5d[_0x3f0de6(0x295)])),_0x5a2e15[_0x3f0de6(0x298)]=Math[_0x3f0de6(0x283)](_0x5a2e15[_0x3f0de6(0x298)])+Math[_0x3f0de6(0x283)](_0x4d3a5d['to_quantity'])):_0x5a2e15[_0x3f0de6(0x298)]=Math['abs'](_0x5a2e15[_0x3f0de6(0x298)])+Math[_0x3f0de6(0x283)](_0x4d3a5d[_0x3f0de6(0x295)]),_0x8d9752++);});_0x8d9752=='0'&&(_0x4c21be[_0x5eaf0a(0x21b)]=_0x4c21be[_0x5eaf0a(0x21b)][_0x5eaf0a(0x1f4)]({'product_name':_0x4d3a5d['product_name'],'product_stock':_0x4d3a5d[_0x5eaf0a(0x295)],'bay':_0x4d3a5d[_0x5eaf0a(0x1d9)],'level':_0x4d3a5d[_0x5eaf0a(0x294)],'product_code':_0x4d3a5d[_0x5eaf0a(0x215)],'primary_code':_0x4d3a5d['primary_code'],'secondary_code':_0x4d3a5d[_0x5eaf0a(0x279)],'expiry_date':_0x4d3a5d[_0x5eaf0a(0x203)],'production_date':_0x4d3a5d[_0x5eaf0a(0x23b)],'maxProducts':_0x4d3a5d[_0x5eaf0a(0x26b)],'batch_code':_0x4d3a5d[_0x5eaf0a(0x1d1)],'secondary_unit':_0x4d3a5d['secondary_unit'],'unit':_0x4d3a5d[_0x5eaf0a(0x28e)],'maxProducts':_0x4d3a5d[_0x5eaf0a(0x26b)],'maxPerUnit':_0x4d3a5d[_0x5eaf0a(0x24d)],'invoice':_0x4d3a5d[_0x5eaf0a(0x214)]}));}return _0x4c21be;});Promise['all'](_0xcbaeab)[_0x56d29e(0x266)](async _0x20f50f=>{var _0x50c956=_0x56d29e;try{console[_0x50c956(0x276)](_0x35f468['type_of_process']);if(_0x35f468[_0x50c956(0x24a)]!=_0x50c956(0x297))for(const _0x3c6900 of _0x20f50f){await warehouse[_0x50c956(0x221)]({'_id':_0x3c6900[_0x50c956(0x230)]},{'$addToSet':{'product_details':{'$each':_0x3c6900[_0x50c956(0x21b)]}}});}_0x35f468[_0x50c956(0x23d)]=_0x50c956(0x281);const _0x35202f=await _0x35f468[_0x50c956(0x1fd)](),_0x173c60=await master_shop[_0x50c956(0x274)](),_0x40ac49=await email_settings[_0x50c956(0x1ec)](),_0x2b6552=await supervisor_settings[_0x50c956(0x274)]();var _0x13b8cf=_0x35f468['product'],_0x6aee53='',_0x4da14c;for(_0x4da14c in _0x13b8cf){var _0x56665e='FG';_0x35f468[_0x50c956(0x1fb)]=='DRY\x20GOODS'&&(_0x56665e='DG'),_0x6aee53+=_0x50c956(0x20b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13b8cf[_0x4da14c]['product_name']+_0x50c956(0x26a)+_0x50c956(0x286)+_0x13b8cf[_0x4da14c]['product_code']+_0x50c956(0x26a)+_0x50c956(0x286)+_0x13b8cf[_0x4da14c][_0x50c956(0x295)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13b8cf[_0x4da14c][_0x50c956(0x28e)]+_0x50c956(0x26a)+_0x50c956(0x286)+_0x13b8cf[_0x4da14c][_0x50c956(0x261)]+_0x50c956(0x26a)+_0x50c956(0x286)+_0x35f468[_0x50c956(0x1fb)]+_0x50c956(0x26a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13b8cf[_0x4da14c]['to_room_name']+_0x50c956(0x26a)+_0x50c956(0x286)+_0x56665e+_0x13b8cf[_0x4da14c]['to_bay']+_0x50c956(0x26a)+_0x50c956(0x1e0);}_0x2da556[_0x50c956(0x235)]('success',_0x50c956(0x1e6)),_0x1b5889[_0x50c956(0x287)](_0x50c956(0x20c)+_0x35202f[_0x50c956(0x230)]);}catch(_0x501000){console[_0x50c956(0x213)](_0x501000),_0x1b5889[_0x50c956(0x26c)](0x1f4)[_0x50c956(0x208)]({'error':_0x50c956(0x206)});}})['catch'](_0x320e3a=>{var _0x3aed25=_0x56d29e;console['error'](_0x320e3a),_0x1b5889[_0x3aed25(0x26c)](0x1f4)[_0x3aed25(0x208)]({'error':'An\x20error\x20occurred.'});});}catch(_0x22085e){console['error'](_0x22085e),_0x1b5889[_0x56d29e(0x26c)](0x1f4)[_0x56d29e(0x208)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x525a3b(0x1de)](_0x5b98d0=>{var _0x3abc59=_0x525a3b;console[_0x3abc59(0x213)](_0x5b98d0),_0x1b5889[_0x3abc59(0x26c)](0x1f4)['json']({'error':_0x3abc59(0x289)});});}catch(_0x3faf03){_0x1b5889['json']({'message':_0x3faf03['message']});}});function BayBinSelected(_0x12655e,_0x155c3b){var _0x6b5e00=a0_0x1497c9,_0x1f43b6=[];let _0x5e8fd9=[];var _0x10e9c1=[];if(_0x12655e=='DRY\x20GOODS'){switch(_0x155c3b){case'Rack\x201':_0x1f43b6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x6b5e00(0x207):_0x1f43b6=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x10e9c1=['DG'];}else{if(_0x12655e=='FROZEN\x20GOODS'){switch(_0x155c3b){case _0x6b5e00(0x268):_0x1f43b6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x6b5e00(0x207):_0x1f43b6=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x10e9c1=['FG'];}}return{'levels':_0x1f43b6,'identify':_0x10e9c1};}router['get'](a0_0x1497c9(0x1e5),auth,async(_0x25e83b,_0x2ee600)=>{var _0x1ffe2e=a0_0x1497c9;try{const {username:_0x21ad72,email:_0x325dc1,role:_0x4e02f1}=_0x25e83b[_0x1ffe2e(0x27e)],_0xd2fd64=_0x25e83b[_0x1ffe2e(0x27e)],_0x4b2727=await profile['findOne']({'email':_0xd2fd64['email']}),_0x5cd245=await master_shop['find'](),_0x18af17=await transfers_finished['findById'](_0x25e83b[_0x1ffe2e(0x21e)]['id']);let _0x589b81=new Date(_0x18af17[_0x1ffe2e(0x203)]),_0x376e10=('0'+_0x589b81[_0x1ffe2e(0x218)]())[_0x1ffe2e(0x220)](-0x2),_0x1933fc=('0'+(_0x589b81[_0x1ffe2e(0x241)]()+0x1))['slice'](-0x2),_0x3c7a0d=_0x589b81[_0x1ffe2e(0x25e)](),_0x5950d6=_0x3c7a0d+'-'+_0x1933fc+'-'+_0x376e10,_0x17aed1;if(_0xd2fd64[_0x1ffe2e(0x200)]==_0x1ffe2e(0x234)){const _0x132f04=await staff[_0x1ffe2e(0x1ec)]({'email':_0xd2fd64[_0x1ffe2e(0x1e1)]});_0x17aed1=await warehouse['find']({'status':'Enabled','name':_0x132f04['warehouse'],'warehouse_category':_0x1ffe2e(0x252)});}else _0x17aed1=await warehouse[_0x1ffe2e(0x274)]({'status':_0x1ffe2e(0x1dc),'warehouse_category':_0x1ffe2e(0x252)});const _0x16a0c2=await warehouse[_0x1ffe2e(0x22d)]([{'$match':{'name':_0x18af17[_0x1ffe2e(0x1db)],'room':_0x18af17['from_room']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1ffe2e(0x27c),'name':{'$first':_0x1ffe2e(0x212)},'product_stock':{'$first':_0x1ffe2e(0x238)},'bay':{'$first':_0x1ffe2e(0x21c)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1ffe2e(0x280)},'primary_code':{'$first':_0x1ffe2e(0x249)},'secondary_code':{'$first':_0x1ffe2e(0x27a)},'product_code':{'$first':_0x1ffe2e(0x26d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1ffe2e(0x247)}}}]);var _0x1eb394=[0x1,0x2,0x3,0x4],_0x435b03=['A','B','C','D','E','F','G','H','I','J'],_0x2c5ceb=[_0x1ffe2e(0x20d),_0x1ffe2e(0x26e)];const _0xfa7ed2=await product['find']({}),_0x5a21e4=BayBinSelected(_0x18af17[_0x1ffe2e(0x1fb)],_0x18af17[_0x1ffe2e(0x1e7)]);if(_0x5cd245[0x0][_0x1ffe2e(0x24c)]=='English\x20(US)'){var _0x2cbd50=users['English'];console[_0x1ffe2e(0x276)](_0x2cbd50);}else{if(_0x5cd245[0x0][_0x1ffe2e(0x24c)]==_0x1ffe2e(0x25d))var _0x2cbd50=users['Hindi'];else{if(_0x5cd245[0x0][_0x1ffe2e(0x24c)]==_0x1ffe2e(0x255))var _0x2cbd50=users['German'];else{if(_0x5cd245[0x0][_0x1ffe2e(0x24c)]==_0x1ffe2e(0x227))var _0x2cbd50=users[_0x1ffe2e(0x227)];else{if(_0x5cd245[0x0][_0x1ffe2e(0x24c)]==_0x1ffe2e(0x275))var _0x2cbd50=users[_0x1ffe2e(0x275)];else{if(_0x5cd245[0x0][_0x1ffe2e(0x24c)]==_0x1ffe2e(0x25c))var _0x2cbd50=users[_0x1ffe2e(0x240)];else{if(_0x5cd245[0x0]['language']==_0x1ffe2e(0x202))var _0x2cbd50=users[_0x1ffe2e(0x202)];else{if(_0x5cd245[0x0][_0x1ffe2e(0x24c)]==_0x1ffe2e(0x24b))var _0x2cbd50=users['Arabic'];}}}}}}}_0x2ee600[_0x1ffe2e(0x1da)]('edit_transfer_finished',{'success':_0x25e83b[_0x1ffe2e(0x235)](_0x1ffe2e(0x1f1)),'errors':_0x25e83b[_0x1ffe2e(0x235)](_0x1ffe2e(0x1e3)),'role':_0xd2fd64,'profile':_0x4b2727,'master_shop':_0x5cd245,'warehouse':_0x17aed1,'transfer':_0x18af17,'stock':_0x16a0c2,'unit':_0xfa7ed2,'language':_0x2cbd50,'levels':_0x1eb394,'Isle':_0x435b03,'rooms_data':_0x2c5ceb,'ed_fullDate':_0x5950d6,'dataSelected':_0x5a21e4});}catch(_0x57a250){console[_0x1ffe2e(0x276)](_0x57a250);}}),router[a0_0x1497c9(0x1f6)](a0_0x1497c9(0x1e5),auth,async(_0x41c7b5,_0x4fbd12)=>{var _0x2d5287=a0_0x1497c9;try{const _0x1dc3b0=_0x41c7b5[_0x2d5287(0x21e)]['id'];console[_0x2d5287(0x276)](_0x41c7b5['body']);const _0x369953=await transfers_finished[_0x2d5287(0x263)](_0x1dc3b0);console[_0x2d5287(0x276)](_0x2d5287(0x28b),_0x369953);const {date:_0x1a3daf,from_warehouse:_0x3c814c,FromRoom_name:_0x5b1690,to_warehouse:_0x514c89,ToRoom_name:_0x5bee0e,prod_name:_0x242614,from_prod_qty:_0x55eccd,from_prod_level:_0x475f5b,from_prod_isle:_0x12b8fb,from_prod_pallet:_0x81ba8d,to_prod_qty:_0x4e2f7f,to_prod_level:_0x167b83,to_prod_isle:_0xc6f3d5,to_prod_pallet:_0x30dae6,primary_code:_0xed00fd,secondary_code:_0x31a080,product_code3:_0x1b252f,note:_0x266282,invoice:_0x2e4dc8,expiry_date:_0x2b255a}=_0x41c7b5['body'];if(typeof _0x242614==_0x2d5287(0x265))var _0x5546f1=[_0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x272)]],_0x2a7803=[_0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x224)]],_0x275569=[_0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x226)]],_0x501325=[_0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x271)]],_0x21c566=[_0x41c7b5['body']['to_prod_level']],_0x154d22=[_0x41c7b5['body'][_0x2d5287(0x20f)]],_0x2e9202=[_0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x279)]],_0x2c2b7f=[_0x41c7b5[_0x2d5287(0x282)]['product_code3']],_0x3e7fdc=[_0x41c7b5[_0x2d5287(0x282)]['MaxStocks_data2']],_0x11ccf7=[_0x41c7b5['body']['unit']],_0x37fc77=[_0x41c7b5[_0x2d5287(0x282)]['secondary_unit']],_0x226b06=[_0x41c7b5['body'][_0x2d5287(0x1d1)]],_0x270189=[_0x41c7b5['body']['expiry_date']];else var _0x5546f1=[..._0x41c7b5['body']['prod_name']],_0x2a7803=[..._0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x224)]],_0x275569=[..._0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x226)]],_0x501325=[..._0x41c7b5[_0x2d5287(0x282)]['to_prod_qty']],_0x21c566=[..._0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x260)]],_0x154d22=[..._0x41c7b5['body']['primary_code']],_0x2e9202=[..._0x41c7b5[_0x2d5287(0x282)]['secondary_code']],_0x2c2b7f=[..._0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x225)]],_0x3e7fdc=[..._0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x21f)]],_0x11ccf7=[..._0x41c7b5['body'][_0x2d5287(0x28e)]],_0x37fc77=[..._0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x261)]],_0x226b06=[..._0x41c7b5[_0x2d5287(0x282)]['batch_code']],_0x270189=[..._0x41c7b5[_0x2d5287(0x282)][_0x2d5287(0x203)]];const _0x50f3ad=_0x5546f1[_0x2d5287(0x210)](_0x49a83e=>{return _0x49a83e={'product_name':_0x49a83e};});_0x2a7803[_0x2d5287(0x25f)]((_0x1e577d,_0x59084d)=>{var _0x1eb5c1=_0x2d5287;_0x50f3ad[_0x59084d][_0x1eb5c1(0x1e8)]=_0x1e577d;}),_0x275569[_0x2d5287(0x25f)]((_0x5b5450,_0x579480)=>{var _0x4529fd=_0x2d5287;_0x50f3ad[_0x579480][_0x4529fd(0x1ce)]=_0x5b5450;}),_0x501325[_0x2d5287(0x25f)]((_0x2add77,_0x209335)=>{var _0x18228c=_0x2d5287;_0x50f3ad[_0x209335][_0x18228c(0x295)]=_0x2add77;}),_0x21c566[_0x2d5287(0x25f)]((_0x4f70bc,_0x550f76)=>{_0x50f3ad[_0x550f76]['to_bay']=_0x4f70bc;}),_0x154d22[_0x2d5287(0x25f)]((_0x1e97dc,_0x3f46c7)=>{var _0x45a5ec=_0x2d5287;_0x50f3ad[_0x3f46c7][_0x45a5ec(0x20f)]=_0x1e97dc;}),_0x2e9202[_0x2d5287(0x25f)]((_0x315388,_0x4b1e86)=>{var _0x390016=_0x2d5287;_0x50f3ad[_0x4b1e86][_0x390016(0x279)]=_0x315388;}),_0x2c2b7f[_0x2d5287(0x25f)]((_0x16b17a,_0x519412)=>{var _0x39fd0a=_0x2d5287;_0x50f3ad[_0x519412][_0x39fd0a(0x215)]=_0x16b17a;}),_0x3e7fdc['forEach']((_0x17b22a,_0x429cd)=>{var _0x49b753=_0x2d5287;_0x50f3ad[_0x429cd][_0x49b753(0x26b)]=_0x17b22a;}),_0x11ccf7[_0x2d5287(0x25f)]((_0x771583,_0xdb2c0e)=>{var _0x4f52d5=_0x2d5287;_0x50f3ad[_0xdb2c0e][_0x4f52d5(0x28e)]=_0x771583;}),_0x37fc77[_0x2d5287(0x25f)]((_0x375007,_0x41124d)=>{_0x50f3ad[_0x41124d]['secondary_unit']=_0x375007;}),_0x226b06[_0x2d5287(0x25f)]((_0x46b47c,_0x2b7773)=>{var _0x20d940=_0x2d5287;_0x50f3ad[_0x2b7773][_0x20d940(0x1d1)]=_0x46b47c;}),_0x270189[_0x2d5287(0x25f)]((_0x9778af,_0xbb1849)=>{_0x50f3ad[_0xbb1849]['expiry_date']=_0x9778af;});const _0x3d5623=_0x50f3ad[_0x2d5287(0x1f8)](_0x36e432=>_0x36e432[_0x2d5287(0x295)]!=='0'&&_0x36e432[_0x2d5287(0x295)]!==''||_0x36e432[_0x2d5287(0x1d3)]!=='0'&&_0x36e432[_0x2d5287(0x1d3)]!=='');var _0x42c4e8=0x0;_0x3d5623[_0x2d5287(0x25f)](_0x6e8a52=>{var _0x517b18=_0x2d5287;parseInt(_0x6e8a52['from_quantity'])<parseInt(_0x6e8a52[_0x517b18(0x295)])&&_0x42c4e8++;});if(_0x42c4e8!=0x0)return _0x41c7b5[_0x2d5287(0x235)]('errors',_0x2d5287(0x23e)),_0x4fbd12[_0x2d5287(0x287)](_0x2d5287(0x231));const _0x502d51=await warehouse['findOne']({'name':_0x369953[_0x2d5287(0x1db)],'room':_0x369953['from_room']});_0x369953[_0x2d5287(0x242)][_0x2d5287(0x25f)](_0x48e2a1=>{var _0x3190e9=_0x2d5287;if(_0x48e2a1[_0x3190e9(0x295)]>0x0){const _0x48ec9c=_0x502d51['product_details']['map'](_0x159c7f=>{var _0x32e7c4=_0x3190e9;_0x159c7f[_0x32e7c4(0x201)]==_0x48e2a1[_0x32e7c4(0x201)]&&_0x159c7f[_0x32e7c4(0x209)]==_0x48e2a1['from_bay']&&(_0x159c7f[_0x32e7c4(0x298)]=parseInt(_0x159c7f[_0x32e7c4(0x298)])+parseInt(_0x48e2a1['to_quantity']));});}}),await _0x502d51[_0x2d5287(0x1fd)]();const _0x4dea6b=await warehouse['findOne']({'name':_0x369953[_0x2d5287(0x1fb)],'room':_0x369953['to_room']});_0x369953[_0x2d5287(0x242)]['forEach'](_0x15cb97=>{var _0x299f1b=_0x2d5287;if(_0x15cb97[_0x299f1b(0x295)]>0x0){const _0x1d2afc=_0x4dea6b[_0x299f1b(0x21b)][_0x299f1b(0x210)](_0x48ffb4=>{var _0x404a44=_0x299f1b;_0x48ffb4['product_name']==_0x15cb97['product_name']&&_0x48ffb4[_0x404a44(0x209)]==_0x15cb97[_0x404a44(0x1d9)]&&(_0x48ffb4[_0x404a44(0x298)]=parseInt(_0x48ffb4['product_stock'])-parseInt(_0x15cb97['to_quantity']));});}}),await _0x4dea6b[_0x2d5287(0x1fd)](),_0x369953[_0x2d5287(0x28a)]=_0x1a3daf,_0x369953['from_warehouse']=_0x3c814c,_0x369953['to_warehouse']=_0x514c89,_0x369953['product']=_0x3d5623,_0x369953['note']=_0x266282,_0x369953[_0x2d5287(0x1d7)]=_0x2e4dc8;const _0xd6d0ca=await _0x369953[_0x2d5287(0x1fd)](),_0x3a3f99=await warehouse[_0x2d5287(0x1ec)]({'name':_0x3c814c,'room':_0x5b1690});_0xd6d0ca[_0x2d5287(0x242)][_0x2d5287(0x25f)](_0x2e2835=>{var _0x456492=_0x2d5287;if(_0x2e2835[_0x456492(0x295)]>0x0){const _0x4218fd=_0x3a3f99['product_details']['map'](_0x54cda5=>{var _0x11b449=_0x456492;_0x54cda5[_0x11b449(0x201)]==_0x2e2835['product_name']&&_0x54cda5[_0x11b449(0x209)]==_0x2e2835[_0x11b449(0x1ce)]&&(_0x54cda5[_0x11b449(0x298)]=parseInt(_0x54cda5['product_stock'])-parseInt(_0x2e2835[_0x11b449(0x295)]));});}}),await _0x3a3f99['save']();const _0x47e599=await warehouse['findOne']({'name':_0x514c89,'room':_0x5bee0e});_0xd6d0ca[_0x2d5287(0x242)][_0x2d5287(0x25f)](_0x4d87b1=>{var _0x5eebc7=_0x2d5287;if(_0x4d87b1[_0x5eebc7(0x295)]>0x0){var _0x168f5a=0x0;const _0x506af1=_0x47e599['product_details'][_0x5eebc7(0x210)](_0x1a4d9e=>{var _0x1bf7f4=_0x5eebc7;_0x1a4d9e[_0x1bf7f4(0x201)]==_0x4d87b1[_0x1bf7f4(0x201)]&&_0x1a4d9e[_0x1bf7f4(0x209)]==_0x4d87b1[_0x1bf7f4(0x1d9)]&&(_0x1a4d9e['product_stock']=parseInt(_0x1a4d9e['product_stock'])+parseInt(_0x4d87b1[_0x1bf7f4(0x295)]),_0x168f5a++);});_0x168f5a=='0'&&(_0x47e599[_0x5eebc7(0x21b)]=_0x47e599[_0x5eebc7(0x21b)][_0x5eebc7(0x1f4)]({'product_name':_0x4d87b1['product_name'],'product_stock':_0x4d87b1[_0x5eebc7(0x295)],'bay':_0x4d87b1[_0x5eebc7(0x1d9)],'product_code':_0x4d87b1['product_code'],'primary_code':_0x4d87b1[_0x5eebc7(0x20f)],'secondary_code':_0x4d87b1[_0x5eebc7(0x279)],'maxProducts':_0x4d87b1['maxProducts']}));}}),await _0x47e599[_0x2d5287(0x1fd)](),_0x41c7b5['flash']('success','Transfer\x20Edit\x20Successfully'),_0x4fbd12[_0x2d5287(0x287)](_0x2d5287(0x25a));}catch(_0x4f0f88){console[_0x2d5287(0x276)](_0x4f0f88);}}),router[a0_0x1497c9(0x1f6)]('/barcode_scanner',async(_0x11b634,_0x58618c)=>{var _0x40dd6d=a0_0x1497c9;const {FromWareHouse:_0x34e2af,FromRoom:_0x2791a6,ToWarehouse:_0x7be702,ToRoom:_0x4935c5,primary_code:_0x3ee8c5,Roomslist:_0x54a11a}=_0x11b634[_0x40dd6d(0x282)],_0x559457=_0x54a11a['split'](','),_0x2f0475=[];async function _0x481e3d(_0x3552cf){var _0x204ed3=_0x40dd6d;const _0x40898b=await warehouse[_0x204ed3(0x22d)]([{'$match':{'name':_0x34e2af,'room':_0x3552cf}},{'$unwind':_0x204ed3(0x243)},{'$match':{'product_details.primary_code':_0x3ee8c5}},{'$group':{'_id':_0x204ed3(0x27c),'name':{'$first':_0x204ed3(0x212)},'instock':{'$first':_0x204ed3(0x238)},'primary_code':{'$first':_0x204ed3(0x249)},'secondary_code':{'$first':_0x204ed3(0x27a)},'product_code':{'$first':_0x204ed3(0x26d)},'bay':{'$first':'$product_details.bay'},'level':{'$first':_0x204ed3(0x1ed)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x204ed3(0x280)},'unit':{'$first':_0x204ed3(0x228)},'secondary_unit':{'$first':_0x204ed3(0x22e)},'storage':{'$first':_0x204ed3(0x204)},'rack':{'$first':_0x204ed3(0x247)},'expiry_date':{'$first':_0x204ed3(0x1e9)},'production_date':{'$first':_0x204ed3(0x1ee)},'batch_code':{'$first':_0x204ed3(0x1fc)},'maxPerUnit':{'$first':_0x204ed3(0x292)},'roomNamed':{'$first':_0x204ed3(0x1d2)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x204ed3(0x251)}}}]),_0x526574=await warehouse['aggregate']([{'$match':{'name':_0x34e2af,'room':_0x3552cf}},{'$unwind':_0x204ed3(0x243)},{'$match':{'product_details.secondary_code':_0x3ee8c5}},{'$group':{'_id':_0x204ed3(0x27c),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x204ed3(0x249)},'secondary_code':{'$first':_0x204ed3(0x27a)},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x204ed3(0x21c)},'level':{'$first':_0x204ed3(0x1ed)},'type':{'$first':_0x204ed3(0x22a)},'pallet':{'$first':_0x204ed3(0x280)},'unit':{'$first':_0x204ed3(0x228)},'secondary_unit':{'$first':_0x204ed3(0x22e)},'storage':{'$first':_0x204ed3(0x204)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x204ed3(0x1e9)},'production_date':{'$first':_0x204ed3(0x1ee)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x204ed3(0x292)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x204ed3(0x251)}}}]);if(_0x40898b[_0x204ed3(0x1f7)]>0x0)_0x2f0475[_0x204ed3(0x26f)](_0x40898b);else _0x526574[_0x204ed3(0x1f7)]>0x0&&_0x2f0475[_0x204ed3(0x26f)](_0x526574);}const _0x4e018c=_0x559457['map'](_0x5a8859=>_0x481e3d(_0x5a8859));await Promise[_0x40dd6d(0x205)](_0x4e018c),_0x58618c[_0x40dd6d(0x208)](_0x2f0475);}),router['post'](a0_0x1497c9(0x246),async(_0x5ef615,_0x1dde15)=>{var _0x14e84c=a0_0x1497c9;const {productCode:_0x365b94,bay:_0x1eb73b,warehouses:_0x50ddb0,room:_0x492fa7}=_0x5ef615[_0x14e84c(0x282)];console[_0x14e84c(0x276)](_0x5ef615[_0x14e84c(0x282)]);try{const _0x2ebcca=await warehouse[_0x14e84c(0x22d)]([{'$match':{'name':_0x50ddb0,'room':_0x492fa7}},{'$unwind':_0x14e84c(0x243)},{'$match':{'product_details.bay':parseInt(_0x1eb73b)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x14e84c(0x212)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x14e84c(0x21c)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x1dde15['status'](0xc8)[_0x14e84c(0x208)](_0x2ebcca);}catch(_0x290ad2){_0x1dde15[_0x14e84c(0x26c)](0x194)[_0x14e84c(0x208)]({'message':_0x290ad2[_0x14e84c(0x245)]});}}),module[a0_0x1497c9(0x232)]=router;