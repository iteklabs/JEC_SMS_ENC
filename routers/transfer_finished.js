var a0_0x343579=a0_0x1ce8;(function(_0x5ae915,_0x587f75){var _0x3bb53b=a0_0x1ce8,_0x22912c=_0x5ae915();while(!![]){try{var _0x3bb0e7=-parseInt(_0x3bb53b(0xaa))/0x1+-parseInt(_0x3bb53b(0x146))/0x2+parseInt(_0x3bb53b(0x100))/0x3*(parseInt(_0x3bb53b(0xfd))/0x4)+-parseInt(_0x3bb53b(0xf3))/0x5*(-parseInt(_0x3bb53b(0xdc))/0x6)+parseInt(_0x3bb53b(0xc8))/0x7*(-parseInt(_0x3bb53b(0x14b))/0x8)+-parseInt(_0x3bb53b(0xd1))/0x9+parseInt(_0x3bb53b(0x108))/0xa;if(_0x3bb0e7===_0x587f75)break;else _0x22912c['push'](_0x22912c['shift']());}catch(_0x4006fd){_0x22912c['push'](_0x22912c['shift']());}}}(a0_0x57a6,0x860ab));const express=require(a0_0x343579(0x133)),app=express(),router=express[a0_0x343579(0x147)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require('../models/all_models'),auth=require(a0_0x343579(0xec)),users=require(a0_0x343579(0xe6)),nodemailer=require(a0_0x343579(0xba));router[a0_0x343579(0x9b)](a0_0x343579(0x118),auth,async(_0x2f7891,_0x115afd)=>{var _0x26058d=a0_0x343579;try{const {username:_0x32d523,email:_0x36da0a,role:_0x16fa9c}=_0x2f7891[_0x26058d(0xc6)],_0x1627b0=_0x2f7891[_0x26058d(0xc6)],_0x583d85=await profile[_0x26058d(0xa4)]({'email':_0x1627b0['email']}),_0x3e0edd=await master_shop[_0x26058d(0xc3)]();let _0x40706b;if(_0x1627b0[_0x26058d(0xfc)]==_0x26058d(0x138)){const _0x243251=await staff[_0x26058d(0xa4)]({'email':_0x1627b0[_0x26058d(0x137)]});_0x40706b=await transfers_finished['find']({'from_warehouse':_0x243251[_0x26058d(0x134)]});}else _0x40706b=await transfers_finished[_0x26058d(0x95)]([{'$match':{'type_of_transaction':_0x26058d(0x84)}},{'$unwind':_0x26058d(0x12e)},{'$group':{'_id':_0x26058d(0x12d),'invoice':{'$first':_0x26058d(0xa5)},'date':{'$first':_0x26058d(0xe7)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x26058d(0xf0)},'from_room_name':{'$addToSet':_0x26058d(0x13b)},'to_room_name':{'$addToSet':_0x26058d(0xe2)},'finalize':{'$first':_0x26058d(0x107)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3e0edd[0x0][_0x26058d(0x126)]=='English\x20(US)')var _0x53f3fb=users[_0x26058d(0x109)];else{if(_0x3e0edd[0x0]['language']==_0x26058d(0x127))var _0x53f3fb=users['Hindi'];else{if(_0x3e0edd[0x0][_0x26058d(0x126)]==_0x26058d(0xb8))var _0x53f3fb=users['German'];else{if(_0x3e0edd[0x0][_0x26058d(0x126)]==_0x26058d(0xbd))var _0x53f3fb=users[_0x26058d(0xbd)];else{if(_0x3e0edd[0x0][_0x26058d(0x126)]=='French')var _0x53f3fb=users[_0x26058d(0x117)];else{if(_0x3e0edd[0x0][_0x26058d(0x126)]==_0x26058d(0xee))var _0x53f3fb=users['Portuguese'];else{if(_0x3e0edd[0x0][_0x26058d(0x126)]==_0x26058d(0xf1))var _0x53f3fb=users[_0x26058d(0xf1)];else{if(_0x3e0edd[0x0][_0x26058d(0x126)]=='Arabic\x20(ae)')var _0x53f3fb=users['Arabic'];}}}}}}}_0x115afd['render'](_0x26058d(0xdf),{'success':_0x2f7891['flash']('success'),'errors':_0x2f7891[_0x26058d(0xdd)](_0x26058d(0xa8)),'role':_0x1627b0,'profile':_0x583d85,'master_shop':_0x3e0edd,'transfer':_0x40706b,'language':_0x53f3fb});}catch(_0x4b2eec){console[_0x26058d(0x10a)](_0x4b2eec);}}),router[a0_0x343579(0x9b)](a0_0x343579(0x12b),auth,async(_0x8bdb64,_0x1eae9a)=>{var _0x117903=a0_0x343579;try{const {username:_0x52cd03,email:_0x5b1c1c,role:_0x1b061e}=_0x8bdb64['user'],_0x1df4b2=_0x8bdb64[_0x117903(0xc6)],_0x2124ae=await profile['findOne']({'email':_0x1df4b2[_0x117903(0x137)]}),_0x53bc61=await master_shop[_0x117903(0xc3)]();let _0x3e8222;if(_0x1df4b2[_0x117903(0xfc)]==_0x117903(0x138)){const _0x35a342=await staff[_0x117903(0xa4)]({'email':_0x1df4b2['email']});_0x3e8222=await transfers_finished['find']({'from_warehouse':_0x35a342[_0x117903(0x134)]});}else _0x3e8222=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':_0x117903(0xa0)}},{'$unwind':_0x117903(0x12e)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x117903(0xe7)},'from_warehouse':{'$first':_0x117903(0x145)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x117903(0x13b)},'to_room_name':{'$addToSet':_0x117903(0xe2)},'finalize':{'$first':_0x117903(0x107)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x53bc61[0x0][_0x117903(0x126)]==_0x117903(0x81))var _0x1bff4c=users[_0x117903(0x109)];else{if(_0x53bc61[0x0][_0x117903(0x126)]=='Hindi')var _0x1bff4c=users[_0x117903(0x127)];else{if(_0x53bc61[0x0][_0x117903(0x126)]==_0x117903(0xb8))var _0x1bff4c=users[_0x117903(0xb8)];else{if(_0x53bc61[0x0][_0x117903(0x126)]==_0x117903(0xbd))var _0x1bff4c=users[_0x117903(0xbd)];else{if(_0x53bc61[0x0][_0x117903(0x126)]==_0x117903(0x117))var _0x1bff4c=users[_0x117903(0x117)];else{if(_0x53bc61[0x0][_0x117903(0x126)]==_0x117903(0xee))var _0x1bff4c=users[_0x117903(0x143)];else{if(_0x53bc61[0x0][_0x117903(0x126)]=='Chinese')var _0x1bff4c=users[_0x117903(0xf1)];else{if(_0x53bc61[0x0][_0x117903(0x126)]==_0x117903(0xd8))var _0x1bff4c=users[_0x117903(0xfb)];}}}}}}}_0x1eae9a[_0x117903(0x94)]('transfer_finished_logs',{'success':_0x8bdb64[_0x117903(0xdd)](_0x117903(0x98)),'errors':_0x8bdb64[_0x117903(0xdd)]('errors'),'role':_0x1df4b2,'profile':_0x2124ae,'master_shop':_0x53bc61,'transfer':_0x3e8222,'language':_0x1bff4c});}catch(_0x607aec){console[_0x117903(0x10a)](_0x607aec);}});async function getRandom8DigitNumber(){var _0x9e15fd=a0_0x343579;const _0x350973=0x989680,_0x3ee0b7=0x5f5e0ff,_0x1df70c=Math[_0x9e15fd(0xc4)](Math[_0x9e15fd(0xf9)]()*(_0x3ee0b7-_0x350973+0x1))+_0x350973;var _0x5a66c5;const _0x4b7f37=await transfers_finished['findOne']({'invoice':_0x9e15fd(0x128)+_0x1df70c});return _0x4b7f37&&_0x4b7f37[_0x9e15fd(0xbe)]>0x0?_0x5a66c5=_0x9e15fd(0x128)+_0x1df70c:_0x5a66c5=_0x9e15fd(0x128)+_0x1df70c,_0x5a66c5;}function a0_0x57a6(){var _0x52d731=['$product_details.secondary_unit','status','expiry_date','location2location','invoice_init','\x20<>\x20','bay','error','$product_details.floorlevel','render','aggregate','all','transfer_data','success','filter','Product\x20Transfer\x20successfully','get','redirect','production_date','maxProducts','body','logs','$product_details.secondary_code','id_transaction','</tr>','findOne','$invoice','Rack\x201','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','errors','MaxStocks_data','967673sLPvQt','here2','back','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.batch_code','add_transfer_finished','/view/add_transfer_logs','params','from_invoice','$product_details.product_name','choos_transfer_logs','To_invoice','$product_details.type','updateOne','German','LOG-TRF-','nodemailer','TRF-','/view/add_transfer_loc','Spanish','length','$product_details.bay','$product_details.unit','from_room','finalize','find','floor','_id','user','$product_details.maxPerUnit','28ZROoTa','prod_name','to_quantity','choos_transfer','to_warehouse','to_room','from_prod_qty','Rack\x202','findById','4874004GaVtTq','Finished\x20Goods','product_code3','getMonth','split','MaxStocks_data2','$product_details','Arabic\x20(ae)','</td>','from_bay','New_Qty_Converted','2987766VHmgSJ','flash','from_quantity','transfer_finished','$product_details.invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product.to_room_name','forEach','/barcode_scanner','from_prod_level2','../public/language/languages.json','$date','undefined','product','getDate','$product_details.production_date','../middleware/auth','string','Portuguese\x20(BR)','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$to_warehouse','Chinese','$product_details.level','5QioLIT','unit','product_stock','to_bay','exports','match','random','$name','Arabic','role','932FtnPXn','edit_transfer_finished','concat','4863BKOgdc','message','<tr>','Ambient','then','abs','FROZEN\x20GOODS','$finalize','18024340EZZWdt','English','log','product_code','from_warehouse','prod_cat','invoice','/preview/:id','to_room_name','edit_transfer_finished_view','$product_details.storage','secondary_code','primary_code','Transfer\x20Finalize\x20Successfully','primary_unit','French','/view','to_level','/view/add_transfer','An\x20error\x20occurred.','post','type_of_process','json','$product_details._id','to_prod_level','$product_details.bin','An\x20error\x20occurred\x20while\x20saving\x20data.','/transfer_finished/view','map','catch','language','Hindi','TRFF-','$product_details.maxProducts','padStart','/view_logs','to_prod_qty','$_id','$product','slice','product_details','/transfer/view','product_name','express','warehouse','Enabled','DRY\x20GOODS','email','staff','push','$room','$product.from_room_name','ToRoomAssigned','Transfer\x20Edit\x20Successfully','from_prod_level','$product_details.expiry_date','toString','product_date','/CheckingWarehouse','Portuguese','from_level','$from_warehouse','432536YgkUeu','Router','save','secondary_unit','maxPerUnit','807112CpQefU','$product_details.product_code','/view/choose_logs','bin2bin','$product_details.product_stock','English\x20(US)','/transfer_finished/preview/','/view/addlog','own','to_floorlevel','RoomAssigned','$product_details.rack','batch_code','from_room_name','True'];a0_0x57a6=function(){return _0x52d731;};return a0_0x57a6();}router[a0_0x343579(0x9b)](a0_0x343579(0x11a),auth,async(_0x2f878b,_0x29a691)=>{var _0x39b6d1=a0_0x343579;try{const {username:_0x5f2a52,email:_0x142cfc,role:_0x4c9a04}=_0x2f878b['user'],_0x3d8dc5=_0x2f878b['user'],_0x57cf49=await profile[_0x39b6d1(0xa4)]({'email':_0x3d8dc5[_0x39b6d1(0x137)]}),_0x1bd5bf=await master_shop['find']();let _0x1dd5d5;if(_0x3d8dc5['role']=='staff'){const _0x6aa319=await staff['findOne']({'email':_0x3d8dc5[_0x39b6d1(0x137)]});_0x1dd5d5=await warehouse[_0x39b6d1(0x95)]([{'$match':{'status':_0x39b6d1(0x135),'name':_0x6aa319['warehouse']}},{'$group':{'_id':_0x39b6d1(0xfa),'name':{'$first':_0x39b6d1(0xfa)}}}]);}else _0x1dd5d5=await warehouse[_0x39b6d1(0x95)]([{'$match':{'status':_0x39b6d1(0x135)}},{'$group':{'_id':_0x39b6d1(0xfa),'name':{'$first':'$name'}}}]);const _0x15fda2=await transfers_finished['find']({}),_0x15a3b2=_0x15fda2[_0x39b6d1(0xbe)]+0x1,_0x521823='TRFF-'+_0x15a3b2[_0x39b6d1(0x140)]()[_0x39b6d1(0x12a)](0x5,'0');if(_0x1bd5bf[0x0][_0x39b6d1(0x126)]=='English\x20(US)')var _0x4be141=users[_0x39b6d1(0x109)];else{if(_0x1bd5bf[0x0][_0x39b6d1(0x126)]==_0x39b6d1(0x127))var _0x4be141=users[_0x39b6d1(0x127)];else{if(_0x1bd5bf[0x0][_0x39b6d1(0x126)]==_0x39b6d1(0xb8))var _0x4be141=users[_0x39b6d1(0xb8)];else{if(_0x1bd5bf[0x0][_0x39b6d1(0x126)]==_0x39b6d1(0xbd))var _0x4be141=users['Spanish'];else{if(_0x1bd5bf[0x0][_0x39b6d1(0x126)]==_0x39b6d1(0x117))var _0x4be141=users[_0x39b6d1(0x117)];else{if(_0x1bd5bf[0x0][_0x39b6d1(0x126)]==_0x39b6d1(0xee))var _0x4be141=users[_0x39b6d1(0x143)];else{if(_0x1bd5bf[0x0][_0x39b6d1(0x126)]==_0x39b6d1(0xf1))var _0x4be141=users[_0x39b6d1(0xf1)];else{if(_0x1bd5bf[0x0][_0x39b6d1(0x126)]==_0x39b6d1(0xd8))var _0x4be141=users['Arabic'];}}}}}}}const _0x1d43fd=getRandom8DigitNumber();_0x1d43fd[_0x39b6d1(0x104)](_0x22b404=>{var _0x46102d=_0x39b6d1;_0x29a691['render'](_0x46102d(0xaf),{'success':_0x2f878b[_0x46102d(0xdd)]('success'),'errors':_0x2f878b[_0x46102d(0xdd)]('errors'),'role':_0x3d8dc5,'profile':_0x57cf49,'master_shop':_0x1bd5bf,'warehouse':_0x1dd5d5,'language':_0x4be141,'invoice':_0x22b404});})[_0x39b6d1(0x125)](_0x5b1a43=>{var _0x462174=_0x39b6d1;_0x2f878b[_0x462174(0xdd)](_0x462174(0xa8),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x29a691[_0x462174(0x9c)](_0x462174(0x131));});}catch(_0x6599ab){console[_0x39b6d1(0x10a)](_0x6599ab);}}),router[a0_0x343579(0x9b)]('/view/choose',auth,async(_0x5463d9,_0x3dd946)=>{var _0x3977b7=a0_0x343579;try{const {username:_0x1632a0,email:_0x4c1e73,role:_0x565c60}=_0x5463d9['user'],_0x57bf77=_0x5463d9[_0x3977b7(0xc6)],_0x2dc5e0=await profile['findOne']({'email':_0x57bf77[_0x3977b7(0x137)]}),_0x5431ec=await master_shop[_0x3977b7(0xc3)]();let _0x1b1029;if(_0x57bf77[_0x3977b7(0xfc)]==_0x3977b7(0x138)){const _0x34a0fe=await staff['findOne']({'email':_0x57bf77['email']});_0x1b1029=await warehouse[_0x3977b7(0x95)]([{'$match':{'status':'Enabled','name':_0x34a0fe[_0x3977b7(0x134)]}},{'$group':{'_id':_0x3977b7(0xfa),'name':{'$first':_0x3977b7(0xfa)}}}]);}else _0x1b1029=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x3977b7(0xfa),'name':{'$first':_0x3977b7(0xfa)}}}]);const _0x53e306=await transfers_finished[_0x3977b7(0xc3)]({}),_0xe49282=_0x53e306[_0x3977b7(0xbe)]+0x1,_0x196b2c=_0x3977b7(0x128)+_0xe49282['toString']()[_0x3977b7(0x12a)](0x5,'0');if(_0x5431ec[0x0][_0x3977b7(0x126)]==_0x3977b7(0x81))var _0x46e829=users[_0x3977b7(0x109)];else{if(_0x5431ec[0x0][_0x3977b7(0x126)]==_0x3977b7(0x127))var _0x46e829=users['Hindi'];else{if(_0x5431ec[0x0]['language']=='German')var _0x46e829=users['German'];else{if(_0x5431ec[0x0][_0x3977b7(0x126)]==_0x3977b7(0xbd))var _0x46e829=users[_0x3977b7(0xbd)];else{if(_0x5431ec[0x0][_0x3977b7(0x126)]==_0x3977b7(0x117))var _0x46e829=users[_0x3977b7(0x117)];else{if(_0x5431ec[0x0][_0x3977b7(0x126)]==_0x3977b7(0xee))var _0x46e829=users[_0x3977b7(0x143)];else{if(_0x5431ec[0x0][_0x3977b7(0x126)]==_0x3977b7(0xf1))var _0x46e829=users[_0x3977b7(0xf1)];else{if(_0x5431ec[0x0]['language']==_0x3977b7(0xd8))var _0x46e829=users[_0x3977b7(0xfb)];}}}}}}}const _0x3025c7=getRandom8DigitNumber();_0x3025c7[_0x3977b7(0x104)](_0x3865b0=>{var _0x50108=_0x3977b7;_0x3dd946['render'](_0x50108(0xcb),{'success':_0x5463d9[_0x50108(0xdd)](_0x50108(0x98)),'errors':_0x5463d9['flash'](_0x50108(0xa8)),'role':_0x57bf77,'profile':_0x2dc5e0,'master_shop':_0x5431ec,'warehouse':_0x1b1029,'language':_0x46e829,'invoice':_0x3865b0});})['catch'](_0x33c7d0=>{var _0x4ffa5e=_0x3977b7;_0x5463d9['flash']('errors',_0x4ffa5e(0xe1)),_0x3dd946[_0x4ffa5e(0x9c)]('/transfer/view');});}catch(_0x4feadc){console[_0x3977b7(0x10a)](_0x4feadc);}}),router[a0_0x343579(0x9b)](a0_0x343579(0x14d),auth,async(_0x16c8e1,_0x128a25)=>{var _0x51871f=a0_0x343579;try{const {username:_0x4f36e,email:_0x5db235,role:_0x1a5767}=_0x16c8e1[_0x51871f(0xc6)],_0x79c67e=_0x16c8e1[_0x51871f(0xc6)],_0x403b1f=await profile['findOne']({'email':_0x79c67e[_0x51871f(0x137)]}),_0x346b8b=await master_shop[_0x51871f(0xc3)]();let _0x10949c;if(_0x79c67e[_0x51871f(0xfc)]==_0x51871f(0x138)){const _0x3d3273=await staff[_0x51871f(0xa4)]({'email':_0x79c67e[_0x51871f(0x137)]});_0x10949c=await warehouse[_0x51871f(0x95)]([{'$match':{'status':_0x51871f(0x135),'name':_0x3d3273[_0x51871f(0x134)]}},{'$group':{'_id':_0x51871f(0xfa),'name':{'$first':_0x51871f(0xfa)}}}]);}else _0x10949c=await warehouse[_0x51871f(0x95)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x51871f(0xfa),'name':{'$first':_0x51871f(0xfa)}}}]);const _0x4267a8=await transfers_finished[_0x51871f(0xc3)]({}),_0xfde37d=_0x4267a8[_0x51871f(0xbe)]+0x1,_0x765702=_0x51871f(0x128)+_0xfde37d[_0x51871f(0x140)]()['padStart'](0x5,'0');if(_0x346b8b[0x0]['language']=='English\x20(US)')var _0xeea1dc=users['English'];else{if(_0x346b8b[0x0][_0x51871f(0x126)]==_0x51871f(0x127))var _0xeea1dc=users[_0x51871f(0x127)];else{if(_0x346b8b[0x0][_0x51871f(0x126)]==_0x51871f(0xb8))var _0xeea1dc=users[_0x51871f(0xb8)];else{if(_0x346b8b[0x0][_0x51871f(0x126)]=='Spanish')var _0xeea1dc=users[_0x51871f(0xbd)];else{if(_0x346b8b[0x0][_0x51871f(0x126)]=='French')var _0xeea1dc=users[_0x51871f(0x117)];else{if(_0x346b8b[0x0]['language']==_0x51871f(0xee))var _0xeea1dc=users[_0x51871f(0x143)];else{if(_0x346b8b[0x0][_0x51871f(0x126)]==_0x51871f(0xf1))var _0xeea1dc=users[_0x51871f(0xf1)];else{if(_0x346b8b[0x0][_0x51871f(0x126)]==_0x51871f(0xd8))var _0xeea1dc=users[_0x51871f(0xfb)];}}}}}}}const _0x544d8d=getRandom8DigitNumber();_0x544d8d['then'](_0x2891c1=>{var _0x136a7e=_0x51871f;_0x128a25[_0x136a7e(0x94)](_0x136a7e(0xb4),{'success':_0x16c8e1['flash'](_0x136a7e(0x98)),'errors':_0x16c8e1[_0x136a7e(0xdd)]('errors'),'role':_0x79c67e,'profile':_0x403b1f,'master_shop':_0x346b8b,'warehouse':_0x10949c,'language':_0xeea1dc,'invoice':_0x2891c1});})[_0x51871f(0x125)](_0x470139=>{var _0x3feaea=_0x51871f;_0x16c8e1[_0x3feaea(0xdd)]('errors',_0x3feaea(0xe1)),_0x128a25[_0x3feaea(0x9c)](_0x3feaea(0x131));});}catch(_0x1f24a6){console[_0x51871f(0x10a)](_0x1f24a6);}}),router['post'](a0_0x343579(0xb0),auth,async(_0x15bb60,_0x3c5306)=>{var _0x30d612=a0_0x343579;try{const {date:_0x2704d0,from_warehouse:_0x5c7f06,FromRoom_name:_0x2e4f51,to_warehouse:_0x39ad3e,ToRoom_name:_0x5e842d,prod_name:_0x38d32b,from_prod_qty:_0x4e30a9,from_prod_level:_0x221235,from_prod_isle:_0x39feeb,from_prod_pallet:_0x2033ac,to_prod_qty:_0x5c7423,to_prod_level:_0x141083,to_prod_isle:_0x51a671,to_prod_pallet:_0x39b690,primary_code:_0x107070,secondary_code:_0x3e165f,product_code3:_0x1ed623,note:_0x115690,MaxStocks_data2:_0x162bc7,invoice:_0x1f3699,expiry_date:_0x191f30,PO_number:_0xa0eaf8,ReqBy:_0x30da6a,dateofreq:_0x8cbf66,typeservicesData:_0x4d5d3f,destination:_0x80288,deliverydate:_0x808017,driver:_0x278f71,plate:_0x36389a,van:_0x395784,DRSI:_0x5d5415,typevehicle:_0x84beef,TSU:_0x108af4,TFU:_0x45b603}=_0x15bb60[_0x30d612(0x9f)];if(typeof _0x38d32b==_0x30d612(0xed))var _0x35c5b6=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0xc9)]],_0x421075=[_0x15bb60[_0x30d612(0x9f)]['from_prod_qty']],_0x4dde78=[_0x15bb60['body'][_0x30d612(0xe5)]],_0x35a02f=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0xdb)]],_0x310d2b=[_0x15bb60[_0x30d612(0x9f)]['to_prod_level']],_0x554ef1=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0x114)]],_0x2fe214=[_0x15bb60['body'][_0x30d612(0x113)]],_0x140d24=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0xd3)]],_0x14753b=[_0x15bb60['body'][_0x30d612(0xd6)]],_0x27481a=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0x116)]],_0x2cc4aa=[_0x15bb60['body'][_0x30d612(0x149)]],_0x4307fb=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0x88)]],_0x23fcef=[_0x15bb60[_0x30d612(0x9f)]['expiry_date']],_0x1e6b2a=[_0x15bb60['body'][_0x30d612(0x141)]],_0x3b2b21=[_0x15bb60['body']['MaxStocks_data']],_0x1364f5=[_0x15bb60['body'][_0x30d612(0x14a)]],_0x234dd3=[_0x15bb60[_0x30d612(0x9f)]['prod_cat']],_0x1ddb37=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0x86)]],_0x40889e=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0x13c)]],_0x44ef70=[_0x15bb60['body'][_0x30d612(0xb2)]],_0x31a11c=[_0x15bb60[_0x30d612(0x9f)][_0x30d612(0xa2)]];else var _0x35c5b6=[..._0x15bb60['body']['prod_name']],_0x421075=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0xce)]],_0x4dde78=[..._0x15bb60['body']['from_prod_level2']],_0x35a02f=[..._0x15bb60['body'][_0x30d612(0xdb)]],_0x310d2b=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0x120)]],_0x554ef1=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0x114)]],_0x2fe214=[..._0x15bb60['body']['secondary_code']],_0x140d24=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0xd3)]],_0x14753b=[..._0x15bb60['body'][_0x30d612(0xd6)]],_0x27481a=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0x116)]],_0x2cc4aa=[..._0x15bb60['body'][_0x30d612(0x149)]],_0x4307fb=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0x88)]],_0x23fcef=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0x8d)]],_0x1e6b2a=[..._0x15bb60[_0x30d612(0x9f)]['product_date']],_0x3b2b21=[..._0x15bb60['body'][_0x30d612(0xa9)]],_0x1364f5=[..._0x15bb60[_0x30d612(0x9f)]['maxPerUnit']],_0x234dd3=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0x10d)]],_0x1ddb37=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0x86)]],_0x40889e=[..._0x15bb60['body'][_0x30d612(0x13c)]],_0x44ef70=[..._0x15bb60[_0x30d612(0x9f)][_0x30d612(0xb2)]],_0x31a11c=[..._0x15bb60[_0x30d612(0x9f)]['id_transaction']];const _0x2a9037=_0x35c5b6[_0x30d612(0x124)](_0x207317=>{return _0x207317={'product_name':_0x207317};});_0x421075[_0x30d612(0xe3)]((_0x200f20,_0x1452fc)=>{var _0xf4a398=_0x30d612;_0x2a9037[_0x1452fc][_0xf4a398(0xde)]=_0x200f20;}),_0x4dde78[_0x30d612(0xe3)]((_0x14f038,_0x72c2ad)=>{var _0x3f8eb7=_0x30d612,_0x200f0e=_0x14f038['match'](/[A-Za-z]+/)[0x0],_0x594e89=parseInt(_0x14f038[_0x3f8eb7(0xf8)](/\d+/)[0x0]);_0x2a9037[_0x72c2ad]['from_bay']=_0x594e89,_0x2a9037[_0x72c2ad][_0x3f8eb7(0x144)]=_0x200f0e;}),_0x31a11c[_0x30d612(0xe3)]((_0xe23349,_0x1ce51a)=>{var _0x359e09=_0x30d612;_0x2a9037[_0x1ce51a][_0x359e09(0xa2)]=_0xe23349;}),_0x44ef70[_0x30d612(0xe3)]((_0x59d202,_0x5edefd)=>{var _0x14c2e3=_0x30d612;_0x2a9037[_0x5edefd][_0x14c2e3(0xb2)]=_0x59d202;}),_0x35a02f[_0x30d612(0xe3)]((_0x1660b4,_0x15d585)=>{var _0x556c9c=_0x30d612;_0x2a9037[_0x15d585][_0x556c9c(0xca)]=_0x1660b4;}),_0x310d2b['forEach']((_0x322994,_0xe5ec02)=>{var _0x513542=_0x30d612,_0x346d82=_0x322994[_0x513542(0xf8)](/[A-Za-z]+/)[0x0],_0x1ea470=parseInt(_0x322994[_0x513542(0xf8)](/\d+/)[0x0]);_0x2a9037[_0xe5ec02]['to_level']=_0x346d82,_0x2a9037[_0xe5ec02][_0x513542(0xf6)]=_0x1ea470;}),_0x554ef1[_0x30d612(0xe3)]((_0x1af50e,_0x1faaf6)=>{var _0x33e997=_0x30d612;_0x2a9037[_0x1faaf6][_0x33e997(0x114)]=_0x1af50e;}),_0x2fe214['forEach']((_0x1c4503,_0x31c810)=>{_0x2a9037[_0x31c810]['secondary_code']=_0x1c4503;}),_0x140d24[_0x30d612(0xe3)]((_0x21ff0a,_0x18efda)=>{var _0x546747=_0x30d612;_0x2a9037[_0x18efda][_0x546747(0x10b)]=_0x21ff0a;}),_0x14753b[_0x30d612(0xe3)]((_0x3c8538,_0x1b1f63)=>{_0x2a9037[_0x1b1f63]['maxProducts']=_0x3c8538;}),_0x27481a[_0x30d612(0xe3)]((_0x25d385,_0x886b4e)=>{var _0x46b54e=_0x30d612;_0x2a9037[_0x886b4e][_0x46b54e(0xf4)]=_0x25d385;}),_0x2cc4aa[_0x30d612(0xe3)]((_0x3d15ce,_0x1a823d)=>{var _0x36376f=_0x30d612;_0x2a9037[_0x1a823d][_0x36376f(0x149)]=_0x3d15ce;}),_0x4307fb['forEach']((_0x3a027b,_0x5b04cd)=>{var _0x58f015=_0x30d612;_0x2a9037[_0x5b04cd][_0x58f015(0x88)]=_0x3a027b;}),_0x23fcef[_0x30d612(0xe3)]((_0x30889d,_0xce8518)=>{var _0x4dd964=_0x30d612;_0x2a9037[_0xce8518][_0x4dd964(0x8d)]=_0x30889d;}),_0x1e6b2a['forEach']((_0xb18f9,_0x3c66c1)=>{var _0x5725f9=_0x30d612;_0x2a9037[_0x3c66c1][_0x5725f9(0x9d)]=_0xb18f9;}),_0x3b2b21[_0x30d612(0xe3)]((_0x23cb31,_0x3ce3f2)=>{_0x2a9037[_0x3ce3f2]['maxProducts']=_0x23cb31;}),_0x1364f5[_0x30d612(0xe3)]((_0x373c91,_0x4c6d67)=>{_0x2a9037[_0x4c6d67]['maxPerUnit']=_0x373c91;}),_0x234dd3['forEach']((_0x7aba52,_0x51f5c9)=>{var _0x5c027f=_0x30d612;_0x2a9037[_0x51f5c9][_0x5c027f(0x10d)]=_0x7aba52;}),_0x1ddb37['forEach']((_0x46fda1,_0x421571)=>{_0x2a9037[_0x421571]['from_room_name']=_0x46fda1;}),_0x40889e[_0x30d612(0xe3)]((_0x2606d6,_0x181a9e)=>{var _0x5398c0=_0x30d612;_0x2a9037[_0x181a9e][_0x5398c0(0x110)]=_0x2606d6;});const _0x4ae154=_0x2a9037['filter'](_0x3abbad=>_0x3abbad[_0x30d612(0xca)]!=='0'&&_0x3abbad['to_quantity']!==''||_0x3abbad[_0x30d612(0x85)]!=='0'&&_0x3abbad[_0x30d612(0x85)]!=='');var _0x8035c2=0x0;_0x4ae154[_0x30d612(0xe3)](_0x5ca18e=>{var _0x1dcc4a=_0x30d612;parseInt(_0x5ca18e['from_quantity'])<parseInt(_0x5ca18e[_0x1dcc4a(0xca)])&&_0x8035c2++;});if(_0x8035c2!=0x0)return _0x15bb60['flash']('errors',_0x30d612(0xad)),_0x3c5306[_0x30d612(0x9c)]('back');const _0x41b68b=new transfers_logs();await _0x41b68b[_0x30d612(0x148)]();for(let _0x2db43f=0x0;_0x2db43f<=_0x40889e[_0x30d612(0xbe)]-0x1;_0x2db43f++){_0x2a9037[_0x2db43f][_0x30d612(0xb5)]=_0x30d612(0xb9)+_0x41b68b[_0x30d612(0x8f)][_0x30d612(0x140)]()[_0x30d612(0x12a)](0x8,'0');}const _0x5310b6=new transfers_finished({'date':_0x2704d0,'from_warehouse':_0x5c7f06,'to_warehouse':_0x5c7f06,'product':_0x4ae154,'note':_0x115690,'invoice':_0x30d612(0xb9)+_0x41b68b[_0x30d612(0x8f)][_0x30d612(0x140)]()['padStart'](0x8,'0'),'type_of_process':_0x30d612(0x14e),'type_of_transaction':'logs','PO_number':_0xa0eaf8,'RequestedBy':_0x30da6a,'DateofRequest':_0x8cbf66,'typeservices':_0x4d5d3f,'destination':_0x80288,'deliverydate':_0x808017,'driver':_0x278f71,'plate':_0x36389a,'van':_0x395784,'DRSI':_0x5d5415,'typevehicle':_0x84beef,'TSU':_0x108af4,'TFU':_0x45b603}),_0x23d61b=await _0x5310b6['save']();_0x15bb60[_0x30d612(0xdd)](_0x30d612(0x98),_0x30d612(0x9a)),_0x3c5306['redirect']('/transfer_finished/preview/'+_0x23d61b[_0x30d612(0xc5)]);}catch(_0x49485c){console[_0x30d612(0x10a)](_0x49485c),_0x3c5306[_0x30d612(0x8c)](0xc8)['json']({'errorMessage':_0x49485c[_0x30d612(0x101)]});}}),router[a0_0x343579(0x11c)](a0_0x343579(0x83),auth,async(_0x359e5f,_0x20283a)=>{var _0x54e97=a0_0x343579;try{const {date:_0x304650,from_warehouse:_0xa497ab,FromRoom_name:_0x335ba3,to_warehouse:_0x38241c,ToRoom_name:_0x4523c9,prod_name:_0x111279,from_prod_qty:_0x41d424,from_prod_level:_0x592b9a,from_prod_isle:_0x49addc,from_prod_pallet:_0x4798ee,to_prod_qty:_0xb0d4b6,to_prod_level:_0x5527f6,to_prod_isle:_0xa4496,to_prod_pallet:_0x5bd44c,primary_code:_0x237bd0,secondary_code:_0x1ed43f,product_code3:_0x46a313,note:_0x564d9a,MaxStocks_data2:_0x580d44,invoice:_0x517387,expiry_date:_0xc03712,PO_number_loc:_0x3e8e0a,ReqBy_loc:_0x269f4f,dateofreq_loc:_0x59aef5,typeservices_loc_Data:_0x301b4d,destination_loc:_0x2e7ccc,deliverydate_loc:_0x177601,driver_loc:_0x346865,plate_loc:_0x5322b1,van_loc:_0x105180,DRSI_loc:_0x445d67,typevehicle_loc:_0x585df5,TSU_loc:_0xbba840,TFU_loc:_0x301043}=_0x359e5f[_0x54e97(0x9f)];if(typeof _0x111279=='string')var _0x5c4d8f=[_0x359e5f['body'][_0x54e97(0xc9)]],_0x209968=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0xce)]],_0x18049c=[_0x359e5f[_0x54e97(0x9f)]['from_prod_level2']],_0x19ba46=[_0x359e5f['body'][_0x54e97(0xdb)]],_0x414165=[_0x359e5f[_0x54e97(0x9f)]['to_prod_level']],_0xb6e193=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0x114)]],_0x7534e0=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0x113)]],_0x1b248f=[_0x359e5f[_0x54e97(0x9f)]['product_code3']],_0x48504b=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0xd6)]],_0x41b8ec=[_0x359e5f[_0x54e97(0x9f)]['primary_unit']],_0x3bb6d3=[_0x359e5f[_0x54e97(0x9f)]['secondary_unit']],_0x7cddb3=[_0x359e5f[_0x54e97(0x9f)]['batch_code']],_0x25f593=[_0x359e5f['body']['expiry_date']],_0x12a66e=[_0x359e5f['body']['product_date']],_0x3c97a0=[_0x359e5f[_0x54e97(0x9f)]['MaxStocks_data']],_0x59fe7c=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0x14a)]],_0x59e5f9=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0x10d)]],_0x3433f1=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0x86)]],_0x13dcaf=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0x13c)]],_0x3379ec=[_0x359e5f[_0x54e97(0x9f)][_0x54e97(0xb2)]],_0x36e125=[_0x359e5f['body']['id_transaction']];else var _0x5c4d8f=[..._0x359e5f[_0x54e97(0x9f)][_0x54e97(0xc9)]],_0x209968=[..._0x359e5f['body'][_0x54e97(0xce)]],_0x18049c=[..._0x359e5f[_0x54e97(0x9f)]['from_prod_level2']],_0x19ba46=[..._0x359e5f['body'][_0x54e97(0xdb)]],_0x414165=[..._0x359e5f[_0x54e97(0x9f)]['to_prod_level']],_0xb6e193=[..._0x359e5f['body'][_0x54e97(0x114)]],_0x7534e0=[..._0x359e5f['body']['secondary_code']],_0x1b248f=[..._0x359e5f[_0x54e97(0x9f)][_0x54e97(0xd3)]],_0x48504b=[..._0x359e5f[_0x54e97(0x9f)]['MaxStocks_data2']],_0x41b8ec=[..._0x359e5f['body'][_0x54e97(0x116)]],_0x3bb6d3=[..._0x359e5f[_0x54e97(0x9f)][_0x54e97(0x149)]],_0x7cddb3=[..._0x359e5f[_0x54e97(0x9f)]['batch_code']],_0x25f593=[..._0x359e5f[_0x54e97(0x9f)][_0x54e97(0x8d)]],_0x12a66e=[..._0x359e5f['body'][_0x54e97(0x141)]],_0x3c97a0=[..._0x359e5f[_0x54e97(0x9f)]['MaxStocks_data']],_0x59fe7c=[..._0x359e5f[_0x54e97(0x9f)][_0x54e97(0x14a)]],_0x59e5f9=[..._0x359e5f['body']['prod_cat']],_0x3433f1=[..._0x359e5f[_0x54e97(0x9f)][_0x54e97(0x86)]],_0x13dcaf=[..._0x359e5f['body'][_0x54e97(0x13c)]],_0x3379ec=[..._0x359e5f['body'][_0x54e97(0xb2)]],_0x36e125=[..._0x359e5f[_0x54e97(0x9f)]['id_transaction']];const _0x28ab72=_0x5c4d8f[_0x54e97(0x124)](_0x5898b7=>{return _0x5898b7={'product_name':_0x5898b7};});_0x209968[_0x54e97(0xe3)]((_0x5ae3cc,_0x42abc6)=>{var _0x155eb8=_0x54e97;_0x28ab72[_0x42abc6][_0x155eb8(0xde)]=_0x5ae3cc;}),_0x18049c['forEach']((_0x36df44,_0x26d04e)=>{var _0x31fd6c=_0x54e97,_0x394b2c=_0x36df44[_0x31fd6c(0xf8)](/[A-Za-z]+/)[0x0],_0x29a578=parseInt(_0x36df44['match'](/\d+/)[0x0]);_0x28ab72[_0x26d04e][_0x31fd6c(0xda)]=_0x29a578,_0x28ab72[_0x26d04e]['from_level']=_0x394b2c;}),_0x36e125[_0x54e97(0xe3)]((_0x282143,_0x14d488)=>{var _0x511052=_0x54e97;_0x28ab72[_0x14d488][_0x511052(0xa2)]=_0x282143;}),_0x3379ec[_0x54e97(0xe3)]((_0x4a87e1,_0xc9c6df)=>{var _0x41f5d5=_0x54e97;_0x28ab72[_0xc9c6df][_0x41f5d5(0xb2)]=_0x4a87e1;}),_0x19ba46[_0x54e97(0xe3)]((_0x3d739a,_0x2633c3)=>{var _0x3c9062=_0x54e97;_0x28ab72[_0x2633c3][_0x3c9062(0xca)]=_0x3d739a;}),_0x414165['forEach']((_0x1b2c1a,_0x4a2f44)=>{var _0x3d83d3=_0x54e97,_0x3a593b=_0x1b2c1a[_0x3d83d3(0xf8)](/[A-Za-z]+/)[0x0],_0x5bb303=parseInt(_0x1b2c1a['match'](/\d+/)[0x0]);_0x28ab72[_0x4a2f44][_0x3d83d3(0x119)]=_0x3a593b,_0x28ab72[_0x4a2f44][_0x3d83d3(0xf6)]=_0x5bb303;}),_0xb6e193['forEach']((_0x2f1621,_0xbe3f0d)=>{var _0x1daa69=_0x54e97;_0x28ab72[_0xbe3f0d][_0x1daa69(0x114)]=_0x2f1621;}),_0x7534e0[_0x54e97(0xe3)]((_0x33277e,_0x57f943)=>{var _0x1258c7=_0x54e97;_0x28ab72[_0x57f943][_0x1258c7(0x113)]=_0x33277e;}),_0x1b248f['forEach']((_0x44dd72,_0x4fc4fc)=>{var _0x446a8f=_0x54e97;_0x28ab72[_0x4fc4fc][_0x446a8f(0x10b)]=_0x44dd72;}),_0x48504b[_0x54e97(0xe3)]((_0x4a8609,_0x1e20bc)=>{_0x28ab72[_0x1e20bc]['maxProducts']=_0x4a8609;}),_0x41b8ec[_0x54e97(0xe3)]((_0x2af953,_0x1bf696)=>{var _0x357932=_0x54e97;_0x28ab72[_0x1bf696][_0x357932(0xf4)]=_0x2af953;}),_0x3bb6d3[_0x54e97(0xe3)]((_0xae6bc5,_0x5f085)=>{var _0x5b82e9=_0x54e97;_0x28ab72[_0x5f085][_0x5b82e9(0x149)]=_0xae6bc5;}),_0x7cddb3[_0x54e97(0xe3)]((_0x130bd2,_0x14141c)=>{var _0xca0baa=_0x54e97;_0x28ab72[_0x14141c][_0xca0baa(0x88)]=_0x130bd2;}),_0x25f593[_0x54e97(0xe3)]((_0x4731f4,_0x55a75c)=>{_0x28ab72[_0x55a75c]['expiry_date']=_0x4731f4;}),_0x12a66e['forEach']((_0x43a82b,_0x4f8e1a)=>{_0x28ab72[_0x4f8e1a]['production_date']=_0x43a82b;}),_0x3c97a0['forEach']((_0x584dc5,_0x4bf152)=>{var _0x252fdd=_0x54e97;_0x28ab72[_0x4bf152][_0x252fdd(0x9e)]=_0x584dc5;}),_0x59fe7c[_0x54e97(0xe3)]((_0x49098e,_0xd9f18a)=>{var _0x7ab9d5=_0x54e97;_0x28ab72[_0xd9f18a][_0x7ab9d5(0x14a)]=_0x49098e;}),_0x59e5f9[_0x54e97(0xe3)]((_0x54fb55,_0x4afbf7)=>{var _0x371731=_0x54e97;_0x28ab72[_0x4afbf7][_0x371731(0x10d)]=_0x54fb55;}),_0x3433f1[_0x54e97(0xe3)]((_0x4741f7,_0x37280c)=>{var _0x4bc825=_0x54e97;_0x28ab72[_0x37280c][_0x4bc825(0x89)]=_0x4741f7;}),_0x13dcaf['forEach']((_0x2e451a,_0xc1845c)=>{var _0xb75666=_0x54e97;_0x28ab72[_0xc1845c][_0xb75666(0x110)]=_0x2e451a;});const _0x2f4f4c=_0x28ab72[_0x54e97(0x99)](_0xc27b4b=>_0xc27b4b[_0x54e97(0xca)]!=='0'&&_0xc27b4b[_0x54e97(0xca)]!==''||_0xc27b4b[_0x54e97(0x85)]!=='0'&&_0xc27b4b[_0x54e97(0x85)]!=='');var _0x23d037=0x0;_0x2f4f4c[_0x54e97(0xe3)](_0x46794d=>{var _0x5c8fe2=_0x54e97;parseInt(_0x46794d[_0x5c8fe2(0xde)])<parseInt(_0x46794d[_0x5c8fe2(0xca)])&&_0x23d037++;});if(_0x23d037!=0x0)return _0x359e5f['flash'](_0x54e97(0xa8),_0x54e97(0xad)),_0x20283a[_0x54e97(0x9c)](_0x54e97(0xac));const _0x18d967=new transfers_logs();await _0x18d967[_0x54e97(0x148)]();for(let _0x4dc223=0x0;_0x4dc223<=_0x13dcaf[_0x54e97(0xbe)]-0x1;_0x4dc223++){_0x28ab72[_0x4dc223][_0x54e97(0xb5)]='LOG-TRF-'+_0x18d967['invoice_init'][_0x54e97(0x140)]()[_0x54e97(0x12a)](0x8,'0');}const _0x405a6f=new transfers_finished({'date':_0x304650,'from_warehouse':_0xa497ab,'to_warehouse':_0x38241c,'product':_0x2f4f4c,'note':_0x564d9a,'invoice':'LOG-TRF-'+_0x18d967[_0x54e97(0x8f)][_0x54e97(0x140)]()['padStart'](0x8,'0'),'type_of_transaction':_0x54e97(0xa0),'type_of_process':_0x54e97(0x8e),'PO_number':_0x3e8e0a,'RequestedBy':_0x269f4f,'DateofRequest':_0x59aef5,'typeservices':_0x301b4d,'destination':_0x2e7ccc,'deliverydate':_0x177601,'driver':_0x346865,'plate':_0x5322b1,'van':_0x105180,'DRSI':_0x445d67,'typevehicle':_0x585df5,'TSU':_0xbba840,'TFU':_0x301043}),_0x3dcfee=await _0x405a6f[_0x54e97(0x148)]();_0x359e5f[_0x54e97(0xdd)]('success',_0x54e97(0x9a)),_0x20283a[_0x54e97(0x9c)]('/transfer_finished/preview/'+_0x3dcfee[_0x54e97(0xc5)]);}catch(_0x5b6eaf){console[_0x54e97(0x10a)](_0x5b6eaf),_0x20283a[_0x54e97(0x8c)](0xc8)[_0x54e97(0x11e)]({'errorMessage':_0x5b6eaf['message']});}}),router[a0_0x343579(0x11c)](a0_0x343579(0x11a),auth,async(_0x2dd969,_0x526d1e)=>{var _0x6cf160=a0_0x343579;try{const {date:_0x466df3,from_warehouse:_0x3b440a,FromRoom_name:_0x2554d5,to_warehouse:_0x282df8,ToRoom_name:_0x73a56,prod_name:_0x17d7ea,from_prod_qty:_0x5d42fd,from_prod_level:_0x3eff03,from_prod_isle:_0xf20be,from_prod_pallet:_0x1ef39e,to_prod_qty:_0x35fd15,to_prod_level:_0xd7ff95,to_prod_isle:_0x354acc,to_prod_pallet:_0xa74215,primary_code:_0x2f4be4,secondary_code:_0x561f72,product_code3:_0x480a54,note:_0x340705,MaxStocks_data2:_0x4a1ab2,invoice:_0x3d24ee,expiry_date:_0x3eeed5,PO_number:_0x16b17b,ReqBy:_0x41c867,dateofreq:_0xf5eda9,typeservicesData:_0x4bc73f,destination:_0x47fac7,deliverydate:_0x2e4b7a,driver:_0x40c723,plate:_0x1dcc34,van:_0x4d236e,DRSI:_0x5d55fa,typevehicle:_0x4dd4db,TSU:_0x2ea3d3,TFU:_0x1d2e53}=_0x2dd969['body'];if(typeof _0x17d7ea==_0x6cf160(0xed))var _0x41e17c=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xc9)]],_0x52e148=[_0x2dd969[_0x6cf160(0x9f)]['from_prod_qty']],_0x42d1b2=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xe5)]],_0x236a1d=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xdb)]],_0x41c735=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x120)]],_0xa5ee0c=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x114)]],_0x2e9bc7=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x113)]],_0x4b0840=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xd3)]],_0x371b73=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xd6)]],_0x4ea6c2=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x116)]],_0x27ea2f=[_0x2dd969['body'][_0x6cf160(0x149)]],_0x4e6bd3=[_0x2dd969['body'][_0x6cf160(0x88)]],_0x226e92=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x8d)]],_0x37b94e=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x141)]],_0x370f71=[_0x2dd969['body']['MaxStocks_data']],_0x216828=[_0x2dd969['body']['maxPerUnit']],_0x28f82b=[_0x2dd969['body'][_0x6cf160(0x10d)]],_0x3c125d=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x86)]],_0x1f902d=[_0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x13c)]],_0x16ac8c=[_0x2dd969[_0x6cf160(0x9f)]['from_invoice']],_0x427ccb=[_0x2dd969['body'][_0x6cf160(0xa2)]];else var _0x41e17c=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xc9)]],_0x52e148=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xce)]],_0x42d1b2=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xe5)]],_0x236a1d=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xdb)]],_0x41c735=[..._0x2dd969['body'][_0x6cf160(0x120)]],_0xa5ee0c=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x114)]],_0x2e9bc7=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x113)]],_0x4b0840=[..._0x2dd969['body'][_0x6cf160(0xd3)]],_0x371b73=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xd6)]],_0x4ea6c2=[..._0x2dd969['body'][_0x6cf160(0x116)]],_0x27ea2f=[..._0x2dd969['body']['secondary_unit']],_0x4e6bd3=[..._0x2dd969['body'][_0x6cf160(0x88)]],_0x226e92=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x8d)]],_0x37b94e=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x141)]],_0x370f71=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0xa9)]],_0x216828=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x14a)]],_0x28f82b=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x10d)]],_0x3c125d=[..._0x2dd969[_0x6cf160(0x9f)][_0x6cf160(0x86)]],_0x1f902d=[..._0x2dd969['body'][_0x6cf160(0x13c)]],_0x16ac8c=[..._0x2dd969['body'][_0x6cf160(0xb2)]],_0x427ccb=[..._0x2dd969['body']['id_transaction']];const _0x30f6bf=_0x41e17c[_0x6cf160(0x124)](_0x30109d=>{return _0x30109d={'product_name':_0x30109d};});_0x52e148[_0x6cf160(0xe3)]((_0x1c1d0f,_0x3420eb)=>{var _0x3c9686=_0x6cf160;_0x30f6bf[_0x3420eb][_0x3c9686(0xde)]=_0x1c1d0f;}),_0x42d1b2[_0x6cf160(0xe3)]((_0x94b973,_0x3e39b5)=>{var _0x41074c=_0x6cf160,_0x123126=_0x94b973[_0x41074c(0xf8)](/[A-Za-z]+/)[0x0],_0x1c1e7b=parseInt(_0x94b973[_0x41074c(0xf8)](/\d+/)[0x0]);_0x30f6bf[_0x3e39b5][_0x41074c(0xda)]=_0x1c1e7b,_0x30f6bf[_0x3e39b5][_0x41074c(0x144)]=_0x123126;}),_0x427ccb[_0x6cf160(0xe3)]((_0x37a277,_0x48ae77)=>{var _0x2d8fbf=_0x6cf160;_0x30f6bf[_0x48ae77][_0x2d8fbf(0xa2)]=_0x37a277;}),_0x16ac8c['forEach']((_0x25bcf9,_0x154f4e)=>{var _0x4e00b0=_0x6cf160;_0x30f6bf[_0x154f4e][_0x4e00b0(0xb2)]=_0x25bcf9;}),_0x236a1d['forEach']((_0x41b09c,_0x5d7bfe)=>{var _0x405984=_0x6cf160;_0x30f6bf[_0x5d7bfe][_0x405984(0xca)]=_0x41b09c;}),_0x41c735[_0x6cf160(0xe3)]((_0x61afbe,_0x79232a)=>{var _0x3ec6ac=_0x6cf160,_0x411595=_0x61afbe[_0x3ec6ac(0xf8)](/[A-Za-z]+/)[0x0],_0x27ac5f=parseInt(_0x61afbe[_0x3ec6ac(0xf8)](/\d+/)[0x0]);_0x30f6bf[_0x79232a][_0x3ec6ac(0x119)]=_0x411595,_0x30f6bf[_0x79232a][_0x3ec6ac(0xf6)]=_0x27ac5f;}),_0xa5ee0c[_0x6cf160(0xe3)]((_0x1732f8,_0x297f4e)=>{var _0xc9d3d=_0x6cf160;_0x30f6bf[_0x297f4e][_0xc9d3d(0x114)]=_0x1732f8;}),_0x2e9bc7[_0x6cf160(0xe3)]((_0x1967e3,_0x52dfb5)=>{var _0x3bf8f6=_0x6cf160;_0x30f6bf[_0x52dfb5][_0x3bf8f6(0x113)]=_0x1967e3;}),_0x4b0840[_0x6cf160(0xe3)]((_0x1f5441,_0x58e27b)=>{_0x30f6bf[_0x58e27b]['product_code']=_0x1f5441;}),_0x371b73[_0x6cf160(0xe3)]((_0x8b1064,_0x4eb6c1)=>{_0x30f6bf[_0x4eb6c1]['maxProducts']=_0x8b1064;}),_0x4ea6c2[_0x6cf160(0xe3)]((_0x8abeda,_0x2ed51f)=>{var _0x17417c=_0x6cf160;_0x30f6bf[_0x2ed51f][_0x17417c(0xf4)]=_0x8abeda;}),_0x27ea2f[_0x6cf160(0xe3)]((_0x50e57b,_0x3ce5cf)=>{var _0x24feff=_0x6cf160;_0x30f6bf[_0x3ce5cf][_0x24feff(0x149)]=_0x50e57b;}),_0x4e6bd3['forEach']((_0x23555e,_0x2090e6)=>{_0x30f6bf[_0x2090e6]['batch_code']=_0x23555e;}),_0x226e92[_0x6cf160(0xe3)]((_0x24f8a0,_0x3112b2)=>{var _0x4ac21c=_0x6cf160;_0x30f6bf[_0x3112b2][_0x4ac21c(0x8d)]=_0x24f8a0;}),_0x37b94e[_0x6cf160(0xe3)]((_0x6f84e5,_0x447308)=>{var _0x59c05b=_0x6cf160;_0x30f6bf[_0x447308][_0x59c05b(0x9d)]=_0x6f84e5;}),_0x370f71[_0x6cf160(0xe3)]((_0x59168e,_0x292b38)=>{var _0x5cee5e=_0x6cf160;_0x30f6bf[_0x292b38][_0x5cee5e(0x9e)]=_0x59168e;}),_0x216828['forEach']((_0x374f63,_0x56c4d3)=>{_0x30f6bf[_0x56c4d3]['maxPerUnit']=_0x374f63;}),_0x28f82b['forEach']((_0x3bd609,_0x263fe6)=>{var _0x560de1=_0x6cf160;_0x30f6bf[_0x263fe6][_0x560de1(0x10d)]=_0x3bd609;}),_0x3c125d[_0x6cf160(0xe3)]((_0x4827f8,_0x4487ce)=>{var _0x1cfd4c=_0x6cf160;_0x30f6bf[_0x4487ce][_0x1cfd4c(0x89)]=_0x4827f8;}),_0x1f902d[_0x6cf160(0xe3)]((_0x4e4874,_0x2c2619)=>{var _0x3618a6=_0x6cf160;_0x30f6bf[_0x2c2619][_0x3618a6(0x110)]=_0x4e4874;});const _0x392894=_0x30f6bf[_0x6cf160(0x99)](_0x20c039=>_0x20c039[_0x6cf160(0xca)]!=='0'&&_0x20c039[_0x6cf160(0xca)]!==''||_0x20c039[_0x6cf160(0x85)]!=='0'&&_0x20c039[_0x6cf160(0x85)]!=='');var _0x39094e=0x0;_0x392894[_0x6cf160(0xe3)](_0x4ed3c6=>{var _0x349c03=_0x6cf160;parseInt(_0x4ed3c6[_0x349c03(0xde)])<parseInt(_0x4ed3c6['to_quantity'])&&_0x39094e++;});if(_0x39094e!=0x0)return _0x2dd969[_0x6cf160(0xdd)](_0x6cf160(0xa8),_0x6cf160(0xad)),_0x526d1e['redirect'](_0x6cf160(0xac));const _0xca34df=new invoice_for_transfer();await _0xca34df[_0x6cf160(0x148)]();for(let _0x5aebdc=0x0;_0x5aebdc<=_0x1f902d[_0x6cf160(0xbe)]-0x1;_0x5aebdc++){_0x30f6bf[_0x5aebdc]['To_invoice']=_0x6cf160(0xbb)+_0xca34df[_0x6cf160(0x8f)][_0x6cf160(0x140)]()[_0x6cf160(0x12a)](0x8,'0');}const _0x553953=new transfers_finished({'date':_0x466df3,'from_warehouse':_0x3b440a,'to_warehouse':_0x3b440a,'product':_0x392894,'note':_0x340705,'invoice':_0x6cf160(0xbb)+_0xca34df[_0x6cf160(0x8f)][_0x6cf160(0x140)]()[_0x6cf160(0x12a)](0x8,'0'),'type_of_process':_0x6cf160(0x14e),'type_of_transaction':_0x6cf160(0x84),'PO_number':_0x16b17b,'RequestedBy':_0x41c867,'DateofRequest':_0xf5eda9,'typeservices':_0x4bc73f,'destination':_0x47fac7,'deliverydate':_0x2e4b7a,'driver':_0x40c723,'plate':_0x1dcc34,'van':_0x4d236e,'DRSI':_0x5d55fa,'typevehicle':_0x4dd4db,'TSU':_0x2ea3d3,'TFU':_0x1d2e53}),_0x1097fa=await _0x553953[_0x6cf160(0x148)]();_0x2dd969[_0x6cf160(0xdd)](_0x6cf160(0x98),_0x6cf160(0x9a)),_0x526d1e[_0x6cf160(0x9c)](_0x6cf160(0x82)+_0x1097fa['_id']);}catch(_0x39cd11){console[_0x6cf160(0x10a)](_0x39cd11),_0x526d1e['status'](0xc8)['json']({'errorMessage':_0x39cd11[_0x6cf160(0x101)]});}}),router[a0_0x343579(0x11c)](a0_0x343579(0xbc),auth,async(_0x595a77,_0xb0d690)=>{var _0x201e9b=a0_0x343579;try{const {date:_0x4a8f66,from_warehouse:_0x400306,FromRoom_name:_0x3ef69b,to_warehouse:_0x28afda,ToRoom_name:_0x58c487,prod_name:_0x25f904,from_prod_qty:_0x1aa4a0,from_prod_level:_0x55c133,from_prod_isle:_0x39a314,from_prod_pallet:_0x5ed5f0,to_prod_qty:_0x50405f,to_prod_level:_0x5667c1,to_prod_isle:_0xf869d8,to_prod_pallet:_0x2367c0,primary_code:_0x51c966,secondary_code:_0x56edfb,product_code3:_0x12336b,note:_0x2ca6a5,MaxStocks_data2:_0x8766aa,invoice:_0x5259ea,expiry_date:_0x1a3a0e,PO_number_loc:_0x30d1ff,ReqBy_loc:_0x426ba8,dateofreq_loc:_0x3f3c12,typeservices_loc_Data:_0x4d9b44,destination_loc:_0x12a447,deliverydate_loc:_0x5bf7b7,driver_loc:_0x409ae0,plate_loc:_0x52424e,van_loc:_0x4a370d,DRSI_loc:_0x42558e,typevehicle_loc:_0x4e9db3,TSU_loc:_0x359871,TFU_loc:_0x32546b}=_0x595a77['body'];if(typeof _0x25f904==_0x201e9b(0xed))var _0x7a473f=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xc9)]],_0x1b728b=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xce)]],_0x34a575=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xe5)]],_0x438a77=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xdb)]],_0xf06719=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x120)]],_0x4c33c6=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x114)]],_0x1c9a4d=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x113)]],_0x5946b4=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xd3)]],_0x2905e0=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xd6)]],_0x1a0d50=[_0x595a77[_0x201e9b(0x9f)]['primary_unit']],_0x40c7a2=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x149)]],_0x4be3ab=[_0x595a77['body'][_0x201e9b(0x88)]],_0x174745=[_0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x8d)]],_0x41b5ff=[_0x595a77[_0x201e9b(0x9f)]['product_date']],_0x54455f=[_0x595a77['body']['MaxStocks_data']],_0x21f851=[_0x595a77['body']['maxPerUnit']],_0x5d74d5=[_0x595a77['body'][_0x201e9b(0x10d)]],_0x56cce5=[_0x595a77['body']['RoomAssigned']],_0x35e167=[_0x595a77['body'][_0x201e9b(0x13c)]],_0x2c457b=[_0x595a77['body'][_0x201e9b(0xb2)]],_0x5f4dcf=[_0x595a77['body'][_0x201e9b(0xa2)]];else var _0x7a473f=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xc9)]],_0x1b728b=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xce)]],_0x34a575=[..._0x595a77[_0x201e9b(0x9f)]['from_prod_level2']],_0x438a77=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xdb)]],_0xf06719=[..._0x595a77['body'][_0x201e9b(0x120)]],_0x4c33c6=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x114)]],_0x1c9a4d=[..._0x595a77[_0x201e9b(0x9f)]['secondary_code']],_0x5946b4=[..._0x595a77[_0x201e9b(0x9f)]['product_code3']],_0x2905e0=[..._0x595a77['body'][_0x201e9b(0xd6)]],_0x1a0d50=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x116)]],_0x40c7a2=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x149)]],_0x4be3ab=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x88)]],_0x174745=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x8d)]],_0x41b5ff=[..._0x595a77['body'][_0x201e9b(0x141)]],_0x54455f=[..._0x595a77[_0x201e9b(0x9f)]['MaxStocks_data']],_0x21f851=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x14a)]],_0x5d74d5=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x10d)]],_0x56cce5=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0x86)]],_0x35e167=[..._0x595a77['body'][_0x201e9b(0x13c)]],_0x2c457b=[..._0x595a77['body'][_0x201e9b(0xb2)]],_0x5f4dcf=[..._0x595a77[_0x201e9b(0x9f)][_0x201e9b(0xa2)]];const _0x2c8921=_0x7a473f[_0x201e9b(0x124)](_0x2e3980=>{return _0x2e3980={'product_name':_0x2e3980};});_0x1b728b[_0x201e9b(0xe3)]((_0x104efb,_0x1b8b01)=>{var _0x401357=_0x201e9b;_0x2c8921[_0x1b8b01][_0x401357(0xde)]=_0x104efb;}),_0x34a575[_0x201e9b(0xe3)]((_0x1b5110,_0x46cbd8)=>{var _0x4b5a9f=_0x201e9b,_0x367d3f=_0x1b5110['match'](/[A-Za-z]+/)[0x0],_0x2dc55b=parseInt(_0x1b5110[_0x4b5a9f(0xf8)](/\d+/)[0x0]);_0x2c8921[_0x46cbd8]['from_bay']=_0x2dc55b,_0x2c8921[_0x46cbd8][_0x4b5a9f(0x144)]=_0x367d3f;}),_0x5f4dcf['forEach']((_0xb57baf,_0x5a110a)=>{_0x2c8921[_0x5a110a]['id_transaction']=_0xb57baf;}),_0x2c457b[_0x201e9b(0xe3)]((_0x23c3b1,_0xa0104)=>{_0x2c8921[_0xa0104]['from_invoice']=_0x23c3b1;}),_0x438a77['forEach']((_0x731684,_0x5098b8)=>{var _0x36170d=_0x201e9b;_0x2c8921[_0x5098b8][_0x36170d(0xca)]=_0x731684;}),_0xf06719[_0x201e9b(0xe3)]((_0x38e03d,_0x47cc5a)=>{var _0xcd92=_0x201e9b,_0x19284b=_0x38e03d[_0xcd92(0xf8)](/[A-Za-z]+/)[0x0],_0x1f7d5c=parseInt(_0x38e03d[_0xcd92(0xf8)](/\d+/)[0x0]);_0x2c8921[_0x47cc5a][_0xcd92(0x119)]=_0x19284b,_0x2c8921[_0x47cc5a][_0xcd92(0xf6)]=_0x1f7d5c;}),_0x4c33c6[_0x201e9b(0xe3)]((_0xf811dc,_0x583225)=>{_0x2c8921[_0x583225]['primary_code']=_0xf811dc;}),_0x1c9a4d['forEach']((_0x9ba1b3,_0x1d20f4)=>{var _0x3f995c=_0x201e9b;_0x2c8921[_0x1d20f4][_0x3f995c(0x113)]=_0x9ba1b3;}),_0x5946b4[_0x201e9b(0xe3)]((_0x41bf93,_0x25c04b)=>{var _0x40c355=_0x201e9b;_0x2c8921[_0x25c04b][_0x40c355(0x10b)]=_0x41bf93;}),_0x2905e0[_0x201e9b(0xe3)]((_0xf88e07,_0x4611fc)=>{var _0x14b218=_0x201e9b;_0x2c8921[_0x4611fc][_0x14b218(0x9e)]=_0xf88e07;}),_0x1a0d50[_0x201e9b(0xe3)]((_0x93b96f,_0xba16a6)=>{var _0x484728=_0x201e9b;_0x2c8921[_0xba16a6][_0x484728(0xf4)]=_0x93b96f;}),_0x40c7a2[_0x201e9b(0xe3)]((_0x33bff2,_0x410b4d)=>{var _0x56907a=_0x201e9b;_0x2c8921[_0x410b4d][_0x56907a(0x149)]=_0x33bff2;}),_0x4be3ab[_0x201e9b(0xe3)]((_0x30e011,_0x1690e9)=>{var _0x363280=_0x201e9b;_0x2c8921[_0x1690e9][_0x363280(0x88)]=_0x30e011;}),_0x174745[_0x201e9b(0xe3)]((_0x4bfaff,_0x415f8b)=>{var _0x8d8f9a=_0x201e9b;_0x2c8921[_0x415f8b][_0x8d8f9a(0x8d)]=_0x4bfaff;}),_0x41b5ff['forEach']((_0xff2265,_0x3b8b15)=>{_0x2c8921[_0x3b8b15]['production_date']=_0xff2265;}),_0x54455f['forEach']((_0x32f029,_0x123f6a)=>{var _0x432e0f=_0x201e9b;_0x2c8921[_0x123f6a][_0x432e0f(0x9e)]=_0x32f029;}),_0x21f851['forEach']((_0x6af798,_0x3c41b6)=>{var _0x2ae693=_0x201e9b;_0x2c8921[_0x3c41b6][_0x2ae693(0x14a)]=_0x6af798;}),_0x5d74d5[_0x201e9b(0xe3)]((_0x4da08d,_0x5149dc)=>{var _0x2ce7c9=_0x201e9b;_0x2c8921[_0x5149dc][_0x2ce7c9(0x10d)]=_0x4da08d;}),_0x56cce5['forEach']((_0x42e833,_0x5a9449)=>{var _0x90b35d=_0x201e9b;_0x2c8921[_0x5a9449][_0x90b35d(0x89)]=_0x42e833;}),_0x35e167[_0x201e9b(0xe3)]((_0x205a92,_0x26babf)=>{var _0x2030c6=_0x201e9b;_0x2c8921[_0x26babf][_0x2030c6(0x110)]=_0x205a92;});const _0x13ffd3=_0x2c8921[_0x201e9b(0x99)](_0x43f568=>_0x43f568[_0x201e9b(0xca)]!=='0'&&_0x43f568[_0x201e9b(0xca)]!==''||_0x43f568[_0x201e9b(0x85)]!=='0'&&_0x43f568[_0x201e9b(0x85)]!=='');var _0x3adeed=0x0;_0x13ffd3['forEach'](_0x45e4a1=>{var _0x374635=_0x201e9b;parseInt(_0x45e4a1[_0x374635(0xde)])<parseInt(_0x45e4a1['to_quantity'])&&_0x3adeed++;});if(_0x3adeed!=0x0)return _0x595a77[_0x201e9b(0xdd)](_0x201e9b(0xa8),_0x201e9b(0xad)),_0xb0d690[_0x201e9b(0x9c)](_0x201e9b(0xac));const _0x2da855=new invoice_for_transfer();await _0x2da855[_0x201e9b(0x148)]();for(let _0x464e08=0x0;_0x464e08<=_0x35e167[_0x201e9b(0xbe)]-0x1;_0x464e08++){_0x2c8921[_0x464e08][_0x201e9b(0xb5)]=_0x201e9b(0xbb)+_0x2da855[_0x201e9b(0x8f)][_0x201e9b(0x140)]()[_0x201e9b(0x12a)](0x8,'0');}const _0xe6a67b=new transfers_finished({'date':_0x4a8f66,'from_warehouse':_0x400306,'to_warehouse':_0x28afda,'product':_0x13ffd3,'note':_0x2ca6a5,'invoice':_0x201e9b(0xbb)+_0x2da855[_0x201e9b(0x8f)][_0x201e9b(0x140)]()[_0x201e9b(0x12a)](0x8,'0'),'type_of_transaction':_0x201e9b(0x84),'type_of_process':'location2location','PO_number':_0x30d1ff,'RequestedBy':_0x426ba8,'DateofRequest':_0x3f3c12,'typeservices':_0x4d9b44,'destination':_0x12a447,'deliverydate':_0x5bf7b7,'driver':_0x409ae0,'plate':_0x52424e,'van':_0x4a370d,'DRSI':_0x42558e,'typevehicle':_0x4e9db3,'TSU':_0x359871,'TFU':_0x32546b}),_0x5cb1b1=await _0xe6a67b[_0x201e9b(0x148)]();_0x595a77[_0x201e9b(0xdd)](_0x201e9b(0x98),_0x201e9b(0x9a)),_0xb0d690[_0x201e9b(0x9c)](_0x201e9b(0x82)+_0x5cb1b1[_0x201e9b(0xc5)]);}catch(_0x4c0d5a){console[_0x201e9b(0x10a)](_0x4c0d5a),_0xb0d690[_0x201e9b(0x8c)](0xc8)[_0x201e9b(0x11e)]({'errorMessage':_0x4c0d5a[_0x201e9b(0x101)]});}}),router[a0_0x343579(0x9b)]('/preview/:id',auth,async(_0x3f3fda,_0x15d8fa)=>{var _0x57cc57=a0_0x343579;try{const {username:_0x553f42,email:_0x8f88b0,role:_0x14c717}=_0x3f3fda[_0x57cc57(0xc6)],_0xb0dc4d=_0x3f3fda[_0x57cc57(0xc6)],_0x6a2d70=await profile[_0x57cc57(0xa4)]({'email':_0xb0dc4d[_0x57cc57(0x137)]}),_0x5416ff=await master_shop[_0x57cc57(0xc3)](),_0xdd3f18=await transfers_finished[_0x57cc57(0xd0)](_0x3f3fda[_0x57cc57(0xb1)]['id']);let _0x2ddbe3;if(_0xb0dc4d[_0x57cc57(0xfc)]=='staff'){const _0x490998=await staff['findOne']({'email':_0xb0dc4d[_0x57cc57(0x137)]});_0x2ddbe3=await warehouse[_0x57cc57(0xc3)]({'status':_0x57cc57(0x135),'name':_0x490998[_0x57cc57(0x134)],'warehouse_category':_0x57cc57(0xd2)});}else _0x2ddbe3=await warehouse[_0x57cc57(0xc3)]({'status':_0x57cc57(0x135),'warehouse_category':'Finished\x20Goods'});const _0xe3b705=await warehouse[_0x57cc57(0x95)]([{'$match':{'name':_0xdd3f18[_0x57cc57(0x10c)],'warehouse_category':_0x57cc57(0xd2)}},{'$unwind':_0x57cc57(0xd7)},{'$group':{'_id':_0x57cc57(0x11f),'name':{'$first':_0x57cc57(0xb3)},'product_stock':{'$first':_0x57cc57(0x80)},'bay':{'$first':_0x57cc57(0xbf)},'bin':{'$first':_0x57cc57(0x121)},'type':{'$first':_0x57cc57(0xb6)},'floorlevel':{'$first':_0x57cc57(0x93)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x57cc57(0xa1)},'product_code':{'$first':_0x57cc57(0x14c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x57cc57(0xeb)},'room':{'$first':_0x57cc57(0x13a)},'warehoue_name':{'$first':_0x57cc57(0xfa)}}}]),_0x4348d2=await product[_0x57cc57(0xc3)]({});if(_0x5416ff[0x0][_0x57cc57(0x126)]==_0x57cc57(0x81)){var _0x2d9db3=users[_0x57cc57(0x109)];console[_0x57cc57(0x10a)](_0x2d9db3);}else{if(_0x5416ff[0x0][_0x57cc57(0x126)]==_0x57cc57(0x127))var _0x2d9db3=users['Hindi'];else{if(_0x5416ff[0x0][_0x57cc57(0x126)]==_0x57cc57(0xb8))var _0x2d9db3=users[_0x57cc57(0xb8)];else{if(_0x5416ff[0x0][_0x57cc57(0x126)]==_0x57cc57(0xbd))var _0x2d9db3=users[_0x57cc57(0xbd)];else{if(_0x5416ff[0x0]['language']==_0x57cc57(0x117))var _0x2d9db3=users['French'];else{if(_0x5416ff[0x0][_0x57cc57(0x126)]=='Portuguese\x20(BR)')var _0x2d9db3=users[_0x57cc57(0x143)];else{if(_0x5416ff[0x0][_0x57cc57(0x126)]=='Chinese')var _0x2d9db3=users['Chinese'];else{if(_0x5416ff[0x0][_0x57cc57(0x126)]==_0x57cc57(0xd8))var _0x2d9db3=users[_0x57cc57(0xfb)];}}}}}}}_0x15d8fa[_0x57cc57(0x94)](_0x57cc57(0x111),{'success':_0x3f3fda[_0x57cc57(0xdd)](_0x57cc57(0x98)),'errors':_0x3f3fda['flash'](_0x57cc57(0xa8)),'role':_0xb0dc4d,'profile':_0x6a2d70,'master_shop':_0x5416ff,'warehouse':_0x2ddbe3,'transfer':_0xdd3f18,'stock':_0xe3b705,'unit':_0x4348d2,'language':_0x2d9db3});}catch(_0x446469){console[_0x57cc57(0x10a)](_0x446469);}}),router[a0_0x343579(0x11c)](a0_0x343579(0x10f),auth,async(_0x1c8ce5,_0x539f30)=>{var _0x479c80=a0_0x343579;try{const {invoice:_0x3301b4,from_warehouse:_0x93ac08,FromRoom_name:_0x323093,to_warehouse:_0x2e270e,ToRoom_name:_0x15e2ad}=_0x1c8ce5[_0x479c80(0x9f)],_0x49b1bc=await transfers_finished[_0x479c80(0xd0)](_0x1c8ce5[_0x479c80(0xb1)]['id']),_0x29be05=_0x49b1bc['product'][_0x479c80(0x124)](async _0x41ddfc=>{var _0x19e187=_0x479c80;if(_0x41ddfc[_0x19e187(0xca)]>0x0){var _0x4015ce=await warehouse[_0x19e187(0xa4)]({'name':_0x93ac08,'room':_0x41ddfc[_0x19e187(0x89)]});const _0x52d3c4=_0x4015ce['product_details']['map'](_0x391f55=>{var _0xb4d27f=_0x19e187;_0x391f55[_0xb4d27f(0xc5)]==_0x41ddfc[_0xb4d27f(0xa2)]&&(_0x391f55[_0xb4d27f(0xf5)]=Math['max'](0x0,Math[_0xb4d27f(0x105)](_0x391f55['product_stock'])-Math['abs'](_0x41ddfc[_0xb4d27f(0xca)])),console[_0xb4d27f(0x10a)](_0x391f55['product_stock']));});}return _0x4015ce;});Promise[_0x479c80(0x96)](_0x29be05)[_0x479c80(0x104)](async _0x42e56a=>{var _0x1d443e=_0x479c80;try{for(const _0x4bb3fa of _0x42e56a){await _0x4bb3fa[_0x1d443e(0x148)]();}const _0x32bf4f=_0x49b1bc[_0x1d443e(0xe9)][_0x1d443e(0x124)](async _0x2a57d7=>{var _0x116c4d=_0x1d443e,_0x5ee9cd=await warehouse[_0x116c4d(0xa4)]({'name':_0x2e270e,'room':_0x2a57d7[_0x116c4d(0x110)]});if(_0x2a57d7[_0x116c4d(0xca)]>0x0){var _0x23892d=0x0;const _0xd4f1d3=_0x5ee9cd['product_details'][_0x116c4d(0x124)](_0x464fc2=>{var _0x390c81=_0x116c4d;_0x464fc2[_0x390c81(0x132)]==_0x2a57d7[_0x390c81(0x132)]&&_0x464fc2[_0x390c81(0x91)]==_0x2a57d7[_0x390c81(0xf6)]&&_0x464fc2[_0x390c81(0x8d)]==_0x2a57d7[_0x390c81(0x8d)]&&_0x464fc2['production_date']==_0x2a57d7[_0x390c81(0x9d)]&&_0x464fc2[_0x390c81(0x88)]==_0x2a57d7[_0x390c81(0x88)]&&_0x464fc2['invoice']==_0x2a57d7[_0x390c81(0xb5)]&&(typeof _0x2a57d7[_0x390c81(0xa2)]==_0x390c81(0xe8)?(console['log'](_0x390c81(0xab),_0x464fc2[_0x390c81(0xf5)]+_0x390c81(0x90)+_0x464fc2[_0x390c81(0xc5)]+'\x20<=>\x20'+Math[_0x390c81(0x105)](_0x464fc2[_0x390c81(0xf5)])+Math['abs'](_0x2a57d7[_0x390c81(0xca)])),_0x464fc2['product_stock']=Math['abs'](_0x464fc2[_0x390c81(0xf5)])+Math['abs'](_0x2a57d7[_0x390c81(0xca)])):_0x464fc2['product_stock']=Math[_0x390c81(0x105)](_0x464fc2[_0x390c81(0xf5)])+Math[_0x390c81(0x105)](_0x2a57d7['to_quantity']),_0x23892d++);});_0x23892d=='0'&&(_0x5ee9cd[_0x116c4d(0x130)]=_0x5ee9cd[_0x116c4d(0x130)][_0x116c4d(0xff)]({'product_name':_0x2a57d7[_0x116c4d(0x132)],'product_stock':_0x2a57d7[_0x116c4d(0xca)],'bay':_0x2a57d7['to_bay'],'level':_0x2a57d7[_0x116c4d(0x119)],'product_code':_0x2a57d7['product_code'],'primary_code':_0x2a57d7[_0x116c4d(0x114)],'secondary_code':_0x2a57d7[_0x116c4d(0x113)],'expiry_date':_0x2a57d7[_0x116c4d(0x8d)],'production_date':_0x2a57d7[_0x116c4d(0x9d)],'maxProducts':_0x2a57d7[_0x116c4d(0x9e)],'batch_code':_0x2a57d7[_0x116c4d(0x88)],'secondary_unit':_0x2a57d7['secondary_unit'],'unit':_0x2a57d7[_0x116c4d(0xf4)],'maxProducts':_0x2a57d7['maxProducts'],'maxPerUnit':_0x2a57d7[_0x116c4d(0x14a)],'invoice':_0x2a57d7[_0x116c4d(0xb5)]}));}return _0x5ee9cd;});Promise['all'](_0x32bf4f)['then'](async _0x466870=>{var _0x318855=_0x1d443e;try{console[_0x318855(0x10a)](_0x49b1bc[_0x318855(0x11d)]);if(_0x49b1bc[_0x318855(0x11d)]!='location2location')for(const _0x210dde of _0x466870){await warehouse[_0x318855(0xb7)]({'_id':_0x210dde[_0x318855(0xc5)]},{'$addToSet':{'product_details':{'$each':_0x210dde[_0x318855(0x130)]}}});}_0x49b1bc[_0x318855(0xc2)]=_0x318855(0x8a);const _0x54528f=await _0x49b1bc[_0x318855(0x148)](),_0x44087c=await master_shop[_0x318855(0xc3)](),_0x18064e=await email_settings['findOne'](),_0x1f4172=await supervisor_settings['find']();var _0x39c598=_0x49b1bc[_0x318855(0xe9)],_0x3b4321='',_0x55eec6;for(_0x55eec6 in _0x39c598){var _0x51d3a9='FG';_0x49b1bc[_0x318855(0xcc)]==_0x318855(0x136)&&(_0x51d3a9='DG'),_0x3b4321+=_0x318855(0x102)+_0x318855(0xef)+_0x39c598[_0x55eec6][_0x318855(0x132)]+'</td>'+_0x318855(0xef)+_0x39c598[_0x55eec6][_0x318855(0x10b)]+_0x318855(0xd9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x39c598[_0x55eec6][_0x318855(0xca)]+'</td>'+_0x318855(0xef)+_0x39c598[_0x55eec6][_0x318855(0xf4)]+_0x318855(0xd9)+_0x318855(0xef)+_0x39c598[_0x55eec6][_0x318855(0x149)]+_0x318855(0xd9)+_0x318855(0xef)+_0x49b1bc[_0x318855(0xcc)]+_0x318855(0xd9)+_0x318855(0xef)+_0x39c598[_0x55eec6][_0x318855(0x110)]+_0x318855(0xd9)+_0x318855(0xef)+_0x51d3a9+_0x39c598[_0x55eec6]['to_bay']+_0x318855(0xd9)+_0x318855(0xa3);}_0x1c8ce5['flash']('success',_0x318855(0x115)),_0x539f30[_0x318855(0x9c)]('/picking_list/PDF_transfer/'+_0x54528f[_0x318855(0xc5)]);}catch(_0x240564){console[_0x318855(0x92)](_0x240564),_0x539f30[_0x318855(0x8c)](0x1f4)['json']({'error':_0x318855(0xa7)});}})[_0x1d443e(0x125)](_0x495b07=>{var _0x11be07=_0x1d443e;console[_0x11be07(0x92)](_0x495b07),_0x539f30[_0x11be07(0x8c)](0x1f4)[_0x11be07(0x11e)]({'error':'An\x20error\x20occurred.'});});}catch(_0x666ed2){console[_0x1d443e(0x92)](_0x666ed2),_0x539f30['status'](0x1f4)[_0x1d443e(0x11e)]({'error':_0x1d443e(0x122)});}})[_0x479c80(0x125)](_0x5a49f9=>{var _0x5a7bc4=_0x479c80;console[_0x5a7bc4(0x92)](_0x5a49f9),_0x539f30[_0x5a7bc4(0x8c)](0x1f4)[_0x5a7bc4(0x11e)]({'error':_0x5a7bc4(0x11b)});});}catch(_0x204435){_0x539f30[_0x479c80(0x11e)]({'message':_0x204435[_0x479c80(0x101)]});}});function BayBinSelected(_0x417556,_0x2da383){var _0x13fa40=a0_0x343579,_0x283329=[];let _0x4b4177=[];var _0x92e9ea=[];if(_0x417556==_0x13fa40(0x136)){switch(_0x2da383){case _0x13fa40(0xa6):_0x283329=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x283329=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x92e9ea=['DG'];}else{if(_0x417556==_0x13fa40(0x106)){switch(_0x2da383){case _0x13fa40(0xa6):_0x283329=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x13fa40(0xcf):_0x283329=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x92e9ea=['FG'];}}return{'levels':_0x283329,'identify':_0x92e9ea};}function a0_0x1ce8(_0x265709,_0x12fc80){var _0x57a68c=a0_0x57a6();return a0_0x1ce8=function(_0x1ce84a,_0x438a0f){_0x1ce84a=_0x1ce84a-0x80;var _0x39217b=_0x57a68c[_0x1ce84a];return _0x39217b;},a0_0x1ce8(_0x265709,_0x12fc80);}router['get']('/view/:id',auth,async(_0x4e7d6a,_0x35c830)=>{var _0x2da8e9=a0_0x343579;try{const {username:_0xf324cd,email:_0x3ac98a,role:_0x2e1677}=_0x4e7d6a[_0x2da8e9(0xc6)],_0x3296fc=_0x4e7d6a[_0x2da8e9(0xc6)],_0x587cf0=await profile[_0x2da8e9(0xa4)]({'email':_0x3296fc['email']}),_0x43e601=await master_shop[_0x2da8e9(0xc3)](),_0x33257f=await transfers_finished[_0x2da8e9(0xd0)](_0x4e7d6a[_0x2da8e9(0xb1)]['id']);let _0x4c5c0c=new Date(_0x33257f[_0x2da8e9(0x8d)]),_0x250ffb=('0'+_0x4c5c0c[_0x2da8e9(0xea)]())[_0x2da8e9(0x12f)](-0x2),_0x4770f2=('0'+(_0x4c5c0c[_0x2da8e9(0xd4)]()+0x1))[_0x2da8e9(0x12f)](-0x2),_0x345610=_0x4c5c0c['getFullYear'](),_0xaaebc1=_0x345610+'-'+_0x4770f2+'-'+_0x250ffb,_0x349433;if(_0x3296fc[_0x2da8e9(0xfc)]==_0x2da8e9(0x138)){const _0x57b174=await staff[_0x2da8e9(0xa4)]({'email':_0x3296fc['email']});_0x349433=await warehouse[_0x2da8e9(0xc3)]({'status':_0x2da8e9(0x135),'name':_0x57b174[_0x2da8e9(0x134)],'warehouse_category':_0x2da8e9(0xd2)});}else _0x349433=await warehouse[_0x2da8e9(0xc3)]({'status':_0x2da8e9(0x135),'warehouse_category':'Finished\x20Goods'});const _0x30baa5=await warehouse[_0x2da8e9(0x95)]([{'$match':{'name':_0x33257f['from_warehouse'],'room':_0x33257f[_0x2da8e9(0xc1)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2da8e9(0x80)},'bay':{'$first':_0x2da8e9(0xbf)},'bin':{'$first':_0x2da8e9(0x121)},'type':{'$first':_0x2da8e9(0xb6)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2da8e9(0xa1)},'product_code':{'$first':_0x2da8e9(0x14c)},'storage':{'$first':_0x2da8e9(0x112)},'rack':{'$first':'$product_details.rack'}}}]);var _0x1f4883=[0x1,0x2,0x3,0x4],_0x310b6d=['A','B','C','D','E','F','G','H','I','J'],_0x5c221b=[_0x2da8e9(0x103),'Enclosed'];const _0x436b38=await product['find']({}),_0x387526=BayBinSelected(_0x33257f[_0x2da8e9(0xcc)],_0x33257f['to_room']);if(_0x43e601[0x0][_0x2da8e9(0x126)]==_0x2da8e9(0x81)){var _0x1362bc=users[_0x2da8e9(0x109)];console[_0x2da8e9(0x10a)](_0x1362bc);}else{if(_0x43e601[0x0][_0x2da8e9(0x126)]==_0x2da8e9(0x127))var _0x1362bc=users['Hindi'];else{if(_0x43e601[0x0][_0x2da8e9(0x126)]=='German')var _0x1362bc=users['German'];else{if(_0x43e601[0x0][_0x2da8e9(0x126)]==_0x2da8e9(0xbd))var _0x1362bc=users[_0x2da8e9(0xbd)];else{if(_0x43e601[0x0][_0x2da8e9(0x126)]==_0x2da8e9(0x117))var _0x1362bc=users[_0x2da8e9(0x117)];else{if(_0x43e601[0x0][_0x2da8e9(0x126)]==_0x2da8e9(0xee))var _0x1362bc=users[_0x2da8e9(0x143)];else{if(_0x43e601[0x0]['language']==_0x2da8e9(0xf1))var _0x1362bc=users[_0x2da8e9(0xf1)];else{if(_0x43e601[0x0]['language']==_0x2da8e9(0xd8))var _0x1362bc=users[_0x2da8e9(0xfb)];}}}}}}}_0x35c830[_0x2da8e9(0x94)](_0x2da8e9(0xfe),{'success':_0x4e7d6a[_0x2da8e9(0xdd)](_0x2da8e9(0x98)),'errors':_0x4e7d6a[_0x2da8e9(0xdd)](_0x2da8e9(0xa8)),'role':_0x3296fc,'profile':_0x587cf0,'master_shop':_0x43e601,'warehouse':_0x349433,'transfer':_0x33257f,'stock':_0x30baa5,'unit':_0x436b38,'language':_0x1362bc,'levels':_0x1f4883,'Isle':_0x310b6d,'rooms_data':_0x5c221b,'ed_fullDate':_0xaaebc1,'dataSelected':_0x387526});}catch(_0x441636){console[_0x2da8e9(0x10a)](_0x441636);}}),router['post']('/view/:id',auth,async(_0x4d68d9,_0x75c1de)=>{var _0x2119c0=a0_0x343579;try{const _0x52f05c=_0x4d68d9[_0x2119c0(0xb1)]['id'];console[_0x2119c0(0x10a)](_0x4d68d9[_0x2119c0(0x9f)]);const _0x59f93a=await transfers_finished[_0x2119c0(0xd0)](_0x52f05c);console[_0x2119c0(0x10a)](_0x2119c0(0x97),_0x59f93a);const {date:_0x3d25b0,from_warehouse:_0x463c80,FromRoom_name:_0x25ded1,to_warehouse:_0x3ae94c,ToRoom_name:_0x510d74,prod_name:_0xd5dfcd,from_prod_qty:_0x2569a3,from_prod_level:_0x1a65da,from_prod_isle:_0x10b9b0,from_prod_pallet:_0x3b8ae7,to_prod_qty:_0x108810,to_prod_level:_0x44819d,to_prod_isle:_0x57cfca,to_prod_pallet:_0x1d3cd7,primary_code:_0x44181a,secondary_code:_0x2a3aa3,product_code3:_0x5e1397,note:_0x3604b6,invoice:_0x46b71a,expiry_date:_0x2a4d61}=_0x4d68d9[_0x2119c0(0x9f)];if(typeof _0xd5dfcd==_0x2119c0(0xed))var _0x15bf26=[_0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0xc9)]],_0x136515=[_0x4d68d9[_0x2119c0(0x9f)]['from_prod_qty']],_0x5bc94b=[_0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0x13e)]],_0x4d4745=[_0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0x12c)]],_0x5316c6=[_0x4d68d9['body'][_0x2119c0(0x120)]],_0x1e87a3=[_0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0x114)]],_0x3df30b=[_0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0x113)]],_0x14fe2b=[_0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0xd3)]],_0x3a84d8=[_0x4d68d9['body'][_0x2119c0(0xd6)]],_0x35b908=[_0x4d68d9[_0x2119c0(0x9f)]['unit']],_0x397ccc=[_0x4d68d9['body'][_0x2119c0(0x149)]],_0x4472e8=[_0x4d68d9['body'][_0x2119c0(0x88)]],_0x190574=[_0x4d68d9[_0x2119c0(0x9f)]['expiry_date']];else var _0x15bf26=[..._0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0xc9)]],_0x136515=[..._0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0xce)]],_0x5bc94b=[..._0x4d68d9['body']['from_prod_level']],_0x4d4745=[..._0x4d68d9[_0x2119c0(0x9f)]['to_prod_qty']],_0x5316c6=[..._0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0x120)]],_0x1e87a3=[..._0x4d68d9[_0x2119c0(0x9f)]['primary_code']],_0x3df30b=[..._0x4d68d9[_0x2119c0(0x9f)]['secondary_code']],_0x14fe2b=[..._0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0xd3)]],_0x3a84d8=[..._0x4d68d9[_0x2119c0(0x9f)]['MaxStocks_data2']],_0x35b908=[..._0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0xf4)]],_0x397ccc=[..._0x4d68d9['body']['secondary_unit']],_0x4472e8=[..._0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0x88)]],_0x190574=[..._0x4d68d9[_0x2119c0(0x9f)][_0x2119c0(0x8d)]];const _0xcb17b4=_0x15bf26[_0x2119c0(0x124)](_0x2fb75e=>{return _0x2fb75e={'product_name':_0x2fb75e};});_0x136515[_0x2119c0(0xe3)]((_0x3ff6ac,_0x4b9d93)=>{var _0x213b6d=_0x2119c0;_0xcb17b4[_0x4b9d93][_0x213b6d(0xde)]=_0x3ff6ac;}),_0x5bc94b['forEach']((_0x9e16cf,_0x1eb9ac)=>{var _0x5d2e86=_0x2119c0;_0xcb17b4[_0x1eb9ac][_0x5d2e86(0xda)]=_0x9e16cf;}),_0x4d4745[_0x2119c0(0xe3)]((_0x246e61,_0x14c3e5)=>{_0xcb17b4[_0x14c3e5]['to_quantity']=_0x246e61;}),_0x5316c6[_0x2119c0(0xe3)]((_0x325065,_0x44beaa)=>{var _0x38ace3=_0x2119c0;_0xcb17b4[_0x44beaa][_0x38ace3(0xf6)]=_0x325065;}),_0x1e87a3[_0x2119c0(0xe3)]((_0xd51b03,_0x1c19e5)=>{_0xcb17b4[_0x1c19e5]['primary_code']=_0xd51b03;}),_0x3df30b[_0x2119c0(0xe3)]((_0x563bce,_0x48da36)=>{var _0x45f61c=_0x2119c0;_0xcb17b4[_0x48da36][_0x45f61c(0x113)]=_0x563bce;}),_0x14fe2b[_0x2119c0(0xe3)]((_0x29d568,_0x5d5360)=>{var _0x4b503f=_0x2119c0;_0xcb17b4[_0x5d5360][_0x4b503f(0x10b)]=_0x29d568;}),_0x3a84d8['forEach']((_0x1f936f,_0x338159)=>{_0xcb17b4[_0x338159]['maxProducts']=_0x1f936f;}),_0x35b908[_0x2119c0(0xe3)]((_0x5a6db8,_0x184806)=>{var _0x5743c2=_0x2119c0;_0xcb17b4[_0x184806][_0x5743c2(0xf4)]=_0x5a6db8;}),_0x397ccc[_0x2119c0(0xe3)]((_0x37069a,_0x2980f5)=>{var _0x5c8b0f=_0x2119c0;_0xcb17b4[_0x2980f5][_0x5c8b0f(0x149)]=_0x37069a;}),_0x4472e8['forEach']((_0x99b891,_0x56fbd6)=>{var _0x3cc8a1=_0x2119c0;_0xcb17b4[_0x56fbd6][_0x3cc8a1(0x88)]=_0x99b891;}),_0x190574[_0x2119c0(0xe3)]((_0x1c6ffc,_0x212c56)=>{_0xcb17b4[_0x212c56]['expiry_date']=_0x1c6ffc;});const _0x170492=_0xcb17b4[_0x2119c0(0x99)](_0x1a854d=>_0x1a854d[_0x2119c0(0xca)]!=='0'&&_0x1a854d[_0x2119c0(0xca)]!==''||_0x1a854d[_0x2119c0(0x85)]!=='0'&&_0x1a854d[_0x2119c0(0x85)]!=='');var _0x2338f5=0x0;_0x170492['forEach'](_0x2e4e60=>{var _0x32bee9=_0x2119c0;parseInt(_0x2e4e60[_0x32bee9(0xde)])<parseInt(_0x2e4e60['to_quantity'])&&_0x2338f5++;});if(_0x2338f5!=0x0)return _0x4d68d9['flash']('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x75c1de['redirect'](_0x2119c0(0xac));const _0x69564d=await warehouse['findOne']({'name':_0x59f93a['from_warehouse'],'room':_0x59f93a['from_room']});_0x59f93a[_0x2119c0(0xe9)][_0x2119c0(0xe3)](_0x2d4277=>{var _0x30e34e=_0x2119c0;if(_0x2d4277[_0x30e34e(0xca)]>0x0){const _0x3bede2=_0x69564d['product_details'][_0x30e34e(0x124)](_0x1d494b=>{var _0x54f3d3=_0x30e34e;_0x1d494b[_0x54f3d3(0x132)]==_0x2d4277[_0x54f3d3(0x132)]&&_0x1d494b[_0x54f3d3(0x91)]==_0x2d4277[_0x54f3d3(0xda)]&&(_0x1d494b[_0x54f3d3(0xf5)]=parseInt(_0x1d494b['product_stock'])+parseInt(_0x2d4277[_0x54f3d3(0xca)]));});}}),await _0x69564d[_0x2119c0(0x148)]();const _0x5d5d2b=await warehouse['findOne']({'name':_0x59f93a[_0x2119c0(0xcc)],'room':_0x59f93a[_0x2119c0(0xcd)]});_0x59f93a[_0x2119c0(0xe9)][_0x2119c0(0xe3)](_0x2ad4e0=>{var _0x5a2804=_0x2119c0;if(_0x2ad4e0[_0x5a2804(0xca)]>0x0){const _0x119064=_0x5d5d2b[_0x5a2804(0x130)]['map'](_0x463035=>{var _0x136961=_0x5a2804;_0x463035[_0x136961(0x132)]==_0x2ad4e0['product_name']&&_0x463035[_0x136961(0x91)]==_0x2ad4e0['to_bay']&&(_0x463035[_0x136961(0xf5)]=parseInt(_0x463035[_0x136961(0xf5)])-parseInt(_0x2ad4e0['to_quantity']));});}}),await _0x5d5d2b[_0x2119c0(0x148)](),_0x59f93a['date']=_0x3d25b0,_0x59f93a[_0x2119c0(0x10c)]=_0x463c80,_0x59f93a[_0x2119c0(0xcc)]=_0x3ae94c,_0x59f93a[_0x2119c0(0xe9)]=_0x170492,_0x59f93a['note']=_0x3604b6,_0x59f93a[_0x2119c0(0x10e)]=_0x46b71a;const _0x192bf6=await _0x59f93a[_0x2119c0(0x148)](),_0x5f07dd=await warehouse[_0x2119c0(0xa4)]({'name':_0x463c80,'room':_0x25ded1});_0x192bf6[_0x2119c0(0xe9)][_0x2119c0(0xe3)](_0x50afb8=>{var _0x234e18=_0x2119c0;if(_0x50afb8['to_quantity']>0x0){const _0x242cc6=_0x5f07dd[_0x234e18(0x130)][_0x234e18(0x124)](_0x319bbe=>{var _0x55b796=_0x234e18;_0x319bbe[_0x55b796(0x132)]==_0x50afb8[_0x55b796(0x132)]&&_0x319bbe['bay']==_0x50afb8[_0x55b796(0xda)]&&(_0x319bbe['product_stock']=parseInt(_0x319bbe[_0x55b796(0xf5)])-parseInt(_0x50afb8[_0x55b796(0xca)]));});}}),await _0x5f07dd[_0x2119c0(0x148)]();const _0x52bca1=await warehouse['findOne']({'name':_0x3ae94c,'room':_0x510d74});_0x192bf6[_0x2119c0(0xe9)][_0x2119c0(0xe3)](_0x1b4064=>{var _0x592dfe=_0x2119c0;if(_0x1b4064['to_quantity']>0x0){var _0x5ad470=0x0;const _0x273084=_0x52bca1[_0x592dfe(0x130)][_0x592dfe(0x124)](_0x4910bc=>{var _0x5402de=_0x592dfe;_0x4910bc[_0x5402de(0x132)]==_0x1b4064['product_name']&&_0x4910bc[_0x5402de(0x91)]==_0x1b4064[_0x5402de(0xf6)]&&(_0x4910bc[_0x5402de(0xf5)]=parseInt(_0x4910bc[_0x5402de(0xf5)])+parseInt(_0x1b4064[_0x5402de(0xca)]),_0x5ad470++);});_0x5ad470=='0'&&(_0x52bca1[_0x592dfe(0x130)]=_0x52bca1[_0x592dfe(0x130)][_0x592dfe(0xff)]({'product_name':_0x1b4064[_0x592dfe(0x132)],'product_stock':_0x1b4064[_0x592dfe(0xca)],'bay':_0x1b4064['to_bay'],'product_code':_0x1b4064[_0x592dfe(0x10b)],'primary_code':_0x1b4064[_0x592dfe(0x114)],'secondary_code':_0x1b4064['secondary_code'],'maxProducts':_0x1b4064[_0x592dfe(0x9e)]}));}}),await _0x52bca1[_0x2119c0(0x148)](),_0x4d68d9[_0x2119c0(0xdd)](_0x2119c0(0x98),_0x2119c0(0x13d)),_0x75c1de[_0x2119c0(0x9c)](_0x2119c0(0x123));}catch(_0x7456c5){console[_0x2119c0(0x10a)](_0x7456c5);}}),router['post'](a0_0x343579(0xe4),async(_0xc272ed,_0x4a8831)=>{var _0x44fb73=a0_0x343579;const {FromWareHouse:_0x4f96b6,FromRoom:_0x387fea,ToWarehouse:_0x440a21,ToRoom:_0x5e1ebd,primary_code:_0x36e714,Roomslist:_0xaa5e76}=_0xc272ed[_0x44fb73(0x9f)],_0x59d8c2=_0xaa5e76[_0x44fb73(0xd5)](','),_0x3cdf74=[];async function _0x336624(_0x508333){var _0x3c8223=_0x44fb73;const _0x35eae5=await warehouse[_0x3c8223(0x95)]([{'$match':{'name':_0x4f96b6,'room':_0x508333}},{'$unwind':_0x3c8223(0xd7)},{'$match':{'product_details.primary_code':_0x36e714}},{'$group':{'_id':_0x3c8223(0x11f),'name':{'$first':_0x3c8223(0xb3)},'instock':{'$first':_0x3c8223(0x80)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3c8223(0x14c)},'bay':{'$first':_0x3c8223(0xbf)},'level':{'$first':_0x3c8223(0xf2)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3c8223(0x93)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3c8223(0x112)},'rack':{'$first':_0x3c8223(0x87)},'expiry_date':{'$first':_0x3c8223(0x13f)},'production_date':{'$first':_0x3c8223(0xeb)},'batch_code':{'$first':_0x3c8223(0xae)},'maxPerUnit':{'$first':_0x3c8223(0xc7)},'roomNamed':{'$first':_0x3c8223(0x13a)},'prod_cat':{'$first':'P'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x5d3d73=await warehouse[_0x3c8223(0x95)]([{'$match':{'name':_0x4f96b6,'room':_0x508333}},{'$unwind':_0x3c8223(0xd7)},{'$match':{'product_details.secondary_code':_0x36e714}},{'$group':{'_id':_0x3c8223(0x11f),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x3c8223(0x80)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3c8223(0x14c)},'bay':{'$first':_0x3c8223(0xbf)},'level':{'$first':'$product_details.level'},'type':{'$first':_0x3c8223(0xb6)},'pallet':{'$first':_0x3c8223(0x93)},'unit':{'$first':_0x3c8223(0xc0)},'secondary_unit':{'$first':_0x3c8223(0x8b)},'storage':{'$first':_0x3c8223(0x112)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3c8223(0x13f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x3c8223(0xae)},'maxPerUnit':{'$first':_0x3c8223(0xc7)},'roomNamed':{'$first':_0x3c8223(0x13a)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x3c8223(0xe0)}}}]);if(_0x35eae5[_0x3c8223(0xbe)]>0x0)_0x3cdf74[_0x3c8223(0x139)](_0x35eae5);else _0x5d3d73[_0x3c8223(0xbe)]>0x0&&_0x3cdf74[_0x3c8223(0x139)](_0x5d3d73);}const _0xffe53=_0x59d8c2[_0x44fb73(0x124)](_0x10282f=>_0x336624(_0x10282f));await Promise['all'](_0xffe53),_0x4a8831['json'](_0x3cdf74);}),router[a0_0x343579(0x11c)](a0_0x343579(0x142),async(_0x2612a4,_0x4b6cb1)=>{var _0x496d5e=a0_0x343579;const {productCode:_0x555a80,bay:_0x237485,warehouses:_0x1a8732,room:_0x2ac990}=_0x2612a4[_0x496d5e(0x9f)];console[_0x496d5e(0x10a)](_0x2612a4[_0x496d5e(0x9f)]);try{const _0x2bb798=await warehouse[_0x496d5e(0x95)]([{'$match':{'name':_0x1a8732,'room':_0x2ac990}},{'$unwind':_0x496d5e(0xd7)},{'$match':{'product_details.bay':parseInt(_0x237485)}},{'$group':{'_id':_0x496d5e(0x11f),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x496d5e(0xbf)},'maxProducts':{'$first':_0x496d5e(0x129)}}}]);_0x4b6cb1[_0x496d5e(0x8c)](0xc8)[_0x496d5e(0x11e)](_0x2bb798);}catch(_0x5b945b){_0x4b6cb1['status'](0x194)['json']({'message':_0x5b945b[_0x496d5e(0x101)]});}}),module[a0_0x343579(0xf7)]=router;