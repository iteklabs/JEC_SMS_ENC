var a0_0x33e544=a0_0x2f61;(function(_0x25f51d,_0x2a358c){var _0x5a7a92=a0_0x2f61,_0xc98a12=_0x25f51d();while(!![]){try{var _0xfd8e00=-parseInt(_0x5a7a92(0x289))/0x1+-parseInt(_0x5a7a92(0x1f7))/0x2+-parseInt(_0x5a7a92(0x229))/0x3*(-parseInt(_0x5a7a92(0x227))/0x4)+-parseInt(_0x5a7a92(0x244))/0x5+-parseInt(_0x5a7a92(0x288))/0x6+parseInt(_0x5a7a92(0x26e))/0x7+parseInt(_0x5a7a92(0x24a))/0x8;if(_0xfd8e00===_0x2a358c)break;else _0xc98a12['push'](_0xc98a12['shift']());}catch(_0x18bf1a){_0xc98a12['push'](_0xc98a12['shift']());}}}(a0_0x59a5,0xb109a));const express=require(a0_0x33e544(0x25b)),app=express(),router=express[a0_0x33e544(0x26f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x33e544(0x1f5)),auth=require(a0_0x33e544(0x293)),users=require(a0_0x33e544(0x23d)),nodemailer=require('nodemailer');router['get'](a0_0x33e544(0x27d),auth,async(_0x344f10,_0x300a42)=>{var _0x2e2aea=a0_0x33e544;try{const {username:_0x4cf168,email:_0x34563b,role:_0x51bfa2}=_0x344f10[_0x2e2aea(0x271)],_0x293788=_0x344f10[_0x2e2aea(0x271)],_0x404f88=await profile['findOne']({'email':_0x293788[_0x2e2aea(0x21a)]}),_0x38780f=await master_shop[_0x2e2aea(0x235)]();let _0x22f13c;if(_0x293788[_0x2e2aea(0x204)]=='staff'){const _0x3f77fe=await staff[_0x2e2aea(0x2a6)]({'email':_0x293788['email']});_0x22f13c=await transfers_finished[_0x2e2aea(0x235)]({'from_warehouse':_0x3f77fe['warehouse']});}else _0x22f13c=await transfers_finished['aggregate']([{'$match':{'type_of_transaction':'own'}},{'$unwind':'$product'},{'$group':{'_id':_0x2e2aea(0x278),'invoice':{'$first':_0x2e2aea(0x243)},'date':{'$first':_0x2e2aea(0x241)},'from_warehouse':{'$first':_0x2e2aea(0x1fb)},'to_warehouse':{'$first':_0x2e2aea(0x298)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x2e2aea(0x22e)},'finalize':{'$first':_0x2e2aea(0x286)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x38780f[0x0][_0x2e2aea(0x208)]==_0x2e2aea(0x29a))var _0x15466f=users[_0x2e2aea(0x29b)];else{if(_0x38780f[0x0][_0x2e2aea(0x208)]==_0x2e2aea(0x217))var _0x15466f=users[_0x2e2aea(0x217)];else{if(_0x38780f[0x0][_0x2e2aea(0x208)]=='German')var _0x15466f=users[_0x2e2aea(0x247)];else{if(_0x38780f[0x0][_0x2e2aea(0x208)]==_0x2e2aea(0x207))var _0x15466f=users[_0x2e2aea(0x207)];else{if(_0x38780f[0x0][_0x2e2aea(0x208)]==_0x2e2aea(0x2b4))var _0x15466f=users[_0x2e2aea(0x2b4)];else{if(_0x38780f[0x0][_0x2e2aea(0x208)]==_0x2e2aea(0x2a7))var _0x15466f=users[_0x2e2aea(0x2a9)];else{if(_0x38780f[0x0][_0x2e2aea(0x208)]==_0x2e2aea(0x205))var _0x15466f=users[_0x2e2aea(0x205)];else{if(_0x38780f[0x0][_0x2e2aea(0x208)]==_0x2e2aea(0x2b3))var _0x15466f=users[_0x2e2aea(0x2b0)];}}}}}}}_0x300a42[_0x2e2aea(0x25d)](_0x2e2aea(0x28d),{'success':_0x344f10[_0x2e2aea(0x279)]('success'),'errors':_0x344f10['flash'](_0x2e2aea(0x260)),'role':_0x293788,'profile':_0x404f88,'master_shop':_0x38780f,'transfer':_0x22f13c,'language':_0x15466f});}catch(_0xc5ea91){console[_0x2e2aea(0x242)](_0xc5ea91);}}),router[a0_0x33e544(0x27e)](a0_0x33e544(0x21f),auth,async(_0x4ad31e,_0x133a6)=>{var _0x4a800b=a0_0x33e544;try{const {username:_0x5939e4,email:_0x1b9a4e,role:_0x3134d0}=_0x4ad31e['user'],_0x2c2c00=_0x4ad31e[_0x4a800b(0x271)],_0xaedffd=await profile[_0x4a800b(0x2a6)]({'email':_0x2c2c00[_0x4a800b(0x21a)]}),_0x187062=await master_shop[_0x4a800b(0x235)]();let _0x1e9ad2;if(_0x2c2c00[_0x4a800b(0x204)]=='staff'){const _0x4d3d3d=await staff['findOne']({'email':_0x2c2c00[_0x4a800b(0x21a)]});_0x1e9ad2=await transfers_finished[_0x4a800b(0x235)]({'from_warehouse':_0x4d3d3d['warehouse']});}else _0x1e9ad2=await transfers_finished[_0x4a800b(0x215)]([{'$match':{'type_of_transaction':_0x4a800b(0x21d)}},{'$unwind':_0x4a800b(0x2b1)},{'$group':{'_id':_0x4a800b(0x278),'invoice':{'$first':_0x4a800b(0x243)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x4a800b(0x1fb)},'to_warehouse':{'$first':_0x4a800b(0x298)},'from_room_name':{'$addToSet':_0x4a800b(0x2b8)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x4a800b(0x286)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x187062[0x0][_0x4a800b(0x208)]==_0x4a800b(0x29a))var _0x23fd10=users[_0x4a800b(0x29b)];else{if(_0x187062[0x0][_0x4a800b(0x208)]==_0x4a800b(0x217))var _0x23fd10=users[_0x4a800b(0x217)];else{if(_0x187062[0x0][_0x4a800b(0x208)]==_0x4a800b(0x247))var _0x23fd10=users[_0x4a800b(0x247)];else{if(_0x187062[0x0]['language']==_0x4a800b(0x207))var _0x23fd10=users['Spanish'];else{if(_0x187062[0x0]['language']==_0x4a800b(0x2b4))var _0x23fd10=users[_0x4a800b(0x2b4)];else{if(_0x187062[0x0][_0x4a800b(0x208)]==_0x4a800b(0x2a7))var _0x23fd10=users[_0x4a800b(0x2a9)];else{if(_0x187062[0x0]['language']==_0x4a800b(0x205))var _0x23fd10=users['Chinese'];else{if(_0x187062[0x0][_0x4a800b(0x208)]==_0x4a800b(0x2b3))var _0x23fd10=users[_0x4a800b(0x2b0)];}}}}}}}_0x133a6['render'](_0x4a800b(0x245),{'success':_0x4ad31e[_0x4a800b(0x279)]('success'),'errors':_0x4ad31e[_0x4a800b(0x279)](_0x4a800b(0x260)),'role':_0x2c2c00,'profile':_0xaedffd,'master_shop':_0x187062,'transfer':_0x1e9ad2,'language':_0x23fd10});}catch(_0x3a61b4){console[_0x4a800b(0x242)](_0x3a61b4);}});async function getRandom8DigitNumber(){var _0x728d00=a0_0x33e544;const _0x1cb066=0x989680,_0xe29146=0x5f5e0ff,_0x52c6d1=Math[_0x728d00(0x211)](Math[_0x728d00(0x27a)]()*(_0xe29146-_0x1cb066+0x1))+_0x1cb066;var _0x104b05;const _0x12feaf=await transfers_finished['findOne']({'invoice':_0x728d00(0x28a)+_0x52c6d1});return _0x12feaf&&_0x12feaf[_0x728d00(0x20e)]>0x0?_0x104b05=_0x728d00(0x28a)+_0x52c6d1:_0x104b05='TRFF-'+_0x52c6d1,_0x104b05;}router[a0_0x33e544(0x27e)](a0_0x33e544(0x22a),auth,async(_0x1a6c31,_0x1178f5)=>{var _0x143355=a0_0x33e544;try{const {username:_0x3eeceb,email:_0x4548dc,role:_0x1f920d}=_0x1a6c31['user'],_0x4245b2=_0x1a6c31[_0x143355(0x271)],_0x4ed3f4=await profile[_0x143355(0x2a6)]({'email':_0x4245b2[_0x143355(0x21a)]}),_0x3baffe=await master_shop['find']();let _0x2ca71b;if(_0x4245b2[_0x143355(0x204)]==_0x143355(0x261)){const _0xb35326=await staff['findOne']({'email':_0x4245b2['email']});_0x2ca71b=await warehouse[_0x143355(0x215)]([{'$match':{'status':_0x143355(0x2be),'name':_0xb35326[_0x143355(0x24f)]}},{'$group':{'_id':_0x143355(0x20a),'name':{'$first':_0x143355(0x20a)}}}]);}else _0x2ca71b=await warehouse[_0x143355(0x215)]([{'$match':{'status':_0x143355(0x2be)}},{'$group':{'_id':_0x143355(0x20a),'name':{'$first':_0x143355(0x20a)}}}]);const _0x4f5e59=await transfers_finished[_0x143355(0x235)]({}),_0x5762d8=_0x4f5e59['length']+0x1,_0x194667=_0x143355(0x28a)+_0x5762d8[_0x143355(0x23b)]()[_0x143355(0x277)](0x5,'0');if(_0x3baffe[0x0][_0x143355(0x208)]==_0x143355(0x29a))var _0xea1290=users[_0x143355(0x29b)];else{if(_0x3baffe[0x0]['language']=='Hindi')var _0xea1290=users[_0x143355(0x217)];else{if(_0x3baffe[0x0][_0x143355(0x208)]=='German')var _0xea1290=users['German'];else{if(_0x3baffe[0x0][_0x143355(0x208)]==_0x143355(0x207))var _0xea1290=users[_0x143355(0x207)];else{if(_0x3baffe[0x0]['language']==_0x143355(0x2b4))var _0xea1290=users[_0x143355(0x2b4)];else{if(_0x3baffe[0x0]['language']=='Portuguese\x20(BR)')var _0xea1290=users[_0x143355(0x2a9)];else{if(_0x3baffe[0x0]['language']==_0x143355(0x205))var _0xea1290=users['Chinese'];else{if(_0x3baffe[0x0]['language']==_0x143355(0x2b3))var _0xea1290=users[_0x143355(0x2b0)];}}}}}}}const _0x1ff701=getRandom8DigitNumber();_0x1ff701[_0x143355(0x202)](_0x1c43cc=>{var _0x163b14=_0x143355;_0x1178f5[_0x163b14(0x25d)]('add_transfer_finished',{'success':_0x1a6c31[_0x163b14(0x279)](_0x163b14(0x22b)),'errors':_0x1a6c31[_0x163b14(0x279)](_0x163b14(0x260)),'role':_0x4245b2,'profile':_0x4ed3f4,'master_shop':_0x3baffe,'warehouse':_0x2ca71b,'language':_0xea1290,'invoice':_0x1c43cc});})[_0x143355(0x250)](_0x3a8bbe=>{var _0x1791d1=_0x143355;_0x1a6c31[_0x1791d1(0x279)](_0x1791d1(0x260),_0x1791d1(0x274)),_0x1178f5[_0x1791d1(0x262)]('/transfer/view');});}catch(_0x17e7f0){console[_0x143355(0x242)](_0x17e7f0);}}),router[a0_0x33e544(0x27e)](a0_0x33e544(0x223),auth,async(_0x30d847,_0x4871b7)=>{var _0x501eb3=a0_0x33e544;try{const {username:_0x5cbc74,email:_0x345c0b,role:_0xd7e034}=_0x30d847[_0x501eb3(0x271)],_0x1ab125=_0x30d847[_0x501eb3(0x271)],_0x2820c7=await profile[_0x501eb3(0x2a6)]({'email':_0x1ab125[_0x501eb3(0x21a)]}),_0x16a343=await master_shop[_0x501eb3(0x235)]();let _0x548afc;if(_0x1ab125['role']==_0x501eb3(0x261)){const _0x160718=await staff[_0x501eb3(0x2a6)]({'email':_0x1ab125[_0x501eb3(0x21a)]});_0x548afc=await warehouse[_0x501eb3(0x215)]([{'$match':{'status':_0x501eb3(0x2be),'name':_0x160718[_0x501eb3(0x24f)]}},{'$group':{'_id':_0x501eb3(0x20a),'name':{'$first':_0x501eb3(0x20a)}}}]);}else _0x548afc=await warehouse['aggregate']([{'$match':{'status':_0x501eb3(0x2be)}},{'$group':{'_id':_0x501eb3(0x20a),'name':{'$first':_0x501eb3(0x20a)}}}]);const _0x32d07b=await transfers_finished[_0x501eb3(0x235)]({}),_0x14cbc4=_0x32d07b[_0x501eb3(0x20e)]+0x1,_0x216a79=_0x501eb3(0x28a)+_0x14cbc4['toString']()[_0x501eb3(0x277)](0x5,'0');if(_0x16a343[0x0][_0x501eb3(0x208)]=='English\x20(US)')var _0x4c1693=users['English'];else{if(_0x16a343[0x0]['language']==_0x501eb3(0x217))var _0x4c1693=users[_0x501eb3(0x217)];else{if(_0x16a343[0x0][_0x501eb3(0x208)]==_0x501eb3(0x247))var _0x4c1693=users['German'];else{if(_0x16a343[0x0][_0x501eb3(0x208)]==_0x501eb3(0x207))var _0x4c1693=users[_0x501eb3(0x207)];else{if(_0x16a343[0x0][_0x501eb3(0x208)]==_0x501eb3(0x2b4))var _0x4c1693=users[_0x501eb3(0x2b4)];else{if(_0x16a343[0x0][_0x501eb3(0x208)]==_0x501eb3(0x2a7))var _0x4c1693=users['Portuguese'];else{if(_0x16a343[0x0]['language']=='Chinese')var _0x4c1693=users[_0x501eb3(0x205)];else{if(_0x16a343[0x0][_0x501eb3(0x208)]==_0x501eb3(0x2b3))var _0x4c1693=users[_0x501eb3(0x2b0)];}}}}}}}const _0x197777=getRandom8DigitNumber();_0x197777['then'](_0x308c2f=>{var _0x49aff3=_0x501eb3;_0x4871b7[_0x49aff3(0x25d)](_0x49aff3(0x239),{'success':_0x30d847['flash'](_0x49aff3(0x22b)),'errors':_0x30d847[_0x49aff3(0x279)](_0x49aff3(0x260)),'role':_0x1ab125,'profile':_0x2820c7,'master_shop':_0x16a343,'warehouse':_0x548afc,'language':_0x4c1693,'invoice':_0x308c2f});})[_0x501eb3(0x250)](_0x10dbb8=>{var _0x5d35b3=_0x501eb3;_0x30d847[_0x5d35b3(0x279)]('errors',_0x5d35b3(0x274)),_0x4871b7[_0x5d35b3(0x262)](_0x5d35b3(0x20b));});}catch(_0x43a865){console[_0x501eb3(0x242)](_0x43a865);}}),router[a0_0x33e544(0x27e)](a0_0x33e544(0x238),auth,async(_0x1e6a5b,_0x51736c)=>{var _0x5e1111=a0_0x33e544;try{const {username:_0x273792,email:_0x2c2b06,role:_0x417073}=_0x1e6a5b[_0x5e1111(0x271)],_0x339ede=_0x1e6a5b[_0x5e1111(0x271)],_0x38571e=await profile[_0x5e1111(0x2a6)]({'email':_0x339ede['email']}),_0x1922a9=await master_shop[_0x5e1111(0x235)]();let _0x37e61e;if(_0x339ede['role']==_0x5e1111(0x261)){const _0x1900a8=await staff[_0x5e1111(0x2a6)]({'email':_0x339ede[_0x5e1111(0x21a)]});_0x37e61e=await warehouse[_0x5e1111(0x215)]([{'$match':{'status':'Enabled','name':_0x1900a8['warehouse']}},{'$group':{'_id':_0x5e1111(0x20a),'name':{'$first':_0x5e1111(0x20a)}}}]);}else _0x37e61e=await warehouse[_0x5e1111(0x215)]([{'$match':{'status':_0x5e1111(0x2be)}},{'$group':{'_id':_0x5e1111(0x20a),'name':{'$first':'$name'}}}]);const _0x273d16=await transfers_finished[_0x5e1111(0x235)]({}),_0x41d091=_0x273d16[_0x5e1111(0x20e)]+0x1,_0x267285=_0x5e1111(0x28a)+_0x41d091[_0x5e1111(0x23b)]()[_0x5e1111(0x277)](0x5,'0');if(_0x1922a9[0x0][_0x5e1111(0x208)]==_0x5e1111(0x29a))var _0x3658d9=users[_0x5e1111(0x29b)];else{if(_0x1922a9[0x0][_0x5e1111(0x208)]==_0x5e1111(0x217))var _0x3658d9=users[_0x5e1111(0x217)];else{if(_0x1922a9[0x0][_0x5e1111(0x208)]=='German')var _0x3658d9=users[_0x5e1111(0x247)];else{if(_0x1922a9[0x0]['language']=='Spanish')var _0x3658d9=users[_0x5e1111(0x207)];else{if(_0x1922a9[0x0]['language']=='French')var _0x3658d9=users['French'];else{if(_0x1922a9[0x0][_0x5e1111(0x208)]==_0x5e1111(0x2a7))var _0x3658d9=users['Portuguese'];else{if(_0x1922a9[0x0]['language']=='Chinese')var _0x3658d9=users[_0x5e1111(0x205)];else{if(_0x1922a9[0x0][_0x5e1111(0x208)]==_0x5e1111(0x2b3))var _0x3658d9=users['Arabic'];}}}}}}}const _0x11b686=getRandom8DigitNumber();_0x11b686[_0x5e1111(0x202)](_0x4a62ec=>{var _0x358a9f=_0x5e1111;_0x51736c[_0x358a9f(0x25d)](_0x358a9f(0x266),{'success':_0x1e6a5b[_0x358a9f(0x279)](_0x358a9f(0x22b)),'errors':_0x1e6a5b[_0x358a9f(0x279)](_0x358a9f(0x260)),'role':_0x339ede,'profile':_0x38571e,'master_shop':_0x1922a9,'warehouse':_0x37e61e,'language':_0x3658d9,'invoice':_0x4a62ec});})['catch'](_0x284a6d=>{var _0x46907a=_0x5e1111;_0x1e6a5b[_0x46907a(0x279)](_0x46907a(0x260),_0x46907a(0x274)),_0x51736c['redirect'](_0x46907a(0x20b));});}catch(_0x2f289f){console[_0x5e1111(0x242)](_0x2f289f);}}),router[a0_0x33e544(0x287)](a0_0x33e544(0x24c),auth,async(_0x135e66,_0x5210ea)=>{var _0x350195=a0_0x33e544;try{const {date:_0x43a68a,from_warehouse:_0x53c454,FromRoom_name:_0xae1cd4,to_warehouse:_0xee7942,ToRoom_name:_0x58806d,prod_name:_0x100f47,from_prod_qty:_0x57954c,from_prod_level:_0x1d9c4b,from_prod_isle:_0x4db3d7,from_prod_pallet:_0x11efa6,to_prod_qty:_0x478495,to_prod_level:_0x132bd2,to_prod_isle:_0x42aed2,to_prod_pallet:_0x392d4c,primary_code:_0x3f3dc2,secondary_code:_0x4bcd03,product_code3:_0x3a532b,note:_0xb3a0d0,MaxStocks_data2:_0x4100b1,invoice:_0x37b089,expiry_date:_0x10f4cf,PO_number:_0x1b82b6,ReqBy:_0x5497c5,dateofreq:_0x2f06f9,typeservicesData:_0x1d2a91,destination:_0x524a4a,deliverydate:_0x363c39,driver:_0x18432b,plate:_0x2898a4,van:_0x3f2e85,DRSI:_0x2361b7,typevehicle:_0x4b8a2d,TSU:_0xf7f8b4,TFU:_0x121cfe}=_0x135e66['body'];if(typeof _0x100f47==_0x350195(0x23f))var _0x21f172=[_0x135e66[_0x350195(0x24b)][_0x350195(0x291)]],_0x576c5d=[_0x135e66[_0x350195(0x24b)]['from_prod_qty']],_0x496aa1=[_0x135e66[_0x350195(0x24b)][_0x350195(0x237)]],_0x52b73f=[_0x135e66[_0x350195(0x24b)][_0x350195(0x2b5)]],_0x3a439c=[_0x135e66[_0x350195(0x24b)]['to_prod_level']],_0x365c97=[_0x135e66[_0x350195(0x24b)][_0x350195(0x27b)]],_0x299ace=[_0x135e66[_0x350195(0x24b)][_0x350195(0x268)]],_0x2ddb92=[_0x135e66['body'][_0x350195(0x23a)]],_0x2483ec=[_0x135e66['body'][_0x350195(0x269)]],_0x288c1c=[_0x135e66[_0x350195(0x24b)][_0x350195(0x270)]],_0x47963e=[_0x135e66['body'][_0x350195(0x23c)]],_0xc69ffe=[_0x135e66[_0x350195(0x24b)]['batch_code']],_0x1134ed=[_0x135e66[_0x350195(0x24b)][_0x350195(0x26b)]],_0x223ee3=[_0x135e66[_0x350195(0x24b)][_0x350195(0x257)]],_0x547741=[_0x135e66[_0x350195(0x24b)]['MaxStocks_data']],_0x431956=[_0x135e66['body'][_0x350195(0x23e)]],_0x282d5b=[_0x135e66['body'][_0x350195(0x264)]],_0x2fa9eb=[_0x135e66['body'][_0x350195(0x256)]],_0x274023=[_0x135e66[_0x350195(0x24b)]['ToRoomAssigned']],_0x278496=[_0x135e66[_0x350195(0x24b)][_0x350195(0x1ff)]],_0xab7076=[_0x135e66[_0x350195(0x24b)][_0x350195(0x296)]];else var _0x21f172=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x291)]],_0x576c5d=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x240)]],_0x496aa1=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x237)]],_0x52b73f=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x2b5)]],_0x3a439c=[..._0x135e66[_0x350195(0x24b)]['to_prod_level']],_0x365c97=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x27b)]],_0x299ace=[..._0x135e66['body'][_0x350195(0x268)]],_0x2ddb92=[..._0x135e66['body'][_0x350195(0x23a)]],_0x2483ec=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x269)]],_0x288c1c=[..._0x135e66[_0x350195(0x24b)]['primary_unit']],_0x47963e=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x23c)]],_0xc69ffe=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x281)]],_0x1134ed=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x26b)]],_0x223ee3=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x257)]],_0x547741=[..._0x135e66[_0x350195(0x24b)]['MaxStocks_data']],_0x431956=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x23e)]],_0x282d5b=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x264)]],_0x2fa9eb=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x256)]],_0x274023=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x2a5)]],_0x278496=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x1ff)]],_0xab7076=[..._0x135e66[_0x350195(0x24b)][_0x350195(0x296)]];const _0x19d72b=_0x21f172[_0x350195(0x249)](_0x1886d2=>{return _0x1886d2={'product_name':_0x1886d2};});_0x576c5d['forEach']((_0x2412b9,_0x4961a0)=>{_0x19d72b[_0x4961a0]['from_quantity']=_0x2412b9;}),_0x496aa1[_0x350195(0x27f)]((_0x13528c,_0x350f45)=>{var _0x51dd7d=_0x350195,_0x2d8b43=_0x13528c['match'](/[A-Za-z]+/)[0x0],_0x1c3de7=parseInt(_0x13528c[_0x51dd7d(0x28b)](/\d+/)[0x0]);_0x19d72b[_0x350f45][_0x51dd7d(0x2bc)]=_0x1c3de7,_0x19d72b[_0x350f45][_0x51dd7d(0x22f)]=_0x2d8b43;}),_0xab7076[_0x350195(0x27f)]((_0x5b1c83,_0xd19581)=>{var _0x2651ae=_0x350195;_0x19d72b[_0xd19581][_0x2651ae(0x296)]=_0x5b1c83;}),_0x278496[_0x350195(0x27f)]((_0x44787d,_0x82aa89)=>{var _0x1a1ee1=_0x350195;_0x19d72b[_0x82aa89][_0x1a1ee1(0x1ff)]=_0x44787d;}),_0x52b73f[_0x350195(0x27f)]((_0x369273,_0x221e39)=>{var _0x3ab098=_0x350195;_0x19d72b[_0x221e39][_0x3ab098(0x295)]=_0x369273;}),_0x3a439c[_0x350195(0x27f)]((_0x4a1a65,_0x5824d2)=>{var _0xacd2fc=_0x350195,_0x293ad5=_0x4a1a65[_0xacd2fc(0x28b)](/[A-Za-z]+/)[0x0],_0x17355e=parseInt(_0x4a1a65[_0xacd2fc(0x28b)](/\d+/)[0x0]);_0x19d72b[_0x5824d2]['to_level']=_0x293ad5,_0x19d72b[_0x5824d2][_0xacd2fc(0x22c)]=_0x17355e;}),_0x365c97[_0x350195(0x27f)]((_0x26debd,_0x5407c3)=>{var _0x368ea9=_0x350195;_0x19d72b[_0x5407c3][_0x368ea9(0x27b)]=_0x26debd;}),_0x299ace[_0x350195(0x27f)]((_0x607510,_0x443dec)=>{var _0x5c58c0=_0x350195;_0x19d72b[_0x443dec][_0x5c58c0(0x268)]=_0x607510;}),_0x2ddb92['forEach']((_0x14d439,_0x105b7d)=>{var _0x357def=_0x350195;_0x19d72b[_0x105b7d][_0x357def(0x2a2)]=_0x14d439;}),_0x2483ec[_0x350195(0x27f)]((_0x47cde3,_0x570ddd)=>{var _0x4e2e9f=_0x350195;_0x19d72b[_0x570ddd][_0x4e2e9f(0x284)]=_0x47cde3;}),_0x288c1c['forEach']((_0x17c6ff,_0x635ecb)=>{var _0x56d73e=_0x350195;_0x19d72b[_0x635ecb][_0x56d73e(0x209)]=_0x17c6ff;}),_0x47963e[_0x350195(0x27f)]((_0x3a7168,_0xbaa63e)=>{var _0x4184c4=_0x350195;_0x19d72b[_0xbaa63e][_0x4184c4(0x23c)]=_0x3a7168;}),_0xc69ffe[_0x350195(0x27f)]((_0xaa004b,_0x48d514)=>{var _0x423301=_0x350195;_0x19d72b[_0x48d514][_0x423301(0x281)]=_0xaa004b;}),_0x1134ed[_0x350195(0x27f)]((_0xabcc80,_0x98953a)=>{var _0x2a5d9e=_0x350195;_0x19d72b[_0x98953a][_0x2a5d9e(0x26b)]=_0xabcc80;}),_0x223ee3[_0x350195(0x27f)]((_0x531b9a,_0x1ae1c8)=>{var _0x49b582=_0x350195;_0x19d72b[_0x1ae1c8][_0x49b582(0x272)]=_0x531b9a;}),_0x547741['forEach']((_0x51dc85,_0x33739d)=>{var _0x1f3f3a=_0x350195;_0x19d72b[_0x33739d][_0x1f3f3a(0x284)]=_0x51dc85;}),_0x431956[_0x350195(0x27f)]((_0x250336,_0x10f8c1)=>{var _0x6cace7=_0x350195;_0x19d72b[_0x10f8c1][_0x6cace7(0x23e)]=_0x250336;}),_0x282d5b['forEach']((_0x3e63de,_0x2f1a0f)=>{var _0x758866=_0x350195;_0x19d72b[_0x2f1a0f][_0x758866(0x264)]=_0x3e63de;}),_0x2fa9eb['forEach']((_0x573d08,_0x3ddbc2)=>{_0x19d72b[_0x3ddbc2]['from_room_name']=_0x573d08;}),_0x274023[_0x350195(0x27f)]((_0x27592e,_0x1c0c99)=>{var _0x1a761f=_0x350195;_0x19d72b[_0x1c0c99][_0x1a761f(0x206)]=_0x27592e;});const _0x23e72d=_0x19d72b[_0x350195(0x2ad)](_0x6e1823=>_0x6e1823[_0x350195(0x295)]!=='0'&&_0x6e1823[_0x350195(0x295)]!==''||_0x6e1823[_0x350195(0x263)]!=='0'&&_0x6e1823[_0x350195(0x263)]!=='');var _0xfb70bc=0x0;_0x23e72d[_0x350195(0x27f)](_0x2eca0c=>{var _0x27baa4=_0x350195;parseInt(_0x2eca0c[_0x27baa4(0x26d)])<parseInt(_0x2eca0c['to_quantity'])&&_0xfb70bc++;});if(_0xfb70bc!=0x0)return _0x135e66[_0x350195(0x279)](_0x350195(0x260),_0x350195(0x299)),_0x5210ea[_0x350195(0x262)](_0x350195(0x222));const _0x4b7e57=new transfers_logs();await _0x4b7e57[_0x350195(0x2b7)]();for(let _0x2a492d=0x0;_0x2a492d<=_0x274023['length']-0x1;_0x2a492d++){_0x19d72b[_0x2a492d][_0x350195(0x26c)]=_0x350195(0x28e)+_0x4b7e57['invoice_init'][_0x350195(0x23b)]()[_0x350195(0x277)](0x8,'0');}const _0x2c9928=new transfers_finished({'date':_0x43a68a,'from_warehouse':_0x53c454,'to_warehouse':_0x53c454,'product':_0x23e72d,'note':_0xb3a0d0,'invoice':_0x350195(0x28e)+_0x4b7e57[_0x350195(0x290)]['toString']()['padStart'](0x8,'0'),'type_of_process':_0x350195(0x236),'type_of_transaction':_0x350195(0x21d),'PO_number':_0x1b82b6,'RequestedBy':_0x5497c5,'DateofRequest':_0x2f06f9,'typeservices':_0x1d2a91,'destination':_0x524a4a,'deliverydate':_0x363c39,'driver':_0x18432b,'plate':_0x2898a4,'van':_0x3f2e85,'DRSI':_0x2361b7,'typevehicle':_0x4b8a2d,'TSU':_0xf7f8b4,'TFU':_0x121cfe}),_0x7a886a=await _0x2c9928[_0x350195(0x2b7)]();_0x135e66[_0x350195(0x279)]('success','Product\x20Transfer\x20successfully'),_0x5210ea[_0x350195(0x262)](_0x350195(0x251)+_0x7a886a['_id']);}catch(_0x58dc40){console[_0x350195(0x242)](_0x58dc40),_0x5210ea['status'](0xc8)[_0x350195(0x226)]({'errorMessage':_0x58dc40[_0x350195(0x212)]});}}),router[a0_0x33e544(0x287)](a0_0x33e544(0x218),auth,async(_0x404567,_0x1d4d6b)=>{var _0xf3cf6d=a0_0x33e544;try{const {date:_0x326a0f,from_warehouse:_0x3a1868,FromRoom_name:_0x5acd6c,to_warehouse:_0x3e7b45,ToRoom_name:_0x573a19,prod_name:_0x4b3fea,from_prod_qty:_0x23049e,from_prod_level:_0x4ee25e,from_prod_isle:_0x2ef80d,from_prod_pallet:_0x1d656f,to_prod_qty:_0x481f22,to_prod_level:_0x2bd2be,to_prod_isle:_0x17144b,to_prod_pallet:_0x13e038,primary_code:_0x41e67d,secondary_code:_0x783da2,product_code3:_0x46ef49,note:_0x15dd08,MaxStocks_data2:_0x209184,invoice:_0x90db6a,expiry_date:_0x5cf5cc,PO_number_loc:_0x12cb2b,ReqBy_loc:_0x360950,dateofreq_loc:_0x2c01af,typeservices_loc_Data:_0xfcaa97,destination_loc:_0x66febe,deliverydate_loc:_0x4e8655,driver_loc:_0xc3b327,plate_loc:_0x573d8f,van_loc:_0x3efe0d,DRSI_loc:_0x37eaa0,typevehicle_loc:_0x196a13,TSU_loc:_0x4fc5dc,TFU_loc:_0x1ce732}=_0x404567[_0xf3cf6d(0x24b)];if(typeof _0x4b3fea==_0xf3cf6d(0x23f))var _0x4de47b=[_0x404567[_0xf3cf6d(0x24b)]['prod_name']],_0x5f2db7=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x240)]],_0x460d5d=[_0x404567[_0xf3cf6d(0x24b)]['from_prod_level2']],_0x481bed=[_0x404567['body'][_0xf3cf6d(0x2b5)]],_0x450621=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x27c)]],_0x25f547=[_0x404567[_0xf3cf6d(0x24b)]['primary_code']],_0x288c05=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x268)]],_0x67fb07=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x23a)]],_0x1791d7=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x269)]],_0x11c20f=[_0x404567['body'][_0xf3cf6d(0x270)]],_0xe351b0=[_0x404567['body'][_0xf3cf6d(0x23c)]],_0x2e603f=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x281)]],_0x3cf770=[_0x404567[_0xf3cf6d(0x24b)]['expiry_date']],_0x3bd27b=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x257)]],_0x34f500=[_0x404567['body'][_0xf3cf6d(0x2aa)]],_0x5e69f8=[_0x404567['body']['maxPerUnit']],_0x4a7b10=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x264)]],_0x54236=[_0x404567['body']['RoomAssigned']],_0x269ca3=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x2a5)]],_0x3d53b6=[_0x404567['body'][_0xf3cf6d(0x1ff)]],_0x3dad0c=[_0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x296)]];else var _0x4de47b=[..._0x404567[_0xf3cf6d(0x24b)]['prod_name']],_0x5f2db7=[..._0x404567['body']['from_prod_qty']],_0x460d5d=[..._0x404567['body']['from_prod_level2']],_0x481bed=[..._0x404567['body'][_0xf3cf6d(0x2b5)]],_0x450621=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x27c)]],_0x25f547=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x27b)]],_0x288c05=[..._0x404567['body'][_0xf3cf6d(0x268)]],_0x67fb07=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x23a)]],_0x1791d7=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x269)]],_0x11c20f=[..._0x404567[_0xf3cf6d(0x24b)]['primary_unit']],_0xe351b0=[..._0x404567['body']['secondary_unit']],_0x2e603f=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x281)]],_0x3cf770=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x26b)]],_0x3bd27b=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x257)]],_0x34f500=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x2aa)]],_0x5e69f8=[..._0x404567['body'][_0xf3cf6d(0x23e)]],_0x4a7b10=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x264)]],_0x54236=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x256)]],_0x269ca3=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x2a5)]],_0x3d53b6=[..._0x404567[_0xf3cf6d(0x24b)][_0xf3cf6d(0x1ff)]],_0x3dad0c=[..._0x404567['body']['id_transaction']];const _0x2d7ae5=_0x4de47b[_0xf3cf6d(0x249)](_0x248ab4=>{return _0x248ab4={'product_name':_0x248ab4};});_0x5f2db7[_0xf3cf6d(0x27f)]((_0x46be49,_0x4314e8)=>{var _0x3800a9=_0xf3cf6d;_0x2d7ae5[_0x4314e8][_0x3800a9(0x26d)]=_0x46be49;}),_0x460d5d[_0xf3cf6d(0x27f)]((_0x5388af,_0x395b65)=>{var _0x41db49=_0xf3cf6d,_0x3806f0=_0x5388af['match'](/[A-Za-z]+/)[0x0],_0x4a2d10=parseInt(_0x5388af[_0x41db49(0x28b)](/\d+/)[0x0]);_0x2d7ae5[_0x395b65][_0x41db49(0x2bc)]=_0x4a2d10,_0x2d7ae5[_0x395b65][_0x41db49(0x22f)]=_0x3806f0;}),_0x3dad0c[_0xf3cf6d(0x27f)]((_0x5603c4,_0x3528b6)=>{_0x2d7ae5[_0x3528b6]['id_transaction']=_0x5603c4;}),_0x3d53b6[_0xf3cf6d(0x27f)]((_0x3d52a9,_0x4a162a)=>{var _0x79b203=_0xf3cf6d;_0x2d7ae5[_0x4a162a][_0x79b203(0x1ff)]=_0x3d52a9;}),_0x481bed[_0xf3cf6d(0x27f)]((_0x3c0953,_0x247c21)=>{var _0x313bc6=_0xf3cf6d;_0x2d7ae5[_0x247c21][_0x313bc6(0x295)]=_0x3c0953;}),_0x450621[_0xf3cf6d(0x27f)]((_0x490fe0,_0x50f30a)=>{var _0x268d0c=_0xf3cf6d,_0x325d1e=_0x490fe0['match'](/[A-Za-z]+/)[0x0],_0x2f9e1a=parseInt(_0x490fe0[_0x268d0c(0x28b)](/\d+/)[0x0]);_0x2d7ae5[_0x50f30a][_0x268d0c(0x21b)]=_0x325d1e,_0x2d7ae5[_0x50f30a]['to_bay']=_0x2f9e1a;}),_0x25f547[_0xf3cf6d(0x27f)]((_0x31c6e1,_0x551243)=>{var _0x114fa4=_0xf3cf6d;_0x2d7ae5[_0x551243][_0x114fa4(0x27b)]=_0x31c6e1;}),_0x288c05[_0xf3cf6d(0x27f)]((_0x252fc6,_0x1f0bd5)=>{var _0x2c74bc=_0xf3cf6d;_0x2d7ae5[_0x1f0bd5][_0x2c74bc(0x268)]=_0x252fc6;}),_0x67fb07[_0xf3cf6d(0x27f)]((_0x47d7ed,_0x288114)=>{var _0x1110b0=_0xf3cf6d;_0x2d7ae5[_0x288114][_0x1110b0(0x2a2)]=_0x47d7ed;}),_0x1791d7[_0xf3cf6d(0x27f)]((_0x356dd1,_0x1ce0ac)=>{var _0x28f644=_0xf3cf6d;_0x2d7ae5[_0x1ce0ac][_0x28f644(0x284)]=_0x356dd1;}),_0x11c20f[_0xf3cf6d(0x27f)]((_0x17429e,_0x4c196e)=>{var _0xbfea13=_0xf3cf6d;_0x2d7ae5[_0x4c196e][_0xbfea13(0x209)]=_0x17429e;}),_0xe351b0[_0xf3cf6d(0x27f)]((_0x34f8a6,_0x3ce11c)=>{_0x2d7ae5[_0x3ce11c]['secondary_unit']=_0x34f8a6;}),_0x2e603f[_0xf3cf6d(0x27f)]((_0x17a596,_0x161c27)=>{var _0x16cfb4=_0xf3cf6d;_0x2d7ae5[_0x161c27][_0x16cfb4(0x281)]=_0x17a596;}),_0x3cf770[_0xf3cf6d(0x27f)]((_0x2bfc31,_0x38a7a6)=>{var _0x1fdb58=_0xf3cf6d;_0x2d7ae5[_0x38a7a6][_0x1fdb58(0x26b)]=_0x2bfc31;}),_0x3bd27b[_0xf3cf6d(0x27f)]((_0xa8f828,_0x7bf417)=>{var _0x16d15c=_0xf3cf6d;_0x2d7ae5[_0x7bf417][_0x16d15c(0x272)]=_0xa8f828;}),_0x34f500[_0xf3cf6d(0x27f)]((_0x52e09d,_0x51761d)=>{var _0x2b7b80=_0xf3cf6d;_0x2d7ae5[_0x51761d][_0x2b7b80(0x284)]=_0x52e09d;}),_0x5e69f8[_0xf3cf6d(0x27f)]((_0x44ab40,_0x1dafcf)=>{var _0x36ef59=_0xf3cf6d;_0x2d7ae5[_0x1dafcf][_0x36ef59(0x23e)]=_0x44ab40;}),_0x4a7b10[_0xf3cf6d(0x27f)]((_0x25d65c,_0x2f657a)=>{var _0x2da507=_0xf3cf6d;_0x2d7ae5[_0x2f657a][_0x2da507(0x264)]=_0x25d65c;}),_0x54236[_0xf3cf6d(0x27f)]((_0x39da16,_0x556c07)=>{var _0x2ed778=_0xf3cf6d;_0x2d7ae5[_0x556c07][_0x2ed778(0x282)]=_0x39da16;}),_0x269ca3[_0xf3cf6d(0x27f)]((_0x3eb8a8,_0x552dfa)=>{var _0xd7acf1=_0xf3cf6d;_0x2d7ae5[_0x552dfa][_0xd7acf1(0x206)]=_0x3eb8a8;});const _0x475ef7=_0x2d7ae5['filter'](_0x17e7cf=>_0x17e7cf[_0xf3cf6d(0x295)]!=='0'&&_0x17e7cf[_0xf3cf6d(0x295)]!==''||_0x17e7cf[_0xf3cf6d(0x263)]!=='0'&&_0x17e7cf[_0xf3cf6d(0x263)]!=='');var _0x5b71e7=0x0;_0x475ef7[_0xf3cf6d(0x27f)](_0x120063=>{var _0x5947bf=_0xf3cf6d;parseInt(_0x120063[_0x5947bf(0x26d)])<parseInt(_0x120063['to_quantity'])&&_0x5b71e7++;});if(_0x5b71e7!=0x0)return _0x404567[_0xf3cf6d(0x279)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x1d4d6b['redirect'](_0xf3cf6d(0x222));const _0x5ee33a=new transfers_logs();await _0x5ee33a[_0xf3cf6d(0x2b7)]();for(let _0x590b9b=0x0;_0x590b9b<=_0x269ca3[_0xf3cf6d(0x20e)]-0x1;_0x590b9b++){_0x2d7ae5[_0x590b9b][_0xf3cf6d(0x26c)]=_0xf3cf6d(0x28e)+_0x5ee33a[_0xf3cf6d(0x290)][_0xf3cf6d(0x23b)]()[_0xf3cf6d(0x277)](0x8,'0');}const _0x371bb4=new transfers_finished({'date':_0x326a0f,'from_warehouse':_0x3a1868,'to_warehouse':_0x3e7b45,'product':_0x475ef7,'note':_0x15dd08,'invoice':_0xf3cf6d(0x28e)+_0x5ee33a['invoice_init'][_0xf3cf6d(0x23b)]()[_0xf3cf6d(0x277)](0x8,'0'),'type_of_transaction':_0xf3cf6d(0x21d),'type_of_process':_0xf3cf6d(0x285),'PO_number':_0x12cb2b,'RequestedBy':_0x360950,'DateofRequest':_0x2c01af,'typeservices':_0xfcaa97,'destination':_0x66febe,'deliverydate':_0x4e8655,'driver':_0xc3b327,'plate':_0x573d8f,'van':_0x3efe0d,'DRSI':_0x37eaa0,'typevehicle':_0x196a13,'TSU':_0x4fc5dc,'TFU':_0x1ce732}),_0xa1f056=await _0x371bb4[_0xf3cf6d(0x2b7)]();_0x404567[_0xf3cf6d(0x279)](_0xf3cf6d(0x22b),_0xf3cf6d(0x26a)),_0x1d4d6b[_0xf3cf6d(0x262)](_0xf3cf6d(0x251)+_0xa1f056[_0xf3cf6d(0x248)]);}catch(_0x4b0349){console['log'](_0x4b0349),_0x1d4d6b[_0xf3cf6d(0x2ae)](0xc8)[_0xf3cf6d(0x226)]({'errorMessage':_0x4b0349[_0xf3cf6d(0x212)]});}}),router[a0_0x33e544(0x287)]('/view/add_transfer',auth,async(_0x4bf846,_0x40633d)=>{var _0x560759=a0_0x33e544;try{const {date:_0x2f0f72,from_warehouse:_0x27c27b,FromRoom_name:_0x34b86b,to_warehouse:_0x154940,ToRoom_name:_0x105d4a,prod_name:_0x1f3fc6,from_prod_qty:_0x3fbfa4,from_prod_level:_0x13c339,from_prod_isle:_0x4575ac,from_prod_pallet:_0x279ef7,to_prod_qty:_0x535b68,to_prod_level:_0x3122db,to_prod_isle:_0x1b04e6,to_prod_pallet:_0x5e43ee,primary_code:_0x37ade1,secondary_code:_0x42e530,product_code3:_0x5cfdca,note:_0x576928,MaxStocks_data2:_0x1ef771,invoice:_0x1d5e6f,expiry_date:_0x2b781f,PO_number:_0x56a42b,ReqBy:_0x58ea89,dateofreq:_0x49f8f2,typeservicesData:_0x450538,destination:_0x210ec0,deliverydate:_0x420180,driver:_0x4c29ff,plate:_0xfda9f1,van:_0x5ea3e3,DRSI:_0x45fecc,typevehicle:_0x46c6c4,TSU:_0x4360a5,TFU:_0x1f9261}=_0x4bf846[_0x560759(0x24b)];if(typeof _0x1f3fc6=='string')var _0x76823f=[_0x4bf846['body'][_0x560759(0x291)]],_0x835d4d=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x240)]],_0x66224=[_0x4bf846['body'][_0x560759(0x237)]],_0x459ab1=[_0x4bf846[_0x560759(0x24b)]['New_Qty_Converted']],_0x2c476f=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x27c)]],_0xdf673d=[_0x4bf846[_0x560759(0x24b)]['primary_code']],_0x5c6bc7=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x268)]],_0x5b04d3=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x23a)]],_0x2c9a61=[_0x4bf846[_0x560759(0x24b)]['MaxStocks_data2']],_0x2e7494=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x270)]],_0x39f53d=[_0x4bf846['body']['secondary_unit']],_0x33a58c=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x281)]],_0x5f200b=[_0x4bf846[_0x560759(0x24b)]['expiry_date']],_0x1ee817=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x257)]],_0x2e3719=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x2aa)]],_0x561724=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x23e)]],_0x4d2cbe=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x264)]],_0x327d1e=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x256)]],_0x30dc4b=[_0x4bf846[_0x560759(0x24b)][_0x560759(0x2a5)]],_0x390637=[_0x4bf846[_0x560759(0x24b)]['from_invoice']],_0x403279=[_0x4bf846['body'][_0x560759(0x296)]];else var _0x76823f=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x291)]],_0x835d4d=[..._0x4bf846['body'][_0x560759(0x240)]],_0x66224=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x237)]],_0x459ab1=[..._0x4bf846['body'][_0x560759(0x2b5)]],_0x2c476f=[..._0x4bf846['body']['to_prod_level']],_0xdf673d=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x27b)]],_0x5c6bc7=[..._0x4bf846[_0x560759(0x24b)]['secondary_code']],_0x5b04d3=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x23a)]],_0x2c9a61=[..._0x4bf846['body'][_0x560759(0x269)]],_0x2e7494=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x270)]],_0x39f53d=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x23c)]],_0x33a58c=[..._0x4bf846['body'][_0x560759(0x281)]],_0x5f200b=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x26b)]],_0x1ee817=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x257)]],_0x2e3719=[..._0x4bf846[_0x560759(0x24b)]['MaxStocks_data']],_0x561724=[..._0x4bf846[_0x560759(0x24b)]['maxPerUnit']],_0x4d2cbe=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x264)]],_0x327d1e=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x256)]],_0x30dc4b=[..._0x4bf846['body'][_0x560759(0x2a5)]],_0x390637=[..._0x4bf846[_0x560759(0x24b)][_0x560759(0x1ff)]],_0x403279=[..._0x4bf846['body']['id_transaction']];const _0x9710f7=_0x76823f[_0x560759(0x249)](_0x594f5e=>{return _0x594f5e={'product_name':_0x594f5e};});_0x835d4d[_0x560759(0x27f)]((_0x370439,_0xc4a06d)=>{var _0x2ef0b4=_0x560759;_0x9710f7[_0xc4a06d][_0x2ef0b4(0x26d)]=_0x370439;}),_0x66224[_0x560759(0x27f)]((_0x4b3a5c,_0xf676aa)=>{var _0x4d409c=_0x560759,_0x133e6e=_0x4b3a5c[_0x4d409c(0x28b)](/[A-Za-z]+/)[0x0],_0x330e70=parseInt(_0x4b3a5c['match'](/\d+/)[0x0]);_0x9710f7[_0xf676aa][_0x4d409c(0x2bc)]=_0x330e70,_0x9710f7[_0xf676aa][_0x4d409c(0x22f)]=_0x133e6e;}),_0x403279[_0x560759(0x27f)]((_0x49b482,_0x15dd55)=>{var _0x126b9e=_0x560759;_0x9710f7[_0x15dd55][_0x126b9e(0x296)]=_0x49b482;}),_0x390637[_0x560759(0x27f)]((_0x1efa7f,_0x28aecb)=>{var _0x47b3ee=_0x560759;_0x9710f7[_0x28aecb][_0x47b3ee(0x1ff)]=_0x1efa7f;}),_0x459ab1[_0x560759(0x27f)]((_0x1b8d3d,_0x138aaa)=>{_0x9710f7[_0x138aaa]['to_quantity']=_0x1b8d3d;}),_0x2c476f[_0x560759(0x27f)]((_0x5bfa14,_0x518a73)=>{var _0x58c471=_0x560759,_0xafd12c=_0x5bfa14[_0x58c471(0x28b)](/[A-Za-z]+/)[0x0],_0x50dc46=parseInt(_0x5bfa14[_0x58c471(0x28b)](/\d+/)[0x0]);_0x9710f7[_0x518a73]['to_level']=_0xafd12c,_0x9710f7[_0x518a73][_0x58c471(0x22c)]=_0x50dc46;}),_0xdf673d[_0x560759(0x27f)]((_0x1c431e,_0x11a286)=>{var _0x2d850a=_0x560759;_0x9710f7[_0x11a286][_0x2d850a(0x27b)]=_0x1c431e;}),_0x5c6bc7['forEach']((_0x39f620,_0x86b357)=>{var _0x2da082=_0x560759;_0x9710f7[_0x86b357][_0x2da082(0x268)]=_0x39f620;}),_0x5b04d3[_0x560759(0x27f)]((_0x4b3f44,_0x318c30)=>{var _0x3458cb=_0x560759;_0x9710f7[_0x318c30][_0x3458cb(0x2a2)]=_0x4b3f44;}),_0x2c9a61[_0x560759(0x27f)]((_0x3d0a03,_0x2cc7d5)=>{var _0x2d6718=_0x560759;_0x9710f7[_0x2cc7d5][_0x2d6718(0x284)]=_0x3d0a03;}),_0x2e7494[_0x560759(0x27f)]((_0x3c45e8,_0x5b3219)=>{var _0x3b3c26=_0x560759;_0x9710f7[_0x5b3219][_0x3b3c26(0x209)]=_0x3c45e8;}),_0x39f53d[_0x560759(0x27f)]((_0x2eab71,_0x54e077)=>{var _0x395a6a=_0x560759;_0x9710f7[_0x54e077][_0x395a6a(0x23c)]=_0x2eab71;}),_0x33a58c[_0x560759(0x27f)]((_0x2f4770,_0x38b97b)=>{var _0x11ea01=_0x560759;_0x9710f7[_0x38b97b][_0x11ea01(0x281)]=_0x2f4770;}),_0x5f200b[_0x560759(0x27f)]((_0x1783fc,_0x4923e0)=>{var _0x10a9bd=_0x560759;_0x9710f7[_0x4923e0][_0x10a9bd(0x26b)]=_0x1783fc;}),_0x1ee817[_0x560759(0x27f)]((_0xb2b8ab,_0x98bf8)=>{var _0x2f31a0=_0x560759;_0x9710f7[_0x98bf8][_0x2f31a0(0x272)]=_0xb2b8ab;}),_0x2e3719[_0x560759(0x27f)]((_0xd5678f,_0x350205)=>{var _0x523bbf=_0x560759;_0x9710f7[_0x350205][_0x523bbf(0x284)]=_0xd5678f;}),_0x561724['forEach']((_0x449ba4,_0x1475fc)=>{var _0x3ebbd0=_0x560759;_0x9710f7[_0x1475fc][_0x3ebbd0(0x23e)]=_0x449ba4;}),_0x4d2cbe[_0x560759(0x27f)]((_0x701b5,_0x17ef59)=>{var _0x183e20=_0x560759;_0x9710f7[_0x17ef59][_0x183e20(0x264)]=_0x701b5;}),_0x327d1e[_0x560759(0x27f)]((_0x226290,_0x5a39a)=>{var _0x333bd1=_0x560759;_0x9710f7[_0x5a39a][_0x333bd1(0x282)]=_0x226290;}),_0x30dc4b[_0x560759(0x27f)]((_0x1bd28f,_0x27e48c)=>{var _0x29fdc3=_0x560759;_0x9710f7[_0x27e48c][_0x29fdc3(0x206)]=_0x1bd28f;});const _0x5d3d5e=_0x9710f7[_0x560759(0x2ad)](_0x54694a=>_0x54694a['to_quantity']!=='0'&&_0x54694a['to_quantity']!==''||_0x54694a[_0x560759(0x263)]!=='0'&&_0x54694a[_0x560759(0x263)]!=='');var _0x55e47c=0x0;_0x5d3d5e['forEach'](_0x193dc2=>{var _0x138d1d=_0x560759;parseInt(_0x193dc2[_0x138d1d(0x26d)])<parseInt(_0x193dc2[_0x138d1d(0x295)])&&_0x55e47c++;});if(_0x55e47c!=0x0)return _0x4bf846[_0x560759(0x279)]('errors',_0x560759(0x299)),_0x40633d[_0x560759(0x262)](_0x560759(0x222));const _0x2ee2cf=new invoice_for_transfer();await _0x2ee2cf[_0x560759(0x2b7)]();for(let _0x29fb25=0x0;_0x29fb25<=_0x30dc4b[_0x560759(0x20e)]-0x1;_0x29fb25++){_0x9710f7[_0x29fb25][_0x560759(0x26c)]=_0x560759(0x276)+_0x2ee2cf[_0x560759(0x290)]['toString']()[_0x560759(0x277)](0x8,'0');}const _0x2ea7b1=new transfers_finished({'date':_0x2f0f72,'from_warehouse':_0x27c27b,'to_warehouse':_0x27c27b,'product':_0x5d3d5e,'note':_0x576928,'invoice':_0x560759(0x276)+_0x2ee2cf[_0x560759(0x290)][_0x560759(0x23b)]()['padStart'](0x8,'0'),'type_of_process':'bin2bin','type_of_transaction':_0x560759(0x252),'PO_number':_0x56a42b,'RequestedBy':_0x58ea89,'DateofRequest':_0x49f8f2,'typeservices':_0x450538,'destination':_0x210ec0,'deliverydate':_0x420180,'driver':_0x4c29ff,'plate':_0xfda9f1,'van':_0x5ea3e3,'DRSI':_0x45fecc,'typevehicle':_0x46c6c4,'TSU':_0x4360a5,'TFU':_0x1f9261}),_0x1d8a94=await _0x2ea7b1[_0x560759(0x2b7)]();_0x4bf846[_0x560759(0x279)](_0x560759(0x22b),_0x560759(0x26a)),_0x40633d[_0x560759(0x262)]('/transfer_finished/preview/'+_0x1d8a94[_0x560759(0x248)]);}catch(_0x4bb86a){console[_0x560759(0x242)](_0x4bb86a),_0x40633d['status'](0xc8)[_0x560759(0x226)]({'errorMessage':_0x4bb86a[_0x560759(0x212)]});}}),router['post']('/view/add_transfer_loc',auth,async(_0x329a48,_0x2d536c)=>{var _0x2bbe2d=a0_0x33e544;try{const {date:_0x3684c7,from_warehouse:_0xd5ebea,FromRoom_name:_0x1e4842,to_warehouse:_0x5e8af3,ToRoom_name:_0x53ddf7,prod_name:_0x5549a5,from_prod_qty:_0x371f18,from_prod_level:_0x34ddac,from_prod_isle:_0x2d1135,from_prod_pallet:_0x4c3d09,to_prod_qty:_0x2c2cb4,to_prod_level:_0x20c6a5,to_prod_isle:_0x2b96d8,to_prod_pallet:_0x1254b1,primary_code:_0x18b610,secondary_code:_0x2ca740,product_code3:_0x50fa46,note:_0x211700,MaxStocks_data2:_0x4260c4,invoice:_0x3636e4,expiry_date:_0x267301,PO_number_loc:_0x18cc5d,ReqBy_loc:_0x4d3ced,dateofreq_loc:_0x1e94e2,typeservices_loc_Data:_0x4af486,destination_loc:_0x55c79d,deliverydate_loc:_0x1fbcd7,driver_loc:_0x1f0b99,plate_loc:_0x5b8d18,van_loc:_0x27653a,DRSI_loc:_0x563350,typevehicle_loc:_0x4015fd,TSU_loc:_0x1507cc,TFU_loc:_0x3d9737}=_0x329a48[_0x2bbe2d(0x24b)];if(typeof _0x5549a5==_0x2bbe2d(0x23f))var _0x247f93=[_0x329a48['body'][_0x2bbe2d(0x291)]],_0x979d02=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x240)]],_0x231b28=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x237)]],_0x19706e=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x2b5)]],_0x79abfc=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x27c)]],_0x2d1289=[_0x329a48[_0x2bbe2d(0x24b)]['primary_code']],_0x459208=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x268)]],_0x3e4a39=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x23a)]],_0x5df320=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x269)]],_0x4555c4=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x270)]],_0x291d27=[_0x329a48[_0x2bbe2d(0x24b)]['secondary_unit']],_0x505577=[_0x329a48[_0x2bbe2d(0x24b)]['batch_code']],_0x21cf8d=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x26b)]],_0x2380cd=[_0x329a48['body']['product_date']],_0x4fbe5b=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x2aa)]],_0x12c57c=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x23e)]],_0x20f68a=[_0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x264)]],_0x2bca6f=[_0x329a48['body']['RoomAssigned']],_0x24aa0b=[_0x329a48['body'][_0x2bbe2d(0x2a5)]],_0x493302=[_0x329a48[_0x2bbe2d(0x24b)]['from_invoice']],_0x19b6fb=[_0x329a48[_0x2bbe2d(0x24b)]['id_transaction']];else var _0x247f93=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x291)]],_0x979d02=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x240)]],_0x231b28=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x237)]],_0x19706e=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x2b5)]],_0x79abfc=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x27c)]],_0x2d1289=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x27b)]],_0x459208=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x268)]],_0x3e4a39=[..._0x329a48['body']['product_code3']],_0x5df320=[..._0x329a48[_0x2bbe2d(0x24b)]['MaxStocks_data2']],_0x4555c4=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x270)]],_0x291d27=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x23c)]],_0x505577=[..._0x329a48['body']['batch_code']],_0x21cf8d=[..._0x329a48['body'][_0x2bbe2d(0x26b)]],_0x2380cd=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x257)]],_0x4fbe5b=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x2aa)]],_0x12c57c=[..._0x329a48[_0x2bbe2d(0x24b)]['maxPerUnit']],_0x20f68a=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x264)]],_0x2bca6f=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x256)]],_0x24aa0b=[..._0x329a48[_0x2bbe2d(0x24b)]['ToRoomAssigned']],_0x493302=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x1ff)]],_0x19b6fb=[..._0x329a48[_0x2bbe2d(0x24b)][_0x2bbe2d(0x296)]];const _0x2ea71e=_0x247f93[_0x2bbe2d(0x249)](_0x5d8fc1=>{return _0x5d8fc1={'product_name':_0x5d8fc1};});_0x979d02[_0x2bbe2d(0x27f)]((_0xdf9429,_0x35dc9e)=>{var _0x4d2308=_0x2bbe2d;_0x2ea71e[_0x35dc9e][_0x4d2308(0x26d)]=_0xdf9429;}),_0x231b28[_0x2bbe2d(0x27f)]((_0x462846,_0x12401d)=>{var _0x11726f=_0x2bbe2d,_0x3a1d4e=_0x462846[_0x11726f(0x28b)](/[A-Za-z]+/)[0x0],_0x24f956=parseInt(_0x462846[_0x11726f(0x28b)](/\d+/)[0x0]);_0x2ea71e[_0x12401d][_0x11726f(0x2bc)]=_0x24f956,_0x2ea71e[_0x12401d][_0x11726f(0x22f)]=_0x3a1d4e;}),_0x19b6fb['forEach']((_0x22dd54,_0x1ee34c)=>{var _0x562a74=_0x2bbe2d;_0x2ea71e[_0x1ee34c][_0x562a74(0x296)]=_0x22dd54;}),_0x493302['forEach']((_0x494289,_0x22fb85)=>{_0x2ea71e[_0x22fb85]['from_invoice']=_0x494289;}),_0x19706e['forEach']((_0x50e8a9,_0x33d76d)=>{var _0x25ca26=_0x2bbe2d;_0x2ea71e[_0x33d76d][_0x25ca26(0x295)]=_0x50e8a9;}),_0x79abfc[_0x2bbe2d(0x27f)]((_0x367d22,_0x570aa4)=>{var _0x984665=_0x2bbe2d,_0x416f6a=_0x367d22['match'](/[A-Za-z]+/)[0x0],_0x1629c3=parseInt(_0x367d22[_0x984665(0x28b)](/\d+/)[0x0]);_0x2ea71e[_0x570aa4][_0x984665(0x21b)]=_0x416f6a,_0x2ea71e[_0x570aa4][_0x984665(0x22c)]=_0x1629c3;}),_0x2d1289['forEach']((_0x5052a5,_0x2e69fc)=>{var _0x1cf8ec=_0x2bbe2d;_0x2ea71e[_0x2e69fc][_0x1cf8ec(0x27b)]=_0x5052a5;}),_0x459208[_0x2bbe2d(0x27f)]((_0x140763,_0x2aa69a)=>{var _0x161eac=_0x2bbe2d;_0x2ea71e[_0x2aa69a][_0x161eac(0x268)]=_0x140763;}),_0x3e4a39['forEach']((_0x5beee1,_0x1b2a5d)=>{var _0x39c321=_0x2bbe2d;_0x2ea71e[_0x1b2a5d][_0x39c321(0x2a2)]=_0x5beee1;}),_0x5df320['forEach']((_0x1287ae,_0x1c54e7)=>{_0x2ea71e[_0x1c54e7]['maxProducts']=_0x1287ae;}),_0x4555c4[_0x2bbe2d(0x27f)]((_0x5d458a,_0xf2dff2)=>{_0x2ea71e[_0xf2dff2]['unit']=_0x5d458a;}),_0x291d27[_0x2bbe2d(0x27f)]((_0x4abc5c,_0x3c94d7)=>{var _0x254b67=_0x2bbe2d;_0x2ea71e[_0x3c94d7][_0x254b67(0x23c)]=_0x4abc5c;}),_0x505577['forEach']((_0x4ca9db,_0x186a15)=>{_0x2ea71e[_0x186a15]['batch_code']=_0x4ca9db;}),_0x21cf8d['forEach']((_0x351afd,_0x4879ca)=>{var _0x583ffb=_0x2bbe2d;_0x2ea71e[_0x4879ca][_0x583ffb(0x26b)]=_0x351afd;}),_0x2380cd[_0x2bbe2d(0x27f)]((_0xa5cf94,_0x70c2a)=>{var _0x4a3048=_0x2bbe2d;_0x2ea71e[_0x70c2a][_0x4a3048(0x272)]=_0xa5cf94;}),_0x4fbe5b['forEach']((_0x593b87,_0x51de92)=>{_0x2ea71e[_0x51de92]['maxProducts']=_0x593b87;}),_0x12c57c[_0x2bbe2d(0x27f)]((_0x308dd0,_0x571e38)=>{var _0x4fb0d7=_0x2bbe2d;_0x2ea71e[_0x571e38][_0x4fb0d7(0x23e)]=_0x308dd0;}),_0x20f68a[_0x2bbe2d(0x27f)]((_0x50aa91,_0x23f7c4)=>{var _0x3d65e8=_0x2bbe2d;_0x2ea71e[_0x23f7c4][_0x3d65e8(0x264)]=_0x50aa91;}),_0x2bca6f[_0x2bbe2d(0x27f)]((_0x5c63f4,_0x51e9ce)=>{var _0x3a8656=_0x2bbe2d;_0x2ea71e[_0x51e9ce][_0x3a8656(0x282)]=_0x5c63f4;}),_0x24aa0b['forEach']((_0x62f7bb,_0x596f0f)=>{var _0x44d042=_0x2bbe2d;_0x2ea71e[_0x596f0f][_0x44d042(0x206)]=_0x62f7bb;});const _0x105883=_0x2ea71e['filter'](_0x485144=>_0x485144['to_quantity']!=='0'&&_0x485144[_0x2bbe2d(0x295)]!==''||_0x485144['to_floorlevel']!=='0'&&_0x485144[_0x2bbe2d(0x263)]!=='');var _0x4c91cc=0x0;_0x105883['forEach'](_0x80f7b2=>{var _0x3c8db3=_0x2bbe2d;parseInt(_0x80f7b2[_0x3c8db3(0x26d)])<parseInt(_0x80f7b2[_0x3c8db3(0x295)])&&_0x4c91cc++;});if(_0x4c91cc!=0x0)return _0x329a48[_0x2bbe2d(0x279)](_0x2bbe2d(0x260),_0x2bbe2d(0x299)),_0x2d536c[_0x2bbe2d(0x262)](_0x2bbe2d(0x222));const _0x3f89fd=new invoice_for_transfer();await _0x3f89fd['save']();for(let _0x3eafaf=0x0;_0x3eafaf<=_0x24aa0b[_0x2bbe2d(0x20e)]-0x1;_0x3eafaf++){_0x2ea71e[_0x3eafaf]['To_invoice']=_0x2bbe2d(0x276)+_0x3f89fd[_0x2bbe2d(0x290)]['toString']()[_0x2bbe2d(0x277)](0x8,'0');}const _0x25ef8e=new transfers_finished({'date':_0x3684c7,'from_warehouse':_0xd5ebea,'to_warehouse':_0x5e8af3,'product':_0x105883,'note':_0x211700,'invoice':_0x2bbe2d(0x276)+_0x3f89fd['invoice_init'][_0x2bbe2d(0x23b)]()[_0x2bbe2d(0x277)](0x8,'0'),'type_of_transaction':_0x2bbe2d(0x252),'type_of_process':_0x2bbe2d(0x285),'PO_number':_0x18cc5d,'RequestedBy':_0x4d3ced,'DateofRequest':_0x1e94e2,'typeservices':_0x4af486,'destination':_0x55c79d,'deliverydate':_0x1fbcd7,'driver':_0x1f0b99,'plate':_0x5b8d18,'van':_0x27653a,'DRSI':_0x563350,'typevehicle':_0x4015fd,'TSU':_0x1507cc,'TFU':_0x3d9737}),_0x226879=await _0x25ef8e[_0x2bbe2d(0x2b7)]();_0x329a48[_0x2bbe2d(0x279)](_0x2bbe2d(0x22b),_0x2bbe2d(0x26a)),_0x2d536c[_0x2bbe2d(0x262)](_0x2bbe2d(0x251)+_0x226879['_id']);}catch(_0x2a412e){console['log'](_0x2a412e),_0x2d536c[_0x2bbe2d(0x2ae)](0xc8)[_0x2bbe2d(0x226)]({'errorMessage':_0x2a412e[_0x2bbe2d(0x212)]});}}),router[a0_0x33e544(0x27e)](a0_0x33e544(0x231),auth,async(_0x62652b,_0x16ef38)=>{var _0x171c57=a0_0x33e544;try{const {username:_0x45c59c,email:_0x47b389,role:_0x4a5069}=_0x62652b['user'],_0x142654=_0x62652b['user'],_0x22db1a=await profile[_0x171c57(0x2a6)]({'email':_0x142654[_0x171c57(0x21a)]}),_0x2e452e=await master_shop['find'](),_0x48b54d=await transfers_finished[_0x171c57(0x21e)](_0x62652b[_0x171c57(0x219)]['id']);let _0x51784c;if(_0x142654['role']==_0x171c57(0x261)){const _0x5e4e51=await staff['findOne']({'email':_0x142654[_0x171c57(0x21a)]});_0x51784c=await warehouse[_0x171c57(0x235)]({'status':'Enabled','name':_0x5e4e51['warehouse'],'warehouse_category':_0x171c57(0x259)});}else _0x51784c=await warehouse[_0x171c57(0x235)]({'status':_0x171c57(0x2be),'warehouse_category':_0x171c57(0x259)});const _0x22dd9a=await warehouse['aggregate']([{'$match':{'name':_0x48b54d['from_warehouse'],'warehouse_category':_0x171c57(0x259)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x171c57(0x2bd),'name':{'$first':_0x171c57(0x228)},'product_stock':{'$first':_0x171c57(0x1f4)},'bay':{'$first':_0x171c57(0x1fa)},'bin':{'$first':_0x171c57(0x29f)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x171c57(0x2b6)},'secondary_code':{'$first':_0x171c57(0x253)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x171c57(0x28f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x171c57(0x232)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x171c57(0x258)},'warehoue_name':{'$first':_0x171c57(0x20a)}}}]),_0x5f057d=await product[_0x171c57(0x235)]({});if(_0x2e452e[0x0][_0x171c57(0x208)]==_0x171c57(0x29a)){var _0xccccca=users[_0x171c57(0x29b)];console[_0x171c57(0x242)](_0xccccca);}else{if(_0x2e452e[0x0][_0x171c57(0x208)]=='Hindi')var _0xccccca=users[_0x171c57(0x217)];else{if(_0x2e452e[0x0][_0x171c57(0x208)]==_0x171c57(0x247))var _0xccccca=users[_0x171c57(0x247)];else{if(_0x2e452e[0x0][_0x171c57(0x208)]==_0x171c57(0x207))var _0xccccca=users['Spanish'];else{if(_0x2e452e[0x0][_0x171c57(0x208)]=='French')var _0xccccca=users[_0x171c57(0x2b4)];else{if(_0x2e452e[0x0][_0x171c57(0x208)]=='Portuguese\x20(BR)')var _0xccccca=users[_0x171c57(0x2a9)];else{if(_0x2e452e[0x0][_0x171c57(0x208)]=='Chinese')var _0xccccca=users['Chinese'];else{if(_0x2e452e[0x0]['language']=='Arabic\x20(ae)')var _0xccccca=users['Arabic'];}}}}}}}_0x16ef38[_0x171c57(0x25d)](_0x171c57(0x214),{'success':_0x62652b['flash'](_0x171c57(0x22b)),'errors':_0x62652b[_0x171c57(0x279)](_0x171c57(0x260)),'role':_0x142654,'profile':_0x22db1a,'master_shop':_0x2e452e,'warehouse':_0x51784c,'transfer':_0x48b54d,'stock':_0x22dd9a,'unit':_0x5f057d,'language':_0xccccca});}catch(_0x5a327c){console[_0x171c57(0x242)](_0x5a327c);}}),router['post'](a0_0x33e544(0x231),auth,async(_0x41777b,_0x3165eb)=>{var _0x430df4=a0_0x33e544;try{const {invoice:_0x40cdf2,from_warehouse:_0x51c7cc,FromRoom_name:_0x1c28d9,to_warehouse:_0x5f69e1,ToRoom_name:_0x187312}=_0x41777b['body'],_0x34a27a=await transfers_finished[_0x430df4(0x21e)](_0x41777b[_0x430df4(0x219)]['id']),_0x1843c3=_0x34a27a[_0x430df4(0x20f)][_0x430df4(0x249)](async _0x1a1e2c=>{var _0x42b679=_0x430df4;if(_0x1a1e2c[_0x42b679(0x295)]>0x0){var _0x3b2c9c=await warehouse[_0x42b679(0x2a6)]({'name':_0x51c7cc,'room':_0x1a1e2c[_0x42b679(0x282)]});const _0x4d0b27=_0x3b2c9c[_0x42b679(0x25e)][_0x42b679(0x249)](_0x1ac54a=>{var _0xd2ae1d=_0x42b679;_0x1ac54a['_id']==_0x1a1e2c[_0xd2ae1d(0x296)]&&(_0x1ac54a[_0xd2ae1d(0x2ac)]=Math['max'](0x0,Math[_0xd2ae1d(0x2ba)](_0x1ac54a[_0xd2ae1d(0x2ac)])-Math[_0xd2ae1d(0x2ba)](_0x1a1e2c[_0xd2ae1d(0x295)])),console[_0xd2ae1d(0x242)](_0x1ac54a['product_stock']));});}return _0x3b2c9c;});Promise['all'](_0x1843c3)[_0x430df4(0x202)](async _0x5924ce=>{var _0x518282=_0x430df4;try{for(const _0x3d3206 of _0x5924ce){await _0x3d3206[_0x518282(0x2b7)]();}const _0x161036=_0x34a27a['product'][_0x518282(0x249)](async _0x105464=>{var _0x2ba317=_0x518282,_0x482a80=await warehouse['findOne']({'name':_0x5f69e1,'room':_0x105464['to_room_name']});if(_0x105464[_0x2ba317(0x295)]>0x0){var _0x2379a0=0x0;const _0x81bc20=_0x482a80[_0x2ba317(0x25e)][_0x2ba317(0x249)](_0x15bf8d=>{var _0x55c7c5=_0x2ba317;_0x15bf8d[_0x55c7c5(0x294)]==_0x105464[_0x55c7c5(0x294)]&&_0x15bf8d[_0x55c7c5(0x1f9)]==_0x105464[_0x55c7c5(0x22c)]&&_0x15bf8d[_0x55c7c5(0x26b)]==_0x105464['expiry_date']&&_0x15bf8d[_0x55c7c5(0x272)]==_0x105464[_0x55c7c5(0x272)]&&_0x15bf8d[_0x55c7c5(0x281)]==_0x105464[_0x55c7c5(0x281)]&&_0x15bf8d[_0x55c7c5(0x225)]==_0x105464[_0x55c7c5(0x26c)]&&(typeof _0x105464[_0x55c7c5(0x296)]=='undefined'?(console[_0x55c7c5(0x242)](_0x55c7c5(0x216),_0x15bf8d['product_stock']+_0x55c7c5(0x29c)+_0x15bf8d[_0x55c7c5(0x248)]+_0x55c7c5(0x1fe)+Math['abs'](_0x15bf8d[_0x55c7c5(0x2ac)])+Math['abs'](_0x105464[_0x55c7c5(0x295)])),_0x15bf8d[_0x55c7c5(0x2ac)]=Math['abs'](_0x15bf8d[_0x55c7c5(0x2ac)])+Math[_0x55c7c5(0x2ba)](_0x105464['to_quantity'])):_0x15bf8d[_0x55c7c5(0x2ac)]=Math['abs'](_0x15bf8d[_0x55c7c5(0x2ac)])+Math['abs'](_0x105464[_0x55c7c5(0x295)]),_0x2379a0++);});_0x2379a0=='0'&&(_0x482a80[_0x2ba317(0x25e)]=_0x482a80[_0x2ba317(0x25e)][_0x2ba317(0x21c)]({'product_name':_0x105464[_0x2ba317(0x294)],'product_stock':_0x105464[_0x2ba317(0x295)],'bay':_0x105464[_0x2ba317(0x22c)],'level':_0x105464['to_level'],'product_code':_0x105464[_0x2ba317(0x2a2)],'primary_code':_0x105464[_0x2ba317(0x27b)],'secondary_code':_0x105464[_0x2ba317(0x268)],'expiry_date':_0x105464['expiry_date'],'production_date':_0x105464[_0x2ba317(0x272)],'maxProducts':_0x105464['maxProducts'],'batch_code':_0x105464[_0x2ba317(0x281)],'secondary_unit':_0x105464[_0x2ba317(0x23c)],'unit':_0x105464[_0x2ba317(0x209)],'maxProducts':_0x105464[_0x2ba317(0x284)],'maxPerUnit':_0x105464['maxPerUnit'],'invoice':_0x105464['To_invoice']}));}return _0x482a80;});Promise['all'](_0x161036)[_0x518282(0x202)](async _0x3fdb01=>{var _0x418b70=_0x518282;try{console[_0x418b70(0x242)](_0x34a27a['type_of_process']);if(_0x34a27a[_0x418b70(0x20d)]!='location2location')for(const _0x485f98 of _0x3fdb01){await warehouse[_0x418b70(0x2b2)]({'_id':_0x485f98['_id']},{'$addToSet':{'product_details':{'$each':_0x485f98[_0x418b70(0x25e)]}}});}_0x34a27a[_0x418b70(0x224)]=_0x418b70(0x2a3);const _0x2d653d=await _0x34a27a[_0x418b70(0x2b7)](),_0x531396=await master_shop[_0x418b70(0x235)](),_0x2700ae=await email_settings[_0x418b70(0x2a6)](),_0x4cb549=await supervisor_settings[_0x418b70(0x235)]();var _0x5ae57b=_0x34a27a[_0x418b70(0x20f)],_0x19c06b='',_0x54622a;for(_0x54622a in _0x5ae57b){var _0x1bd6ca='FG';_0x34a27a[_0x418b70(0x213)]=='DRY\x20GOODS'&&(_0x1bd6ca='DG'),_0x19c06b+=_0x418b70(0x22d)+_0x418b70(0x273)+_0x5ae57b[_0x54622a][_0x418b70(0x294)]+_0x418b70(0x203)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5ae57b[_0x54622a]['product_code']+_0x418b70(0x203)+_0x418b70(0x273)+_0x5ae57b[_0x54622a]['to_quantity']+_0x418b70(0x203)+_0x418b70(0x273)+_0x5ae57b[_0x54622a][_0x418b70(0x209)]+_0x418b70(0x203)+_0x418b70(0x273)+_0x5ae57b[_0x54622a][_0x418b70(0x23c)]+_0x418b70(0x203)+_0x418b70(0x273)+_0x34a27a['to_warehouse']+_0x418b70(0x203)+_0x418b70(0x273)+_0x5ae57b[_0x54622a]['to_room_name']+_0x418b70(0x203)+_0x418b70(0x273)+_0x1bd6ca+_0x5ae57b[_0x54622a][_0x418b70(0x22c)]+_0x418b70(0x203)+_0x418b70(0x24d);}_0x41777b[_0x418b70(0x279)]('success',_0x418b70(0x25c)),_0x3165eb[_0x418b70(0x262)]('/picking_list/PDF_transfer/'+_0x2d653d[_0x418b70(0x248)]);}catch(_0x4e39b2){console[_0x418b70(0x29d)](_0x4e39b2),_0x3165eb[_0x418b70(0x2ae)](0x1f4)[_0x418b70(0x226)]({'error':_0x418b70(0x292)});}})[_0x518282(0x250)](_0x4e49ea=>{var _0x4d5a6c=_0x518282;console[_0x4d5a6c(0x29d)](_0x4e49ea),_0x3165eb[_0x4d5a6c(0x2ae)](0x1f4)[_0x4d5a6c(0x226)]({'error':_0x4d5a6c(0x267)});});}catch(_0x41b1db){console[_0x518282(0x29d)](_0x41b1db),_0x3165eb[_0x518282(0x2ae)](0x1f4)[_0x518282(0x226)]({'error':_0x518282(0x280)});}})[_0x430df4(0x250)](_0x5f5387=>{var _0x38bab8=_0x430df4;console[_0x38bab8(0x29d)](_0x5f5387),_0x3165eb[_0x38bab8(0x2ae)](0x1f4)['json']({'error':_0x38bab8(0x267)});});}catch(_0x429935){_0x3165eb[_0x430df4(0x226)]({'message':_0x429935[_0x430df4(0x212)]});}});function a0_0x2f61(_0x3983fa,_0x1bc491){var _0x59a584=a0_0x59a5();return a0_0x2f61=function(_0x2f618a,_0x4db035){_0x2f618a=_0x2f618a-0x1f4;var _0x9f7d6d=_0x59a584[_0x2f618a];return _0x9f7d6d;},a0_0x2f61(_0x3983fa,_0x1bc491);}function BayBinSelected(_0x4dba6e,_0x487657){var _0x3255f3=a0_0x33e544,_0x432c9b=[];let _0x5e918f=[];var _0x26d94c=[];if(_0x4dba6e==_0x3255f3(0x2af)){switch(_0x487657){case _0x3255f3(0x2b9):_0x432c9b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x432c9b=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x26d94c=['DG'];}else{if(_0x4dba6e=='FROZEN\x20GOODS'){switch(_0x487657){case _0x3255f3(0x2b9):_0x432c9b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x3255f3(0x2bb):_0x432c9b=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x26d94c=['FG'];}}return{'levels':_0x432c9b,'identify':_0x26d94c};}router[a0_0x33e544(0x27e)](a0_0x33e544(0x233),auth,async(_0xa029ab,_0x24430e)=>{var _0x28d596=a0_0x33e544;try{const {username:_0x46f378,email:_0x38d1ac,role:_0x4b2440}=_0xa029ab['user'],_0x317de6=_0xa029ab[_0x28d596(0x271)],_0x2be836=await profile[_0x28d596(0x2a6)]({'email':_0x317de6[_0x28d596(0x21a)]}),_0x1af3bb=await master_shop[_0x28d596(0x235)](),_0xa08697=await transfers_finished['findById'](_0xa029ab['params']['id']);let _0x47cafa=new Date(_0xa08697['expiry_date']),_0x2753d3=('0'+_0x47cafa[_0x28d596(0x1f6)]())[_0x28d596(0x201)](-0x2),_0x2e64d9=('0'+(_0x47cafa[_0x28d596(0x1f8)]()+0x1))['slice'](-0x2),_0x469747=_0x47cafa[_0x28d596(0x200)](),_0x1543ec=_0x469747+'-'+_0x2e64d9+'-'+_0x2753d3,_0x337450;if(_0x317de6[_0x28d596(0x204)]==_0x28d596(0x261)){const _0x3142e2=await staff[_0x28d596(0x2a6)]({'email':_0x317de6['email']});_0x337450=await warehouse[_0x28d596(0x235)]({'status':'Enabled','name':_0x3142e2[_0x28d596(0x24f)],'warehouse_category':_0x28d596(0x259)});}else _0x337450=await warehouse[_0x28d596(0x235)]({'status':_0x28d596(0x2be),'warehouse_category':_0x28d596(0x259)});const _0x3302b4=await warehouse[_0x28d596(0x215)]([{'$match':{'name':_0xa08697[_0x28d596(0x265)],'room':_0xa08697[_0x28d596(0x221)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x28d596(0x2bd),'name':{'$first':_0x28d596(0x228)},'product_stock':{'$first':_0x28d596(0x1f4)},'bay':{'$first':_0x28d596(0x1fa)},'bin':{'$first':_0x28d596(0x29f)},'type':{'$first':_0x28d596(0x20c)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x28d596(0x253)},'product_code':{'$first':_0x28d596(0x283)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x28d596(0x2a0)}}}]);var _0x1a63c2=[0x1,0x2,0x3,0x4],_0x5519bf=['A','B','C','D','E','F','G','H','I','J'],_0x52b12c=[_0x28d596(0x29e),_0x28d596(0x220)];const _0x3f541d=await product['find']({}),_0x5a5635=BayBinSelected(_0xa08697['to_warehouse'],_0xa08697[_0x28d596(0x234)]);if(_0x1af3bb[0x0][_0x28d596(0x208)]==_0x28d596(0x29a)){var _0x2152fb=users[_0x28d596(0x29b)];console[_0x28d596(0x242)](_0x2152fb);}else{if(_0x1af3bb[0x0][_0x28d596(0x208)]==_0x28d596(0x217))var _0x2152fb=users[_0x28d596(0x217)];else{if(_0x1af3bb[0x0]['language']==_0x28d596(0x247))var _0x2152fb=users['German'];else{if(_0x1af3bb[0x0][_0x28d596(0x208)]==_0x28d596(0x207))var _0x2152fb=users[_0x28d596(0x207)];else{if(_0x1af3bb[0x0][_0x28d596(0x208)]==_0x28d596(0x2b4))var _0x2152fb=users['French'];else{if(_0x1af3bb[0x0][_0x28d596(0x208)]==_0x28d596(0x2a7))var _0x2152fb=users[_0x28d596(0x2a9)];else{if(_0x1af3bb[0x0][_0x28d596(0x208)]==_0x28d596(0x205))var _0x2152fb=users[_0x28d596(0x205)];else{if(_0x1af3bb[0x0]['language']==_0x28d596(0x2b3))var _0x2152fb=users[_0x28d596(0x2b0)];}}}}}}}_0x24430e[_0x28d596(0x25d)]('edit_transfer_finished',{'success':_0xa029ab[_0x28d596(0x279)](_0x28d596(0x22b)),'errors':_0xa029ab[_0x28d596(0x279)](_0x28d596(0x260)),'role':_0x317de6,'profile':_0x2be836,'master_shop':_0x1af3bb,'warehouse':_0x337450,'transfer':_0xa08697,'stock':_0x3302b4,'unit':_0x3f541d,'language':_0x2152fb,'levels':_0x1a63c2,'Isle':_0x5519bf,'rooms_data':_0x52b12c,'ed_fullDate':_0x1543ec,'dataSelected':_0x5a5635});}catch(_0x1b5070){console[_0x28d596(0x242)](_0x1b5070);}}),router['post']('/view/:id',auth,async(_0x1f9891,_0x32901a)=>{var _0x22752e=a0_0x33e544;try{const _0x5d9b3f=_0x1f9891[_0x22752e(0x219)]['id'];console['log'](_0x1f9891[_0x22752e(0x24b)]);const _0x2d0cc7=await transfers_finished[_0x22752e(0x21e)](_0x5d9b3f);console['log'](_0x22752e(0x2ab),_0x2d0cc7);const {date:_0x344104,from_warehouse:_0x13cc35,FromRoom_name:_0x1696fa,to_warehouse:_0x43a850,ToRoom_name:_0x5d09e5,prod_name:_0x56d6aa,from_prod_qty:_0x31acbb,from_prod_level:_0x3b4774,from_prod_isle:_0x585d5c,from_prod_pallet:_0x58b26b,to_prod_qty:_0x30bffc,to_prod_level:_0x1ae15f,to_prod_isle:_0x368fa9,to_prod_pallet:_0x5bd8ae,primary_code:_0x21050b,secondary_code:_0x424378,product_code3:_0x3a9e74,note:_0x45899f,invoice:_0x1e51f3,expiry_date:_0x4d5046}=_0x1f9891[_0x22752e(0x24b)];if(typeof _0x56d6aa==_0x22752e(0x23f))var _0x6bebda=[_0x1f9891[_0x22752e(0x24b)][_0x22752e(0x291)]],_0x14b807=[_0x1f9891[_0x22752e(0x24b)][_0x22752e(0x240)]],_0xcedbc3=[_0x1f9891[_0x22752e(0x24b)][_0x22752e(0x230)]],_0x17178f=[_0x1f9891[_0x22752e(0x24b)][_0x22752e(0x210)]],_0x528ddc=[_0x1f9891['body']['to_prod_level']],_0x3c6350=[_0x1f9891[_0x22752e(0x24b)][_0x22752e(0x27b)]],_0x3f863a=[_0x1f9891['body'][_0x22752e(0x268)]],_0x15b580=[_0x1f9891[_0x22752e(0x24b)]['product_code3']],_0x2c5f6a=[_0x1f9891[_0x22752e(0x24b)][_0x22752e(0x269)]],_0x4bcd6f=[_0x1f9891[_0x22752e(0x24b)][_0x22752e(0x209)]],_0x52a83f=[_0x1f9891['body']['secondary_unit']],_0x451e8c=[_0x1f9891[_0x22752e(0x24b)]['batch_code']],_0x4498a3=[_0x1f9891['body'][_0x22752e(0x26b)]];else var _0x6bebda=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x291)]],_0x14b807=[..._0x1f9891[_0x22752e(0x24b)]['from_prod_qty']],_0xcedbc3=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x230)]],_0x17178f=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x210)]],_0x528ddc=[..._0x1f9891['body'][_0x22752e(0x27c)]],_0x3c6350=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x27b)]],_0x3f863a=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x268)]],_0x15b580=[..._0x1f9891['body'][_0x22752e(0x23a)]],_0x2c5f6a=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x269)]],_0x4bcd6f=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x209)]],_0x52a83f=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x23c)]],_0x451e8c=[..._0x1f9891[_0x22752e(0x24b)][_0x22752e(0x281)]],_0x4498a3=[..._0x1f9891[_0x22752e(0x24b)]['expiry_date']];const _0x4d591d=_0x6bebda[_0x22752e(0x249)](_0xf21033=>{return _0xf21033={'product_name':_0xf21033};});_0x14b807[_0x22752e(0x27f)]((_0x4a0b18,_0xaf166d)=>{_0x4d591d[_0xaf166d]['from_quantity']=_0x4a0b18;}),_0xcedbc3[_0x22752e(0x27f)]((_0x246018,_0xbd6c55)=>{var _0x3721a1=_0x22752e;_0x4d591d[_0xbd6c55][_0x3721a1(0x2bc)]=_0x246018;}),_0x17178f['forEach']((_0x46ffd6,_0x38c4fa)=>{var _0x3851a6=_0x22752e;_0x4d591d[_0x38c4fa][_0x3851a6(0x295)]=_0x46ffd6;}),_0x528ddc[_0x22752e(0x27f)]((_0x271d4a,_0x3f083d)=>{var _0x2c4330=_0x22752e;_0x4d591d[_0x3f083d][_0x2c4330(0x22c)]=_0x271d4a;}),_0x3c6350[_0x22752e(0x27f)]((_0x5e0739,_0x53c29c)=>{var _0x3e0c63=_0x22752e;_0x4d591d[_0x53c29c][_0x3e0c63(0x27b)]=_0x5e0739;}),_0x3f863a[_0x22752e(0x27f)]((_0x138406,_0x2e2ab9)=>{var _0x23400b=_0x22752e;_0x4d591d[_0x2e2ab9][_0x23400b(0x268)]=_0x138406;}),_0x15b580[_0x22752e(0x27f)]((_0x300ffe,_0x1009e1)=>{var _0x395271=_0x22752e;_0x4d591d[_0x1009e1][_0x395271(0x2a2)]=_0x300ffe;}),_0x2c5f6a['forEach']((_0x1258ab,_0x369ff7)=>{_0x4d591d[_0x369ff7]['maxProducts']=_0x1258ab;}),_0x4bcd6f[_0x22752e(0x27f)]((_0x957f89,_0x569ca5)=>{var _0x2909a7=_0x22752e;_0x4d591d[_0x569ca5][_0x2909a7(0x209)]=_0x957f89;}),_0x52a83f[_0x22752e(0x27f)]((_0x3fc041,_0x136e49)=>{var _0x27bc0e=_0x22752e;_0x4d591d[_0x136e49][_0x27bc0e(0x23c)]=_0x3fc041;}),_0x451e8c[_0x22752e(0x27f)]((_0x2b3983,_0x14cabb)=>{_0x4d591d[_0x14cabb]['batch_code']=_0x2b3983;}),_0x4498a3['forEach']((_0x515e8b,_0x2924ad)=>{var _0x1dcf7e=_0x22752e;_0x4d591d[_0x2924ad][_0x1dcf7e(0x26b)]=_0x515e8b;});const _0x274dc1=_0x4d591d[_0x22752e(0x2ad)](_0x3b1bb4=>_0x3b1bb4[_0x22752e(0x295)]!=='0'&&_0x3b1bb4[_0x22752e(0x295)]!==''||_0x3b1bb4[_0x22752e(0x263)]!=='0'&&_0x3b1bb4['to_floorlevel']!=='');var _0x133583=0x0;_0x274dc1[_0x22752e(0x27f)](_0x4c3506=>{var _0x11543c=_0x22752e;parseInt(_0x4c3506[_0x11543c(0x26d)])<parseInt(_0x4c3506[_0x11543c(0x295)])&&_0x133583++;});if(_0x133583!=0x0)return _0x1f9891[_0x22752e(0x279)](_0x22752e(0x260),_0x22752e(0x299)),_0x32901a['redirect'](_0x22752e(0x222));const _0x9e9fee=await warehouse[_0x22752e(0x2a6)]({'name':_0x2d0cc7[_0x22752e(0x265)],'room':_0x2d0cc7[_0x22752e(0x221)]});_0x2d0cc7[_0x22752e(0x20f)][_0x22752e(0x27f)](_0x4f758b=>{var _0x315ac7=_0x22752e;if(_0x4f758b[_0x315ac7(0x295)]>0x0){const _0x15426d=_0x9e9fee[_0x315ac7(0x25e)]['map'](_0x5c15c8=>{var _0x5bc93a=_0x315ac7;_0x5c15c8[_0x5bc93a(0x294)]==_0x4f758b[_0x5bc93a(0x294)]&&_0x5c15c8['bay']==_0x4f758b['from_bay']&&(_0x5c15c8[_0x5bc93a(0x2ac)]=parseInt(_0x5c15c8[_0x5bc93a(0x2ac)])+parseInt(_0x4f758b[_0x5bc93a(0x295)]));});}}),await _0x9e9fee[_0x22752e(0x2b7)]();const _0x433a06=await warehouse['findOne']({'name':_0x2d0cc7[_0x22752e(0x213)],'room':_0x2d0cc7[_0x22752e(0x234)]});_0x2d0cc7[_0x22752e(0x20f)]['forEach'](_0x511ffc=>{var _0x5b7401=_0x22752e;if(_0x511ffc[_0x5b7401(0x295)]>0x0){const _0x3d5add=_0x433a06[_0x5b7401(0x25e)]['map'](_0xb93ebc=>{var _0x2a7b42=_0x5b7401;_0xb93ebc['product_name']==_0x511ffc[_0x2a7b42(0x294)]&&_0xb93ebc[_0x2a7b42(0x1f9)]==_0x511ffc[_0x2a7b42(0x22c)]&&(_0xb93ebc[_0x2a7b42(0x2ac)]=parseInt(_0xb93ebc[_0x2a7b42(0x2ac)])-parseInt(_0x511ffc[_0x2a7b42(0x295)]));});}}),await _0x433a06[_0x22752e(0x2b7)](),_0x2d0cc7[_0x22752e(0x254)]=_0x344104,_0x2d0cc7['from_warehouse']=_0x13cc35,_0x2d0cc7[_0x22752e(0x213)]=_0x43a850,_0x2d0cc7[_0x22752e(0x20f)]=_0x274dc1,_0x2d0cc7['note']=_0x45899f,_0x2d0cc7[_0x22752e(0x225)]=_0x1e51f3;const _0x5ce383=await _0x2d0cc7[_0x22752e(0x2b7)](),_0x3290b2=await warehouse[_0x22752e(0x2a6)]({'name':_0x13cc35,'room':_0x1696fa});_0x5ce383['product'][_0x22752e(0x27f)](_0x329f9c=>{var _0x20ad2c=_0x22752e;if(_0x329f9c[_0x20ad2c(0x295)]>0x0){const _0x5653d2=_0x3290b2[_0x20ad2c(0x25e)][_0x20ad2c(0x249)](_0x592d57=>{var _0x5a66c4=_0x20ad2c;_0x592d57[_0x5a66c4(0x294)]==_0x329f9c['product_name']&&_0x592d57[_0x5a66c4(0x1f9)]==_0x329f9c[_0x5a66c4(0x2bc)]&&(_0x592d57[_0x5a66c4(0x2ac)]=parseInt(_0x592d57['product_stock'])-parseInt(_0x329f9c[_0x5a66c4(0x295)]));});}}),await _0x3290b2[_0x22752e(0x2b7)]();const _0xd670e=await warehouse['findOne']({'name':_0x43a850,'room':_0x5d09e5});_0x5ce383[_0x22752e(0x20f)][_0x22752e(0x27f)](_0xc4c3=>{var _0xd33adc=_0x22752e;if(_0xc4c3[_0xd33adc(0x295)]>0x0){var _0x25d644=0x0;const _0x5a41c5=_0xd670e[_0xd33adc(0x25e)][_0xd33adc(0x249)](_0x54073d=>{var _0x2f1397=_0xd33adc;_0x54073d['product_name']==_0xc4c3[_0x2f1397(0x294)]&&_0x54073d[_0x2f1397(0x1f9)]==_0xc4c3[_0x2f1397(0x22c)]&&(_0x54073d['product_stock']=parseInt(_0x54073d[_0x2f1397(0x2ac)])+parseInt(_0xc4c3[_0x2f1397(0x295)]),_0x25d644++);});_0x25d644=='0'&&(_0xd670e[_0xd33adc(0x25e)]=_0xd670e[_0xd33adc(0x25e)]['concat']({'product_name':_0xc4c3['product_name'],'product_stock':_0xc4c3['to_quantity'],'bay':_0xc4c3[_0xd33adc(0x22c)],'product_code':_0xc4c3['product_code'],'primary_code':_0xc4c3[_0xd33adc(0x27b)],'secondary_code':_0xc4c3[_0xd33adc(0x268)],'maxProducts':_0xc4c3[_0xd33adc(0x284)]}));}}),await _0xd670e[_0x22752e(0x2b7)](),_0x1f9891['flash']('success',_0x22752e(0x1fc)),_0x32901a['redirect']('/transfer_finished/view');}catch(_0x2c57ed){console[_0x22752e(0x242)](_0x2c57ed);}}),router[a0_0x33e544(0x287)]('/barcode_scanner',async(_0x5e3abf,_0xec1785)=>{var _0x413827=a0_0x33e544;const {FromWareHouse:_0x52ca5b,FromRoom:_0x12e0d8,ToWarehouse:_0x3ac160,ToRoom:_0x49d35f,primary_code:_0xfa8f07,Roomslist:_0x41e225}=_0x5e3abf[_0x413827(0x24b)],_0x373c65=_0x41e225[_0x413827(0x2a4)](','),_0x4a449=[];async function _0x1b87b7(_0x93fe38){var _0x38fea3=_0x413827;const _0x2aa0a8=await warehouse[_0x38fea3(0x215)]([{'$match':{'name':_0x52ca5b,'room':_0x93fe38}},{'$unwind':_0x38fea3(0x275)},{'$match':{'product_details.primary_code':_0xfa8f07}},{'$group':{'_id':_0x38fea3(0x2bd),'name':{'$first':_0x38fea3(0x228)},'instock':{'$first':_0x38fea3(0x1f4)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x38fea3(0x253)},'product_code':{'$first':_0x38fea3(0x283)},'bay':{'$first':'$product_details.bay'},'level':{'$first':_0x38fea3(0x255)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x38fea3(0x1fd)},'secondary_unit':{'$first':_0x38fea3(0x2a1)},'storage':{'$first':_0x38fea3(0x28f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x38fea3(0x232)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x38fea3(0x2a8)},'maxPerUnit':{'$first':_0x38fea3(0x28c)},'roomNamed':{'$first':_0x38fea3(0x258)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x38fea3(0x25a)}}}]),_0x4e180a=await warehouse['aggregate']([{'$match':{'name':_0x52ca5b,'room':_0x93fe38}},{'$unwind':_0x38fea3(0x275)},{'$match':{'product_details.secondary_code':_0xfa8f07}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x38fea3(0x1f4)},'primary_code':{'$first':_0x38fea3(0x2b6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x38fea3(0x283)},'bay':{'$first':_0x38fea3(0x1fa)},'level':{'$first':_0x38fea3(0x255)},'type':{'$first':_0x38fea3(0x20c)},'pallet':{'$first':_0x38fea3(0x25f)},'unit':{'$first':_0x38fea3(0x1fd)},'secondary_unit':{'$first':_0x38fea3(0x2a1)},'storage':{'$first':_0x38fea3(0x28f)},'rack':{'$first':_0x38fea3(0x2a0)},'expiry_date':{'$first':_0x38fea3(0x232)},'production_date':{'$first':_0x38fea3(0x24e)},'batch_code':{'$first':_0x38fea3(0x2a8)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x38fea3(0x258)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x38fea3(0x25a)}}}]);if(_0x2aa0a8['length']>0x0)_0x4a449[_0x38fea3(0x246)](_0x2aa0a8);else _0x4e180a[_0x38fea3(0x20e)]>0x0&&_0x4a449['push'](_0x4e180a);}const _0x50f167=_0x373c65[_0x413827(0x249)](_0x15d964=>_0x1b87b7(_0x15d964));await Promise['all'](_0x50f167),_0xec1785[_0x413827(0x226)](_0x4a449);}),router[a0_0x33e544(0x287)]('/CheckingWarehouse',async(_0x72e5c2,_0x13541b)=>{var _0x3ebd99=a0_0x33e544;const {productCode:_0x10fd5a,bay:_0x4f020e,warehouses:_0x19aadf,room:_0x22e9dc}=_0x72e5c2[_0x3ebd99(0x24b)];console['log'](_0x72e5c2[_0x3ebd99(0x24b)]);try{const _0x1aae7d=await warehouse[_0x3ebd99(0x215)]([{'$match':{'name':_0x19aadf,'room':_0x22e9dc}},{'$unwind':_0x3ebd99(0x275)},{'$match':{'product_details.bay':parseInt(_0x4f020e)}},{'$group':{'_id':_0x3ebd99(0x2bd),'name':{'$first':_0x3ebd99(0x228)},'product_stock':{'$first':_0x3ebd99(0x1f4)},'bay':{'$first':_0x3ebd99(0x1fa)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x13541b[_0x3ebd99(0x2ae)](0xc8)[_0x3ebd99(0x226)](_0x1aae7d);}catch(_0x55b18c){_0x13541b[_0x3ebd99(0x2ae)](0x194)[_0x3ebd99(0x226)]({'message':_0x55b18c[_0x3ebd99(0x212)]});}}),module[a0_0x33e544(0x297)]=router;function a0_0x59a5(){var _0x18ee99=['from_room_name','$product_details.product_code','maxProducts','location2location','$finalize','post','692004rXzkSI','1141015mLVKbQ','TRFF-','match','$product_details.maxPerUnit','transfer_finished','LOG-TRF-','$product_details.storage','invoice_init','prod_name','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','../middleware/auth','product_name','to_quantity','id_transaction','exports','$to_warehouse','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','English\x20(US)','English','\x20<>\x20','error','Ambient','$product_details.bin','$product_details.rack','$product_details.secondary_unit','product_code','True','split','ToRoomAssigned','findOne','Portuguese\x20(BR)','$product_details.batch_code','Portuguese','MaxStocks_data','transfer_data','product_stock','filter','status','DRY\x20GOODS','Arabic','$product','updateOne','Arabic\x20(ae)','French','New_Qty_Converted','$product_details.primary_code','save','$product.from_room_name','Rack\x201','abs','Rack\x202','from_bay','$product_details._id','Enabled','$product_details.product_stock','../models/all_models','getDate','1999212pXGAxj','getMonth','bay','$product_details.bay','$from_warehouse','Transfer\x20Edit\x20Successfully','$product_details.unit','\x20<=>\x20','from_invoice','getFullYear','slice','then','</td>','role','Chinese','to_room_name','Spanish','language','unit','$name','/transfer/view','$product_details.type','type_of_process','length','product','to_prod_qty','floor','message','to_warehouse','edit_transfer_finished_view','aggregate','here2','Hindi','/view/addlog','params','email','to_level','concat','logs','findById','/view_logs','Enclosed','from_room','back','/view/choose','finalize','invoice','json','2060XgEYPQ','$product_details.product_name','3123PKCAle','/view/add_transfer','success','to_bay','<tr>','$product.to_room_name','from_level','from_prod_level','/preview/:id','$product_details.expiry_date','/view/:id','to_room','find','bin2bin','from_prod_level2','/view/choose_logs','choos_transfer','product_code3','toString','secondary_unit','../public/language/languages.json','maxPerUnit','string','from_prod_qty','$date','log','$invoice','5833825iqomlx','transfer_finished_logs','push','German','_id','map','25529368XSfafF','body','/view/add_transfer_logs','</tr>','$product_details.production_date','warehouse','catch','/transfer_finished/preview/','own','$product_details.secondary_code','date','$product_details.level','RoomAssigned','product_date','$room','Finished\x20Goods','$product_details.invoice','express','Transfer\x20Finalize\x20Successfully','render','product_details','$product_details.floorlevel','errors','staff','redirect','to_floorlevel','prod_cat','from_warehouse','choos_transfer_logs','An\x20error\x20occurred.','secondary_code','MaxStocks_data2','Product\x20Transfer\x20successfully','expiry_date','To_invoice','from_quantity','2944060BcBQJx','Router','primary_unit','user','production_date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details','TRF-','padStart','$_id','flash','random','primary_code','to_prod_level','/view','get','forEach','An\x20error\x20occurred\x20while\x20saving\x20data.','batch_code'];a0_0x59a5=function(){return _0x18ee99;};return a0_0x59a5();}