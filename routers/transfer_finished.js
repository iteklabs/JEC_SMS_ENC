var a0_0x2e50f0=a0_0x4054;(function(_0x453acc,_0x298e8a){var _0x2a1972=a0_0x4054,_0x33950b=_0x453acc();while(!![]){try{var _0x251d09=parseInt(_0x2a1972(0x138))/0x1+parseInt(_0x2a1972(0x16a))/0x2+-parseInt(_0x2a1972(0x1cc))/0x3*(parseInt(_0x2a1972(0x165))/0x4)+-parseInt(_0x2a1972(0x1f0))/0x5*(-parseInt(_0x2a1972(0x191))/0x6)+-parseInt(_0x2a1972(0x18a))/0x7*(-parseInt(_0x2a1972(0x1da))/0x8)+-parseInt(_0x2a1972(0x18e))/0x9+parseInt(_0x2a1972(0x18f))/0xa*(-parseInt(_0x2a1972(0x1d5))/0xb);if(_0x251d09===_0x298e8a)break;else _0x33950b['push'](_0x33950b['shift']());}catch(_0x35c870){_0x33950b['push'](_0x33950b['shift']());}}}(a0_0x371d,0xcb28e));const express=require(a0_0x2e50f0(0x196)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,invoice_for_transfer,transfers_logs}=require(a0_0x2e50f0(0x1dd)),auth=require(a0_0x2e50f0(0x16f)),users=require(a0_0x2e50f0(0x176)),nodemailer=require(a0_0x2e50f0(0x1bf));router[a0_0x2e50f0(0x19d)]('/view',auth,async(_0x1c235f,_0x114a2f)=>{var _0x372e7d=a0_0x2e50f0;try{const {username:_0x5968e6,email:_0x2b0d79,role:_0x3153dc}=_0x1c235f[_0x372e7d(0x14e)],_0x1c883d=_0x1c235f[_0x372e7d(0x14e)],_0x2c1093=await profile[_0x372e7d(0x137)]({'email':_0x1c883d['email']}),_0x576359=await master_shop['find']();let _0x4808f7;if(_0x1c883d[_0x372e7d(0x1d1)]==_0x372e7d(0x1d4)){const _0x299a64=await staff['findOne']({'email':_0x1c883d['email']});_0x4808f7=await transfers_finished[_0x372e7d(0x1cf)]({'from_warehouse':_0x299a64['warehouse']});}else _0x4808f7=await transfers_finished[_0x372e7d(0x1a1)]([{'$match':{'type_of_transaction':_0x372e7d(0x1ac)}},{'$unwind':_0x372e7d(0x1b3)},{'$group':{'_id':_0x372e7d(0x1a0),'invoice':{'$first':_0x372e7d(0x150)},'date':{'$first':_0x372e7d(0x1ee)},'from_warehouse':{'$first':_0x372e7d(0x13b)},'to_warehouse':{'$first':_0x372e7d(0x135)},'from_room_name':{'$addToSet':_0x372e7d(0x1b8)},'to_room_name':{'$addToSet':_0x372e7d(0x1f8)},'finalize':{'$first':_0x372e7d(0x156)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x576359[0x0][_0x372e7d(0x1ca)]==_0x372e7d(0x136))var _0x5052ad=users['English'];else{if(_0x576359[0x0][_0x372e7d(0x1ca)]==_0x372e7d(0x143))var _0x5052ad=users['Hindi'];else{if(_0x576359[0x0][_0x372e7d(0x1ca)]==_0x372e7d(0x155))var _0x5052ad=users[_0x372e7d(0x155)];else{if(_0x576359[0x0][_0x372e7d(0x1ca)]==_0x372e7d(0x16c))var _0x5052ad=users[_0x372e7d(0x16c)];else{if(_0x576359[0x0][_0x372e7d(0x1ca)]=='French')var _0x5052ad=users['French'];else{if(_0x576359[0x0][_0x372e7d(0x1ca)]==_0x372e7d(0x181))var _0x5052ad=users[_0x372e7d(0x18c)];else{if(_0x576359[0x0]['language']==_0x372e7d(0x189))var _0x5052ad=users[_0x372e7d(0x189)];else{if(_0x576359[0x0][_0x372e7d(0x1ca)]==_0x372e7d(0x1ec))var _0x5052ad=users[_0x372e7d(0x170)];}}}}}}}_0x114a2f[_0x372e7d(0x178)](_0x372e7d(0x1c3),{'success':_0x1c235f[_0x372e7d(0x13f)]('success'),'errors':_0x1c235f[_0x372e7d(0x13f)](_0x372e7d(0x1f6)),'role':_0x1c883d,'profile':_0x2c1093,'master_shop':_0x576359,'transfer':_0x4808f7,'language':_0x5052ad});}catch(_0x5a5ad0){console[_0x372e7d(0x193)](_0x5a5ad0);}}),router['get'](a0_0x2e50f0(0x13c),auth,async(_0x320326,_0x2d28b4)=>{var _0x49526b=a0_0x2e50f0;try{const {username:_0x28a2b0,email:_0x176237,role:_0x43f84d}=_0x320326['user'],_0x35c519=_0x320326[_0x49526b(0x14e)],_0x324448=await profile[_0x49526b(0x137)]({'email':_0x35c519[_0x49526b(0x142)]}),_0x4fda7b=await master_shop[_0x49526b(0x1cf)]();let _0x315adc;if(_0x35c519[_0x49526b(0x1d1)]==_0x49526b(0x1d4)){const _0x572db2=await staff[_0x49526b(0x137)]({'email':_0x35c519[_0x49526b(0x142)]});_0x315adc=await transfers_finished[_0x49526b(0x1cf)]({'from_warehouse':_0x572db2[_0x49526b(0x1fb)]});}else _0x315adc=await transfers_finished[_0x49526b(0x1a1)]([{'$match':{'type_of_transaction':_0x49526b(0x139)}},{'$unwind':'$product'},{'$group':{'_id':_0x49526b(0x1a0),'invoice':{'$first':_0x49526b(0x150)},'date':{'$first':_0x49526b(0x1ee)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x49526b(0x135)},'from_room_name':{'$addToSet':_0x49526b(0x1b8)},'to_room_name':{'$addToSet':_0x49526b(0x1f8)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x4fda7b[0x0][_0x49526b(0x1ca)]==_0x49526b(0x136))var _0x5be48e=users[_0x49526b(0x1df)];else{if(_0x4fda7b[0x0][_0x49526b(0x1ca)]==_0x49526b(0x143))var _0x5be48e=users[_0x49526b(0x143)];else{if(_0x4fda7b[0x0][_0x49526b(0x1ca)]==_0x49526b(0x155))var _0x5be48e=users[_0x49526b(0x155)];else{if(_0x4fda7b[0x0][_0x49526b(0x1ca)]==_0x49526b(0x16c))var _0x5be48e=users['Spanish'];else{if(_0x4fda7b[0x0]['language']==_0x49526b(0x145))var _0x5be48e=users[_0x49526b(0x145)];else{if(_0x4fda7b[0x0][_0x49526b(0x1ca)]==_0x49526b(0x181))var _0x5be48e=users['Portuguese'];else{if(_0x4fda7b[0x0][_0x49526b(0x1ca)]==_0x49526b(0x189))var _0x5be48e=users[_0x49526b(0x189)];else{if(_0x4fda7b[0x0]['language']==_0x49526b(0x1ec))var _0x5be48e=users[_0x49526b(0x170)];}}}}}}}_0x2d28b4[_0x49526b(0x178)](_0x49526b(0x183),{'success':_0x320326[_0x49526b(0x13f)](_0x49526b(0x169)),'errors':_0x320326[_0x49526b(0x13f)](_0x49526b(0x1f6)),'role':_0x35c519,'profile':_0x324448,'master_shop':_0x4fda7b,'transfer':_0x315adc,'language':_0x5be48e});}catch(_0x4e7838){console[_0x49526b(0x193)](_0x4e7838);}});async function getRandom8DigitNumber(){var _0x1a4451=a0_0x2e50f0;const _0x5b1d85=0x989680,_0x3543e2=0x5f5e0ff,_0x253890=Math['floor'](Math[_0x1a4451(0x16e)]()*(_0x3543e2-_0x5b1d85+0x1))+_0x5b1d85;var _0x2a3ed1;const _0x59d895=await transfers_finished[_0x1a4451(0x137)]({'invoice':_0x1a4451(0x1a9)+_0x253890});return _0x59d895&&_0x59d895[_0x1a4451(0x1c2)]>0x0?_0x2a3ed1=_0x1a4451(0x1a9)+_0x253890:_0x2a3ed1=_0x1a4451(0x1a9)+_0x253890,_0x2a3ed1;}function a0_0x4054(_0x8c0dd1,_0x49141b){var _0x371df7=a0_0x371d();return a0_0x4054=function(_0x40540f,_0x20a4a2){_0x40540f=_0x40540f-0x135;var _0x2a20a5=_0x371df7[_0x40540f];return _0x2a20a5;},a0_0x4054(_0x8c0dd1,_0x49141b);}router['get'](a0_0x2e50f0(0x1ce),auth,async(_0x162c59,_0x2b27bf)=>{var _0x322f2e=a0_0x2e50f0;try{const {username:_0x47c0e2,email:_0x5b7d0f,role:_0x191cd4}=_0x162c59[_0x322f2e(0x14e)],_0x43baf7=_0x162c59[_0x322f2e(0x14e)],_0x1c663b=await profile['findOne']({'email':_0x43baf7['email']}),_0xe652fa=await master_shop[_0x322f2e(0x1cf)]();let _0xe17dd6;if(_0x43baf7['role']=='staff'){const _0x53aef5=await staff[_0x322f2e(0x137)]({'email':_0x43baf7['email']});_0xe17dd6=await warehouse[_0x322f2e(0x1a1)]([{'$match':{'status':_0x322f2e(0x180),'name':_0x53aef5[_0x322f2e(0x1fb)]}},{'$group':{'_id':_0x322f2e(0x147),'name':{'$first':_0x322f2e(0x147)}}}]);}else _0xe17dd6=await warehouse[_0x322f2e(0x1a1)]([{'$match':{'status':_0x322f2e(0x180)}},{'$group':{'_id':_0x322f2e(0x147),'name':{'$first':_0x322f2e(0x147)}}}]);const _0x5e3474=await transfers_finished[_0x322f2e(0x1cf)]({}),_0x4508eb=_0x5e3474['length']+0x1,_0x1b760d=_0x322f2e(0x1a9)+_0x4508eb[_0x322f2e(0x1fd)]()['padStart'](0x5,'0');if(_0xe652fa[0x0][_0x322f2e(0x1ca)]==_0x322f2e(0x136))var _0x4c8ffa=users['English'];else{if(_0xe652fa[0x0][_0x322f2e(0x1ca)]==_0x322f2e(0x143))var _0x4c8ffa=users[_0x322f2e(0x143)];else{if(_0xe652fa[0x0][_0x322f2e(0x1ca)]==_0x322f2e(0x155))var _0x4c8ffa=users['German'];else{if(_0xe652fa[0x0]['language']=='Spanish')var _0x4c8ffa=users['Spanish'];else{if(_0xe652fa[0x0]['language']==_0x322f2e(0x145))var _0x4c8ffa=users[_0x322f2e(0x145)];else{if(_0xe652fa[0x0][_0x322f2e(0x1ca)]==_0x322f2e(0x181))var _0x4c8ffa=users[_0x322f2e(0x18c)];else{if(_0xe652fa[0x0][_0x322f2e(0x1ca)]==_0x322f2e(0x189))var _0x4c8ffa=users['Chinese'];else{if(_0xe652fa[0x0][_0x322f2e(0x1ca)]==_0x322f2e(0x1ec))var _0x4c8ffa=users[_0x322f2e(0x170)];}}}}}}}const _0x20876f=getRandom8DigitNumber();_0x20876f[_0x322f2e(0x1b6)](_0x2084d9=>{var _0x4f0571=_0x322f2e;_0x2b27bf['render'](_0x4f0571(0x152),{'success':_0x162c59['flash'](_0x4f0571(0x169)),'errors':_0x162c59[_0x4f0571(0x13f)]('errors'),'role':_0x43baf7,'profile':_0x1c663b,'master_shop':_0xe652fa,'warehouse':_0xe17dd6,'language':_0x4c8ffa,'invoice':_0x2084d9});})[_0x322f2e(0x1b9)](_0x5263ea=>{var _0x4eec79=_0x322f2e;_0x162c59[_0x4eec79(0x13f)](_0x4eec79(0x1f6),_0x4eec79(0x1e8)),_0x2b27bf[_0x4eec79(0x1cb)](_0x4eec79(0x185));});}catch(_0x39e25c){console[_0x322f2e(0x193)](_0x39e25c);}}),router[a0_0x2e50f0(0x19d)](a0_0x2e50f0(0x1ef),auth,async(_0x3459e1,_0x2bd24d)=>{var _0x37db4d=a0_0x2e50f0;try{const {username:_0x42f926,email:_0x2eeb67,role:_0x7d4da0}=_0x3459e1['user'],_0x30596e=_0x3459e1['user'],_0x53950e=await profile[_0x37db4d(0x137)]({'email':_0x30596e[_0x37db4d(0x142)]}),_0x482f75=await master_shop['find']();let _0x2156de;if(_0x30596e['role']==_0x37db4d(0x1d4)){const _0xd535ce=await staff[_0x37db4d(0x137)]({'email':_0x30596e[_0x37db4d(0x142)]});_0x2156de=await warehouse[_0x37db4d(0x1a1)]([{'$match':{'status':_0x37db4d(0x180),'name':_0xd535ce[_0x37db4d(0x1fb)]}},{'$group':{'_id':_0x37db4d(0x147),'name':{'$first':_0x37db4d(0x147)}}}]);}else _0x2156de=await warehouse[_0x37db4d(0x1a1)]([{'$match':{'status':_0x37db4d(0x180)}},{'$group':{'_id':_0x37db4d(0x147),'name':{'$first':_0x37db4d(0x147)}}}]);const _0x1c536e=await transfers_finished[_0x37db4d(0x1cf)]({}),_0xef4fcf=_0x1c536e[_0x37db4d(0x1c2)]+0x1,_0x2ceba0=_0x37db4d(0x1a9)+_0xef4fcf[_0x37db4d(0x1fd)]()[_0x37db4d(0x1e4)](0x5,'0');if(_0x482f75[0x0][_0x37db4d(0x1ca)]=='English\x20(US)')var _0x58430c=users[_0x37db4d(0x1df)];else{if(_0x482f75[0x0][_0x37db4d(0x1ca)]==_0x37db4d(0x143))var _0x58430c=users[_0x37db4d(0x143)];else{if(_0x482f75[0x0][_0x37db4d(0x1ca)]==_0x37db4d(0x155))var _0x58430c=users[_0x37db4d(0x155)];else{if(_0x482f75[0x0][_0x37db4d(0x1ca)]==_0x37db4d(0x16c))var _0x58430c=users[_0x37db4d(0x16c)];else{if(_0x482f75[0x0][_0x37db4d(0x1ca)]=='French')var _0x58430c=users['French'];else{if(_0x482f75[0x0]['language']==_0x37db4d(0x181))var _0x58430c=users['Portuguese'];else{if(_0x482f75[0x0][_0x37db4d(0x1ca)]==_0x37db4d(0x189))var _0x58430c=users[_0x37db4d(0x189)];else{if(_0x482f75[0x0][_0x37db4d(0x1ca)]==_0x37db4d(0x1ec))var _0x58430c=users[_0x37db4d(0x170)];}}}}}}}const _0x69f5b0=getRandom8DigitNumber();_0x69f5b0[_0x37db4d(0x1b6)](_0x36ca16=>{var _0x12b40d=_0x37db4d;_0x2bd24d['render']('choos_transfer',{'success':_0x3459e1[_0x12b40d(0x13f)]('success'),'errors':_0x3459e1[_0x12b40d(0x13f)](_0x12b40d(0x1f6)),'role':_0x30596e,'profile':_0x53950e,'master_shop':_0x482f75,'warehouse':_0x2156de,'language':_0x58430c,'invoice':_0x36ca16});})['catch'](_0x4e0e13=>{var _0xffc90f=_0x37db4d;_0x3459e1['flash'](_0xffc90f(0x1f6),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2bd24d[_0xffc90f(0x1cb)](_0xffc90f(0x185));});}catch(_0x27090b){console[_0x37db4d(0x193)](_0x27090b);}}),router['get'](a0_0x2e50f0(0x1eb),auth,async(_0x24e746,_0x4b25f9)=>{var _0x4c487b=a0_0x2e50f0;try{const {username:_0x57ec4c,email:_0x28677f,role:_0x329b70}=_0x24e746[_0x4c487b(0x14e)],_0x2682ce=_0x24e746[_0x4c487b(0x14e)],_0x44b2da=await profile[_0x4c487b(0x137)]({'email':_0x2682ce[_0x4c487b(0x142)]}),_0x550273=await master_shop[_0x4c487b(0x1cf)]();let _0x4d75e0;if(_0x2682ce[_0x4c487b(0x1d1)]==_0x4c487b(0x1d4)){const _0xdbcd7c=await staff[_0x4c487b(0x137)]({'email':_0x2682ce['email']});_0x4d75e0=await warehouse[_0x4c487b(0x1a1)]([{'$match':{'status':_0x4c487b(0x180),'name':_0xdbcd7c[_0x4c487b(0x1fb)]}},{'$group':{'_id':_0x4c487b(0x147),'name':{'$first':'$name'}}}]);}else _0x4d75e0=await warehouse[_0x4c487b(0x1a1)]([{'$match':{'status':_0x4c487b(0x180)}},{'$group':{'_id':_0x4c487b(0x147),'name':{'$first':'$name'}}}]);const _0x57f356=await transfers_finished[_0x4c487b(0x1cf)]({}),_0x5be6ab=_0x57f356[_0x4c487b(0x1c2)]+0x1,_0x11411e=_0x4c487b(0x1a9)+_0x5be6ab[_0x4c487b(0x1fd)]()[_0x4c487b(0x1e4)](0x5,'0');if(_0x550273[0x0][_0x4c487b(0x1ca)]==_0x4c487b(0x136))var _0x324760=users[_0x4c487b(0x1df)];else{if(_0x550273[0x0][_0x4c487b(0x1ca)]==_0x4c487b(0x143))var _0x324760=users[_0x4c487b(0x143)];else{if(_0x550273[0x0]['language']==_0x4c487b(0x155))var _0x324760=users[_0x4c487b(0x155)];else{if(_0x550273[0x0][_0x4c487b(0x1ca)]==_0x4c487b(0x16c))var _0x324760=users[_0x4c487b(0x16c)];else{if(_0x550273[0x0]['language']==_0x4c487b(0x145))var _0x324760=users['French'];else{if(_0x550273[0x0][_0x4c487b(0x1ca)]==_0x4c487b(0x181))var _0x324760=users[_0x4c487b(0x18c)];else{if(_0x550273[0x0]['language']=='Chinese')var _0x324760=users[_0x4c487b(0x189)];else{if(_0x550273[0x0][_0x4c487b(0x1ca)]==_0x4c487b(0x1ec))var _0x324760=users[_0x4c487b(0x170)];}}}}}}}const _0x6b7144=getRandom8DigitNumber();_0x6b7144['then'](_0x18cef7=>{var _0x36ec9c=_0x4c487b;_0x4b25f9[_0x36ec9c(0x178)](_0x36ec9c(0x140),{'success':_0x24e746[_0x36ec9c(0x13f)](_0x36ec9c(0x169)),'errors':_0x24e746['flash'](_0x36ec9c(0x1f6)),'role':_0x2682ce,'profile':_0x44b2da,'master_shop':_0x550273,'warehouse':_0x4d75e0,'language':_0x324760,'invoice':_0x18cef7});})[_0x4c487b(0x1b9)](_0x1e8f91=>{var _0x54e9ba=_0x4c487b;_0x24e746['flash']('errors',_0x54e9ba(0x1e8)),_0x4b25f9[_0x54e9ba(0x1cb)](_0x54e9ba(0x185));});}catch(_0x257b45){console[_0x4c487b(0x193)](_0x257b45);}}),router['post']('/view/add_transfer_logs',auth,async(_0x43861d,_0x48e077)=>{var _0x3340de=a0_0x2e50f0;try{const {date:_0x3f2ba2,from_warehouse:_0xa2c140,FromRoom_name:_0x9819c4,to_warehouse:_0xc291c9,ToRoom_name:_0xcce4ed,prod_name:_0x38ebdf,from_prod_qty:_0xc6b576,from_prod_level:_0x2528b3,from_prod_isle:_0x23370f,from_prod_pallet:_0x12acb2,to_prod_qty:_0x6378d2,to_prod_level:_0x5ee419,to_prod_isle:_0x4aa168,to_prod_pallet:_0x480d15,primary_code:_0x56c0bf,secondary_code:_0xbb8e2e,product_code3:_0xd8f31a,note:_0x73c4e8,MaxStocks_data2:_0x10f0e8,invoice:_0x7a697c,expiry_date:_0x412f38,PO_number:_0x58a6ae,ReqBy:_0xe3584b,dateofreq:_0x4f5d29,typeservicesData:_0x42b2ae,destination:_0x3fb312,deliverydate:_0x6b6cb,driver:_0x2f658c,plate:_0x3289c6,van:_0x755179,DRSI:_0x38e0f7,typevehicle:_0x2a9349,TSU:_0x52d330,TFU:_0x487a37}=_0x43861d[_0x3340de(0x200)];if(typeof _0x38ebdf=='string')var _0x18b8b2=[_0x43861d[_0x3340de(0x200)]['prod_name']],_0x3b11ac=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x17d)]],_0x12c160=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x1f4)]],_0x8ee24b=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x1f9)]],_0x55482f=[_0x43861d['body'][_0x3340de(0x172)]],_0x3af383=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x192)]],_0x2f51b9=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x15f)]],_0x5d709b=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x19c)]],_0x31132b=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x168)]],_0x49917e=[_0x43861d[_0x3340de(0x200)]['primary_unit']],_0x42e1e2=[_0x43861d['body']['secondary_unit']],_0x2756f5=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x14b)]],_0xd6e95e=[_0x43861d['body']['expiry_date']],_0x462cb2=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x160)]],_0x1f3863=[_0x43861d[_0x3340de(0x200)]['MaxStocks_data']],_0x2b1a83=[_0x43861d['body'][_0x3340de(0x1b7)]],_0x11785e=[_0x43861d['body'][_0x3340de(0x13d)]],_0x2b8a2b=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x1fc)]],_0x539193=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x1dc)]],_0x346d74=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x1ae)]],_0x24208e=[_0x43861d[_0x3340de(0x200)][_0x3340de(0x1a6)]];else var _0x18b8b2=[..._0x43861d[_0x3340de(0x200)][_0x3340de(0x18d)]],_0x3b11ac=[..._0x43861d['body'][_0x3340de(0x17d)]],_0x12c160=[..._0x43861d[_0x3340de(0x200)][_0x3340de(0x1f4)]],_0x8ee24b=[..._0x43861d['body'][_0x3340de(0x1f9)]],_0x55482f=[..._0x43861d[_0x3340de(0x200)][_0x3340de(0x172)]],_0x3af383=[..._0x43861d['body']['primary_code']],_0x2f51b9=[..._0x43861d[_0x3340de(0x200)]['secondary_code']],_0x5d709b=[..._0x43861d[_0x3340de(0x200)][_0x3340de(0x19c)]],_0x31132b=[..._0x43861d[_0x3340de(0x200)]['MaxStocks_data2']],_0x49917e=[..._0x43861d['body'][_0x3340de(0x1aa)]],_0x42e1e2=[..._0x43861d[_0x3340de(0x200)]['secondary_unit']],_0x2756f5=[..._0x43861d['body'][_0x3340de(0x14b)]],_0xd6e95e=[..._0x43861d[_0x3340de(0x200)][_0x3340de(0x1db)]],_0x462cb2=[..._0x43861d['body'][_0x3340de(0x160)]],_0x1f3863=[..._0x43861d[_0x3340de(0x200)][_0x3340de(0x148)]],_0x2b1a83=[..._0x43861d[_0x3340de(0x200)][_0x3340de(0x1b7)]],_0x11785e=[..._0x43861d[_0x3340de(0x200)]['prod_cat']],_0x2b8a2b=[..._0x43861d[_0x3340de(0x200)]['RoomAssigned']],_0x539193=[..._0x43861d[_0x3340de(0x200)][_0x3340de(0x1dc)]],_0x346d74=[..._0x43861d['body'][_0x3340de(0x1ae)]],_0x24208e=[..._0x43861d['body'][_0x3340de(0x1a6)]];const _0x513bae=_0x18b8b2['map'](_0xcdf982=>{return _0xcdf982={'product_name':_0xcdf982};});_0x3b11ac[_0x3340de(0x163)]((_0xae9ed9,_0x596d0f)=>{var _0x294f3d=_0x3340de;_0x513bae[_0x596d0f][_0x294f3d(0x15d)]=_0xae9ed9;}),_0x12c160[_0x3340de(0x163)]((_0x803a31,_0x2cffa0)=>{var _0x3aa666=_0x3340de,_0x204ce3=_0x803a31[_0x3aa666(0x144)](/[A-Za-z]+/)[0x0],_0x272d4a=parseInt(_0x803a31['match'](/\d+/)[0x0]);_0x513bae[_0x2cffa0][_0x3aa666(0x17f)]=_0x272d4a,_0x513bae[_0x2cffa0]['from_level']=_0x204ce3;}),_0x24208e[_0x3340de(0x163)]((_0x361989,_0x3f6adb)=>{_0x513bae[_0x3f6adb]['id_transaction']=_0x361989;}),_0x346d74[_0x3340de(0x163)]((_0x2b3cb8,_0x38d742)=>{var _0x250638=_0x3340de;_0x513bae[_0x38d742][_0x250638(0x1ae)]=_0x2b3cb8;}),_0x8ee24b[_0x3340de(0x163)]((_0x257761,_0x9566ac)=>{_0x513bae[_0x9566ac]['to_quantity']=_0x257761;}),_0x55482f[_0x3340de(0x163)]((_0xe9e4e7,_0x52498a)=>{var _0x141e9a=_0x3340de,_0x48816f=_0xe9e4e7['match'](/[A-Za-z]+/)[0x0],_0x51b951=parseInt(_0xe9e4e7[_0x141e9a(0x144)](/\d+/)[0x0]);_0x513bae[_0x52498a]['to_level']=_0x48816f,_0x513bae[_0x52498a][_0x141e9a(0x1ba)]=_0x51b951;}),_0x3af383[_0x3340de(0x163)]((_0x44a33c,_0x220236)=>{var _0x1b4384=_0x3340de;_0x513bae[_0x220236][_0x1b4384(0x192)]=_0x44a33c;}),_0x2f51b9[_0x3340de(0x163)]((_0x2c1eae,_0x222f6c)=>{_0x513bae[_0x222f6c]['secondary_code']=_0x2c1eae;}),_0x5d709b['forEach']((_0x582519,_0x21f57e)=>{var _0x1dde74=_0x3340de;_0x513bae[_0x21f57e][_0x1dde74(0x174)]=_0x582519;}),_0x31132b['forEach']((_0x314382,_0x2a70f7)=>{_0x513bae[_0x2a70f7]['maxProducts']=_0x314382;}),_0x49917e[_0x3340de(0x163)]((_0x302c7c,_0x93580b)=>{var _0x2a5eb3=_0x3340de;_0x513bae[_0x93580b][_0x2a5eb3(0x1bb)]=_0x302c7c;}),_0x42e1e2[_0x3340de(0x163)]((_0x23c216,_0x36a89a)=>{var _0x3f1410=_0x3340de;_0x513bae[_0x36a89a][_0x3f1410(0x19f)]=_0x23c216;}),_0x2756f5['forEach']((_0x505464,_0xaf3a2a)=>{var _0x3828bb=_0x3340de;_0x513bae[_0xaf3a2a][_0x3828bb(0x14b)]=_0x505464;}),_0xd6e95e[_0x3340de(0x163)]((_0x16dac8,_0x229624)=>{_0x513bae[_0x229624]['expiry_date']=_0x16dac8;}),_0x462cb2['forEach']((_0x2971e5,_0x4982e6)=>{_0x513bae[_0x4982e6]['production_date']=_0x2971e5;}),_0x1f3863[_0x3340de(0x163)]((_0x189191,_0x2a373d)=>{_0x513bae[_0x2a373d]['maxProducts']=_0x189191;}),_0x2b1a83[_0x3340de(0x163)]((_0x3d0680,_0x6da855)=>{var _0x5d2929=_0x3340de;_0x513bae[_0x6da855][_0x5d2929(0x1b7)]=_0x3d0680;}),_0x11785e['forEach']((_0x2aa8f1,_0x225f23)=>{var _0x305bd7=_0x3340de;_0x513bae[_0x225f23][_0x305bd7(0x13d)]=_0x2aa8f1;}),_0x2b8a2b[_0x3340de(0x163)]((_0x352cfd,_0x3284a4)=>{_0x513bae[_0x3284a4]['from_room_name']=_0x352cfd;}),_0x539193['forEach']((_0x3aafcc,_0xe2111e)=>{var _0x3a281d=_0x3340de;_0x513bae[_0xe2111e][_0x3a281d(0x1c4)]=_0x3aafcc;});const _0x5aa013=_0x513bae[_0x3340de(0x1fe)](_0x469f1e=>_0x469f1e[_0x3340de(0x1b1)]!=='0'&&_0x469f1e[_0x3340de(0x1b1)]!==''||_0x469f1e[_0x3340de(0x1e9)]!=='0'&&_0x469f1e[_0x3340de(0x1e9)]!=='');var _0x4e62cc=0x0;_0x5aa013[_0x3340de(0x163)](_0x7888df=>{var _0x4697ae=_0x3340de;parseInt(_0x7888df['from_quantity'])<parseInt(_0x7888df[_0x4697ae(0x1b1)])&&_0x4e62cc++;});if(_0x4e62cc!=0x0)return _0x43861d[_0x3340de(0x13f)](_0x3340de(0x1f6),_0x3340de(0x186)),_0x48e077[_0x3340de(0x1cb)](_0x3340de(0x1e7));const _0x18bf40=new transfers_logs();await _0x18bf40[_0x3340de(0x1fa)]();for(let _0x550ae0=0x0;_0x550ae0<=_0x539193[_0x3340de(0x1c2)]-0x1;_0x550ae0++){_0x513bae[_0x550ae0][_0x3340de(0x141)]=_0x3340de(0x153)+_0x18bf40['invoice_init'][_0x3340de(0x1fd)]()[_0x3340de(0x1e4)](0x8,'0');}const _0x202c5b=new transfers_finished({'date':_0x3f2ba2,'from_warehouse':_0xa2c140,'to_warehouse':_0xa2c140,'product':_0x5aa013,'note':_0x73c4e8,'invoice':'LOG-TRF-'+_0x18bf40[_0x3340de(0x198)]['toString']()[_0x3340de(0x1e4)](0x8,'0'),'type_of_process':_0x3340de(0x1a3),'type_of_transaction':_0x3340de(0x139),'PO_number':_0x58a6ae,'RequestedBy':_0xe3584b,'DateofRequest':_0x4f5d29,'typeservices':_0x42b2ae,'destination':_0x3fb312,'deliverydate':_0x6b6cb,'driver':_0x2f658c,'plate':_0x3289c6,'van':_0x755179,'DRSI':_0x38e0f7,'typevehicle':_0x2a9349,'TSU':_0x52d330,'TFU':_0x487a37}),_0x24ccf1=await _0x202c5b['save']();_0x43861d[_0x3340de(0x13f)](_0x3340de(0x169),_0x3340de(0x1ea)),_0x48e077[_0x3340de(0x1cb)](_0x3340de(0x1b2)+_0x24ccf1['_id']);}catch(_0xb49714){console['log'](_0xb49714),_0x48e077[_0x3340de(0x15e)](0xc8)[_0x3340de(0x17a)]({'errorMessage':_0xb49714['message']});}}),router[a0_0x2e50f0(0x1ff)]('/view/addlog',auth,async(_0x34c602,_0x505782)=>{var _0x36b645=a0_0x2e50f0;try{const {date:_0xa16949,from_warehouse:_0x4ecbf5,FromRoom_name:_0x5a248e,to_warehouse:_0x5d70f4,ToRoom_name:_0x3ff3ad,prod_name:_0x25310c,from_prod_qty:_0x30a7e9,from_prod_level:_0x30fdaf,from_prod_isle:_0x539ac2,from_prod_pallet:_0x4cfc15,to_prod_qty:_0x5e2a96,to_prod_level:_0x288d18,to_prod_isle:_0x44e5ff,to_prod_pallet:_0x54637e,primary_code:_0x4df9f0,secondary_code:_0x1b190a,product_code3:_0x3d50b6,note:_0x3fdd47,MaxStocks_data2:_0x2ed53a,invoice:_0x6b96c0,expiry_date:_0x218c2d,PO_number_loc:_0x4dd75f,ReqBy_loc:_0x7372db,dateofreq_loc:_0xdafe5c,typeservices_loc_Data:_0x3173b3,destination_loc:_0x332562,deliverydate_loc:_0x141c98,driver_loc:_0x423d6d,plate_loc:_0xd8654d,van_loc:_0x4f352c,DRSI_loc:_0xb41086,typevehicle_loc:_0x3a1755,TSU_loc:_0xddbcae,TFU_loc:_0x2bdfe0}=_0x34c602[_0x36b645(0x200)];if(typeof _0x25310c==_0x36b645(0x16d))var _0x2f00b4=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x18d)]],_0x3f30a4=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x17d)]],_0x2e89fb=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x1f4)]],_0x7624b0=[_0x34c602[_0x36b645(0x200)]['New_Qty_Converted']],_0x4e92bc=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x172)]],_0x2d4c1e=[_0x34c602['body'][_0x36b645(0x192)]],_0x386283=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x15f)]],_0xfda966=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x19c)]],_0x18fbf1=[_0x34c602['body'][_0x36b645(0x168)]],_0x5c4da0=[_0x34c602['body'][_0x36b645(0x1aa)]],_0x5cf381=[_0x34c602[_0x36b645(0x200)]['secondary_unit']],_0x27be83=[_0x34c602[_0x36b645(0x200)]['batch_code']],_0x23253a=[_0x34c602['body'][_0x36b645(0x1db)]],_0x1df25d=[_0x34c602['body'][_0x36b645(0x160)]],_0x4fb3bb=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x148)]],_0xada617=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x1b7)]],_0x22a3ef=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x13d)]],_0x2b1da7=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x1fc)]],_0x101507=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x1dc)]],_0x3fb502=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x1ae)]],_0x12ae56=[_0x34c602[_0x36b645(0x200)][_0x36b645(0x1a6)]];else var _0x2f00b4=[..._0x34c602['body']['prod_name']],_0x3f30a4=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x17d)]],_0x2e89fb=[..._0x34c602['body'][_0x36b645(0x1f4)]],_0x7624b0=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x1f9)]],_0x4e92bc=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x172)]],_0x2d4c1e=[..._0x34c602['body'][_0x36b645(0x192)]],_0x386283=[..._0x34c602[_0x36b645(0x200)]['secondary_code']],_0xfda966=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x19c)]],_0x18fbf1=[..._0x34c602['body']['MaxStocks_data2']],_0x5c4da0=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x1aa)]],_0x5cf381=[..._0x34c602[_0x36b645(0x200)]['secondary_unit']],_0x27be83=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x14b)]],_0x23253a=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x1db)]],_0x1df25d=[..._0x34c602[_0x36b645(0x200)]['product_date']],_0x4fb3bb=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x148)]],_0xada617=[..._0x34c602['body'][_0x36b645(0x1b7)]],_0x22a3ef=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x13d)]],_0x2b1da7=[..._0x34c602[_0x36b645(0x200)]['RoomAssigned']],_0x101507=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x1dc)]],_0x3fb502=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x1ae)]],_0x12ae56=[..._0x34c602[_0x36b645(0x200)][_0x36b645(0x1a6)]];const _0x17b3d3=_0x2f00b4['map'](_0x363802=>{return _0x363802={'product_name':_0x363802};});_0x3f30a4[_0x36b645(0x163)]((_0x551ef8,_0x113949)=>{var _0x39b64d=_0x36b645;_0x17b3d3[_0x113949][_0x39b64d(0x15d)]=_0x551ef8;}),_0x2e89fb[_0x36b645(0x163)]((_0x4741c2,_0x565191)=>{var _0x1ffd30=_0x36b645,_0xc71d5a=_0x4741c2['match'](/[A-Za-z]+/)[0x0],_0xeeb2cc=parseInt(_0x4741c2['match'](/\d+/)[0x0]);_0x17b3d3[_0x565191]['from_bay']=_0xeeb2cc,_0x17b3d3[_0x565191][_0x1ffd30(0x14a)]=_0xc71d5a;}),_0x12ae56['forEach']((_0x5aeaa6,_0x3dc91e)=>{var _0x343c8c=_0x36b645;_0x17b3d3[_0x3dc91e][_0x343c8c(0x1a6)]=_0x5aeaa6;}),_0x3fb502['forEach']((_0x1d0021,_0x2a6d74)=>{var _0x535e77=_0x36b645;_0x17b3d3[_0x2a6d74][_0x535e77(0x1ae)]=_0x1d0021;}),_0x7624b0[_0x36b645(0x163)]((_0x41af52,_0x51be3e)=>{_0x17b3d3[_0x51be3e]['to_quantity']=_0x41af52;}),_0x4e92bc[_0x36b645(0x163)]((_0x96ed74,_0x20d044)=>{var _0x5cdb64=_0x36b645,_0x1c03fe=_0x96ed74[_0x5cdb64(0x144)](/[A-Za-z]+/)[0x0],_0x947f03=parseInt(_0x96ed74[_0x5cdb64(0x144)](/\d+/)[0x0]);_0x17b3d3[_0x20d044]['to_level']=_0x1c03fe,_0x17b3d3[_0x20d044][_0x5cdb64(0x1ba)]=_0x947f03;}),_0x2d4c1e[_0x36b645(0x163)]((_0x1c2808,_0x19e232)=>{_0x17b3d3[_0x19e232]['primary_code']=_0x1c2808;}),_0x386283[_0x36b645(0x163)]((_0x5961b1,_0x5823a1)=>{var _0x3ecf1a=_0x36b645;_0x17b3d3[_0x5823a1][_0x3ecf1a(0x15f)]=_0x5961b1;}),_0xfda966['forEach']((_0x32bbff,_0x3d1249)=>{var _0x438d82=_0x36b645;_0x17b3d3[_0x3d1249][_0x438d82(0x174)]=_0x32bbff;}),_0x18fbf1[_0x36b645(0x163)]((_0x4551da,_0x5b1cf9)=>{_0x17b3d3[_0x5b1cf9]['maxProducts']=_0x4551da;}),_0x5c4da0[_0x36b645(0x163)]((_0xc8a57b,_0x117ec2)=>{var _0x1e1480=_0x36b645;_0x17b3d3[_0x117ec2][_0x1e1480(0x1bb)]=_0xc8a57b;}),_0x5cf381[_0x36b645(0x163)]((_0x3211a5,_0x59d747)=>{var _0x12c396=_0x36b645;_0x17b3d3[_0x59d747][_0x12c396(0x19f)]=_0x3211a5;}),_0x27be83[_0x36b645(0x163)]((_0x376dfd,_0x3cb72d)=>{_0x17b3d3[_0x3cb72d]['batch_code']=_0x376dfd;}),_0x23253a[_0x36b645(0x163)]((_0x1a8a07,_0x5e8cf8)=>{var _0x4ad606=_0x36b645;_0x17b3d3[_0x5e8cf8][_0x4ad606(0x1db)]=_0x1a8a07;}),_0x1df25d[_0x36b645(0x163)]((_0x1f5305,_0x5d6c35)=>{var _0x5c6b0c=_0x36b645;_0x17b3d3[_0x5d6c35][_0x5c6b0c(0x1a4)]=_0x1f5305;}),_0x4fb3bb[_0x36b645(0x163)]((_0x61069f,_0x4c5de1)=>{_0x17b3d3[_0x4c5de1]['maxProducts']=_0x61069f;}),_0xada617[_0x36b645(0x163)]((_0x5e89a4,_0x23f8a1)=>{_0x17b3d3[_0x23f8a1]['maxPerUnit']=_0x5e89a4;}),_0x22a3ef[_0x36b645(0x163)]((_0x437cf6,_0x1b52a9)=>{var _0x28396d=_0x36b645;_0x17b3d3[_0x1b52a9][_0x28396d(0x13d)]=_0x437cf6;}),_0x2b1da7[_0x36b645(0x163)]((_0x567398,_0x137843)=>{_0x17b3d3[_0x137843]['from_room_name']=_0x567398;}),_0x101507[_0x36b645(0x163)]((_0x21b6bb,_0x2f1e6a)=>{var _0x1bf08f=_0x36b645;_0x17b3d3[_0x2f1e6a][_0x1bf08f(0x1c4)]=_0x21b6bb;});const _0x28d18b=_0x17b3d3['filter'](_0x2f38dd=>_0x2f38dd[_0x36b645(0x1b1)]!=='0'&&_0x2f38dd[_0x36b645(0x1b1)]!==''||_0x2f38dd[_0x36b645(0x1e9)]!=='0'&&_0x2f38dd[_0x36b645(0x1e9)]!=='');var _0x3ef03f=0x0;_0x28d18b[_0x36b645(0x163)](_0x2b2368=>{var _0x38d25d=_0x36b645;parseInt(_0x2b2368[_0x38d25d(0x15d)])<parseInt(_0x2b2368[_0x38d25d(0x1b1)])&&_0x3ef03f++;});if(_0x3ef03f!=0x0)return _0x34c602[_0x36b645(0x13f)]('errors',_0x36b645(0x186)),_0x505782['redirect'](_0x36b645(0x1e7));const _0x48c67b=new transfers_logs();await _0x48c67b[_0x36b645(0x1fa)]();for(let _0x598b83=0x0;_0x598b83<=_0x101507['length']-0x1;_0x598b83++){_0x17b3d3[_0x598b83][_0x36b645(0x141)]=_0x36b645(0x153)+_0x48c67b[_0x36b645(0x198)][_0x36b645(0x1fd)]()['padStart'](0x8,'0');}const _0x2c7ad7=new transfers_finished({'date':_0xa16949,'from_warehouse':_0x4ecbf5,'to_warehouse':_0x5d70f4,'product':_0x28d18b,'note':_0x3fdd47,'invoice':_0x36b645(0x153)+_0x48c67b[_0x36b645(0x198)]['toString']()[_0x36b645(0x1e4)](0x8,'0'),'type_of_transaction':_0x36b645(0x139),'type_of_process':_0x36b645(0x1b0),'PO_number':_0x4dd75f,'RequestedBy':_0x7372db,'DateofRequest':_0xdafe5c,'typeservices':_0x3173b3,'destination':_0x332562,'deliverydate':_0x141c98,'driver':_0x423d6d,'plate':_0xd8654d,'van':_0x4f352c,'DRSI':_0xb41086,'typevehicle':_0x3a1755,'TSU':_0xddbcae,'TFU':_0x2bdfe0}),_0x3eaf14=await _0x2c7ad7['save']();_0x34c602['flash']('success',_0x36b645(0x1ea)),_0x505782[_0x36b645(0x1cb)](_0x36b645(0x1b2)+_0x3eaf14[_0x36b645(0x14c)]);}catch(_0x1a78f4){console[_0x36b645(0x193)](_0x1a78f4),_0x505782[_0x36b645(0x15e)](0xc8)['json']({'errorMessage':_0x1a78f4['message']});}}),router[a0_0x2e50f0(0x1ff)](a0_0x2e50f0(0x1ce),auth,async(_0x59c320,_0x245883)=>{var _0x3f5fa1=a0_0x2e50f0;try{const {date:_0x23bb12,from_warehouse:_0x79edc5,FromRoom_name:_0x4055f5,to_warehouse:_0x36226e,ToRoom_name:_0x56e86e,prod_name:_0x233a82,from_prod_qty:_0x253496,from_prod_level:_0x5e7624,from_prod_isle:_0x203214,from_prod_pallet:_0x220ef2,to_prod_qty:_0x4af417,to_prod_level:_0x3064d5,to_prod_isle:_0x783bfd,to_prod_pallet:_0x185ab6,primary_code:_0x2eb53a,secondary_code:_0x43b66e,product_code3:_0x283cbf,note:_0x48c0a6,MaxStocks_data2:_0x5360d1,invoice:_0x1ae9a2,expiry_date:_0x4f3fc3,PO_number:_0x36a389,ReqBy:_0x114d07,dateofreq:_0x5dd0bf,typeservicesData:_0x4689bf,destination:_0x16a490,deliverydate:_0x2214d9,driver:_0x1312c3,plate:_0x401e84,van:_0x469313,DRSI:_0x23462c,typevehicle:_0x3a50a6,TSU:_0x4de2ce,TFU:_0x49623a}=_0x59c320[_0x3f5fa1(0x200)];if(typeof _0x233a82==_0x3f5fa1(0x16d))var _0x53e5ba=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x18d)]],_0x4e6fac=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x17d)]],_0x58b05a=[_0x59c320[_0x3f5fa1(0x200)]['from_prod_level2']],_0x2e234e=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1f9)]],_0x10e0a1=[_0x59c320[_0x3f5fa1(0x200)]['to_prod_level']],_0xfe288=[_0x59c320[_0x3f5fa1(0x200)]['primary_code']],_0x5ebf2a=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x15f)]],_0x2c452d=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x19c)]],_0x5007cd=[_0x59c320[_0x3f5fa1(0x200)]['MaxStocks_data2']],_0x36e6df=[_0x59c320['body']['primary_unit']],_0x4a97de=[_0x59c320[_0x3f5fa1(0x200)]['secondary_unit']],_0x2232f9=[_0x59c320[_0x3f5fa1(0x200)]['batch_code']],_0x158964=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1db)]],_0x34315b=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x160)]],_0x19d175=[_0x59c320['body'][_0x3f5fa1(0x148)]],_0x36bd72=[_0x59c320['body'][_0x3f5fa1(0x1b7)]],_0xb3e6bc=[_0x59c320[_0x3f5fa1(0x200)]['prod_cat']],_0x24e5bc=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1fc)]],_0x4de2d7=[_0x59c320['body'][_0x3f5fa1(0x1dc)]],_0xc4b119=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1ae)]],_0x19eeb4=[_0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1a6)]];else var _0x53e5ba=[..._0x59c320[_0x3f5fa1(0x200)]['prod_name']],_0x4e6fac=[..._0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x17d)]],_0x58b05a=[..._0x59c320[_0x3f5fa1(0x200)]['from_prod_level2']],_0x2e234e=[..._0x59c320[_0x3f5fa1(0x200)]['New_Qty_Converted']],_0x10e0a1=[..._0x59c320['body'][_0x3f5fa1(0x172)]],_0xfe288=[..._0x59c320[_0x3f5fa1(0x200)]['primary_code']],_0x5ebf2a=[..._0x59c320[_0x3f5fa1(0x200)]['secondary_code']],_0x2c452d=[..._0x59c320[_0x3f5fa1(0x200)]['product_code3']],_0x5007cd=[..._0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x168)]],_0x36e6df=[..._0x59c320[_0x3f5fa1(0x200)]['primary_unit']],_0x4a97de=[..._0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x19f)]],_0x2232f9=[..._0x59c320[_0x3f5fa1(0x200)]['batch_code']],_0x158964=[..._0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1db)]],_0x34315b=[..._0x59c320['body'][_0x3f5fa1(0x160)]],_0x19d175=[..._0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x148)]],_0x36bd72=[..._0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1b7)]],_0xb3e6bc=[..._0x59c320['body'][_0x3f5fa1(0x13d)]],_0x24e5bc=[..._0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1fc)]],_0x4de2d7=[..._0x59c320['body'][_0x3f5fa1(0x1dc)]],_0xc4b119=[..._0x59c320[_0x3f5fa1(0x200)]['from_invoice']],_0x19eeb4=[..._0x59c320[_0x3f5fa1(0x200)][_0x3f5fa1(0x1a6)]];const _0x442dfb=_0x53e5ba['map'](_0x51952c=>{return _0x51952c={'product_name':_0x51952c};});_0x4e6fac[_0x3f5fa1(0x163)]((_0x469922,_0xe87975)=>{var _0x4c5810=_0x3f5fa1;_0x442dfb[_0xe87975][_0x4c5810(0x15d)]=_0x469922;}),_0x58b05a[_0x3f5fa1(0x163)]((_0x4fcb3d,_0x1ccabf)=>{var _0x4a1b98=_0x3f5fa1,_0x2ebd53=_0x4fcb3d[_0x4a1b98(0x144)](/[A-Za-z]+/)[0x0],_0x26dad7=parseInt(_0x4fcb3d[_0x4a1b98(0x144)](/\d+/)[0x0]);_0x442dfb[_0x1ccabf]['from_bay']=_0x26dad7,_0x442dfb[_0x1ccabf][_0x4a1b98(0x14a)]=_0x2ebd53;}),_0x19eeb4['forEach']((_0x1f6cb6,_0x24f7a2)=>{var _0x54c09a=_0x3f5fa1;_0x442dfb[_0x24f7a2][_0x54c09a(0x1a6)]=_0x1f6cb6;}),_0xc4b119[_0x3f5fa1(0x163)]((_0x5d8e12,_0x2e0d04)=>{_0x442dfb[_0x2e0d04]['from_invoice']=_0x5d8e12;}),_0x2e234e[_0x3f5fa1(0x163)]((_0x2d6624,_0x5aef3f)=>{_0x442dfb[_0x5aef3f]['to_quantity']=_0x2d6624;}),_0x10e0a1[_0x3f5fa1(0x163)]((_0x2a133d,_0xbfd87d)=>{var _0x22eb72=_0x3f5fa1,_0x13d494=_0x2a133d[_0x22eb72(0x144)](/[A-Za-z]+/)[0x0],_0x248eca=parseInt(_0x2a133d[_0x22eb72(0x144)](/\d+/)[0x0]);_0x442dfb[_0xbfd87d]['to_level']=_0x13d494,_0x442dfb[_0xbfd87d][_0x22eb72(0x1ba)]=_0x248eca;}),_0xfe288['forEach']((_0x185f9b,_0x237b08)=>{_0x442dfb[_0x237b08]['primary_code']=_0x185f9b;}),_0x5ebf2a[_0x3f5fa1(0x163)]((_0x3a3429,_0x2ebeba)=>{var _0x1419b7=_0x3f5fa1;_0x442dfb[_0x2ebeba][_0x1419b7(0x15f)]=_0x3a3429;}),_0x2c452d['forEach']((_0x210e4d,_0x1dfe1f)=>{var _0x3ba885=_0x3f5fa1;_0x442dfb[_0x1dfe1f][_0x3ba885(0x174)]=_0x210e4d;}),_0x5007cd['forEach']((_0x55e630,_0x391e3e)=>{var _0x5bef36=_0x3f5fa1;_0x442dfb[_0x391e3e][_0x5bef36(0x1de)]=_0x55e630;}),_0x36e6df[_0x3f5fa1(0x163)]((_0x368f70,_0x5a9f8d)=>{var _0x356e6c=_0x3f5fa1;_0x442dfb[_0x5a9f8d][_0x356e6c(0x1bb)]=_0x368f70;}),_0x4a97de[_0x3f5fa1(0x163)]((_0x210d3f,_0x55bf85)=>{var _0xe2cf1d=_0x3f5fa1;_0x442dfb[_0x55bf85][_0xe2cf1d(0x19f)]=_0x210d3f;}),_0x2232f9[_0x3f5fa1(0x163)]((_0x14b687,_0x302000)=>{var _0x895988=_0x3f5fa1;_0x442dfb[_0x302000][_0x895988(0x14b)]=_0x14b687;}),_0x158964[_0x3f5fa1(0x163)]((_0x10d91c,_0x38847c)=>{_0x442dfb[_0x38847c]['expiry_date']=_0x10d91c;}),_0x34315b[_0x3f5fa1(0x163)]((_0x23819e,_0x41ab7a)=>{var _0x3512e0=_0x3f5fa1;_0x442dfb[_0x41ab7a][_0x3512e0(0x1a4)]=_0x23819e;}),_0x19d175[_0x3f5fa1(0x163)]((_0x39e8f2,_0x2836be)=>{var _0x1a672f=_0x3f5fa1;_0x442dfb[_0x2836be][_0x1a672f(0x1de)]=_0x39e8f2;}),_0x36bd72[_0x3f5fa1(0x163)]((_0x2e4ab2,_0x5966d3)=>{_0x442dfb[_0x5966d3]['maxPerUnit']=_0x2e4ab2;}),_0xb3e6bc[_0x3f5fa1(0x163)]((_0x2d3229,_0x538c7f)=>{var _0x591b8e=_0x3f5fa1;_0x442dfb[_0x538c7f][_0x591b8e(0x13d)]=_0x2d3229;}),_0x24e5bc[_0x3f5fa1(0x163)]((_0x5a0757,_0x12069d)=>{_0x442dfb[_0x12069d]['from_room_name']=_0x5a0757;}),_0x4de2d7['forEach']((_0x2651a3,_0x372dcc)=>{_0x442dfb[_0x372dcc]['to_room_name']=_0x2651a3;});const _0x3142a4=_0x442dfb[_0x3f5fa1(0x1fe)](_0x4ea33f=>_0x4ea33f['to_quantity']!=='0'&&_0x4ea33f['to_quantity']!==''||_0x4ea33f[_0x3f5fa1(0x1e9)]!=='0'&&_0x4ea33f[_0x3f5fa1(0x1e9)]!=='');var _0x413ce5=0x0;_0x3142a4['forEach'](_0x5402c2=>{parseInt(_0x5402c2['from_quantity'])<parseInt(_0x5402c2['to_quantity'])&&_0x413ce5++;});if(_0x413ce5!=0x0)return _0x59c320[_0x3f5fa1(0x13f)](_0x3f5fa1(0x1f6),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x245883['redirect'](_0x3f5fa1(0x1e7));const _0x4ebd8a=new invoice_for_transfer();await _0x4ebd8a[_0x3f5fa1(0x1fa)]();for(let _0xe18111=0x0;_0xe18111<=_0x4de2d7['length']-0x1;_0xe18111++){_0x442dfb[_0xe18111][_0x3f5fa1(0x141)]='TRF-'+_0x4ebd8a[_0x3f5fa1(0x198)][_0x3f5fa1(0x1fd)]()[_0x3f5fa1(0x1e4)](0x8,'0');}const _0x27822b=new transfers_finished({'date':_0x23bb12,'from_warehouse':_0x79edc5,'to_warehouse':_0x79edc5,'product':_0x3142a4,'note':_0x48c0a6,'invoice':_0x3f5fa1(0x1d3)+_0x4ebd8a[_0x3f5fa1(0x198)]['toString']()[_0x3f5fa1(0x1e4)](0x8,'0'),'type_of_process':_0x3f5fa1(0x1a3),'type_of_transaction':_0x3f5fa1(0x1ac),'PO_number':_0x36a389,'RequestedBy':_0x114d07,'DateofRequest':_0x5dd0bf,'typeservices':_0x4689bf,'destination':_0x16a490,'deliverydate':_0x2214d9,'driver':_0x1312c3,'plate':_0x401e84,'van':_0x469313,'DRSI':_0x23462c,'typevehicle':_0x3a50a6,'TSU':_0x4de2ce,'TFU':_0x49623a}),_0x50e0f8=await _0x27822b[_0x3f5fa1(0x1fa)]();_0x59c320['flash']('success',_0x3f5fa1(0x1ea)),_0x245883[_0x3f5fa1(0x1cb)](_0x3f5fa1(0x1b2)+_0x50e0f8[_0x3f5fa1(0x14c)]);}catch(_0x2522cf){console[_0x3f5fa1(0x193)](_0x2522cf),_0x245883[_0x3f5fa1(0x15e)](0xc8)[_0x3f5fa1(0x17a)]({'errorMessage':_0x2522cf[_0x3f5fa1(0x1c6)]});}}),router[a0_0x2e50f0(0x1ff)](a0_0x2e50f0(0x188),auth,async(_0x3bea76,_0x4a6454)=>{var _0x4e5300=a0_0x2e50f0;try{const {date:_0x20d553,from_warehouse:_0x1de0db,FromRoom_name:_0x23022c,to_warehouse:_0x47e455,ToRoom_name:_0x3381a2,prod_name:_0x4c6787,from_prod_qty:_0x48ea73,from_prod_level:_0x34c71a,from_prod_isle:_0x4045bc,from_prod_pallet:_0xa339f8,to_prod_qty:_0x52b39f,to_prod_level:_0x38b20e,to_prod_isle:_0x55a6e6,to_prod_pallet:_0x39c551,primary_code:_0x5afee7,secondary_code:_0x2cbdc0,product_code3:_0x49fd34,note:_0x4a2b1d,MaxStocks_data2:_0x1eed0f,invoice:_0x531b89,expiry_date:_0x5bba63,PO_number_loc:_0xda6fe,ReqBy_loc:_0x49f282,dateofreq_loc:_0x40d7b2,typeservices_loc_Data:_0x58e0fc,destination_loc:_0x2f1ee2,deliverydate_loc:_0x478073,driver_loc:_0x7ff276,plate_loc:_0x358305,van_loc:_0x2e3b48,DRSI_loc:_0x316904,typevehicle_loc:_0x5bf33f,TSU_loc:_0x104dc9,TFU_loc:_0x28a2fd}=_0x3bea76[_0x4e5300(0x200)];if(typeof _0x4c6787==_0x4e5300(0x16d))var _0x1df8cc=[_0x3bea76['body'][_0x4e5300(0x18d)]],_0x1c7318=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x17d)]],_0x2d06a8=[_0x3bea76['body'][_0x4e5300(0x1f4)]],_0x101056=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1f9)]],_0x4fa2be=[_0x3bea76['body'][_0x4e5300(0x172)]],_0x3f887c=[_0x3bea76['body']['primary_code']],_0x4b68f1=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x15f)]],_0x1aadb1=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x19c)]],_0x286652=[_0x3bea76['body'][_0x4e5300(0x168)]],_0x55acc6=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1aa)]],_0x39c1d6=[_0x3bea76[_0x4e5300(0x200)]['secondary_unit']],_0xe81e49=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x14b)]],_0x111354=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1db)]],_0x3aabbe=[_0x3bea76[_0x4e5300(0x200)]['product_date']],_0x239663=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x148)]],_0x38ef90=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1b7)]],_0x3ffbb2=[_0x3bea76[_0x4e5300(0x200)]['prod_cat']],_0x16bdd4=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1fc)]],_0x298e98=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1dc)]],_0x57efb3=[_0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1ae)]],_0x5581a4=[_0x3bea76[_0x4e5300(0x200)]['id_transaction']];else var _0x1df8cc=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x18d)]],_0x1c7318=[..._0x3bea76['body'][_0x4e5300(0x17d)]],_0x2d06a8=[..._0x3bea76['body'][_0x4e5300(0x1f4)]],_0x101056=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1f9)]],_0x4fa2be=[..._0x3bea76['body']['to_prod_level']],_0x3f887c=[..._0x3bea76['body'][_0x4e5300(0x192)]],_0x4b68f1=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x15f)]],_0x1aadb1=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x19c)]],_0x286652=[..._0x3bea76[_0x4e5300(0x200)]['MaxStocks_data2']],_0x55acc6=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1aa)]],_0x39c1d6=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x19f)]],_0xe81e49=[..._0x3bea76['body']['batch_code']],_0x111354=[..._0x3bea76['body'][_0x4e5300(0x1db)]],_0x3aabbe=[..._0x3bea76['body'][_0x4e5300(0x160)]],_0x239663=[..._0x3bea76['body'][_0x4e5300(0x148)]],_0x38ef90=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1b7)]],_0x3ffbb2=[..._0x3bea76['body'][_0x4e5300(0x13d)]],_0x16bdd4=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1fc)]],_0x298e98=[..._0x3bea76['body']['ToRoomAssigned']],_0x57efb3=[..._0x3bea76['body'][_0x4e5300(0x1ae)]],_0x5581a4=[..._0x3bea76[_0x4e5300(0x200)][_0x4e5300(0x1a6)]];const _0x142bbb=_0x1df8cc[_0x4e5300(0x19e)](_0x54fd88=>{return _0x54fd88={'product_name':_0x54fd88};});_0x1c7318[_0x4e5300(0x163)]((_0x29c507,_0x408ed9)=>{var _0x1a9591=_0x4e5300;_0x142bbb[_0x408ed9][_0x1a9591(0x15d)]=_0x29c507;}),_0x2d06a8[_0x4e5300(0x163)]((_0x1ddf4e,_0x54cdb8)=>{var _0x72d721=_0x4e5300,_0x47e7b0=_0x1ddf4e[_0x72d721(0x144)](/[A-Za-z]+/)[0x0],_0x48ec69=parseInt(_0x1ddf4e[_0x72d721(0x144)](/\d+/)[0x0]);_0x142bbb[_0x54cdb8][_0x72d721(0x17f)]=_0x48ec69,_0x142bbb[_0x54cdb8][_0x72d721(0x14a)]=_0x47e7b0;}),_0x5581a4[_0x4e5300(0x163)]((_0x57fb8e,_0x143798)=>{_0x142bbb[_0x143798]['id_transaction']=_0x57fb8e;}),_0x57efb3['forEach']((_0x3680a7,_0x5f12fb)=>{_0x142bbb[_0x5f12fb]['from_invoice']=_0x3680a7;}),_0x101056[_0x4e5300(0x163)]((_0x456273,_0x242bc4)=>{_0x142bbb[_0x242bc4]['to_quantity']=_0x456273;}),_0x4fa2be[_0x4e5300(0x163)]((_0x5300b0,_0x315aa3)=>{var _0x57aebf=_0x4e5300,_0x433e45=_0x5300b0[_0x57aebf(0x144)](/[A-Za-z]+/)[0x0],_0x449bb9=parseInt(_0x5300b0[_0x57aebf(0x144)](/\d+/)[0x0]);_0x142bbb[_0x315aa3][_0x57aebf(0x18b)]=_0x433e45,_0x142bbb[_0x315aa3][_0x57aebf(0x1ba)]=_0x449bb9;}),_0x3f887c[_0x4e5300(0x163)]((_0x297bde,_0x31413b)=>{_0x142bbb[_0x31413b]['primary_code']=_0x297bde;}),_0x4b68f1[_0x4e5300(0x163)]((_0x57b7f7,_0x2da2cd)=>{var _0x42b4c2=_0x4e5300;_0x142bbb[_0x2da2cd][_0x42b4c2(0x15f)]=_0x57b7f7;}),_0x1aadb1['forEach']((_0x21440a,_0xa38b22)=>{var _0x47a0b8=_0x4e5300;_0x142bbb[_0xa38b22][_0x47a0b8(0x174)]=_0x21440a;}),_0x286652[_0x4e5300(0x163)]((_0x40c333,_0x186305)=>{var _0x25b8cb=_0x4e5300;_0x142bbb[_0x186305][_0x25b8cb(0x1de)]=_0x40c333;}),_0x55acc6['forEach']((_0x330f0c,_0x56e900)=>{var _0x28ab70=_0x4e5300;_0x142bbb[_0x56e900][_0x28ab70(0x1bb)]=_0x330f0c;}),_0x39c1d6['forEach']((_0x26b7cd,_0x38da17)=>{var _0x2dfeaf=_0x4e5300;_0x142bbb[_0x38da17][_0x2dfeaf(0x19f)]=_0x26b7cd;}),_0xe81e49['forEach']((_0xfd4c1d,_0x55710a)=>{var _0x19de35=_0x4e5300;_0x142bbb[_0x55710a][_0x19de35(0x14b)]=_0xfd4c1d;}),_0x111354[_0x4e5300(0x163)]((_0x274c07,_0x440c39)=>{_0x142bbb[_0x440c39]['expiry_date']=_0x274c07;}),_0x3aabbe[_0x4e5300(0x163)]((_0x48aaf7,_0x51793d)=>{var _0x43b81f=_0x4e5300;_0x142bbb[_0x51793d][_0x43b81f(0x1a4)]=_0x48aaf7;}),_0x239663['forEach']((_0x2b316b,_0x3706f0)=>{_0x142bbb[_0x3706f0]['maxProducts']=_0x2b316b;}),_0x38ef90[_0x4e5300(0x163)]((_0x32c443,_0x1aaaa3)=>{_0x142bbb[_0x1aaaa3]['maxPerUnit']=_0x32c443;}),_0x3ffbb2['forEach']((_0x1c0900,_0x2350e1)=>{var _0x22dd36=_0x4e5300;_0x142bbb[_0x2350e1][_0x22dd36(0x13d)]=_0x1c0900;}),_0x16bdd4[_0x4e5300(0x163)]((_0x1475ce,_0x3e5c2d)=>{var _0x1221e2=_0x4e5300;_0x142bbb[_0x3e5c2d][_0x1221e2(0x1c5)]=_0x1475ce;}),_0x298e98[_0x4e5300(0x163)]((_0x276312,_0x4d6fb0)=>{var _0x2a2b83=_0x4e5300;_0x142bbb[_0x4d6fb0][_0x2a2b83(0x1c4)]=_0x276312;});const _0x3b3fb6=_0x142bbb[_0x4e5300(0x1fe)](_0x3e26cc=>_0x3e26cc[_0x4e5300(0x1b1)]!=='0'&&_0x3e26cc[_0x4e5300(0x1b1)]!==''||_0x3e26cc[_0x4e5300(0x1e9)]!=='0'&&_0x3e26cc['to_floorlevel']!=='');var _0x4a4d2c=0x0;_0x3b3fb6['forEach'](_0x4d0a1a=>{var _0x5a9e58=_0x4e5300;parseInt(_0x4d0a1a[_0x5a9e58(0x15d)])<parseInt(_0x4d0a1a[_0x5a9e58(0x1b1)])&&_0x4a4d2c++;});if(_0x4a4d2c!=0x0)return _0x3bea76['flash'](_0x4e5300(0x1f6),_0x4e5300(0x186)),_0x4a6454[_0x4e5300(0x1cb)](_0x4e5300(0x1e7));const _0x560730=new invoice_for_transfer();await _0x560730[_0x4e5300(0x1fa)]();for(let _0x4b133e=0x0;_0x4b133e<=_0x298e98[_0x4e5300(0x1c2)]-0x1;_0x4b133e++){_0x142bbb[_0x4b133e][_0x4e5300(0x141)]='TRF-'+_0x560730[_0x4e5300(0x198)][_0x4e5300(0x1fd)]()[_0x4e5300(0x1e4)](0x8,'0');}const _0x290f8e=new transfers_finished({'date':_0x20d553,'from_warehouse':_0x1de0db,'to_warehouse':_0x47e455,'product':_0x3b3fb6,'note':_0x4a2b1d,'invoice':_0x4e5300(0x1d3)+_0x560730[_0x4e5300(0x198)]['toString']()[_0x4e5300(0x1e4)](0x8,'0'),'type_of_transaction':_0x4e5300(0x1ac),'type_of_process':_0x4e5300(0x1b0),'PO_number':_0xda6fe,'RequestedBy':_0x49f282,'DateofRequest':_0x40d7b2,'typeservices':_0x58e0fc,'destination':_0x2f1ee2,'deliverydate':_0x478073,'driver':_0x7ff276,'plate':_0x358305,'van':_0x2e3b48,'DRSI':_0x316904,'typevehicle':_0x5bf33f,'TSU':_0x104dc9,'TFU':_0x28a2fd}),_0x4e0a50=await _0x290f8e['save']();_0x3bea76[_0x4e5300(0x13f)](_0x4e5300(0x169),'Product\x20Transfer\x20successfully'),_0x4a6454[_0x4e5300(0x1cb)](_0x4e5300(0x1b2)+_0x4e0a50[_0x4e5300(0x14c)]);}catch(_0x2cfbdb){console[_0x4e5300(0x193)](_0x2cfbdb),_0x4a6454['status'](0xc8)[_0x4e5300(0x17a)]({'errorMessage':_0x2cfbdb[_0x4e5300(0x1c6)]});}}),router[a0_0x2e50f0(0x19d)](a0_0x2e50f0(0x13e),auth,async(_0x2de59a,_0x4a6036)=>{var _0x297ae3=a0_0x2e50f0;try{const {username:_0x1c0cc6,email:_0x5c2e29,role:_0xac9275}=_0x2de59a[_0x297ae3(0x14e)],_0x1276f8=_0x2de59a['user'],_0x441d62=await profile[_0x297ae3(0x137)]({'email':_0x1276f8[_0x297ae3(0x142)]}),_0x3cadbd=await master_shop['find'](),_0x32e792=await transfers_finished[_0x297ae3(0x17c)](_0x2de59a[_0x297ae3(0x171)]['id']);let _0x482815;if(_0x1276f8[_0x297ae3(0x1d1)]==_0x297ae3(0x1d4)){const _0x408eab=await staff[_0x297ae3(0x137)]({'email':_0x1276f8[_0x297ae3(0x142)]});_0x482815=await warehouse[_0x297ae3(0x1cf)]({'status':'Enabled','name':_0x408eab[_0x297ae3(0x1fb)],'warehouse_category':_0x297ae3(0x19b)});}else _0x482815=await warehouse[_0x297ae3(0x1cf)]({'status':_0x297ae3(0x180),'warehouse_category':_0x297ae3(0x19b)});const _0x1ee06b=await warehouse[_0x297ae3(0x1a1)]([{'$match':{'name':_0x32e792[_0x297ae3(0x1f3)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x297ae3(0x167)},{'$group':{'_id':_0x297ae3(0x1e1),'name':{'$first':_0x297ae3(0x158)},'product_stock':{'$first':_0x297ae3(0x1e0)},'bay':{'$first':_0x297ae3(0x161)},'bin':{'$first':_0x297ae3(0x187)},'type':{'$first':_0x297ae3(0x17b)},'floorlevel':{'$first':_0x297ae3(0x1d8)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x297ae3(0x14d)},'product_code':{'$first':_0x297ae3(0x1c0)},'storage':{'$first':_0x297ae3(0x19a)},'rack':{'$first':_0x297ae3(0x16b)},'expiry_date':{'$first':_0x297ae3(0x177)},'production_date':{'$first':_0x297ae3(0x1d6)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x297ae3(0x147)}}}]),_0x105a18=await product['find']({});if(_0x3cadbd[0x0][_0x297ae3(0x1ca)]=='English\x20(US)'){var _0x8056f6=users[_0x297ae3(0x1df)];console[_0x297ae3(0x193)](_0x8056f6);}else{if(_0x3cadbd[0x0]['language']=='Hindi')var _0x8056f6=users['Hindi'];else{if(_0x3cadbd[0x0]['language']==_0x297ae3(0x155))var _0x8056f6=users[_0x297ae3(0x155)];else{if(_0x3cadbd[0x0][_0x297ae3(0x1ca)]==_0x297ae3(0x16c))var _0x8056f6=users[_0x297ae3(0x16c)];else{if(_0x3cadbd[0x0][_0x297ae3(0x1ca)]==_0x297ae3(0x145))var _0x8056f6=users[_0x297ae3(0x145)];else{if(_0x3cadbd[0x0][_0x297ae3(0x1ca)]==_0x297ae3(0x181))var _0x8056f6=users[_0x297ae3(0x18c)];else{if(_0x3cadbd[0x0]['language']==_0x297ae3(0x189))var _0x8056f6=users[_0x297ae3(0x189)];else{if(_0x3cadbd[0x0][_0x297ae3(0x1ca)]==_0x297ae3(0x1ec))var _0x8056f6=users[_0x297ae3(0x170)];}}}}}}}_0x4a6036[_0x297ae3(0x178)]('edit_transfer_finished_view',{'success':_0x2de59a['flash'](_0x297ae3(0x169)),'errors':_0x2de59a[_0x297ae3(0x13f)]('errors'),'role':_0x1276f8,'profile':_0x441d62,'master_shop':_0x3cadbd,'warehouse':_0x482815,'transfer':_0x32e792,'stock':_0x1ee06b,'unit':_0x105a18,'language':_0x8056f6});}catch(_0x4f1eb5){console[_0x297ae3(0x193)](_0x4f1eb5);}}),router[a0_0x2e50f0(0x1ff)](a0_0x2e50f0(0x13e),auth,async(_0x46d9e1,_0x380b2c)=>{var _0x55a429=a0_0x2e50f0;try{const {invoice:_0x1ab58d,from_warehouse:_0x4fb331,FromRoom_name:_0x4b00e4,to_warehouse:_0x39c8a1,ToRoom_name:_0x45887c}=_0x46d9e1[_0x55a429(0x200)],_0x14d5ec=await transfers_finished[_0x55a429(0x17c)](_0x46d9e1[_0x55a429(0x171)]['id']),_0x4935f4=_0x14d5ec[_0x55a429(0x1f1)][_0x55a429(0x19e)](async _0x284cf2=>{var _0x3982cc=_0x55a429;if(_0x284cf2[_0x3982cc(0x1b1)]>0x0){var _0x317b7f=await warehouse['findOne']({'name':_0x4fb331,'room':_0x284cf2[_0x3982cc(0x1c5)]});const _0x4a920c=_0x317b7f[_0x3982cc(0x195)]['map'](_0x37adee=>{var _0x492aa8=_0x3982cc;_0x37adee['_id']==_0x284cf2[_0x492aa8(0x1a6)]&&(_0x37adee[_0x492aa8(0x1b4)]=Math[_0x492aa8(0x146)](0x0,Math[_0x492aa8(0x1c8)](_0x37adee[_0x492aa8(0x1b4)])-Math['abs'](_0x284cf2['to_quantity'])),console[_0x492aa8(0x193)](_0x37adee['product_stock']));});}return _0x317b7f;});Promise[_0x55a429(0x1a7)](_0x4935f4)[_0x55a429(0x1b6)](async _0x256e62=>{var _0x3d0fb4=_0x55a429;try{for(const _0x2af0e9 of _0x256e62){await _0x2af0e9[_0x3d0fb4(0x1fa)]();}const _0x3de760=_0x14d5ec[_0x3d0fb4(0x1f1)]['map'](async _0x51d7bd=>{var _0x173e68=_0x3d0fb4,_0x1a3ea0=await warehouse['findOne']({'name':_0x39c8a1,'room':_0x51d7bd[_0x173e68(0x1c4)]});if(_0x51d7bd[_0x173e68(0x1b1)]>0x0){var _0x187cf1=0x0;const _0x1a8ae4=_0x1a3ea0[_0x173e68(0x195)][_0x173e68(0x19e)](_0x5b0ece=>{var _0x4445b3=_0x173e68;_0x5b0ece[_0x4445b3(0x17e)]==_0x51d7bd[_0x4445b3(0x17e)]&&_0x5b0ece[_0x4445b3(0x157)]==_0x51d7bd['to_bay']&&_0x5b0ece[_0x4445b3(0x1db)]==_0x51d7bd[_0x4445b3(0x1db)]&&_0x5b0ece[_0x4445b3(0x1a4)]==_0x51d7bd[_0x4445b3(0x1a4)]&&_0x5b0ece[_0x4445b3(0x14b)]==_0x51d7bd[_0x4445b3(0x14b)]&&_0x5b0ece['invoice']==_0x51d7bd['To_invoice']&&(typeof _0x51d7bd['id_transaction']=='undefined'?(console[_0x4445b3(0x193)]('here2',_0x5b0ece['product_stock']+_0x4445b3(0x1d9)+_0x5b0ece['_id']+_0x4445b3(0x1f2)+Math[_0x4445b3(0x1c8)](_0x5b0ece['product_stock'])+Math[_0x4445b3(0x1c8)](_0x51d7bd[_0x4445b3(0x1b1)])),_0x5b0ece['product_stock']=Math['abs'](_0x5b0ece[_0x4445b3(0x1b4)])+Math[_0x4445b3(0x1c8)](_0x51d7bd[_0x4445b3(0x1b1)])):_0x5b0ece[_0x4445b3(0x1b4)]=Math['abs'](_0x5b0ece['product_stock'])+Math[_0x4445b3(0x1c8)](_0x51d7bd[_0x4445b3(0x1b1)]),_0x187cf1++);});_0x187cf1=='0'&&(_0x1a3ea0[_0x173e68(0x195)]=_0x1a3ea0[_0x173e68(0x195)][_0x173e68(0x197)]({'product_name':_0x51d7bd[_0x173e68(0x17e)],'product_stock':_0x51d7bd[_0x173e68(0x1b1)],'bay':_0x51d7bd[_0x173e68(0x1ba)],'level':_0x51d7bd[_0x173e68(0x18b)],'product_code':_0x51d7bd[_0x173e68(0x174)],'primary_code':_0x51d7bd['primary_code'],'secondary_code':_0x51d7bd[_0x173e68(0x15f)],'expiry_date':_0x51d7bd[_0x173e68(0x1db)],'production_date':_0x51d7bd[_0x173e68(0x1a4)],'maxProducts':_0x51d7bd[_0x173e68(0x1de)],'batch_code':_0x51d7bd[_0x173e68(0x14b)],'secondary_unit':_0x51d7bd[_0x173e68(0x19f)],'unit':_0x51d7bd['unit'],'maxProducts':_0x51d7bd['maxProducts'],'maxPerUnit':_0x51d7bd['maxPerUnit'],'invoice':_0x51d7bd[_0x173e68(0x141)]}));}return _0x1a3ea0;});Promise[_0x3d0fb4(0x1a7)](_0x3de760)['then'](async _0x46200c=>{var _0x185074=_0x3d0fb4;try{console[_0x185074(0x193)](_0x14d5ec['type_of_process']);if(_0x14d5ec[_0x185074(0x179)]!=_0x185074(0x1b0))for(const _0x5e0f39 of _0x46200c){await warehouse[_0x185074(0x1a8)]({'_id':_0x5e0f39['_id']},{'$addToSet':{'product_details':{'$each':_0x5e0f39[_0x185074(0x195)]}}});}_0x14d5ec[_0x185074(0x1d7)]=_0x185074(0x1c9);const _0x37de9d=await _0x14d5ec[_0x185074(0x1fa)](),_0x554e38=await master_shop['find'](),_0x2d1d07=await email_settings[_0x185074(0x137)](),_0x108f38=await supervisor_settings[_0x185074(0x1cf)]();var _0x4dd4e9=_0x14d5ec[_0x185074(0x1f1)],_0x4a4aed='',_0x4076f6;for(_0x4076f6 in _0x4dd4e9){var _0x1ce45d='FG';_0x14d5ec[_0x185074(0x149)]==_0x185074(0x15b)&&(_0x1ce45d='DG'),_0x4a4aed+='<tr>'+_0x185074(0x1ad)+_0x4dd4e9[_0x4076f6][_0x185074(0x17e)]+_0x185074(0x173)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4dd4e9[_0x4076f6][_0x185074(0x174)]+'</td>'+_0x185074(0x1ad)+_0x4dd4e9[_0x4076f6][_0x185074(0x1b1)]+_0x185074(0x173)+_0x185074(0x1ad)+_0x4dd4e9[_0x4076f6][_0x185074(0x1bb)]+_0x185074(0x173)+_0x185074(0x1ad)+_0x4dd4e9[_0x4076f6][_0x185074(0x19f)]+_0x185074(0x173)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x14d5ec[_0x185074(0x149)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4dd4e9[_0x4076f6][_0x185074(0x1c4)]+_0x185074(0x173)+_0x185074(0x1ad)+_0x1ce45d+_0x4dd4e9[_0x4076f6][_0x185074(0x1ba)]+_0x185074(0x173)+_0x185074(0x1e5);}_0x46d9e1[_0x185074(0x13f)](_0x185074(0x169),_0x185074(0x164)),_0x380b2c['redirect'](_0x185074(0x1c7)+_0x37de9d[_0x185074(0x14c)]);}catch(_0x378f4b){console['error'](_0x378f4b),_0x380b2c[_0x185074(0x15e)](0x1f4)[_0x185074(0x17a)]({'error':_0x185074(0x15c)});}})[_0x3d0fb4(0x1b9)](_0x2c438b=>{var _0x2e020b=_0x3d0fb4;console[_0x2e020b(0x1c1)](_0x2c438b),_0x380b2c[_0x2e020b(0x15e)](0x1f4)[_0x2e020b(0x17a)]({'error':_0x2e020b(0x1bd)});});}catch(_0x142094){console[_0x3d0fb4(0x1c1)](_0x142094),_0x380b2c[_0x3d0fb4(0x15e)](0x1f4)['json']({'error':_0x3d0fb4(0x1e6)});}})[_0x55a429(0x1b9)](_0x31de28=>{var _0x5613d4=_0x55a429;console[_0x5613d4(0x1c1)](_0x31de28),_0x380b2c[_0x5613d4(0x15e)](0x1f4)[_0x5613d4(0x17a)]({'error':_0x5613d4(0x1bd)});});}catch(_0x422aa5){_0x380b2c[_0x55a429(0x17a)]({'message':_0x422aa5[_0x55a429(0x1c6)]});}});function BayBinSelected(_0x57952b,_0x683a51){var _0x4f410f=a0_0x2e50f0,_0x1b5b92=[];let _0x376858=[];var _0x568ba4=[];if(_0x57952b=='DRY\x20GOODS'){switch(_0x683a51){case _0x4f410f(0x151):_0x1b5b92=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x4f410f(0x194):_0x1b5b92=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x568ba4=['DG'];}else{if(_0x57952b==_0x4f410f(0x13a)){switch(_0x683a51){case _0x4f410f(0x151):_0x1b5b92=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x4f410f(0x194):_0x1b5b92=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x568ba4=['FG'];}}return{'levels':_0x1b5b92,'identify':_0x568ba4};}router[a0_0x2e50f0(0x19d)](a0_0x2e50f0(0x1d0),auth,async(_0x124887,_0x2e4d85)=>{var _0x454298=a0_0x2e50f0;try{const {username:_0x334550,email:_0x556c4d,role:_0x3dc4db}=_0x124887[_0x454298(0x14e)],_0x123797=_0x124887[_0x454298(0x14e)],_0x3103af=await profile[_0x454298(0x137)]({'email':_0x123797[_0x454298(0x142)]}),_0x1654b7=await master_shop[_0x454298(0x1cf)](),_0x33614a=await transfers_finished[_0x454298(0x17c)](_0x124887[_0x454298(0x171)]['id']);let _0xd272c2=new Date(_0x33614a[_0x454298(0x1db)]),_0x2fc902=('0'+_0xd272c2['getDate']())[_0x454298(0x1ab)](-0x2),_0x5c5a8e=('0'+(_0xd272c2[_0x454298(0x175)]()+0x1))[_0x454298(0x1ab)](-0x2),_0x1726f6=_0xd272c2[_0x454298(0x1f7)](),_0x4cc13e=_0x1726f6+'-'+_0x5c5a8e+'-'+_0x2fc902,_0x1f6e99;if(_0x123797[_0x454298(0x1d1)]==_0x454298(0x1d4)){const _0x2d8253=await staff[_0x454298(0x137)]({'email':_0x123797[_0x454298(0x142)]});_0x1f6e99=await warehouse[_0x454298(0x1cf)]({'status':_0x454298(0x180),'name':_0x2d8253['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x1f6e99=await warehouse[_0x454298(0x1cf)]({'status':_0x454298(0x180),'warehouse_category':_0x454298(0x19b)});const _0x21435d=await warehouse[_0x454298(0x1a1)]([{'$match':{'name':_0x33614a['from_warehouse'],'room':_0x33614a['from_room']}},{'$unwind':_0x454298(0x167)},{'$group':{'_id':_0x454298(0x1e1),'name':{'$first':_0x454298(0x158)},'product_stock':{'$first':_0x454298(0x1e0)},'bay':{'$first':_0x454298(0x161)},'bin':{'$first':_0x454298(0x187)},'type':{'$first':_0x454298(0x17b)},'floorlevel':{'$first':_0x454298(0x1d8)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x454298(0x1c0)},'storage':{'$first':_0x454298(0x19a)},'rack':{'$first':_0x454298(0x16b)}}}]);var _0x6c6148=[0x1,0x2,0x3,0x4],_0x1608b8=['A','B','C','D','E','F','G','H','I','J'],_0xff9731=[_0x454298(0x199),'Enclosed'];const _0x56d69f=await product[_0x454298(0x1cf)]({}),_0x1714d4=BayBinSelected(_0x33614a[_0x454298(0x149)],_0x33614a[_0x454298(0x1a2)]);if(_0x1654b7[0x0][_0x454298(0x1ca)]==_0x454298(0x136)){var _0x50d8e4=users[_0x454298(0x1df)];console['log'](_0x50d8e4);}else{if(_0x1654b7[0x0][_0x454298(0x1ca)]==_0x454298(0x143))var _0x50d8e4=users[_0x454298(0x143)];else{if(_0x1654b7[0x0][_0x454298(0x1ca)]=='German')var _0x50d8e4=users[_0x454298(0x155)];else{if(_0x1654b7[0x0][_0x454298(0x1ca)]==_0x454298(0x16c))var _0x50d8e4=users['Spanish'];else{if(_0x1654b7[0x0][_0x454298(0x1ca)]=='French')var _0x50d8e4=users[_0x454298(0x145)];else{if(_0x1654b7[0x0]['language']==_0x454298(0x181))var _0x50d8e4=users[_0x454298(0x18c)];else{if(_0x1654b7[0x0]['language']==_0x454298(0x189))var _0x50d8e4=users[_0x454298(0x189)];else{if(_0x1654b7[0x0][_0x454298(0x1ca)]==_0x454298(0x1ec))var _0x50d8e4=users[_0x454298(0x170)];}}}}}}}_0x2e4d85[_0x454298(0x178)](_0x454298(0x1be),{'success':_0x124887[_0x454298(0x13f)](_0x454298(0x169)),'errors':_0x124887[_0x454298(0x13f)](_0x454298(0x1f6)),'role':_0x123797,'profile':_0x3103af,'master_shop':_0x1654b7,'warehouse':_0x1f6e99,'transfer':_0x33614a,'stock':_0x21435d,'unit':_0x56d69f,'language':_0x50d8e4,'levels':_0x6c6148,'Isle':_0x1608b8,'rooms_data':_0xff9731,'ed_fullDate':_0x4cc13e,'dataSelected':_0x1714d4});}catch(_0x329b3e){console[_0x454298(0x193)](_0x329b3e);}}),router[a0_0x2e50f0(0x1ff)]('/view/:id',auth,async(_0x2facc2,_0x27c01f)=>{var _0x9ab5bf=a0_0x2e50f0;try{const _0x3153c0=_0x2facc2[_0x9ab5bf(0x171)]['id'];console[_0x9ab5bf(0x193)](_0x2facc2['body']);const _0x19862d=await transfers_finished[_0x9ab5bf(0x17c)](_0x3153c0);console[_0x9ab5bf(0x193)](_0x9ab5bf(0x1ed),_0x19862d);const {date:_0x3eb985,from_warehouse:_0x50989a,FromRoom_name:_0x3c40c4,to_warehouse:_0x30044f,ToRoom_name:_0x7ee6d8,prod_name:_0x30947f,from_prod_qty:_0x51bc0b,from_prod_level:_0x2f81ca,from_prod_isle:_0x442558,from_prod_pallet:_0x782843,to_prod_qty:_0x53440e,to_prod_level:_0xd4c80e,to_prod_isle:_0x13bd8e,to_prod_pallet:_0x1ab340,primary_code:_0x403f2b,secondary_code:_0x3e775e,product_code3:_0x4798b9,note:_0x3d2e21,invoice:_0x4d7974,expiry_date:_0x5b4a66}=_0x2facc2[_0x9ab5bf(0x200)];if(typeof _0x30947f==_0x9ab5bf(0x16d))var _0x1f74d2=[_0x2facc2[_0x9ab5bf(0x200)]['prod_name']],_0x42e28d=[_0x2facc2['body']['from_prod_qty']],_0x1accf1=[_0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x15a)]],_0x392a20=[_0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x1b5)]],_0x20e0c4=[_0x2facc2[_0x9ab5bf(0x200)]['to_prod_level']],_0x2ff348=[_0x2facc2[_0x9ab5bf(0x200)]['primary_code']],_0x10d972=[_0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x15f)]],_0x114386=[_0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x19c)]],_0x11250e=[_0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x168)]],_0x17c346=[_0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x1bb)]],_0x1678eb=[_0x2facc2[_0x9ab5bf(0x200)]['secondary_unit']],_0x70e4fa=[_0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x14b)]],_0x5f56ba=[_0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x1db)]];else var _0x1f74d2=[..._0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x18d)]],_0x42e28d=[..._0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x17d)]],_0x1accf1=[..._0x2facc2[_0x9ab5bf(0x200)]['from_prod_level']],_0x392a20=[..._0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x1b5)]],_0x20e0c4=[..._0x2facc2[_0x9ab5bf(0x200)]['to_prod_level']],_0x2ff348=[..._0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x192)]],_0x10d972=[..._0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x15f)]],_0x114386=[..._0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x19c)]],_0x11250e=[..._0x2facc2['body'][_0x9ab5bf(0x168)]],_0x17c346=[..._0x2facc2[_0x9ab5bf(0x200)]['unit']],_0x1678eb=[..._0x2facc2['body'][_0x9ab5bf(0x19f)]],_0x70e4fa=[..._0x2facc2['body']['batch_code']],_0x5f56ba=[..._0x2facc2[_0x9ab5bf(0x200)][_0x9ab5bf(0x1db)]];const _0x3dc7a1=_0x1f74d2[_0x9ab5bf(0x19e)](_0xc65d33=>{return _0xc65d33={'product_name':_0xc65d33};});_0x42e28d[_0x9ab5bf(0x163)]((_0x3df6b4,_0x363d54)=>{_0x3dc7a1[_0x363d54]['from_quantity']=_0x3df6b4;}),_0x1accf1[_0x9ab5bf(0x163)]((_0x3440c1,_0x268d37)=>{var _0x5326aa=_0x9ab5bf;_0x3dc7a1[_0x268d37][_0x5326aa(0x17f)]=_0x3440c1;}),_0x392a20['forEach']((_0x8f68e,_0x290ae5)=>{var _0x5cd5a0=_0x9ab5bf;_0x3dc7a1[_0x290ae5][_0x5cd5a0(0x1b1)]=_0x8f68e;}),_0x20e0c4[_0x9ab5bf(0x163)]((_0x1a7b63,_0x338eda)=>{var _0x59fb49=_0x9ab5bf;_0x3dc7a1[_0x338eda][_0x59fb49(0x1ba)]=_0x1a7b63;}),_0x2ff348[_0x9ab5bf(0x163)]((_0x2fddae,_0x1bb71a)=>{var _0xddad13=_0x9ab5bf;_0x3dc7a1[_0x1bb71a][_0xddad13(0x192)]=_0x2fddae;}),_0x10d972[_0x9ab5bf(0x163)]((_0x29864b,_0x56979f)=>{var _0x27b4dd=_0x9ab5bf;_0x3dc7a1[_0x56979f][_0x27b4dd(0x15f)]=_0x29864b;}),_0x114386[_0x9ab5bf(0x163)]((_0x507354,_0xeec148)=>{var _0x5678db=_0x9ab5bf;_0x3dc7a1[_0xeec148][_0x5678db(0x174)]=_0x507354;}),_0x11250e[_0x9ab5bf(0x163)]((_0x44bb1a,_0x1ece71)=>{_0x3dc7a1[_0x1ece71]['maxProducts']=_0x44bb1a;}),_0x17c346['forEach']((_0x55c203,_0x3283f9)=>{var _0x5921aa=_0x9ab5bf;_0x3dc7a1[_0x3283f9][_0x5921aa(0x1bb)]=_0x55c203;}),_0x1678eb[_0x9ab5bf(0x163)]((_0x1f83df,_0x886fa0)=>{var _0x437cc8=_0x9ab5bf;_0x3dc7a1[_0x886fa0][_0x437cc8(0x19f)]=_0x1f83df;}),_0x70e4fa[_0x9ab5bf(0x163)]((_0x193886,_0x39197d)=>{var _0xcf9b43=_0x9ab5bf;_0x3dc7a1[_0x39197d][_0xcf9b43(0x14b)]=_0x193886;}),_0x5f56ba[_0x9ab5bf(0x163)]((_0x30b39a,_0x38611a)=>{var _0x18c21b=_0x9ab5bf;_0x3dc7a1[_0x38611a][_0x18c21b(0x1db)]=_0x30b39a;});const _0x34967d=_0x3dc7a1[_0x9ab5bf(0x1fe)](_0x3ac514=>_0x3ac514['to_quantity']!=='0'&&_0x3ac514[_0x9ab5bf(0x1b1)]!==''||_0x3ac514[_0x9ab5bf(0x1e9)]!=='0'&&_0x3ac514[_0x9ab5bf(0x1e9)]!=='');var _0x4c013c=0x0;_0x34967d['forEach'](_0x3747bc=>{var _0x301778=_0x9ab5bf;parseInt(_0x3747bc['from_quantity'])<parseInt(_0x3747bc[_0x301778(0x1b1)])&&_0x4c013c++;});if(_0x4c013c!=0x0)return _0x2facc2[_0x9ab5bf(0x13f)](_0x9ab5bf(0x1f6),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x27c01f[_0x9ab5bf(0x1cb)](_0x9ab5bf(0x1e7));const _0x2b578d=await warehouse['findOne']({'name':_0x19862d[_0x9ab5bf(0x1f3)],'room':_0x19862d[_0x9ab5bf(0x1e3)]});_0x19862d['product'][_0x9ab5bf(0x163)](_0x3bbc4d=>{var _0xe13413=_0x9ab5bf;if(_0x3bbc4d[_0xe13413(0x1b1)]>0x0){const _0x3e6d99=_0x2b578d['product_details'][_0xe13413(0x19e)](_0x2aeca8=>{var _0x641a94=_0xe13413;_0x2aeca8['product_name']==_0x3bbc4d[_0x641a94(0x17e)]&&_0x2aeca8['bay']==_0x3bbc4d['from_bay']&&(_0x2aeca8[_0x641a94(0x1b4)]=parseInt(_0x2aeca8[_0x641a94(0x1b4)])+parseInt(_0x3bbc4d[_0x641a94(0x1b1)]));});}}),await _0x2b578d[_0x9ab5bf(0x1fa)]();const _0x2f389c=await warehouse[_0x9ab5bf(0x137)]({'name':_0x19862d[_0x9ab5bf(0x149)],'room':_0x19862d['to_room']});_0x19862d[_0x9ab5bf(0x1f1)]['forEach'](_0x528567=>{var _0x228077=_0x9ab5bf;if(_0x528567[_0x228077(0x1b1)]>0x0){const _0x5579f2=_0x2f389c[_0x228077(0x195)][_0x228077(0x19e)](_0x247f0c=>{var _0x369b35=_0x228077;_0x247f0c[_0x369b35(0x17e)]==_0x528567['product_name']&&_0x247f0c[_0x369b35(0x157)]==_0x528567[_0x369b35(0x1ba)]&&(_0x247f0c[_0x369b35(0x1b4)]=parseInt(_0x247f0c[_0x369b35(0x1b4)])-parseInt(_0x528567[_0x369b35(0x1b1)]));});}}),await _0x2f389c['save'](),_0x19862d['date']=_0x3eb985,_0x19862d[_0x9ab5bf(0x1f3)]=_0x50989a,_0x19862d[_0x9ab5bf(0x149)]=_0x30044f,_0x19862d[_0x9ab5bf(0x1f1)]=_0x34967d,_0x19862d[_0x9ab5bf(0x190)]=_0x3d2e21,_0x19862d[_0x9ab5bf(0x159)]=_0x4d7974;const _0x56633e=await _0x19862d[_0x9ab5bf(0x1fa)](),_0x3b0d4b=await warehouse[_0x9ab5bf(0x137)]({'name':_0x50989a,'room':_0x3c40c4});_0x56633e[_0x9ab5bf(0x1f1)][_0x9ab5bf(0x163)](_0x5e8eff=>{var _0x4aeaed=_0x9ab5bf;if(_0x5e8eff['to_quantity']>0x0){const _0x97780b=_0x3b0d4b[_0x4aeaed(0x195)][_0x4aeaed(0x19e)](_0x50aa0f=>{var _0x56a4fb=_0x4aeaed;_0x50aa0f[_0x56a4fb(0x17e)]==_0x5e8eff[_0x56a4fb(0x17e)]&&_0x50aa0f[_0x56a4fb(0x157)]==_0x5e8eff[_0x56a4fb(0x17f)]&&(_0x50aa0f[_0x56a4fb(0x1b4)]=parseInt(_0x50aa0f['product_stock'])-parseInt(_0x5e8eff['to_quantity']));});}}),await _0x3b0d4b[_0x9ab5bf(0x1fa)]();const _0x276238=await warehouse[_0x9ab5bf(0x137)]({'name':_0x30044f,'room':_0x7ee6d8});_0x56633e[_0x9ab5bf(0x1f1)][_0x9ab5bf(0x163)](_0x3b1406=>{var _0x509c60=_0x9ab5bf;if(_0x3b1406['to_quantity']>0x0){var _0x6b60d8=0x0;const _0x343bfc=_0x276238['product_details'][_0x509c60(0x19e)](_0x4e1b3b=>{var _0x2fdd01=_0x509c60;_0x4e1b3b[_0x2fdd01(0x17e)]==_0x3b1406['product_name']&&_0x4e1b3b[_0x2fdd01(0x157)]==_0x3b1406['to_bay']&&(_0x4e1b3b[_0x2fdd01(0x1b4)]=parseInt(_0x4e1b3b[_0x2fdd01(0x1b4)])+parseInt(_0x3b1406[_0x2fdd01(0x1b1)]),_0x6b60d8++);});_0x6b60d8=='0'&&(_0x276238[_0x509c60(0x195)]=_0x276238[_0x509c60(0x195)]['concat']({'product_name':_0x3b1406[_0x509c60(0x17e)],'product_stock':_0x3b1406[_0x509c60(0x1b1)],'bay':_0x3b1406['to_bay'],'product_code':_0x3b1406['product_code'],'primary_code':_0x3b1406[_0x509c60(0x192)],'secondary_code':_0x3b1406[_0x509c60(0x15f)],'maxProducts':_0x3b1406['maxProducts']}));}}),await _0x276238[_0x9ab5bf(0x1fa)](),_0x2facc2['flash'](_0x9ab5bf(0x169),'Transfer\x20Edit\x20Successfully'),_0x27c01f['redirect'](_0x9ab5bf(0x182));}catch(_0x1f40bf){console[_0x9ab5bf(0x193)](_0x1f40bf);}}),router[a0_0x2e50f0(0x1ff)](a0_0x2e50f0(0x184),async(_0x794e6c,_0x483798)=>{var _0x451a84=a0_0x2e50f0;const {FromWareHouse:_0x211e0a,FromRoom:_0x4aaefa,ToWarehouse:_0x1aa242,ToRoom:_0x3c1770,primary_code:_0x112950,Roomslist:_0x3a94d8}=_0x794e6c[_0x451a84(0x200)],_0x205d53=_0x3a94d8['split'](','),_0x168503=[];async function _0x11138f(_0xd84ddd){var _0x709f86=_0x451a84;const _0x39934c=await warehouse[_0x709f86(0x1a1)]([{'$match':{'name':_0x211e0a,'room':_0xd84ddd}},{'$unwind':_0x709f86(0x167)},{'$match':{'product_details.primary_code':_0x112950}},{'$group':{'_id':_0x709f86(0x1e1),'name':{'$first':_0x709f86(0x158)},'instock':{'$first':_0x709f86(0x1e0)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x709f86(0x14d)},'product_code':{'$first':'$product_details.product_code'},'bay':{'$first':_0x709f86(0x161)},'level':{'$first':_0x709f86(0x1bc)},'type':{'$first':_0x709f86(0x17b)},'pallet':{'$first':_0x709f86(0x1d8)},'unit':{'$first':_0x709f86(0x166)},'secondary_unit':{'$first':_0x709f86(0x1f5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x709f86(0x16b)},'expiry_date':{'$first':_0x709f86(0x177)},'production_date':{'$first':_0x709f86(0x1d6)},'batch_code':{'$first':_0x709f86(0x154)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x709f86(0x162)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x709f86(0x1cd)}}}]),_0x334d55=await warehouse['aggregate']([{'$match':{'name':_0x211e0a,'room':_0xd84ddd}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x112950}},{'$group':{'_id':_0x709f86(0x1e1),'name':{'$first':_0x709f86(0x158)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x709f86(0x1a5)},'secondary_code':{'$first':_0x709f86(0x14d)},'product_code':{'$first':_0x709f86(0x1c0)},'bay':{'$first':_0x709f86(0x161)},'level':{'$first':'$product_details.level'},'type':{'$first':_0x709f86(0x17b)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x709f86(0x166)},'secondary_unit':{'$first':_0x709f86(0x1f5)},'storage':{'$first':_0x709f86(0x19a)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x709f86(0x177)},'production_date':{'$first':_0x709f86(0x1d6)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x709f86(0x1cd)}}}]);if(_0x39934c['length']>0x0)_0x168503[_0x709f86(0x1af)](_0x39934c);else _0x334d55[_0x709f86(0x1c2)]>0x0&&_0x168503['push'](_0x334d55);}const _0x21c268=_0x205d53['map'](_0x10a9ca=>_0x11138f(_0x10a9ca));await Promise[_0x451a84(0x1a7)](_0x21c268),_0x483798[_0x451a84(0x17a)](_0x168503);}),router[a0_0x2e50f0(0x1ff)](a0_0x2e50f0(0x14f),async(_0x587784,_0xa11fbd)=>{var _0x2ef680=a0_0x2e50f0;const {productCode:_0x276bd3,bay:_0x5eec07,warehouses:_0x53bd89,room:_0x1d5eb9}=_0x587784['body'];console['log'](_0x587784['body']);try{const _0x2b93db=await warehouse[_0x2ef680(0x1a1)]([{'$match':{'name':_0x53bd89,'room':_0x1d5eb9}},{'$unwind':_0x2ef680(0x167)},{'$match':{'product_details.bay':parseInt(_0x5eec07)}},{'$group':{'_id':_0x2ef680(0x1e1),'name':{'$first':_0x2ef680(0x158)},'product_stock':{'$first':_0x2ef680(0x1e0)},'bay':{'$first':_0x2ef680(0x161)},'maxProducts':{'$first':_0x2ef680(0x1e2)}}}]);_0xa11fbd['status'](0xc8)[_0x2ef680(0x17a)](_0x2b93db);}catch(_0x410c18){_0xa11fbd[_0x2ef680(0x15e)](0x194)['json']({'message':_0x410c18[_0x2ef680(0x1c6)]});}}),module[a0_0x2e50f0(0x1d2)]=router;function a0_0x371d(){var _0x325d5d=['MaxStocks_data2','success','1174702atrEyu','$product_details.rack','Spanish','string','random','../middleware/auth','Arabic','params','to_prod_level','</td>','product_code','getMonth','../public/language/languages.json','$product_details.expiry_date','render','type_of_process','json','$product_details.type','findById','from_prod_qty','product_name','from_bay','Enabled','Portuguese\x20(BR)','/transfer_finished/view','transfer_finished_logs','/barcode_scanner','/transfer/view','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.bin','/view/add_transfer_loc','Chinese','7778575AbfcMa','to_level','Portuguese','prod_name','3344985xsrlmB','530GcjFEn','note','6mOtUWg','primary_code','log','Rack\x202','product_details','express','concat','invoice_init','Ambient','$product_details.storage','Finished\x20Goods','product_code3','get','map','secondary_unit','$_id','aggregate','to_room','bin2bin','production_date','$product_details.primary_code','id_transaction','all','updateOne','TRFF-','primary_unit','slice','own','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','from_invoice','push','location2location','to_quantity','/transfer_finished/preview/','$product','product_stock','to_prod_qty','then','maxPerUnit','$product.from_room_name','catch','to_bay','unit','$product_details.level','An\x20error\x20occurred.','edit_transfer_finished','nodemailer','$product_details.product_code','error','length','transfer_finished','to_room_name','from_room_name','message','/picking_list/PDF_transfer/','abs','True','language','redirect','1767gdZVnL','$product_details.invoice','/view/add_transfer','find','/view/:id','role','exports','TRF-','staff','362659hQNclu','$product_details.production_date','finalize','$product_details.floorlevel','\x20<>\x20','8mWBEdH','expiry_date','ToRoomAssigned','../models/all_models','maxProducts','English','$product_details.product_stock','$product_details._id','$product_details.maxProducts','from_room','padStart','</tr>','An\x20error\x20occurred\x20while\x20saving\x20data.','back','There\x27s\x20a\x20error\x20in\x20this\x20transaction','to_floorlevel','Product\x20Transfer\x20successfully','/view/choose_logs','Arabic\x20(ae)','transfer_data','$date','/view/choose','1842985AXhTET','product','\x20<=>\x20','from_warehouse','from_prod_level2','$product_details.secondary_unit','errors','getFullYear','$product.to_room_name','New_Qty_Converted','save','warehouse','RoomAssigned','toString','filter','post','body','$to_warehouse','English\x20(US)','findOne','1295113oYCXHO','logs','FROZEN\x20GOODS','$from_warehouse','/view_logs','prod_cat','/preview/:id','flash','choos_transfer_logs','To_invoice','email','Hindi','match','French','max','$name','MaxStocks_data','to_warehouse','from_level','batch_code','_id','$product_details.secondary_code','user','/CheckingWarehouse','$invoice','Rack\x201','add_transfer_finished','LOG-TRF-','$product_details.batch_code','German','$finalize','bay','$product_details.product_name','invoice','from_prod_level','DRY\x20GOODS','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','from_quantity','status','secondary_code','product_date','$product_details.bay','$room','forEach','Transfer\x20Finalize\x20Successfully','2792oGlVwu','$product_details.unit','$product_details'];a0_0x371d=function(){return _0x325d5d;};return a0_0x371d();}