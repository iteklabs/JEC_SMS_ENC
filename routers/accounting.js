function a0_0x4e0e(){const _0x5ee76f=['flash','Arabic','$member','9667364zeUzlv','</tbody>','ObjectId','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','accounting_discount','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','product_name','findOne','<span>\x20Requested\x20By:\x20<b>','English','9306243rZBekc','accounting_approval','</table>','redirect','accounting_account_date','<div>','headers','\x22>Change\x20Status</a>','back','unit','<h2>\x20JEC\x20SMS\x20</h2>','Sales\x20Order\x20is\x20changed\x20status','$account_data','language','save','Chinese','$warehouse_staff_id','</thead>','Types','name','date','12ujApBY','../public/language/languages.json','post','wms_data','$member.name','</td>','find','prod_id','</head><body>','exports','Portuguese','length','/view_sales_order/:id','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','</body></html>','/accounting_approval/view_sales_order/','valueOf','warehouse_staff_id','</b></span>\x20<br><br>','account_data','invoice','params','wms_account_id','</tr>','user','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_code','xlsx','No\x20Approvers\x20Set\x20Please\x20contact\x20admin\x20to\x20setup','body','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','../middleware/auth','render','sale_product','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<span>\x20Request\x20ID:\x20<b>','host','<h5>\x20JEC\x20SMS\x20</h5>','English\x20(US)','<span>\x20Dear\x20<b>','quantity','<br><br>','Arabic\x20(ae)','errors','warehouse_info','/:id','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','nodemailer','string','aggregate','6190135jWIbut','accounting_account_id','accounting_account_confirm','/warehouse_approval/','mongoose','33275260WYUHZR','<tr>','get','$wms_data','<br><br><span>\x20The\x20total\x20quantity\x20for\x20these\x20items\x20is\x20<b>','toLocaleDateString','</b>.\x20These\x20products\x20are\x20essential\x20to\x20improve\x20our\x20warehouse\x20efficiency\x20and\x20ensure\x20smooth\x20operations.\x20</span>','Router','findById','/../public','forEach','Spanish','password','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','Portuguese\x20(BR)','email','<html><head><title></title>','christian.villamer@jakagroup.com','French','createTransport','$wms_account_id','express','<tbody\x20style=\x22text-align:\x20center;\x22>','staffs','Hindi','6VuAGoX','success','<a\x20style=\x22background-color:\x20#007bff;\x20color:\x20#ffffff;\x20border:\x20none;\x20padding:\x2010px\x2020px;\x20border-radius:\x205px;\x22\x20href=\x22','958068IPZEbE','port','German','<hr\x20class=\x22my-3\x22>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','log','map','<span>\x20Request\x20Date:\x20<b>','11795528ilkaSI','<!DOCTYPE\x20html>','://','</b>,\x20</span><br>','../models/all_models','40FxjdDf','logo','updateOne','<div\x20style=\x22text-align:\x20center;\x22>','72208FGPHUW','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','exceljs','$warehouse_info','_id'];a0_0x4e0e=function(){return _0x5ee76f;};return a0_0x4e0e();}const a0_0x2ff8a0=a0_0x1871;(function(_0x225bcc,_0x1e45ad){const _0x272789=a0_0x1871,_0x19794b=_0x225bcc();while(!![]){try{const _0x189b08=parseInt(_0x272789(0x14c))/0x1*(-parseInt(_0x272789(0x148))/0x2)+-parseInt(_0x272789(0x174))/0x3*(parseInt(_0x272789(0x13b))/0x4)+-parseInt(_0x272789(0x11a))/0x5+-parseInt(_0x272789(0x138))/0x6*(parseInt(_0x272789(0x155))/0x7)+parseInt(_0x272789(0x143))/0x8+parseInt(_0x272789(0x15f))/0x9+parseInt(_0x272789(0x11f))/0xa;if(_0x189b08===_0x1e45ad)break;else _0x19794b['push'](_0x19794b['shift']());}catch(_0x2cb1d4){_0x19794b['push'](_0x19794b['shift']());}}}(a0_0x4e0e,0xc6e5f));function a0_0x1871(_0x21b7b2,_0x436392){const _0x4e0ee1=a0_0x4e0e();return a0_0x1871=function(_0x18716c,_0x32e41a){_0x18716c=_0x18716c-0xf2;let _0x174f56=_0x4e0ee1[_0x18716c];return _0x174f56;},a0_0x1871(_0x21b7b2,_0x436392);}const express=require(a0_0x2ff8a0(0x134)),app=express(),router=express[a0_0x2ff8a0(0x126)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings}=require(a0_0x2ff8a0(0x147)),auth=require(a0_0x2ff8a0(0x107)),users=require(a0_0x2ff8a0(0x175)),excelJS=require(a0_0x2ff8a0(0x14f)),xlsx=require(a0_0x2ff8a0(0x103)),mongoose=require(a0_0x2ff8a0(0x11e)),{ObjectId}=require('mongodb'),nodemailer=require(a0_0x2ff8a0(0x117));router[a0_0x2ff8a0(0x121)]('/:id',auth,async(_0x539831,_0x54235e)=>{const _0x25dcc3=a0_0x2ff8a0;try{const _0x284a2b=await master_shop[_0x25dcc3(0x17a)](),_0x4195f7=_0x539831[_0x25dcc3(0x100)],_0x87ab73=await profile[_0x25dcc3(0x15c)]({'email':_0x4195f7['email']}),_0x53f658=await staff[_0x25dcc3(0x15c)]({'email':_0x4195f7[_0x25dcc3(0x12e)]}),_0x257716=await customer[_0x25dcc3(0x17a)]({'agent_id':_0x53f658['_id']}),_0x373459=mongoose[_0x25dcc3(0x171)]['ObjectId'],_0x177c74=_0x539831[_0x25dcc3(0xfd)]['id'],_0x3ef0c6=await sales_order[_0x25dcc3(0x127)](_0x177c74),_0x3c9955=await sales_order[_0x25dcc3(0x119)]([{'$match':{'_id':_0x373459(_0x177c74)}},{'$addFields':{'accounting_account_id':{'$toObjectId':'$accounting_account_id'}}},{'$addFields':{'wms_account_id':{'$toObjectId':'$wms_account_id'}}},{'$lookup':{'from':_0x25dcc3(0x136),'localField':_0x25dcc3(0x11b),'foreignField':_0x25dcc3(0x151),'as':_0x25dcc3(0xfb)}},{'$unwind':'$account_data'},{'$lookup':{'from':_0x25dcc3(0x136),'localField':_0x25dcc3(0xfe),'foreignField':_0x25dcc3(0x151),'as':_0x25dcc3(0x177)}},{'$unwind':{'path':_0x25dcc3(0x122),'preserveNullAndEmptyArrays':!![]}}]);if(_0x284a2b[0x0][_0x25dcc3(0x16c)]=='English\x20(US)')var _0x3db87c=users[_0x25dcc3(0x15e)];else{if(_0x284a2b[0x0][_0x25dcc3(0x16c)]==_0x25dcc3(0x137))var _0x3db87c=users['Hindi'];else{if(_0x284a2b[0x0]['language']==_0x25dcc3(0x13d))var _0x3db87c=users[_0x25dcc3(0x13d)];else{if(_0x284a2b[0x0][_0x25dcc3(0x16c)]==_0x25dcc3(0x12a))var _0x3db87c=users['Spanish'];else{if(_0x284a2b[0x0][_0x25dcc3(0x16c)]==_0x25dcc3(0x131))var _0x3db87c=users[_0x25dcc3(0x131)];else{if(_0x284a2b[0x0][_0x25dcc3(0x16c)]=='Portuguese\x20(BR)')var _0x3db87c=users['Portuguese'];else{if(_0x284a2b[0x0]['language']==_0x25dcc3(0x16e))var _0x3db87c=users[_0x25dcc3(0x16e)];else{if(_0x284a2b[0x0][_0x25dcc3(0x16c)]==_0x25dcc3(0x112))var _0x3db87c=users[_0x25dcc3(0x153)];}}}}}}}_0x54235e['render'](_0x25dcc3(0x160),{'success':_0x539831[_0x25dcc3(0x152)](_0x25dcc3(0x139)),'errors':_0x539831[_0x25dcc3(0x152)](_0x25dcc3(0x113)),'master_shop':_0x284a2b,'profile':_0x87ab73,'role':_0x4195f7,'language':_0x3db87c,'customer':_0x257716,'sales_sa':_0x3ef0c6,'approvers':_0x3c9955[0x0],'the_id':_0x177c74});}catch(_0x110aa1){console[_0x25dcc3(0x140)](_0x110aa1);}}),router[a0_0x2ff8a0(0x176)](a0_0x2ff8a0(0x115),auth,async(_0x552e3f,_0x22b339)=>{const _0x348e41=a0_0x2ff8a0;try{const {accounting_discount:_0x17b0d8,accounting_confirm:_0x48d73f,wms_confirm:_0x17cf70,the_id_val:_0x1008c5,invoice:_0x6533a3,prod_id:_0x2bbbbb}=_0x552e3f[_0x348e41(0x105)],_0x477f01=await sales_order[_0x348e41(0x127)](_0x1008c5),_0x46bf43=_0x552e3f['user'],_0x455d2d=await staff[_0x348e41(0x15c)]({'email':_0x46bf43['email']});if(typeof _0x2bbbbb==_0x348e41(0x118))var _0x3d83e7=[_0x552e3f['body']['prod_id']],_0x525528=[_0x552e3f[_0x348e41(0x105)][_0x348e41(0x159)]];else var _0x3d83e7=[..._0x552e3f[_0x348e41(0x105)][_0x348e41(0x17b)]],_0x525528=[..._0x552e3f[_0x348e41(0x105)][_0x348e41(0x159)]];const _0x53ad2a=await approver_acct['aggregate']([{'$unwind':_0x348e41(0x154)},{'$match':{'head_id_staff':_0x552e3f[_0x348e41(0x100)]['sttaff_id']}},{'$group':{'_id':{'id_member':'$member.id_member','name':_0x348e41(0x178)},'warehouse_staff_id':{'$first':_0x348e41(0x16f)}}},{'$addFields':{'warehouse_staff_id':{'$toObjectId':_0x348e41(0x16f)}}},{'$lookup':{'from':'staffs','localField':_0x348e41(0xf9),'foreignField':_0x348e41(0x151),'as':'warehouse_info'}},{'$unwind':_0x348e41(0x150)}]);if(_0x53ad2a[_0x348e41(0xf3)]==0x0)return _0x552e3f['flash'](_0x348e41(0x113),_0x348e41(0x104)),_0x22b339[_0x348e41(0x162)](_0x348e41(0x167));const _0x2fc509=_0x3d83e7[_0x348e41(0x141)](_0xa6864a=>{return _0xa6864a={'prod_id':_0xa6864a};});_0x525528[_0x348e41(0x129)]((_0x4ab638,_0x26081f)=>{_0x2fc509[_0x26081f]['accounting_discount']=_0x4ab638;});for(let _0x44ca47=0x0;_0x44ca47<=_0x477f01['sale_product']['length']-0x1;_0x44ca47++){const _0x274884=_0x477f01[_0x348e41(0x109)][_0x44ca47];for(let _0x4ad689=0x0;_0x4ad689<=_0x2fc509[_0x348e41(0xf3)]-0x1;_0x4ad689++){const _0x4875d6=_0x2fc509[_0x4ad689];_0x274884[_0x348e41(0x151)][_0x348e41(0xf8)]()==_0x4875d6[_0x348e41(0x17b)]&&await sales_order[_0x348e41(0x14a)]({'_id':_0x1008c5,'sale_product._id':_0x4875d6[_0x348e41(0x17b)]},{'$set':{'sale_product.$.accounting_discount':_0x4875d6[_0x348e41(0x159)]}});}}const _0x4630bc=new Date(),_0x44a1b3=_0x4630bc[_0x348e41(0x124)]();_0x477f01[_0x348e41(0x11c)]=_0x48d73f,_0x477f01[_0x348e41(0x163)]=_0x44a1b3,_0x477f01['wms_account_id']=_0x53ad2a[0x0][_0x348e41(0x114)][_0x348e41(0x151)],await _0x477f01[_0x348e41(0x16d)]();const _0x1337e8=await master_shop['find'](),_0x517585=await email_settings['findOne']();let _0x377509=nodemailer[_0x348e41(0x132)]({'host':_0x517585[_0x348e41(0x10c)],'port':Number(_0x517585[_0x348e41(0x13c)]),'secure':![],'auth':{'user':_0x517585[_0x348e41(0x12e)],'pass':_0x517585[_0x348e41(0x12b)]}});const _0x14ae03=_0x552e3f['protocol']+_0x348e41(0x145)+_0x552e3f[_0x348e41(0x165)][_0x348e41(0x10c)];var _0x25f1d4=_0x477f01[_0x348e41(0x109)],_0x4a0402='',_0x5d866a,_0x1fb37c=0x0;for(_0x5d866a in _0x25f1d4){_0x4a0402+=_0x348e41(0x120)+_0x348e41(0x13f)+_0x25f1d4[_0x5d866a][_0x348e41(0x15b)]+_0x348e41(0x179)+_0x348e41(0x13f)+_0x25f1d4[_0x5d866a][_0x348e41(0x102)]+'</td>'+_0x348e41(0x13f)+_0x25f1d4[_0x5d866a][_0x348e41(0x110)]+_0x348e41(0x179)+_0x348e41(0x13f)+_0x25f1d4[_0x5d866a][_0x348e41(0x168)]+_0x348e41(0x179)+_0x348e41(0xff),_0x1fb37c+=parseInt(_0x25f1d4[_0x5d866a][_0x348e41(0x110)]);}let _0x395e1c={'from':_0x517585[_0x348e41(0x12e)],'to':_0x348e41(0x130),'subject':'Approval\x20for\x20'+_0x477f01['invoice'],'attachments':[{'filename':'Logo.png','path':__dirname+_0x348e41(0x128)+'/upload/'+_0x1337e8[0x0]['image'],'cid':_0x348e41(0x149)}],'html':_0x348e41(0x144)+_0x348e41(0x12f)+_0x348e41(0x116)+_0x348e41(0x17c)+_0x348e41(0x164)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x348e41(0x164)+_0x348e41(0x15a)+_0x348e41(0x14d)+_0x348e41(0x164)+_0x348e41(0x169)+'</div>'+'</div>'+_0x348e41(0x13e)+_0x348e41(0x164)+_0x348e41(0x10f)+_0x53ad2a[0x0][_0x348e41(0x114)][_0x348e41(0x172)]+_0x348e41(0x146)+_0x348e41(0x14d)+_0x348e41(0x164)+_0x348e41(0x106)+'</div>'+_0x348e41(0x164)+_0x348e41(0x10b)+_0x477f01[_0x348e41(0xfc)]+'</b></span>\x20<br>'+_0x348e41(0x15d)+_0x455d2d[_0x348e41(0x172)]+'</b></span>\x20<br>'+_0x348e41(0x142)+_0x477f01[_0x348e41(0x173)]+_0x348e41(0xfa)+_0x348e41(0x14d)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x348e41(0x10a)+'<tr>'+_0x348e41(0x14e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x348e41(0x101)+_0x348e41(0xff)+_0x348e41(0x170)+_0x348e41(0x135)+'\x20'+_0x4a0402+'\x20'+_0x348e41(0x156)+_0x348e41(0x161)+_0x348e41(0x164)+_0x348e41(0x123)+_0x1fb37c+_0x348e41(0x125)+_0x348e41(0x12c)+_0x348e41(0xf5)+'<br><br><br>'+_0x348e41(0x14d)+_0x348e41(0x14b)+_0x348e41(0x13a)+_0x14ae03+_0x348e41(0x11d)+_0x477f01[_0x348e41(0x151)]+_0x348e41(0x166)+_0x348e41(0x111)+_0x348e41(0x14d)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x348e41(0x10d)+'</div>'+'</div>'+_0x348e41(0x158)+_0x348e41(0xf6)};_0x377509['sendMail'](_0x395e1c,function(_0x262b99,_0x273516){const _0x1f7604=_0x348e41;_0x262b99?(console[_0x1f7604(0x140)](_0x262b99),console[_0x1f7604(0x140)]('Error\x20Occurs')):console[_0x1f7604(0x140)]('Email\x20sent\x20successfully');}),_0x552e3f[_0x348e41(0x152)]('success',_0x348e41(0x16a)),_0x22b339[_0x348e41(0x162)](_0x348e41(0xf7)+_0x477f01[_0x348e41(0x151)]);}catch(_0x780338){}}),router[a0_0x2ff8a0(0x121)](a0_0x2ff8a0(0xf4),auth,async(_0x272046,_0x14d89a)=>{const _0xa48537=a0_0x2ff8a0;try{const _0x292719=await master_shop[_0xa48537(0x17a)](),_0x4a21d4=_0x272046['user'],_0x4d0cc9=await profile[_0xa48537(0x15c)]({'email':_0x4a21d4[_0xa48537(0x12e)]}),_0x498a6e=await staff[_0xa48537(0x15c)]({'email':_0x4a21d4['email']}),_0x53625f=await customer[_0xa48537(0x17a)]({'agent_id':_0x498a6e[_0xa48537(0x151)]}),_0x1fa8af=mongoose[_0xa48537(0x171)][_0xa48537(0x157)],_0x363ab4=_0x272046[_0xa48537(0xfd)]['id'],_0x1327e0=await sales_order['findById'](_0x363ab4),_0x565ab5=await sales_order[_0xa48537(0x119)]([{'$match':{'_id':_0x1fa8af(_0x363ab4)}},{'$addFields':{'accounting_account_id':{'$toObjectId':'$accounting_account_id'}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0xa48537(0x133)}}},{'$lookup':{'from':'staffs','localField':'accounting_account_id','foreignField':'_id','as':'account_data'}},{'$unwind':_0xa48537(0x16b)},{'$lookup':{'from':_0xa48537(0x136),'localField':'wms_account_id','foreignField':'_id','as':'wms_data'}},{'$unwind':_0xa48537(0x122)}]);if(_0x292719[0x0]['language']==_0xa48537(0x10e))var _0x288d30=users[_0xa48537(0x15e)];else{if(_0x292719[0x0][_0xa48537(0x16c)]=='Hindi')var _0x288d30=users[_0xa48537(0x137)];else{if(_0x292719[0x0]['language']=='German')var _0x288d30=users['German'];else{if(_0x292719[0x0][_0xa48537(0x16c)]==_0xa48537(0x12a))var _0x288d30=users[_0xa48537(0x12a)];else{if(_0x292719[0x0][_0xa48537(0x16c)]==_0xa48537(0x131))var _0x288d30=users[_0xa48537(0x131)];else{if(_0x292719[0x0][_0xa48537(0x16c)]=='Portuguese\x20(BR)')var _0x288d30=users[_0xa48537(0xf2)];else{if(_0x292719[0x0][_0xa48537(0x16c)]==_0xa48537(0x16e))var _0x288d30=users[_0xa48537(0x16e)];else{if(_0x292719[0x0][_0xa48537(0x16c)]==_0xa48537(0x112))var _0x288d30=users['Arabic'];}}}}}}}_0x14d89a[_0xa48537(0x108)]('view_accounting_approval',{'success':_0x272046[_0xa48537(0x152)]('success'),'errors':_0x272046[_0xa48537(0x152)](_0xa48537(0x113)),'master_shop':_0x292719,'profile':_0x4d0cc9,'role':_0x4a21d4,'language':_0x288d30,'customer':_0x53625f,'sales_sa':_0x1327e0,'approvers':_0x565ab5[0x0],'the_id':_0x363ab4});}catch(_0x1ef8fb){console[_0xa48537(0x140)](_0x1ef8fb);}}),router[a0_0x2ff8a0(0x121)]('/data/All',auth,async(_0x39cdee,_0x1d03fa)=>{const _0xcdbca9=a0_0x2ff8a0;try{const {sttaff_id:_0x2c2ce3,email:_0x403b30,warehouse:_0x40023a}=_0x39cdee[_0xcdbca9(0x100)],_0x2221ae=await master_shop[_0xcdbca9(0x17a)](),_0x4d3fd9=_0x39cdee[_0xcdbca9(0x100)],_0x433354=await profile[_0xcdbca9(0x15c)]({'email':_0x4d3fd9[_0xcdbca9(0x12e)]}),_0x344625=await sales_order[_0xcdbca9(0x17a)]({'accounting_account_id':_0x2c2ce3});if(_0x2221ae[0x0]['language']==_0xcdbca9(0x10e))var _0x69199b=users['English'];else{if(_0x2221ae[0x0][_0xcdbca9(0x16c)]=='Hindi')var _0x69199b=users[_0xcdbca9(0x137)];else{if(_0x2221ae[0x0]['language']==_0xcdbca9(0x13d))var _0x69199b=users[_0xcdbca9(0x13d)];else{if(_0x2221ae[0x0]['language']==_0xcdbca9(0x12a))var _0x69199b=users[_0xcdbca9(0x12a)];else{if(_0x2221ae[0x0][_0xcdbca9(0x16c)]=='French')var _0x69199b=users['French'];else{if(_0x2221ae[0x0][_0xcdbca9(0x16c)]==_0xcdbca9(0x12d))var _0x69199b=users[_0xcdbca9(0xf2)];else{if(_0x2221ae[0x0][_0xcdbca9(0x16c)]=='Chinese')var _0x69199b=users[_0xcdbca9(0x16e)];else{if(_0x2221ae[0x0][_0xcdbca9(0x16c)]==_0xcdbca9(0x112))var _0x69199b=users['Arabic'];}}}}}}}_0x1d03fa['render']('accounting_approval_All',{'success':_0x39cdee['flash'](_0xcdbca9(0x139)),'errors':_0x39cdee[_0xcdbca9(0x152)]('errors'),'master_shop':_0x2221ae,'profile':_0x433354,'role':_0x4d3fd9,'language':_0x69199b,'sales_order':_0x344625});}catch(_0x16bed1){}}),module[a0_0x2ff8a0(0x17d)]=router;