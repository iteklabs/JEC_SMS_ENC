const a0_0x33bf20=a0_0x5bdd;(function(_0x21f009,_0x36eccd){const _0x5d158b=a0_0x5bdd,_0x3d26bd=_0x21f009();while(!![]){try{const _0x21e98e=-parseInt(_0x5d158b(0xec))/0x1*(-parseInt(_0x5d158b(0xeb))/0x2)+-parseInt(_0x5d158b(0xda))/0x3+-parseInt(_0x5d158b(0xe1))/0x4*(parseInt(_0x5d158b(0xe3))/0x5)+parseInt(_0x5d158b(0xfc))/0x6+parseInt(_0x5d158b(0xcd))/0x7*(parseInt(_0x5d158b(0x108))/0x8)+-parseInt(_0x5d158b(0xdf))/0x9+parseInt(_0x5d158b(0xdc))/0xa;if(_0x21e98e===_0x36eccd)break;else _0x3d26bd['push'](_0x3d26bd['shift']());}catch(_0x3aaf54){_0x3d26bd['push'](_0x3d26bd['shift']());}}}(a0_0x5b54,0x611d2));const express=require(a0_0x33bf20(0xd6)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x33bf20(0xf9));function a0_0x5bdd(_0xafdb51,_0x4bd6f6){const _0x5b543a=a0_0x5b54();return a0_0x5bdd=function(_0x5bdd22,_0x305159){_0x5bdd22=_0x5bdd22-0xc9;let _0x3431cb=_0x5b543a[_0x5bdd22];return _0x3431cb;},a0_0x5bdd(_0xafdb51,_0x4bd6f6);}router['get'](a0_0x33bf20(0xce),async(_0x1773da,_0x1d3fa7)=>{const _0x398d9d=a0_0x33bf20;try{const _0x4d5e68=await warehouse[_0x398d9d(0xf4)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x1d3fa7['json']({'status':_0x4d5e68[_0x398d9d(0xde)]+_0x398d9d(0x101)});}catch(_0x2df4d9){console[_0x398d9d(0xf1)](_0x398d9d(0x107),_0x2df4d9),_0x1d3fa7[_0x398d9d(0xd8)](0xc8)['json']({'message':_0x2df4d9['message']});}}),router[a0_0x33bf20(0xfa)](a0_0x33bf20(0xf5),async(_0x2893f3,_0x53a921)=>{const _0x3c86b9=a0_0x33bf20;try{const _0x2b745d=await warehouse[_0x3c86b9(0xf2)]([{'$unwind':_0x3c86b9(0xdd)},{'$match':{'product_details.invoice':_0x3c86b9(0xcb),'product_details.primary_code':_0x3c86b9(0xd3)}},{'$group':{'_id':{'name':_0x3c86b9(0x100),'room':_0x3c86b9(0x109)},'products':{'$push':_0x3c86b9(0xdd)}}}]);_0x53a921['json'](_0x2b745d);}catch(_0x5064d0){console['log']('table\x20page',_0x5064d0),_0x53a921[_0x3c86b9(0xd8)](0xc8)[_0x3c86b9(0xf6)]({'message':_0x5064d0[_0x3c86b9(0xca)]});}}),router[a0_0x33bf20(0xfa)](a0_0x33bf20(0xee),async(_0x5ab433,_0xf22ae7)=>{const _0x9684db=a0_0x33bf20;_0xf22ae7['render']('monitor',{'success':_0x5ab433[_0x9684db(0xd2)]('success'),'errors':_0x5ab433[_0x9684db(0xd2)](_0x9684db(0xd9))});}),router['get']('/join',async(_0x432fe3,_0x18933c)=>{const _0xffe2e5=a0_0x33bf20;var _0x8f3f4e=await purchases[_0xffe2e5(0xf2)]([{'$lookup':{'from':_0xffe2e5(0xea),'let':{'invoice':_0xffe2e5(0xd0)},'pipeline':[{'$unwind':_0xffe2e5(0xdd)},{'$match':{'$expr':{'$eq':['$$invoice',_0xffe2e5(0xf7)]}}},{'$project':{'_id':'$product_details._id','product_name':_0xffe2e5(0xd7),'product_code':'$product_details.product_code','quantity_available':_0xffe2e5(0xc9),'warehouse_name':'$name','warehouse_room':_0xffe2e5(0x109),'invoice':_0xffe2e5(0xf7)}}],'as':'warehouse_data'}}]);_0x8f3f4e[_0xffe2e5(0xdb)]={},await Promise[_0xffe2e5(0xe9)](_0x8f3f4e['map'](async _0x1d27eb=>{const _0x2c20e0=_0xffe2e5;_0x8f3f4e[_0x2c20e0(0xdb)][_0x1d27eb[_0x2c20e0(0xfe)]]=[],await Promise[_0x2c20e0(0xe9)](_0x1d27eb['warehouse_data']['map'](async _0xa5c89e=>{const _0x4609a6=_0x2c20e0,_0x648592=await sales[_0x4609a6(0xf2)]([{'$unwind':_0x4609a6(0xfd)},{'$match':{'sale_product.id_transaction_from':_0xa5c89e[_0x4609a6(0xcf)][_0x4609a6(0xe5)](),'sale_product.invoice':_0xa5c89e[_0x4609a6(0xfe)]}},{'$project':{'_id':_0x4609a6(0xe8),'product_name':'$sale_product.product_name','product_code':_0x4609a6(0xe0),'quantity_available':_0x4609a6(0xe6),'warehouse_name':'$warehouse_name','warehouse_room':_0x4609a6(0xe2),'product_invoice':'$sale_product.invoice','invoice':_0x4609a6(0xd0),'id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x648592[_0x4609a6(0xf3)]>0x0&&_0x8f3f4e[_0x4609a6(0xdb)][_0x1d27eb[_0x4609a6(0xfe)]][_0x4609a6(0x105)](..._0x648592);}));})),_0x8f3f4e[_0xffe2e5(0xdb)]=_0x8f3f4e[_0xffe2e5(0xdb)],_0x8f3f4e[_0xffe2e5(0xe4)]={},await Promise[_0xffe2e5(0xe9)](_0x8f3f4e['map'](async _0x446db9=>{const _0x308db3=_0xffe2e5;_0x8f3f4e['data_adjustment'][_0x446db9[_0x308db3(0xfe)]]=[],await Promise[_0x308db3(0xe9)](_0x446db9[_0x308db3(0xff)][_0x308db3(0x106)](async _0x487587=>{const _0x3cbf05=_0x308db3,_0x5bfccc=await adjustment['aggregate']([{'$unwind':_0x3cbf05(0xed)},{'$match':{'product.id_transaction_from':_0x487587[_0x3cbf05(0xcf)][_0x3cbf05(0xe5)](),'product.invoice':_0x487587[_0x3cbf05(0xfe)]}},{'$project':{'_id':_0x3cbf05(0xd5),'product_name':_0x3cbf05(0x103),'product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':_0x3cbf05(0x102),'warehouse_room':_0x3cbf05(0xfb),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':_0x3cbf05(0xf8)}}]);_0x5bfccc[_0x3cbf05(0xf3)]>0x0&&_0x8f3f4e[_0x3cbf05(0xe4)][_0x446db9[_0x3cbf05(0xfe)]][_0x3cbf05(0x105)](..._0x5bfccc);}));})),_0x8f3f4e[_0xffe2e5(0xe7)]={},await Promise[_0xffe2e5(0xe9)](_0x8f3f4e[_0xffe2e5(0x106)](async _0x46d73a=>{const _0xe643a1=_0xffe2e5;_0x8f3f4e[_0xe643a1(0xe7)][_0x46d73a[_0xe643a1(0xfe)]]=[],await Promise[_0xe643a1(0xe9)](_0x46d73a[_0xe643a1(0xff)][_0xe643a1(0x106)](async _0x58a6de=>{const _0x492d19=_0xe643a1,_0x55c7d9=await transfers['aggregate']([{'$unwind':_0x492d19(0xed)},{'$match':{'product.id_transaction_id':_0x58a6de[_0x492d19(0xcf)]['valueOf'](),'product.To_invoice':_0x58a6de[_0x492d19(0xfe)]}},{'$project':{'_id':_0x492d19(0xd5),'product_name':_0x492d19(0x103),'product_code':_0x492d19(0xd1),'quantity_available':_0x492d19(0x104),'warehouse_name':_0x492d19(0xef),'warehouse_room':'$product.room_names','product_invoice':_0x492d19(0xd4),'invoice':_0x492d19(0xd0),'id_transaction_id':_0x492d19(0xcc)}}]);console[_0x492d19(0xf1)](_0x55c7d9),_0x55c7d9[_0x492d19(0xf3)]>0x0&&_0x8f3f4e[_0x492d19(0xe7)][_0x46d73a[_0x492d19(0xfe)]][_0x492d19(0x105)](..._0x55c7d9);}));})),_0x18933c[_0xffe2e5(0xf6)]({'purchases_warehouse':_0x8f3f4e,'data_sales':_0x8f3f4e[_0xffe2e5(0xdb)],'data_adjustment':_0x8f3f4e[_0xffe2e5(0xe4)],'data_transfer':_0x8f3f4e[_0xffe2e5(0xe7)]});}),module[a0_0x33bf20(0xf0)]=router;function a0_0x5b54(){const _0x22ef69=['$product.product_name','$product.to_quantity','push','map','table\x20page','3349800ItwQBF','$room','$product_details.product_stock','message','INCF-52068316','$product.id_transaction_id','7RSAulr','/negative','_id','$invoice','$product.product_code','flash','14800005047429','$product.to_room_name','$product._id','express','$product_details.product_name','status','errors','1362285mloOCN','data_sales','4019620hEnfem','$product_details','modifiedCount','3239235clsfBs','$sale_product.product_code','24oWlGQq','$sale_product.room_name','501955xpAcOh','data_adjustment','valueOf','$sale_product.quantity','data_transfer','$sale_product._id','all','warehouses','62qvUKsx','6971jFHkSa','$product','/warehouse_monitor','$to_warehouse','exports','log','aggregate','length','updateMany','/checking','json','$product_details.invoice','$product.id_transaction_from','../../models/all_models','get','$product.room_names','4664076eJrntf','$sale_product','invoice','warehouse_data','$name','\x20documents\x20updated','$warehouse_name'];a0_0x5b54=function(){return _0x22ef69;};return a0_0x5b54();}