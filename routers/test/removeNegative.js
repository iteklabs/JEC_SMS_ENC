const a0_0x5e6d02=a0_0x141c;function a0_0x141c(_0x203c6d,_0x4865fa){const _0x2e33e1=a0_0x2e33();return a0_0x141c=function(_0x141cbf,_0x5bbc3c){_0x141cbf=_0x141cbf-0xd6;let _0x2ceed9=_0x2e33e1[_0x141cbf];return _0x2ceed9;},a0_0x141c(_0x203c6d,_0x4865fa);}function a0_0x2e33(){const _0x23b2ab=['1237810RkJCdZ','exports','718233EXBAbs','$product_details.product_code','4583110aJxMek','message','$product.to_quantity','_id','$product.product_code','$sale_product.room_name','$sale_product.quantity','$name','data_transfer','$product.new_adjust_qty','log','modifiedCount','table\x20page','32cXTlqE','push','$product.to_room_name','valueOf','$product.id_transaction_id','$product_details.product_name','/checking','$product._id','/join','$invoice','$$invoice','/warehouse_monitor','get','json','monitor','status','16713200npIUSE','Router','2LnzIQB','$sale_product.product_code','14800005047429','data_sales','$sale_product.product_name','4SbdZGK','$sale_product._id','$to_warehouse','$product.product_name','168420gtKvuu','express','$room','errors','aggregate','map','length','$product_details.product_stock','data_adjustment','all','$product_details.invoice','$product.invoice','warehouse_data','success','806268EVpcFt','../../models/all_models','$sale_product.id_transaction_from','$sale_product','warehouses','$sale_product.invoice','$product_details','invoice','$product','879156vgzfcR'];a0_0x2e33=function(){return _0x23b2ab;};return a0_0x2e33();}(function(_0x29dfa9,_0xa06521){const _0x3f264a=a0_0x141c,_0x5a56c5=_0x29dfa9();while(!![]){try{const _0xe14799=parseInt(_0x3f264a(0xfe))/0x1*(parseInt(_0x3f264a(0xdb))/0x2)+parseInt(_0x3f264a(0xf2))/0x3+parseInt(_0x3f264a(0xe0))/0x4*(parseInt(_0x3f264a(0xfc))/0x5)+parseInt(_0x3f264a(0xe4))/0x6+parseInt(_0x3f264a(0x100))/0x7+-parseInt(_0x3f264a(0x10d))/0x8*(-parseInt(_0x3f264a(0xfb))/0x9)+-parseInt(_0x3f264a(0xd9))/0xa;if(_0xe14799===_0xa06521)break;else _0x5a56c5['push'](_0x5a56c5['shift']());}catch(_0xd0d389){_0x5a56c5['push'](_0x5a56c5['shift']());}}}(a0_0x2e33,0x9b75f));const express=require(a0_0x5e6d02(0xe5)),app=express(),router=express[a0_0x5e6d02(0xda)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x5e6d02(0xf3));router[a0_0x5e6d02(0x119)]('/negative',async(_0x24064e,_0x15c3d1)=>{const _0x1ccfbc=a0_0x5e6d02;try{const _0x3306ba=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x15c3d1['json']({'status':_0x3306ba[_0x1ccfbc(0x10b)]+'\x20documents\x20updated'});}catch(_0x161b9e){console[_0x1ccfbc(0x10a)](_0x1ccfbc(0x10c),_0x161b9e),_0x15c3d1[_0x1ccfbc(0xd8)](0xc8)['json']({'message':_0x161b9e[_0x1ccfbc(0x101)]});}}),router[a0_0x5e6d02(0x119)](a0_0x5e6d02(0x113),async(_0x8cebd1,_0x4b3f97)=>{const _0x1fcccd=a0_0x5e6d02;try{const _0x3a29f0=await warehouse[_0x1fcccd(0xe8)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':_0x1fcccd(0xdd)}},{'$group':{'_id':{'name':_0x1fcccd(0x107),'room':_0x1fcccd(0xe6)},'products':{'$push':_0x1fcccd(0xf8)}}}]);_0x4b3f97[_0x1fcccd(0xd6)](_0x3a29f0);}catch(_0xc7db9){console[_0x1fcccd(0x10a)](_0x1fcccd(0x10c),_0xc7db9),_0x4b3f97[_0x1fcccd(0xd8)](0xc8)[_0x1fcccd(0xd6)]({'message':_0xc7db9[_0x1fcccd(0x101)]});}}),router['get'](a0_0x5e6d02(0x118),async(_0x345a87,_0x3f6cc5)=>{const _0x233e03=a0_0x5e6d02;_0x3f6cc5['render'](_0x233e03(0xd7),{'success':_0x345a87['flash'](_0x233e03(0xf1)),'errors':_0x345a87['flash'](_0x233e03(0xe7))});}),router[a0_0x5e6d02(0x119)](a0_0x5e6d02(0x115),async(_0x1a00be,_0x29f05e)=>{const _0x39d81b=a0_0x5e6d02;var _0x5c2a30=await purchases['aggregate']([{'$lookup':{'from':_0x39d81b(0xf6),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x39d81b(0x117),_0x39d81b(0xee)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x39d81b(0x112),'product_code':_0x39d81b(0xff),'quantity_available':_0x39d81b(0xeb),'warehouse_name':'$name','warehouse_room':'$room','invoice':_0x39d81b(0xee)}}],'as':_0x39d81b(0xf0)}}]);_0x5c2a30['data_sales']={},await Promise[_0x39d81b(0xed)](_0x5c2a30[_0x39d81b(0xe9)](async _0x1516ef=>{const _0x1e7926=_0x39d81b;_0x5c2a30[_0x1e7926(0xde)][_0x1516ef[_0x1e7926(0xf9)]]=[],await Promise[_0x1e7926(0xed)](_0x1516ef['warehouse_data'][_0x1e7926(0xe9)](async _0x3b7dc2=>{const _0x5dfc9d=_0x1e7926,_0x18d6dd=await sales['aggregate']([{'$unwind':_0x5dfc9d(0xf5)},{'$match':{'sale_product.id_transaction_from':_0x3b7dc2[_0x5dfc9d(0x103)][_0x5dfc9d(0x110)](),'sale_product.invoice':_0x3b7dc2['invoice']}},{'$project':{'_id':_0x5dfc9d(0xe1),'product_name':_0x5dfc9d(0xdf),'product_code':_0x5dfc9d(0xdc),'quantity_available':_0x5dfc9d(0x106),'warehouse_name':'$warehouse_name','warehouse_room':_0x5dfc9d(0x105),'product_invoice':_0x5dfc9d(0xf7),'invoice':'$invoice','id_transaction_from':_0x5dfc9d(0xf4)}}]);_0x18d6dd[_0x5dfc9d(0xea)]>0x0&&_0x5c2a30[_0x5dfc9d(0xde)][_0x1516ef['invoice']]['push'](..._0x18d6dd);}));})),_0x5c2a30[_0x39d81b(0xde)]=_0x5c2a30[_0x39d81b(0xde)],_0x5c2a30['data_adjustment']={},await Promise['all'](_0x5c2a30[_0x39d81b(0xe9)](async _0x4656de=>{const _0x2d1fe6=_0x39d81b;_0x5c2a30['data_adjustment'][_0x4656de['invoice']]=[],await Promise['all'](_0x4656de[_0x2d1fe6(0xf0)][_0x2d1fe6(0xe9)](async _0x294077=>{const _0xc09b8b=_0x2d1fe6,_0xbb833e=await adjustment[_0xc09b8b(0xe8)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x294077[_0xc09b8b(0x103)]['valueOf'](),'product.invoice':_0x294077['invoice']}},{'$project':{'_id':_0xc09b8b(0x114),'product_name':_0xc09b8b(0xe3),'product_code':'$product.product_code','quantity_available':_0xc09b8b(0x109),'warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':_0xc09b8b(0xef),'invoice':_0xc09b8b(0x116),'id_transaction_from':'$product.id_transaction_from'}}]);_0xbb833e[_0xc09b8b(0xea)]>0x0&&_0x5c2a30[_0xc09b8b(0xec)][_0x4656de[_0xc09b8b(0xf9)]][_0xc09b8b(0x10e)](..._0xbb833e);}));})),_0x5c2a30['data_transfer']={},await Promise['all'](_0x5c2a30[_0x39d81b(0xe9)](async _0x17296d=>{const _0x52191c=_0x39d81b;_0x5c2a30['data_transfer'][_0x17296d[_0x52191c(0xf9)]]=[],await Promise[_0x52191c(0xed)](_0x17296d['warehouse_data'][_0x52191c(0xe9)](async _0x532279=>{const _0x53a4d2=_0x52191c,_0x357b17=await transfers[_0x53a4d2(0xe8)]([{'$unwind':_0x53a4d2(0xfa)},{'$match':{'product.id_transaction_id':_0x532279['_id'][_0x53a4d2(0x110)](),'product.To_invoice':_0x532279[_0x53a4d2(0xf9)]}},{'$project':{'_id':_0x53a4d2(0x114),'product_name':_0x53a4d2(0xe3),'product_code':_0x53a4d2(0x104),'quantity_available':_0x53a4d2(0x102),'warehouse_name':_0x53a4d2(0xe2),'warehouse_room':'$product.room_names','product_invoice':_0x53a4d2(0x10f),'invoice':'$invoice','id_transaction_id':_0x53a4d2(0x111)}}]);console[_0x53a4d2(0x10a)](_0x357b17),_0x357b17[_0x53a4d2(0xea)]>0x0&&_0x5c2a30[_0x53a4d2(0x108)][_0x17296d[_0x53a4d2(0xf9)]]['push'](..._0x357b17);}));})),_0x29f05e[_0x39d81b(0xd6)]({'purchases_warehouse':_0x5c2a30,'data_sales':_0x5c2a30[_0x39d81b(0xde)],'data_adjustment':_0x5c2a30[_0x39d81b(0xec)],'data_transfer':_0x5c2a30[_0x39d81b(0x108)]});}),module[a0_0x5e6d02(0xfd)]=router;