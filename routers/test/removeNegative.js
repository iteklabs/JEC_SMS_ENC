const a0_0xe7ec02=a0_0x7701;function a0_0x41b5(){const _0x6ae05a=['$name','/warehouse_monitor','28018610AOmMhu','Router','exports','$product._id','$product.id_transaction_from','$product.product_code','$product_details.product_code','_id','length','flash','$room','$sale_product.quantity','express','14800005047429','286444RKDKSL','$to_warehouse','$product_details','invoice','$product_details.invoice','9510939CEVAIN','/negative','$product','aggregate','6678918EomZcO','$$invoice','push','70nXfgae','warehouse_data','$sale_product.product_name','3392632bZYEHt','$sale_product.room_name','status','$product_details._id','warehouses','data_transfer','594830ELhlMU','get','$sale_product._id','success','$invoice','2ehDgHq','$product.id_transaction_id','/join','table\x20page','1136628TZHcVG','errors','$sale_product.id_transaction_from','$product.product_name','21LhvKEc','message','INCF-52068316','$product.to_room_name','log','$product.to_quantity','valueOf','map','data_sales','all','$sale_product.invoice','modifiedCount','data_adjustment','$product.invoice','json','monitor','$product.room_names','/checking','../../models/all_models'];a0_0x41b5=function(){return _0x6ae05a;};return a0_0x41b5();}(function(_0x3e3725,_0xc2b5b8){const _0x34d52e=a0_0x7701,_0x543511=_0x3e3725();while(!![]){try{const _0x346fbb=-parseInt(_0x34d52e(0x123))/0x1+parseInt(_0x34d52e(0x128))/0x2*(parseInt(_0x34d52e(0x12c))/0x3)+parseInt(_0x34d52e(0x10e))/0x4*(-parseInt(_0x34d52e(0x11a))/0x5)+-parseInt(_0x34d52e(0x117))/0x6+-parseInt(_0x34d52e(0x130))/0x7*(-parseInt(_0x34d52e(0x11d))/0x8)+-parseInt(_0x34d52e(0x113))/0x9+parseInt(_0x34d52e(0x145))/0xa;if(_0x346fbb===_0xc2b5b8)break;else _0x543511['push'](_0x543511['shift']());}catch(_0x4a679b){_0x543511['push'](_0x543511['shift']());}}}(a0_0x41b5,0xa7662));function a0_0x7701(_0x18a3b4,_0x22e6fb){const _0x41b504=a0_0x41b5();return a0_0x7701=function(_0x770118,_0x4c2b77){_0x770118=_0x770118-0x108;let _0x5e8c3c=_0x41b504[_0x770118];return _0x5e8c3c;},a0_0x7701(_0x18a3b4,_0x22e6fb);}const express=require(a0_0xe7ec02(0x10c)),app=express(),router=express[a0_0xe7ec02(0x146)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0xe7ec02(0x142));router[a0_0xe7ec02(0x124)](a0_0xe7ec02(0x114),async(_0x3435fd,_0x55ca11)=>{const _0xe027a3=a0_0xe7ec02;try{const _0x1c6a95=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x55ca11[_0xe027a3(0x13e)]({'status':_0x1c6a95[_0xe027a3(0x13b)]+'\x20documents\x20updated'});}catch(_0x386136){console[_0xe027a3(0x134)]('table\x20page',_0x386136),_0x55ca11[_0xe027a3(0x11f)](0xc8)[_0xe027a3(0x13e)]({'message':_0x386136[_0xe027a3(0x131)]});}}),router[a0_0xe7ec02(0x124)](a0_0xe7ec02(0x141),async(_0x5801f9,_0x135281)=>{const _0x1addc8=a0_0xe7ec02;try{const _0x717518=await warehouse[_0x1addc8(0x116)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0x1addc8(0x132),'product_details.primary_code':_0x1addc8(0x10d)}},{'$group':{'_id':{'name':_0x1addc8(0x143),'room':_0x1addc8(0x10a)},'products':{'$push':_0x1addc8(0x110)}}}]);_0x135281[_0x1addc8(0x13e)](_0x717518);}catch(_0x3fa7a3){console[_0x1addc8(0x134)](_0x1addc8(0x12b),_0x3fa7a3),_0x135281[_0x1addc8(0x11f)](0xc8)[_0x1addc8(0x13e)]({'message':_0x3fa7a3[_0x1addc8(0x131)]});}}),router[a0_0xe7ec02(0x124)](a0_0xe7ec02(0x144),async(_0x1a5165,_0x1f412e)=>{const _0x21b7db=a0_0xe7ec02;_0x1f412e['render'](_0x21b7db(0x13f),{'success':_0x1a5165[_0x21b7db(0x109)](_0x21b7db(0x126)),'errors':_0x1a5165[_0x21b7db(0x109)](_0x21b7db(0x12d))});}),router[a0_0xe7ec02(0x124)](a0_0xe7ec02(0x12a),async(_0x4f101d,_0x8f938c)=>{const _0x29c069=a0_0xe7ec02;var _0x206667=await purchases['aggregate']([{'$lookup':{'from':_0x29c069(0x121),'let':{'invoice':_0x29c069(0x127)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x29c069(0x118),_0x29c069(0x112)]}}},{'$project':{'_id':_0x29c069(0x120),'product_name':'$product_details.product_name','product_code':_0x29c069(0x14b),'quantity_available':'$product_details.product_stock','warehouse_name':_0x29c069(0x143),'warehouse_room':_0x29c069(0x10a),'invoice':_0x29c069(0x112)}}],'as':_0x29c069(0x11b)}}]);_0x206667[_0x29c069(0x138)]={},await Promise[_0x29c069(0x139)](_0x206667[_0x29c069(0x137)](async _0x25c6de=>{const _0x4f7d2e=_0x29c069;_0x206667['data_sales'][_0x25c6de[_0x4f7d2e(0x111)]]=[],await Promise['all'](_0x25c6de[_0x4f7d2e(0x11b)][_0x4f7d2e(0x137)](async _0x578a0a=>{const _0x5343aa=_0x4f7d2e,_0x4a7ab0=await sales[_0x5343aa(0x116)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x578a0a['_id'][_0x5343aa(0x136)](),'sale_product.invoice':_0x578a0a[_0x5343aa(0x111)]}},{'$project':{'_id':_0x5343aa(0x125),'product_name':_0x5343aa(0x11c),'product_code':'$sale_product.product_code','quantity_available':_0x5343aa(0x10b),'warehouse_name':'$warehouse_name','warehouse_room':_0x5343aa(0x11e),'product_invoice':_0x5343aa(0x13a),'invoice':_0x5343aa(0x127),'id_transaction_from':_0x5343aa(0x12e)}}]);_0x4a7ab0[_0x5343aa(0x108)]>0x0&&_0x206667[_0x5343aa(0x138)][_0x25c6de[_0x5343aa(0x111)]][_0x5343aa(0x119)](..._0x4a7ab0);}));})),_0x206667['data_sales']=_0x206667[_0x29c069(0x138)],_0x206667[_0x29c069(0x13c)]={},await Promise[_0x29c069(0x139)](_0x206667[_0x29c069(0x137)](async _0x2637a5=>{const _0x11c680=_0x29c069;_0x206667[_0x11c680(0x13c)][_0x2637a5[_0x11c680(0x111)]]=[],await Promise[_0x11c680(0x139)](_0x2637a5[_0x11c680(0x11b)]['map'](async _0x189fc4=>{const _0x22cad8=_0x11c680,_0x1df409=await adjustment['aggregate']([{'$unwind':_0x22cad8(0x115)},{'$match':{'product.id_transaction_from':_0x189fc4[_0x22cad8(0x14c)][_0x22cad8(0x136)](),'product.invoice':_0x189fc4[_0x22cad8(0x111)]}},{'$project':{'_id':_0x22cad8(0x148),'product_name':_0x22cad8(0x12f),'product_code':_0x22cad8(0x14a),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x22cad8(0x140),'product_invoice':_0x22cad8(0x13d),'invoice':_0x22cad8(0x127),'id_transaction_from':_0x22cad8(0x149)}}]);_0x1df409[_0x22cad8(0x108)]>0x0&&_0x206667['data_adjustment'][_0x2637a5[_0x22cad8(0x111)]][_0x22cad8(0x119)](..._0x1df409);}));})),_0x206667['data_transfer']={},await Promise[_0x29c069(0x139)](_0x206667['map'](async _0x43f214=>{const _0x2ec4a6=_0x29c069;_0x206667[_0x2ec4a6(0x122)][_0x43f214[_0x2ec4a6(0x111)]]=[],await Promise[_0x2ec4a6(0x139)](_0x43f214[_0x2ec4a6(0x11b)]['map'](async _0x4a5d35=>{const _0x239bd8=_0x2ec4a6,_0x5a2fa6=await transfers[_0x239bd8(0x116)]([{'$unwind':_0x239bd8(0x115)},{'$match':{'product.id_transaction_id':_0x4a5d35[_0x239bd8(0x14c)]['valueOf'](),'product.To_invoice':_0x4a5d35[_0x239bd8(0x111)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x239bd8(0x14a),'quantity_available':_0x239bd8(0x135),'warehouse_name':_0x239bd8(0x10f),'warehouse_room':_0x239bd8(0x140),'product_invoice':_0x239bd8(0x133),'invoice':_0x239bd8(0x127),'id_transaction_id':_0x239bd8(0x129)}}]);console['log'](_0x5a2fa6),_0x5a2fa6['length']>0x0&&_0x206667[_0x239bd8(0x122)][_0x43f214[_0x239bd8(0x111)]][_0x239bd8(0x119)](..._0x5a2fa6);}));})),_0x8f938c['json']({'purchases_warehouse':_0x206667,'data_sales':_0x206667['data_sales'],'data_adjustment':_0x206667[_0x29c069(0x13c)],'data_transfer':_0x206667[_0x29c069(0x122)]});}),module[a0_0xe7ec02(0x147)]=router;