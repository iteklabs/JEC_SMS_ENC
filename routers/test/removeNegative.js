const a0_0x24991e=a0_0x59bd;(function(_0x4549c6,_0x211313){const _0xce33b1=a0_0x59bd,_0x2e5ab1=_0x4549c6();while(!![]){try{const _0x215028=parseInt(_0xce33b1(0x113))/0x1*(-parseInt(_0xce33b1(0x125))/0x2)+-parseInt(_0xce33b1(0x127))/0x3*(parseInt(_0xce33b1(0x10b))/0x4)+-parseInt(_0xce33b1(0x11b))/0x5+-parseInt(_0xce33b1(0xf7))/0x6*(parseInt(_0xce33b1(0x101))/0x7)+-parseInt(_0xce33b1(0x119))/0x8+parseInt(_0xce33b1(0x130))/0x9+parseInt(_0xce33b1(0xfb))/0xa*(parseInt(_0xce33b1(0x121))/0xb);if(_0x215028===_0x211313)break;else _0x2e5ab1['push'](_0x2e5ab1['shift']());}catch(_0x258be6){_0x2e5ab1['push'](_0x2e5ab1['shift']());}}}(a0_0x1ba9,0xbde9d));function a0_0x59bd(_0x13820f,_0x42e948){const _0x1ba9fa=a0_0x1ba9();return a0_0x59bd=function(_0x59bd5d,_0x19b1c4){_0x59bd5d=_0x59bd5d-0xed;let _0x4ab46d=_0x1ba9fa[_0x59bd5d];return _0x4ab46d;},a0_0x59bd(_0x13820f,_0x42e948);}const express=require(a0_0x24991e(0xf0)),app=express(),router=express[a0_0x24991e(0x12a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x24991e(0xfe));function a0_0x1ba9(){const _0x5d4fcb=['$sale_product._id','$product.invoice','push','$sale_product.room_name','$to_warehouse','7032960oTCIGF','$sale_product.quantity','3759870fevQuM','success','$product','$$invoice','$product.product_code','map','47298669XhZXfJ','message','$product.id_transaction_from','$product.product_name','4syNWqL','length','154776qswoaG','$product_details._id','json','Router','data_adjustment','$name','status','INCF-52068316','aggregate','4893039YaDmuJ','modifiedCount','$product_details','updateMany','data_transfer','express','get','warehouse_data','all','errors','data_sales','$product.new_adjust_qty','171162hNBwtu','log','$product_details.invoice','$sale_product.invoice','10dLTBhD','warehouses','/join','../../models/all_models','_id','/negative','161bRXafj','$warehouse_name','$room','$product.room_names','table\x20page','$invoice','/warehouse_monitor','$product_details.product_name','$sale_product.product_name','monitor','24BqbuRe','invoice','valueOf','$product.to_room_name','/checking','$product.to_quantity','$product._id','flash','734449xmLUul'];a0_0x1ba9=function(){return _0x5d4fcb;};return a0_0x1ba9();}router['get'](a0_0x24991e(0x100),async(_0x6519ac,_0x3daa1a)=>{const _0x1923ad=a0_0x24991e;try{const _0x3fbb42=await warehouse[_0x1923ad(0xee)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x3daa1a[_0x1923ad(0x129)]({'status':_0x3fbb42[_0x1923ad(0x131)]+'\x20documents\x20updated'});}catch(_0x35a1a6){console[_0x1923ad(0xf8)](_0x1923ad(0x105),_0x35a1a6),_0x3daa1a['status'](0xc8)['json']({'message':_0x35a1a6[_0x1923ad(0x122)]});}}),router['get'](a0_0x24991e(0x10f),async(_0x4a7057,_0x1735db)=>{const _0x437b49=a0_0x24991e;try{const _0x1b6b6b=await warehouse[_0x437b49(0x12f)]([{'$unwind':_0x437b49(0xed)},{'$match':{'product_details.invoice':_0x437b49(0x12e),'product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0x437b49(0x12c),'room':_0x437b49(0x103)},'products':{'$push':_0x437b49(0xed)}}}]);_0x1735db[_0x437b49(0x129)](_0x1b6b6b);}catch(_0x291861){console['log'](_0x437b49(0x105),_0x291861),_0x1735db[_0x437b49(0x12d)](0xc8)[_0x437b49(0x129)]({'message':_0x291861['message']});}}),router[a0_0x24991e(0xf1)](a0_0x24991e(0x107),async(_0x212ba4,_0x5d2898)=>{const _0x4fcbec=a0_0x24991e;_0x5d2898['render'](_0x4fcbec(0x10a),{'success':_0x212ba4[_0x4fcbec(0x112)](_0x4fcbec(0x11c)),'errors':_0x212ba4[_0x4fcbec(0x112)](_0x4fcbec(0xf4))});}),router['get'](a0_0x24991e(0xfd),async(_0x13eea2,_0x31d6fa)=>{const _0x2958b1=a0_0x24991e;var _0x2948bd=await purchases[_0x2958b1(0x12f)]([{'$lookup':{'from':_0x2958b1(0xfc),'let':{'invoice':_0x2958b1(0x106)},'pipeline':[{'$unwind':_0x2958b1(0xed)},{'$match':{'$expr':{'$eq':[_0x2958b1(0x11e),_0x2958b1(0xf9)]}}},{'$project':{'_id':_0x2958b1(0x128),'product_name':_0x2958b1(0x108),'product_code':'$product_details.product_code','quantity_available':'$product_details.product_stock','warehouse_name':_0x2958b1(0x12c),'warehouse_room':_0x2958b1(0x103),'invoice':_0x2958b1(0xf9)}}],'as':'warehouse_data'}}]);_0x2948bd[_0x2958b1(0xf5)]={},await Promise[_0x2958b1(0xf3)](_0x2948bd['map'](async _0xdfa27c=>{const _0x416678=_0x2958b1;_0x2948bd[_0x416678(0xf5)][_0xdfa27c[_0x416678(0x10c)]]=[],await Promise[_0x416678(0xf3)](_0xdfa27c['warehouse_data'][_0x416678(0x120)](async _0x2e2de5=>{const _0x5be00a=_0x416678,_0x2ab659=await sales[_0x5be00a(0x12f)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x2e2de5['_id'][_0x5be00a(0x10d)](),'sale_product.invoice':_0x2e2de5[_0x5be00a(0x10c)]}},{'$project':{'_id':_0x5be00a(0x114),'product_name':_0x5be00a(0x109),'product_code':'$sale_product.product_code','quantity_available':_0x5be00a(0x11a),'warehouse_name':'$warehouse_name','warehouse_room':_0x5be00a(0x117),'product_invoice':_0x5be00a(0xfa),'invoice':_0x5be00a(0x106),'id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x2ab659[_0x5be00a(0x126)]>0x0&&_0x2948bd[_0x5be00a(0xf5)][_0xdfa27c['invoice']]['push'](..._0x2ab659);}));})),_0x2948bd[_0x2958b1(0xf5)]=_0x2948bd[_0x2958b1(0xf5)],_0x2948bd[_0x2958b1(0x12b)]={},await Promise['all'](_0x2948bd[_0x2958b1(0x120)](async _0x3e94ac=>{const _0x4c5aa3=_0x2958b1;_0x2948bd['data_adjustment'][_0x3e94ac[_0x4c5aa3(0x10c)]]=[],await Promise[_0x4c5aa3(0xf3)](_0x3e94ac[_0x4c5aa3(0xf2)]['map'](async _0x5c45f8=>{const _0x21f364=_0x4c5aa3,_0x5e7312=await adjustment[_0x21f364(0x12f)]([{'$unwind':_0x21f364(0x11d)},{'$match':{'product.id_transaction_from':_0x5c45f8[_0x21f364(0xff)][_0x21f364(0x10d)](),'product.invoice':_0x5c45f8['invoice']}},{'$project':{'_id':_0x21f364(0x111),'product_name':_0x21f364(0x124),'product_code':_0x21f364(0x11f),'quantity_available':_0x21f364(0xf6),'warehouse_name':_0x21f364(0x102),'warehouse_room':_0x21f364(0x104),'product_invoice':_0x21f364(0x115),'invoice':_0x21f364(0x106),'id_transaction_from':_0x21f364(0x123)}}]);_0x5e7312[_0x21f364(0x126)]>0x0&&_0x2948bd[_0x21f364(0x12b)][_0x3e94ac[_0x21f364(0x10c)]][_0x21f364(0x116)](..._0x5e7312);}));})),_0x2948bd[_0x2958b1(0xef)]={},await Promise[_0x2958b1(0xf3)](_0x2948bd[_0x2958b1(0x120)](async _0x1652a3=>{const _0x52bae1=_0x2958b1;_0x2948bd[_0x52bae1(0xef)][_0x1652a3['invoice']]=[],await Promise[_0x52bae1(0xf3)](_0x1652a3['warehouse_data'][_0x52bae1(0x120)](async _0x28410a=>{const _0x257d07=_0x52bae1,_0x395087=await transfers[_0x257d07(0x12f)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x28410a['_id'][_0x257d07(0x10d)](),'product.To_invoice':_0x28410a['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x257d07(0x124),'product_code':_0x257d07(0x11f),'quantity_available':_0x257d07(0x110),'warehouse_name':_0x257d07(0x118),'warehouse_room':'$product.room_names','product_invoice':_0x257d07(0x10e),'invoice':_0x257d07(0x106),'id_transaction_id':'$product.id_transaction_id'}}]);console[_0x257d07(0xf8)](_0x395087),_0x395087[_0x257d07(0x126)]>0x0&&_0x2948bd[_0x257d07(0xef)][_0x1652a3[_0x257d07(0x10c)]][_0x257d07(0x116)](..._0x395087);}));})),_0x31d6fa[_0x2958b1(0x129)]({'purchases_warehouse':_0x2948bd,'data_sales':_0x2948bd[_0x2958b1(0xf5)],'data_adjustment':_0x2948bd[_0x2958b1(0x12b)],'data_transfer':_0x2948bd[_0x2958b1(0xef)]});}),module['exports']=router;