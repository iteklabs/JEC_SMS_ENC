const a0_0x1a201f=a0_0xa40d;(function(_0x26537b,_0x22f5c0){const _0x389dd1=a0_0xa40d,_0x118659=_0x26537b();while(!![]){try{const _0x1763f5=-parseInt(_0x389dd1(0x10d))/0x1+-parseInt(_0x389dd1(0x111))/0x2*(parseInt(_0x389dd1(0x12f))/0x3)+parseInt(_0x389dd1(0xf9))/0x4+-parseInt(_0x389dd1(0x11c))/0x5+-parseInt(_0x389dd1(0xf8))/0x6+-parseInt(_0x389dd1(0x106))/0x7+-parseInt(_0x389dd1(0x10e))/0x8*(-parseInt(_0x389dd1(0x102))/0x9);if(_0x1763f5===_0x22f5c0)break;else _0x118659['push'](_0x118659['shift']());}catch(_0x5d99c8){_0x118659['push'](_0x118659['shift']());}}}(a0_0x537b,0x72b8b));const express=require(a0_0x1a201f(0x132)),app=express(),router=express[a0_0x1a201f(0x12a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require('../../models/all_models');router[a0_0x1a201f(0x105)](a0_0x1a201f(0xfc),async(_0x4dcc5f,_0x15e687)=>{const _0x2fc662=a0_0x1a201f;try{const _0x58a540=await warehouse[_0x2fc662(0x12d)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x15e687[_0x2fc662(0x10a)]({'status':_0x58a540['modifiedCount']+_0x2fc662(0x136)});}catch(_0x4a550d){console[_0x2fc662(0x108)](_0x2fc662(0xfa),_0x4a550d),_0x15e687[_0x2fc662(0x117)](0xc8)['json']({'message':_0x4a550d['message']});}}),router[a0_0x1a201f(0x105)](a0_0x1a201f(0xf7),async(_0x38c088,_0x1f2122)=>{const _0xda548b=a0_0x1a201f;try{const _0x2eeb1f=await warehouse[_0xda548b(0x122)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0xda548b(0x103),'product_details.primary_code':_0xda548b(0xfd)}},{'$group':{'_id':{'name':_0xda548b(0x118),'room':_0xda548b(0x112)},'products':{'$push':_0xda548b(0x12e)}}}]);_0x1f2122['json'](_0x2eeb1f);}catch(_0x2f65a4){console[_0xda548b(0x108)]('table\x20page',_0x2f65a4),_0x1f2122[_0xda548b(0x117)](0xc8)['json']({'message':_0x2f65a4[_0xda548b(0x10b)]});}}),router[a0_0x1a201f(0x105)]('/warehouse_monitor',async(_0x1119af,_0x256783)=>{const _0x4982b2=a0_0x1a201f;_0x256783[_0x4982b2(0x135)](_0x4982b2(0xfe),{'success':_0x1119af[_0x4982b2(0x109)](_0x4982b2(0x11b)),'errors':_0x1119af[_0x4982b2(0x109)]('errors')});}),router[a0_0x1a201f(0x105)](a0_0x1a201f(0x12c),async(_0x27dbfb,_0xa8fb56)=>{const _0x804777=a0_0x1a201f;var _0x29aa29=await purchases[_0x804777(0x122)]([{'$lookup':{'from':'warehouses','let':{'invoice':_0x804777(0xff)},'pipeline':[{'$unwind':_0x804777(0x12e)},{'$match':{'$expr':{'$eq':[_0x804777(0x124),_0x804777(0x101)]}}},{'$project':{'_id':_0x804777(0x127),'product_name':_0x804777(0x11f),'product_code':'$product_details.product_code','quantity_available':_0x804777(0x121),'warehouse_name':_0x804777(0x118),'warehouse_room':_0x804777(0x112),'invoice':_0x804777(0x101)}}],'as':_0x804777(0x12b)}}]);_0x29aa29[_0x804777(0x10f)]={},await Promise['all'](_0x29aa29[_0x804777(0x125)](async _0x179699=>{const _0x46b20b=_0x804777;_0x29aa29[_0x46b20b(0x10f)][_0x179699[_0x46b20b(0x120)]]=[],await Promise[_0x46b20b(0x13b)](_0x179699[_0x46b20b(0x12b)][_0x46b20b(0x125)](async _0xe88804=>{const _0x565fc0=_0x46b20b,_0x2e9a15=await sales[_0x565fc0(0x122)]([{'$unwind':_0x565fc0(0x110)},{'$match':{'sale_product.id_transaction_from':_0xe88804[_0x565fc0(0x11d)]['valueOf'](),'sale_product.invoice':_0xe88804['invoice']}},{'$project':{'_id':_0x565fc0(0x133),'product_name':_0x565fc0(0x11e),'product_code':_0x565fc0(0x104),'quantity_available':_0x565fc0(0x113),'warehouse_name':_0x565fc0(0x130),'warehouse_room':_0x565fc0(0x137),'product_invoice':_0x565fc0(0x139),'invoice':_0x565fc0(0xff),'id_transaction_from':_0x565fc0(0x123)}}]);_0x2e9a15['length']>0x0&&_0x29aa29[_0x565fc0(0x10f)][_0x179699[_0x565fc0(0x120)]][_0x565fc0(0x134)](..._0x2e9a15);}));})),_0x29aa29['data_sales']=_0x29aa29[_0x804777(0x10f)],_0x29aa29['data_adjustment']={},await Promise[_0x804777(0x13b)](_0x29aa29[_0x804777(0x125)](async _0x193547=>{const _0x40e166=_0x804777;_0x29aa29[_0x40e166(0x11a)][_0x193547['invoice']]=[],await Promise[_0x40e166(0x13b)](_0x193547['warehouse_data'][_0x40e166(0x125)](async _0x31d39f=>{const _0xd46bbb=_0x40e166,_0x47dcf1=await adjustment[_0xd46bbb(0x122)]([{'$unwind':_0xd46bbb(0x128)},{'$match':{'product.id_transaction_from':_0x31d39f[_0xd46bbb(0x11d)][_0xd46bbb(0x116)](),'product.invoice':_0x31d39f[_0xd46bbb(0x120)]}},{'$project':{'_id':_0xd46bbb(0x115),'product_name':_0xd46bbb(0x114),'product_code':'$product.product_code','quantity_available':_0xd46bbb(0x138),'warehouse_name':_0xd46bbb(0x130),'warehouse_room':_0xd46bbb(0x119),'product_invoice':_0xd46bbb(0x107),'invoice':_0xd46bbb(0xff),'id_transaction_from':'$product.id_transaction_from'}}]);_0x47dcf1['length']>0x0&&_0x29aa29[_0xd46bbb(0x11a)][_0x193547[_0xd46bbb(0x120)]][_0xd46bbb(0x134)](..._0x47dcf1);}));})),_0x29aa29[_0x804777(0xfb)]={},await Promise[_0x804777(0x13b)](_0x29aa29[_0x804777(0x125)](async _0x584fa8=>{const _0x2c19a0=_0x804777;_0x29aa29[_0x2c19a0(0xfb)][_0x584fa8[_0x2c19a0(0x120)]]=[],await Promise[_0x2c19a0(0x13b)](_0x584fa8[_0x2c19a0(0x12b)][_0x2c19a0(0x125)](async _0x2979c1=>{const _0x280597=_0x2c19a0,_0x172434=await transfers[_0x280597(0x122)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x2979c1[_0x280597(0x11d)][_0x280597(0x116)](),'product.To_invoice':_0x2979c1[_0x280597(0x120)]}},{'$project':{'_id':_0x280597(0x115),'product_name':_0x280597(0x114),'product_code':_0x280597(0x129),'quantity_available':'$product.to_quantity','warehouse_name':_0x280597(0x131),'warehouse_room':_0x280597(0x119),'product_invoice':_0x280597(0x10c),'invoice':_0x280597(0xff),'id_transaction_id':_0x280597(0x13a)}}]);console[_0x280597(0x108)](_0x172434),_0x172434[_0x280597(0x100)]>0x0&&_0x29aa29['data_transfer'][_0x584fa8[_0x280597(0x120)]]['push'](..._0x172434);}));})),_0xa8fb56[_0x804777(0x10a)]({'purchases_warehouse':_0x29aa29,'data_sales':_0x29aa29[_0x804777(0x10f)],'data_adjustment':_0x29aa29[_0x804777(0x11a)],'data_transfer':_0x29aa29[_0x804777(0xfb)]});}),module[a0_0x1a201f(0x126)]=router;function a0_0xa40d(_0x5c1e0e,_0x21d99e){const _0x537bb6=a0_0x537b();return a0_0xa40d=function(_0xa40d4a,_0x5e70e4){_0xa40d4a=_0xa40d4a-0xf7;let _0x4989f0=_0x537bb6[_0xa40d4a];return _0x4989f0;},a0_0xa40d(_0x5c1e0e,_0x21d99e);}function a0_0x537b(){const _0x3b4db9=['message','$product.to_room_name','554722ldZuMZ','40ZFJqqV','data_sales','$sale_product','30OcSYOz','$room','$sale_product.quantity','$product.product_name','$product._id','valueOf','status','$name','$product.room_names','data_adjustment','success','3928980PRZQnp','_id','$sale_product.product_name','$product_details.product_name','invoice','$product_details.product_stock','aggregate','$sale_product.id_transaction_from','$$invoice','map','exports','$product_details._id','$product','$product.product_code','Router','warehouse_data','/join','updateMany','$product_details','92745JTNlol','$warehouse_name','$to_warehouse','express','$sale_product._id','push','render','\x20documents\x20updated','$sale_product.room_name','$product.new_adjust_qty','$sale_product.invoice','$product.id_transaction_id','all','/checking','5079036DiuwYz','2839752eofEim','table\x20page','data_transfer','/negative','14800005047429','monitor','$invoice','length','$product_details.invoice','5596479XHcxos','INCF-52068316','$sale_product.product_code','get','4889115BzddeZ','$product.invoice','log','flash','json'];a0_0x537b=function(){return _0x3b4db9;};return a0_0x537b();}