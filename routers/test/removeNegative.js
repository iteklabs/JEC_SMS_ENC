const a0_0x32f86e=a0_0x25d2;function a0_0x50d4(){const _0x3ef711=['$product.product_name','$product','data_sales','$product_details.product_code','4PsiNiM','$sale_product._id','map','monitor','message','$sale_product.product_code','success','$$invoice','$name','$product_details._id','/negative','70OxnwAN','flash','$sale_product.invoice','969255OxkqTB','972352VDeiLH','get','modifiedCount','../../models/all_models','INCF-52068316','table\x20page','updateMany','$product.new_adjust_qty','aggregate','$product_details.invoice','invoice','valueOf','3163548GMtpcy','$room','data_transfer','log','$product_details','$invoice','/warehouse_monitor','$product.id_transaction_id','$sale_product.id_transaction_from','warehouse_data','61709GKzNms','all','/join','14800005047429','8LmTeoo','$product.room_names','$product.to_quantity','$warehouse_name','render','421923xeBaUd','Router','data_adjustment','push','length','json','status','$product.product_code','$sale_product.product_name','852813qbPFTb','$product.to_room_name','$product.id_transaction_from','_id','1332710GZPRzj','/checking'];a0_0x50d4=function(){return _0x3ef711;};return a0_0x50d4();}function a0_0x25d2(_0x29d4c2,_0x15db89){const _0x50d4dd=a0_0x50d4();return a0_0x25d2=function(_0x25d2f2,_0x308d81){_0x25d2f2=_0x25d2f2-0x136;let _0x1ac6bf=_0x50d4dd[_0x25d2f2];return _0x1ac6bf;},a0_0x25d2(_0x29d4c2,_0x15db89);}(function(_0x3a9d01,_0x2be5ae){const _0x4e27f9=a0_0x25d2,_0x5244e0=_0x3a9d01();while(!![]){try{const _0x48a857=-parseInt(_0x4e27f9(0x143))/0x1*(-parseInt(_0x4e27f9(0x147))/0x2)+-parseInt(_0x4e27f9(0x14c))/0x3*(-parseInt(_0x4e27f9(0x15f))/0x4)+-parseInt(_0x4e27f9(0x159))/0x5+-parseInt(_0x4e27f9(0x139))/0x6+parseInt(_0x4e27f9(0x16d))/0x7+-parseInt(_0x4e27f9(0x16e))/0x8+parseInt(_0x4e27f9(0x155))/0x9*(parseInt(_0x4e27f9(0x16a))/0xa);if(_0x48a857===_0x2be5ae)break;else _0x5244e0['push'](_0x5244e0['shift']());}catch(_0x434988){_0x5244e0['push'](_0x5244e0['shift']());}}}(a0_0x50d4,0x42de9));const express=require('express'),app=express(),router=express[a0_0x32f86e(0x14d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x32f86e(0x171));router['get'](a0_0x32f86e(0x169),async(_0x54684f,_0x68d8ef)=>{const _0x443a0f=a0_0x32f86e;try{const _0x343f58=await warehouse[_0x443a0f(0x174)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x68d8ef[_0x443a0f(0x151)]({'status':_0x343f58[_0x443a0f(0x170)]+'\x20documents\x20updated'});}catch(_0x51262f){console[_0x443a0f(0x13c)](_0x443a0f(0x173),_0x51262f),_0x68d8ef[_0x443a0f(0x152)](0xc8)[_0x443a0f(0x151)]({'message':_0x51262f[_0x443a0f(0x163)]});}}),router['get'](a0_0x32f86e(0x15a),async(_0x531e7b,_0x1ecb5b)=>{const _0x33df43=a0_0x32f86e;try{const _0x23bda3=await warehouse['aggregate']([{'$unwind':_0x33df43(0x13d)},{'$match':{'product_details.invoice':_0x33df43(0x172),'product_details.primary_code':_0x33df43(0x146)}},{'$group':{'_id':{'name':_0x33df43(0x167),'room':_0x33df43(0x13a)},'products':{'$push':_0x33df43(0x13d)}}}]);_0x1ecb5b[_0x33df43(0x151)](_0x23bda3);}catch(_0x2f1b53){console[_0x33df43(0x13c)](_0x33df43(0x173),_0x2f1b53),_0x1ecb5b[_0x33df43(0x152)](0xc8)[_0x33df43(0x151)]({'message':_0x2f1b53['message']});}}),router[a0_0x32f86e(0x16f)](a0_0x32f86e(0x13f),async(_0xfe674c,_0xeaeb65)=>{const _0x47ac1c=a0_0x32f86e;_0xeaeb65[_0x47ac1c(0x14b)](_0x47ac1c(0x162),{'success':_0xfe674c[_0x47ac1c(0x16b)](_0x47ac1c(0x165)),'errors':_0xfe674c['flash']('errors')});}),router['get'](a0_0x32f86e(0x145),async(_0x13b5c7,_0x3f8382)=>{const _0x510df8=a0_0x32f86e;var _0x37d53d=await purchases[_0x510df8(0x176)]([{'$lookup':{'from':'warehouses','let':{'invoice':_0x510df8(0x13e)},'pipeline':[{'$unwind':_0x510df8(0x13d)},{'$match':{'$expr':{'$eq':[_0x510df8(0x166),'$product_details.invoice']}}},{'$project':{'_id':_0x510df8(0x168),'product_name':'$product_details.product_name','product_code':_0x510df8(0x15e),'quantity_available':'$product_details.product_stock','warehouse_name':_0x510df8(0x167),'warehouse_room':'$room','invoice':_0x510df8(0x136)}}],'as':'warehouse_data'}}]);_0x37d53d[_0x510df8(0x15d)]={},await Promise[_0x510df8(0x144)](_0x37d53d['map'](async _0x16a9b0=>{const _0x5b74cd=_0x510df8;_0x37d53d[_0x5b74cd(0x15d)][_0x16a9b0['invoice']]=[],await Promise[_0x5b74cd(0x144)](_0x16a9b0[_0x5b74cd(0x142)][_0x5b74cd(0x161)](async _0x11dc5c=>{const _0x1501fd=_0x5b74cd,_0x133ed0=await sales['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x11dc5c[_0x1501fd(0x158)][_0x1501fd(0x138)](),'sale_product.invoice':_0x11dc5c['invoice']}},{'$project':{'_id':_0x1501fd(0x160),'product_name':_0x1501fd(0x154),'product_code':_0x1501fd(0x164),'quantity_available':'$sale_product.quantity','warehouse_name':_0x1501fd(0x14a),'warehouse_room':'$sale_product.room_name','product_invoice':_0x1501fd(0x16c),'invoice':_0x1501fd(0x13e),'id_transaction_from':_0x1501fd(0x141)}}]);_0x133ed0['length']>0x0&&_0x37d53d[_0x1501fd(0x15d)][_0x16a9b0['invoice']][_0x1501fd(0x14f)](..._0x133ed0);}));})),_0x37d53d[_0x510df8(0x15d)]=_0x37d53d[_0x510df8(0x15d)],_0x37d53d[_0x510df8(0x14e)]={},await Promise[_0x510df8(0x144)](_0x37d53d[_0x510df8(0x161)](async _0x1e30d3=>{const _0x39d42a=_0x510df8;_0x37d53d['data_adjustment'][_0x1e30d3[_0x39d42a(0x137)]]=[],await Promise[_0x39d42a(0x144)](_0x1e30d3[_0x39d42a(0x142)][_0x39d42a(0x161)](async _0x167dfa=>{const _0x2059c3=_0x39d42a,_0x4d3032=await adjustment[_0x2059c3(0x176)]([{'$unwind':_0x2059c3(0x15c)},{'$match':{'product.id_transaction_from':_0x167dfa[_0x2059c3(0x158)]['valueOf'](),'product.invoice':_0x167dfa[_0x2059c3(0x137)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x2059c3(0x153),'quantity_available':_0x2059c3(0x175),'warehouse_name':_0x2059c3(0x14a),'warehouse_room':_0x2059c3(0x148),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':_0x2059c3(0x157)}}]);_0x4d3032[_0x2059c3(0x150)]>0x0&&_0x37d53d[_0x2059c3(0x14e)][_0x1e30d3[_0x2059c3(0x137)]][_0x2059c3(0x14f)](..._0x4d3032);}));})),_0x37d53d[_0x510df8(0x13b)]={},await Promise[_0x510df8(0x144)](_0x37d53d['map'](async _0x53caa3=>{const _0x3354ea=_0x510df8;_0x37d53d['data_transfer'][_0x53caa3[_0x3354ea(0x137)]]=[],await Promise[_0x3354ea(0x144)](_0x53caa3['warehouse_data'][_0x3354ea(0x161)](async _0x47799e=>{const _0x2d156c=_0x3354ea,_0x2bfaff=await transfers['aggregate']([{'$unwind':_0x2d156c(0x15c)},{'$match':{'product.id_transaction_id':_0x47799e[_0x2d156c(0x158)]['valueOf'](),'product.To_invoice':_0x47799e[_0x2d156c(0x137)]}},{'$project':{'_id':'$product._id','product_name':_0x2d156c(0x15b),'product_code':_0x2d156c(0x153),'quantity_available':_0x2d156c(0x149),'warehouse_name':'$to_warehouse','warehouse_room':_0x2d156c(0x148),'product_invoice':_0x2d156c(0x156),'invoice':_0x2d156c(0x13e),'id_transaction_id':_0x2d156c(0x140)}}]);console[_0x2d156c(0x13c)](_0x2bfaff),_0x2bfaff[_0x2d156c(0x150)]>0x0&&_0x37d53d[_0x2d156c(0x13b)][_0x53caa3[_0x2d156c(0x137)]][_0x2d156c(0x14f)](..._0x2bfaff);}));})),_0x3f8382[_0x510df8(0x151)]({'purchases_warehouse':_0x37d53d,'data_sales':_0x37d53d[_0x510df8(0x15d)],'data_adjustment':_0x37d53d[_0x510df8(0x14e)],'data_transfer':_0x37d53d[_0x510df8(0x13b)]});}),module['exports']=router;