const a0_0x2387b9=a0_0x3cbb;(function(_0x5130c4,_0x2f876a){const _0x500924=a0_0x3cbb,_0x509957=_0x5130c4();while(!![]){try{const _0xa781de=-parseInt(_0x500924(0xb1))/0x1*(parseInt(_0x500924(0x79))/0x2)+-parseInt(_0x500924(0x87))/0x3*(-parseInt(_0x500924(0x90))/0x4)+-parseInt(_0x500924(0x77))/0x5+parseInt(_0x500924(0x99))/0x6*(parseInt(_0x500924(0xac))/0x7)+parseInt(_0x500924(0x89))/0x8*(parseInt(_0x500924(0x74))/0x9)+parseInt(_0x500924(0xae))/0xa*(-parseInt(_0x500924(0x82))/0xb)+parseInt(_0x500924(0x92))/0xc;if(_0xa781de===_0x2f876a)break;else _0x509957['push'](_0x509957['shift']());}catch(_0x3b7689){_0x509957['push'](_0x509957['shift']());}}}(a0_0x44c6,0x62fb6));const express=require('express'),app=express(),router=express[a0_0x2387b9(0xa7)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x2387b9(0x7f));function a0_0x3cbb(_0x452bcb,_0x3ae072){const _0x44c6fd=a0_0x44c6();return a0_0x3cbb=function(_0x3cbbd8,_0x3bfa78){_0x3cbbd8=_0x3cbbd8-0x73;let _0x4a3a94=_0x44c6fd[_0x3cbbd8];return _0x4a3a94;},a0_0x3cbb(_0x452bcb,_0x3ae072);}router[a0_0x2387b9(0x8d)]('/negative',async(_0x35ea24,_0x5d5eb9)=>{const _0xf45a0d=a0_0x2387b9;try{const _0x23a5f7=await warehouse[_0xf45a0d(0x8c)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x5d5eb9['json']({'status':_0x23a5f7[_0xf45a0d(0x7e)]+_0xf45a0d(0x9b)});}catch(_0x24a1a1){console[_0xf45a0d(0x9d)](_0xf45a0d(0x98),_0x24a1a1),_0x5d5eb9[_0xf45a0d(0x7d)](0xc8)[_0xf45a0d(0x96)]({'message':_0x24a1a1[_0xf45a0d(0x83)]});}}),router[a0_0x2387b9(0x8d)]('/checking',async(_0x5ddc36,_0x2e9760)=>{const _0x56b742=a0_0x2387b9;try{const _0x43766d=await warehouse[_0x56b742(0xab)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0x56b742(0xb0),'product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0x56b742(0x85),'room':_0x56b742(0x7a)},'products':{'$push':_0x56b742(0xaf)}}}]);_0x2e9760[_0x56b742(0x96)](_0x43766d);}catch(_0x3c1530){console['log']('table\x20page',_0x3c1530),_0x2e9760['status'](0xc8)[_0x56b742(0x96)]({'message':_0x3c1530['message']});}}),router[a0_0x2387b9(0x8d)]('/warehouse_monitor',async(_0x4a071c,_0x26ec2e)=>{const _0x38b91f=a0_0x2387b9;_0x26ec2e[_0x38b91f(0xa1)](_0x38b91f(0xa6),{'success':_0x4a071c[_0x38b91f(0xa9)](_0x38b91f(0x81)),'errors':_0x4a071c[_0x38b91f(0xa9)](_0x38b91f(0x9e))});}),router[a0_0x2387b9(0x8d)]('/join',async(_0x5cb8ea,_0x4e56f4)=>{const _0x5d8d55=a0_0x2387b9;var _0xc44c17=await purchases[_0x5d8d55(0xab)]([{'$lookup':{'from':_0x5d8d55(0x8a),'let':{'invoice':_0x5d8d55(0x91)},'pipeline':[{'$unwind':_0x5d8d55(0xaf)},{'$match':{'$expr':{'$eq':['$$invoice',_0x5d8d55(0x93)]}}},{'$project':{'_id':_0x5d8d55(0xb5),'product_name':_0x5d8d55(0x8f),'product_code':_0x5d8d55(0x78),'quantity_available':_0x5d8d55(0xb4),'warehouse_name':'$name','warehouse_room':_0x5d8d55(0x7a),'invoice':'$product_details.invoice'}}],'as':_0x5d8d55(0xa8)}}]);_0xc44c17[_0x5d8d55(0x76)]={},await Promise[_0x5d8d55(0x97)](_0xc44c17['map'](async _0x3c573e=>{const _0x1077ab=_0x5d8d55;_0xc44c17[_0x1077ab(0x76)][_0x3c573e[_0x1077ab(0x73)]]=[],await Promise[_0x1077ab(0x97)](_0x3c573e[_0x1077ab(0xa8)][_0x1077ab(0x86)](async _0x59af16=>{const _0xbfc37f=_0x1077ab,_0x7e8f83=await sales[_0xbfc37f(0xab)]([{'$unwind':_0xbfc37f(0x8e)},{'$match':{'sale_product.id_transaction_from':_0x59af16[_0xbfc37f(0xa3)][_0xbfc37f(0x7b)](),'sale_product.invoice':_0x59af16[_0xbfc37f(0x73)]}},{'$project':{'_id':'$sale_product._id','product_name':_0xbfc37f(0x95),'product_code':_0xbfc37f(0xaa),'quantity_available':_0xbfc37f(0x9c),'warehouse_name':_0xbfc37f(0xa5),'warehouse_room':'$sale_product.room_name','product_invoice':_0xbfc37f(0x88),'invoice':_0xbfc37f(0x91),'id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x7e8f83[_0xbfc37f(0x75)]>0x0&&_0xc44c17[_0xbfc37f(0x76)][_0x3c573e[_0xbfc37f(0x73)]][_0xbfc37f(0xa4)](..._0x7e8f83);}));})),_0xc44c17[_0x5d8d55(0x76)]=_0xc44c17[_0x5d8d55(0x76)],_0xc44c17[_0x5d8d55(0xb2)]={},await Promise[_0x5d8d55(0x97)](_0xc44c17[_0x5d8d55(0x86)](async _0x231bfe=>{const _0x4a1dcc=_0x5d8d55;_0xc44c17['data_adjustment'][_0x231bfe[_0x4a1dcc(0x73)]]=[],await Promise[_0x4a1dcc(0x97)](_0x231bfe['warehouse_data'][_0x4a1dcc(0x86)](async _0x415886=>{const _0x2b6cab=_0x4a1dcc,_0x31e26c=await adjustment['aggregate']([{'$unwind':_0x2b6cab(0x80)},{'$match':{'product.id_transaction_from':_0x415886[_0x2b6cab(0xa3)][_0x2b6cab(0x7b)](),'product.invoice':_0x415886['invoice']}},{'$project':{'_id':_0x2b6cab(0x94),'product_name':_0x2b6cab(0xa0),'product_code':_0x2b6cab(0xa2),'quantity_available':_0x2b6cab(0x9f),'warehouse_name':_0x2b6cab(0xa5),'warehouse_room':_0x2b6cab(0xad),'product_invoice':_0x2b6cab(0x7c),'invoice':_0x2b6cab(0x91),'id_transaction_from':_0x2b6cab(0x9a)}}]);_0x31e26c[_0x2b6cab(0x75)]>0x0&&_0xc44c17[_0x2b6cab(0xb2)][_0x231bfe['invoice']][_0x2b6cab(0xa4)](..._0x31e26c);}));})),_0xc44c17['data_transfer']={},await Promise['all'](_0xc44c17[_0x5d8d55(0x86)](async _0x2d42fc=>{const _0x274a84=_0x5d8d55;_0xc44c17['data_transfer'][_0x2d42fc[_0x274a84(0x73)]]=[],await Promise[_0x274a84(0x97)](_0x2d42fc['warehouse_data'][_0x274a84(0x86)](async _0x240e27=>{const _0x2142eb=_0x274a84,_0x2d9909=await transfers['aggregate']([{'$unwind':_0x2142eb(0x80)},{'$match':{'product.id_transaction_id':_0x240e27[_0x2142eb(0xa3)]['valueOf'](),'product.To_invoice':_0x240e27[_0x2142eb(0x73)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x2142eb(0xa2),'quantity_available':'$product.to_quantity','warehouse_name':_0x2142eb(0xb3),'warehouse_room':'$product.room_names','product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_id':_0x2142eb(0x8b)}}]);console[_0x2142eb(0x9d)](_0x2d9909),_0x2d9909[_0x2142eb(0x75)]>0x0&&_0xc44c17[_0x2142eb(0x84)][_0x2d42fc[_0x2142eb(0x73)]][_0x2142eb(0xa4)](..._0x2d9909);}));})),_0x4e56f4[_0x5d8d55(0x96)]({'purchases_warehouse':_0xc44c17,'data_sales':_0xc44c17[_0x5d8d55(0x76)],'data_adjustment':_0xc44c17[_0x5d8d55(0xb2)],'data_transfer':_0xc44c17[_0x5d8d55(0x84)]});}),module['exports']=router;function a0_0x44c6(){const _0x45cc27=['$product.id_transaction_from','\x20documents\x20updated','$sale_product.quantity','log','errors','$product.new_adjust_qty','$product.product_name','render','$product.product_code','_id','push','$warehouse_name','monitor','Router','warehouse_data','flash','$sale_product.product_code','aggregate','7EKcBGA','$product.room_names','1981880hMYUxA','$product_details','INCF-52068316','271ypuALk','data_adjustment','$to_warehouse','$product_details.product_stock','$product_details._id','invoice','2404233btAihY','length','data_sales','65335nQceTN','$product_details.product_code','5574ISEVbI','$room','valueOf','$product.invoice','status','modifiedCount','../../models/all_models','$product','success','22ujgION','message','data_transfer','$name','map','3ubvoEZ','$sale_product.invoice','8cOKrDW','warehouses','$product.id_transaction_id','updateMany','get','$sale_product','$product_details.product_name','130228aAFaVz','$invoice','13510188TalKUw','$product_details.invoice','$product._id','$sale_product.product_name','json','all','table\x20page','867642JnbEFC'];a0_0x44c6=function(){return _0x45cc27;};return a0_0x44c6();}