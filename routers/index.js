const a0_0x131da4=a0_0x154e;(function(_0x540bf0,_0x4a7390){const _0x1af820=a0_0x154e,_0x362bf1=_0x540bf0();while(!![]){try{const _0x1d7ccf=-parseInt(_0x1af820(0x202))/0x1*(-parseInt(_0x1af820(0x1c1))/0x2)+-parseInt(_0x1af820(0x1f0))/0x3+parseInt(_0x1af820(0x1aa))/0x4+parseInt(_0x1af820(0x1ee))/0x5+-parseInt(_0x1af820(0x1fd))/0x6+-parseInt(_0x1af820(0x21d))/0x7*(parseInt(_0x1af820(0x1c7))/0x8)+parseInt(_0x1af820(0x1d9))/0x9;if(_0x1d7ccf===_0x4a7390)break;else _0x362bf1['push'](_0x362bf1['shift']());}catch(_0x4b1d4c){_0x362bf1['push'](_0x362bf1['shift']());}}}(a0_0x2117,0xd3f58));function a0_0x154e(_0x8710ca,_0x3cb5dc){const _0x2117c1=a0_0x2117();return a0_0x154e=function(_0x154ec4,_0x2dc18a){_0x154ec4=_0x154ec4-0x1a6;let _0x4c2d28=_0x2117c1[_0x154ec4];return _0x4c2d28;},a0_0x154e(_0x8710ca,_0x3cb5dc);}const express=require(a0_0x131da4(0x200)),app=express(),router=express[a0_0x131da4(0x201)](),auth=require(a0_0x131da4(0x1a9)),{profile,sales,sales_return,purchases,purchases_return,categories,product,suppliers,customer,master_shop,transfers,adjustment,purchases_finished,sales_finished,adjustment_finished,transfers_finished,staff,sales_sa,sales_order}=require(a0_0x131da4(0x20d)),users=require(a0_0x131da4(0x20f));router[a0_0x131da4(0x1e8)](a0_0x131da4(0x1e9),auth,async(_0x3bd60e,_0xb153eb)=>{const _0x1c8778=a0_0x131da4;try{const {username:_0x4bd8bf,email:_0x5b38ef,role:_0x262f77}=_0x3bd60e[_0x1c8778(0x1f8)],_0x30655c=_0x3bd60e[_0x1c8778(0x1f8)],_0xa90069=await master_shop[_0x1c8778(0x1c3)](),_0x9a3537=await profile[_0x1c8778(0x1fa)]({'email':_0x30655c[_0x1c8778(0x1c0)]});if(_0xa90069[0x0][_0x1c8778(0x1e0)]==_0x1c8778(0x1c4))var _0x27d2bc=users[_0x1c8778(0x209)];else{if(_0xa90069[0x0][_0x1c8778(0x1e0)]==_0x1c8778(0x20b))var _0x27d2bc=users[_0x1c8778(0x20b)];else{if(_0xa90069[0x0][_0x1c8778(0x1e0)]==_0x1c8778(0x211))var _0x27d2bc=users[_0x1c8778(0x211)];else{if(_0xa90069[0x0]['language']==_0x1c8778(0x1f5))var _0x27d2bc=users[_0x1c8778(0x1f5)];else{if(_0xa90069[0x0][_0x1c8778(0x1e0)]==_0x1c8778(0x1f1))var _0x27d2bc=users['French'];else{if(_0xa90069[0x0]['language']==_0x1c8778(0x1f3))var _0x27d2bc=users['Portuguese'];else{if(_0xa90069[0x0]['language']==_0x1c8778(0x1e5))var _0x27d2bc=users[_0x1c8778(0x1e5)];else{if(_0xa90069[0x0][_0x1c8778(0x1e0)]=='Arabic\x20(ae)')var _0x27d2bc=users['Arabic'];}}}}}}}if(_0x30655c['account_category']=='wm'){var _0x48f9b8;if(_0x30655c[_0x1c8778(0x1d0)]==_0x1c8778(0x1df)){const _0x4b0ef7=await product[_0x1c8778(0x1c3)]({'product_category':_0x1c8778(0x1df)});_0x48f9b8=_0x4b0ef7[_0x1c8778(0x1cc)];}else{if(_0x30655c[_0x1c8778(0x1d0)]==_0x1c8778(0x1d5)){const _0x515dff=await product['find']({'product_category':_0x1c8778(0x1d5)});_0x48f9b8=_0x515dff[_0x1c8778(0x1cc)];}else{const _0x312413=await product['find']();_0x48f9b8=_0x312413['length'];}}const _0x1e5b2a=await sales['aggregate']([{'$group':{'_id':null,'total_price':{'$sum':'$total_price'}}}]),_0x2bf101=await sales[_0x1c8778(0x1a8)]([{'$unwind':_0x1c8778(0x218)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1c8778(0x1d3)}}}]),_0x389ce3=await sales_return[_0x1c8778(0x1a8)]([{'$group':{'_id':null,'total':{'$sum':_0x1c8778(0x225)}}}]),_0x594126=await sales_return[_0x1c8778(0x1a8)]([{'$unwind':_0x1c8778(0x1af)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$return_sale.sale_qty'}}}]),_0x3bf056=await purchases['aggregate']([{'$group':{'_id':null,'total_amount':{'$sum':_0x1c8778(0x225)}}}]),_0x42b41b=await purchases_return['aggregate']([{'$group':{'_id':null,'total':{'$sum':_0x1c8778(0x225)}}}]),_0x2df99b=await purchases_return['aggregate']([{'$unwind':'$return_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1c8778(0x1e1)}}}]),_0x8a32a2=await purchases[_0x1c8778(0x1a8)]([{'$unwind':_0x1c8778(0x1c8)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1c8778(0x1b5)}}}]),_0x18147a=await purchases[_0x1c8778(0x1a8)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x258558=await sales[_0x1c8778(0x1a8)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x16b843=await transfers[_0x1c8778(0x1a8)]([{'$unwind':_0x1c8778(0x1c8)},{'$group':{'_id':_0x1c8778(0x1d1),'fromWarehouse':{'$first':_0x1c8778(0x1f4)},'toWareHouse':{'$first':_0x1c8778(0x1ec)},'FromtotalQuantity':{'$sum':_0x1c8778(0x1ad)},'TototalQuantity':{'$sum':_0x1c8778(0x1b4)}}}]),_0x1d884d=await categories['find'](),_0x2cafd4=await product['find'](),_0x38c772=await suppliers['find'](),_0x3611b9=await customer['find']();_0xb153eb[_0x1c8778(0x1b7)]('index',{'success':_0x3bd60e[_0x1c8778(0x224)](_0x1c8778(0x219)),'errors':_0x3bd60e[_0x1c8778(0x224)](_0x1c8778(0x1eb)),'role':_0x30655c,'profile':_0x9a3537,'sale':_0x1e5b2a[0x0],'sales_return':_0x389ce3[0x0],'purchases':_0x3bf056[0x0],'purchases_return':_0x42b41b[0x0],'purchases_table':_0x18147a,'sales_table':_0x258558,'categories':_0x1d884d['length'],'product':_0x2cafd4['length'],'suppliers':_0x38c772[_0x1c8778(0x1cc)],'customer':_0x3611b9[_0x1c8778(0x1cc)],'master_shop':_0xa90069,'language':_0x27d2bc,'sale_QTY':_0x2bf101[0x0],'purchases_QTY':_0x8a32a2[0x0],'sales_return_QTY':_0x594126[0x0],'purchases_return_QTY':_0x2df99b[0x0],'transfer_table':_0x16b843,'product_cnt':_0x48f9b8});}else{if(_0x30655c['account_category']=='sa'){const _0x513b6d=await staff[_0x1c8778(0x1fa)]({'email':_0x30655c[_0x1c8778(0x1c0)]}),_0x4bc9b6=await sales_sa[_0x1c8778(0x1c3)]({'sales_staff_id':_0x513b6d[_0x1c8778(0x204)]}),_0x1fd22f=await sales_sa[_0x1c8778(0x1c3)]({'sales_staff_id':_0x513b6d[_0x1c8778(0x204)],'paid':_0x1c8778(0x1ef)}),_0x30c6bc=await sales_sa['find']({'sales_staff_id':_0x513b6d[_0x1c8778(0x204)],'paid':'False'}),_0x45e38a=await sales_sa[_0x1c8778(0x1a8)]([{'$match':{'sales_staff_id':_0x513b6d[_0x1c8778(0x204)][_0x1c8778(0x1b0)]()}},{'$unwind':_0x1c8778(0x218)},{'$group':{'_id':null,'sumprice':{'$sum':_0x1c8778(0x1ff)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':[_0x1c8778(0x1b3),_0x1c8778(0x21b)]},0x2]}}}]),_0x1d585c=await staff[_0x1c8778(0x1a8)]([{'$match':{'email':_0x30655c[_0x1c8778(0x1c0)]}},{'$unwind':_0x1c8778(0x1bb)},{'$group':{'_id':null,'totalQTY':{'$sum':_0x1c8778(0x1f9)}}}]);_0xb153eb[_0x1c8778(0x1b7)](_0x1c8778(0x1b1),{'success':_0x3bd60e[_0x1c8778(0x224)](_0x1c8778(0x219)),'errors':_0x3bd60e[_0x1c8778(0x224)](_0x1c8778(0x1eb)),'role':_0x30655c,'profile':_0x9a3537,'master_shop':_0xa90069,'language':_0x27d2bc,'cntPaid':_0x1fd22f,'cntNotPaid':_0x30c6bc,'avg_price':_0x45e38a[0x0],'my_stock':_0x1d585c[0x0],'staff_arr':_0x513b6d});}else{if(_0x30655c[_0x1c8778(0x1de)]==_0x1c8778(0x1e6)){const _0xfb5099=await staff[_0x1c8778(0x1fa)]({'email':_0x30655c[_0x1c8778(0x1c0)]});_0xb153eb[_0x1c8778(0x1b7)](_0x1c8778(0x1a6),{'success':_0x3bd60e[_0x1c8778(0x224)](_0x1c8778(0x219)),'errors':_0x3bd60e[_0x1c8778(0x224)]('errors'),'role':_0x30655c,'profile':_0x9a3537,'master_shop':_0xa90069,'language':_0x27d2bc}),_0xb153eb['json'](_0xfb5099);}else{if(_0x30655c['account_category']=='sad'||_0x30655c['account_category']=='rsm'||_0x30655c['account_category']==_0x1c8778(0x1c5)){const _0x1da8c1=await staff[_0x1c8778(0x1fa)]({'email':_0x30655c[_0x1c8778(0x1c0)]});_0xb153eb[_0x1c8778(0x1b7)](_0x1c8778(0x1da),{'success':_0x3bd60e[_0x1c8778(0x224)]('success'),'errors':_0x3bd60e['flash'](_0x1c8778(0x1eb)),'role':_0x30655c,'profile':_0x9a3537,'master_shop':_0xa90069,'language':_0x27d2bc});}else{var _0x48f9b8;if(_0x30655c[_0x1c8778(0x1d0)]=='Raw\x20Materials'){const _0x4c2308=await product['find']({'product_category':_0x1c8778(0x1df)});_0x48f9b8=_0x4c2308[_0x1c8778(0x1cc)];}else{if(_0x30655c[_0x1c8778(0x1d0)]==_0x1c8778(0x1d5)){const _0x96439e=await product[_0x1c8778(0x1c3)]({'product_category':_0x1c8778(0x1d5)});_0x48f9b8=_0x96439e['length'];}else{const _0x1eeb08=await product['find']();_0x48f9b8=_0x1eeb08['length'];}}const _0x3e7709=await sales[_0x1c8778(0x1a8)]([{'$group':{'_id':null,'total_price':{'$sum':_0x1c8778(0x1ce)}}}]),_0x39ac04=await sales[_0x1c8778(0x1a8)]([{'$unwind':_0x1c8778(0x218)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1c8778(0x1d3)}}}]),_0x46e62f=await sales_return[_0x1c8778(0x1a8)]([{'$group':{'_id':null,'total':{'$sum':_0x1c8778(0x225)}}}]),_0x241161=await sales_return[_0x1c8778(0x1a8)]([{'$unwind':_0x1c8778(0x1af)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$return_sale.sale_qty'}}}]),_0x5393bd=await purchases[_0x1c8778(0x1a8)]([{'$group':{'_id':null,'total_amount':{'$sum':_0x1c8778(0x225)}}}]),_0x325965=await purchases_return['aggregate']([{'$group':{'_id':null,'total':{'$sum':_0x1c8778(0x225)}}}]),_0x11faa5=await purchases_return['aggregate']([{'$unwind':'$return_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1c8778(0x1e1)}}}]),_0x4c5825=await purchases[_0x1c8778(0x1a8)]([{'$unwind':_0x1c8778(0x1c8)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1c8778(0x1b5)}}}]),_0x381d61=await purchases[_0x1c8778(0x1a8)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x5193d7=await sales[_0x1c8778(0x1a8)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x3a84a8=await transfers[_0x1c8778(0x1a8)]([{'$unwind':_0x1c8778(0x1c8)},{'$group':{'_id':_0x1c8778(0x1d1),'fromWarehouse':{'$first':_0x1c8778(0x1f4)},'toWareHouse':{'$first':_0x1c8778(0x1ec)},'FromtotalQuantity':{'$sum':_0x1c8778(0x1ad)},'TototalQuantity':{'$sum':'$product.to_quantity'}}}]),_0x5126d8=await categories[_0x1c8778(0x1c3)](),_0x253365=await product['find'](),_0x14aab8=await suppliers[_0x1c8778(0x1c3)](),_0x44b459=await customer[_0x1c8778(0x1c3)]();_0xb153eb['render']('index',{'success':_0x3bd60e[_0x1c8778(0x224)](_0x1c8778(0x219)),'errors':_0x3bd60e[_0x1c8778(0x224)](_0x1c8778(0x1eb)),'role':_0x30655c,'profile':_0x9a3537,'sale':_0x3e7709[0x0],'sales_return':_0x46e62f[0x0],'purchases':_0x5393bd[0x0],'purchases_return':_0x325965[0x0],'purchases_table':_0x381d61,'sales_table':_0x5193d7,'categories':_0x5126d8['length'],'product':_0x253365[_0x1c8778(0x1cc)],'suppliers':_0x14aab8['length'],'customer':_0x44b459[_0x1c8778(0x1cc)],'master_shop':_0xa90069,'language':_0x27d2bc,'sale_QTY':_0x39ac04[0x0],'purchases_QTY':_0x4c5825[0x0],'sales_return_QTY':_0x241161[0x0],'purchases_return_QTY':_0x11faa5[0x0],'transfer_table':_0x3a84a8,'product_cnt':_0x48f9b8});}}}}}catch(_0x604c48){console[_0x1c8778(0x20c)](_0x604c48);}}),router[a0_0x131da4(0x1e8)]('/pending_data_table',auth,async(_0x5dd7ca,_0x3bdece)=>{const _0x3bf175=a0_0x131da4;try{const _0x1f4c9b=_0x5dd7ca[_0x3bf175(0x1f8)],_0x4ba9d0=await staff[_0x3bf175(0x1fa)]({'email':_0x1f4c9b[_0x3bf175(0x1c0)]}),_0x44d3aa=await sales_sa[_0x3bf175(0x1a8)]([{'$match':{'sales_staff_id':_0x4ba9d0[_0x3bf175(0x204)][_0x3bf175(0x1b0)](),'paid':'False'}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x3bdece[_0x3bf175(0x1fe)](_0x44d3aa);}catch(_0x334317){_0x3bdece[_0x3bf175(0x1fe)](_0x334317);}}),router[a0_0x131da4(0x1e8)](a0_0x131da4(0x1f7),auth,async(_0x44babc,_0x56dc51)=>{const _0x25915f=a0_0x131da4;try{const _0x42944b=_0x44babc['user'],_0x3102ae=await staff[_0x25915f(0x1fa)]({'email':_0x42944b[_0x25915f(0x1c0)]}),_0x57661d=await sales_sa[_0x25915f(0x1c3)]({'sales_staff_id':_0x3102ae[_0x25915f(0x204)],'paid':_0x25915f(0x1e4)});_0x56dc51[_0x25915f(0x1fe)](_0x57661d);}catch(_0x134b9d){_0x56dc51[_0x25915f(0x1fe)](_0x134b9d);}}),router[a0_0x131da4(0x221)](a0_0x131da4(0x1ca),auth,async(_0x3bb6e6,_0x49804f)=>{const _0x4baabb=a0_0x131da4;try{const {sttaff_id:_0x29018c,warehouse:_0x2a5061,account_category:_0x381579}=_0x3bb6e6['user'],_0x1f925c=await sales_order['aggregate']([{'$match':{'accounting_account_id':_0x29018c,'accounting_account_confirm':_0x4baabb(0x1ed)}}]);_0x49804f[_0x4baabb(0x1fe)](_0x1f925c);}catch(_0x559c99){}}),router['get'](a0_0x131da4(0x1e3),auth,async(_0x335c2a,_0x2600f5)=>{const _0x564dcb=a0_0x131da4;try{const _0x51b18d=_0x335c2a['user'],_0x3d06d0=await staff[_0x564dcb(0x1fa)]({'email':_0x51b18d['email']}),_0x1172e3=await sales_sa[_0x564dcb(0x1c3)]({'sales_staff_id':_0x3d06d0[_0x564dcb(0x204)],'paid':_0x564dcb(0x1ef)});_0x2600f5[_0x564dcb(0x1fe)](_0x1172e3);}catch(_0x54ab76){_0x2600f5[_0x564dcb(0x1fe)](_0x54ab76);}}),router[a0_0x131da4(0x1e8)](a0_0x131da4(0x20e),auth,async(_0x986855,_0x38672c)=>{const _0x21fc1c=a0_0x131da4;try{const _0x3d5431=_0x986855[_0x21fc1c(0x1f8)],_0x4ef88d=await staff[_0x21fc1c(0x1fa)]({'email':_0x3d5431['email']}),_0xab094a=await sales_sa[_0x21fc1c(0x1a8)]([{'$match':{'sales_staff_id':_0x4ef88d[_0x21fc1c(0x204)][_0x21fc1c(0x1b0)](),'paid':'True'}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x38672c[_0x21fc1c(0x1fe)](_0xab094a);}catch(_0x4ae97e){_0x38672c[_0x21fc1c(0x1fe)](_0x4ae97e);}}),router[a0_0x131da4(0x221)](a0_0x131da4(0x1d2),auth,async(_0x2e83d9,_0x4fc00d)=>{const _0x44992e=a0_0x131da4;try{const {id:_0x1d12c5,price:_0x156b90}=_0x2e83d9[_0x44992e(0x1cd)],_0x22ec02=await sales_sa[_0x44992e(0x1b8)](_0x1d12c5);_0x22ec02[_0x44992e(0x1bd)]='True',_0x22ec02['collection_price']=parseFloat(_0x156b90);const _0x7b762c=await _0x22ec02[_0x44992e(0x205)]();_0x4fc00d[_0x44992e(0x1fe)](_0x7b762c);}catch(_0x19a5e7){_0x4fc00d['json'](_0x19a5e7);}}),router[a0_0x131da4(0x1e8)]('/pending_data',auth,async(_0x5b64ba,_0x30c0a6)=>{const _0x18952b=a0_0x131da4;try{const _0x453672=_0x5b64ba[_0x18952b(0x1f8)],_0x48c5c8=await staff[_0x18952b(0x1fa)]({'email':_0x453672[_0x18952b(0x1c0)]}),_0x1f45a6=await sales_sa[_0x18952b(0x1c3)]({'sales_staff_id':_0x48c5c8[_0x18952b(0x204)],'paid':_0x18952b(0x1e4)});_0x30c0a6[_0x18952b(0x1fe)](_0x1f45a6);}catch(_0x3cfd16){_0x30c0a6[_0x18952b(0x1fe)](_0x3cfd16);}}),router['get'](a0_0x131da4(0x1d4),auth,async(_0x4523d4,_0x5af766)=>{const _0x4297f4=a0_0x131da4;try{const _0x44bbf3=_0x4523d4['user'],_0x246f4a=await staff['findOne']({'email':_0x44bbf3['email']}),_0x2320d3=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x246f4a['_id'][_0x4297f4(0x1b0)]()}},{'$unwind':'$sale_product'},{'$group':{'_id':null,'sumprice':{'$sum':_0x4297f4(0x1ff)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':[_0x4297f4(0x1b3),'$count']},0x2]}}}]);_0x5af766[_0x4297f4(0x1fe)](_0x2320d3);}catch(_0x9e1d66){_0x5af766[_0x4297f4(0x1fe)](_0x9e1d66);}}),router[a0_0x131da4(0x1e8)](a0_0x131da4(0x220),auth,async(_0x5d16d6,_0x1f2b8f)=>{const _0x264ba9=a0_0x131da4;try{const _0x37f537=_0x5d16d6[_0x264ba9(0x1f8)],_0x596dce=await staff[_0x264ba9(0x1fa)]({'email':_0x37f537[_0x264ba9(0x1c0)]}),_0x5d9348=await staff[_0x264ba9(0x1a8)]([{'$match':{'email':_0x37f537[_0x264ba9(0x1c0)]}},{'$unwind':_0x264ba9(0x1bb)},{'$match':{'product_list.isConfirm':_0x264ba9(0x1c2)}},{'$group':{'_id':null,'totalQTY':{'$sum':_0x264ba9(0x1f9)}}}]);_0x1f2b8f['json'](_0x5d9348);}catch(_0x408382){_0x1f2b8f[_0x264ba9(0x1fe)](_0x408382);}}),router[a0_0x131da4(0x1e8)](a0_0x131da4(0x215),auth,async(_0x2a3640,_0xb4e5fe)=>{const _0x59cae3=a0_0x131da4;try{const _0x5b1d21=_0x2a3640['user'],_0x5b7446=await staff['findOne']({'email':_0x5b1d21[_0x59cae3(0x1c0)]}),_0x298333=await sales_sa[_0x59cae3(0x1a8)]([{'$match':{'sales_staff_id':_0x5b7446[_0x59cae3(0x204)]['valueOf']()}},{'$unwind':_0x59cae3(0x218)},{'$group':{'_id':_0x59cae3(0x1ab),'totalQuantity':{'$sum':_0x59cae3(0x1d3)},'date':{'$first':_0x59cae3(0x1ab)}}},{'$sort':{'date':0x1}}]);_0xb4e5fe['json'](_0x298333);}catch(_0x16ec9a){_0xb4e5fe[_0x59cae3(0x1fe)](_0x16ec9a);}}),router[a0_0x131da4(0x1e8)](a0_0x131da4(0x210),auth,async(_0x33e691,_0x580b35)=>{const _0x3c4538=a0_0x131da4;try{const _0x2e8255=_0x33e691[_0x3c4538(0x1f8)],_0x4a0d55=await staff[_0x3c4538(0x1fa)]({'email':_0x2e8255['email']}),_0x17294c=await sales_sa[_0x3c4538(0x1a8)]([{'$match':{'sales_staff_id':_0x4a0d55[_0x3c4538(0x204)]['valueOf']()}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x3c4538(0x1ab),'totalPrice':{'$sum':'$sale_product.totalprice'},'date':{'$first':_0x3c4538(0x1ab)}}},{'$sort':{'date':0x1}}]);_0x580b35['json'](_0x17294c);}catch(_0x495165){_0x580b35[_0x3c4538(0x1fe)](_0x495165);}}),router[a0_0x131da4(0x221)](a0_0x131da4(0x1ba),auth,async(_0x12e598,_0x464e8d)=>{const _0xf4dc1a=a0_0x131da4;try{const {date_today:_0x10d6ae,first_month:_0x552843,first_year:_0x46eaa3}=_0x12e598[_0xf4dc1a(0x1cd)],{sttaff_id:_0x59ac8}=_0x12e598[_0xf4dc1a(0x1f8)],_0x2a4f7d=await product['aggregate']([{'$group':{'_id':{'brand':_0xf4dc1a(0x1e7),'category':_0xf4dc1a(0x1b6)},'products':{'$push':{'name':_0xf4dc1a(0x1cb),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2fa865=[];_0x2fa865[_0xf4dc1a(0x203)]=[];for(let _0xdbb2d7=0x0;_0xdbb2d7<=_0x2a4f7d[_0xf4dc1a(0x1cc)]-0x1;_0xdbb2d7++){const _0x272596=_0x2a4f7d[_0xdbb2d7];_0x2fa865[_0xf4dc1a(0x203)][_0xf4dc1a(0x1dd)](_0x272596);}const _0x343396=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x552843,'$lte':_0x10d6ae},'sales_staff_id':_0x59ac8,'sale_product.isFG':'false','status_data':_0xf4dc1a(0x1ed)}},{'$unwind':_0xf4dc1a(0x218)},{'$match':{'sale_product.isFG':_0xf4dc1a(0x1ed)}},{'$lookup':{'from':_0xf4dc1a(0x1bc),'localField':_0xf4dc1a(0x1be),'foreignField':_0xf4dc1a(0x20a),'as':_0xf4dc1a(0x1fc)}},{'$unwind':_0xf4dc1a(0x1b2)},{'$group':{'_id':{'category':_0xf4dc1a(0x1ea),'brand':_0xf4dc1a(0x222)},'totalQty':{'$sum':_0xf4dc1a(0x1f6)},'products':{'$push':{'qty':_0xf4dc1a(0x1f6),'NetPrice':_0xf4dc1a(0x1fb),'discount':_0xf4dc1a(0x208),'adj_discount':_0xf4dc1a(0x213),'product_details':{'prod_name':_0xf4dc1a(0x1d8),'product_code':_0xf4dc1a(0x21a),'category':_0xf4dc1a(0x1ea),'brand':'$product_info.brand','gross_price':_0xf4dc1a(0x1a7)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'category':_0xf4dc1a(0x1e2),'brand':_0xf4dc1a(0x214)},'totalQty':{'$sum':_0xf4dc1a(0x212)},'totalGross':{'$sum':{'$multiply':[_0xf4dc1a(0x212),_0xf4dc1a(0x21f)]}},'NetPrice':{'$sum':_0xf4dc1a(0x1c9)},'discount':{'$sum':_0xf4dc1a(0x223)},'adj_discount':{'$sum':_0xf4dc1a(0x216)},'product_details':{'$first':_0xf4dc1a(0x1c6)}}},{'$group':{'_id':{'category':'$_id.category','brand':_0xf4dc1a(0x217)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0xf4dc1a(0x21c)},'NetPrice':{'$sum':_0xf4dc1a(0x1f2)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0xf4dc1a(0x1cf)},'products':{'$push':{'qty':_0xf4dc1a(0x1dc),'category':_0xf4dc1a(0x1db),'brand':_0xf4dc1a(0x217),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x15d7c9=[];_0x15d7c9[_0xf4dc1a(0x1ae)]={};for(let _0x4feba2=0x0;_0x4feba2<=_0x343396[_0xf4dc1a(0x1cc)]-0x1;_0x4feba2++){const _0x293653=_0x343396[_0x4feba2];!_0x15d7c9[_0xf4dc1a(0x1ae)][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]]&&(_0x15d7c9[_0xf4dc1a(0x1ae)][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]]={}),!_0x15d7c9[_0xf4dc1a(0x1ae)][_0x293653['_id']['brand']][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]]&&(_0x15d7c9[_0xf4dc1a(0x1ae)][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x293653['_id']['category']]={}),!_0x15d7c9[_0xf4dc1a(0x1ae)][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x293653['_id'][_0xf4dc1a(0x1b9)]][_0xf4dc1a(0x207)]&&(_0x15d7c9[_0xf4dc1a(0x1ae)][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]]['qty']=0x0),!_0x15d7c9[_0xf4dc1a(0x1ae)][_0x293653['_id'][_0xf4dc1a(0x206)]][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]][_0xf4dc1a(0x21e)]&&(_0x15d7c9['sales_sa_month'][_0x293653[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x293653['_id']['category']][_0xf4dc1a(0x21e)]=0x0),_0x15d7c9['sales_sa_month'][_0x293653['_id'][_0xf4dc1a(0x206)]][_0x293653[_0xf4dc1a(0x204)]['category']][_0xf4dc1a(0x207)]=_0x293653[_0xf4dc1a(0x1d7)],_0x15d7c9['sales_sa_month'][_0x293653['_id']['brand']][_0x293653[_0xf4dc1a(0x204)]['category']]['net']=_0x293653[_0xf4dc1a(0x1ac)];}const _0x5d5fd6=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x46eaa3,'$lte':_0x10d6ae},'sales_staff_id':_0x59ac8,'sale_product.isFG':_0xf4dc1a(0x1ed),'status_data':_0xf4dc1a(0x1ed)}},{'$unwind':_0xf4dc1a(0x218)},{'$match':{'sale_product.isFG':_0xf4dc1a(0x1ed)}},{'$lookup':{'from':'products','localField':_0xf4dc1a(0x1be),'foreignField':'product_code','as':_0xf4dc1a(0x1fc)}},{'$unwind':_0xf4dc1a(0x1b2)},{'$group':{'_id':{'category':_0xf4dc1a(0x1ea),'brand':_0xf4dc1a(0x222)},'totalQty':{'$sum':_0xf4dc1a(0x1f6)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0xf4dc1a(0x1fb),'discount':_0xf4dc1a(0x208),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0xf4dc1a(0x1d8),'product_code':_0xf4dc1a(0x21a),'category':'$product_info.category','brand':_0xf4dc1a(0x222),'gross_price':_0xf4dc1a(0x1a7)}}}}},{'$unwind':_0xf4dc1a(0x1d6)},{'$group':{'_id':{'category':_0xf4dc1a(0x1e2),'brand':_0xf4dc1a(0x214)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0xf4dc1a(0x21f)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0xf4dc1a(0x223)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0xf4dc1a(0x1c6)}}},{'$group':{'_id':{'category':_0xf4dc1a(0x1db),'brand':'$_id.brand'},'totalQty':{'$sum':_0xf4dc1a(0x1dc)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0xf4dc1a(0x1f2)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0xf4dc1a(0x1dc),'category':_0xf4dc1a(0x1db),'brand':_0xf4dc1a(0x217),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x26e036=[];_0x26e036[_0xf4dc1a(0x1bf)]={};for(let _0x135cdd=0x0;_0x135cdd<=_0x5d5fd6[_0xf4dc1a(0x1cc)]-0x1;_0x135cdd++){const _0x36376e=_0x5d5fd6[_0x135cdd];!_0x26e036[_0xf4dc1a(0x1bf)][_0x36376e['_id'][_0xf4dc1a(0x206)]]&&(_0x26e036['sales_sa_year'][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]]={}),!_0x26e036[_0xf4dc1a(0x1bf)][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x36376e['_id'][_0xf4dc1a(0x1b9)]]&&(_0x26e036['sales_sa_year'][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]]={}),!_0x26e036[_0xf4dc1a(0x1bf)][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]][_0xf4dc1a(0x207)]&&(_0x26e036[_0xf4dc1a(0x1bf)][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]][_0xf4dc1a(0x207)]=0x0),!_0x26e036[_0xf4dc1a(0x1bf)][_0x36376e[_0xf4dc1a(0x204)]['brand']][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]]['net']&&(_0x26e036[_0xf4dc1a(0x1bf)][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]][_0xf4dc1a(0x21e)]=0x0),_0x26e036[_0xf4dc1a(0x1bf)][_0x36376e['_id'][_0xf4dc1a(0x206)]][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]]['qty']=_0x36376e['totalQty'],_0x26e036[_0xf4dc1a(0x1bf)][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x206)]][_0x36376e[_0xf4dc1a(0x204)][_0xf4dc1a(0x1b9)]][_0xf4dc1a(0x21e)]=_0x36376e[_0xf4dc1a(0x1ac)];}_0x464e8d[_0xf4dc1a(0x1fe)]({'product':_0x2fa865[_0xf4dc1a(0x203)],'month_data':_0x15d7c9[_0xf4dc1a(0x1ae)],'year_data':_0x26e036[_0xf4dc1a(0x1bf)]});}catch(_0x4526fd){console[_0xf4dc1a(0x20c)](_0x4526fd);}}),module['exports']=router;function a0_0x2117(){const _0x197b8f=['Spanish','$sale_product.real_qty_unit_val','/pending_data','user','$product_list.product_stock','findOne','$sale_product.totalprice','product_info','4703610ydOkPx','json','$sale_product.price','express','Router','9952XwXOcJ','cat_brand','_id','save','brand','qty','$sale_product.discount','English','product_code','Hindi','log','../models/all_models','/paid_data','../public/language/languages.json','/price_chart','German','$products.qty','$sale_product.adj_discount','$products.product_details.brand','/sales_chart','$products.adj_discount','$_id.brand','$sale_product','success','$product_info.product_code','$count','$totalGross','1166655RBJeGr','net','$products.product_details.gross_price','/my_inv','post','$product_info.brand','$products.discount','flash','$total_amount','index_acc','$product_info.gross_price','aggregate','../middleware/auth','5251388myrnMr','$date','NetPrice','$product.from_quantity','sales_sa_month','$return_sale','valueOf','index_sa','$product_info','$sumprice','$product.to_quantity','$product.quantity','$category','render','findById','category','/sales_data_dashboard','$product_list','products','paid','sale_product.product_code','sales_sa_year','email','294jdHuSK','true','find','English\x20(US)','fss','$products.product_details','72bPvdxW','$product','$products.NetPrice','/get_count','$name','length','body','$total_price','$adj_discount','warehouse_category','$product.product_name','/update_data','$sale_product.quantity','/avg_data','Finished\x20Goods','$products','totalQty','$product_info.name','2577339WefswZ','index_asd','$_id.category','$totalQty','push','account_category','Raw\x20Materials','language','$return_product.return_qty','$products.product_details.category','/paid_data_table','False','Chinese','acc','$brand','get','/index','$product_info.category','errors','$to_warehouse','false','1888695TFPBbN','True','863391ThxedR','French','$NetPrice','Portuguese\x20(BR)','$from_warehouse'];a0_0x2117=function(){return _0x197b8f;};return a0_0x2117();}