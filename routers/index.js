const a0_0x1b8439=a0_0x43f1;function a0_0x43f1(_0xe9c030,_0x4d97bb){const _0x61ca6f=a0_0x61ca();return a0_0x43f1=function(_0x43f1f0,_0x2de7b6){_0x43f1f0=_0x43f1f0-0xbf;let _0x6fd39c=_0x61ca6f[_0x43f1f0];return _0x6fd39c;},a0_0x43f1(_0xe9c030,_0x4d97bb);}(function(_0x352378,_0x537d10){const _0x5c9238=a0_0x43f1,_0x554577=_0x352378();while(!![]){try{const _0x43321c=-parseInt(_0x5c9238(0xc1))/0x1*(-parseInt(_0x5c9238(0xc8))/0x2)+parseInt(_0x5c9238(0xe4))/0x3+parseInt(_0x5c9238(0x118))/0x4*(parseInt(_0x5c9238(0xee))/0x5)+parseInt(_0x5c9238(0x107))/0x6*(parseInt(_0x5c9238(0xd3))/0x7)+parseInt(_0x5c9238(0x122))/0x8*(parseInt(_0x5c9238(0x13d))/0x9)+parseInt(_0x5c9238(0x104))/0xa*(-parseInt(_0x5c9238(0xf8))/0xb)+-parseInt(_0x5c9238(0x11a))/0xc;if(_0x43321c===_0x537d10)break;else _0x554577['push'](_0x554577['shift']());}catch(_0xf5cbbf){_0x554577['push'](_0x554577['shift']());}}}(a0_0x61ca,0x6b450));const express=require(a0_0x1b8439(0x115)),app=express(),router=express[a0_0x1b8439(0xc7)](),auth=require(a0_0x1b8439(0xc4)),{profile,sales,sales_return,purchases,purchases_return,categories,product,suppliers,customer,master_shop,transfers,adjustment,purchases_finished,sales_finished,adjustment_finished,transfers_finished,staff,sales_sa,sales_order}=require(a0_0x1b8439(0xf3)),users=require('../public/language/languages.json');function a0_0x61ca(){const _0x22b4d2=['language','$product_list','qty','$_id.category','index','save','8cNKkqj','$sumprice','$adj_discount','$product.from_quantity','post','French','cat_brand','Hindi','rsm','acc','$sale_product.totalprice','/sales_data__admin_dashboard','totalQty','$brand','Chinese','$NetPrice','True','Spanish','$product_info.product_code','warehouse_category','exports','$product_code','index_asd','product_info','render','products','net','3517605olGRQF','$return_product.return_qty','valueOf','index_acc','$sale_product','$products.product_details.category','account_category','brand','aggregate','findOne','$name','$from_warehouse','flash','1506dxQopg','false','$category','../middleware/auth','/paid_data_table','$products.product_details.brand','Router','256PiEFYQ','body','German','fss','English\x20(US)','user','collection_price','$product_list.product_stock','$products.product_details','Portuguese\x20(BR)','NetPrice','3352741bQwZxN','$product.quantity','English','Finished\x20Goods','/my_inv','$products.adj_discount','/sales_data_dashboard','paid','/pending_data_table','$return_product','$product_info.category','email','$sale_product.quantity','$totalQty','$product.to_quantity','errors','$date','1514724wajgjT','get','$total_amount','sad','product_code','$products.product_details.gross_price','$products','true','category','$sale_product.discount','55YxXefA','Arabic\x20(ae)','find','$product.product_name','$products.NetPrice','../models/all_models','_id','$products.qty','json','/pending_data','6279251vmGJNy','$product_info','$product_details','length','$count','log','$product_info.name','sales_sa_year','/price_chart','$product','False','$sale_product.real_qty_unit_val','10VqTZGL','push','success','6fdrBfH','$sale_product.adj_discount','$products.discount','/index','$totalGross','/sales_chart','$_id.brand','$return_sale','$product_info.gross_price','$return_sale.sale_qty','sales_sa_month','Raw\x20Materials','$total_price','sale_product.product_code','express','findById','$sale_product.price','235292GTLVVq','$product_info.brand','14451840inRIWI','$discount'];a0_0x61ca=function(){return _0x22b4d2;};return a0_0x61ca();}router[a0_0x1b8439(0xe5)](a0_0x1b8439(0x10a),auth,async(_0xc051ea,_0x204350)=>{const _0x1433e8=a0_0x1b8439;try{const {username:_0x5afcfa,email:_0x1e2597,role:_0x3912dd}=_0xc051ea[_0x1433e8(0xcd)],_0x43319d=_0xc051ea[_0x1433e8(0xcd)],_0x212a3e=await master_shop[_0x1433e8(0xf0)](),_0x42acec=await profile[_0x1433e8(0x146)]({'email':_0x43319d[_0x1433e8(0xde)]});if(_0x212a3e[0x0][_0x1433e8(0x11c)]==_0x1433e8(0xcc))var _0x17c70e=users[_0x1433e8(0xd5)];else{if(_0x212a3e[0x0][_0x1433e8(0x11c)]=='Hindi')var _0x17c70e=users[_0x1433e8(0x129)];else{if(_0x212a3e[0x0]['language']=='German')var _0x17c70e=users[_0x1433e8(0xca)];else{if(_0x212a3e[0x0]['language']==_0x1433e8(0x133))var _0x17c70e=users[_0x1433e8(0x133)];else{if(_0x212a3e[0x0][_0x1433e8(0x11c)]==_0x1433e8(0x127))var _0x17c70e=users[_0x1433e8(0x127)];else{if(_0x212a3e[0x0][_0x1433e8(0x11c)]==_0x1433e8(0xd1))var _0x17c70e=users['Portuguese'];else{if(_0x212a3e[0x0][_0x1433e8(0x11c)]==_0x1433e8(0x130))var _0x17c70e=users[_0x1433e8(0x130)];else{if(_0x212a3e[0x0][_0x1433e8(0x11c)]==_0x1433e8(0xef))var _0x17c70e=users['Arabic'];}}}}}}}if(_0x43319d['account_category']=='wm'){var _0x528d12;if(_0x43319d['warehouse_category']=='Raw\x20Materials'){const _0x4ee9ca=await product[_0x1433e8(0xf0)]({'product_category':_0x1433e8(0x112)});_0x528d12=_0x4ee9ca[_0x1433e8(0xfb)];}else{if(_0x43319d[_0x1433e8(0x135)]=='Finished\x20Goods'){const _0xe1c69b=await product[_0x1433e8(0xf0)]({'product_category':_0x1433e8(0xd6)});_0x528d12=_0xe1c69b['length'];}else{const _0x57fe75=await product['find']();_0x528d12=_0x57fe75['length'];}}const _0x388a22=await sales['aggregate']([{'$group':{'_id':null,'total_price':{'$sum':_0x1433e8(0x113)}}}]),_0x253634=await sales[_0x1433e8(0x145)]([{'$unwind':_0x1433e8(0x141)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$sale_product.quantity'}}}]),_0x16fad6=await sales_return['aggregate']([{'$group':{'_id':null,'total':{'$sum':_0x1433e8(0xe6)}}}]),_0x72e5c6=await sales_return[_0x1433e8(0x145)]([{'$unwind':'$return_sale'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1433e8(0x110)}}}]),_0x11cf22=await purchases[_0x1433e8(0x145)]([{'$group':{'_id':null,'total_amount':{'$sum':'$total_amount'}}}]),_0xadecc6=await purchases_return[_0x1433e8(0x145)]([{'$group':{'_id':null,'total':{'$sum':_0x1433e8(0xe6)}}}]),_0x5b2fc9=await purchases_return[_0x1433e8(0x145)]([{'$unwind':_0x1433e8(0xdc)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$return_product.return_qty'}}}]),_0x7c686f=await purchases[_0x1433e8(0x145)]([{'$unwind':_0x1433e8(0x101)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1433e8(0xd4)}}}]),_0x5e8eeb=await purchases['aggregate']([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x44796c=await sales[_0x1433e8(0x145)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0xe0fe34=await transfers['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x1433e8(0xf1),'fromWarehouse':{'$first':'$from_warehouse'},'toWareHouse':{'$first':'$to_warehouse'},'FromtotalQuantity':{'$sum':_0x1433e8(0x125)},'TototalQuantity':{'$sum':'$product.to_quantity'}}}]),_0x37dd24=await categories[_0x1433e8(0xf0)](),_0x2d8706=await product[_0x1433e8(0xf0)](),_0x4fcdbe=await suppliers[_0x1433e8(0xf0)](),_0x23ee9b=await customer[_0x1433e8(0xf0)]();_0x204350[_0x1433e8(0x13a)](_0x1433e8(0x120),{'success':_0xc051ea[_0x1433e8(0xc0)]('success'),'errors':_0xc051ea[_0x1433e8(0xc0)]('errors'),'role':_0x43319d,'profile':_0x42acec,'sale':_0x388a22[0x0],'sales_return':_0x16fad6[0x0],'purchases':_0x11cf22[0x0],'purchases_return':_0xadecc6[0x0],'purchases_table':_0x5e8eeb,'sales_table':_0x44796c,'categories':_0x37dd24[_0x1433e8(0xfb)],'product':_0x2d8706[_0x1433e8(0xfb)],'suppliers':_0x4fcdbe[_0x1433e8(0xfb)],'customer':_0x23ee9b[_0x1433e8(0xfb)],'master_shop':_0x212a3e,'language':_0x17c70e,'sale_QTY':_0x253634[0x0],'purchases_QTY':_0x7c686f[0x0],'sales_return_QTY':_0x72e5c6[0x0],'purchases_return_QTY':_0x5b2fc9[0x0],'transfer_table':_0xe0fe34,'product_cnt':_0x528d12});}else{if(_0x43319d[_0x1433e8(0x143)]=='sa'){const _0x39cdae=await staff[_0x1433e8(0x146)]({'email':_0x43319d[_0x1433e8(0xde)]}),_0x2760b0=await sales_sa[_0x1433e8(0xf0)]({'sales_staff_id':_0x39cdae[_0x1433e8(0xf4)]}),_0x1f6455=await sales_sa[_0x1433e8(0xf0)]({'sales_staff_id':_0x39cdae['_id'],'paid':'True'}),_0x46ae8b=await sales_sa[_0x1433e8(0xf0)]({'sales_staff_id':_0x39cdae[_0x1433e8(0xf4)],'paid':_0x1433e8(0x102)}),_0x31be8d=await sales_sa[_0x1433e8(0x145)]([{'$match':{'sales_staff_id':_0x39cdae['_id']['valueOf']()}},{'$unwind':'$sale_product'},{'$group':{'_id':null,'sumprice':{'$sum':_0x1433e8(0x117)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':[_0x1433e8(0x123),'$count']},0x2]}}}]),_0xff1ebd=await staff['aggregate']([{'$match':{'email':_0x43319d[_0x1433e8(0xde)]}},{'$unwind':'$product_list'},{'$group':{'_id':null,'totalQTY':{'$sum':_0x1433e8(0xcf)}}}]);_0x204350[_0x1433e8(0x13a)]('index_sa',{'success':_0xc051ea[_0x1433e8(0xc0)](_0x1433e8(0x106)),'errors':_0xc051ea[_0x1433e8(0xc0)](_0x1433e8(0xe2)),'role':_0x43319d,'profile':_0x42acec,'master_shop':_0x212a3e,'language':_0x17c70e,'cntPaid':_0x1f6455,'cntNotPaid':_0x46ae8b,'avg_price':_0x31be8d[0x0],'my_stock':_0xff1ebd[0x0],'staff_arr':_0x39cdae});}else{if(_0x43319d[_0x1433e8(0x143)]==_0x1433e8(0x12b)){const _0x55a0d5=await staff[_0x1433e8(0x146)]({'email':_0x43319d[_0x1433e8(0xde)]});_0x204350[_0x1433e8(0x13a)](_0x1433e8(0x140),{'success':_0xc051ea[_0x1433e8(0xc0)]('success'),'errors':_0xc051ea[_0x1433e8(0xc0)](_0x1433e8(0xe2)),'role':_0x43319d,'profile':_0x42acec,'master_shop':_0x212a3e,'language':_0x17c70e}),_0x204350['json'](_0x55a0d5);}else{if(_0x43319d[_0x1433e8(0x143)]==_0x1433e8(0xe7)||_0x43319d['account_category']==_0x1433e8(0x12a)||_0x43319d['account_category']==_0x1433e8(0xcb)){const _0xa01738=await staff['findOne']({'email':_0x43319d[_0x1433e8(0xde)]});_0x204350[_0x1433e8(0x13a)](_0x1433e8(0x138),{'success':_0xc051ea[_0x1433e8(0xc0)](_0x1433e8(0x106)),'errors':_0xc051ea[_0x1433e8(0xc0)](_0x1433e8(0xe2)),'role':_0x43319d,'profile':_0x42acec,'master_shop':_0x212a3e,'language':_0x17c70e});}else{var _0x528d12;if(_0x43319d['warehouse_category']==_0x1433e8(0x112)){const _0x2011b4=await product['find']({'product_category':_0x1433e8(0x112)});_0x528d12=_0x2011b4[_0x1433e8(0xfb)];}else{if(_0x43319d[_0x1433e8(0x135)]=='Finished\x20Goods'){const _0x3e1327=await product[_0x1433e8(0xf0)]({'product_category':'Finished\x20Goods'});_0x528d12=_0x3e1327[_0x1433e8(0xfb)];}else{const _0x220892=await product[_0x1433e8(0xf0)]();_0x528d12=_0x220892['length'];}}const _0x67e0b2=await sales[_0x1433e8(0x145)]([{'$group':{'_id':null,'total_price':{'$sum':_0x1433e8(0x113)}}}]),_0x920732=await sales[_0x1433e8(0x145)]([{'$unwind':'$sale_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1433e8(0xdf)}}}]),_0x16b7a2=await sales_return[_0x1433e8(0x145)]([{'$group':{'_id':null,'total':{'$sum':'$total_amount'}}}]),_0x470852=await sales_return[_0x1433e8(0x145)]([{'$unwind':_0x1433e8(0x10e)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1433e8(0x110)}}}]),_0x3092ec=await purchases['aggregate']([{'$group':{'_id':null,'total_amount':{'$sum':_0x1433e8(0xe6)}}}]),_0x43c7c4=await purchases_return[_0x1433e8(0x145)]([{'$group':{'_id':null,'total':{'$sum':'$total_amount'}}}]),_0x486cad=await purchases_return[_0x1433e8(0x145)]([{'$unwind':'$return_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x1433e8(0x13e)}}}]),_0x714238=await purchases['aggregate']([{'$unwind':_0x1433e8(0x101)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$product.quantity'}}}]),_0x5df606=await purchases[_0x1433e8(0x145)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0xf4692e=await sales['aggregate']([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x28dd0f=await transfers['aggregate']([{'$unwind':_0x1433e8(0x101)},{'$group':{'_id':_0x1433e8(0xf1),'fromWarehouse':{'$first':_0x1433e8(0xbf)},'toWareHouse':{'$first':'$to_warehouse'},'FromtotalQuantity':{'$sum':'$product.from_quantity'},'TototalQuantity':{'$sum':_0x1433e8(0xe1)}}}]),_0x10a150=await categories['find'](),_0x319b6e=await product[_0x1433e8(0xf0)](),_0x3a88b0=await suppliers[_0x1433e8(0xf0)](),_0x3d36c1=await customer['find']();_0x204350['render']('index',{'success':_0xc051ea[_0x1433e8(0xc0)](_0x1433e8(0x106)),'errors':_0xc051ea[_0x1433e8(0xc0)]('errors'),'role':_0x43319d,'profile':_0x42acec,'sale':_0x67e0b2[0x0],'sales_return':_0x16b7a2[0x0],'purchases':_0x3092ec[0x0],'purchases_return':_0x43c7c4[0x0],'purchases_table':_0x5df606,'sales_table':_0xf4692e,'categories':_0x10a150[_0x1433e8(0xfb)],'product':_0x319b6e['length'],'suppliers':_0x3a88b0['length'],'customer':_0x3d36c1['length'],'master_shop':_0x212a3e,'language':_0x17c70e,'sale_QTY':_0x920732[0x0],'purchases_QTY':_0x714238[0x0],'sales_return_QTY':_0x470852[0x0],'purchases_return_QTY':_0x486cad[0x0],'transfer_table':_0x28dd0f,'product_cnt':_0x528d12});}}}}}catch(_0x5990f1){console['log'](_0x5990f1);}}),router['get'](a0_0x1b8439(0xdb),auth,async(_0x12eb52,_0x5a3966)=>{const _0x52ae4a=a0_0x1b8439;try{const _0x49f001=_0x12eb52[_0x52ae4a(0xcd)],_0x1cbd8b=await staff[_0x52ae4a(0x146)]({'email':_0x49f001['email']}),_0x110a00=await sales_sa[_0x52ae4a(0x145)]([{'$match':{'sales_staff_id':_0x1cbd8b[_0x52ae4a(0xf4)][_0x52ae4a(0x13f)](),'paid':_0x52ae4a(0x102)}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x5a3966[_0x52ae4a(0xf6)](_0x110a00);}catch(_0x243fb6){_0x5a3966[_0x52ae4a(0xf6)](_0x243fb6);}}),router[a0_0x1b8439(0xe5)]('/pending_data',auth,async(_0x2cca29,_0x9b9ea8)=>{const _0x7ac9b9=a0_0x1b8439;try{const _0x416217=_0x2cca29[_0x7ac9b9(0xcd)],_0x23d8d4=await staff[_0x7ac9b9(0x146)]({'email':_0x416217[_0x7ac9b9(0xde)]}),_0x2e30fa=await sales_sa['find']({'sales_staff_id':_0x23d8d4['_id'],'paid':_0x7ac9b9(0x102)});_0x9b9ea8['json'](_0x2e30fa);}catch(_0x2ef754){_0x9b9ea8['json'](_0x2ef754);}}),router[a0_0x1b8439(0x126)]('/get_count',auth,async(_0x3a8599,_0x569b59)=>{const _0x24b871=a0_0x1b8439;try{const {sttaff_id:_0x39e3bf,warehouse:_0x14985a,account_category:_0x60c421}=_0x3a8599[_0x24b871(0xcd)],_0x282501=await sales_order['aggregate']([{'$match':{'accounting_account_id':_0x39e3bf,'accounting_account_confirm':_0x24b871(0xc2)}}]);_0x569b59[_0x24b871(0xf6)](_0x282501);}catch(_0x534920){}}),router['get'](a0_0x1b8439(0xc5),auth,async(_0x589079,_0x5edd5e)=>{const _0x231549=a0_0x1b8439;try{const _0x5c8798=_0x589079['user'],_0x563151=await staff[_0x231549(0x146)]({'email':_0x5c8798[_0x231549(0xde)]}),_0x2bf3b9=await sales_sa[_0x231549(0xf0)]({'sales_staff_id':_0x563151['_id'],'paid':_0x231549(0x132)});_0x5edd5e['json'](_0x2bf3b9);}catch(_0x3989e5){_0x5edd5e[_0x231549(0xf6)](_0x3989e5);}}),router[a0_0x1b8439(0xe5)]('/paid_data',auth,async(_0x3b636d,_0x3452c9)=>{const _0x581987=a0_0x1b8439;try{const _0x41b4fe=_0x3b636d[_0x581987(0xcd)],_0x313d0f=await staff[_0x581987(0x146)]({'email':_0x41b4fe['email']}),_0x1981e4=await sales_sa[_0x581987(0x145)]([{'$match':{'sales_staff_id':_0x313d0f['_id'][_0x581987(0x13f)](),'paid':_0x581987(0x132)}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x3452c9[_0x581987(0xf6)](_0x1981e4);}catch(_0x2f2e93){_0x3452c9[_0x581987(0xf6)](_0x2f2e93);}}),router['post']('/update_data',auth,async(_0x2d446c,_0x48d9c9)=>{const _0x5edb92=a0_0x1b8439;try{const {id:_0x4115e3,price:_0x2cb636}=_0x2d446c[_0x5edb92(0xc9)],_0x1c1b68=await sales_sa[_0x5edb92(0x116)](_0x4115e3);_0x1c1b68[_0x5edb92(0xda)]='True',_0x1c1b68[_0x5edb92(0xce)]=parseFloat(_0x2cb636);const _0x115486=await _0x1c1b68[_0x5edb92(0x121)]();_0x48d9c9[_0x5edb92(0xf6)](_0x115486);}catch(_0x1c611f){_0x48d9c9['json'](_0x1c611f);}}),router['get'](a0_0x1b8439(0xf7),auth,async(_0x36a1a5,_0x14ca4d)=>{const _0x36421c=a0_0x1b8439;try{const _0x42561d=_0x36a1a5[_0x36421c(0xcd)],_0x300cd4=await staff[_0x36421c(0x146)]({'email':_0x42561d['email']}),_0x2d6a0c=await sales_sa[_0x36421c(0xf0)]({'sales_staff_id':_0x300cd4['_id'],'paid':_0x36421c(0x102)});_0x14ca4d['json'](_0x2d6a0c);}catch(_0x2a3e1e){_0x14ca4d[_0x36421c(0xf6)](_0x2a3e1e);}}),router[a0_0x1b8439(0xe5)]('/avg_data',auth,async(_0x5a74b3,_0x3faa56)=>{const _0x3cff3a=a0_0x1b8439;try{const _0x6c183c=_0x5a74b3[_0x3cff3a(0xcd)],_0x4b8e2b=await staff[_0x3cff3a(0x146)]({'email':_0x6c183c[_0x3cff3a(0xde)]}),_0x485975=await sales_sa[_0x3cff3a(0x145)]([{'$match':{'sales_staff_id':_0x4b8e2b[_0x3cff3a(0xf4)]['valueOf']()}},{'$unwind':_0x3cff3a(0x141)},{'$group':{'_id':null,'sumprice':{'$sum':_0x3cff3a(0x117)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':[_0x3cff3a(0x123),_0x3cff3a(0xfc)]},0x2]}}}]);_0x3faa56[_0x3cff3a(0xf6)](_0x485975);}catch(_0x17a9ee){_0x3faa56['json'](_0x17a9ee);}}),router['get'](a0_0x1b8439(0xd7),auth,async(_0x90187a,_0x44f277)=>{const _0x4dc1b9=a0_0x1b8439;try{const _0x506718=_0x90187a['user'],_0x3cbd23=await staff['findOne']({'email':_0x506718['email']}),_0x2e4dd8=await staff[_0x4dc1b9(0x145)]([{'$match':{'email':_0x506718[_0x4dc1b9(0xde)]}},{'$unwind':_0x4dc1b9(0x11d)},{'$match':{'product_list.isConfirm':_0x4dc1b9(0xeb)}},{'$group':{'_id':null,'totalQTY':{'$sum':'$product_list.product_stock'}}}]);_0x44f277[_0x4dc1b9(0xf6)](_0x2e4dd8);}catch(_0x4ee532){_0x44f277['json'](_0x4ee532);}}),router[a0_0x1b8439(0xe5)](a0_0x1b8439(0x10c),auth,async(_0x84d432,_0x57c742)=>{const _0x17ae24=a0_0x1b8439;try{const _0x1acae4=_0x84d432[_0x17ae24(0xcd)],_0x1e2b4f=await staff[_0x17ae24(0x146)]({'email':_0x1acae4['email']}),_0x136fec=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x1e2b4f[_0x17ae24(0xf4)][_0x17ae24(0x13f)]()}},{'$unwind':_0x17ae24(0x141)},{'$group':{'_id':_0x17ae24(0xe3),'totalQuantity':{'$sum':_0x17ae24(0xdf)},'date':{'$first':_0x17ae24(0xe3)}}},{'$sort':{'date':0x1}}]);_0x57c742[_0x17ae24(0xf6)](_0x136fec);}catch(_0x52d641){_0x57c742[_0x17ae24(0xf6)](_0x52d641);}}),router[a0_0x1b8439(0xe5)](a0_0x1b8439(0x100),auth,async(_0x1fc41c,_0x3f1736)=>{const _0x73f7d9=a0_0x1b8439;try{const _0x2ccaaa=_0x1fc41c[_0x73f7d9(0xcd)],_0x1a3e1f=await staff['findOne']({'email':_0x2ccaaa[_0x73f7d9(0xde)]}),_0x102a8c=await sales_sa[_0x73f7d9(0x145)]([{'$match':{'sales_staff_id':_0x1a3e1f[_0x73f7d9(0xf4)]['valueOf']()}},{'$unwind':'$sale_product'},{'$group':{'_id':'$date','totalPrice':{'$sum':_0x73f7d9(0x12c)},'date':{'$first':_0x73f7d9(0xe3)}}},{'$sort':{'date':0x1}}]);_0x3f1736['json'](_0x102a8c);}catch(_0x5d5959){_0x3f1736[_0x73f7d9(0xf6)](_0x5d5959);}}),router[a0_0x1b8439(0x126)](a0_0x1b8439(0xd9),auth,async(_0x289679,_0xd67771)=>{const _0x5bd6b5=a0_0x1b8439;try{const {date_today:_0x3f3953,first_month:_0x3f9048,first_year:_0x53a08a}=_0x289679[_0x5bd6b5(0xc9)],{sttaff_id:_0x1d1de0}=_0x289679[_0x5bd6b5(0xcd)],_0x2bd726=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':_0x5bd6b5(0xc3)},'products':{'$push':{'name':'$name','product_code':_0x5bd6b5(0x137)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1e6a92=[];_0x1e6a92['cat_brand']=[];for(let _0x26c3e0=0x0;_0x26c3e0<=_0x2bd726[_0x5bd6b5(0xfb)]-0x1;_0x26c3e0++){const _0x4c3707=_0x2bd726[_0x26c3e0];_0x1e6a92['cat_brand'][_0x5bd6b5(0x105)](_0x4c3707);}const _0x1e331e=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3f9048,'$lte':_0x3f3953},'sales_staff_id':_0x1d1de0,'sale_product.isFG':_0x5bd6b5(0xc2),'status_data':'false'}},{'$unwind':_0x5bd6b5(0x141)},{'$match':{'sale_product.isFG':_0x5bd6b5(0xc2)}},{'$lookup':{'from':_0x5bd6b5(0x13b),'localField':_0x5bd6b5(0x114),'foreignField':'product_code','as':_0x5bd6b5(0x139)}},{'$unwind':_0x5bd6b5(0xf9)},{'$group':{'_id':{'category':_0x5bd6b5(0xdd),'brand':_0x5bd6b5(0x119)},'totalQty':{'$sum':_0x5bd6b5(0x103)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x5bd6b5(0xed),'adj_discount':_0x5bd6b5(0x108),'product_details':{'prod_name':_0x5bd6b5(0xfe),'product_code':_0x5bd6b5(0x134),'category':_0x5bd6b5(0xdd),'brand':_0x5bd6b5(0x119),'gross_price':_0x5bd6b5(0x10f)}}}}},{'$unwind':_0x5bd6b5(0xea)},{'$group':{'_id':{'category':_0x5bd6b5(0x142),'brand':_0x5bd6b5(0xc6)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x5bd6b5(0xf5),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x5bd6b5(0xd8)},'product_details':{'$first':_0x5bd6b5(0xd0)}}},{'$group':{'_id':{'category':_0x5bd6b5(0x11f),'brand':'$_id.brand'},'totalQty':{'$sum':_0x5bd6b5(0xe0)},'totalGross':{'$sum':_0x5bd6b5(0x10b)},'NetPrice':{'$sum':_0x5bd6b5(0x131)},'discount':{'$sum':_0x5bd6b5(0x11b)},'adj_discount':{'$sum':_0x5bd6b5(0x124)},'products':{'$push':{'qty':_0x5bd6b5(0xe0),'category':_0x5bd6b5(0x11f),'brand':'$_id.brand','product_details':_0x5bd6b5(0xfa)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x2af235=[];_0x2af235['sales_sa_month']={};for(let _0x25c398=0x0;_0x25c398<=_0x1e331e[_0x5bd6b5(0xfb)]-0x1;_0x25c398++){const _0x3568ac=_0x1e331e[_0x25c398];!_0x2af235[_0x5bd6b5(0x111)][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]]&&(_0x2af235[_0x5bd6b5(0x111)][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]]={}),!_0x2af235[_0x5bd6b5(0x111)][_0x3568ac['_id'][_0x5bd6b5(0x144)]][_0x3568ac['_id'][_0x5bd6b5(0xec)]]&&(_0x2af235[_0x5bd6b5(0x111)][_0x3568ac['_id']['brand']][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]]={}),!_0x2af235[_0x5bd6b5(0x111)][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]][_0x5bd6b5(0x11e)]&&(_0x2af235[_0x5bd6b5(0x111)][_0x3568ac['_id'][_0x5bd6b5(0x144)]][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]][_0x5bd6b5(0x11e)]=0x0),!_0x2af235[_0x5bd6b5(0x111)][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]][_0x5bd6b5(0x13c)]&&(_0x2af235[_0x5bd6b5(0x111)][_0x3568ac[_0x5bd6b5(0xf4)]['brand']][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]][_0x5bd6b5(0x13c)]=0x0),_0x2af235['sales_sa_month'][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]][_0x5bd6b5(0x11e)]=_0x3568ac[_0x5bd6b5(0x12e)],_0x2af235[_0x5bd6b5(0x111)][_0x3568ac['_id'][_0x5bd6b5(0x144)]][_0x3568ac[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]]['net']=_0x3568ac[_0x5bd6b5(0xd2)];}const _0xac9103=await sales_sa[_0x5bd6b5(0x145)]([{'$match':{'date':{'$gte':_0x53a08a,'$lte':_0x3f3953},'sales_staff_id':_0x1d1de0,'sale_product.isFG':'false','status_data':'false'}},{'$unwind':_0x5bd6b5(0x141)},{'$match':{'sale_product.isFG':_0x5bd6b5(0xc2)}},{'$lookup':{'from':'products','localField':_0x5bd6b5(0x114),'foreignField':_0x5bd6b5(0xe8),'as':_0x5bd6b5(0x139)}},{'$unwind':'$product_info'},{'$group':{'_id':{'category':'$product_info.category','brand':'$product_info.brand'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x5bd6b5(0x103),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0x5bd6b5(0x108),'product_details':{'prod_name':_0x5bd6b5(0xfe),'product_code':_0x5bd6b5(0x134),'category':_0x5bd6b5(0xdd),'brand':'$product_info.brand','gross_price':_0x5bd6b5(0x10f)}}}}},{'$unwind':_0x5bd6b5(0xea)},{'$group':{'_id':{'category':_0x5bd6b5(0x142),'brand':_0x5bd6b5(0xc6)},'totalQty':{'$sum':_0x5bd6b5(0xf5)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x5bd6b5(0xe9)]}},'NetPrice':{'$sum':_0x5bd6b5(0xf2)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x5bd6b5(0xd8)},'product_details':{'$first':_0x5bd6b5(0xd0)}}},{'$group':{'_id':{'category':'$_id.category','brand':'$_id.brand'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x5bd6b5(0x10b)},'NetPrice':{'$sum':_0x5bd6b5(0x131)},'discount':{'$sum':_0x5bd6b5(0x11b)},'adj_discount':{'$sum':_0x5bd6b5(0x124)},'products':{'$push':{'qty':_0x5bd6b5(0xe0),'category':_0x5bd6b5(0x11f),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x24e35e=[];_0x24e35e['sales_sa_year']={};for(let _0x159023=0x0;_0x159023<=_0xac9103[_0x5bd6b5(0xfb)]-0x1;_0x159023++){const _0x4417f5=_0xac9103[_0x159023];!_0x24e35e[_0x5bd6b5(0xff)][_0x4417f5['_id'][_0x5bd6b5(0x144)]]&&(_0x24e35e['sales_sa_year'][_0x4417f5[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]]={}),!_0x24e35e[_0x5bd6b5(0xff)][_0x4417f5['_id'][_0x5bd6b5(0x144)]][_0x4417f5['_id'][_0x5bd6b5(0xec)]]&&(_0x24e35e[_0x5bd6b5(0xff)][_0x4417f5[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]][_0x4417f5[_0x5bd6b5(0xf4)]['category']]={}),!_0x24e35e[_0x5bd6b5(0xff)][_0x4417f5['_id'][_0x5bd6b5(0x144)]][_0x4417f5[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]]['qty']&&(_0x24e35e['sales_sa_year'][_0x4417f5[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]][_0x4417f5[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]][_0x5bd6b5(0x11e)]=0x0),!_0x24e35e[_0x5bd6b5(0xff)][_0x4417f5[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]][_0x4417f5[_0x5bd6b5(0xf4)]['category']][_0x5bd6b5(0x13c)]&&(_0x24e35e[_0x5bd6b5(0xff)][_0x4417f5['_id'][_0x5bd6b5(0x144)]][_0x4417f5['_id'][_0x5bd6b5(0xec)]]['net']=0x0),_0x24e35e[_0x5bd6b5(0xff)][_0x4417f5[_0x5bd6b5(0xf4)][_0x5bd6b5(0x144)]][_0x4417f5['_id'][_0x5bd6b5(0xec)]]['qty']=_0x4417f5[_0x5bd6b5(0x12e)],_0x24e35e[_0x5bd6b5(0xff)][_0x4417f5[_0x5bd6b5(0xf4)]['brand']][_0x4417f5[_0x5bd6b5(0xf4)][_0x5bd6b5(0xec)]][_0x5bd6b5(0x13c)]=_0x4417f5[_0x5bd6b5(0xd2)];}_0xd67771[_0x5bd6b5(0xf6)]({'product':_0x1e6a92[_0x5bd6b5(0x128)],'month_data':_0x2af235[_0x5bd6b5(0x111)],'year_data':_0x24e35e[_0x5bd6b5(0xff)]});}catch(_0x45f5fe){console[_0x5bd6b5(0xfd)](_0x45f5fe);}}),router[a0_0x1b8439(0x126)](a0_0x1b8439(0x12d),auth,async(_0xc7391,_0x10c1d1)=>{const _0x15e689=a0_0x1b8439;try{const {date_today:_0x2f0811,first_month:_0x21a6e0,first_year:_0x5b646c}=_0xc7391[_0x15e689(0xc9)],{sttaff_id:_0x29c89f}=_0xc7391[_0x15e689(0xcd)],_0x3d6cea=await product['aggregate']([{'$group':{'_id':{'brand':_0x15e689(0x12f),'category':'$category'},'products':{'$push':{'name':_0x15e689(0x147),'product_code':_0x15e689(0x137)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x4f7866=[];_0x4f7866[_0x15e689(0x128)]=[];for(let _0x2c1892=0x0;_0x2c1892<=_0x3d6cea[_0x15e689(0xfb)]-0x1;_0x2c1892++){const _0x5c9ffc=_0x3d6cea[_0x2c1892];_0x4f7866['cat_brand']['push'](_0x5c9ffc);}const _0x8b10d4=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x21a6e0,'$lte':_0x2f0811},'sale_product.isFG':_0x15e689(0xc2),'status_data':_0x15e689(0xc2)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x15e689(0xc2)}},{'$lookup':{'from':_0x15e689(0x13b),'localField':_0x15e689(0x114),'foreignField':_0x15e689(0xe8),'as':_0x15e689(0x139)}},{'$unwind':'$product_info'},{'$group':{'_id':{'category':_0x15e689(0xdd),'brand':_0x15e689(0x119)},'totalQty':{'$sum':_0x15e689(0x103)},'products':{'$push':{'qty':_0x15e689(0x103),'NetPrice':_0x15e689(0x12c),'discount':_0x15e689(0xed),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':_0x15e689(0x134),'category':'$product_info.category','brand':'$product_info.brand','gross_price':_0x15e689(0x10f)}}}}},{'$unwind':_0x15e689(0xea)},{'$group':{'_id':{'category':_0x15e689(0x142),'brand':_0x15e689(0xc6)},'totalQty':{'$sum':_0x15e689(0xf5)},'totalGross':{'$sum':{'$multiply':[_0x15e689(0xf5),_0x15e689(0xe9)]}},'NetPrice':{'$sum':_0x15e689(0xf2)},'discount':{'$sum':_0x15e689(0x109)},'adj_discount':{'$sum':_0x15e689(0xd8)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'category':'$_id.category','brand':_0x15e689(0x10d)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x15e689(0x11b)},'adj_discount':{'$sum':_0x15e689(0x124)},'products':{'$push':{'qty':_0x15e689(0xe0),'category':'$_id.category','brand':_0x15e689(0x10d),'product_details':_0x15e689(0xfa)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x15ab3f=[];_0x15ab3f[_0x15e689(0x111)]={};for(let _0x47bcc6=0x0;_0x47bcc6<=_0x8b10d4[_0x15e689(0xfb)]-0x1;_0x47bcc6++){const _0x5a8795=_0x8b10d4[_0x47bcc6];!_0x15ab3f[_0x15e689(0x111)][_0x5a8795[_0x15e689(0xf4)][_0x15e689(0x144)]]&&(_0x15ab3f[_0x15e689(0x111)][_0x5a8795[_0x15e689(0xf4)][_0x15e689(0x144)]]={}),!_0x15ab3f['sales_sa_month'][_0x5a8795['_id']['brand']][_0x5a8795['_id'][_0x15e689(0xec)]]&&(_0x15ab3f[_0x15e689(0x111)][_0x5a8795[_0x15e689(0xf4)][_0x15e689(0x144)]][_0x5a8795[_0x15e689(0xf4)][_0x15e689(0xec)]]={}),!_0x15ab3f[_0x15e689(0x111)][_0x5a8795[_0x15e689(0xf4)]['brand']][_0x5a8795[_0x15e689(0xf4)][_0x15e689(0xec)]]['qty']&&(_0x15ab3f['sales_sa_month'][_0x5a8795[_0x15e689(0xf4)]['brand']][_0x5a8795[_0x15e689(0xf4)][_0x15e689(0xec)]][_0x15e689(0x11e)]=0x0),!_0x15ab3f[_0x15e689(0x111)][_0x5a8795['_id'][_0x15e689(0x144)]][_0x5a8795['_id'][_0x15e689(0xec)]][_0x15e689(0x13c)]&&(_0x15ab3f['sales_sa_month'][_0x5a8795['_id'][_0x15e689(0x144)]][_0x5a8795['_id']['category']][_0x15e689(0x13c)]=0x0),_0x15ab3f[_0x15e689(0x111)][_0x5a8795[_0x15e689(0xf4)]['brand']][_0x5a8795[_0x15e689(0xf4)]['category']][_0x15e689(0x11e)]=_0x5a8795[_0x15e689(0x12e)],_0x15ab3f['sales_sa_month'][_0x5a8795[_0x15e689(0xf4)]['brand']][_0x5a8795['_id']['category']][_0x15e689(0x13c)]=_0x5a8795['NetPrice'];}const _0x2b2d88=await sales_sa[_0x15e689(0x145)]([{'$match':{'date':{'$gte':_0x5b646c,'$lte':_0x2f0811},'sale_product.isFG':_0x15e689(0xc2),'status_data':'false'}},{'$unwind':_0x15e689(0x141)},{'$match':{'sale_product.isFG':_0x15e689(0xc2)}},{'$lookup':{'from':_0x15e689(0x13b),'localField':_0x15e689(0x114),'foreignField':_0x15e689(0xe8),'as':_0x15e689(0x139)}},{'$unwind':_0x15e689(0xf9)},{'$group':{'_id':{'category':_0x15e689(0xdd),'brand':_0x15e689(0x119)},'totalQty':{'$sum':_0x15e689(0x103)},'products':{'$push':{'qty':_0x15e689(0x103),'NetPrice':_0x15e689(0x12c),'discount':_0x15e689(0xed),'adj_discount':_0x15e689(0x108),'product_details':{'prod_name':_0x15e689(0xfe),'product_code':_0x15e689(0x134),'category':_0x15e689(0xdd),'brand':_0x15e689(0x119),'gross_price':_0x15e689(0x10f)}}}}},{'$unwind':_0x15e689(0xea)},{'$group':{'_id':{'category':_0x15e689(0x142),'brand':_0x15e689(0xc6)},'totalQty':{'$sum':_0x15e689(0xf5)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x15e689(0xe9)]}},'NetPrice':{'$sum':_0x15e689(0xf2)},'discount':{'$sum':_0x15e689(0x109)},'adj_discount':{'$sum':_0x15e689(0xd8)},'product_details':{'$first':_0x15e689(0xd0)}}},{'$group':{'_id':{'category':'$_id.category','brand':_0x15e689(0x10d)},'totalQty':{'$sum':_0x15e689(0xe0)},'totalGross':{'$sum':_0x15e689(0x10b)},'NetPrice':{'$sum':_0x15e689(0x131)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x15e689(0x124)},'products':{'$push':{'qty':_0x15e689(0xe0),'category':_0x15e689(0x11f),'brand':_0x15e689(0x10d),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x37772e=[];_0x37772e[_0x15e689(0xff)]={};for(let _0x564854=0x0;_0x564854<=_0x2b2d88[_0x15e689(0xfb)]-0x1;_0x564854++){const _0x3aa34e=_0x2b2d88[_0x564854];!_0x37772e[_0x15e689(0xff)][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0x144)]]&&(_0x37772e[_0x15e689(0xff)][_0x3aa34e['_id'][_0x15e689(0x144)]]={}),!_0x37772e[_0x15e689(0xff)][_0x3aa34e['_id'][_0x15e689(0x144)]][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0xec)]]&&(_0x37772e[_0x15e689(0xff)][_0x3aa34e[_0x15e689(0xf4)]['brand']][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0xec)]]={}),!_0x37772e[_0x15e689(0xff)][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0x144)]][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0xec)]][_0x15e689(0x11e)]&&(_0x37772e['sales_sa_year'][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0x144)]][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0xec)]][_0x15e689(0x11e)]=0x0),!_0x37772e[_0x15e689(0xff)][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0x144)]][_0x3aa34e[_0x15e689(0xf4)]['category']]['net']&&(_0x37772e[_0x15e689(0xff)][_0x3aa34e['_id'][_0x15e689(0x144)]][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0xec)]][_0x15e689(0x13c)]=0x0),_0x37772e['sales_sa_year'][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0x144)]][_0x3aa34e[_0x15e689(0xf4)][_0x15e689(0xec)]][_0x15e689(0x11e)]=_0x3aa34e[_0x15e689(0x12e)],_0x37772e[_0x15e689(0xff)][_0x3aa34e['_id'][_0x15e689(0x144)]][_0x3aa34e['_id'][_0x15e689(0xec)]]['net']=_0x3aa34e[_0x15e689(0xd2)];}_0x10c1d1[_0x15e689(0xf6)]({'product':_0x4f7866[_0x15e689(0x128)],'month_data':_0x15ab3f[_0x15e689(0x111)],'year_data':_0x37772e[_0x15e689(0xff)]});}catch(_0x4b377f){console[_0x15e689(0xfd)](_0x4b377f);}}),module[a0_0x1b8439(0x136)]=router;