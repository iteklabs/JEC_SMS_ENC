const a0_0x5e2c17=a0_0x4752;function a0_0x1265(){const _0x10cc67=['$_id.brand','French','/sales_data_dashboard','$from_warehouse','15282311WJzuPR','Finished\x20Goods','English\x20(US)','email','$total_amount','23022Pvrifb','$return_product.return_qty','English','$count','$to_warehouse','$sumprice','False','/get_count','paid','$product_info','$sale_product.discount','index','index_acc','$adj_discount','$product_code','push','6jYPcNy','length','warehouse_category','body','findById','True','Arabic\x20(ae)','$total_price','$product_list','../models/all_models','log','$product_info.category','/paid_data_table','totalQty','sales_sa_year','$products.NetPrice','render','$return_sale','get','2930bwxwEt','brand','Chinese','../public/language/languages.json','$product.quantity','false','json','$_id.category','$name','$return_product','index_sa','qty','$product_info.gross_price','$product_info.brand','sad','$products.adj_discount','acc','net','$product','cat_brand','$sale_product','index_asd','$sale_product.price','flash','722576ucMpKV','$product.from_quantity','10808oThCwR','$NetPrice','sales_sa_month','$product_details','$product_list.product_stock','$products.product_details.brand','sale_product.product_code','aggregate','$products.qty','user','$product.product_name','4616qDjcqc','Arabic','$products.discount','product_info','/pending_data','$products.product_details.gross_price','$return_sale.sale_qty','123665JTSjqV','$product_info.product_code','$product.to_quantity','account_category','$sale_product.real_qty_unit_val','language','findOne','246csrXPx','$products.product_details.category','$product_info.name','post','Raw\x20Materials','$totalQty','/avg_data','$date','$sale_product.quantity','/paid_data','Hindi','Portuguese\x20(BR)','find','557061jqofJv','collection_price','valueOf','_id','$totalGross','1927184LoZFlZ','/pending_data_table','category','success','/update_data','$sale_product.totalprice','errors','Spanish','Router','$products.product_details'];a0_0x1265=function(){return _0x10cc67;};return a0_0x1265();}function a0_0x4752(_0x30ac46,_0x23bced){const _0x1265b6=a0_0x1265();return a0_0x4752=function(_0x4752d1,_0x5c3f16){_0x4752d1=_0x4752d1-0xbe;let _0x3bf244=_0x1265b6[_0x4752d1];return _0x3bf244;},a0_0x4752(_0x30ac46,_0x23bced);}(function(_0x10aaff,_0x1f1c90){const _0x373df7=a0_0x4752,_0x26068b=_0x10aaff();while(!![]){try{const _0x3506e=parseInt(_0x373df7(0x102))/0x1+parseInt(_0x373df7(0x107))/0x2+-parseInt(_0x373df7(0x12a))/0x3*(parseInt(_0x373df7(0xda))/0x4)+-parseInt(_0x373df7(0xee))/0x5*(-parseInt(_0x373df7(0xf5))/0x6)+-parseInt(_0x373df7(0xdc))/0x7*(parseInt(_0x373df7(0xe7))/0x8)+parseInt(_0x373df7(0x11a))/0x9*(parseInt(_0x373df7(0xc2))/0xa)+-parseInt(_0x373df7(0x115))/0xb;if(_0x3506e===_0x1f1c90)break;else _0x26068b['push'](_0x26068b['shift']());}catch(_0x5d58a3){_0x26068b['push'](_0x26068b['shift']());}}}(a0_0x1265,0x9cea3));const express=require('express'),app=express(),router=express[a0_0x5e2c17(0x10f)](),auth=require('../middleware/auth'),{profile,sales,sales_return,purchases,purchases_return,categories,product,suppliers,customer,master_shop,transfers,adjustment,purchases_finished,sales_finished,adjustment_finished,transfers_finished,staff,sales_sa,sales_order}=require(a0_0x5e2c17(0x133)),users=require(a0_0x5e2c17(0xc5));router[a0_0x5e2c17(0xc1)]('/index',auth,async(_0x3cfaea,_0x1a67ef)=>{const _0x166fca=a0_0x5e2c17;try{const {username:_0x36dee9,email:_0x1778d4,role:_0x4b70bb}=_0x3cfaea['user'],_0x420a14=_0x3cfaea[_0x166fca(0xe5)],_0x4c2a75=await master_shop[_0x166fca(0x101)](),_0x55ab43=await profile[_0x166fca(0xf4)]({'email':_0x420a14[_0x166fca(0x118)]});if(_0x4c2a75[0x0][_0x166fca(0xf3)]==_0x166fca(0x117))var _0x13f29f=users[_0x166fca(0x11c)];else{if(_0x4c2a75[0x0][_0x166fca(0xf3)]==_0x166fca(0xff))var _0x13f29f=users[_0x166fca(0xff)];else{if(_0x4c2a75[0x0][_0x166fca(0xf3)]=='German')var _0x13f29f=users['German'];else{if(_0x4c2a75[0x0][_0x166fca(0xf3)]==_0x166fca(0x10e))var _0x13f29f=users[_0x166fca(0x10e)];else{if(_0x4c2a75[0x0]['language']==_0x166fca(0x112))var _0x13f29f=users[_0x166fca(0x112)];else{if(_0x4c2a75[0x0][_0x166fca(0xf3)]==_0x166fca(0x100))var _0x13f29f=users['Portuguese'];else{if(_0x4c2a75[0x0][_0x166fca(0xf3)]==_0x166fca(0xc4))var _0x13f29f=users[_0x166fca(0xc4)];else{if(_0x4c2a75[0x0]['language']==_0x166fca(0x130))var _0x13f29f=users[_0x166fca(0xe8)];}}}}}}}if(_0x420a14['account_category']=='wm'){var _0x571d38;if(_0x420a14[_0x166fca(0x12c)]==_0x166fca(0xf9)){const _0x50794c=await product[_0x166fca(0x101)]({'product_category':_0x166fca(0xf9)});_0x571d38=_0x50794c['length'];}else{if(_0x420a14[_0x166fca(0x12c)]=='Finished\x20Goods'){const _0x34803e=await product[_0x166fca(0x101)]({'product_category':_0x166fca(0x116)});_0x571d38=_0x34803e[_0x166fca(0x12b)];}else{const _0x478bbd=await product['find']();_0x571d38=_0x478bbd['length'];}}const _0xce6f3e=await sales[_0x166fca(0xe3)]([{'$group':{'_id':null,'total_price':{'$sum':_0x166fca(0x131)}}}]),_0x3c9292=await sales[_0x166fca(0xe3)]([{'$unwind':_0x166fca(0xd6)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x166fca(0xfd)}}}]),_0x5e6e01=await sales_return[_0x166fca(0xe3)]([{'$group':{'_id':null,'total':{'$sum':_0x166fca(0x119)}}}]),_0x10e546=await sales_return[_0x166fca(0xe3)]([{'$unwind':'$return_sale'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x166fca(0xed)}}}]),_0x3940a5=await purchases[_0x166fca(0xe3)]([{'$group':{'_id':null,'total_amount':{'$sum':_0x166fca(0x119)}}}]),_0xaa1c1d=await purchases_return[_0x166fca(0xe3)]([{'$group':{'_id':null,'total':{'$sum':'$total_amount'}}}]),_0x2065f4=await purchases_return[_0x166fca(0xe3)]([{'$unwind':_0x166fca(0xcb)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x166fca(0x11b)}}}]),_0x4b2dea=await purchases['aggregate']([{'$unwind':_0x166fca(0xd4)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$product.quantity'}}}]),_0x19cce4=await purchases[_0x166fca(0xe3)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x8d429e=await sales['aggregate']([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x5223b2=await transfers['aggregate']([{'$unwind':_0x166fca(0xd4)},{'$group':{'_id':_0x166fca(0xe6),'fromWarehouse':{'$first':_0x166fca(0x114)},'toWareHouse':{'$first':_0x166fca(0x11e)},'FromtotalQuantity':{'$sum':_0x166fca(0xdb)},'TototalQuantity':{'$sum':_0x166fca(0xf0)}}}]),_0x192649=await categories[_0x166fca(0x101)](),_0x18895f=await product[_0x166fca(0x101)](),_0x5e4c9f=await suppliers[_0x166fca(0x101)](),_0x578dfa=await customer[_0x166fca(0x101)]();_0x1a67ef[_0x166fca(0xbf)](_0x166fca(0x125),{'success':_0x3cfaea[_0x166fca(0xd9)](_0x166fca(0x10a)),'errors':_0x3cfaea[_0x166fca(0xd9)]('errors'),'role':_0x420a14,'profile':_0x55ab43,'sale':_0xce6f3e[0x0],'sales_return':_0x5e6e01[0x0],'purchases':_0x3940a5[0x0],'purchases_return':_0xaa1c1d[0x0],'purchases_table':_0x19cce4,'sales_table':_0x8d429e,'categories':_0x192649[_0x166fca(0x12b)],'product':_0x18895f['length'],'suppliers':_0x5e4c9f[_0x166fca(0x12b)],'customer':_0x578dfa['length'],'master_shop':_0x4c2a75,'language':_0x13f29f,'sale_QTY':_0x3c9292[0x0],'purchases_QTY':_0x4b2dea[0x0],'sales_return_QTY':_0x10e546[0x0],'purchases_return_QTY':_0x2065f4[0x0],'transfer_table':_0x5223b2,'product_cnt':_0x571d38});}else{if(_0x420a14[_0x166fca(0xf1)]=='sa'){const _0x2a931a=await staff[_0x166fca(0xf4)]({'email':_0x420a14[_0x166fca(0x118)]}),_0x26c4c6=await sales_sa[_0x166fca(0x101)]({'sales_staff_id':_0x2a931a[_0x166fca(0x105)]}),_0x466a1d=await sales_sa[_0x166fca(0x101)]({'sales_staff_id':_0x2a931a['_id'],'paid':_0x166fca(0x12f)}),_0x1f2090=await sales_sa[_0x166fca(0x101)]({'sales_staff_id':_0x2a931a[_0x166fca(0x105)],'paid':'False'}),_0x244907=await sales_sa[_0x166fca(0xe3)]([{'$match':{'sales_staff_id':_0x2a931a[_0x166fca(0x105)][_0x166fca(0x104)]()}},{'$unwind':_0x166fca(0xd6)},{'$group':{'_id':null,'sumprice':{'$sum':'$sale_product.price'},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':[_0x166fca(0x11f),_0x166fca(0x11d)]},0x2]}}}]),_0xbd195d=await staff[_0x166fca(0xe3)]([{'$match':{'email':_0x420a14['email']}},{'$unwind':'$product_list'},{'$group':{'_id':null,'totalQTY':{'$sum':_0x166fca(0xe0)}}}]);_0x1a67ef['render'](_0x166fca(0xcc),{'success':_0x3cfaea[_0x166fca(0xd9)](_0x166fca(0x10a)),'errors':_0x3cfaea[_0x166fca(0xd9)](_0x166fca(0x10d)),'role':_0x420a14,'profile':_0x55ab43,'master_shop':_0x4c2a75,'language':_0x13f29f,'cntPaid':_0x466a1d,'cntNotPaid':_0x1f2090,'avg_price':_0x244907[0x0],'my_stock':_0xbd195d[0x0],'staff_arr':_0x2a931a});}else{if(_0x420a14[_0x166fca(0xf1)]==_0x166fca(0xd2)){const _0x5185b6=await staff['findOne']({'email':_0x420a14[_0x166fca(0x118)]});_0x1a67ef[_0x166fca(0xbf)](_0x166fca(0x126),{'success':_0x3cfaea[_0x166fca(0xd9)](_0x166fca(0x10a)),'errors':_0x3cfaea[_0x166fca(0xd9)](_0x166fca(0x10d)),'role':_0x420a14,'profile':_0x55ab43,'master_shop':_0x4c2a75,'language':_0x13f29f}),_0x1a67ef['json'](_0x5185b6);}else{if(_0x420a14[_0x166fca(0xf1)]==_0x166fca(0xd0)||_0x420a14[_0x166fca(0xf1)]=='rsm'||_0x420a14[_0x166fca(0xf1)]=='fss'){const _0x337752=await staff[_0x166fca(0xf4)]({'email':_0x420a14['email']});_0x1a67ef[_0x166fca(0xbf)](_0x166fca(0xd7),{'success':_0x3cfaea[_0x166fca(0xd9)](_0x166fca(0x10a)),'errors':_0x3cfaea[_0x166fca(0xd9)](_0x166fca(0x10d)),'role':_0x420a14,'profile':_0x55ab43,'master_shop':_0x4c2a75,'language':_0x13f29f});}else{var _0x571d38;if(_0x420a14[_0x166fca(0x12c)]==_0x166fca(0xf9)){const _0x88c60f=await product[_0x166fca(0x101)]({'product_category':_0x166fca(0xf9)});_0x571d38=_0x88c60f['length'];}else{if(_0x420a14['warehouse_category']==_0x166fca(0x116)){const _0x219ed7=await product[_0x166fca(0x101)]({'product_category':_0x166fca(0x116)});_0x571d38=_0x219ed7[_0x166fca(0x12b)];}else{const _0xc7b904=await product['find']();_0x571d38=_0xc7b904[_0x166fca(0x12b)];}}const _0x280da8=await sales[_0x166fca(0xe3)]([{'$group':{'_id':null,'total_price':{'$sum':_0x166fca(0x131)}}}]),_0x384b2b=await sales[_0x166fca(0xe3)]([{'$unwind':'$sale_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x166fca(0xfd)}}}]),_0xc069ea=await sales_return[_0x166fca(0xe3)]([{'$group':{'_id':null,'total':{'$sum':_0x166fca(0x119)}}}]),_0x1ae10e=await sales_return[_0x166fca(0xe3)]([{'$unwind':_0x166fca(0xc0)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$return_sale.sale_qty'}}}]),_0xda6f08=await purchases[_0x166fca(0xe3)]([{'$group':{'_id':null,'total_amount':{'$sum':_0x166fca(0x119)}}}]),_0x6e2aa=await purchases_return[_0x166fca(0xe3)]([{'$group':{'_id':null,'total':{'$sum':_0x166fca(0x119)}}}]),_0x3de553=await purchases_return[_0x166fca(0xe3)]([{'$unwind':'$return_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x166fca(0x11b)}}}]),_0x4a70cd=await purchases[_0x166fca(0xe3)]([{'$unwind':_0x166fca(0xd4)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x166fca(0xc6)}}}]),_0x12f0ed=await purchases[_0x166fca(0xe3)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x2fdee5=await sales[_0x166fca(0xe3)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x275c4d=await transfers[_0x166fca(0xe3)]([{'$unwind':_0x166fca(0xd4)},{'$group':{'_id':'$product.product_name','fromWarehouse':{'$first':_0x166fca(0x114)},'toWareHouse':{'$first':_0x166fca(0x11e)},'FromtotalQuantity':{'$sum':_0x166fca(0xdb)},'TototalQuantity':{'$sum':'$product.to_quantity'}}}]),_0x7edc38=await categories['find'](),_0x5d406d=await product['find'](),_0x4db5ec=await suppliers[_0x166fca(0x101)](),_0x3f2e11=await customer[_0x166fca(0x101)]();_0x1a67ef[_0x166fca(0xbf)](_0x166fca(0x125),{'success':_0x3cfaea[_0x166fca(0xd9)](_0x166fca(0x10a)),'errors':_0x3cfaea['flash']('errors'),'role':_0x420a14,'profile':_0x55ab43,'sale':_0x280da8[0x0],'sales_return':_0xc069ea[0x0],'purchases':_0xda6f08[0x0],'purchases_return':_0x6e2aa[0x0],'purchases_table':_0x12f0ed,'sales_table':_0x2fdee5,'categories':_0x7edc38[_0x166fca(0x12b)],'product':_0x5d406d[_0x166fca(0x12b)],'suppliers':_0x4db5ec[_0x166fca(0x12b)],'customer':_0x3f2e11['length'],'master_shop':_0x4c2a75,'language':_0x13f29f,'sale_QTY':_0x384b2b[0x0],'purchases_QTY':_0x4a70cd[0x0],'sales_return_QTY':_0x1ae10e[0x0],'purchases_return_QTY':_0x3de553[0x0],'transfer_table':_0x275c4d,'product_cnt':_0x571d38});}}}}}catch(_0xd06161){console['log'](_0xd06161);}}),router['get'](a0_0x5e2c17(0x108),auth,async(_0x4007be,_0x5c231d)=>{const _0x1dccae=a0_0x5e2c17;try{const _0xd26ef2=_0x4007be[_0x1dccae(0xe5)],_0x25e7ed=await staff[_0x1dccae(0xf4)]({'email':_0xd26ef2[_0x1dccae(0x118)]}),_0x2d619e=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x25e7ed[_0x1dccae(0x105)][_0x1dccae(0x104)](),'paid':_0x1dccae(0x120)}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x5c231d[_0x1dccae(0xc8)](_0x2d619e);}catch(_0x2527f9){_0x5c231d[_0x1dccae(0xc8)](_0x2527f9);}}),router[a0_0x5e2c17(0xc1)](a0_0x5e2c17(0xeb),auth,async(_0xb1bb36,_0xa9c48c)=>{const _0x37a2d6=a0_0x5e2c17;try{const _0x403474=_0xb1bb36[_0x37a2d6(0xe5)],_0x2f4872=await staff['findOne']({'email':_0x403474[_0x37a2d6(0x118)]}),_0x3aab69=await sales_sa[_0x37a2d6(0x101)]({'sales_staff_id':_0x2f4872['_id'],'paid':'False'});_0xa9c48c[_0x37a2d6(0xc8)](_0x3aab69);}catch(_0x5c169c){_0xa9c48c[_0x37a2d6(0xc8)](_0x5c169c);}}),router[a0_0x5e2c17(0xf8)](a0_0x5e2c17(0x121),auth,async(_0x452278,_0x197a6c)=>{const _0x13f49f=a0_0x5e2c17;try{const {sttaff_id:_0x534273,warehouse:_0x3cb8f2,account_category:_0x2a41fc}=_0x452278['user'],_0x2529b1=await sales_order[_0x13f49f(0xe3)]([{'$match':{'accounting_account_id':_0x534273,'accounting_account_confirm':'false'}}]);_0x197a6c[_0x13f49f(0xc8)](_0x2529b1);}catch(_0x28d03a){}}),router[a0_0x5e2c17(0xc1)](a0_0x5e2c17(0x136),auth,async(_0x598291,_0x493eff)=>{const _0x57d796=a0_0x5e2c17;try{const _0x4ee059=_0x598291[_0x57d796(0xe5)],_0x5ee5dc=await staff[_0x57d796(0xf4)]({'email':_0x4ee059['email']}),_0xe93eb6=await sales_sa['find']({'sales_staff_id':_0x5ee5dc[_0x57d796(0x105)],'paid':'True'});_0x493eff[_0x57d796(0xc8)](_0xe93eb6);}catch(_0xc42ab5){_0x493eff['json'](_0xc42ab5);}}),router[a0_0x5e2c17(0xc1)](a0_0x5e2c17(0xfe),auth,async(_0x29de7d,_0x1cccc5)=>{const _0x3f0fb0=a0_0x5e2c17;try{const _0x3f82b0=_0x29de7d[_0x3f0fb0(0xe5)],_0x40f3db=await staff[_0x3f0fb0(0xf4)]({'email':_0x3f82b0[_0x3f0fb0(0x118)]}),_0x387202=await sales_sa[_0x3f0fb0(0xe3)]([{'$match':{'sales_staff_id':_0x40f3db[_0x3f0fb0(0x105)][_0x3f0fb0(0x104)](),'paid':_0x3f0fb0(0x12f)}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x1cccc5[_0x3f0fb0(0xc8)](_0x387202);}catch(_0x4c2f79){_0x1cccc5[_0x3f0fb0(0xc8)](_0x4c2f79);}}),router[a0_0x5e2c17(0xf8)](a0_0x5e2c17(0x10b),auth,async(_0xd21cd5,_0x38b756)=>{const _0x505f66=a0_0x5e2c17;try{const {id:_0x6d336d,price:_0x89ae5f}=_0xd21cd5[_0x505f66(0x12d)],_0x2fc916=await sales_sa[_0x505f66(0x12e)](_0x6d336d);_0x2fc916[_0x505f66(0x122)]='True',_0x2fc916[_0x505f66(0x103)]=parseFloat(_0x89ae5f);const _0x4dbea8=await _0x2fc916['save']();_0x38b756[_0x505f66(0xc8)](_0x4dbea8);}catch(_0x5e04fb){_0x38b756[_0x505f66(0xc8)](_0x5e04fb);}}),router[a0_0x5e2c17(0xc1)](a0_0x5e2c17(0xeb),auth,async(_0x2af1c7,_0x3b316a)=>{const _0x1ebcb7=a0_0x5e2c17;try{const _0x5da9d3=_0x2af1c7[_0x1ebcb7(0xe5)],_0x220aff=await staff[_0x1ebcb7(0xf4)]({'email':_0x5da9d3[_0x1ebcb7(0x118)]}),_0x44fda5=await sales_sa[_0x1ebcb7(0x101)]({'sales_staff_id':_0x220aff[_0x1ebcb7(0x105)],'paid':'False'});_0x3b316a[_0x1ebcb7(0xc8)](_0x44fda5);}catch(_0x5f10fb){_0x3b316a['json'](_0x5f10fb);}}),router[a0_0x5e2c17(0xc1)](a0_0x5e2c17(0xfb),auth,async(_0x22db42,_0x128b02)=>{const _0x4b4095=a0_0x5e2c17;try{const _0x479277=_0x22db42[_0x4b4095(0xe5)],_0x380016=await staff['findOne']({'email':_0x479277[_0x4b4095(0x118)]}),_0x2d69c5=await sales_sa[_0x4b4095(0xe3)]([{'$match':{'sales_staff_id':_0x380016[_0x4b4095(0x105)][_0x4b4095(0x104)]()}},{'$unwind':_0x4b4095(0xd6)},{'$group':{'_id':null,'sumprice':{'$sum':_0x4b4095(0xd8)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':['$sumprice',_0x4b4095(0x11d)]},0x2]}}}]);_0x128b02[_0x4b4095(0xc8)](_0x2d69c5);}catch(_0x58870e){_0x128b02['json'](_0x58870e);}}),router[a0_0x5e2c17(0xc1)]('/my_inv',auth,async(_0x4ccc4b,_0x48452f)=>{const _0x44e634=a0_0x5e2c17;try{const _0x1d305b=_0x4ccc4b[_0x44e634(0xe5)],_0x57ccbb=await staff[_0x44e634(0xf4)]({'email':_0x1d305b[_0x44e634(0x118)]}),_0x452f92=await staff['aggregate']([{'$match':{'email':_0x1d305b[_0x44e634(0x118)]}},{'$unwind':_0x44e634(0x132)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':null,'totalQTY':{'$sum':_0x44e634(0xe0)}}}]);_0x48452f[_0x44e634(0xc8)](_0x452f92);}catch(_0xa92fc){_0x48452f[_0x44e634(0xc8)](_0xa92fc);}}),router[a0_0x5e2c17(0xc1)]('/sales_chart',auth,async(_0x2c17db,_0x2d5279)=>{const _0x49f832=a0_0x5e2c17;try{const _0x2f11e1=_0x2c17db[_0x49f832(0xe5)],_0x36b880=await staff['findOne']({'email':_0x2f11e1[_0x49f832(0x118)]}),_0x53dd43=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x36b880['_id']['valueOf']()}},{'$unwind':_0x49f832(0xd6)},{'$group':{'_id':'$date','totalQuantity':{'$sum':_0x49f832(0xfd)},'date':{'$first':_0x49f832(0xfc)}}},{'$sort':{'date':0x1}}]);_0x2d5279[_0x49f832(0xc8)](_0x53dd43);}catch(_0xed0a7d){_0x2d5279[_0x49f832(0xc8)](_0xed0a7d);}}),router[a0_0x5e2c17(0xc1)]('/price_chart',auth,async(_0x48b6d8,_0x578ab6)=>{const _0x1721bb=a0_0x5e2c17;try{const _0x4e3c46=_0x48b6d8['user'],_0x20dce6=await staff[_0x1721bb(0xf4)]({'email':_0x4e3c46[_0x1721bb(0x118)]}),_0x327980=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x20dce6[_0x1721bb(0x105)]['valueOf']()}},{'$unwind':_0x1721bb(0xd6)},{'$group':{'_id':'$date','totalPrice':{'$sum':_0x1721bb(0x10c)},'date':{'$first':_0x1721bb(0xfc)}}},{'$sort':{'date':0x1}}]);_0x578ab6['json'](_0x327980);}catch(_0x1acd92){_0x578ab6['json'](_0x1acd92);}}),router[a0_0x5e2c17(0xf8)](a0_0x5e2c17(0x113),auth,async(_0x9a7dd3,_0x431768)=>{const _0x5c5134=a0_0x5e2c17;try{const {date_today:_0x2e0302,first_month:_0x5a9b39,first_year:_0x5b33d0}=_0x9a7dd3[_0x5c5134(0x12d)],{sttaff_id:_0x229a3a}=_0x9a7dd3[_0x5c5134(0xe5)],_0x3756ff=await product[_0x5c5134(0xe3)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':_0x5c5134(0xca),'product_code':_0x5c5134(0x128)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xe5efa6=[];_0xe5efa6[_0x5c5134(0xd5)]=[];for(let _0x4b38ec=0x0;_0x4b38ec<=_0x3756ff[_0x5c5134(0x12b)]-0x1;_0x4b38ec++){const _0x220c1a=_0x3756ff[_0x4b38ec];_0xe5efa6[_0x5c5134(0xd5)][_0x5c5134(0x129)](_0x220c1a);}const _0x213754=await sales_sa[_0x5c5134(0xe3)]([{'$match':{'date':{'$gte':_0x5a9b39,'$lte':_0x2e0302},'sales_staff_id':_0x229a3a,'sale_product.isFG':_0x5c5134(0xc7),'status_data':'false'}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x5c5134(0xc7)}},{'$lookup':{'from':'products','localField':_0x5c5134(0xe2),'foreignField':'product_code','as':_0x5c5134(0xea)}},{'$unwind':_0x5c5134(0x123)},{'$group':{'_id':{'category':'$product_info.category','brand':_0x5c5134(0xcf)},'totalQty':{'$sum':_0x5c5134(0xf2)},'products':{'$push':{'qty':_0x5c5134(0xf2),'NetPrice':_0x5c5134(0x10c),'discount':_0x5c5134(0x124),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x5c5134(0xf7),'product_code':_0x5c5134(0xef),'category':_0x5c5134(0x135),'brand':_0x5c5134(0xcf),'gross_price':_0x5c5134(0xce)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'category':_0x5c5134(0xf6),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x5c5134(0xe4)},'totalGross':{'$sum':{'$multiply':[_0x5c5134(0xe4),_0x5c5134(0xec)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x5c5134(0xe9)},'adj_discount':{'$sum':_0x5c5134(0xd1)},'product_details':{'$first':_0x5c5134(0x110)}}},{'$group':{'_id':{'category':_0x5c5134(0xc9),'brand':_0x5c5134(0x111)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x5c5134(0x106)},'NetPrice':{'$sum':_0x5c5134(0xdd)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x5c5134(0x127)},'products':{'$push':{'qty':_0x5c5134(0xfa),'category':_0x5c5134(0xc9),'brand':_0x5c5134(0x111),'product_details':_0x5c5134(0xdf)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x14e2d7=[];_0x14e2d7[_0x5c5134(0xde)]={};for(let _0x199624=0x0;_0x199624<=_0x213754[_0x5c5134(0x12b)]-0x1;_0x199624++){const _0x5c8744=_0x213754[_0x199624];!_0x14e2d7[_0x5c5134(0xde)][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0xc3)]]&&(_0x14e2d7[_0x5c5134(0xde)][_0x5c8744[_0x5c5134(0x105)]['brand']]={}),!_0x14e2d7['sales_sa_month'][_0x5c8744['_id']['brand']][_0x5c8744[_0x5c5134(0x105)]['category']]&&(_0x14e2d7[_0x5c5134(0xde)][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0xc3)]][_0x5c8744['_id']['category']]={}),!_0x14e2d7['sales_sa_month'][_0x5c8744['_id']['brand']][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0x109)]][_0x5c5134(0xcd)]&&(_0x14e2d7['sales_sa_month'][_0x5c8744[_0x5c5134(0x105)]['brand']][_0x5c8744[_0x5c5134(0x105)]['category']]['qty']=0x0),!_0x14e2d7[_0x5c5134(0xde)][_0x5c8744['_id'][_0x5c5134(0xc3)]][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0x109)]][_0x5c5134(0xd3)]&&(_0x14e2d7['sales_sa_month'][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0xc3)]][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0x109)]][_0x5c5134(0xd3)]=0x0),_0x14e2d7[_0x5c5134(0xde)][_0x5c8744['_id']['brand']][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0x109)]][_0x5c5134(0xcd)]=_0x5c8744['totalQty'],_0x14e2d7[_0x5c5134(0xde)][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0xc3)]][_0x5c8744[_0x5c5134(0x105)][_0x5c5134(0x109)]][_0x5c5134(0xd3)]=_0x5c8744['NetPrice'];}const _0x2d2697=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x5b33d0,'$lte':_0x2e0302},'sales_staff_id':_0x229a3a,'sale_product.isFG':_0x5c5134(0xc7),'status_data':_0x5c5134(0xc7)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x5c5134(0xc7)}},{'$lookup':{'from':'products','localField':_0x5c5134(0xe2),'foreignField':'product_code','as':_0x5c5134(0xea)}},{'$unwind':_0x5c5134(0x123)},{'$group':{'_id':{'category':_0x5c5134(0x135),'brand':_0x5c5134(0xcf)},'totalQty':{'$sum':_0x5c5134(0xf2)},'products':{'$push':{'qty':_0x5c5134(0xf2),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':_0x5c5134(0xef),'category':'$product_info.category','brand':_0x5c5134(0xcf),'gross_price':_0x5c5134(0xce)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'category':_0x5c5134(0xf6),'brand':_0x5c5134(0xe1)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x5c5134(0xe4),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x5c5134(0xbe)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x5c5134(0xd1)},'product_details':{'$first':_0x5c5134(0x110)}}},{'$group':{'_id':{'category':'$_id.category','brand':'$_id.brand'},'totalQty':{'$sum':_0x5c5134(0xfa)},'totalGross':{'$sum':_0x5c5134(0x106)},'NetPrice':{'$sum':_0x5c5134(0xdd)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x5c5134(0xfa),'category':_0x5c5134(0xc9),'brand':_0x5c5134(0x111),'product_details':_0x5c5134(0xdf)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x25992c=[];_0x25992c['sales_sa_year']={};for(let _0x53640c=0x0;_0x53640c<=_0x2d2697[_0x5c5134(0x12b)]-0x1;_0x53640c++){const _0x1f77b3=_0x2d2697[_0x53640c];!_0x25992c['sales_sa_year'][_0x1f77b3[_0x5c5134(0x105)]['brand']]&&(_0x25992c[_0x5c5134(0x138)][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0xc3)]]={}),!_0x25992c[_0x5c5134(0x138)][_0x1f77b3[_0x5c5134(0x105)]['brand']][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0x109)]]&&(_0x25992c['sales_sa_year'][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0xc3)]][_0x1f77b3[_0x5c5134(0x105)]['category']]={}),!_0x25992c['sales_sa_year'][_0x1f77b3['_id'][_0x5c5134(0xc3)]][_0x1f77b3['_id'][_0x5c5134(0x109)]][_0x5c5134(0xcd)]&&(_0x25992c[_0x5c5134(0x138)][_0x1f77b3[_0x5c5134(0x105)]['brand']][_0x1f77b3[_0x5c5134(0x105)]['category']]['qty']=0x0),!_0x25992c[_0x5c5134(0x138)][_0x1f77b3[_0x5c5134(0x105)]['brand']][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0x109)]]['net']&&(_0x25992c[_0x5c5134(0x138)][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0xc3)]][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0x109)]]['net']=0x0),_0x25992c['sales_sa_year'][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0xc3)]][_0x1f77b3[_0x5c5134(0x105)]['category']][_0x5c5134(0xcd)]=_0x1f77b3[_0x5c5134(0x137)],_0x25992c['sales_sa_year'][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0xc3)]][_0x1f77b3[_0x5c5134(0x105)][_0x5c5134(0x109)]][_0x5c5134(0xd3)]=_0x1f77b3['NetPrice'];}_0x431768['json']({'product':_0xe5efa6[_0x5c5134(0xd5)],'month_data':_0x14e2d7[_0x5c5134(0xde)],'year_data':_0x25992c[_0x5c5134(0x138)]});}catch(_0x10bc4c){console[_0x5c5134(0x134)](_0x10bc4c);}}),module['exports']=router;