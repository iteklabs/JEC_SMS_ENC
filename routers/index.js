const a0_0x3e34fb=a0_0x27c1;function a0_0x67e8(){const _0x43ade2=['brand','exports','rsm','$product_info.name','$brand','log','../public/language/languages.json','/paid_data','5QKrFUh','qty','Hindi','index','json','/sales_chart','$product_info.gross_price','false','$total_price','$product_list.product_stock','$product_info.product_code','$products.product_details.gross_price','errors','$totalGross','products','sale_product.product_code','4999603kOqoJA','$products.product_details.brand','4843584mcmHlL','paid','index_acc','1708944HgpxSH','/avg_data','_id','$sale_product.quantity','index_asd','$total_amount','/index','$product_info','post','category','NetPrice','$products','8mbIhQb','False','warehouse_category','Arabic\x20(ae)','$name','product_code','$return_sale.sale_qty','$sale_product.adj_discount','$product_info.category','success','$product_info.brand','$product.quantity','express','body','length','$return_sale','$count','$sale_product','net','$product_code','German','email','Portuguese\x20(BR)','$products.NetPrice','$sale_product.price','aggregate','$products.product_details.category','/pending_data_table','find','Raw\x20Materials','6937803PGEvub','sales_sa_month','$date','215kEYsab','$product_list','$product','Portuguese','cat_brand','$sale_product.real_qty_unit_val','True','Chinese','Router','$_id.brand','$return_product.return_qty','get','English','/sales_data_dashboard','$product_details','fss','$NetPrice','10986ieMwQz','8752850FfUvMN','$sale_product.totalprice','1529571VILFqC','$_id.category','account_category','$return_product','user','language','render','index_sa','valueOf','/pending_data','save','acc','Spanish','findOne','$totalQty','$products.qty','$sumprice','$products.discount','French','$to_warehouse','flash','Arabic','$from_warehouse','$products.adj_discount','/update_data','$product.product_name','Finished\x20Goods','$adj_discount','$discount','totalQty','true','$product.to_quantity','sales_sa_year'];a0_0x67e8=function(){return _0x43ade2;};return a0_0x67e8();}function a0_0x27c1(_0x54c884,_0x22bd2a){const _0x67e84c=a0_0x67e8();return a0_0x27c1=function(_0x27c153,_0x16e113){_0x27c153=_0x27c153-0x147;let _0x5b1f67=_0x67e84c[_0x27c153];return _0x5b1f67;},a0_0x27c1(_0x54c884,_0x22bd2a);}(function(_0x1d976c,_0x1d8e95){const _0xe4d14a=a0_0x27c1,_0x54210e=_0x1d976c();while(!![]){try{const _0x3a9b0c=-parseInt(_0xe4d14a(0x162))/0x1*(parseInt(_0xe4d14a(0x173))/0x2)+-parseInt(_0xe4d14a(0x176))/0x3+parseInt(_0xe4d14a(0x1b1))/0x4+-parseInt(_0xe4d14a(0x19f))/0x5*(-parseInt(_0xe4d14a(0x1b4))/0x6)+parseInt(_0xe4d14a(0x1af))/0x7+-parseInt(_0xe4d14a(0x1c0))/0x8*(parseInt(_0xe4d14a(0x15f))/0x9)+parseInt(_0xe4d14a(0x174))/0xa;if(_0x3a9b0c===_0x1d8e95)break;else _0x54210e['push'](_0x54210e['shift']());}catch(_0x38469c){_0x54210e['push'](_0x54210e['shift']());}}}(a0_0x67e8,0x9839b));const express=require(a0_0x3e34fb(0x14d)),app=express(),router=express[a0_0x3e34fb(0x16a)](),auth=require('../middleware/auth'),{profile,sales,sales_return,purchases,purchases_return,categories,product,suppliers,customer,master_shop,transfers,adjustment,purchases_finished,sales_finished,adjustment_finished,transfers_finished,staff,sales_sa,sales_order}=require('../models/all_models'),users=require(a0_0x3e34fb(0x19d));router[a0_0x3e34fb(0x16d)](a0_0x3e34fb(0x1ba),auth,async(_0x1dab0a,_0x22dfa1)=>{const _0x2c4377=a0_0x3e34fb;try{const {username:_0x51a9cf,email:_0x4a598e,role:_0x99e578}=_0x1dab0a[_0x2c4377(0x17a)],_0x4cfb04=_0x1dab0a['user'],_0x393cc2=await master_shop[_0x2c4377(0x15d)](),_0x4da64a=await profile['findOne']({'email':_0x4cfb04[_0x2c4377(0x156)]});if(_0x393cc2[0x0]['language']=='English\x20(US)')var _0x4120c5=users[_0x2c4377(0x16e)];else{if(_0x393cc2[0x0][_0x2c4377(0x17b)]==_0x2c4377(0x1a1))var _0x4120c5=users[_0x2c4377(0x1a1)];else{if(_0x393cc2[0x0]['language']=='German')var _0x4120c5=users[_0x2c4377(0x155)];else{if(_0x393cc2[0x0][_0x2c4377(0x17b)]==_0x2c4377(0x182))var _0x4120c5=users[_0x2c4377(0x182)];else{if(_0x393cc2[0x0][_0x2c4377(0x17b)]==_0x2c4377(0x188))var _0x4120c5=users['French'];else{if(_0x393cc2[0x0]['language']==_0x2c4377(0x157))var _0x4120c5=users[_0x2c4377(0x165)];else{if(_0x393cc2[0x0][_0x2c4377(0x17b)]=='Chinese')var _0x4120c5=users[_0x2c4377(0x169)];else{if(_0x393cc2[0x0][_0x2c4377(0x17b)]==_0x2c4377(0x1c3))var _0x4120c5=users[_0x2c4377(0x18b)];}}}}}}}if(_0x4cfb04['account_category']=='wm'){var _0x31bdcd;if(_0x4cfb04['warehouse_category']==_0x2c4377(0x15e)){const _0x50e5ff=await product['find']({'product_category':_0x2c4377(0x15e)});_0x31bdcd=_0x50e5ff[_0x2c4377(0x14f)];}else{if(_0x4cfb04[_0x2c4377(0x1c2)]==_0x2c4377(0x190)){const _0x3920a8=await product[_0x2c4377(0x15d)]({'product_category':'Finished\x20Goods'});_0x31bdcd=_0x3920a8[_0x2c4377(0x14f)];}else{const _0x8fd40a=await product[_0x2c4377(0x15d)]();_0x31bdcd=_0x8fd40a['length'];}}const _0x40e608=await sales[_0x2c4377(0x15a)]([{'$group':{'_id':null,'total_price':{'$sum':'$total_price'}}}]),_0x569ec5=await sales[_0x2c4377(0x15a)]([{'$unwind':'$sale_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':'$sale_product.quantity'}}}]),_0x140327=await sales_return['aggregate']([{'$group':{'_id':null,'total':{'$sum':_0x2c4377(0x1b9)}}}]),_0x539589=await sales_return[_0x2c4377(0x15a)]([{'$unwind':_0x2c4377(0x150)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x2c4377(0x147)}}}]),_0x4ff374=await purchases[_0x2c4377(0x15a)]([{'$group':{'_id':null,'total_amount':{'$sum':_0x2c4377(0x1b9)}}}]),_0x2afe26=await purchases_return[_0x2c4377(0x15a)]([{'$group':{'_id':null,'total':{'$sum':_0x2c4377(0x1b9)}}}]),_0x45b2ac=await purchases_return[_0x2c4377(0x15a)]([{'$unwind':_0x2c4377(0x179)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x2c4377(0x16c)}}}]),_0x47e69f=await purchases[_0x2c4377(0x15a)]([{'$unwind':_0x2c4377(0x164)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x2c4377(0x14c)}}}]),_0xc7a88d=await purchases[_0x2c4377(0x15a)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x5cf441=await sales['aggregate']([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x2f7791=await transfers[_0x2c4377(0x15a)]([{'$unwind':'$product'},{'$group':{'_id':'$product.product_name','fromWarehouse':{'$first':'$from_warehouse'},'toWareHouse':{'$first':_0x2c4377(0x189)},'FromtotalQuantity':{'$sum':'$product.from_quantity'},'TototalQuantity':{'$sum':_0x2c4377(0x195)}}}]),_0xdea8f9=await categories[_0x2c4377(0x15d)](),_0x2160ce=await product['find'](),_0x48e359=await suppliers['find'](),_0x4d0e2b=await customer[_0x2c4377(0x15d)]();_0x22dfa1[_0x2c4377(0x17c)](_0x2c4377(0x1a2),{'success':_0x1dab0a[_0x2c4377(0x18a)](_0x2c4377(0x14a)),'errors':_0x1dab0a['flash'](_0x2c4377(0x1ab)),'role':_0x4cfb04,'profile':_0x4da64a,'sale':_0x40e608[0x0],'sales_return':_0x140327[0x0],'purchases':_0x4ff374[0x0],'purchases_return':_0x2afe26[0x0],'purchases_table':_0xc7a88d,'sales_table':_0x5cf441,'categories':_0xdea8f9[_0x2c4377(0x14f)],'product':_0x2160ce[_0x2c4377(0x14f)],'suppliers':_0x48e359['length'],'customer':_0x4d0e2b[_0x2c4377(0x14f)],'master_shop':_0x393cc2,'language':_0x4120c5,'sale_QTY':_0x569ec5[0x0],'purchases_QTY':_0x47e69f[0x0],'sales_return_QTY':_0x539589[0x0],'purchases_return_QTY':_0x45b2ac[0x0],'transfer_table':_0x2f7791,'product_cnt':_0x31bdcd});}else{if(_0x4cfb04[_0x2c4377(0x178)]=='sa'){const _0x2ef9a1=await staff['findOne']({'email':_0x4cfb04[_0x2c4377(0x156)]}),_0x2dd0fa=await sales_sa[_0x2c4377(0x15d)]({'sales_staff_id':_0x2ef9a1[_0x2c4377(0x1b6)]}),_0x578ec4=await sales_sa[_0x2c4377(0x15d)]({'sales_staff_id':_0x2ef9a1['_id'],'paid':_0x2c4377(0x168)}),_0x543754=await sales_sa[_0x2c4377(0x15d)]({'sales_staff_id':_0x2ef9a1['_id'],'paid':_0x2c4377(0x1c1)}),_0x14bbb2=await sales_sa[_0x2c4377(0x15a)]([{'$match':{'sales_staff_id':_0x2ef9a1['_id']['valueOf']()}},{'$unwind':_0x2c4377(0x152)},{'$group':{'_id':null,'sumprice':{'$sum':_0x2c4377(0x159)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':[_0x2c4377(0x186),_0x2c4377(0x151)]},0x2]}}}]),_0x10ce59=await staff[_0x2c4377(0x15a)]([{'$match':{'email':_0x4cfb04[_0x2c4377(0x156)]}},{'$unwind':_0x2c4377(0x163)},{'$group':{'_id':null,'totalQTY':{'$sum':_0x2c4377(0x1a8)}}}]);_0x22dfa1[_0x2c4377(0x17c)](_0x2c4377(0x17d),{'success':_0x1dab0a['flash'](_0x2c4377(0x14a)),'errors':_0x1dab0a[_0x2c4377(0x18a)](_0x2c4377(0x1ab)),'role':_0x4cfb04,'profile':_0x4da64a,'master_shop':_0x393cc2,'language':_0x4120c5,'cntPaid':_0x578ec4,'cntNotPaid':_0x543754,'avg_price':_0x14bbb2[0x0],'my_stock':_0x10ce59[0x0],'staff_arr':_0x2ef9a1});}else{if(_0x4cfb04[_0x2c4377(0x178)]==_0x2c4377(0x181)){const _0x323c97=await staff[_0x2c4377(0x183)]({'email':_0x4cfb04[_0x2c4377(0x156)]});_0x22dfa1[_0x2c4377(0x17c)](_0x2c4377(0x1b3),{'success':_0x1dab0a[_0x2c4377(0x18a)]('success'),'errors':_0x1dab0a[_0x2c4377(0x18a)](_0x2c4377(0x1ab)),'role':_0x4cfb04,'profile':_0x4da64a,'master_shop':_0x393cc2,'language':_0x4120c5}),_0x22dfa1[_0x2c4377(0x1a3)](_0x323c97);}else{if(_0x4cfb04['account_category']=='sad'||_0x4cfb04[_0x2c4377(0x178)]==_0x2c4377(0x199)||_0x4cfb04[_0x2c4377(0x178)]==_0x2c4377(0x171)){const _0x23eca2=await staff[_0x2c4377(0x183)]({'email':_0x4cfb04[_0x2c4377(0x156)]});_0x22dfa1[_0x2c4377(0x17c)](_0x2c4377(0x1b8),{'success':_0x1dab0a['flash'](_0x2c4377(0x14a)),'errors':_0x1dab0a[_0x2c4377(0x18a)](_0x2c4377(0x1ab)),'role':_0x4cfb04,'profile':_0x4da64a,'master_shop':_0x393cc2,'language':_0x4120c5});}else{var _0x31bdcd;if(_0x4cfb04[_0x2c4377(0x1c2)]=='Raw\x20Materials'){const _0x572ff2=await product[_0x2c4377(0x15d)]({'product_category':_0x2c4377(0x15e)});_0x31bdcd=_0x572ff2['length'];}else{if(_0x4cfb04[_0x2c4377(0x1c2)]==_0x2c4377(0x190)){const _0x2f3c07=await product['find']({'product_category':'Finished\x20Goods'});_0x31bdcd=_0x2f3c07[_0x2c4377(0x14f)];}else{const _0x434083=await product['find']();_0x31bdcd=_0x434083['length'];}}const _0x342e27=await sales[_0x2c4377(0x15a)]([{'$group':{'_id':null,'total_price':{'$sum':_0x2c4377(0x1a7)}}}]),_0x348bb4=await sales[_0x2c4377(0x15a)]([{'$unwind':'$sale_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x2c4377(0x1b7)}}}]),_0x3db877=await sales_return[_0x2c4377(0x15a)]([{'$group':{'_id':null,'total':{'$sum':_0x2c4377(0x1b9)}}}]),_0x45d7b3=await sales_return[_0x2c4377(0x15a)]([{'$unwind':_0x2c4377(0x150)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x2c4377(0x147)}}}]),_0x2d6b85=await purchases[_0x2c4377(0x15a)]([{'$group':{'_id':null,'total_amount':{'$sum':_0x2c4377(0x1b9)}}}]),_0x177c4c=await purchases_return[_0x2c4377(0x15a)]([{'$group':{'_id':null,'total':{'$sum':_0x2c4377(0x1b9)}}}]),_0x443a8d=await purchases_return[_0x2c4377(0x15a)]([{'$unwind':'$return_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':'$return_product.return_qty'}}}]),_0x15165f=await purchases['aggregate']([{'$unwind':_0x2c4377(0x164)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x2c4377(0x14c)}}}]),_0x3ac7bb=await purchases[_0x2c4377(0x15a)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x4ccd73=await sales[_0x2c4377(0x15a)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x1c1ff0=await transfers[_0x2c4377(0x15a)]([{'$unwind':_0x2c4377(0x164)},{'$group':{'_id':_0x2c4377(0x18f),'fromWarehouse':{'$first':_0x2c4377(0x18c)},'toWareHouse':{'$first':_0x2c4377(0x189)},'FromtotalQuantity':{'$sum':'$product.from_quantity'},'TototalQuantity':{'$sum':_0x2c4377(0x195)}}}]),_0x2aa57f=await categories[_0x2c4377(0x15d)](),_0x515153=await product[_0x2c4377(0x15d)](),_0x4177d6=await suppliers['find'](),_0x592a24=await customer[_0x2c4377(0x15d)]();_0x22dfa1[_0x2c4377(0x17c)]('index',{'success':_0x1dab0a[_0x2c4377(0x18a)](_0x2c4377(0x14a)),'errors':_0x1dab0a[_0x2c4377(0x18a)](_0x2c4377(0x1ab)),'role':_0x4cfb04,'profile':_0x4da64a,'sale':_0x342e27[0x0],'sales_return':_0x3db877[0x0],'purchases':_0x2d6b85[0x0],'purchases_return':_0x177c4c[0x0],'purchases_table':_0x3ac7bb,'sales_table':_0x4ccd73,'categories':_0x2aa57f[_0x2c4377(0x14f)],'product':_0x515153[_0x2c4377(0x14f)],'suppliers':_0x4177d6['length'],'customer':_0x592a24[_0x2c4377(0x14f)],'master_shop':_0x393cc2,'language':_0x4120c5,'sale_QTY':_0x348bb4[0x0],'purchases_QTY':_0x15165f[0x0],'sales_return_QTY':_0x45d7b3[0x0],'purchases_return_QTY':_0x443a8d[0x0],'transfer_table':_0x1c1ff0,'product_cnt':_0x31bdcd});}}}}}catch(_0x1509ac){console['log'](_0x1509ac);}}),router['get'](a0_0x3e34fb(0x15c),auth,async(_0x3012d4,_0x582084)=>{const _0x18d252=a0_0x3e34fb;try{const _0x1e5ed2=_0x3012d4['user'],_0x23f96a=await staff[_0x18d252(0x183)]({'email':_0x1e5ed2[_0x18d252(0x156)]}),_0x13b357=await sales_sa[_0x18d252(0x15a)]([{'$match':{'sales_staff_id':_0x23f96a[_0x18d252(0x1b6)][_0x18d252(0x17e)](),'paid':_0x18d252(0x1c1)}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x582084[_0x18d252(0x1a3)](_0x13b357);}catch(_0x442903){_0x582084[_0x18d252(0x1a3)](_0x442903);}}),router[a0_0x3e34fb(0x16d)]('/pending_data',auth,async(_0x3e2a48,_0x2fa769)=>{const _0x129324=a0_0x3e34fb;try{const _0x4e3372=_0x3e2a48['user'],_0x312788=await staff['findOne']({'email':_0x4e3372[_0x129324(0x156)]}),_0x2eb6ad=await sales_sa[_0x129324(0x15d)]({'sales_staff_id':_0x312788[_0x129324(0x1b6)],'paid':_0x129324(0x1c1)});_0x2fa769[_0x129324(0x1a3)](_0x2eb6ad);}catch(_0x4d9f10){_0x2fa769[_0x129324(0x1a3)](_0x4d9f10);}}),router[a0_0x3e34fb(0x1bc)]('/get_count',auth,async(_0x5d9731,_0x2a4e96)=>{const _0x5b0dae=a0_0x3e34fb;try{const {sttaff_id:_0x3d4484,warehouse:_0x38f57b,account_category:_0x220116}=_0x5d9731[_0x5b0dae(0x17a)],_0x1ad99b=await sales_order[_0x5b0dae(0x15a)]([{'$match':{'accounting_account_id':_0x3d4484,'accounting_account_confirm':_0x5b0dae(0x1a6)}}]);_0x2a4e96[_0x5b0dae(0x1a3)](_0x1ad99b);}catch(_0x134793){}}),router[a0_0x3e34fb(0x16d)]('/paid_data_table',auth,async(_0x165f1a,_0x1d3bf7)=>{const _0x15dac2=a0_0x3e34fb;try{const _0xb015dc=_0x165f1a[_0x15dac2(0x17a)],_0x19fad1=await staff[_0x15dac2(0x183)]({'email':_0xb015dc[_0x15dac2(0x156)]}),_0x26de0f=await sales_sa[_0x15dac2(0x15d)]({'sales_staff_id':_0x19fad1[_0x15dac2(0x1b6)],'paid':_0x15dac2(0x168)});_0x1d3bf7['json'](_0x26de0f);}catch(_0x21a2b1){_0x1d3bf7[_0x15dac2(0x1a3)](_0x21a2b1);}}),router['get'](a0_0x3e34fb(0x19e),auth,async(_0x2806c8,_0x174655)=>{const _0x7e9a72=a0_0x3e34fb;try{const _0x5d4c48=_0x2806c8[_0x7e9a72(0x17a)],_0x33c6c6=await staff[_0x7e9a72(0x183)]({'email':_0x5d4c48[_0x7e9a72(0x156)]}),_0x5bad5a=await sales_sa[_0x7e9a72(0x15a)]([{'$match':{'sales_staff_id':_0x33c6c6[_0x7e9a72(0x1b6)]['valueOf'](),'paid':_0x7e9a72(0x168)}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x174655[_0x7e9a72(0x1a3)](_0x5bad5a);}catch(_0x1a1da1){_0x174655['json'](_0x1a1da1);}}),router[a0_0x3e34fb(0x1bc)](a0_0x3e34fb(0x18e),auth,async(_0x1afe07,_0x1dc892)=>{const _0x312ec5=a0_0x3e34fb;try{const {id:_0x45f061,price:_0x5e33ce}=_0x1afe07['body'],_0x5c9271=await sales_sa['findById'](_0x45f061);_0x5c9271[_0x312ec5(0x1b2)]=_0x312ec5(0x168),_0x5c9271['collection_price']=parseFloat(_0x5e33ce);const _0x180412=await _0x5c9271[_0x312ec5(0x180)]();_0x1dc892[_0x312ec5(0x1a3)](_0x180412);}catch(_0x141d75){_0x1dc892[_0x312ec5(0x1a3)](_0x141d75);}}),router['get'](a0_0x3e34fb(0x17f),auth,async(_0x3a6910,_0x3f4465)=>{const _0x4def19=a0_0x3e34fb;try{const _0x2861a0=_0x3a6910['user'],_0x4e247b=await staff[_0x4def19(0x183)]({'email':_0x2861a0[_0x4def19(0x156)]}),_0x435c4c=await sales_sa[_0x4def19(0x15d)]({'sales_staff_id':_0x4e247b[_0x4def19(0x1b6)],'paid':_0x4def19(0x1c1)});_0x3f4465[_0x4def19(0x1a3)](_0x435c4c);}catch(_0x3eaac3){_0x3f4465[_0x4def19(0x1a3)](_0x3eaac3);}}),router['get'](a0_0x3e34fb(0x1b5),auth,async(_0x41589a,_0x41a8f7)=>{const _0x485dd1=a0_0x3e34fb;try{const _0x28a2b8=_0x41589a['user'],_0x25e4ce=await staff[_0x485dd1(0x183)]({'email':_0x28a2b8[_0x485dd1(0x156)]}),_0x3d28f6=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x25e4ce[_0x485dd1(0x1b6)][_0x485dd1(0x17e)]()}},{'$unwind':'$sale_product'},{'$group':{'_id':null,'sumprice':{'$sum':_0x485dd1(0x159)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':[_0x485dd1(0x186),_0x485dd1(0x151)]},0x2]}}}]);_0x41a8f7[_0x485dd1(0x1a3)](_0x3d28f6);}catch(_0x434937){_0x41a8f7[_0x485dd1(0x1a3)](_0x434937);}}),router['get']('/my_inv',auth,async(_0x4d3dbb,_0x568d22)=>{const _0x231466=a0_0x3e34fb;try{const _0x3c82a0=_0x4d3dbb[_0x231466(0x17a)],_0xced0c3=await staff['findOne']({'email':_0x3c82a0[_0x231466(0x156)]}),_0x2886a5=await staff[_0x231466(0x15a)]([{'$match':{'email':_0x3c82a0[_0x231466(0x156)]}},{'$unwind':'$product_list'},{'$match':{'product_list.isConfirm':_0x231466(0x194)}},{'$group':{'_id':null,'totalQTY':{'$sum':_0x231466(0x1a8)}}}]);_0x568d22[_0x231466(0x1a3)](_0x2886a5);}catch(_0x50bac6){_0x568d22[_0x231466(0x1a3)](_0x50bac6);}}),router[a0_0x3e34fb(0x16d)](a0_0x3e34fb(0x1a4),auth,async(_0xbd8719,_0x44440)=>{const _0x345963=a0_0x3e34fb;try{const _0x9f43ee=_0xbd8719[_0x345963(0x17a)],_0x30fe60=await staff[_0x345963(0x183)]({'email':_0x9f43ee[_0x345963(0x156)]}),_0x15e574=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x30fe60[_0x345963(0x1b6)][_0x345963(0x17e)]()}},{'$unwind':_0x345963(0x152)},{'$group':{'_id':_0x345963(0x161),'totalQuantity':{'$sum':_0x345963(0x1b7)},'date':{'$first':'$date'}}},{'$sort':{'date':0x1}}]);_0x44440[_0x345963(0x1a3)](_0x15e574);}catch(_0x148681){_0x44440[_0x345963(0x1a3)](_0x148681);}}),router[a0_0x3e34fb(0x16d)]('/price_chart',auth,async(_0xb62387,_0x2712d2)=>{const _0xc5d03d=a0_0x3e34fb;try{const _0x11d094=_0xb62387[_0xc5d03d(0x17a)],_0x29fd13=await staff['findOne']({'email':_0x11d094[_0xc5d03d(0x156)]}),_0x18546a=await sales_sa[_0xc5d03d(0x15a)]([{'$match':{'sales_staff_id':_0x29fd13[_0xc5d03d(0x1b6)][_0xc5d03d(0x17e)]()}},{'$unwind':_0xc5d03d(0x152)},{'$group':{'_id':_0xc5d03d(0x161),'totalPrice':{'$sum':'$sale_product.totalprice'},'date':{'$first':_0xc5d03d(0x161)}}},{'$sort':{'date':0x1}}]);_0x2712d2['json'](_0x18546a);}catch(_0x5a3f11){_0x2712d2[_0xc5d03d(0x1a3)](_0x5a3f11);}}),router[a0_0x3e34fb(0x1bc)](a0_0x3e34fb(0x16f),auth,async(_0x2e4e2d,_0x128aba)=>{const _0x543805=a0_0x3e34fb;try{const {date_today:_0x46f4b8,first_month:_0x58ea05,first_year:_0x5a28ff}=_0x2e4e2d[_0x543805(0x14e)],{sttaff_id:_0x2609a8}=_0x2e4e2d[_0x543805(0x17a)],_0x1c3c9e=await product[_0x543805(0x15a)]([{'$group':{'_id':{'brand':_0x543805(0x19b),'category':'$category'},'products':{'$push':{'name':_0x543805(0x1c4),'product_code':_0x543805(0x154)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x255712=[];_0x255712['cat_brand']=[];for(let _0x181133=0x0;_0x181133<=_0x1c3c9e[_0x543805(0x14f)]-0x1;_0x181133++){const _0x17da64=_0x1c3c9e[_0x181133];_0x255712[_0x543805(0x166)]['push'](_0x17da64);}const _0x462c11=await sales_sa[_0x543805(0x15a)]([{'$match':{'date':{'$gte':_0x58ea05,'$lte':_0x46f4b8},'sales_staff_id':_0x2609a8,'sale_product.isFG':_0x543805(0x1a6),'status_data':_0x543805(0x1a6)}},{'$unwind':_0x543805(0x152)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x543805(0x1ad),'localField':_0x543805(0x1ae),'foreignField':_0x543805(0x1c5),'as':'product_info'}},{'$unwind':_0x543805(0x1bb)},{'$group':{'_id':{'category':_0x543805(0x149),'brand':_0x543805(0x14b)},'totalQty':{'$sum':_0x543805(0x167)},'products':{'$push':{'qty':_0x543805(0x167),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0x543805(0x148),'product_details':{'prod_name':_0x543805(0x19a),'product_code':_0x543805(0x1a9),'category':_0x543805(0x149),'brand':_0x543805(0x14b),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x543805(0x1bf)},{'$group':{'_id':{'category':_0x543805(0x15b),'brand':_0x543805(0x1b0)},'totalQty':{'$sum':_0x543805(0x185)},'totalGross':{'$sum':{'$multiply':[_0x543805(0x185),_0x543805(0x1aa)]}},'NetPrice':{'$sum':_0x543805(0x158)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x543805(0x18d)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'category':'$_id.category','brand':'$_id.brand'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x543805(0x1ac)},'NetPrice':{'$sum':_0x543805(0x172)},'discount':{'$sum':_0x543805(0x192)},'adj_discount':{'$sum':_0x543805(0x191)},'products':{'$push':{'qty':_0x543805(0x184),'category':'$_id.category','brand':_0x543805(0x16b),'product_details':_0x543805(0x170)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x1b1ce2=[];_0x1b1ce2[_0x543805(0x160)]={};for(let _0xacaa54=0x0;_0xacaa54<=_0x462c11[_0x543805(0x14f)]-0x1;_0xacaa54++){const _0x17abe4=_0x462c11[_0xacaa54];!_0x1b1ce2[_0x543805(0x160)][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x197)]]&&(_0x1b1ce2[_0x543805(0x160)][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x197)]]={}),!_0x1b1ce2[_0x543805(0x160)][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x197)]][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x1bd)]]&&(_0x1b1ce2[_0x543805(0x160)][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x197)]][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x1bd)]]={}),!_0x1b1ce2[_0x543805(0x160)][_0x17abe4['_id'][_0x543805(0x197)]][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x1bd)]][_0x543805(0x1a0)]&&(_0x1b1ce2[_0x543805(0x160)][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x197)]][_0x17abe4['_id'][_0x543805(0x1bd)]][_0x543805(0x1a0)]=0x0),!_0x1b1ce2['sales_sa_month'][_0x17abe4[_0x543805(0x1b6)]['brand']][_0x17abe4['_id'][_0x543805(0x1bd)]][_0x543805(0x153)]&&(_0x1b1ce2[_0x543805(0x160)][_0x17abe4['_id']['brand']][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x1bd)]][_0x543805(0x153)]=0x0),_0x1b1ce2[_0x543805(0x160)][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x197)]][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x1bd)]]['qty']=_0x17abe4[_0x543805(0x193)],_0x1b1ce2[_0x543805(0x160)][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x197)]][_0x17abe4[_0x543805(0x1b6)][_0x543805(0x1bd)]]['net']=_0x17abe4[_0x543805(0x1be)];}const _0x985b7c=await sales_sa[_0x543805(0x15a)]([{'$match':{'date':{'$gte':_0x5a28ff,'$lte':_0x46f4b8},'sales_staff_id':_0x2609a8,'sale_product.isFG':_0x543805(0x1a6),'status_data':_0x543805(0x1a6)}},{'$unwind':_0x543805(0x152)},{'$match':{'sale_product.isFG':_0x543805(0x1a6)}},{'$lookup':{'from':'products','localField':_0x543805(0x1ae),'foreignField':'product_code','as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'category':_0x543805(0x149),'brand':_0x543805(0x14b)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x543805(0x167),'NetPrice':_0x543805(0x175),'discount':'$sale_product.discount','adj_discount':_0x543805(0x148),'product_details':{'prod_name':'$product_info.name','product_code':_0x543805(0x1a9),'category':_0x543805(0x149),'brand':_0x543805(0x14b),'gross_price':_0x543805(0x1a5)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'category':_0x543805(0x15b),'brand':_0x543805(0x1b0)},'totalQty':{'$sum':_0x543805(0x185)},'totalGross':{'$sum':{'$multiply':[_0x543805(0x185),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x543805(0x158)},'discount':{'$sum':_0x543805(0x187)},'adj_discount':{'$sum':_0x543805(0x18d)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'category':_0x543805(0x177),'brand':'$_id.brand'},'totalQty':{'$sum':_0x543805(0x184)},'totalGross':{'$sum':_0x543805(0x1ac)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x543805(0x191)},'products':{'$push':{'qty':_0x543805(0x184),'category':_0x543805(0x177),'brand':_0x543805(0x16b),'product_details':_0x543805(0x170)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x4beacd=[];_0x4beacd['sales_sa_year']={};for(let _0x398c40=0x0;_0x398c40<=_0x985b7c[_0x543805(0x14f)]-0x1;_0x398c40++){const _0x1cd83f=_0x985b7c[_0x398c40];!_0x4beacd[_0x543805(0x196)][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x197)]]&&(_0x4beacd['sales_sa_year'][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x197)]]={}),!_0x4beacd[_0x543805(0x196)][_0x1cd83f['_id'][_0x543805(0x197)]][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x1bd)]]&&(_0x4beacd['sales_sa_year'][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x197)]][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x1bd)]]={}),!_0x4beacd['sales_sa_year'][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x197)]][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x1bd)]][_0x543805(0x1a0)]&&(_0x4beacd[_0x543805(0x196)][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x197)]][_0x1cd83f[_0x543805(0x1b6)]['category']][_0x543805(0x1a0)]=0x0),!_0x4beacd[_0x543805(0x196)][_0x1cd83f['_id'][_0x543805(0x197)]][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x1bd)]][_0x543805(0x153)]&&(_0x4beacd['sales_sa_year'][_0x1cd83f['_id'][_0x543805(0x197)]][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x1bd)]][_0x543805(0x153)]=0x0),_0x4beacd['sales_sa_year'][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x197)]][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x1bd)]][_0x543805(0x1a0)]=_0x1cd83f[_0x543805(0x193)],_0x4beacd[_0x543805(0x196)][_0x1cd83f['_id']['brand']][_0x1cd83f[_0x543805(0x1b6)][_0x543805(0x1bd)]][_0x543805(0x153)]=_0x1cd83f[_0x543805(0x1be)];}_0x128aba['json']({'product':_0x255712[_0x543805(0x166)],'month_data':_0x1b1ce2[_0x543805(0x160)],'year_data':_0x4beacd['sales_sa_year']});}catch(_0x589579){console[_0x543805(0x19c)](_0x589579);}}),module[a0_0x3e34fb(0x198)]=router;