const a0_0x293a8d=a0_0x2312;function a0_0x2312(_0x79d070,_0xef4661){const _0x40d7d1=a0_0x40d7();return a0_0x2312=function(_0x2312d7,_0x155263){_0x2312d7=_0x2312d7-0xce;let _0x6b356=_0x40d7d1[_0x2312d7];return _0x6b356;},a0_0x2312(_0x79d070,_0xef4661);}(function(_0x5255ad,_0xbe518a){const _0xc33a92=a0_0x2312,_0x94c1f9=_0x5255ad();while(!![]){try{const _0x47d0fd=-parseInt(_0xc33a92(0x131))/0x1+-parseInt(_0xc33a92(0xf7))/0x2*(parseInt(_0xc33a92(0x10f))/0x3)+-parseInt(_0xc33a92(0x134))/0x4*(-parseInt(_0xc33a92(0x129))/0x5)+-parseInt(_0xc33a92(0xf1))/0x6*(parseInt(_0xc33a92(0xd6))/0x7)+parseInt(_0xc33a92(0x107))/0x8*(-parseInt(_0xc33a92(0x124))/0x9)+parseInt(_0xc33a92(0xe5))/0xa*(parseInt(_0xc33a92(0x151))/0xb)+-parseInt(_0xc33a92(0x105))/0xc*(-parseInt(_0xc33a92(0x13b))/0xd);if(_0x47d0fd===_0xbe518a)break;else _0x94c1f9['push'](_0x94c1f9['shift']());}catch(_0x5674a6){_0x94c1f9['push'](_0x94c1f9['shift']());}}}(a0_0x40d7,0x5070a));const express=require('express'),app=express(),router=express[a0_0x293a8d(0x154)](),auth=require(a0_0x293a8d(0x123)),{profile,sales,sales_return,purchases,purchases_return,categories,product,suppliers,customer,master_shop,transfers,adjustment,purchases_finished,sales_finished,adjustment_finished,transfers_finished,staff,sales_sa,sales_order}=require(a0_0x293a8d(0xd5)),users=require(a0_0x293a8d(0x11b));router[a0_0x293a8d(0xd3)]('/index',auth,async(_0x4ab873,_0x997e0c)=>{const _0x21c968=a0_0x293a8d;try{const {username:_0x182d76,email:_0x30403a,role:_0x564953}=_0x4ab873[_0x21c968(0xfa)],_0x84b4c8=_0x4ab873[_0x21c968(0xfa)],_0x231ed7=await master_shop['find'](),_0x3c6ab3=await profile[_0x21c968(0xe2)]({'email':_0x84b4c8[_0x21c968(0x125)]});if(_0x231ed7[0x0][_0x21c968(0x117)]==_0x21c968(0xf8))var _0x17ff8d=users[_0x21c968(0x13f)];else{if(_0x231ed7[0x0]['language']==_0x21c968(0xe9))var _0x17ff8d=users[_0x21c968(0xe9)];else{if(_0x231ed7[0x0]['language']==_0x21c968(0x130))var _0x17ff8d=users[_0x21c968(0x130)];else{if(_0x231ed7[0x0]['language']==_0x21c968(0x103))var _0x17ff8d=users['Spanish'];else{if(_0x231ed7[0x0]['language']==_0x21c968(0x14f))var _0x17ff8d=users[_0x21c968(0x14f)];else{if(_0x231ed7[0x0]['language']==_0x21c968(0x136))var _0x17ff8d=users['Portuguese'];else{if(_0x231ed7[0x0][_0x21c968(0x117)]==_0x21c968(0xf0))var _0x17ff8d=users[_0x21c968(0xf0)];else{if(_0x231ed7[0x0][_0x21c968(0x117)]==_0x21c968(0xeb))var _0x17ff8d=users['Arabic'];}}}}}}}if(_0x84b4c8['account_category']=='wm'){var _0x3ac4e;if(_0x84b4c8['warehouse_category']=='Raw\x20Materials'){const _0x5b78e9=await product[_0x21c968(0x12a)]({'product_category':'Raw\x20Materials'});_0x3ac4e=_0x5b78e9[_0x21c968(0xee)];}else{if(_0x84b4c8[_0x21c968(0x120)]==_0x21c968(0x112)){const _0x40a70b=await product[_0x21c968(0x12a)]({'product_category':_0x21c968(0x112)});_0x3ac4e=_0x40a70b[_0x21c968(0xee)];}else{const _0x454178=await product[_0x21c968(0x12a)]();_0x3ac4e=_0x454178[_0x21c968(0xee)];}}const _0x32bb92=await sales[_0x21c968(0xdf)]([{'$group':{'_id':null,'total_price':{'$sum':_0x21c968(0xd2)}}}]),_0x5cc1f9=await sales[_0x21c968(0xdf)]([{'$unwind':_0x21c968(0x111)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x21c968(0xff)}}}]),_0x51cb0d=await sales_return[_0x21c968(0xdf)]([{'$group':{'_id':null,'total':{'$sum':_0x21c968(0x14d)}}}]),_0xec4106=await sales_return[_0x21c968(0xdf)]([{'$unwind':_0x21c968(0xe0)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$return_sale.sale_qty'}}}]),_0x1ea138=await purchases['aggregate']([{'$group':{'_id':null,'total_amount':{'$sum':_0x21c968(0x14d)}}}]),_0x1a3b04=await purchases_return[_0x21c968(0xdf)]([{'$group':{'_id':null,'total':{'$sum':_0x21c968(0x14d)}}}]),_0x32c653=await purchases_return[_0x21c968(0xdf)]([{'$unwind':_0x21c968(0xf9)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x21c968(0x13c)}}}]),_0x4e4383=await purchases['aggregate']([{'$unwind':'$product'},{'$group':{'_id':null,'totalQuantity':{'$sum':'$product.quantity'}}}]),_0x102199=await purchases['aggregate']([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x130904=await sales[_0x21c968(0xdf)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x375152=await transfers[_0x21c968(0xdf)]([{'$unwind':_0x21c968(0x113)},{'$group':{'_id':_0x21c968(0x13e),'fromWarehouse':{'$first':_0x21c968(0x10b)},'toWareHouse':{'$first':_0x21c968(0x14e)},'FromtotalQuantity':{'$sum':_0x21c968(0x102)},'TototalQuantity':{'$sum':_0x21c968(0x110)}}}]),_0x5ceaae=await categories[_0x21c968(0x12a)](),_0x5c499f=await product[_0x21c968(0x12a)](),_0x14289a=await suppliers['find'](),_0x2a49c5=await customer[_0x21c968(0x12a)]();_0x997e0c['render']('index',{'success':_0x4ab873[_0x21c968(0x144)](_0x21c968(0x139)),'errors':_0x4ab873[_0x21c968(0x144)](_0x21c968(0x128)),'role':_0x84b4c8,'profile':_0x3c6ab3,'sale':_0x32bb92[0x0],'sales_return':_0x51cb0d[0x0],'purchases':_0x1ea138[0x0],'purchases_return':_0x1a3b04[0x0],'purchases_table':_0x102199,'sales_table':_0x130904,'categories':_0x5ceaae[_0x21c968(0xee)],'product':_0x5c499f[_0x21c968(0xee)],'suppliers':_0x14289a[_0x21c968(0xee)],'customer':_0x2a49c5['length'],'master_shop':_0x231ed7,'language':_0x17ff8d,'sale_QTY':_0x5cc1f9[0x0],'purchases_QTY':_0x4e4383[0x0],'sales_return_QTY':_0xec4106[0x0],'purchases_return_QTY':_0x32c653[0x0],'transfer_table':_0x375152,'product_cnt':_0x3ac4e});}else{if(_0x84b4c8[_0x21c968(0xe8)]=='sa'){const _0xc614aa=await staff['findOne']({'email':_0x84b4c8[_0x21c968(0x125)]}),_0xd61e13=await sales_sa[_0x21c968(0x12a)]({'sales_staff_id':_0xc614aa[_0x21c968(0x137)]}),_0x5129cc=await sales_sa[_0x21c968(0x12a)]({'sales_staff_id':_0xc614aa[_0x21c968(0x137)],'paid':'True'}),_0x385715=await sales_sa[_0x21c968(0x12a)]({'sales_staff_id':_0xc614aa[_0x21c968(0x137)],'paid':_0x21c968(0xe4)}),_0x5e0bda=await sales_sa[_0x21c968(0xdf)]([{'$match':{'sales_staff_id':_0xc614aa[_0x21c968(0x137)][_0x21c968(0x108)]()}},{'$unwind':_0x21c968(0x111)},{'$group':{'_id':null,'sumprice':{'$sum':_0x21c968(0xdc)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':[_0x21c968(0x11a),'$count']},0x2]}}}]),_0x300da2=await staff['aggregate']([{'$match':{'email':_0x84b4c8[_0x21c968(0x125)]}},{'$unwind':_0x21c968(0xe6)},{'$group':{'_id':null,'totalQTY':{'$sum':'$product_list.product_stock'}}}]);_0x997e0c['render'](_0x21c968(0xce),{'success':_0x4ab873[_0x21c968(0x144)]('success'),'errors':_0x4ab873['flash'](_0x21c968(0x128)),'role':_0x84b4c8,'profile':_0x3c6ab3,'master_shop':_0x231ed7,'language':_0x17ff8d,'cntPaid':_0x5129cc,'cntNotPaid':_0x385715,'avg_price':_0x5e0bda[0x0],'my_stock':_0x300da2[0x0],'staff_arr':_0xc614aa});}else{if(_0x84b4c8[_0x21c968(0xe8)]=='acc'){const _0x416cc6=await staff[_0x21c968(0xe2)]({'email':_0x84b4c8[_0x21c968(0x125)]});_0x997e0c[_0x21c968(0xe1)](_0x21c968(0x10a),{'success':_0x4ab873[_0x21c968(0x144)](_0x21c968(0x139)),'errors':_0x4ab873[_0x21c968(0x144)](_0x21c968(0x128)),'role':_0x84b4c8,'profile':_0x3c6ab3,'master_shop':_0x231ed7,'language':_0x17ff8d}),_0x997e0c['json'](_0x416cc6);}else{if(_0x84b4c8[_0x21c968(0xe8)]==_0x21c968(0x150)||_0x84b4c8['account_category']=='rsm'||_0x84b4c8[_0x21c968(0xe8)]==_0x21c968(0xdb)){const _0x858565=await staff[_0x21c968(0xe2)]({'email':_0x84b4c8['email']});_0x997e0c['render'](_0x21c968(0x12d),{'success':_0x4ab873[_0x21c968(0x144)](_0x21c968(0x139)),'errors':_0x4ab873['flash'](_0x21c968(0x128)),'role':_0x84b4c8,'profile':_0x3c6ab3,'master_shop':_0x231ed7,'language':_0x17ff8d});}else{var _0x3ac4e;if(_0x84b4c8[_0x21c968(0x120)]==_0x21c968(0x104)){const _0x149e94=await product[_0x21c968(0x12a)]({'product_category':'Raw\x20Materials'});_0x3ac4e=_0x149e94[_0x21c968(0xee)];}else{if(_0x84b4c8[_0x21c968(0x120)]==_0x21c968(0x112)){const _0x42fd46=await product[_0x21c968(0x12a)]({'product_category':'Finished\x20Goods'});_0x3ac4e=_0x42fd46['length'];}else{const _0x48c2a1=await product[_0x21c968(0x12a)]();_0x3ac4e=_0x48c2a1[_0x21c968(0xee)];}}const _0xc554fc=await sales[_0x21c968(0xdf)]([{'$group':{'_id':null,'total_price':{'$sum':_0x21c968(0xd2)}}}]),_0x186ebb=await sales['aggregate']([{'$unwind':'$sale_product'},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x21c968(0xff)}}}]),_0x1bd3f5=await sales_return[_0x21c968(0xdf)]([{'$group':{'_id':null,'total':{'$sum':_0x21c968(0x14d)}}}]),_0x190f2d=await sales_return['aggregate']([{'$unwind':_0x21c968(0xe0)},{'$group':{'_id':null,'totalQuantity':{'$sum':'$return_sale.sale_qty'}}}]),_0x43a37d=await purchases[_0x21c968(0xdf)]([{'$group':{'_id':null,'total_amount':{'$sum':'$total_amount'}}}]),_0x5251a1=await purchases_return[_0x21c968(0xdf)]([{'$group':{'_id':null,'total':{'$sum':_0x21c968(0x14d)}}}]),_0x3c528b=await purchases_return[_0x21c968(0xdf)]([{'$unwind':_0x21c968(0xf9)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x21c968(0x13c)}}}]),_0x5b5425=await purchases[_0x21c968(0xdf)]([{'$unwind':_0x21c968(0x113)},{'$group':{'_id':null,'totalQuantity':{'$sum':_0x21c968(0x142)}}}]),_0x17e75e=await purchases['aggregate']([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x3dc496=await sales[_0x21c968(0xdf)]([{'$sort':{'invoice':-0x1}},{'$limit':0x5},{'$sort':{'invoice':0x1}}]),_0x4b1611=await transfers['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x21c968(0x13e),'fromWarehouse':{'$first':_0x21c968(0x10b)},'toWareHouse':{'$first':_0x21c968(0x14e)},'FromtotalQuantity':{'$sum':_0x21c968(0x102)},'TototalQuantity':{'$sum':_0x21c968(0x110)}}}]),_0x2629f2=await categories['find'](),_0x356610=await product[_0x21c968(0x12a)](),_0x5e9b6b=await suppliers[_0x21c968(0x12a)](),_0x380ec9=await customer[_0x21c968(0x12a)]();_0x997e0c[_0x21c968(0xe1)](_0x21c968(0x143),{'success':_0x4ab873['flash'](_0x21c968(0x139)),'errors':_0x4ab873[_0x21c968(0x144)](_0x21c968(0x128)),'role':_0x84b4c8,'profile':_0x3c6ab3,'sale':_0xc554fc[0x0],'sales_return':_0x1bd3f5[0x0],'purchases':_0x43a37d[0x0],'purchases_return':_0x5251a1[0x0],'purchases_table':_0x17e75e,'sales_table':_0x3dc496,'categories':_0x2629f2[_0x21c968(0xee)],'product':_0x356610['length'],'suppliers':_0x5e9b6b[_0x21c968(0xee)],'customer':_0x380ec9[_0x21c968(0xee)],'master_shop':_0x231ed7,'language':_0x17ff8d,'sale_QTY':_0x186ebb[0x0],'purchases_QTY':_0x5b5425[0x0],'sales_return_QTY':_0x190f2d[0x0],'purchases_return_QTY':_0x3c528b[0x0],'transfer_table':_0x4b1611,'product_cnt':_0x3ac4e});}}}}}catch(_0x5ab42e){console[_0x21c968(0x12b)](_0x5ab42e);}}),router[a0_0x293a8d(0xd3)](a0_0x293a8d(0xe7),auth,async(_0x5326af,_0x1bec19)=>{const _0x3588cc=a0_0x293a8d;try{const _0x445d3e=_0x5326af[_0x3588cc(0xfa)],_0x4c18ac=await staff['findOne']({'email':_0x445d3e['email']}),_0x2f362b=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x4c18ac[_0x3588cc(0x137)]['valueOf'](),'paid':'False'}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0x1bec19[_0x3588cc(0xd7)](_0x2f362b);}catch(_0x5daaa7){_0x1bec19['json'](_0x5daaa7);}}),router[a0_0x293a8d(0xd3)](a0_0x293a8d(0x12c),auth,async(_0x236103,_0x1b986f)=>{const _0x32dfed=a0_0x293a8d;try{const _0x10e17b=_0x236103[_0x32dfed(0xfa)],_0x1e5b30=await staff[_0x32dfed(0xe2)]({'email':_0x10e17b[_0x32dfed(0x125)]}),_0x4feb58=await sales_sa[_0x32dfed(0x12a)]({'sales_staff_id':_0x1e5b30[_0x32dfed(0x137)],'paid':_0x32dfed(0xe4)});_0x1b986f[_0x32dfed(0xd7)](_0x4feb58);}catch(_0x43245e){_0x1b986f[_0x32dfed(0xd7)](_0x43245e);}}),router['post'](a0_0x293a8d(0x133),auth,async(_0x21f482,_0x25c4c7)=>{const _0x424c8a=a0_0x293a8d;try{const {sttaff_id:_0x515c41,warehouse:_0x397ad1,account_category:_0x4cd0b5}=_0x21f482[_0x424c8a(0xfa)],_0x518a68=await sales_order[_0x424c8a(0xdf)]([{'$match':{'accounting_account_id':_0x515c41,'accounting_account_confirm':_0x424c8a(0x119)}}]);_0x25c4c7[_0x424c8a(0xd7)](_0x518a68);}catch(_0x22b96f){}}),router[a0_0x293a8d(0xd3)](a0_0x293a8d(0x13d),auth,async(_0x247195,_0x156271)=>{const _0x5addf4=a0_0x293a8d;try{const _0xd4973c=_0x247195[_0x5addf4(0xfa)],_0x184254=await staff[_0x5addf4(0xe2)]({'email':_0xd4973c[_0x5addf4(0x125)]}),_0x4316f5=await sales_sa[_0x5addf4(0x12a)]({'sales_staff_id':_0x184254[_0x5addf4(0x137)],'paid':_0x5addf4(0xdd)});_0x156271['json'](_0x4316f5);}catch(_0xc4a9b5){_0x156271[_0x5addf4(0xd7)](_0xc4a9b5);}}),router[a0_0x293a8d(0xd3)](a0_0x293a8d(0xf5),auth,async(_0x2b9299,_0xaade65)=>{const _0x22fedb=a0_0x293a8d;try{const _0x2209fc=_0x2b9299[_0x22fedb(0xfa)],_0x4e4a13=await staff['findOne']({'email':_0x2209fc[_0x22fedb(0x125)]}),_0x3886a0=await sales_sa['aggregate']([{'$match':{'sales_staff_id':_0x4e4a13['_id'][_0x22fedb(0x108)](),'paid':_0x22fedb(0xdd)}},{'$limit':0x4},{'$sort':{'invoice':-0x1}}]);_0xaade65[_0x22fedb(0xd7)](_0x3886a0);}catch(_0xddfbe4){_0xaade65['json'](_0xddfbe4);}}),router['post'](a0_0x293a8d(0x14b),auth,async(_0x1aeec4,_0x552367)=>{const _0x5950fe=a0_0x293a8d;try{const {id:_0xdf688,price:_0x37dfcd}=_0x1aeec4[_0x5950fe(0x115)],_0xfa3c7a=await sales_sa[_0x5950fe(0xf3)](_0xdf688);_0xfa3c7a[_0x5950fe(0x106)]='True',_0xfa3c7a['collection_price']=parseFloat(_0x37dfcd);const _0x4b8669=await _0xfa3c7a[_0x5950fe(0xd4)]();_0x552367[_0x5950fe(0xd7)](_0x4b8669);}catch(_0x150a11){_0x552367['json'](_0x150a11);}}),router[a0_0x293a8d(0xd3)]('/pending_data',auth,async(_0x495d63,_0x21a3ba)=>{const _0x4caf9=a0_0x293a8d;try{const _0x188d14=_0x495d63[_0x4caf9(0xfa)],_0xddb5a4=await staff[_0x4caf9(0xe2)]({'email':_0x188d14['email']}),_0x5e2310=await sales_sa[_0x4caf9(0x12a)]({'sales_staff_id':_0xddb5a4[_0x4caf9(0x137)],'paid':_0x4caf9(0xe4)});_0x21a3ba['json'](_0x5e2310);}catch(_0x4e8048){_0x21a3ba[_0x4caf9(0xd7)](_0x4e8048);}}),router[a0_0x293a8d(0xd3)]('/avg_data',auth,async(_0x3af727,_0x26ac3e)=>{const _0x31766d=a0_0x293a8d;try{const _0x1bbf8f=_0x3af727['user'],_0x346f3d=await staff['findOne']({'email':_0x1bbf8f[_0x31766d(0x125)]}),_0x2d4339=await sales_sa[_0x31766d(0xdf)]([{'$match':{'sales_staff_id':_0x346f3d[_0x31766d(0x137)]['valueOf']()}},{'$unwind':_0x31766d(0x111)},{'$group':{'_id':null,'sumprice':{'$sum':_0x31766d(0xdc)},'count':{'$sum':0x1}}},{'$project':{'_id':0x0,'sumprice':0x1,'averageprice':{'$round':[{'$divide':['$sumprice',_0x31766d(0xf2)]},0x2]}}}]);_0x26ac3e[_0x31766d(0xd7)](_0x2d4339);}catch(_0x3d8f15){_0x26ac3e[_0x31766d(0xd7)](_0x3d8f15);}}),router[a0_0x293a8d(0xd3)](a0_0x293a8d(0x109),auth,async(_0xeb6a1a,_0x10b370)=>{const _0x19995d=a0_0x293a8d;try{const _0x4aa898=_0xeb6a1a[_0x19995d(0xfa)],_0x5397bb=await staff[_0x19995d(0xe2)]({'email':_0x4aa898['email']}),_0x15f304=await staff['aggregate']([{'$match':{'email':_0x4aa898[_0x19995d(0x125)]}},{'$unwind':_0x19995d(0xe6)},{'$match':{'product_list.isConfirm':_0x19995d(0x122)}},{'$group':{'_id':null,'totalQTY':{'$sum':'$product_list.product_stock'}}}]);_0x10b370['json'](_0x15f304);}catch(_0x55bc21){_0x10b370[_0x19995d(0xd7)](_0x55bc21);}}),router[a0_0x293a8d(0xd3)]('/sales_chart',auth,async(_0x28d310,_0x59f64d)=>{const _0x29c95c=a0_0x293a8d;try{const _0x5e6ef0=_0x28d310[_0x29c95c(0xfa)],_0x18e734=await staff['findOne']({'email':_0x5e6ef0[_0x29c95c(0x125)]}),_0x25d496=await sales_sa[_0x29c95c(0xdf)]([{'$match':{'sales_staff_id':_0x18e734[_0x29c95c(0x137)]['valueOf']()}},{'$unwind':_0x29c95c(0x111)},{'$group':{'_id':'$date','totalQuantity':{'$sum':_0x29c95c(0xff)},'date':{'$first':_0x29c95c(0x153)}}},{'$sort':{'date':0x1}}]);_0x59f64d['json'](_0x25d496);}catch(_0x590d4e){_0x59f64d[_0x29c95c(0xd7)](_0x590d4e);}}),router[a0_0x293a8d(0xd3)](a0_0x293a8d(0x127),auth,async(_0x5b529d,_0x1e826a)=>{const _0x4517fe=a0_0x293a8d;try{const _0x5d309a=_0x5b529d[_0x4517fe(0xfa)],_0x16020d=await staff['findOne']({'email':_0x5d309a[_0x4517fe(0x125)]}),_0x31a6b6=await sales_sa[_0x4517fe(0xdf)]([{'$match':{'sales_staff_id':_0x16020d[_0x4517fe(0x137)][_0x4517fe(0x108)]()}},{'$unwind':'$sale_product'},{'$group':{'_id':_0x4517fe(0x153),'totalPrice':{'$sum':_0x4517fe(0xde)},'date':{'$first':_0x4517fe(0x153)}}},{'$sort':{'date':0x1}}]);_0x1e826a[_0x4517fe(0xd7)](_0x31a6b6);}catch(_0x97c3d5){_0x1e826a['json'](_0x97c3d5);}}),router[a0_0x293a8d(0x149)](a0_0x293a8d(0x148),auth,async(_0x218136,_0x420d49)=>{const _0x4a6083=a0_0x293a8d;try{const {date_today:_0x744da3,first_month:_0x532a28,first_year:_0x284d9f}=_0x218136['body'],{sttaff_id:_0x444bfb}=_0x218136['user'],_0x1f07ce=await product[_0x4a6083(0xdf)]([{'$group':{'_id':{'brand':_0x4a6083(0xfe),'category':'$category'},'products':{'$push':{'name':_0x4a6083(0xef),'product_code':_0x4a6083(0x10e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x59b886=[];_0x59b886[_0x4a6083(0x14a)]=[];for(let _0x364eec=0x0;_0x364eec<=_0x1f07ce[_0x4a6083(0xee)]-0x1;_0x364eec++){const _0x47f329=_0x1f07ce[_0x364eec];_0x59b886[_0x4a6083(0x14a)][_0x4a6083(0x10c)](_0x47f329);}const _0x42e107=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x532a28,'$lte':_0x744da3},'sales_staff_id':_0x444bfb,'sale_product.isFG':'false','status_data':_0x4a6083(0x119)}},{'$unwind':_0x4a6083(0x111)},{'$match':{'sale_product.isFG':_0x4a6083(0x119)}},{'$lookup':{'from':'products','localField':_0x4a6083(0xfb),'foreignField':'product_code','as':_0x4a6083(0x100)}},{'$unwind':_0x4a6083(0x147)},{'$group':{'_id':{'category':_0x4a6083(0xe3),'brand':_0x4a6083(0x152)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x4a6083(0x12f),'NetPrice':_0x4a6083(0xde),'discount':_0x4a6083(0x118),'adj_discount':_0x4a6083(0xd8),'product_details':{'prod_name':_0x4a6083(0x132),'product_code':_0x4a6083(0x126),'category':_0x4a6083(0xe3),'brand':_0x4a6083(0x152),'gross_price':_0x4a6083(0x140)}}}}},{'$unwind':_0x4a6083(0x121)},{'$group':{'_id':{'category':_0x4a6083(0xd1),'brand':_0x4a6083(0x146)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x4a6083(0x138),_0x4a6083(0x13a)]}},'NetPrice':{'$sum':_0x4a6083(0x11e)},'discount':{'$sum':_0x4a6083(0xf6)},'adj_discount':{'$sum':_0x4a6083(0x11c)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'category':_0x4a6083(0x145),'brand':_0x4a6083(0xcf)},'totalQty':{'$sum':_0x4a6083(0x135)},'totalGross':{'$sum':_0x4a6083(0x14c)},'NetPrice':{'$sum':_0x4a6083(0x114)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x4a6083(0xd0)},'products':{'$push':{'qty':_0x4a6083(0x135),'category':_0x4a6083(0x145),'brand':_0x4a6083(0xcf),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x424dd7=[];_0x424dd7[_0x4a6083(0xea)]={};for(let _0x4d0c8b=0x0;_0x4d0c8b<=_0x42e107[_0x4a6083(0xee)]-0x1;_0x4d0c8b++){const _0x5daac4=_0x42e107[_0x4d0c8b];!_0x424dd7[_0x4a6083(0xea)][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0x10d)]]&&(_0x424dd7[_0x4a6083(0xea)][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0x10d)]]={}),!_0x424dd7['sales_sa_month'][_0x5daac4[_0x4a6083(0x137)]['brand']][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0xd9)]]&&(_0x424dd7[_0x4a6083(0xea)][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0xd9)]]={}),!_0x424dd7[_0x4a6083(0xea)][_0x5daac4['_id']['brand']][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0xd9)]][_0x4a6083(0xfc)]&&(_0x424dd7[_0x4a6083(0xea)][_0x5daac4['_id']['brand']][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0xd9)]][_0x4a6083(0xfc)]=0x0),!_0x424dd7['sales_sa_month'][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0xd9)]][_0x4a6083(0x116)]&&(_0x424dd7['sales_sa_month'][_0x5daac4['_id'][_0x4a6083(0x10d)]][_0x5daac4[_0x4a6083(0x137)]['category']]['net']=0x0),_0x424dd7['sales_sa_month'][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0xd9)]][_0x4a6083(0xfc)]=_0x5daac4[_0x4a6083(0x11d)],_0x424dd7['sales_sa_month'][_0x5daac4[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x5daac4[_0x4a6083(0x137)]['category']][_0x4a6083(0x116)]=_0x5daac4[_0x4a6083(0x11f)];}const _0x2661ce=await sales_sa[_0x4a6083(0xdf)]([{'$match':{'date':{'$gte':_0x284d9f,'$lte':_0x744da3},'sales_staff_id':_0x444bfb,'sale_product.isFG':_0x4a6083(0x119),'status_data':_0x4a6083(0x119)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x4a6083(0x119)}},{'$lookup':{'from':_0x4a6083(0xfd),'localField':_0x4a6083(0xfb),'foreignField':_0x4a6083(0xda),'as':'product_info'}},{'$unwind':_0x4a6083(0x147)},{'$group':{'_id':{'category':_0x4a6083(0xe3),'brand':_0x4a6083(0x152)},'totalQty':{'$sum':_0x4a6083(0x12f)},'products':{'$push':{'qty':_0x4a6083(0x12f),'NetPrice':_0x4a6083(0xde),'discount':'$sale_product.discount','adj_discount':_0x4a6083(0xd8),'product_details':{'prod_name':_0x4a6083(0x132),'product_code':'$product_info.product_code','category':_0x4a6083(0xe3),'brand':_0x4a6083(0x152),'gross_price':_0x4a6083(0x140)}}}}},{'$unwind':_0x4a6083(0x121)},{'$group':{'_id':{'category':'$products.product_details.category','brand':_0x4a6083(0x146)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x4a6083(0x138),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x4a6083(0x11e)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x4a6083(0xf4)}}},{'$group':{'_id':{'category':_0x4a6083(0x145),'brand':'$_id.brand'},'totalQty':{'$sum':_0x4a6083(0x135)},'totalGross':{'$sum':_0x4a6083(0x14c)},'NetPrice':{'$sum':_0x4a6083(0x114)},'discount':{'$sum':_0x4a6083(0x101)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':_0x4a6083(0x145),'brand':_0x4a6083(0xcf),'product_details':_0x4a6083(0xed)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x4d02ad=[];_0x4d02ad[_0x4a6083(0x141)]={};for(let _0x47e3fd=0x0;_0x47e3fd<=_0x2661ce['length']-0x1;_0x47e3fd++){const _0x6376f1=_0x2661ce[_0x47e3fd];!_0x4d02ad[_0x4a6083(0x141)][_0x6376f1[_0x4a6083(0x137)]['brand']]&&(_0x4d02ad['sales_sa_year'][_0x6376f1[_0x4a6083(0x137)][_0x4a6083(0x10d)]]={}),!_0x4d02ad[_0x4a6083(0x141)][_0x6376f1[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x6376f1['_id']['category']]&&(_0x4d02ad[_0x4a6083(0x141)][_0x6376f1[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x6376f1['_id'][_0x4a6083(0xd9)]]={}),!_0x4d02ad[_0x4a6083(0x141)][_0x6376f1['_id'][_0x4a6083(0x10d)]][_0x6376f1[_0x4a6083(0x137)]['category']][_0x4a6083(0xfc)]&&(_0x4d02ad[_0x4a6083(0x141)][_0x6376f1[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x6376f1['_id'][_0x4a6083(0xd9)]][_0x4a6083(0xfc)]=0x0),!_0x4d02ad['sales_sa_year'][_0x6376f1[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x6376f1['_id'][_0x4a6083(0xd9)]][_0x4a6083(0x116)]&&(_0x4d02ad[_0x4a6083(0x141)][_0x6376f1[_0x4a6083(0x137)][_0x4a6083(0x10d)]][_0x6376f1[_0x4a6083(0x137)][_0x4a6083(0xd9)]][_0x4a6083(0x116)]=0x0),_0x4d02ad[_0x4a6083(0x141)][_0x6376f1['_id'][_0x4a6083(0x10d)]][_0x6376f1[_0x4a6083(0x137)][_0x4a6083(0xd9)]]['qty']=_0x6376f1['totalQty'],_0x4d02ad[_0x4a6083(0x141)][_0x6376f1[_0x4a6083(0x137)]['brand']][_0x6376f1['_id'][_0x4a6083(0xd9)]][_0x4a6083(0x116)]=_0x6376f1['NetPrice'];}_0x420d49['json']({'product':_0x59b886[_0x4a6083(0x14a)],'month_data':_0x424dd7[_0x4a6083(0xea)],'year_data':_0x4d02ad[_0x4a6083(0x141)]});}catch(_0x5bcccd){console[_0x4a6083(0x12b)](_0x5bcccd);}}),router[a0_0x293a8d(0x149)](a0_0x293a8d(0x12e),auth,async(_0x38fedf,_0x567ca0)=>{const _0x12af25=a0_0x293a8d;try{const {date_today:_0x230ec9,first_month:_0x2d5567,first_year:_0x349334}=_0x38fedf[_0x12af25(0x115)],{sttaff_id:_0x4f2b6f}=_0x38fedf[_0x12af25(0xfa)],_0x4b3879=await product[_0x12af25(0xdf)]([{'$group':{'_id':{'brand':_0x12af25(0xfe),'category':_0x12af25(0xec)},'products':{'$push':{'name':'$name','product_code':_0x12af25(0x10e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1c1ef1=[];_0x1c1ef1[_0x12af25(0x14a)]=[];for(let _0x266c1d=0x0;_0x266c1d<=_0x4b3879[_0x12af25(0xee)]-0x1;_0x266c1d++){const _0xe9df48=_0x4b3879[_0x266c1d];_0x1c1ef1[_0x12af25(0x14a)][_0x12af25(0x10c)](_0xe9df48);}const _0x409c71=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x2d5567,'$lte':_0x230ec9},'sale_product.isFG':_0x12af25(0x119),'status_data':_0x12af25(0x119)}},{'$unwind':_0x12af25(0x111)},{'$match':{'sale_product.isFG':_0x12af25(0x119)}},{'$lookup':{'from':_0x12af25(0xfd),'localField':'sale_product.product_code','foreignField':_0x12af25(0xda),'as':_0x12af25(0x100)}},{'$unwind':_0x12af25(0x147)},{'$group':{'_id':{'category':_0x12af25(0xe3),'brand':_0x12af25(0x152)},'totalQty':{'$sum':_0x12af25(0x12f)},'products':{'$push':{'qty':_0x12af25(0x12f),'NetPrice':_0x12af25(0xde),'discount':_0x12af25(0x118),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':_0x12af25(0x126),'category':_0x12af25(0xe3),'brand':'$product_info.brand','gross_price':_0x12af25(0x140)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'category':'$products.product_details.category','brand':_0x12af25(0x146)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x12af25(0x138),_0x12af25(0x13a)]}},'NetPrice':{'$sum':_0x12af25(0x11e)},'discount':{'$sum':_0x12af25(0xf6)},'adj_discount':{'$sum':_0x12af25(0x11c)},'product_details':{'$first':_0x12af25(0xf4)}}},{'$group':{'_id':{'category':_0x12af25(0x145),'brand':'$_id.brand'},'totalQty':{'$sum':_0x12af25(0x135)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x12af25(0x114)},'discount':{'$sum':_0x12af25(0x101)},'adj_discount':{'$sum':_0x12af25(0xd0)},'products':{'$push':{'qty':_0x12af25(0x135),'category':'$_id.category','brand':_0x12af25(0xcf),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x4c616b=[];_0x4c616b[_0x12af25(0xea)]={};for(let _0x4baef9=0x0;_0x4baef9<=_0x409c71[_0x12af25(0xee)]-0x1;_0x4baef9++){const _0x10aa3c=_0x409c71[_0x4baef9];!_0x4c616b[_0x12af25(0xea)][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0x10d)]]&&(_0x4c616b['sales_sa_month'][_0x10aa3c[_0x12af25(0x137)]['brand']]={}),!_0x4c616b[_0x12af25(0xea)][_0x10aa3c[_0x12af25(0x137)]['brand']][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0xd9)]]&&(_0x4c616b[_0x12af25(0xea)][_0x10aa3c['_id']['brand']][_0x10aa3c[_0x12af25(0x137)]['category']]={}),!_0x4c616b['sales_sa_month'][_0x10aa3c[_0x12af25(0x137)]['brand']][_0x10aa3c['_id'][_0x12af25(0xd9)]][_0x12af25(0xfc)]&&(_0x4c616b[_0x12af25(0xea)][_0x10aa3c['_id'][_0x12af25(0x10d)]][_0x10aa3c[_0x12af25(0x137)]['category']][_0x12af25(0xfc)]=0x0),!_0x4c616b['sales_sa_month'][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0xd9)]]['net']&&(_0x4c616b['sales_sa_month'][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0xd9)]][_0x12af25(0x116)]=0x0),_0x4c616b[_0x12af25(0xea)][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0xd9)]][_0x12af25(0xfc)]=_0x10aa3c[_0x12af25(0x11d)],_0x4c616b[_0x12af25(0xea)][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x10aa3c[_0x12af25(0x137)][_0x12af25(0xd9)]][_0x12af25(0x116)]=_0x10aa3c[_0x12af25(0x11f)];}const _0x1f0951=await sales_sa[_0x12af25(0xdf)]([{'$match':{'date':{'$gte':_0x349334,'$lte':_0x230ec9},'sale_product.isFG':_0x12af25(0x119),'status_data':'false'}},{'$unwind':_0x12af25(0x111)},{'$match':{'sale_product.isFG':_0x12af25(0x119)}},{'$lookup':{'from':_0x12af25(0xfd),'localField':'sale_product.product_code','foreignField':_0x12af25(0xda),'as':_0x12af25(0x100)}},{'$unwind':'$product_info'},{'$group':{'_id':{'category':_0x12af25(0xe3),'brand':_0x12af25(0x152)},'totalQty':{'$sum':_0x12af25(0x12f)},'products':{'$push':{'qty':_0x12af25(0x12f),'NetPrice':_0x12af25(0xde),'discount':'$sale_product.discount','adj_discount':_0x12af25(0xd8),'product_details':{'prod_name':_0x12af25(0x132),'product_code':_0x12af25(0x126),'category':_0x12af25(0xe3),'brand':_0x12af25(0x152),'gross_price':_0x12af25(0x140)}}}}},{'$unwind':_0x12af25(0x121)},{'$group':{'_id':{'category':_0x12af25(0xd1),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x12af25(0x138)},'totalGross':{'$sum':{'$multiply':[_0x12af25(0x138),_0x12af25(0x13a)]}},'NetPrice':{'$sum':_0x12af25(0x11e)},'discount':{'$sum':_0x12af25(0xf6)},'adj_discount':{'$sum':_0x12af25(0x11c)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'category':'$_id.category','brand':_0x12af25(0xcf)},'totalQty':{'$sum':_0x12af25(0x135)},'totalGross':{'$sum':_0x12af25(0x14c)},'NetPrice':{'$sum':_0x12af25(0x114)},'discount':{'$sum':_0x12af25(0x101)},'adj_discount':{'$sum':_0x12af25(0xd0)},'products':{'$push':{'qty':_0x12af25(0x135),'category':'$_id.category','brand':_0x12af25(0xcf),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);var _0x215467=[];_0x215467[_0x12af25(0x141)]={};for(let _0x5e75b0=0x0;_0x5e75b0<=_0x1f0951[_0x12af25(0xee)]-0x1;_0x5e75b0++){const _0x3ea64c=_0x1f0951[_0x5e75b0];!_0x215467[_0x12af25(0x141)][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0x10d)]]&&(_0x215467[_0x12af25(0x141)][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0x10d)]]={}),!_0x215467[_0x12af25(0x141)][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0xd9)]]&&(_0x215467['sales_sa_year'][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x3ea64c['_id'][_0x12af25(0xd9)]]={}),!_0x215467[_0x12af25(0x141)][_0x3ea64c['_id'][_0x12af25(0x10d)]][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0xd9)]][_0x12af25(0xfc)]&&(_0x215467['sales_sa_year'][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0xd9)]][_0x12af25(0xfc)]=0x0),!_0x215467[_0x12af25(0x141)][_0x3ea64c[_0x12af25(0x137)]['brand']][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0xd9)]][_0x12af25(0x116)]&&(_0x215467[_0x12af25(0x141)][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x3ea64c[_0x12af25(0x137)]['category']][_0x12af25(0x116)]=0x0),_0x215467[_0x12af25(0x141)][_0x3ea64c[_0x12af25(0x137)]['brand']][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0xd9)]][_0x12af25(0xfc)]=_0x3ea64c['totalQty'],_0x215467[_0x12af25(0x141)][_0x3ea64c[_0x12af25(0x137)][_0x12af25(0x10d)]][_0x3ea64c['_id'][_0x12af25(0xd9)]][_0x12af25(0x116)]=_0x3ea64c[_0x12af25(0x11f)];}_0x567ca0[_0x12af25(0xd7)]({'product':_0x1c1ef1[_0x12af25(0x14a)],'month_data':_0x4c616b[_0x12af25(0xea)],'year_data':_0x215467[_0x12af25(0x141)]});}catch(_0x1cb28d){console[_0x12af25(0x12b)](_0x1cb28d);}}),module['exports']=router;function a0_0x40d7(){const _0x2a905b=['62NGyHUc','English\x20(US)','$return_product','user','sale_product.product_code','qty','products','$brand','$sale_product.quantity','product_info','$discount','$product.from_quantity','Spanish','Raw\x20Materials','7557612NOruni','paid','8zWUHxB','valueOf','/my_inv','index_acc','$from_warehouse','push','brand','$product_code','6276HIcxAw','$product.to_quantity','$sale_product','Finished\x20Goods','$product','$NetPrice','body','net','language','$sale_product.discount','false','$sumprice','../public/language/languages.json','$products.adj_discount','totalQty','$products.NetPrice','NetPrice','warehouse_category','$products','true','../middleware/auth','5273784roluMl','email','$product_info.product_code','/price_chart','errors','70yKJnxp','find','log','/pending_data','index_asd','/sales_data__admin_dashboard','$sale_product.real_qty_unit_val','German','187239BaCgOt','$product_info.name','/get_count','132964qcSQrN','$totalQty','Portuguese\x20(BR)','_id','$products.qty','success','$products.product_details.gross_price','13DTswOJ','$return_product.return_qty','/paid_data_table','$product.product_name','English','$product_info.gross_price','sales_sa_year','$product.quantity','index','flash','$_id.category','$products.product_details.brand','$product_info','/sales_data_dashboard','post','cat_brand','/update_data','$totalGross','$total_amount','$to_warehouse','French','sad','7238lnjMzl','$product_info.brand','$date','Router','index_sa','$_id.brand','$adj_discount','$products.product_details.category','$total_price','get','save','../models/all_models','7nGNZKE','json','$sale_product.adj_discount','category','product_code','fss','$sale_product.price','True','$sale_product.totalprice','aggregate','$return_sale','render','findOne','$product_info.category','False','1740NZPcLt','$product_list','/pending_data_table','account_category','Hindi','sales_sa_month','Arabic\x20(ae)','$category','$product_details','length','$name','Chinese','252708KyrfVn','$count','findById','$products.product_details','/paid_data','$products.discount'];a0_0x40d7=function(){return _0x2a905b;};return a0_0x40d7();}