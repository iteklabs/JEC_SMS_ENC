var a0_0x4f4a8f=a0_0x3c69;(function(_0x31cbd3,_0x2b5f54){var _0x570506=a0_0x3c69,_0x35617c=_0x31cbd3();while(!![]){try{var _0x106927=parseInt(_0x570506(0xcf))/0x1*(-parseInt(_0x570506(0xd7))/0x2)+parseInt(_0x570506(0x14e))/0x3*(-parseInt(_0x570506(0x144))/0x4)+-parseInt(_0x570506(0xe4))/0x5+parseInt(_0x570506(0x110))/0x6*(parseInt(_0x570506(0xf6))/0x7)+-parseInt(_0x570506(0x13e))/0x8*(parseInt(_0x570506(0x13f))/0x9)+-parseInt(_0x570506(0xc3))/0xa+parseInt(_0x570506(0x141))/0xb*(parseInt(_0x570506(0xbe))/0xc);if(_0x106927===_0x2b5f54)break;else _0x35617c['push'](_0x35617c['shift']());}catch(_0x5be57d){_0x35617c['push'](_0x35617c['shift']());}}}(a0_0x1210,0x2ccb8));const express=require(a0_0x4f4a8f(0x139)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x4f4a8f(0xb8)),auth=require(a0_0x4f4a8f(0xbb)),users=require(a0_0x4f4a8f(0x118)),excelJS=require('exceljs'),xlsx=require(a0_0x4f4a8f(0x112)),mongoose=require(a0_0x4f4a8f(0xda)),{ObjectId}=require(a0_0x4f4a8f(0xb0)),nodemailer=require(a0_0x4f4a8f(0x108));function a0_0x3c69(_0x452b79,_0x44d88b){var _0x12103a=a0_0x1210();return a0_0x3c69=function(_0x3c6978,_0x18848b){_0x3c6978=_0x3c6978-0xab;var _0x1d365d=_0x12103a[_0x3c6978];return _0x1d365d;},a0_0x3c69(_0x452b79,_0x44d88b);}function a0_0x1210(){var _0x3b0566=['document_number_out','../public/language/languages.json','redirect','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Email\x20sent\x20successfully','/upload/','Hindi','back','exports','expiry_date','json','stock','secondary_unit','length','/../public','flash','wms_account_date','German','Chinese','maxperunit','get','Portuguese','/data/data_loc','invoice_init','warehouse_approval_All','</thead>','filter','outgoing_id','<br><br><br>','Email\x20for\x20Customer','</div>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','data_loc','<tr>','express','find','Arabic','padStart','Types','296FZvOkj','7209gnmzpF','$product_details','34111JQOMil','port','split','30796RdjZaX','OUT-','product_code','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','date_data','</td>','<strong>\x20Regards\x20</strong>','<h5>\x20JEC\x20SMS\x20</h5>','product_details','gross_price','39StLsBS','_id','<span>\x20Request\x20ID:\x20<b>','email','English','warehouse_detl','</tr>','primary_code','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','id_transaction_from','qty','mongodb','language','abs','wms_account_id','prod_cat','French','forEach','staffs','../models/all_models','uuid','$_id','../middleware/auth','image','room','3060BSYZrE','request_qty','christian.villamer@jakagroup.com','$room','</b></span>\x20<br><br>','2679540jUwGof','sale_product','save','sendMail','/data/All','Portuguese\x20(BR)','<hr\x20class=\x22my-3\x22>','quantity','password','Arabic\x20(ae)','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','view_accounting_approval','211CLnTlg','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','render','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','logo','prod_id','success','1902JaWUvX','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.product_stock','mongoose','string','/:id','post','bay','$wms_data','</table>','params','batch_code','$product_details.bay','360425pJExCM','maxPerUnit','toLocaleDateString','/data/data_rack','level','errors','findById','product_stock','wms_data','</tbody>','<span>\x20Request\x20Date:\x20<b>','$accounting_account_id','<html><head><title></title>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','invoice','aggregate','protocol','unit','7kplzPx','accounting_account_id','outgoing_invoice','$product_details.product_code','English\x20(US)','push','False','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','map','Logo.png','ObjectId','</head><body>','<h2>\x20JEC\x20SMS\x20</h2>','findOne','$product_details.level','account_data','production_date','$wms_account_id','nodemailer','<div>','Spanish','secondary_code','/all_sales_finished/preview/','log','host','body','378894buwJlW','toString','xlsx','user','warehouse_approval','$product_details._id','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>'];a0_0x1210=function(){return _0x3b0566;};return a0_0x1210();}router['get'](a0_0x4f4a8f(0xdc),auth,async(_0x330e8c,_0x4d24dd)=>{var _0x3df802=a0_0x4f4a8f;try{const _0x430d2b=await master_shop[_0x3df802(0x13a)](),_0x1d3fad=_0x330e8c[_0x3df802(0x113)],_0x5b35e8=await profile['findOne']({'email':_0x1d3fad[_0x3df802(0x151)]}),_0x47127c=await staff['findOne']({'email':_0x1d3fad['email']}),_0x587203=await customer[_0x3df802(0x13a)]({'agent_id':_0x47127c[_0x3df802(0x14f)]}),_0x21f6da=mongoose[_0x3df802(0x13d)][_0x3df802(0x100)],_0x12f304=_0x330e8c[_0x3df802(0xe1)]['id'],_0x558eaa=await sales_order[_0x3df802(0xea)](_0x12f304),_0x5c884f=await sales_order[_0x3df802(0xf3)]([{'$match':{'_id':_0x21f6da(_0x12f304)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x3df802(0xef)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x3df802(0x107)}}},{'$lookup':{'from':_0x3df802(0xb7),'localField':_0x3df802(0xf7),'foreignField':_0x3df802(0x14f),'as':_0x3df802(0x105)}},{'$unwind':'$account_data'},{'$lookup':{'from':_0x3df802(0xb7),'localField':_0x3df802(0xb3),'foreignField':_0x3df802(0x14f),'as':_0x3df802(0xec)}},{'$unwind':_0x3df802(0xdf)}]);if(_0x430d2b[0x0][_0x3df802(0xb1)]=='English\x20(US)')var _0x4a34da=users[_0x3df802(0x152)];else{if(_0x430d2b[0x0][_0x3df802(0xb1)]==_0x3df802(0x11d))var _0x4a34da=users['Hindi'];else{if(_0x430d2b[0x0][_0x3df802(0xb1)]=='German')var _0x4a34da=users[_0x3df802(0x128)];else{if(_0x430d2b[0x0]['language']=='Spanish')var _0x4a34da=users[_0x3df802(0x10a)];else{if(_0x430d2b[0x0][_0x3df802(0xb1)]==_0x3df802(0xb5))var _0x4a34da=users['French'];else{if(_0x430d2b[0x0]['language']==_0x3df802(0xc8))var _0x4a34da=users[_0x3df802(0x12c)];else{if(_0x430d2b[0x0][_0x3df802(0xb1)]==_0x3df802(0x129))var _0x4a34da=users[_0x3df802(0x129)];else{if(_0x430d2b[0x0]['language']==_0x3df802(0xcc))var _0x4a34da=users[_0x3df802(0x13b)];}}}}}}}_0x4d24dd[_0x3df802(0xd1)](_0x3df802(0x114),{'success':_0x330e8c[_0x3df802(0x126)](_0x3df802(0xd6)),'errors':_0x330e8c[_0x3df802(0x126)](_0x3df802(0xe9)),'master_shop':_0x430d2b,'profile':_0x5b35e8,'role':_0x1d3fad,'language':_0x4a34da,'customer':_0x587203,'sales_sa':_0x558eaa,'approvers':_0x5c884f[0x0],'the_id':_0x12f304});}catch(_0x1d159a){console[_0x3df802(0x10d)](_0x1d159a);}}),router[a0_0x4f4a8f(0xdd)](a0_0x4f4a8f(0xdc),auth,async(_0x1ac5ce,_0x251c89)=>{var _0xb3f6c0=a0_0x4f4a8f;try{const {date:_0x3b56c5,invoice_data:_0x2e9ccd,wms_confirm:_0x33d6cc,the_id_val:_0x2ed0e5,prod_id:_0x1f3ee2,SCRN:_0x43549b,ReqBy:_0x45f039,dateofreq:_0x5404b3,PO_number:_0x23e443,warehouse_name:_0x5034a3,typeservicesData:_0x211804,typevehicle:_0x1782b8,destination:_0x5f1ea5,deliverydate:_0x147763,driver:_0xdd8b22,plate:_0x274919,van:_0x311725,DRSI:_0x1885c9,TSU:_0x473abc,TFU:_0x546dae,note:_0x203947}=_0x1ac5ce['body'],_0x15d61c=await sales_order[_0xb3f6c0(0xea)](_0x2ed0e5);if(typeof _0x1f3ee2==_0xb3f6c0(0xdb))var _0x5c6f70=[_0x1ac5ce[_0xb3f6c0(0x10f)]['prod_id']],_0x418d80=[_0x1ac5ce[_0xb3f6c0(0x10f)][_0xb3f6c0(0xaf)]],_0x8e6e5d=[_0x1ac5ce['body']['data_loc']];else var _0x5c6f70=[..._0x1ac5ce['body'][_0xb3f6c0(0xd5)]],_0x418d80=[..._0x1ac5ce[_0xb3f6c0(0x10f)]['qty']],_0x8e6e5d=[..._0x1ac5ce[_0xb3f6c0(0x10f)][_0xb3f6c0(0x137)]];const _0x3364c5=_0x5c6f70['map'](_0x2584d2=>{return _0x2584d2={'prod_id':_0x2584d2};});_0x8e6e5d[_0xb3f6c0(0xb6)]((_0x656207,_0x3e1889)=>{var _0x4a6ceb=_0xb3f6c0,_0x2324a6=_0x656207[_0x4a6ceb(0x143)]('~');_0x3364c5[_0x3e1889]['warehouse_id']=_0x2324a6[0x0],_0x3364c5[_0x3e1889][_0x4a6ceb(0x153)]=_0x2324a6[0x1];}),_0x418d80[_0xb3f6c0(0xb6)]((_0x132be4,_0x2dbbbe)=>{var _0x566c53=_0xb3f6c0;_0x3364c5[_0x2dbbbe][_0x566c53(0xbf)]=_0x132be4;});var _0x1db2dc=[],_0x5c2f4e=[],_0x43ef12=[],_0x1e9287=[],_0x6eaa2f=[],_0x5f3888=[],_0xd8cbff=[],_0x3c1519=[],_0x16eec9=[],_0x1f8981=[],_0xa6cd36=[],_0x540549=[],_0xda4f49=[],_0x4a5265=[],_0x3a3d4b=[],_0x14f7a6=[],_0x3fa4cf=[],_0x30d35f=[],_0x1290a7=[],_0x246462=[];for(let _0x2b52b1=0x0;_0x2b52b1<=_0x3364c5['length']-0x1;_0x2b52b1++){const _0x364739=_0x3364c5[_0x2b52b1],_0x7cad37=mongoose[_0xb3f6c0(0x13d)][_0xb3f6c0(0x100)];var _0x2133a4=await warehouse[_0xb3f6c0(0xf3)]([{'$match':{'_id':_0x7cad37(_0x364739['warehouse_id'])}},{'$unwind':_0xb3f6c0(0x140)},{'$match':{'product_details._id':_0x7cad37(_0x364739[_0xb3f6c0(0x153)])}}]),_0x30389f=0x0;for(let _0xbd4924=0x0;_0xbd4924<=_0x2133a4[_0xb3f6c0(0x124)]-0x1;_0xbd4924++){var _0x5b61d1=_0x2133a4[_0xbd4924];_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0xeb)]<_0x364739[_0xb3f6c0(0xbf)]&&_0x30389f++;}if(_0x30389f>0x0)return _0x1ac5ce[_0xb3f6c0(0x126)](_0xb3f6c0(0xe9),_0xb3f6c0(0xf1)),_0x251c89[_0xb3f6c0(0x119)](_0xb3f6c0(0x11e));var _0x2efbca=0x0;for(let _0x164a1a=0x0;_0x164a1a<=_0x2133a4[_0xb3f6c0(0x124)]-0x1;_0x164a1a++){var _0x5b61d1=_0x2133a4[_0x164a1a];_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0xeb)]>_0x364739[_0xb3f6c0(0xbf)]&&(_0x1db2dc[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)]['product_name']),_0x5c2f4e['push'](_0x5b61d1[_0xb3f6c0(0x14c)]['product_stock']),_0x43ef12['push'](_0x364739[_0xb3f6c0(0xbf)]),_0x1e9287[_0xb3f6c0(0xfb)](_0x5b61d1['product_details'][_0xb3f6c0(0xac)]),_0x6eaa2f[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0x10b)]),_0x5f3888[_0xb3f6c0(0xfb)](_0x5b61d1['product_details'][_0xb3f6c0(0x146)]),_0xd8cbff[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)]['level']),_0x3c1519[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0xde)]),_0x16eec9[_0xb3f6c0(0xfb)](_0x5b61d1['product_details'][_0xb3f6c0(0xf5)]),_0x1f8981[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0x123)]),_0xa6cd36[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0xe2)]),_0x540549[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0x120)]),_0xda4f49[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0x106)]),_0x4a5265[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0xe5)]),_0x3a3d4b[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)]['product_cat']),_0x14f7a6[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0xbd)]),_0x3fa4cf['push'](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0xf2)]),_0x30d35f['push'](_0x5b61d1[_0xb3f6c0(0x14c)]['_id']),_0x1290a7[_0xb3f6c0(0xfb)](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0xb9)]),_0x246462['push'](_0x5b61d1[_0xb3f6c0(0x14c)][_0xb3f6c0(0x14d)]),_0x2efbca++);}}const _0x5b9b25=_0x1db2dc[_0xb3f6c0(0xfe)](_0x754d01=>{return _0x754d01={'product_name':_0x754d01};});_0x5c2f4e[_0xb3f6c0(0xb6)]((_0x2bf969,_0x59f9ec)=>{var _0x270f24=_0xb3f6c0;_0x5b9b25[_0x59f9ec][_0x270f24(0x122)]=_0x2bf969;}),_0x43ef12[_0xb3f6c0(0xb6)]((_0x30c0d8,_0x4a3655)=>{var _0x13ea71=_0xb3f6c0;_0x5b9b25[_0x4a3655][_0x13ea71(0xca)]=Math[_0x13ea71(0xb2)](_0x30c0d8);}),_0x246462[_0xb3f6c0(0xb6)]((_0x396512,_0x5c3f19)=>{var _0x4e27dd=_0xb3f6c0;_0x5b9b25[_0x5c3f19][_0x4e27dd(0x14d)]=_0x396512;}),_0x1290a7[_0xb3f6c0(0xb6)]((_0x91f7c,_0xbc4dfa)=>{var _0x2a1c9b=_0xb3f6c0;_0x5b9b25[_0xbc4dfa][_0x2a1c9b(0xb9)]=_0x91f7c;}),_0x30d35f['forEach']((_0x5d1ccc,_0x4f186a)=>{var _0x3e57c4=_0xb3f6c0;_0x5b9b25[_0x4f186a][_0x3e57c4(0xae)]=_0x5d1ccc;}),_0x1e9287[_0xb3f6c0(0xb6)]((_0x4501db,_0x199f5a)=>{var _0x166c02=_0xb3f6c0;_0x5b9b25[_0x199f5a][_0x166c02(0xac)]=_0x4501db;}),_0x6eaa2f['forEach']((_0xfe457e,_0x2c84d7)=>{var _0x2fa13e=_0xb3f6c0;_0x5b9b25[_0x2c84d7][_0x2fa13e(0x10b)]=_0xfe457e;}),_0x5f3888[_0xb3f6c0(0xb6)]((_0x35a059,_0x2cd6ed)=>{var _0x812b4e=_0xb3f6c0;_0x5b9b25[_0x2cd6ed][_0x812b4e(0x146)]=_0x35a059;}),_0xd8cbff[_0xb3f6c0(0xb6)]((_0x2adca2,_0x4731cc)=>{var _0x4b58c6=_0xb3f6c0;_0x5b9b25[_0x4731cc][_0x4b58c6(0xe8)]=_0x2adca2;}),_0x3c1519[_0xb3f6c0(0xb6)]((_0x11a391,_0x19e591)=>{var _0x10c859=_0xb3f6c0;_0x5b9b25[_0x19e591][_0x10c859(0xde)]=_0x11a391;}),_0x16eec9[_0xb3f6c0(0xb6)]((_0x60160c,_0x383fb6)=>{var _0x42330c=_0xb3f6c0;_0x5b9b25[_0x383fb6][_0x42330c(0xf5)]=_0x60160c;}),_0x1f8981[_0xb3f6c0(0xb6)]((_0x2154e1,_0x4092e4)=>{var _0x329015=_0xb3f6c0;_0x5b9b25[_0x4092e4][_0x329015(0x123)]=_0x2154e1;}),_0xa6cd36[_0xb3f6c0(0xb6)]((_0x496e04,_0x5752a3)=>{var _0x21c08a=_0xb3f6c0;_0x5b9b25[_0x5752a3][_0x21c08a(0xe2)]=_0x496e04;}),_0x540549['forEach']((_0x2c8183,_0x5e6111)=>{var _0x278bed=_0xb3f6c0;_0x5b9b25[_0x5e6111][_0x278bed(0x120)]=_0x2c8183;}),_0xda4f49[_0xb3f6c0(0xb6)]((_0x219837,_0x59ea1b)=>{var _0x3ed37d=_0xb3f6c0;_0x5b9b25[_0x59ea1b][_0x3ed37d(0x106)]=_0x219837;}),_0x4a5265[_0xb3f6c0(0xb6)]((_0x216004,_0x1b8aee)=>{var _0x356834=_0xb3f6c0;_0x5b9b25[_0x1b8aee][_0x356834(0x12a)]=_0x216004;}),_0x3a3d4b[_0xb3f6c0(0xb6)]((_0x3cfb55,_0x502173)=>{var _0x5b98cd=_0xb3f6c0;_0x5b9b25[_0x502173][_0x5b98cd(0xb4)]=_0x3cfb55;}),_0x14f7a6[_0xb3f6c0(0xb6)]((_0x53971d,_0xf3c7bf)=>{_0x5b9b25[_0xf3c7bf]['room_name']=_0x53971d;}),_0x3fa4cf[_0xb3f6c0(0xb6)]((_0x2135f8,_0x32c9ae)=>{var _0x1dfdca=_0xb3f6c0;_0x5b9b25[_0x32c9ae][_0x1dfdca(0xf2)]=_0x2135f8,_0x5b9b25[_0x32c9ae][_0x1dfdca(0x148)]=_0x3b56c5;});const _0x167019=new invoice_for_outgoing();await _0x167019['save'](),_0x3fa4cf[_0xb3f6c0(0xb6)]((_0x26b882,_0x26e2a4)=>{var _0x56057f=_0xb3f6c0;_0x5b9b25[_0x26e2a4][_0x56057f(0xf8)]=_0x56057f(0x145)+_0x167019[_0x56057f(0x12e)][_0x56057f(0x111)]()[_0x56057f(0x13c)](0x8,'0');});const _0x3bebfd=_0x5b9b25[_0xb3f6c0(0x131)](_0x16ce72=>_0x16ce72[_0xb3f6c0(0xca)]!=='0'&&_0x16ce72[_0xb3f6c0(0xca)]!==''),_0xcffa25=new sales_finished({'invoice':_0xb3f6c0(0x145)+_0x167019[_0xb3f6c0(0x12e)]['toString']()[_0xb3f6c0(0x13c)](0x8,'0'),'date':_0x3b56c5,'warehouse_name':_0x5034a3,'sale_product':_0x3bebfd,'note':_0x203947,'SCRN':_0x43549b,'finalize':_0xb3f6c0(0xfc),'ReqBy':_0x45f039,'dateofreq':_0x5404b3,'PO_number':_0x23e443,'typeservicesData':_0x211804,'typevehicle':_0x1782b8,'destination':_0x5f1ea5,'deliverydate':_0x147763,'driver':_0xdd8b22,'plate':_0x274919,'van':_0x311725,'DRSI':_0x1885c9,'TSU':_0x473abc,'TFU':_0x546dae}),_0xd1a027=await _0xcffa25[_0xb3f6c0(0xc5)](),_0x289cda=new Date(),_0x3272b2=_0x289cda[_0xb3f6c0(0xe6)]();_0x15d61c['wms_account_confirm']=_0x33d6cc,_0x15d61c[_0xb3f6c0(0x127)]=_0x3272b2,_0x15d61c[_0xb3f6c0(0x117)]=_0xb3f6c0(0x145)+_0x167019[_0xb3f6c0(0x12e)]['toString']()[_0xb3f6c0(0x13c)](0x8,'0'),_0x15d61c[_0xb3f6c0(0x132)]=_0xd1a027['_id'],await _0x15d61c[_0xb3f6c0(0xc5)]();const _0x122e71=await master_shop['find'](),_0x1ecbac=await email_settings[_0xb3f6c0(0x103)]();let _0x5486c3=nodemailer['createTransport']({'host':_0x1ecbac[_0xb3f6c0(0x10e)],'port':Number(_0x1ecbac[_0xb3f6c0(0x142)]),'secure':![],'auth':{'user':_0x1ecbac[_0xb3f6c0(0x151)],'pass':_0x1ecbac[_0xb3f6c0(0xcb)]}});const _0x1c1721=_0x1ac5ce[_0xb3f6c0(0xf4)]+'://'+_0x1ac5ce['headers'][_0xb3f6c0(0x10e)];var _0x35ccae=_0x15d61c[_0xb3f6c0(0xc4)],_0x31147c='',_0x17754c,_0x4654ad=0x0;for(_0x17754c in _0x35ccae){_0x31147c+=_0xb3f6c0(0x138)+_0xb3f6c0(0xd8)+_0x35ccae[_0x17754c]['product_name']+_0xb3f6c0(0x149)+_0xb3f6c0(0xd8)+_0x35ccae[_0x17754c][_0xb3f6c0(0x146)]+_0xb3f6c0(0x149)+_0xb3f6c0(0xd8)+_0x35ccae[_0x17754c][_0xb3f6c0(0xca)]+_0xb3f6c0(0x149)+_0xb3f6c0(0xd8)+_0x35ccae[_0x17754c][_0xb3f6c0(0xf5)]+_0xb3f6c0(0x149)+_0xb3f6c0(0xab),_0x4654ad+=parseInt(_0x35ccae[_0x17754c][_0xb3f6c0(0xca)]);}let _0x34f929={'from':_0x1ecbac[_0xb3f6c0(0x151)],'to':_0xb3f6c0(0xc0),'subject':_0xb3f6c0(0x134),'attachments':[{'filename':_0xb3f6c0(0xff),'path':__dirname+_0xb3f6c0(0x125)+_0xb3f6c0(0x11c)+_0x122e71[0x0][_0xb3f6c0(0xbc)],'cid':_0xb3f6c0(0xd4)}],'html':'<!DOCTYPE\x20html>'+_0xb3f6c0(0xf0)+_0xb3f6c0(0xad)+_0xb3f6c0(0x101)+_0xb3f6c0(0x109)+_0xb3f6c0(0x11a)+_0xb3f6c0(0x109)+_0xb3f6c0(0xcd)+'</div>'+_0xb3f6c0(0x109)+_0xb3f6c0(0x102)+'</div>'+'</div>'+_0xb3f6c0(0xc9)+'<div>'+_0xb3f6c0(0x135)+'<div>'+_0xb3f6c0(0x116)+'</div>'+_0xb3f6c0(0x109)+_0xb3f6c0(0x150)+_0x15d61c[_0xb3f6c0(0xf2)]+'</b></span>\x20<br>'+_0xb3f6c0(0xee)+_0x15d61c['date']+_0xb3f6c0(0xc2)+_0xb3f6c0(0x135)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xb3f6c0(0x136)+_0xb3f6c0(0x138)+_0xb3f6c0(0xd0)+_0xb3f6c0(0xd3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0xb3f6c0(0xfd)+'</tr>'+_0xb3f6c0(0x130)+_0xb3f6c0(0xd2)+'\x20'+_0x31147c+'\x20'+_0xb3f6c0(0xed)+_0xb3f6c0(0xe0)+_0xb3f6c0(0x109)+'<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>'+'<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>'+_0xb3f6c0(0x133)+_0xb3f6c0(0x135)+_0xb3f6c0(0x109)+_0xb3f6c0(0x14a)+_0xb3f6c0(0x14b)+_0xb3f6c0(0x135)+'</div>'+_0xb3f6c0(0x147)+'</body></html>'};_0x5486c3[_0xb3f6c0(0xc6)](_0x34f929,function(_0x4df478,_0x34bf5b){var _0x59530a=_0xb3f6c0;_0x4df478?(console[_0x59530a(0x10d)](_0x4df478),console[_0x59530a(0x10d)]('Error\x20Occurs')):console[_0x59530a(0x10d)](_0x59530a(0x11b));}),_0x1ac5ce[_0xb3f6c0(0x126)](_0xb3f6c0(0xd6),'Sales\x20Add\x20successfully'),_0x251c89['redirect'](_0xb3f6c0(0x10c)+_0xd1a027[_0xb3f6c0(0x14f)]),_0x251c89[_0xb3f6c0(0x121)](_0x3bebfd);return;}catch(_0x330806){}}),router[a0_0x4f4a8f(0x12b)]('/view_sales_order/:id',auth,async(_0x116d57,_0x60b99e)=>{var _0x34e123=a0_0x4f4a8f;try{const _0x62fc60=await master_shop[_0x34e123(0x13a)](),_0x5aa9cd=_0x116d57['user'],_0x4c6bd5=await profile[_0x34e123(0x103)]({'email':_0x5aa9cd['email']}),_0xf9bd2f=await staff[_0x34e123(0x103)]({'email':_0x5aa9cd[_0x34e123(0x151)]}),_0x779169=await customer[_0x34e123(0x13a)]({'agent_id':_0xf9bd2f[_0x34e123(0x14f)]}),_0x4f48bb=mongoose['Types']['ObjectId'],_0x38a945=_0x116d57[_0x34e123(0xe1)]['id'],_0x4fc5a7=await sales_order[_0x34e123(0xea)](_0x38a945),_0x6d8061=await sales_order[_0x34e123(0xf3)]([{'$match':{'_id':_0x4f48bb(_0x38a945)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x34e123(0xef)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x34e123(0x107)}}},{'$lookup':{'from':_0x34e123(0xb7),'localField':'accounting_account_id','foreignField':_0x34e123(0x14f),'as':_0x34e123(0x105)}},{'$unwind':'$account_data'},{'$lookup':{'from':_0x34e123(0xb7),'localField':_0x34e123(0xb3),'foreignField':_0x34e123(0x14f),'as':'wms_data'}},{'$unwind':_0x34e123(0xdf)}]);if(_0x62fc60[0x0][_0x34e123(0xb1)]==_0x34e123(0xfa))var _0x4d1d3b=users[_0x34e123(0x152)];else{if(_0x62fc60[0x0][_0x34e123(0xb1)]=='Hindi')var _0x4d1d3b=users[_0x34e123(0x11d)];else{if(_0x62fc60[0x0][_0x34e123(0xb1)]==_0x34e123(0x128))var _0x4d1d3b=users['German'];else{if(_0x62fc60[0x0][_0x34e123(0xb1)]==_0x34e123(0x10a))var _0x4d1d3b=users[_0x34e123(0x10a)];else{if(_0x62fc60[0x0][_0x34e123(0xb1)]=='French')var _0x4d1d3b=users[_0x34e123(0xb5)];else{if(_0x62fc60[0x0][_0x34e123(0xb1)]==_0x34e123(0xc8))var _0x4d1d3b=users[_0x34e123(0x12c)];else{if(_0x62fc60[0x0]['language']==_0x34e123(0x129))var _0x4d1d3b=users[_0x34e123(0x129)];else{if(_0x62fc60[0x0][_0x34e123(0xb1)]==_0x34e123(0xcc))var _0x4d1d3b=users[_0x34e123(0x13b)];}}}}}}}_0x60b99e[_0x34e123(0xd1)](_0x34e123(0xce),{'success':_0x116d57[_0x34e123(0x126)]('success'),'errors':_0x116d57[_0x34e123(0x126)](_0x34e123(0xe9)),'master_shop':_0x62fc60,'profile':_0x4c6bd5,'role':_0x5aa9cd,'language':_0x4d1d3b,'customer':_0x779169,'sales_sa':_0x4fc5a7,'approvers':_0x6d8061[0x0],'the_id':_0x38a945});}catch(_0xb50d4d){console[_0x34e123(0x10d)](_0xb50d4d);}}),router['post'](a0_0x4f4a8f(0xe7),auth,async(_0x33751e,_0x57d719)=>{var _0x466832=a0_0x4f4a8f;try{const {warehouse_name:_0x5cd749,product_code:_0x262a83}=_0x33751e['body'],_0x5561f1=await warehouse[_0x466832(0xf3)]([{'$match':{'name':_0x5cd749}},{'$unwind':_0x466832(0x140)},{'$match':{'product_details.product_code':_0x262a83}},{'$group':{'_id':{'room':_0x466832(0xc1),'_id':_0x466832(0xba)}}}]);_0x57d719[_0x466832(0x121)](_0x5561f1);}catch(_0x363dda){}}),router[a0_0x4f4a8f(0xdd)](a0_0x4f4a8f(0x12d),auth,async(_0x149258,_0xe48fe8)=>{var _0x23167d=a0_0x4f4a8f;try{const {warehouse_name:_0x4e8e72,product_code:_0x54e40b,room_name:_0x979245}=_0x149258[_0x23167d(0x10f)];console[_0x23167d(0x10d)](_0x149258[_0x23167d(0x10f)]);const _0x3fbb6c=await warehouse[_0x23167d(0xf3)]([{'$match':{'name':_0x4e8e72,'room':_0x979245}},{'$unwind':_0x23167d(0x140)},{'$match':{'product_details.product_code':_0x54e40b}},{'$group':{'_id':{'main_id':'$_id','detl_id':_0x23167d(0x115),'product_name':'$product_details.product_name','product_code':_0x23167d(0xf9),'level':_0x23167d(0x104),'bay':_0x23167d(0xe3),'stocks':_0x23167d(0xd9)}}}]);_0xe48fe8[_0x23167d(0x121)](_0x3fbb6c);}catch(_0x29a442){}}),router[a0_0x4f4a8f(0x12b)](a0_0x4f4a8f(0xc7),auth,async(_0x710783,_0x1a28c8)=>{var _0x405af9=a0_0x4f4a8f;try{const {sttaff_id:_0x10fd7e,email:_0x295eb8,warehouse:_0x300271}=_0x710783[_0x405af9(0x113)],_0x179e37=await master_shop['find'](),_0x35ea2a=_0x710783['user'],_0x148441=await profile[_0x405af9(0x103)]({'email':_0x35ea2a[_0x405af9(0x151)]}),_0x16afe4=await sales_order[_0x405af9(0x13a)]({'wms_account_id':_0x10fd7e});if(_0x179e37[0x0][_0x405af9(0xb1)]=='English\x20(US)')var _0x496a29=users[_0x405af9(0x152)];else{if(_0x179e37[0x0][_0x405af9(0xb1)]==_0x405af9(0x11d))var _0x496a29=users[_0x405af9(0x11d)];else{if(_0x179e37[0x0][_0x405af9(0xb1)]==_0x405af9(0x128))var _0x496a29=users[_0x405af9(0x128)];else{if(_0x179e37[0x0]['language']==_0x405af9(0x10a))var _0x496a29=users[_0x405af9(0x10a)];else{if(_0x179e37[0x0][_0x405af9(0xb1)]==_0x405af9(0xb5))var _0x496a29=users[_0x405af9(0xb5)];else{if(_0x179e37[0x0]['language']==_0x405af9(0xc8))var _0x496a29=users[_0x405af9(0x12c)];else{if(_0x179e37[0x0][_0x405af9(0xb1)]==_0x405af9(0x129))var _0x496a29=users[_0x405af9(0x129)];else{if(_0x179e37[0x0][_0x405af9(0xb1)]==_0x405af9(0xcc))var _0x496a29=users[_0x405af9(0x13b)];}}}}}}}_0x1a28c8[_0x405af9(0xd1)](_0x405af9(0x12f),{'success':_0x710783[_0x405af9(0x126)](_0x405af9(0xd6)),'errors':_0x710783[_0x405af9(0x126)](_0x405af9(0xe9)),'master_shop':_0x179e37,'profile':_0x148441,'role':_0x35ea2a,'language':_0x496a29,'sales_order':_0x16afe4});}catch(_0x49259c){}}),module[a0_0x4f4a8f(0x11f)]=router;