var a0_0xfe98e3=a0_0x2217;(function(_0x17c26d,_0x2d98a4){var _0x2f4ca8=a0_0x2217,_0x3137c5=_0x17c26d();while(!![]){try{var _0x3d1f8e=parseInt(_0x2f4ca8(0x241))/0x1*(parseInt(_0x2f4ca8(0x25d))/0x2)+parseInt(_0x2f4ca8(0x1f6))/0x3+-parseInt(_0x2f4ca8(0x24f))/0x4*(parseInt(_0x2f4ca8(0x211))/0x5)+parseInt(_0x2f4ca8(0x1ce))/0x6*(-parseInt(_0x2f4ca8(0x262))/0x7)+-parseInt(_0x2f4ca8(0x22b))/0x8*(-parseInt(_0x2f4ca8(0x225))/0x9)+-parseInt(_0x2f4ca8(0x1cd))/0xa+parseInt(_0x2f4ca8(0x1f3))/0xb;if(_0x3d1f8e===_0x2d98a4)break;else _0x3137c5['push'](_0x3137c5['shift']());}catch(_0x5904c6){_0x3137c5['push'](_0x3137c5['shift']());}}}(a0_0x31a3,0x573e9));function a0_0x31a3(){var _0x5df2af=['id_transaction_from','</div>','render','padStart','data_loc','English','success','<html><head><title></title>','16oWfRra','stock','params','Email\x20for\x20Customer','primary_code','1141ZBRUgM','</thead>','staffs','$product_details','xlsx','warehouse_approval','log','German','2706660FvXawD','24354OZWIKc','createTransport','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','filter','wms_data','$account_data','</head><body>','qty','image','nodemailer','$wms_data','toLocaleDateString','batch_code','maxperunit','push','errors','<hr\x20class=\x22my-3\x22>','English\x20(US)','$accounting_account_id','warehouse_approval_All','/:id','../models/all_models','prod_id','/data/All','gross_price','find','</table>','exceljs','$room','toString','level','$product_details.level','$product_details.bay','<div>','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','email','secondary_unit','17879587gvSpmO','</b></span>\x20<br>','/data/data_loc','8370IbnTwr','<br><br><br>','product_details','length','quantity','save','Logo.png','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','bay','Spanish','logo','unit','/../public','ObjectId','/all_sales_finished/preview/','Hindi','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Sales\x20Add\x20successfully','<h5>\x20JEC\x20SMS\x20</h5>','$wms_account_id','Email\x20sent\x20successfully','request_qty','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','wms_account_date','product_stock','forEach','<tbody\x20style=\x22text-align:\x20center;\x22>','5AgJmAa','aggregate','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','product_code','invoice_init','host','</body></html>','/upload/','$product_details.product_code','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','express','warehouse_detl','../middleware/auth','language','get','False','expiry_date','secondary_code','warehouse_id','Portuguese\x20(BR)','9HMbtgM','document_number_out','://','../public/language/languages.json','accounting_account_id','/data/data_rack','2058032ZwfoUB','account_data','Portuguese','user','wms_account_id','$_id','abs','Error\x20Occurs','<span>\x20Request\x20ID:\x20<b>','json','$product_details._id','</tr>','post','OUT-','redirect','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','split','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</tbody>','findById','product_name','1538rRFpJR','_id','password','Types','view_accounting_approval','Arabic\x20(ae)','maxPerUnit','Chinese','outgoing_invoice','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','production_date','findOne','Arabic','flash','2432516qhcRSe','French','uuid','body','<!DOCTYPE\x20html>','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>'];a0_0x31a3=function(){return _0x5df2af;};return a0_0x31a3();}const express=require(a0_0xfe98e3(0x21b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0xfe98e3(0x1e3)),auth=require(a0_0xfe98e3(0x21d)),users=require(a0_0xfe98e3(0x228)),excelJS=require(a0_0xfe98e3(0x1e9)),xlsx=require(a0_0xfe98e3(0x1c9)),mongoose=require('mongoose'),{ObjectId}=require('mongodb'),nodemailer=require(a0_0xfe98e3(0x1d7));function a0_0x2217(_0x39467d,_0x583133){var _0x31a3d2=a0_0x31a3();return a0_0x2217=function(_0x2217c6,_0x2c31b7){_0x2217c6=_0x2217c6-0x1c6;var _0x242a73=_0x31a3d2[_0x2217c6];return _0x242a73;},a0_0x2217(_0x39467d,_0x583133);}router[a0_0xfe98e3(0x21f)](a0_0xfe98e3(0x1e2),auth,async(_0x58298e,_0x24cd25)=>{var _0x3595aa=a0_0xfe98e3;try{const _0x1cec7c=await master_shop[_0x3595aa(0x1e7)](),_0x307854=_0x58298e[_0x3595aa(0x22e)],_0x155396=await profile[_0x3595aa(0x24c)]({'email':_0x307854[_0x3595aa(0x1f1)]}),_0x6345a6=await staff[_0x3595aa(0x24c)]({'email':_0x307854['email']}),_0x1961bb=await customer[_0x3595aa(0x1e7)]({'agent_id':_0x6345a6[_0x3595aa(0x242)]}),_0x154db1=mongoose[_0x3595aa(0x244)]['ObjectId'],_0x2b6d14=_0x58298e['params']['id'],_0x36b641=await sales_order['findById'](_0x2b6d14),_0x16b365=await sales_order[_0x3595aa(0x212)]([{'$match':{'_id':_0x154db1(_0x2b6d14)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x3595aa(0x1e0)}}},{'$addFields':{'wms_account_id':{'$toObjectId':'$wms_account_id'}}},{'$lookup':{'from':_0x3595aa(0x1c7),'localField':_0x3595aa(0x229),'foreignField':_0x3595aa(0x242),'as':_0x3595aa(0x22c)}},{'$unwind':_0x3595aa(0x1d3)},{'$lookup':{'from':_0x3595aa(0x1c7),'localField':_0x3595aa(0x22f),'foreignField':'_id','as':_0x3595aa(0x1d2)}},{'$unwind':_0x3595aa(0x1d8)}]);if(_0x1cec7c[0x0][_0x3595aa(0x21e)]==_0x3595aa(0x1df))var _0xc7a5a9=users['English'];else{if(_0x1cec7c[0x0][_0x3595aa(0x21e)]==_0x3595aa(0x205))var _0xc7a5a9=users[_0x3595aa(0x205)];else{if(_0x1cec7c[0x0]['language']==_0x3595aa(0x1cc))var _0xc7a5a9=users['German'];else{if(_0x1cec7c[0x0]['language']==_0x3595aa(0x1ff))var _0xc7a5a9=users['Spanish'];else{if(_0x1cec7c[0x0]['language']=='French')var _0xc7a5a9=users['French'];else{if(_0x1cec7c[0x0][_0x3595aa(0x21e)]=='Portuguese\x20(BR)')var _0xc7a5a9=users[_0x3595aa(0x22d)];else{if(_0x1cec7c[0x0][_0x3595aa(0x21e)]==_0x3595aa(0x248))var _0xc7a5a9=users[_0x3595aa(0x248)];else{if(_0x1cec7c[0x0][_0x3595aa(0x21e)]==_0x3595aa(0x246))var _0xc7a5a9=users[_0x3595aa(0x24d)];}}}}}}}_0x24cd25[_0x3595aa(0x257)](_0x3595aa(0x1ca),{'success':_0x58298e[_0x3595aa(0x24e)]('success'),'errors':_0x58298e[_0x3595aa(0x24e)]('errors'),'master_shop':_0x1cec7c,'profile':_0x155396,'role':_0x307854,'language':_0xc7a5a9,'customer':_0x1961bb,'sales_sa':_0x36b641,'approvers':_0x16b365[0x0],'the_id':_0x2b6d14});}catch(_0x36ed66){console[_0x3595aa(0x1cb)](_0x36ed66);}}),router[a0_0xfe98e3(0x237)](a0_0xfe98e3(0x1e2),auth,async(_0x21c4f5,_0x42d17d)=>{var _0x54355d=a0_0xfe98e3;try{const {date:_0x191859,invoice_data:_0x3dcd14,wms_confirm:_0x529f9f,the_id_val:_0x420a84,prod_id:_0x37246a,SCRN:_0x56480f,ReqBy:_0x3f1d5c,dateofreq:_0xdc07f6,PO_number:_0x3808b1,warehouse_name:_0xc92e6f,typeservicesData:_0x26da5d,typevehicle:_0x3c421d,destination:_0x5685b7,deliverydate:_0x575687,driver:_0x4485f6,plate:_0x35c634,van:_0xa698d6,DRSI:_0xdaeadb,TSU:_0x502e14,TFU:_0x53fd2e,note:_0x4b46a2}=_0x21c4f5[_0x54355d(0x252)],_0x5dcdeb=await sales_order['findById'](_0x420a84);if(typeof _0x37246a=='string')var _0x480020=[_0x21c4f5['body']['prod_id']],_0x99d648=[_0x21c4f5[_0x54355d(0x252)]['qty']],_0x30508f=[_0x21c4f5['body'][_0x54355d(0x259)]];else var _0x480020=[..._0x21c4f5['body'][_0x54355d(0x1e4)]],_0x99d648=[..._0x21c4f5[_0x54355d(0x252)][_0x54355d(0x1d5)]],_0x30508f=[..._0x21c4f5[_0x54355d(0x252)][_0x54355d(0x259)]];const _0x28e0c2=_0x480020['map'](_0x196e1c=>{return _0x196e1c={'prod_id':_0x196e1c};});_0x30508f[_0x54355d(0x20f)]((_0x57884c,_0x334ef4)=>{var _0x509163=_0x54355d,_0x2fb48e=_0x57884c[_0x509163(0x23c)]('~');_0x28e0c2[_0x334ef4][_0x509163(0x223)]=_0x2fb48e[0x0],_0x28e0c2[_0x334ef4][_0x509163(0x21c)]=_0x2fb48e[0x1];}),_0x99d648['forEach']((_0x3b59c4,_0xe5b36)=>{var _0x15cf80=_0x54355d;_0x28e0c2[_0xe5b36][_0x15cf80(0x20b)]=_0x3b59c4;});var _0x4c867f=[],_0x42491f=[],_0x3a80d8=[],_0x5be955=[],_0x3a5b6c=[],_0x313752=[],_0x530441=[],_0x2e791a=[],_0x2f6694=[],_0x1af410=[],_0x227eaf=[],_0x2727b9=[],_0x38e3a5=[],_0x1867bf=[],_0x2db525=[],_0x25b385=[],_0x715d3a=[],_0x28da4e=[],_0xf81d60=[],_0x391145=[];for(let _0x364129=0x0;_0x364129<=_0x28e0c2[_0x54355d(0x1f9)]-0x1;_0x364129++){const _0x4a0392=_0x28e0c2[_0x364129],_0x2491e4=mongoose[_0x54355d(0x244)][_0x54355d(0x203)];var _0x56b840=await warehouse[_0x54355d(0x212)]([{'$match':{'_id':_0x2491e4(_0x4a0392[_0x54355d(0x223)])}},{'$unwind':_0x54355d(0x1c8)},{'$match':{'product_details._id':_0x2491e4(_0x4a0392[_0x54355d(0x21c)])}}]),_0x4ce7e4=0x0;for(let _0x1115dc=0x0;_0x1115dc<=_0x56b840[_0x54355d(0x1f9)]-0x1;_0x1115dc++){var _0xebbdef=_0x56b840[_0x1115dc];_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x20e)]<_0x4a0392['request_qty']&&_0x4ce7e4++;}if(_0x4ce7e4>0x0)return _0x21c4f5[_0x54355d(0x24e)](_0x54355d(0x1dd),_0x54355d(0x213)),_0x42d17d[_0x54355d(0x239)]('back');var _0x1da5ed=0x0;for(let _0x45652c=0x0;_0x45652c<=_0x56b840['length']-0x1;_0x45652c++){var _0xebbdef=_0x56b840[_0x45652c];_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x20e)]>_0x4a0392[_0x54355d(0x20b)]&&(_0x4c867f[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x240)]),_0x42491f[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x20e)]),_0x3a80d8['push'](_0x4a0392[_0x54355d(0x20b)]),_0x5be955[_0x54355d(0x1dc)](_0xebbdef['product_details']['primary_code']),_0x3a5b6c[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)]['secondary_code']),_0x313752[_0x54355d(0x1dc)](_0xebbdef['product_details'][_0x54355d(0x214)]),_0x530441[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)]['level']),_0x2e791a['push'](_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x1fe)]),_0x2f6694['push'](_0xebbdef[_0x54355d(0x1f8)]['unit']),_0x1af410[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x1f2)]),_0x227eaf[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)]['batch_code']),_0x2727b9[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x221)]),_0x38e3a5[_0x54355d(0x1dc)](_0xebbdef['product_details'][_0x54355d(0x24b)]),_0x1867bf['push'](_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x247)]),_0x2db525['push'](_0xebbdef['product_details']['product_cat']),_0x25b385[_0x54355d(0x1dc)](_0xebbdef['room']),_0x715d3a[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)]['invoice']),_0x28da4e[_0x54355d(0x1dc)](_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x242)]),_0xf81d60['push'](_0xebbdef[_0x54355d(0x1f8)][_0x54355d(0x251)]),_0x391145[_0x54355d(0x1dc)](_0xebbdef['product_details'][_0x54355d(0x1e6)]),_0x1da5ed++);}}const _0x5f3c84=_0x4c867f['map'](_0x4f36cf=>{return _0x4f36cf={'product_name':_0x4f36cf};});_0x42491f[_0x54355d(0x20f)]((_0x55d83c,_0x39cc8f)=>{var _0x3dcdfa=_0x54355d;_0x5f3c84[_0x39cc8f][_0x3dcdfa(0x25e)]=_0x55d83c;}),_0x3a80d8['forEach']((_0x3e81bd,_0x3da0bc)=>{var _0x5931c8=_0x54355d;_0x5f3c84[_0x3da0bc][_0x5931c8(0x1fa)]=Math[_0x5931c8(0x231)](_0x3e81bd);}),_0x391145['forEach']((_0x132872,_0x451260)=>{_0x5f3c84[_0x451260]['gross_price']=_0x132872;}),_0xf81d60[_0x54355d(0x20f)]((_0x551d78,_0x35edac)=>{var _0x3feefc=_0x54355d;_0x5f3c84[_0x35edac][_0x3feefc(0x251)]=_0x551d78;}),_0x28da4e[_0x54355d(0x20f)]((_0x1a6349,_0x4f5a4b)=>{var _0x7fb56=_0x54355d;_0x5f3c84[_0x4f5a4b][_0x7fb56(0x255)]=_0x1a6349;}),_0x5be955[_0x54355d(0x20f)]((_0x119c54,_0x2155c1)=>{var _0x8fa72f=_0x54355d;_0x5f3c84[_0x2155c1][_0x8fa72f(0x261)]=_0x119c54;}),_0x3a5b6c[_0x54355d(0x20f)]((_0x3603ae,_0x540299)=>{var _0x468d62=_0x54355d;_0x5f3c84[_0x540299][_0x468d62(0x222)]=_0x3603ae;}),_0x313752[_0x54355d(0x20f)]((_0x14ca1a,_0x42ab84)=>{var _0x594773=_0x54355d;_0x5f3c84[_0x42ab84][_0x594773(0x214)]=_0x14ca1a;}),_0x530441[_0x54355d(0x20f)]((_0x57e7cf,_0xbb9139)=>{var _0x3f6526=_0x54355d;_0x5f3c84[_0xbb9139][_0x3f6526(0x1ec)]=_0x57e7cf;}),_0x2e791a[_0x54355d(0x20f)]((_0x273432,_0x30fac7)=>{var _0x1e6fe8=_0x54355d;_0x5f3c84[_0x30fac7][_0x1e6fe8(0x1fe)]=_0x273432;}),_0x2f6694['forEach']((_0x44c601,_0x395858)=>{var _0x2b8ada=_0x54355d;_0x5f3c84[_0x395858][_0x2b8ada(0x201)]=_0x44c601;}),_0x1af410[_0x54355d(0x20f)]((_0x36171d,_0x27bd49)=>{var _0x3bc9cb=_0x54355d;_0x5f3c84[_0x27bd49][_0x3bc9cb(0x1f2)]=_0x36171d;}),_0x227eaf[_0x54355d(0x20f)]((_0x3c321a,_0x12ea44)=>{var _0x2d061c=_0x54355d;_0x5f3c84[_0x12ea44][_0x2d061c(0x1da)]=_0x3c321a;}),_0x2727b9[_0x54355d(0x20f)]((_0xbba904,_0x139dbf)=>{var _0x3b5fdc=_0x54355d;_0x5f3c84[_0x139dbf][_0x3b5fdc(0x221)]=_0xbba904;}),_0x38e3a5['forEach']((_0x28cee6,_0x1edcd4)=>{var _0x2ec8d4=_0x54355d;_0x5f3c84[_0x1edcd4][_0x2ec8d4(0x24b)]=_0x28cee6;}),_0x1867bf['forEach']((_0x1f028a,_0x5dc6e8)=>{var _0x1d9ced=_0x54355d;_0x5f3c84[_0x5dc6e8][_0x1d9ced(0x1db)]=_0x1f028a;}),_0x2db525[_0x54355d(0x20f)]((_0x337e50,_0x3fda16)=>{_0x5f3c84[_0x3fda16]['prod_cat']=_0x337e50;}),_0x25b385[_0x54355d(0x20f)]((_0x59c841,_0x2d4e53)=>{_0x5f3c84[_0x2d4e53]['room_name']=_0x59c841;}),_0x715d3a[_0x54355d(0x20f)]((_0x394dfb,_0x21a501)=>{_0x5f3c84[_0x21a501]['invoice']=_0x394dfb,_0x5f3c84[_0x21a501]['date_data']=_0x191859;});const _0x30ad32=new invoice_for_outgoing();await _0x30ad32[_0x54355d(0x1fb)](),_0x715d3a['forEach']((_0x29a2c0,_0x1d7710)=>{var _0x4044f0=_0x54355d;_0x5f3c84[_0x1d7710][_0x4044f0(0x249)]='OUT-'+_0x30ad32[_0x4044f0(0x215)]['toString']()['padStart'](0x8,'0');});const _0x1a75d0=_0x5f3c84[_0x54355d(0x1d1)](_0x5efb7d=>_0x5efb7d['quantity']!=='0'&&_0x5efb7d['quantity']!==''),_0x81ef59=new sales_finished({'invoice':_0x54355d(0x238)+_0x30ad32[_0x54355d(0x215)]['toString']()[_0x54355d(0x258)](0x8,'0'),'date':_0x191859,'warehouse_name':_0xc92e6f,'sale_product':_0x1a75d0,'note':_0x4b46a2,'SCRN':_0x56480f,'finalize':_0x54355d(0x220),'ReqBy':_0x3f1d5c,'dateofreq':_0xdc07f6,'PO_number':_0x3808b1,'typeservicesData':_0x26da5d,'typevehicle':_0x3c421d,'destination':_0x5685b7,'deliverydate':_0x575687,'driver':_0x4485f6,'plate':_0x35c634,'van':_0xa698d6,'DRSI':_0xdaeadb,'TSU':_0x502e14,'TFU':_0x53fd2e}),_0x58566=await _0x81ef59[_0x54355d(0x1fb)](),_0x4793e0=new Date(),_0x1d153a=_0x4793e0[_0x54355d(0x1d9)]();_0x5dcdeb['wms_account_confirm']=_0x529f9f,_0x5dcdeb[_0x54355d(0x20d)]=_0x1d153a,_0x5dcdeb[_0x54355d(0x226)]='OUT-'+_0x30ad32[_0x54355d(0x215)][_0x54355d(0x1eb)]()[_0x54355d(0x258)](0x8,'0'),_0x5dcdeb['outgoing_id']=_0x58566[_0x54355d(0x242)],await _0x5dcdeb[_0x54355d(0x1fb)]();const _0xf04e2e=await master_shop[_0x54355d(0x1e7)](),_0x21cea6=await email_settings[_0x54355d(0x24c)]();let _0x40f38e=nodemailer[_0x54355d(0x1cf)]({'host':_0x21cea6[_0x54355d(0x216)],'port':Number(_0x21cea6['port']),'secure':![],'auth':{'user':_0x21cea6['email'],'pass':_0x21cea6[_0x54355d(0x243)]}});const _0x2699a8=_0x21c4f5['protocol']+_0x54355d(0x227)+_0x21c4f5['headers'][_0x54355d(0x216)];var _0x47487a=_0x5dcdeb['sale_product'],_0x5e049f='',_0x577057,_0x47d982=0x0;for(_0x577057 in _0x47487a){_0x5e049f+='<tr>'+_0x54355d(0x206)+_0x47487a[_0x577057][_0x54355d(0x240)]+_0x54355d(0x23a)+_0x54355d(0x206)+_0x47487a[_0x577057][_0x54355d(0x214)]+_0x54355d(0x23a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x47487a[_0x577057][_0x54355d(0x1fa)]+_0x54355d(0x23a)+_0x54355d(0x206)+_0x47487a[_0x577057][_0x54355d(0x201)]+_0x54355d(0x23a)+_0x54355d(0x236),_0x47d982+=parseInt(_0x47487a[_0x577057][_0x54355d(0x1fa)]);}let _0x53d48f={'from':_0x21cea6[_0x54355d(0x1f1)],'to':'christian.villamer@jakagroup.com','subject':_0x54355d(0x260),'attachments':[{'filename':_0x54355d(0x1fc),'path':__dirname+_0x54355d(0x202)+_0x54355d(0x218)+_0xf04e2e[0x0][_0x54355d(0x1d6)],'cid':_0x54355d(0x200)}],'html':_0x54355d(0x253)+_0x54355d(0x25c)+_0x54355d(0x254)+_0x54355d(0x1d4)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x54355d(0x1ef)+_0x54355d(0x20c)+'</div>'+_0x54355d(0x1ef)+'<h2>\x20JEC\x20SMS\x20</h2>'+'</div>'+_0x54355d(0x256)+_0x54355d(0x1de)+_0x54355d(0x1ef)+_0x54355d(0x256)+'<div>'+_0x54355d(0x1d0)+'</div>'+_0x54355d(0x1ef)+_0x54355d(0x233)+_0x5dcdeb['invoice']+_0x54355d(0x1f4)+'<span>\x20Request\x20Date:\x20<b>'+_0x5dcdeb['date']+'</b></span>\x20<br><br>'+_0x54355d(0x256)+_0x54355d(0x23d)+_0x54355d(0x24a)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x54355d(0x23b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x54355d(0x1fd)+_0x54355d(0x236)+_0x54355d(0x1c6)+_0x54355d(0x210)+'\x20'+_0x5e049f+'\x20'+_0x54355d(0x23e)+_0x54355d(0x1e8)+_0x54355d(0x1ef)+_0x54355d(0x21a)+'<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>'+_0x54355d(0x1f7)+_0x54355d(0x256)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x54355d(0x208)+_0x54355d(0x256)+_0x54355d(0x256)+_0x54355d(0x1f0)+_0x54355d(0x217)};_0x40f38e['sendMail'](_0x53d48f,function(_0x4774da,_0x414752){var _0x2349ee=_0x54355d;_0x4774da?(console['log'](_0x4774da),console[_0x2349ee(0x1cb)](_0x2349ee(0x232))):console[_0x2349ee(0x1cb)](_0x2349ee(0x20a));}),_0x21c4f5[_0x54355d(0x24e)](_0x54355d(0x25b),_0x54355d(0x207)),_0x42d17d[_0x54355d(0x239)](_0x54355d(0x204)+_0x58566[_0x54355d(0x242)]),_0x42d17d[_0x54355d(0x234)](_0x1a75d0);return;}catch(_0x2e0630){}}),router[a0_0xfe98e3(0x21f)]('/view_sales_order/:id',auth,async(_0x289bcd,_0x49f1af)=>{var _0x32270d=a0_0xfe98e3;try{const _0xfc6ee0=await master_shop['find'](),_0x5120d2=_0x289bcd[_0x32270d(0x22e)],_0x2b7aba=await profile['findOne']({'email':_0x5120d2['email']}),_0x3ebdb9=await staff[_0x32270d(0x24c)]({'email':_0x5120d2[_0x32270d(0x1f1)]}),_0xe60bfa=await customer[_0x32270d(0x1e7)]({'agent_id':_0x3ebdb9[_0x32270d(0x242)]}),_0xf3a19=mongoose[_0x32270d(0x244)][_0x32270d(0x203)],_0x42aa16=_0x289bcd[_0x32270d(0x25f)]['id'],_0x8792c7=await sales_order[_0x32270d(0x23f)](_0x42aa16),_0xe2c8c6=await sales_order[_0x32270d(0x212)]([{'$match':{'_id':_0xf3a19(_0x42aa16)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x32270d(0x1e0)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x32270d(0x209)}}},{'$lookup':{'from':_0x32270d(0x1c7),'localField':_0x32270d(0x229),'foreignField':_0x32270d(0x242),'as':_0x32270d(0x22c)}},{'$unwind':_0x32270d(0x1d3)},{'$lookup':{'from':'staffs','localField':_0x32270d(0x22f),'foreignField':_0x32270d(0x242),'as':_0x32270d(0x1d2)}},{'$unwind':_0x32270d(0x1d8)}]);if(_0xfc6ee0[0x0][_0x32270d(0x21e)]=='English\x20(US)')var _0x2004e2=users[_0x32270d(0x25a)];else{if(_0xfc6ee0[0x0]['language']=='Hindi')var _0x2004e2=users[_0x32270d(0x205)];else{if(_0xfc6ee0[0x0]['language']=='German')var _0x2004e2=users[_0x32270d(0x1cc)];else{if(_0xfc6ee0[0x0]['language']==_0x32270d(0x1ff))var _0x2004e2=users[_0x32270d(0x1ff)];else{if(_0xfc6ee0[0x0][_0x32270d(0x21e)]=='French')var _0x2004e2=users['French'];else{if(_0xfc6ee0[0x0][_0x32270d(0x21e)]=='Portuguese\x20(BR)')var _0x2004e2=users[_0x32270d(0x22d)];else{if(_0xfc6ee0[0x0][_0x32270d(0x21e)]==_0x32270d(0x248))var _0x2004e2=users[_0x32270d(0x248)];else{if(_0xfc6ee0[0x0][_0x32270d(0x21e)]==_0x32270d(0x246))var _0x2004e2=users[_0x32270d(0x24d)];}}}}}}}_0x49f1af[_0x32270d(0x257)](_0x32270d(0x245),{'success':_0x289bcd['flash'](_0x32270d(0x25b)),'errors':_0x289bcd[_0x32270d(0x24e)]('errors'),'master_shop':_0xfc6ee0,'profile':_0x2b7aba,'role':_0x5120d2,'language':_0x2004e2,'customer':_0xe60bfa,'sales_sa':_0x8792c7,'approvers':_0xe2c8c6[0x0],'the_id':_0x42aa16});}catch(_0x423b97){console[_0x32270d(0x1cb)](_0x423b97);}}),router[a0_0xfe98e3(0x237)](a0_0xfe98e3(0x22a),auth,async(_0x444675,_0x2ac96d)=>{var _0x5ea7f5=a0_0xfe98e3;try{const {warehouse_name:_0x547c7d,product_code:_0x6129fa}=_0x444675[_0x5ea7f5(0x252)],_0x1ca0d4=await warehouse[_0x5ea7f5(0x212)]([{'$match':{'name':_0x547c7d}},{'$unwind':_0x5ea7f5(0x1c8)},{'$match':{'product_details.product_code':_0x6129fa}},{'$group':{'_id':{'room':_0x5ea7f5(0x1ea),'_id':_0x5ea7f5(0x230)}}}]);_0x2ac96d[_0x5ea7f5(0x234)](_0x1ca0d4);}catch(_0x44c286){}}),router[a0_0xfe98e3(0x237)](a0_0xfe98e3(0x1f5),auth,async(_0x2dd9ba,_0x55f704)=>{var _0xf41a76=a0_0xfe98e3;try{const {warehouse_name:_0x430709,product_code:_0xf5d95,room_name:_0x21a17e}=_0x2dd9ba[_0xf41a76(0x252)];console[_0xf41a76(0x1cb)](_0x2dd9ba[_0xf41a76(0x252)]);const _0x1f1a0d=await warehouse[_0xf41a76(0x212)]([{'$match':{'name':_0x430709,'room':_0x21a17e}},{'$unwind':_0xf41a76(0x1c8)},{'$match':{'product_details.product_code':_0xf5d95}},{'$group':{'_id':{'main_id':_0xf41a76(0x230),'detl_id':_0xf41a76(0x235),'product_name':'$product_details.product_name','product_code':_0xf41a76(0x219),'level':_0xf41a76(0x1ed),'bay':_0xf41a76(0x1ee),'stocks':'$product_details.product_stock'}}}]);_0x55f704['json'](_0x1f1a0d);}catch(_0x21cd68){}}),router[a0_0xfe98e3(0x21f)](a0_0xfe98e3(0x1e5),auth,async(_0x25d23e,_0x453da0)=>{var _0x13a695=a0_0xfe98e3;try{const {sttaff_id:_0xfc8cb2,email:_0x6c9972,warehouse:_0x389a84}=_0x25d23e[_0x13a695(0x22e)],_0x23fcd0=await master_shop[_0x13a695(0x1e7)](),_0x3b532a=_0x25d23e['user'],_0x4fb68b=await profile['findOne']({'email':_0x3b532a[_0x13a695(0x1f1)]}),_0x5e2394=await sales_order['find']({'wms_account_id':_0xfc8cb2});if(_0x23fcd0[0x0][_0x13a695(0x21e)]=='English\x20(US)')var _0x278604=users[_0x13a695(0x25a)];else{if(_0x23fcd0[0x0][_0x13a695(0x21e)]==_0x13a695(0x205))var _0x278604=users[_0x13a695(0x205)];else{if(_0x23fcd0[0x0]['language']==_0x13a695(0x1cc))var _0x278604=users['German'];else{if(_0x23fcd0[0x0]['language']==_0x13a695(0x1ff))var _0x278604=users[_0x13a695(0x1ff)];else{if(_0x23fcd0[0x0][_0x13a695(0x21e)]==_0x13a695(0x250))var _0x278604=users[_0x13a695(0x250)];else{if(_0x23fcd0[0x0][_0x13a695(0x21e)]==_0x13a695(0x224))var _0x278604=users[_0x13a695(0x22d)];else{if(_0x23fcd0[0x0][_0x13a695(0x21e)]==_0x13a695(0x248))var _0x278604=users[_0x13a695(0x248)];else{if(_0x23fcd0[0x0][_0x13a695(0x21e)]==_0x13a695(0x246))var _0x278604=users[_0x13a695(0x24d)];}}}}}}}_0x453da0[_0x13a695(0x257)](_0x13a695(0x1e1),{'success':_0x25d23e['flash'](_0x13a695(0x25b)),'errors':_0x25d23e[_0x13a695(0x24e)](_0x13a695(0x1dd)),'master_shop':_0x23fcd0,'profile':_0x4fb68b,'role':_0x3b532a,'language':_0x278604,'sales_order':_0x5e2394});}catch(_0x2ffd56){}}),module['exports']=router;