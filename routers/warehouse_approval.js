var a0_0x1e9634=a0_0x59ab;(function(_0x2623ba,_0x467e21){var _0x441b66=a0_0x59ab,_0x526c94=_0x2623ba();while(!![]){try{var _0x2aabb1=-parseInt(_0x441b66(0x21a))/0x1*(-parseInt(_0x441b66(0x206))/0x2)+parseInt(_0x441b66(0x1f1))/0x3+-parseInt(_0x441b66(0x210))/0x4*(-parseInt(_0x441b66(0x22d))/0x5)+parseInt(_0x441b66(0x201))/0x6+-parseInt(_0x441b66(0x259))/0x7+parseInt(_0x441b66(0x21c))/0x8+parseInt(_0x441b66(0x23c))/0x9*(-parseInt(_0x441b66(0x1e2))/0xa);if(_0x2aabb1===_0x467e21)break;else _0x526c94['push'](_0x526c94['shift']());}catch(_0x4d69ea){_0x526c94['push'](_0x526c94['shift']());}}}(a0_0x1dc2,0x701b9));function a0_0x1dc2(){var _0x5a0f1d=['get','id_transaction_from','invoice_init','room_name','xlsx','$accounting_account_id','../models/all_models','2489202idSTNx','../public/language/languages.json','success','<h2>\x20JEC\x20SMS\x20</h2>','<!DOCTYPE\x20html>','637732YqAKQV','date','wms_data','stock','$account_data','map','string','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','OUT-','length','134964hSHAGt','Portuguese','French','Arabic','<html><head><title></title>','sendMail','unit','</div>','redirect','Email\x20sent\x20successfully','1BfCMli','body','2538600JciOMN','<tbody\x20style=\x22text-align:\x20center;\x22>','push','<tr>','warehouse_approval','express','log','filter','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','prod_id','</tr>','account_data','document_number_out','findOne','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','toLocaleDateString','exports','120CtRwDW','outgoing_id','createTransport','/upload/','invoice','data_loc','request_qty','findById','/all_sales_finished/preview/','accounting_account_id','English','/data/data_loc','</td>','post','$wms_account_id','9FtFlNd','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','email','</b></span>\x20<br><br>','<span>\x20Request\x20ID:\x20<b>','product_stock','$product_details','split','padStart','German','Sales\x20Add\x20successfully','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','wms_account_id','level','/data/data_rack','$_id','qty','abs','password','uuid','user','://','False','product_details','<div>','secondary_unit','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','$product_details._id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','1136478yhqlga','warehouse_approval_All','aggregate','English\x20(US)','mongodb','</body></html>','_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<hr\x20class=\x22my-3\x22>','mongoose','language','host','expiry_date','outgoing_invoice','staffs','date_data','flash','save','product_name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/data/All','bay','product_cat','$product_details.level','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','wms_account_date','warehouse_detl','Types','errors','protocol','logo','secondary_code','Portuguese\x20(BR)','$room','forEach','gross_price','21142070tPqZlI','ObjectId','Logo.png','Spanish','json','toString','find','exceljs','production_date','product_code','quantity','/:id','wms_account_confirm','</tbody>','params','2624736ZBMurp','render','warehouse_id','batch_code','</b></span>\x20<br>','Chinese','Hindi','back','Arabic\x20(ae)'];a0_0x1dc2=function(){return _0x5a0f1d;};return a0_0x1dc2();}const express=require(a0_0x1e9634(0x221)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x1e9634(0x200)),auth=require('../middleware/auth'),users=require(a0_0x1e9634(0x202)),excelJS=require(a0_0x1e9634(0x1e9)),xlsx=require(a0_0x1e9634(0x1fe)),mongoose=require(a0_0x1e9634(0x262)),{ObjectId}=require(a0_0x1e9634(0x25d)),nodemailer=require('nodemailer');function a0_0x59ab(_0x34d6d5,_0x10b6cf){var _0x1dc2d7=a0_0x1dc2();return a0_0x59ab=function(_0x59ab4a,_0x5349e4){_0x59ab4a=_0x59ab4a-0x1cd;var _0x41f647=_0x1dc2d7[_0x59ab4a];return _0x41f647;},a0_0x59ab(_0x34d6d5,_0x10b6cf);}router[a0_0x1e9634(0x1fa)](a0_0x1e9634(0x1ed),auth,async(_0x4a2c92,_0x48eaf7)=>{var _0x32c741=a0_0x1e9634;try{const _0x40aa1c=await master_shop[_0x32c741(0x1e8)](),_0x5c59d7=_0x4a2c92[_0x32c741(0x250)],_0x35cca2=await profile['findOne']({'email':_0x5c59d7[_0x32c741(0x23e)]}),_0x281a55=await staff[_0x32c741(0x229)]({'email':_0x5c59d7[_0x32c741(0x23e)]}),_0x46425a=await customer['find']({'agent_id':_0x281a55[_0x32c741(0x25f)]}),_0x149b32=mongoose[_0x32c741(0x1d9)][_0x32c741(0x1e3)],_0x4487e9=_0x4a2c92[_0x32c741(0x1f0)]['id'],_0x300206=await sales_order[_0x32c741(0x234)](_0x4487e9),_0x5d5737=await sales_order['aggregate']([{'$match':{'_id':_0x149b32(_0x4487e9)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x32c741(0x1ff)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x32c741(0x23b)}}},{'$lookup':{'from':'staffs','localField':_0x32c741(0x236),'foreignField':'_id','as':_0x32c741(0x227)}},{'$unwind':'$account_data'},{'$lookup':{'from':_0x32c741(0x267),'localField':_0x32c741(0x248),'foreignField':_0x32c741(0x25f),'as':_0x32c741(0x208)}},{'$unwind':'$wms_data'}]);if(_0x40aa1c[0x0]['language']==_0x32c741(0x25c))var _0x45356d=users['English'];else{if(_0x40aa1c[0x0][_0x32c741(0x263)]==_0x32c741(0x1f7))var _0x45356d=users['Hindi'];else{if(_0x40aa1c[0x0]['language']==_0x32c741(0x245))var _0x45356d=users[_0x32c741(0x245)];else{if(_0x40aa1c[0x0][_0x32c741(0x263)]=='Spanish')var _0x45356d=users['Spanish'];else{if(_0x40aa1c[0x0][_0x32c741(0x263)]=='French')var _0x45356d=users[_0x32c741(0x212)];else{if(_0x40aa1c[0x0][_0x32c741(0x263)]=='Portuguese\x20(BR)')var _0x45356d=users[_0x32c741(0x211)];else{if(_0x40aa1c[0x0]['language']==_0x32c741(0x1f6))var _0x45356d=users[_0x32c741(0x1f6)];else{if(_0x40aa1c[0x0][_0x32c741(0x263)]==_0x32c741(0x1f9))var _0x45356d=users[_0x32c741(0x213)];}}}}}}}_0x48eaf7[_0x32c741(0x1f2)](_0x32c741(0x220),{'success':_0x4a2c92[_0x32c741(0x1ce)](_0x32c741(0x203)),'errors':_0x4a2c92[_0x32c741(0x1ce)](_0x32c741(0x1da)),'master_shop':_0x40aa1c,'profile':_0x35cca2,'role':_0x5c59d7,'language':_0x45356d,'customer':_0x46425a,'sales_sa':_0x300206,'approvers':_0x5d5737[0x0],'the_id':_0x4487e9});}catch(_0x2f182a){console[_0x32c741(0x222)](_0x2f182a);}}),router['post'](a0_0x1e9634(0x1ed),auth,async(_0x24d110,_0x364ddd)=>{var _0x1634c2=a0_0x1e9634;try{const {date:_0x3f36a9,invoice_data:_0x15270c,wms_confirm:_0x347bab,the_id_val:_0x3e2376,prod_id:_0x21802d,SCRN:_0x19e131,ReqBy:_0x8118c3,dateofreq:_0x1b3aa0,PO_number:_0x507874,warehouse_name:_0x190b9b,typeservicesData:_0x4756db,typevehicle:_0xa8b942,destination:_0x398f1b,deliverydate:_0x59c158,driver:_0x44c95d,plate:_0x279dea,van:_0x56e0fa,DRSI:_0xe50beb,TSU:_0x477c96,TFU:_0x235938,note:_0x4528d8}=_0x24d110['body'],_0x21515d=await sales_order[_0x1634c2(0x234)](_0x3e2376);if(typeof _0x21802d==_0x1634c2(0x20c))var _0x5943b9=[_0x24d110['body'][_0x1634c2(0x225)]],_0x529264=[_0x24d110[_0x1634c2(0x21b)][_0x1634c2(0x24c)]],_0x31dddf=[_0x24d110['body'][_0x1634c2(0x232)]];else var _0x5943b9=[..._0x24d110[_0x1634c2(0x21b)][_0x1634c2(0x225)]],_0x529264=[..._0x24d110[_0x1634c2(0x21b)][_0x1634c2(0x24c)]],_0x31dddf=[..._0x24d110[_0x1634c2(0x21b)][_0x1634c2(0x232)]];const _0x5d78a0=_0x5943b9['map'](_0x5ddf2c=>{return _0x5ddf2c={'prod_id':_0x5ddf2c};});_0x31dddf[_0x1634c2(0x1e0)]((_0x92a823,_0x357434)=>{var _0x537de1=_0x1634c2,_0x33385e=_0x92a823[_0x537de1(0x243)]('~');_0x5d78a0[_0x357434][_0x537de1(0x1f3)]=_0x33385e[0x0],_0x5d78a0[_0x357434]['warehouse_detl']=_0x33385e[0x1];}),_0x529264['forEach']((_0x507c85,_0x3d1b2d)=>{_0x5d78a0[_0x3d1b2d]['request_qty']=_0x507c85;});var _0x3cb483=[],_0xd3ac37=[],_0x51b591=[],_0x5e8443=[],_0x4391ab=[],_0x364292=[],_0x4d7b31=[],_0x507f8f=[],_0x5e583f=[],_0xd854a1=[],_0x253048=[],_0x445e95=[],_0x5a92bc=[],_0x4c5dd7=[],_0x156af4=[],_0x4e9683=[],_0x342d85=[],_0x4e9eef=[],_0x266363=[],_0x297be9=[];for(let _0x3edc0c=0x0;_0x3edc0c<=_0x5d78a0[_0x1634c2(0x20f)]-0x1;_0x3edc0c++){const _0x266597=_0x5d78a0[_0x3edc0c],_0x301d7d=mongoose[_0x1634c2(0x1d9)][_0x1634c2(0x1e3)];var _0x2169fb=await warehouse[_0x1634c2(0x25b)]([{'$match':{'_id':_0x301d7d(_0x266597['warehouse_id'])}},{'$unwind':_0x1634c2(0x242)},{'$match':{'product_details._id':_0x301d7d(_0x266597[_0x1634c2(0x1d8)])}}]),_0x1b6c7b=0x0;for(let _0x55135c=0x0;_0x55135c<=_0x2169fb[_0x1634c2(0x20f)]-0x1;_0x55135c++){var _0x41d945=_0x2169fb[_0x55135c];_0x41d945['product_details']['product_stock']<_0x266597['request_qty']&&_0x1b6c7b++;}if(_0x1b6c7b>0x0)return _0x24d110['flash']('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x364ddd[_0x1634c2(0x218)](_0x1634c2(0x1f8));var _0x11948a=0x0;for(let _0x2845e4=0x0;_0x2845e4<=_0x2169fb[_0x1634c2(0x20f)]-0x1;_0x2845e4++){var _0x41d945=_0x2169fb[_0x2845e4];_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x241)]>_0x266597[_0x1634c2(0x233)]&&(_0x3cb483[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x1d0)]),_0xd3ac37[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x241)]),_0x51b591['push'](_0x266597[_0x1634c2(0x233)]),_0x5e8443[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)]['primary_code']),_0x4391ab[_0x1634c2(0x21e)](_0x41d945['product_details'][_0x1634c2(0x1dd)]),_0x364292[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)]['product_code']),_0x4d7b31[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x249)]),_0x507f8f[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)]['bay']),_0x5e583f[_0x1634c2(0x21e)](_0x41d945['product_details'][_0x1634c2(0x216)]),_0xd854a1['push'](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x255)]),_0x253048[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x1f4)]),_0x445e95[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x265)]),_0x5a92bc['push'](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x1ea)]),_0x4c5dd7[_0x1634c2(0x21e)](_0x41d945['product_details']['maxPerUnit']),_0x156af4[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x1d4)]),_0x4e9683[_0x1634c2(0x21e)](_0x41d945['room']),_0x342d85['push'](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x231)]),_0x4e9eef[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)]['_id']),_0x266363[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x24f)]),_0x297be9[_0x1634c2(0x21e)](_0x41d945[_0x1634c2(0x253)][_0x1634c2(0x1e1)]),_0x11948a++);}}const _0x397cdb=_0x3cb483[_0x1634c2(0x20b)](_0x4d9052=>{return _0x4d9052={'product_name':_0x4d9052};});_0xd3ac37[_0x1634c2(0x1e0)]((_0x3be2d9,_0x4d082b)=>{var _0x5c7508=_0x1634c2;_0x397cdb[_0x4d082b][_0x5c7508(0x209)]=_0x3be2d9;}),_0x51b591[_0x1634c2(0x1e0)]((_0x599d44,_0x40b922)=>{var _0x404b7a=_0x1634c2;_0x397cdb[_0x40b922][_0x404b7a(0x1ec)]=Math[_0x404b7a(0x24d)](_0x599d44);}),_0x297be9[_0x1634c2(0x1e0)]((_0x2226c6,_0xf5ccba)=>{var _0x14e246=_0x1634c2;_0x397cdb[_0xf5ccba][_0x14e246(0x1e1)]=_0x2226c6;}),_0x266363[_0x1634c2(0x1e0)]((_0x25be0e,_0x2b436a)=>{var _0x2ee60e=_0x1634c2;_0x397cdb[_0x2b436a][_0x2ee60e(0x24f)]=_0x25be0e;}),_0x4e9eef[_0x1634c2(0x1e0)]((_0x87af16,_0x316254)=>{var _0x28034d=_0x1634c2;_0x397cdb[_0x316254][_0x28034d(0x1fb)]=_0x87af16;}),_0x5e8443[_0x1634c2(0x1e0)]((_0x5b6ece,_0xae8c44)=>{_0x397cdb[_0xae8c44]['primary_code']=_0x5b6ece;}),_0x4391ab[_0x1634c2(0x1e0)]((_0x1813bc,_0x3146fa)=>{var _0x176fc7=_0x1634c2;_0x397cdb[_0x3146fa][_0x176fc7(0x1dd)]=_0x1813bc;}),_0x364292[_0x1634c2(0x1e0)]((_0x54924e,_0x518918)=>{var _0xde65b7=_0x1634c2;_0x397cdb[_0x518918][_0xde65b7(0x1eb)]=_0x54924e;}),_0x4d7b31[_0x1634c2(0x1e0)]((_0x5acf4e,_0x17d43b)=>{var _0x163a5f=_0x1634c2;_0x397cdb[_0x17d43b][_0x163a5f(0x249)]=_0x5acf4e;}),_0x507f8f[_0x1634c2(0x1e0)]((_0x19c87b,_0x30faf4)=>{var _0x59cb18=_0x1634c2;_0x397cdb[_0x30faf4][_0x59cb18(0x1d3)]=_0x19c87b;}),_0x5e583f[_0x1634c2(0x1e0)]((_0x5e35ca,_0x314e67)=>{_0x397cdb[_0x314e67]['unit']=_0x5e35ca;}),_0xd854a1['forEach']((_0x23a4ad,_0x260112)=>{_0x397cdb[_0x260112]['secondary_unit']=_0x23a4ad;}),_0x253048[_0x1634c2(0x1e0)]((_0x5ecb77,_0xdfeb1d)=>{var _0x42ac5c=_0x1634c2;_0x397cdb[_0xdfeb1d][_0x42ac5c(0x1f4)]=_0x5ecb77;}),_0x445e95[_0x1634c2(0x1e0)]((_0x41f114,_0xed7bf0)=>{var _0xf74b70=_0x1634c2;_0x397cdb[_0xed7bf0][_0xf74b70(0x265)]=_0x41f114;}),_0x5a92bc[_0x1634c2(0x1e0)]((_0x87e0fd,_0x380ac0)=>{var _0x499748=_0x1634c2;_0x397cdb[_0x380ac0][_0x499748(0x1ea)]=_0x87e0fd;}),_0x4c5dd7[_0x1634c2(0x1e0)]((_0x2086f7,_0x23881b)=>{_0x397cdb[_0x23881b]['maxperunit']=_0x2086f7;}),_0x156af4[_0x1634c2(0x1e0)]((_0x24d43f,_0xd557a6)=>{_0x397cdb[_0xd557a6]['prod_cat']=_0x24d43f;}),_0x4e9683[_0x1634c2(0x1e0)]((_0x9cbd9a,_0x2e1294)=>{var _0x3a8a91=_0x1634c2;_0x397cdb[_0x2e1294][_0x3a8a91(0x1fd)]=_0x9cbd9a;}),_0x342d85[_0x1634c2(0x1e0)]((_0x3d4943,_0x587943)=>{var _0x401422=_0x1634c2;_0x397cdb[_0x587943][_0x401422(0x231)]=_0x3d4943,_0x397cdb[_0x587943][_0x401422(0x1cd)]=_0x3f36a9;});const _0x2cee73=new invoice_for_outgoing();await _0x2cee73[_0x1634c2(0x1cf)](),_0x342d85[_0x1634c2(0x1e0)]((_0x548726,_0x2dd5a1)=>{var _0x8122fc=_0x1634c2;_0x397cdb[_0x2dd5a1][_0x8122fc(0x266)]=_0x8122fc(0x20e)+_0x2cee73[_0x8122fc(0x1fc)]['toString']()[_0x8122fc(0x244)](0x8,'0');});const _0xdaa7b2=_0x397cdb[_0x1634c2(0x223)](_0x3eb541=>_0x3eb541['quantity']!=='0'&&_0x3eb541[_0x1634c2(0x1ec)]!==''),_0x2ff98d=new sales_finished({'invoice':_0x1634c2(0x20e)+_0x2cee73[_0x1634c2(0x1fc)][_0x1634c2(0x1e7)]()[_0x1634c2(0x244)](0x8,'0'),'date':_0x3f36a9,'warehouse_name':_0x190b9b,'sale_product':_0xdaa7b2,'note':_0x4528d8,'SCRN':_0x19e131,'finalize':_0x1634c2(0x252),'ReqBy':_0x8118c3,'dateofreq':_0x1b3aa0,'PO_number':_0x507874,'typeservicesData':_0x4756db,'typevehicle':_0xa8b942,'destination':_0x398f1b,'deliverydate':_0x59c158,'driver':_0x44c95d,'plate':_0x279dea,'van':_0x56e0fa,'DRSI':_0xe50beb,'TSU':_0x477c96,'TFU':_0x235938}),_0x110d1a=await _0x2ff98d['save'](),_0x4cd858=new Date(),_0x618823=_0x4cd858[_0x1634c2(0x22b)]();_0x21515d[_0x1634c2(0x1ee)]=_0x347bab,_0x21515d[_0x1634c2(0x1d7)]=_0x618823,_0x21515d[_0x1634c2(0x228)]=_0x1634c2(0x20e)+_0x2cee73[_0x1634c2(0x1fc)][_0x1634c2(0x1e7)]()['padStart'](0x8,'0'),_0x21515d[_0x1634c2(0x22e)]=_0x110d1a[_0x1634c2(0x25f)],await _0x21515d[_0x1634c2(0x1cf)]();const _0x18db25=await master_shop[_0x1634c2(0x1e8)](),_0x5f197a=await email_settings[_0x1634c2(0x229)]();let _0x275451=nodemailer[_0x1634c2(0x22f)]({'host':_0x5f197a[_0x1634c2(0x264)],'port':Number(_0x5f197a['port']),'secure':![],'auth':{'user':_0x5f197a[_0x1634c2(0x23e)],'pass':_0x5f197a[_0x1634c2(0x24e)]}});const _0x40c848=_0x24d110[_0x1634c2(0x1db)]+_0x1634c2(0x251)+_0x24d110['headers']['host'];var _0x978207=_0x21515d['sale_product'],_0x4c4169='',_0x365d89,_0x912c0d=0x0;for(_0x365d89 in _0x978207){_0x4c4169+=_0x1634c2(0x21f)+_0x1634c2(0x1d1)+_0x978207[_0x365d89][_0x1634c2(0x1d0)]+_0x1634c2(0x239)+_0x1634c2(0x1d1)+_0x978207[_0x365d89]['product_code']+'</td>'+_0x1634c2(0x1d1)+_0x978207[_0x365d89]['quantity']+_0x1634c2(0x239)+_0x1634c2(0x1d1)+_0x978207[_0x365d89][_0x1634c2(0x216)]+_0x1634c2(0x239)+_0x1634c2(0x226),_0x912c0d+=parseInt(_0x978207[_0x365d89][_0x1634c2(0x1ec)]);}let _0x44f26c={'from':_0x5f197a[_0x1634c2(0x23e)],'to':'christian.villamer@jakagroup.com','subject':'Email\x20for\x20Customer','attachments':[{'filename':_0x1634c2(0x1e4),'path':__dirname+'/../public'+_0x1634c2(0x230)+_0x18db25[0x0]['image'],'cid':_0x1634c2(0x1dc)}],'html':_0x1634c2(0x205)+_0x1634c2(0x214)+_0x1634c2(0x256)+'</head><body>'+_0x1634c2(0x254)+_0x1634c2(0x23d)+_0x1634c2(0x254)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x1634c2(0x254)+_0x1634c2(0x204)+_0x1634c2(0x217)+'</div>'+_0x1634c2(0x261)+_0x1634c2(0x254)+'</div>'+_0x1634c2(0x254)+_0x1634c2(0x20d)+_0x1634c2(0x217)+_0x1634c2(0x254)+_0x1634c2(0x240)+_0x21515d[_0x1634c2(0x231)]+_0x1634c2(0x1f5)+'<span>\x20Request\x20Date:\x20<b>'+_0x21515d[_0x1634c2(0x207)]+_0x1634c2(0x23f)+'</div>'+_0x1634c2(0x258)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1634c2(0x21f)+_0x1634c2(0x224)+_0x1634c2(0x260)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x1634c2(0x226)+'</thead>'+_0x1634c2(0x21d)+'\x20'+_0x4c4169+'\x20'+_0x1634c2(0x1ef)+'</table>'+'<div>'+_0x1634c2(0x22a)+_0x1634c2(0x247)+'<br><br><br>'+_0x1634c2(0x217)+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>\x20JEC\x20SMS\x20</h5>'+_0x1634c2(0x217)+'</div>'+_0x1634c2(0x1d6)+_0x1634c2(0x25e)};_0x275451[_0x1634c2(0x215)](_0x44f26c,function(_0x425a07,_0x41b4dc){var _0x2b1a5c=_0x1634c2;_0x425a07?(console['log'](_0x425a07),console[_0x2b1a5c(0x222)]('Error\x20Occurs')):console[_0x2b1a5c(0x222)](_0x2b1a5c(0x219));}),_0x24d110[_0x1634c2(0x1ce)]('success',_0x1634c2(0x246)),_0x364ddd[_0x1634c2(0x218)](_0x1634c2(0x235)+_0x110d1a[_0x1634c2(0x25f)]),_0x364ddd[_0x1634c2(0x1e6)](_0xdaa7b2);return;}catch(_0x25b904){}}),router['get']('/view_sales_order/:id',auth,async(_0x1dfbd8,_0x32c760)=>{var _0x1d661b=a0_0x1e9634;try{const _0x1fcf5b=await master_shop[_0x1d661b(0x1e8)](),_0x5a583f=_0x1dfbd8[_0x1d661b(0x250)],_0x4069f9=await profile[_0x1d661b(0x229)]({'email':_0x5a583f['email']}),_0x379058=await staff[_0x1d661b(0x229)]({'email':_0x5a583f[_0x1d661b(0x23e)]}),_0x272457=await customer[_0x1d661b(0x1e8)]({'agent_id':_0x379058[_0x1d661b(0x25f)]}),_0x283ffb=mongoose[_0x1d661b(0x1d9)]['ObjectId'],_0x5abf54=_0x1dfbd8['params']['id'],_0x3df356=await sales_order[_0x1d661b(0x234)](_0x5abf54),_0x5cbac2=await sales_order[_0x1d661b(0x25b)]([{'$match':{'_id':_0x283ffb(_0x5abf54)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x1d661b(0x1ff)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x1d661b(0x23b)}}},{'$lookup':{'from':_0x1d661b(0x267),'localField':'accounting_account_id','foreignField':'_id','as':_0x1d661b(0x227)}},{'$unwind':_0x1d661b(0x20a)},{'$lookup':{'from':_0x1d661b(0x267),'localField':_0x1d661b(0x248),'foreignField':_0x1d661b(0x25f),'as':_0x1d661b(0x208)}},{'$unwind':'$wms_data'}]);if(_0x1fcf5b[0x0][_0x1d661b(0x263)]==_0x1d661b(0x25c))var _0x31b599=users[_0x1d661b(0x237)];else{if(_0x1fcf5b[0x0]['language']==_0x1d661b(0x1f7))var _0x31b599=users[_0x1d661b(0x1f7)];else{if(_0x1fcf5b[0x0][_0x1d661b(0x263)]==_0x1d661b(0x245))var _0x31b599=users[_0x1d661b(0x245)];else{if(_0x1fcf5b[0x0]['language']=='Spanish')var _0x31b599=users[_0x1d661b(0x1e5)];else{if(_0x1fcf5b[0x0]['language']==_0x1d661b(0x212))var _0x31b599=users[_0x1d661b(0x212)];else{if(_0x1fcf5b[0x0][_0x1d661b(0x263)]==_0x1d661b(0x1de))var _0x31b599=users[_0x1d661b(0x211)];else{if(_0x1fcf5b[0x0]['language']==_0x1d661b(0x1f6))var _0x31b599=users['Chinese'];else{if(_0x1fcf5b[0x0][_0x1d661b(0x263)]=='Arabic\x20(ae)')var _0x31b599=users[_0x1d661b(0x213)];}}}}}}}_0x32c760['render']('view_accounting_approval',{'success':_0x1dfbd8[_0x1d661b(0x1ce)](_0x1d661b(0x203)),'errors':_0x1dfbd8['flash']('errors'),'master_shop':_0x1fcf5b,'profile':_0x4069f9,'role':_0x5a583f,'language':_0x31b599,'customer':_0x272457,'sales_sa':_0x3df356,'approvers':_0x5cbac2[0x0],'the_id':_0x5abf54});}catch(_0x3cdabc){console[_0x1d661b(0x222)](_0x3cdabc);}}),router['post'](a0_0x1e9634(0x24a),auth,async(_0x51e08e,_0x40a65e)=>{var _0x5c5852=a0_0x1e9634;try{const {warehouse_name:_0x102b89,product_code:_0x560be8}=_0x51e08e[_0x5c5852(0x21b)],_0x2caf36=await warehouse[_0x5c5852(0x25b)]([{'$match':{'name':_0x102b89}},{'$unwind':_0x5c5852(0x242)},{'$match':{'product_details.product_code':_0x560be8}},{'$group':{'_id':{'room':_0x5c5852(0x1df),'_id':_0x5c5852(0x24b)}}}]);_0x40a65e[_0x5c5852(0x1e6)](_0x2caf36);}catch(_0x126108){}}),router[a0_0x1e9634(0x23a)](a0_0x1e9634(0x238),auth,async(_0x67c68f,_0x18fab8)=>{var _0x1b0495=a0_0x1e9634;try{const {warehouse_name:_0x139b66,product_code:_0x232440,room_name:_0x15e926}=_0x67c68f[_0x1b0495(0x21b)];console[_0x1b0495(0x222)](_0x67c68f['body']);const _0x26f783=await warehouse[_0x1b0495(0x25b)]([{'$match':{'name':_0x139b66,'room':_0x15e926}},{'$unwind':_0x1b0495(0x242)},{'$match':{'product_details.product_code':_0x232440}},{'$group':{'_id':{'main_id':'$_id','detl_id':_0x1b0495(0x257),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','level':_0x1b0495(0x1d5),'bay':'$product_details.bay','stocks':'$product_details.product_stock'}}}]);_0x18fab8[_0x1b0495(0x1e6)](_0x26f783);}catch(_0x5c3dad){}}),router[a0_0x1e9634(0x1fa)](a0_0x1e9634(0x1d2),auth,async(_0x4a39f4,_0x5991f3)=>{var _0x225662=a0_0x1e9634;try{const {sttaff_id:_0x46f18a,email:_0x432fbd,warehouse:_0x125da8}=_0x4a39f4[_0x225662(0x250)],_0x2df1a6=await master_shop[_0x225662(0x1e8)](),_0x3bd855=_0x4a39f4[_0x225662(0x250)],_0xb76e5a=await profile['findOne']({'email':_0x3bd855[_0x225662(0x23e)]}),_0x283d52=await sales_order['find']({'wms_account_id':_0x46f18a});if(_0x2df1a6[0x0][_0x225662(0x263)]==_0x225662(0x25c))var _0x1e03f4=users[_0x225662(0x237)];else{if(_0x2df1a6[0x0][_0x225662(0x263)]=='Hindi')var _0x1e03f4=users['Hindi'];else{if(_0x2df1a6[0x0][_0x225662(0x263)]==_0x225662(0x245))var _0x1e03f4=users[_0x225662(0x245)];else{if(_0x2df1a6[0x0]['language']==_0x225662(0x1e5))var _0x1e03f4=users[_0x225662(0x1e5)];else{if(_0x2df1a6[0x0]['language']=='French')var _0x1e03f4=users[_0x225662(0x212)];else{if(_0x2df1a6[0x0]['language']==_0x225662(0x1de))var _0x1e03f4=users[_0x225662(0x211)];else{if(_0x2df1a6[0x0]['language']==_0x225662(0x1f6))var _0x1e03f4=users[_0x225662(0x1f6)];else{if(_0x2df1a6[0x0]['language']==_0x225662(0x1f9))var _0x1e03f4=users[_0x225662(0x213)];}}}}}}}_0x5991f3[_0x225662(0x1f2)](_0x225662(0x25a),{'success':_0x4a39f4[_0x225662(0x1ce)](_0x225662(0x203)),'errors':_0x4a39f4[_0x225662(0x1ce)]('errors'),'master_shop':_0x2df1a6,'profile':_0xb76e5a,'role':_0x3bd855,'language':_0x1e03f4,'sales_order':_0x283d52});}catch(_0x223e48){}}),module[a0_0x1e9634(0x22c)]=router;