var a0_0x45c700=a0_0x4cc9;function a0_0x462e(){var _0x1e3f0a=['1937GImRGr','room_name','$product_details','</b></span>\x20<br><br>','74724DgyAHj','585QevjlQ','logo','Error\x20Occurs','forEach','invoice','data_loc','aggregate','3497291KhGiqq','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_details','findOne','maxPerUnit','prod_cat','/upload/','findById','sendMail','exports','padStart','flash','find','$room','wms_account_confirm','<br><br><br>','<h2>\x20JEC\x20SMS\x20</h2>','../models/all_models','primary_code','<!DOCTYPE\x20html>','12952jWXqXZ','outgoing_invoice','ObjectId','Hindi','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','view_accounting_approval','<span>\x20Request\x20ID:\x20<b>','$wms_account_id','host','user','</tbody>','errors','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<strong>\x20Regards\x20</strong>','/data/All','Spanish','product_code','Portuguese\x20(BR)','room','Arabic\x20(ae)','<tbody\x20style=\x22text-align:\x20center;\x22>','json','staffs','$accounting_account_id','account_data','/:id','stock','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','qty','bay','/data/data_loc','map','date_data','wms_account_id','xlsx','$product_details.bay','split','render','wms_account_date','/../public','$product_details.product_name','params','English','string','createTransport','$wms_data','German','save','prod_id','maxperunit','mongoose','push','warehouse_approval','Types','warehouse_detl','54CqkqUX','../middleware/auth','<table\x20style=\x22width:\x20100%\x20!important;\x22>','nodemailer','redirect','date','$product_details._id','<html><head><title></title>','image','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','French','protocol','quantity','wms_data','</tr>','<hr\x20class=\x22my-3\x22>','/all_sales_finished/preview/','939668fQreCP','372985ZyFTdm','</div>','Arabic','_id','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','</table>','product_cat','10967PgmoSg','headers','invoice_init','unit','success','</td>','990NLwKPT','batch_code','False','length','<tr>','gross_price','</body></html>','Portuguese','$_id','../public/language/languages.json','filter','expiry_date','<div>','$product_details.level','get','OUT-','$account_data','secondary_unit','post','exceljs','English\x20(US)','Email\x20for\x20Customer','product_stock','3EyASuF','log','request_qty','warehouse_id','accounting_account_id','toString','uuid','product_name','language','warehouse_approval_All','</head><body>','/data/data_rack','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','production_date','body','</b></span>\x20<br>','83149EaohYl','66DMGNVt','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'];a0_0x462e=function(){return _0x1e3f0a;};return a0_0x462e();}(function(_0x5697df,_0x5bdf15){var _0xbfb387=a0_0x4cc9,_0xbd39d1=_0x5697df();while(!![]){try{var _0x43633d=-parseInt(_0xbfb387(0xe0))/0x1*(parseInt(_0xbfb387(0x16a))/0x2)+-parseInt(_0xbfb387(0xfd))/0x3*(-parseInt(_0xbfb387(0xd8))/0x4)+-parseInt(_0xbfb387(0xd9))/0x5*(-parseInt(_0xbfb387(0x10f))/0x6)+-parseInt(_0xbfb387(0x11d))/0x7+-parseInt(_0xbfb387(0x131))/0x8*(-parseInt(_0xbfb387(0x116))/0x9)+-parseInt(_0xbfb387(0xe6))/0xa*(parseInt(_0xbfb387(0x10e))/0xb)+parseInt(_0xbfb387(0x115))/0xc*(parseInt(_0xbfb387(0x111))/0xd);if(_0x43633d===_0x5bdf15)break;else _0xbd39d1['push'](_0xbd39d1['shift']());}catch(_0x419ce4){_0xbd39d1['push'](_0xbd39d1['shift']());}}}(a0_0x462e,0x84edf));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x45c700(0x12e)),auth=require(a0_0x45c700(0x16b)),users=require(a0_0x45c700(0xef)),excelJS=require(a0_0x45c700(0xf9)),xlsx=require(a0_0x45c700(0x155)),mongoose=require(a0_0x45c700(0x165)),{ObjectId}=require('mongodb'),nodemailer=require(a0_0x45c700(0x16d));function a0_0x4cc9(_0x2f16cc,_0x35e6d8){var _0x462e36=a0_0x462e();return a0_0x4cc9=function(_0x4cc9ca,_0x197a8d){_0x4cc9ca=_0x4cc9ca-0xd6;var _0x353155=_0x462e36[_0x4cc9ca];return _0x353155;},a0_0x4cc9(_0x2f16cc,_0x35e6d8);}router[a0_0x45c700(0xf4)](a0_0x45c700(0x14c),auth,async(_0xb30b1b,_0x477c48)=>{var _0x6c57f3=a0_0x45c700;try{const _0x1cf52a=await master_shop[_0x6c57f3(0x129)](),_0x30c41a=_0xb30b1b[_0x6c57f3(0x13b)],_0x3a38bc=await profile['findOne']({'email':_0x30c41a['email']}),_0x137b23=await staff[_0x6c57f3(0x120)]({'email':_0x30c41a[_0x6c57f3(0x135)]}),_0x89e0a4=await customer[_0x6c57f3(0x129)]({'agent_id':_0x137b23['_id']}),_0x12e3ab=mongoose[_0x6c57f3(0x168)][_0x6c57f3(0x133)],_0x3c8337=_0xb30b1b[_0x6c57f3(0x15c)]['id'],_0xe59078=await sales_order[_0x6c57f3(0x124)](_0x3c8337),_0x47d1e7=await sales_order[_0x6c57f3(0x11c)]([{'$match':{'_id':_0x12e3ab(_0x3c8337)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x6c57f3(0x14a)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x6c57f3(0x139)}}},{'$lookup':{'from':_0x6c57f3(0x149),'localField':_0x6c57f3(0x101),'foreignField':_0x6c57f3(0xdc),'as':_0x6c57f3(0x14b)}},{'$unwind':_0x6c57f3(0xf6)},{'$lookup':{'from':_0x6c57f3(0x149),'localField':_0x6c57f3(0x154),'foreignField':_0x6c57f3(0xdc),'as':_0x6c57f3(0x177)}},{'$unwind':_0x6c57f3(0x160)}]);if(_0x1cf52a[0x0][_0x6c57f3(0x105)]==_0x6c57f3(0xfa))var _0x528779=users[_0x6c57f3(0x15d)];else{if(_0x1cf52a[0x0][_0x6c57f3(0x105)]=='Hindi')var _0x528779=users[_0x6c57f3(0x134)];else{if(_0x1cf52a[0x0][_0x6c57f3(0x105)]==_0x6c57f3(0x161))var _0x528779=users[_0x6c57f3(0x161)];else{if(_0x1cf52a[0x0]['language']==_0x6c57f3(0x142))var _0x528779=users[_0x6c57f3(0x142)];else{if(_0x1cf52a[0x0][_0x6c57f3(0x105)]==_0x6c57f3(0x174))var _0x528779=users[_0x6c57f3(0x174)];else{if(_0x1cf52a[0x0]['language']==_0x6c57f3(0x144))var _0x528779=users[_0x6c57f3(0xed)];else{if(_0x1cf52a[0x0][_0x6c57f3(0x105)]==_0x6c57f3(0x13e))var _0x528779=users[_0x6c57f3(0x13e)];else{if(_0x1cf52a[0x0][_0x6c57f3(0x105)]==_0x6c57f3(0x146))var _0x528779=users[_0x6c57f3(0xdb)];}}}}}}}_0x477c48[_0x6c57f3(0x158)](_0x6c57f3(0x167),{'success':_0xb30b1b['flash'](_0x6c57f3(0xe4)),'errors':_0xb30b1b[_0x6c57f3(0x128)](_0x6c57f3(0x13d)),'master_shop':_0x1cf52a,'profile':_0x3a38bc,'role':_0x30c41a,'language':_0x528779,'customer':_0x89e0a4,'sales_sa':_0xe59078,'approvers':_0x47d1e7[0x0],'the_id':_0x3c8337});}catch(_0x1f60b0){console[_0x6c57f3(0xfe)](_0x1f60b0);}}),router['post'](a0_0x45c700(0x14c),auth,async(_0x14a7e8,_0x140cf7)=>{var _0x1e449c=a0_0x45c700;try{const {date:_0x2c7cc7,invoice_data:_0x3a7cd8,wms_confirm:_0xf1732e,the_id_val:_0x1f3e9e,prod_id:_0x127f5f,SCRN:_0x3ee4cc,ReqBy:_0x116dbd,dateofreq:_0x1460a2,PO_number:_0x45dce7,warehouse_name:_0x234dae,typeservicesData:_0x37bac7,typevehicle:_0x32d99b,destination:_0x3fec8a,deliverydate:_0x310dd3,driver:_0x1795cf,plate:_0x27abd3,van:_0xb18145,DRSI:_0xfbea5,TSU:_0x5f2977,TFU:_0x5d75a0,note:_0x363e3a}=_0x14a7e8[_0x1e449c(0x10c)],_0x5d418e=await sales_order['findById'](_0x1f3e9e);if(typeof _0x127f5f==_0x1e449c(0x15e))var _0x369bf2=[_0x14a7e8['body'][_0x1e449c(0x163)]],_0xa62df6=[_0x14a7e8[_0x1e449c(0x10c)]['qty']],_0x5ccd8c=[_0x14a7e8['body'][_0x1e449c(0x11b)]];else var _0x369bf2=[..._0x14a7e8[_0x1e449c(0x10c)][_0x1e449c(0x163)]],_0xa62df6=[..._0x14a7e8[_0x1e449c(0x10c)][_0x1e449c(0x14f)]],_0x5ccd8c=[..._0x14a7e8[_0x1e449c(0x10c)][_0x1e449c(0x11b)]];const _0x58a693=_0x369bf2['map'](_0x2aa86f=>{return _0x2aa86f={'prod_id':_0x2aa86f};});_0x5ccd8c[_0x1e449c(0x119)]((_0x3a9442,_0x22ba03)=>{var _0x3a75d5=_0x1e449c,_0x430107=_0x3a9442[_0x3a75d5(0x157)]('~');_0x58a693[_0x22ba03]['warehouse_id']=_0x430107[0x0],_0x58a693[_0x22ba03]['warehouse_detl']=_0x430107[0x1];}),_0xa62df6[_0x1e449c(0x119)]((_0x563928,_0x134e70)=>{var _0x9d42cb=_0x1e449c;_0x58a693[_0x134e70][_0x9d42cb(0xff)]=_0x563928;});var _0x2e5baf=[],_0x1179e9=[],_0x3c08b2=[],_0xd23efa=[],_0x36ec2e=[],_0x593f4e=[],_0x4e6e6f=[],_0x31cbd2=[],_0x10250e=[],_0x31c3bf=[],_0x36140a=[],_0x4886d1=[],_0x41f932=[],_0x4adbf0=[],_0x3a81dd=[],_0x60a81b=[],_0x180811=[],_0x21267a=[],_0x228cc8=[],_0x45e9bd=[];for(let _0x1df742=0x0;_0x1df742<=_0x58a693['length']-0x1;_0x1df742++){const _0x411ec2=_0x58a693[_0x1df742],_0x21ec6e=mongoose[_0x1e449c(0x168)][_0x1e449c(0x133)];var _0x1133c4=await warehouse[_0x1e449c(0x11c)]([{'$match':{'_id':_0x21ec6e(_0x411ec2[_0x1e449c(0x100)])}},{'$unwind':'$product_details'},{'$match':{'product_details._id':_0x21ec6e(_0x411ec2[_0x1e449c(0x169)])}}]),_0x55c64c=0x0;for(let _0x27ded0=0x0;_0x27ded0<=_0x1133c4[_0x1e449c(0xe9)]-0x1;_0x27ded0++){var _0x2fafaa=_0x1133c4[_0x27ded0];_0x2fafaa['product_details']['product_stock']<_0x411ec2['request_qty']&&_0x55c64c++;}if(_0x55c64c>0x0)return _0x14a7e8[_0x1e449c(0x128)](_0x1e449c(0x13d),_0x1e449c(0xdd)),_0x140cf7[_0x1e449c(0x16e)]('back');var _0x2bbdc8=0x0;for(let _0x5e8c38=0x0;_0x5e8c38<=_0x1133c4[_0x1e449c(0xe9)]-0x1;_0x5e8c38++){var _0x2fafaa=_0x1133c4[_0x5e8c38];_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0xfc)]>_0x411ec2[_0x1e449c(0xff)]&&(_0x2e5baf[_0x1e449c(0x166)](_0x2fafaa['product_details'][_0x1e449c(0x104)]),_0x1179e9[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)]['product_stock']),_0x3c08b2[_0x1e449c(0x166)](_0x411ec2['request_qty']),_0xd23efa[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0x12f)]),_0x36ec2e['push'](_0x2fafaa['product_details']['secondary_code']),_0x593f4e[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)]['product_code']),_0x4e6e6f['push'](_0x2fafaa[_0x1e449c(0x11f)]['level']),_0x31cbd2[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0x150)]),_0x10250e['push'](_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0xe3)]),_0x31c3bf[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0xf7)]),_0x36140a[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0xe7)]),_0x4886d1[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)]['expiry_date']),_0x41f932['push'](_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0x10b)]),_0x4adbf0[_0x1e449c(0x166)](_0x2fafaa['product_details'][_0x1e449c(0x121)]),_0x3a81dd['push'](_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0xdf)]),_0x60a81b[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x145)]),_0x180811[_0x1e449c(0x166)](_0x2fafaa['product_details'][_0x1e449c(0x11a)]),_0x21267a[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)]['_id']),_0x228cc8[_0x1e449c(0x166)](_0x2fafaa['product_details'][_0x1e449c(0x103)]),_0x45e9bd[_0x1e449c(0x166)](_0x2fafaa[_0x1e449c(0x11f)][_0x1e449c(0xeb)]),_0x2bbdc8++);}}const _0x3ba2b4=_0x2e5baf[_0x1e449c(0x152)](_0x4426b0=>{return _0x4426b0={'product_name':_0x4426b0};});_0x1179e9[_0x1e449c(0x119)]((_0x480f0e,_0xbc59e9)=>{var _0x211913=_0x1e449c;_0x3ba2b4[_0xbc59e9][_0x211913(0x14d)]=_0x480f0e;}),_0x3c08b2[_0x1e449c(0x119)]((_0x3733ad,_0x297465)=>{_0x3ba2b4[_0x297465]['quantity']=Math['abs'](_0x3733ad);}),_0x45e9bd[_0x1e449c(0x119)]((_0x384596,_0x59d0bf)=>{_0x3ba2b4[_0x59d0bf]['gross_price']=_0x384596;}),_0x228cc8['forEach']((_0x5e2f66,_0x507b0b)=>{var _0x5b4c89=_0x1e449c;_0x3ba2b4[_0x507b0b][_0x5b4c89(0x103)]=_0x5e2f66;}),_0x21267a['forEach']((_0x5c424a,_0x4fe88e)=>{_0x3ba2b4[_0x4fe88e]['id_transaction_from']=_0x5c424a;}),_0xd23efa['forEach']((_0x3ccc62,_0xe899c5)=>{var _0x2068a5=_0x1e449c;_0x3ba2b4[_0xe899c5][_0x2068a5(0x12f)]=_0x3ccc62;}),_0x36ec2e[_0x1e449c(0x119)]((_0x3a0c71,_0x47d4ba)=>{_0x3ba2b4[_0x47d4ba]['secondary_code']=_0x3a0c71;}),_0x593f4e[_0x1e449c(0x119)]((_0xf428b,_0x2cc7a1)=>{var _0x431e0a=_0x1e449c;_0x3ba2b4[_0x2cc7a1][_0x431e0a(0x143)]=_0xf428b;}),_0x4e6e6f[_0x1e449c(0x119)]((_0x39cb6b,_0x533ae2)=>{_0x3ba2b4[_0x533ae2]['level']=_0x39cb6b;}),_0x31cbd2[_0x1e449c(0x119)]((_0x4aef36,_0x19155f)=>{var _0x54317c=_0x1e449c;_0x3ba2b4[_0x19155f][_0x54317c(0x150)]=_0x4aef36;}),_0x10250e['forEach']((_0x1b7490,_0x4f59d7)=>{_0x3ba2b4[_0x4f59d7]['unit']=_0x1b7490;}),_0x31c3bf[_0x1e449c(0x119)]((_0x328502,_0x974a57)=>{_0x3ba2b4[_0x974a57]['secondary_unit']=_0x328502;}),_0x36140a[_0x1e449c(0x119)]((_0x175901,_0x3765be)=>{var _0x2c3136=_0x1e449c;_0x3ba2b4[_0x3765be][_0x2c3136(0xe7)]=_0x175901;}),_0x4886d1[_0x1e449c(0x119)]((_0x5e7f5a,_0x3bc105)=>{var _0x7c53c7=_0x1e449c;_0x3ba2b4[_0x3bc105][_0x7c53c7(0xf1)]=_0x5e7f5a;}),_0x41f932[_0x1e449c(0x119)]((_0x3e436a,_0x2809d4)=>{_0x3ba2b4[_0x2809d4]['production_date']=_0x3e436a;}),_0x4adbf0[_0x1e449c(0x119)]((_0x25d87d,_0x20f41b)=>{var _0x4a9489=_0x1e449c;_0x3ba2b4[_0x20f41b][_0x4a9489(0x164)]=_0x25d87d;}),_0x3a81dd['forEach']((_0x1cbf26,_0x3cabbc)=>{var _0xe7e3a7=_0x1e449c;_0x3ba2b4[_0x3cabbc][_0xe7e3a7(0x122)]=_0x1cbf26;}),_0x60a81b[_0x1e449c(0x119)]((_0x59762b,_0x4a511d)=>{var _0x396b40=_0x1e449c;_0x3ba2b4[_0x4a511d][_0x396b40(0x112)]=_0x59762b;}),_0x180811[_0x1e449c(0x119)]((_0x2a0984,_0x2be97c)=>{var _0x5c1a1e=_0x1e449c;_0x3ba2b4[_0x2be97c][_0x5c1a1e(0x11a)]=_0x2a0984,_0x3ba2b4[_0x2be97c][_0x5c1a1e(0x153)]=_0x2c7cc7;});const _0x3ba439=new invoice_for_outgoing();await _0x3ba439['save'](),_0x180811[_0x1e449c(0x119)]((_0x4be9b4,_0x1e4ab2)=>{var _0x7ff8ea=_0x1e449c;_0x3ba2b4[_0x1e4ab2][_0x7ff8ea(0x132)]='OUT-'+_0x3ba439[_0x7ff8ea(0xe2)][_0x7ff8ea(0x102)]()[_0x7ff8ea(0x127)](0x8,'0');});const _0x585cee=_0x3ba2b4[_0x1e449c(0xf0)](_0x23682f=>_0x23682f[_0x1e449c(0x176)]!=='0'&&_0x23682f[_0x1e449c(0x176)]!==''),_0x8f5ca4=new sales_finished({'invoice':_0x1e449c(0xf5)+_0x3ba439[_0x1e449c(0xe2)][_0x1e449c(0x102)]()[_0x1e449c(0x127)](0x8,'0'),'date':_0x2c7cc7,'warehouse_name':_0x234dae,'sale_product':_0x585cee,'note':_0x363e3a,'SCRN':_0x3ee4cc,'finalize':_0x1e449c(0xe8),'ReqBy':_0x116dbd,'dateofreq':_0x1460a2,'PO_number':_0x45dce7,'typeservicesData':_0x37bac7,'typevehicle':_0x32d99b,'destination':_0x3fec8a,'deliverydate':_0x310dd3,'driver':_0x1795cf,'plate':_0x27abd3,'van':_0xb18145,'DRSI':_0xfbea5,'TSU':_0x5f2977,'TFU':_0x5d75a0}),_0x4e9133=await _0x8f5ca4['save'](),_0xc80bc7=new Date(),_0x427480=_0xc80bc7['toLocaleDateString']();_0x5d418e[_0x1e449c(0x12b)]=_0xf1732e,_0x5d418e[_0x1e449c(0x159)]=_0x427480,_0x5d418e['document_number_out']=_0x1e449c(0xf5)+_0x3ba439['invoice_init'][_0x1e449c(0x102)]()[_0x1e449c(0x127)](0x8,'0'),_0x5d418e['outgoing_id']=_0x4e9133['_id'],await _0x5d418e[_0x1e449c(0x162)]();const _0x4af1b5=await master_shop[_0x1e449c(0x129)](),_0x41579a=await email_settings['findOne']();let _0x55fe0c=nodemailer[_0x1e449c(0x15f)]({'host':_0x41579a[_0x1e449c(0x13a)],'port':Number(_0x41579a['port']),'secure':![],'auth':{'user':_0x41579a['email'],'pass':_0x41579a['password']}});const _0x270e2a=_0x14a7e8[_0x1e449c(0x175)]+'://'+_0x14a7e8[_0x1e449c(0xe1)][_0x1e449c(0x13a)];var _0x376bf4=_0x5d418e['sale_product'],_0x309ba9='',_0x5d057d,_0x464f3a=0x0;for(_0x5d057d in _0x376bf4){_0x309ba9+=_0x1e449c(0xea)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x376bf4[_0x5d057d][_0x1e449c(0x104)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x376bf4[_0x5d057d]['product_code']+'</td>'+_0x1e449c(0x11e)+_0x376bf4[_0x5d057d][_0x1e449c(0x176)]+_0x1e449c(0xe5)+_0x1e449c(0x11e)+_0x376bf4[_0x5d057d][_0x1e449c(0xe3)]+_0x1e449c(0xe5)+_0x1e449c(0x178),_0x464f3a+=parseInt(_0x376bf4[_0x5d057d][_0x1e449c(0x176)]);}let _0x2b0967={'from':_0x41579a[_0x1e449c(0x135)],'to':'christian.villamer@jakagroup.com','subject':_0x1e449c(0xfb),'attachments':[{'filename':'Logo.png','path':__dirname+_0x1e449c(0x15a)+_0x1e449c(0x123)+_0x4af1b5[0x0][_0x1e449c(0x172)],'cid':_0x1e449c(0x117)}],'html':_0x1e449c(0x130)+_0x1e449c(0x171)+_0x1e449c(0x14e)+_0x1e449c(0x107)+_0x1e449c(0xf2)+_0x1e449c(0x10a)+_0x1e449c(0xf2)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1e449c(0xda)+_0x1e449c(0xf2)+_0x1e449c(0x12d)+_0x1e449c(0xda)+'</div>'+_0x1e449c(0xd6)+_0x1e449c(0xf2)+_0x1e449c(0xda)+_0x1e449c(0xf2)+'<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>'+_0x1e449c(0xda)+_0x1e449c(0xf2)+_0x1e449c(0x138)+_0x5d418e[_0x1e449c(0x11a)]+_0x1e449c(0x10d)+'<span>\x20Request\x20Date:\x20<b>'+_0x5d418e[_0x1e449c(0x16f)]+_0x1e449c(0x114)+_0x1e449c(0xda)+_0x1e449c(0x16c)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x1e449c(0x13f)+_0x1e449c(0x136)+_0x1e449c(0x110)+'</tr>'+'</thead>'+_0x1e449c(0x147)+'\x20'+_0x309ba9+'\x20'+_0x1e449c(0x13c)+_0x1e449c(0xde)+_0x1e449c(0xf2)+_0x1e449c(0x173)+_0x1e449c(0x109)+_0x1e449c(0x12c)+_0x1e449c(0xda)+_0x1e449c(0xf2)+_0x1e449c(0x140)+'<h5>\x20JEC\x20SMS\x20</h5>'+'</div>'+_0x1e449c(0xda)+'<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>'+_0x1e449c(0xec)};_0x55fe0c[_0x1e449c(0x125)](_0x2b0967,function(_0x1cd114,_0x2b1eeb){var _0x1dcc09=_0x1e449c;_0x1cd114?(console[_0x1dcc09(0xfe)](_0x1cd114),console['log'](_0x1dcc09(0x118))):console['log']('Email\x20sent\x20successfully');}),_0x14a7e8[_0x1e449c(0x128)](_0x1e449c(0xe4),'Sales\x20Add\x20successfully'),_0x140cf7[_0x1e449c(0x16e)](_0x1e449c(0xd7)+_0x4e9133[_0x1e449c(0xdc)]),_0x140cf7[_0x1e449c(0x148)](_0x585cee);return;}catch(_0x4dcd62){}}),router[a0_0x45c700(0xf4)]('/view_sales_order/:id',auth,async(_0x57c51a,_0x28116a)=>{var _0x172b61=a0_0x45c700;try{const _0x16aac1=await master_shop['find'](),_0x53c46b=_0x57c51a['user'],_0x54dcc9=await profile[_0x172b61(0x120)]({'email':_0x53c46b[_0x172b61(0x135)]}),_0x5f595f=await staff['findOne']({'email':_0x53c46b[_0x172b61(0x135)]}),_0x3ed183=await customer[_0x172b61(0x129)]({'agent_id':_0x5f595f[_0x172b61(0xdc)]}),_0x44887c=mongoose['Types'][_0x172b61(0x133)],_0xeb0a8e=_0x57c51a[_0x172b61(0x15c)]['id'],_0x567300=await sales_order[_0x172b61(0x124)](_0xeb0a8e),_0x2541db=await sales_order['aggregate']([{'$match':{'_id':_0x44887c(_0xeb0a8e)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x172b61(0x14a)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x172b61(0x139)}}},{'$lookup':{'from':'staffs','localField':_0x172b61(0x101),'foreignField':'_id','as':_0x172b61(0x14b)}},{'$unwind':'$account_data'},{'$lookup':{'from':_0x172b61(0x149),'localField':'wms_account_id','foreignField':_0x172b61(0xdc),'as':_0x172b61(0x177)}},{'$unwind':'$wms_data'}]);if(_0x16aac1[0x0][_0x172b61(0x105)]==_0x172b61(0xfa))var _0x3d8683=users['English'];else{if(_0x16aac1[0x0][_0x172b61(0x105)]=='Hindi')var _0x3d8683=users['Hindi'];else{if(_0x16aac1[0x0][_0x172b61(0x105)]==_0x172b61(0x161))var _0x3d8683=users[_0x172b61(0x161)];else{if(_0x16aac1[0x0][_0x172b61(0x105)]==_0x172b61(0x142))var _0x3d8683=users[_0x172b61(0x142)];else{if(_0x16aac1[0x0][_0x172b61(0x105)]==_0x172b61(0x174))var _0x3d8683=users[_0x172b61(0x174)];else{if(_0x16aac1[0x0][_0x172b61(0x105)]==_0x172b61(0x144))var _0x3d8683=users[_0x172b61(0xed)];else{if(_0x16aac1[0x0][_0x172b61(0x105)]==_0x172b61(0x13e))var _0x3d8683=users[_0x172b61(0x13e)];else{if(_0x16aac1[0x0][_0x172b61(0x105)]==_0x172b61(0x146))var _0x3d8683=users[_0x172b61(0xdb)];}}}}}}}_0x28116a['render'](_0x172b61(0x137),{'success':_0x57c51a[_0x172b61(0x128)](_0x172b61(0xe4)),'errors':_0x57c51a[_0x172b61(0x128)](_0x172b61(0x13d)),'master_shop':_0x16aac1,'profile':_0x54dcc9,'role':_0x53c46b,'language':_0x3d8683,'customer':_0x3ed183,'sales_sa':_0x567300,'approvers':_0x2541db[0x0],'the_id':_0xeb0a8e});}catch(_0x2b2497){console[_0x172b61(0xfe)](_0x2b2497);}}),router[a0_0x45c700(0xf8)](a0_0x45c700(0x108),auth,async(_0x252156,_0x214d2e)=>{var _0x461f0c=a0_0x45c700;try{const {warehouse_name:_0x4e8b03,product_code:_0x21caad}=_0x252156['body'],_0x742b6c=await warehouse[_0x461f0c(0x11c)]([{'$match':{'name':_0x4e8b03}},{'$unwind':_0x461f0c(0x113)},{'$match':{'product_details.product_code':_0x21caad}},{'$group':{'_id':{'room':_0x461f0c(0x12a),'_id':_0x461f0c(0xee)}}}]);_0x214d2e[_0x461f0c(0x148)](_0x742b6c);}catch(_0x45e285){}}),router[a0_0x45c700(0xf8)](a0_0x45c700(0x151),auth,async(_0x5050ac,_0x54a102)=>{var _0x51e20a=a0_0x45c700;try{const {warehouse_name:_0x167d84,product_code:_0x5ce782,room_name:_0x50b143}=_0x5050ac[_0x51e20a(0x10c)];console[_0x51e20a(0xfe)](_0x5050ac[_0x51e20a(0x10c)]);const _0x365214=await warehouse[_0x51e20a(0x11c)]([{'$match':{'name':_0x167d84,'room':_0x50b143}},{'$unwind':_0x51e20a(0x113)},{'$match':{'product_details.product_code':_0x5ce782}},{'$group':{'_id':{'main_id':'$_id','detl_id':_0x51e20a(0x170),'product_name':_0x51e20a(0x15b),'product_code':'$product_details.product_code','level':_0x51e20a(0xf3),'bay':_0x51e20a(0x156),'stocks':'$product_details.product_stock'}}}]);_0x54a102['json'](_0x365214);}catch(_0x1b9995){}}),router[a0_0x45c700(0xf4)](a0_0x45c700(0x141),auth,async(_0x496afc,_0x3dc7f7)=>{var _0xbd2d01=a0_0x45c700;try{const {sttaff_id:_0x323527,email:_0x437deb,warehouse:_0x410a81}=_0x496afc[_0xbd2d01(0x13b)],_0x341dc2=await master_shop[_0xbd2d01(0x129)](),_0x5a0158=_0x496afc['user'],_0x186ab2=await profile[_0xbd2d01(0x120)]({'email':_0x5a0158[_0xbd2d01(0x135)]}),_0x2a08fa=await sales_order[_0xbd2d01(0x129)]({'wms_account_id':_0x323527});if(_0x341dc2[0x0][_0xbd2d01(0x105)]==_0xbd2d01(0xfa))var _0x3d570d=users[_0xbd2d01(0x15d)];else{if(_0x341dc2[0x0][_0xbd2d01(0x105)]==_0xbd2d01(0x134))var _0x3d570d=users[_0xbd2d01(0x134)];else{if(_0x341dc2[0x0]['language']==_0xbd2d01(0x161))var _0x3d570d=users[_0xbd2d01(0x161)];else{if(_0x341dc2[0x0][_0xbd2d01(0x105)]=='Spanish')var _0x3d570d=users['Spanish'];else{if(_0x341dc2[0x0][_0xbd2d01(0x105)]=='French')var _0x3d570d=users[_0xbd2d01(0x174)];else{if(_0x341dc2[0x0][_0xbd2d01(0x105)]==_0xbd2d01(0x144))var _0x3d570d=users[_0xbd2d01(0xed)];else{if(_0x341dc2[0x0][_0xbd2d01(0x105)]=='Chinese')var _0x3d570d=users[_0xbd2d01(0x13e)];else{if(_0x341dc2[0x0][_0xbd2d01(0x105)]==_0xbd2d01(0x146))var _0x3d570d=users[_0xbd2d01(0xdb)];}}}}}}}_0x3dc7f7[_0xbd2d01(0x158)](_0xbd2d01(0x106),{'success':_0x496afc[_0xbd2d01(0x128)](_0xbd2d01(0xe4)),'errors':_0x496afc[_0xbd2d01(0x128)](_0xbd2d01(0x13d)),'master_shop':_0x341dc2,'profile':_0x186ab2,'role':_0x5a0158,'language':_0x3d570d,'sales_order':_0x2a08fa});}catch(_0x7881fe){}}),module[a0_0x45c700(0x126)]=router;