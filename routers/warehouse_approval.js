var a0_0x5d2827=a0_0x2f61;(function(_0x4d4ed0,_0x1a3dd3){var _0x5ede21=a0_0x2f61,_0x3d206c=_0x4d4ed0();while(!![]){try{var _0x138c98=parseInt(_0x5ede21(0x27a))/0x1*(-parseInt(_0x5ede21(0x267))/0x2)+-parseInt(_0x5ede21(0x255))/0x3*(-parseInt(_0x5ede21(0x1ff))/0x4)+parseInt(_0x5ede21(0x244))/0x5*(-parseInt(_0x5ede21(0x1fd))/0x6)+-parseInt(_0x5ede21(0x1f8))/0x7+-parseInt(_0x5ede21(0x27e))/0x8+-parseInt(_0x5ede21(0x208))/0x9+parseInt(_0x5ede21(0x25e))/0xa;if(_0x138c98===_0x1a3dd3)break;else _0x3d206c['push'](_0x3d206c['shift']());}catch(_0x5a3532){_0x3d206c['push'](_0x3d206c['shift']());}}}(a0_0x42a8,0x5535c));const express=require(a0_0x5d2827(0x257)),app=express(),router=express[a0_0x5d2827(0x218)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x5d2827(0x24e)),auth=require(a0_0x5d2827(0x279)),users=require(a0_0x5d2827(0x242)),excelJS=require('exceljs'),xlsx=require(a0_0x5d2827(0x260)),mongoose=require(a0_0x5d2827(0x288)),{ObjectId}=require('mongodb'),nodemailer=require(a0_0x5d2827(0x24a));router[a0_0x5d2827(0x20e)](a0_0x5d2827(0x240),auth,async(_0x41a183,_0x47da4d)=>{var _0x366ffe=a0_0x5d2827;try{const _0x429e8e=await master_shop[_0x366ffe(0x270)](),_0x222857=_0x41a183['user'],_0x17a522=await profile[_0x366ffe(0x239)]({'email':_0x222857[_0x366ffe(0x216)]}),_0x19b47b=await staff[_0x366ffe(0x239)]({'email':_0x222857['email']}),_0x12ebd8=await customer[_0x366ffe(0x270)]({'agent_id':_0x19b47b[_0x366ffe(0x28a)]}),_0x12dcab=mongoose[_0x366ffe(0x220)][_0x366ffe(0x21a)],_0x3860e0=_0x41a183[_0x366ffe(0x25a)]['id'],_0x351739=await sales_order[_0x366ffe(0x21f)](_0x3860e0),_0x17d5b4=await sales_order[_0x366ffe(0x212)]([{'$match':{'_id':_0x12dcab(_0x3860e0)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x366ffe(0x21d)}}},{'$addFields':{'wms_account_id':{'$toObjectId':'$wms_account_id'}}},{'$lookup':{'from':_0x366ffe(0x206),'localField':_0x366ffe(0x229),'foreignField':_0x366ffe(0x28a),'as':_0x366ffe(0x1f7)}},{'$unwind':_0x366ffe(0x234)},{'$lookup':{'from':_0x366ffe(0x206),'localField':_0x366ffe(0x26f),'foreignField':'_id','as':'wms_data'}},{'$unwind':_0x366ffe(0x247)}]);if(_0x429e8e[0x0][_0x366ffe(0x21e)]==_0x366ffe(0x227))var _0x288cb3=users['English'];else{if(_0x429e8e[0x0][_0x366ffe(0x21e)]=='Hindi')var _0x288cb3=users[_0x366ffe(0x265)];else{if(_0x429e8e[0x0]['language']==_0x366ffe(0x245))var _0x288cb3=users[_0x366ffe(0x245)];else{if(_0x429e8e[0x0][_0x366ffe(0x21e)]==_0x366ffe(0x1fe))var _0x288cb3=users['Spanish'];else{if(_0x429e8e[0x0]['language']==_0x366ffe(0x26a))var _0x288cb3=users[_0x366ffe(0x26a)];else{if(_0x429e8e[0x0][_0x366ffe(0x21e)]==_0x366ffe(0x233))var _0x288cb3=users[_0x366ffe(0x20a)];else{if(_0x429e8e[0x0][_0x366ffe(0x21e)]==_0x366ffe(0x282))var _0x288cb3=users[_0x366ffe(0x282)];else{if(_0x429e8e[0x0][_0x366ffe(0x21e)]==_0x366ffe(0x209))var _0x288cb3=users[_0x366ffe(0x228)];}}}}}}}_0x47da4d[_0x366ffe(0x28d)]('warehouse_approval',{'success':_0x41a183['flash'](_0x366ffe(0x1f4)),'errors':_0x41a183[_0x366ffe(0x224)](_0x366ffe(0x22a)),'master_shop':_0x429e8e,'profile':_0x17a522,'role':_0x222857,'language':_0x288cb3,'customer':_0x12ebd8,'sales_sa':_0x351739,'approvers':_0x17d5b4[0x0],'the_id':_0x3860e0});}catch(_0x9d6ec0){console[_0x366ffe(0x26b)](_0x9d6ec0);}}),router[a0_0x5d2827(0x259)](a0_0x5d2827(0x240),auth,async(_0x23d328,_0x2b8d4c)=>{var _0x213875=a0_0x5d2827;try{const {date:_0x4cd666,invoice_data:_0x312ea9,wms_confirm:_0x5c46a3,the_id_val:_0x491dc3,prod_id:_0x3a75a5,SCRN:_0x16784c,ReqBy:_0x18430d,dateofreq:_0x3b7d71,PO_number:_0x11df90,warehouse_name:_0x4c6df1,typeservicesData:_0x3363ed,typevehicle:_0x15cde3,destination:_0x85b9a6,deliverydate:_0x5db1ba,driver:_0x28e29c,plate:_0x1d28d4,van:_0x254259,DRSI:_0x4ef518,TSU:_0x1f78dd,TFU:_0x214208,note:_0x4cc969}=_0x23d328[_0x213875(0x221)],_0x1cdb69=await sales_order[_0x213875(0x21f)](_0x491dc3);if(typeof _0x3a75a5=='string')var _0x39c79b=[_0x23d328[_0x213875(0x221)][_0x213875(0x22b)]],_0x580c40=[_0x23d328[_0x213875(0x221)][_0x213875(0x200)]],_0x212b6c=[_0x23d328['body'][_0x213875(0x258)]];else var _0x39c79b=[..._0x23d328[_0x213875(0x221)]['prod_id']],_0x580c40=[..._0x23d328[_0x213875(0x221)][_0x213875(0x200)]],_0x212b6c=[..._0x23d328[_0x213875(0x221)][_0x213875(0x258)]];const _0x34f52c=_0x39c79b[_0x213875(0x223)](_0x398a8d=>{return _0x398a8d={'prod_id':_0x398a8d};});_0x212b6c[_0x213875(0x287)]((_0x542b5c,_0x52da7f)=>{var _0x4e78dc=_0x542b5c['split']('~');_0x34f52c[_0x52da7f]['warehouse_id']=_0x4e78dc[0x0],_0x34f52c[_0x52da7f]['warehouse_detl']=_0x4e78dc[0x1];}),_0x580c40[_0x213875(0x287)]((_0xf40cad,_0x39ed39)=>{var _0x498c67=_0x213875;_0x34f52c[_0x39ed39][_0x498c67(0x205)]=_0xf40cad;});var _0x5f21e1=[],_0x547128=[],_0x297615=[],_0x1294d2=[],_0x4823ea=[],_0x29f9ca=[],_0x374c2c=[],_0x9b01a1=[],_0x1a5477=[],_0x19a307=[],_0x4ff7e1=[],_0x3e0c83=[],_0x3a4242=[],_0x3e2ece=[],_0x2d57d9=[],_0x328a72=[],_0x5bc716=[],_0x7f8add=[],_0x53223d=[],_0x286cf3=[];for(let _0x22a66b=0x0;_0x22a66b<=_0x34f52c['length']-0x1;_0x22a66b++){const _0x2ac33b=_0x34f52c[_0x22a66b],_0x12e2c0=mongoose[_0x213875(0x220)][_0x213875(0x21a)];var _0x3a48b6=await warehouse[_0x213875(0x212)]([{'$match':{'_id':_0x12e2c0(_0x2ac33b[_0x213875(0x22d)])}},{'$unwind':_0x213875(0x252)},{'$match':{'product_details._id':_0x12e2c0(_0x2ac33b[_0x213875(0x23d)])}}]),_0x4823ca=0x0;for(let _0x1ea8d8=0x0;_0x1ea8d8<=_0x3a48b6[_0x213875(0x23e)]-0x1;_0x1ea8d8++){var _0x3afe66=_0x3a48b6[_0x1ea8d8];_0x3afe66[_0x213875(0x253)][_0x213875(0x261)]<_0x2ac33b['request_qty']&&_0x4823ca++;}if(_0x4823ca>0x0)return _0x23d328[_0x213875(0x224)](_0x213875(0x22a),_0x213875(0x232)),_0x2b8d4c[_0x213875(0x26c)](_0x213875(0x1f3));var _0x5e250a=0x0;for(let _0x4a03d0=0x0;_0x4a03d0<=_0x3a48b6[_0x213875(0x23e)]-0x1;_0x4a03d0++){var _0x3afe66=_0x3a48b6[_0x4a03d0];_0x3afe66['product_details'][_0x213875(0x261)]>_0x2ac33b[_0x213875(0x205)]&&(_0x5f21e1[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)][_0x213875(0x241)]),_0x547128[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)][_0x213875(0x261)]),_0x297615[_0x213875(0x25f)](_0x2ac33b['request_qty']),_0x1294d2['push'](_0x3afe66[_0x213875(0x253)][_0x213875(0x23b)]),_0x4823ea[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)]['secondary_code']),_0x29f9ca[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)][_0x213875(0x25b)]),_0x374c2c[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)][_0x213875(0x283)]),_0x9b01a1[_0x213875(0x25f)](_0x3afe66['product_details'][_0x213875(0x222)]),_0x1a5477[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)][_0x213875(0x254)]),_0x19a307[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)][_0x213875(0x271)]),_0x4ff7e1[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)]['batch_code']),_0x3e0c83['push'](_0x3afe66[_0x213875(0x253)][_0x213875(0x25d)]),_0x3a4242[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)][_0x213875(0x225)]),_0x3e2ece[_0x213875(0x25f)](_0x3afe66['product_details'][_0x213875(0x214)]),_0x2d57d9[_0x213875(0x25f)](_0x3afe66['product_details'][_0x213875(0x280)]),_0x328a72['push'](_0x3afe66['room']),_0x5bc716[_0x213875(0x25f)](_0x3afe66['product_details'][_0x213875(0x1f9)]),_0x7f8add['push'](_0x3afe66[_0x213875(0x253)][_0x213875(0x28a)]),_0x53223d[_0x213875(0x25f)](_0x3afe66['product_details'][_0x213875(0x243)]),_0x286cf3[_0x213875(0x25f)](_0x3afe66[_0x213875(0x253)][_0x213875(0x263)]),_0x5e250a++);}}const _0x1a4ba4=_0x5f21e1[_0x213875(0x223)](_0xb88df7=>{return _0xb88df7={'product_name':_0xb88df7};});_0x547128[_0x213875(0x287)]((_0xaeae3c,_0x23566d)=>{var _0x5539ec=_0x213875;_0x1a4ba4[_0x23566d][_0x5539ec(0x21b)]=_0xaeae3c;}),_0x297615[_0x213875(0x287)]((_0x45d241,_0x4fdcc7)=>{var _0x532838=_0x213875;_0x1a4ba4[_0x4fdcc7]['quantity']=Math[_0x532838(0x25c)](_0x45d241);}),_0x286cf3[_0x213875(0x287)]((_0x1b18c8,_0x1bf8a7)=>{_0x1a4ba4[_0x1bf8a7]['gross_price']=_0x1b18c8;}),_0x53223d[_0x213875(0x287)]((_0x114af2,_0x549fd5)=>{var _0x241f0b=_0x213875;_0x1a4ba4[_0x549fd5][_0x241f0b(0x243)]=_0x114af2;}),_0x7f8add[_0x213875(0x287)]((_0x405fe8,_0x479afc)=>{var _0x2ee84c=_0x213875;_0x1a4ba4[_0x479afc][_0x2ee84c(0x276)]=_0x405fe8;}),_0x1294d2[_0x213875(0x287)]((_0x57b3ab,_0x4dc7d8)=>{_0x1a4ba4[_0x4dc7d8]['primary_code']=_0x57b3ab;}),_0x4823ea[_0x213875(0x287)]((_0x52a2b1,_0x3cbc16)=>{_0x1a4ba4[_0x3cbc16]['secondary_code']=_0x52a2b1;}),_0x29f9ca[_0x213875(0x287)]((_0x5008cb,_0x3bd378)=>{var _0x4d8918=_0x213875;_0x1a4ba4[_0x3bd378][_0x4d8918(0x25b)]=_0x5008cb;}),_0x374c2c[_0x213875(0x287)]((_0x3102fc,_0x119200)=>{var _0x4bd775=_0x213875;_0x1a4ba4[_0x119200][_0x4bd775(0x283)]=_0x3102fc;}),_0x9b01a1[_0x213875(0x287)]((_0x4a77ad,_0x56c1ee)=>{var _0x11da33=_0x213875;_0x1a4ba4[_0x56c1ee][_0x11da33(0x222)]=_0x4a77ad;}),_0x1a5477['forEach']((_0x2db19f,_0x3d74c2)=>{var _0x32c391=_0x213875;_0x1a4ba4[_0x3d74c2][_0x32c391(0x254)]=_0x2db19f;}),_0x19a307[_0x213875(0x287)]((_0x31a3fa,_0x4808a1)=>{var _0x492007=_0x213875;_0x1a4ba4[_0x4808a1][_0x492007(0x271)]=_0x31a3fa;}),_0x4ff7e1[_0x213875(0x287)]((_0x47c94d,_0x1f0aa7)=>{var _0x19fe4a=_0x213875;_0x1a4ba4[_0x1f0aa7][_0x19fe4a(0x1f1)]=_0x47c94d;}),_0x3e0c83[_0x213875(0x287)]((_0x16fdc4,_0x23f702)=>{_0x1a4ba4[_0x23f702]['expiry_date']=_0x16fdc4;}),_0x3a4242[_0x213875(0x287)]((_0x500392,_0x2d59a6)=>{_0x1a4ba4[_0x2d59a6]['production_date']=_0x500392;}),_0x3e2ece['forEach']((_0x3371af,_0x35a013)=>{_0x1a4ba4[_0x35a013]['maxperunit']=_0x3371af;}),_0x2d57d9[_0x213875(0x287)]((_0x19d869,_0x4705ed)=>{var _0x441bdb=_0x213875;_0x1a4ba4[_0x4705ed][_0x441bdb(0x1fc)]=_0x19d869;}),_0x328a72[_0x213875(0x287)]((_0x3083c8,_0x50f4d4)=>{var _0x28dbca=_0x213875;_0x1a4ba4[_0x50f4d4][_0x28dbca(0x24f)]=_0x3083c8;}),_0x5bc716['forEach']((_0x40bf29,_0x5e7d19)=>{var _0x3ce258=_0x213875;_0x1a4ba4[_0x5e7d19][_0x3ce258(0x1f9)]=_0x40bf29,_0x1a4ba4[_0x5e7d19][_0x3ce258(0x273)]=_0x4cd666;});const _0x375bf6=new invoice_for_outgoing();await _0x375bf6[_0x213875(0x249)](),_0x5bc716['forEach']((_0x25ba06,_0x1d7c12)=>{var _0x4e43fe=_0x213875;_0x1a4ba4[_0x1d7c12][_0x4e43fe(0x20d)]=_0x4e43fe(0x26d)+_0x375bf6['invoice_init']['toString']()[_0x4e43fe(0x27d)](0x8,'0');});const _0xb1c457=_0x1a4ba4['filter'](_0x537ce8=>_0x537ce8[_0x213875(0x284)]!=='0'&&_0x537ce8[_0x213875(0x284)]!==''),_0x49ee8c=new sales_finished({'invoice':_0x213875(0x26d)+_0x375bf6[_0x213875(0x278)][_0x213875(0x22e)]()[_0x213875(0x27d)](0x8,'0'),'date':_0x4cd666,'warehouse_name':_0x4c6df1,'sale_product':_0xb1c457,'note':_0x4cc969,'SCRN':_0x16784c,'finalize':'False','ReqBy':_0x18430d,'dateofreq':_0x3b7d71,'PO_number':_0x11df90,'typeservicesData':_0x3363ed,'typevehicle':_0x15cde3,'destination':_0x85b9a6,'deliverydate':_0x5db1ba,'driver':_0x28e29c,'plate':_0x1d28d4,'van':_0x254259,'DRSI':_0x4ef518,'TSU':_0x1f78dd,'TFU':_0x214208}),_0x288169=await _0x49ee8c[_0x213875(0x249)](),_0x533717=new Date(),_0x1719e2=_0x533717['toLocaleDateString']();_0x1cdb69[_0x213875(0x262)]=_0x5c46a3,_0x1cdb69[_0x213875(0x210)]=_0x1719e2,_0x1cdb69['document_number_out']=_0x213875(0x26d)+_0x375bf6[_0x213875(0x278)][_0x213875(0x22e)]()[_0x213875(0x27d)](0x8,'0'),_0x1cdb69['outgoing_id']=_0x288169[_0x213875(0x28a)],await _0x1cdb69[_0x213875(0x249)]();const _0x1a4a85=await master_shop['find'](),_0x1a7899=await email_settings[_0x213875(0x239)]();let _0x5a17fa=nodemailer['createTransport']({'host':_0x1a7899[_0x213875(0x231)],'port':Number(_0x1a7899[_0x213875(0x27f)]),'secure':![],'auth':{'user':_0x1a7899[_0x213875(0x216)],'pass':_0x1a7899[_0x213875(0x285)]}});const _0x53e873=_0x23d328[_0x213875(0x1ee)]+_0x213875(0x250)+_0x23d328[_0x213875(0x251)][_0x213875(0x231)];var _0x5b607c=_0x1cdb69[_0x213875(0x1fb)],_0x336adc='',_0x2fabe0,_0x5789b4=0x0;for(_0x2fabe0 in _0x5b607c){_0x336adc+=_0x213875(0x1f6)+_0x213875(0x203)+_0x5b607c[_0x2fabe0][_0x213875(0x241)]+_0x213875(0x272)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5b607c[_0x2fabe0][_0x213875(0x25b)]+_0x213875(0x272)+_0x213875(0x203)+_0x5b607c[_0x2fabe0][_0x213875(0x284)]+'</td>'+_0x213875(0x203)+_0x5b607c[_0x2fabe0][_0x213875(0x254)]+_0x213875(0x272)+_0x213875(0x20f),_0x5789b4+=parseInt(_0x5b607c[_0x2fabe0][_0x213875(0x284)]);}let _0xf3b592={'from':_0x1a7899[_0x213875(0x216)],'to':_0x213875(0x219),'subject':_0x213875(0x23c),'attachments':[{'filename':_0x213875(0x246),'path':__dirname+_0x213875(0x201)+_0x213875(0x204)+_0x1a4a85[0x0][_0x213875(0x20c)],'cid':_0x213875(0x274)}],'html':_0x213875(0x207)+'<html><head><title></title>'+'<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>'+'</head><body>'+'<div>'+_0x213875(0x266)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x213875(0x23a)+_0x213875(0x1f0)+_0x213875(0x268)+'</div>'+_0x213875(0x23a)+_0x213875(0x27b)+_0x213875(0x1f0)+_0x213875(0x23a)+_0x213875(0x1f0)+_0x213875(0x20b)+_0x213875(0x23a)+_0x213875(0x1f0)+_0x213875(0x202)+_0x1cdb69[_0x213875(0x1f9)]+_0x213875(0x1f2)+_0x213875(0x217)+_0x1cdb69[_0x213875(0x213)]+_0x213875(0x27c)+'</div>'+_0x213875(0x264)+_0x213875(0x24d)+_0x213875(0x1f6)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x213875(0x277)+_0x213875(0x226)+_0x213875(0x22c)+'</tr>'+'</thead>'+_0x213875(0x215)+'\x20'+_0x336adc+'\x20'+_0x213875(0x22f)+_0x213875(0x230)+_0x213875(0x1f0)+'<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>'+_0x213875(0x237)+_0x213875(0x236)+'</div>'+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x213875(0x281)+_0x213875(0x23a)+_0x213875(0x23a)+'<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>'+_0x213875(0x21c)};_0x5a17fa['sendMail'](_0xf3b592,function(_0x51a561,_0x190eb4){var _0x38fc39=_0x213875;_0x51a561?(console[_0x38fc39(0x26b)](_0x51a561),console['log']('Error\x20Occurs')):console[_0x38fc39(0x26b)](_0x38fc39(0x286));}),_0x23d328[_0x213875(0x224)](_0x213875(0x1f4),_0x213875(0x1f5)),_0x2b8d4c[_0x213875(0x26c)](_0x213875(0x24b)+_0x288169[_0x213875(0x28a)]),_0x2b8d4c[_0x213875(0x248)](_0xb1c457);return;}catch(_0x4063ea){}}),router['get']('/view_sales_order/:id',auth,async(_0x300a9b,_0x4e239c)=>{var _0x36b7a2=a0_0x5d2827;try{const _0x4b7550=await master_shop['find'](),_0x338b11=_0x300a9b['user'],_0x2f947e=await profile[_0x36b7a2(0x239)]({'email':_0x338b11[_0x36b7a2(0x216)]}),_0x226997=await staff[_0x36b7a2(0x239)]({'email':_0x338b11[_0x36b7a2(0x216)]}),_0x181ccc=await customer[_0x36b7a2(0x270)]({'agent_id':_0x226997[_0x36b7a2(0x28a)]}),_0x3ec051=mongoose[_0x36b7a2(0x220)][_0x36b7a2(0x21a)],_0x1e7853=_0x300a9b['params']['id'],_0x4dff12=await sales_order[_0x36b7a2(0x21f)](_0x1e7853),_0x1427d2=await sales_order[_0x36b7a2(0x212)]([{'$match':{'_id':_0x3ec051(_0x1e7853)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x36b7a2(0x21d)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x36b7a2(0x24c)}}},{'$lookup':{'from':'staffs','localField':_0x36b7a2(0x229),'foreignField':_0x36b7a2(0x28a),'as':_0x36b7a2(0x1f7)}},{'$unwind':_0x36b7a2(0x234)},{'$lookup':{'from':'staffs','localField':'wms_account_id','foreignField':_0x36b7a2(0x28a),'as':_0x36b7a2(0x269)}},{'$unwind':_0x36b7a2(0x247)}]);if(_0x4b7550[0x0][_0x36b7a2(0x21e)]==_0x36b7a2(0x227))var _0x41b396=users['English'];else{if(_0x4b7550[0x0][_0x36b7a2(0x21e)]=='Hindi')var _0x41b396=users[_0x36b7a2(0x265)];else{if(_0x4b7550[0x0][_0x36b7a2(0x21e)]=='German')var _0x41b396=users[_0x36b7a2(0x245)];else{if(_0x4b7550[0x0][_0x36b7a2(0x21e)]==_0x36b7a2(0x1fe))var _0x41b396=users[_0x36b7a2(0x1fe)];else{if(_0x4b7550[0x0]['language']=='French')var _0x41b396=users[_0x36b7a2(0x26a)];else{if(_0x4b7550[0x0][_0x36b7a2(0x21e)]==_0x36b7a2(0x233))var _0x41b396=users[_0x36b7a2(0x20a)];else{if(_0x4b7550[0x0]['language']==_0x36b7a2(0x282))var _0x41b396=users[_0x36b7a2(0x282)];else{if(_0x4b7550[0x0][_0x36b7a2(0x21e)]==_0x36b7a2(0x209))var _0x41b396=users[_0x36b7a2(0x228)];}}}}}}}_0x4e239c[_0x36b7a2(0x28d)](_0x36b7a2(0x28c),{'success':_0x300a9b[_0x36b7a2(0x224)](_0x36b7a2(0x1f4)),'errors':_0x300a9b[_0x36b7a2(0x224)](_0x36b7a2(0x22a)),'master_shop':_0x4b7550,'profile':_0x2f947e,'role':_0x338b11,'language':_0x41b396,'customer':_0x181ccc,'sales_sa':_0x4dff12,'approvers':_0x1427d2[0x0],'the_id':_0x1e7853});}catch(_0x2ba023){console[_0x36b7a2(0x26b)](_0x2ba023);}}),router[a0_0x5d2827(0x259)](a0_0x5d2827(0x1ef),auth,async(_0x3efadf,_0x40bd36)=>{var _0x35adeb=a0_0x5d2827;try{const {warehouse_name:_0x17053b,product_code:_0x47ef11}=_0x3efadf['body'],_0x32f6a6=await warehouse['aggregate']([{'$match':{'name':_0x17053b}},{'$unwind':_0x35adeb(0x252)},{'$match':{'product_details.product_code':_0x47ef11}},{'$group':{'_id':{'room':_0x35adeb(0x26e),'_id':_0x35adeb(0x238)}}}]);_0x40bd36[_0x35adeb(0x248)](_0x32f6a6);}catch(_0x233679){}}),router['post']('/data/data_loc',auth,async(_0x249d26,_0x2cbebc)=>{var _0x4d50d0=a0_0x5d2827;try{const {warehouse_name:_0x17a1a8,product_code:_0x17244c,room_name:_0x3a33ee}=_0x249d26[_0x4d50d0(0x221)];console[_0x4d50d0(0x26b)](_0x249d26['body']);const _0x3a2774=await warehouse[_0x4d50d0(0x212)]([{'$match':{'name':_0x17a1a8,'room':_0x3a33ee}},{'$unwind':_0x4d50d0(0x252)},{'$match':{'product_details.product_code':_0x17244c}},{'$group':{'_id':{'main_id':_0x4d50d0(0x238),'detl_id':'$product_details._id','product_name':'$product_details.product_name','product_code':_0x4d50d0(0x235),'level':'$product_details.level','bay':_0x4d50d0(0x289),'stocks':_0x4d50d0(0x256)}}}]);_0x2cbebc['json'](_0x3a2774);}catch(_0x5dcfbb){}}),router[a0_0x5d2827(0x20e)](a0_0x5d2827(0x275),auth,async(_0x3b20e0,_0x166e84)=>{var _0x1efcd3=a0_0x5d2827;try{const {sttaff_id:_0x1fa57b,email:_0x1608e8,warehouse:_0x14547f}=_0x3b20e0[_0x1efcd3(0x1fa)],_0x1ec93e=await master_shop[_0x1efcd3(0x270)](),_0x419712=_0x3b20e0[_0x1efcd3(0x1fa)],_0x2bdf97=await profile[_0x1efcd3(0x239)]({'email':_0x419712[_0x1efcd3(0x216)]}),_0x12f6c9=await sales_order[_0x1efcd3(0x270)]({'wms_account_id':_0x1fa57b});if(_0x1ec93e[0x0]['language']==_0x1efcd3(0x227))var _0x70e692=users[_0x1efcd3(0x28b)];else{if(_0x1ec93e[0x0][_0x1efcd3(0x21e)]==_0x1efcd3(0x265))var _0x70e692=users['Hindi'];else{if(_0x1ec93e[0x0]['language']==_0x1efcd3(0x245))var _0x70e692=users[_0x1efcd3(0x245)];else{if(_0x1ec93e[0x0]['language']==_0x1efcd3(0x1fe))var _0x70e692=users['Spanish'];else{if(_0x1ec93e[0x0]['language']==_0x1efcd3(0x26a))var _0x70e692=users[_0x1efcd3(0x26a)];else{if(_0x1ec93e[0x0][_0x1efcd3(0x21e)]=='Portuguese\x20(BR)')var _0x70e692=users['Portuguese'];else{if(_0x1ec93e[0x0][_0x1efcd3(0x21e)]==_0x1efcd3(0x282))var _0x70e692=users[_0x1efcd3(0x282)];else{if(_0x1ec93e[0x0][_0x1efcd3(0x21e)]==_0x1efcd3(0x209))var _0x70e692=users[_0x1efcd3(0x228)];}}}}}}}_0x166e84[_0x1efcd3(0x28d)](_0x1efcd3(0x211),{'success':_0x3b20e0[_0x1efcd3(0x224)](_0x1efcd3(0x1f4)),'errors':_0x3b20e0['flash'](_0x1efcd3(0x22a)),'master_shop':_0x1ec93e,'profile':_0x2bdf97,'role':_0x419712,'language':_0x70e692,'sales_order':_0x12f6c9});}catch(_0x208ac2){}}),module[a0_0x5d2827(0x23f)]=router;function a0_0x2f61(_0x50f293,_0x40ceba){var _0x42a8b7=a0_0x42a8();return a0_0x2f61=function(_0x2f612a,_0x33227d){_0x2f612a=_0x2f612a-0x1ee;var _0x14ae32=_0x42a8b7[_0x2f612a];return _0x14ae32;},a0_0x2f61(_0x50f293,_0x40ceba);}function a0_0x42a8(){var _0x17a6d8=['accounting_account_id','errors','prod_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','warehouse_id','toString','</tbody>','</table>','host','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Portuguese\x20(BR)','$account_data','$product_details.product_code','<br><br><br>','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','$_id','findOne','</div>','primary_code','Email\x20for\x20Customer','warehouse_detl','length','exports','/:id','product_name','../public/language/languages.json','uuid','187510HyVbdP','German','Logo.png','$wms_data','json','save','nodemailer','/all_sales_finished/preview/','$wms_account_id','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','../models/all_models','room_name','://','headers','$product_details','product_details','unit','183KCnRuH','$product_details.product_stock','express','data_loc','post','params','product_code','abs','expiry_date','13419410wMokSI','push','xlsx','product_stock','wms_account_confirm','gross_price','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Hindi','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','92zIAgCs','<h2>\x20JEC\x20SMS\x20</h2>','wms_data','French','log','redirect','OUT-','$room','wms_account_id','find','secondary_unit','</td>','date_data','logo','/data/All','id_transaction_from','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','invoice_init','../middleware/auth','3665wcsDOA','<hr\x20class=\x22my-3\x22>','</b></span>\x20<br><br>','padStart','3548064fUOMQT','port','product_cat','<h5>\x20JEC\x20SMS\x20</h5>','Chinese','level','quantity','password','Email\x20sent\x20successfully','forEach','mongoose','$product_details.bay','_id','English','view_accounting_approval','render','protocol','/data/data_rack','<div>','batch_code','</b></span>\x20<br>','back','success','Sales\x20Add\x20successfully','<tr>','account_data','1275568sFqcmM','invoice','user','sale_product','prod_cat','90SvPccg','Spanish','26276EDFunz','qty','/../public','<span>\x20Request\x20ID:\x20<b>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/upload/','request_qty','staffs','<!DOCTYPE\x20html>','331002nOnmaQ','Arabic\x20(ae)','Portuguese','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','image','outgoing_invoice','get','</tr>','wms_account_date','warehouse_approval_All','aggregate','date','maxPerUnit','<tbody\x20style=\x22text-align:\x20center;\x22>','email','<span>\x20Request\x20Date:\x20<b>','Router','christian.villamer@jakagroup.com','ObjectId','stock','</body></html>','$accounting_account_id','language','findById','Types','body','bay','map','flash','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','English\x20(US)','Arabic'];a0_0x42a8=function(){return _0x17a6d8;};return a0_0x42a8();}