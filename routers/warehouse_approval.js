var a0_0x2cd3b5=a0_0x1652;(function(_0x5a0fe3,_0x35ead6){var _0x599fae=a0_0x1652,_0x3249bb=_0x5a0fe3();while(!![]){try{var _0x37d43d=-parseInt(_0x599fae(0x1dc))/0x1+parseInt(_0x599fae(0x174))/0x2*(parseInt(_0x599fae(0x1b1))/0x3)+-parseInt(_0x599fae(0x1e5))/0x4+parseInt(_0x599fae(0x190))/0x5*(-parseInt(_0x599fae(0x167))/0x6)+-parseInt(_0x599fae(0x19c))/0x7+parseInt(_0x599fae(0x15c))/0x8*(parseInt(_0x599fae(0x1e3))/0x9)+-parseInt(_0x599fae(0x1a1))/0xa;if(_0x37d43d===_0x35ead6)break;else _0x3249bb['push'](_0x3249bb['shift']());}catch(_0x4c86e3){_0x3249bb['push'](_0x3249bb['shift']());}}}(a0_0x20fa,0xd6037));function a0_0x1652(_0x42d63e,_0x1659b0){var _0x20fa97=a0_0x20fa();return a0_0x1652=function(_0x16524f,_0x49ef86){_0x16524f=_0x16524f-0x15a;var _0x407dad=_0x20fa97[_0x16524f];return _0x407dad;},a0_0x1652(_0x42d63e,_0x1659b0);}const express=require(a0_0x2cd3b5(0x15b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x2cd3b5(0x185)),auth=require('../middleware/auth'),users=require(a0_0x2cd3b5(0x1e8)),excelJS=require(a0_0x2cd3b5(0x1b0)),xlsx=require('xlsx'),mongoose=require('mongoose'),{ObjectId}=require(a0_0x2cd3b5(0x1ad)),nodemailer=require(a0_0x2cd3b5(0x1f8));function a0_0x20fa(){var _0x2e76df=['</tbody>','<hr\x20class=\x22my-3\x22>','$product_details.bay','accounting_account_id','Logo.png','<tr>','outgoing_id','bay','product_stock','False','<h5>\x20JEC\x20SMS\x20</h5>','/view_sales_order/:id','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','success','Hindi','../models/all_models','secondary_unit','errors','push','log','prod_id','unit','uuid','qty','padStart','</table>','345bfpcXS','wms_account_confirm','$room','sendMail','wms_data','findOne','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','warehouse_approval_All','language','exports','product_name','find','2014719zfnkrP','warehouse_detl','$accounting_account_id','document_number_out','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','8300030hwfiIZ','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','</tr>','$product_details','invoice','host','length','save','<span>\x20Request\x20ID:\x20<b>','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','batch_code','ObjectId','mongodb','German','Email\x20for\x20Customer','exceljs','1791msuyKd','gross_price','maxPerUnit','/../public','image','Sales\x20Add\x20successfully','wms_account_id','data_loc','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','OUT-','aggregate','</div>','account_data','Portuguese','split','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','</body></html>','French','$product_details.product_stock','level','$_id','request_qty','map','back','forEach','English','English\x20(US)','/data/All','body','<div>','Error\x20Occurs','$account_data','$wms_data','Spanish','toLocaleDateString','production_date','post','/data/data_loc','findById','secondary_code','invoice_init','<h2>\x20JEC\x20SMS\x20</h2>','primary_code','536361LeOkuV','Chinese','</head><body>','user','prod_cat','$wms_account_id','json','639YVhWVH','flash','355820OCfofv','Arabic','view_accounting_approval','../public/language/languages.json','expiry_date','headers','/:id','filter','maxperunit','<tbody\x20style=\x22text-align:\x20center;\x22>','product_code','params','staffs','room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','room','string','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','://','nodemailer','$product_details.level','/upload/','express','195432KQoYCc','/all_sales_finished/preview/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','render','sale_product','Arabic\x20(ae)','warehouse_id','$product_details.product_code','/data/data_rack','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','get','14646cQZRZk','abs','Portuguese\x20(BR)','warehouse_approval','email','password','toString','product_cat','<br><br><br>','date','</td>','product_details','quantity','3530XdzzLr','_id'];a0_0x20fa=function(){return _0x2e76df;};return a0_0x20fa();}router[a0_0x2cd3b5(0x166)]('/:id',auth,async(_0x335453,_0xf2bc64)=>{var _0x48997d=a0_0x2cd3b5;try{const _0xb8ec46=await master_shop[_0x48997d(0x19b)](),_0x38655f=_0x335453['user'],_0x220cdb=await profile[_0x48997d(0x195)]({'email':_0x38655f[_0x48997d(0x16b)]}),_0x2c5ba0=await staff[_0x48997d(0x195)]({'email':_0x38655f[_0x48997d(0x16b)]}),_0x3f3160=await customer[_0x48997d(0x19b)]({'agent_id':_0x2c5ba0[_0x48997d(0x175)]}),_0xb81aca=mongoose['Types'][_0x48997d(0x1ac)],_0x1682c0=_0x335453[_0x48997d(0x1f0)]['id'],_0x116879=await sales_order[_0x48997d(0x1d7)](_0x1682c0),_0xea5e25=await sales_order[_0x48997d(0x1bb)]([{'$match':{'_id':_0xb81aca(_0x1682c0)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x48997d(0x19e)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x48997d(0x1e1)}}},{'$lookup':{'from':'staffs','localField':_0x48997d(0x179),'foreignField':_0x48997d(0x175),'as':_0x48997d(0x1bd)}},{'$unwind':'$account_data'},{'$lookup':{'from':_0x48997d(0x1f1),'localField':_0x48997d(0x1b7),'foreignField':'_id','as':_0x48997d(0x194)}},{'$unwind':'$wms_data'}]);if(_0xb8ec46[0x0]['language']==_0x48997d(0x1cb))var _0x1311c9=users[_0x48997d(0x1ca)];else{if(_0xb8ec46[0x0][_0x48997d(0x198)]=='Hindi')var _0x1311c9=users[_0x48997d(0x184)];else{if(_0xb8ec46[0x0][_0x48997d(0x198)]==_0x48997d(0x1ae))var _0x1311c9=users[_0x48997d(0x1ae)];else{if(_0xb8ec46[0x0][_0x48997d(0x198)]==_0x48997d(0x1d2))var _0x1311c9=users['Spanish'];else{if(_0xb8ec46[0x0][_0x48997d(0x198)]==_0x48997d(0x1c2))var _0x1311c9=users[_0x48997d(0x1c2)];else{if(_0xb8ec46[0x0][_0x48997d(0x198)]==_0x48997d(0x169))var _0x1311c9=users[_0x48997d(0x1be)];else{if(_0xb8ec46[0x0]['language']==_0x48997d(0x1dd))var _0x1311c9=users['Chinese'];else{if(_0xb8ec46[0x0][_0x48997d(0x198)]==_0x48997d(0x161))var _0x1311c9=users[_0x48997d(0x1e6)];}}}}}}}_0xf2bc64['render'](_0x48997d(0x16a),{'success':_0x335453[_0x48997d(0x1e4)]('success'),'errors':_0x335453[_0x48997d(0x1e4)]('errors'),'master_shop':_0xb8ec46,'profile':_0x220cdb,'role':_0x38655f,'language':_0x1311c9,'customer':_0x3f3160,'sales_sa':_0x116879,'approvers':_0xea5e25[0x0],'the_id':_0x1682c0});}catch(_0x3296ee){console[_0x48997d(0x189)](_0x3296ee);}}),router[a0_0x2cd3b5(0x1d5)](a0_0x2cd3b5(0x1eb),auth,async(_0x3ea9ea,_0x27ad7e)=>{var _0x3a78fd=a0_0x2cd3b5;try{const {date:_0x5ea376,invoice_data:_0x2b1462,wms_confirm:_0x2c218b,the_id_val:_0x5b8568,prod_id:_0x45d0db,SCRN:_0x2dcdf7,ReqBy:_0x167377,dateofreq:_0x122b08,PO_number:_0x3789bf,warehouse_name:_0x426a13,typeservicesData:_0x45e3c4,typevehicle:_0x572fcd,destination:_0x27e2fc,deliverydate:_0x114bf9,driver:_0x406cb8,plate:_0x3132a9,van:_0x1c2291,DRSI:_0x21fdb8,TSU:_0x213499,TFU:_0xabe638,note:_0x41706b}=_0x3ea9ea['body'],_0x5e461e=await sales_order[_0x3a78fd(0x1d7)](_0x5b8568);if(typeof _0x45d0db==_0x3a78fd(0x1f5))var _0x31eba5=[_0x3ea9ea['body'][_0x3a78fd(0x18a)]],_0x37f0a0=[_0x3ea9ea[_0x3a78fd(0x1cd)]['qty']],_0x3d568c=[_0x3ea9ea[_0x3a78fd(0x1cd)][_0x3a78fd(0x1b8)]];else var _0x31eba5=[..._0x3ea9ea[_0x3a78fd(0x1cd)][_0x3a78fd(0x18a)]],_0x37f0a0=[..._0x3ea9ea[_0x3a78fd(0x1cd)][_0x3a78fd(0x18d)]],_0x3d568c=[..._0x3ea9ea['body']['data_loc']];const _0x19a4e8=_0x31eba5['map'](_0x6bebb4=>{return _0x6bebb4={'prod_id':_0x6bebb4};});_0x3d568c[_0x3a78fd(0x1c9)]((_0x10fe8a,_0x5bf859)=>{var _0x19cbf7=_0x3a78fd,_0x251787=_0x10fe8a[_0x19cbf7(0x1bf)]('~');_0x19a4e8[_0x5bf859][_0x19cbf7(0x162)]=_0x251787[0x0],_0x19a4e8[_0x5bf859][_0x19cbf7(0x19d)]=_0x251787[0x1];}),_0x37f0a0[_0x3a78fd(0x1c9)]((_0x309c59,_0x29e7a2)=>{var _0x595d82=_0x3a78fd;_0x19a4e8[_0x29e7a2][_0x595d82(0x1c6)]=_0x309c59;});var _0x57785b=[],_0x46246c=[],_0x10a328=[],_0x346d0d=[],_0x12ff44=[],_0x250a3c=[],_0x25a7ed=[],_0x49e869=[],_0xf2e17c=[],_0x5eb1d9=[],_0x4fccad=[],_0x6fb021=[],_0x584d5c=[],_0x184923=[],_0x2fa80a=[],_0xee6c1e=[],_0xc82dd2=[],_0xeadc84=[],_0x3853bf=[],_0xb621f8=[];for(let _0x103c0f=0x0;_0x103c0f<=_0x19a4e8[_0x3a78fd(0x1a7)]-0x1;_0x103c0f++){const _0x458d4f=_0x19a4e8[_0x103c0f],_0x5abaa7=mongoose['Types'][_0x3a78fd(0x1ac)];var _0xe5f569=await warehouse[_0x3a78fd(0x1bb)]([{'$match':{'_id':_0x5abaa7(_0x458d4f[_0x3a78fd(0x162)])}},{'$unwind':'$product_details'},{'$match':{'product_details._id':_0x5abaa7(_0x458d4f['warehouse_detl'])}}]),_0x4700f7=0x0;for(let _0x4cb784=0x0;_0x4cb784<=_0xe5f569[_0x3a78fd(0x1a7)]-0x1;_0x4cb784++){var _0x5b2103=_0xe5f569[_0x4cb784];_0x5b2103['product_details'][_0x3a78fd(0x17e)]<_0x458d4f[_0x3a78fd(0x1c6)]&&_0x4700f7++;}if(_0x4700f7>0x0)return _0x3ea9ea['flash'](_0x3a78fd(0x187),_0x3a78fd(0x1a2)),_0x27ad7e['redirect'](_0x3a78fd(0x1c8));var _0x5e936b=0x0;for(let _0x28b2e6=0x0;_0x28b2e6<=_0xe5f569[_0x3a78fd(0x1a7)]-0x1;_0x28b2e6++){var _0x5b2103=_0xe5f569[_0x28b2e6];_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x17e)]>_0x458d4f[_0x3a78fd(0x1c6)]&&(_0x57785b['push'](_0x5b2103['product_details']['product_name']),_0x46246c[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x17e)]),_0x10a328[_0x3a78fd(0x188)](_0x458d4f[_0x3a78fd(0x1c6)]),_0x346d0d[_0x3a78fd(0x188)](_0x5b2103['product_details'][_0x3a78fd(0x1db)]),_0x12ff44[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x1d8)]),_0x250a3c[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x172)]['product_code']),_0x25a7ed[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x172)]['level']),_0x49e869['push'](_0x5b2103[_0x3a78fd(0x172)]['bay']),_0xf2e17c[_0x3a78fd(0x188)](_0x5b2103['product_details'][_0x3a78fd(0x18b)]),_0x5eb1d9['push'](_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x186)]),_0x4fccad[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x1ab)]),_0x6fb021[_0x3a78fd(0x188)](_0x5b2103['product_details']['expiry_date']),_0x584d5c['push'](_0x5b2103['product_details'][_0x3a78fd(0x1d4)]),_0x184923[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x1b3)]),_0x2fa80a[_0x3a78fd(0x188)](_0x5b2103['product_details'][_0x3a78fd(0x16e)]),_0xee6c1e[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x1f4)]),_0xc82dd2['push'](_0x5b2103['product_details'][_0x3a78fd(0x1a5)]),_0xeadc84[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x175)]),_0x3853bf[_0x3a78fd(0x188)](_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x18c)]),_0xb621f8['push'](_0x5b2103[_0x3a78fd(0x172)][_0x3a78fd(0x1b2)]),_0x5e936b++);}}const _0x424ce1=_0x57785b[_0x3a78fd(0x1c7)](_0x78c86=>{return _0x78c86={'product_name':_0x78c86};});_0x46246c[_0x3a78fd(0x1c9)]((_0x396790,_0x4793cb)=>{_0x424ce1[_0x4793cb]['stock']=_0x396790;}),_0x10a328['forEach']((_0x4dd334,_0x24df6a)=>{var _0x4cd9ef=_0x3a78fd;_0x424ce1[_0x24df6a][_0x4cd9ef(0x173)]=Math[_0x4cd9ef(0x168)](_0x4dd334);}),_0xb621f8[_0x3a78fd(0x1c9)]((_0x40aab7,_0x4daa6d)=>{var _0x605f76=_0x3a78fd;_0x424ce1[_0x4daa6d][_0x605f76(0x1b2)]=_0x40aab7;}),_0x3853bf['forEach']((_0x569530,_0x15efc8)=>{var _0x323599=_0x3a78fd;_0x424ce1[_0x15efc8][_0x323599(0x18c)]=_0x569530;}),_0xeadc84[_0x3a78fd(0x1c9)]((_0x35be26,_0x12e128)=>{_0x424ce1[_0x12e128]['id_transaction_from']=_0x35be26;}),_0x346d0d[_0x3a78fd(0x1c9)]((_0x4ccaef,_0x330325)=>{var _0x2d20be=_0x3a78fd;_0x424ce1[_0x330325][_0x2d20be(0x1db)]=_0x4ccaef;}),_0x12ff44[_0x3a78fd(0x1c9)]((_0x260279,_0x11ab17)=>{var _0x53a68c=_0x3a78fd;_0x424ce1[_0x11ab17][_0x53a68c(0x1d8)]=_0x260279;}),_0x250a3c[_0x3a78fd(0x1c9)]((_0x547f6d,_0x112d52)=>{var _0x3662a2=_0x3a78fd;_0x424ce1[_0x112d52][_0x3662a2(0x1ef)]=_0x547f6d;}),_0x25a7ed['forEach']((_0x67f66c,_0x2732e4)=>{var _0x49c0c8=_0x3a78fd;_0x424ce1[_0x2732e4][_0x49c0c8(0x1c4)]=_0x67f66c;}),_0x49e869['forEach']((_0xfb14d4,_0x59f7f4)=>{var _0x2173df=_0x3a78fd;_0x424ce1[_0x59f7f4][_0x2173df(0x17d)]=_0xfb14d4;}),_0xf2e17c[_0x3a78fd(0x1c9)]((_0x13c558,_0x3a72a8)=>{var _0x228c5e=_0x3a78fd;_0x424ce1[_0x3a72a8][_0x228c5e(0x18b)]=_0x13c558;}),_0x5eb1d9[_0x3a78fd(0x1c9)]((_0x500afb,_0x545baa)=>{var _0x2d7f38=_0x3a78fd;_0x424ce1[_0x545baa][_0x2d7f38(0x186)]=_0x500afb;}),_0x4fccad[_0x3a78fd(0x1c9)]((_0x22f45b,_0x17626f)=>{var _0x29b295=_0x3a78fd;_0x424ce1[_0x17626f][_0x29b295(0x1ab)]=_0x22f45b;}),_0x6fb021[_0x3a78fd(0x1c9)]((_0x5eaeec,_0x13033b)=>{var _0x101f62=_0x3a78fd;_0x424ce1[_0x13033b][_0x101f62(0x1e9)]=_0x5eaeec;}),_0x584d5c[_0x3a78fd(0x1c9)]((_0x4cbd90,_0x44ebe0)=>{_0x424ce1[_0x44ebe0]['production_date']=_0x4cbd90;}),_0x184923[_0x3a78fd(0x1c9)]((_0x2397fb,_0x40dc3b)=>{var _0x59dc12=_0x3a78fd;_0x424ce1[_0x40dc3b][_0x59dc12(0x1ed)]=_0x2397fb;}),_0x2fa80a[_0x3a78fd(0x1c9)]((_0x5be87a,_0x3d494c)=>{var _0x19530d=_0x3a78fd;_0x424ce1[_0x3d494c][_0x19530d(0x1e0)]=_0x5be87a;}),_0xee6c1e['forEach']((_0x170086,_0x19f8f3)=>{var _0x4b0dc4=_0x3a78fd;_0x424ce1[_0x19f8f3][_0x4b0dc4(0x1f2)]=_0x170086;}),_0xc82dd2[_0x3a78fd(0x1c9)]((_0x452e33,_0x4d6790)=>{_0x424ce1[_0x4d6790]['invoice']=_0x452e33,_0x424ce1[_0x4d6790]['date_data']=_0x5ea376;});const _0x3707fa=new invoice_for_outgoing();await _0x3707fa['save'](),_0xc82dd2['forEach']((_0x38b605,_0x20510c)=>{var _0x5d8e7d=_0x3a78fd;_0x424ce1[_0x20510c]['outgoing_invoice']=_0x5d8e7d(0x1ba)+_0x3707fa[_0x5d8e7d(0x1d9)][_0x5d8e7d(0x16d)]()[_0x5d8e7d(0x18e)](0x8,'0');});const _0xd541c6=_0x424ce1[_0x3a78fd(0x1ec)](_0x39bb81=>_0x39bb81[_0x3a78fd(0x173)]!=='0'&&_0x39bb81['quantity']!==''),_0x328c45=new sales_finished({'invoice':_0x3a78fd(0x1ba)+_0x3707fa[_0x3a78fd(0x1d9)][_0x3a78fd(0x16d)]()[_0x3a78fd(0x18e)](0x8,'0'),'date':_0x5ea376,'warehouse_name':_0x426a13,'sale_product':_0xd541c6,'note':_0x41706b,'SCRN':_0x2dcdf7,'finalize':_0x3a78fd(0x17f),'ReqBy':_0x167377,'dateofreq':_0x122b08,'PO_number':_0x3789bf,'typeservicesData':_0x45e3c4,'typevehicle':_0x572fcd,'destination':_0x27e2fc,'deliverydate':_0x114bf9,'driver':_0x406cb8,'plate':_0x3132a9,'van':_0x1c2291,'DRSI':_0x21fdb8,'TSU':_0x213499,'TFU':_0xabe638}),_0x5bdf56=await _0x328c45[_0x3a78fd(0x1a8)](),_0x215c48=new Date(),_0x23cbd0=_0x215c48[_0x3a78fd(0x1d3)]();_0x5e461e[_0x3a78fd(0x191)]=_0x2c218b,_0x5e461e['wms_account_date']=_0x23cbd0,_0x5e461e[_0x3a78fd(0x19f)]='OUT-'+_0x3707fa[_0x3a78fd(0x1d9)][_0x3a78fd(0x16d)]()[_0x3a78fd(0x18e)](0x8,'0'),_0x5e461e[_0x3a78fd(0x17c)]=_0x5bdf56[_0x3a78fd(0x175)],await _0x5e461e[_0x3a78fd(0x1a8)]();const _0x2f0d04=await master_shop[_0x3a78fd(0x19b)](),_0x48fb30=await email_settings['findOne']();let _0x20b60d=nodemailer['createTransport']({'host':_0x48fb30[_0x3a78fd(0x1a6)],'port':Number(_0x48fb30['port']),'secure':![],'auth':{'user':_0x48fb30[_0x3a78fd(0x16b)],'pass':_0x48fb30[_0x3a78fd(0x16c)]}});const _0x46d3d0=_0x3ea9ea['protocol']+_0x3a78fd(0x1f7)+_0x3ea9ea[_0x3a78fd(0x1ea)][_0x3a78fd(0x1a6)];var _0x5b2312=_0x5e461e[_0x3a78fd(0x160)],_0x50a06d='',_0x40e8e3,_0x21ddd2=0x0;for(_0x40e8e3 in _0x5b2312){_0x50a06d+=_0x3a78fd(0x17b)+_0x3a78fd(0x165)+_0x5b2312[_0x40e8e3][_0x3a78fd(0x19a)]+'</td>'+_0x3a78fd(0x165)+_0x5b2312[_0x40e8e3][_0x3a78fd(0x1ef)]+_0x3a78fd(0x171)+_0x3a78fd(0x165)+_0x5b2312[_0x40e8e3][_0x3a78fd(0x173)]+_0x3a78fd(0x171)+_0x3a78fd(0x165)+_0x5b2312[_0x40e8e3][_0x3a78fd(0x18b)]+_0x3a78fd(0x171)+'</tr>',_0x21ddd2+=parseInt(_0x5b2312[_0x40e8e3][_0x3a78fd(0x173)]);}let _0x25e7c7={'from':_0x48fb30[_0x3a78fd(0x16b)],'to':'christian.villamer@jakagroup.com','subject':_0x3a78fd(0x1af),'attachments':[{'filename':_0x3a78fd(0x17a),'path':__dirname+_0x3a78fd(0x1b4)+_0x3a78fd(0x15a)+_0x2f0d04[0x0][_0x3a78fd(0x1b5)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x3a78fd(0x182)+_0x3a78fd(0x1de)+_0x3a78fd(0x1ce)+_0x3a78fd(0x1b9)+_0x3a78fd(0x1ce)+_0x3a78fd(0x1f6)+_0x3a78fd(0x1bc)+'<div>'+_0x3a78fd(0x1da)+_0x3a78fd(0x1bc)+_0x3a78fd(0x1bc)+_0x3a78fd(0x177)+_0x3a78fd(0x1ce)+_0x3a78fd(0x1bc)+_0x3a78fd(0x1ce)+_0x3a78fd(0x1aa)+_0x3a78fd(0x1bc)+'<div>'+_0x3a78fd(0x1a9)+_0x5e461e[_0x3a78fd(0x1a5)]+'</b></span>\x20<br>'+'<span>\x20Request\x20Date:\x20<b>'+_0x5e461e[_0x3a78fd(0x170)]+'</b></span>\x20<br><br>'+_0x3a78fd(0x1bc)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3a78fd(0x196)+'<tr>'+_0x3a78fd(0x15e)+_0x3a78fd(0x1f3)+_0x3a78fd(0x1a0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x3a78fd(0x1a3)+'</thead>'+_0x3a78fd(0x1ee)+'\x20'+_0x50a06d+'\x20'+_0x3a78fd(0x176)+_0x3a78fd(0x18f)+_0x3a78fd(0x1ce)+'<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>'+'<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>'+_0x3a78fd(0x16f)+_0x3a78fd(0x1bc)+_0x3a78fd(0x1ce)+'<strong>\x20Regards\x20</strong>'+_0x3a78fd(0x180)+_0x3a78fd(0x1bc)+_0x3a78fd(0x1bc)+_0x3a78fd(0x1c0)+_0x3a78fd(0x1c1)};_0x20b60d[_0x3a78fd(0x193)](_0x25e7c7,function(_0x5099b6,_0xeeb878){var _0xea807b=_0x3a78fd;_0x5099b6?(console[_0xea807b(0x189)](_0x5099b6),console[_0xea807b(0x189)](_0xea807b(0x1cf))):console['log']('Email\x20sent\x20successfully');}),_0x3ea9ea[_0x3a78fd(0x1e4)](_0x3a78fd(0x183),_0x3a78fd(0x1b6)),_0x27ad7e['redirect'](_0x3a78fd(0x15d)+_0x5bdf56[_0x3a78fd(0x175)]),_0x27ad7e[_0x3a78fd(0x1e2)](_0xd541c6);return;}catch(_0x5d15d1){}}),router[a0_0x2cd3b5(0x166)](a0_0x2cd3b5(0x181),auth,async(_0x4b882e,_0xd4fae3)=>{var _0xae437b=a0_0x2cd3b5;try{const _0x4bee2d=await master_shop['find'](),_0x855e3a=_0x4b882e[_0xae437b(0x1df)],_0x146fdc=await profile['findOne']({'email':_0x855e3a[_0xae437b(0x16b)]}),_0x52fdc7=await staff[_0xae437b(0x195)]({'email':_0x855e3a[_0xae437b(0x16b)]}),_0x534c30=await customer[_0xae437b(0x19b)]({'agent_id':_0x52fdc7[_0xae437b(0x175)]}),_0x29407a=mongoose['Types']['ObjectId'],_0xeb7848=_0x4b882e[_0xae437b(0x1f0)]['id'],_0x186a4b=await sales_order[_0xae437b(0x1d7)](_0xeb7848),_0x2fdd87=await sales_order['aggregate']([{'$match':{'_id':_0x29407a(_0xeb7848)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0xae437b(0x19e)}}},{'$addFields':{'wms_account_id':{'$toObjectId':'$wms_account_id'}}},{'$lookup':{'from':_0xae437b(0x1f1),'localField':'accounting_account_id','foreignField':_0xae437b(0x175),'as':_0xae437b(0x1bd)}},{'$unwind':_0xae437b(0x1d0)},{'$lookup':{'from':_0xae437b(0x1f1),'localField':_0xae437b(0x1b7),'foreignField':_0xae437b(0x175),'as':_0xae437b(0x194)}},{'$unwind':_0xae437b(0x1d1)}]);if(_0x4bee2d[0x0][_0xae437b(0x198)]==_0xae437b(0x1cb))var _0x3e2b27=users['English'];else{if(_0x4bee2d[0x0][_0xae437b(0x198)]==_0xae437b(0x184))var _0x3e2b27=users[_0xae437b(0x184)];else{if(_0x4bee2d[0x0][_0xae437b(0x198)]==_0xae437b(0x1ae))var _0x3e2b27=users[_0xae437b(0x1ae)];else{if(_0x4bee2d[0x0][_0xae437b(0x198)]==_0xae437b(0x1d2))var _0x3e2b27=users[_0xae437b(0x1d2)];else{if(_0x4bee2d[0x0][_0xae437b(0x198)]==_0xae437b(0x1c2))var _0x3e2b27=users[_0xae437b(0x1c2)];else{if(_0x4bee2d[0x0][_0xae437b(0x198)]==_0xae437b(0x169))var _0x3e2b27=users['Portuguese'];else{if(_0x4bee2d[0x0][_0xae437b(0x198)]=='Chinese')var _0x3e2b27=users['Chinese'];else{if(_0x4bee2d[0x0]['language']==_0xae437b(0x161))var _0x3e2b27=users[_0xae437b(0x1e6)];}}}}}}}_0xd4fae3[_0xae437b(0x15f)](_0xae437b(0x1e7),{'success':_0x4b882e[_0xae437b(0x1e4)](_0xae437b(0x183)),'errors':_0x4b882e[_0xae437b(0x1e4)]('errors'),'master_shop':_0x4bee2d,'profile':_0x146fdc,'role':_0x855e3a,'language':_0x3e2b27,'customer':_0x534c30,'sales_sa':_0x186a4b,'approvers':_0x2fdd87[0x0],'the_id':_0xeb7848});}catch(_0x4fbd0a){console[_0xae437b(0x189)](_0x4fbd0a);}}),router['post'](a0_0x2cd3b5(0x164),auth,async(_0x309208,_0x3ac828)=>{var _0x4cf870=a0_0x2cd3b5;try{const {warehouse_name:_0x20dac4,product_code:_0x1e5211}=_0x309208[_0x4cf870(0x1cd)],_0x1d622d=await warehouse[_0x4cf870(0x1bb)]([{'$match':{'name':_0x20dac4}},{'$unwind':_0x4cf870(0x1a4)},{'$match':{'product_details.product_code':_0x1e5211}},{'$group':{'_id':{'room':_0x4cf870(0x192),'_id':_0x4cf870(0x1c5)}}}]);_0x3ac828[_0x4cf870(0x1e2)](_0x1d622d);}catch(_0x4849a2){}}),router[a0_0x2cd3b5(0x1d5)](a0_0x2cd3b5(0x1d6),auth,async(_0x3adc7b,_0x51f036)=>{var _0x12ae0b=a0_0x2cd3b5;try{const {warehouse_name:_0x2a9e2b,product_code:_0x443369,room_name:_0x5c97e2}=_0x3adc7b[_0x12ae0b(0x1cd)];console['log'](_0x3adc7b[_0x12ae0b(0x1cd)]);const _0x123822=await warehouse[_0x12ae0b(0x1bb)]([{'$match':{'name':_0x2a9e2b,'room':_0x5c97e2}},{'$unwind':_0x12ae0b(0x1a4)},{'$match':{'product_details.product_code':_0x443369}},{'$group':{'_id':{'main_id':'$_id','detl_id':'$product_details._id','product_name':'$product_details.product_name','product_code':_0x12ae0b(0x163),'level':_0x12ae0b(0x1f9),'bay':_0x12ae0b(0x178),'stocks':_0x12ae0b(0x1c3)}}}]);_0x51f036[_0x12ae0b(0x1e2)](_0x123822);}catch(_0x8f06c7){}}),router['get'](a0_0x2cd3b5(0x1cc),auth,async(_0x482d88,_0x438f17)=>{var _0x428e14=a0_0x2cd3b5;try{const {sttaff_id:_0x4a7889,email:_0x3db952,warehouse:_0x29f705}=_0x482d88[_0x428e14(0x1df)],_0x284d73=await master_shop['find'](),_0x1f7e30=_0x482d88[_0x428e14(0x1df)],_0x371592=await profile[_0x428e14(0x195)]({'email':_0x1f7e30['email']}),_0x32da75=await sales_order[_0x428e14(0x19b)]({'wms_account_id':_0x4a7889});if(_0x284d73[0x0][_0x428e14(0x198)]==_0x428e14(0x1cb))var _0x5ae395=users[_0x428e14(0x1ca)];else{if(_0x284d73[0x0]['language']=='Hindi')var _0x5ae395=users['Hindi'];else{if(_0x284d73[0x0][_0x428e14(0x198)]==_0x428e14(0x1ae))var _0x5ae395=users[_0x428e14(0x1ae)];else{if(_0x284d73[0x0][_0x428e14(0x198)]==_0x428e14(0x1d2))var _0x5ae395=users['Spanish'];else{if(_0x284d73[0x0]['language']=='French')var _0x5ae395=users['French'];else{if(_0x284d73[0x0][_0x428e14(0x198)]=='Portuguese\x20(BR)')var _0x5ae395=users[_0x428e14(0x1be)];else{if(_0x284d73[0x0]['language']==_0x428e14(0x1dd))var _0x5ae395=users['Chinese'];else{if(_0x284d73[0x0][_0x428e14(0x198)]==_0x428e14(0x161))var _0x5ae395=users['Arabic'];}}}}}}}_0x438f17[_0x428e14(0x15f)](_0x428e14(0x197),{'success':_0x482d88['flash'](_0x428e14(0x183)),'errors':_0x482d88['flash'](_0x428e14(0x187)),'master_shop':_0x284d73,'profile':_0x371592,'role':_0x1f7e30,'language':_0x5ae395,'sales_order':_0x32da75});}catch(_0x33a5ff){}}),module[a0_0x2cd3b5(0x199)]=router;