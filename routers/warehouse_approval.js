var a0_0x1d1fbf=a0_0x5cd3;(function(_0x4efd55,_0x1fc57a){var _0x5a5fed=a0_0x5cd3,_0xe43c6=_0x4efd55();while(!![]){try{var _0x4ff412=-parseInt(_0x5a5fed(0x270))/0x1*(parseInt(_0x5a5fed(0x222))/0x2)+parseInt(_0x5a5fed(0x22d))/0x3*(-parseInt(_0x5a5fed(0x209))/0x4)+-parseInt(_0x5a5fed(0x253))/0x5+-parseInt(_0x5a5fed(0x23f))/0x6+-parseInt(_0x5a5fed(0x258))/0x7*(-parseInt(_0x5a5fed(0x237))/0x8)+-parseInt(_0x5a5fed(0x246))/0x9*(parseInt(_0x5a5fed(0x247))/0xa)+parseInt(_0x5a5fed(0x26a))/0xb*(parseInt(_0x5a5fed(0x202))/0xc);if(_0x4ff412===_0x1fc57a)break;else _0xe43c6['push'](_0xe43c6['shift']());}catch(_0x14a722){_0xe43c6['push'](_0xe43c6['shift']());}}}(a0_0x55e3,0x44895));function a0_0x55e3(){var _0x40d3a2=['get','wms_data','success','</head><body>','English\x20(US)','unit','push','</td>','redirect','save','://','xlsx','</tr>','batch_code','warehouse_approval','Arabic','nodemailer','../public/language/languages.json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_name','level','staffs','$product_details._id','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','account_data','wms_account_confirm','/data/data_rack','email','log','/../public','$product_details','data_loc','body','14676OEmTHZ','params','json','/data/All','createTransport','post','</table>','8wlgrqW','document_number_out','Portuguese','secondary_code','back','express','<tr>','<div>','prod_id','Logo.png','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','/all_sales_finished/preview/','Portuguese\x20(BR)','<span>\x20Request\x20Date:\x20<b>','uuid','<strong>\x20Regards\x20</strong>','False','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','padStart','German','OUT-','find','errors','christian.villamer@jakagroup.com','140538hQfsUu','$accounting_account_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','room_name','warehouse_detl','abs','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$room','logo','<span>\x20Request\x20ID:\x20<b>','<br><br><br>','792039YidDaz','</thead>','warehouse_approval_All','Router','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','password','/upload/','request_qty','</div>','8EHLoat','$product_details.product_stock','Error\x20Occurs','<hr\x20class=\x22my-3\x22>','length','gross_price','findOne','French','444168SsRuhM','aggregate','ObjectId','invoice_init','exceljs','qty','</b></span>\x20<br>','18BWnQAL','607390VJrDSg','bay','</body></html>','Types','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','flash','toString','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','</b></span>\x20<br><br>','user','mongodb','Chinese','1056920JQEBpG','outgoing_invoice','maxPerUnit','string','_id','3359671stfiLT','invoice','<html><head><title></title>','secondary_unit','Hindi','$_id','product_cat','$wms_data','toLocaleDateString','product_details','warehouse_id','render','<tbody\x20style=\x22text-align:\x20center;\x22>','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','accounting_account_id','Arabic\x20(ae)','exports','language','7249chWHId','<h5>\x20JEC\x20SMS\x20</h5>','filter','port','expiry_date','wms_account_date','1jjMuVC','date','/view_sales_order/:id','$product_details.product_name','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/data/data_loc','findById','map','id_transaction_from','$wms_account_id','production_date','../models/all_models','sendMail','product_stock','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','Email\x20sent\x20successfully','$account_data','outgoing_id','forEach','../middleware/auth','/:id','split','image','quantity','Spanish','<table\x20style=\x22width:\x20100%\x20!important;\x22>','headers','host'];a0_0x55e3=function(){return _0x40d3a2;};return a0_0x55e3();}const express=require(a0_0x1d1fbf(0x20e)),app=express(),router=express[a0_0x1d1fbf(0x230)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x1d1fbf(0x1d0)),auth=require(a0_0x1d1fbf(0x1d8)),users=require(a0_0x1d1fbf(0x1f2)),excelJS=require(a0_0x1d1fbf(0x243)),xlsx=require(a0_0x1d1fbf(0x1ec)),mongoose=require('mongoose'),{ObjectId}=require(a0_0x1d1fbf(0x251)),nodemailer=require(a0_0x1d1fbf(0x1f1));function a0_0x5cd3(_0x49a65d,_0x5ce821){var _0x55e3c7=a0_0x55e3();return a0_0x5cd3=function(_0x5cd327,_0x1ecca1){_0x5cd327=_0x5cd327-0x1c7;var _0x1d5029=_0x55e3c7[_0x5cd327];return _0x1d5029;},a0_0x5cd3(_0x49a65d,_0x5ce821);}router[a0_0x1d1fbf(0x1e1)](a0_0x1d1fbf(0x1d9),auth,async(_0x35397f,_0x287afd)=>{var _0x41d305=a0_0x1d1fbf;try{const _0x3a5db9=await master_shop[_0x41d305(0x21f)](),_0x596ab2=_0x35397f[_0x41d305(0x250)],_0x103013=await profile['findOne']({'email':_0x596ab2[_0x41d305(0x1fc)]}),_0x582734=await staff[_0x41d305(0x23d)]({'email':_0x596ab2[_0x41d305(0x1fc)]}),_0x379b30=await customer[_0x41d305(0x21f)]({'agent_id':_0x582734[_0x41d305(0x257)]}),_0xca8b26=mongoose[_0x41d305(0x24a)][_0x41d305(0x241)],_0xfdc8bd=_0x35397f[_0x41d305(0x203)]['id'],_0x3e287c=await sales_order[_0x41d305(0x1cb)](_0xfdc8bd),_0x10b96d=await sales_order[_0x41d305(0x240)]([{'$match':{'_id':_0xca8b26(_0xfdc8bd)}},{'$addFields':{'accounting_account_id':{'$toObjectId':'$accounting_account_id'}}},{'$addFields':{'wms_account_id':{'$toObjectId':'$wms_account_id'}}},{'$lookup':{'from':_0x41d305(0x1f6),'localField':'accounting_account_id','foreignField':_0x41d305(0x257),'as':_0x41d305(0x1f9)}},{'$unwind':_0x41d305(0x1d5)},{'$lookup':{'from':_0x41d305(0x1f6),'localField':'wms_account_id','foreignField':'_id','as':_0x41d305(0x1e2)}},{'$unwind':'$wms_data'}]);if(_0x3a5db9[0x0][_0x41d305(0x269)]==_0x41d305(0x1e5))var _0x47c477=users[_0x41d305(0x213)];else{if(_0x3a5db9[0x0]['language']==_0x41d305(0x25c))var _0x47c477=users['Hindi'];else{if(_0x3a5db9[0x0]['language']=='German')var _0x47c477=users[_0x41d305(0x21d)];else{if(_0x3a5db9[0x0][_0x41d305(0x269)]=='Spanish')var _0x47c477=users[_0x41d305(0x1dd)];else{if(_0x3a5db9[0x0][_0x41d305(0x269)]=='French')var _0x47c477=users['French'];else{if(_0x3a5db9[0x0][_0x41d305(0x269)]==_0x41d305(0x216))var _0x47c477=users['Portuguese'];else{if(_0x3a5db9[0x0][_0x41d305(0x269)]==_0x41d305(0x252))var _0x47c477=users[_0x41d305(0x252)];else{if(_0x3a5db9[0x0][_0x41d305(0x269)]==_0x41d305(0x267))var _0x47c477=users[_0x41d305(0x1f0)];}}}}}}}_0x287afd[_0x41d305(0x263)](_0x41d305(0x1ef),{'success':_0x35397f[_0x41d305(0x24c)](_0x41d305(0x1e3)),'errors':_0x35397f[_0x41d305(0x24c)]('errors'),'master_shop':_0x3a5db9,'profile':_0x103013,'role':_0x596ab2,'language':_0x47c477,'customer':_0x379b30,'sales_sa':_0x3e287c,'approvers':_0x10b96d[0x0],'the_id':_0xfdc8bd});}catch(_0xeb77ff){console[_0x41d305(0x1fd)](_0xeb77ff);}}),router[a0_0x1d1fbf(0x207)](a0_0x1d1fbf(0x1d9),auth,async(_0xcb14d3,_0x5a1e0c)=>{var _0x769bc3=a0_0x1d1fbf;try{const {date:_0x4bba01,invoice_data:_0x288a46,wms_confirm:_0x10a70c,the_id_val:_0x340049,prod_id:_0x5b6ff4,SCRN:_0x15270a,ReqBy:_0x54cf6c,dateofreq:_0x26d037,PO_number:_0x31add6,warehouse_name:_0x3ea5a7,typeservicesData:_0x5f20aa,typevehicle:_0x3514e5,destination:_0x5ade17,deliverydate:_0xbd15d4,driver:_0x3ffb9f,plate:_0x11e3b5,van:_0x434f9f,DRSI:_0x523497,TSU:_0x3e543e,TFU:_0x44f86a,note:_0x20a8ed}=_0xcb14d3['body'],_0x1d7f16=await sales_order['findById'](_0x340049);if(typeof _0x5b6ff4==_0x769bc3(0x256))var _0x2ba932=[_0xcb14d3[_0x769bc3(0x201)][_0x769bc3(0x211)]],_0x45d865=[_0xcb14d3[_0x769bc3(0x201)][_0x769bc3(0x244)]],_0xe61c77=[_0xcb14d3['body'][_0x769bc3(0x200)]];else var _0x2ba932=[..._0xcb14d3['body'][_0x769bc3(0x211)]],_0x45d865=[..._0xcb14d3['body']['qty']],_0xe61c77=[..._0xcb14d3[_0x769bc3(0x201)][_0x769bc3(0x200)]];const _0x9946e2=_0x2ba932['map'](_0x1e629c=>{return _0x1e629c={'prod_id':_0x1e629c};});_0xe61c77[_0x769bc3(0x1d7)]((_0x885e37,_0x1456b1)=>{var _0x2f20c6=_0x769bc3,_0x31c2e3=_0x885e37[_0x2f20c6(0x1da)]('~');_0x9946e2[_0x1456b1][_0x2f20c6(0x262)]=_0x31c2e3[0x0],_0x9946e2[_0x1456b1][_0x2f20c6(0x226)]=_0x31c2e3[0x1];}),_0x45d865[_0x769bc3(0x1d7)]((_0x340b2b,_0x37feb2)=>{var _0x162551=_0x769bc3;_0x9946e2[_0x37feb2][_0x162551(0x235)]=_0x340b2b;});var _0x5d6f3a=[],_0x206d8d=[],_0x22af42=[],_0x1e5818=[],_0x3fb1be=[],_0x5e0959=[],_0x254595=[],_0x1a8e03=[],_0x28a7e2=[],_0x59c330=[],_0x5f1101=[],_0x45b8a9=[],_0xbcde25=[],_0x3b6372=[],_0x1408fd=[],_0x1c8e40=[],_0x90efc1=[],_0x15386b=[],_0x454221=[],_0x5e0490=[];for(let _0xf4b487=0x0;_0xf4b487<=_0x9946e2['length']-0x1;_0xf4b487++){const _0x3b8c80=_0x9946e2[_0xf4b487],_0x44e72c=mongoose[_0x769bc3(0x24a)][_0x769bc3(0x241)];var _0x574e7d=await warehouse['aggregate']([{'$match':{'_id':_0x44e72c(_0x3b8c80[_0x769bc3(0x262)])}},{'$unwind':_0x769bc3(0x1ff)},{'$match':{'product_details._id':_0x44e72c(_0x3b8c80[_0x769bc3(0x226)])}}]),_0x4dc124=0x0;for(let _0x3a75a7=0x0;_0x3a75a7<=_0x574e7d['length']-0x1;_0x3a75a7++){var _0x5d83ab=_0x574e7d[_0x3a75a7];_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x1d2)]<_0x3b8c80[_0x769bc3(0x235)]&&_0x4dc124++;}if(_0x4dc124>0x0)return _0xcb14d3[_0x769bc3(0x24c)](_0x769bc3(0x220),_0x769bc3(0x228)),_0x5a1e0c['redirect'](_0x769bc3(0x20d));var _0x3deba5=0x0;for(let _0x1e6267=0x0;_0x1e6267<=_0x574e7d[_0x769bc3(0x23b)]-0x1;_0x1e6267++){var _0x5d83ab=_0x574e7d[_0x1e6267];_0x5d83ab['product_details']['product_stock']>_0x3b8c80[_0x769bc3(0x235)]&&(_0x5d6f3a[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x1f4)]),_0x206d8d[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)]['product_stock']),_0x22af42[_0x769bc3(0x1e7)](_0x3b8c80['request_qty']),_0x1e5818[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)]['primary_code']),_0x3fb1be[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x20c)]),_0x5e0959[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x231)]),_0x254595[_0x769bc3(0x1e7)](_0x5d83ab['product_details'][_0x769bc3(0x1f5)]),_0x1a8e03[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x248)]),_0x28a7e2['push'](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x1e6)]),_0x59c330[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x25b)]),_0x5f1101['push'](_0x5d83ab['product_details'][_0x769bc3(0x1ee)]),_0x45b8a9[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x26e)]),_0xbcde25['push'](_0x5d83ab['product_details'][_0x769bc3(0x1cf)]),_0x3b6372[_0x769bc3(0x1e7)](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x255)]),_0x1408fd[_0x769bc3(0x1e7)](_0x5d83ab['product_details'][_0x769bc3(0x25e)]),_0x1c8e40[_0x769bc3(0x1e7)](_0x5d83ab['room']),_0x90efc1[_0x769bc3(0x1e7)](_0x5d83ab['product_details']['invoice']),_0x15386b['push'](_0x5d83ab[_0x769bc3(0x261)]['_id']),_0x454221[_0x769bc3(0x1e7)](_0x5d83ab['product_details'][_0x769bc3(0x218)]),_0x5e0490['push'](_0x5d83ab[_0x769bc3(0x261)][_0x769bc3(0x23c)]),_0x3deba5++);}}const _0x48da75=_0x5d6f3a[_0x769bc3(0x1cc)](_0x25c775=>{return _0x25c775={'product_name':_0x25c775};});_0x206d8d[_0x769bc3(0x1d7)]((_0x5ed9f9,_0x12cdc2)=>{_0x48da75[_0x12cdc2]['stock']=_0x5ed9f9;}),_0x22af42[_0x769bc3(0x1d7)]((_0x2a066a,_0x1c37d5)=>{var _0x20a535=_0x769bc3;_0x48da75[_0x1c37d5][_0x20a535(0x1dc)]=Math[_0x20a535(0x227)](_0x2a066a);}),_0x5e0490[_0x769bc3(0x1d7)]((_0x4fba08,_0x4dc35a)=>{_0x48da75[_0x4dc35a]['gross_price']=_0x4fba08;}),_0x454221['forEach']((_0x484365,_0x4a082b)=>{var _0x21e1e0=_0x769bc3;_0x48da75[_0x4a082b][_0x21e1e0(0x218)]=_0x484365;}),_0x15386b[_0x769bc3(0x1d7)]((_0x31246a,_0x322d55)=>{var _0x3244cb=_0x769bc3;_0x48da75[_0x322d55][_0x3244cb(0x1cd)]=_0x31246a;}),_0x1e5818[_0x769bc3(0x1d7)]((_0x256125,_0x4ccfd9)=>{_0x48da75[_0x4ccfd9]['primary_code']=_0x256125;}),_0x3fb1be['forEach']((_0x1deaf0,_0x59c69d)=>{var _0x2ba71d=_0x769bc3;_0x48da75[_0x59c69d][_0x2ba71d(0x20c)]=_0x1deaf0;}),_0x5e0959[_0x769bc3(0x1d7)]((_0x347015,_0x3c3082)=>{var _0x5d5568=_0x769bc3;_0x48da75[_0x3c3082][_0x5d5568(0x231)]=_0x347015;}),_0x254595[_0x769bc3(0x1d7)]((_0x557b86,_0x290355)=>{var _0x4376cf=_0x769bc3;_0x48da75[_0x290355][_0x4376cf(0x1f5)]=_0x557b86;}),_0x1a8e03['forEach']((_0x145392,_0x200813)=>{var _0x9780e0=_0x769bc3;_0x48da75[_0x200813][_0x9780e0(0x248)]=_0x145392;}),_0x28a7e2[_0x769bc3(0x1d7)]((_0x31d9e0,_0xb137ec)=>{var _0xb98372=_0x769bc3;_0x48da75[_0xb137ec][_0xb98372(0x1e6)]=_0x31d9e0;}),_0x59c330['forEach']((_0x31a71a,_0x42b81b)=>{var _0x3fca24=_0x769bc3;_0x48da75[_0x42b81b][_0x3fca24(0x25b)]=_0x31a71a;}),_0x5f1101[_0x769bc3(0x1d7)]((_0x1f5140,_0x195edf)=>{_0x48da75[_0x195edf]['batch_code']=_0x1f5140;}),_0x45b8a9[_0x769bc3(0x1d7)]((_0x43052d,_0x44cf5f)=>{var _0x4e8140=_0x769bc3;_0x48da75[_0x44cf5f][_0x4e8140(0x26e)]=_0x43052d;}),_0xbcde25[_0x769bc3(0x1d7)]((_0xe814db,_0x26b947)=>{var _0x48a9c8=_0x769bc3;_0x48da75[_0x26b947][_0x48a9c8(0x1cf)]=_0xe814db;}),_0x3b6372[_0x769bc3(0x1d7)]((_0x5811ce,_0x3b68d1)=>{_0x48da75[_0x3b68d1]['maxperunit']=_0x5811ce;}),_0x1408fd[_0x769bc3(0x1d7)]((_0x3aaa8f,_0x2406bb)=>{_0x48da75[_0x2406bb]['prod_cat']=_0x3aaa8f;}),_0x1c8e40[_0x769bc3(0x1d7)]((_0x5c6f32,_0x4dabe3)=>{var _0x485479=_0x769bc3;_0x48da75[_0x4dabe3][_0x485479(0x225)]=_0x5c6f32;}),_0x90efc1['forEach']((_0x1a6aa5,_0x17a688)=>{var _0x571a02=_0x769bc3;_0x48da75[_0x17a688][_0x571a02(0x259)]=_0x1a6aa5,_0x48da75[_0x17a688]['date_data']=_0x4bba01;});const _0x229f20=new invoice_for_outgoing();await _0x229f20[_0x769bc3(0x1ea)](),_0x90efc1[_0x769bc3(0x1d7)]((_0x31674a,_0x221ea7)=>{var _0x4de918=_0x769bc3;_0x48da75[_0x221ea7][_0x4de918(0x254)]='OUT-'+_0x229f20[_0x4de918(0x242)][_0x4de918(0x24d)]()[_0x4de918(0x21c)](0x8,'0');});const _0x30b28b=_0x48da75[_0x769bc3(0x26c)](_0x5b7da2=>_0x5b7da2[_0x769bc3(0x1dc)]!=='0'&&_0x5b7da2[_0x769bc3(0x1dc)]!==''),_0x5f4bfd=new sales_finished({'invoice':_0x769bc3(0x21e)+_0x229f20[_0x769bc3(0x242)][_0x769bc3(0x24d)]()[_0x769bc3(0x21c)](0x8,'0'),'date':_0x4bba01,'warehouse_name':_0x3ea5a7,'sale_product':_0x30b28b,'note':_0x20a8ed,'SCRN':_0x15270a,'finalize':_0x769bc3(0x21a),'ReqBy':_0x54cf6c,'dateofreq':_0x26d037,'PO_number':_0x31add6,'typeservicesData':_0x5f20aa,'typevehicle':_0x3514e5,'destination':_0x5ade17,'deliverydate':_0xbd15d4,'driver':_0x3ffb9f,'plate':_0x11e3b5,'van':_0x434f9f,'DRSI':_0x523497,'TSU':_0x3e543e,'TFU':_0x44f86a}),_0x45b566=await _0x5f4bfd['save'](),_0x5b46d5=new Date(),_0x24ed87=_0x5b46d5[_0x769bc3(0x260)]();_0x1d7f16[_0x769bc3(0x1fa)]=_0x10a70c,_0x1d7f16[_0x769bc3(0x26f)]=_0x24ed87,_0x1d7f16[_0x769bc3(0x20a)]=_0x769bc3(0x21e)+_0x229f20[_0x769bc3(0x242)]['toString']()[_0x769bc3(0x21c)](0x8,'0'),_0x1d7f16[_0x769bc3(0x1d6)]=_0x45b566[_0x769bc3(0x257)],await _0x1d7f16[_0x769bc3(0x1ea)]();const _0xde5662=await master_shop['find'](),_0x45789e=await email_settings[_0x769bc3(0x23d)]();let _0x25522e=nodemailer[_0x769bc3(0x206)]({'host':_0x45789e[_0x769bc3(0x1e0)],'port':Number(_0x45789e[_0x769bc3(0x26d)]),'secure':![],'auth':{'user':_0x45789e[_0x769bc3(0x1fc)],'pass':_0x45789e[_0x769bc3(0x233)]}});const _0x4ccbf3=_0xcb14d3['protocol']+_0x769bc3(0x1eb)+_0xcb14d3[_0x769bc3(0x1df)]['host'];var _0x34170c=_0x1d7f16['sale_product'],_0x11c551='',_0x4249ac,_0x2caa54=0x0;for(_0x4249ac in _0x34170c){_0x11c551+=_0x769bc3(0x20f)+_0x769bc3(0x24b)+_0x34170c[_0x4249ac]['product_name']+_0x769bc3(0x1e8)+_0x769bc3(0x24b)+_0x34170c[_0x4249ac][_0x769bc3(0x231)]+'</td>'+_0x769bc3(0x24b)+_0x34170c[_0x4249ac]['quantity']+_0x769bc3(0x1e8)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x34170c[_0x4249ac][_0x769bc3(0x1e6)]+_0x769bc3(0x1e8)+_0x769bc3(0x1ed),_0x2caa54+=parseInt(_0x34170c[_0x4249ac][_0x769bc3(0x1dc)]);}let _0x5f3809={'from':_0x45789e['email'],'to':_0x769bc3(0x221),'subject':'Email\x20for\x20Customer','attachments':[{'filename':_0x769bc3(0x212),'path':__dirname+_0x769bc3(0x1fe)+_0x769bc3(0x234)+_0xde5662[0x0][_0x769bc3(0x1db)],'cid':_0x769bc3(0x22a)}],'html':'<!DOCTYPE\x20html>'+_0x769bc3(0x25a)+'<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>'+_0x769bc3(0x1e4)+_0x769bc3(0x210)+_0x769bc3(0x1c9)+_0x769bc3(0x210)+_0x769bc3(0x24e)+_0x769bc3(0x236)+_0x769bc3(0x210)+'<h2>\x20JEC\x20SMS\x20</h2>'+'</div>'+_0x769bc3(0x236)+_0x769bc3(0x23a)+_0x769bc3(0x210)+_0x769bc3(0x236)+_0x769bc3(0x210)+_0x769bc3(0x21b)+_0x769bc3(0x236)+'<div>'+_0x769bc3(0x22b)+_0x1d7f16[_0x769bc3(0x259)]+_0x769bc3(0x245)+_0x769bc3(0x217)+_0x1d7f16[_0x769bc3(0x271)]+_0x769bc3(0x24f)+_0x769bc3(0x236)+_0x769bc3(0x1de)+_0x769bc3(0x1f8)+_0x769bc3(0x20f)+_0x769bc3(0x224)+_0x769bc3(0x214)+_0x769bc3(0x232)+_0x769bc3(0x1f3)+_0x769bc3(0x1ed)+_0x769bc3(0x22e)+_0x769bc3(0x264)+'\x20'+_0x11c551+'\x20'+'</tbody>'+_0x769bc3(0x208)+_0x769bc3(0x210)+'<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>'+_0x769bc3(0x1d3)+_0x769bc3(0x22c)+_0x769bc3(0x236)+'<div>'+_0x769bc3(0x219)+_0x769bc3(0x26b)+_0x769bc3(0x236)+_0x769bc3(0x236)+_0x769bc3(0x265)+_0x769bc3(0x249)};_0x25522e[_0x769bc3(0x1d1)](_0x5f3809,function(_0x1c56a2,_0xa80ea4){var _0x5ad727=_0x769bc3;_0x1c56a2?(console[_0x5ad727(0x1fd)](_0x1c56a2),console['log'](_0x5ad727(0x239))):console['log'](_0x5ad727(0x1d4));}),_0xcb14d3[_0x769bc3(0x24c)](_0x769bc3(0x1e3),'Sales\x20Add\x20successfully'),_0x5a1e0c[_0x769bc3(0x1e9)](_0x769bc3(0x215)+_0x45b566[_0x769bc3(0x257)]),_0x5a1e0c['json'](_0x30b28b);return;}catch(_0x33c78c){}}),router[a0_0x1d1fbf(0x1e1)](a0_0x1d1fbf(0x1c7),auth,async(_0x3e8c82,_0x30fd91)=>{var _0xba282b=a0_0x1d1fbf;try{const _0x8c6081=await master_shop[_0xba282b(0x21f)](),_0x3dd8df=_0x3e8c82[_0xba282b(0x250)],_0x56bb28=await profile['findOne']({'email':_0x3dd8df[_0xba282b(0x1fc)]}),_0x23aa4f=await staff[_0xba282b(0x23d)]({'email':_0x3dd8df[_0xba282b(0x1fc)]}),_0xb1e555=await customer[_0xba282b(0x21f)]({'agent_id':_0x23aa4f[_0xba282b(0x257)]}),_0x5d6796=mongoose[_0xba282b(0x24a)][_0xba282b(0x241)],_0x40b01c=_0x3e8c82[_0xba282b(0x203)]['id'],_0x225cd3=await sales_order[_0xba282b(0x1cb)](_0x40b01c),_0x53f1ae=await sales_order[_0xba282b(0x240)]([{'$match':{'_id':_0x5d6796(_0x40b01c)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0xba282b(0x223)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0xba282b(0x1ce)}}},{'$lookup':{'from':_0xba282b(0x1f6),'localField':_0xba282b(0x266),'foreignField':_0xba282b(0x257),'as':_0xba282b(0x1f9)}},{'$unwind':_0xba282b(0x1d5)},{'$lookup':{'from':'staffs','localField':'wms_account_id','foreignField':_0xba282b(0x257),'as':_0xba282b(0x1e2)}},{'$unwind':_0xba282b(0x25f)}]);if(_0x8c6081[0x0][_0xba282b(0x269)]==_0xba282b(0x1e5))var _0xcf10ae=users[_0xba282b(0x213)];else{if(_0x8c6081[0x0][_0xba282b(0x269)]==_0xba282b(0x25c))var _0xcf10ae=users[_0xba282b(0x25c)];else{if(_0x8c6081[0x0][_0xba282b(0x269)]==_0xba282b(0x21d))var _0xcf10ae=users[_0xba282b(0x21d)];else{if(_0x8c6081[0x0]['language']==_0xba282b(0x1dd))var _0xcf10ae=users[_0xba282b(0x1dd)];else{if(_0x8c6081[0x0][_0xba282b(0x269)]==_0xba282b(0x23e))var _0xcf10ae=users['French'];else{if(_0x8c6081[0x0]['language']==_0xba282b(0x216))var _0xcf10ae=users[_0xba282b(0x20b)];else{if(_0x8c6081[0x0][_0xba282b(0x269)]==_0xba282b(0x252))var _0xcf10ae=users['Chinese'];else{if(_0x8c6081[0x0]['language']==_0xba282b(0x267))var _0xcf10ae=users[_0xba282b(0x1f0)];}}}}}}}_0x30fd91[_0xba282b(0x263)]('view_accounting_approval',{'success':_0x3e8c82[_0xba282b(0x24c)](_0xba282b(0x1e3)),'errors':_0x3e8c82['flash'](_0xba282b(0x220)),'master_shop':_0x8c6081,'profile':_0x56bb28,'role':_0x3dd8df,'language':_0xcf10ae,'customer':_0xb1e555,'sales_sa':_0x225cd3,'approvers':_0x53f1ae[0x0],'the_id':_0x40b01c});}catch(_0x115456){console['log'](_0x115456);}}),router['post'](a0_0x1d1fbf(0x1fb),auth,async(_0x357eea,_0x399e1a)=>{var _0x23617f=a0_0x1d1fbf;try{const {warehouse_name:_0x3779c6,product_code:_0x48e119}=_0x357eea[_0x23617f(0x201)],_0x44ffc4=await warehouse['aggregate']([{'$match':{'name':_0x3779c6}},{'$unwind':_0x23617f(0x1ff)},{'$match':{'product_details.product_code':_0x48e119}},{'$group':{'_id':{'room':_0x23617f(0x229),'_id':'$_id'}}}]);_0x399e1a[_0x23617f(0x204)](_0x44ffc4);}catch(_0x1fcec9){}}),router['post'](a0_0x1d1fbf(0x1ca),auth,async(_0x57c5a7,_0x2348bb)=>{var _0x33f40b=a0_0x1d1fbf;try{const {warehouse_name:_0x2cf1fe,product_code:_0x156b67,room_name:_0x27bb5c}=_0x57c5a7['body'];console['log'](_0x57c5a7[_0x33f40b(0x201)]);const _0xa3181f=await warehouse[_0x33f40b(0x240)]([{'$match':{'name':_0x2cf1fe,'room':_0x27bb5c}},{'$unwind':_0x33f40b(0x1ff)},{'$match':{'product_details.product_code':_0x156b67}},{'$group':{'_id':{'main_id':_0x33f40b(0x25d),'detl_id':_0x33f40b(0x1f7),'product_name':_0x33f40b(0x1c8),'product_code':'$product_details.product_code','level':'$product_details.level','bay':'$product_details.bay','stocks':_0x33f40b(0x238)}}}]);_0x2348bb[_0x33f40b(0x204)](_0xa3181f);}catch(_0x1349fd){}}),router['get'](a0_0x1d1fbf(0x205),auth,async(_0x44dc6d,_0x59db2f)=>{var _0x3558aa=a0_0x1d1fbf;try{const {sttaff_id:_0x4a74fa,email:_0x4f4109,warehouse:_0x55da43}=_0x44dc6d[_0x3558aa(0x250)],_0xd26fc0=await master_shop['find'](),_0x5374b6=_0x44dc6d[_0x3558aa(0x250)],_0xfaf347=await profile[_0x3558aa(0x23d)]({'email':_0x5374b6[_0x3558aa(0x1fc)]}),_0x2d796b=await sales_order[_0x3558aa(0x21f)]({'wms_account_id':_0x4a74fa});if(_0xd26fc0[0x0]['language']==_0x3558aa(0x1e5))var _0x24e1b6=users[_0x3558aa(0x213)];else{if(_0xd26fc0[0x0][_0x3558aa(0x269)]==_0x3558aa(0x25c))var _0x24e1b6=users[_0x3558aa(0x25c)];else{if(_0xd26fc0[0x0][_0x3558aa(0x269)]==_0x3558aa(0x21d))var _0x24e1b6=users[_0x3558aa(0x21d)];else{if(_0xd26fc0[0x0][_0x3558aa(0x269)]==_0x3558aa(0x1dd))var _0x24e1b6=users[_0x3558aa(0x1dd)];else{if(_0xd26fc0[0x0][_0x3558aa(0x269)]==_0x3558aa(0x23e))var _0x24e1b6=users[_0x3558aa(0x23e)];else{if(_0xd26fc0[0x0][_0x3558aa(0x269)]=='Portuguese\x20(BR)')var _0x24e1b6=users[_0x3558aa(0x20b)];else{if(_0xd26fc0[0x0][_0x3558aa(0x269)]==_0x3558aa(0x252))var _0x24e1b6=users['Chinese'];else{if(_0xd26fc0[0x0][_0x3558aa(0x269)]==_0x3558aa(0x267))var _0x24e1b6=users[_0x3558aa(0x1f0)];}}}}}}}_0x59db2f[_0x3558aa(0x263)](_0x3558aa(0x22f),{'success':_0x44dc6d[_0x3558aa(0x24c)](_0x3558aa(0x1e3)),'errors':_0x44dc6d[_0x3558aa(0x24c)]('errors'),'master_shop':_0xd26fc0,'profile':_0xfaf347,'role':_0x5374b6,'language':_0x24e1b6,'sales_order':_0x2d796b});}catch(_0x320d7a){}}),module[a0_0x1d1fbf(0x268)]=router;