var a0_0x31383c=a0_0x5417;function a0_0x13bf(){var _0x2495c3=['express','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','expiry_date','post','toLocaleDateString','maxperunit','room_name','warehouse_detl','invoice_init','gross_price','find','secondary_code','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','$product_details.product_code','40aTwBxI','Arabic\x20(ae)','<strong>\x20Regards\x20</strong>','672528mctYIK','<h5>\x20JEC\x20SMS\x20</h5>','abs','Router','product_details','Email\x20for\x20Customer','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','ObjectId','308SdZxgV','Hindi','secondary_unit','</thead>','$product_details.level','1636227WWQvlb','redirect','German','exceljs','product_name','sendMail','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','email','id_transaction_from','password','English','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.product_name','flash','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','date_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','split','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','language','save','unit','/upload/','$wms_account_id','outgoing_invoice','False','Spanish','aggregate','$product_details','English\x20(US)','product_stock','port','<tbody\x20style=\x22text-align:\x20center;\x22>','21QgDYKO','/data/data_loc','<html><head><title></title>','</tbody>','padStart','forEach','exports','/all_sales_finished/preview/','9769464cSSGKF','invoice','<tr>','production_date','4332200HlJiio','headers','qty','mongoose','level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','log','OUT-','sale_product','data_loc','body','string','outgoing_id','protocol','accounting_account_id','<!DOCTYPE\x20html>','$accounting_account_id','errors','../models/all_models','Portuguese\x20(BR)','document_number_out','Email\x20sent\x20successfully','167334AhPGgZ','filter','../middleware/auth','get','render','<span>\x20Request\x20ID:\x20<b>','image','date','toString','logo','Types','request_qty','staffs','prod_id','params','$room','Portuguese','Sales\x20Add\x20successfully','product_code','_id','findById','</table>','maxPerUnit','Chinese','$_id','length','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','christian.villamer@jakagroup.com','findOne','</head><body>','://','uuid','<span>\x20Request\x20Date:\x20<b>','success','<table\x20style=\x22width:\x20100%\x20!important;\x22>','wms_account_confirm','French','/data/All','</div>','/view_sales_order/:id','xlsx','wms_account_id','37tMQdzb','nodemailer','</body></html>','37350687GrZJnM','Arabic','</tr>','wms_data','user','account_data','quantity','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','primary_code','back','41012QPDCdJ','<hr\x20class=\x22my-3\x22>','push','map','/:id','json','bay','host','<div>','</td>','</b></span>\x20<br><br>','</b></span>\x20<br>'];a0_0x13bf=function(){return _0x2495c3;};return a0_0x13bf();}(function(_0x4ef4c4,_0x24907c){var _0xe9dda9=a0_0x5417,_0x314dda=_0x4ef4c4();while(!![]){try{var _0x208dcf=-parseInt(_0xe9dda9(0x1cf))/0x1*(-parseInt(_0xe9dda9(0x1dc))/0x2)+-parseInt(_0xe9dda9(0x227))/0x3*(parseInt(_0xe9dda9(0x1f9))/0x4)+parseInt(_0xe9dda9(0x233))/0x5+-parseInt(_0xe9dda9(0x249))/0x6*(parseInt(_0xe9dda9(0x201))/0x7)+-parseInt(_0xe9dda9(0x22f))/0x8+parseInt(_0xe9dda9(0x206))/0x9*(-parseInt(_0xe9dda9(0x1f6))/0xa)+parseInt(_0xe9dda9(0x1d2))/0xb;if(_0x208dcf===_0x24907c)break;else _0x314dda['push'](_0x314dda['shift']());}catch(_0x1b9651){_0x314dda['push'](_0x314dda['shift']());}}}(a0_0x13bf,0xa3254));const express=require(a0_0x31383c(0x1e8)),app=express(),router=express[a0_0x31383c(0x1fc)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x31383c(0x245)),auth=require(a0_0x31383c(0x24b)),users=require('../public/language/languages.json'),excelJS=require(a0_0x31383c(0x209)),xlsx=require(a0_0x31383c(0x1cd)),mongoose=require(a0_0x31383c(0x236)),{ObjectId}=require('mongodb'),nodemailer=require(a0_0x31383c(0x1d0));function a0_0x5417(_0x4da36e,_0x4e16b2){var _0x13bfe5=a0_0x13bf();return a0_0x5417=function(_0x541746,_0x4970e4){_0x541746=_0x541746-0x1cd;var _0x5a88ab=_0x13bfe5[_0x541746];return _0x5a88ab;},a0_0x5417(_0x4da36e,_0x4e16b2);}router['get'](a0_0x31383c(0x1e0),auth,async(_0x1a46b4,_0x30daa5)=>{var _0x28c0af=a0_0x31383c;try{const _0x2ee21a=await master_shop['find'](),_0x4fdca3=_0x1a46b4[_0x28c0af(0x1d6)],_0x1a0d1d=await profile[_0x28c0af(0x265)]({'email':_0x4fdca3[_0x28c0af(0x20d)]}),_0x31ca5b=await staff[_0x28c0af(0x265)]({'email':_0x4fdca3[_0x28c0af(0x20d)]}),_0x2ba823=await customer[_0x28c0af(0x1f2)]({'agent_id':_0x31ca5b['_id']}),_0x25ec07=mongoose['Types'][_0x28c0af(0x200)],_0x28fdfe=_0x1a46b4['params']['id'],_0x38c5f4=await sales_order[_0x28c0af(0x25d)](_0x28fdfe),_0x4ad11a=await sales_order[_0x28c0af(0x221)]([{'$match':{'_id':_0x25ec07(_0x28fdfe)}},{'$addFields':{'accounting_account_id':{'$toObjectId':'$accounting_account_id'}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x28c0af(0x21d)}}},{'$lookup':{'from':_0x28c0af(0x255),'localField':_0x28c0af(0x241),'foreignField':'_id','as':_0x28c0af(0x1d7)}},{'$unwind':'$account_data'},{'$lookup':{'from':_0x28c0af(0x255),'localField':_0x28c0af(0x1ce),'foreignField':'_id','as':_0x28c0af(0x1d5)}},{'$unwind':'$wms_data'}]);if(_0x2ee21a[0x0][_0x28c0af(0x219)]==_0x28c0af(0x223))var _0x137612=users[_0x28c0af(0x210)];else{if(_0x2ee21a[0x0][_0x28c0af(0x219)]==_0x28c0af(0x202))var _0x137612=users['Hindi'];else{if(_0x2ee21a[0x0][_0x28c0af(0x219)]=='German')var _0x137612=users[_0x28c0af(0x208)];else{if(_0x2ee21a[0x0][_0x28c0af(0x219)]==_0x28c0af(0x220))var _0x137612=users[_0x28c0af(0x220)];else{if(_0x2ee21a[0x0]['language']==_0x28c0af(0x26d))var _0x137612=users[_0x28c0af(0x26d)];else{if(_0x2ee21a[0x0][_0x28c0af(0x219)]==_0x28c0af(0x246))var _0x137612=users['Portuguese'];else{if(_0x2ee21a[0x0][_0x28c0af(0x219)]==_0x28c0af(0x260))var _0x137612=users['Chinese'];else{if(_0x2ee21a[0x0][_0x28c0af(0x219)]=='Arabic\x20(ae)')var _0x137612=users[_0x28c0af(0x1d3)];}}}}}}}_0x30daa5[_0x28c0af(0x24d)]('warehouse_approval',{'success':_0x1a46b4[_0x28c0af(0x213)](_0x28c0af(0x26a)),'errors':_0x1a46b4[_0x28c0af(0x213)](_0x28c0af(0x244)),'master_shop':_0x2ee21a,'profile':_0x1a0d1d,'role':_0x4fdca3,'language':_0x137612,'customer':_0x2ba823,'sales_sa':_0x38c5f4,'approvers':_0x4ad11a[0x0],'the_id':_0x28fdfe});}catch(_0x453a33){console['log'](_0x453a33);}}),router[a0_0x31383c(0x1eb)](a0_0x31383c(0x1e0),auth,async(_0x4d5a38,_0x44ce98)=>{var _0x4515a0=a0_0x31383c;try{const {date:_0x92d8e,invoice_data:_0x389b04,wms_confirm:_0x5fdb88,the_id_val:_0x12ea30,prod_id:_0x373b91,SCRN:_0x5816ce,ReqBy:_0xc2b3e,dateofreq:_0x49e65d,PO_number:_0x55cc06,warehouse_name:_0x55f0fc,typeservicesData:_0x533e90,typevehicle:_0x131ff8,destination:_0x169d13,deliverydate:_0x39ade3,driver:_0x2177c1,plate:_0x1daf45,van:_0x5e2469,DRSI:_0x498031,TSU:_0x49f5e6,TFU:_0x528589,note:_0x3dc0e8}=_0x4d5a38[_0x4515a0(0x23d)],_0x490862=await sales_order[_0x4515a0(0x25d)](_0x12ea30);if(typeof _0x373b91==_0x4515a0(0x23e))var _0x832d76=[_0x4d5a38[_0x4515a0(0x23d)][_0x4515a0(0x256)]],_0x5524a4=[_0x4d5a38['body']['qty']],_0x4e55c3=[_0x4d5a38[_0x4515a0(0x23d)][_0x4515a0(0x23c)]];else var _0x832d76=[..._0x4d5a38[_0x4515a0(0x23d)][_0x4515a0(0x256)]],_0x5524a4=[..._0x4d5a38[_0x4515a0(0x23d)][_0x4515a0(0x235)]],_0x4e55c3=[..._0x4d5a38[_0x4515a0(0x23d)][_0x4515a0(0x23c)]];const _0x526789=_0x832d76[_0x4515a0(0x1df)](_0x474428=>{return _0x474428={'prod_id':_0x474428};});_0x4e55c3[_0x4515a0(0x22c)]((_0x587b8a,_0x3f6199)=>{var _0x4383bc=_0x4515a0,_0x442a82=_0x587b8a[_0x4383bc(0x217)]('~');_0x526789[_0x3f6199]['warehouse_id']=_0x442a82[0x0],_0x526789[_0x3f6199][_0x4383bc(0x1ef)]=_0x442a82[0x1];}),_0x5524a4[_0x4515a0(0x22c)]((_0x235481,_0xba552c)=>{_0x526789[_0xba552c]['request_qty']=_0x235481;});var _0x34a71d=[],_0x1f1dc0=[],_0x10a499=[],_0x2d7d34=[],_0x4605cb=[],_0x328a02=[],_0x31f69a=[],_0x4b474b=[],_0x4d5cdc=[],_0xe0706c=[],_0x40f010=[],_0x3b634b=[],_0x2871d9=[],_0x3eaafd=[],_0x5ec42f=[],_0x46b81e=[],_0x3c1cf3=[],_0x499a6e=[],_0xf19507=[],_0xee03d9=[];for(let _0x1e3af2=0x0;_0x1e3af2<=_0x526789[_0x4515a0(0x262)]-0x1;_0x1e3af2++){const _0x507550=_0x526789[_0x1e3af2],_0x6ad0ac=mongoose['Types'][_0x4515a0(0x200)];var _0xd0972b=await warehouse[_0x4515a0(0x221)]([{'$match':{'_id':_0x6ad0ac(_0x507550['warehouse_id'])}},{'$unwind':_0x4515a0(0x222)},{'$match':{'product_details._id':_0x6ad0ac(_0x507550['warehouse_detl'])}}]),_0x438244=0x0;for(let _0x347dda=0x0;_0x347dda<=_0xd0972b[_0x4515a0(0x262)]-0x1;_0x347dda++){var _0x2a83e2=_0xd0972b[_0x347dda];_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x224)]<_0x507550[_0x4515a0(0x254)]&&_0x438244++;}if(_0x438244>0x0)return _0x4d5a38[_0x4515a0(0x213)](_0x4515a0(0x244),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x44ce98[_0x4515a0(0x207)](_0x4515a0(0x1db));var _0x2d6576=0x0;for(let _0x5a452c=0x0;_0x5a452c<=_0xd0972b[_0x4515a0(0x262)]-0x1;_0x5a452c++){var _0x2a83e2=_0xd0972b[_0x5a452c];_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x224)]>_0x507550[_0x4515a0(0x254)]&&(_0x34a71d['push'](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x20a)]),_0x1f1dc0[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)]['product_stock']),_0x10a499[_0x4515a0(0x1de)](_0x507550['request_qty']),_0x2d7d34[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x1da)]),_0x4605cb[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x1f3)]),_0x328a02[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x25b)]),_0x31f69a[_0x4515a0(0x1de)](_0x2a83e2['product_details']['level']),_0x4b474b[_0x4515a0(0x1de)](_0x2a83e2['product_details'][_0x4515a0(0x1e2)]),_0x4d5cdc['push'](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x21b)]),_0xe0706c[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x203)]),_0x40f010[_0x4515a0(0x1de)](_0x2a83e2['product_details']['batch_code']),_0x3b634b[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x1ea)]),_0x2871d9['push'](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x232)]),_0x3eaafd[_0x4515a0(0x1de)](_0x2a83e2['product_details'][_0x4515a0(0x25f)]),_0x5ec42f['push'](_0x2a83e2[_0x4515a0(0x1fd)]['product_cat']),_0x46b81e[_0x4515a0(0x1de)](_0x2a83e2['room']),_0x3c1cf3[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)]['invoice']),_0x499a6e[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x25c)]),_0xf19507[_0x4515a0(0x1de)](_0x2a83e2[_0x4515a0(0x1fd)][_0x4515a0(0x268)]),_0xee03d9[_0x4515a0(0x1de)](_0x2a83e2['product_details'][_0x4515a0(0x1f1)]),_0x2d6576++);}}const _0x48aca2=_0x34a71d['map'](_0x93e131=>{return _0x93e131={'product_name':_0x93e131};});_0x1f1dc0[_0x4515a0(0x22c)]((_0x2411d9,_0x13a4ca)=>{_0x48aca2[_0x13a4ca]['stock']=_0x2411d9;}),_0x10a499['forEach']((_0x25c683,_0x3ea429)=>{var _0x45ec0b=_0x4515a0;_0x48aca2[_0x3ea429][_0x45ec0b(0x1d8)]=Math[_0x45ec0b(0x1fb)](_0x25c683);}),_0xee03d9['forEach']((_0xebb003,_0x4987cf)=>{var _0x189191=_0x4515a0;_0x48aca2[_0x4987cf][_0x189191(0x1f1)]=_0xebb003;}),_0xf19507['forEach']((_0x144d4b,_0x45babe)=>{var _0x2f4b6e=_0x4515a0;_0x48aca2[_0x45babe][_0x2f4b6e(0x268)]=_0x144d4b;}),_0x499a6e[_0x4515a0(0x22c)]((_0x236329,_0x126889)=>{var _0x22bcb3=_0x4515a0;_0x48aca2[_0x126889][_0x22bcb3(0x20e)]=_0x236329;}),_0x2d7d34['forEach']((_0x26f5bf,_0x421855)=>{var _0x2a464b=_0x4515a0;_0x48aca2[_0x421855][_0x2a464b(0x1da)]=_0x26f5bf;}),_0x4605cb[_0x4515a0(0x22c)]((_0x547666,_0x2fec0d)=>{_0x48aca2[_0x2fec0d]['secondary_code']=_0x547666;}),_0x328a02[_0x4515a0(0x22c)]((_0x13a5af,_0x3d5484)=>{var _0x3f10f9=_0x4515a0;_0x48aca2[_0x3d5484][_0x3f10f9(0x25b)]=_0x13a5af;}),_0x31f69a[_0x4515a0(0x22c)]((_0x2aefc5,_0x40382e)=>{var _0x1e0a79=_0x4515a0;_0x48aca2[_0x40382e][_0x1e0a79(0x237)]=_0x2aefc5;}),_0x4b474b[_0x4515a0(0x22c)]((_0xf4652a,_0xbdec88)=>{var _0x3a8acb=_0x4515a0;_0x48aca2[_0xbdec88][_0x3a8acb(0x1e2)]=_0xf4652a;}),_0x4d5cdc[_0x4515a0(0x22c)]((_0x394de5,_0x1d0acc)=>{var _0x15ef50=_0x4515a0;_0x48aca2[_0x1d0acc][_0x15ef50(0x21b)]=_0x394de5;}),_0xe0706c[_0x4515a0(0x22c)]((_0x520a55,_0x34f85e)=>{var _0x22878c=_0x4515a0;_0x48aca2[_0x34f85e][_0x22878c(0x203)]=_0x520a55;}),_0x40f010[_0x4515a0(0x22c)]((_0x2c58f4,_0x163729)=>{_0x48aca2[_0x163729]['batch_code']=_0x2c58f4;}),_0x3b634b['forEach']((_0x460a4f,_0x1e6b6d)=>{var _0x3d9132=_0x4515a0;_0x48aca2[_0x1e6b6d][_0x3d9132(0x1ea)]=_0x460a4f;}),_0x2871d9[_0x4515a0(0x22c)]((_0x11a939,_0x559e31)=>{var _0x2b8e6c=_0x4515a0;_0x48aca2[_0x559e31][_0x2b8e6c(0x232)]=_0x11a939;}),_0x3eaafd[_0x4515a0(0x22c)]((_0x1cc6be,_0x271b87)=>{var _0x59871f=_0x4515a0;_0x48aca2[_0x271b87][_0x59871f(0x1ed)]=_0x1cc6be;}),_0x5ec42f['forEach']((_0x8d4f44,_0x559469)=>{_0x48aca2[_0x559469]['prod_cat']=_0x8d4f44;}),_0x46b81e['forEach']((_0x17e673,_0x556080)=>{var _0x433ec5=_0x4515a0;_0x48aca2[_0x556080][_0x433ec5(0x1ee)]=_0x17e673;}),_0x3c1cf3[_0x4515a0(0x22c)]((_0x53f7ef,_0x4299f7)=>{var _0x26021d=_0x4515a0;_0x48aca2[_0x4299f7][_0x26021d(0x230)]=_0x53f7ef,_0x48aca2[_0x4299f7][_0x26021d(0x215)]=_0x92d8e;});const _0x27b364=new invoice_for_outgoing();await _0x27b364[_0x4515a0(0x21a)](),_0x3c1cf3[_0x4515a0(0x22c)]((_0x2920a0,_0x2fe4ef)=>{var _0x2420bd=_0x4515a0;_0x48aca2[_0x2fe4ef][_0x2420bd(0x21e)]='OUT-'+_0x27b364[_0x2420bd(0x1f0)][_0x2420bd(0x251)]()[_0x2420bd(0x22b)](0x8,'0');});const _0x2c3ba1=_0x48aca2[_0x4515a0(0x24a)](_0x587d82=>_0x587d82['quantity']!=='0'&&_0x587d82[_0x4515a0(0x1d8)]!==''),_0x5931c1=new sales_finished({'invoice':_0x4515a0(0x23a)+_0x27b364[_0x4515a0(0x1f0)]['toString']()[_0x4515a0(0x22b)](0x8,'0'),'date':_0x92d8e,'warehouse_name':_0x55f0fc,'sale_product':_0x2c3ba1,'note':_0x3dc0e8,'SCRN':_0x5816ce,'finalize':_0x4515a0(0x21f),'ReqBy':_0xc2b3e,'dateofreq':_0x49e65d,'PO_number':_0x55cc06,'typeservicesData':_0x533e90,'typevehicle':_0x131ff8,'destination':_0x169d13,'deliverydate':_0x39ade3,'driver':_0x2177c1,'plate':_0x1daf45,'van':_0x5e2469,'DRSI':_0x498031,'TSU':_0x49f5e6,'TFU':_0x528589}),_0x355a4f=await _0x5931c1[_0x4515a0(0x21a)](),_0x3939c2=new Date(),_0x59d7cf=_0x3939c2[_0x4515a0(0x1ec)]();_0x490862[_0x4515a0(0x26c)]=_0x5fdb88,_0x490862['wms_account_date']=_0x59d7cf,_0x490862[_0x4515a0(0x247)]=_0x4515a0(0x23a)+_0x27b364[_0x4515a0(0x1f0)][_0x4515a0(0x251)]()['padStart'](0x8,'0'),_0x490862[_0x4515a0(0x23f)]=_0x355a4f[_0x4515a0(0x25c)],await _0x490862[_0x4515a0(0x21a)]();const _0x39ab20=await master_shop[_0x4515a0(0x1f2)](),_0x653d4d=await email_settings[_0x4515a0(0x265)]();let _0x39a3ad=nodemailer['createTransport']({'host':_0x653d4d[_0x4515a0(0x1e3)],'port':Number(_0x653d4d[_0x4515a0(0x225)]),'secure':![],'auth':{'user':_0x653d4d[_0x4515a0(0x20d)],'pass':_0x653d4d[_0x4515a0(0x20f)]}});const _0x4bcef8=_0x4d5a38[_0x4515a0(0x240)]+_0x4515a0(0x267)+_0x4d5a38[_0x4515a0(0x234)][_0x4515a0(0x1e3)];var _0x36d204=_0x490862[_0x4515a0(0x23b)],_0x268e41='',_0x4138ee,_0x119faa=0x0;for(_0x4138ee in _0x36d204){_0x268e41+=_0x4515a0(0x231)+_0x4515a0(0x211)+_0x36d204[_0x4138ee][_0x4515a0(0x20a)]+_0x4515a0(0x1e5)+_0x4515a0(0x211)+_0x36d204[_0x4138ee]['product_code']+'</td>'+_0x4515a0(0x211)+_0x36d204[_0x4138ee][_0x4515a0(0x1d8)]+_0x4515a0(0x1e5)+_0x4515a0(0x211)+_0x36d204[_0x4138ee][_0x4515a0(0x21b)]+_0x4515a0(0x1e5)+_0x4515a0(0x1d4),_0x119faa+=parseInt(_0x36d204[_0x4138ee][_0x4515a0(0x1d8)]);}let _0x4aa84c={'from':_0x653d4d[_0x4515a0(0x20d)],'to':_0x4515a0(0x264),'subject':_0x4515a0(0x1fe),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x4515a0(0x21c)+_0x39ab20[0x0][_0x4515a0(0x24f)],'cid':_0x4515a0(0x252)}],'html':_0x4515a0(0x242)+_0x4515a0(0x229)+_0x4515a0(0x20c)+_0x4515a0(0x266)+_0x4515a0(0x1e4)+_0x4515a0(0x263)+_0x4515a0(0x1e4)+_0x4515a0(0x218)+_0x4515a0(0x26f)+_0x4515a0(0x1e4)+'<h2>\x20JEC\x20SMS\x20</h2>'+_0x4515a0(0x26f)+_0x4515a0(0x26f)+_0x4515a0(0x1dd)+'<div>'+_0x4515a0(0x26f)+_0x4515a0(0x1e4)+'<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>'+_0x4515a0(0x26f)+_0x4515a0(0x1e4)+_0x4515a0(0x24e)+_0x490862['invoice']+_0x4515a0(0x1e7)+_0x4515a0(0x269)+_0x490862[_0x4515a0(0x250)]+_0x4515a0(0x1e6)+_0x4515a0(0x26f)+_0x4515a0(0x26b)+_0x4515a0(0x1ff)+_0x4515a0(0x231)+_0x4515a0(0x214)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x4515a0(0x216)+_0x4515a0(0x238)+_0x4515a0(0x1d4)+_0x4515a0(0x204)+_0x4515a0(0x226)+'\x20'+_0x268e41+'\x20'+_0x4515a0(0x22a)+_0x4515a0(0x25e)+_0x4515a0(0x1e4)+_0x4515a0(0x1f4)+_0x4515a0(0x1d9)+'<br><br><br>'+_0x4515a0(0x26f)+_0x4515a0(0x1e4)+_0x4515a0(0x1f8)+_0x4515a0(0x1fa)+_0x4515a0(0x26f)+_0x4515a0(0x26f)+_0x4515a0(0x1e9)+_0x4515a0(0x1d1)};_0x39a3ad[_0x4515a0(0x20b)](_0x4aa84c,function(_0x3a2c81,_0x5e43df){var _0x5a34f2=_0x4515a0;_0x3a2c81?(console['log'](_0x3a2c81),console['log']('Error\x20Occurs')):console[_0x5a34f2(0x239)](_0x5a34f2(0x248));}),_0x4d5a38[_0x4515a0(0x213)](_0x4515a0(0x26a),_0x4515a0(0x25a)),_0x44ce98['redirect'](_0x4515a0(0x22e)+_0x355a4f[_0x4515a0(0x25c)]),_0x44ce98[_0x4515a0(0x1e1)](_0x2c3ba1);return;}catch(_0x512e24){}}),router[a0_0x31383c(0x24c)](a0_0x31383c(0x270),auth,async(_0x4cb43a,_0x15e1fa)=>{var _0x238397=a0_0x31383c;try{const _0x46939c=await master_shop[_0x238397(0x1f2)](),_0x37b84c=_0x4cb43a[_0x238397(0x1d6)],_0x422371=await profile[_0x238397(0x265)]({'email':_0x37b84c[_0x238397(0x20d)]}),_0x394487=await staff[_0x238397(0x265)]({'email':_0x37b84c[_0x238397(0x20d)]}),_0x4caac5=await customer[_0x238397(0x1f2)]({'agent_id':_0x394487[_0x238397(0x25c)]}),_0x1c09ca=mongoose[_0x238397(0x253)][_0x238397(0x200)],_0x3c99e1=_0x4cb43a[_0x238397(0x257)]['id'],_0x24319a=await sales_order[_0x238397(0x25d)](_0x3c99e1),_0x232472=await sales_order['aggregate']([{'$match':{'_id':_0x1c09ca(_0x3c99e1)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x238397(0x243)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x238397(0x21d)}}},{'$lookup':{'from':_0x238397(0x255),'localField':'accounting_account_id','foreignField':_0x238397(0x25c),'as':_0x238397(0x1d7)}},{'$unwind':'$account_data'},{'$lookup':{'from':_0x238397(0x255),'localField':'wms_account_id','foreignField':'_id','as':_0x238397(0x1d5)}},{'$unwind':'$wms_data'}]);if(_0x46939c[0x0][_0x238397(0x219)]==_0x238397(0x223))var _0x46562d=users[_0x238397(0x210)];else{if(_0x46939c[0x0][_0x238397(0x219)]==_0x238397(0x202))var _0x46562d=users[_0x238397(0x202)];else{if(_0x46939c[0x0]['language']==_0x238397(0x208))var _0x46562d=users[_0x238397(0x208)];else{if(_0x46939c[0x0][_0x238397(0x219)]==_0x238397(0x220))var _0x46562d=users[_0x238397(0x220)];else{if(_0x46939c[0x0][_0x238397(0x219)]==_0x238397(0x26d))var _0x46562d=users['French'];else{if(_0x46939c[0x0]['language']==_0x238397(0x246))var _0x46562d=users[_0x238397(0x259)];else{if(_0x46939c[0x0][_0x238397(0x219)]==_0x238397(0x260))var _0x46562d=users[_0x238397(0x260)];else{if(_0x46939c[0x0][_0x238397(0x219)]==_0x238397(0x1f7))var _0x46562d=users[_0x238397(0x1d3)];}}}}}}}_0x15e1fa[_0x238397(0x24d)]('view_accounting_approval',{'success':_0x4cb43a['flash'](_0x238397(0x26a)),'errors':_0x4cb43a[_0x238397(0x213)]('errors'),'master_shop':_0x46939c,'profile':_0x422371,'role':_0x37b84c,'language':_0x46562d,'customer':_0x4caac5,'sales_sa':_0x24319a,'approvers':_0x232472[0x0],'the_id':_0x3c99e1});}catch(_0x10e50d){console[_0x238397(0x239)](_0x10e50d);}}),router[a0_0x31383c(0x1eb)]('/data/data_rack',auth,async(_0x5b6aed,_0x4b8207)=>{var _0xd5771=a0_0x31383c;try{const {warehouse_name:_0x3e459c,product_code:_0x4c8089}=_0x5b6aed[_0xd5771(0x23d)],_0x4e4f17=await warehouse[_0xd5771(0x221)]([{'$match':{'name':_0x3e459c}},{'$unwind':_0xd5771(0x222)},{'$match':{'product_details.product_code':_0x4c8089}},{'$group':{'_id':{'room':_0xd5771(0x258),'_id':_0xd5771(0x261)}}}]);_0x4b8207[_0xd5771(0x1e1)](_0x4e4f17);}catch(_0x28cec7){}}),router[a0_0x31383c(0x1eb)](a0_0x31383c(0x228),auth,async(_0x3fa6e3,_0x5a3acf)=>{var _0x4acadf=a0_0x31383c;try{const {warehouse_name:_0x37c797,product_code:_0x39ecbe,room_name:_0x40d182}=_0x3fa6e3[_0x4acadf(0x23d)];console['log'](_0x3fa6e3[_0x4acadf(0x23d)]);const _0x2ee702=await warehouse[_0x4acadf(0x221)]([{'$match':{'name':_0x37c797,'room':_0x40d182}},{'$unwind':_0x4acadf(0x222)},{'$match':{'product_details.product_code':_0x39ecbe}},{'$group':{'_id':{'main_id':_0x4acadf(0x261),'detl_id':'$product_details._id','product_name':_0x4acadf(0x212),'product_code':_0x4acadf(0x1f5),'level':_0x4acadf(0x205),'bay':'$product_details.bay','stocks':'$product_details.product_stock'}}}]);_0x5a3acf[_0x4acadf(0x1e1)](_0x2ee702);}catch(_0x5d66ed){}}),router['get'](a0_0x31383c(0x26e),auth,async(_0x30b96d,_0x2ade78)=>{var _0x452817=a0_0x31383c;try{const {sttaff_id:_0x2f745e,email:_0x355f3c,warehouse:_0x34715a}=_0x30b96d['user'],_0x3bc610=await master_shop['find'](),_0x4b3a7d=_0x30b96d[_0x452817(0x1d6)],_0x10b288=await profile[_0x452817(0x265)]({'email':_0x4b3a7d['email']}),_0x3e6ad6=await sales_order['find']({'wms_account_id':_0x2f745e});if(_0x3bc610[0x0][_0x452817(0x219)]==_0x452817(0x223))var _0x1721a7=users[_0x452817(0x210)];else{if(_0x3bc610[0x0][_0x452817(0x219)]==_0x452817(0x202))var _0x1721a7=users[_0x452817(0x202)];else{if(_0x3bc610[0x0][_0x452817(0x219)]==_0x452817(0x208))var _0x1721a7=users[_0x452817(0x208)];else{if(_0x3bc610[0x0]['language']==_0x452817(0x220))var _0x1721a7=users[_0x452817(0x220)];else{if(_0x3bc610[0x0][_0x452817(0x219)]==_0x452817(0x26d))var _0x1721a7=users['French'];else{if(_0x3bc610[0x0][_0x452817(0x219)]==_0x452817(0x246))var _0x1721a7=users[_0x452817(0x259)];else{if(_0x3bc610[0x0][_0x452817(0x219)]==_0x452817(0x260))var _0x1721a7=users[_0x452817(0x260)];else{if(_0x3bc610[0x0]['language']=='Arabic\x20(ae)')var _0x1721a7=users[_0x452817(0x1d3)];}}}}}}}_0x2ade78['render']('warehouse_approval_All',{'success':_0x30b96d[_0x452817(0x213)](_0x452817(0x26a)),'errors':_0x30b96d[_0x452817(0x213)]('errors'),'master_shop':_0x3bc610,'profile':_0x10b288,'role':_0x4b3a7d,'language':_0x1721a7,'sales_order':_0x3e6ad6});}catch(_0x4a3bd4){}}),module[a0_0x31383c(0x22d)]=router;