var a0_0x2a082f=a0_0x3f19;(function(_0x104a40,_0x52e6b0){var _0x189870=a0_0x3f19,_0xa149f2=_0x104a40();while(!![]){try{var _0x12658d=parseInt(_0x189870(0xe4))/0x1*(-parseInt(_0x189870(0xdf))/0x2)+parseInt(_0x189870(0x156))/0x3+parseInt(_0x189870(0xbf))/0x4+parseInt(_0x189870(0x14f))/0x5*(parseInt(_0x189870(0xc3))/0x6)+parseInt(_0x189870(0xc6))/0x7*(-parseInt(_0x189870(0x161))/0x8)+parseInt(_0x189870(0x110))/0x9*(parseInt(_0x189870(0xbc))/0xa)+parseInt(_0x189870(0x135))/0xb;if(_0x12658d===_0x52e6b0)break;else _0xa149f2['push'](_0xa149f2['shift']());}catch(_0x29ee00){_0xa149f2['push'](_0xa149f2['shift']());}}}(a0_0x3d00,0x514ab));const express=require(a0_0x2a082f(0x103)),app=express(),router=express[a0_0x2a082f(0x149)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x2a082f(0xc7)),auth=require(a0_0x2a082f(0x113)),users=require(a0_0x2a082f(0xdb)),excelJS=require(a0_0x2a082f(0x12b)),xlsx=require(a0_0x2a082f(0x160)),mongoose=require(a0_0x2a082f(0x162)),{ObjectId}=require(a0_0x2a082f(0x12f)),nodemailer=require(a0_0x2a082f(0xe9));router[a0_0x2a082f(0x111)](a0_0x2a082f(0xe0),auth,async(_0x24020d,_0x1ab712)=>{var _0x59c0cb=a0_0x2a082f;try{const _0x522b46=await master_shop['find'](),_0x1ec50c=_0x24020d[_0x59c0cb(0xec)],_0x5b8707=await profile[_0x59c0cb(0xfc)]({'email':_0x1ec50c[_0x59c0cb(0x152)]}),_0x528584=await staff['findOne']({'email':_0x1ec50c['email']}),_0x4476c6=await customer['find']({'agent_id':_0x528584[_0x59c0cb(0x109)]}),_0x254542=mongoose['Types'][_0x59c0cb(0x112)],_0x1e9e8e=_0x24020d[_0x59c0cb(0xd4)]['id'],_0x397018=await sales_order[_0x59c0cb(0xbd)](_0x1e9e8e),_0x3ca0bf=await sales_order['aggregate']([{'$match':{'_id':_0x254542(_0x1e9e8e)}},{'$addFields':{'accounting_account_id':{'$toObjectId':'$accounting_account_id'}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x59c0cb(0x114)}}},{'$lookup':{'from':_0x59c0cb(0x134),'localField':_0x59c0cb(0x10e),'foreignField':_0x59c0cb(0x109),'as':'account_data'}},{'$unwind':_0x59c0cb(0x155)},{'$lookup':{'from':'staffs','localField':_0x59c0cb(0x10f),'foreignField':_0x59c0cb(0x109),'as':'wms_data'}},{'$unwind':_0x59c0cb(0x13b)}]);if(_0x522b46[0x0]['language']==_0x59c0cb(0xc0))var _0x1fae3a=users[_0x59c0cb(0xba)];else{if(_0x522b46[0x0][_0x59c0cb(0x13d)]==_0x59c0cb(0xfd))var _0x1fae3a=users['Hindi'];else{if(_0x522b46[0x0][_0x59c0cb(0x13d)]==_0x59c0cb(0x12a))var _0x1fae3a=users[_0x59c0cb(0x12a)];else{if(_0x522b46[0x0][_0x59c0cb(0x13d)]==_0x59c0cb(0xd2))var _0x1fae3a=users[_0x59c0cb(0xd2)];else{if(_0x522b46[0x0][_0x59c0cb(0x13d)]=='French')var _0x1fae3a=users['French'];else{if(_0x522b46[0x0][_0x59c0cb(0x13d)]=='Portuguese\x20(BR)')var _0x1fae3a=users['Portuguese'];else{if(_0x522b46[0x0]['language']=='Chinese')var _0x1fae3a=users[_0x59c0cb(0xd8)];else{if(_0x522b46[0x0]['language']==_0x59c0cb(0x13f))var _0x1fae3a=users[_0x59c0cb(0x10b)];}}}}}}}_0x1ab712[_0x59c0cb(0x131)](_0x59c0cb(0x148),{'success':_0x24020d[_0x59c0cb(0xe1)]('success'),'errors':_0x24020d['flash'](_0x59c0cb(0xdd)),'master_shop':_0x522b46,'profile':_0x5b8707,'role':_0x1ec50c,'language':_0x1fae3a,'customer':_0x4476c6,'sales_sa':_0x397018,'approvers':_0x3ca0bf[0x0],'the_id':_0x1e9e8e});}catch(_0x5560d1){console[_0x59c0cb(0x14a)](_0x5560d1);}}),router['post'](a0_0x2a082f(0xe0),auth,async(_0x5125e3,_0x1a2643)=>{var _0x1029c5=a0_0x2a082f;try{const {date:_0x13234f,invoice_data:_0x887770,wms_confirm:_0x4d087a,the_id_val:_0xfc8f98,prod_id:_0x2f7db0,SCRN:_0x4e681c,ReqBy:_0x36770d,dateofreq:_0x4b41b8,PO_number:_0x46906d,warehouse_name:_0x11f462,typeservicesData:_0x5eb9f7,typevehicle:_0x2de258,destination:_0x29cd65,deliverydate:_0x4f00d4,driver:_0x2c893e,plate:_0x2eeeb3,van:_0x3b81ef,DRSI:_0x55b5ed,TSU:_0x24809e,TFU:_0x4894b5,note:_0x27f2d2}=_0x5125e3['body'],_0x59f2d4=await sales_order[_0x1029c5(0xbd)](_0xfc8f98);if(typeof _0x2f7db0==_0x1029c5(0xf9))var _0x5f239f=[_0x5125e3[_0x1029c5(0xca)][_0x1029c5(0x132)]],_0x195145=[_0x5125e3[_0x1029c5(0xca)][_0x1029c5(0xce)]],_0x34b30d=[_0x5125e3[_0x1029c5(0xca)][_0x1029c5(0x138)]];else var _0x5f239f=[..._0x5125e3[_0x1029c5(0xca)][_0x1029c5(0x132)]],_0x195145=[..._0x5125e3[_0x1029c5(0xca)][_0x1029c5(0xce)]],_0x34b30d=[..._0x5125e3[_0x1029c5(0xca)]['data_loc']];const _0x19c7e0=_0x5f239f['map'](_0x2aa16e=>{return _0x2aa16e={'prod_id':_0x2aa16e};});_0x34b30d[_0x1029c5(0xbb)]((_0x5f24a7,_0x2310f7)=>{var _0x3b6ff4=_0x1029c5,_0x8ff2ae=_0x5f24a7[_0x3b6ff4(0x106)]('~');_0x19c7e0[_0x2310f7]['warehouse_id']=_0x8ff2ae[0x0],_0x19c7e0[_0x2310f7][_0x3b6ff4(0x10a)]=_0x8ff2ae[0x1];}),_0x195145[_0x1029c5(0xbb)]((_0x1866bf,_0x5d9f3c)=>{var _0x45b23f=_0x1029c5;_0x19c7e0[_0x5d9f3c][_0x45b23f(0x144)]=_0x1866bf;});var _0x2030e=[],_0x523662=[],_0x5a7d9e=[],_0x231714=[],_0x445a14=[],_0x1e5824=[],_0x1f5ae4=[],_0x4a39b2=[],_0x49523c=[],_0x3abaad=[],_0x4ef78f=[],_0x12eb4f=[],_0x296e45=[],_0x6b90b7=[],_0x237626=[],_0x4bc121=[],_0x121295=[],_0x268d8c=[],_0x206244=[],_0x1e5698=[];for(let _0x17abc4=0x0;_0x17abc4<=_0x19c7e0[_0x1029c5(0xbe)]-0x1;_0x17abc4++){const _0x479b0d=_0x19c7e0[_0x17abc4],_0xb5602e=mongoose[_0x1029c5(0x129)][_0x1029c5(0x112)];var _0x2b4031=await warehouse[_0x1029c5(0xb7)]([{'$match':{'_id':_0xb5602e(_0x479b0d[_0x1029c5(0x157)])}},{'$unwind':_0x1029c5(0xdc)},{'$match':{'product_details._id':_0xb5602e(_0x479b0d[_0x1029c5(0x10a)])}}]),_0x29ccf4=0x0;for(let _0x1cc921=0x0;_0x1cc921<=_0x2b4031[_0x1029c5(0xbe)]-0x1;_0x1cc921++){var _0x404e57=_0x2b4031[_0x1cc921];_0x404e57[_0x1029c5(0x101)][_0x1029c5(0xd9)]<_0x479b0d['request_qty']&&_0x29ccf4++;}if(_0x29ccf4>0x0)return _0x5125e3[_0x1029c5(0xe1)](_0x1029c5(0xdd),_0x1029c5(0x12e)),_0x1a2643[_0x1029c5(0xb9)](_0x1029c5(0xe6));var _0x196512=0x0;for(let _0x513e6c=0x0;_0x513e6c<=_0x2b4031['length']-0x1;_0x513e6c++){var _0x404e57=_0x2b4031[_0x513e6c];_0x404e57['product_details'][_0x1029c5(0xd9)]>_0x479b0d[_0x1029c5(0x144)]&&(_0x2030e['push'](_0x404e57[_0x1029c5(0x101)][_0x1029c5(0xda)]),_0x523662[_0x1029c5(0x146)](_0x404e57[_0x1029c5(0x101)][_0x1029c5(0xd9)]),_0x5a7d9e[_0x1029c5(0x146)](_0x479b0d[_0x1029c5(0x144)]),_0x231714[_0x1029c5(0x146)](_0x404e57[_0x1029c5(0x101)][_0x1029c5(0xcd)]),_0x445a14[_0x1029c5(0x146)](_0x404e57['product_details'][_0x1029c5(0x11f)]),_0x1e5824[_0x1029c5(0x146)](_0x404e57['product_details'][_0x1029c5(0xc4)]),_0x1f5ae4[_0x1029c5(0x146)](_0x404e57[_0x1029c5(0x101)][_0x1029c5(0x13a)]),_0x4a39b2[_0x1029c5(0x146)](_0x404e57['product_details']['bay']),_0x49523c[_0x1029c5(0x146)](_0x404e57[_0x1029c5(0x101)]['unit']),_0x3abaad[_0x1029c5(0x146)](_0x404e57['product_details'][_0x1029c5(0x143)]),_0x4ef78f['push'](_0x404e57['product_details'][_0x1029c5(0x117)]),_0x12eb4f['push'](_0x404e57[_0x1029c5(0x101)]['expiry_date']),_0x296e45['push'](_0x404e57['product_details'][_0x1029c5(0x11b)]),_0x6b90b7['push'](_0x404e57[_0x1029c5(0x101)][_0x1029c5(0x120)]),_0x237626['push'](_0x404e57[_0x1029c5(0x101)][_0x1029c5(0xe7)]),_0x4bc121[_0x1029c5(0x146)](_0x404e57[_0x1029c5(0x14d)]),_0x121295[_0x1029c5(0x146)](_0x404e57[_0x1029c5(0x101)][_0x1029c5(0x11d)]),_0x268d8c[_0x1029c5(0x146)](_0x404e57[_0x1029c5(0x101)][_0x1029c5(0x109)]),_0x206244[_0x1029c5(0x146)](_0x404e57['product_details'][_0x1029c5(0xe3)]),_0x1e5698[_0x1029c5(0x146)](_0x404e57[_0x1029c5(0x101)]['gross_price']),_0x196512++);}}const _0x596da2=_0x2030e['map'](_0x20968f=>{return _0x20968f={'product_name':_0x20968f};});_0x523662[_0x1029c5(0xbb)]((_0x150d1b,_0x3afdfd)=>{var _0x5b05ad=_0x1029c5;_0x596da2[_0x3afdfd][_0x5b05ad(0xfe)]=_0x150d1b;}),_0x5a7d9e[_0x1029c5(0xbb)]((_0x464cb3,_0x5b89e6)=>{var _0x51094a=_0x1029c5;_0x596da2[_0x5b89e6][_0x51094a(0xc8)]=Math[_0x51094a(0x10c)](_0x464cb3);}),_0x1e5698[_0x1029c5(0xbb)]((_0x2fab67,_0x2cd524)=>{var _0x3abd0a=_0x1029c5;_0x596da2[_0x2cd524][_0x3abd0a(0x12d)]=_0x2fab67;}),_0x206244[_0x1029c5(0xbb)]((_0x5dca89,_0x5121da)=>{var _0x2bc754=_0x1029c5;_0x596da2[_0x5121da][_0x2bc754(0xe3)]=_0x5dca89;}),_0x268d8c[_0x1029c5(0xbb)]((_0x185e36,_0x4ce20a)=>{var _0x5cac69=_0x1029c5;_0x596da2[_0x4ce20a][_0x5cac69(0x125)]=_0x185e36;}),_0x231714[_0x1029c5(0xbb)]((_0x1bb716,_0x3d2fa7)=>{var _0x5b1567=_0x1029c5;_0x596da2[_0x3d2fa7][_0x5b1567(0xcd)]=_0x1bb716;}),_0x445a14['forEach']((_0x470a7d,_0x2733a5)=>{var _0x4fb6d9=_0x1029c5;_0x596da2[_0x2733a5][_0x4fb6d9(0x11f)]=_0x470a7d;}),_0x1e5824[_0x1029c5(0xbb)]((_0x56be57,_0x3db238)=>{var _0x5e82d2=_0x1029c5;_0x596da2[_0x3db238][_0x5e82d2(0xc4)]=_0x56be57;}),_0x1f5ae4[_0x1029c5(0xbb)]((_0x420c24,_0x497be4)=>{_0x596da2[_0x497be4]['level']=_0x420c24;}),_0x4a39b2[_0x1029c5(0xbb)]((_0x5a4f5c,_0x3298a9)=>{var _0x4c49e9=_0x1029c5;_0x596da2[_0x3298a9][_0x4c49e9(0x123)]=_0x5a4f5c;}),_0x49523c[_0x1029c5(0xbb)]((_0x5ba396,_0x1da739)=>{var _0x1494bf=_0x1029c5;_0x596da2[_0x1da739][_0x1494bf(0xfb)]=_0x5ba396;}),_0x3abaad[_0x1029c5(0xbb)]((_0x163958,_0x95af01)=>{var _0x5cf679=_0x1029c5;_0x596da2[_0x95af01][_0x5cf679(0x143)]=_0x163958;}),_0x4ef78f[_0x1029c5(0xbb)]((_0x3307d2,_0x13fdc6)=>{var _0x1dd0d7=_0x1029c5;_0x596da2[_0x13fdc6][_0x1dd0d7(0x117)]=_0x3307d2;}),_0x12eb4f[_0x1029c5(0xbb)]((_0x264532,_0x568b15)=>{var _0x4cdc92=_0x1029c5;_0x596da2[_0x568b15][_0x4cdc92(0x11a)]=_0x264532;}),_0x296e45[_0x1029c5(0xbb)]((_0x2c3537,_0x2e179c)=>{var _0x5dc806=_0x1029c5;_0x596da2[_0x2e179c][_0x5dc806(0x11b)]=_0x2c3537;}),_0x6b90b7[_0x1029c5(0xbb)]((_0x542c2,_0x4a424b)=>{var _0x281cee=_0x1029c5;_0x596da2[_0x4a424b][_0x281cee(0xc5)]=_0x542c2;}),_0x237626[_0x1029c5(0xbb)]((_0x2e2035,_0x457e10)=>{var _0x1ef1d5=_0x1029c5;_0x596da2[_0x457e10][_0x1ef1d5(0x116)]=_0x2e2035;}),_0x4bc121[_0x1029c5(0xbb)]((_0x5375e1,_0x7f742b)=>{var _0x17d8f2=_0x1029c5;_0x596da2[_0x7f742b][_0x17d8f2(0x10d)]=_0x5375e1;}),_0x121295[_0x1029c5(0xbb)]((_0x398a0f,_0x158e66)=>{var _0x1cfcb5=_0x1029c5;_0x596da2[_0x158e66][_0x1cfcb5(0x11d)]=_0x398a0f,_0x596da2[_0x158e66][_0x1cfcb5(0xd0)]=_0x13234f;});const _0x29a652=new invoice_for_outgoing();await _0x29a652[_0x1029c5(0x140)](),_0x121295[_0x1029c5(0xbb)]((_0x47c917,_0x2494cb)=>{var _0x5bd975=_0x1029c5;_0x596da2[_0x2494cb]['outgoing_invoice']=_0x5bd975(0xcc)+_0x29a652[_0x5bd975(0xcf)][_0x5bd975(0xed)]()[_0x5bd975(0xf3)](0x8,'0');});const _0x548cf7=_0x596da2[_0x1029c5(0x133)](_0x48c951=>_0x48c951[_0x1029c5(0xc8)]!=='0'&&_0x48c951['quantity']!==''),_0x4e2b26=new sales_finished({'invoice':_0x1029c5(0xcc)+_0x29a652[_0x1029c5(0xcf)][_0x1029c5(0xed)]()[_0x1029c5(0xf3)](0x8,'0'),'date':_0x13234f,'warehouse_name':_0x11f462,'sale_product':_0x548cf7,'note':_0x27f2d2,'SCRN':_0x4e681c,'finalize':'False','ReqBy':_0x36770d,'dateofreq':_0x4b41b8,'PO_number':_0x46906d,'typeservicesData':_0x5eb9f7,'typevehicle':_0x2de258,'destination':_0x29cd65,'deliverydate':_0x4f00d4,'driver':_0x2c893e,'plate':_0x2eeeb3,'van':_0x3b81ef,'DRSI':_0x55b5ed,'TSU':_0x24809e,'TFU':_0x4894b5}),_0x47ed23=await _0x4e2b26['save'](),_0x43b2ad=new Date(),_0x3fefab=_0x43b2ad[_0x1029c5(0x159)]();_0x59f2d4[_0x1029c5(0x145)]=_0x4d087a,_0x59f2d4['wms_account_date']=_0x3fefab,_0x59f2d4[_0x1029c5(0x136)]=_0x1029c5(0xcc)+_0x29a652[_0x1029c5(0xcf)][_0x1029c5(0xed)]()[_0x1029c5(0xf3)](0x8,'0'),_0x59f2d4[_0x1029c5(0xf5)]=_0x47ed23['_id'],await _0x59f2d4[_0x1029c5(0x140)]();const _0x2d29a6=await master_shop[_0x1029c5(0x115)](),_0x56cf5d=await email_settings['findOne']();let _0x5ee1d5=nodemailer['createTransport']({'host':_0x56cf5d[_0x1029c5(0x163)],'port':Number(_0x56cf5d[_0x1029c5(0xc9)]),'secure':![],'auth':{'user':_0x56cf5d[_0x1029c5(0x152)],'pass':_0x56cf5d[_0x1029c5(0x121)]}});const _0x32da09=_0x5125e3[_0x1029c5(0x142)]+_0x1029c5(0xd1)+_0x5125e3[_0x1029c5(0xd6)][_0x1029c5(0x163)];var _0x14c287=_0x59f2d4[_0x1029c5(0x105)],_0x3a0313='',_0x4aace4,_0x250d8e=0x0;for(_0x4aace4 in _0x14c287){_0x3a0313+=_0x1029c5(0xfa)+_0x1029c5(0xea)+_0x14c287[_0x4aace4][_0x1029c5(0xda)]+_0x1029c5(0x154)+_0x1029c5(0xea)+_0x14c287[_0x4aace4]['product_code']+_0x1029c5(0x154)+_0x1029c5(0xea)+_0x14c287[_0x4aace4]['quantity']+_0x1029c5(0x154)+_0x1029c5(0xea)+_0x14c287[_0x4aace4]['unit']+'</td>'+_0x1029c5(0x15f),_0x250d8e+=parseInt(_0x14c287[_0x4aace4][_0x1029c5(0xc8)]);}let _0x55db7b={'from':_0x56cf5d[_0x1029c5(0x152)],'to':_0x1029c5(0xc1),'subject':_0x1029c5(0xb8),'attachments':[{'filename':_0x1029c5(0x153),'path':__dirname+_0x1029c5(0x141)+_0x1029c5(0x126)+_0x2d29a6[0x0][_0x1029c5(0x11e)],'cid':_0x1029c5(0xcb)}],'html':'<!DOCTYPE\x20html>'+_0x1029c5(0x137)+_0x1029c5(0x14c)+_0x1029c5(0xf6)+_0x1029c5(0x100)+_0x1029c5(0x128)+'<div>'+_0x1029c5(0xee)+_0x1029c5(0xf8)+'<div>'+'<h2>\x20JEC\x20SMS\x20</h2>'+_0x1029c5(0xf8)+_0x1029c5(0xf8)+_0x1029c5(0xef)+_0x1029c5(0x100)+'</div>'+_0x1029c5(0x100)+'<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>'+'</div>'+_0x1029c5(0x100)+_0x1029c5(0x15a)+_0x59f2d4[_0x1029c5(0x11d)]+_0x1029c5(0xf2)+_0x1029c5(0x14e)+_0x59f2d4[_0x1029c5(0xd5)]+_0x1029c5(0x150)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1029c5(0xf1)+_0x1029c5(0xfa)+_0x1029c5(0xd3)+_0x1029c5(0x15e)+_0x1029c5(0x15c)+_0x1029c5(0x158)+_0x1029c5(0x15f)+_0x1029c5(0x15b)+_0x1029c5(0x124)+'\x20'+_0x3a0313+'\x20'+_0x1029c5(0x13e)+_0x1029c5(0x118)+_0x1029c5(0x100)+_0x1029c5(0x164)+_0x1029c5(0xf0)+'<br><br><br>'+_0x1029c5(0xf8)+'<div>'+_0x1029c5(0x107)+'<h5>\x20JEC\x20SMS\x20</h5>'+'</div>'+'</div>'+_0x1029c5(0xd7)+_0x1029c5(0x13c)};_0x5ee1d5['sendMail'](_0x55db7b,function(_0x453c5d,_0x33b637){var _0x368bbd=_0x1029c5;_0x453c5d?(console[_0x368bbd(0x14a)](_0x453c5d),console['log']('Error\x20Occurs')):console['log'](_0x368bbd(0x139));}),_0x5125e3[_0x1029c5(0xe1)](_0x1029c5(0xf4),'Sales\x20Add\x20successfully'),_0x1a2643[_0x1029c5(0xb9)](_0x1029c5(0x122)+_0x47ed23[_0x1029c5(0x109)]),_0x1a2643[_0x1029c5(0x147)](_0x548cf7);return;}catch(_0x20cc83){}}),router[a0_0x2a082f(0x111)](a0_0x2a082f(0xff),auth,async(_0x3bf6d6,_0x9eb9d8)=>{var _0x1e6171=a0_0x2a082f;try{const _0x11f358=await master_shop['find'](),_0x1c0ddc=_0x3bf6d6[_0x1e6171(0xec)],_0x3df8ae=await profile[_0x1e6171(0xfc)]({'email':_0x1c0ddc[_0x1e6171(0x152)]}),_0x5dc797=await staff[_0x1e6171(0xfc)]({'email':_0x1c0ddc[_0x1e6171(0x152)]}),_0x3d5d78=await customer[_0x1e6171(0x115)]({'agent_id':_0x5dc797[_0x1e6171(0x109)]}),_0x219902=mongoose['Types'][_0x1e6171(0x112)],_0x14960d=_0x3bf6d6[_0x1e6171(0xd4)]['id'],_0x5c8f34=await sales_order[_0x1e6171(0xbd)](_0x14960d),_0x4f7fb0=await sales_order[_0x1e6171(0xb7)]([{'$match':{'_id':_0x219902(_0x14960d)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x1e6171(0x127)}}},{'$addFields':{'wms_account_id':{'$toObjectId':'$wms_account_id'}}},{'$lookup':{'from':_0x1e6171(0x134),'localField':_0x1e6171(0x10e),'foreignField':_0x1e6171(0x109),'as':_0x1e6171(0x130)}},{'$unwind':_0x1e6171(0x155)},{'$lookup':{'from':'staffs','localField':_0x1e6171(0x10f),'foreignField':_0x1e6171(0x109),'as':'wms_data'}},{'$unwind':_0x1e6171(0x13b)}]);if(_0x11f358[0x0][_0x1e6171(0x13d)]==_0x1e6171(0xc0))var _0x26d89b=users[_0x1e6171(0xba)];else{if(_0x11f358[0x0][_0x1e6171(0x13d)]==_0x1e6171(0xfd))var _0x26d89b=users[_0x1e6171(0xfd)];else{if(_0x11f358[0x0][_0x1e6171(0x13d)]=='German')var _0x26d89b=users[_0x1e6171(0x12a)];else{if(_0x11f358[0x0]['language']==_0x1e6171(0xd2))var _0x26d89b=users[_0x1e6171(0xd2)];else{if(_0x11f358[0x0][_0x1e6171(0x13d)]==_0x1e6171(0x108))var _0x26d89b=users[_0x1e6171(0x108)];else{if(_0x11f358[0x0][_0x1e6171(0x13d)]==_0x1e6171(0xde))var _0x26d89b=users[_0x1e6171(0x151)];else{if(_0x11f358[0x0][_0x1e6171(0x13d)]==_0x1e6171(0xd8))var _0x26d89b=users[_0x1e6171(0xd8)];else{if(_0x11f358[0x0][_0x1e6171(0x13d)]==_0x1e6171(0x13f))var _0x26d89b=users['Arabic'];}}}}}}}_0x9eb9d8['render'](_0x1e6171(0x11c),{'success':_0x3bf6d6[_0x1e6171(0xe1)](_0x1e6171(0xf4)),'errors':_0x3bf6d6[_0x1e6171(0xe1)]('errors'),'master_shop':_0x11f358,'profile':_0x3df8ae,'role':_0x1c0ddc,'language':_0x26d89b,'customer':_0x3d5d78,'sales_sa':_0x5c8f34,'approvers':_0x4f7fb0[0x0],'the_id':_0x14960d});}catch(_0x44807f){console['log'](_0x44807f);}}),router[a0_0x2a082f(0x102)](a0_0x2a082f(0xe5),auth,async(_0x4987b2,_0x571787)=>{var _0xef6f22=a0_0x2a082f;try{const {warehouse_name:_0x464505,product_code:_0x11ade7}=_0x4987b2[_0xef6f22(0xca)],_0x25da7b=await warehouse[_0xef6f22(0xb7)]([{'$match':{'name':_0x464505}},{'$unwind':_0xef6f22(0xdc)},{'$match':{'product_details.product_code':_0x11ade7}},{'$group':{'_id':{'room':_0xef6f22(0x14b),'_id':_0xef6f22(0x12c)}}}]);_0x571787['json'](_0x25da7b);}catch(_0x4556b0){}}),router[a0_0x2a082f(0x102)](a0_0x2a082f(0xe2),auth,async(_0x47ea36,_0x4eb505)=>{var _0x356944=a0_0x2a082f;try{const {warehouse_name:_0x3d796d,product_code:_0x8c8cbb,room_name:_0x20686d}=_0x47ea36[_0x356944(0xca)];console['log'](_0x47ea36['body']);const _0x225188=await warehouse[_0x356944(0xb7)]([{'$match':{'name':_0x3d796d,'room':_0x20686d}},{'$unwind':_0x356944(0xdc)},{'$match':{'product_details.product_code':_0x8c8cbb}},{'$group':{'_id':{'main_id':'$_id','detl_id':_0x356944(0xc2),'product_name':_0x356944(0xeb),'product_code':'$product_details.product_code','level':_0x356944(0xe8),'bay':_0x356944(0x119),'stocks':_0x356944(0xf7)}}}]);_0x4eb505['json'](_0x225188);}catch(_0x1e7161){}}),router[a0_0x2a082f(0x111)]('/data/All',auth,async(_0x561920,_0x2ca85c)=>{var _0x174dc2=a0_0x2a082f;try{const {sttaff_id:_0x1edb8,email:_0x35a180,warehouse:_0x23d6cb}=_0x561920[_0x174dc2(0xec)],_0x24340b=await master_shop[_0x174dc2(0x115)](),_0x2c3082=_0x561920[_0x174dc2(0xec)],_0x3f786b=await profile[_0x174dc2(0xfc)]({'email':_0x2c3082[_0x174dc2(0x152)]}),_0x3f10ed=await sales_order['find']({'wms_account_id':_0x1edb8});if(_0x24340b[0x0][_0x174dc2(0x13d)]=='English\x20(US)')var _0x2cb8da=users[_0x174dc2(0xba)];else{if(_0x24340b[0x0][_0x174dc2(0x13d)]=='Hindi')var _0x2cb8da=users[_0x174dc2(0xfd)];else{if(_0x24340b[0x0][_0x174dc2(0x13d)]==_0x174dc2(0x12a))var _0x2cb8da=users[_0x174dc2(0x12a)];else{if(_0x24340b[0x0]['language']==_0x174dc2(0xd2))var _0x2cb8da=users[_0x174dc2(0xd2)];else{if(_0x24340b[0x0]['language']=='French')var _0x2cb8da=users[_0x174dc2(0x108)];else{if(_0x24340b[0x0][_0x174dc2(0x13d)]==_0x174dc2(0xde))var _0x2cb8da=users[_0x174dc2(0x151)];else{if(_0x24340b[0x0][_0x174dc2(0x13d)]==_0x174dc2(0xd8))var _0x2cb8da=users['Chinese'];else{if(_0x24340b[0x0][_0x174dc2(0x13d)]==_0x174dc2(0x13f))var _0x2cb8da=users[_0x174dc2(0x10b)];}}}}}}}_0x2ca85c[_0x174dc2(0x131)](_0x174dc2(0x15d),{'success':_0x561920[_0x174dc2(0xe1)](_0x174dc2(0xf4)),'errors':_0x561920[_0x174dc2(0xe1)]('errors'),'master_shop':_0x24340b,'profile':_0x3f786b,'role':_0x2c3082,'language':_0x2cb8da,'sales_order':_0x3f10ed});}catch(_0x3fb928){}}),module[a0_0x2a082f(0x104)]=router;function a0_0x3f19(_0xf94018,_0x5ad44c){var _0x3d00be=a0_0x3d00();return a0_0x3f19=function(_0x3f19cb,_0x506a63){_0x3f19cb=_0x3f19cb-0xb7;var _0x150b7d=_0x3d00be[_0x3f19cb];return _0x150b7d;},a0_0x3f19(_0xf94018,_0x5ad44c);}function a0_0x3d00(){var _0x39edf7=['<tbody\x20style=\x22text-align:\x20center;\x22>','id_transaction_from','/upload/','$accounting_account_id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Types','German','exceljs','$_id','gross_price','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','mongodb','account_data','render','prod_id','filter','staffs','5536080zWyekE','document_number_out','<html><head><title></title>','data_loc','Email\x20sent\x20successfully','level','$wms_data','</body></html>','language','</tbody>','Arabic\x20(ae)','save','/../public','protocol','secondary_unit','request_qty','wms_account_confirm','push','json','warehouse_approval','Router','log','$room','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','room','<span>\x20Request\x20Date:\x20<b>','4390rkXfwY','</b></span>\x20<br><br>','Portuguese','email','Logo.png','</td>','$account_data','136014zVbgyR','warehouse_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','toLocaleDateString','<span>\x20Request\x20ID:\x20<b>','</thead>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','warehouse_approval_All','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','</tr>','xlsx','47224SjSUrm','mongoose','host','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','aggregate','Email\x20for\x20Customer','redirect','English','forEach','7850CxhiAc','findById','length','1868828XjJrbV','English\x20(US)','christian.villamer@jakagroup.com','$product_details._id','6OdvPbS','product_code','maxperunit','721gwuKqP','../models/all_models','quantity','port','body','logo','OUT-','primary_code','qty','invoice_init','date_data','://','Spanish','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','params','date','headers','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','Chinese','product_stock','product_name','../public/language/languages.json','$product_details','errors','Portuguese\x20(BR)','1073036BPrItb','/:id','flash','/data/data_loc','uuid','1VKOdNq','/data/data_rack','back','product_cat','$product_details.level','nodemailer','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.product_name','user','toString','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<hr\x20class=\x22my-3\x22>','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</b></span>\x20<br>','padStart','success','outgoing_id','</head><body>','$product_details.product_stock','</div>','string','<tr>','unit','findOne','Hindi','stock','/view_sales_order/:id','<div>','product_details','post','express','exports','sale_product','split','<strong>\x20Regards\x20</strong>','French','_id','warehouse_detl','Arabic','abs','room_name','accounting_account_id','wms_account_id','5283DEHsDK','get','ObjectId','../middleware/auth','$wms_account_id','find','prod_cat','batch_code','</table>','$product_details.bay','expiry_date','production_date','view_accounting_approval','invoice','image','secondary_code','maxPerUnit','password','/all_sales_finished/preview/','bay'];a0_0x3d00=function(){return _0x39edf7;};return a0_0x3d00();}