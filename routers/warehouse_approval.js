var a0_0x3d1b82=a0_0x2650;function a0_0x2650(_0x5cfe89,_0x549991){var _0x1d151e=a0_0x1d15();return a0_0x2650=function(_0x2650c7,_0x583c0a){_0x2650c7=_0x2650c7-0x18a;var _0x35017c=_0x1d151e[_0x2650c7];return _0x35017c;},a0_0x2650(_0x5cfe89,_0x549991);}(function(_0x4d0910,_0x25cb72){var _0x2875fa=a0_0x2650,_0x31ee9d=_0x4d0910();while(!![]){try{var _0x383eb3=parseInt(_0x2875fa(0x1ec))/0x1+parseInt(_0x2875fa(0x1af))/0x2+parseInt(_0x2875fa(0x222))/0x3*(parseInt(_0x2875fa(0x1b5))/0x4)+parseInt(_0x2875fa(0x1cb))/0x5*(-parseInt(_0x2875fa(0x1fc))/0x6)+-parseInt(_0x2875fa(0x1f5))/0x7*(parseInt(_0x2875fa(0x1cc))/0x8)+parseInt(_0x2875fa(0x1e4))/0x9+parseInt(_0x2875fa(0x202))/0xa*(-parseInt(_0x2875fa(0x1aa))/0xb);if(_0x383eb3===_0x25cb72)break;else _0x31ee9d['push'](_0x31ee9d['shift']());}catch(_0xc54dc3){_0x31ee9d['push'](_0x31ee9d['shift']());}}}(a0_0x1d15,0xa2429));function a0_0x1d15(){var _0x4c200c=['<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','sendMail','length','$room','errors','$product_details.product_stock','filter','unit','$accounting_account_id','aggregate','$account_data','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','../middleware/auth','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/data/data_loc','OUT-','gross_price','nodemailer','json','room','8227872mrnKpy','<tr>','language','</head><body>','Email\x20sent\x20successfully','outgoing_id','padStart','port','1082084FcUQhu','product_cat','../public/language/languages.json','/:id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','German','post','://','findById','3735011XuppMh','$_id','product_name','Spanish','prod_cat','save','</td>','6waLnAD','level','room_name','date_data','<h5>\x20JEC\x20SMS\x20</h5>','password','48280YEKANV','findOne','invoice','push','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','product_details','bay','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','secondary_unit','</tbody>','exceljs','wms_account_date','Arabic\x20(ae)','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','warehouse_approval','data_loc','<div>','English\x20(US)','<!DOCTYPE\x20html>','</tr>','Portuguese\x20(BR)','Chinese','christian.villamer@jakagroup.com','maxPerUnit','map','id_transaction_from','secondary_code','_id','uuid','Arabic','success','invoice_init','147YjlTBm','accounting_account_id','document_number_out','$product_details.bay','params','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','request_qty','flash','headers','$product_details.product_name','product_stock','account_data','wms_account_id','outgoing_invoice','ObjectId','forEach','protocol','Error\x20Occurs','</b></span>\x20<br><br>','$product_details.level','Logo.png','staffs','Hindi','warehouse_approval_All','back','redirect','body','</body></html>','find','image','user','/../public','Router','/data/All','toLocaleDateString','exports','host','Types','warehouse_id','2926hMpQLb','primary_code','Portuguese','toString','log','2076916SsUSel','$product_details._id','$wms_data','</thead>','$wms_account_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','59148oHDBPm','product_code','English','maxperunit','batch_code','/all_sales_finished/preview/','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','expiry_date','False','quantity','French','get','express','qty','mongoose','string','view_accounting_approval','warehouse_detl','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','</div>','render','3716510ebJFpH','16Bksfrh','$product_details','email','prod_id'];a0_0x1d15=function(){return _0x4c200c;};return a0_0x1d15();}const express=require(a0_0x3d1b82(0x1c1)),app=express(),router=express[a0_0x3d1b82(0x1a3)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require('../models/all_models'),auth=require(a0_0x3d1b82(0x1dc)),users=require(a0_0x3d1b82(0x1ee)),excelJS=require(a0_0x3d1b82(0x20c)),xlsx=require('xlsx'),mongoose=require(a0_0x3d1b82(0x1c3)),{ObjectId}=require('mongodb'),nodemailer=require(a0_0x3d1b82(0x1e1));router[a0_0x3d1b82(0x1c0)](a0_0x3d1b82(0x1ef),auth,async(_0x2e9991,_0x415985)=>{var _0x46948a=a0_0x3d1b82;try{const _0xc5100c=await master_shop[_0x46948a(0x19f)](),_0x1a3d8e=_0x2e9991[_0x46948a(0x1a1)],_0x51e44e=await profile[_0x46948a(0x203)]({'email':_0x1a3d8e[_0x46948a(0x1ce)]}),_0x400367=await staff['findOne']({'email':_0x1a3d8e['email']}),_0xfa677a=await customer['find']({'agent_id':_0x400367['_id']}),_0x78668c=mongoose[_0x46948a(0x1a8)][_0x46948a(0x191)],_0x3b8ad8=_0x2e9991[_0x46948a(0x226)]['id'],_0x32f29e=await sales_order[_0x46948a(0x1f4)](_0x3b8ad8),_0x7e4f57=await sales_order[_0x46948a(0x1d9)]([{'$match':{'_id':_0x78668c(_0x3b8ad8)}},{'$addFields':{'accounting_account_id':{'$toObjectId':'$accounting_account_id'}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x46948a(0x1b3)}}},{'$lookup':{'from':_0x46948a(0x198),'localField':_0x46948a(0x223),'foreignField':_0x46948a(0x21d),'as':_0x46948a(0x18e)}},{'$unwind':_0x46948a(0x1da)},{'$lookup':{'from':_0x46948a(0x198),'localField':_0x46948a(0x18f),'foreignField':_0x46948a(0x21d),'as':'wms_data'}},{'$unwind':_0x46948a(0x1b1)}]);if(_0xc5100c[0x0][_0x46948a(0x1e6)]==_0x46948a(0x213))var _0x31facc=users[_0x46948a(0x1b7)];else{if(_0xc5100c[0x0]['language']==_0x46948a(0x199))var _0x31facc=users[_0x46948a(0x199)];else{if(_0xc5100c[0x0]['language']==_0x46948a(0x1f1))var _0x31facc=users['German'];else{if(_0xc5100c[0x0][_0x46948a(0x1e6)]==_0x46948a(0x1f8))var _0x31facc=users['Spanish'];else{if(_0xc5100c[0x0][_0x46948a(0x1e6)]==_0x46948a(0x1bf))var _0x31facc=users[_0x46948a(0x1bf)];else{if(_0xc5100c[0x0][_0x46948a(0x1e6)]==_0x46948a(0x216))var _0x31facc=users['Portuguese'];else{if(_0xc5100c[0x0][_0x46948a(0x1e6)]==_0x46948a(0x217))var _0x31facc=users[_0x46948a(0x217)];else{if(_0xc5100c[0x0][_0x46948a(0x1e6)]=='Arabic\x20(ae)')var _0x31facc=users[_0x46948a(0x21f)];}}}}}}}_0x415985[_0x46948a(0x1ca)](_0x46948a(0x210),{'success':_0x2e9991[_0x46948a(0x18a)](_0x46948a(0x220)),'errors':_0x2e9991['flash'](_0x46948a(0x1d4)),'master_shop':_0xc5100c,'profile':_0x51e44e,'role':_0x1a3d8e,'language':_0x31facc,'customer':_0xfa677a,'sales_sa':_0x32f29e,'approvers':_0x7e4f57[0x0],'the_id':_0x3b8ad8});}catch(_0x180a69){console[_0x46948a(0x1ae)](_0x180a69);}}),router[a0_0x3d1b82(0x1f2)]('/:id',auth,async(_0xa878d8,_0x2401a5)=>{var _0x34c924=a0_0x3d1b82;try{const {date:_0xaa48f5,invoice_data:_0xe69514,wms_confirm:_0x4b01d2,the_id_val:_0x4327e0,prod_id:_0x9e3a53,SCRN:_0x792c3a,ReqBy:_0x16a831,dateofreq:_0x394ec8,PO_number:_0x45e831,warehouse_name:_0x413471,typeservicesData:_0x31df5a,typevehicle:_0x326d87,destination:_0x503afd,deliverydate:_0x22dff0,driver:_0xc32a8d,plate:_0x86f112,van:_0xd20dae,DRSI:_0x24830c,TSU:_0x4e55ad,TFU:_0x23718b,note:_0x4c0daf}=_0xa878d8[_0x34c924(0x19d)],_0x2a8492=await sales_order['findById'](_0x4327e0);if(typeof _0x9e3a53==_0x34c924(0x1c4))var _0x154c31=[_0xa878d8['body'][_0x34c924(0x1cf)]],_0x459095=[_0xa878d8['body'][_0x34c924(0x1c2)]],_0x2c6d97=[_0xa878d8[_0x34c924(0x19d)][_0x34c924(0x211)]];else var _0x154c31=[..._0xa878d8[_0x34c924(0x19d)][_0x34c924(0x1cf)]],_0x459095=[..._0xa878d8['body']['qty']],_0x2c6d97=[..._0xa878d8['body']['data_loc']];const _0x47dedc=_0x154c31[_0x34c924(0x21a)](_0x443ac0=>{return _0x443ac0={'prod_id':_0x443ac0};});_0x2c6d97[_0x34c924(0x192)]((_0x5cda7e,_0x27f3f3)=>{var _0x381f15=_0x34c924,_0x418a1c=_0x5cda7e['split']('~');_0x47dedc[_0x27f3f3]['warehouse_id']=_0x418a1c[0x0],_0x47dedc[_0x27f3f3][_0x381f15(0x1c6)]=_0x418a1c[0x1];}),_0x459095[_0x34c924(0x192)]((_0x184adf,_0x4af752)=>{var _0x22cafb=_0x34c924;_0x47dedc[_0x4af752][_0x22cafb(0x229)]=_0x184adf;});var _0x363059=[],_0x4ac97b=[],_0x43ffea=[],_0x2ca225=[],_0x31c987=[],_0x177862=[],_0x5eeb8b=[],_0x5e0aeb=[],_0x34cdf9=[],_0x1cf4fa=[],_0x4998f4=[],_0x4f6166=[],_0x344a6b=[],_0x52ab01=[],_0x5c81a5=[],_0x43fe7a=[],_0x145387=[],_0x6b2a7c=[],_0x3960be=[],_0xc089e7=[];for(let _0x4bd08b=0x0;_0x4bd08b<=_0x47dedc[_0x34c924(0x1d2)]-0x1;_0x4bd08b++){const _0x26dd03=_0x47dedc[_0x4bd08b],_0x5c2990=mongoose[_0x34c924(0x1a8)][_0x34c924(0x191)];var _0x4ac1c2=await warehouse[_0x34c924(0x1d9)]([{'$match':{'_id':_0x5c2990(_0x26dd03[_0x34c924(0x1a9)])}},{'$unwind':_0x34c924(0x1cd)},{'$match':{'product_details._id':_0x5c2990(_0x26dd03[_0x34c924(0x1c6)])}}]),_0x1b158c=0x0;for(let _0x3c8e81=0x0;_0x3c8e81<=_0x4ac1c2['length']-0x1;_0x3c8e81++){var _0x4a4b07=_0x4ac1c2[_0x3c8e81];_0x4a4b07['product_details'][_0x34c924(0x18d)]<_0x26dd03[_0x34c924(0x229)]&&_0x1b158c++;}if(_0x1b158c>0x0)return _0xa878d8[_0x34c924(0x18a)](_0x34c924(0x1d4),_0x34c924(0x1bb)),_0x2401a5['redirect'](_0x34c924(0x19b));var _0x53baf1=0x0;for(let _0x5b4124=0x0;_0x5b4124<=_0x4ac1c2['length']-0x1;_0x5b4124++){var _0x4a4b07=_0x4ac1c2[_0x5b4124];_0x4a4b07['product_details'][_0x34c924(0x18d)]>_0x26dd03[_0x34c924(0x229)]&&(_0x363059['push'](_0x4a4b07[_0x34c924(0x207)]['product_name']),_0x4ac97b[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x18d)]),_0x43ffea['push'](_0x26dd03[_0x34c924(0x229)]),_0x2ca225['push'](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x1ab)]),_0x31c987[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x21c)]),_0x177862[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x1b6)]),_0x5eeb8b[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x1fd)]),_0x5e0aeb[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x208)]),_0x34cdf9[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x1d7)]),_0x1cf4fa[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x20a)]),_0x4998f4[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x1b9)]),_0x4f6166[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x1bc)]),_0x344a6b[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x227)]),_0x52ab01[_0x34c924(0x205)](_0x4a4b07['product_details'][_0x34c924(0x219)]),_0x5c81a5['push'](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x1ed)]),_0x43fe7a[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x1e3)]),_0x145387[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x204)]),_0x6b2a7c[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)][_0x34c924(0x21d)]),_0x3960be[_0x34c924(0x205)](_0x4a4b07[_0x34c924(0x207)]['uuid']),_0xc089e7['push'](_0x4a4b07['product_details'][_0x34c924(0x1e0)]),_0x53baf1++);}}const _0x1122a2=_0x363059[_0x34c924(0x21a)](_0x1d979f=>{return _0x1d979f={'product_name':_0x1d979f};});_0x4ac97b[_0x34c924(0x192)]((_0x11fa6f,_0x263342)=>{_0x1122a2[_0x263342]['stock']=_0x11fa6f;}),_0x43ffea[_0x34c924(0x192)]((_0xb2955d,_0xe81852)=>{var _0x1bad90=_0x34c924;_0x1122a2[_0xe81852][_0x1bad90(0x1be)]=Math['abs'](_0xb2955d);}),_0xc089e7[_0x34c924(0x192)]((_0x1594c7,_0x365f61)=>{var _0x1d17e7=_0x34c924;_0x1122a2[_0x365f61][_0x1d17e7(0x1e0)]=_0x1594c7;}),_0x3960be[_0x34c924(0x192)]((_0x52e90d,_0x54d8c0)=>{var _0x5253c9=_0x34c924;_0x1122a2[_0x54d8c0][_0x5253c9(0x21e)]=_0x52e90d;}),_0x6b2a7c[_0x34c924(0x192)]((_0x5e24bd,_0x2f0c04)=>{var _0x181a98=_0x34c924;_0x1122a2[_0x2f0c04][_0x181a98(0x21b)]=_0x5e24bd;}),_0x2ca225['forEach']((_0x40a5d8,_0x42fbc5)=>{_0x1122a2[_0x42fbc5]['primary_code']=_0x40a5d8;}),_0x31c987['forEach']((_0x1dac84,_0x1a66ce)=>{var _0x547645=_0x34c924;_0x1122a2[_0x1a66ce][_0x547645(0x21c)]=_0x1dac84;}),_0x177862['forEach']((_0x39829a,_0x2b49c4)=>{var _0x23c625=_0x34c924;_0x1122a2[_0x2b49c4][_0x23c625(0x1b6)]=_0x39829a;}),_0x5eeb8b[_0x34c924(0x192)]((_0x7abaad,_0xeb2303)=>{var _0x32ce9d=_0x34c924;_0x1122a2[_0xeb2303][_0x32ce9d(0x1fd)]=_0x7abaad;}),_0x5e0aeb[_0x34c924(0x192)]((_0x56fdab,_0x2948a7)=>{var _0x54d461=_0x34c924;_0x1122a2[_0x2948a7][_0x54d461(0x208)]=_0x56fdab;}),_0x34cdf9[_0x34c924(0x192)]((_0x5a4199,_0x42c193)=>{var _0x48a22e=_0x34c924;_0x1122a2[_0x42c193][_0x48a22e(0x1d7)]=_0x5a4199;}),_0x1cf4fa[_0x34c924(0x192)]((_0x3e2d86,_0x3b2d4f)=>{var _0xdeeca3=_0x34c924;_0x1122a2[_0x3b2d4f][_0xdeeca3(0x20a)]=_0x3e2d86;}),_0x4998f4[_0x34c924(0x192)]((_0x3032d8,_0x20a1f3)=>{_0x1122a2[_0x20a1f3]['batch_code']=_0x3032d8;}),_0x4f6166['forEach']((_0x3551d6,_0x15e99e)=>{_0x1122a2[_0x15e99e]['expiry_date']=_0x3551d6;}),_0x344a6b[_0x34c924(0x192)]((_0x5366f1,_0x32cc31)=>{_0x1122a2[_0x32cc31]['production_date']=_0x5366f1;}),_0x52ab01[_0x34c924(0x192)]((_0x1082dc,_0x5b75fd)=>{var _0x583b0e=_0x34c924;_0x1122a2[_0x5b75fd][_0x583b0e(0x1b8)]=_0x1082dc;}),_0x5c81a5[_0x34c924(0x192)]((_0x1bcf78,_0x5d098c)=>{var _0x34cbfb=_0x34c924;_0x1122a2[_0x5d098c][_0x34cbfb(0x1f9)]=_0x1bcf78;}),_0x43fe7a[_0x34c924(0x192)]((_0x383b35,_0x399487)=>{var _0x42614b=_0x34c924;_0x1122a2[_0x399487][_0x42614b(0x1fe)]=_0x383b35;}),_0x145387[_0x34c924(0x192)]((_0x4e1103,_0x28f399)=>{var _0x5285a9=_0x34c924;_0x1122a2[_0x28f399][_0x5285a9(0x204)]=_0x4e1103,_0x1122a2[_0x28f399][_0x5285a9(0x1ff)]=_0xaa48f5;});const _0x52846b=new invoice_for_outgoing();await _0x52846b[_0x34c924(0x1fa)](),_0x145387['forEach']((_0x3df8f0,_0x50eec8)=>{var _0x34877f=_0x34c924;_0x1122a2[_0x50eec8][_0x34877f(0x190)]=_0x34877f(0x1df)+_0x52846b[_0x34877f(0x221)][_0x34877f(0x1ad)]()[_0x34877f(0x1ea)](0x8,'0');});const _0x2175f0=_0x1122a2[_0x34c924(0x1d6)](_0x185994=>_0x185994['quantity']!=='0'&&_0x185994['quantity']!==''),_0xb4b064=new sales_finished({'invoice':_0x34c924(0x1df)+_0x52846b[_0x34c924(0x221)][_0x34c924(0x1ad)]()['padStart'](0x8,'0'),'date':_0xaa48f5,'warehouse_name':_0x413471,'sale_product':_0x2175f0,'note':_0x4c0daf,'SCRN':_0x792c3a,'finalize':_0x34c924(0x1bd),'ReqBy':_0x16a831,'dateofreq':_0x394ec8,'PO_number':_0x45e831,'typeservicesData':_0x31df5a,'typevehicle':_0x326d87,'destination':_0x503afd,'deliverydate':_0x22dff0,'driver':_0xc32a8d,'plate':_0x86f112,'van':_0xd20dae,'DRSI':_0x24830c,'TSU':_0x4e55ad,'TFU':_0x23718b}),_0x3a1ae6=await _0xb4b064[_0x34c924(0x1fa)](),_0x57e01e=new Date(),_0x5a7609=_0x57e01e[_0x34c924(0x1a5)]();_0x2a8492['wms_account_confirm']=_0x4b01d2,_0x2a8492[_0x34c924(0x20d)]=_0x5a7609,_0x2a8492[_0x34c924(0x224)]='OUT-'+_0x52846b['invoice_init'][_0x34c924(0x1ad)]()[_0x34c924(0x1ea)](0x8,'0'),_0x2a8492[_0x34c924(0x1e9)]=_0x3a1ae6[_0x34c924(0x21d)],await _0x2a8492['save']();const _0x360f00=await master_shop[_0x34c924(0x19f)](),_0x3269d7=await email_settings[_0x34c924(0x203)]();let _0x20b094=nodemailer['createTransport']({'host':_0x3269d7[_0x34c924(0x1a7)],'port':Number(_0x3269d7[_0x34c924(0x1eb)]),'secure':![],'auth':{'user':_0x3269d7[_0x34c924(0x1ce)],'pass':_0x3269d7[_0x34c924(0x201)]}});const _0x418e56=_0xa878d8[_0x34c924(0x193)]+_0x34c924(0x1f3)+_0xa878d8[_0x34c924(0x18b)]['host'];var _0xfbcc80=_0x2a8492['sale_product'],_0x373156='',_0x1f43af,_0x400003=0x0;for(_0x1f43af in _0xfbcc80){_0x373156+=_0x34c924(0x1e5)+_0x34c924(0x1d0)+_0xfbcc80[_0x1f43af][_0x34c924(0x1f7)]+'</td>'+_0x34c924(0x1d0)+_0xfbcc80[_0x1f43af]['product_code']+_0x34c924(0x1fb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfbcc80[_0x1f43af][_0x34c924(0x1be)]+_0x34c924(0x1fb)+_0x34c924(0x1d0)+_0xfbcc80[_0x1f43af][_0x34c924(0x1d7)]+_0x34c924(0x1fb)+'</tr>',_0x400003+=parseInt(_0xfbcc80[_0x1f43af][_0x34c924(0x1be)]);}let _0x47d023={'from':_0x3269d7[_0x34c924(0x1ce)],'to':_0x34c924(0x218),'subject':'Email\x20for\x20Customer','attachments':[{'filename':_0x34c924(0x197),'path':__dirname+_0x34c924(0x1a2)+'/upload/'+_0x360f00[0x0][_0x34c924(0x1a0)],'cid':'logo'}],'html':_0x34c924(0x214)+'<html><head><title></title>'+_0x34c924(0x209)+_0x34c924(0x1e7)+_0x34c924(0x212)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x34c924(0x212)+_0x34c924(0x20f)+_0x34c924(0x1c9)+'<div>'+'<h2>\x20JEC\x20SMS\x20</h2>'+_0x34c924(0x1c9)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x34c924(0x212)+_0x34c924(0x1c9)+'<div>'+_0x34c924(0x1db)+'</div>'+_0x34c924(0x212)+'<span>\x20Request\x20ID:\x20<b>'+_0x2a8492[_0x34c924(0x204)]+'</b></span>\x20<br>'+'<span>\x20Request\x20Date:\x20<b>'+_0x2a8492['date']+_0x34c924(0x195)+_0x34c924(0x1c9)+_0x34c924(0x1f0)+_0x34c924(0x1dd)+'<tr>'+_0x34c924(0x228)+_0x34c924(0x1c7)+_0x34c924(0x1b4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x34c924(0x215)+_0x34c924(0x1b2)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x373156+'\x20'+_0x34c924(0x20b)+'</table>'+'<div>'+_0x34c924(0x206)+'<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>'+'<br><br><br>'+_0x34c924(0x1c9)+_0x34c924(0x212)+'<strong>\x20Regards\x20</strong>'+_0x34c924(0x200)+'</div>'+_0x34c924(0x1c9)+_0x34c924(0x1c8)+_0x34c924(0x19e)};_0x20b094[_0x34c924(0x1d1)](_0x47d023,function(_0x3f5238,_0x3618b1){var _0x37e3de=_0x34c924;_0x3f5238?(console['log'](_0x3f5238),console['log'](_0x37e3de(0x194))):console[_0x37e3de(0x1ae)](_0x37e3de(0x1e8));}),_0xa878d8['flash'](_0x34c924(0x220),'Sales\x20Add\x20successfully'),_0x2401a5[_0x34c924(0x19c)](_0x34c924(0x1ba)+_0x3a1ae6[_0x34c924(0x21d)]),_0x2401a5[_0x34c924(0x1e2)](_0x2175f0);return;}catch(_0x523f36){}}),router['get']('/view_sales_order/:id',auth,async(_0x31dd5b,_0x19b52a)=>{var _0x360a0d=a0_0x3d1b82;try{const _0x13249b=await master_shop[_0x360a0d(0x19f)](),_0x5a9010=_0x31dd5b[_0x360a0d(0x1a1)],_0x3a165f=await profile[_0x360a0d(0x203)]({'email':_0x5a9010['email']}),_0x33e61d=await staff[_0x360a0d(0x203)]({'email':_0x5a9010[_0x360a0d(0x1ce)]}),_0x3a9964=await customer[_0x360a0d(0x19f)]({'agent_id':_0x33e61d['_id']}),_0x2b4655=mongoose[_0x360a0d(0x1a8)]['ObjectId'],_0x413549=_0x31dd5b[_0x360a0d(0x226)]['id'],_0xff466a=await sales_order[_0x360a0d(0x1f4)](_0x413549),_0x35339f=await sales_order[_0x360a0d(0x1d9)]([{'$match':{'_id':_0x2b4655(_0x413549)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x360a0d(0x1d8)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x360a0d(0x1b3)}}},{'$lookup':{'from':_0x360a0d(0x198),'localField':'accounting_account_id','foreignField':_0x360a0d(0x21d),'as':_0x360a0d(0x18e)}},{'$unwind':_0x360a0d(0x1da)},{'$lookup':{'from':_0x360a0d(0x198),'localField':'wms_account_id','foreignField':'_id','as':'wms_data'}},{'$unwind':_0x360a0d(0x1b1)}]);if(_0x13249b[0x0][_0x360a0d(0x1e6)]==_0x360a0d(0x213))var _0x42b590=users[_0x360a0d(0x1b7)];else{if(_0x13249b[0x0][_0x360a0d(0x1e6)]==_0x360a0d(0x199))var _0x42b590=users[_0x360a0d(0x199)];else{if(_0x13249b[0x0][_0x360a0d(0x1e6)]==_0x360a0d(0x1f1))var _0x42b590=users[_0x360a0d(0x1f1)];else{if(_0x13249b[0x0][_0x360a0d(0x1e6)]==_0x360a0d(0x1f8))var _0x42b590=users[_0x360a0d(0x1f8)];else{if(_0x13249b[0x0][_0x360a0d(0x1e6)]==_0x360a0d(0x1bf))var _0x42b590=users['French'];else{if(_0x13249b[0x0][_0x360a0d(0x1e6)]==_0x360a0d(0x216))var _0x42b590=users['Portuguese'];else{if(_0x13249b[0x0][_0x360a0d(0x1e6)]==_0x360a0d(0x217))var _0x42b590=users[_0x360a0d(0x217)];else{if(_0x13249b[0x0][_0x360a0d(0x1e6)]==_0x360a0d(0x20e))var _0x42b590=users[_0x360a0d(0x21f)];}}}}}}}_0x19b52a[_0x360a0d(0x1ca)](_0x360a0d(0x1c5),{'success':_0x31dd5b[_0x360a0d(0x18a)](_0x360a0d(0x220)),'errors':_0x31dd5b['flash'](_0x360a0d(0x1d4)),'master_shop':_0x13249b,'profile':_0x3a165f,'role':_0x5a9010,'language':_0x42b590,'customer':_0x3a9964,'sales_sa':_0xff466a,'approvers':_0x35339f[0x0],'the_id':_0x413549});}catch(_0x43651f){console[_0x360a0d(0x1ae)](_0x43651f);}}),router[a0_0x3d1b82(0x1f2)]('/data/data_rack',auth,async(_0xf51763,_0x4cdc26)=>{var _0x1f693a=a0_0x3d1b82;try{const {warehouse_name:_0x1709cc,product_code:_0x50cf51}=_0xf51763[_0x1f693a(0x19d)],_0x575852=await warehouse[_0x1f693a(0x1d9)]([{'$match':{'name':_0x1709cc}},{'$unwind':_0x1f693a(0x1cd)},{'$match':{'product_details.product_code':_0x50cf51}},{'$group':{'_id':{'room':_0x1f693a(0x1d3),'_id':_0x1f693a(0x1f6)}}}]);_0x4cdc26[_0x1f693a(0x1e2)](_0x575852);}catch(_0x13a340){}}),router['post'](a0_0x3d1b82(0x1de),auth,async(_0x25348b,_0x55615d)=>{var _0x3b0456=a0_0x3d1b82;try{const {warehouse_name:_0x50dae7,product_code:_0x442d0e,room_name:_0x526642}=_0x25348b[_0x3b0456(0x19d)];console[_0x3b0456(0x1ae)](_0x25348b[_0x3b0456(0x19d)]);const _0x288dd0=await warehouse['aggregate']([{'$match':{'name':_0x50dae7,'room':_0x526642}},{'$unwind':_0x3b0456(0x1cd)},{'$match':{'product_details.product_code':_0x442d0e}},{'$group':{'_id':{'main_id':_0x3b0456(0x1f6),'detl_id':_0x3b0456(0x1b0),'product_name':_0x3b0456(0x18c),'product_code':'$product_details.product_code','level':_0x3b0456(0x196),'bay':_0x3b0456(0x225),'stocks':_0x3b0456(0x1d5)}}}]);_0x55615d['json'](_0x288dd0);}catch(_0x3590c1){}}),router[a0_0x3d1b82(0x1c0)](a0_0x3d1b82(0x1a4),auth,async(_0x106d55,_0x376b97)=>{var _0x47ab28=a0_0x3d1b82;try{const {sttaff_id:_0x387e7c,email:_0x2f0902,warehouse:_0x39e53d}=_0x106d55[_0x47ab28(0x1a1)],_0x3d0ea6=await master_shop[_0x47ab28(0x19f)](),_0x37eaf2=_0x106d55[_0x47ab28(0x1a1)],_0x6593f2=await profile[_0x47ab28(0x203)]({'email':_0x37eaf2['email']}),_0x21e2c2=await sales_order['find']({'wms_account_id':_0x387e7c});if(_0x3d0ea6[0x0][_0x47ab28(0x1e6)]==_0x47ab28(0x213))var _0x5db58c=users[_0x47ab28(0x1b7)];else{if(_0x3d0ea6[0x0][_0x47ab28(0x1e6)]==_0x47ab28(0x199))var _0x5db58c=users[_0x47ab28(0x199)];else{if(_0x3d0ea6[0x0][_0x47ab28(0x1e6)]==_0x47ab28(0x1f1))var _0x5db58c=users[_0x47ab28(0x1f1)];else{if(_0x3d0ea6[0x0][_0x47ab28(0x1e6)]==_0x47ab28(0x1f8))var _0x5db58c=users[_0x47ab28(0x1f8)];else{if(_0x3d0ea6[0x0][_0x47ab28(0x1e6)]==_0x47ab28(0x1bf))var _0x5db58c=users[_0x47ab28(0x1bf)];else{if(_0x3d0ea6[0x0][_0x47ab28(0x1e6)]==_0x47ab28(0x216))var _0x5db58c=users[_0x47ab28(0x1ac)];else{if(_0x3d0ea6[0x0][_0x47ab28(0x1e6)]==_0x47ab28(0x217))var _0x5db58c=users[_0x47ab28(0x217)];else{if(_0x3d0ea6[0x0][_0x47ab28(0x1e6)]==_0x47ab28(0x20e))var _0x5db58c=users[_0x47ab28(0x21f)];}}}}}}}_0x376b97[_0x47ab28(0x1ca)](_0x47ab28(0x19a),{'success':_0x106d55['flash'](_0x47ab28(0x220)),'errors':_0x106d55[_0x47ab28(0x18a)]('errors'),'master_shop':_0x3d0ea6,'profile':_0x6593f2,'role':_0x37eaf2,'language':_0x5db58c,'sales_order':_0x21e2c2});}catch(_0x24ed18){}}),module[a0_0x3d1b82(0x1a6)]=router;