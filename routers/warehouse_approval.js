var a0_0x3d6726=a0_0x3373;function a0_0x3373(_0x3f3a35,_0x2630f7){var _0x569cb8=a0_0x569c();return a0_0x3373=function(_0x3373dc,_0x5e4011){_0x3373dc=_0x3373dc-0x1ef;var _0x205d2e=_0x569cb8[_0x3373dc];return _0x205d2e;},a0_0x3373(_0x3f3a35,_0x2630f7);}function a0_0x569c(){var _0x44b27e=['language','wms_account_confirm','id_transaction_from','Portuguese\x20(BR)','render','Spanish','success','</td>','abs','batch_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','json','</body></html>','user','outgoing_id','string','Arabic\x20(ae)','date_data','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','post','<div>','<html><head><title></title>','ObjectId','room','$accounting_account_id','stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','product_cat','$room','9CeCZol','Sales\x20Add\x20successfully','params','106298CMCBvm','$product_details','Router','Hindi','/data/data_loc','<span>\x20Request\x20ID:\x20<b>','Chinese','warehouse_id','product_name','date','product_code','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','padStart','body','Email\x20for\x20Customer','room_name','<h2>\x20JEC\x20SMS\x20</h2>','11eftQUe','quantity','/data/All','headers','False','findOne','_id','<tr>','primary_code','sendMail','save','wms_data','staffs','maxperunit','qty','forEach','1556840LeTnxu','8907070xsvVvo','wms_account_id','email','warehouse_detl','1949820MXltyC','view_accounting_approval','14iUZITR','uuid','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','product_stock','French','accounting_account_id','filter','errors','aggregate','$_id','../middleware/auth','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','express','://','exceljs','port','split','/upload/','document_number_out','$product_details.level','840894cgYFNM','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','secondary_code','German','toString','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','toLocaleDateString','Types','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','production_date','log','$wms_data','../public/language/languages.json','host','map','</head><body>','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','<hr\x20class=\x22my-3\x22>','Portuguese','gross_price','outgoing_invoice','$product_details.product_name','invoice_init','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','</div>','redirect','length','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','flash','find','English','findById','</tr>','data_loc','level','$product_details.product_code','$wms_account_id','product_details','<!DOCTYPE\x20html>','/:id','prod_id','</thead>','$product_details.product_stock','warehouse_approval_All','maxPerUnit','push','OUT-','request_qty','sale_product','expiry_date','Error\x20Occurs','account_data','Logo.png','Email\x20sent\x20successfully','xlsx','warehouse_approval','<tbody\x20style=\x22text-align:\x20center;\x22>','$account_data','get','protocol','exports','prod_cat','Arabic','invoice','English\x20(US)','unit','<h5>\x20JEC\x20SMS\x20</h5>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','2865366msGYKv','30ntHcHF','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','$product_details.bay','25764UEiMCa'];a0_0x569c=function(){return _0x44b27e;};return a0_0x569c();}(function(_0x52addf,_0xae4253){var _0x160e70=a0_0x3373,_0x52f22f=_0x52addf();while(!![]){try{var _0x1afb05=-parseInt(_0x160e70(0x244))/0x1*(parseInt(_0x160e70(0x247))/0x2)+parseInt(_0x160e70(0x284))/0x3+-parseInt(_0x160e70(0x226))/0x4*(parseInt(_0x160e70(0x223))/0x5)+-parseInt(_0x160e70(0x26d))/0x6+-parseInt(_0x160e70(0x26f))/0x7*(parseInt(_0x160e70(0x268))/0x8)+parseInt(_0x160e70(0x222))/0x9+parseInt(_0x160e70(0x269))/0xa*(parseInt(_0x160e70(0x258))/0xb);if(_0x1afb05===_0xae4253)break;else _0x52f22f['push'](_0x52f22f['shift']());}catch(_0x4f3957){_0x52f22f['push'](_0x52f22f['shift']());}}}(a0_0x569c,0x3f0a4));const express=require(a0_0x3d6726(0x27c)),app=express(),router=express[a0_0x3d6726(0x249)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require('../models/all_models'),auth=require(a0_0x3d6726(0x27a)),users=require(a0_0x3d6726(0x291)),excelJS=require(a0_0x3d6726(0x27e)),xlsx=require(a0_0x3d6726(0x214)),mongoose=require('mongoose'),{ObjectId}=require('mongodb'),nodemailer=require('nodemailer');router[a0_0x3d6726(0x218)](a0_0x3d6726(0x205),auth,async(_0x13a5d4,_0x578f27)=>{var _0x1194e5=a0_0x3d6726;try{const _0x59e4e1=await master_shop['find'](),_0x3b5aeb=_0x13a5d4[_0x1194e5(0x234)],_0x451b5a=await profile[_0x1194e5(0x25d)]({'email':_0x3b5aeb['email']}),_0x5dfde5=await staff['findOne']({'email':_0x3b5aeb[_0x1194e5(0x26b)]}),_0x24e1ee=await customer[_0x1194e5(0x1fb)]({'agent_id':_0x5dfde5[_0x1194e5(0x25e)]}),_0x405541=mongoose[_0x1194e5(0x28c)][_0x1194e5(0x23d)],_0x2de50a=_0x13a5d4['params']['id'],_0x4f5e5a=await sales_order[_0x1194e5(0x1fd)](_0x2de50a),_0xab2417=await sales_order[_0x1194e5(0x278)]([{'$match':{'_id':_0x405541(_0x2de50a)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x1194e5(0x23f)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x1194e5(0x202)}}},{'$lookup':{'from':'staffs','localField':'accounting_account_id','foreignField':_0x1194e5(0x25e),'as':_0x1194e5(0x211)}},{'$unwind':_0x1194e5(0x217)},{'$lookup':{'from':_0x1194e5(0x264),'localField':_0x1194e5(0x26a),'foreignField':'_id','as':_0x1194e5(0x263)}},{'$unwind':'$wms_data'}]);if(_0x59e4e1[0x0]['language']=='English\x20(US)')var _0x2e8f1d=users[_0x1194e5(0x1fc)];else{if(_0x59e4e1[0x0][_0x1194e5(0x227)]=='Hindi')var _0x2e8f1d=users[_0x1194e5(0x24a)];else{if(_0x59e4e1[0x0][_0x1194e5(0x227)]==_0x1194e5(0x287))var _0x2e8f1d=users[_0x1194e5(0x287)];else{if(_0x59e4e1[0x0]['language']==_0x1194e5(0x22c))var _0x2e8f1d=users[_0x1194e5(0x22c)];else{if(_0x59e4e1[0x0][_0x1194e5(0x227)]=='French')var _0x2e8f1d=users[_0x1194e5(0x274)];else{if(_0x59e4e1[0x0][_0x1194e5(0x227)]==_0x1194e5(0x22a))var _0x2e8f1d=users[_0x1194e5(0x1f0)];else{if(_0x59e4e1[0x0][_0x1194e5(0x227)]==_0x1194e5(0x24d))var _0x2e8f1d=users[_0x1194e5(0x24d)];else{if(_0x59e4e1[0x0][_0x1194e5(0x227)]==_0x1194e5(0x237))var _0x2e8f1d=users[_0x1194e5(0x21c)];}}}}}}}_0x578f27[_0x1194e5(0x22b)](_0x1194e5(0x215),{'success':_0x13a5d4[_0x1194e5(0x1fa)](_0x1194e5(0x22d)),'errors':_0x13a5d4[_0x1194e5(0x1fa)]('errors'),'master_shop':_0x59e4e1,'profile':_0x451b5a,'role':_0x3b5aeb,'language':_0x2e8f1d,'customer':_0x24e1ee,'sales_sa':_0x4f5e5a,'approvers':_0xab2417[0x0],'the_id':_0x2de50a});}catch(_0x21f886){console['log'](_0x21f886);}}),router[a0_0x3d6726(0x23a)](a0_0x3d6726(0x205),auth,async(_0x202189,_0x5ddb76)=>{var _0x5c3b4f=a0_0x3d6726;try{const {date:_0x2bf1a2,invoice_data:_0x18b8e7,wms_confirm:_0x1d285a,the_id_val:_0x4e6a2a,prod_id:_0x505ed3,SCRN:_0x326739,ReqBy:_0x4e2c03,dateofreq:_0x32c17d,PO_number:_0x17b93d,warehouse_name:_0x2324be,typeservicesData:_0x248a43,typevehicle:_0x4220aa,destination:_0x458b82,deliverydate:_0x5d0fd9,driver:_0x3be710,plate:_0x155a2f,van:_0x233336,DRSI:_0x391ce7,TSU:_0x4c105b,TFU:_0x105719,note:_0x299c20}=_0x202189[_0x5c3b4f(0x254)],_0x5e36a8=await sales_order[_0x5c3b4f(0x1fd)](_0x4e6a2a);if(typeof _0x505ed3==_0x5c3b4f(0x236))var _0x4cd0aa=[_0x202189['body'][_0x5c3b4f(0x206)]],_0x40db46=[_0x202189[_0x5c3b4f(0x254)][_0x5c3b4f(0x266)]],_0x4f756a=[_0x202189['body'][_0x5c3b4f(0x1ff)]];else var _0x4cd0aa=[..._0x202189['body']['prod_id']],_0x40db46=[..._0x202189[_0x5c3b4f(0x254)][_0x5c3b4f(0x266)]],_0x4f756a=[..._0x202189['body'][_0x5c3b4f(0x1ff)]];const _0x1efd59=_0x4cd0aa[_0x5c3b4f(0x293)](_0x4479f6=>{return _0x4479f6={'prod_id':_0x4479f6};});_0x4f756a[_0x5c3b4f(0x267)]((_0x1c6ea7,_0x135c9c)=>{var _0x29b1a1=_0x5c3b4f,_0x2f5180=_0x1c6ea7[_0x29b1a1(0x280)]('~');_0x1efd59[_0x135c9c][_0x29b1a1(0x24e)]=_0x2f5180[0x0],_0x1efd59[_0x135c9c][_0x29b1a1(0x26c)]=_0x2f5180[0x1];}),_0x40db46['forEach']((_0x4e2cd6,_0x25b22b)=>{var _0x1f67be=_0x5c3b4f;_0x1efd59[_0x25b22b][_0x1f67be(0x20d)]=_0x4e2cd6;});var _0x5140ae=[],_0x451294=[],_0x2d61a5=[],_0x463aea=[],_0x128315=[],_0x188be6=[],_0x198346=[],_0x3bb577=[],_0xaadf85=[],_0x1f066c=[],_0x26ee67=[],_0x478ace=[],_0x3d1520=[],_0x68aba7=[],_0x53e1db=[],_0x32987b=[],_0xe0cddf=[],_0x9ee909=[],_0x3d4881=[],_0x51a9a4=[];for(let _0x46a0df=0x0;_0x46a0df<=_0x1efd59[_0x5c3b4f(0x1f8)]-0x1;_0x46a0df++){const _0x32fe66=_0x1efd59[_0x46a0df],_0x406689=mongoose['Types']['ObjectId'];var _0x39a49e=await warehouse[_0x5c3b4f(0x278)]([{'$match':{'_id':_0x406689(_0x32fe66[_0x5c3b4f(0x24e)])}},{'$unwind':'$product_details'},{'$match':{'product_details._id':_0x406689(_0x32fe66['warehouse_detl'])}}]),_0x106c2f=0x0;for(let _0x2f963b=0x0;_0x2f963b<=_0x39a49e[_0x5c3b4f(0x1f8)]-0x1;_0x2f963b++){var _0x4c108e=_0x39a49e[_0x2f963b];_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x273)]<_0x32fe66['request_qty']&&_0x106c2f++;}if(_0x106c2f>0x0)return _0x202189['flash'](_0x5c3b4f(0x277),_0x5c3b4f(0x272)),_0x5ddb76[_0x5c3b4f(0x1f7)]('back');var _0x3c4481=0x0;for(let _0x11a042=0x0;_0x11a042<=_0x39a49e[_0x5c3b4f(0x1f8)]-0x1;_0x11a042++){var _0x4c108e=_0x39a49e[_0x11a042];_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x273)]>_0x32fe66[_0x5c3b4f(0x20d)]&&(_0x5140ae[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x24f)]),_0x451294['push'](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x273)]),_0x2d61a5[_0x5c3b4f(0x20b)](_0x32fe66[_0x5c3b4f(0x20d)]),_0x463aea[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x260)]),_0x128315[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x286)]),_0x188be6[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x251)]),_0x198346[_0x5c3b4f(0x20b)](_0x4c108e['product_details'][_0x5c3b4f(0x200)]),_0x3bb577[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)]['bay']),_0xaadf85[_0x5c3b4f(0x20b)](_0x4c108e['product_details']['unit']),_0x1f066c[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)]['secondary_unit']),_0x26ee67[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x230)]),_0x478ace['push'](_0x4c108e['product_details'][_0x5c3b4f(0x20f)]),_0x3d1520[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x28e)]),_0x68aba7[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x20a)]),_0x53e1db['push'](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x242)]),_0x32987b[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x23e)]),_0xe0cddf[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x21d)]),_0x9ee909[_0x5c3b4f(0x20b)](_0x4c108e[_0x5c3b4f(0x203)][_0x5c3b4f(0x25e)]),_0x3d4881['push'](_0x4c108e['product_details'][_0x5c3b4f(0x270)]),_0x51a9a4[_0x5c3b4f(0x20b)](_0x4c108e['product_details'][_0x5c3b4f(0x1f1)]),_0x3c4481++);}}const _0x584a77=_0x5140ae[_0x5c3b4f(0x293)](_0xf16bd4=>{return _0xf16bd4={'product_name':_0xf16bd4};});_0x451294['forEach']((_0x3f9b1e,_0x4617ef)=>{var _0x2c09be=_0x5c3b4f;_0x584a77[_0x4617ef][_0x2c09be(0x240)]=_0x3f9b1e;}),_0x2d61a5[_0x5c3b4f(0x267)]((_0x1b0c10,_0x11b51f)=>{var _0x518ebc=_0x5c3b4f;_0x584a77[_0x11b51f]['quantity']=Math[_0x518ebc(0x22f)](_0x1b0c10);}),_0x51a9a4[_0x5c3b4f(0x267)]((_0x137cab,_0x342ceb)=>{var _0x44c259=_0x5c3b4f;_0x584a77[_0x342ceb][_0x44c259(0x1f1)]=_0x137cab;}),_0x3d4881[_0x5c3b4f(0x267)]((_0x5be878,_0x158c07)=>{var _0x310c16=_0x5c3b4f;_0x584a77[_0x158c07][_0x310c16(0x270)]=_0x5be878;}),_0x9ee909[_0x5c3b4f(0x267)]((_0xde9ac8,_0x38be0e)=>{var _0x331bfe=_0x5c3b4f;_0x584a77[_0x38be0e][_0x331bfe(0x229)]=_0xde9ac8;}),_0x463aea[_0x5c3b4f(0x267)]((_0x4ebfc6,_0x58f98a)=>{var _0x3f9db2=_0x5c3b4f;_0x584a77[_0x58f98a][_0x3f9db2(0x260)]=_0x4ebfc6;}),_0x128315[_0x5c3b4f(0x267)]((_0x67ff18,_0xd869)=>{var _0x15cb0b=_0x5c3b4f;_0x584a77[_0xd869][_0x15cb0b(0x286)]=_0x67ff18;}),_0x188be6[_0x5c3b4f(0x267)]((_0x58c367,_0x2a229d)=>{var _0x17b021=_0x5c3b4f;_0x584a77[_0x2a229d][_0x17b021(0x251)]=_0x58c367;}),_0x198346[_0x5c3b4f(0x267)]((_0x226f7a,_0x485878)=>{var _0xf4fa66=_0x5c3b4f;_0x584a77[_0x485878][_0xf4fa66(0x200)]=_0x226f7a;}),_0x3bb577['forEach']((_0x336cf0,_0x1efd6f)=>{_0x584a77[_0x1efd6f]['bay']=_0x336cf0;}),_0xaadf85['forEach']((_0x2a8a90,_0x1506ff)=>{var _0x327adc=_0x5c3b4f;_0x584a77[_0x1506ff][_0x327adc(0x21f)]=_0x2a8a90;}),_0x1f066c[_0x5c3b4f(0x267)]((_0x3c38fa,_0x348c1c)=>{_0x584a77[_0x348c1c]['secondary_unit']=_0x3c38fa;}),_0x26ee67[_0x5c3b4f(0x267)]((_0x4604a1,_0x23eb03)=>{var _0x3bf141=_0x5c3b4f;_0x584a77[_0x23eb03][_0x3bf141(0x230)]=_0x4604a1;}),_0x478ace[_0x5c3b4f(0x267)]((_0xbb8fb7,_0x2e1113)=>{_0x584a77[_0x2e1113]['expiry_date']=_0xbb8fb7;}),_0x3d1520['forEach']((_0x10ab30,_0xa3539)=>{var _0x1c0bc2=_0x5c3b4f;_0x584a77[_0xa3539][_0x1c0bc2(0x28e)]=_0x10ab30;}),_0x68aba7[_0x5c3b4f(0x267)]((_0x576dbc,_0x1e47b9)=>{var _0xbef044=_0x5c3b4f;_0x584a77[_0x1e47b9][_0xbef044(0x265)]=_0x576dbc;}),_0x53e1db['forEach']((_0x299284,_0x5eb81e)=>{var _0x62bc16=_0x5c3b4f;_0x584a77[_0x5eb81e][_0x62bc16(0x21b)]=_0x299284;}),_0x32987b[_0x5c3b4f(0x267)]((_0x752f1,_0x231c0a)=>{var _0x694fd5=_0x5c3b4f;_0x584a77[_0x231c0a][_0x694fd5(0x256)]=_0x752f1;}),_0xe0cddf[_0x5c3b4f(0x267)]((_0x1dec06,_0x9c485d)=>{var _0x2ecbc1=_0x5c3b4f;_0x584a77[_0x9c485d][_0x2ecbc1(0x21d)]=_0x1dec06,_0x584a77[_0x9c485d][_0x2ecbc1(0x238)]=_0x2bf1a2;});const _0x5d40b3=new invoice_for_outgoing();await _0x5d40b3[_0x5c3b4f(0x262)](),_0xe0cddf['forEach']((_0x3e7e58,_0x109251)=>{var _0x411192=_0x5c3b4f;_0x584a77[_0x109251][_0x411192(0x1f2)]=_0x411192(0x20c)+_0x5d40b3[_0x411192(0x1f4)][_0x411192(0x288)]()[_0x411192(0x253)](0x8,'0');});const _0xa8f21=_0x584a77[_0x5c3b4f(0x276)](_0x196129=>_0x196129[_0x5c3b4f(0x259)]!=='0'&&_0x196129['quantity']!==''),_0x1e6853=new sales_finished({'invoice':_0x5c3b4f(0x20c)+_0x5d40b3[_0x5c3b4f(0x1f4)][_0x5c3b4f(0x288)]()['padStart'](0x8,'0'),'date':_0x2bf1a2,'warehouse_name':_0x2324be,'sale_product':_0xa8f21,'note':_0x299c20,'SCRN':_0x326739,'finalize':_0x5c3b4f(0x25c),'ReqBy':_0x4e2c03,'dateofreq':_0x32c17d,'PO_number':_0x17b93d,'typeservicesData':_0x248a43,'typevehicle':_0x4220aa,'destination':_0x458b82,'deliverydate':_0x5d0fd9,'driver':_0x3be710,'plate':_0x155a2f,'van':_0x233336,'DRSI':_0x391ce7,'TSU':_0x4c105b,'TFU':_0x105719}),_0x434070=await _0x1e6853[_0x5c3b4f(0x262)](),_0x8838=new Date(),_0x18dc4f=_0x8838[_0x5c3b4f(0x28b)]();_0x5e36a8[_0x5c3b4f(0x228)]=_0x1d285a,_0x5e36a8['wms_account_date']=_0x18dc4f,_0x5e36a8[_0x5c3b4f(0x282)]=_0x5c3b4f(0x20c)+_0x5d40b3['invoice_init'][_0x5c3b4f(0x288)]()[_0x5c3b4f(0x253)](0x8,'0'),_0x5e36a8[_0x5c3b4f(0x235)]=_0x434070[_0x5c3b4f(0x25e)],await _0x5e36a8[_0x5c3b4f(0x262)]();const _0x20900f=await master_shop[_0x5c3b4f(0x1fb)](),_0xa4dd8b=await email_settings[_0x5c3b4f(0x25d)]();let _0x2cd08b=nodemailer['createTransport']({'host':_0xa4dd8b[_0x5c3b4f(0x292)],'port':Number(_0xa4dd8b[_0x5c3b4f(0x27f)]),'secure':![],'auth':{'user':_0xa4dd8b[_0x5c3b4f(0x26b)],'pass':_0xa4dd8b['password']}});const _0x272ee7=_0x202189[_0x5c3b4f(0x219)]+_0x5c3b4f(0x27d)+_0x202189[_0x5c3b4f(0x25b)]['host'];var _0x25e652=_0x5e36a8[_0x5c3b4f(0x20e)],_0x25c4de='',_0x1943b8,_0x5d0dd2=0x0;for(_0x1943b8 in _0x25e652){_0x25c4de+=_0x5c3b4f(0x25f)+_0x5c3b4f(0x271)+_0x25e652[_0x1943b8][_0x5c3b4f(0x24f)]+_0x5c3b4f(0x22e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25e652[_0x1943b8][_0x5c3b4f(0x251)]+_0x5c3b4f(0x22e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25e652[_0x1943b8]['quantity']+_0x5c3b4f(0x22e)+_0x5c3b4f(0x271)+_0x25e652[_0x1943b8][_0x5c3b4f(0x21f)]+_0x5c3b4f(0x22e)+_0x5c3b4f(0x1fe),_0x5d0dd2+=parseInt(_0x25e652[_0x1943b8][_0x5c3b4f(0x259)]);}let _0x2060e1={'from':_0xa4dd8b[_0x5c3b4f(0x26b)],'to':'christian.villamer@jakagroup.com','subject':_0x5c3b4f(0x255),'attachments':[{'filename':_0x5c3b4f(0x212),'path':__dirname+_0x5c3b4f(0x289)+_0x5c3b4f(0x281)+_0x20900f[0x0]['image'],'cid':'logo'}],'html':_0x5c3b4f(0x204)+_0x5c3b4f(0x23c)+_0x5c3b4f(0x224)+_0x5c3b4f(0x294)+'<div>'+_0x5c3b4f(0x285)+_0x5c3b4f(0x23b)+_0x5c3b4f(0x28d)+_0x5c3b4f(0x1f6)+_0x5c3b4f(0x23b)+_0x5c3b4f(0x257)+_0x5c3b4f(0x1f6)+_0x5c3b4f(0x1f6)+_0x5c3b4f(0x1ef)+_0x5c3b4f(0x23b)+'</div>'+'<div>'+_0x5c3b4f(0x27b)+_0x5c3b4f(0x1f6)+_0x5c3b4f(0x23b)+_0x5c3b4f(0x24c)+_0x5e36a8[_0x5c3b4f(0x21d)]+'</b></span>\x20<br>'+'<span>\x20Request\x20Date:\x20<b>'+_0x5e36a8[_0x5c3b4f(0x250)]+'</b></span>\x20<br><br>'+_0x5c3b4f(0x1f6)+_0x5c3b4f(0x221)+_0x5c3b4f(0x231)+_0x5c3b4f(0x25f)+_0x5c3b4f(0x1f5)+_0x5c3b4f(0x241)+_0x5c3b4f(0x28a)+_0x5c3b4f(0x1f9)+_0x5c3b4f(0x1fe)+_0x5c3b4f(0x207)+_0x5c3b4f(0x216)+'\x20'+_0x25c4de+'\x20'+'</tbody>'+'</table>'+_0x5c3b4f(0x23b)+_0x5c3b4f(0x252)+_0x5c3b4f(0x295)+'<br><br><br>'+_0x5c3b4f(0x1f6)+_0x5c3b4f(0x23b)+'<strong>\x20Regards\x20</strong>'+_0x5c3b4f(0x220)+_0x5c3b4f(0x1f6)+_0x5c3b4f(0x1f6)+_0x5c3b4f(0x239)+_0x5c3b4f(0x233)};_0x2cd08b[_0x5c3b4f(0x261)](_0x2060e1,function(_0x473788,_0x4daee9){var _0x2bd76c=_0x5c3b4f;_0x473788?(console[_0x2bd76c(0x28f)](_0x473788),console[_0x2bd76c(0x28f)](_0x2bd76c(0x210))):console[_0x2bd76c(0x28f)](_0x2bd76c(0x213));}),_0x202189[_0x5c3b4f(0x1fa)]('success',_0x5c3b4f(0x245)),_0x5ddb76[_0x5c3b4f(0x1f7)]('/all_sales_finished/preview/'+_0x434070[_0x5c3b4f(0x25e)]),_0x5ddb76['json'](_0xa8f21);return;}catch(_0x1707ed){}}),router[a0_0x3d6726(0x218)]('/view_sales_order/:id',auth,async(_0x13fe17,_0x5a5b75)=>{var _0x4c87c3=a0_0x3d6726;try{const _0x3f5703=await master_shop[_0x4c87c3(0x1fb)](),_0xdaefd=_0x13fe17[_0x4c87c3(0x234)],_0x4c7089=await profile['findOne']({'email':_0xdaefd[_0x4c87c3(0x26b)]}),_0x8ffb8d=await staff[_0x4c87c3(0x25d)]({'email':_0xdaefd[_0x4c87c3(0x26b)]}),_0x17ecab=await customer[_0x4c87c3(0x1fb)]({'agent_id':_0x8ffb8d['_id']}),_0x109505=mongoose[_0x4c87c3(0x28c)]['ObjectId'],_0x5e063a=_0x13fe17[_0x4c87c3(0x246)]['id'],_0x1120f5=await sales_order['findById'](_0x5e063a),_0x4d5456=await sales_order[_0x4c87c3(0x278)]([{'$match':{'_id':_0x109505(_0x5e063a)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x4c87c3(0x23f)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x4c87c3(0x202)}}},{'$lookup':{'from':_0x4c87c3(0x264),'localField':_0x4c87c3(0x275),'foreignField':'_id','as':_0x4c87c3(0x211)}},{'$unwind':_0x4c87c3(0x217)},{'$lookup':{'from':_0x4c87c3(0x264),'localField':'wms_account_id','foreignField':_0x4c87c3(0x25e),'as':_0x4c87c3(0x263)}},{'$unwind':_0x4c87c3(0x290)}]);if(_0x3f5703[0x0][_0x4c87c3(0x227)]==_0x4c87c3(0x21e))var _0x14d75c=users[_0x4c87c3(0x1fc)];else{if(_0x3f5703[0x0][_0x4c87c3(0x227)]==_0x4c87c3(0x24a))var _0x14d75c=users['Hindi'];else{if(_0x3f5703[0x0][_0x4c87c3(0x227)]=='German')var _0x14d75c=users['German'];else{if(_0x3f5703[0x0][_0x4c87c3(0x227)]=='Spanish')var _0x14d75c=users['Spanish'];else{if(_0x3f5703[0x0][_0x4c87c3(0x227)]=='French')var _0x14d75c=users[_0x4c87c3(0x274)];else{if(_0x3f5703[0x0][_0x4c87c3(0x227)]==_0x4c87c3(0x22a))var _0x14d75c=users['Portuguese'];else{if(_0x3f5703[0x0]['language']=='Chinese')var _0x14d75c=users['Chinese'];else{if(_0x3f5703[0x0][_0x4c87c3(0x227)]==_0x4c87c3(0x237))var _0x14d75c=users[_0x4c87c3(0x21c)];}}}}}}}_0x5a5b75['render'](_0x4c87c3(0x26e),{'success':_0x13fe17[_0x4c87c3(0x1fa)](_0x4c87c3(0x22d)),'errors':_0x13fe17[_0x4c87c3(0x1fa)](_0x4c87c3(0x277)),'master_shop':_0x3f5703,'profile':_0x4c7089,'role':_0xdaefd,'language':_0x14d75c,'customer':_0x17ecab,'sales_sa':_0x1120f5,'approvers':_0x4d5456[0x0],'the_id':_0x5e063a});}catch(_0x1da279){console[_0x4c87c3(0x28f)](_0x1da279);}}),router[a0_0x3d6726(0x23a)]('/data/data_rack',auth,async(_0x20e4e8,_0x375468)=>{var _0x14f3c6=a0_0x3d6726;try{const {warehouse_name:_0x229869,product_code:_0x56ddcc}=_0x20e4e8[_0x14f3c6(0x254)],_0x47771b=await warehouse[_0x14f3c6(0x278)]([{'$match':{'name':_0x229869}},{'$unwind':_0x14f3c6(0x248)},{'$match':{'product_details.product_code':_0x56ddcc}},{'$group':{'_id':{'room':_0x14f3c6(0x243),'_id':_0x14f3c6(0x279)}}}]);_0x375468[_0x14f3c6(0x232)](_0x47771b);}catch(_0x584dd4){}}),router[a0_0x3d6726(0x23a)](a0_0x3d6726(0x24b),auth,async(_0x482c30,_0x4293c6)=>{var _0x56dc5c=a0_0x3d6726;try{const {warehouse_name:_0x20b6f7,product_code:_0x2d27bf,room_name:_0x216417}=_0x482c30[_0x56dc5c(0x254)];console['log'](_0x482c30[_0x56dc5c(0x254)]);const _0x3d7f87=await warehouse['aggregate']([{'$match':{'name':_0x20b6f7,'room':_0x216417}},{'$unwind':_0x56dc5c(0x248)},{'$match':{'product_details.product_code':_0x2d27bf}},{'$group':{'_id':{'main_id':_0x56dc5c(0x279),'detl_id':'$product_details._id','product_name':_0x56dc5c(0x1f3),'product_code':_0x56dc5c(0x201),'level':_0x56dc5c(0x283),'bay':_0x56dc5c(0x225),'stocks':_0x56dc5c(0x208)}}}]);_0x4293c6['json'](_0x3d7f87);}catch(_0xf60a9b){}}),router['get'](a0_0x3d6726(0x25a),auth,async(_0x491906,_0x3c8a32)=>{var _0x3dd2c3=a0_0x3d6726;try{const {sttaff_id:_0x215e59,email:_0x3f06b6,warehouse:_0x51aa9f}=_0x491906[_0x3dd2c3(0x234)],_0x1474eb=await master_shop['find'](),_0x16f503=_0x491906[_0x3dd2c3(0x234)],_0x53618e=await profile[_0x3dd2c3(0x25d)]({'email':_0x16f503['email']}),_0x2a4781=await sales_order['find']({'wms_account_id':_0x215e59});if(_0x1474eb[0x0][_0x3dd2c3(0x227)]=='English\x20(US)')var _0x160634=users['English'];else{if(_0x1474eb[0x0][_0x3dd2c3(0x227)]=='Hindi')var _0x160634=users[_0x3dd2c3(0x24a)];else{if(_0x1474eb[0x0][_0x3dd2c3(0x227)]==_0x3dd2c3(0x287))var _0x160634=users['German'];else{if(_0x1474eb[0x0][_0x3dd2c3(0x227)]==_0x3dd2c3(0x22c))var _0x160634=users[_0x3dd2c3(0x22c)];else{if(_0x1474eb[0x0][_0x3dd2c3(0x227)]==_0x3dd2c3(0x274))var _0x160634=users[_0x3dd2c3(0x274)];else{if(_0x1474eb[0x0][_0x3dd2c3(0x227)]=='Portuguese\x20(BR)')var _0x160634=users[_0x3dd2c3(0x1f0)];else{if(_0x1474eb[0x0][_0x3dd2c3(0x227)]=='Chinese')var _0x160634=users[_0x3dd2c3(0x24d)];else{if(_0x1474eb[0x0]['language']==_0x3dd2c3(0x237))var _0x160634=users['Arabic'];}}}}}}}_0x3c8a32[_0x3dd2c3(0x22b)](_0x3dd2c3(0x209),{'success':_0x491906[_0x3dd2c3(0x1fa)](_0x3dd2c3(0x22d)),'errors':_0x491906[_0x3dd2c3(0x1fa)](_0x3dd2c3(0x277)),'master_shop':_0x1474eb,'profile':_0x53618e,'role':_0x16f503,'language':_0x160634,'sales_order':_0x2a4781});}catch(_0x3fecb4){}}),module[a0_0x3d6726(0x21a)]=router;