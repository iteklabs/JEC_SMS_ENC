var a0_0x26c838=a0_0x36c8;(function(_0x5c0bdf,_0x4b5c20){var _0x406eb2=a0_0x36c8,_0x16573f=_0x5c0bdf();while(!![]){try{var _0x1c7fb1=parseInt(_0x406eb2(0x1e0))/0x1+-parseInt(_0x406eb2(0x22e))/0x2+-parseInt(_0x406eb2(0x1ee))/0x3*(parseInt(_0x406eb2(0x232))/0x4)+-parseInt(_0x406eb2(0x1b8))/0x5*(-parseInt(_0x406eb2(0x23e))/0x6)+-parseInt(_0x406eb2(0x1fc))/0x7+-parseInt(_0x406eb2(0x20f))/0x8+parseInt(_0x406eb2(0x201))/0x9;if(_0x1c7fb1===_0x4b5c20)break;else _0x16573f['push'](_0x16573f['shift']());}catch(_0x561543){_0x16573f['push'](_0x16573f['shift']());}}}(a0_0x89a1,0xc6c45));const express=require('express'),app=express(),router=express[a0_0x26c838(0x1d1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x26c838(0x1ef)),auth=require(a0_0x26c838(0x1b1)),users=require(a0_0x26c838(0x1b5)),excelJS=require('exceljs'),xlsx=require(a0_0x26c838(0x217)),mongoose=require(a0_0x26c838(0x224)),{ObjectId}=require(a0_0x26c838(0x22b)),nodemailer=require('nodemailer');function a0_0x36c8(_0x361810,_0x5e0a14){var _0x89a148=a0_0x89a1();return a0_0x36c8=function(_0x36c861,_0x2b8c90){_0x36c861=_0x36c861-0x1a7;var _0x1a08a5=_0x89a148[_0x36c861];return _0x1a08a5;},a0_0x36c8(_0x361810,_0x5e0a14);}router[a0_0x26c838(0x1eb)](a0_0x26c838(0x21d),auth,async(_0x9ce0b1,_0x26110c)=>{var _0x3f519f=a0_0x26c838;try{const _0x4b958a=await master_shop[_0x3f519f(0x1ed)](),_0x3a8c53=_0x9ce0b1[_0x3f519f(0x1fe)],_0x42f3db=await profile['findOne']({'email':_0x3a8c53[_0x3f519f(0x220)]}),_0x5d6d54=await staff['findOne']({'email':_0x3a8c53[_0x3f519f(0x220)]}),_0x27564f=await customer['find']({'agent_id':_0x5d6d54[_0x3f519f(0x1b0)]}),_0x4886e8=mongoose[_0x3f519f(0x1bb)][_0x3f519f(0x1b4)],_0x5037d3=_0x9ce0b1[_0x3f519f(0x230)]['id'],_0x11dff1=await sales_order[_0x3f519f(0x229)](_0x5037d3),_0x516b2c=await sales_order[_0x3f519f(0x1e4)]([{'$match':{'_id':_0x4886e8(_0x5037d3)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x3f519f(0x1e6)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x3f519f(0x1b9)}}},{'$lookup':{'from':_0x3f519f(0x1fb),'localField':'accounting_account_id','foreignField':_0x3f519f(0x1b0),'as':_0x3f519f(0x22f)}},{'$unwind':_0x3f519f(0x1d4)},{'$lookup':{'from':_0x3f519f(0x1fb),'localField':_0x3f519f(0x21b),'foreignField':_0x3f519f(0x1b0),'as':'wms_data'}},{'$unwind':_0x3f519f(0x214)}]);if(_0x4b958a[0x0]['language']==_0x3f519f(0x1ff))var _0x40a9bd=users[_0x3f519f(0x228)];else{if(_0x4b958a[0x0][_0x3f519f(0x1e3)]==_0x3f519f(0x1f8))var _0x40a9bd=users[_0x3f519f(0x1f8)];else{if(_0x4b958a[0x0][_0x3f519f(0x1e3)]==_0x3f519f(0x1db))var _0x40a9bd=users[_0x3f519f(0x1db)];else{if(_0x4b958a[0x0][_0x3f519f(0x1e3)]==_0x3f519f(0x20d))var _0x40a9bd=users[_0x3f519f(0x20d)];else{if(_0x4b958a[0x0][_0x3f519f(0x1e3)]==_0x3f519f(0x1dc))var _0x40a9bd=users[_0x3f519f(0x1dc)];else{if(_0x4b958a[0x0][_0x3f519f(0x1e3)]==_0x3f519f(0x1ae))var _0x40a9bd=users[_0x3f519f(0x1d8)];else{if(_0x4b958a[0x0][_0x3f519f(0x1e3)]==_0x3f519f(0x1f0))var _0x40a9bd=users['Chinese'];else{if(_0x4b958a[0x0]['language']==_0x3f519f(0x1f3))var _0x40a9bd=users[_0x3f519f(0x1cb)];}}}}}}}_0x26110c[_0x3f519f(0x1ba)](_0x3f519f(0x1af),{'success':_0x9ce0b1[_0x3f519f(0x1c5)](_0x3f519f(0x226)),'errors':_0x9ce0b1[_0x3f519f(0x1c5)](_0x3f519f(0x1cf)),'master_shop':_0x4b958a,'profile':_0x42f3db,'role':_0x3a8c53,'language':_0x40a9bd,'customer':_0x27564f,'sales_sa':_0x11dff1,'approvers':_0x516b2c[0x0],'the_id':_0x5037d3});}catch(_0x548268){console[_0x3f519f(0x1d7)](_0x548268);}}),router[a0_0x26c838(0x1c4)](a0_0x26c838(0x21d),auth,async(_0x1155fe,_0x34d294)=>{var _0x35077b=a0_0x26c838;try{const {date:_0xcdd68d,invoice_data:_0x753ebf,wms_confirm:_0x5f3ea0,the_id_val:_0x114881,prod_id:_0x5c2e89,SCRN:_0x164fb8,ReqBy:_0x265338,dateofreq:_0x5030c5,PO_number:_0x39aa89,warehouse_name:_0x187ab7,typeservicesData:_0x129747,typevehicle:_0x429a7e,destination:_0x475d9f,deliverydate:_0x42a3ac,driver:_0x29bf27,plate:_0x549187,van:_0xe29741,DRSI:_0x52e1d9,TSU:_0x443a0d,TFU:_0x4ee888,note:_0x1e940e}=_0x1155fe['body'],_0x9b8bf1=await sales_order[_0x35077b(0x229)](_0x114881);if(typeof _0x5c2e89=='string')var _0x30061e=[_0x1155fe[_0x35077b(0x227)][_0x35077b(0x1f5)]],_0x8aa71d=[_0x1155fe[_0x35077b(0x227)][_0x35077b(0x207)]],_0xeee247=[_0x1155fe['body'][_0x35077b(0x1c0)]];else var _0x30061e=[..._0x1155fe[_0x35077b(0x227)][_0x35077b(0x1f5)]],_0x8aa71d=[..._0x1155fe[_0x35077b(0x227)][_0x35077b(0x207)]],_0xeee247=[..._0x1155fe[_0x35077b(0x227)][_0x35077b(0x1c0)]];const _0x428563=_0x30061e['map'](_0x438188=>{return _0x438188={'prod_id':_0x438188};});_0xeee247[_0x35077b(0x1a8)]((_0x367346,_0x290853)=>{var _0x38d09a=_0x35077b,_0x275b69=_0x367346[_0x38d09a(0x1b7)]('~');_0x428563[_0x290853]['warehouse_id']=_0x275b69[0x0],_0x428563[_0x290853][_0x38d09a(0x215)]=_0x275b69[0x1];}),_0x8aa71d[_0x35077b(0x1a8)]((_0x3895b9,_0x120524)=>{_0x428563[_0x120524]['request_qty']=_0x3895b9;});var _0x27d843=[],_0xb3c260=[],_0x3d90bf=[],_0x1cf363=[],_0x4f5c4e=[],_0x568c3d=[],_0x146be3=[],_0x31a09c=[],_0x3e9c78=[],_0x490bcf=[],_0x358d21=[],_0x1df40b=[],_0x40485a=[],_0x267602=[],_0x35641d=[],_0x86b9b5=[],_0x1fd73b=[],_0x4a6257=[],_0x5eb0a3=[],_0x2eece0=[];for(let _0x306139=0x0;_0x306139<=_0x428563[_0x35077b(0x222)]-0x1;_0x306139++){const _0x5b199c=_0x428563[_0x306139],_0x46766e=mongoose[_0x35077b(0x1bb)][_0x35077b(0x1b4)];var _0xd0fe27=await warehouse['aggregate']([{'$match':{'_id':_0x46766e(_0x5b199c[_0x35077b(0x23a)])}},{'$unwind':_0x35077b(0x1cd)},{'$match':{'product_details._id':_0x46766e(_0x5b199c[_0x35077b(0x215)])}}]),_0x515237=0x0;for(let _0x3321f7=0x0;_0x3321f7<=_0xd0fe27[_0x35077b(0x222)]-0x1;_0x3321f7++){var _0x293197=_0xd0fe27[_0x3321f7];_0x293197[_0x35077b(0x213)][_0x35077b(0x1f6)]<_0x5b199c['request_qty']&&_0x515237++;}if(_0x515237>0x0)return _0x1155fe[_0x35077b(0x1c5)]('errors',_0x35077b(0x1d3)),_0x34d294['redirect'](_0x35077b(0x22c));var _0x3ed8ca=0x0;for(let _0x2b60f2=0x0;_0x2b60f2<=_0xd0fe27[_0x35077b(0x222)]-0x1;_0x2b60f2++){var _0x293197=_0xd0fe27[_0x2b60f2];_0x293197['product_details'][_0x35077b(0x1f6)]>_0x5b199c[_0x35077b(0x20b)]&&(_0x27d843[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x1e2)]),_0xb3c260[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x1f6)]),_0x3d90bf[_0x35077b(0x204)](_0x5b199c['request_qty']),_0x1cf363[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x1d5)]),_0x4f5c4e[_0x35077b(0x204)](_0x293197['product_details'][_0x35077b(0x23b)]),_0x568c3d[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x1f9)]),_0x146be3[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x1b2)]),_0x31a09c[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x205)]),_0x3e9c78[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x1ac)]),_0x490bcf[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x219)]),_0x358d21['push'](_0x293197[_0x35077b(0x213)][_0x35077b(0x210)]),_0x1df40b[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x1d9)]),_0x40485a[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x1cc)]),_0x267602[_0x35077b(0x204)](_0x293197['product_details'][_0x35077b(0x1ea)]),_0x35641d[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x240)]),_0x86b9b5[_0x35077b(0x204)](_0x293197[_0x35077b(0x1fd)]),_0x1fd73b[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)][_0x35077b(0x23f)]),_0x4a6257[_0x35077b(0x204)](_0x293197[_0x35077b(0x213)]['_id']),_0x5eb0a3['push'](_0x293197['product_details']['uuid']),_0x2eece0['push'](_0x293197[_0x35077b(0x213)][_0x35077b(0x21a)]),_0x3ed8ca++);}}const _0x5792da=_0x27d843[_0x35077b(0x1da)](_0x151a7a=>{return _0x151a7a={'product_name':_0x151a7a};});_0xb3c260['forEach']((_0x200dfa,_0x4f7a71)=>{var _0x43fe94=_0x35077b;_0x5792da[_0x4f7a71][_0x43fe94(0x20e)]=_0x200dfa;}),_0x3d90bf[_0x35077b(0x1a8)]((_0x5e2d3f,_0x5339d8)=>{var _0x48a8f8=_0x35077b;_0x5792da[_0x5339d8]['quantity']=Math[_0x48a8f8(0x1a7)](_0x5e2d3f);}),_0x2eece0[_0x35077b(0x1a8)]((_0x3d6583,_0xbbdb4f)=>{var _0x1aedd0=_0x35077b;_0x5792da[_0xbbdb4f][_0x1aedd0(0x21a)]=_0x3d6583;}),_0x5eb0a3['forEach']((_0x178f80,_0x382b77)=>{var _0x288492=_0x35077b;_0x5792da[_0x382b77][_0x288492(0x236)]=_0x178f80;}),_0x4a6257['forEach']((_0x23d118,_0xc7d04f)=>{var _0x9637bf=_0x35077b;_0x5792da[_0xc7d04f][_0x9637bf(0x1f1)]=_0x23d118;}),_0x1cf363[_0x35077b(0x1a8)]((_0x5c3b3d,_0x2da706)=>{var _0x5cadb5=_0x35077b;_0x5792da[_0x2da706][_0x5cadb5(0x1d5)]=_0x5c3b3d;}),_0x4f5c4e['forEach']((_0x82ec7b,_0x5b4c7e)=>{_0x5792da[_0x5b4c7e]['secondary_code']=_0x82ec7b;}),_0x568c3d['forEach']((_0x2650ef,_0x22d49f)=>{var _0x305055=_0x35077b;_0x5792da[_0x22d49f][_0x305055(0x1f9)]=_0x2650ef;}),_0x146be3[_0x35077b(0x1a8)]((_0x4a4ab6,_0x64387e)=>{var _0x5aa2a7=_0x35077b;_0x5792da[_0x64387e][_0x5aa2a7(0x1b2)]=_0x4a4ab6;}),_0x31a09c[_0x35077b(0x1a8)]((_0x356c45,_0x51e20d)=>{var _0x203e5c=_0x35077b;_0x5792da[_0x51e20d][_0x203e5c(0x205)]=_0x356c45;}),_0x3e9c78[_0x35077b(0x1a8)]((_0x711a99,_0x2d0035)=>{var _0x3c0109=_0x35077b;_0x5792da[_0x2d0035][_0x3c0109(0x1ac)]=_0x711a99;}),_0x490bcf['forEach']((_0x337098,_0x2be002)=>{_0x5792da[_0x2be002]['secondary_unit']=_0x337098;}),_0x358d21[_0x35077b(0x1a8)]((_0x7c99c3,_0x5023bd)=>{var _0x2f7aa0=_0x35077b;_0x5792da[_0x5023bd][_0x2f7aa0(0x210)]=_0x7c99c3;}),_0x1df40b['forEach']((_0x122e7d,_0x10ca9a)=>{_0x5792da[_0x10ca9a]['expiry_date']=_0x122e7d;}),_0x40485a[_0x35077b(0x1a8)]((_0x55b305,_0x1cd2ac)=>{var _0x3d575b=_0x35077b;_0x5792da[_0x1cd2ac][_0x3d575b(0x1cc)]=_0x55b305;}),_0x267602['forEach']((_0x156736,_0x4fd5b4)=>{var _0x48a5c6=_0x35077b;_0x5792da[_0x4fd5b4][_0x48a5c6(0x1c7)]=_0x156736;}),_0x35641d['forEach']((_0x535d67,_0x2f16af)=>{_0x5792da[_0x2f16af]['prod_cat']=_0x535d67;}),_0x86b9b5[_0x35077b(0x1a8)]((_0x486fa2,_0x231269)=>{_0x5792da[_0x231269]['room_name']=_0x486fa2;}),_0x1fd73b[_0x35077b(0x1a8)]((_0x2431f9,_0x3b637d)=>{var _0x54507a=_0x35077b;_0x5792da[_0x3b637d][_0x54507a(0x23f)]=_0x2431f9,_0x5792da[_0x3b637d][_0x54507a(0x1b3)]=_0xcdd68d;});const _0x42f11e=new invoice_for_outgoing();await _0x42f11e[_0x35077b(0x208)](),_0x1fd73b[_0x35077b(0x1a8)]((_0x9ba477,_0x241146)=>{var _0x46effc=_0x35077b;_0x5792da[_0x241146]['outgoing_invoice']=_0x46effc(0x1b6)+_0x42f11e[_0x46effc(0x1dd)][_0x46effc(0x20c)]()[_0x46effc(0x1c3)](0x8,'0');});const _0x4d4be0=_0x5792da['filter'](_0x3be751=>_0x3be751[_0x35077b(0x1bf)]!=='0'&&_0x3be751[_0x35077b(0x1bf)]!==''),_0x4d63f0=new sales_finished({'invoice':_0x35077b(0x1b6)+_0x42f11e[_0x35077b(0x1dd)][_0x35077b(0x20c)]()[_0x35077b(0x1c3)](0x8,'0'),'date':_0xcdd68d,'warehouse_name':_0x187ab7,'sale_product':_0x4d4be0,'note':_0x1e940e,'SCRN':_0x164fb8,'finalize':'False','ReqBy':_0x265338,'dateofreq':_0x5030c5,'PO_number':_0x39aa89,'typeservicesData':_0x129747,'typevehicle':_0x429a7e,'destination':_0x475d9f,'deliverydate':_0x42a3ac,'driver':_0x29bf27,'plate':_0x549187,'van':_0xe29741,'DRSI':_0x52e1d9,'TSU':_0x443a0d,'TFU':_0x4ee888}),_0x3594eb=await _0x4d63f0['save'](),_0x4a8746=new Date(),_0x5e5683=_0x4a8746['toLocaleDateString']();_0x9b8bf1[_0x35077b(0x1ad)]=_0x5f3ea0,_0x9b8bf1[_0x35077b(0x21e)]=_0x5e5683,_0x9b8bf1['document_number_out']=_0x35077b(0x1b6)+_0x42f11e[_0x35077b(0x1dd)][_0x35077b(0x20c)]()['padStart'](0x8,'0'),_0x9b8bf1[_0x35077b(0x1e9)]=_0x3594eb[_0x35077b(0x1b0)],await _0x9b8bf1['save']();const _0x263104=await master_shop[_0x35077b(0x1ed)](),_0x2ee6fa=await email_settings['findOne']();let _0x263270=nodemailer['createTransport']({'host':_0x2ee6fa['host'],'port':Number(_0x2ee6fa[_0x35077b(0x239)]),'secure':![],'auth':{'user':_0x2ee6fa['email'],'pass':_0x2ee6fa['password']}});const _0xe9b32a=_0x1155fe[_0x35077b(0x1d0)]+'://'+_0x1155fe['headers']['host'];var _0x3931b2=_0x9b8bf1[_0x35077b(0x206)],_0xdbe4fa='',_0xeda39b,_0x590f81=0x0;for(_0xeda39b in _0x3931b2){_0xdbe4fa+=_0x35077b(0x202)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3931b2[_0xeda39b][_0x35077b(0x1e2)]+_0x35077b(0x1df)+_0x35077b(0x211)+_0x3931b2[_0xeda39b][_0x35077b(0x1f9)]+'</td>'+_0x35077b(0x211)+_0x3931b2[_0xeda39b][_0x35077b(0x1bf)]+'</td>'+_0x35077b(0x211)+_0x3931b2[_0xeda39b]['unit']+_0x35077b(0x1df)+_0x35077b(0x231),_0x590f81+=parseInt(_0x3931b2[_0xeda39b][_0x35077b(0x1bf)]);}let _0x4f15db={'from':_0x2ee6fa[_0x35077b(0x220)],'to':_0x35077b(0x1c8),'subject':_0x35077b(0x237),'attachments':[{'filename':_0x35077b(0x216),'path':__dirname+_0x35077b(0x225)+'/upload/'+_0x263104[0x0]['image'],'cid':_0x35077b(0x1d6)}],'html':_0x35077b(0x235)+_0x35077b(0x1ec)+_0x35077b(0x1e8)+_0x35077b(0x21c)+_0x35077b(0x238)+_0x35077b(0x1de)+_0x35077b(0x238)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x35077b(0x223)+_0x35077b(0x238)+_0x35077b(0x1c1)+_0x35077b(0x223)+_0x35077b(0x223)+_0x35077b(0x234)+_0x35077b(0x238)+'</div>'+_0x35077b(0x238)+_0x35077b(0x1e1)+_0x35077b(0x223)+_0x35077b(0x238)+_0x35077b(0x1a9)+_0x9b8bf1[_0x35077b(0x23f)]+'</b></span>\x20<br>'+_0x35077b(0x1bd)+_0x9b8bf1[_0x35077b(0x21f)]+_0x35077b(0x209)+_0x35077b(0x223)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x35077b(0x202)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x35077b(0x221)+_0x35077b(0x1ab)+_0x35077b(0x231)+_0x35077b(0x1d2)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0xdbe4fa+'\x20'+'</tbody>'+_0x35077b(0x1fa)+_0x35077b(0x238)+_0x35077b(0x1bc)+'<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>'+_0x35077b(0x212)+'</div>'+_0x35077b(0x238)+_0x35077b(0x203)+_0x35077b(0x1ca)+_0x35077b(0x223)+_0x35077b(0x223)+_0x35077b(0x1f7)+_0x35077b(0x1c2)};_0x263270['sendMail'](_0x4f15db,function(_0xa971,_0x2e27ff){var _0x1dc0bc=_0x35077b;_0xa971?(console[_0x1dc0bc(0x1d7)](_0xa971),console[_0x1dc0bc(0x1d7)](_0x1dc0bc(0x23d))):console[_0x1dc0bc(0x1d7)](_0x1dc0bc(0x218));}),_0x1155fe['flash']('success','Sales\x20Add\x20successfully'),_0x34d294['redirect'](_0x35077b(0x1aa)+_0x3594eb[_0x35077b(0x1b0)]),_0x34d294['json'](_0x4d4be0);return;}catch(_0x59580c){}}),router[a0_0x26c838(0x1eb)](a0_0x26c838(0x1c9),auth,async(_0x29a037,_0x5e15ea)=>{var _0x3a64af=a0_0x26c838;try{const _0x40f4e5=await master_shop[_0x3a64af(0x1ed)](),_0xb2d68=_0x29a037[_0x3a64af(0x1fe)],_0x12c927=await profile['findOne']({'email':_0xb2d68['email']}),_0x10c213=await staff['findOne']({'email':_0xb2d68['email']}),_0x1ac672=await customer[_0x3a64af(0x1ed)]({'agent_id':_0x10c213[_0x3a64af(0x1b0)]}),_0x177055=mongoose[_0x3a64af(0x1bb)][_0x3a64af(0x1b4)],_0x420776=_0x29a037['params']['id'],_0x15d613=await sales_order['findById'](_0x420776),_0x8f1b05=await sales_order[_0x3a64af(0x1e4)]([{'$match':{'_id':_0x177055(_0x420776)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x3a64af(0x1e6)}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x3a64af(0x1b9)}}},{'$lookup':{'from':_0x3a64af(0x1fb),'localField':'accounting_account_id','foreignField':_0x3a64af(0x1b0),'as':_0x3a64af(0x22f)}},{'$unwind':_0x3a64af(0x1d4)},{'$lookup':{'from':_0x3a64af(0x1fb),'localField':_0x3a64af(0x21b),'foreignField':_0x3a64af(0x1b0),'as':_0x3a64af(0x1f2)}},{'$unwind':_0x3a64af(0x214)}]);if(_0x40f4e5[0x0][_0x3a64af(0x1e3)]=='English\x20(US)')var _0x25e29f=users[_0x3a64af(0x228)];else{if(_0x40f4e5[0x0][_0x3a64af(0x1e3)]==_0x3a64af(0x1f8))var _0x25e29f=users[_0x3a64af(0x1f8)];else{if(_0x40f4e5[0x0][_0x3a64af(0x1e3)]==_0x3a64af(0x1db))var _0x25e29f=users['German'];else{if(_0x40f4e5[0x0][_0x3a64af(0x1e3)]==_0x3a64af(0x20d))var _0x25e29f=users['Spanish'];else{if(_0x40f4e5[0x0][_0x3a64af(0x1e3)]==_0x3a64af(0x1dc))var _0x25e29f=users[_0x3a64af(0x1dc)];else{if(_0x40f4e5[0x0][_0x3a64af(0x1e3)]==_0x3a64af(0x1ae))var _0x25e29f=users[_0x3a64af(0x1d8)];else{if(_0x40f4e5[0x0][_0x3a64af(0x1e3)]=='Chinese')var _0x25e29f=users[_0x3a64af(0x1f0)];else{if(_0x40f4e5[0x0][_0x3a64af(0x1e3)]==_0x3a64af(0x1f3))var _0x25e29f=users[_0x3a64af(0x1cb)];}}}}}}}_0x5e15ea['render'](_0x3a64af(0x1e7),{'success':_0x29a037[_0x3a64af(0x1c5)](_0x3a64af(0x226)),'errors':_0x29a037[_0x3a64af(0x1c5)]('errors'),'master_shop':_0x40f4e5,'profile':_0x12c927,'role':_0xb2d68,'language':_0x25e29f,'customer':_0x1ac672,'sales_sa':_0x15d613,'approvers':_0x8f1b05[0x0],'the_id':_0x420776});}catch(_0xd06f2d){console[_0x3a64af(0x1d7)](_0xd06f2d);}}),router['post']('/data/data_rack',auth,async(_0x3f9502,_0x55465f)=>{var _0x5f2cfa=a0_0x26c838;try{const {warehouse_name:_0x6a4e0f,product_code:_0x3358de}=_0x3f9502[_0x5f2cfa(0x227)],_0xda4ff7=await warehouse['aggregate']([{'$match':{'name':_0x6a4e0f}},{'$unwind':_0x5f2cfa(0x1cd)},{'$match':{'product_details.product_code':_0x3358de}},{'$group':{'_id':{'room':_0x5f2cfa(0x23c),'_id':_0x5f2cfa(0x233)}}}]);_0x55465f['json'](_0xda4ff7);}catch(_0x3a203d){}}),router[a0_0x26c838(0x1c4)](a0_0x26c838(0x1ce),auth,async(_0x2f8fa5,_0x230892)=>{var _0x4dec86=a0_0x26c838;try{const {warehouse_name:_0x21fbc2,product_code:_0x17b446,room_name:_0x8ad5cd}=_0x2f8fa5[_0x4dec86(0x227)];console[_0x4dec86(0x1d7)](_0x2f8fa5[_0x4dec86(0x227)]);const _0x3b35a7=await warehouse[_0x4dec86(0x1e4)]([{'$match':{'name':_0x21fbc2,'room':_0x8ad5cd}},{'$unwind':_0x4dec86(0x1cd)},{'$match':{'product_details.product_code':_0x17b446}},{'$group':{'_id':{'main_id':_0x4dec86(0x233),'detl_id':'$product_details._id','product_name':_0x4dec86(0x22a),'product_code':_0x4dec86(0x1e5),'level':_0x4dec86(0x200),'bay':'$product_details.bay','stocks':_0x4dec86(0x1be)}}}]);_0x230892[_0x4dec86(0x1f4)](_0x3b35a7);}catch(_0x37fa46){}}),router[a0_0x26c838(0x1eb)](a0_0x26c838(0x20a),auth,async(_0x4342dd,_0x235749)=>{var _0x3dd239=a0_0x26c838;try{const {sttaff_id:_0x6b1179,email:_0xb3e719,warehouse:_0x41bbd3}=_0x4342dd[_0x3dd239(0x1fe)],_0x30c807=await master_shop[_0x3dd239(0x1ed)](),_0x3cbf6e=_0x4342dd[_0x3dd239(0x1fe)],_0xeb44fc=await profile['findOne']({'email':_0x3cbf6e[_0x3dd239(0x220)]}),_0x3406aa=await sales_order[_0x3dd239(0x1ed)]({'wms_account_id':_0x6b1179});if(_0x30c807[0x0][_0x3dd239(0x1e3)]==_0x3dd239(0x1ff))var _0x5a3782=users[_0x3dd239(0x228)];else{if(_0x30c807[0x0]['language']=='Hindi')var _0x5a3782=users[_0x3dd239(0x1f8)];else{if(_0x30c807[0x0][_0x3dd239(0x1e3)]==_0x3dd239(0x1db))var _0x5a3782=users[_0x3dd239(0x1db)];else{if(_0x30c807[0x0]['language']==_0x3dd239(0x20d))var _0x5a3782=users['Spanish'];else{if(_0x30c807[0x0][_0x3dd239(0x1e3)]==_0x3dd239(0x1dc))var _0x5a3782=users[_0x3dd239(0x1dc)];else{if(_0x30c807[0x0][_0x3dd239(0x1e3)]==_0x3dd239(0x1ae))var _0x5a3782=users[_0x3dd239(0x1d8)];else{if(_0x30c807[0x0][_0x3dd239(0x1e3)]==_0x3dd239(0x1f0))var _0x5a3782=users[_0x3dd239(0x1f0)];else{if(_0x30c807[0x0][_0x3dd239(0x1e3)]==_0x3dd239(0x1f3))var _0x5a3782=users[_0x3dd239(0x1cb)];}}}}}}}_0x235749[_0x3dd239(0x1ba)](_0x3dd239(0x22d),{'success':_0x4342dd[_0x3dd239(0x1c5)](_0x3dd239(0x226)),'errors':_0x4342dd[_0x3dd239(0x1c5)](_0x3dd239(0x1cf)),'master_shop':_0x30c807,'profile':_0xeb44fc,'role':_0x3cbf6e,'language':_0x5a3782,'sales_order':_0x3406aa});}catch(_0x47bdf1){}}),module[a0_0x26c838(0x1c6)]=router;function a0_0x89a1(){var _0x302b8d=['$account_data','primary_code','logo','log','Portuguese','expiry_date','map','German','French','invoice_init','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</td>','985645vpTDTH','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','product_name','language','aggregate','$product_details.product_code','$accounting_account_id','view_accounting_approval','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','outgoing_id','maxPerUnit','get','<html><head><title></title>','find','12993oNEoXL','../models/all_models','Chinese','id_transaction_from','wms_data','Arabic\x20(ae)','json','prod_id','product_stock','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','Hindi','product_code','</table>','staffs','8621494drcMVQ','room','user','English\x20(US)','$product_details.level','19679382DfBuAh','<tr>','<strong>\x20Regards\x20</strong>','push','bay','sale_product','qty','save','</b></span>\x20<br><br>','/data/All','request_qty','toString','Spanish','stock','728944LoSXOQ','batch_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<br><br><br>','product_details','$wms_data','warehouse_detl','Logo.png','xlsx','Email\x20sent\x20successfully','secondary_unit','gross_price','wms_account_id','</head><body>','/:id','wms_account_date','date','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','length','</div>','mongoose','/../public','success','body','English','findById','$product_details.product_name','mongodb','back','warehouse_approval_All','1734510FdXPDJ','account_data','params','</tr>','748tNcaUh','$_id','<hr\x20class=\x22my-3\x22>','<!DOCTYPE\x20html>','uuid','Email\x20for\x20Customer','<div>','port','warehouse_id','secondary_code','$room','Error\x20Occurs','2634NMCyCh','invoice','product_cat','abs','forEach','<span>\x20Request\x20ID:\x20<b>','/all_sales_finished/preview/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','unit','wms_account_confirm','Portuguese\x20(BR)','warehouse_approval','_id','../middleware/auth','level','date_data','ObjectId','../public/language/languages.json','OUT-','split','7310MqJeXx','$wms_account_id','render','Types','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','<span>\x20Request\x20Date:\x20<b>','$product_details.product_stock','quantity','data_loc','<h2>\x20JEC\x20SMS\x20</h2>','</body></html>','padStart','post','flash','exports','maxperunit','christian.villamer@jakagroup.com','/view_sales_order/:id','<h5>\x20JEC\x20SMS\x20</h5>','Arabic','production_date','$product_details','/data/data_loc','errors','protocol','Router','</thead>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'];a0_0x89a1=function(){return _0x302b8d;};return a0_0x89a1();}