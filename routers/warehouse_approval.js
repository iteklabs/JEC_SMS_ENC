var a0_0x20d6a6=a0_0x44ab;(function(_0x5440db,_0x51b0a6){var _0x2bc5eb=a0_0x44ab,_0x25f1d0=_0x5440db();while(!![]){try{var _0x1f9479=-parseInt(_0x2bc5eb(0x135))/0x1*(-parseInt(_0x2bc5eb(0xf3))/0x2)+-parseInt(_0x2bc5eb(0x12e))/0x3+-parseInt(_0x2bc5eb(0x134))/0x4+parseInt(_0x2bc5eb(0x13e))/0x5*(parseInt(_0x2bc5eb(0x18d))/0x6)+-parseInt(_0x2bc5eb(0x146))/0x7+parseInt(_0x2bc5eb(0x162))/0x8+parseInt(_0x2bc5eb(0x194))/0x9*(parseInt(_0x2bc5eb(0x174))/0xa);if(_0x1f9479===_0x51b0a6)break;else _0x25f1d0['push'](_0x25f1d0['shift']());}catch(_0x1097f2){_0x25f1d0['push'](_0x25f1d0['shift']());}}}(a0_0x287c,0x8cf19));const express=require('express'),app=express(),router=express[a0_0x20d6a6(0x158)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,invoice_for_outgoing,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings,sales_finished}=require(a0_0x20d6a6(0x141)),auth=require(a0_0x20d6a6(0x178)),users=require('../public/language/languages.json'),excelJS=require(a0_0x20d6a6(0x15a)),xlsx=require(a0_0x20d6a6(0x148)),mongoose=require('mongoose'),{ObjectId}=require(a0_0x20d6a6(0x157)),nodemailer=require('nodemailer');function a0_0x287c(){var _0xb719fb=['stock','bay','save','string','15940lnAtim','padStart','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','../models/all_models','log','False','$room','English','35889vzooOf','/data/All','xlsx','expiry_date','findOne','$product_details.product_stock','product_name','$product_details','</div>','protocol','outgoing_invoice','redirect','product_code','<div>','prod_cat','toLocaleDateString','OUT-','mongodb','Router','unit','exceljs','<tbody\x20style=\x22text-align:\x20center;\x22>','Spanish','quantity','split','warehouse_id','map','invoice_init','748792AFRnRZ','/data/data_rack','wms_account_date','warehouse_detl','find','body','Error\x20Occurs','Types','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<!DOCTYPE\x20html>','filter','secondary_code','</b></span>\x20<br>','request_qty','$_id','findById','ObjectId','/view_sales_order/:id','50AosPdD','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</tr>','christian.villamer@jakagroup.com','../middleware/auth','Hindi','/all_sales_finished/preview/','warehouse_approval_All','warehouse_approval','room','email','</b></span>\x20<br><br>','id_transaction_from','wms_account_id','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','$product_details.product_code','password','</body></html>','qty','<h2>\x20JEC\x20SMS\x20</h2>','product_details','accounting_account_id','Arabic','French','maxperunit','426FRZTlP','product_cat','German','success','<hr\x20class=\x22my-3\x22>','://','data_loc','1389447emZFgx','<html><head><title></title>','517078qecyYX','render','view_accounting_approval','aggregate','<br><br><br>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','date','push','errors','prod_id','staffs','<h5>\x20JEC\x20SMS\x20</h5>','params','<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','language','</head><body>','</thead>','<strong>\x20Regards\x20</strong>','$product_details.level','uuid','gross_price','exports','user','toString','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','</td>','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20and\x20Approved\x20by\x20Accounting\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','$product_details._id','length','outgoing_id','_id','English\x20(US)','$account_data','Email\x20sent\x20successfully','logo','product_stock','invoice','<span>\x20Request\x20ID:\x20<b>','wms_account_confirm','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</tbody>','$wms_account_id','headers','host','port','$wms_data','batch_code','room_name','forEach','Arabic\x20(ae)','Portuguese\x20(BR)','Portuguese','/upload/','secondary_unit','Chinese','wms_data','production_date','level','1048467tTkKgh','account_data','flash','<tr>','sale_product','json','2708076UiahTi','2ysDUnx','post','Sales\x20Add\x20successfully','sendMail','get'];a0_0x287c=function(){return _0xb719fb;};return a0_0x287c();}function a0_0x44ab(_0x113fd6,_0x19f459){var _0x287ccf=a0_0x287c();return a0_0x44ab=function(_0x44ab5c,_0x40193a){_0x44ab5c=_0x44ab5c-0xf3;var _0x5801c0=_0x287ccf[_0x44ab5c];return _0x5801c0;},a0_0x44ab(_0x113fd6,_0x19f459);}router[a0_0x20d6a6(0x139)]('/:id',auth,async(_0x3818ec,_0x35f49f)=>{var _0x39ed9e=a0_0x20d6a6;try{const _0x3f47ec=await master_shop['find'](),_0xa0447a=_0x3818ec[_0x39ed9e(0x109)],_0x2a4e09=await profile['findOne']({'email':_0xa0447a[_0x39ed9e(0x17e)]}),_0x442a37=await staff[_0x39ed9e(0x14a)]({'email':_0xa0447a[_0x39ed9e(0x17e)]}),_0x404594=await customer[_0x39ed9e(0x166)]({'agent_id':_0x442a37[_0x39ed9e(0x112)]}),_0x2a8f1b=mongoose[_0x39ed9e(0x169)]['ObjectId'],_0x59674b=_0x3818ec[_0x39ed9e(0xff)]['id'],_0x415e2d=await sales_order[_0x39ed9e(0x171)](_0x59674b),_0x1b8105=await sales_order['aggregate']([{'$match':{'_id':_0x2a8f1b(_0x59674b)}},{'$addFields':{'accounting_account_id':{'$toObjectId':'$accounting_account_id'}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x39ed9e(0x11d)}}},{'$lookup':{'from':_0x39ed9e(0xfd),'localField':_0x39ed9e(0x189),'foreignField':'_id','as':_0x39ed9e(0x12f)}},{'$unwind':_0x39ed9e(0x114)},{'$lookup':{'from':'staffs','localField':_0x39ed9e(0x181),'foreignField':_0x39ed9e(0x112),'as':_0x39ed9e(0x12b)}},{'$unwind':_0x39ed9e(0x121)}]);if(_0x3f47ec[0x0][_0x39ed9e(0x101)]==_0x39ed9e(0x113))var _0x54861e=users['English'];else{if(_0x3f47ec[0x0][_0x39ed9e(0x101)]==_0x39ed9e(0x179))var _0x54861e=users[_0x39ed9e(0x179)];else{if(_0x3f47ec[0x0][_0x39ed9e(0x101)]==_0x39ed9e(0x18f))var _0x54861e=users['German'];else{if(_0x3f47ec[0x0][_0x39ed9e(0x101)]=='Spanish')var _0x54861e=users['Spanish'];else{if(_0x3f47ec[0x0][_0x39ed9e(0x101)]=='French')var _0x54861e=users[_0x39ed9e(0x18b)];else{if(_0x3f47ec[0x0]['language']==_0x39ed9e(0x126))var _0x54861e=users['Portuguese'];else{if(_0x3f47ec[0x0][_0x39ed9e(0x101)]==_0x39ed9e(0x12a))var _0x54861e=users[_0x39ed9e(0x12a)];else{if(_0x3f47ec[0x0][_0x39ed9e(0x101)]==_0x39ed9e(0x125))var _0x54861e=users[_0x39ed9e(0x18a)];}}}}}}}_0x35f49f[_0x39ed9e(0xf4)](_0x39ed9e(0x17c),{'success':_0x3818ec[_0x39ed9e(0x130)](_0x39ed9e(0x190)),'errors':_0x3818ec[_0x39ed9e(0x130)](_0x39ed9e(0xfb)),'master_shop':_0x3f47ec,'profile':_0x2a4e09,'role':_0xa0447a,'language':_0x54861e,'customer':_0x404594,'sales_sa':_0x415e2d,'approvers':_0x1b8105[0x0],'the_id':_0x59674b});}catch(_0x172382){console[_0x39ed9e(0x142)](_0x172382);}}),router['post']('/:id',auth,async(_0x1e8111,_0x4deeb8)=>{var _0x56b660=a0_0x20d6a6;try{const {date:_0x28b451,invoice_data:_0x531c23,wms_confirm:_0x5a52ca,the_id_val:_0x6d2289,prod_id:_0x1fb35a,SCRN:_0x31e824,ReqBy:_0x343148,dateofreq:_0x438f33,PO_number:_0x4dd043,warehouse_name:_0x4cc46a,typeservicesData:_0x10e73e,typevehicle:_0x44a387,destination:_0x4faac3,deliverydate:_0x164b50,driver:_0x2484e7,plate:_0x513f14,van:_0x3b3d9d,DRSI:_0x57f94b,TSU:_0x58daf4,TFU:_0x4153b8,note:_0x5da613}=_0x1e8111['body'],_0x2b548b=await sales_order[_0x56b660(0x171)](_0x6d2289);if(typeof _0x1fb35a==_0x56b660(0x13d))var _0x26c3a3=[_0x1e8111[_0x56b660(0x167)][_0x56b660(0xfc)]],_0x30ed5a=[_0x1e8111['body'][_0x56b660(0x186)]],_0x44a491=[_0x1e8111[_0x56b660(0x167)][_0x56b660(0x193)]];else var _0x26c3a3=[..._0x1e8111['body'][_0x56b660(0xfc)]],_0x30ed5a=[..._0x1e8111[_0x56b660(0x167)][_0x56b660(0x186)]],_0x44a491=[..._0x1e8111['body']['data_loc']];const _0x6cbe6=_0x26c3a3['map'](_0x15cb75=>{return _0x15cb75={'prod_id':_0x15cb75};});_0x44a491['forEach']((_0x60368,_0x2c7a05)=>{var _0x43b259=_0x56b660,_0x11fe58=_0x60368[_0x43b259(0x15e)]('~');_0x6cbe6[_0x2c7a05][_0x43b259(0x15f)]=_0x11fe58[0x0],_0x6cbe6[_0x2c7a05][_0x43b259(0x165)]=_0x11fe58[0x1];}),_0x30ed5a[_0x56b660(0x124)]((_0x3c77c6,_0x1a1b26)=>{var _0x84510b=_0x56b660;_0x6cbe6[_0x1a1b26][_0x84510b(0x16f)]=_0x3c77c6;});var _0x180b96=[],_0xd783b=[],_0x19817f=[],_0x3edec8=[],_0x1731ff=[],_0x4e63e5=[],_0x438051=[],_0x26a810=[],_0x95be9e=[],_0x49b08b=[],_0x5d49b2=[],_0x50bfb5=[],_0x2bb5ed=[],_0x3e42d6=[],_0x42327e=[],_0x106f0b=[],_0x248ef0=[],_0x49444a=[],_0x479b34=[],_0x3d885f=[];for(let _0x340f47=0x0;_0x340f47<=_0x6cbe6[_0x56b660(0x110)]-0x1;_0x340f47++){const _0x115f62=_0x6cbe6[_0x340f47],_0x2d55fb=mongoose[_0x56b660(0x169)][_0x56b660(0x172)];var _0x163b67=await warehouse[_0x56b660(0xf6)]([{'$match':{'_id':_0x2d55fb(_0x115f62[_0x56b660(0x15f)])}},{'$unwind':_0x56b660(0x14d)},{'$match':{'product_details._id':_0x2d55fb(_0x115f62[_0x56b660(0x165)])}}]),_0x31c43d=0x0;for(let _0x22ca99=0x0;_0x22ca99<=_0x163b67[_0x56b660(0x110)]-0x1;_0x22ca99++){var _0x5175e1=_0x163b67[_0x22ca99];_0x5175e1['product_details']['product_stock']<_0x115f62[_0x56b660(0x16f)]&&_0x31c43d++;}if(_0x31c43d>0x0)return _0x1e8111[_0x56b660(0x130)](_0x56b660(0xfb),_0x56b660(0x10c)),_0x4deeb8[_0x56b660(0x151)]('back');var _0x414c8e=0x0;for(let _0x37098b=0x0;_0x37098b<=_0x163b67['length']-0x1;_0x37098b++){var _0x5175e1=_0x163b67[_0x37098b];_0x5175e1[_0x56b660(0x188)][_0x56b660(0x117)]>_0x115f62[_0x56b660(0x16f)]&&(_0x180b96[_0x56b660(0xfa)](_0x5175e1['product_details'][_0x56b660(0x14c)]),_0xd783b[_0x56b660(0xfa)](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x117)]),_0x19817f[_0x56b660(0xfa)](_0x115f62['request_qty']),_0x3edec8[_0x56b660(0xfa)](_0x5175e1[_0x56b660(0x188)]['primary_code']),_0x1731ff['push'](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x16d)]),_0x4e63e5[_0x56b660(0xfa)](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x152)]),_0x438051[_0x56b660(0xfa)](_0x5175e1['product_details'][_0x56b660(0x12d)]),_0x26a810['push'](_0x5175e1['product_details'][_0x56b660(0x13b)]),_0x95be9e['push'](_0x5175e1[_0x56b660(0x188)]['unit']),_0x49b08b[_0x56b660(0xfa)](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x129)]),_0x5d49b2[_0x56b660(0xfa)](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x122)]),_0x50bfb5['push'](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x149)]),_0x2bb5ed[_0x56b660(0xfa)](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x12c)]),_0x3e42d6[_0x56b660(0xfa)](_0x5175e1[_0x56b660(0x188)]['maxPerUnit']),_0x42327e['push'](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x18e)]),_0x106f0b['push'](_0x5175e1[_0x56b660(0x17d)]),_0x248ef0[_0x56b660(0xfa)](_0x5175e1['product_details']['invoice']),_0x49444a['push'](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x112)]),_0x479b34['push'](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x106)]),_0x3d885f[_0x56b660(0xfa)](_0x5175e1[_0x56b660(0x188)][_0x56b660(0x107)]),_0x414c8e++);}}const _0x1cbff5=_0x180b96[_0x56b660(0x160)](_0x3c285d=>{return _0x3c285d={'product_name':_0x3c285d};});_0xd783b['forEach']((_0x2e18c8,_0x4c18c0)=>{var _0x3872af=_0x56b660;_0x1cbff5[_0x4c18c0][_0x3872af(0x13a)]=_0x2e18c8;}),_0x19817f[_0x56b660(0x124)]((_0x176bbf,_0x31ecc9)=>{var _0x6a5753=_0x56b660;_0x1cbff5[_0x31ecc9][_0x6a5753(0x15d)]=Math['abs'](_0x176bbf);}),_0x3d885f[_0x56b660(0x124)]((_0x552754,_0x10925f)=>{var _0x519723=_0x56b660;_0x1cbff5[_0x10925f][_0x519723(0x107)]=_0x552754;}),_0x479b34[_0x56b660(0x124)]((_0x4d3a9f,_0x49fe5e)=>{var _0x3c4743=_0x56b660;_0x1cbff5[_0x49fe5e][_0x3c4743(0x106)]=_0x4d3a9f;}),_0x49444a[_0x56b660(0x124)]((_0x500bb0,_0x28bfd9)=>{var _0x3f70f4=_0x56b660;_0x1cbff5[_0x28bfd9][_0x3f70f4(0x180)]=_0x500bb0;}),_0x3edec8['forEach']((_0x37b88b,_0x31723a)=>{_0x1cbff5[_0x31723a]['primary_code']=_0x37b88b;}),_0x1731ff[_0x56b660(0x124)]((_0x1d8d4e,_0x5655ba)=>{_0x1cbff5[_0x5655ba]['secondary_code']=_0x1d8d4e;}),_0x4e63e5['forEach']((_0x3281ed,_0x458337)=>{var _0x56542b=_0x56b660;_0x1cbff5[_0x458337][_0x56542b(0x152)]=_0x3281ed;}),_0x438051['forEach']((_0x51b9cd,_0x8a28bf)=>{_0x1cbff5[_0x8a28bf]['level']=_0x51b9cd;}),_0x26a810[_0x56b660(0x124)]((_0x124dea,_0x14e07d)=>{_0x1cbff5[_0x14e07d]['bay']=_0x124dea;}),_0x95be9e[_0x56b660(0x124)]((_0x95cb05,_0x47c3f7)=>{var _0x499ad6=_0x56b660;_0x1cbff5[_0x47c3f7][_0x499ad6(0x159)]=_0x95cb05;}),_0x49b08b[_0x56b660(0x124)]((_0x5e081c,_0xedf213)=>{_0x1cbff5[_0xedf213]['secondary_unit']=_0x5e081c;}),_0x5d49b2['forEach']((_0x19abe5,_0x4c7008)=>{var _0x41f12f=_0x56b660;_0x1cbff5[_0x4c7008][_0x41f12f(0x122)]=_0x19abe5;}),_0x50bfb5[_0x56b660(0x124)]((_0x975051,_0x2603d7)=>{_0x1cbff5[_0x2603d7]['expiry_date']=_0x975051;}),_0x2bb5ed['forEach']((_0x51dcd5,_0x17f3de)=>{var _0x444fd3=_0x56b660;_0x1cbff5[_0x17f3de][_0x444fd3(0x12c)]=_0x51dcd5;}),_0x3e42d6['forEach']((_0x3cdd12,_0x4d1cae)=>{var _0x33a323=_0x56b660;_0x1cbff5[_0x4d1cae][_0x33a323(0x18c)]=_0x3cdd12;}),_0x42327e[_0x56b660(0x124)]((_0x13e1a2,_0xdc924e)=>{var _0x26d337=_0x56b660;_0x1cbff5[_0xdc924e][_0x26d337(0x154)]=_0x13e1a2;}),_0x106f0b[_0x56b660(0x124)]((_0x58f947,_0x2343c8)=>{var _0x55a2e8=_0x56b660;_0x1cbff5[_0x2343c8][_0x55a2e8(0x123)]=_0x58f947;}),_0x248ef0[_0x56b660(0x124)]((_0x18883b,_0x10f9bc)=>{_0x1cbff5[_0x10f9bc]['invoice']=_0x18883b,_0x1cbff5[_0x10f9bc]['date_data']=_0x28b451;});const _0xdc52ad=new invoice_for_outgoing();await _0xdc52ad['save'](),_0x248ef0[_0x56b660(0x124)]((_0x4e6a70,_0x5756fc)=>{var _0x2db1ed=_0x56b660;_0x1cbff5[_0x5756fc][_0x2db1ed(0x150)]=_0x2db1ed(0x156)+_0xdc52ad[_0x2db1ed(0x161)][_0x2db1ed(0x10a)]()[_0x2db1ed(0x13f)](0x8,'0');});const _0x4945c2=_0x1cbff5[_0x56b660(0x16c)](_0x165904=>_0x165904[_0x56b660(0x15d)]!=='0'&&_0x165904[_0x56b660(0x15d)]!==''),_0x27fb5d=new sales_finished({'invoice':_0x56b660(0x156)+_0xdc52ad[_0x56b660(0x161)][_0x56b660(0x10a)]()[_0x56b660(0x13f)](0x8,'0'),'date':_0x28b451,'warehouse_name':_0x4cc46a,'sale_product':_0x4945c2,'note':_0x5da613,'SCRN':_0x31e824,'finalize':_0x56b660(0x143),'ReqBy':_0x343148,'dateofreq':_0x438f33,'PO_number':_0x4dd043,'typeservicesData':_0x10e73e,'typevehicle':_0x44a387,'destination':_0x4faac3,'deliverydate':_0x164b50,'driver':_0x2484e7,'plate':_0x513f14,'van':_0x3b3d9d,'DRSI':_0x57f94b,'TSU':_0x58daf4,'TFU':_0x4153b8}),_0xe1399f=await _0x27fb5d['save'](),_0xc3af2b=new Date(),_0x355bbf=_0xc3af2b[_0x56b660(0x155)]();_0x2b548b[_0x56b660(0x11a)]=_0x5a52ca,_0x2b548b[_0x56b660(0x164)]=_0x355bbf,_0x2b548b['document_number_out']=_0x56b660(0x156)+_0xdc52ad[_0x56b660(0x161)][_0x56b660(0x10a)]()['padStart'](0x8,'0'),_0x2b548b[_0x56b660(0x111)]=_0xe1399f[_0x56b660(0x112)],await _0x2b548b[_0x56b660(0x13c)]();const _0x56674a=await master_shop['find'](),_0x9d3a05=await email_settings[_0x56b660(0x14a)]();let _0x96986f=nodemailer['createTransport']({'host':_0x9d3a05[_0x56b660(0x11f)],'port':Number(_0x9d3a05[_0x56b660(0x120)]),'secure':![],'auth':{'user':_0x9d3a05[_0x56b660(0x17e)],'pass':_0x9d3a05[_0x56b660(0x184)]}});const _0x50fc29=_0x1e8111[_0x56b660(0x14f)]+_0x56b660(0x192)+_0x1e8111[_0x56b660(0x11e)][_0x56b660(0x11f)];var _0x122874=_0x2b548b[_0x56b660(0x132)],_0x32f580='',_0x11b977,_0xa88f90=0x0;for(_0x11b977 in _0x122874){_0x32f580+=_0x56b660(0x131)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x122874[_0x11b977][_0x56b660(0x14c)]+_0x56b660(0x10d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x122874[_0x11b977][_0x56b660(0x152)]+'</td>'+_0x56b660(0x16a)+_0x122874[_0x11b977][_0x56b660(0x15d)]+_0x56b660(0x10d)+_0x56b660(0x16a)+_0x122874[_0x11b977][_0x56b660(0x159)]+_0x56b660(0x10d)+_0x56b660(0x176),_0xa88f90+=parseInt(_0x122874[_0x11b977]['quantity']);}let _0x20f24e={'from':_0x9d3a05[_0x56b660(0x17e)],'to':_0x56b660(0x177),'subject':'Email\x20for\x20Customer','attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x56b660(0x128)+_0x56674a[0x0]['image'],'cid':_0x56b660(0x116)}],'html':_0x56b660(0x16b)+_0x56b660(0x195)+'<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>'+_0x56b660(0x102)+_0x56b660(0x153)+_0x56b660(0x11b)+'<div>'+_0x56b660(0x140)+_0x56b660(0x14e)+'<div>'+_0x56b660(0x187)+_0x56b660(0x14e)+'</div>'+_0x56b660(0x191)+'<div>'+_0x56b660(0x14e)+'<div>'+_0x56b660(0x10e)+_0x56b660(0x14e)+'<div>'+_0x56b660(0x119)+_0x2b548b[_0x56b660(0x118)]+_0x56b660(0x16e)+'<span>\x20Request\x20Date:\x20<b>'+_0x2b548b[_0x56b660(0xf9)]+_0x56b660(0x17f)+_0x56b660(0x14e)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x56b660(0x175)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x56b660(0xf8)+_0x56b660(0x176)+_0x56b660(0x103)+_0x56b660(0x15b)+'\x20'+_0x32f580+'\x20'+_0x56b660(0x11c)+'</table>'+_0x56b660(0x153)+_0x56b660(0x10b)+_0x56b660(0x100)+_0x56b660(0xf7)+_0x56b660(0x14e)+'<div>'+_0x56b660(0x104)+_0x56b660(0xfe)+_0x56b660(0x14e)+_0x56b660(0x14e)+_0x56b660(0x182)+_0x56b660(0x185)};_0x96986f[_0x56b660(0x138)](_0x20f24e,function(_0x340a3c,_0x5811cb){var _0x534909=_0x56b660;_0x340a3c?(console[_0x534909(0x142)](_0x340a3c),console[_0x534909(0x142)](_0x534909(0x168))):console[_0x534909(0x142)](_0x534909(0x115));}),_0x1e8111[_0x56b660(0x130)](_0x56b660(0x190),_0x56b660(0x137)),_0x4deeb8[_0x56b660(0x151)](_0x56b660(0x17a)+_0xe1399f['_id']),_0x4deeb8[_0x56b660(0x133)](_0x4945c2);return;}catch(_0x43c7fb){}}),router[a0_0x20d6a6(0x139)](a0_0x20d6a6(0x173),auth,async(_0x366032,_0xf999dc)=>{var _0x19702a=a0_0x20d6a6;try{const _0x3c1c73=await master_shop[_0x19702a(0x166)](),_0x296cce=_0x366032[_0x19702a(0x109)],_0x1e5c0f=await profile[_0x19702a(0x14a)]({'email':_0x296cce[_0x19702a(0x17e)]}),_0x532595=await staff[_0x19702a(0x14a)]({'email':_0x296cce[_0x19702a(0x17e)]}),_0x455432=await customer[_0x19702a(0x166)]({'agent_id':_0x532595[_0x19702a(0x112)]}),_0x104ea3=mongoose[_0x19702a(0x169)][_0x19702a(0x172)],_0x51d9dd=_0x366032[_0x19702a(0xff)]['id'],_0x6b307=await sales_order['findById'](_0x51d9dd),_0xebb0c2=await sales_order[_0x19702a(0xf6)]([{'$match':{'_id':_0x104ea3(_0x51d9dd)}},{'$addFields':{'accounting_account_id':{'$toObjectId':'$accounting_account_id'}}},{'$addFields':{'wms_account_id':{'$toObjectId':_0x19702a(0x11d)}}},{'$lookup':{'from':_0x19702a(0xfd),'localField':_0x19702a(0x189),'foreignField':'_id','as':'account_data'}},{'$unwind':_0x19702a(0x114)},{'$lookup':{'from':'staffs','localField':_0x19702a(0x181),'foreignField':_0x19702a(0x112),'as':'wms_data'}},{'$unwind':_0x19702a(0x121)}]);if(_0x3c1c73[0x0][_0x19702a(0x101)]=='English\x20(US)')var _0x4cf88a=users[_0x19702a(0x145)];else{if(_0x3c1c73[0x0][_0x19702a(0x101)]==_0x19702a(0x179))var _0x4cf88a=users[_0x19702a(0x179)];else{if(_0x3c1c73[0x0][_0x19702a(0x101)]==_0x19702a(0x18f))var _0x4cf88a=users[_0x19702a(0x18f)];else{if(_0x3c1c73[0x0][_0x19702a(0x101)]==_0x19702a(0x15c))var _0x4cf88a=users['Spanish'];else{if(_0x3c1c73[0x0]['language']==_0x19702a(0x18b))var _0x4cf88a=users[_0x19702a(0x18b)];else{if(_0x3c1c73[0x0]['language']==_0x19702a(0x126))var _0x4cf88a=users[_0x19702a(0x127)];else{if(_0x3c1c73[0x0][_0x19702a(0x101)]==_0x19702a(0x12a))var _0x4cf88a=users[_0x19702a(0x12a)];else{if(_0x3c1c73[0x0][_0x19702a(0x101)]==_0x19702a(0x125))var _0x4cf88a=users['Arabic'];}}}}}}}_0xf999dc[_0x19702a(0xf4)](_0x19702a(0xf5),{'success':_0x366032['flash'](_0x19702a(0x190)),'errors':_0x366032[_0x19702a(0x130)](_0x19702a(0xfb)),'master_shop':_0x3c1c73,'profile':_0x1e5c0f,'role':_0x296cce,'language':_0x4cf88a,'customer':_0x455432,'sales_sa':_0x6b307,'approvers':_0xebb0c2[0x0],'the_id':_0x51d9dd});}catch(_0x3c7b02){console[_0x19702a(0x142)](_0x3c7b02);}}),router[a0_0x20d6a6(0x136)](a0_0x20d6a6(0x163),auth,async(_0x1e189d,_0x2bf1e8)=>{var _0x351f8e=a0_0x20d6a6;try{const {warehouse_name:_0x3b7167,product_code:_0x1bcc54}=_0x1e189d[_0x351f8e(0x167)],_0x5ca5d2=await warehouse['aggregate']([{'$match':{'name':_0x3b7167}},{'$unwind':_0x351f8e(0x14d)},{'$match':{'product_details.product_code':_0x1bcc54}},{'$group':{'_id':{'room':_0x351f8e(0x144),'_id':_0x351f8e(0x170)}}}]);_0x2bf1e8['json'](_0x5ca5d2);}catch(_0x18f89){}}),router['post']('/data/data_loc',auth,async(_0x1449c1,_0x491e8f)=>{var _0x121d6f=a0_0x20d6a6;try{const {warehouse_name:_0x70ad3f,product_code:_0x9eb8ca,room_name:_0x5c06d4}=_0x1449c1['body'];console[_0x121d6f(0x142)](_0x1449c1[_0x121d6f(0x167)]);const _0x15052a=await warehouse[_0x121d6f(0xf6)]([{'$match':{'name':_0x70ad3f,'room':_0x5c06d4}},{'$unwind':_0x121d6f(0x14d)},{'$match':{'product_details.product_code':_0x9eb8ca}},{'$group':{'_id':{'main_id':_0x121d6f(0x170),'detl_id':_0x121d6f(0x10f),'product_name':'$product_details.product_name','product_code':_0x121d6f(0x183),'level':_0x121d6f(0x105),'bay':'$product_details.bay','stocks':_0x121d6f(0x14b)}}}]);_0x491e8f[_0x121d6f(0x133)](_0x15052a);}catch(_0x5e675e){}}),router[a0_0x20d6a6(0x139)](a0_0x20d6a6(0x147),auth,async(_0xaf0654,_0x5d5f54)=>{var _0x630391=a0_0x20d6a6;try{const {sttaff_id:_0xb1e9f4,email:_0x35fcc8,warehouse:_0x256264}=_0xaf0654['user'],_0x43e0be=await master_shop[_0x630391(0x166)](),_0x27978f=_0xaf0654['user'],_0x1a2a2c=await profile[_0x630391(0x14a)]({'email':_0x27978f[_0x630391(0x17e)]}),_0x4f1541=await sales_order[_0x630391(0x166)]({'wms_account_id':_0xb1e9f4});if(_0x43e0be[0x0][_0x630391(0x101)]=='English\x20(US)')var _0x28501d=users[_0x630391(0x145)];else{if(_0x43e0be[0x0][_0x630391(0x101)]==_0x630391(0x179))var _0x28501d=users[_0x630391(0x179)];else{if(_0x43e0be[0x0][_0x630391(0x101)]=='German')var _0x28501d=users['German'];else{if(_0x43e0be[0x0]['language']==_0x630391(0x15c))var _0x28501d=users[_0x630391(0x15c)];else{if(_0x43e0be[0x0][_0x630391(0x101)]==_0x630391(0x18b))var _0x28501d=users[_0x630391(0x18b)];else{if(_0x43e0be[0x0][_0x630391(0x101)]=='Portuguese\x20(BR)')var _0x28501d=users[_0x630391(0x127)];else{if(_0x43e0be[0x0][_0x630391(0x101)]==_0x630391(0x12a))var _0x28501d=users[_0x630391(0x12a)];else{if(_0x43e0be[0x0][_0x630391(0x101)]==_0x630391(0x125))var _0x28501d=users[_0x630391(0x18a)];}}}}}}}_0x5d5f54[_0x630391(0xf4)](_0x630391(0x17b),{'success':_0xaf0654[_0x630391(0x130)]('success'),'errors':_0xaf0654['flash'](_0x630391(0xfb)),'master_shop':_0x43e0be,'profile':_0x1a2a2c,'role':_0x27978f,'language':_0x28501d,'sales_order':_0x4f1541});}catch(_0x11790a){}}),module[a0_0x20d6a6(0x108)]=router;