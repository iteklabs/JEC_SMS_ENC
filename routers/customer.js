function a0_0x529b(){const _0x38cf33=['132aMFUPh','public/Migration/','customer','Content-Type','element','/products_export_migrate_file','French','../public/language/languages.json','Chinese','forEach','$amount','9PuDMfi','payment_data','express','exports','findById','send','c_payments','filename','mobile','address','addWorksheet','then','German','payable','SalesmanName','attachment;\x20filename=customer_Migration_File.xlsx','/customer_import_migrate_file','single','4882800ReBVUa','body','customer_product_fule','Sheets','860709vSrDSB','landline','\x20added\x20successfully','sale','redirect','../models/all_models','Spanish','xlsx','master','amount','find','Content-Disposition','message','email','PBrands','errors','Arabic\x20(ae)','244060XsOyvv','columns','Customers','render','now','Workbook','PUnits','save','user','SalesmanCode','Hindi','Portuguese','customer\x20update\x20successfully','SheetNames','$reason','English\x20(US)','331410yTSEwM','/customer/view','English','390YTefwF','status','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','sale_return','/view','post','sheet_to_json','log','params','receivable','contactperson','get','Sale','2714778uYGaAU','name','aggregate','error','Name','/view/payment/:id','language','json','flash','Portuguese\x20(BR)','/view/:id','public/Migration','success','findOne','setHeader','\x20Failed','multer','payable_sum','3vtYQZc','Arabic','../middleware/auth','13204ffsZJf','1909761wGVqHZ'];a0_0x529b=function(){return _0x38cf33;};return a0_0x529b();}const a0_0x31f3b9=a0_0x58b3;function a0_0x58b3(_0x36d5c1,_0x149512){const _0x529bf3=a0_0x529b();return a0_0x58b3=function(_0x58b369,_0x54adfc){_0x58b369=_0x58b369-0x121;let _0x224747=_0x529bf3[_0x58b369];return _0x224747;},a0_0x58b3(_0x36d5c1,_0x149512);}(function(_0x3209dd,_0xcc9130){const _0x29ac0d=a0_0x58b3,_0x348a59=_0x3209dd();while(!![]){try{const _0x3a2080=parseInt(_0x29ac0d(0x17d))/0x1*(parseInt(_0x29ac0d(0x15b))/0x2)+-parseInt(_0x29ac0d(0x13a))/0x3+-parseInt(_0x29ac0d(0x180))/0x4*(-parseInt(_0x29ac0d(0x15e))/0x5)+parseInt(_0x29ac0d(0x16b))/0x6+-parseInt(_0x29ac0d(0x181))/0x7+parseInt(_0x29ac0d(0x136))/0x8*(-parseInt(_0x29ac0d(0x124))/0x9)+parseInt(_0x29ac0d(0x14b))/0xa*(parseInt(_0x29ac0d(0x182))/0xb);if(_0x3a2080===_0xcc9130)break;else _0x348a59['push'](_0x348a59['shift']());}catch(_0x3e0384){_0x348a59['push'](_0x348a59['shift']());}}}(a0_0x529b,0x5087c));const express=require(a0_0x31f3b9(0x126)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x31f3b9(0x13f)),auth=require(a0_0x31f3b9(0x17f)),users=require(a0_0x31f3b9(0x189)),excelJS=require('exceljs'),xlsx=require(a0_0x31f3b9(0x141)),multer=require(a0_0x31f3b9(0x17b));router['get'](a0_0x31f3b9(0x162),auth,async(_0x21954e,_0x528a2e)=>{const _0x45cee9=a0_0x31f3b9;try{const {username:_0x49b3ff,email:_0x594a0f,role:_0x78d3bd}=_0x21954e['user'],_0x44e10a=_0x21954e[_0x45cee9(0x153)],_0x357be5=await profile[_0x45cee9(0x178)]({'email':_0x44e10a[_0x45cee9(0x147)]}),_0x32a33f=await master_shop[_0x45cee9(0x144)]();console[_0x45cee9(0x165)](_0x45cee9(0x142),_0x32a33f);const _0x3bdb79=await customer[_0x45cee9(0x144)](),_0x42a132=await customer['aggregate']([{'$lookup':{'from':_0x45cee9(0x12a),'localField':_0x45cee9(0x16c),'foreignField':_0x45cee9(0x184),'as':'customer_docs'}}]);console[_0x45cee9(0x165)](_0x42a132);const _0x30e337=_0x42a132['map'](_0x1e04ad=>{const _0x220979=_0x45cee9;console[_0x220979(0x165)]('data',_0x1e04ad);var _0x4fa877=0x0,_0x203c4e=0x0;return _0x1e04ad['customer_docs'][_0x220979(0x122)](_0xe7d9dd=>{const _0x4b41ab=_0x220979;console[_0x4b41ab(0x165)](_0x4b41ab(0x186),_0xe7d9dd),_0xe7d9dd['reason']==_0x4b41ab(0x16a)?_0x4fa877+=_0xe7d9dd['amount']:_0x203c4e+=_0xe7d9dd[_0x4b41ab(0x143)];}),_0x1e04ad[_0x220979(0x13d)]=parseFloat(_0x4fa877)+0x0,_0x1e04ad[_0x220979(0x161)]=parseFloat(_0x203c4e)+0x0,_0x1e04ad;});console[_0x45cee9(0x165)](_0x45cee9(0x125),_0x30e337);if(_0x32a33f[0x0][_0x45cee9(0x171)]=='English\x20(US)'){var _0x3f5208=users['English'];console['log'](_0x3f5208);}else{if(_0x32a33f[0x0]['language']=='Hindi')var _0x3f5208=users['Hindi'];else{if(_0x32a33f[0x0][_0x45cee9(0x171)]==_0x45cee9(0x130))var _0x3f5208=users[_0x45cee9(0x130)];else{if(_0x32a33f[0x0][_0x45cee9(0x171)]=='Spanish')var _0x3f5208=users[_0x45cee9(0x140)];else{if(_0x32a33f[0x0]['language']==_0x45cee9(0x188))var _0x3f5208=users['French'];else{if(_0x32a33f[0x0][_0x45cee9(0x171)]==_0x45cee9(0x174))var _0x3f5208=users[_0x45cee9(0x156)];else{if(_0x32a33f[0x0]['language']==_0x45cee9(0x121))var _0x3f5208=users[_0x45cee9(0x121)];else{if(_0x32a33f[0x0]['language']==_0x45cee9(0x14a))var _0x3f5208=users['Arabic'];}}}}}}}_0x528a2e[_0x45cee9(0x14e)]('customer',{'success':_0x21954e[_0x45cee9(0x173)](_0x45cee9(0x177)),'errors':_0x21954e['flash']('errors'),'user':_0x3bdb79,'role':_0x44e10a,'profile':_0x357be5,'payment':_0x30e337,'master_shop':_0x32a33f,'language':_0x3f5208});}catch(_0x3ab34b){console[_0x45cee9(0x165)](_0x3ab34b);}}),router[a0_0x31f3b9(0x163)](a0_0x31f3b9(0x162),auth,async(_0x31e92e,_0x203ccf)=>{const _0x3790db=a0_0x31f3b9;try{const {name:_0x202c17,address:_0x539777,mobile:_0x12d246,email:_0x1a31b5,receivable:_0x39dffd,payable:_0x355587,contactperson:_0x1a466f,landline:_0xa6a39e}=_0x31e92e[_0x3790db(0x137)],_0x35750a=new customer({'name':_0x202c17,'address':_0x539777,'mobile':_0x12d246,'email':_0x1a31b5,'receivable':_0x39dffd,'payable':_0x355587,'contactperson':_0x1a466f,'landline':_0xa6a39e}),_0x75a24a=await _0x35750a[_0x3790db(0x152)]();_0x31e92e['flash'](_0x3790db(0x177),'customer\x20add\x20successfully'),_0x203ccf[_0x3790db(0x13e)](_0x3790db(0x15c));}catch(_0x47b9ad){console[_0x3790db(0x165)](_0x47b9ad);}}),router[a0_0x31f3b9(0x169)](a0_0x31f3b9(0x175),auth,async(_0x177cae,_0x4e892a)=>{const _0x282792=a0_0x31f3b9;try{const {username:_0x3e5c60,email:_0x1724b2,role:_0x1dcabd}=_0x177cae['user'],_0x18ebea=_0x177cae[_0x282792(0x153)],_0x591875=await profile[_0x282792(0x178)]({'email':_0x18ebea['email']}),_0x5ad210=await master_shop[_0x282792(0x144)]();console['log'](_0x282792(0x142),_0x5ad210);const _0x2b3d0f=_0x177cae[_0x282792(0x166)]['id'],_0xe41d6=await customer[_0x282792(0x128)](_0x2b3d0f);if(_0x5ad210[0x0][_0x282792(0x171)]=='English\x20(US)'){var _0x5cfd51=users[_0x282792(0x15d)];console['log'](_0x5cfd51);}else{if(_0x5ad210[0x0][_0x282792(0x171)]=='Hindi')var _0x5cfd51=users[_0x282792(0x155)];else{if(_0x5ad210[0x0][_0x282792(0x171)]==_0x282792(0x130))var _0x5cfd51=users[_0x282792(0x130)];else{if(_0x5ad210[0x0][_0x282792(0x171)]==_0x282792(0x140))var _0x5cfd51=users[_0x282792(0x140)];else{if(_0x5ad210[0x0][_0x282792(0x171)]==_0x282792(0x188))var _0x5cfd51=users[_0x282792(0x188)];else{if(_0x5ad210[0x0][_0x282792(0x171)]=='Portuguese\x20(BR)')var _0x5cfd51=users[_0x282792(0x156)];else{if(_0x5ad210[0x0][_0x282792(0x171)]=='Chinese')var _0x5cfd51=users[_0x282792(0x121)];else{if(_0x5ad210[0x0][_0x282792(0x171)]==_0x282792(0x14a))var _0x5cfd51=users[_0x282792(0x17e)];}}}}}}}_0x4e892a['render'](_0x282792(0x184),{'success':_0x177cae['flash'](_0x282792(0x177)),'errors':_0x177cae['flash'](_0x282792(0x149)),'role':_0x18ebea,'profile':_0x591875,'user':_0xe41d6,'master_shop':_0x5ad210,'language':_0x5cfd51});}catch(_0x31f92b){console[_0x282792(0x165)](_0x31f92b);}}),router[a0_0x31f3b9(0x163)](a0_0x31f3b9(0x175),auth,async(_0x5ef5f7,_0x26b2b1)=>{const _0x3c51b2=a0_0x31f3b9;try{const _0x4fc855=_0x5ef5f7[_0x3c51b2(0x166)]['id'],_0xe2fe07=await customer[_0x3c51b2(0x128)](_0x4fc855),{name:_0x53a22d,address:_0x2e8081,mobile:_0x5de816,email:_0x150e61,receivable:_0x20b43f,payable:_0x59a07e,contactperson:_0x5910d8,landline:_0x195b18}=_0x5ef5f7[_0x3c51b2(0x137)];_0xe2fe07[_0x3c51b2(0x16c)]=_0x53a22d,_0xe2fe07[_0x3c51b2(0x12d)]=_0x2e8081,_0xe2fe07['mobile']=_0x5de816,_0xe2fe07[_0x3c51b2(0x147)]=_0x150e61,_0xe2fe07[_0x3c51b2(0x167)]=_0x20b43f,_0xe2fe07[_0x3c51b2(0x131)]=_0x59a07e,_0xe2fe07[_0x3c51b2(0x168)]=_0x5910d8,_0xe2fe07[_0x3c51b2(0x13b)]=_0x195b18;const _0x4f4e2a=await _0xe2fe07['save']();_0x5ef5f7[_0x3c51b2(0x173)](_0x3c51b2(0x177),_0x3c51b2(0x157)),_0x26b2b1[_0x3c51b2(0x13e)](_0x3c51b2(0x15c));}catch(_0x2d7260){console[_0x3c51b2(0x165)](_0x2d7260);}}),router[a0_0x31f3b9(0x169)](a0_0x31f3b9(0x170),auth,async(_0xf65785,_0x35eb7b)=>{const _0x2412e1=a0_0x31f3b9;try{const {username:_0x1a5a21,email:_0x3cccf4,role:_0x300f56}=_0xf65785[_0x2412e1(0x153)],_0x2bfd62=_0xf65785['user'],_0xda4323=await profile[_0x2412e1(0x178)]({'email':_0x2bfd62['email']}),_0x29b230=await master_shop[_0x2412e1(0x144)]();console[_0x2412e1(0x165)]('master',_0x29b230),console[_0x2412e1(0x165)](_0xf65785[_0x2412e1(0x166)]['id']);const _0x47d1ab=await customer['findOne']({'_id':_0xf65785['params']['id']});console[_0x2412e1(0x165)]('customer_data',_0x47d1ab);const _0x4fa02c=await c_payment_data['find']({'customer':_0x47d1ab[_0x2412e1(0x16c)]});console[_0x2412e1(0x165)](_0x4fa02c);const _0x2e2d6c=await c_payment_data['aggregate']([{'$match':{'customer':_0x47d1ab[_0x2412e1(0x16c)]}},{'$match':{'reason':_0x2412e1(0x16a)}},{'$group':{'_id':_0x2412e1(0x159),'sum':{'$sum':_0x2412e1(0x123)}}}]);console['log'](_0x2412e1(0x17c),_0x2e2d6c);const _0x596a21=await c_payment_data[_0x2412e1(0x16d)]([{'$match':{'customer':_0x47d1ab[_0x2412e1(0x16c)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x2412e1(0x123)}}}]);console[_0x2412e1(0x165)]('receivable_sum',_0x596a21);if(_0x29b230[0x0][_0x2412e1(0x171)]==_0x2412e1(0x15a)){var _0x5672a8=users[_0x2412e1(0x15d)];console['log'](_0x5672a8);}else{if(_0x29b230[0x0][_0x2412e1(0x171)]==_0x2412e1(0x155))var _0x5672a8=users[_0x2412e1(0x155)];else{if(_0x29b230[0x0][_0x2412e1(0x171)]==_0x2412e1(0x130))var _0x5672a8=users[_0x2412e1(0x130)];else{if(_0x29b230[0x0][_0x2412e1(0x171)]=='Spanish')var _0x5672a8=users[_0x2412e1(0x140)];else{if(_0x29b230[0x0][_0x2412e1(0x171)]==_0x2412e1(0x188))var _0x5672a8=users[_0x2412e1(0x188)];else{if(_0x29b230[0x0]['language']==_0x2412e1(0x174))var _0x5672a8=users[_0x2412e1(0x156)];else{if(_0x29b230[0x0]['language']==_0x2412e1(0x121))var _0x5672a8=users[_0x2412e1(0x121)];else{if(_0x29b230[0x0]['language']==_0x2412e1(0x14a))var _0x5672a8=users[_0x2412e1(0x17e)];}}}}}}}_0x35eb7b[_0x2412e1(0x14e)]('customer_payment',{'success':_0xf65785[_0x2412e1(0x173)](_0x2412e1(0x177)),'errors':_0xf65785[_0x2412e1(0x173)](_0x2412e1(0x149)),'role':_0x2bfd62,'profile':_0xda4323,'payment':_0x4fa02c,'payable':_0x2e2d6c,'receivable':_0x596a21,'master_shop':_0x29b230,'language':_0x5672a8});}catch(_0x2ab440){console[_0x2412e1(0x165)](_0x2ab440);}}),router[a0_0x31f3b9(0x169)](a0_0x31f3b9(0x187),auth,async(_0x704a07,_0x155c6b)=>{const _0x29752d=a0_0x31f3b9;try{const _0x57fc0b=new excelJS[(_0x29752d(0x150))](),_0x19c68a=_0x57fc0b[_0x29752d(0x12e)](_0x29752d(0x14d));return _0x19c68a[_0x29752d(0x14c)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x29752d(0x16f),'key':_0x29752d(0x148),'width':0xa},{'header':_0x29752d(0x154),'key':_0x29752d(0x151),'width':0xa},{'header':'SalesmanName','key':_0x29752d(0x132),'width':0xa},{'header':_0x29752d(0x12d),'key':_0x29752d(0x12d),'width':0xa},{'header':_0x29752d(0x12c),'key':_0x29752d(0x12c),'width':0xa},{'header':_0x29752d(0x147),'key':_0x29752d(0x147),'width':0xa}],_0x155c6b[_0x29752d(0x179)](_0x29752d(0x185),_0x29752d(0x160)),_0x155c6b['setHeader'](_0x29752d(0x145),_0x29752d(0x133)),_0x57fc0b[_0x29752d(0x141)]['write'](_0x155c6b)[_0x29752d(0x12f)](()=>{const _0x1eb564=_0x29752d;_0x155c6b[_0x1eb564(0x15f)](0xc8);});}catch(_0x371b94){_0x155c6b[_0x29752d(0x15f)](0x190)[_0x29752d(0x129)]({'errors':_0x371b94['message']});}});const storage1=multer['diskStorage']({'destination':(_0x5ee189,_0x5ae749,_0xba6793)=>{const _0x5b22cf=a0_0x31f3b9;_0xba6793(null,_0x5b22cf(0x176));},'filename':(_0xfed12b,_0x2d00a3,_0x54b3d0)=>{const _0x29882b=a0_0x31f3b9;_0x54b3d0(null,Date[_0x29882b(0x14f)]()+_0x2d00a3['originalname']);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x31f3b9(0x134),auth,uploadMigrate[a0_0x31f3b9(0x135)](a0_0x31f3b9(0x138)),async(_0x10a853,_0x1be48e)=>{const _0x467d14=a0_0x31f3b9,_0x2969d1=_0x10a853['file'][_0x467d14(0x12b)],_0x1f3c17=await xlsx['readFile'](_0x467d14(0x183)+_0x2969d1);let _0x162ce1=_0x1f3c17[_0x467d14(0x158)],_0x3e7abe=xlsx['utils'][_0x467d14(0x164)](_0x1f3c17[_0x467d14(0x139)][_0x162ce1[0x0]]);for(const _0x272843 of _0x3e7abe){const _0x1c88e1=_0x272843['ID'],_0x87cf96=_0x272843[_0x467d14(0x16f)],_0xd999d2=_0x272843['SalesmanCode'],_0x5743f6=_0x272843[_0x467d14(0x132)],_0x2a6dca=_0x272843[_0x467d14(0x12d)],_0x40a180=_0x272843[_0x467d14(0x12c)],_0x25c0a9=_0x272843[_0x467d14(0x147)];try{let _0x3dc569=await customer[_0x467d14(0x178)]({'name':_0x87cf96});if(!_0x3dc569){const _0xc4a18d=new customer({'name':_0x87cf96,'ID':_0x1c88e1,'SalesmanCode':_0xd999d2,'SalesmanName':_0x5743f6,'address':_0x2a6dca,'mobile':_0x40a180,'email':_0x25c0a9});_0x3dc569=await _0xc4a18d[_0x467d14(0x152)](),_0x10a853[_0x467d14(0x173)]('success',_0x87cf96+_0x467d14(0x13c));}else _0x10a853['flash'](_0x467d14(0x16e),_0x87cf96+_0x467d14(0x17a));}catch(_0x4cd3f5){_0x1be48e[_0x467d14(0x15f)](0x1f4)[_0x467d14(0x172)]({'proderror':_0x4cd3f5[_0x467d14(0x146)],'aproduct':ProductName});}}_0x1be48e[_0x467d14(0x13e)](_0x467d14(0x15c));}),module[a0_0x31f3b9(0x127)]=router;