const a0_0x15270b=a0_0x393b;function a0_0x393b(_0x55c823,_0xbef483){const _0x19a165=a0_0x19a1();return a0_0x393b=function(_0x393bb1,_0x34ceea){_0x393bb1=_0x393bb1-0x169;let _0x5232b9=_0x19a165[_0x393bb1];return _0x5232b9;},a0_0x393b(_0x55c823,_0xbef483);}(function(_0x42a9d3,_0x767d6d){const _0x19075f=a0_0x393b,_0x12f1e3=_0x42a9d3();while(!![]){try{const _0x481ab0=parseInt(_0x19075f(0x1c8))/0x1*(parseInt(_0x19075f(0x188))/0x2)+parseInt(_0x19075f(0x17c))/0x3+-parseInt(_0x19075f(0x19d))/0x4+-parseInt(_0x19075f(0x173))/0x5+-parseInt(_0x19075f(0x16d))/0x6*(parseInt(_0x19075f(0x174))/0x7)+parseInt(_0x19075f(0x1cc))/0x8+-parseInt(_0x19075f(0x19e))/0x9*(parseInt(_0x19075f(0x16a))/0xa);if(_0x481ab0===_0x767d6d)break;else _0x12f1e3['push'](_0x12f1e3['shift']());}catch(_0x346be6){_0x12f1e3['push'](_0x12f1e3['shift']());}}}(a0_0x19a1,0xd8ca3));const express=require(a0_0x15270b(0x1c9)),app=express(),router=express[a0_0x15270b(0x1a3)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x15270b(0x16b)),auth=require(a0_0x15270b(0x189)),users=require(a0_0x15270b(0x18b)),excelJS=require(a0_0x15270b(0x1a9)),xlsx=require(a0_0x15270b(0x1a6)),multer=require(a0_0x15270b(0x178));router[a0_0x15270b(0x17e)](a0_0x15270b(0x179),auth,async(_0x33d98e,_0x57d1b2)=>{const _0x25c8ad=a0_0x15270b;try{const {username:_0x293082,email:_0x1c3f86,role:_0x3dbc56}=_0x33d98e[_0x25c8ad(0x18d)],_0x5669d3=_0x33d98e['user'],_0x2fd429=await profile[_0x25c8ad(0x1ba)]({'email':_0x5669d3[_0x25c8ad(0x1c6)]}),_0x5509c7=await master_shop[_0x25c8ad(0x1bb)]();console[_0x25c8ad(0x1bf)]('master',_0x5509c7);const _0x14c110=await customer[_0x25c8ad(0x1bb)](),_0x29b0f6=await customer[_0x25c8ad(0x19c)]([{'$lookup':{'from':_0x25c8ad(0x185),'localField':_0x25c8ad(0x1d0),'foreignField':_0x25c8ad(0x18c),'as':'customer_docs'}}]);console[_0x25c8ad(0x1bf)](_0x29b0f6);const _0x1b5064=_0x29b0f6['map'](_0x271b18=>{const _0x1cdbc5=_0x25c8ad;console[_0x1cdbc5(0x1bf)](_0x1cdbc5(0x186),_0x271b18);var _0x1c2c65=0x0,_0x8b4ff9=0x0;return _0x271b18[_0x1cdbc5(0x1b4)]['forEach'](_0x3c66c3=>{const _0x2d0c6d=_0x1cdbc5;console[_0x2d0c6d(0x1bf)](_0x2d0c6d(0x191),_0x3c66c3),_0x3c66c3[_0x2d0c6d(0x184)]=='Sale'?_0x1c2c65+=_0x3c66c3[_0x2d0c6d(0x1ce)]:_0x8b4ff9+=_0x3c66c3[_0x2d0c6d(0x1ce)];}),_0x271b18[_0x1cdbc5(0x171)]=parseFloat(_0x1c2c65)+0x0,_0x271b18[_0x1cdbc5(0x1c3)]=parseFloat(_0x8b4ff9)+0x0,_0x271b18;});console[_0x25c8ad(0x1bf)](_0x25c8ad(0x19b),_0x1b5064);if(_0x5509c7[0x0][_0x25c8ad(0x1b6)]==_0x25c8ad(0x1aa)){var _0x1119eb=users[_0x25c8ad(0x1ca)];console[_0x25c8ad(0x1bf)](_0x1119eb);}else{if(_0x5509c7[0x0][_0x25c8ad(0x1b6)]=='Hindi')var _0x1119eb=users[_0x25c8ad(0x1a4)];else{if(_0x5509c7[0x0]['language']==_0x25c8ad(0x1ad))var _0x1119eb=users[_0x25c8ad(0x1ad)];else{if(_0x5509c7[0x0][_0x25c8ad(0x1b6)]==_0x25c8ad(0x176))var _0x1119eb=users[_0x25c8ad(0x176)];else{if(_0x5509c7[0x0][_0x25c8ad(0x1b6)]=='French')var _0x1119eb=users['French'];else{if(_0x5509c7[0x0][_0x25c8ad(0x1b6)]=='Portuguese\x20(BR)')var _0x1119eb=users[_0x25c8ad(0x170)];else{if(_0x5509c7[0x0][_0x25c8ad(0x1b6)]=='Chinese')var _0x1119eb=users[_0x25c8ad(0x1a1)];else{if(_0x5509c7[0x0][_0x25c8ad(0x1b6)]==_0x25c8ad(0x182))var _0x1119eb=users[_0x25c8ad(0x1c4)];}}}}}}}_0x57d1b2['render'](_0x25c8ad(0x18c),{'success':_0x33d98e[_0x25c8ad(0x1cd)]('success'),'errors':_0x33d98e[_0x25c8ad(0x1cd)]('errors'),'user':_0x14c110,'role':_0x5669d3,'profile':_0x2fd429,'payment':_0x1b5064,'master_shop':_0x5509c7,'language':_0x1119eb});}catch(_0x289ede){console[_0x25c8ad(0x1bf)](_0x289ede);}}),router[a0_0x15270b(0x1a7)](a0_0x15270b(0x179),auth,async(_0x1de524,_0x3f0250)=>{const _0x54b9ef=a0_0x15270b;try{const {name:_0x32181b,address:_0x4a556b,mobile:_0xf5b6eb,email:_0x2c20b6,receivable:_0x4cea7a,payable:_0x4ab2c7,contactperson:_0x2de45e,landline:_0x540281}=_0x1de524[_0x54b9ef(0x1b8)],_0xf14e05=new customer({'name':_0x32181b,'address':_0x4a556b,'mobile':_0xf5b6eb,'email':_0x2c20b6,'receivable':_0x4cea7a,'payable':_0x4ab2c7,'contactperson':_0x2de45e,'landline':_0x540281}),_0x3f53fa=await _0xf14e05[_0x54b9ef(0x1a2)]();_0x1de524[_0x54b9ef(0x1cd)](_0x54b9ef(0x1be),_0x54b9ef(0x1b5)),_0x3f0250[_0x54b9ef(0x181)]('/customer/view');}catch(_0x37d152){console[_0x54b9ef(0x1bf)](_0x37d152);}}),router[a0_0x15270b(0x17e)](a0_0x15270b(0x177),auth,async(_0x114a26,_0x547534)=>{const _0x4819f8=a0_0x15270b;try{const {username:_0x1e14c7,email:_0x1b6f54,role:_0x1e9e52}=_0x114a26[_0x4819f8(0x18d)],_0x2f3bbe=_0x114a26[_0x4819f8(0x18d)],_0x117574=await profile[_0x4819f8(0x1ba)]({'email':_0x2f3bbe['email']}),_0x4136e1=await master_shop['find']();console[_0x4819f8(0x1bf)](_0x4819f8(0x1c1),_0x4136e1);const _0x56fa02=_0x114a26[_0x4819f8(0x1ae)]['id'],_0xec327b=await customer[_0x4819f8(0x17b)](_0x56fa02);if(_0x4136e1[0x0][_0x4819f8(0x1b6)]==_0x4819f8(0x1aa)){var _0x377ee2=users['English'];console[_0x4819f8(0x1bf)](_0x377ee2);}else{if(_0x4136e1[0x0]['language']==_0x4819f8(0x1a4))var _0x377ee2=users[_0x4819f8(0x1a4)];else{if(_0x4136e1[0x0][_0x4819f8(0x1b6)]==_0x4819f8(0x1ad))var _0x377ee2=users[_0x4819f8(0x1ad)];else{if(_0x4136e1[0x0][_0x4819f8(0x1b6)]=='Spanish')var _0x377ee2=users[_0x4819f8(0x176)];else{if(_0x4136e1[0x0][_0x4819f8(0x1b6)]=='French')var _0x377ee2=users[_0x4819f8(0x16e)];else{if(_0x4136e1[0x0][_0x4819f8(0x1b6)]==_0x4819f8(0x1af))var _0x377ee2=users['Portuguese'];else{if(_0x4136e1[0x0][_0x4819f8(0x1b6)]==_0x4819f8(0x1a1))var _0x377ee2=users[_0x4819f8(0x1a1)];else{if(_0x4136e1[0x0][_0x4819f8(0x1b6)]=='Arabic\x20(ae)')var _0x377ee2=users[_0x4819f8(0x1c4)];}}}}}}}_0x547534[_0x4819f8(0x180)](_0x4819f8(0x18c),{'success':_0x114a26['flash'](_0x4819f8(0x1be)),'errors':_0x114a26[_0x4819f8(0x1cd)](_0x4819f8(0x193)),'role':_0x2f3bbe,'profile':_0x117574,'user':_0xec327b,'master_shop':_0x4136e1,'language':_0x377ee2});}catch(_0x45219e){console['log'](_0x45219e);}}),router[a0_0x15270b(0x1a7)](a0_0x15270b(0x177),auth,async(_0x3ecf12,_0x12a6a8)=>{const _0x321840=a0_0x15270b;try{const _0x350631=_0x3ecf12[_0x321840(0x1ae)]['id'],_0x2adeaa=await customer[_0x321840(0x17b)](_0x350631),{name:_0x3ba24c,address:_0x53264a,mobile:_0x507e54,email:_0x193dd,receivable:_0x5616d3,payable:_0x32ca10,contactperson:_0x11ddac,landline:_0x3fc51a}=_0x3ecf12['body'];_0x2adeaa[_0x321840(0x1d0)]=_0x3ba24c,_0x2adeaa[_0x321840(0x194)]=_0x53264a,_0x2adeaa['mobile']=_0x507e54,_0x2adeaa['email']=_0x193dd,_0x2adeaa[_0x321840(0x1cf)]=_0x5616d3,_0x2adeaa['payable']=_0x32ca10,_0x2adeaa['contactperson']=_0x11ddac,_0x2adeaa['landline']=_0x3fc51a;const _0x274ac6=await _0x2adeaa[_0x321840(0x1a2)]();_0x3ecf12[_0x321840(0x1cd)]('success','customer\x20update\x20successfully'),_0x12a6a8['redirect'](_0x321840(0x196));}catch(_0x1b4af5){console['log'](_0x1b4af5);}}),router[a0_0x15270b(0x17e)]('/view/payment/:id',auth,async(_0x5d248e,_0x9ffc11)=>{const _0x528ea6=a0_0x15270b;try{const {username:_0x3ff742,email:_0x5d9c3e,role:_0x2cfe94}=_0x5d248e[_0x528ea6(0x18d)],_0x1e21d0=_0x5d248e[_0x528ea6(0x18d)],_0x307274=await profile[_0x528ea6(0x1ba)]({'email':_0x1e21d0[_0x528ea6(0x1c6)]}),_0x13e3d4=await master_shop[_0x528ea6(0x1bb)]();console[_0x528ea6(0x1bf)](_0x528ea6(0x1c1),_0x13e3d4),console[_0x528ea6(0x1bf)](_0x5d248e[_0x528ea6(0x1ae)]['id']);const _0x49902c=await customer['findOne']({'_id':_0x5d248e['params']['id']});console['log'](_0x528ea6(0x1c5),_0x49902c);const _0x89b069=await c_payment_data['find']({'customer':_0x49902c[_0x528ea6(0x1d0)]});console[_0x528ea6(0x1bf)](_0x89b069);const _0x53934d=await c_payment_data[_0x528ea6(0x19c)]([{'$match':{'customer':_0x49902c[_0x528ea6(0x1d0)]}},{'$match':{'reason':_0x528ea6(0x192)}},{'$group':{'_id':_0x528ea6(0x1cb),'sum':{'$sum':_0x528ea6(0x18e)}}}]);console['log'](_0x528ea6(0x1c7),_0x53934d);const _0x2a5338=await c_payment_data[_0x528ea6(0x19c)]([{'$match':{'customer':_0x49902c[_0x528ea6(0x1d0)]}},{'$match':{'reason':_0x528ea6(0x18a)}},{'$group':{'_id':_0x528ea6(0x1cb),'sum':{'$sum':_0x528ea6(0x18e)}}}]);console[_0x528ea6(0x1bf)](_0x528ea6(0x175),_0x2a5338);if(_0x13e3d4[0x0][_0x528ea6(0x1b6)]=='English\x20(US)'){var _0x9db937=users[_0x528ea6(0x1ca)];console[_0x528ea6(0x1bf)](_0x9db937);}else{if(_0x13e3d4[0x0][_0x528ea6(0x1b6)]=='Hindi')var _0x9db937=users['Hindi'];else{if(_0x13e3d4[0x0][_0x528ea6(0x1b6)]=='German')var _0x9db937=users[_0x528ea6(0x1ad)];else{if(_0x13e3d4[0x0][_0x528ea6(0x1b6)]==_0x528ea6(0x176))var _0x9db937=users[_0x528ea6(0x176)];else{if(_0x13e3d4[0x0][_0x528ea6(0x1b6)]==_0x528ea6(0x16e))var _0x9db937=users[_0x528ea6(0x16e)];else{if(_0x13e3d4[0x0][_0x528ea6(0x1b6)]==_0x528ea6(0x1af))var _0x9db937=users[_0x528ea6(0x170)];else{if(_0x13e3d4[0x0][_0x528ea6(0x1b6)]==_0x528ea6(0x1a1))var _0x9db937=users[_0x528ea6(0x1a1)];else{if(_0x13e3d4[0x0][_0x528ea6(0x1b6)]==_0x528ea6(0x182))var _0x9db937=users[_0x528ea6(0x1c4)];}}}}}}}_0x9ffc11[_0x528ea6(0x180)]('customer_payment',{'success':_0x5d248e['flash'](_0x528ea6(0x1be)),'errors':_0x5d248e[_0x528ea6(0x1cd)]('errors'),'role':_0x1e21d0,'profile':_0x307274,'payment':_0x89b069,'payable':_0x53934d,'receivable':_0x2a5338,'master_shop':_0x13e3d4,'language':_0x9db937});}catch(_0x3c380f){console['log'](_0x3c380f);}}),router[a0_0x15270b(0x17e)]('/products_export_migrate_file',auth,async(_0x25b5fb,_0x5f2447)=>{const _0x8f20ae=a0_0x15270b;try{const _0x11ad90=new excelJS[(_0x8f20ae(0x1b0))](),_0x4d41c5=_0x11ad90[_0x8f20ae(0x199)](_0x8f20ae(0x19a));return _0x4d41c5['columns']=[{'header':'ID','key':_0x8f20ae(0x195),'width':0xa},{'header':'Name','key':'PBrands','width':0xa},{'header':_0x8f20ae(0x17f),'key':_0x8f20ae(0x1b1),'width':0xa},{'header':'SalesmanName','key':_0x8f20ae(0x1ab),'width':0xa},{'header':_0x8f20ae(0x194),'key':'address','width':0xa},{'header':_0x8f20ae(0x17d),'key':_0x8f20ae(0x17d),'width':0xa},{'header':_0x8f20ae(0x1c6),'key':_0x8f20ae(0x1c6),'width':0xa}],_0x5f2447['setHeader'](_0x8f20ae(0x172),_0x8f20ae(0x16c)),_0x5f2447[_0x8f20ae(0x1c0)](_0x8f20ae(0x197),_0x8f20ae(0x169)),_0x11ad90['xlsx']['write'](_0x5f2447)['then'](()=>{const _0x54d24b=_0x8f20ae;_0x5f2447[_0x54d24b(0x1bd)](0xc8);});}catch(_0x16d17f){_0x5f2447[_0x8f20ae(0x1bd)](0x190)[_0x8f20ae(0x18f)]({'errors':_0x16d17f[_0x8f20ae(0x1b7)]});}});const storage1=multer[a0_0x15270b(0x187)]({'destination':(_0x49a54c,_0x211259,_0x1f0208)=>{const _0xb8dbd9=a0_0x15270b;_0x1f0208(null,_0xb8dbd9(0x1ac));},'filename':(_0x27d0c6,_0x2396d6,_0x580279)=>{const _0x316b78=a0_0x15270b;_0x580279(null,Date[_0x316b78(0x1b9)]()+_0x2396d6[_0x316b78(0x1a8)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x19a1(){const _0x2f0a55=['success','log','setHeader','master','sheet_to_json','sale_return','Arabic','customer_data','email','payable_sum','4eFCyAu','express','English','$reason','9153144YNzpul','flash','amount','receivable','name','attachment;\x20filename=customer_Migration_File.xlsx','110xcItaq','../models/all_models','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','6zdgjcb','French','public/Migration/','Portuguese','sale','Content-Type','4063005SevpIa','4624641BLMFgA','receivable_sum','Spanish','/view/:id','multer','/view','filename','findById','5235099NBnStV','mobile','get','SalesmanCode','render','redirect','Arabic\x20(ae)','utils','reason','c_payments','data','diskStorage','132946CEUhyQ','../middleware/auth','Sale\x20Return','../public/language/languages.json','customer','user','$amount','send','readFile','element','Sale','errors','address','PName','/customer/view','Content-Disposition','exports','addWorksheet','Customers','payment_data','aggregate','811388REQWXk','483534riAAny','\x20added\x20successfully','/customer_import_migrate_file','Chinese','save','Router','Hindi','\x20Failed','xlsx','post','originalname','exceljs','English\x20(US)','SalesmanName','public/Migration','German','params','Portuguese\x20(BR)','Workbook','PUnits','file','single','customer_docs','customer\x20add\x20successfully','language','message','body','now','findOne','find','Sheets','status'];a0_0x19a1=function(){return _0x2f0a55;};return a0_0x19a1();}router[a0_0x15270b(0x1a7)](a0_0x15270b(0x1a0),auth,uploadMigrate[a0_0x15270b(0x1b3)]('customer_product_fule'),async(_0x60b5cb,_0xcd0c59)=>{const _0x53fada=a0_0x15270b,_0xbe02f7=_0x60b5cb[_0x53fada(0x1b2)][_0x53fada(0x17a)],_0x4c41c4=await xlsx[_0x53fada(0x190)](_0x53fada(0x16f)+_0xbe02f7);let _0x249515=_0x4c41c4['SheetNames'],_0x5e4882=xlsx[_0x53fada(0x183)][_0x53fada(0x1c2)](_0x4c41c4[_0x53fada(0x1bc)][_0x249515[0x0]]);for(const _0x576f41 of _0x5e4882){const _0x20c97a=_0x576f41['ID'],_0x567a30=_0x576f41['Name'],_0x1c95a6=_0x576f41[_0x53fada(0x17f)],_0x33dc58=_0x576f41[_0x53fada(0x1ab)],_0x861eb7=_0x576f41[_0x53fada(0x194)],_0x1872ba=_0x576f41[_0x53fada(0x17d)],_0x4709db=_0x576f41['email'];try{let _0x4db0aa=await customer[_0x53fada(0x1ba)]({'name':_0x567a30});if(!_0x4db0aa){const _0x101785=new customer({'name':_0x567a30,'ID':_0x20c97a,'SalesmanCode':_0x1c95a6,'SalesmanName':_0x33dc58,'address':_0x861eb7,'mobile':_0x1872ba,'email':_0x4709db});_0x4db0aa=await _0x101785[_0x53fada(0x1a2)](),_0x60b5cb['flash']('success',_0x567a30+_0x53fada(0x19f));}else _0x60b5cb[_0x53fada(0x1cd)]('error',_0x567a30+_0x53fada(0x1a5));}catch(_0x4da1a3){_0xcd0c59[_0x53fada(0x1bd)](0x1f4)['json']({'proderror':_0x4da1a3['message'],'aproduct':ProductName});}}_0xcd0c59[_0x53fada(0x181)](_0x53fada(0x196));}),module[a0_0x15270b(0x198)]=router;