function a0_0x42d7(_0x559797,_0x2cce00){const _0x2dc4c8=a0_0x2dc4();return a0_0x42d7=function(_0x42d7f3,_0x1e4c1f){_0x42d7f3=_0x42d7f3-0x1f4;let _0x34ca0f=_0x2dc4c8[_0x42d7f3];return _0x34ca0f;},a0_0x42d7(_0x559797,_0x2cce00);}const a0_0x46a9ed=a0_0x42d7;(function(_0x2cf355,_0x5904bf){const _0x4f90b6=a0_0x42d7,_0xf33291=_0x2cf355();while(!![]){try{const _0x151d8a=parseInt(_0x4f90b6(0x222))/0x1+parseInt(_0x4f90b6(0x227))/0x2*(-parseInt(_0x4f90b6(0x225))/0x3)+-parseInt(_0x4f90b6(0x214))/0x4+parseInt(_0x4f90b6(0x240))/0x5+parseInt(_0x4f90b6(0x232))/0x6+-parseInt(_0x4f90b6(0x246))/0x7*(parseInt(_0x4f90b6(0x253))/0x8)+parseInt(_0x4f90b6(0x238))/0x9;if(_0x151d8a===_0x5904bf)break;else _0xf33291['push'](_0xf33291['shift']());}catch(_0x5bd624){_0xf33291['push'](_0xf33291['shift']());}}}(a0_0x2dc4,0x7e56f));function a0_0x2dc4(){const _0x5d1302=['forEach','/view/:id','\x20added\x20successfully','SalesmanCode','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','252355EDVcgn','/view','customer_data','2770089vZzJEW','message','2tBGUQu','Customers','error','readFile','Name','xlsx','landline','customer\x20add\x20successfully','master','public/Migration/','findById','3783702BWEQRO','sheet_to_json','user','originalname','status','setHeader','11472597RVUkKj','public/Migration','customer_docs','../public/language/languages.json','save','customer_product_fule','columns','SalesmanName','2976015YwAMKQ','Content-Type','mobile','/customer_import_migrate_file','find','element','435057DZkoiv','Portuguese\x20(BR)','findOne','params','get','express','redirect','$amount','Arabic','PBrands','Sale','receivable','post','128SUkHDG','errors','English','../models/all_models','contactperson','write','multer','English\x20(US)','payable','exceljs','flash','customer','Portuguese','customer_payment','Chinese','utils','French','email','aggregate','diskStorage','Spanish','success','single','map','exports','addWorksheet','body','Workbook','Hindi','receivable_sum','reason','send','PName','address','log','/view/payment/:id','/customer/view','German','Sheets','1270568paHZyW','payment_data','filename','attachment;\x20filename=customer_Migration_File.xlsx','\x20Failed','name','Arabic\x20(ae)','language','$reason'];a0_0x2dc4=function(){return _0x5d1302;};return a0_0x2dc4();}const express=require(a0_0x46a9ed(0x24b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x46a9ed(0x256)),auth=require('../middleware/auth'),users=require(a0_0x46a9ed(0x23b)),excelJS=require(a0_0x46a9ed(0x1f6)),xlsx=require(a0_0x46a9ed(0x22c)),multer=require(a0_0x46a9ed(0x259));router[a0_0x46a9ed(0x24a)](a0_0x46a9ed(0x223),auth,async(_0x2f8c57,_0x53bfbb)=>{const _0x2f3a67=a0_0x46a9ed;try{const {username:_0x50b0bf,email:_0x6f9150,role:_0xa3293d}=_0x2f8c57[_0x2f3a67(0x234)],_0x807d8f=_0x2f8c57[_0x2f3a67(0x234)],_0x5a04ea=await profile['findOne']({'email':_0x807d8f['email']}),_0x2dae71=await master_shop[_0x2f3a67(0x244)]();console[_0x2f3a67(0x20f)]('master',_0x2dae71);const _0x2f3fa0=await customer[_0x2f3a67(0x244)](),_0x35e2c9=await customer[_0x2f3a67(0x1ff)]([{'$lookup':{'from':'c_payments','localField':_0x2f3a67(0x219),'foreignField':_0x2f3a67(0x1f8),'as':_0x2f3a67(0x23a)}}]);console[_0x2f3a67(0x20f)](_0x35e2c9);const _0x2e4c51=_0x35e2c9[_0x2f3a67(0x204)](_0x5646f2=>{const _0x5e5052=_0x2f3a67;console[_0x5e5052(0x20f)]('data',_0x5646f2);var _0x449580=0x0,_0x108522=0x0;return _0x5646f2[_0x5e5052(0x23a)][_0x5e5052(0x21d)](_0x57cc77=>{const _0x4f7064=_0x5e5052;console[_0x4f7064(0x20f)](_0x4f7064(0x245),_0x57cc77),_0x57cc77[_0x4f7064(0x20b)]==_0x4f7064(0x250)?_0x449580+=_0x57cc77['amount']:_0x108522+=_0x57cc77['amount'];}),_0x5646f2['sale']=parseFloat(_0x449580)+0x0,_0x5646f2['sale_return']=parseFloat(_0x108522)+0x0,_0x5646f2;});console[_0x2f3a67(0x20f)](_0x2f3a67(0x215),_0x2e4c51);if(_0x2dae71[0x0][_0x2f3a67(0x21b)]=='English\x20(US)'){var _0xd22f0b=users[_0x2f3a67(0x255)];console[_0x2f3a67(0x20f)](_0xd22f0b);}else{if(_0x2dae71[0x0][_0x2f3a67(0x21b)]=='Hindi')var _0xd22f0b=users[_0x2f3a67(0x209)];else{if(_0x2dae71[0x0]['language']=='German')var _0xd22f0b=users['German'];else{if(_0x2dae71[0x0][_0x2f3a67(0x21b)]=='Spanish')var _0xd22f0b=users[_0x2f3a67(0x201)];else{if(_0x2dae71[0x0][_0x2f3a67(0x21b)]==_0x2f3a67(0x1fd))var _0xd22f0b=users[_0x2f3a67(0x1fd)];else{if(_0x2dae71[0x0][_0x2f3a67(0x21b)]==_0x2f3a67(0x247))var _0xd22f0b=users[_0x2f3a67(0x1f9)];else{if(_0x2dae71[0x0][_0x2f3a67(0x21b)]=='Chinese')var _0xd22f0b=users[_0x2f3a67(0x1fb)];else{if(_0x2dae71[0x0][_0x2f3a67(0x21b)]=='Arabic\x20(ae)')var _0xd22f0b=users[_0x2f3a67(0x24e)];}}}}}}}_0x53bfbb['render']('customer',{'success':_0x2f8c57[_0x2f3a67(0x1f7)](_0x2f3a67(0x202)),'errors':_0x2f8c57[_0x2f3a67(0x1f7)](_0x2f3a67(0x254)),'user':_0x2f3fa0,'role':_0x807d8f,'profile':_0x5a04ea,'payment':_0x2e4c51,'master_shop':_0x2dae71,'language':_0xd22f0b});}catch(_0x1d4a38){console[_0x2f3a67(0x20f)](_0x1d4a38);}}),router[a0_0x46a9ed(0x252)]('/view',auth,async(_0x70ad08,_0x4512a8)=>{const _0x3f3f5f=a0_0x46a9ed;try{const {name:_0x167dcb,address:_0x587d89,mobile:_0x373984,email:_0xb7d897,receivable:_0x537665,payable:_0x505e18,contactperson:_0x408662,landline:_0x18f060}=_0x70ad08[_0x3f3f5f(0x207)],_0x350549=new customer({'name':_0x167dcb,'address':_0x587d89,'mobile':_0x373984,'email':_0xb7d897,'receivable':_0x537665,'payable':_0x505e18,'contactperson':_0x408662,'landline':_0x18f060}),_0x5014b9=await _0x350549[_0x3f3f5f(0x23c)]();_0x70ad08[_0x3f3f5f(0x1f7)]('success',_0x3f3f5f(0x22e)),_0x4512a8[_0x3f3f5f(0x24c)]('/customer/view');}catch(_0x29755f){console[_0x3f3f5f(0x20f)](_0x29755f);}}),router['get'](a0_0x46a9ed(0x21e),auth,async(_0x439ffd,_0x422364)=>{const _0x538c03=a0_0x46a9ed;try{const {username:_0x2b1ab9,email:_0x3ebc9d,role:_0x145971}=_0x439ffd[_0x538c03(0x234)],_0x22ef0f=_0x439ffd['user'],_0x2b2947=await profile[_0x538c03(0x248)]({'email':_0x22ef0f[_0x538c03(0x1fe)]}),_0x15b5ac=await master_shop[_0x538c03(0x244)]();console['log'](_0x538c03(0x22f),_0x15b5ac);const _0x143261=_0x439ffd[_0x538c03(0x249)]['id'],_0x19363b=await customer[_0x538c03(0x231)](_0x143261);if(_0x15b5ac[0x0][_0x538c03(0x21b)]==_0x538c03(0x1f4)){var _0xd21992=users[_0x538c03(0x255)];console['log'](_0xd21992);}else{if(_0x15b5ac[0x0][_0x538c03(0x21b)]==_0x538c03(0x209))var _0xd21992=users['Hindi'];else{if(_0x15b5ac[0x0][_0x538c03(0x21b)]==_0x538c03(0x212))var _0xd21992=users[_0x538c03(0x212)];else{if(_0x15b5ac[0x0][_0x538c03(0x21b)]==_0x538c03(0x201))var _0xd21992=users[_0x538c03(0x201)];else{if(_0x15b5ac[0x0]['language']=='French')var _0xd21992=users['French'];else{if(_0x15b5ac[0x0][_0x538c03(0x21b)]=='Portuguese\x20(BR)')var _0xd21992=users[_0x538c03(0x1f9)];else{if(_0x15b5ac[0x0][_0x538c03(0x21b)]==_0x538c03(0x1fb))var _0xd21992=users[_0x538c03(0x1fb)];else{if(_0x15b5ac[0x0]['language']==_0x538c03(0x21a))var _0xd21992=users['Arabic'];}}}}}}}_0x422364['render']('customer',{'success':_0x439ffd['flash'](_0x538c03(0x202)),'errors':_0x439ffd['flash'](_0x538c03(0x254)),'role':_0x22ef0f,'profile':_0x2b2947,'user':_0x19363b,'master_shop':_0x15b5ac,'language':_0xd21992});}catch(_0x373ded){console[_0x538c03(0x20f)](_0x373ded);}}),router[a0_0x46a9ed(0x252)](a0_0x46a9ed(0x21e),auth,async(_0x2faa1c,_0x140386)=>{const _0x2db730=a0_0x46a9ed;try{const _0x23c57e=_0x2faa1c[_0x2db730(0x249)]['id'],_0x434867=await customer[_0x2db730(0x231)](_0x23c57e),{name:_0x4c7b59,address:_0x2e138b,mobile:_0x11b12c,email:_0x4e9edc,receivable:_0x206f95,payable:_0x4ac42d,contactperson:_0x53fc1e,landline:_0x5e27a3}=_0x2faa1c[_0x2db730(0x207)];_0x434867['name']=_0x4c7b59,_0x434867[_0x2db730(0x20e)]=_0x2e138b,_0x434867[_0x2db730(0x242)]=_0x11b12c,_0x434867[_0x2db730(0x1fe)]=_0x4e9edc,_0x434867[_0x2db730(0x251)]=_0x206f95,_0x434867[_0x2db730(0x1f5)]=_0x4ac42d,_0x434867[_0x2db730(0x257)]=_0x53fc1e,_0x434867[_0x2db730(0x22d)]=_0x5e27a3;const _0x584b13=await _0x434867[_0x2db730(0x23c)]();_0x2faa1c[_0x2db730(0x1f7)](_0x2db730(0x202),'customer\x20update\x20successfully'),_0x140386[_0x2db730(0x24c)](_0x2db730(0x211));}catch(_0x2a6a29){console[_0x2db730(0x20f)](_0x2a6a29);}}),router[a0_0x46a9ed(0x24a)](a0_0x46a9ed(0x210),auth,async(_0x18aee5,_0x3179de)=>{const _0x35e8be=a0_0x46a9ed;try{const {username:_0x436af5,email:_0x5c2597,role:_0x5e893e}=_0x18aee5[_0x35e8be(0x234)],_0x20fd29=_0x18aee5['user'],_0x1d3724=await profile[_0x35e8be(0x248)]({'email':_0x20fd29[_0x35e8be(0x1fe)]}),_0x567b60=await master_shop['find']();console[_0x35e8be(0x20f)](_0x35e8be(0x22f),_0x567b60),console[_0x35e8be(0x20f)](_0x18aee5['params']['id']);const _0x52aa2f=await customer[_0x35e8be(0x248)]({'_id':_0x18aee5['params']['id']});console['log'](_0x35e8be(0x224),_0x52aa2f);const _0x8c5ae7=await c_payment_data[_0x35e8be(0x244)]({'customer':_0x52aa2f[_0x35e8be(0x219)]});console[_0x35e8be(0x20f)](_0x8c5ae7);const _0xdc2c98=await c_payment_data['aggregate']([{'$match':{'customer':_0x52aa2f[_0x35e8be(0x219)]}},{'$match':{'reason':'Sale'}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x35e8be(0x20f)]('payable_sum',_0xdc2c98);const _0x53f42=await c_payment_data['aggregate']([{'$match':{'customer':_0x52aa2f[_0x35e8be(0x219)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x35e8be(0x21c),'sum':{'$sum':_0x35e8be(0x24d)}}}]);console[_0x35e8be(0x20f)](_0x35e8be(0x20a),_0x53f42);if(_0x567b60[0x0][_0x35e8be(0x21b)]==_0x35e8be(0x1f4)){var _0x2e97c1=users[_0x35e8be(0x255)];console[_0x35e8be(0x20f)](_0x2e97c1);}else{if(_0x567b60[0x0][_0x35e8be(0x21b)]==_0x35e8be(0x209))var _0x2e97c1=users[_0x35e8be(0x209)];else{if(_0x567b60[0x0][_0x35e8be(0x21b)]==_0x35e8be(0x212))var _0x2e97c1=users[_0x35e8be(0x212)];else{if(_0x567b60[0x0][_0x35e8be(0x21b)]==_0x35e8be(0x201))var _0x2e97c1=users['Spanish'];else{if(_0x567b60[0x0]['language']==_0x35e8be(0x1fd))var _0x2e97c1=users['French'];else{if(_0x567b60[0x0][_0x35e8be(0x21b)]=='Portuguese\x20(BR)')var _0x2e97c1=users[_0x35e8be(0x1f9)];else{if(_0x567b60[0x0]['language']==_0x35e8be(0x1fb))var _0x2e97c1=users[_0x35e8be(0x1fb)];else{if(_0x567b60[0x0][_0x35e8be(0x21b)]==_0x35e8be(0x21a))var _0x2e97c1=users[_0x35e8be(0x24e)];}}}}}}}_0x3179de['render'](_0x35e8be(0x1fa),{'success':_0x18aee5[_0x35e8be(0x1f7)](_0x35e8be(0x202)),'errors':_0x18aee5[_0x35e8be(0x1f7)]('errors'),'role':_0x20fd29,'profile':_0x1d3724,'payment':_0x8c5ae7,'payable':_0xdc2c98,'receivable':_0x53f42,'master_shop':_0x567b60,'language':_0x2e97c1});}catch(_0x3f19dd){console[_0x35e8be(0x20f)](_0x3f19dd);}}),router[a0_0x46a9ed(0x24a)]('/products_export_migrate_file',auth,async(_0xf5c2d8,_0x8be3c5)=>{const _0x2986a0=a0_0x46a9ed;try{const _0x108446=new excelJS[(_0x2986a0(0x208))](),_0x588424=_0x108446[_0x2986a0(0x206)](_0x2986a0(0x228));return _0x588424[_0x2986a0(0x23e)]=[{'header':'ID','key':_0x2986a0(0x20d),'width':0xa},{'header':_0x2986a0(0x22b),'key':_0x2986a0(0x24f),'width':0xa},{'header':_0x2986a0(0x220),'key':'PUnits','width':0xa},{'header':_0x2986a0(0x23f),'key':_0x2986a0(0x23f),'width':0xa},{'header':'address','key':_0x2986a0(0x20e),'width':0xa},{'header':_0x2986a0(0x242),'key':_0x2986a0(0x242),'width':0xa},{'header':_0x2986a0(0x1fe),'key':_0x2986a0(0x1fe),'width':0xa}],_0x8be3c5[_0x2986a0(0x237)](_0x2986a0(0x241),_0x2986a0(0x221)),_0x8be3c5[_0x2986a0(0x237)]('Content-Disposition',_0x2986a0(0x217)),_0x108446['xlsx'][_0x2986a0(0x258)](_0x8be3c5)['then'](()=>{const _0x3273af=_0x2986a0;_0x8be3c5[_0x3273af(0x236)](0xc8);});}catch(_0x4094a8){_0x8be3c5[_0x2986a0(0x236)](0x190)[_0x2986a0(0x20c)]({'errors':_0x4094a8[_0x2986a0(0x226)]});}});const storage1=multer[a0_0x46a9ed(0x200)]({'destination':(_0x2c3cc5,_0x1ac181,_0x5bd5ba)=>{const _0x3dc65d=a0_0x46a9ed;_0x5bd5ba(null,_0x3dc65d(0x239));},'filename':(_0x1f1a20,_0x491dfa,_0x23e56b)=>{const _0x5612fe=a0_0x46a9ed;_0x23e56b(null,Date['now']()+_0x491dfa[_0x5612fe(0x235)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x46a9ed(0x243),auth,uploadMigrate[a0_0x46a9ed(0x203)](a0_0x46a9ed(0x23d)),async(_0xf1b235,_0x4eaf78)=>{const _0x5dc2a0=a0_0x46a9ed,_0x1bcbed=_0xf1b235['file'][_0x5dc2a0(0x216)],_0x40ee28=await xlsx[_0x5dc2a0(0x22a)](_0x5dc2a0(0x230)+_0x1bcbed);let _0x272749=_0x40ee28['SheetNames'],_0xaa69ff=xlsx[_0x5dc2a0(0x1fc)][_0x5dc2a0(0x233)](_0x40ee28[_0x5dc2a0(0x213)][_0x272749[0x0]]);for(const _0x29e08e of _0xaa69ff){const _0x2a33cb=_0x29e08e['ID'],_0x1757fc=_0x29e08e[_0x5dc2a0(0x22b)],_0x156839=_0x29e08e[_0x5dc2a0(0x220)],_0x2611dd=_0x29e08e[_0x5dc2a0(0x23f)],_0xe2b877=_0x29e08e[_0x5dc2a0(0x20e)],_0x2f074f=_0x29e08e[_0x5dc2a0(0x242)],_0x15dc10=_0x29e08e[_0x5dc2a0(0x1fe)];try{let _0x3f9e54=await customer[_0x5dc2a0(0x248)]({'name':_0x1757fc});if(!_0x3f9e54){const _0x23d64a=new customer({'name':_0x1757fc,'ID':_0x2a33cb,'SalesmanCode':_0x156839,'SalesmanName':_0x2611dd,'address':_0xe2b877,'mobile':_0x2f074f,'email':_0x15dc10});_0x3f9e54=await _0x23d64a[_0x5dc2a0(0x23c)](),_0xf1b235['flash'](_0x5dc2a0(0x202),_0x1757fc+_0x5dc2a0(0x21f));}else _0xf1b235[_0x5dc2a0(0x1f7)](_0x5dc2a0(0x229),_0x1757fc+_0x5dc2a0(0x218));}catch(_0x902016){_0x4eaf78['status'](0x1f4)['json']({'proderror':_0x902016['message'],'aproduct':ProductName});}}_0x4eaf78[_0x5dc2a0(0x24c)](_0x5dc2a0(0x211));}),module[a0_0x46a9ed(0x205)]=router;