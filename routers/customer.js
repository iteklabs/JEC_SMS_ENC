function a0_0xbf4c(_0x1bc22b,_0x3ff6fd){const _0x5503c6=a0_0x5503();return a0_0xbf4c=function(_0xbf4c88,_0x31ba8b){_0xbf4c88=_0xbf4c88-0x68;let _0x4dd3f4=_0x5503c6[_0xbf4c88];return _0x4dd3f4;},a0_0xbf4c(_0x1bc22b,_0x3ff6fd);}const a0_0x367710=a0_0xbf4c;(function(_0x29c72e,_0x3d92fa){const _0x131353=a0_0xbf4c,_0x7fbf89=_0x29c72e();while(!![]){try{const _0x2656e6=parseInt(_0x131353(0xac))/0x1+parseInt(_0x131353(0x79))/0x2*(parseInt(_0x131353(0xbf))/0x3)+-parseInt(_0x131353(0xb0))/0x4+parseInt(_0x131353(0x8f))/0x5+-parseInt(_0x131353(0x68))/0x6*(-parseInt(_0x131353(0x80))/0x7)+parseInt(_0x131353(0xa8))/0x8*(-parseInt(_0x131353(0x81))/0x9)+-parseInt(_0x131353(0x9b))/0xa;if(_0x2656e6===_0x3d92fa)break;else _0x7fbf89['push'](_0x7fbf89['shift']());}catch(_0x383268){_0x7fbf89['push'](_0x7fbf89['shift']());}}}(a0_0x5503,0x7c8af));const express=require('express'),app=express(),router=express[a0_0x367710(0x82)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x367710(0xae)),auth=require('../middleware/auth'),users=require(a0_0x367710(0x78)),excelJS=require(a0_0x367710(0xca)),xlsx=require(a0_0x367710(0x7e)),multer=require(a0_0x367710(0xb9));router[a0_0x367710(0xc9)](a0_0x367710(0x76),auth,async(_0x2e6618,_0x4cede8)=>{const _0x4e1090=a0_0x367710;try{const {username:_0x4ff79,email:_0x2ad5ef,role:_0x1b126d}=_0x2e6618[_0x4e1090(0x89)],_0x384398=_0x2e6618[_0x4e1090(0x89)],_0x581a98=await profile[_0x4e1090(0x6c)]({'email':_0x384398[_0x4e1090(0xb3)]}),_0x3bcb6d=await master_shop['find']();console['log']('master',_0x3bcb6d);const _0x29e669=await customer['find'](),_0x4081b6=await customer['aggregate']([{'$lookup':{'from':_0x4e1090(0x9c),'localField':_0x4e1090(0xbb),'foreignField':_0x4e1090(0x96),'as':'customer_docs'}}]);console['log'](_0x4081b6);const _0x1aba60=_0x4081b6[_0x4e1090(0x77)](_0x884c37=>{const _0x511a3c=_0x4e1090;console[_0x511a3c(0x7f)]('data',_0x884c37);var _0x371297=0x0,_0x7f5329=0x0;return _0x884c37[_0x511a3c(0x88)]['forEach'](_0xe74a3d=>{const _0x989439=_0x511a3c;console[_0x989439(0x7f)](_0x989439(0x70),_0xe74a3d),_0xe74a3d[_0x989439(0xc7)]==_0x989439(0xb1)?_0x371297+=_0xe74a3d[_0x989439(0xc0)]:_0x7f5329+=_0xe74a3d[_0x989439(0xc0)];}),_0x884c37['sale']=parseFloat(_0x371297)+0x0,_0x884c37['sale_return']=parseFloat(_0x7f5329)+0x0,_0x884c37;});console[_0x4e1090(0x7f)]('payment_data',_0x1aba60);if(_0x3bcb6d[0x0][_0x4e1090(0xc5)]=='English\x20(US)'){var _0x4ed1a6=users['English'];console['log'](_0x4ed1a6);}else{if(_0x3bcb6d[0x0][_0x4e1090(0xc5)]==_0x4e1090(0x8b))var _0x4ed1a6=users[_0x4e1090(0x8b)];else{if(_0x3bcb6d[0x0][_0x4e1090(0xc5)]==_0x4e1090(0x9a))var _0x4ed1a6=users[_0x4e1090(0x9a)];else{if(_0x3bcb6d[0x0][_0x4e1090(0xc5)]==_0x4e1090(0x93))var _0x4ed1a6=users[_0x4e1090(0x93)];else{if(_0x3bcb6d[0x0][_0x4e1090(0xc5)]==_0x4e1090(0x9f))var _0x4ed1a6=users[_0x4e1090(0x9f)];else{if(_0x3bcb6d[0x0]['language']==_0x4e1090(0x90))var _0x4ed1a6=users[_0x4e1090(0x95)];else{if(_0x3bcb6d[0x0]['language']==_0x4e1090(0x6a))var _0x4ed1a6=users[_0x4e1090(0x6a)];else{if(_0x3bcb6d[0x0][_0x4e1090(0xc5)]==_0x4e1090(0xa2))var _0x4ed1a6=users[_0x4e1090(0xba)];}}}}}}}_0x4cede8['render'](_0x4e1090(0x96),{'success':_0x2e6618['flash'](_0x4e1090(0xa1)),'errors':_0x2e6618[_0x4e1090(0x6d)](_0x4e1090(0x83)),'user':_0x29e669,'role':_0x384398,'profile':_0x581a98,'payment':_0x1aba60,'master_shop':_0x3bcb6d,'language':_0x4ed1a6});}catch(_0x32eb91){console['log'](_0x32eb91);}}),router[a0_0x367710(0xa3)](a0_0x367710(0x76),auth,async(_0x25db64,_0x37055e)=>{const _0x53c58a=a0_0x367710;try{const {name:_0x5b5c92,address:_0x35ff75,mobile:_0x4ce46b,email:_0x14534a,receivable:_0x2b3750,payable:_0x319cbf,contactperson:_0x392cdf,landline:_0x4b54c1}=_0x25db64[_0x53c58a(0x85)],_0x59d2d5=new customer({'name':_0x5b5c92,'address':_0x35ff75,'mobile':_0x4ce46b,'email':_0x14534a,'receivable':_0x2b3750,'payable':_0x319cbf,'contactperson':_0x392cdf,'landline':_0x4b54c1}),_0x37727f=await _0x59d2d5[_0x53c58a(0x9d)]();_0x25db64[_0x53c58a(0x6d)](_0x53c58a(0xa1),_0x53c58a(0x72)),_0x37055e['redirect']('/customer/view');}catch(_0x102edf){console[_0x53c58a(0x7f)](_0x102edf);}}),router['get'](a0_0x367710(0x84),auth,async(_0x1aebb5,_0x18963c)=>{const _0x295d86=a0_0x367710;try{const {username:_0x533c52,email:_0x4f8916,role:_0x5b24c2}=_0x1aebb5['user'],_0x2ea5f8=_0x1aebb5[_0x295d86(0x89)],_0xca16c0=await profile[_0x295d86(0x6c)]({'email':_0x2ea5f8['email']}),_0x49f1b1=await master_shop[_0x295d86(0x7c)]();console[_0x295d86(0x7f)](_0x295d86(0x75),_0x49f1b1);const _0x21de11=_0x1aebb5[_0x295d86(0x91)]['id'],_0x21c0e8=await customer['findById'](_0x21de11);if(_0x49f1b1[0x0][_0x295d86(0xc5)]=='English\x20(US)'){var _0x5d7547=users[_0x295d86(0xb4)];console['log'](_0x5d7547);}else{if(_0x49f1b1[0x0]['language']==_0x295d86(0x8b))var _0x5d7547=users['Hindi'];else{if(_0x49f1b1[0x0][_0x295d86(0xc5)]==_0x295d86(0x9a))var _0x5d7547=users[_0x295d86(0x9a)];else{if(_0x49f1b1[0x0][_0x295d86(0xc5)]==_0x295d86(0x93))var _0x5d7547=users[_0x295d86(0x93)];else{if(_0x49f1b1[0x0][_0x295d86(0xc5)]==_0x295d86(0x9f))var _0x5d7547=users[_0x295d86(0x9f)];else{if(_0x49f1b1[0x0][_0x295d86(0xc5)]=='Portuguese\x20(BR)')var _0x5d7547=users['Portuguese'];else{if(_0x49f1b1[0x0]['language']==_0x295d86(0x6a))var _0x5d7547=users[_0x295d86(0x6a)];else{if(_0x49f1b1[0x0][_0x295d86(0xc5)]=='Arabic\x20(ae)')var _0x5d7547=users[_0x295d86(0xba)];}}}}}}}_0x18963c[_0x295d86(0x97)]('customer',{'success':_0x1aebb5[_0x295d86(0x6d)](_0x295d86(0xa1)),'errors':_0x1aebb5[_0x295d86(0x6d)](_0x295d86(0x83)),'role':_0x2ea5f8,'profile':_0xca16c0,'user':_0x21c0e8,'master_shop':_0x49f1b1,'language':_0x5d7547});}catch(_0x152703){console[_0x295d86(0x7f)](_0x152703);}}),router[a0_0x367710(0xa3)](a0_0x367710(0x84),auth,async(_0x19b844,_0x3d7571)=>{const _0x51dc83=a0_0x367710;try{const _0x35eea2=_0x19b844[_0x51dc83(0x91)]['id'],_0x3a55c2=await customer[_0x51dc83(0x6b)](_0x35eea2),{name:_0x4a7b92,address:_0x2ae552,mobile:_0x5c1036,email:_0x2b5a78,receivable:_0x163351,payable:_0x5c42ad,contactperson:_0x4142cc,landline:_0x3bf721}=_0x19b844[_0x51dc83(0x85)];_0x3a55c2[_0x51dc83(0xbb)]=_0x4a7b92,_0x3a55c2[_0x51dc83(0xbc)]=_0x2ae552,_0x3a55c2[_0x51dc83(0x9e)]=_0x5c1036,_0x3a55c2[_0x51dc83(0xb3)]=_0x2b5a78,_0x3a55c2[_0x51dc83(0x73)]=_0x163351,_0x3a55c2['payable']=_0x5c42ad,_0x3a55c2[_0x51dc83(0xad)]=_0x4142cc,_0x3a55c2[_0x51dc83(0xb5)]=_0x3bf721;const _0x197477=await _0x3a55c2[_0x51dc83(0x9d)]();_0x19b844[_0x51dc83(0x6d)](_0x51dc83(0xa1),_0x51dc83(0x99)),_0x3d7571[_0x51dc83(0xa4)](_0x51dc83(0x8a));}catch(_0x36d63f){console['log'](_0x36d63f);}}),router[a0_0x367710(0xc9)]('/view/payment/:id',auth,async(_0x23ead9,_0x3ea016)=>{const _0x591edf=a0_0x367710;try{const {username:_0x1c088b,email:_0x588492,role:_0x590627}=_0x23ead9[_0x591edf(0x89)],_0x19d66d=_0x23ead9[_0x591edf(0x89)],_0x582448=await profile[_0x591edf(0x6c)]({'email':_0x19d66d[_0x591edf(0xb3)]}),_0x2c8620=await master_shop[_0x591edf(0x7c)]();console[_0x591edf(0x7f)]('master',_0x2c8620),console[_0x591edf(0x7f)](_0x23ead9['params']['id']);const _0x330cb9=await customer[_0x591edf(0x6c)]({'_id':_0x23ead9[_0x591edf(0x91)]['id']});console[_0x591edf(0x7f)](_0x591edf(0x8e),_0x330cb9);const _0x40cf20=await c_payment_data[_0x591edf(0x7c)]({'customer':_0x330cb9[_0x591edf(0xbb)]});console[_0x591edf(0x7f)](_0x40cf20);const _0x94f43b=await c_payment_data[_0x591edf(0xc4)]([{'$match':{'customer':_0x330cb9[_0x591edf(0xbb)]}},{'$match':{'reason':_0x591edf(0xb1)}},{'$group':{'_id':_0x591edf(0xbe),'sum':{'$sum':'$amount'}}}]);console['log'](_0x591edf(0x94),_0x94f43b);const _0x14f1a9=await c_payment_data[_0x591edf(0xc4)]([{'$match':{'customer':_0x330cb9[_0x591edf(0xbb)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x591edf(0x7f)](_0x591edf(0x6e),_0x14f1a9);if(_0x2c8620[0x0][_0x591edf(0xc5)]==_0x591edf(0xc8)){var _0x219516=users['English'];console[_0x591edf(0x7f)](_0x219516);}else{if(_0x2c8620[0x0]['language']==_0x591edf(0x8b))var _0x219516=users[_0x591edf(0x8b)];else{if(_0x2c8620[0x0][_0x591edf(0xc5)]=='German')var _0x219516=users['German'];else{if(_0x2c8620[0x0][_0x591edf(0xc5)]==_0x591edf(0x93))var _0x219516=users[_0x591edf(0x93)];else{if(_0x2c8620[0x0][_0x591edf(0xc5)]==_0x591edf(0x9f))var _0x219516=users[_0x591edf(0x9f)];else{if(_0x2c8620[0x0][_0x591edf(0xc5)]==_0x591edf(0x90))var _0x219516=users[_0x591edf(0x95)];else{if(_0x2c8620[0x0][_0x591edf(0xc5)]==_0x591edf(0x6a))var _0x219516=users[_0x591edf(0x6a)];else{if(_0x2c8620[0x0][_0x591edf(0xc5)]==_0x591edf(0xa2))var _0x219516=users[_0x591edf(0xba)];}}}}}}}_0x3ea016[_0x591edf(0x97)](_0x591edf(0xb8),{'success':_0x23ead9[_0x591edf(0x6d)](_0x591edf(0xa1)),'errors':_0x23ead9[_0x591edf(0x6d)](_0x591edf(0x83)),'role':_0x19d66d,'profile':_0x582448,'payment':_0x40cf20,'payable':_0x94f43b,'receivable':_0x14f1a9,'master_shop':_0x2c8620,'language':_0x219516});}catch(_0x5a4d7f){console[_0x591edf(0x7f)](_0x5a4d7f);}}),router[a0_0x367710(0xc9)](a0_0x367710(0xb2),auth,async(_0x5bc935,_0x2d66b5)=>{const _0x1c207b=a0_0x367710;try{const _0xa5ffe7=new excelJS[(_0x1c207b(0xa5))](),_0xf8d0c4=_0xa5ffe7[_0x1c207b(0xa7)](_0x1c207b(0x7b));return _0xf8d0c4['columns']=[{'header':'ID','key':'PName','width':0xa},{'header':_0x1c207b(0xaf),'key':_0x1c207b(0x7d),'width':0xa},{'header':_0x1c207b(0xa0),'key':_0x1c207b(0x74),'width':0xa},{'header':_0x1c207b(0xbd),'key':_0x1c207b(0xbd),'width':0xa},{'header':_0x1c207b(0xbc),'key':'address','width':0xa},{'header':_0x1c207b(0x9e),'key':_0x1c207b(0x9e),'width':0xa},{'header':'email','key':_0x1c207b(0xb3),'width':0xa}],_0x2d66b5[_0x1c207b(0x69)](_0x1c207b(0xa9),_0x1c207b(0xb6)),_0x2d66b5['setHeader']('Content-Disposition',_0x1c207b(0x8c)),_0xa5ffe7[_0x1c207b(0x7e)][_0x1c207b(0xc1)](_0x2d66b5)['then'](()=>{const _0x3a6df5=_0x1c207b;_0x2d66b5[_0x3a6df5(0xc6)](0xc8);});}catch(_0x1868cd){_0x2d66b5[_0x1c207b(0xc6)](0x190)[_0x1c207b(0x92)]({'errors':_0x1868cd[_0x1c207b(0x87)]});}});function a0_0x5503(){const _0x202015=['Router','errors','/view/:id','body','customer_product_fule','message','customer_docs','user','/customer/view','Hindi','attachment;\x20filename=customer_Migration_File.xlsx','SheetNames','customer_data','648185PkRqel','Portuguese\x20(BR)','params','send','Spanish','payable_sum','Portuguese','customer','render','\x20Failed','customer\x20update\x20successfully','German','5762850TLOkpn','c_payments','save','mobile','French','SalesmanCode','success','Arabic\x20(ae)','post','redirect','Workbook','exports','addWorksheet','249936cUDaox','Content-Type','file','filename','933854PAWxnj','contactperson','../models/all_models','Name','41832RMjlrG','Sale','/products_export_migrate_file','email','English','landline','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','\x20added\x20successfully','customer_payment','multer','Arabic','name','address','SalesmanName','$reason','1237245zkwpKT','amount','write','utils','json','aggregate','language','status','reason','English\x20(US)','get','exceljs','372GRATuI','setHeader','Chinese','findById','findOne','flash','receivable_sum','/customer_import_migrate_file','element','public/Migration/','customer\x20add\x20successfully','receivable','PUnits','master','/view','map','../public/language/languages.json','2wufVVh','now','Customers','find','PBrands','xlsx','log','48916fqPlMr','234GRxmzY'];a0_0x5503=function(){return _0x202015;};return a0_0x5503();}const storage1=multer['diskStorage']({'destination':(_0x731dc4,_0x15c2a2,_0x556b02)=>{_0x556b02(null,'public/Migration');},'filename':(_0x10ea70,_0x21f5c0,_0x59a72e)=>{const _0x508768=a0_0x367710;_0x59a72e(null,Date[_0x508768(0x7a)]()+_0x21f5c0['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x367710(0xa3)](a0_0x367710(0x6f),auth,uploadMigrate['single'](a0_0x367710(0x86)),async(_0xe33baa,_0x43a4cf)=>{const _0x4f5a3e=a0_0x367710,_0x28d66c=_0xe33baa[_0x4f5a3e(0xaa)][_0x4f5a3e(0xab)],_0x125b72=await xlsx['readFile'](_0x4f5a3e(0x71)+_0x28d66c);let _0xc7b334=_0x125b72[_0x4f5a3e(0x8d)],_0x3dbafd=xlsx[_0x4f5a3e(0xc2)]['sheet_to_json'](_0x125b72['Sheets'][_0xc7b334[0x0]]);for(const _0x5cc3bc of _0x3dbafd){const _0x5c95fc=_0x5cc3bc['ID'],_0x44d305=_0x5cc3bc[_0x4f5a3e(0xaf)],_0x39d4de=_0x5cc3bc[_0x4f5a3e(0xa0)],_0x2f826b=_0x5cc3bc[_0x4f5a3e(0xbd)],_0x3c4f91=_0x5cc3bc['address'],_0xd58bf3=_0x5cc3bc[_0x4f5a3e(0x9e)],_0x531a28=_0x5cc3bc['email'];try{let _0x4cfe30=await customer[_0x4f5a3e(0x6c)]({'name':_0x44d305});if(!_0x4cfe30){const _0xb46162=new customer({'name':_0x44d305,'ID':_0x5c95fc,'SalesmanCode':_0x39d4de,'SalesmanName':_0x2f826b,'address':_0x3c4f91,'mobile':_0xd58bf3,'email':_0x531a28});_0x4cfe30=await _0xb46162['save'](),_0xe33baa[_0x4f5a3e(0x6d)]('success',_0x44d305+_0x4f5a3e(0xb7));}else _0xe33baa[_0x4f5a3e(0x6d)]('error',_0x44d305+_0x4f5a3e(0x98));}catch(_0x1316fe){_0x43a4cf[_0x4f5a3e(0xc6)](0x1f4)[_0x4f5a3e(0xc3)]({'proderror':_0x1316fe[_0x4f5a3e(0x87)],'aproduct':ProductName});}}_0x43a4cf[_0x4f5a3e(0xa4)](_0x4f5a3e(0x8a));}),module[a0_0x367710(0xa6)]=router;