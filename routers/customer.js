const a0_0x44b518=a0_0x5b2d;(function(_0x74b7c6,_0x4179da){const _0x422978=a0_0x5b2d,_0x6f3420=_0x74b7c6();while(!![]){try{const _0x55ed5c=-parseInt(_0x422978(0xc7))/0x1+-parseInt(_0x422978(0xb4))/0x2+-parseInt(_0x422978(0xfd))/0x3+parseInt(_0x422978(0x106))/0x4+parseInt(_0x422978(0xfe))/0x5+-parseInt(_0x422978(0xd8))/0x6*(parseInt(_0x422978(0xd0))/0x7)+parseInt(_0x422978(0xda))/0x8;if(_0x55ed5c===_0x4179da)break;else _0x6f3420['push'](_0x6f3420['shift']());}catch(_0x35c808){_0x6f3420['push'](_0x6f3420['shift']());}}}(a0_0x2116,0xec617));const express=require(a0_0x44b518(0xd1)),app=express(),router=express[a0_0x44b518(0xf6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require(a0_0x44b518(0xb8)),users=require(a0_0x44b518(0x108)),excelJS=require(a0_0x44b518(0x114)),xlsx=require(a0_0x44b518(0xfb)),multer=require(a0_0x44b518(0xea));function a0_0x5b2d(_0x42ecd5,_0x27de5c){const _0x211671=a0_0x2116();return a0_0x5b2d=function(_0x5b2d66,_0x2208e1){_0x5b2d66=_0x5b2d66-0xb4;let _0x16eca=_0x211671[_0x5b2d66];return _0x16eca;},a0_0x5b2d(_0x42ecd5,_0x27de5c);}router['get'](a0_0x44b518(0xcd),auth,async(_0x3d6f93,_0x24b1c2)=>{const _0x53aae6=a0_0x44b518;try{const {username:_0x17afa0,email:_0x1045db,role:_0x17b603}=_0x3d6f93[_0x53aae6(0x11d)],_0x19d6f7=_0x3d6f93[_0x53aae6(0x11d)],_0x59b253=await profile[_0x53aae6(0xdd)]({'email':_0x19d6f7[_0x53aae6(0x118)]}),_0x3f0ad8=await master_shop[_0x53aae6(0xe1)]();console['log']('master',_0x3f0ad8);const _0x216a81=await customer[_0x53aae6(0xe1)](),_0x1faa7b=await customer['aggregate']([{'$lookup':{'from':_0x53aae6(0xfa),'localField':_0x53aae6(0x10c),'foreignField':_0x53aae6(0xc8),'as':_0x53aae6(0xd6)}}]);console[_0x53aae6(0xde)](_0x1faa7b);const _0x3c25cf=_0x1faa7b[_0x53aae6(0xdf)](_0x27a395=>{const _0x59a485=_0x53aae6;console['log'](_0x59a485(0xc3),_0x27a395);var _0x4639dd=0x0,_0x3b6db3=0x0;return _0x27a395[_0x59a485(0xd6)]['forEach'](_0xaa1c0e=>{const _0x4135d9=_0x59a485;console['log'](_0x4135d9(0x117),_0xaa1c0e),_0xaa1c0e[_0x4135d9(0xee)]=='Sale'?_0x4639dd+=_0xaa1c0e[_0x4135d9(0xc2)]:_0x3b6db3+=_0xaa1c0e[_0x4135d9(0xc2)];}),_0x27a395[_0x59a485(0xf9)]=parseFloat(_0x4639dd)+0x0,_0x27a395['sale_return']=parseFloat(_0x3b6db3)+0x0,_0x27a395;});console[_0x53aae6(0xde)](_0x53aae6(0xcf),_0x3c25cf);if(_0x3f0ad8[0x0][_0x53aae6(0xb6)]==_0x53aae6(0x102)){var _0x328612=users[_0x53aae6(0xe5)];console[_0x53aae6(0xde)](_0x328612);}else{if(_0x3f0ad8[0x0][_0x53aae6(0xb6)]==_0x53aae6(0xc9))var _0x328612=users['Hindi'];else{if(_0x3f0ad8[0x0]['language']==_0x53aae6(0xbe))var _0x328612=users[_0x53aae6(0xbe)];else{if(_0x3f0ad8[0x0][_0x53aae6(0xb6)]==_0x53aae6(0xe4))var _0x328612=users[_0x53aae6(0xe4)];else{if(_0x3f0ad8[0x0][_0x53aae6(0xb6)]=='French')var _0x328612=users[_0x53aae6(0x115)];else{if(_0x3f0ad8[0x0]['language']=='Portuguese\x20(BR)')var _0x328612=users[_0x53aae6(0x104)];else{if(_0x3f0ad8[0x0][_0x53aae6(0xb6)]=='Chinese')var _0x328612=users[_0x53aae6(0xe2)];else{if(_0x3f0ad8[0x0][_0x53aae6(0xb6)]==_0x53aae6(0x113))var _0x328612=users[_0x53aae6(0xe7)];}}}}}}}_0x24b1c2[_0x53aae6(0x11c)](_0x53aae6(0xc8),{'success':_0x3d6f93['flash']('success'),'errors':_0x3d6f93[_0x53aae6(0xec)](_0x53aae6(0x111)),'user':_0x216a81,'role':_0x19d6f7,'profile':_0x59b253,'payment':_0x3c25cf,'master_shop':_0x3f0ad8,'language':_0x328612});}catch(_0x43f3f0){console[_0x53aae6(0xde)](_0x43f3f0);}}),router[a0_0x44b518(0x103)](a0_0x44b518(0xcd),auth,async(_0x17babf,_0x4ef1da)=>{const _0x30f4db=a0_0x44b518;try{const {name:_0x1a2dd5,address:_0x4430ca,mobile:_0x3e3220,email:_0x3303d2,receivable:_0x25505f,payable:_0x57a0e6,contactperson:_0x2d210c,landline:_0x4c3a9c}=_0x17babf[_0x30f4db(0xd3)],_0x4992f6=new customer({'name':_0x1a2dd5,'address':_0x4430ca,'mobile':_0x3e3220,'email':_0x3303d2,'receivable':_0x25505f,'payable':_0x57a0e6,'contactperson':_0x2d210c,'landline':_0x4c3a9c}),_0x3c9d15=await _0x4992f6[_0x30f4db(0x11a)]();_0x17babf['flash'](_0x30f4db(0xe9),_0x30f4db(0xca)),_0x4ef1da[_0x30f4db(0x112)]('/customer/view');}catch(_0xa3abe3){console[_0x30f4db(0xde)](_0xa3abe3);}}),router[a0_0x44b518(0xd5)](a0_0x44b518(0x10b),auth,async(_0x45bd79,_0x18d6ad)=>{const _0x237a8c=a0_0x44b518;try{const {username:_0xc90820,email:_0x52e361,role:_0x24b26d}=_0x45bd79['user'],_0x5280cf=_0x45bd79['user'],_0x2c659f=await profile[_0x237a8c(0xdd)]({'email':_0x5280cf[_0x237a8c(0x118)]}),_0x29eed6=await master_shop[_0x237a8c(0xe1)]();console[_0x237a8c(0xde)](_0x237a8c(0x100),_0x29eed6);const _0x5878b8=_0x45bd79[_0x237a8c(0xdb)]['id'],_0x35824f=await customer[_0x237a8c(0xe0)](_0x5878b8);if(_0x29eed6[0x0][_0x237a8c(0xb6)]=='English\x20(US)'){var _0x36afac=users[_0x237a8c(0xe5)];console[_0x237a8c(0xde)](_0x36afac);}else{if(_0x29eed6[0x0][_0x237a8c(0xb6)]=='Hindi')var _0x36afac=users[_0x237a8c(0xc9)];else{if(_0x29eed6[0x0]['language']==_0x237a8c(0xbe))var _0x36afac=users[_0x237a8c(0xbe)];else{if(_0x29eed6[0x0][_0x237a8c(0xb6)]==_0x237a8c(0xe4))var _0x36afac=users[_0x237a8c(0xe4)];else{if(_0x29eed6[0x0][_0x237a8c(0xb6)]=='French')var _0x36afac=users[_0x237a8c(0x115)];else{if(_0x29eed6[0x0][_0x237a8c(0xb6)]=='Portuguese\x20(BR)')var _0x36afac=users[_0x237a8c(0x104)];else{if(_0x29eed6[0x0][_0x237a8c(0xb6)]==_0x237a8c(0xe2))var _0x36afac=users[_0x237a8c(0xe2)];else{if(_0x29eed6[0x0][_0x237a8c(0xb6)]==_0x237a8c(0x113))var _0x36afac=users['Arabic'];}}}}}}}_0x18d6ad[_0x237a8c(0x11c)]('customer',{'success':_0x45bd79[_0x237a8c(0xec)](_0x237a8c(0xe9)),'errors':_0x45bd79[_0x237a8c(0xec)](_0x237a8c(0x111)),'role':_0x5280cf,'profile':_0x2c659f,'user':_0x35824f,'master_shop':_0x29eed6,'language':_0x36afac});}catch(_0x5b4576){console['log'](_0x5b4576);}}),router['post'](a0_0x44b518(0x10b),auth,async(_0x1f905f,_0x3c7200)=>{const _0x364697=a0_0x44b518;try{const _0x2aeec2=_0x1f905f[_0x364697(0xdb)]['id'],_0x3543cb=await customer['findById'](_0x2aeec2),{name:_0x5acc74,address:_0x205571,mobile:_0x3fbe28,email:_0xea1f85,receivable:_0x5437d8,payable:_0x4acf64,contactperson:_0xe59d62,landline:_0x558bf3}=_0x1f905f[_0x364697(0xd3)];_0x3543cb[_0x364697(0x10c)]=_0x5acc74,_0x3543cb[_0x364697(0x110)]=_0x205571,_0x3543cb[_0x364697(0xc6)]=_0x3fbe28,_0x3543cb[_0x364697(0x118)]=_0xea1f85,_0x3543cb[_0x364697(0xf5)]=_0x5437d8,_0x3543cb[_0x364697(0x101)]=_0x4acf64,_0x3543cb[_0x364697(0xc1)]=_0xe59d62,_0x3543cb[_0x364697(0xeb)]=_0x558bf3;const _0x581b6a=await _0x3543cb[_0x364697(0x11a)]();_0x1f905f[_0x364697(0xec)]('success',_0x364697(0xd4)),_0x3c7200[_0x364697(0x112)]('/customer/view');}catch(_0x4df230){console[_0x364697(0xde)](_0x4df230);}}),router['get'](a0_0x44b518(0xe3),auth,async(_0x5cfac1,_0x519d0f)=>{const _0x365320=a0_0x44b518;try{const {username:_0x4cc565,email:_0x4a9bcd,role:_0x277975}=_0x5cfac1['user'],_0x5c9d26=_0x5cfac1['user'],_0x119ac7=await profile['findOne']({'email':_0x5c9d26['email']}),_0x3b621b=await master_shop['find']();console['log'](_0x365320(0x100),_0x3b621b),console['log'](_0x5cfac1[_0x365320(0xdb)]['id']);const _0xcc9a03=await customer[_0x365320(0xdd)]({'_id':_0x5cfac1[_0x365320(0xdb)]['id']});console['log'](_0x365320(0xf3),_0xcc9a03);const _0x186008=await c_payment_data[_0x365320(0xe1)]({'customer':_0xcc9a03[_0x365320(0x10c)]});console['log'](_0x186008);const _0xd81732=await c_payment_data['aggregate']([{'$match':{'customer':_0xcc9a03[_0x365320(0x10c)]}},{'$match':{'reason':_0x365320(0xff)}},{'$group':{'_id':_0x365320(0xfc),'sum':{'$sum':_0x365320(0x105)}}}]);console[_0x365320(0xde)](_0x365320(0xf0),_0xd81732);const _0x389d39=await c_payment_data['aggregate']([{'$match':{'customer':_0xcc9a03[_0x365320(0x10c)]}},{'$match':{'reason':_0x365320(0xbd)}},{'$group':{'_id':_0x365320(0xfc),'sum':{'$sum':'$amount'}}}]);console[_0x365320(0xde)](_0x365320(0xd2),_0x389d39);if(_0x3b621b[0x0][_0x365320(0xb6)]==_0x365320(0x102)){var _0x40757f=users['English'];console[_0x365320(0xde)](_0x40757f);}else{if(_0x3b621b[0x0][_0x365320(0xb6)]==_0x365320(0xc9))var _0x40757f=users[_0x365320(0xc9)];else{if(_0x3b621b[0x0][_0x365320(0xb6)]==_0x365320(0xbe))var _0x40757f=users['German'];else{if(_0x3b621b[0x0][_0x365320(0xb6)]==_0x365320(0xe4))var _0x40757f=users['Spanish'];else{if(_0x3b621b[0x0][_0x365320(0xb6)]==_0x365320(0x115))var _0x40757f=users[_0x365320(0x115)];else{if(_0x3b621b[0x0][_0x365320(0xb6)]==_0x365320(0xf1))var _0x40757f=users['Portuguese'];else{if(_0x3b621b[0x0][_0x365320(0xb6)]=='Chinese')var _0x40757f=users[_0x365320(0xe2)];else{if(_0x3b621b[0x0][_0x365320(0xb6)]==_0x365320(0x113))var _0x40757f=users[_0x365320(0xe7)];}}}}}}}_0x519d0f[_0x365320(0x11c)](_0x365320(0x11b),{'success':_0x5cfac1[_0x365320(0xec)](_0x365320(0xe9)),'errors':_0x5cfac1[_0x365320(0xec)]('errors'),'role':_0x5c9d26,'profile':_0x119ac7,'payment':_0x186008,'payable':_0xd81732,'receivable':_0x389d39,'master_shop':_0x3b621b,'language':_0x40757f});}catch(_0x5b0bcf){console[_0x365320(0xde)](_0x5b0bcf);}}),router['get'](a0_0x44b518(0xcc),auth,async(_0x42df4c,_0x55eac4)=>{const _0x55f991=a0_0x44b518;try{const _0x522273=new excelJS[(_0x55f991(0xed))](),_0x8d025f=_0x522273[_0x55f991(0x10e)](_0x55f991(0xbb));return _0x8d025f['columns']=[{'header':'ID','key':_0x55f991(0x116),'width':0xa},{'header':_0x55f991(0xf2),'key':_0x55f991(0xd7),'width':0xa},{'header':'SalesmanCode','key':_0x55f991(0xf8),'width':0xa},{'header':_0x55f991(0xc5),'key':_0x55f991(0xc5),'width':0xa},{'header':_0x55f991(0x110),'key':_0x55f991(0x110),'width':0xa},{'header':_0x55f991(0xc6),'key':_0x55f991(0xc6),'width':0xa},{'header':_0x55f991(0x118),'key':_0x55f991(0x118),'width':0xa}],_0x55eac4[_0x55f991(0x10d)]('Content-Type',_0x55f991(0xbc)),_0x55eac4[_0x55f991(0x10d)](_0x55f991(0xc0),_0x55f991(0xb5)),_0x522273['xlsx']['write'](_0x55eac4)[_0x55f991(0x119)](()=>{const _0x4e747e=_0x55f991;_0x55eac4[_0x4e747e(0xef)](0xc8);});}catch(_0x50fae5){_0x55eac4[_0x55f991(0xef)](0x190)[_0x55f991(0xc4)]({'errors':_0x50fae5[_0x55f991(0xbf)]});}});const storage1=multer[a0_0x44b518(0xf7)]({'destination':(_0xaf4916,_0xf0a216,_0x585586)=>{_0x585586(null,'public/Migration');},'filename':(_0x46176c,_0x4ec414,_0x3c5516)=>{const _0x1b39bd=a0_0x44b518;_0x3c5516(null,Date[_0x1b39bd(0x10a)]()+_0x4ec414['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x44b518(0x103)](a0_0x44b518(0xb9),auth,uploadMigrate['single'](a0_0x44b518(0xce)),async(_0x4f68ea,_0x5ca2aa)=>{const _0x2806b3=a0_0x44b518,_0x4f2293=_0x4f68ea[_0x2806b3(0xe6)][_0x2806b3(0x107)],_0x2ddb8c=await xlsx['readFile'](_0x2806b3(0x109)+_0x4f2293);let _0x568f90=_0x2ddb8c[_0x2806b3(0x10f)],_0x3184a6=xlsx['utils']['sheet_to_json'](_0x2ddb8c[_0x2806b3(0xf4)][_0x568f90[0x0]]);for(const _0x7665f7 of _0x3184a6){const _0x4b3d3c=_0x7665f7['ID'],_0x932312=_0x7665f7['Name'],_0x2f6e94=_0x7665f7[_0x2806b3(0xd9)],_0x6a2b10=_0x7665f7[_0x2806b3(0xc5)],_0x5629e4=_0x7665f7['address'],_0x18843b=_0x7665f7[_0x2806b3(0xc6)],_0x4e16d1=_0x7665f7[_0x2806b3(0x118)];try{let _0x1e23de=await customer[_0x2806b3(0xdd)]({'name':_0x932312});if(!_0x1e23de){const _0x373be1=new customer({'name':_0x932312,'ID':_0x4b3d3c,'SalesmanCode':_0x2f6e94,'SalesmanName':_0x6a2b10,'address':_0x5629e4,'mobile':_0x18843b,'email':_0x4e16d1});_0x1e23de=await _0x373be1[_0x2806b3(0x11a)](),_0x4f68ea['flash'](_0x2806b3(0xe9),_0x932312+_0x2806b3(0xb7));}else _0x4f68ea[_0x2806b3(0xec)]('error',_0x932312+_0x2806b3(0xba));}catch(_0x1abe44){_0x5ca2aa[_0x2806b3(0xef)](0x1f4)[_0x2806b3(0xdc)]({'proderror':_0x1abe44[_0x2806b3(0xbf)],'aproduct':ProductName});}}_0x5ca2aa[_0x2806b3(0x112)](_0x2806b3(0xcb));}),module[a0_0x44b518(0xe8)]=router;function a0_0x2116(){const _0x3e3051=['/view/payment/:id','Spanish','English','file','Arabic','exports','success','multer','landline','flash','Workbook','reason','status','payable_sum','Portuguese\x20(BR)','Name','customer_data','Sheets','receivable','Router','diskStorage','PUnits','sale','c_payments','xlsx','$reason','1992669BjHloD','5571765MBMdyM','Sale','master','payable','English\x20(US)','post','Portuguese','$amount','6479464svkkFo','filename','../public/language/languages.json','public/Migration/','now','/view/:id','name','setHeader','addWorksheet','SheetNames','address','errors','redirect','Arabic\x20(ae)','exceljs','French','PName','element','email','then','save','customer_payment','render','user','430234xupnmp','attachment;\x20filename=customer_Migration_File.xlsx','language','\x20added\x20successfully','../middleware/auth','/customer_import_migrate_file','\x20Failed','Customers','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Sale\x20Return','German','message','Content-Disposition','contactperson','amount','data','send','SalesmanName','mobile','1450804pnVGAA','customer','Hindi','customer\x20add\x20successfully','/customer/view','/products_export_migrate_file','/view','customer_product_fule','payment_data','13048BjUhlK','express','receivable_sum','body','customer\x20update\x20successfully','get','customer_docs','PBrands','366GgNtck','SalesmanCode','5422752bZtEzC','params','json','findOne','log','map','findById','find','Chinese'];a0_0x2116=function(){return _0x3e3051;};return a0_0x2116();}