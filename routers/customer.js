const a0_0x313217=a0_0x3e8c;(function(_0x160d24,_0x531f21){const _0x30f00e=a0_0x3e8c,_0x14c5e5=_0x160d24();while(!![]){try{const _0x5d128e=-parseInt(_0x30f00e(0x14c))/0x1+parseInt(_0x30f00e(0x12b))/0x2*(-parseInt(_0x30f00e(0x175))/0x3)+parseInt(_0x30f00e(0x114))/0x4+-parseInt(_0x30f00e(0x135))/0x5*(parseInt(_0x30f00e(0x173))/0x6)+-parseInt(_0x30f00e(0x119))/0x7*(-parseInt(_0x30f00e(0x14b))/0x8)+parseInt(_0x30f00e(0x13e))/0x9+-parseInt(_0x30f00e(0x110))/0xa*(-parseInt(_0x30f00e(0x147))/0xb);if(_0x5d128e===_0x531f21)break;else _0x14c5e5['push'](_0x14c5e5['shift']());}catch(_0x1a7dfb){_0x14c5e5['push'](_0x14c5e5['shift']());}}}(a0_0x4d6b,0x750e1));const express=require(a0_0x313217(0x137)),app=express(),router=express[a0_0x313217(0x164)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x313217(0x159)),auth=require(a0_0x313217(0x174)),users=require(a0_0x313217(0x118)),excelJS=require(a0_0x313217(0x11b)),xlsx=require(a0_0x313217(0x11f)),multer=require('multer');router[a0_0x313217(0x14e)](a0_0x313217(0x16f),auth,async(_0x25deea,_0x2997ce)=>{const _0x1379c4=a0_0x313217;try{const {username:_0x39b170,email:_0x367d5b,role:_0x12c0ab}=_0x25deea[_0x1379c4(0x16e)],_0x365bbf=_0x25deea[_0x1379c4(0x16e)],_0xfaca6b=await profile[_0x1379c4(0x170)]({'email':_0x365bbf['email']}),_0x37e821=await master_shop[_0x1379c4(0x146)]();console['log'](_0x1379c4(0x15d),_0x37e821);const _0x2ae713=await customer[_0x1379c4(0x146)](),_0x4ac11e=await customer[_0x1379c4(0x112)]([{'$lookup':{'from':_0x1379c4(0x11d),'localField':'name','foreignField':_0x1379c4(0x108),'as':_0x1379c4(0x153)}}]);console[_0x1379c4(0x165)](_0x4ac11e);const _0x2d602b=_0x4ac11e[_0x1379c4(0x172)](_0x21901b=>{const _0x6b5e16=_0x1379c4;console[_0x6b5e16(0x165)](_0x6b5e16(0x13c),_0x21901b);var _0x451e83=0x0,_0x58760a=0x0;return _0x21901b[_0x6b5e16(0x153)][_0x6b5e16(0x169)](_0xf4c512=>{const _0x455363=_0x6b5e16;console[_0x455363(0x165)](_0x455363(0x117),_0xf4c512),_0xf4c512[_0x455363(0x152)]==_0x455363(0x140)?_0x451e83+=_0xf4c512[_0x455363(0x15f)]:_0x58760a+=_0xf4c512[_0x455363(0x15f)];}),_0x21901b['sale']=parseFloat(_0x451e83)+0x0,_0x21901b[_0x6b5e16(0x12a)]=parseFloat(_0x58760a)+0x0,_0x21901b;});console[_0x1379c4(0x165)](_0x1379c4(0x166),_0x2d602b);if(_0x37e821[0x0][_0x1379c4(0x10e)]=='English\x20(US)'){var _0x4adfa4=users[_0x1379c4(0x109)];console['log'](_0x4adfa4);}else{if(_0x37e821[0x0][_0x1379c4(0x10e)]==_0x1379c4(0x145))var _0x4adfa4=users[_0x1379c4(0x145)];else{if(_0x37e821[0x0][_0x1379c4(0x10e)]==_0x1379c4(0x11e))var _0x4adfa4=users[_0x1379c4(0x11e)];else{if(_0x37e821[0x0][_0x1379c4(0x10e)]=='Spanish')var _0x4adfa4=users[_0x1379c4(0x133)];else{if(_0x37e821[0x0][_0x1379c4(0x10e)]=='French')var _0x4adfa4=users['French'];else{if(_0x37e821[0x0][_0x1379c4(0x10e)]=='Portuguese\x20(BR)')var _0x4adfa4=users[_0x1379c4(0x148)];else{if(_0x37e821[0x0][_0x1379c4(0x10e)]==_0x1379c4(0x162))var _0x4adfa4=users[_0x1379c4(0x162)];else{if(_0x37e821[0x0][_0x1379c4(0x10e)]==_0x1379c4(0x13d))var _0x4adfa4=users[_0x1379c4(0x12d)];}}}}}}}_0x2997ce[_0x1379c4(0x13b)](_0x1379c4(0x108),{'success':_0x25deea['flash']('success'),'errors':_0x25deea['flash'](_0x1379c4(0x157)),'user':_0x2ae713,'role':_0x365bbf,'profile':_0xfaca6b,'payment':_0x2d602b,'master_shop':_0x37e821,'language':_0x4adfa4});}catch(_0x4e66fe){console['log'](_0x4e66fe);}}),router[a0_0x313217(0x123)](a0_0x313217(0x16f),auth,async(_0x378a1e,_0x2c30e7)=>{const _0xf07826=a0_0x313217;try{const {name:_0xe24840,address:_0x4e9fcc,mobile:_0x279335,email:_0x31397d,receivable:_0x1e76bc,payable:_0x442956,contactperson:_0x39ca0d,landline:_0x28e008}=_0x378a1e[_0xf07826(0x138)],_0x3e7504=new customer({'name':_0xe24840,'address':_0x4e9fcc,'mobile':_0x279335,'email':_0x31397d,'receivable':_0x1e76bc,'payable':_0x442956,'contactperson':_0x39ca0d,'landline':_0x28e008}),_0x5912f4=await _0x3e7504[_0xf07826(0x14f)]();_0x378a1e['flash'](_0xf07826(0x111),_0xf07826(0x10a)),_0x2c30e7[_0xf07826(0x132)](_0xf07826(0x15c));}catch(_0x2016f9){console[_0xf07826(0x165)](_0x2016f9);}}),router['get'](a0_0x313217(0x151),auth,async(_0x238d9c,_0x3097de)=>{const _0x27ec3=a0_0x313217;try{const {username:_0x54f358,email:_0x19ad02,role:_0x5a2293}=_0x238d9c[_0x27ec3(0x16e)],_0x3b8058=_0x238d9c[_0x27ec3(0x16e)],_0x11583c=await profile[_0x27ec3(0x170)]({'email':_0x3b8058[_0x27ec3(0x12f)]}),_0x110603=await master_shop['find']();console[_0x27ec3(0x165)]('master',_0x110603);const _0x2eefac=_0x238d9c['params']['id'],_0x1edebf=await customer[_0x27ec3(0x16c)](_0x2eefac);if(_0x110603[0x0][_0x27ec3(0x10e)]==_0x27ec3(0x12e)){var _0x377156=users['English'];console[_0x27ec3(0x165)](_0x377156);}else{if(_0x110603[0x0]['language']==_0x27ec3(0x145))var _0x377156=users[_0x27ec3(0x145)];else{if(_0x110603[0x0][_0x27ec3(0x10e)]=='German')var _0x377156=users['German'];else{if(_0x110603[0x0][_0x27ec3(0x10e)]=='Spanish')var _0x377156=users[_0x27ec3(0x133)];else{if(_0x110603[0x0][_0x27ec3(0x10e)]==_0x27ec3(0x10f))var _0x377156=users['French'];else{if(_0x110603[0x0][_0x27ec3(0x10e)]==_0x27ec3(0x125))var _0x377156=users[_0x27ec3(0x148)];else{if(_0x110603[0x0][_0x27ec3(0x10e)]=='Chinese')var _0x377156=users[_0x27ec3(0x162)];else{if(_0x110603[0x0]['language']==_0x27ec3(0x13d))var _0x377156=users[_0x27ec3(0x12d)];}}}}}}}_0x3097de[_0x27ec3(0x13b)](_0x27ec3(0x108),{'success':_0x238d9c[_0x27ec3(0x107)](_0x27ec3(0x111)),'errors':_0x238d9c[_0x27ec3(0x107)](_0x27ec3(0x157)),'role':_0x3b8058,'profile':_0x11583c,'user':_0x1edebf,'master_shop':_0x110603,'language':_0x377156});}catch(_0x48ca79){console['log'](_0x48ca79);}}),router['post'](a0_0x313217(0x151),auth,async(_0x1d71e4,_0x4dc06d)=>{const _0x4d7e8e=a0_0x313217;try{const _0x471097=_0x1d71e4['params']['id'],_0x10a9cb=await customer[_0x4d7e8e(0x16c)](_0x471097),{name:_0x2ec3e0,address:_0x2480d6,mobile:_0xb93c1f,email:_0x11aba3,receivable:_0x3e3f81,payable:_0x25659a,contactperson:_0x228be6,landline:_0x4d2337}=_0x1d71e4[_0x4d7e8e(0x138)];_0x10a9cb[_0x4d7e8e(0x171)]=_0x2ec3e0,_0x10a9cb[_0x4d7e8e(0x163)]=_0x2480d6,_0x10a9cb[_0x4d7e8e(0x129)]=_0xb93c1f,_0x10a9cb[_0x4d7e8e(0x12f)]=_0x11aba3,_0x10a9cb[_0x4d7e8e(0x14a)]=_0x3e3f81,_0x10a9cb['payable']=_0x25659a,_0x10a9cb['contactperson']=_0x228be6,_0x10a9cb[_0x4d7e8e(0x15e)]=_0x4d2337;const _0x2ab13a=await _0x10a9cb[_0x4d7e8e(0x14f)]();_0x1d71e4[_0x4d7e8e(0x107)]('success',_0x4d7e8e(0x120)),_0x4dc06d['redirect'](_0x4d7e8e(0x15c));}catch(_0x142582){console[_0x4d7e8e(0x165)](_0x142582);}}),router[a0_0x313217(0x14e)]('/view/payment/:id',auth,async(_0x183a31,_0x531487)=>{const _0x4650b8=a0_0x313217;try{const {username:_0x546331,email:_0x120524,role:_0x12df59}=_0x183a31[_0x4650b8(0x16e)],_0x20cc0e=_0x183a31['user'],_0x40c12c=await profile[_0x4650b8(0x170)]({'email':_0x20cc0e[_0x4650b8(0x12f)]}),_0x46f062=await master_shop['find']();console[_0x4650b8(0x165)](_0x4650b8(0x15d),_0x46f062),console['log'](_0x183a31['params']['id']);const _0x48a518=await customer[_0x4650b8(0x170)]({'_id':_0x183a31[_0x4650b8(0x15a)]['id']});console['log'](_0x4650b8(0x122),_0x48a518);const _0xb175e1=await c_payment_data[_0x4650b8(0x146)]({'customer':_0x48a518[_0x4650b8(0x171)]});console['log'](_0xb175e1);const _0x4f07f8=await c_payment_data[_0x4650b8(0x112)]([{'$match':{'customer':_0x48a518[_0x4650b8(0x171)]}},{'$match':{'reason':_0x4650b8(0x140)}},{'$group':{'_id':_0x4650b8(0x127),'sum':{'$sum':_0x4650b8(0x161)}}}]);console['log'](_0x4650b8(0x155),_0x4f07f8);const _0x1cc838=await c_payment_data[_0x4650b8(0x112)]([{'$match':{'customer':_0x48a518[_0x4650b8(0x171)]}},{'$match':{'reason':_0x4650b8(0x158)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x4650b8(0x161)}}}]);console[_0x4650b8(0x165)](_0x4650b8(0x141),_0x1cc838);if(_0x46f062[0x0][_0x4650b8(0x10e)]==_0x4650b8(0x12e)){var _0x429dcf=users[_0x4650b8(0x109)];console['log'](_0x429dcf);}else{if(_0x46f062[0x0][_0x4650b8(0x10e)]==_0x4650b8(0x145))var _0x429dcf=users['Hindi'];else{if(_0x46f062[0x0][_0x4650b8(0x10e)]==_0x4650b8(0x11e))var _0x429dcf=users[_0x4650b8(0x11e)];else{if(_0x46f062[0x0][_0x4650b8(0x10e)]=='Spanish')var _0x429dcf=users[_0x4650b8(0x133)];else{if(_0x46f062[0x0][_0x4650b8(0x10e)]==_0x4650b8(0x10f))var _0x429dcf=users[_0x4650b8(0x10f)];else{if(_0x46f062[0x0][_0x4650b8(0x10e)]==_0x4650b8(0x125))var _0x429dcf=users[_0x4650b8(0x148)];else{if(_0x46f062[0x0]['language']==_0x4650b8(0x162))var _0x429dcf=users[_0x4650b8(0x162)];else{if(_0x46f062[0x0]['language']=='Arabic\x20(ae)')var _0x429dcf=users[_0x4650b8(0x12d)];}}}}}}}_0x531487[_0x4650b8(0x13b)](_0x4650b8(0x167),{'success':_0x183a31[_0x4650b8(0x107)]('success'),'errors':_0x183a31[_0x4650b8(0x107)](_0x4650b8(0x157)),'role':_0x20cc0e,'profile':_0x40c12c,'payment':_0xb175e1,'payable':_0x4f07f8,'receivable':_0x1cc838,'master_shop':_0x46f062,'language':_0x429dcf});}catch(_0x44f7ff){console[_0x4650b8(0x165)](_0x44f7ff);}}),router[a0_0x313217(0x14e)](a0_0x313217(0x13f),auth,async(_0xc07483,_0x43bba2)=>{const _0x40a119=a0_0x313217;try{const _0x273c96=new excelJS[(_0x40a119(0x12c))](),_0x4e967a=_0x273c96[_0x40a119(0x10c)](_0x40a119(0x10b));return _0x4e967a[_0x40a119(0x160)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x40a119(0x139),'key':_0x40a119(0x130),'width':0xa},{'header':'SalesmanCode','key':_0x40a119(0x16a),'width':0xa},{'header':_0x40a119(0x14d),'key':_0x40a119(0x14d),'width':0xa},{'header':_0x40a119(0x163),'key':_0x40a119(0x163),'width':0xa},{'header':_0x40a119(0x129),'key':'mobile','width':0xa},{'header':_0x40a119(0x12f),'key':'email','width':0xa}],_0x43bba2[_0x40a119(0x15b)](_0x40a119(0x128),_0x40a119(0x136)),_0x43bba2[_0x40a119(0x15b)]('Content-Disposition',_0x40a119(0x126)),_0x273c96[_0x40a119(0x11f)][_0x40a119(0x115)](_0x43bba2)[_0x40a119(0x142)](()=>{_0x43bba2['status'](0xc8);});}catch(_0x6b6784){_0x43bba2[_0x40a119(0x131)](0x190)['send']({'errors':_0x6b6784[_0x40a119(0x156)]});}});function a0_0x3e8c(_0x29bed6,_0x159fb2){const _0x4d6bde=a0_0x4d6b();return a0_0x3e8c=function(_0x3e8c7b,_0x247001){_0x3e8c7b=_0x3e8c7b-0x107;let _0x433528=_0x4d6bde[_0x3e8c7b];return _0x433528;},a0_0x3e8c(_0x29bed6,_0x159fb2);}const storage1=multer[a0_0x313217(0x143)]({'destination':(_0x2c53c9,_0xc788f,_0x33872a)=>{_0x33872a(null,'public/Migration');},'filename':(_0x21f970,_0x48e81b,_0xc5dcff)=>{const _0x5b0d93=a0_0x313217;_0xc5dcff(null,Date[_0x5b0d93(0x16d)]()+_0x48e81b['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x313217(0x123)](a0_0x313217(0x150),auth,uploadMigrate[a0_0x313217(0x113)](a0_0x313217(0x134)),async(_0x6b3f51,_0x144e53)=>{const _0x514f06=a0_0x313217,_0x1b89c9=_0x6b3f51[_0x514f06(0x144)][_0x514f06(0x121)],_0xb9da88=await xlsx[_0x514f06(0x154)](_0x514f06(0x11c)+_0x1b89c9);let _0x57f4f=_0xb9da88[_0x514f06(0x149)],_0x26bf55=xlsx[_0x514f06(0x10d)][_0x514f06(0x116)](_0xb9da88[_0x514f06(0x168)][_0x57f4f[0x0]]);for(const _0x499a92 of _0x26bf55){const _0x570179=_0x499a92['ID'],_0x636c4b=_0x499a92[_0x514f06(0x139)],_0x54f8d4=_0x499a92[_0x514f06(0x16b)],_0x1c6f6b=_0x499a92[_0x514f06(0x14d)],_0x13767f=_0x499a92['address'],_0x56765e=_0x499a92[_0x514f06(0x129)],_0x5769a4=_0x499a92[_0x514f06(0x12f)];try{let _0x2850f1=await customer[_0x514f06(0x170)]({'name':_0x636c4b});if(!_0x2850f1){const _0x3f56d9=new customer({'name':_0x636c4b,'ID':_0x570179,'SalesmanCode':_0x54f8d4,'SalesmanName':_0x1c6f6b,'address':_0x13767f,'mobile':_0x56765e,'email':_0x5769a4});_0x2850f1=await _0x3f56d9[_0x514f06(0x14f)](),_0x6b3f51[_0x514f06(0x107)]('success',_0x636c4b+_0x514f06(0x11a));}else _0x6b3f51[_0x514f06(0x107)]('error',_0x636c4b+_0x514f06(0x124));}catch(_0x392f50){_0x144e53[_0x514f06(0x131)](0x1f4)[_0x514f06(0x13a)]({'proderror':_0x392f50[_0x514f06(0x156)],'aproduct':ProductName});}}_0x144e53['redirect']('/customer/view');}),module['exports']=router;function a0_0x4d6b(){const _0x1ffca5=['language','French','467080EhytZg','success','aggregate','single','125252jbhSNl','write','sheet_to_json','element','../public/language/languages.json','539AuGDzw','\x20added\x20successfully','exceljs','public/Migration/','c_payments','German','xlsx','customer\x20update\x20successfully','filename','customer_data','post','\x20Failed','Portuguese\x20(BR)','attachment;\x20filename=customer_Migration_File.xlsx','$reason','Content-Type','mobile','sale_return','38vScgbR','Workbook','Arabic','English\x20(US)','email','PBrands','status','redirect','Spanish','customer_product_fule','4430dDNaFL','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','express','body','Name','json','render','data','Arabic\x20(ae)','6192837wlTSmg','/products_export_migrate_file','Sale','receivable_sum','then','diskStorage','file','Hindi','find','187XaHIlE','Portuguese','SheetNames','receivable','66352eGTEpL','533469TnIOzL','SalesmanName','get','save','/customer_import_migrate_file','/view/:id','reason','customer_docs','readFile','payable_sum','message','errors','Sale\x20Return','../models/all_models','params','setHeader','/customer/view','master','landline','amount','columns','$amount','Chinese','address','Router','log','payment_data','customer_payment','Sheets','forEach','PUnits','SalesmanCode','findById','now','user','/view','findOne','name','map','4764KSEOyY','../middleware/auth','68790URRnVF','flash','customer','English','customer\x20add\x20successfully','Customers','addWorksheet','utils'];a0_0x4d6b=function(){return _0x1ffca5;};return a0_0x4d6b();}