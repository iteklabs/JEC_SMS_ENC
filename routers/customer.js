const a0_0x2b83e9=a0_0x1a88;(function(_0x365e76,_0x58f6f7){const _0x1363d6=a0_0x1a88,_0x168325=_0x365e76();while(!![]){try{const _0x449c09=-parseInt(_0x1363d6(0x143))/0x1*(parseInt(_0x1363d6(0x146))/0x2)+-parseInt(_0x1363d6(0x161))/0x3+parseInt(_0x1363d6(0x11c))/0x4*(parseInt(_0x1363d6(0x130))/0x5)+parseInt(_0x1363d6(0x159))/0x6*(-parseInt(_0x1363d6(0x172))/0x7)+parseInt(_0x1363d6(0x155))/0x8*(-parseInt(_0x1363d6(0x115))/0x9)+parseInt(_0x1363d6(0x164))/0xa*(-parseInt(_0x1363d6(0x16d))/0xb)+-parseInt(_0x1363d6(0x11b))/0xc*(-parseInt(_0x1363d6(0x10e))/0xd);if(_0x449c09===_0x58f6f7)break;else _0x168325['push'](_0x168325['shift']());}catch(_0x23e5da){_0x168325['push'](_0x168325['shift']());}}}(a0_0x29cc,0x259c7));function a0_0x29cc(){const _0x6532dd=['c_payments','landline','forEach','\x20added\x20successfully','33WXOnWU','../models/all_models','payable_sum','render','/view','14vZMCyj','originalname','PName','Spanish','Content-Disposition','exports','Portuguese','French','Hindi','customer','Chinese','1281943hfrCxP','$amount','multer','/products_export_migrate_file','German','now','aggregate','381204dPVsbM','receivable','sale','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','email','SalesmanCode','60sHFrQy','2168rpOovQ','/customer_import_migrate_file','/view/payment/:id','../middleware/auth','Sale','amount','address','../public/language/languages.json','\x20Failed','sale_return','status','receivable_sum','express','Portuguese\x20(BR)','language','error','/customer/view','Arabic','params','attachment;\x20filename=customer_Migration_File.xlsx','335cAZYuH','customer_payment','setHeader','public/Migration/','customer_docs','Name','data','/view/:id','redirect','save','English\x20(US)','SheetNames','map','master','PUnits','customer\x20update\x20successfully','SalesmanName','success','findOne','3EKLcth','PBrands','errors','25186MKpEkX','reason','post','Sale\x20Return','customer_data','message','json','user','send','file','mobile','public/Migration','exceljs','findById','payment_data','32HNgajn','body','get','English','269298omyFbX','find','name','single','then','log','Arabic\x20(ae)','xlsx','212058KaDVjB','columns','customer\x20add\x20successfully','25530UvajRI','flash','payable','Workbook','readFile'];a0_0x29cc=function(){return _0x6532dd;};return a0_0x29cc();}const express=require(a0_0x2b83e9(0x128)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x2b83e9(0x16e)),auth=require(a0_0x2b83e9(0x11f)),users=require(a0_0x2b83e9(0x123)),excelJS=require(a0_0x2b83e9(0x152)),xlsx=require(a0_0x2b83e9(0x160)),multer=require(a0_0x2b83e9(0x110));router[a0_0x2b83e9(0x157)](a0_0x2b83e9(0x171),auth,async(_0x4353ae,_0x5b2106)=>{const _0x14f68e=a0_0x2b83e9;try{const {username:_0x53eb78,email:_0x4839b2,role:_0x1f99fb}=_0x4353ae[_0x14f68e(0x14d)],_0x145b69=_0x4353ae[_0x14f68e(0x14d)],_0x82b526=await profile[_0x14f68e(0x142)]({'email':_0x145b69[_0x14f68e(0x119)]}),_0x55f949=await master_shop[_0x14f68e(0x15a)]();console['log'](_0x14f68e(0x13d),_0x55f949);const _0x26bfd3=await customer[_0x14f68e(0x15a)](),_0x536a57=await customer[_0x14f68e(0x114)]([{'$lookup':{'from':_0x14f68e(0x169),'localField':_0x14f68e(0x15b),'foreignField':'customer','as':_0x14f68e(0x134)}}]);console[_0x14f68e(0x15e)](_0x536a57);const _0x17c86d=_0x536a57[_0x14f68e(0x13c)](_0x3151d6=>{const _0x5640c4=_0x14f68e;console['log'](_0x5640c4(0x136),_0x3151d6);var _0x197ba0=0x0,_0x5c4d9e=0x0;return _0x3151d6[_0x5640c4(0x134)][_0x5640c4(0x16b)](_0xd26c5e=>{const _0x4eca01=_0x5640c4;console[_0x4eca01(0x15e)]('element',_0xd26c5e),_0xd26c5e[_0x4eca01(0x147)]==_0x4eca01(0x120)?_0x197ba0+=_0xd26c5e['amount']:_0x5c4d9e+=_0xd26c5e[_0x4eca01(0x121)];}),_0x3151d6[_0x5640c4(0x117)]=parseFloat(_0x197ba0)+0x0,_0x3151d6[_0x5640c4(0x125)]=parseFloat(_0x5c4d9e)+0x0,_0x3151d6;});console[_0x14f68e(0x15e)](_0x14f68e(0x154),_0x17c86d);if(_0x55f949[0x0][_0x14f68e(0x12a)]==_0x14f68e(0x13a)){var _0xaf78e5=users[_0x14f68e(0x158)];console['log'](_0xaf78e5);}else{if(_0x55f949[0x0]['language']=='Hindi')var _0xaf78e5=users[_0x14f68e(0x10b)];else{if(_0x55f949[0x0][_0x14f68e(0x12a)]==_0x14f68e(0x112))var _0xaf78e5=users['German'];else{if(_0x55f949[0x0]['language']==_0x14f68e(0x175))var _0xaf78e5=users[_0x14f68e(0x175)];else{if(_0x55f949[0x0][_0x14f68e(0x12a)]=='French')var _0xaf78e5=users['French'];else{if(_0x55f949[0x0][_0x14f68e(0x12a)]==_0x14f68e(0x129))var _0xaf78e5=users[_0x14f68e(0x109)];else{if(_0x55f949[0x0][_0x14f68e(0x12a)]==_0x14f68e(0x10d))var _0xaf78e5=users['Chinese'];else{if(_0x55f949[0x0][_0x14f68e(0x12a)]==_0x14f68e(0x15f))var _0xaf78e5=users[_0x14f68e(0x12d)];}}}}}}}_0x5b2106[_0x14f68e(0x170)](_0x14f68e(0x10c),{'success':_0x4353ae[_0x14f68e(0x165)](_0x14f68e(0x141)),'errors':_0x4353ae['flash']('errors'),'user':_0x26bfd3,'role':_0x145b69,'profile':_0x82b526,'payment':_0x17c86d,'master_shop':_0x55f949,'language':_0xaf78e5});}catch(_0x55bed6){console[_0x14f68e(0x15e)](_0x55bed6);}}),router[a0_0x2b83e9(0x148)](a0_0x2b83e9(0x171),auth,async(_0x1956e6,_0x2ea3e3)=>{const _0x2103a4=a0_0x2b83e9;try{const {name:_0x5a2af1,address:_0x47b618,mobile:_0x3ae504,email:_0x51296a,receivable:_0x439ba5,payable:_0x3cc50b,contactperson:_0x46aa07,landline:_0x115dce}=_0x1956e6['body'],_0x1df04e=new customer({'name':_0x5a2af1,'address':_0x47b618,'mobile':_0x3ae504,'email':_0x51296a,'receivable':_0x439ba5,'payable':_0x3cc50b,'contactperson':_0x46aa07,'landline':_0x115dce}),_0x3580b5=await _0x1df04e[_0x2103a4(0x139)]();_0x1956e6[_0x2103a4(0x165)]('success',_0x2103a4(0x163)),_0x2ea3e3[_0x2103a4(0x138)](_0x2103a4(0x12c));}catch(_0x25c52c){console['log'](_0x25c52c);}}),router['get'](a0_0x2b83e9(0x137),auth,async(_0x5843c7,_0x483cda)=>{const _0x25e952=a0_0x2b83e9;try{const {username:_0x13c96e,email:_0x2fe3ac,role:_0x52ff6e}=_0x5843c7['user'],_0x2a86f6=_0x5843c7['user'],_0xe5d2df=await profile['findOne']({'email':_0x2a86f6['email']}),_0xb00dff=await master_shop[_0x25e952(0x15a)]();console[_0x25e952(0x15e)](_0x25e952(0x13d),_0xb00dff);const _0x550447=_0x5843c7[_0x25e952(0x12e)]['id'],_0x2ddc7d=await customer[_0x25e952(0x153)](_0x550447);if(_0xb00dff[0x0]['language']==_0x25e952(0x13a)){var _0x3f0e8b=users[_0x25e952(0x158)];console[_0x25e952(0x15e)](_0x3f0e8b);}else{if(_0xb00dff[0x0][_0x25e952(0x12a)]==_0x25e952(0x10b))var _0x3f0e8b=users[_0x25e952(0x10b)];else{if(_0xb00dff[0x0][_0x25e952(0x12a)]==_0x25e952(0x112))var _0x3f0e8b=users[_0x25e952(0x112)];else{if(_0xb00dff[0x0]['language']==_0x25e952(0x175))var _0x3f0e8b=users[_0x25e952(0x175)];else{if(_0xb00dff[0x0][_0x25e952(0x12a)]==_0x25e952(0x10a))var _0x3f0e8b=users[_0x25e952(0x10a)];else{if(_0xb00dff[0x0][_0x25e952(0x12a)]==_0x25e952(0x129))var _0x3f0e8b=users['Portuguese'];else{if(_0xb00dff[0x0][_0x25e952(0x12a)]==_0x25e952(0x10d))var _0x3f0e8b=users[_0x25e952(0x10d)];else{if(_0xb00dff[0x0][_0x25e952(0x12a)]==_0x25e952(0x15f))var _0x3f0e8b=users[_0x25e952(0x12d)];}}}}}}}_0x483cda[_0x25e952(0x170)](_0x25e952(0x10c),{'success':_0x5843c7[_0x25e952(0x165)](_0x25e952(0x141)),'errors':_0x5843c7[_0x25e952(0x165)](_0x25e952(0x145)),'role':_0x2a86f6,'profile':_0xe5d2df,'user':_0x2ddc7d,'master_shop':_0xb00dff,'language':_0x3f0e8b});}catch(_0x435694){console[_0x25e952(0x15e)](_0x435694);}}),router[a0_0x2b83e9(0x148)](a0_0x2b83e9(0x137),auth,async(_0x3fc72c,_0xc2a7ab)=>{const _0x491d8c=a0_0x2b83e9;try{const _0x3a36fd=_0x3fc72c['params']['id'],_0x34f642=await customer[_0x491d8c(0x153)](_0x3a36fd),{name:_0x473c13,address:_0x2ef676,mobile:_0x2e8f07,email:_0x4dc7f3,receivable:_0x1c0bcd,payable:_0x5a20c4,contactperson:_0x2cafc1,landline:_0x3ccade}=_0x3fc72c[_0x491d8c(0x156)];_0x34f642['name']=_0x473c13,_0x34f642[_0x491d8c(0x122)]=_0x2ef676,_0x34f642['mobile']=_0x2e8f07,_0x34f642[_0x491d8c(0x119)]=_0x4dc7f3,_0x34f642[_0x491d8c(0x116)]=_0x1c0bcd,_0x34f642[_0x491d8c(0x166)]=_0x5a20c4,_0x34f642['contactperson']=_0x2cafc1,_0x34f642[_0x491d8c(0x16a)]=_0x3ccade;const _0x21a3ab=await _0x34f642[_0x491d8c(0x139)]();_0x3fc72c[_0x491d8c(0x165)](_0x491d8c(0x141),_0x491d8c(0x13f)),_0xc2a7ab[_0x491d8c(0x138)]('/customer/view');}catch(_0x29d37d){console['log'](_0x29d37d);}}),router[a0_0x2b83e9(0x157)](a0_0x2b83e9(0x11e),auth,async(_0x212f80,_0x1694b5)=>{const _0x53e585=a0_0x2b83e9;try{const {username:_0x165b4f,email:_0x5cf997,role:_0x3dec1e}=_0x212f80[_0x53e585(0x14d)],_0x47f7fd=_0x212f80['user'],_0x21df30=await profile[_0x53e585(0x142)]({'email':_0x47f7fd[_0x53e585(0x119)]}),_0x2ed099=await master_shop[_0x53e585(0x15a)]();console[_0x53e585(0x15e)](_0x53e585(0x13d),_0x2ed099),console['log'](_0x212f80[_0x53e585(0x12e)]['id']);const _0x53de9e=await customer[_0x53e585(0x142)]({'_id':_0x212f80[_0x53e585(0x12e)]['id']});console[_0x53e585(0x15e)](_0x53e585(0x14a),_0x53de9e);const _0x537282=await c_payment_data[_0x53e585(0x15a)]({'customer':_0x53de9e[_0x53e585(0x15b)]});console[_0x53e585(0x15e)](_0x537282);const _0x195f98=await c_payment_data[_0x53e585(0x114)]([{'$match':{'customer':_0x53de9e[_0x53e585(0x15b)]}},{'$match':{'reason':'Sale'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x53e585(0x10f)}}}]);console[_0x53e585(0x15e)](_0x53e585(0x16f),_0x195f98);const _0x353cc9=await c_payment_data[_0x53e585(0x114)]([{'$match':{'customer':_0x53de9e[_0x53e585(0x15b)]}},{'$match':{'reason':_0x53e585(0x149)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x53e585(0x10f)}}}]);console[_0x53e585(0x15e)](_0x53e585(0x127),_0x353cc9);if(_0x2ed099[0x0][_0x53e585(0x12a)]==_0x53e585(0x13a)){var _0x266191=users[_0x53e585(0x158)];console[_0x53e585(0x15e)](_0x266191);}else{if(_0x2ed099[0x0][_0x53e585(0x12a)]==_0x53e585(0x10b))var _0x266191=users[_0x53e585(0x10b)];else{if(_0x2ed099[0x0]['language']==_0x53e585(0x112))var _0x266191=users[_0x53e585(0x112)];else{if(_0x2ed099[0x0][_0x53e585(0x12a)]==_0x53e585(0x175))var _0x266191=users[_0x53e585(0x175)];else{if(_0x2ed099[0x0][_0x53e585(0x12a)]==_0x53e585(0x10a))var _0x266191=users[_0x53e585(0x10a)];else{if(_0x2ed099[0x0]['language']==_0x53e585(0x129))var _0x266191=users['Portuguese'];else{if(_0x2ed099[0x0][_0x53e585(0x12a)]==_0x53e585(0x10d))var _0x266191=users['Chinese'];else{if(_0x2ed099[0x0][_0x53e585(0x12a)]==_0x53e585(0x15f))var _0x266191=users['Arabic'];}}}}}}}_0x1694b5[_0x53e585(0x170)](_0x53e585(0x131),{'success':_0x212f80[_0x53e585(0x165)]('success'),'errors':_0x212f80[_0x53e585(0x165)]('errors'),'role':_0x47f7fd,'profile':_0x21df30,'payment':_0x537282,'payable':_0x195f98,'receivable':_0x353cc9,'master_shop':_0x2ed099,'language':_0x266191});}catch(_0x591f7f){console[_0x53e585(0x15e)](_0x591f7f);}}),router[a0_0x2b83e9(0x157)](a0_0x2b83e9(0x111),auth,async(_0x54cb55,_0x63b56b)=>{const _0x131a50=a0_0x2b83e9;try{const _0x47f299=new excelJS[(_0x131a50(0x167))](),_0x315c15=_0x47f299['addWorksheet']('Customers');return _0x315c15[_0x131a50(0x162)]=[{'header':'ID','key':_0x131a50(0x174),'width':0xa},{'header':_0x131a50(0x135),'key':_0x131a50(0x144),'width':0xa},{'header':_0x131a50(0x11a),'key':_0x131a50(0x13e),'width':0xa},{'header':'SalesmanName','key':_0x131a50(0x140),'width':0xa},{'header':'address','key':_0x131a50(0x122),'width':0xa},{'header':_0x131a50(0x150),'key':_0x131a50(0x150),'width':0xa},{'header':_0x131a50(0x119),'key':_0x131a50(0x119),'width':0xa}],_0x63b56b[_0x131a50(0x132)]('Content-Type',_0x131a50(0x118)),_0x63b56b['setHeader'](_0x131a50(0x176),_0x131a50(0x12f)),_0x47f299[_0x131a50(0x160)]['write'](_0x63b56b)[_0x131a50(0x15d)](()=>{const _0x30f705=_0x131a50;_0x63b56b[_0x30f705(0x126)](0xc8);});}catch(_0x61535c){_0x63b56b['status'](0x190)[_0x131a50(0x14e)]({'errors':_0x61535c[_0x131a50(0x14b)]});}});const storage1=multer['diskStorage']({'destination':(_0x10a4e6,_0x18423f,_0x38d6fc)=>{const _0x17601c=a0_0x2b83e9;_0x38d6fc(null,_0x17601c(0x151));},'filename':(_0x4e5c86,_0x1c7783,_0x15b5cb)=>{const _0x1eb5b2=a0_0x2b83e9;_0x15b5cb(null,Date[_0x1eb5b2(0x113)]()+_0x1c7783[_0x1eb5b2(0x173)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x1a88(_0x25ed51,_0x1524b6){const _0x29cc87=a0_0x29cc();return a0_0x1a88=function(_0x1a88a6,_0x436828){_0x1a88a6=_0x1a88a6-0x109;let _0x35b04b=_0x29cc87[_0x1a88a6];return _0x35b04b;},a0_0x1a88(_0x25ed51,_0x1524b6);}router[a0_0x2b83e9(0x148)](a0_0x2b83e9(0x11d),auth,uploadMigrate[a0_0x2b83e9(0x15c)]('customer_product_fule'),async(_0x4e12d5,_0x37a728)=>{const _0x43d08e=a0_0x2b83e9,_0x40df94=_0x4e12d5[_0x43d08e(0x14f)]['filename'],_0x875abf=await xlsx[_0x43d08e(0x168)](_0x43d08e(0x133)+_0x40df94);let _0x4bc742=_0x875abf[_0x43d08e(0x13b)],_0x30e89c=xlsx['utils']['sheet_to_json'](_0x875abf['Sheets'][_0x4bc742[0x0]]);for(const _0x1e3a67 of _0x30e89c){const _0x43f070=_0x1e3a67['ID'],_0x4de541=_0x1e3a67[_0x43d08e(0x135)],_0x147430=_0x1e3a67['SalesmanCode'],_0x7bd44f=_0x1e3a67['SalesmanName'],_0x5d2afb=_0x1e3a67[_0x43d08e(0x122)],_0x38aace=_0x1e3a67[_0x43d08e(0x150)],_0x343e1b=_0x1e3a67[_0x43d08e(0x119)];try{let _0x54fe46=await customer['findOne']({'name':_0x4de541});if(!_0x54fe46){const _0x117017=new customer({'name':_0x4de541,'ID':_0x43f070,'SalesmanCode':_0x147430,'SalesmanName':_0x7bd44f,'address':_0x5d2afb,'mobile':_0x38aace,'email':_0x343e1b});_0x54fe46=await _0x117017[_0x43d08e(0x139)](),_0x4e12d5['flash'](_0x43d08e(0x141),_0x4de541+_0x43d08e(0x16c));}else _0x4e12d5[_0x43d08e(0x165)](_0x43d08e(0x12b),_0x4de541+_0x43d08e(0x124));}catch(_0x1a0ac5){_0x37a728[_0x43d08e(0x126)](0x1f4)[_0x43d08e(0x14c)]({'proderror':_0x1a0ac5[_0x43d08e(0x14b)],'aproduct':ProductName});}}_0x37a728[_0x43d08e(0x138)]('/customer/view');}),module[a0_0x2b83e9(0x177)]=router;