function a0_0x1efc(_0x31950c,_0x3f822d){const _0x214ded=a0_0x214d();return a0_0x1efc=function(_0x1efcfe,_0xd4f0e7){_0x1efcfe=_0x1efcfe-0x18d;let _0x1b60f1=_0x214ded[_0x1efcfe];return _0x1b60f1;},a0_0x1efc(_0x31950c,_0x3f822d);}const a0_0x4f6bd2=a0_0x1efc;(function(_0x22ade3,_0x2460d7){const _0x9cf7c6=a0_0x1efc,_0x4ec181=_0x22ade3();while(!![]){try{const _0x7a5b15=parseInt(_0x9cf7c6(0x1d9))/0x1*(-parseInt(_0x9cf7c6(0x194))/0x2)+-parseInt(_0x9cf7c6(0x1c8))/0x3*(-parseInt(_0x9cf7c6(0x1da))/0x4)+-parseInt(_0x9cf7c6(0x1b7))/0x5*(-parseInt(_0x9cf7c6(0x192))/0x6)+-parseInt(_0x9cf7c6(0x1c0))/0x7*(-parseInt(_0x9cf7c6(0x1d7))/0x8)+-parseInt(_0x9cf7c6(0x19d))/0x9+-parseInt(_0x9cf7c6(0x1d5))/0xa+-parseInt(_0x9cf7c6(0x1e9))/0xb;if(_0x7a5b15===_0x2460d7)break;else _0x4ec181['push'](_0x4ec181['shift']());}catch(_0x49e783){_0x4ec181['push'](_0x4ec181['shift']());}}}(a0_0x214d,0x9ee07));const express=require('express'),app=express(),router=express[a0_0x4f6bd2(0x1aa)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x4f6bd2(0x1f1)),auth=require('../middleware/auth'),users=require(a0_0x4f6bd2(0x1ee)),excelJS=require('exceljs'),xlsx=require(a0_0x4f6bd2(0x1e2)),multer=require(a0_0x4f6bd2(0x1d1));function a0_0x214d(){const _0x5007e6=['English\x20(US)','forEach','Name','customer\x20add\x20successfully','/customer/view','customer','12CUGFCA','English','filename','Workbook','post','file','SalesmanName','Portuguese\x20(BR)','status','multer','findById','language','find','2124670tipxlw','\x20Failed','16gpZAqh','mobile','1wkemuR','1156252sFZBqk','Arabic\x20(ae)','address','Portuguese','SalesmanCode','Sheets','customer_data','payable','xlsx','diskStorage','aggregate','customer_product_fule','body','Hindi','errors','8041363swDSib','Sale\x20Return','success','user','params','../public/language/languages.json','save','error','../models/all_models','originalname','get','now','receivable','SheetNames','payable_sum','master','flash','102408fmPZaC','$reason','1734114JSPlXv','Arabic','customer\x20update\x20successfully','readFile','reason','utils','sale_return','Sale','amount','10595394ulZLio','findOne','Chinese','c_payments','German','render','send','\x20added\x20successfully','setHeader','Spanish','name','contactperson','attachment;\x20filename=customer_Migration_File.xlsx','Router','element','landline','/view/:id','/view/payment/:id','public/Migration','data','json','redirect','message','sale','$amount','then','370CbwPLL','PName','Content-Type','French','email','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','customer_docs','/products_export_migrate_file','receivable_sum','4267543bMKXVF','log'];a0_0x214d=function(){return _0x5007e6;};return a0_0x214d();}router[a0_0x4f6bd2(0x1f3)]('/view',auth,async(_0x2d9884,_0xef0a39)=>{const _0x14d5ae=a0_0x4f6bd2;try{const {username:_0x588590,email:_0x518e18,role:_0x9a4a00}=_0x2d9884['user'],_0x24d050=_0x2d9884[_0x14d5ae(0x1ec)],_0x4bbb8c=await profile[_0x14d5ae(0x19e)]({'email':_0x24d050[_0x14d5ae(0x1bb)]}),_0x38a9be=await master_shop['find']();console[_0x14d5ae(0x1c1)](_0x14d5ae(0x190),_0x38a9be);const _0x17a41b=await customer['find'](),_0x55a26a=await customer[_0x14d5ae(0x1e4)]([{'$lookup':{'from':_0x14d5ae(0x1a0),'localField':_0x14d5ae(0x1a7),'foreignField':_0x14d5ae(0x1c7),'as':_0x14d5ae(0x1bd)}}]);console[_0x14d5ae(0x1c1)](_0x55a26a);const _0x43a495=_0x55a26a['map'](_0x1a4e93=>{const _0x1fd633=_0x14d5ae;console['log'](_0x1fd633(0x1b0),_0x1a4e93);var _0x3aa833=0x0,_0x228da4=0x0;return _0x1a4e93[_0x1fd633(0x1bd)][_0x1fd633(0x1c3)](_0x28187d=>{const _0x410510=_0x1fd633;console['log'](_0x410510(0x1ab),_0x28187d),_0x28187d[_0x410510(0x198)]==_0x410510(0x19b)?_0x3aa833+=_0x28187d[_0x410510(0x19c)]:_0x228da4+=_0x28187d[_0x410510(0x19c)];}),_0x1a4e93[_0x1fd633(0x1b4)]=parseFloat(_0x3aa833)+0x0,_0x1a4e93[_0x1fd633(0x19a)]=parseFloat(_0x228da4)+0x0,_0x1a4e93;});console[_0x14d5ae(0x1c1)]('payment_data',_0x43a495);if(_0x38a9be[0x0]['language']==_0x14d5ae(0x1c2)){var _0x4992aa=users[_0x14d5ae(0x1c9)];console[_0x14d5ae(0x1c1)](_0x4992aa);}else{if(_0x38a9be[0x0]['language']==_0x14d5ae(0x1e7))var _0x4992aa=users[_0x14d5ae(0x1e7)];else{if(_0x38a9be[0x0][_0x14d5ae(0x1d3)]==_0x14d5ae(0x1a1))var _0x4992aa=users['German'];else{if(_0x38a9be[0x0]['language']==_0x14d5ae(0x1a6))var _0x4992aa=users['Spanish'];else{if(_0x38a9be[0x0][_0x14d5ae(0x1d3)]=='French')var _0x4992aa=users[_0x14d5ae(0x1ba)];else{if(_0x38a9be[0x0][_0x14d5ae(0x1d3)]==_0x14d5ae(0x1cf))var _0x4992aa=users[_0x14d5ae(0x1dd)];else{if(_0x38a9be[0x0][_0x14d5ae(0x1d3)]==_0x14d5ae(0x19f))var _0x4992aa=users[_0x14d5ae(0x19f)];else{if(_0x38a9be[0x0]['language']==_0x14d5ae(0x1db))var _0x4992aa=users[_0x14d5ae(0x195)];}}}}}}}_0xef0a39['render'](_0x14d5ae(0x1c7),{'success':_0x2d9884[_0x14d5ae(0x191)](_0x14d5ae(0x1eb)),'errors':_0x2d9884[_0x14d5ae(0x191)](_0x14d5ae(0x1e8)),'user':_0x17a41b,'role':_0x24d050,'profile':_0x4bbb8c,'payment':_0x43a495,'master_shop':_0x38a9be,'language':_0x4992aa});}catch(_0x5b99c5){console[_0x14d5ae(0x1c1)](_0x5b99c5);}}),router[a0_0x4f6bd2(0x1cc)]('/view',auth,async(_0x3a03fb,_0x397860)=>{const _0x58039a=a0_0x4f6bd2;try{const {name:_0x1883b9,address:_0x48aae2,mobile:_0x25985f,email:_0x2ecc9f,receivable:_0x55aa89,payable:_0x500d90,contactperson:_0x587657,landline:_0x1a8b73}=_0x3a03fb[_0x58039a(0x1e6)],_0x33d7cb=new customer({'name':_0x1883b9,'address':_0x48aae2,'mobile':_0x25985f,'email':_0x2ecc9f,'receivable':_0x55aa89,'payable':_0x500d90,'contactperson':_0x587657,'landline':_0x1a8b73}),_0x41c4a8=await _0x33d7cb['save']();_0x3a03fb['flash'](_0x58039a(0x1eb),_0x58039a(0x1c5)),_0x397860[_0x58039a(0x1b2)]('/customer/view');}catch(_0x1a8799){console[_0x58039a(0x1c1)](_0x1a8799);}}),router[a0_0x4f6bd2(0x1f3)](a0_0x4f6bd2(0x1ad),auth,async(_0x5d0d20,_0x44a2a7)=>{const _0x54067b=a0_0x4f6bd2;try{const {username:_0x2ca6e7,email:_0x4f9486,role:_0x591147}=_0x5d0d20[_0x54067b(0x1ec)],_0x43e7dc=_0x5d0d20[_0x54067b(0x1ec)],_0x4d465b=await profile[_0x54067b(0x19e)]({'email':_0x43e7dc[_0x54067b(0x1bb)]}),_0xb0371c=await master_shop['find']();console[_0x54067b(0x1c1)]('master',_0xb0371c);const _0x307358=_0x5d0d20[_0x54067b(0x1ed)]['id'],_0x8c4912=await customer[_0x54067b(0x1d2)](_0x307358);if(_0xb0371c[0x0]['language']==_0x54067b(0x1c2)){var _0xbfa0d5=users['English'];console['log'](_0xbfa0d5);}else{if(_0xb0371c[0x0][_0x54067b(0x1d3)]==_0x54067b(0x1e7))var _0xbfa0d5=users[_0x54067b(0x1e7)];else{if(_0xb0371c[0x0]['language']=='German')var _0xbfa0d5=users[_0x54067b(0x1a1)];else{if(_0xb0371c[0x0]['language']==_0x54067b(0x1a6))var _0xbfa0d5=users[_0x54067b(0x1a6)];else{if(_0xb0371c[0x0][_0x54067b(0x1d3)]==_0x54067b(0x1ba))var _0xbfa0d5=users['French'];else{if(_0xb0371c[0x0][_0x54067b(0x1d3)]==_0x54067b(0x1cf))var _0xbfa0d5=users[_0x54067b(0x1dd)];else{if(_0xb0371c[0x0][_0x54067b(0x1d3)]==_0x54067b(0x19f))var _0xbfa0d5=users['Chinese'];else{if(_0xb0371c[0x0]['language']==_0x54067b(0x1db))var _0xbfa0d5=users['Arabic'];}}}}}}}_0x44a2a7[_0x54067b(0x1a2)](_0x54067b(0x1c7),{'success':_0x5d0d20[_0x54067b(0x191)](_0x54067b(0x1eb)),'errors':_0x5d0d20[_0x54067b(0x191)](_0x54067b(0x1e8)),'role':_0x43e7dc,'profile':_0x4d465b,'user':_0x8c4912,'master_shop':_0xb0371c,'language':_0xbfa0d5});}catch(_0x57f1b7){console[_0x54067b(0x1c1)](_0x57f1b7);}}),router['post'](a0_0x4f6bd2(0x1ad),auth,async(_0x1404f1,_0x519a65)=>{const _0x4fb12c=a0_0x4f6bd2;try{const _0x423fb4=_0x1404f1[_0x4fb12c(0x1ed)]['id'],_0xaa815=await customer[_0x4fb12c(0x1d2)](_0x423fb4),{name:_0x339c30,address:_0x57c1f2,mobile:_0x27f27d,email:_0x497148,receivable:_0x5ef978,payable:_0x54a915,contactperson:_0x4a5d96,landline:_0x5b8815}=_0x1404f1['body'];_0xaa815[_0x4fb12c(0x1a7)]=_0x339c30,_0xaa815[_0x4fb12c(0x1dc)]=_0x57c1f2,_0xaa815[_0x4fb12c(0x1d8)]=_0x27f27d,_0xaa815[_0x4fb12c(0x1bb)]=_0x497148,_0xaa815[_0x4fb12c(0x18d)]=_0x5ef978,_0xaa815[_0x4fb12c(0x1e1)]=_0x54a915,_0xaa815[_0x4fb12c(0x1a8)]=_0x4a5d96,_0xaa815[_0x4fb12c(0x1ac)]=_0x5b8815;const _0x277720=await _0xaa815[_0x4fb12c(0x1ef)]();_0x1404f1['flash'](_0x4fb12c(0x1eb),_0x4fb12c(0x196)),_0x519a65[_0x4fb12c(0x1b2)](_0x4fb12c(0x1c6));}catch(_0xef9043){console[_0x4fb12c(0x1c1)](_0xef9043);}}),router[a0_0x4f6bd2(0x1f3)](a0_0x4f6bd2(0x1ae),auth,async(_0x129306,_0x4e7f51)=>{const _0xdaaec1=a0_0x4f6bd2;try{const {username:_0x4b72c1,email:_0x250350,role:_0x2336f5}=_0x129306['user'],_0x18c9ff=_0x129306[_0xdaaec1(0x1ec)],_0x13c61a=await profile[_0xdaaec1(0x19e)]({'email':_0x18c9ff[_0xdaaec1(0x1bb)]}),_0x490d65=await master_shop['find']();console[_0xdaaec1(0x1c1)](_0xdaaec1(0x190),_0x490d65),console['log'](_0x129306[_0xdaaec1(0x1ed)]['id']);const _0x43f8f5=await customer[_0xdaaec1(0x19e)]({'_id':_0x129306[_0xdaaec1(0x1ed)]['id']});console[_0xdaaec1(0x1c1)](_0xdaaec1(0x1e0),_0x43f8f5);const _0xb2e2f6=await c_payment_data[_0xdaaec1(0x1d4)]({'customer':_0x43f8f5[_0xdaaec1(0x1a7)]});console['log'](_0xb2e2f6);const _0x147174=await c_payment_data[_0xdaaec1(0x1e4)]([{'$match':{'customer':_0x43f8f5[_0xdaaec1(0x1a7)]}},{'$match':{'reason':_0xdaaec1(0x19b)}},{'$group':{'_id':_0xdaaec1(0x193),'sum':{'$sum':_0xdaaec1(0x1b5)}}}]);console['log'](_0xdaaec1(0x18f),_0x147174);const _0x103841=await c_payment_data['aggregate']([{'$match':{'customer':_0x43f8f5[_0xdaaec1(0x1a7)]}},{'$match':{'reason':_0xdaaec1(0x1ea)}},{'$group':{'_id':'$reason','sum':{'$sum':_0xdaaec1(0x1b5)}}}]);console[_0xdaaec1(0x1c1)](_0xdaaec1(0x1bf),_0x103841);if(_0x490d65[0x0][_0xdaaec1(0x1d3)]==_0xdaaec1(0x1c2)){var _0x5b698b=users[_0xdaaec1(0x1c9)];console[_0xdaaec1(0x1c1)](_0x5b698b);}else{if(_0x490d65[0x0]['language']==_0xdaaec1(0x1e7))var _0x5b698b=users[_0xdaaec1(0x1e7)];else{if(_0x490d65[0x0]['language']==_0xdaaec1(0x1a1))var _0x5b698b=users[_0xdaaec1(0x1a1)];else{if(_0x490d65[0x0]['language']==_0xdaaec1(0x1a6))var _0x5b698b=users[_0xdaaec1(0x1a6)];else{if(_0x490d65[0x0][_0xdaaec1(0x1d3)]=='French')var _0x5b698b=users[_0xdaaec1(0x1ba)];else{if(_0x490d65[0x0]['language']==_0xdaaec1(0x1cf))var _0x5b698b=users[_0xdaaec1(0x1dd)];else{if(_0x490d65[0x0][_0xdaaec1(0x1d3)]==_0xdaaec1(0x19f))var _0x5b698b=users['Chinese'];else{if(_0x490d65[0x0][_0xdaaec1(0x1d3)]=='Arabic\x20(ae)')var _0x5b698b=users['Arabic'];}}}}}}}_0x4e7f51[_0xdaaec1(0x1a2)]('customer_payment',{'success':_0x129306['flash'](_0xdaaec1(0x1eb)),'errors':_0x129306['flash']('errors'),'role':_0x18c9ff,'profile':_0x13c61a,'payment':_0xb2e2f6,'payable':_0x147174,'receivable':_0x103841,'master_shop':_0x490d65,'language':_0x5b698b});}catch(_0x73e77c){console[_0xdaaec1(0x1c1)](_0x73e77c);}}),router[a0_0x4f6bd2(0x1f3)](a0_0x4f6bd2(0x1be),auth,async(_0x1d6b7f,_0x169ced)=>{const _0x235c32=a0_0x4f6bd2;try{const _0xa47393=new excelJS[(_0x235c32(0x1cb))](),_0x11eb4a=_0xa47393['addWorksheet']('Customers');return _0x11eb4a['columns']=[{'header':'ID','key':_0x235c32(0x1b8),'width':0xa},{'header':_0x235c32(0x1c4),'key':'PBrands','width':0xa},{'header':_0x235c32(0x1de),'key':'PUnits','width':0xa},{'header':_0x235c32(0x1ce),'key':_0x235c32(0x1ce),'width':0xa},{'header':_0x235c32(0x1dc),'key':_0x235c32(0x1dc),'width':0xa},{'header':_0x235c32(0x1d8),'key':_0x235c32(0x1d8),'width':0xa},{'header':_0x235c32(0x1bb),'key':_0x235c32(0x1bb),'width':0xa}],_0x169ced[_0x235c32(0x1a5)](_0x235c32(0x1b9),_0x235c32(0x1bc)),_0x169ced[_0x235c32(0x1a5)]('Content-Disposition',_0x235c32(0x1a9)),_0xa47393[_0x235c32(0x1e2)]['write'](_0x169ced)[_0x235c32(0x1b6)](()=>{const _0x3f5ecc=_0x235c32;_0x169ced[_0x3f5ecc(0x1d0)](0xc8);});}catch(_0x43f21e){_0x169ced['status'](0x190)[_0x235c32(0x1a3)]({'errors':_0x43f21e[_0x235c32(0x1b3)]});}});const storage1=multer[a0_0x4f6bd2(0x1e3)]({'destination':(_0x567e51,_0x13b4be,_0x1e85b4)=>{const _0x5d3f40=a0_0x4f6bd2;_0x1e85b4(null,_0x5d3f40(0x1af));},'filename':(_0x274866,_0x2867b2,_0x14bec1)=>{const _0x1e36be=a0_0x4f6bd2;_0x14bec1(null,Date[_0x1e36be(0x1f4)]()+_0x2867b2[_0x1e36be(0x1f2)]);}}),uploadMigrate=multer({'storage':storage1});router['post']('/customer_import_migrate_file',auth,uploadMigrate['single'](a0_0x4f6bd2(0x1e5)),async(_0x53e527,_0x2371ad)=>{const _0x493cfc=a0_0x4f6bd2,_0xf24bd7=_0x53e527[_0x493cfc(0x1cd)][_0x493cfc(0x1ca)],_0x462f4c=await xlsx[_0x493cfc(0x197)]('public/Migration/'+_0xf24bd7);let _0x4ce956=_0x462f4c[_0x493cfc(0x18e)],_0x39f1c7=xlsx[_0x493cfc(0x199)]['sheet_to_json'](_0x462f4c[_0x493cfc(0x1df)][_0x4ce956[0x0]]);for(const _0x18bbc6 of _0x39f1c7){const _0x25693a=_0x18bbc6['ID'],_0x22e242=_0x18bbc6[_0x493cfc(0x1c4)],_0x373c99=_0x18bbc6[_0x493cfc(0x1de)],_0x29cccf=_0x18bbc6[_0x493cfc(0x1ce)],_0x33410c=_0x18bbc6['address'],_0x1d41b6=_0x18bbc6[_0x493cfc(0x1d8)],_0x23c49f=_0x18bbc6[_0x493cfc(0x1bb)];try{let _0x4f2f62=await customer[_0x493cfc(0x19e)]({'name':_0x22e242});if(!_0x4f2f62){const _0x4c6091=new customer({'name':_0x22e242,'ID':_0x25693a,'SalesmanCode':_0x373c99,'SalesmanName':_0x29cccf,'address':_0x33410c,'mobile':_0x1d41b6,'email':_0x23c49f});_0x4f2f62=await _0x4c6091[_0x493cfc(0x1ef)](),_0x53e527['flash'](_0x493cfc(0x1eb),_0x22e242+_0x493cfc(0x1a4));}else _0x53e527[_0x493cfc(0x191)](_0x493cfc(0x1f0),_0x22e242+_0x493cfc(0x1d6));}catch(_0x3fa770){_0x2371ad[_0x493cfc(0x1d0)](0x1f4)[_0x493cfc(0x1b1)]({'proderror':_0x3fa770['message'],'aproduct':ProductName});}}_0x2371ad[_0x493cfc(0x1b2)](_0x493cfc(0x1c6));}),module['exports']=router;