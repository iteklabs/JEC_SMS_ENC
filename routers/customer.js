function a0_0xbd6d(_0x4f79d5,_0x88c822){const _0x4bfc85=a0_0x4bfc();return a0_0xbd6d=function(_0xbd6dc1,_0x313e5a){_0xbd6dc1=_0xbd6dc1-0x1d8;let _0x18ac2a=_0x4bfc85[_0xbd6dc1];return _0x18ac2a;},a0_0xbd6d(_0x4f79d5,_0x88c822);}const a0_0x36f7e1=a0_0xbd6d;(function(_0x190229,_0x4e7b96){const _0x18bdd3=a0_0xbd6d,_0x2eb4f1=_0x190229();while(!![]){try{const _0x5727cb=-parseInt(_0x18bdd3(0x1f1))/0x1*(-parseInt(_0x18bdd3(0x21c))/0x2)+parseInt(_0x18bdd3(0x21d))/0x3*(parseInt(_0x18bdd3(0x1fe))/0x4)+-parseInt(_0x18bdd3(0x211))/0x5+parseInt(_0x18bdd3(0x219))/0x6+-parseInt(_0x18bdd3(0x1ee))/0x7+-parseInt(_0x18bdd3(0x21f))/0x8*(-parseInt(_0x18bdd3(0x1fd))/0x9)+parseInt(_0x18bdd3(0x22b))/0xa*(-parseInt(_0x18bdd3(0x231))/0xb);if(_0x5727cb===_0x4e7b96)break;else _0x2eb4f1['push'](_0x2eb4f1['shift']());}catch(_0x5111ae){_0x2eb4f1['push'](_0x2eb4f1['shift']());}}}(a0_0x4bfc,0x232d0));const express=require(a0_0x36f7e1(0x23a)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require('exceljs'),xlsx=require(a0_0x36f7e1(0x208)),multer=require(a0_0x36f7e1(0x1e8));function a0_0x4bfc(){const _0x5b16c4=['Portuguese\x20(BR)','name','render','payable','SalesmanCode','Workbook','SalesmanName','834042gLwAXa','English','columns','568646iTXLkF','96HDPKAK','success','584meFUhZ','Content-Type','payment_data','originalname','\x20Failed','filename','post','Sale\x20Return','aggregate','user','save','errors','40230FhDyra','log','customer_data','error','Sale','Name','275bCVrEF','addWorksheet','exports','receivable','$amount','redirect','find','email','data','express','\x20added\x20successfully','French','findOne','German','attachment;\x20filename=customer_Migration_File.xlsx','$reason','Customers','Spanish','Portuguese','customer\x20add\x20successfully','Hindi','c_payments','diskStorage','English\x20(US)','customer\x20update\x20successfully','customer_docs','address','multer','flash','params','/view/:id','write','/view','1059590WcVZdR','Arabic\x20(ae)','language','1kYNwWe','message','/customer_import_migrate_file','readFile','body','setHeader','send','Arabic','amount','/view/payment/:id','receivable_sum','Content-Disposition','30717msqsqi','28lAduGx','then','Chinese','master','customer','customer_payment','json','element','mobile','/customer/view','xlsx','file','/products_export_migrate_file','SheetNames','get','map','forEach','status','PBrands','1383390CEzAKX'];a0_0x4bfc=function(){return _0x5b16c4;};return a0_0x4bfc();}router[a0_0x36f7e1(0x20c)]('/view',auth,async(_0x5b3267,_0x42b79f)=>{const _0x128348=a0_0x36f7e1;try{const {username:_0x3833c9,email:_0x505c23,role:_0x8d8c9f}=_0x5b3267['user'],_0x25904e=_0x5b3267['user'],_0x129593=await profile[_0x128348(0x1d9)]({'email':_0x25904e[_0x128348(0x238)]}),_0x5042e0=await master_shop[_0x128348(0x237)]();console['log']('master',_0x5042e0);const _0x380779=await customer[_0x128348(0x237)](),_0x3a284b=await customer[_0x128348(0x227)]([{'$lookup':{'from':_0x128348(0x1e2),'localField':_0x128348(0x213),'foreignField':_0x128348(0x202),'as':_0x128348(0x1e6)}}]);console[_0x128348(0x22c)](_0x3a284b);const _0x373761=_0x3a284b[_0x128348(0x20d)](_0x299960=>{const _0x978034=_0x128348;console[_0x978034(0x22c)](_0x978034(0x239),_0x299960);var _0x1ff4dd=0x0,_0x155118=0x0;return _0x299960['customer_docs'][_0x978034(0x20e)](_0x42505c=>{const _0x1072da=_0x978034;console[_0x1072da(0x22c)](_0x1072da(0x205),_0x42505c),_0x42505c['reason']==_0x1072da(0x22f)?_0x1ff4dd+=_0x42505c[_0x1072da(0x1f9)]:_0x155118+=_0x42505c['amount'];}),_0x299960['sale']=parseFloat(_0x1ff4dd)+0x0,_0x299960['sale_return']=parseFloat(_0x155118)+0x0,_0x299960;});console[_0x128348(0x22c)](_0x128348(0x221),_0x373761);if(_0x5042e0[0x0][_0x128348(0x1f0)]==_0x128348(0x1e4)){var _0x51aeb3=users[_0x128348(0x21a)];console[_0x128348(0x22c)](_0x51aeb3);}else{if(_0x5042e0[0x0]['language']==_0x128348(0x1e1))var _0x51aeb3=users[_0x128348(0x1e1)];else{if(_0x5042e0[0x0][_0x128348(0x1f0)]==_0x128348(0x1da))var _0x51aeb3=users[_0x128348(0x1da)];else{if(_0x5042e0[0x0][_0x128348(0x1f0)]==_0x128348(0x1de))var _0x51aeb3=users[_0x128348(0x1de)];else{if(_0x5042e0[0x0][_0x128348(0x1f0)]==_0x128348(0x1d8))var _0x51aeb3=users[_0x128348(0x1d8)];else{if(_0x5042e0[0x0]['language']==_0x128348(0x212))var _0x51aeb3=users[_0x128348(0x1df)];else{if(_0x5042e0[0x0][_0x128348(0x1f0)]==_0x128348(0x200))var _0x51aeb3=users['Chinese'];else{if(_0x5042e0[0x0]['language']==_0x128348(0x1ef))var _0x51aeb3=users['Arabic'];}}}}}}}_0x42b79f['render'](_0x128348(0x202),{'success':_0x5b3267[_0x128348(0x1e9)](_0x128348(0x21e)),'errors':_0x5b3267[_0x128348(0x1e9)](_0x128348(0x22a)),'user':_0x380779,'role':_0x25904e,'profile':_0x129593,'payment':_0x373761,'master_shop':_0x5042e0,'language':_0x51aeb3});}catch(_0x36dd92){console[_0x128348(0x22c)](_0x36dd92);}}),router[a0_0x36f7e1(0x225)](a0_0x36f7e1(0x1ed),auth,async(_0x27d4b7,_0x28398e)=>{const _0x2bfdb2=a0_0x36f7e1;try{const {name:_0x346d74,address:_0x3697e3,mobile:_0x2addb1,email:_0x530bdc,receivable:_0x3b9d6f,payable:_0x53a575,contactperson:_0x3e641d,landline:_0x215f79}=_0x27d4b7['body'],_0x1a75d8=new customer({'name':_0x346d74,'address':_0x3697e3,'mobile':_0x2addb1,'email':_0x530bdc,'receivable':_0x3b9d6f,'payable':_0x53a575,'contactperson':_0x3e641d,'landline':_0x215f79}),_0x2629f2=await _0x1a75d8[_0x2bfdb2(0x229)]();_0x27d4b7['flash']('success',_0x2bfdb2(0x1e0)),_0x28398e[_0x2bfdb2(0x236)]('/customer/view');}catch(_0x4f7138){console[_0x2bfdb2(0x22c)](_0x4f7138);}}),router['get'](a0_0x36f7e1(0x1eb),auth,async(_0x1e94cd,_0x4eae44)=>{const _0x21f8ab=a0_0x36f7e1;try{const {username:_0x59e5da,email:_0x429276,role:_0x3ea9b1}=_0x1e94cd[_0x21f8ab(0x228)],_0x5c8cae=_0x1e94cd[_0x21f8ab(0x228)],_0x34d104=await profile[_0x21f8ab(0x1d9)]({'email':_0x5c8cae['email']}),_0x462b7a=await master_shop[_0x21f8ab(0x237)]();console[_0x21f8ab(0x22c)](_0x21f8ab(0x201),_0x462b7a);const _0x4c1626=_0x1e94cd[_0x21f8ab(0x1ea)]['id'],_0xb3fc76=await customer['findById'](_0x4c1626);if(_0x462b7a[0x0]['language']=='English\x20(US)'){var _0x17f8b8=users[_0x21f8ab(0x21a)];console[_0x21f8ab(0x22c)](_0x17f8b8);}else{if(_0x462b7a[0x0][_0x21f8ab(0x1f0)]==_0x21f8ab(0x1e1))var _0x17f8b8=users[_0x21f8ab(0x1e1)];else{if(_0x462b7a[0x0][_0x21f8ab(0x1f0)]==_0x21f8ab(0x1da))var _0x17f8b8=users[_0x21f8ab(0x1da)];else{if(_0x462b7a[0x0][_0x21f8ab(0x1f0)]==_0x21f8ab(0x1de))var _0x17f8b8=users[_0x21f8ab(0x1de)];else{if(_0x462b7a[0x0][_0x21f8ab(0x1f0)]==_0x21f8ab(0x1d8))var _0x17f8b8=users['French'];else{if(_0x462b7a[0x0]['language']==_0x21f8ab(0x212))var _0x17f8b8=users[_0x21f8ab(0x1df)];else{if(_0x462b7a[0x0][_0x21f8ab(0x1f0)]=='Chinese')var _0x17f8b8=users['Chinese'];else{if(_0x462b7a[0x0][_0x21f8ab(0x1f0)]==_0x21f8ab(0x1ef))var _0x17f8b8=users[_0x21f8ab(0x1f8)];}}}}}}}_0x4eae44[_0x21f8ab(0x214)](_0x21f8ab(0x202),{'success':_0x1e94cd[_0x21f8ab(0x1e9)](_0x21f8ab(0x21e)),'errors':_0x1e94cd[_0x21f8ab(0x1e9)](_0x21f8ab(0x22a)),'role':_0x5c8cae,'profile':_0x34d104,'user':_0xb3fc76,'master_shop':_0x462b7a,'language':_0x17f8b8});}catch(_0x36275b){console[_0x21f8ab(0x22c)](_0x36275b);}}),router[a0_0x36f7e1(0x225)](a0_0x36f7e1(0x1eb),auth,async(_0x47cc27,_0x4e10f8)=>{const _0x3da2a7=a0_0x36f7e1;try{const _0x4c43a4=_0x47cc27['params']['id'],_0x2d0e20=await customer['findById'](_0x4c43a4),{name:_0x4b8bb0,address:_0x1e7268,mobile:_0x3b865b,email:_0x1c4162,receivable:_0x5e5bff,payable:_0x59dba5,contactperson:_0x31ada3,landline:_0x55eb6b}=_0x47cc27[_0x3da2a7(0x1f5)];_0x2d0e20[_0x3da2a7(0x213)]=_0x4b8bb0,_0x2d0e20['address']=_0x1e7268,_0x2d0e20[_0x3da2a7(0x206)]=_0x3b865b,_0x2d0e20[_0x3da2a7(0x238)]=_0x1c4162,_0x2d0e20[_0x3da2a7(0x234)]=_0x5e5bff,_0x2d0e20[_0x3da2a7(0x215)]=_0x59dba5,_0x2d0e20['contactperson']=_0x31ada3,_0x2d0e20['landline']=_0x55eb6b;const _0x59f6cd=await _0x2d0e20[_0x3da2a7(0x229)]();_0x47cc27[_0x3da2a7(0x1e9)](_0x3da2a7(0x21e),_0x3da2a7(0x1e5)),_0x4e10f8[_0x3da2a7(0x236)](_0x3da2a7(0x207));}catch(_0x53e1a5){console[_0x3da2a7(0x22c)](_0x53e1a5);}}),router['get'](a0_0x36f7e1(0x1fa),auth,async(_0x44d832,_0x1c5621)=>{const _0x276b51=a0_0x36f7e1;try{const {username:_0x2fd596,email:_0x4d411c,role:_0x3295fe}=_0x44d832[_0x276b51(0x228)],_0xf5f1a4=_0x44d832[_0x276b51(0x228)],_0x54294f=await profile[_0x276b51(0x1d9)]({'email':_0xf5f1a4[_0x276b51(0x238)]}),_0x552c67=await master_shop[_0x276b51(0x237)]();console['log'](_0x276b51(0x201),_0x552c67),console[_0x276b51(0x22c)](_0x44d832[_0x276b51(0x1ea)]['id']);const _0x21df53=await customer[_0x276b51(0x1d9)]({'_id':_0x44d832[_0x276b51(0x1ea)]['id']});console['log'](_0x276b51(0x22d),_0x21df53);const _0x4038d8=await c_payment_data[_0x276b51(0x237)]({'customer':_0x21df53[_0x276b51(0x213)]});console['log'](_0x4038d8);const _0x46d782=await c_payment_data[_0x276b51(0x227)]([{'$match':{'customer':_0x21df53[_0x276b51(0x213)]}},{'$match':{'reason':_0x276b51(0x22f)}},{'$group':{'_id':_0x276b51(0x1dc),'sum':{'$sum':_0x276b51(0x235)}}}]);console[_0x276b51(0x22c)]('payable_sum',_0x46d782);const _0x560979=await c_payment_data[_0x276b51(0x227)]([{'$match':{'customer':_0x21df53[_0x276b51(0x213)]}},{'$match':{'reason':_0x276b51(0x226)}},{'$group':{'_id':_0x276b51(0x1dc),'sum':{'$sum':_0x276b51(0x235)}}}]);console['log'](_0x276b51(0x1fb),_0x560979);if(_0x552c67[0x0][_0x276b51(0x1f0)]=='English\x20(US)'){var _0x214244=users[_0x276b51(0x21a)];console[_0x276b51(0x22c)](_0x214244);}else{if(_0x552c67[0x0][_0x276b51(0x1f0)]==_0x276b51(0x1e1))var _0x214244=users[_0x276b51(0x1e1)];else{if(_0x552c67[0x0][_0x276b51(0x1f0)]=='German')var _0x214244=users[_0x276b51(0x1da)];else{if(_0x552c67[0x0]['language']==_0x276b51(0x1de))var _0x214244=users['Spanish'];else{if(_0x552c67[0x0]['language']=='French')var _0x214244=users[_0x276b51(0x1d8)];else{if(_0x552c67[0x0]['language']==_0x276b51(0x212))var _0x214244=users['Portuguese'];else{if(_0x552c67[0x0]['language']==_0x276b51(0x200))var _0x214244=users[_0x276b51(0x200)];else{if(_0x552c67[0x0]['language']==_0x276b51(0x1ef))var _0x214244=users[_0x276b51(0x1f8)];}}}}}}}_0x1c5621[_0x276b51(0x214)](_0x276b51(0x203),{'success':_0x44d832[_0x276b51(0x1e9)](_0x276b51(0x21e)),'errors':_0x44d832['flash'](_0x276b51(0x22a)),'role':_0xf5f1a4,'profile':_0x54294f,'payment':_0x4038d8,'payable':_0x46d782,'receivable':_0x560979,'master_shop':_0x552c67,'language':_0x214244});}catch(_0x5a1fec){console['log'](_0x5a1fec);}}),router[a0_0x36f7e1(0x20c)](a0_0x36f7e1(0x20a),auth,async(_0x457b54,_0x168de6)=>{const _0x3b7a01=a0_0x36f7e1;try{const _0x3dc43e=new excelJS[(_0x3b7a01(0x217))](),_0x3b3bb4=_0x3dc43e[_0x3b7a01(0x232)](_0x3b7a01(0x1dd));return _0x3b3bb4[_0x3b7a01(0x21b)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x3b7a01(0x230),'key':_0x3b7a01(0x210),'width':0xa},{'header':_0x3b7a01(0x216),'key':'PUnits','width':0xa},{'header':_0x3b7a01(0x218),'key':_0x3b7a01(0x218),'width':0xa},{'header':'address','key':_0x3b7a01(0x1e7),'width':0xa},{'header':'mobile','key':'mobile','width':0xa},{'header':'email','key':_0x3b7a01(0x238),'width':0xa}],_0x168de6[_0x3b7a01(0x1f6)](_0x3b7a01(0x220),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x168de6[_0x3b7a01(0x1f6)](_0x3b7a01(0x1fc),_0x3b7a01(0x1db)),_0x3dc43e['xlsx'][_0x3b7a01(0x1ec)](_0x168de6)[_0x3b7a01(0x1ff)](()=>{const _0x2f86c1=_0x3b7a01;_0x168de6[_0x2f86c1(0x20f)](0xc8);});}catch(_0x2315b5){_0x168de6[_0x3b7a01(0x20f)](0x190)[_0x3b7a01(0x1f7)]({'errors':_0x2315b5[_0x3b7a01(0x1f2)]});}});const storage1=multer[a0_0x36f7e1(0x1e3)]({'destination':(_0x32f799,_0x55a403,_0x7db2cb)=>{_0x7db2cb(null,'public/Migration');},'filename':(_0x42f519,_0x5cf5f8,_0xfb9060)=>{const _0x531560=a0_0x36f7e1;_0xfb9060(null,Date['now']()+_0x5cf5f8[_0x531560(0x222)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x36f7e1(0x225)](a0_0x36f7e1(0x1f3),auth,uploadMigrate['single']('customer_product_fule'),async(_0x1d079d,_0x296a9e)=>{const _0x465f35=a0_0x36f7e1,_0x240063=_0x1d079d[_0x465f35(0x209)][_0x465f35(0x224)],_0x33062e=await xlsx[_0x465f35(0x1f4)]('public/Migration/'+_0x240063);let _0x585b33=_0x33062e[_0x465f35(0x20b)],_0x3d64a8=xlsx['utils']['sheet_to_json'](_0x33062e['Sheets'][_0x585b33[0x0]]);for(const _0x1f5774 of _0x3d64a8){const _0x11a1cc=_0x1f5774['ID'],_0x24c145=_0x1f5774[_0x465f35(0x230)],_0x419b6a=_0x1f5774[_0x465f35(0x216)],_0x340ecd=_0x1f5774[_0x465f35(0x218)],_0x435c79=_0x1f5774['address'],_0x41f466=_0x1f5774['mobile'],_0x465d76=_0x1f5774[_0x465f35(0x238)];try{let _0xe9fbd0=await customer[_0x465f35(0x1d9)]({'name':_0x24c145});if(!_0xe9fbd0){const _0x102a7c=new customer({'name':_0x24c145,'ID':_0x11a1cc,'SalesmanCode':_0x419b6a,'SalesmanName':_0x340ecd,'address':_0x435c79,'mobile':_0x41f466,'email':_0x465d76});_0xe9fbd0=await _0x102a7c[_0x465f35(0x229)](),_0x1d079d[_0x465f35(0x1e9)](_0x465f35(0x21e),_0x24c145+_0x465f35(0x23b));}else _0x1d079d[_0x465f35(0x1e9)](_0x465f35(0x22e),_0x24c145+_0x465f35(0x223));}catch(_0x47f939){_0x296a9e[_0x465f35(0x20f)](0x1f4)[_0x465f35(0x204)]({'proderror':_0x47f939[_0x465f35(0x1f2)],'aproduct':ProductName});}}_0x296a9e[_0x465f35(0x236)](_0x465f35(0x207));}),module[a0_0x36f7e1(0x233)]=router;