var a0_0x6df540=a0_0x3a9b;function a0_0x3a9b(_0x3ad037,_0x15997a){var _0x29d904=a0_0x29d9();return a0_0x3a9b=function(_0x3a9b21,_0x981ce0){_0x3a9b21=_0x3a9b21-0x1f2;var _0x165d5a=_0x29d904[_0x3a9b21];return _0x165d5a;},a0_0x3a9b(_0x3ad037,_0x15997a);}(function(_0x407349,_0x4ed8cb){var _0x255123=a0_0x3a9b,_0x59fe9d=_0x407349();while(!![]){try{var _0x411e5c=parseInt(_0x255123(0x2c3))/0x1+-parseInt(_0x255123(0x28c))/0x2+parseInt(_0x255123(0x2e5))/0x3*(-parseInt(_0x255123(0x2dc))/0x4)+parseInt(_0x255123(0x1fd))/0x5+parseInt(_0x255123(0x244))/0x6+parseInt(_0x255123(0x2e9))/0x7*(-parseInt(_0x255123(0x201))/0x8)+-parseInt(_0x255123(0x237))/0x9*(-parseInt(_0x255123(0x267))/0xa);if(_0x411e5c===_0x4ed8cb)break;else _0x59fe9d['push'](_0x59fe9d['shift']());}catch(_0x62b640){_0x59fe9d['push'](_0x59fe9d['shift']());}}}(a0_0x29d9,0x730ff));const express=require(a0_0x6df540(0x2c2)),app=express(),router=express[a0_0x6df540(0x305)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x6df540(0x2e0)),auth=require(a0_0x6df540(0x257)),nodemailer=require(a0_0x6df540(0x260));var ejs=require(a0_0x6df540(0x200));const path=require('path'),users=require(a0_0x6df540(0x222));router[a0_0x6df540(0x275)](a0_0x6df540(0x2f9),auth,async(_0x23b25d,_0x5280cf)=>{var _0x5cbb82=a0_0x6df540;try{const {username:_0x6b47f5,email:_0x351093,role:_0x5efd1b}=_0x23b25d['user'],_0x8ccb90=_0x23b25d[_0x5cbb82(0x245)],_0xcae2f7=await profile[_0x5cbb82(0x2a0)]({'email':_0x8ccb90[_0x5cbb82(0x288)]}),_0xd121ac=await staff[_0x5cbb82(0x2a0)]({'email':_0x8ccb90[_0x5cbb82(0x288)]});if(_0x8ccb90[_0x5cbb82(0x290)]==_0x5cbb82(0x24d)){const _0x39c59b=await staff[_0x5cbb82(0x2a0)]({'email':_0x8ccb90[_0x5cbb82(0x288)]});}const _0x5dc5b3=await master_shop['find']();let _0x24d863;if(_0x8ccb90[_0x5cbb82(0x290)]=='staff'){const _0x2dce45=await staff[_0x5cbb82(0x2a0)]({'email':_0x8ccb90['email']});_0x24d863=await purchases[_0x5cbb82(0x20f)]([{'$match':{'warehouse_name':_0x2dce45[_0x5cbb82(0x1fa)]}},{'$lookup':{'from':_0x5cbb82(0x2fc),'localField':_0x5cbb82(0x2fc),'foreignField':_0x5cbb82(0x21d),'as':_0x5cbb82(0x273)}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x5cbb82(0x293)},{'$group':{'_id':_0x5cbb82(0x220),'invoice':{'$first':_0x5cbb82(0x2f2)},'suppliers':{'$first':'$suppliers'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x5cbb82(0x2b5)},'room':{'$first':_0x5cbb82(0x2ae)},'product':{'$push':_0x5cbb82(0x293)},'note':{'$first':_0x5cbb82(0x278)},'paid_amount':{'$first':_0x5cbb82(0x235)},'due_amount':{'$first':_0x5cbb82(0x263)},'return_data':{'$first':_0x5cbb82(0x2ef)},'batch_code':{'$first':_0x5cbb82(0x1f2)},'expiry_date':{'$first':_0x5cbb82(0x26e)},'suppliers_docs':{'$first':_0x5cbb82(0x25f)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x5cbb82(0x2d8)},'isle':{'$addToSet':_0x5cbb82(0x2ea)},'type':{'$addToSet':_0x5cbb82(0x203)},'floorlevel':{'$addToSet':'$product.floorlevel'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x24d863=await purchases[_0x5cbb82(0x20f)]([{'$lookup':{'from':'suppliers','localField':_0x5cbb82(0x2fc),'foreignField':_0x5cbb82(0x21d),'as':_0x5cbb82(0x273)}},{'$unwind':_0x5cbb82(0x25f)},{'$unwind':_0x5cbb82(0x293)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'suppliers':{'$first':'$suppliers'},'date':{'$first':_0x5cbb82(0x22b)},'warehouse_name':{'$first':_0x5cbb82(0x2b5)},'room':{'$addToSet':_0x5cbb82(0x294)},'product':{'$push':_0x5cbb82(0x293)},'note':{'$first':_0x5cbb82(0x278)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x5cbb82(0x263)},'return_data':{'$first':_0x5cbb82(0x2ef)},'batch_code':{'$first':_0x5cbb82(0x1f2)},'expiry_date':{'$first':_0x5cbb82(0x26e)},'suppliers_docs':{'$first':_0x5cbb82(0x25f)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x5cbb82(0x2d8)},'isle':{'$addToSet':_0x5cbb82(0x2ea)},'type':{'$addToSet':_0x5cbb82(0x203)},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':_0x5cbb82(0x2a3)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x5dc5b3[0x0][_0x5cbb82(0x2fd)]==_0x5cbb82(0x23d)){var _0x12f3e1=users[_0x5cbb82(0x27c)];console[_0x5cbb82(0x1fe)](_0x12f3e1);}else{if(_0x5dc5b3[0x0][_0x5cbb82(0x2fd)]=='Hindi')var _0x12f3e1=users['Hindi'];else{if(_0x5dc5b3[0x0][_0x5cbb82(0x2fd)]=='German')var _0x12f3e1=users[_0x5cbb82(0x210)];else{if(_0x5dc5b3[0x0][_0x5cbb82(0x2fd)]==_0x5cbb82(0x29e))var _0x12f3e1=users[_0x5cbb82(0x29e)];else{if(_0x5dc5b3[0x0][_0x5cbb82(0x2fd)]==_0x5cbb82(0x2d0))var _0x12f3e1=users[_0x5cbb82(0x2d0)];else{if(_0x5dc5b3[0x0][_0x5cbb82(0x2fd)]==_0x5cbb82(0x256))var _0x12f3e1=users[_0x5cbb82(0x2ff)];else{if(_0x5dc5b3[0x0][_0x5cbb82(0x2fd)]==_0x5cbb82(0x2ad))var _0x12f3e1=users['Chinese'];else{if(_0x5dc5b3[0x0][_0x5cbb82(0x2fd)]==_0x5cbb82(0x23c))var _0x12f3e1=users[_0x5cbb82(0x234)];}}}}}}}_0x5280cf[_0x5cbb82(0x233)](_0x5cbb82(0x2bd),{'success':_0x23b25d[_0x5cbb82(0x20d)](_0x5cbb82(0x296)),'errors':_0x23b25d['flash']('errors'),'purchases':_0x24d863,'role':_0x8ccb90,'profile':_0xcae2f7,'master_shop':_0x5dc5b3,'language':_0x12f3e1});}catch(_0x1da614){console[_0x5cbb82(0x1fe)](_0x5cbb82(0x232),_0x1da614),_0x5280cf['status'](0xc8)['json']({'message':_0x1da614[_0x5cbb82(0x1f7)]});}});function BayBinSelected(_0x587fe8,_0x531d4a){var _0x228579=a0_0x6df540,_0x37da45=[],_0x2bf591=[],_0x36c22d=[],_0x2e2fd8=[],_0x31a4c1=[],_0x8a7111=[];let _0x1b756c=[];if(_0x587fe8==_0x228579(0x2b7))switch(_0x531d4a){case'Rack\x20A':_0x37da45=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2bf591=[0x1,0x2],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5],_0x36c22d=[_0x228579(0x22e),_0x228579(0x2e4)],_0x31a4c1=['D'],_0x8a7111=['A'];break;case _0x228579(0x230):_0x37da45=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2bf591=[0x1,0x2],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5],_0x36c22d=[_0x228579(0x22e),_0x228579(0x2e4)],_0x31a4c1=['D'],_0x8a7111=['B'];break;case'Shelves':_0x37da45=[0x0],_0x2bf591=[0x0],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5],_0x36c22d=[_0x228579(0x2e4)],_0x31a4c1=['D'],_0x8a7111=['S'];break;case _0x228579(0x304):_0x37da45=[0x0],_0x2bf591=[0x0],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x36c22d=[_0x228579(0x2e4)],_0x31a4c1=['D'],_0x8a7111=['R'];break;}else{if(_0x587fe8==_0x228579(0x283))switch(_0x531d4a){case _0x228579(0x2eb):_0x37da45=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2bf591=['B','F'],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5],_0x36c22d=[_0x228579(0x22e),_0x228579(0x2e4)],_0x31a4c1=['C'],_0x8a7111=['A'];break;case _0x228579(0x230):_0x37da45=[0x5,0x4,0x3,0x2,0x1],_0x2bf591=['F','B','S'],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5],_0x36c22d=[_0x228579(0x22e),_0x228579(0x2e4)],_0x31a4c1=['C'],_0x8a7111=['B'];break;case _0x228579(0x28b):_0x37da45=[0x1,0x2,0x3,0x4,0x5],_0x2bf591=['B','F','S'],_0x2e2fd8=[0x5,0x4,0x3,0x2,0x1],_0x36c22d=[_0x228579(0x22e),_0x228579(0x2e4)],_0x31a4c1=['C'],_0x8a7111=['C'];break;case'Rack\x20D':_0x37da45=[0x5,0x4,0x3,0x2,0x1],_0x2bf591=['F','B','S'],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5],_0x36c22d=[_0x228579(0x22e),'Floor'],_0x31a4c1=['C'],_0x8a7111=['D'];break;case'Rack\x20E':_0x37da45=[0x4,0x3,0x2,0x1],_0x2bf591=[0x1,0x2],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5],_0x36c22d=[_0x228579(0x22e),_0x228579(0x2e4)],_0x31a4c1=['C'],_0x8a7111=['E'];break;case _0x228579(0x2e3):_0x37da45=[0x1,0x2,0x3],_0x2bf591=[0x1,0x2],_0x2e2fd8=[0x1,0x2,0x3,0x4,0x5],_0x36c22d=['Level'],_0x31a4c1=['C'],_0x8a7111=['F'];break;}}return{'levels':_0x37da45,'Isle':_0x2bf591,'rack':_0x2e2fd8,'type':_0x36c22d,'storage':_0x31a4c1,'rak':_0x8a7111};}async function getRandom8DigitNumber(){var _0x590500=a0_0x6df540;const _0x3a25f0=0x989680,_0x3bac24=0x5f5e0ff,_0x2c0db3=Math[_0x590500(0x281)](Math['random']()*(_0x3bac24-_0x3a25f0+0x1))+_0x3a25f0;var _0x340ef9;const _0xddf60b=await purchases[_0x590500(0x2a0)]({'invoice':_0x590500(0x29b)+_0x2c0db3});return _0xddf60b&&_0xddf60b['length']>0x0?_0x340ef9=_0x590500(0x29b)+_0x2c0db3:_0x340ef9=_0x590500(0x29b)+_0x2c0db3,_0x340ef9;}router[a0_0x6df540(0x275)](a0_0x6df540(0x270),auth,async(_0x272657,_0xa28b54)=>{var _0x35163c=a0_0x6df540;try{const {username:_0x5bb985,email:_0xebe15e,role:_0x62994e}=_0x272657[_0x35163c(0x245)],_0x285789=_0x272657[_0x35163c(0x245)],_0x32fd19=await profile['findOne']({'email':_0x285789['email']}),_0x11974f=await master_shop[_0x35163c(0x1f4)](),_0x335fa6=await staff[_0x35163c(0x2a0)]({'email':_0x285789['email']}),_0x4de2a7=await suppliers[_0x35163c(0x1f4)]({});let _0x5d614e;if(_0x285789[_0x35163c(0x290)]==_0x35163c(0x24d)){const _0x235d05=await staff[_0x35163c(0x2a0)]({'email':_0x285789['email']});_0x5d614e=await warehouse['aggregate']([{'$match':{'status':_0x35163c(0x2b4),'name':_0x235d05[_0x35163c(0x1fa)],'warehouse_category':_0x35163c(0x21f),'name':{'$ne':_0x35163c(0x2e7)}}},{'$group':{'_id':_0x35163c(0x2c7),'name':{'$first':'$name'}}}]);}else _0x5d614e=await warehouse[_0x35163c(0x20f)]([{'$match':{'status':'Enabled','warehouse_category':_0x35163c(0x21f),'name':{'$ne':_0x35163c(0x2e7)}}},{'$group':{'_id':_0x35163c(0x2c7),'name':{'$first':'$name'}}}]);const _0x24312a=await product[_0x35163c(0x1f4)]({}),_0x499aa4=await warehouse[_0x35163c(0x1f4)]({'status':'Enabled'}),_0x4389a2=await purchases[_0x35163c(0x1f4)]({}),_0x22bcb3=_0x4389a2[_0x35163c(0x2e2)]+0x1,_0x35859f=_0x35163c(0x29b)+_0x22bcb3[_0x35163c(0x261)]()[_0x35163c(0x30a)](0x5,'0');var _0xa16f95=['Ambient','Enclosed'];if(_0x11974f[0x0][_0x35163c(0x2fd)]==_0x35163c(0x23d))var _0x1c7ffc=users[_0x35163c(0x27c)];else{if(_0x11974f[0x0][_0x35163c(0x2fd)]==_0x35163c(0x25c))var _0x1c7ffc=users[_0x35163c(0x25c)];else{if(_0x11974f[0x0][_0x35163c(0x2fd)]==_0x35163c(0x210))var _0x1c7ffc=users['German'];else{if(_0x11974f[0x0][_0x35163c(0x2fd)]==_0x35163c(0x29e))var _0x1c7ffc=users['Spanish'];else{if(_0x11974f[0x0][_0x35163c(0x2fd)]=='French')var _0x1c7ffc=users[_0x35163c(0x2d0)];else{if(_0x11974f[0x0]['language']==_0x35163c(0x256))var _0x1c7ffc=users['Portuguese'];else{if(_0x11974f[0x0][_0x35163c(0x2fd)]=='Chinese')var _0x1c7ffc=users['Chinese'];else{if(_0x11974f[0x0][_0x35163c(0x2fd)]=='Arabic\x20(ae)')var _0x1c7ffc=users[_0x35163c(0x234)];}}}}}}}const _0x7e192b=getRandom8DigitNumber();_0x7e192b[_0x35163c(0x2c1)](_0x47cf39=>{var _0x4fe465=_0x35163c;_0xa28b54[_0x4fe465(0x233)](_0x4fe465(0x26a),{'success':_0x272657[_0x4fe465(0x20d)](_0x4fe465(0x296)),'errors':_0x272657[_0x4fe465(0x20d)](_0x4fe465(0x2ce)),'role':_0x285789,'profile':_0x32fd19,'suppliers':_0x4de2a7,'warehouse':_0x5d614e,'product':_0x24312a,'invoice':_0x47cf39,'master_shop':_0x11974f,'language':_0x1c7ffc,'find_data':_0x499aa4,'rooms_data':_0xa16f95});})[_0x35163c(0x213)](_0x4d3add=>{var _0x2e7c49=_0x35163c;_0x272657[_0x2e7c49(0x20d)](_0x2e7c49(0x2ce),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0xa28b54[_0x2e7c49(0x223)](_0x2e7c49(0x2a7));});}catch(_0x26a085){console[_0x35163c(0x1fe)](_0x26a085);}}),router['get'](a0_0x6df540(0x27a),auth,async(_0xd240cd,_0x4cfce2)=>{var _0x3b3083=a0_0x6df540;try{const _0x123236=_0xd240cd[_0x3b3083(0x2e8)]['id'];console[_0x3b3083(0x1fe)](_0x123236);const _0x4e0951=await master_shop[_0x3b3083(0x1f4)]();console[_0x3b3083(0x1fe)](_0x3b3083(0x2b6),_0x4e0951);const _0x2bac62=await product[_0x3b3083(0x2a0)]({'name':_0x123236});console['log'](_0x3b3083(0x1fc),_0x2bac62),_0x4cfce2[_0x3b3083(0x2ca)](0xc8)[_0x3b3083(0x295)]({'product_data':_0x2bac62,'master':_0x4e0951});}catch(_0x1baefd){console['log'](_0x3b3083(0x2ab),_0x1baefd);}}),router['post'](a0_0x6df540(0x270),auth,async(_0x568ca0,_0x52530a)=>{var _0x50d1d8=a0_0x6df540;try{const {invoice:_0x5c9e7b,date:_0x3d3b4c,warehouse_name:_0x2a157d,prod_name:_0x495d66,prod_code:_0x38492b,prod_qty:_0x3bd411,prod_unit:_0xefc0c5,prod_secondunit:_0x1220dc,prod_level:_0x37d4ff,prod_isle:_0xf2e39a,prod_pallet:_0x359ecc,note:_0x27e3d7,expiry_date:_0xdebae9,batch_code:_0x430ada,payable:_0x355e53,due_amount:_0x2f7d2f,Room_name:_0x2c0385,primary_code:_0x199a7c,secondary_code:_0x125929,MaxStocks_data:_0x260193,PO_number:_0x364630,SCRN:_0x3e157a,JO_number:_0x4705f6}=_0x568ca0[_0x50d1d8(0x243)];if(typeof _0x495d66==_0x50d1d8(0x2d7))var _0x28c1d7=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x25e)]],_0x13b018=[_0x568ca0[_0x50d1d8(0x243)]['prod_code']],_0x5c69a8=[_0x568ca0['body'][_0x50d1d8(0x24e)]],_0x1a8ae1=[_0x568ca0[_0x50d1d8(0x243)]['prod_primunit']],_0x4d64da=[_0x568ca0['body'][_0x50d1d8(0x27b)]],_0xa96d00=[_0x568ca0['body'][_0x50d1d8(0x253)]],_0x588304=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x255)]],_0x5e4895=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x24a)]],_0x301884=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2df)]],_0x1d717a=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x1fb)]],_0x626f84=[_0x568ca0['body'][_0x50d1d8(0x24b)]],_0x56672f=[_0x568ca0[_0x50d1d8(0x243)]['max_product_unit']],_0x4bb573=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x229)]],_0x303af0=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x301)]],_0x4f7e53=[_0x568ca0['body']['prod_cat']],_0x3cb594=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2f6)]],_0x3043c1=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x216)]],_0x7600db=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x274)]],_0x3c5b90=[_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2be)]],_0x15456a=[_0x568ca0[_0x50d1d8(0x243)]['actual_uom']];else var _0x28c1d7=[..._0x568ca0['body']['prod_name']],_0x13b018=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x30c)]],_0x5c69a8=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x24e)]],_0x1a8ae1=[..._0x568ca0[_0x50d1d8(0x243)]['prod_primunit']],_0x4d64da=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x27b)]],_0xa96d00=[..._0x568ca0['body'][_0x50d1d8(0x253)]],_0x588304=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x255)]],_0x5e4895=[..._0x568ca0['body']['secondary_code']],_0x301884=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2df)]],_0x1d717a=[..._0x568ca0[_0x50d1d8(0x243)]['batch_code']],_0x626f84=[..._0x568ca0['body'][_0x50d1d8(0x24b)]],_0x56672f=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2a1)]],_0x4bb573=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x229)]],_0x303af0=[..._0x568ca0[_0x50d1d8(0x243)]['production_date']],_0x4f7e53=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2ac)]],_0x3cb594=[..._0x568ca0['body'][_0x50d1d8(0x2f6)]],_0x3043c1=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x216)]],_0x7600db=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x274)]],_0x3c5b90=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2be)]],_0x15456a=[..._0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2c6)]];const _0x319ba3=_0x28c1d7[_0x50d1d8(0x247)](_0x1f37f7=>{return _0x1f37f7={'product_name':_0x1f37f7};});_0x3c5b90['forEach']((_0x4f00fc,_0x5f2b67)=>{var _0x3c5f4f=_0x50d1d8;_0x319ba3[_0x5f2b67]['actual_qty']=Math[_0x3c5f4f(0x26c)](_0x4f00fc);}),_0x15456a[_0x50d1d8(0x207)]((_0x4cec87,_0x15e788)=>{var _0x580fb5=_0x50d1d8;_0x319ba3[_0x15e788][_0x580fb5(0x2c6)]=_0x4cec87;}),_0x13b018[_0x50d1d8(0x207)]((_0x1325ee,_0x1f3e0a)=>{var _0x26a92f=_0x50d1d8;_0x319ba3[_0x1f3e0a][_0x26a92f(0x297)]=_0x1325ee;}),_0x5c69a8['forEach']((_0x50f7b5,_0xce0324)=>{_0x319ba3[_0xce0324]['quantity']=Math['abs'](_0x50f7b5);}),_0x1a8ae1[_0x50d1d8(0x207)]((_0x23f347,_0x1577a7)=>{_0x319ba3[_0x1577a7]['standard_unit']=_0x23f347;}),_0x4d64da['forEach']((_0x8f9b45,_0x4a7f66)=>{var _0x10c51f=_0x50d1d8;_0x319ba3[_0x4a7f66][_0x10c51f(0x28a)]=_0x8f9b45;}),_0xa96d00['forEach']((_0x55c649,_0x483431)=>{var _0x4c48ff=_0x50d1d8;_0x3cb594[_0x4c48ff(0x207)]((_0x3c84c2,_0x345275)=>{var _0x132e80=_0x4c48ff;if(_0x3c84c2==_0x132e80(0x304)&&_0x483431==_0x345275){console[_0x132e80(0x1fe)](_0x3c84c2+_0x132e80(0x209)+_0x483431+'\x20<>\x20'+_0x345275+'\x20<>\x20'+_0x55c649);var _0xccaf2e=_0x55c649[_0x132e80(0x2bf)](0x3);_0x319ba3[_0x483431][_0x132e80(0x249)]=_0x55c649[0x0],_0x319ba3[_0x483431][_0x132e80(0x2c4)]=_0x55c649[0x1],_0x319ba3[_0x483431][_0x132e80(0x26b)]=0x0,_0x319ba3[_0x483431]['bin']=0x0,_0x319ba3[_0x483431][_0x132e80(0x284)]=_0x132e80(0x2e4),_0x319ba3[_0x483431]['floorlevel']=_0xccaf2e;}else{if(_0x3c84c2=='Shelves'&&_0x483431==_0x345275){var _0xccaf2e=_0x55c649['slice'](0x3);_0x319ba3[_0x483431][_0x132e80(0x249)]=_0x55c649[0x0],_0x319ba3[_0x483431][_0x132e80(0x2c4)]=_0x55c649[0x1],_0x319ba3[_0x483431][_0x132e80(0x26b)]=0x0,_0x319ba3[_0x483431][_0x132e80(0x279)]=0x0,_0x319ba3[_0x483431]['type']=_0x132e80(0x2e4),_0x319ba3[_0x483431][_0x132e80(0x2d2)]=_0x55c649[0x5];}else{if(_0x483431==_0x345275){if(_0x55c649[0x0]=='A'&&_0x55c649[0x1]=='L'&&_0x55c649[0x2]=='L')console['log'](_0x3c84c2+'\x20<>\x20'+_0x483431+_0x132e80(0x25b)+_0x345275+_0x132e80(0x25b)+_0x55c649+'here'),_0x319ba3[_0x483431][_0x132e80(0x249)]=_0x55c649[0x0],_0x319ba3[_0x483431][_0x132e80(0x2c4)]=_0x55c649[0x1],_0x319ba3[_0x483431][_0x132e80(0x26b)]=0x0,_0x319ba3[_0x483431][_0x132e80(0x279)]=0x0,_0x319ba3[_0x483431][_0x132e80(0x284)]='Floor',_0x319ba3[_0x483431][_0x132e80(0x2d2)]=_0x55c649[0x3];else{var _0x86514b;if(_0x55c649[0x4]=='L')_0x86514b=_0x132e80(0x22e);else _0x55c649[0x4]=='F'&&(_0x86514b=_0x132e80(0x2e4));_0x319ba3[_0x483431][_0x132e80(0x249)]=_0x55c649[0x0],_0x319ba3[_0x483431][_0x132e80(0x2c4)]=_0x55c649[0x1],_0x319ba3[_0x483431]['bay']=_0x55c649[0x2],_0x319ba3[_0x483431][_0x132e80(0x279)]=_0x55c649[0x3],_0x319ba3[_0x483431][_0x132e80(0x284)]=_0x86514b,_0x319ba3[_0x483431][_0x132e80(0x2d2)]=_0x55c649[0x5];}}}}});}),_0x588304[_0x50d1d8(0x207)]((_0x5d7ff9,_0xc9f477)=>{var _0x3d8c88=_0x50d1d8;_0x319ba3[_0xc9f477][_0x3d8c88(0x255)]=_0x5d7ff9;}),_0x5e4895[_0x50d1d8(0x207)]((_0x4991ca,_0x5d084c)=>{_0x319ba3[_0x5d084c]['secondary_code']=_0x4991ca;}),_0x301884[_0x50d1d8(0x207)]((_0x63cb4a,_0x2c3c15)=>{var _0x50f947=_0x50d1d8;_0x319ba3[_0x2c3c15][_0x50f947(0x22c)]=_0x63cb4a;}),_0x1d717a[_0x50d1d8(0x207)]((_0xbe2ea8,_0x1c37a8)=>{_0x319ba3[_0x1c37a8]['batch_code']=_0xbe2ea8;}),_0x626f84['forEach']((_0x492cd9,_0x196e35)=>{_0x319ba3[_0x196e35]['expiry_date']=_0x492cd9;}),_0x56672f['forEach']((_0x192289,_0x19f4ce)=>{var _0x2c99d0=_0x50d1d8;_0x319ba3[_0x19f4ce][_0x2c99d0(0x1f3)]=_0x192289;}),_0x4bb573['forEach']((_0x4829d9,_0x321812)=>{var _0x43ce42=_0x50d1d8;_0x319ba3[_0x321812][_0x43ce42(0x229)]=_0x4829d9;}),_0x303af0[_0x50d1d8(0x207)]((_0x47a361,_0x1c1866)=>{var _0x1f8ba1=_0x50d1d8;_0x319ba3[_0x1c1866][_0x1f8ba1(0x301)]=_0x47a361;}),_0x4f7e53['forEach']((_0x500425,_0x2a1a55)=>{_0x319ba3[_0x2a1a55]['product_cat']=_0x500425;}),_0x3cb594[_0x50d1d8(0x207)]((_0x2aa9d8,_0x400edc)=>{_0x319ba3[_0x400edc]['room_name']=_0x2aa9d8;}),_0x3043c1[_0x50d1d8(0x207)]((_0xf70a7a,_0x4bf26f)=>{var _0x5e33c5=_0x50d1d8;_0x319ba3[_0x4bf26f][_0x5e33c5(0x224)]=_0xf70a7a;}),_0x7600db[_0x50d1d8(0x207)]((_0x1d3cf7,_0x34cbaa)=>{var _0x5ce11e=_0x50d1d8;_0x319ba3[_0x34cbaa][_0x5ce11e(0x264)]=_0x1d3cf7;});const _0x291f01=_0x3cb594[_0x50d1d8(0x247)](_0x3286f5=>{return _0x3286f5={'room_name':_0x3286f5};}),_0x538e03=_0x319ba3[_0x50d1d8(0x28d)](_0x446e33=>_0x446e33[_0x50d1d8(0x29a)]!=='0'&&_0x446e33[_0x50d1d8(0x29a)]!==''),_0x5320a5=new purchases({'invoice':_0x5c9e7b,'suppliers':_0x568ca0[_0x50d1d8(0x243)][_0x50d1d8(0x2fc)],'date':_0x3d3b4c,'warehouse_name':_0x2a157d,'product':_0x538e03,'note':_0x27e3d7,'due_amount':_0x2f7d2f,'POnumber':_0x364630,'SCRN':_0x3e157a,'JO_number':_0x4705f6,'roomList':_0x291f01}),_0x2de6ad=await _0x5320a5[_0x50d1d8(0x2c5)](),_0x516439=await purchases['findOne']({'invoice':_0x5c9e7b}),_0x29516c=_0x516439[_0x50d1d8(0x1fc)][_0x50d1d8(0x247)](async _0x4cac8f=>{var _0x1fb75e=_0x50d1d8,_0x5d18f1=await warehouse[_0x1fb75e(0x2a0)]({'name':_0x2a157d,'room':_0x4cac8f[_0x1fb75e(0x219)]}),_0x178f31=0x0;return _0x5d18f1[_0x1fb75e(0x26f)]['forEach'](_0x2f8c14=>{var _0x1b4e1a=_0x1fb75e;_0x2f8c14[_0x1b4e1a(0x21b)]==_0x4cac8f['product_name']&&_0x2f8c14['floorlevel']==_0x4cac8f['floorlevel']&&_0x2f8c14[_0x1b4e1a(0x284)]==_0x4cac8f[_0x1b4e1a(0x284)]&&_0x2f8c14['bin']==_0x4cac8f[_0x1b4e1a(0x279)]&&_0x2f8c14['bay']==_0x4cac8f[_0x1b4e1a(0x26b)]&&_0x2f8c14[_0x1b4e1a(0x2c4)]==_0x4cac8f[_0x1b4e1a(0x2c4)]&&_0x2f8c14['storage']==_0x4cac8f[_0x1b4e1a(0x249)]&&_0x2f8c14[_0x1b4e1a(0x24b)]==_0x4cac8f[_0x1b4e1a(0x24b)]&&_0x2f8c14[_0x1b4e1a(0x1fb)]==_0x4cac8f[_0x1b4e1a(0x1fb)]&&_0x2f8c14[_0x1b4e1a(0x301)]==_0x4cac8f[_0x1b4e1a(0x301)]&&_0x2f8c14[_0x1b4e1a(0x264)]==_0x516439[_0x1b4e1a(0x264)]&&(_0x2f8c14[_0x1b4e1a(0x2b2)]+=Math['abs'](_0x4cac8f[_0x1b4e1a(0x29a)]),_0x178f31++);}),_0x178f31===0x0&&_0x5d18f1[_0x1fb75e(0x26f)][_0x1fb75e(0x21a)]({'product_name':_0x4cac8f[_0x1fb75e(0x21b)],'product_stock':Math[_0x1fb75e(0x26c)](_0x4cac8f['quantity']),'primary_code':_0x4cac8f[_0x1fb75e(0x255)],'secondary_code':_0x4cac8f[_0x1fb75e(0x24a)],'product_code':_0x4cac8f[_0x1fb75e(0x297)],'storage':_0x4cac8f[_0x1fb75e(0x249)],'rack':_0x4cac8f[_0x1fb75e(0x2c4)],'bay':_0x4cac8f[_0x1fb75e(0x26b)],'bin':_0x4cac8f[_0x1fb75e(0x279)],'type':_0x4cac8f[_0x1fb75e(0x284)],'floorlevel':_0x4cac8f[_0x1fb75e(0x2d2)],'maxProducts':_0x4cac8f['maxStocks'],'unit':_0x4cac8f[_0x1fb75e(0x2d9)],'secondary_unit':_0x4cac8f['secondary_unit'],'expiry_date':_0x4cac8f['expiry_date'],'maxPerUnit':_0x4cac8f[_0x1fb75e(0x1f3)],'batch_code':_0x4cac8f['batch_code'],'alertQTY':_0x4cac8f[_0x1fb75e(0x229)],'production_date':_0x4cac8f['production_date'],'product_cat':_0x4cac8f[_0x1fb75e(0x2bc)],'invoice':_0x4cac8f[_0x1fb75e(0x264)],'actual_qty':Math[_0x1fb75e(0x26c)](_0x4cac8f[_0x1fb75e(0x2be)]),'actual_uom':_0x4cac8f[_0x1fb75e(0x2c6)]}),_0x5d18f1;});Promise['all'](_0x29516c)[_0x50d1d8(0x2c1)](async _0x365002=>{var _0x315a6c=_0x50d1d8;try{for(const _0x356c18 of _0x365002){await _0x356c18[_0x315a6c(0x2c5)]();}const _0x52d8a4=await master_shop[_0x315a6c(0x1f4)](),_0x2fe89d=await email_settings[_0x315a6c(0x2a0)](),_0x449e86=await supervisor_settings[_0x315a6c(0x1f4)]();var _0x15c7a8=_0x516439[_0x315a6c(0x1fc)],_0xd62d54='',_0xdcb00a;for(_0xdcb00a in _0x15c7a8){_0xd62d54+='<tr>'+_0x315a6c(0x289)+_0x15c7a8[_0xdcb00a][_0x315a6c(0x21b)]+_0x315a6c(0x292)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15c7a8[_0xdcb00a]['product_code']+'</td>'+_0x315a6c(0x289)+_0x15c7a8[_0xdcb00a][_0x315a6c(0x29a)]+_0x315a6c(0x292)+_0x315a6c(0x289)+_0x15c7a8[_0xdcb00a][_0x315a6c(0x2d9)]+_0x315a6c(0x292)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15c7a8[_0xdcb00a][_0x315a6c(0x28a)]+_0x315a6c(0x292)+_0x315a6c(0x289)+_0x516439[_0x315a6c(0x300)]+_0x315a6c(0x292)+_0x315a6c(0x289)+_0x15c7a8[_0xdcb00a][_0x315a6c(0x219)]+_0x315a6c(0x292)+_0x315a6c(0x289)+_0x15c7a8[_0xdcb00a][_0x315a6c(0x249)]+_0x15c7a8[_0xdcb00a][_0x315a6c(0x2c4)]+_0x15c7a8[_0xdcb00a]['bay']+_0x15c7a8[_0xdcb00a][_0x315a6c(0x279)]+_0x15c7a8[_0xdcb00a][_0x315a6c(0x284)][0x0]+_0x15c7a8[_0xdcb00a][_0x315a6c(0x2d2)]+_0x315a6c(0x292),_0x315a6c(0x25a);}let _0x2fafe4=nodemailer[_0x315a6c(0x259)]({'host':_0x2fe89d[_0x315a6c(0x303)],'port':Number(_0x2fe89d[_0x315a6c(0x2fa)]),'secure':![],'auth':{'user':_0x2fe89d[_0x315a6c(0x288)],'pass':_0x2fe89d[_0x315a6c(0x2f4)]}}),_0x25fb15={'from':_0x2fe89d[_0x315a6c(0x288)],'to':_0x449e86[0x0]['RMSEmail'],'subject':_0x315a6c(0x299),'attachments':[{'filename':_0x315a6c(0x239),'path':__dirname+_0x315a6c(0x2cd)+_0x315a6c(0x23f)+_0x52d8a4[0x0][_0x315a6c(0x238)],'cid':_0x315a6c(0x2d3)}],'html':_0x315a6c(0x286)+_0x315a6c(0x212)+_0x315a6c(0x285)+_0x315a6c(0x2b8)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x315a6c(0x2b8)+_0x315a6c(0x22f)+_0x315a6c(0x23a)+_0x315a6c(0x2b8)+_0x315a6c(0x23e)+_0x52d8a4[0x0][_0x315a6c(0x202)]+_0x315a6c(0x24c)+'</div>'+_0x315a6c(0x23a)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x315a6c(0x272)+_0x315a6c(0x2e6)+_0x516439[_0x315a6c(0x264)]+'\x20'+_0x315a6c(0x20e)+_0x315a6c(0x268)+_0x516439['date']+'\x20'+_0x315a6c(0x2cb)+_0x315a6c(0x269)+'</div>'+_0x315a6c(0x236)+_0x315a6c(0x308)+_0x315a6c(0x211)+_0x315a6c(0x206)+_0x315a6c(0x1f8)+_0x315a6c(0x250)+_0x315a6c(0x1f5)+_0x315a6c(0x2c9)+_0x315a6c(0x204)+_0x315a6c(0x231)+_0x315a6c(0x241)+'</tr>'+_0x315a6c(0x221)+_0x315a6c(0x20c)+'\x20'+_0xd62d54+'\x20'+_0x315a6c(0x1ff)+'</table>'+_0x315a6c(0x2b8)+_0x315a6c(0x225)+_0x315a6c(0x306)+_0x52d8a4[0x0][_0x315a6c(0x202)]+_0x315a6c(0x269)+'</div>'+_0x315a6c(0x23a)+'</body></html>'};_0x2fafe4[_0x315a6c(0x1f9)](_0x25fb15,function(_0x21b7c0,_0x463ff1){var _0x30f52a=_0x315a6c;_0x21b7c0?(console[_0x30f52a(0x1fe)](_0x21b7c0),console[_0x30f52a(0x1fe)]('Error\x20Occurs')):console[_0x30f52a(0x1fe)](_0x30f52a(0x22d));}),_0x568ca0[_0x315a6c(0x20d)](_0x315a6c(0x296),_0x315a6c(0x2f0)),_0x52530a[_0x315a6c(0x223)]('/all_purchases/view/');}catch(_0x480552){console[_0x315a6c(0x2cc)](_0x480552),_0x52530a[_0x315a6c(0x2ca)](0x1f4)[_0x315a6c(0x295)]({'error':_0x315a6c(0x291)});}})[_0x50d1d8(0x213)](_0x55cd8a=>{var _0x89d18=_0x50d1d8;console[_0x89d18(0x2cc)](_0x55cd8a),_0x52530a[_0x89d18(0x2ca)](0x1f4)[_0x89d18(0x295)]({'error':_0x89d18(0x309)});});}catch(_0x3058ee){console[_0x50d1d8(0x1fe)](_0x3058ee);}}),router[a0_0x6df540(0x275)]('/preview/:id',auth,async(_0x201153,_0x1f0695)=>{var _0x200bb8=a0_0x6df540;try{const {username:_0x36ca26,email:_0x3cde6d,role:_0x55b7b3}=_0x201153[_0x200bb8(0x245)],_0x56a05a=_0x201153[_0x200bb8(0x245)],_0x44f1ad=await profile[_0x200bb8(0x2a0)]({'email':_0x56a05a[_0x200bb8(0x288)]}),_0x35ac8f=await master_shop[_0x200bb8(0x1f4)](),_0x2b9e7f=_0x201153[_0x200bb8(0x2e8)]['id'],_0x10b2e5=await purchases[_0x200bb8(0x248)](_0x2b9e7f),_0x4ed3ee=await warehouse['aggregate']([{'$match':{'name':_0x10b2e5[_0x200bb8(0x300)],'room':_0x10b2e5[_0x200bb8(0x282)]}},{'$unwind':_0x200bb8(0x205)},{'$group':{'_id':_0x200bb8(0x30b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x200bb8(0x2b0)},'bay':{'$first':_0x200bb8(0x29f)},'bin':{'$first':_0x200bb8(0x2b3)},'type':{'$first':_0x200bb8(0x23b)},'floorlevel':{'$first':_0x200bb8(0x2af)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x200bb8(0x242)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x200bb8(0x24f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x200bb8(0x2ee)}}}]),_0x2c8d0e=await customer[_0x200bb8(0x1f4)]({});let _0x278b07;if(_0x56a05a[_0x200bb8(0x290)]==_0x200bb8(0x24d)){const _0x4f00bc=await staff[_0x200bb8(0x2a0)]({'email':_0x56a05a[_0x200bb8(0x288)]});_0x278b07=await warehouse[_0x200bb8(0x20f)]([{'$match':{'status':_0x200bb8(0x2b4),'name':_0x4f00bc['warehouse']}},{'$group':{'_id':_0x200bb8(0x2c7),'name':{'$first':_0x200bb8(0x2c7)}}}]);}else _0x278b07=await warehouse[_0x200bb8(0x20f)]([{'$match':{'status':_0x200bb8(0x2b4)}},{'$group':{'_id':_0x200bb8(0x2c7),'name':{'$first':'$name'}}}]);const _0x4c4e16=await product['find']({}),_0x7bcca4=await suppliers[_0x200bb8(0x1f4)]({}),_0x21ac6e=BayBinSelected(_0x10b2e5[_0x200bb8(0x300)],_0x10b2e5[_0x200bb8(0x282)]);if(_0x35ac8f[0x0][_0x200bb8(0x2fd)]=='English\x20(US)'){var _0x1b03b0=users[_0x200bb8(0x27c)];console[_0x200bb8(0x1fe)](_0x1b03b0);}else{if(_0x35ac8f[0x0][_0x200bb8(0x2fd)]==_0x200bb8(0x25c))var _0x1b03b0=users['Hindi'];else{if(_0x35ac8f[0x0][_0x200bb8(0x2fd)]==_0x200bb8(0x210))var _0x1b03b0=users[_0x200bb8(0x210)];else{if(_0x35ac8f[0x0]['language']=='Spanish')var _0x1b03b0=users['Spanish'];else{if(_0x35ac8f[0x0][_0x200bb8(0x2fd)]==_0x200bb8(0x2d0))var _0x1b03b0=users[_0x200bb8(0x2d0)];else{if(_0x35ac8f[0x0][_0x200bb8(0x2fd)]==_0x200bb8(0x256))var _0x1b03b0=users['Portuguese'];else{if(_0x35ac8f[0x0][_0x200bb8(0x2fd)]==_0x200bb8(0x2ad))var _0x1b03b0=users['Chinese'];else{if(_0x35ac8f[0x0][_0x200bb8(0x2fd)]==_0x200bb8(0x23c))var _0x1b03b0=users['Arabic'];}}}}}}}_0x1f0695[_0x200bb8(0x233)](_0x200bb8(0x2aa),{'success':_0x201153[_0x200bb8(0x20d)](_0x200bb8(0x296)),'errors':_0x201153[_0x200bb8(0x20d)](_0x200bb8(0x2ce)),'role':_0x56a05a,'profile':_0x44f1ad,'customer':_0x2c8d0e,'warehouse':_0x278b07,'product':_0x4ed3ee,'user':_0x10b2e5,'master_shop':_0x35ac8f,'unit':_0x4c4e16,'language':_0x1b03b0,'suppliers':_0x7bcca4,'dataSelected':_0x21ac6e});}catch(_0x2d9ceb){console[_0x200bb8(0x1fe)](_0x2d9ceb);}}),router[a0_0x6df540(0x228)]('/preview/:id',auth,async(_0x1098fd,_0x2ba653)=>{var _0x29e4ec=a0_0x6df540;try{const _0x21967c=_0x1098fd[_0x29e4ec(0x2e8)]['id'],{invoice:_0x2873c8,warehouse_name:_0x47b224,Room_name:_0x130780}=_0x1098fd['body'],_0x2a929d=await warehouse['findOne']({'name':_0x47b224,'room':_0x130780}),_0x5d8335=await purchases['findOne']({'invoice':_0x2873c8});_0x5d8335[_0x29e4ec(0x1fc)]['forEach'](_0x38b9c1=>{var _0x1846dc=_0x29e4ec,_0x595ce5=0x0;const _0x4c4124=_0x2a929d[_0x1846dc(0x26f)][_0x1846dc(0x247)](_0x213fac=>{var _0x13d4f2=_0x1846dc;_0x213fac[_0x13d4f2(0x21b)]==_0x38b9c1[_0x13d4f2(0x21b)]&&_0x213fac[_0x13d4f2(0x2d2)]==_0x38b9c1[_0x13d4f2(0x2d2)]&&_0x213fac[_0x13d4f2(0x284)]==_0x38b9c1[_0x13d4f2(0x284)]&&_0x213fac[_0x13d4f2(0x279)]==_0x38b9c1[_0x13d4f2(0x279)]&&_0x213fac[_0x13d4f2(0x26b)]==_0x38b9c1[_0x13d4f2(0x26b)]&&_0x213fac[_0x13d4f2(0x2c4)]==_0x38b9c1[_0x13d4f2(0x2c4)]&&_0x213fac[_0x13d4f2(0x249)]==_0x38b9c1[_0x13d4f2(0x249)]&&_0x213fac[_0x13d4f2(0x24b)]==_0x38b9c1['expiry_date']&&_0x213fac[_0x13d4f2(0x1fb)]==_0x38b9c1['batch_code']&&_0x213fac['production_date']==_0x38b9c1[_0x13d4f2(0x301)]&&_0x213fac[_0x13d4f2(0x240)]==_0x38b9c1[_0x13d4f2(0x240)]&&_0x213fac[_0x13d4f2(0x224)]==_0x38b9c1[_0x13d4f2(0x224)]&&(_0x213fac[_0x13d4f2(0x2b2)]=parseInt(_0x213fac['product_stock'])+parseInt(_0x38b9c1['quantity']),_0x595ce5++);});_0x595ce5=='0'&&(_0x2a929d['product_details']=_0x2a929d[_0x1846dc(0x26f)][_0x1846dc(0x30e)]({'product_name':_0x38b9c1['product_name'],'product_stock':_0x38b9c1['quantity'],'primary_code':_0x38b9c1[_0x1846dc(0x255)],'secondary_code':_0x38b9c1[_0x1846dc(0x24a)],'product_code':_0x38b9c1['product_code'],'storage':_0x38b9c1[_0x1846dc(0x249)],'rack':_0x38b9c1['rack'],'bay':_0x38b9c1[_0x1846dc(0x26b)],'bin':_0x38b9c1[_0x1846dc(0x279)],'type':_0x38b9c1[_0x1846dc(0x284)],'floorlevel':_0x38b9c1[_0x1846dc(0x2d2)],'maxProducts':_0x38b9c1[_0x1846dc(0x22c)],'unit':_0x38b9c1['standard_unit'],'secondary_unit':_0x38b9c1['secondary_unit'],'expiry_date':_0x38b9c1['expiry_date'],'maxPerUnit':_0x38b9c1[_0x1846dc(0x1f3)],'batch_code':_0x38b9c1[_0x1846dc(0x1fb)],'alertQTY':_0x38b9c1[_0x1846dc(0x229)],'production_date':_0x38b9c1[_0x1846dc(0x301)],'delivery_date':_0x38b9c1[_0x1846dc(0x240)],'delivery_code':_0x38b9c1[_0x1846dc(0x224)]}));}),await _0x2a929d[_0x29e4ec(0x2c5)](),_0x5d8335[_0x29e4ec(0x27f)]=_0x29e4ec(0x271);const _0x14d5b1=await _0x5d8335[_0x29e4ec(0x2c5)]();_0x1098fd['flash'](_0x29e4ec(0x296),_0x29e4ec(0x27e)),_0x2ba653['redirect'](_0x29e4ec(0x2a7));}catch(_0x3bdb01){console[_0x29e4ec(0x1fe)](_0x3bdb01);}}),router[a0_0x6df540(0x275)]('/view/:id',auth,async(_0x3c1e5a,_0x54b306)=>{var _0x228c15=a0_0x6df540;try{const {username:_0x1a12f6,email:_0x4db496,role:_0x29c59e}=_0x3c1e5a['user'],_0x39b9a3=_0x3c1e5a[_0x228c15(0x245)],_0x101e81=await profile[_0x228c15(0x2a0)]({'email':_0x39b9a3['email']}),_0x3e9aa1=await master_shop[_0x228c15(0x1f4)](),_0x1dd008=_0x3c1e5a['params']['id'],_0x816b17=await purchases[_0x228c15(0x248)](_0x1dd008),_0x22083c=await suppliers[_0x228c15(0x1f4)]({});let _0x11b9b8;if(_0x39b9a3['role']==_0x228c15(0x24d)){const _0xea0bf8=await staff['findOne']({'email':_0x39b9a3[_0x228c15(0x288)]});_0x11b9b8=await warehouse[_0x228c15(0x1f4)]({'status':_0x228c15(0x2b4),'name':_0xea0bf8[_0x228c15(0x1fa)],'warehouse_category':_0x228c15(0x21f)});}else _0x11b9b8=await warehouse[_0x228c15(0x20f)]([{'$match':{'status':_0x228c15(0x2b4),'warehouse_category':_0x228c15(0x21f)}},{'$group':{'_id':_0x228c15(0x2c7),'name':{'$first':_0x228c15(0x2c7)}}}]);const _0x3983e7=await product[_0x228c15(0x1f4)]({}),_0x4b8674=BayBinSelected(_0x816b17['warehouse_name'],_0x816b17[_0x228c15(0x282)]);let _0x42d7b=new Date(_0x816b17[_0x228c15(0x24b)]),_0x5e8d4e=('0'+_0x42d7b[_0x228c15(0x2ba)]())[_0x228c15(0x2bf)](-0x2),_0x4547f5=('0'+(_0x42d7b[_0x228c15(0x2b1)]()+0x1))[_0x228c15(0x2bf)](-0x2),_0x54a8bd=_0x42d7b[_0x228c15(0x29d)](),_0x4793fa=_0x54a8bd+'-'+_0x4547f5+'-'+_0x5e8d4e;if(_0x3e9aa1[0x0][_0x228c15(0x2fd)]==_0x228c15(0x23d)){var _0x549d9e=users['English'];console[_0x228c15(0x1fe)](_0x549d9e);}else{if(_0x3e9aa1[0x0][_0x228c15(0x2fd)]==_0x228c15(0x25c))var _0x549d9e=users[_0x228c15(0x25c)];else{if(_0x3e9aa1[0x0][_0x228c15(0x2fd)]==_0x228c15(0x210))var _0x549d9e=users[_0x228c15(0x210)];else{if(_0x3e9aa1[0x0]['language']==_0x228c15(0x29e))var _0x549d9e=users[_0x228c15(0x29e)];else{if(_0x3e9aa1[0x0][_0x228c15(0x2fd)]=='French')var _0x549d9e=users[_0x228c15(0x2d0)];else{if(_0x3e9aa1[0x0][_0x228c15(0x2fd)]==_0x228c15(0x256))var _0x549d9e=users[_0x228c15(0x2ff)];else{if(_0x3e9aa1[0x0][_0x228c15(0x2fd)]==_0x228c15(0x2ad))var _0x549d9e=users['Chinese'];else{if(_0x3e9aa1[0x0][_0x228c15(0x2fd)]==_0x228c15(0x23c))var _0x549d9e=users[_0x228c15(0x234)];}}}}}}}_0x54b306[_0x228c15(0x233)]('edit_purchases',{'success':_0x3c1e5a['flash'](_0x228c15(0x296)),'errors':_0x3c1e5a['flash']('errors'),'role':_0x39b9a3,'profile':_0x101e81,'purchases':_0x816b17,'suppliers':_0x22083c,'warehouse':_0x11b9b8,'product':_0x3983e7,'master_shop':_0x3e9aa1,'language':_0x549d9e,'ed_fullDate':_0x4793fa,'dataSelected':_0x4b8674});}catch(_0x9345b6){console[_0x228c15(0x1fe)](_0x9345b6);}}),router['post'](a0_0x6df540(0x1f6),auth,async(_0x192764,_0x17ebc8)=>{var _0x595536=a0_0x6df540;try{const _0x5292b7=_0x192764[_0x595536(0x2e8)]['id'],_0x1227b4=await purchases[_0x595536(0x2a0)]({'_id':_0x192764['params']['id']}),_0x51a732=await warehouse[_0x595536(0x2a0)]({'name':_0x1227b4['warehouse_name'],'room':_0x1227b4['room']});_0x1227b4[_0x595536(0x1fc)]['forEach'](_0x48b594=>{var _0x1ef9fc=_0x595536;const _0x51b117=_0x51a732[_0x1ef9fc(0x26f)][_0x1ef9fc(0x247)](_0xdd80bd=>{var _0x59624d=_0x1ef9fc;_0xdd80bd[_0x59624d(0x21b)]==_0x48b594[_0x59624d(0x21b)]&&_0xdd80bd[_0x59624d(0x2d2)]==_0x48b594['floorlevel']&&_0xdd80bd[_0x59624d(0x284)]==_0x48b594['type']&&_0xdd80bd['bin']==_0x48b594[_0x59624d(0x279)]&&_0xdd80bd[_0x59624d(0x26b)]==_0x48b594[_0x59624d(0x26b)]&&_0xdd80bd[_0x59624d(0x2c4)]==_0x48b594[_0x59624d(0x2c4)]&&_0xdd80bd[_0x59624d(0x249)]==_0x48b594['storage']&&(_0xdd80bd[_0x59624d(0x2b2)]=parseInt(_0xdd80bd['product_stock'])-parseInt(_0x48b594['quantity']));});}),await _0x51a732[_0x595536(0x2c5)]();const {invoice:_0x4ab532,suppliers:_0x220916,date:_0x105552,warehouse_name:_0x33068c,prod_name:_0x27c766,prod_code:_0x219fbf,prod_qty:_0x10236a,prod_unit:_0x1836c9,prod_secondunit:_0x1fb441,prod_level:_0x9f1ea0,prod_isle:_0x195722,prod_pallet:_0x2d721e,note:_0xc10732,expiry_date:_0x2333df,batch_code:_0xde0a02,paid_amount:_0x356e27,due_amount:_0x20261b,Room_name:_0x7d7d0a,primary_code:_0x475322,secondary_code:_0x27fb45,PO_number:_0x28bdf4,JO_number:_0x1f2df4}=_0x192764[_0x595536(0x243)];if(typeof _0x27c766==_0x595536(0x2d7))var _0x4598f6=[_0x192764['body'][_0x595536(0x25e)]],_0x1f60a7=[_0x192764[_0x595536(0x243)]['prod_code']],_0x2f49a4=[_0x192764['body'][_0x595536(0x2f7)]],_0x45bfae=[_0x192764[_0x595536(0x243)][_0x595536(0x2b9)]],_0x239f83=[_0x192764['body'][_0x595536(0x27b)]],_0x390c55=[_0x192764['body'][_0x595536(0x253)]],_0x12095d=[_0x192764['body'][_0x595536(0x2c0)]],_0x35a148=[_0x192764[_0x595536(0x243)][_0x595536(0x30d)]],_0xdf5890=[_0x192764[_0x595536(0x243)][_0x595536(0x255)]],_0x464659=[_0x192764[_0x595536(0x243)][_0x595536(0x24a)]],_0x32381f=[_0x192764[_0x595536(0x243)][_0x595536(0x2df)]],_0xb7c7ae=[_0x192764[_0x595536(0x243)][_0x595536(0x1fb)]],_0x3f3e94=[_0x192764[_0x595536(0x243)][_0x595536(0x24b)]],_0xfa2fed=[_0x192764['body'][_0x595536(0x249)]],_0x8ac646=[_0x192764[_0x595536(0x243)][_0x595536(0x2d1)]],_0x2fb426=[_0x192764[_0x595536(0x243)][_0x595536(0x284)]];else var _0x4598f6=[..._0x192764[_0x595536(0x243)][_0x595536(0x25e)]],_0x1f60a7=[..._0x192764[_0x595536(0x243)][_0x595536(0x30c)]],_0x2f49a4=[..._0x192764[_0x595536(0x243)][_0x595536(0x2f7)]],_0x45bfae=[..._0x192764['body'][_0x595536(0x2b9)]],_0x239f83=[..._0x192764[_0x595536(0x243)]['prod_secondunit']],_0x390c55=[..._0x192764[_0x595536(0x243)]['prod_level']],_0x12095d=[..._0x192764[_0x595536(0x243)][_0x595536(0x2c0)]],_0x35a148=[..._0x192764[_0x595536(0x243)][_0x595536(0x30d)]],_0xdf5890=[..._0x192764[_0x595536(0x243)][_0x595536(0x255)]],_0x464659=[..._0x192764[_0x595536(0x243)][_0x595536(0x24a)]],_0x32381f=[..._0x192764[_0x595536(0x243)]['MaxStocks_data']],_0xb7c7ae=[..._0x192764[_0x595536(0x243)][_0x595536(0x1fb)]],_0x3f3e94=[..._0x192764[_0x595536(0x243)][_0x595536(0x24b)]],_0xfa2fed=[..._0x192764[_0x595536(0x243)][_0x595536(0x249)]],_0x8ac646=[..._0x192764['body'][_0x595536(0x2d1)]],_0x2fb426=[..._0x192764['body'][_0x595536(0x284)]];const _0x45ebe1=_0x4598f6[_0x595536(0x247)](_0x701935=>{return _0x701935={'product_name':_0x701935};});_0x1f60a7[_0x595536(0x207)]((_0x1a6d04,_0x33f9d4)=>{_0x45ebe1[_0x33f9d4]['product_code']=_0x1a6d04;}),_0x2f49a4[_0x595536(0x207)]((_0x8ce24f,_0x324922)=>{_0x45ebe1[_0x324922]['quantity']=_0x8ce24f;}),_0x45bfae[_0x595536(0x207)]((_0x579850,_0x904f1b)=>{_0x45ebe1[_0x904f1b]['standard_unit']=_0x579850;}),_0x239f83[_0x595536(0x207)]((_0x12b023,_0x4793a7)=>{var _0x265564=_0x595536;_0x45ebe1[_0x4793a7][_0x265564(0x28a)]=_0x12b023;}),_0x390c55['forEach']((_0x4b075e,_0x175008)=>{_0x45ebe1[_0x175008]['bay']=_0x4b075e;}),_0x12095d[_0x595536(0x207)]((_0x2b358a,_0x33e3a4)=>{var _0x1dcfd1=_0x595536;_0x45ebe1[_0x33e3a4][_0x1dcfd1(0x279)]=_0x2b358a;}),_0x35a148[_0x595536(0x207)]((_0x1f65a2,_0x35efc2)=>{var _0x321633=_0x595536;_0x45ebe1[_0x35efc2][_0x321633(0x2d2)]=_0x1f65a2;}),_0xdf5890[_0x595536(0x207)]((_0x366696,_0x917032)=>{_0x45ebe1[_0x917032]['primary_code']=_0x366696;}),_0x464659[_0x595536(0x207)]((_0x1d3bb2,_0x466791)=>{var _0x194ad4=_0x595536;_0x45ebe1[_0x466791][_0x194ad4(0x24a)]=_0x1d3bb2;}),_0x32381f[_0x595536(0x207)]((_0x768c54,_0x219d0d)=>{_0x45ebe1[_0x219d0d]['maxStocks']=_0x768c54;}),_0xb7c7ae[_0x595536(0x207)]((_0x5c4915,_0x333268)=>{_0x45ebe1[_0x333268]['batch_code']=_0x5c4915;}),_0x3f3e94[_0x595536(0x207)]((_0x50a9b3,_0x3915dd)=>{var _0x46105e=_0x595536;_0x45ebe1[_0x3915dd][_0x46105e(0x24b)]=_0x50a9b3;}),_0x2fb426[_0x595536(0x207)]((_0x59a1d5,_0x301ccd)=>{_0x45ebe1[_0x301ccd]['type']=_0x59a1d5;}),_0xfa2fed[_0x595536(0x207)]((_0x427bfb,_0x408810)=>{_0x45ebe1[_0x408810]['storage']=_0x427bfb;}),_0x8ac646[_0x595536(0x207)]((_0xa40793,_0x5eaa15)=>{_0x45ebe1[_0x5eaa15]['rack']=_0xa40793;});const _0x59ad26=_0x45ebe1['filter'](_0x4d7779=>_0x4d7779[_0x595536(0x29a)]!=='0'&&_0x4d7779['quantity']!=='');_0x1227b4[_0x595536(0x264)]=_0x4ab532,_0x1227b4['suppliers']=_0x220916,_0x1227b4[_0x595536(0x214)]=_0x105552,_0x1227b4[_0x595536(0x300)]=_0x33068c,_0x1227b4[_0x595536(0x1fc)]=_0x59ad26,_0x1227b4[_0x595536(0x27d)]=_0xc10732,_0x1227b4[_0x595536(0x2ec)]=_0x356e27,_0x1227b4['due_amount']=_0x20261b,_0x1227b4[_0x595536(0x282)]=_0x7d7d0a,_0x1227b4[_0x595536(0x2a8)]=_0x28bdf4,_0x1227b4['JO_number']=_0x1f2df4;const _0x1f621f=await _0x1227b4['save'](),_0x3d79d2=await warehouse['findOne']({'name':_0x192764[_0x595536(0x243)][_0x595536(0x300)],'room':_0x192764[_0x595536(0x243)]['Room_name']});_0x1227b4[_0x595536(0x1fc)][_0x595536(0x207)](_0x4c3a8a=>{var _0x5cd635=_0x595536,_0x2831ab=0x0;const _0x539ed0=_0x3d79d2[_0x5cd635(0x26f)][_0x5cd635(0x247)](_0x9016f1=>{var _0x238514=_0x5cd635;_0x9016f1[_0x238514(0x21b)]==_0x4c3a8a[_0x238514(0x21b)]&&_0x9016f1[_0x238514(0x2d2)]==_0x4c3a8a['floorlevel']&&_0x9016f1['type']==_0x4c3a8a[_0x238514(0x284)]&&_0x9016f1[_0x238514(0x279)]==_0x4c3a8a[_0x238514(0x279)]&&_0x9016f1[_0x238514(0x26b)]==_0x4c3a8a[_0x238514(0x26b)]&&_0x9016f1[_0x238514(0x2c4)]==_0x4c3a8a[_0x238514(0x2c4)]&&_0x9016f1[_0x238514(0x249)]==_0x4c3a8a[_0x238514(0x249)]&&(_0x9016f1['product_stock']=parseInt(_0x9016f1[_0x238514(0x2b2)])+parseInt(_0x4c3a8a[_0x238514(0x29a)]),_0x2831ab++);});_0x2831ab=='0'&&(_0x3d79d2[_0x5cd635(0x26f)]=_0x3d79d2[_0x5cd635(0x26f)][_0x5cd635(0x30e)]({'product_name':_0x4c3a8a[_0x5cd635(0x21b)],'product_stock':_0x4c3a8a[_0x5cd635(0x29a)],'primary_code':_0x4c3a8a['primary_code'],'secondary_code':_0x4c3a8a[_0x5cd635(0x24a)],'product_code':_0x4c3a8a['product_code'],'storage':_0x4c3a8a[_0x5cd635(0x249)],'rack':_0x4c3a8a[_0x5cd635(0x2c4)],'bay':_0x4c3a8a[_0x5cd635(0x26b)],'bin':_0x4c3a8a[_0x5cd635(0x279)],'type':_0x4c3a8a[_0x5cd635(0x284)],'floorlevel':_0x4c3a8a[_0x5cd635(0x2d2)],'maxProducts':_0x4c3a8a[_0x5cd635(0x22c)],'unit':_0x4c3a8a[_0x5cd635(0x2d9)],'secondary_unit':_0x4c3a8a[_0x5cd635(0x28a)],'expiry_date':_0x4c3a8a['expiry_date']}));}),await _0x3d79d2[_0x595536(0x2c5)]();const _0x48154f=await s_payment_data[_0x595536(0x2a0)]({'invoice':_0x192764[_0x595536(0x243)][_0x595536(0x264)]});if(_0x48154f===null){}else console[_0x595536(0x1fe)]('suppliers',_0x48154f,_0x192764[_0x595536(0x243)][_0x595536(0x264)]),_0x48154f[_0x595536(0x2fc)]=_0x192764[_0x595536(0x243)]['suppliers'],await _0x48154f[_0x595536(0x2c5)]();_0x192764[_0x595536(0x20d)]('success',_0x595536(0x217)),_0x17ebc8[_0x595536(0x223)](_0x595536(0x2a7));}catch(_0x4ae0b1){console['log'](_0x4ae0b1);}}),router['post'](a0_0x6df540(0x277),auth,async(_0x449530,_0xe20d3e)=>{var _0x48ac29=a0_0x6df540;try{const _0x1f4369=_0x449530[_0x48ac29(0x2e8)]['id'],{invoice:_0x33d4c5,suppliers:_0x3ff41c,payable:_0x10cbb8,due_amount:_0x143125}=_0x449530[_0x48ac29(0x243)],_0x416e13=await purchases[_0x48ac29(0x248)](_0x1f4369);var _0x889793=_0x10cbb8-_0x143125;_0x416e13[_0x48ac29(0x2ec)]=parseFloat(_0x416e13[_0x48ac29(0x2ec)])+parseFloat(_0x143125),_0x416e13['due_amount']=_0x889793;const _0x599caf=await _0x416e13[_0x48ac29(0x2c5)]();console[_0x48ac29(0x1fe)](_0x599caf);const _0x327ec1=await s_payment_data[_0x48ac29(0x2a0)]({'invoice':_0x33d4c5});_0x327ec1[_0x48ac29(0x2fb)]=_0x889793,await _0x327ec1['save']();let _0x4afcae=new Date(),_0x47341e=('0'+_0x4afcae[_0x48ac29(0x2ba)]())[_0x48ac29(0x2bf)](-0x2),_0x1dc55c=('0'+(_0x4afcae[_0x48ac29(0x2b1)]()+0x1))['slice'](-0x2),_0x32f556=_0x4afcae[_0x48ac29(0x29d)](),_0x3821b9=_0x32f556+'-'+_0x1dc55c+'-'+_0x47341e;const _0x30ec47=new suppliers_payment({'invoice':_0x33d4c5,'date':_0x32f556+'-'+_0x1dc55c+'-'+_0x47341e,'suppliers':_0x3ff41c,'reason':'Paid\x20For\x20Purchase','amount':_0x143125}),_0x199872=await _0x30ec47[_0x48ac29(0x2c5)]();_0x449530['flash'](_0x48ac29(0x296),_0x48ac29(0x2db)),_0xe20d3e['redirect'](_0x48ac29(0x2a7));}catch(_0x800535){console[_0x48ac29(0x1fe)](_0x800535);}}),router[a0_0x6df540(0x275)](a0_0x6df540(0x252),auth,async(_0x2cc693,_0x4e49c8)=>{var _0xd0e11=a0_0x6df540;try{const {username:_0x3581e5,email:_0x2a71b5,role:_0x5b7668}=_0x2cc693[_0xd0e11(0x245)],_0x29413c=_0x2cc693[_0xd0e11(0x245)],_0x358ced=await profile[_0xd0e11(0x2a0)]({'email':_0x29413c[_0xd0e11(0x288)]}),_0xbbf697=await master_shop[_0xd0e11(0x1f4)]();console['log'](_0xd0e11(0x2b6),_0xbbf697);const _0x50a831=_0x2cc693[_0xd0e11(0x2e8)]['id'],_0x178efe=await purchases[_0xd0e11(0x248)](_0x50a831);console['log'](_0x178efe);const _0x2d546b=await suppliers[_0xd0e11(0x2a0)]({'name':_0x178efe[_0xd0e11(0x2fc)]});console[_0xd0e11(0x1fe)](_0x2d546b);if(_0xbbf697[0x0][_0xd0e11(0x2fd)]==_0xd0e11(0x23d)){var _0x201bb0=users['English'];console[_0xd0e11(0x1fe)](_0x201bb0);}else{if(_0xbbf697[0x0]['language']==_0xd0e11(0x25c))var _0x201bb0=users[_0xd0e11(0x25c)];else{if(_0xbbf697[0x0][_0xd0e11(0x2fd)]==_0xd0e11(0x210))var _0x201bb0=users[_0xd0e11(0x210)];else{if(_0xbbf697[0x0][_0xd0e11(0x2fd)]=='Spanish')var _0x201bb0=users['Spanish'];else{if(_0xbbf697[0x0]['language']==_0xd0e11(0x2d0))var _0x201bb0=users[_0xd0e11(0x2d0)];else{if(_0xbbf697[0x0][_0xd0e11(0x2fd)]==_0xd0e11(0x256))var _0x201bb0=users[_0xd0e11(0x2ff)];else{if(_0xbbf697[0x0][_0xd0e11(0x2fd)]=='Chinese')var _0x201bb0=users[_0xd0e11(0x2ad)];else{if(_0xbbf697[0x0][_0xd0e11(0x2fd)]=='Arabic\x20(ae)')var _0x201bb0=users[_0xd0e11(0x234)];}}}}}}}_0x4e49c8['render'](_0xd0e11(0x25d),{'success':_0x2cc693[_0xd0e11(0x20d)](_0xd0e11(0x296)),'errors':_0x2cc693[_0xd0e11(0x20d)](_0xd0e11(0x2ce)),'role':_0x29413c,'profile':_0x358ced,'master_shop':_0xbbf697,'supplier':_0x2d546b,'purchase':_0x178efe,'language':_0x201bb0});}catch(_0x3affb5){console[_0xd0e11(0x1fe)](_0x3affb5);}}),router[a0_0x6df540(0x275)](a0_0x6df540(0x2cf),auth,async(_0x175afb,_0xd619b7)=>{var _0x25ac55=a0_0x6df540;try{const {username:_0x5d19b7,email:_0x1bd6e8,role:_0x4fc564}=_0x175afb[_0x25ac55(0x245)],_0x447b10=_0x175afb['user'],_0x43476f=await profile[_0x25ac55(0x2a0)]({'email':_0x447b10[_0x25ac55(0x288)]}),_0x56ec7a=await master_shop[_0x25ac55(0x1f4)]();console['log'](_0x25ac55(0x2b6),_0x56ec7a);const _0x584d6c=_0x175afb[_0x25ac55(0x2e8)]['id'];console['log'](_0x584d6c);const _0x5e415a=await purchases[_0x25ac55(0x248)](_0x584d6c);console[_0x25ac55(0x1fe)](_0x25ac55(0x22a),_0x5e415a);const _0x3175f2=await product[_0x25ac55(0x1f4)]({}),_0x2d4fc0=await warehouse['aggregate']([{'$match':{'name':_0x5e415a[_0x25ac55(0x300)],'room':_0x5e415a['room'],'warehouse_category':_0x25ac55(0x21f)}},{'$unwind':_0x25ac55(0x205)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x25ac55(0x280)},'product_stock':{'$first':_0x25ac55(0x2b0)},'bay':{'$first':_0x25ac55(0x29f)},'bin':{'$first':_0x25ac55(0x2b3)},'type':{'$first':_0x25ac55(0x23b)},'floorlevel':{'$first':_0x25ac55(0x2af)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x25ac55(0x276)},'storage':{'$first':_0x25ac55(0x24f)},'rack':{'$first':_0x25ac55(0x2a6)}}}]);warehouse_data=await warehouse[_0x25ac55(0x20f)]([{'$match':{'status':_0x25ac55(0x2b4),'name':_0x25ac55(0x2e7),'warehouse_category':_0x25ac55(0x21f)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),console['log'](_0x25ac55(0x26d),_0x2d4fc0);if(_0x56ec7a[0x0]['language']==_0x25ac55(0x23d)){var _0x24fe08=users[_0x25ac55(0x27c)];console[_0x25ac55(0x1fe)](_0x24fe08);}else{if(_0x56ec7a[0x0][_0x25ac55(0x2fd)]==_0x25ac55(0x25c))var _0x24fe08=users[_0x25ac55(0x25c)];else{if(_0x56ec7a[0x0][_0x25ac55(0x2fd)]==_0x25ac55(0x210))var _0x24fe08=users[_0x25ac55(0x210)];else{if(_0x56ec7a[0x0]['language']=='Spanish')var _0x24fe08=users[_0x25ac55(0x29e)];else{if(_0x56ec7a[0x0][_0x25ac55(0x2fd)]=='French')var _0x24fe08=users[_0x25ac55(0x2d0)];else{if(_0x56ec7a[0x0][_0x25ac55(0x2fd)]==_0x25ac55(0x256))var _0x24fe08=users[_0x25ac55(0x2ff)];else{if(_0x56ec7a[0x0]['language']==_0x25ac55(0x2ad))var _0x24fe08=users[_0x25ac55(0x2ad)];else{if(_0x56ec7a[0x0]['language']==_0x25ac55(0x23c))var _0x24fe08=users[_0x25ac55(0x234)];}}}}}}}_0xd619b7[_0x25ac55(0x233)]('return_purchase',{'success':_0x175afb['flash']('success'),'errors':_0x175afb['flash']('errors'),'role':_0x447b10,'profile':_0x43476f,'user':_0x5e415a,'stock':_0x2d4fc0,'master_shop':_0x56ec7a,'product':_0x3175f2,'language':_0x24fe08,'warehouse':warehouse_data});}catch(_0x423097){console[_0x25ac55(0x1fe)](_0x423097);}}),router[a0_0x6df540(0x228)](a0_0x6df540(0x2cf),auth,async(_0x4e9aa9,_0x59ae5f)=>{var _0x31de25=a0_0x6df540;try{const {invoice:_0x1f3a74,date:_0x4d7f27,warehouse_name:_0x3a63ab,Room_name:_0x4dd3c9,product_name:_0x5e7040,purchase_quantity:_0x67c0cc,stocks:_0x418895,return_qty:_0x3b1a9c,note:_0x598d73,level:_0x141f48,isle:_0x5ea1b2,pallet:_0xd90bee,to_warehouse_name:_0x3810cd,to_Room_name:_0x2770c3}=_0x4e9aa9[_0x31de25(0x243)],_0x421caa=await purchases[_0x31de25(0x2a0)]({'_id':_0x4e9aa9[_0x31de25(0x2e8)]['id']}),_0x52caef=await warehouse[_0x31de25(0x2a0)]({'name':_0x3a63ab,'room':_0x4dd3c9});if(typeof _0x5e7040==_0x31de25(0x2d7))var _0x4b9c79=[_0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x21b)]],_0x55ab5c=[_0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2da)]],_0x5da3f5=[_0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x287)]],_0x40ff38=[_0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2c8)]],_0x17fc8e=[_0x4e9aa9['body'][_0x31de25(0x2f1)]],_0x30b222=[_0x4e9aa9['body'][_0x31de25(0x298)]],_0x30d2cd=[_0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2d4)]],_0x6fc766=[_0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2a4)]],_0x464cf1=[_0x4e9aa9[_0x31de25(0x243)]['product_code_hide']],_0x552074=[_0x4e9aa9['body'][_0x31de25(0x258)]],_0xfa8ed6=[_0x4e9aa9[_0x31de25(0x243)]['secondary_code_hide']];else var _0x4b9c79=[..._0x4e9aa9[_0x31de25(0x243)]['product_name']],_0x55ab5c=[..._0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2da)]],_0x5da3f5=[..._0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x287)]],_0x40ff38=[..._0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2c8)]],_0x17fc8e=[..._0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2f1)]],_0x30b222=[..._0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x298)]],_0x30d2cd=[..._0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2d4)]],_0x6fc766=[..._0x4e9aa9[_0x31de25(0x243)]['types']],_0x464cf1=[..._0x4e9aa9[_0x31de25(0x243)]['product_code_hide']],_0x552074=[..._0x4e9aa9[_0x31de25(0x243)]['primary_code_hide']],_0xfa8ed6=[..._0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2a5)]];const _0x4382b4=_0x4b9c79[_0x31de25(0x247)](_0x5865bc=>{return _0x5865bc={'product_name':_0x5865bc};});_0x55ab5c[_0x31de25(0x207)]((_0x36f412,_0x2dc6c9)=>{var _0x4f4be1=_0x31de25;_0x4382b4[_0x2dc6c9][_0x4f4be1(0x2da)]=_0x36f412;}),_0x5da3f5[_0x31de25(0x207)]((_0x50609a,_0x3a2b00)=>{var _0x32d8ac=_0x31de25;_0x4382b4[_0x3a2b00][_0x32d8ac(0x2f5)]=_0x50609a;}),_0x40ff38['forEach']((_0x43865e,_0x141960)=>{var _0x315cf3=_0x31de25;_0x4382b4[_0x141960][_0x315cf3(0x2c8)]=_0x43865e;}),_0x17fc8e[_0x31de25(0x207)]((_0x5722d4,_0x3b4f9d)=>{var _0x1c10a5=_0x31de25;_0x4382b4[_0x3b4f9d][_0x1c10a5(0x26b)]=_0x5722d4;}),_0x30b222[_0x31de25(0x207)]((_0x200039,_0xa9c844)=>{var _0x399d05=_0x31de25;_0x4382b4[_0xa9c844][_0x399d05(0x279)]=_0x200039;}),_0x30d2cd[_0x31de25(0x207)]((_0xe45464,_0x31a52d)=>{var _0x354e32=_0x31de25;_0x4382b4[_0x31a52d][_0x354e32(0x2d2)]=_0xe45464;}),_0x6fc766[_0x31de25(0x207)]((_0x10639a,_0x4ded13)=>{_0x4382b4[_0x4ded13]['type']=_0x10639a;}),_0x464cf1['forEach']((_0x4d9384,_0x30675c)=>{var _0x1aec99=_0x31de25;_0x4382b4[_0x30675c][_0x1aec99(0x297)]=_0x4d9384;}),_0x552074[_0x31de25(0x207)]((_0x1f0cf6,_0x57e8a9)=>{_0x4382b4[_0x57e8a9]['primary_code']=_0x1f0cf6;}),_0xfa8ed6[_0x31de25(0x207)]((_0x31d72b,_0x338226)=>{var _0x453fc9=_0x31de25;_0x4382b4[_0x338226][_0x453fc9(0x24a)]=_0x31d72b;}),_0x421caa[_0x31de25(0x1fc)]['forEach'](_0x49f33f=>{var _0x2ec06c=_0x31de25;const _0x1b10af=_0x52caef[_0x2ec06c(0x26f)]['map'](_0xd29414=>{var _0x2217d8=_0x2ec06c;_0xd29414['product_name']==_0x49f33f['product_name']&&_0xd29414['floorlevel']==_0x49f33f[_0x2217d8(0x2d2)]&&_0xd29414['type']==_0x49f33f[_0x2217d8(0x284)]&&_0xd29414[_0x2217d8(0x279)]==_0x49f33f[_0x2217d8(0x279)]&&_0xd29414[_0x2217d8(0x26b)]==_0x49f33f[_0x2217d8(0x26b)]&&_0xd29414['rack']==_0x49f33f['rack']&&_0xd29414[_0x2217d8(0x249)]==_0x49f33f[_0x2217d8(0x249)]&&(console[_0x2217d8(0x1fe)](parseInt(_0xd29414['product_stock'])+_0x2217d8(0x25b)+parseInt(_0x49f33f[_0x2217d8(0x29a)])),_0xd29414[_0x2217d8(0x2b2)]=parseInt(_0xd29414[_0x2217d8(0x2b2)])+parseInt(_0x49f33f[_0x2217d8(0x29a)]));});}),await _0x52caef[_0x31de25(0x2c5)]();const _0x1dc817=_0x4382b4[_0x31de25(0x28d)](_0x1d23f2=>_0x1d23f2[_0x31de25(0x2c8)]!=='0'&&_0x1d23f2[_0x31de25(0x2c8)]!=='');var _0x273f15=0x0;_0x1dc817[_0x31de25(0x207)](_0x4770bb=>{var _0x5c895a=_0x31de25;console['log']('foreach\x20newproduct',_0x4770bb),(parseInt(_0x4770bb[_0x5c895a(0x2da)])<parseInt(_0x4770bb[_0x5c895a(0x2c8)])||parseInt(_0x4770bb[_0x5c895a(0x2f5)])<parseInt(_0x4770bb['return_qty']))&&_0x273f15++;});if(_0x273f15!=0x0)return _0x4e9aa9[_0x31de25(0x20d)](_0x31de25(0x2ce),_0x31de25(0x2d5)),_0x59ae5f[_0x31de25(0x223)](_0x31de25(0x2bb));const _0x16580d=new purchases_return({'invoice':_0x1f3a74,'suppliers':_0x4e9aa9[_0x31de25(0x243)]['suppliers'],'date':_0x4d7f27,'warehouse_name':_0x3a63ab,'return_product':_0x1dc817,'note':_0x598d73,'room':_0x4dd3c9,'to_warehouse_name':_0x3810cd,'to_room':_0x2770c3}),_0x3c2096=await _0x16580d[_0x31de25(0x2c5)]();console[_0x31de25(0x1fe)](_0x16580d);const _0x5e76f9=await purchases_return[_0x31de25(0x2a0)]({'invoice':_0x1f3a74}),_0x14d437=await warehouse[_0x31de25(0x2a0)]({'name':_0x3810cd,'room':_0x2770c3});_0x5e76f9[_0x31de25(0x30f)]['forEach'](_0x3475a4=>{var _0x2cf681=_0x31de25,_0x10aa19=0x0;const _0x24dbc9=_0x14d437[_0x2cf681(0x26f)][_0x2cf681(0x247)](_0x10d8ce=>{var _0x28ebac=_0x2cf681;_0x10d8ce['product_name']==_0x3475a4['product_name']&&_0x10d8ce[_0x28ebac(0x2d2)]==_0x3475a4[_0x28ebac(0x2d2)]&&_0x10d8ce[_0x28ebac(0x284)]==_0x3475a4[_0x28ebac(0x284)]&&_0x10d8ce[_0x28ebac(0x279)]==_0x3475a4[_0x28ebac(0x279)]&&_0x10d8ce['bay']==_0x3475a4[_0x28ebac(0x26b)]&&(_0x10d8ce[_0x28ebac(0x2b2)]=parseInt(_0x10d8ce[_0x28ebac(0x2b2)])-parseInt(_0x3475a4[_0x28ebac(0x2c8)]),_0x10aa19++);});_0x10aa19=='0'&&(_0x14d437[_0x2cf681(0x26f)]=_0x14d437[_0x2cf681(0x26f)]['concat']({'product_name':_0x3475a4[_0x2cf681(0x21b)],'product_stock':_0x3475a4[_0x2cf681(0x2c8)],'primary_code':_0x3475a4[_0x2cf681(0x255)],'secondary_code':_0x3475a4['secondary_code'],'product_code':_0x3475a4[_0x2cf681(0x297)],'storage':_0x3475a4[_0x2cf681(0x249)],'rack':_0x3475a4['rack'],'bay':_0x3475a4[_0x2cf681(0x26b)],'bin':_0x3475a4[_0x2cf681(0x279)],'type':_0x3475a4[_0x2cf681(0x284)],'floorlevel':_0x3475a4[_0x2cf681(0x2d2)],'maxProducts':_0x3475a4[_0x2cf681(0x22c)],'unit':_0x3475a4['standard_unit'],'secondary_unit':_0x3475a4[_0x2cf681(0x28a)],'expiry_date':_0x3475a4[_0x2cf681(0x24b)]}));}),await _0x14d437[_0x31de25(0x2c5)]();const _0x12be1c=await purchases['findOne']({'invoice':_0x1f3a74});_0x12be1c['return_data']=_0x31de25(0x271);const _0x25f6bd=await _0x12be1c['save'](),_0x4cd141=new s_payment_data({'invoice':_0x1f3a74,'suppliers':_0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2fc)],'reason':_0x31de25(0x28e)});await _0x4cd141[_0x31de25(0x2c5)]();const _0x386950=await master_shop[_0x31de25(0x1f4)]();console[_0x31de25(0x1fe)]('add\x20post',_0x386950[0x0][_0x31de25(0x238)]);const _0x2cdcae=await email_settings[_0x31de25(0x2a0)](),_0x4fef2a=await suppliers[_0x31de25(0x2a0)]({'name':_0x4e9aa9[_0x31de25(0x243)][_0x31de25(0x2fc)]});console[_0x31de25(0x1fe)](_0x31de25(0x266),_0x4fef2a);_0x386950[0x0][_0x31de25(0x307)]==0x1?(right_currency=_0x386950[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x386950[0x0][_0x31de25(0x227)]);var _0x4252a4=_0x4b9c79,_0x38f780=_0x40ff38,_0x49fbfe='',_0x4f992c;for(_0x4f992c in _0x4252a4){_0x49fbfe+='<tr>'+_0x31de25(0x289)+_0x4252a4[_0x4f992c]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x38f780[_0x4f992c]+_0x31de25(0x292)+_0x31de25(0x25a);}console[_0x31de25(0x1fe)](_0x31de25(0x21c),_0x49fbfe);let _0x58e2bd=nodemailer[_0x31de25(0x259)]({'service':_0x31de25(0x2f3),'auth':{'user':_0x2cdcae['email'],'pass':_0x2cdcae[_0x31de25(0x2f4)]}}),_0x49748d={'from':_0x2cdcae['email'],'to':_0x4fef2a[_0x31de25(0x288)],'subject':_0x31de25(0x2e1),'attachments':[{'filename':_0x31de25(0x239),'path':__dirname+_0x31de25(0x2cd)+_0x31de25(0x23f)+_0x386950[0x0][_0x31de25(0x238)],'cid':_0x31de25(0x2d3)}],'html':_0x31de25(0x286)+'<html><head><title></title>'+_0x31de25(0x285)+_0x31de25(0x2b8)+_0x31de25(0x2de)+_0x31de25(0x2b8)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x31de25(0x23a)+'<div>'+_0x31de25(0x23e)+_0x386950[0x0][_0x31de25(0x202)]+'\x20</h2>'+_0x31de25(0x23a)+_0x31de25(0x23a)+_0x31de25(0x262)+_0x31de25(0x2b8)+_0x31de25(0x272)+'\x20Order\x20Number\x20:\x20'+_0x1f3a74+'\x20'+_0x31de25(0x20e)+_0x31de25(0x268)+_0x4d7f27+'\x20'+'</span>'+_0x31de25(0x269)+_0x31de25(0x23a)+_0x31de25(0x236)+_0x31de25(0x308)+_0x31de25(0x211)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x31de25(0x254)+_0x31de25(0x29c)+_0x31de25(0x246)+_0x31de25(0x25a)+_0x31de25(0x221)+_0x31de25(0x20c)+'\x20'+_0x49fbfe+'\x20'+'</tbody>'+_0x31de25(0x2fe)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x31de25(0x306)+_0x386950[0x0]['site_title']+_0x31de25(0x269)+_0x31de25(0x23a)+_0x31de25(0x23a)+'</body></html>'};_0x58e2bd[_0x31de25(0x1f9)](_0x49748d,function(_0x18693e,_0x382d92){var _0x25eaf7=_0x31de25;_0x18693e?(console['log'](_0x18693e),console[_0x25eaf7(0x1fe)]('Error\x20Occurs')):console[_0x25eaf7(0x1fe)](_0x25eaf7(0x22d));}),_0x4e9aa9[_0x31de25(0x20d)](_0x31de25(0x296),_0x31de25(0x2dd)),_0x59ae5f[_0x31de25(0x223)](_0x31de25(0x2a7));}catch(_0x425120){console[_0x31de25(0x1fe)](_0x425120),_0x59ae5f[_0x31de25(0x2ca)](0xc8)[_0x31de25(0x295)]({'message':_0x425120['message']});}}),router['get']('/barcode/:id',auth,async(_0x399474,_0x1b725c)=>{var _0x3dfd8b=a0_0x6df540;try{const {username:_0x35d975,email:_0x126b9b,role:_0x5f1441}=_0x399474[_0x3dfd8b(0x245)],_0x12061d=_0x399474[_0x3dfd8b(0x245)],_0x183dba=await profile[_0x3dfd8b(0x2a0)]({'email':_0x12061d[_0x3dfd8b(0x288)]}),_0x20f3b4=await master_shop['find'](),_0x4fce6d=_0x399474[_0x3dfd8b(0x2e8)]['id'],_0x4babdb=await purchases[_0x3dfd8b(0x248)](_0x4fce6d);if(_0x20f3b4[0x0][_0x3dfd8b(0x2fd)]==_0x3dfd8b(0x23d))var _0x412809=users['English'];else{if(_0x20f3b4[0x0][_0x3dfd8b(0x2fd)]==_0x3dfd8b(0x25c))var _0x412809=users[_0x3dfd8b(0x25c)];else{if(_0x20f3b4[0x0][_0x3dfd8b(0x2fd)]==_0x3dfd8b(0x210))var _0x412809=users[_0x3dfd8b(0x210)];else{if(_0x20f3b4[0x0][_0x3dfd8b(0x2fd)]==_0x3dfd8b(0x29e))var _0x412809=users[_0x3dfd8b(0x29e)];else{if(_0x20f3b4[0x0]['language']==_0x3dfd8b(0x2d0))var _0x412809=users['French'];else{if(_0x20f3b4[0x0][_0x3dfd8b(0x2fd)]==_0x3dfd8b(0x256))var _0x412809=users['Portuguese'];else{if(_0x20f3b4[0x0][_0x3dfd8b(0x2fd)]=='Chinese')var _0x412809=users[_0x3dfd8b(0x2ad)];else{if(_0x20f3b4[0x0][_0x3dfd8b(0x2fd)]==_0x3dfd8b(0x23c))var _0x412809=users[_0x3dfd8b(0x234)];}}}}}}}_0x1b725c[_0x3dfd8b(0x233)](_0x3dfd8b(0x2f8),{'success':_0x399474['flash']('success'),'errors':_0x399474[_0x3dfd8b(0x20d)](_0x3dfd8b(0x2ce)),'role':_0x12061d,'profile':_0x183dba,'alldata':_0x4babdb,'master_shop':_0x20f3b4,'language':_0x412809}),console[_0x3dfd8b(0x1fe)](alldata);}catch(_0x260a28){console[_0x3dfd8b(0x1fe)](_0x260a28);}}),router[a0_0x6df540(0x228)]('/barcode_scanner',async(_0x378514,_0x55b828)=>{var _0x1f273c=a0_0x6df540;const {product_code:_0x4893c1}=_0x378514[_0x1f273c(0x243)];var _0x126ca8;const _0x456ff1=await product['aggregate']([{'$match':{'primary_code':_0x4893c1,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x1f273c(0x220),'name':{'$first':_0x1f273c(0x2c7)},'category':{'$first':_0x1f273c(0x218)},'brand':{'$first':_0x1f273c(0x20a)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x1f273c(0x2a2)},'product_code':{'$first':_0x1f273c(0x208)},'primary_code':{'$first':_0x1f273c(0x2ed)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x1f273c(0x2d6)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x1f273c(0x20b)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x140a14=await product[_0x1f273c(0x20f)]([{'$match':{'secondary_code':_0x4893c1,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x1f273c(0x220),'name':{'$first':_0x1f273c(0x2c7)},'category':{'$first':_0x1f273c(0x218)},'brand':{'$first':_0x1f273c(0x20a)},'unit':{'$first':_0x1f273c(0x265)},'alertquantity':{'$first':_0x1f273c(0x2a2)},'product_code':{'$first':_0x1f273c(0x208)},'primary_code':{'$first':_0x1f273c(0x2ed)},'secondary_code':{'$first':_0x1f273c(0x2a9)},'maxStocks':{'$first':_0x1f273c(0x2d6)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x1f273c(0x20b)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x456ff1['length']>0x0)_0x126ca8=_0x456ff1;else _0x140a14[_0x1f273c(0x2e2)]>0x0&&(_0x126ca8=_0x140a14);_0x55b828[_0x1f273c(0x295)](_0x126ca8);}),router[a0_0x6df540(0x228)](a0_0x6df540(0x251),async(_0x2e10c1,_0x4c16b0)=>{var _0x42a5f4=a0_0x6df540;const {primaryCode:_0x5003d5,secondaryCode:_0x3bc485,productCode:_0x30c665,bay:_0xadab0d,bin:_0x37e8bf,types:_0x448989,pallet:_0x3e3481,warehouses:_0x2a2e71,room:_0x38aa79}=_0x2e10c1[_0x42a5f4(0x243)];console[_0x42a5f4(0x1fe)](_0x2e10c1[_0x42a5f4(0x243)]);try{const _0x5a383f=await warehouse[_0x42a5f4(0x20f)]([{'$match':{'name':_0x2a2e71,'room':_0x38aa79}},{'$unwind':_0x42a5f4(0x205)},{'$match':{'product_details.bay':_0xadab0d,'product_details.bin':_0x37e8bf,'product_details.type':_0x448989}},{'$group':{'_id':_0x42a5f4(0x30b),'name':{'$first':_0x42a5f4(0x280)},'product_stock':{'$first':_0x42a5f4(0x2b0)},'level':{'$first':_0x42a5f4(0x21e)},'isle':{'$first':_0x42a5f4(0x215)},'pallet':{'$first':_0x42a5f4(0x302)},'maxProducts':{'$first':_0x42a5f4(0x226)}}}]);_0x4c16b0[_0x42a5f4(0x2ca)](0xc8)['json'](_0x5a383f);}catch(_0x5df3b1){_0x4c16b0[_0x42a5f4(0x2ca)](0x194)[_0x42a5f4(0x295)]({'message':_0x5df3b1[_0x42a5f4(0x1f7)]});}}),module[a0_0x6df540(0x28f)]=router;function a0_0x29d9(){var _0x53ae86=['filter','Purchase\x20Return','exports','role','An\x20error\x20occurred\x20while\x20saving\x20data.','</td>','$product','$product.room_name','json','success','product_code','isle','Purchase\x20Mail','quantity','INC-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','getFullYear','Spanish','$product_details.bay','findOne','max_product_unit','$alertquantity','$finalize','types','secondary_code_hide','$product_details.rack','/all_purchases/view','POnumber','$secondary_code','edit_purchases_view','add_purchases\x20error','prod_cat','Chinese','$room','$product_details.floorlevel','$product_details.product_stock','getMonth','product_stock','$product_details.bin','Enabled','$warehouse_name','master','DRY\x20STORAGE','<div>','prod_unit','getDate','back','product_cat','all_purchases','actual_qty','slice','prod_isle','then','express','427359KnVVMs','rack','save','actual_uom','$name','return_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','status','</span>','error','/../public','errors','/view/return_purchase/:id','French','rak','floorlevel','logo','pallet','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','$maxStocks','string','$product.bay','standard_unit','purchase_quantity','payment\x20successfull','4eVQOug','purchases\x20item\x20return\x20successfull','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','MaxStocks_data','../models/all_models','Purchase\x20Return\x20Mail','length','Rack\x20F','Floor','1332519jmdTXn','\x20Order\x20Number\x20:\x20','Return\x20Goods','params','11249Pfchno','$product.bin','Rack\x20A','paid_amount','$primary_code','$product_details.expiry_date','$return_data','Purchase\x20data\x20added\x20successfully','level','$invoice','gmail','password','stock_quantity','RoomAssign','prod_qty','all_purchases_barcode','/view','port','amount','suppliers','language','</table>','Portuguese','warehouse_name','production_date','$product_details.pallet','host','Receiving\x20Area','Router','<h5>','currency_placement','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','An\x20error\x20occurred.','padStart','$product_details._id','prod_code','prod_pallet','concat','return_product','$batch_code','maxperunit','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/view/:id','message','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','sendMail','warehouse','batch_code','product','785210NxSzTl','log','</tbody>','ejs','1424xqKsUA','site_title','$product.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','forEach','$product_code','\x20<\x20wew\x20>\x20','$brand','$secondary_unit','<tbody\x20style=\x22text-align:\x20center;\x22>','flash','<span\x20style=\x22float:\x20right;\x22>','aggregate','German','<tr>','<html><head><title></title>','catch','date','$product_details.isle','deliverycode','purchase\x20data\x20update\x20successfully','$category','room_name','push','product_name','product_list','name','$product_details.level','Raw\x20Materials','$_id','</thead>','../public/language/languages.json','redirect','delivery_code','<strong>\x20Regards\x20</strong>','$product_details.maxProducts','currency','post','alertQTY','user_id','$date','maxStocks','Email\x20sent\x20successfully','Level','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Rack\x20B','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','table\x20page','render','Arabic','$paid_amount','<table\x20style=\x22width:\x20100%\x20!important;\x22>','45CIAGft','image','Logo.png','</div>','$product_details.type','Arabic\x20(ae)','English\x20(US)','<h2>\x20','/upload/','delivery_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.secondary_code','body','1688346nfrIFl','user','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','map','findById','storage','secondary_code','expiry_date','\x20</h2>','staff','prod_Qty','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/CheckingWarehouse','/invoice/:id','prod_level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','primary_code','Portuguese\x20(BR)','../middleware/auth','primary_code_hide','createTransport','</tr>','\x20<>\x20','Hindi','purchase_invoice','prod_name','$suppliers_docs','nodemailer','toString','<hr\x20class=\x22my-3\x22>','$due_amount','invoice','$unit','suppliers_data','1644070tCwApu','\x20Order\x20Date\x20:\x20','</h5>','add_purchases','bay','abs','stock_data','$expiry_date','product_details','/view/add_purchases','True','<h5\x20style=\x22text-align:\x20left;\x22>','suppliers_docs','prod_invoice','get','$product_details.product_code','/give_payment/:id','$note','bin','/view/add_purchases/:id','prod_secondunit','English','note','Sales\x20Update\x20successfully','finalize','$product_details.product_name','floor','room','COLD\x20STORAGE','type','</head><body>','<!DOCTYPE\x20html>','stocks','email','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','secondary_unit','Rack\x20C','972626VxIHMi'];a0_0x29d9=function(){return _0x53ae86;};return a0_0x29d9();}