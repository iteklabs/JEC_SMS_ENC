var a0_0xab593a=a0_0x33dc;function a0_0x33dc(_0x435024,_0x59fd8b){var _0x6b8c42=a0_0x6b8c();return a0_0x33dc=function(_0x33dc75,_0x552106){_0x33dc75=_0x33dc75-0x120;var _0x386d63=_0x6b8c42[_0x33dc75];return _0x386d63;},a0_0x33dc(_0x435024,_0x59fd8b);}(function(_0x32477a,_0x136c9f){var _0x116cd9=a0_0x33dc,_0x1e8754=_0x32477a();while(!![]){try{var _0xfe69d8=parseInt(_0x116cd9(0x1db))/0x1*(-parseInt(_0x116cd9(0x229))/0x2)+parseInt(_0x116cd9(0x211))/0x3+parseInt(_0x116cd9(0x1b3))/0x4+parseInt(_0x116cd9(0x16f))/0x5+parseInt(_0x116cd9(0x15a))/0x6+-parseInt(_0x116cd9(0x18f))/0x7+-parseInt(_0x116cd9(0x155))/0x8*(-parseInt(_0x116cd9(0x1f0))/0x9);if(_0xfe69d8===_0x136c9f)break;else _0x1e8754['push'](_0x1e8754['shift']());}catch(_0x4afaca){_0x1e8754['push'](_0x1e8754['shift']());}}}(a0_0x6b8c,0x32d98));const express=require(a0_0xab593a(0x1ed)),app=express(),router=express[a0_0xab593a(0x1d3)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0xab593a(0x238)),auth=require(a0_0xab593a(0x22a)),nodemailer=require(a0_0xab593a(0x17b));var ejs=require(a0_0xab593a(0x120));const path=require(a0_0xab593a(0x1b2)),users=require(a0_0xab593a(0x19b));router[a0_0xab593a(0x189)](a0_0xab593a(0x123),auth,async(_0x519229,_0x534028)=>{var _0x220e0d=a0_0xab593a;try{const {username:_0x3ed7bb,email:_0x25696a,role:_0x3ed856}=_0x519229['user'],_0x55f9b5=_0x519229['user'],_0x27aa32=await profile[_0x220e0d(0x124)]({'email':_0x55f9b5[_0x220e0d(0x221)]}),_0x554804=await staff[_0x220e0d(0x124)]({'email':_0x55f9b5[_0x220e0d(0x221)]});if(_0x55f9b5[_0x220e0d(0x194)]==_0x220e0d(0x183)){const _0x27d8f8=await staff['findOne']({'email':_0x55f9b5[_0x220e0d(0x221)]});}const _0x29f47d=await master_shop[_0x220e0d(0x166)]();let _0xe09e61;if(_0x55f9b5[_0x220e0d(0x194)]=='staff'){const _0x5ae255=await staff['findOne']({'email':_0x55f9b5['email']});_0xe09e61=await purchases[_0x220e0d(0x14b)]([{'$match':{'warehouse_name':_0x5ae255['warehouse']}},{'$lookup':{'from':_0x220e0d(0x160),'localField':_0x220e0d(0x160),'foreignField':_0x220e0d(0x230),'as':_0x220e0d(0x13a)}},{'$unwind':_0x220e0d(0x143)},{'$unwind':_0x220e0d(0x167)},{'$group':{'_id':'$_id','invoice':{'$first':_0x220e0d(0x1f2)},'suppliers':{'$first':_0x220e0d(0x129)},'date':{'$first':_0x220e0d(0x1d2)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$first':_0x220e0d(0x1a6)},'product':{'$push':_0x220e0d(0x167)},'note':{'$first':'$note'},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x220e0d(0x12c)},'return_data':{'$first':_0x220e0d(0x1b0)},'batch_code':{'$first':_0x220e0d(0x14f)},'expiry_date':{'$first':_0x220e0d(0x16d)},'suppliers_docs':{'$first':_0x220e0d(0x143)},'total_product_quantity':{'$sum':_0x220e0d(0x162)},'level':{'$addToSet':_0x220e0d(0x20d)},'isle':{'$addToSet':_0x220e0d(0x1c3)},'type':{'$addToSet':_0x220e0d(0x233)},'floorlevel':{'$addToSet':_0x220e0d(0x220)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0xe09e61=await purchases[_0x220e0d(0x14b)]([{'$lookup':{'from':'suppliers','localField':_0x220e0d(0x160),'foreignField':'name','as':_0x220e0d(0x13a)}},{'$unwind':_0x220e0d(0x143)},{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x220e0d(0x1f2)},'suppliers':{'$first':_0x220e0d(0x129)},'date':{'$first':_0x220e0d(0x1d2)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x220e0d(0x1c8)},'product':{'$push':_0x220e0d(0x167)},'note':{'$first':_0x220e0d(0x224)},'paid_amount':{'$first':_0x220e0d(0x17a)},'due_amount':{'$first':_0x220e0d(0x12c)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x220e0d(0x14f)},'expiry_date':{'$first':_0x220e0d(0x16d)},'suppliers_docs':{'$first':_0x220e0d(0x143)},'total_product_quantity':{'$sum':_0x220e0d(0x162)},'level':{'$addToSet':_0x220e0d(0x20d)},'isle':{'$addToSet':_0x220e0d(0x1c3)},'type':{'$addToSet':_0x220e0d(0x233)},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':_0x220e0d(0x1cb)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x29f47d[0x0]['language']==_0x220e0d(0x234)){var _0x4c4df9=users[_0x220e0d(0x1aa)];console[_0x220e0d(0x22e)](_0x4c4df9);}else{if(_0x29f47d[0x0][_0x220e0d(0x1bf)]==_0x220e0d(0x196))var _0x4c4df9=users[_0x220e0d(0x196)];else{if(_0x29f47d[0x0][_0x220e0d(0x1bf)]==_0x220e0d(0x195))var _0x4c4df9=users[_0x220e0d(0x195)];else{if(_0x29f47d[0x0][_0x220e0d(0x1bf)]==_0x220e0d(0x125))var _0x4c4df9=users[_0x220e0d(0x125)];else{if(_0x29f47d[0x0]['language']==_0x220e0d(0x21c))var _0x4c4df9=users[_0x220e0d(0x21c)];else{if(_0x29f47d[0x0][_0x220e0d(0x1bf)]==_0x220e0d(0x1d4))var _0x4c4df9=users[_0x220e0d(0x1bd)];else{if(_0x29f47d[0x0][_0x220e0d(0x1bf)]==_0x220e0d(0x19f))var _0x4c4df9=users['Chinese'];else{if(_0x29f47d[0x0]['language']=='Arabic\x20(ae)')var _0x4c4df9=users[_0x220e0d(0x158)];}}}}}}}_0x534028[_0x220e0d(0x141)](_0x220e0d(0x121),{'success':_0x519229['flash'](_0x220e0d(0x198)),'errors':_0x519229[_0x220e0d(0x18e)](_0x220e0d(0x208)),'purchases':_0xe09e61,'role':_0x55f9b5,'profile':_0x27aa32,'master_shop':_0x29f47d,'language':_0x4c4df9});}catch(_0x219ed3){console[_0x220e0d(0x22e)](_0x220e0d(0x20f),_0x219ed3),_0x534028[_0x220e0d(0x137)](0xc8)[_0x220e0d(0x1d8)]({'message':_0x219ed3['message']});}});function BayBinSelected(_0x31795a,_0x275144){var _0x3f3fae=a0_0xab593a,_0x4a2997=[],_0x48b621=[],_0x30b7dc=[],_0x3d937c=[],_0xc699c8=[],_0x22f1ab=[];let _0x563ad7=[];if(_0x31795a=='DRY\x20STORAGE')switch(_0x275144){case _0x3f3fae(0x19d):_0x4a2997=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x48b621=[0x1,0x2],_0x3d937c=[0x1,0x2,0x3,0x4,0x5],_0x30b7dc=['Level','Floor'],_0xc699c8=['D'],_0x22f1ab=['A'];break;case _0x3f3fae(0x1c2):_0x4a2997=[0x6,0x5,0x4,0x3,0x2,0x1],_0x48b621=[0x1,0x2],_0x3d937c=[0x1,0x2,0x3,0x4,0x5],_0x30b7dc=[_0x3f3fae(0x12b),'Floor'],_0xc699c8=['D'],_0x22f1ab=['B'];break;case _0x3f3fae(0x176):_0x4a2997=[0x0],_0x48b621=[0x0],_0x3d937c=[0x1,0x2,0x3,0x4,0x5],_0x30b7dc=['Floor'],_0xc699c8=['D'],_0x22f1ab=['S'];break;case _0x3f3fae(0x199):_0x4a2997=[0x0],_0x48b621=[0x0],_0x3d937c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x30b7dc=[_0x3f3fae(0x188)],_0xc699c8=['D'],_0x22f1ab=['R'];break;}else{if(_0x31795a==_0x3f3fae(0x152))switch(_0x275144){case'Rack\x20A':_0x4a2997=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x48b621=['B','F'],_0x3d937c=[0x1,0x2,0x3,0x4,0x5],_0x30b7dc=['Level',_0x3f3fae(0x188)],_0xc699c8=['C'],_0x22f1ab=['A'];break;case'Rack\x20B':_0x4a2997=[0x5,0x4,0x3,0x2,0x1],_0x48b621=['F','B','S'],_0x3d937c=[0x1,0x2,0x3,0x4,0x5],_0x30b7dc=[_0x3f3fae(0x12b),_0x3f3fae(0x188)],_0xc699c8=['C'],_0x22f1ab=['B'];break;case _0x3f3fae(0x1e7):_0x4a2997=[0x1,0x2,0x3,0x4,0x5],_0x48b621=['B','F','S'],_0x3d937c=[0x5,0x4,0x3,0x2,0x1],_0x30b7dc=[_0x3f3fae(0x12b),_0x3f3fae(0x188)],_0xc699c8=['C'],_0x22f1ab=['C'];break;case _0x3f3fae(0x1ad):_0x4a2997=[0x5,0x4,0x3,0x2,0x1],_0x48b621=['F','B','S'],_0x3d937c=[0x1,0x2,0x3,0x4,0x5],_0x30b7dc=[_0x3f3fae(0x12b),'Floor'],_0xc699c8=['C'],_0x22f1ab=['D'];break;case'Rack\x20E':_0x4a2997=[0x4,0x3,0x2,0x1],_0x48b621=[0x1,0x2],_0x3d937c=[0x1,0x2,0x3,0x4,0x5],_0x30b7dc=[_0x3f3fae(0x12b),_0x3f3fae(0x188)],_0xc699c8=['C'],_0x22f1ab=['E'];break;case'Rack\x20F':_0x4a2997=[0x1,0x2,0x3],_0x48b621=[0x1,0x2],_0x3d937c=[0x1,0x2,0x3,0x4,0x5],_0x30b7dc=[_0x3f3fae(0x12b)],_0xc699c8=['C'],_0x22f1ab=['F'];break;}}return{'levels':_0x4a2997,'Isle':_0x48b621,'rack':_0x3d937c,'type':_0x30b7dc,'storage':_0xc699c8,'rak':_0x22f1ab};}async function getRandom8DigitNumber(){var _0x2384b3=a0_0xab593a;const _0xdc16b3=0x989680,_0x3fd451=0x5f5e0ff,_0x342fd2=Math[_0x2384b3(0x12e)](Math['random']()*(_0x3fd451-_0xdc16b3+0x1))+_0xdc16b3;var _0x25e251;const _0x229bc2=await purchases[_0x2384b3(0x124)]({'invoice':_0x2384b3(0x21d)+_0x342fd2});return _0x229bc2&&_0x229bc2[_0x2384b3(0x22f)]>0x0?_0x25e251=_0x2384b3(0x21d)+_0x342fd2:_0x25e251='INC-'+_0x342fd2,_0x25e251;}router[a0_0xab593a(0x189)]('/view/add_purchases',auth,async(_0x445d44,_0x12bbf0)=>{var _0x1fbf8e=a0_0xab593a;try{const {username:_0x398eed,email:_0x436e17,role:_0x2bef00}=_0x445d44['user'],_0x46695a=_0x445d44[_0x1fbf8e(0x191)],_0x5e1e6b=await profile['findOne']({'email':_0x46695a['email']}),_0x21ad9b=await master_shop[_0x1fbf8e(0x166)](),_0x11160e=await staff[_0x1fbf8e(0x124)]({'email':_0x46695a[_0x1fbf8e(0x221)]}),_0x1caed8=await suppliers['find']({});let _0x387029;if(_0x46695a[_0x1fbf8e(0x194)]==_0x1fbf8e(0x183)){const _0x16eb72=await staff[_0x1fbf8e(0x124)]({'email':_0x46695a['email']});_0x387029=await warehouse[_0x1fbf8e(0x14b)]([{'$match':{'status':_0x1fbf8e(0x153),'name':_0x16eb72[_0x1fbf8e(0x1b5)],'warehouse_category':_0x1fbf8e(0x1f1),'name':{'$ne':_0x1fbf8e(0x1d9)}}},{'$group':{'_id':_0x1fbf8e(0x138),'name':{'$first':_0x1fbf8e(0x138)}}}]);}else _0x387029=await warehouse[_0x1fbf8e(0x14b)]([{'$match':{'status':_0x1fbf8e(0x153),'warehouse_category':_0x1fbf8e(0x1f1),'name':{'$ne':_0x1fbf8e(0x1d9)}}},{'$group':{'_id':_0x1fbf8e(0x138),'name':{'$first':_0x1fbf8e(0x138)}}}]);const _0x1cbf2d=await product[_0x1fbf8e(0x166)]({}),_0x2c46d9=await warehouse[_0x1fbf8e(0x166)]({'status':_0x1fbf8e(0x153)}),_0xf8b9cc=await purchases[_0x1fbf8e(0x166)]({}),_0x5e113e=_0xf8b9cc['length']+0x1,_0x4a2394=_0x1fbf8e(0x21d)+_0x5e113e['toString']()[_0x1fbf8e(0x145)](0x5,'0');var _0x2f398e=[_0x1fbf8e(0x20b),'Enclosed'];if(_0x21ad9b[0x0][_0x1fbf8e(0x1bf)]==_0x1fbf8e(0x234))var _0x4af695=users[_0x1fbf8e(0x1aa)];else{if(_0x21ad9b[0x0][_0x1fbf8e(0x1bf)]=='Hindi')var _0x4af695=users[_0x1fbf8e(0x196)];else{if(_0x21ad9b[0x0][_0x1fbf8e(0x1bf)]==_0x1fbf8e(0x195))var _0x4af695=users['German'];else{if(_0x21ad9b[0x0][_0x1fbf8e(0x1bf)]==_0x1fbf8e(0x125))var _0x4af695=users[_0x1fbf8e(0x125)];else{if(_0x21ad9b[0x0][_0x1fbf8e(0x1bf)]==_0x1fbf8e(0x21c))var _0x4af695=users[_0x1fbf8e(0x21c)];else{if(_0x21ad9b[0x0][_0x1fbf8e(0x1bf)]=='Portuguese\x20(BR)')var _0x4af695=users[_0x1fbf8e(0x1bd)];else{if(_0x21ad9b[0x0][_0x1fbf8e(0x1bf)]==_0x1fbf8e(0x19f))var _0x4af695=users[_0x1fbf8e(0x19f)];else{if(_0x21ad9b[0x0]['language']==_0x1fbf8e(0x206))var _0x4af695=users[_0x1fbf8e(0x158)];}}}}}}}const _0x2245a2=getRandom8DigitNumber();_0x2245a2[_0x1fbf8e(0x130)](_0x215ff2=>{var _0x595751=_0x1fbf8e;_0x12bbf0[_0x595751(0x141)](_0x595751(0x1bc),{'success':_0x445d44['flash'](_0x595751(0x198)),'errors':_0x445d44[_0x595751(0x18e)](_0x595751(0x208)),'role':_0x46695a,'profile':_0x5e1e6b,'suppliers':_0x1caed8,'warehouse':_0x387029,'product':_0x1cbf2d,'invoice':_0x215ff2,'master_shop':_0x21ad9b,'language':_0x4af695,'find_data':_0x2c46d9,'rooms_data':_0x2f398e});})[_0x1fbf8e(0x1d7)](_0x3ada9d=>{var _0x3b9a1b=_0x1fbf8e;_0x445d44[_0x3b9a1b(0x18e)](_0x3b9a1b(0x208),_0x3b9a1b(0x1c9)),_0x12bbf0[_0x3b9a1b(0x1dc)](_0x3b9a1b(0x1da));});}catch(_0x5a7180){console[_0x1fbf8e(0x22e)](_0x5a7180);}}),router['get']('/view/add_purchases/:id',auth,async(_0x42caeb,_0x4b539a)=>{var _0x2c9837=a0_0xab593a;try{const _0x3a0558=_0x42caeb['params']['id'];console[_0x2c9837(0x22e)](_0x3a0558);const _0x53d6b3=await master_shop[_0x2c9837(0x166)]();console[_0x2c9837(0x22e)]('master',_0x53d6b3);const _0x25c504=await product[_0x2c9837(0x124)]({'name':_0x3a0558});console['log'](_0x2c9837(0x150),_0x25c504),_0x4b539a['status'](0xc8)['json']({'product_data':_0x25c504,'master':_0x53d6b3});}catch(_0x10eb62){console[_0x2c9837(0x22e)]('add_purchases\x20error',_0x10eb62);}}),router[a0_0xab593a(0x132)](a0_0xab593a(0x237),auth,async(_0x15a3b2,_0x3458ed)=>{var _0x32659a=a0_0xab593a;try{const {invoice:_0x1a71ad,date:_0x476780,warehouse_name:_0x35dd55,prod_name:_0x408e56,prod_code:_0x56aebd,prod_qty:_0x4e4231,prod_unit:_0x9babd9,prod_secondunit:_0x54121c,prod_level:_0x29a034,prod_isle:_0x48bda8,prod_pallet:_0x23d3a7,note:_0x317e28,expiry_date:_0x41ecb0,batch_code:_0x3dde48,payable:_0x223524,due_amount:_0xdea766,Room_name:_0x1b9667,primary_code:_0x19ea08,secondary_code:_0x285ec9,MaxStocks_data:_0x3b5099,PO_number:_0x215f79,SCRN:_0x7add96,JO_number:_0x158793}=_0x15a3b2[_0x32659a(0x201)];if(typeof _0x408e56==_0x32659a(0x1a8))var _0x4b2632=[_0x15a3b2[_0x32659a(0x201)]['prod_name']],_0x515aeb=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1a0)]],_0x4fe879=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1e5)]],_0x23cb74=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1c1)]],_0x265fbf=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x21a)]],_0xd7fa9a=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x216)]],_0x14210a=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1fe)]],_0x371a75=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x226)]],_0x35d6aa=[_0x15a3b2[_0x32659a(0x201)]['MaxStocks_data']],_0x2f8cff=[_0x15a3b2['body'][_0x32659a(0x184)]],_0x497847=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x13f)]],_0x36e3aa=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x173)]],_0x2e7344=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x12f)]],_0x414da0=[_0x15a3b2['body'][_0x32659a(0x14d)]],_0x53a9a7=[_0x15a3b2['body'][_0x32659a(0x1e1)]],_0x4a29ed=[_0x15a3b2['body'][_0x32659a(0x1f5)]],_0x2e1fe5=[_0x15a3b2['body']['deliverycode']],_0x4866e9=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x15e)]],_0x120a85=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x18a)]],_0x2212f4=[_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x126)]];else var _0x4b2632=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1e3)]],_0x515aeb=[..._0x15a3b2['body'][_0x32659a(0x1a0)]],_0x4fe879=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1e5)]],_0x23cb74=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1c1)]],_0x265fbf=[..._0x15a3b2[_0x32659a(0x201)]['prod_secondunit']],_0xd7fa9a=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x216)]],_0x14210a=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1fe)]],_0x371a75=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x226)]],_0x35d6aa=[..._0x15a3b2[_0x32659a(0x201)]['MaxStocks_data']],_0x2f8cff=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x184)]],_0x497847=[..._0x15a3b2['body'][_0x32659a(0x13f)]],_0x36e3aa=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x173)]],_0x2e7344=[..._0x15a3b2['body'][_0x32659a(0x12f)]],_0x414da0=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x14d)]],_0x53a9a7=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1e1)]],_0x4a29ed=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x1f5)]],_0x2e1fe5=[..._0x15a3b2['body'][_0x32659a(0x1ce)]],_0x4866e9=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x15e)]],_0x120a85=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x18a)]],_0x2212f4=[..._0x15a3b2[_0x32659a(0x201)][_0x32659a(0x126)]];const _0xfa3714=_0x4b2632[_0x32659a(0x1b7)](_0x235605=>{return _0x235605={'product_name':_0x235605};});_0x120a85['forEach']((_0x43d11f,_0x22b7e1)=>{var _0x3d1b4b=_0x32659a;_0xfa3714[_0x22b7e1][_0x3d1b4b(0x18a)]=Math['abs'](_0x43d11f);}),_0x2212f4[_0x32659a(0x1c6)]((_0x72f99a,_0x544be6)=>{var _0x57456a=_0x32659a;_0xfa3714[_0x544be6][_0x57456a(0x126)]=_0x72f99a;}),_0x515aeb[_0x32659a(0x1c6)]((_0xd708e6,_0x45f7ab)=>{var _0x5f2ba1=_0x32659a;_0xfa3714[_0x45f7ab][_0x5f2ba1(0x12a)]=_0xd708e6;}),_0x4fe879[_0x32659a(0x1c6)]((_0x3ab0e7,_0x7910a0)=>{var _0x30ccb3=_0x32659a;_0xfa3714[_0x7910a0][_0x30ccb3(0x1fb)]=Math[_0x30ccb3(0x223)](_0x3ab0e7);}),_0x23cb74[_0x32659a(0x1c6)]((_0x5e4a82,_0x417cd1)=>{var _0x24d8bf=_0x32659a;_0xfa3714[_0x417cd1][_0x24d8bf(0x1fa)]=_0x5e4a82;}),_0x265fbf[_0x32659a(0x1c6)]((_0x2f931f,_0x35c77e)=>{_0xfa3714[_0x35c77e]['secondary_unit']=_0x2f931f;}),_0xd7fa9a[_0x32659a(0x1c6)]((_0x469571,_0x5efd22)=>{var _0x496ac3=_0x32659a;_0x4a29ed[_0x496ac3(0x1c6)]((_0x1c862e,_0x5b849a)=>{var _0x313f3c=_0x496ac3;if(_0x1c862e=='Receiving\x20Area'&&_0x5efd22==_0x5b849a){console[_0x313f3c(0x22e)](_0x1c862e+'\x20<\x20wew\x20>\x20'+_0x5efd22+'\x20<>\x20'+_0x5b849a+_0x313f3c(0x207)+_0x469571);var _0x20b6ec=_0x469571[_0x313f3c(0x1f4)](0x3);_0xfa3714[_0x5efd22][_0x313f3c(0x1b8)]=_0x469571[0x0],_0xfa3714[_0x5efd22][_0x313f3c(0x135)]=_0x469571[0x1],_0xfa3714[_0x5efd22][_0x313f3c(0x21e)]=0x0,_0xfa3714[_0x5efd22]['bin']=0x0,_0xfa3714[_0x5efd22]['type']=_0x313f3c(0x188),_0xfa3714[_0x5efd22]['floorlevel']=_0x20b6ec;}else{if(_0x1c862e==_0x313f3c(0x176)&&_0x5efd22==_0x5b849a){var _0x20b6ec=_0x469571[_0x313f3c(0x1f4)](0x3);_0xfa3714[_0x5efd22][_0x313f3c(0x1b8)]=_0x469571[0x0],_0xfa3714[_0x5efd22][_0x313f3c(0x135)]=_0x469571[0x1],_0xfa3714[_0x5efd22][_0x313f3c(0x21e)]=0x0,_0xfa3714[_0x5efd22][_0x313f3c(0x12d)]=0x0,_0xfa3714[_0x5efd22]['type']=_0x313f3c(0x188),_0xfa3714[_0x5efd22]['floorlevel']=_0x469571[0x5];}else{if(_0x5efd22==_0x5b849a){if(_0x469571[0x0]=='A'&&_0x469571[0x1]=='L'&&_0x469571[0x2]=='L')console[_0x313f3c(0x22e)](_0x1c862e+'\x20<>\x20'+_0x5efd22+_0x313f3c(0x207)+_0x5b849a+_0x313f3c(0x207)+_0x469571+'here'),_0xfa3714[_0x5efd22]['storage']=_0x469571[0x0],_0xfa3714[_0x5efd22][_0x313f3c(0x135)]=_0x469571[0x1],_0xfa3714[_0x5efd22][_0x313f3c(0x21e)]=0x0,_0xfa3714[_0x5efd22][_0x313f3c(0x12d)]=0x0,_0xfa3714[_0x5efd22][_0x313f3c(0x146)]=_0x313f3c(0x188),_0xfa3714[_0x5efd22][_0x313f3c(0x169)]=_0x469571[0x3];else{var _0x1d738b;if(_0x469571[0x4]=='L')_0x1d738b='Level';else _0x469571[0x4]=='F'&&(_0x1d738b=_0x313f3c(0x188));_0xfa3714[_0x5efd22][_0x313f3c(0x1b8)]=_0x469571[0x0],_0xfa3714[_0x5efd22][_0x313f3c(0x135)]=_0x469571[0x1],_0xfa3714[_0x5efd22][_0x313f3c(0x21e)]=_0x469571[0x2],_0xfa3714[_0x5efd22]['bin']=_0x469571[0x3],_0xfa3714[_0x5efd22]['type']=_0x1d738b,_0xfa3714[_0x5efd22][_0x313f3c(0x169)]=_0x469571[0x5];}}}}});}),_0x14210a['forEach']((_0x6aaeef,_0x45303f)=>{var _0x3d1627=_0x32659a;_0xfa3714[_0x45303f][_0x3d1627(0x1fe)]=_0x6aaeef;}),_0x371a75[_0x32659a(0x1c6)]((_0x8ba62b,_0x131146)=>{var _0x554458=_0x32659a;_0xfa3714[_0x131146][_0x554458(0x226)]=_0x8ba62b;}),_0x35d6aa['forEach']((_0x7f38ec,_0x1ca3b4)=>{var _0x278f31=_0x32659a;_0xfa3714[_0x1ca3b4][_0x278f31(0x1a5)]=_0x7f38ec;}),_0x2f8cff[_0x32659a(0x1c6)]((_0x3cd091,_0x4c758d)=>{var _0x3a828c=_0x32659a;_0xfa3714[_0x4c758d][_0x3a828c(0x184)]=_0x3cd091;}),_0x497847[_0x32659a(0x1c6)]((_0x45d12e,_0x355005)=>{var _0x5d7d18=_0x32659a;_0xfa3714[_0x355005][_0x5d7d18(0x13f)]=_0x45d12e;}),_0x36e3aa[_0x32659a(0x1c6)]((_0x9fbb8b,_0x4a6f4f)=>{var _0x4125dd=_0x32659a;_0xfa3714[_0x4a6f4f][_0x4125dd(0x180)]=_0x9fbb8b;}),_0x2e7344[_0x32659a(0x1c6)]((_0x10e1c5,_0x196550)=>{_0xfa3714[_0x196550]['alertQTY']=_0x10e1c5;}),_0x414da0[_0x32659a(0x1c6)]((_0x2f9f48,_0x4aba1c)=>{var _0x41ef72=_0x32659a;_0xfa3714[_0x4aba1c][_0x41ef72(0x14d)]=_0x2f9f48;}),_0x53a9a7['forEach']((_0x54ef2a,_0xf38e3)=>{var _0x5a8229=_0x32659a;_0xfa3714[_0xf38e3][_0x5a8229(0x1b4)]=_0x54ef2a;}),_0x4a29ed[_0x32659a(0x1c6)]((_0x4cb838,_0x44c025)=>{var _0x4f8473=_0x32659a;_0xfa3714[_0x44c025][_0x4f8473(0x139)]=_0x4cb838;}),_0x2e1fe5['forEach']((_0x13ddfc,_0x4fbd57)=>{_0xfa3714[_0x4fbd57]['delivery_code']=_0x13ddfc;}),_0x4866e9[_0x32659a(0x1c6)]((_0x3178d6,_0x3a8d1f)=>{var _0x3272bf=_0x32659a;_0xfa3714[_0x3a8d1f][_0x3272bf(0x16e)]=_0x3178d6;});const _0xa5fb1b=_0x4a29ed[_0x32659a(0x1b7)](_0x9226ea=>{return _0x9226ea={'room_name':_0x9226ea};}),_0x2e0bda=_0xfa3714['filter'](_0x36a181=>_0x36a181[_0x32659a(0x1fb)]!=='0'&&_0x36a181['quantity']!==''),_0xc74bed=new purchases({'invoice':_0x1a71ad,'suppliers':_0x15a3b2[_0x32659a(0x201)][_0x32659a(0x160)],'date':_0x476780,'warehouse_name':_0x35dd55,'product':_0x2e0bda,'note':_0x317e28,'due_amount':_0xdea766,'POnumber':_0x215f79,'SCRN':_0x7add96,'JO_number':_0x158793,'roomList':_0xa5fb1b}),_0xed0946=await _0xc74bed[_0x32659a(0x212)](),_0x4ecb1b=await purchases['findOne']({'invoice':_0x1a71ad}),_0x12edb5=_0x4ecb1b[_0x32659a(0x150)][_0x32659a(0x1b7)](async _0x3eb41e=>{var _0x50f886=_0x32659a,_0xdd06fd=await warehouse[_0x50f886(0x124)]({'name':_0x35dd55,'room':_0x3eb41e['room_name']}),_0xe66884=0x0;return _0xdd06fd[_0x50f886(0x1a4)][_0x50f886(0x1c6)](_0x4775a6=>{var _0x5803a0=_0x50f886;_0x4775a6[_0x5803a0(0x1ae)]==_0x3eb41e['product_name']&&_0x4775a6[_0x5803a0(0x169)]==_0x3eb41e[_0x5803a0(0x169)]&&_0x4775a6[_0x5803a0(0x146)]==_0x3eb41e[_0x5803a0(0x146)]&&_0x4775a6[_0x5803a0(0x12d)]==_0x3eb41e[_0x5803a0(0x12d)]&&_0x4775a6['bay']==_0x3eb41e[_0x5803a0(0x21e)]&&_0x4775a6[_0x5803a0(0x135)]==_0x3eb41e[_0x5803a0(0x135)]&&_0x4775a6[_0x5803a0(0x1b8)]==_0x3eb41e[_0x5803a0(0x1b8)]&&_0x4775a6[_0x5803a0(0x13f)]==_0x3eb41e['expiry_date']&&_0x4775a6[_0x5803a0(0x184)]==_0x3eb41e[_0x5803a0(0x184)]&&_0x4775a6['production_date']==_0x3eb41e[_0x5803a0(0x14d)]&&_0x4775a6[_0x5803a0(0x16e)]==_0x4ecb1b[_0x5803a0(0x16e)]&&(_0x4775a6['product_stock']+=Math[_0x5803a0(0x223)](_0x3eb41e['quantity']),_0xe66884++);}),_0xe66884===0x0&&_0xdd06fd['product_details'][_0x50f886(0x1be)]({'product_name':_0x3eb41e['product_name'],'product_stock':Math['abs'](_0x3eb41e['quantity']),'primary_code':_0x3eb41e[_0x50f886(0x1fe)],'secondary_code':_0x3eb41e[_0x50f886(0x226)],'product_code':_0x3eb41e[_0x50f886(0x12a)],'storage':_0x3eb41e[_0x50f886(0x1b8)],'rack':_0x3eb41e[_0x50f886(0x135)],'bay':_0x3eb41e[_0x50f886(0x21e)],'bin':_0x3eb41e['bin'],'type':_0x3eb41e[_0x50f886(0x146)],'floorlevel':_0x3eb41e[_0x50f886(0x169)],'maxProducts':_0x3eb41e[_0x50f886(0x1a5)],'unit':_0x3eb41e[_0x50f886(0x1fa)],'secondary_unit':_0x3eb41e['secondary_unit'],'expiry_date':_0x3eb41e[_0x50f886(0x13f)],'maxPerUnit':_0x3eb41e['maxperunit'],'batch_code':_0x3eb41e[_0x50f886(0x184)],'alertQTY':_0x3eb41e[_0x50f886(0x12f)],'production_date':_0x3eb41e[_0x50f886(0x14d)],'product_cat':_0x3eb41e['product_cat'],'invoice':_0x3eb41e[_0x50f886(0x16e)],'actual_qty':Math['abs'](_0x3eb41e[_0x50f886(0x18a)]),'actual_uom':_0x3eb41e[_0x50f886(0x126)]}),_0xdd06fd;});Promise[_0x32659a(0x1ca)](_0x12edb5)[_0x32659a(0x130)](async _0x3b9122=>{var _0x2b6a20=_0x32659a;try{for(const _0x11ae3f of _0x3b9122){await _0x11ae3f['save']();}const _0x14cfc3=await master_shop['find'](),_0x4d8c74=await email_settings[_0x2b6a20(0x124)](),_0x4feeff=await supervisor_settings[_0x2b6a20(0x166)]();var _0x50db60=_0x4ecb1b[_0x2b6a20(0x150)],_0x55ed28='',_0x1ce711;for(_0x1ce711 in _0x50db60){_0x55ed28+='<tr>'+_0x2b6a20(0x154)+_0x50db60[_0x1ce711][_0x2b6a20(0x1ae)]+_0x2b6a20(0x1d6)+_0x2b6a20(0x154)+_0x50db60[_0x1ce711][_0x2b6a20(0x12a)]+_0x2b6a20(0x1d6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x50db60[_0x1ce711][_0x2b6a20(0x1fb)]+_0x2b6a20(0x1d6)+_0x2b6a20(0x154)+_0x50db60[_0x1ce711][_0x2b6a20(0x1fa)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x50db60[_0x1ce711][_0x2b6a20(0x210)]+'</td>'+_0x2b6a20(0x154)+_0x4ecb1b['warehouse_name']+_0x2b6a20(0x1d6)+_0x2b6a20(0x154)+_0x50db60[_0x1ce711][_0x2b6a20(0x139)]+_0x2b6a20(0x1d6)+_0x2b6a20(0x154)+_0x50db60[_0x1ce711][_0x2b6a20(0x1b8)]+_0x50db60[_0x1ce711][_0x2b6a20(0x135)]+_0x50db60[_0x1ce711]['bay']+_0x50db60[_0x1ce711]['bin']+_0x50db60[_0x1ce711][_0x2b6a20(0x146)][0x0]+_0x50db60[_0x1ce711][_0x2b6a20(0x169)]+'</td>',_0x2b6a20(0x1f6);}let _0x2378d2=nodemailer[_0x2b6a20(0x13c)]({'host':_0x4d8c74[_0x2b6a20(0x215)],'port':Number(_0x4d8c74[_0x2b6a20(0x13d)]),'secure':![],'auth':{'user':_0x4d8c74[_0x2b6a20(0x221)],'pass':_0x4d8c74['password']}}),_0x38e5dd={'from':_0x4d8c74[_0x2b6a20(0x221)],'to':_0x4feeff[0x0][_0x2b6a20(0x1bb)],'subject':_0x2b6a20(0x1ba),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2b6a20(0x148)+'/upload/'+_0x14cfc3[0x0][_0x2b6a20(0x15f)],'cid':_0x2b6a20(0x156)}],'html':_0x2b6a20(0x14a)+_0x2b6a20(0x127)+_0x2b6a20(0x142)+_0x2b6a20(0x1fd)+_0x2b6a20(0x179)+_0x2b6a20(0x1fd)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2b6a20(0x157)+_0x2b6a20(0x1fd)+_0x2b6a20(0x164)+_0x14cfc3[0x0][_0x2b6a20(0x19e)]+_0x2b6a20(0x1e6)+_0x2b6a20(0x157)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x2b6a20(0x1fd)+_0x2b6a20(0x20e)+_0x2b6a20(0x149)+_0x4ecb1b['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2b6a20(0x15c)+_0x4ecb1b[_0x2b6a20(0x133)]+'\x20'+_0x2b6a20(0x193)+_0x2b6a20(0x182)+_0x2b6a20(0x157)+_0x2b6a20(0x1ee)+_0x2b6a20(0x172)+_0x2b6a20(0x1ff)+_0x2b6a20(0x1c0)+_0x2b6a20(0x218)+_0x2b6a20(0x1c5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x2b6a20(0x217)+_0x2b6a20(0x22c)+_0x2b6a20(0x187)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x2b6a20(0x1f6)+_0x2b6a20(0x1e0)+_0x2b6a20(0x1cd)+'\x20'+_0x55ed28+'\x20'+'</tbody>'+_0x2b6a20(0x235)+'<div>'+_0x2b6a20(0x18d)+_0x2b6a20(0x1f9)+_0x14cfc3[0x0]['site_title']+_0x2b6a20(0x182)+_0x2b6a20(0x157)+_0x2b6a20(0x157)+_0x2b6a20(0x151)};_0x2378d2[_0x2b6a20(0x17c)](_0x38e5dd,function(_0x32d789,_0x346ee3){var _0x4526b6=_0x2b6a20;_0x32d789?(console[_0x4526b6(0x22e)](_0x32d789),console['log']('Error\x20Occurs')):console['log'](_0x4526b6(0x204));}),_0x15a3b2['flash']('success',_0x2b6a20(0x213)),_0x3458ed[_0x2b6a20(0x1dc)](_0x2b6a20(0x1b1));}catch(_0x1cb902){console['error'](_0x1cb902),_0x3458ed[_0x2b6a20(0x137)](0x1f4)[_0x2b6a20(0x1d8)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x32659a(0x1d7)](_0x375237=>{var _0x27f701=_0x32659a;console[_0x27f701(0x1d1)](_0x375237),_0x3458ed[_0x27f701(0x137)](0x1f4)[_0x27f701(0x1d8)]({'error':_0x27f701(0x1f8)});});}catch(_0x48fd5b){console[_0x32659a(0x22e)](_0x48fd5b);}}),router[a0_0xab593a(0x189)]('/preview/:id',auth,async(_0x90680,_0x26ba68)=>{var _0x335fa8=a0_0xab593a;try{const {username:_0x1643ef,email:_0x181794,role:_0x460304}=_0x90680[_0x335fa8(0x191)],_0x2b9a50=_0x90680[_0x335fa8(0x191)],_0x488067=await profile[_0x335fa8(0x124)]({'email':_0x2b9a50[_0x335fa8(0x221)]}),_0x41d7eb=await master_shop[_0x335fa8(0x166)](),_0x18a833=_0x90680[_0x335fa8(0x1df)]['id'],_0x9e3a33=await purchases['findById'](_0x18a833),_0x2502b3=await warehouse['aggregate']([{'$match':{'name':_0x9e3a33[_0x335fa8(0x1ab)],'room':_0x9e3a33[_0x335fa8(0x15d)]}},{'$unwind':_0x335fa8(0x186)},{'$group':{'_id':_0x335fa8(0x174),'name':{'$first':_0x335fa8(0x1d0)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x335fa8(0x228)},'bin':{'$first':_0x335fa8(0x18c)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x335fa8(0x128)},'secondary_code':{'$first':_0x335fa8(0x203)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x335fa8(0x136)},'rack':{'$first':_0x335fa8(0x18b)},'expiry_date':{'$first':_0x335fa8(0x1e2)}}}]),_0x4682d4=await customer[_0x335fa8(0x166)]({});let _0x17a47d;if(_0x2b9a50['role']==_0x335fa8(0x183)){const _0x128b95=await staff[_0x335fa8(0x124)]({'email':_0x2b9a50[_0x335fa8(0x221)]});_0x17a47d=await warehouse[_0x335fa8(0x14b)]([{'$match':{'status':'Enabled','name':_0x128b95[_0x335fa8(0x1b5)]}},{'$group':{'_id':_0x335fa8(0x138),'name':{'$first':'$name'}}}]);}else _0x17a47d=await warehouse[_0x335fa8(0x14b)]([{'$match':{'status':_0x335fa8(0x153)}},{'$group':{'_id':'$name','name':{'$first':_0x335fa8(0x138)}}}]);const _0x31805c=await product[_0x335fa8(0x166)]({}),_0x134c20=await suppliers[_0x335fa8(0x166)]({}),_0x26dee5=BayBinSelected(_0x9e3a33[_0x335fa8(0x1ab)],_0x9e3a33['room']);if(_0x41d7eb[0x0][_0x335fa8(0x1bf)]==_0x335fa8(0x234)){var _0xa7b17=users[_0x335fa8(0x1aa)];console['log'](_0xa7b17);}else{if(_0x41d7eb[0x0][_0x335fa8(0x1bf)]==_0x335fa8(0x196))var _0xa7b17=users['Hindi'];else{if(_0x41d7eb[0x0][_0x335fa8(0x1bf)]=='German')var _0xa7b17=users['German'];else{if(_0x41d7eb[0x0][_0x335fa8(0x1bf)]==_0x335fa8(0x125))var _0xa7b17=users[_0x335fa8(0x125)];else{if(_0x41d7eb[0x0][_0x335fa8(0x1bf)]==_0x335fa8(0x21c))var _0xa7b17=users[_0x335fa8(0x21c)];else{if(_0x41d7eb[0x0][_0x335fa8(0x1bf)]==_0x335fa8(0x1d4))var _0xa7b17=users[_0x335fa8(0x1bd)];else{if(_0x41d7eb[0x0][_0x335fa8(0x1bf)]==_0x335fa8(0x19f))var _0xa7b17=users['Chinese'];else{if(_0x41d7eb[0x0][_0x335fa8(0x1bf)]==_0x335fa8(0x206))var _0xa7b17=users[_0x335fa8(0x158)];}}}}}}}_0x26ba68[_0x335fa8(0x141)]('edit_purchases_view',{'success':_0x90680['flash'](_0x335fa8(0x198)),'errors':_0x90680[_0x335fa8(0x18e)](_0x335fa8(0x208)),'role':_0x2b9a50,'profile':_0x488067,'customer':_0x4682d4,'warehouse':_0x17a47d,'product':_0x2502b3,'user':_0x9e3a33,'master_shop':_0x41d7eb,'unit':_0x31805c,'language':_0xa7b17,'suppliers':_0x134c20,'dataSelected':_0x26dee5});}catch(_0x255b11){console[_0x335fa8(0x22e)](_0x255b11);}}),router[a0_0xab593a(0x132)](a0_0xab593a(0x170),auth,async(_0x88f801,_0x1662cc)=>{var _0x51d4f9=a0_0xab593a;try{const _0x3d08e0=_0x88f801[_0x51d4f9(0x1df)]['id'],{invoice:_0x2eebe4,warehouse_name:_0x2766e6,Room_name:_0x105c5b}=_0x88f801[_0x51d4f9(0x201)],_0x3220ab=await warehouse[_0x51d4f9(0x124)]({'name':_0x2766e6,'room':_0x105c5b}),_0x3acbe9=await purchases[_0x51d4f9(0x124)]({'invoice':_0x2eebe4});_0x3acbe9[_0x51d4f9(0x150)][_0x51d4f9(0x1c6)](_0x37fd1e=>{var _0x1a8b88=_0x51d4f9,_0x54263c=0x0;const _0x1ea06a=_0x3220ab[_0x1a8b88(0x1a4)][_0x1a8b88(0x1b7)](_0x33400c=>{var _0x23b0a7=_0x1a8b88;_0x33400c['product_name']==_0x37fd1e[_0x23b0a7(0x1ae)]&&_0x33400c['floorlevel']==_0x37fd1e[_0x23b0a7(0x169)]&&_0x33400c['type']==_0x37fd1e[_0x23b0a7(0x146)]&&_0x33400c[_0x23b0a7(0x12d)]==_0x37fd1e[_0x23b0a7(0x12d)]&&_0x33400c[_0x23b0a7(0x21e)]==_0x37fd1e[_0x23b0a7(0x21e)]&&_0x33400c[_0x23b0a7(0x135)]==_0x37fd1e[_0x23b0a7(0x135)]&&_0x33400c['storage']==_0x37fd1e[_0x23b0a7(0x1b8)]&&_0x33400c[_0x23b0a7(0x13f)]==_0x37fd1e['expiry_date']&&_0x33400c[_0x23b0a7(0x184)]==_0x37fd1e[_0x23b0a7(0x184)]&&_0x33400c[_0x23b0a7(0x14d)]==_0x37fd1e[_0x23b0a7(0x14d)]&&_0x33400c[_0x23b0a7(0x1c7)]==_0x37fd1e[_0x23b0a7(0x1c7)]&&_0x33400c[_0x23b0a7(0x1fc)]==_0x37fd1e[_0x23b0a7(0x1fc)]&&(_0x33400c[_0x23b0a7(0x181)]=parseInt(_0x33400c[_0x23b0a7(0x181)])+parseInt(_0x37fd1e[_0x23b0a7(0x1fb)]),_0x54263c++);});_0x54263c=='0'&&(_0x3220ab[_0x1a8b88(0x1a4)]=_0x3220ab['product_details'][_0x1a8b88(0x1ac)]({'product_name':_0x37fd1e['product_name'],'product_stock':_0x37fd1e[_0x1a8b88(0x1fb)],'primary_code':_0x37fd1e['primary_code'],'secondary_code':_0x37fd1e[_0x1a8b88(0x226)],'product_code':_0x37fd1e[_0x1a8b88(0x12a)],'storage':_0x37fd1e[_0x1a8b88(0x1b8)],'rack':_0x37fd1e['rack'],'bay':_0x37fd1e['bay'],'bin':_0x37fd1e[_0x1a8b88(0x12d)],'type':_0x37fd1e[_0x1a8b88(0x146)],'floorlevel':_0x37fd1e[_0x1a8b88(0x169)],'maxProducts':_0x37fd1e[_0x1a8b88(0x1a5)],'unit':_0x37fd1e[_0x1a8b88(0x1fa)],'secondary_unit':_0x37fd1e[_0x1a8b88(0x210)],'expiry_date':_0x37fd1e['expiry_date'],'maxPerUnit':_0x37fd1e[_0x1a8b88(0x180)],'batch_code':_0x37fd1e[_0x1a8b88(0x184)],'alertQTY':_0x37fd1e['alertQTY'],'production_date':_0x37fd1e['production_date'],'delivery_date':_0x37fd1e[_0x1a8b88(0x1c7)],'delivery_code':_0x37fd1e[_0x1a8b88(0x1fc)]}));}),await _0x3220ab[_0x51d4f9(0x212)](),_0x3acbe9[_0x51d4f9(0x147)]=_0x51d4f9(0x21f);const _0xf170b2=await _0x3acbe9['save']();_0x88f801[_0x51d4f9(0x18e)](_0x51d4f9(0x198),_0x51d4f9(0x13e)),_0x1662cc['redirect']('/all_purchases/view');}catch(_0x8adddd){console[_0x51d4f9(0x22e)](_0x8adddd);}}),router[a0_0xab593a(0x189)](a0_0xab593a(0x21b),auth,async(_0x3a4c51,_0x2c68ef)=>{var _0xdf0385=a0_0xab593a;try{const {username:_0x5d3826,email:_0x5c282e,role:_0x13dc9e}=_0x3a4c51['user'],_0x7f23cf=_0x3a4c51[_0xdf0385(0x191)],_0x578aed=await profile[_0xdf0385(0x124)]({'email':_0x7f23cf[_0xdf0385(0x221)]}),_0x49a4b9=await master_shop[_0xdf0385(0x166)](),_0x54193b=_0x3a4c51[_0xdf0385(0x1df)]['id'],_0x236185=await purchases[_0xdf0385(0x168)](_0x54193b),_0x9514e=await suppliers[_0xdf0385(0x166)]({});let _0xe31cba;if(_0x7f23cf[_0xdf0385(0x194)]==_0xdf0385(0x183)){const _0xdd545a=await staff[_0xdf0385(0x124)]({'email':_0x7f23cf[_0xdf0385(0x221)]});_0xe31cba=await warehouse[_0xdf0385(0x166)]({'status':_0xdf0385(0x153),'name':_0xdd545a[_0xdf0385(0x1b5)],'warehouse_category':'Raw\x20Materials'});}else _0xe31cba=await warehouse[_0xdf0385(0x14b)]([{'$match':{'status':_0xdf0385(0x153),'warehouse_category':_0xdf0385(0x1f1)}},{'$group':{'_id':_0xdf0385(0x138),'name':{'$first':_0xdf0385(0x138)}}}]);const _0x26d4c1=await product['find']({}),_0x1eef7b=BayBinSelected(_0x236185[_0xdf0385(0x1ab)],_0x236185[_0xdf0385(0x15d)]);let _0x514f3e=new Date(_0x236185[_0xdf0385(0x13f)]),_0x5c537c=('0'+_0x514f3e[_0xdf0385(0x1ef)]())['slice'](-0x2),_0x5c693c=('0'+(_0x514f3e[_0xdf0385(0x1dd)]()+0x1))['slice'](-0x2),_0x543596=_0x514f3e[_0xdf0385(0x1f7)](),_0x7c216a=_0x543596+'-'+_0x5c693c+'-'+_0x5c537c;if(_0x49a4b9[0x0][_0xdf0385(0x1bf)]==_0xdf0385(0x234)){var _0x4cae9f=users['English'];console[_0xdf0385(0x22e)](_0x4cae9f);}else{if(_0x49a4b9[0x0]['language']==_0xdf0385(0x196))var _0x4cae9f=users['Hindi'];else{if(_0x49a4b9[0x0][_0xdf0385(0x1bf)]==_0xdf0385(0x195))var _0x4cae9f=users['German'];else{if(_0x49a4b9[0x0][_0xdf0385(0x1bf)]==_0xdf0385(0x125))var _0x4cae9f=users['Spanish'];else{if(_0x49a4b9[0x0]['language']==_0xdf0385(0x21c))var _0x4cae9f=users[_0xdf0385(0x21c)];else{if(_0x49a4b9[0x0][_0xdf0385(0x1bf)]==_0xdf0385(0x1d4))var _0x4cae9f=users[_0xdf0385(0x1bd)];else{if(_0x49a4b9[0x0]['language']==_0xdf0385(0x19f))var _0x4cae9f=users[_0xdf0385(0x19f)];else{if(_0x49a4b9[0x0][_0xdf0385(0x1bf)]==_0xdf0385(0x206))var _0x4cae9f=users['Arabic'];}}}}}}}_0x2c68ef[_0xdf0385(0x141)](_0xdf0385(0x19a),{'success':_0x3a4c51[_0xdf0385(0x18e)]('success'),'errors':_0x3a4c51[_0xdf0385(0x18e)](_0xdf0385(0x208)),'role':_0x7f23cf,'profile':_0x578aed,'purchases':_0x236185,'suppliers':_0x9514e,'warehouse':_0xe31cba,'product':_0x26d4c1,'master_shop':_0x49a4b9,'language':_0x4cae9f,'ed_fullDate':_0x7c216a,'dataSelected':_0x1eef7b});}catch(_0x1bc5ab){console['log'](_0x1bc5ab);}}),router[a0_0xab593a(0x132)](a0_0xab593a(0x21b),auth,async(_0x38d58d,_0x1c5935)=>{var _0x63979b=a0_0xab593a;try{const _0x5b0f25=_0x38d58d[_0x63979b(0x1df)]['id'],_0x3d5390=await purchases[_0x63979b(0x124)]({'_id':_0x38d58d[_0x63979b(0x1df)]['id']}),_0x47fa5e=await warehouse[_0x63979b(0x124)]({'name':_0x3d5390[_0x63979b(0x1ab)],'room':_0x3d5390[_0x63979b(0x15d)]});_0x3d5390['product'][_0x63979b(0x1c6)](_0xa81ce8=>{var _0x495a7e=_0x63979b;const _0x3f792c=_0x47fa5e['product_details'][_0x495a7e(0x1b7)](_0x1c44e6=>{var _0x3a2ac8=_0x495a7e;_0x1c44e6[_0x3a2ac8(0x1ae)]==_0xa81ce8[_0x3a2ac8(0x1ae)]&&_0x1c44e6[_0x3a2ac8(0x169)]==_0xa81ce8[_0x3a2ac8(0x169)]&&_0x1c44e6[_0x3a2ac8(0x146)]==_0xa81ce8[_0x3a2ac8(0x146)]&&_0x1c44e6[_0x3a2ac8(0x12d)]==_0xa81ce8[_0x3a2ac8(0x12d)]&&_0x1c44e6[_0x3a2ac8(0x21e)]==_0xa81ce8[_0x3a2ac8(0x21e)]&&_0x1c44e6[_0x3a2ac8(0x135)]==_0xa81ce8[_0x3a2ac8(0x135)]&&_0x1c44e6['storage']==_0xa81ce8[_0x3a2ac8(0x1b8)]&&(_0x1c44e6[_0x3a2ac8(0x181)]=parseInt(_0x1c44e6[_0x3a2ac8(0x181)])-parseInt(_0xa81ce8[_0x3a2ac8(0x1fb)]));});}),await _0x47fa5e['save']();const {invoice:_0xa2a83c,suppliers:_0x2d7d5b,date:_0x322ff3,warehouse_name:_0x42c4d0,prod_name:_0x208cb9,prod_code:_0x55a1a9,prod_qty:_0x443c1b,prod_unit:_0x5bb881,prod_secondunit:_0x34cf69,prod_level:_0x28ad9b,prod_isle:_0x175f12,prod_pallet:_0x3ce984,note:_0x3df855,expiry_date:_0x11e6cd,batch_code:_0x524a1c,paid_amount:_0x5d7e32,due_amount:_0x1caa04,Room_name:_0x3d8d56,primary_code:_0x5c9915,secondary_code:_0x570edd,PO_number:_0x1c9583,JO_number:_0x4f6c11}=_0x38d58d[_0x63979b(0x201)];if(typeof _0x208cb9==_0x63979b(0x1a8))var _0x5eae59=[_0x38d58d['body'][_0x63979b(0x1e3)]],_0x2984c3=[_0x38d58d[_0x63979b(0x201)][_0x63979b(0x1a0)]],_0x310844=[_0x38d58d[_0x63979b(0x201)][_0x63979b(0x185)]],_0x357728=[_0x38d58d[_0x63979b(0x201)]['prod_unit']],_0x391d7b=[_0x38d58d[_0x63979b(0x201)]['prod_secondunit']],_0x2a7693=[_0x38d58d[_0x63979b(0x201)][_0x63979b(0x216)]],_0x3d69a5=[_0x38d58d[_0x63979b(0x201)][_0x63979b(0x214)]],_0x29c50d=[_0x38d58d['body']['prod_pallet']],_0x22de41=[_0x38d58d[_0x63979b(0x201)]['primary_code']],_0x3a50aa=[_0x38d58d['body'][_0x63979b(0x226)]],_0x17a9d2=[_0x38d58d[_0x63979b(0x201)][_0x63979b(0x227)]],_0x5146aa=[_0x38d58d[_0x63979b(0x201)]['batch_code']],_0x4ba6ae=[_0x38d58d['body'][_0x63979b(0x13f)]],_0x6a245f=[_0x38d58d[_0x63979b(0x201)][_0x63979b(0x1b8)]],_0x3a3159=[_0x38d58d[_0x63979b(0x201)][_0x63979b(0x1b9)]],_0x387c46=[_0x38d58d[_0x63979b(0x201)][_0x63979b(0x146)]];else var _0x5eae59=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x1e3)]],_0x2984c3=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x1a0)]],_0x310844=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x185)]],_0x357728=[..._0x38d58d[_0x63979b(0x201)]['prod_unit']],_0x391d7b=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x21a)]],_0x2a7693=[..._0x38d58d['body'][_0x63979b(0x216)]],_0x3d69a5=[..._0x38d58d['body'][_0x63979b(0x214)]],_0x29c50d=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x163)]],_0x22de41=[..._0x38d58d[_0x63979b(0x201)]['primary_code']],_0x3a50aa=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x226)]],_0x17a9d2=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x227)]],_0x5146aa=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x184)]],_0x4ba6ae=[..._0x38d58d['body']['expiry_date']],_0x6a245f=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x1b8)]],_0x3a3159=[..._0x38d58d[_0x63979b(0x201)][_0x63979b(0x1b9)]],_0x387c46=[..._0x38d58d['body'][_0x63979b(0x146)]];const _0x531003=_0x5eae59['map'](_0x31b02=>{return _0x31b02={'product_name':_0x31b02};});_0x2984c3[_0x63979b(0x1c6)]((_0x83ee52,_0x1d8b81)=>{var _0x1b3e89=_0x63979b;_0x531003[_0x1d8b81][_0x1b3e89(0x12a)]=_0x83ee52;}),_0x310844[_0x63979b(0x1c6)]((_0x36cffb,_0x414735)=>{_0x531003[_0x414735]['quantity']=_0x36cffb;}),_0x357728[_0x63979b(0x1c6)]((_0x57816a,_0xeb53b)=>{var _0x517e91=_0x63979b;_0x531003[_0xeb53b][_0x517e91(0x1fa)]=_0x57816a;}),_0x391d7b[_0x63979b(0x1c6)]((_0x1b7f4e,_0x5529d1)=>{var _0x3686d7=_0x63979b;_0x531003[_0x5529d1][_0x3686d7(0x210)]=_0x1b7f4e;}),_0x2a7693[_0x63979b(0x1c6)]((_0x2fedba,_0x3f7991)=>{_0x531003[_0x3f7991]['bay']=_0x2fedba;}),_0x3d69a5['forEach']((_0x1472dc,_0x19b0ee)=>{var _0x4f3ccc=_0x63979b;_0x531003[_0x19b0ee][_0x4f3ccc(0x12d)]=_0x1472dc;}),_0x29c50d[_0x63979b(0x1c6)]((_0x40d0f9,_0x58df0f)=>{var _0x5b4503=_0x63979b;_0x531003[_0x58df0f][_0x5b4503(0x169)]=_0x40d0f9;}),_0x22de41['forEach']((_0x40089f,_0x17577d)=>{var _0x5c9268=_0x63979b;_0x531003[_0x17577d][_0x5c9268(0x1fe)]=_0x40089f;}),_0x3a50aa['forEach']((_0x2c929b,_0x5933dd)=>{var _0x15fb5e=_0x63979b;_0x531003[_0x5933dd][_0x15fb5e(0x226)]=_0x2c929b;}),_0x17a9d2['forEach']((_0x3ea440,_0x59fbae)=>{var _0x42b8d2=_0x63979b;_0x531003[_0x59fbae][_0x42b8d2(0x1a5)]=_0x3ea440;}),_0x5146aa['forEach']((_0x1f35cf,_0xdfc808)=>{var _0x22e9ec=_0x63979b;_0x531003[_0xdfc808][_0x22e9ec(0x184)]=_0x1f35cf;}),_0x4ba6ae['forEach']((_0x5afccb,_0x5ef234)=>{_0x531003[_0x5ef234]['expiry_date']=_0x5afccb;}),_0x387c46[_0x63979b(0x1c6)]((_0x2dfcf2,_0x4d34db)=>{_0x531003[_0x4d34db]['type']=_0x2dfcf2;}),_0x6a245f['forEach']((_0x250033,_0x594a4f)=>{var _0x4903cf=_0x63979b;_0x531003[_0x594a4f][_0x4903cf(0x1b8)]=_0x250033;}),_0x3a3159[_0x63979b(0x1c6)]((_0x1ce128,_0x1b42c4)=>{var _0x803d00=_0x63979b;_0x531003[_0x1b42c4][_0x803d00(0x135)]=_0x1ce128;});const _0x1de183=_0x531003[_0x63979b(0x1e4)](_0x5137cf=>_0x5137cf[_0x63979b(0x1fb)]!=='0'&&_0x5137cf[_0x63979b(0x1fb)]!=='');_0x3d5390['invoice']=_0xa2a83c,_0x3d5390['suppliers']=_0x2d7d5b,_0x3d5390[_0x63979b(0x133)]=_0x322ff3,_0x3d5390[_0x63979b(0x1ab)]=_0x42c4d0,_0x3d5390[_0x63979b(0x150)]=_0x1de183,_0x3d5390['note']=_0x3df855,_0x3d5390[_0x63979b(0x20a)]=_0x5d7e32,_0x3d5390[_0x63979b(0x1a9)]=_0x1caa04,_0x3d5390[_0x63979b(0x15d)]=_0x3d8d56,_0x3d5390['POnumber']=_0x1c9583,_0x3d5390[_0x63979b(0x1c4)]=_0x4f6c11;const _0x3315eb=await _0x3d5390[_0x63979b(0x212)](),_0x12dcf6=await warehouse[_0x63979b(0x124)]({'name':_0x38d58d[_0x63979b(0x201)]['warehouse_name'],'room':_0x38d58d[_0x63979b(0x201)][_0x63979b(0x140)]});_0x3d5390['product']['forEach'](_0x1bc7d4=>{var _0x5d307e=_0x63979b,_0x3cff44=0x0;const _0x294fa8=_0x12dcf6['product_details'][_0x5d307e(0x1b7)](_0xca586b=>{var _0x30a6fa=_0x5d307e;_0xca586b[_0x30a6fa(0x1ae)]==_0x1bc7d4[_0x30a6fa(0x1ae)]&&_0xca586b[_0x30a6fa(0x169)]==_0x1bc7d4['floorlevel']&&_0xca586b['type']==_0x1bc7d4['type']&&_0xca586b['bin']==_0x1bc7d4[_0x30a6fa(0x12d)]&&_0xca586b[_0x30a6fa(0x21e)]==_0x1bc7d4[_0x30a6fa(0x21e)]&&_0xca586b[_0x30a6fa(0x135)]==_0x1bc7d4['rack']&&_0xca586b['storage']==_0x1bc7d4['storage']&&(_0xca586b[_0x30a6fa(0x181)]=parseInt(_0xca586b[_0x30a6fa(0x181)])+parseInt(_0x1bc7d4[_0x30a6fa(0x1fb)]),_0x3cff44++);});_0x3cff44=='0'&&(_0x12dcf6['product_details']=_0x12dcf6[_0x5d307e(0x1a4)]['concat']({'product_name':_0x1bc7d4[_0x5d307e(0x1ae)],'product_stock':_0x1bc7d4['quantity'],'primary_code':_0x1bc7d4['primary_code'],'secondary_code':_0x1bc7d4[_0x5d307e(0x226)],'product_code':_0x1bc7d4[_0x5d307e(0x12a)],'storage':_0x1bc7d4[_0x5d307e(0x1b8)],'rack':_0x1bc7d4['rack'],'bay':_0x1bc7d4[_0x5d307e(0x21e)],'bin':_0x1bc7d4[_0x5d307e(0x12d)],'type':_0x1bc7d4[_0x5d307e(0x146)],'floorlevel':_0x1bc7d4[_0x5d307e(0x169)],'maxProducts':_0x1bc7d4[_0x5d307e(0x1a5)],'unit':_0x1bc7d4[_0x5d307e(0x1fa)],'secondary_unit':_0x1bc7d4[_0x5d307e(0x210)],'expiry_date':_0x1bc7d4['expiry_date']}));}),await _0x12dcf6[_0x63979b(0x212)]();const _0x51eb23=await s_payment_data['findOne']({'invoice':_0x38d58d[_0x63979b(0x201)][_0x63979b(0x16e)]});if(_0x51eb23===null){}else console[_0x63979b(0x22e)]('suppliers',_0x51eb23,_0x38d58d[_0x63979b(0x201)][_0x63979b(0x16e)]),_0x51eb23[_0x63979b(0x160)]=_0x38d58d[_0x63979b(0x201)]['suppliers'],await _0x51eb23[_0x63979b(0x212)]();_0x38d58d[_0x63979b(0x18e)](_0x63979b(0x198),_0x63979b(0x1cc)),_0x1c5935[_0x63979b(0x1dc)]('/all_purchases/view');}catch(_0x18af46){console[_0x63979b(0x22e)](_0x18af46);}}),router[a0_0xab593a(0x132)]('/give_payment/:id',auth,async(_0x568952,_0x1e67f4)=>{var _0xb97c5e=a0_0xab593a;try{const _0x2009c1=_0x568952[_0xb97c5e(0x1df)]['id'],{invoice:_0xf1a8f4,suppliers:_0x1332d0,payable:_0x25cb3e,due_amount:_0x1e0bf3}=_0x568952[_0xb97c5e(0x201)],_0x599eed=await purchases[_0xb97c5e(0x168)](_0x2009c1);var _0xdd9a73=_0x25cb3e-_0x1e0bf3;_0x599eed[_0xb97c5e(0x20a)]=parseFloat(_0x599eed[_0xb97c5e(0x20a)])+parseFloat(_0x1e0bf3),_0x599eed[_0xb97c5e(0x1a9)]=_0xdd9a73;const _0x72dc5e=await _0x599eed[_0xb97c5e(0x212)]();console['log'](_0x72dc5e);const _0x3d3237=await s_payment_data[_0xb97c5e(0x124)]({'invoice':_0xf1a8f4});_0x3d3237['amount']=_0xdd9a73,await _0x3d3237[_0xb97c5e(0x212)]();let _0x42c9f4=new Date(),_0x23826a=('0'+_0x42c9f4['getDate']())['slice'](-0x2),_0x4055a0=('0'+(_0x42c9f4[_0xb97c5e(0x1dd)]()+0x1))[_0xb97c5e(0x1f4)](-0x2),_0x30579a=_0x42c9f4[_0xb97c5e(0x1f7)](),_0x3fcfda=_0x30579a+'-'+_0x4055a0+'-'+_0x23826a;const _0x48c27f=new suppliers_payment({'invoice':_0xf1a8f4,'date':_0x30579a+'-'+_0x4055a0+'-'+_0x23826a,'suppliers':_0x1332d0,'reason':_0xb97c5e(0x1e8),'amount':_0x1e0bf3}),_0x19bc76=await _0x48c27f['save']();_0x568952[_0xb97c5e(0x18e)](_0xb97c5e(0x198),'payment\x20successfull'),_0x1e67f4[_0xb97c5e(0x1dc)](_0xb97c5e(0x1da));}catch(_0x474e65){console[_0xb97c5e(0x22e)](_0x474e65);}}),router[a0_0xab593a(0x189)](a0_0xab593a(0x144),auth,async(_0x29af0d,_0x40bef3)=>{var _0x3cb585=a0_0xab593a;try{const {username:_0x181635,email:_0x4636b4,role:_0x247c53}=_0x29af0d[_0x3cb585(0x191)],_0x185ce7=_0x29af0d[_0x3cb585(0x191)],_0x264312=await profile[_0x3cb585(0x124)]({'email':_0x185ce7[_0x3cb585(0x221)]}),_0x3ed045=await master_shop[_0x3cb585(0x166)]();console[_0x3cb585(0x22e)](_0x3cb585(0x122),_0x3ed045);const _0x420d29=_0x29af0d['params']['id'],_0x2c76ef=await purchases[_0x3cb585(0x168)](_0x420d29);console[_0x3cb585(0x22e)](_0x2c76ef);const _0x4c7f21=await suppliers['findOne']({'name':_0x2c76ef[_0x3cb585(0x160)]});console[_0x3cb585(0x22e)](_0x4c7f21);if(_0x3ed045[0x0]['language']==_0x3cb585(0x234)){var _0x10623c=users[_0x3cb585(0x1aa)];console[_0x3cb585(0x22e)](_0x10623c);}else{if(_0x3ed045[0x0][_0x3cb585(0x1bf)]==_0x3cb585(0x196))var _0x10623c=users['Hindi'];else{if(_0x3ed045[0x0][_0x3cb585(0x1bf)]=='German')var _0x10623c=users[_0x3cb585(0x195)];else{if(_0x3ed045[0x0][_0x3cb585(0x1bf)]==_0x3cb585(0x125))var _0x10623c=users[_0x3cb585(0x125)];else{if(_0x3ed045[0x0]['language']==_0x3cb585(0x21c))var _0x10623c=users[_0x3cb585(0x21c)];else{if(_0x3ed045[0x0][_0x3cb585(0x1bf)]==_0x3cb585(0x1d4))var _0x10623c=users[_0x3cb585(0x1bd)];else{if(_0x3ed045[0x0][_0x3cb585(0x1bf)]==_0x3cb585(0x19f))var _0x10623c=users[_0x3cb585(0x19f)];else{if(_0x3ed045[0x0]['language']=='Arabic\x20(ae)')var _0x10623c=users[_0x3cb585(0x158)];}}}}}}}_0x40bef3[_0x3cb585(0x141)](_0x3cb585(0x16b),{'success':_0x29af0d[_0x3cb585(0x18e)](_0x3cb585(0x198)),'errors':_0x29af0d[_0x3cb585(0x18e)](_0x3cb585(0x208)),'role':_0x185ce7,'profile':_0x264312,'master_shop':_0x3ed045,'supplier':_0x4c7f21,'purchase':_0x2c76ef,'language':_0x10623c});}catch(_0x3ed73c){console[_0x3cb585(0x22e)](_0x3ed73c);}}),router[a0_0xab593a(0x189)](a0_0xab593a(0x200),auth,async(_0x41d53c,_0x23db6a)=>{var _0x4b27a0=a0_0xab593a;try{const {username:_0x51236c,email:_0x410c5e,role:_0x320139}=_0x41d53c['user'],_0x1cf9fe=_0x41d53c['user'],_0x5d0d96=await profile[_0x4b27a0(0x124)]({'email':_0x1cf9fe[_0x4b27a0(0x221)]}),_0x1fcafd=await master_shop[_0x4b27a0(0x166)]();console[_0x4b27a0(0x22e)]('master',_0x1fcafd);const _0x14571d=_0x41d53c[_0x4b27a0(0x1df)]['id'];console[_0x4b27a0(0x22e)](_0x14571d);const _0x4e0a5d=await purchases[_0x4b27a0(0x168)](_0x14571d);console[_0x4b27a0(0x22e)]('user_id',_0x4e0a5d);const _0x4bebad=await product[_0x4b27a0(0x166)]({}),_0x9f827=await warehouse['aggregate']([{'$match':{'name':_0x4e0a5d[_0x4b27a0(0x1ab)],'room':_0x4e0a5d[_0x4b27a0(0x15d)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x4b27a0(0x186)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4b27a0(0x1d0)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4b27a0(0x228)},'bin':{'$first':_0x4b27a0(0x18c)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4b27a0(0x128)},'secondary_code':{'$first':_0x4b27a0(0x203)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4b27a0(0x136)},'rack':{'$first':_0x4b27a0(0x18b)}}}]);warehouse_data=await warehouse[_0x4b27a0(0x14b)]([{'$match':{'status':_0x4b27a0(0x153),'name':_0x4b27a0(0x1d9),'warehouse_category':_0x4b27a0(0x1f1)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),console[_0x4b27a0(0x22e)]('stock_data',_0x9f827);if(_0x1fcafd[0x0]['language']==_0x4b27a0(0x234)){var _0x182a34=users[_0x4b27a0(0x1aa)];console[_0x4b27a0(0x22e)](_0x182a34);}else{if(_0x1fcafd[0x0][_0x4b27a0(0x1bf)]==_0x4b27a0(0x196))var _0x182a34=users[_0x4b27a0(0x196)];else{if(_0x1fcafd[0x0]['language']==_0x4b27a0(0x195))var _0x182a34=users[_0x4b27a0(0x195)];else{if(_0x1fcafd[0x0][_0x4b27a0(0x1bf)]==_0x4b27a0(0x125))var _0x182a34=users[_0x4b27a0(0x125)];else{if(_0x1fcafd[0x0]['language']==_0x4b27a0(0x21c))var _0x182a34=users[_0x4b27a0(0x21c)];else{if(_0x1fcafd[0x0][_0x4b27a0(0x1bf)]==_0x4b27a0(0x1d4))var _0x182a34=users[_0x4b27a0(0x1bd)];else{if(_0x1fcafd[0x0][_0x4b27a0(0x1bf)]=='Chinese')var _0x182a34=users['Chinese'];else{if(_0x1fcafd[0x0][_0x4b27a0(0x1bf)]==_0x4b27a0(0x206))var _0x182a34=users[_0x4b27a0(0x158)];}}}}}}}_0x23db6a[_0x4b27a0(0x141)](_0x4b27a0(0x16c),{'success':_0x41d53c[_0x4b27a0(0x18e)]('success'),'errors':_0x41d53c['flash'](_0x4b27a0(0x208)),'role':_0x1cf9fe,'profile':_0x5d0d96,'user':_0x4e0a5d,'stock':_0x9f827,'master_shop':_0x1fcafd,'product':_0x4bebad,'language':_0x182a34,'warehouse':warehouse_data});}catch(_0x450020){console['log'](_0x450020);}}),router[a0_0xab593a(0x132)](a0_0xab593a(0x200),auth,async(_0x19ba87,_0x5aa774)=>{var _0x870558=a0_0xab593a;try{const {invoice:_0x32501c,date:_0x1c39ca,warehouse_name:_0x2f9f64,Room_name:_0x16fc8d,product_name:_0x4b6c39,purchase_quantity:_0x282442,stocks:_0x2d1ce1,return_qty:_0x39e09c,note:_0x26e10b,level:_0x3b610f,isle:_0x145f51,pallet:_0x315f09,to_warehouse_name:_0xab51cf,to_Room_name:_0x10ca59}=_0x19ba87['body'],_0x232cdd=await purchases[_0x870558(0x124)]({'_id':_0x19ba87[_0x870558(0x1df)]['id']}),_0xeb7d0c=await warehouse[_0x870558(0x124)]({'name':_0x2f9f64,'room':_0x16fc8d});if(typeof _0x4b6c39==_0x870558(0x1a8))var _0x1ae548=[_0x19ba87['body'][_0x870558(0x1ae)]],_0x2dad67=[_0x19ba87[_0x870558(0x201)]['purchase_quantity']],_0xc323a9=[_0x19ba87['body'][_0x870558(0x17f)]],_0xf1637c=[_0x19ba87[_0x870558(0x201)][_0x870558(0x1b6)]],_0x16dd44=[_0x19ba87[_0x870558(0x201)][_0x870558(0x236)]],_0x53b260=[_0x19ba87['body'][_0x870558(0x1a2)]],_0x2cdfd7=[_0x19ba87[_0x870558(0x201)]['pallet']],_0x3bc0de=[_0x19ba87[_0x870558(0x201)][_0x870558(0x175)]],_0x397875=[_0x19ba87[_0x870558(0x201)][_0x870558(0x1a7)]],_0x45207b=[_0x19ba87[_0x870558(0x201)][_0x870558(0x209)]],_0x2da547=[_0x19ba87[_0x870558(0x201)][_0x870558(0x20c)]];else var _0x1ae548=[..._0x19ba87[_0x870558(0x201)][_0x870558(0x1ae)]],_0x2dad67=[..._0x19ba87[_0x870558(0x201)]['purchase_quantity']],_0xc323a9=[..._0x19ba87[_0x870558(0x201)]['stocks']],_0xf1637c=[..._0x19ba87['body'][_0x870558(0x1b6)]],_0x16dd44=[..._0x19ba87[_0x870558(0x201)]['level']],_0x53b260=[..._0x19ba87[_0x870558(0x201)][_0x870558(0x1a2)]],_0x2cdfd7=[..._0x19ba87[_0x870558(0x201)]['pallet']],_0x3bc0de=[..._0x19ba87['body']['types']],_0x397875=[..._0x19ba87[_0x870558(0x201)][_0x870558(0x1a7)]],_0x45207b=[..._0x19ba87[_0x870558(0x201)][_0x870558(0x209)]],_0x2da547=[..._0x19ba87[_0x870558(0x201)][_0x870558(0x20c)]];const _0x2e6221=_0x1ae548['map'](_0x1d169c=>{return _0x1d169c={'product_name':_0x1d169c};});_0x2dad67['forEach']((_0x419ece,_0x167255)=>{var _0x4f9d78=_0x870558;_0x2e6221[_0x167255][_0x4f9d78(0x232)]=_0x419ece;}),_0xc323a9[_0x870558(0x1c6)]((_0x2e1302,_0x2a0369)=>{var _0x20d3cf=_0x870558;_0x2e6221[_0x2a0369][_0x20d3cf(0x171)]=_0x2e1302;}),_0xf1637c[_0x870558(0x1c6)]((_0x2b6773,_0x48f395)=>{var _0x2f589e=_0x870558;_0x2e6221[_0x48f395][_0x2f589e(0x1b6)]=_0x2b6773;}),_0x16dd44['forEach']((_0x4a4495,_0x314b8d)=>{_0x2e6221[_0x314b8d]['bay']=_0x4a4495;}),_0x53b260[_0x870558(0x1c6)]((_0x25817c,_0x1099ff)=>{var _0x276fb6=_0x870558;_0x2e6221[_0x1099ff][_0x276fb6(0x12d)]=_0x25817c;}),_0x2cdfd7[_0x870558(0x1c6)]((_0x31477c,_0x11477d)=>{_0x2e6221[_0x11477d]['floorlevel']=_0x31477c;}),_0x3bc0de[_0x870558(0x1c6)]((_0x1fabfd,_0x5a1a7d)=>{var _0x8d1ee1=_0x870558;_0x2e6221[_0x5a1a7d][_0x8d1ee1(0x146)]=_0x1fabfd;}),_0x397875[_0x870558(0x1c6)]((_0x31712b,_0x4ebfbc)=>{var _0x14d1de=_0x870558;_0x2e6221[_0x4ebfbc][_0x14d1de(0x12a)]=_0x31712b;}),_0x45207b[_0x870558(0x1c6)]((_0x291568,_0x36273a)=>{var _0x10398f=_0x870558;_0x2e6221[_0x36273a][_0x10398f(0x1fe)]=_0x291568;}),_0x2da547['forEach']((_0x1b40f7,_0x319c37)=>{var _0x2494cd=_0x870558;_0x2e6221[_0x319c37][_0x2494cd(0x226)]=_0x1b40f7;}),_0x232cdd[_0x870558(0x150)][_0x870558(0x1c6)](_0x57e0ec=>{var _0x7f50e1=_0x870558;const _0x2fc0ac=_0xeb7d0c[_0x7f50e1(0x1a4)][_0x7f50e1(0x1b7)](_0x42bad1=>{var _0xdd97e6=_0x7f50e1;_0x42bad1[_0xdd97e6(0x1ae)]==_0x57e0ec['product_name']&&_0x42bad1['floorlevel']==_0x57e0ec[_0xdd97e6(0x169)]&&_0x42bad1[_0xdd97e6(0x146)]==_0x57e0ec['type']&&_0x42bad1[_0xdd97e6(0x12d)]==_0x57e0ec['bin']&&_0x42bad1[_0xdd97e6(0x21e)]==_0x57e0ec[_0xdd97e6(0x21e)]&&_0x42bad1[_0xdd97e6(0x135)]==_0x57e0ec[_0xdd97e6(0x135)]&&_0x42bad1[_0xdd97e6(0x1b8)]==_0x57e0ec[_0xdd97e6(0x1b8)]&&(console[_0xdd97e6(0x22e)](parseInt(_0x42bad1[_0xdd97e6(0x181)])+_0xdd97e6(0x207)+parseInt(_0x57e0ec[_0xdd97e6(0x1fb)])),_0x42bad1[_0xdd97e6(0x181)]=parseInt(_0x42bad1[_0xdd97e6(0x181)])+parseInt(_0x57e0ec[_0xdd97e6(0x1fb)]));});}),await _0xeb7d0c['save']();const _0x3b2ba8=_0x2e6221[_0x870558(0x1e4)](_0x4fc57c=>_0x4fc57c[_0x870558(0x1b6)]!=='0'&&_0x4fc57c[_0x870558(0x1b6)]!=='');var _0x615303=0x0;_0x3b2ba8['forEach'](_0x3b676e=>{var _0x59a5ff=_0x870558;console['log']('foreach\x20newproduct',_0x3b676e),(parseInt(_0x3b676e['purchase_quantity'])<parseInt(_0x3b676e['return_qty'])||parseInt(_0x3b676e['stock_quantity'])<parseInt(_0x3b676e[_0x59a5ff(0x1b6)]))&&_0x615303++;});if(_0x615303!=0x0)return _0x19ba87['flash'](_0x870558(0x208),_0x870558(0x1ea)),_0x5aa774[_0x870558(0x1dc)](_0x870558(0x1af));const _0x131268=new purchases_return({'invoice':_0x32501c,'suppliers':_0x19ba87[_0x870558(0x201)][_0x870558(0x160)],'date':_0x1c39ca,'warehouse_name':_0x2f9f64,'return_product':_0x3b2ba8,'note':_0x26e10b,'room':_0x16fc8d,'to_warehouse_name':_0xab51cf,'to_room':_0x10ca59}),_0x55baa8=await _0x131268['save']();console[_0x870558(0x22e)](_0x131268);const _0x5654a1=await purchases_return[_0x870558(0x124)]({'invoice':_0x32501c}),_0x4c9039=await warehouse[_0x870558(0x124)]({'name':_0xab51cf,'room':_0x10ca59});_0x5654a1[_0x870558(0x192)][_0x870558(0x1c6)](_0x833811=>{var _0x328ef8=_0x870558,_0x17444b=0x0;const _0x48d5a7=_0x4c9039[_0x328ef8(0x1a4)][_0x328ef8(0x1b7)](_0x162c32=>{var _0x33b7c8=_0x328ef8;_0x162c32[_0x33b7c8(0x1ae)]==_0x833811[_0x33b7c8(0x1ae)]&&_0x162c32[_0x33b7c8(0x169)]==_0x833811['floorlevel']&&_0x162c32[_0x33b7c8(0x146)]==_0x833811['type']&&_0x162c32[_0x33b7c8(0x12d)]==_0x833811[_0x33b7c8(0x12d)]&&_0x162c32['bay']==_0x833811['bay']&&(_0x162c32['product_stock']=parseInt(_0x162c32[_0x33b7c8(0x181)])-parseInt(_0x833811[_0x33b7c8(0x1b6)]),_0x17444b++);});_0x17444b=='0'&&(_0x4c9039[_0x328ef8(0x1a4)]=_0x4c9039['product_details'][_0x328ef8(0x1ac)]({'product_name':_0x833811[_0x328ef8(0x1ae)],'product_stock':_0x833811[_0x328ef8(0x1b6)],'primary_code':_0x833811['primary_code'],'secondary_code':_0x833811[_0x328ef8(0x226)],'product_code':_0x833811[_0x328ef8(0x12a)],'storage':_0x833811[_0x328ef8(0x1b8)],'rack':_0x833811['rack'],'bay':_0x833811['bay'],'bin':_0x833811['bin'],'type':_0x833811['type'],'floorlevel':_0x833811[_0x328ef8(0x169)],'maxProducts':_0x833811[_0x328ef8(0x1a5)],'unit':_0x833811[_0x328ef8(0x1fa)],'secondary_unit':_0x833811['secondary_unit'],'expiry_date':_0x833811[_0x328ef8(0x13f)]}));}),await _0x4c9039[_0x870558(0x212)]();const _0x402039=await purchases['findOne']({'invoice':_0x32501c});_0x402039['return_data']='True';const _0xd76ff3=await _0x402039[_0x870558(0x212)](),_0x35d1da=new s_payment_data({'invoice':_0x32501c,'suppliers':_0x19ba87['body']['suppliers'],'reason':_0x870558(0x1a3)});await _0x35d1da[_0x870558(0x212)]();const _0x1fc37c=await master_shop[_0x870558(0x166)]();console[_0x870558(0x22e)]('add\x20post',_0x1fc37c[0x0][_0x870558(0x15f)]);const _0x377cb5=await email_settings[_0x870558(0x124)](),_0x5bd33a=await suppliers[_0x870558(0x124)]({'name':_0x19ba87[_0x870558(0x201)][_0x870558(0x160)]});console[_0x870558(0x22e)](_0x870558(0x16a),_0x5bd33a);_0x1fc37c[0x0][_0x870558(0x1a1)]==0x1?(right_currency=_0x1fc37c[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x1fc37c[0x0][_0x870558(0x1f3)]);var _0x25acf5=_0x1ae548,_0x1fd440=_0xf1637c,_0x62998='',_0x30b3c9;for(_0x30b3c9 in _0x25acf5){_0x62998+=_0x870558(0x1ff)+_0x870558(0x154)+_0x25acf5[_0x30b3c9]+_0x870558(0x1d6)+_0x870558(0x154)+_0x1fd440[_0x30b3c9]+'</td>'+'</tr>';}console['log'](_0x870558(0x197),_0x62998);let _0x46794c=nodemailer[_0x870558(0x13c)]({'service':_0x870558(0x13b),'auth':{'user':_0x377cb5['email'],'pass':_0x377cb5['password']}}),_0x2d1c4f={'from':_0x377cb5[_0x870558(0x221)],'to':_0x5bd33a[_0x870558(0x221)],'subject':'Purchase\x20Return\x20Mail','attachments':[{'filename':_0x870558(0x22d),'path':__dirname+_0x870558(0x148)+_0x870558(0x1ec)+_0x1fc37c[0x0][_0x870558(0x15f)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x870558(0x127)+'</head><body>'+_0x870558(0x1fd)+_0x870558(0x179)+_0x870558(0x1fd)+_0x870558(0x1d5)+_0x870558(0x157)+_0x870558(0x1fd)+_0x870558(0x164)+_0x1fc37c[0x0][_0x870558(0x19e)]+'\x20</h2>'+_0x870558(0x157)+_0x870558(0x157)+_0x870558(0x17e)+_0x870558(0x1fd)+_0x870558(0x20e)+_0x870558(0x149)+_0x32501c+'\x20'+_0x870558(0x178)+_0x870558(0x15c)+_0x1c39ca+'\x20'+_0x870558(0x193)+_0x870558(0x182)+'</div>'+_0x870558(0x1ee)+_0x870558(0x172)+_0x870558(0x1ff)+_0x870558(0x1c0)+_0x870558(0x205)+_0x870558(0x14e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x870558(0x1f6)+_0x870558(0x1e0)+_0x870558(0x1cd)+'\x20'+_0x62998+'\x20'+'</tbody>'+_0x870558(0x235)+_0x870558(0x1fd)+_0x870558(0x18d)+_0x870558(0x1f9)+_0x1fc37c[0x0][_0x870558(0x19e)]+'</h5>'+'</div>'+_0x870558(0x157)+_0x870558(0x151)};_0x46794c[_0x870558(0x17c)](_0x2d1c4f,function(_0x300d8c,_0x2850fb){var _0x599ee8=_0x870558;_0x300d8c?(console['log'](_0x300d8c),console[_0x599ee8(0x22e)](_0x599ee8(0x219))):console['log']('Email\x20sent\x20successfully');}),_0x19ba87[_0x870558(0x18e)](_0x870558(0x198),'purchases\x20item\x20return\x20successfull'),_0x5aa774[_0x870558(0x1dc)](_0x870558(0x1da));}catch(_0x11a8a5){console['log'](_0x11a8a5),_0x5aa774[_0x870558(0x137)](0xc8)[_0x870558(0x1d8)]({'message':_0x11a8a5[_0x870558(0x14c)]});}}),router['get'](a0_0xab593a(0x165),auth,async(_0x1b1584,_0x1427ce)=>{var _0xee9f9c=a0_0xab593a;try{const {username:_0x5b1464,email:_0x41ed73,role:_0x566d62}=_0x1b1584[_0xee9f9c(0x191)],_0x216377=_0x1b1584[_0xee9f9c(0x191)],_0xd6fec8=await profile[_0xee9f9c(0x124)]({'email':_0x216377[_0xee9f9c(0x221)]}),_0x33fe59=await master_shop[_0xee9f9c(0x166)](),_0x554807=_0x1b1584[_0xee9f9c(0x1df)]['id'],_0x435e48=await purchases[_0xee9f9c(0x168)](_0x554807);if(_0x33fe59[0x0][_0xee9f9c(0x1bf)]==_0xee9f9c(0x234))var _0x2950d2=users[_0xee9f9c(0x1aa)];else{if(_0x33fe59[0x0]['language']==_0xee9f9c(0x196))var _0x2950d2=users[_0xee9f9c(0x196)];else{if(_0x33fe59[0x0][_0xee9f9c(0x1bf)]==_0xee9f9c(0x195))var _0x2950d2=users['German'];else{if(_0x33fe59[0x0][_0xee9f9c(0x1bf)]==_0xee9f9c(0x125))var _0x2950d2=users['Spanish'];else{if(_0x33fe59[0x0][_0xee9f9c(0x1bf)]==_0xee9f9c(0x21c))var _0x2950d2=users[_0xee9f9c(0x21c)];else{if(_0x33fe59[0x0][_0xee9f9c(0x1bf)]==_0xee9f9c(0x1d4))var _0x2950d2=users[_0xee9f9c(0x1bd)];else{if(_0x33fe59[0x0][_0xee9f9c(0x1bf)]==_0xee9f9c(0x19f))var _0x2950d2=users[_0xee9f9c(0x19f)];else{if(_0x33fe59[0x0][_0xee9f9c(0x1bf)]==_0xee9f9c(0x206))var _0x2950d2=users[_0xee9f9c(0x158)];}}}}}}}_0x1427ce[_0xee9f9c(0x141)](_0xee9f9c(0x22b),{'success':_0x1b1584[_0xee9f9c(0x18e)](_0xee9f9c(0x198)),'errors':_0x1b1584[_0xee9f9c(0x18e)]('errors'),'role':_0x216377,'profile':_0xd6fec8,'alldata':_0x435e48,'master_shop':_0x33fe59,'language':_0x2950d2}),console[_0xee9f9c(0x22e)](alldata);}catch(_0x2d7d97){console[_0xee9f9c(0x22e)](_0x2d7d97);}}),router['post']('/barcode_scanner',async(_0x44af8d,_0x21b91c)=>{var _0x51fe8c=a0_0xab593a;const {product_code:_0x62da6e}=_0x44af8d['body'];var _0x3b4591;const _0x32e97d=await product[_0x51fe8c(0x14b)]([{'$match':{'primary_code':_0x62da6e,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x51fe8c(0x222),'name':{'$first':_0x51fe8c(0x138)},'category':{'$first':_0x51fe8c(0x15b)},'brand':{'$first':_0x51fe8c(0x177)},'unit':{'$first':'$unit'},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x51fe8c(0x1e9)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x51fe8c(0x202)},'maxStocks':{'$first':_0x51fe8c(0x131)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x51fe8c(0x1cf)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x287e68=await product[_0x51fe8c(0x14b)]([{'$match':{'secondary_code':_0x62da6e,'product_category':_0x51fe8c(0x1f1)}},{'$group':{'_id':_0x51fe8c(0x222),'name':{'$first':'$name'},'category':{'$first':_0x51fe8c(0x15b)},'brand':{'$first':_0x51fe8c(0x177)},'unit':{'$first':_0x51fe8c(0x134)},'alertquantity':{'$first':_0x51fe8c(0x159)},'product_code':{'$first':_0x51fe8c(0x1e9)},'primary_code':{'$first':_0x51fe8c(0x231)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x51fe8c(0x19c)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x51fe8c(0x1cf)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x32e97d['length']>0x0)_0x3b4591=_0x32e97d;else _0x287e68[_0x51fe8c(0x22f)]>0x0&&(_0x3b4591=_0x287e68);_0x21b91c['json'](_0x3b4591);}),router[a0_0xab593a(0x132)](a0_0xab593a(0x17d),async(_0x589c27,_0x2d0751)=>{var _0x5c5a53=a0_0xab593a;const {primaryCode:_0x10012c,secondaryCode:_0xdb932e,productCode:_0x29d2a0,bay:_0x33e033,bin:_0x17fff,types:_0x2f7748,pallet:_0x353843,warehouses:_0x596d60,room:_0x2c27ac}=_0x589c27['body'];console[_0x5c5a53(0x22e)](_0x589c27[_0x5c5a53(0x201)]);try{const _0xb9b841=await warehouse[_0x5c5a53(0x14b)]([{'$match':{'name':_0x596d60,'room':_0x2c27ac}},{'$unwind':_0x5c5a53(0x186)},{'$match':{'product_details.bay':_0x33e033,'product_details.bin':_0x17fff,'product_details.type':_0x2f7748}},{'$group':{'_id':_0x5c5a53(0x174),'name':{'$first':_0x5c5a53(0x1d0)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x5c5a53(0x161)},'isle':{'$first':_0x5c5a53(0x1eb)},'pallet':{'$first':_0x5c5a53(0x1de)},'maxProducts':{'$first':_0x5c5a53(0x190)}}}]);_0x2d0751[_0x5c5a53(0x137)](0xc8)[_0x5c5a53(0x1d8)](_0xb9b841);}catch(_0x4cbfb7){_0x2d0751['status'](0x194)[_0x5c5a53(0x1d8)]({'message':_0x4cbfb7[_0x5c5a53(0x14c)]});}}),module[a0_0xab593a(0x225)]=router;function a0_0x6b8c(){var _0x1138c2=['/all_purchases/view/','path','858436mhkuRs','product_cat','warehouse','return_qty','map','storage','rak','Purchase\x20Mail','RMSEmail','add_purchases','Portuguese','push','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','prod_primunit','Rack\x20B','$product.bin','JO_number','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','forEach','delivery_date','$product.room_name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','all','$finalize','purchase\x20data\x20update\x20successfully','<tbody\x20style=\x22text-align:\x20center;\x22>','deliverycode','$secondary_unit','$product_details.product_name','error','$date','Router','Portuguese\x20(BR)','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','</td>','catch','json','Return\x20Goods','/all_purchases/view','4OZxxEO','redirect','getMonth','$product_details.pallet','params','</thead>','prod_cat','$product_details.expiry_date','prod_name','filter','prod_Qty','\x20</h2>','Rack\x20C','Paid\x20For\x20Purchase','$product_code','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','$product_details.isle','/upload/','express','<table\x20style=\x22width:\x20100%\x20!important;\x22>','getDate','3218058FxzWPg','Raw\x20Materials','$invoice','currency','slice','RoomAssign','</tr>','getFullYear','An\x20error\x20occurred.','<h5>','standard_unit','quantity','delivery_code','<div>','primary_code','<tr>','/view/return_purchase/:id','body','$secondary_code','$product_details.secondary_code','Email\x20sent\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','Arabic\x20(ae)','\x20<>\x20','errors','primary_code_hide','paid_amount','Ambient','secondary_code_hide','$product.bay','<h5\x20style=\x22text-align:\x20left;\x22>','table\x20page','secondary_unit','254412fTWGAB','save','Purchase\x20data\x20added\x20successfully','prod_isle','host','prod_level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Error\x20Occurs','prod_secondunit','/view/:id','French','INC-','bay','True','$product.floorlevel','email','$_id','abs','$note','exports','secondary_code','MaxStocks_data','$product_details.bay','198276iGxFfR','../middleware/auth','all_purchases_barcode','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Logo.png','log','length','name','$primary_code','purchase_quantity','$product.type','English\x20(US)','</table>','level','/view/add_purchases','../models/all_models','ejs','all_purchases','master','/view','findOne','Spanish','actual_uom','<html><head><title></title>','$product_details.primary_code','$suppliers','product_code','Level','$due_amount','bin','floor','alertQTY','then','$maxStocks','post','date','$unit','rack','$product_details.storage','status','$name','room_name','suppliers_docs','gmail','createTransport','port','Sales\x20Update\x20successfully','expiry_date','Room_name','render','</head><body>','$suppliers_docs','/invoice/:id','padStart','type','finalize','/../public','\x20Order\x20Number\x20:\x20','<!DOCTYPE\x20html>','aggregate','message','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','$batch_code','product','</body></html>','COLD\x20STORAGE','Enabled','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','8ayaUuP','logo','</div>','Arabic','$alertquantity','953712JycOVy','$category','\x20Order\x20Date\x20:\x20','room','prod_invoice','image','suppliers','$product_details.level','$product.quantity','prod_pallet','<h2>\x20','/barcode/:id','find','$product','findById','floorlevel','suppliers_data','purchase_invoice','return_purchase','$expiry_date','invoice','786505LAJmLM','/preview/:id','stock_quantity','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','max_product_unit','$product_details._id','types','Shelves','$brand','<span\x20style=\x22float:\x20right;\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$paid_amount','nodemailer','sendMail','/CheckingWarehouse','<hr\x20class=\x22my-3\x22>','stocks','maxperunit','product_stock','</h5>','staff','batch_code','prod_qty','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Floor','get','actual_qty','$product_details.rack','$product_details.bin','<strong>\x20Regards\x20</strong>','flash','2578772uGjHDA','$product_details.maxProducts','user','return_product','</span>','role','German','Hindi','product_list','success','Receiving\x20Area','edit_purchases','../public/language/languages.json','$maxProdPerUnit','Rack\x20A','site_title','Chinese','prod_code','currency_placement','isle','Purchase\x20Return','product_details','maxStocks','$room','product_code_hide','string','due_amount','English','warehouse_name','concat','Rack\x20D','product_name','back','$return_data'];a0_0x6b8c=function(){return _0x1138c2;};return a0_0x6b8c();}