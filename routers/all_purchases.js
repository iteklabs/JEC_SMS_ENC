function a0_0x56a9(_0x17bfaf,_0x2cc3ad){var _0x135a04=a0_0x135a();return a0_0x56a9=function(_0x56a9db,_0x2d73c0){_0x56a9db=_0x56a9db-0xe3;var _0x2d4838=_0x135a04[_0x56a9db];return _0x2d4838;},a0_0x56a9(_0x17bfaf,_0x2cc3ad);}var a0_0x471c87=a0_0x56a9;(function(_0x149d47,_0x1cdf83){var _0x209d4a=a0_0x56a9,_0x43752e=_0x149d47();while(!![]){try{var _0xde0900=-parseInt(_0x209d4a(0x1d0))/0x1+-parseInt(_0x209d4a(0x1b7))/0x2*(parseInt(_0x209d4a(0x142))/0x3)+-parseInt(_0x209d4a(0x1bf))/0x4+-parseInt(_0x209d4a(0x1a7))/0x5*(-parseInt(_0x209d4a(0x175))/0x6)+parseInt(_0x209d4a(0x166))/0x7+-parseInt(_0x209d4a(0x1dc))/0x8*(parseInt(_0x209d4a(0x122))/0x9)+parseInt(_0x209d4a(0x1f8))/0xa*(parseInt(_0x209d4a(0x184))/0xb);if(_0xde0900===_0x1cdf83)break;else _0x43752e['push'](_0x43752e['shift']());}catch(_0x13f0c7){_0x43752e['push'](_0x43752e['shift']());}}}(a0_0x135a,0x41572));const express=require(a0_0x471c87(0x16d)),app=express(),router=express[a0_0x471c87(0xf8)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x471c87(0xf3)),auth=require('../middleware/auth'),nodemailer=require(a0_0x471c87(0x133));var ejs=require(a0_0x471c87(0x1d3));const path=require(a0_0x471c87(0x1e7)),users=require('../public/language/languages.json');router[a0_0x471c87(0x17e)]('/view',auth,async(_0x2c3c37,_0x37e54e)=>{var _0x2c7353=a0_0x471c87;try{const {username:_0x3596a7,email:_0x5af9d5,role:_0x4568c1}=_0x2c3c37[_0x2c7353(0x13f)],_0x1f66e4=_0x2c3c37[_0x2c7353(0x13f)],_0x598069=await profile[_0x2c7353(0x128)]({'email':_0x1f66e4[_0x2c7353(0x1d4)]}),_0x3f61ce=await staff['findOne']({'email':_0x1f66e4[_0x2c7353(0x1d4)]});if(_0x1f66e4[_0x2c7353(0x1f6)]==_0x2c7353(0xee)){const _0x3323cf=await staff[_0x2c7353(0x128)]({'email':_0x1f66e4[_0x2c7353(0x1d4)]});}const _0x4c49e3=await master_shop[_0x2c7353(0x1e3)]();let _0x249947;if(_0x1f66e4[_0x2c7353(0x1f6)]=='staff'){const _0x2c127b=await staff[_0x2c7353(0x128)]({'email':_0x1f66e4[_0x2c7353(0x1d4)]});_0x249947=await purchases[_0x2c7353(0x1d9)]([{'$match':{'warehouse_name':_0x2c127b[_0x2c7353(0x14b)]}},{'$lookup':{'from':_0x2c7353(0x118),'localField':_0x2c7353(0x118),'foreignField':_0x2c7353(0xe3),'as':_0x2c7353(0x1e5)}},{'$unwind':_0x2c7353(0x173)},{'$unwind':'$product'},{'$group':{'_id':_0x2c7353(0x16b),'invoice':{'$first':'$invoice'},'suppliers':{'$first':_0x2c7353(0x115)},'date':{'$first':_0x2c7353(0x1ec)},'warehouse_name':{'$first':_0x2c7353(0xfe)},'room':{'$first':_0x2c7353(0x153)},'product':{'$push':'$product'},'note':{'$first':_0x2c7353(0x1fe)},'paid_amount':{'$first':_0x2c7353(0x16a)},'due_amount':{'$first':_0x2c7353(0xfd)},'return_data':{'$first':_0x2c7353(0x156)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0x2c7353(0x121)},'suppliers_docs':{'$first':_0x2c7353(0x173)},'total_product_quantity':{'$sum':_0x2c7353(0x1d8)},'level':{'$addToSet':_0x2c7353(0x14c)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x2c7353(0xf0)},'floorlevel':{'$addToSet':'$product.floorlevel'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x249947=await purchases[_0x2c7353(0x1d9)]([{'$lookup':{'from':_0x2c7353(0x118),'localField':_0x2c7353(0x118),'foreignField':_0x2c7353(0xe3),'as':_0x2c7353(0x1e5)}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x2c7353(0x1fa)},{'$group':{'_id':_0x2c7353(0x16b),'invoice':{'$first':_0x2c7353(0x158)},'suppliers':{'$first':_0x2c7353(0x115)},'date':{'$first':_0x2c7353(0x1ec)},'warehouse_name':{'$first':_0x2c7353(0xfe)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':_0x2c7353(0x1fa)},'note':{'$first':'$note'},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x2c7353(0xfd)},'return_data':{'$first':_0x2c7353(0x156)},'batch_code':{'$first':_0x2c7353(0x1c9)},'expiry_date':{'$first':_0x2c7353(0x121)},'suppliers_docs':{'$first':_0x2c7353(0x173)},'total_product_quantity':{'$sum':_0x2c7353(0x1d8)},'level':{'$addToSet':_0x2c7353(0x14c)},'isle':{'$addToSet':_0x2c7353(0x200)},'type':{'$addToSet':_0x2c7353(0xf0)},'floorlevel':{'$addToSet':_0x2c7353(0x109)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x4c49e3[0x0][_0x2c7353(0x19f)]==_0x2c7353(0x18f)){var _0x54aed7=users[_0x2c7353(0x183)];console[_0x2c7353(0x125)](_0x54aed7);}else{if(_0x4c49e3[0x0][_0x2c7353(0x19f)]=='Hindi')var _0x54aed7=users[_0x2c7353(0x113)];else{if(_0x4c49e3[0x0]['language']=='German')var _0x54aed7=users[_0x2c7353(0x1d7)];else{if(_0x4c49e3[0x0]['language']==_0x2c7353(0xe9))var _0x54aed7=users[_0x2c7353(0xe9)];else{if(_0x4c49e3[0x0][_0x2c7353(0x19f)]==_0x2c7353(0x1bb))var _0x54aed7=users['French'];else{if(_0x4c49e3[0x0]['language']==_0x2c7353(0xf1))var _0x54aed7=users[_0x2c7353(0x137)];else{if(_0x4c49e3[0x0][_0x2c7353(0x19f)]=='Chinese')var _0x54aed7=users['Chinese'];else{if(_0x4c49e3[0x0][_0x2c7353(0x19f)]==_0x2c7353(0x1b1))var _0x54aed7=users[_0x2c7353(0x162)];}}}}}}}_0x37e54e[_0x2c7353(0x101)](_0x2c7353(0x108),{'success':_0x2c3c37['flash']('success'),'errors':_0x2c3c37[_0x2c7353(0x15f)](_0x2c7353(0xf5)),'purchases':_0x249947,'role':_0x1f66e4,'profile':_0x598069,'master_shop':_0x4c49e3,'language':_0x54aed7});}catch(_0xb87397){console[_0x2c7353(0x125)](_0x2c7353(0x150),_0xb87397),_0x37e54e[_0x2c7353(0x160)](0xc8)[_0x2c7353(0x1c8)]({'message':_0xb87397[_0x2c7353(0x116)]});}});function BayBinSelected(_0x5f12cb,_0x1552b4){var _0x111faf=a0_0x471c87,_0x1d4f0c=[],_0x412bb8=[],_0x131a94=[],_0x1b83f0=[],_0x1d21ca=[],_0x27606d=[];let _0x5d5ce8=[];if(_0x5f12cb==_0x111faf(0x1fb))switch(_0x1552b4){case _0x111faf(0x201):_0x1d4f0c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x412bb8=[0x1,0x2],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5],_0x131a94=[_0x111faf(0x11f),_0x111faf(0x1d1)],_0x1d21ca=['D'],_0x27606d=['A'];break;case _0x111faf(0x199):_0x1d4f0c=[0x6,0x5,0x4,0x3,0x2,0x1],_0x412bb8=[0x1,0x2],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5],_0x131a94=[_0x111faf(0x11f),'Floor'],_0x1d21ca=['D'],_0x27606d=['B'];break;case _0x111faf(0x1ca):_0x1d4f0c=[0x0],_0x412bb8=[0x0],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5],_0x131a94=[_0x111faf(0x1d1)],_0x1d21ca=['D'],_0x27606d=['S'];break;case _0x111faf(0x1de):_0x1d4f0c=[0x0],_0x412bb8=[0x0],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x131a94=[_0x111faf(0x1d1)],_0x1d21ca=['D'],_0x27606d=['R'];break;}else{if(_0x5f12cb==_0x111faf(0x188))switch(_0x1552b4){case _0x111faf(0x201):_0x1d4f0c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x412bb8=['B','F'],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5],_0x131a94=['Level',_0x111faf(0x1d1)],_0x1d21ca=['C'],_0x27606d=['A'];break;case _0x111faf(0x199):_0x1d4f0c=[0x5,0x4,0x3,0x2,0x1],_0x412bb8=['F','B','S'],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5],_0x131a94=[_0x111faf(0x11f),_0x111faf(0x1d1)],_0x1d21ca=['C'],_0x27606d=['B'];break;case _0x111faf(0x192):_0x1d4f0c=[0x1,0x2,0x3,0x4,0x5],_0x412bb8=['B','F','S'],_0x1b83f0=[0x5,0x4,0x3,0x2,0x1],_0x131a94=['Level','Floor'],_0x1d21ca=['C'],_0x27606d=['C'];break;case _0x111faf(0x191):_0x1d4f0c=[0x5,0x4,0x3,0x2,0x1],_0x412bb8=['F','B','S'],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5],_0x131a94=['Level',_0x111faf(0x1d1)],_0x1d21ca=['C'],_0x27606d=['D'];break;case _0x111faf(0x123):_0x1d4f0c=[0x4,0x3,0x2,0x1],_0x412bb8=[0x1,0x2],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5],_0x131a94=[_0x111faf(0x11f),'Floor'],_0x1d21ca=['C'],_0x27606d=['E'];break;case _0x111faf(0x169):_0x1d4f0c=[0x1,0x2,0x3],_0x412bb8=[0x1,0x2],_0x1b83f0=[0x1,0x2,0x3,0x4,0x5],_0x131a94=['Level'],_0x1d21ca=['C'],_0x27606d=['F'];break;}}return{'levels':_0x1d4f0c,'Isle':_0x412bb8,'rack':_0x1b83f0,'type':_0x131a94,'storage':_0x1d21ca,'rak':_0x27606d};}async function getRandom8DigitNumber(){var _0x5900b8=a0_0x471c87;const _0x52d9e8=0x989680,_0x3f1959=0x5f5e0ff,_0x488a98=Math[_0x5900b8(0x10a)](Math[_0x5900b8(0x127)]()*(_0x3f1959-_0x52d9e8+0x1))+_0x52d9e8;var _0x29dd20;const _0x4a731=await purchases[_0x5900b8(0x128)]({'invoice':_0x5900b8(0x174)+_0x488a98});return _0x4a731&&_0x4a731[_0x5900b8(0x189)]>0x0?_0x29dd20=_0x5900b8(0x174)+_0x488a98:_0x29dd20=_0x5900b8(0x174)+_0x488a98,_0x29dd20;}router['get'](a0_0x471c87(0x1a1),auth,async(_0x274a52,_0x4cfe10)=>{var _0x3df7a1=a0_0x471c87;try{const {username:_0x53f27f,email:_0x1c3d24,role:_0x2ee7ad}=_0x274a52[_0x3df7a1(0x13f)],_0x3c67ac=_0x274a52[_0x3df7a1(0x13f)],_0x2461ec=await profile[_0x3df7a1(0x128)]({'email':_0x3c67ac[_0x3df7a1(0x1d4)]}),_0x532152=await master_shop[_0x3df7a1(0x1e3)](),_0x5ab8f0=await staff[_0x3df7a1(0x128)]({'email':_0x3c67ac['email']}),_0x528e9c=await suppliers[_0x3df7a1(0x1e3)]({});let _0x245966;if(_0x3c67ac[_0x3df7a1(0x1f6)]==_0x3df7a1(0xee)){const _0x1c6fde=await staff[_0x3df7a1(0x128)]({'email':_0x3c67ac['email']});_0x245966=await warehouse[_0x3df7a1(0x1d9)]([{'$match':{'status':'Enabled','name':_0x1c6fde['warehouse'],'warehouse_category':_0x3df7a1(0xe6),'name':{'$ne':_0x3df7a1(0x17f)}}},{'$group':{'_id':'$name','name':{'$first':_0x3df7a1(0x16f)}}}]);}else _0x245966=await warehouse[_0x3df7a1(0x1d9)]([{'$match':{'status':'Enabled','warehouse_category':_0x3df7a1(0xe6),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x3df7a1(0x16f),'name':{'$first':_0x3df7a1(0x16f)}}}]);const _0xfc01ff=await product[_0x3df7a1(0x1e3)]({}),_0x240730=await warehouse[_0x3df7a1(0x1e3)]({'status':_0x3df7a1(0xed)}),_0xb7a7b4=await purchases[_0x3df7a1(0x1e3)]({}),_0x2412f8=_0xb7a7b4[_0x3df7a1(0x189)]+0x1,_0x1cd2db=_0x3df7a1(0x174)+_0x2412f8[_0x3df7a1(0x195)]()[_0x3df7a1(0x11c)](0x5,'0');var _0x3601b6=[_0x3df7a1(0x1e9),'Enclosed'];if(_0x532152[0x0][_0x3df7a1(0x19f)]==_0x3df7a1(0x18f))var _0x24aa1b=users['English'];else{if(_0x532152[0x0][_0x3df7a1(0x19f)]==_0x3df7a1(0x113))var _0x24aa1b=users[_0x3df7a1(0x113)];else{if(_0x532152[0x0][_0x3df7a1(0x19f)]==_0x3df7a1(0x1d7))var _0x24aa1b=users[_0x3df7a1(0x1d7)];else{if(_0x532152[0x0][_0x3df7a1(0x19f)]=='Spanish')var _0x24aa1b=users[_0x3df7a1(0xe9)];else{if(_0x532152[0x0][_0x3df7a1(0x19f)]==_0x3df7a1(0x1bb))var _0x24aa1b=users['French'];else{if(_0x532152[0x0][_0x3df7a1(0x19f)]=='Portuguese\x20(BR)')var _0x24aa1b=users['Portuguese'];else{if(_0x532152[0x0][_0x3df7a1(0x19f)]==_0x3df7a1(0x17b))var _0x24aa1b=users[_0x3df7a1(0x17b)];else{if(_0x532152[0x0][_0x3df7a1(0x19f)]==_0x3df7a1(0x1b1))var _0x24aa1b=users[_0x3df7a1(0x162)];}}}}}}}const _0x4e95ff=getRandom8DigitNumber();_0x4e95ff[_0x3df7a1(0x186)](_0x3ca0d6=>{var _0x2e3cbd=_0x3df7a1;_0x4cfe10[_0x2e3cbd(0x101)](_0x2e3cbd(0x1ff),{'success':_0x274a52[_0x2e3cbd(0x15f)](_0x2e3cbd(0x1c2)),'errors':_0x274a52['flash'](_0x2e3cbd(0xf5)),'role':_0x3c67ac,'profile':_0x2461ec,'suppliers':_0x528e9c,'warehouse':_0x245966,'product':_0xfc01ff,'invoice':_0x3ca0d6,'master_shop':_0x532152,'language':_0x24aa1b,'find_data':_0x240730,'rooms_data':_0x3601b6});})[_0x3df7a1(0x1bd)](_0x3885e7=>{var _0x358571=_0x3df7a1;_0x274a52['flash'](_0x358571(0xf5),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x4cfe10['redirect'](_0x358571(0x13d));});}catch(_0x2e4637){console['log'](_0x2e4637);}}),router['get'](a0_0x471c87(0x17a),auth,async(_0x3516f7,_0x27aa8d)=>{var _0x3a9ce4=a0_0x471c87;try{const _0x111dd0=_0x3516f7[_0x3a9ce4(0x1f0)]['id'];console['log'](_0x111dd0);const _0xb62bea=await master_shop['find']();console[_0x3a9ce4(0x125)]('master',_0xb62bea);const _0x30cbb9=await product[_0x3a9ce4(0x128)]({'name':_0x111dd0});console['log'](_0x3a9ce4(0x19a),_0x30cbb9),_0x27aa8d[_0x3a9ce4(0x160)](0xc8)['json']({'product_data':_0x30cbb9,'master':_0xb62bea});}catch(_0x2aeb64){console[_0x3a9ce4(0x125)]('add_purchases\x20error',_0x2aeb64);}}),router[a0_0x471c87(0x104)](a0_0x471c87(0x1a1),auth,async(_0x4221f3,_0x42fe1b)=>{var _0x1a0d3d=a0_0x471c87;try{const {invoice:_0x5df199,date:_0x2e88b3,warehouse_name:_0x278a62,prod_name:_0x2ffdb1,prod_code:_0x340a27,prod_qty:_0x23ec86,prod_unit:_0x570524,prod_secondunit:_0x1f61a7,prod_level:_0x56b43a,prod_isle:_0x49face,prod_pallet:_0x369cad,note:_0x38731e,expiry_date:_0x1ceff3,batch_code:_0x35d58a,payable:_0x5cd2af,due_amount:_0x4aba04,Room_name:_0x6d1757,primary_code:_0x4a5599,secondary_code:_0x57f74d,MaxStocks_data:_0x400aee,PO_number:_0x5afa69,SCRN:_0x596f26,JO_number:_0x46f72c}=_0x4221f3['body'];if(typeof _0x2ffdb1==_0x1a0d3d(0x151))var _0x315122=[_0x4221f3['body']['prod_name']],_0x4025c5=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x146)]],_0x16eed9=[_0x4221f3[_0x1a0d3d(0x10b)]['prod_Qty']],_0x2145bb=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x131)]],_0x117ed4=[_0x4221f3['body'][_0x1a0d3d(0x143)]],_0x4f6636=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x194)]],_0x52b3b8=[_0x4221f3[_0x1a0d3d(0x10b)]['primary_code']],_0x255080=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x1cf)]],_0x64c663=[_0x4221f3[_0x1a0d3d(0x10b)]['MaxStocks_data']],_0x47c28e=[_0x4221f3[_0x1a0d3d(0x10b)]['batch_code']],_0x178269=[_0x4221f3['body'][_0x1a0d3d(0x1b8)]],_0x20a329=[_0x4221f3['body'][_0x1a0d3d(0x1e0)]],_0x533254=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x1b6)]],_0x14dd7b=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x19d)]],_0x134b67=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x1b9)]],_0x519c18=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x1a2)]],_0x431dfd=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x17c)]],_0x4e4d29=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x10c)]],_0x588a56=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x147)]],_0x25f3e6=[_0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x1a6)]];else var _0x315122=[..._0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x140)]],_0x4025c5=[..._0x4221f3['body'][_0x1a0d3d(0x146)]],_0x16eed9=[..._0x4221f3[_0x1a0d3d(0x10b)]['prod_Qty']],_0x2145bb=[..._0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x131)]],_0x117ed4=[..._0x4221f3['body']['prod_secondunit']],_0x4f6636=[..._0x4221f3['body']['prod_level']],_0x52b3b8=[..._0x4221f3['body'][_0x1a0d3d(0x1fd)]],_0x255080=[..._0x4221f3['body'][_0x1a0d3d(0x1cf)]],_0x64c663=[..._0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x197)]],_0x47c28e=[..._0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x134)]],_0x178269=[..._0x4221f3['body'][_0x1a0d3d(0x1b8)]],_0x20a329=[..._0x4221f3[_0x1a0d3d(0x10b)]['max_product_unit']],_0x533254=[..._0x4221f3[_0x1a0d3d(0x10b)]['alertQTY']],_0x14dd7b=[..._0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x19d)]],_0x134b67=[..._0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x1b9)]],_0x519c18=[..._0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x1a2)]],_0x431dfd=[..._0x4221f3['body'][_0x1a0d3d(0x17c)]],_0x4e4d29=[..._0x4221f3[_0x1a0d3d(0x10b)]['prod_invoice']],_0x588a56=[..._0x4221f3[_0x1a0d3d(0x10b)][_0x1a0d3d(0x147)]],_0x25f3e6=[..._0x4221f3['body']['actual_uom']];const _0x4b3b1c=_0x315122[_0x1a0d3d(0x1db)](_0x4b1ec8=>{return _0x4b1ec8={'product_name':_0x4b1ec8};});_0x588a56[_0x1a0d3d(0x12b)]((_0x3c8736,_0x1a6e39)=>{var _0x2ee9b1=_0x1a0d3d;_0x4b3b1c[_0x1a6e39]['actual_qty']=Math[_0x2ee9b1(0x193)](_0x3c8736);}),_0x25f3e6[_0x1a0d3d(0x12b)]((_0x24017e,_0x3774e7)=>{var _0x2699a2=_0x1a0d3d;_0x4b3b1c[_0x3774e7][_0x2699a2(0x1a6)]=_0x24017e;}),_0x4025c5[_0x1a0d3d(0x12b)]((_0x402632,_0x31f46c)=>{var _0xa14353=_0x1a0d3d;_0x4b3b1c[_0x31f46c][_0xa14353(0x1a4)]=_0x402632;}),_0x16eed9[_0x1a0d3d(0x12b)]((_0x86862f,_0x20376c)=>{var _0x3f2080=_0x1a0d3d;_0x4b3b1c[_0x20376c][_0x3f2080(0x15b)]=Math[_0x3f2080(0x193)](_0x86862f);}),_0x2145bb['forEach']((_0x37d4dc,_0xe5ac55)=>{var _0x36ab8b=_0x1a0d3d;_0x4b3b1c[_0xe5ac55][_0x36ab8b(0x177)]=_0x37d4dc;}),_0x117ed4['forEach']((_0x15b489,_0x5169d0)=>{var _0x3885f=_0x1a0d3d;_0x4b3b1c[_0x5169d0][_0x3885f(0x202)]=_0x15b489;}),_0x4f6636['forEach']((_0x443d33,_0x27681d)=>{var _0x1bb39c=_0x1a0d3d;_0x519c18[_0x1bb39c(0x12b)]((_0xc4792,_0x377d83)=>{var _0x4de08d=_0x1bb39c;if(_0xc4792=='Receiving\x20Area'&&_0x27681d==_0x377d83){console[_0x4de08d(0x125)](_0xc4792+_0x4de08d(0xe8)+_0x27681d+_0x4de08d(0x1cb)+_0x377d83+_0x4de08d(0x1cb)+_0x443d33);var _0x3d6f99=_0x443d33['slice'](0x3);_0x4b3b1c[_0x27681d][_0x4de08d(0x1f1)]=_0x443d33[0x0],_0x4b3b1c[_0x27681d][_0x4de08d(0x12f)]=_0x443d33[0x1],_0x4b3b1c[_0x27681d][_0x4de08d(0x182)]=0x0,_0x4b3b1c[_0x27681d][_0x4de08d(0x170)]=0x0,_0x4b3b1c[_0x27681d][_0x4de08d(0x1a8)]=_0x4de08d(0x1d1),_0x4b3b1c[_0x27681d][_0x4de08d(0x17d)]=_0x3d6f99;}else{if(_0xc4792==_0x4de08d(0x1ca)&&_0x27681d==_0x377d83){var _0x3d6f99=_0x443d33['slice'](0x3);_0x4b3b1c[_0x27681d]['storage']=_0x443d33[0x0],_0x4b3b1c[_0x27681d]['rack']=_0x443d33[0x1],_0x4b3b1c[_0x27681d]['bay']=0x0,_0x4b3b1c[_0x27681d][_0x4de08d(0x170)]=0x0,_0x4b3b1c[_0x27681d][_0x4de08d(0x1a8)]=_0x4de08d(0x1d1),_0x4b3b1c[_0x27681d][_0x4de08d(0x17d)]=_0x443d33[0x5];}else{if(_0x27681d==_0x377d83){if(_0x443d33[0x0]=='A'&&_0x443d33[0x1]=='L'&&_0x443d33[0x2]=='L')console[_0x4de08d(0x125)](_0xc4792+_0x4de08d(0x1cb)+_0x27681d+_0x4de08d(0x1cb)+_0x377d83+'\x20<>\x20'+_0x443d33+'here'),_0x4b3b1c[_0x27681d][_0x4de08d(0x1f1)]=_0x443d33[0x0],_0x4b3b1c[_0x27681d]['rack']=_0x443d33[0x1],_0x4b3b1c[_0x27681d][_0x4de08d(0x182)]=0x0,_0x4b3b1c[_0x27681d]['bin']=0x0,_0x4b3b1c[_0x27681d][_0x4de08d(0x1a8)]=_0x4de08d(0x1d1),_0x4b3b1c[_0x27681d][_0x4de08d(0x17d)]=_0x443d33[0x3];else{var _0x4037cf;if(_0x443d33[0x4]=='L')_0x4037cf=_0x4de08d(0x11f);else _0x443d33[0x4]=='F'&&(_0x4037cf=_0x4de08d(0x1d1));_0x4b3b1c[_0x27681d]['storage']=_0x443d33[0x0],_0x4b3b1c[_0x27681d][_0x4de08d(0x12f)]=_0x443d33[0x1],_0x4b3b1c[_0x27681d][_0x4de08d(0x182)]=_0x443d33[0x2],_0x4b3b1c[_0x27681d][_0x4de08d(0x170)]=_0x443d33[0x3],_0x4b3b1c[_0x27681d][_0x4de08d(0x1a8)]=_0x4037cf,_0x4b3b1c[_0x27681d][_0x4de08d(0x17d)]=_0x443d33[0x5];}}}}});}),_0x52b3b8[_0x1a0d3d(0x12b)]((_0x16f11b,_0x14d165)=>{_0x4b3b1c[_0x14d165]['primary_code']=_0x16f11b;}),_0x255080[_0x1a0d3d(0x12b)]((_0x45c969,_0x3752fc)=>{_0x4b3b1c[_0x3752fc]['secondary_code']=_0x45c969;}),_0x64c663[_0x1a0d3d(0x12b)]((_0x39367c,_0x487bf9)=>{var _0x5e166e=_0x1a0d3d;_0x4b3b1c[_0x487bf9][_0x5e166e(0x145)]=_0x39367c;}),_0x47c28e[_0x1a0d3d(0x12b)]((_0x43f936,_0x1a8098)=>{var _0x1b1656=_0x1a0d3d;_0x4b3b1c[_0x1a8098][_0x1b1656(0x134)]=_0x43f936;}),_0x178269[_0x1a0d3d(0x12b)]((_0x4fb28c,_0x20bfa0)=>{var _0x5b8ec6=_0x1a0d3d;_0x4b3b1c[_0x20bfa0][_0x5b8ec6(0x1b8)]=_0x4fb28c;}),_0x20a329[_0x1a0d3d(0x12b)]((_0x32dd79,_0x2f2804)=>{_0x4b3b1c[_0x2f2804]['maxperunit']=_0x32dd79;}),_0x533254[_0x1a0d3d(0x12b)]((_0x2916ed,_0x1724b0)=>{_0x4b3b1c[_0x1724b0]['alertQTY']=_0x2916ed;}),_0x14dd7b['forEach']((_0x88680a,_0x1efee2)=>{_0x4b3b1c[_0x1efee2]['production_date']=_0x88680a;}),_0x134b67[_0x1a0d3d(0x12b)]((_0x5e4e1d,_0x32de62)=>{var _0x3a34e8=_0x1a0d3d;_0x4b3b1c[_0x32de62][_0x3a34e8(0x1e8)]=_0x5e4e1d;}),_0x519c18[_0x1a0d3d(0x12b)]((_0x21ce2d,_0x2e9e23)=>{var _0x2d4781=_0x1a0d3d;_0x4b3b1c[_0x2e9e23][_0x2d4781(0x13e)]=_0x21ce2d;}),_0x431dfd[_0x1a0d3d(0x12b)]((_0x5d032e,_0x206a9d)=>{var _0x5bab11=_0x1a0d3d;_0x4b3b1c[_0x206a9d][_0x5bab11(0x114)]=_0x5d032e;}),_0x4e4d29[_0x1a0d3d(0x12b)]((_0x2c42aa,_0x4c6b99)=>{var _0x376563=_0x1a0d3d;_0x4b3b1c[_0x4c6b99][_0x376563(0xe5)]=_0x2c42aa;});const _0x2a7b65=_0x519c18[_0x1a0d3d(0x1db)](_0x17bac6=>{return _0x17bac6={'room_name':_0x17bac6};}),_0x36e35a=_0x4b3b1c[_0x1a0d3d(0x1c7)](_0x2ccd4d=>_0x2ccd4d[_0x1a0d3d(0x15b)]!=='0'&&_0x2ccd4d[_0x1a0d3d(0x15b)]!==''),_0x4c0f94=new purchases({'invoice':_0x5df199,'suppliers':_0x4221f3['body'][_0x1a0d3d(0x118)],'date':_0x2e88b3,'warehouse_name':_0x278a62,'product':_0x36e35a,'note':_0x38731e,'due_amount':_0x4aba04,'POnumber':_0x5afa69,'SCRN':_0x596f26,'JO_number':_0x46f72c,'roomList':_0x2a7b65}),_0xae32e9=await _0x4c0f94[_0x1a0d3d(0x1ba)](),_0x5869f4=await purchases[_0x1a0d3d(0x128)]({'invoice':_0x5df199}),_0x4b49c0=_0x5869f4['product']['map'](async _0x34dd57=>{var _0x5aca96=_0x1a0d3d,_0x5ca057=await warehouse[_0x5aca96(0x128)]({'name':_0x278a62,'room':_0x34dd57[_0x5aca96(0x13e)]}),_0x485bc3=0x0;return _0x5ca057[_0x5aca96(0x139)]['forEach'](_0x161957=>{var _0x3dfe16=_0x5aca96;_0x161957[_0x3dfe16(0x1bc)]==_0x34dd57[_0x3dfe16(0x1bc)]&&_0x161957[_0x3dfe16(0x17d)]==_0x34dd57['floorlevel']&&_0x161957[_0x3dfe16(0x1a8)]==_0x34dd57[_0x3dfe16(0x1a8)]&&_0x161957[_0x3dfe16(0x170)]==_0x34dd57[_0x3dfe16(0x170)]&&_0x161957['bay']==_0x34dd57[_0x3dfe16(0x182)]&&_0x161957[_0x3dfe16(0x12f)]==_0x34dd57[_0x3dfe16(0x12f)]&&_0x161957[_0x3dfe16(0x1f1)]==_0x34dd57[_0x3dfe16(0x1f1)]&&_0x161957['expiry_date']==_0x34dd57[_0x3dfe16(0x1b8)]&&_0x161957[_0x3dfe16(0x134)]==_0x34dd57[_0x3dfe16(0x134)]&&_0x161957['production_date']==_0x34dd57[_0x3dfe16(0x19d)]&&_0x161957['invoice']==_0x5869f4['invoice']&&(_0x161957['product_stock']+=Math['abs'](_0x34dd57[_0x3dfe16(0x15b)]),_0x485bc3++);}),_0x485bc3===0x0&&_0x5ca057[_0x5aca96(0x139)][_0x5aca96(0x1e6)]({'product_name':_0x34dd57['product_name'],'product_stock':Math['abs'](_0x34dd57[_0x5aca96(0x15b)]),'primary_code':_0x34dd57['primary_code'],'secondary_code':_0x34dd57['secondary_code'],'product_code':_0x34dd57['product_code'],'storage':_0x34dd57[_0x5aca96(0x1f1)],'rack':_0x34dd57[_0x5aca96(0x12f)],'bay':_0x34dd57[_0x5aca96(0x182)],'bin':_0x34dd57[_0x5aca96(0x170)],'type':_0x34dd57[_0x5aca96(0x1a8)],'floorlevel':_0x34dd57['floorlevel'],'maxProducts':_0x34dd57[_0x5aca96(0x145)],'unit':_0x34dd57['standard_unit'],'secondary_unit':_0x34dd57[_0x5aca96(0x202)],'expiry_date':_0x34dd57[_0x5aca96(0x1b8)],'maxPerUnit':_0x34dd57[_0x5aca96(0xec)],'batch_code':_0x34dd57[_0x5aca96(0x134)],'alertQTY':_0x34dd57['alertQTY'],'production_date':_0x34dd57[_0x5aca96(0x19d)],'product_cat':_0x34dd57[_0x5aca96(0x1e8)],'invoice':_0x34dd57[_0x5aca96(0xe5)],'actual_qty':Math[_0x5aca96(0x193)](_0x34dd57[_0x5aca96(0x147)]),'actual_uom':_0x34dd57[_0x5aca96(0x1a6)]}),_0x5ca057;});Promise[_0x1a0d3d(0x141)](_0x4b49c0)[_0x1a0d3d(0x186)](async _0x5352f6=>{var _0x1ccc8d=_0x1a0d3d;try{for(const _0x14c87c of _0x5352f6){await _0x14c87c[_0x1ccc8d(0x1ba)]();}const _0x1f07c5=await master_shop[_0x1ccc8d(0x1e3)](),_0x25ea57=await email_settings[_0x1ccc8d(0x128)](),_0x220240=await supervisor_settings[_0x1ccc8d(0x1e3)]();var _0x41f9f8=_0x5869f4[_0x1ccc8d(0x19a)],_0x21ea72='',_0x9dc565;for(_0x9dc565 in _0x41f9f8){_0x21ea72+='<tr>'+_0x1ccc8d(0x1d6)+_0x41f9f8[_0x9dc565]['product_name']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x41f9f8[_0x9dc565][_0x1ccc8d(0x1a4)]+_0x1ccc8d(0x129)+_0x1ccc8d(0x1d6)+_0x41f9f8[_0x9dc565][_0x1ccc8d(0x15b)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x41f9f8[_0x9dc565]['standard_unit']+_0x1ccc8d(0x129)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x41f9f8[_0x9dc565][_0x1ccc8d(0x202)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5869f4['warehouse_name']+_0x1ccc8d(0x129)+_0x1ccc8d(0x1d6)+_0x41f9f8[_0x9dc565][_0x1ccc8d(0x13e)]+_0x1ccc8d(0x129)+_0x1ccc8d(0x1d6)+_0x41f9f8[_0x9dc565][_0x1ccc8d(0x1f1)]+_0x41f9f8[_0x9dc565]['rack']+_0x41f9f8[_0x9dc565][_0x1ccc8d(0x182)]+_0x41f9f8[_0x9dc565]['bin']+_0x41f9f8[_0x9dc565]['type'][0x0]+_0x41f9f8[_0x9dc565][_0x1ccc8d(0x17d)]+_0x1ccc8d(0x129),_0x1ccc8d(0x203);}let _0x3235d1=nodemailer['createTransport']({'host':_0x25ea57['host'],'port':Number(_0x25ea57[_0x1ccc8d(0x14e)]),'secure':![],'auth':{'user':_0x25ea57[_0x1ccc8d(0x1d4)],'pass':_0x25ea57[_0x1ccc8d(0x1be)]}}),_0x49256d={'from':_0x25ea57[_0x1ccc8d(0x1d4)],'to':_0x220240[0x0][_0x1ccc8d(0x124)],'subject':_0x1ccc8d(0x176),'attachments':[{'filename':'Logo.png','path':__dirname+_0x1ccc8d(0x152)+_0x1ccc8d(0x14f)+_0x1f07c5[0x0][_0x1ccc8d(0x103)],'cid':_0x1ccc8d(0x117)}],'html':_0x1ccc8d(0x12c)+'<html><head><title></title>'+'</head><body>'+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x1ccc8d(0x1ab)+_0x1ccc8d(0x155)+_0x1ccc8d(0x149)+_0x1ccc8d(0x1ab)+_0x1ccc8d(0x10f)+_0x1f07c5[0x0]['site_title']+_0x1ccc8d(0x1b0)+_0x1ccc8d(0x149)+_0x1ccc8d(0x149)+'<hr\x20class=\x22my-3\x22>'+_0x1ccc8d(0x1ab)+_0x1ccc8d(0x138)+_0x1ccc8d(0x136)+_0x5869f4['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x1ccc8d(0x10d)+_0x5869f4[_0x1ccc8d(0x1ed)]+'\x20'+'</span>'+_0x1ccc8d(0x112)+_0x1ccc8d(0x149)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1ccc8d(0x1a5)+_0x1ccc8d(0x1f3)+_0x1ccc8d(0x168)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x1ccc8d(0x11b)+_0x1ccc8d(0x19b)+_0x1ccc8d(0x1e2)+_0x1ccc8d(0x107)+_0x1ccc8d(0x167)+_0x1ccc8d(0x1ef)+_0x1ccc8d(0x203)+'</thead>'+_0x1ccc8d(0x1b3)+'\x20'+_0x21ea72+'\x20'+_0x1ccc8d(0x11e)+'</table>'+_0x1ccc8d(0x1ab)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x1f07c5[0x0][_0x1ccc8d(0x1d2)]+_0x1ccc8d(0x112)+_0x1ccc8d(0x149)+_0x1ccc8d(0x149)+_0x1ccc8d(0x13b)};_0x3235d1[_0x1ccc8d(0xf7)](_0x49256d,function(_0x1aae45,_0x8fcbd7){var _0x27d69f=_0x1ccc8d;_0x1aae45?(console['log'](_0x1aae45),console[_0x27d69f(0x125)]('Error\x20Occurs')):console[_0x27d69f(0x125)](_0x27d69f(0x16c));}),_0x4221f3[_0x1ccc8d(0x15f)](_0x1ccc8d(0x1c2),_0x1ccc8d(0x11a)),_0x42fe1b[_0x1ccc8d(0x1ce)](_0x1ccc8d(0x1f2));}catch(_0x5d9df4){console[_0x1ccc8d(0x126)](_0x5d9df4),_0x42fe1b[_0x1ccc8d(0x160)](0x1f4)[_0x1ccc8d(0x1c8)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x1a0d3d(0x1bd)](_0x371242=>{var _0x5e2c2d=_0x1a0d3d;console[_0x5e2c2d(0x126)](_0x371242),_0x42fe1b[_0x5e2c2d(0x160)](0x1f4)[_0x5e2c2d(0x1c8)]({'error':_0x5e2c2d(0x1df)});});}catch(_0x18c4d1){console[_0x1a0d3d(0x125)](_0x18c4d1);}}),router['get'](a0_0x471c87(0x198),auth,async(_0x4547ca,_0x19c6b6)=>{var _0x18aa25=a0_0x471c87;try{const {username:_0x3594b8,email:_0x563a41,role:_0x45b374}=_0x4547ca['user'],_0x5ebeee=_0x4547ca['user'],_0x528edf=await profile[_0x18aa25(0x128)]({'email':_0x5ebeee[_0x18aa25(0x1d4)]}),_0x3ee2d6=await master_shop['find'](),_0x5e9ea7=_0x4547ca[_0x18aa25(0x1f0)]['id'],_0x3e53bc=await purchases[_0x18aa25(0x1a9)](_0x5e9ea7),_0x5d0c01=await warehouse[_0x18aa25(0x1d9)]([{'$match':{'name':_0x3e53bc[_0x18aa25(0x130)],'room':_0x3e53bc[_0x18aa25(0x132)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x18aa25(0x144),'name':{'$first':_0x18aa25(0x159)},'product_stock':{'$first':_0x18aa25(0x196)},'bay':{'$first':_0x18aa25(0x18c)},'bin':{'$first':_0x18aa25(0xfb)},'type':{'$first':_0x18aa25(0x1b2)},'floorlevel':{'$first':_0x18aa25(0x12e)},'primary_code':{'$first':_0x18aa25(0x106)},'secondary_code':{'$first':_0x18aa25(0x120)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x18aa25(0x1f9)},'rack':{'$first':_0x18aa25(0xfc)},'expiry_date':{'$first':_0x18aa25(0x187)}}}]),_0x3d6174=await customer[_0x18aa25(0x1e3)]({});let _0x7ac4dd;if(_0x5ebeee['role']==_0x18aa25(0xee)){const _0x36e206=await staff[_0x18aa25(0x128)]({'email':_0x5ebeee[_0x18aa25(0x1d4)]});_0x7ac4dd=await warehouse[_0x18aa25(0x1d9)]([{'$match':{'status':_0x18aa25(0xed),'name':_0x36e206[_0x18aa25(0x14b)]}},{'$group':{'_id':'$name','name':{'$first':_0x18aa25(0x16f)}}}]);}else _0x7ac4dd=await warehouse[_0x18aa25(0x1d9)]([{'$match':{'status':_0x18aa25(0xed)}},{'$group':{'_id':_0x18aa25(0x16f),'name':{'$first':_0x18aa25(0x16f)}}}]);const _0x5932b3=await product[_0x18aa25(0x1e3)]({}),_0xab694c=await suppliers[_0x18aa25(0x1e3)]({}),_0x2e3a8e=BayBinSelected(_0x3e53bc[_0x18aa25(0x130)],_0x3e53bc['room']);if(_0x3ee2d6[0x0][_0x18aa25(0x19f)]=='English\x20(US)'){var _0x29f742=users[_0x18aa25(0x183)];console[_0x18aa25(0x125)](_0x29f742);}else{if(_0x3ee2d6[0x0][_0x18aa25(0x19f)]==_0x18aa25(0x113))var _0x29f742=users['Hindi'];else{if(_0x3ee2d6[0x0][_0x18aa25(0x19f)]=='German')var _0x29f742=users[_0x18aa25(0x1d7)];else{if(_0x3ee2d6[0x0][_0x18aa25(0x19f)]=='Spanish')var _0x29f742=users[_0x18aa25(0xe9)];else{if(_0x3ee2d6[0x0]['language']==_0x18aa25(0x1bb))var _0x29f742=users['French'];else{if(_0x3ee2d6[0x0]['language']==_0x18aa25(0xf1))var _0x29f742=users[_0x18aa25(0x137)];else{if(_0x3ee2d6[0x0][_0x18aa25(0x19f)]==_0x18aa25(0x17b))var _0x29f742=users[_0x18aa25(0x17b)];else{if(_0x3ee2d6[0x0][_0x18aa25(0x19f)]==_0x18aa25(0x1b1))var _0x29f742=users[_0x18aa25(0x162)];}}}}}}}_0x19c6b6[_0x18aa25(0x101)]('edit_purchases_view',{'success':_0x4547ca[_0x18aa25(0x15f)]('success'),'errors':_0x4547ca[_0x18aa25(0x15f)](_0x18aa25(0xf5)),'role':_0x5ebeee,'profile':_0x528edf,'customer':_0x3d6174,'warehouse':_0x7ac4dd,'product':_0x5d0c01,'user':_0x3e53bc,'master_shop':_0x3ee2d6,'unit':_0x5932b3,'language':_0x29f742,'suppliers':_0xab694c,'dataSelected':_0x2e3a8e});}catch(_0x42bc10){console[_0x18aa25(0x125)](_0x42bc10);}}),router[a0_0x471c87(0x104)]('/preview/:id',auth,async(_0x42b8bf,_0x47ceb6)=>{var _0x2cd28c=a0_0x471c87;try{const _0x457f69=_0x42b8bf[_0x2cd28c(0x1f0)]['id'],{invoice:_0x1c4a03,warehouse_name:_0x4eab47,Room_name:_0x5b0c3a}=_0x42b8bf[_0x2cd28c(0x10b)],_0x35c5ff=await warehouse[_0x2cd28c(0x128)]({'name':_0x4eab47,'room':_0x5b0c3a}),_0x4b343=await purchases[_0x2cd28c(0x128)]({'invoice':_0x1c4a03});_0x4b343[_0x2cd28c(0x19a)][_0x2cd28c(0x12b)](_0x5d1cf6=>{var _0x17b6e7=_0x2cd28c,_0x206b06=0x0;const _0x1cdd3c=_0x35c5ff['product_details'][_0x17b6e7(0x1db)](_0x58ddba=>{var _0x15473e=_0x17b6e7;_0x58ddba[_0x15473e(0x1bc)]==_0x5d1cf6[_0x15473e(0x1bc)]&&_0x58ddba['floorlevel']==_0x5d1cf6[_0x15473e(0x17d)]&&_0x58ddba[_0x15473e(0x1a8)]==_0x5d1cf6[_0x15473e(0x1a8)]&&_0x58ddba['bin']==_0x5d1cf6[_0x15473e(0x170)]&&_0x58ddba[_0x15473e(0x182)]==_0x5d1cf6['bay']&&_0x58ddba[_0x15473e(0x12f)]==_0x5d1cf6['rack']&&_0x58ddba[_0x15473e(0x1f1)]==_0x5d1cf6[_0x15473e(0x1f1)]&&_0x58ddba[_0x15473e(0x1b8)]==_0x5d1cf6[_0x15473e(0x1b8)]&&_0x58ddba['batch_code']==_0x5d1cf6[_0x15473e(0x134)]&&_0x58ddba[_0x15473e(0x19d)]==_0x5d1cf6[_0x15473e(0x19d)]&&_0x58ddba[_0x15473e(0x10e)]==_0x5d1cf6[_0x15473e(0x10e)]&&_0x58ddba['delivery_code']==_0x5d1cf6['delivery_code']&&(_0x58ddba[_0x15473e(0x19c)]=parseInt(_0x58ddba['product_stock'])+parseInt(_0x5d1cf6[_0x15473e(0x15b)]),_0x206b06++);});_0x206b06=='0'&&(_0x35c5ff[_0x17b6e7(0x139)]=_0x35c5ff[_0x17b6e7(0x139)][_0x17b6e7(0x1dd)]({'product_name':_0x5d1cf6['product_name'],'product_stock':_0x5d1cf6['quantity'],'primary_code':_0x5d1cf6[_0x17b6e7(0x1fd)],'secondary_code':_0x5d1cf6['secondary_code'],'product_code':_0x5d1cf6[_0x17b6e7(0x1a4)],'storage':_0x5d1cf6[_0x17b6e7(0x1f1)],'rack':_0x5d1cf6[_0x17b6e7(0x12f)],'bay':_0x5d1cf6[_0x17b6e7(0x182)],'bin':_0x5d1cf6[_0x17b6e7(0x170)],'type':_0x5d1cf6[_0x17b6e7(0x1a8)],'floorlevel':_0x5d1cf6[_0x17b6e7(0x17d)],'maxProducts':_0x5d1cf6[_0x17b6e7(0x145)],'unit':_0x5d1cf6[_0x17b6e7(0x177)],'secondary_unit':_0x5d1cf6[_0x17b6e7(0x202)],'expiry_date':_0x5d1cf6[_0x17b6e7(0x1b8)],'maxPerUnit':_0x5d1cf6['maxperunit'],'batch_code':_0x5d1cf6[_0x17b6e7(0x134)],'alertQTY':_0x5d1cf6[_0x17b6e7(0x1b6)],'production_date':_0x5d1cf6[_0x17b6e7(0x19d)],'delivery_date':_0x5d1cf6[_0x17b6e7(0x10e)],'delivery_code':_0x5d1cf6[_0x17b6e7(0x114)]}));}),await _0x35c5ff['save'](),_0x4b343['finalize']='True';const _0x48d80a=await _0x4b343[_0x2cd28c(0x1ba)]();_0x42b8bf['flash'](_0x2cd28c(0x1c2),_0x2cd28c(0xea)),_0x47ceb6['redirect'](_0x2cd28c(0x13d));}catch(_0x38f7b8){console[_0x2cd28c(0x125)](_0x38f7b8);}}),router['get'](a0_0x471c87(0x1c0),auth,async(_0xa43ed7,_0xce3f9f)=>{var _0x20821f=a0_0x471c87;try{const {username:_0x1b769f,email:_0x10afa8,role:_0x398331}=_0xa43ed7[_0x20821f(0x13f)],_0x32d909=_0xa43ed7[_0x20821f(0x13f)],_0x531395=await profile[_0x20821f(0x128)]({'email':_0x32d909[_0x20821f(0x1d4)]}),_0x46626d=await master_shop[_0x20821f(0x1e3)](),_0x232a51=_0xa43ed7[_0x20821f(0x1f0)]['id'],_0x155370=await purchases['findById'](_0x232a51),_0x5f1b16=await suppliers['find']({});let _0x154e9a;if(_0x32d909[_0x20821f(0x1f6)]==_0x20821f(0xee)){const _0x67bbcf=await staff[_0x20821f(0x128)]({'email':_0x32d909['email']});_0x154e9a=await warehouse[_0x20821f(0x1e3)]({'status':_0x20821f(0xed),'name':_0x67bbcf[_0x20821f(0x14b)],'warehouse_category':_0x20821f(0xe6)});}else _0x154e9a=await warehouse[_0x20821f(0x1d9)]([{'$match':{'status':_0x20821f(0xed),'warehouse_category':_0x20821f(0xe6)}},{'$group':{'_id':_0x20821f(0x16f),'name':{'$first':_0x20821f(0x16f)}}}]);const _0x2516f3=await product[_0x20821f(0x1e3)]({}),_0x1c432c=BayBinSelected(_0x155370['warehouse_name'],_0x155370[_0x20821f(0x132)]);let _0x148fb6=new Date(_0x155370['expiry_date']),_0x41266d=('0'+_0x148fb6['getDate']())[_0x20821f(0xf2)](-0x2),_0x466b4c=('0'+(_0x148fb6[_0x20821f(0xe7)]()+0x1))[_0x20821f(0xf2)](-0x2),_0x2ab094=_0x148fb6[_0x20821f(0xe4)](),_0x38905c=_0x2ab094+'-'+_0x466b4c+'-'+_0x41266d;if(_0x46626d[0x0]['language']==_0x20821f(0x18f)){var _0x51068e=users[_0x20821f(0x183)];console[_0x20821f(0x125)](_0x51068e);}else{if(_0x46626d[0x0]['language']==_0x20821f(0x113))var _0x51068e=users[_0x20821f(0x113)];else{if(_0x46626d[0x0][_0x20821f(0x19f)]=='German')var _0x51068e=users['German'];else{if(_0x46626d[0x0][_0x20821f(0x19f)]=='Spanish')var _0x51068e=users[_0x20821f(0xe9)];else{if(_0x46626d[0x0][_0x20821f(0x19f)]==_0x20821f(0x1bb))var _0x51068e=users[_0x20821f(0x1bb)];else{if(_0x46626d[0x0][_0x20821f(0x19f)]==_0x20821f(0xf1))var _0x51068e=users[_0x20821f(0x137)];else{if(_0x46626d[0x0][_0x20821f(0x19f)]=='Chinese')var _0x51068e=users['Chinese'];else{if(_0x46626d[0x0][_0x20821f(0x19f)]==_0x20821f(0x1b1))var _0x51068e=users[_0x20821f(0x162)];}}}}}}}_0xce3f9f[_0x20821f(0x101)](_0x20821f(0x1ae),{'success':_0xa43ed7[_0x20821f(0x15f)]('success'),'errors':_0xa43ed7[_0x20821f(0x15f)](_0x20821f(0xf5)),'role':_0x32d909,'profile':_0x531395,'purchases':_0x155370,'suppliers':_0x5f1b16,'warehouse':_0x154e9a,'product':_0x2516f3,'master_shop':_0x46626d,'language':_0x51068e,'ed_fullDate':_0x38905c,'dataSelected':_0x1c432c});}catch(_0xaeb106){console[_0x20821f(0x125)](_0xaeb106);}}),router[a0_0x471c87(0x104)](a0_0x471c87(0x1c0),auth,async(_0x286f4a,_0x5b5549)=>{var _0x50e441=a0_0x471c87;try{const _0x2b39f2=_0x286f4a['params']['id'],_0x17da1a=await purchases[_0x50e441(0x128)]({'_id':_0x286f4a[_0x50e441(0x1f0)]['id']}),_0x18d19c=await warehouse[_0x50e441(0x128)]({'name':_0x17da1a[_0x50e441(0x130)],'room':_0x17da1a[_0x50e441(0x132)]});_0x17da1a[_0x50e441(0x19a)][_0x50e441(0x12b)](_0x43cfff=>{var _0x4b6845=_0x50e441;const _0x239eea=_0x18d19c[_0x4b6845(0x139)]['map'](_0x5cd978=>{var _0x458664=_0x4b6845;_0x5cd978['product_name']==_0x43cfff[_0x458664(0x1bc)]&&_0x5cd978[_0x458664(0x17d)]==_0x43cfff[_0x458664(0x17d)]&&_0x5cd978[_0x458664(0x1a8)]==_0x43cfff['type']&&_0x5cd978[_0x458664(0x170)]==_0x43cfff[_0x458664(0x170)]&&_0x5cd978[_0x458664(0x182)]==_0x43cfff['bay']&&_0x5cd978[_0x458664(0x12f)]==_0x43cfff[_0x458664(0x12f)]&&_0x5cd978[_0x458664(0x1f1)]==_0x43cfff[_0x458664(0x1f1)]&&(_0x5cd978[_0x458664(0x19c)]=parseInt(_0x5cd978[_0x458664(0x19c)])-parseInt(_0x43cfff[_0x458664(0x15b)]));});}),await _0x18d19c[_0x50e441(0x1ba)]();const {invoice:_0xb2add6,suppliers:_0x38234e,date:_0x3a807d,warehouse_name:_0x2323cb,prod_name:_0x3c6a4e,prod_code:_0x24d653,prod_qty:_0x51bf6a,prod_unit:_0x48de99,prod_secondunit:_0x54ad6e,prod_level:_0x3f4af9,prod_isle:_0x1a177b,prod_pallet:_0xbc9a6c,note:_0x5b18d5,expiry_date:_0xbee091,batch_code:_0x3c890e,paid_amount:_0xb6e03d,due_amount:_0x209d09,Room_name:_0x14cf5b,primary_code:_0x447f12,secondary_code:_0x188d20,PO_number:_0x2e6c16,JO_number:_0xf25f59}=_0x286f4a[_0x50e441(0x10b)];if(typeof _0x3c6a4e==_0x50e441(0x151))var _0x33cf30=[_0x286f4a['body']['prod_name']],_0x5d4176=[_0x286f4a['body']['prod_code']],_0x2be041=[_0x286f4a[_0x50e441(0x10b)][_0x50e441(0x1c4)]],_0x1f6a76=[_0x286f4a[_0x50e441(0x10b)]['prod_unit']],_0x27e425=[_0x286f4a[_0x50e441(0x10b)][_0x50e441(0x143)]],_0x4423f1=[_0x286f4a[_0x50e441(0x10b)]['prod_level']],_0x4fcf9b=[_0x286f4a[_0x50e441(0x10b)][_0x50e441(0x1aa)]],_0x205746=[_0x286f4a[_0x50e441(0x10b)]['prod_pallet']],_0x2de2de=[_0x286f4a['body'][_0x50e441(0x1fd)]],_0x38e52a=[_0x286f4a['body'][_0x50e441(0x1cf)]],_0x1b1f71=[_0x286f4a[_0x50e441(0x10b)]['MaxStocks_data']],_0x4f6c71=[_0x286f4a['body'][_0x50e441(0x134)]],_0x2f70d0=[_0x286f4a['body'][_0x50e441(0x1b8)]],_0x557f40=[_0x286f4a[_0x50e441(0x10b)]['storage']],_0x5c6344=[_0x286f4a[_0x50e441(0x10b)][_0x50e441(0x180)]],_0x3613f1=[_0x286f4a[_0x50e441(0x10b)][_0x50e441(0x1a8)]];else var _0x33cf30=[..._0x286f4a[_0x50e441(0x10b)][_0x50e441(0x140)]],_0x5d4176=[..._0x286f4a[_0x50e441(0x10b)]['prod_code']],_0x2be041=[..._0x286f4a[_0x50e441(0x10b)][_0x50e441(0x1c4)]],_0x1f6a76=[..._0x286f4a[_0x50e441(0x10b)][_0x50e441(0x1cc)]],_0x27e425=[..._0x286f4a[_0x50e441(0x10b)][_0x50e441(0x143)]],_0x4423f1=[..._0x286f4a['body'][_0x50e441(0x194)]],_0x4fcf9b=[..._0x286f4a[_0x50e441(0x10b)]['prod_isle']],_0x205746=[..._0x286f4a[_0x50e441(0x10b)]['prod_pallet']],_0x2de2de=[..._0x286f4a['body'][_0x50e441(0x1fd)]],_0x38e52a=[..._0x286f4a[_0x50e441(0x10b)]['secondary_code']],_0x1b1f71=[..._0x286f4a[_0x50e441(0x10b)]['MaxStocks_data']],_0x4f6c71=[..._0x286f4a[_0x50e441(0x10b)][_0x50e441(0x134)]],_0x2f70d0=[..._0x286f4a['body'][_0x50e441(0x1b8)]],_0x557f40=[..._0x286f4a[_0x50e441(0x10b)][_0x50e441(0x1f1)]],_0x5c6344=[..._0x286f4a[_0x50e441(0x10b)][_0x50e441(0x180)]],_0x3613f1=[..._0x286f4a[_0x50e441(0x10b)][_0x50e441(0x1a8)]];const _0x3868da=_0x33cf30['map'](_0x5446f7=>{return _0x5446f7={'product_name':_0x5446f7};});_0x5d4176[_0x50e441(0x12b)]((_0x3c14a9,_0x50dd0a)=>{var _0x3b708d=_0x50e441;_0x3868da[_0x50dd0a][_0x3b708d(0x1a4)]=_0x3c14a9;}),_0x2be041[_0x50e441(0x12b)]((_0x5bf20a,_0x3b18dc)=>{var _0x214dac=_0x50e441;_0x3868da[_0x3b18dc][_0x214dac(0x15b)]=_0x5bf20a;}),_0x1f6a76[_0x50e441(0x12b)]((_0x585c00,_0x3e556c)=>{var _0x1dd885=_0x50e441;_0x3868da[_0x3e556c][_0x1dd885(0x177)]=_0x585c00;}),_0x27e425['forEach']((_0x963d91,_0x592379)=>{_0x3868da[_0x592379]['secondary_unit']=_0x963d91;}),_0x4423f1[_0x50e441(0x12b)]((_0x2ccf1e,_0x1c3eb3)=>{_0x3868da[_0x1c3eb3]['bay']=_0x2ccf1e;}),_0x4fcf9b['forEach']((_0x167694,_0x50f7ce)=>{_0x3868da[_0x50f7ce]['bin']=_0x167694;}),_0x205746[_0x50e441(0x12b)]((_0xc42aca,_0x4a597c)=>{var _0x36ef74=_0x50e441;_0x3868da[_0x4a597c][_0x36ef74(0x17d)]=_0xc42aca;}),_0x2de2de[_0x50e441(0x12b)]((_0x755cd7,_0x58b1fe)=>{var _0x5af775=_0x50e441;_0x3868da[_0x58b1fe][_0x5af775(0x1fd)]=_0x755cd7;}),_0x38e52a[_0x50e441(0x12b)]((_0x24bfef,_0xe5851d)=>{var _0x114f3c=_0x50e441;_0x3868da[_0xe5851d][_0x114f3c(0x1cf)]=_0x24bfef;}),_0x1b1f71[_0x50e441(0x12b)]((_0x11fd81,_0x4904e6)=>{_0x3868da[_0x4904e6]['maxStocks']=_0x11fd81;}),_0x4f6c71[_0x50e441(0x12b)]((_0x3c84ea,_0x55e6b7)=>{var _0x1a9087=_0x50e441;_0x3868da[_0x55e6b7][_0x1a9087(0x134)]=_0x3c84ea;}),_0x2f70d0[_0x50e441(0x12b)]((_0x47b3f8,_0x7b8766)=>{_0x3868da[_0x7b8766]['expiry_date']=_0x47b3f8;}),_0x3613f1[_0x50e441(0x12b)]((_0x361360,_0x106d79)=>{var _0x473cf8=_0x50e441;_0x3868da[_0x106d79][_0x473cf8(0x1a8)]=_0x361360;}),_0x557f40[_0x50e441(0x12b)]((_0x19126a,_0x384b32)=>{var _0x2b4855=_0x50e441;_0x3868da[_0x384b32][_0x2b4855(0x1f1)]=_0x19126a;}),_0x5c6344[_0x50e441(0x12b)]((_0x5f0710,_0x52d638)=>{var _0x35d94c=_0x50e441;_0x3868da[_0x52d638][_0x35d94c(0x12f)]=_0x5f0710;});const _0x10e99b=_0x3868da['filter'](_0x4bcc0e=>_0x4bcc0e['quantity']!=='0'&&_0x4bcc0e[_0x50e441(0x15b)]!=='');_0x17da1a[_0x50e441(0xe5)]=_0xb2add6,_0x17da1a['suppliers']=_0x38234e,_0x17da1a['date']=_0x3a807d,_0x17da1a[_0x50e441(0x130)]=_0x2323cb,_0x17da1a[_0x50e441(0x19a)]=_0x10e99b,_0x17da1a[_0x50e441(0x102)]=_0x5b18d5,_0x17da1a[_0x50e441(0x1ea)]=_0xb6e03d,_0x17da1a['due_amount']=_0x209d09,_0x17da1a[_0x50e441(0x132)]=_0x14cf5b,_0x17da1a['POnumber']=_0x2e6c16,_0x17da1a['JO_number']=_0xf25f59;const _0x371bad=await _0x17da1a[_0x50e441(0x1ba)](),_0x18a27c=await warehouse[_0x50e441(0x128)]({'name':_0x286f4a['body'][_0x50e441(0x130)],'room':_0x286f4a[_0x50e441(0x10b)][_0x50e441(0x18b)]});_0x17da1a[_0x50e441(0x19a)][_0x50e441(0x12b)](_0x2c7089=>{var _0x1ff4ee=_0x50e441,_0x54ab21=0x0;const _0x51b7eb=_0x18a27c[_0x1ff4ee(0x139)][_0x1ff4ee(0x1db)](_0x2c0950=>{var _0x3dbd09=_0x1ff4ee;_0x2c0950['product_name']==_0x2c7089[_0x3dbd09(0x1bc)]&&_0x2c0950[_0x3dbd09(0x17d)]==_0x2c7089[_0x3dbd09(0x17d)]&&_0x2c0950[_0x3dbd09(0x1a8)]==_0x2c7089[_0x3dbd09(0x1a8)]&&_0x2c0950[_0x3dbd09(0x170)]==_0x2c7089[_0x3dbd09(0x170)]&&_0x2c0950[_0x3dbd09(0x182)]==_0x2c7089[_0x3dbd09(0x182)]&&_0x2c0950[_0x3dbd09(0x12f)]==_0x2c7089[_0x3dbd09(0x12f)]&&_0x2c0950[_0x3dbd09(0x1f1)]==_0x2c7089[_0x3dbd09(0x1f1)]&&(_0x2c0950[_0x3dbd09(0x19c)]=parseInt(_0x2c0950['product_stock'])+parseInt(_0x2c7089[_0x3dbd09(0x15b)]),_0x54ab21++);});_0x54ab21=='0'&&(_0x18a27c[_0x1ff4ee(0x139)]=_0x18a27c[_0x1ff4ee(0x139)][_0x1ff4ee(0x1dd)]({'product_name':_0x2c7089[_0x1ff4ee(0x1bc)],'product_stock':_0x2c7089[_0x1ff4ee(0x15b)],'primary_code':_0x2c7089['primary_code'],'secondary_code':_0x2c7089[_0x1ff4ee(0x1cf)],'product_code':_0x2c7089['product_code'],'storage':_0x2c7089[_0x1ff4ee(0x1f1)],'rack':_0x2c7089[_0x1ff4ee(0x12f)],'bay':_0x2c7089['bay'],'bin':_0x2c7089[_0x1ff4ee(0x170)],'type':_0x2c7089[_0x1ff4ee(0x1a8)],'floorlevel':_0x2c7089[_0x1ff4ee(0x17d)],'maxProducts':_0x2c7089[_0x1ff4ee(0x145)],'unit':_0x2c7089[_0x1ff4ee(0x177)],'secondary_unit':_0x2c7089[_0x1ff4ee(0x202)],'expiry_date':_0x2c7089[_0x1ff4ee(0x1b8)]}));}),await _0x18a27c['save']();const _0x31963f=await s_payment_data['findOne']({'invoice':_0x286f4a[_0x50e441(0x10b)][_0x50e441(0xe5)]});if(_0x31963f===null){}else console[_0x50e441(0x125)](_0x50e441(0x118),_0x31963f,_0x286f4a[_0x50e441(0x10b)][_0x50e441(0xe5)]),_0x31963f[_0x50e441(0x118)]=_0x286f4a[_0x50e441(0x10b)]['suppliers'],await _0x31963f[_0x50e441(0x1ba)]();_0x286f4a[_0x50e441(0x15f)](_0x50e441(0x1c2),'purchase\x20data\x20update\x20successfully'),_0x5b5549[_0x50e441(0x1ce)](_0x50e441(0x13d));}catch(_0x565f4a){console[_0x50e441(0x125)](_0x565f4a);}}),router['post']('/give_payment/:id',auth,async(_0x45dbf2,_0x52f8d1)=>{var _0xa5e074=a0_0x471c87;try{const _0x5696ee=_0x45dbf2['params']['id'],{invoice:_0x58b182,suppliers:_0x4fcc19,payable:_0x19e1a6,due_amount:_0x4ddaf7}=_0x45dbf2['body'],_0x137aff=await purchases[_0xa5e074(0x1a9)](_0x5696ee);var _0x46e935=_0x19e1a6-_0x4ddaf7;_0x137aff[_0xa5e074(0x1ea)]=parseFloat(_0x137aff[_0xa5e074(0x1ea)])+parseFloat(_0x4ddaf7),_0x137aff[_0xa5e074(0x1b4)]=_0x46e935;const _0xf62a8d=await _0x137aff['save']();console[_0xa5e074(0x125)](_0xf62a8d);const _0x176a4e=await s_payment_data[_0xa5e074(0x128)]({'invoice':_0x58b182});_0x176a4e[_0xa5e074(0x18e)]=_0x46e935,await _0x176a4e[_0xa5e074(0x1ba)]();let _0x2fa439=new Date(),_0x9a3ae0=('0'+_0x2fa439[_0xa5e074(0xf9)]())['slice'](-0x2),_0x1a5289=('0'+(_0x2fa439[_0xa5e074(0xe7)]()+0x1))['slice'](-0x2),_0x5399a6=_0x2fa439[_0xa5e074(0xe4)](),_0x385580=_0x5399a6+'-'+_0x1a5289+'-'+_0x9a3ae0;const _0x4efce7=new suppliers_payment({'invoice':_0x58b182,'date':_0x5399a6+'-'+_0x1a5289+'-'+_0x9a3ae0,'suppliers':_0x4fcc19,'reason':'Paid\x20For\x20Purchase','amount':_0x4ddaf7}),_0x181e2c=await _0x4efce7[_0xa5e074(0x1ba)]();_0x45dbf2[_0xa5e074(0x15f)](_0xa5e074(0x1c2),_0xa5e074(0x1c1)),_0x52f8d1[_0xa5e074(0x1ce)](_0xa5e074(0x13d));}catch(_0x2be04e){console[_0xa5e074(0x125)](_0x2be04e);}}),router[a0_0x471c87(0x17e)](a0_0x471c87(0x111),auth,async(_0x2fb29f,_0x5a0f8a)=>{var _0x126077=a0_0x471c87;try{const {username:_0x379fca,email:_0x2e72b5,role:_0x41734c}=_0x2fb29f[_0x126077(0x13f)],_0x3da550=_0x2fb29f[_0x126077(0x13f)],_0x5441fd=await profile[_0x126077(0x128)]({'email':_0x3da550['email']}),_0x474da2=await master_shop['find']();console[_0x126077(0x125)](_0x126077(0x1ac),_0x474da2);const _0x27e530=_0x2fb29f[_0x126077(0x1f0)]['id'],_0x4beb8f=await purchases['findById'](_0x27e530);console[_0x126077(0x125)](_0x4beb8f);const _0x1f08d1=await suppliers['findOne']({'name':_0x4beb8f['suppliers']});console[_0x126077(0x125)](_0x1f08d1);if(_0x474da2[0x0]['language']==_0x126077(0x18f)){var _0x32a5dc=users[_0x126077(0x183)];console['log'](_0x32a5dc);}else{if(_0x474da2[0x0][_0x126077(0x19f)]=='Hindi')var _0x32a5dc=users['Hindi'];else{if(_0x474da2[0x0][_0x126077(0x19f)]==_0x126077(0x1d7))var _0x32a5dc=users[_0x126077(0x1d7)];else{if(_0x474da2[0x0][_0x126077(0x19f)]=='Spanish')var _0x32a5dc=users[_0x126077(0xe9)];else{if(_0x474da2[0x0][_0x126077(0x19f)]==_0x126077(0x1bb))var _0x32a5dc=users[_0x126077(0x1bb)];else{if(_0x474da2[0x0][_0x126077(0x19f)]==_0x126077(0xf1))var _0x32a5dc=users[_0x126077(0x137)];else{if(_0x474da2[0x0]['language']==_0x126077(0x17b))var _0x32a5dc=users[_0x126077(0x17b)];else{if(_0x474da2[0x0][_0x126077(0x19f)]==_0x126077(0x1b1))var _0x32a5dc=users[_0x126077(0x162)];}}}}}}}_0x5a0f8a['render'](_0x126077(0x15a),{'success':_0x2fb29f[_0x126077(0x15f)]('success'),'errors':_0x2fb29f[_0x126077(0x15f)](_0x126077(0xf5)),'role':_0x3da550,'profile':_0x5441fd,'master_shop':_0x474da2,'supplier':_0x1f08d1,'purchase':_0x4beb8f,'language':_0x32a5dc});}catch(_0x5ae982){console[_0x126077(0x125)](_0x5ae982);}}),router[a0_0x471c87(0x17e)](a0_0x471c87(0x1cd),auth,async(_0xb73a1f,_0x43d741)=>{var _0x1c9f8d=a0_0x471c87;try{const {username:_0x4c6176,email:_0xf6e39d,role:_0xc5c5c8}=_0xb73a1f['user'],_0x1df0e2=_0xb73a1f[_0x1c9f8d(0x13f)],_0x97b4cf=await profile['findOne']({'email':_0x1df0e2[_0x1c9f8d(0x1d4)]}),_0x4c7b54=await master_shop[_0x1c9f8d(0x1e3)]();console['log'](_0x1c9f8d(0x1ac),_0x4c7b54);const _0x2304f8=_0xb73a1f['params']['id'];console[_0x1c9f8d(0x125)](_0x2304f8);const _0x3d89ea=await purchases['findById'](_0x2304f8);console[_0x1c9f8d(0x125)](_0x1c9f8d(0x1ee),_0x3d89ea);const _0x10b99b=await product['find']({}),_0xee1ec5=await warehouse[_0x1c9f8d(0x1d9)]([{'$match':{'name':_0x3d89ea['warehouse_name'],'room':_0x3d89ea[_0x1c9f8d(0x132)],'warehouse_category':_0x1c9f8d(0xe6)}},{'$unwind':_0x1c9f8d(0x105)},{'$group':{'_id':_0x1c9f8d(0x144),'name':{'$first':_0x1c9f8d(0x159)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1c9f8d(0x18c)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1c9f8d(0x1b2)},'floorlevel':{'$first':_0x1c9f8d(0x12e)},'primary_code':{'$first':_0x1c9f8d(0x106)},'secondary_code':{'$first':_0x1c9f8d(0x120)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]);warehouse_data=await warehouse[_0x1c9f8d(0x1d9)]([{'$match':{'status':'Enabled','name':'Return\x20Goods','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x1c9f8d(0x16f),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),console[_0x1c9f8d(0x125)](_0x1c9f8d(0x1ad),_0xee1ec5);if(_0x4c7b54[0x0][_0x1c9f8d(0x19f)]==_0x1c9f8d(0x18f)){var _0x2cd266=users[_0x1c9f8d(0x183)];console[_0x1c9f8d(0x125)](_0x2cd266);}else{if(_0x4c7b54[0x0][_0x1c9f8d(0x19f)]=='Hindi')var _0x2cd266=users['Hindi'];else{if(_0x4c7b54[0x0][_0x1c9f8d(0x19f)]=='German')var _0x2cd266=users[_0x1c9f8d(0x1d7)];else{if(_0x4c7b54[0x0][_0x1c9f8d(0x19f)]==_0x1c9f8d(0xe9))var _0x2cd266=users['Spanish'];else{if(_0x4c7b54[0x0]['language']=='French')var _0x2cd266=users[_0x1c9f8d(0x1bb)];else{if(_0x4c7b54[0x0][_0x1c9f8d(0x19f)]==_0x1c9f8d(0xf1))var _0x2cd266=users[_0x1c9f8d(0x137)];else{if(_0x4c7b54[0x0][_0x1c9f8d(0x19f)]==_0x1c9f8d(0x17b))var _0x2cd266=users[_0x1c9f8d(0x17b)];else{if(_0x4c7b54[0x0][_0x1c9f8d(0x19f)]==_0x1c9f8d(0x1b1))var _0x2cd266=users[_0x1c9f8d(0x162)];}}}}}}}_0x43d741['render'](_0x1c9f8d(0x14a),{'success':_0xb73a1f[_0x1c9f8d(0x15f)](_0x1c9f8d(0x1c2)),'errors':_0xb73a1f[_0x1c9f8d(0x15f)](_0x1c9f8d(0xf5)),'role':_0x1df0e2,'profile':_0x97b4cf,'user':_0x3d89ea,'stock':_0xee1ec5,'master_shop':_0x4c7b54,'product':_0x10b99b,'language':_0x2cd266,'warehouse':warehouse_data});}catch(_0x3bbfcf){console[_0x1c9f8d(0x125)](_0x3bbfcf);}}),router[a0_0x471c87(0x104)](a0_0x471c87(0x1cd),auth,async(_0x132639,_0x4a514b)=>{var _0x5d8e02=a0_0x471c87;try{const {invoice:_0x324e86,date:_0x22526a,warehouse_name:_0x48967a,Room_name:_0x5bb7d4,product_name:_0x5c433a,purchase_quantity:_0x345cf3,stocks:_0x16d109,return_qty:_0x680c7d,note:_0x4cb69d,level:_0x3de2e4,isle:_0x55cfcc,pallet:_0x17fb90,to_warehouse_name:_0x35feda,to_Room_name:_0xa318a4}=_0x132639[_0x5d8e02(0x10b)],_0x23e83e=await purchases[_0x5d8e02(0x128)]({'_id':_0x132639[_0x5d8e02(0x1f0)]['id']}),_0x11240f=await warehouse[_0x5d8e02(0x128)]({'name':_0x48967a,'room':_0x5bb7d4});if(typeof _0x5c433a==_0x5d8e02(0x151))var _0x4914e3=[_0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x1bc)]],_0x494566=[_0x132639['body'][_0x5d8e02(0xeb)]],_0x3d8c25=[_0x132639[_0x5d8e02(0x10b)]['stocks']],_0x55e629=[_0x132639['body']['return_qty']],_0x2df868=[_0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0xef)]],_0x53c8fb=[_0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x1af)]],_0x5e5baf=[_0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x171)]],_0x3dc6f6=[_0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x1b5)]],_0x918f13=[_0x132639[_0x5d8e02(0x10b)]['product_code_hide']],_0x13350b=[_0x132639['body'][_0x5d8e02(0x1f5)]],_0xbf5d84=[_0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x190)]];else var _0x4914e3=[..._0x132639['body']['product_name']],_0x494566=[..._0x132639['body']['purchase_quantity']],_0x3d8c25=[..._0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x1a0)]],_0x55e629=[..._0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x11d)]],_0x2df868=[..._0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0xef)]],_0x53c8fb=[..._0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x1af)]],_0x5e5baf=[..._0x132639['body'][_0x5d8e02(0x171)]],_0x3dc6f6=[..._0x132639['body'][_0x5d8e02(0x1b5)]],_0x918f13=[..._0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x16e)]],_0x13350b=[..._0x132639['body'][_0x5d8e02(0x1f5)]],_0xbf5d84=[..._0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x190)]];const _0x1c1ab0=_0x4914e3[_0x5d8e02(0x1db)](_0x38c20d=>{return _0x38c20d={'product_name':_0x38c20d};});_0x494566[_0x5d8e02(0x12b)]((_0x3e5ae1,_0x327427)=>{var _0x1ae63b=_0x5d8e02;_0x1c1ab0[_0x327427][_0x1ae63b(0xeb)]=_0x3e5ae1;}),_0x3d8c25['forEach']((_0x3cb2b2,_0x47a2ba)=>{_0x1c1ab0[_0x47a2ba]['stock_quantity']=_0x3cb2b2;}),_0x55e629[_0x5d8e02(0x12b)]((_0x862654,_0x103b67)=>{var _0x5b5c73=_0x5d8e02;_0x1c1ab0[_0x103b67][_0x5b5c73(0x11d)]=_0x862654;}),_0x2df868[_0x5d8e02(0x12b)]((_0x383bab,_0x5c36c7)=>{var _0x2390b3=_0x5d8e02;_0x1c1ab0[_0x5c36c7][_0x2390b3(0x182)]=_0x383bab;}),_0x53c8fb[_0x5d8e02(0x12b)]((_0x480aae,_0x47621b)=>{var _0x6d1a4f=_0x5d8e02;_0x1c1ab0[_0x47621b][_0x6d1a4f(0x170)]=_0x480aae;}),_0x5e5baf['forEach']((_0x3de0aa,_0x3137eb)=>{var _0x4ea8a9=_0x5d8e02;_0x1c1ab0[_0x3137eb][_0x4ea8a9(0x17d)]=_0x3de0aa;}),_0x3dc6f6[_0x5d8e02(0x12b)]((_0x4e31e0,_0x214b2c)=>{var _0x232b29=_0x5d8e02;_0x1c1ab0[_0x214b2c][_0x232b29(0x1a8)]=_0x4e31e0;}),_0x918f13['forEach']((_0x89834a,_0x12dd7b)=>{var _0x36d49a=_0x5d8e02;_0x1c1ab0[_0x12dd7b][_0x36d49a(0x1a4)]=_0x89834a;}),_0x13350b[_0x5d8e02(0x12b)]((_0x3f933c,_0x46a225)=>{var _0x4aab81=_0x5d8e02;_0x1c1ab0[_0x46a225][_0x4aab81(0x1fd)]=_0x3f933c;}),_0xbf5d84[_0x5d8e02(0x12b)]((_0x46c88d,_0x46a6f3)=>{var _0x61b48e=_0x5d8e02;_0x1c1ab0[_0x46a6f3][_0x61b48e(0x1cf)]=_0x46c88d;}),_0x23e83e[_0x5d8e02(0x19a)]['forEach'](_0x1b2e10=>{var _0x455b3e=_0x5d8e02;const _0x5e3904=_0x11240f[_0x455b3e(0x139)][_0x455b3e(0x1db)](_0x3a4499=>{var _0x1a57df=_0x455b3e;_0x3a4499[_0x1a57df(0x1bc)]==_0x1b2e10[_0x1a57df(0x1bc)]&&_0x3a4499[_0x1a57df(0x17d)]==_0x1b2e10[_0x1a57df(0x17d)]&&_0x3a4499[_0x1a57df(0x1a8)]==_0x1b2e10['type']&&_0x3a4499[_0x1a57df(0x170)]==_0x1b2e10['bin']&&_0x3a4499['bay']==_0x1b2e10[_0x1a57df(0x182)]&&_0x3a4499[_0x1a57df(0x12f)]==_0x1b2e10[_0x1a57df(0x12f)]&&_0x3a4499[_0x1a57df(0x1f1)]==_0x1b2e10[_0x1a57df(0x1f1)]&&(console[_0x1a57df(0x125)](parseInt(_0x3a4499[_0x1a57df(0x19c)])+_0x1a57df(0x1cb)+parseInt(_0x1b2e10['quantity'])),_0x3a4499['product_stock']=parseInt(_0x3a4499[_0x1a57df(0x19c)])+parseInt(_0x1b2e10[_0x1a57df(0x15b)]));});}),await _0x11240f['save']();const _0x4a12ef=_0x1c1ab0[_0x5d8e02(0x1c7)](_0x2b11d1=>_0x2b11d1[_0x5d8e02(0x11d)]!=='0'&&_0x2b11d1[_0x5d8e02(0x11d)]!=='');var _0x3b2b99=0x0;_0x4a12ef['forEach'](_0x26bec4=>{var _0x3d210f=_0x5d8e02;console['log'](_0x3d210f(0x14d),_0x26bec4),(parseInt(_0x26bec4['purchase_quantity'])<parseInt(_0x26bec4[_0x3d210f(0x11d)])||parseInt(_0x26bec4[_0x3d210f(0x161)])<parseInt(_0x26bec4['return_qty']))&&_0x3b2b99++;});if(_0x3b2b99!=0x0)return _0x132639[_0x5d8e02(0x15f)](_0x5d8e02(0xf5),_0x5d8e02(0x1fc)),_0x4a514b[_0x5d8e02(0x1ce)](_0x5d8e02(0x163));const _0x221b5f=new purchases_return({'invoice':_0x324e86,'suppliers':_0x132639[_0x5d8e02(0x10b)][_0x5d8e02(0x118)],'date':_0x22526a,'warehouse_name':_0x48967a,'return_product':_0x4a12ef,'note':_0x4cb69d,'room':_0x5bb7d4,'to_warehouse_name':_0x35feda,'to_room':_0xa318a4}),_0x1c9936=await _0x221b5f[_0x5d8e02(0x1ba)]();console[_0x5d8e02(0x125)](_0x221b5f);const _0x463a32=await purchases_return[_0x5d8e02(0x128)]({'invoice':_0x324e86}),_0x4d8977=await warehouse[_0x5d8e02(0x128)]({'name':_0x35feda,'room':_0xa318a4});_0x463a32['return_product'][_0x5d8e02(0x12b)](_0x54b13a=>{var _0x2136fa=_0x5d8e02,_0x4b86b3=0x0;const _0x28f63e=_0x4d8977[_0x2136fa(0x139)][_0x2136fa(0x1db)](_0x207528=>{var _0x664475=_0x2136fa;_0x207528['product_name']==_0x54b13a[_0x664475(0x1bc)]&&_0x207528[_0x664475(0x17d)]==_0x54b13a['floorlevel']&&_0x207528[_0x664475(0x1a8)]==_0x54b13a['type']&&_0x207528[_0x664475(0x170)]==_0x54b13a[_0x664475(0x170)]&&_0x207528['bay']==_0x54b13a[_0x664475(0x182)]&&(_0x207528[_0x664475(0x19c)]=parseInt(_0x207528[_0x664475(0x19c)])-parseInt(_0x54b13a[_0x664475(0x11d)]),_0x4b86b3++);});_0x4b86b3=='0'&&(_0x4d8977[_0x2136fa(0x139)]=_0x4d8977[_0x2136fa(0x139)][_0x2136fa(0x1dd)]({'product_name':_0x54b13a['product_name'],'product_stock':_0x54b13a['return_qty'],'primary_code':_0x54b13a[_0x2136fa(0x1fd)],'secondary_code':_0x54b13a[_0x2136fa(0x1cf)],'product_code':_0x54b13a[_0x2136fa(0x1a4)],'storage':_0x54b13a[_0x2136fa(0x1f1)],'rack':_0x54b13a['rack'],'bay':_0x54b13a[_0x2136fa(0x182)],'bin':_0x54b13a[_0x2136fa(0x170)],'type':_0x54b13a[_0x2136fa(0x1a8)],'floorlevel':_0x54b13a[_0x2136fa(0x17d)],'maxProducts':_0x54b13a[_0x2136fa(0x145)],'unit':_0x54b13a[_0x2136fa(0x177)],'secondary_unit':_0x54b13a[_0x2136fa(0x202)],'expiry_date':_0x54b13a[_0x2136fa(0x1b8)]}));}),await _0x4d8977[_0x5d8e02(0x1ba)]();const _0x38ca7a=await purchases[_0x5d8e02(0x128)]({'invoice':_0x324e86});_0x38ca7a[_0x5d8e02(0x15c)]=_0x5d8e02(0x1c3);const _0x482308=await _0x38ca7a[_0x5d8e02(0x1ba)](),_0x22cd7a=new s_payment_data({'invoice':_0x324e86,'suppliers':_0x132639['body'][_0x5d8e02(0x118)],'reason':_0x5d8e02(0x1c5)});await _0x22cd7a[_0x5d8e02(0x1ba)]();const _0x4008f0=await master_shop[_0x5d8e02(0x1e3)]();console[_0x5d8e02(0x125)](_0x5d8e02(0x164),_0x4008f0[0x0]['image']);const _0x5ac4a4=await email_settings[_0x5d8e02(0x128)](),_0x4acdb3=await suppliers['findOne']({'name':_0x132639['body'][_0x5d8e02(0x118)]});console[_0x5d8e02(0x125)]('suppliers_data',_0x4acdb3);_0x4008f0[0x0][_0x5d8e02(0x172)]==0x1?(right_currency=_0x4008f0[0x0][_0x5d8e02(0x1c6)],left_currency=''):(right_currency='',left_currency=_0x4008f0[0x0][_0x5d8e02(0x1c6)]);var _0x504f8f=_0x4914e3,_0x49e403=_0x55e629,_0xd67b7f='',_0x7eee3d;for(_0x7eee3d in _0x504f8f){_0xd67b7f+=_0x5d8e02(0x1f3)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x504f8f[_0x7eee3d]+_0x5d8e02(0x129)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x49e403[_0x7eee3d]+_0x5d8e02(0x129)+_0x5d8e02(0x203);}console[_0x5d8e02(0x125)](_0x5d8e02(0x135),_0xd67b7f);let _0xb11de5=nodemailer[_0x5d8e02(0xff)]({'service':_0x5d8e02(0xfa),'auth':{'user':_0x5ac4a4[_0x5d8e02(0x1d4)],'pass':_0x5ac4a4[_0x5d8e02(0x1be)]}}),_0x5c9403={'from':_0x5ac4a4[_0x5d8e02(0x1d4)],'to':_0x4acdb3[_0x5d8e02(0x1d4)],'subject':_0x5d8e02(0x185),'attachments':[{'filename':'Logo.png','path':__dirname+_0x5d8e02(0x152)+_0x5d8e02(0x14f)+_0x4008f0[0x0][_0x5d8e02(0x103)],'cid':_0x5d8e02(0x117)}],'html':_0x5d8e02(0x12c)+_0x5d8e02(0x154)+'</head><body>'+_0x5d8e02(0x1ab)+_0x5d8e02(0x157)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x5d8e02(0x1ab)+'<h2>\x20'+_0x4008f0[0x0][_0x5d8e02(0x1d2)]+'\x20</h2>'+_0x5d8e02(0x149)+_0x5d8e02(0x149)+_0x5d8e02(0x119)+_0x5d8e02(0x1ab)+_0x5d8e02(0x138)+'\x20Order\x20Number\x20:\x20'+_0x324e86+'\x20'+_0x5d8e02(0x18a)+_0x5d8e02(0x10d)+_0x22526a+'\x20'+_0x5d8e02(0x1d5)+_0x5d8e02(0x112)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5d8e02(0x1a5)+_0x5d8e02(0x1f3)+_0x5d8e02(0x168)+_0x5d8e02(0x178)+_0x5d8e02(0x181)+_0x5d8e02(0x1f7)+_0x5d8e02(0x203)+_0x5d8e02(0x1f4)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0xd67b7f+'\x20'+'</tbody>'+_0x5d8e02(0x1e1)+_0x5d8e02(0x1ab)+'<strong>\x20Regards\x20</strong>'+_0x5d8e02(0x1da)+_0x4008f0[0x0]['site_title']+'</h5>'+_0x5d8e02(0x149)+'</div>'+_0x5d8e02(0x13b)};_0xb11de5[_0x5d8e02(0xf7)](_0x5c9403,function(_0x1b682c,_0xc9b92){var _0x56e440=_0x5d8e02;_0x1b682c?(console[_0x56e440(0x125)](_0x1b682c),console[_0x56e440(0x125)](_0x56e440(0x100))):console[_0x56e440(0x125)]('Email\x20sent\x20successfully');}),_0x132639[_0x5d8e02(0x15f)](_0x5d8e02(0x1c2),'purchases\x20item\x20return\x20successfull'),_0x4a514b['redirect']('/all_purchases/view');}catch(_0x18695a){console[_0x5d8e02(0x125)](_0x18695a),_0x4a514b[_0x5d8e02(0x160)](0xc8)['json']({'message':_0x18695a['message']});}}),router['get'](a0_0x471c87(0x13a),auth,async(_0x1e6c7d,_0x338a1c)=>{var _0x59b282=a0_0x471c87;try{const {username:_0xa779a6,email:_0x19243c,role:_0x2847d8}=_0x1e6c7d['user'],_0x4ff5f1=_0x1e6c7d['user'],_0x350c8c=await profile[_0x59b282(0x128)]({'email':_0x4ff5f1[_0x59b282(0x1d4)]}),_0xcacccf=await master_shop[_0x59b282(0x1e3)](),_0x291736=_0x1e6c7d['params']['id'],_0xd06fde=await purchases[_0x59b282(0x1a9)](_0x291736);if(_0xcacccf[0x0][_0x59b282(0x19f)]==_0x59b282(0x18f))var _0xc306d9=users[_0x59b282(0x183)];else{if(_0xcacccf[0x0][_0x59b282(0x19f)]==_0x59b282(0x113))var _0xc306d9=users[_0x59b282(0x113)];else{if(_0xcacccf[0x0][_0x59b282(0x19f)]==_0x59b282(0x1d7))var _0xc306d9=users[_0x59b282(0x1d7)];else{if(_0xcacccf[0x0][_0x59b282(0x19f)]=='Spanish')var _0xc306d9=users[_0x59b282(0xe9)];else{if(_0xcacccf[0x0]['language']=='French')var _0xc306d9=users[_0x59b282(0x1bb)];else{if(_0xcacccf[0x0][_0x59b282(0x19f)]==_0x59b282(0xf1))var _0xc306d9=users[_0x59b282(0x137)];else{if(_0xcacccf[0x0][_0x59b282(0x19f)]=='Chinese')var _0xc306d9=users[_0x59b282(0x17b)];else{if(_0xcacccf[0x0]['language']=='Arabic\x20(ae)')var _0xc306d9=users['Arabic'];}}}}}}}_0x338a1c[_0x59b282(0x101)](_0x59b282(0x12a),{'success':_0x1e6c7d[_0x59b282(0x15f)](_0x59b282(0x1c2)),'errors':_0x1e6c7d['flash'](_0x59b282(0xf5)),'role':_0x4ff5f1,'profile':_0x350c8c,'alldata':_0xd06fde,'master_shop':_0xcacccf,'language':_0xc306d9}),console['log'](alldata);}catch(_0x38ce08){console[_0x59b282(0x125)](_0x38ce08);}}),router['post']('/barcode_scanner',async(_0x5f0c36,_0x1cd16d)=>{var _0x1eacb7=a0_0x471c87;const {product_code:_0x1a16ac}=_0x5f0c36[_0x1eacb7(0x10b)];var _0x67a28f;const _0x18ff54=await product[_0x1eacb7(0x1d9)]([{'$match':{'primary_code':_0x1a16ac,'product_category':'Raw\x20Materials'}},{'$group':{'_id':'$_id','name':{'$first':_0x1eacb7(0x16f)},'category':{'$first':_0x1eacb7(0x15d)},'brand':{'$first':_0x1eacb7(0x148)},'unit':{'$first':_0x1eacb7(0x165)},'alertquantity':{'$first':_0x1eacb7(0x19e)},'product_code':{'$first':_0x1eacb7(0xf4)},'primary_code':{'$first':_0x1eacb7(0x12d)},'secondary_code':{'$first':_0x1eacb7(0x1e4)},'maxStocks':{'$first':_0x1eacb7(0x1eb)},'maxProdPerUnit':{'$first':_0x1eacb7(0x1a3)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x1eacb7(0x13c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x15d9fc=await product[_0x1eacb7(0x1d9)]([{'$match':{'secondary_code':_0x1a16ac,'product_category':'Raw\x20Materials'}},{'$group':{'_id':'$_id','name':{'$first':_0x1eacb7(0x16f)},'category':{'$first':_0x1eacb7(0x15d)},'brand':{'$first':_0x1eacb7(0x148)},'unit':{'$first':'$unit'},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x1eacb7(0xf4)},'primary_code':{'$first':_0x1eacb7(0x12d)},'secondary_code':{'$first':_0x1eacb7(0x1e4)},'maxStocks':{'$first':_0x1eacb7(0x1eb)},'maxProdPerUnit':{'$first':_0x1eacb7(0x1a3)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x1eacb7(0x13c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x18ff54[_0x1eacb7(0x189)]>0x0)_0x67a28f=_0x18ff54;else _0x15d9fc[_0x1eacb7(0x189)]>0x0&&(_0x67a28f=_0x15d9fc);_0x1cd16d[_0x1eacb7(0x1c8)](_0x67a28f);}),router[a0_0x471c87(0x104)]('/CheckingWarehouse',async(_0x1edaa2,_0x2dff2d)=>{var _0x230381=a0_0x471c87;const {primaryCode:_0x35c8e6,secondaryCode:_0x55fb1f,productCode:_0x4671eb,bay:_0x474e48,bin:_0x1420c1,types:_0x46d4fe,pallet:_0xd45c90,warehouses:_0x3542b0,room:_0x60b595}=_0x1edaa2[_0x230381(0x10b)];console[_0x230381(0x125)](_0x1edaa2[_0x230381(0x10b)]);try{const _0x2b9cbe=await warehouse[_0x230381(0x1d9)]([{'$match':{'name':_0x3542b0,'room':_0x60b595}},{'$unwind':_0x230381(0x105)},{'$match':{'product_details.bay':_0x474e48,'product_details.bin':_0x1420c1,'product_details.type':_0x46d4fe}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x230381(0x159)},'product_stock':{'$first':_0x230381(0x196)},'level':{'$first':_0x230381(0x179)},'isle':{'$first':_0x230381(0xf6)},'pallet':{'$first':_0x230381(0x18d)},'maxProducts':{'$first':_0x230381(0x110)}}}]);_0x2dff2d[_0x230381(0x160)](0xc8)[_0x230381(0x1c8)](_0x2b9cbe);}catch(_0x3c1e3b){_0x2dff2d['status'](0x194)[_0x230381(0x1c8)]({'message':_0x3c1e3b[_0x230381(0x116)]});}}),module[a0_0x471c87(0x15e)]=router;function a0_0x135a(){var _0x49b1df=['$product_details.pallet','amount','English\x20(US)','secondary_code_hide','Rack\x20D','Rack\x20C','abs','prod_level','toString','$product_details.product_stock','MaxStocks_data','/preview/:id','Rack\x20B','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_stock','production_date','$alertquantity','language','stocks','/view/add_purchases','RoomAssign','$maxProdPerUnit','product_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','actual_uom','1165675SfARSQ','type','findById','prod_isle','<div>','master','stock_data','edit_purchases','isle','\x20</h2>','Arabic\x20(ae)','$product_details.type','<tbody\x20style=\x22text-align:\x20center;\x22>','due_amount','types','alertQTY','2qPhngF','expiry_date','prod_cat','save','French','product_name','catch','password','534264GSzrls','/view/:id','payment\x20successfull','success','True','prod_qty','Purchase\x20Return','currency','filter','json','$batch_code','Shelves','\x20<>\x20','prod_unit','/view/return_purchase/:id','redirect','secondary_code','79592naFtIB','Floor','site_title','ejs','email','</span>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','German','$product.quantity','aggregate','<h5>','map','136040LlfqIl','concat','Receiving\x20Area','An\x20error\x20occurred.','max_product_unit','</table>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','find','$secondary_code','suppliers_docs','push','path','product_cat','Ambient','paid_amount','$maxStocks','$date','date','user_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','params','storage','/all_purchases/view/','<tr>','</thead>','primary_code_hide','role','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','290TbenEA','$product_details.storage','$product','DRY\x20STORAGE','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','primary_code','$note','add_purchases','$product.bin','Rack\x20A','secondary_unit','</tr>','name','getFullYear','invoice','Raw\x20Materials','getMonth','\x20<\x20wew\x20>\x20','Spanish','Sales\x20Update\x20successfully','purchase_quantity','maxperunit','Enabled','staff','level','$product.type','Portuguese\x20(BR)','slice','../models/all_models','$product_code','errors','$product_details.isle','sendMail','Router','getDate','gmail','$product_details.bin','$product_details.rack','$due_amount','$warehouse_name','createTransport','Error\x20Occurs','render','note','image','post','$product_details','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','all_purchases','$product.floorlevel','floor','body','prod_invoice','\x20Order\x20Date\x20:\x20','delivery_date','<h2>\x20','$product_details.maxProducts','/invoice/:id','</h5>','Hindi','delivery_code','$suppliers','message','logo','suppliers','<hr\x20class=\x22my-3\x22>','Purchase\x20data\x20added\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','padStart','return_qty','</tbody>','Level','$product_details.secondary_code','$expiry_date','45IgUCzv','Rack\x20E','RMSEmail','log','error','random','findOne','</td>','all_purchases_barcode','forEach','<!DOCTYPE\x20html>','$primary_code','$product_details.floorlevel','rack','warehouse_name','prod_primunit','room','nodemailer','batch_code','product_list','\x20Order\x20Number\x20:\x20','Portuguese','<h5\x20style=\x22text-align:\x20left;\x22>','product_details','/barcode/:id','</body></html>','$secondary_unit','/all_purchases/view','room_name','user','prod_name','all','1237419IWDtPV','prod_secondunit','$product_details._id','maxStocks','prod_code','actual_qty','$brand','</div>','return_purchase','warehouse','$product.bay','foreach\x20newproduct','port','/upload/','table\x20page','string','/../public','$room','<html><head><title></title>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$return_data','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$invoice','$product_details.product_name','purchase_invoice','quantity','return_data','$category','exports','flash','status','stock_quantity','Arabic','back','add\x20post','$unit','620368oMWUmz','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Rack\x20F','$paid_amount','$_id','Email\x20sent\x20successfully','express','product_code_hide','$name','bin','pallet','currency_placement','$suppliers_docs','INC-','6OCACxS','Purchase\x20Mail','standard_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$product_details.level','/view/add_purchases/:id','Chinese','deliverycode','floorlevel','get','Return\x20Goods','rak','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','bay','English','249029hoZCrp','Purchase\x20Return\x20Mail','then','$product_details.expiry_date','COLD\x20STORAGE','length','<span\x20style=\x22float:\x20right;\x22>','Room_name','$product_details.bay'];a0_0x135a=function(){return _0x49b1df;};return a0_0x135a();}