var a0_0x5b3a9e=a0_0x84b3;function a0_0x84b3(_0x3c9a54,_0x22ff11){var _0xf2f7=a0_0xf2f7();return a0_0x84b3=function(_0x84b380,_0x3ebce5){_0x84b380=_0x84b380-0x1e5;var _0x558661=_0xf2f7[_0x84b380];return _0x558661;},a0_0x84b3(_0x3c9a54,_0x22ff11);}function a0_0xf2f7(){var _0xfbeaa2=['<span>\x20Thank\x20you\x20for\x20your\x20prompt\x20attention\x20to\x20this\x20matter.\x20</span>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','head_staff_info','wms_data','</b>,\x20</span><br>','findOne','real_qty_unit_val','1435842meKszc','146756RpeFgb','<span>\x20Requested\x20By:\x20<b>','product_name','totalPrice','$accounting_account_confirm','product_list','date','$sale_product.quantity','nodemailer','quantity','</body></html>','</table>','$sale_product','password','primary_code','staffs','body','Approval\x20for\x20','json','18ERKNqE','<div\x20style=\x22text-align:\x20center;\x22>','mongoose','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','://','head_id_staff_id','Router','exports','/view_sales/:id','Types','<br><br><br>','_id','$accounting_account_id','$member.id_member','$wms_account_confirm','../middleware/auth','Hindi','$JD','getPrimUnitNo','flash','$customer','render','params','prod_code','</tbody>','Spanish','no_per_unit','3059336UJgewB','Arabic\x20(ae)','errors','<strong>\x20Regards\x20</strong>','<!DOCTYPE\x20html>','head_id_staff','<span>\x20A\x20product\x20request\x20has\x20been\x20submitted\x20by\x20the\x20Sales\x20Department\x20that\x20requires\x20your\x20approval.\x20Below\x20are\x20the\x20details:\x20</span>\x20<br><br>','product_id','English\x20(US)','/../public','<tr>','Logo.png','language','accounting_account_id','get','view_sales_order','product_code','exceljs','Email\x20sent\x20successfully','<span>\x20Dear\x20<b>','6nAJcfN','invoice_init','padStart','user','/product_list','find','$date','</b>.\x20These\x20products\x20are\x20essential\x20to\x20improve\x20our\x20warehouse\x20efficiency\x20and\x20ensure\x20smooth\x20operations.\x20</span>','host','/sales_order/view_sales/','createTransport','24iecAIG','dicount_price_adjust','logo','isFG','valueOf','true','<span>\x20lease\x20review\x20the\x20request\x20and\x20approve\x20it\x20if\x20it\x20aligns\x20with\x20our\x20operational\x20needs.\x20If\x20you\x20have\x20any\x20questions\x20or\x20require\x20further\x20information,\x20please\x20feel\x20free\x20to\x20reach\x20out\x20to\x20the\x20Sales\x20Department.\x20</span>','image','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</b></span>\x20<br>','<hr\x20class=\x22my-3\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$_id','German','<tbody\x20style=\x22text-align:\x20center;\x22>','<div>','<span>\x20Request\x20Date:\x20<b>','<a\x20style=\x22background-color:\x20#007bff;\x20color:\x20#ffffff;\x20border:\x20none;\x20padding:\x2010px\x2020px;\x20border-radius:\x205px;\x22\x20href=\x22','<h5>\x20JEC\x20SMS\x20</h5>','findById','success','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','5841660cuPOFY','1596030evMlrZ','Portuguese','forEach','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','log','sttaff_id','../models/all_models','adjustment_discount','Sales\x20Order\x20is\x20ongoing','sales_category','post','<span>\x20Request\x20ID:\x20<b>','prod_name','</thead>','/product_data','</tr>','price','$head_staff_info','invoice','</b></span>\x20<br><br>','$member.name','unit','../public/language/languages.json','/add_sales','secondary_unit','tmpisFG','name','Portuguese\x20(BR)','Arabic','$account_data','<html><head><title></title>','map','aggregate','wms_account_id','9603755EAGDrS','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<link\x20href=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\x22\x20rel=\x22stylesheet\x22\x20integrity=\x22sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\x22\x20crossorigin=\x22anonymous\x22>','redirect','<script\x20src=\x22https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\x22\x20integrity=\x22sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\x22\x20crossorigin=\x22anonymous\x22></script>','ObjectId','add_sales_order','discount','headers','<table\x20style=\x22width:\x20100%\x20!important;\x22>','345806daXOLD','$head_id_staff','French','$wms_data','dicount_price','</head><body>','Chinese','English','email','</div>','protocol','</td>','mongodb','account_data'];a0_0xf2f7=function(){return _0xfbeaa2;};return a0_0xf2f7();}(function(_0x6fe14,_0x1eb3ad){var _0x4d3ab7=a0_0x84b3,_0x23dd9a=_0x6fe14();while(!![]){try{var _0xa2ad2c=parseInt(_0x4d3ab7(0x1ef))/0x1+-parseInt(_0x4d3ab7(0x281))/0x2+parseInt(_0x4d3ab7(0x23d))/0x3*(parseInt(_0x4d3ab7(0x1f0))/0x4)+parseInt(_0x4d3ab7(0x254))/0x5+-parseInt(_0x4d3ab7(0x232))/0x6*(parseInt(_0x4d3ab7(0x277))/0x7)+parseInt(_0x4d3ab7(0x21e))/0x8*(-parseInt(_0x4d3ab7(0x203))/0x9)+parseInt(_0x4d3ab7(0x255))/0xa;if(_0xa2ad2c===_0x1eb3ad)break;else _0x23dd9a['push'](_0x23dd9a['shift']());}catch(_0x1f66d6){_0x23dd9a['push'](_0x23dd9a['shift']());}}}(a0_0xf2f7,0xb6843));const express=require('express'),app=express(),router=express[a0_0x5b3a9e(0x209)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sales_order,invoice_sa,sales_sa,invoice_for_sales_order,approver_acct,email_settings}=require(a0_0x5b3a9e(0x25b)),auth=require(a0_0x5b3a9e(0x212)),users=require(a0_0x5b3a9e(0x26b)),excelJS=require(a0_0x5b3a9e(0x22f)),xlsx=require('xlsx'),mongoose=require(a0_0x5b3a9e(0x205)),{ObjectId}=require(a0_0x5b3a9e(0x1e6)),nodemailer=require(a0_0x5b3a9e(0x1f8));router[a0_0x5b3a9e(0x22c)]('/',auth,async(_0x28cfb6,_0x238e0c)=>{var _0x3ce125=a0_0x5b3a9e;try{const _0x20ebd5=await master_shop[_0x3ce125(0x237)](),_0x275dc5=_0x28cfb6[_0x3ce125(0x235)],_0x6687e7=await profile[_0x3ce125(0x1ed)]({'email':_0x275dc5[_0x3ce125(0x289)]}),_0x3b4cbf=await staff[_0x3ce125(0x1ed)]({'email':_0x275dc5[_0x3ce125(0x289)]}),_0x1093b1=await sales_order['aggregate']([{'$match':{'sales_staff_id':_0x3b4cbf[_0x3ce125(0x20e)][_0x3ce125(0x241)]()}},{'$unwind':_0x3ce125(0x1fc)},{'$group':{'_id':_0x3ce125(0x249),'invoice':{'$first':'$invoice'},'customer':{'$first':_0x3ce125(0x217)},'date':{'$first':_0x3ce125(0x238)},'JD':{'$first':_0x3ce125(0x214)},'accounting_account_confirm':{'$first':_0x3ce125(0x1f4)},'wms_account_confirm':{'$first':_0x3ce125(0x211)},'totalQTY':{'$sum':_0x3ce125(0x1f7)}}}]);if(_0x20ebd5[0x0][_0x3ce125(0x22a)]==_0x3ce125(0x226))var _0xc428db=users[_0x3ce125(0x288)];else{if(_0x20ebd5[0x0][_0x3ce125(0x22a)]==_0x3ce125(0x213))var _0xc428db=users[_0x3ce125(0x213)];else{if(_0x20ebd5[0x0][_0x3ce125(0x22a)]=='German')var _0xc428db=users[_0x3ce125(0x24a)];else{if(_0x20ebd5[0x0]['language']==_0x3ce125(0x21c))var _0xc428db=users[_0x3ce125(0x21c)];else{if(_0x20ebd5[0x0][_0x3ce125(0x22a)]=='French')var _0xc428db=users[_0x3ce125(0x283)];else{if(_0x20ebd5[0x0][_0x3ce125(0x22a)]==_0x3ce125(0x270))var _0xc428db=users[_0x3ce125(0x256)];else{if(_0x20ebd5[0x0][_0x3ce125(0x22a)]=='Chinese')var _0xc428db=users[_0x3ce125(0x287)];else{if(_0x20ebd5[0x0][_0x3ce125(0x22a)]==_0x3ce125(0x21f))var _0xc428db=users[_0x3ce125(0x271)];}}}}}}}_0x238e0c[_0x3ce125(0x218)]('all_sales_order',{'success':_0x28cfb6['flash'](_0x3ce125(0x251)),'errors':_0x28cfb6['flash']('errors'),'master_shop':_0x20ebd5,'profile':_0x6687e7,'role':_0x275dc5,'language':_0xc428db,'product_list':_0x3b4cbf[_0x3ce125(0x1f5)],'sales_mine':_0x1093b1,'staff_arr':_0x3b4cbf});}catch(_0x20c689){console['log'](_0x20c689);}}),router[a0_0x5b3a9e(0x22c)](a0_0x5b3a9e(0x26c),auth,async(_0x26f50f,_0x440170)=>{var _0x532e4a=a0_0x5b3a9e;try{const _0x305cfc=await master_shop['find'](),_0x2cf1d5=_0x26f50f[_0x532e4a(0x235)],_0x180ac5=await profile['findOne']({'email':_0x2cf1d5['email']}),_0x34a612=await staff[_0x532e4a(0x1ed)]({'email':_0x2cf1d5[_0x532e4a(0x289)]}),_0x55f6b9=await customer[_0x532e4a(0x237)]({'agent_id':_0x34a612['_id']});if(_0x305cfc[0x0]['language']=='English\x20(US)')var _0x8eba02=users['English'];else{if(_0x305cfc[0x0][_0x532e4a(0x22a)]==_0x532e4a(0x213))var _0x8eba02=users[_0x532e4a(0x213)];else{if(_0x305cfc[0x0][_0x532e4a(0x22a)]==_0x532e4a(0x24a))var _0x8eba02=users[_0x532e4a(0x24a)];else{if(_0x305cfc[0x0][_0x532e4a(0x22a)]==_0x532e4a(0x21c))var _0x8eba02=users[_0x532e4a(0x21c)];else{if(_0x305cfc[0x0]['language']==_0x532e4a(0x283))var _0x8eba02=users[_0x532e4a(0x283)];else{if(_0x305cfc[0x0][_0x532e4a(0x22a)]==_0x532e4a(0x270))var _0x8eba02=users['Portuguese'];else{if(_0x305cfc[0x0][_0x532e4a(0x22a)]=='Chinese')var _0x8eba02=users['Chinese'];else{if(_0x305cfc[0x0][_0x532e4a(0x22a)]==_0x532e4a(0x21f))var _0x8eba02=users[_0x532e4a(0x271)];}}}}}}}_0x440170[_0x532e4a(0x218)](_0x532e4a(0x27d),{'success':_0x26f50f[_0x532e4a(0x216)](_0x532e4a(0x251)),'errors':_0x26f50f[_0x532e4a(0x216)]('errors'),'master_shop':_0x305cfc,'profile':_0x180ac5,'role':_0x2cf1d5,'language':_0x8eba02,'customer':_0x55f6b9,'staff_arr':_0x34a612});}catch(_0x4f746f){console[_0x532e4a(0x259)](_0x4f746f);}}),router[a0_0x5b3a9e(0x22c)](a0_0x5b3a9e(0x20b),auth,async(_0x165ab6,_0x30cea5)=>{var _0x37fffe=a0_0x5b3a9e;try{const _0x31275a=await master_shop[_0x37fffe(0x237)](),_0x3e2505=_0x165ab6[_0x37fffe(0x235)],_0xf47e89=await profile[_0x37fffe(0x1ed)]({'email':_0x3e2505[_0x37fffe(0x289)]}),_0x2cf46c=await staff[_0x37fffe(0x1ed)]({'email':_0x3e2505[_0x37fffe(0x289)]}),_0x485ab0=await customer[_0x37fffe(0x237)]({'agent_id':_0x2cf46c['_id']}),_0x2df351=mongoose[_0x37fffe(0x20c)]['ObjectId'],_0x242080=_0x165ab6[_0x37fffe(0x219)]['id'],_0x296ca1=await sales_order[_0x37fffe(0x250)](_0x242080),_0x27362a=await sales_order[_0x37fffe(0x275)]([{'$match':{'_id':_0x2df351(_0x242080)}},{'$addFields':{'accounting_account_id':{'$toObjectId':_0x37fffe(0x20f)}}},{'$addFields':{'wms_account_id':{'$toObjectId':'$wms_account_id'}}},{'$lookup':{'from':'staffs','localField':_0x37fffe(0x22b),'foreignField':'_id','as':_0x37fffe(0x1e7)}},{'$unwind':_0x37fffe(0x272)},{'$lookup':{'from':_0x37fffe(0x1ff),'localField':_0x37fffe(0x276),'foreignField':_0x37fffe(0x20e),'as':_0x37fffe(0x1eb)}},{'$unwind':{'path':_0x37fffe(0x284),'preserveNullAndEmptyArrays':!![]}}]);if(_0x31275a[0x0]['language']=='English\x20(US)')var _0x52d2a7=users[_0x37fffe(0x288)];else{if(_0x31275a[0x0][_0x37fffe(0x22a)]=='Hindi')var _0x52d2a7=users[_0x37fffe(0x213)];else{if(_0x31275a[0x0][_0x37fffe(0x22a)]==_0x37fffe(0x24a))var _0x52d2a7=users[_0x37fffe(0x24a)];else{if(_0x31275a[0x0][_0x37fffe(0x22a)]==_0x37fffe(0x21c))var _0x52d2a7=users[_0x37fffe(0x21c)];else{if(_0x31275a[0x0][_0x37fffe(0x22a)]==_0x37fffe(0x283))var _0x52d2a7=users[_0x37fffe(0x283)];else{if(_0x31275a[0x0]['language']=='Portuguese\x20(BR)')var _0x52d2a7=users['Portuguese'];else{if(_0x31275a[0x0][_0x37fffe(0x22a)]==_0x37fffe(0x287))var _0x52d2a7=users[_0x37fffe(0x287)];else{if(_0x31275a[0x0][_0x37fffe(0x22a)]==_0x37fffe(0x21f))var _0x52d2a7=users['Arabic'];}}}}}}}_0x30cea5['render'](_0x37fffe(0x22d),{'success':_0x165ab6[_0x37fffe(0x216)](_0x37fffe(0x251)),'errors':_0x165ab6[_0x37fffe(0x216)](_0x37fffe(0x220)),'master_shop':_0x31275a,'profile':_0xf47e89,'role':_0x3e2505,'language':_0x52d2a7,'customer':_0x485ab0,'sales_sa':_0x296ca1,'approvers':_0x27362a[0x0],'staff_arr':_0x2cf46c});}catch(_0x3b80f8){console[_0x37fffe(0x259)](_0x3b80f8);}}),router[a0_0x5b3a9e(0x25f)](a0_0x5b3a9e(0x26c),auth,async(_0x1f53b7,_0x5a51e2)=>{var _0x3fca83=a0_0x5b3a9e;try{const {customer:_0x137d94,date:_0x51e7ce,prod_code:_0x172f63,note:_0x135d03,paid_status:_0x2b26b1,JD:_0x8efd92,po_number:_0x55c047,desire_date:_0x5a89e3}=_0x1f53b7[_0x3fca83(0x200)];if(typeof _0x172f63=='string')var _0x255e32=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x21a)]],_0x3a502d=[_0x1f53b7['body'][_0x3fca83(0x261)]],_0x486252=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x1fe)]],_0x517023=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x1f9)]],_0x5410ee=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x26a)]],_0x524dcc=[_0x1f53b7['body']['product_id']],_0x329f7e=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x265)]],_0x288f21=[_0x1f53b7[_0x3fca83(0x200)]['totalPrice']],_0x67ed99=[_0x1f53b7['body'][_0x3fca83(0x285)]],_0x451f0f=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x26e)]],_0x5e8474=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x23e)]],_0x1677c9=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x21d)]],_0x107e6f=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x215)]],_0x154b84=[_0x1f53b7['body'][_0x3fca83(0x252)]],_0x341174=[_0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x26d)]],_0x54d22b=[_0x1f53b7['body']['conversion_unit']];else var _0x255e32=[..._0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x21a)]],_0x3a502d=[..._0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x261)]],_0x486252=[..._0x1f53b7['body'][_0x3fca83(0x1fe)]],_0x517023=[..._0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x1f9)]],_0x5410ee=[..._0x1f53b7['body'][_0x3fca83(0x26a)]],_0x524dcc=[..._0x1f53b7['body'][_0x3fca83(0x225)]],_0x329f7e=[..._0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x265)]],_0x288f21=[..._0x1f53b7['body'][_0x3fca83(0x1f3)]],_0x67ed99=[..._0x1f53b7[_0x3fca83(0x200)]['dicount_price']],_0x451f0f=[..._0x1f53b7[_0x3fca83(0x200)]['tmpisFG']],_0x5e8474=[..._0x1f53b7['body'][_0x3fca83(0x23e)]],_0x1677c9=[..._0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x21d)]],_0x107e6f=[..._0x1f53b7[_0x3fca83(0x200)]['getPrimUnitNo']],_0x154b84=[..._0x1f53b7[_0x3fca83(0x200)]['prod_cat']],_0x341174=[..._0x1f53b7[_0x3fca83(0x200)][_0x3fca83(0x26d)]],_0x54d22b=[..._0x1f53b7[_0x3fca83(0x200)]['conversion_unit']];const _0xf803b0=_0x255e32[_0x3fca83(0x274)](_0x130fd1=>{return _0x130fd1={'product_code':_0x130fd1};});_0x3a502d['forEach']((_0x13a282,_0x5af9eb)=>{_0xf803b0[_0x5af9eb]['product_name']=_0x13a282;}),_0x486252[_0x3fca83(0x257)]((_0x45d5a7,_0x30ee11)=>{var _0x5c4151=_0x3fca83;_0xf803b0[_0x30ee11][_0x5c4151(0x1fe)]=_0x45d5a7;}),_0x517023['forEach']((_0x19fad3,_0x92d31)=>{var _0x57cf84=_0x3fca83;_0xf803b0[_0x92d31][_0x57cf84(0x1f9)]=_0x19fad3;}),_0x5410ee[_0x3fca83(0x257)]((_0x2617b6,_0x43b99a)=>{var _0x1d947f=_0x3fca83;_0xf803b0[_0x43b99a][_0x1d947f(0x26a)]=_0x2617b6;}),_0x524dcc[_0x3fca83(0x257)]((_0x35b068,_0x3a2ef8)=>{var _0x4502f0=_0x3fca83;_0xf803b0[_0x3a2ef8][_0x4502f0(0x225)]=_0x35b068;}),_0x5e8474['forEach']((_0x508857,_0x130fc1)=>{var _0x494519=_0x3fca83;_0xf803b0[_0x130fc1][_0x494519(0x25c)]=_0x508857;}),_0x329f7e[_0x3fca83(0x257)]((_0x5b7bc2,_0x5a2770)=>{var _0x1f7885=_0x3fca83;_0xf803b0[_0x5a2770][_0x1f7885(0x265)]=_0x5b7bc2;}),_0x288f21[_0x3fca83(0x257)]((_0x2ad744,_0x18fb7d)=>{_0xf803b0[_0x18fb7d]['totalprice']=_0x2ad744;}),_0x67ed99[_0x3fca83(0x257)]((_0x5922ef,_0x384aeb)=>{var _0x37f1dc=_0x3fca83;_0xf803b0[_0x384aeb][_0x37f1dc(0x27e)]=_0x5922ef;}),_0x451f0f['forEach']((_0x320923,_0x1c7e51)=>{var _0x16c59e=_0x3fca83;_0xf803b0[_0x1c7e51][_0x16c59e(0x240)]=_0x320923;}),_0x341174['forEach']((_0x73dd4b,_0x2f9593)=>{var _0x4ca51e=_0x3fca83;_0xf803b0[_0x2f9593][_0x4ca51e(0x26d)]=_0x73dd4b;}),_0x107e6f[_0x3fca83(0x257)]((_0x4138ef,_0x4c3c42)=>{var _0x585a52=_0x3fca83;_0xf803b0[_0x4c3c42][_0x585a52(0x1ee)]=_0x4138ef;}),_0x154b84[_0x3fca83(0x257)]((_0x41ee0e,_0xe6c229)=>{var _0x4104a8=_0x3fca83;_0xf803b0[_0xe6c229][_0x4104a8(0x252)]=_0x41ee0e;}),_0x54d22b[_0x3fca83(0x257)]((_0xee90eb,_0x38aa11)=>{_0xf803b0[_0x38aa11]['conversion_data']=_0xee90eb;}),_0x1677c9[_0x3fca83(0x257)]((_0x2ea04a,_0x3f5490)=>{var _0x404eaa=_0x3fca83;_0xf803b0[_0x3f5490][_0x404eaa(0x21d)]=_0x2ea04a;});const _0x198e0a=await approver_acct[_0x3fca83(0x275)]([{'$unwind':'$member'},{'$match':{'member.id_member':_0x1f53b7[_0x3fca83(0x235)][_0x3fca83(0x25a)]}},{'$group':{'_id':{'id_member':_0x3fca83(0x210),'name':_0x3fca83(0x269)},'head_id_staff':{'$first':_0x3fca83(0x282)}}},{'$addFields':{'head_id_staff_id':{'$toObjectId':_0x3fca83(0x282)}}},{'$lookup':{'from':_0x3fca83(0x1ff),'localField':_0x3fca83(0x208),'foreignField':_0x3fca83(0x20e),'as':_0x3fca83(0x1ea)}},{'$unwind':_0x3fca83(0x266)}]),_0x2a565b=new invoice_for_sales_order();await _0x2a565b['save']();const _0x118c43=_0x1f53b7[_0x3fca83(0x235)],_0x174c14=await staff[_0x3fca83(0x1ed)]({'email':_0x118c43[_0x3fca83(0x289)]}),_0x4c0dba=new sales_order({'invoice':_0x2a565b[_0x3fca83(0x233)]['toString']()[_0x3fca83(0x234)](0x8,'0'),'customer':_0x137d94,'date':_0x51e7ce,'sale_product':_0xf803b0,'note':_0x135d03,'sales_staff_id':_0x174c14['_id']['valueOf'](),'JD':_0x8efd92,'accounting_account_id':_0x198e0a[0x0][_0x3fca83(0x223)],'po_number':_0x55c047,'desired_delivery':_0x5a89e3,'wms_account_confirm':_0x3fca83(0x242),'accounting_account_confirm':_0x3fca83(0x242)}),_0x5bdc92=await _0x4c0dba['save']();var _0x5209c7=_0x5bdc92['sale_product'],_0x4a32cb='',_0x612143,_0x253017=0x0;for(_0x612143 in _0x5209c7){_0x4a32cb+=_0x3fca83(0x228)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5209c7[_0x612143][_0x3fca83(0x1f2)]+'</td>'+_0x3fca83(0x245)+_0x5209c7[_0x612143][_0x3fca83(0x22e)]+'</td>'+_0x3fca83(0x245)+_0x5209c7[_0x612143][_0x3fca83(0x1f9)]+_0x3fca83(0x1e5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5209c7[_0x612143][_0x3fca83(0x26a)]+_0x3fca83(0x1e5)+_0x3fca83(0x264),_0x253017+=parseInt(_0x5209c7[_0x612143][_0x3fca83(0x1f9)]);}const _0x4f592f=await master_shop['find'](),_0x1a3692=await email_settings['findOne']();let _0x28a064=nodemailer[_0x3fca83(0x23c)]({'port':Number(_0x1a3692['port']),'secure':![],'auth':{'user':_0x1a3692[_0x3fca83(0x289)],'pass':_0x1a3692[_0x3fca83(0x1fd)]}});const _0x38fcba=_0x1f53b7[_0x3fca83(0x28b)]+_0x3fca83(0x207)+_0x1f53b7[_0x3fca83(0x27f)][_0x3fca83(0x23a)];let _0x1e1e32={'from':_0x1a3692[_0x3fca83(0x289)],'to':_0x198e0a[0x0]['head_staff_info'][_0x3fca83(0x289)]+';christian.villamer@jakagroup.com','subject':_0x3fca83(0x201)+_0x5bdc92[_0x3fca83(0x267)],'attachments':[{'filename':_0x3fca83(0x229),'path':__dirname+_0x3fca83(0x227)+'/upload/'+_0x4f592f[0x0][_0x3fca83(0x244)],'cid':_0x3fca83(0x23f)}],'html':_0x3fca83(0x222)+_0x3fca83(0x273)+_0x3fca83(0x279)+_0x3fca83(0x286)+_0x3fca83(0x24c)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x3fca83(0x24c)+_0x3fca83(0x258)+'</div>'+_0x3fca83(0x24c)+'<h2>\x20JEC\x20SMS\x20</h2>'+_0x3fca83(0x28a)+'</div>'+_0x3fca83(0x247)+_0x3fca83(0x24c)+_0x3fca83(0x231)+_0x198e0a[0x0][_0x3fca83(0x1ea)][_0x3fca83(0x26f)]+_0x3fca83(0x1ec)+_0x3fca83(0x28a)+_0x3fca83(0x24c)+_0x3fca83(0x224)+_0x3fca83(0x28a)+_0x3fca83(0x24c)+_0x3fca83(0x260)+_0x5bdc92['invoice']+_0x3fca83(0x246)+_0x3fca83(0x1f1)+_0x174c14[_0x3fca83(0x26f)]+_0x3fca83(0x246)+_0x3fca83(0x24d)+_0x5bdc92[_0x3fca83(0x1f6)]+_0x3fca83(0x268)+_0x3fca83(0x28a)+_0x3fca83(0x280)+_0x3fca83(0x206)+_0x3fca83(0x228)+_0x3fca83(0x248)+_0x3fca83(0x1e9)+_0x3fca83(0x278)+_0x3fca83(0x253)+'</tr>'+_0x3fca83(0x262)+_0x3fca83(0x24b)+'\x20'+_0x4a32cb+'\x20'+_0x3fca83(0x21b)+_0x3fca83(0x1fb)+_0x3fca83(0x24c)+'<br><br><span>\x20The\x20total\x20quantity\x20for\x20these\x20items\x20is\x20<b>'+_0x253017+_0x3fca83(0x239)+_0x3fca83(0x243)+_0x3fca83(0x1e8)+_0x3fca83(0x20d)+_0x3fca83(0x28a)+_0x3fca83(0x204)+_0x3fca83(0x24e)+_0x38fcba+'/accounting_approval/'+_0x5bdc92[_0x3fca83(0x20e)]+'\x22>Change\x20Status</a>'+'<br><br>'+'</div>'+_0x3fca83(0x24c)+_0x3fca83(0x221)+_0x3fca83(0x24f)+'</div>'+'</div>'+_0x3fca83(0x27b)+_0x3fca83(0x1fa)};_0x28a064['sendMail'](_0x1e1e32,function(_0x14a68a,_0x51c650){var _0x1c5a30=_0x3fca83;_0x14a68a?(console[_0x1c5a30(0x259)](_0x14a68a),console[_0x1c5a30(0x259)]('Error\x20Occurs')):console['log'](_0x1c5a30(0x230));}),_0x1f53b7[_0x3fca83(0x216)](_0x3fca83(0x251),_0x3fca83(0x25d)),_0x5a51e2[_0x3fca83(0x27a)](_0x3fca83(0x23b)+_0x5bdc92[_0x3fca83(0x20e)]);}catch(_0x1d4d5f){}}),router[a0_0x5b3a9e(0x25f)](a0_0x5b3a9e(0x236),auth,async(_0x3ac038,_0x13d049)=>{var _0x58dba8=a0_0x5b3a9e;try{const _0x5be9ae=_0x3ac038[_0x58dba8(0x235)],_0x56e1ed=await profile[_0x58dba8(0x1ed)]({'email':_0x5be9ae['email']}),_0x2bf682=await product[_0x58dba8(0x237)]({'sales_category':_0x5be9ae[_0x58dba8(0x25e)]});_0x13d049['json'](_0x2bf682);}catch(_0x3bbc0b){}}),router[a0_0x5b3a9e(0x25f)](a0_0x5b3a9e(0x263),auth,async(_0x586cc8,_0xd51e70)=>{var _0x2d41cf=a0_0x5b3a9e;try{const _0x10076a=_0x586cc8[_0x2d41cf(0x235)],{id_data:_0x409d2c}=_0x586cc8['body'],_0x311844=await profile[_0x2d41cf(0x1ed)]({'email':_0x10076a[_0x2d41cf(0x289)]}),_0x3e2cd6=mongoose[_0x2d41cf(0x20c)][_0x2d41cf(0x27c)];var _0x2b9494=_0x3e2cd6(_0x409d2c);const _0x3a0a81=await product[_0x2d41cf(0x237)]({'_id':_0x2b9494});_0xd51e70[_0x2d41cf(0x202)](_0x3a0a81);}catch(_0x34cc21){}}),module[a0_0x5b3a9e(0x20a)]=router;