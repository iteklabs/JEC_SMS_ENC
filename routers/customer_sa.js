const a0_0x5a90f0=a0_0x4489;function a0_0x4489(_0x3e02e0,_0xd30715){const _0x23938f=a0_0x2393();return a0_0x4489=function(_0x448923,_0x382628){_0x448923=_0x448923-0x1bb;let _0x147e06=_0x23938f[_0x448923];return _0x147e06;},a0_0x4489(_0x3e02e0,_0xd30715);}(function(_0x10d6f6,_0x1ec93f){const _0x4d14cd=a0_0x4489,_0x57f108=_0x10d6f6();while(!![]){try{const _0x23f1fb=parseInt(_0x4d14cd(0x1da))/0x1*(-parseInt(_0x4d14cd(0x1cd))/0x2)+-parseInt(_0x4d14cd(0x1c3))/0x3*(-parseInt(_0x4d14cd(0x1ec))/0x4)+parseInt(_0x4d14cd(0x22b))/0x5+parseInt(_0x4d14cd(0x1e2))/0x6+parseInt(_0x4d14cd(0x1ff))/0x7+parseInt(_0x4d14cd(0x215))/0x8*(parseInt(_0x4d14cd(0x1cb))/0x9)+-parseInt(_0x4d14cd(0x22c))/0xa*(parseInt(_0x4d14cd(0x216))/0xb);if(_0x23f1fb===_0x1ec93f)break;else _0x57f108['push'](_0x57f108['shift']());}catch(_0xae628d){_0x57f108['push'](_0x57f108['shift']());}}}(a0_0x2393,0xf2959));const express=require(a0_0x5a90f0(0x1e7)),app=express(),router=express[a0_0x5a90f0(0x204)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x5a90f0(0x226)),auth=require(a0_0x5a90f0(0x1d9)),users=require(a0_0x5a90f0(0x1c6)),excelJS=require(a0_0x5a90f0(0x1bf)),xlsx=require('xlsx'),multer=require(a0_0x5a90f0(0x203));router[a0_0x5a90f0(0x1ce)]('/view',auth,async(_0x3b254d,_0x3fe2ba)=>{const _0x5c0314=a0_0x5a90f0;try{const {username:_0x15d4af,email:_0x1bf4d0,role:_0x3daf01}=_0x3b254d[_0x5c0314(0x1f7)],_0x254b80=_0x3b254d[_0x5c0314(0x1f7)],_0x25ce91=await profile[_0x5c0314(0x224)]({'email':_0x254b80[_0x5c0314(0x209)]}),_0xe92902=await master_shop[_0x5c0314(0x22a)](),_0x483a2e=await staff['findOne']({'email':_0x254b80[_0x5c0314(0x209)]}),_0x1f9421=await customer[_0x5c0314(0x22a)]({'agent_id':_0x483a2e[_0x5c0314(0x1d0)]}),_0x446acf=await customer[_0x5c0314(0x1eb)]([{'$match':{'agent_id':_0x483a2e['_id'][_0x5c0314(0x1f4)]()}},{'$lookup':{'from':_0x5c0314(0x1ea),'localField':'name','foreignField':_0x5c0314(0x1c5),'as':_0x5c0314(0x225)}}]),_0x49498c=_0x446acf[_0x5c0314(0x1dc)](_0x1b036f=>{const _0x7ba464=_0x5c0314;console[_0x7ba464(0x21f)]('data',_0x1b036f);var _0x3c422e=0x0,_0x5efa80=0x0;return _0x1b036f[_0x7ba464(0x225)][_0x7ba464(0x1c4)](_0x47d29d=>{const _0x83d8b6=_0x7ba464;console[_0x83d8b6(0x21f)](_0x83d8b6(0x1e6),_0x47d29d),_0x47d29d[_0x83d8b6(0x21c)]==_0x83d8b6(0x228)?_0x3c422e+=_0x47d29d[_0x83d8b6(0x231)]:_0x5efa80+=_0x47d29d['amount'];}),_0x1b036f[_0x7ba464(0x205)]=parseFloat(_0x3c422e)+0x0,_0x1b036f[_0x7ba464(0x21e)]=parseFloat(_0x5efa80)+0x0,_0x1b036f;});if(_0xe92902[0x0][_0x5c0314(0x20c)]=='English\x20(US)'){var _0x2d5845=users['English'];console[_0x5c0314(0x21f)](_0x2d5845);}else{if(_0xe92902[0x0][_0x5c0314(0x20c)]==_0x5c0314(0x1f8))var _0x2d5845=users[_0x5c0314(0x1f8)];else{if(_0xe92902[0x0][_0x5c0314(0x20c)]==_0x5c0314(0x1d1))var _0x2d5845=users[_0x5c0314(0x1d1)];else{if(_0xe92902[0x0][_0x5c0314(0x20c)]==_0x5c0314(0x21b))var _0x2d5845=users[_0x5c0314(0x21b)];else{if(_0xe92902[0x0][_0x5c0314(0x20c)]=='French')var _0x2d5845=users[_0x5c0314(0x1c0)];else{if(_0xe92902[0x0][_0x5c0314(0x20c)]==_0x5c0314(0x21a))var _0x2d5845=users['Portuguese'];else{if(_0xe92902[0x0][_0x5c0314(0x20c)]==_0x5c0314(0x200))var _0x2d5845=users[_0x5c0314(0x200)];else{if(_0xe92902[0x0][_0x5c0314(0x20c)]=='Arabic\x20(ae)')var _0x2d5845=users[_0x5c0314(0x1fd)];}}}}}}}_0x3fe2ba[_0x5c0314(0x20a)]('customer_sa',{'success':_0x3b254d['flash'](_0x5c0314(0x1d4)),'errors':_0x3b254d[_0x5c0314(0x1fc)]('errors'),'user':_0x1f9421,'role':_0x254b80,'profile':_0x25ce91,'master_shop':_0xe92902,'language':_0x2d5845,'agent_id':_0x483a2e[_0x5c0314(0x1d0)],'payment':_0x49498c,'staff_arr':_0x483a2e});}catch(_0x24755d){console['log'](_0x24755d);}}),router[a0_0x5a90f0(0x1db)](a0_0x5a90f0(0x1fa),auth,async(_0x47c264,_0x213dd5)=>{const _0x49742a=a0_0x5a90f0;try{const {name:_0x4c85d4,address:_0x214443,mobile:_0x12af99,email:_0x3a32d5,receivable:_0x420b6a,payable:_0x5393be,contactperson:_0xc977b0,landline:_0x32c928,agent_id:_0x5605b1,less_percent:_0x435729,type_org:_0x5b6f1c,res_address:_0x571cf4,business_start_year:_0x234d28,credit_limit:_0x1352e8,term_pay:_0x133e46}=_0x47c264[_0x49742a(0x1ef)];if(typeof _0x435729==_0x49742a(0x1d2))var _0x2007b7=[_0x47c264[_0x49742a(0x1ef)][_0x49742a(0x210)]];else var _0x2007b7=[..._0x47c264[_0x49742a(0x1ef)][_0x49742a(0x210)]];const _0x5285f7=_0x2007b7['map'](_0x3bc22d=>{return _0x3bc22d={'less':_0x3bc22d};}),_0x420d61=new customer({'name':_0x4c85d4,'address':_0x214443,'mobile':_0x12af99,'email':_0x3a32d5,'receivable':_0x420b6a,'payable':_0x5393be,'customer_discount':_0x5285f7,'contactperson':_0xc977b0,'landline':_0x32c928,'agent_id':_0x5605b1,'res_address':_0x571cf4,'type_organization':_0x5b6f1c,'business_start_year':_0x234d28,'credit_limit':_0x1352e8,'terms_of_payments':_0x133e46}),_0x54ff38=await _0x420d61[_0x49742a(0x1ee)]();_0x47c264[_0x49742a(0x1fc)](_0x49742a(0x1d4),_0x49742a(0x1e9)),_0x213dd5[_0x49742a(0x1c2)](_0x49742a(0x217));}catch(_0xfe9e92){console['log'](_0xfe9e92);}}),router[a0_0x5a90f0(0x1ce)](a0_0x5a90f0(0x1d8),auth,async(_0x4a567d,_0x833417)=>{const _0xbd8052=a0_0x5a90f0;try{const {username:_0x559b05,email:_0x1cd6da,role:_0x21bfa2}=_0x4a567d['user'],_0x25e4bc=_0x4a567d['user'],_0x1d6df7=await profile[_0xbd8052(0x224)]({'email':_0x25e4bc[_0xbd8052(0x209)]}),_0x2479d8=await master_shop['find']();console[_0xbd8052(0x21f)](_0xbd8052(0x220),_0x2479d8);const _0x46a885=_0x4a567d[_0xbd8052(0x201)]['id'],_0x4b5c54=await customer[_0xbd8052(0x234)](_0x46a885);console['log'](_0x4b5c54);if(_0x2479d8[0x0]['language']=='English\x20(US)'){var _0x4afe42=users[_0xbd8052(0x1d5)];console['log'](_0x4afe42);}else{if(_0x2479d8[0x0]['language']==_0xbd8052(0x1f8))var _0x4afe42=users[_0xbd8052(0x1f8)];else{if(_0x2479d8[0x0][_0xbd8052(0x20c)]=='German')var _0x4afe42=users[_0xbd8052(0x1d1)];else{if(_0x2479d8[0x0][_0xbd8052(0x20c)]=='Spanish')var _0x4afe42=users[_0xbd8052(0x21b)];else{if(_0x2479d8[0x0][_0xbd8052(0x20c)]==_0xbd8052(0x1c0))var _0x4afe42=users[_0xbd8052(0x1c0)];else{if(_0x2479d8[0x0][_0xbd8052(0x20c)]==_0xbd8052(0x21a))var _0x4afe42=users['Portuguese'];else{if(_0x2479d8[0x0][_0xbd8052(0x20c)]==_0xbd8052(0x200))var _0x4afe42=users[_0xbd8052(0x200)];else{if(_0x2479d8[0x0][_0xbd8052(0x20c)]=='Arabic\x20(ae)')var _0x4afe42=users[_0xbd8052(0x1fd)];}}}}}}}_0x833417['render'](_0xbd8052(0x233),{'success':_0x4a567d[_0xbd8052(0x1fc)](_0xbd8052(0x1d4)),'errors':_0x4a567d[_0xbd8052(0x1fc)](_0xbd8052(0x1c8)),'role':_0x25e4bc,'profile':_0x1d6df7,'user':_0x4b5c54,'master_shop':_0x2479d8,'language':_0x4afe42});}catch(_0x1c1db6){console[_0xbd8052(0x21f)](_0x1c1db6);}}),router[a0_0x5a90f0(0x1db)](a0_0x5a90f0(0x1d8),auth,async(_0xabffc7,_0x4161f0)=>{const _0x3940b1=a0_0x5a90f0;try{const _0x49d4e7=_0xabffc7[_0x3940b1(0x201)]['id'],_0x1c16ca=await customer['findById'](_0x49d4e7),{name:_0x5b0b4d,address:_0x5298e3,mobile:_0x3e7e2d,email:_0x294b58,receivable:_0x1d4519,payable:_0x43407e,contactperson:_0x328214,landline:_0x1a6c1b,less_percent_edit:_0x190e4c,edit_type_org:_0xc2a7be,edit_res_address:_0xc91cc3,edit_business_start_year:_0x153cea,edit_credit_limit:_0x517468,edit_term_pay:_0x972a24}=_0xabffc7['body'];if(typeof _0x190e4c==_0x3940b1(0x1d2))var _0x105e86=[_0xabffc7[_0x3940b1(0x1ef)][_0x3940b1(0x1d6)]];else var _0x105e86=[..._0xabffc7['body'][_0x3940b1(0x1d6)]];const _0x58876c=_0x105e86[_0x3940b1(0x1dc)](_0x3b9401=>{return _0x3b9401={'less':_0x3b9401};});_0x1c16ca['name']=_0x5b0b4d,_0x1c16ca['address']=_0x5298e3,_0x1c16ca[_0x3940b1(0x1bc)]=_0x3e7e2d,_0x1c16ca['email']=_0x294b58,_0x1c16ca[_0x3940b1(0x22d)]=_0x1d4519,_0x1c16ca[_0x3940b1(0x1c1)]=_0x43407e,_0x1c16ca['contactperson']=_0x328214,_0x1c16ca[_0x3940b1(0x1ca)]=_0x1a6c1b,_0x1c16ca[_0x3940b1(0x20f)]=_0x58876c,_0x1c16ca[_0x3940b1(0x1f2)]=_0xc2a7be,_0x1c16ca[_0x3940b1(0x1f1)]=_0x153cea,_0x1c16ca[_0x3940b1(0x1e5)]=_0x517468,_0x1c16ca['terms_of_payments']=_0x972a24,_0x1c16ca[_0x3940b1(0x1dd)]=_0xc91cc3;const _0x2470b9=await _0x1c16ca[_0x3940b1(0x1ee)]();_0xabffc7['flash'](_0x3940b1(0x1d4),_0x3940b1(0x1c9)),_0x4161f0[_0x3940b1(0x1c2)](_0x3940b1(0x217));}catch(_0x17185f){console[_0x3940b1(0x21f)](_0x17185f);}}),router[a0_0x5a90f0(0x1ce)](a0_0x5a90f0(0x1cc),auth,async(_0x1098db,_0x1242a9)=>{const _0x289441=a0_0x5a90f0;try{const {username:_0x6e6418,email:_0x567342,role:_0x1e888b}=_0x1098db[_0x289441(0x1f7)],_0x47e6b8=_0x1098db[_0x289441(0x1f7)],_0x486742=await profile[_0x289441(0x224)]({'email':_0x47e6b8[_0x289441(0x209)]}),_0x2deaa0=await master_shop['find']();console[_0x289441(0x21f)](_0x289441(0x220),_0x2deaa0),console[_0x289441(0x21f)](_0x1098db[_0x289441(0x201)]['id']);const _0x244e48=await customer['findOne']({'_id':_0x1098db[_0x289441(0x201)]['id']});console[_0x289441(0x21f)](_0x289441(0x1c7),_0x244e48);const _0xee53f7=await c_payment_data[_0x289441(0x22a)]({'customer':_0x244e48['name']});console[_0x289441(0x21f)](_0xee53f7);const _0x2a4c2e=await c_payment_data[_0x289441(0x1eb)]([{'$match':{'customer':_0x244e48['name']}},{'$match':{'reason':_0x289441(0x228)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x289441(0x21f)]('payable_sum',_0x2a4c2e);const _0x3533bf=await c_payment_data[_0x289441(0x1eb)]([{'$match':{'customer':_0x244e48[_0x289441(0x1cf)]}},{'$match':{'reason':_0x289441(0x221)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x289441(0x1e1)}}}]);console[_0x289441(0x21f)](_0x289441(0x214),_0x3533bf);if(_0x2deaa0[0x0]['language']=='English\x20(US)'){var _0x2ad2ef=users[_0x289441(0x1d5)];console[_0x289441(0x21f)](_0x2ad2ef);}else{if(_0x2deaa0[0x0]['language']=='Hindi')var _0x2ad2ef=users[_0x289441(0x1f8)];else{if(_0x2deaa0[0x0]['language']==_0x289441(0x1d1))var _0x2ad2ef=users[_0x289441(0x1d1)];else{if(_0x2deaa0[0x0][_0x289441(0x20c)]==_0x289441(0x21b))var _0x2ad2ef=users[_0x289441(0x21b)];else{if(_0x2deaa0[0x0][_0x289441(0x20c)]==_0x289441(0x1c0))var _0x2ad2ef=users[_0x289441(0x1c0)];else{if(_0x2deaa0[0x0][_0x289441(0x20c)]==_0x289441(0x21a))var _0x2ad2ef=users[_0x289441(0x232)];else{if(_0x2deaa0[0x0][_0x289441(0x20c)]==_0x289441(0x200))var _0x2ad2ef=users['Chinese'];else{if(_0x2deaa0[0x0]['language']==_0x289441(0x230))var _0x2ad2ef=users[_0x289441(0x1fd)];}}}}}}}_0x1242a9[_0x289441(0x20a)](_0x289441(0x1f9),{'success':_0x1098db[_0x289441(0x1fc)]('success'),'errors':_0x1098db[_0x289441(0x1fc)](_0x289441(0x1c8)),'role':_0x47e6b8,'profile':_0x486742,'payment':_0xee53f7,'payable':_0x2a4c2e,'receivable':_0x3533bf,'master_shop':_0x2deaa0,'language':_0x2ad2ef});}catch(_0x493730){console['log'](_0x493730);}}),router[a0_0x5a90f0(0x1ce)](a0_0x5a90f0(0x1d3),auth,async(_0x51e167,_0x5359c1)=>{const _0x16029f=a0_0x5a90f0;try{const _0x4de3d7=new excelJS[(_0x16029f(0x1ed))](),_0x240e2a=_0x4de3d7['addWorksheet'](_0x16029f(0x1e4));return _0x240e2a[_0x16029f(0x227)]=[{'header':'ID','key':_0x16029f(0x207),'width':0xa},{'header':_0x16029f(0x229),'key':_0x16029f(0x1d7),'width':0xa},{'header':_0x16029f(0x1f0),'key':_0x16029f(0x1df),'width':0xa},{'header':_0x16029f(0x1bd),'key':_0x16029f(0x1bd),'width':0xa},{'header':_0x16029f(0x1f3),'key':_0x16029f(0x1f3),'width':0xa},{'header':'mobile','key':'mobile','width':0xa},{'header':_0x16029f(0x209),'key':_0x16029f(0x209),'width':0xa}],_0x5359c1[_0x16029f(0x222)]('Content-Type',_0x16029f(0x212)),_0x5359c1[_0x16029f(0x222)](_0x16029f(0x1e8),_0x16029f(0x20e)),_0x4de3d7[_0x16029f(0x1e3)][_0x16029f(0x213)](_0x5359c1)['then'](()=>{const _0xd9f4d1=_0x16029f;_0x5359c1[_0xd9f4d1(0x1fe)](0xc8);});}catch(_0x206b1c){_0x5359c1[_0x16029f(0x1fe)](0x190)[_0x16029f(0x1bb)]({'errors':_0x206b1c[_0x16029f(0x211)]});}});const storage1=multer[a0_0x5a90f0(0x208)]({'destination':(_0x40f595,_0x58ae31,_0x125804)=>{const _0x593ebd=a0_0x5a90f0;_0x125804(null,_0x593ebd(0x1de));},'filename':(_0x9106d4,_0x337093,_0x165602)=>{const _0x345cc4=a0_0x5a90f0;_0x165602(null,Date[_0x345cc4(0x1fb)]()+_0x337093[_0x345cc4(0x206)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x5a90f0(0x1db)](a0_0x5a90f0(0x202),auth,uploadMigrate[a0_0x5a90f0(0x1be)](a0_0x5a90f0(0x22e)),async(_0x1e562c,_0x4e1687)=>{const _0x33c2c9=a0_0x5a90f0,_0x1e95d1=_0x1e562c[_0x33c2c9(0x223)][_0x33c2c9(0x21d)],_0x11e1d1=await xlsx[_0x33c2c9(0x1f6)](_0x33c2c9(0x218)+_0x1e95d1);let _0x2bcb42=_0x11e1d1[_0x33c2c9(0x1e0)],_0x380e6b=xlsx['utils']['sheet_to_json'](_0x11e1d1[_0x33c2c9(0x219)][_0x2bcb42[0x0]]);for(const _0x50a356 of _0x380e6b){const _0x29a216=_0x50a356['ID'],_0x59a624=_0x50a356[_0x33c2c9(0x229)],_0x81e56a=_0x50a356[_0x33c2c9(0x1f0)],_0xf9db72=_0x50a356[_0x33c2c9(0x1bd)],_0x1b7521=_0x50a356[_0x33c2c9(0x1f3)],_0x4cd4c4=_0x50a356[_0x33c2c9(0x1bc)],_0x3ef388=_0x50a356[_0x33c2c9(0x209)];try{let _0x4947cf=await customer[_0x33c2c9(0x224)]({'name':_0x59a624});if(!_0x4947cf){const _0x60c7ed=new customer({'name':_0x59a624,'ID':_0x29a216,'SalesmanCode':_0x81e56a,'SalesmanName':_0xf9db72,'address':_0x1b7521,'mobile':_0x4cd4c4,'email':_0x3ef388});_0x4947cf=await _0x60c7ed['save'](),_0x1e562c[_0x33c2c9(0x1fc)](_0x33c2c9(0x1d4),_0x59a624+_0x33c2c9(0x20b));}else _0x1e562c[_0x33c2c9(0x1fc)](_0x33c2c9(0x20d),_0x59a624+_0x33c2c9(0x1f5));}catch(_0x1b939b){_0x4e1687['status'](0x1f4)['json']({'proderror':_0x1b939b[_0x33c2c9(0x211)],'aproduct':ProductName});}}_0x4e1687[_0x33c2c9(0x1c2)](_0x33c2c9(0x217));}),module[a0_0x5a90f0(0x22f)]=router;function a0_0x2393(){const _0x3bf782=['readFile','user','Hindi','customer_payment','/view','now','flash','Arabic','status','10658095KoPYKX','Chinese','params','/customer_import_migrate_file','multer','Router','sale','originalname','PName','diskStorage','email','render','\x20added\x20successfully','language','error','attachment;\x20filename=customer_Migration_File.xlsx','customer_discount','less_percent','message','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','write','receivable_sum','3870136iGuuQy','22snaoya','/customer_sa/view','public/Migration/','Sheets','Portuguese\x20(BR)','Spanish','reason','filename','sale_return','log','master','Sale\x20Return','setHeader','file','findOne','customer_docs','../models/all_models','columns','Sale','Name','find','9770575fWLLZx','26498630tOvQJe','receivable','customer_product_fule','exports','Arabic\x20(ae)','amount','Portuguese','customer_sa','findById','send','mobile','SalesmanName','single','exceljs','French','payable','redirect','1011870VJJUJB','forEach','customer','../public/language/languages.json','customer_data','errors','customer\x20update\x20successfully','landline','27CHTERI','/view/payment/:id','538226EeAIVp','get','name','_id','German','string','/products_export_migrate_file','success','English','less_percent_edit','PBrands','/view/:id','../middleware/auth','7EvFnYu','post','map','res_address','public/Migration','PUnits','SheetNames','$amount','9376146vBVQsC','xlsx','Customers','credit_limit','element','express','Content-Disposition','customer\x20add\x20successfully','c_payments','aggregate','20CDFegX','Workbook','save','body','SalesmanCode','business_start_year','type_organization','address','valueOf','\x20Failed'];a0_0x2393=function(){return _0x3bf782;};return a0_0x2393();}