const a0_0x3a50b4=a0_0x5822;function a0_0x1545(){const _0x4e1b7e=['\x20Failed','customer_docs','Portuguese\x20(BR)','findById','errors','4713583bgyqRc','336198jvBLKr','single','../models/all_models','redirect','then','public/Migration/','render','Name','/view/:id','attachment;\x20filename=customer_Migration_File.xlsx','send','body','flash','customer','Sale\x20Return','Sheets','sale_return','/products_export_migrate_file','save','Arabic\x20(ae)','reason','public/Migration','string','terms_of_payments','log','type_organization','contactperson','555816vxHAhm','customer\x20update\x20successfully','SalesmanCode','params','error','map','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','customer_product_fule','7022312KvRJgO','payable_sum','$reason','receivable_sum','receivable','customer\x20add\x20successfully','/customer_import_migrate_file','file','../public/language/languages.json','status','Chinese','xlsx','Customers','customer_data','master','German','success','credit_limit','findOne','less_percent','columns','multer','18897144jbaTlB','name','Sale','Arabic','user','Spanish','Hindi','SalesmanName','Content-Type','customer_discount','address','English','addWorksheet','language','8bdtReC','French','13AIghbE','PUnits','mobile','English\x20(US)','8030FLBpVh','$amount','forEach','get','Workbook','4fbQAYp','sale','SheetNames','email','originalname','2cXknOK','diskStorage','exports','533271TrErPb','less_percent_edit','json','Portuguese','element','utils','filename','35wNJouD','customer_sa','c_payments','customer_payment','write','aggregate','find','\x20added\x20successfully','setHeader','/view','7794fLkUAA','data','express','/customer_sa/view','/view/payment/:id'];a0_0x1545=function(){return _0x4e1b7e;};return a0_0x1545();}function a0_0x5822(_0x51d884,_0x48f085){const _0x1545e2=a0_0x1545();return a0_0x5822=function(_0x582215,_0x49638f){_0x582215=_0x582215-0xb3;let _0xcd02c1=_0x1545e2[_0x582215];return _0xcd02c1;},a0_0x5822(_0x51d884,_0x48f085);}(function(_0x48b5fe,_0x1cbe17){const _0x5ed854=a0_0x5822,_0x5a9336=_0x48b5fe();while(!![]){try{const _0x3b11e5=parseInt(_0x5ed854(0x11f))/0x1*(-parseInt(_0x5ed854(0x100))/0x2)+-parseInt(_0x5ed854(0x103))/0x3*(parseInt(_0x5ed854(0xfb))/0x4)+-parseInt(_0x5ed854(0x10a))/0x5*(-parseInt(_0x5ed854(0xc4))/0x6)+-parseInt(_0x5ed854(0x11e))/0x7*(-parseInt(_0x5ed854(0xf0))/0x8)+parseInt(_0x5ed854(0x114))/0x9*(parseInt(_0x5ed854(0xf6))/0xa)+parseInt(_0x5ed854(0xcc))/0xb+-parseInt(_0x5ed854(0xe2))/0xc*(parseInt(_0x5ed854(0xf2))/0xd);if(_0x3b11e5===_0x1cbe17)break;else _0x5a9336['push'](_0x5a9336['shift']());}catch(_0x5bdba4){_0x5a9336['push'](_0x5a9336['shift']());}}}(a0_0x1545,0x8a66e));const express=require(a0_0x3a50b4(0x116)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x3a50b4(0x121)),auth=require('../middleware/auth'),users=require(a0_0x3a50b4(0xd4)),excelJS=require('exceljs'),xlsx=require(a0_0x3a50b4(0xd7)),multer=require(a0_0x3a50b4(0xe1));router[a0_0x3a50b4(0xf9)](a0_0x3a50b4(0x113),auth,async(_0x3f3348,_0x2cbe0a)=>{const _0x3aff77=a0_0x3a50b4;try{const {username:_0x438de7,email:_0x2f0ec2,role:_0x58db4b}=_0x3f3348[_0x3aff77(0xe6)],_0x111bd3=_0x3f3348[_0x3aff77(0xe6)],_0x52619c=await profile[_0x3aff77(0xde)]({'email':_0x111bd3['email']}),_0x2e668e=await master_shop[_0x3aff77(0x110)](),_0x1b6509=await staff[_0x3aff77(0xde)]({'email':_0x111bd3[_0x3aff77(0xfe)]}),_0x55a9f3=await customer[_0x3aff77(0x110)]({'agent_id':_0x1b6509['_id']}),_0x5569bb=await customer[_0x3aff77(0x10f)]([{'$match':{'agent_id':_0x1b6509['_id']['valueOf']()}},{'$lookup':{'from':_0x3aff77(0x10c),'localField':_0x3aff77(0xe3),'foreignField':_0x3aff77(0xb6),'as':_0x3aff77(0x11a)}}]),_0x30bf73=_0x5569bb['map'](_0xe2f073=>{const _0x5efc67=_0x3aff77;console[_0x5efc67(0xc1)](_0x5efc67(0x115),_0xe2f073);var _0x545a8a=0x0,_0x187608=0x0;return _0xe2f073[_0x5efc67(0x11a)][_0x5efc67(0xf8)](_0x4326a7=>{const _0x5d01f1=_0x5efc67;console['log'](_0x5d01f1(0x107),_0x4326a7),_0x4326a7[_0x5d01f1(0xbd)]==_0x5d01f1(0xe4)?_0x545a8a+=_0x4326a7['amount']:_0x187608+=_0x4326a7['amount'];}),_0xe2f073[_0x5efc67(0xfc)]=parseFloat(_0x545a8a)+0x0,_0xe2f073[_0x5efc67(0xb9)]=parseFloat(_0x187608)+0x0,_0xe2f073;});if(_0x2e668e[0x0][_0x3aff77(0xef)]==_0x3aff77(0xf5)){var _0x571ee6=users[_0x3aff77(0xed)];console['log'](_0x571ee6);}else{if(_0x2e668e[0x0][_0x3aff77(0xef)]=='Hindi')var _0x571ee6=users['Hindi'];else{if(_0x2e668e[0x0][_0x3aff77(0xef)]==_0x3aff77(0xdb))var _0x571ee6=users[_0x3aff77(0xdb)];else{if(_0x2e668e[0x0][_0x3aff77(0xef)]==_0x3aff77(0xe7))var _0x571ee6=users[_0x3aff77(0xe7)];else{if(_0x2e668e[0x0][_0x3aff77(0xef)]==_0x3aff77(0xf1))var _0x571ee6=users['French'];else{if(_0x2e668e[0x0][_0x3aff77(0xef)]=='Portuguese\x20(BR)')var _0x571ee6=users[_0x3aff77(0x106)];else{if(_0x2e668e[0x0]['language']==_0x3aff77(0xd6))var _0x571ee6=users['Chinese'];else{if(_0x2e668e[0x0]['language']==_0x3aff77(0xbc))var _0x571ee6=users[_0x3aff77(0xe5)];}}}}}}}_0x2cbe0a[_0x3aff77(0x125)](_0x3aff77(0x10b),{'success':_0x3f3348[_0x3aff77(0xb5)](_0x3aff77(0xdc)),'errors':_0x3f3348[_0x3aff77(0xb5)]('errors'),'user':_0x55a9f3,'role':_0x111bd3,'profile':_0x52619c,'master_shop':_0x2e668e,'language':_0x571ee6,'agent_id':_0x1b6509['_id'],'payment':_0x30bf73,'staff_arr':_0x1b6509});}catch(_0x53a576){console[_0x3aff77(0xc1)](_0x53a576);}}),router['post']('/view',auth,async(_0x574d56,_0x35552f)=>{const _0x46817b=a0_0x3a50b4;try{const {name:_0x3b4454,address:_0x1a56b4,mobile:_0x7f901a,email:_0xad0a0d,receivable:_0x5053f2,payable:_0x5eee00,contactperson:_0x20ec56,landline:_0x1d88f3,agent_id:_0x580216,less_percent:_0x30e17e,type_org:_0x1de756,res_address:_0x57a5d5,business_start_year:_0x51dc80,credit_limit:_0x35bf33,term_pay:_0x1be715}=_0x574d56[_0x46817b(0xb4)];if(typeof _0x30e17e=='string')var _0x3688b6=[_0x574d56[_0x46817b(0xb4)][_0x46817b(0xdf)]];else var _0x3688b6=[..._0x574d56[_0x46817b(0xb4)]['less_percent']];const _0x20d024=_0x3688b6[_0x46817b(0xc9)](_0x4fefaa=>{return _0x4fefaa={'less':_0x4fefaa};}),_0x3e014b=new customer({'name':_0x3b4454,'address':_0x1a56b4,'mobile':_0x7f901a,'email':_0xad0a0d,'receivable':_0x5053f2,'payable':_0x5eee00,'customer_discount':_0x20d024,'contactperson':_0x20ec56,'landline':_0x1d88f3,'agent_id':_0x580216,'res_address':_0x57a5d5,'type_organization':_0x1de756,'business_start_year':_0x51dc80,'credit_limit':_0x35bf33,'terms_of_payments':_0x1be715}),_0x4baaa2=await _0x3e014b[_0x46817b(0xbb)]();_0x574d56['flash'](_0x46817b(0xdc),_0x46817b(0xd1)),_0x35552f[_0x46817b(0x122)](_0x46817b(0x117));}catch(_0x328a2c){console['log'](_0x328a2c);}}),router[a0_0x3a50b4(0xf9)](a0_0x3a50b4(0x127),auth,async(_0x52a889,_0x572955)=>{const _0x4c2c42=a0_0x3a50b4;try{const {username:_0x1a7dd0,email:_0x52a2cc,role:_0x230d5f}=_0x52a889[_0x4c2c42(0xe6)],_0x456c31=_0x52a889['user'],_0x4827b7=await profile[_0x4c2c42(0xde)]({'email':_0x456c31[_0x4c2c42(0xfe)]}),_0x2f66d8=await master_shop[_0x4c2c42(0x110)]();console[_0x4c2c42(0xc1)]('master',_0x2f66d8);const _0x4e1062=_0x52a889[_0x4c2c42(0xc7)]['id'],_0x194315=await customer[_0x4c2c42(0x11c)](_0x4e1062);console['log'](_0x194315);if(_0x2f66d8[0x0][_0x4c2c42(0xef)]==_0x4c2c42(0xf5)){var _0x2913be=users['English'];console[_0x4c2c42(0xc1)](_0x2913be);}else{if(_0x2f66d8[0x0][_0x4c2c42(0xef)]==_0x4c2c42(0xe8))var _0x2913be=users[_0x4c2c42(0xe8)];else{if(_0x2f66d8[0x0][_0x4c2c42(0xef)]==_0x4c2c42(0xdb))var _0x2913be=users[_0x4c2c42(0xdb)];else{if(_0x2f66d8[0x0][_0x4c2c42(0xef)]=='Spanish')var _0x2913be=users['Spanish'];else{if(_0x2f66d8[0x0][_0x4c2c42(0xef)]==_0x4c2c42(0xf1))var _0x2913be=users[_0x4c2c42(0xf1)];else{if(_0x2f66d8[0x0][_0x4c2c42(0xef)]==_0x4c2c42(0x11b))var _0x2913be=users[_0x4c2c42(0x106)];else{if(_0x2f66d8[0x0][_0x4c2c42(0xef)]==_0x4c2c42(0xd6))var _0x2913be=users[_0x4c2c42(0xd6)];else{if(_0x2f66d8[0x0][_0x4c2c42(0xef)]==_0x4c2c42(0xbc))var _0x2913be=users[_0x4c2c42(0xe5)];}}}}}}}_0x572955[_0x4c2c42(0x125)](_0x4c2c42(0x10b),{'success':_0x52a889[_0x4c2c42(0xb5)](_0x4c2c42(0xdc)),'errors':_0x52a889[_0x4c2c42(0xb5)](_0x4c2c42(0x11d)),'role':_0x456c31,'profile':_0x4827b7,'user':_0x194315,'master_shop':_0x2f66d8,'language':_0x2913be});}catch(_0x111c9e){console[_0x4c2c42(0xc1)](_0x111c9e);}}),router['post'](a0_0x3a50b4(0x127),auth,async(_0x43c3aa,_0x1bd831)=>{const _0x2fc7fd=a0_0x3a50b4;try{const _0x44f22f=_0x43c3aa[_0x2fc7fd(0xc7)]['id'],_0x4ea2af=await customer[_0x2fc7fd(0x11c)](_0x44f22f),{name:_0x3bbfb6,address:_0x6a3a69,mobile:_0x5b78ca,email:_0xf59492,receivable:_0x2a209e,payable:_0xa47720,contactperson:_0x43153c,landline:_0x15d7ef,less_percent_edit:_0xceff34,edit_type_org:_0xcd3b8f,edit_res_address:_0x19c390,edit_business_start_year:_0x535cd1,edit_credit_limit:_0x2d439e,edit_term_pay:_0xe8a37b}=_0x43c3aa[_0x2fc7fd(0xb4)];if(typeof _0xceff34==_0x2fc7fd(0xbf))var _0x35c790=[_0x43c3aa[_0x2fc7fd(0xb4)][_0x2fc7fd(0x104)]];else var _0x35c790=[..._0x43c3aa['body']['less_percent_edit']];const _0x5d4dc1=_0x35c790[_0x2fc7fd(0xc9)](_0x2f076f=>{return _0x2f076f={'less':_0x2f076f};});_0x4ea2af[_0x2fc7fd(0xe3)]=_0x3bbfb6,_0x4ea2af[_0x2fc7fd(0xec)]=_0x6a3a69,_0x4ea2af[_0x2fc7fd(0xf4)]=_0x5b78ca,_0x4ea2af['email']=_0xf59492,_0x4ea2af[_0x2fc7fd(0xd0)]=_0x2a209e,_0x4ea2af['payable']=_0xa47720,_0x4ea2af[_0x2fc7fd(0xc3)]=_0x43153c,_0x4ea2af['landline']=_0x15d7ef,_0x4ea2af[_0x2fc7fd(0xeb)]=_0x5d4dc1,_0x4ea2af[_0x2fc7fd(0xc2)]=_0xcd3b8f,_0x4ea2af['business_start_year']=_0x535cd1,_0x4ea2af[_0x2fc7fd(0xdd)]=_0x2d439e,_0x4ea2af[_0x2fc7fd(0xc0)]=_0xe8a37b,_0x4ea2af['res_address']=_0x19c390;const _0x20487a=await _0x4ea2af[_0x2fc7fd(0xbb)]();_0x43c3aa[_0x2fc7fd(0xb5)](_0x2fc7fd(0xdc),_0x2fc7fd(0xc5)),_0x1bd831[_0x2fc7fd(0x122)]('/customer_sa/view');}catch(_0x5e88fd){console[_0x2fc7fd(0xc1)](_0x5e88fd);}}),router[a0_0x3a50b4(0xf9)](a0_0x3a50b4(0x118),auth,async(_0x496c8c,_0x3e2e48)=>{const _0x175be7=a0_0x3a50b4;try{const {username:_0x5c60ed,email:_0x22c384,role:_0x19811a}=_0x496c8c[_0x175be7(0xe6)],_0x1741d3=_0x496c8c[_0x175be7(0xe6)],_0x3bbaf0=await profile['findOne']({'email':_0x1741d3[_0x175be7(0xfe)]}),_0x57dcd9=await master_shop[_0x175be7(0x110)]();console[_0x175be7(0xc1)](_0x175be7(0xda),_0x57dcd9),console[_0x175be7(0xc1)](_0x496c8c[_0x175be7(0xc7)]['id']);const _0x34c4de=await customer[_0x175be7(0xde)]({'_id':_0x496c8c['params']['id']});console[_0x175be7(0xc1)](_0x175be7(0xd9),_0x34c4de);const _0xee80b2=await c_payment_data[_0x175be7(0x110)]({'customer':_0x34c4de[_0x175be7(0xe3)]});console[_0x175be7(0xc1)](_0xee80b2);const _0x144a0c=await c_payment_data['aggregate']([{'$match':{'customer':_0x34c4de[_0x175be7(0xe3)]}},{'$match':{'reason':_0x175be7(0xe4)}},{'$group':{'_id':_0x175be7(0xce),'sum':{'$sum':_0x175be7(0xf7)}}}]);console['log'](_0x175be7(0xcd),_0x144a0c);const _0x28ab9f=await c_payment_data[_0x175be7(0x10f)]([{'$match':{'customer':_0x34c4de[_0x175be7(0xe3)]}},{'$match':{'reason':_0x175be7(0xb7)}},{'$group':{'_id':_0x175be7(0xce),'sum':{'$sum':_0x175be7(0xf7)}}}]);console[_0x175be7(0xc1)](_0x175be7(0xcf),_0x28ab9f);if(_0x57dcd9[0x0][_0x175be7(0xef)]=='English\x20(US)'){var _0x5caf9b=users[_0x175be7(0xed)];console[_0x175be7(0xc1)](_0x5caf9b);}else{if(_0x57dcd9[0x0][_0x175be7(0xef)]==_0x175be7(0xe8))var _0x5caf9b=users['Hindi'];else{if(_0x57dcd9[0x0]['language']==_0x175be7(0xdb))var _0x5caf9b=users[_0x175be7(0xdb)];else{if(_0x57dcd9[0x0][_0x175be7(0xef)]==_0x175be7(0xe7))var _0x5caf9b=users[_0x175be7(0xe7)];else{if(_0x57dcd9[0x0]['language']==_0x175be7(0xf1))var _0x5caf9b=users[_0x175be7(0xf1)];else{if(_0x57dcd9[0x0]['language']==_0x175be7(0x11b))var _0x5caf9b=users[_0x175be7(0x106)];else{if(_0x57dcd9[0x0][_0x175be7(0xef)]==_0x175be7(0xd6))var _0x5caf9b=users[_0x175be7(0xd6)];else{if(_0x57dcd9[0x0][_0x175be7(0xef)]=='Arabic\x20(ae)')var _0x5caf9b=users['Arabic'];}}}}}}}_0x3e2e48[_0x175be7(0x125)](_0x175be7(0x10d),{'success':_0x496c8c[_0x175be7(0xb5)](_0x175be7(0xdc)),'errors':_0x496c8c[_0x175be7(0xb5)](_0x175be7(0x11d)),'role':_0x1741d3,'profile':_0x3bbaf0,'payment':_0xee80b2,'payable':_0x144a0c,'receivable':_0x28ab9f,'master_shop':_0x57dcd9,'language':_0x5caf9b});}catch(_0xb962a1){console[_0x175be7(0xc1)](_0xb962a1);}}),router[a0_0x3a50b4(0xf9)](a0_0x3a50b4(0xba),auth,async(_0x34cce5,_0x372f07)=>{const _0x37c0f5=a0_0x3a50b4;try{const _0x3bef0d=new excelJS[(_0x37c0f5(0xfa))](),_0x15ee25=_0x3bef0d[_0x37c0f5(0xee)](_0x37c0f5(0xd8));return _0x15ee25[_0x37c0f5(0xe0)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x37c0f5(0x126),'key':'PBrands','width':0xa},{'header':_0x37c0f5(0xc6),'key':_0x37c0f5(0xf3),'width':0xa},{'header':_0x37c0f5(0xe9),'key':_0x37c0f5(0xe9),'width':0xa},{'header':_0x37c0f5(0xec),'key':_0x37c0f5(0xec),'width':0xa},{'header':_0x37c0f5(0xf4),'key':_0x37c0f5(0xf4),'width':0xa},{'header':_0x37c0f5(0xfe),'key':_0x37c0f5(0xfe),'width':0xa}],_0x372f07['setHeader'](_0x37c0f5(0xea),_0x37c0f5(0xca)),_0x372f07[_0x37c0f5(0x112)]('Content-Disposition',_0x37c0f5(0x128)),_0x3bef0d[_0x37c0f5(0xd7)][_0x37c0f5(0x10e)](_0x372f07)[_0x37c0f5(0x123)](()=>{const _0x4ee8e6=_0x37c0f5;_0x372f07[_0x4ee8e6(0xd5)](0xc8);});}catch(_0x5e347d){_0x372f07[_0x37c0f5(0xd5)](0x190)[_0x37c0f5(0xb3)]({'errors':_0x5e347d['message']});}});const storage1=multer[a0_0x3a50b4(0x101)]({'destination':(_0x193f52,_0x49c151,_0x4b179b)=>{const _0x10933b=a0_0x3a50b4;_0x4b179b(null,_0x10933b(0xbe));},'filename':(_0x39fb74,_0x83e5,_0x252619)=>{const _0x492bb6=a0_0x3a50b4;_0x252619(null,Date['now']()+_0x83e5[_0x492bb6(0xff)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x3a50b4(0xd2),auth,uploadMigrate[a0_0x3a50b4(0x120)](a0_0x3a50b4(0xcb)),async(_0x3ece87,_0x4e28fd)=>{const _0xb30074=a0_0x3a50b4,_0x12eaac=_0x3ece87[_0xb30074(0xd3)][_0xb30074(0x109)],_0x304f2b=await xlsx['readFile'](_0xb30074(0x124)+_0x12eaac);let _0x121c89=_0x304f2b[_0xb30074(0xfd)],_0x313a02=xlsx[_0xb30074(0x108)]['sheet_to_json'](_0x304f2b[_0xb30074(0xb8)][_0x121c89[0x0]]);for(const _0x6488a0 of _0x313a02){const _0x4f223f=_0x6488a0['ID'],_0x233d4c=_0x6488a0['Name'],_0x4f97bd=_0x6488a0[_0xb30074(0xc6)],_0x1fa6dc=_0x6488a0[_0xb30074(0xe9)],_0x398379=_0x6488a0[_0xb30074(0xec)],_0x44f8e2=_0x6488a0[_0xb30074(0xf4)],_0x3ea3b1=_0x6488a0[_0xb30074(0xfe)];try{let _0x456f4f=await customer[_0xb30074(0xde)]({'name':_0x233d4c});if(!_0x456f4f){const _0x412a07=new customer({'name':_0x233d4c,'ID':_0x4f223f,'SalesmanCode':_0x4f97bd,'SalesmanName':_0x1fa6dc,'address':_0x398379,'mobile':_0x44f8e2,'email':_0x3ea3b1});_0x456f4f=await _0x412a07[_0xb30074(0xbb)](),_0x3ece87[_0xb30074(0xb5)](_0xb30074(0xdc),_0x233d4c+_0xb30074(0x111));}else _0x3ece87[_0xb30074(0xb5)](_0xb30074(0xc8),_0x233d4c+_0xb30074(0x119));}catch(_0x452976){_0x4e28fd['status'](0x1f4)[_0xb30074(0x105)]({'proderror':_0x452976['message'],'aproduct':ProductName});}}_0x4e28fd['redirect'](_0xb30074(0x117));}),module[a0_0x3a50b4(0x102)]=router;