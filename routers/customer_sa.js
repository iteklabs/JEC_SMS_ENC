function a0_0x172b(){const _0x3a34c7=['Content-Type','public/Migration','Spanish','res_address','element','Router','sale','get','3354575jIuGAm','Hindi','render','redirect','send','payable_sum','amount','readFile','mobile','$amount','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','customer_product_fule','customer_data','status','customer\x20update\x20successfully','English','Workbook','SalesmanName','email','utils','map','single','\x20added\x20successfully','14173jPLCmS','data','German','log','xlsx','customer_docs','now','findById','/view/payment/:id','/products_export_migrate_file','then','PUnits','1877386eAvnEe','38hTWCPN','save','forEach','address','landline','name','PBrands','contactperson','user','Chinese','Sale','business_start_year','flash','Arabic\x20(ae)','sheet_to_json','SalesmanCode','430472UczKXE','findOne','Portuguese\x20(BR)','customer\x20add\x20successfully','aggregate','/customer_import_migrate_file','success','addWorksheet','params','language','Content-Disposition','express','Arabic','find','body','620058cioCBM','message','French','customer_payment','/view/:id','Customers','Sheets','post','errors','/view','_id','diskStorage','$reason','terms_of_payments','file','setHeader','568768cdWRQI','less_percent_edit','customer_discount','filename','136206APkclH','English\x20(US)','originalname','master','Name','Portuguese','/customer_sa/view','../models/all_models','public/Migration/','columns','receivable_sum','../public/language/languages.json','exceljs','exports','SheetNames','string'];a0_0x172b=function(){return _0x3a34c7;};return a0_0x172b();}const a0_0x3e88fa=a0_0x53ee;(function(_0x2bd3ed,_0xc3e1d3){const _0x4b0c5a=a0_0x53ee,_0x479975=_0x2bd3ed();while(!![]){try{const _0x41890e=-parseInt(_0x4b0c5a(0x187))/0x1*(parseInt(_0x4b0c5a(0x194))/0x2)+-parseInt(_0x4b0c5a(0x1b3))/0x3+-parseInt(_0x4b0c5a(0x1c3))/0x4+parseInt(_0x4b0c5a(0x1df))/0x5+parseInt(_0x4b0c5a(0x1c7))/0x6+parseInt(_0x4b0c5a(0x193))/0x7+parseInt(_0x4b0c5a(0x1a4))/0x8;if(_0x41890e===_0xc3e1d3)break;else _0x479975['push'](_0x479975['shift']());}catch(_0x1ad3bb){_0x479975['push'](_0x479975['shift']());}}}(a0_0x172b,0x61092));const express=require(a0_0x3e88fa(0x1af)),app=express(),router=express[a0_0x3e88fa(0x1dc)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x3e88fa(0x1ce)),auth=require('../middleware/auth'),users=require(a0_0x3e88fa(0x1d2)),excelJS=require(a0_0x3e88fa(0x1d3)),xlsx=require(a0_0x3e88fa(0x18b)),multer=require('multer');function a0_0x53ee(_0x1fcf5f,_0x1521d4){const _0x172be7=a0_0x172b();return a0_0x53ee=function(_0x53eeee,_0x2a2943){_0x53eeee=_0x53eeee-0x178;let _0x2b758f=_0x172be7[_0x53eeee];return _0x2b758f;},a0_0x53ee(_0x1fcf5f,_0x1521d4);}router[a0_0x3e88fa(0x1de)](a0_0x3e88fa(0x1bc),auth,async(_0x507917,_0xfea183)=>{const _0x11a752=a0_0x3e88fa;try{const {username:_0x33f5f9,email:_0x25b35b,role:_0x4a9c12}=_0x507917['user'],_0x1c4843=_0x507917[_0x11a752(0x19c)],_0x100f51=await profile[_0x11a752(0x1a5)]({'email':_0x1c4843[_0x11a752(0x182)]}),_0x2faaa6=await master_shop[_0x11a752(0x1b1)](),_0x577d40=await staff[_0x11a752(0x1a5)]({'email':_0x1c4843[_0x11a752(0x182)]}),_0x36b927=await customer[_0x11a752(0x1b1)]({'agent_id':_0x577d40[_0x11a752(0x1bd)]}),_0x2e691f=await customer[_0x11a752(0x1a8)]([{'$match':{'agent_id':_0x577d40[_0x11a752(0x1bd)]['valueOf']()}},{'$lookup':{'from':'c_payments','localField':_0x11a752(0x199),'foreignField':'customer','as':_0x11a752(0x18c)}}]),_0x31d209=_0x2e691f['map'](_0x4763dc=>{const _0x1ef855=_0x11a752;console['log'](_0x1ef855(0x188),_0x4763dc);var _0xd0aabd=0x0,_0x5efc46=0x0;return _0x4763dc[_0x1ef855(0x18c)][_0x1ef855(0x196)](_0x393b9e=>{const _0x4d545c=_0x1ef855;console[_0x4d545c(0x18a)](_0x4d545c(0x1db),_0x393b9e),_0x393b9e['reason']==_0x4d545c(0x19e)?_0xd0aabd+=_0x393b9e[_0x4d545c(0x1e5)]:_0x5efc46+=_0x393b9e[_0x4d545c(0x1e5)];}),_0x4763dc[_0x1ef855(0x1dd)]=parseFloat(_0xd0aabd)+0x0,_0x4763dc['sale_return']=parseFloat(_0x5efc46)+0x0,_0x4763dc;});if(_0x2faaa6[0x0][_0x11a752(0x1ad)]==_0x11a752(0x1c8)){var _0x33bc15=users['English'];console[_0x11a752(0x18a)](_0x33bc15);}else{if(_0x2faaa6[0x0][_0x11a752(0x1ad)]==_0x11a752(0x1e0))var _0x33bc15=users['Hindi'];else{if(_0x2faaa6[0x0][_0x11a752(0x1ad)]==_0x11a752(0x189))var _0x33bc15=users[_0x11a752(0x189)];else{if(_0x2faaa6[0x0][_0x11a752(0x1ad)]==_0x11a752(0x1d9))var _0x33bc15=users['Spanish'];else{if(_0x2faaa6[0x0][_0x11a752(0x1ad)]==_0x11a752(0x1b5))var _0x33bc15=users[_0x11a752(0x1b5)];else{if(_0x2faaa6[0x0][_0x11a752(0x1ad)]==_0x11a752(0x1a6))var _0x33bc15=users[_0x11a752(0x1cc)];else{if(_0x2faaa6[0x0][_0x11a752(0x1ad)]=='Chinese')var _0x33bc15=users[_0x11a752(0x19d)];else{if(_0x2faaa6[0x0][_0x11a752(0x1ad)]==_0x11a752(0x1a1))var _0x33bc15=users[_0x11a752(0x1b0)];}}}}}}}_0xfea183[_0x11a752(0x1e1)]('customer_sa',{'success':_0x507917[_0x11a752(0x1a0)](_0x11a752(0x1aa)),'errors':_0x507917[_0x11a752(0x1a0)](_0x11a752(0x1bb)),'user':_0x36b927,'role':_0x1c4843,'profile':_0x100f51,'master_shop':_0x2faaa6,'language':_0x33bc15,'agent_id':_0x577d40['_id'],'payment':_0x31d209,'staff_arr':_0x577d40});}catch(_0x17a33e){console[_0x11a752(0x18a)](_0x17a33e);}}),router['post'](a0_0x3e88fa(0x1bc),auth,async(_0x426f66,_0x1ed72c)=>{const _0x58a436=a0_0x3e88fa;try{const {name:_0x2aa422,address:_0x167303,mobile:_0x4fdb4d,email:_0x30c594,receivable:_0x502b7e,payable:_0xf07e40,contactperson:_0x3cef2f,landline:_0x52fa8b,agent_id:_0x267f65,less_percent:_0x1075db,type_org:_0x1753a1,res_address:_0x5255ea,business_start_year:_0x2264ab,credit_limit:_0x2ca31c,term_pay:_0x27aae1}=_0x426f66[_0x58a436(0x1b2)];if(typeof _0x1075db==_0x58a436(0x1d6))var _0x34a9ae=[_0x426f66[_0x58a436(0x1b2)]['less_percent']];else var _0x34a9ae=[..._0x426f66[_0x58a436(0x1b2)]['less_percent']];const _0x2f6ae2=_0x34a9ae[_0x58a436(0x184)](_0x8ecd73=>{return _0x8ecd73={'less':_0x8ecd73};}),_0x2fd2c0=new customer({'name':_0x2aa422,'address':_0x167303,'mobile':_0x4fdb4d,'email':_0x30c594,'receivable':_0x502b7e,'payable':_0xf07e40,'customer_discount':_0x2f6ae2,'contactperson':_0x3cef2f,'landline':_0x52fa8b,'agent_id':_0x267f65,'res_address':_0x5255ea,'type_organization':_0x1753a1,'business_start_year':_0x2264ab,'credit_limit':_0x2ca31c,'terms_of_payments':_0x27aae1}),_0x4a2328=await _0x2fd2c0[_0x58a436(0x195)]();_0x426f66[_0x58a436(0x1a0)](_0x58a436(0x1aa),_0x58a436(0x1a7)),_0x1ed72c[_0x58a436(0x1e2)]('/customer_sa/view');}catch(_0x1e6e50){console[_0x58a436(0x18a)](_0x1e6e50);}}),router[a0_0x3e88fa(0x1de)](a0_0x3e88fa(0x1b7),auth,async(_0x2435e6,_0x4a7de2)=>{const _0x546091=a0_0x3e88fa;try{const {username:_0xbc939c,email:_0x284360,role:_0x3a32da}=_0x2435e6[_0x546091(0x19c)],_0x3f358d=_0x2435e6[_0x546091(0x19c)],_0x5a2566=await profile[_0x546091(0x1a5)]({'email':_0x3f358d[_0x546091(0x182)]}),_0x1896a3=await master_shop[_0x546091(0x1b1)]();console['log'](_0x546091(0x1ca),_0x1896a3);const _0x15e77=_0x2435e6['params']['id'],_0x479af6=await customer[_0x546091(0x18e)](_0x15e77);console[_0x546091(0x18a)](_0x479af6);if(_0x1896a3[0x0][_0x546091(0x1ad)]=='English\x20(US)'){var _0x22d60c=users['English'];console[_0x546091(0x18a)](_0x22d60c);}else{if(_0x1896a3[0x0][_0x546091(0x1ad)]==_0x546091(0x1e0))var _0x22d60c=users['Hindi'];else{if(_0x1896a3[0x0][_0x546091(0x1ad)]==_0x546091(0x189))var _0x22d60c=users[_0x546091(0x189)];else{if(_0x1896a3[0x0][_0x546091(0x1ad)]==_0x546091(0x1d9))var _0x22d60c=users[_0x546091(0x1d9)];else{if(_0x1896a3[0x0]['language']==_0x546091(0x1b5))var _0x22d60c=users[_0x546091(0x1b5)];else{if(_0x1896a3[0x0][_0x546091(0x1ad)]==_0x546091(0x1a6))var _0x22d60c=users[_0x546091(0x1cc)];else{if(_0x1896a3[0x0][_0x546091(0x1ad)]=='Chinese')var _0x22d60c=users[_0x546091(0x19d)];else{if(_0x1896a3[0x0]['language']==_0x546091(0x1a1))var _0x22d60c=users[_0x546091(0x1b0)];}}}}}}}_0x4a7de2[_0x546091(0x1e1)]('customer_sa',{'success':_0x2435e6[_0x546091(0x1a0)](_0x546091(0x1aa)),'errors':_0x2435e6[_0x546091(0x1a0)](_0x546091(0x1bb)),'role':_0x3f358d,'profile':_0x5a2566,'user':_0x479af6,'master_shop':_0x1896a3,'language':_0x22d60c});}catch(_0x409165){console[_0x546091(0x18a)](_0x409165);}}),router[a0_0x3e88fa(0x1ba)](a0_0x3e88fa(0x1b7),auth,async(_0x41fc13,_0x481dde)=>{const _0x14b432=a0_0x3e88fa;try{const _0x529f33=_0x41fc13[_0x14b432(0x1ac)]['id'],_0x2c38ec=await customer[_0x14b432(0x18e)](_0x529f33),{name:_0x201da6,address:_0x2e1d31,mobile:_0x5612cd,email:_0x250485,receivable:_0x23683d,payable:_0x1bc8f0,contactperson:_0x16ebb2,landline:_0x134455,less_percent_edit:_0x1b4944,edit_type_org:_0x1f3637,edit_res_address:_0x57ad94,edit_business_start_year:_0x4acd82,edit_credit_limit:_0x3c427f,edit_term_pay:_0x57adb1}=_0x41fc13[_0x14b432(0x1b2)];if(typeof _0x1b4944=='string')var _0x3ce902=[_0x41fc13['body'][_0x14b432(0x1c4)]];else var _0x3ce902=[..._0x41fc13[_0x14b432(0x1b2)][_0x14b432(0x1c4)]];const _0x923b6b=_0x3ce902['map'](_0x2f3c29=>{return _0x2f3c29={'less':_0x2f3c29};});_0x2c38ec[_0x14b432(0x199)]=_0x201da6,_0x2c38ec['address']=_0x2e1d31,_0x2c38ec['mobile']=_0x5612cd,_0x2c38ec[_0x14b432(0x182)]=_0x250485,_0x2c38ec['receivable']=_0x23683d,_0x2c38ec['payable']=_0x1bc8f0,_0x2c38ec[_0x14b432(0x19b)]=_0x16ebb2,_0x2c38ec[_0x14b432(0x198)]=_0x134455,_0x2c38ec[_0x14b432(0x1c5)]=_0x923b6b,_0x2c38ec['type_organization']=_0x1f3637,_0x2c38ec[_0x14b432(0x19f)]=_0x4acd82,_0x2c38ec['credit_limit']=_0x3c427f,_0x2c38ec[_0x14b432(0x1c0)]=_0x57adb1,_0x2c38ec[_0x14b432(0x1da)]=_0x57ad94;const _0x55d7bc=await _0x2c38ec['save']();_0x41fc13[_0x14b432(0x1a0)]('success',_0x14b432(0x17e)),_0x481dde[_0x14b432(0x1e2)](_0x14b432(0x1cd));}catch(_0x4e0fcf){console['log'](_0x4e0fcf);}}),router[a0_0x3e88fa(0x1de)](a0_0x3e88fa(0x18f),auth,async(_0x29e51f,_0x2f365c)=>{const _0x1530dd=a0_0x3e88fa;try{const {username:_0x5261ff,email:_0x16734b,role:_0x3592f8}=_0x29e51f['user'],_0x3ac06d=_0x29e51f['user'],_0x591175=await profile[_0x1530dd(0x1a5)]({'email':_0x3ac06d[_0x1530dd(0x182)]}),_0x18648f=await master_shop[_0x1530dd(0x1b1)]();console[_0x1530dd(0x18a)](_0x1530dd(0x1ca),_0x18648f),console[_0x1530dd(0x18a)](_0x29e51f[_0x1530dd(0x1ac)]['id']);const _0x5f7a51=await customer[_0x1530dd(0x1a5)]({'_id':_0x29e51f['params']['id']});console['log'](_0x1530dd(0x17c),_0x5f7a51);const _0x2f6d8f=await c_payment_data['find']({'customer':_0x5f7a51[_0x1530dd(0x199)]});console[_0x1530dd(0x18a)](_0x2f6d8f);const _0x60439=await c_payment_data['aggregate']([{'$match':{'customer':_0x5f7a51[_0x1530dd(0x199)]}},{'$match':{'reason':_0x1530dd(0x19e)}},{'$group':{'_id':_0x1530dd(0x1bf),'sum':{'$sum':'$amount'}}}]);console[_0x1530dd(0x18a)](_0x1530dd(0x1e4),_0x60439);const _0x56d549=await c_payment_data['aggregate']([{'$match':{'customer':_0x5f7a51[_0x1530dd(0x199)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x1530dd(0x1bf),'sum':{'$sum':_0x1530dd(0x179)}}}]);console[_0x1530dd(0x18a)](_0x1530dd(0x1d1),_0x56d549);if(_0x18648f[0x0][_0x1530dd(0x1ad)]==_0x1530dd(0x1c8)){var _0x1705d8=users[_0x1530dd(0x17f)];console[_0x1530dd(0x18a)](_0x1705d8);}else{if(_0x18648f[0x0][_0x1530dd(0x1ad)]==_0x1530dd(0x1e0))var _0x1705d8=users[_0x1530dd(0x1e0)];else{if(_0x18648f[0x0][_0x1530dd(0x1ad)]==_0x1530dd(0x189))var _0x1705d8=users[_0x1530dd(0x189)];else{if(_0x18648f[0x0][_0x1530dd(0x1ad)]=='Spanish')var _0x1705d8=users[_0x1530dd(0x1d9)];else{if(_0x18648f[0x0]['language']=='French')var _0x1705d8=users[_0x1530dd(0x1b5)];else{if(_0x18648f[0x0][_0x1530dd(0x1ad)]==_0x1530dd(0x1a6))var _0x1705d8=users[_0x1530dd(0x1cc)];else{if(_0x18648f[0x0][_0x1530dd(0x1ad)]=='Chinese')var _0x1705d8=users['Chinese'];else{if(_0x18648f[0x0]['language']==_0x1530dd(0x1a1))var _0x1705d8=users['Arabic'];}}}}}}}_0x2f365c[_0x1530dd(0x1e1)](_0x1530dd(0x1b6),{'success':_0x29e51f['flash']('success'),'errors':_0x29e51f[_0x1530dd(0x1a0)](_0x1530dd(0x1bb)),'role':_0x3ac06d,'profile':_0x591175,'payment':_0x2f6d8f,'payable':_0x60439,'receivable':_0x56d549,'master_shop':_0x18648f,'language':_0x1705d8});}catch(_0x575812){console['log'](_0x575812);}}),router['get'](a0_0x3e88fa(0x190),auth,async(_0x33adb0,_0x3a0fb9)=>{const _0x17bbba=a0_0x3e88fa;try{const _0x5c147f=new excelJS[(_0x17bbba(0x180))](),_0x4d151d=_0x5c147f[_0x17bbba(0x1ab)](_0x17bbba(0x1b8));return _0x4d151d[_0x17bbba(0x1d0)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x17bbba(0x1cb),'key':_0x17bbba(0x19a),'width':0xa},{'header':_0x17bbba(0x1a3),'key':_0x17bbba(0x192),'width':0xa},{'header':_0x17bbba(0x181),'key':_0x17bbba(0x181),'width':0xa},{'header':_0x17bbba(0x197),'key':'address','width':0xa},{'header':_0x17bbba(0x178),'key':'mobile','width':0xa},{'header':_0x17bbba(0x182),'key':_0x17bbba(0x182),'width':0xa}],_0x3a0fb9[_0x17bbba(0x1c2)](_0x17bbba(0x1d7),_0x17bbba(0x17a)),_0x3a0fb9[_0x17bbba(0x1c2)](_0x17bbba(0x1ae),'attachment;\x20filename=customer_Migration_File.xlsx'),_0x5c147f['xlsx']['write'](_0x3a0fb9)[_0x17bbba(0x191)](()=>{const _0x351002=_0x17bbba;_0x3a0fb9[_0x351002(0x17d)](0xc8);});}catch(_0x34c6ab){_0x3a0fb9[_0x17bbba(0x17d)](0x190)[_0x17bbba(0x1e3)]({'errors':_0x34c6ab['message']});}});const storage1=multer[a0_0x3e88fa(0x1be)]({'destination':(_0x224353,_0xf96de9,_0x4d1354)=>{const _0x1ae94e=a0_0x3e88fa;_0x4d1354(null,_0x1ae94e(0x1d8));},'filename':(_0x3fe13b,_0x29677a,_0x28919b)=>{const _0x231a68=a0_0x3e88fa;_0x28919b(null,Date[_0x231a68(0x18d)]()+_0x29677a[_0x231a68(0x1c9)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x3e88fa(0x1a9),auth,uploadMigrate[a0_0x3e88fa(0x185)](a0_0x3e88fa(0x17b)),async(_0x621637,_0x424024)=>{const _0xd3b480=a0_0x3e88fa,_0x4bc4a1=_0x621637[_0xd3b480(0x1c1)][_0xd3b480(0x1c6)],_0x1106ed=await xlsx[_0xd3b480(0x1e6)](_0xd3b480(0x1cf)+_0x4bc4a1);let _0x38e656=_0x1106ed[_0xd3b480(0x1d5)],_0x1fc7bb=xlsx[_0xd3b480(0x183)][_0xd3b480(0x1a2)](_0x1106ed[_0xd3b480(0x1b9)][_0x38e656[0x0]]);for(const _0x582d62 of _0x1fc7bb){const _0x1447ec=_0x582d62['ID'],_0x2af61e=_0x582d62[_0xd3b480(0x1cb)],_0x19b1e9=_0x582d62[_0xd3b480(0x1a3)],_0x9b9782=_0x582d62['SalesmanName'],_0x59d9b8=_0x582d62[_0xd3b480(0x197)],_0x5e682a=_0x582d62[_0xd3b480(0x178)],_0x22eb00=_0x582d62[_0xd3b480(0x182)];try{let _0x25ca84=await customer[_0xd3b480(0x1a5)]({'name':_0x2af61e});if(!_0x25ca84){const _0x32ef0c=new customer({'name':_0x2af61e,'ID':_0x1447ec,'SalesmanCode':_0x19b1e9,'SalesmanName':_0x9b9782,'address':_0x59d9b8,'mobile':_0x5e682a,'email':_0x22eb00});_0x25ca84=await _0x32ef0c[_0xd3b480(0x195)](),_0x621637[_0xd3b480(0x1a0)](_0xd3b480(0x1aa),_0x2af61e+_0xd3b480(0x186));}else _0x621637[_0xd3b480(0x1a0)]('error',_0x2af61e+'\x20Failed');}catch(_0x372b7f){_0x424024[_0xd3b480(0x17d)](0x1f4)['json']({'proderror':_0x372b7f[_0xd3b480(0x1b4)],'aproduct':ProductName});}}_0x424024[_0xd3b480(0x1e2)](_0xd3b480(0x1cd));}),module[a0_0x3e88fa(0x1d4)]=router;