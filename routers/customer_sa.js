function a0_0x11e4(_0x59cf39,_0x5e4a47){const _0x26c210=a0_0x26c2();return a0_0x11e4=function(_0x11e454,_0x144581){_0x11e454=_0x11e454-0x12a;let _0x62187=_0x26c210[_0x11e454];return _0x62187;},a0_0x11e4(_0x59cf39,_0x5e4a47);}const a0_0x40f2dd=a0_0x11e4;(function(_0x498570,_0x48b09a){const _0x1deab6=a0_0x11e4,_0x433d04=_0x498570();while(!![]){try{const _0x5f18e4=parseInt(_0x1deab6(0x13d))/0x1*(-parseInt(_0x1deab6(0x19f))/0x2)+-parseInt(_0x1deab6(0x15e))/0x3+-parseInt(_0x1deab6(0x162))/0x4*(parseInt(_0x1deab6(0x132))/0x5)+parseInt(_0x1deab6(0x186))/0x6*(parseInt(_0x1deab6(0x187))/0x7)+parseInt(_0x1deab6(0x17a))/0x8*(parseInt(_0x1deab6(0x14e))/0x9)+-parseInt(_0x1deab6(0x16e))/0xa+parseInt(_0x1deab6(0x1a0))/0xb*(parseInt(_0x1deab6(0x174))/0xc);if(_0x5f18e4===_0x48b09a)break;else _0x433d04['push'](_0x433d04['shift']());}catch(_0x8c8eba){_0x433d04['push'](_0x433d04['shift']());}}}(a0_0x26c2,0xd39f5));const express=require(a0_0x40f2dd(0x131)),app=express(),router=express[a0_0x40f2dd(0x197)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x40f2dd(0x150)),auth=require(a0_0x40f2dd(0x142)),users=require(a0_0x40f2dd(0x133)),excelJS=require(a0_0x40f2dd(0x152)),xlsx=require(a0_0x40f2dd(0x158)),multer=require(a0_0x40f2dd(0x160));router[a0_0x40f2dd(0x194)](a0_0x40f2dd(0x16f),auth,async(_0x304991,_0x37e07e)=>{const _0x5b3105=a0_0x40f2dd;try{const {username:_0x388d60,email:_0xed59e0,role:_0x13def2}=_0x304991['user'],_0x357808=_0x304991[_0x5b3105(0x138)],_0x20134a=await profile[_0x5b3105(0x155)]({'email':_0x357808['email']}),_0x1b2e4d=await master_shop['find'](),_0x5a2fb4=await staff[_0x5b3105(0x155)]({'email':_0x357808[_0x5b3105(0x143)]}),_0x2cf9f0=await customer[_0x5b3105(0x130)]({'agent_id':_0x5a2fb4[_0x5b3105(0x15b)]}),_0x2dd0ca=await customer[_0x5b3105(0x18e)]([{'$match':{'agent_id':_0x5a2fb4['_id'][_0x5b3105(0x12c)]()}},{'$lookup':{'from':_0x5b3105(0x151),'localField':'name','foreignField':_0x5b3105(0x168),'as':_0x5b3105(0x173)}}]),_0x20500f=_0x2dd0ca['map'](_0x5009fc=>{const _0x56e309=_0x5b3105;console[_0x56e309(0x157)](_0x56e309(0x198),_0x5009fc);var _0x275a6b=0x0,_0x3ad2be=0x0;return _0x5009fc['customer_docs'][_0x56e309(0x180)](_0x87bae7=>{const _0x541ad9=_0x56e309;console[_0x541ad9(0x157)](_0x541ad9(0x175),_0x87bae7),_0x87bae7['reason']==_0x541ad9(0x161)?_0x275a6b+=_0x87bae7[_0x541ad9(0x16b)]:_0x3ad2be+=_0x87bae7[_0x541ad9(0x16b)];}),_0x5009fc['sale']=parseFloat(_0x275a6b)+0x0,_0x5009fc[_0x56e309(0x16d)]=parseFloat(_0x3ad2be)+0x0,_0x5009fc;});if(_0x1b2e4d[0x0][_0x5b3105(0x154)]==_0x5b3105(0x18c)){var _0x5bb72f=users[_0x5b3105(0x19c)];console[_0x5b3105(0x157)](_0x5bb72f);}else{if(_0x1b2e4d[0x0][_0x5b3105(0x154)]==_0x5b3105(0x139))var _0x5bb72f=users['Hindi'];else{if(_0x1b2e4d[0x0][_0x5b3105(0x154)]==_0x5b3105(0x134))var _0x5bb72f=users['German'];else{if(_0x1b2e4d[0x0][_0x5b3105(0x154)]==_0x5b3105(0x144))var _0x5bb72f=users[_0x5b3105(0x144)];else{if(_0x1b2e4d[0x0][_0x5b3105(0x154)]==_0x5b3105(0x176))var _0x5bb72f=users[_0x5b3105(0x176)];else{if(_0x1b2e4d[0x0][_0x5b3105(0x154)]==_0x5b3105(0x12e))var _0x5bb72f=users[_0x5b3105(0x17b)];else{if(_0x1b2e4d[0x0]['language']==_0x5b3105(0x17d))var _0x5bb72f=users[_0x5b3105(0x17d)];else{if(_0x1b2e4d[0x0]['language']==_0x5b3105(0x13e))var _0x5bb72f=users[_0x5b3105(0x13c)];}}}}}}}_0x37e07e[_0x5b3105(0x16c)](_0x5b3105(0x193),{'success':_0x304991[_0x5b3105(0x13b)](_0x5b3105(0x15a)),'errors':_0x304991['flash'](_0x5b3105(0x185)),'user':_0x2cf9f0,'role':_0x357808,'profile':_0x20134a,'master_shop':_0x1b2e4d,'language':_0x5bb72f,'agent_id':_0x5a2fb4[_0x5b3105(0x15b)],'payment':_0x20500f,'staff_arr':_0x5a2fb4});}catch(_0x238532){console[_0x5b3105(0x157)](_0x238532);}}),router[a0_0x40f2dd(0x12b)](a0_0x40f2dd(0x16f),auth,async(_0x11f774,_0x5599b1)=>{const _0x101dd7=a0_0x40f2dd;try{const {name:_0x439fcc,address:_0x3b3422,mobile:_0xea579a,email:_0x592343,receivable:_0x4c03b9,payable:_0x10fef2,contactperson:_0x4bf2d0,landline:_0xd4e06e,agent_id:_0x4a1446,less_percent:_0xa226ec,type_org:_0x31635c,res_address:_0x564eae,business_start_year:_0x555d5c,credit_limit:_0xdf62b5,term_pay:_0x3aa800}=_0x11f774['body'];if(typeof _0xa226ec==_0x101dd7(0x195))var _0x5c7db7=[_0x11f774[_0x101dd7(0x189)][_0x101dd7(0x190)]];else var _0x5c7db7=[..._0x11f774['body'][_0x101dd7(0x190)]];const _0x268300=_0x5c7db7[_0x101dd7(0x15d)](_0x20d56e=>{return _0x20d56e={'less':_0x20d56e};}),_0x1b94d7=new customer({'name':_0x439fcc,'address':_0x3b3422,'mobile':_0xea579a,'email':_0x592343,'receivable':_0x4c03b9,'payable':_0x10fef2,'customer_discount':_0x268300,'contactperson':_0x4bf2d0,'landline':_0xd4e06e,'agent_id':_0x4a1446,'res_address':_0x564eae,'type_organization':_0x31635c,'business_start_year':_0x555d5c,'credit_limit':_0xdf62b5,'terms_of_payments':_0x3aa800}),_0x34faf1=await _0x1b94d7[_0x101dd7(0x148)]();_0x11f774[_0x101dd7(0x13b)]('success',_0x101dd7(0x15f)),_0x5599b1['redirect'](_0x101dd7(0x19e));}catch(_0x1e2643){console['log'](_0x1e2643);}}),router[a0_0x40f2dd(0x194)](a0_0x40f2dd(0x188),auth,async(_0x146cd0,_0x2a73b5)=>{const _0x25e11f=a0_0x40f2dd;try{const {username:_0x3c19f1,email:_0x4df1e9,role:_0x1ee391}=_0x146cd0[_0x25e11f(0x138)],_0x3b89b3=_0x146cd0[_0x25e11f(0x138)],_0x54ddaf=await profile[_0x25e11f(0x155)]({'email':_0x3b89b3[_0x25e11f(0x143)]}),_0xd76f3c=await master_shop['find']();console['log']('master',_0xd76f3c);const _0x88dd6=_0x146cd0[_0x25e11f(0x14f)]['id'],_0x31c326=await customer[_0x25e11f(0x17f)](_0x88dd6);console['log'](_0x31c326);if(_0xd76f3c[0x0][_0x25e11f(0x154)]==_0x25e11f(0x18c)){var _0x56b17a=users[_0x25e11f(0x19c)];console[_0x25e11f(0x157)](_0x56b17a);}else{if(_0xd76f3c[0x0][_0x25e11f(0x154)]=='Hindi')var _0x56b17a=users[_0x25e11f(0x139)];else{if(_0xd76f3c[0x0][_0x25e11f(0x154)]==_0x25e11f(0x134))var _0x56b17a=users[_0x25e11f(0x134)];else{if(_0xd76f3c[0x0][_0x25e11f(0x154)]==_0x25e11f(0x144))var _0x56b17a=users[_0x25e11f(0x144)];else{if(_0xd76f3c[0x0][_0x25e11f(0x154)]==_0x25e11f(0x176))var _0x56b17a=users[_0x25e11f(0x176)];else{if(_0xd76f3c[0x0][_0x25e11f(0x154)]==_0x25e11f(0x12e))var _0x56b17a=users[_0x25e11f(0x17b)];else{if(_0xd76f3c[0x0][_0x25e11f(0x154)]==_0x25e11f(0x17d))var _0x56b17a=users[_0x25e11f(0x17d)];else{if(_0xd76f3c[0x0]['language']==_0x25e11f(0x13e))var _0x56b17a=users[_0x25e11f(0x13c)];}}}}}}}_0x2a73b5['render']('customer_sa',{'success':_0x146cd0['flash'](_0x25e11f(0x15a)),'errors':_0x146cd0['flash']('errors'),'role':_0x3b89b3,'profile':_0x54ddaf,'user':_0x31c326,'master_shop':_0xd76f3c,'language':_0x56b17a});}catch(_0x25baae){console['log'](_0x25baae);}}),router[a0_0x40f2dd(0x12b)](a0_0x40f2dd(0x188),auth,async(_0x195e82,_0x3b961e)=>{const _0x999518=a0_0x40f2dd;try{const _0x4f7fdf=_0x195e82[_0x999518(0x14f)]['id'],_0x2ee1d4=await customer[_0x999518(0x17f)](_0x4f7fdf),{name:_0x53d1c9,address:_0x2401e1,mobile:_0xeab399,email:_0x4cedd1,receivable:_0x8c8a2a,payable:_0x464095,contactperson:_0x1aba75,landline:_0x3d611b,less_percent_edit:_0x5660a6,edit_type_org:_0x194dfe,edit_res_address:_0x39851b,edit_business_start_year:_0x16c9b9,edit_credit_limit:_0x46c23f,edit_term_pay:_0x2ad79a}=_0x195e82[_0x999518(0x189)];if(typeof _0x5660a6==_0x999518(0x195))var _0x1ee684=[_0x195e82[_0x999518(0x189)]['less_percent_edit']];else var _0x1ee684=[..._0x195e82[_0x999518(0x189)][_0x999518(0x135)]];const _0x1fec1b=_0x1ee684[_0x999518(0x15d)](_0x2386cb=>{return _0x2386cb={'less':_0x2386cb};});_0x2ee1d4[_0x999518(0x184)]=_0x53d1c9,_0x2ee1d4[_0x999518(0x170)]=_0x2401e1,_0x2ee1d4[_0x999518(0x149)]=_0xeab399,_0x2ee1d4[_0x999518(0x143)]=_0x4cedd1,_0x2ee1d4[_0x999518(0x171)]=_0x8c8a2a,_0x2ee1d4[_0x999518(0x12a)]=_0x464095,_0x2ee1d4['contactperson']=_0x1aba75,_0x2ee1d4[_0x999518(0x163)]=_0x3d611b,_0x2ee1d4[_0x999518(0x18f)]=_0x1fec1b,_0x2ee1d4['type_organization']=_0x194dfe,_0x2ee1d4[_0x999518(0x153)]=_0x16c9b9,_0x2ee1d4[_0x999518(0x14a)]=_0x46c23f,_0x2ee1d4['terms_of_payments']=_0x2ad79a,_0x2ee1d4['res_address']=_0x39851b;const _0x22d88d=await _0x2ee1d4[_0x999518(0x148)]();_0x195e82[_0x999518(0x13b)]('success',_0x999518(0x19d)),_0x3b961e['redirect'](_0x999518(0x19e));}catch(_0x5c86f4){console[_0x999518(0x157)](_0x5c86f4);}}),router[a0_0x40f2dd(0x194)](a0_0x40f2dd(0x17c),auth,async(_0x160468,_0x4d461e)=>{const _0x13acaf=a0_0x40f2dd;try{const {username:_0x4e308a,email:_0x41004a,role:_0x7321da}=_0x160468['user'],_0x16acdd=_0x160468['user'],_0x3abb34=await profile['findOne']({'email':_0x16acdd['email']}),_0x35859e=await master_shop[_0x13acaf(0x130)]();console['log'](_0x13acaf(0x172),_0x35859e),console[_0x13acaf(0x157)](_0x160468[_0x13acaf(0x14f)]['id']);const _0x2594e3=await customer[_0x13acaf(0x155)]({'_id':_0x160468['params']['id']});console[_0x13acaf(0x157)](_0x13acaf(0x14d),_0x2594e3);const _0x2d979e=await c_payment_data[_0x13acaf(0x130)]({'customer':_0x2594e3['name']});console[_0x13acaf(0x157)](_0x2d979e);const _0x397026=await c_payment_data['aggregate']([{'$match':{'customer':_0x2594e3['name']}},{'$match':{'reason':'Sale'}},{'$group':{'_id':_0x13acaf(0x192),'sum':{'$sum':_0x13acaf(0x13a)}}}]);console['log']('payable_sum',_0x397026);const _0x5b764c=await c_payment_data['aggregate']([{'$match':{'customer':_0x2594e3['name']}},{'$match':{'reason':_0x13acaf(0x137)}},{'$group':{'_id':_0x13acaf(0x192),'sum':{'$sum':'$amount'}}}]);console['log'](_0x13acaf(0x14c),_0x5b764c);if(_0x35859e[0x0][_0x13acaf(0x154)]=='English\x20(US)'){var _0x12316e=users[_0x13acaf(0x19c)];console[_0x13acaf(0x157)](_0x12316e);}else{if(_0x35859e[0x0][_0x13acaf(0x154)]==_0x13acaf(0x139))var _0x12316e=users[_0x13acaf(0x139)];else{if(_0x35859e[0x0][_0x13acaf(0x154)]==_0x13acaf(0x134))var _0x12316e=users['German'];else{if(_0x35859e[0x0][_0x13acaf(0x154)]==_0x13acaf(0x144))var _0x12316e=users[_0x13acaf(0x144)];else{if(_0x35859e[0x0][_0x13acaf(0x154)]==_0x13acaf(0x176))var _0x12316e=users[_0x13acaf(0x176)];else{if(_0x35859e[0x0][_0x13acaf(0x154)]==_0x13acaf(0x12e))var _0x12316e=users['Portuguese'];else{if(_0x35859e[0x0]['language']==_0x13acaf(0x17d))var _0x12316e=users['Chinese'];else{if(_0x35859e[0x0]['language']==_0x13acaf(0x13e))var _0x12316e=users[_0x13acaf(0x13c)];}}}}}}}_0x4d461e['render'](_0x13acaf(0x164),{'success':_0x160468['flash'](_0x13acaf(0x15a)),'errors':_0x160468[_0x13acaf(0x13b)](_0x13acaf(0x185)),'role':_0x16acdd,'profile':_0x3abb34,'payment':_0x2d979e,'payable':_0x397026,'receivable':_0x5b764c,'master_shop':_0x35859e,'language':_0x12316e});}catch(_0x562bab){console[_0x13acaf(0x157)](_0x562bab);}}),router[a0_0x40f2dd(0x194)](a0_0x40f2dd(0x159),auth,async(_0x17fde0,_0x3ffa61)=>{const _0x58cf78=a0_0x40f2dd;try{const _0x20bd16=new excelJS['Workbook'](),_0x52d842=_0x20bd16[_0x58cf78(0x146)](_0x58cf78(0x179));return _0x52d842[_0x58cf78(0x181)]=[{'header':'ID','key':_0x58cf78(0x145),'width':0xa},{'header':'Name','key':_0x58cf78(0x19a),'width':0xa},{'header':_0x58cf78(0x141),'key':_0x58cf78(0x183),'width':0xa},{'header':_0x58cf78(0x13f),'key':'SalesmanName','width':0xa},{'header':_0x58cf78(0x170),'key':_0x58cf78(0x170),'width':0xa},{'header':_0x58cf78(0x149),'key':_0x58cf78(0x149),'width':0xa},{'header':_0x58cf78(0x143),'key':_0x58cf78(0x143),'width':0xa}],_0x3ffa61[_0x58cf78(0x182)](_0x58cf78(0x15c),_0x58cf78(0x177)),_0x3ffa61['setHeader'](_0x58cf78(0x199),'attachment;\x20filename=customer_Migration_File.xlsx'),_0x20bd16[_0x58cf78(0x158)]['write'](_0x3ffa61)[_0x58cf78(0x191)](()=>{const _0x1ef3e4=_0x58cf78;_0x3ffa61[_0x1ef3e4(0x19b)](0xc8);});}catch(_0xf7f4a3){_0x3ffa61['status'](0x190)['send']({'errors':_0xf7f4a3[_0x58cf78(0x12d)]});}});const storage1=multer[a0_0x40f2dd(0x140)]({'destination':(_0x5bc24b,_0x1f7f95,_0x409c76)=>{const _0x55fd54=a0_0x40f2dd;_0x409c76(null,_0x55fd54(0x166));},'filename':(_0x2db1e9,_0x27124f,_0x830a1)=>{const _0x1dd674=a0_0x40f2dd;_0x830a1(null,Date['now']()+_0x27124f[_0x1dd674(0x169)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x40f2dd(0x196),auth,uploadMigrate[a0_0x40f2dd(0x18b)](a0_0x40f2dd(0x156)),async(_0x39a519,_0x459190)=>{const _0x186f87=a0_0x40f2dd,_0xda7cc5=_0x39a519[_0x186f87(0x14b)][_0x186f87(0x18a)],_0x557b61=await xlsx['readFile'](_0x186f87(0x178)+_0xda7cc5);let _0x3da850=_0x557b61[_0x186f87(0x167)],_0x15c1da=xlsx[_0x186f87(0x147)][_0x186f87(0x17e)](_0x557b61[_0x186f87(0x165)][_0x3da850[0x0]]);for(const _0x22b64e of _0x15c1da){const _0x26995d=_0x22b64e['ID'],_0x34aae5=_0x22b64e['Name'],_0x5c6ab6=_0x22b64e['SalesmanCode'],_0x2c63df=_0x22b64e[_0x186f87(0x13f)],_0x168189=_0x22b64e[_0x186f87(0x170)],_0x4a36a1=_0x22b64e[_0x186f87(0x149)],_0x11a9bb=_0x22b64e[_0x186f87(0x143)];try{let _0x743302=await customer[_0x186f87(0x155)]({'name':_0x34aae5});if(!_0x743302){const _0x3b88bb=new customer({'name':_0x34aae5,'ID':_0x26995d,'SalesmanCode':_0x5c6ab6,'SalesmanName':_0x2c63df,'address':_0x168189,'mobile':_0x4a36a1,'email':_0x11a9bb});_0x743302=await _0x3b88bb[_0x186f87(0x148)](),_0x39a519[_0x186f87(0x13b)](_0x186f87(0x15a),_0x34aae5+'\x20added\x20successfully');}else _0x39a519[_0x186f87(0x13b)](_0x186f87(0x136),_0x34aae5+_0x186f87(0x12f));}catch(_0x5d3b2f){_0x459190[_0x186f87(0x19b)](0x1f4)[_0x186f87(0x16a)]({'proderror':_0x5d3b2f[_0x186f87(0x12d)],'aproduct':ProductName});}}_0x459190[_0x186f87(0x18d)](_0x186f87(0x19e));}),module['exports']=router;function a0_0x26c2(){const _0x552ace=['utils','save','mobile','credit_limit','file','receivable_sum','customer_data','18uMcnQc','params','../models/all_models','c_payments','exceljs','business_start_year','language','findOne','customer_product_fule','log','xlsx','/products_export_migrate_file','success','_id','Content-Type','map','4559349sNUOtx','customer\x20add\x20successfully','multer','Sale','207028ZkLoHV','landline','customer_payment','Sheets','public/Migration','SheetNames','customer','originalname','json','amount','render','sale_return','1433420QiPMLa','/view','address','receivable','master','customer_docs','10188jjhnrg','element','French','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','public/Migration/','Customers','3571352CUERJw','Portuguese','/view/payment/:id','Chinese','sheet_to_json','findById','forEach','columns','setHeader','PUnits','name','errors','6nKPMfM','3301529QKFSSI','/view/:id','body','filename','single','English\x20(US)','redirect','aggregate','customer_discount','less_percent','then','$reason','customer_sa','get','string','/customer_import_migrate_file','Router','data','Content-Disposition','PBrands','status','English','customer\x20update\x20successfully','/customer_sa/view','69878COubrn','41371cAwvNe','payable','post','valueOf','message','Portuguese\x20(BR)','\x20Failed','find','express','125OOGbIM','../public/language/languages.json','German','less_percent_edit','error','Sale\x20Return','user','Hindi','$amount','flash','Arabic','21QohwMp','Arabic\x20(ae)','SalesmanName','diskStorage','SalesmanCode','../middleware/auth','email','Spanish','PName','addWorksheet'];a0_0x26c2=function(){return _0x552ace;};return a0_0x26c2();}