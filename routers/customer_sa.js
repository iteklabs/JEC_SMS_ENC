function a0_0x5d12(_0x241147,_0x484fd5){const _0x43aed1=a0_0x43ae();return a0_0x5d12=function(_0x5d1219,_0x40cfc3){_0x5d1219=_0x5d1219-0x172;let _0x1c5f34=_0x43aed1[_0x5d1219];return _0x1c5f34;},a0_0x5d12(_0x241147,_0x484fd5);}const a0_0x4bb344=a0_0x5d12;function a0_0x43ae(){const _0x575e30=['/view/payment/:id','Name','name','less_percent_edit','success','customer_docs','/view/:id','PUnits','sheet_to_json','SalesmanName','$reason','/products_export_migrate_file','save','errors','terms_of_payments','../models/all_models','Portuguese','customer\x20update\x20successfully','findById','customer_payment','receivable_sum','public/Migration/','Content-Type','contactperson','/view','exports','/customer_sa/view','json','setHeader','string','readFile','addWorksheet','../middleware/auth','Sale','xlsx','findOne','params','columns','Arabic\x20(ae)','status','originalname','Content-Disposition','Chinese','language','reason','amount','180817xgtcVC','_id','PBrands','Arabic','exceljs','landline','utils','SalesmanCode','address','flash','post','English\x20(US)','body','$amount','error','English','multer','Spanish','French','233584TCJDBx','5549880EPpcVt','redirect','type_organization','customer_data','customer_product_fule','master','message','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','less_percent','1493985nYkYOh','map','Workbook','filename','log','Hindi','German','customer_discount','Portuguese\x20(BR)','single','email','PName','forEach','../public/language/languages.json','Sheets','mobile','write','valueOf','payable_sum','file','user','customer_sa','sale_return','1080883UitXMm','919878SSFHdF','2546244IzrHaS','/customer_import_migrate_file','customer','render','diskStorage','get','find','public/Migration','send','\x20Failed','Customers','aggregate'];a0_0x43ae=function(){return _0x575e30;};return a0_0x43ae();}(function(_0x344d20,_0x3a6d62){const _0x580533=a0_0x5d12,_0x532767=_0x344d20();while(!![]){try{const _0x56c6dc=-parseInt(_0x580533(0x1c8))/0x1+-parseInt(_0x580533(0x1c9))/0x2+parseInt(_0x580533(0x1b1))/0x3+parseInt(_0x580533(0x1a7))/0x4+parseInt(_0x580533(0x1a8))/0x5+parseInt(_0x580533(0x1ca))/0x6+parseInt(_0x580533(0x194))/0x7;if(_0x56c6dc===_0x3a6d62)break;else _0x532767['push'](_0x532767['shift']());}catch(_0x89adac){_0x532767['push'](_0x532767['shift']());}}}(a0_0x43ae,0x8c906));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x4bb344(0x175)),auth=require(a0_0x4bb344(0x186)),users=require(a0_0x4bb344(0x1be)),excelJS=require(a0_0x4bb344(0x198)),xlsx=require(a0_0x4bb344(0x188)),multer=require(a0_0x4bb344(0x1a4));router['get'](a0_0x4bb344(0x17e),auth,async(_0x5d348a,_0x1cde39)=>{const _0xa79907=a0_0x4bb344;try{const {username:_0x41ebe9,email:_0x56254f,role:_0x2ac25e}=_0x5d348a[_0xa79907(0x1c5)],_0x1c4852=_0x5d348a[_0xa79907(0x1c5)],_0x3e761d=await profile[_0xa79907(0x189)]({'email':_0x1c4852['email']}),_0x12f8d4=await master_shop[_0xa79907(0x1d0)](),_0x566c05=await staff[_0xa79907(0x189)]({'email':_0x1c4852[_0xa79907(0x1bb)]}),_0x3418df=await customer[_0xa79907(0x1d0)]({'agent_id':_0x566c05[_0xa79907(0x195)]}),_0x1f48f0=await customer['aggregate']([{'$match':{'agent_id':_0x566c05[_0xa79907(0x195)][_0xa79907(0x1c2)]()}},{'$lookup':{'from':'c_payments','localField':_0xa79907(0x1d8),'foreignField':_0xa79907(0x1cc),'as':_0xa79907(0x1db)}}]),_0x294fa2=_0x1f48f0[_0xa79907(0x1b2)](_0x3ce9f9=>{const _0x2f564c=_0xa79907;console[_0x2f564c(0x1b5)]('data',_0x3ce9f9);var _0x2b8ad6=0x0,_0x19c24b=0x0;return _0x3ce9f9[_0x2f564c(0x1db)][_0x2f564c(0x1bd)](_0x2f0cb1=>{const _0x3dff48=_0x2f564c;console[_0x3dff48(0x1b5)]('element',_0x2f0cb1),_0x2f0cb1[_0x3dff48(0x192)]==_0x3dff48(0x187)?_0x2b8ad6+=_0x2f0cb1[_0x3dff48(0x193)]:_0x19c24b+=_0x2f0cb1['amount'];}),_0x3ce9f9['sale']=parseFloat(_0x2b8ad6)+0x0,_0x3ce9f9[_0x2f564c(0x1c7)]=parseFloat(_0x19c24b)+0x0,_0x3ce9f9;});if(_0x12f8d4[0x0]['language']==_0xa79907(0x19f)){var _0x40d2db=users[_0xa79907(0x1a3)];console[_0xa79907(0x1b5)](_0x40d2db);}else{if(_0x12f8d4[0x0][_0xa79907(0x191)]=='Hindi')var _0x40d2db=users[_0xa79907(0x1b6)];else{if(_0x12f8d4[0x0][_0xa79907(0x191)]==_0xa79907(0x1b7))var _0x40d2db=users[_0xa79907(0x1b7)];else{if(_0x12f8d4[0x0][_0xa79907(0x191)]=='Spanish')var _0x40d2db=users[_0xa79907(0x1a5)];else{if(_0x12f8d4[0x0][_0xa79907(0x191)]==_0xa79907(0x1a6))var _0x40d2db=users['French'];else{if(_0x12f8d4[0x0]['language']==_0xa79907(0x1b9))var _0x40d2db=users['Portuguese'];else{if(_0x12f8d4[0x0][_0xa79907(0x191)]==_0xa79907(0x190))var _0x40d2db=users[_0xa79907(0x190)];else{if(_0x12f8d4[0x0]['language']==_0xa79907(0x18c))var _0x40d2db=users[_0xa79907(0x197)];}}}}}}}_0x1cde39[_0xa79907(0x1cd)](_0xa79907(0x1c6),{'success':_0x5d348a['flash'](_0xa79907(0x1da)),'errors':_0x5d348a[_0xa79907(0x19d)]('errors'),'user':_0x3418df,'role':_0x1c4852,'profile':_0x3e761d,'master_shop':_0x12f8d4,'language':_0x40d2db,'agent_id':_0x566c05[_0xa79907(0x195)],'payment':_0x294fa2,'staff_arr':_0x566c05});}catch(_0x538ea1){console[_0xa79907(0x1b5)](_0x538ea1);}}),router[a0_0x4bb344(0x19e)]('/view',auth,async(_0x4ce9ae,_0x17bc14)=>{const _0x529ed1=a0_0x4bb344;try{const {name:_0x1c23c3,address:_0x34724a,mobile:_0x242d44,email:_0x4cd19c,receivable:_0xaf6e45,payable:_0x4ecbda,contactperson:_0x3ac880,landline:_0xf7e3e3,agent_id:_0x2fb80d,less_percent:_0x4558c0,type_org:_0xcce85a,res_address:_0x456611,business_start_year:_0xd05423,credit_limit:_0x3f280b,term_pay:_0x20d8a0}=_0x4ce9ae[_0x529ed1(0x1a0)];if(typeof _0x4558c0=='string')var _0x34f81e=[_0x4ce9ae['body'][_0x529ed1(0x1b0)]];else var _0x34f81e=[..._0x4ce9ae[_0x529ed1(0x1a0)]['less_percent']];const _0x1b6f2b=_0x34f81e[_0x529ed1(0x1b2)](_0x2b2ab3=>{return _0x2b2ab3={'less':_0x2b2ab3};}),_0x128ffb=new customer({'name':_0x1c23c3,'address':_0x34724a,'mobile':_0x242d44,'email':_0x4cd19c,'receivable':_0xaf6e45,'payable':_0x4ecbda,'customer_discount':_0x1b6f2b,'contactperson':_0x3ac880,'landline':_0xf7e3e3,'agent_id':_0x2fb80d,'res_address':_0x456611,'type_organization':_0xcce85a,'business_start_year':_0xd05423,'credit_limit':_0x3f280b,'terms_of_payments':_0x20d8a0}),_0x522da4=await _0x128ffb[_0x529ed1(0x172)]();_0x4ce9ae[_0x529ed1(0x19d)](_0x529ed1(0x1da),'customer\x20add\x20successfully'),_0x17bc14[_0x529ed1(0x1a9)](_0x529ed1(0x180));}catch(_0x3124e0){console[_0x529ed1(0x1b5)](_0x3124e0);}}),router[a0_0x4bb344(0x1cf)](a0_0x4bb344(0x1dc),auth,async(_0x55ec82,_0x442542)=>{const _0x1a3a79=a0_0x4bb344;try{const {username:_0x1e2c5a,email:_0x10d54c,role:_0x41b2b8}=_0x55ec82['user'],_0x52c6f1=_0x55ec82[_0x1a3a79(0x1c5)],_0x3dd0ea=await profile[_0x1a3a79(0x189)]({'email':_0x52c6f1[_0x1a3a79(0x1bb)]}),_0x404582=await master_shop[_0x1a3a79(0x1d0)]();console[_0x1a3a79(0x1b5)](_0x1a3a79(0x1ad),_0x404582);const _0x449132=_0x55ec82['params']['id'],_0x2854c9=await customer[_0x1a3a79(0x178)](_0x449132);console[_0x1a3a79(0x1b5)](_0x2854c9);if(_0x404582[0x0][_0x1a3a79(0x191)]==_0x1a3a79(0x19f)){var _0x2c1892=users[_0x1a3a79(0x1a3)];console[_0x1a3a79(0x1b5)](_0x2c1892);}else{if(_0x404582[0x0]['language']==_0x1a3a79(0x1b6))var _0x2c1892=users[_0x1a3a79(0x1b6)];else{if(_0x404582[0x0][_0x1a3a79(0x191)]==_0x1a3a79(0x1b7))var _0x2c1892=users[_0x1a3a79(0x1b7)];else{if(_0x404582[0x0]['language']==_0x1a3a79(0x1a5))var _0x2c1892=users[_0x1a3a79(0x1a5)];else{if(_0x404582[0x0][_0x1a3a79(0x191)]==_0x1a3a79(0x1a6))var _0x2c1892=users[_0x1a3a79(0x1a6)];else{if(_0x404582[0x0]['language']==_0x1a3a79(0x1b9))var _0x2c1892=users[_0x1a3a79(0x176)];else{if(_0x404582[0x0]['language']=='Chinese')var _0x2c1892=users[_0x1a3a79(0x190)];else{if(_0x404582[0x0]['language']==_0x1a3a79(0x18c))var _0x2c1892=users[_0x1a3a79(0x197)];}}}}}}}_0x442542[_0x1a3a79(0x1cd)](_0x1a3a79(0x1c6),{'success':_0x55ec82[_0x1a3a79(0x19d)](_0x1a3a79(0x1da)),'errors':_0x55ec82[_0x1a3a79(0x19d)](_0x1a3a79(0x173)),'role':_0x52c6f1,'profile':_0x3dd0ea,'user':_0x2854c9,'master_shop':_0x404582,'language':_0x2c1892});}catch(_0x5a49b6){console[_0x1a3a79(0x1b5)](_0x5a49b6);}}),router[a0_0x4bb344(0x19e)]('/view/:id',auth,async(_0xe647d1,_0x174b32)=>{const _0x8a01b=a0_0x4bb344;try{const _0x3c4377=_0xe647d1[_0x8a01b(0x18a)]['id'],_0x29a638=await customer[_0x8a01b(0x178)](_0x3c4377),{name:_0x5460f1,address:_0x5568e6,mobile:_0x43774f,email:_0xd4b123,receivable:_0x445c3a,payable:_0x560cae,contactperson:_0x428ecc,landline:_0x501969,less_percent_edit:_0x1c0512,edit_type_org:_0x9ec4d6,edit_res_address:_0x356d11,edit_business_start_year:_0x2b9136,edit_credit_limit:_0x5611f0,edit_term_pay:_0x52cbcf}=_0xe647d1[_0x8a01b(0x1a0)];if(typeof _0x1c0512==_0x8a01b(0x183))var _0x2f66fc=[_0xe647d1[_0x8a01b(0x1a0)][_0x8a01b(0x1d9)]];else var _0x2f66fc=[..._0xe647d1['body'][_0x8a01b(0x1d9)]];const _0x3cea4d=_0x2f66fc[_0x8a01b(0x1b2)](_0x3d9a96=>{return _0x3d9a96={'less':_0x3d9a96};});_0x29a638[_0x8a01b(0x1d8)]=_0x5460f1,_0x29a638['address']=_0x5568e6,_0x29a638['mobile']=_0x43774f,_0x29a638[_0x8a01b(0x1bb)]=_0xd4b123,_0x29a638['receivable']=_0x445c3a,_0x29a638['payable']=_0x560cae,_0x29a638[_0x8a01b(0x17d)]=_0x428ecc,_0x29a638[_0x8a01b(0x199)]=_0x501969,_0x29a638[_0x8a01b(0x1b8)]=_0x3cea4d,_0x29a638[_0x8a01b(0x1aa)]=_0x9ec4d6,_0x29a638['business_start_year']=_0x2b9136,_0x29a638['credit_limit']=_0x5611f0,_0x29a638[_0x8a01b(0x174)]=_0x52cbcf,_0x29a638['res_address']=_0x356d11;const _0x1337c6=await _0x29a638[_0x8a01b(0x172)]();_0xe647d1[_0x8a01b(0x19d)](_0x8a01b(0x1da),_0x8a01b(0x177)),_0x174b32[_0x8a01b(0x1a9)]('/customer_sa/view');}catch(_0x57a653){console[_0x8a01b(0x1b5)](_0x57a653);}}),router[a0_0x4bb344(0x1cf)](a0_0x4bb344(0x1d6),auth,async(_0x48f719,_0x20facf)=>{const _0x11b73f=a0_0x4bb344;try{const {username:_0x67a3cf,email:_0x5af0ed,role:_0x2de7df}=_0x48f719[_0x11b73f(0x1c5)],_0x31ae4d=_0x48f719['user'],_0x1f7466=await profile['findOne']({'email':_0x31ae4d['email']}),_0x3f1ae6=await master_shop['find']();console[_0x11b73f(0x1b5)](_0x11b73f(0x1ad),_0x3f1ae6),console[_0x11b73f(0x1b5)](_0x48f719[_0x11b73f(0x18a)]['id']);const _0x35b747=await customer[_0x11b73f(0x189)]({'_id':_0x48f719[_0x11b73f(0x18a)]['id']});console[_0x11b73f(0x1b5)](_0x11b73f(0x1ab),_0x35b747);const _0x2e542d=await c_payment_data['find']({'customer':_0x35b747['name']});console['log'](_0x2e542d);const _0x124786=await c_payment_data[_0x11b73f(0x1d5)]([{'$match':{'customer':_0x35b747['name']}},{'$match':{'reason':_0x11b73f(0x187)}},{'$group':{'_id':_0x11b73f(0x1e0),'sum':{'$sum':_0x11b73f(0x1a1)}}}]);console[_0x11b73f(0x1b5)](_0x11b73f(0x1c3),_0x124786);const _0x28cd35=await c_payment_data[_0x11b73f(0x1d5)]([{'$match':{'customer':_0x35b747['name']}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x11b73f(0x1a1)}}}]);console[_0x11b73f(0x1b5)](_0x11b73f(0x17a),_0x28cd35);if(_0x3f1ae6[0x0][_0x11b73f(0x191)]==_0x11b73f(0x19f)){var _0x22ec07=users['English'];console[_0x11b73f(0x1b5)](_0x22ec07);}else{if(_0x3f1ae6[0x0][_0x11b73f(0x191)]==_0x11b73f(0x1b6))var _0x22ec07=users[_0x11b73f(0x1b6)];else{if(_0x3f1ae6[0x0][_0x11b73f(0x191)]==_0x11b73f(0x1b7))var _0x22ec07=users[_0x11b73f(0x1b7)];else{if(_0x3f1ae6[0x0]['language']==_0x11b73f(0x1a5))var _0x22ec07=users['Spanish'];else{if(_0x3f1ae6[0x0][_0x11b73f(0x191)]==_0x11b73f(0x1a6))var _0x22ec07=users[_0x11b73f(0x1a6)];else{if(_0x3f1ae6[0x0]['language']=='Portuguese\x20(BR)')var _0x22ec07=users['Portuguese'];else{if(_0x3f1ae6[0x0][_0x11b73f(0x191)]=='Chinese')var _0x22ec07=users['Chinese'];else{if(_0x3f1ae6[0x0][_0x11b73f(0x191)]=='Arabic\x20(ae)')var _0x22ec07=users['Arabic'];}}}}}}}_0x20facf[_0x11b73f(0x1cd)](_0x11b73f(0x179),{'success':_0x48f719[_0x11b73f(0x19d)](_0x11b73f(0x1da)),'errors':_0x48f719[_0x11b73f(0x19d)](_0x11b73f(0x173)),'role':_0x31ae4d,'profile':_0x1f7466,'payment':_0x2e542d,'payable':_0x124786,'receivable':_0x28cd35,'master_shop':_0x3f1ae6,'language':_0x22ec07});}catch(_0x21ddf6){console[_0x11b73f(0x1b5)](_0x21ddf6);}}),router[a0_0x4bb344(0x1cf)](a0_0x4bb344(0x1e1),auth,async(_0x22a573,_0x4c17bd)=>{const _0x24672f=a0_0x4bb344;try{const _0x51dfc3=new excelJS[(_0x24672f(0x1b3))](),_0x13a265=_0x51dfc3[_0x24672f(0x185)](_0x24672f(0x1d4));return _0x13a265[_0x24672f(0x18b)]=[{'header':'ID','key':_0x24672f(0x1bc),'width':0xa},{'header':_0x24672f(0x1d7),'key':_0x24672f(0x196),'width':0xa},{'header':_0x24672f(0x19b),'key':_0x24672f(0x1dd),'width':0xa},{'header':'SalesmanName','key':_0x24672f(0x1df),'width':0xa},{'header':_0x24672f(0x19c),'key':'address','width':0xa},{'header':_0x24672f(0x1c0),'key':_0x24672f(0x1c0),'width':0xa},{'header':_0x24672f(0x1bb),'key':_0x24672f(0x1bb),'width':0xa}],_0x4c17bd[_0x24672f(0x182)](_0x24672f(0x17c),_0x24672f(0x1af)),_0x4c17bd['setHeader'](_0x24672f(0x18f),'attachment;\x20filename=customer_Migration_File.xlsx'),_0x51dfc3[_0x24672f(0x188)][_0x24672f(0x1c1)](_0x4c17bd)['then'](()=>{_0x4c17bd['status'](0xc8);});}catch(_0x59fc3f){_0x4c17bd[_0x24672f(0x18d)](0x190)[_0x24672f(0x1d2)]({'errors':_0x59fc3f[_0x24672f(0x1ae)]});}});const storage1=multer[a0_0x4bb344(0x1ce)]({'destination':(_0x40b08b,_0x48857a,_0x4bf21e)=>{const _0x50d3cb=a0_0x4bb344;_0x4bf21e(null,_0x50d3cb(0x1d1));},'filename':(_0x5baf8b,_0x5d854d,_0x248d26)=>{const _0x5d2d02=a0_0x4bb344;_0x248d26(null,Date['now']()+_0x5d854d[_0x5d2d02(0x18e)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x4bb344(0x1cb),auth,uploadMigrate[a0_0x4bb344(0x1ba)](a0_0x4bb344(0x1ac)),async(_0x4c6058,_0x15f128)=>{const _0x5ddf5f=a0_0x4bb344,_0x191bb7=_0x4c6058[_0x5ddf5f(0x1c4)][_0x5ddf5f(0x1b4)],_0x7a5c90=await xlsx[_0x5ddf5f(0x184)](_0x5ddf5f(0x17b)+_0x191bb7);let _0x1e042c=_0x7a5c90['SheetNames'],_0x360974=xlsx[_0x5ddf5f(0x19a)][_0x5ddf5f(0x1de)](_0x7a5c90[_0x5ddf5f(0x1bf)][_0x1e042c[0x0]]);for(const _0x3c87b4 of _0x360974){const _0xff3959=_0x3c87b4['ID'],_0x1c02bd=_0x3c87b4['Name'],_0x2782f3=_0x3c87b4[_0x5ddf5f(0x19b)],_0xaa4815=_0x3c87b4['SalesmanName'],_0x4e1eb7=_0x3c87b4['address'],_0x3c6a03=_0x3c87b4['mobile'],_0x291c05=_0x3c87b4[_0x5ddf5f(0x1bb)];try{let _0xd6b834=await customer['findOne']({'name':_0x1c02bd});if(!_0xd6b834){const _0xa31da7=new customer({'name':_0x1c02bd,'ID':_0xff3959,'SalesmanCode':_0x2782f3,'SalesmanName':_0xaa4815,'address':_0x4e1eb7,'mobile':_0x3c6a03,'email':_0x291c05});_0xd6b834=await _0xa31da7[_0x5ddf5f(0x172)](),_0x4c6058[_0x5ddf5f(0x19d)]('success',_0x1c02bd+'\x20added\x20successfully');}else _0x4c6058[_0x5ddf5f(0x19d)](_0x5ddf5f(0x1a2),_0x1c02bd+_0x5ddf5f(0x1d3));}catch(_0x2ccbdd){_0x15f128['status'](0x1f4)[_0x5ddf5f(0x181)]({'proderror':_0x2ccbdd[_0x5ddf5f(0x1ae)],'aproduct':ProductName});}}_0x15f128[_0x5ddf5f(0x1a9)](_0x5ddf5f(0x180));}),module[a0_0x4bb344(0x17f)]=router;