function a0_0x1c37(_0x10780f,_0xcb2253){const _0x4d2730=a0_0x4d27();return a0_0x1c37=function(_0x1c37c2,_0x393da5){_0x1c37c2=_0x1c37c2-0x12a;let _0x159286=_0x4d2730[_0x1c37c2];return _0x159286;},a0_0x1c37(_0x10780f,_0xcb2253);}const a0_0x1ef1c5=a0_0x1c37;(function(_0x1ce7e4,_0x215266){const _0x56fd23=a0_0x1c37,_0x1b290c=_0x1ce7e4();while(!![]){try{const _0x4ac16c=-parseInt(_0x56fd23(0x152))/0x1*(-parseInt(_0x56fd23(0x186))/0x2)+-parseInt(_0x56fd23(0x158))/0x3+parseInt(_0x56fd23(0x16c))/0x4*(parseInt(_0x56fd23(0x130))/0x5)+parseInt(_0x56fd23(0x13e))/0x6*(-parseInt(_0x56fd23(0x15b))/0x7)+-parseInt(_0x56fd23(0x17e))/0x8*(parseInt(_0x56fd23(0x13a))/0x9)+parseInt(_0x56fd23(0x12f))/0xa*(parseInt(_0x56fd23(0x13d))/0xb)+parseInt(_0x56fd23(0x134))/0xc*(parseInt(_0x56fd23(0x189))/0xd);if(_0x4ac16c===_0x215266)break;else _0x1b290c['push'](_0x1b290c['shift']());}catch(_0x276d9d){_0x1b290c['push'](_0x1b290c['shift']());}}}(a0_0x4d27,0x67acd));const express=require(a0_0x1ef1c5(0x167)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require(a0_0x1ef1c5(0x18f)),users=require(a0_0x1ef1c5(0x174)),excelJS=require(a0_0x1ef1c5(0x182)),xlsx=require(a0_0x1ef1c5(0x185)),multer=require(a0_0x1ef1c5(0x131));router['get'](a0_0x1ef1c5(0x170),auth,async(_0x188477,_0x17067d)=>{const _0x27c764=a0_0x1ef1c5;try{const {username:_0x353051,email:_0x218d29,role:_0x3f9826}=_0x188477[_0x27c764(0x136)],_0x233447=_0x188477[_0x27c764(0x136)],_0x239150=await profile[_0x27c764(0x188)]({'email':_0x233447[_0x27c764(0x12d)]}),_0x52337e=await master_shop[_0x27c764(0x132)](),_0x2ae5c6=await staff['findOne']({'email':_0x233447[_0x27c764(0x12d)]}),_0x498f84=await customer['find']({'agent_id':_0x2ae5c6[_0x27c764(0x19c)]}),_0xf681e3=await customer[_0x27c764(0x155)]([{'$match':{'agent_id':_0x2ae5c6['_id'][_0x27c764(0x15a)]()}},{'$lookup':{'from':'c_payments','localField':_0x27c764(0x13c),'foreignField':_0x27c764(0x13b),'as':_0x27c764(0x187)}}]),_0x29a760=_0xf681e3['map'](_0xae7b1e=>{const _0x9e56b=_0x27c764;console['log'](_0x9e56b(0x164),_0xae7b1e);var _0x4465ea=0x0,_0x197ed8=0x0;return _0xae7b1e[_0x9e56b(0x187)][_0x9e56b(0x148)](_0x1bf35e=>{const _0x3bb761=_0x9e56b;console[_0x3bb761(0x190)](_0x3bb761(0x16e),_0x1bf35e),_0x1bf35e['reason']==_0x3bb761(0x17c)?_0x4465ea+=_0x1bf35e[_0x3bb761(0x16f)]:_0x197ed8+=_0x1bf35e[_0x3bb761(0x16f)];}),_0xae7b1e['sale']=parseFloat(_0x4465ea)+0x0,_0xae7b1e[_0x9e56b(0x16a)]=parseFloat(_0x197ed8)+0x0,_0xae7b1e;});if(_0x52337e[0x0][_0x27c764(0x14f)]==_0x27c764(0x160)){var _0x3387d7=users['English'];console['log'](_0x3387d7);}else{if(_0x52337e[0x0][_0x27c764(0x14f)]==_0x27c764(0x18c))var _0x3387d7=users[_0x27c764(0x18c)];else{if(_0x52337e[0x0][_0x27c764(0x14f)]==_0x27c764(0x179))var _0x3387d7=users[_0x27c764(0x179)];else{if(_0x52337e[0x0][_0x27c764(0x14f)]==_0x27c764(0x138))var _0x3387d7=users[_0x27c764(0x138)];else{if(_0x52337e[0x0]['language']==_0x27c764(0x191))var _0x3387d7=users['French'];else{if(_0x52337e[0x0]['language']=='Portuguese\x20(BR)')var _0x3387d7=users[_0x27c764(0x18a)];else{if(_0x52337e[0x0]['language']=='Chinese')var _0x3387d7=users['Chinese'];else{if(_0x52337e[0x0][_0x27c764(0x14f)]==_0x27c764(0x133))var _0x3387d7=users[_0x27c764(0x140)];}}}}}}}_0x17067d[_0x27c764(0x18b)](_0x27c764(0x196),{'success':_0x188477[_0x27c764(0x154)](_0x27c764(0x19a)),'errors':_0x188477[_0x27c764(0x154)](_0x27c764(0x15c)),'user':_0x498f84,'role':_0x233447,'profile':_0x239150,'master_shop':_0x52337e,'language':_0x3387d7,'agent_id':_0x2ae5c6[_0x27c764(0x19c)],'payment':_0x29a760,'staff_arr':_0x2ae5c6});}catch(_0x2c1087){console[_0x27c764(0x190)](_0x2c1087);}}),router[a0_0x1ef1c5(0x17a)]('/view',auth,async(_0x4f2537,_0x3617d9)=>{const _0x455cc4=a0_0x1ef1c5;try{const {name:_0xb82866,address:_0x53b08a,mobile:_0x4768d9,email:_0x36289e,receivable:_0x59bb63,payable:_0x1d30ca,contactperson:_0x15c415,landline:_0x238e17,agent_id:_0x4fec64,less_percent:_0x2e4ce3,type_org:_0x43e533,res_address:_0x58dffa,business_start_year:_0x5616be,credit_limit:_0x214695,term_pay:_0x2c1ed8}=_0x4f2537[_0x455cc4(0x14e)];if(typeof _0x2e4ce3==_0x455cc4(0x198))var _0x2a9de7=[_0x4f2537['body'][_0x455cc4(0x12c)]];else var _0x2a9de7=[..._0x4f2537['body'][_0x455cc4(0x12c)]];const _0xa70773=_0x2a9de7[_0x455cc4(0x176)](_0x5d7005=>{return _0x5d7005={'less':_0x5d7005};}),_0x250f21=new customer({'name':_0xb82866,'address':_0x53b08a,'mobile':_0x4768d9,'email':_0x36289e,'receivable':_0x59bb63,'payable':_0x1d30ca,'customer_discount':_0xa70773,'contactperson':_0x15c415,'landline':_0x238e17,'agent_id':_0x4fec64,'res_address':_0x58dffa,'type_organization':_0x43e533,'business_start_year':_0x5616be,'credit_limit':_0x214695,'terms_of_payments':_0x2c1ed8}),_0x2ddb4b=await _0x250f21[_0x455cc4(0x183)]();_0x4f2537[_0x455cc4(0x154)]('success',_0x455cc4(0x161)),_0x3617d9['redirect'](_0x455cc4(0x163));}catch(_0x5882ee){console[_0x455cc4(0x190)](_0x5882ee);}}),router[a0_0x1ef1c5(0x139)]('/view/:id',auth,async(_0xe84131,_0x66e026)=>{const _0x1a4a84=a0_0x1ef1c5;try{const {username:_0x3e8533,email:_0x3fc3dc,role:_0x49f87d}=_0xe84131[_0x1a4a84(0x136)],_0x316fc5=_0xe84131['user'],_0x307d1b=await profile[_0x1a4a84(0x188)]({'email':_0x316fc5[_0x1a4a84(0x12d)]}),_0x1cc896=await master_shop['find']();console['log'](_0x1a4a84(0x193),_0x1cc896);const _0x4c4f62=_0xe84131[_0x1a4a84(0x144)]['id'],_0x399ceb=await customer[_0x1a4a84(0x169)](_0x4c4f62);console[_0x1a4a84(0x190)](_0x399ceb);if(_0x1cc896[0x0][_0x1a4a84(0x14f)]=='English\x20(US)'){var _0x3d96e0=users['English'];console[_0x1a4a84(0x190)](_0x3d96e0);}else{if(_0x1cc896[0x0]['language']=='Hindi')var _0x3d96e0=users['Hindi'];else{if(_0x1cc896[0x0][_0x1a4a84(0x14f)]==_0x1a4a84(0x179))var _0x3d96e0=users[_0x1a4a84(0x179)];else{if(_0x1cc896[0x0][_0x1a4a84(0x14f)]=='Spanish')var _0x3d96e0=users[_0x1a4a84(0x138)];else{if(_0x1cc896[0x0][_0x1a4a84(0x14f)]==_0x1a4a84(0x191))var _0x3d96e0=users['French'];else{if(_0x1cc896[0x0][_0x1a4a84(0x14f)]==_0x1a4a84(0x172))var _0x3d96e0=users[_0x1a4a84(0x18a)];else{if(_0x1cc896[0x0][_0x1a4a84(0x14f)]=='Chinese')var _0x3d96e0=users[_0x1a4a84(0x15f)];else{if(_0x1cc896[0x0][_0x1a4a84(0x14f)]==_0x1a4a84(0x133))var _0x3d96e0=users[_0x1a4a84(0x140)];}}}}}}}_0x66e026[_0x1a4a84(0x18b)]('customer_sa',{'success':_0xe84131[_0x1a4a84(0x154)](_0x1a4a84(0x19a)),'errors':_0xe84131[_0x1a4a84(0x154)]('errors'),'role':_0x316fc5,'profile':_0x307d1b,'user':_0x399ceb,'master_shop':_0x1cc896,'language':_0x3d96e0});}catch(_0x36e366){console[_0x1a4a84(0x190)](_0x36e366);}}),router['post'](a0_0x1ef1c5(0x15e),auth,async(_0x570b15,_0x51436c)=>{const _0x266ff2=a0_0x1ef1c5;try{const _0x5ba669=_0x570b15[_0x266ff2(0x144)]['id'],_0x27eb54=await customer[_0x266ff2(0x169)](_0x5ba669),{name:_0x144350,address:_0x46aab8,mobile:_0x313bb1,email:_0x354728,receivable:_0x4c4b1e,payable:_0x4f4d41,contactperson:_0x5f4784,landline:_0x198148,less_percent_edit:_0x3e54cc,edit_type_org:_0x4a70a7,edit_res_address:_0x2dd14c,edit_business_start_year:_0x32ea65,edit_credit_limit:_0x263b04,edit_term_pay:_0x22d736}=_0x570b15['body'];if(typeof _0x3e54cc==_0x266ff2(0x198))var _0x1bf8d7=[_0x570b15[_0x266ff2(0x14e)][_0x266ff2(0x168)]];else var _0x1bf8d7=[..._0x570b15[_0x266ff2(0x14e)]['less_percent_edit']];const _0x3459af=_0x1bf8d7[_0x266ff2(0x176)](_0x3bf16f=>{return _0x3bf16f={'less':_0x3bf16f};});_0x27eb54[_0x266ff2(0x13c)]=_0x144350,_0x27eb54[_0x266ff2(0x184)]=_0x46aab8,_0x27eb54[_0x266ff2(0x159)]=_0x313bb1,_0x27eb54['email']=_0x354728,_0x27eb54[_0x266ff2(0x16b)]=_0x4c4b1e,_0x27eb54[_0x266ff2(0x177)]=_0x4f4d41,_0x27eb54[_0x266ff2(0x178)]=_0x5f4784,_0x27eb54[_0x266ff2(0x19e)]=_0x198148,_0x27eb54[_0x266ff2(0x173)]=_0x3459af,_0x27eb54[_0x266ff2(0x145)]=_0x4a70a7,_0x27eb54['business_start_year']=_0x32ea65,_0x27eb54[_0x266ff2(0x141)]=_0x263b04,_0x27eb54[_0x266ff2(0x171)]=_0x22d736,_0x27eb54[_0x266ff2(0x18e)]=_0x2dd14c;const _0x5d37b1=await _0x27eb54[_0x266ff2(0x183)]();_0x570b15[_0x266ff2(0x154)](_0x266ff2(0x19a),_0x266ff2(0x151)),_0x51436c[_0x266ff2(0x14c)](_0x266ff2(0x163));}catch(_0x4ec882){console['log'](_0x4ec882);}}),router[a0_0x1ef1c5(0x139)](a0_0x1ef1c5(0x17d),auth,async(_0x32d889,_0x4ab705)=>{const _0x20c750=a0_0x1ef1c5;try{const {username:_0x1a54d9,email:_0x434812,role:_0x23f739}=_0x32d889[_0x20c750(0x136)],_0x41d0ca=_0x32d889[_0x20c750(0x136)],_0x1beb06=await profile['findOne']({'email':_0x41d0ca[_0x20c750(0x12d)]}),_0x2db0b1=await master_shop[_0x20c750(0x132)]();console[_0x20c750(0x190)](_0x20c750(0x193),_0x2db0b1),console[_0x20c750(0x190)](_0x32d889['params']['id']);const _0x3708d8=await customer['findOne']({'_id':_0x32d889[_0x20c750(0x144)]['id']});console[_0x20c750(0x190)](_0x20c750(0x162),_0x3708d8);const _0x53560f=await c_payment_data[_0x20c750(0x132)]({'customer':_0x3708d8[_0x20c750(0x13c)]});console[_0x20c750(0x190)](_0x53560f);const _0x5433f7=await c_payment_data[_0x20c750(0x155)]([{'$match':{'customer':_0x3708d8[_0x20c750(0x13c)]}},{'$match':{'reason':'Sale'}},{'$group':{'_id':_0x20c750(0x166),'sum':{'$sum':_0x20c750(0x195)}}}]);console[_0x20c750(0x190)](_0x20c750(0x149),_0x5433f7);const _0x1cea00=await c_payment_data['aggregate']([{'$match':{'customer':_0x3708d8[_0x20c750(0x13c)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x20c750(0x166),'sum':{'$sum':_0x20c750(0x195)}}}]);console[_0x20c750(0x190)]('receivable_sum',_0x1cea00);if(_0x2db0b1[0x0][_0x20c750(0x14f)]==_0x20c750(0x160)){var _0x18177d=users[_0x20c750(0x17b)];console['log'](_0x18177d);}else{if(_0x2db0b1[0x0]['language']==_0x20c750(0x18c))var _0x18177d=users[_0x20c750(0x18c)];else{if(_0x2db0b1[0x0]['language']==_0x20c750(0x179))var _0x18177d=users['German'];else{if(_0x2db0b1[0x0]['language']==_0x20c750(0x138))var _0x18177d=users['Spanish'];else{if(_0x2db0b1[0x0][_0x20c750(0x14f)]==_0x20c750(0x191))var _0x18177d=users[_0x20c750(0x191)];else{if(_0x2db0b1[0x0][_0x20c750(0x14f)]==_0x20c750(0x172))var _0x18177d=users[_0x20c750(0x18a)];else{if(_0x2db0b1[0x0][_0x20c750(0x14f)]==_0x20c750(0x15f))var _0x18177d=users[_0x20c750(0x15f)];else{if(_0x2db0b1[0x0]['language']==_0x20c750(0x133))var _0x18177d=users[_0x20c750(0x140)];}}}}}}}_0x4ab705[_0x20c750(0x18b)]('customer_payment',{'success':_0x32d889[_0x20c750(0x154)](_0x20c750(0x19a)),'errors':_0x32d889[_0x20c750(0x154)](_0x20c750(0x15c)),'role':_0x41d0ca,'profile':_0x1beb06,'payment':_0x53560f,'payable':_0x5433f7,'receivable':_0x1cea00,'master_shop':_0x2db0b1,'language':_0x18177d});}catch(_0x210391){console[_0x20c750(0x190)](_0x210391);}}),router[a0_0x1ef1c5(0x139)]('/products_export_migrate_file',auth,async(_0x15027c,_0x25f8c5)=>{const _0x41a044=a0_0x1ef1c5;try{const _0x5c017c=new excelJS[(_0x41a044(0x19b))](),_0x19b9db=_0x5c017c[_0x41a044(0x142)](_0x41a044(0x12b));return _0x19b9db[_0x41a044(0x150)]=[{'header':'ID','key':_0x41a044(0x14d),'width':0xa},{'header':_0x41a044(0x18d),'key':_0x41a044(0x143),'width':0xa},{'header':_0x41a044(0x197),'key':'PUnits','width':0xa},{'header':_0x41a044(0x181),'key':_0x41a044(0x181),'width':0xa},{'header':_0x41a044(0x184),'key':_0x41a044(0x184),'width':0xa},{'header':_0x41a044(0x159),'key':'mobile','width':0xa},{'header':_0x41a044(0x12d),'key':_0x41a044(0x12d),'width':0xa}],_0x25f8c5[_0x41a044(0x156)](_0x41a044(0x146),_0x41a044(0x15d)),_0x25f8c5[_0x41a044(0x156)]('Content-Disposition',_0x41a044(0x19d)),_0x5c017c[_0x41a044(0x185)][_0x41a044(0x199)](_0x25f8c5)['then'](()=>{_0x25f8c5['status'](0xc8);});}catch(_0x4fb502){_0x25f8c5[_0x41a044(0x137)](0x190)['send']({'errors':_0x4fb502[_0x41a044(0x16d)]});}});function a0_0x4d27(){const _0x23cd70=['_id','attachment;\x20filename=customer_Migration_File.xlsx','landline','readFile','Customers','less_percent','email','public/Migration/','3708050UcFkaP','4075GMlZRd','multer','find','Arabic\x20(ae)','384TwmQVw','Sheets','user','status','Spanish','get','7578xShfNi','customer','name','11lILMMB','5013918HFbdKq','public/Migration','Arabic','credit_limit','addWorksheet','PBrands','params','type_organization','Content-Type','\x20Failed','forEach','payable_sum','\x20added\x20successfully','single','redirect','PName','body','language','columns','customer\x20update\x20successfully','5197VhEQBc','SheetNames','flash','aggregate','setHeader','json','2525892TRPKzw','mobile','valueOf','7wSfCii','errors','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','/view/:id','Chinese','English\x20(US)','customer\x20add\x20successfully','customer_data','/customer_sa/view','data','originalname','$reason','express','less_percent_edit','findById','sale_return','receivable','2008JdZbZa','message','element','amount','/view','terms_of_payments','Portuguese\x20(BR)','customer_discount','../public/language/languages.json','filename','map','payable','contactperson','German','post','English','Sale','/view/payment/:id','1000xHTrNA','exports','utils','SalesmanName','exceljs','save','address','xlsx','202YGYiRK','customer_docs','findOne','366717eTSdhx','Portuguese','render','Hindi','Name','res_address','../middleware/auth','log','French','file','master','diskStorage','$amount','customer_sa','SalesmanCode','string','write','success','Workbook'];a0_0x4d27=function(){return _0x23cd70;};return a0_0x4d27();}const storage1=multer[a0_0x1ef1c5(0x194)]({'destination':(_0x55cf48,_0x29950a,_0x5e748a)=>{const _0x20fc90=a0_0x1ef1c5;_0x5e748a(null,_0x20fc90(0x13f));},'filename':(_0x3843c2,_0x36dc5b,_0x2c5459)=>{const _0x244404=a0_0x1ef1c5;_0x2c5459(null,Date['now']()+_0x36dc5b[_0x244404(0x165)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x1ef1c5(0x17a)]('/customer_import_migrate_file',auth,uploadMigrate[a0_0x1ef1c5(0x14b)]('customer_product_fule'),async(_0x4c0e65,_0x58c0b2)=>{const _0x2b1ca1=a0_0x1ef1c5,_0x3d0f98=_0x4c0e65[_0x2b1ca1(0x192)][_0x2b1ca1(0x175)],_0x2c086a=await xlsx[_0x2b1ca1(0x12a)](_0x2b1ca1(0x12e)+_0x3d0f98);let _0x4913c8=_0x2c086a[_0x2b1ca1(0x153)],_0x29ee76=xlsx[_0x2b1ca1(0x180)]['sheet_to_json'](_0x2c086a[_0x2b1ca1(0x135)][_0x4913c8[0x0]]);for(const _0x29816d of _0x29ee76){const _0xad8867=_0x29816d['ID'],_0x136dce=_0x29816d[_0x2b1ca1(0x18d)],_0x6ebfbc=_0x29816d[_0x2b1ca1(0x197)],_0x469a80=_0x29816d[_0x2b1ca1(0x181)],_0x5a28f7=_0x29816d['address'],_0x244857=_0x29816d[_0x2b1ca1(0x159)],_0x1cdead=_0x29816d['email'];try{let _0x3369dc=await customer[_0x2b1ca1(0x188)]({'name':_0x136dce});if(!_0x3369dc){const _0x374e94=new customer({'name':_0x136dce,'ID':_0xad8867,'SalesmanCode':_0x6ebfbc,'SalesmanName':_0x469a80,'address':_0x5a28f7,'mobile':_0x244857,'email':_0x1cdead});_0x3369dc=await _0x374e94[_0x2b1ca1(0x183)](),_0x4c0e65[_0x2b1ca1(0x154)]('success',_0x136dce+_0x2b1ca1(0x14a));}else _0x4c0e65[_0x2b1ca1(0x154)]('error',_0x136dce+_0x2b1ca1(0x147));}catch(_0x151119){_0x58c0b2[_0x2b1ca1(0x137)](0x1f4)[_0x2b1ca1(0x157)]({'proderror':_0x151119[_0x2b1ca1(0x16d)],'aproduct':ProductName});}}_0x58c0b2[_0x2b1ca1(0x14c)](_0x2b1ca1(0x163));}),module[a0_0x1ef1c5(0x17f)]=router;