const a0_0x35658d=a0_0x7c0b;(function(_0x33b58b,_0x1ca457){const _0x215c38=a0_0x7c0b,_0x4a22da=_0x33b58b();while(!![]){try{const _0x5b0c86=-parseInt(_0x215c38(0xd1))/0x1*(-parseInt(_0x215c38(0xe7))/0x2)+-parseInt(_0x215c38(0xfa))/0x3*(-parseInt(_0x215c38(0xf9))/0x4)+-parseInt(_0x215c38(0x122))/0x5+-parseInt(_0x215c38(0xee))/0x6*(parseInt(_0x215c38(0xc4))/0x7)+-parseInt(_0x215c38(0xff))/0x8*(-parseInt(_0x215c38(0xdf))/0x9)+-parseInt(_0x215c38(0x10d))/0xa*(parseInt(_0x215c38(0xd8))/0xb)+-parseInt(_0x215c38(0xe0))/0xc*(-parseInt(_0x215c38(0x11a))/0xd);if(_0x5b0c86===_0x1ca457)break;else _0x4a22da['push'](_0x4a22da['shift']());}catch(_0x30e287){_0x4a22da['push'](_0x4a22da['shift']());}}}(a0_0x584f,0x3e516));const express=require(a0_0x35658d(0x104)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x35658d(0xfd)),auth=require(a0_0x35658d(0xd4)),users=require(a0_0x35658d(0xe3)),excelJS=require(a0_0x35658d(0xf4)),xlsx=require(a0_0x35658d(0xb1)),multer=require(a0_0x35658d(0xbb));router[a0_0x35658d(0xe8)](a0_0x35658d(0xf3),auth,async(_0x35bc47,_0x5844a9)=>{const _0x2643d3=a0_0x35658d;try{const {username:_0x4827c6,email:_0x4fd22a,role:_0x3471e2}=_0x35bc47['user'],_0x3b0c54=_0x35bc47[_0x2643d3(0x10e)],_0x5d6eb7=await profile['findOne']({'email':_0x3b0c54[_0x2643d3(0xc6)]}),_0x4f3e71=await master_shop[_0x2643d3(0xb6)](),_0x62e5bb=await staff[_0x2643d3(0xbe)]({'email':_0x3b0c54['email']}),_0x4b6495=await customer['find']({'agent_id':_0x62e5bb[_0x2643d3(0x10a)]}),_0x396b8e=await customer[_0x2643d3(0xd0)]([{'$match':{'agent_id':_0x62e5bb[_0x2643d3(0x10a)]['valueOf']()}},{'$lookup':{'from':_0x2643d3(0x11b),'localField':'name','foreignField':'customer','as':'customer_docs'}}]),_0x58805a=_0x396b8e[_0x2643d3(0xcb)](_0x1c05a7=>{const _0x11c32c=_0x2643d3;console[_0x11c32c(0xe1)]('data',_0x1c05a7);var _0xf19f1a=0x0,_0x56fdb0=0x0;return _0x1c05a7[_0x11c32c(0xdb)][_0x11c32c(0xe2)](_0x357050=>{const _0x77e4db=_0x11c32c;console[_0x77e4db(0xe1)](_0x77e4db(0xc3),_0x357050),_0x357050[_0x77e4db(0xd5)]==_0x77e4db(0xd6)?_0xf19f1a+=_0x357050[_0x77e4db(0xd7)]:_0x56fdb0+=_0x357050[_0x77e4db(0xd7)];}),_0x1c05a7[_0x11c32c(0x117)]=parseFloat(_0xf19f1a)+0x0,_0x1c05a7[_0x11c32c(0xf2)]=parseFloat(_0x56fdb0)+0x0,_0x1c05a7;});if(_0x4f3e71[0x0][_0x2643d3(0xd2)]==_0x2643d3(0xb7)){var _0x364186=users[_0x2643d3(0xb8)];console[_0x2643d3(0xe1)](_0x364186);}else{if(_0x4f3e71[0x0][_0x2643d3(0xd2)]==_0x2643d3(0x105))var _0x364186=users[_0x2643d3(0x105)];else{if(_0x4f3e71[0x0][_0x2643d3(0xd2)]==_0x2643d3(0xed))var _0x364186=users[_0x2643d3(0xed)];else{if(_0x4f3e71[0x0][_0x2643d3(0xd2)]=='Spanish')var _0x364186=users[_0x2643d3(0x123)];else{if(_0x4f3e71[0x0][_0x2643d3(0xd2)]==_0x2643d3(0xb9))var _0x364186=users['French'];else{if(_0x4f3e71[0x0]['language']=='Portuguese\x20(BR)')var _0x364186=users[_0x2643d3(0x11e)];else{if(_0x4f3e71[0x0]['language']==_0x2643d3(0xf0))var _0x364186=users[_0x2643d3(0xf0)];else{if(_0x4f3e71[0x0][_0x2643d3(0xd2)]=='Arabic\x20(ae)')var _0x364186=users[_0x2643d3(0xeb)];}}}}}}}_0x5844a9[_0x2643d3(0xd3)](_0x2643d3(0x121),{'success':_0x35bc47['flash'](_0x2643d3(0xca)),'errors':_0x35bc47[_0x2643d3(0xbf)]('errors'),'user':_0x4b6495,'role':_0x3b0c54,'profile':_0x5d6eb7,'master_shop':_0x4f3e71,'language':_0x364186,'agent_id':_0x62e5bb[_0x2643d3(0x10a)],'payment':_0x58805a,'staff_arr':_0x62e5bb});}catch(_0x333b9e){console[_0x2643d3(0xe1)](_0x333b9e);}}),router[a0_0x35658d(0xf7)](a0_0x35658d(0xf3),auth,async(_0x1664ef,_0x43dad5)=>{const _0x4fed26=a0_0x35658d;try{const {name:_0x16b788,address:_0x158cfe,mobile:_0x20e867,email:_0x5246a3,receivable:_0x5922bd,payable:_0x1e202e,contactperson:_0x27cd41,landline:_0x382529,agent_id:_0x40b03d,less_percent:_0x4a78a7,type_org:_0x4aaa03,res_address:_0x277a7a,business_start_year:_0x35e184,credit_limit:_0x18ed94,term_pay:_0x7655b8}=_0x1664ef[_0x4fed26(0xf5)];if(typeof _0x4a78a7==_0x4fed26(0xdc))var _0xc6ae2e=[_0x1664ef['body'][_0x4fed26(0xe9)]];else var _0xc6ae2e=[..._0x1664ef['body'][_0x4fed26(0xe9)]];const _0x318aab=_0xc6ae2e[_0x4fed26(0xcb)](_0x4e9433=>{return _0x4e9433={'less':_0x4e9433};}),_0x135df4=new customer({'name':_0x16b788,'address':_0x158cfe,'mobile':_0x20e867,'email':_0x5246a3,'receivable':_0x5922bd,'payable':_0x1e202e,'customer_discount':_0x318aab,'contactperson':_0x27cd41,'landline':_0x382529,'agent_id':_0x40b03d,'res_address':_0x277a7a,'type_organization':_0x4aaa03,'business_start_year':_0x35e184,'credit_limit':_0x18ed94,'terms_of_payments':_0x7655b8}),_0x381c4d=await _0x135df4[_0x4fed26(0x114)]();_0x1664ef['flash'](_0x4fed26(0xca),_0x4fed26(0x106)),_0x43dad5[_0x4fed26(0x124)]('/customer_sa/view');}catch(_0x121881){console[_0x4fed26(0xe1)](_0x121881);}}),router[a0_0x35658d(0xe8)](a0_0x35658d(0x111),auth,async(_0x4ce9da,_0x4413f1)=>{const _0x19818e=a0_0x35658d;try{const {username:_0x1910b2,email:_0x107004,role:_0x3730b8}=_0x4ce9da['user'],_0x12958a=_0x4ce9da['user'],_0xb96c10=await profile[_0x19818e(0xbe)]({'email':_0x12958a['email']}),_0x492f9e=await master_shop[_0x19818e(0xb6)]();console[_0x19818e(0xe1)]('master',_0x492f9e);const _0x7c58e9=_0x4ce9da['params']['id'],_0x422279=await customer[_0x19818e(0xef)](_0x7c58e9);console[_0x19818e(0xe1)](_0x422279);if(_0x492f9e[0x0][_0x19818e(0xd2)]==_0x19818e(0xb7)){var _0x525ea5=users['English'];console[_0x19818e(0xe1)](_0x525ea5);}else{if(_0x492f9e[0x0][_0x19818e(0xd2)]==_0x19818e(0x105))var _0x525ea5=users['Hindi'];else{if(_0x492f9e[0x0][_0x19818e(0xd2)]==_0x19818e(0xed))var _0x525ea5=users[_0x19818e(0xed)];else{if(_0x492f9e[0x0][_0x19818e(0xd2)]=='Spanish')var _0x525ea5=users['Spanish'];else{if(_0x492f9e[0x0][_0x19818e(0xd2)]==_0x19818e(0xb9))var _0x525ea5=users[_0x19818e(0xb9)];else{if(_0x492f9e[0x0][_0x19818e(0xd2)]==_0x19818e(0x108))var _0x525ea5=users[_0x19818e(0x11e)];else{if(_0x492f9e[0x0]['language']==_0x19818e(0xf0))var _0x525ea5=users[_0x19818e(0xf0)];else{if(_0x492f9e[0x0][_0x19818e(0xd2)]==_0x19818e(0xda))var _0x525ea5=users[_0x19818e(0xeb)];}}}}}}}_0x4413f1[_0x19818e(0xd3)](_0x19818e(0x121),{'success':_0x4ce9da['flash'](_0x19818e(0xca)),'errors':_0x4ce9da[_0x19818e(0xbf)](_0x19818e(0xcf)),'role':_0x12958a,'profile':_0xb96c10,'user':_0x422279,'master_shop':_0x492f9e,'language':_0x525ea5});}catch(_0x14a08f){console[_0x19818e(0xe1)](_0x14a08f);}}),router[a0_0x35658d(0xf7)](a0_0x35658d(0x111),auth,async(_0x3b500e,_0x599f87)=>{const _0x566b6d=a0_0x35658d;try{const _0x22ada1=_0x3b500e[_0x566b6d(0x119)]['id'],_0x4918de=await customer['findById'](_0x22ada1),{name:_0x263ab3,address:_0x3a2e9b,mobile:_0x2b3239,email:_0x41af63,receivable:_0xb6bec0,payable:_0x5c1b70,contactperson:_0x5de982,landline:_0x4af34b,less_percent_edit:_0x2d54a9,edit_type_org:_0x1f9c24,edit_res_address:_0x361fdb,edit_business_start_year:_0x2bddc2,edit_credit_limit:_0x25d4c7,edit_term_pay:_0x4109f0}=_0x3b500e[_0x566b6d(0xf5)];if(typeof _0x2d54a9==_0x566b6d(0xdc))var _0x526727=[_0x3b500e[_0x566b6d(0xf5)][_0x566b6d(0xbd)]];else var _0x526727=[..._0x3b500e[_0x566b6d(0xf5)][_0x566b6d(0xbd)]];const _0x109e18=_0x526727['map'](_0x45cf7f=>{return _0x45cf7f={'less':_0x45cf7f};});_0x4918de[_0x566b6d(0x102)]=_0x263ab3,_0x4918de['address']=_0x3a2e9b,_0x4918de[_0x566b6d(0xe6)]=_0x2b3239,_0x4918de[_0x566b6d(0xc6)]=_0x41af63,_0x4918de[_0x566b6d(0xea)]=_0xb6bec0,_0x4918de[_0x566b6d(0xde)]=_0x5c1b70,_0x4918de[_0x566b6d(0xc7)]=_0x5de982,_0x4918de[_0x566b6d(0x10c)]=_0x4af34b,_0x4918de['customer_discount']=_0x109e18,_0x4918de[_0x566b6d(0xfb)]=_0x1f9c24,_0x4918de[_0x566b6d(0xe4)]=_0x2bddc2,_0x4918de['credit_limit']=_0x25d4c7,_0x4918de[_0x566b6d(0x10b)]=_0x4109f0,_0x4918de[_0x566b6d(0xc9)]=_0x361fdb;const _0x4b4b3b=await _0x4918de['save']();_0x3b500e[_0x566b6d(0xbf)]('success','customer\x20update\x20successfully'),_0x599f87['redirect']('/customer_sa/view');}catch(_0x2d3fab){console['log'](_0x2d3fab);}}),router['get'](a0_0x35658d(0xc2),auth,async(_0x48dff0,_0x1789fe)=>{const _0x254ebb=a0_0x35658d;try{const {username:_0xab2ae9,email:_0x5151ac,role:_0x3c8d82}=_0x48dff0[_0x254ebb(0x10e)],_0x3f7fc8=_0x48dff0[_0x254ebb(0x10e)],_0x3ddba8=await profile[_0x254ebb(0xbe)]({'email':_0x3f7fc8[_0x254ebb(0xc6)]}),_0x4d3632=await master_shop[_0x254ebb(0xb6)]();console['log']('master',_0x4d3632),console['log'](_0x48dff0[_0x254ebb(0x119)]['id']);const _0x31a3d1=await customer[_0x254ebb(0xbe)]({'_id':_0x48dff0[_0x254ebb(0x119)]['id']});console[_0x254ebb(0xe1)](_0x254ebb(0xc8),_0x31a3d1);const _0x24d970=await c_payment_data[_0x254ebb(0xb6)]({'customer':_0x31a3d1[_0x254ebb(0x102)]});console[_0x254ebb(0xe1)](_0x24d970);const _0x418e7b=await c_payment_data[_0x254ebb(0xd0)]([{'$match':{'customer':_0x31a3d1['name']}},{'$match':{'reason':_0x254ebb(0xd6)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x254ebb(0xf6)}}}]);console[_0x254ebb(0xe1)](_0x254ebb(0xb4),_0x418e7b);const _0x4a4b12=await c_payment_data['aggregate']([{'$match':{'customer':_0x31a3d1[_0x254ebb(0x102)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x254ebb(0xf6)}}}]);console[_0x254ebb(0xe1)](_0x254ebb(0xba),_0x4a4b12);if(_0x4d3632[0x0][_0x254ebb(0xd2)]==_0x254ebb(0xb7)){var _0xf2f9f4=users['English'];console['log'](_0xf2f9f4);}else{if(_0x4d3632[0x0]['language']==_0x254ebb(0x105))var _0xf2f9f4=users[_0x254ebb(0x105)];else{if(_0x4d3632[0x0][_0x254ebb(0xd2)]=='German')var _0xf2f9f4=users['German'];else{if(_0x4d3632[0x0]['language']=='Spanish')var _0xf2f9f4=users[_0x254ebb(0x123)];else{if(_0x4d3632[0x0][_0x254ebb(0xd2)]=='French')var _0xf2f9f4=users['French'];else{if(_0x4d3632[0x0][_0x254ebb(0xd2)]==_0x254ebb(0x108))var _0xf2f9f4=users[_0x254ebb(0x11e)];else{if(_0x4d3632[0x0][_0x254ebb(0xd2)]==_0x254ebb(0xf0))var _0xf2f9f4=users[_0x254ebb(0xf0)];else{if(_0x4d3632[0x0][_0x254ebb(0xd2)]=='Arabic\x20(ae)')var _0xf2f9f4=users[_0x254ebb(0xeb)];}}}}}}}_0x1789fe['render'](_0x254ebb(0x120),{'success':_0x48dff0[_0x254ebb(0xbf)](_0x254ebb(0xca)),'errors':_0x48dff0[_0x254ebb(0xbf)](_0x254ebb(0xcf)),'role':_0x3f7fc8,'profile':_0x3ddba8,'payment':_0x24d970,'payable':_0x418e7b,'receivable':_0x4a4b12,'master_shop':_0x4d3632,'language':_0xf2f9f4});}catch(_0x45f60d){console['log'](_0x45f60d);}}),router['get']('/products_export_migrate_file',auth,async(_0x5ef031,_0x1d5772)=>{const _0xd510f7=a0_0x35658d;try{const _0x1a15fe=new excelJS['Workbook'](),_0x5d19cd=_0x1a15fe['addWorksheet'](_0xd510f7(0x110));return _0x5d19cd[_0xd510f7(0x112)]=[{'header':'ID','key':_0xd510f7(0xcc),'width':0xa},{'header':_0xd510f7(0xd9),'key':_0xd510f7(0x118),'width':0xa},{'header':_0xd510f7(0xf8),'key':'PUnits','width':0xa},{'header':_0xd510f7(0xf1),'key':_0xd510f7(0xf1),'width':0xa},{'header':_0xd510f7(0xbc),'key':'address','width':0xa},{'header':'mobile','key':_0xd510f7(0xe6),'width':0xa},{'header':_0xd510f7(0xc6),'key':'email','width':0xa}],_0x1d5772['setHeader']('Content-Type',_0xd510f7(0xfc)),_0x1d5772['setHeader'](_0xd510f7(0x109),_0xd510f7(0x113)),_0x1a15fe[_0xd510f7(0xb1)][_0xd510f7(0xb5)](_0x1d5772)[_0xd510f7(0x116)](()=>{const _0x2d77c5=_0xd510f7;_0x1d5772[_0x2d77c5(0xb3)](0xc8);});}catch(_0x3c77b8){_0x1d5772['status'](0x190)[_0xd510f7(0xcd)]({'errors':_0x3c77b8[_0xd510f7(0xc5)]});}});const storage1=multer[a0_0x35658d(0xc1)]({'destination':(_0x21960f,_0x37f88b,_0x5a3e78)=>{const _0x19d493=a0_0x35658d;_0x5a3e78(null,_0x19d493(0x11d));},'filename':(_0x11fdd0,_0x31b749,_0x1079da)=>{const _0x5d2c3b=a0_0x35658d;_0x1079da(null,Date[_0x5d2c3b(0xce)]()+_0x31b749[_0x5d2c3b(0x101)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x35658d(0xf7)](a0_0x35658d(0x115),auth,uploadMigrate[a0_0x35658d(0xec)](a0_0x35658d(0x100)),async(_0x737309,_0x286c9c)=>{const _0xc0a3c0=a0_0x35658d,_0x52b935=_0x737309['file'][_0xc0a3c0(0x11c)],_0x3487c7=await xlsx[_0xc0a3c0(0x103)](_0xc0a3c0(0xe5)+_0x52b935);let _0x50d88a=_0x3487c7['SheetNames'],_0x2282ff=xlsx[_0xc0a3c0(0x10f)][_0xc0a3c0(0xfe)](_0x3487c7['Sheets'][_0x50d88a[0x0]]);for(const _0x58f4ec of _0x2282ff){const _0x2eefe0=_0x58f4ec['ID'],_0x2bbca7=_0x58f4ec['Name'],_0x43c40b=_0x58f4ec[_0xc0a3c0(0xf8)],_0x2c0fd4=_0x58f4ec[_0xc0a3c0(0xf1)],_0x459460=_0x58f4ec[_0xc0a3c0(0xbc)],_0x32b8de=_0x58f4ec['mobile'],_0x2bff92=_0x58f4ec[_0xc0a3c0(0xc6)];try{let _0x5c7a60=await customer[_0xc0a3c0(0xbe)]({'name':_0x2bbca7});if(!_0x5c7a60){const _0x1dfc26=new customer({'name':_0x2bbca7,'ID':_0x2eefe0,'SalesmanCode':_0x43c40b,'SalesmanName':_0x2c0fd4,'address':_0x459460,'mobile':_0x32b8de,'email':_0x2bff92});_0x5c7a60=await _0x1dfc26[_0xc0a3c0(0x114)](),_0x737309[_0xc0a3c0(0xbf)](_0xc0a3c0(0xca),_0x2bbca7+_0xc0a3c0(0x11f));}else _0x737309[_0xc0a3c0(0xbf)](_0xc0a3c0(0xc0),_0x2bbca7+'\x20Failed');}catch(_0x32b6d4){_0x286c9c[_0xc0a3c0(0xb3)](0x1f4)[_0xc0a3c0(0x107)]({'proderror':_0x32b6d4[_0xc0a3c0(0xc5)],'aproduct':ProductName});}}_0x286c9c['redirect'](_0xc0a3c0(0xb2));}),module[a0_0x35658d(0xdd)]=router;function a0_0x7c0b(_0x1eabbb,_0xd0c76c){const _0x584f3a=a0_0x584f();return a0_0x7c0b=function(_0x7c0beb,_0x2b8577){_0x7c0beb=_0x7c0beb-0xb1;let _0x27aa7a=_0x584f3a[_0x7c0beb];return _0x27aa7a;},a0_0x7c0b(_0x1eabbb,_0xd0c76c);}function a0_0x584f(){const _0x3704ff=['customer_product_fule','originalname','name','readFile','express','Hindi','customer\x20add\x20successfully','json','Portuguese\x20(BR)','Content-Disposition','_id','terms_of_payments','landline','28010OjXFTL','user','utils','Customers','/view/:id','columns','attachment;\x20filename=customer_Migration_File.xlsx','save','/customer_import_migrate_file','then','sale','PBrands','params','93301ZcEKOV','c_payments','filename','public/Migration','Portuguese','\x20added\x20successfully','customer_payment','customer_sa','1096760DyoEIl','Spanish','redirect','xlsx','/customer_sa/view','status','payable_sum','write','find','English\x20(US)','English','French','receivable_sum','multer','address','less_percent_edit','findOne','flash','error','diskStorage','/view/payment/:id','element','2711506JXcUOG','message','email','contactperson','customer_data','res_address','success','map','PName','send','now','errors','aggregate','1uEdUpP','language','render','../middleware/auth','reason','Sale','amount','1012OMvMeH','Name','Arabic\x20(ae)','customer_docs','string','exports','payable','387rJbhCl','972uwsjxs','log','forEach','../public/language/languages.json','business_start_year','public/Migration/','mobile','537366vCZktR','get','less_percent','receivable','Arabic','single','German','6JShNzO','findById','Chinese','SalesmanName','sale_return','/view','exceljs','body','$amount','post','SalesmanCode','4OtzpfX','231762hZqHtH','type_organization','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','../models/all_models','sheet_to_json','35792jQoayV'];a0_0x584f=function(){return _0x3704ff;};return a0_0x584f();}