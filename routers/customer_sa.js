const a0_0x12f538=a0_0x4475;(function(_0x1b095f,_0xce542d){const _0x3a4f0e=a0_0x4475,_0x290948=_0x1b095f();while(!![]){try{const _0x1305c1=-parseInt(_0x3a4f0e(0xaf))/0x1*(parseInt(_0x3a4f0e(0xed))/0x2)+-parseInt(_0x3a4f0e(0x7a))/0x3+-parseInt(_0x3a4f0e(0xb1))/0x4*(parseInt(_0x3a4f0e(0xc6))/0x5)+-parseInt(_0x3a4f0e(0xb3))/0x6*(-parseInt(_0x3a4f0e(0xb7))/0x7)+parseInt(_0x3a4f0e(0xca))/0x8*(-parseInt(_0x3a4f0e(0x9b))/0x9)+parseInt(_0x3a4f0e(0xb4))/0xa*(parseInt(_0x3a4f0e(0xbe))/0xb)+parseInt(_0x3a4f0e(0xa1))/0xc*(parseInt(_0x3a4f0e(0xda))/0xd);if(_0x1305c1===_0xce542d)break;else _0x290948['push'](_0x290948['shift']());}catch(_0x14b6de){_0x290948['push'](_0x290948['shift']());}}}(a0_0x2b3a,0x23fdb));function a0_0x4475(_0x42430b,_0x11237a){const _0x2b3a47=a0_0x2b3a();return a0_0x4475=function(_0x44757a,_0x4a1dd4){_0x44757a=_0x44757a-0x7a;let _0x1c3a4a=_0x2b3a47[_0x44757a];return _0x1c3a4a;},a0_0x4475(_0x42430b,_0x11237a);}const express=require(a0_0x12f538(0xbb)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x12f538(0x9f)),auth=require(a0_0x12f538(0xac)),users=require('../public/language/languages.json'),excelJS=require(a0_0x12f538(0x84)),xlsx=require('xlsx'),multer=require(a0_0x12f538(0x96));router['get'](a0_0x12f538(0xc5),auth,async(_0x5c1c9d,_0x1abd72)=>{const _0x5f25ff=a0_0x12f538;try{const {username:_0x3acde5,email:_0x3c8c79,role:_0x2ed18}=_0x5c1c9d['user'],_0x3c0e51=_0x5c1c9d[_0x5f25ff(0xad)],_0x2b46e1=await profile[_0x5f25ff(0xee)]({'email':_0x3c0e51[_0x5f25ff(0x89)]}),_0x434f1a=await master_shop[_0x5f25ff(0xa2)](),_0x3a81e3=await staff['findOne']({'email':_0x3c0e51[_0x5f25ff(0x89)]}),_0x3d82dc=await customer['find']({'agent_id':_0x3a81e3['_id']}),_0xc4dc7b=await customer[_0x5f25ff(0x86)]([{'$match':{'agent_id':_0x3a81e3[_0x5f25ff(0xd2)][_0x5f25ff(0xf0)]()}},{'$lookup':{'from':_0x5f25ff(0x92),'localField':_0x5f25ff(0xc3),'foreignField':'customer','as':'customer_docs'}}]),_0x2ecdd8=_0xc4dc7b['map'](_0x29aa3b=>{const _0x4d2f14=_0x5f25ff;console[_0x4d2f14(0xb5)](_0x4d2f14(0xae),_0x29aa3b);var _0x56da2a=0x0,_0x5393eb=0x0;return _0x29aa3b[_0x4d2f14(0xbf)][_0x4d2f14(0xb0)](_0x3ba5ac=>{const _0x3a3c13=_0x4d2f14;console[_0x3a3c13(0xb5)](_0x3a3c13(0xd3),_0x3ba5ac),_0x3ba5ac['reason']==_0x3a3c13(0xc8)?_0x56da2a+=_0x3ba5ac[_0x3a3c13(0xe3)]:_0x5393eb+=_0x3ba5ac[_0x3a3c13(0xe3)];}),_0x29aa3b[_0x4d2f14(0xcf)]=parseFloat(_0x56da2a)+0x0,_0x29aa3b[_0x4d2f14(0xdd)]=parseFloat(_0x5393eb)+0x0,_0x29aa3b;});if(_0x434f1a[0x0][_0x5f25ff(0xc2)]=='English\x20(US)'){var _0x34c618=users[_0x5f25ff(0xa3)];console[_0x5f25ff(0xb5)](_0x34c618);}else{if(_0x434f1a[0x0][_0x5f25ff(0xc2)]==_0x5f25ff(0x99))var _0x34c618=users[_0x5f25ff(0x99)];else{if(_0x434f1a[0x0]['language']==_0x5f25ff(0x94))var _0x34c618=users[_0x5f25ff(0x94)];else{if(_0x434f1a[0x0][_0x5f25ff(0xc2)]=='Spanish')var _0x34c618=users['Spanish'];else{if(_0x434f1a[0x0]['language']==_0x5f25ff(0xdb))var _0x34c618=users['French'];else{if(_0x434f1a[0x0]['language']==_0x5f25ff(0xb6))var _0x34c618=users[_0x5f25ff(0xe8)];else{if(_0x434f1a[0x0][_0x5f25ff(0xc2)]==_0x5f25ff(0x81))var _0x34c618=users[_0x5f25ff(0x81)];else{if(_0x434f1a[0x0][_0x5f25ff(0xc2)]==_0x5f25ff(0x90))var _0x34c618=users['Arabic'];}}}}}}}_0x1abd72['render'](_0x5f25ff(0xdf),{'success':_0x5c1c9d[_0x5f25ff(0x7e)](_0x5f25ff(0xe5)),'errors':_0x5c1c9d[_0x5f25ff(0x7e)](_0x5f25ff(0x8f)),'user':_0x3d82dc,'role':_0x3c0e51,'profile':_0x2b46e1,'master_shop':_0x434f1a,'language':_0x34c618,'agent_id':_0x3a81e3[_0x5f25ff(0xd2)],'payment':_0x2ecdd8,'staff_arr':_0x3a81e3});}catch(_0x4d82e4){console[_0x5f25ff(0xb5)](_0x4d82e4);}}),router[a0_0x12f538(0xd7)](a0_0x12f538(0xc5),auth,async(_0x58d403,_0x22d3ad)=>{const _0x25f237=a0_0x12f538;try{const {name:_0x3d8140,address:_0x38e12c,mobile:_0x238069,email:_0x35590c,receivable:_0x35a35e,payable:_0x59d8ca,contactperson:_0x3d196a,landline:_0x21bd39,agent_id:_0x3261a1,less_percent:_0x44d27f,type_org:_0x341431,res_address:_0x503a76,business_start_year:_0x5decf8,credit_limit:_0x458246,term_pay:_0x534a63}=_0x58d403[_0x25f237(0x83)];if(typeof _0x44d27f==_0x25f237(0xe7))var _0x2b8d7a=[_0x58d403['body']['less_percent']];else var _0x2b8d7a=[..._0x58d403[_0x25f237(0x83)][_0x25f237(0x80)]];const _0xa5e322=_0x2b8d7a['map'](_0x4f419a=>{return _0x4f419a={'less':_0x4f419a};}),_0x5dc458=new customer({'name':_0x3d8140,'address':_0x38e12c,'mobile':_0x238069,'email':_0x35590c,'receivable':_0x35a35e,'payable':_0x59d8ca,'customer_discount':_0xa5e322,'contactperson':_0x3d196a,'landline':_0x21bd39,'agent_id':_0x3261a1,'res_address':_0x503a76,'type_organization':_0x341431,'business_start_year':_0x5decf8,'credit_limit':_0x458246,'terms_of_payments':_0x534a63}),_0x525be4=await _0x5dc458[_0x25f237(0xe1)]();_0x58d403['flash'](_0x25f237(0xe5),'customer\x20add\x20successfully'),_0x22d3ad[_0x25f237(0xe6)](_0x25f237(0xdc));}catch(_0x2a30bf){console[_0x25f237(0xb5)](_0x2a30bf);}}),router[a0_0x12f538(0xc7)]('/view/:id',auth,async(_0x54be08,_0xf103)=>{const _0xa59184=a0_0x12f538;try{const {username:_0x3b5732,email:_0x2ccc5f,role:_0xaaf816}=_0x54be08[_0xa59184(0xad)],_0x5e0167=_0x54be08['user'],_0x53841c=await profile[_0xa59184(0xee)]({'email':_0x5e0167[_0xa59184(0x89)]}),_0x3d3511=await master_shop[_0xa59184(0xa2)]();console[_0xa59184(0xb5)](_0xa59184(0x7b),_0x3d3511);const _0x190c73=_0x54be08[_0xa59184(0xc0)]['id'],_0x59585a=await customer[_0xa59184(0xc4)](_0x190c73);console[_0xa59184(0xb5)](_0x59585a);if(_0x3d3511[0x0][_0xa59184(0xc2)]=='English\x20(US)'){var _0x1ce49a=users[_0xa59184(0xa3)];console[_0xa59184(0xb5)](_0x1ce49a);}else{if(_0x3d3511[0x0][_0xa59184(0xc2)]==_0xa59184(0x99))var _0x1ce49a=users[_0xa59184(0x99)];else{if(_0x3d3511[0x0][_0xa59184(0xc2)]==_0xa59184(0x94))var _0x1ce49a=users[_0xa59184(0x94)];else{if(_0x3d3511[0x0]['language']==_0xa59184(0x95))var _0x1ce49a=users['Spanish'];else{if(_0x3d3511[0x0][_0xa59184(0xc2)]==_0xa59184(0xdb))var _0x1ce49a=users[_0xa59184(0xdb)];else{if(_0x3d3511[0x0][_0xa59184(0xc2)]==_0xa59184(0xb6))var _0x1ce49a=users[_0xa59184(0xe8)];else{if(_0x3d3511[0x0][_0xa59184(0xc2)]==_0xa59184(0x81))var _0x1ce49a=users['Chinese'];else{if(_0x3d3511[0x0][_0xa59184(0xc2)]=='Arabic\x20(ae)')var _0x1ce49a=users['Arabic'];}}}}}}}_0xf103['render'](_0xa59184(0xdf),{'success':_0x54be08[_0xa59184(0x7e)]('success'),'errors':_0x54be08[_0xa59184(0x7e)](_0xa59184(0x8f)),'role':_0x5e0167,'profile':_0x53841c,'user':_0x59585a,'master_shop':_0x3d3511,'language':_0x1ce49a});}catch(_0x5706cd){console[_0xa59184(0xb5)](_0x5706cd);}}),router[a0_0x12f538(0xd7)](a0_0x12f538(0xde),auth,async(_0x2364b7,_0x191b86)=>{const _0x1898ef=a0_0x12f538;try{const _0x34a358=_0x2364b7[_0x1898ef(0xc0)]['id'],_0x49dccf=await customer[_0x1898ef(0xc4)](_0x34a358),{name:_0x2358c7,address:_0xaf35cc,mobile:_0x3cf509,email:_0x2c5f4f,receivable:_0x18ab21,payable:_0x37355b,contactperson:_0x11496c,landline:_0x5142fe,less_percent_edit:_0x325f42,edit_type_org:_0x47a388,edit_res_address:_0x523cfd,edit_business_start_year:_0x3df860,edit_credit_limit:_0x1e7266,edit_term_pay:_0x437343}=_0x2364b7[_0x1898ef(0x83)];if(typeof _0x325f42==_0x1898ef(0xe7))var _0x1c8075=[_0x2364b7[_0x1898ef(0x83)][_0x1898ef(0xa4)]];else var _0x1c8075=[..._0x2364b7[_0x1898ef(0x83)]['less_percent_edit']];const _0x1092be=_0x1c8075[_0x1898ef(0xa5)](_0x430264=>{return _0x430264={'less':_0x430264};});_0x49dccf[_0x1898ef(0xc3)]=_0x2358c7,_0x49dccf[_0x1898ef(0xa6)]=_0xaf35cc,_0x49dccf[_0x1898ef(0xba)]=_0x3cf509,_0x49dccf[_0x1898ef(0x89)]=_0x2c5f4f,_0x49dccf[_0x1898ef(0x98)]=_0x18ab21,_0x49dccf[_0x1898ef(0xd4)]=_0x37355b,_0x49dccf[_0x1898ef(0xd0)]=_0x11496c,_0x49dccf[_0x1898ef(0xcd)]=_0x5142fe,_0x49dccf[_0x1898ef(0xd5)]=_0x1092be,_0x49dccf[_0x1898ef(0xc9)]=_0x47a388,_0x49dccf[_0x1898ef(0xef)]=_0x3df860,_0x49dccf[_0x1898ef(0x8a)]=_0x1e7266,_0x49dccf[_0x1898ef(0x9a)]=_0x437343,_0x49dccf[_0x1898ef(0xe9)]=_0x523cfd;const _0x20499c=await _0x49dccf[_0x1898ef(0xe1)]();_0x2364b7[_0x1898ef(0x7e)](_0x1898ef(0xe5),_0x1898ef(0x97)),_0x191b86[_0x1898ef(0xe6)](_0x1898ef(0xdc));}catch(_0x4ab615){console[_0x1898ef(0xb5)](_0x4ab615);}}),router['get']('/view/payment/:id',auth,async(_0x45dfd8,_0x4caad8)=>{const _0x1e07ed=a0_0x12f538;try{const {username:_0x46f44c,email:_0x14c26c,role:_0xcc2836}=_0x45dfd8['user'],_0x2dc311=_0x45dfd8[_0x1e07ed(0xad)],_0x81009a=await profile['findOne']({'email':_0x2dc311['email']}),_0x63a419=await master_shop[_0x1e07ed(0xa2)]();console['log']('master',_0x63a419),console[_0x1e07ed(0xb5)](_0x45dfd8[_0x1e07ed(0xc0)]['id']);const _0x3c664e=await customer[_0x1e07ed(0xee)]({'_id':_0x45dfd8[_0x1e07ed(0xc0)]['id']});console[_0x1e07ed(0xb5)](_0x1e07ed(0xea),_0x3c664e);const _0x11ac67=await c_payment_data[_0x1e07ed(0xa2)]({'customer':_0x3c664e['name']});console[_0x1e07ed(0xb5)](_0x11ac67);const _0x2ebe69=await c_payment_data[_0x1e07ed(0x86)]([{'$match':{'customer':_0x3c664e['name']}},{'$match':{'reason':'Sale'}},{'$group':{'_id':_0x1e07ed(0x9e),'sum':{'$sum':'$amount'}}}]);console[_0x1e07ed(0xb5)](_0x1e07ed(0xeb),_0x2ebe69);const _0x2e4112=await c_payment_data[_0x1e07ed(0x86)]([{'$match':{'customer':_0x3c664e[_0x1e07ed(0xc3)]}},{'$match':{'reason':_0x1e07ed(0xd6)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x1e07ed(0xb5)](_0x1e07ed(0xd9),_0x2e4112);if(_0x63a419[0x0][_0x1e07ed(0xc2)]=='English\x20(US)'){var _0x1e47f4=users[_0x1e07ed(0xa3)];console[_0x1e07ed(0xb5)](_0x1e47f4);}else{if(_0x63a419[0x0][_0x1e07ed(0xc2)]==_0x1e07ed(0x99))var _0x1e47f4=users['Hindi'];else{if(_0x63a419[0x0]['language']==_0x1e07ed(0x94))var _0x1e47f4=users['German'];else{if(_0x63a419[0x0][_0x1e07ed(0xc2)]==_0x1e07ed(0x95))var _0x1e47f4=users[_0x1e07ed(0x95)];else{if(_0x63a419[0x0][_0x1e07ed(0xc2)]==_0x1e07ed(0xdb))var _0x1e47f4=users[_0x1e07ed(0xdb)];else{if(_0x63a419[0x0]['language']==_0x1e07ed(0xb6))var _0x1e47f4=users[_0x1e07ed(0xe8)];else{if(_0x63a419[0x0][_0x1e07ed(0xc2)]=='Chinese')var _0x1e47f4=users[_0x1e07ed(0x81)];else{if(_0x63a419[0x0]['language']==_0x1e07ed(0x90))var _0x1e47f4=users[_0x1e07ed(0x85)];}}}}}}}_0x4caad8['render'](_0x1e07ed(0xe2),{'success':_0x45dfd8[_0x1e07ed(0x7e)](_0x1e07ed(0xe5)),'errors':_0x45dfd8['flash']('errors'),'role':_0x2dc311,'profile':_0x81009a,'payment':_0x11ac67,'payable':_0x2ebe69,'receivable':_0x2e4112,'master_shop':_0x63a419,'language':_0x1e47f4});}catch(_0x4e702b){console['log'](_0x4e702b);}}),router[a0_0x12f538(0xc7)]('/products_export_migrate_file',auth,async(_0x2e947b,_0x539f6f)=>{const _0x5f32e2=a0_0x12f538;try{const _0x2cd0ae=new excelJS[(_0x5f32e2(0x9d))](),_0x22f01d=_0x2cd0ae[_0x5f32e2(0xbd)](_0x5f32e2(0x7f));return _0x22f01d[_0x5f32e2(0xb8)]=[{'header':'ID','key':'PName','width':0xa},{'header':'Name','key':_0x5f32e2(0x8c),'width':0xa},{'header':_0x5f32e2(0xce),'key':_0x5f32e2(0xb2),'width':0xa},{'header':'SalesmanName','key':_0x5f32e2(0x9c),'width':0xa},{'header':_0x5f32e2(0xa6),'key':'address','width':0xa},{'header':_0x5f32e2(0xba),'key':_0x5f32e2(0xba),'width':0xa},{'header':'email','key':_0x5f32e2(0x89),'width':0xa}],_0x539f6f[_0x5f32e2(0xa9)](_0x5f32e2(0xd1),_0x5f32e2(0x8e)),_0x539f6f['setHeader']('Content-Disposition',_0x5f32e2(0xe4)),_0x2cd0ae[_0x5f32e2(0xbc)][_0x5f32e2(0xc1)](_0x539f6f)[_0x5f32e2(0xa0)](()=>{const _0x389049=_0x5f32e2;_0x539f6f[_0x389049(0x7c)](0xc8);});}catch(_0x326a23){_0x539f6f[_0x5f32e2(0x7c)](0x190)[_0x5f32e2(0xa8)]({'errors':_0x326a23[_0x5f32e2(0x91)]});}});const storage1=multer[a0_0x12f538(0xec)]({'destination':(_0x2cda35,_0x23a8a6,_0x12dc05)=>{const _0x2eb722=a0_0x12f538;_0x12dc05(null,_0x2eb722(0xa7));},'filename':(_0x5a65e8,_0x808d51,_0x3d4dbd)=>{const _0x38db4f=a0_0x12f538;_0x3d4dbd(null,Date[_0x38db4f(0xaa)]()+_0x808d51[_0x38db4f(0xcc)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x2b3a(){const _0x67b5e8=['credit_limit','\x20Failed','PBrands','readFile','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','errors','Arabic\x20(ae)','message','c_payments','/customer_import_migrate_file','German','Spanish','multer','customer\x20update\x20successfully','receivable','Hindi','terms_of_payments','2098647UPizGT','SalesmanName','Workbook','$reason','../models/all_models','then','12lqkTUf','find','English','less_percent_edit','map','address','public/Migration','send','setHeader','now','\x20added\x20successfully','../middleware/auth','user','data','2707FDQgjL','forEach','8qeAJrs','PUnits','372wnfItZ','10FzhzEv','log','Portuguese\x20(BR)','20377oBtWdf','columns','error','mobile','express','xlsx','addWorksheet','625438lZtWDR','customer_docs','params','write','language','name','findById','/view','19545vmnsRF','get','Sale','type_organization','8Wyxcbp','Sheets','originalname','landline','SalesmanCode','sale','contactperson','Content-Type','_id','element','payable','customer_discount','Sale\x20Return','post','sheet_to_json','receivable_sum','4740983eXuDeO','French','/customer_sa/view','sale_return','/view/:id','customer_sa','utils','save','customer_payment','amount','attachment;\x20filename=customer_Migration_File.xlsx','success','redirect','string','Portuguese','res_address','customer_data','payable_sum','diskStorage','142mRmqxE','findOne','business_start_year','valueOf','64242mTwLoX','master','status','customer_product_fule','flash','Customers','less_percent','Chinese','file','body','exceljs','Arabic','aggregate','public/Migration/','json','email'];a0_0x2b3a=function(){return _0x67b5e8;};return a0_0x2b3a();}router[a0_0x12f538(0xd7)](a0_0x12f538(0x93),auth,uploadMigrate['single'](a0_0x12f538(0x7d)),async(_0x59bb50,_0x1c5a57)=>{const _0x3c4149=a0_0x12f538,_0x2b84a3=_0x59bb50[_0x3c4149(0x82)]['filename'],_0x2ce3a5=await xlsx[_0x3c4149(0x8d)](_0x3c4149(0x87)+_0x2b84a3);let _0x12242d=_0x2ce3a5['SheetNames'],_0x4f9e1d=xlsx[_0x3c4149(0xe0)][_0x3c4149(0xd8)](_0x2ce3a5[_0x3c4149(0xcb)][_0x12242d[0x0]]);for(const _0xca4c8e of _0x4f9e1d){const _0x18f907=_0xca4c8e['ID'],_0x7916b0=_0xca4c8e['Name'],_0x43cf37=_0xca4c8e[_0x3c4149(0xce)],_0xc5ba00=_0xca4c8e[_0x3c4149(0x9c)],_0x283ec8=_0xca4c8e['address'],_0x39fa98=_0xca4c8e[_0x3c4149(0xba)],_0x4bb301=_0xca4c8e[_0x3c4149(0x89)];try{let _0x265eb4=await customer[_0x3c4149(0xee)]({'name':_0x7916b0});if(!_0x265eb4){const _0x351466=new customer({'name':_0x7916b0,'ID':_0x18f907,'SalesmanCode':_0x43cf37,'SalesmanName':_0xc5ba00,'address':_0x283ec8,'mobile':_0x39fa98,'email':_0x4bb301});_0x265eb4=await _0x351466[_0x3c4149(0xe1)](),_0x59bb50['flash']('success',_0x7916b0+_0x3c4149(0xab));}else _0x59bb50['flash'](_0x3c4149(0xb9),_0x7916b0+_0x3c4149(0x8b));}catch(_0x1381d1){_0x1c5a57[_0x3c4149(0x7c)](0x1f4)[_0x3c4149(0x88)]({'proderror':_0x1381d1[_0x3c4149(0x91)],'aproduct':ProductName});}}_0x1c5a57[_0x3c4149(0xe6)](_0x3c4149(0xdc));}),module['exports']=router;