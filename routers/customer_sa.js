function a0_0x3187(){const _0x188809=['sale','Arabic\x20(ae)','aggregate','Customers','sheet_to_json','_id','message','reason','forEach','PBrands','Name','errors','get','string','credit_limit','German','66dNFVdW','less_percent','receivable','SalesmanName','PUnits','find','render','data','3309aSonHw','public/Migration','customer_product_fule','/products_export_migrate_file','Sheets','/view/:id','/customer_sa/view','sale_return','map','business_start_year','Arabic','address','/view','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','payable','success','../public/language/languages.json','status','xlsx','1492APqIGx','$amount','user','customer','Content-Type','flash','PName','type_organization','Workbook','findOne','/view/payment/:id','SalesmanCode','json','Spanish','less_percent_edit','error','296093LZnxNy','save','params','then','valueOf','2170156nxXbOi','exceljs','setHeader','customer_payment','French','log','Portuguese','Content-Disposition','name','Chinese','\x20added\x20successfully','customer_docs','email','../middleware/auth','addWorksheet','Portuguese\x20(BR)','customer_data','English','file','send','Sale','mobile','multer','write','430gXLWHQ','readFile','payable_sum','amount','public/Migration/','language','English\x20(US)','251493TbzMGx','utils','redirect','/customer_import_migrate_file','9DBixXD','Router','body','columns','attachment;\x20filename=customer_Migration_File.xlsx','customer_sa','1290347Bdwdmp','post','findById','master','7212848RRFBYD','Sale\x20Return','Hindi','6991090JzzgBu'];a0_0x3187=function(){return _0x188809;};return a0_0x3187();}const a0_0x8ab115=a0_0x1f6a;function a0_0x1f6a(_0xd4e81f,_0x5a271b){const _0x31877c=a0_0x3187();return a0_0x1f6a=function(_0x1f6add,_0x542b0a){_0x1f6add=_0x1f6add-0x110;let _0x31a093=_0x31877c[_0x1f6add];return _0x31a093;},a0_0x1f6a(_0xd4e81f,_0x5a271b);}(function(_0x514f3c,_0x9a2738){const _0x152a7e=a0_0x1f6a,_0x521554=_0x514f3c();while(!![]){try{const _0x167cb9=-parseInt(_0x152a7e(0x141))/0x1+-parseInt(_0x152a7e(0x174))/0x2*(-parseInt(_0x152a7e(0x161))/0x3)+-parseInt(_0x152a7e(0x118))/0x4+parseInt(_0x152a7e(0x148))/0x5+parseInt(_0x152a7e(0x159))/0x6*(parseInt(_0x152a7e(0x113))/0x7)+-parseInt(_0x152a7e(0x145))/0x8*(parseInt(_0x152a7e(0x13b))/0x9)+-parseInt(_0x152a7e(0x130))/0xa*(-parseInt(_0x152a7e(0x137))/0xb);if(_0x167cb9===_0x9a2738)break;else _0x521554['push'](_0x521554['shift']());}catch(_0x5a7ccd){_0x521554['push'](_0x521554['shift']());}}}(a0_0x3187,0xe4432));const express=require('express'),app=express(),router=express[a0_0x8ab115(0x13c)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require(a0_0x8ab115(0x125)),users=require(a0_0x8ab115(0x171)),excelJS=require(a0_0x8ab115(0x119)),xlsx=require(a0_0x8ab115(0x173)),multer=require(a0_0x8ab115(0x12e));router[a0_0x8ab115(0x155)](a0_0x8ab115(0x16d),auth,async(_0x19f8d4,_0x3e00a1)=>{const _0x136a2f=a0_0x8ab115;try{const {username:_0x2a87d0,email:_0x5416fd,role:_0x1309c7}=_0x19f8d4[_0x136a2f(0x176)],_0x5abb58=_0x19f8d4['user'],_0x15d7fd=await profile['findOne']({'email':_0x5abb58[_0x136a2f(0x124)]}),_0x214441=await master_shop[_0x136a2f(0x15e)](),_0x2ae40c=await staff['findOne']({'email':_0x5abb58[_0x136a2f(0x124)]}),_0x5f34f9=await customer[_0x136a2f(0x15e)]({'agent_id':_0x2ae40c['_id']}),_0x45d9fc=await customer['aggregate']([{'$match':{'agent_id':_0x2ae40c[_0x136a2f(0x14e)][_0x136a2f(0x117)]()}},{'$lookup':{'from':'c_payments','localField':_0x136a2f(0x120),'foreignField':_0x136a2f(0x177),'as':_0x136a2f(0x123)}}]),_0x37d8eb=_0x45d9fc['map'](_0x5160cb=>{const _0x47fb4e=_0x136a2f;console[_0x47fb4e(0x11d)](_0x47fb4e(0x160),_0x5160cb);var _0x575014=0x0,_0x387011=0x0;return _0x5160cb[_0x47fb4e(0x123)][_0x47fb4e(0x151)](_0x123920=>{const _0x1cfbd8=_0x47fb4e;console[_0x1cfbd8(0x11d)]('element',_0x123920),_0x123920[_0x1cfbd8(0x150)]==_0x1cfbd8(0x12c)?_0x575014+=_0x123920[_0x1cfbd8(0x133)]:_0x387011+=_0x123920[_0x1cfbd8(0x133)];}),_0x5160cb[_0x47fb4e(0x149)]=parseFloat(_0x575014)+0x0,_0x5160cb[_0x47fb4e(0x168)]=parseFloat(_0x387011)+0x0,_0x5160cb;});if(_0x214441[0x0]['language']==_0x136a2f(0x136)){var _0x24cbab=users[_0x136a2f(0x129)];console['log'](_0x24cbab);}else{if(_0x214441[0x0][_0x136a2f(0x135)]==_0x136a2f(0x147))var _0x24cbab=users['Hindi'];else{if(_0x214441[0x0]['language']==_0x136a2f(0x158))var _0x24cbab=users[_0x136a2f(0x158)];else{if(_0x214441[0x0][_0x136a2f(0x135)]==_0x136a2f(0x110))var _0x24cbab=users['Spanish'];else{if(_0x214441[0x0][_0x136a2f(0x135)]==_0x136a2f(0x11c))var _0x24cbab=users[_0x136a2f(0x11c)];else{if(_0x214441[0x0][_0x136a2f(0x135)]=='Portuguese\x20(BR)')var _0x24cbab=users[_0x136a2f(0x11e)];else{if(_0x214441[0x0]['language']==_0x136a2f(0x121))var _0x24cbab=users['Chinese'];else{if(_0x214441[0x0][_0x136a2f(0x135)]==_0x136a2f(0x14a))var _0x24cbab=users[_0x136a2f(0x16b)];}}}}}}}_0x3e00a1[_0x136a2f(0x15f)](_0x136a2f(0x140),{'success':_0x19f8d4[_0x136a2f(0x179)](_0x136a2f(0x170)),'errors':_0x19f8d4[_0x136a2f(0x179)](_0x136a2f(0x154)),'user':_0x5f34f9,'role':_0x5abb58,'profile':_0x15d7fd,'master_shop':_0x214441,'language':_0x24cbab,'agent_id':_0x2ae40c[_0x136a2f(0x14e)],'payment':_0x37d8eb,'staff_arr':_0x2ae40c});}catch(_0x3dc10e){console[_0x136a2f(0x11d)](_0x3dc10e);}}),router[a0_0x8ab115(0x142)]('/view',auth,async(_0xe64c80,_0x36b1ef)=>{const _0x5aa3ab=a0_0x8ab115;try{const {name:_0x44b43c,address:_0x5d1d57,mobile:_0x20cbfc,email:_0x552d53,receivable:_0x2a04f8,payable:_0x87b8a,contactperson:_0x4ce7a6,landline:_0xb5ef35,agent_id:_0x28c27b,less_percent:_0x4ca943,type_org:_0x36f231,res_address:_0x4498a9,business_start_year:_0x741da0,credit_limit:_0x48548d,term_pay:_0x3c0db9}=_0xe64c80[_0x5aa3ab(0x13d)];if(typeof _0x4ca943==_0x5aa3ab(0x156))var _0x18289c=[_0xe64c80[_0x5aa3ab(0x13d)][_0x5aa3ab(0x15a)]];else var _0x18289c=[..._0xe64c80[_0x5aa3ab(0x13d)][_0x5aa3ab(0x15a)]];const _0x1eac6d=_0x18289c[_0x5aa3ab(0x169)](_0x53cb5c=>{return _0x53cb5c={'less':_0x53cb5c};}),_0x26709a=new customer({'name':_0x44b43c,'address':_0x5d1d57,'mobile':_0x20cbfc,'email':_0x552d53,'receivable':_0x2a04f8,'payable':_0x87b8a,'customer_discount':_0x1eac6d,'contactperson':_0x4ce7a6,'landline':_0xb5ef35,'agent_id':_0x28c27b,'res_address':_0x4498a9,'type_organization':_0x36f231,'business_start_year':_0x741da0,'credit_limit':_0x48548d,'terms_of_payments':_0x3c0db9}),_0x266dbd=await _0x26709a[_0x5aa3ab(0x114)]();_0xe64c80[_0x5aa3ab(0x179)]('success','customer\x20add\x20successfully'),_0x36b1ef[_0x5aa3ab(0x139)](_0x5aa3ab(0x167));}catch(_0x35403c){console[_0x5aa3ab(0x11d)](_0x35403c);}}),router[a0_0x8ab115(0x155)](a0_0x8ab115(0x166),auth,async(_0x4ad9e9,_0xfb7f56)=>{const _0x4df7d7=a0_0x8ab115;try{const {username:_0x2b314b,email:_0x3237e7,role:_0x4a9774}=_0x4ad9e9[_0x4df7d7(0x176)],_0xbb828f=_0x4ad9e9['user'],_0x413f6b=await profile[_0x4df7d7(0x17d)]({'email':_0xbb828f[_0x4df7d7(0x124)]}),_0x3ff3ab=await master_shop[_0x4df7d7(0x15e)]();console[_0x4df7d7(0x11d)](_0x4df7d7(0x144),_0x3ff3ab);const _0x2c756c=_0x4ad9e9[_0x4df7d7(0x115)]['id'],_0x38746b=await customer[_0x4df7d7(0x143)](_0x2c756c);console[_0x4df7d7(0x11d)](_0x38746b);if(_0x3ff3ab[0x0][_0x4df7d7(0x135)]==_0x4df7d7(0x136)){var _0x55a735=users[_0x4df7d7(0x129)];console[_0x4df7d7(0x11d)](_0x55a735);}else{if(_0x3ff3ab[0x0][_0x4df7d7(0x135)]==_0x4df7d7(0x147))var _0x55a735=users[_0x4df7d7(0x147)];else{if(_0x3ff3ab[0x0][_0x4df7d7(0x135)]==_0x4df7d7(0x158))var _0x55a735=users[_0x4df7d7(0x158)];else{if(_0x3ff3ab[0x0][_0x4df7d7(0x135)]==_0x4df7d7(0x110))var _0x55a735=users[_0x4df7d7(0x110)];else{if(_0x3ff3ab[0x0][_0x4df7d7(0x135)]==_0x4df7d7(0x11c))var _0x55a735=users['French'];else{if(_0x3ff3ab[0x0][_0x4df7d7(0x135)]==_0x4df7d7(0x127))var _0x55a735=users[_0x4df7d7(0x11e)];else{if(_0x3ff3ab[0x0][_0x4df7d7(0x135)]=='Chinese')var _0x55a735=users[_0x4df7d7(0x121)];else{if(_0x3ff3ab[0x0][_0x4df7d7(0x135)]==_0x4df7d7(0x14a))var _0x55a735=users[_0x4df7d7(0x16b)];}}}}}}}_0xfb7f56['render'](_0x4df7d7(0x140),{'success':_0x4ad9e9['flash'](_0x4df7d7(0x170)),'errors':_0x4ad9e9[_0x4df7d7(0x179)](_0x4df7d7(0x154)),'role':_0xbb828f,'profile':_0x413f6b,'user':_0x38746b,'master_shop':_0x3ff3ab,'language':_0x55a735});}catch(_0x378cca){console[_0x4df7d7(0x11d)](_0x378cca);}}),router[a0_0x8ab115(0x142)](a0_0x8ab115(0x166),auth,async(_0x5e5ef4,_0xdb808c)=>{const _0x461b36=a0_0x8ab115;try{const _0x3baf69=_0x5e5ef4[_0x461b36(0x115)]['id'],_0x3d47aa=await customer[_0x461b36(0x143)](_0x3baf69),{name:_0x42fa5c,address:_0x16f367,mobile:_0xfd7f4d,email:_0x1cf225,receivable:_0x25e9c3,payable:_0x287105,contactperson:_0x443fd7,landline:_0x18f289,less_percent_edit:_0x2bfea2,edit_type_org:_0x11b2c1,edit_res_address:_0x5123ba,edit_business_start_year:_0x1f1bbb,edit_credit_limit:_0x32ea6d,edit_term_pay:_0x38316f}=_0x5e5ef4[_0x461b36(0x13d)];if(typeof _0x2bfea2==_0x461b36(0x156))var _0x2dbdd7=[_0x5e5ef4['body'][_0x461b36(0x111)]];else var _0x2dbdd7=[..._0x5e5ef4[_0x461b36(0x13d)][_0x461b36(0x111)]];const _0x2237b3=_0x2dbdd7[_0x461b36(0x169)](_0x202abc=>{return _0x202abc={'less':_0x202abc};});_0x3d47aa['name']=_0x42fa5c,_0x3d47aa['address']=_0x16f367,_0x3d47aa[_0x461b36(0x12d)]=_0xfd7f4d,_0x3d47aa[_0x461b36(0x124)]=_0x1cf225,_0x3d47aa[_0x461b36(0x15b)]=_0x25e9c3,_0x3d47aa[_0x461b36(0x16f)]=_0x287105,_0x3d47aa['contactperson']=_0x443fd7,_0x3d47aa['landline']=_0x18f289,_0x3d47aa['customer_discount']=_0x2237b3,_0x3d47aa[_0x461b36(0x17b)]=_0x11b2c1,_0x3d47aa[_0x461b36(0x16a)]=_0x1f1bbb,_0x3d47aa[_0x461b36(0x157)]=_0x32ea6d,_0x3d47aa['terms_of_payments']=_0x38316f,_0x3d47aa['res_address']=_0x5123ba;const _0x51536b=await _0x3d47aa[_0x461b36(0x114)]();_0x5e5ef4[_0x461b36(0x179)](_0x461b36(0x170),'customer\x20update\x20successfully'),_0xdb808c[_0x461b36(0x139)](_0x461b36(0x167));}catch(_0x5d6e18){console[_0x461b36(0x11d)](_0x5d6e18);}}),router[a0_0x8ab115(0x155)](a0_0x8ab115(0x17e),auth,async(_0x4ff061,_0x2c2076)=>{const _0x3acf6b=a0_0x8ab115;try{const {username:_0x22dca7,email:_0xe48cd7,role:_0x4d27cb}=_0x4ff061['user'],_0xa97cd5=_0x4ff061[_0x3acf6b(0x176)],_0x4040f0=await profile[_0x3acf6b(0x17d)]({'email':_0xa97cd5[_0x3acf6b(0x124)]}),_0x20edc8=await master_shop[_0x3acf6b(0x15e)]();console[_0x3acf6b(0x11d)](_0x3acf6b(0x144),_0x20edc8),console[_0x3acf6b(0x11d)](_0x4ff061['params']['id']);const _0x136a1c=await customer[_0x3acf6b(0x17d)]({'_id':_0x4ff061[_0x3acf6b(0x115)]['id']});console['log'](_0x3acf6b(0x128),_0x136a1c);const _0x207a5e=await c_payment_data[_0x3acf6b(0x15e)]({'customer':_0x136a1c[_0x3acf6b(0x120)]});console[_0x3acf6b(0x11d)](_0x207a5e);const _0x5e5e4c=await c_payment_data[_0x3acf6b(0x14b)]([{'$match':{'customer':_0x136a1c['name']}},{'$match':{'reason':_0x3acf6b(0x12c)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x3acf6b(0x175)}}}]);console[_0x3acf6b(0x11d)](_0x3acf6b(0x132),_0x5e5e4c);const _0x315d2e=await c_payment_data[_0x3acf6b(0x14b)]([{'$match':{'customer':_0x136a1c[_0x3acf6b(0x120)]}},{'$match':{'reason':_0x3acf6b(0x146)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x3acf6b(0x175)}}}]);console[_0x3acf6b(0x11d)]('receivable_sum',_0x315d2e);if(_0x20edc8[0x0][_0x3acf6b(0x135)]==_0x3acf6b(0x136)){var _0x3e22b4=users[_0x3acf6b(0x129)];console['log'](_0x3e22b4);}else{if(_0x20edc8[0x0][_0x3acf6b(0x135)]==_0x3acf6b(0x147))var _0x3e22b4=users['Hindi'];else{if(_0x20edc8[0x0][_0x3acf6b(0x135)]==_0x3acf6b(0x158))var _0x3e22b4=users[_0x3acf6b(0x158)];else{if(_0x20edc8[0x0][_0x3acf6b(0x135)]==_0x3acf6b(0x110))var _0x3e22b4=users['Spanish'];else{if(_0x20edc8[0x0]['language']==_0x3acf6b(0x11c))var _0x3e22b4=users[_0x3acf6b(0x11c)];else{if(_0x20edc8[0x0]['language']==_0x3acf6b(0x127))var _0x3e22b4=users[_0x3acf6b(0x11e)];else{if(_0x20edc8[0x0][_0x3acf6b(0x135)]=='Chinese')var _0x3e22b4=users['Chinese'];else{if(_0x20edc8[0x0][_0x3acf6b(0x135)]=='Arabic\x20(ae)')var _0x3e22b4=users['Arabic'];}}}}}}}_0x2c2076[_0x3acf6b(0x15f)](_0x3acf6b(0x11b),{'success':_0x4ff061[_0x3acf6b(0x179)]('success'),'errors':_0x4ff061[_0x3acf6b(0x179)](_0x3acf6b(0x154)),'role':_0xa97cd5,'profile':_0x4040f0,'payment':_0x207a5e,'payable':_0x5e5e4c,'receivable':_0x315d2e,'master_shop':_0x20edc8,'language':_0x3e22b4});}catch(_0x30ee61){console['log'](_0x30ee61);}}),router['get'](a0_0x8ab115(0x164),auth,async(_0x2d691a,_0x257588)=>{const _0x549d6d=a0_0x8ab115;try{const _0x4addab=new excelJS[(_0x549d6d(0x17c))](),_0x4fb874=_0x4addab[_0x549d6d(0x126)](_0x549d6d(0x14c));return _0x4fb874[_0x549d6d(0x13e)]=[{'header':'ID','key':_0x549d6d(0x17a),'width':0xa},{'header':_0x549d6d(0x153),'key':_0x549d6d(0x152),'width':0xa},{'header':_0x549d6d(0x17f),'key':_0x549d6d(0x15d),'width':0xa},{'header':_0x549d6d(0x15c),'key':_0x549d6d(0x15c),'width':0xa},{'header':'address','key':_0x549d6d(0x16c),'width':0xa},{'header':'mobile','key':_0x549d6d(0x12d),'width':0xa},{'header':_0x549d6d(0x124),'key':'email','width':0xa}],_0x257588[_0x549d6d(0x11a)](_0x549d6d(0x178),_0x549d6d(0x16e)),_0x257588[_0x549d6d(0x11a)](_0x549d6d(0x11f),_0x549d6d(0x13f)),_0x4addab[_0x549d6d(0x173)][_0x549d6d(0x12f)](_0x257588)[_0x549d6d(0x116)](()=>{const _0x502ed3=_0x549d6d;_0x257588[_0x502ed3(0x172)](0xc8);});}catch(_0x4ce65b){_0x257588[_0x549d6d(0x172)](0x190)[_0x549d6d(0x12b)]({'errors':_0x4ce65b[_0x549d6d(0x14f)]});}});const storage1=multer['diskStorage']({'destination':(_0x500504,_0x3e5352,_0x14e25f)=>{const _0x461a26=a0_0x8ab115;_0x14e25f(null,_0x461a26(0x162));},'filename':(_0x2cea93,_0x18eed9,_0x2c3329)=>{_0x2c3329(null,Date['now']()+_0x18eed9['originalname']);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x8ab115(0x13a),auth,uploadMigrate['single'](a0_0x8ab115(0x163)),async(_0x586abd,_0x562680)=>{const _0x1729a3=a0_0x8ab115,_0x14c0ff=_0x586abd[_0x1729a3(0x12a)]['filename'],_0x4dc03c=await xlsx[_0x1729a3(0x131)](_0x1729a3(0x134)+_0x14c0ff);let _0x458198=_0x4dc03c['SheetNames'],_0x3a1c54=xlsx[_0x1729a3(0x138)][_0x1729a3(0x14d)](_0x4dc03c[_0x1729a3(0x165)][_0x458198[0x0]]);for(const _0x214ed1 of _0x3a1c54){const _0x25d699=_0x214ed1['ID'],_0x55e6ff=_0x214ed1[_0x1729a3(0x153)],_0xfcbcfb=_0x214ed1[_0x1729a3(0x17f)],_0x254dc9=_0x214ed1[_0x1729a3(0x15c)],_0x7e971b=_0x214ed1[_0x1729a3(0x16c)],_0x3516ee=_0x214ed1[_0x1729a3(0x12d)],_0x47dd4c=_0x214ed1[_0x1729a3(0x124)];try{let _0x50d653=await customer['findOne']({'name':_0x55e6ff});if(!_0x50d653){const _0xd1622c=new customer({'name':_0x55e6ff,'ID':_0x25d699,'SalesmanCode':_0xfcbcfb,'SalesmanName':_0x254dc9,'address':_0x7e971b,'mobile':_0x3516ee,'email':_0x47dd4c});_0x50d653=await _0xd1622c[_0x1729a3(0x114)](),_0x586abd[_0x1729a3(0x179)](_0x1729a3(0x170),_0x55e6ff+_0x1729a3(0x122));}else _0x586abd['flash'](_0x1729a3(0x112),_0x55e6ff+'\x20Failed');}catch(_0x595155){_0x562680['status'](0x1f4)[_0x1729a3(0x180)]({'proderror':_0x595155[_0x1729a3(0x14f)],'aproduct':ProductName});}}_0x562680[_0x1729a3(0x139)](_0x1729a3(0x167));}),module['exports']=router;