function a0_0x5a2c(){const _0xf4c4b8=['xlsx','\x20added\x20successfully','log','flash','business_start_year','30JsYBen','public/Migration','receivable_sum','utils','SheetNames','PName','Portuguese','customer_data','487071mevqNg','landline','../models/all_models','348shutuR','Content-Disposition','mobile','render','116dnDgLk','Arabic','params','send','Sale\x20Return','get','save','8ZUTGOi','master','less_percent_edit','now','English','exports','express','French','Sale','Hindi','status','language','setHeader','customer\x20add\x20successfully','customer_docs','attachment;\x20filename=customer_Migration_File.xlsx','customer_sa','/view','receivable','c_payments','557942DCwPsp','customer','redirect','columns','Workbook','50QxlDPE','customer_payment','Arabic\x20(ae)','post','383698IGYpPE','amount','forEach','PUnits','data','590939ocThWu','German','findOne','originalname','find','payable','Chinese','_id','14556FBVccV','PBrands','success','credit_limit','write','sale_return','payable_sum','sale','18078rLYRLC','English\x20(US)','../public/language/languages.json','$amount','address','/view/:id','Portuguese\x20(BR)','Customers','Router','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','SalesmanCode','280qccfur','user','reason','sheet_to_json','customer_product_fule','multer','4028409FktAaE','/customer_sa/view','body','errors','type_organization','customer\x20update\x20successfully','/view/payment/:id','aggregate','element','name','single','message','map','Name','customer_discount','Spanish','less_percent','email','findById','/products_export_migrate_file','string','SalesmanName'];a0_0x5a2c=function(){return _0xf4c4b8;};return a0_0x5a2c();}const a0_0x3de84f=a0_0x163c;function a0_0x163c(_0x541298,_0x4d5e35){const _0x5a2c46=a0_0x5a2c();return a0_0x163c=function(_0x163cec,_0x4d164f){_0x163cec=_0x163cec-0x1a2;let _0x4dbbab=_0x5a2c46[_0x163cec];return _0x4dbbab;},a0_0x163c(_0x541298,_0x4d5e35);}(function(_0x2cd95f,_0x41ae69){const _0x4ff088=a0_0x163c,_0x3f840d=_0x2cd95f();while(!![]){try{const _0x2c692b=parseInt(_0x4ff088(0x210))/0x1+parseInt(_0x4ff088(0x1e7))/0x2*(parseInt(_0x4ff088(0x1ac))/0x3)+-parseInt(_0x4ff088(0x1a4))/0x4*(parseInt(_0x4ff088(0x207))/0x5)+-parseInt(_0x4ff088(0x1d8))/0x6*(parseInt(_0x4ff088(0x20b))/0x7)+-parseInt(_0x4ff088(0x1ee))/0x8*(-parseInt(_0x4ff088(0x1bd))/0x9)+-parseInt(_0x4ff088(0x1b7))/0xa*(parseInt(_0x4ff088(0x202))/0xb)+parseInt(_0x4ff088(0x1e3))/0xc*(parseInt(_0x4ff088(0x1e0))/0xd);if(_0x2c692b===_0x41ae69)break;else _0x3f840d['push'](_0x3f840d['shift']());}catch(_0x95d604){_0x3f840d['push'](_0x3f840d['shift']());}}}(a0_0x5a2c,0xb59eb));const express=require(a0_0x3de84f(0x1f4)),app=express(),router=express[a0_0x3de84f(0x1b4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x3de84f(0x1e2)),auth=require('../middleware/auth'),users=require(a0_0x3de84f(0x1ae)),excelJS=require('exceljs'),xlsx=require(a0_0x3de84f(0x1d3)),multer=require(a0_0x3de84f(0x1bc));router[a0_0x3de84f(0x1ec)](a0_0x3de84f(0x1ff),auth,async(_0x3f0911,_0x427417)=>{const _0x1f2f84=a0_0x3de84f;try{const {username:_0x15feaf,email:_0x3986ce,role:_0x53f261}=_0x3f0911[_0x1f2f84(0x1b8)],_0x30a3ed=_0x3f0911['user'],_0x2366b7=await profile[_0x1f2f84(0x212)]({'email':_0x30a3ed[_0x1f2f84(0x1ce)]}),_0x40fff1=await master_shop[_0x1f2f84(0x214)](),_0x2dca29=await staff[_0x1f2f84(0x212)]({'email':_0x30a3ed[_0x1f2f84(0x1ce)]}),_0x320dc5=await customer[_0x1f2f84(0x214)]({'agent_id':_0x2dca29['_id']}),_0x39ef3b=await customer[_0x1f2f84(0x1c4)]([{'$match':{'agent_id':_0x2dca29[_0x1f2f84(0x1a3)]['valueOf']()}},{'$lookup':{'from':_0x1f2f84(0x201),'localField':'name','foreignField':_0x1f2f84(0x203),'as':'customer_docs'}}]),_0x3cb566=_0x39ef3b['map'](_0x3b4975=>{const _0x44c57c=_0x1f2f84;console[_0x44c57c(0x1d5)](_0x44c57c(0x20f),_0x3b4975);var _0x30520c=0x0,_0x45a5df=0x0;return _0x3b4975[_0x44c57c(0x1fc)][_0x44c57c(0x20d)](_0x2156c8=>{const _0x41b985=_0x44c57c;console[_0x41b985(0x1d5)](_0x41b985(0x1c5),_0x2156c8),_0x2156c8[_0x41b985(0x1b9)]==_0x41b985(0x1f6)?_0x30520c+=_0x2156c8['amount']:_0x45a5df+=_0x2156c8[_0x41b985(0x20c)];}),_0x3b4975[_0x44c57c(0x1ab)]=parseFloat(_0x30520c)+0x0,_0x3b4975[_0x44c57c(0x1a9)]=parseFloat(_0x45a5df)+0x0,_0x3b4975;});if(_0x40fff1[0x0][_0x1f2f84(0x1f9)]==_0x1f2f84(0x1ad)){var _0x108a30=users[_0x1f2f84(0x1f2)];console[_0x1f2f84(0x1d5)](_0x108a30);}else{if(_0x40fff1[0x0]['language']=='Hindi')var _0x108a30=users['Hindi'];else{if(_0x40fff1[0x0]['language']==_0x1f2f84(0x211))var _0x108a30=users['German'];else{if(_0x40fff1[0x0][_0x1f2f84(0x1f9)]==_0x1f2f84(0x1cc))var _0x108a30=users[_0x1f2f84(0x1cc)];else{if(_0x40fff1[0x0]['language']==_0x1f2f84(0x1f5))var _0x108a30=users[_0x1f2f84(0x1f5)];else{if(_0x40fff1[0x0]['language']=='Portuguese\x20(BR)')var _0x108a30=users['Portuguese'];else{if(_0x40fff1[0x0][_0x1f2f84(0x1f9)]==_0x1f2f84(0x1a2))var _0x108a30=users[_0x1f2f84(0x1a2)];else{if(_0x40fff1[0x0][_0x1f2f84(0x1f9)]==_0x1f2f84(0x209))var _0x108a30=users[_0x1f2f84(0x1e8)];}}}}}}}_0x427417[_0x1f2f84(0x1e6)](_0x1f2f84(0x1fe),{'success':_0x3f0911[_0x1f2f84(0x1d6)](_0x1f2f84(0x1a6)),'errors':_0x3f0911[_0x1f2f84(0x1d6)]('errors'),'user':_0x320dc5,'role':_0x30a3ed,'profile':_0x2366b7,'master_shop':_0x40fff1,'language':_0x108a30,'agent_id':_0x2dca29[_0x1f2f84(0x1a3)],'payment':_0x3cb566,'staff_arr':_0x2dca29});}catch(_0x556afb){console['log'](_0x556afb);}}),router[a0_0x3de84f(0x20a)](a0_0x3de84f(0x1ff),auth,async(_0x47462f,_0x11690a)=>{const _0x4ab680=a0_0x3de84f;try{const {name:_0xd969bf,address:_0x279e61,mobile:_0x15244a,email:_0x5e1f68,receivable:_0x16d23e,payable:_0x85c20,contactperson:_0x523f72,landline:_0xdfcc37,agent_id:_0x1e6ef6,less_percent:_0x5749da,type_org:_0x756835,res_address:_0x5152f4,business_start_year:_0x5a3885,credit_limit:_0xb45f0a,term_pay:_0x5d2d67}=_0x47462f[_0x4ab680(0x1bf)];if(typeof _0x5749da==_0x4ab680(0x1d1))var _0x31613b=[_0x47462f['body'][_0x4ab680(0x1cd)]];else var _0x31613b=[..._0x47462f[_0x4ab680(0x1bf)][_0x4ab680(0x1cd)]];const _0xff882f=_0x31613b[_0x4ab680(0x1c9)](_0x4467ec=>{return _0x4467ec={'less':_0x4467ec};}),_0x514028=new customer({'name':_0xd969bf,'address':_0x279e61,'mobile':_0x15244a,'email':_0x5e1f68,'receivable':_0x16d23e,'payable':_0x85c20,'customer_discount':_0xff882f,'contactperson':_0x523f72,'landline':_0xdfcc37,'agent_id':_0x1e6ef6,'res_address':_0x5152f4,'type_organization':_0x756835,'business_start_year':_0x5a3885,'credit_limit':_0xb45f0a,'terms_of_payments':_0x5d2d67}),_0x5801e5=await _0x514028[_0x4ab680(0x1ed)]();_0x47462f['flash'](_0x4ab680(0x1a6),_0x4ab680(0x1fb)),_0x11690a[_0x4ab680(0x204)](_0x4ab680(0x1be));}catch(_0x4531cb){console[_0x4ab680(0x1d5)](_0x4531cb);}}),router[a0_0x3de84f(0x1ec)]('/view/:id',auth,async(_0x270869,_0x1f5c5f)=>{const _0x358ccc=a0_0x3de84f;try{const {username:_0x4e21d7,email:_0x5e17fa,role:_0x212ece}=_0x270869['user'],_0x1aa957=_0x270869[_0x358ccc(0x1b8)],_0x8d9cec=await profile[_0x358ccc(0x212)]({'email':_0x1aa957[_0x358ccc(0x1ce)]}),_0x256c3b=await master_shop['find']();console[_0x358ccc(0x1d5)](_0x358ccc(0x1ef),_0x256c3b);const _0x510b55=_0x270869[_0x358ccc(0x1e9)]['id'],_0x3896b7=await customer[_0x358ccc(0x1cf)](_0x510b55);console['log'](_0x3896b7);if(_0x256c3b[0x0][_0x358ccc(0x1f9)]==_0x358ccc(0x1ad)){var _0x3cf934=users[_0x358ccc(0x1f2)];console[_0x358ccc(0x1d5)](_0x3cf934);}else{if(_0x256c3b[0x0]['language']==_0x358ccc(0x1f7))var _0x3cf934=users[_0x358ccc(0x1f7)];else{if(_0x256c3b[0x0][_0x358ccc(0x1f9)]==_0x358ccc(0x211))var _0x3cf934=users[_0x358ccc(0x211)];else{if(_0x256c3b[0x0][_0x358ccc(0x1f9)]=='Spanish')var _0x3cf934=users[_0x358ccc(0x1cc)];else{if(_0x256c3b[0x0][_0x358ccc(0x1f9)]==_0x358ccc(0x1f5))var _0x3cf934=users[_0x358ccc(0x1f5)];else{if(_0x256c3b[0x0]['language']==_0x358ccc(0x1b2))var _0x3cf934=users[_0x358ccc(0x1de)];else{if(_0x256c3b[0x0]['language']=='Chinese')var _0x3cf934=users[_0x358ccc(0x1a2)];else{if(_0x256c3b[0x0]['language']==_0x358ccc(0x209))var _0x3cf934=users[_0x358ccc(0x1e8)];}}}}}}}_0x1f5c5f['render'](_0x358ccc(0x1fe),{'success':_0x270869[_0x358ccc(0x1d6)](_0x358ccc(0x1a6)),'errors':_0x270869['flash']('errors'),'role':_0x1aa957,'profile':_0x8d9cec,'user':_0x3896b7,'master_shop':_0x256c3b,'language':_0x3cf934});}catch(_0x25b534){console[_0x358ccc(0x1d5)](_0x25b534);}}),router[a0_0x3de84f(0x20a)](a0_0x3de84f(0x1b1),auth,async(_0x33b15d,_0x2f8221)=>{const _0x42f155=a0_0x3de84f;try{const _0x1838cc=_0x33b15d[_0x42f155(0x1e9)]['id'],_0x341c43=await customer[_0x42f155(0x1cf)](_0x1838cc),{name:_0x3a7ba6,address:_0x319ec7,mobile:_0x368ab4,email:_0x3faf6a,receivable:_0x54a202,payable:_0x54fa61,contactperson:_0x38dbea,landline:_0xb8b9b,less_percent_edit:_0x220480,edit_type_org:_0x3953ee,edit_res_address:_0x4c87d6,edit_business_start_year:_0x4e38ee,edit_credit_limit:_0x278a3b,edit_term_pay:_0xf5bfe6}=_0x33b15d[_0x42f155(0x1bf)];if(typeof _0x220480==_0x42f155(0x1d1))var _0x45d7db=[_0x33b15d[_0x42f155(0x1bf)][_0x42f155(0x1f0)]];else var _0x45d7db=[..._0x33b15d[_0x42f155(0x1bf)]['less_percent_edit']];const _0x1f7bf5=_0x45d7db[_0x42f155(0x1c9)](_0x19615f=>{return _0x19615f={'less':_0x19615f};});_0x341c43[_0x42f155(0x1c6)]=_0x3a7ba6,_0x341c43[_0x42f155(0x1b0)]=_0x319ec7,_0x341c43[_0x42f155(0x1e5)]=_0x368ab4,_0x341c43[_0x42f155(0x1ce)]=_0x3faf6a,_0x341c43[_0x42f155(0x200)]=_0x54a202,_0x341c43[_0x42f155(0x215)]=_0x54fa61,_0x341c43['contactperson']=_0x38dbea,_0x341c43[_0x42f155(0x1e1)]=_0xb8b9b,_0x341c43[_0x42f155(0x1cb)]=_0x1f7bf5,_0x341c43[_0x42f155(0x1c1)]=_0x3953ee,_0x341c43[_0x42f155(0x1d7)]=_0x4e38ee,_0x341c43[_0x42f155(0x1a7)]=_0x278a3b,_0x341c43['terms_of_payments']=_0xf5bfe6,_0x341c43['res_address']=_0x4c87d6;const _0x51aae3=await _0x341c43['save']();_0x33b15d[_0x42f155(0x1d6)](_0x42f155(0x1a6),_0x42f155(0x1c2)),_0x2f8221[_0x42f155(0x204)](_0x42f155(0x1be));}catch(_0x4a253a){console['log'](_0x4a253a);}}),router[a0_0x3de84f(0x1ec)](a0_0x3de84f(0x1c3),auth,async(_0x4210d,_0x523c3b)=>{const _0x2de2a9=a0_0x3de84f;try{const {username:_0x318939,email:_0x301b06,role:_0x3f967f}=_0x4210d[_0x2de2a9(0x1b8)],_0x7a587e=_0x4210d['user'],_0x4726f9=await profile[_0x2de2a9(0x212)]({'email':_0x7a587e[_0x2de2a9(0x1ce)]}),_0x3672c0=await master_shop['find']();console[_0x2de2a9(0x1d5)](_0x2de2a9(0x1ef),_0x3672c0),console[_0x2de2a9(0x1d5)](_0x4210d[_0x2de2a9(0x1e9)]['id']);const _0x3e90bd=await customer[_0x2de2a9(0x212)]({'_id':_0x4210d['params']['id']});console[_0x2de2a9(0x1d5)](_0x2de2a9(0x1df),_0x3e90bd);const _0x4454f8=await c_payment_data[_0x2de2a9(0x214)]({'customer':_0x3e90bd[_0x2de2a9(0x1c6)]});console[_0x2de2a9(0x1d5)](_0x4454f8);const _0x3f0e1=await c_payment_data[_0x2de2a9(0x1c4)]([{'$match':{'customer':_0x3e90bd[_0x2de2a9(0x1c6)]}},{'$match':{'reason':_0x2de2a9(0x1f6)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x2de2a9(0x1d5)](_0x2de2a9(0x1aa),_0x3f0e1);const _0x2f7f81=await c_payment_data[_0x2de2a9(0x1c4)]([{'$match':{'customer':_0x3e90bd[_0x2de2a9(0x1c6)]}},{'$match':{'reason':_0x2de2a9(0x1eb)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x2de2a9(0x1af)}}}]);console[_0x2de2a9(0x1d5)](_0x2de2a9(0x1da),_0x2f7f81);if(_0x3672c0[0x0][_0x2de2a9(0x1f9)]==_0x2de2a9(0x1ad)){var _0x2f5389=users['English'];console[_0x2de2a9(0x1d5)](_0x2f5389);}else{if(_0x3672c0[0x0][_0x2de2a9(0x1f9)]==_0x2de2a9(0x1f7))var _0x2f5389=users[_0x2de2a9(0x1f7)];else{if(_0x3672c0[0x0][_0x2de2a9(0x1f9)]==_0x2de2a9(0x211))var _0x2f5389=users['German'];else{if(_0x3672c0[0x0]['language']=='Spanish')var _0x2f5389=users[_0x2de2a9(0x1cc)];else{if(_0x3672c0[0x0]['language']==_0x2de2a9(0x1f5))var _0x2f5389=users['French'];else{if(_0x3672c0[0x0][_0x2de2a9(0x1f9)]==_0x2de2a9(0x1b2))var _0x2f5389=users['Portuguese'];else{if(_0x3672c0[0x0][_0x2de2a9(0x1f9)]==_0x2de2a9(0x1a2))var _0x2f5389=users['Chinese'];else{if(_0x3672c0[0x0][_0x2de2a9(0x1f9)]==_0x2de2a9(0x209))var _0x2f5389=users[_0x2de2a9(0x1e8)];}}}}}}}_0x523c3b[_0x2de2a9(0x1e6)](_0x2de2a9(0x208),{'success':_0x4210d[_0x2de2a9(0x1d6)](_0x2de2a9(0x1a6)),'errors':_0x4210d[_0x2de2a9(0x1d6)](_0x2de2a9(0x1c0)),'role':_0x7a587e,'profile':_0x4726f9,'payment':_0x4454f8,'payable':_0x3f0e1,'receivable':_0x2f7f81,'master_shop':_0x3672c0,'language':_0x2f5389});}catch(_0xad497){console[_0x2de2a9(0x1d5)](_0xad497);}}),router[a0_0x3de84f(0x1ec)](a0_0x3de84f(0x1d0),auth,async(_0x1eb697,_0x5f5d24)=>{const _0x58cde7=a0_0x3de84f;try{const _0x2375c7=new excelJS[(_0x58cde7(0x206))](),_0x23c483=_0x2375c7['addWorksheet'](_0x58cde7(0x1b3));return _0x23c483[_0x58cde7(0x205)]=[{'header':'ID','key':_0x58cde7(0x1dd),'width':0xa},{'header':_0x58cde7(0x1ca),'key':_0x58cde7(0x1a5),'width':0xa},{'header':_0x58cde7(0x1b6),'key':_0x58cde7(0x20e),'width':0xa},{'header':_0x58cde7(0x1d2),'key':_0x58cde7(0x1d2),'width':0xa},{'header':'address','key':_0x58cde7(0x1b0),'width':0xa},{'header':_0x58cde7(0x1e5),'key':'mobile','width':0xa},{'header':_0x58cde7(0x1ce),'key':_0x58cde7(0x1ce),'width':0xa}],_0x5f5d24[_0x58cde7(0x1fa)]('Content-Type',_0x58cde7(0x1b5)),_0x5f5d24[_0x58cde7(0x1fa)](_0x58cde7(0x1e4),_0x58cde7(0x1fd)),_0x2375c7[_0x58cde7(0x1d3)][_0x58cde7(0x1a8)](_0x5f5d24)['then'](()=>{const _0x17179f=_0x58cde7;_0x5f5d24[_0x17179f(0x1f8)](0xc8);});}catch(_0x54f666){_0x5f5d24[_0x58cde7(0x1f8)](0x190)[_0x58cde7(0x1ea)]({'errors':_0x54f666[_0x58cde7(0x1c8)]});}});const storage1=multer['diskStorage']({'destination':(_0xf7e61b,_0x53d735,_0x56ccc2)=>{const _0x7292d6=a0_0x3de84f;_0x56ccc2(null,_0x7292d6(0x1d9));},'filename':(_0x4424b4,_0xce2da3,_0x47350f)=>{const _0x4afd0f=a0_0x3de84f;_0x47350f(null,Date[_0x4afd0f(0x1f1)]()+_0xce2da3[_0x4afd0f(0x213)]);}}),uploadMigrate=multer({'storage':storage1});router['post']('/customer_import_migrate_file',auth,uploadMigrate[a0_0x3de84f(0x1c7)](a0_0x3de84f(0x1bb)),async(_0x2270bf,_0x485717)=>{const _0x3dcff8=a0_0x3de84f,_0x1761f7=_0x2270bf['file']['filename'],_0xa9e25f=await xlsx['readFile']('public/Migration/'+_0x1761f7);let _0x1c5aae=_0xa9e25f[_0x3dcff8(0x1dc)],_0x3064dd=xlsx[_0x3dcff8(0x1db)][_0x3dcff8(0x1ba)](_0xa9e25f['Sheets'][_0x1c5aae[0x0]]);for(const _0x363496 of _0x3064dd){const _0x2a70a8=_0x363496['ID'],_0x4c189e=_0x363496['Name'],_0x40ccaa=_0x363496[_0x3dcff8(0x1b6)],_0x1a30de=_0x363496[_0x3dcff8(0x1d2)],_0x147422=_0x363496[_0x3dcff8(0x1b0)],_0x1649bc=_0x363496['mobile'],_0x1f2364=_0x363496[_0x3dcff8(0x1ce)];try{let _0x303582=await customer[_0x3dcff8(0x212)]({'name':_0x4c189e});if(!_0x303582){const _0x202351=new customer({'name':_0x4c189e,'ID':_0x2a70a8,'SalesmanCode':_0x40ccaa,'SalesmanName':_0x1a30de,'address':_0x147422,'mobile':_0x1649bc,'email':_0x1f2364});_0x303582=await _0x202351[_0x3dcff8(0x1ed)](),_0x2270bf['flash']('success',_0x4c189e+_0x3dcff8(0x1d4));}else _0x2270bf['flash']('error',_0x4c189e+'\x20Failed');}catch(_0x14520e){_0x485717[_0x3dcff8(0x1f8)](0x1f4)['json']({'proderror':_0x14520e[_0x3dcff8(0x1c8)],'aproduct':ProductName});}}_0x485717[_0x3dcff8(0x204)](_0x3dcff8(0x1be));}),module[a0_0x3de84f(0x1f3)]=router;