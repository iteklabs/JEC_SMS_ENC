const a0_0x4f1c0b=a0_0x4a03;(function(_0x37ba9a,_0x8803d1){const _0x1a1c81=a0_0x4a03,_0x46a69b=_0x37ba9a();while(!![]){try{const _0x438bd9=-parseInt(_0x1a1c81(0x150))/0x1+-parseInt(_0x1a1c81(0x1ee))/0x2+-parseInt(_0x1a1c81(0x22f))/0x3+-parseInt(_0x1a1c81(0x198))/0x4+parseInt(_0x1a1c81(0x16d))/0x5*(parseInt(_0x1a1c81(0x123))/0x6)+parseInt(_0x1a1c81(0x1f1))/0x7*(-parseInt(_0x1a1c81(0x22b))/0x8)+-parseInt(_0x1a1c81(0x252))/0x9*(-parseInt(_0x1a1c81(0x266))/0xa);if(_0x438bd9===_0x8803d1)break;else _0x46a69b['push'](_0x46a69b['shift']());}catch(_0x188d43){_0x46a69b['push'](_0x46a69b['shift']());}}}(a0_0x3b33,0x24478));const express=require(a0_0x4f1c0b(0x1bc)),res=require('express/lib/response'),app=express(),router=express[a0_0x4f1c0b(0x1d9)](),multer=require(a0_0x4f1c0b(0x1c1)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x4f1c0b(0x240)),XLSX=require(a0_0x4f1c0b(0x1ed)),PDFDocument=require(a0_0x4f1c0b(0x18c)),fs=require('fs'),blobStream=require(a0_0x4f1c0b(0x122)),JsBarcode=require('jsbarcode'),{Canvas}=require(a0_0x4f1c0b(0x214)),pdf=require(a0_0x4f1c0b(0x1f5)),path=require(a0_0x4f1c0b(0x118)),mongoose=require(a0_0x4f1c0b(0x10b)),cheerio=require('cheerio');function a0_0x3b33(){const _0x45f287=['totalGross','<div\x20class=\x22row\x22>','landscape','0.1in','blob-stream','1638474ELcihC','$sale_product.stock','/total_sales_reports/view','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','toLocaleString','/reports/dsrr/view','getDate','$sale_product.adj_discount','products','product_details','$products.product_details','dataqty','Household','<td\x20colspan=\x22','</script>','cat_brand','Products\x20find_data','length','German','<div\x20class=\x22col-sm-11\x22>','dssr_view_admin','top','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','$products.qty','/dl_excel','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','<tr>','slice','long','log','success','each','$products.product_details.prod_id','bank','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','$sale_product.discount','<th\x20colspan=\x272\x27>SOLD</th>','Hindi','<td\x20class=\x22row_data\x22><b>','/getDSSR_no','French','error','render','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','234812kGCxwg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','$NetPrice','<p>SALES\x20REPORTS</p>','border-top','product_details.product_name','$product_details.product_stock','$product_stock','<td\x20colspan=\x223\x22><b>TOTAL<b>','numeric','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','sales_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','/agent/view','<th>\x20ITEM\x20CODE\x20</th>','$sale_product.quantity','$brand','valueOf','$product_info.name','<td\x20class=\x22cat_data\x22>','</table>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','$products.product_details.category','toFixed','reduce','$product_docs','date_include','5IgkjZM','flash','\x20-\x20','setHeader','!cols','<th\x20rowspan=\x272\x27>Category</th>','attachment;\x20filename=\x22sales_report.xlsx\x22','<p>FINISHED\x20GOODS\x20INVENTORY</p>','$product','Portuguese','NetPrice','date','$products.adj_discount','Checking:\x20','catch','Arabic\x20(ae)','exports','Spanish','agent_sales','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','$sale_product._id','brand','toISOString','$discount','000000','/agent_reports/sales_ad','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','Content-Disposition','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','$category','Chinese','pdfkit-table','$sale_product.prod_cat','PDF\x20Generation\x20Error:','language','get','</b></td>','$product_code','totalPrice','<td\x20class=\x22row_data\x22>0</td>','border-right','sumqty','utils','983120zbOxSI','json','$sales_info._id','<th>\x20INCOMING\x20</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','totalQTYsum','customer','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','</tr>','<div\x20\x20id=\x22table-conatainer\x22>','email','includes','sales_staff_id','60mm','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','findOne','<th\x20rowspan=\x272\x27>Products</th>','table\x20tr','beg_bal','referenceNumber','/agent_reports/pdf','redirect','Portuguese\x20(BR)','$_id.category','$products.product_details.brand','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','</th>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','</div>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','category','push','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','check_no','express','buffer','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','brandCount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','multer','20mm','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','/dsrr_admin/pdf_admin','/dsrr/view','totalQty','</p>','stock','<td\x20class=\x22cat_data\x22><b>FG</b></td>','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<td\x20class=\x22cat_data\x22></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','status','salesman_data','$sale_product','$name','$_id.date','Asia/Manila','send','<table>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','$due_date','window.print();','setDate','Router','$sale_product.product_name','sales_ext','<div\x20style=\x22page-break-before:\x20always;\x22></div>','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','thick','$product_info.gross_price','$customer','<thead>','\x20-\x20STD','$sale_product.isFG','NumberFormat','Arabic','product_code','$product.product_name','/dev/null','8.5in','$product.quantity','product_info','/dsrr/pdf','xlsx','497442tfISeS','!merges','load','117383oJKYVl','$products.NetPrice','</td>','params','html-pdf','create','thin','$product_list.product_stock','dsi','<th>\x20BEG\x20BALANCE\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','No\x20data\x20was\x20Found!','adj_discount','$product_info.brand','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','sales_bkg','$check_no','15in','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<p>INVENTORY\x20SUMMARY</p>','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','product_docs','<h1>JAKA\x20EQUITIES\x20CORP</h1>','sale_product.product_code','Error\x20generating\x20PDF','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','$_id.status_data','name','note','product_name','<script>','save','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','$product_name','canvas','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','/agent_reports/pdf_admin','errors','</tbody>','/getDSSR_no_sales','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','product_stock','due_date','DateTimeFormat','$products.discount','format','application/pdf','$product_info.category','$bank','aggregate','$sale_product.totalprice','<td\x20class=\x22row_data\x22>','td,\x20th','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','write','136nkSSGT','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','html','Types','1023KjaUSO','amount','true','Content-Type','$sales_info.name','$product_details','discount','$_id.dsi','book_append_sheet','$totalGross','<th>X-Truck</th>','post','left','cash','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','$sales_staff_id','colspan','exceljs','Sales\x20Report','right','prod_cat','find','Letter','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','staffs','/agent/pdf','border-left','$adj_discount','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','</thead>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','false','$totalQty','$dsi','rowspan','3897iaRWiR','dsi_sales','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','/agent_reports/view','\x22><b></b></td>','forEach','book_new','aoa_to_sheet','filter','replace','/inventory_sum/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','Products\x20warehouse_data','$product_info','$cash','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','$products','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','excel','$sale_product.product_code','20560tOXTyE','totalQTY','$sales_info','en-US','qty','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','<p>','split','findById','<th>\x20ENDING\x20BALANCE\x20</th>','bottom','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','pipe','$sale_product.real_qty_unit_val','window.onload\x20=\x20function()\x20{','toStream','\x20-\x20HH','map','$amount','English','medium','$_id.brand','isFG','user','isArray','$product_details.product_name','Standard','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','Products\x20master','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','attr','<tbody>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','$_id.customer','getMonth','\x22\x20class=\x22cat_data\x22>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','$products.product_details.gross_price','/balance/pdf','border-bottom','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','body','$date','text','mongoose','trim','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','_id','sales_man_code','total','balanced','$product_list','$product_info.product_code','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','English\x20(US)','style','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','path','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','/balance/view','then','\x22><b>'];a0_0x3b33=function(){return _0x45f287;};return a0_0x3b33();}router[a0_0x4f1c0b(0x190)](a0_0x4f1c0b(0x11b),auth,async(_0xe19e8b,_0x548e35)=>{const _0x2b0304=a0_0x4f1c0b;try{const {username:_0x535f5c,email:_0x2dae3d,role:_0x1208c8}=_0xe19e8b[_0x2b0304(0x27d)],_0x22bc01=_0xe19e8b[_0x2b0304(0x27d)],_0x1b5665=await profile[_0x2b0304(0x1a8)]({'email':_0x22bc01['email']}),_0x14e1dd={'year':_0x2b0304(0x159),'month':_0x2b0304(0x140),'day':_0x2b0304(0x159)},_0x284d8d=await master_shop['find']();console[_0x2b0304(0x141)](_0x2b0304(0x282),_0x284d8d);const _0x1fe216=await product[_0x2b0304(0x244)]();console[_0x2b0304(0x141)](_0x2b0304(0x133),_0x1fe216);const _0x4cfc65=await warehouse[_0x2b0304(0x225)]([{'$unwind':_0x2b0304(0x234)},{'$lookup':{'from':_0x2b0304(0x12b),'localField':_0x2b0304(0x155),'foreignField':'name','as':_0x2b0304(0x207)}},{'$unwind':_0x2b0304(0x16b)},{'$project':{'product_name':_0x2b0304(0x27f),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);console[_0x2b0304(0x141)](_0x2b0304(0x25e),_0x4cfc65),_0x4cfc65[_0x2b0304(0x257)](_0x8bacd0=>{const _0x1a15e8=_0x2b0304,_0x4aa7b1=_0x1fe216[_0x1a15e8(0x277)](_0x52926e=>{const _0x3a5609=_0x1a15e8;_0x52926e['name']==_0x8bacd0[_0x3a5609(0x10e)]&&(_0x52926e[_0x3a5609(0x1c8)]=parseInt(_0x52926e[_0x3a5609(0x1c8)])+parseInt(_0x8bacd0[_0x3a5609(0x21d)]));});}),console[_0x2b0304(0x141)]('Products\x20find_data',_0x1fe216);if(_0x284d8d[0x0][_0x2b0304(0x18f)]==_0x2b0304(0x115))var _0x2f6cbd=users[_0x2b0304(0x279)];else{if(_0x284d8d[0x0][_0x2b0304(0x18f)]=='Hindi')var _0x2f6cbd=users[_0x2b0304(0x149)];else{if(_0x284d8d[0x0]['language']==_0x2b0304(0x135))var _0x2f6cbd=users[_0x2b0304(0x135)];else{if(_0x284d8d[0x0]['language']==_0x2b0304(0x17e))var _0x2f6cbd=users[_0x2b0304(0x17e)];else{if(_0x284d8d[0x0]['language']==_0x2b0304(0x14c))var _0x2f6cbd=users['French'];else{if(_0x284d8d[0x0][_0x2b0304(0x18f)]==_0x2b0304(0x1af))var _0x2f6cbd=users['Portuguese'];else{if(_0x284d8d[0x0][_0x2b0304(0x18f)]==_0x2b0304(0x18b))var _0x2f6cbd=users[_0x2b0304(0x18b)];else{if(_0x284d8d[0x0][_0x2b0304(0x18f)]==_0x2b0304(0x17c))var _0x2f6cbd=users[_0x2b0304(0x1e5)];}}}}}}}_0x548e35[_0x2b0304(0x14e)](_0x2b0304(0x111),{'success':_0xe19e8b['flash'](_0x2b0304(0x142)),'errors':_0xe19e8b[_0x2b0304(0x16e)](_0x2b0304(0x219)),'alldata':_0x1fe216,'profile':_0x1b5665,'master_shop':_0x284d8d,'role':_0x22bc01,'product_stock':_0x4cfc65,'language':_0x2f6cbd});}catch(_0x30e5bb){}});async function dataCheck(_0x538b19,_0x13aed6){const _0x4ec10a=a0_0x4f1c0b,_0x385bb1=await product['aggregate']([{'$group':{'_id':{'brand':_0x4ec10a(0x162),'category':_0x4ec10a(0x18a)},'products':{'$push':{'name':_0x4ec10a(0x1d0),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xf36896=[];_0xf36896[_0x4ec10a(0x132)]=[];for(let _0x5bba7e=0x0;_0x5bba7e<=_0x385bb1['length']-0x1;_0x5bba7e++){const _0xc9f224=_0x385bb1[_0x5bba7e];_0xf36896[_0x4ec10a(0x132)][_0x4ec10a(0x1b9)](_0xc9f224);}const _0x4ce0a7=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x4ec10a(0x162),'product_code':_0x4ec10a(0x192),'product_name':_0x4ec10a(0x1d0)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4fd6af=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x538b19,'$lte':_0x13aed6}}},{'$unwind':_0x4ec10a(0x175)},{'$group':{'_id':{'product_name':_0x4ec10a(0x1e7),'product_code':'$product.product_code'},'totalQTY':{'$sum':_0x4ec10a(0x1ea)}}}]);_0xf36896[_0x4ec10a(0x1ab)]=[];for(let _0x31b9a3=0x0;_0x31b9a3<=_0x4fd6af[_0x4ec10a(0x134)]-0x1;_0x31b9a3++){const _0xf2d0ee=_0x4fd6af[_0x31b9a3];_0xf36896[_0x4ec10a(0x1ab)]['push'](_0xf2d0ee);}const _0x292c52=await sales_sa[_0x4ec10a(0x225)]([{'$match':{'date':{'$gte':_0x538b19,'$lte':_0x13aed6}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':'staffs','localField':'sales_staff_id','foreignField':_0x4ec10a(0x10e),'as':'sales_info'}},{'$unwind':_0x4ec10a(0x268)},{'$unwind':_0x4ec10a(0x1cf)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x4ec10a(0x1da),'product_code':_0x4ec10a(0x265)},'totalQTY':{'$sum':_0x4ec10a(0x161)}}}]);console['log'](_0x292c52[0x0]),_0xf36896[_0x4ec10a(0x200)]=[];for(let _0x51d2b3=0x0;_0x51d2b3<=_0x292c52[_0x4ec10a(0x134)]-0x1;_0x51d2b3++){const _0x53e07b=_0x292c52[_0x51d2b3];_0xf36896[_0x4ec10a(0x200)][_0x4ec10a(0x1b9)](_0x53e07b);}const _0x2a3268=await sales_sa[_0x4ec10a(0x225)]([{'$match':{'date':{'$gte':_0x538b19,'$lte':_0x13aed6}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x4ec10a(0x23e)}}},{'$lookup':{'from':_0x4ec10a(0x247),'localField':_0x4ec10a(0x1a5),'foreignField':_0x4ec10a(0x10e),'as':'sales_info'}},{'$unwind':_0x4ec10a(0x268)},{'$unwind':_0x4ec10a(0x1cf)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x4ec10a(0x24e)}},{'$group':{'_id':{'product_name':_0x4ec10a(0x1da),'product_code':_0x4ec10a(0x265)},'totalQTY':{'$sum':_0x4ec10a(0x273)}}}]);_0xf36896[_0x4ec10a(0x1db)]=[];for(let _0x3a243c=0x0;_0x3a243c<=_0x2a3268[_0x4ec10a(0x134)]-0x1;_0x3a243c++){const _0x68e13a=_0x2a3268[_0x3a243c];_0xf36896['sales_ext'][_0x4ec10a(0x1b9)](_0x68e13a);}let _0x617f49='';for(let _0x27f315=0x0;_0x27f315<=_0x4ce0a7['length']-0x1;_0x27f315++){const _0x594777=_0x4ce0a7[_0x27f315];_0x617f49+=_0x4ec10a(0x13e),_0x617f49+=_0x4ec10a(0x1b2)+_0x594777['_id'][_0x4ec10a(0x1b8)]+_0x4ec10a(0x1f3),_0x617f49+=_0x4ec10a(0x1a1);for(let _0x321c60=0x0;_0x321c60<_0xf36896[_0x4ec10a(0x132)][_0x4ec10a(0x134)];_0x321c60++){const _0x2eee50=_0xf36896['cat_brand'][_0x321c60];if(_0x2eee50[_0x4ec10a(0x10e)]['category']==_0x594777[_0x4ec10a(0x10e)][_0x4ec10a(0x1b8)]){let _0x5baf87=[],_0x10cf70=[],_0x4e95d8=[];_0x5baf87[_0x2eee50[_0x4ec10a(0x10e)][_0x4ec10a(0x182)]]=[],_0x10cf70[_0x2eee50[_0x4ec10a(0x10e)][_0x4ec10a(0x182)]]=[],_0x4e95d8[_0x2eee50[_0x4ec10a(0x10e)][_0x4ec10a(0x182)]]=[];var _0x4ad8a5=0x0,_0x2eb66e=0x0,_0x1fe17a=0x0;for(let _0x1de1e9=0x0;_0x1de1e9<_0x2eee50[_0x4ec10a(0x12b)]['length'];_0x1de1e9++){const _0x6d256a=_0x2eee50['products'][_0x1de1e9];for(let _0x9af495=0x0;_0x9af495<=_0xf36896[_0x4ec10a(0x1ab)][_0x4ec10a(0x134)]-0x1;_0x9af495++){const _0xd047e9=_0xf36896['beg_bal'][_0x9af495];_0xd047e9[_0x4ec10a(0x10e)]['product_name']==_0x6d256a[_0x4ec10a(0x20d)]&&_0xd047e9[_0x4ec10a(0x10e)][_0x4ec10a(0x1e6)]==_0x6d256a[_0x4ec10a(0x1e6)]&&(_0x4ad8a5+=parseInt(_0xd047e9[_0x4ec10a(0x267)],0xa));}for(let _0x568625=0x0;_0x568625<=_0xf36896['sales_ext'][_0x4ec10a(0x134)]-0x1;_0x568625++){const _0x787d09=_0xf36896['sales_ext'][_0x568625];_0x787d09[_0x4ec10a(0x10e)][_0x4ec10a(0x20f)]==_0x6d256a[_0x4ec10a(0x20d)]&&_0x787d09[_0x4ec10a(0x10e)][_0x4ec10a(0x1e6)]==_0x6d256a['product_code']&&(_0x2eb66e+=parseFloat(_0x787d09[_0x4ec10a(0x267)],0xa)[_0x4ec10a(0x169)](0x2));}for(let _0x510af0=0x0;_0x510af0<=_0xf36896[_0x4ec10a(0x200)]['length']-0x1;_0x510af0++){const _0x48b5d7=_0xf36896['sales_bkg'][_0x510af0];_0x48b5d7[_0x4ec10a(0x10e)][_0x4ec10a(0x20f)]==_0x6d256a[_0x4ec10a(0x20d)]&&_0x48b5d7[_0x4ec10a(0x10e)]['product_code']==_0x6d256a['product_code']&&(_0x1fe17a+=parseInt(_0x48b5d7[_0x4ec10a(0x267)],0xa));}}const _0x482c29=new Intl['NumberFormat'](_0x4ec10a(0x269));var _0xcb0c65=_0x482c29[_0x4ec10a(0x221)](_0x4ad8a5);_0x5baf87[_0x2eee50[_0x4ec10a(0x10e)][_0x4ec10a(0x182)]][_0x4ec10a(0x1b9)](_0xcb0c65),_0x10cf70[_0x2eee50[_0x4ec10a(0x10e)][_0x4ec10a(0x182)]][_0x4ec10a(0x1b9)](_0x482c29['format'](_0x2eb66e)),_0x4e95d8[_0x2eee50[_0x4ec10a(0x10e)][_0x4ec10a(0x182)]][_0x4ec10a(0x1b9)](_0x482c29[_0x4ec10a(0x221)](_0x1fe17a));var _0x5308cd=_0x482c29[_0x4ec10a(0x221)](_0x4ad8a5-(_0x1fe17a+_0x2eb66e));_0x617f49+=_0x4ec10a(0x13e),_0x617f49+='<td\x20class=\x22row_data\x22></td>',_0x617f49+=_0x4ec10a(0x227)+_0x2eee50['_id'][_0x4ec10a(0x182)]+'</td>',_0x617f49+=_0x4ec10a(0x227)+_0x5baf87[_0x2eee50[_0x4ec10a(0x10e)]['brand']][0x0]+_0x4ec10a(0x1f3),_0x617f49+='<td\x20class=\x22row_data\x22>0</td>',_0x617f49+=_0x4ec10a(0x227)+_0x4e95d8[_0x2eee50[_0x4ec10a(0x10e)][_0x4ec10a(0x182)]][0x0]+'</td>',_0x617f49+=_0x4ec10a(0x227)+_0x10cf70[_0x2eee50['_id'][_0x4ec10a(0x182)]][0x0]+'</td>',_0x617f49+='<td\x20class=\x22row_data\x22>'+_0x5308cd+_0x4ec10a(0x1f3),_0x617f49+='</tr>';}}}return console['log'](_0xf36896[_0x4ec10a(0x200)]),_0x617f49;}router[a0_0x4f1c0b(0x23a)](a0_0x4f1c0b(0x105),auth,async(_0x1977be,_0x1fc0bd)=>{const _0x29df3d=a0_0x4f1c0b,{from_date:_0x106b07,to_date:_0x693aff}=_0x1977be[_0x29df3d(0x108)],_0x3dbde5=await dataCheck(_0x106b07,_0x693aff);{}let _0x3c2ef5='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x22b3f5=new Date(_0x106b07),_0x255324=new Date(_0x693aff);const _0x224f42={'year':_0x29df3d(0x159),'month':_0x29df3d(0x140),'day':_0x29df3d(0x159)},_0x15d198=new Intl[(_0x29df3d(0x21f))]('en-US',_0x224f42)[_0x29df3d(0x221)](_0x22b3f5),_0x3a89a8=new Intl['DateTimeFormat'](_0x29df3d(0x269),_0x224f42)['format'](_0x255324);_0x3c2ef5+=_0x29df3d(0x208),_0x3c2ef5+=_0x29df3d(0x174),_0x3c2ef5+=_0x29df3d(0x26c)+_0x15d198+'\x20-\x20'+_0x3a89a8+_0x29df3d(0x1c7),_0x3c2ef5+=_0x29df3d(0x11f),_0x3c2ef5+='<div\x20class=\x22col-sm-11\x22>',_0x3c2ef5+=_0x29df3d(0x1d4),_0x3c2ef5+=_0x29df3d(0x13e),_0x3c2ef5+=_0x29df3d(0x172),_0x3c2ef5+=_0x29df3d(0x1a9),_0x3c2ef5+=_0x29df3d(0x205)+_0x15d198+_0x29df3d(0x1b4),_0x3c2ef5+='<th\x20rowspan=\x272\x27>Production</th>',_0x3c2ef5+=_0x29df3d(0x148),_0x3c2ef5+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x3a89a8+_0x29df3d(0x1b4),_0x3c2ef5+=_0x29df3d(0x1a1),_0x3c2ef5+=_0x29df3d(0x13e),_0x3c2ef5+='<th>Booking</th>',_0x3c2ef5+=_0x29df3d(0x239),_0x3c2ef5+=_0x29df3d(0x1a1),_0x3c2ef5+=_0x3dbde5,_0x3c2ef5+=_0x29df3d(0x166),_0x3c2ef5+=_0x29df3d(0x1b6),_0x3c2ef5+=_0x29df3d(0x1b6);const _0x2634e5={'format':'Letter','orientation':_0x29df3d(0x120),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x29df3d(0x1e8)}}};pdf['create'](_0x3c2ef5,_0x2634e5)[_0x29df3d(0x275)](function(_0x1fead3,_0x9421a3){const _0xd6ac8c=_0x29df3d;if(_0x1fead3){_0x1fc0bd[_0xd6ac8c(0x1cd)](0x1f4)[_0xd6ac8c(0x1d3)](_0xd6ac8c(0x20a));return;}_0x1fc0bd[_0xd6ac8c(0x170)](_0xd6ac8c(0x232),_0xd6ac8c(0x222)),_0x9421a3['pipe'](_0x1fc0bd);});}),router['get'](a0_0x4f1c0b(0x15f),auth,async(_0x234e25,_0x2f5515)=>{const _0x48ea56=a0_0x4f1c0b;try{const {username:_0x252636,email:_0x5e9357,role:_0x2b6a46}=_0x234e25[_0x48ea56(0x27d)],_0x28f8ca=_0x234e25['user'],_0x515491=await profile[_0x48ea56(0x1a8)]({'email':_0x28f8ca['email']}),_0x390409={'year':'numeric','month':'long','day':_0x48ea56(0x159)},_0x4c699b=await master_shop[_0x48ea56(0x244)](),_0x43188c=await product[_0x48ea56(0x244)](),_0x314131=await warehouse[_0x48ea56(0x225)]([{'$unwind':_0x48ea56(0x234)},{'$lookup':{'from':_0x48ea56(0x12b),'localField':_0x48ea56(0x155),'foreignField':_0x48ea56(0x20d),'as':_0x48ea56(0x207)}},{'$unwind':_0x48ea56(0x16b)},{'$project':{'product_name':_0x48ea56(0x27f),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x48ea56(0x213),'product_stock':{'$sum':_0x48ea56(0x157)}}}]);if(_0x4c699b[0x0][_0x48ea56(0x18f)]==_0x48ea56(0x115))var _0x41b502=users[_0x48ea56(0x279)];else{if(_0x4c699b[0x0][_0x48ea56(0x18f)]==_0x48ea56(0x149))var _0x41b502=users[_0x48ea56(0x149)];else{if(_0x4c699b[0x0]['language']=='German')var _0x41b502=users[_0x48ea56(0x135)];else{if(_0x4c699b[0x0][_0x48ea56(0x18f)]==_0x48ea56(0x17e))var _0x41b502=users[_0x48ea56(0x17e)];else{if(_0x4c699b[0x0][_0x48ea56(0x18f)]==_0x48ea56(0x14c))var _0x41b502=users['French'];else{if(_0x4c699b[0x0][_0x48ea56(0x18f)]==_0x48ea56(0x1af))var _0x41b502=users[_0x48ea56(0x176)];else{if(_0x4c699b[0x0][_0x48ea56(0x18f)]==_0x48ea56(0x18b))var _0x41b502=users['Chinese'];else{if(_0x4c699b[0x0][_0x48ea56(0x18f)]==_0x48ea56(0x17c))var _0x41b502=users[_0x48ea56(0x1e5)];}}}}}}}_0x2f5515[_0x48ea56(0x14e)](_0x48ea56(0x17f),{'success':_0x234e25[_0x48ea56(0x16e)](_0x48ea56(0x142)),'errors':_0x234e25[_0x48ea56(0x16e)](_0x48ea56(0x219)),'alldata':_0x43188c,'profile':_0x515491,'master_shop':_0x4c699b,'role':_0x28f8ca,'product_stock':_0x314131,'language':_0x41b502});}catch(_0xe3db80){}});async function agentsdataCheck(_0x2e8ec6,_0x48572d){const _0x3971ee=a0_0x4f1c0b,_0x4eed5d=await product[_0x3971ee(0x225)]([{'$group':{'_id':{'brand':'$brand','category':_0x3971ee(0x18a)},'products':{'$push':{'name':'$name','product_code':_0x3971ee(0x192)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x181bb7=[];_0x181bb7[_0x3971ee(0x132)]=[];for(let _0x3defdc=0x0;_0x3defdc<=_0x4eed5d[_0x3971ee(0x134)]-0x1;_0x3defdc++){const _0xb58546=_0x4eed5d[_0x3defdc];_0x181bb7[_0x3971ee(0x132)][_0x3971ee(0x1b9)](_0xb58546);}const _0x3c5fa3=await product[_0x3971ee(0x225)]([{'$group':{'_id':{'category':_0x3971ee(0x18a)},'products':{'$push':{'brand':_0x3971ee(0x162),'product_code':_0x3971ee(0x192),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x3eab51=await product[_0x3971ee(0x225)]([{'$group':{'_id':{'category':_0x3971ee(0x18a),'brand':_0x3971ee(0x162)}}},{'$group':{'_id':_0x3971ee(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x31bf7d=await sales_sa[_0x3971ee(0x225)]([{'$match':{'date':{'$gte':_0x2e8ec6,'$lte':_0x48572d}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x3971ee(0x23e)}}},{'$lookup':{'from':_0x3971ee(0x247),'localField':_0x3971ee(0x1a5),'foreignField':_0x3971ee(0x10e),'as':_0x3971ee(0x15b)}},{'$unwind':_0x3971ee(0x268)},{'$unwind':_0x3971ee(0x1cf)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x3971ee(0x24e)}},{'$lookup':{'from':_0x3971ee(0x12b),'localField':_0x3971ee(0x209),'foreignField':_0x3971ee(0x1e6),'as':_0x3971ee(0x1eb)}},{'$unwind':_0x3971ee(0x25f)},{'$group':{'_id':{'sales_id':_0x3971ee(0x19a),'category':_0x3971ee(0x223),'brand':_0x3971ee(0x1fe)},'salesman_data':{'$first':_0x3971ee(0x233)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x3971ee(0x273),'product_details':{'prod_name':_0x3971ee(0x164),'product_code':'$product_info.product_code','category':_0x3971ee(0x223),'brand':_0x3971ee(0x1fe)}}}}}]);let _0x22bf05='';_0x22bf05+='<tr>',_0x22bf05+=_0x3971ee(0x167),_0x22bf05+=_0x3971ee(0x1a1),_0x22bf05+=_0x3971ee(0x13e),_0x22bf05+=_0x3971ee(0x1cb);for(let _0x5445f0=0x0;_0x5445f0<=_0x3c5fa3[_0x3971ee(0x134)]-0x1;_0x5445f0++){const _0x4ef6d9=_0x3c5fa3[_0x5445f0];for(let _0x5bc31b=0x0;_0x5bc31b<_0x3eab51[_0x3971ee(0x134)];_0x5bc31b++){const _0x1ee771=_0x3eab51[_0x5bc31b];_0x1ee771[_0x3971ee(0x10e)]==_0x4ef6d9[_0x3971ee(0x10e)]['category']&&(_0x22bf05+=_0x3971ee(0x130)+_0x1ee771[_0x3971ee(0x1bf)]+_0x3971ee(0x102)+_0x4ef6d9[_0x3971ee(0x10e)]['category']+'</td>');}}_0x22bf05+='<td\x20class=\x22cat_data\x22></td>',_0x22bf05+='</tr>',_0x22bf05+='<tr>',_0x22bf05+=_0x3971ee(0x107);for(let _0x464732=0x0;_0x464732<=_0x3c5fa3[_0x3971ee(0x134)]-0x1;_0x464732++){const _0x1e157e=_0x3c5fa3[_0x464732];for(let _0x4829cd=0x0;_0x4829cd<_0x181bb7[_0x3971ee(0x132)][_0x3971ee(0x134)];_0x4829cd++){const _0x32fe21=_0x181bb7[_0x3971ee(0x132)][_0x4829cd];_0x32fe21['_id']['category']==_0x1e157e['_id'][_0x3971ee(0x1b8)]&&(_0x22bf05+=_0x3971ee(0x165)+_0x32fe21['_id'][_0x3971ee(0x182)]+'</td>');}}_0x22bf05+=_0x3971ee(0x13d),_0x22bf05+=_0x3971ee(0x1a1);let _0x2671ba={'name':[],'dataqty':{}};for(let _0x49adbe=0x0;_0x49adbe<_0x181bb7['cat_brand'][_0x3971ee(0x134)];_0x49adbe++){const _0x5d5657=_0x181bb7[_0x3971ee(0x132)][_0x49adbe],_0x5f5d01=_0x5d5657[_0x3971ee(0x10e)][_0x3971ee(0x182)],_0x4c42f8=_0x5d5657[_0x3971ee(0x10e)][_0x3971ee(0x1b8)];!_0x2671ba['dataqty'][_0x5f5d01]&&(_0x2671ba[_0x3971ee(0x12e)][_0x5f5d01]={});!_0x2671ba[_0x3971ee(0x12e)][_0x5f5d01][_0x4c42f8]&&(_0x2671ba['dataqty'][_0x5f5d01][_0x4c42f8]=[]);for(let _0x91bb63=0x0;_0x91bb63<_0x31bf7d[_0x3971ee(0x134)];_0x91bb63++){const _0x5edc54=_0x31bf7d[_0x91bb63];if(_0x5f5d01===_0x5edc54[_0x3971ee(0x10e)]['brand']&&_0x4c42f8===_0x5edc54[_0x3971ee(0x10e)][_0x3971ee(0x1b8)]){const _0x7fe2a5=_0x5edc54[_0x3971ee(0x1ce)];!_0x2671ba[_0x3971ee(0x12e)][_0x5f5d01][_0x4c42f8][_0x7fe2a5]&&(_0x2671ba[_0x3971ee(0x12e)][_0x5f5d01][_0x4c42f8][_0x7fe2a5]=[]),_0x2671ba[_0x3971ee(0x12e)][_0x5f5d01][_0x4c42f8][_0x7fe2a5][_0x3971ee(0x1b9)](_0x5edc54[_0x3971ee(0x267)]),!_0x2671ba[_0x3971ee(0x20d)][_0x3971ee(0x1a4)](_0x7fe2a5)&&_0x2671ba[_0x3971ee(0x20d)]['push'](_0x7fe2a5);}}}_0x22bf05+='<tr>';for(let _0x556808=0x0;_0x556808<=_0x2671ba[_0x3971ee(0x20d)]['length']-0x1;_0x556808++){const _0x459ad8=_0x2671ba[_0x3971ee(0x20d)][_0x556808];_0x22bf05+=_0x3971ee(0x227)+_0x459ad8+_0x3971ee(0x1f3);var _0x5e4ebd=0x0,_0x4a1148=0x0;for(let _0x21bd85=0x0;_0x21bd85<=_0x181bb7['cat_brand'][_0x3971ee(0x134)]-0x1;_0x21bd85++){const _0x3923ed=_0x181bb7[_0x3971ee(0x132)][_0x21bd85];var _0x1eff1b=0x0;_0x2671ba[_0x3971ee(0x12e)][_0x3923ed[_0x3971ee(0x10e)][_0x3971ee(0x182)]][_0x3923ed['_id'][_0x3971ee(0x1b8)]][_0x459ad8]?(_0x1eff1b=_0x2671ba['dataqty'][_0x3923ed[_0x3971ee(0x10e)]['brand']][_0x3923ed[_0x3971ee(0x10e)][_0x3971ee(0x1b8)]][_0x459ad8][0x0],_0x22bf05+=_0x3971ee(0x227)+_0x1eff1b[_0x3971ee(0x169)](0x2)+_0x3971ee(0x1f3)):(_0x1eff1b=0x0,_0x22bf05+=_0x3971ee(0x227)+_0x1eff1b+_0x3971ee(0x1f3)),_0x5e4ebd+=parseFloat(_0x1eff1b[_0x3971ee(0x169)](0x2));}_0x22bf05+=_0x3971ee(0x227)+_0x5e4ebd[_0x3971ee(0x169)](0x2)+_0x3971ee(0x1f3);}return _0x22bf05+='</tr>',_0x22bf05;}router['post'](a0_0x4f1c0b(0x248),auth,async(_0x243f05,_0x133c9a)=>{const _0x3cbb65=a0_0x4f1c0b,{from_date:_0x208dfe,to_date:_0x2130b5}=_0x243f05[_0x3cbb65(0x108)],_0x5dd96c=await agentsdataCheck(_0x208dfe,_0x2130b5);{}let _0x3f64e4='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x59db7d=new Date(_0x208dfe),_0x45b82c=new Date(_0x2130b5);const _0x38a43a={'year':'numeric','month':_0x3cbb65(0x140),'day':_0x3cbb65(0x159)},_0x584c56=new Intl[(_0x3cbb65(0x21f))]('en-US',_0x38a43a)[_0x3cbb65(0x221)](_0x59db7d),_0x47593e=new Intl['DateTimeFormat'](_0x3cbb65(0x269),_0x38a43a)[_0x3cbb65(0x221)](_0x45b82c);_0x3f64e4+=_0x3cbb65(0x208),_0x3f64e4+=_0x3cbb65(0x153),_0x3f64e4+=_0x3cbb65(0x26c)+_0x584c56+_0x3cbb65(0x16f)+_0x47593e+'</p>',_0x3f64e4+=_0x3cbb65(0x11f),_0x3f64e4+=_0x3cbb65(0x136),_0x3f64e4+=_0x3cbb65(0x1d4),_0x3f64e4+=_0x5dd96c,_0x3f64e4+=_0x3cbb65(0x166),_0x3f64e4+='</div>',_0x3f64e4+=_0x3cbb65(0x1b6);const _0x4b1cf3={'format':'Letter','orientation':_0x3cbb65(0x120),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x3cbb65(0x1e8)}}};pdf[_0x3cbb65(0x1f6)](_0x3f64e4,_0x4b1cf3)['toStream'](function(_0x2f6e04,_0x436aeb){const _0x207557=_0x3cbb65;if(_0x2f6e04){_0x133c9a[_0x207557(0x1cd)](0x1f4)[_0x207557(0x1d3)](_0x207557(0x20a));return;}_0x133c9a[_0x207557(0x170)](_0x207557(0x232),'application/pdf'),_0x436aeb[_0x207557(0x272)](_0x133c9a);});}),router[a0_0x4f1c0b(0x190)](a0_0x4f1c0b(0x186),auth,async(_0x5e414f,_0xf6755c)=>{const _0x2448ae=a0_0x4f1c0b;try{const {username:_0x5cbb4a,email:_0x5cbcf6,role:_0x4b1760}=_0x5e414f[_0x2448ae(0x27d)],_0x24b94b=_0x5e414f[_0x2448ae(0x27d)],_0x1a6e7e=await profile[_0x2448ae(0x1a8)]({'email':_0x24b94b['email']}),_0x4cb1c6={'year':'numeric','month':_0x2448ae(0x140),'day':_0x2448ae(0x159)},_0x25bcf9=await master_shop[_0x2448ae(0x244)](),_0x11a4c0=await staff[_0x2448ae(0x1a8)]({'email':_0x24b94b[_0x2448ae(0x1a3)]}),_0xf873a5=await product['find'](),_0x5398a1=await warehouse[_0x2448ae(0x225)]([{'$unwind':_0x2448ae(0x234)},{'$lookup':{'from':_0x2448ae(0x12b),'localField':_0x2448ae(0x155),'foreignField':_0x2448ae(0x20d),'as':_0x2448ae(0x207)}},{'$unwind':_0x2448ae(0x16b)},{'$project':{'product_name':_0x2448ae(0x27f),'product_stock':_0x2448ae(0x156)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]),_0x222028=await staff[_0x2448ae(0x244)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x25bcf9[0x0]['language']==_0x2448ae(0x115))var _0x23ce8c=users[_0x2448ae(0x279)];else{if(_0x25bcf9[0x0][_0x2448ae(0x18f)]=='Hindi')var _0x23ce8c=users[_0x2448ae(0x149)];else{if(_0x25bcf9[0x0][_0x2448ae(0x18f)]=='German')var _0x23ce8c=users[_0x2448ae(0x135)];else{if(_0x25bcf9[0x0]['language']==_0x2448ae(0x17e))var _0x23ce8c=users[_0x2448ae(0x17e)];else{if(_0x25bcf9[0x0]['language']=='French')var _0x23ce8c=users[_0x2448ae(0x14c)];else{if(_0x25bcf9[0x0]['language']==_0x2448ae(0x1af))var _0x23ce8c=users[_0x2448ae(0x176)];else{if(_0x25bcf9[0x0][_0x2448ae(0x18f)]=='Chinese')var _0x23ce8c=users[_0x2448ae(0x18b)];else{if(_0x25bcf9[0x0][_0x2448ae(0x18f)]==_0x2448ae(0x17c))var _0x23ce8c=users[_0x2448ae(0x1e5)];}}}}}}}_0xf6755c[_0x2448ae(0x14e)]('dsi_sales_admin',{'success':_0x5e414f[_0x2448ae(0x16e)](_0x2448ae(0x142)),'errors':_0x5e414f[_0x2448ae(0x16e)](_0x2448ae(0x219)),'alldata':_0xf873a5,'profile':_0x1a6e7e,'master_shop':_0x25bcf9,'role':_0x24b94b,'product_stock':_0x5398a1,'language':_0x23ce8c,'staff_arr':_0x11a4c0,'staff_data_all':_0x222028});}catch(_0x46e4f8){_0xf6755c[_0x2448ae(0x199)](_0x46e4f8);}});async function agentsdataDSICheck_admin(_0x3c3dce,_0x2d7596,_0x4c9766,_0x304805){const _0xdd3a76=a0_0x4f1c0b,_0x4f1885=await product[_0xdd3a76(0x225)]([{'$group':{'_id':{'brand':_0xdd3a76(0x162),'category':_0xdd3a76(0x18a)},'products':{'$push':{'name':_0xdd3a76(0x1d0),'product_code':_0xdd3a76(0x192)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3f1d27=[];_0x3f1d27['cat_brand']=[];for(let _0x30a2ca=0x0;_0x30a2ca<=_0x4f1885[_0xdd3a76(0x134)]-0x1;_0x30a2ca++){const _0x1bcebd=_0x4f1885[_0x30a2ca];_0x3f1d27['cat_brand'][_0xdd3a76(0x1b9)](_0x1bcebd);}const _0xf5c107=await product[_0xdd3a76(0x225)]([{'$group':{'_id':{'category':_0xdd3a76(0x18a)},'products':{'$push':{'brand':_0xdd3a76(0x162),'product_code':_0xdd3a76(0x192),'product_name':_0xdd3a76(0x1d0)}}}},{'$sort':{'_id.category':-0x1}}]),_0x79ba5=await product['aggregate']([{'$group':{'_id':{'category':_0xdd3a76(0x18a),'brand':'$brand'}}},{'$group':{'_id':_0xdd3a76(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2e22fb=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3c3dce,'$lte':_0x2d7596},'sales_staff_id':_0x4c9766,'sale_product.isFG':_0xdd3a76(0x24e)}},{'$unwind':_0xdd3a76(0x1cf)},{'$match':{'sale_product.isFG':_0xdd3a76(0x24e)}},{'$lookup':{'from':_0xdd3a76(0x12b),'localField':_0xdd3a76(0x209),'foreignField':_0xdd3a76(0x1e6),'as':_0xdd3a76(0x1eb)}},{'$unwind':_0xdd3a76(0x25f)},{'$group':{'_id':{'dsi':_0xdd3a76(0x250),'date':_0xdd3a76(0x109),'customer':_0xdd3a76(0x1e0)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0xdd3a76(0x273),'NetPrice':_0xdd3a76(0x226),'discount':_0xdd3a76(0x147),'adj_discount':_0xdd3a76(0x12a),'product_details':{'prod_name':_0xdd3a76(0x164),'product_code':_0xdd3a76(0x113),'category':_0xdd3a76(0x223),'brand':_0xdd3a76(0x1fe),'gross_price':_0xdd3a76(0x1df)}}}}},{'$unwind':_0xdd3a76(0x262)},{'$group':{'_id':{'dsi':_0xdd3a76(0x236),'date':_0xdd3a76(0x1d1),'customer':_0xdd3a76(0x100),'category':_0xdd3a76(0x168),'brand':_0xdd3a76(0x1b1)},'totalQty':{'$sum':_0xdd3a76(0x13a)},'totalGross':{'$sum':{'$multiply':[_0xdd3a76(0x13a),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0xdd3a76(0x179)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0xdd3a76(0x236),'date':'$_id.date','customer':_0xdd3a76(0x100)},'totalQty':{'$sum':_0xdd3a76(0x24f)},'totalGross':{'$sum':_0xdd3a76(0x238)},'NetPrice':{'$sum':_0xdd3a76(0x152)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0xdd3a76(0x24a)},'products':{'$push':{'qty':'$totalQty','category':_0xdd3a76(0x1b0),'brand':'$_id.brand','product_details':_0xdd3a76(0x234)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x363beb=[],_0x4a2d84={},_0x5bca17={},_0x11e6ea={};var _0x88e0a=0x0,_0x2003f3=0x0,_0x2cba5a=0x0,_0x2cb8cc=0x0,_0x46bce6=0x0;const _0x2f0cea=0x6;for(let _0x3b5aa7=0x0;_0x3b5aa7<=_0x2e22fb[_0xdd3a76(0x134)]-0x1;_0x3b5aa7++){const _0x205ec4=_0x2e22fb[_0x3b5aa7];let _0x8d3110='<tr>';_0x8d3110+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x205ec4[_0xdd3a76(0x10e)][_0xdd3a76(0x1f9)]+_0xdd3a76(0x1f3),_0x8d3110+=_0xdd3a76(0x189)+_0x205ec4[_0xdd3a76(0x10e)][_0xdd3a76(0x178)]+'</td>',_0x8d3110+=_0xdd3a76(0x189)+_0x205ec4[_0xdd3a76(0x10e)][_0xdd3a76(0x19e)]+_0xdd3a76(0x1f3);let _0x702ed1={};var _0x25b1aa=0x0;for(let _0x472618=0x0;_0x472618<=_0x205ec4[_0xdd3a76(0x12b)][_0xdd3a76(0x134)]-0x1;_0x472618++){const _0xf9d3dc=_0x205ec4[_0xdd3a76(0x12b)][_0x472618];_0x702ed1[_0xf9d3dc['brand']+'-'+_0xf9d3dc['category']]=_0xf9d3dc[_0xdd3a76(0x26a)];const _0x5de06e=_0xf9d3dc[_0xdd3a76(0x182)]+'-'+_0xf9d3dc[_0xdd3a76(0x1b8)];!_0x4a2d84[_0x5de06e]&&(_0x4a2d84[_0x5de06e]=0x0),!Array[_0xdd3a76(0x27e)](_0x11e6ea[_0x5de06e])&&(_0x11e6ea[_0x5de06e]=[]),!Array[_0xdd3a76(0x27e)](_0x11e6ea[_0x5de06e])&&(_0x11e6ea[_0x5de06e]=[]),_0x4a2d84[_0x5de06e]+=_0xf9d3dc['qty'],_0x11e6ea[_0x5de06e]['push'](_0xf9d3dc['qty']),_0x25b1aa++;}for(let _0x13bf2a=0x0;_0x13bf2a<=_0x3f1d27[_0xdd3a76(0x132)][_0xdd3a76(0x134)]-0x1;_0x13bf2a++){const _0x45fe27=_0x3f1d27[_0xdd3a76(0x132)][_0x13bf2a],_0x46cb71=_0x45fe27[_0xdd3a76(0x10e)]['brand']+'-'+_0x45fe27[_0xdd3a76(0x10e)][_0xdd3a76(0x1b8)];_0x8d3110+=_0xdd3a76(0x24d)+(_0x702ed1[_0x46cb71]!==undefined?_0x702ed1[_0x46cb71]['toFixed'](0x2):'')+'</td>';}_0x2cba5a=_0x205ec4['discount']+_0x205ec4[_0xdd3a76(0x1fd)],_0x8d3110+=_0xdd3a76(0x146)+formatNumber(parseFloat(_0x205ec4['totalQty'],0x2)[_0xdd3a76(0x169)](0x2))+_0xdd3a76(0x1f3),_0x8d3110+=_0xdd3a76(0x146)+formatNumber(_0x205ec4[_0xdd3a76(0x11e)]['toFixed'](0x2))+_0xdd3a76(0x1f3),_0x8d3110+=_0xdd3a76(0x146)+formatNumber(_0x2cba5a)+'</td>',_0x8d3110+=_0xdd3a76(0x146)+formatNumber(_0x205ec4[_0xdd3a76(0x177)][_0xdd3a76(0x169)](0x2))+_0xdd3a76(0x1f3),_0x8d3110+=_0xdd3a76(0x1a1);var _0x4976b3=parseFloat(_0x205ec4['totalQty'][_0xdd3a76(0x169)](0x3));_0x88e0a+=_0x4976b3,console[_0xdd3a76(0x141)](_0xdd3a76(0x110),_0x88e0a+'\x20<>\x20'+_0x4976b3),_0x2003f3+=parseFloat(_0x205ec4[_0xdd3a76(0x177)][_0xdd3a76(0x169)](0x2)),_0x2cb8cc+=_0x2cba5a,_0x46bce6+=parseFloat(_0x205ec4[_0xdd3a76(0x11e)][_0xdd3a76(0x169)](0x2));if(_0x3b5aa7==_0x2e22fb[_0xdd3a76(0x134)]-0x1){_0x8d3110+=_0xdd3a76(0x13e),_0x8d3110+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x8d3110+='</td>';for(let _0xe7731=0x0;_0xe7731<=_0x3f1d27[_0xdd3a76(0x132)][_0xdd3a76(0x134)]-0x1;_0xe7731++){const _0x1a215b=_0x3f1d27[_0xdd3a76(0x132)][_0xe7731],_0x39fb9b=_0x1a215b['_id'][_0xdd3a76(0x182)]+'-'+_0x1a215b[_0xdd3a76(0x10e)][_0xdd3a76(0x1b8)];!_0x11e6ea[_0x39fb9b]&&(_0x11e6ea[_0x39fb9b]=[]);const _0x13a7d1=_0x11e6ea[_0x39fb9b]['reduce']((_0x115115,_0x5a666e)=>_0x115115+_0x5a666e,0x0);_0x8d3110+=_0xdd3a76(0x1a0)+(_0x13a7d1!==undefined?formatNumber(_0x13a7d1[_0xdd3a76(0x169)](0x2)):'')+_0xdd3a76(0x191);}_0x8d3110+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x88e0a[_0xdd3a76(0x169)](0x2),0x2)+'</b></td>',_0x8d3110+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x46bce6)+_0xdd3a76(0x191),_0x8d3110+=_0xdd3a76(0x271)+formatNumber(_0x2cb8cc)+_0xdd3a76(0x191),_0x8d3110+=_0xdd3a76(0x271)+formatNumber(_0x2003f3)+'</b></td>',_0x8d3110+='</tr>';}_0x363beb[_0xdd3a76(0x1b9)](_0x8d3110);}function _0x24c6ed(_0x14e44a,_0x2a0c48){const _0x105b5c=_0xdd3a76,_0x33a932=[];for(let _0x28812d=0x0;_0x28812d<=_0x14e44a['length']-0x1;_0x28812d+=_0x2a0c48){_0x33a932[_0x105b5c(0x1b9)](_0x14e44a[_0x105b5c(0x13f)](_0x28812d,_0x28812d+_0x2a0c48));}return _0x33a932;}const _0x3b0fe0=_0x24c6ed(_0x363beb,_0x2f0cea);let _0x737e2b='';return _0x3b0fe0[_0xdd3a76(0x257)]((_0x225463,_0x3a7f57)=>{const _0x28afaf=_0xdd3a76;_0x3a7f57>0x0&&(_0x737e2b+=_0x28afaf(0x1dc));_0x737e2b+=_0x28afaf(0x1d4),_0x737e2b+=_0x28afaf(0x1e1),_0x737e2b+=_0x28afaf(0x13e),_0x737e2b+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x737e2b+=_0x28afaf(0x1a1),_0x737e2b+=_0x28afaf(0x13e),_0x737e2b+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x36b911=0x0;_0x36b911<=_0xf5c107[_0x28afaf(0x134)]-0x1;_0x36b911++){const _0x199bc1=_0xf5c107[_0x36b911];for(let _0x4b04d4=0x0;_0x4b04d4<_0x79ba5[_0x28afaf(0x134)];_0x4b04d4++){const _0x52b83e=_0x79ba5[_0x4b04d4];_0x52b83e[_0x28afaf(0x10e)]===_0x199bc1[_0x28afaf(0x10e)][_0x28afaf(0x1b8)]&&(_0x737e2b+=_0x28afaf(0x130)+_0x52b83e[_0x28afaf(0x1bf)]+'\x22\x20class=\x22cat_data\x22>'+_0x199bc1[_0x28afaf(0x10e)][_0x28afaf(0x1b8)]+_0x28afaf(0x1f3));}}_0x737e2b+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x737e2b+=_0x28afaf(0x1a1),_0x737e2b+=_0x28afaf(0x13e),_0x737e2b+=_0x28afaf(0x246),_0x737e2b+=_0x28afaf(0x1c3),_0x737e2b+=_0x28afaf(0x263);for(let _0x29bba0=0x0;_0x29bba0<=_0xf5c107['length']-0x1;_0x29bba0++){const _0x27b891=_0xf5c107[_0x29bba0];for(let _0x18c812=0x0;_0x18c812<_0x3f1d27[_0x28afaf(0x132)][_0x28afaf(0x134)];_0x18c812++){const _0x528cfa=_0x3f1d27['cat_brand'][_0x18c812];_0x528cfa[_0x28afaf(0x10e)][_0x28afaf(0x1b8)]===_0x27b891['_id'][_0x28afaf(0x1b8)]&&(_0x737e2b+=_0x28afaf(0x165)+_0x528cfa[_0x28afaf(0x10e)][_0x28afaf(0x182)]+_0x28afaf(0x1f3));}}_0x737e2b+=_0x28afaf(0x13d),_0x737e2b+=_0x28afaf(0x14f),_0x737e2b+=_0x28afaf(0x1ba),_0x737e2b+=_0x28afaf(0x212),_0x737e2b+=_0x28afaf(0x1a1),_0x737e2b+='</thead>',_0x737e2b+=_0x28afaf(0xfe),_0x225463['forEach'](_0x3b392f=>{_0x737e2b+=_0x3b392f;}),_0x737e2b+=_0x28afaf(0x21a),_0x737e2b+=_0x28afaf(0x166);}),_0x737e2b;}async function agentsdataDSICheck_admin_excel(_0x3270e6,_0x1bc1de,_0x23fbe6,_0x51b65e){const _0x2b6e18=a0_0x4f1c0b,_0x224b63=await product[_0x2b6e18(0x225)]([{'$group':{'_id':{'brand':_0x2b6e18(0x162),'category':_0x2b6e18(0x18a)},'products':{'$push':{'name':_0x2b6e18(0x1d0),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x195b7f=[];_0x195b7f['cat_brand']=[];for(let _0x3f5b26=0x0;_0x3f5b26<=_0x224b63[_0x2b6e18(0x134)]-0x1;_0x3f5b26++){const _0x33ba9a=_0x224b63[_0x3f5b26];_0x195b7f[_0x2b6e18(0x132)]['push'](_0x33ba9a);}const _0x1ef03a=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x2b6e18(0x162),'product_code':_0x2b6e18(0x192),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x5ef16b=await product[_0x2b6e18(0x225)]([{'$group':{'_id':{'category':_0x2b6e18(0x18a),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1159a1=await sales_sa[_0x2b6e18(0x225)]([{'$match':{'date':{'$gte':_0x3270e6,'$lte':_0x1bc1de},'sales_staff_id':_0x23fbe6,'sale_product.isFG':_0x2b6e18(0x24e)}},{'$unwind':_0x2b6e18(0x1cf)},{'$match':{'sale_product.isFG':_0x2b6e18(0x24e)}},{'$lookup':{'from':_0x2b6e18(0x12b),'localField':_0x2b6e18(0x209),'foreignField':_0x2b6e18(0x1e6),'as':_0x2b6e18(0x1eb)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':_0x2b6e18(0x109),'customer':_0x2b6e18(0x1e0)},'totalQty':{'$sum':_0x2b6e18(0x273)},'products':{'$push':{'qty':_0x2b6e18(0x273),'NetPrice':_0x2b6e18(0x226),'discount':'$sale_product.discount','adj_discount':_0x2b6e18(0x12a),'product_details':{'prod_name':_0x2b6e18(0x164),'product_code':_0x2b6e18(0x113),'category':'$product_info.category','brand':_0x2b6e18(0x1fe),'gross_price':_0x2b6e18(0x1df)}}}}},{'$unwind':_0x2b6e18(0x262)},{'$group':{'_id':{'dsi':_0x2b6e18(0x236),'date':'$_id.date','customer':_0x2b6e18(0x100),'category':_0x2b6e18(0x168),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x2b6e18(0x13a)},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x2b6e18(0x220)},'adj_discount':{'$sum':_0x2b6e18(0x179)},'product_details':{'$first':_0x2b6e18(0x12d)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x2b6e18(0x100)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x2b6e18(0x238)},'NetPrice':{'$sum':_0x2b6e18(0x152)},'discount':{'$sum':_0x2b6e18(0x184)},'adj_discount':{'$sum':_0x2b6e18(0x24a)},'products':{'$push':{'qty':_0x2b6e18(0x24f),'category':'$_id.category','brand':_0x2b6e18(0x27b),'product_details':_0x2b6e18(0x234)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x8a252f=[],_0x201533={},_0x45b92f={},_0x1b90a2={};var _0x20b7d4=0x0,_0x2a58dd=0x0,_0x451866=0x0,_0x48d5f5=0x0,_0x1e24c2=0x0;const _0x9f487a=0x16345785d8a0000;for(let _0x2fe029=0x0;_0x2fe029<=_0x1159a1[_0x2b6e18(0x134)]-0x1;_0x2fe029++){const _0x5647b0=_0x1159a1[_0x2fe029];let _0x1735bb='<tr>';_0x1735bb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5647b0['_id'][_0x2b6e18(0x1f9)]+_0x2b6e18(0x1f3),_0x1735bb+=_0x2b6e18(0x189)+_0x5647b0[_0x2b6e18(0x10e)][_0x2b6e18(0x178)]+'</td>',_0x1735bb+=_0x2b6e18(0x189)+_0x5647b0[_0x2b6e18(0x10e)][_0x2b6e18(0x19e)]+_0x2b6e18(0x1f3);let _0x50c500={};var _0x143b74=0x0;for(let _0x50371e=0x0;_0x50371e<=_0x5647b0[_0x2b6e18(0x12b)]['length']-0x1;_0x50371e++){const _0x3836e8=_0x5647b0[_0x2b6e18(0x12b)][_0x50371e];_0x50c500[_0x3836e8[_0x2b6e18(0x182)]+'-'+_0x3836e8[_0x2b6e18(0x1b8)]]=_0x3836e8[_0x2b6e18(0x26a)];const _0x4b48f9=_0x3836e8['brand']+'-'+_0x3836e8[_0x2b6e18(0x1b8)];!_0x201533[_0x4b48f9]&&(_0x201533[_0x4b48f9]=0x0),!Array[_0x2b6e18(0x27e)](_0x1b90a2[_0x4b48f9])&&(_0x1b90a2[_0x4b48f9]=[]),!Array[_0x2b6e18(0x27e)](_0x1b90a2[_0x4b48f9])&&(_0x1b90a2[_0x4b48f9]=[]),_0x201533[_0x4b48f9]+=_0x3836e8[_0x2b6e18(0x26a)],_0x1b90a2[_0x4b48f9][_0x2b6e18(0x1b9)](_0x3836e8[_0x2b6e18(0x26a)]),_0x143b74++;}for(let _0x56ce7e=0x0;_0x56ce7e<=_0x195b7f['cat_brand']['length']-0x1;_0x56ce7e++){const _0x27fc2f=_0x195b7f[_0x2b6e18(0x132)][_0x56ce7e],_0xc12c1f=_0x27fc2f['_id'][_0x2b6e18(0x182)]+'-'+_0x27fc2f[_0x2b6e18(0x10e)][_0x2b6e18(0x1b8)];_0x1735bb+=_0x2b6e18(0x24d)+(_0x50c500[_0xc12c1f]!==undefined?_0x50c500[_0xc12c1f][_0x2b6e18(0x169)](0x2):'')+'</td>';}_0x451866=_0x5647b0[_0x2b6e18(0x235)]+_0x5647b0['adj_discount'],_0x1735bb+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x5647b0[_0x2b6e18(0x1c6)],0x2)['toFixed'](0x2))+_0x2b6e18(0x1f3),_0x1735bb+=_0x2b6e18(0x146)+formatNumber(_0x5647b0[_0x2b6e18(0x11e)][_0x2b6e18(0x169)](0x2))+_0x2b6e18(0x1f3),_0x1735bb+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x451866)+'</td>',_0x1735bb+=_0x2b6e18(0x146)+formatNumber(_0x5647b0['NetPrice'][_0x2b6e18(0x169)](0x2))+_0x2b6e18(0x1f3),_0x1735bb+='</tr>',_0x20b7d4+=parseFloat(_0x5647b0[_0x2b6e18(0x1c6)]),_0x2a58dd+=parseFloat(_0x5647b0[_0x2b6e18(0x177)][_0x2b6e18(0x169)](0x2)),_0x48d5f5+=_0x451866,_0x1e24c2+=parseFloat(_0x5647b0[_0x2b6e18(0x11e)][_0x2b6e18(0x169)](0x2));if(_0x2fe029==_0x1159a1[_0x2b6e18(0x134)]-0x1){_0x1735bb+=_0x2b6e18(0x13e),_0x1735bb+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x1735bb+=_0x2b6e18(0x1f3);for(let _0x2e12ec=0x0;_0x2e12ec<=_0x195b7f[_0x2b6e18(0x132)][_0x2b6e18(0x134)]-0x1;_0x2e12ec++){const _0x2dcb1c=_0x195b7f[_0x2b6e18(0x132)][_0x2e12ec],_0x1e1377=_0x2dcb1c[_0x2b6e18(0x10e)][_0x2b6e18(0x182)]+'-'+_0x2dcb1c[_0x2b6e18(0x10e)][_0x2b6e18(0x1b8)];!_0x1b90a2[_0x1e1377]&&(_0x1b90a2[_0x1e1377]=[]);const _0x79205c=_0x1b90a2[_0x1e1377]['reduce']((_0x5bfe4b,_0x4822b2)=>_0x5bfe4b+_0x4822b2,0x0);_0x1735bb+=_0x2b6e18(0x1a0)+(_0x79205c!==undefined?formatNumber(_0x79205c[_0x2b6e18(0x169)](0x2)):'')+_0x2b6e18(0x191);}_0x1735bb+=_0x2b6e18(0x271)+formatNumber(_0x20b7d4)+_0x2b6e18(0x191),_0x1735bb+=_0x2b6e18(0x271)+formatNumber(_0x1e24c2)+_0x2b6e18(0x191),_0x1735bb+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x48d5f5)+_0x2b6e18(0x191),_0x1735bb+=_0x2b6e18(0x271)+formatNumber(_0x2a58dd)+_0x2b6e18(0x191),_0x1735bb+=_0x2b6e18(0x1a1);}_0x8a252f['push'](_0x1735bb);}function _0x3f6341(_0x41ab51,_0x28145d){const _0x3b4eb6=_0x2b6e18,_0x1c4741=[];for(let _0x335f6f=0x0;_0x335f6f<=_0x41ab51[_0x3b4eb6(0x134)]-0x1;_0x335f6f+=_0x28145d){_0x1c4741['push'](_0x41ab51[_0x3b4eb6(0x13f)](_0x335f6f,_0x335f6f+_0x28145d));}return _0x1c4741;}const _0x364ecd=_0x3f6341(_0x8a252f,_0x9f487a);let _0x4abb78='';return _0x364ecd[_0x2b6e18(0x257)]((_0x4e2b70,_0x356e81)=>{const _0x397a06=_0x2b6e18;_0x356e81>0x0&&(_0x4abb78+=_0x397a06(0x1dc));_0x4abb78+=_0x397a06(0x1d4),_0x4abb78+='<thead>',_0x4abb78+='<tr>',_0x4abb78+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4abb78+='</tr>',_0x4abb78+=_0x397a06(0x13e),_0x4abb78+=_0x397a06(0x1fb);for(let _0x13c7bf=0x0;_0x13c7bf<=_0x1ef03a[_0x397a06(0x134)]-0x1;_0x13c7bf++){const _0x27f6c7=_0x1ef03a[_0x13c7bf];for(let _0x57f7d8=0x0;_0x57f7d8<_0x5ef16b[_0x397a06(0x134)];_0x57f7d8++){const _0x100631=_0x5ef16b[_0x57f7d8];_0x100631[_0x397a06(0x10e)]===_0x27f6c7[_0x397a06(0x10e)][_0x397a06(0x1b8)]&&(_0x4abb78+=_0x397a06(0x130)+_0x100631[_0x397a06(0x1bf)]+_0x397a06(0x102)+_0x27f6c7['_id'][_0x397a06(0x1b8)]+_0x397a06(0x1f3));}}_0x4abb78+=_0x397a06(0x22c),_0x4abb78+='</tr>',_0x4abb78+=_0x397a06(0x13e),_0x4abb78+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x4abb78+=_0x397a06(0x1c3),_0x4abb78+=_0x397a06(0x263);for(let _0x3e09bf=0x0;_0x3e09bf<=_0x1ef03a[_0x397a06(0x134)]-0x1;_0x3e09bf++){const _0x9a0da5=_0x1ef03a[_0x3e09bf];for(let _0x437c11=0x0;_0x437c11<_0x195b7f[_0x397a06(0x132)][_0x397a06(0x134)];_0x437c11++){const _0x4265f4=_0x195b7f[_0x397a06(0x132)][_0x437c11];_0x4265f4['_id'][_0x397a06(0x1b8)]===_0x9a0da5[_0x397a06(0x10e)][_0x397a06(0x1b8)]&&(_0x4abb78+='<td\x20class=\x22cat_data\x22>'+_0x4265f4['_id'][_0x397a06(0x182)]+'</td>');}}_0x4abb78+=_0x397a06(0x13d),_0x4abb78+=_0x397a06(0x14f),_0x4abb78+=_0x397a06(0x1ba),_0x4abb78+=_0x397a06(0x212),_0x4abb78+=_0x397a06(0x1a1),_0x4abb78+='</thead>',_0x4abb78+='<tbody>',_0x4e2b70[_0x397a06(0x257)](_0x5f5f02=>{_0x4abb78+=_0x5f5f02;}),_0x4abb78+=_0x397a06(0x21a),_0x4abb78+=_0x397a06(0x166);}),_0x4abb78;}router[a0_0x4f1c0b(0x23a)](a0_0x4f1c0b(0x218),auth,async(_0x4d085a,_0x356fb3)=>{const _0x4d8bb5=a0_0x4f1c0b,{from_date:_0x30f805,to_date:_0x39a6f0,isExcel:_0x51afc9,agent_id:_0x4a306c}=_0x4d085a[_0x4d8bb5(0x108)],_0x41be3b=_0x4d085a['user'],_0x4fe244=await staff[_0x4d8bb5(0x1a8)]({'email':_0x41be3b['email']}),_0x2a0081=await master_shop[_0x4d8bb5(0x244)](),_0x2ddb5e=await agentsdataDSICheck_admin(_0x30f805,_0x39a6f0,_0x4a306c,_0x51afc9),_0xff42a=await agentsdataDSICheck_admin_excel(_0x30f805,_0x39a6f0,_0x4a306c,_0x51afc9);let _0x58658a=_0x4d8bb5(0x114);var _0x4958c1=new Date(_0x30f805),_0x1d5d24=new Date(_0x39a6f0);const _0x478156={'year':_0x4d8bb5(0x159),'month':_0x4d8bb5(0x140),'day':_0x4d8bb5(0x159)},_0x56a5b8=new Intl[(_0x4d8bb5(0x21f))](_0x4d8bb5(0x269),_0x478156)[_0x4d8bb5(0x221)](_0x4958c1),_0x114642=new Intl[(_0x4d8bb5(0x21f))](_0x4d8bb5(0x269),_0x478156)[_0x4d8bb5(0x221)](_0x1d5d24);_0x58658a+=_0x4d8bb5(0x11f),_0x58658a+=_0x4d8bb5(0x1a2),_0x58658a+=_0x4d8bb5(0x1d4),_0x58658a+=_0x2ddb5e,_0x58658a+=_0x4d8bb5(0x166),_0x58658a+=_0x4d8bb5(0x1b6),_0x58658a+=_0x4d8bb5(0x1b6);let _0x3e96d2='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x3e96d2+=_0x4d8bb5(0x11f),_0x3e96d2+=_0x4d8bb5(0x1a2),_0x3e96d2+=_0x4d8bb5(0x1d4),_0x3e96d2+=_0xff42a,_0x3e96d2+=_0x4d8bb5(0x166),_0x3e96d2+=_0x4d8bb5(0x1b6),_0x3e96d2+=_0x4d8bb5(0x1b6);let _0x4818fe='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x1657db={'width':'15in','height':_0x4d8bb5(0x1e9),'orientation':_0x4d8bb5(0x120),'border':{'top':_0x4d8bb5(0x121),'right':_0x4d8bb5(0x121),'bottom':'0.1in','left':_0x4d8bb5(0x121)},'header':{'height':'60mm','contents':_0x4d8bb5(0x1ff)+_0x4818fe+_0x4d8bb5(0x10d)+_0x56a5b8+_0x4d8bb5(0x16f)+_0x114642+_0x4d8bb5(0x103)},'footer':{'height':'20mm','contents':{'default':_0x4d8bb5(0x1ca)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x4d8bb5(0x1e8)}}};if(_0x51afc9=='on'){const _0x2f83b8=cheerio[_0x4d8bb5(0x1f0)](_0x3e96d2);let _0x1db454=[],_0x5cea32=[],_0x12aa2f=[];_0x2f83b8(_0x4d8bb5(0x1aa))[_0x4d8bb5(0x143)]((_0x31883a,_0x41e112)=>{const _0x417b5e=_0x4d8bb5;let _0x404ac1=[],_0x15bb13=0x0;while(_0x12aa2f[_0x15bb13]){_0x12aa2f[_0x15bb13]--,_0x15bb13++;}_0x2f83b8(_0x41e112)['find'](_0x417b5e(0x228))[_0x417b5e(0x143)]((_0x261355,_0x50e4f8)=>{const _0x642bb7=_0x417b5e;let _0x2e9f7c=_0x2f83b8(_0x50e4f8)[_0x642bb7(0x10a)]()[_0x642bb7(0x10c)](),_0x3aead1=parseFloat(_0x2e9f7c[_0x642bb7(0x25b)](/,/g,''));isNaN(_0x3aead1)&&(_0x3aead1=_0x2e9f7c);let _0x300982=parseInt(_0x2f83b8(_0x50e4f8)[_0x642bb7(0xfd)](_0x642bb7(0x23f)))||0x1,_0x207b5f=parseInt(_0x2f83b8(_0x50e4f8)[_0x642bb7(0xfd)](_0x642bb7(0x251)))||0x1;_0x404ac1[_0x15bb13]=_0x3aead1;(_0x300982>0x1||_0x207b5f>0x1)&&_0x5cea32[_0x642bb7(0x1b9)]({'s':{'r':_0x31883a,'c':_0x15bb13},'e':{'r':_0x31883a+_0x207b5f-0x1,'c':_0x15bb13+_0x300982-0x1}});for(let _0x3f113a=0x0;_0x3f113a<_0x300982;_0x3f113a++){_0x207b5f>0x1&&(_0x12aa2f[_0x15bb13+_0x3f113a]=_0x207b5f-0x1);}_0x15bb13+=_0x300982;}),_0x1db454[_0x417b5e(0x1b9)](_0x404ac1);});const _0x462071=XLSX[_0x4d8bb5(0x197)][_0x4d8bb5(0x258)](),_0x2f4ac3=XLSX[_0x4d8bb5(0x197)]['aoa_to_sheet'](_0x1db454);_0x5cea32[_0x4d8bb5(0x134)]>0x0&&(_0x2f4ac3[_0x4d8bb5(0x1ef)]=_0x5cea32);_0x2f4ac3[_0x4d8bb5(0x171)]=_0x1db454[0x0][_0x4d8bb5(0x277)](()=>({'wpx':0x64})),XLSX[_0x4d8bb5(0x197)][_0x4d8bb5(0x237)](_0x462071,_0x2f4ac3,_0x4d8bb5(0x241));const _0x217069=XLSX[_0x4d8bb5(0x22a)](_0x462071,{'bookType':_0x4d8bb5(0x1ed),'type':_0x4d8bb5(0x1bd)});_0x356fb3[_0x4d8bb5(0x170)]('Content-Disposition',_0x4d8bb5(0x173)),_0x356fb3[_0x4d8bb5(0x170)](_0x4d8bb5(0x232),_0x4d8bb5(0x1b3)),_0x356fb3[_0x4d8bb5(0x1d3)](_0x217069);}else pdf[_0x4d8bb5(0x1f6)](_0x58658a,_0x1657db)[_0x4d8bb5(0x275)](function(_0x5093d8,_0x3f53ff){const _0x5f3f90=_0x4d8bb5;if(_0x5093d8){_0x356fb3['status'](0x1f4)['send'](_0x5f3f90(0x20a));return;}_0x356fb3[_0x5f3f90(0x170)](_0x5f3f90(0x232),_0x5f3f90(0x222)),_0x3f53ff[_0x5f3f90(0x272)](_0x356fb3);});}),router[a0_0x4f1c0b(0x190)](a0_0x4f1c0b(0x255),auth,async(_0x4568da,_0x2228ee)=>{const _0x461b24=a0_0x4f1c0b;try{const {username:_0x29d211,email:_0x2fa32e,role:_0x26e2b2}=_0x4568da[_0x461b24(0x27d)],_0x150adf=_0x4568da[_0x461b24(0x27d)],_0x3ab4f4=await profile[_0x461b24(0x1a8)]({'email':_0x150adf[_0x461b24(0x1a3)]}),_0x2e4a47={'year':'numeric','month':_0x461b24(0x140),'day':_0x461b24(0x159)},_0x3f4c97=await master_shop['find'](),_0x125926=await staff[_0x461b24(0x1a8)]({'email':_0x150adf[_0x461b24(0x1a3)]}),_0x322a56=await product[_0x461b24(0x244)](),_0x4ec1d4=await warehouse[_0x461b24(0x225)]([{'$unwind':_0x461b24(0x234)},{'$lookup':{'from':'products','localField':_0x461b24(0x155),'foreignField':_0x461b24(0x20d),'as':_0x461b24(0x207)}},{'$unwind':_0x461b24(0x16b)},{'$project':{'product_name':_0x461b24(0x27f),'product_stock':_0x461b24(0x156)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);if(_0x3f4c97[0x0]['language']==_0x461b24(0x115))var _0xd38006=users[_0x461b24(0x279)];else{if(_0x3f4c97[0x0][_0x461b24(0x18f)]==_0x461b24(0x149))var _0xd38006=users['Hindi'];else{if(_0x3f4c97[0x0][_0x461b24(0x18f)]==_0x461b24(0x135))var _0xd38006=users[_0x461b24(0x135)];else{if(_0x3f4c97[0x0][_0x461b24(0x18f)]==_0x461b24(0x17e))var _0xd38006=users[_0x461b24(0x17e)];else{if(_0x3f4c97[0x0][_0x461b24(0x18f)]==_0x461b24(0x14c))var _0xd38006=users[_0x461b24(0x14c)];else{if(_0x3f4c97[0x0][_0x461b24(0x18f)]==_0x461b24(0x1af))var _0xd38006=users['Portuguese'];else{if(_0x3f4c97[0x0][_0x461b24(0x18f)]==_0x461b24(0x18b))var _0xd38006=users[_0x461b24(0x18b)];else{if(_0x3f4c97[0x0][_0x461b24(0x18f)]==_0x461b24(0x17c))var _0xd38006=users[_0x461b24(0x1e5)];}}}}}}}_0x2228ee[_0x461b24(0x14e)](_0x461b24(0x253),{'success':_0x4568da[_0x461b24(0x16e)](_0x461b24(0x142)),'errors':_0x4568da['flash'](_0x461b24(0x219)),'alldata':_0x322a56,'profile':_0x3ab4f4,'master_shop':_0x3f4c97,'role':_0x150adf,'product_stock':_0x4ec1d4,'language':_0xd38006,'staff_arr':_0x125926});}catch(_0xbe4647){}});function formatNumber(_0x3acb7b,_0x303a2e=a0_0x4f1c0b(0x269),_0x4e36bc={'minimumFractionDigits':0x2}){const _0xb492a0=a0_0x4f1c0b,_0x470694=new Intl[(_0xb492a0(0x1e4))](_0x303a2e,_0x4e36bc);return _0x470694[_0xb492a0(0x221)](_0x3acb7b);}function a0_0x4a03(_0x14c889,_0x19ee4){const _0x3b33ae=a0_0x3b33();return a0_0x4a03=function(_0x4a03e1,_0x4c2079){_0x4a03e1=_0x4a03e1-0xfd;let _0x5cf7f5=_0x3b33ae[_0x4a03e1];return _0x5cf7f5;},a0_0x4a03(_0x14c889,_0x19ee4);}async function agentsdataDSICheck(_0x23ef2d,_0x578f7a,_0x16d68d,_0x52303d){const _0x4d1ecc=a0_0x4f1c0b,_0x30b2fc=await product[_0x4d1ecc(0x225)]([{'$group':{'_id':{'brand':'$brand','category':_0x4d1ecc(0x18a)},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x857538=[];_0x857538[_0x4d1ecc(0x132)]=[];for(let _0x348957=0x0;_0x348957<=_0x30b2fc['length']-0x1;_0x348957++){const _0x596e29=_0x30b2fc[_0x348957];_0x857538[_0x4d1ecc(0x132)][_0x4d1ecc(0x1b9)](_0x596e29);}const _0x50580e=await product[_0x4d1ecc(0x225)]([{'$group':{'_id':{'category':_0x4d1ecc(0x18a)},'products':{'$push':{'brand':_0x4d1ecc(0x162),'product_code':_0x4d1ecc(0x192),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1d8aa8=await product[_0x4d1ecc(0x225)]([{'$group':{'_id':{'category':_0x4d1ecc(0x18a),'brand':_0x4d1ecc(0x162)}}},{'$group':{'_id':_0x4d1ecc(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x7ebaf2=await sales_sa[_0x4d1ecc(0x225)]([{'$match':{'date':{'$gte':_0x23ef2d,'$lte':_0x578f7a},'sales_staff_id':_0x16d68d,'sale_product.isFG':_0x4d1ecc(0x24e),'status_data':'false'}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x4d1ecc(0x24e)}},{'$lookup':{'from':_0x4d1ecc(0x12b),'localField':_0x4d1ecc(0x209),'foreignField':_0x4d1ecc(0x1e6),'as':'product_info'}},{'$unwind':_0x4d1ecc(0x25f)},{'$group':{'_id':{'dsi':_0x4d1ecc(0x250),'date':'$date','customer':_0x4d1ecc(0x1e0)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x4d1ecc(0x273),'NetPrice':_0x4d1ecc(0x226),'discount':_0x4d1ecc(0x147),'adj_discount':_0x4d1ecc(0x12a),'product_details':{'prod_name':_0x4d1ecc(0x164),'product_code':_0x4d1ecc(0x113),'category':'$product_info.category','brand':_0x4d1ecc(0x1fe),'gross_price':_0x4d1ecc(0x1df)}}}}},{'$unwind':_0x4d1ecc(0x262)},{'$group':{'_id':{'dsi':_0x4d1ecc(0x236),'date':_0x4d1ecc(0x1d1),'customer':_0x4d1ecc(0x100),'category':_0x4d1ecc(0x168),'brand':_0x4d1ecc(0x1b1)},'totalQty':{'$sum':_0x4d1ecc(0x13a)},'totalGross':{'$sum':{'$multiply':[_0x4d1ecc(0x13a),_0x4d1ecc(0x104)]}},'NetPrice':{'$sum':_0x4d1ecc(0x1f2)},'discount':{'$sum':_0x4d1ecc(0x220)},'adj_discount':{'$sum':_0x4d1ecc(0x179)},'product_details':{'$first':_0x4d1ecc(0x12d)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x4d1ecc(0x1d1),'customer':_0x4d1ecc(0x100)},'totalQty':{'$sum':_0x4d1ecc(0x24f)},'totalGross':{'$sum':_0x4d1ecc(0x238)},'NetPrice':{'$sum':_0x4d1ecc(0x152)},'discount':{'$sum':_0x4d1ecc(0x184)},'adj_discount':{'$sum':_0x4d1ecc(0x24a)},'products':{'$push':{'qty':_0x4d1ecc(0x24f),'category':_0x4d1ecc(0x1b0),'brand':_0x4d1ecc(0x27b),'product_details':_0x4d1ecc(0x234)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x1443c5=[],_0x159d9e={},_0x3da873={},_0x237b8f={};var _0x240903=0x0,_0x5870cd=0x0,_0x1cd4e0=0x0,_0x24d423=0x0,_0x147409=0x0;const _0x4ad132=0x6;for(let _0x919ee1=0x0;_0x919ee1<=_0x7ebaf2[_0x4d1ecc(0x134)]-0x1;_0x919ee1++){const _0x1bc04a=_0x7ebaf2[_0x919ee1];let _0x49b96f=_0x4d1ecc(0x13e);_0x49b96f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1bc04a[_0x4d1ecc(0x10e)][_0x4d1ecc(0x1f9)]+_0x4d1ecc(0x1f3),_0x49b96f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1bc04a[_0x4d1ecc(0x10e)][_0x4d1ecc(0x178)]+_0x4d1ecc(0x1f3),_0x49b96f+=_0x4d1ecc(0x189)+_0x1bc04a[_0x4d1ecc(0x10e)][_0x4d1ecc(0x19e)]+'</td>';let _0x11faff={};var _0x17b42a=0x0;for(let _0x51b8d5=0x0;_0x51b8d5<=_0x1bc04a[_0x4d1ecc(0x12b)][_0x4d1ecc(0x134)]-0x1;_0x51b8d5++){const _0x26da2a=_0x1bc04a[_0x4d1ecc(0x12b)][_0x51b8d5];_0x11faff[_0x26da2a[_0x4d1ecc(0x182)]+'-'+_0x26da2a[_0x4d1ecc(0x1b8)]]=_0x26da2a[_0x4d1ecc(0x26a)];const _0x18f23d=_0x26da2a[_0x4d1ecc(0x182)]+'-'+_0x26da2a[_0x4d1ecc(0x1b8)];!_0x159d9e[_0x18f23d]&&(_0x159d9e[_0x18f23d]=0x0),!Array[_0x4d1ecc(0x27e)](_0x237b8f[_0x18f23d])&&(_0x237b8f[_0x18f23d]=[]),!Array[_0x4d1ecc(0x27e)](_0x237b8f[_0x18f23d])&&(_0x237b8f[_0x18f23d]=[]),_0x159d9e[_0x18f23d]+=_0x26da2a['qty'],_0x237b8f[_0x18f23d][_0x4d1ecc(0x1b9)](_0x26da2a['qty']),_0x17b42a++;}for(let _0x52945f=0x0;_0x52945f<=_0x857538['cat_brand'][_0x4d1ecc(0x134)]-0x1;_0x52945f++){const _0x1430a9=_0x857538[_0x4d1ecc(0x132)][_0x52945f],_0x178e45=_0x1430a9[_0x4d1ecc(0x10e)][_0x4d1ecc(0x182)]+'-'+_0x1430a9[_0x4d1ecc(0x10e)][_0x4d1ecc(0x1b8)];_0x49b96f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x11faff[_0x178e45]!==undefined?_0x11faff[_0x178e45][_0x4d1ecc(0x169)](0x2):'')+_0x4d1ecc(0x1f3);}_0x1cd4e0=_0x1bc04a['discount']+_0x1bc04a[_0x4d1ecc(0x1fd)],_0x49b96f+=_0x4d1ecc(0x146)+formatNumber(parseFloat(_0x1bc04a['totalQty'],0x2)[_0x4d1ecc(0x169)](0x2))+_0x4d1ecc(0x1f3),_0x49b96f+=_0x4d1ecc(0x146)+formatNumber(_0x1bc04a['totalGross'][_0x4d1ecc(0x169)](0x2))+_0x4d1ecc(0x1f3),_0x49b96f+=_0x4d1ecc(0x146)+formatNumber(_0x1cd4e0)+_0x4d1ecc(0x1f3),_0x49b96f+=_0x4d1ecc(0x146)+formatNumber(_0x1bc04a['NetPrice']['toFixed'](0x2))+_0x4d1ecc(0x1f3),_0x49b96f+=_0x4d1ecc(0x1a1),_0x240903+=parseFloat(_0x1bc04a['totalQty']),_0x5870cd+=parseFloat(_0x1bc04a[_0x4d1ecc(0x177)][_0x4d1ecc(0x169)](0x2)),_0x24d423+=_0x1cd4e0,_0x147409+=parseFloat(_0x1bc04a[_0x4d1ecc(0x11e)]['toFixed'](0x2));if(_0x919ee1==_0x7ebaf2[_0x4d1ecc(0x134)]-0x1){_0x49b96f+=_0x4d1ecc(0x13e),_0x49b96f+=_0x4d1ecc(0x158),_0x49b96f+=_0x4d1ecc(0x1f3);for(let _0x5cdab6=0x0;_0x5cdab6<=_0x857538[_0x4d1ecc(0x132)][_0x4d1ecc(0x134)]-0x1;_0x5cdab6++){const _0x4fa0c0=_0x857538[_0x4d1ecc(0x132)][_0x5cdab6],_0x399290=_0x4fa0c0['_id']['brand']+'-'+_0x4fa0c0[_0x4d1ecc(0x10e)][_0x4d1ecc(0x1b8)];!_0x237b8f[_0x399290]&&(_0x237b8f[_0x399290]=[]);const _0x3aa716=_0x237b8f[_0x399290][_0x4d1ecc(0x16a)]((_0x26ca3a,_0x480191)=>_0x26ca3a+_0x480191,0x0);_0x49b96f+=_0x4d1ecc(0x1a0)+(_0x3aa716!==undefined?formatNumber(_0x3aa716['toFixed'](0x2)):'')+_0x4d1ecc(0x191);}_0x49b96f+=_0x4d1ecc(0x271)+formatNumber(_0x240903[_0x4d1ecc(0x169)](0x2))+'</b></td>',_0x49b96f+=_0x4d1ecc(0x271)+formatNumber(_0x147409)+'</b></td>',_0x49b96f+=_0x4d1ecc(0x271)+formatNumber(_0x24d423)+_0x4d1ecc(0x191),_0x49b96f+=_0x4d1ecc(0x271)+formatNumber(_0x5870cd)+'</b></td>',_0x49b96f+=_0x4d1ecc(0x1a1);}console[_0x4d1ecc(0x141)](_0x4d1ecc(0x17a),_0x240903+'+='+parseFloat(_0x1bc04a[_0x4d1ecc(0x1c6)])),_0x1443c5[_0x4d1ecc(0x1b9)](_0x49b96f);}function _0x5d23f9(_0x34563b,_0x475e7e){const _0x41b187=_0x4d1ecc,_0x3545ca=[];for(let _0x381da8=0x0;_0x381da8<=_0x34563b[_0x41b187(0x134)]-0x1;_0x381da8+=_0x475e7e){_0x3545ca[_0x41b187(0x1b9)](_0x34563b[_0x41b187(0x13f)](_0x381da8,_0x381da8+_0x475e7e));}return _0x3545ca;}const _0x4b279e=_0x5d23f9(_0x1443c5,_0x4ad132);let _0x38c203='';return _0x4b279e[_0x4d1ecc(0x257)]((_0x2d4a89,_0x104186)=>{const _0x1f3774=_0x4d1ecc;_0x104186>0x0&&(_0x38c203+=_0x1f3774(0x1dc));_0x38c203+=_0x1f3774(0x1d4),_0x38c203+=_0x1f3774(0x1e1),_0x38c203+='<tr>',_0x38c203+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x38c203+=_0x1f3774(0x1a1),_0x38c203+='<tr>',_0x38c203+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x32a34a=0x0;_0x32a34a<=_0x50580e['length']-0x1;_0x32a34a++){const _0x5caacd=_0x50580e[_0x32a34a];for(let _0x28777d=0x0;_0x28777d<_0x1d8aa8[_0x1f3774(0x134)];_0x28777d++){const _0x212164=_0x1d8aa8[_0x28777d];_0x212164[_0x1f3774(0x10e)]===_0x5caacd['_id'][_0x1f3774(0x1b8)]&&(_0x38c203+=_0x1f3774(0x130)+_0x212164[_0x1f3774(0x1bf)]+'\x22\x20class=\x22cat_data\x22>'+_0x5caacd[_0x1f3774(0x10e)]['category']+_0x1f3774(0x1f3));}}_0x38c203+=_0x1f3774(0x22c),_0x38c203+='</tr>',_0x38c203+='<tr>',_0x38c203+=_0x1f3774(0x246),_0x38c203+=_0x1f3774(0x1c3),_0x38c203+=_0x1f3774(0x263);for(let _0x1e848e=0x0;_0x1e848e<=_0x50580e[_0x1f3774(0x134)]-0x1;_0x1e848e++){const _0x2a82c5=_0x50580e[_0x1e848e];for(let _0x518dcc=0x0;_0x518dcc<_0x857538[_0x1f3774(0x132)][_0x1f3774(0x134)];_0x518dcc++){const _0xbcb752=_0x857538[_0x1f3774(0x132)][_0x518dcc];_0xbcb752[_0x1f3774(0x10e)][_0x1f3774(0x1b8)]===_0x2a82c5['_id']['category']&&(_0x38c203+=_0x1f3774(0x165)+_0xbcb752[_0x1f3774(0x10e)][_0x1f3774(0x182)]+_0x1f3774(0x1f3));}}_0x38c203+=_0x1f3774(0x13d),_0x38c203+=_0x1f3774(0x14f),_0x38c203+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x38c203+=_0x1f3774(0x212),_0x38c203+=_0x1f3774(0x1a1),_0x38c203+='</thead>',_0x38c203+=_0x1f3774(0xfe),_0x2d4a89[_0x1f3774(0x257)](_0x2e6ce7=>{_0x38c203+=_0x2e6ce7;}),_0x38c203+=_0x1f3774(0x21a),_0x38c203+=_0x1f3774(0x166);}),_0x38c203;}async function agentsdataDSICheck_excel(_0x1578ef,_0x1b1846,_0x5177b4,_0x1736ec){const _0x53b5e2=a0_0x4f1c0b,_0x3680b2=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':_0x53b5e2(0x1d0),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x270c3d=[];_0x270c3d[_0x53b5e2(0x132)]=[];for(let _0x101397=0x0;_0x101397<=_0x3680b2[_0x53b5e2(0x134)]-0x1;_0x101397++){const _0x100c32=_0x3680b2[_0x101397];_0x270c3d[_0x53b5e2(0x132)][_0x53b5e2(0x1b9)](_0x100c32);}const _0x13ac45=await product[_0x53b5e2(0x225)]([{'$group':{'_id':{'category':_0x53b5e2(0x18a)},'products':{'$push':{'brand':_0x53b5e2(0x162),'product_code':_0x53b5e2(0x192),'product_name':_0x53b5e2(0x1d0)}}}},{'$sort':{'_id.category':-0x1}}]),_0x2a2c07=await product[_0x53b5e2(0x225)]([{'$group':{'_id':{'category':_0x53b5e2(0x18a),'brand':'$brand'}}},{'$group':{'_id':_0x53b5e2(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x40cd82=await sales_sa[_0x53b5e2(0x225)]([{'$match':{'date':{'$gte':_0x1578ef,'$lte':_0x1b1846},'sales_staff_id':_0x5177b4,'sale_product.isFG':'false'}},{'$unwind':_0x53b5e2(0x1cf)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x53b5e2(0x12b),'localField':_0x53b5e2(0x209),'foreignField':_0x53b5e2(0x1e6),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':_0x53b5e2(0x1e0)},'totalQty':{'$sum':_0x53b5e2(0x273)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0x53b5e2(0x12a),'product_details':{'prod_name':_0x53b5e2(0x164),'product_code':_0x53b5e2(0x113),'category':_0x53b5e2(0x223),'brand':_0x53b5e2(0x1fe),'gross_price':_0x53b5e2(0x1df)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x53b5e2(0x236),'date':_0x53b5e2(0x1d1),'customer':'$_id.customer','category':_0x53b5e2(0x168),'brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x53b5e2(0x1f2)},'discount':{'$sum':_0x53b5e2(0x220)},'adj_discount':{'$sum':_0x53b5e2(0x179)},'product_details':{'$first':_0x53b5e2(0x12d)}}},{'$group':{'_id':{'dsi':_0x53b5e2(0x236),'date':_0x53b5e2(0x1d1),'customer':_0x53b5e2(0x100)},'totalQty':{'$sum':_0x53b5e2(0x24f)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x53b5e2(0x152)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x53b5e2(0x24a)},'products':{'$push':{'qty':'$totalQty','category':_0x53b5e2(0x1b0),'brand':'$_id.brand','product_details':_0x53b5e2(0x234)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x498114=[],_0x2e5e87={},_0x3a2582={},_0x2c4066={};var _0x1aee67=0x0,_0x2eb68a=0x0,_0x1eaef8=0x0,_0x2e5f19=0x0,_0x4ce842=0x0;const _0x47cb5c=0x9184e72a000;for(let _0xeb0e82=0x0;_0xeb0e82<=_0x40cd82[_0x53b5e2(0x134)]-0x1;_0xeb0e82++){const _0x2b4637=_0x40cd82[_0xeb0e82];let _0x5d6c65=_0x53b5e2(0x13e);_0x5d6c65+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2b4637[_0x53b5e2(0x10e)][_0x53b5e2(0x1f9)]+_0x53b5e2(0x1f3),_0x5d6c65+=_0x53b5e2(0x189)+_0x2b4637[_0x53b5e2(0x10e)][_0x53b5e2(0x178)]+'</td>',_0x5d6c65+=_0x53b5e2(0x189)+_0x2b4637[_0x53b5e2(0x10e)]['customer']+_0x53b5e2(0x1f3);let _0x42e805={};var _0x3c2366=0x0;for(let _0x13669f=0x0;_0x13669f<=_0x2b4637[_0x53b5e2(0x12b)]['length']-0x1;_0x13669f++){const _0x3a7214=_0x2b4637[_0x53b5e2(0x12b)][_0x13669f];_0x42e805[_0x3a7214[_0x53b5e2(0x182)]+'-'+_0x3a7214[_0x53b5e2(0x1b8)]]=_0x3a7214[_0x53b5e2(0x26a)];const _0x36091c=_0x3a7214[_0x53b5e2(0x182)]+'-'+_0x3a7214['category'];!_0x2e5e87[_0x36091c]&&(_0x2e5e87[_0x36091c]=0x0),!Array[_0x53b5e2(0x27e)](_0x2c4066[_0x36091c])&&(_0x2c4066[_0x36091c]=[]),!Array['isArray'](_0x2c4066[_0x36091c])&&(_0x2c4066[_0x36091c]=[]),_0x2e5e87[_0x36091c]+=_0x3a7214[_0x53b5e2(0x26a)],_0x2c4066[_0x36091c][_0x53b5e2(0x1b9)](_0x3a7214[_0x53b5e2(0x26a)]),_0x3c2366++;}for(let _0x3b840e=0x0;_0x3b840e<=_0x270c3d[_0x53b5e2(0x132)][_0x53b5e2(0x134)]-0x1;_0x3b840e++){const _0x1dbd9e=_0x270c3d[_0x53b5e2(0x132)][_0x3b840e],_0x55abf4=_0x1dbd9e[_0x53b5e2(0x10e)]['brand']+'-'+_0x1dbd9e[_0x53b5e2(0x10e)][_0x53b5e2(0x1b8)];_0x5d6c65+=_0x53b5e2(0x24d)+(_0x42e805[_0x55abf4]!==undefined?_0x42e805[_0x55abf4]['toFixed'](0x2):'')+_0x53b5e2(0x1f3);}_0x1eaef8=_0x2b4637[_0x53b5e2(0x235)]+_0x2b4637[_0x53b5e2(0x1fd)],_0x5d6c65+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x2b4637[_0x53b5e2(0x1c6)],0x2)[_0x53b5e2(0x169)](0x2))+_0x53b5e2(0x1f3),_0x5d6c65+=_0x53b5e2(0x146)+formatNumber(_0x2b4637[_0x53b5e2(0x11e)][_0x53b5e2(0x169)](0x2))+_0x53b5e2(0x1f3),_0x5d6c65+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x1eaef8)+_0x53b5e2(0x1f3),_0x5d6c65+=_0x53b5e2(0x146)+formatNumber(_0x2b4637[_0x53b5e2(0x177)][_0x53b5e2(0x169)](0x2))+'</td>',_0x5d6c65+='</tr>',_0x1aee67+=parseFloat(_0x2b4637[_0x53b5e2(0x1c6)][_0x53b5e2(0x169)](0x2)),_0x2eb68a+=parseFloat(_0x2b4637[_0x53b5e2(0x177)]['toFixed'](0x2)),_0x2e5f19+=_0x1eaef8,_0x4ce842+=parseFloat(_0x2b4637['totalGross'][_0x53b5e2(0x169)](0x2));if(_0xeb0e82==_0x40cd82[_0x53b5e2(0x134)]-0x1){_0x5d6c65+='<tr>',_0x5d6c65+=_0x53b5e2(0x158),_0x5d6c65+=_0x53b5e2(0x1f3);for(let _0x351029=0x0;_0x351029<=_0x270c3d[_0x53b5e2(0x132)][_0x53b5e2(0x134)]-0x1;_0x351029++){const _0x2b7b39=_0x270c3d[_0x53b5e2(0x132)][_0x351029],_0x351ba6=_0x2b7b39[_0x53b5e2(0x10e)][_0x53b5e2(0x182)]+'-'+_0x2b7b39['_id']['category'];!_0x2c4066[_0x351ba6]&&(_0x2c4066[_0x351ba6]=[]);const _0x5ce9cb=_0x2c4066[_0x351ba6][_0x53b5e2(0x16a)]((_0x270d67,_0x4b28f0)=>_0x270d67+_0x4b28f0,0x0);_0x5d6c65+=_0x53b5e2(0x1a0)+(_0x5ce9cb!==undefined?formatNumber(_0x5ce9cb[_0x53b5e2(0x169)](0x2)):'')+_0x53b5e2(0x191);}_0x5d6c65+=_0x53b5e2(0x271)+formatNumber(_0x1aee67[_0x53b5e2(0x169)](0x2))+_0x53b5e2(0x191),_0x5d6c65+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4ce842)+_0x53b5e2(0x191),_0x5d6c65+=_0x53b5e2(0x271)+formatNumber(_0x2e5f19)+_0x53b5e2(0x191),_0x5d6c65+=_0x53b5e2(0x271)+formatNumber(_0x2eb68a)+_0x53b5e2(0x191),_0x5d6c65+=_0x53b5e2(0x1a1);}_0x498114[_0x53b5e2(0x1b9)](_0x5d6c65);}function _0x2fd399(_0x2ad275,_0x65a037){const _0xd8f921=_0x53b5e2,_0x572a1b=[];for(let _0x17adf6=0x0;_0x17adf6<=_0x2ad275[_0xd8f921(0x134)]-0x1;_0x17adf6+=_0x65a037){_0x572a1b['push'](_0x2ad275[_0xd8f921(0x13f)](_0x17adf6,_0x17adf6+_0x65a037));}return _0x572a1b;}const _0x1a279c=_0x2fd399(_0x498114,_0x47cb5c);let _0xcf8530='';return _0x1a279c[_0x53b5e2(0x257)]((_0x3c92be,_0x53ff86)=>{const _0x53c993=_0x53b5e2;_0x53ff86>0x0&&(_0xcf8530+=_0x53c993(0x1dc));_0xcf8530+=_0x53c993(0x1d4),_0xcf8530+=_0x53c993(0x1e1),_0xcf8530+=_0x53c993(0x13e),_0xcf8530+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0xcf8530+=_0x53c993(0x1a1),_0xcf8530+='<tr>',_0xcf8530+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x5282eb=0x0;_0x5282eb<=_0x13ac45[_0x53c993(0x134)]-0x1;_0x5282eb++){const _0x7b451a=_0x13ac45[_0x5282eb];for(let _0x4474de=0x0;_0x4474de<_0x2a2c07[_0x53c993(0x134)];_0x4474de++){const _0x5d8dc7=_0x2a2c07[_0x4474de];_0x5d8dc7[_0x53c993(0x10e)]===_0x7b451a['_id'][_0x53c993(0x1b8)]&&(_0xcf8530+='<td\x20colspan=\x22'+_0x5d8dc7[_0x53c993(0x1bf)]+_0x53c993(0x102)+_0x7b451a['_id'][_0x53c993(0x1b8)]+_0x53c993(0x1f3));}}_0xcf8530+=_0x53c993(0x22c),_0xcf8530+=_0x53c993(0x1a1),_0xcf8530+=_0x53c993(0x13e),_0xcf8530+=_0x53c993(0x246),_0xcf8530+=_0x53c993(0x1c3),_0xcf8530+=_0x53c993(0x263);for(let _0x5235e4=0x0;_0x5235e4<=_0x13ac45['length']-0x1;_0x5235e4++){const _0x1a68eb=_0x13ac45[_0x5235e4];for(let _0x4fd5c1=0x0;_0x4fd5c1<_0x270c3d[_0x53c993(0x132)]['length'];_0x4fd5c1++){const _0x51a9aa=_0x270c3d[_0x53c993(0x132)][_0x4fd5c1];_0x51a9aa['_id']['category']===_0x1a68eb['_id'][_0x53c993(0x1b8)]&&(_0xcf8530+=_0x53c993(0x165)+_0x51a9aa[_0x53c993(0x10e)][_0x53c993(0x182)]+'</td>');}}_0xcf8530+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0xcf8530+=_0x53c993(0x14f),_0xcf8530+=_0x53c993(0x1ba),_0xcf8530+=_0x53c993(0x212),_0xcf8530+=_0x53c993(0x1a1),_0xcf8530+=_0x53c993(0x24c),_0xcf8530+=_0x53c993(0xfe),_0x3c92be[_0x53c993(0x257)](_0x1465c8=>{_0xcf8530+=_0x1465c8;}),console[_0x53c993(0x141)](_0x2c4066),_0xcf8530+=_0x53c993(0x21a),_0xcf8530+=_0x53c993(0x166);}),_0xcf8530;}router['post'](a0_0x4f1c0b(0x1ad),auth,async(_0x52721c,_0x22ea53)=>{const _0x5cd62d=a0_0x4f1c0b,{from_date:_0x5ae138,to_date:_0x509725,isExcel:_0x4cfeb0}=_0x52721c[_0x5cd62d(0x108)],_0x3fc787=_0x52721c[_0x5cd62d(0x27d)],_0x404f59=await staff[_0x5cd62d(0x1a8)]({'email':_0x3fc787[_0x5cd62d(0x1a3)]}),_0x3d12ea=await master_shop[_0x5cd62d(0x244)](),_0x4a4b58=await agentsdataDSICheck(_0x5ae138,_0x509725,_0x404f59[_0x5cd62d(0x10e)]['valueOf'](),_0x4cfeb0),_0xace937=await agentsdataDSICheck_excel(_0x5ae138,_0x509725,_0x404f59['_id'][_0x5cd62d(0x163)](),_0x4cfeb0);let _0xba906b=_0x5cd62d(0x1b7);var _0x38d02f=new Date(_0x5ae138),_0x31e04c=new Date(_0x509725);const _0x33bba9={'year':_0x5cd62d(0x159),'month':_0x5cd62d(0x140),'day':_0x5cd62d(0x159)},_0x245b5c=new Intl[(_0x5cd62d(0x21f))](_0x5cd62d(0x269),_0x33bba9)[_0x5cd62d(0x221)](_0x38d02f),_0x25d12f=new Intl[(_0x5cd62d(0x21f))](_0x5cd62d(0x269),_0x33bba9)[_0x5cd62d(0x221)](_0x31e04c);_0xba906b+='<div\x20class=\x22row\x22>',_0xba906b+=_0x5cd62d(0x1a2),_0xba906b+=_0x5cd62d(0x1d4),_0xba906b+=_0x4a4b58,_0xba906b+='</table>',_0xba906b+=_0x5cd62d(0x1b6),_0xba906b+=_0x5cd62d(0x1b6);let _0x46c6f2='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x46c6f2+=_0x5cd62d(0x11f),_0x46c6f2+=_0x5cd62d(0x1a2),_0x46c6f2+=_0x5cd62d(0x1d4),_0x46c6f2+=_0xace937,_0x46c6f2+=_0x5cd62d(0x166),_0x46c6f2+=_0x5cd62d(0x1b6),_0x46c6f2+=_0x5cd62d(0x1b6);let _0x208378=_0x5cd62d(0x1d5);const _0x4b94ae={'width':_0x5cd62d(0x202),'height':'8.5in','orientation':_0x5cd62d(0x120),'border':{'top':_0x5cd62d(0x121),'right':_0x5cd62d(0x121),'bottom':_0x5cd62d(0x121),'left':'0.1in'},'header':{'height':_0x5cd62d(0x1a6),'contents':_0x5cd62d(0x1ff)+_0x208378+_0x5cd62d(0x10d)+_0x245b5c+_0x5cd62d(0x16f)+_0x25d12f+_0x5cd62d(0x103)},'footer':{'height':'20mm','contents':{'default':_0x5cd62d(0x1ca)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x5cd62d(0x1e8)}}};if(_0x4cfeb0=='on'){const _0x33a8f2=cheerio[_0x5cd62d(0x1f0)](_0x46c6f2);let _0x374639=[],_0x2a9dfd=[],_0x1a5121=[];const _0x3ffae0=_0x3381e0=>{const _0x2fb729=_0x5cd62d,_0x117561={'top':{'style':_0x2fb729(0x1de),'color':{'rgb':_0x2fb729(0x185)}},'bottom':{'style':_0x2fb729(0x1de),'color':{'rgb':_0x2fb729(0x185)}},'left':{'style':_0x2fb729(0x1de),'color':{'rgb':_0x2fb729(0x185)}},'right':{'style':_0x2fb729(0x1de),'color':{'rgb':_0x2fb729(0x185)}}};if(_0x3381e0){const _0x25f57d=_0x3381e0[_0x2fb729(0x26d)](';')['reduce']((_0x152eff,_0x3adce8)=>{const _0x378a71=_0x2fb729,[_0x53b2a6,_0x193c5c]=_0x3adce8[_0x378a71(0x26d)](':')[_0x378a71(0x277)](_0x4bba20=>_0x4bba20[_0x378a71(0x10c)]());return _0x152eff[_0x53b2a6]=_0x193c5c,_0x152eff;},{});_0x25f57d[_0x2fb729(0x154)]&&(_0x117561[_0x2fb729(0x138)]['style']=_0x25f57d[_0x2fb729(0x154)][_0x2fb729(0x1a4)]('thin')?'thin':_0x2fb729(0x27a)),_0x25f57d[_0x2fb729(0x106)]&&(_0x117561[_0x2fb729(0x270)]['style']=_0x25f57d[_0x2fb729(0x106)][_0x2fb729(0x1a4)](_0x2fb729(0x1f7))?'thin':_0x2fb729(0x27a)),_0x25f57d['border-left']&&(_0x117561[_0x2fb729(0x23b)][_0x2fb729(0x116)]=_0x25f57d[_0x2fb729(0x249)][_0x2fb729(0x1a4)](_0x2fb729(0x1f7))?'thin':'medium'),_0x25f57d[_0x2fb729(0x195)]&&(_0x117561[_0x2fb729(0x242)][_0x2fb729(0x116)]=_0x25f57d['border-right'][_0x2fb729(0x1a4)](_0x2fb729(0x1f7))?_0x2fb729(0x1f7):_0x2fb729(0x27a));}return _0x117561;};_0x33a8f2(_0x5cd62d(0x1aa))[_0x5cd62d(0x143)]((_0x56628c,_0x3d26a3)=>{const _0x18421d=_0x5cd62d;let _0xc63e32=[],_0x1984d7=0x0;while(_0x1a5121[_0x1984d7]){_0x1a5121[_0x1984d7]--,_0x1984d7++;}_0x33a8f2(_0x3d26a3)[_0x18421d(0x244)](_0x18421d(0x228))[_0x18421d(0x143)]((_0x522de2,_0x1534bf)=>{const _0x2c2d46=_0x18421d;let _0x106b2e=_0x33a8f2(_0x1534bf)[_0x2c2d46(0x10a)]()[_0x2c2d46(0x10c)](),_0x13b1f1=parseFloat(_0x106b2e[_0x2c2d46(0x25b)](/,/g,'')),_0x30536e={};!isNaN(_0x13b1f1)?(_0x30536e['v']=_0x13b1f1,_0x30536e['t']='n'):(_0x30536e['v']=_0x106b2e,_0x30536e['t']='s');const _0x22cb7e=_0x33a8f2(_0x1534bf)[_0x2c2d46(0xfd)](_0x2c2d46(0x116)),_0x260078=_0x3ffae0(_0x22cb7e);_0x30536e['s']={'border':_0x260078},_0xc63e32[_0x1984d7]=_0x30536e;let _0x1dcda0=parseInt(_0x33a8f2(_0x1534bf)[_0x2c2d46(0xfd)](_0x2c2d46(0x23f)))||0x1,_0x27a4fd=parseInt(_0x33a8f2(_0x1534bf)[_0x2c2d46(0xfd)](_0x2c2d46(0x251)))||0x1;(_0x1dcda0>0x1||_0x27a4fd>0x1)&&_0x2a9dfd[_0x2c2d46(0x1b9)]({'s':{'r':_0x56628c,'c':_0x1984d7},'e':{'r':_0x56628c+_0x27a4fd-0x1,'c':_0x1984d7+_0x1dcda0-0x1}});for(let _0x4d3454=0x0;_0x4d3454<_0x1dcda0;_0x4d3454++){_0x27a4fd>0x1&&(_0x1a5121[_0x1984d7+_0x4d3454]=_0x27a4fd-0x1);}_0x1984d7+=_0x1dcda0;}),_0x374639[_0x18421d(0x1b9)](_0xc63e32);});const _0x403e2c=XLSX[_0x5cd62d(0x197)][_0x5cd62d(0x258)](),_0x5a1599=XLSX['utils'][_0x5cd62d(0x259)](_0x374639);_0x2a9dfd['length']>0x0&&(_0x5a1599['!merges']=_0x2a9dfd);_0x5a1599[_0x5cd62d(0x171)]=_0x374639[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x403e2c,_0x5a1599,_0x5cd62d(0x241));const _0x4d7498=XLSX[_0x5cd62d(0x22a)](_0x403e2c,{'bookType':_0x5cd62d(0x1ed),'type':_0x5cd62d(0x1bd)});_0x22ea53[_0x5cd62d(0x170)]('Content-Disposition',_0x5cd62d(0x173)),_0x22ea53[_0x5cd62d(0x170)](_0x5cd62d(0x232),_0x5cd62d(0x1b3)),_0x22ea53[_0x5cd62d(0x1d3)](_0x4d7498);}else pdf[_0x5cd62d(0x1f6)](_0xba906b,_0x4b94ae)['toStream'](function(_0x138773,_0x132d93){const _0x4796a6=_0x5cd62d;if(_0x138773){console['error'](_0x4796a6(0x18e),_0x138773),_0x22ea53[_0x4796a6(0x1cd)](0x1f4)[_0x4796a6(0x1d3)](_0x4796a6(0x20a)+_0x138773);return;}_0x22ea53[_0x4796a6(0x170)](_0x4796a6(0x232),_0x4796a6(0x222)),_0x132d93['pipe'](_0x22ea53);});}),router[a0_0x4f1c0b(0x190)](a0_0x4f1c0b(0x125),auth,async(_0x5471a1,_0x13054d)=>{const _0x298a68=a0_0x4f1c0b;try{const {username:_0x875a4c,email:_0x5915cf,role:_0xefbcb3}=_0x5471a1[_0x298a68(0x27d)],_0x1e2f6f=_0x5471a1[_0x298a68(0x27d)],_0x4a30df=await profile[_0x298a68(0x1a8)]({'email':_0x1e2f6f[_0x298a68(0x1a3)]}),_0x317c8f={'year':_0x298a68(0x159),'month':'long','day':'numeric'},_0x3bf146=await master_shop['find'](),_0x57c642=await product[_0x298a68(0x244)](),_0x460a65=await warehouse[_0x298a68(0x225)]([{'$unwind':_0x298a68(0x234)},{'$lookup':{'from':_0x298a68(0x12b),'localField':'product_details.product_name','foreignField':'name','as':_0x298a68(0x207)}},{'$unwind':_0x298a68(0x16b)},{'$project':{'product_name':_0x298a68(0x27f),'product_stock':_0x298a68(0x156)}},{'$group':{'_id':_0x298a68(0x213),'product_stock':{'$sum':_0x298a68(0x157)}}}]),_0x44f614=await staff[_0x298a68(0x1a8)]({'email':_0x1e2f6f[_0x298a68(0x1a3)]});if(_0x3bf146[0x0][_0x298a68(0x18f)]=='English\x20(US)')var _0x3a6017=users[_0x298a68(0x279)];else{if(_0x3bf146[0x0][_0x298a68(0x18f)]==_0x298a68(0x149))var _0x3a6017=users[_0x298a68(0x149)];else{if(_0x3bf146[0x0][_0x298a68(0x18f)]==_0x298a68(0x135))var _0x3a6017=users['German'];else{if(_0x3bf146[0x0][_0x298a68(0x18f)]==_0x298a68(0x17e))var _0x3a6017=users[_0x298a68(0x17e)];else{if(_0x3bf146[0x0][_0x298a68(0x18f)]==_0x298a68(0x14c))var _0x3a6017=users['French'];else{if(_0x3bf146[0x0][_0x298a68(0x18f)]==_0x298a68(0x1af))var _0x3a6017=users['Portuguese'];else{if(_0x3bf146[0x0][_0x298a68(0x18f)]=='Chinese')var _0x3a6017=users['Chinese'];else{if(_0x3bf146[0x0][_0x298a68(0x18f)]==_0x298a68(0x17c))var _0x3a6017=users[_0x298a68(0x1e5)];}}}}}}}_0x13054d[_0x298a68(0x14e)]('sales_reports',{'success':_0x5471a1['flash'](_0x298a68(0x142)),'errors':_0x5471a1[_0x298a68(0x16e)](_0x298a68(0x219)),'alldata':_0x57c642,'profile':_0x4a30df,'master_shop':_0x3bf146,'role':_0x1e2f6f,'product_stock':_0x460a65,'language':_0x3a6017,'staff_arr':_0x44f614});}catch(_0xb80afe){}});async function dataSalesReports(_0x4c483a,_0x432cbe,_0x36f5bf){const _0x28b52b=a0_0x4f1c0b;let _0x128df4='';const _0x308273=await sales_sa[_0x28b52b(0x225)]([{'$match':{'date':{'$gte':_0x4c483a,'$lte':_0x432cbe},'sales_staff_id':_0x36f5bf}},{'$unwind':_0x28b52b(0x1cf)},{'$match':{'sale_product.isFG':_0x28b52b(0x24e)}},{'$group':{'_id':{'product_name':_0x28b52b(0x1da),'product_code':_0x28b52b(0x265)},'sumqty':{'$sum':_0x28b52b(0x273)},'totalPrice':{'$sum':_0x28b52b(0x226)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x1ddfac=0x0,_0x411252=0x0;for(let _0x4b484e=0x0;_0x4b484e<=_0x308273[_0x28b52b(0x134)]-0x1;_0x4b484e++){const _0x4842ad=_0x308273[_0x4b484e];var _0xfe4e=_0x4842ad['totalPrice'][_0x28b52b(0x127)](undefined),_0x113aa5=_0x4842ad[_0x28b52b(0x196)]['toLocaleString'](undefined);_0x128df4+=_0x28b52b(0x13e),_0x128df4+='<td\x20class=\x22row_data\x22>'+_0x4842ad['_id']['product_code']+'</td>',_0x128df4+=_0x28b52b(0x227)+_0x4842ad[_0x28b52b(0x10e)][_0x28b52b(0x20f)]+_0x28b52b(0x1f3),_0x128df4+=_0x28b52b(0x227)+formatNumber(_0x4842ad[_0x28b52b(0x196)][_0x28b52b(0x169)](0x2))+_0x28b52b(0x1f3),_0x128df4+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x4842ad[_0x28b52b(0x193)][_0x28b52b(0x169)](0x2))+_0x28b52b(0x1f3),_0x128df4+=_0x28b52b(0x1a1),_0x1ddfac+=parseFloat(_0x4842ad[_0x28b52b(0x196)]),_0x411252+=parseFloat(_0x4842ad[_0x28b52b(0x193)]);}var _0x32f3ce=_0x411252[_0x28b52b(0x127)](undefined),_0x26b906=_0x1ddfac['toLocaleString'](undefined);return _0x128df4+='<tr>',_0x128df4+=_0x28b52b(0x281),_0x128df4+=_0x28b52b(0x14a)+formatNumber(_0x1ddfac['toFixed'](0x2))+_0x28b52b(0x191),_0x128df4+=_0x28b52b(0x14a)+formatNumber(_0x411252[_0x28b52b(0x169)](0x2))+_0x28b52b(0x191),_0x128df4+=_0x28b52b(0x1a1),_0x128df4;}router[a0_0x4f1c0b(0x23a)]('/total_sales_reports/pdf',auth,async(_0x52df51,_0x512682)=>{const _0x3fe137=a0_0x4f1c0b;try{const {from_date:_0xf75ba7,to_date:_0x30bea0,isExcel:_0x3acde8}=_0x52df51[_0x3fe137(0x108)],_0x1f49d5=_0x52df51[_0x3fe137(0x27d)],_0x9ab177=await staff['findOne']({'email':_0x1f49d5[_0x3fe137(0x1a3)]});let _0x8f7197=_0x3fe137(0x215);var _0x24c2cf=new Date(_0xf75ba7),_0x48e105=new Date(_0x30bea0);const _0x33891d={'year':_0x3fe137(0x159),'month':_0x3fe137(0x140),'day':_0x3fe137(0x159)},_0x52338d=new Intl[(_0x3fe137(0x21f))](_0x3fe137(0x269),_0x33891d)[_0x3fe137(0x221)](_0x24c2cf),_0x47e566=new Intl[(_0x3fe137(0x21f))](_0x3fe137(0x269),_0x33891d)['format'](_0x48e105);var _0x4a329a=await dataSalesReports(_0xf75ba7,_0x30bea0,_0x9ab177['_id'][_0x3fe137(0x163)]());_0x8f7197+=_0x3fe137(0x11f),_0x8f7197+='<div\x20class=\x22col-sm-11\x22>',_0x8f7197+=_0x3fe137(0x1d4),_0x8f7197+='<tr>',_0x8f7197+=_0x3fe137(0x160),_0x8f7197+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x8f7197+='<th>\x20QTY\x20SOLD\x20</th>',_0x8f7197+='<th>\x20INVOICE\x20AMOUNT\x20</th>',_0x8f7197+=_0x3fe137(0x13e),_0x8f7197+=_0x4a329a,_0x8f7197+=_0x3fe137(0x1a1),_0x8f7197+=_0x3fe137(0x1b6),_0x8f7197+='</div>';let _0x33859e=_0x3fe137(0x1d5);const _0x2e2cc0={'width':'15in','height':_0x3fe137(0x1e9),'orientation':_0x3fe137(0x120),'border':{'top':_0x3fe137(0x121),'right':_0x3fe137(0x121),'bottom':'0.1in','left':_0x3fe137(0x121)},'header':{'height':_0x3fe137(0x1a6),'contents':_0x3fe137(0x1ff)+_0x33859e+_0x3fe137(0xff)+_0x9ab177[_0x3fe137(0x20d)]+_0x3fe137(0x206)+_0x52338d+_0x3fe137(0x16f)+_0x47e566+_0x3fe137(0x103)},'footer':{'height':_0x3fe137(0x1c2),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3fe137(0x1e8)}}};if(_0x3acde8=='on'){const _0x52e9c7=cheerio[_0x3fe137(0x1f0)](_0x8f7197);let _0x514a4e=[],_0x3b4a6c=[],_0x469e5d=[];const _0x348e1c=_0x5811bc=>{const _0x4846f1=_0x3fe137,_0x1935bf={'top':{'style':_0x4846f1(0x1de),'color':{'rgb':_0x4846f1(0x185)}},'bottom':{'style':_0x4846f1(0x1de),'color':{'rgb':_0x4846f1(0x185)}},'left':{'style':_0x4846f1(0x1de),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x4846f1(0x185)}}};if(_0x5811bc){const _0x42c7d7=_0x5811bc[_0x4846f1(0x26d)](';')[_0x4846f1(0x16a)]((_0x2ea3cd,_0x5d8cf1)=>{const _0x42fd80=_0x4846f1,[_0x56c3f8,_0x46eae8]=_0x5d8cf1[_0x42fd80(0x26d)](':')[_0x42fd80(0x277)](_0xea753=>_0xea753[_0x42fd80(0x10c)]());return _0x2ea3cd[_0x56c3f8]=_0x46eae8,_0x2ea3cd;},{});_0x42c7d7[_0x4846f1(0x154)]&&(_0x1935bf[_0x4846f1(0x138)][_0x4846f1(0x116)]=_0x42c7d7['border-top'][_0x4846f1(0x1a4)](_0x4846f1(0x1f7))?_0x4846f1(0x1f7):_0x4846f1(0x27a)),_0x42c7d7[_0x4846f1(0x106)]&&(_0x1935bf[_0x4846f1(0x270)]['style']=_0x42c7d7[_0x4846f1(0x106)][_0x4846f1(0x1a4)](_0x4846f1(0x1f7))?'thin':_0x4846f1(0x27a)),_0x42c7d7['border-left']&&(_0x1935bf['left'][_0x4846f1(0x116)]=_0x42c7d7[_0x4846f1(0x249)]['includes'](_0x4846f1(0x1f7))?_0x4846f1(0x1f7):'medium'),_0x42c7d7['border-right']&&(_0x1935bf[_0x4846f1(0x242)][_0x4846f1(0x116)]=_0x42c7d7[_0x4846f1(0x195)][_0x4846f1(0x1a4)](_0x4846f1(0x1f7))?'thin':_0x4846f1(0x27a));}return _0x1935bf;};_0x52e9c7('table\x20tr')[_0x3fe137(0x143)]((_0x52a198,_0x586314)=>{const _0x510ffa=_0x3fe137;let _0xe86116=[],_0x5a1191=0x0;while(_0x469e5d[_0x5a1191]){_0x469e5d[_0x5a1191]--,_0x5a1191++;}_0x52e9c7(_0x586314)['find'](_0x510ffa(0x228))[_0x510ffa(0x143)]((_0x32e8c9,_0x480eb6)=>{const _0x1b1e0c=_0x510ffa;let _0x222d0d=_0x52e9c7(_0x480eb6)[_0x1b1e0c(0x10a)]()[_0x1b1e0c(0x10c)](),_0x134781=parseFloat(_0x222d0d[_0x1b1e0c(0x25b)](/,/g,'')),_0x5b5d82={};!isNaN(_0x134781)?(_0x5b5d82['v']=_0x134781,_0x5b5d82['t']='n'):(_0x5b5d82['v']=_0x222d0d,_0x5b5d82['t']='s');const _0x54c69a=_0x52e9c7(_0x480eb6)['attr'](_0x1b1e0c(0x116)),_0x1c7185=_0x348e1c(_0x54c69a);_0x5b5d82['s']={'border':_0x1c7185},_0xe86116[_0x5a1191]=_0x5b5d82;let _0x4b474b=parseInt(_0x52e9c7(_0x480eb6)[_0x1b1e0c(0xfd)](_0x1b1e0c(0x23f)))||0x1,_0x34baf0=parseInt(_0x52e9c7(_0x480eb6)[_0x1b1e0c(0xfd)](_0x1b1e0c(0x251)))||0x1;(_0x4b474b>0x1||_0x34baf0>0x1)&&_0x3b4a6c[_0x1b1e0c(0x1b9)]({'s':{'r':_0x52a198,'c':_0x5a1191},'e':{'r':_0x52a198+_0x34baf0-0x1,'c':_0x5a1191+_0x4b474b-0x1}});for(let _0x229974=0x0;_0x229974<_0x4b474b;_0x229974++){_0x34baf0>0x1&&(_0x469e5d[_0x5a1191+_0x229974]=_0x34baf0-0x1);}_0x5a1191+=_0x4b474b;}),_0x514a4e[_0x510ffa(0x1b9)](_0xe86116);});const _0x7e4de2=XLSX[_0x3fe137(0x197)]['book_new'](),_0xeb7373=XLSX['utils'][_0x3fe137(0x259)](_0x514a4e);_0x3b4a6c[_0x3fe137(0x134)]>0x0&&(_0xeb7373[_0x3fe137(0x1ef)]=_0x3b4a6c);_0xeb7373['!cols']=_0x514a4e[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x3fe137(0x197)][_0x3fe137(0x237)](_0x7e4de2,_0xeb7373,_0x3fe137(0x241));const _0x1c89c2=XLSX[_0x3fe137(0x22a)](_0x7e4de2,{'bookType':_0x3fe137(0x1ed),'type':'buffer'});_0x512682[_0x3fe137(0x170)](_0x3fe137(0x188),_0x3fe137(0x173)),_0x512682[_0x3fe137(0x170)]('Content-Type',_0x3fe137(0x1b3)),_0x512682[_0x3fe137(0x1d3)](_0x1c89c2);}else pdf[_0x3fe137(0x1f6)](_0x8f7197,_0x2e2cc0)[_0x3fe137(0x275)](function(_0x4fca60,_0x5d6d81){const _0x104cc2=_0x3fe137;if(_0x4fca60){_0x512682[_0x104cc2(0x1cd)](0x1f4)[_0x104cc2(0x1d3)](_0x104cc2(0x20a));return;}_0x512682[_0x104cc2(0x170)](_0x104cc2(0x232),_0x104cc2(0x222)),_0x5d6d81[_0x104cc2(0x272)](_0x512682);});}catch(_0x423852){}}),router[a0_0x4f1c0b(0x190)](a0_0x4f1c0b(0x25c),auth,async(_0x41b9cb,_0x3ccb0d)=>{const _0x2a0db5=a0_0x4f1c0b;try{const {username:_0xe66021,email:_0x5533a4,role:_0x399293}=_0x41b9cb[_0x2a0db5(0x27d)],_0x56fc32=_0x41b9cb[_0x2a0db5(0x27d)],_0x1c2641=await profile[_0x2a0db5(0x1a8)]({'email':_0x56fc32[_0x2a0db5(0x1a3)]}),_0x197eec={'year':_0x2a0db5(0x159),'month':_0x2a0db5(0x140),'day':_0x2a0db5(0x159)},_0x55f08b=await master_shop['find'](),_0x23bd7b=await product[_0x2a0db5(0x244)](),_0x1b2f7b=await warehouse[_0x2a0db5(0x225)]([{'$unwind':_0x2a0db5(0x234)},{'$lookup':{'from':_0x2a0db5(0x12b),'localField':_0x2a0db5(0x155),'foreignField':_0x2a0db5(0x20d),'as':_0x2a0db5(0x207)}},{'$unwind':_0x2a0db5(0x16b)},{'$project':{'product_name':_0x2a0db5(0x27f),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);if(_0x55f08b[0x0][_0x2a0db5(0x18f)]=='English\x20(US)')var _0x4519d3=users['English'];else{if(_0x55f08b[0x0][_0x2a0db5(0x18f)]==_0x2a0db5(0x149))var _0x4519d3=users[_0x2a0db5(0x149)];else{if(_0x55f08b[0x0]['language']==_0x2a0db5(0x135))var _0x4519d3=users[_0x2a0db5(0x135)];else{if(_0x55f08b[0x0][_0x2a0db5(0x18f)]=='Spanish')var _0x4519d3=users[_0x2a0db5(0x17e)];else{if(_0x55f08b[0x0]['language']==_0x2a0db5(0x14c))var _0x4519d3=users[_0x2a0db5(0x14c)];else{if(_0x55f08b[0x0]['language']==_0x2a0db5(0x1af))var _0x4519d3=users[_0x2a0db5(0x176)];else{if(_0x55f08b[0x0][_0x2a0db5(0x18f)]==_0x2a0db5(0x18b))var _0x4519d3=users['Chinese'];else{if(_0x55f08b[0x0][_0x2a0db5(0x18f)]==_0x2a0db5(0x17c))var _0x4519d3=users[_0x2a0db5(0x1e5)];}}}}}}}_0x3ccb0d[_0x2a0db5(0x14e)]('inventory_sum',{'success':_0x41b9cb[_0x2a0db5(0x16e)](_0x2a0db5(0x142)),'errors':_0x41b9cb['flash']('errors'),'alldata':_0x23bd7b,'profile':_0x1c2641,'master_shop':_0x55f08b,'role':_0x56fc32,'product_stock':_0x1b2f7b,'language':_0x4519d3});}catch(_0x4eaae6){}});async function dataInventoryReports(_0x41e86d,_0x5ed9a1,_0x5ae083){const _0x341798=a0_0x4f1c0b,_0x4ed0ad=await sales_sa[_0x341798(0x225)]([{'$match':{'date':{'$gte':_0x41e86d,'$lte':_0x5ed9a1},'sales_staff_id':_0x5ae083}},{'$unwind':_0x341798(0x1cf)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x341798(0x265)},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x3ee3e1=mongoose[_0x341798(0x22e)]['ObjectId'],_0x5dfa66=await staff[_0x341798(0x225)]([{'$match':{'_id':_0x3ee3e1(_0x5ae083)}},{'$unwind':_0x341798(0x112)},{'$match':{'product_list.isConfirm':_0x341798(0x231)}},{'$group':{'_id':{'product_name':'$product_list.product_name','product_code':'$product_list.product_code'},'sumqty':{'$sum':_0x341798(0x1f8)}}},{'$sort':{'_id.product_name':0x1}}]),_0x2d2e86=await sales_inv_data['aggregate']([{'$match':{'date':{'$gte':_0x41e86d,'$lte':_0x5ed9a1},'sales_staff_id':_0x5ae083}},{'$unwind':_0x341798(0x1cf)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x341798(0x265)},'totalQTYsum':{'$sum':_0x341798(0x124)}}}]);console[_0x341798(0x141)](_0x2d2e86);let _0x47794c='';var _0x1cc351=0x0;for(let _0x428e98=0x0;_0x428e98<=_0x5dfa66[_0x341798(0x134)]-0x1;_0x428e98++){const _0x3e28e7=_0x5dfa66[_0x428e98];_0x47794c+='<tr>',_0x47794c+=_0x341798(0x217)+_0x3e28e7['_id'][_0x341798(0x1e6)]+_0x341798(0x1f3),_0x47794c+=_0x341798(0x254)+_0x3e28e7[_0x341798(0x10e)]['product_name']+'</td>';var _0xe7c4ca=_0x3e28e7[_0x341798(0x196)],_0xb48480=0x0;for(let _0x3ca631=0x0;_0x3ca631<=_0x4ed0ad['length']-0x1;_0x3ca631++){const _0x374cd0=_0x4ed0ad[_0x3ca631];_0x3e28e7['_id'][_0x341798(0x1e6)]==_0x374cd0[_0x341798(0x10e)][_0x341798(0x1e6)]&&_0x3e28e7['_id'][_0x341798(0x20f)]==_0x374cd0[_0x341798(0x10e)][_0x341798(0x20f)]&&(_0xb48480=_0x374cd0['sumqty']);}var _0x5176ec=0x0;for(let _0x548117=0x0;_0x548117<=_0x2d2e86[_0x341798(0x134)]-0x1;_0x548117++){const _0x9b014a=_0x2d2e86[_0x548117];_0x3e28e7[_0x341798(0x10e)]['product_code']==_0x9b014a[_0x341798(0x10e)][_0x341798(0x1e6)]&&_0x3e28e7[_0x341798(0x10e)][_0x341798(0x20f)]==_0x9b014a['_id'][_0x341798(0x20f)]&&(_0x5176ec=_0x9b014a[_0x341798(0x19d)]);}_0x1cc351=_0xe7c4ca-_0x5176ec+_0xb48480,_0x47794c+=_0x341798(0x227)+_0x1cc351+_0x341798(0x1f3);let _0x210022=![];for(let _0x4002b4=0x0;_0x4002b4<=_0x2d2e86[_0x341798(0x134)]-0x1;_0x4002b4++){const _0x5303a3=_0x2d2e86[_0x4002b4];if(_0x3e28e7[_0x341798(0x10e)][_0x341798(0x1e6)]==_0x5303a3[_0x341798(0x10e)][_0x341798(0x1e6)]&&_0x3e28e7[_0x341798(0x10e)]['product_name']==_0x5303a3[_0x341798(0x10e)]['product_name']){_0x47794c+=_0x341798(0x227)+_0x5303a3[_0x341798(0x19d)]+'</td>',_0x210022=!![];break;}}!_0x210022&&(_0x47794c+=_0x341798(0x194));let _0x575c3c=![];for(let _0x1bb6d8=0x0;_0x1bb6d8<=_0x4ed0ad['length']-0x1;_0x1bb6d8++){const _0x1524c6=_0x4ed0ad[_0x1bb6d8];if(_0x3e28e7['_id'][_0x341798(0x1e6)]==_0x1524c6[_0x341798(0x10e)][_0x341798(0x1e6)]&&_0x3e28e7[_0x341798(0x10e)][_0x341798(0x20f)]==_0x1524c6[_0x341798(0x10e)][_0x341798(0x20f)]){_0x47794c+='<td\x20class=\x22row_data\x22>'+_0x1524c6['sumqty']+_0x341798(0x1f3),_0x575c3c=!![];break;}}!_0x575c3c&&(_0x47794c+=_0x341798(0x194)),_0x47794c+=_0x341798(0x227)+_0x3e28e7[_0x341798(0x196)]+'</td>',_0x47794c+=_0x341798(0x1a1);}return _0x47794c;}router[a0_0x4f1c0b(0x23a)]('/inventory_sum/pdf',auth,async(_0x12a916,_0x4485a9)=>{const _0x36bafa=a0_0x4f1c0b;try{const {from_date:_0x5d59a4,to_date:_0x2a7f5f}=_0x12a916[_0x36bafa(0x108)],_0x3098b1=_0x12a916['user'],_0x1c797c=await staff[_0x36bafa(0x1a8)]({'email':_0x3098b1[_0x36bafa(0x1a3)]});let _0x34c38f=_0x36bafa(0x215);var _0x372e7c=new Date(_0x5d59a4),_0x1eb30a=new Date(_0x2a7f5f);const _0x10d06a={'year':_0x36bafa(0x159),'month':_0x36bafa(0x140),'day':'numeric'},_0x53bb45=new Intl[(_0x36bafa(0x21f))]('en-US',_0x10d06a)['format'](_0x372e7c),_0x515a76=new Intl[(_0x36bafa(0x21f))](_0x36bafa(0x269),_0x10d06a)['format'](_0x1eb30a);var _0x3f8b24=await dataInventoryReports(_0x5d59a4,_0x2a7f5f,_0x1c797c[_0x36bafa(0x10e)]['valueOf']());_0x34c38f+=_0x36bafa(0x208),_0x34c38f+=_0x36bafa(0x204),_0x34c38f+=_0x36bafa(0x26c)+_0x53bb45+_0x36bafa(0x16f)+_0x515a76+_0x36bafa(0x1c7),_0x34c38f+=_0x36bafa(0x11f),_0x34c38f+='<div\x20class=\x22col-sm-11\x22>',_0x34c38f+=_0x36bafa(0x1d4),_0x34c38f+='<tr>',_0x34c38f+=_0x36bafa(0x160),_0x34c38f+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x34c38f+=_0x36bafa(0x1fa),_0x34c38f+=_0x36bafa(0x19b),_0x34c38f+='<th>\x20SALES\x20</th>',_0x34c38f+=_0x36bafa(0x26f),_0x34c38f+=_0x36bafa(0x13e),_0x34c38f+=_0x3f8b24,_0x34c38f+=_0x36bafa(0x1a1),_0x34c38f+=_0x36bafa(0x1b6),_0x34c38f+=_0x36bafa(0x1b6);const _0x1a22da={'format':_0x36bafa(0x245),'orientation':_0x36bafa(0x120),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x36bafa(0x1e8)}}};pdf[_0x36bafa(0x1f6)](_0x34c38f,_0x1a22da)['toStream'](function(_0x5f9508,_0x4fb9fa){const _0x4098e4=_0x36bafa;if(_0x5f9508){_0x4485a9['status'](0x1f4)[_0x4098e4(0x1d3)](_0x4098e4(0x20a));return;}_0x4485a9[_0x4098e4(0x170)](_0x4098e4(0x232),_0x4098e4(0x222)),_0x4fb9fa[_0x4098e4(0x272)](_0x4485a9);});}catch(_0x34e64e){}}),router[a0_0x4f1c0b(0x190)](a0_0x4f1c0b(0x1c5),auth,async(_0x594098,_0x1de2a0)=>{const _0x56f2c6=a0_0x4f1c0b;try{const {username:_0x5c2c63,email:_0x5872d6,role:_0x243828}=_0x594098['user'],_0x21188a=_0x594098[_0x56f2c6(0x27d)],_0xa86592=await profile[_0x56f2c6(0x1a8)]({'email':_0x21188a[_0x56f2c6(0x1a3)]}),_0x2d2a54={'year':'numeric','month':_0x56f2c6(0x140),'day':_0x56f2c6(0x159)},_0x3771c5=await master_shop[_0x56f2c6(0x244)]();console['log'](_0x56f2c6(0x282),_0x3771c5);const _0x1fe4a5=await product[_0x56f2c6(0x244)]();console[_0x56f2c6(0x141)]('Products\x20find_data',_0x1fe4a5);const _0x40fc21=await warehouse[_0x56f2c6(0x225)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x56f2c6(0x12b),'localField':_0x56f2c6(0x155),'foreignField':_0x56f2c6(0x20d),'as':_0x56f2c6(0x207)}},{'$unwind':_0x56f2c6(0x16b)},{'$project':{'product_name':_0x56f2c6(0x27f),'product_stock':_0x56f2c6(0x156)}},{'$group':{'_id':_0x56f2c6(0x213),'product_stock':{'$sum':_0x56f2c6(0x157)}}}]);console['log'](_0x56f2c6(0x25e),_0x40fc21),_0x40fc21[_0x56f2c6(0x257)](_0x78399c=>{const _0x2942b6=_0x1fe4a5['map'](_0x143541=>{const _0x81d740=a0_0x4a03;_0x143541[_0x81d740(0x20d)]==_0x78399c['_id']&&(_0x143541[_0x81d740(0x1c8)]=parseInt(_0x143541['stock'])+parseInt(_0x78399c[_0x81d740(0x21d)]));});});const _0x4e93b5=await staff['findOne']({'email':_0x21188a['email']});if(_0x3771c5[0x0][_0x56f2c6(0x18f)]==_0x56f2c6(0x115))var _0x2b8f30=users[_0x56f2c6(0x279)];else{if(_0x3771c5[0x0][_0x56f2c6(0x18f)]==_0x56f2c6(0x149))var _0x2b8f30=users['Hindi'];else{if(_0x3771c5[0x0][_0x56f2c6(0x18f)]==_0x56f2c6(0x135))var _0x2b8f30=users[_0x56f2c6(0x135)];else{if(_0x3771c5[0x0][_0x56f2c6(0x18f)]=='Spanish')var _0x2b8f30=users[_0x56f2c6(0x17e)];else{if(_0x3771c5[0x0][_0x56f2c6(0x18f)]=='French')var _0x2b8f30=users[_0x56f2c6(0x14c)];else{if(_0x3771c5[0x0][_0x56f2c6(0x18f)]==_0x56f2c6(0x1af))var _0x2b8f30=users['Portuguese'];else{if(_0x3771c5[0x0][_0x56f2c6(0x18f)]==_0x56f2c6(0x18b))var _0x2b8f30=users[_0x56f2c6(0x18b)];else{if(_0x3771c5[0x0]['language']==_0x56f2c6(0x17c))var _0x2b8f30=users[_0x56f2c6(0x1e5)];}}}}}}}_0x1de2a0[_0x56f2c6(0x14e)]('dssr_view',{'success':_0x594098[_0x56f2c6(0x16e)](_0x56f2c6(0x142)),'errors':_0x594098['flash'](_0x56f2c6(0x219)),'alldata':_0x1fe4a5,'profile':_0xa86592,'master_shop':_0x3771c5,'role':_0x21188a,'product_stock':_0x40fc21,'language':_0x2b8f30,'staff_arr':_0x4e93b5});}catch(_0x186db4){}});async function agentsdataDSICheck_DSRR(_0x125879,_0x2684d8,_0x2b3d36,_0x51d027){const _0x5973b5=a0_0x4f1c0b;let _0x52cca9=new Date(_0x125879);_0x52cca9[_0x5973b5(0x1d8)](_0x52cca9[_0x5973b5(0x129)]()-0x1);let _0x464fa7=_0x52cca9[_0x5973b5(0x183)]()[_0x5973b5(0x26d)]('T')[0x0];const _0x305b99=await product[_0x5973b5(0x225)]([{'$group':{'_id':{'brand':'$brand','category':_0x5973b5(0x18a)},'products':{'$push':{'name':_0x5973b5(0x1d0),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x534fd2=[];_0x534fd2[_0x5973b5(0x132)]=[];for(let _0x6b41c=0x0;_0x6b41c<=_0x305b99['length']-0x1;_0x6b41c++){const _0x193373=_0x305b99[_0x6b41c];_0x534fd2[_0x5973b5(0x132)]['push'](_0x193373);}const _0x18f64d=await product[_0x5973b5(0x225)]([{'$group':{'_id':{'category':_0x5973b5(0x18a)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x5973b5(0x1d0)}}}},{'$sort':{'_id.category':-0x1}}]),_0x31db96=await product[_0x5973b5(0x225)]([{'$group':{'_id':{'category':_0x5973b5(0x18a),'brand':_0x5973b5(0x162)}}},{'$group':{'_id':_0x5973b5(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3d720f=await sales_sa[_0x5973b5(0x225)]([{'$match':{'date':_0x125879,'sales_staff_id':_0x2684d8,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x5973b5(0x12b),'localField':_0x5973b5(0x209),'foreignField':'product_code','as':_0x5973b5(0x1eb)}},{'$unwind':_0x5973b5(0x25f)},{'$group':{'_id':{'dsi':'$dsi','date':_0x5973b5(0x109),'customer':_0x5973b5(0x1e0),'status_data':'$status_data'},'totalQty':{'$sum':_0x5973b5(0x273)},'cash':{'$first':_0x5973b5(0x260)},'amount':{'$first':_0x5973b5(0x278)},'bank':{'$first':_0x5973b5(0x224)},'check_no':{'$first':_0x5973b5(0x201)},'due_date':{'$first':_0x5973b5(0x1d6)},'products':{'$push':{'qty':_0x5973b5(0x273),'NetPrice':_0x5973b5(0x226),'discount':'$sale_product.discount','adj_discount':_0x5973b5(0x12a),'product_details':{'prod_name':_0x5973b5(0x164),'product_code':_0x5973b5(0x113),'category':_0x5973b5(0x223),'brand':'$product_info.brand','gross_price':_0x5973b5(0x1df),'isFG':_0x5973b5(0x1e3),'prod_cat':_0x5973b5(0x18d),'prod_id':_0x5973b5(0x181)}}}}},{'$unwind':_0x5973b5(0x262)},{'$group':{'_id':{'dsi':_0x5973b5(0x236),'date':_0x5973b5(0x1d1),'customer':_0x5973b5(0x100),'status_data':_0x5973b5(0x20c),'category':_0x5973b5(0x168),'brand':_0x5973b5(0x1b1),'prod_id':_0x5973b5(0x144)},'totalQty':{'$sum':_0x5973b5(0x13a)},'totalGross':{'$sum':{'$multiply':[_0x5973b5(0x13a),_0x5973b5(0x104)]}},'NetPrice':{'$sum':_0x5973b5(0x1f2)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':_0x5973b5(0x260)},'amount':{'$first':'$amount'},'bank':{'$first':'$bank'},'check_no':{'$first':_0x5973b5(0x201)},'due_date':{'$first':_0x5973b5(0x1d6)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x5973b5(0x236),'date':'$_id.date','customer':'$_id.customer','status_data':_0x5973b5(0x20c)},'totalQty':{'$sum':_0x5973b5(0x24f)},'totalGross':{'$sum':_0x5973b5(0x238)},'NetPrice':{'$sum':_0x5973b5(0x152)},'discount':{'$sum':_0x5973b5(0x184)},'adj_discount':{'$sum':_0x5973b5(0x24a)},'cash':{'$first':'$cash'},'amount':{'$first':_0x5973b5(0x278)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x5973b5(0x201)},'due_date':{'$first':_0x5973b5(0x1d6)},'products':{'$push':{'qty':_0x5973b5(0x24f),'category':_0x5973b5(0x1b0),'brand':_0x5973b5(0x27b),'product_details':_0x5973b5(0x234)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5a84dc=await sales_sa[_0x5973b5(0x225)]([{'$match':{'date':_0x464fa7,'sales_staff_id':_0x2684d8,'sale_product.isFG':_0x5973b5(0x24e)}},{'$unwind':_0x5973b5(0x1cf)},{'$lookup':{'from':'products','localField':_0x5973b5(0x209),'foreignField':_0x5973b5(0x1e6),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':_0x5973b5(0x109),'customer':'$customer'},'totalQty':{'$sum':_0x5973b5(0x273)},'cash':{'$first':'$cash'},'amount':{'$first':_0x5973b5(0x278)},'bank':{'$first':_0x5973b5(0x224)},'check_no':{'$first':_0x5973b5(0x201)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x5973b5(0x273),'NetPrice':_0x5973b5(0x226),'discount':_0x5973b5(0x147),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x5973b5(0x164),'product_code':_0x5973b5(0x113),'category':'$product_info.category','brand':_0x5973b5(0x1fe),'gross_price':'$product_info.gross_price','isFG':_0x5973b5(0x1e3),'prod_cat':_0x5973b5(0x18d),'prod_id':_0x5973b5(0x181)}}}}},{'$unwind':_0x5973b5(0x262)},{'$group':{'_id':{'dsi':_0x5973b5(0x236),'date':'$_id.date','customer':_0x5973b5(0x100),'category':_0x5973b5(0x168),'brand':_0x5973b5(0x1b1),'prod_id':_0x5973b5(0x144)},'totalQty':{'$sum':'$products.qty'},'cash':{'$first':_0x5973b5(0x260)},'amount':{'$first':'$amount'},'bank':{'$first':'$bank'},'check_no':{'$first':_0x5973b5(0x201)},'due_date':{'$first':_0x5973b5(0x1d6)},'totalGross':{'$sum':{'$multiply':[_0x5973b5(0x13a),_0x5973b5(0x104)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x5973b5(0x220)},'adj_discount':{'$sum':_0x5973b5(0x179)},'product_details':{'$first':_0x5973b5(0x12d)}}},{'$group':{'_id':{'dsi':_0x5973b5(0x236),'date':_0x5973b5(0x1d1),'customer':_0x5973b5(0x100)},'totalQty':{'$sum':_0x5973b5(0x24f)},'cash':{'$first':_0x5973b5(0x260)},'amount':{'$first':_0x5973b5(0x278)},'bank':{'$first':_0x5973b5(0x224)},'check_no':{'$first':_0x5973b5(0x201)},'due_date':{'$first':_0x5973b5(0x1d6)},'totalGross':{'$sum':_0x5973b5(0x238)},'NetPrice':{'$sum':_0x5973b5(0x152)},'discount':{'$sum':_0x5973b5(0x184)},'adj_discount':{'$sum':_0x5973b5(0x24a)},'products':{'$push':{'qty':'$totalQty','category':_0x5973b5(0x1b0),'brand':_0x5973b5(0x27b),'product_details':_0x5973b5(0x234)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x27127b=await sales_sa[_0x5973b5(0x225)]([{'$match':{'date':_0x125879,'sales_staff_id':_0x2684d8,'status_data':_0x5973b5(0x231)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xf6ed=await staff[_0x5973b5(0x26e)](_0x2684d8);let _0x4626f0=[],_0x25555d={},_0x4db8f5={};var _0x4c2e28=0x0,_0x2839dd=0x0,_0x18986f=0x0,_0x2acb5a=0x0,_0x3d2528=0x0;const _0x2e2a1b=0x6;var _0x210b13=0x0,_0x4c4384=0x0;for(let _0x1aaa79=0x0;_0x1aaa79<=_0x3d720f[_0x5973b5(0x134)]-0x1;_0x1aaa79++){const _0x5ed76d=_0x3d720f[_0x1aaa79];let _0x165ca2=_0x5973b5(0x13e);_0x165ca2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x165ca2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5ed76d['_id'][_0x5973b5(0x19e)]+'</td>',_0x165ca2+=_0x5973b5(0x189)+_0x5ed76d[_0x5973b5(0x10e)][_0x5973b5(0x1f9)]+_0x5973b5(0x1f3);let _0x562479={},_0x222969={},_0x1a21fd={};var _0x1d55e8={},_0x182618={},_0x2356e2={},_0x374c62=0x0;for(let _0x1a459b=0x0;_0x1a459b<=_0x5ed76d[_0x5973b5(0x12b)][_0x5973b5(0x134)]-0x1;_0x1a459b++){const _0x2ca5a8=_0x5ed76d[_0x5973b5(0x12b)][_0x1a459b];_0x562479[_0x2ca5a8[_0x5973b5(0x182)]+'-'+_0x2ca5a8[_0x5973b5(0x1b8)]]=_0x2ca5a8[_0x5973b5(0x26a)],_0x222969[[_0x2ca5a8[_0x5973b5(0x182)]+'-'+_0x2ca5a8[_0x5973b5(0x1b8)]]]=_0x2ca5a8[_0x5973b5(0x12c)][_0x5973b5(0x27c)],_0x1a21fd[[_0x2ca5a8[_0x5973b5(0x182)]+'-'+_0x2ca5a8[_0x5973b5(0x1b8)]]]=_0x2ca5a8[_0x5973b5(0x12c)][_0x5973b5(0x243)];const _0x36b7e7=_0x2ca5a8[_0x5973b5(0x182)]+'-'+_0x2ca5a8[_0x5973b5(0x1b8)];!Array[_0x5973b5(0x27e)](_0x4db8f5[_0x36b7e7])&&(_0x4db8f5[_0x36b7e7]=[]);!Array[_0x5973b5(0x27e)](_0x4db8f5[_0x36b7e7])&&(_0x4db8f5[_0x36b7e7]=[]);_0x4db8f5[_0x36b7e7][_0x5973b5(0x1b9)](_0x2ca5a8['qty']);if(_0x2ca5a8[_0x5973b5(0x12c)][_0x5973b5(0x243)]=='P')_0x2ca5a8['product_details'][_0x5973b5(0x27c)]=='true'?(!_0x2356e2[_0x36b7e7]&&(_0x2356e2[_0x36b7e7]=0x0),_0x2356e2[_0x36b7e7]=_0x2ca5a8[_0x5973b5(0x26a)]):(!_0x1d55e8[_0x36b7e7]&&(_0x1d55e8[_0x36b7e7]=0x0),_0x1d55e8[_0x36b7e7]=_0x2ca5a8[_0x5973b5(0x26a)]);else _0x2ca5a8[_0x5973b5(0x12c)][_0x5973b5(0x243)]=='S'&&(_0x2ca5a8['product_details'][_0x5973b5(0x27c)]==_0x5973b5(0x231)?(!_0x2356e2[_0x36b7e7]&&(_0x2356e2[_0x36b7e7]=0x0),_0x2356e2[_0x36b7e7]=_0x2ca5a8['qty']):(!_0x182618[_0x36b7e7]&&(_0x182618[_0x36b7e7]=0x0),_0x182618[_0x36b7e7]=_0x2ca5a8['qty']));_0x374c62++;}for(let _0x5c7749=0x0;_0x5c7749<=_0x534fd2[_0x5973b5(0x132)][_0x5973b5(0x134)]-0x1;_0x5c7749++){const _0x4600e5=_0x534fd2[_0x5973b5(0x132)][_0x5c7749],_0x4f3a56=_0x4600e5['_id']['brand']+'-'+_0x4600e5[_0x5973b5(0x10e)][_0x5973b5(0x1b8)],_0x48e487=_0x1a21fd[_0x4f3a56]!==undefined?_0x1a21fd[_0x4f3a56]:'NA';var _0x39c42f=_0x1d55e8[_0x4f3a56]!==undefined?_0x1d55e8[_0x4f3a56][_0x5973b5(0x169)](0x2):'',_0x14a4ec=_0x182618[_0x4f3a56]!==undefined?_0x182618[_0x4f3a56][_0x5973b5(0x169)](0x2):'',_0x39ab49=_0x2356e2[_0x4f3a56]!==undefined?_0x2356e2[_0x4f3a56][_0x5973b5(0x169)](0x2):'';_0x165ca2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x39c42f+_0x5973b5(0x1f3),_0x165ca2+=_0x5973b5(0x24d)+_0x14a4ec+_0x5973b5(0x1f3),_0x165ca2+=_0x5973b5(0x24d)+_0x39ab49+_0x5973b5(0x1f3);}var _0x5ecc6c=formatNumber(parseFloat(_0x5ed76d[_0x5973b5(0x23c)])),_0x268953=formatNumber(parseFloat(_0x5ed76d[_0x5973b5(0x230)]));isNaN(_0x268953)&&(_0x268953=0x0),_0x165ca2+=_0x5973b5(0x24d)+_0x5ecc6c+_0x5973b5(0x1f3),_0x165ca2+=_0x5973b5(0x24d)+_0x268953+_0x5973b5(0x1f3),_0x165ca2+=_0x5973b5(0x189)+_0x5ed76d[_0x5973b5(0x145)]+_0x5973b5(0x1f3),_0x165ca2+=_0x5973b5(0x189)+_0x5ed76d[_0x5973b5(0x1bb)]+_0x5973b5(0x1f3),_0x165ca2+=_0x5973b5(0x189)+_0x5ed76d[_0x5973b5(0x21e)]+_0x5973b5(0x1f3),_0x18986f=_0x5ed76d[_0x5973b5(0x235)]+_0x5ed76d[_0x5973b5(0x1fd)],_0x210b13+=parseFloat(_0x5ed76d[_0x5973b5(0x23c)]),_0x4c4384+=parseFloat(_0x268953),_0x4626f0['push'](_0x165ca2);}if(_0x27127b[_0x5973b5(0x134)]>0x0)for(let _0x112643=0x0;_0x112643<=_0x27127b['length']-0x1;_0x112643++){const _0x37a9fb=_0x27127b[_0x112643];console['log'](_0x37a9fb);let _0x4d497c='<tr>';_0x4d497c+=_0x5973b5(0x203)+(0x8+0x7*0x3)+_0x5973b5(0x11d)+_0x37a9fb[_0x5973b5(0x20e)]+_0x5973b5(0x191),_0x4d497c+=_0x5973b5(0x1a1),_0x4626f0[_0x5973b5(0x1b9)](_0x4d497c);}function _0x1bd029(_0x171a91,_0x270444){const _0x4436df=_0x5973b5,_0x52f245=[];for(let _0x5863a4=0x0;_0x5863a4<=_0x171a91[_0x4436df(0x134)]-0x1;_0x5863a4+=_0x270444){_0x52f245[_0x4436df(0x1b9)](_0x171a91[_0x4436df(0x13f)](_0x5863a4,_0x5863a4+_0x270444));}return _0x52f245;}const _0x329cfc=_0x1bd029(_0x4626f0,_0x2e2a1b);let _0x3a02c2='';return _0x329cfc['forEach']((_0x18aef4,_0x5459e3)=>{const _0x4c98c4=_0x5973b5;_0x5459e3>0x0&&(_0x3a02c2+=_0x4c98c4(0x1dc));_0x3a02c2+='<table>',_0x3a02c2+=_0x4c98c4(0x1e1);const _0xd04e4f=new Date(_0x125879),_0x325501={'year':_0x4c98c4(0x159),'month':_0x4c98c4(0x140),'day':_0x4c98c4(0x159),'timeZone':_0x4c98c4(0x1d2)},_0x80c09e=_0xd04e4f['toLocaleDateString'](_0x4c98c4(0x269),_0x325501);_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+=_0x4c98c4(0x1b5)+_0x51d027+_0x4c98c4(0x191),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+='<tr>',_0x3a02c2+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0xf6ed['name']+'</td>',_0x3a02c2+=_0x4c98c4(0x139),_0x3a02c2+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x3a02c2+=_0x4c98c4(0x23d),_0x3a02c2+=_0x4c98c4(0x15d),_0x3a02c2+=_0x4c98c4(0x261),_0x3a02c2+=_0x4c98c4(0x21c),_0x3a02c2+=_0x4c98c4(0x126),_0x3a02c2+=_0x4c98c4(0x19f),_0x3a02c2+='</tr>',_0x3a02c2+='<tr>',_0x3a02c2+=_0x4c98c4(0x119),_0x3a02c2+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20'+_0x80c09e+_0x4c98c4(0x1f3),_0x3a02c2+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>',_0x3a02c2+=_0x4c98c4(0x1c0),_0x3a02c2+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x3a02c2+=_0x4c98c4(0x15e),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+=_0x4c98c4(0x24b),_0x3a02c2+=_0x4c98c4(0x229),_0x3a02c2+=_0x4c98c4(0x1be),_0x3a02c2+=_0x4c98c4(0x15e),_0x3a02c2+=_0x4c98c4(0x15e),_0x3a02c2+='</tr>',_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+=_0x4c98c4(0x117),_0x3a02c2+='</tr>',_0x3a02c2+='<tr>',_0x3a02c2+=_0x4c98c4(0x1a7),_0x3a02c2+=_0x4c98c4(0x1dd),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>',_0x3a02c2+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x3a02c2+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x2ac377=0x0;_0x2ac377<=_0x18f64d[_0x4c98c4(0x134)]-0x1;_0x2ac377++){const _0x3fe47c=_0x18f64d[_0x2ac377];for(let _0x5640fa=0x0;_0x5640fa<_0x534fd2['cat_brand'][_0x4c98c4(0x134)];_0x5640fa++){const _0x361a25=_0x534fd2[_0x4c98c4(0x132)][_0x5640fa];if(_0x361a25['_id'][_0x4c98c4(0x1b8)]===_0x3fe47c[_0x4c98c4(0x10e)][_0x4c98c4(0x1b8)]){var _0x569fb1='';switch(_0x3fe47c[_0x4c98c4(0x10e)][_0x4c98c4(0x1b8)]){case _0x4c98c4(0x280):_0x569fb1=_0x361a25[_0x4c98c4(0x10e)]['brand']+_0x4c98c4(0x1e2);break;case _0x4c98c4(0x12f):_0x569fb1=_0x361a25['_id']['brand']+_0x4c98c4(0x276);break;default:_0x569fb1=_0x361a25[_0x4c98c4(0x10e)][_0x4c98c4(0x182)];break;}_0x3a02c2+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>'+_0x569fb1+_0x4c98c4(0x191);}}}_0x3a02c2+=_0x4c98c4(0x180),_0x3a02c2+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>',_0x3a02c2+='<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>',_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+=_0x4c98c4(0x1fb);for(let _0x25e64f=0x0;_0x25e64f<=_0x534fd2[_0x4c98c4(0x132)][_0x4c98c4(0x134)]-0x1;_0x25e64f++){const _0x285ca8=_0x534fd2[_0x25e64f];_0x3a02c2+=_0x4c98c4(0x283),_0x3a02c2+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x3a02c2+=_0x4c98c4(0x1c9);}_0x3a02c2+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>',_0x3a02c2+=_0x4c98c4(0x26b),_0x3a02c2+=_0x4c98c4(0x11a),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+=_0x4c98c4(0x24c),_0x3a02c2+=_0x4c98c4(0xfe),_0x18aef4[_0x4c98c4(0x257)](_0x20b124=>{_0x3a02c2+=_0x20b124;});let _0x18aff0={},_0x45cff8={},_0xd07b46={};for(let _0x2a7420=0x0;_0x2a7420<=_0x3d720f[_0x4c98c4(0x134)]-0x1;_0x2a7420++){const _0x1f1787=_0x3d720f[_0x2a7420];var _0x3a2875=0x0;for(let _0xe6996a=0x0;_0xe6996a<=_0x1f1787[_0x4c98c4(0x12b)][_0x4c98c4(0x134)]-0x1;_0xe6996a++){const _0x542761=_0x1f1787[_0x4c98c4(0x12b)][_0xe6996a],_0x45c036=_0x542761[_0x4c98c4(0x182)]+'-'+_0x542761[_0x4c98c4(0x1b8)];if(_0x542761[_0x4c98c4(0x12c)][_0x4c98c4(0x243)]=='P')_0x542761[_0x4c98c4(0x12c)][_0x4c98c4(0x27c)]==_0x4c98c4(0x231)?(!_0xd07b46[_0x45c036]&&(_0xd07b46[_0x45c036]=0x0),_0xd07b46[_0x45c036]+=_0x542761[_0x4c98c4(0x26a)]):(!_0x18aff0[_0x45c036]&&(_0x18aff0[_0x45c036]=0x0),_0x18aff0[_0x45c036]+=_0x542761[_0x4c98c4(0x26a)]);else _0x542761[_0x4c98c4(0x12c)][_0x4c98c4(0x243)]=='S'&&(_0x542761[_0x4c98c4(0x12c)][_0x4c98c4(0x27c)]=='true'?(!_0xd07b46[_0x45c036]&&(_0xd07b46[_0x45c036]=0x0),_0xd07b46[_0x45c036]+=_0x542761[_0x4c98c4(0x26a)],console[_0x4c98c4(0x141)](_0x542761[_0x4c98c4(0x26a)])):(!_0x45cff8[_0x45c036]&&(_0x45cff8[_0x45c036]=0x0),_0x45cff8[_0x45c036]+=_0x542761[_0x4c98c4(0x26a)]));_0x3a2875++;}}let _0x1a7716={},_0xc8b37c={},_0x1a60a7={};var _0x5a9652=0x0,_0x49d005=0x0;for(let _0x5afc6c=0x0;_0x5afc6c<=_0x5a84dc[_0x4c98c4(0x134)]-0x1;_0x5afc6c++){const _0x1d357b=_0x5a84dc[_0x5afc6c];var _0x3a2875=0x0;for(let _0x5c3641=0x0;_0x5c3641<=_0x1d357b['products'][_0x4c98c4(0x134)]-0x1;_0x5c3641++){const _0x380f82=_0x1d357b[_0x4c98c4(0x12b)][_0x5c3641],_0x41cb9e=_0x380f82[_0x4c98c4(0x182)]+'-'+_0x380f82[_0x4c98c4(0x1b8)];if(_0x380f82[_0x4c98c4(0x12c)][_0x4c98c4(0x243)]=='P')_0x380f82[_0x4c98c4(0x12c)][_0x4c98c4(0x27c)]==_0x4c98c4(0x231)?(!_0x1a60a7[_0x41cb9e]&&(_0x1a60a7[_0x41cb9e]=0x0),_0x1a60a7[_0x41cb9e]+=_0x380f82['qty']):(!_0x1a7716[_0x41cb9e]&&(_0x1a7716[_0x41cb9e]=0x0),_0x1a7716[_0x41cb9e]+=_0x380f82[_0x4c98c4(0x26a)]);else _0x380f82[_0x4c98c4(0x12c)][_0x4c98c4(0x243)]=='S'&&(_0x380f82[_0x4c98c4(0x12c)][_0x4c98c4(0x27c)]==_0x4c98c4(0x231)?(!_0x1a60a7[_0x41cb9e]&&(_0x1a60a7[_0x41cb9e]=0x0),_0x1a60a7[_0x41cb9e]+=_0x380f82[_0x4c98c4(0x26a)]):(!_0xc8b37c[_0x41cb9e]&&(_0xc8b37c[_0x41cb9e]=0x0),_0xc8b37c[_0x41cb9e]+=_0x380f82[_0x4c98c4(0x26a)]));_0x3a2875++;}var _0x231b0f=parseFloat(_0x1d357b[_0x4c98c4(0x23c)]),_0xb0095=parseFloat(_0x1d357b['amount']);isNaN(_0xb0095)&&(_0xb0095=0x0),_0x5a9652+=_0x231b0f,_0x49d005+=_0xb0095;}_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+=_0x4c98c4(0x13c),_0x3a02c2+=_0x4c98c4(0x15c),_0x3a02c2+=_0x4c98c4(0x19c);for(let _0x10d464=0x0;_0x10d464<=_0x534fd2[_0x4c98c4(0x132)][_0x4c98c4(0x134)]-0x1;_0x10d464++){const _0x4a395b=_0x534fd2[_0x4c98c4(0x132)][_0x10d464],_0x976ee=_0x4a395b[_0x4c98c4(0x10e)]['brand']+'-'+_0x4a395b[_0x4c98c4(0x10e)][_0x4c98c4(0x1b8)];var _0x38758a=_0x18aff0[_0x976ee]!==undefined?formatNumber(_0x18aff0[_0x976ee][_0x4c98c4(0x169)](0x2)):'',_0x7aa33b=_0xd07b46[_0x976ee]!==undefined?formatNumber(_0xd07b46[_0x976ee][_0x4c98c4(0x169)](0x2)):'',_0x34d60c=_0x45cff8[_0x976ee]!==undefined?formatNumber(_0x45cff8[_0x976ee]['toFixed'](0x2)):'';_0x3a02c2+=_0x4c98c4(0x1a0)+_0x38758a+_0x4c98c4(0x191),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x34d60c+_0x4c98c4(0x191),_0x3a02c2+=_0x4c98c4(0x1a0)+_0x7aa33b+_0x4c98c4(0x191);}_0x3a02c2+=_0x4c98c4(0x1a0)+formatNumber(_0x210b13)+_0x4c98c4(0x191),_0x3a02c2+=_0x4c98c4(0x1a0)+formatNumber(_0x4c4384)+_0x4c98c4(0x191),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+=_0x4c98c4(0x13c),_0x3a02c2+=_0x4c98c4(0x216),_0x3a02c2+=_0x4c98c4(0x19c);for(let _0x1e1176=0x0;_0x1e1176<=_0x534fd2[_0x4c98c4(0x132)][_0x4c98c4(0x134)]-0x1;_0x1e1176++){const _0x123a3e=_0x534fd2[_0x4c98c4(0x132)][_0x1e1176],_0x3d4a57=_0x123a3e['_id'][_0x4c98c4(0x182)]+'-'+_0x123a3e[_0x4c98c4(0x10e)]['category'];var _0x38758a=_0x1a7716[_0x3d4a57]!==undefined?formatNumber(_0x1a7716[_0x3d4a57]['toFixed'](0x2)):'',_0x7aa33b=_0x1a60a7[_0x3d4a57]!==undefined?formatNumber(_0x1a60a7[_0x3d4a57]['toFixed'](0x2)):'',_0x34d60c=_0xc8b37c[_0x3d4a57]!==undefined?formatNumber(_0xc8b37c[_0x3d4a57][_0x4c98c4(0x169)](0x2)):'';_0x3a02c2+=_0x4c98c4(0x1a0)+_0x38758a+_0x4c98c4(0x191),_0x3a02c2+=_0x4c98c4(0x1a0)+_0x34d60c+'</b></td>',_0x3a02c2+=_0x4c98c4(0x1a0)+_0x7aa33b+'</b></td>';}_0x3a02c2+=_0x4c98c4(0x1a0)+formatNumber(_0x5a9652)+'</b></td>',_0x3a02c2+=_0x4c98c4(0x1a0)+formatNumber(_0x49d005)+'</b></td>',_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+='<tr>',_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x3a02c2+=_0x4c98c4(0x25d),_0x3a02c2+=_0x4c98c4(0x19c);let _0x4076d3=0x0,_0x30d6d9=0x0,_0x39c03a=0x0;for(let _0x4604f6=0x0;_0x4604f6<=_0x534fd2[_0x4c98c4(0x132)]['length']-0x1;_0x4604f6++){const _0xc7e56d=_0x534fd2[_0x4c98c4(0x132)][_0x4604f6],_0x44819c=_0xc7e56d[_0x4c98c4(0x10e)][_0x4c98c4(0x182)]+'-'+_0xc7e56d[_0x4c98c4(0x10e)][_0x4c98c4(0x1b8)];var _0x3b2cfd=_0x18aff0[_0x44819c]!==undefined?_0x18aff0[_0x44819c][_0x4c98c4(0x169)](0x2):'0',_0x1f5cf0=_0xd07b46[_0x44819c]!==undefined?_0xd07b46[_0x44819c][_0x4c98c4(0x169)](0x2):'0',_0x2a37fa=_0x45cff8[_0x44819c]!==undefined?_0x45cff8[_0x44819c]['toFixed'](0x2):'0',_0x354d0a=_0x1a7716[_0x44819c]!==undefined?_0x1a7716[_0x44819c]['toFixed'](0x2):'0',_0x521e28=_0x1a60a7[_0x44819c]!==undefined?_0x1a60a7[_0x44819c]['toFixed'](0x2):'0',_0x2cc515=_0xc8b37c[_0x44819c]!==undefined?_0xc8b37c[_0x44819c][_0x4c98c4(0x169)](0x2):'0';_0x4076d3=parseFloat(_0x3b2cfd)+parseFloat(_0x354d0a),_0x30d6d9=parseFloat(_0x2a37fa)+parseFloat(_0x2cc515),_0x39c03a=parseFloat(_0x1f5cf0)+parseFloat(_0x521e28),_0x3a02c2+=_0x4c98c4(0x1a0)+formatNumber(_0x4076d3[_0x4c98c4(0x169)](0x2))+_0x4c98c4(0x191),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x30d6d9[_0x4c98c4(0x169)](0x2))+_0x4c98c4(0x191),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x39c03a[_0x4c98c4(0x169)](0x2))+_0x4c98c4(0x191);}var _0x20f242=formatNumber(_0x210b13+_0x5a9652),_0x39f874=formatNumber(_0x4c4384+_0x49d005);_0x3a02c2+=_0x4c98c4(0x1a0)+_0x20f242+_0x4c98c4(0x191),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x39f874+'</b></td>',_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x534fd2[_0x4c98c4(0x132)][_0x4c98c4(0x134)]*0x3+0x9)+_0x4c98c4(0x256),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+='<tr>',_0x3a02c2+=_0x4c98c4(0x13c),_0x3a02c2+=_0x4c98c4(0x187),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x2e7219=0x0;_0x2e7219<=_0x534fd2[_0x4c98c4(0x132)][_0x4c98c4(0x134)]-0x1;_0x2e7219++){const _0x369b5e=_0x534fd2[_0x4c98c4(0x132)][_0x2e7219],_0x4eeab6=_0x369b5e[_0x4c98c4(0x10e)][_0x4c98c4(0x182)]+'-'+_0x369b5e[_0x4c98c4(0x10e)]['category'];var _0x3b2cfd=_0x18aff0[_0x4eeab6]!==undefined?_0x18aff0[_0x4eeab6][_0x4c98c4(0x169)](0x2):'0',_0x1f5cf0=_0xd07b46[_0x4eeab6]!==undefined?_0xd07b46[_0x4eeab6]['toFixed'](0x2):'0',_0x2a37fa=_0x45cff8[_0x4eeab6]!==undefined?_0x45cff8[_0x4eeab6][_0x4c98c4(0x169)](0x2):'0',_0x354d0a=_0x1a7716[_0x4eeab6]!==undefined?_0x1a7716[_0x4eeab6]['toFixed'](0x2):'0',_0x521e28=_0x1a60a7[_0x4eeab6]!==undefined?_0x1a60a7[_0x4eeab6]['toFixed'](0x2):'0',_0x2cc515=_0xc8b37c[_0x4eeab6]!==undefined?_0xc8b37c[_0x4eeab6][_0x4c98c4(0x169)](0x2):'0';_0x4076d3=parseFloat(_0x3b2cfd)+parseFloat(_0x354d0a),_0x30d6d9=parseFloat(_0x2a37fa)+parseFloat(_0x2cc515),_0x39c03a=parseFloat(_0x1f5cf0)+parseFloat(_0x521e28),_0x3a02c2+=_0x4c98c4(0x1cc),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+='<tr>',_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>',_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x2c6ef9=0x0;_0x2c6ef9<=_0x534fd2[_0x4c98c4(0x132)][_0x4c98c4(0x134)]-0x1;_0x2c6ef9++){const _0xe2ff58=_0x534fd2[_0x4c98c4(0x132)][_0x2c6ef9],_0x5c9a47=_0xe2ff58[_0x4c98c4(0x10e)][_0x4c98c4(0x182)]+'-'+_0xe2ff58[_0x4c98c4(0x10e)][_0x4c98c4(0x1b8)];var _0x3b2cfd=_0x18aff0[_0x5c9a47]!==undefined?_0x18aff0[_0x5c9a47][_0x4c98c4(0x169)](0x2):'0',_0x1f5cf0=_0xd07b46[_0x5c9a47]!==undefined?_0xd07b46[_0x5c9a47][_0x4c98c4(0x169)](0x2):'0',_0x2a37fa=_0x45cff8[_0x5c9a47]!==undefined?_0x45cff8[_0x5c9a47][_0x4c98c4(0x169)](0x2):'0',_0x354d0a=_0x1a7716[_0x5c9a47]!==undefined?_0x1a7716[_0x5c9a47][_0x4c98c4(0x169)](0x2):'0',_0x521e28=_0x1a60a7[_0x5c9a47]!==undefined?_0x1a60a7[_0x5c9a47][_0x4c98c4(0x169)](0x2):'0',_0x2cc515=_0xc8b37c[_0x5c9a47]!==undefined?_0xc8b37c[_0x5c9a47][_0x4c98c4(0x169)](0x2):'0';_0x4076d3=parseFloat(_0x3b2cfd)+parseFloat(_0x354d0a),_0x30d6d9=parseFloat(_0x2a37fa)+parseFloat(_0x2cc515),_0x39c03a=parseFloat(_0x1f5cf0)+parseFloat(_0x521e28),_0x3a02c2+=_0x4c98c4(0x1cc),_0x3a02c2+=_0x4c98c4(0x1cc),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+='</tr>',_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x3a02c2+=_0x4c98c4(0x284),_0x3a02c2+=_0x4c98c4(0x19c);for(let _0x28f949=0x0;_0x28f949<=_0x534fd2[_0x4c98c4(0x132)][_0x4c98c4(0x134)]-0x1;_0x28f949++){const _0x5ea9ac=_0x534fd2[_0x4c98c4(0x132)][_0x28f949],_0x139ace=_0x5ea9ac['_id'][_0x4c98c4(0x182)]+'-'+_0x5ea9ac[_0x4c98c4(0x10e)][_0x4c98c4(0x1b8)];var _0x3b2cfd=_0x18aff0[_0x139ace]!==undefined?_0x18aff0[_0x139ace]['toFixed'](0x2):'0',_0x1f5cf0=_0xd07b46[_0x139ace]!==undefined?_0xd07b46[_0x139ace][_0x4c98c4(0x169)](0x2):'0',_0x2a37fa=_0x45cff8[_0x139ace]!==undefined?_0x45cff8[_0x139ace][_0x4c98c4(0x169)](0x2):'0',_0x354d0a=_0x1a7716[_0x139ace]!==undefined?_0x1a7716[_0x139ace][_0x4c98c4(0x169)](0x2):'0',_0x521e28=_0x1a60a7[_0x139ace]!==undefined?_0x1a60a7[_0x139ace][_0x4c98c4(0x169)](0x2):'0',_0x2cc515=_0xc8b37c[_0x139ace]!==undefined?_0xc8b37c[_0x139ace][_0x4c98c4(0x169)](0x2):'0';_0x4076d3=parseFloat(_0x3b2cfd)+parseFloat(_0x354d0a),_0x30d6d9=parseFloat(_0x2a37fa)+parseFloat(_0x2cc515),_0x39c03a=parseFloat(_0x1f5cf0)+parseFloat(_0x521e28),_0x3a02c2+=_0x4c98c4(0x1cc),_0x3a02c2+=_0x4c98c4(0x1cc),_0x3a02c2+=_0x4c98c4(0x1cc);}_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+=_0x4c98c4(0x13c),_0x3a02c2+=_0x4c98c4(0x15c),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x279623=0x0;_0x279623<=_0x534fd2['cat_brand'][_0x4c98c4(0x134)]-0x1;_0x279623++){const _0x5b948b=_0x534fd2['cat_brand'][_0x279623],_0x20b914=_0x5b948b[_0x4c98c4(0x10e)][_0x4c98c4(0x182)]+'-'+_0x5b948b[_0x4c98c4(0x10e)][_0x4c98c4(0x1b8)];var _0x3b2cfd=_0x18aff0[_0x20b914]!==undefined?_0x18aff0[_0x20b914][_0x4c98c4(0x169)](0x2):'',_0x1f5cf0=_0xd07b46[_0x20b914]!==undefined?_0xd07b46[_0x20b914]['toFixed'](0x2):'',_0x2a37fa=_0x45cff8[_0x20b914]!==undefined?_0x45cff8[_0x20b914]['toFixed'](0x2):'',_0x354d0a=_0x1a7716[_0x20b914]!==undefined?_0x1a7716[_0x20b914]['toFixed'](0x2):'',_0x521e28=_0x1a60a7[_0x20b914]!==undefined?_0x1a60a7[_0x20b914][_0x4c98c4(0x169)](0x2):'',_0x2cc515=_0xc8b37c[_0x20b914]!==undefined?_0xc8b37c[_0x20b914][_0x4c98c4(0x169)](0x2):'';_0x4076d3=formatNumber(parseFloat(_0x3b2cfd)+parseFloat(_0x354d0a)),_0x30d6d9=formatNumber(parseFloat(_0x2a37fa)+parseFloat(_0x2cc515)),_0x39c03a=formatNumber(parseFloat(_0x1f5cf0)+parseFloat(_0x521e28)),_0x3a02c2+=_0x4c98c4(0x1a0)+_0x3b2cfd+_0x4c98c4(0x191),_0x3a02c2+=_0x4c98c4(0x1a0)+_0x2a37fa+'</b></td>',_0x3a02c2+=_0x4c98c4(0x1a0)+_0x1f5cf0+_0x4c98c4(0x191);}_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+=_0x4c98c4(0x13e),_0x3a02c2+=_0x4c98c4(0x13c),_0x3a02c2+=_0x4c98c4(0x20b),_0x3a02c2+=_0x4c98c4(0x19c);for(let _0x1a89d3=0x0;_0x1a89d3<=_0x534fd2[_0x4c98c4(0x132)]['length']-0x1;_0x1a89d3++){const _0x1dab50=_0x534fd2[_0x4c98c4(0x132)][_0x1a89d3],_0x3ec84d=_0x1dab50[_0x4c98c4(0x10e)][_0x4c98c4(0x182)]+'-'+_0x1dab50[_0x4c98c4(0x10e)][_0x4c98c4(0x1b8)];var _0x3b2cfd=_0x18aff0[_0x3ec84d]!==undefined?_0x18aff0[_0x3ec84d]['toFixed'](0x2):'0',_0x1f5cf0=_0xd07b46[_0x3ec84d]!==undefined?_0xd07b46[_0x3ec84d]['toFixed'](0x2):'0',_0x2a37fa=_0x45cff8[_0x3ec84d]!==undefined?_0x45cff8[_0x3ec84d][_0x4c98c4(0x169)](0x2):'0',_0x354d0a=_0x1a7716[_0x3ec84d]!==undefined?_0x1a7716[_0x3ec84d][_0x4c98c4(0x169)](0x2):'0',_0x521e28=_0x1a60a7[_0x3ec84d]!==undefined?_0x1a60a7[_0x3ec84d][_0x4c98c4(0x169)](0x2):'0',_0x2cc515=_0xc8b37c[_0x3ec84d]!==undefined?_0xc8b37c[_0x3ec84d][_0x4c98c4(0x169)](0x2):'0';_0x4076d3=parseFloat(_0x3b2cfd)+parseFloat(_0x354d0a),_0x30d6d9=parseFloat(_0x2a37fa)+parseFloat(_0x2cc515),_0x39c03a=parseFloat(_0x1f5cf0)+parseFloat(_0x521e28),_0x3a02c2+=_0x4c98c4(0x1cc),_0x3a02c2+=_0x4c98c4(0x1cc),_0x3a02c2+=_0x4c98c4(0x1cc);}_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3a02c2+=_0x4c98c4(0x19c),_0x3a02c2+=_0x4c98c4(0x1a1),_0x3a02c2+='</tbody>',_0x3a02c2+='</table>';}),_0x3a02c2;}async function generateReferenceNumber(_0x53ce96,_0x4ef98d,_0x569204){const _0x37cc74=a0_0x4f1c0b,_0x53f908=new Date(_0x53ce96)['getFullYear'](),_0x492502=('0'+(new Date(_0x53ce96)[_0x37cc74(0x101)]()+0x1))[_0x37cc74(0x13f)](-0x2),_0x23f48c=('0'+new Date(_0x53ce96)[_0x37cc74(0x129)]())[_0x37cc74(0x13f)](-0x2),_0x2e04e3=await staff[_0x37cc74(0x1a8)]({'email':_0x569204[_0x37cc74(0x1a3)]}),_0x3b64e1=_0x2e04e3[_0x37cc74(0x10f)],_0x3870a1=_0x3b64e1+'-'+_0x53f908+_0x492502+_0x23f48c,_0x3abf58=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x3870a1),'salesman_code':_0x3b64e1})['sort']({'createdAt':-0x1}),_0x105064=_0x3870a1;_0x3abf58&&(_0x105064=_0x3abf58['referenceNumber']);console[_0x37cc74(0x141)](_0x105064);const _0x2547af=new Reference({'referenceNumber':_0x105064,'staff_id':_0x4ef98d,'salesman_code':_0x3b64e1});return await _0x2547af[_0x37cc74(0x211)](),_0x105064;}router[a0_0x4f1c0b(0x23a)](a0_0x4f1c0b(0x1ec),auth,async(_0x8832bc,_0x12970f)=>{const _0x37756e=a0_0x4f1c0b,{from_date:_0x3d3584,dataview:_0x5a9b6a}=_0x8832bc['body'],_0x509d6a=_0x8832bc[_0x37756e(0x27d)],_0x38e85f=await staff[_0x37756e(0x1a8)]({'email':_0x509d6a['email']}),_0xeaf49=await master_shop[_0x37756e(0x244)](),_0xa1c37a='';var _0x45e254=new Date(_0x3d3584);const _0x5aa8a7={'year':_0x37756e(0x159),'month':'long','day':_0x37756e(0x159)},_0x4425fb=new Intl[(_0x37756e(0x21f))]('en-US',_0x5aa8a7)[_0x37756e(0x221)](_0x45e254),_0x321b23=await Reference['find']({'staff_id':_0x38e85f[_0x37756e(0x10e)][_0x37756e(0x163)](),'date_include':_0x3d3584});if(_0x321b23[_0x37756e(0x134)]>0x0){let _0x28ce52='';_0x28ce52+=_0x321b23[0x0]['html'];if(_0x5a9b6a==_0x37756e(0x264)){const _0x362e6a=cheerio[_0x37756e(0x1f0)](_0x28ce52);let _0x2fa646=[],_0x5271dc=[],_0x5ed5b1=[];const _0x34b1d5=_0x482ac1=>{const _0xaf7c9b=_0x37756e,_0x153cf8={'top':{'style':_0xaf7c9b(0x1de),'color':{'rgb':_0xaf7c9b(0x185)}},'bottom':{'style':_0xaf7c9b(0x1de),'color':{'rgb':'000000'}},'left':{'style':_0xaf7c9b(0x1de),'color':{'rgb':_0xaf7c9b(0x185)}},'right':{'style':_0xaf7c9b(0x1de),'color':{'rgb':_0xaf7c9b(0x185)}}};if(_0x482ac1){const _0x747361=_0x482ac1[_0xaf7c9b(0x26d)](';')[_0xaf7c9b(0x16a)]((_0x4ac9f9,_0x345288)=>{const _0x34e660=_0xaf7c9b,[_0x4bf963,_0x237835]=_0x345288[_0x34e660(0x26d)](':')[_0x34e660(0x277)](_0xe37edf=>_0xe37edf[_0x34e660(0x10c)]());return _0x4ac9f9[_0x4bf963]=_0x237835,_0x4ac9f9;},{});_0x747361[_0xaf7c9b(0x154)]&&(_0x153cf8[_0xaf7c9b(0x138)]['style']=_0x747361[_0xaf7c9b(0x154)][_0xaf7c9b(0x1a4)](_0xaf7c9b(0x1f7))?_0xaf7c9b(0x1f7):_0xaf7c9b(0x27a)),_0x747361[_0xaf7c9b(0x106)]&&(_0x153cf8[_0xaf7c9b(0x270)][_0xaf7c9b(0x116)]=_0x747361['border-bottom'][_0xaf7c9b(0x1a4)](_0xaf7c9b(0x1f7))?_0xaf7c9b(0x1f7):_0xaf7c9b(0x27a)),_0x747361['border-left']&&(_0x153cf8[_0xaf7c9b(0x23b)][_0xaf7c9b(0x116)]=_0x747361[_0xaf7c9b(0x249)]['includes'](_0xaf7c9b(0x1f7))?_0xaf7c9b(0x1f7):_0xaf7c9b(0x27a)),_0x747361[_0xaf7c9b(0x195)]&&(_0x153cf8['right'][_0xaf7c9b(0x116)]=_0x747361['border-right']['includes'](_0xaf7c9b(0x1f7))?_0xaf7c9b(0x1f7):'medium');}return _0x153cf8;};_0x362e6a(_0x37756e(0x1aa))['each']((_0x20fbc1,_0x302afe)=>{const _0x5927d9=_0x37756e;let _0x48b2d7=[],_0x2987ad=0x0;while(_0x5ed5b1[_0x2987ad]){_0x5ed5b1[_0x2987ad]--,_0x2987ad++;}_0x362e6a(_0x302afe)[_0x5927d9(0x244)]('td,\x20th')['each']((_0x23726f,_0x25a746)=>{const _0x3c7bce=_0x5927d9;let _0x4ff2e9=_0x362e6a(_0x25a746)[_0x3c7bce(0x10a)]()['trim'](),_0x3d1998=parseFloat(_0x4ff2e9['replace'](/,/g,''));isNaN(_0x3d1998)&&(_0x3d1998=_0x4ff2e9);let _0x15390e=parseInt(_0x362e6a(_0x25a746)['attr'](_0x3c7bce(0x23f)))||0x1,_0x3df24b=parseInt(_0x362e6a(_0x25a746)['attr']('rowspan'))||0x1;const _0x4385af=_0x362e6a(_0x25a746)[_0x3c7bce(0xfd)]('style'),_0x5cb122=_0x34b1d5(_0x4385af);_0x48b2d7[_0x2987ad]={'v':_0x3d1998,'s':{'border':_0x5cb122}};(_0x15390e>0x1||_0x3df24b>0x1)&&_0x5271dc[_0x3c7bce(0x1b9)]({'s':{'r':_0x20fbc1,'c':_0x2987ad},'e':{'r':_0x20fbc1+_0x3df24b-0x1,'c':_0x2987ad+_0x15390e-0x1}});for(let _0x17e2d8=0x0;_0x17e2d8<_0x15390e;_0x17e2d8++){_0x3df24b>0x1&&(_0x5ed5b1[_0x2987ad+_0x17e2d8]=_0x3df24b-0x1);}_0x2987ad+=_0x15390e;}),_0x2fa646[_0x5927d9(0x1b9)](_0x48b2d7);});const _0x2c3bb8=XLSX[_0x37756e(0x197)]['book_new'](),_0x578401=XLSX['utils'][_0x37756e(0x259)](_0x2fa646);_0x5271dc[_0x37756e(0x134)]>0x0&&(_0x578401[_0x37756e(0x1ef)]=_0x5271dc);_0x578401[_0x37756e(0x171)]=_0x2fa646[0x0][_0x37756e(0x277)](()=>({'wpx':0x64})),XLSX[_0x37756e(0x197)][_0x37756e(0x237)](_0x2c3bb8,_0x578401,'Sales\x20Report');const _0x387636=XLSX[_0x37756e(0x22a)](_0x2c3bb8,{'bookType':_0x37756e(0x1ed),'type':'buffer'});_0x12970f[_0x37756e(0x170)](_0x37756e(0x188),_0x37756e(0x173)),_0x12970f['setHeader']('Content-Type',_0x37756e(0x1b3)),_0x12970f['send'](_0x387636);}else{let _0x37cf40='';_0x37cf40+=_0x28ce52,_0x37cf40+=_0x37756e(0x210),_0x37cf40+='window.onload\x20=\x20function()\x20{',_0x37cf40+='window.print();',_0x37cf40+='};',_0x37cf40+='</script>',_0x12970f['send'](_0x37cf40);}}else generateReferenceNumber(_0x3d3584,_0x38e85f[_0x37756e(0x10e)][_0x37756e(0x163)](),_0x509d6a)[_0x37756e(0x11c)](async _0x55d6f7=>{const _0x4f6565=_0x37756e,_0x3d45e1=await agentsdataDSICheck_DSRR(_0x3d3584,_0x38e85f['_id']['valueOf'](),_0xa1c37a,_0x55d6f7);console[_0x4f6565(0x141)](_0x3d45e1);let _0x5daf04=_0x4f6565(0x151);_0x5daf04+=_0x4f6565(0x11f),_0x5daf04+=_0x4f6565(0x1a2),_0x5daf04+='<table>',_0x5daf04+=_0x3d45e1,_0x5daf04+=_0x4f6565(0x166),_0x5daf04+='</div>',_0x5daf04+=_0x4f6565(0x1b6);if(_0x3d45e1[_0x4f6565(0x134)]>0x0){const _0x6cc020=await Reference[_0x4f6565(0x1a8)]({'staff_id':_0x38e85f[_0x4f6565(0x10e)]['valueOf'](),'referenceNumber':_0x55d6f7});_0x6cc020[_0x4f6565(0x22d)]=_0x5daf04,_0x6cc020[_0x4f6565(0x16c)]=_0x3d3584,await _0x6cc020[_0x4f6565(0x211)]();if(_0x5a9b6a==_0x4f6565(0x264)){const _0x423ff4=cheerio['load'](_0x5daf04);let _0x13b7fc=[],_0x5e224c=[],_0x577575=[];const _0x529486=_0x37a886=>{const _0x459ca6=_0x4f6565,_0xb55e97={'top':{'style':_0x459ca6(0x1de),'color':{'rgb':_0x459ca6(0x185)}},'bottom':{'style':_0x459ca6(0x1de),'color':{'rgb':_0x459ca6(0x185)}},'left':{'style':_0x459ca6(0x1de),'color':{'rgb':_0x459ca6(0x185)}},'right':{'style':_0x459ca6(0x1de),'color':{'rgb':'000000'}}};if(_0x37a886){const _0x58b2c2=_0x37a886[_0x459ca6(0x26d)](';')['reduce']((_0x305f80,_0x2a9187)=>{const _0x277a16=_0x459ca6,[_0x353a74,_0x5591ca]=_0x2a9187[_0x277a16(0x26d)](':')[_0x277a16(0x277)](_0x335127=>_0x335127[_0x277a16(0x10c)]());return _0x305f80[_0x353a74]=_0x5591ca,_0x305f80;},{});_0x58b2c2['border-top']&&(_0xb55e97['top'][_0x459ca6(0x116)]=_0x58b2c2[_0x459ca6(0x154)]['includes'](_0x459ca6(0x1f7))?_0x459ca6(0x1f7):'medium'),_0x58b2c2[_0x459ca6(0x106)]&&(_0xb55e97[_0x459ca6(0x270)]['style']=_0x58b2c2[_0x459ca6(0x106)][_0x459ca6(0x1a4)](_0x459ca6(0x1f7))?'thin':_0x459ca6(0x27a)),_0x58b2c2['border-left']&&(_0xb55e97[_0x459ca6(0x23b)]['style']=_0x58b2c2[_0x459ca6(0x249)]['includes']('thin')?_0x459ca6(0x1f7):_0x459ca6(0x27a)),_0x58b2c2['border-right']&&(_0xb55e97['right']['style']=_0x58b2c2['border-right'][_0x459ca6(0x1a4)]('thin')?_0x459ca6(0x1f7):_0x459ca6(0x27a));}return _0xb55e97;};_0x423ff4('table\x20tr')[_0x4f6565(0x143)]((_0xe0072e,_0x545851)=>{const _0xe0b96c=_0x4f6565;let _0x412a91=[],_0xbad94b=0x0;while(_0x577575[_0xbad94b]){_0x577575[_0xbad94b]--,_0xbad94b++;}_0x423ff4(_0x545851)['find'](_0xe0b96c(0x228))[_0xe0b96c(0x143)]((_0x57ed36,_0x71dd76)=>{const _0x545545=_0xe0b96c;let _0x2b4693=_0x423ff4(_0x71dd76)['text']()[_0x545545(0x10c)](),_0x7bfdac=parseFloat(_0x2b4693[_0x545545(0x25b)](/,/g,''));isNaN(_0x7bfdac)&&(_0x7bfdac=_0x2b4693);let _0x29d879=parseInt(_0x423ff4(_0x71dd76)[_0x545545(0xfd)](_0x545545(0x23f)))||0x1,_0x186acb=parseInt(_0x423ff4(_0x71dd76)['attr'](_0x545545(0x251)))||0x1;const _0x56dcef=_0x423ff4(_0x71dd76)['attr'](_0x545545(0x116)),_0x226c35=_0x529486(_0x56dcef);_0x412a91[_0xbad94b]={'v':_0x7bfdac,'s':{'border':_0x226c35}};(_0x29d879>0x1||_0x186acb>0x1)&&_0x5e224c[_0x545545(0x1b9)]({'s':{'r':_0xe0072e,'c':_0xbad94b},'e':{'r':_0xe0072e+_0x186acb-0x1,'c':_0xbad94b+_0x29d879-0x1}});for(let _0x297e32=0x0;_0x297e32<_0x29d879;_0x297e32++){_0x186acb>0x1&&(_0x577575[_0xbad94b+_0x297e32]=_0x186acb-0x1);}_0xbad94b+=_0x29d879;}),_0x13b7fc[_0xe0b96c(0x1b9)](_0x412a91);});const _0x2316d3=XLSX[_0x4f6565(0x197)][_0x4f6565(0x258)](),_0x332cc3=XLSX[_0x4f6565(0x197)][_0x4f6565(0x259)](_0x13b7fc);_0x5e224c[_0x4f6565(0x134)]>0x0&&(_0x332cc3['!merges']=_0x5e224c);_0x332cc3['!cols']=_0x13b7fc[0x0][_0x4f6565(0x277)](()=>({'wpx':0x64})),XLSX[_0x4f6565(0x197)][_0x4f6565(0x237)](_0x2316d3,_0x332cc3,'Sales\x20Report');const _0x6aac2e=XLSX[_0x4f6565(0x22a)](_0x2316d3,{'bookType':'xlsx','type':_0x4f6565(0x1bd)});_0x12970f[_0x4f6565(0x170)](_0x4f6565(0x188),_0x4f6565(0x173)),_0x12970f[_0x4f6565(0x170)](_0x4f6565(0x232),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x12970f[_0x4f6565(0x1d3)](_0x6aac2e);}else _0x5daf04+=_0x4f6565(0x210),_0x5daf04+=_0x4f6565(0x274),_0x5daf04+=_0x4f6565(0x1d7),_0x5daf04+='};',_0x5daf04+=_0x4f6565(0x131),_0x12970f['send'](_0x5daf04);}else await Reference['deleteOne']({'referenceNumber':_0x55d6f7}),_0x8832bc[_0x4f6565(0x16e)]('errors',_0x4f6565(0x1fc)),_0x12970f[_0x4f6565(0x1ae)](_0x4f6565(0x128));})[_0x37756e(0x17b)](console[_0x37756e(0x14d)]);}),router[a0_0x4f1c0b(0x190)]('/dsrr_admin/view',auth,async(_0x1fbf44,_0x24bd41)=>{const _0x3be030=a0_0x4f1c0b;try{const {username:_0x4eaa19,email:_0x2808c1,role:_0x188539}=_0x1fbf44[_0x3be030(0x27d)],_0x5a4da8=_0x1fbf44[_0x3be030(0x27d)],_0x5b949a=await profile[_0x3be030(0x1a8)]({'email':_0x5a4da8['email']}),_0x68fd43={'year':_0x3be030(0x159),'month':'long','day':_0x3be030(0x159)},_0x5997a5=await master_shop['find']();console[_0x3be030(0x141)](_0x3be030(0x282),_0x5997a5);const _0x3f7fd8=await product['find']();console[_0x3be030(0x141)]('Products\x20find_data',_0x3f7fd8);const _0x298d86=await warehouse[_0x3be030(0x225)]([{'$unwind':_0x3be030(0x234)},{'$lookup':{'from':_0x3be030(0x12b),'localField':'product_details.product_name','foreignField':'name','as':_0x3be030(0x207)}},{'$unwind':_0x3be030(0x16b)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x3be030(0x156)}},{'$group':{'_id':_0x3be030(0x213),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x3be030(0x141)](_0x3be030(0x25e),_0x298d86),_0x298d86[_0x3be030(0x257)](_0x45ad0b=>{const _0x535ac3=_0x3be030,_0x2bf030=_0x3f7fd8[_0x535ac3(0x277)](_0x4f2ce0=>{const _0x123318=_0x535ac3;_0x4f2ce0[_0x123318(0x20d)]==_0x45ad0b[_0x123318(0x10e)]&&(_0x4f2ce0[_0x123318(0x1c8)]=parseInt(_0x4f2ce0[_0x123318(0x1c8)])+parseInt(_0x45ad0b[_0x123318(0x21d)]));});});const _0x5590ba=await staff[_0x3be030(0x244)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x3a4344=await staff[_0x3be030(0x1a8)]({'email':_0x5a4da8[_0x3be030(0x1a3)]});if(_0x5997a5[0x0][_0x3be030(0x18f)]==_0x3be030(0x115))var _0x556ead=users[_0x3be030(0x279)];else{if(_0x5997a5[0x0][_0x3be030(0x18f)]==_0x3be030(0x149))var _0x556ead=users[_0x3be030(0x149)];else{if(_0x5997a5[0x0][_0x3be030(0x18f)]==_0x3be030(0x135))var _0x556ead=users[_0x3be030(0x135)];else{if(_0x5997a5[0x0]['language']==_0x3be030(0x17e))var _0x556ead=users[_0x3be030(0x17e)];else{if(_0x5997a5[0x0][_0x3be030(0x18f)]==_0x3be030(0x14c))var _0x556ead=users[_0x3be030(0x14c)];else{if(_0x5997a5[0x0]['language']==_0x3be030(0x1af))var _0x556ead=users[_0x3be030(0x176)];else{if(_0x5997a5[0x0][_0x3be030(0x18f)]=='Chinese')var _0x556ead=users[_0x3be030(0x18b)];else{if(_0x5997a5[0x0]['language']==_0x3be030(0x17c))var _0x556ead=users[_0x3be030(0x1e5)];}}}}}}}_0x24bd41['render'](_0x3be030(0x137),{'success':_0x1fbf44[_0x3be030(0x16e)](_0x3be030(0x142)),'errors':_0x1fbf44[_0x3be030(0x16e)](_0x3be030(0x219)),'alldata':_0x3f7fd8,'profile':_0x5b949a,'master_shop':_0x5997a5,'role':_0x5a4da8,'product_stock':_0x298d86,'language':_0x556ead,'staff_arr':_0x3a4344,'staff_data_all':_0x5590ba});}catch(_0x11d37e){}}),router['post'](a0_0x4f1c0b(0x14b),auth,async(_0x13e30f,_0x2b0f60)=>{const _0x18fae9=a0_0x4f1c0b;try{const {from:_0x5d78d5,to:_0x5be355,staff_data:_0x290fb8}=_0x13e30f[_0x18fae9(0x108)],_0x5e71f4=await Reference[_0x18fae9(0x225)]([{'$match':{'date_include':{'$gte':_0x5d78d5,'$lte':_0x5be355},'staff_id':_0x290fb8}},{'$sort':{'date_include':0x1}}]);_0x2b0f60[_0x18fae9(0x199)](_0x5e71f4);}catch(_0x1d314d){_0x2b0f60['json'](_0x1d314d);}}),router[a0_0x4f1c0b(0x23a)](a0_0x4f1c0b(0x21b),auth,async(_0x57c1a4,_0x2dac58)=>{const _0x28d878=a0_0x4f1c0b;try{const {from:_0x1b328f,to:_0x309697}=_0x57c1a4[_0x28d878(0x108)],{sttaff_id:_0x3ca0ee}=_0x57c1a4[_0x28d878(0x27d)],_0x1f0646=await Reference[_0x28d878(0x225)]([{'$match':{'date_include':{'$gte':_0x1b328f,'$lte':_0x309697},'staff_id':_0x3ca0ee}},{'$sort':{'date_include':0x1}}]);_0x2dac58[_0x28d878(0x199)](_0x1f0646);}catch(_0x561228){_0x2dac58[_0x28d878(0x199)](_0x561228);}}),router[a0_0x4f1c0b(0x190)]('/dsrr_admin/view_data/:id',auth,async(_0x564040,_0x22944f)=>{const _0xd0808d=a0_0x4f1c0b;try{const _0x5221a8=_0x564040[_0xd0808d(0x1f4)]['id'],_0x2e45dd=await Reference['findById'](_0x5221a8);let _0x498cb9='';_0x498cb9+=_0x2e45dd[_0xd0808d(0x22d)],_0x498cb9+=_0xd0808d(0x210),_0x498cb9+='window.onload\x20=\x20function()\x20{',_0x498cb9+=_0xd0808d(0x1d7),_0x498cb9+='};',_0x498cb9+=_0xd0808d(0x131),_0x22944f['send'](_0x498cb9);}catch(_0x31cdbd){_0x22944f['json'](_0x31cdbd);}}),router['post'](a0_0x4f1c0b(0x13b),auth,async(_0x25aa04,_0x24a96f)=>{const _0x19cf0c=a0_0x4f1c0b;try{const {ref_data:_0x3d8d91}=_0x25aa04[_0x19cf0c(0x108)],_0x207c67=_0x3d8d91[_0x19cf0c(0x26d)]('~'),_0x44c19c=_0x207c67[_0x19cf0c(0x25a)](_0x21eeb2=>_0x21eeb2!==''),_0x18eb63=await Reference[_0x19cf0c(0x225)]([{'$match':{'referenceNumber':{'$in':_0x44c19c}}}]),_0x550771=XLSX['utils'][_0x19cf0c(0x258)]();_0x18eb63[_0x19cf0c(0x257)](_0x39e0e2=>{const _0x3a176c=_0x19cf0c,_0x29f419=cheerio[_0x3a176c(0x1f0)](_0x39e0e2[_0x3a176c(0x22d)]);let _0x15679c=[],_0x5a111a=[],_0x340225=[];_0x29f419('table\x20tr')[_0x3a176c(0x143)]((_0x1fa017,_0x1cc500)=>{const _0x5758ef=_0x3a176c;let _0x283cc3=[],_0x3ce6f5=0x0;while(_0x340225[_0x3ce6f5]){_0x340225[_0x3ce6f5]--,_0x3ce6f5++;}_0x29f419(_0x1cc500)[_0x5758ef(0x244)](_0x5758ef(0x228))[_0x5758ef(0x143)]((_0x25449d,_0x22b196)=>{const _0x238b6e=_0x5758ef;let _0x29a8b2=_0x29f419(_0x22b196)[_0x238b6e(0x10a)]()[_0x238b6e(0x10c)](),_0x2e93cb=parseFloat(_0x29a8b2['replace'](/,/g,''));isNaN(_0x2e93cb)&&(_0x2e93cb=_0x29a8b2);let _0xeb7837=parseInt(_0x29f419(_0x22b196)[_0x238b6e(0xfd)](_0x238b6e(0x23f)))||0x1,_0x1fa37d=parseInt(_0x29f419(_0x22b196)['attr'](_0x238b6e(0x251)))||0x1;_0x283cc3[_0x3ce6f5]=_0x2e93cb;(_0xeb7837>0x1||_0x1fa37d>0x1)&&_0x5a111a[_0x238b6e(0x1b9)]({'s':{'r':_0x1fa017,'c':_0x3ce6f5},'e':{'r':_0x1fa017+_0x1fa37d-0x1,'c':_0x3ce6f5+_0xeb7837-0x1}});for(let _0xb20802=0x0;_0xb20802<_0xeb7837;_0xb20802++){_0x1fa37d>0x1&&(_0x340225[_0x3ce6f5+_0xb20802]=_0x1fa37d-0x1);}_0x3ce6f5+=_0xeb7837;}),_0x15679c['push'](_0x283cc3);});const _0x36a8da=XLSX[_0x3a176c(0x197)][_0x3a176c(0x259)](_0x15679c);_0x5a111a['length']>0x0&&(_0x36a8da[_0x3a176c(0x1ef)]=_0x5a111a),_0x36a8da[_0x3a176c(0x171)]=_0x15679c[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x3a176c(0x197)][_0x3a176c(0x237)](_0x550771,_0x36a8da,_0x39e0e2[_0x3a176c(0x1ac)]);});const _0x542c7d=XLSX[_0x19cf0c(0x22a)](_0x550771,{'bookType':'xlsx','type':'buffer'});_0x24a96f[_0x19cf0c(0x170)](_0x19cf0c(0x188),'attachment;\x20filename=\x22reports.xlsx\x22'),_0x24a96f[_0x19cf0c(0x170)](_0x19cf0c(0x232),_0x19cf0c(0x1b3)),_0x24a96f[_0x19cf0c(0x1d3)](_0x542c7d);}catch(_0x341c71){_0x24a96f[_0x19cf0c(0x199)](_0x341c71);}}),router[a0_0x4f1c0b(0x23a)](a0_0x4f1c0b(0x1c4),auth,async(_0x2dd145,_0x4acd32)=>{const _0x2ffba5=a0_0x4f1c0b,{from_date:_0x50180f,agent_id:_0x1a0cbd}=_0x2dd145[_0x2ffba5(0x108)],_0x291bed=_0x2dd145['user'],_0x3bd50d=await staff[_0x2ffba5(0x1a8)]({'email':_0x291bed['email']}),_0x3cb668=await master_shop[_0x2ffba5(0x244)](),_0x578b6a=await agentsdataDSICheck_DSRR(_0x50180f,_0x1a0cbd,_0x4ad3c2);let _0x39dae4=_0x2ffba5(0x15a);var _0x8bb744=new Date(_0x50180f);const _0x4ed5b8={'year':_0x2ffba5(0x159),'month':_0x2ffba5(0x140),'day':_0x2ffba5(0x159)},_0x27d6ef=new Intl[(_0x2ffba5(0x21f))](_0x2ffba5(0x269),_0x4ed5b8)[_0x2ffba5(0x221)](_0x8bb744);_0x39dae4+=_0x2ffba5(0x11f),_0x39dae4+=_0x2ffba5(0x1a2),_0x39dae4+=_0x2ffba5(0x1d4),_0x39dae4+=_0x578b6a,_0x39dae4+=_0x2ffba5(0x166),_0x39dae4+='</div>',_0x39dae4+=_0x2ffba5(0x1b6);let _0x43527a=_0x2ffba5(0x1d5);const _0x1f6f02={'width':_0x2ffba5(0x202),'height':_0x2ffba5(0x1e9),'orientation':'landscape','border':{'top':_0x2ffba5(0x121),'right':_0x2ffba5(0x121),'bottom':_0x2ffba5(0x121),'left':_0x2ffba5(0x121)},'header':{'height':_0x2ffba5(0x1a6),'contents':_0x2ffba5(0x1ff)+_0x43527a+_0x2ffba5(0x10d)+_0x27d6ef+_0x2ffba5(0x103)},'footer':{'height':_0x2ffba5(0x1c2),'contents':{'default':_0x2ffba5(0x1ca)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};var _0x4ad3c2='on';if(_0x4ad3c2=='on'){const _0x3eaf29=cheerio['load'](_0x39dae4);let _0x38fc31=[],_0xe6f8c3=[],_0x446b10=[];_0x3eaf29('table\x20tr')[_0x2ffba5(0x143)]((_0x5bcb3e,_0xcf35f6)=>{const _0x91dd8a=_0x2ffba5;let _0x903432=[],_0x395454=0x0;while(_0x446b10[_0x395454]){_0x446b10[_0x395454]--,_0x395454++;}_0x3eaf29(_0xcf35f6)[_0x91dd8a(0x244)](_0x91dd8a(0x228))['each']((_0x9627e,_0x196349)=>{const _0x9a8a6=_0x91dd8a;let _0x1ee02f=_0x3eaf29(_0x196349)['text']()[_0x9a8a6(0x10c)](),_0x390253=parseFloat(_0x1ee02f[_0x9a8a6(0x25b)](/,/g,''));isNaN(_0x390253)&&(_0x390253=_0x1ee02f);let _0x3638b6=parseInt(_0x3eaf29(_0x196349)[_0x9a8a6(0xfd)](_0x9a8a6(0x23f)))||0x1,_0x101204=parseInt(_0x3eaf29(_0x196349)[_0x9a8a6(0xfd)](_0x9a8a6(0x251)))||0x1;_0x903432[_0x395454]=_0x390253;(_0x3638b6>0x1||_0x101204>0x1)&&_0xe6f8c3[_0x9a8a6(0x1b9)]({'s':{'r':_0x5bcb3e,'c':_0x395454},'e':{'r':_0x5bcb3e+_0x101204-0x1,'c':_0x395454+_0x3638b6-0x1}});for(let _0x39e383=0x0;_0x39e383<_0x3638b6;_0x39e383++){_0x101204>0x1&&(_0x446b10[_0x395454+_0x39e383]=_0x101204-0x1);}_0x395454+=_0x3638b6;}),_0x38fc31[_0x91dd8a(0x1b9)](_0x903432);});const _0xd28e12=XLSX[_0x2ffba5(0x197)][_0x2ffba5(0x258)](),_0x143806=XLSX[_0x2ffba5(0x197)]['aoa_to_sheet'](_0x38fc31);_0xe6f8c3['length']>0x0&&(_0x143806[_0x2ffba5(0x1ef)]=_0xe6f8c3);_0x143806['!cols']=_0x38fc31[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x2ffba5(0x197)][_0x2ffba5(0x237)](_0xd28e12,_0x143806,'Sales\x20Report');const _0x4bca5f=XLSX[_0x2ffba5(0x22a)](_0xd28e12,{'bookType':_0x2ffba5(0x1ed),'type':_0x2ffba5(0x1bd)});_0x4acd32['setHeader'](_0x2ffba5(0x188),_0x2ffba5(0x173)),_0x4acd32[_0x2ffba5(0x170)]('Content-Type',_0x2ffba5(0x1b3)),_0x4acd32[_0x2ffba5(0x1d3)](_0x4bca5f);}else pdf[_0x2ffba5(0x1f6)](_0x39dae4,_0x1f6f02)[_0x2ffba5(0x275)](function(_0x36d5b0,_0x1743f8){const _0x4d23fb=_0x2ffba5;if(_0x36d5b0){_0x4acd32[_0x4d23fb(0x1cd)](0x1f4)[_0x4d23fb(0x1d3)](_0x4d23fb(0x20a));return;}_0x4acd32[_0x4d23fb(0x170)](_0x4d23fb(0x232),'application/pdf'),_0x1743f8[_0x4d23fb(0x272)](_0x4acd32);});}),module[a0_0x4f1c0b(0x17d)]=router;