const a0_0x28f363=a0_0x558a;(function(_0x3d7d75,_0x4b93e6){const _0x2e9c32=a0_0x558a,_0x3cd61d=_0x3d7d75();while(!![]){try{const _0x447d65=parseInt(_0x2e9c32(0xf1))/0x1+-parseInt(_0x2e9c32(0x107))/0x2*(-parseInt(_0x2e9c32(0x203))/0x3)+-parseInt(_0x2e9c32(0x12c))/0x4*(parseInt(_0x2e9c32(0x170))/0x5)+parseInt(_0x2e9c32(0x19d))/0x6*(-parseInt(_0x2e9c32(0xc5))/0x7)+parseInt(_0x2e9c32(0x22c))/0x8+-parseInt(_0x2e9c32(0x1ed))/0x9*(parseInt(_0x2e9c32(0x179))/0xa)+parseInt(_0x2e9c32(0x17b))/0xb;if(_0x447d65===_0x4b93e6)break;else _0x3cd61d['push'](_0x3cd61d['shift']());}catch(_0x5f2256){_0x3cd61d['push'](_0x3cd61d['shift']());}}}(a0_0x3cb3,0x8c5eb));const express=require(a0_0x28f363(0xb3)),res=require(a0_0x28f363(0x1dc)),app=express(),router=express[a0_0x28f363(0x220)](),multer=require(a0_0x28f363(0x11e)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x28f363(0x17c)),auth=require(a0_0x28f363(0xdd)),users=require(a0_0x28f363(0x168)),excelJS=require(a0_0x28f363(0x18b)),XLSX=require(a0_0x28f363(0xe4)),PDFDocument=require('pdfkit-table'),fs=require('fs'),blobStream=require(a0_0x28f363(0x18c)),JsBarcode=require(a0_0x28f363(0x144)),{Canvas}=require(a0_0x28f363(0xcd)),pdf=require(a0_0x28f363(0x234)),path=require(a0_0x28f363(0x184)),mongoose=require('mongoose'),cheerio=require(a0_0x28f363(0x233));router[a0_0x28f363(0x158)]('/balance/view',auth,async(_0x5327b7,_0x577086)=>{const _0x54af72=a0_0x28f363;try{const {username:_0x2da3a9,email:_0x352481,role:_0x3ace49}=_0x5327b7[_0x54af72(0x187)],_0x46cbac=_0x5327b7['user'],_0x22c08b=await profile['findOne']({'email':_0x46cbac[_0x54af72(0x208)]}),_0x4b4d55={'year':_0x54af72(0x1bc),'month':_0x54af72(0x134),'day':_0x54af72(0x1bc)},_0x16a277=await master_shop[_0x54af72(0x155)]();console[_0x54af72(0x149)](_0x54af72(0x1c6),_0x16a277);const _0x382e45=await product[_0x54af72(0x155)]();console[_0x54af72(0x149)](_0x54af72(0x139),_0x382e45);const _0xd3a844=await warehouse[_0x54af72(0xe9)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':_0x54af72(0x15e),'as':_0x54af72(0xf0)}},{'$unwind':_0x54af72(0xf7)},{'$project':{'product_name':_0x54af72(0x1d1),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);console['log'](_0x54af72(0x1ac),_0xd3a844),_0xd3a844[_0x54af72(0xf8)](_0x2157cc=>{const _0x23d525=_0x382e45['map'](_0x39827c=>{const _0x652598=a0_0x558a;_0x39827c[_0x652598(0x15e)]==_0x2157cc['_id']&&(_0x39827c[_0x652598(0x177)]=parseInt(_0x39827c[_0x652598(0x177)])+parseInt(_0x2157cc['product_stock']));});}),console['log'](_0x54af72(0x139),_0x382e45);if(_0x16a277[0x0][_0x54af72(0x12b)]==_0x54af72(0x11c))var _0x146b0f=users['English'];else{if(_0x16a277[0x0][_0x54af72(0x12b)]==_0x54af72(0x195))var _0x146b0f=users[_0x54af72(0x195)];else{if(_0x16a277[0x0]['language']==_0x54af72(0xdc))var _0x146b0f=users[_0x54af72(0xdc)];else{if(_0x16a277[0x0][_0x54af72(0x12b)]==_0x54af72(0x204))var _0x146b0f=users[_0x54af72(0x204)];else{if(_0x16a277[0x0][_0x54af72(0x12b)]=='French')var _0x146b0f=users['French'];else{if(_0x16a277[0x0][_0x54af72(0x12b)]==_0x54af72(0xe5))var _0x146b0f=users[_0x54af72(0xad)];else{if(_0x16a277[0x0][_0x54af72(0x12b)]==_0x54af72(0x1a1))var _0x146b0f=users['Chinese'];else{if(_0x16a277[0x0][_0x54af72(0x12b)]==_0x54af72(0x15f))var _0x146b0f=users[_0x54af72(0xb8)];}}}}}}}_0x577086[_0x54af72(0x173)](_0x54af72(0x1a6),{'success':_0x5327b7['flash'](_0x54af72(0xb4)),'errors':_0x5327b7[_0x54af72(0x1c8)](_0x54af72(0x21c)),'alldata':_0x382e45,'profile':_0x22c08b,'master_shop':_0x16a277,'role':_0x46cbac,'product_stock':_0xd3a844,'language':_0x146b0f});}catch(_0x5da3fa){}});async function dataCheck(_0x179c1e,_0x2d07a9){const _0x29885a=a0_0x28f363,_0xed46aa=await product[_0x29885a(0xe9)]([{'$group':{'_id':{'brand':_0x29885a(0x16f),'category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2c1bd7=[];_0x2c1bd7[_0x29885a(0x1d9)]=[];for(let _0x3814d4=0x0;_0x3814d4<=_0xed46aa['length']-0x1;_0x3814d4++){const _0x5933e3=_0xed46aa[_0x3814d4];_0x2c1bd7[_0x29885a(0x1d9)][_0x29885a(0x120)](_0x5933e3);}const _0x4577d3=await product['aggregate']([{'$group':{'_id':{'category':_0x29885a(0x1f9)},'products':{'$push':{'brand':_0x29885a(0x16f),'product_code':_0x29885a(0x217),'product_name':_0x29885a(0x1ab)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3298ca=await purchases_finished[_0x29885a(0xe9)]([{'$match':{'date':{'$gte':_0x179c1e,'$lte':_0x2d07a9}}},{'$unwind':_0x29885a(0x14a)},{'$group':{'_id':{'product_name':_0x29885a(0xc6),'product_code':_0x29885a(0x1e3)},'totalQTY':{'$sum':_0x29885a(0x13c)}}}]);_0x2c1bd7[_0x29885a(0x15a)]=[];for(let _0x21e0a8=0x0;_0x21e0a8<=_0x3298ca['length']-0x1;_0x21e0a8++){const _0x36247c=_0x3298ca[_0x21e0a8];_0x2c1bd7['beg_bal']['push'](_0x36247c);}const _0x2ffb2c=await sales_sa[_0x29885a(0xe9)]([{'$match':{'date':{'$gte':_0x179c1e,'$lte':_0x2d07a9}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x29885a(0x1bb)}}},{'$lookup':{'from':_0x29885a(0x186),'localField':_0x29885a(0xd3),'foreignField':_0x29885a(0x18a),'as':'sales_info'}},{'$unwind':_0x29885a(0x1a4)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x29885a(0x136),'product_code':_0x29885a(0x13d)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console['log'](_0x2ffb2c[0x0]),_0x2c1bd7[_0x29885a(0xc7)]=[];for(let _0x389f4b=0x0;_0x389f4b<=_0x2ffb2c['length']-0x1;_0x389f4b++){const _0x542b6d=_0x2ffb2c[_0x389f4b];_0x2c1bd7[_0x29885a(0xc7)][_0x29885a(0x120)](_0x542b6d);}const _0x5548e9=await sales_sa[_0x29885a(0xe9)]([{'$match':{'date':{'$gte':_0x179c1e,'$lte':_0x2d07a9}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x29885a(0x186),'localField':'sales_staff_id','foreignField':'_id','as':_0x29885a(0xd5)}},{'$unwind':'$sales_info'},{'$unwind':_0x29885a(0x201)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x29885a(0x226)}},{'$group':{'_id':{'product_name':_0x29885a(0x136),'product_code':_0x29885a(0x13d)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'}}}]);_0x2c1bd7[_0x29885a(0x10b)]=[];for(let _0x416a0a=0x0;_0x416a0a<=_0x5548e9[_0x29885a(0x1f7)]-0x1;_0x416a0a++){const _0x1948eb=_0x5548e9[_0x416a0a];_0x2c1bd7[_0x29885a(0x10b)]['push'](_0x1948eb);}let _0x540a7e='';for(let _0x136ea7=0x0;_0x136ea7<=_0x4577d3[_0x29885a(0x1f7)]-0x1;_0x136ea7++){const _0x1de956=_0x4577d3[_0x136ea7];_0x540a7e+='<tr>',_0x540a7e+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x1de956['_id'][_0x29885a(0x210)]+_0x29885a(0xd2),_0x540a7e+=_0x29885a(0x137);for(let _0xdd19e3=0x0;_0xdd19e3<_0x2c1bd7[_0x29885a(0x1d9)][_0x29885a(0x1f7)];_0xdd19e3++){const _0x12013a=_0x2c1bd7[_0x29885a(0x1d9)][_0xdd19e3];if(_0x12013a[_0x29885a(0x18a)][_0x29885a(0x210)]==_0x1de956[_0x29885a(0x18a)][_0x29885a(0x210)]){let _0x3f552d=[],_0x5305cf=[],_0x1496c2=[];_0x3f552d[_0x12013a[_0x29885a(0x18a)]['brand']]=[],_0x5305cf[_0x12013a['_id'][_0x29885a(0x1cd)]]=[],_0x1496c2[_0x12013a[_0x29885a(0x18a)][_0x29885a(0x1cd)]]=[];var _0x58b9dc=0x0,_0x4bcc4f=0x0,_0x5aaf0f=0x0;for(let _0x3aa5b8=0x0;_0x3aa5b8<_0x12013a[_0x29885a(0xed)][_0x29885a(0x1f7)];_0x3aa5b8++){const _0x598a31=_0x12013a['products'][_0x3aa5b8];for(let _0x375e23=0x0;_0x375e23<=_0x2c1bd7['beg_bal']['length']-0x1;_0x375e23++){const _0x1c39bc=_0x2c1bd7[_0x29885a(0x15a)][_0x375e23];_0x1c39bc[_0x29885a(0x18a)]['product_name']==_0x598a31[_0x29885a(0x15e)]&&_0x1c39bc['_id']['product_code']==_0x598a31['product_code']&&(_0x58b9dc+=parseInt(_0x1c39bc[_0x29885a(0xf2)],0xa));}for(let _0x401d8c=0x0;_0x401d8c<=_0x2c1bd7['sales_ext']['length']-0x1;_0x401d8c++){const _0x5acb30=_0x2c1bd7[_0x29885a(0x10b)][_0x401d8c];_0x5acb30[_0x29885a(0x18a)][_0x29885a(0x1df)]==_0x598a31[_0x29885a(0x15e)]&&_0x5acb30[_0x29885a(0x18a)][_0x29885a(0x1e8)]==_0x598a31[_0x29885a(0x1e8)]&&(_0x4bcc4f+=parseFloat(_0x5acb30[_0x29885a(0xf2)],0xa)[_0x29885a(0x1c2)](0x2));}for(let _0x28751f=0x0;_0x28751f<=_0x2c1bd7[_0x29885a(0xc7)][_0x29885a(0x1f7)]-0x1;_0x28751f++){const _0xe8a17d=_0x2c1bd7[_0x29885a(0xc7)][_0x28751f];_0xe8a17d[_0x29885a(0x18a)][_0x29885a(0x1df)]==_0x598a31['name']&&_0xe8a17d['_id'][_0x29885a(0x1e8)]==_0x598a31[_0x29885a(0x1e8)]&&(_0x5aaf0f+=parseInt(_0xe8a17d[_0x29885a(0xf2)],0xa));}}const _0x4a42b3=new Intl[(_0x29885a(0x159))](_0x29885a(0x10f));var _0x369276=_0x4a42b3[_0x29885a(0xdf)](_0x58b9dc);_0x3f552d[_0x12013a[_0x29885a(0x18a)][_0x29885a(0x1cd)]]['push'](_0x369276),_0x5305cf[_0x12013a[_0x29885a(0x18a)][_0x29885a(0x1cd)]][_0x29885a(0x120)](_0x4a42b3[_0x29885a(0xdf)](_0x4bcc4f)),_0x1496c2[_0x12013a[_0x29885a(0x18a)][_0x29885a(0x1cd)]][_0x29885a(0x120)](_0x4a42b3[_0x29885a(0xdf)](_0x5aaf0f));var _0x413ce5=_0x4a42b3['format'](_0x58b9dc-(_0x5aaf0f+_0x4bcc4f));_0x540a7e+=_0x29885a(0xbf),_0x540a7e+='<td\x20class=\x22row_data\x22></td>',_0x540a7e+=_0x29885a(0x178)+_0x12013a[_0x29885a(0x18a)][_0x29885a(0x1cd)]+_0x29885a(0xd2),_0x540a7e+=_0x29885a(0x178)+_0x3f552d[_0x12013a['_id'][_0x29885a(0x1cd)]][0x0]+_0x29885a(0xd2),_0x540a7e+=_0x29885a(0xef),_0x540a7e+='<td\x20class=\x22row_data\x22>'+_0x1496c2[_0x12013a[_0x29885a(0x18a)]['brand']][0x0]+_0x29885a(0xd2),_0x540a7e+=_0x29885a(0x178)+_0x5305cf[_0x12013a[_0x29885a(0x18a)]['brand']][0x0]+_0x29885a(0xd2),_0x540a7e+='<td\x20class=\x22row_data\x22>'+_0x413ce5+'</td>',_0x540a7e+=_0x29885a(0x137);}}}return console['log'](_0x2c1bd7[_0x29885a(0xc7)]),_0x540a7e;}router['post'](a0_0x28f363(0x1ce),auth,async(_0x2a427f,_0x49a8be)=>{const _0x1e7fca=a0_0x28f363,{from_date:_0x5961c7,to_date:_0x378439}=_0x2a427f['body'],_0x1d524b=await dataCheck(_0x5961c7,_0x378439);{}let _0x4b3e8c=_0x1e7fca(0x209);var _0x9781b9=new Date(_0x5961c7),_0x2d6fcf=new Date(_0x378439);const _0x3d6983={'year':'numeric','month':_0x1e7fca(0x134),'day':_0x1e7fca(0x1bc)},_0x44afcb=new Intl[(_0x1e7fca(0xcf))](_0x1e7fca(0x10f),_0x3d6983)['format'](_0x9781b9),_0x36e6cd=new Intl[(_0x1e7fca(0xcf))](_0x1e7fca(0x10f),_0x3d6983)[_0x1e7fca(0xdf)](_0x2d6fcf);_0x4b3e8c+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x4b3e8c+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x4b3e8c+=_0x1e7fca(0x188)+_0x44afcb+_0x1e7fca(0x146)+_0x36e6cd+_0x1e7fca(0x227),_0x4b3e8c+=_0x1e7fca(0x13e),_0x4b3e8c+=_0x1e7fca(0xde),_0x4b3e8c+=_0x1e7fca(0x1b5),_0x4b3e8c+=_0x1e7fca(0xbf),_0x4b3e8c+=_0x1e7fca(0x16a),_0x4b3e8c+=_0x1e7fca(0x124),_0x4b3e8c+=_0x1e7fca(0xa4)+_0x44afcb+_0x1e7fca(0x1a3),_0x4b3e8c+=_0x1e7fca(0x18d),_0x4b3e8c+='<th\x20colspan=\x272\x27>SOLD</th>',_0x4b3e8c+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x36e6cd+'</th>',_0x4b3e8c+=_0x1e7fca(0x137),_0x4b3e8c+=_0x1e7fca(0xbf),_0x4b3e8c+=_0x1e7fca(0x237),_0x4b3e8c+=_0x1e7fca(0x1fd),_0x4b3e8c+=_0x1e7fca(0x137),_0x4b3e8c+=_0x1d524b,_0x4b3e8c+=_0x1e7fca(0x1f0),_0x4b3e8c+=_0x1e7fca(0x19e),_0x4b3e8c+='</div>';const _0x2de4cf={'format':_0x1e7fca(0x213),'orientation':_0x1e7fca(0x1e6),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x1e7fca(0xe3)}}};pdf[_0x1e7fca(0xa9)](_0x4b3e8c,_0x2de4cf)['toStream'](function(_0x53ec65,_0x3c1f02){const _0xd4b357=_0x1e7fca;if(_0x53ec65){_0x49a8be['status'](0x1f4)[_0xd4b357(0x16c)](_0xd4b357(0xcb));return;}_0x49a8be[_0xd4b357(0x1ae)](_0xd4b357(0x1f5),_0xd4b357(0x1b6)),_0x3c1f02[_0xd4b357(0x232)](_0x49a8be);});}),router[a0_0x28f363(0x158)](a0_0x28f363(0x1fb),auth,async(_0x446ad4,_0x3ae615)=>{const _0x2c4d64=a0_0x28f363;try{const {username:_0x3b37ec,email:_0xfe6d66,role:_0x18d485}=_0x446ad4[_0x2c4d64(0x187)],_0x36de8f=_0x446ad4['user'],_0x5bd747=await profile[_0x2c4d64(0xc0)]({'email':_0x36de8f[_0x2c4d64(0x208)]}),_0x5e57a0={'year':'numeric','month':_0x2c4d64(0x134),'day':'numeric'},_0x57df2a=await master_shop[_0x2c4d64(0x155)](),_0x59fc95=await product[_0x2c4d64(0x155)](),_0x232af9=await warehouse['aggregate']([{'$unwind':_0x2c4d64(0xf3)},{'$lookup':{'from':'products','localField':_0x2c4d64(0xce),'foreignField':_0x2c4d64(0x15e),'as':_0x2c4d64(0xf0)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x2c4d64(0x1d1),'product_stock':_0x2c4d64(0x125)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2c4d64(0x1eb)}}}]);if(_0x57df2a[0x0][_0x2c4d64(0x12b)]=='English\x20(US)')var _0x1930b9=users[_0x2c4d64(0x1fc)];else{if(_0x57df2a[0x0][_0x2c4d64(0x12b)]=='Hindi')var _0x1930b9=users[_0x2c4d64(0x195)];else{if(_0x57df2a[0x0][_0x2c4d64(0x12b)]==_0x2c4d64(0xdc))var _0x1930b9=users[_0x2c4d64(0xdc)];else{if(_0x57df2a[0x0]['language']=='Spanish')var _0x1930b9=users[_0x2c4d64(0x204)];else{if(_0x57df2a[0x0][_0x2c4d64(0x12b)]==_0x2c4d64(0xc2))var _0x1930b9=users['French'];else{if(_0x57df2a[0x0][_0x2c4d64(0x12b)]=='Portuguese\x20(BR)')var _0x1930b9=users[_0x2c4d64(0xad)];else{if(_0x57df2a[0x0]['language']==_0x2c4d64(0x1a1))var _0x1930b9=users[_0x2c4d64(0x1a1)];else{if(_0x57df2a[0x0][_0x2c4d64(0x12b)]==_0x2c4d64(0x15f))var _0x1930b9=users[_0x2c4d64(0xb8)];}}}}}}}_0x3ae615['render'](_0x2c4d64(0xa0),{'success':_0x446ad4[_0x2c4d64(0x1c8)](_0x2c4d64(0xb4)),'errors':_0x446ad4[_0x2c4d64(0x1c8)]('errors'),'alldata':_0x59fc95,'profile':_0x5bd747,'master_shop':_0x57df2a,'role':_0x36de8f,'product_stock':_0x232af9,'language':_0x1930b9});}catch(_0x1a97d9){}});async function agentsdataCheck(_0x93543a,_0x8dc1dc){const _0x4e3a0d=a0_0x28f363,_0x308560=await product['aggregate']([{'$group':{'_id':{'brand':_0x4e3a0d(0x16f),'category':'$category'},'products':{'$push':{'name':_0x4e3a0d(0x1ab),'product_code':_0x4e3a0d(0x217)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1c5889=[];_0x1c5889['cat_brand']=[];for(let _0x5d5528=0x0;_0x5d5528<=_0x308560[_0x4e3a0d(0x1f7)]-0x1;_0x5d5528++){const _0x555ea5=_0x308560[_0x5d5528];_0x1c5889[_0x4e3a0d(0x1d9)][_0x4e3a0d(0x120)](_0x555ea5);}const _0x49fc50=await product[_0x4e3a0d(0xe9)]([{'$group':{'_id':{'category':_0x4e3a0d(0x1f9)},'products':{'$push':{'brand':_0x4e3a0d(0x16f),'product_code':_0x4e3a0d(0x217),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x502c14=await product[_0x4e3a0d(0xe9)]([{'$group':{'_id':{'category':_0x4e3a0d(0x1f9),'brand':_0x4e3a0d(0x16f)}}},{'$group':{'_id':_0x4e3a0d(0x199),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5e589d=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x93543a,'$lte':_0x8dc1dc}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x4e3a0d(0x1bb)}}},{'$lookup':{'from':_0x4e3a0d(0x186),'localField':_0x4e3a0d(0xd3),'foreignField':_0x4e3a0d(0x18a),'as':'sales_info'}},{'$unwind':'$sales_info'},{'$unwind':_0x4e3a0d(0x201)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x4e3a0d(0x226)}},{'$lookup':{'from':_0x4e3a0d(0xed),'localField':_0x4e3a0d(0xdb),'foreignField':'product_code','as':_0x4e3a0d(0x105)}},{'$unwind':_0x4e3a0d(0x151)},{'$group':{'_id':{'sales_id':'$sales_info._id','category':_0x4e3a0d(0x106),'brand':'$product_info.brand'},'salesman_data':{'$first':'$sales_info.name'},'totalQTY':{'$sum':_0x4e3a0d(0x14d)},'products':{'$push':{'qty':_0x4e3a0d(0x14d),'product_details':{'prod_name':_0x4e3a0d(0xd7),'product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x4e3a0d(0x174)}}}}}]);let _0x16695d='';_0x16695d+='<tr>',_0x16695d+=_0x4e3a0d(0x127),_0x16695d+='</tr>',_0x16695d+=_0x4e3a0d(0xbf),_0x16695d+='<td\x20class=\x22cat_data\x22></td>';for(let _0x2c5de9=0x0;_0x2c5de9<=_0x49fc50[_0x4e3a0d(0x1f7)]-0x1;_0x2c5de9++){const _0x69070e=_0x49fc50[_0x2c5de9];for(let _0xb789c7=0x0;_0xb789c7<_0x502c14['length'];_0xb789c7++){const _0x8b6c0=_0x502c14[_0xb789c7];_0x8b6c0['_id']==_0x69070e[_0x4e3a0d(0x18a)]['category']&&(_0x16695d+=_0x4e3a0d(0x185)+_0x8b6c0[_0x4e3a0d(0xa7)]+'\x22\x20class=\x22cat_data\x22>'+_0x69070e[_0x4e3a0d(0x18a)][_0x4e3a0d(0x210)]+'</td>');}}_0x16695d+=_0x4e3a0d(0xbc),_0x16695d+=_0x4e3a0d(0x137),_0x16695d+=_0x4e3a0d(0xbf),_0x16695d+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>';for(let _0xbe58aa=0x0;_0xbe58aa<=_0x49fc50['length']-0x1;_0xbe58aa++){const _0x338050=_0x49fc50[_0xbe58aa];for(let _0x33e102=0x0;_0x33e102<_0x1c5889[_0x4e3a0d(0x1d9)]['length'];_0x33e102++){const _0x4ec537=_0x1c5889['cat_brand'][_0x33e102];_0x4ec537['_id']['category']==_0x338050[_0x4e3a0d(0x18a)][_0x4e3a0d(0x210)]&&(_0x16695d+='<td\x20class=\x22cat_data\x22>'+_0x4ec537[_0x4e3a0d(0x18a)]['brand']+_0x4e3a0d(0xd2));}}_0x16695d+=_0x4e3a0d(0xb0),_0x16695d+=_0x4e3a0d(0x137);let _0x923a1d={'name':[],'dataqty':{}};for(let _0x47ec1c=0x0;_0x47ec1c<_0x1c5889[_0x4e3a0d(0x1d9)][_0x4e3a0d(0x1f7)];_0x47ec1c++){const _0x1671f5=_0x1c5889['cat_brand'][_0x47ec1c],_0x2f3c01=_0x1671f5[_0x4e3a0d(0x18a)][_0x4e3a0d(0x1cd)],_0x2fe544=_0x1671f5[_0x4e3a0d(0x18a)][_0x4e3a0d(0x210)];!_0x923a1d[_0x4e3a0d(0x1dd)][_0x2f3c01]&&(_0x923a1d[_0x4e3a0d(0x1dd)][_0x2f3c01]={});!_0x923a1d['dataqty'][_0x2f3c01][_0x2fe544]&&(_0x923a1d[_0x4e3a0d(0x1dd)][_0x2f3c01][_0x2fe544]=[]);for(let _0x395e0c=0x0;_0x395e0c<_0x5e589d[_0x4e3a0d(0x1f7)];_0x395e0c++){const _0x592879=_0x5e589d[_0x395e0c];if(_0x2f3c01===_0x592879[_0x4e3a0d(0x18a)][_0x4e3a0d(0x1cd)]&&_0x2fe544===_0x592879[_0x4e3a0d(0x18a)][_0x4e3a0d(0x210)]){const _0x1b51d7=_0x592879[_0x4e3a0d(0x1cc)];!_0x923a1d[_0x4e3a0d(0x1dd)][_0x2f3c01][_0x2fe544][_0x1b51d7]&&(_0x923a1d['dataqty'][_0x2f3c01][_0x2fe544][_0x1b51d7]=[]),_0x923a1d[_0x4e3a0d(0x1dd)][_0x2f3c01][_0x2fe544][_0x1b51d7][_0x4e3a0d(0x120)](_0x592879[_0x4e3a0d(0xf2)]),!_0x923a1d[_0x4e3a0d(0x15e)]['includes'](_0x1b51d7)&&_0x923a1d[_0x4e3a0d(0x15e)]['push'](_0x1b51d7);}}}_0x16695d+=_0x4e3a0d(0xbf);for(let _0x3da426=0x0;_0x3da426<=_0x923a1d[_0x4e3a0d(0x15e)][_0x4e3a0d(0x1f7)]-0x1;_0x3da426++){const _0x54a2c8=_0x923a1d[_0x4e3a0d(0x15e)][_0x3da426];_0x16695d+=_0x4e3a0d(0x178)+_0x54a2c8+_0x4e3a0d(0xd2);var _0xa386e1=0x0,_0x75bebe=0x0;for(let _0x104230=0x0;_0x104230<=_0x1c5889['cat_brand'][_0x4e3a0d(0x1f7)]-0x1;_0x104230++){const _0x31b480=_0x1c5889['cat_brand'][_0x104230];var _0x519919=0x0;_0x923a1d[_0x4e3a0d(0x1dd)][_0x31b480['_id']['brand']][_0x31b480[_0x4e3a0d(0x18a)][_0x4e3a0d(0x210)]][_0x54a2c8]?(_0x519919=_0x923a1d['dataqty'][_0x31b480[_0x4e3a0d(0x18a)][_0x4e3a0d(0x1cd)]][_0x31b480['_id'][_0x4e3a0d(0x210)]][_0x54a2c8][0x0],_0x16695d+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x519919[_0x4e3a0d(0x1c2)](0x2))+'</td>'):(_0x519919=0x0,_0x16695d+=_0x4e3a0d(0x178)+_0x519919+'</td>'),_0xa386e1+=_0x519919;}_0x16695d+=_0x4e3a0d(0x178)+formatNumber(_0xa386e1['toFixed'](0x2))+_0x4e3a0d(0xd2);}return _0x16695d+=_0x4e3a0d(0x137),_0x16695d;}router['post'](a0_0x28f363(0xea),auth,async(_0x42ae77,_0x873872)=>{const _0x246830=a0_0x28f363,{from_date:_0x40b000,to_date:_0x6f84f}=_0x42ae77[_0x246830(0x15d)],_0xdc31ec=await agentsdataCheck(_0x40b000,_0x6f84f);{}let _0x663ac4='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x493988=new Date(_0x40b000),_0x5cf09b=new Date(_0x6f84f);const _0x2c31d6={'year':_0x246830(0x1bc),'month':_0x246830(0x134),'day':_0x246830(0x1bc)},_0x473c3d=new Intl[(_0x246830(0xcf))](_0x246830(0x10f),_0x2c31d6)[_0x246830(0xdf)](_0x493988),_0x100d26=new Intl[(_0x246830(0xcf))](_0x246830(0x10f),_0x2c31d6)[_0x246830(0xdf)](_0x5cf09b);_0x663ac4+=_0x246830(0xcc),_0x663ac4+='<p>SALES\x20REPORTS</p>',_0x663ac4+=_0x246830(0x188)+_0x473c3d+_0x246830(0x146)+_0x100d26+_0x246830(0x227),_0x663ac4+='<div\x20class=\x22row\x22>',_0x663ac4+=_0x246830(0xde),_0x663ac4+=_0x246830(0x1b5),_0x663ac4+=_0xdc31ec,_0x663ac4+=_0x246830(0x1f0),_0x663ac4+=_0x246830(0x19e),_0x663ac4+=_0x246830(0x19e);const _0x4520af={'format':_0x246830(0x213),'orientation':_0x246830(0x1e6),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x246830(0xe3)}}};pdf['create'](_0x663ac4,_0x4520af)[_0x246830(0x202)](function(_0x143231,_0x48a6cc){const _0x26842f=_0x246830;if(_0x143231){_0x873872['status'](0x1f4)[_0x26842f(0x16c)](_0x26842f(0xcb));return;}_0x873872[_0x26842f(0x1ae)](_0x26842f(0x1f5),_0x26842f(0x1b6)),_0x48a6cc[_0x26842f(0x232)](_0x873872);});}),router[a0_0x28f363(0x158)](a0_0x28f363(0x176),auth,async(_0x3136c5,_0x22d2b6)=>{const _0x4c955d=a0_0x28f363;try{const {username:_0x47b1f3,email:_0x47174b,role:_0x6be1f5}=_0x3136c5[_0x4c955d(0x187)],_0x33adb1=_0x3136c5[_0x4c955d(0x187)],_0x16e7e=await profile['findOne']({'email':_0x33adb1['email']}),_0x160f58={'year':_0x4c955d(0x1bc),'month':_0x4c955d(0x134),'day':_0x4c955d(0x1bc)},_0x3f253c=await master_shop[_0x4c955d(0x155)](),_0x4ca5ae=await staff[_0x4c955d(0xc0)]({'email':_0x33adb1[_0x4c955d(0x208)]}),_0x1e8ca6=await product['find'](),_0x4fd175=await warehouse[_0x4c955d(0xe9)]([{'$unwind':_0x4c955d(0xf3)},{'$lookup':{'from':_0x4c955d(0xed),'localField':'product_details.product_name','foreignField':'name','as':_0x4c955d(0xf0)}},{'$unwind':_0x4c955d(0xf7)},{'$project':{'product_name':_0x4c955d(0x1d1),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x4c955d(0x1f2),'product_stock':{'$sum':_0x4c955d(0x1eb)}}}]),_0x441b5c=await staff[_0x4c955d(0x155)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x3f253c[0x0][_0x4c955d(0x12b)]==_0x4c955d(0x11c))var _0x2853cc=users[_0x4c955d(0x1fc)];else{if(_0x3f253c[0x0]['language']==_0x4c955d(0x195))var _0x2853cc=users[_0x4c955d(0x195)];else{if(_0x3f253c[0x0][_0x4c955d(0x12b)]==_0x4c955d(0xdc))var _0x2853cc=users[_0x4c955d(0xdc)];else{if(_0x3f253c[0x0][_0x4c955d(0x12b)]==_0x4c955d(0x204))var _0x2853cc=users[_0x4c955d(0x204)];else{if(_0x3f253c[0x0][_0x4c955d(0x12b)]==_0x4c955d(0xc2))var _0x2853cc=users['French'];else{if(_0x3f253c[0x0]['language']==_0x4c955d(0xe5))var _0x2853cc=users[_0x4c955d(0xad)];else{if(_0x3f253c[0x0][_0x4c955d(0x12b)]==_0x4c955d(0x1a1))var _0x2853cc=users[_0x4c955d(0x1a1)];else{if(_0x3f253c[0x0][_0x4c955d(0x12b)]==_0x4c955d(0x15f))var _0x2853cc=users['Arabic'];}}}}}}}_0x22d2b6[_0x4c955d(0x173)](_0x4c955d(0x20f),{'success':_0x3136c5[_0x4c955d(0x1c8)](_0x4c955d(0xb4)),'errors':_0x3136c5['flash'](_0x4c955d(0x21c)),'alldata':_0x1e8ca6,'profile':_0x16e7e,'master_shop':_0x3f253c,'role':_0x33adb1,'product_stock':_0x4fd175,'language':_0x2853cc,'staff_arr':_0x4ca5ae,'staff_data_all':_0x441b5c});}catch(_0x49f54f){_0x22d2b6[_0x4c955d(0xc9)](_0x49f54f);}});async function agentsdataDSICheck_admin(_0x49c96c,_0x24b1d6,_0x265c99,_0x268d7b){const _0x3cffbd=a0_0x28f363,_0x580463=await product[_0x3cffbd(0xe9)]([{'$group':{'_id':{'brand':_0x3cffbd(0x16f),'category':_0x3cffbd(0x1f9)},'products':{'$push':{'name':_0x3cffbd(0x1ab),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x112b17=[];_0x112b17[_0x3cffbd(0x1d9)]=[];for(let _0x4b79dd=0x0;_0x4b79dd<=_0x580463['length']-0x1;_0x4b79dd++){const _0x50f496=_0x580463[_0x4b79dd];_0x112b17[_0x3cffbd(0x1d9)][_0x3cffbd(0x120)](_0x50f496);}const _0xafab6d=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x3cffbd(0x16f),'product_code':_0x3cffbd(0x217),'product_name':_0x3cffbd(0x1ab)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1b0574=await product['aggregate']([{'$group':{'_id':{'category':_0x3cffbd(0x1f9),'brand':_0x3cffbd(0x16f)}}},{'$group':{'_id':_0x3cffbd(0x199),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x26e0ea=await sales_sa[_0x3cffbd(0xe9)]([{'$match':{'date':{'$gte':_0x49c96c,'$lte':_0x24b1d6},'sales_staff_id':_0x265c99,'sale_product.isFG':'false'}},{'$unwind':_0x3cffbd(0x201)},{'$match':{'sale_product.isFG':_0x3cffbd(0x226)}},{'$lookup':{'from':'products','localField':_0x3cffbd(0xdb),'foreignField':_0x3cffbd(0x1e8),'as':'product_info'}},{'$unwind':_0x3cffbd(0x151)},{'$group':{'_id':{'dsi':_0x3cffbd(0x131),'date':_0x3cffbd(0x225),'customer':_0x3cffbd(0x150)},'totalQty':{'$sum':_0x3cffbd(0x14d)},'products':{'$push':{'qty':_0x3cffbd(0x14d),'NetPrice':_0x3cffbd(0x1c3),'discount':_0x3cffbd(0xda),'adj_discount':_0x3cffbd(0x1d3),'product_details':{'prod_name':_0x3cffbd(0xd7),'product_code':_0x3cffbd(0x21e),'category':_0x3cffbd(0x106),'brand':_0x3cffbd(0x174),'gross_price':_0x3cffbd(0x1cf)}}}}},{'$unwind':_0x3cffbd(0xf6)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3cffbd(0x1ba),'customer':_0x3cffbd(0x1be),'category':_0x3cffbd(0x167),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x3cffbd(0x20e)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x3cffbd(0x1a2)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x3cffbd(0x224)},'adj_discount':{'$sum':_0x3cffbd(0x1d6)},'product_details':{'$first':_0x3cffbd(0xa6)}}},{'$group':{'_id':{'dsi':_0x3cffbd(0x22d),'date':_0x3cffbd(0x1ba),'customer':_0x3cffbd(0x1be)},'totalQty':{'$sum':_0x3cffbd(0x101)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x3cffbd(0x175)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':'$_id.brand','product_details':_0x3cffbd(0xf3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x10220a=[],_0x1b8a97={},_0x57bb37={},_0x1e00e8={};var _0x3c0851=0x0,_0x75b3df=0x0,_0x2432ca=0x0,_0x315ecc=0x0,_0x32781c=0x0;const _0x585c92=0x6;for(let _0x4977e3=0x0;_0x4977e3<=_0x26e0ea[_0x3cffbd(0x1f7)]-0x1;_0x4977e3++){const _0x3f6903=_0x26e0ea[_0x4977e3];let _0x400a39='<tr>';_0x400a39+=_0x3cffbd(0x108)+_0x3f6903['_id'][_0x3cffbd(0x21b)]+'</td>',_0x400a39+=_0x3cffbd(0x108)+_0x3f6903['_id'][_0x3cffbd(0x114)]+_0x3cffbd(0xd2),_0x400a39+=_0x3cffbd(0x108)+_0x3f6903[_0x3cffbd(0x18a)][_0x3cffbd(0x128)]+_0x3cffbd(0xd2);let _0x20e523={};var _0x432b0b=0x0;for(let _0xa6d195=0x0;_0xa6d195<=_0x3f6903[_0x3cffbd(0xed)]['length']-0x1;_0xa6d195++){const _0xf39f69=_0x3f6903[_0x3cffbd(0xed)][_0xa6d195];_0x20e523[_0xf39f69[_0x3cffbd(0x1cd)]+'-'+_0xf39f69[_0x3cffbd(0x210)]]=_0xf39f69[_0x3cffbd(0x16d)];const _0x4b7ceb=_0xf39f69[_0x3cffbd(0x1cd)]+'-'+_0xf39f69[_0x3cffbd(0x210)];!_0x1b8a97[_0x4b7ceb]&&(_0x1b8a97[_0x4b7ceb]=0x0),!Array[_0x3cffbd(0x1ea)](_0x1e00e8[_0x4b7ceb])&&(_0x1e00e8[_0x4b7ceb]=[]),!Array[_0x3cffbd(0x1ea)](_0x1e00e8[_0x4b7ceb])&&(_0x1e00e8[_0x4b7ceb]=[]),_0x1b8a97[_0x4b7ceb]+=_0xf39f69[_0x3cffbd(0x16d)],_0x1e00e8[_0x4b7ceb]['push'](_0xf39f69[_0x3cffbd(0x16d)]),_0x432b0b++;}console['log'](_0x3f6903);for(let _0x12e6f9=0x0;_0x12e6f9<=_0x112b17[_0x3cffbd(0x1d9)][_0x3cffbd(0x1f7)]-0x1;_0x12e6f9++){const _0x46853b=_0x112b17[_0x3cffbd(0x1d9)][_0x12e6f9],_0x8e35d0=_0x46853b[_0x3cffbd(0x18a)]['brand']+'-'+_0x46853b['_id'][_0x3cffbd(0x210)];_0x400a39+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x20e523[_0x8e35d0]!==undefined?_0x20e523[_0x8e35d0][_0x3cffbd(0x1c2)](0x2):'')+_0x3cffbd(0xd2);}_0x2432ca=_0x3f6903['discount']+_0x3f6903[_0x3cffbd(0xc4)],_0x400a39+=_0x3cffbd(0x142)+formatNumber(parseFloat(_0x3f6903[_0x3cffbd(0x12a)],0x2)[_0x3cffbd(0x1c2)](0x2))+'</td>',_0x400a39+=_0x3cffbd(0x142)+formatNumber(_0x3f6903[_0x3cffbd(0x22f)][_0x3cffbd(0x1c2)](0x2))+'</td>',_0x400a39+=_0x3cffbd(0x142)+formatNumber(_0x2432ca)+_0x3cffbd(0xd2),_0x400a39+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x3f6903[_0x3cffbd(0xb5)][_0x3cffbd(0x1c2)](0x2))+_0x3cffbd(0xd2),_0x400a39+='</tr>',_0x3c0851+=parseFloat(_0x3f6903[_0x3cffbd(0x12a)][_0x3cffbd(0x1c2)](0x2)),_0x75b3df+=parseFloat(_0x3f6903[_0x3cffbd(0xb5)][_0x3cffbd(0x1c2)](0x2)),_0x315ecc+=_0x2432ca,_0x32781c+=parseFloat(_0x3f6903[_0x3cffbd(0x22f)][_0x3cffbd(0x1c2)](0x2));if(_0x4977e3==_0x26e0ea['length']-0x1){_0x400a39+=_0x3cffbd(0xbf),_0x400a39+=_0x3cffbd(0x1a5),_0x400a39+=_0x3cffbd(0xd2);for(let _0x103c27=0x0;_0x103c27<=_0x112b17[_0x3cffbd(0x1d9)][_0x3cffbd(0x1f7)]-0x1;_0x103c27++){const _0x51618a=_0x112b17['cat_brand'][_0x103c27],_0x1a40c9=_0x51618a[_0x3cffbd(0x18a)]['brand']+'-'+_0x51618a[_0x3cffbd(0x18a)]['category'];!_0x1e00e8[_0x1a40c9]&&(_0x1e00e8[_0x1a40c9]=[]);const _0x274ae8=_0x1e00e8[_0x1a40c9][_0x3cffbd(0x115)]((_0x4c6218,_0x5bac07)=>_0x4c6218+_0x5bac07,0x0);console['log']('test',_0x1a40c9),_0x400a39+=_0x3cffbd(0x1ec)+(_0x274ae8!==undefined?formatNumber(_0x274ae8[_0x3cffbd(0x1c2)](0x2)):'')+_0x3cffbd(0x126),console['log'](_0x1e00e8[_0x1a40c9][_0x3cffbd(0x115)]((_0x303f20,_0x4ccbf3)=>_0x303f20+_0x4ccbf3,0x0));}_0x400a39+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3c0851['toFixed'](0x2))+_0x3cffbd(0x126),_0x400a39+=_0x3cffbd(0x19c)+formatNumber(_0x32781c)+_0x3cffbd(0x126),_0x400a39+=_0x3cffbd(0x19c)+formatNumber(_0x315ecc)+_0x3cffbd(0x126),_0x400a39+=_0x3cffbd(0x19c)+formatNumber(_0x75b3df)+_0x3cffbd(0x126),_0x400a39+=_0x3cffbd(0x137);}_0x10220a[_0x3cffbd(0x120)](_0x400a39);}function _0x581def(_0x3afc68,_0x3249e0){const _0x238e8a=_0x3cffbd,_0x581e87=[];for(let _0x39901a=0x0;_0x39901a<=_0x3afc68[_0x238e8a(0x1f7)]-0x1;_0x39901a+=_0x3249e0){_0x581e87[_0x238e8a(0x120)](_0x3afc68[_0x238e8a(0x22a)](_0x39901a,_0x39901a+_0x3249e0));}return _0x581e87;}const _0x2e3a65=_0x581def(_0x10220a,_0x585c92);let _0x5ad5dd='';return _0x2e3a65['forEach']((_0x2d4a4d,_0x22a032)=>{const _0x404c6d=_0x3cffbd;_0x22a032>0x0&&(_0x5ad5dd+=_0x404c6d(0x160));_0x5ad5dd+=_0x404c6d(0x1b5),_0x5ad5dd+=_0x404c6d(0x14f),_0x5ad5dd+='<tr>',_0x5ad5dd+=_0x404c6d(0x205),_0x5ad5dd+=_0x404c6d(0x137),_0x5ad5dd+=_0x404c6d(0xbf),_0x5ad5dd+=_0x404c6d(0x153);for(let _0x777e90=0x0;_0x777e90<=_0xafab6d[_0x404c6d(0x1f7)]-0x1;_0x777e90++){const _0x44f38e=_0xafab6d[_0x777e90];for(let _0xe2fd64=0x0;_0xe2fd64<_0x1b0574[_0x404c6d(0x1f7)];_0xe2fd64++){const _0x38e4b3=_0x1b0574[_0xe2fd64];_0x38e4b3[_0x404c6d(0x18a)]===_0x44f38e[_0x404c6d(0x18a)][_0x404c6d(0x210)]&&(_0x5ad5dd+='<td\x20colspan=\x22'+_0x38e4b3[_0x404c6d(0xa7)]+_0x404c6d(0x15b)+_0x44f38e['_id'][_0x404c6d(0x210)]+'</td>');}}_0x5ad5dd+=_0x404c6d(0x231),_0x5ad5dd+=_0x404c6d(0x137),_0x5ad5dd+=_0x404c6d(0xbf),_0x5ad5dd+=_0x404c6d(0x1aa),_0x5ad5dd+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x5ad5dd+=_0x404c6d(0xe8);for(let _0x43f37a=0x0;_0x43f37a<=_0xafab6d[_0x404c6d(0x1f7)]-0x1;_0x43f37a++){const _0x3f8f0a=_0xafab6d[_0x43f37a];for(let _0x140808=0x0;_0x140808<_0x112b17[_0x404c6d(0x1d9)][_0x404c6d(0x1f7)];_0x140808++){const _0xdc77cd=_0x112b17[_0x404c6d(0x1d9)][_0x140808];_0xdc77cd[_0x404c6d(0x18a)][_0x404c6d(0x210)]===_0x3f8f0a[_0x404c6d(0x18a)][_0x404c6d(0x210)]&&(_0x5ad5dd+=_0x404c6d(0x172)+_0xdc77cd[_0x404c6d(0x18a)][_0x404c6d(0x1cd)]+_0x404c6d(0xd2));}}_0x5ad5dd+=_0x404c6d(0xb0),_0x5ad5dd+=_0x404c6d(0xa2),_0x5ad5dd+=_0x404c6d(0x192),_0x5ad5dd+=_0x404c6d(0xee),_0x5ad5dd+='</tr>',_0x5ad5dd+=_0x404c6d(0x180),_0x5ad5dd+=_0x404c6d(0x215),_0x2d4a4d[_0x404c6d(0xf8)](_0x352cbc=>{_0x5ad5dd+=_0x352cbc;}),console['log'](_0x1e00e8),_0x5ad5dd+='</tbody>',_0x5ad5dd+='</table>';}),_0x5ad5dd;}async function agentsdataDSICheck_admin_excel(_0x2761c7,_0x393247,_0x15e31d,_0x3fd889){const _0x892252=a0_0x28f363,_0x3a6dac=await product[_0x892252(0xe9)]([{'$group':{'_id':{'brand':_0x892252(0x16f),'category':_0x892252(0x1f9)},'products':{'$push':{'name':_0x892252(0x1ab),'product_code':_0x892252(0x217)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x550a2e=[];_0x550a2e[_0x892252(0x1d9)]=[];for(let _0x5d7697=0x0;_0x5d7697<=_0x3a6dac[_0x892252(0x1f7)]-0x1;_0x5d7697++){const _0x2f3b95=_0x3a6dac[_0x5d7697];_0x550a2e[_0x892252(0x1d9)]['push'](_0x2f3b95);}const _0x5837bb=await product[_0x892252(0xe9)]([{'$group':{'_id':{'category':_0x892252(0x1f9)},'products':{'$push':{'brand':'$brand','product_code':_0x892252(0x217),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1d7fe4=await product[_0x892252(0xe9)]([{'$group':{'_id':{'category':'$category','brand':'$brand'}}},{'$group':{'_id':_0x892252(0x199),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x45e7c2=await sales_sa[_0x892252(0xe9)]([{'$match':{'date':{'$gte':_0x2761c7,'$lte':_0x393247},'sales_staff_id':_0x15e31d,'sale_product.isFG':'false'}},{'$unwind':_0x892252(0x201)},{'$match':{'sale_product.isFG':_0x892252(0x226)}},{'$lookup':{'from':_0x892252(0xed),'localField':_0x892252(0xdb),'foreignField':'product_code','as':_0x892252(0x105)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x892252(0x131),'date':_0x892252(0x225),'customer':_0x892252(0x150)},'totalQty':{'$sum':_0x892252(0x14d)},'products':{'$push':{'qty':_0x892252(0x14d),'NetPrice':_0x892252(0x1c3),'discount':'$sale_product.discount','adj_discount':_0x892252(0x1d3),'product_details':{'prod_name':_0x892252(0xd7),'product_code':_0x892252(0x21e),'category':_0x892252(0x106),'brand':_0x892252(0x174),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x892252(0x22d),'date':_0x892252(0x1ba),'customer':_0x892252(0x1be),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x892252(0x20e)},'totalGross':{'$sum':{'$multiply':[_0x892252(0x20e),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x892252(0x1f1)},'discount':{'$sum':_0x892252(0x224)},'adj_discount':{'$sum':_0x892252(0x1d6)},'product_details':{'$first':_0x892252(0xa6)}}},{'$group':{'_id':{'dsi':_0x892252(0x22d),'date':'$_id.date','customer':_0x892252(0x1be)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x892252(0xe6)},'NetPrice':{'$sum':_0x892252(0x118)},'discount':{'$sum':_0x892252(0x175)},'adj_discount':{'$sum':_0x892252(0x1ca)},'products':{'$push':{'qty':_0x892252(0x101),'category':_0x892252(0x199),'brand':_0x892252(0x1a0),'product_details':_0x892252(0xf3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2bb562=[],_0x371203={},_0x142794={},_0x2dd74e={};var _0x2108be=0x0,_0x9e0f6b=0x0,_0x389434=0x0,_0x4f889e=0x0,_0xf97e13=0x0;const _0xba6112=0x16345785d8a0000;for(let _0x35c4e8=0x0;_0x35c4e8<=_0x45e7c2[_0x892252(0x1f7)]-0x1;_0x35c4e8++){const _0x4ade7b=_0x45e7c2[_0x35c4e8];let _0x246f5b=_0x892252(0xbf);_0x246f5b+=_0x892252(0x108)+_0x4ade7b['_id']['dsi']+_0x892252(0xd2),_0x246f5b+=_0x892252(0x108)+_0x4ade7b[_0x892252(0x18a)][_0x892252(0x114)]+_0x892252(0xd2),_0x246f5b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4ade7b[_0x892252(0x18a)][_0x892252(0x128)]+_0x892252(0xd2);let _0x52e61c={};var _0x5beb4b=0x0;for(let _0x3394ba=0x0;_0x3394ba<=_0x4ade7b[_0x892252(0xed)][_0x892252(0x1f7)]-0x1;_0x3394ba++){const _0x1ae20f=_0x4ade7b[_0x892252(0xed)][_0x3394ba];_0x52e61c[_0x1ae20f['brand']+'-'+_0x1ae20f[_0x892252(0x210)]]=_0x1ae20f['qty'];const _0x14d0c9=_0x1ae20f[_0x892252(0x1cd)]+'-'+_0x1ae20f[_0x892252(0x210)];!_0x371203[_0x14d0c9]&&(_0x371203[_0x14d0c9]=0x0),!Array['isArray'](_0x2dd74e[_0x14d0c9])&&(_0x2dd74e[_0x14d0c9]=[]),!Array[_0x892252(0x1ea)](_0x2dd74e[_0x14d0c9])&&(_0x2dd74e[_0x14d0c9]=[]),_0x371203[_0x14d0c9]+=_0x1ae20f[_0x892252(0x16d)],_0x2dd74e[_0x14d0c9]['push'](_0x1ae20f['qty']),_0x5beb4b++;}console[_0x892252(0x149)](_0x4ade7b);for(let _0x5a5fa0=0x0;_0x5a5fa0<=_0x550a2e[_0x892252(0x1d9)][_0x892252(0x1f7)]-0x1;_0x5a5fa0++){const _0x224c38=_0x550a2e[_0x892252(0x1d9)][_0x5a5fa0],_0x2aad71=_0x224c38[_0x892252(0x18a)][_0x892252(0x1cd)]+'-'+_0x224c38[_0x892252(0x18a)][_0x892252(0x210)];_0x246f5b+=_0x892252(0x1ad)+(_0x52e61c[_0x2aad71]!==undefined?_0x52e61c[_0x2aad71]['toFixed'](0x2):'')+_0x892252(0xd2);}_0x389434=_0x4ade7b[_0x892252(0x20c)]+_0x4ade7b['adj_discount'],_0x246f5b+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x4ade7b[_0x892252(0x12a)],0x2)[_0x892252(0x1c2)](0x2))+_0x892252(0xd2),_0x246f5b+=_0x892252(0x142)+formatNumber(_0x4ade7b[_0x892252(0x22f)]['toFixed'](0x2))+_0x892252(0xd2),_0x246f5b+=_0x892252(0x142)+formatNumber(_0x389434)+_0x892252(0xd2),_0x246f5b+=_0x892252(0x142)+formatNumber(_0x4ade7b[_0x892252(0xb5)][_0x892252(0x1c2)](0x2))+_0x892252(0xd2),_0x246f5b+=_0x892252(0x137),_0x2108be+=parseFloat(_0x4ade7b[_0x892252(0x12a)]['toFixed'](0x2)),_0x9e0f6b+=parseFloat(_0x4ade7b['NetPrice'][_0x892252(0x1c2)](0x2)),_0x4f889e+=_0x389434,_0xf97e13+=parseFloat(_0x4ade7b[_0x892252(0x22f)][_0x892252(0x1c2)](0x2));if(_0x35c4e8==_0x45e7c2[_0x892252(0x1f7)]-0x1){_0x246f5b+=_0x892252(0xbf),_0x246f5b+=_0x892252(0x1a5),_0x246f5b+='</td>';for(let _0xdc2ac5=0x0;_0xdc2ac5<=_0x550a2e[_0x892252(0x1d9)]['length']-0x1;_0xdc2ac5++){const _0x42517e=_0x550a2e[_0x892252(0x1d9)][_0xdc2ac5],_0x249f8b=_0x42517e['_id'][_0x892252(0x1cd)]+'-'+_0x42517e[_0x892252(0x18a)][_0x892252(0x210)];!_0x2dd74e[_0x249f8b]&&(_0x2dd74e[_0x249f8b]=[]);const _0x1c9b44=_0x2dd74e[_0x249f8b][_0x892252(0x115)]((_0x742b75,_0x3be6f2)=>_0x742b75+_0x3be6f2,0x0);console[_0x892252(0x149)](_0x892252(0xf5),_0x249f8b),_0x246f5b+=_0x892252(0x1ec)+(_0x1c9b44!==undefined?formatNumber(_0x1c9b44[_0x892252(0x1c2)](0x2)):'')+_0x892252(0x126),console['log'](_0x2dd74e[_0x249f8b][_0x892252(0x115)]((_0x43815c,_0x2406c9)=>_0x43815c+_0x2406c9,0x0));}_0x246f5b+=_0x892252(0x19c)+formatNumber(_0x2108be[_0x892252(0x1c2)](0x2))+'</b></td>',_0x246f5b+=_0x892252(0x19c)+formatNumber(_0xf97e13)+_0x892252(0x126),_0x246f5b+=_0x892252(0x19c)+formatNumber(_0x4f889e)+'</b></td>',_0x246f5b+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x9e0f6b)+_0x892252(0x126),_0x246f5b+=_0x892252(0x137);}_0x2bb562['push'](_0x246f5b);}function _0x2e85f6(_0x321049,_0x16248a){const _0x4db800=_0x892252,_0x543848=[];for(let _0x518ad6=0x0;_0x518ad6<=_0x321049[_0x4db800(0x1f7)]-0x1;_0x518ad6+=_0x16248a){_0x543848[_0x4db800(0x120)](_0x321049['slice'](_0x518ad6,_0x518ad6+_0x16248a));}return _0x543848;}const _0x27280e=_0x2e85f6(_0x2bb562,_0xba6112);let _0xf0dfb='';return _0x27280e[_0x892252(0xf8)]((_0x4f8662,_0x4011e0)=>{const _0x29d74d=_0x892252;_0x4011e0>0x0&&(_0xf0dfb+=_0x29d74d(0x160));_0xf0dfb+='<table>',_0xf0dfb+=_0x29d74d(0x14f),_0xf0dfb+=_0x29d74d(0xbf),_0xf0dfb+=_0x29d74d(0x205),_0xf0dfb+=_0x29d74d(0x137),_0xf0dfb+=_0x29d74d(0xbf),_0xf0dfb+=_0x29d74d(0x153);for(let _0x2c9d3a=0x0;_0x2c9d3a<=_0x5837bb[_0x29d74d(0x1f7)]-0x1;_0x2c9d3a++){const _0x40b0bf=_0x5837bb[_0x2c9d3a];for(let _0x2f4d67=0x0;_0x2f4d67<_0x1d7fe4[_0x29d74d(0x1f7)];_0x2f4d67++){const _0x524a90=_0x1d7fe4[_0x2f4d67];_0x524a90[_0x29d74d(0x18a)]===_0x40b0bf[_0x29d74d(0x18a)]['category']&&(_0xf0dfb+=_0x29d74d(0x185)+_0x524a90[_0x29d74d(0xa7)]+_0x29d74d(0x15b)+_0x40b0bf[_0x29d74d(0x18a)]['category']+_0x29d74d(0xd2));}}_0xf0dfb+=_0x29d74d(0x231),_0xf0dfb+=_0x29d74d(0x137),_0xf0dfb+=_0x29d74d(0xbf),_0xf0dfb+=_0x29d74d(0x1aa),_0xf0dfb+=_0x29d74d(0x1de),_0xf0dfb+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x17c266=0x0;_0x17c266<=_0x5837bb[_0x29d74d(0x1f7)]-0x1;_0x17c266++){const _0x1f9a88=_0x5837bb[_0x17c266];for(let _0x17056d=0x0;_0x17056d<_0x550a2e['cat_brand'][_0x29d74d(0x1f7)];_0x17056d++){const _0x49a373=_0x550a2e[_0x29d74d(0x1d9)][_0x17056d];_0x49a373[_0x29d74d(0x18a)][_0x29d74d(0x210)]===_0x1f9a88['_id'][_0x29d74d(0x210)]&&(_0xf0dfb+=_0x29d74d(0x172)+_0x49a373[_0x29d74d(0x18a)][_0x29d74d(0x1cd)]+_0x29d74d(0xd2));}}_0xf0dfb+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0xf0dfb+=_0x29d74d(0xa2),_0xf0dfb+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0xf0dfb+=_0x29d74d(0xee),_0xf0dfb+=_0x29d74d(0x137),_0xf0dfb+=_0x29d74d(0x180),_0xf0dfb+=_0x29d74d(0x215),_0x4f8662[_0x29d74d(0xf8)](_0x30fa10=>{_0xf0dfb+=_0x30fa10;}),console['log'](_0x2dd74e),_0xf0dfb+='</tbody>',_0xf0dfb+=_0x29d74d(0x1f0);}),_0xf0dfb;}router[a0_0x28f363(0x112)](a0_0x28f363(0x104),auth,async(_0x224da4,_0x61ad15)=>{const _0x7f4d44=a0_0x28f363,{from_date:_0x13079e,to_date:_0x44d32f,isExcel:_0x2de012,agent_id:_0x2a5f6c}=_0x224da4[_0x7f4d44(0x15d)],_0x497aaf=_0x224da4[_0x7f4d44(0x187)],_0x911c3d=await staff[_0x7f4d44(0xc0)]({'email':_0x497aaf[_0x7f4d44(0x208)]}),_0x561f26=await master_shop[_0x7f4d44(0x155)](),_0x31c614=await agentsdataDSICheck_admin(_0x13079e,_0x44d32f,_0x2a5f6c,_0x2de012),_0x438cb4=await agentsdataDSICheck_admin_excel(_0x13079e,_0x44d32f,_0x2a5f6c,_0x2de012);let _0x254fce=_0x7f4d44(0xca);var _0xda8c42=new Date(_0x13079e),_0x5a4f35=new Date(_0x44d32f);const _0x3e6816={'year':_0x7f4d44(0x1bc),'month':_0x7f4d44(0x134),'day':_0x7f4d44(0x1bc)},_0x11af62=new Intl['DateTimeFormat'](_0x7f4d44(0x10f),_0x3e6816)[_0x7f4d44(0xdf)](_0xda8c42),_0x5876a8=new Intl['DateTimeFormat'](_0x7f4d44(0x10f),_0x3e6816)['format'](_0x5a4f35);_0x254fce+=_0x7f4d44(0x13e),_0x254fce+=_0x7f4d44(0x1b2),_0x254fce+=_0x7f4d44(0x1b5),_0x254fce+=_0x31c614,_0x254fce+=_0x7f4d44(0x1f0),_0x254fce+='</div>',_0x254fce+=_0x7f4d44(0x19e);let _0xda696d='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0xda696d+=_0x7f4d44(0x13e),_0xda696d+=_0x7f4d44(0x1b2),_0xda696d+=_0x7f4d44(0x1b5),_0xda696d+=_0x438cb4,_0xda696d+=_0x7f4d44(0x1f0),_0xda696d+=_0x7f4d44(0x19e),_0xda696d+=_0x7f4d44(0x19e);let _0xa1ef3f=_0x7f4d44(0x1ee);const _0x58756e={'width':_0x7f4d44(0x1c0),'height':_0x7f4d44(0xfc),'orientation':'landscape','border':{'top':_0x7f4d44(0xd9),'right':'0.1in','bottom':_0x7f4d44(0xd9),'left':_0x7f4d44(0xd9)},'header':{'height':'60mm','contents':_0x7f4d44(0x11d)+_0xa1ef3f+_0x7f4d44(0x222)+_0x11af62+_0x7f4d44(0x146)+_0x5876a8+_0x7f4d44(0x1a9)},'footer':{'height':'20mm','contents':{'default':_0x7f4d44(0x221)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x7f4d44(0xe3)}}};if(_0x2de012=='on'){const _0x4b6e05=cheerio[_0x7f4d44(0xa8)](_0xda696d);let _0x4783d2=[],_0x6ba4e0=[],_0x6c53ba=[];_0x4b6e05(_0x7f4d44(0xe7))['each']((_0x49596b,_0x439af2)=>{const _0x95fb90=_0x7f4d44;let _0x3b7619=[],_0x4d914f=0x0;while(_0x6c53ba[_0x4d914f]){_0x6c53ba[_0x4d914f]--,_0x4d914f++;}_0x4b6e05(_0x439af2)[_0x95fb90(0x155)](_0x95fb90(0x1bf))[_0x95fb90(0x133)]((_0x4d7408,_0x8cb7f7)=>{const _0x1353bc=_0x95fb90;let _0x2bdcab=_0x4b6e05(_0x8cb7f7)[_0x1353bc(0x1fa)]()[_0x1353bc(0x162)](),_0x2dd358=parseFloat(_0x2bdcab['replace'](/,/g,''));isNaN(_0x2dd358)&&(_0x2dd358=_0x2bdcab);let _0x2ecd00=parseInt(_0x4b6e05(_0x8cb7f7)[_0x1353bc(0xae)](_0x1353bc(0x161)))||0x1,_0x72a14f=parseInt(_0x4b6e05(_0x8cb7f7)[_0x1353bc(0xae)]('rowspan'))||0x1;_0x3b7619[_0x4d914f]=_0x2dd358;(_0x2ecd00>0x1||_0x72a14f>0x1)&&_0x6ba4e0[_0x1353bc(0x120)]({'s':{'r':_0x49596b,'c':_0x4d914f},'e':{'r':_0x49596b+_0x72a14f-0x1,'c':_0x4d914f+_0x2ecd00-0x1}});for(let _0x3e0f26=0x0;_0x3e0f26<_0x2ecd00;_0x3e0f26++){_0x72a14f>0x1&&(_0x6c53ba[_0x4d914f+_0x3e0f26]=_0x72a14f-0x1);}_0x4d914f+=_0x2ecd00;}),_0x4783d2[_0x95fb90(0x120)](_0x3b7619);});const _0x15a9f3=XLSX[_0x7f4d44(0x21a)]['book_new'](),_0x11398a=XLSX['utils']['aoa_to_sheet'](_0x4783d2);_0x6ba4e0[_0x7f4d44(0x1f7)]>0x0&&(_0x11398a['!merges']=_0x6ba4e0);_0x11398a['!cols']=_0x4783d2[0x0][_0x7f4d44(0x1f3)](()=>({'wpx':0x64})),XLSX[_0x7f4d44(0x21a)][_0x7f4d44(0x22e)](_0x15a9f3,_0x11398a,_0x7f4d44(0x1e7));const _0x474fe2=XLSX[_0x7f4d44(0x1e0)](_0x15a9f3,{'bookType':_0x7f4d44(0xe4),'type':_0x7f4d44(0xf9)});_0x61ad15[_0x7f4d44(0x1ae)](_0x7f4d44(0x123),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x61ad15[_0x7f4d44(0x1ae)](_0x7f4d44(0x1f5),_0x7f4d44(0x1c9)),_0x61ad15[_0x7f4d44(0x16c)](_0x474fe2);}else pdf[_0x7f4d44(0xa9)](_0x254fce,_0x58756e)[_0x7f4d44(0x202)](function(_0x3b6ec7,_0x145f34){const _0x2f3627=_0x7f4d44;if(_0x3b6ec7){_0x61ad15[_0x2f3627(0x143)](0x1f4)[_0x2f3627(0x16c)]('Error\x20generating\x20PDF');return;}_0x61ad15['setHeader']('Content-Type',_0x2f3627(0x1b6)),_0x145f34['pipe'](_0x61ad15);});}),router[a0_0x28f363(0x158)](a0_0x28f363(0x16b),auth,async(_0x3c8371,_0x209412)=>{const _0x4d54cb=a0_0x28f363;try{const {username:_0x2162a6,email:_0x58e14b,role:_0x3d1de8}=_0x3c8371[_0x4d54cb(0x187)],_0x243820=_0x3c8371[_0x4d54cb(0x187)],_0xa809de=await profile[_0x4d54cb(0xc0)]({'email':_0x243820[_0x4d54cb(0x208)]}),_0x271c5e={'year':_0x4d54cb(0x1bc),'month':'long','day':_0x4d54cb(0x1bc)},_0x1ee33c=await master_shop['find'](),_0x40807b=await staff['findOne']({'email':_0x243820[_0x4d54cb(0x208)]}),_0xac9cb3=await product['find'](),_0xc0e9f1=await warehouse['aggregate']([{'$unwind':_0x4d54cb(0xf3)},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':_0x4d54cb(0x15e),'as':_0x4d54cb(0xf0)}},{'$unwind':_0x4d54cb(0xf7)},{'$project':{'product_name':_0x4d54cb(0x1d1),'product_stock':_0x4d54cb(0x125)}},{'$group':{'_id':_0x4d54cb(0x1f2),'product_stock':{'$sum':_0x4d54cb(0x1eb)}}}]);if(_0x1ee33c[0x0]['language']==_0x4d54cb(0x11c))var _0x2dad67=users[_0x4d54cb(0x1fc)];else{if(_0x1ee33c[0x0][_0x4d54cb(0x12b)]==_0x4d54cb(0x195))var _0x2dad67=users[_0x4d54cb(0x195)];else{if(_0x1ee33c[0x0][_0x4d54cb(0x12b)]==_0x4d54cb(0xdc))var _0x2dad67=users[_0x4d54cb(0xdc)];else{if(_0x1ee33c[0x0][_0x4d54cb(0x12b)]==_0x4d54cb(0x204))var _0x2dad67=users['Spanish'];else{if(_0x1ee33c[0x0][_0x4d54cb(0x12b)]==_0x4d54cb(0xc2))var _0x2dad67=users[_0x4d54cb(0xc2)];else{if(_0x1ee33c[0x0]['language']==_0x4d54cb(0xe5))var _0x2dad67=users[_0x4d54cb(0xad)];else{if(_0x1ee33c[0x0][_0x4d54cb(0x12b)]==_0x4d54cb(0x1a1))var _0x2dad67=users[_0x4d54cb(0x1a1)];else{if(_0x1ee33c[0x0][_0x4d54cb(0x12b)]==_0x4d54cb(0x15f))var _0x2dad67=users[_0x4d54cb(0xb8)];}}}}}}}_0x209412[_0x4d54cb(0x173)](_0x4d54cb(0xd6),{'success':_0x3c8371['flash'](_0x4d54cb(0xb4)),'errors':_0x3c8371['flash'](_0x4d54cb(0x21c)),'alldata':_0xac9cb3,'profile':_0xa809de,'master_shop':_0x1ee33c,'role':_0x243820,'product_stock':_0xc0e9f1,'language':_0x2dad67,'staff_arr':_0x40807b});}catch(_0x4810cd){}});function formatNumber(_0x4c28a7,_0x2aaec7=a0_0x28f363(0x10f),_0x2be8a1={'minimumFractionDigits':0x2}){const _0x5cfee1=a0_0x28f363,_0x15b959=new Intl[(_0x5cfee1(0x159))](_0x2aaec7,_0x2be8a1);return _0x15b959[_0x5cfee1(0xdf)](_0x4c28a7);}async function agentsdataDSICheck(_0x52a907,_0x63b384,_0x2f695b,_0x335cac){const _0xed7036=a0_0x28f363,_0x42992a=await product['aggregate']([{'$group':{'_id':{'brand':_0xed7036(0x16f),'category':'$category'},'products':{'$push':{'name':_0xed7036(0x1ab),'product_code':_0xed7036(0x217)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x33b9e1=[];_0x33b9e1[_0xed7036(0x1d9)]=[];for(let _0x102f93=0x0;_0x102f93<=_0x42992a[_0xed7036(0x1f7)]-0x1;_0x102f93++){const _0x15160e=_0x42992a[_0x102f93];_0x33b9e1[_0xed7036(0x1d9)][_0xed7036(0x120)](_0x15160e);}const _0x48180f=await product[_0xed7036(0xe9)]([{'$group':{'_id':{'category':_0xed7036(0x1f9)},'products':{'$push':{'brand':_0xed7036(0x16f),'product_code':_0xed7036(0x217),'product_name':_0xed7036(0x1ab)}}}},{'$sort':{'_id.category':-0x1}}]),_0x7588db=await product[_0xed7036(0xe9)]([{'$group':{'_id':{'category':_0xed7036(0x1f9),'brand':_0xed7036(0x16f)}}},{'$group':{'_id':_0xed7036(0x199),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4670d0=await sales_sa[_0xed7036(0xe9)]([{'$match':{'date':{'$gte':_0x52a907,'$lte':_0x63b384},'sales_staff_id':_0x2f695b,'sale_product.isFG':_0xed7036(0x226),'status_data':_0xed7036(0x226)}},{'$unwind':_0xed7036(0x201)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0xed7036(0xed),'localField':_0xed7036(0xdb),'foreignField':_0xed7036(0x1e8),'as':_0xed7036(0x105)}},{'$unwind':_0xed7036(0x151)},{'$group':{'_id':{'dsi':_0xed7036(0x131),'date':_0xed7036(0x225),'customer':_0xed7036(0x150)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0xed7036(0x14d),'NetPrice':_0xed7036(0x1c3),'discount':_0xed7036(0xda),'adj_discount':_0xed7036(0x1d3),'product_details':{'prod_name':_0xed7036(0xd7),'product_code':_0xed7036(0x21e),'category':'$product_info.category','brand':_0xed7036(0x174),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0xed7036(0xf6)},{'$group':{'_id':{'dsi':_0xed7036(0x22d),'date':'$_id.date','customer':'$_id.customer','category':_0xed7036(0x167),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0xed7036(0x20e)},'totalGross':{'$sum':{'$multiply':[_0xed7036(0x20e),_0xed7036(0x1a2)]}},'NetPrice':{'$sum':_0xed7036(0x1f1)},'discount':{'$sum':_0xed7036(0x224)},'adj_discount':{'$sum':_0xed7036(0x1d6)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0xed7036(0x22d),'date':_0xed7036(0x1ba),'customer':_0xed7036(0x1be)},'totalQty':{'$sum':_0xed7036(0x101)},'totalGross':{'$sum':_0xed7036(0xe6)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0xed7036(0x175)},'adj_discount':{'$sum':_0xed7036(0x1ca)},'products':{'$push':{'qty':_0xed7036(0x101),'category':_0xed7036(0x199),'brand':_0xed7036(0x1a0),'product_details':_0xed7036(0xf3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2356c4=[],_0x2fd2dd={},_0x13d630={},_0x2da4c1={};var _0x47e0b1=0x0,_0x4ceb22=0x0,_0x53a922=0x0,_0x2aa49d=0x0,_0xeacdb4=0x0;const _0x489718=0x6;for(let _0x5b893a=0x0;_0x5b893a<=_0x4670d0[_0xed7036(0x1f7)]-0x1;_0x5b893a++){const _0x16de6c=_0x4670d0[_0x5b893a];let _0x2dbb52=_0xed7036(0xbf);_0x2dbb52+=_0xed7036(0x108)+_0x16de6c['_id'][_0xed7036(0x21b)]+_0xed7036(0xd2),_0x2dbb52+=_0xed7036(0x108)+_0x16de6c[_0xed7036(0x18a)][_0xed7036(0x114)]+'</td>',_0x2dbb52+=_0xed7036(0x108)+_0x16de6c[_0xed7036(0x18a)][_0xed7036(0x128)]+_0xed7036(0xd2);let _0x1803b4={};var _0x388268=0x0;for(let _0x31b0a0=0x0;_0x31b0a0<=_0x16de6c[_0xed7036(0xed)][_0xed7036(0x1f7)]-0x1;_0x31b0a0++){const _0x373f59=_0x16de6c[_0xed7036(0xed)][_0x31b0a0];_0x1803b4[_0x373f59['brand']+'-'+_0x373f59['category']]=_0x373f59[_0xed7036(0x16d)];const _0x9843ba=_0x373f59[_0xed7036(0x1cd)]+'-'+_0x373f59[_0xed7036(0x210)];!_0x2fd2dd[_0x9843ba]&&(_0x2fd2dd[_0x9843ba]=0x0),!Array[_0xed7036(0x1ea)](_0x2da4c1[_0x9843ba])&&(_0x2da4c1[_0x9843ba]=[]),!Array['isArray'](_0x2da4c1[_0x9843ba])&&(_0x2da4c1[_0x9843ba]=[]),_0x2fd2dd[_0x9843ba]+=_0x373f59[_0xed7036(0x16d)],_0x2da4c1[_0x9843ba][_0xed7036(0x120)](_0x373f59[_0xed7036(0x16d)]),_0x388268++;}for(let _0x48fc48=0x0;_0x48fc48<=_0x33b9e1[_0xed7036(0x1d9)][_0xed7036(0x1f7)]-0x1;_0x48fc48++){const _0xc2531b=_0x33b9e1['cat_brand'][_0x48fc48],_0x3ec9a6=_0xc2531b['_id'][_0xed7036(0x1cd)]+'-'+_0xc2531b[_0xed7036(0x18a)][_0xed7036(0x210)];_0x2dbb52+=_0xed7036(0x1ad)+(_0x1803b4[_0x3ec9a6]!==undefined?_0x1803b4[_0x3ec9a6]['toFixed'](0x2):'')+_0xed7036(0xd2);}_0x53a922=_0x16de6c[_0xed7036(0x20c)]+_0x16de6c[_0xed7036(0xc4)],_0x2dbb52+=_0xed7036(0x142)+formatNumber(parseFloat(_0x16de6c['totalQty'],0x2)[_0xed7036(0x1c2)](0x2))+'</td>',_0x2dbb52+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x16de6c['totalGross'][_0xed7036(0x1c2)](0x2))+'</td>',_0x2dbb52+=_0xed7036(0x142)+formatNumber(_0x53a922)+_0xed7036(0xd2),_0x2dbb52+=_0xed7036(0x142)+formatNumber(_0x16de6c[_0xed7036(0xb5)][_0xed7036(0x1c2)](0x2))+'</td>',_0x2dbb52+=_0xed7036(0x137),_0x47e0b1+=parseFloat(_0x16de6c[_0xed7036(0x12a)]),_0x4ceb22+=parseFloat(_0x16de6c[_0xed7036(0xb5)][_0xed7036(0x1c2)](0x2)),_0x2aa49d+=_0x53a922,_0xeacdb4+=parseFloat(_0x16de6c[_0xed7036(0x22f)][_0xed7036(0x1c2)](0x2));if(_0x5b893a==_0x4670d0[_0xed7036(0x1f7)]-0x1){_0x2dbb52+=_0xed7036(0xbf),_0x2dbb52+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x2dbb52+='</td>';for(let _0x25646f=0x0;_0x25646f<=_0x33b9e1[_0xed7036(0x1d9)][_0xed7036(0x1f7)]-0x1;_0x25646f++){const _0x2da2fd=_0x33b9e1[_0xed7036(0x1d9)][_0x25646f],_0x9290fb=_0x2da2fd[_0xed7036(0x18a)][_0xed7036(0x1cd)]+'-'+_0x2da2fd[_0xed7036(0x18a)][_0xed7036(0x210)];!_0x2da4c1[_0x9290fb]&&(_0x2da4c1[_0x9290fb]=[]);const _0x128e36=_0x2da4c1[_0x9290fb][_0xed7036(0x115)]((_0x270a0a,_0x994e26)=>_0x270a0a+_0x994e26,0x0);_0x2dbb52+=_0xed7036(0x1ec)+(_0x128e36!==undefined?formatNumber(_0x128e36['toFixed'](0x2)):'')+'</b></td>';}_0x2dbb52+=_0xed7036(0x19c)+formatNumber(_0x47e0b1[_0xed7036(0x1c2)](0x2))+_0xed7036(0x126),_0x2dbb52+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xeacdb4)+_0xed7036(0x126),_0x2dbb52+=_0xed7036(0x19c)+formatNumber(_0x2aa49d)+_0xed7036(0x126),_0x2dbb52+=_0xed7036(0x19c)+formatNumber(_0x4ceb22)+_0xed7036(0x126),_0x2dbb52+=_0xed7036(0x137);}console[_0xed7036(0x149)](_0xed7036(0x1e1),_0x47e0b1+'+='+parseFloat(_0x16de6c[_0xed7036(0x12a)])),_0x2356c4[_0xed7036(0x120)](_0x2dbb52);}function _0x2ddc42(_0x3ba613,_0x14306c){const _0x21f95c=_0xed7036,_0x381a64=[];for(let _0x3ccb5b=0x0;_0x3ccb5b<=_0x3ba613[_0x21f95c(0x1f7)]-0x1;_0x3ccb5b+=_0x14306c){_0x381a64['push'](_0x3ba613['slice'](_0x3ccb5b,_0x3ccb5b+_0x14306c));}return _0x381a64;}const _0x27060c=_0x2ddc42(_0x2356c4,_0x489718);let _0x4119c8='';return _0x27060c[_0xed7036(0xf8)]((_0x1dcc14,_0x4bd231)=>{const _0x439317=_0xed7036;_0x4bd231>0x0&&(_0x4119c8+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x4119c8+=_0x439317(0x1b5),_0x4119c8+='<thead>',_0x4119c8+='<tr>',_0x4119c8+=_0x439317(0x205),_0x4119c8+=_0x439317(0x137),_0x4119c8+=_0x439317(0xbf),_0x4119c8+=_0x439317(0x153);for(let _0x2f8c7e=0x0;_0x2f8c7e<=_0x48180f[_0x439317(0x1f7)]-0x1;_0x2f8c7e++){const _0x553f71=_0x48180f[_0x2f8c7e];for(let _0x1edb73=0x0;_0x1edb73<_0x7588db[_0x439317(0x1f7)];_0x1edb73++){const _0x5e710b=_0x7588db[_0x1edb73];_0x5e710b[_0x439317(0x18a)]===_0x553f71[_0x439317(0x18a)][_0x439317(0x210)]&&(_0x4119c8+=_0x439317(0x185)+_0x5e710b[_0x439317(0xa7)]+_0x439317(0x15b)+_0x553f71['_id'][_0x439317(0x210)]+'</td>');}}_0x4119c8+=_0x439317(0x231),_0x4119c8+=_0x439317(0x137),_0x4119c8+=_0x439317(0xbf),_0x4119c8+=_0x439317(0x1aa),_0x4119c8+=_0x439317(0x1de),_0x4119c8+=_0x439317(0xe8);for(let _0x263757=0x0;_0x263757<=_0x48180f['length']-0x1;_0x263757++){const _0x3a7fdb=_0x48180f[_0x263757];for(let _0x38ff5d=0x0;_0x38ff5d<_0x33b9e1[_0x439317(0x1d9)]['length'];_0x38ff5d++){const _0x1f3401=_0x33b9e1['cat_brand'][_0x38ff5d];_0x1f3401['_id'][_0x439317(0x210)]===_0x3a7fdb[_0x439317(0x18a)][_0x439317(0x210)]&&(_0x4119c8+=_0x439317(0x172)+_0x1f3401['_id']['brand']+_0x439317(0xd2));}}_0x4119c8+=_0x439317(0xb0),_0x4119c8+=_0x439317(0xa2),_0x4119c8+=_0x439317(0x192),_0x4119c8+=_0x439317(0xee),_0x4119c8+=_0x439317(0x137),_0x4119c8+=_0x439317(0x180),_0x4119c8+=_0x439317(0x215),_0x1dcc14[_0x439317(0xf8)](_0x44d351=>{_0x4119c8+=_0x44d351;}),_0x4119c8+=_0x439317(0x211),_0x4119c8+=_0x439317(0x1f0);}),_0x4119c8;}async function agentsdataDSICheck_excel(_0x399183,_0x1ca03f,_0x1909b2,_0x34c52c){const _0x29a024=a0_0x28f363,_0x577aa7=await product['aggregate']([{'$group':{'_id':{'brand':_0x29a024(0x16f),'category':_0x29a024(0x1f9)},'products':{'$push':{'name':_0x29a024(0x1ab),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x124a7f=[];_0x124a7f[_0x29a024(0x1d9)]=[];for(let _0x1e2da8=0x0;_0x1e2da8<=_0x577aa7[_0x29a024(0x1f7)]-0x1;_0x1e2da8++){const _0x4f3c5b=_0x577aa7[_0x1e2da8];_0x124a7f[_0x29a024(0x1d9)][_0x29a024(0x120)](_0x4f3c5b);}const _0x8eb211=await product['aggregate']([{'$group':{'_id':{'category':_0x29a024(0x1f9)},'products':{'$push':{'brand':_0x29a024(0x16f),'product_code':_0x29a024(0x217),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x58ebfa=await product[_0x29a024(0xe9)]([{'$group':{'_id':{'category':_0x29a024(0x1f9),'brand':_0x29a024(0x16f)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5e0e9c=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x399183,'$lte':_0x1ca03f},'sales_staff_id':_0x1909b2,'sale_product.isFG':_0x29a024(0x226)}},{'$unwind':_0x29a024(0x201)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x29a024(0xed),'localField':'sale_product.product_code','foreignField':_0x29a024(0x1e8),'as':_0x29a024(0x105)}},{'$unwind':_0x29a024(0x151)},{'$group':{'_id':{'dsi':_0x29a024(0x131),'date':_0x29a024(0x225),'customer':'$customer'},'totalQty':{'$sum':_0x29a024(0x14d)},'products':{'$push':{'qty':_0x29a024(0x14d),'NetPrice':_0x29a024(0x1c3),'discount':_0x29a024(0xda),'adj_discount':_0x29a024(0x1d3),'product_details':{'prod_name':_0x29a024(0xd7),'product_code':'$product_info.product_code','category':_0x29a024(0x106),'brand':_0x29a024(0x174),'gross_price':_0x29a024(0x1cf)}}}}},{'$unwind':_0x29a024(0xf6)},{'$group':{'_id':{'dsi':_0x29a024(0x22d),'date':'$_id.date','customer':_0x29a024(0x1be),'category':_0x29a024(0x167),'brand':_0x29a024(0x223)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x29a024(0x20e),_0x29a024(0x1a2)]}},'NetPrice':{'$sum':_0x29a024(0x1f1)},'discount':{'$sum':_0x29a024(0x224)},'adj_discount':{'$sum':_0x29a024(0x1d6)},'product_details':{'$first':_0x29a024(0xa6)}}},{'$group':{'_id':{'dsi':_0x29a024(0x22d),'date':_0x29a024(0x1ba),'customer':'$_id.customer'},'totalQty':{'$sum':_0x29a024(0x101)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x29a024(0x118)},'discount':{'$sum':_0x29a024(0x175)},'adj_discount':{'$sum':_0x29a024(0x1ca)},'products':{'$push':{'qty':_0x29a024(0x101),'category':_0x29a024(0x199),'brand':_0x29a024(0x1a0),'product_details':_0x29a024(0xf3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x10fd63=[],_0xe38481={},_0x2e327a={},_0x3bb4f5={};var _0x2a5d0b=0x0,_0x319bef=0x0,_0xa473b9=0x0,_0x571947=0x0,_0x42c524=0x0;const _0x141e3b=0x9184e72a000;for(let _0x280d12=0x0;_0x280d12<=_0x5e0e9c[_0x29a024(0x1f7)]-0x1;_0x280d12++){const _0x4d5308=_0x5e0e9c[_0x280d12];let _0x2ec4ec=_0x29a024(0xbf);_0x2ec4ec+=_0x29a024(0x108)+_0x4d5308[_0x29a024(0x18a)][_0x29a024(0x21b)]+_0x29a024(0xd2),_0x2ec4ec+=_0x29a024(0x108)+_0x4d5308[_0x29a024(0x18a)][_0x29a024(0x114)]+_0x29a024(0xd2),_0x2ec4ec+=_0x29a024(0x108)+_0x4d5308['_id'][_0x29a024(0x128)]+'</td>';let _0x37995b={};var _0x3aa4bd=0x0;for(let _0x38dffb=0x0;_0x38dffb<=_0x4d5308[_0x29a024(0xed)][_0x29a024(0x1f7)]-0x1;_0x38dffb++){const _0x2dfe04=_0x4d5308[_0x29a024(0xed)][_0x38dffb];_0x37995b[_0x2dfe04[_0x29a024(0x1cd)]+'-'+_0x2dfe04[_0x29a024(0x210)]]=_0x2dfe04['qty'];const _0x396044=_0x2dfe04[_0x29a024(0x1cd)]+'-'+_0x2dfe04[_0x29a024(0x210)];!_0xe38481[_0x396044]&&(_0xe38481[_0x396044]=0x0),!Array[_0x29a024(0x1ea)](_0x3bb4f5[_0x396044])&&(_0x3bb4f5[_0x396044]=[]),!Array[_0x29a024(0x1ea)](_0x3bb4f5[_0x396044])&&(_0x3bb4f5[_0x396044]=[]),_0xe38481[_0x396044]+=_0x2dfe04[_0x29a024(0x16d)],_0x3bb4f5[_0x396044]['push'](_0x2dfe04[_0x29a024(0x16d)]),_0x3aa4bd++;}for(let _0x557907=0x0;_0x557907<=_0x124a7f['cat_brand']['length']-0x1;_0x557907++){const _0x49f71e=_0x124a7f['cat_brand'][_0x557907],_0xb8163=_0x49f71e[_0x29a024(0x18a)]['brand']+'-'+_0x49f71e[_0x29a024(0x18a)][_0x29a024(0x210)];_0x2ec4ec+=_0x29a024(0x1ad)+(_0x37995b[_0xb8163]!==undefined?_0x37995b[_0xb8163][_0x29a024(0x1c2)](0x2):'')+_0x29a024(0xd2);}_0xa473b9=_0x4d5308[_0x29a024(0x20c)]+_0x4d5308[_0x29a024(0xc4)],_0x2ec4ec+=_0x29a024(0x142)+formatNumber(parseFloat(_0x4d5308['totalQty'],0x2)[_0x29a024(0x1c2)](0x2))+_0x29a024(0xd2),_0x2ec4ec+=_0x29a024(0x142)+formatNumber(_0x4d5308[_0x29a024(0x22f)][_0x29a024(0x1c2)](0x2))+'</td>',_0x2ec4ec+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xa473b9)+_0x29a024(0xd2),_0x2ec4ec+=_0x29a024(0x142)+formatNumber(_0x4d5308[_0x29a024(0xb5)][_0x29a024(0x1c2)](0x2))+'</td>',_0x2ec4ec+='</tr>',_0x2a5d0b+=parseFloat(_0x4d5308[_0x29a024(0x12a)][_0x29a024(0x1c2)](0x2)),_0x319bef+=parseFloat(_0x4d5308[_0x29a024(0xb5)][_0x29a024(0x1c2)](0x2)),_0x571947+=_0xa473b9,_0x42c524+=parseFloat(_0x4d5308[_0x29a024(0x22f)][_0x29a024(0x1c2)](0x2));if(_0x280d12==_0x5e0e9c[_0x29a024(0x1f7)]-0x1){_0x2ec4ec+='<tr>',_0x2ec4ec+=_0x29a024(0x1a5),_0x2ec4ec+=_0x29a024(0xd2);for(let _0x546717=0x0;_0x546717<=_0x124a7f['cat_brand'][_0x29a024(0x1f7)]-0x1;_0x546717++){const _0x2a4e01=_0x124a7f[_0x29a024(0x1d9)][_0x546717],_0x1e72de=_0x2a4e01[_0x29a024(0x18a)][_0x29a024(0x1cd)]+'-'+_0x2a4e01[_0x29a024(0x18a)]['category'];!_0x3bb4f5[_0x1e72de]&&(_0x3bb4f5[_0x1e72de]=[]);const _0x4f81b3=_0x3bb4f5[_0x1e72de][_0x29a024(0x115)]((_0x2fe50d,_0x57735d)=>_0x2fe50d+_0x57735d,0x0);_0x2ec4ec+=_0x29a024(0x1ec)+(_0x4f81b3!==undefined?formatNumber(_0x4f81b3[_0x29a024(0x1c2)](0x2)):'')+_0x29a024(0x126);}_0x2ec4ec+=_0x29a024(0x19c)+formatNumber(_0x2a5d0b[_0x29a024(0x1c2)](0x2))+'</b></td>',_0x2ec4ec+=_0x29a024(0x19c)+formatNumber(_0x42c524)+'</b></td>',_0x2ec4ec+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x571947)+_0x29a024(0x126),_0x2ec4ec+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x319bef)+_0x29a024(0x126),_0x2ec4ec+='</tr>';}_0x10fd63[_0x29a024(0x120)](_0x2ec4ec);}function _0x4de986(_0x20c22b,_0x464f0e){const _0x8b0194=_0x29a024,_0x308fee=[];for(let _0x1bc1bd=0x0;_0x1bc1bd<=_0x20c22b[_0x8b0194(0x1f7)]-0x1;_0x1bc1bd+=_0x464f0e){_0x308fee[_0x8b0194(0x120)](_0x20c22b['slice'](_0x1bc1bd,_0x1bc1bd+_0x464f0e));}return _0x308fee;}const _0xe0125a=_0x4de986(_0x10fd63,_0x141e3b);let _0x4406db='';return _0xe0125a[_0x29a024(0xf8)]((_0x3bebe7,_0x493af8)=>{const _0x28ea98=_0x29a024;_0x493af8>0x0&&(_0x4406db+=_0x28ea98(0x160));_0x4406db+='<table>',_0x4406db+='<thead>',_0x4406db+=_0x28ea98(0xbf),_0x4406db+=_0x28ea98(0x205),_0x4406db+=_0x28ea98(0x137),_0x4406db+='<tr>',_0x4406db+=_0x28ea98(0x153);for(let _0x3313af=0x0;_0x3313af<=_0x8eb211[_0x28ea98(0x1f7)]-0x1;_0x3313af++){const _0x103296=_0x8eb211[_0x3313af];for(let _0x575068=0x0;_0x575068<_0x58ebfa['length'];_0x575068++){const _0x201d68=_0x58ebfa[_0x575068];_0x201d68[_0x28ea98(0x18a)]===_0x103296[_0x28ea98(0x18a)][_0x28ea98(0x210)]&&(_0x4406db+=_0x28ea98(0x185)+_0x201d68[_0x28ea98(0xa7)]+_0x28ea98(0x15b)+_0x103296[_0x28ea98(0x18a)][_0x28ea98(0x210)]+_0x28ea98(0xd2));}}_0x4406db+=_0x28ea98(0x231),_0x4406db+=_0x28ea98(0x137),_0x4406db+=_0x28ea98(0xbf),_0x4406db+=_0x28ea98(0x1aa),_0x4406db+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x4406db+=_0x28ea98(0xe8);for(let _0x35db5f=0x0;_0x35db5f<=_0x8eb211[_0x28ea98(0x1f7)]-0x1;_0x35db5f++){const _0x3c3535=_0x8eb211[_0x35db5f];for(let _0x588692=0x0;_0x588692<_0x124a7f[_0x28ea98(0x1d9)]['length'];_0x588692++){const _0x120f99=_0x124a7f[_0x28ea98(0x1d9)][_0x588692];_0x120f99[_0x28ea98(0x18a)]['category']===_0x3c3535[_0x28ea98(0x18a)][_0x28ea98(0x210)]&&(_0x4406db+='<td\x20class=\x22cat_data\x22>'+_0x120f99['_id'][_0x28ea98(0x1cd)]+'</td>');}}_0x4406db+=_0x28ea98(0xb0),_0x4406db+=_0x28ea98(0xa2),_0x4406db+=_0x28ea98(0x192),_0x4406db+=_0x28ea98(0xee),_0x4406db+=_0x28ea98(0x137),_0x4406db+=_0x28ea98(0x180),_0x4406db+=_0x28ea98(0x215),_0x3bebe7[_0x28ea98(0xf8)](_0xcd4d31=>{_0x4406db+=_0xcd4d31;}),console[_0x28ea98(0x149)](_0x3bb4f5),_0x4406db+=_0x28ea98(0x211),_0x4406db+=_0x28ea98(0x1f0);}),_0x4406db;}function a0_0x558a(_0x104de4,_0x5dfe14){const _0x3cb35b=a0_0x3cb3();return a0_0x558a=function(_0x558a9b,_0x427a38){_0x558a9b=_0x558a9b-0xa0;let _0x478e2d=_0x3cb35b[_0x558a9b];return _0x478e2d;},a0_0x558a(_0x104de4,_0x5dfe14);}router[a0_0x28f363(0x112)](a0_0x28f363(0x14c),auth,async(_0x3e2f75,_0x2f49a8)=>{const _0x4bc0dd=a0_0x28f363,{from_date:_0x5cdbed,to_date:_0x4ca727,isExcel:_0xcb052c}=_0x3e2f75[_0x4bc0dd(0x15d)],_0x39c0bc=_0x3e2f75[_0x4bc0dd(0x187)],_0x1e86d7=await staff[_0x4bc0dd(0xc0)]({'email':_0x39c0bc[_0x4bc0dd(0x208)]}),_0x444aec=await master_shop[_0x4bc0dd(0x155)](),_0x11f25a=await agentsdataDSICheck(_0x5cdbed,_0x4ca727,_0x1e86d7[_0x4bc0dd(0x18a)][_0x4bc0dd(0x121)](),_0xcb052c),_0x2a8f51=await agentsdataDSICheck_excel(_0x5cdbed,_0x4ca727,_0x1e86d7[_0x4bc0dd(0x18a)][_0x4bc0dd(0x121)](),_0xcb052c);let _0x394263=_0x4bc0dd(0x103);var _0x570c94=new Date(_0x5cdbed),_0x5e7ec0=new Date(_0x4ca727);const _0x44d96b={'year':_0x4bc0dd(0x1bc),'month':_0x4bc0dd(0x134),'day':'numeric'},_0x228a34=new Intl[(_0x4bc0dd(0xcf))](_0x4bc0dd(0x10f),_0x44d96b)[_0x4bc0dd(0xdf)](_0x570c94),_0x1ddda7=new Intl[(_0x4bc0dd(0xcf))](_0x4bc0dd(0x10f),_0x44d96b)[_0x4bc0dd(0xdf)](_0x5e7ec0);_0x394263+=_0x4bc0dd(0x13e),_0x394263+=_0x4bc0dd(0x1b2),_0x394263+=_0x4bc0dd(0x1b5),_0x394263+=_0x11f25a,_0x394263+=_0x4bc0dd(0x1f0),_0x394263+=_0x4bc0dd(0x19e),_0x394263+=_0x4bc0dd(0x19e);let _0x2f61b3=_0x4bc0dd(0x103);_0x2f61b3+=_0x4bc0dd(0x13e),_0x2f61b3+=_0x4bc0dd(0x1b2),_0x2f61b3+='<table>',_0x2f61b3+=_0x2a8f51,_0x2f61b3+='</table>',_0x2f61b3+='</div>',_0x2f61b3+=_0x4bc0dd(0x19e);let _0xea5426='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0xa5e015={'width':_0x4bc0dd(0x1c0),'height':'8.5in','orientation':_0x4bc0dd(0x1e6),'border':{'top':_0x4bc0dd(0xd9),'right':_0x4bc0dd(0xd9),'bottom':_0x4bc0dd(0xd9),'left':'0.1in'},'header':{'height':_0x4bc0dd(0x119),'contents':_0x4bc0dd(0x11d)+_0xea5426+_0x4bc0dd(0x222)+_0x228a34+'\x20-\x20'+_0x1ddda7+_0x4bc0dd(0x1a9)},'footer':{'height':_0x4bc0dd(0x1c1),'contents':{'default':_0x4bc0dd(0x221)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0xcb052c=='on'){const _0x49ce40=cheerio[_0x4bc0dd(0xa8)](_0x2f61b3);let _0x40b5ed=[],_0x264cea=[],_0xe62dc6=[];const _0xa20b36=_0xe308d1=>{const _0x4c1ca6=_0x4bc0dd,_0x7dacf7={'top':{'style':_0x4c1ca6(0x10c),'color':{'rgb':_0x4c1ca6(0x1e4)}},'bottom':{'style':_0x4c1ca6(0x10c),'color':{'rgb':_0x4c1ca6(0x1e4)}},'left':{'style':_0x4c1ca6(0x10c),'color':{'rgb':'000000'}},'right':{'style':_0x4c1ca6(0x10c),'color':{'rgb':'000000'}}};if(_0xe308d1){const _0x405834=_0xe308d1['split'](';')['reduce']((_0x1255cb,_0x42c7dc)=>{const _0x2d1d64=_0x4c1ca6,[_0xa431f3,_0x397fcf]=_0x42c7dc[_0x2d1d64(0xd8)](':')[_0x2d1d64(0x1f3)](_0x2b8b06=>_0x2b8b06[_0x2d1d64(0x162)]());return _0x1255cb[_0xa431f3]=_0x397fcf,_0x1255cb;},{});_0x405834['border-top']&&(_0x7dacf7[_0x4c1ca6(0xab)]['style']=_0x405834[_0x4c1ca6(0xfe)][_0x4c1ca6(0x219)](_0x4c1ca6(0x147))?_0x4c1ca6(0x147):'medium'),_0x405834[_0x4c1ca6(0x19a)]&&(_0x7dacf7[_0x4c1ca6(0x19b)][_0x4c1ca6(0x19f)]=_0x405834[_0x4c1ca6(0x19a)]['includes'](_0x4c1ca6(0x147))?_0x4c1ca6(0x147):_0x4c1ca6(0xa3)),_0x405834['border-left']&&(_0x7dacf7[_0x4c1ca6(0x13b)][_0x4c1ca6(0x19f)]=_0x405834['border-left'][_0x4c1ca6(0x219)](_0x4c1ca6(0x147))?_0x4c1ca6(0x147):_0x4c1ca6(0xa3)),_0x405834[_0x4c1ca6(0xe2)]&&(_0x7dacf7[_0x4c1ca6(0x1e9)]['style']=_0x405834[_0x4c1ca6(0xe2)][_0x4c1ca6(0x219)](_0x4c1ca6(0x147))?_0x4c1ca6(0x147):_0x4c1ca6(0xa3));}return _0x7dacf7;};_0x49ce40(_0x4bc0dd(0xe7))[_0x4bc0dd(0x133)]((_0x556328,_0x11972e)=>{const _0x43ae31=_0x4bc0dd;let _0x1749b6=[],_0x3d812a=0x0;while(_0xe62dc6[_0x3d812a]){_0xe62dc6[_0x3d812a]--,_0x3d812a++;}_0x49ce40(_0x11972e)['find'](_0x43ae31(0x1bf))[_0x43ae31(0x133)]((_0x3fffac,_0x91a392)=>{const _0x12bede=_0x43ae31;let _0xda3919=_0x49ce40(_0x91a392)['text']()[_0x12bede(0x162)](),_0x14b380=parseFloat(_0xda3919[_0x12bede(0xe1)](/,/g,'')),_0x469eee={};!isNaN(_0x14b380)?(_0x469eee['v']=_0x14b380,_0x469eee['t']='n'):(_0x469eee['v']=_0xda3919,_0x469eee['t']='s');const _0x12dba7=_0x49ce40(_0x91a392)[_0x12bede(0xae)](_0x12bede(0x19f)),_0x10af67=_0xa20b36(_0x12dba7);_0x469eee['s']={'border':_0x10af67},_0x1749b6[_0x3d812a]=_0x469eee;let _0x54740f=parseInt(_0x49ce40(_0x91a392)[_0x12bede(0xae)](_0x12bede(0x161)))||0x1,_0x35c816=parseInt(_0x49ce40(_0x91a392)[_0x12bede(0xae)](_0x12bede(0x17f)))||0x1;(_0x54740f>0x1||_0x35c816>0x1)&&_0x264cea[_0x12bede(0x120)]({'s':{'r':_0x556328,'c':_0x3d812a},'e':{'r':_0x556328+_0x35c816-0x1,'c':_0x3d812a+_0x54740f-0x1}});for(let _0x2daa35=0x0;_0x2daa35<_0x54740f;_0x2daa35++){_0x35c816>0x1&&(_0xe62dc6[_0x3d812a+_0x2daa35]=_0x35c816-0x1);}_0x3d812a+=_0x54740f;}),_0x40b5ed[_0x43ae31(0x120)](_0x1749b6);});const _0xa8d5d3=XLSX[_0x4bc0dd(0x21a)][_0x4bc0dd(0x189)](),_0x5d0b3b=XLSX['utils'][_0x4bc0dd(0x17d)](_0x40b5ed);_0x264cea[_0x4bc0dd(0x1f7)]>0x0&&(_0x5d0b3b[_0x4bc0dd(0x1b1)]=_0x264cea);_0x5d0b3b['!cols']=_0x40b5ed[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x4bc0dd(0x21a)]['book_append_sheet'](_0xa8d5d3,_0x5d0b3b,_0x4bc0dd(0x1e7));const _0x2798b3=XLSX[_0x4bc0dd(0x1e0)](_0xa8d5d3,{'bookType':_0x4bc0dd(0xe4),'type':_0x4bc0dd(0xf9)});_0x2f49a8['setHeader'](_0x4bc0dd(0x123),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x2f49a8['setHeader'](_0x4bc0dd(0x1f5),_0x4bc0dd(0x1c9)),_0x2f49a8['send'](_0x2798b3);}else pdf['create'](_0x394263,_0xa5e015)[_0x4bc0dd(0x202)](function(_0x5b7aee,_0x3b0c72){const _0x4ff1f0=_0x4bc0dd;if(_0x5b7aee){console['error'](_0x4ff1f0(0x1af),_0x5b7aee),_0x2f49a8[_0x4ff1f0(0x143)](0x1f4)[_0x4ff1f0(0x16c)](_0x4ff1f0(0xcb)+_0x5b7aee);return;}_0x2f49a8[_0x4ff1f0(0x1ae)]('Content-Type',_0x4ff1f0(0x1b6)),_0x3b0c72[_0x4ff1f0(0x232)](_0x2f49a8);});}),router[a0_0x28f363(0x158)](a0_0x28f363(0xaa),auth,async(_0x279345,_0x2fc33d)=>{const _0x4f4b78=a0_0x28f363;try{const {username:_0x2bc41c,email:_0x3e4846,role:_0x5122d1}=_0x279345[_0x4f4b78(0x187)],_0xb7e87d=_0x279345[_0x4f4b78(0x187)],_0x380d3f=await profile[_0x4f4b78(0xc0)]({'email':_0xb7e87d['email']}),_0xa07e6f={'year':_0x4f4b78(0x1bc),'month':_0x4f4b78(0x134),'day':_0x4f4b78(0x1bc)},_0x3a583a=await master_shop[_0x4f4b78(0x155)](),_0x2c32b6=await product['find'](),_0x2e9e21=await warehouse[_0x4f4b78(0xe9)]([{'$unwind':_0x4f4b78(0xf3)},{'$lookup':{'from':_0x4f4b78(0xed),'localField':_0x4f4b78(0xce),'foreignField':_0x4f4b78(0x15e),'as':_0x4f4b78(0xf0)}},{'$unwind':_0x4f4b78(0xf7)},{'$project':{'product_name':_0x4f4b78(0x1d1),'product_stock':_0x4f4b78(0x125)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x4f4b78(0x1eb)}}}]),_0x5bbb29=await staff[_0x4f4b78(0xc0)]({'email':_0xb7e87d[_0x4f4b78(0x208)]});if(_0x3a583a[0x0][_0x4f4b78(0x12b)]=='English\x20(US)')var _0x495a3b=users[_0x4f4b78(0x1fc)];else{if(_0x3a583a[0x0]['language']=='Hindi')var _0x495a3b=users[_0x4f4b78(0x195)];else{if(_0x3a583a[0x0]['language']==_0x4f4b78(0xdc))var _0x495a3b=users[_0x4f4b78(0xdc)];else{if(_0x3a583a[0x0][_0x4f4b78(0x12b)]==_0x4f4b78(0x204))var _0x495a3b=users[_0x4f4b78(0x204)];else{if(_0x3a583a[0x0]['language']==_0x4f4b78(0xc2))var _0x495a3b=users[_0x4f4b78(0xc2)];else{if(_0x3a583a[0x0][_0x4f4b78(0x12b)]=='Portuguese\x20(BR)')var _0x495a3b=users[_0x4f4b78(0xad)];else{if(_0x3a583a[0x0][_0x4f4b78(0x12b)]=='Chinese')var _0x495a3b=users[_0x4f4b78(0x1a1)];else{if(_0x3a583a[0x0][_0x4f4b78(0x12b)]=='Arabic\x20(ae)')var _0x495a3b=users['Arabic'];}}}}}}}_0x2fc33d[_0x4f4b78(0x173)](_0x4f4b78(0xb6),{'success':_0x279345[_0x4f4b78(0x1c8)](_0x4f4b78(0xb4)),'errors':_0x279345[_0x4f4b78(0x1c8)](_0x4f4b78(0x21c)),'alldata':_0x2c32b6,'profile':_0x380d3f,'master_shop':_0x3a583a,'role':_0xb7e87d,'product_stock':_0x2e9e21,'language':_0x495a3b,'staff_arr':_0x5bbb29});}catch(_0x41aeac){}});async function dataSalesReports(_0x160242,_0x21b315,_0x549520){const _0x5cd36a=a0_0x28f363;let _0x3ae56b='';const _0x4ab030=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x160242,'$lte':_0x21b315},'sales_staff_id':_0x549520}},{'$unwind':_0x5cd36a(0x201)},{'$match':{'sale_product.isFG':'false'}},{'$group':{'_id':{'product_name':_0x5cd36a(0x136),'product_code':_0x5cd36a(0x13d)},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x1c89df=0x0,_0x3ac823=0x0;for(let _0x10a2bf=0x0;_0x10a2bf<=_0x4ab030[_0x5cd36a(0x1f7)]-0x1;_0x10a2bf++){const _0x13df55=_0x4ab030[_0x10a2bf];var _0x30cba0=_0x13df55[_0x5cd36a(0x183)][_0x5cd36a(0x1ff)](undefined),_0x2908c5=_0x13df55['sumqty'][_0x5cd36a(0x1ff)](undefined);_0x3ae56b+='<tr>',_0x3ae56b+='<td\x20class=\x22row_data\x22>'+_0x13df55[_0x5cd36a(0x18a)][_0x5cd36a(0x1e8)]+_0x5cd36a(0xd2),_0x3ae56b+=_0x5cd36a(0x178)+_0x13df55[_0x5cd36a(0x18a)]['product_name']+_0x5cd36a(0xd2),_0x3ae56b+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x13df55[_0x5cd36a(0x207)][_0x5cd36a(0x1c2)](0x2))+_0x5cd36a(0xd2),_0x3ae56b+=_0x5cd36a(0x178)+formatNumber(_0x13df55[_0x5cd36a(0x183)]['toFixed'](0x2))+_0x5cd36a(0xd2),_0x3ae56b+=_0x5cd36a(0x137),_0x1c89df+=parseFloat(_0x13df55[_0x5cd36a(0x207)]),_0x3ac823+=parseFloat(_0x13df55[_0x5cd36a(0x183)]);}var _0x53f9ff=_0x3ac823[_0x5cd36a(0x1ff)](undefined),_0x3a2140=_0x1c89df['toLocaleString'](undefined);return _0x3ae56b+='<tr>',_0x3ae56b+=_0x5cd36a(0x1e2),_0x3ae56b+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x1c89df[_0x5cd36a(0x1c2)](0x2))+_0x5cd36a(0x126),_0x3ae56b+=_0x5cd36a(0x163)+formatNumber(_0x3ac823['toFixed'](0x2))+_0x5cd36a(0x126),_0x3ae56b+=_0x5cd36a(0x137),_0x3ae56b;}router[a0_0x28f363(0x112)]('/total_sales_reports/pdf',auth,async(_0x7b7e9,_0x4ec597)=>{const _0x1cf568=a0_0x28f363;try{const {from_date:_0x360c1e,to_date:_0x4d945a,isExcel:_0x1cd3cf}=_0x7b7e9['body'],_0x1e7b26=_0x7b7e9[_0x1cf568(0x187)],_0xd1c373=await staff[_0x1cf568(0xc0)]({'email':_0x1e7b26[_0x1cf568(0x208)]});let _0x5d80b1='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x5a1e44=new Date(_0x360c1e),_0x3d12b3=new Date(_0x4d945a);const _0x4d30d9={'year':_0x1cf568(0x1bc),'month':_0x1cf568(0x134),'day':_0x1cf568(0x1bc)},_0x2c7a36=new Intl[(_0x1cf568(0xcf))](_0x1cf568(0x10f),_0x4d30d9)[_0x1cf568(0xdf)](_0x5a1e44),_0x10a73=new Intl['DateTimeFormat']('en-US',_0x4d30d9)[_0x1cf568(0xdf)](_0x3d12b3);var _0x3b44a4=await dataSalesReports(_0x360c1e,_0x4d945a,_0xd1c373[_0x1cf568(0x18a)][_0x1cf568(0x121)]());_0x5d80b1+=_0x1cf568(0x13e),_0x5d80b1+=_0x1cf568(0xde),_0x5d80b1+=_0x1cf568(0x1b5),_0x5d80b1+=_0x1cf568(0xbf),_0x5d80b1+=_0x1cf568(0x1b3),_0x5d80b1+=_0x1cf568(0x12e),_0x5d80b1+=_0x1cf568(0x135),_0x5d80b1+=_0x1cf568(0x1f6),_0x5d80b1+='<tr>',_0x5d80b1+=_0x3b44a4,_0x5d80b1+=_0x1cf568(0x137),_0x5d80b1+=_0x1cf568(0x19e),_0x5d80b1+=_0x1cf568(0x19e);let _0x1053e8=_0x1cf568(0x1ee);const _0x5b9f78={'width':_0x1cf568(0x1c0),'height':_0x1cf568(0xfc),'orientation':_0x1cf568(0x1e6),'border':{'top':'0.1in','right':_0x1cf568(0xd9),'bottom':_0x1cf568(0xd9),'left':_0x1cf568(0xd9)},'header':{'height':'60mm','contents':_0x1cf568(0x11d)+_0x1053e8+_0x1cf568(0xbb)+_0xd1c373[_0x1cf568(0x15e)]+_0x1cf568(0x1a7)+_0x2c7a36+_0x1cf568(0x146)+_0x10a73+_0x1cf568(0x1a9)},'footer':{'height':_0x1cf568(0x1c1),'contents':{'default':_0x1cf568(0x221)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x1cf568(0xe3)}}};if(_0x1cd3cf=='on'){const _0x1fdd23=cheerio['load'](_0x5d80b1);let _0x5734cd=[],_0x5dbf7c=[],_0x23db80=[];const _0x3d3ec1=_0x258d85=>{const _0x4d06e2=_0x1cf568,_0x55df9d={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0x4d06e2(0x10c),'color':{'rgb':_0x4d06e2(0x1e4)}},'left':{'style':'thick','color':{'rgb':_0x4d06e2(0x1e4)}},'right':{'style':_0x4d06e2(0x10c),'color':{'rgb':_0x4d06e2(0x1e4)}}};if(_0x258d85){const _0x3ec410=_0x258d85[_0x4d06e2(0xd8)](';')[_0x4d06e2(0x115)]((_0x57cd80,_0xfd7888)=>{const _0x34087b=_0x4d06e2,[_0x5e40f7,_0x1ccf70]=_0xfd7888['split'](':')['map'](_0x5140f4=>_0x5140f4[_0x34087b(0x162)]());return _0x57cd80[_0x5e40f7]=_0x1ccf70,_0x57cd80;},{});_0x3ec410[_0x4d06e2(0xfe)]&&(_0x55df9d[_0x4d06e2(0xab)][_0x4d06e2(0x19f)]=_0x3ec410[_0x4d06e2(0xfe)]['includes']('thin')?_0x4d06e2(0x147):'medium'),_0x3ec410[_0x4d06e2(0x19a)]&&(_0x55df9d['bottom'][_0x4d06e2(0x19f)]=_0x3ec410[_0x4d06e2(0x19a)][_0x4d06e2(0x219)]('thin')?_0x4d06e2(0x147):_0x4d06e2(0xa3)),_0x3ec410[_0x4d06e2(0x212)]&&(_0x55df9d[_0x4d06e2(0x13b)][_0x4d06e2(0x19f)]=_0x3ec410[_0x4d06e2(0x212)][_0x4d06e2(0x219)]('thin')?_0x4d06e2(0x147):'medium'),_0x3ec410[_0x4d06e2(0xe2)]&&(_0x55df9d['right'][_0x4d06e2(0x19f)]=_0x3ec410['border-right'][_0x4d06e2(0x219)]('thin')?_0x4d06e2(0x147):_0x4d06e2(0xa3));}return _0x55df9d;};_0x1fdd23(_0x1cf568(0xe7))['each']((_0x54656d,_0x1e80a4)=>{const _0x2a6d12=_0x1cf568;let _0x5bd73c=[],_0x413c0c=0x0;while(_0x23db80[_0x413c0c]){_0x23db80[_0x413c0c]--,_0x413c0c++;}_0x1fdd23(_0x1e80a4)['find']('td,\x20th')[_0x2a6d12(0x133)]((_0x17898b,_0x199616)=>{const _0x345f01=_0x2a6d12;let _0x32f5ff=_0x1fdd23(_0x199616)[_0x345f01(0x1fa)]()['trim'](),_0x577dbc=parseFloat(_0x32f5ff[_0x345f01(0xe1)](/,/g,'')),_0x79d585={};!isNaN(_0x577dbc)?(_0x79d585['v']=_0x577dbc,_0x79d585['t']='n'):(_0x79d585['v']=_0x32f5ff,_0x79d585['t']='s');const _0x58db28=_0x1fdd23(_0x199616)[_0x345f01(0xae)](_0x345f01(0x19f)),_0x4c3751=_0x3d3ec1(_0x58db28);_0x79d585['s']={'border':_0x4c3751},_0x5bd73c[_0x413c0c]=_0x79d585;let _0x3a6928=parseInt(_0x1fdd23(_0x199616)['attr'](_0x345f01(0x161)))||0x1,_0x91f5c7=parseInt(_0x1fdd23(_0x199616)[_0x345f01(0xae)](_0x345f01(0x17f)))||0x1;(_0x3a6928>0x1||_0x91f5c7>0x1)&&_0x5dbf7c[_0x345f01(0x120)]({'s':{'r':_0x54656d,'c':_0x413c0c},'e':{'r':_0x54656d+_0x91f5c7-0x1,'c':_0x413c0c+_0x3a6928-0x1}});for(let _0x4ca1e7=0x0;_0x4ca1e7<_0x3a6928;_0x4ca1e7++){_0x91f5c7>0x1&&(_0x23db80[_0x413c0c+_0x4ca1e7]=_0x91f5c7-0x1);}_0x413c0c+=_0x3a6928;}),_0x5734cd[_0x2a6d12(0x120)](_0x5bd73c);});const _0xff0467=XLSX[_0x1cf568(0x21a)]['book_new'](),_0x11e724=XLSX[_0x1cf568(0x21a)]['aoa_to_sheet'](_0x5734cd);_0x5dbf7c['length']>0x0&&(_0x11e724[_0x1cf568(0x1b1)]=_0x5dbf7c);_0x11e724[_0x1cf568(0x17a)]=_0x5734cd[0x0][_0x1cf568(0x1f3)](()=>({'wpx':0x64})),XLSX[_0x1cf568(0x21a)][_0x1cf568(0x22e)](_0xff0467,_0x11e724,_0x1cf568(0x1e7));const _0x3efc04=XLSX[_0x1cf568(0x1e0)](_0xff0467,{'bookType':_0x1cf568(0xe4),'type':_0x1cf568(0xf9)});_0x4ec597[_0x1cf568(0x1ae)](_0x1cf568(0x123),_0x1cf568(0x1db)),_0x4ec597[_0x1cf568(0x1ae)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x4ec597[_0x1cf568(0x16c)](_0x3efc04);}else pdf[_0x1cf568(0xa9)](_0x5d80b1,_0x5b9f78)[_0x1cf568(0x202)](function(_0x30a1a7,_0x5c802b){const _0x4bb3d0=_0x1cf568;if(_0x30a1a7){_0x4ec597[_0x4bb3d0(0x143)](0x1f4)[_0x4bb3d0(0x16c)](_0x4bb3d0(0xcb));return;}_0x4ec597[_0x4bb3d0(0x1ae)](_0x4bb3d0(0x1f5),'application/pdf'),_0x5c802b[_0x4bb3d0(0x232)](_0x4ec597);});}catch(_0x1e1be2){}}),router[a0_0x28f363(0x158)](a0_0x28f363(0x197),auth,async(_0x51931b,_0x1ae63c)=>{const _0x1f4a00=a0_0x28f363;try{const {username:_0x96dcb3,email:_0x11191c,role:_0x7f44ce}=_0x51931b['user'],_0x30bf68=_0x51931b[_0x1f4a00(0x187)],_0xd75cc6=await profile['findOne']({'email':_0x30bf68[_0x1f4a00(0x208)]}),_0x59a481={'year':_0x1f4a00(0x1bc),'month':'long','day':_0x1f4a00(0x1bc)},_0x256b95=await master_shop[_0x1f4a00(0x155)](),_0x3fd7c9=await product['find'](),_0x2c977e=await warehouse[_0x1f4a00(0xe9)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x1f4a00(0xed),'localField':'product_details.product_name','foreignField':_0x1f4a00(0x15e),'as':_0x1f4a00(0xf0)}},{'$unwind':_0x1f4a00(0xf7)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x1f4a00(0x1f2),'product_stock':{'$sum':_0x1f4a00(0x1eb)}}}]);if(_0x256b95[0x0][_0x1f4a00(0x12b)]=='English\x20(US)')var _0x2c478a=users[_0x1f4a00(0x1fc)];else{if(_0x256b95[0x0][_0x1f4a00(0x12b)]==_0x1f4a00(0x195))var _0x2c478a=users[_0x1f4a00(0x195)];else{if(_0x256b95[0x0][_0x1f4a00(0x12b)]==_0x1f4a00(0xdc))var _0x2c478a=users[_0x1f4a00(0xdc)];else{if(_0x256b95[0x0]['language']=='Spanish')var _0x2c478a=users[_0x1f4a00(0x204)];else{if(_0x256b95[0x0][_0x1f4a00(0x12b)]==_0x1f4a00(0xc2))var _0x2c478a=users[_0x1f4a00(0xc2)];else{if(_0x256b95[0x0][_0x1f4a00(0x12b)]==_0x1f4a00(0xe5))var _0x2c478a=users[_0x1f4a00(0xad)];else{if(_0x256b95[0x0]['language']==_0x1f4a00(0x1a1))var _0x2c478a=users['Chinese'];else{if(_0x256b95[0x0]['language']==_0x1f4a00(0x15f))var _0x2c478a=users[_0x1f4a00(0xb8)];}}}}}}}_0x1ae63c[_0x1f4a00(0x173)](_0x1f4a00(0x1d4),{'success':_0x51931b[_0x1f4a00(0x1c8)](_0x1f4a00(0xb4)),'errors':_0x51931b[_0x1f4a00(0x1c8)](_0x1f4a00(0x21c)),'alldata':_0x3fd7c9,'profile':_0xd75cc6,'master_shop':_0x256b95,'role':_0x30bf68,'product_stock':_0x2c977e,'language':_0x2c478a});}catch(_0x54d95a){}});async function dataInventoryReports(_0x43afc6,_0xf2c0ad,_0x4a0477){const _0x5642f1=a0_0x28f363,_0x40376e=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x43afc6,'$lte':_0xf2c0ad},'sales_staff_id':_0x4a0477}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x53ae52=mongoose[_0x5642f1(0x198)][_0x5642f1(0xaf)],_0x525256=await staff[_0x5642f1(0xe9)]([{'$match':{'_id':_0x53ae52(_0x4a0477)}},{'$unwind':_0x5642f1(0x181)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':'$product_list.product_name','product_code':'$product_list.product_code'},'sumqty':{'$sum':_0x5642f1(0x140)}}},{'$sort':{'_id.product_name':0x1}}]),_0x571395=await sales_inv_data[_0x5642f1(0xe9)]([{'$match':{'date':{'$gte':_0x43afc6,'$lte':_0xf2c0ad},'sales_staff_id':_0x4a0477}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x5642f1(0x136),'product_code':_0x5642f1(0x13d)},'totalQTYsum':{'$sum':_0x5642f1(0x22b)}}}]);console['log'](_0x571395);let _0x3ada64='';var _0x4c2e42=0x0;for(let _0x796045=0x0;_0x796045<=_0x525256[_0x5642f1(0x1f7)]-0x1;_0x796045++){const _0x1d33b4=_0x525256[_0x796045];_0x3ada64+=_0x5642f1(0xbf),_0x3ada64+=_0x5642f1(0x20d)+_0x1d33b4[_0x5642f1(0x18a)]['product_code']+_0x5642f1(0xd2),_0x3ada64+=_0x5642f1(0xd0)+_0x1d33b4[_0x5642f1(0x18a)][_0x5642f1(0x1df)]+_0x5642f1(0xd2);var _0x4dc4b5=_0x1d33b4[_0x5642f1(0x207)],_0x2075d7=0x0;for(let _0x1c9da2=0x0;_0x1c9da2<=_0x40376e['length']-0x1;_0x1c9da2++){const _0x5a0feb=_0x40376e[_0x1c9da2];_0x1d33b4[_0x5642f1(0x18a)][_0x5642f1(0x1e8)]==_0x5a0feb['_id'][_0x5642f1(0x1e8)]&&_0x1d33b4[_0x5642f1(0x18a)][_0x5642f1(0x1df)]==_0x5a0feb[_0x5642f1(0x18a)][_0x5642f1(0x1df)]&&(_0x2075d7=_0x5a0feb[_0x5642f1(0x207)]);}var _0x29f85f=0x0;for(let _0x1a5884=0x0;_0x1a5884<=_0x571395[_0x5642f1(0x1f7)]-0x1;_0x1a5884++){const _0x510975=_0x571395[_0x1a5884];_0x1d33b4['_id'][_0x5642f1(0x1e8)]==_0x510975[_0x5642f1(0x18a)][_0x5642f1(0x1e8)]&&_0x1d33b4['_id'][_0x5642f1(0x1df)]==_0x510975[_0x5642f1(0x18a)]['product_name']&&(_0x29f85f=_0x510975[_0x5642f1(0x145)]);}_0x4c2e42=_0x4dc4b5-_0x29f85f+_0x2075d7,_0x3ada64+='<td\x20class=\x22row_data\x22>'+_0x4c2e42+_0x5642f1(0xd2);let _0x27ccd7=![];for(let _0x5919c9=0x0;_0x5919c9<=_0x571395['length']-0x1;_0x5919c9++){const _0x47c599=_0x571395[_0x5919c9];if(_0x1d33b4['_id'][_0x5642f1(0x1e8)]==_0x47c599[_0x5642f1(0x18a)][_0x5642f1(0x1e8)]&&_0x1d33b4[_0x5642f1(0x18a)][_0x5642f1(0x1df)]==_0x47c599[_0x5642f1(0x18a)][_0x5642f1(0x1df)]){_0x3ada64+=_0x5642f1(0x178)+_0x47c599[_0x5642f1(0x145)]+_0x5642f1(0xd2),_0x27ccd7=!![];break;}}!_0x27ccd7&&(_0x3ada64+=_0x5642f1(0xef));let _0x53974a=![];for(let _0x5020c7=0x0;_0x5020c7<=_0x40376e['length']-0x1;_0x5020c7++){const _0x4bf573=_0x40376e[_0x5020c7];if(_0x1d33b4[_0x5642f1(0x18a)][_0x5642f1(0x1e8)]==_0x4bf573[_0x5642f1(0x18a)]['product_code']&&_0x1d33b4[_0x5642f1(0x18a)]['product_name']==_0x4bf573['_id']['product_name']){_0x3ada64+=_0x5642f1(0x178)+_0x4bf573[_0x5642f1(0x207)]+_0x5642f1(0xd2),_0x53974a=!![];break;}}!_0x53974a&&(_0x3ada64+='<td\x20class=\x22row_data\x22>0</td>'),_0x3ada64+=_0x5642f1(0x178)+_0x1d33b4[_0x5642f1(0x207)]+'</td>',_0x3ada64+=_0x5642f1(0x137);}return _0x3ada64;}router[a0_0x28f363(0x112)]('/inventory_sum/pdf',auth,async(_0x12e4b4,_0x3bd87c)=>{const _0x169b5b=a0_0x28f363;try{const {from_date:_0x39126f,to_date:_0x353e7c}=_0x12e4b4[_0x169b5b(0x15d)],_0x480550=_0x12e4b4[_0x169b5b(0x187)],_0x350619=await staff[_0x169b5b(0xc0)]({'email':_0x480550[_0x169b5b(0x208)]});let _0x303974=_0x169b5b(0x1b9);var _0x4aab73=new Date(_0x39126f),_0xcd3500=new Date(_0x353e7c);const _0xeb7a35={'year':_0x169b5b(0x1bc),'month':'long','day':_0x169b5b(0x1bc)},_0x13c84b=new Intl[(_0x169b5b(0xcf))]('en-US',_0xeb7a35)[_0x169b5b(0xdf)](_0x4aab73),_0x2e766b=new Intl[(_0x169b5b(0xcf))](_0x169b5b(0x10f),_0xeb7a35)['format'](_0xcd3500);var _0x3b8f65=await dataInventoryReports(_0x39126f,_0x353e7c,_0x350619['_id'][_0x169b5b(0x121)]());_0x303974+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x303974+=_0x169b5b(0x152),_0x303974+=_0x169b5b(0x188)+_0x13c84b+_0x169b5b(0x146)+_0x2e766b+_0x169b5b(0x227),_0x303974+=_0x169b5b(0x13e),_0x303974+=_0x169b5b(0xde),_0x303974+='<table>',_0x303974+=_0x169b5b(0xbf),_0x303974+=_0x169b5b(0x1b3),_0x303974+=_0x169b5b(0x12e),_0x303974+=_0x169b5b(0xac),_0x303974+='<th>\x20INCOMING\x20</th>',_0x303974+=_0x169b5b(0x100),_0x303974+=_0x169b5b(0x230),_0x303974+=_0x169b5b(0xbf),_0x303974+=_0x3b8f65,_0x303974+=_0x169b5b(0x137),_0x303974+=_0x169b5b(0x19e),_0x303974+=_0x169b5b(0x19e);const _0x7439bf={'format':_0x169b5b(0x213),'orientation':_0x169b5b(0x1e6),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x169b5b(0xe3)}}};pdf[_0x169b5b(0xa9)](_0x303974,_0x7439bf)[_0x169b5b(0x202)](function(_0x8d1c7e,_0xffa3c5){const _0x16061d=_0x169b5b;if(_0x8d1c7e){_0x3bd87c[_0x16061d(0x143)](0x1f4)[_0x16061d(0x16c)](_0x16061d(0xcb));return;}_0x3bd87c[_0x16061d(0x1ae)](_0x16061d(0x1f5),_0x16061d(0x1b6)),_0xffa3c5[_0x16061d(0x232)](_0x3bd87c);});}catch(_0x22659b){}}),router['get'](a0_0x28f363(0xfa),auth,async(_0x34e4f1,_0x117044)=>{const _0x88c0f5=a0_0x28f363;try{const {username:_0x1d88a8,email:_0xfd6b69,role:_0x1b19b3}=_0x34e4f1[_0x88c0f5(0x187)],_0x30cf65=_0x34e4f1['user'],_0x16531d=await profile[_0x88c0f5(0xc0)]({'email':_0x30cf65[_0x88c0f5(0x208)]}),_0x158e0e={'year':_0x88c0f5(0x1bc),'month':'long','day':_0x88c0f5(0x1bc)},_0x32cd3c=await master_shop[_0x88c0f5(0x155)]();console['log']('Products\x20master',_0x32cd3c);const _0x24e9e3=await product['find']();console[_0x88c0f5(0x149)](_0x88c0f5(0x139),_0x24e9e3);const _0xc1ab03=await warehouse[_0x88c0f5(0xe9)]([{'$unwind':_0x88c0f5(0xf3)},{'$lookup':{'from':_0x88c0f5(0xed),'localField':_0x88c0f5(0xce),'foreignField':_0x88c0f5(0x15e),'as':_0x88c0f5(0xf0)}},{'$unwind':_0x88c0f5(0xf7)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x88c0f5(0x125)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x88c0f5(0x1eb)}}}]);console[_0x88c0f5(0x149)](_0x88c0f5(0x1ac),_0xc1ab03),_0xc1ab03['forEach'](_0x10af78=>{const _0xa4309c=_0x24e9e3['map'](_0x13c938=>{const _0x4f059e=a0_0x558a;_0x13c938['name']==_0x10af78[_0x4f059e(0x18a)]&&(_0x13c938[_0x4f059e(0x177)]=parseInt(_0x13c938[_0x4f059e(0x177)])+parseInt(_0x10af78[_0x4f059e(0x171)]));});});const _0xec7216=await staff['findOne']({'email':_0x30cf65[_0x88c0f5(0x208)]});if(_0x32cd3c[0x0][_0x88c0f5(0x12b)]==_0x88c0f5(0x11c))var _0x480e47=users[_0x88c0f5(0x1fc)];else{if(_0x32cd3c[0x0]['language']=='Hindi')var _0x480e47=users[_0x88c0f5(0x195)];else{if(_0x32cd3c[0x0][_0x88c0f5(0x12b)]=='German')var _0x480e47=users[_0x88c0f5(0xdc)];else{if(_0x32cd3c[0x0][_0x88c0f5(0x12b)]==_0x88c0f5(0x204))var _0x480e47=users['Spanish'];else{if(_0x32cd3c[0x0][_0x88c0f5(0x12b)]==_0x88c0f5(0xc2))var _0x480e47=users[_0x88c0f5(0xc2)];else{if(_0x32cd3c[0x0][_0x88c0f5(0x12b)]==_0x88c0f5(0xe5))var _0x480e47=users[_0x88c0f5(0xad)];else{if(_0x32cd3c[0x0][_0x88c0f5(0x12b)]==_0x88c0f5(0x1a1))var _0x480e47=users['Chinese'];else{if(_0x32cd3c[0x0][_0x88c0f5(0x12b)]==_0x88c0f5(0x15f))var _0x480e47=users[_0x88c0f5(0xb8)];}}}}}}}_0x117044['render']('dssr_view',{'success':_0x34e4f1['flash'](_0x88c0f5(0xb4)),'errors':_0x34e4f1[_0x88c0f5(0x1c8)](_0x88c0f5(0x21c)),'alldata':_0x24e9e3,'profile':_0x16531d,'master_shop':_0x32cd3c,'role':_0x30cf65,'product_stock':_0xc1ab03,'language':_0x480e47,'staff_arr':_0xec7216});}catch(_0x30e80d){}});async function agentsdataDSICheck_DSRR(_0x1eacfd,_0x35f0c9,_0x46a960,_0x35a338){const _0x57d3b2=a0_0x28f363;let _0x204839=new Date(_0x1eacfd);_0x204839[_0x57d3b2(0xb1)](_0x204839[_0x57d3b2(0x236)]()-0x1);let _0x2b33cc=_0x204839[_0x57d3b2(0x11a)]()[_0x57d3b2(0xd8)]('T')[0x0];const _0x36fc61=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':_0x57d3b2(0x1f9)},'products':{'$push':{'name':'$name','product_code':_0x57d3b2(0x217)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x443e4e=[];_0x443e4e[_0x57d3b2(0x1d9)]=[];for(let _0x485be0=0x0;_0x485be0<=_0x36fc61[_0x57d3b2(0x1f7)]-0x1;_0x485be0++){const _0x19ad57=_0x36fc61[_0x485be0];_0x443e4e[_0x57d3b2(0x1d9)][_0x57d3b2(0x120)](_0x19ad57);}const _0x91e432=await product[_0x57d3b2(0xe9)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x57d3b2(0x217),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x74c611=await product['aggregate']([{'$group':{'_id':{'category':_0x57d3b2(0x1f9),'brand':_0x57d3b2(0x16f)}}},{'$group':{'_id':_0x57d3b2(0x199),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x298758=await sales_sa[_0x57d3b2(0xe9)]([{'$match':{'date':_0x1eacfd,'sales_staff_id':_0x35f0c9,'sale_product.isFG':_0x57d3b2(0x226)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x57d3b2(0xed),'localField':_0x57d3b2(0xdb),'foreignField':'product_code','as':_0x57d3b2(0x105)}},{'$unwind':_0x57d3b2(0x151)},{'$group':{'_id':{'dsi':_0x57d3b2(0x131),'date':'$date','customer':_0x57d3b2(0x150),'status_data':_0x57d3b2(0x110)},'totalQty':{'$sum':_0x57d3b2(0x14d)},'cash':{'$first':_0x57d3b2(0x10a)},'amount':{'$first':_0x57d3b2(0x157)},'bank':{'$first':_0x57d3b2(0x122)},'check_no':{'$first':_0x57d3b2(0x18e)},'due_date':{'$first':_0x57d3b2(0x218)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x57d3b2(0x1c3),'discount':_0x57d3b2(0xda),'adj_discount':_0x57d3b2(0x1d3),'product_details':{'prod_name':'$product_info.name','product_code':_0x57d3b2(0x21e),'category':_0x57d3b2(0x106),'brand':_0x57d3b2(0x174),'gross_price':_0x57d3b2(0x1cf),'isFG':_0x57d3b2(0xfb),'prod_cat':'$sale_product.prod_cat','prod_id':'$sale_product._id'}}}}},{'$unwind':_0x57d3b2(0xf6)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x57d3b2(0x1ba),'customer':_0x57d3b2(0x1be),'status_data':_0x57d3b2(0x113),'category':_0x57d3b2(0x167),'brand':_0x57d3b2(0x223),'prod_id':_0x57d3b2(0x11f)},'totalQty':{'$sum':_0x57d3b2(0x20e)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x57d3b2(0x1a2)]}},'NetPrice':{'$sum':_0x57d3b2(0x1f1)},'discount':{'$sum':_0x57d3b2(0x224)},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x57d3b2(0x122)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':'$_id.customer','status_data':_0x57d3b2(0x113)},'totalQty':{'$sum':_0x57d3b2(0x101)},'totalGross':{'$sum':_0x57d3b2(0xe6)},'NetPrice':{'$sum':_0x57d3b2(0x118)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x57d3b2(0x1ca)},'cash':{'$first':_0x57d3b2(0x10a)},'amount':{'$first':'$amount'},'bank':{'$first':_0x57d3b2(0x122)},'check_no':{'$first':_0x57d3b2(0x18e)},'due_date':{'$first':_0x57d3b2(0x218)},'products':{'$push':{'qty':_0x57d3b2(0x101),'category':_0x57d3b2(0x199),'brand':_0x57d3b2(0x1a0),'product_details':_0x57d3b2(0xf3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x1adf6c=await sales_sa[_0x57d3b2(0xe9)]([{'$match':{'date':_0x2b33cc,'sales_staff_id':_0x35f0c9,'sale_product.isFG':_0x57d3b2(0x226)}},{'$unwind':_0x57d3b2(0x201)},{'$lookup':{'from':_0x57d3b2(0xed),'localField':_0x57d3b2(0xdb),'foreignField':'product_code','as':_0x57d3b2(0x105)}},{'$unwind':_0x57d3b2(0x151)},{'$group':{'_id':{'dsi':_0x57d3b2(0x131),'date':_0x57d3b2(0x225),'customer':'$customer'},'totalQty':{'$sum':_0x57d3b2(0x14d)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x57d3b2(0x122)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x57d3b2(0x1c3),'discount':_0x57d3b2(0xda),'adj_discount':_0x57d3b2(0x1d3),'product_details':{'prod_name':_0x57d3b2(0xd7),'product_code':_0x57d3b2(0x21e),'category':_0x57d3b2(0x106),'brand':'$product_info.brand','gross_price':_0x57d3b2(0x1cf),'isFG':_0x57d3b2(0xfb),'prod_cat':_0x57d3b2(0x165),'prod_id':_0x57d3b2(0x1bd)}}}}},{'$unwind':_0x57d3b2(0xf6)},{'$group':{'_id':{'dsi':_0x57d3b2(0x22d),'date':'$_id.date','customer':_0x57d3b2(0x1be),'category':_0x57d3b2(0x167),'brand':_0x57d3b2(0x223),'prod_id':_0x57d3b2(0x11f)},'totalQty':{'$sum':_0x57d3b2(0x20e)},'cash':{'$first':_0x57d3b2(0x10a)},'amount':{'$first':_0x57d3b2(0x157)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':{'$multiply':[_0x57d3b2(0x20e),_0x57d3b2(0x1a2)]}},'NetPrice':{'$sum':_0x57d3b2(0x1f1)},'discount':{'$sum':_0x57d3b2(0x224)},'adj_discount':{'$sum':_0x57d3b2(0x1d6)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x57d3b2(0x1be)},'totalQty':{'$sum':'$totalQty'},'cash':{'$first':_0x57d3b2(0x10a)},'amount':{'$first':_0x57d3b2(0x157)},'bank':{'$first':_0x57d3b2(0x122)},'check_no':{'$first':_0x57d3b2(0x18e)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':_0x57d3b2(0xe6)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x57d3b2(0x175)},'adj_discount':{'$sum':_0x57d3b2(0x1ca)},'products':{'$push':{'qty':_0x57d3b2(0x101),'category':_0x57d3b2(0x199),'brand':_0x57d3b2(0x1a0),'product_details':_0x57d3b2(0xf3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x4601ff=await sales_sa[_0x57d3b2(0xe9)]([{'$match':{'date':_0x1eacfd,'sales_staff_id':_0x35f0c9,'status_data':'true'}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x3ac427=await staff[_0x57d3b2(0x1b7)](_0x35f0c9);let _0xea9623=[],_0x3161f0={},_0x4bde96={};var _0x3b5789=0x0,_0x59bfda=0x0,_0x5123f3=0x0,_0x530fbb=0x0,_0x599a32=0x0;const _0x233a8e=0x6;var _0x5c7897=0x0,_0x4037ee=0x0;for(let _0x24d741=0x0;_0x24d741<=_0x298758['length']-0x1;_0x24d741++){const _0x4dab8e=_0x298758[_0x24d741];let _0xbaf9a4='<tr>';_0xbaf9a4+=_0x57d3b2(0xf4),_0xbaf9a4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4dab8e[_0x57d3b2(0x18a)][_0x57d3b2(0x128)]+_0x57d3b2(0xd2),_0xbaf9a4+=_0x57d3b2(0x108)+_0x4dab8e['_id']['dsi']+_0x57d3b2(0xd2);let _0x35c673={},_0x411b2e={},_0xdbbda7={};var _0x1aac74={},_0x5b1df0={},_0x444c15={},_0x193a39=0x0;for(let _0x5041a5=0x0;_0x5041a5<=_0x4dab8e['products']['length']-0x1;_0x5041a5++){const _0x5913cc=_0x4dab8e['products'][_0x5041a5];_0x35c673[_0x5913cc[_0x57d3b2(0x1cd)]+'-'+_0x5913cc[_0x57d3b2(0x210)]]=_0x5913cc[_0x57d3b2(0x16d)],_0x411b2e[[_0x5913cc[_0x57d3b2(0x1cd)]+'-'+_0x5913cc['category']]]=_0x5913cc[_0x57d3b2(0xc1)][_0x57d3b2(0xd1)],_0xdbbda7[[_0x5913cc[_0x57d3b2(0x1cd)]+'-'+_0x5913cc['category']]]=_0x5913cc[_0x57d3b2(0xc1)][_0x57d3b2(0x193)];const _0x28496d=_0x5913cc[_0x57d3b2(0x1cd)]+'-'+_0x5913cc[_0x57d3b2(0x210)];!Array['isArray'](_0x4bde96[_0x28496d])&&(_0x4bde96[_0x28496d]=[]);!Array[_0x57d3b2(0x1ea)](_0x4bde96[_0x28496d])&&(_0x4bde96[_0x28496d]=[]);_0x4bde96[_0x28496d][_0x57d3b2(0x120)](_0x5913cc[_0x57d3b2(0x16d)]);if(_0x5913cc['product_details'][_0x57d3b2(0x193)]=='P')_0x5913cc['product_details'][_0x57d3b2(0xd1)]==_0x57d3b2(0x21d)?(!_0x444c15[_0x28496d]&&(_0x444c15[_0x28496d]=0x0),_0x444c15[_0x28496d]=_0x5913cc[_0x57d3b2(0x16d)]):(!_0x1aac74[_0x28496d]&&(_0x1aac74[_0x28496d]=0x0),_0x1aac74[_0x28496d]=_0x5913cc[_0x57d3b2(0x16d)]);else _0x5913cc[_0x57d3b2(0xc1)]['prod_cat']=='S'&&(_0x5913cc[_0x57d3b2(0xc1)][_0x57d3b2(0xd1)]==_0x57d3b2(0x21d)?(!_0x444c15[_0x28496d]&&(_0x444c15[_0x28496d]=0x0),_0x444c15[_0x28496d]=_0x5913cc['qty']):(!_0x5b1df0[_0x28496d]&&(_0x5b1df0[_0x28496d]=0x0),_0x5b1df0[_0x28496d]=_0x5913cc[_0x57d3b2(0x16d)]));_0x193a39++;}for(let _0x6aec65=0x0;_0x6aec65<=_0x443e4e[_0x57d3b2(0x1d9)][_0x57d3b2(0x1f7)]-0x1;_0x6aec65++){const _0x354a5f=_0x443e4e['cat_brand'][_0x6aec65],_0x56ff54=_0x354a5f[_0x57d3b2(0x18a)][_0x57d3b2(0x1cd)]+'-'+_0x354a5f[_0x57d3b2(0x18a)][_0x57d3b2(0x210)],_0x436668=_0xdbbda7[_0x56ff54]!==undefined?_0xdbbda7[_0x56ff54]:'NA';var _0x4db81c=_0x1aac74[_0x56ff54]!==undefined?_0x1aac74[_0x56ff54][_0x57d3b2(0x1c2)](0x2):'',_0x4426b6=_0x5b1df0[_0x56ff54]!==undefined?_0x5b1df0[_0x56ff54][_0x57d3b2(0x1c2)](0x2):'',_0x2287d7=_0x444c15[_0x56ff54]!==undefined?_0x444c15[_0x56ff54]['toFixed'](0x2):'';_0xbaf9a4+=_0x57d3b2(0x1ad)+_0x4db81c+_0x57d3b2(0xd2),_0xbaf9a4+=_0x57d3b2(0x1ad)+_0x4426b6+_0x57d3b2(0xd2),_0xbaf9a4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x2287d7+_0x57d3b2(0xd2);}var _0x419e67=formatNumber(parseFloat(_0x4dab8e[_0x57d3b2(0x111)])),_0x648b70=formatNumber(parseFloat(_0x4dab8e[_0x57d3b2(0xa5)]));isNaN(_0x648b70)&&(_0x648b70=0x0),_0xbaf9a4+=_0x57d3b2(0x1ad)+_0x419e67+'</td>',_0xbaf9a4+=_0x57d3b2(0x1ad)+_0x648b70+'</td>',_0xbaf9a4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4dab8e[_0x57d3b2(0x102)]+_0x57d3b2(0xd2),_0xbaf9a4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4dab8e[_0x57d3b2(0x130)]+_0x57d3b2(0xd2),_0xbaf9a4+=_0x57d3b2(0x108)+_0x4dab8e['due_date']+_0x57d3b2(0xd2),_0x5123f3=_0x4dab8e['discount']+_0x4dab8e[_0x57d3b2(0xc4)],_0x5c7897+=parseFloat(_0x4dab8e[_0x57d3b2(0x111)]),_0x4037ee+=parseFloat(_0x648b70),_0xea9623['push'](_0xbaf9a4);}if(_0x4601ff[_0x57d3b2(0x1f7)]>0x0)for(let _0x90111b=0x0;_0x90111b<=_0x4601ff['length']-0x1;_0x90111b++){const _0x1c26ca=_0x4601ff[_0x90111b];console['log'](_0x1c26ca);let _0x5c9a42=_0x57d3b2(0xbf);_0x5c9a42+=_0x57d3b2(0x129)+(0x8+0x7*0x3)+_0x57d3b2(0x10e)+_0x1c26ca[_0x57d3b2(0x1f8)]+'</b></td>',_0x5c9a42+=_0x57d3b2(0x137),_0xea9623[_0x57d3b2(0x120)](_0x5c9a42);}function _0x2c4afd(_0x45f920,_0x5dca34){const _0x1ff501=_0x57d3b2,_0x3b2a15=[];for(let _0x175df7=0x0;_0x175df7<=_0x45f920[_0x1ff501(0x1f7)]-0x1;_0x175df7+=_0x5dca34){_0x3b2a15[_0x1ff501(0x120)](_0x45f920[_0x1ff501(0x22a)](_0x175df7,_0x175df7+_0x5dca34));}return _0x3b2a15;}const _0x3862a=_0x2c4afd(_0xea9623,_0x233a8e);let _0x587b4e='';return _0x3862a[_0x57d3b2(0xf8)]((_0x173de3,_0x1f5691)=>{const _0x3ed3bd=_0x57d3b2;_0x1f5691>0x0&&(_0x587b4e+=_0x3ed3bd(0x160));_0x587b4e+=_0x3ed3bd(0x1b5),_0x587b4e+=_0x3ed3bd(0x14f);const _0x867e01=new Date(_0x1eacfd),_0x2cdf05={'year':_0x3ed3bd(0x1bc),'month':_0x3ed3bd(0x134),'day':_0x3ed3bd(0x1bc),'timeZone':'Asia/Manila'},_0x492b61=_0x867e01[_0x3ed3bd(0x1c5)](_0x3ed3bd(0x10f),_0x2cdf05);_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x138)+_0x35a338+'</b></td>',_0x587b4e+='</tr>',_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x194)+_0x3ac427[_0x3ed3bd(0x15e)]+_0x3ed3bd(0xd2),_0x587b4e+=_0x3ed3bd(0x11b),_0x587b4e+=_0x3ed3bd(0x10d),_0x587b4e+=_0x3ed3bd(0x1da),_0x587b4e+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x587b4e+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x587b4e+=_0x3ed3bd(0x196),_0x587b4e+=_0x3ed3bd(0x1c7),_0x587b4e+='<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>',_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x1d2),_0x587b4e+=_0x3ed3bd(0xe0)+_0x492b61+_0x3ed3bd(0xd2),_0x587b4e+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>',_0x587b4e+=_0x3ed3bd(0x17e),_0x587b4e+=_0x3ed3bd(0x200),_0x587b4e+=_0x3ed3bd(0x200),_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+='<tr>',_0x587b4e+=_0x3ed3bd(0xb7),_0x587b4e+=_0x3ed3bd(0x1fe),_0x587b4e+=_0x3ed3bd(0xbe),_0x587b4e+=_0x3ed3bd(0x200),_0x587b4e+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x587b4e+='</tr>',_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x1d0),_0x587b4e+=_0x3ed3bd(0x216),_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x21f),_0x587b4e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x587b4e+=_0x3ed3bd(0xa1);for(let _0x292df6=0x0;_0x292df6<=_0x91e432['length']-0x1;_0x292df6++){const _0x4841a0=_0x91e432[_0x292df6];for(let _0xa5831b=0x0;_0xa5831b<_0x443e4e[_0x3ed3bd(0x1d9)]['length'];_0xa5831b++){const _0x2790ab=_0x443e4e[_0x3ed3bd(0x1d9)][_0xa5831b];if(_0x2790ab[_0x3ed3bd(0x18a)]['category']===_0x4841a0[_0x3ed3bd(0x18a)][_0x3ed3bd(0x210)]){var _0x35f137='';switch(_0x4841a0[_0x3ed3bd(0x18a)][_0x3ed3bd(0x210)]){case _0x3ed3bd(0x228):_0x35f137=_0x2790ab[_0x3ed3bd(0x18a)]['brand']+_0x3ed3bd(0x109);break;case'Household':_0x35f137=_0x2790ab[_0x3ed3bd(0x18a)][_0x3ed3bd(0x1cd)]+_0x3ed3bd(0x1ef);break;default:_0x35f137=_0x2790ab['_id'][_0x3ed3bd(0x1cd)];break;}_0x587b4e+=_0x3ed3bd(0x229)+_0x35f137+_0x3ed3bd(0x126);}}}_0x587b4e+=_0x3ed3bd(0x20b),_0x587b4e+=_0x3ed3bd(0xb2),_0x587b4e+=_0x3ed3bd(0xfd),_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x153);for(let _0xd07957=0x0;_0xd07957<=_0x443e4e['cat_brand'][_0x3ed3bd(0x1f7)]-0x1;_0xd07957++){const _0x336866=_0x443e4e[_0xd07957];_0x587b4e+=_0x3ed3bd(0x14e),_0x587b4e+=_0x3ed3bd(0x13a),_0x587b4e+=_0x3ed3bd(0x182);}_0x587b4e+=_0x3ed3bd(0x235),_0x587b4e+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>',_0x587b4e+=_0x3ed3bd(0x117),_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+=_0x3ed3bd(0x180),_0x587b4e+='<tbody>',_0x173de3[_0x3ed3bd(0xf8)](_0x31420f=>{_0x587b4e+=_0x31420f;});let _0x4f24ac={},_0x3af9b0={},_0x2904e1={};for(let _0xd5ee21=0x0;_0xd5ee21<=_0x298758[_0x3ed3bd(0x1f7)]-0x1;_0xd5ee21++){const _0x315067=_0x298758[_0xd5ee21];var _0x2748db=0x0;for(let _0xc2413a=0x0;_0xc2413a<=_0x315067[_0x3ed3bd(0xed)][_0x3ed3bd(0x1f7)]-0x1;_0xc2413a++){const _0x1891e3=_0x315067['products'][_0xc2413a],_0x219cee=_0x1891e3['brand']+'-'+_0x1891e3['category'];if(_0x1891e3['product_details'][_0x3ed3bd(0x193)]=='P')_0x1891e3[_0x3ed3bd(0xc1)][_0x3ed3bd(0xd1)]==_0x3ed3bd(0x21d)?(!_0x2904e1[_0x219cee]&&(_0x2904e1[_0x219cee]=0x0),_0x2904e1[_0x219cee]+=_0x1891e3[_0x3ed3bd(0x16d)]):(!_0x4f24ac[_0x219cee]&&(_0x4f24ac[_0x219cee]=0x0),_0x4f24ac[_0x219cee]+=_0x1891e3[_0x3ed3bd(0x16d)]);else _0x1891e3['product_details']['prod_cat']=='S'&&(_0x1891e3[_0x3ed3bd(0xc1)][_0x3ed3bd(0xd1)]==_0x3ed3bd(0x21d)?(!_0x2904e1[_0x219cee]&&(_0x2904e1[_0x219cee]=0x0),_0x2904e1[_0x219cee]+=_0x1891e3['qty'],console['log'](_0x1891e3[_0x3ed3bd(0x16d)])):(!_0x3af9b0[_0x219cee]&&(_0x3af9b0[_0x219cee]=0x0),_0x3af9b0[_0x219cee]+=_0x1891e3['qty']));_0x2748db++;}}let _0x941cae={},_0x562236={},_0x528bdb={};var _0x1762a9=0x0,_0xb31655=0x0;for(let _0x2abe85=0x0;_0x2abe85<=_0x1adf6c['length']-0x1;_0x2abe85++){const _0x4144f2=_0x1adf6c[_0x2abe85];var _0x2748db=0x0;for(let _0x26e2ab=0x0;_0x26e2ab<=_0x4144f2[_0x3ed3bd(0xed)][_0x3ed3bd(0x1f7)]-0x1;_0x26e2ab++){const _0x59f0d9=_0x4144f2[_0x3ed3bd(0xed)][_0x26e2ab],_0x50b46b=_0x59f0d9[_0x3ed3bd(0x1cd)]+'-'+_0x59f0d9['category'];if(_0x59f0d9[_0x3ed3bd(0xc1)][_0x3ed3bd(0x193)]=='P')_0x59f0d9[_0x3ed3bd(0xc1)][_0x3ed3bd(0xd1)]==_0x3ed3bd(0x21d)?(!_0x528bdb[_0x50b46b]&&(_0x528bdb[_0x50b46b]=0x0),_0x528bdb[_0x50b46b]+=_0x59f0d9['qty']):(!_0x941cae[_0x50b46b]&&(_0x941cae[_0x50b46b]=0x0),_0x941cae[_0x50b46b]+=_0x59f0d9[_0x3ed3bd(0x16d)]);else _0x59f0d9[_0x3ed3bd(0xc1)][_0x3ed3bd(0x193)]=='S'&&(_0x59f0d9[_0x3ed3bd(0xc1)]['isFG']==_0x3ed3bd(0x21d)?(!_0x528bdb[_0x50b46b]&&(_0x528bdb[_0x50b46b]=0x0),_0x528bdb[_0x50b46b]+=_0x59f0d9[_0x3ed3bd(0x16d)]):(!_0x562236[_0x50b46b]&&(_0x562236[_0x50b46b]=0x0),_0x562236[_0x50b46b]+=_0x59f0d9[_0x3ed3bd(0x16d)]));_0x2748db++;}var _0x44f73e=parseFloat(_0x4144f2[_0x3ed3bd(0x111)]),_0x58581e=parseFloat(_0x4144f2['amount']);isNaN(_0x58581e)&&(_0x58581e=0x0),_0x1762a9+=_0x44f73e,_0xb31655+=_0x58581e;}_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x587b4e+=_0x3ed3bd(0xf4);for(let _0x3a85fb=0x0;_0x3a85fb<=_0x443e4e[_0x3ed3bd(0x1d9)]['length']-0x1;_0x3a85fb++){const _0x53eedf=_0x443e4e[_0x3ed3bd(0x1d9)][_0x3a85fb],_0x496857=_0x53eedf[_0x3ed3bd(0x18a)][_0x3ed3bd(0x1cd)]+'-'+_0x53eedf[_0x3ed3bd(0x18a)][_0x3ed3bd(0x210)];var _0x5a779f=_0x4f24ac[_0x496857]!==undefined?formatNumber(_0x4f24ac[_0x496857][_0x3ed3bd(0x1c2)](0x2)):'',_0x38ec6a=_0x2904e1[_0x496857]!==undefined?formatNumber(_0x2904e1[_0x496857][_0x3ed3bd(0x1c2)](0x2)):'',_0x71481=_0x3af9b0[_0x496857]!==undefined?formatNumber(_0x3af9b0[_0x496857][_0x3ed3bd(0x1c2)](0x2)):'';_0x587b4e+=_0x3ed3bd(0x1ec)+_0x5a779f+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0x1ec)+_0x71481+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0x1ec)+_0x38ec6a+_0x3ed3bd(0x126);}_0x587b4e+=_0x3ed3bd(0x1ec)+formatNumber(_0x5c7897)+_0x3ed3bd(0x126),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4037ee)+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='</tr>',_0x587b4e+='<tr>',_0x587b4e+=_0x3ed3bd(0x1cb),_0x587b4e+=_0x3ed3bd(0x1b4),_0x587b4e+=_0x3ed3bd(0xf4);for(let _0x1286c7=0x0;_0x1286c7<=_0x443e4e[_0x3ed3bd(0x1d9)][_0x3ed3bd(0x1f7)]-0x1;_0x1286c7++){const _0x3731c1=_0x443e4e['cat_brand'][_0x1286c7],_0x4b38dc=_0x3731c1[_0x3ed3bd(0x18a)][_0x3ed3bd(0x1cd)]+'-'+_0x3731c1[_0x3ed3bd(0x18a)][_0x3ed3bd(0x210)];var _0x5a779f=_0x941cae[_0x4b38dc]!==undefined?formatNumber(_0x941cae[_0x4b38dc][_0x3ed3bd(0x1c2)](0x2)):'',_0x38ec6a=_0x528bdb[_0x4b38dc]!==undefined?formatNumber(_0x528bdb[_0x4b38dc][_0x3ed3bd(0x1c2)](0x2)):'',_0x71481=_0x562236[_0x4b38dc]!==undefined?formatNumber(_0x562236[_0x4b38dc]['toFixed'](0x2)):'';_0x587b4e+=_0x3ed3bd(0x1ec)+_0x5a779f+'</b></td>',_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x71481+'</b></td>',_0x587b4e+=_0x3ed3bd(0x1ec)+_0x38ec6a+_0x3ed3bd(0x126);}_0x587b4e+=_0x3ed3bd(0x1ec)+formatNumber(_0x1762a9)+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0x1ec)+formatNumber(_0xb31655)+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='</tr>',_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x1cb),_0x587b4e+=_0x3ed3bd(0x1d8),_0x587b4e+=_0x3ed3bd(0xf4);let _0x2a5017=0x0,_0x29a8b1=0x0,_0x15942a=0x0;for(let _0x2697d0=0x0;_0x2697d0<=_0x443e4e['cat_brand'][_0x3ed3bd(0x1f7)]-0x1;_0x2697d0++){const _0xa88ae9=_0x443e4e['cat_brand'][_0x2697d0],_0x26b445=_0xa88ae9[_0x3ed3bd(0x18a)]['brand']+'-'+_0xa88ae9[_0x3ed3bd(0x18a)][_0x3ed3bd(0x210)];var _0x2d7aa3=_0x4f24ac[_0x26b445]!==undefined?_0x4f24ac[_0x26b445][_0x3ed3bd(0x1c2)](0x2):'0',_0x17e8ca=_0x2904e1[_0x26b445]!==undefined?_0x2904e1[_0x26b445]['toFixed'](0x2):'0',_0xecf8e0=_0x3af9b0[_0x26b445]!==undefined?_0x3af9b0[_0x26b445][_0x3ed3bd(0x1c2)](0x2):'0',_0x4c9b83=_0x941cae[_0x26b445]!==undefined?_0x941cae[_0x26b445][_0x3ed3bd(0x1c2)](0x2):'0',_0x31f424=_0x528bdb[_0x26b445]!==undefined?_0x528bdb[_0x26b445][_0x3ed3bd(0x1c2)](0x2):'0',_0x26fcfb=_0x562236[_0x26b445]!==undefined?_0x562236[_0x26b445][_0x3ed3bd(0x1c2)](0x2):'0';_0x2a5017=parseFloat(_0x2d7aa3)+parseFloat(_0x4c9b83),_0x29a8b1=parseFloat(_0xecf8e0)+parseFloat(_0x26fcfb),_0x15942a=parseFloat(_0x17e8ca)+parseFloat(_0x31f424),_0x587b4e+=_0x3ed3bd(0x1ec)+formatNumber(_0x2a5017[_0x3ed3bd(0x1c2)](0x2))+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0x1ec)+formatNumber(_0x29a8b1[_0x3ed3bd(0x1c2)](0x2))+'</b></td>',_0x587b4e+=_0x3ed3bd(0x1ec)+formatNumber(_0x15942a[_0x3ed3bd(0x1c2)](0x2))+'</b></td>';}var _0xa39776=formatNumber(_0x5c7897+_0x1762a9),_0xea5515=formatNumber(_0x4037ee+_0xb31655);_0x587b4e+=_0x3ed3bd(0x1ec)+_0xa39776+'</b></td>',_0x587b4e+=_0x3ed3bd(0x1ec)+_0xea5515+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x20a)+(_0x443e4e[_0x3ed3bd(0x1d9)]['length']*0x3+0x9)+_0x3ed3bd(0x14b),_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+='<tr>',_0x587b4e+=_0x3ed3bd(0x1cb),_0x587b4e+=_0x3ed3bd(0x206),_0x587b4e+=_0x3ed3bd(0xf4);for(let _0x242869=0x0;_0x242869<=_0x443e4e['cat_brand'][_0x3ed3bd(0x1f7)]-0x1;_0x242869++){const _0x18aa59=_0x443e4e[_0x3ed3bd(0x1d9)][_0x242869],_0x5c8296=_0x18aa59['_id'][_0x3ed3bd(0x1cd)]+'-'+_0x18aa59['_id'][_0x3ed3bd(0x210)];var _0x2d7aa3=_0x4f24ac[_0x5c8296]!==undefined?_0x4f24ac[_0x5c8296][_0x3ed3bd(0x1c2)](0x2):'0',_0x17e8ca=_0x2904e1[_0x5c8296]!==undefined?_0x2904e1[_0x5c8296][_0x3ed3bd(0x1c2)](0x2):'0',_0xecf8e0=_0x3af9b0[_0x5c8296]!==undefined?_0x3af9b0[_0x5c8296][_0x3ed3bd(0x1c2)](0x2):'0',_0x4c9b83=_0x941cae[_0x5c8296]!==undefined?_0x941cae[_0x5c8296][_0x3ed3bd(0x1c2)](0x2):'0',_0x31f424=_0x528bdb[_0x5c8296]!==undefined?_0x528bdb[_0x5c8296][_0x3ed3bd(0x1c2)](0x2):'0',_0x26fcfb=_0x562236[_0x5c8296]!==undefined?_0x562236[_0x5c8296][_0x3ed3bd(0x1c2)](0x2):'0';_0x2a5017=parseFloat(_0x2d7aa3)+parseFloat(_0x4c9b83),_0x29a8b1=parseFloat(_0xecf8e0)+parseFloat(_0x26fcfb),_0x15942a=parseFloat(_0x17e8ca)+parseFloat(_0x31f424),_0x587b4e+=_0x3ed3bd(0x1d5),_0x587b4e+=_0x3ed3bd(0x1d5),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x1cb),_0x587b4e+=_0x3ed3bd(0xb9),_0x587b4e+=_0x3ed3bd(0xf4);for(let _0x165cc7=0x0;_0x165cc7<=_0x443e4e[_0x3ed3bd(0x1d9)]['length']-0x1;_0x165cc7++){const _0x413f63=_0x443e4e[_0x3ed3bd(0x1d9)][_0x165cc7],_0x302596=_0x413f63[_0x3ed3bd(0x18a)][_0x3ed3bd(0x1cd)]+'-'+_0x413f63[_0x3ed3bd(0x18a)]['category'];var _0x2d7aa3=_0x4f24ac[_0x302596]!==undefined?_0x4f24ac[_0x302596][_0x3ed3bd(0x1c2)](0x2):'0',_0x17e8ca=_0x2904e1[_0x302596]!==undefined?_0x2904e1[_0x302596][_0x3ed3bd(0x1c2)](0x2):'0',_0xecf8e0=_0x3af9b0[_0x302596]!==undefined?_0x3af9b0[_0x302596]['toFixed'](0x2):'0',_0x4c9b83=_0x941cae[_0x302596]!==undefined?_0x941cae[_0x302596][_0x3ed3bd(0x1c2)](0x2):'0',_0x31f424=_0x528bdb[_0x302596]!==undefined?_0x528bdb[_0x302596][_0x3ed3bd(0x1c2)](0x2):'0',_0x26fcfb=_0x562236[_0x302596]!==undefined?_0x562236[_0x302596][_0x3ed3bd(0x1c2)](0x2):'0';_0x2a5017=parseFloat(_0x2d7aa3)+parseFloat(_0x4c9b83),_0x29a8b1=parseFloat(_0xecf8e0)+parseFloat(_0x26fcfb),_0x15942a=parseFloat(_0x17e8ca)+parseFloat(_0x31f424),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x587b4e+=_0x3ed3bd(0x1d5),_0x587b4e+=_0x3ed3bd(0x1d5);}_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+='<tr>',_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x587b4e+=_0x3ed3bd(0x156),_0x587b4e+=_0x3ed3bd(0xf4);for(let _0x382973=0x0;_0x382973<=_0x443e4e[_0x3ed3bd(0x1d9)][_0x3ed3bd(0x1f7)]-0x1;_0x382973++){const _0x2d31eb=_0x443e4e[_0x3ed3bd(0x1d9)][_0x382973],_0x193fa5=_0x2d31eb[_0x3ed3bd(0x18a)][_0x3ed3bd(0x1cd)]+'-'+_0x2d31eb['_id'][_0x3ed3bd(0x210)];var _0x2d7aa3=_0x4f24ac[_0x193fa5]!==undefined?_0x4f24ac[_0x193fa5][_0x3ed3bd(0x1c2)](0x2):'0',_0x17e8ca=_0x2904e1[_0x193fa5]!==undefined?_0x2904e1[_0x193fa5][_0x3ed3bd(0x1c2)](0x2):'0',_0xecf8e0=_0x3af9b0[_0x193fa5]!==undefined?_0x3af9b0[_0x193fa5]['toFixed'](0x2):'0',_0x4c9b83=_0x941cae[_0x193fa5]!==undefined?_0x941cae[_0x193fa5][_0x3ed3bd(0x1c2)](0x2):'0',_0x31f424=_0x528bdb[_0x193fa5]!==undefined?_0x528bdb[_0x193fa5][_0x3ed3bd(0x1c2)](0x2):'0',_0x26fcfb=_0x562236[_0x193fa5]!==undefined?_0x562236[_0x193fa5][_0x3ed3bd(0x1c2)](0x2):'0';_0x2a5017=parseFloat(_0x2d7aa3)+parseFloat(_0x4c9b83),_0x29a8b1=parseFloat(_0xecf8e0)+parseFloat(_0x26fcfb),_0x15942a=parseFloat(_0x17e8ca)+parseFloat(_0x31f424),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x587b4e+=_0x3ed3bd(0x1d5),_0x587b4e+=_0x3ed3bd(0x1d5);}_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0x137),_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x587b4e+=_0x3ed3bd(0x13f),_0x587b4e+=_0x3ed3bd(0xf4);for(let _0xd1a7ce=0x0;_0xd1a7ce<=_0x443e4e[_0x3ed3bd(0x1d9)][_0x3ed3bd(0x1f7)]-0x1;_0xd1a7ce++){const _0x10c7c5=_0x443e4e[_0x3ed3bd(0x1d9)][_0xd1a7ce],_0x50eb3e=_0x10c7c5['_id'][_0x3ed3bd(0x1cd)]+'-'+_0x10c7c5[_0x3ed3bd(0x18a)]['category'];var _0x2d7aa3=_0x4f24ac[_0x50eb3e]!==undefined?_0x4f24ac[_0x50eb3e][_0x3ed3bd(0x1c2)](0x2):'',_0x17e8ca=_0x2904e1[_0x50eb3e]!==undefined?_0x2904e1[_0x50eb3e]['toFixed'](0x2):'',_0xecf8e0=_0x3af9b0[_0x50eb3e]!==undefined?_0x3af9b0[_0x50eb3e]['toFixed'](0x2):'',_0x4c9b83=_0x941cae[_0x50eb3e]!==undefined?_0x941cae[_0x50eb3e][_0x3ed3bd(0x1c2)](0x2):'',_0x31f424=_0x528bdb[_0x50eb3e]!==undefined?_0x528bdb[_0x50eb3e][_0x3ed3bd(0x1c2)](0x2):'',_0x26fcfb=_0x562236[_0x50eb3e]!==undefined?_0x562236[_0x50eb3e][_0x3ed3bd(0x1c2)](0x2):'';_0x2a5017=formatNumber(parseFloat(_0x2d7aa3)+parseFloat(_0x4c9b83)),_0x29a8b1=formatNumber(parseFloat(_0xecf8e0)+parseFloat(_0x26fcfb)),_0x15942a=formatNumber(parseFloat(_0x17e8ca)+parseFloat(_0x31f424)),_0x587b4e+=_0x3ed3bd(0x1ec)+_0x2d7aa3+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0x1ec)+_0xecf8e0+_0x3ed3bd(0x126),_0x587b4e+=_0x3ed3bd(0x1ec)+_0x17e8ca+'</b></td>';}_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='</tr>',_0x587b4e+=_0x3ed3bd(0xbf),_0x587b4e+=_0x3ed3bd(0x1cb),_0x587b4e+=_0x3ed3bd(0xeb),_0x587b4e+=_0x3ed3bd(0xf4);for(let _0x230743=0x0;_0x230743<=_0x443e4e[_0x3ed3bd(0x1d9)][_0x3ed3bd(0x1f7)]-0x1;_0x230743++){const _0x26cbaf=_0x443e4e[_0x3ed3bd(0x1d9)][_0x230743],_0x4664c8=_0x26cbaf[_0x3ed3bd(0x18a)][_0x3ed3bd(0x1cd)]+'-'+_0x26cbaf[_0x3ed3bd(0x18a)]['category'];var _0x2d7aa3=_0x4f24ac[_0x4664c8]!==undefined?_0x4f24ac[_0x4664c8]['toFixed'](0x2):'0',_0x17e8ca=_0x2904e1[_0x4664c8]!==undefined?_0x2904e1[_0x4664c8][_0x3ed3bd(0x1c2)](0x2):'0',_0xecf8e0=_0x3af9b0[_0x4664c8]!==undefined?_0x3af9b0[_0x4664c8][_0x3ed3bd(0x1c2)](0x2):'0',_0x4c9b83=_0x941cae[_0x4664c8]!==undefined?_0x941cae[_0x4664c8][_0x3ed3bd(0x1c2)](0x2):'0',_0x31f424=_0x528bdb[_0x4664c8]!==undefined?_0x528bdb[_0x4664c8][_0x3ed3bd(0x1c2)](0x2):'0',_0x26fcfb=_0x562236[_0x4664c8]!==undefined?_0x562236[_0x4664c8]['toFixed'](0x2):'0';_0x2a5017=parseFloat(_0x2d7aa3)+parseFloat(_0x4c9b83),_0x29a8b1=parseFloat(_0xecf8e0)+parseFloat(_0x26fcfb),_0x15942a=parseFloat(_0x17e8ca)+parseFloat(_0x31f424),_0x587b4e+=_0x3ed3bd(0x1d5),_0x587b4e+=_0x3ed3bd(0x1d5),_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x587b4e+=_0x3ed3bd(0xf4),_0x587b4e+='</tr>',_0x587b4e+=_0x3ed3bd(0x211),_0x587b4e+=_0x3ed3bd(0x1f0);}),_0x587b4e;}async function generateReferenceNumber(_0x4f8c25,_0x4dd6d5,_0x3d7115){const _0x3923=a0_0x28f363,_0x32d864=new Date(_0x4f8c25)['getFullYear'](),_0x550f0b=('0'+(new Date(_0x4f8c25)[_0x3923(0xff)]()+0x1))[_0x3923(0x22a)](-0x2),_0x377307=('0'+new Date(_0x4f8c25)[_0x3923(0x236)]())[_0x3923(0x22a)](-0x2),_0x9aad5b=await staff['findOne']({'email':_0x3d7115[_0x3923(0x208)]}),_0x3990d9=_0x9aad5b[_0x3923(0x15c)],_0x2fb5f5=_0x3990d9+'-'+_0x32d864+_0x550f0b+_0x377307,_0x23895d=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x2fb5f5),'salesman_code':_0x3990d9})[_0x3923(0x166)]({'createdAt':-0x1}),_0x312202=_0x2fb5f5;_0x23895d&&(_0x312202=_0x23895d[_0x3923(0x1b8)]);console[_0x3923(0x149)](_0x312202);const _0x34f564=new Reference({'referenceNumber':_0x312202,'staff_id':_0x4dd6d5,'salesman_code':_0x3990d9});return await _0x34f564['save'](),_0x312202;}function a0_0x3cb3(){const _0x3f58d2=['<tr>','findOne','product_details','French','catch','adj_discount','2475298SqcljB','$product.product_name','sales_bkg','</script>','json','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','Error\x20generating\x20PDF','<h1>JAKA\x20EQUITIES\x20CORP</h1>','canvas','product_details.product_name','DateTimeFormat','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','isFG','</td>','sales_staff_id','filter','sales_info','dsi_sales','$product_info.name','split','0.1in','$sale_product.discount','sale_product.product_code','German','../middleware/auth','<div\x20class=\x22col-sm-11\x22>','format','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','replace','border-right','/dev/null','xlsx','Portuguese\x20(BR)','$totalGross','table\x20tr','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','aggregate','/agent/pdf','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','window.onload\x20=\x20function()\x20{','products','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<td\x20class=\x22row_data\x22>0</td>','product_docs','518091uGUrVx','totalQTY','$product_details','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','test','$products','$product_docs','forEach','buffer','/dsrr/view','$sale_product.isFG','8.5in','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','border-top','getMonth','<th>\x20SALES\x20</th>','$totalQty','bank','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','/agent_reports/pdf_admin','product_info','$product_info.category','6DRloNy','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','\x20-\x20STD','$cash','sales_ext','thick','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','\x22><b>','en-US','$status_data','cash','post','$_id.status_data','date','reduce','then','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','$NetPrice','60mm','toISOString','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','English\x20(US)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','multer','$products.product_details.prod_id','push','valueOf','$bank','Content-Disposition','<th\x20rowspan=\x272\x27>Products</th>','$product_details.product_stock','</b></td>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','customer','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','totalQty','language','92jjUklh','/dsrr_admin/view_data/:id','<th>\x20ITEM\x20DESCRIPTION\x20</th>','deleteOne','check_no','$dsi','/dl_excel','each','long','<th>\x20QTY\x20SOLD\x20</th>','$sale_product.product_name','</tr>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','Products\x20find_data','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','left','$product.quantity','$sale_product.product_code','<div\x20class=\x22row\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','$product_list.product_stock','excel','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','status','jsbarcode','totalQTYsum','\x20-\x20','thin','<script>','log','$product','\x22><b></b></td>','/agent_reports/pdf','$sale_product.real_qty_unit_val','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','<thead>','$customer','$product_info','<p>INVENTORY\x20SUMMARY</p>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','/dsrr_admin/view','find','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','$amount','get','NumberFormat','beg_bal','\x22\x20class=\x22cat_data\x22>','sales_man_code','body','name','Arabic\x20(ae)','<div\x20style=\x22page-break-before:\x20always;\x22></div>','colspan','trim','<td\x20class=\x22row_data\x22><b>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$sale_product.prod_cat','sort','$products.product_details.category','../public/language/languages.json','params','<th\x20rowspan=\x272\x27>Category</th>','/agent_reports/view','send','qty','html','$brand','85765guWSMv','product_stock','<td\x20class=\x22cat_data\x22>','render','$product_info.brand','$discount','/agent_reports/sales_ad','stock','<td\x20class=\x22row_data\x22>','12500XBoYNg','!cols','5759875nlfabT','../models/all_models','aoa_to_sheet','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','rowspan','</thead>','$product_list','<td\x20class=\x22cat_data\x22><b>FG</b></td>','totalPrice','path','<td\x20colspan=\x22','staffs','user','<p>','book_new','_id','exceljs','blob-stream','<th\x20rowspan=\x272\x27>Production</th>','$check_no','/getDSSR_no_sales','redirect','/dsrr/pdf','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','prod_cat','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','Hindi','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','/inventory_sum/view','Types','$_id.category','border-bottom','bottom','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','12RoJqSA','</div>','style','$_id.brand','Chinese','$products.product_details.gross_price','</th>','$sales_info','<td\x20colspan=\x223\x22><b>TOTAL<b>','balanced','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','exports','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','$name','Products\x20warehouse_data','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','setHeader','PDF\x20Generation\x20Error:','attachment;\x20filename=\x22reports.xlsx\x22','!merges','<div\x20\x20id=\x22table-conatainer\x22>','<th>\x20ITEM\x20CODE\x20</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','<table>','application/pdf','findById','referenceNumber','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$_id.date','$sales_staff_id','numeric','$sale_product._id','$_id.customer','td,\x20th','15in','20mm','toFixed','$sale_product.totalprice','/dsrr_admin/pdf_admin','toLocaleDateString','Products\x20master','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','flash','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','$adj_discount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','salesman_data','brand','/balance/pdf','$product_info.gross_price','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','$product_details.product_name','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','$sale_product.adj_discount','inventory_sum','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','$products.adj_discount','No\x20data\x20was\x20Found!','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','cat_brand','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','attachment;\x20filename=\x22sales_report.xlsx\x22','express/lib/response','dataqty','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','product_name','write','Checking:\x20','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','$product.product_code','000000','/reports/dsrr/view','landscape','Sales\x20Report','product_code','right','isArray','$product_stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','6471oIEvgr','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','\x20-\x20HH','</table>','$products.NetPrice','$product_name','map','window.print();','Content-Type','<th>\x20INVOICE\x20AMOUNT\x20</th>','length','note','$category','text','/agent/view','English','<th>X-Truck</th>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','toLocaleString','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$sale_product','toStream','951951ZwIFjw','Spanish','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','sumqty','email','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','discount','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','$products.qty','dsi_sales_admin','category','</tbody>','border-left','Letter','/getDSSR_no','<tbody>','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','$product_code','$due_date','includes','utils','dsi','errors','true','$product_info.product_code','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','Router','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','$products.product_details.brand','$products.discount','$date','false','</p>','Standard','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','slice','$sale_product.stock','4654280SazRUq','$_id.dsi','book_append_sheet','totalGross','<th>\x20ENDING\x20BALANCE\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','pipe','cheerio','html-pdf','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','getDate','<th>Booking</th>','agent_sales','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','medium','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','amount','$products.product_details','brandCount','load','create','/total_sales_reports/view','top','<th>\x20BEG\x20BALANCE\x20</th>','Portuguese','attr','ObjectId','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','setDate','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','express','success','NetPrice','sales_reports','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','Arabic','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','error','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','<td\x20class=\x22cat_data\x22></td>','date_include','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>'];a0_0x3cb3=function(){return _0x3f58d2;};return a0_0x3cb3();}router[a0_0x28f363(0x112)](a0_0x28f363(0x191),auth,async(_0x13e87a,_0x978c96)=>{const _0x19f2a5=a0_0x28f363,{from_date:_0x3c200c,dataview:_0x12fd6a}=_0x13e87a['body'],_0x178f39=_0x13e87a[_0x19f2a5(0x187)],_0xf22464=await staff[_0x19f2a5(0xc0)]({'email':_0x178f39['email']}),_0x3a3b7c=await master_shop[_0x19f2a5(0x155)](),_0x40ad00='';var _0x3e1b5f=new Date(_0x3c200c);const _0x56ee06={'year':_0x19f2a5(0x1bc),'month':'long','day':_0x19f2a5(0x1bc)},_0x35da81=new Intl[(_0x19f2a5(0xcf))](_0x19f2a5(0x10f),_0x56ee06)[_0x19f2a5(0xdf)](_0x3e1b5f),_0x272255=await Reference[_0x19f2a5(0x155)]({'staff_id':_0xf22464[_0x19f2a5(0x18a)][_0x19f2a5(0x121)](),'date_include':_0x3c200c});if(_0x272255[_0x19f2a5(0x1f7)]>0x0){let _0x536a29='';_0x536a29+=_0x272255[0x0][_0x19f2a5(0x16e)];if(_0x12fd6a==_0x19f2a5(0x141)){const _0x30a8bc=cheerio['load'](_0x536a29);let _0x3c499f=[],_0x41d14f=[],_0x741385=[];const _0x3730c1=_0x540471=>{const _0x405634=_0x19f2a5,_0x57abc1={'top':{'style':'thick','color':{'rgb':_0x405634(0x1e4)}},'bottom':{'style':_0x405634(0x10c),'color':{'rgb':_0x405634(0x1e4)}},'left':{'style':_0x405634(0x10c),'color':{'rgb':_0x405634(0x1e4)}},'right':{'style':_0x405634(0x10c),'color':{'rgb':_0x405634(0x1e4)}}};if(_0x540471){const _0x2bcded=_0x540471[_0x405634(0xd8)](';')[_0x405634(0x115)]((_0x573e5f,_0x440d71)=>{const _0x391554=_0x405634,[_0x4277e8,_0x2b8bd3]=_0x440d71[_0x391554(0xd8)](':')['map'](_0x2ea65a=>_0x2ea65a[_0x391554(0x162)]());return _0x573e5f[_0x4277e8]=_0x2b8bd3,_0x573e5f;},{});_0x2bcded[_0x405634(0xfe)]&&(_0x57abc1['top'][_0x405634(0x19f)]=_0x2bcded[_0x405634(0xfe)][_0x405634(0x219)]('thin')?_0x405634(0x147):_0x405634(0xa3)),_0x2bcded['border-bottom']&&(_0x57abc1[_0x405634(0x19b)][_0x405634(0x19f)]=_0x2bcded['border-bottom'][_0x405634(0x219)](_0x405634(0x147))?_0x405634(0x147):_0x405634(0xa3)),_0x2bcded[_0x405634(0x212)]&&(_0x57abc1[_0x405634(0x13b)][_0x405634(0x19f)]=_0x2bcded[_0x405634(0x212)][_0x405634(0x219)](_0x405634(0x147))?_0x405634(0x147):_0x405634(0xa3)),_0x2bcded[_0x405634(0xe2)]&&(_0x57abc1[_0x405634(0x1e9)][_0x405634(0x19f)]=_0x2bcded[_0x405634(0xe2)][_0x405634(0x219)]('thin')?_0x405634(0x147):_0x405634(0xa3));}return _0x57abc1;};_0x30a8bc('table\x20tr')[_0x19f2a5(0x133)]((_0x55f134,_0x4043c1)=>{const _0x58665b=_0x19f2a5;let _0xfb2bfc=[],_0x1f3ef2=0x0;while(_0x741385[_0x1f3ef2]){_0x741385[_0x1f3ef2]--,_0x1f3ef2++;}_0x30a8bc(_0x4043c1)[_0x58665b(0x155)](_0x58665b(0x1bf))[_0x58665b(0x133)]((_0x4a53ee,_0x470bfe)=>{const _0x305c4d=_0x58665b;let _0x3fa506=_0x30a8bc(_0x470bfe)['text']()['trim'](),_0xa32c97=parseFloat(_0x3fa506[_0x305c4d(0xe1)](/,/g,''));isNaN(_0xa32c97)&&(_0xa32c97=_0x3fa506);let _0x36e8ff=parseInt(_0x30a8bc(_0x470bfe)[_0x305c4d(0xae)]('colspan'))||0x1,_0x33ef29=parseInt(_0x30a8bc(_0x470bfe)[_0x305c4d(0xae)](_0x305c4d(0x17f)))||0x1;const _0x56dc19=_0x30a8bc(_0x470bfe)[_0x305c4d(0xae)](_0x305c4d(0x19f)),_0xe22b45=_0x3730c1(_0x56dc19);_0xfb2bfc[_0x1f3ef2]={'v':_0xa32c97,'s':{'border':_0xe22b45}};(_0x36e8ff>0x1||_0x33ef29>0x1)&&_0x41d14f[_0x305c4d(0x120)]({'s':{'r':_0x55f134,'c':_0x1f3ef2},'e':{'r':_0x55f134+_0x33ef29-0x1,'c':_0x1f3ef2+_0x36e8ff-0x1}});for(let _0x528f05=0x0;_0x528f05<_0x36e8ff;_0x528f05++){_0x33ef29>0x1&&(_0x741385[_0x1f3ef2+_0x528f05]=_0x33ef29-0x1);}_0x1f3ef2+=_0x36e8ff;}),_0x3c499f[_0x58665b(0x120)](_0xfb2bfc);});const _0x5728b0=XLSX['utils'][_0x19f2a5(0x189)](),_0x1d0ee8=XLSX[_0x19f2a5(0x21a)][_0x19f2a5(0x17d)](_0x3c499f);_0x41d14f[_0x19f2a5(0x1f7)]>0x0&&(_0x1d0ee8[_0x19f2a5(0x1b1)]=_0x41d14f);_0x1d0ee8[_0x19f2a5(0x17a)]=_0x3c499f[0x0][_0x19f2a5(0x1f3)](()=>({'wpx':0x64})),XLSX['utils'][_0x19f2a5(0x22e)](_0x5728b0,_0x1d0ee8,_0x19f2a5(0x1e7));const _0x16216c=XLSX[_0x19f2a5(0x1e0)](_0x5728b0,{'bookType':'xlsx','type':_0x19f2a5(0xf9)});_0x978c96[_0x19f2a5(0x1ae)]('Content-Disposition',_0x19f2a5(0x1db)),_0x978c96['setHeader'](_0x19f2a5(0x1f5),_0x19f2a5(0x1c9)),_0x978c96[_0x19f2a5(0x16c)](_0x16216c);}else{let _0x2310fa='';_0x2310fa+=_0x536a29,_0x2310fa+='<script>',_0x2310fa+=_0x19f2a5(0xec),_0x2310fa+=_0x19f2a5(0x1f4),_0x2310fa+='};',_0x2310fa+=_0x19f2a5(0xc8),_0x978c96['send'](_0x2310fa);}}else generateReferenceNumber(_0x3c200c,_0xf22464[_0x19f2a5(0x18a)]['valueOf'](),_0x178f39)[_0x19f2a5(0x116)](async _0x505f34=>{const _0x2c83ef=_0x19f2a5,_0x10c141=await agentsdataDSICheck_DSRR(_0x3c200c,_0xf22464['_id'][_0x2c83ef(0x121)](),_0x40ad00,_0x505f34);console[_0x2c83ef(0x149)](_0x10c141);let _0x125f6c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x125f6c+=_0x2c83ef(0x13e),_0x125f6c+=_0x2c83ef(0x1b2),_0x125f6c+=_0x2c83ef(0x1b5),_0x125f6c+=_0x10c141,_0x125f6c+=_0x2c83ef(0x1f0),_0x125f6c+='</div>',_0x125f6c+=_0x2c83ef(0x19e);if(_0x10c141[_0x2c83ef(0x1f7)]>0x0){const _0x1544a1=await Reference[_0x2c83ef(0xc0)]({'staff_id':_0xf22464['_id'][_0x2c83ef(0x121)](),'referenceNumber':_0x505f34});_0x1544a1[_0x2c83ef(0x16e)]=_0x125f6c,_0x1544a1[_0x2c83ef(0xbd)]=_0x3c200c,await _0x1544a1['save']();if(_0x12fd6a==_0x2c83ef(0x141)){const _0x2a1a0f=cheerio[_0x2c83ef(0xa8)](_0x125f6c);let _0x5eb5cd=[],_0xa39d11=[],_0x256e75=[];const _0x2a6def=_0x3e48f3=>{const _0x5299bf=_0x2c83ef,_0x3fc542={'top':{'style':_0x5299bf(0x10c),'color':{'rgb':'000000'}},'bottom':{'style':_0x5299bf(0x10c),'color':{'rgb':_0x5299bf(0x1e4)}},'left':{'style':_0x5299bf(0x10c),'color':{'rgb':_0x5299bf(0x1e4)}},'right':{'style':_0x5299bf(0x10c),'color':{'rgb':_0x5299bf(0x1e4)}}};if(_0x3e48f3){const _0x1037ee=_0x3e48f3['split'](';')['reduce']((_0x4be166,_0x2cf1d9)=>{const _0x43f947=_0x5299bf,[_0x3f1b7c,_0x519d91]=_0x2cf1d9[_0x43f947(0xd8)](':')[_0x43f947(0x1f3)](_0x11a7cd=>_0x11a7cd[_0x43f947(0x162)]());return _0x4be166[_0x3f1b7c]=_0x519d91,_0x4be166;},{});_0x1037ee['border-top']&&(_0x3fc542[_0x5299bf(0xab)]['style']=_0x1037ee[_0x5299bf(0xfe)][_0x5299bf(0x219)](_0x5299bf(0x147))?_0x5299bf(0x147):'medium'),_0x1037ee[_0x5299bf(0x19a)]&&(_0x3fc542[_0x5299bf(0x19b)][_0x5299bf(0x19f)]=_0x1037ee['border-bottom'][_0x5299bf(0x219)](_0x5299bf(0x147))?_0x5299bf(0x147):'medium'),_0x1037ee['border-left']&&(_0x3fc542[_0x5299bf(0x13b)][_0x5299bf(0x19f)]=_0x1037ee[_0x5299bf(0x212)][_0x5299bf(0x219)](_0x5299bf(0x147))?'thin':_0x5299bf(0xa3)),_0x1037ee[_0x5299bf(0xe2)]&&(_0x3fc542[_0x5299bf(0x1e9)]['style']=_0x1037ee[_0x5299bf(0xe2)][_0x5299bf(0x219)](_0x5299bf(0x147))?'thin':_0x5299bf(0xa3));}return _0x3fc542;};_0x2a1a0f(_0x2c83ef(0xe7))[_0x2c83ef(0x133)]((_0x546608,_0x3080e5)=>{const _0x17f5bb=_0x2c83ef;let _0x16b5f0=[],_0x1f6d0d=0x0;while(_0x256e75[_0x1f6d0d]){_0x256e75[_0x1f6d0d]--,_0x1f6d0d++;}_0x2a1a0f(_0x3080e5)[_0x17f5bb(0x155)](_0x17f5bb(0x1bf))[_0x17f5bb(0x133)]((_0x1d26d9,_0x23b87e)=>{const _0x2869a0=_0x17f5bb;let _0x487de0=_0x2a1a0f(_0x23b87e)[_0x2869a0(0x1fa)]()['trim'](),_0x2a2a94=parseFloat(_0x487de0[_0x2869a0(0xe1)](/,/g,''));isNaN(_0x2a2a94)&&(_0x2a2a94=_0x487de0);let _0x4a29ff=parseInt(_0x2a1a0f(_0x23b87e)[_0x2869a0(0xae)](_0x2869a0(0x161)))||0x1,_0x5afb56=parseInt(_0x2a1a0f(_0x23b87e)[_0x2869a0(0xae)](_0x2869a0(0x17f)))||0x1;const _0x537c75=_0x2a1a0f(_0x23b87e)[_0x2869a0(0xae)](_0x2869a0(0x19f)),_0x397b0d=_0x2a6def(_0x537c75);_0x16b5f0[_0x1f6d0d]={'v':_0x2a2a94,'s':{'border':_0x397b0d}};(_0x4a29ff>0x1||_0x5afb56>0x1)&&_0xa39d11['push']({'s':{'r':_0x546608,'c':_0x1f6d0d},'e':{'r':_0x546608+_0x5afb56-0x1,'c':_0x1f6d0d+_0x4a29ff-0x1}});for(let _0x54003f=0x0;_0x54003f<_0x4a29ff;_0x54003f++){_0x5afb56>0x1&&(_0x256e75[_0x1f6d0d+_0x54003f]=_0x5afb56-0x1);}_0x1f6d0d+=_0x4a29ff;}),_0x5eb5cd[_0x17f5bb(0x120)](_0x16b5f0);});const _0x5d8b2=XLSX[_0x2c83ef(0x21a)][_0x2c83ef(0x189)](),_0x2a0190=XLSX['utils'][_0x2c83ef(0x17d)](_0x5eb5cd);_0xa39d11[_0x2c83ef(0x1f7)]>0x0&&(_0x2a0190[_0x2c83ef(0x1b1)]=_0xa39d11);_0x2a0190[_0x2c83ef(0x17a)]=_0x5eb5cd[0x0][_0x2c83ef(0x1f3)](()=>({'wpx':0x64})),XLSX[_0x2c83ef(0x21a)][_0x2c83ef(0x22e)](_0x5d8b2,_0x2a0190,_0x2c83ef(0x1e7));const _0x198c15=XLSX['write'](_0x5d8b2,{'bookType':'xlsx','type':_0x2c83ef(0xf9)});_0x978c96[_0x2c83ef(0x1ae)](_0x2c83ef(0x123),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x978c96[_0x2c83ef(0x1ae)]('Content-Type',_0x2c83ef(0x1c9)),_0x978c96['send'](_0x198c15);}else _0x125f6c+=_0x2c83ef(0x148),_0x125f6c+=_0x2c83ef(0xec),_0x125f6c+=_0x2c83ef(0x1f4),_0x125f6c+='};',_0x125f6c+='</script>',_0x978c96[_0x2c83ef(0x16c)](_0x125f6c);}else await Reference[_0x2c83ef(0x12f)]({'referenceNumber':_0x505f34}),_0x13e87a[_0x2c83ef(0x1c8)](_0x2c83ef(0x21c),_0x2c83ef(0x1d7)),_0x978c96[_0x2c83ef(0x190)](_0x2c83ef(0x1e5));})[_0x19f2a5(0xc3)](console[_0x19f2a5(0xba)]);}),router[a0_0x28f363(0x158)](a0_0x28f363(0x154),auth,async(_0x25bb9b,_0x153aed)=>{const _0x441fb6=a0_0x28f363;try{const {username:_0x1800ff,email:_0x136e31,role:_0xafb44d}=_0x25bb9b['user'],_0x543c2f=_0x25bb9b[_0x441fb6(0x187)],_0x5c62be=await profile[_0x441fb6(0xc0)]({'email':_0x543c2f[_0x441fb6(0x208)]}),_0x5019d8={'year':_0x441fb6(0x1bc),'month':_0x441fb6(0x134),'day':_0x441fb6(0x1bc)},_0x1d006b=await master_shop[_0x441fb6(0x155)]();console[_0x441fb6(0x149)](_0x441fb6(0x1c6),_0x1d006b);const _0x4efa6b=await product[_0x441fb6(0x155)]();console[_0x441fb6(0x149)](_0x441fb6(0x139),_0x4efa6b);const _0x5cb172=await warehouse[_0x441fb6(0xe9)]([{'$unwind':_0x441fb6(0xf3)},{'$lookup':{'from':_0x441fb6(0xed),'localField':_0x441fb6(0xce),'foreignField':'name','as':_0x441fb6(0xf0)}},{'$unwind':_0x441fb6(0xf7)},{'$project':{'product_name':_0x441fb6(0x1d1),'product_stock':_0x441fb6(0x125)}},{'$group':{'_id':_0x441fb6(0x1f2),'product_stock':{'$sum':_0x441fb6(0x1eb)}}}]);console[_0x441fb6(0x149)](_0x441fb6(0x1ac),_0x5cb172),_0x5cb172['forEach'](_0x391f1d=>{const _0x59b82f=_0x4efa6b['map'](_0x436c7b=>{const _0x125dc1=a0_0x558a;_0x436c7b[_0x125dc1(0x15e)]==_0x391f1d[_0x125dc1(0x18a)]&&(_0x436c7b[_0x125dc1(0x177)]=parseInt(_0x436c7b['stock'])+parseInt(_0x391f1d[_0x125dc1(0x171)]));});});const _0x5df722=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x27d60f=await staff[_0x441fb6(0xc0)]({'email':_0x543c2f['email']});if(_0x1d006b[0x0][_0x441fb6(0x12b)]==_0x441fb6(0x11c))var _0x3382d0=users[_0x441fb6(0x1fc)];else{if(_0x1d006b[0x0]['language']=='Hindi')var _0x3382d0=users[_0x441fb6(0x195)];else{if(_0x1d006b[0x0][_0x441fb6(0x12b)]==_0x441fb6(0xdc))var _0x3382d0=users[_0x441fb6(0xdc)];else{if(_0x1d006b[0x0][_0x441fb6(0x12b)]==_0x441fb6(0x204))var _0x3382d0=users[_0x441fb6(0x204)];else{if(_0x1d006b[0x0][_0x441fb6(0x12b)]==_0x441fb6(0xc2))var _0x3382d0=users['French'];else{if(_0x1d006b[0x0][_0x441fb6(0x12b)]==_0x441fb6(0xe5))var _0x3382d0=users[_0x441fb6(0xad)];else{if(_0x1d006b[0x0][_0x441fb6(0x12b)]==_0x441fb6(0x1a1))var _0x3382d0=users[_0x441fb6(0x1a1)];else{if(_0x1d006b[0x0][_0x441fb6(0x12b)]==_0x441fb6(0x15f))var _0x3382d0=users['Arabic'];}}}}}}}_0x153aed[_0x441fb6(0x173)]('dssr_view_admin',{'success':_0x25bb9b[_0x441fb6(0x1c8)](_0x441fb6(0xb4)),'errors':_0x25bb9b['flash'](_0x441fb6(0x21c)),'alldata':_0x4efa6b,'profile':_0x5c62be,'master_shop':_0x1d006b,'role':_0x543c2f,'product_stock':_0x5cb172,'language':_0x3382d0,'staff_arr':_0x27d60f,'staff_data_all':_0x5df722});}catch(_0x5b821b){}}),router[a0_0x28f363(0x112)](a0_0x28f363(0x214),auth,async(_0x303c11,_0x3b0ef0)=>{const _0x3dbd11=a0_0x28f363;try{const {from:_0x59d460,to:_0x19d4a9,staff_data:_0x3a5787}=_0x303c11[_0x3dbd11(0x15d)],_0x3e7845=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x59d460,'$lte':_0x19d4a9},'staff_id':_0x3a5787}},{'$sort':{'date_include':0x1}}]);_0x3b0ef0['json'](_0x3e7845);}catch(_0x17ddba){_0x3b0ef0[_0x3dbd11(0xc9)](_0x17ddba);}}),router[a0_0x28f363(0x112)](a0_0x28f363(0x18f),auth,async(_0x5570a6,_0x32d7da)=>{const _0x8707a2=a0_0x28f363;try{const {from:_0x2fe152,to:_0x4e2fd9}=_0x5570a6[_0x8707a2(0x15d)],{sttaff_id:_0x4351b6}=_0x5570a6['user'],_0x44de68=await Reference[_0x8707a2(0xe9)]([{'$match':{'date_include':{'$gte':_0x2fe152,'$lte':_0x4e2fd9},'staff_id':_0x4351b6}},{'$sort':{'date_include':0x1}}]);_0x32d7da[_0x8707a2(0xc9)](_0x44de68);}catch(_0x1911ed){_0x32d7da[_0x8707a2(0xc9)](_0x1911ed);}}),router[a0_0x28f363(0x158)](a0_0x28f363(0x12d),auth,async(_0x4241b5,_0x586793)=>{const _0x5778ea=a0_0x28f363;try{const _0x135a3f=_0x4241b5[_0x5778ea(0x169)]['id'],_0x4b3142=await Reference[_0x5778ea(0x1b7)](_0x135a3f);let _0x112072='';_0x112072+=_0x4b3142[_0x5778ea(0x16e)],_0x112072+=_0x5778ea(0x148),_0x112072+=_0x5778ea(0xec),_0x112072+=_0x5778ea(0x1f4),_0x112072+='};',_0x112072+=_0x5778ea(0xc8),_0x586793[_0x5778ea(0x16c)](_0x112072);}catch(_0x4d1ea1){_0x586793[_0x5778ea(0xc9)](_0x4d1ea1);}}),router['post'](a0_0x28f363(0x132),auth,async(_0x140b6f,_0x5512dc)=>{const _0x6f4b22=a0_0x28f363;try{const {ref_data:_0x52e5e0}=_0x140b6f[_0x6f4b22(0x15d)],_0x33662e=_0x52e5e0[_0x6f4b22(0xd8)]('~'),_0x21b4d2=_0x33662e[_0x6f4b22(0xd4)](_0x4d6270=>_0x4d6270!==''),_0x139de2=await Reference[_0x6f4b22(0xe9)]([{'$match':{'referenceNumber':{'$in':_0x21b4d2}}}]),_0x1fd450=XLSX[_0x6f4b22(0x21a)][_0x6f4b22(0x189)]();_0x139de2[_0x6f4b22(0xf8)](_0xdd2f5b=>{const _0x2136d9=_0x6f4b22,_0x2dcb97=cheerio[_0x2136d9(0xa8)](_0xdd2f5b[_0x2136d9(0x16e)]);let _0x45ae50=[],_0x59994e=[],_0x5921df=[];_0x2dcb97(_0x2136d9(0xe7))[_0x2136d9(0x133)]((_0x3b6f19,_0x4a74f0)=>{const _0x865bc9=_0x2136d9;let _0x253950=[],_0x3e982b=0x0;while(_0x5921df[_0x3e982b]){_0x5921df[_0x3e982b]--,_0x3e982b++;}_0x2dcb97(_0x4a74f0)[_0x865bc9(0x155)](_0x865bc9(0x1bf))[_0x865bc9(0x133)]((_0x2caf35,_0x101e91)=>{const _0xb16b66=_0x865bc9;let _0x1ead80=_0x2dcb97(_0x101e91)[_0xb16b66(0x1fa)]()[_0xb16b66(0x162)](),_0x35885e=parseFloat(_0x1ead80['replace'](/,/g,''));isNaN(_0x35885e)&&(_0x35885e=_0x1ead80);let _0x452722=parseInt(_0x2dcb97(_0x101e91)[_0xb16b66(0xae)](_0xb16b66(0x161)))||0x1,_0x187ffd=parseInt(_0x2dcb97(_0x101e91)[_0xb16b66(0xae)](_0xb16b66(0x17f)))||0x1;_0x253950[_0x3e982b]=_0x35885e;(_0x452722>0x1||_0x187ffd>0x1)&&_0x59994e['push']({'s':{'r':_0x3b6f19,'c':_0x3e982b},'e':{'r':_0x3b6f19+_0x187ffd-0x1,'c':_0x3e982b+_0x452722-0x1}});for(let _0x275b81=0x0;_0x275b81<_0x452722;_0x275b81++){_0x187ffd>0x1&&(_0x5921df[_0x3e982b+_0x275b81]=_0x187ffd-0x1);}_0x3e982b+=_0x452722;}),_0x45ae50['push'](_0x253950);});const _0x348de8=XLSX[_0x2136d9(0x21a)][_0x2136d9(0x17d)](_0x45ae50);_0x59994e['length']>0x0&&(_0x348de8[_0x2136d9(0x1b1)]=_0x59994e),_0x348de8[_0x2136d9(0x17a)]=_0x45ae50[0x0][_0x2136d9(0x1f3)](()=>({'wpx':0x64})),XLSX[_0x2136d9(0x21a)]['book_append_sheet'](_0x1fd450,_0x348de8,_0xdd2f5b[_0x2136d9(0x1b8)]);});const _0x37998f=XLSX[_0x6f4b22(0x1e0)](_0x1fd450,{'bookType':_0x6f4b22(0xe4),'type':_0x6f4b22(0xf9)});_0x5512dc[_0x6f4b22(0x1ae)](_0x6f4b22(0x123),_0x6f4b22(0x1b0)),_0x5512dc[_0x6f4b22(0x1ae)](_0x6f4b22(0x1f5),_0x6f4b22(0x1c9)),_0x5512dc[_0x6f4b22(0x16c)](_0x37998f);}catch(_0xd7204d){_0x5512dc['json'](_0xd7204d);}}),router['post'](a0_0x28f363(0x1c4),auth,async(_0x57f1e1,_0x34f3fc)=>{const _0x44c87c=a0_0x28f363,{from_date:_0xe2a1d,agent_id:_0x54d3a1}=_0x57f1e1[_0x44c87c(0x15d)],_0x4b7379=_0x57f1e1[_0x44c87c(0x187)],_0x403939=await staff['findOne']({'email':_0x4b7379[_0x44c87c(0x208)]}),_0x3a01ce=await master_shop[_0x44c87c(0x155)](),_0x183b18=await agentsdataDSICheck_DSRR(_0xe2a1d,_0x54d3a1,_0x35c7eb);let _0x40d279=_0x44c87c(0x164);var _0x2d4455=new Date(_0xe2a1d);const _0x27cddf={'year':_0x44c87c(0x1bc),'month':_0x44c87c(0x134),'day':'numeric'},_0x129b64=new Intl[(_0x44c87c(0xcf))]('en-US',_0x27cddf)[_0x44c87c(0xdf)](_0x2d4455);_0x40d279+=_0x44c87c(0x13e),_0x40d279+=_0x44c87c(0x1b2),_0x40d279+='<table>',_0x40d279+=_0x183b18,_0x40d279+=_0x44c87c(0x1f0),_0x40d279+=_0x44c87c(0x19e),_0x40d279+=_0x44c87c(0x19e);let _0x154329=_0x44c87c(0x1ee);const _0x4a21be={'width':_0x44c87c(0x1c0),'height':_0x44c87c(0xfc),'orientation':_0x44c87c(0x1e6),'border':{'top':_0x44c87c(0xd9),'right':_0x44c87c(0xd9),'bottom':'0.1in','left':'0.1in'},'header':{'height':_0x44c87c(0x119),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x154329+_0x44c87c(0x222)+_0x129b64+_0x44c87c(0x1a9)},'footer':{'height':_0x44c87c(0x1c1),'contents':{'default':_0x44c87c(0x221)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x44c87c(0xe3)}}};var _0x35c7eb='on';if(_0x35c7eb=='on'){const _0x2a8947=cheerio[_0x44c87c(0xa8)](_0x40d279);let _0x353e80=[],_0x110641=[],_0x9ae55c=[];_0x2a8947(_0x44c87c(0xe7))[_0x44c87c(0x133)]((_0x3dc3a9,_0x42b80f)=>{const _0x1629d6=_0x44c87c;let _0x3a2261=[],_0x26ac84=0x0;while(_0x9ae55c[_0x26ac84]){_0x9ae55c[_0x26ac84]--,_0x26ac84++;}_0x2a8947(_0x42b80f)[_0x1629d6(0x155)](_0x1629d6(0x1bf))['each']((_0x23c82b,_0x4264d7)=>{const _0x1048bf=_0x1629d6;let _0x16f9d5=_0x2a8947(_0x4264d7)[_0x1048bf(0x1fa)]()[_0x1048bf(0x162)](),_0x527b95=parseFloat(_0x16f9d5[_0x1048bf(0xe1)](/,/g,''));isNaN(_0x527b95)&&(_0x527b95=_0x16f9d5);let _0x4c0584=parseInt(_0x2a8947(_0x4264d7)[_0x1048bf(0xae)](_0x1048bf(0x161)))||0x1,_0x2a7561=parseInt(_0x2a8947(_0x4264d7)[_0x1048bf(0xae)]('rowspan'))||0x1;_0x3a2261[_0x26ac84]=_0x527b95;(_0x4c0584>0x1||_0x2a7561>0x1)&&_0x110641[_0x1048bf(0x120)]({'s':{'r':_0x3dc3a9,'c':_0x26ac84},'e':{'r':_0x3dc3a9+_0x2a7561-0x1,'c':_0x26ac84+_0x4c0584-0x1}});for(let _0x56e4c1=0x0;_0x56e4c1<_0x4c0584;_0x56e4c1++){_0x2a7561>0x1&&(_0x9ae55c[_0x26ac84+_0x56e4c1]=_0x2a7561-0x1);}_0x26ac84+=_0x4c0584;}),_0x353e80[_0x1629d6(0x120)](_0x3a2261);});const _0x360cff=XLSX['utils'][_0x44c87c(0x189)](),_0x591be2=XLSX[_0x44c87c(0x21a)][_0x44c87c(0x17d)](_0x353e80);_0x110641['length']>0x0&&(_0x591be2[_0x44c87c(0x1b1)]=_0x110641);_0x591be2[_0x44c87c(0x17a)]=_0x353e80[0x0][_0x44c87c(0x1f3)](()=>({'wpx':0x64})),XLSX[_0x44c87c(0x21a)][_0x44c87c(0x22e)](_0x360cff,_0x591be2,_0x44c87c(0x1e7));const _0x4cbe03=XLSX[_0x44c87c(0x1e0)](_0x360cff,{'bookType':'xlsx','type':_0x44c87c(0xf9)});_0x34f3fc[_0x44c87c(0x1ae)](_0x44c87c(0x123),_0x44c87c(0x1db)),_0x34f3fc['setHeader']('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x34f3fc[_0x44c87c(0x16c)](_0x4cbe03);}else pdf[_0x44c87c(0xa9)](_0x40d279,_0x4a21be)[_0x44c87c(0x202)](function(_0x45b658,_0x38634d){const _0x1c2f18=_0x44c87c;if(_0x45b658){_0x34f3fc[_0x1c2f18(0x143)](0x1f4)[_0x1c2f18(0x16c)](_0x1c2f18(0xcb));return;}_0x34f3fc[_0x1c2f18(0x1ae)](_0x1c2f18(0x1f5),_0x1c2f18(0x1b6)),_0x38634d[_0x1c2f18(0x232)](_0x34f3fc);});}),module[a0_0x28f363(0x1a8)]=router;