const a0_0x58bbe1=a0_0x17b4;(function(_0x5694f0,_0xad6777){const _0x5c3ff2=a0_0x17b4,_0x4cb306=_0x5694f0();while(!![]){try{const _0x368d9b=parseInt(_0x5c3ff2(0x24d))/0x1+-parseInt(_0x5c3ff2(0x152))/0x2*(-parseInt(_0x5c3ff2(0x1f0))/0x3)+parseInt(_0x5c3ff2(0xde))/0x4+parseInt(_0x5c3ff2(0x1d5))/0x5+-parseInt(_0x5c3ff2(0x184))/0x6*(-parseInt(_0x5c3ff2(0x114))/0x7)+parseInt(_0x5c3ff2(0x1c8))/0x8*(parseInt(_0x5c3ff2(0x219))/0x9)+-parseInt(_0x5c3ff2(0x258))/0xa;if(_0x368d9b===_0xad6777)break;else _0x4cb306['push'](_0x4cb306['shift']());}catch(_0x1a1a61){_0x4cb306['push'](_0x4cb306['shift']());}}}(a0_0x39f4,0xcbde9));const express=require(a0_0x58bbe1(0x195)),res=require(a0_0x58bbe1(0x223)),app=express(),router=express[a0_0x58bbe1(0x214)](),multer=require(a0_0x58bbe1(0x126)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x58bbe1(0x132)),XLSX=require(a0_0x58bbe1(0x174)),PDFDocument=require(a0_0x58bbe1(0xda)),fs=require('fs'),blobStream=require(a0_0x58bbe1(0x13a)),JsBarcode=require(a0_0x58bbe1(0x185)),{Canvas}=require(a0_0x58bbe1(0x173)),pdf=require('html-pdf'),path=require(a0_0x58bbe1(0x229)),mongoose=require(a0_0x58bbe1(0x16c)),cheerio=require(a0_0x58bbe1(0x188));function a0_0x39f4(){const _0x3601ae=['false','text','$product_info','render','$sale_product._id','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','find','style','German','prod_cat','table\x20tr','$sale_product.product_name','<td\x20class=\x22row_data\x22><b>','<th\x20rowspan=\x272\x27>Products</th>','$product_name','$sales_staff_id','totalQty','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','$product_info.name','cash','<td\x20class=\x22row_data\x22>0</td>','findById','application/pdf','Router','\x20-\x20STD','sales_ext','toStream','language','75177VyHGcX','$sales_info.name','/getDSSR_no_sales','$products.product_details.brand','<div\x20class=\x22col-sm-11\x22>','\x22><b>','$sale_product.quantity','$product_details.product_stock','$products.discount','Portuguese','express/lib/response','Content-Disposition','right','<th>\x20ITEM\x20CODE\x20</th>','date_include','/agent_reports/pdf_admin','path','$products.adj_discount','$name','inventory_sum','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','$products.qty','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','log','totalQTYsum','forEach','each','beg_bal','$due_date','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','getDate','rowspan','_id','exports','numeric','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','test','</p>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','$product_list.product_code','0.1in','border-left','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','$sale_product.real_qty_unit_val','product_info','Chinese','$products.product_details.prod_id','brandCount','1280317WXUWcP','$product_list.product_name','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','dsi','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','length','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','setHeader','<td\x20class=\x22cat_data\x22><b>FG</b></td>','error','trim','51434840Jqnafu','Arabic\x20(ae)','product_name','French','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','$sale_product.isFG','then','<th>\x20INVOICE\x20AMOUNT\x20</th>','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','Content-Type','$sale_product.totalprice','pdfkit-table','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','window.onload\x20=\x20function()\x20{','dsi_sales','4375792AnbgbQ','Products\x20master','</tbody>','<th>\x20INCOMING\x20</th>','$product_details','aoa_to_sheet','</table>','toFixed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cat_brand','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$totalQty','bank','$sale_product','discount','border-right','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','Hindi','</tr>','<th>\x20SALES\x20</th>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','$product_info.product_code','$product_list.product_stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','$products','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','date','bottom','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','<p>FINISHED\x20GOODS\x20INVENTORY</p>','load','sales_reports','$product_code','$product_stock','top','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','</td>','/dsrr_admin/view_data/:id','<th\x20rowspan=\x272\x27>Production</th>','left','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','$product','$sale_product.prod_cat','/total_sales_reports/view','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','staffs','$customer','window.print();','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','book_append_sheet','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','1524551qwBTap','$discount','$bank','$_id.customer','attr','$sales_info','$adj_discount','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','Letter','deleteOne','name','</thead>','$_id.dsi','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','pipe','$product_docs','medium','/balance/view','multer','$category','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','sale_product.product_code','success','sales_bkg','aggregate','$sale_product.product_code','write','$sale_product.adj_discount','findOne','product_details.product_name','exceljs','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','salesman_data','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','attachment;\x20filename=\x22reports.xlsx\x22','split','excel','blob-stream','<th>\x20QTY\x20SOLD\x20</th>','$totalGross','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','<td\x20class=\x22cat_data\x22></td>','send','reduce','category','Sales\x20Report','$date','totalQTY','\x20-\x20HH','sumqty','English','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','create','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','No\x20data\x20was\x20Found!','Spanish','ObjectId','colspan','toLocaleString','Products\x20find_data','map','414LqyRMw','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','</b></td>','$sale_product.discount','$_id.status_data','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','flash','/inventory_sum/view','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','!cols','filter','dsi_sales_admin','Products\x20warehouse_data','Portuguese\x20(BR)','<p>','totalGross','$_id.date','thick','$products.product_details.gross_price','td,\x20th','en-US','slice','$product_info.gross_price','isFG','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<div\x20style=\x22page-break-before:\x20always;\x22></div>','mongoose','errors','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','format','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','<thead>','$products.NetPrice','canvas','xlsx','email','Error\x20generating\x20PDF','<th>\x20ITEM\x20DESCRIPTION\x20</th>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','/dsrr_admin/pdf_admin','getFullYear','book_new','$product_info.brand','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','$status_data','<td\x20class=\x22cat_data\x22>','<script>','$NetPrice','status','18oWORkB','jsbarcode','html','<div\x20\x20id=\x22table-conatainer\x22>','cheerio','json','buffer','/dsrr/pdf','sort','60mm','<th>X-Truck</th>','product_stock','</th>','!merges','utils','qty','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','express','<th>\x20BEG\x20BALANCE\x20</th>','000000','$products.product_details','/dsrr/view','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','thin','<p>SALES\x20REPORTS</p>','$product.product_name','</div>','\x22\x20class=\x22cat_data\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','valueOf','$_id.brand','8.5in','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','<tbody>','products','/total_sales_reports/pdf','<h1>JAKA\x20EQUITIES\x20CORP</h1>','$sales_info._id','long','product_docs','/agent_reports/pdf','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','totalPrice','getMonth','$check_no','$brand','customer','dataqty','isArray','product_code','20mm','Household','<td\x20class=\x22row_data\x22>','/agent/view','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','</script>','/dsrr_admin/view','border-top','English\x20(US)','NetPrice','$_id.category','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','<td\x20colspan=\x22','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','/dev/null','get','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','referenceNumber','1072ZhYbLl','replace','body','<div\x20class=\x22row\x22>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','\x20-\x20','redirect','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','sales_info','push','$amount','stock','3623790mZgUoi','Arabic','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','includes','$product_details.product_name','toLocaleDateString','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','true','<tr>','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','product_details','Checking:\x20','border-bottom','<th>Booking</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','$product_info.category','brand','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','/reports/dsrr/view','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','DateTimeFormat','due_date','$dsi','15in','$cash','adj_discount','<table>','16041cASsoP','post','PDF\x20Generation\x20Error:','sales_staff_id','<td\x20colspan=\x223\x22><b>TOTAL<b>','attachment;\x20filename=\x22sales_report.xlsx\x22','Asia/Manila','landscape','/dl_excel','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','$product.quantity','$products.product_details.category','user'];a0_0x39f4=function(){return _0x3601ae;};return a0_0x39f4();}router[a0_0x58bbe1(0x1c5)](a0_0x58bbe1(0x125),auth,async(_0x5381a9,_0x200782)=>{const _0x46d9e5=a0_0x58bbe1;try{const {username:_0x4d7dbb,email:_0x227f2a,role:_0x54e791}=_0x5381a9[_0x46d9e5(0x1fc)],_0x5ab070=_0x5381a9[_0x46d9e5(0x1fc)],_0x1b99a8=await profile[_0x46d9e5(0x130)]({'email':_0x5ab070[_0x46d9e5(0x175)]}),_0x4300c5={'year':_0x46d9e5(0x23e),'month':'long','day':_0x46d9e5(0x23e)},_0x291043=await master_shop[_0x46d9e5(0x203)]();console['log'](_0x46d9e5(0xdf),_0x291043);const _0x55b91a=await product[_0x46d9e5(0x203)]();console['log'](_0x46d9e5(0x150),_0x55b91a);const _0x3e9c32=await warehouse[_0x46d9e5(0x12c)]([{'$unwind':_0x46d9e5(0xe2)},{'$lookup':{'from':_0x46d9e5(0x1a6),'localField':_0x46d9e5(0x131),'foreignField':_0x46d9e5(0x11e),'as':_0x46d9e5(0x1ab)}},{'$unwind':_0x46d9e5(0x123)},{'$project':{'product_name':_0x46d9e5(0x1d9),'product_stock':_0x46d9e5(0x220)}},{'$group':{'_id':_0x46d9e5(0x20b),'product_stock':{'$sum':_0x46d9e5(0x102)}}}]);console[_0x46d9e5(0x233)](_0x46d9e5(0x15e),_0x3e9c32),_0x3e9c32['forEach'](_0x21df72=>{const _0x320a49=_0x46d9e5,_0x417637=_0x55b91a[_0x320a49(0x151)](_0x160194=>{const _0x4b55f0=_0x320a49;_0x160194[_0x4b55f0(0x11e)]==_0x21df72[_0x4b55f0(0x23c)]&&(_0x160194[_0x4b55f0(0x1d4)]=parseInt(_0x160194[_0x4b55f0(0x1d4)])+parseInt(_0x21df72['product_stock']));});}),console[_0x46d9e5(0x233)](_0x46d9e5(0x150),_0x55b91a);if(_0x291043[0x0][_0x46d9e5(0x218)]==_0x46d9e5(0x1be))var _0x2bdc43=users[_0x46d9e5(0x147)];else{if(_0x291043[0x0][_0x46d9e5(0x218)]==_0x46d9e5(0xf2))var _0x2bdc43=users[_0x46d9e5(0xf2)];else{if(_0x291043[0x0]['language']==_0x46d9e5(0x205))var _0x2bdc43=users[_0x46d9e5(0x205)];else{if(_0x291043[0x0]['language']==_0x46d9e5(0x14c))var _0x2bdc43=users[_0x46d9e5(0x14c)];else{if(_0x291043[0x0]['language']==_0x46d9e5(0x25b))var _0x2bdc43=users[_0x46d9e5(0x25b)];else{if(_0x291043[0x0]['language']=='Portuguese\x20(BR)')var _0x2bdc43=users[_0x46d9e5(0x222)];else{if(_0x291043[0x0][_0x46d9e5(0x218)]==_0x46d9e5(0x24a))var _0x2bdc43=users[_0x46d9e5(0x24a)];else{if(_0x291043[0x0][_0x46d9e5(0x218)]==_0x46d9e5(0x259))var _0x2bdc43=users[_0x46d9e5(0x1d6)];}}}}}}}_0x200782[_0x46d9e5(0x200)]('balanced',{'success':_0x5381a9[_0x46d9e5(0x158)](_0x46d9e5(0x12a)),'errors':_0x5381a9[_0x46d9e5(0x158)](_0x46d9e5(0x16d)),'alldata':_0x55b91a,'profile':_0x1b99a8,'master_shop':_0x291043,'role':_0x5ab070,'product_stock':_0x3e9c32,'language':_0x2bdc43});}catch(_0x56b1ce){}});async function dataCheck(_0xff1c3,_0x59df18){const _0x787cab=a0_0x58bbe1,_0x3bc616=await product['aggregate']([{'$group':{'_id':{'brand':_0x787cab(0x1b1),'category':_0x787cab(0x127)},'products':{'$push':{'name':_0x787cab(0x22b),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x288835=[];_0x288835[_0x787cab(0xe7)]=[];for(let _0x58bbe4=0x0;_0x58bbe4<=_0x3bc616[_0x787cab(0x252)]-0x1;_0x58bbe4++){const _0x5a54ca=_0x3bc616[_0x58bbe4];_0x288835[_0x787cab(0xe7)][_0x787cab(0x1d2)](_0x5a54ca);}const _0x1d85e8=await product[_0x787cab(0x12c)]([{'$group':{'_id':{'category':_0x787cab(0x127)},'products':{'$push':{'brand':_0x787cab(0x1b1),'product_code':_0x787cab(0x101),'product_name':_0x787cab(0x22b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3ba7d6=await purchases_finished[_0x787cab(0x12c)]([{'$match':{'date':{'$gte':_0xff1c3,'$lte':_0x59df18}}},{'$unwind':_0x787cab(0x10a)},{'$group':{'_id':{'product_name':_0x787cab(0x19d),'product_code':'$product.product_code'},'totalQTY':{'$sum':_0x787cab(0x1fa)}}}]);_0x288835[_0x787cab(0x237)]=[];for(let _0xc37439=0x0;_0xc37439<=_0x3ba7d6[_0x787cab(0x252)]-0x1;_0xc37439++){const _0x48e34a=_0x3ba7d6[_0xc37439];_0x288835[_0x787cab(0x237)][_0x787cab(0x1d2)](_0x48e34a);}const _0x3c6f74=await sales_sa[_0x787cab(0x12c)]([{'$match':{'date':{'$gte':_0xff1c3,'$lte':_0x59df18}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x787cab(0x20c)}}},{'$lookup':{'from':_0x787cab(0x10e),'localField':_0x787cab(0x1f3),'foreignField':_0x787cab(0x23c),'as':'sales_info'}},{'$unwind':_0x787cab(0x119)},{'$unwind':_0x787cab(0xeb)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x787cab(0x208),'product_code':_0x787cab(0x12d)},'totalQTY':{'$sum':_0x787cab(0x21f)}}}]);console[_0x787cab(0x233)](_0x3c6f74[0x0]),_0x288835[_0x787cab(0x12b)]=[];for(let _0x344c2d=0x0;_0x344c2d<=_0x3c6f74[_0x787cab(0x252)]-0x1;_0x344c2d++){const _0x37248b=_0x3c6f74[_0x344c2d];_0x288835[_0x787cab(0x12b)]['push'](_0x37248b);}const _0x4a7682=await sales_sa[_0x787cab(0x12c)]([{'$match':{'date':{'$gte':_0xff1c3,'$lte':_0x59df18}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x787cab(0x20c)}}},{'$lookup':{'from':_0x787cab(0x10e),'localField':_0x787cab(0x1f3),'foreignField':'_id','as':'sales_info'}},{'$unwind':_0x787cab(0x119)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x787cab(0x1fd)}},{'$group':{'_id':{'product_name':_0x787cab(0x208),'product_code':_0x787cab(0x12d)},'totalQTY':{'$sum':_0x787cab(0x248)}}}]);_0x288835[_0x787cab(0x216)]=[];for(let _0x2792d4=0x0;_0x2792d4<=_0x4a7682[_0x787cab(0x252)]-0x1;_0x2792d4++){const _0x3c9b1d=_0x4a7682[_0x2792d4];_0x288835['sales_ext'][_0x787cab(0x1d2)](_0x3c9b1d);}let _0x38c3df='';for(let _0x139a0c=0x0;_0x139a0c<=_0x1d85e8[_0x787cab(0x252)]-0x1;_0x139a0c++){const _0x2fe62f=_0x1d85e8[_0x139a0c];_0x38c3df+=_0x787cab(0x1dd),_0x38c3df+=_0x787cab(0x231)+_0x2fe62f[_0x787cab(0x23c)][_0x787cab(0x141)]+_0x787cab(0x105),_0x38c3df+=_0x787cab(0xf3);for(let _0x2a42cd=0x0;_0x2a42cd<_0x288835['cat_brand']['length'];_0x2a42cd++){const _0x415157=_0x288835[_0x787cab(0xe7)][_0x2a42cd];if(_0x415157[_0x787cab(0x23c)][_0x787cab(0x141)]==_0x2fe62f[_0x787cab(0x23c)][_0x787cab(0x141)]){let _0x30c17a=[],_0x21186f=[],_0x4e663c=[];_0x30c17a[_0x415157[_0x787cab(0x23c)]['brand']]=[],_0x21186f[_0x415157[_0x787cab(0x23c)][_0x787cab(0x1e5)]]=[],_0x4e663c[_0x415157[_0x787cab(0x23c)][_0x787cab(0x1e5)]]=[];var _0x2222ea=0x0,_0x596cec=0x0,_0x27da26=0x0;for(let _0x32dd91=0x0;_0x32dd91<_0x415157[_0x787cab(0x1a6)][_0x787cab(0x252)];_0x32dd91++){const _0x226870=_0x415157['products'][_0x32dd91];for(let _0x3ded5c=0x0;_0x3ded5c<=_0x288835['beg_bal'][_0x787cab(0x252)]-0x1;_0x3ded5c++){const _0xe5bfbd=_0x288835[_0x787cab(0x237)][_0x3ded5c];_0xe5bfbd[_0x787cab(0x23c)][_0x787cab(0x25a)]==_0x226870[_0x787cab(0x11e)]&&_0xe5bfbd[_0x787cab(0x23c)]['product_code']==_0x226870[_0x787cab(0x1b5)]&&(_0x2222ea+=parseInt(_0xe5bfbd[_0x787cab(0x144)],0xa));}for(let _0x3fca80=0x0;_0x3fca80<=_0x288835['sales_ext']['length']-0x1;_0x3fca80++){const _0x2ac3aa=_0x288835['sales_ext'][_0x3fca80];_0x2ac3aa[_0x787cab(0x23c)][_0x787cab(0x25a)]==_0x226870['name']&&_0x2ac3aa[_0x787cab(0x23c)][_0x787cab(0x1b5)]==_0x226870[_0x787cab(0x1b5)]&&(_0x596cec+=parseFloat(_0x2ac3aa[_0x787cab(0x144)],0xa)['toFixed'](0x2));}for(let _0x47e481=0x0;_0x47e481<=_0x288835[_0x787cab(0x12b)][_0x787cab(0x252)]-0x1;_0x47e481++){const _0x11f861=_0x288835[_0x787cab(0x12b)][_0x47e481];_0x11f861[_0x787cab(0x23c)]['product_name']==_0x226870[_0x787cab(0x11e)]&&_0x11f861['_id'][_0x787cab(0x1b5)]==_0x226870[_0x787cab(0x1b5)]&&(_0x27da26+=parseInt(_0x11f861[_0x787cab(0x144)],0xa));}}const _0x1ae1d1=new Intl['NumberFormat'](_0x787cab(0x166));var _0x5749f5=_0x1ae1d1['format'](_0x2222ea);_0x30c17a[_0x415157['_id'][_0x787cab(0x1e5)]][_0x787cab(0x1d2)](_0x5749f5),_0x21186f[_0x415157[_0x787cab(0x23c)][_0x787cab(0x1e5)]][_0x787cab(0x1d2)](_0x1ae1d1[_0x787cab(0x16f)](_0x596cec)),_0x4e663c[_0x415157[_0x787cab(0x23c)][_0x787cab(0x1e5)]]['push'](_0x1ae1d1[_0x787cab(0x16f)](_0x27da26));var _0x8101f4=_0x1ae1d1[_0x787cab(0x16f)](_0x2222ea-(_0x27da26+_0x596cec));_0x38c3df+=_0x787cab(0x1dd),_0x38c3df+='<td\x20class=\x22row_data\x22></td>',_0x38c3df+='<td\x20class=\x22row_data\x22>'+_0x415157[_0x787cab(0x23c)][_0x787cab(0x1e5)]+_0x787cab(0x105),_0x38c3df+=_0x787cab(0x1b8)+_0x30c17a[_0x415157['_id']['brand']][0x0]+_0x787cab(0x105),_0x38c3df+=_0x787cab(0x211),_0x38c3df+=_0x787cab(0x1b8)+_0x4e663c[_0x415157['_id'][_0x787cab(0x1e5)]][0x0]+_0x787cab(0x105),_0x38c3df+='<td\x20class=\x22row_data\x22>'+_0x21186f[_0x415157[_0x787cab(0x23c)][_0x787cab(0x1e5)]][0x0]+_0x787cab(0x105),_0x38c3df+=_0x787cab(0x1b8)+_0x8101f4+_0x787cab(0x105),_0x38c3df+='</tr>';}}}return console[_0x787cab(0x233)](_0x288835['sales_bkg']),_0x38c3df;}router[a0_0x58bbe1(0x1f1)]('/balance/pdf',auth,async(_0x714c7c,_0x41e7df)=>{const _0x10a553=a0_0x58bbe1,{from_date:_0x342683,to_date:_0x4e215b}=_0x714c7c[_0x10a553(0x1ca)],_0x32393a=await dataCheck(_0x342683,_0x4e215b);{}let _0xfdb9ff=_0x10a553(0xe8);var _0x25617f=new Date(_0x342683),_0x49cd4a=new Date(_0x4e215b);const _0x150685={'year':'numeric','month':_0x10a553(0x1aa),'day':_0x10a553(0x23e)},_0x374aa1=new Intl[(_0x10a553(0x1e9))](_0x10a553(0x166),_0x150685)[_0x10a553(0x16f)](_0x25617f),_0x20d416=new Intl[(_0x10a553(0x1e9))](_0x10a553(0x166),_0x150685)[_0x10a553(0x16f)](_0x49cd4a);_0xfdb9ff+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0xfdb9ff+=_0x10a553(0xfe),_0xfdb9ff+=_0x10a553(0x160)+_0x374aa1+'\x20-\x20'+_0x20d416+_0x10a553(0x241),_0xfdb9ff+=_0x10a553(0x1cb),_0xfdb9ff+=_0x10a553(0x21d),_0xfdb9ff+=_0x10a553(0x1ef),_0xfdb9ff+=_0x10a553(0x1dd),_0xfdb9ff+='<th\x20rowspan=\x272\x27>Category</th>',_0xfdb9ff+=_0x10a553(0x20a),_0xfdb9ff+=_0x10a553(0x136)+_0x374aa1+_0x10a553(0x190),_0xfdb9ff+=_0x10a553(0x107),_0xfdb9ff+='<th\x20colspan=\x272\x27>SOLD</th>',_0xfdb9ff+=_0x10a553(0xf0)+_0x20d416+_0x10a553(0x190),_0xfdb9ff+=_0x10a553(0xf3),_0xfdb9ff+=_0x10a553(0x1dd),_0xfdb9ff+=_0x10a553(0x1e2),_0xfdb9ff+=_0x10a553(0x18e),_0xfdb9ff+=_0x10a553(0xf3),_0xfdb9ff+=_0x32393a,_0xfdb9ff+=_0x10a553(0xe4),_0xfdb9ff+=_0x10a553(0x19e),_0xfdb9ff+='</div>';const _0x258136={'format':_0x10a553(0x11c),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x10a553(0x1c4)}}};pdf['create'](_0xfdb9ff,_0x258136)[_0x10a553(0x217)](function(_0x316000,_0x3977aa){const _0x52640c=_0x10a553;if(_0x316000){_0x41e7df[_0x52640c(0x183)](0x1f4)[_0x52640c(0x13f)](_0x52640c(0x176));return;}_0x41e7df[_0x52640c(0x254)](_0x52640c(0x262),_0x52640c(0x213)),_0x3977aa[_0x52640c(0x122)](_0x41e7df);});}),router[a0_0x58bbe1(0x1c5)](a0_0x58bbe1(0x1b9),auth,async(_0xd6f6c1,_0x5ed8c8)=>{const _0x283131=a0_0x58bbe1;try{const {username:_0x55741d,email:_0x1b1e9f,role:_0x52295b}=_0xd6f6c1[_0x283131(0x1fc)],_0x4d661d=_0xd6f6c1['user'],_0x42405c=await profile['findOne']({'email':_0x4d661d[_0x283131(0x175)]}),_0x3407f8={'year':_0x283131(0x23e),'month':_0x283131(0x1aa),'day':_0x283131(0x23e)},_0x2d6cbb=await master_shop[_0x283131(0x203)](),_0x253f4b=await product[_0x283131(0x203)](),_0x2f1b85=await warehouse[_0x283131(0x12c)]([{'$unwind':_0x283131(0xe2)},{'$lookup':{'from':_0x283131(0x1a6),'localField':_0x283131(0x131),'foreignField':_0x283131(0x11e),'as':_0x283131(0x1ab)}},{'$unwind':_0x283131(0x123)},{'$project':{'product_name':_0x283131(0x1d9),'product_stock':_0x283131(0x220)}},{'$group':{'_id':_0x283131(0x20b),'product_stock':{'$sum':_0x283131(0x102)}}}]);if(_0x2d6cbb[0x0]['language']==_0x283131(0x1be))var _0x5f529a=users[_0x283131(0x147)];else{if(_0x2d6cbb[0x0]['language']==_0x283131(0xf2))var _0x5f529a=users[_0x283131(0xf2)];else{if(_0x2d6cbb[0x0]['language']==_0x283131(0x205))var _0x5f529a=users[_0x283131(0x205)];else{if(_0x2d6cbb[0x0][_0x283131(0x218)]==_0x283131(0x14c))var _0x5f529a=users['Spanish'];else{if(_0x2d6cbb[0x0][_0x283131(0x218)]=='French')var _0x5f529a=users[_0x283131(0x25b)];else{if(_0x2d6cbb[0x0][_0x283131(0x218)]==_0x283131(0x15f))var _0x5f529a=users['Portuguese'];else{if(_0x2d6cbb[0x0]['language']=='Chinese')var _0x5f529a=users['Chinese'];else{if(_0x2d6cbb[0x0][_0x283131(0x218)]=='Arabic\x20(ae)')var _0x5f529a=users['Arabic'];}}}}}}}_0x5ed8c8['render']('agent_sales',{'success':_0xd6f6c1[_0x283131(0x158)](_0x283131(0x12a)),'errors':_0xd6f6c1[_0x283131(0x158)](_0x283131(0x16d)),'alldata':_0x253f4b,'profile':_0x42405c,'master_shop':_0x2d6cbb,'role':_0x4d661d,'product_stock':_0x2f1b85,'language':_0x5f529a});}catch(_0x5c91fd){}});async function agentsdataCheck(_0xda4956,_0x163bea){const _0x4ec7f4=a0_0x58bbe1,_0x14154e=await product[_0x4ec7f4(0x12c)]([{'$group':{'_id':{'brand':'$brand','category':_0x4ec7f4(0x127)},'products':{'$push':{'name':_0x4ec7f4(0x22b),'product_code':_0x4ec7f4(0x101)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5bbcb0=[];_0x5bbcb0[_0x4ec7f4(0xe7)]=[];for(let _0x2b4b31=0x0;_0x2b4b31<=_0x14154e[_0x4ec7f4(0x252)]-0x1;_0x2b4b31++){const _0x1c5aa9=_0x14154e[_0x2b4b31];_0x5bbcb0['cat_brand'][_0x4ec7f4(0x1d2)](_0x1c5aa9);}const _0x2812b0=await product[_0x4ec7f4(0x12c)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x4ec7f4(0x1b1),'product_code':_0x4ec7f4(0x101),'product_name':_0x4ec7f4(0x22b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1307b9=await product['aggregate']([{'$group':{'_id':{'category':_0x4ec7f4(0x127),'brand':_0x4ec7f4(0x1b1)}}},{'$group':{'_id':_0x4ec7f4(0x1c0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x192dd7=await sales_sa[_0x4ec7f4(0x12c)]([{'$match':{'date':{'$gte':_0xda4956,'$lte':_0x163bea}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x4ec7f4(0x10e),'localField':_0x4ec7f4(0x1f3),'foreignField':_0x4ec7f4(0x23c),'as':_0x4ec7f4(0x1d1)}},{'$unwind':_0x4ec7f4(0x119)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x4ec7f4(0x1fd)}},{'$lookup':{'from':_0x4ec7f4(0x1a6),'localField':'sale_product.product_code','foreignField':_0x4ec7f4(0x1b5),'as':_0x4ec7f4(0x249)}},{'$unwind':_0x4ec7f4(0x1ff)},{'$group':{'_id':{'sales_id':_0x4ec7f4(0x1a9),'category':_0x4ec7f4(0x1e4),'brand':_0x4ec7f4(0x17d)},'salesman_data':{'$first':_0x4ec7f4(0x21a)},'totalQTY':{'$sum':_0x4ec7f4(0x248)},'products':{'$push':{'qty':_0x4ec7f4(0x248),'product_details':{'prod_name':_0x4ec7f4(0x20f),'product_code':'$product_info.product_code','category':_0x4ec7f4(0x1e4),'brand':_0x4ec7f4(0x17d)}}}}}]);let _0x583c82='';_0x583c82+=_0x4ec7f4(0x1dd),_0x583c82+='<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x583c82+=_0x4ec7f4(0xf3),_0x583c82+=_0x4ec7f4(0x1dd),_0x583c82+=_0x4ec7f4(0x13e);for(let _0xf1e6e0=0x0;_0xf1e6e0<=_0x2812b0['length']-0x1;_0xf1e6e0++){const _0xc2fc23=_0x2812b0[_0xf1e6e0];for(let _0x4de2a1=0x0;_0x4de2a1<_0x1307b9[_0x4ec7f4(0x252)];_0x4de2a1++){const _0x17f2aa=_0x1307b9[_0x4de2a1];_0x17f2aa[_0x4ec7f4(0x23c)]==_0xc2fc23[_0x4ec7f4(0x23c)][_0x4ec7f4(0x141)]&&(_0x583c82+=_0x4ec7f4(0x1c2)+_0x17f2aa['brandCount']+_0x4ec7f4(0x19f)+_0xc2fc23['_id'][_0x4ec7f4(0x141)]+'</td>');}}_0x583c82+=_0x4ec7f4(0x13e),_0x583c82+=_0x4ec7f4(0xf3),_0x583c82+='<tr>',_0x583c82+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>';for(let _0x39d517=0x0;_0x39d517<=_0x2812b0[_0x4ec7f4(0x252)]-0x1;_0x39d517++){const _0x1a97b7=_0x2812b0[_0x39d517];for(let _0x234b2c=0x0;_0x234b2c<_0x5bbcb0[_0x4ec7f4(0xe7)][_0x4ec7f4(0x252)];_0x234b2c++){const _0x5a2736=_0x5bbcb0['cat_brand'][_0x234b2c];_0x5a2736['_id'][_0x4ec7f4(0x141)]==_0x1a97b7['_id'][_0x4ec7f4(0x141)]&&(_0x583c82+=_0x4ec7f4(0x180)+_0x5a2736[_0x4ec7f4(0x23c)][_0x4ec7f4(0x1e5)]+'</td>');}}_0x583c82+=_0x4ec7f4(0x1e8),_0x583c82+=_0x4ec7f4(0xf3);let _0x58e7ba={'name':[],'dataqty':{}};for(let _0x42c79c=0x0;_0x42c79c<_0x5bbcb0[_0x4ec7f4(0xe7)][_0x4ec7f4(0x252)];_0x42c79c++){const _0x37a2e6=_0x5bbcb0[_0x4ec7f4(0xe7)][_0x42c79c],_0xf5f002=_0x37a2e6['_id'][_0x4ec7f4(0x1e5)],_0x1cb018=_0x37a2e6[_0x4ec7f4(0x23c)][_0x4ec7f4(0x141)];!_0x58e7ba[_0x4ec7f4(0x1b3)][_0xf5f002]&&(_0x58e7ba[_0x4ec7f4(0x1b3)][_0xf5f002]={});!_0x58e7ba['dataqty'][_0xf5f002][_0x1cb018]&&(_0x58e7ba[_0x4ec7f4(0x1b3)][_0xf5f002][_0x1cb018]=[]);for(let _0x2bc10e=0x0;_0x2bc10e<_0x192dd7[_0x4ec7f4(0x252)];_0x2bc10e++){const _0x538d73=_0x192dd7[_0x2bc10e];if(_0xf5f002===_0x538d73[_0x4ec7f4(0x23c)][_0x4ec7f4(0x1e5)]&&_0x1cb018===_0x538d73[_0x4ec7f4(0x23c)][_0x4ec7f4(0x141)]){const _0x5d25f7=_0x538d73[_0x4ec7f4(0x135)];!_0x58e7ba[_0x4ec7f4(0x1b3)][_0xf5f002][_0x1cb018][_0x5d25f7]&&(_0x58e7ba[_0x4ec7f4(0x1b3)][_0xf5f002][_0x1cb018][_0x5d25f7]=[]),_0x58e7ba[_0x4ec7f4(0x1b3)][_0xf5f002][_0x1cb018][_0x5d25f7][_0x4ec7f4(0x1d2)](_0x538d73['totalQTY']),!_0x58e7ba[_0x4ec7f4(0x11e)][_0x4ec7f4(0x1d8)](_0x5d25f7)&&_0x58e7ba['name'][_0x4ec7f4(0x1d2)](_0x5d25f7);}}}_0x583c82+='<tr>';for(let _0x527ad8=0x0;_0x527ad8<=_0x58e7ba[_0x4ec7f4(0x11e)][_0x4ec7f4(0x252)]-0x1;_0x527ad8++){const _0x28d8d8=_0x58e7ba[_0x4ec7f4(0x11e)][_0x527ad8];_0x583c82+='<td\x20class=\x22row_data\x22>'+_0x28d8d8+_0x4ec7f4(0x105);var _0x23b43b=0x0,_0x21eb58=0x0;for(let _0x51d4d0=0x0;_0x51d4d0<=_0x5bbcb0[_0x4ec7f4(0xe7)][_0x4ec7f4(0x252)]-0x1;_0x51d4d0++){const _0x2c0a64=_0x5bbcb0[_0x4ec7f4(0xe7)][_0x51d4d0];var _0x56ad34=0x0;_0x58e7ba[_0x4ec7f4(0x1b3)][_0x2c0a64['_id'][_0x4ec7f4(0x1e5)]][_0x2c0a64[_0x4ec7f4(0x23c)][_0x4ec7f4(0x141)]][_0x28d8d8]?(_0x56ad34=_0x58e7ba[_0x4ec7f4(0x1b3)][_0x2c0a64[_0x4ec7f4(0x23c)][_0x4ec7f4(0x1e5)]][_0x2c0a64['_id'][_0x4ec7f4(0x141)]][_0x28d8d8][0x0],_0x583c82+=_0x4ec7f4(0x1b8)+formatNumber(_0x56ad34[_0x4ec7f4(0xe5)](0x2))+_0x4ec7f4(0x105)):(_0x56ad34=0x0,_0x583c82+=_0x4ec7f4(0x1b8)+_0x56ad34+'</td>'),_0x23b43b+=_0x56ad34;}_0x583c82+=_0x4ec7f4(0x1b8)+formatNumber(_0x23b43b[_0x4ec7f4(0xe5)](0x2))+'</td>';}return _0x583c82+=_0x4ec7f4(0xf3),_0x583c82;}router['post']('/agent/pdf',auth,async(_0x350b5d,_0x3c7643)=>{const _0x82f699=a0_0x58bbe1,{from_date:_0x52bc29,to_date:_0x4c9f2b}=_0x350b5d[_0x82f699(0x1ca)],_0x202ced=await agentsdataCheck(_0x52bc29,_0x4c9f2b);{}let _0x663f93=_0x82f699(0xdb);var _0x2e91e0=new Date(_0x52bc29),_0x43911a=new Date(_0x4c9f2b);const _0x1971b2={'year':'numeric','month':'long','day':_0x82f699(0x23e)},_0x24e6d3=new Intl[(_0x82f699(0x1e9))](_0x82f699(0x166),_0x1971b2)[_0x82f699(0x16f)](_0x2e91e0),_0x19b46e=new Intl[(_0x82f699(0x1e9))]('en-US',_0x1971b2)['format'](_0x43911a);_0x663f93+=_0x82f699(0x1a8),_0x663f93+=_0x82f699(0x19c),_0x663f93+='<p>'+_0x24e6d3+_0x82f699(0x1cd)+_0x19b46e+'</p>',_0x663f93+=_0x82f699(0x1cb),_0x663f93+=_0x82f699(0x21d),_0x663f93+=_0x82f699(0x1ef),_0x663f93+=_0x202ced,_0x663f93+=_0x82f699(0xe4),_0x663f93+=_0x82f699(0x19e),_0x663f93+=_0x82f699(0x19e);const _0x484fbe={'format':'Letter','orientation':_0x82f699(0x1f7),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x82f699(0x1c4)}}};pdf['create'](_0x663f93,_0x484fbe)[_0x82f699(0x217)](function(_0x26bfb6,_0x335d81){const _0x285f02=_0x82f699;if(_0x26bfb6){_0x3c7643[_0x285f02(0x183)](0x1f4)[_0x285f02(0x13f)](_0x285f02(0x176));return;}_0x3c7643[_0x285f02(0x254)](_0x285f02(0x262),_0x285f02(0x213)),_0x335d81[_0x285f02(0x122)](_0x3c7643);});}),router[a0_0x58bbe1(0x1c5)]('/agent_reports/sales_ad',auth,async(_0x2349a6,_0x41a284)=>{const _0x1775e5=a0_0x58bbe1;try{const {username:_0x5508fd,email:_0x1f9e09,role:_0x41aec3}=_0x2349a6[_0x1775e5(0x1fc)],_0x2efdcf=_0x2349a6['user'],_0x419130=await profile['findOne']({'email':_0x2efdcf[_0x1775e5(0x175)]}),_0x34fd65={'year':'numeric','month':_0x1775e5(0x1aa),'day':_0x1775e5(0x23e)},_0x1a5281=await master_shop['find'](),_0x27c75a=await staff['findOne']({'email':_0x2efdcf[_0x1775e5(0x175)]}),_0x38b7f6=await product[_0x1775e5(0x203)](),_0x4d5b6c=await warehouse[_0x1775e5(0x12c)]([{'$unwind':_0x1775e5(0xe2)},{'$lookup':{'from':_0x1775e5(0x1a6),'localField':_0x1775e5(0x131),'foreignField':_0x1775e5(0x11e),'as':_0x1775e5(0x1ab)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x1775e5(0x1d9),'product_stock':_0x1775e5(0x220)}},{'$group':{'_id':_0x1775e5(0x20b),'product_stock':{'$sum':_0x1775e5(0x102)}}}]),_0xaf21fc=await staff[_0x1775e5(0x203)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x1a5281[0x0][_0x1775e5(0x218)]==_0x1775e5(0x1be))var _0x241a5a=users[_0x1775e5(0x147)];else{if(_0x1a5281[0x0]['language']==_0x1775e5(0xf2))var _0x241a5a=users[_0x1775e5(0xf2)];else{if(_0x1a5281[0x0]['language']==_0x1775e5(0x205))var _0x241a5a=users['German'];else{if(_0x1a5281[0x0][_0x1775e5(0x218)]==_0x1775e5(0x14c))var _0x241a5a=users[_0x1775e5(0x14c)];else{if(_0x1a5281[0x0][_0x1775e5(0x218)]==_0x1775e5(0x25b))var _0x241a5a=users[_0x1775e5(0x25b)];else{if(_0x1a5281[0x0][_0x1775e5(0x218)]=='Portuguese\x20(BR)')var _0x241a5a=users[_0x1775e5(0x222)];else{if(_0x1a5281[0x0][_0x1775e5(0x218)]==_0x1775e5(0x24a))var _0x241a5a=users['Chinese'];else{if(_0x1a5281[0x0]['language']=='Arabic\x20(ae)')var _0x241a5a=users[_0x1775e5(0x1d6)];}}}}}}}_0x41a284[_0x1775e5(0x200)](_0x1775e5(0x15d),{'success':_0x2349a6[_0x1775e5(0x158)](_0x1775e5(0x12a)),'errors':_0x2349a6['flash'](_0x1775e5(0x16d)),'alldata':_0x38b7f6,'profile':_0x419130,'master_shop':_0x1a5281,'role':_0x2efdcf,'product_stock':_0x4d5b6c,'language':_0x241a5a,'staff_arr':_0x27c75a,'staff_data_all':_0xaf21fc});}catch(_0xcdadc0){_0x41a284[_0x1775e5(0x189)](_0xcdadc0);}});async function agentsdataDSICheck_admin(_0x1de5e3,_0x4e346c,_0x2c880e,_0x59590e){const _0x275678=a0_0x58bbe1,_0x6fc14a=await product['aggregate']([{'$group':{'_id':{'brand':_0x275678(0x1b1),'category':'$category'},'products':{'$push':{'name':_0x275678(0x22b),'product_code':_0x275678(0x101)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x445a76=[];_0x445a76[_0x275678(0xe7)]=[];for(let _0x72b8c4=0x0;_0x72b8c4<=_0x6fc14a[_0x275678(0x252)]-0x1;_0x72b8c4++){const _0x310864=_0x6fc14a[_0x72b8c4];_0x445a76[_0x275678(0xe7)][_0x275678(0x1d2)](_0x310864);}const _0x218687=await product['aggregate']([{'$group':{'_id':{'category':_0x275678(0x127)},'products':{'$push':{'brand':_0x275678(0x1b1),'product_code':'$product_code','product_name':_0x275678(0x22b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x40748b=await product[_0x275678(0x12c)]([{'$group':{'_id':{'category':_0x275678(0x127),'brand':_0x275678(0x1b1)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5705e0=await sales_sa[_0x275678(0x12c)]([{'$match':{'date':{'$gte':_0x1de5e3,'$lte':_0x4e346c},'sales_staff_id':_0x2c880e,'sale_product.isFG':_0x275678(0x1fd)}},{'$unwind':_0x275678(0xeb)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x275678(0x1a6),'localField':_0x275678(0x129),'foreignField':_0x275678(0x1b5),'as':_0x275678(0x249)}},{'$unwind':_0x275678(0x1ff)},{'$group':{'_id':{'dsi':_0x275678(0x1eb),'date':_0x275678(0x143),'customer':_0x275678(0x10f)},'totalQty':{'$sum':_0x275678(0x248)},'products':{'$push':{'qty':_0x275678(0x248),'NetPrice':_0x275678(0x263),'discount':_0x275678(0x155),'adj_discount':_0x275678(0x12f),'product_details':{'prod_name':_0x275678(0x20f),'product_code':'$product_info.product_code','category':'$product_info.category','brand':'$product_info.brand','gross_price':_0x275678(0x168)}}}}},{'$unwind':_0x275678(0xf9)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x275678(0x162),'customer':_0x275678(0x117),'category':_0x275678(0x1fb),'brand':_0x275678(0x21c)},'totalQty':{'$sum':_0x275678(0x230)},'totalGross':{'$sum':{'$multiply':[_0x275678(0x230),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x275678(0x198)}}},{'$group':{'_id':{'dsi':_0x275678(0x120),'date':'$_id.date','customer':_0x275678(0x117)},'totalQty':{'$sum':_0x275678(0xe9)},'totalGross':{'$sum':_0x275678(0x13c)},'NetPrice':{'$sum':_0x275678(0x182)},'discount':{'$sum':_0x275678(0x115)},'adj_discount':{'$sum':_0x275678(0x11a)},'products':{'$push':{'qty':_0x275678(0xe9),'category':_0x275678(0x1c0),'brand':_0x275678(0x1a2),'product_details':_0x275678(0xe2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x58af64=[],_0xc0b180={},_0x3dfc4d={},_0x2bed56={};var _0x8d05d9=0x0,_0x3a7372=0x0,_0x1f08d5=0x0,_0x4a9425=0x0,_0x4b32fc=0x0;const _0xa1f113=0x6;for(let _0x3a0814=0x0;_0x3a0814<=_0x5705e0[_0x275678(0x252)]-0x1;_0x3a0814++){const _0x594391=_0x5705e0[_0x3a0814];let _0x370be2=_0x275678(0x1dd);_0x370be2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x594391[_0x275678(0x23c)][_0x275678(0x250)]+_0x275678(0x105),_0x370be2+=_0x275678(0x1e6)+_0x594391[_0x275678(0x23c)][_0x275678(0xfb)]+'</td>',_0x370be2+=_0x275678(0x1e6)+_0x594391['_id'][_0x275678(0x1b2)]+'</td>';let _0x130326={};var _0x3deadd=0x0;for(let _0x2bbb4f=0x0;_0x2bbb4f<=_0x594391[_0x275678(0x1a6)][_0x275678(0x252)]-0x1;_0x2bbb4f++){const _0x346c7c=_0x594391[_0x275678(0x1a6)][_0x2bbb4f];_0x130326[_0x346c7c['brand']+'-'+_0x346c7c['category']]=_0x346c7c['qty'];const _0x5e947e=_0x346c7c[_0x275678(0x1e5)]+'-'+_0x346c7c['category'];!_0xc0b180[_0x5e947e]&&(_0xc0b180[_0x5e947e]=0x0),!Array['isArray'](_0x2bed56[_0x5e947e])&&(_0x2bed56[_0x5e947e]=[]),!Array['isArray'](_0x2bed56[_0x5e947e])&&(_0x2bed56[_0x5e947e]=[]),_0xc0b180[_0x5e947e]+=_0x346c7c[_0x275678(0x193)],_0x2bed56[_0x5e947e][_0x275678(0x1d2)](_0x346c7c['qty']),_0x3deadd++;}console[_0x275678(0x233)](_0x594391);for(let _0x276753=0x0;_0x276753<=_0x445a76[_0x275678(0xe7)][_0x275678(0x252)]-0x1;_0x276753++){const _0x4d9aa5=_0x445a76[_0x275678(0xe7)][_0x276753],_0x2dc619=_0x4d9aa5['_id']['brand']+'-'+_0x4d9aa5[_0x275678(0x23c)][_0x275678(0x141)];_0x370be2+=_0x275678(0x1a0)+(_0x130326[_0x2dc619]!==undefined?_0x130326[_0x2dc619]['toFixed'](0x2):'')+_0x275678(0x105);}_0x1f08d5=_0x594391[_0x275678(0xec)]+_0x594391[_0x275678(0x1ee)],_0x370be2+=_0x275678(0x19a)+formatNumber(parseFloat(_0x594391[_0x275678(0x20d)],0x2)[_0x275678(0xe5)](0x2))+'</td>',_0x370be2+=_0x275678(0x19a)+formatNumber(_0x594391['totalGross'][_0x275678(0xe5)](0x2))+_0x275678(0x105),_0x370be2+=_0x275678(0x19a)+formatNumber(_0x1f08d5)+_0x275678(0x105),_0x370be2+=_0x275678(0x19a)+formatNumber(_0x594391[_0x275678(0x1bf)][_0x275678(0xe5)](0x2))+_0x275678(0x105),_0x370be2+='</tr>',_0x8d05d9+=parseFloat(_0x594391[_0x275678(0x20d)]['toFixed'](0x2)),_0x3a7372+=parseFloat(_0x594391['NetPrice']['toFixed'](0x2)),_0x4a9425+=_0x1f08d5,_0x4b32fc+=parseFloat(_0x594391['totalGross'][_0x275678(0xe5)](0x2));if(_0x3a0814==_0x5705e0[_0x275678(0x252)]-0x1){_0x370be2+=_0x275678(0x1dd),_0x370be2+=_0x275678(0x1f4),_0x370be2+=_0x275678(0x105);for(let _0x4cc2eb=0x0;_0x4cc2eb<=_0x445a76[_0x275678(0xe7)]['length']-0x1;_0x4cc2eb++){const _0x3ece58=_0x445a76[_0x275678(0xe7)][_0x4cc2eb],_0x3f28a3=_0x3ece58[_0x275678(0x23c)][_0x275678(0x1e5)]+'-'+_0x3ece58[_0x275678(0x23c)]['category'];!_0x2bed56[_0x3f28a3]&&(_0x2bed56[_0x3f28a3]=[]);const _0xfb0e1d=_0x2bed56[_0x3f28a3][_0x275678(0x140)]((_0x30982e,_0x3bf397)=>_0x30982e+_0x3bf397,0x0);console[_0x275678(0x233)](_0x275678(0x240),_0x3f28a3),_0x370be2+=_0x275678(0x232)+(_0xfb0e1d!==undefined?formatNumber(_0xfb0e1d[_0x275678(0xe5)](0x2)):'')+_0x275678(0x154),console[_0x275678(0x233)](_0x2bed56[_0x3f28a3][_0x275678(0x140)]((_0xa76de9,_0x2f2d46)=>_0xa76de9+_0x2f2d46,0x0));}_0x370be2+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x8d05d9[_0x275678(0xe5)](0x2))+'</b></td>',_0x370be2+=_0x275678(0x1c3)+formatNumber(_0x4b32fc)+_0x275678(0x154),_0x370be2+=_0x275678(0x1c3)+formatNumber(_0x4a9425)+'</b></td>',_0x370be2+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3a7372)+'</b></td>',_0x370be2+=_0x275678(0xf3);}_0x58af64[_0x275678(0x1d2)](_0x370be2);}function _0x48c8ad(_0x281a95,_0x40442d){const _0x364350=_0x275678,_0x490585=[];for(let _0x47cd20=0x0;_0x47cd20<=_0x281a95[_0x364350(0x252)]-0x1;_0x47cd20+=_0x40442d){_0x490585['push'](_0x281a95[_0x364350(0x167)](_0x47cd20,_0x47cd20+_0x40442d));}return _0x490585;}const _0x15aeb2=_0x48c8ad(_0x58af64,_0xa1f113);let _0x141083='';return _0x15aeb2[_0x275678(0x235)]((_0x113453,_0x425fef)=>{const _0x2029ae=_0x275678;_0x425fef>0x0&&(_0x141083+=_0x2029ae(0x16b));_0x141083+='<table>',_0x141083+=_0x2029ae(0x171),_0x141083+='<tr>',_0x141083+=_0x2029ae(0x22d),_0x141083+=_0x2029ae(0xf3),_0x141083+=_0x2029ae(0x1dd),_0x141083+=_0x2029ae(0x202);for(let _0x24049a=0x0;_0x24049a<=_0x218687[_0x2029ae(0x252)]-0x1;_0x24049a++){const _0x15e782=_0x218687[_0x24049a];for(let _0x21a8e6=0x0;_0x21a8e6<_0x40748b[_0x2029ae(0x252)];_0x21a8e6++){const _0x5787cf=_0x40748b[_0x21a8e6];_0x5787cf[_0x2029ae(0x23c)]===_0x15e782['_id']['category']&&(_0x141083+=_0x2029ae(0x1c2)+_0x5787cf[_0x2029ae(0x24c)]+'\x22\x20class=\x22cat_data\x22>'+_0x15e782[_0x2029ae(0x23c)]['category']+_0x2029ae(0x105));}}_0x141083+=_0x2029ae(0x1f9),_0x141083+='</tr>',_0x141083+='<tr>',_0x141083+=_0x2029ae(0x109),_0x141083+=_0x2029ae(0xf1),_0x141083+=_0x2029ae(0x179);for(let _0xd1b800=0x0;_0xd1b800<=_0x218687[_0x2029ae(0x252)]-0x1;_0xd1b800++){const _0x45cd80=_0x218687[_0xd1b800];for(let _0x4c3b6e=0x0;_0x4c3b6e<_0x445a76[_0x2029ae(0xe7)]['length'];_0x4c3b6e++){const _0x3bcf12=_0x445a76[_0x2029ae(0xe7)][_0x4c3b6e];_0x3bcf12['_id'][_0x2029ae(0x141)]===_0x45cd80['_id']['category']&&(_0x141083+='<td\x20class=\x22cat_data\x22>'+_0x3bcf12['_id'][_0x2029ae(0x1e5)]+_0x2029ae(0x105));}}_0x141083+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x141083+=_0x2029ae(0x242),_0x141083+=_0x2029ae(0x148),_0x141083+=_0x2029ae(0x17e),_0x141083+=_0x2029ae(0xf3),_0x141083+=_0x2029ae(0x11f),_0x141083+=_0x2029ae(0x1a5),_0x113453['forEach'](_0x4bf28c=>{_0x141083+=_0x4bf28c;}),console['log'](_0x2bed56),_0x141083+='</tbody>',_0x141083+=_0x2029ae(0xe4);}),_0x141083;}function a0_0x17b4(_0x14fdc4,_0x5a3be7){const _0x39f444=a0_0x39f4();return a0_0x17b4=function(_0x17b441,_0x3b6616){_0x17b441=_0x17b441-0xda;let _0x46712b=_0x39f444[_0x17b441];return _0x46712b;},a0_0x17b4(_0x14fdc4,_0x5a3be7);}async function agentsdataDSICheck_admin_excel(_0x36684c,_0xb1886f,_0x13b081,_0x490e56){const _0x1cfd48=a0_0x58bbe1,_0x5c2abd=await product[_0x1cfd48(0x12c)]([{'$group':{'_id':{'brand':'$brand','category':_0x1cfd48(0x127)},'products':{'$push':{'name':'$name','product_code':_0x1cfd48(0x101)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x411217=[];_0x411217[_0x1cfd48(0xe7)]=[];for(let _0x2ab8c8=0x0;_0x2ab8c8<=_0x5c2abd[_0x1cfd48(0x252)]-0x1;_0x2ab8c8++){const _0x9dceae=_0x5c2abd[_0x2ab8c8];_0x411217['cat_brand'][_0x1cfd48(0x1d2)](_0x9dceae);}const _0x77a4a8=await product[_0x1cfd48(0x12c)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x1cfd48(0x1b1),'product_code':_0x1cfd48(0x101),'product_name':_0x1cfd48(0x22b)}}}},{'$sort':{'_id.category':-0x1}}]),_0xde438a=await product[_0x1cfd48(0x12c)]([{'$group':{'_id':{'category':_0x1cfd48(0x127),'brand':_0x1cfd48(0x1b1)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5dd459=await sales_sa[_0x1cfd48(0x12c)]([{'$match':{'date':{'$gte':_0x36684c,'$lte':_0xb1886f},'sales_staff_id':_0x13b081,'sale_product.isFG':_0x1cfd48(0x1fd)}},{'$unwind':_0x1cfd48(0xeb)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x1cfd48(0x1a6),'localField':'sale_product.product_code','foreignField':'product_code','as':'product_info'}},{'$unwind':_0x1cfd48(0x1ff)},{'$group':{'_id':{'dsi':_0x1cfd48(0x1eb),'date':_0x1cfd48(0x143),'customer':_0x1cfd48(0x10f)},'totalQty':{'$sum':_0x1cfd48(0x248)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x1cfd48(0x263),'discount':_0x1cfd48(0x155),'adj_discount':_0x1cfd48(0x12f),'product_details':{'prod_name':_0x1cfd48(0x20f),'product_code':_0x1cfd48(0xf6),'category':_0x1cfd48(0x1e4),'brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x1cfd48(0xf9)},{'$group':{'_id':{'dsi':_0x1cfd48(0x120),'date':_0x1cfd48(0x162),'customer':_0x1cfd48(0x117),'category':'$products.product_details.category','brand':_0x1cfd48(0x21c)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x1cfd48(0x164)]}},'NetPrice':{'$sum':_0x1cfd48(0x172)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x1cfd48(0x22a)},'product_details':{'$first':_0x1cfd48(0x198)}}},{'$group':{'_id':{'dsi':_0x1cfd48(0x120),'date':_0x1cfd48(0x162),'customer':'$_id.customer'},'totalQty':{'$sum':_0x1cfd48(0xe9)},'totalGross':{'$sum':_0x1cfd48(0x13c)},'NetPrice':{'$sum':_0x1cfd48(0x182)},'discount':{'$sum':_0x1cfd48(0x115)},'adj_discount':{'$sum':_0x1cfd48(0x11a)},'products':{'$push':{'qty':_0x1cfd48(0xe9),'category':_0x1cfd48(0x1c0),'brand':'$_id.brand','product_details':_0x1cfd48(0xe2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4b6bd7=[],_0x39f62e={},_0xb3122b={},_0xe54ca6={};var _0x43dcf0=0x0,_0x489e8e=0x0,_0x18e0ab=0x0,_0x4ce6bf=0x0,_0x604000=0x0;const _0x7b5e20=0x16345785d8a0000;for(let _0x5e91fc=0x0;_0x5e91fc<=_0x5dd459[_0x1cfd48(0x252)]-0x1;_0x5e91fc++){const _0x16fa43=_0x5dd459[_0x5e91fc];let _0x506a82=_0x1cfd48(0x1dd);_0x506a82+=_0x1cfd48(0x1e6)+_0x16fa43[_0x1cfd48(0x23c)]['dsi']+_0x1cfd48(0x105),_0x506a82+=_0x1cfd48(0x1e6)+_0x16fa43['_id'][_0x1cfd48(0xfb)]+'</td>',_0x506a82+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x16fa43[_0x1cfd48(0x23c)][_0x1cfd48(0x1b2)]+_0x1cfd48(0x105);let _0x1bbbf9={};var _0x110a6a=0x0;for(let _0x45206e=0x0;_0x45206e<=_0x16fa43[_0x1cfd48(0x1a6)][_0x1cfd48(0x252)]-0x1;_0x45206e++){const _0x457ef9=_0x16fa43[_0x1cfd48(0x1a6)][_0x45206e];_0x1bbbf9[_0x457ef9[_0x1cfd48(0x1e5)]+'-'+_0x457ef9['category']]=_0x457ef9[_0x1cfd48(0x193)];const _0x412199=_0x457ef9['brand']+'-'+_0x457ef9[_0x1cfd48(0x141)];!_0x39f62e[_0x412199]&&(_0x39f62e[_0x412199]=0x0),!Array[_0x1cfd48(0x1b4)](_0xe54ca6[_0x412199])&&(_0xe54ca6[_0x412199]=[]),!Array[_0x1cfd48(0x1b4)](_0xe54ca6[_0x412199])&&(_0xe54ca6[_0x412199]=[]),_0x39f62e[_0x412199]+=_0x457ef9[_0x1cfd48(0x193)],_0xe54ca6[_0x412199][_0x1cfd48(0x1d2)](_0x457ef9[_0x1cfd48(0x193)]),_0x110a6a++;}console[_0x1cfd48(0x233)](_0x16fa43);for(let _0x1b1f8f=0x0;_0x1b1f8f<=_0x411217['cat_brand'][_0x1cfd48(0x252)]-0x1;_0x1b1f8f++){const _0x3b9f20=_0x411217['cat_brand'][_0x1b1f8f],_0xa23770=_0x3b9f20['_id']['brand']+'-'+_0x3b9f20[_0x1cfd48(0x23c)][_0x1cfd48(0x141)];_0x506a82+=_0x1cfd48(0x1a0)+(_0x1bbbf9[_0xa23770]!==undefined?_0x1bbbf9[_0xa23770][_0x1cfd48(0xe5)](0x2):'')+_0x1cfd48(0x105);}_0x18e0ab=_0x16fa43['discount']+_0x16fa43[_0x1cfd48(0x1ee)],_0x506a82+=_0x1cfd48(0x19a)+formatNumber(parseFloat(_0x16fa43[_0x1cfd48(0x20d)],0x2)[_0x1cfd48(0xe5)](0x2))+_0x1cfd48(0x105),_0x506a82+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x16fa43['totalGross']['toFixed'](0x2))+_0x1cfd48(0x105),_0x506a82+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x18e0ab)+_0x1cfd48(0x105),_0x506a82+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x16fa43[_0x1cfd48(0x1bf)]['toFixed'](0x2))+_0x1cfd48(0x105),_0x506a82+=_0x1cfd48(0xf3),_0x43dcf0+=parseFloat(_0x16fa43['totalQty'][_0x1cfd48(0xe5)](0x2)),_0x489e8e+=parseFloat(_0x16fa43[_0x1cfd48(0x1bf)][_0x1cfd48(0xe5)](0x2)),_0x4ce6bf+=_0x18e0ab,_0x604000+=parseFloat(_0x16fa43['totalGross'][_0x1cfd48(0xe5)](0x2));if(_0x5e91fc==_0x5dd459[_0x1cfd48(0x252)]-0x1){_0x506a82+='<tr>',_0x506a82+=_0x1cfd48(0x1f4),_0x506a82+=_0x1cfd48(0x105);for(let _0x58cc20=0x0;_0x58cc20<=_0x411217[_0x1cfd48(0xe7)][_0x1cfd48(0x252)]-0x1;_0x58cc20++){const _0x4868ff=_0x411217[_0x1cfd48(0xe7)][_0x58cc20],_0x2a090f=_0x4868ff['_id'][_0x1cfd48(0x1e5)]+'-'+_0x4868ff['_id'][_0x1cfd48(0x141)];!_0xe54ca6[_0x2a090f]&&(_0xe54ca6[_0x2a090f]=[]);const _0x171e00=_0xe54ca6[_0x2a090f][_0x1cfd48(0x140)]((_0xc9728f,_0x332c24)=>_0xc9728f+_0x332c24,0x0);console['log']('test',_0x2a090f),_0x506a82+=_0x1cfd48(0x232)+(_0x171e00!==undefined?formatNumber(_0x171e00[_0x1cfd48(0xe5)](0x2)):'')+'</b></td>',console[_0x1cfd48(0x233)](_0xe54ca6[_0x2a090f][_0x1cfd48(0x140)]((_0x288c11,_0x11bbcf)=>_0x288c11+_0x11bbcf,0x0));}_0x506a82+=_0x1cfd48(0x1c3)+formatNumber(_0x43dcf0[_0x1cfd48(0xe5)](0x2))+_0x1cfd48(0x154),_0x506a82+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x604000)+'</b></td>',_0x506a82+=_0x1cfd48(0x1c3)+formatNumber(_0x4ce6bf)+_0x1cfd48(0x154),_0x506a82+=_0x1cfd48(0x1c3)+formatNumber(_0x489e8e)+'</b></td>',_0x506a82+=_0x1cfd48(0xf3);}_0x4b6bd7[_0x1cfd48(0x1d2)](_0x506a82);}function _0x5283a2(_0x5d2a7c,_0x21ab1f){const _0x565f45=_0x1cfd48,_0x76582e=[];for(let _0x804126=0x0;_0x804126<=_0x5d2a7c[_0x565f45(0x252)]-0x1;_0x804126+=_0x21ab1f){_0x76582e['push'](_0x5d2a7c[_0x565f45(0x167)](_0x804126,_0x804126+_0x21ab1f));}return _0x76582e;}const _0x1d7886=_0x5283a2(_0x4b6bd7,_0x7b5e20);let _0x5a2444='';return _0x1d7886['forEach']((_0x4355c6,_0x295e7a)=>{const _0xb6ce=_0x1cfd48;_0x295e7a>0x0&&(_0x5a2444+=_0xb6ce(0x16b));_0x5a2444+=_0xb6ce(0x1ef),_0x5a2444+=_0xb6ce(0x171),_0x5a2444+=_0xb6ce(0x1dd),_0x5a2444+=_0xb6ce(0x22d),_0x5a2444+=_0xb6ce(0xf3),_0x5a2444+=_0xb6ce(0x1dd),_0x5a2444+=_0xb6ce(0x202);for(let _0x11e637=0x0;_0x11e637<=_0x77a4a8['length']-0x1;_0x11e637++){const _0x3fbc93=_0x77a4a8[_0x11e637];for(let _0x2a7cad=0x0;_0x2a7cad<_0xde438a[_0xb6ce(0x252)];_0x2a7cad++){const _0x2b3d93=_0xde438a[_0x2a7cad];_0x2b3d93[_0xb6ce(0x23c)]===_0x3fbc93[_0xb6ce(0x23c)][_0xb6ce(0x141)]&&(_0x5a2444+='<td\x20colspan=\x22'+_0x2b3d93[_0xb6ce(0x24c)]+_0xb6ce(0x19f)+_0x3fbc93[_0xb6ce(0x23c)][_0xb6ce(0x141)]+_0xb6ce(0x105));}}_0x5a2444+=_0xb6ce(0x1f9),_0x5a2444+='</tr>',_0x5a2444+=_0xb6ce(0x1dd),_0x5a2444+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x5a2444+=_0xb6ce(0xf1),_0x5a2444+=_0xb6ce(0x179);for(let _0x51482f=0x0;_0x51482f<=_0x77a4a8['length']-0x1;_0x51482f++){const _0x61bc97=_0x77a4a8[_0x51482f];for(let _0x3d40a8=0x0;_0x3d40a8<_0x411217[_0xb6ce(0xe7)][_0xb6ce(0x252)];_0x3d40a8++){const _0x11a8cc=_0x411217[_0xb6ce(0xe7)][_0x3d40a8];_0x11a8cc[_0xb6ce(0x23c)]['category']===_0x61bc97[_0xb6ce(0x23c)]['category']&&(_0x5a2444+='<td\x20class=\x22cat_data\x22>'+_0x11a8cc[_0xb6ce(0x23c)][_0xb6ce(0x1e5)]+'</td>');}}_0x5a2444+=_0xb6ce(0x1e8),_0x5a2444+=_0xb6ce(0x242),_0x5a2444+=_0xb6ce(0x148),_0x5a2444+=_0xb6ce(0x17e),_0x5a2444+=_0xb6ce(0xf3),_0x5a2444+=_0xb6ce(0x11f),_0x5a2444+=_0xb6ce(0x1a5),_0x4355c6[_0xb6ce(0x235)](_0x5218db=>{_0x5a2444+=_0x5218db;}),console['log'](_0xe54ca6),_0x5a2444+=_0xb6ce(0xe0),_0x5a2444+='</table>';}),_0x5a2444;}router['post'](a0_0x58bbe1(0x228),auth,async(_0x1bf2c4,_0x45205a)=>{const _0x2673a5=a0_0x58bbe1,{from_date:_0x3d4416,to_date:_0x135c06,isExcel:_0x4b2275,agent_id:_0x4dc3aa}=_0x1bf2c4[_0x2673a5(0x1ca)],_0x13fa4f=_0x1bf2c4['user'],_0x2bffec=await staff[_0x2673a5(0x130)]({'email':_0x13fa4f['email']}),_0x208939=await master_shop[_0x2673a5(0x203)](),_0x539549=await agentsdataDSICheck_admin(_0x3d4416,_0x135c06,_0x4dc3aa,_0x4b2275),_0x53413f=await agentsdataDSICheck_admin_excel(_0x3d4416,_0x135c06,_0x4dc3aa,_0x4b2275);let _0x521004=_0x2673a5(0xee);var _0x311279=new Date(_0x3d4416),_0x1921d9=new Date(_0x135c06);const _0x19019b={'year':_0x2673a5(0x23e),'month':_0x2673a5(0x1aa),'day':_0x2673a5(0x23e)},_0x4e80bd=new Intl[(_0x2673a5(0x1e9))](_0x2673a5(0x166),_0x19019b)[_0x2673a5(0x16f)](_0x311279),_0x2c623e=new Intl[(_0x2673a5(0x1e9))](_0x2673a5(0x166),_0x19019b)[_0x2673a5(0x16f)](_0x1921d9);_0x521004+=_0x2673a5(0x1cb),_0x521004+='<div\x20\x20id=\x22table-conatainer\x22>',_0x521004+=_0x2673a5(0x1ef),_0x521004+=_0x539549,_0x521004+=_0x2673a5(0xe4),_0x521004+=_0x2673a5(0x19e),_0x521004+=_0x2673a5(0x19e);let _0x4db0e3=_0x2673a5(0xee);_0x4db0e3+='<div\x20class=\x22row\x22>',_0x4db0e3+='<div\x20\x20id=\x22table-conatainer\x22>',_0x4db0e3+=_0x2673a5(0x1ef),_0x4db0e3+=_0x53413f,_0x4db0e3+=_0x2673a5(0xe4),_0x4db0e3+=_0x2673a5(0x19e),_0x4db0e3+='</div>';let _0x1f20c7=_0x2673a5(0x22f);const _0x1c903a={'width':_0x2673a5(0x1ec),'height':_0x2673a5(0x1a3),'orientation':_0x2673a5(0x1f7),'border':{'top':_0x2673a5(0x244),'right':_0x2673a5(0x244),'bottom':_0x2673a5(0x244),'left':_0x2673a5(0x244)},'header':{'height':_0x2673a5(0x18d),'contents':_0x2673a5(0x10d)+_0x1f20c7+_0x2673a5(0x239)+_0x4e80bd+'\x20-\x20'+_0x2c623e+_0x2673a5(0x253)},'footer':{'height':'20mm','contents':{'default':_0x2673a5(0x16e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x4b2275=='on'){const _0x4178cf=cheerio[_0x2673a5(0xff)](_0x4db0e3);let _0x3b0fb2=[],_0x10fa24=[],_0x2cfedf=[];_0x4178cf(_0x2673a5(0x207))[_0x2673a5(0x236)]((_0x36621f,_0x17801e)=>{const _0x44ce35=_0x2673a5;let _0x385c79=[],_0x5742eb=0x0;while(_0x2cfedf[_0x5742eb]){_0x2cfedf[_0x5742eb]--,_0x5742eb++;}_0x4178cf(_0x17801e)[_0x44ce35(0x203)](_0x44ce35(0x165))['each']((_0x2ba79c,_0x325671)=>{const _0xeb1777=_0x44ce35;let _0x4a2963=_0x4178cf(_0x325671)[_0xeb1777(0x1fe)]()[_0xeb1777(0x257)](),_0x4ef3f6=parseFloat(_0x4a2963[_0xeb1777(0x1c9)](/,/g,''));isNaN(_0x4ef3f6)&&(_0x4ef3f6=_0x4a2963);let _0x50cbec=parseInt(_0x4178cf(_0x325671)[_0xeb1777(0x118)](_0xeb1777(0x14e)))||0x1,_0x4d0c54=parseInt(_0x4178cf(_0x325671)[_0xeb1777(0x118)](_0xeb1777(0x23b)))||0x1;_0x385c79[_0x5742eb]=_0x4ef3f6;(_0x50cbec>0x1||_0x4d0c54>0x1)&&_0x10fa24[_0xeb1777(0x1d2)]({'s':{'r':_0x36621f,'c':_0x5742eb},'e':{'r':_0x36621f+_0x4d0c54-0x1,'c':_0x5742eb+_0x50cbec-0x1}});for(let _0x1d6ac8=0x0;_0x1d6ac8<_0x50cbec;_0x1d6ac8++){_0x4d0c54>0x1&&(_0x2cfedf[_0x5742eb+_0x1d6ac8]=_0x4d0c54-0x1);}_0x5742eb+=_0x50cbec;}),_0x3b0fb2[_0x44ce35(0x1d2)](_0x385c79);});const _0x253e58=XLSX[_0x2673a5(0x192)][_0x2673a5(0x17c)](),_0x246482=XLSX[_0x2673a5(0x192)][_0x2673a5(0xe3)](_0x3b0fb2);_0x10fa24['length']>0x0&&(_0x246482[_0x2673a5(0x191)]=_0x10fa24);_0x246482['!cols']=_0x3b0fb2[0x0][_0x2673a5(0x151)](()=>({'wpx':0x64})),XLSX[_0x2673a5(0x192)][_0x2673a5(0x112)](_0x253e58,_0x246482,'Sales\x20Report');const _0x38b4a2=XLSX[_0x2673a5(0x12e)](_0x253e58,{'bookType':'xlsx','type':'buffer'});_0x45205a[_0x2673a5(0x254)]('Content-Disposition',_0x2673a5(0x1f5)),_0x45205a[_0x2673a5(0x254)](_0x2673a5(0x262),_0x2673a5(0x104)),_0x45205a[_0x2673a5(0x13f)](_0x38b4a2);}else pdf[_0x2673a5(0x149)](_0x521004,_0x1c903a)['toStream'](function(_0x2b5ee7,_0x2c42cf){const _0x351836=_0x2673a5;if(_0x2b5ee7){_0x45205a[_0x351836(0x183)](0x1f4)[_0x351836(0x13f)](_0x351836(0x176));return;}_0x45205a[_0x351836(0x254)]('Content-Type',_0x351836(0x213)),_0x2c42cf[_0x351836(0x122)](_0x45205a);});}),router['get']('/agent_reports/view',auth,async(_0x394047,_0x2c5f4c)=>{const _0xc61568=a0_0x58bbe1;try{const {username:_0x11ef0f,email:_0x141b45,role:_0x16b52d}=_0x394047['user'],_0x159ec8=_0x394047[_0xc61568(0x1fc)],_0x261de7=await profile[_0xc61568(0x130)]({'email':_0x159ec8['email']}),_0x46415e={'year':_0xc61568(0x23e),'month':'long','day':_0xc61568(0x23e)},_0x4af4c2=await master_shop[_0xc61568(0x203)](),_0x1332c0=await staff[_0xc61568(0x130)]({'email':_0x159ec8['email']}),_0x5c6e82=await product[_0xc61568(0x203)](),_0x1bcfe1=await warehouse[_0xc61568(0x12c)]([{'$unwind':_0xc61568(0xe2)},{'$lookup':{'from':_0xc61568(0x1a6),'localField':_0xc61568(0x131),'foreignField':'name','as':'product_docs'}},{'$unwind':_0xc61568(0x123)},{'$project':{'product_name':_0xc61568(0x1d9),'product_stock':_0xc61568(0x220)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0xc61568(0x102)}}}]);if(_0x4af4c2[0x0][_0xc61568(0x218)]==_0xc61568(0x1be))var _0x41de7c=users[_0xc61568(0x147)];else{if(_0x4af4c2[0x0]['language']==_0xc61568(0xf2))var _0x41de7c=users[_0xc61568(0xf2)];else{if(_0x4af4c2[0x0]['language']==_0xc61568(0x205))var _0x41de7c=users[_0xc61568(0x205)];else{if(_0x4af4c2[0x0][_0xc61568(0x218)]==_0xc61568(0x14c))var _0x41de7c=users[_0xc61568(0x14c)];else{if(_0x4af4c2[0x0][_0xc61568(0x218)]==_0xc61568(0x25b))var _0x41de7c=users[_0xc61568(0x25b)];else{if(_0x4af4c2[0x0][_0xc61568(0x218)]==_0xc61568(0x15f))var _0x41de7c=users[_0xc61568(0x222)];else{if(_0x4af4c2[0x0][_0xc61568(0x218)]==_0xc61568(0x24a))var _0x41de7c=users[_0xc61568(0x24a)];else{if(_0x4af4c2[0x0][_0xc61568(0x218)]=='Arabic\x20(ae)')var _0x41de7c=users['Arabic'];}}}}}}}_0x2c5f4c['render'](_0xc61568(0xdd),{'success':_0x394047['flash'](_0xc61568(0x12a)),'errors':_0x394047[_0xc61568(0x158)](_0xc61568(0x16d)),'alldata':_0x5c6e82,'profile':_0x261de7,'master_shop':_0x4af4c2,'role':_0x159ec8,'product_stock':_0x1bcfe1,'language':_0x41de7c,'staff_arr':_0x1332c0});}catch(_0x404bea){}});function formatNumber(_0x3407a9,_0x112228='en-US',_0x2dda4a={'minimumFractionDigits':0x2}){const _0x3c31b8=new Intl['NumberFormat'](_0x112228,_0x2dda4a);return _0x3c31b8['format'](_0x3407a9);}async function agentsdataDSICheck(_0x42f6da,_0x13c297,_0x5224eb,_0x36d68c){const _0x251fe3=a0_0x58bbe1,_0x1583ee=await product[_0x251fe3(0x12c)]([{'$group':{'_id':{'brand':_0x251fe3(0x1b1),'category':_0x251fe3(0x127)},'products':{'$push':{'name':'$name','product_code':_0x251fe3(0x101)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x22e6de=[];_0x22e6de['cat_brand']=[];for(let _0x4eb7b9=0x0;_0x4eb7b9<=_0x1583ee[_0x251fe3(0x252)]-0x1;_0x4eb7b9++){const _0x204fe5=_0x1583ee[_0x4eb7b9];_0x22e6de[_0x251fe3(0xe7)][_0x251fe3(0x1d2)](_0x204fe5);}const _0x442954=await product[_0x251fe3(0x12c)]([{'$group':{'_id':{'category':_0x251fe3(0x127)},'products':{'$push':{'brand':_0x251fe3(0x1b1),'product_code':_0x251fe3(0x101),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1ce178=await product[_0x251fe3(0x12c)]([{'$group':{'_id':{'category':_0x251fe3(0x127),'brand':_0x251fe3(0x1b1)}}},{'$group':{'_id':_0x251fe3(0x1c0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x23c165=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x42f6da,'$lte':_0x13c297},'sales_staff_id':_0x5224eb,'sale_product.isFG':_0x251fe3(0x1fd),'status_data':_0x251fe3(0x1fd)}},{'$unwind':_0x251fe3(0xeb)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x251fe3(0x129),'foreignField':'product_code','as':_0x251fe3(0x249)}},{'$unwind':_0x251fe3(0x1ff)},{'$group':{'_id':{'dsi':_0x251fe3(0x1eb),'date':_0x251fe3(0x143),'customer':'$customer'},'totalQty':{'$sum':_0x251fe3(0x248)},'products':{'$push':{'qty':_0x251fe3(0x248),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0x251fe3(0x12f),'product_details':{'prod_name':_0x251fe3(0x20f),'product_code':'$product_info.product_code','category':_0x251fe3(0x1e4),'brand':'$product_info.brand','gross_price':_0x251fe3(0x168)}}}}},{'$unwind':_0x251fe3(0xf9)},{'$group':{'_id':{'dsi':_0x251fe3(0x120),'date':_0x251fe3(0x162),'customer':_0x251fe3(0x117),'category':_0x251fe3(0x1fb),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x251fe3(0x230)},'totalGross':{'$sum':{'$multiply':[_0x251fe3(0x230),_0x251fe3(0x164)]}},'NetPrice':{'$sum':_0x251fe3(0x172)},'discount':{'$sum':_0x251fe3(0x221)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x251fe3(0x120),'date':'$_id.date','customer':_0x251fe3(0x117)},'totalQty':{'$sum':_0x251fe3(0xe9)},'totalGross':{'$sum':_0x251fe3(0x13c)},'NetPrice':{'$sum':_0x251fe3(0x182)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x251fe3(0x11a)},'products':{'$push':{'qty':_0x251fe3(0xe9),'category':_0x251fe3(0x1c0),'brand':_0x251fe3(0x1a2),'product_details':_0x251fe3(0xe2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x448733=[],_0x207b47={},_0x183626={},_0x4b7926={};var _0x4f20b9=0x0,_0x483618=0x0,_0x4b75e2=0x0,_0x321b55=0x0,_0x5783bc=0x0;const _0x1234c5=0x6;for(let _0x8719c1=0x0;_0x8719c1<=_0x23c165[_0x251fe3(0x252)]-0x1;_0x8719c1++){const _0x6d0c49=_0x23c165[_0x8719c1];let _0x2d4609=_0x251fe3(0x1dd);_0x2d4609+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x6d0c49[_0x251fe3(0x23c)][_0x251fe3(0x250)]+_0x251fe3(0x105),_0x2d4609+=_0x251fe3(0x1e6)+_0x6d0c49[_0x251fe3(0x23c)][_0x251fe3(0xfb)]+_0x251fe3(0x105),_0x2d4609+=_0x251fe3(0x1e6)+_0x6d0c49[_0x251fe3(0x23c)][_0x251fe3(0x1b2)]+'</td>';let _0x5924ff={};var _0x4ee2fb=0x0;for(let _0x5195bf=0x0;_0x5195bf<=_0x6d0c49[_0x251fe3(0x1a6)][_0x251fe3(0x252)]-0x1;_0x5195bf++){const _0x21619a=_0x6d0c49[_0x251fe3(0x1a6)][_0x5195bf];_0x5924ff[_0x21619a[_0x251fe3(0x1e5)]+'-'+_0x21619a['category']]=_0x21619a[_0x251fe3(0x193)];const _0x3b8fd8=_0x21619a['brand']+'-'+_0x21619a[_0x251fe3(0x141)];!_0x207b47[_0x3b8fd8]&&(_0x207b47[_0x3b8fd8]=0x0),!Array['isArray'](_0x4b7926[_0x3b8fd8])&&(_0x4b7926[_0x3b8fd8]=[]),!Array[_0x251fe3(0x1b4)](_0x4b7926[_0x3b8fd8])&&(_0x4b7926[_0x3b8fd8]=[]),_0x207b47[_0x3b8fd8]+=_0x21619a['qty'],_0x4b7926[_0x3b8fd8][_0x251fe3(0x1d2)](_0x21619a[_0x251fe3(0x193)]),_0x4ee2fb++;}for(let _0x6967b3=0x0;_0x6967b3<=_0x22e6de[_0x251fe3(0xe7)][_0x251fe3(0x252)]-0x1;_0x6967b3++){const _0x1ee701=_0x22e6de[_0x251fe3(0xe7)][_0x6967b3],_0x24835a=_0x1ee701[_0x251fe3(0x23c)][_0x251fe3(0x1e5)]+'-'+_0x1ee701['_id'][_0x251fe3(0x141)];_0x2d4609+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x5924ff[_0x24835a]!==undefined?_0x5924ff[_0x24835a][_0x251fe3(0xe5)](0x2):'')+'</td>';}_0x4b75e2=_0x6d0c49[_0x251fe3(0xec)]+_0x6d0c49['adj_discount'],_0x2d4609+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x6d0c49[_0x251fe3(0x20d)],0x2)['toFixed'](0x2))+_0x251fe3(0x105),_0x2d4609+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x6d0c49[_0x251fe3(0x161)][_0x251fe3(0xe5)](0x2))+_0x251fe3(0x105),_0x2d4609+=_0x251fe3(0x19a)+formatNumber(_0x4b75e2)+_0x251fe3(0x105),_0x2d4609+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x6d0c49['NetPrice'][_0x251fe3(0xe5)](0x2))+_0x251fe3(0x105),_0x2d4609+=_0x251fe3(0xf3),_0x4f20b9+=parseFloat(_0x6d0c49['totalQty']),_0x483618+=parseFloat(_0x6d0c49[_0x251fe3(0x1bf)]['toFixed'](0x2)),_0x321b55+=_0x4b75e2,_0x5783bc+=parseFloat(_0x6d0c49[_0x251fe3(0x161)]['toFixed'](0x2));if(_0x8719c1==_0x23c165['length']-0x1){_0x2d4609+='<tr>',_0x2d4609+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x2d4609+=_0x251fe3(0x105);for(let _0x4bce4c=0x0;_0x4bce4c<=_0x22e6de[_0x251fe3(0xe7)]['length']-0x1;_0x4bce4c++){const _0x253cea=_0x22e6de[_0x251fe3(0xe7)][_0x4bce4c],_0x148337=_0x253cea[_0x251fe3(0x23c)][_0x251fe3(0x1e5)]+'-'+_0x253cea['_id'][_0x251fe3(0x141)];!_0x4b7926[_0x148337]&&(_0x4b7926[_0x148337]=[]);const _0x1f3071=_0x4b7926[_0x148337][_0x251fe3(0x140)]((_0x5decda,_0x4c131e)=>_0x5decda+_0x4c131e,0x0);_0x2d4609+=_0x251fe3(0x232)+(_0x1f3071!==undefined?formatNumber(_0x1f3071[_0x251fe3(0xe5)](0x2)):'')+_0x251fe3(0x154);}_0x2d4609+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4f20b9[_0x251fe3(0xe5)](0x2))+_0x251fe3(0x154),_0x2d4609+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5783bc)+'</b></td>',_0x2d4609+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x321b55)+_0x251fe3(0x154),_0x2d4609+=_0x251fe3(0x1c3)+formatNumber(_0x483618)+_0x251fe3(0x154),_0x2d4609+=_0x251fe3(0xf3);}console[_0x251fe3(0x233)](_0x251fe3(0x1e0),_0x4f20b9+'+='+parseFloat(_0x6d0c49['totalQty'])),_0x448733[_0x251fe3(0x1d2)](_0x2d4609);}function _0x2a031f(_0x2df703,_0x2689fe){const _0x5a7a46=_0x251fe3,_0x309865=[];for(let _0x3b422e=0x0;_0x3b422e<=_0x2df703[_0x5a7a46(0x252)]-0x1;_0x3b422e+=_0x2689fe){_0x309865['push'](_0x2df703['slice'](_0x3b422e,_0x3b422e+_0x2689fe));}return _0x309865;}const _0x176ec4=_0x2a031f(_0x448733,_0x1234c5);let _0x27c223='';return _0x176ec4[_0x251fe3(0x235)]((_0x306359,_0x189eba)=>{const _0x2f06be=_0x251fe3;_0x189eba>0x0&&(_0x27c223+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x27c223+=_0x2f06be(0x1ef),_0x27c223+='<thead>',_0x27c223+='<tr>',_0x27c223+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x27c223+=_0x2f06be(0xf3),_0x27c223+=_0x2f06be(0x1dd),_0x27c223+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x303a0b=0x0;_0x303a0b<=_0x442954[_0x2f06be(0x252)]-0x1;_0x303a0b++){const _0x2fe2f9=_0x442954[_0x303a0b];for(let _0x25b385=0x0;_0x25b385<_0x1ce178[_0x2f06be(0x252)];_0x25b385++){const _0x3f6c8d=_0x1ce178[_0x25b385];_0x3f6c8d['_id']===_0x2fe2f9[_0x2f06be(0x23c)][_0x2f06be(0x141)]&&(_0x27c223+=_0x2f06be(0x1c2)+_0x3f6c8d[_0x2f06be(0x24c)]+_0x2f06be(0x19f)+_0x2fe2f9[_0x2f06be(0x23c)][_0x2f06be(0x141)]+'</td>');}}_0x27c223+=_0x2f06be(0x1f9),_0x27c223+=_0x2f06be(0xf3),_0x27c223+=_0x2f06be(0x1dd),_0x27c223+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x27c223+=_0x2f06be(0xf1),_0x27c223+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x1945af=0x0;_0x1945af<=_0x442954['length']-0x1;_0x1945af++){const _0x4bdc33=_0x442954[_0x1945af];for(let _0x22852a=0x0;_0x22852a<_0x22e6de[_0x2f06be(0xe7)][_0x2f06be(0x252)];_0x22852a++){const _0x41f4a4=_0x22e6de['cat_brand'][_0x22852a];_0x41f4a4[_0x2f06be(0x23c)]['category']===_0x4bdc33[_0x2f06be(0x23c)]['category']&&(_0x27c223+=_0x2f06be(0x180)+_0x41f4a4[_0x2f06be(0x23c)][_0x2f06be(0x1e5)]+'</td>');}}_0x27c223+=_0x2f06be(0x1e8),_0x27c223+=_0x2f06be(0x242),_0x27c223+=_0x2f06be(0x148),_0x27c223+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x27c223+='</tr>',_0x27c223+=_0x2f06be(0x11f),_0x27c223+=_0x2f06be(0x1a5),_0x306359[_0x2f06be(0x235)](_0x53aacf=>{_0x27c223+=_0x53aacf;}),_0x27c223+='</tbody>',_0x27c223+='</table>';}),_0x27c223;}async function agentsdataDSICheck_excel(_0x275896,_0x5b130b,_0x1ef586,_0x11a99c){const _0x2f164a=a0_0x58bbe1,_0x391a52=await product[_0x2f164a(0x12c)]([{'$group':{'_id':{'brand':_0x2f164a(0x1b1),'category':'$category'},'products':{'$push':{'name':_0x2f164a(0x22b),'product_code':_0x2f164a(0x101)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x400de6=[];_0x400de6[_0x2f164a(0xe7)]=[];for(let _0x20a4b1=0x0;_0x20a4b1<=_0x391a52[_0x2f164a(0x252)]-0x1;_0x20a4b1++){const _0x2f042c=_0x391a52[_0x20a4b1];_0x400de6[_0x2f164a(0xe7)][_0x2f164a(0x1d2)](_0x2f042c);}const _0x577c16=await product['aggregate']([{'$group':{'_id':{'category':_0x2f164a(0x127)},'products':{'$push':{'brand':_0x2f164a(0x1b1),'product_code':_0x2f164a(0x101),'product_name':_0x2f164a(0x22b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x2ce91d=await product['aggregate']([{'$group':{'_id':{'category':_0x2f164a(0x127),'brand':_0x2f164a(0x1b1)}}},{'$group':{'_id':_0x2f164a(0x1c0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x472d7d=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x275896,'$lte':_0x5b130b},'sales_staff_id':_0x1ef586,'sale_product.isFG':_0x2f164a(0x1fd)}},{'$unwind':_0x2f164a(0xeb)},{'$match':{'sale_product.isFG':_0x2f164a(0x1fd)}},{'$lookup':{'from':_0x2f164a(0x1a6),'localField':_0x2f164a(0x129),'foreignField':_0x2f164a(0x1b5),'as':_0x2f164a(0x249)}},{'$unwind':_0x2f164a(0x1ff)},{'$group':{'_id':{'dsi':'$dsi','date':_0x2f164a(0x143),'customer':_0x2f164a(0x10f)},'totalQty':{'$sum':_0x2f164a(0x248)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x2f164a(0x263),'discount':'$sale_product.discount','adj_discount':_0x2f164a(0x12f),'product_details':{'prod_name':'$product_info.name','product_code':_0x2f164a(0xf6),'category':_0x2f164a(0x1e4),'brand':_0x2f164a(0x17d),'gross_price':_0x2f164a(0x168)}}}}},{'$unwind':_0x2f164a(0xf9)},{'$group':{'_id':{'dsi':_0x2f164a(0x120),'date':_0x2f164a(0x162),'customer':_0x2f164a(0x117),'category':'$products.product_details.category','brand':_0x2f164a(0x21c)},'totalQty':{'$sum':_0x2f164a(0x230)},'totalGross':{'$sum':{'$multiply':[_0x2f164a(0x230),_0x2f164a(0x164)]}},'NetPrice':{'$sum':_0x2f164a(0x172)},'discount':{'$sum':_0x2f164a(0x221)},'adj_discount':{'$sum':_0x2f164a(0x22a)},'product_details':{'$first':_0x2f164a(0x198)}}},{'$group':{'_id':{'dsi':_0x2f164a(0x120),'date':_0x2f164a(0x162),'customer':_0x2f164a(0x117)},'totalQty':{'$sum':_0x2f164a(0xe9)},'totalGross':{'$sum':_0x2f164a(0x13c)},'NetPrice':{'$sum':_0x2f164a(0x182)},'discount':{'$sum':_0x2f164a(0x115)},'adj_discount':{'$sum':_0x2f164a(0x11a)},'products':{'$push':{'qty':_0x2f164a(0xe9),'category':_0x2f164a(0x1c0),'brand':_0x2f164a(0x1a2),'product_details':_0x2f164a(0xe2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x3b0196=[],_0x1fa033={},_0x3669ce={},_0x5b9d83={};var _0x3a2c07=0x0,_0x195c91=0x0,_0x50765c=0x0,_0x3d1c7f=0x0,_0x22cf23=0x0;const _0x311a56=0x9184e72a000;for(let _0x28c66a=0x0;_0x28c66a<=_0x472d7d[_0x2f164a(0x252)]-0x1;_0x28c66a++){const _0x464d11=_0x472d7d[_0x28c66a];let _0x4bff9a=_0x2f164a(0x1dd);_0x4bff9a+=_0x2f164a(0x1e6)+_0x464d11[_0x2f164a(0x23c)][_0x2f164a(0x250)]+'</td>',_0x4bff9a+=_0x2f164a(0x1e6)+_0x464d11[_0x2f164a(0x23c)][_0x2f164a(0xfb)]+_0x2f164a(0x105),_0x4bff9a+=_0x2f164a(0x1e6)+_0x464d11[_0x2f164a(0x23c)][_0x2f164a(0x1b2)]+_0x2f164a(0x105);let _0x494fa0={};var _0x2aaa56=0x0;for(let _0x345f29=0x0;_0x345f29<=_0x464d11[_0x2f164a(0x1a6)][_0x2f164a(0x252)]-0x1;_0x345f29++){const _0x45ef47=_0x464d11[_0x2f164a(0x1a6)][_0x345f29];_0x494fa0[_0x45ef47['brand']+'-'+_0x45ef47[_0x2f164a(0x141)]]=_0x45ef47[_0x2f164a(0x193)];const _0xeaeb29=_0x45ef47[_0x2f164a(0x1e5)]+'-'+_0x45ef47[_0x2f164a(0x141)];!_0x1fa033[_0xeaeb29]&&(_0x1fa033[_0xeaeb29]=0x0),!Array['isArray'](_0x5b9d83[_0xeaeb29])&&(_0x5b9d83[_0xeaeb29]=[]),!Array[_0x2f164a(0x1b4)](_0x5b9d83[_0xeaeb29])&&(_0x5b9d83[_0xeaeb29]=[]),_0x1fa033[_0xeaeb29]+=_0x45ef47[_0x2f164a(0x193)],_0x5b9d83[_0xeaeb29]['push'](_0x45ef47[_0x2f164a(0x193)]),_0x2aaa56++;}for(let _0x560c08=0x0;_0x560c08<=_0x400de6['cat_brand'][_0x2f164a(0x252)]-0x1;_0x560c08++){const _0x34e40e=_0x400de6[_0x2f164a(0xe7)][_0x560c08],_0x4c1b55=_0x34e40e[_0x2f164a(0x23c)][_0x2f164a(0x1e5)]+'-'+_0x34e40e[_0x2f164a(0x23c)][_0x2f164a(0x141)];_0x4bff9a+=_0x2f164a(0x1a0)+(_0x494fa0[_0x4c1b55]!==undefined?_0x494fa0[_0x4c1b55]['toFixed'](0x2):'')+_0x2f164a(0x105);}_0x50765c=_0x464d11[_0x2f164a(0xec)]+_0x464d11[_0x2f164a(0x1ee)],_0x4bff9a+=_0x2f164a(0x19a)+formatNumber(parseFloat(_0x464d11[_0x2f164a(0x20d)],0x2)[_0x2f164a(0xe5)](0x2))+'</td>',_0x4bff9a+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x464d11[_0x2f164a(0x161)]['toFixed'](0x2))+_0x2f164a(0x105),_0x4bff9a+=_0x2f164a(0x19a)+formatNumber(_0x50765c)+_0x2f164a(0x105),_0x4bff9a+=_0x2f164a(0x19a)+formatNumber(_0x464d11[_0x2f164a(0x1bf)][_0x2f164a(0xe5)](0x2))+_0x2f164a(0x105),_0x4bff9a+=_0x2f164a(0xf3),_0x3a2c07+=parseFloat(_0x464d11[_0x2f164a(0x20d)][_0x2f164a(0xe5)](0x2)),_0x195c91+=parseFloat(_0x464d11[_0x2f164a(0x1bf)][_0x2f164a(0xe5)](0x2)),_0x3d1c7f+=_0x50765c,_0x22cf23+=parseFloat(_0x464d11[_0x2f164a(0x161)][_0x2f164a(0xe5)](0x2));if(_0x28c66a==_0x472d7d[_0x2f164a(0x252)]-0x1){_0x4bff9a+=_0x2f164a(0x1dd),_0x4bff9a+=_0x2f164a(0x1f4),_0x4bff9a+=_0x2f164a(0x105);for(let _0x54508f=0x0;_0x54508f<=_0x400de6[_0x2f164a(0xe7)][_0x2f164a(0x252)]-0x1;_0x54508f++){const _0x5ed184=_0x400de6[_0x2f164a(0xe7)][_0x54508f],_0x26ed81=_0x5ed184[_0x2f164a(0x23c)][_0x2f164a(0x1e5)]+'-'+_0x5ed184[_0x2f164a(0x23c)]['category'];!_0x5b9d83[_0x26ed81]&&(_0x5b9d83[_0x26ed81]=[]);const _0xe14bb0=_0x5b9d83[_0x26ed81]['reduce']((_0x254411,_0x4258c2)=>_0x254411+_0x4258c2,0x0);_0x4bff9a+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0xe14bb0!==undefined?formatNumber(_0xe14bb0[_0x2f164a(0xe5)](0x2)):'')+_0x2f164a(0x154);}_0x4bff9a+=_0x2f164a(0x1c3)+formatNumber(_0x3a2c07[_0x2f164a(0xe5)](0x2))+_0x2f164a(0x154),_0x4bff9a+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x22cf23)+_0x2f164a(0x154),_0x4bff9a+=_0x2f164a(0x1c3)+formatNumber(_0x3d1c7f)+'</b></td>',_0x4bff9a+=_0x2f164a(0x1c3)+formatNumber(_0x195c91)+'</b></td>',_0x4bff9a+='</tr>';}_0x3b0196[_0x2f164a(0x1d2)](_0x4bff9a);}function _0x5029eb(_0x18d57b,_0x1c9892){const _0x7a61d8=_0x2f164a,_0x49f405=[];for(let _0x2677db=0x0;_0x2677db<=_0x18d57b[_0x7a61d8(0x252)]-0x1;_0x2677db+=_0x1c9892){_0x49f405[_0x7a61d8(0x1d2)](_0x18d57b['slice'](_0x2677db,_0x2677db+_0x1c9892));}return _0x49f405;}const _0x36a471=_0x5029eb(_0x3b0196,_0x311a56);let _0x549ec2='';return _0x36a471[_0x2f164a(0x235)]((_0x342e8a,_0x17c04c)=>{const _0x38fcf4=_0x2f164a;_0x17c04c>0x0&&(_0x549ec2+=_0x38fcf4(0x16b));_0x549ec2+='<table>',_0x549ec2+=_0x38fcf4(0x171),_0x549ec2+=_0x38fcf4(0x1dd),_0x549ec2+=_0x38fcf4(0x22d),_0x549ec2+='</tr>',_0x549ec2+=_0x38fcf4(0x1dd),_0x549ec2+=_0x38fcf4(0x202);for(let _0x2f8801=0x0;_0x2f8801<=_0x577c16[_0x38fcf4(0x252)]-0x1;_0x2f8801++){const _0x2a83f7=_0x577c16[_0x2f8801];for(let _0xdffcc9=0x0;_0xdffcc9<_0x2ce91d['length'];_0xdffcc9++){const _0x6b1e18=_0x2ce91d[_0xdffcc9];_0x6b1e18[_0x38fcf4(0x23c)]===_0x2a83f7[_0x38fcf4(0x23c)][_0x38fcf4(0x141)]&&(_0x549ec2+=_0x38fcf4(0x1c2)+_0x6b1e18[_0x38fcf4(0x24c)]+_0x38fcf4(0x19f)+_0x2a83f7[_0x38fcf4(0x23c)][_0x38fcf4(0x141)]+_0x38fcf4(0x105));}}_0x549ec2+=_0x38fcf4(0x1f9),_0x549ec2+='</tr>',_0x549ec2+=_0x38fcf4(0x1dd),_0x549ec2+=_0x38fcf4(0x109),_0x549ec2+=_0x38fcf4(0xf1),_0x549ec2+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x59969b=0x0;_0x59969b<=_0x577c16['length']-0x1;_0x59969b++){const _0x591c46=_0x577c16[_0x59969b];for(let _0x27709c=0x0;_0x27709c<_0x400de6[_0x38fcf4(0xe7)]['length'];_0x27709c++){const _0x5345b7=_0x400de6[_0x38fcf4(0xe7)][_0x27709c];_0x5345b7['_id'][_0x38fcf4(0x141)]===_0x591c46['_id']['category']&&(_0x549ec2+=_0x38fcf4(0x180)+_0x5345b7['_id'][_0x38fcf4(0x1e5)]+'</td>');}}_0x549ec2+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x549ec2+=_0x38fcf4(0x242),_0x549ec2+=_0x38fcf4(0x148),_0x549ec2+=_0x38fcf4(0x17e),_0x549ec2+=_0x38fcf4(0xf3),_0x549ec2+=_0x38fcf4(0x11f),_0x549ec2+='<tbody>',_0x342e8a[_0x38fcf4(0x235)](_0x1f661c=>{_0x549ec2+=_0x1f661c;}),console['log'](_0x5b9d83),_0x549ec2+='</tbody>',_0x549ec2+=_0x38fcf4(0xe4);}),_0x549ec2;}router[a0_0x58bbe1(0x1f1)](a0_0x58bbe1(0x1ac),auth,async(_0x525d98,_0x568633)=>{const _0x310114=a0_0x58bbe1,{from_date:_0x53de92,to_date:_0x2bd5e9,isExcel:_0x1a6fbd}=_0x525d98[_0x310114(0x1ca)],_0x1971e5=_0x525d98[_0x310114(0x1fc)],_0x4cda0a=await staff[_0x310114(0x130)]({'email':_0x1971e5['email']}),_0x336356=await master_shop[_0x310114(0x203)](),_0x1e8710=await agentsdataDSICheck(_0x53de92,_0x2bd5e9,_0x4cda0a[_0x310114(0x23c)][_0x310114(0x1a1)](),_0x1a6fbd),_0x4fe73b=await agentsdataDSICheck_excel(_0x53de92,_0x2bd5e9,_0x4cda0a[_0x310114(0x23c)][_0x310114(0x1a1)](),_0x1a6fbd);let _0x3b3a7e=_0x310114(0x1d0);var _0x43be67=new Date(_0x53de92),_0x5ab554=new Date(_0x2bd5e9);const _0xaf2026={'year':_0x310114(0x23e),'month':_0x310114(0x1aa),'day':_0x310114(0x23e)},_0x2d167d=new Intl[(_0x310114(0x1e9))]('en-US',_0xaf2026)[_0x310114(0x16f)](_0x43be67),_0xca8ae3=new Intl[(_0x310114(0x1e9))](_0x310114(0x166),_0xaf2026)[_0x310114(0x16f)](_0x5ab554);_0x3b3a7e+=_0x310114(0x1cb),_0x3b3a7e+=_0x310114(0x187),_0x3b3a7e+=_0x310114(0x1ef),_0x3b3a7e+=_0x1e8710,_0x3b3a7e+=_0x310114(0xe4),_0x3b3a7e+=_0x310114(0x19e),_0x3b3a7e+=_0x310114(0x19e);let _0x1da038='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x1da038+=_0x310114(0x1cb),_0x1da038+='<div\x20\x20id=\x22table-conatainer\x22>',_0x1da038+='<table>',_0x1da038+=_0x4fe73b,_0x1da038+=_0x310114(0xe4),_0x1da038+=_0x310114(0x19e),_0x1da038+=_0x310114(0x19e);let _0x5a0370=_0x310114(0x22f);const _0x463bde={'width':'15in','height':'8.5in','orientation':_0x310114(0x1f7),'border':{'top':_0x310114(0x244),'right':'0.1in','bottom':_0x310114(0x244),'left':_0x310114(0x244)},'header':{'height':_0x310114(0x18d),'contents':_0x310114(0x10d)+_0x5a0370+_0x310114(0x239)+_0x2d167d+_0x310114(0x1cd)+_0xca8ae3+_0x310114(0x253)},'footer':{'height':_0x310114(0x1b6),'contents':{'default':_0x310114(0x16e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x310114(0x1c4)}}};if(_0x1a6fbd=='on'){const _0x156254=cheerio['load'](_0x1da038);let _0x516593=[],_0x1e2f95=[],_0x3c1c19=[];const _0x2edfea=_0x17b026=>{const _0x43d5e0=_0x310114,_0x4ba2e5={'top':{'style':_0x43d5e0(0x163),'color':{'rgb':_0x43d5e0(0x197)}},'bottom':{'style':_0x43d5e0(0x163),'color':{'rgb':'000000'}},'left':{'style':_0x43d5e0(0x163),'color':{'rgb':'000000'}},'right':{'style':_0x43d5e0(0x163),'color':{'rgb':_0x43d5e0(0x197)}}};if(_0x17b026){const _0x24d279=_0x17b026[_0x43d5e0(0x138)](';')['reduce']((_0x45ec42,_0x5c941b)=>{const _0x5d1209=_0x43d5e0,[_0x2153ab,_0x8fb671]=_0x5c941b[_0x5d1209(0x138)](':')[_0x5d1209(0x151)](_0x330b57=>_0x330b57[_0x5d1209(0x257)]());return _0x45ec42[_0x2153ab]=_0x8fb671,_0x45ec42;},{});_0x24d279[_0x43d5e0(0x1bd)]&&(_0x4ba2e5[_0x43d5e0(0x103)][_0x43d5e0(0x204)]=_0x24d279['border-top'][_0x43d5e0(0x1d8)]('thin')?'thin':'medium'),_0x24d279[_0x43d5e0(0x1e1)]&&(_0x4ba2e5['bottom'][_0x43d5e0(0x204)]=_0x24d279[_0x43d5e0(0x1e1)]['includes'](_0x43d5e0(0x19b))?_0x43d5e0(0x19b):_0x43d5e0(0x124)),_0x24d279[_0x43d5e0(0x245)]&&(_0x4ba2e5[_0x43d5e0(0x108)]['style']=_0x24d279[_0x43d5e0(0x245)][_0x43d5e0(0x1d8)](_0x43d5e0(0x19b))?_0x43d5e0(0x19b):_0x43d5e0(0x124)),_0x24d279[_0x43d5e0(0xed)]&&(_0x4ba2e5['right']['style']=_0x24d279[_0x43d5e0(0xed)][_0x43d5e0(0x1d8)](_0x43d5e0(0x19b))?_0x43d5e0(0x19b):_0x43d5e0(0x124));}return _0x4ba2e5;};_0x156254(_0x310114(0x207))['each']((_0x1d2897,_0x2cdb9)=>{const _0xa8a4e3=_0x310114;let _0x4e7447=[],_0x3d6522=0x0;while(_0x3c1c19[_0x3d6522]){_0x3c1c19[_0x3d6522]--,_0x3d6522++;}_0x156254(_0x2cdb9)[_0xa8a4e3(0x203)](_0xa8a4e3(0x165))['each']((_0x39ae4d,_0x17a2b5)=>{const _0x44388a=_0xa8a4e3;let _0x7eb7a0=_0x156254(_0x17a2b5)[_0x44388a(0x1fe)]()[_0x44388a(0x257)](),_0x1ce92a=parseFloat(_0x7eb7a0['replace'](/,/g,'')),_0x20defe={};!isNaN(_0x1ce92a)?(_0x20defe['v']=_0x1ce92a,_0x20defe['t']='n'):(_0x20defe['v']=_0x7eb7a0,_0x20defe['t']='s');const _0xaf778e=_0x156254(_0x17a2b5)['attr'](_0x44388a(0x204)),_0x460f7c=_0x2edfea(_0xaf778e);_0x20defe['s']={'border':_0x460f7c},_0x4e7447[_0x3d6522]=_0x20defe;let _0x51393f=parseInt(_0x156254(_0x17a2b5)[_0x44388a(0x118)]('colspan'))||0x1,_0x45e292=parseInt(_0x156254(_0x17a2b5)[_0x44388a(0x118)]('rowspan'))||0x1;(_0x51393f>0x1||_0x45e292>0x1)&&_0x1e2f95[_0x44388a(0x1d2)]({'s':{'r':_0x1d2897,'c':_0x3d6522},'e':{'r':_0x1d2897+_0x45e292-0x1,'c':_0x3d6522+_0x51393f-0x1}});for(let _0x2c3637=0x0;_0x2c3637<_0x51393f;_0x2c3637++){_0x45e292>0x1&&(_0x3c1c19[_0x3d6522+_0x2c3637]=_0x45e292-0x1);}_0x3d6522+=_0x51393f;}),_0x516593[_0xa8a4e3(0x1d2)](_0x4e7447);});const _0xc06c23=XLSX[_0x310114(0x192)][_0x310114(0x17c)](),_0x328f23=XLSX[_0x310114(0x192)][_0x310114(0xe3)](_0x516593);_0x1e2f95[_0x310114(0x252)]>0x0&&(_0x328f23[_0x310114(0x191)]=_0x1e2f95);_0x328f23[_0x310114(0x15b)]=_0x516593[0x0][_0x310114(0x151)](()=>({'wpx':0x64})),XLSX[_0x310114(0x192)][_0x310114(0x112)](_0xc06c23,_0x328f23,_0x310114(0x142));const _0xbb78c4=XLSX[_0x310114(0x12e)](_0xc06c23,{'bookType':'xlsx','type':_0x310114(0x18a)});_0x568633[_0x310114(0x254)](_0x310114(0x224),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x568633[_0x310114(0x254)]('Content-Type',_0x310114(0x104)),_0x568633[_0x310114(0x13f)](_0xbb78c4);}else pdf[_0x310114(0x149)](_0x3b3a7e,_0x463bde)[_0x310114(0x217)](function(_0x4afddf,_0x1ae0ff){const _0x43c229=_0x310114;if(_0x4afddf){console['error'](_0x43c229(0x1f2),_0x4afddf),_0x568633[_0x43c229(0x183)](0x1f4)[_0x43c229(0x13f)](_0x43c229(0x176)+_0x4afddf);return;}_0x568633['setHeader'](_0x43c229(0x262),_0x43c229(0x213)),_0x1ae0ff[_0x43c229(0x122)](_0x568633);});}),router['get'](a0_0x58bbe1(0x10c),auth,async(_0x323ce8,_0x4402b6)=>{const _0x1eeadd=a0_0x58bbe1;try{const {username:_0x28dc61,email:_0xdacf3a,role:_0x3f1c4d}=_0x323ce8[_0x1eeadd(0x1fc)],_0x26aeef=_0x323ce8[_0x1eeadd(0x1fc)],_0xfbd66e=await profile[_0x1eeadd(0x130)]({'email':_0x26aeef[_0x1eeadd(0x175)]}),_0xf01076={'year':_0x1eeadd(0x23e),'month':_0x1eeadd(0x1aa),'day':_0x1eeadd(0x23e)},_0x467f1d=await master_shop[_0x1eeadd(0x203)](),_0x42cd43=await product[_0x1eeadd(0x203)](),_0x4f0fcf=await warehouse[_0x1eeadd(0x12c)]([{'$unwind':_0x1eeadd(0xe2)},{'$lookup':{'from':_0x1eeadd(0x1a6),'localField':_0x1eeadd(0x131),'foreignField':_0x1eeadd(0x11e),'as':_0x1eeadd(0x1ab)}},{'$unwind':_0x1eeadd(0x123)},{'$project':{'product_name':_0x1eeadd(0x1d9),'product_stock':_0x1eeadd(0x220)}},{'$group':{'_id':_0x1eeadd(0x20b),'product_stock':{'$sum':_0x1eeadd(0x102)}}}]),_0x260d49=await staff[_0x1eeadd(0x130)]({'email':_0x26aeef[_0x1eeadd(0x175)]});if(_0x467f1d[0x0][_0x1eeadd(0x218)]==_0x1eeadd(0x1be))var _0x10119c=users[_0x1eeadd(0x147)];else{if(_0x467f1d[0x0][_0x1eeadd(0x218)]==_0x1eeadd(0xf2))var _0x10119c=users[_0x1eeadd(0xf2)];else{if(_0x467f1d[0x0]['language']==_0x1eeadd(0x205))var _0x10119c=users['German'];else{if(_0x467f1d[0x0][_0x1eeadd(0x218)]==_0x1eeadd(0x14c))var _0x10119c=users[_0x1eeadd(0x14c)];else{if(_0x467f1d[0x0][_0x1eeadd(0x218)]=='French')var _0x10119c=users[_0x1eeadd(0x25b)];else{if(_0x467f1d[0x0][_0x1eeadd(0x218)]=='Portuguese\x20(BR)')var _0x10119c=users[_0x1eeadd(0x222)];else{if(_0x467f1d[0x0][_0x1eeadd(0x218)]==_0x1eeadd(0x24a))var _0x10119c=users[_0x1eeadd(0x24a)];else{if(_0x467f1d[0x0][_0x1eeadd(0x218)]=='Arabic\x20(ae)')var _0x10119c=users[_0x1eeadd(0x1d6)];}}}}}}}_0x4402b6[_0x1eeadd(0x200)](_0x1eeadd(0x100),{'success':_0x323ce8[_0x1eeadd(0x158)](_0x1eeadd(0x12a)),'errors':_0x323ce8[_0x1eeadd(0x158)](_0x1eeadd(0x16d)),'alldata':_0x42cd43,'profile':_0xfbd66e,'master_shop':_0x467f1d,'role':_0x26aeef,'product_stock':_0x4f0fcf,'language':_0x10119c,'staff_arr':_0x260d49});}catch(_0x127ca7){}});async function dataSalesReports(_0x428c22,_0x349d75,_0x385974){const _0x14c31d=a0_0x58bbe1;let _0xd6d64e='';const _0x10838e=await sales_sa[_0x14c31d(0x12c)]([{'$match':{'date':{'$gte':_0x428c22,'$lte':_0x349d75},'sales_staff_id':_0x385974}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x14c31d(0x1fd)}},{'$group':{'_id':{'product_name':_0x14c31d(0x208),'product_code':_0x14c31d(0x12d)},'sumqty':{'$sum':_0x14c31d(0x248)},'totalPrice':{'$sum':_0x14c31d(0x263)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x149304=0x0,_0x27b020=0x0;for(let _0x7f14af=0x0;_0x7f14af<=_0x10838e['length']-0x1;_0x7f14af++){const _0x430d0e=_0x10838e[_0x7f14af];var _0x57acbc=_0x430d0e[_0x14c31d(0x1ae)]['toLocaleString'](undefined),_0x4ec467=_0x430d0e[_0x14c31d(0x146)]['toLocaleString'](undefined);_0xd6d64e+=_0x14c31d(0x1dd),_0xd6d64e+='<td\x20class=\x22row_data\x22>'+_0x430d0e[_0x14c31d(0x23c)][_0x14c31d(0x1b5)]+'</td>',_0xd6d64e+=_0x14c31d(0x1b8)+_0x430d0e[_0x14c31d(0x23c)][_0x14c31d(0x25a)]+_0x14c31d(0x105),_0xd6d64e+=_0x14c31d(0x1b8)+formatNumber(_0x430d0e[_0x14c31d(0x146)][_0x14c31d(0xe5)](0x2))+_0x14c31d(0x105),_0xd6d64e+=_0x14c31d(0x1b8)+formatNumber(_0x430d0e[_0x14c31d(0x1ae)][_0x14c31d(0xe5)](0x2))+'</td>',_0xd6d64e+=_0x14c31d(0xf3),_0x149304+=parseFloat(_0x430d0e['sumqty']),_0x27b020+=parseFloat(_0x430d0e[_0x14c31d(0x1ae)]);}var _0x5256d5=_0x27b020['toLocaleString'](undefined),_0xbaace1=_0x149304[_0x14c31d(0x14f)](undefined);return _0xd6d64e+=_0x14c31d(0x1dd),_0xd6d64e+=_0x14c31d(0x1de),_0xd6d64e+=_0x14c31d(0x209)+formatNumber(_0x149304['toFixed'](0x2))+_0x14c31d(0x154),_0xd6d64e+=_0x14c31d(0x209)+formatNumber(_0x27b020[_0x14c31d(0xe5)](0x2))+_0x14c31d(0x154),_0xd6d64e+=_0x14c31d(0xf3),_0xd6d64e;}router[a0_0x58bbe1(0x1f1)](a0_0x58bbe1(0x1a7),auth,async(_0x3c15b2,_0x35e7e5)=>{const _0x3094c2=a0_0x58bbe1;try{const {from_date:_0x3f8b30,to_date:_0x1c5017,isExcel:_0x4c7173}=_0x3c15b2[_0x3094c2(0x1ca)],_0x23c51f=_0x3c15b2['user'],_0x1a5292=await staff[_0x3094c2(0x130)]({'email':_0x23c51f[_0x3094c2(0x175)]});let _0x1539ae=_0x3094c2(0x23f);var _0x5c4590=new Date(_0x3f8b30),_0x107076=new Date(_0x1c5017);const _0xefdbcd={'year':'numeric','month':_0x3094c2(0x1aa),'day':_0x3094c2(0x23e)},_0x28ed43=new Intl[(_0x3094c2(0x1e9))](_0x3094c2(0x166),_0xefdbcd)[_0x3094c2(0x16f)](_0x5c4590),_0x54cb9e=new Intl['DateTimeFormat']('en-US',_0xefdbcd)[_0x3094c2(0x16f)](_0x107076);var _0x16af4f=await dataSalesReports(_0x3f8b30,_0x1c5017,_0x1a5292[_0x3094c2(0x23c)][_0x3094c2(0x1a1)]());_0x1539ae+='<div\x20class=\x22row\x22>',_0x1539ae+=_0x3094c2(0x21d),_0x1539ae+='<table>',_0x1539ae+='<tr>',_0x1539ae+=_0x3094c2(0x226),_0x1539ae+=_0x3094c2(0x177),_0x1539ae+=_0x3094c2(0x13b),_0x1539ae+=_0x3094c2(0x25f),_0x1539ae+=_0x3094c2(0x1dd),_0x1539ae+=_0x16af4f,_0x1539ae+='</tr>',_0x1539ae+=_0x3094c2(0x19e),_0x1539ae+=_0x3094c2(0x19e);let _0x572094=_0x3094c2(0x22f);const _0x50bd3a={'width':_0x3094c2(0x1ec),'height':'8.5in','orientation':_0x3094c2(0x1f7),'border':{'top':_0x3094c2(0x244),'right':_0x3094c2(0x244),'bottom':_0x3094c2(0x244),'left':'0.1in'},'header':{'height':_0x3094c2(0x18d),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x572094+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x1a5292[_0x3094c2(0x11e)]+_0x3094c2(0x1ad)+_0x28ed43+_0x3094c2(0x1cd)+_0x54cb9e+_0x3094c2(0x253)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3094c2(0x1c4)}}};if(_0x4c7173=='on'){const _0x41c7e7=cheerio[_0x3094c2(0xff)](_0x1539ae);let _0x16bb88=[],_0x107d21=[],_0x295151=[];const _0xe35f42=_0x2671a5=>{const _0x271d09=_0x3094c2,_0x4f7946={'top':{'style':_0x271d09(0x163),'color':{'rgb':_0x271d09(0x197)}},'bottom':{'style':'thick','color':{'rgb':_0x271d09(0x197)}},'left':{'style':_0x271d09(0x163),'color':{'rgb':_0x271d09(0x197)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x2671a5){const _0x12e864=_0x2671a5[_0x271d09(0x138)](';')['reduce']((_0x111b4c,_0x56a8b4)=>{const _0x25f10e=_0x271d09,[_0x3a3a00,_0x1046c1]=_0x56a8b4[_0x25f10e(0x138)](':')[_0x25f10e(0x151)](_0x4ec260=>_0x4ec260[_0x25f10e(0x257)]());return _0x111b4c[_0x3a3a00]=_0x1046c1,_0x111b4c;},{});_0x12e864['border-top']&&(_0x4f7946[_0x271d09(0x103)]['style']=_0x12e864[_0x271d09(0x1bd)][_0x271d09(0x1d8)]('thin')?_0x271d09(0x19b):_0x271d09(0x124)),_0x12e864[_0x271d09(0x1e1)]&&(_0x4f7946[_0x271d09(0xfc)][_0x271d09(0x204)]=_0x12e864[_0x271d09(0x1e1)]['includes']('thin')?_0x271d09(0x19b):'medium'),_0x12e864[_0x271d09(0x245)]&&(_0x4f7946[_0x271d09(0x108)]['style']=_0x12e864['border-left'][_0x271d09(0x1d8)](_0x271d09(0x19b))?'thin':_0x271d09(0x124)),_0x12e864[_0x271d09(0xed)]&&(_0x4f7946['right']['style']=_0x12e864['border-right'][_0x271d09(0x1d8)]('thin')?_0x271d09(0x19b):_0x271d09(0x124));}return _0x4f7946;};_0x41c7e7(_0x3094c2(0x207))['each']((_0x4282e7,_0x2ef6db)=>{const _0x2509ba=_0x3094c2;let _0x3fbf56=[],_0x45f848=0x0;while(_0x295151[_0x45f848]){_0x295151[_0x45f848]--,_0x45f848++;}_0x41c7e7(_0x2ef6db)[_0x2509ba(0x203)](_0x2509ba(0x165))[_0x2509ba(0x236)]((_0x2c38c2,_0x5f0670)=>{const _0xda944f=_0x2509ba;let _0x448217=_0x41c7e7(_0x5f0670)[_0xda944f(0x1fe)]()['trim'](),_0x134d88=parseFloat(_0x448217[_0xda944f(0x1c9)](/,/g,'')),_0x38f279={};!isNaN(_0x134d88)?(_0x38f279['v']=_0x134d88,_0x38f279['t']='n'):(_0x38f279['v']=_0x448217,_0x38f279['t']='s');const _0x1aa9b5=_0x41c7e7(_0x5f0670)[_0xda944f(0x118)](_0xda944f(0x204)),_0x2817d4=_0xe35f42(_0x1aa9b5);_0x38f279['s']={'border':_0x2817d4},_0x3fbf56[_0x45f848]=_0x38f279;let _0x5db1f2=parseInt(_0x41c7e7(_0x5f0670)[_0xda944f(0x118)](_0xda944f(0x14e)))||0x1,_0x47fd4d=parseInt(_0x41c7e7(_0x5f0670)[_0xda944f(0x118)](_0xda944f(0x23b)))||0x1;(_0x5db1f2>0x1||_0x47fd4d>0x1)&&_0x107d21[_0xda944f(0x1d2)]({'s':{'r':_0x4282e7,'c':_0x45f848},'e':{'r':_0x4282e7+_0x47fd4d-0x1,'c':_0x45f848+_0x5db1f2-0x1}});for(let _0x4d16d7=0x0;_0x4d16d7<_0x5db1f2;_0x4d16d7++){_0x47fd4d>0x1&&(_0x295151[_0x45f848+_0x4d16d7]=_0x47fd4d-0x1);}_0x45f848+=_0x5db1f2;}),_0x16bb88[_0x2509ba(0x1d2)](_0x3fbf56);});const _0x4328f3=XLSX[_0x3094c2(0x192)][_0x3094c2(0x17c)](),_0x495d0f=XLSX['utils'][_0x3094c2(0xe3)](_0x16bb88);_0x107d21['length']>0x0&&(_0x495d0f[_0x3094c2(0x191)]=_0x107d21);_0x495d0f[_0x3094c2(0x15b)]=_0x16bb88[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x3094c2(0x112)](_0x4328f3,_0x495d0f,'Sales\x20Report');const _0x5235f7=XLSX[_0x3094c2(0x12e)](_0x4328f3,{'bookType':_0x3094c2(0x174),'type':'buffer'});_0x35e7e5[_0x3094c2(0x254)](_0x3094c2(0x224),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x35e7e5[_0x3094c2(0x254)](_0x3094c2(0x262),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x35e7e5[_0x3094c2(0x13f)](_0x5235f7);}else pdf[_0x3094c2(0x149)](_0x1539ae,_0x50bd3a)[_0x3094c2(0x217)](function(_0x3cba48,_0x596d83){const _0xa09079=_0x3094c2;if(_0x3cba48){_0x35e7e5[_0xa09079(0x183)](0x1f4)[_0xa09079(0x13f)](_0xa09079(0x176));return;}_0x35e7e5[_0xa09079(0x254)]('Content-Type','application/pdf'),_0x596d83[_0xa09079(0x122)](_0x35e7e5);});}catch(_0x594443){}}),router[a0_0x58bbe1(0x1c5)](a0_0x58bbe1(0x159),auth,async(_0x6c2b97,_0x3d769f)=>{const _0x511d8e=a0_0x58bbe1;try{const {username:_0x39dfd7,email:_0x4ae187,role:_0x1de588}=_0x6c2b97['user'],_0x1bebe9=_0x6c2b97[_0x511d8e(0x1fc)],_0x3fc549=await profile[_0x511d8e(0x130)]({'email':_0x1bebe9['email']}),_0x19a45e={'year':_0x511d8e(0x23e),'month':_0x511d8e(0x1aa),'day':_0x511d8e(0x23e)},_0x542ad1=await master_shop[_0x511d8e(0x203)](),_0x17e285=await product[_0x511d8e(0x203)](),_0x356e4d=await warehouse[_0x511d8e(0x12c)]([{'$unwind':_0x511d8e(0xe2)},{'$lookup':{'from':_0x511d8e(0x1a6),'localField':_0x511d8e(0x131),'foreignField':_0x511d8e(0x11e),'as':_0x511d8e(0x1ab)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x511d8e(0x20b),'product_stock':{'$sum':_0x511d8e(0x102)}}}]);if(_0x542ad1[0x0][_0x511d8e(0x218)]==_0x511d8e(0x1be))var _0x151c38=users[_0x511d8e(0x147)];else{if(_0x542ad1[0x0]['language']==_0x511d8e(0xf2))var _0x151c38=users['Hindi'];else{if(_0x542ad1[0x0][_0x511d8e(0x218)]=='German')var _0x151c38=users[_0x511d8e(0x205)];else{if(_0x542ad1[0x0]['language']=='Spanish')var _0x151c38=users[_0x511d8e(0x14c)];else{if(_0x542ad1[0x0][_0x511d8e(0x218)]==_0x511d8e(0x25b))var _0x151c38=users['French'];else{if(_0x542ad1[0x0]['language']=='Portuguese\x20(BR)')var _0x151c38=users['Portuguese'];else{if(_0x542ad1[0x0][_0x511d8e(0x218)]==_0x511d8e(0x24a))var _0x151c38=users['Chinese'];else{if(_0x542ad1[0x0][_0x511d8e(0x218)]==_0x511d8e(0x259))var _0x151c38=users[_0x511d8e(0x1d6)];}}}}}}}_0x3d769f['render'](_0x511d8e(0x22c),{'success':_0x6c2b97[_0x511d8e(0x158)](_0x511d8e(0x12a)),'errors':_0x6c2b97[_0x511d8e(0x158)](_0x511d8e(0x16d)),'alldata':_0x17e285,'profile':_0x3fc549,'master_shop':_0x542ad1,'role':_0x1bebe9,'product_stock':_0x356e4d,'language':_0x151c38});}catch(_0x5e548f){}});async function dataInventoryReports(_0x398615,_0x4a301e,_0x4037db){const _0xaaf956=a0_0x58bbe1,_0x1eed71=await sales_sa[_0xaaf956(0x12c)]([{'$match':{'date':{'$gte':_0x398615,'$lte':_0x4a301e},'sales_staff_id':_0x4037db}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0xaaf956(0x208),'product_code':_0xaaf956(0x12d)},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0xdf56d0=mongoose['Types'][_0xaaf956(0x14d)],_0x45bf59=await staff['aggregate']([{'$match':{'_id':_0xdf56d0(_0x4037db)}},{'$unwind':'$product_list'},{'$match':{'product_list.isConfirm':_0xaaf956(0x1dc)}},{'$group':{'_id':{'product_name':_0xaaf956(0x24e),'product_code':_0xaaf956(0x243)},'sumqty':{'$sum':_0xaaf956(0xf7)}}},{'$sort':{'_id.product_name':0x1}}]),_0x340937=await sales_inv_data[_0xaaf956(0x12c)]([{'$match':{'date':{'$gte':_0x398615,'$lte':_0x4a301e},'sales_staff_id':_0x4037db}},{'$unwind':_0xaaf956(0xeb)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0xaaf956(0x12d)},'totalQTYsum':{'$sum':'$sale_product.stock'}}}]);console[_0xaaf956(0x233)](_0x340937);let _0x52fbac='';var _0x4993c9=0x0;for(let _0x19f098=0x0;_0x19f098<=_0x45bf59[_0xaaf956(0x252)]-0x1;_0x19f098++){const _0x2aedb6=_0x45bf59[_0x19f098];_0x52fbac+=_0xaaf956(0x1dd),_0x52fbac+=_0xaaf956(0x153)+_0x2aedb6[_0xaaf956(0x23c)][_0xaaf956(0x1b5)]+_0xaaf956(0x105),_0x52fbac+=_0xaaf956(0x1a4)+_0x2aedb6[_0xaaf956(0x23c)][_0xaaf956(0x25a)]+_0xaaf956(0x105);var _0x19f916=_0x2aedb6[_0xaaf956(0x146)],_0xe89341=0x0;for(let _0x594a1d=0x0;_0x594a1d<=_0x1eed71[_0xaaf956(0x252)]-0x1;_0x594a1d++){const _0x47671c=_0x1eed71[_0x594a1d];_0x2aedb6[_0xaaf956(0x23c)]['product_code']==_0x47671c[_0xaaf956(0x23c)][_0xaaf956(0x1b5)]&&_0x2aedb6['_id']['product_name']==_0x47671c[_0xaaf956(0x23c)]['product_name']&&(_0xe89341=_0x47671c['sumqty']);}var _0x33ced0=0x0;for(let _0x358597=0x0;_0x358597<=_0x340937[_0xaaf956(0x252)]-0x1;_0x358597++){const _0xac1858=_0x340937[_0x358597];_0x2aedb6[_0xaaf956(0x23c)][_0xaaf956(0x1b5)]==_0xac1858[_0xaaf956(0x23c)][_0xaaf956(0x1b5)]&&_0x2aedb6[_0xaaf956(0x23c)][_0xaaf956(0x25a)]==_0xac1858[_0xaaf956(0x23c)][_0xaaf956(0x25a)]&&(_0x33ced0=_0xac1858[_0xaaf956(0x234)]);}_0x4993c9=_0x19f916-_0x33ced0+_0xe89341,_0x52fbac+=_0xaaf956(0x1b8)+_0x4993c9+'</td>';let _0x484c59=![];for(let _0x33f882=0x0;_0x33f882<=_0x340937[_0xaaf956(0x252)]-0x1;_0x33f882++){const _0x1c6f5d=_0x340937[_0x33f882];if(_0x2aedb6[_0xaaf956(0x23c)][_0xaaf956(0x1b5)]==_0x1c6f5d['_id'][_0xaaf956(0x1b5)]&&_0x2aedb6[_0xaaf956(0x23c)][_0xaaf956(0x25a)]==_0x1c6f5d[_0xaaf956(0x23c)][_0xaaf956(0x25a)]){_0x52fbac+=_0xaaf956(0x1b8)+_0x1c6f5d['totalQTYsum']+_0xaaf956(0x105),_0x484c59=!![];break;}}!_0x484c59&&(_0x52fbac+=_0xaaf956(0x211));let _0x556bc4=![];for(let _0xbef852=0x0;_0xbef852<=_0x1eed71['length']-0x1;_0xbef852++){const _0x4a9ea8=_0x1eed71[_0xbef852];if(_0x2aedb6[_0xaaf956(0x23c)][_0xaaf956(0x1b5)]==_0x4a9ea8[_0xaaf956(0x23c)][_0xaaf956(0x1b5)]&&_0x2aedb6[_0xaaf956(0x23c)][_0xaaf956(0x25a)]==_0x4a9ea8['_id'][_0xaaf956(0x25a)]){_0x52fbac+='<td\x20class=\x22row_data\x22>'+_0x4a9ea8['sumqty']+_0xaaf956(0x105),_0x556bc4=!![];break;}}!_0x556bc4&&(_0x52fbac+=_0xaaf956(0x211)),_0x52fbac+=_0xaaf956(0x1b8)+_0x2aedb6['sumqty']+_0xaaf956(0x105),_0x52fbac+='</tr>';}return _0x52fbac;}router['post']('/inventory_sum/pdf',auth,async(_0x476d6d,_0x58098c)=>{const _0xa8454d=a0_0x58bbe1;try{const {from_date:_0x638c40,to_date:_0x2a93c1}=_0x476d6d['body'],_0x3d54c2=_0x476d6d[_0xa8454d(0x1fc)],_0x38a6fb=await staff['findOne']({'email':_0x3d54c2[_0xa8454d(0x175)]});let _0x4afc14=_0xa8454d(0x23f);var _0x57a55c=new Date(_0x638c40),_0x133a3a=new Date(_0x2a93c1);const _0x523864={'year':_0xa8454d(0x23e),'month':'long','day':'numeric'},_0x4df462=new Intl[(_0xa8454d(0x1e9))](_0xa8454d(0x166),_0x523864)['format'](_0x57a55c),_0x8103f2=new Intl[(_0xa8454d(0x1e9))](_0xa8454d(0x166),_0x523864)[_0xa8454d(0x16f)](_0x133a3a);var _0x11504a=await dataInventoryReports(_0x638c40,_0x2a93c1,_0x38a6fb['_id'][_0xa8454d(0x1a1)]());_0x4afc14+=_0xa8454d(0x1a8),_0x4afc14+='<p>INVENTORY\x20SUMMARY</p>',_0x4afc14+=_0xa8454d(0x160)+_0x4df462+_0xa8454d(0x1cd)+_0x8103f2+_0xa8454d(0x241),_0x4afc14+='<div\x20class=\x22row\x22>',_0x4afc14+='<div\x20class=\x22col-sm-11\x22>',_0x4afc14+=_0xa8454d(0x1ef),_0x4afc14+=_0xa8454d(0x1dd),_0x4afc14+=_0xa8454d(0x226),_0x4afc14+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x4afc14+=_0xa8454d(0x196),_0x4afc14+=_0xa8454d(0xe1),_0x4afc14+=_0xa8454d(0xf4),_0x4afc14+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x4afc14+=_0xa8454d(0x1dd),_0x4afc14+=_0x11504a,_0x4afc14+=_0xa8454d(0xf3),_0x4afc14+=_0xa8454d(0x19e),_0x4afc14+=_0xa8454d(0x19e);const _0x12dd3c={'format':_0xa8454d(0x11c),'orientation':_0xa8454d(0x1f7),'childProcessOptions':{'env':{'OPENSSL_CONF':_0xa8454d(0x1c4)}}};pdf[_0xa8454d(0x149)](_0x4afc14,_0x12dd3c)[_0xa8454d(0x217)](function(_0x379a31,_0x2bdd15){const _0x1bfd92=_0xa8454d;if(_0x379a31){_0x58098c['status'](0x1f4)[_0x1bfd92(0x13f)](_0x1bfd92(0x176));return;}_0x58098c[_0x1bfd92(0x254)]('Content-Type',_0x1bfd92(0x213)),_0x2bdd15['pipe'](_0x58098c);});}catch(_0x181e07){}}),router[a0_0x58bbe1(0x1c5)](a0_0x58bbe1(0x199),auth,async(_0xe962e3,_0x3483fe)=>{const _0x203fe6=a0_0x58bbe1;try{const {username:_0x2d251a,email:_0x207952,role:_0x50936c}=_0xe962e3[_0x203fe6(0x1fc)],_0x23d8c8=_0xe962e3[_0x203fe6(0x1fc)],_0x3aceb1=await profile[_0x203fe6(0x130)]({'email':_0x23d8c8[_0x203fe6(0x175)]}),_0x9a1208={'year':_0x203fe6(0x23e),'month':_0x203fe6(0x1aa),'day':_0x203fe6(0x23e)},_0x486974=await master_shop[_0x203fe6(0x203)]();console[_0x203fe6(0x233)](_0x203fe6(0xdf),_0x486974);const _0x22f31d=await product['find']();console['log'](_0x203fe6(0x150),_0x22f31d);const _0x370ccc=await warehouse[_0x203fe6(0x12c)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x203fe6(0x1a6),'localField':_0x203fe6(0x131),'foreignField':_0x203fe6(0x11e),'as':_0x203fe6(0x1ab)}},{'$unwind':_0x203fe6(0x123)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x203fe6(0x220)}},{'$group':{'_id':_0x203fe6(0x20b),'product_stock':{'$sum':_0x203fe6(0x102)}}}]);console['log']('Products\x20warehouse_data',_0x370ccc),_0x370ccc[_0x203fe6(0x235)](_0xbdf280=>{const _0x40475c=_0x203fe6,_0x4c9d9a=_0x22f31d[_0x40475c(0x151)](_0x7786c2=>{const _0x2eb2fd=_0x40475c;_0x7786c2['name']==_0xbdf280[_0x2eb2fd(0x23c)]&&(_0x7786c2[_0x2eb2fd(0x1d4)]=parseInt(_0x7786c2[_0x2eb2fd(0x1d4)])+parseInt(_0xbdf280[_0x2eb2fd(0x18f)]));});});const _0x304936=await staff[_0x203fe6(0x130)]({'email':_0x23d8c8[_0x203fe6(0x175)]});if(_0x486974[0x0][_0x203fe6(0x218)]==_0x203fe6(0x1be))var _0x5b20b5=users['English'];else{if(_0x486974[0x0]['language']==_0x203fe6(0xf2))var _0x5b20b5=users[_0x203fe6(0xf2)];else{if(_0x486974[0x0]['language']==_0x203fe6(0x205))var _0x5b20b5=users[_0x203fe6(0x205)];else{if(_0x486974[0x0]['language']==_0x203fe6(0x14c))var _0x5b20b5=users[_0x203fe6(0x14c)];else{if(_0x486974[0x0][_0x203fe6(0x218)]==_0x203fe6(0x25b))var _0x5b20b5=users[_0x203fe6(0x25b)];else{if(_0x486974[0x0][_0x203fe6(0x218)]==_0x203fe6(0x15f))var _0x5b20b5=users[_0x203fe6(0x222)];else{if(_0x486974[0x0][_0x203fe6(0x218)]==_0x203fe6(0x24a))var _0x5b20b5=users[_0x203fe6(0x24a)];else{if(_0x486974[0x0][_0x203fe6(0x218)]==_0x203fe6(0x259))var _0x5b20b5=users[_0x203fe6(0x1d6)];}}}}}}}_0x3483fe[_0x203fe6(0x200)]('dssr_view',{'success':_0xe962e3[_0x203fe6(0x158)]('success'),'errors':_0xe962e3['flash']('errors'),'alldata':_0x22f31d,'profile':_0x3aceb1,'master_shop':_0x486974,'role':_0x23d8c8,'product_stock':_0x370ccc,'language':_0x5b20b5,'staff_arr':_0x304936});}catch(_0x26399c){}});async function agentsdataDSICheck_DSRR(_0x4bde0b,_0x178cdf,_0x3bc7a7,_0x1b3070){const _0x44835e=a0_0x58bbe1;let _0x5243b9=new Date(_0x4bde0b);_0x5243b9['setDate'](_0x5243b9[_0x44835e(0x23a)]()-0x1);let _0x5ac1fa=_0x5243b9['toISOString']()[_0x44835e(0x138)]('T')[0x0];const _0x180f88=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':_0x44835e(0x22b),'product_code':_0x44835e(0x101)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x502a3e=[];_0x502a3e[_0x44835e(0xe7)]=[];for(let _0x5d38ef=0x0;_0x5d38ef<=_0x180f88[_0x44835e(0x252)]-0x1;_0x5d38ef++){const _0x183784=_0x180f88[_0x5d38ef];_0x502a3e[_0x44835e(0xe7)][_0x44835e(0x1d2)](_0x183784);}const _0x1750e3=await product[_0x44835e(0x12c)]([{'$group':{'_id':{'category':_0x44835e(0x127)},'products':{'$push':{'brand':_0x44835e(0x1b1),'product_code':'$product_code','product_name':_0x44835e(0x22b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x19db03=await product[_0x44835e(0x12c)]([{'$group':{'_id':{'category':'$category','brand':_0x44835e(0x1b1)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5ded59=await sales_sa[_0x44835e(0x12c)]([{'$match':{'date':_0x4bde0b,'sales_staff_id':_0x178cdf,'sale_product.isFG':_0x44835e(0x1fd)}},{'$unwind':_0x44835e(0xeb)},{'$lookup':{'from':'products','localField':_0x44835e(0x129),'foreignField':_0x44835e(0x1b5),'as':_0x44835e(0x249)}},{'$unwind':_0x44835e(0x1ff)},{'$group':{'_id':{'dsi':'$dsi','date':_0x44835e(0x143),'customer':_0x44835e(0x10f),'status_data':_0x44835e(0x17f)},'totalQty':{'$sum':_0x44835e(0x248)},'cash':{'$first':'$cash'},'amount':{'$first':_0x44835e(0x1d3)},'bank':{'$first':_0x44835e(0x116)},'check_no':{'$first':_0x44835e(0x1b0)},'due_date':{'$first':_0x44835e(0x238)},'products':{'$push':{'qty':_0x44835e(0x248),'NetPrice':_0x44835e(0x263),'discount':_0x44835e(0x155),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x44835e(0x20f),'product_code':_0x44835e(0xf6),'category':'$product_info.category','brand':_0x44835e(0x17d),'gross_price':_0x44835e(0x168),'isFG':_0x44835e(0x25d),'prod_cat':_0x44835e(0x10b),'prod_id':_0x44835e(0x201)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x44835e(0x120),'date':_0x44835e(0x162),'customer':_0x44835e(0x117),'status_data':_0x44835e(0x156),'category':'$products.product_details.category','brand':'$products.product_details.brand','prod_id':_0x44835e(0x24b)},'totalQty':{'$sum':_0x44835e(0x230)},'totalGross':{'$sum':{'$multiply':[_0x44835e(0x230),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x44835e(0x221)},'adj_discount':{'$sum':_0x44835e(0x22a)},'cash':{'$first':_0x44835e(0x1ed)},'amount':{'$first':'$amount'},'bank':{'$first':_0x44835e(0x116)},'check_no':{'$first':_0x44835e(0x1b0)},'due_date':{'$first':'$due_date'},'product_details':{'$first':_0x44835e(0x198)}}},{'$group':{'_id':{'dsi':_0x44835e(0x120),'date':_0x44835e(0x162),'customer':_0x44835e(0x117),'status_data':_0x44835e(0x156)},'totalQty':{'$sum':_0x44835e(0xe9)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x44835e(0x182)},'discount':{'$sum':_0x44835e(0x115)},'adj_discount':{'$sum':_0x44835e(0x11a)},'cash':{'$first':_0x44835e(0x1ed)},'amount':{'$first':_0x44835e(0x1d3)},'bank':{'$first':_0x44835e(0x116)},'check_no':{'$first':_0x44835e(0x1b0)},'due_date':{'$first':_0x44835e(0x238)},'products':{'$push':{'qty':'$totalQty','category':_0x44835e(0x1c0),'brand':_0x44835e(0x1a2),'product_details':_0x44835e(0xe2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5e0d05=await sales_sa['aggregate']([{'$match':{'date':_0x5ac1fa,'sales_staff_id':_0x178cdf,'sale_product.isFG':_0x44835e(0x1fd)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x44835e(0x1a6),'localField':'sale_product.product_code','foreignField':'product_code','as':_0x44835e(0x249)}},{'$unwind':_0x44835e(0x1ff)},{'$group':{'_id':{'dsi':_0x44835e(0x1eb),'date':_0x44835e(0x143),'customer':_0x44835e(0x10f)},'totalQty':{'$sum':_0x44835e(0x248)},'cash':{'$first':_0x44835e(0x1ed)},'amount':{'$first':_0x44835e(0x1d3)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x44835e(0x238)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x44835e(0x263),'discount':_0x44835e(0x155),'adj_discount':_0x44835e(0x12f),'product_details':{'prod_name':_0x44835e(0x20f),'product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x44835e(0x17d),'gross_price':_0x44835e(0x168),'isFG':_0x44835e(0x25d),'prod_cat':_0x44835e(0x10b),'prod_id':_0x44835e(0x201)}}}}},{'$unwind':_0x44835e(0xf9)},{'$group':{'_id':{'dsi':_0x44835e(0x120),'date':_0x44835e(0x162),'customer':_0x44835e(0x117),'category':_0x44835e(0x1fb),'brand':_0x44835e(0x21c),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x44835e(0x230)},'cash':{'$first':_0x44835e(0x1ed)},'amount':{'$first':_0x44835e(0x1d3)},'bank':{'$first':_0x44835e(0x116)},'check_no':{'$first':_0x44835e(0x1b0)},'due_date':{'$first':_0x44835e(0x238)},'totalGross':{'$sum':{'$multiply':[_0x44835e(0x230),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x44835e(0x172)},'discount':{'$sum':_0x44835e(0x221)},'adj_discount':{'$sum':_0x44835e(0x22a)},'product_details':{'$first':_0x44835e(0x198)}}},{'$group':{'_id':{'dsi':_0x44835e(0x120),'date':_0x44835e(0x162),'customer':_0x44835e(0x117)},'totalQty':{'$sum':'$totalQty'},'cash':{'$first':_0x44835e(0x1ed)},'amount':{'$first':_0x44835e(0x1d3)},'bank':{'$first':_0x44835e(0x116)},'check_no':{'$first':_0x44835e(0x1b0)},'due_date':{'$first':_0x44835e(0x238)},'totalGross':{'$sum':_0x44835e(0x13c)},'NetPrice':{'$sum':_0x44835e(0x182)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x44835e(0x11a)},'products':{'$push':{'qty':_0x44835e(0xe9),'category':_0x44835e(0x1c0),'brand':_0x44835e(0x1a2),'product_details':_0x44835e(0xe2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xe24086=await sales_sa[_0x44835e(0x12c)]([{'$match':{'date':_0x4bde0b,'sales_staff_id':_0x178cdf,'status_data':'true'}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x28f078=await staff[_0x44835e(0x212)](_0x178cdf);let _0x557a93=[],_0x3cb87a={},_0x3194d8={};var _0x4355eb=0x0,_0x2dfcf7=0x0,_0x48e121=0x0,_0x1826db=0x0,_0x5823ea=0x0;const _0x14f85d=0x6;var _0x68f280=0x0,_0x4e2f4c=0x0;for(let _0x4b31b3=0x0;_0x4b31b3<=_0x5ded59[_0x44835e(0x252)]-0x1;_0x4b31b3++){const _0x1bf861=_0x5ded59[_0x4b31b3];let _0xf2c1c=_0x44835e(0x1dd);_0xf2c1c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0xf2c1c+=_0x44835e(0x1e6)+_0x1bf861['_id'][_0x44835e(0x1b2)]+_0x44835e(0x105),_0xf2c1c+=_0x44835e(0x1e6)+_0x1bf861[_0x44835e(0x23c)][_0x44835e(0x250)]+_0x44835e(0x105);let _0x3d02d0={},_0x377fe8={},_0x5e8939={};var _0x5dcf89={},_0x5a14ca={},_0x524352={},_0x5e87f0=0x0;for(let _0x25906b=0x0;_0x25906b<=_0x1bf861[_0x44835e(0x1a6)][_0x44835e(0x252)]-0x1;_0x25906b++){const _0x43aaf7=_0x1bf861[_0x44835e(0x1a6)][_0x25906b];_0x3d02d0[_0x43aaf7[_0x44835e(0x1e5)]+'-'+_0x43aaf7[_0x44835e(0x141)]]=_0x43aaf7[_0x44835e(0x193)],_0x377fe8[[_0x43aaf7['brand']+'-'+_0x43aaf7['category']]]=_0x43aaf7[_0x44835e(0x1df)][_0x44835e(0x169)],_0x5e8939[[_0x43aaf7[_0x44835e(0x1e5)]+'-'+_0x43aaf7[_0x44835e(0x141)]]]=_0x43aaf7[_0x44835e(0x1df)][_0x44835e(0x206)];const _0x4968e2=_0x43aaf7[_0x44835e(0x1e5)]+'-'+_0x43aaf7[_0x44835e(0x141)];!Array[_0x44835e(0x1b4)](_0x3194d8[_0x4968e2])&&(_0x3194d8[_0x4968e2]=[]);!Array['isArray'](_0x3194d8[_0x4968e2])&&(_0x3194d8[_0x4968e2]=[]);_0x3194d8[_0x4968e2]['push'](_0x43aaf7[_0x44835e(0x193)]);if(_0x43aaf7['product_details'][_0x44835e(0x206)]=='P')_0x43aaf7[_0x44835e(0x1df)][_0x44835e(0x169)]==_0x44835e(0x1dc)?(!_0x524352[_0x4968e2]&&(_0x524352[_0x4968e2]=0x0),_0x524352[_0x4968e2]=_0x43aaf7[_0x44835e(0x193)]):(!_0x5dcf89[_0x4968e2]&&(_0x5dcf89[_0x4968e2]=0x0),_0x5dcf89[_0x4968e2]=_0x43aaf7[_0x44835e(0x193)]);else _0x43aaf7[_0x44835e(0x1df)][_0x44835e(0x206)]=='S'&&(_0x43aaf7[_0x44835e(0x1df)]['isFG']=='true'?(!_0x524352[_0x4968e2]&&(_0x524352[_0x4968e2]=0x0),_0x524352[_0x4968e2]=_0x43aaf7[_0x44835e(0x193)]):(!_0x5a14ca[_0x4968e2]&&(_0x5a14ca[_0x4968e2]=0x0),_0x5a14ca[_0x4968e2]=_0x43aaf7[_0x44835e(0x193)]));_0x5e87f0++;}for(let _0x168621=0x0;_0x168621<=_0x502a3e[_0x44835e(0xe7)]['length']-0x1;_0x168621++){const _0x593dd5=_0x502a3e[_0x44835e(0xe7)][_0x168621],_0x530b52=_0x593dd5[_0x44835e(0x23c)][_0x44835e(0x1e5)]+'-'+_0x593dd5[_0x44835e(0x23c)][_0x44835e(0x141)],_0x25c64e=_0x5e8939[_0x530b52]!==undefined?_0x5e8939[_0x530b52]:'NA';var _0x20dab1=_0x5dcf89[_0x530b52]!==undefined?_0x5dcf89[_0x530b52]['toFixed'](0x2):'',_0x4c5dfc=_0x5a14ca[_0x530b52]!==undefined?_0x5a14ca[_0x530b52][_0x44835e(0xe5)](0x2):'',_0x2769aa=_0x524352[_0x530b52]!==undefined?_0x524352[_0x530b52][_0x44835e(0xe5)](0x2):'';_0xf2c1c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x20dab1+_0x44835e(0x105),_0xf2c1c+=_0x44835e(0x1a0)+_0x4c5dfc+_0x44835e(0x105),_0xf2c1c+=_0x44835e(0x1a0)+_0x2769aa+_0x44835e(0x105);}var _0x26f2eb=formatNumber(parseFloat(_0x1bf861[_0x44835e(0x210)])),_0x2c2b19=formatNumber(parseFloat(_0x1bf861['amount']));isNaN(_0x2c2b19)&&(_0x2c2b19=0x0),_0xf2c1c+=_0x44835e(0x1a0)+_0x26f2eb+_0x44835e(0x105),_0xf2c1c+=_0x44835e(0x1a0)+_0x2c2b19+'</td>',_0xf2c1c+=_0x44835e(0x1e6)+_0x1bf861[_0x44835e(0xea)]+_0x44835e(0x105),_0xf2c1c+=_0x44835e(0x1e6)+_0x1bf861['check_no']+_0x44835e(0x105),_0xf2c1c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1bf861[_0x44835e(0x1ea)]+'</td>',_0x48e121=_0x1bf861[_0x44835e(0xec)]+_0x1bf861[_0x44835e(0x1ee)],_0x68f280+=parseFloat(_0x1bf861['cash']),_0x4e2f4c+=parseFloat(_0x2c2b19),_0x557a93[_0x44835e(0x1d2)](_0xf2c1c);}if(_0xe24086[_0x44835e(0x252)]>0x0)for(let _0x41af39=0x0;_0x41af39<=_0xe24086['length']-0x1;_0x41af39++){const _0x232c08=_0xe24086[_0x41af39];console['log'](_0x232c08);let _0x2e4084=_0x44835e(0x1dd);_0x2e4084+=_0x44835e(0xf8)+(0x8+0x7*0x3)+_0x44835e(0x21e)+_0x232c08['note']+_0x44835e(0x154),_0x2e4084+='</tr>',_0x557a93['push'](_0x2e4084);}function _0x50e53f(_0x265394,_0x508a39){const _0x3fb481=_0x44835e,_0x500d0e=[];for(let _0x56392d=0x0;_0x56392d<=_0x265394[_0x3fb481(0x252)]-0x1;_0x56392d+=_0x508a39){_0x500d0e[_0x3fb481(0x1d2)](_0x265394[_0x3fb481(0x167)](_0x56392d,_0x56392d+_0x508a39));}return _0x500d0e;}const _0x5d4a72=_0x50e53f(_0x557a93,_0x14f85d);let _0xa4c296='';return _0x5d4a72[_0x44835e(0x235)]((_0x590739,_0x37ed8f)=>{const _0x533b01=_0x44835e;_0x37ed8f>0x0&&(_0xa4c296+=_0x533b01(0x16b));_0xa4c296+=_0x533b01(0x1ef),_0xa4c296+=_0x533b01(0x171);const _0xefd0c8=new Date(_0x4bde0b),_0x6ce74f={'year':_0x533b01(0x23e),'month':_0x533b01(0x1aa),'day':_0x533b01(0x23e),'timeZone':_0x533b01(0x1f6)},_0x350f80=_0xefd0c8[_0x533b01(0x1da)](_0x533b01(0x166),_0x6ce74f);_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+=_0x533b01(0x25c)+_0x1b3070+_0x533b01(0x154),_0xa4c296+='</tr>',_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+=_0x533b01(0x13d)+_0x28f078[_0x533b01(0x11e)]+_0x533b01(0x105),_0xa4c296+=_0x533b01(0x11b),_0xa4c296+=_0x533b01(0x194),_0xa4c296+=_0x533b01(0x246),_0xa4c296+=_0x533b01(0x178),_0xa4c296+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0xa4c296+=_0x533b01(0x1ba),_0xa4c296+=_0x533b01(0x157),_0xa4c296+=_0x533b01(0x1d7),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+=_0x533b01(0xfd),_0xa4c296+=_0x533b01(0x1cc)+_0x350f80+_0x533b01(0x105),_0xa4c296+=_0x533b01(0x1c6),_0xa4c296+=_0x533b01(0x111),_0xa4c296+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0xa4c296+=_0x533b01(0xef),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+='<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>',_0xa4c296+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0xa4c296+=_0x533b01(0x16a),_0xa4c296+=_0x533b01(0xef),_0xa4c296+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+=_0x533b01(0x15a),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0xa4c296+=_0x533b01(0x14a),_0xa4c296+='</tr>',_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+=_0x533b01(0xf5),_0xa4c296+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0xa4c296+=_0x533b01(0x113);for(let _0x14c187=0x0;_0x14c187<=_0x1750e3[_0x533b01(0x252)]-0x1;_0x14c187++){const _0x567d6a=_0x1750e3[_0x14c187];for(let _0x10cfc3=0x0;_0x10cfc3<_0x502a3e[_0x533b01(0xe7)][_0x533b01(0x252)];_0x10cfc3++){const _0x24e025=_0x502a3e[_0x533b01(0xe7)][_0x10cfc3];if(_0x24e025[_0x533b01(0x23c)][_0x533b01(0x141)]===_0x567d6a[_0x533b01(0x23c)][_0x533b01(0x141)]){var _0x68ecc0='';switch(_0x567d6a[_0x533b01(0x23c)]['category']){case'Standard':_0x68ecc0=_0x24e025[_0x533b01(0x23c)][_0x533b01(0x1e5)]+_0x533b01(0x215);break;case _0x533b01(0x1b7):_0x68ecc0=_0x24e025[_0x533b01(0x23c)]['brand']+_0x533b01(0x145);break;default:_0x68ecc0=_0x24e025[_0x533b01(0x23c)][_0x533b01(0x1e5)];break;}_0xa4c296+=_0x533b01(0x1cf)+_0x68ecc0+'</b></td>';}}}_0xa4c296+=_0x533b01(0x133),_0xa4c296+=_0x533b01(0x128),_0xa4c296+=_0x533b01(0x260),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+=_0x533b01(0x202);for(let _0xbddae8=0x0;_0xbddae8<=_0x502a3e[_0x533b01(0xe7)][_0x533b01(0x252)]-0x1;_0xbddae8++){const _0x50b272=_0x502a3e[_0xbddae8];_0xa4c296+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0xa4c296+=_0x533b01(0x24f),_0xa4c296+=_0x533b01(0x255);}_0xa4c296+=_0x533b01(0x121),_0xa4c296+=_0x533b01(0x1e3),_0xa4c296+=_0x533b01(0x1c1),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x11f),_0xa4c296+=_0x533b01(0x1a5),_0x590739[_0x533b01(0x235)](_0x56f347=>{_0xa4c296+=_0x56f347;});let _0x40a88e={},_0x307715={},_0x34ca9b={};for(let _0x51b5ed=0x0;_0x51b5ed<=_0x5ded59[_0x533b01(0x252)]-0x1;_0x51b5ed++){const _0x4ff04d=_0x5ded59[_0x51b5ed];var _0x5e8b81=0x0;for(let _0x5ef9e7=0x0;_0x5ef9e7<=_0x4ff04d[_0x533b01(0x1a6)][_0x533b01(0x252)]-0x1;_0x5ef9e7++){const _0x146b3e=_0x4ff04d[_0x533b01(0x1a6)][_0x5ef9e7],_0x22a79b=_0x146b3e[_0x533b01(0x1e5)]+'-'+_0x146b3e[_0x533b01(0x141)];if(_0x146b3e[_0x533b01(0x1df)][_0x533b01(0x206)]=='P')_0x146b3e['product_details']['isFG']==_0x533b01(0x1dc)?(!_0x34ca9b[_0x22a79b]&&(_0x34ca9b[_0x22a79b]=0x0),_0x34ca9b[_0x22a79b]+=_0x146b3e[_0x533b01(0x193)]):(!_0x40a88e[_0x22a79b]&&(_0x40a88e[_0x22a79b]=0x0),_0x40a88e[_0x22a79b]+=_0x146b3e[_0x533b01(0x193)]);else _0x146b3e[_0x533b01(0x1df)][_0x533b01(0x206)]=='S'&&(_0x146b3e[_0x533b01(0x1df)]['isFG']==_0x533b01(0x1dc)?(!_0x34ca9b[_0x22a79b]&&(_0x34ca9b[_0x22a79b]=0x0),_0x34ca9b[_0x22a79b]+=_0x146b3e[_0x533b01(0x193)],console[_0x533b01(0x233)](_0x146b3e[_0x533b01(0x193)])):(!_0x307715[_0x22a79b]&&(_0x307715[_0x22a79b]=0x0),_0x307715[_0x22a79b]+=_0x146b3e[_0x533b01(0x193)]));_0x5e8b81++;}}let _0x57a436={},_0x56ce08={},_0x4b8c4a={};var _0x5bcea8=0x0,_0x126b46=0x0;for(let _0x5a40fc=0x0;_0x5a40fc<=_0x5e0d05[_0x533b01(0x252)]-0x1;_0x5a40fc++){const _0x53fffb=_0x5e0d05[_0x5a40fc];var _0x5e8b81=0x0;for(let _0x1cb7ef=0x0;_0x1cb7ef<=_0x53fffb['products']['length']-0x1;_0x1cb7ef++){const _0x2bd3c8=_0x53fffb[_0x533b01(0x1a6)][_0x1cb7ef],_0x249771=_0x2bd3c8[_0x533b01(0x1e5)]+'-'+_0x2bd3c8[_0x533b01(0x141)];if(_0x2bd3c8[_0x533b01(0x1df)][_0x533b01(0x206)]=='P')_0x2bd3c8['product_details']['isFG']==_0x533b01(0x1dc)?(!_0x4b8c4a[_0x249771]&&(_0x4b8c4a[_0x249771]=0x0),_0x4b8c4a[_0x249771]+=_0x2bd3c8[_0x533b01(0x193)]):(!_0x57a436[_0x249771]&&(_0x57a436[_0x249771]=0x0),_0x57a436[_0x249771]+=_0x2bd3c8[_0x533b01(0x193)]);else _0x2bd3c8[_0x533b01(0x1df)][_0x533b01(0x206)]=='S'&&(_0x2bd3c8[_0x533b01(0x1df)][_0x533b01(0x169)]==_0x533b01(0x1dc)?(!_0x4b8c4a[_0x249771]&&(_0x4b8c4a[_0x249771]=0x0),_0x4b8c4a[_0x249771]+=_0x2bd3c8[_0x533b01(0x193)]):(!_0x56ce08[_0x249771]&&(_0x56ce08[_0x249771]=0x0),_0x56ce08[_0x249771]+=_0x2bd3c8['qty']));_0x5e8b81++;}var _0x517646=parseFloat(_0x53fffb['cash']),_0x1583c4=parseFloat(_0x53fffb['amount']);isNaN(_0x1583c4)&&(_0x1583c4=0x0),_0x5bcea8+=_0x517646,_0x126b46+=_0x1583c4;}_0xa4c296+='<tr>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0xa4c296+=_0x533b01(0x247),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x3c2107=0x0;_0x3c2107<=_0x502a3e[_0x533b01(0xe7)][_0x533b01(0x252)]-0x1;_0x3c2107++){const _0x23553d=_0x502a3e[_0x533b01(0xe7)][_0x3c2107],_0x39e697=_0x23553d[_0x533b01(0x23c)]['brand']+'-'+_0x23553d['_id'][_0x533b01(0x141)];var _0x1c6529=_0x40a88e[_0x39e697]!==undefined?formatNumber(_0x40a88e[_0x39e697][_0x533b01(0xe5)](0x2)):'',_0x531a34=_0x34ca9b[_0x39e697]!==undefined?formatNumber(_0x34ca9b[_0x39e697]['toFixed'](0x2)):'',_0x402770=_0x307715[_0x39e697]!==undefined?formatNumber(_0x307715[_0x39e697][_0x533b01(0xe5)](0x2)):'';_0xa4c296+=_0x533b01(0x232)+_0x1c6529+_0x533b01(0x154),_0xa4c296+=_0x533b01(0x232)+_0x402770+'</b></td>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x531a34+_0x533b01(0x154);}_0xa4c296+=_0x533b01(0x232)+formatNumber(_0x68f280)+'</b></td>',_0xa4c296+=_0x533b01(0x232)+formatNumber(_0x4e2f4c)+'</b></td>',_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+=_0x533b01(0x134),_0xa4c296+=_0x533b01(0x22e),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x34caa7=0x0;_0x34caa7<=_0x502a3e[_0x533b01(0xe7)][_0x533b01(0x252)]-0x1;_0x34caa7++){const _0x71aa80=_0x502a3e[_0x533b01(0xe7)][_0x34caa7],_0x42c3fa=_0x71aa80[_0x533b01(0x23c)][_0x533b01(0x1e5)]+'-'+_0x71aa80[_0x533b01(0x23c)][_0x533b01(0x141)];var _0x1c6529=_0x57a436[_0x42c3fa]!==undefined?formatNumber(_0x57a436[_0x42c3fa][_0x533b01(0xe5)](0x2)):'',_0x531a34=_0x4b8c4a[_0x42c3fa]!==undefined?formatNumber(_0x4b8c4a[_0x42c3fa][_0x533b01(0xe5)](0x2)):'',_0x402770=_0x56ce08[_0x42c3fa]!==undefined?formatNumber(_0x56ce08[_0x42c3fa][_0x533b01(0xe5)](0x2)):'';_0xa4c296+=_0x533b01(0x232)+_0x1c6529+_0x533b01(0x154),_0xa4c296+=_0x533b01(0x232)+_0x402770+_0x533b01(0x154),_0xa4c296+=_0x533b01(0x232)+_0x531a34+_0x533b01(0x154);}_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5bcea8)+'</b></td>',_0xa4c296+=_0x533b01(0x232)+formatNumber(_0x126b46)+_0x533b01(0x154),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+='<tr>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0xa4c296+=_0x533b01(0x170),_0xa4c296+=_0x533b01(0x20e);let _0x3b07b6=0x0,_0x3e5297=0x0,_0x39ac5c=0x0;for(let _0xb8ff34=0x0;_0xb8ff34<=_0x502a3e[_0x533b01(0xe7)][_0x533b01(0x252)]-0x1;_0xb8ff34++){const _0x1ae2b9=_0x502a3e[_0x533b01(0xe7)][_0xb8ff34],_0x51108c=_0x1ae2b9[_0x533b01(0x23c)][_0x533b01(0x1e5)]+'-'+_0x1ae2b9[_0x533b01(0x23c)][_0x533b01(0x141)];var _0x1ffe6d=_0x40a88e[_0x51108c]!==undefined?_0x40a88e[_0x51108c][_0x533b01(0xe5)](0x2):'0',_0x4aa568=_0x34ca9b[_0x51108c]!==undefined?_0x34ca9b[_0x51108c][_0x533b01(0xe5)](0x2):'0',_0x346bab=_0x307715[_0x51108c]!==undefined?_0x307715[_0x51108c][_0x533b01(0xe5)](0x2):'0',_0xc8b21b=_0x57a436[_0x51108c]!==undefined?_0x57a436[_0x51108c][_0x533b01(0xe5)](0x2):'0',_0x26c12f=_0x4b8c4a[_0x51108c]!==undefined?_0x4b8c4a[_0x51108c][_0x533b01(0xe5)](0x2):'0',_0x554a63=_0x56ce08[_0x51108c]!==undefined?_0x56ce08[_0x51108c][_0x533b01(0xe5)](0x2):'0';_0x3b07b6=parseFloat(_0x1ffe6d)+parseFloat(_0xc8b21b),_0x3e5297=parseFloat(_0x346bab)+parseFloat(_0x554a63),_0x39ac5c=parseFloat(_0x4aa568)+parseFloat(_0x26c12f),_0xa4c296+=_0x533b01(0x232)+formatNumber(_0x3b07b6[_0x533b01(0xe5)](0x2))+_0x533b01(0x154),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3e5297[_0x533b01(0xe5)](0x2))+_0x533b01(0x154),_0xa4c296+=_0x533b01(0x232)+formatNumber(_0x39ac5c[_0x533b01(0xe5)](0x2))+_0x533b01(0x154);}var _0x149539=formatNumber(_0x68f280+_0x5bcea8),_0x38a68a=formatNumber(_0x4e2f4c+_0x126b46);_0xa4c296+=_0x533b01(0x232)+_0x149539+_0x533b01(0x154),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x38a68a+_0x533b01(0x154),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+='<tr>',_0xa4c296+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x502a3e[_0x533b01(0xe7)][_0x533b01(0x252)]*0x3+0x9)+'\x22><b></b></td>',_0xa4c296+='</tr>',_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0xa4c296+=_0x533b01(0x20e);for(let _0x1adb00=0x0;_0x1adb00<=_0x502a3e[_0x533b01(0xe7)][_0x533b01(0x252)]-0x1;_0x1adb00++){const _0x2e24ef=_0x502a3e[_0x533b01(0xe7)][_0x1adb00],_0x5a037a=_0x2e24ef['_id'][_0x533b01(0x1e5)]+'-'+_0x2e24ef[_0x533b01(0x23c)][_0x533b01(0x141)];var _0x1ffe6d=_0x40a88e[_0x5a037a]!==undefined?_0x40a88e[_0x5a037a][_0x533b01(0xe5)](0x2):'0',_0x4aa568=_0x34ca9b[_0x5a037a]!==undefined?_0x34ca9b[_0x5a037a][_0x533b01(0xe5)](0x2):'0',_0x346bab=_0x307715[_0x5a037a]!==undefined?_0x307715[_0x5a037a]['toFixed'](0x2):'0',_0xc8b21b=_0x57a436[_0x5a037a]!==undefined?_0x57a436[_0x5a037a][_0x533b01(0xe5)](0x2):'0',_0x26c12f=_0x4b8c4a[_0x5a037a]!==undefined?_0x4b8c4a[_0x5a037a][_0x533b01(0xe5)](0x2):'0',_0x554a63=_0x56ce08[_0x5a037a]!==undefined?_0x56ce08[_0x5a037a]['toFixed'](0x2):'0';_0x3b07b6=parseFloat(_0x1ffe6d)+parseFloat(_0xc8b21b),_0x3e5297=parseFloat(_0x346bab)+parseFloat(_0x554a63),_0x39ac5c=parseFloat(_0x4aa568)+parseFloat(_0x26c12f),_0xa4c296+=_0x533b01(0x261),_0xa4c296+=_0x533b01(0x261),_0xa4c296+=_0x533b01(0x261);}_0xa4c296+=_0x533b01(0x20e),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0xa4c296+='</tr>',_0xa4c296+='<tr>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0xa4c296+=_0x533b01(0x1db),_0xa4c296+=_0x533b01(0x20e);for(let _0x34bf97=0x0;_0x34bf97<=_0x502a3e[_0x533b01(0xe7)]['length']-0x1;_0x34bf97++){const _0xeb1eb=_0x502a3e[_0x533b01(0xe7)][_0x34bf97],_0x59f8a3=_0xeb1eb['_id'][_0x533b01(0x1e5)]+'-'+_0xeb1eb[_0x533b01(0x23c)][_0x533b01(0x141)];var _0x1ffe6d=_0x40a88e[_0x59f8a3]!==undefined?_0x40a88e[_0x59f8a3][_0x533b01(0xe5)](0x2):'0',_0x4aa568=_0x34ca9b[_0x59f8a3]!==undefined?_0x34ca9b[_0x59f8a3][_0x533b01(0xe5)](0x2):'0',_0x346bab=_0x307715[_0x59f8a3]!==undefined?_0x307715[_0x59f8a3]['toFixed'](0x2):'0',_0xc8b21b=_0x57a436[_0x59f8a3]!==undefined?_0x57a436[_0x59f8a3][_0x533b01(0xe5)](0x2):'0',_0x26c12f=_0x4b8c4a[_0x59f8a3]!==undefined?_0x4b8c4a[_0x59f8a3][_0x533b01(0xe5)](0x2):'0',_0x554a63=_0x56ce08[_0x59f8a3]!==undefined?_0x56ce08[_0x59f8a3][_0x533b01(0xe5)](0x2):'0';_0x3b07b6=parseFloat(_0x1ffe6d)+parseFloat(_0xc8b21b),_0x3e5297=parseFloat(_0x346bab)+parseFloat(_0x554a63),_0x39ac5c=parseFloat(_0x4aa568)+parseFloat(_0x26c12f),_0xa4c296+=_0x533b01(0x261),_0xa4c296+=_0x533b01(0x261),_0xa4c296+=_0x533b01(0x261);}_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0xa4c296+=_0x533b01(0xfa),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x4e603a=0x0;_0x4e603a<=_0x502a3e['cat_brand'][_0x533b01(0x252)]-0x1;_0x4e603a++){const _0x578200=_0x502a3e['cat_brand'][_0x4e603a],_0x15872f=_0x578200[_0x533b01(0x23c)][_0x533b01(0x1e5)]+'-'+_0x578200[_0x533b01(0x23c)][_0x533b01(0x141)];var _0x1ffe6d=_0x40a88e[_0x15872f]!==undefined?_0x40a88e[_0x15872f]['toFixed'](0x2):'0',_0x4aa568=_0x34ca9b[_0x15872f]!==undefined?_0x34ca9b[_0x15872f][_0x533b01(0xe5)](0x2):'0',_0x346bab=_0x307715[_0x15872f]!==undefined?_0x307715[_0x15872f][_0x533b01(0xe5)](0x2):'0',_0xc8b21b=_0x57a436[_0x15872f]!==undefined?_0x57a436[_0x15872f]['toFixed'](0x2):'0',_0x26c12f=_0x4b8c4a[_0x15872f]!==undefined?_0x4b8c4a[_0x15872f][_0x533b01(0xe5)](0x2):'0',_0x554a63=_0x56ce08[_0x15872f]!==undefined?_0x56ce08[_0x15872f][_0x533b01(0xe5)](0x2):'0';_0x3b07b6=parseFloat(_0x1ffe6d)+parseFloat(_0xc8b21b),_0x3e5297=parseFloat(_0x346bab)+parseFloat(_0x554a63),_0x39ac5c=parseFloat(_0x4aa568)+parseFloat(_0x26c12f),_0xa4c296+=_0x533b01(0x261),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0xa4c296+=_0x533b01(0x261);}_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+='</tr>',_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0xa4c296+=_0x533b01(0x20e);for(let _0x5ab0fd=0x0;_0x5ab0fd<=_0x502a3e['cat_brand'][_0x533b01(0x252)]-0x1;_0x5ab0fd++){const _0xdbf95e=_0x502a3e[_0x533b01(0xe7)][_0x5ab0fd],_0x2ec948=_0xdbf95e['_id'][_0x533b01(0x1e5)]+'-'+_0xdbf95e[_0x533b01(0x23c)][_0x533b01(0x141)];var _0x1ffe6d=_0x40a88e[_0x2ec948]!==undefined?_0x40a88e[_0x2ec948][_0x533b01(0xe5)](0x2):'',_0x4aa568=_0x34ca9b[_0x2ec948]!==undefined?_0x34ca9b[_0x2ec948][_0x533b01(0xe5)](0x2):'',_0x346bab=_0x307715[_0x2ec948]!==undefined?_0x307715[_0x2ec948]['toFixed'](0x2):'',_0xc8b21b=_0x57a436[_0x2ec948]!==undefined?_0x57a436[_0x2ec948]['toFixed'](0x2):'',_0x26c12f=_0x4b8c4a[_0x2ec948]!==undefined?_0x4b8c4a[_0x2ec948][_0x533b01(0xe5)](0x2):'',_0x554a63=_0x56ce08[_0x2ec948]!==undefined?_0x56ce08[_0x2ec948]['toFixed'](0x2):'';_0x3b07b6=formatNumber(parseFloat(_0x1ffe6d)+parseFloat(_0xc8b21b)),_0x3e5297=formatNumber(parseFloat(_0x346bab)+parseFloat(_0x554a63)),_0x39ac5c=formatNumber(parseFloat(_0x4aa568)+parseFloat(_0x26c12f)),_0xa4c296+=_0x533b01(0x232)+_0x1ffe6d+_0x533b01(0x154),_0xa4c296+=_0x533b01(0x232)+_0x346bab+_0x533b01(0x154),_0xa4c296+=_0x533b01(0x232)+_0x4aa568+'</b></td>';}_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0xf3),_0xa4c296+=_0x533b01(0x1dd),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>',_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x24ff61=0x0;_0x24ff61<=_0x502a3e['cat_brand']['length']-0x1;_0x24ff61++){const _0x414558=_0x502a3e[_0x533b01(0xe7)][_0x24ff61],_0x586b34=_0x414558[_0x533b01(0x23c)][_0x533b01(0x1e5)]+'-'+_0x414558[_0x533b01(0x23c)][_0x533b01(0x141)];var _0x1ffe6d=_0x40a88e[_0x586b34]!==undefined?_0x40a88e[_0x586b34][_0x533b01(0xe5)](0x2):'0',_0x4aa568=_0x34ca9b[_0x586b34]!==undefined?_0x34ca9b[_0x586b34][_0x533b01(0xe5)](0x2):'0',_0x346bab=_0x307715[_0x586b34]!==undefined?_0x307715[_0x586b34][_0x533b01(0xe5)](0x2):'0',_0xc8b21b=_0x57a436[_0x586b34]!==undefined?_0x57a436[_0x586b34]['toFixed'](0x2):'0',_0x26c12f=_0x4b8c4a[_0x586b34]!==undefined?_0x4b8c4a[_0x586b34][_0x533b01(0xe5)](0x2):'0',_0x554a63=_0x56ce08[_0x586b34]!==undefined?_0x56ce08[_0x586b34][_0x533b01(0xe5)](0x2):'0';_0x3b07b6=parseFloat(_0x1ffe6d)+parseFloat(_0xc8b21b),_0x3e5297=parseFloat(_0x346bab)+parseFloat(_0x554a63),_0x39ac5c=parseFloat(_0x4aa568)+parseFloat(_0x26c12f),_0xa4c296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0xa4c296+=_0x533b01(0x261),_0xa4c296+=_0x533b01(0x261);}_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+=_0x533b01(0x20e),_0xa4c296+='</tr>',_0xa4c296+=_0x533b01(0xe0),_0xa4c296+=_0x533b01(0xe4);}),_0xa4c296;}async function generateReferenceNumber(_0x1bcd04,_0x46461b,_0x484c68){const _0x454e1a=a0_0x58bbe1,_0x54e72c=new Date(_0x1bcd04)[_0x454e1a(0x17b)](),_0x18ece9=('0'+(new Date(_0x1bcd04)[_0x454e1a(0x1af)]()+0x1))['slice'](-0x2),_0x3d85a1=('0'+new Date(_0x1bcd04)[_0x454e1a(0x23a)]())[_0x454e1a(0x167)](-0x2),_0x27aa3b=await staff[_0x454e1a(0x130)]({'email':_0x484c68['email']}),_0x15b7dd=_0x27aa3b['sales_man_code'],_0x391b7e=_0x15b7dd+'-'+_0x54e72c+_0x18ece9+_0x3d85a1,_0x226a47=await Reference[_0x454e1a(0x130)]({'referenceNumber':new RegExp('^'+_0x391b7e),'salesman_code':_0x15b7dd})[_0x454e1a(0x18c)]({'createdAt':-0x1}),_0x43b946=_0x391b7e;_0x226a47&&(_0x43b946=_0x226a47[_0x454e1a(0x1c7)]);console[_0x454e1a(0x233)](_0x43b946);const _0x360d1a=new Reference({'referenceNumber':_0x43b946,'staff_id':_0x46461b,'salesman_code':_0x15b7dd});return await _0x360d1a['save'](),_0x43b946;}router[a0_0x58bbe1(0x1f1)](a0_0x58bbe1(0x18b),auth,async(_0x4e45c6,_0x1d2ec2)=>{const _0x42aa80=a0_0x58bbe1,{from_date:_0x3d3115,dataview:_0x45b44b}=_0x4e45c6['body'],_0x1c0c57=_0x4e45c6['user'],_0x23b50f=await staff[_0x42aa80(0x130)]({'email':_0x1c0c57[_0x42aa80(0x175)]}),_0x5b3729=await master_shop[_0x42aa80(0x203)](),_0x505ac7='';var _0x282f4b=new Date(_0x3d3115);const _0xe934dd={'year':_0x42aa80(0x23e),'month':_0x42aa80(0x1aa),'day':_0x42aa80(0x23e)},_0x449349=new Intl[(_0x42aa80(0x1e9))](_0x42aa80(0x166),_0xe934dd)['format'](_0x282f4b),_0xf40607=await Reference['find']({'staff_id':_0x23b50f['_id']['valueOf'](),'date_include':_0x3d3115});if(_0xf40607[_0x42aa80(0x252)]>0x0){let _0x14f155='';_0x14f155+=_0xf40607[0x0][_0x42aa80(0x186)];if(_0x45b44b==_0x42aa80(0x139)){const _0x5d83fa=cheerio['load'](_0x14f155);let _0x403197=[],_0x5da26d=[],_0x570536=[];const _0x1de009=_0x5bfc4c=>{const _0x12ffc7=_0x42aa80,_0x5ee256={'top':{'style':'thick','color':{'rgb':_0x12ffc7(0x197)}},'bottom':{'style':_0x12ffc7(0x163),'color':{'rgb':'000000'}},'left':{'style':_0x12ffc7(0x163),'color':{'rgb':_0x12ffc7(0x197)}},'right':{'style':_0x12ffc7(0x163),'color':{'rgb':_0x12ffc7(0x197)}}};if(_0x5bfc4c){const _0xb2f58=_0x5bfc4c[_0x12ffc7(0x138)](';')[_0x12ffc7(0x140)]((_0x4e67bd,_0x3afa5b)=>{const _0x2171d4=_0x12ffc7,[_0x5926ad,_0x2b4d4e]=_0x3afa5b[_0x2171d4(0x138)](':')[_0x2171d4(0x151)](_0x4ff192=>_0x4ff192[_0x2171d4(0x257)]());return _0x4e67bd[_0x5926ad]=_0x2b4d4e,_0x4e67bd;},{});_0xb2f58['border-top']&&(_0x5ee256[_0x12ffc7(0x103)][_0x12ffc7(0x204)]=_0xb2f58[_0x12ffc7(0x1bd)][_0x12ffc7(0x1d8)](_0x12ffc7(0x19b))?_0x12ffc7(0x19b):_0x12ffc7(0x124)),_0xb2f58[_0x12ffc7(0x1e1)]&&(_0x5ee256[_0x12ffc7(0xfc)]['style']=_0xb2f58[_0x12ffc7(0x1e1)][_0x12ffc7(0x1d8)]('thin')?_0x12ffc7(0x19b):'medium'),_0xb2f58[_0x12ffc7(0x245)]&&(_0x5ee256[_0x12ffc7(0x108)][_0x12ffc7(0x204)]=_0xb2f58[_0x12ffc7(0x245)][_0x12ffc7(0x1d8)](_0x12ffc7(0x19b))?'thin':_0x12ffc7(0x124)),_0xb2f58[_0x12ffc7(0xed)]&&(_0x5ee256[_0x12ffc7(0x225)][_0x12ffc7(0x204)]=_0xb2f58[_0x12ffc7(0xed)]['includes']('thin')?_0x12ffc7(0x19b):_0x12ffc7(0x124));}return _0x5ee256;};_0x5d83fa(_0x42aa80(0x207))['each']((_0x4afcdc,_0x5bbac3)=>{const _0x4352a4=_0x42aa80;let _0x1aca0e=[],_0x4febbd=0x0;while(_0x570536[_0x4febbd]){_0x570536[_0x4febbd]--,_0x4febbd++;}_0x5d83fa(_0x5bbac3)[_0x4352a4(0x203)]('td,\x20th')[_0x4352a4(0x236)]((_0x309294,_0x5d832b)=>{const _0x387d8b=_0x4352a4;let _0x4be400=_0x5d83fa(_0x5d832b)[_0x387d8b(0x1fe)]()['trim'](),_0x18683a=parseFloat(_0x4be400[_0x387d8b(0x1c9)](/,/g,''));isNaN(_0x18683a)&&(_0x18683a=_0x4be400);let _0x19d0d4=parseInt(_0x5d83fa(_0x5d832b)[_0x387d8b(0x118)](_0x387d8b(0x14e)))||0x1,_0x191e2c=parseInt(_0x5d83fa(_0x5d832b)[_0x387d8b(0x118)]('rowspan'))||0x1;const _0x1897ee=_0x5d83fa(_0x5d832b)[_0x387d8b(0x118)](_0x387d8b(0x204)),_0x259d89=_0x1de009(_0x1897ee);_0x1aca0e[_0x4febbd]={'v':_0x18683a,'s':{'border':_0x259d89}};(_0x19d0d4>0x1||_0x191e2c>0x1)&&_0x5da26d[_0x387d8b(0x1d2)]({'s':{'r':_0x4afcdc,'c':_0x4febbd},'e':{'r':_0x4afcdc+_0x191e2c-0x1,'c':_0x4febbd+_0x19d0d4-0x1}});for(let _0xe6a84a=0x0;_0xe6a84a<_0x19d0d4;_0xe6a84a++){_0x191e2c>0x1&&(_0x570536[_0x4febbd+_0xe6a84a]=_0x191e2c-0x1);}_0x4febbd+=_0x19d0d4;}),_0x403197[_0x4352a4(0x1d2)](_0x1aca0e);});const _0x3f28a9=XLSX[_0x42aa80(0x192)]['book_new'](),_0x19a904=XLSX['utils'][_0x42aa80(0xe3)](_0x403197);_0x5da26d[_0x42aa80(0x252)]>0x0&&(_0x19a904['!merges']=_0x5da26d);_0x19a904[_0x42aa80(0x15b)]=_0x403197[0x0][_0x42aa80(0x151)](()=>({'wpx':0x64})),XLSX[_0x42aa80(0x192)][_0x42aa80(0x112)](_0x3f28a9,_0x19a904,_0x42aa80(0x142));const _0x136097=XLSX[_0x42aa80(0x12e)](_0x3f28a9,{'bookType':_0x42aa80(0x174),'type':_0x42aa80(0x18a)});_0x1d2ec2['setHeader'](_0x42aa80(0x224),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x1d2ec2['setHeader']('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x1d2ec2[_0x42aa80(0x13f)](_0x136097);}else{let _0x37ec94='';_0x37ec94+=_0x14f155,_0x37ec94+='<script>',_0x37ec94+='window.onload\x20=\x20function()\x20{',_0x37ec94+='window.print();',_0x37ec94+='};',_0x37ec94+=_0x42aa80(0x1bb),_0x1d2ec2[_0x42aa80(0x13f)](_0x37ec94);}}else generateReferenceNumber(_0x3d3115,_0x23b50f[_0x42aa80(0x23c)]['valueOf'](),_0x1c0c57)[_0x42aa80(0x25e)](async _0x58fcd7=>{const _0x20b9db=_0x42aa80,_0x4f6066=await agentsdataDSICheck_DSRR(_0x3d3115,_0x23b50f[_0x20b9db(0x23c)]['valueOf'](),_0x505ac7,_0x58fcd7);console[_0x20b9db(0x233)](_0x4f6066);let _0x394754=_0x20b9db(0xe6);_0x394754+=_0x20b9db(0x1cb),_0x394754+=_0x20b9db(0x187),_0x394754+=_0x20b9db(0x1ef),_0x394754+=_0x4f6066,_0x394754+='</table>',_0x394754+=_0x20b9db(0x19e),_0x394754+=_0x20b9db(0x19e);if(_0x4f6066[_0x20b9db(0x252)]>0x0){const _0x13f70a=await Reference[_0x20b9db(0x130)]({'staff_id':_0x23b50f[_0x20b9db(0x23c)]['valueOf'](),'referenceNumber':_0x58fcd7});_0x13f70a['html']=_0x394754,_0x13f70a[_0x20b9db(0x227)]=_0x3d3115,await _0x13f70a['save']();if(_0x45b44b==_0x20b9db(0x139)){const _0x124bf9=cheerio[_0x20b9db(0xff)](_0x394754);let _0x2cfbf8=[],_0x3f1be9=[],_0x141cdc=[];const _0x37fc4c=_0x5beb1e=>{const _0x4fee48=_0x20b9db,_0xf7a6fe={'top':{'style':_0x4fee48(0x163),'color':{'rgb':_0x4fee48(0x197)}},'bottom':{'style':_0x4fee48(0x163),'color':{'rgb':_0x4fee48(0x197)}},'left':{'style':_0x4fee48(0x163),'color':{'rgb':_0x4fee48(0x197)}},'right':{'style':'thick','color':{'rgb':_0x4fee48(0x197)}}};if(_0x5beb1e){const _0x59c3e1=_0x5beb1e['split'](';')['reduce']((_0x13d1e7,_0x1f98c0)=>{const _0x27eec4=_0x4fee48,[_0x196f93,_0x250251]=_0x1f98c0[_0x27eec4(0x138)](':')[_0x27eec4(0x151)](_0x52d23f=>_0x52d23f['trim']());return _0x13d1e7[_0x196f93]=_0x250251,_0x13d1e7;},{});_0x59c3e1[_0x4fee48(0x1bd)]&&(_0xf7a6fe[_0x4fee48(0x103)][_0x4fee48(0x204)]=_0x59c3e1[_0x4fee48(0x1bd)][_0x4fee48(0x1d8)]('thin')?'thin':_0x4fee48(0x124)),_0x59c3e1[_0x4fee48(0x1e1)]&&(_0xf7a6fe[_0x4fee48(0xfc)][_0x4fee48(0x204)]=_0x59c3e1[_0x4fee48(0x1e1)][_0x4fee48(0x1d8)](_0x4fee48(0x19b))?_0x4fee48(0x19b):_0x4fee48(0x124)),_0x59c3e1['border-left']&&(_0xf7a6fe[_0x4fee48(0x108)][_0x4fee48(0x204)]=_0x59c3e1['border-left']['includes'](_0x4fee48(0x19b))?_0x4fee48(0x19b):_0x4fee48(0x124)),_0x59c3e1[_0x4fee48(0xed)]&&(_0xf7a6fe['right'][_0x4fee48(0x204)]=_0x59c3e1[_0x4fee48(0xed)][_0x4fee48(0x1d8)](_0x4fee48(0x19b))?_0x4fee48(0x19b):_0x4fee48(0x124));}return _0xf7a6fe;};_0x124bf9(_0x20b9db(0x207))[_0x20b9db(0x236)]((_0x32ff7b,_0x2cdf2d)=>{const _0x2b94d0=_0x20b9db;let _0x5e8ac6=[],_0xea48b8=0x0;while(_0x141cdc[_0xea48b8]){_0x141cdc[_0xea48b8]--,_0xea48b8++;}_0x124bf9(_0x2cdf2d)[_0x2b94d0(0x203)](_0x2b94d0(0x165))['each']((_0xdd38b4,_0x2cd591)=>{const _0x4b85ee=_0x2b94d0;let _0x24abd2=_0x124bf9(_0x2cd591)[_0x4b85ee(0x1fe)]()[_0x4b85ee(0x257)](),_0x86141b=parseFloat(_0x24abd2[_0x4b85ee(0x1c9)](/,/g,''));isNaN(_0x86141b)&&(_0x86141b=_0x24abd2);let _0x2a1872=parseInt(_0x124bf9(_0x2cd591)[_0x4b85ee(0x118)](_0x4b85ee(0x14e)))||0x1,_0x319367=parseInt(_0x124bf9(_0x2cd591)['attr']('rowspan'))||0x1;const _0x59530b=_0x124bf9(_0x2cd591)[_0x4b85ee(0x118)](_0x4b85ee(0x204)),_0x1e54a1=_0x37fc4c(_0x59530b);_0x5e8ac6[_0xea48b8]={'v':_0x86141b,'s':{'border':_0x1e54a1}};(_0x2a1872>0x1||_0x319367>0x1)&&_0x3f1be9['push']({'s':{'r':_0x32ff7b,'c':_0xea48b8},'e':{'r':_0x32ff7b+_0x319367-0x1,'c':_0xea48b8+_0x2a1872-0x1}});for(let _0x305ee1=0x0;_0x305ee1<_0x2a1872;_0x305ee1++){_0x319367>0x1&&(_0x141cdc[_0xea48b8+_0x305ee1]=_0x319367-0x1);}_0xea48b8+=_0x2a1872;}),_0x2cfbf8[_0x2b94d0(0x1d2)](_0x5e8ac6);});const _0x9702da=XLSX[_0x20b9db(0x192)][_0x20b9db(0x17c)](),_0x1312e2=XLSX[_0x20b9db(0x192)][_0x20b9db(0xe3)](_0x2cfbf8);_0x3f1be9[_0x20b9db(0x252)]>0x0&&(_0x1312e2[_0x20b9db(0x191)]=_0x3f1be9);_0x1312e2['!cols']=_0x2cfbf8[0x0][_0x20b9db(0x151)](()=>({'wpx':0x64})),XLSX[_0x20b9db(0x192)][_0x20b9db(0x112)](_0x9702da,_0x1312e2,'Sales\x20Report');const _0x4a3d11=XLSX[_0x20b9db(0x12e)](_0x9702da,{'bookType':_0x20b9db(0x174),'type':'buffer'});_0x1d2ec2[_0x20b9db(0x254)](_0x20b9db(0x224),_0x20b9db(0x1f5)),_0x1d2ec2['setHeader'](_0x20b9db(0x262),_0x20b9db(0x104)),_0x1d2ec2[_0x20b9db(0x13f)](_0x4a3d11);}else _0x394754+=_0x20b9db(0x181),_0x394754+=_0x20b9db(0xdc),_0x394754+=_0x20b9db(0x110),_0x394754+='};',_0x394754+='</script>',_0x1d2ec2[_0x20b9db(0x13f)](_0x394754);}else await Reference[_0x20b9db(0x11d)]({'referenceNumber':_0x58fcd7}),_0x4e45c6['flash']('errors',_0x20b9db(0x14b)),_0x1d2ec2[_0x20b9db(0x1ce)](_0x20b9db(0x1e7));})['catch'](console[_0x42aa80(0x256)]);}),router[a0_0x58bbe1(0x1c5)](a0_0x58bbe1(0x1bc),auth,async(_0x29bce1,_0x4efb78)=>{const _0x413fa6=a0_0x58bbe1;try{const {username:_0x546a56,email:_0x8a04bc,role:_0x11c160}=_0x29bce1[_0x413fa6(0x1fc)],_0x2032cd=_0x29bce1[_0x413fa6(0x1fc)],_0x2b83aa=await profile[_0x413fa6(0x130)]({'email':_0x2032cd['email']}),_0x2fda35={'year':_0x413fa6(0x23e),'month':_0x413fa6(0x1aa),'day':_0x413fa6(0x23e)},_0x1f9d76=await master_shop[_0x413fa6(0x203)]();console[_0x413fa6(0x233)](_0x413fa6(0xdf),_0x1f9d76);const _0x5d00fd=await product[_0x413fa6(0x203)]();console[_0x413fa6(0x233)]('Products\x20find_data',_0x5d00fd);const _0x13d9af=await warehouse['aggregate']([{'$unwind':_0x413fa6(0xe2)},{'$lookup':{'from':_0x413fa6(0x1a6),'localField':'product_details.product_name','foreignField':_0x413fa6(0x11e),'as':_0x413fa6(0x1ab)}},{'$unwind':_0x413fa6(0x123)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x413fa6(0x220)}},{'$group':{'_id':_0x413fa6(0x20b),'product_stock':{'$sum':_0x413fa6(0x102)}}}]);console[_0x413fa6(0x233)](_0x413fa6(0x15e),_0x13d9af),_0x13d9af[_0x413fa6(0x235)](_0x5136e4=>{const _0xab760c=_0x413fa6,_0x59a18c=_0x5d00fd[_0xab760c(0x151)](_0x31ddf8=>{const _0x9b2c74=_0xab760c;_0x31ddf8[_0x9b2c74(0x11e)]==_0x5136e4['_id']&&(_0x31ddf8[_0x9b2c74(0x1d4)]=parseInt(_0x31ddf8[_0x9b2c74(0x1d4)])+parseInt(_0x5136e4[_0x9b2c74(0x18f)]));});});const _0x207a04=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x543a5f=await staff[_0x413fa6(0x130)]({'email':_0x2032cd[_0x413fa6(0x175)]});if(_0x1f9d76[0x0][_0x413fa6(0x218)]=='English\x20(US)')var _0x179db7=users[_0x413fa6(0x147)];else{if(_0x1f9d76[0x0][_0x413fa6(0x218)]==_0x413fa6(0xf2))var _0x179db7=users['Hindi'];else{if(_0x1f9d76[0x0][_0x413fa6(0x218)]==_0x413fa6(0x205))var _0x179db7=users[_0x413fa6(0x205)];else{if(_0x1f9d76[0x0]['language']==_0x413fa6(0x14c))var _0x179db7=users['Spanish'];else{if(_0x1f9d76[0x0][_0x413fa6(0x218)]==_0x413fa6(0x25b))var _0x179db7=users[_0x413fa6(0x25b)];else{if(_0x1f9d76[0x0][_0x413fa6(0x218)]==_0x413fa6(0x15f))var _0x179db7=users[_0x413fa6(0x222)];else{if(_0x1f9d76[0x0]['language']=='Chinese')var _0x179db7=users[_0x413fa6(0x24a)];else{if(_0x1f9d76[0x0][_0x413fa6(0x218)]=='Arabic\x20(ae)')var _0x179db7=users[_0x413fa6(0x1d6)];}}}}}}}_0x4efb78[_0x413fa6(0x200)]('dssr_view_admin',{'success':_0x29bce1['flash'](_0x413fa6(0x12a)),'errors':_0x29bce1[_0x413fa6(0x158)](_0x413fa6(0x16d)),'alldata':_0x5d00fd,'profile':_0x2b83aa,'master_shop':_0x1f9d76,'role':_0x2032cd,'product_stock':_0x13d9af,'language':_0x179db7,'staff_arr':_0x543a5f,'staff_data_all':_0x207a04});}catch(_0xdb4534){}}),router['post']('/getDSSR_no',auth,async(_0x36ccfa,_0x3b5b59)=>{const _0x48469c=a0_0x58bbe1;try{const {from:_0x453e4e,to:_0x40dbbf,staff_data:_0x299e60}=_0x36ccfa[_0x48469c(0x1ca)],_0x54045e=await Reference[_0x48469c(0x12c)]([{'$match':{'date_include':{'$gte':_0x453e4e,'$lte':_0x40dbbf},'staff_id':_0x299e60}},{'$sort':{'date_include':0x1}}]);_0x3b5b59[_0x48469c(0x189)](_0x54045e);}catch(_0x402916){_0x3b5b59['json'](_0x402916);}}),router[a0_0x58bbe1(0x1f1)](a0_0x58bbe1(0x21b),auth,async(_0x15e7d0,_0x56c45c)=>{const _0x4669a7=a0_0x58bbe1;try{const {from:_0x4a5f17,to:_0x4dc4d8}=_0x15e7d0['body'],{sttaff_id:_0x5f1659}=_0x15e7d0[_0x4669a7(0x1fc)],_0x4874e7=await Reference[_0x4669a7(0x12c)]([{'$match':{'date_include':{'$gte':_0x4a5f17,'$lte':_0x4dc4d8},'staff_id':_0x5f1659}},{'$sort':{'date_include':0x1}}]);_0x56c45c[_0x4669a7(0x189)](_0x4874e7);}catch(_0x33a8eb){_0x56c45c[_0x4669a7(0x189)](_0x33a8eb);}}),router[a0_0x58bbe1(0x1c5)](a0_0x58bbe1(0x106),auth,async(_0x1dcb3e,_0x543995)=>{const _0x1d52ae=a0_0x58bbe1;try{const _0xc272fc=_0x1dcb3e['params']['id'],_0x1170c3=await Reference[_0x1d52ae(0x212)](_0xc272fc);let _0x1127d5='';_0x1127d5+=_0x1170c3[_0x1d52ae(0x186)],_0x1127d5+=_0x1d52ae(0x181),_0x1127d5+=_0x1d52ae(0xdc),_0x1127d5+=_0x1d52ae(0x110),_0x1127d5+='};',_0x1127d5+=_0x1d52ae(0x1bb),_0x543995['send'](_0x1127d5);}catch(_0x244fa2){_0x543995[_0x1d52ae(0x189)](_0x244fa2);}}),router[a0_0x58bbe1(0x1f1)](a0_0x58bbe1(0x1f8),auth,async(_0x25c8c7,_0x346264)=>{const _0x2abc04=a0_0x58bbe1;try{const {ref_data:_0x437af9}=_0x25c8c7[_0x2abc04(0x1ca)],_0x2abddd=_0x437af9[_0x2abc04(0x138)]('~'),_0x3a09b9=_0x2abddd[_0x2abc04(0x15c)](_0x1c05dc=>_0x1c05dc!==''),_0x2969aa=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x3a09b9}}}]),_0x1b48f1=XLSX['utils'][_0x2abc04(0x17c)]();_0x2969aa['forEach'](_0x28d251=>{const _0x557676=_0x2abc04,_0x4b9c40=cheerio[_0x557676(0xff)](_0x28d251[_0x557676(0x186)]);let _0x234364=[],_0x172b1f=[],_0x1db251=[];_0x4b9c40(_0x557676(0x207))[_0x557676(0x236)]((_0x6a55fd,_0x1d6bb9)=>{const _0x41e7de=_0x557676;let _0x3eb47a=[],_0x4f8cb0=0x0;while(_0x1db251[_0x4f8cb0]){_0x1db251[_0x4f8cb0]--,_0x4f8cb0++;}_0x4b9c40(_0x1d6bb9)['find']('td,\x20th')[_0x41e7de(0x236)]((_0x48eed8,_0xc9fe2c)=>{const _0x269925=_0x41e7de;let _0x306215=_0x4b9c40(_0xc9fe2c)[_0x269925(0x1fe)]()[_0x269925(0x257)](),_0x1f403b=parseFloat(_0x306215[_0x269925(0x1c9)](/,/g,''));isNaN(_0x1f403b)&&(_0x1f403b=_0x306215);let _0x56d2e8=parseInt(_0x4b9c40(_0xc9fe2c)[_0x269925(0x118)](_0x269925(0x14e)))||0x1,_0x568c34=parseInt(_0x4b9c40(_0xc9fe2c)[_0x269925(0x118)](_0x269925(0x23b)))||0x1;_0x3eb47a[_0x4f8cb0]=_0x1f403b;(_0x56d2e8>0x1||_0x568c34>0x1)&&_0x172b1f[_0x269925(0x1d2)]({'s':{'r':_0x6a55fd,'c':_0x4f8cb0},'e':{'r':_0x6a55fd+_0x568c34-0x1,'c':_0x4f8cb0+_0x56d2e8-0x1}});for(let _0x1a692a=0x0;_0x1a692a<_0x56d2e8;_0x1a692a++){_0x568c34>0x1&&(_0x1db251[_0x4f8cb0+_0x1a692a]=_0x568c34-0x1);}_0x4f8cb0+=_0x56d2e8;}),_0x234364[_0x41e7de(0x1d2)](_0x3eb47a);});const _0x2b2150=XLSX[_0x557676(0x192)][_0x557676(0xe3)](_0x234364);_0x172b1f['length']>0x0&&(_0x2b2150[_0x557676(0x191)]=_0x172b1f),_0x2b2150[_0x557676(0x15b)]=_0x234364[0x0][_0x557676(0x151)](()=>({'wpx':0x64})),XLSX[_0x557676(0x192)][_0x557676(0x112)](_0x1b48f1,_0x2b2150,_0x28d251['referenceNumber']);});const _0x10a805=XLSX[_0x2abc04(0x12e)](_0x1b48f1,{'bookType':_0x2abc04(0x174),'type':_0x2abc04(0x18a)});_0x346264['setHeader'](_0x2abc04(0x224),_0x2abc04(0x137)),_0x346264['setHeader'](_0x2abc04(0x262),_0x2abc04(0x104)),_0x346264[_0x2abc04(0x13f)](_0x10a805);}catch(_0x208d40){_0x346264['json'](_0x208d40);}}),router[a0_0x58bbe1(0x1f1)](a0_0x58bbe1(0x17a),auth,async(_0x25c90b,_0x74c1f2)=>{const _0x39e699=a0_0x58bbe1,{from_date:_0x4a610e,agent_id:_0x1e7c1d}=_0x25c90b[_0x39e699(0x1ca)],_0x29093d=_0x25c90b['user'],_0x10bc7a=await staff[_0x39e699(0x130)]({'email':_0x29093d[_0x39e699(0x175)]}),_0x2e5e6e=await master_shop[_0x39e699(0x203)](),_0x57942e=await agentsdataDSICheck_DSRR(_0x4a610e,_0x1e7c1d,_0x31a054);let _0x508c6e=_0x39e699(0x251);var _0x213ff5=new Date(_0x4a610e);const _0x490958={'year':_0x39e699(0x23e),'month':_0x39e699(0x1aa),'day':_0x39e699(0x23e)},_0x513e3e=new Intl[(_0x39e699(0x1e9))](_0x39e699(0x166),_0x490958)[_0x39e699(0x16f)](_0x213ff5);_0x508c6e+=_0x39e699(0x1cb),_0x508c6e+='<div\x20\x20id=\x22table-conatainer\x22>',_0x508c6e+='<table>',_0x508c6e+=_0x57942e,_0x508c6e+=_0x39e699(0xe4),_0x508c6e+=_0x39e699(0x19e),_0x508c6e+=_0x39e699(0x19e);let _0x222ffe=_0x39e699(0x22f);const _0x5a5a40={'width':'15in','height':'8.5in','orientation':_0x39e699(0x1f7),'border':{'top':_0x39e699(0x244),'right':'0.1in','bottom':_0x39e699(0x244),'left':'0.1in'},'header':{'height':_0x39e699(0x18d),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x222ffe+_0x39e699(0x239)+_0x513e3e+_0x39e699(0x253)},'footer':{'height':'20mm','contents':{'default':_0x39e699(0x16e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x39e699(0x1c4)}}};var _0x31a054='on';if(_0x31a054=='on'){const _0x462247=cheerio[_0x39e699(0xff)](_0x508c6e);let _0x546291=[],_0x50d7d3=[],_0x2f3081=[];_0x462247(_0x39e699(0x207))['each']((_0x57d34a,_0x5044b1)=>{const _0x18fc60=_0x39e699;let _0x572fb2=[],_0x583333=0x0;while(_0x2f3081[_0x583333]){_0x2f3081[_0x583333]--,_0x583333++;}_0x462247(_0x5044b1)[_0x18fc60(0x203)](_0x18fc60(0x165))['each']((_0x1f32ef,_0x4692ff)=>{const _0x18d7df=_0x18fc60;let _0x475b5d=_0x462247(_0x4692ff)[_0x18d7df(0x1fe)]()[_0x18d7df(0x257)](),_0x22dfc4=parseFloat(_0x475b5d['replace'](/,/g,''));isNaN(_0x22dfc4)&&(_0x22dfc4=_0x475b5d);let _0x5e6bd=parseInt(_0x462247(_0x4692ff)['attr']('colspan'))||0x1,_0x1acad8=parseInt(_0x462247(_0x4692ff)[_0x18d7df(0x118)](_0x18d7df(0x23b)))||0x1;_0x572fb2[_0x583333]=_0x22dfc4;(_0x5e6bd>0x1||_0x1acad8>0x1)&&_0x50d7d3['push']({'s':{'r':_0x57d34a,'c':_0x583333},'e':{'r':_0x57d34a+_0x1acad8-0x1,'c':_0x583333+_0x5e6bd-0x1}});for(let _0x136106=0x0;_0x136106<_0x5e6bd;_0x136106++){_0x1acad8>0x1&&(_0x2f3081[_0x583333+_0x136106]=_0x1acad8-0x1);}_0x583333+=_0x5e6bd;}),_0x546291[_0x18fc60(0x1d2)](_0x572fb2);});const _0x47a91b=XLSX['utils'][_0x39e699(0x17c)](),_0xfb2510=XLSX[_0x39e699(0x192)][_0x39e699(0xe3)](_0x546291);_0x50d7d3[_0x39e699(0x252)]>0x0&&(_0xfb2510[_0x39e699(0x191)]=_0x50d7d3);_0xfb2510['!cols']=_0x546291[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x39e699(0x192)]['book_append_sheet'](_0x47a91b,_0xfb2510,'Sales\x20Report');const _0x1aa786=XLSX[_0x39e699(0x12e)](_0x47a91b,{'bookType':'xlsx','type':'buffer'});_0x74c1f2[_0x39e699(0x254)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x74c1f2[_0x39e699(0x254)](_0x39e699(0x262),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x74c1f2[_0x39e699(0x13f)](_0x1aa786);}else pdf[_0x39e699(0x149)](_0x508c6e,_0x5a5a40)[_0x39e699(0x217)](function(_0x355595,_0x1c5d4f){const _0xc4d01e=_0x39e699;if(_0x355595){_0x74c1f2[_0xc4d01e(0x183)](0x1f4)[_0xc4d01e(0x13f)](_0xc4d01e(0x176));return;}_0x74c1f2[_0xc4d01e(0x254)](_0xc4d01e(0x262),_0xc4d01e(0x213)),_0x1c5d4f['pipe'](_0x74c1f2);});}),module[a0_0x58bbe1(0x23d)]=router;