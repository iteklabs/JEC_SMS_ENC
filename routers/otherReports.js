const a0_0x4a8536=a0_0x2e1a;(function(_0x4f76db,_0x502c8d){const _0x13c232=a0_0x2e1a,_0x3f1697=_0x4f76db();while(!![]){try{const _0x32c6a7=parseInt(_0x13c232(0x32c))/0x1+parseInt(_0x13c232(0x2ec))/0x2+-parseInt(_0x13c232(0x2b0))/0x3*(parseInt(_0x13c232(0x1d6))/0x4)+-parseInt(_0x13c232(0x2b4))/0x5*(parseInt(_0x13c232(0x2f2))/0x6)+parseInt(_0x13c232(0x1c2))/0x7*(parseInt(_0x13c232(0x215))/0x8)+parseInt(_0x13c232(0x2aa))/0x9+parseInt(_0x13c232(0x2f6))/0xa*(-parseInt(_0x13c232(0x2b7))/0xb);if(_0x32c6a7===_0x502c8d)break;else _0x3f1697['push'](_0x3f1697['shift']());}catch(_0x2e1fc0){_0x3f1697['push'](_0x3f1697['shift']());}}}(a0_0x26c3,0xd382d));const express=require(a0_0x4a8536(0x2a8)),res=require('express/lib/response'),app=express(),router=express[a0_0x4a8536(0x256)](),multer=require(a0_0x4a8536(0x268)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x4a8536(0x27d)),auth=require(a0_0x4a8536(0x1c9)),users=require(a0_0x4a8536(0x25f)),excelJS=require(a0_0x4a8536(0x2ed)),XLSX=require(a0_0x4a8536(0x1f3)),PDFDocument=require(a0_0x4a8536(0x299)),fs=require('fs'),blobStream=require(a0_0x4a8536(0x216)),JsBarcode=require('jsbarcode'),{Canvas}=require('canvas'),pdf=require(a0_0x4a8536(0x1fb)),path=require(a0_0x4a8536(0x2e4)),mongoose=require(a0_0x4a8536(0x214)),cheerio=require(a0_0x4a8536(0x1df));router[a0_0x4a8536(0x1de)](a0_0x4a8536(0x24c),auth,async(_0x15226b,_0x3b752e)=>{const _0x4cc6fe=a0_0x4a8536;try{const {username:_0x1044c1,email:_0x5de92d,role:_0x548f88}=_0x15226b[_0x4cc6fe(0x1d7)],_0x68415d=_0x15226b['user'],_0x138d3e=await profile['findOne']({'email':_0x68415d[_0x4cc6fe(0x28c)]}),_0x2e2aee={'year':'numeric','month':_0x4cc6fe(0x295),'day':_0x4cc6fe(0x234)},_0x4da515=await master_shop[_0x4cc6fe(0x203)]();console['log'](_0x4cc6fe(0x33b),_0x4da515);const _0x32882e=await product[_0x4cc6fe(0x203)]();console['log'](_0x4cc6fe(0x324),_0x32882e);const _0x38d3d5=await warehouse[_0x4cc6fe(0x228)]([{'$unwind':_0x4cc6fe(0x311)},{'$lookup':{'from':_0x4cc6fe(0x26e),'localField':_0x4cc6fe(0x27c),'foreignField':_0x4cc6fe(0x30b),'as':_0x4cc6fe(0x2a0)}},{'$unwind':_0x4cc6fe(0x249)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x4cc6fe(0x2d2)}},{'$group':{'_id':_0x4cc6fe(0x1d1),'product_stock':{'$sum':_0x4cc6fe(0x24e)}}}]);console[_0x4cc6fe(0x241)](_0x4cc6fe(0x235),_0x38d3d5),_0x38d3d5['forEach'](_0x2cf091=>{const _0x43ead3=_0x32882e['map'](_0xc15972=>{const _0x7a7bd8=a0_0x2e1a;_0xc15972['name']==_0x2cf091['_id']&&(_0xc15972[_0x7a7bd8(0x27a)]=parseInt(_0xc15972[_0x7a7bd8(0x27a)])+parseInt(_0x2cf091[_0x7a7bd8(0x1db)]));});}),console[_0x4cc6fe(0x241)](_0x4cc6fe(0x324),_0x32882e);if(_0x4da515[0x0]['language']=='English\x20(US)')var _0x3e7f49=users['English'];else{if(_0x4da515[0x0][_0x4cc6fe(0x33a)]=='Hindi')var _0x3e7f49=users[_0x4cc6fe(0x236)];else{if(_0x4da515[0x0][_0x4cc6fe(0x33a)]==_0x4cc6fe(0x279))var _0x3e7f49=users['German'];else{if(_0x4da515[0x0][_0x4cc6fe(0x33a)]==_0x4cc6fe(0x2ff))var _0x3e7f49=users[_0x4cc6fe(0x2ff)];else{if(_0x4da515[0x0][_0x4cc6fe(0x33a)]==_0x4cc6fe(0x284))var _0x3e7f49=users[_0x4cc6fe(0x284)];else{if(_0x4da515[0x0][_0x4cc6fe(0x33a)]==_0x4cc6fe(0x31b))var _0x3e7f49=users[_0x4cc6fe(0x315)];else{if(_0x4da515[0x0]['language']==_0x4cc6fe(0x2f3))var _0x3e7f49=users['Chinese'];else{if(_0x4da515[0x0][_0x4cc6fe(0x33a)]=='Arabic\x20(ae)')var _0x3e7f49=users[_0x4cc6fe(0x1ba)];}}}}}}}_0x3b752e['render']('balanced',{'success':_0x15226b[_0x4cc6fe(0x1f7)](_0x4cc6fe(0x32d)),'errors':_0x15226b['flash'](_0x4cc6fe(0x340)),'alldata':_0x32882e,'profile':_0x138d3e,'master_shop':_0x4da515,'role':_0x68415d,'product_stock':_0x38d3d5,'language':_0x3e7f49});}catch(_0x119087){}});async function dataCheck(_0x1cdfa9,_0x131853){const _0x3c376b=a0_0x4a8536,_0x53fdc9=await product[_0x3c376b(0x228)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x559c68=[];_0x559c68[_0x3c376b(0x2bf)]=[];for(let _0x16e197=0x0;_0x16e197<=_0x53fdc9[_0x3c376b(0x321)]-0x1;_0x16e197++){const _0x4c4785=_0x53fdc9[_0x16e197];_0x559c68[_0x3c376b(0x2bf)][_0x3c376b(0x205)](_0x4c4785);}const _0xdaffbb=await product[_0x3c376b(0x228)]([{'$group':{'_id':{'category':_0x3c376b(0x21c)},'products':{'$push':{'brand':'$brand','product_code':_0x3c376b(0x2b8),'product_name':_0x3c376b(0x296)}}}},{'$sort':{'_id.category':-0x1}}]),_0x34a239=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x1cdfa9,'$lte':_0x131853}}},{'$unwind':_0x3c376b(0x2cf)},{'$group':{'_id':{'product_name':_0x3c376b(0x2c6),'product_code':_0x3c376b(0x2d4)},'totalQTY':{'$sum':_0x3c376b(0x325)}}}]);_0x559c68[_0x3c376b(0x2a3)]=[];for(let _0x290cc1=0x0;_0x290cc1<=_0x34a239[_0x3c376b(0x321)]-0x1;_0x290cc1++){const _0x32e47=_0x34a239[_0x290cc1];_0x559c68[_0x3c376b(0x2a3)][_0x3c376b(0x205)](_0x32e47);}const _0x1bff6b=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x1cdfa9,'$lte':_0x131853}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x3c376b(0x286)}}},{'$lookup':{'from':'staffs','localField':'sales_staff_id','foreignField':_0x3c376b(0x226),'as':_0x3c376b(0x1ef)}},{'$unwind':'$sales_info'},{'$unwind':_0x3c376b(0x2df)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x3c376b(0x1fd),'product_code':_0x3c376b(0x245)},'totalQTY':{'$sum':_0x3c376b(0x301)}}}]);console['log'](_0x1bff6b[0x0]),_0x559c68[_0x3c376b(0x1d4)]=[];for(let _0x12ca9e=0x0;_0x12ca9e<=_0x1bff6b[_0x3c376b(0x321)]-0x1;_0x12ca9e++){const _0xd9ffab=_0x1bff6b[_0x12ca9e];_0x559c68['sales_bkg'][_0x3c376b(0x205)](_0xd9ffab);}const _0x2ba150=await sales_sa[_0x3c376b(0x228)]([{'$match':{'date':{'$gte':_0x1cdfa9,'$lte':_0x131853}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x3c376b(0x1cc),'localField':_0x3c376b(0x2e5),'foreignField':_0x3c376b(0x226),'as':'sales_info'}},{'$unwind':_0x3c376b(0x2db)},{'$unwind':_0x3c376b(0x2df)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x3c376b(0x1fe)}},{'$group':{'_id':{'product_name':_0x3c376b(0x1fd),'product_code':_0x3c376b(0x245)},'totalQTY':{'$sum':_0x3c376b(0x2ae)}}}]);_0x559c68[_0x3c376b(0x26f)]=[];for(let _0x5e4bbc=0x0;_0x5e4bbc<=_0x2ba150['length']-0x1;_0x5e4bbc++){const _0xc68c7b=_0x2ba150[_0x5e4bbc];_0x559c68[_0x3c376b(0x26f)][_0x3c376b(0x205)](_0xc68c7b);}let _0x5c8752='';for(let _0x140103=0x0;_0x140103<=_0xdaffbb[_0x3c376b(0x321)]-0x1;_0x140103++){const _0x50faf0=_0xdaffbb[_0x140103];_0x5c8752+='<tr>',_0x5c8752+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x50faf0['_id'][_0x3c376b(0x2b6)]+'</td>',_0x5c8752+='</tr>';for(let _0xad3e28=0x0;_0xad3e28<_0x559c68['cat_brand'][_0x3c376b(0x321)];_0xad3e28++){const _0x8c8345=_0x559c68['cat_brand'][_0xad3e28];if(_0x8c8345['_id'][_0x3c376b(0x2b6)]==_0x50faf0['_id']['category']){let _0x5d6330=[],_0x219a3d=[],_0x1fa944=[];_0x5d6330[_0x8c8345[_0x3c376b(0x226)][_0x3c376b(0x1bd)]]=[],_0x219a3d[_0x8c8345[_0x3c376b(0x226)]['brand']]=[],_0x1fa944[_0x8c8345[_0x3c376b(0x226)]['brand']]=[];var _0x2b9413=0x0,_0x57579f=0x0,_0x477d28=0x0;for(let _0x22e1dd=0x0;_0x22e1dd<_0x8c8345['products'][_0x3c376b(0x321)];_0x22e1dd++){const _0x26b3f8=_0x8c8345[_0x3c376b(0x26e)][_0x22e1dd];for(let _0x5d17e7=0x0;_0x5d17e7<=_0x559c68[_0x3c376b(0x2a3)]['length']-0x1;_0x5d17e7++){const _0x449bd6=_0x559c68[_0x3c376b(0x2a3)][_0x5d17e7];_0x449bd6[_0x3c376b(0x226)][_0x3c376b(0x293)]==_0x26b3f8['name']&&_0x449bd6['_id'][_0x3c376b(0x280)]==_0x26b3f8[_0x3c376b(0x280)]&&(_0x2b9413+=parseInt(_0x449bd6[_0x3c376b(0x2ef)],0xa));}for(let _0x334b8c=0x0;_0x334b8c<=_0x559c68[_0x3c376b(0x26f)]['length']-0x1;_0x334b8c++){const _0xa1368f=_0x559c68['sales_ext'][_0x334b8c];_0xa1368f[_0x3c376b(0x226)]['product_name']==_0x26b3f8['name']&&_0xa1368f['_id'][_0x3c376b(0x280)]==_0x26b3f8[_0x3c376b(0x280)]&&(_0x57579f+=parseFloat(_0xa1368f[_0x3c376b(0x2ef)],0xa)[_0x3c376b(0x2c4)](0x2));}for(let _0x539160=0x0;_0x539160<=_0x559c68[_0x3c376b(0x1d4)][_0x3c376b(0x321)]-0x1;_0x539160++){const _0x13d770=_0x559c68[_0x3c376b(0x1d4)][_0x539160];_0x13d770['_id'][_0x3c376b(0x293)]==_0x26b3f8[_0x3c376b(0x30b)]&&_0x13d770['_id']['product_code']==_0x26b3f8[_0x3c376b(0x280)]&&(_0x477d28+=parseInt(_0x13d770[_0x3c376b(0x2ef)],0xa));}}const _0x4e7d65=new Intl[(_0x3c376b(0x297))](_0x3c376b(0x2bd));var _0x24179b=_0x4e7d65[_0x3c376b(0x1e2)](_0x2b9413);_0x5d6330[_0x8c8345[_0x3c376b(0x226)][_0x3c376b(0x1bd)]]['push'](_0x24179b),_0x219a3d[_0x8c8345['_id'][_0x3c376b(0x1bd)]][_0x3c376b(0x205)](_0x4e7d65['format'](_0x57579f)),_0x1fa944[_0x8c8345[_0x3c376b(0x226)]['brand']][_0x3c376b(0x205)](_0x4e7d65['format'](_0x477d28));var _0x51dc27=_0x4e7d65[_0x3c376b(0x1e2)](_0x2b9413-(_0x477d28+_0x57579f));_0x5c8752+=_0x3c376b(0x201),_0x5c8752+=_0x3c376b(0x307),_0x5c8752+=_0x3c376b(0x25a)+_0x8c8345[_0x3c376b(0x226)][_0x3c376b(0x1bd)]+_0x3c376b(0x208),_0x5c8752+='<td\x20class=\x22row_data\x22>'+_0x5d6330[_0x8c8345['_id']['brand']][0x0]+_0x3c376b(0x208),_0x5c8752+=_0x3c376b(0x1c6),_0x5c8752+=_0x3c376b(0x25a)+_0x1fa944[_0x8c8345[_0x3c376b(0x226)][_0x3c376b(0x1bd)]][0x0]+_0x3c376b(0x208),_0x5c8752+=_0x3c376b(0x25a)+_0x219a3d[_0x8c8345['_id']['brand']][0x0]+_0x3c376b(0x208),_0x5c8752+=_0x3c376b(0x25a)+_0x51dc27+_0x3c376b(0x208),_0x5c8752+=_0x3c376b(0x2cd);}}}return console['log'](_0x559c68[_0x3c376b(0x1d4)]),_0x5c8752;}router[a0_0x4a8536(0x265)]('/balance/pdf',auth,async(_0x3bb0d3,_0xb0aa11)=>{const _0x1b22ad=a0_0x4a8536,{from_date:_0x2ef72e,to_date:_0x333b48}=_0x3bb0d3[_0x1b22ad(0x308)],_0x63beda=await dataCheck(_0x2ef72e,_0x333b48);{}let _0x5efd5d=_0x1b22ad(0x2e6);var _0x11e587=new Date(_0x2ef72e),_0x4d9b68=new Date(_0x333b48);const _0x2e5520={'year':'numeric','month':_0x1b22ad(0x295),'day':'numeric'},_0x3f865e=new Intl[(_0x1b22ad(0x1c5))](_0x1b22ad(0x2bd),_0x2e5520)['format'](_0x11e587),_0x3189b6=new Intl['DateTimeFormat'](_0x1b22ad(0x2bd),_0x2e5520)['format'](_0x4d9b68);_0x5efd5d+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x5efd5d+=_0x1b22ad(0x2a6),_0x5efd5d+='<p>'+_0x3f865e+_0x1b22ad(0x22e)+_0x3189b6+_0x1b22ad(0x26a),_0x5efd5d+='<div\x20class=\x22row\x22>',_0x5efd5d+=_0x1b22ad(0x1cb),_0x5efd5d+=_0x1b22ad(0x2be),_0x5efd5d+=_0x1b22ad(0x201),_0x5efd5d+='<th\x20rowspan=\x272\x27>Category</th>',_0x5efd5d+=_0x1b22ad(0x2c0),_0x5efd5d+=_0x1b22ad(0x1eb)+_0x3f865e+'</th>',_0x5efd5d+=_0x1b22ad(0x287),_0x5efd5d+='<th\x20colspan=\x272\x27>SOLD</th>',_0x5efd5d+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x3189b6+_0x1b22ad(0x259),_0x5efd5d+=_0x1b22ad(0x2cd),_0x5efd5d+=_0x1b22ad(0x201),_0x5efd5d+=_0x1b22ad(0x1ca),_0x5efd5d+='<th>X-Truck</th>',_0x5efd5d+='</tr>',_0x5efd5d+=_0x63beda,_0x5efd5d+=_0x1b22ad(0x230),_0x5efd5d+=_0x1b22ad(0x285),_0x5efd5d+=_0x1b22ad(0x285);const _0x525108={'format':_0x1b22ad(0x1b9),'orientation':_0x1b22ad(0x294),'childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf[_0x1b22ad(0x1e5)](_0x5efd5d,_0x525108)[_0x1b22ad(0x2a4)](function(_0x1f1590,_0x1f3428){const _0x18156e=_0x1b22ad;if(_0x1f1590){_0xb0aa11[_0x18156e(0x2d8)](0x1f4)[_0x18156e(0x223)](_0x18156e(0x219));return;}_0xb0aa11[_0x18156e(0x2a2)](_0x18156e(0x312),_0x18156e(0x338)),_0x1f3428[_0x18156e(0x1bf)](_0xb0aa11);});}),router[a0_0x4a8536(0x1de)](a0_0x4a8536(0x2e0),auth,async(_0x4bc8a0,_0x2fda5d)=>{const _0x300c7d=a0_0x4a8536;try{const {username:_0x1251f5,email:_0x374da2,role:_0x46122a}=_0x4bc8a0[_0x300c7d(0x1d7)],_0x3ae080=_0x4bc8a0[_0x300c7d(0x1d7)],_0x46b424=await profile[_0x300c7d(0x1be)]({'email':_0x3ae080['email']}),_0x50f350={'year':'numeric','month':_0x300c7d(0x295),'day':_0x300c7d(0x234)},_0x59f002=await master_shop[_0x300c7d(0x203)](),_0x454cda=await product[_0x300c7d(0x203)](),_0x488b06=await warehouse[_0x300c7d(0x228)]([{'$unwind':_0x300c7d(0x311)},{'$lookup':{'from':_0x300c7d(0x26e),'localField':_0x300c7d(0x27c),'foreignField':_0x300c7d(0x30b),'as':_0x300c7d(0x2a0)}},{'$unwind':_0x300c7d(0x249)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x300c7d(0x1d1),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x59f002[0x0][_0x300c7d(0x33a)]==_0x300c7d(0x23b))var _0x40de98=users[_0x300c7d(0x1f8)];else{if(_0x59f002[0x0][_0x300c7d(0x33a)]=='Hindi')var _0x40de98=users[_0x300c7d(0x236)];else{if(_0x59f002[0x0][_0x300c7d(0x33a)]=='German')var _0x40de98=users['German'];else{if(_0x59f002[0x0][_0x300c7d(0x33a)]==_0x300c7d(0x2ff))var _0x40de98=users['Spanish'];else{if(_0x59f002[0x0][_0x300c7d(0x33a)]==_0x300c7d(0x284))var _0x40de98=users['French'];else{if(_0x59f002[0x0]['language']==_0x300c7d(0x31b))var _0x40de98=users[_0x300c7d(0x315)];else{if(_0x59f002[0x0]['language']==_0x300c7d(0x2f3))var _0x40de98=users[_0x300c7d(0x2f3)];else{if(_0x59f002[0x0][_0x300c7d(0x33a)]==_0x300c7d(0x288))var _0x40de98=users[_0x300c7d(0x1ba)];}}}}}}}_0x2fda5d['render']('agent_sales',{'success':_0x4bc8a0[_0x300c7d(0x1f7)](_0x300c7d(0x32d)),'errors':_0x4bc8a0[_0x300c7d(0x1f7)](_0x300c7d(0x340)),'alldata':_0x454cda,'profile':_0x46b424,'master_shop':_0x59f002,'role':_0x3ae080,'product_stock':_0x488b06,'language':_0x40de98});}catch(_0x1b9164){}});async function agentsdataCheck(_0x2ccc4e,_0x89694a){const _0x26bf51=a0_0x4a8536,_0x20f5a1=await product[_0x26bf51(0x228)]([{'$group':{'_id':{'brand':_0x26bf51(0x1e6),'category':'$category'},'products':{'$push':{'name':'$name','product_code':_0x26bf51(0x2b8)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2adbe5=[];_0x2adbe5['cat_brand']=[];for(let _0x9b8489=0x0;_0x9b8489<=_0x20f5a1['length']-0x1;_0x9b8489++){const _0x3d22d2=_0x20f5a1[_0x9b8489];_0x2adbe5['cat_brand']['push'](_0x3d22d2);}const _0x21fc3d=await product['aggregate']([{'$group':{'_id':{'category':_0x26bf51(0x21c)},'products':{'$push':{'brand':'$brand','product_code':_0x26bf51(0x2b8),'product_name':_0x26bf51(0x296)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1a0cf7=await product['aggregate']([{'$group':{'_id':{'category':_0x26bf51(0x21c),'brand':'$brand'}}},{'$group':{'_id':_0x26bf51(0x229),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x11f853=await sales_sa[_0x26bf51(0x228)]([{'$match':{'date':{'$gte':_0x2ccc4e,'$lte':_0x89694a}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x26bf51(0x286)}}},{'$lookup':{'from':'staffs','localField':'sales_staff_id','foreignField':_0x26bf51(0x226),'as':_0x26bf51(0x1ef)}},{'$unwind':_0x26bf51(0x2db)},{'$unwind':_0x26bf51(0x2df)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x26bf51(0x1f4),'foreignField':_0x26bf51(0x280),'as':_0x26bf51(0x246)}},{'$unwind':_0x26bf51(0x33e)},{'$group':{'_id':{'sales_id':_0x26bf51(0x1c3),'category':_0x26bf51(0x23c),'brand':_0x26bf51(0x231)},'salesman_data':{'$first':'$sales_info.name'},'totalQTY':{'$sum':_0x26bf51(0x2ae)},'products':{'$push':{'qty':_0x26bf51(0x2ae),'product_details':{'prod_name':_0x26bf51(0x1c0),'product_code':'$product_info.product_code','category':_0x26bf51(0x23c),'brand':_0x26bf51(0x231)}}}}}]);let _0x108335='';_0x108335+=_0x26bf51(0x201),_0x108335+=_0x26bf51(0x289),_0x108335+=_0x26bf51(0x2cd),_0x108335+=_0x26bf51(0x201),_0x108335+='<td\x20class=\x22cat_data\x22></td>';for(let _0x5b18b5=0x0;_0x5b18b5<=_0x21fc3d[_0x26bf51(0x321)]-0x1;_0x5b18b5++){const _0x2f1927=_0x21fc3d[_0x5b18b5];for(let _0x6c5f2c=0x0;_0x6c5f2c<_0x1a0cf7[_0x26bf51(0x321)];_0x6c5f2c++){const _0x2d5f69=_0x1a0cf7[_0x6c5f2c];_0x2d5f69[_0x26bf51(0x226)]==_0x2f1927[_0x26bf51(0x226)]['category']&&(_0x108335+='<td\x20colspan=\x22'+_0x2d5f69[_0x26bf51(0x327)]+_0x26bf51(0x264)+_0x2f1927['_id'][_0x26bf51(0x2b6)]+'</td>');}}_0x108335+=_0x26bf51(0x303),_0x108335+=_0x26bf51(0x2cd),_0x108335+=_0x26bf51(0x201),_0x108335+=_0x26bf51(0x2a7);for(let _0x166487=0x0;_0x166487<=_0x21fc3d['length']-0x1;_0x166487++){const _0x1e47fe=_0x21fc3d[_0x166487];for(let _0xbc12a5=0x0;_0xbc12a5<_0x2adbe5[_0x26bf51(0x2bf)][_0x26bf51(0x321)];_0xbc12a5++){const _0x5cc89e=_0x2adbe5[_0x26bf51(0x2bf)][_0xbc12a5];_0x5cc89e[_0x26bf51(0x226)][_0x26bf51(0x2b6)]==_0x1e47fe[_0x26bf51(0x226)]['category']&&(_0x108335+='<td\x20class=\x22cat_data\x22>'+_0x5cc89e[_0x26bf51(0x226)][_0x26bf51(0x1bd)]+_0x26bf51(0x208));}}_0x108335+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x108335+='</tr>';let _0x1e2993={'name':[],'dataqty':{}};for(let _0x152d48=0x0;_0x152d48<_0x2adbe5[_0x26bf51(0x2bf)][_0x26bf51(0x321)];_0x152d48++){const _0x93aabe=_0x2adbe5['cat_brand'][_0x152d48],_0x1fec56=_0x93aabe[_0x26bf51(0x226)]['brand'],_0x35d28b=_0x93aabe[_0x26bf51(0x226)][_0x26bf51(0x2b6)];!_0x1e2993[_0x26bf51(0x23a)][_0x1fec56]&&(_0x1e2993[_0x26bf51(0x23a)][_0x1fec56]={});!_0x1e2993[_0x26bf51(0x23a)][_0x1fec56][_0x35d28b]&&(_0x1e2993[_0x26bf51(0x23a)][_0x1fec56][_0x35d28b]=[]);for(let _0x657af7=0x0;_0x657af7<_0x11f853[_0x26bf51(0x321)];_0x657af7++){const _0xcca05c=_0x11f853[_0x657af7];if(_0x1fec56===_0xcca05c[_0x26bf51(0x226)][_0x26bf51(0x1bd)]&&_0x35d28b===_0xcca05c['_id'][_0x26bf51(0x2b6)]){const _0xf4845e=_0xcca05c[_0x26bf51(0x2bc)];!_0x1e2993[_0x26bf51(0x23a)][_0x1fec56][_0x35d28b][_0xf4845e]&&(_0x1e2993[_0x26bf51(0x23a)][_0x1fec56][_0x35d28b][_0xf4845e]=[]),_0x1e2993[_0x26bf51(0x23a)][_0x1fec56][_0x35d28b][_0xf4845e][_0x26bf51(0x205)](_0xcca05c['totalQTY']),!_0x1e2993[_0x26bf51(0x30b)][_0x26bf51(0x1ee)](_0xf4845e)&&_0x1e2993[_0x26bf51(0x30b)]['push'](_0xf4845e);}}}_0x108335+=_0x26bf51(0x201);for(let _0x2b5557=0x0;_0x2b5557<=_0x1e2993['name'][_0x26bf51(0x321)]-0x1;_0x2b5557++){const _0x163d2f=_0x1e2993[_0x26bf51(0x30b)][_0x2b5557];_0x108335+='<td\x20class=\x22row_data\x22>'+_0x163d2f+_0x26bf51(0x208);var _0x2d5217=0x0,_0x2014d9=0x0;for(let _0x1ef1d8=0x0;_0x1ef1d8<=_0x2adbe5[_0x26bf51(0x2bf)][_0x26bf51(0x321)]-0x1;_0x1ef1d8++){const _0x523f25=_0x2adbe5[_0x26bf51(0x2bf)][_0x1ef1d8];var _0x5ca147=0x0;_0x1e2993[_0x26bf51(0x23a)][_0x523f25[_0x26bf51(0x226)]['brand']][_0x523f25[_0x26bf51(0x226)][_0x26bf51(0x2b6)]][_0x163d2f]?(_0x5ca147=_0x1e2993[_0x26bf51(0x23a)][_0x523f25[_0x26bf51(0x226)][_0x26bf51(0x1bd)]][_0x523f25[_0x26bf51(0x226)]['category']][_0x163d2f][0x0],_0x108335+=_0x26bf51(0x25a)+_0x5ca147['toFixed'](0x2)+'</td>'):(_0x5ca147=0x0,_0x108335+=_0x26bf51(0x25a)+_0x5ca147+_0x26bf51(0x208)),_0x2d5217+=parseFloat(_0x5ca147[_0x26bf51(0x2c4)](0x2));}_0x108335+=_0x26bf51(0x25a)+_0x2d5217[_0x26bf51(0x2c4)](0x2)+_0x26bf51(0x208);}return _0x108335+=_0x26bf51(0x2cd),_0x108335;}router[a0_0x4a8536(0x265)]('/agent/pdf',auth,async(_0x21118f,_0x30a80e)=>{const _0x26470a=a0_0x4a8536,{from_date:_0x28ae3f,to_date:_0x1b89bc}=_0x21118f['body'],_0x31acf3=await agentsdataCheck(_0x28ae3f,_0x1b89bc);{}let _0x11dc7a=_0x26470a(0x257);var _0xe4a670=new Date(_0x28ae3f),_0x60a2c1=new Date(_0x1b89bc);const _0x43c639={'year':_0x26470a(0x234),'month':_0x26470a(0x295),'day':_0x26470a(0x234)},_0x9ad62e=new Intl[(_0x26470a(0x1c5))]('en-US',_0x43c639)[_0x26470a(0x1e2)](_0xe4a670),_0x391067=new Intl[(_0x26470a(0x1c5))](_0x26470a(0x2bd),_0x43c639)[_0x26470a(0x1e2)](_0x60a2c1);_0x11dc7a+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x11dc7a+='<p>SALES\x20REPORTS</p>',_0x11dc7a+=_0x26470a(0x1f9)+_0x9ad62e+'\x20-\x20'+_0x391067+_0x26470a(0x26a),_0x11dc7a+=_0x26470a(0x238),_0x11dc7a+='<div\x20class=\x22col-sm-11\x22>',_0x11dc7a+='<table>',_0x11dc7a+=_0x31acf3,_0x11dc7a+='</table>',_0x11dc7a+=_0x26470a(0x285),_0x11dc7a+='</div>';const _0x3ea47a={'format':_0x26470a(0x1b9),'orientation':_0x26470a(0x294),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x26470a(0x24d)}}};pdf[_0x26470a(0x1e5)](_0x11dc7a,_0x3ea47a)[_0x26470a(0x2a4)](function(_0x5f4b2e,_0x26d4c6){const _0x306622=_0x26470a;if(_0x5f4b2e){_0x30a80e[_0x306622(0x2d8)](0x1f4)[_0x306622(0x223)](_0x306622(0x219));return;}_0x30a80e[_0x306622(0x2a2)](_0x306622(0x312),'application/pdf'),_0x26d4c6[_0x306622(0x1bf)](_0x30a80e);});}),router['get'](a0_0x4a8536(0x1e8),auth,async(_0x4c14bf,_0x532557)=>{const _0x546c11=a0_0x4a8536;try{const {username:_0x1fb18c,email:_0x5018b6,role:_0x25b9f7}=_0x4c14bf[_0x546c11(0x1d7)],_0x5715a1=_0x4c14bf[_0x546c11(0x1d7)],_0x4794a5=await profile['findOne']({'email':_0x5715a1['email']}),_0x14df96={'year':_0x546c11(0x234),'month':_0x546c11(0x295),'day':_0x546c11(0x234)},_0x49c2dc=await master_shop[_0x546c11(0x203)](),_0x394ecb=await staff[_0x546c11(0x1be)]({'email':_0x5715a1[_0x546c11(0x28c)]}),_0x13cccb=await product[_0x546c11(0x203)](),_0x41c187=await warehouse['aggregate']([{'$unwind':_0x546c11(0x311)},{'$lookup':{'from':'products','localField':_0x546c11(0x27c),'foreignField':_0x546c11(0x30b),'as':_0x546c11(0x2a0)}},{'$unwind':_0x546c11(0x249)},{'$project':{'product_name':_0x546c11(0x20b),'product_stock':_0x546c11(0x2d2)}},{'$group':{'_id':_0x546c11(0x1d1),'product_stock':{'$sum':_0x546c11(0x24e)}}}]),_0x2f456d=await staff[_0x546c11(0x203)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x49c2dc[0x0]['language']==_0x546c11(0x23b))var _0x511b1d=users[_0x546c11(0x1f8)];else{if(_0x49c2dc[0x0][_0x546c11(0x33a)]==_0x546c11(0x236))var _0x511b1d=users['Hindi'];else{if(_0x49c2dc[0x0][_0x546c11(0x33a)]==_0x546c11(0x279))var _0x511b1d=users[_0x546c11(0x279)];else{if(_0x49c2dc[0x0][_0x546c11(0x33a)]==_0x546c11(0x2ff))var _0x511b1d=users['Spanish'];else{if(_0x49c2dc[0x0]['language']=='French')var _0x511b1d=users[_0x546c11(0x284)];else{if(_0x49c2dc[0x0]['language']==_0x546c11(0x31b))var _0x511b1d=users['Portuguese'];else{if(_0x49c2dc[0x0][_0x546c11(0x33a)]=='Chinese')var _0x511b1d=users['Chinese'];else{if(_0x49c2dc[0x0][_0x546c11(0x33a)]=='Arabic\x20(ae)')var _0x511b1d=users[_0x546c11(0x1ba)];}}}}}}}_0x532557[_0x546c11(0x251)]('dsi_sales_admin',{'success':_0x4c14bf[_0x546c11(0x1f7)](_0x546c11(0x32d)),'errors':_0x4c14bf['flash'](_0x546c11(0x340)),'alldata':_0x13cccb,'profile':_0x4794a5,'master_shop':_0x49c2dc,'role':_0x5715a1,'product_stock':_0x41c187,'language':_0x511b1d,'staff_arr':_0x394ecb,'staff_data_all':_0x2f456d});}catch(_0x5d14aa){_0x532557[_0x546c11(0x314)](_0x5d14aa);}});async function agentsdataDSICheck_admin(_0x511920,_0x3639b0,_0x4db66c,_0x5e69c9){const _0x384f24=a0_0x4a8536,_0x15aab2=await product[_0x384f24(0x228)]([{'$group':{'_id':{'brand':_0x384f24(0x1e6),'category':_0x384f24(0x21c)},'products':{'$push':{'name':_0x384f24(0x296),'product_code':_0x384f24(0x2b8)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xa7c765=[];_0xa7c765[_0x384f24(0x2bf)]=[];for(let _0x4318f3=0x0;_0x4318f3<=_0x15aab2[_0x384f24(0x321)]-0x1;_0x4318f3++){const _0x927056=_0x15aab2[_0x4318f3];_0xa7c765['cat_brand'][_0x384f24(0x205)](_0x927056);}const _0x58145c=await product[_0x384f24(0x228)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x384f24(0x1e6),'product_code':_0x384f24(0x2b8),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1f2f77=await product[_0x384f24(0x228)]([{'$group':{'_id':{'category':_0x384f24(0x21c),'brand':_0x384f24(0x1e6)}}},{'$group':{'_id':_0x384f24(0x229),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4cf4d8=await sales_sa[_0x384f24(0x228)]([{'$match':{'date':{'$gte':_0x511920,'$lte':_0x3639b0},'sales_staff_id':_0x4db66c,'sale_product.isFG':_0x384f24(0x1fe)}},{'$unwind':_0x384f24(0x2df)},{'$match':{'sale_product.isFG':_0x384f24(0x1fe)}},{'$lookup':{'from':_0x384f24(0x26e),'localField':_0x384f24(0x1f4),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x384f24(0x33e)},{'$group':{'_id':{'dsi':_0x384f24(0x248),'date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x384f24(0x2ae)},'products':{'$push':{'qty':_0x384f24(0x2ae),'NetPrice':_0x384f24(0x2f1),'discount':_0x384f24(0x2b1),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':_0x384f24(0x278),'category':_0x384f24(0x23c),'brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x384f24(0x275)},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x384f24(0x2eb),'category':_0x384f24(0x32b),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x384f24(0x2e8)},'totalGross':{'$sum':{'$multiply':[_0x384f24(0x2e8),_0x384f24(0x1c4)]}},'NetPrice':{'$sum':_0x384f24(0x2d5)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x384f24(0x2c7)},'product_details':{'$first':_0x384f24(0x1e4)}}},{'$group':{'_id':{'dsi':_0x384f24(0x30a),'date':_0x384f24(0x269),'customer':_0x384f24(0x2eb)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x384f24(0x2fe)},'NetPrice':{'$sum':_0x384f24(0x20c)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x384f24(0x2d1)},'products':{'$push':{'qty':_0x384f24(0x22f),'category':_0x384f24(0x229),'brand':_0x384f24(0x28b),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x3ab084=[],_0xa9a26f={},_0x44b717={},_0x5e5730={};var _0x1e1283=0x0,_0x4d8185=0x0,_0x3b7238=0x0,_0x58f0bf=0x0,_0xdc8521=0x0;const _0x3372c6=0x6;for(let _0x133712=0x0;_0x133712<=_0x4cf4d8[_0x384f24(0x321)]-0x1;_0x133712++){const _0x2f4a08=_0x4cf4d8[_0x133712];let _0x201b58=_0x384f24(0x201);_0x201b58+=_0x384f24(0x217)+_0x2f4a08[_0x384f24(0x226)][_0x384f24(0x2f5)]+_0x384f24(0x208),_0x201b58+=_0x384f24(0x217)+_0x2f4a08['_id'][_0x384f24(0x2c5)]+'</td>',_0x201b58+=_0x384f24(0x217)+_0x2f4a08[_0x384f24(0x226)][_0x384f24(0x282)]+_0x384f24(0x208);let _0x1fd3e2={};var _0x19d735=0x0;for(let _0x16879a=0x0;_0x16879a<=_0x2f4a08['products']['length']-0x1;_0x16879a++){const _0x599050=_0x2f4a08[_0x384f24(0x26e)][_0x16879a];_0x1fd3e2[_0x599050['brand']+'-'+_0x599050[_0x384f24(0x2b6)]]=_0x599050[_0x384f24(0x2ad)];const _0x475fdb=_0x599050['brand']+'-'+_0x599050[_0x384f24(0x2b6)];!_0xa9a26f[_0x475fdb]&&(_0xa9a26f[_0x475fdb]=0x0),!Array['isArray'](_0x5e5730[_0x475fdb])&&(_0x5e5730[_0x475fdb]=[]),!Array[_0x384f24(0x1bb)](_0x5e5730[_0x475fdb])&&(_0x5e5730[_0x475fdb]=[]),_0xa9a26f[_0x475fdb]+=_0x599050[_0x384f24(0x2ad)],_0x5e5730[_0x475fdb]['push'](_0x599050[_0x384f24(0x2ad)]),_0x19d735++;}for(let _0x536442=0x0;_0x536442<=_0xa7c765[_0x384f24(0x2bf)][_0x384f24(0x321)]-0x1;_0x536442++){const _0x171426=_0xa7c765[_0x384f24(0x2bf)][_0x536442],_0x2ee571=_0x171426[_0x384f24(0x226)][_0x384f24(0x1bd)]+'-'+_0x171426['_id'][_0x384f24(0x2b6)];_0x201b58+=_0x384f24(0x2d6)+(_0x1fd3e2[_0x2ee571]!==undefined?_0x1fd3e2[_0x2ee571][_0x384f24(0x2c4)](0x2):'')+'</td>';}_0x3b7238=_0x2f4a08['discount']+_0x2f4a08[_0x384f24(0x1cf)],_0x201b58+=_0x384f24(0x283)+formatNumber(parseFloat(_0x2f4a08[_0x384f24(0x2cb)],0x2)[_0x384f24(0x2c4)](0x2))+'</td>',_0x201b58+=_0x384f24(0x283)+formatNumber(_0x2f4a08[_0x384f24(0x29c)][_0x384f24(0x2c4)](0x2))+_0x384f24(0x208),_0x201b58+=_0x384f24(0x283)+formatNumber(_0x3b7238)+'</td>',_0x201b58+=_0x384f24(0x283)+formatNumber(_0x2f4a08[_0x384f24(0x25c)][_0x384f24(0x2c4)](0x2))+_0x384f24(0x208),_0x201b58+='</tr>';var _0x1d7db0=parseFloat(_0x2f4a08['totalQty'][_0x384f24(0x2c4)](0x3));_0x1e1283+=_0x1d7db0,console[_0x384f24(0x241)](_0x384f24(0x2ea),_0x1e1283+_0x384f24(0x305)+_0x1d7db0),_0x4d8185+=parseFloat(_0x2f4a08[_0x384f24(0x25c)][_0x384f24(0x2c4)](0x2)),_0x58f0bf+=_0x3b7238,_0xdc8521+=parseFloat(_0x2f4a08[_0x384f24(0x29c)][_0x384f24(0x2c4)](0x2));if(_0x133712==_0x4cf4d8['length']-0x1){_0x201b58+=_0x384f24(0x201),_0x201b58+=_0x384f24(0x200),_0x201b58+=_0x384f24(0x208);for(let _0x100129=0x0;_0x100129<=_0xa7c765[_0x384f24(0x2bf)][_0x384f24(0x321)]-0x1;_0x100129++){const _0x24a564=_0xa7c765[_0x384f24(0x2bf)][_0x100129],_0x1f9f37=_0x24a564[_0x384f24(0x226)][_0x384f24(0x1bd)]+'-'+_0x24a564[_0x384f24(0x226)][_0x384f24(0x2b6)];!_0x5e5730[_0x1f9f37]&&(_0x5e5730[_0x1f9f37]=[]);const _0x3aae7d=_0x5e5730[_0x1f9f37]['reduce']((_0x95cde3,_0x458fc4)=>_0x95cde3+_0x458fc4,0x0);_0x201b58+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x3aae7d!==undefined?formatNumber(_0x3aae7d[_0x384f24(0x2c4)](0x2)):'')+'</b></td>';}_0x201b58+=_0x384f24(0x304)+formatNumber(_0x1e1283[_0x384f24(0x2c4)](0x2),0x2)+_0x384f24(0x221),_0x201b58+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xdc8521)+'</b></td>',_0x201b58+=_0x384f24(0x304)+formatNumber(_0x58f0bf)+'</b></td>',_0x201b58+=_0x384f24(0x304)+formatNumber(_0x4d8185)+_0x384f24(0x221),_0x201b58+=_0x384f24(0x2cd);}_0x3ab084[_0x384f24(0x205)](_0x201b58);}function _0x58a632(_0x27e06f,_0x9f2375){const _0x5bc4b2=_0x384f24,_0x4e1485=[];for(let _0x5afb18=0x0;_0x5afb18<=_0x27e06f['length']-0x1;_0x5afb18+=_0x9f2375){_0x4e1485[_0x5bc4b2(0x205)](_0x27e06f[_0x5bc4b2(0x2c8)](_0x5afb18,_0x5afb18+_0x9f2375));}return _0x4e1485;}const _0x8eaedc=_0x58a632(_0x3ab084,_0x3372c6);let _0x10205f='';return _0x8eaedc[_0x384f24(0x276)]((_0x5ee1ab,_0x5361fb)=>{const _0x21f1c2=_0x384f24;_0x5361fb>0x0&&(_0x10205f+=_0x21f1c2(0x261));_0x10205f+='<table>',_0x10205f+='<thead>',_0x10205f+='<tr>',_0x10205f+=_0x21f1c2(0x33d),_0x10205f+='</tr>',_0x10205f+=_0x21f1c2(0x201),_0x10205f+=_0x21f1c2(0x213);for(let _0x5c262c=0x0;_0x5c262c<=_0x58145c[_0x21f1c2(0x321)]-0x1;_0x5c262c++){const _0x3bac44=_0x58145c[_0x5c262c];for(let _0x304433=0x0;_0x304433<_0x1f2f77[_0x21f1c2(0x321)];_0x304433++){const _0xc5fe5f=_0x1f2f77[_0x304433];_0xc5fe5f['_id']===_0x3bac44['_id'][_0x21f1c2(0x2b6)]&&(_0x10205f+=_0x21f1c2(0x27e)+_0xc5fe5f[_0x21f1c2(0x327)]+_0x21f1c2(0x264)+_0x3bac44[_0x21f1c2(0x226)][_0x21f1c2(0x2b6)]+'</td>');}}_0x10205f+=_0x21f1c2(0x298),_0x10205f+=_0x21f1c2(0x2cd),_0x10205f+=_0x21f1c2(0x201),_0x10205f+=_0x21f1c2(0x2ba),_0x10205f+=_0x21f1c2(0x1f5),_0x10205f+=_0x21f1c2(0x2dc);for(let _0x142916=0x0;_0x142916<=_0x58145c[_0x21f1c2(0x321)]-0x1;_0x142916++){const _0xf14c4c=_0x58145c[_0x142916];for(let _0x59834d=0x0;_0x59834d<_0xa7c765[_0x21f1c2(0x2bf)][_0x21f1c2(0x321)];_0x59834d++){const _0x3052fe=_0xa7c765[_0x21f1c2(0x2bf)][_0x59834d];_0x3052fe[_0x21f1c2(0x226)][_0x21f1c2(0x2b6)]===_0xf14c4c[_0x21f1c2(0x226)][_0x21f1c2(0x2b6)]&&(_0x10205f+='<td\x20class=\x22cat_data\x22>'+_0x3052fe[_0x21f1c2(0x226)]['brand']+_0x21f1c2(0x208));}}_0x10205f+=_0x21f1c2(0x21d),_0x10205f+=_0x21f1c2(0x1bc),_0x10205f+=_0x21f1c2(0x2a1),_0x10205f+=_0x21f1c2(0x28d),_0x10205f+=_0x21f1c2(0x2cd),_0x10205f+=_0x21f1c2(0x233),_0x10205f+=_0x21f1c2(0x31d),_0x5ee1ab[_0x21f1c2(0x276)](_0x37fc00=>{_0x10205f+=_0x37fc00;}),_0x10205f+=_0x21f1c2(0x310),_0x10205f+=_0x21f1c2(0x230);}),_0x10205f;}async function agentsdataDSICheck_admin_excel(_0x3cd378,_0x4a4771,_0x408d5f,_0x5be160){const _0x205a42=a0_0x4a8536,_0x145bdb=await product[_0x205a42(0x228)]([{'$group':{'_id':{'brand':_0x205a42(0x1e6),'category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3ccb33=[];_0x3ccb33[_0x205a42(0x2bf)]=[];for(let _0x2d877b=0x0;_0x2d877b<=_0x145bdb[_0x205a42(0x321)]-0x1;_0x2d877b++){const _0x1793b3=_0x145bdb[_0x2d877b];_0x3ccb33[_0x205a42(0x2bf)][_0x205a42(0x205)](_0x1793b3);}const _0x1ad441=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x205a42(0x1e6),'product_code':_0x205a42(0x2b8),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x3f4d66=await product[_0x205a42(0x228)]([{'$group':{'_id':{'category':'$category','brand':_0x205a42(0x1e6)}}},{'$group':{'_id':_0x205a42(0x229),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x21c998=await sales_sa[_0x205a42(0x228)]([{'$match':{'date':{'$gte':_0x3cd378,'$lte':_0x4a4771},'sales_staff_id':_0x408d5f,'sale_product.isFG':'false'}},{'$unwind':_0x205a42(0x2df)},{'$match':{'sale_product.isFG':_0x205a42(0x1fe)}},{'$lookup':{'from':'products','localField':_0x205a42(0x1f4),'foreignField':_0x205a42(0x280),'as':_0x205a42(0x246)}},{'$unwind':_0x205a42(0x33e)},{'$group':{'_id':{'dsi':_0x205a42(0x248),'date':'$date','customer':_0x205a42(0x2e7)},'totalQty':{'$sum':_0x205a42(0x2ae)},'products':{'$push':{'qty':_0x205a42(0x2ae),'NetPrice':_0x205a42(0x2f1),'discount':_0x205a42(0x2b1),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x205a42(0x1c0),'product_code':_0x205a42(0x278),'category':'$product_info.category','brand':'$product_info.brand','gross_price':_0x205a42(0x240)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x205a42(0x269),'customer':_0x205a42(0x2eb),'category':_0x205a42(0x32b),'brand':_0x205a42(0x29f)},'totalQty':{'$sum':_0x205a42(0x2e8)},'totalGross':{'$sum':{'$multiply':[_0x205a42(0x2e8),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x205a42(0x2d5)},'discount':{'$sum':_0x205a42(0x267)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x205a42(0x1e4)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x205a42(0x269),'customer':_0x205a42(0x2eb)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x205a42(0x2fe)},'NetPrice':{'$sum':_0x205a42(0x20c)},'discount':{'$sum':_0x205a42(0x252)},'adj_discount':{'$sum':_0x205a42(0x2d1)},'products':{'$push':{'qty':_0x205a42(0x22f),'category':_0x205a42(0x229),'brand':_0x205a42(0x28b),'product_details':_0x205a42(0x311)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x5e27ff=[],_0x4c6563={},_0x587e9a={},_0x564622={};var _0x46d9d4=0x0,_0x281776=0x0,_0x379bb2=0x0,_0x51e2fa=0x0,_0x734c65=0x0;const _0x508fc3=0x16345785d8a0000;for(let _0x2581f8=0x0;_0x2581f8<=_0x21c998[_0x205a42(0x321)]-0x1;_0x2581f8++){const _0x44b754=_0x21c998[_0x2581f8];let _0x5ca9e4=_0x205a42(0x201);_0x5ca9e4+=_0x205a42(0x217)+_0x44b754[_0x205a42(0x226)]['dsi']+_0x205a42(0x208),_0x5ca9e4+=_0x205a42(0x217)+_0x44b754['_id'][_0x205a42(0x2c5)]+_0x205a42(0x208),_0x5ca9e4+=_0x205a42(0x217)+_0x44b754[_0x205a42(0x226)][_0x205a42(0x282)]+_0x205a42(0x208);let _0xa69345={};var _0x117c6e=0x0;for(let _0x2a6bf5=0x0;_0x2a6bf5<=_0x44b754['products'][_0x205a42(0x321)]-0x1;_0x2a6bf5++){const _0x4ce072=_0x44b754[_0x205a42(0x26e)][_0x2a6bf5];_0xa69345[_0x4ce072[_0x205a42(0x1bd)]+'-'+_0x4ce072[_0x205a42(0x2b6)]]=_0x4ce072[_0x205a42(0x2ad)];const _0x49ee94=_0x4ce072[_0x205a42(0x1bd)]+'-'+_0x4ce072[_0x205a42(0x2b6)];!_0x4c6563[_0x49ee94]&&(_0x4c6563[_0x49ee94]=0x0),!Array[_0x205a42(0x1bb)](_0x564622[_0x49ee94])&&(_0x564622[_0x49ee94]=[]),!Array[_0x205a42(0x1bb)](_0x564622[_0x49ee94])&&(_0x564622[_0x49ee94]=[]),_0x4c6563[_0x49ee94]+=_0x4ce072[_0x205a42(0x2ad)],_0x564622[_0x49ee94][_0x205a42(0x205)](_0x4ce072[_0x205a42(0x2ad)]),_0x117c6e++;}for(let _0x8a41cd=0x0;_0x8a41cd<=_0x3ccb33[_0x205a42(0x2bf)][_0x205a42(0x321)]-0x1;_0x8a41cd++){const _0x35df31=_0x3ccb33[_0x205a42(0x2bf)][_0x8a41cd],_0x117f31=_0x35df31[_0x205a42(0x226)][_0x205a42(0x1bd)]+'-'+_0x35df31[_0x205a42(0x226)][_0x205a42(0x2b6)];_0x5ca9e4+=_0x205a42(0x2d6)+(_0xa69345[_0x117f31]!==undefined?_0xa69345[_0x117f31][_0x205a42(0x2c4)](0x2):'')+_0x205a42(0x208);}_0x379bb2=_0x44b754['discount']+_0x44b754[_0x205a42(0x1cf)],_0x5ca9e4+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x44b754['totalQty'],0x2)[_0x205a42(0x2c4)](0x2))+_0x205a42(0x208),_0x5ca9e4+=_0x205a42(0x283)+formatNumber(_0x44b754[_0x205a42(0x29c)][_0x205a42(0x2c4)](0x2))+_0x205a42(0x208),_0x5ca9e4+=_0x205a42(0x283)+formatNumber(_0x379bb2)+'</td>',_0x5ca9e4+=_0x205a42(0x283)+formatNumber(_0x44b754['NetPrice'][_0x205a42(0x2c4)](0x2))+_0x205a42(0x208),_0x5ca9e4+=_0x205a42(0x2cd),_0x46d9d4+=parseFloat(_0x44b754[_0x205a42(0x2cb)]),_0x281776+=parseFloat(_0x44b754[_0x205a42(0x25c)][_0x205a42(0x2c4)](0x2)),_0x51e2fa+=_0x379bb2,_0x734c65+=parseFloat(_0x44b754[_0x205a42(0x29c)]['toFixed'](0x2));if(_0x2581f8==_0x21c998[_0x205a42(0x321)]-0x1){_0x5ca9e4+=_0x205a42(0x201),_0x5ca9e4+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x5ca9e4+=_0x205a42(0x208);for(let _0x3218ab=0x0;_0x3218ab<=_0x3ccb33[_0x205a42(0x2bf)][_0x205a42(0x321)]-0x1;_0x3218ab++){const _0x11971d=_0x3ccb33['cat_brand'][_0x3218ab],_0x4e80b2=_0x11971d[_0x205a42(0x226)][_0x205a42(0x1bd)]+'-'+_0x11971d['_id'][_0x205a42(0x2b6)];!_0x564622[_0x4e80b2]&&(_0x564622[_0x4e80b2]=[]);const _0xdec9a8=_0x564622[_0x4e80b2][_0x205a42(0x32e)]((_0x569a0e,_0x120305)=>_0x569a0e+_0x120305,0x0);_0x5ca9e4+=_0x205a42(0x1fa)+(_0xdec9a8!==undefined?formatNumber(_0xdec9a8[_0x205a42(0x2c4)](0x2)):'')+'</b></td>';}_0x5ca9e4+=_0x205a42(0x304)+formatNumber(_0x46d9d4)+_0x205a42(0x221),_0x5ca9e4+=_0x205a42(0x304)+formatNumber(_0x734c65)+'</b></td>',_0x5ca9e4+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x51e2fa)+_0x205a42(0x221),_0x5ca9e4+=_0x205a42(0x304)+formatNumber(_0x281776)+_0x205a42(0x221),_0x5ca9e4+=_0x205a42(0x2cd);}_0x5e27ff[_0x205a42(0x205)](_0x5ca9e4);}function _0x736e4b(_0x886c00,_0x7e459b){const _0x3a955a=_0x205a42,_0xf76377=[];for(let _0x143d86=0x0;_0x143d86<=_0x886c00['length']-0x1;_0x143d86+=_0x7e459b){_0xf76377[_0x3a955a(0x205)](_0x886c00[_0x3a955a(0x2c8)](_0x143d86,_0x143d86+_0x7e459b));}return _0xf76377;}const _0x3cb392=_0x736e4b(_0x5e27ff,_0x508fc3);let _0x5729a0='';return _0x3cb392[_0x205a42(0x276)]((_0x404048,_0x5dc443)=>{const _0x15e753=_0x205a42;_0x5dc443>0x0&&(_0x5729a0+=_0x15e753(0x261));_0x5729a0+='<table>',_0x5729a0+='<thead>',_0x5729a0+='<tr>',_0x5729a0+=_0x15e753(0x33d),_0x5729a0+=_0x15e753(0x2cd),_0x5729a0+=_0x15e753(0x201),_0x5729a0+=_0x15e753(0x213);for(let _0x2b1232=0x0;_0x2b1232<=_0x1ad441[_0x15e753(0x321)]-0x1;_0x2b1232++){const _0x5ab7ed=_0x1ad441[_0x2b1232];for(let _0x54b29b=0x0;_0x54b29b<_0x3f4d66[_0x15e753(0x321)];_0x54b29b++){const _0x2c767e=_0x3f4d66[_0x54b29b];_0x2c767e[_0x15e753(0x226)]===_0x5ab7ed['_id'][_0x15e753(0x2b6)]&&(_0x5729a0+='<td\x20colspan=\x22'+_0x2c767e['brandCount']+_0x15e753(0x264)+_0x5ab7ed[_0x15e753(0x226)]['category']+_0x15e753(0x208));}}_0x5729a0+=_0x15e753(0x298),_0x5729a0+=_0x15e753(0x2cd),_0x5729a0+=_0x15e753(0x201),_0x5729a0+=_0x15e753(0x2ba),_0x5729a0+=_0x15e753(0x1f5),_0x5729a0+=_0x15e753(0x2dc);for(let _0x596b23=0x0;_0x596b23<=_0x1ad441[_0x15e753(0x321)]-0x1;_0x596b23++){const _0x4c8e5a=_0x1ad441[_0x596b23];for(let _0xfcbad0=0x0;_0xfcbad0<_0x3ccb33[_0x15e753(0x2bf)]['length'];_0xfcbad0++){const _0x35dc17=_0x3ccb33[_0x15e753(0x2bf)][_0xfcbad0];_0x35dc17[_0x15e753(0x226)][_0x15e753(0x2b6)]===_0x4c8e5a['_id'][_0x15e753(0x2b6)]&&(_0x5729a0+=_0x15e753(0x277)+_0x35dc17[_0x15e753(0x226)][_0x15e753(0x1bd)]+_0x15e753(0x208));}}_0x5729a0+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x5729a0+=_0x15e753(0x1bc),_0x5729a0+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x5729a0+=_0x15e753(0x28d),_0x5729a0+=_0x15e753(0x2cd),_0x5729a0+='</thead>',_0x5729a0+=_0x15e753(0x31d),_0x404048['forEach'](_0x31310f=>{_0x5729a0+=_0x31310f;}),_0x5729a0+=_0x15e753(0x310),_0x5729a0+=_0x15e753(0x230);}),_0x5729a0;}function a0_0x2e1a(_0x87c028,_0x1be16e){const _0x26c3c1=a0_0x26c3();return a0_0x2e1a=function(_0x2e1abd,_0x28a853){_0x2e1abd=_0x2e1abd-0x1b7;let _0x3611d6=_0x26c3c1[_0x2e1abd];return _0x3611d6;},a0_0x2e1a(_0x87c028,_0x1be16e);}router['post']('/agent_reports/pdf_admin',auth,async(_0x5b1377,_0x7af207)=>{const _0x1d93b7=a0_0x4a8536,{from_date:_0x3a0475,to_date:_0x21c10a,isExcel:_0xc5ba68,agent_id:_0x216b07}=_0x5b1377[_0x1d93b7(0x308)],_0x15f9ca=_0x5b1377[_0x1d93b7(0x1d7)],_0x2f5f06=await staff[_0x1d93b7(0x1be)]({'email':_0x15f9ca[_0x1d93b7(0x28c)]}),_0x31b560=await master_shop['find'](),_0x7cd7af=await agentsdataDSICheck_admin(_0x3a0475,_0x21c10a,_0x216b07,_0xc5ba68),_0xe976b9=await agentsdataDSICheck_admin_excel(_0x3a0475,_0x21c10a,_0x216b07,_0xc5ba68);let _0x380188='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x4f0638=new Date(_0x3a0475),_0x3b6cb4=new Date(_0x21c10a);const _0x1be21a={'year':_0x1d93b7(0x234),'month':_0x1d93b7(0x295),'day':_0x1d93b7(0x234)},_0x43df1b=new Intl[(_0x1d93b7(0x1c5))](_0x1d93b7(0x2bd),_0x1be21a)[_0x1d93b7(0x1e2)](_0x4f0638),_0x190ef7=new Intl[(_0x1d93b7(0x1c5))](_0x1d93b7(0x2bd),_0x1be21a)[_0x1d93b7(0x1e2)](_0x3b6cb4);_0x380188+=_0x1d93b7(0x238),_0x380188+=_0x1d93b7(0x1b7),_0x380188+=_0x1d93b7(0x2be),_0x380188+=_0x7cd7af,_0x380188+=_0x1d93b7(0x230),_0x380188+='</div>',_0x380188+=_0x1d93b7(0x285);let _0x35a6e5='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x35a6e5+=_0x1d93b7(0x238),_0x35a6e5+=_0x1d93b7(0x1b7),_0x35a6e5+=_0x1d93b7(0x2be),_0x35a6e5+=_0xe976b9,_0x35a6e5+=_0x1d93b7(0x230),_0x35a6e5+='</div>',_0x35a6e5+='</div>';let _0x4cf6e8=_0x1d93b7(0x243);const _0x550698={'width':_0x1d93b7(0x271),'height':'8.5in','orientation':_0x1d93b7(0x294),'border':{'top':'0.1in','right':_0x1d93b7(0x29d),'bottom':_0x1d93b7(0x29d),'left':_0x1d93b7(0x29d)},'header':{'height':'60mm','contents':_0x1d93b7(0x1d9)+_0x4cf6e8+_0x1d93b7(0x22b)+_0x43df1b+_0x1d93b7(0x22e)+_0x190ef7+_0x1d93b7(0x211)},'footer':{'height':'20mm','contents':{'default':_0x1d93b7(0x1ea)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x1d93b7(0x24d)}}};if(_0xc5ba68=='on'){const _0x49dfe3=cheerio[_0x1d93b7(0x31e)](_0x35a6e5);let _0x310e0d=[],_0xb610d7=[],_0x5f0219=[];_0x49dfe3('table\x20tr')[_0x1d93b7(0x22a)]((_0x52ff00,_0x2a98a9)=>{const _0x91b4f9=_0x1d93b7;let _0x23a39f=[],_0x3be10e=0x0;while(_0x5f0219[_0x3be10e]){_0x5f0219[_0x3be10e]--,_0x3be10e++;}_0x49dfe3(_0x2a98a9)[_0x91b4f9(0x203)](_0x91b4f9(0x2ca))[_0x91b4f9(0x22a)]((_0x203591,_0x52e749)=>{const _0x5a4a36=_0x91b4f9;let _0xe9e7a5=_0x49dfe3(_0x52e749)['text']()[_0x5a4a36(0x24a)](),_0x2d3327=parseFloat(_0xe9e7a5[_0x5a4a36(0x263)](/,/g,''));isNaN(_0x2d3327)&&(_0x2d3327=_0xe9e7a5);let _0x39a3bc=parseInt(_0x49dfe3(_0x52e749)['attr'](_0x5a4a36(0x26b)))||0x1,_0x441e2e=parseInt(_0x49dfe3(_0x52e749)[_0x5a4a36(0x317)](_0x5a4a36(0x1b8)))||0x1;_0x23a39f[_0x3be10e]=_0x2d3327;(_0x39a3bc>0x1||_0x441e2e>0x1)&&_0xb610d7[_0x5a4a36(0x205)]({'s':{'r':_0x52ff00,'c':_0x3be10e},'e':{'r':_0x52ff00+_0x441e2e-0x1,'c':_0x3be10e+_0x39a3bc-0x1}});for(let _0x1e604c=0x0;_0x1e604c<_0x39a3bc;_0x1e604c++){_0x441e2e>0x1&&(_0x5f0219[_0x3be10e+_0x1e604c]=_0x441e2e-0x1);}_0x3be10e+=_0x39a3bc;}),_0x310e0d[_0x91b4f9(0x205)](_0x23a39f);});const _0x1c21c0=XLSX[_0x1d93b7(0x2ce)][_0x1d93b7(0x225)](),_0x6afd31=XLSX['utils']['aoa_to_sheet'](_0x310e0d);_0xb610d7['length']>0x0&&(_0x6afd31[_0x1d93b7(0x242)]=_0xb610d7);_0x6afd31[_0x1d93b7(0x1f2)]=_0x310e0d[0x0][_0x1d93b7(0x232)](()=>({'wpx':0x64})),XLSX['utils'][_0x1d93b7(0x292)](_0x1c21c0,_0x6afd31,'Sales\x20Report');const _0x15595b=XLSX[_0x1d93b7(0x331)](_0x1c21c0,{'bookType':_0x1d93b7(0x1f3),'type':_0x1d93b7(0x2b5)});_0x7af207[_0x1d93b7(0x2a2)](_0x1d93b7(0x281),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x7af207['setHeader'](_0x1d93b7(0x312),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x7af207['send'](_0x15595b);}else pdf[_0x1d93b7(0x1e5)](_0x380188,_0x550698)[_0x1d93b7(0x2a4)](function(_0x53644d,_0x1f6b37){const _0x1c9484=_0x1d93b7;if(_0x53644d){_0x7af207[_0x1c9484(0x2d8)](0x1f4)[_0x1c9484(0x223)](_0x1c9484(0x219));return;}_0x7af207[_0x1c9484(0x2a2)](_0x1c9484(0x312),_0x1c9484(0x338)),_0x1f6b37[_0x1c9484(0x1bf)](_0x7af207);});}),router['get']('/agent_reports/view',auth,async(_0x5b97b7,_0x27292e)=>{const _0x3b1491=a0_0x4a8536;try{const {username:_0xefc8fa,email:_0xf8f1aa,role:_0x21bb33}=_0x5b97b7[_0x3b1491(0x1d7)],_0x18d5e0=_0x5b97b7[_0x3b1491(0x1d7)],_0x2c119b=await profile[_0x3b1491(0x1be)]({'email':_0x18d5e0[_0x3b1491(0x28c)]}),_0x427117={'year':_0x3b1491(0x234),'month':_0x3b1491(0x295),'day':'numeric'},_0x197c9a=await master_shop[_0x3b1491(0x203)](),_0xcba734=await staff[_0x3b1491(0x1be)]({'email':_0x18d5e0[_0x3b1491(0x28c)]}),_0x3e6a56=await product[_0x3b1491(0x203)](),_0x8ae2ae=await warehouse[_0x3b1491(0x228)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x3b1491(0x26e),'localField':_0x3b1491(0x27c),'foreignField':_0x3b1491(0x30b),'as':_0x3b1491(0x2a0)}},{'$unwind':_0x3b1491(0x249)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x3b1491(0x2d2)}},{'$group':{'_id':_0x3b1491(0x1d1),'product_stock':{'$sum':_0x3b1491(0x24e)}}}]);if(_0x197c9a[0x0][_0x3b1491(0x33a)]==_0x3b1491(0x23b))var _0x467fdc=users[_0x3b1491(0x1f8)];else{if(_0x197c9a[0x0][_0x3b1491(0x33a)]=='Hindi')var _0x467fdc=users['Hindi'];else{if(_0x197c9a[0x0]['language']==_0x3b1491(0x279))var _0x467fdc=users[_0x3b1491(0x279)];else{if(_0x197c9a[0x0]['language']==_0x3b1491(0x2ff))var _0x467fdc=users[_0x3b1491(0x2ff)];else{if(_0x197c9a[0x0]['language']==_0x3b1491(0x284))var _0x467fdc=users[_0x3b1491(0x284)];else{if(_0x197c9a[0x0]['language']==_0x3b1491(0x31b))var _0x467fdc=users['Portuguese'];else{if(_0x197c9a[0x0][_0x3b1491(0x33a)]=='Chinese')var _0x467fdc=users[_0x3b1491(0x2f3)];else{if(_0x197c9a[0x0][_0x3b1491(0x33a)]==_0x3b1491(0x288))var _0x467fdc=users[_0x3b1491(0x1ba)];}}}}}}}_0x27292e[_0x3b1491(0x251)](_0x3b1491(0x239),{'success':_0x5b97b7['flash'](_0x3b1491(0x32d)),'errors':_0x5b97b7[_0x3b1491(0x1f7)](_0x3b1491(0x340)),'alldata':_0x3e6a56,'profile':_0x2c119b,'master_shop':_0x197c9a,'role':_0x18d5e0,'product_stock':_0x8ae2ae,'language':_0x467fdc,'staff_arr':_0xcba734});}catch(_0x2bd052){}});function formatNumber(_0x441c85,_0x3c9ff6=a0_0x4a8536(0x2bd),_0x3e46a7={'minimumFractionDigits':0x2}){const _0x1219d0=a0_0x4a8536,_0x35292a=new Intl[(_0x1219d0(0x297))](_0x3c9ff6,_0x3e46a7);return _0x35292a[_0x1219d0(0x1e2)](_0x441c85);}async function agentsdataDSICheck(_0x1906e1,_0x5de9df,_0x3a6bff,_0x55d53d){const _0x4650f7=a0_0x4a8536,_0x33d042=await product[_0x4650f7(0x228)]([{'$group':{'_id':{'brand':'$brand','category':_0x4650f7(0x21c)},'products':{'$push':{'name':'$name','product_code':_0x4650f7(0x2b8)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x39aad3=[];_0x39aad3[_0x4650f7(0x2bf)]=[];for(let _0x127e94=0x0;_0x127e94<=_0x33d042[_0x4650f7(0x321)]-0x1;_0x127e94++){const _0x264b32=_0x33d042[_0x127e94];_0x39aad3[_0x4650f7(0x2bf)][_0x4650f7(0x205)](_0x264b32);}const _0x39e2b5=await product[_0x4650f7(0x228)]([{'$group':{'_id':{'category':_0x4650f7(0x21c)},'products':{'$push':{'brand':_0x4650f7(0x1e6),'product_code':'$product_code','product_name':_0x4650f7(0x296)}}}},{'$sort':{'_id.category':-0x1}}]),_0x279b75=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0x4650f7(0x1e6)}}},{'$group':{'_id':_0x4650f7(0x229),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x414601=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x1906e1,'$lte':_0x5de9df},'sales_staff_id':_0x3a6bff,'sale_product.isFG':_0x4650f7(0x1fe),'status_data':_0x4650f7(0x1fe)}},{'$unwind':_0x4650f7(0x2df)},{'$match':{'sale_product.isFG':_0x4650f7(0x1fe)}},{'$lookup':{'from':'products','localField':_0x4650f7(0x1f4),'foreignField':_0x4650f7(0x280),'as':_0x4650f7(0x246)}},{'$unwind':_0x4650f7(0x33e)},{'$group':{'_id':{'dsi':_0x4650f7(0x248),'date':_0x4650f7(0x21f),'customer':_0x4650f7(0x2e7)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x4650f7(0x2ae),'NetPrice':_0x4650f7(0x2f1),'discount':_0x4650f7(0x2b1),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x4650f7(0x1c0),'product_code':_0x4650f7(0x278),'category':_0x4650f7(0x23c),'brand':_0x4650f7(0x231),'gross_price':_0x4650f7(0x240)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x4650f7(0x30a),'date':_0x4650f7(0x269),'customer':_0x4650f7(0x2eb),'category':_0x4650f7(0x32b),'brand':_0x4650f7(0x29f)},'totalQty':{'$sum':_0x4650f7(0x2e8)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x4650f7(0x1c4)]}},'NetPrice':{'$sum':_0x4650f7(0x2d5)},'discount':{'$sum':_0x4650f7(0x267)},'adj_discount':{'$sum':_0x4650f7(0x2c7)},'product_details':{'$first':_0x4650f7(0x1e4)}}},{'$group':{'_id':{'dsi':_0x4650f7(0x30a),'date':_0x4650f7(0x269),'customer':'$_id.customer'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x4650f7(0x2fe)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x4650f7(0x252)},'adj_discount':{'$sum':_0x4650f7(0x2d1)},'products':{'$push':{'qty':_0x4650f7(0x22f),'category':_0x4650f7(0x229),'brand':'$_id.brand','product_details':_0x4650f7(0x311)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x156e5c=[],_0x1654b8={},_0x5584c9={},_0x58cc3f={};var _0x34c494=0x0,_0x11d727=0x0,_0x142b71=0x0,_0x3b7c4e=0x0,_0x38e228=0x0;const _0x407d55=0x6;for(let _0x4c8af8=0x0;_0x4c8af8<=_0x414601['length']-0x1;_0x4c8af8++){const _0x206294=_0x414601[_0x4c8af8];let _0x4a7615=_0x4650f7(0x201);_0x4a7615+=_0x4650f7(0x217)+_0x206294['_id'][_0x4650f7(0x2f5)]+_0x4650f7(0x208),_0x4a7615+=_0x4650f7(0x217)+_0x206294['_id'][_0x4650f7(0x2c5)]+_0x4650f7(0x208),_0x4a7615+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x206294[_0x4650f7(0x226)][_0x4650f7(0x282)]+_0x4650f7(0x208);let _0x1dcb08={};var _0x40dc30=0x0;for(let _0x444a07=0x0;_0x444a07<=_0x206294[_0x4650f7(0x26e)]['length']-0x1;_0x444a07++){const _0x28550d=_0x206294[_0x4650f7(0x26e)][_0x444a07];_0x1dcb08[_0x28550d[_0x4650f7(0x1bd)]+'-'+_0x28550d[_0x4650f7(0x2b6)]]=_0x28550d[_0x4650f7(0x2ad)];const _0x44fd4a=_0x28550d['brand']+'-'+_0x28550d['category'];!_0x1654b8[_0x44fd4a]&&(_0x1654b8[_0x44fd4a]=0x0),!Array[_0x4650f7(0x1bb)](_0x58cc3f[_0x44fd4a])&&(_0x58cc3f[_0x44fd4a]=[]),!Array['isArray'](_0x58cc3f[_0x44fd4a])&&(_0x58cc3f[_0x44fd4a]=[]),_0x1654b8[_0x44fd4a]+=_0x28550d[_0x4650f7(0x2ad)],_0x58cc3f[_0x44fd4a]['push'](_0x28550d[_0x4650f7(0x2ad)]),_0x40dc30++;}for(let _0x4a8bce=0x0;_0x4a8bce<=_0x39aad3[_0x4650f7(0x2bf)][_0x4650f7(0x321)]-0x1;_0x4a8bce++){const _0x54faa5=_0x39aad3[_0x4650f7(0x2bf)][_0x4a8bce],_0xd5e1dd=_0x54faa5[_0x4650f7(0x226)][_0x4650f7(0x1bd)]+'-'+_0x54faa5['_id'][_0x4650f7(0x2b6)];_0x4a7615+=_0x4650f7(0x2d6)+(_0x1dcb08[_0xd5e1dd]!==undefined?_0x1dcb08[_0xd5e1dd][_0x4650f7(0x2c4)](0x2):'')+_0x4650f7(0x208);}_0x142b71=_0x206294[_0x4650f7(0x326)]+_0x206294[_0x4650f7(0x1cf)],_0x4a7615+=_0x4650f7(0x283)+formatNumber(parseFloat(_0x206294[_0x4650f7(0x2cb)],0x2)[_0x4650f7(0x2c4)](0x2))+_0x4650f7(0x208),_0x4a7615+=_0x4650f7(0x283)+formatNumber(_0x206294[_0x4650f7(0x29c)][_0x4650f7(0x2c4)](0x2))+'</td>',_0x4a7615+=_0x4650f7(0x283)+formatNumber(_0x142b71)+_0x4650f7(0x208),_0x4a7615+=_0x4650f7(0x283)+formatNumber(_0x206294[_0x4650f7(0x25c)][_0x4650f7(0x2c4)](0x2))+_0x4650f7(0x208),_0x4a7615+=_0x4650f7(0x2cd),_0x34c494+=parseFloat(_0x206294[_0x4650f7(0x2cb)]),_0x11d727+=parseFloat(_0x206294[_0x4650f7(0x25c)][_0x4650f7(0x2c4)](0x2)),_0x3b7c4e+=_0x142b71,_0x38e228+=parseFloat(_0x206294[_0x4650f7(0x29c)][_0x4650f7(0x2c4)](0x2));if(_0x4c8af8==_0x414601['length']-0x1){_0x4a7615+=_0x4650f7(0x201),_0x4a7615+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x4a7615+=_0x4650f7(0x208);for(let _0x563184=0x0;_0x563184<=_0x39aad3[_0x4650f7(0x2bf)][_0x4650f7(0x321)]-0x1;_0x563184++){const _0xea7659=_0x39aad3['cat_brand'][_0x563184],_0x517bae=_0xea7659[_0x4650f7(0x226)][_0x4650f7(0x1bd)]+'-'+_0xea7659[_0x4650f7(0x226)]['category'];!_0x58cc3f[_0x517bae]&&(_0x58cc3f[_0x517bae]=[]);const _0x30a723=_0x58cc3f[_0x517bae][_0x4650f7(0x32e)]((_0x5da1b9,_0x11e506)=>_0x5da1b9+_0x11e506,0x0);_0x4a7615+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x30a723!==undefined?formatNumber(_0x30a723[_0x4650f7(0x2c4)](0x2)):'')+'</b></td>';}_0x4a7615+=_0x4650f7(0x304)+formatNumber(_0x34c494[_0x4650f7(0x2c4)](0x2))+_0x4650f7(0x221),_0x4a7615+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x38e228)+_0x4650f7(0x221),_0x4a7615+=_0x4650f7(0x304)+formatNumber(_0x3b7c4e)+_0x4650f7(0x221),_0x4a7615+=_0x4650f7(0x304)+formatNumber(_0x11d727)+'</b></td>',_0x4a7615+=_0x4650f7(0x2cd);}console[_0x4650f7(0x241)](_0x4650f7(0x2c9),_0x34c494+'+='+parseFloat(_0x206294[_0x4650f7(0x2cb)])),_0x156e5c[_0x4650f7(0x205)](_0x4a7615);}function _0x2cef9f(_0x5a4151,_0x23d4e5){const _0x225ec0=_0x4650f7,_0x44a69e=[];for(let _0x2296f1=0x0;_0x2296f1<=_0x5a4151['length']-0x1;_0x2296f1+=_0x23d4e5){_0x44a69e[_0x225ec0(0x205)](_0x5a4151[_0x225ec0(0x2c8)](_0x2296f1,_0x2296f1+_0x23d4e5));}return _0x44a69e;}const _0x438a4a=_0x2cef9f(_0x156e5c,_0x407d55);let _0x5b4e14='';return _0x438a4a['forEach']((_0xa09e3d,_0x38edb0)=>{const _0x492e24=_0x4650f7;_0x38edb0>0x0&&(_0x5b4e14+=_0x492e24(0x261));_0x5b4e14+=_0x492e24(0x2be),_0x5b4e14+=_0x492e24(0x220),_0x5b4e14+=_0x492e24(0x201),_0x5b4e14+=_0x492e24(0x33d),_0x5b4e14+=_0x492e24(0x2cd),_0x5b4e14+='<tr>',_0x5b4e14+=_0x492e24(0x213);for(let _0x52a295=0x0;_0x52a295<=_0x39e2b5[_0x492e24(0x321)]-0x1;_0x52a295++){const _0x31f348=_0x39e2b5[_0x52a295];for(let _0x1ef515=0x0;_0x1ef515<_0x279b75[_0x492e24(0x321)];_0x1ef515++){const _0x76b48e=_0x279b75[_0x1ef515];_0x76b48e['_id']===_0x31f348['_id'][_0x492e24(0x2b6)]&&(_0x5b4e14+=_0x492e24(0x27e)+_0x76b48e[_0x492e24(0x327)]+_0x492e24(0x264)+_0x31f348[_0x492e24(0x226)]['category']+_0x492e24(0x208));}}_0x5b4e14+=_0x492e24(0x298),_0x5b4e14+=_0x492e24(0x2cd),_0x5b4e14+=_0x492e24(0x201),_0x5b4e14+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x5b4e14+=_0x492e24(0x1f5),_0x5b4e14+=_0x492e24(0x2dc);for(let _0x2863b8=0x0;_0x2863b8<=_0x39e2b5[_0x492e24(0x321)]-0x1;_0x2863b8++){const _0x85d6f0=_0x39e2b5[_0x2863b8];for(let _0x13813f=0x0;_0x13813f<_0x39aad3[_0x492e24(0x2bf)][_0x492e24(0x321)];_0x13813f++){const _0x3278f3=_0x39aad3[_0x492e24(0x2bf)][_0x13813f];_0x3278f3[_0x492e24(0x226)]['category']===_0x85d6f0[_0x492e24(0x226)]['category']&&(_0x5b4e14+=_0x492e24(0x277)+_0x3278f3[_0x492e24(0x226)][_0x492e24(0x1bd)]+_0x492e24(0x208));}}_0x5b4e14+=_0x492e24(0x21d),_0x5b4e14+=_0x492e24(0x1bc),_0x5b4e14+=_0x492e24(0x2a1),_0x5b4e14+=_0x492e24(0x28d),_0x5b4e14+='</tr>',_0x5b4e14+=_0x492e24(0x233),_0x5b4e14+=_0x492e24(0x31d),_0xa09e3d[_0x492e24(0x276)](_0x3b9b77=>{_0x5b4e14+=_0x3b9b77;}),_0x5b4e14+=_0x492e24(0x310),_0x5b4e14+=_0x492e24(0x230);}),_0x5b4e14;}async function agentsdataDSICheck_excel(_0x3bc21d,_0x424964,_0x37361b,_0x50b913){const _0x378cf8=a0_0x4a8536,_0x4c38a6=await product[_0x378cf8(0x228)]([{'$group':{'_id':{'brand':'$brand','category':_0x378cf8(0x21c)},'products':{'$push':{'name':_0x378cf8(0x296),'product_code':_0x378cf8(0x2b8)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3be2df=[];_0x3be2df[_0x378cf8(0x2bf)]=[];for(let _0x30f9fe=0x0;_0x30f9fe<=_0x4c38a6[_0x378cf8(0x321)]-0x1;_0x30f9fe++){const _0x1a295d=_0x4c38a6[_0x30f9fe];_0x3be2df[_0x378cf8(0x2bf)][_0x378cf8(0x205)](_0x1a295d);}const _0x5be8f7=await product[_0x378cf8(0x228)]([{'$group':{'_id':{'category':_0x378cf8(0x21c)},'products':{'$push':{'brand':_0x378cf8(0x1e6),'product_code':_0x378cf8(0x2b8),'product_name':_0x378cf8(0x296)}}}},{'$sort':{'_id.category':-0x1}}]),_0x167f8d=await product['aggregate']([{'$group':{'_id':{'category':_0x378cf8(0x21c),'brand':'$brand'}}},{'$group':{'_id':_0x378cf8(0x229),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x20f14a=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3bc21d,'$lte':_0x424964},'sales_staff_id':_0x37361b,'sale_product.isFG':_0x378cf8(0x1fe)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x378cf8(0x1fe)}},{'$lookup':{'from':_0x378cf8(0x26e),'localField':_0x378cf8(0x1f4),'foreignField':_0x378cf8(0x280),'as':_0x378cf8(0x246)}},{'$unwind':_0x378cf8(0x33e)},{'$group':{'_id':{'dsi':_0x378cf8(0x248),'date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x378cf8(0x2ae)},'products':{'$push':{'qty':_0x378cf8(0x2ae),'NetPrice':_0x378cf8(0x2f1),'discount':_0x378cf8(0x2b1),'adj_discount':_0x378cf8(0x2d3),'product_details':{'prod_name':'$product_info.name','product_code':_0x378cf8(0x278),'category':_0x378cf8(0x23c),'brand':_0x378cf8(0x231),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x378cf8(0x275)},{'$group':{'_id':{'dsi':_0x378cf8(0x30a),'date':'$_id.date','customer':_0x378cf8(0x2eb),'category':_0x378cf8(0x32b),'brand':_0x378cf8(0x29f)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x378cf8(0x1c4)]}},'NetPrice':{'$sum':_0x378cf8(0x2d5)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x378cf8(0x2c7)},'product_details':{'$first':_0x378cf8(0x1e4)}}},{'$group':{'_id':{'dsi':_0x378cf8(0x30a),'date':_0x378cf8(0x269),'customer':'$_id.customer'},'totalQty':{'$sum':_0x378cf8(0x22f)},'totalGross':{'$sum':_0x378cf8(0x2fe)},'NetPrice':{'$sum':_0x378cf8(0x20c)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x378cf8(0x22f),'category':_0x378cf8(0x229),'brand':_0x378cf8(0x28b),'product_details':_0x378cf8(0x311)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4bb6e6=[],_0x19674d={},_0x186343={},_0x1c6990={};var _0x1c3e88=0x0,_0x1b004f=0x0,_0x25b997=0x0,_0x35efbf=0x0,_0x291d25=0x0;const _0x237703=0x9184e72a000;for(let _0x2ae358=0x0;_0x2ae358<=_0x20f14a[_0x378cf8(0x321)]-0x1;_0x2ae358++){const _0x278c47=_0x20f14a[_0x2ae358];let _0x42d859=_0x378cf8(0x201);_0x42d859+=_0x378cf8(0x217)+_0x278c47[_0x378cf8(0x226)][_0x378cf8(0x2f5)]+'</td>',_0x42d859+=_0x378cf8(0x217)+_0x278c47['_id'][_0x378cf8(0x2c5)]+_0x378cf8(0x208),_0x42d859+=_0x378cf8(0x217)+_0x278c47[_0x378cf8(0x226)]['customer']+_0x378cf8(0x208);let _0x27eced={};var _0x3dfa1e=0x0;for(let _0x245237=0x0;_0x245237<=_0x278c47['products']['length']-0x1;_0x245237++){const _0x4f4e02=_0x278c47[_0x378cf8(0x26e)][_0x245237];_0x27eced[_0x4f4e02[_0x378cf8(0x1bd)]+'-'+_0x4f4e02['category']]=_0x4f4e02[_0x378cf8(0x2ad)];const _0x4f8d32=_0x4f4e02[_0x378cf8(0x1bd)]+'-'+_0x4f4e02[_0x378cf8(0x2b6)];!_0x19674d[_0x4f8d32]&&(_0x19674d[_0x4f8d32]=0x0),!Array[_0x378cf8(0x1bb)](_0x1c6990[_0x4f8d32])&&(_0x1c6990[_0x4f8d32]=[]),!Array[_0x378cf8(0x1bb)](_0x1c6990[_0x4f8d32])&&(_0x1c6990[_0x4f8d32]=[]),_0x19674d[_0x4f8d32]+=_0x4f4e02['qty'],_0x1c6990[_0x4f8d32][_0x378cf8(0x205)](_0x4f4e02[_0x378cf8(0x2ad)]),_0x3dfa1e++;}for(let _0x3eec62=0x0;_0x3eec62<=_0x3be2df[_0x378cf8(0x2bf)][_0x378cf8(0x321)]-0x1;_0x3eec62++){const _0x12fd61=_0x3be2df[_0x378cf8(0x2bf)][_0x3eec62],_0x390ed4=_0x12fd61[_0x378cf8(0x226)][_0x378cf8(0x1bd)]+'-'+_0x12fd61['_id'][_0x378cf8(0x2b6)];_0x42d859+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x27eced[_0x390ed4]!==undefined?_0x27eced[_0x390ed4]['toFixed'](0x2):'')+_0x378cf8(0x208);}_0x25b997=_0x278c47[_0x378cf8(0x326)]+_0x278c47['adj_discount'],_0x42d859+=_0x378cf8(0x283)+formatNumber(parseFloat(_0x278c47['totalQty'],0x2)[_0x378cf8(0x2c4)](0x2))+_0x378cf8(0x208),_0x42d859+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x278c47[_0x378cf8(0x29c)]['toFixed'](0x2))+_0x378cf8(0x208),_0x42d859+=_0x378cf8(0x283)+formatNumber(_0x25b997)+_0x378cf8(0x208),_0x42d859+=_0x378cf8(0x283)+formatNumber(_0x278c47[_0x378cf8(0x25c)][_0x378cf8(0x2c4)](0x2))+_0x378cf8(0x208),_0x42d859+=_0x378cf8(0x2cd),_0x1c3e88+=parseFloat(_0x278c47['totalQty']['toFixed'](0x2)),_0x1b004f+=parseFloat(_0x278c47[_0x378cf8(0x25c)][_0x378cf8(0x2c4)](0x2)),_0x35efbf+=_0x25b997,_0x291d25+=parseFloat(_0x278c47[_0x378cf8(0x29c)][_0x378cf8(0x2c4)](0x2));if(_0x2ae358==_0x20f14a[_0x378cf8(0x321)]-0x1){_0x42d859+=_0x378cf8(0x201),_0x42d859+=_0x378cf8(0x200),_0x42d859+=_0x378cf8(0x208);for(let _0x5a40db=0x0;_0x5a40db<=_0x3be2df['cat_brand']['length']-0x1;_0x5a40db++){const _0xdb1b72=_0x3be2df[_0x378cf8(0x2bf)][_0x5a40db],_0x109f18=_0xdb1b72[_0x378cf8(0x226)][_0x378cf8(0x1bd)]+'-'+_0xdb1b72[_0x378cf8(0x226)][_0x378cf8(0x2b6)];!_0x1c6990[_0x109f18]&&(_0x1c6990[_0x109f18]=[]);const _0x1299ff=_0x1c6990[_0x109f18][_0x378cf8(0x32e)]((_0x41dba4,_0x5f4303)=>_0x41dba4+_0x5f4303,0x0);_0x42d859+=_0x378cf8(0x1fa)+(_0x1299ff!==undefined?formatNumber(_0x1299ff[_0x378cf8(0x2c4)](0x2)):'')+'</b></td>';}_0x42d859+=_0x378cf8(0x304)+formatNumber(_0x1c3e88[_0x378cf8(0x2c4)](0x2))+_0x378cf8(0x221),_0x42d859+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x291d25)+_0x378cf8(0x221),_0x42d859+=_0x378cf8(0x304)+formatNumber(_0x35efbf)+_0x378cf8(0x221),_0x42d859+=_0x378cf8(0x304)+formatNumber(_0x1b004f)+_0x378cf8(0x221),_0x42d859+=_0x378cf8(0x2cd);}_0x4bb6e6['push'](_0x42d859);}function _0x38c59b(_0x4dbf33,_0x3528ba){const _0x3647d5=_0x378cf8,_0x162a99=[];for(let _0xd4de7=0x0;_0xd4de7<=_0x4dbf33[_0x3647d5(0x321)]-0x1;_0xd4de7+=_0x3528ba){_0x162a99[_0x3647d5(0x205)](_0x4dbf33[_0x3647d5(0x2c8)](_0xd4de7,_0xd4de7+_0x3528ba));}return _0x162a99;}const _0xed5613=_0x38c59b(_0x4bb6e6,_0x237703);let _0x10d2fa='';return _0xed5613['forEach']((_0x376301,_0x437eae)=>{const _0xcab8ac=_0x378cf8;_0x437eae>0x0&&(_0x10d2fa+=_0xcab8ac(0x261));_0x10d2fa+=_0xcab8ac(0x2be),_0x10d2fa+=_0xcab8ac(0x220),_0x10d2fa+=_0xcab8ac(0x201),_0x10d2fa+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x10d2fa+=_0xcab8ac(0x2cd),_0x10d2fa+='<tr>',_0x10d2fa+=_0xcab8ac(0x213);for(let _0x4c3300=0x0;_0x4c3300<=_0x5be8f7[_0xcab8ac(0x321)]-0x1;_0x4c3300++){const _0x2a7bd3=_0x5be8f7[_0x4c3300];for(let _0x453831=0x0;_0x453831<_0x167f8d[_0xcab8ac(0x321)];_0x453831++){const _0x4f555c=_0x167f8d[_0x453831];_0x4f555c[_0xcab8ac(0x226)]===_0x2a7bd3[_0xcab8ac(0x226)]['category']&&(_0x10d2fa+=_0xcab8ac(0x27e)+_0x4f555c[_0xcab8ac(0x327)]+'\x22\x20class=\x22cat_data\x22>'+_0x2a7bd3['_id']['category']+_0xcab8ac(0x208));}}_0x10d2fa+=_0xcab8ac(0x298),_0x10d2fa+=_0xcab8ac(0x2cd),_0x10d2fa+=_0xcab8ac(0x201),_0x10d2fa+=_0xcab8ac(0x2ba),_0x10d2fa+=_0xcab8ac(0x1f5),_0x10d2fa+=_0xcab8ac(0x2dc);for(let _0x5ed00e=0x0;_0x5ed00e<=_0x5be8f7[_0xcab8ac(0x321)]-0x1;_0x5ed00e++){const _0x376475=_0x5be8f7[_0x5ed00e];for(let _0x2f6a49=0x0;_0x2f6a49<_0x3be2df['cat_brand'][_0xcab8ac(0x321)];_0x2f6a49++){const _0x762dfc=_0x3be2df[_0xcab8ac(0x2bf)][_0x2f6a49];_0x762dfc[_0xcab8ac(0x226)][_0xcab8ac(0x2b6)]===_0x376475[_0xcab8ac(0x226)][_0xcab8ac(0x2b6)]&&(_0x10d2fa+=_0xcab8ac(0x277)+_0x762dfc['_id'][_0xcab8ac(0x1bd)]+_0xcab8ac(0x208));}}_0x10d2fa+=_0xcab8ac(0x21d),_0x10d2fa+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x10d2fa+=_0xcab8ac(0x2a1),_0x10d2fa+=_0xcab8ac(0x28d),_0x10d2fa+='</tr>',_0x10d2fa+=_0xcab8ac(0x233),_0x10d2fa+=_0xcab8ac(0x31d),_0x376301[_0xcab8ac(0x276)](_0x5c3f31=>{_0x10d2fa+=_0x5c3f31;}),console[_0xcab8ac(0x241)](_0x1c6990),_0x10d2fa+=_0xcab8ac(0x310),_0x10d2fa+=_0xcab8ac(0x230);}),_0x10d2fa;}router[a0_0x4a8536(0x265)](a0_0x4a8536(0x335),auth,async(_0x5eeeab,_0x4dcb13)=>{const _0x35beed=a0_0x4a8536,{from_date:_0x161f2c,to_date:_0x3b7daf,isExcel:_0x11888c}=_0x5eeeab[_0x35beed(0x308)],_0x3d66a6=_0x5eeeab[_0x35beed(0x1d7)],_0x180b2=await staff[_0x35beed(0x1be)]({'email':_0x3d66a6[_0x35beed(0x28c)]}),_0x47b2af=await master_shop[_0x35beed(0x203)](),_0x40336d=await agentsdataDSICheck(_0x161f2c,_0x3b7daf,_0x180b2['_id'][_0x35beed(0x2ab)](),_0x11888c),_0xfcbd4=await agentsdataDSICheck_excel(_0x161f2c,_0x3b7daf,_0x180b2['_id'][_0x35beed(0x2ab)](),_0x11888c);let _0x233dee='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x4025d7=new Date(_0x161f2c),_0x99a7c7=new Date(_0x3b7daf);const _0xf501d4={'year':'numeric','month':_0x35beed(0x295),'day':_0x35beed(0x234)},_0x4e0ba3=new Intl['DateTimeFormat'](_0x35beed(0x2bd),_0xf501d4)['format'](_0x4025d7),_0x3e474c=new Intl['DateTimeFormat'](_0x35beed(0x2bd),_0xf501d4)[_0x35beed(0x1e2)](_0x99a7c7);_0x233dee+='<div\x20class=\x22row\x22>',_0x233dee+=_0x35beed(0x1b7),_0x233dee+=_0x35beed(0x2be),_0x233dee+=_0x40336d,_0x233dee+=_0x35beed(0x230),_0x233dee+=_0x35beed(0x285),_0x233dee+=_0x35beed(0x285);let _0x1a2389=_0x35beed(0x29a);_0x1a2389+=_0x35beed(0x238),_0x1a2389+=_0x35beed(0x1b7),_0x1a2389+=_0x35beed(0x2be),_0x1a2389+=_0xfcbd4,_0x1a2389+='</table>',_0x1a2389+='</div>',_0x1a2389+=_0x35beed(0x285);let _0x3d397c=_0x35beed(0x243);const _0x48a5a9={'width':_0x35beed(0x271),'height':'8.5in','orientation':_0x35beed(0x294),'border':{'top':_0x35beed(0x29d),'right':_0x35beed(0x29d),'bottom':_0x35beed(0x29d),'left':'0.1in'},'header':{'height':_0x35beed(0x1d5),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3d397c+_0x35beed(0x22b)+_0x4e0ba3+_0x35beed(0x22e)+_0x3e474c+_0x35beed(0x211)},'footer':{'height':_0x35beed(0x2cc),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x35beed(0x24d)}}};if(_0x11888c=='on'){const _0x4806ea=cheerio[_0x35beed(0x31e)](_0x1a2389);let _0x59b906=[],_0x525405=[],_0x5311c2=[];const _0x2fb7f7=_0x3bdb29=>{const _0x53feaf=_0x35beed,_0x4a8354={'top':{'style':_0x53feaf(0x333),'color':{'rgb':_0x53feaf(0x224)}},'bottom':{'style':_0x53feaf(0x333),'color':{'rgb':_0x53feaf(0x224)}},'left':{'style':_0x53feaf(0x333),'color':{'rgb':_0x53feaf(0x224)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x3bdb29){const _0x5c447b=_0x3bdb29[_0x53feaf(0x253)](';')[_0x53feaf(0x32e)]((_0x234b8a,_0x46584a)=>{const _0x462b73=_0x53feaf,[_0x1b272f,_0xac1e76]=_0x46584a[_0x462b73(0x253)](':')[_0x462b73(0x232)](_0x16268e=>_0x16268e[_0x462b73(0x24a)]());return _0x234b8a[_0x1b272f]=_0xac1e76,_0x234b8a;},{});_0x5c447b['border-top']&&(_0x4a8354[_0x53feaf(0x330)][_0x53feaf(0x258)]=_0x5c447b['border-top'][_0x53feaf(0x1ee)](_0x53feaf(0x20e))?_0x53feaf(0x20e):_0x53feaf(0x255)),_0x5c447b['border-bottom']&&(_0x4a8354[_0x53feaf(0x332)][_0x53feaf(0x258)]=_0x5c447b[_0x53feaf(0x316)][_0x53feaf(0x1ee)]('thin')?_0x53feaf(0x20e):'medium'),_0x5c447b['border-left']&&(_0x4a8354[_0x53feaf(0x2f9)]['style']=_0x5c447b['border-left'][_0x53feaf(0x1ee)](_0x53feaf(0x20e))?_0x53feaf(0x20e):_0x53feaf(0x255)),_0x5c447b[_0x53feaf(0x32f)]&&(_0x4a8354[_0x53feaf(0x209)][_0x53feaf(0x258)]=_0x5c447b[_0x53feaf(0x32f)][_0x53feaf(0x1ee)](_0x53feaf(0x20e))?_0x53feaf(0x20e):_0x53feaf(0x255));}return _0x4a8354;};_0x4806ea('table\x20tr')['each']((_0x207d86,_0x2504a5)=>{const _0x439609=_0x35beed;let _0x5e5c79=[],_0x44fbbd=0x0;while(_0x5311c2[_0x44fbbd]){_0x5311c2[_0x44fbbd]--,_0x44fbbd++;}_0x4806ea(_0x2504a5)[_0x439609(0x203)](_0x439609(0x2ca))['each']((_0xb940e7,_0x790d71)=>{const _0x37e5f7=_0x439609;let _0x1def51=_0x4806ea(_0x790d71)[_0x37e5f7(0x23f)]()['trim'](),_0x1a7da7=parseFloat(_0x1def51['replace'](/,/g,'')),_0x43d987={};!isNaN(_0x1a7da7)?(_0x43d987['v']=_0x1a7da7,_0x43d987['t']='n'):(_0x43d987['v']=_0x1def51,_0x43d987['t']='s');const _0x307bc8=_0x4806ea(_0x790d71)[_0x37e5f7(0x317)](_0x37e5f7(0x258)),_0x4bb636=_0x2fb7f7(_0x307bc8);_0x43d987['s']={'border':_0x4bb636},_0x5e5c79[_0x44fbbd]=_0x43d987;let _0x2e7176=parseInt(_0x4806ea(_0x790d71)[_0x37e5f7(0x317)]('colspan'))||0x1,_0x528aa4=parseInt(_0x4806ea(_0x790d71)['attr']('rowspan'))||0x1;(_0x2e7176>0x1||_0x528aa4>0x1)&&_0x525405[_0x37e5f7(0x205)]({'s':{'r':_0x207d86,'c':_0x44fbbd},'e':{'r':_0x207d86+_0x528aa4-0x1,'c':_0x44fbbd+_0x2e7176-0x1}});for(let _0x1cbb72=0x0;_0x1cbb72<_0x2e7176;_0x1cbb72++){_0x528aa4>0x1&&(_0x5311c2[_0x44fbbd+_0x1cbb72]=_0x528aa4-0x1);}_0x44fbbd+=_0x2e7176;}),_0x59b906[_0x439609(0x205)](_0x5e5c79);});const _0x575771=XLSX[_0x35beed(0x2ce)][_0x35beed(0x225)](),_0x4d4d26=XLSX[_0x35beed(0x2ce)][_0x35beed(0x31c)](_0x59b906);_0x525405['length']>0x0&&(_0x4d4d26[_0x35beed(0x242)]=_0x525405);_0x4d4d26[_0x35beed(0x1f2)]=_0x59b906[0x0][_0x35beed(0x232)](()=>({'wpx':0x64})),XLSX[_0x35beed(0x2ce)][_0x35beed(0x292)](_0x575771,_0x4d4d26,_0x35beed(0x2af));const _0x1fc0ff=XLSX[_0x35beed(0x331)](_0x575771,{'bookType':_0x35beed(0x1f3),'type':_0x35beed(0x2b5)});_0x4dcb13[_0x35beed(0x2a2)](_0x35beed(0x281),_0x35beed(0x20f)),_0x4dcb13['setHeader']('Content-Type',_0x35beed(0x2fd)),_0x4dcb13[_0x35beed(0x223)](_0x1fc0ff);}else pdf['create'](_0x233dee,_0x48a5a9)[_0x35beed(0x2a4)](function(_0x3c23f4,_0x419be1){const _0x26b94c=_0x35beed;if(_0x3c23f4){console[_0x26b94c(0x2d7)](_0x26b94c(0x302),_0x3c23f4),_0x4dcb13[_0x26b94c(0x2d8)](0x1f4)['send']('Error\x20generating\x20PDF'+_0x3c23f4);return;}_0x4dcb13[_0x26b94c(0x2a2)](_0x26b94c(0x312),'application/pdf'),_0x419be1[_0x26b94c(0x1bf)](_0x4dcb13);});}),router[a0_0x4a8536(0x1de)](a0_0x4a8536(0x21e),auth,async(_0x47c0c5,_0x2ecc8b)=>{const _0x322bea=a0_0x4a8536;try{const {username:_0x2b9f36,email:_0x153c76,role:_0x2d4dbb}=_0x47c0c5[_0x322bea(0x1d7)],_0x455587=_0x47c0c5[_0x322bea(0x1d7)],_0x16e75b=await profile['findOne']({'email':_0x455587['email']}),_0x1d2272={'year':_0x322bea(0x234),'month':'long','day':_0x322bea(0x234)},_0x3eb519=await master_shop[_0x322bea(0x203)](),_0x1d26de=await product[_0x322bea(0x203)](),_0x55a357=await warehouse[_0x322bea(0x228)]([{'$unwind':_0x322bea(0x311)},{'$lookup':{'from':'products','localField':_0x322bea(0x27c),'foreignField':_0x322bea(0x30b),'as':_0x322bea(0x2a0)}},{'$unwind':_0x322bea(0x249)},{'$project':{'product_name':_0x322bea(0x20b),'product_stock':_0x322bea(0x2d2)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x322bea(0x24e)}}}]),_0x18502f=await staff[_0x322bea(0x1be)]({'email':_0x455587[_0x322bea(0x28c)]});if(_0x3eb519[0x0][_0x322bea(0x33a)]==_0x322bea(0x23b))var _0x472d80=users[_0x322bea(0x1f8)];else{if(_0x3eb519[0x0]['language']==_0x322bea(0x236))var _0x472d80=users[_0x322bea(0x236)];else{if(_0x3eb519[0x0][_0x322bea(0x33a)]==_0x322bea(0x279))var _0x472d80=users[_0x322bea(0x279)];else{if(_0x3eb519[0x0][_0x322bea(0x33a)]==_0x322bea(0x2ff))var _0x472d80=users['Spanish'];else{if(_0x3eb519[0x0][_0x322bea(0x33a)]==_0x322bea(0x284))var _0x472d80=users[_0x322bea(0x284)];else{if(_0x3eb519[0x0][_0x322bea(0x33a)]=='Portuguese\x20(BR)')var _0x472d80=users['Portuguese'];else{if(_0x3eb519[0x0]['language']==_0x322bea(0x2f3))var _0x472d80=users['Chinese'];else{if(_0x3eb519[0x0][_0x322bea(0x33a)]==_0x322bea(0x288))var _0x472d80=users[_0x322bea(0x1ba)];}}}}}}}_0x2ecc8b[_0x322bea(0x251)]('sales_reports',{'success':_0x47c0c5['flash'](_0x322bea(0x32d)),'errors':_0x47c0c5[_0x322bea(0x1f7)](_0x322bea(0x340)),'alldata':_0x1d26de,'profile':_0x16e75b,'master_shop':_0x3eb519,'role':_0x455587,'product_stock':_0x55a357,'language':_0x472d80,'staff_arr':_0x18502f});}catch(_0x47babb){}});async function dataSalesReports(_0x5f4a94,_0xe2b02,_0x3c8e63){const _0x236e52=a0_0x4a8536;let _0x19788e='';const _0x584df9=await sales_sa[_0x236e52(0x228)]([{'$match':{'date':{'$gte':_0x5f4a94,'$lte':_0xe2b02},'sales_staff_id':_0x3c8e63}},{'$unwind':_0x236e52(0x2df)},{'$match':{'sale_product.isFG':_0x236e52(0x1fe)}},{'$group':{'_id':{'product_name':_0x236e52(0x1fd),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x325b26=0x0,_0x1dede1=0x0;for(let _0x332d7a=0x0;_0x332d7a<=_0x584df9[_0x236e52(0x321)]-0x1;_0x332d7a++){const _0x3728db=_0x584df9[_0x332d7a];var _0x417c0a=_0x3728db['totalPrice']['toLocaleString'](undefined),_0x3d0b0a=_0x3728db['sumqty'][_0x236e52(0x254)](undefined);_0x19788e+='<tr>',_0x19788e+=_0x236e52(0x25a)+_0x3728db[_0x236e52(0x226)][_0x236e52(0x280)]+_0x236e52(0x208),_0x19788e+=_0x236e52(0x25a)+_0x3728db[_0x236e52(0x226)]['product_name']+_0x236e52(0x208),_0x19788e+=_0x236e52(0x25a)+formatNumber(_0x3728db[_0x236e52(0x30f)][_0x236e52(0x2c4)](0x2))+_0x236e52(0x208),_0x19788e+=_0x236e52(0x25a)+formatNumber(_0x3728db[_0x236e52(0x244)][_0x236e52(0x2c4)](0x2))+_0x236e52(0x208),_0x19788e+='</tr>',_0x325b26+=parseFloat(_0x3728db[_0x236e52(0x30f)]),_0x1dede1+=parseFloat(_0x3728db[_0x236e52(0x244)]);}var _0x4c5842=_0x1dede1['toLocaleString'](undefined),_0x1ca3be=_0x325b26['toLocaleString'](undefined);return _0x19788e+=_0x236e52(0x201),_0x19788e+=_0x236e52(0x21b),_0x19788e+=_0x236e52(0x247)+formatNumber(_0x325b26[_0x236e52(0x2c4)](0x2))+_0x236e52(0x221),_0x19788e+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x1dede1[_0x236e52(0x2c4)](0x2))+_0x236e52(0x221),_0x19788e+=_0x236e52(0x2cd),_0x19788e;}router[a0_0x4a8536(0x265)](a0_0x4a8536(0x27f),auth,async(_0x381e3a,_0x55af34)=>{const _0x354060=a0_0x4a8536;try{const {from_date:_0x297574,to_date:_0x3a017b,isExcel:_0xf56113}=_0x381e3a['body'],_0x18a38a=_0x381e3a[_0x354060(0x1d7)],_0x47e44e=await staff['findOne']({'email':_0x18a38a[_0x354060(0x28c)]});let _0x1ebafd=_0x354060(0x2dd);var _0x15b643=new Date(_0x297574),_0x1f0000=new Date(_0x3a017b);const _0x47cbd9={'year':_0x354060(0x234),'month':_0x354060(0x295),'day':_0x354060(0x234)},_0x39806d=new Intl['DateTimeFormat'](_0x354060(0x2bd),_0x47cbd9)[_0x354060(0x1e2)](_0x15b643),_0x4e2147=new Intl[(_0x354060(0x1c5))](_0x354060(0x2bd),_0x47cbd9)[_0x354060(0x1e2)](_0x1f0000);var _0x1e0af2=await dataSalesReports(_0x297574,_0x3a017b,_0x47e44e[_0x354060(0x226)][_0x354060(0x2ab)]());_0x1ebafd+='<div\x20class=\x22row\x22>',_0x1ebafd+=_0x354060(0x1cb),_0x1ebafd+=_0x354060(0x2be),_0x1ebafd+=_0x354060(0x201),_0x1ebafd+=_0x354060(0x28e),_0x1ebafd+=_0x354060(0x300),_0x1ebafd+=_0x354060(0x25b),_0x1ebafd+=_0x354060(0x2fb),_0x1ebafd+=_0x354060(0x201),_0x1ebafd+=_0x1e0af2,_0x1ebafd+=_0x354060(0x2cd),_0x1ebafd+='</div>',_0x1ebafd+=_0x354060(0x285);let _0x43b98d=_0x354060(0x243);const _0x45b6e5={'width':'15in','height':_0x354060(0x28a),'orientation':_0x354060(0x294),'border':{'top':_0x354060(0x29d),'right':_0x354060(0x29d),'bottom':_0x354060(0x29d),'left':_0x354060(0x29d)},'header':{'height':'60mm','contents':_0x354060(0x1d9)+_0x43b98d+_0x354060(0x272)+_0x47e44e[_0x354060(0x30b)]+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x39806d+'\x20-\x20'+_0x4e2147+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x354060(0x2cc),'contents':{'default':_0x354060(0x1ea)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x354060(0x24d)}}};if(_0xf56113=='on'){const _0x3afef0=cheerio[_0x354060(0x31e)](_0x1ebafd);let _0x443ad8=[],_0x4d4430=[],_0x2eaaf3=[];const _0x286ec1=_0x354eba=>{const _0x470e2c=_0x354060,_0x1ffdd0={'top':{'style':_0x470e2c(0x333),'color':{'rgb':_0x470e2c(0x224)}},'bottom':{'style':_0x470e2c(0x333),'color':{'rgb':_0x470e2c(0x224)}},'left':{'style':_0x470e2c(0x333),'color':{'rgb':_0x470e2c(0x224)}},'right':{'style':_0x470e2c(0x333),'color':{'rgb':_0x470e2c(0x224)}}};if(_0x354eba){const _0x210632=_0x354eba['split'](';')[_0x470e2c(0x32e)]((_0xcdf6b2,_0x5e1c6e)=>{const _0x26c6ff=_0x470e2c,[_0x8b4369,_0x2d605e]=_0x5e1c6e[_0x26c6ff(0x253)](':')[_0x26c6ff(0x232)](_0x18d8bc=>_0x18d8bc[_0x26c6ff(0x24a)]());return _0xcdf6b2[_0x8b4369]=_0x2d605e,_0xcdf6b2;},{});_0x210632[_0x470e2c(0x206)]&&(_0x1ffdd0['top'][_0x470e2c(0x258)]=_0x210632[_0x470e2c(0x206)][_0x470e2c(0x1ee)](_0x470e2c(0x20e))?_0x470e2c(0x20e):_0x470e2c(0x255)),_0x210632['border-bottom']&&(_0x1ffdd0[_0x470e2c(0x332)][_0x470e2c(0x258)]=_0x210632[_0x470e2c(0x316)][_0x470e2c(0x1ee)](_0x470e2c(0x20e))?_0x470e2c(0x20e):_0x470e2c(0x255)),_0x210632[_0x470e2c(0x24b)]&&(_0x1ffdd0[_0x470e2c(0x2f9)][_0x470e2c(0x258)]=_0x210632[_0x470e2c(0x24b)][_0x470e2c(0x1ee)](_0x470e2c(0x20e))?_0x470e2c(0x20e):_0x470e2c(0x255)),_0x210632[_0x470e2c(0x32f)]&&(_0x1ffdd0['right'][_0x470e2c(0x258)]=_0x210632[_0x470e2c(0x32f)]['includes'](_0x470e2c(0x20e))?_0x470e2c(0x20e):_0x470e2c(0x255));}return _0x1ffdd0;};_0x3afef0(_0x354060(0x250))[_0x354060(0x22a)]((_0x19717d,_0x421fda)=>{const _0x265343=_0x354060;let _0x2b8936=[],_0x360a17=0x0;while(_0x2eaaf3[_0x360a17]){_0x2eaaf3[_0x360a17]--,_0x360a17++;}_0x3afef0(_0x421fda)[_0x265343(0x203)](_0x265343(0x2ca))['each']((_0x2629c1,_0x36bc58)=>{const _0x175dfc=_0x265343;let _0x3816a6=_0x3afef0(_0x36bc58)[_0x175dfc(0x23f)]()[_0x175dfc(0x24a)](),_0x35f7e5=parseFloat(_0x3816a6['replace'](/,/g,'')),_0x180b4f={};!isNaN(_0x35f7e5)?(_0x180b4f['v']=_0x35f7e5,_0x180b4f['t']='n'):(_0x180b4f['v']=_0x3816a6,_0x180b4f['t']='s');const _0x3d2e98=_0x3afef0(_0x36bc58)[_0x175dfc(0x317)](_0x175dfc(0x258)),_0x4742f2=_0x286ec1(_0x3d2e98);_0x180b4f['s']={'border':_0x4742f2},_0x2b8936[_0x360a17]=_0x180b4f;let _0x273c29=parseInt(_0x3afef0(_0x36bc58)[_0x175dfc(0x317)](_0x175dfc(0x26b)))||0x1,_0x32d290=parseInt(_0x3afef0(_0x36bc58)[_0x175dfc(0x317)]('rowspan'))||0x1;(_0x273c29>0x1||_0x32d290>0x1)&&_0x4d4430['push']({'s':{'r':_0x19717d,'c':_0x360a17},'e':{'r':_0x19717d+_0x32d290-0x1,'c':_0x360a17+_0x273c29-0x1}});for(let _0x3abf72=0x0;_0x3abf72<_0x273c29;_0x3abf72++){_0x32d290>0x1&&(_0x2eaaf3[_0x360a17+_0x3abf72]=_0x32d290-0x1);}_0x360a17+=_0x273c29;}),_0x443ad8['push'](_0x2b8936);});const _0x358ca1=XLSX[_0x354060(0x2ce)][_0x354060(0x225)](),_0x234dd1=XLSX[_0x354060(0x2ce)][_0x354060(0x31c)](_0x443ad8);_0x4d4430[_0x354060(0x321)]>0x0&&(_0x234dd1['!merges']=_0x4d4430);_0x234dd1['!cols']=_0x443ad8[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x354060(0x2ce)][_0x354060(0x292)](_0x358ca1,_0x234dd1,_0x354060(0x2af));const _0x2b1010=XLSX[_0x354060(0x331)](_0x358ca1,{'bookType':_0x354060(0x1f3),'type':_0x354060(0x2b5)});_0x55af34[_0x354060(0x2a2)](_0x354060(0x281),_0x354060(0x20f)),_0x55af34[_0x354060(0x2a2)](_0x354060(0x312),_0x354060(0x2fd)),_0x55af34[_0x354060(0x223)](_0x2b1010);}else pdf['create'](_0x1ebafd,_0x45b6e5)[_0x354060(0x2a4)](function(_0x8f6543,_0x54bbb9){const _0x3d7698=_0x354060;if(_0x8f6543){_0x55af34[_0x3d7698(0x2d8)](0x1f4)[_0x3d7698(0x223)](_0x3d7698(0x219));return;}_0x55af34[_0x3d7698(0x2a2)](_0x3d7698(0x312),_0x3d7698(0x338)),_0x54bbb9[_0x3d7698(0x1bf)](_0x55af34);});}catch(_0x50f394){}}),router['get']('/inventory_sum/view',auth,async(_0x4d3a94,_0x562293)=>{const _0x1bede9=a0_0x4a8536;try{const {username:_0x353bcf,email:_0x1bab54,role:_0x47c8b3}=_0x4d3a94[_0x1bede9(0x1d7)],_0x368305=_0x4d3a94[_0x1bede9(0x1d7)],_0x236a62=await profile['findOne']({'email':_0x368305[_0x1bede9(0x28c)]}),_0x1e3f3e={'year':_0x1bede9(0x234),'month':_0x1bede9(0x295),'day':'numeric'},_0x23c570=await master_shop[_0x1bede9(0x203)](),_0xbf1576=await product[_0x1bede9(0x203)](),_0x284bc3=await warehouse[_0x1bede9(0x228)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x1bede9(0x26e),'localField':_0x1bede9(0x27c),'foreignField':_0x1bede9(0x30b),'as':_0x1bede9(0x2a0)}},{'$unwind':_0x1bede9(0x249)},{'$project':{'product_name':_0x1bede9(0x20b),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x1bede9(0x1d1),'product_stock':{'$sum':_0x1bede9(0x24e)}}}]);if(_0x23c570[0x0]['language']==_0x1bede9(0x23b))var _0x13875f=users['English'];else{if(_0x23c570[0x0][_0x1bede9(0x33a)]==_0x1bede9(0x236))var _0x13875f=users[_0x1bede9(0x236)];else{if(_0x23c570[0x0]['language']=='German')var _0x13875f=users[_0x1bede9(0x279)];else{if(_0x23c570[0x0][_0x1bede9(0x33a)]==_0x1bede9(0x2ff))var _0x13875f=users[_0x1bede9(0x2ff)];else{if(_0x23c570[0x0][_0x1bede9(0x33a)]=='French')var _0x13875f=users[_0x1bede9(0x284)];else{if(_0x23c570[0x0][_0x1bede9(0x33a)]==_0x1bede9(0x31b))var _0x13875f=users['Portuguese'];else{if(_0x23c570[0x0][_0x1bede9(0x33a)]=='Chinese')var _0x13875f=users[_0x1bede9(0x2f3)];else{if(_0x23c570[0x0][_0x1bede9(0x33a)]==_0x1bede9(0x288))var _0x13875f=users['Arabic'];}}}}}}}_0x562293[_0x1bede9(0x251)](_0x1bede9(0x291),{'success':_0x4d3a94['flash'](_0x1bede9(0x32d)),'errors':_0x4d3a94[_0x1bede9(0x1f7)](_0x1bede9(0x340)),'alldata':_0xbf1576,'profile':_0x236a62,'master_shop':_0x23c570,'role':_0x368305,'product_stock':_0x284bc3,'language':_0x13875f});}catch(_0x9eff6a){}});async function dataInventoryReports(_0x57e9b7,_0x257fb0,_0x52ed7c){const _0x1b11fb=a0_0x4a8536,_0x43387f=await sales_sa[_0x1b11fb(0x228)]([{'$match':{'date':{'$gte':_0x57e9b7,'$lte':_0x257fb0},'sales_staff_id':_0x52ed7c}},{'$unwind':_0x1b11fb(0x2df)},{'$group':{'_id':{'product_name':_0x1b11fb(0x1fd),'product_code':_0x1b11fb(0x245)},'sumqty':{'$sum':_0x1b11fb(0x301)}}},{'$sort':{'_id.product_name':0x1}}]),_0x356ba1=mongoose[_0x1b11fb(0x1c1)][_0x1b11fb(0x29e)],_0x1f79de=await staff['aggregate']([{'$match':{'_id':_0x356ba1(_0x52ed7c)}},{'$unwind':_0x1b11fb(0x32a)},{'$match':{'product_list.isConfirm':_0x1b11fb(0x204)}},{'$group':{'_id':{'product_name':'$product_list.product_name','product_code':'$product_list.product_code'},'sumqty':{'$sum':'$product_list.product_stock'}}},{'$sort':{'_id.product_name':0x1}}]),_0x577ea0=await sales_inv_data[_0x1b11fb(0x228)]([{'$match':{'date':{'$gte':_0x57e9b7,'$lte':_0x257fb0},'sales_staff_id':_0x52ed7c}},{'$unwind':_0x1b11fb(0x2df)},{'$group':{'_id':{'product_name':_0x1b11fb(0x1fd),'product_code':_0x1b11fb(0x245)},'totalQTYsum':{'$sum':_0x1b11fb(0x270)}}}]);console[_0x1b11fb(0x241)](_0x577ea0);let _0x508972='';var _0x49228b=0x0;for(let _0x910f81=0x0;_0x910f81<=_0x1f79de[_0x1b11fb(0x321)]-0x1;_0x910f81++){const _0x47d55a=_0x1f79de[_0x910f81];_0x508972+='<tr>',_0x508972+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>'+_0x47d55a[_0x1b11fb(0x226)][_0x1b11fb(0x280)]+_0x1b11fb(0x208),_0x508972+=_0x1b11fb(0x319)+_0x47d55a['_id'][_0x1b11fb(0x293)]+_0x1b11fb(0x208);var _0x6db595=_0x47d55a[_0x1b11fb(0x30f)],_0x583a8d=0x0;for(let _0x324901=0x0;_0x324901<=_0x43387f[_0x1b11fb(0x321)]-0x1;_0x324901++){const _0x5cbf02=_0x43387f[_0x324901];_0x47d55a[_0x1b11fb(0x226)][_0x1b11fb(0x280)]==_0x5cbf02[_0x1b11fb(0x226)][_0x1b11fb(0x280)]&&_0x47d55a[_0x1b11fb(0x226)][_0x1b11fb(0x293)]==_0x5cbf02[_0x1b11fb(0x226)][_0x1b11fb(0x293)]&&(_0x583a8d=_0x5cbf02[_0x1b11fb(0x30f)]);}var _0x52a0e6=0x0;for(let _0xb20e06=0x0;_0xb20e06<=_0x577ea0[_0x1b11fb(0x321)]-0x1;_0xb20e06++){const _0x236fa8=_0x577ea0[_0xb20e06];_0x47d55a[_0x1b11fb(0x226)]['product_code']==_0x236fa8['_id'][_0x1b11fb(0x280)]&&_0x47d55a[_0x1b11fb(0x226)][_0x1b11fb(0x293)]==_0x236fa8[_0x1b11fb(0x226)][_0x1b11fb(0x293)]&&(_0x52a0e6=_0x236fa8[_0x1b11fb(0x290)]);}_0x49228b=_0x6db595-_0x52a0e6+_0x583a8d,_0x508972+=_0x1b11fb(0x25a)+_0x49228b+_0x1b11fb(0x208);let _0x18b469=![];for(let _0x1c9221=0x0;_0x1c9221<=_0x577ea0[_0x1b11fb(0x321)]-0x1;_0x1c9221++){const _0x2192b6=_0x577ea0[_0x1c9221];if(_0x47d55a[_0x1b11fb(0x226)][_0x1b11fb(0x280)]==_0x2192b6[_0x1b11fb(0x226)]['product_code']&&_0x47d55a[_0x1b11fb(0x226)][_0x1b11fb(0x293)]==_0x2192b6['_id'][_0x1b11fb(0x293)]){_0x508972+='<td\x20class=\x22row_data\x22>'+_0x2192b6[_0x1b11fb(0x290)]+_0x1b11fb(0x208),_0x18b469=!![];break;}}!_0x18b469&&(_0x508972+=_0x1b11fb(0x1c6));let _0x4a9b3c=![];for(let _0x4f7d13=0x0;_0x4f7d13<=_0x43387f[_0x1b11fb(0x321)]-0x1;_0x4f7d13++){const _0x411e24=_0x43387f[_0x4f7d13];if(_0x47d55a[_0x1b11fb(0x226)]['product_code']==_0x411e24['_id'][_0x1b11fb(0x280)]&&_0x47d55a[_0x1b11fb(0x226)][_0x1b11fb(0x293)]==_0x411e24[_0x1b11fb(0x226)][_0x1b11fb(0x293)]){_0x508972+=_0x1b11fb(0x25a)+_0x411e24['sumqty']+'</td>',_0x4a9b3c=!![];break;}}!_0x4a9b3c&&(_0x508972+=_0x1b11fb(0x1c6)),_0x508972+=_0x1b11fb(0x25a)+_0x47d55a[_0x1b11fb(0x30f)]+'</td>',_0x508972+=_0x1b11fb(0x2cd);}return _0x508972;}router[a0_0x4a8536(0x265)](a0_0x4a8536(0x23e),auth,async(_0x4867bf,_0x20099e)=>{const _0x4d68a5=a0_0x4a8536;try{const {from_date:_0x713e4,to_date:_0x2da978}=_0x4867bf[_0x4d68a5(0x308)],_0x4697d2=_0x4867bf['user'],_0x1f1ff4=await staff[_0x4d68a5(0x1be)]({'email':_0x4697d2[_0x4d68a5(0x28c)]});let _0x3ebfd2=_0x4d68a5(0x2dd);var _0x34e14a=new Date(_0x713e4),_0x1810a5=new Date(_0x2da978);const _0x2f553f={'year':_0x4d68a5(0x234),'month':'long','day':_0x4d68a5(0x234)},_0x3b4bd6=new Intl[(_0x4d68a5(0x1c5))](_0x4d68a5(0x2bd),_0x2f553f)[_0x4d68a5(0x1e2)](_0x34e14a),_0x48b27e=new Intl[(_0x4d68a5(0x1c5))](_0x4d68a5(0x2bd),_0x2f553f)[_0x4d68a5(0x1e2)](_0x1810a5);var _0x2a391=await dataInventoryReports(_0x713e4,_0x2da978,_0x1f1ff4[_0x4d68a5(0x226)][_0x4d68a5(0x2ab)]());_0x3ebfd2+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x3ebfd2+=_0x4d68a5(0x1e1),_0x3ebfd2+=_0x4d68a5(0x1f9)+_0x3b4bd6+_0x4d68a5(0x22e)+_0x48b27e+_0x4d68a5(0x26a),_0x3ebfd2+=_0x4d68a5(0x238),_0x3ebfd2+=_0x4d68a5(0x1cb),_0x3ebfd2+=_0x4d68a5(0x2be),_0x3ebfd2+=_0x4d68a5(0x201),_0x3ebfd2+=_0x4d68a5(0x28e),_0x3ebfd2+=_0x4d68a5(0x300),_0x3ebfd2+=_0x4d68a5(0x30d),_0x3ebfd2+=_0x4d68a5(0x266),_0x3ebfd2+='<th>\x20SALES\x20</th>',_0x3ebfd2+=_0x4d68a5(0x2de),_0x3ebfd2+='<tr>',_0x3ebfd2+=_0x2a391,_0x3ebfd2+=_0x4d68a5(0x2cd),_0x3ebfd2+=_0x4d68a5(0x285),_0x3ebfd2+=_0x4d68a5(0x285);const _0x307d38={'format':_0x4d68a5(0x1b9),'orientation':_0x4d68a5(0x294),'childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf['create'](_0x3ebfd2,_0x307d38)[_0x4d68a5(0x2a4)](function(_0x20342f,_0x4cb067){const _0x3c2f6e=_0x4d68a5;if(_0x20342f){_0x20099e['status'](0x1f4)[_0x3c2f6e(0x223)](_0x3c2f6e(0x219));return;}_0x20099e['setHeader'](_0x3c2f6e(0x312),'application/pdf'),_0x4cb067['pipe'](_0x20099e);});}catch(_0x3c34de){}}),router[a0_0x4a8536(0x1de)]('/dsrr/view',auth,async(_0x29fddf,_0x493acd)=>{const _0x252cab=a0_0x4a8536;try{const {username:_0xd1ba0c,email:_0x757615,role:_0x3aeb81}=_0x29fddf['user'],_0x310704=_0x29fddf[_0x252cab(0x1d7)],_0x343bcc=await profile[_0x252cab(0x1be)]({'email':_0x310704[_0x252cab(0x28c)]}),_0x2a5063={'year':'numeric','month':'long','day':_0x252cab(0x234)},_0x3acf93=await master_shop[_0x252cab(0x203)]();console[_0x252cab(0x241)](_0x252cab(0x33b),_0x3acf93);const _0x1b1c58=await product['find']();console['log'](_0x252cab(0x324),_0x1b1c58);const _0x3f5db5=await warehouse[_0x252cab(0x228)]([{'$unwind':_0x252cab(0x311)},{'$lookup':{'from':'products','localField':_0x252cab(0x27c),'foreignField':_0x252cab(0x30b),'as':_0x252cab(0x2a0)}},{'$unwind':_0x252cab(0x249)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x252cab(0x2d2)}},{'$group':{'_id':_0x252cab(0x1d1),'product_stock':{'$sum':_0x252cab(0x24e)}}}]);console[_0x252cab(0x241)](_0x252cab(0x235),_0x3f5db5),_0x3f5db5[_0x252cab(0x276)](_0x1ff758=>{const _0x417660=_0x252cab,_0x5090db=_0x1b1c58[_0x417660(0x232)](_0xdc34fe=>{const _0x2a4369=_0x417660;_0xdc34fe['name']==_0x1ff758['_id']&&(_0xdc34fe['stock']=parseInt(_0xdc34fe[_0x2a4369(0x27a)])+parseInt(_0x1ff758[_0x2a4369(0x1db)]));});});const _0x202aae=await staff[_0x252cab(0x1be)]({'email':_0x310704[_0x252cab(0x28c)]});if(_0x3acf93[0x0]['language']==_0x252cab(0x23b))var _0x2b685f=users[_0x252cab(0x1f8)];else{if(_0x3acf93[0x0][_0x252cab(0x33a)]==_0x252cab(0x236))var _0x2b685f=users['Hindi'];else{if(_0x3acf93[0x0][_0x252cab(0x33a)]==_0x252cab(0x279))var _0x2b685f=users['German'];else{if(_0x3acf93[0x0]['language']==_0x252cab(0x2ff))var _0x2b685f=users['Spanish'];else{if(_0x3acf93[0x0][_0x252cab(0x33a)]==_0x252cab(0x284))var _0x2b685f=users[_0x252cab(0x284)];else{if(_0x3acf93[0x0][_0x252cab(0x33a)]==_0x252cab(0x31b))var _0x2b685f=users[_0x252cab(0x315)];else{if(_0x3acf93[0x0][_0x252cab(0x33a)]==_0x252cab(0x2f3))var _0x2b685f=users[_0x252cab(0x2f3)];else{if(_0x3acf93[0x0][_0x252cab(0x33a)]=='Arabic\x20(ae)')var _0x2b685f=users[_0x252cab(0x1ba)];}}}}}}}_0x493acd['render'](_0x252cab(0x26d),{'success':_0x29fddf[_0x252cab(0x1f7)](_0x252cab(0x32d)),'errors':_0x29fddf[_0x252cab(0x1f7)]('errors'),'alldata':_0x1b1c58,'profile':_0x343bcc,'master_shop':_0x3acf93,'role':_0x310704,'product_stock':_0x3f5db5,'language':_0x2b685f,'staff_arr':_0x202aae});}catch(_0xbb081){}});async function agentsdataDSICheck_DSRR(_0x4abde0,_0x5da538,_0xe0be82,_0x39d8dc){const _0x5d43a7=a0_0x4a8536;let _0x3e6cc8=new Date(_0x4abde0);_0x3e6cc8[_0x5d43a7(0x2b3)](_0x3e6cc8[_0x5d43a7(0x222)]()-0x1);let _0x3317af=_0x3e6cc8[_0x5d43a7(0x24f)]()[_0x5d43a7(0x253)]('T')[0x0];const _0x3bc88b=await product[_0x5d43a7(0x228)]([{'$group':{'_id':{'brand':_0x5d43a7(0x1e6),'category':_0x5d43a7(0x21c)},'products':{'$push':{'name':_0x5d43a7(0x296),'product_code':_0x5d43a7(0x2b8)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x212171=[];_0x212171[_0x5d43a7(0x2bf)]=[];for(let _0xd321a6=0x0;_0xd321a6<=_0x3bc88b[_0x5d43a7(0x321)]-0x1;_0xd321a6++){const _0x6ec979=_0x3bc88b[_0xd321a6];_0x212171[_0x5d43a7(0x2bf)]['push'](_0x6ec979);}const _0x79cc58=await product[_0x5d43a7(0x228)]([{'$group':{'_id':{'category':_0x5d43a7(0x21c)},'products':{'$push':{'brand':_0x5d43a7(0x1e6),'product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x7ac923=await product['aggregate']([{'$group':{'_id':{'category':_0x5d43a7(0x21c),'brand':_0x5d43a7(0x1e6)}}},{'$group':{'_id':_0x5d43a7(0x229),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x35bf17=await sales_sa['aggregate']([{'$match':{'date':_0x4abde0,'sales_staff_id':_0x5da538,'sale_product.isFG':_0x5d43a7(0x1fe)}},{'$unwind':_0x5d43a7(0x2df)},{'$lookup':{'from':_0x5d43a7(0x26e),'localField':'sale_product.product_code','foreignField':'product_code','as':_0x5d43a7(0x246)}},{'$unwind':_0x5d43a7(0x33e)},{'$group':{'_id':{'dsi':_0x5d43a7(0x248),'date':_0x5d43a7(0x21f),'customer':_0x5d43a7(0x2e7),'status_data':_0x5d43a7(0x1dd)},'totalQty':{'$sum':_0x5d43a7(0x2ae)},'cash':{'$first':_0x5d43a7(0x2c1)},'amount':{'$first':_0x5d43a7(0x1ed)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x5d43a7(0x2d0)},'due_date':{'$first':_0x5d43a7(0x210)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x5d43a7(0x2f1),'discount':_0x5d43a7(0x2b1),'adj_discount':_0x5d43a7(0x2d3),'product_details':{'prod_name':_0x5d43a7(0x1c0),'product_code':_0x5d43a7(0x278),'category':_0x5d43a7(0x23c),'brand':'$product_info.brand','gross_price':_0x5d43a7(0x240),'isFG':_0x5d43a7(0x218),'prod_cat':_0x5d43a7(0x2f8),'prod_id':_0x5d43a7(0x21a)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x5d43a7(0x30a),'date':_0x5d43a7(0x269),'customer':_0x5d43a7(0x2eb),'status_data':_0x5d43a7(0x28f),'category':_0x5d43a7(0x32b),'brand':_0x5d43a7(0x29f),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x5d43a7(0x2e8)},'totalGross':{'$sum':{'$multiply':[_0x5d43a7(0x2e8),_0x5d43a7(0x1c4)]}},'NetPrice':{'$sum':_0x5d43a7(0x2d5)},'discount':{'$sum':_0x5d43a7(0x267)},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':_0x5d43a7(0x2c1)},'amount':{'$first':_0x5d43a7(0x1ed)},'bank':{'$first':_0x5d43a7(0x2f4)},'check_no':{'$first':_0x5d43a7(0x2d0)},'due_date':{'$first':'$due_date'},'product_details':{'$first':_0x5d43a7(0x1e4)}}},{'$group':{'_id':{'dsi':_0x5d43a7(0x30a),'date':_0x5d43a7(0x269),'customer':_0x5d43a7(0x2eb),'status_data':_0x5d43a7(0x28f)},'totalQty':{'$sum':_0x5d43a7(0x22f)},'totalGross':{'$sum':_0x5d43a7(0x2fe)},'NetPrice':{'$sum':_0x5d43a7(0x20c)},'discount':{'$sum':_0x5d43a7(0x252)},'adj_discount':{'$sum':'$adj_discount'},'cash':{'$first':_0x5d43a7(0x2c1)},'amount':{'$first':_0x5d43a7(0x1ed)},'bank':{'$first':_0x5d43a7(0x2f4)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x5d43a7(0x210)},'products':{'$push':{'qty':'$totalQty','category':_0x5d43a7(0x229),'brand':_0x5d43a7(0x28b),'product_details':_0x5d43a7(0x311)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5054a6=await sales_sa[_0x5d43a7(0x228)]([{'$match':{'date':_0x3317af,'sales_staff_id':_0x5da538,'sale_product.isFG':_0x5d43a7(0x1fe)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x5d43a7(0x26e),'localField':_0x5d43a7(0x1f4),'foreignField':_0x5d43a7(0x280),'as':_0x5d43a7(0x246)}},{'$unwind':_0x5d43a7(0x33e)},{'$group':{'_id':{'dsi':_0x5d43a7(0x248),'date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x5d43a7(0x2ae)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x5d43a7(0x2f4)},'check_no':{'$first':_0x5d43a7(0x2d0)},'due_date':{'$first':_0x5d43a7(0x210)},'products':{'$push':{'qty':_0x5d43a7(0x2ae),'NetPrice':_0x5d43a7(0x2f1),'discount':_0x5d43a7(0x2b1),'adj_discount':_0x5d43a7(0x2d3),'product_details':{'prod_name':_0x5d43a7(0x1c0),'product_code':_0x5d43a7(0x278),'category':_0x5d43a7(0x23c),'brand':_0x5d43a7(0x231),'gross_price':_0x5d43a7(0x240),'isFG':_0x5d43a7(0x218),'prod_cat':'$sale_product.prod_cat','prod_id':'$sale_product._id'}}}}},{'$unwind':_0x5d43a7(0x275)},{'$group':{'_id':{'dsi':_0x5d43a7(0x30a),'date':_0x5d43a7(0x269),'customer':_0x5d43a7(0x2eb),'category':_0x5d43a7(0x32b),'brand':_0x5d43a7(0x29f),'prod_id':_0x5d43a7(0x237)},'totalQty':{'$sum':_0x5d43a7(0x2e8)},'cash':{'$first':_0x5d43a7(0x2c1)},'amount':{'$first':_0x5d43a7(0x1ed)},'bank':{'$first':_0x5d43a7(0x2f4)},'check_no':{'$first':_0x5d43a7(0x2d0)},'due_date':{'$first':_0x5d43a7(0x210)},'totalGross':{'$sum':{'$multiply':[_0x5d43a7(0x2e8),_0x5d43a7(0x1c4)]}},'NetPrice':{'$sum':_0x5d43a7(0x2d5)},'discount':{'$sum':_0x5d43a7(0x267)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x5d43a7(0x30a),'date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':_0x5d43a7(0x22f)},'cash':{'$first':'$cash'},'amount':{'$first':_0x5d43a7(0x1ed)},'bank':{'$first':_0x5d43a7(0x2f4)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':_0x5d43a7(0x2fe)},'NetPrice':{'$sum':_0x5d43a7(0x20c)},'discount':{'$sum':_0x5d43a7(0x252)},'adj_discount':{'$sum':_0x5d43a7(0x2d1)},'products':{'$push':{'qty':_0x5d43a7(0x22f),'category':_0x5d43a7(0x229),'brand':_0x5d43a7(0x28b),'product_details':_0x5d43a7(0x311)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x2ab711=await sales_sa[_0x5d43a7(0x228)]([{'$match':{'date':_0x4abde0,'sales_staff_id':_0x5da538,'status_data':_0x5d43a7(0x204)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5cad86=await staff['findById'](_0x5da538);let _0x45b59b=[],_0x4d796f={},_0x12b1c9={};var _0x2c2ae5=0x0,_0x27499e=0x0,_0x3711d7=0x0,_0x2c246f=0x0,_0x1fba23=0x0;const _0xf5e63c=0x6;var _0x40d40d=0x0,_0x5c48c8=0x0;for(let _0x43214b=0x0;_0x43214b<=_0x35bf17[_0x5d43a7(0x321)]-0x1;_0x43214b++){const _0x5c8af6=_0x35bf17[_0x43214b];let _0x1ec549=_0x5d43a7(0x201);_0x1ec549+=_0x5d43a7(0x2a5),_0x1ec549+=_0x5d43a7(0x217)+_0x5c8af6[_0x5d43a7(0x226)][_0x5d43a7(0x282)]+_0x5d43a7(0x208),_0x1ec549+=_0x5d43a7(0x217)+_0x5c8af6[_0x5d43a7(0x226)]['dsi']+'</td>';let _0x4c0d67={},_0x52408e={},_0x1d18a6={};var _0x3bc23b={},_0x51a3ca={},_0x802259={},_0xf8bc94=0x0;for(let _0x4ffaf8=0x0;_0x4ffaf8<=_0x5c8af6[_0x5d43a7(0x26e)][_0x5d43a7(0x321)]-0x1;_0x4ffaf8++){const _0x2c0143=_0x5c8af6[_0x5d43a7(0x26e)][_0x4ffaf8];_0x4c0d67[_0x2c0143[_0x5d43a7(0x1bd)]+'-'+_0x2c0143['category']]=_0x2c0143[_0x5d43a7(0x2ad)],_0x52408e[[_0x2c0143[_0x5d43a7(0x1bd)]+'-'+_0x2c0143[_0x5d43a7(0x2b6)]]]=_0x2c0143['product_details']['isFG'],_0x1d18a6[[_0x2c0143[_0x5d43a7(0x1bd)]+'-'+_0x2c0143[_0x5d43a7(0x2b6)]]]=_0x2c0143[_0x5d43a7(0x1ff)][_0x5d43a7(0x33c)];const _0x50c3a7=_0x2c0143['brand']+'-'+_0x2c0143[_0x5d43a7(0x2b6)];!Array[_0x5d43a7(0x1bb)](_0x12b1c9[_0x50c3a7])&&(_0x12b1c9[_0x50c3a7]=[]);!Array[_0x5d43a7(0x1bb)](_0x12b1c9[_0x50c3a7])&&(_0x12b1c9[_0x50c3a7]=[]);_0x12b1c9[_0x50c3a7][_0x5d43a7(0x205)](_0x2c0143[_0x5d43a7(0x2ad)]);if(_0x2c0143[_0x5d43a7(0x1ff)][_0x5d43a7(0x33c)]=='P')_0x2c0143[_0x5d43a7(0x1ff)][_0x5d43a7(0x2e2)]==_0x5d43a7(0x204)?(!_0x802259[_0x50c3a7]&&(_0x802259[_0x50c3a7]=0x0),_0x802259[_0x50c3a7]=_0x2c0143['qty']):(!_0x3bc23b[_0x50c3a7]&&(_0x3bc23b[_0x50c3a7]=0x0),_0x3bc23b[_0x50c3a7]=_0x2c0143[_0x5d43a7(0x2ad)]);else _0x2c0143[_0x5d43a7(0x1ff)]['prod_cat']=='S'&&(_0x2c0143[_0x5d43a7(0x1ff)][_0x5d43a7(0x2e2)]=='true'?(!_0x802259[_0x50c3a7]&&(_0x802259[_0x50c3a7]=0x0),_0x802259[_0x50c3a7]=_0x2c0143[_0x5d43a7(0x2ad)]):(!_0x51a3ca[_0x50c3a7]&&(_0x51a3ca[_0x50c3a7]=0x0),_0x51a3ca[_0x50c3a7]=_0x2c0143['qty']));_0xf8bc94++;}for(let _0x556cf8=0x0;_0x556cf8<=_0x212171[_0x5d43a7(0x2bf)][_0x5d43a7(0x321)]-0x1;_0x556cf8++){const _0x131cfb=_0x212171[_0x5d43a7(0x2bf)][_0x556cf8],_0x20b13e=_0x131cfb[_0x5d43a7(0x226)][_0x5d43a7(0x1bd)]+'-'+_0x131cfb[_0x5d43a7(0x226)][_0x5d43a7(0x2b6)],_0x181986=_0x1d18a6[_0x20b13e]!==undefined?_0x1d18a6[_0x20b13e]:'NA';var _0x5c5cc5=_0x3bc23b[_0x20b13e]!==undefined?_0x3bc23b[_0x20b13e][_0x5d43a7(0x2c4)](0x2):'',_0x19fff4=_0x51a3ca[_0x20b13e]!==undefined?_0x51a3ca[_0x20b13e][_0x5d43a7(0x2c4)](0x2):'',_0x366d70=_0x802259[_0x20b13e]!==undefined?_0x802259[_0x20b13e][_0x5d43a7(0x2c4)](0x2):'';_0x1ec549+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x5c5cc5+'</td>',_0x1ec549+=_0x5d43a7(0x2d6)+_0x19fff4+_0x5d43a7(0x208),_0x1ec549+=_0x5d43a7(0x2d6)+_0x366d70+_0x5d43a7(0x208);}var _0x12ed1d=formatNumber(parseFloat(_0x5c8af6[_0x5d43a7(0x23d)])),_0xfd3399=formatNumber(parseFloat(_0x5c8af6[_0x5d43a7(0x320)]));isNaN(_0xfd3399)&&(_0xfd3399=0x0),_0x1ec549+=_0x5d43a7(0x2d6)+_0x12ed1d+_0x5d43a7(0x208),_0x1ec549+=_0x5d43a7(0x2d6)+_0xfd3399+'</td>',_0x1ec549+=_0x5d43a7(0x217)+_0x5c8af6['bank']+'</td>',_0x1ec549+=_0x5d43a7(0x217)+_0x5c8af6[_0x5d43a7(0x30e)]+_0x5d43a7(0x208),_0x1ec549+=_0x5d43a7(0x217)+_0x5c8af6[_0x5d43a7(0x2e9)]+_0x5d43a7(0x208),_0x3711d7=_0x5c8af6['discount']+_0x5c8af6['adj_discount'],_0x40d40d+=parseFloat(_0x5c8af6[_0x5d43a7(0x23d)]),_0x5c48c8+=parseFloat(_0xfd3399),_0x45b59b[_0x5d43a7(0x205)](_0x1ec549);}if(_0x2ab711[_0x5d43a7(0x321)]>0x0)for(let _0x4c04f7=0x0;_0x4c04f7<=_0x2ab711[_0x5d43a7(0x321)]-0x1;_0x4c04f7++){const _0x59fc9f=_0x2ab711[_0x4c04f7];console[_0x5d43a7(0x241)](_0x59fc9f);let _0x5106d6='<tr>';_0x5106d6+=_0x5d43a7(0x1dc)+(0x8+0x7*0x3)+_0x5d43a7(0x329)+_0x59fc9f['note']+_0x5d43a7(0x221),_0x5106d6+=_0x5d43a7(0x2cd),_0x45b59b[_0x5d43a7(0x205)](_0x5106d6);}function _0x218c2b(_0x2f1e72,_0x334f40){const _0x4a293d=_0x5d43a7,_0x1212ff=[];for(let _0x59828a=0x0;_0x59828a<=_0x2f1e72[_0x4a293d(0x321)]-0x1;_0x59828a+=_0x334f40){_0x1212ff[_0x4a293d(0x205)](_0x2f1e72[_0x4a293d(0x2c8)](_0x59828a,_0x59828a+_0x334f40));}return _0x1212ff;}const _0x476b7e=_0x218c2b(_0x45b59b,_0xf5e63c);let _0x36a592='';return _0x476b7e[_0x5d43a7(0x276)]((_0x253e06,_0x2992b2)=>{const _0xd3ce8=_0x5d43a7;_0x2992b2>0x0&&(_0x36a592+=_0xd3ce8(0x261));_0x36a592+=_0xd3ce8(0x2be),_0x36a592+=_0xd3ce8(0x220);const _0x1208a1=new Date(_0x4abde0),_0x751672={'year':_0xd3ce8(0x234),'month':_0xd3ce8(0x295),'day':_0xd3ce8(0x234),'timeZone':_0xd3ce8(0x309)},_0x1c76ca=_0x1208a1[_0xd3ce8(0x322)](_0xd3ce8(0x2bd),_0x751672);_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x336)+_0x39d8dc+'</b></td>',_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0x5cad86['name']+_0xd3ce8(0x208),_0x36a592+=_0xd3ce8(0x313),_0x36a592+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x36a592+=_0xd3ce8(0x2bb),_0x36a592+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x36a592+=_0xd3ce8(0x274),_0x36a592+=_0xd3ce8(0x1d0),_0x36a592+='<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>',_0x36a592+=_0xd3ce8(0x2b9),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x1e7),_0x36a592+=_0xd3ce8(0x337)+_0x1c76ca+_0xd3ce8(0x208),_0x36a592+=_0xd3ce8(0x1c7),_0x36a592+=_0xd3ce8(0x33f),_0x36a592+=_0xd3ce8(0x227),_0x36a592+=_0xd3ce8(0x227),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x27b),_0x36a592+=_0xd3ce8(0x1ce),_0x36a592+=_0xd3ce8(0x2fc),_0x36a592+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x36a592+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+='<tr>',_0x36a592+=_0xd3ce8(0x1da),_0x36a592+='</tr>',_0x36a592+='<tr>',_0x36a592+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x36a592+=_0xd3ce8(0x22d),_0x36a592+='</tr>',_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x25e),_0x36a592+=_0xd3ce8(0x2ac),_0x36a592+=_0xd3ce8(0x1e3);for(let _0x4cccc0=0x0;_0x4cccc0<=_0x79cc58[_0xd3ce8(0x321)]-0x1;_0x4cccc0++){const _0x5c84dc=_0x79cc58[_0x4cccc0];for(let _0x1c6b51=0x0;_0x1c6b51<_0x212171[_0xd3ce8(0x2bf)]['length'];_0x1c6b51++){const _0x675d95=_0x212171[_0xd3ce8(0x2bf)][_0x1c6b51];if(_0x675d95[_0xd3ce8(0x226)][_0xd3ce8(0x2b6)]===_0x5c84dc[_0xd3ce8(0x226)][_0xd3ce8(0x2b6)]){var _0x4125c2='';switch(_0x5c84dc['_id'][_0xd3ce8(0x2b6)]){case _0xd3ce8(0x2c3):_0x4125c2=_0x675d95[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)]+_0xd3ce8(0x2ee);break;case _0xd3ce8(0x328):_0x4125c2=_0x675d95[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)]+_0xd3ce8(0x20d);break;default:_0x4125c2=_0x675d95[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)];break;}_0x36a592+=_0xd3ce8(0x1e0)+_0x4125c2+_0xd3ce8(0x221);}}}_0x36a592+=_0xd3ce8(0x1cd),_0x36a592+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>',_0x36a592+=_0xd3ce8(0x31a),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x213);for(let _0xc7529c=0x0;_0xc7529c<=_0x212171[_0xd3ce8(0x2bf)][_0xd3ce8(0x321)]-0x1;_0xc7529c++){const _0x5a7ea4=_0x212171[_0xc7529c];_0x36a592+=_0xd3ce8(0x306),_0x36a592+=_0xd3ce8(0x26c),_0x36a592+=_0xd3ce8(0x2e3);}_0x36a592+=_0xd3ce8(0x2da),_0x36a592+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>',_0x36a592+=_0xd3ce8(0x323),_0x36a592+='</tr>',_0x36a592+=_0xd3ce8(0x233),_0x36a592+='<tbody>',_0x253e06[_0xd3ce8(0x276)](_0x1dc439=>{_0x36a592+=_0x1dc439;});let _0x4f6fc7={},_0x3f5da4={},_0x5b4f07={};for(let _0x35339d=0x0;_0x35339d<=_0x35bf17[_0xd3ce8(0x321)]-0x1;_0x35339d++){const _0x2ea579=_0x35bf17[_0x35339d];var _0x322032=0x0;for(let _0x4fb875=0x0;_0x4fb875<=_0x2ea579[_0xd3ce8(0x26e)]['length']-0x1;_0x4fb875++){const _0x34fbdb=_0x2ea579[_0xd3ce8(0x26e)][_0x4fb875],_0x533a36=_0x34fbdb[_0xd3ce8(0x1bd)]+'-'+_0x34fbdb[_0xd3ce8(0x2b6)];if(_0x34fbdb['product_details']['prod_cat']=='P')_0x34fbdb['product_details'][_0xd3ce8(0x2e2)]==_0xd3ce8(0x204)?(!_0x5b4f07[_0x533a36]&&(_0x5b4f07[_0x533a36]=0x0),_0x5b4f07[_0x533a36]+=_0x34fbdb['qty']):(!_0x4f6fc7[_0x533a36]&&(_0x4f6fc7[_0x533a36]=0x0),_0x4f6fc7[_0x533a36]+=_0x34fbdb[_0xd3ce8(0x2ad)]);else _0x34fbdb[_0xd3ce8(0x1ff)][_0xd3ce8(0x33c)]=='S'&&(_0x34fbdb['product_details'][_0xd3ce8(0x2e2)]==_0xd3ce8(0x204)?(!_0x5b4f07[_0x533a36]&&(_0x5b4f07[_0x533a36]=0x0),_0x5b4f07[_0x533a36]+=_0x34fbdb['qty'],console['log'](_0x34fbdb['qty'])):(!_0x3f5da4[_0x533a36]&&(_0x3f5da4[_0x533a36]=0x0),_0x3f5da4[_0x533a36]+=_0x34fbdb[_0xd3ce8(0x2ad)]));_0x322032++;}}let _0x23f818={},_0x2bfbaa={},_0x341a9a={};var _0x56b741=0x0,_0x5b776c=0x0;for(let _0x22da5c=0x0;_0x22da5c<=_0x5054a6[_0xd3ce8(0x321)]-0x1;_0x22da5c++){const _0x325cd3=_0x5054a6[_0x22da5c];var _0x322032=0x0;for(let _0x5ee8e5=0x0;_0x5ee8e5<=_0x325cd3[_0xd3ce8(0x26e)][_0xd3ce8(0x321)]-0x1;_0x5ee8e5++){const _0x465ce4=_0x325cd3[_0xd3ce8(0x26e)][_0x5ee8e5],_0x1b4396=_0x465ce4[_0xd3ce8(0x1bd)]+'-'+_0x465ce4[_0xd3ce8(0x2b6)];if(_0x465ce4[_0xd3ce8(0x1ff)][_0xd3ce8(0x33c)]=='P')_0x465ce4['product_details']['isFG']==_0xd3ce8(0x204)?(!_0x341a9a[_0x1b4396]&&(_0x341a9a[_0x1b4396]=0x0),_0x341a9a[_0x1b4396]+=_0x465ce4[_0xd3ce8(0x2ad)]):(!_0x23f818[_0x1b4396]&&(_0x23f818[_0x1b4396]=0x0),_0x23f818[_0x1b4396]+=_0x465ce4['qty']);else _0x465ce4['product_details'][_0xd3ce8(0x33c)]=='S'&&(_0x465ce4[_0xd3ce8(0x1ff)][_0xd3ce8(0x2e2)]==_0xd3ce8(0x204)?(!_0x341a9a[_0x1b4396]&&(_0x341a9a[_0x1b4396]=0x0),_0x341a9a[_0x1b4396]+=_0x465ce4[_0xd3ce8(0x2ad)]):(!_0x2bfbaa[_0x1b4396]&&(_0x2bfbaa[_0x1b4396]=0x0),_0x2bfbaa[_0x1b4396]+=_0x465ce4[_0xd3ce8(0x2ad)]));_0x322032++;}var _0x240a00=parseFloat(_0x325cd3['cash']),_0x49b82c=parseFloat(_0x325cd3[_0xd3ce8(0x320)]);isNaN(_0x49b82c)&&(_0x49b82c=0x0),_0x56b741+=_0x240a00,_0x5b776c+=_0x49b82c;}_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x29b),_0x36a592+=_0xd3ce8(0x22c),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x4fc3e4=0x0;_0x4fc3e4<=_0x212171[_0xd3ce8(0x2bf)][_0xd3ce8(0x321)]-0x1;_0x4fc3e4++){const _0x123d74=_0x212171['cat_brand'][_0x4fc3e4],_0x5debc4=_0x123d74[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)]+'-'+_0x123d74[_0xd3ce8(0x226)][_0xd3ce8(0x2b6)];var _0x437fe1=_0x4f6fc7[_0x5debc4]!==undefined?formatNumber(_0x4f6fc7[_0x5debc4][_0xd3ce8(0x2c4)](0x2)):'',_0x1197a6=_0x5b4f07[_0x5debc4]!==undefined?formatNumber(_0x5b4f07[_0x5debc4][_0xd3ce8(0x2c4)](0x2)):'',_0x428bb3=_0x3f5da4[_0x5debc4]!==undefined?formatNumber(_0x3f5da4[_0x5debc4][_0xd3ce8(0x2c4)](0x2)):'';_0x36a592+=_0xd3ce8(0x1fa)+_0x437fe1+'</b></td>',_0x36a592+=_0xd3ce8(0x1fa)+_0x428bb3+_0xd3ce8(0x221),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1197a6+_0xd3ce8(0x221);}_0x36a592+=_0xd3ce8(0x1fa)+formatNumber(_0x40d40d)+_0xd3ce8(0x221),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5c48c8)+_0xd3ce8(0x221),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+='<tr>',_0x36a592+=_0xd3ce8(0x29b),_0x36a592+=_0xd3ce8(0x2fa),_0x36a592+=_0xd3ce8(0x2a5);for(let _0x208a26=0x0;_0x208a26<=_0x212171['cat_brand']['length']-0x1;_0x208a26++){const _0x758fec=_0x212171[_0xd3ce8(0x2bf)][_0x208a26],_0xabe6=_0x758fec[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)]+'-'+_0x758fec[_0xd3ce8(0x226)][_0xd3ce8(0x2b6)];var _0x437fe1=_0x23f818[_0xabe6]!==undefined?formatNumber(_0x23f818[_0xabe6][_0xd3ce8(0x2c4)](0x2)):'',_0x1197a6=_0x341a9a[_0xabe6]!==undefined?formatNumber(_0x341a9a[_0xabe6][_0xd3ce8(0x2c4)](0x2)):'',_0x428bb3=_0x2bfbaa[_0xabe6]!==undefined?formatNumber(_0x2bfbaa[_0xabe6][_0xd3ce8(0x2c4)](0x2)):'';_0x36a592+=_0xd3ce8(0x1fa)+_0x437fe1+_0xd3ce8(0x221),_0x36a592+=_0xd3ce8(0x1fa)+_0x428bb3+_0xd3ce8(0x221),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1197a6+'</b></td>';}_0x36a592+=_0xd3ce8(0x1fa)+formatNumber(_0x56b741)+_0xd3ce8(0x221),_0x36a592+=_0xd3ce8(0x1fa)+formatNumber(_0x5b776c)+'</b></td>',_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x29b),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x36a592+=_0xd3ce8(0x2a5);let _0x6454af=0x0,_0x155f4d=0x0,_0x297bdb=0x0;for(let _0x1b780c=0x0;_0x1b780c<=_0x212171['cat_brand'][_0xd3ce8(0x321)]-0x1;_0x1b780c++){const _0x3827fb=_0x212171[_0xd3ce8(0x2bf)][_0x1b780c],_0x2a93b8=_0x3827fb['_id'][_0xd3ce8(0x1bd)]+'-'+_0x3827fb['_id'][_0xd3ce8(0x2b6)];var _0x269bf8=_0x4f6fc7[_0x2a93b8]!==undefined?_0x4f6fc7[_0x2a93b8]['toFixed'](0x2):'0',_0x3176dd=_0x5b4f07[_0x2a93b8]!==undefined?_0x5b4f07[_0x2a93b8][_0xd3ce8(0x2c4)](0x2):'0',_0x3cc00b=_0x3f5da4[_0x2a93b8]!==undefined?_0x3f5da4[_0x2a93b8][_0xd3ce8(0x2c4)](0x2):'0',_0x464a69=_0x23f818[_0x2a93b8]!==undefined?_0x23f818[_0x2a93b8][_0xd3ce8(0x2c4)](0x2):'0',_0x1f7a54=_0x341a9a[_0x2a93b8]!==undefined?_0x341a9a[_0x2a93b8]['toFixed'](0x2):'0',_0x3f40ee=_0x2bfbaa[_0x2a93b8]!==undefined?_0x2bfbaa[_0x2a93b8][_0xd3ce8(0x2c4)](0x2):'0';_0x6454af=parseFloat(_0x269bf8)+parseFloat(_0x464a69),_0x155f4d=parseFloat(_0x3cc00b)+parseFloat(_0x3f40ee),_0x297bdb=parseFloat(_0x3176dd)+parseFloat(_0x1f7a54),_0x36a592+=_0xd3ce8(0x1fa)+formatNumber(_0x6454af[_0xd3ce8(0x2c4)](0x2))+_0xd3ce8(0x221),_0x36a592+=_0xd3ce8(0x1fa)+formatNumber(_0x155f4d[_0xd3ce8(0x2c4)](0x2))+_0xd3ce8(0x221),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x297bdb[_0xd3ce8(0x2c4)](0x2))+_0xd3ce8(0x221);}var _0x3e1ee8=formatNumber(_0x40d40d+_0x56b741),_0x2c0eaa=formatNumber(_0x5c48c8+_0x5b776c);_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3e1ee8+_0xd3ce8(0x221),_0x36a592+=_0xd3ce8(0x1fa)+_0x2c0eaa+_0xd3ce8(0x221),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x25d)+(_0x212171['cat_brand'][_0xd3ce8(0x321)]*0x3+0x9)+_0xd3ce8(0x2d9),_0x36a592+='</tr>',_0x36a592+='<tr>',_0x36a592+=_0xd3ce8(0x29b),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x36a592+=_0xd3ce8(0x2a5);for(let _0x17cdb1=0x0;_0x17cdb1<=_0x212171[_0xd3ce8(0x2bf)][_0xd3ce8(0x321)]-0x1;_0x17cdb1++){const _0x3e22ab=_0x212171['cat_brand'][_0x17cdb1],_0xfc8c49=_0x3e22ab['_id']['brand']+'-'+_0x3e22ab[_0xd3ce8(0x226)]['category'];var _0x269bf8=_0x4f6fc7[_0xfc8c49]!==undefined?_0x4f6fc7[_0xfc8c49]['toFixed'](0x2):'0',_0x3176dd=_0x5b4f07[_0xfc8c49]!==undefined?_0x5b4f07[_0xfc8c49][_0xd3ce8(0x2c4)](0x2):'0',_0x3cc00b=_0x3f5da4[_0xfc8c49]!==undefined?_0x3f5da4[_0xfc8c49]['toFixed'](0x2):'0',_0x464a69=_0x23f818[_0xfc8c49]!==undefined?_0x23f818[_0xfc8c49]['toFixed'](0x2):'0',_0x1f7a54=_0x341a9a[_0xfc8c49]!==undefined?_0x341a9a[_0xfc8c49]['toFixed'](0x2):'0',_0x3f40ee=_0x2bfbaa[_0xfc8c49]!==undefined?_0x2bfbaa[_0xfc8c49]['toFixed'](0x2):'0';_0x6454af=parseFloat(_0x269bf8)+parseFloat(_0x464a69),_0x155f4d=parseFloat(_0x3cc00b)+parseFloat(_0x3f40ee),_0x297bdb=parseFloat(_0x3176dd)+parseFloat(_0x1f7a54),_0x36a592+=_0xd3ce8(0x318),_0x36a592+=_0xd3ce8(0x318),_0x36a592+=_0xd3ce8(0x318);}_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x36a592+=_0xd3ce8(0x2c2),_0x36a592+=_0xd3ce8(0x2a5);for(let _0x54c53a=0x0;_0x54c53a<=_0x212171[_0xd3ce8(0x2bf)][_0xd3ce8(0x321)]-0x1;_0x54c53a++){const _0x1396bc=_0x212171['cat_brand'][_0x54c53a],_0x31c1e6=_0x1396bc[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)]+'-'+_0x1396bc[_0xd3ce8(0x226)]['category'];var _0x269bf8=_0x4f6fc7[_0x31c1e6]!==undefined?_0x4f6fc7[_0x31c1e6][_0xd3ce8(0x2c4)](0x2):'0',_0x3176dd=_0x5b4f07[_0x31c1e6]!==undefined?_0x5b4f07[_0x31c1e6][_0xd3ce8(0x2c4)](0x2):'0',_0x3cc00b=_0x3f5da4[_0x31c1e6]!==undefined?_0x3f5da4[_0x31c1e6][_0xd3ce8(0x2c4)](0x2):'0',_0x464a69=_0x23f818[_0x31c1e6]!==undefined?_0x23f818[_0x31c1e6]['toFixed'](0x2):'0',_0x1f7a54=_0x341a9a[_0x31c1e6]!==undefined?_0x341a9a[_0x31c1e6][_0xd3ce8(0x2c4)](0x2):'0',_0x3f40ee=_0x2bfbaa[_0x31c1e6]!==undefined?_0x2bfbaa[_0x31c1e6]['toFixed'](0x2):'0';_0x6454af=parseFloat(_0x269bf8)+parseFloat(_0x464a69),_0x155f4d=parseFloat(_0x3cc00b)+parseFloat(_0x3f40ee),_0x297bdb=parseFloat(_0x3176dd)+parseFloat(_0x1f7a54),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x29b),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x36a592+=_0xd3ce8(0x2a5);for(let _0x8662ef=0x0;_0x8662ef<=_0x212171[_0xd3ce8(0x2bf)][_0xd3ce8(0x321)]-0x1;_0x8662ef++){const _0x2ce57d=_0x212171[_0xd3ce8(0x2bf)][_0x8662ef],_0x6050f3=_0x2ce57d[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)]+'-'+_0x2ce57d['_id'][_0xd3ce8(0x2b6)];var _0x269bf8=_0x4f6fc7[_0x6050f3]!==undefined?_0x4f6fc7[_0x6050f3][_0xd3ce8(0x2c4)](0x2):'0',_0x3176dd=_0x5b4f07[_0x6050f3]!==undefined?_0x5b4f07[_0x6050f3][_0xd3ce8(0x2c4)](0x2):'0',_0x3cc00b=_0x3f5da4[_0x6050f3]!==undefined?_0x3f5da4[_0x6050f3][_0xd3ce8(0x2c4)](0x2):'0',_0x464a69=_0x23f818[_0x6050f3]!==undefined?_0x23f818[_0x6050f3][_0xd3ce8(0x2c4)](0x2):'0',_0x1f7a54=_0x341a9a[_0x6050f3]!==undefined?_0x341a9a[_0x6050f3][_0xd3ce8(0x2c4)](0x2):'0',_0x3f40ee=_0x2bfbaa[_0x6050f3]!==undefined?_0x2bfbaa[_0x6050f3][_0xd3ce8(0x2c4)](0x2):'0';_0x6454af=parseFloat(_0x269bf8)+parseFloat(_0x464a69),_0x155f4d=parseFloat(_0x3cc00b)+parseFloat(_0x3f40ee),_0x297bdb=parseFloat(_0x3176dd)+parseFloat(_0x1f7a54),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x36a592+=_0xd3ce8(0x318),_0x36a592+=_0xd3ce8(0x318);}_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x29b),_0x36a592+=_0xd3ce8(0x22c),_0x36a592+=_0xd3ce8(0x2a5);for(let _0x579230=0x0;_0x579230<=_0x212171['cat_brand'][_0xd3ce8(0x321)]-0x1;_0x579230++){const _0x287622=_0x212171[_0xd3ce8(0x2bf)][_0x579230],_0x2deb56=_0x287622[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)]+'-'+_0x287622['_id'][_0xd3ce8(0x2b6)];var _0x269bf8=_0x4f6fc7[_0x2deb56]!==undefined?_0x4f6fc7[_0x2deb56][_0xd3ce8(0x2c4)](0x2):'',_0x3176dd=_0x5b4f07[_0x2deb56]!==undefined?_0x5b4f07[_0x2deb56][_0xd3ce8(0x2c4)](0x2):'',_0x3cc00b=_0x3f5da4[_0x2deb56]!==undefined?_0x3f5da4[_0x2deb56][_0xd3ce8(0x2c4)](0x2):'',_0x464a69=_0x23f818[_0x2deb56]!==undefined?_0x23f818[_0x2deb56][_0xd3ce8(0x2c4)](0x2):'',_0x1f7a54=_0x341a9a[_0x2deb56]!==undefined?_0x341a9a[_0x2deb56][_0xd3ce8(0x2c4)](0x2):'',_0x3f40ee=_0x2bfbaa[_0x2deb56]!==undefined?_0x2bfbaa[_0x2deb56]['toFixed'](0x2):'';_0x6454af=formatNumber(parseFloat(_0x269bf8)+parseFloat(_0x464a69)),_0x155f4d=formatNumber(parseFloat(_0x3cc00b)+parseFloat(_0x3f40ee)),_0x297bdb=formatNumber(parseFloat(_0x3176dd)+parseFloat(_0x1f7a54)),_0x36a592+=_0xd3ce8(0x1fa)+_0x269bf8+_0xd3ce8(0x221),_0x36a592+=_0xd3ce8(0x1fa)+_0x3cc00b+'</b></td>',_0x36a592+=_0xd3ce8(0x1fa)+_0x3176dd+'</b></td>';}_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x201),_0x36a592+=_0xd3ce8(0x29b),_0x36a592+=_0xd3ce8(0x1d3),_0x36a592+=_0xd3ce8(0x2a5);for(let _0x21f4fe=0x0;_0x21f4fe<=_0x212171['cat_brand'][_0xd3ce8(0x321)]-0x1;_0x21f4fe++){const _0x32d9b5=_0x212171[_0xd3ce8(0x2bf)][_0x21f4fe],_0x1449dc=_0x32d9b5[_0xd3ce8(0x226)][_0xd3ce8(0x1bd)]+'-'+_0x32d9b5[_0xd3ce8(0x226)]['category'];var _0x269bf8=_0x4f6fc7[_0x1449dc]!==undefined?_0x4f6fc7[_0x1449dc][_0xd3ce8(0x2c4)](0x2):'0',_0x3176dd=_0x5b4f07[_0x1449dc]!==undefined?_0x5b4f07[_0x1449dc][_0xd3ce8(0x2c4)](0x2):'0',_0x3cc00b=_0x3f5da4[_0x1449dc]!==undefined?_0x3f5da4[_0x1449dc][_0xd3ce8(0x2c4)](0x2):'0',_0x464a69=_0x23f818[_0x1449dc]!==undefined?_0x23f818[_0x1449dc]['toFixed'](0x2):'0',_0x1f7a54=_0x341a9a[_0x1449dc]!==undefined?_0x341a9a[_0x1449dc]['toFixed'](0x2):'0',_0x3f40ee=_0x2bfbaa[_0x1449dc]!==undefined?_0x2bfbaa[_0x1449dc]['toFixed'](0x2):'0';_0x6454af=parseFloat(_0x269bf8)+parseFloat(_0x464a69),_0x155f4d=parseFloat(_0x3cc00b)+parseFloat(_0x3f40ee),_0x297bdb=parseFloat(_0x3176dd)+parseFloat(_0x1f7a54),_0x36a592+=_0xd3ce8(0x318),_0x36a592+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x36a592+=_0xd3ce8(0x318);}_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2a5),_0x36a592+=_0xd3ce8(0x2cd),_0x36a592+=_0xd3ce8(0x310),_0x36a592+=_0xd3ce8(0x230);}),_0x36a592;}async function generateReferenceNumber(_0x39dfdc,_0xa66227,_0x2e7a1e){const _0x4c0c58=a0_0x4a8536,_0x3f30ce=new Date(_0x39dfdc)[_0x4c0c58(0x273)](),_0x5e5be0=('0'+(new Date(_0x39dfdc)[_0x4c0c58(0x339)]()+0x1))['slice'](-0x2),_0x7dbd4e=('0'+new Date(_0x39dfdc)[_0x4c0c58(0x222)]())[_0x4c0c58(0x2c8)](-0x2),_0x1211be=await staff['findOne']({'email':_0x2e7a1e[_0x4c0c58(0x28c)]}),_0x25c16d=_0x1211be[_0x4c0c58(0x207)],_0x3ee6f2=_0x25c16d+'-'+_0x3f30ce+_0x5e5be0+_0x7dbd4e,_0x425532=await Reference[_0x4c0c58(0x1be)]({'referenceNumber':new RegExp('^'+_0x3ee6f2),'salesman_code':_0x25c16d})[_0x4c0c58(0x202)]({'createdAt':-0x1}),_0x476ad7=_0x3ee6f2;_0x425532&&(_0x476ad7=_0x425532['referenceNumber']);console[_0x4c0c58(0x241)](_0x476ad7);const _0x3c11bc=new Reference({'referenceNumber':_0x476ad7,'staff_id':_0xa66227,'salesman_code':_0x25c16d});return await _0x3c11bc[_0x4c0c58(0x1d2)](),_0x476ad7;}router['post'](a0_0x4a8536(0x212),auth,async(_0x23d78d,_0x5152cc)=>{const _0x3f1e41=a0_0x4a8536,{from_date:_0x16d26e,dataview:_0x19e7f6}=_0x23d78d['body'],_0x2d952a=_0x23d78d[_0x3f1e41(0x1d7)],_0x4479cb=await staff[_0x3f1e41(0x1be)]({'email':_0x2d952a['email']}),_0xd1db9c=await master_shop[_0x3f1e41(0x203)](),_0x2d2def='';var _0x2a824f=new Date(_0x16d26e);const _0xe21bb={'year':_0x3f1e41(0x234),'month':_0x3f1e41(0x295),'day':'numeric'},_0x1fc2e3=new Intl['DateTimeFormat'](_0x3f1e41(0x2bd),_0xe21bb)[_0x3f1e41(0x1e2)](_0x2a824f),_0x355d3b=await Reference[_0x3f1e41(0x203)]({'staff_id':_0x4479cb[_0x3f1e41(0x226)]['valueOf'](),'date_include':_0x16d26e});if(_0x355d3b[_0x3f1e41(0x321)]>0x0){let _0xad1f1d='';_0xad1f1d+=_0x355d3b[0x0][_0x3f1e41(0x2b2)];if(_0x19e7f6=='excel'){const _0x34c36e=cheerio[_0x3f1e41(0x31e)](_0xad1f1d);let _0x15473a=[],_0x4286d3=[],_0x3c3900=[];const _0x572417=_0x158ba3=>{const _0x26a10a=_0x3f1e41,_0x337dc4={'top':{'style':_0x26a10a(0x333),'color':{'rgb':_0x26a10a(0x224)}},'bottom':{'style':'thick','color':{'rgb':_0x26a10a(0x224)}},'left':{'style':_0x26a10a(0x333),'color':{'rgb':_0x26a10a(0x224)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x158ba3){const _0x4d05d3=_0x158ba3[_0x26a10a(0x253)](';')[_0x26a10a(0x32e)]((_0xfc774b,_0x433264)=>{const _0x3f4fbe=_0x26a10a,[_0x668de8,_0x1fdcc8]=_0x433264['split'](':')[_0x3f4fbe(0x232)](_0x2887e5=>_0x2887e5['trim']());return _0xfc774b[_0x668de8]=_0x1fdcc8,_0xfc774b;},{});_0x4d05d3[_0x26a10a(0x206)]&&(_0x337dc4[_0x26a10a(0x330)][_0x26a10a(0x258)]=_0x4d05d3['border-top']['includes'](_0x26a10a(0x20e))?'thin':'medium'),_0x4d05d3[_0x26a10a(0x316)]&&(_0x337dc4[_0x26a10a(0x332)][_0x26a10a(0x258)]=_0x4d05d3[_0x26a10a(0x316)][_0x26a10a(0x1ee)](_0x26a10a(0x20e))?_0x26a10a(0x20e):_0x26a10a(0x255)),_0x4d05d3['border-left']&&(_0x337dc4['left'][_0x26a10a(0x258)]=_0x4d05d3[_0x26a10a(0x24b)][_0x26a10a(0x1ee)](_0x26a10a(0x20e))?'thin':_0x26a10a(0x255)),_0x4d05d3[_0x26a10a(0x32f)]&&(_0x337dc4['right']['style']=_0x4d05d3['border-right'][_0x26a10a(0x1ee)]('thin')?_0x26a10a(0x20e):_0x26a10a(0x255));}return _0x337dc4;};_0x34c36e(_0x3f1e41(0x250))[_0x3f1e41(0x22a)]((_0x51c113,_0x1c8dd2)=>{const _0x19bbff=_0x3f1e41;let _0x4eb64a=[],_0x3496c3=0x0;while(_0x3c3900[_0x3496c3]){_0x3c3900[_0x3496c3]--,_0x3496c3++;}_0x34c36e(_0x1c8dd2)[_0x19bbff(0x203)](_0x19bbff(0x2ca))[_0x19bbff(0x22a)]((_0x5bcb76,_0xcad986)=>{const _0x2c49f8=_0x19bbff;let _0x1bbce1=_0x34c36e(_0xcad986)[_0x2c49f8(0x23f)]()[_0x2c49f8(0x24a)](),_0x177017=parseFloat(_0x1bbce1['replace'](/,/g,''));isNaN(_0x177017)&&(_0x177017=_0x1bbce1);let _0x1904f9=parseInt(_0x34c36e(_0xcad986)['attr'](_0x2c49f8(0x26b)))||0x1,_0x5bc21d=parseInt(_0x34c36e(_0xcad986)['attr'](_0x2c49f8(0x1b8)))||0x1;const _0x1cf491=_0x34c36e(_0xcad986)[_0x2c49f8(0x317)](_0x2c49f8(0x258)),_0x4d15e6=_0x572417(_0x1cf491);_0x4eb64a[_0x3496c3]={'v':_0x177017,'s':{'border':_0x4d15e6}};(_0x1904f9>0x1||_0x5bc21d>0x1)&&_0x4286d3[_0x2c49f8(0x205)]({'s':{'r':_0x51c113,'c':_0x3496c3},'e':{'r':_0x51c113+_0x5bc21d-0x1,'c':_0x3496c3+_0x1904f9-0x1}});for(let _0x1a0337=0x0;_0x1a0337<_0x1904f9;_0x1a0337++){_0x5bc21d>0x1&&(_0x3c3900[_0x3496c3+_0x1a0337]=_0x5bc21d-0x1);}_0x3496c3+=_0x1904f9;}),_0x15473a[_0x19bbff(0x205)](_0x4eb64a);});const _0x5aa7a5=XLSX[_0x3f1e41(0x2ce)]['book_new'](),_0xaec4dc=XLSX['utils'][_0x3f1e41(0x31c)](_0x15473a);_0x4286d3[_0x3f1e41(0x321)]>0x0&&(_0xaec4dc[_0x3f1e41(0x242)]=_0x4286d3);_0xaec4dc[_0x3f1e41(0x1f2)]=_0x15473a[0x0][_0x3f1e41(0x232)](()=>({'wpx':0x64})),XLSX[_0x3f1e41(0x2ce)]['book_append_sheet'](_0x5aa7a5,_0xaec4dc,_0x3f1e41(0x2af));const _0x307092=XLSX[_0x3f1e41(0x331)](_0x5aa7a5,{'bookType':_0x3f1e41(0x1f3),'type':'buffer'});_0x5152cc['setHeader'](_0x3f1e41(0x281),_0x3f1e41(0x20f)),_0x5152cc[_0x3f1e41(0x2a2)](_0x3f1e41(0x312),_0x3f1e41(0x2fd)),_0x5152cc[_0x3f1e41(0x223)](_0x307092);}else{let _0x36eb0b='';_0x36eb0b+=_0xad1f1d,_0x36eb0b+=_0x3f1e41(0x1e9),_0x36eb0b+=_0x3f1e41(0x260),_0x36eb0b+='window.print();',_0x36eb0b+='};',_0x36eb0b+=_0x3f1e41(0x334),_0x5152cc[_0x3f1e41(0x223)](_0x36eb0b);}}else generateReferenceNumber(_0x16d26e,_0x4479cb[_0x3f1e41(0x226)][_0x3f1e41(0x2ab)](),_0x2d952a)[_0x3f1e41(0x262)](async _0x1300c4=>{const _0x7df086=_0x3f1e41,_0x52db52=await agentsdataDSICheck_DSRR(_0x16d26e,_0x4479cb[_0x7df086(0x226)][_0x7df086(0x2ab)](),_0x2d2def,_0x1300c4);console[_0x7df086(0x241)](_0x52db52);let _0x290b07='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x290b07+=_0x7df086(0x238),_0x290b07+=_0x7df086(0x1b7),_0x290b07+=_0x7df086(0x2be),_0x290b07+=_0x52db52,_0x290b07+='</table>',_0x290b07+=_0x7df086(0x285),_0x290b07+='</div>';if(_0x52db52[_0x7df086(0x321)]>0x0){const _0x4cf6c5=await Reference[_0x7df086(0x1be)]({'staff_id':_0x4479cb[_0x7df086(0x226)][_0x7df086(0x2ab)](),'referenceNumber':_0x1300c4});_0x4cf6c5[_0x7df086(0x2b2)]=_0x290b07,_0x4cf6c5[_0x7df086(0x2f0)]=_0x16d26e,await _0x4cf6c5[_0x7df086(0x1d2)]();if(_0x19e7f6==_0x7df086(0x2a9)){const _0x7d7e20=cheerio[_0x7df086(0x31e)](_0x290b07);let _0x284bcb=[],_0x37cf40=[],_0x4857c0=[];const _0x59616b=_0x2ac3c7=>{const _0x50b72a=_0x7df086,_0x20d7ec={'top':{'style':_0x50b72a(0x333),'color':{'rgb':_0x50b72a(0x224)}},'bottom':{'style':'thick','color':{'rgb':_0x50b72a(0x224)}},'left':{'style':_0x50b72a(0x333),'color':{'rgb':_0x50b72a(0x224)}},'right':{'style':'thick','color':{'rgb':_0x50b72a(0x224)}}};if(_0x2ac3c7){const _0x2743a3=_0x2ac3c7[_0x50b72a(0x253)](';')['reduce']((_0x30782e,_0x3263fd)=>{const _0x46e21a=_0x50b72a,[_0x1a8a3e,_0x46c826]=_0x3263fd[_0x46e21a(0x253)](':')[_0x46e21a(0x232)](_0x54b747=>_0x54b747[_0x46e21a(0x24a)]());return _0x30782e[_0x1a8a3e]=_0x46c826,_0x30782e;},{});_0x2743a3[_0x50b72a(0x206)]&&(_0x20d7ec[_0x50b72a(0x330)][_0x50b72a(0x258)]=_0x2743a3[_0x50b72a(0x206)][_0x50b72a(0x1ee)]('thin')?_0x50b72a(0x20e):_0x50b72a(0x255)),_0x2743a3['border-bottom']&&(_0x20d7ec[_0x50b72a(0x332)]['style']=_0x2743a3['border-bottom'][_0x50b72a(0x1ee)](_0x50b72a(0x20e))?_0x50b72a(0x20e):_0x50b72a(0x255)),_0x2743a3[_0x50b72a(0x24b)]&&(_0x20d7ec[_0x50b72a(0x2f9)][_0x50b72a(0x258)]=_0x2743a3[_0x50b72a(0x24b)]['includes']('thin')?_0x50b72a(0x20e):'medium'),_0x2743a3[_0x50b72a(0x32f)]&&(_0x20d7ec[_0x50b72a(0x209)]['style']=_0x2743a3[_0x50b72a(0x32f)][_0x50b72a(0x1ee)]('thin')?_0x50b72a(0x20e):'medium');}return _0x20d7ec;};_0x7d7e20('table\x20tr')[_0x7df086(0x22a)]((_0x532296,_0x5042e8)=>{const _0x3f3e09=_0x7df086;let _0x5d1205=[],_0x14e1ba=0x0;while(_0x4857c0[_0x14e1ba]){_0x4857c0[_0x14e1ba]--,_0x14e1ba++;}_0x7d7e20(_0x5042e8)[_0x3f3e09(0x203)]('td,\x20th')[_0x3f3e09(0x22a)]((_0x31e448,_0x18cfe4)=>{const _0x413f45=_0x3f3e09;let _0x595b60=_0x7d7e20(_0x18cfe4)[_0x413f45(0x23f)]()[_0x413f45(0x24a)](),_0x24829f=parseFloat(_0x595b60[_0x413f45(0x263)](/,/g,''));isNaN(_0x24829f)&&(_0x24829f=_0x595b60);let _0x5c25e9=parseInt(_0x7d7e20(_0x18cfe4)[_0x413f45(0x317)](_0x413f45(0x26b)))||0x1,_0x3b2bd1=parseInt(_0x7d7e20(_0x18cfe4)[_0x413f45(0x317)]('rowspan'))||0x1;const _0xf41141=_0x7d7e20(_0x18cfe4)[_0x413f45(0x317)](_0x413f45(0x258)),_0x24dc92=_0x59616b(_0xf41141);_0x5d1205[_0x14e1ba]={'v':_0x24829f,'s':{'border':_0x24dc92}};(_0x5c25e9>0x1||_0x3b2bd1>0x1)&&_0x37cf40[_0x413f45(0x205)]({'s':{'r':_0x532296,'c':_0x14e1ba},'e':{'r':_0x532296+_0x3b2bd1-0x1,'c':_0x14e1ba+_0x5c25e9-0x1}});for(let _0x2da8df=0x0;_0x2da8df<_0x5c25e9;_0x2da8df++){_0x3b2bd1>0x1&&(_0x4857c0[_0x14e1ba+_0x2da8df]=_0x3b2bd1-0x1);}_0x14e1ba+=_0x5c25e9;}),_0x284bcb['push'](_0x5d1205);});const _0x389091=XLSX[_0x7df086(0x2ce)]['book_new'](),_0x322cbd=XLSX[_0x7df086(0x2ce)]['aoa_to_sheet'](_0x284bcb);_0x37cf40['length']>0x0&&(_0x322cbd['!merges']=_0x37cf40);_0x322cbd['!cols']=_0x284bcb[0x0][_0x7df086(0x232)](()=>({'wpx':0x64})),XLSX[_0x7df086(0x2ce)]['book_append_sheet'](_0x389091,_0x322cbd,_0x7df086(0x2af));const _0x3e778f=XLSX[_0x7df086(0x331)](_0x389091,{'bookType':_0x7df086(0x1f3),'type':'buffer'});_0x5152cc[_0x7df086(0x2a2)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x5152cc[_0x7df086(0x2a2)](_0x7df086(0x312),_0x7df086(0x2fd)),_0x5152cc[_0x7df086(0x223)](_0x3e778f);}else _0x290b07+='<script>',_0x290b07+=_0x7df086(0x260),_0x290b07+=_0x7df086(0x2f7),_0x290b07+='};',_0x290b07+=_0x7df086(0x334),_0x5152cc['send'](_0x290b07);}else await Reference[_0x7df086(0x20a)]({'referenceNumber':_0x1300c4}),_0x23d78d[_0x7df086(0x1f7)](_0x7df086(0x340),'No\x20data\x20was\x20Found!'),_0x5152cc[_0x7df086(0x1f0)]('/reports/dsrr/view');})[_0x3f1e41(0x1c8)](console[_0x3f1e41(0x2d7)]);}),router[a0_0x4a8536(0x1de)](a0_0x4a8536(0x30c),auth,async(_0x2307a6,_0x3994ad)=>{const _0x590e01=a0_0x4a8536;try{const {username:_0x33b7f6,email:_0x2965b2,role:_0x4ef560}=_0x2307a6[_0x590e01(0x1d7)],_0x22e7f8=_0x2307a6[_0x590e01(0x1d7)],_0xd56a2e=await profile['findOne']({'email':_0x22e7f8['email']}),_0x41b79e={'year':_0x590e01(0x234),'month':_0x590e01(0x295),'day':_0x590e01(0x234)},_0x153d02=await master_shop[_0x590e01(0x203)]();console[_0x590e01(0x241)]('Products\x20master',_0x153d02);const _0x582946=await product['find']();console['log'](_0x590e01(0x324),_0x582946);const _0x2a788c=await warehouse[_0x590e01(0x228)]([{'$unwind':_0x590e01(0x311)},{'$lookup':{'from':_0x590e01(0x26e),'localField':_0x590e01(0x27c),'foreignField':'name','as':_0x590e01(0x2a0)}},{'$unwind':_0x590e01(0x249)},{'$project':{'product_name':_0x590e01(0x20b),'product_stock':_0x590e01(0x2d2)}},{'$group':{'_id':_0x590e01(0x1d1),'product_stock':{'$sum':'$product_stock'}}}]);console['log']('Products\x20warehouse_data',_0x2a788c),_0x2a788c[_0x590e01(0x276)](_0x4e8750=>{const _0x2484c2=_0x590e01,_0x590d08=_0x582946[_0x2484c2(0x232)](_0x2a6baf=>{const _0x213581=_0x2484c2;_0x2a6baf[_0x213581(0x30b)]==_0x4e8750[_0x213581(0x226)]&&(_0x2a6baf['stock']=parseInt(_0x2a6baf[_0x213581(0x27a)])+parseInt(_0x4e8750['product_stock']));});});const _0x19b883=await staff[_0x590e01(0x203)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x5a0ddd=await staff[_0x590e01(0x1be)]({'email':_0x22e7f8[_0x590e01(0x28c)]});if(_0x153d02[0x0][_0x590e01(0x33a)]==_0x590e01(0x23b))var _0x3c08d6=users[_0x590e01(0x1f8)];else{if(_0x153d02[0x0][_0x590e01(0x33a)]==_0x590e01(0x236))var _0x3c08d6=users[_0x590e01(0x236)];else{if(_0x153d02[0x0][_0x590e01(0x33a)]==_0x590e01(0x279))var _0x3c08d6=users[_0x590e01(0x279)];else{if(_0x153d02[0x0][_0x590e01(0x33a)]==_0x590e01(0x2ff))var _0x3c08d6=users[_0x590e01(0x2ff)];else{if(_0x153d02[0x0]['language']=='French')var _0x3c08d6=users[_0x590e01(0x284)];else{if(_0x153d02[0x0]['language']==_0x590e01(0x31b))var _0x3c08d6=users[_0x590e01(0x315)];else{if(_0x153d02[0x0][_0x590e01(0x33a)]==_0x590e01(0x2f3))var _0x3c08d6=users[_0x590e01(0x2f3)];else{if(_0x153d02[0x0][_0x590e01(0x33a)]==_0x590e01(0x288))var _0x3c08d6=users[_0x590e01(0x1ba)];}}}}}}}_0x3994ad[_0x590e01(0x251)](_0x590e01(0x2e1),{'success':_0x2307a6['flash'](_0x590e01(0x32d)),'errors':_0x2307a6[_0x590e01(0x1f7)]('errors'),'alldata':_0x582946,'profile':_0xd56a2e,'master_shop':_0x153d02,'role':_0x22e7f8,'product_stock':_0x2a788c,'language':_0x3c08d6,'staff_arr':_0x5a0ddd,'staff_data_all':_0x19b883});}catch(_0x5d5a24){}}),router[a0_0x4a8536(0x265)](a0_0x4a8536(0x1f1),auth,async(_0x2f7658,_0x502920)=>{const _0x281560=a0_0x4a8536;try{const {from:_0x4aed5e,to:_0x36494e,staff_data:_0x3ecf0b}=_0x2f7658['body'],_0xf7faef=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x4aed5e,'$lte':_0x36494e},'staff_id':_0x3ecf0b}},{'$sort':{'date_include':0x1}}]);_0x502920[_0x281560(0x314)](_0xf7faef);}catch(_0x53dbb1){_0x502920[_0x281560(0x314)](_0x53dbb1);}}),router[a0_0x4a8536(0x265)](a0_0x4a8536(0x1ec),auth,async(_0x2c7b6b,_0x2c8b79)=>{const _0x58d64a=a0_0x4a8536;try{const {from:_0x2da815,to:_0x3502e2}=_0x2c7b6b[_0x58d64a(0x308)],{sttaff_id:_0x1db9e8}=_0x2c7b6b[_0x58d64a(0x1d7)],_0x231bc9=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x2da815,'$lte':_0x3502e2},'staff_id':_0x1db9e8}},{'$sort':{'date_include':0x1}}]);_0x2c8b79[_0x58d64a(0x314)](_0x231bc9);}catch(_0x172253){_0x2c8b79['json'](_0x172253);}}),router['get']('/dsrr_admin/view_data/:id',auth,async(_0x28df93,_0xaa74e0)=>{const _0x24df4b=a0_0x4a8536;try{const _0x7b82b5=_0x28df93['params']['id'],_0xb44b35=await Reference['findById'](_0x7b82b5);let _0x1c4108='';_0x1c4108+=_0xb44b35[_0x24df4b(0x2b2)],_0x1c4108+='<script>',_0x1c4108+='window.onload\x20=\x20function()\x20{',_0x1c4108+=_0x24df4b(0x2f7),_0x1c4108+='};',_0x1c4108+=_0x24df4b(0x334),_0xaa74e0['send'](_0x1c4108);}catch(_0x57c1a5){_0xaa74e0[_0x24df4b(0x314)](_0x57c1a5);}}),router[a0_0x4a8536(0x265)](a0_0x4a8536(0x1d8),auth,async(_0x239f55,_0x378867)=>{const _0x10d0ed=a0_0x4a8536;try{const {ref_data:_0x20b42a}=_0x239f55[_0x10d0ed(0x308)],_0x1a6eef=_0x20b42a[_0x10d0ed(0x253)]('~'),_0x3be984=_0x1a6eef[_0x10d0ed(0x1f6)](_0x13c68e=>_0x13c68e!==''),_0x244c66=await Reference[_0x10d0ed(0x228)]([{'$match':{'referenceNumber':{'$in':_0x3be984}}}]),_0x25afed=XLSX[_0x10d0ed(0x2ce)][_0x10d0ed(0x225)]();_0x244c66['forEach'](_0x132058=>{const _0x9852f3=_0x10d0ed,_0x45482f=cheerio['load'](_0x132058[_0x9852f3(0x2b2)]);let _0x55d309=[],_0x47a281=[],_0x4f4d8e=[];_0x45482f(_0x9852f3(0x250))['each']((_0x36c8f4,_0x400d7d)=>{const _0x2d741a=_0x9852f3;let _0x107046=[],_0x1dd4a9=0x0;while(_0x4f4d8e[_0x1dd4a9]){_0x4f4d8e[_0x1dd4a9]--,_0x1dd4a9++;}_0x45482f(_0x400d7d)[_0x2d741a(0x203)]('td,\x20th')[_0x2d741a(0x22a)]((_0x2e9bca,_0x361ddd)=>{const _0x3a3a2c=_0x2d741a;let _0x183c49=_0x45482f(_0x361ddd)['text']()['trim'](),_0x264f76=parseFloat(_0x183c49['replace'](/,/g,''));isNaN(_0x264f76)&&(_0x264f76=_0x183c49);let _0x5b05ff=parseInt(_0x45482f(_0x361ddd)[_0x3a3a2c(0x317)](_0x3a3a2c(0x26b)))||0x1,_0x4b9982=parseInt(_0x45482f(_0x361ddd)['attr'](_0x3a3a2c(0x1b8)))||0x1;_0x107046[_0x1dd4a9]=_0x264f76;(_0x5b05ff>0x1||_0x4b9982>0x1)&&_0x47a281[_0x3a3a2c(0x205)]({'s':{'r':_0x36c8f4,'c':_0x1dd4a9},'e':{'r':_0x36c8f4+_0x4b9982-0x1,'c':_0x1dd4a9+_0x5b05ff-0x1}});for(let _0x49735a=0x0;_0x49735a<_0x5b05ff;_0x49735a++){_0x4b9982>0x1&&(_0x4f4d8e[_0x1dd4a9+_0x49735a]=_0x4b9982-0x1);}_0x1dd4a9+=_0x5b05ff;}),_0x55d309['push'](_0x107046);});const _0x2425f3=XLSX[_0x9852f3(0x2ce)][_0x9852f3(0x31c)](_0x55d309);_0x47a281['length']>0x0&&(_0x2425f3[_0x9852f3(0x242)]=_0x47a281),_0x2425f3[_0x9852f3(0x1f2)]=_0x55d309[0x0][_0x9852f3(0x232)](()=>({'wpx':0x64})),XLSX[_0x9852f3(0x2ce)]['book_append_sheet'](_0x25afed,_0x2425f3,_0x132058['referenceNumber']);});const _0xf40dad=XLSX['write'](_0x25afed,{'bookType':_0x10d0ed(0x1f3),'type':_0x10d0ed(0x2b5)});_0x378867[_0x10d0ed(0x2a2)](_0x10d0ed(0x281),_0x10d0ed(0x31f)),_0x378867[_0x10d0ed(0x2a2)]('Content-Type',_0x10d0ed(0x2fd)),_0x378867[_0x10d0ed(0x223)](_0xf40dad);}catch(_0x319793){_0x378867['json'](_0x319793);}}),router[a0_0x4a8536(0x265)]('/dsrr_admin/pdf_admin',auth,async(_0x203e2f,_0x4bca6c)=>{const _0x3ffdce=a0_0x4a8536,{from_date:_0x2ccf4f,agent_id:_0x3e0ffa}=_0x203e2f[_0x3ffdce(0x308)],_0x5bc1c6=_0x203e2f[_0x3ffdce(0x1d7)],_0x5e6250=await staff[_0x3ffdce(0x1be)]({'email':_0x5bc1c6['email']}),_0x285a1d=await master_shop[_0x3ffdce(0x203)](),_0x3370b7=await agentsdataDSICheck_DSRR(_0x2ccf4f,_0x3e0ffa,_0x168299);let _0x5af0a1=_0x3ffdce(0x1fc);var _0x42003e=new Date(_0x2ccf4f);const _0x1e3465={'year':'numeric','month':_0x3ffdce(0x295),'day':_0x3ffdce(0x234)},_0x5d9385=new Intl[(_0x3ffdce(0x1c5))](_0x3ffdce(0x2bd),_0x1e3465)[_0x3ffdce(0x1e2)](_0x42003e);_0x5af0a1+=_0x3ffdce(0x238),_0x5af0a1+=_0x3ffdce(0x1b7),_0x5af0a1+=_0x3ffdce(0x2be),_0x5af0a1+=_0x3370b7,_0x5af0a1+=_0x3ffdce(0x230),_0x5af0a1+=_0x3ffdce(0x285),_0x5af0a1+=_0x3ffdce(0x285);let _0x10c742=_0x3ffdce(0x243);const _0x303899={'width':_0x3ffdce(0x271),'height':_0x3ffdce(0x28a),'orientation':'landscape','border':{'top':'0.1in','right':_0x3ffdce(0x29d),'bottom':_0x3ffdce(0x29d),'left':_0x3ffdce(0x29d)},'header':{'height':_0x3ffdce(0x1d5),'contents':_0x3ffdce(0x1d9)+_0x10c742+_0x3ffdce(0x22b)+_0x5d9385+_0x3ffdce(0x211)},'footer':{'height':_0x3ffdce(0x2cc),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3ffdce(0x24d)}}};var _0x168299='on';if(_0x168299=='on'){const _0x1e2837=cheerio[_0x3ffdce(0x31e)](_0x5af0a1);let _0x57a6f0=[],_0x4d0558=[],_0x299a91=[];_0x1e2837(_0x3ffdce(0x250))[_0x3ffdce(0x22a)]((_0x42b331,_0x12245d)=>{const _0x56f02e=_0x3ffdce;let _0x12b8f4=[],_0x3f91cc=0x0;while(_0x299a91[_0x3f91cc]){_0x299a91[_0x3f91cc]--,_0x3f91cc++;}_0x1e2837(_0x12245d)[_0x56f02e(0x203)](_0x56f02e(0x2ca))['each']((_0xa1f50c,_0x1ea7b0)=>{const _0xc3319f=_0x56f02e;let _0xc19443=_0x1e2837(_0x1ea7b0)[_0xc3319f(0x23f)]()['trim'](),_0x4ecc00=parseFloat(_0xc19443['replace'](/,/g,''));isNaN(_0x4ecc00)&&(_0x4ecc00=_0xc19443);let _0x44d67b=parseInt(_0x1e2837(_0x1ea7b0)[_0xc3319f(0x317)](_0xc3319f(0x26b)))||0x1,_0x8d712f=parseInt(_0x1e2837(_0x1ea7b0)[_0xc3319f(0x317)](_0xc3319f(0x1b8)))||0x1;_0x12b8f4[_0x3f91cc]=_0x4ecc00;(_0x44d67b>0x1||_0x8d712f>0x1)&&_0x4d0558[_0xc3319f(0x205)]({'s':{'r':_0x42b331,'c':_0x3f91cc},'e':{'r':_0x42b331+_0x8d712f-0x1,'c':_0x3f91cc+_0x44d67b-0x1}});for(let _0x393a37=0x0;_0x393a37<_0x44d67b;_0x393a37++){_0x8d712f>0x1&&(_0x299a91[_0x3f91cc+_0x393a37]=_0x8d712f-0x1);}_0x3f91cc+=_0x44d67b;}),_0x57a6f0[_0x56f02e(0x205)](_0x12b8f4);});const _0x5bd1ab=XLSX[_0x3ffdce(0x2ce)][_0x3ffdce(0x225)](),_0x4e03b2=XLSX[_0x3ffdce(0x2ce)][_0x3ffdce(0x31c)](_0x57a6f0);_0x4d0558[_0x3ffdce(0x321)]>0x0&&(_0x4e03b2[_0x3ffdce(0x242)]=_0x4d0558);_0x4e03b2[_0x3ffdce(0x1f2)]=_0x57a6f0[0x0][_0x3ffdce(0x232)](()=>({'wpx':0x64})),XLSX[_0x3ffdce(0x2ce)][_0x3ffdce(0x292)](_0x5bd1ab,_0x4e03b2,'Sales\x20Report');const _0x163a22=XLSX['write'](_0x5bd1ab,{'bookType':'xlsx','type':_0x3ffdce(0x2b5)});_0x4bca6c[_0x3ffdce(0x2a2)](_0x3ffdce(0x281),_0x3ffdce(0x20f)),_0x4bca6c[_0x3ffdce(0x2a2)](_0x3ffdce(0x312),_0x3ffdce(0x2fd)),_0x4bca6c[_0x3ffdce(0x223)](_0x163a22);}else pdf['create'](_0x5af0a1,_0x303899)['toStream'](function(_0xdbd0a5,_0x4c041e){const _0x3cc80f=_0x3ffdce;if(_0xdbd0a5){_0x4bca6c[_0x3cc80f(0x2d8)](0x1f4)[_0x3cc80f(0x223)](_0x3cc80f(0x219));return;}_0x4bca6c[_0x3cc80f(0x2a2)]('Content-Type',_0x3cc80f(0x338)),_0x4c041e[_0x3cc80f(0x1bf)](_0x4bca6c);});}),module['exports']=router;function a0_0x26c3(){const _0x33adce=['setDate','295FavyBu','buffer','category','6670147QuntnD','$product_code','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','salesman_data','en-US','<table>','cat_brand','<th\x20rowspan=\x272\x27>Products</th>','$cash','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','Standard','toFixed','date','$product.product_name','$products.adj_discount','slice','Checking:\x20','td,\x20th','totalQty','20mm','</tr>','utils','$product','$check_no','$adj_discount','$product_details.product_stock','$sale_product.adj_discount','$product.product_code','$products.NetPrice','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','error','status','\x22><b></b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','$sales_info','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<th>\x20ENDING\x20BALANCE\x20</th>','$sale_product','/agent/view','dssr_view_admin','isFG','<td\x20class=\x22cat_data\x22><b>FG</b></td>','path','sales_staff_id','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$customer','$products.qty','due_date','total','$_id.customer','2931254nCTiwb','exceljs','\x20-\x20STD','totalQTY','date_include','$sale_product.totalprice','136254RyhRwE','Chinese','$bank','dsi','10TPRJWb','window.print();','$sale_product.prod_cat','left','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','<th>\x20INVOICE\x20AMOUNT\x20</th>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','$totalGross','Spanish','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$sale_product.quantity','PDF\x20Generation\x20Error:','<td\x20class=\x22cat_data\x22></td>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','\x20<>\x20','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','<td\x20class=\x22row_data\x22></td>','body','Asia/Manila','$_id.dsi','name','/dsrr_admin/view','<th>\x20BEG\x20BALANCE\x20</th>','check_no','sumqty','</tbody>','$product_details','Content-Type','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','json','Portuguese','border-bottom','attr','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','Portuguese\x20(BR)','aoa_to_sheet','<tbody>','load','attachment;\x20filename=\x22reports.xlsx\x22','amount','length','toLocaleDateString','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','Products\x20find_data','$product.quantity','discount','brandCount','Household','\x22><b>','$product_list','$products.product_details.category','589294Crduyu','success','reduce','border-right','top','write','bottom','thick','</script>','/agent_reports/pdf','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','application/pdf','getMonth','language','Products\x20master','prod_cat','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','$product_info','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','errors','<div\x20\x20id=\x22table-conatainer\x22>','rowspan','Letter','Arabic','isArray','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','brand','findOne','pipe','$product_info.name','Types','12481DOAGcf','$sales_info._id','$products.product_details.gross_price','DateTimeFormat','<td\x20class=\x22row_data\x22>0</td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','catch','../middleware/auth','<th>Booking</th>','<div\x20class=\x22col-sm-11\x22>','staffs','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','adj_discount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','$product_name','save','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','sales_bkg','60mm','12hrasJE','user','/dl_excel','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','product_stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','$status_data','get','cheerio','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','<p>INVENTORY\x20SUMMARY</p>','format','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','$products.product_details','create','$brand','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','/agent_reports/sales_ad','<script>','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','/getDSSR_no_sales','$amount','includes','sales_info','redirect','/getDSSR_no','!cols','xlsx','sale_product.product_code','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','filter','flash','English','<p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','html-pdf','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$sale_product.product_name','false','product_details','<td\x20colspan=\x223\x22><b>TOTAL<b>','<tr>','sort','find','true','push','border-top','sales_man_code','</td>','right','deleteOne','$product_details.product_name','$NetPrice','\x20-\x20HH','thin','attachment;\x20filename=\x22sales_report.xlsx\x22','$due_date','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','/dsrr/pdf','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','mongoose','496brZAge','blob-stream','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','$sale_product.isFG','Error\x20generating\x20PDF','$sale_product._id','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','$category','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','/total_sales_reports/view','$date','<thead>','</b></td>','getDate','send','000000','book_new','_id','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','aggregate','$_id.category','each','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','\x20-\x20','$totalQty','</table>','$product_info.brand','map','</thead>','numeric','Products\x20warehouse_data','Hindi','$products.product_details.prod_id','<div\x20class=\x22row\x22>','dsi_sales','dataqty','English\x20(US)','$product_info.category','cash','/inventory_sum/pdf','text','$product_info.gross_price','log','!merges','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','totalPrice','$sale_product.product_code','product_info','<td\x20class=\x22row_data\x22><b>','$dsi','$product_docs','trim','border-left','/balance/view','/dev/null','$product_stock','toISOString','table\x20tr','render','$discount','split','toLocaleString','medium','Router','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','style','</th>','<td\x20class=\x22row_data\x22>','<th>\x20QTY\x20SOLD\x20</th>','NetPrice','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','../public/language/languages.json','window.onload\x20=\x20function()\x20{','<div\x20style=\x22page-break-before:\x20always;\x22></div>','then','replace','\x22\x20class=\x22cat_data\x22>','post','<th>\x20INCOMING\x20</th>','$products.discount','multer','$_id.date','</p>','colspan','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','dssr_view','products','sales_ext','$sale_product.stock','15in','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','getFullYear','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','$products','forEach','<td\x20class=\x22cat_data\x22>','$product_info.product_code','German','stock','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','product_details.product_name','../models/all_models','<td\x20colspan=\x22','/total_sales_reports/pdf','product_code','Content-Disposition','customer','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','French','</div>','$sales_staff_id','<th\x20rowspan=\x272\x27>Production</th>','Arabic\x20(ae)','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','8.5in','$_id.brand','email','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<th>\x20ITEM\x20CODE\x20</th>','$_id.status_data','totalQTYsum','inventory_sum','book_append_sheet','product_name','landscape','long','$name','NumberFormat','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','pdfkit-table','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','totalGross','0.1in','ObjectId','$products.product_details.brand','product_docs','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','setHeader','beg_bal','toStream','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','<p>FINISHED\x20GOODS\x20INVENTORY</p>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','express','excel','11320767DWnFyp','valueOf','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','qty','$sale_product.real_qty_unit_val','Sales\x20Report','610773IObibE','$sale_product.discount','html'];a0_0x26c3=function(){return _0x33adce;};return a0_0x26c3();}