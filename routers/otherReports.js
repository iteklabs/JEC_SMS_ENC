const a0_0x45d816=a0_0x3d75;(function(_0x5774fc,_0x86ca1b){const _0x5164ff=a0_0x3d75,_0x86fbff=_0x5774fc();while(!![]){try{const _0x46261d=-parseInt(_0x5164ff(0x2ec))/0x1+-parseInt(_0x5164ff(0x242))/0x2+parseInt(_0x5164ff(0x34b))/0x3+parseInt(_0x5164ff(0x313))/0x4+parseInt(_0x5164ff(0x21d))/0x5*(-parseInt(_0x5164ff(0x236))/0x6)+parseInt(_0x5164ff(0x257))/0x7+parseInt(_0x5164ff(0x229))/0x8;if(_0x46261d===_0x86ca1b)break;else _0x86fbff['push'](_0x86fbff['shift']());}catch(_0x564d04){_0x86fbff['push'](_0x86fbff['shift']());}}}(a0_0x5af8,0xaf025));const express=require(a0_0x45d816(0x2c0)),res=require('express/lib/response'),app=express(),router=express[a0_0x45d816(0x244)](),multer=require(a0_0x45d816(0x344)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require(a0_0x45d816(0x1fe)),users=require(a0_0x45d816(0x233)),excelJS=require(a0_0x45d816(0x2a0)),XLSX=require(a0_0x45d816(0x2c8)),PDFDocument=require(a0_0x45d816(0x282)),fs=require('fs'),blobStream=require(a0_0x45d816(0x2c2)),JsBarcode=require('jsbarcode'),{Canvas}=require(a0_0x45d816(0x353)),pdf=require(a0_0x45d816(0x29f)),path=require(a0_0x45d816(0x227)),mongoose=require(a0_0x45d816(0x309)),cheerio=require('cheerio');router[a0_0x45d816(0x2bf)](a0_0x45d816(0x308),auth,async(_0x37f11f,_0x5569c0)=>{const _0x5a253f=a0_0x45d816;try{const {username:_0x299717,email:_0x2cf50d,role:_0x321d88}=_0x37f11f['user'],_0x400cce=_0x37f11f[_0x5a253f(0x350)],_0x1ef3fd=await profile[_0x5a253f(0x2d1)]({'email':_0x400cce[_0x5a253f(0x285)]}),_0x50f3e7={'year':_0x5a253f(0x2d2),'month':'long','day':_0x5a253f(0x2d2)},_0x59d4ba=await master_shop['find']();console['log']('Products\x20master',_0x59d4ba);const _0xb12ec5=await product[_0x5a253f(0x343)]();console[_0x5a253f(0x1fd)](_0x5a253f(0x317),_0xb12ec5);const _0x5e66d7=await warehouse[_0x5a253f(0x31d)]([{'$unwind':_0x5a253f(0x202)},{'$lookup':{'from':'products','localField':_0x5a253f(0x331),'foreignField':'name','as':_0x5a253f(0x34f)}},{'$unwind':_0x5a253f(0x232)},{'$project':{'product_name':_0x5a253f(0x2df),'product_stock':_0x5a253f(0x290)}},{'$group':{'_id':_0x5a253f(0x361),'product_stock':{'$sum':_0x5a253f(0x1ea)}}}]);console[_0x5a253f(0x1fd)](_0x5a253f(0x358),_0x5e66d7),_0x5e66d7[_0x5a253f(0x2e8)](_0x2c6f99=>{const _0x388994=_0xb12ec5['map'](_0x59cb49=>{const _0x17f2f8=a0_0x3d75;_0x59cb49[_0x17f2f8(0x219)]==_0x2c6f99[_0x17f2f8(0x209)]&&(_0x59cb49[_0x17f2f8(0x32b)]=parseInt(_0x59cb49[_0x17f2f8(0x32b)])+parseInt(_0x2c6f99[_0x17f2f8(0x1e8)]));});}),console[_0x5a253f(0x1fd)]('Products\x20find_data',_0xb12ec5);if(_0x59d4ba[0x0][_0x5a253f(0x32c)]==_0x5a253f(0x2fd))var _0x3aa4cd=users[_0x5a253f(0x2dc)];else{if(_0x59d4ba[0x0][_0x5a253f(0x32c)]==_0x5a253f(0x2bc))var _0x3aa4cd=users['Hindi'];else{if(_0x59d4ba[0x0][_0x5a253f(0x32c)]=='German')var _0x3aa4cd=users[_0x5a253f(0x355)];else{if(_0x59d4ba[0x0][_0x5a253f(0x32c)]==_0x5a253f(0x24f))var _0x3aa4cd=users['Spanish'];else{if(_0x59d4ba[0x0]['language']==_0x5a253f(0x253))var _0x3aa4cd=users['French'];else{if(_0x59d4ba[0x0][_0x5a253f(0x32c)]==_0x5a253f(0x2b0))var _0x3aa4cd=users[_0x5a253f(0x2f8)];else{if(_0x59d4ba[0x0][_0x5a253f(0x32c)]==_0x5a253f(0x33d))var _0x3aa4cd=users[_0x5a253f(0x33d)];else{if(_0x59d4ba[0x0]['language']==_0x5a253f(0x2ff))var _0x3aa4cd=users[_0x5a253f(0x32a)];}}}}}}}_0x5569c0[_0x5a253f(0x31a)](_0x5a253f(0x2fb),{'success':_0x37f11f['flash'](_0x5a253f(0x315)),'errors':_0x37f11f['flash'](_0x5a253f(0x235)),'alldata':_0xb12ec5,'profile':_0x1ef3fd,'master_shop':_0x59d4ba,'role':_0x400cce,'product_stock':_0x5e66d7,'language':_0x3aa4cd});}catch(_0x183f7d){}});async function dataCheck(_0x2d4a98,_0x40f68d){const _0x5c1cff=a0_0x45d816,_0x1b74ac=await product[_0x5c1cff(0x31d)]([{'$group':{'_id':{'brand':_0x5c1cff(0x319),'category':'$category'},'products':{'$push':{'name':_0x5c1cff(0x342),'product_code':_0x5c1cff(0x28e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x118680=[];_0x118680[_0x5c1cff(0x327)]=[];for(let _0x10ee27=0x0;_0x10ee27<=_0x1b74ac[_0x5c1cff(0x265)]-0x1;_0x10ee27++){const _0x46b592=_0x1b74ac[_0x10ee27];_0x118680[_0x5c1cff(0x327)][_0x5c1cff(0x23c)](_0x46b592);}const _0x30ecd7=await product[_0x5c1cff(0x31d)]([{'$group':{'_id':{'category':_0x5c1cff(0x322)},'products':{'$push':{'brand':_0x5c1cff(0x319),'product_code':_0x5c1cff(0x28e),'product_name':_0x5c1cff(0x342)}}}},{'$sort':{'_id.category':-0x1}}]),_0x46e1e8=await purchases_finished[_0x5c1cff(0x31d)]([{'$match':{'date':{'$gte':_0x2d4a98,'$lte':_0x40f68d}}},{'$unwind':_0x5c1cff(0x20f)},{'$group':{'_id':{'product_name':_0x5c1cff(0x2b5),'product_code':_0x5c1cff(0x21f)},'totalQTY':{'$sum':_0x5c1cff(0x1e7)}}}]);_0x118680[_0x5c1cff(0x27f)]=[];for(let _0x42057b=0x0;_0x42057b<=_0x46e1e8[_0x5c1cff(0x265)]-0x1;_0x42057b++){const _0x40e841=_0x46e1e8[_0x42057b];_0x118680[_0x5c1cff(0x27f)][_0x5c1cff(0x23c)](_0x40e841);}const _0x2d6f52=await sales_sa[_0x5c1cff(0x31d)]([{'$match':{'date':{'$gte':_0x2d4a98,'$lte':_0x40f68d}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5c1cff(0x31b)}}},{'$lookup':{'from':_0x5c1cff(0x268),'localField':_0x5c1cff(0x341),'foreignField':_0x5c1cff(0x209),'as':_0x5c1cff(0x217)}},{'$unwind':_0x5c1cff(0x22f)},{'$unwind':_0x5c1cff(0x2ad)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x5c1cff(0x2a9),'product_code':_0x5c1cff(0x2b8)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console['log'](_0x2d6f52[0x0]),_0x118680[_0x5c1cff(0x284)]=[];for(let _0x2f210a=0x0;_0x2f210a<=_0x2d6f52[_0x5c1cff(0x265)]-0x1;_0x2f210a++){const _0x52ca49=_0x2d6f52[_0x2f210a];_0x118680['sales_bkg'][_0x5c1cff(0x23c)](_0x52ca49);}const _0x4ca890=await sales_sa[_0x5c1cff(0x31d)]([{'$match':{'date':{'$gte':_0x2d4a98,'$lte':_0x40f68d}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5c1cff(0x31b)}}},{'$lookup':{'from':_0x5c1cff(0x268),'localField':_0x5c1cff(0x341),'foreignField':_0x5c1cff(0x209),'as':_0x5c1cff(0x217)}},{'$unwind':_0x5c1cff(0x22f)},{'$unwind':_0x5c1cff(0x2ad)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x5c1cff(0x340)}},{'$group':{'_id':{'product_name':_0x5c1cff(0x2a9),'product_code':_0x5c1cff(0x2b8)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'}}}]);_0x118680[_0x5c1cff(0x2a6)]=[];for(let _0x149075=0x0;_0x149075<=_0x4ca890[_0x5c1cff(0x265)]-0x1;_0x149075++){const _0x45fef2=_0x4ca890[_0x149075];_0x118680[_0x5c1cff(0x2a6)][_0x5c1cff(0x23c)](_0x45fef2);}let _0x18cb2e='';for(let _0x18ba77=0x0;_0x18ba77<=_0x30ecd7[_0x5c1cff(0x265)]-0x1;_0x18ba77++){const _0x550874=_0x30ecd7[_0x18ba77];_0x18cb2e+='<tr>',_0x18cb2e+=_0x5c1cff(0x363)+_0x550874['_id'][_0x5c1cff(0x36d)]+'</td>',_0x18cb2e+='</tr>';for(let _0x2596da=0x0;_0x2596da<_0x118680[_0x5c1cff(0x327)][_0x5c1cff(0x265)];_0x2596da++){const _0x35b0d7=_0x118680['cat_brand'][_0x2596da];if(_0x35b0d7[_0x5c1cff(0x209)][_0x5c1cff(0x36d)]==_0x550874['_id'][_0x5c1cff(0x36d)]){let _0x33f203=[],_0x524fe7=[],_0x10f968=[];_0x33f203[_0x35b0d7[_0x5c1cff(0x209)][_0x5c1cff(0x2ab)]]=[],_0x524fe7[_0x35b0d7[_0x5c1cff(0x209)][_0x5c1cff(0x2ab)]]=[],_0x10f968[_0x35b0d7['_id'][_0x5c1cff(0x2ab)]]=[];var _0x1d9123=0x0,_0x416966=0x0,_0x44be67=0x0;for(let _0x544088=0x0;_0x544088<_0x35b0d7[_0x5c1cff(0x20a)]['length'];_0x544088++){const _0x13535d=_0x35b0d7[_0x5c1cff(0x20a)][_0x544088];for(let _0x215a58=0x0;_0x215a58<=_0x118680[_0x5c1cff(0x27f)]['length']-0x1;_0x215a58++){const _0x59dd80=_0x118680[_0x5c1cff(0x27f)][_0x215a58];_0x59dd80[_0x5c1cff(0x209)][_0x5c1cff(0x2fc)]==_0x13535d['name']&&_0x59dd80['_id'][_0x5c1cff(0x2b3)]==_0x13535d[_0x5c1cff(0x2b3)]&&(_0x1d9123+=parseInt(_0x59dd80[_0x5c1cff(0x2a5)],0xa));}for(let _0x25c266=0x0;_0x25c266<=_0x118680[_0x5c1cff(0x2a6)]['length']-0x1;_0x25c266++){const _0x118ea0=_0x118680[_0x5c1cff(0x2a6)][_0x25c266];_0x118ea0[_0x5c1cff(0x209)][_0x5c1cff(0x2fc)]==_0x13535d[_0x5c1cff(0x219)]&&_0x118ea0[_0x5c1cff(0x209)][_0x5c1cff(0x2b3)]==_0x13535d[_0x5c1cff(0x2b3)]&&(_0x416966+=parseFloat(_0x118ea0[_0x5c1cff(0x2a5)],0xa)[_0x5c1cff(0x337)](0x2));}for(let _0x28618d=0x0;_0x28618d<=_0x118680[_0x5c1cff(0x284)][_0x5c1cff(0x265)]-0x1;_0x28618d++){const _0x2aa696=_0x118680['sales_bkg'][_0x28618d];_0x2aa696[_0x5c1cff(0x209)][_0x5c1cff(0x2fc)]==_0x13535d[_0x5c1cff(0x219)]&&_0x2aa696[_0x5c1cff(0x209)][_0x5c1cff(0x2b3)]==_0x13535d[_0x5c1cff(0x2b3)]&&(_0x44be67+=parseInt(_0x2aa696[_0x5c1cff(0x2a5)],0xa));}}const _0x256b97=new Intl[(_0x5c1cff(0x246))](_0x5c1cff(0x354));var _0x476ad7=_0x256b97['format'](_0x1d9123);_0x33f203[_0x35b0d7[_0x5c1cff(0x209)]['brand']][_0x5c1cff(0x23c)](_0x476ad7),_0x524fe7[_0x35b0d7['_id']['brand']]['push'](_0x256b97['format'](_0x416966)),_0x10f968[_0x35b0d7[_0x5c1cff(0x209)]['brand']][_0x5c1cff(0x23c)](_0x256b97[_0x5c1cff(0x36e)](_0x44be67));var _0x3cfd02=_0x256b97[_0x5c1cff(0x36e)](_0x1d9123-(_0x44be67+_0x416966));_0x18cb2e+=_0x5c1cff(0x266),_0x18cb2e+=_0x5c1cff(0x365),_0x18cb2e+='<td\x20class=\x22row_data\x22>'+_0x35b0d7[_0x5c1cff(0x209)][_0x5c1cff(0x2ab)]+_0x5c1cff(0x264),_0x18cb2e+=_0x5c1cff(0x351)+_0x33f203[_0x35b0d7[_0x5c1cff(0x209)][_0x5c1cff(0x2ab)]][0x0]+_0x5c1cff(0x264),_0x18cb2e+=_0x5c1cff(0x316),_0x18cb2e+=_0x5c1cff(0x351)+_0x10f968[_0x35b0d7['_id'][_0x5c1cff(0x2ab)]][0x0]+_0x5c1cff(0x264),_0x18cb2e+=_0x5c1cff(0x351)+_0x524fe7[_0x35b0d7[_0x5c1cff(0x209)][_0x5c1cff(0x2ab)]][0x0]+'</td>',_0x18cb2e+='<td\x20class=\x22row_data\x22>'+_0x3cfd02+_0x5c1cff(0x264),_0x18cb2e+=_0x5c1cff(0x35e);}}}return console['log'](_0x118680[_0x5c1cff(0x284)]),_0x18cb2e;}router[a0_0x45d816(0x1fb)](a0_0x45d816(0x357),auth,async(_0x57a8af,_0x1b7e67)=>{const _0x59dda5=a0_0x45d816,{from_date:_0x648414,to_date:_0x2bce36}=_0x57a8af[_0x59dda5(0x2d8)],_0x3f6091=await dataCheck(_0x648414,_0x2bce36);{}let _0x165ea3=_0x59dda5(0x275);var _0x3dcf85=new Date(_0x648414),_0x981bb7=new Date(_0x2bce36);const _0x3d0832={'year':_0x59dda5(0x2d2),'month':'long','day':'numeric'},_0x33f3b0=new Intl['DateTimeFormat']('en-US',_0x3d0832)['format'](_0x3dcf85),_0x2e495=new Intl[(_0x59dda5(0x238))](_0x59dda5(0x354),_0x3d0832)[_0x59dda5(0x36e)](_0x981bb7);_0x165ea3+=_0x59dda5(0x36c),_0x165ea3+=_0x59dda5(0x2d7),_0x165ea3+='<p>'+_0x33f3b0+_0x59dda5(0x225)+_0x2e495+_0x59dda5(0x34d),_0x165ea3+=_0x59dda5(0x292),_0x165ea3+=_0x59dda5(0x23f),_0x165ea3+=_0x59dda5(0x2e5),_0x165ea3+=_0x59dda5(0x266),_0x165ea3+=_0x59dda5(0x286),_0x165ea3+=_0x59dda5(0x2e4),_0x165ea3+=_0x59dda5(0x2f9)+_0x33f3b0+'</th>',_0x165ea3+=_0x59dda5(0x36a),_0x165ea3+=_0x59dda5(0x207),_0x165ea3+=_0x59dda5(0x26d)+_0x2e495+_0x59dda5(0x310),_0x165ea3+='</tr>',_0x165ea3+=_0x59dda5(0x266),_0x165ea3+=_0x59dda5(0x2e3),_0x165ea3+=_0x59dda5(0x1fa),_0x165ea3+=_0x59dda5(0x35e),_0x165ea3+=_0x3f6091,_0x165ea3+=_0x59dda5(0x2f7),_0x165ea3+=_0x59dda5(0x255),_0x165ea3+='</div>';const _0x211664={'format':'Letter','orientation':_0x59dda5(0x34c)};pdf[_0x59dda5(0x1ef)](_0x165ea3,_0x211664)[_0x59dda5(0x2a1)](function(_0x38b8d1,_0x1cc6d0){const _0x3532ce=_0x59dda5;if(_0x38b8d1){_0x1b7e67[_0x3532ce(0x2a8)](0x1f4)[_0x3532ce(0x2c7)](_0x3532ce(0x302));return;}_0x1b7e67[_0x3532ce(0x299)](_0x3532ce(0x2db),'application/pdf'),_0x1cc6d0[_0x3532ce(0x2a3)](_0x1b7e67);});}),router[a0_0x45d816(0x2bf)](a0_0x45d816(0x271),auth,async(_0x5a8827,_0x239ac5)=>{const _0x25333d=a0_0x45d816;try{const {username:_0x369220,email:_0x30090e,role:_0x55e096}=_0x5a8827[_0x25333d(0x350)],_0x6b24e2=_0x5a8827['user'],_0x135a2b=await profile[_0x25333d(0x2d1)]({'email':_0x6b24e2['email']}),_0x1be0cf={'year':_0x25333d(0x2d2),'month':_0x25333d(0x2e9),'day':_0x25333d(0x2d2)},_0x50f5df=await master_shop['find'](),_0x10d7d0=await product[_0x25333d(0x343)](),_0xdf49a3=await warehouse[_0x25333d(0x31d)]([{'$unwind':_0x25333d(0x202)},{'$lookup':{'from':'products','localField':_0x25333d(0x331),'foreignField':_0x25333d(0x219),'as':_0x25333d(0x34f)}},{'$unwind':_0x25333d(0x232)},{'$project':{'product_name':_0x25333d(0x2df),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x25333d(0x1ea)}}}]);if(_0x50f5df[0x0]['language']==_0x25333d(0x2fd))var _0x377500=users[_0x25333d(0x2dc)];else{if(_0x50f5df[0x0][_0x25333d(0x32c)]==_0x25333d(0x2bc))var _0x377500=users[_0x25333d(0x2bc)];else{if(_0x50f5df[0x0][_0x25333d(0x32c)]==_0x25333d(0x355))var _0x377500=users['German'];else{if(_0x50f5df[0x0][_0x25333d(0x32c)]==_0x25333d(0x24f))var _0x377500=users['Spanish'];else{if(_0x50f5df[0x0][_0x25333d(0x32c)]==_0x25333d(0x253))var _0x377500=users[_0x25333d(0x253)];else{if(_0x50f5df[0x0][_0x25333d(0x32c)]=='Portuguese\x20(BR)')var _0x377500=users[_0x25333d(0x2f8)];else{if(_0x50f5df[0x0][_0x25333d(0x32c)]==_0x25333d(0x33d))var _0x377500=users['Chinese'];else{if(_0x50f5df[0x0][_0x25333d(0x32c)]==_0x25333d(0x2ff))var _0x377500=users[_0x25333d(0x32a)];}}}}}}}_0x239ac5[_0x25333d(0x31a)]('agent_sales',{'success':_0x5a8827['flash'](_0x25333d(0x315)),'errors':_0x5a8827[_0x25333d(0x332)]('errors'),'alldata':_0x10d7d0,'profile':_0x135a2b,'master_shop':_0x50f5df,'role':_0x6b24e2,'product_stock':_0xdf49a3,'language':_0x377500});}catch(_0x3505e3){}});async function agentsdataCheck(_0x25e69b,_0x2059ec){const _0x315e07=a0_0x45d816,_0x469539=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':_0x315e07(0x322)},'products':{'$push':{'name':_0x315e07(0x342),'product_code':_0x315e07(0x28e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x426225=[];_0x426225[_0x315e07(0x327)]=[];for(let _0x4b18e0=0x0;_0x4b18e0<=_0x469539[_0x315e07(0x265)]-0x1;_0x4b18e0++){const _0x430e3d=_0x469539[_0x4b18e0];_0x426225['cat_brand'][_0x315e07(0x23c)](_0x430e3d);}const _0x5e817a=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x315e07(0x319),'product_code':_0x315e07(0x28e),'product_name':_0x315e07(0x342)}}}},{'$sort':{'_id.category':-0x1}}]),_0x351fb2=await product[_0x315e07(0x31d)]([{'$group':{'_id':{'category':_0x315e07(0x322),'brand':_0x315e07(0x319)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x37de0f=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x25e69b,'$lte':_0x2059ec}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x315e07(0x31b)}}},{'$lookup':{'from':_0x315e07(0x268),'localField':_0x315e07(0x341),'foreignField':_0x315e07(0x209),'as':_0x315e07(0x217)}},{'$unwind':_0x315e07(0x22f)},{'$unwind':_0x315e07(0x2ad)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x315e07(0x340)}},{'$lookup':{'from':_0x315e07(0x20a),'localField':_0x315e07(0x1ff),'foreignField':_0x315e07(0x2b3),'as':_0x315e07(0x22b)}},{'$unwind':_0x315e07(0x26f)},{'$group':{'_id':{'sales_id':_0x315e07(0x2d9),'category':_0x315e07(0x366),'brand':_0x315e07(0x314)},'salesman_data':{'$first':_0x315e07(0x213)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x315e07(0x234),'product_details':{'prod_name':_0x315e07(0x34e),'product_code':_0x315e07(0x30e),'category':_0x315e07(0x366),'brand':_0x315e07(0x314)}}}}}]);let _0x5dde44='';_0x5dde44+=_0x315e07(0x266),_0x5dde44+='<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x5dde44+=_0x315e07(0x35e),_0x5dde44+=_0x315e07(0x266),_0x5dde44+='<td\x20class=\x22cat_data\x22></td>';for(let _0x273d2b=0x0;_0x273d2b<=_0x5e817a['length']-0x1;_0x273d2b++){const _0x22acaf=_0x5e817a[_0x273d2b];for(let _0x36fcc4=0x0;_0x36fcc4<_0x351fb2[_0x315e07(0x265)];_0x36fcc4++){const _0x525bee=_0x351fb2[_0x36fcc4];_0x525bee[_0x315e07(0x209)]==_0x22acaf[_0x315e07(0x209)][_0x315e07(0x36d)]&&(_0x5dde44+='<td\x20colspan=\x22'+_0x525bee[_0x315e07(0x2dd)]+_0x315e07(0x33c)+_0x22acaf['_id']['category']+_0x315e07(0x264));}}_0x5dde44+=_0x315e07(0x215),_0x5dde44+='</tr>',_0x5dde44+='<tr>',_0x5dde44+=_0x315e07(0x223);for(let _0x1a10a2=0x0;_0x1a10a2<=_0x5e817a['length']-0x1;_0x1a10a2++){const _0xdc196b=_0x5e817a[_0x1a10a2];for(let _0x33ba5d=0x0;_0x33ba5d<_0x426225[_0x315e07(0x327)][_0x315e07(0x265)];_0x33ba5d++){const _0x5ed512=_0x426225[_0x315e07(0x327)][_0x33ba5d];_0x5ed512['_id'][_0x315e07(0x36d)]==_0xdc196b[_0x315e07(0x209)][_0x315e07(0x36d)]&&(_0x5dde44+=_0x315e07(0x2d3)+_0x5ed512[_0x315e07(0x209)][_0x315e07(0x2ab)]+_0x315e07(0x264));}}_0x5dde44+=_0x315e07(0x370),_0x5dde44+=_0x315e07(0x35e);let _0x4c9852={'name':[],'dataqty':{}};for(let _0x441895=0x0;_0x441895<_0x426225[_0x315e07(0x327)][_0x315e07(0x265)];_0x441895++){const _0x5e2091=_0x426225[_0x315e07(0x327)][_0x441895],_0x4cd907=_0x5e2091['_id']['brand'],_0x37c435=_0x5e2091[_0x315e07(0x209)][_0x315e07(0x36d)];!_0x4c9852[_0x315e07(0x210)][_0x4cd907]&&(_0x4c9852[_0x315e07(0x210)][_0x4cd907]={});!_0x4c9852[_0x315e07(0x210)][_0x4cd907][_0x37c435]&&(_0x4c9852['dataqty'][_0x4cd907][_0x37c435]=[]);for(let _0x28d9c2=0x0;_0x28d9c2<_0x37de0f['length'];_0x28d9c2++){const _0x326256=_0x37de0f[_0x28d9c2];if(_0x4cd907===_0x326256[_0x315e07(0x209)]['brand']&&_0x37c435===_0x326256[_0x315e07(0x209)][_0x315e07(0x36d)]){const _0xeec8bb=_0x326256[_0x315e07(0x2bd)];!_0x4c9852[_0x315e07(0x210)][_0x4cd907][_0x37c435][_0xeec8bb]&&(_0x4c9852[_0x315e07(0x210)][_0x4cd907][_0x37c435][_0xeec8bb]=[]),_0x4c9852['dataqty'][_0x4cd907][_0x37c435][_0xeec8bb][_0x315e07(0x23c)](_0x326256[_0x315e07(0x2a5)]),!_0x4c9852[_0x315e07(0x219)][_0x315e07(0x2af)](_0xeec8bb)&&_0x4c9852[_0x315e07(0x219)]['push'](_0xeec8bb);}}}_0x5dde44+=_0x315e07(0x266);for(let _0x2ab399=0x0;_0x2ab399<=_0x4c9852[_0x315e07(0x219)]['length']-0x1;_0x2ab399++){const _0x26f158=_0x4c9852[_0x315e07(0x219)][_0x2ab399];_0x5dde44+=_0x315e07(0x351)+_0x26f158+_0x315e07(0x264);var _0x2edec4=0x0,_0x232a3b=0x0;for(let _0x59105f=0x0;_0x59105f<=_0x426225[_0x315e07(0x327)][_0x315e07(0x265)]-0x1;_0x59105f++){const _0x505546=_0x426225[_0x315e07(0x327)][_0x59105f];var _0x76c5d7=0x0;_0x4c9852['dataqty'][_0x505546[_0x315e07(0x209)][_0x315e07(0x2ab)]][_0x505546[_0x315e07(0x209)][_0x315e07(0x36d)]][_0x26f158]?(_0x76c5d7=_0x4c9852[_0x315e07(0x210)][_0x505546[_0x315e07(0x209)][_0x315e07(0x2ab)]][_0x505546[_0x315e07(0x209)][_0x315e07(0x36d)]][_0x26f158][0x0],_0x5dde44+=_0x315e07(0x351)+formatNumber(_0x76c5d7[_0x315e07(0x337)](0x2))+_0x315e07(0x264)):(_0x76c5d7=0x0,_0x5dde44+=_0x315e07(0x351)+_0x76c5d7+_0x315e07(0x264)),_0x2edec4+=_0x76c5d7;}_0x5dde44+=_0x315e07(0x351)+formatNumber(_0x2edec4['toFixed'](0x2))+'</td>';}return _0x5dde44+=_0x315e07(0x35e),_0x5dde44;}router[a0_0x45d816(0x1fb)](a0_0x45d816(0x2cb),auth,async(_0x3ecc6b,_0x40ca3e)=>{const _0x1d5016=a0_0x45d816,{from_date:_0x51ca70,to_date:_0x5b0b89}=_0x3ecc6b['body'],_0x48d4e3=await agentsdataCheck(_0x51ca70,_0x5b0b89);{}let _0x5a8f65=_0x1d5016(0x22e);var _0x1acd51=new Date(_0x51ca70),_0x1d2dae=new Date(_0x5b0b89);const _0x312292={'year':'numeric','month':_0x1d5016(0x2e9),'day':_0x1d5016(0x2d2)},_0x415f34=new Intl[(_0x1d5016(0x238))](_0x1d5016(0x354),_0x312292)[_0x1d5016(0x36e)](_0x1acd51),_0x31275c=new Intl[(_0x1d5016(0x238))]('en-US',_0x312292)[_0x1d5016(0x36e)](_0x1d2dae);_0x5a8f65+=_0x1d5016(0x36c),_0x5a8f65+=_0x1d5016(0x281),_0x5a8f65+=_0x1d5016(0x33b)+_0x415f34+'\x20-\x20'+_0x31275c+_0x1d5016(0x34d),_0x5a8f65+=_0x1d5016(0x292),_0x5a8f65+='<div\x20class=\x22col-sm-11\x22>',_0x5a8f65+=_0x1d5016(0x2e5),_0x5a8f65+=_0x48d4e3,_0x5a8f65+='</table>',_0x5a8f65+=_0x1d5016(0x255),_0x5a8f65+=_0x1d5016(0x255);const _0x24c691={'format':'Letter','orientation':_0x1d5016(0x34c)};pdf[_0x1d5016(0x1ef)](_0x5a8f65,_0x24c691)['toStream'](function(_0x15261b,_0x572bd3){const _0x3bf11d=_0x1d5016;if(_0x15261b){_0x40ca3e[_0x3bf11d(0x2a8)](0x1f4)[_0x3bf11d(0x2c7)]('Error\x20generating\x20PDF');return;}_0x40ca3e[_0x3bf11d(0x299)]('Content-Type',_0x3bf11d(0x22a)),_0x572bd3[_0x3bf11d(0x2a3)](_0x40ca3e);});}),router[a0_0x45d816(0x2bf)]('/agent_reports/sales_ad',auth,async(_0x1b38ca,_0x379a76)=>{const _0x49715f=a0_0x45d816;try{const {username:_0x2d3c21,email:_0x1eea8c,role:_0x24c49d}=_0x1b38ca['user'],_0x3b7233=_0x1b38ca[_0x49715f(0x350)],_0xc180c2=await profile[_0x49715f(0x2d1)]({'email':_0x3b7233[_0x49715f(0x285)]}),_0x27ae39={'year':_0x49715f(0x2d2),'month':_0x49715f(0x2e9),'day':_0x49715f(0x2d2)},_0x3aecc5=await master_shop[_0x49715f(0x343)](),_0x4ebaed=await staff[_0x49715f(0x2d1)]({'email':_0x3b7233[_0x49715f(0x285)]}),_0x6cf3b6=await product[_0x49715f(0x343)](),_0x1e329a=await warehouse[_0x49715f(0x31d)]([{'$unwind':_0x49715f(0x202)},{'$lookup':{'from':_0x49715f(0x20a),'localField':_0x49715f(0x331),'foreignField':_0x49715f(0x219),'as':_0x49715f(0x34f)}},{'$unwind':_0x49715f(0x232)},{'$project':{'product_name':_0x49715f(0x2df),'product_stock':_0x49715f(0x290)}},{'$group':{'_id':_0x49715f(0x361),'product_stock':{'$sum':_0x49715f(0x1ea)}}}]),_0x2bed5b=await staff[_0x49715f(0x343)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x3aecc5[0x0][_0x49715f(0x32c)]==_0x49715f(0x2fd))var _0x501935=users['English'];else{if(_0x3aecc5[0x0][_0x49715f(0x32c)]==_0x49715f(0x2bc))var _0x501935=users[_0x49715f(0x2bc)];else{if(_0x3aecc5[0x0]['language']==_0x49715f(0x355))var _0x501935=users[_0x49715f(0x355)];else{if(_0x3aecc5[0x0][_0x49715f(0x32c)]==_0x49715f(0x24f))var _0x501935=users[_0x49715f(0x24f)];else{if(_0x3aecc5[0x0][_0x49715f(0x32c)]=='French')var _0x501935=users[_0x49715f(0x253)];else{if(_0x3aecc5[0x0]['language']==_0x49715f(0x2b0))var _0x501935=users[_0x49715f(0x2f8)];else{if(_0x3aecc5[0x0][_0x49715f(0x32c)]==_0x49715f(0x33d))var _0x501935=users['Chinese'];else{if(_0x3aecc5[0x0][_0x49715f(0x32c)]==_0x49715f(0x2ff))var _0x501935=users[_0x49715f(0x32a)];}}}}}}}_0x379a76[_0x49715f(0x31a)]('dsi_sales_admin',{'success':_0x1b38ca['flash'](_0x49715f(0x315)),'errors':_0x1b38ca[_0x49715f(0x332)]('errors'),'alldata':_0x6cf3b6,'profile':_0xc180c2,'master_shop':_0x3aecc5,'role':_0x3b7233,'product_stock':_0x1e329a,'language':_0x501935,'staff_arr':_0x4ebaed,'staff_data_all':_0x2bed5b});}catch(_0x1fa6a7){_0x379a76['json'](_0x1fa6a7);}});function a0_0x3d75(_0xc644ff,_0x405fdb){const _0x5af87f=a0_0x5af8();return a0_0x3d75=function(_0x3d7538,_0x40d85a){_0x3d7538=_0x3d7538-0x1e5;let _0x20c109=_0x5af87f[_0x3d7538];return _0x20c109;},a0_0x3d75(_0xc644ff,_0x405fdb);}async function agentsdataDSICheck_admin(_0x50a85f,_0x32113e,_0x239277,_0x585079){const _0x4b4fa4=a0_0x45d816,_0x4b48f6=await product[_0x4b4fa4(0x31d)]([{'$group':{'_id':{'brand':_0x4b4fa4(0x319),'category':_0x4b4fa4(0x322)},'products':{'$push':{'name':'$name','product_code':_0x4b4fa4(0x28e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3a995e=[];_0x3a995e[_0x4b4fa4(0x327)]=[];for(let _0x207a7a=0x0;_0x207a7a<=_0x4b48f6[_0x4b4fa4(0x265)]-0x1;_0x207a7a++){const _0x4c803d=_0x4b48f6[_0x207a7a];_0x3a995e[_0x4b4fa4(0x327)][_0x4b4fa4(0x23c)](_0x4c803d);}const _0x181f9f=await product[_0x4b4fa4(0x31d)]([{'$group':{'_id':{'category':_0x4b4fa4(0x322)},'products':{'$push':{'brand':_0x4b4fa4(0x319),'product_code':'$product_code','product_name':_0x4b4fa4(0x342)}}}},{'$sort':{'_id.category':-0x1}}]),_0x447c8e=await product['aggregate']([{'$group':{'_id':{'category':_0x4b4fa4(0x322),'brand':'$brand'}}},{'$group':{'_id':_0x4b4fa4(0x262),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x26a022=await sales_sa[_0x4b4fa4(0x31d)]([{'$match':{'date':{'$gte':_0x50a85f,'$lte':_0x32113e},'sales_staff_id':_0x239277,'sale_product.isFG':_0x4b4fa4(0x340)}},{'$unwind':_0x4b4fa4(0x2ad)},{'$match':{'sale_product.isFG':_0x4b4fa4(0x340)}},{'$lookup':{'from':_0x4b4fa4(0x20a),'localField':_0x4b4fa4(0x1ff),'foreignField':_0x4b4fa4(0x2b3),'as':_0x4b4fa4(0x22b)}},{'$unwind':_0x4b4fa4(0x26f)},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':_0x4b4fa4(0x367)},'totalQty':{'$sum':_0x4b4fa4(0x234)},'products':{'$push':{'qty':_0x4b4fa4(0x234),'NetPrice':'$sale_product.totalprice','discount':_0x4b4fa4(0x2c5),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x4b4fa4(0x34e),'product_code':_0x4b4fa4(0x30e),'category':_0x4b4fa4(0x366),'brand':_0x4b4fa4(0x314),'gross_price':_0x4b4fa4(0x2c4)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x4b4fa4(0x1e9),'date':_0x4b4fa4(0x24c),'customer':_0x4b4fa4(0x25b),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x4b4fa4(0x307)},'totalGross':{'$sum':{'$multiply':[_0x4b4fa4(0x307),_0x4b4fa4(0x23a)]}},'NetPrice':{'$sum':_0x4b4fa4(0x369)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x4b4fa4(0x263)}}},{'$group':{'_id':{'dsi':_0x4b4fa4(0x1e9),'date':'$_id.date','customer':_0x4b4fa4(0x25b)},'totalQty':{'$sum':_0x4b4fa4(0x346)},'totalGross':{'$sum':_0x4b4fa4(0x1e5)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x4b4fa4(0x256)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x4b4fa4(0x346),'category':_0x4b4fa4(0x262),'brand':_0x4b4fa4(0x320),'product_details':_0x4b4fa4(0x202)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x27f623=[],_0x45e677={},_0x285194={},_0x1b2c10={};var _0x13d5f1=0x0,_0x32e150=0x0,_0x1e6698=0x0,_0x226bce=0x0,_0x205d96=0x0;const _0x136e98=0x6;for(let _0x16be20=0x0;_0x16be20<=_0x26a022[_0x4b4fa4(0x265)]-0x1;_0x16be20++){const _0x33cba7=_0x26a022[_0x16be20];let _0x2af557='<tr>';_0x2af557+=_0x4b4fa4(0x35a)+_0x33cba7[_0x4b4fa4(0x209)]['dsi']+_0x4b4fa4(0x264),_0x2af557+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x33cba7[_0x4b4fa4(0x209)][_0x4b4fa4(0x2ce)]+_0x4b4fa4(0x264),_0x2af557+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x33cba7[_0x4b4fa4(0x209)][_0x4b4fa4(0x237)]+_0x4b4fa4(0x264);let _0x376b2a={};var _0x30263d=0x0;for(let _0x2577e6=0x0;_0x2577e6<=_0x33cba7[_0x4b4fa4(0x20a)][_0x4b4fa4(0x265)]-0x1;_0x2577e6++){const _0x8c75de=_0x33cba7['products'][_0x2577e6];_0x376b2a[_0x8c75de[_0x4b4fa4(0x2ab)]+'-'+_0x8c75de['category']]=_0x8c75de['qty'];const _0x11e2db=_0x8c75de[_0x4b4fa4(0x2ab)]+'-'+_0x8c75de[_0x4b4fa4(0x36d)];!_0x45e677[_0x11e2db]&&(_0x45e677[_0x11e2db]=0x0),!Array[_0x4b4fa4(0x325)](_0x1b2c10[_0x11e2db])&&(_0x1b2c10[_0x11e2db]=[]),!Array[_0x4b4fa4(0x325)](_0x1b2c10[_0x11e2db])&&(_0x1b2c10[_0x11e2db]=[]),_0x45e677[_0x11e2db]+=_0x8c75de[_0x4b4fa4(0x2ca)],_0x1b2c10[_0x11e2db][_0x4b4fa4(0x23c)](_0x8c75de['qty']),_0x30263d++;}console[_0x4b4fa4(0x1fd)](_0x33cba7);for(let _0x3e2b66=0x0;_0x3e2b66<=_0x3a995e[_0x4b4fa4(0x327)][_0x4b4fa4(0x265)]-0x1;_0x3e2b66++){const _0x2fb75d=_0x3a995e[_0x4b4fa4(0x327)][_0x3e2b66],_0x3b00d8=_0x2fb75d[_0x4b4fa4(0x209)][_0x4b4fa4(0x2ab)]+'-'+_0x2fb75d['_id']['category'];_0x2af557+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x376b2a[_0x3b00d8]!==undefined?_0x376b2a[_0x3b00d8]['toFixed'](0x2):'')+_0x4b4fa4(0x264);}_0x1e6698=_0x33cba7['discount']+_0x33cba7['adj_discount'],_0x2af557+=_0x4b4fa4(0x1f8)+formatNumber(parseFloat(_0x33cba7[_0x4b4fa4(0x260)],0x2)[_0x4b4fa4(0x337)](0x2))+_0x4b4fa4(0x264),_0x2af557+=_0x4b4fa4(0x1f8)+formatNumber(_0x33cba7[_0x4b4fa4(0x23d)][_0x4b4fa4(0x337)](0x2))+'</td>',_0x2af557+=_0x4b4fa4(0x1f8)+formatNumber(_0x1e6698)+_0x4b4fa4(0x264),_0x2af557+=_0x4b4fa4(0x1f8)+formatNumber(_0x33cba7['NetPrice']['toFixed'](0x2))+_0x4b4fa4(0x264),_0x2af557+='</tr>',_0x13d5f1+=parseFloat(_0x33cba7[_0x4b4fa4(0x260)][_0x4b4fa4(0x337)](0x2)),_0x32e150+=parseFloat(_0x33cba7[_0x4b4fa4(0x2b6)][_0x4b4fa4(0x337)](0x2)),_0x226bce+=_0x1e6698,_0x205d96+=parseFloat(_0x33cba7[_0x4b4fa4(0x23d)][_0x4b4fa4(0x337)](0x2));if(_0x16be20==_0x26a022[_0x4b4fa4(0x265)]-0x1){_0x2af557+=_0x4b4fa4(0x266),_0x2af557+=_0x4b4fa4(0x25d),_0x2af557+=_0x4b4fa4(0x264);for(let _0x832abc=0x0;_0x832abc<=_0x3a995e[_0x4b4fa4(0x327)][_0x4b4fa4(0x265)]-0x1;_0x832abc++){const _0x55af70=_0x3a995e[_0x4b4fa4(0x327)][_0x832abc],_0x1c3944=_0x55af70['_id'][_0x4b4fa4(0x2ab)]+'-'+_0x55af70[_0x4b4fa4(0x209)][_0x4b4fa4(0x36d)],_0x523ed7=_0x1b2c10[_0x1c3944]['reduce']((_0x183f28,_0x80c83b)=>_0x183f28+_0x80c83b,0x0);console[_0x4b4fa4(0x1fd)](_0x4b4fa4(0x31e),_0x1c3944),_0x2af557+=_0x4b4fa4(0x203)+(_0x523ed7!==undefined?formatNumber(_0x523ed7[_0x4b4fa4(0x337)](0x2)):'')+'</b></td>',console[_0x4b4fa4(0x1fd)](_0x1b2c10[_0x1c3944][_0x4b4fa4(0x300)]((_0x77362c,_0x3040ae)=>_0x77362c+_0x3040ae,0x0));}_0x2af557+=_0x4b4fa4(0x2d6)+formatNumber(_0x13d5f1[_0x4b4fa4(0x337)](0x2))+_0x4b4fa4(0x1f0),_0x2af557+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x205d96)+'</b></td>',_0x2af557+=_0x4b4fa4(0x2d6)+formatNumber(_0x226bce)+_0x4b4fa4(0x1f0),_0x2af557+=_0x4b4fa4(0x2d6)+formatNumber(_0x32e150)+_0x4b4fa4(0x1f0),_0x2af557+=_0x4b4fa4(0x35e);}_0x27f623[_0x4b4fa4(0x23c)](_0x2af557);}function _0x41a7f8(_0x44c77c,_0x551880){const _0x4f2dd6=_0x4b4fa4,_0x5f1556=[];for(let _0xffd101=0x0;_0xffd101<=_0x44c77c['length']-0x1;_0xffd101+=_0x551880){_0x5f1556[_0x4f2dd6(0x23c)](_0x44c77c[_0x4f2dd6(0x1f1)](_0xffd101,_0xffd101+_0x551880));}return _0x5f1556;}const _0x17f6d4=_0x41a7f8(_0x27f623,_0x136e98);let _0x4fd6c9='';return _0x17f6d4[_0x4b4fa4(0x2e8)]((_0x2106e2,_0x27e657)=>{const _0x5c02b6=_0x4b4fa4;_0x27e657>0x0&&(_0x4fd6c9+=_0x5c02b6(0x254));_0x4fd6c9+=_0x5c02b6(0x2e5),_0x4fd6c9+=_0x5c02b6(0x280),_0x4fd6c9+='<tr>',_0x4fd6c9+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4fd6c9+=_0x5c02b6(0x35e),_0x4fd6c9+='<tr>',_0x4fd6c9+=_0x5c02b6(0x2b1);for(let _0x5ee1c3=0x0;_0x5ee1c3<=_0x181f9f[_0x5c02b6(0x265)]-0x1;_0x5ee1c3++){const _0x269aed=_0x181f9f[_0x5ee1c3];for(let _0x27c25c=0x0;_0x27c25c<_0x447c8e[_0x5c02b6(0x265)];_0x27c25c++){const _0x4fb707=_0x447c8e[_0x27c25c];_0x4fb707[_0x5c02b6(0x209)]===_0x269aed[_0x5c02b6(0x209)]['category']&&(_0x4fd6c9+=_0x5c02b6(0x241)+_0x4fb707[_0x5c02b6(0x2dd)]+_0x5c02b6(0x33c)+_0x269aed['_id'][_0x5c02b6(0x36d)]+_0x5c02b6(0x264));}}_0x4fd6c9+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x4fd6c9+=_0x5c02b6(0x35e),_0x4fd6c9+='<tr>',_0x4fd6c9+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x4fd6c9+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x4fd6c9+=_0x5c02b6(0x247);for(let _0x51591c=0x0;_0x51591c<=_0x181f9f['length']-0x1;_0x51591c++){const _0x4aab71=_0x181f9f[_0x51591c];for(let _0x2a25c9=0x0;_0x2a25c9<_0x3a995e[_0x5c02b6(0x327)][_0x5c02b6(0x265)];_0x2a25c9++){const _0x4781c7=_0x3a995e['cat_brand'][_0x2a25c9];_0x4781c7[_0x5c02b6(0x209)][_0x5c02b6(0x36d)]===_0x4aab71[_0x5c02b6(0x209)][_0x5c02b6(0x36d)]&&(_0x4fd6c9+=_0x5c02b6(0x2d3)+_0x4781c7[_0x5c02b6(0x209)][_0x5c02b6(0x2ab)]+_0x5c02b6(0x264));}}_0x4fd6c9+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x4fd6c9+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x4fd6c9+=_0x5c02b6(0x29b),_0x4fd6c9+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x4fd6c9+='</tr>',_0x4fd6c9+='</thead>',_0x4fd6c9+=_0x5c02b6(0x356),_0x2106e2[_0x5c02b6(0x2e8)](_0xeade18=>{_0x4fd6c9+=_0xeade18;}),console[_0x5c02b6(0x1fd)](_0x1b2c10),_0x4fd6c9+='</tbody>',_0x4fd6c9+='</table>';}),_0x4fd6c9;}async function agentsdataDSICheck_admin_excel(_0x9567fa,_0x255ea8,_0x1eb906,_0x305395){const _0x1650a3=a0_0x45d816,_0x3a0f27=await product['aggregate']([{'$group':{'_id':{'brand':_0x1650a3(0x319),'category':_0x1650a3(0x322)},'products':{'$push':{'name':_0x1650a3(0x342),'product_code':_0x1650a3(0x28e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x548893=[];_0x548893['cat_brand']=[];for(let _0x1ce9cc=0x0;_0x1ce9cc<=_0x3a0f27[_0x1650a3(0x265)]-0x1;_0x1ce9cc++){const _0x322fd6=_0x3a0f27[_0x1ce9cc];_0x548893[_0x1650a3(0x327)][_0x1650a3(0x23c)](_0x322fd6);}const _0x1db011=await product[_0x1650a3(0x31d)]([{'$group':{'_id':{'category':_0x1650a3(0x322)},'products':{'$push':{'brand':'$brand','product_code':_0x1650a3(0x28e),'product_name':_0x1650a3(0x342)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5e118d=await product[_0x1650a3(0x31d)]([{'$group':{'_id':{'category':'$category','brand':_0x1650a3(0x319)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x7adf88=await sales_sa[_0x1650a3(0x31d)]([{'$match':{'date':{'$gte':_0x9567fa,'$lte':_0x255ea8},'sales_staff_id':_0x1eb906,'sale_product.isFG':'false'}},{'$unwind':_0x1650a3(0x2ad)},{'$match':{'sale_product.isFG':_0x1650a3(0x340)}},{'$lookup':{'from':_0x1650a3(0x20a),'localField':_0x1650a3(0x1ff),'foreignField':_0x1650a3(0x2b3),'as':_0x1650a3(0x22b)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x1650a3(0x330),'date':'$date','customer':_0x1650a3(0x367)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x1650a3(0x234),'NetPrice':_0x1650a3(0x288),'discount':_0x1650a3(0x2c5),'adj_discount':_0x1650a3(0x2b4),'product_details':{'prod_name':_0x1650a3(0x34e),'product_code':_0x1650a3(0x30e),'category':'$product_info.category','brand':_0x1650a3(0x314),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x1650a3(0x2b2)},{'$group':{'_id':{'dsi':_0x1650a3(0x1e9),'date':_0x1650a3(0x24c),'customer':'$_id.customer','category':_0x1650a3(0x218),'brand':_0x1650a3(0x33f)},'totalQty':{'$sum':_0x1650a3(0x307)},'totalGross':{'$sum':{'$multiply':[_0x1650a3(0x307),_0x1650a3(0x23a)]}},'NetPrice':{'$sum':_0x1650a3(0x369)},'discount':{'$sum':_0x1650a3(0x296)},'adj_discount':{'$sum':_0x1650a3(0x21c)},'product_details':{'$first':_0x1650a3(0x263)}}},{'$group':{'_id':{'dsi':_0x1650a3(0x1e9),'date':'$_id.date','customer':_0x1650a3(0x25b)},'totalQty':{'$sum':_0x1650a3(0x346)},'totalGross':{'$sum':_0x1650a3(0x1e5)},'NetPrice':{'$sum':_0x1650a3(0x2ae)},'discount':{'$sum':_0x1650a3(0x256)},'adj_discount':{'$sum':_0x1650a3(0x323)},'products':{'$push':{'qty':'$totalQty','category':_0x1650a3(0x262),'brand':_0x1650a3(0x320),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0xa16186=[],_0x43f5f0={},_0x3687be={},_0x17a585={};var _0x31a1d8=0x0,_0x2afcf4=0x0,_0x61f339=0x0,_0x4ee71c=0x0,_0x39f75f=0x0;const _0x460e12=0x16345785d8a0000;for(let _0x122b00=0x0;_0x122b00<=_0x7adf88['length']-0x1;_0x122b00++){const _0x1b2c31=_0x7adf88[_0x122b00];let _0x271192=_0x1650a3(0x266);_0x271192+=_0x1650a3(0x35a)+_0x1b2c31[_0x1650a3(0x209)]['dsi']+_0x1650a3(0x264),_0x271192+=_0x1650a3(0x35a)+_0x1b2c31[_0x1650a3(0x209)][_0x1650a3(0x2ce)]+_0x1650a3(0x264),_0x271192+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1b2c31[_0x1650a3(0x209)]['customer']+_0x1650a3(0x264);let _0x2224af={};var _0x1723de=0x0;for(let _0x3213b3=0x0;_0x3213b3<=_0x1b2c31['products'][_0x1650a3(0x265)]-0x1;_0x3213b3++){const _0x1eed5d=_0x1b2c31[_0x1650a3(0x20a)][_0x3213b3];_0x2224af[_0x1eed5d[_0x1650a3(0x2ab)]+'-'+_0x1eed5d[_0x1650a3(0x36d)]]=_0x1eed5d[_0x1650a3(0x2ca)];const _0x5edfef=_0x1eed5d[_0x1650a3(0x2ab)]+'-'+_0x1eed5d['category'];!_0x43f5f0[_0x5edfef]&&(_0x43f5f0[_0x5edfef]=0x0),!Array[_0x1650a3(0x325)](_0x17a585[_0x5edfef])&&(_0x17a585[_0x5edfef]=[]),!Array['isArray'](_0x17a585[_0x5edfef])&&(_0x17a585[_0x5edfef]=[]),_0x43f5f0[_0x5edfef]+=_0x1eed5d[_0x1650a3(0x2ca)],_0x17a585[_0x5edfef]['push'](_0x1eed5d[_0x1650a3(0x2ca)]),_0x1723de++;}console[_0x1650a3(0x1fd)](_0x1b2c31);for(let _0x2cbd62=0x0;_0x2cbd62<=_0x548893['cat_brand'][_0x1650a3(0x265)]-0x1;_0x2cbd62++){const _0xfa5103=_0x548893[_0x1650a3(0x327)][_0x2cbd62],_0x433261=_0xfa5103[_0x1650a3(0x209)][_0x1650a3(0x2ab)]+'-'+_0xfa5103[_0x1650a3(0x209)][_0x1650a3(0x36d)];_0x271192+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x2224af[_0x433261]!==undefined?_0x2224af[_0x433261][_0x1650a3(0x337)](0x2):'')+'</td>';}_0x61f339=_0x1b2c31[_0x1650a3(0x28f)]+_0x1b2c31['adj_discount'],_0x271192+=_0x1650a3(0x1f8)+formatNumber(parseFloat(_0x1b2c31[_0x1650a3(0x260)],0x2)[_0x1650a3(0x337)](0x2))+_0x1650a3(0x264),_0x271192+=_0x1650a3(0x1f8)+formatNumber(_0x1b2c31['totalGross'][_0x1650a3(0x337)](0x2))+_0x1650a3(0x264),_0x271192+=_0x1650a3(0x1f8)+formatNumber(_0x61f339)+_0x1650a3(0x264),_0x271192+=_0x1650a3(0x1f8)+formatNumber(_0x1b2c31[_0x1650a3(0x2b6)][_0x1650a3(0x337)](0x2))+_0x1650a3(0x264),_0x271192+=_0x1650a3(0x35e),_0x31a1d8+=parseFloat(_0x1b2c31['totalQty']['toFixed'](0x2)),_0x2afcf4+=parseFloat(_0x1b2c31['NetPrice'][_0x1650a3(0x337)](0x2)),_0x4ee71c+=_0x61f339,_0x39f75f+=parseFloat(_0x1b2c31[_0x1650a3(0x23d)][_0x1650a3(0x337)](0x2));if(_0x122b00==_0x7adf88[_0x1650a3(0x265)]-0x1){_0x271192+=_0x1650a3(0x266),_0x271192+=_0x1650a3(0x25d),_0x271192+='</td>';for(let _0x5aef5a=0x0;_0x5aef5a<=_0x548893['cat_brand'][_0x1650a3(0x265)]-0x1;_0x5aef5a++){const _0x332eae=_0x548893[_0x1650a3(0x327)][_0x5aef5a],_0x578d97=_0x332eae['_id'][_0x1650a3(0x2ab)]+'-'+_0x332eae[_0x1650a3(0x209)]['category'],_0x18a2bc=_0x17a585[_0x578d97]['reduce']((_0x1227fc,_0x4c80af)=>_0x1227fc+_0x4c80af,0x0);console[_0x1650a3(0x1fd)]('test',_0x578d97),_0x271192+=_0x1650a3(0x203)+(_0x18a2bc!==undefined?formatNumber(_0x18a2bc[_0x1650a3(0x337)](0x2)):'')+_0x1650a3(0x1f0),console[_0x1650a3(0x1fd)](_0x17a585[_0x578d97]['reduce']((_0x200af5,_0x17b997)=>_0x200af5+_0x17b997,0x0));}_0x271192+=_0x1650a3(0x2d6)+formatNumber(_0x31a1d8['toFixed'](0x2))+'</b></td>',_0x271192+=_0x1650a3(0x2d6)+formatNumber(_0x39f75f)+_0x1650a3(0x1f0),_0x271192+=_0x1650a3(0x2d6)+formatNumber(_0x4ee71c)+_0x1650a3(0x1f0),_0x271192+=_0x1650a3(0x2d6)+formatNumber(_0x2afcf4)+_0x1650a3(0x1f0),_0x271192+=_0x1650a3(0x35e);}_0xa16186['push'](_0x271192);}function _0x4ea1ae(_0x4a84a4,_0x2235a6){const _0x22c7f6=_0x1650a3,_0x1372f0=[];for(let _0x25668d=0x0;_0x25668d<=_0x4a84a4[_0x22c7f6(0x265)]-0x1;_0x25668d+=_0x2235a6){_0x1372f0[_0x22c7f6(0x23c)](_0x4a84a4[_0x22c7f6(0x1f1)](_0x25668d,_0x25668d+_0x2235a6));}return _0x1372f0;}const _0x3fb6d6=_0x4ea1ae(_0xa16186,_0x460e12);let _0x24749e='';return _0x3fb6d6[_0x1650a3(0x2e8)]((_0x529967,_0xe97f39)=>{const _0x5f0ea0=_0x1650a3;_0xe97f39>0x0&&(_0x24749e+=_0x5f0ea0(0x254));_0x24749e+=_0x5f0ea0(0x2e5),_0x24749e+=_0x5f0ea0(0x280),_0x24749e+=_0x5f0ea0(0x266),_0x24749e+=_0x5f0ea0(0x208),_0x24749e+=_0x5f0ea0(0x35e),_0x24749e+=_0x5f0ea0(0x266),_0x24749e+=_0x5f0ea0(0x2b1);for(let _0x5182f5=0x0;_0x5182f5<=_0x1db011[_0x5f0ea0(0x265)]-0x1;_0x5182f5++){const _0x4dd938=_0x1db011[_0x5182f5];for(let _0x98df2=0x0;_0x98df2<_0x5e118d[_0x5f0ea0(0x265)];_0x98df2++){const _0x12a21f=_0x5e118d[_0x98df2];_0x12a21f[_0x5f0ea0(0x209)]===_0x4dd938[_0x5f0ea0(0x209)][_0x5f0ea0(0x36d)]&&(_0x24749e+=_0x5f0ea0(0x241)+_0x12a21f['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x4dd938['_id'][_0x5f0ea0(0x36d)]+_0x5f0ea0(0x264));}}_0x24749e+=_0x5f0ea0(0x359),_0x24749e+=_0x5f0ea0(0x35e),_0x24749e+=_0x5f0ea0(0x266),_0x24749e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x24749e+=_0x5f0ea0(0x245),_0x24749e+=_0x5f0ea0(0x247);for(let _0xb7ab=0x0;_0xb7ab<=_0x1db011['length']-0x1;_0xb7ab++){const _0x385418=_0x1db011[_0xb7ab];for(let _0x5d6e26=0x0;_0x5d6e26<_0x548893[_0x5f0ea0(0x327)][_0x5f0ea0(0x265)];_0x5d6e26++){const _0x315b15=_0x548893['cat_brand'][_0x5d6e26];_0x315b15['_id'][_0x5f0ea0(0x36d)]===_0x385418[_0x5f0ea0(0x209)][_0x5f0ea0(0x36d)]&&(_0x24749e+=_0x5f0ea0(0x2d3)+_0x315b15['_id'][_0x5f0ea0(0x2ab)]+_0x5f0ea0(0x264));}}_0x24749e+=_0x5f0ea0(0x370),_0x24749e+=_0x5f0ea0(0x272),_0x24749e+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x24749e+=_0x5f0ea0(0x329),_0x24749e+=_0x5f0ea0(0x35e),_0x24749e+=_0x5f0ea0(0x24e),_0x24749e+='<tbody>',_0x529967[_0x5f0ea0(0x2e8)](_0x243c2e=>{_0x24749e+=_0x243c2e;}),console[_0x5f0ea0(0x1fd)](_0x17a585),_0x24749e+=_0x5f0ea0(0x364),_0x24749e+='</table>';}),_0x24749e;}router[a0_0x45d816(0x1fb)]('/agent_reports/pdf_admin',auth,async(_0xbb28e,_0x4898cf)=>{const _0x371d5e=a0_0x45d816,{from_date:_0x4966b6,to_date:_0x17336a,isExcel:_0xdfa59d,agent_id:_0x17ad79}=_0xbb28e[_0x371d5e(0x2d8)],_0x1fab55=_0xbb28e[_0x371d5e(0x350)],_0x498cb7=await staff[_0x371d5e(0x2d1)]({'email':_0x1fab55[_0x371d5e(0x285)]}),_0x24f6f6=await master_shop[_0x371d5e(0x343)](),_0xc9c512=await agentsdataDSICheck_admin(_0x4966b6,_0x17336a,_0x17ad79,_0xdfa59d),_0x16d952=await agentsdataDSICheck_admin_excel(_0x4966b6,_0x17336a,_0x17ad79,_0xdfa59d);let _0x5c8567=_0x371d5e(0x27a);var _0x29e67e=new Date(_0x4966b6),_0x5ba1c8=new Date(_0x17336a);const _0x2e4185={'year':_0x371d5e(0x2d2),'month':'long','day':_0x371d5e(0x2d2)},_0x5869d7=new Intl[(_0x371d5e(0x238))](_0x371d5e(0x354),_0x2e4185)[_0x371d5e(0x36e)](_0x29e67e),_0x161915=new Intl[(_0x371d5e(0x238))](_0x371d5e(0x354),_0x2e4185)['format'](_0x5ba1c8);_0x5c8567+=_0x371d5e(0x292),_0x5c8567+=_0x371d5e(0x1f7),_0x5c8567+=_0x371d5e(0x2e5),_0x5c8567+=_0xc9c512,_0x5c8567+=_0x371d5e(0x2f7),_0x5c8567+=_0x371d5e(0x255),_0x5c8567+=_0x371d5e(0x255);let _0x2f6297=_0x371d5e(0x27a);_0x2f6297+=_0x371d5e(0x292),_0x2f6297+=_0x371d5e(0x1f7),_0x2f6297+=_0x371d5e(0x2e5),_0x2f6297+=_0x16d952,_0x2f6297+=_0x371d5e(0x2f7),_0x2f6297+=_0x371d5e(0x255),_0x2f6297+=_0x371d5e(0x255);let _0x4a5663=_0x371d5e(0x36f);const _0xcc1789={'width':'15in','height':_0x371d5e(0x2f6),'orientation':_0x371d5e(0x34c),'border':{'top':_0x371d5e(0x2c3),'right':_0x371d5e(0x2c3),'bottom':_0x371d5e(0x2c3),'left':'0.1in'},'header':{'height':_0x371d5e(0x20c),'contents':_0x371d5e(0x2f5)+_0x4a5663+_0x371d5e(0x2c6)+_0x5869d7+_0x371d5e(0x225)+_0x161915+_0x371d5e(0x339)},'footer':{'height':_0x371d5e(0x2cf),'contents':{'default':_0x371d5e(0x206)}},'dpi':0x5,'zoomFactor':'1'};if(_0xdfa59d=='on'){const _0x177bc3=cheerio['load'](_0x2f6297);let _0x327d11=[],_0x298c2f=[],_0x33abe6=[];_0x177bc3('table\x20tr')[_0x371d5e(0x2ac)]((_0x34bd8a,_0x14d664)=>{const _0x54a6eb=_0x371d5e;let _0x5bc689=[],_0x3afe37=0x0;while(_0x33abe6[_0x3afe37]){_0x33abe6[_0x3afe37]--,_0x3afe37++;}_0x177bc3(_0x14d664)[_0x54a6eb(0x343)]('td,\x20th')['each']((_0x4e43c2,_0x1195cd)=>{const _0x3c2e8e=_0x54a6eb;let _0x4c0f35=_0x177bc3(_0x1195cd)['text']()['trim'](),_0x36623d=parseFloat(_0x4c0f35[_0x3c2e8e(0x20e)](/,/g,''));isNaN(_0x36623d)&&(_0x36623d=_0x4c0f35);let _0x334319=parseInt(_0x177bc3(_0x1195cd)[_0x3c2e8e(0x278)](_0x3c2e8e(0x334)))||0x1,_0x2dca49=parseInt(_0x177bc3(_0x1195cd)[_0x3c2e8e(0x278)](_0x3c2e8e(0x360)))||0x1;_0x5bc689[_0x3afe37]=_0x36623d;(_0x334319>0x1||_0x2dca49>0x1)&&_0x298c2f[_0x3c2e8e(0x23c)]({'s':{'r':_0x34bd8a,'c':_0x3afe37},'e':{'r':_0x34bd8a+_0x2dca49-0x1,'c':_0x3afe37+_0x334319-0x1}});for(let _0x526b57=0x0;_0x526b57<_0x334319;_0x526b57++){_0x2dca49>0x1&&(_0x33abe6[_0x3afe37+_0x526b57]=_0x2dca49-0x1);}_0x3afe37+=_0x334319;}),_0x327d11['push'](_0x5bc689);});const _0x3bd5c7=XLSX[_0x371d5e(0x28a)]['book_new'](),_0x2fab8b=XLSX['utils'][_0x371d5e(0x239)](_0x327d11);_0x298c2f[_0x371d5e(0x265)]>0x0&&(_0x2fab8b[_0x371d5e(0x283)]=_0x298c2f);_0x2fab8b[_0x371d5e(0x26a)]=_0x327d11[0x0][_0x371d5e(0x352)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x3bd5c7,_0x2fab8b,_0x371d5e(0x279));const _0x2689d3=XLSX['write'](_0x3bd5c7,{'bookType':_0x371d5e(0x2c8),'type':_0x371d5e(0x261)});_0x4898cf[_0x371d5e(0x299)](_0x371d5e(0x297),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x4898cf[_0x371d5e(0x299)](_0x371d5e(0x2db),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x4898cf[_0x371d5e(0x2c7)](_0x2689d3);}else pdf[_0x371d5e(0x1ef)](_0x5c8567,_0xcc1789)[_0x371d5e(0x2a1)](function(_0x5c60ea,_0x232fe7){const _0x1b62d3=_0x371d5e;if(_0x5c60ea){_0x4898cf[_0x1b62d3(0x2a8)](0x1f4)[_0x1b62d3(0x2c7)](_0x1b62d3(0x302));return;}_0x4898cf[_0x1b62d3(0x299)]('Content-Type',_0x1b62d3(0x22a)),_0x232fe7[_0x1b62d3(0x2a3)](_0x4898cf);});}),router[a0_0x45d816(0x2bf)](a0_0x45d816(0x349),auth,async(_0x516186,_0x4e17e2)=>{const _0x1924eb=a0_0x45d816;try{const {username:_0x25d724,email:_0x389b01,role:_0x3dbcf7}=_0x516186['user'],_0x1f04ab=_0x516186[_0x1924eb(0x350)],_0x3bfc74=await profile[_0x1924eb(0x2d1)]({'email':_0x1f04ab['email']}),_0x369cb2={'year':_0x1924eb(0x2d2),'month':'long','day':_0x1924eb(0x2d2)},_0x4b45d9=await master_shop[_0x1924eb(0x343)](),_0x30a99b=await staff['findOne']({'email':_0x1f04ab[_0x1924eb(0x285)]}),_0xc2c983=await product['find'](),_0x562d19=await warehouse['aggregate']([{'$unwind':_0x1924eb(0x202)},{'$lookup':{'from':_0x1924eb(0x20a),'localField':_0x1924eb(0x331),'foreignField':_0x1924eb(0x219),'as':_0x1924eb(0x34f)}},{'$unwind':_0x1924eb(0x232)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x1924eb(0x361),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x4b45d9[0x0]['language']==_0x1924eb(0x2fd))var _0x27eeba=users[_0x1924eb(0x2dc)];else{if(_0x4b45d9[0x0][_0x1924eb(0x32c)]==_0x1924eb(0x2bc))var _0x27eeba=users[_0x1924eb(0x2bc)];else{if(_0x4b45d9[0x0][_0x1924eb(0x32c)]==_0x1924eb(0x355))var _0x27eeba=users[_0x1924eb(0x355)];else{if(_0x4b45d9[0x0][_0x1924eb(0x32c)]==_0x1924eb(0x24f))var _0x27eeba=users[_0x1924eb(0x24f)];else{if(_0x4b45d9[0x0][_0x1924eb(0x32c)]==_0x1924eb(0x253))var _0x27eeba=users[_0x1924eb(0x253)];else{if(_0x4b45d9[0x0][_0x1924eb(0x32c)]==_0x1924eb(0x2b0))var _0x27eeba=users[_0x1924eb(0x2f8)];else{if(_0x4b45d9[0x0][_0x1924eb(0x32c)]==_0x1924eb(0x33d))var _0x27eeba=users['Chinese'];else{if(_0x4b45d9[0x0][_0x1924eb(0x32c)]=='Arabic\x20(ae)')var _0x27eeba=users[_0x1924eb(0x32a)];}}}}}}}_0x4e17e2['render'](_0x1924eb(0x34a),{'success':_0x516186['flash'](_0x1924eb(0x315)),'errors':_0x516186[_0x1924eb(0x332)](_0x1924eb(0x235)),'alldata':_0xc2c983,'profile':_0x3bfc74,'master_shop':_0x4b45d9,'role':_0x1f04ab,'product_stock':_0x562d19,'language':_0x27eeba,'staff_arr':_0x30a99b});}catch(_0x4a65c6){}});function formatNumber(_0x18ca7,_0x564a92=a0_0x45d816(0x354),_0xde8c36={'minimumFractionDigits':0x2}){const _0x201b85=a0_0x45d816,_0x18361d=new Intl[(_0x201b85(0x246))](_0x564a92,_0xde8c36);return _0x18361d['format'](_0x18ca7);}async function agentsdataDSICheck(_0x532973,_0x30e369,_0x240802,_0x5be27a){const _0x30eeca=a0_0x45d816,_0x5cc433=await product[_0x30eeca(0x31d)]([{'$group':{'_id':{'brand':_0x30eeca(0x319),'category':_0x30eeca(0x322)},'products':{'$push':{'name':_0x30eeca(0x342),'product_code':_0x30eeca(0x28e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1914e1=[];_0x1914e1[_0x30eeca(0x327)]=[];for(let _0x24c553=0x0;_0x24c553<=_0x5cc433['length']-0x1;_0x24c553++){const _0x57a16f=_0x5cc433[_0x24c553];_0x1914e1['cat_brand']['push'](_0x57a16f);}const _0xca7633=await product['aggregate']([{'$group':{'_id':{'category':_0x30eeca(0x322)},'products':{'$push':{'brand':_0x30eeca(0x319),'product_code':_0x30eeca(0x28e),'product_name':_0x30eeca(0x342)}}}},{'$sort':{'_id.category':-0x1}}]),_0x310606=await product[_0x30eeca(0x31d)]([{'$group':{'_id':{'category':'$category','brand':_0x30eeca(0x319)}}},{'$group':{'_id':_0x30eeca(0x262),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5e032f=await sales_sa[_0x30eeca(0x31d)]([{'$match':{'date':{'$gte':_0x532973,'$lte':_0x30e369},'sales_staff_id':_0x240802,'sale_product.isFG':_0x30eeca(0x340)}},{'$unwind':_0x30eeca(0x2ad)},{'$match':{'sale_product.isFG':_0x30eeca(0x340)}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0x30eeca(0x2b3),'as':_0x30eeca(0x22b)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x30eeca(0x330),'date':_0x30eeca(0x251),'customer':_0x30eeca(0x367)},'totalQty':{'$sum':_0x30eeca(0x234)},'products':{'$push':{'qty':_0x30eeca(0x234),'NetPrice':'$sale_product.totalprice','discount':_0x30eeca(0x2c5),'adj_discount':_0x30eeca(0x2b4),'product_details':{'prod_name':_0x30eeca(0x34e),'product_code':'$product_info.product_code','category':_0x30eeca(0x366),'brand':_0x30eeca(0x314),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x30eeca(0x1e9),'date':'$_id.date','customer':_0x30eeca(0x25b),'category':'$products.product_details.category','brand':_0x30eeca(0x33f)},'totalQty':{'$sum':_0x30eeca(0x307)},'totalGross':{'$sum':{'$multiply':[_0x30eeca(0x307),_0x30eeca(0x23a)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x30eeca(0x21c)},'product_details':{'$first':_0x30eeca(0x263)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x30eeca(0x24c),'customer':_0x30eeca(0x25b)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x30eeca(0x2ae)},'discount':{'$sum':_0x30eeca(0x256)},'adj_discount':{'$sum':_0x30eeca(0x323)},'products':{'$push':{'qty':'$totalQty','category':_0x30eeca(0x262),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x22dc67=[],_0x50ef9b={},_0x136616={},_0x419a1c={};var _0xaf7768=0x0,_0x51972a=0x0,_0x49a517=0x0,_0x153bd7=0x0,_0x158969=0x0;const _0x498c6f=0x6;for(let _0x193f04=0x0;_0x193f04<=_0x5e032f[_0x30eeca(0x265)]-0x1;_0x193f04++){const _0x29c2f1=_0x5e032f[_0x193f04];let _0x4bc2fb='<tr>';_0x4bc2fb+=_0x30eeca(0x35a)+_0x29c2f1[_0x30eeca(0x209)][_0x30eeca(0x277)]+_0x30eeca(0x264),_0x4bc2fb+=_0x30eeca(0x35a)+_0x29c2f1[_0x30eeca(0x209)][_0x30eeca(0x2ce)]+_0x30eeca(0x264),_0x4bc2fb+=_0x30eeca(0x35a)+_0x29c2f1[_0x30eeca(0x209)][_0x30eeca(0x237)]+'</td>';let _0x1c2166={};var _0x44f8b0=0x0;for(let _0x2dbb60=0x0;_0x2dbb60<=_0x29c2f1['products']['length']-0x1;_0x2dbb60++){const _0x3c88eb=_0x29c2f1[_0x30eeca(0x20a)][_0x2dbb60];_0x1c2166[_0x3c88eb['brand']+'-'+_0x3c88eb['category']]=_0x3c88eb[_0x30eeca(0x2ca)];const _0x1dd67c=_0x3c88eb[_0x30eeca(0x2ab)]+'-'+_0x3c88eb[_0x30eeca(0x36d)];!_0x50ef9b[_0x1dd67c]&&(_0x50ef9b[_0x1dd67c]=0x0),!Array[_0x30eeca(0x325)](_0x419a1c[_0x1dd67c])&&(_0x419a1c[_0x1dd67c]=[]),!Array['isArray'](_0x419a1c[_0x1dd67c])&&(_0x419a1c[_0x1dd67c]=[]),_0x50ef9b[_0x1dd67c]+=_0x3c88eb[_0x30eeca(0x2ca)],_0x419a1c[_0x1dd67c][_0x30eeca(0x23c)](_0x3c88eb[_0x30eeca(0x2ca)]),_0x44f8b0++;}console[_0x30eeca(0x1fd)](_0x29c2f1);for(let _0x4cf5e6=0x0;_0x4cf5e6<=_0x1914e1[_0x30eeca(0x327)]['length']-0x1;_0x4cf5e6++){const _0x32b3b9=_0x1914e1[_0x30eeca(0x327)][_0x4cf5e6],_0x39dacb=_0x32b3b9[_0x30eeca(0x209)][_0x30eeca(0x2ab)]+'-'+_0x32b3b9[_0x30eeca(0x209)][_0x30eeca(0x36d)];_0x4bc2fb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x1c2166[_0x39dacb]!==undefined?_0x1c2166[_0x39dacb][_0x30eeca(0x337)](0x2):'')+_0x30eeca(0x264);}_0x49a517=_0x29c2f1[_0x30eeca(0x28f)]+_0x29c2f1[_0x30eeca(0x27b)],_0x4bc2fb+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x29c2f1[_0x30eeca(0x260)],0x2)[_0x30eeca(0x337)](0x2))+_0x30eeca(0x264),_0x4bc2fb+=_0x30eeca(0x1f8)+formatNumber(_0x29c2f1[_0x30eeca(0x23d)][_0x30eeca(0x337)](0x2))+_0x30eeca(0x264),_0x4bc2fb+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x49a517)+_0x30eeca(0x264),_0x4bc2fb+=_0x30eeca(0x1f8)+formatNumber(_0x29c2f1['NetPrice'][_0x30eeca(0x337)](0x2))+'</td>',_0x4bc2fb+=_0x30eeca(0x35e),_0xaf7768+=parseFloat(_0x29c2f1[_0x30eeca(0x260)][_0x30eeca(0x337)](0x2)),_0x51972a+=parseFloat(_0x29c2f1[_0x30eeca(0x2b6)][_0x30eeca(0x337)](0x2)),_0x153bd7+=_0x49a517,_0x158969+=parseFloat(_0x29c2f1['totalGross']['toFixed'](0x2));if(_0x193f04==_0x5e032f[_0x30eeca(0x265)]-0x1){_0x4bc2fb+=_0x30eeca(0x266),_0x4bc2fb+=_0x30eeca(0x25d),_0x4bc2fb+=_0x30eeca(0x264);for(let _0x4d2f87=0x0;_0x4d2f87<=_0x1914e1[_0x30eeca(0x327)][_0x30eeca(0x265)]-0x1;_0x4d2f87++){const _0x51fcca=_0x1914e1[_0x30eeca(0x327)][_0x4d2f87],_0x4c3e3c=_0x51fcca['_id'][_0x30eeca(0x2ab)]+'-'+_0x51fcca[_0x30eeca(0x209)][_0x30eeca(0x36d)],_0x163fe3=_0x419a1c[_0x4c3e3c][_0x30eeca(0x300)]((_0x468ad0,_0x5416f4)=>_0x468ad0+_0x5416f4,0x0);_0x4bc2fb+=_0x30eeca(0x203)+(_0x163fe3!==undefined?formatNumber(_0x163fe3[_0x30eeca(0x337)](0x2)):'')+'</b></td>',console[_0x30eeca(0x1fd)](_0x419a1c[_0x4c3e3c][_0x30eeca(0x300)]((_0x4f5ddb,_0x24d62e)=>_0x4f5ddb+_0x24d62e,0x0));}_0x4bc2fb+=_0x30eeca(0x2d6)+formatNumber(_0xaf7768[_0x30eeca(0x337)](0x2))+_0x30eeca(0x1f0),_0x4bc2fb+=_0x30eeca(0x2d6)+formatNumber(_0x158969)+_0x30eeca(0x1f0),_0x4bc2fb+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x153bd7)+_0x30eeca(0x1f0),_0x4bc2fb+=_0x30eeca(0x2d6)+formatNumber(_0x51972a)+_0x30eeca(0x1f0),_0x4bc2fb+=_0x30eeca(0x35e);}_0x22dc67[_0x30eeca(0x23c)](_0x4bc2fb);}function _0x24c675(_0x2fd94f,_0xcd3f73){const _0x2bc675=_0x30eeca,_0x5e4558=[];for(let _0x247e1a=0x0;_0x247e1a<=_0x2fd94f[_0x2bc675(0x265)]-0x1;_0x247e1a+=_0xcd3f73){_0x5e4558['push'](_0x2fd94f[_0x2bc675(0x1f1)](_0x247e1a,_0x247e1a+_0xcd3f73));}return _0x5e4558;}const _0x2dec78=_0x24c675(_0x22dc67,_0x498c6f);let _0xdd9982='';return _0x2dec78[_0x30eeca(0x2e8)]((_0x100955,_0x52dad1)=>{const _0x3a73b0=_0x30eeca;_0x52dad1>0x0&&(_0xdd9982+=_0x3a73b0(0x254));_0xdd9982+=_0x3a73b0(0x2e5),_0xdd9982+=_0x3a73b0(0x280),_0xdd9982+=_0x3a73b0(0x266),_0xdd9982+=_0x3a73b0(0x208),_0xdd9982+=_0x3a73b0(0x35e),_0xdd9982+=_0x3a73b0(0x266),_0xdd9982+=_0x3a73b0(0x2b1);for(let _0x15c8d1=0x0;_0x15c8d1<=_0xca7633[_0x3a73b0(0x265)]-0x1;_0x15c8d1++){const _0x4ab27a=_0xca7633[_0x15c8d1];for(let _0x2577bf=0x0;_0x2577bf<_0x310606[_0x3a73b0(0x265)];_0x2577bf++){const _0x433dbc=_0x310606[_0x2577bf];_0x433dbc[_0x3a73b0(0x209)]===_0x4ab27a[_0x3a73b0(0x209)][_0x3a73b0(0x36d)]&&(_0xdd9982+='<td\x20colspan=\x22'+_0x433dbc[_0x3a73b0(0x2dd)]+_0x3a73b0(0x33c)+_0x4ab27a[_0x3a73b0(0x209)][_0x3a73b0(0x36d)]+'</td>');}}_0xdd9982+=_0x3a73b0(0x359),_0xdd9982+='</tr>',_0xdd9982+='<tr>',_0xdd9982+=_0x3a73b0(0x29d),_0xdd9982+=_0x3a73b0(0x245),_0xdd9982+=_0x3a73b0(0x247);for(let _0x3a27c1=0x0;_0x3a27c1<=_0xca7633[_0x3a73b0(0x265)]-0x1;_0x3a27c1++){const _0x26f0c9=_0xca7633[_0x3a27c1];for(let _0x6a9c6d=0x0;_0x6a9c6d<_0x1914e1['cat_brand'][_0x3a73b0(0x265)];_0x6a9c6d++){const _0x113ec1=_0x1914e1[_0x3a73b0(0x327)][_0x6a9c6d];_0x113ec1['_id']['category']===_0x26f0c9['_id']['category']&&(_0xdd9982+=_0x3a73b0(0x2d3)+_0x113ec1[_0x3a73b0(0x209)][_0x3a73b0(0x2ab)]+_0x3a73b0(0x264));}}_0xdd9982+=_0x3a73b0(0x370),_0xdd9982+=_0x3a73b0(0x272),_0xdd9982+=_0x3a73b0(0x29b),_0xdd9982+=_0x3a73b0(0x329),_0xdd9982+='</tr>',_0xdd9982+=_0x3a73b0(0x24e),_0xdd9982+=_0x3a73b0(0x356),_0x100955[_0x3a73b0(0x2e8)](_0x346f53=>{_0xdd9982+=_0x346f53;}),console[_0x3a73b0(0x1fd)](_0x419a1c),_0xdd9982+=_0x3a73b0(0x364),_0xdd9982+=_0x3a73b0(0x2f7);}),_0xdd9982;}async function agentsdataDSICheck_excel(_0x2bd888,_0xb954f5,_0x4e6b9a,_0x4450bc){const _0xc491f6=a0_0x45d816,_0x59f5d1=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':_0xc491f6(0x322)},'products':{'$push':{'name':_0xc491f6(0x342),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1330ff=[];_0x1330ff['cat_brand']=[];for(let _0x1adae6=0x0;_0x1adae6<=_0x59f5d1[_0xc491f6(0x265)]-0x1;_0x1adae6++){const _0x19645a=_0x59f5d1[_0x1adae6];_0x1330ff[_0xc491f6(0x327)][_0xc491f6(0x23c)](_0x19645a);}const _0x27fa55=await product['aggregate']([{'$group':{'_id':{'category':_0xc491f6(0x322)},'products':{'$push':{'brand':_0xc491f6(0x319),'product_code':_0xc491f6(0x28e),'product_name':_0xc491f6(0x342)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5bc6db=await product['aggregate']([{'$group':{'_id':{'category':_0xc491f6(0x322),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x10676d=await sales_sa[_0xc491f6(0x31d)]([{'$match':{'date':{'$gte':_0x2bd888,'$lte':_0xb954f5},'sales_staff_id':_0x4e6b9a,'sale_product.isFG':_0xc491f6(0x340)}},{'$unwind':_0xc491f6(0x2ad)},{'$match':{'sale_product.isFG':_0xc491f6(0x340)}},{'$lookup':{'from':'products','localField':_0xc491f6(0x1ff),'foreignField':_0xc491f6(0x2b3),'as':_0xc491f6(0x22b)}},{'$unwind':_0xc491f6(0x26f)},{'$group':{'_id':{'dsi':_0xc491f6(0x330),'date':_0xc491f6(0x251),'customer':_0xc491f6(0x367)},'totalQty':{'$sum':_0xc491f6(0x234)},'products':{'$push':{'qty':_0xc491f6(0x234),'NetPrice':'$sale_product.totalprice','discount':_0xc491f6(0x2c5),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0xc491f6(0x34e),'product_code':_0xc491f6(0x30e),'category':_0xc491f6(0x366),'brand':_0xc491f6(0x314),'gross_price':_0xc491f6(0x2c4)}}}}},{'$unwind':_0xc491f6(0x2b2)},{'$group':{'_id':{'dsi':_0xc491f6(0x1e9),'date':_0xc491f6(0x24c),'customer':_0xc491f6(0x25b),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0xc491f6(0x307)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0xc491f6(0x23a)]}},'NetPrice':{'$sum':_0xc491f6(0x369)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0xc491f6(0x263)}}},{'$group':{'_id':{'dsi':_0xc491f6(0x1e9),'date':_0xc491f6(0x24c),'customer':_0xc491f6(0x25b)},'totalQty':{'$sum':_0xc491f6(0x346)},'totalGross':{'$sum':_0xc491f6(0x1e5)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0xc491f6(0x256)},'adj_discount':{'$sum':_0xc491f6(0x323)},'products':{'$push':{'qty':_0xc491f6(0x346),'category':'$_id.category','brand':_0xc491f6(0x320),'product_details':_0xc491f6(0x202)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x7b9849=[],_0x445be7={},_0x475143={},_0xa9c9ff={};var _0x4c923a=0x0,_0x5e60a9=0x0,_0x5d908a=0x0,_0x4d635d=0x0,_0x543c20=0x0;const _0x4ea983=0x9184e72a000;for(let _0xd27cf1=0x0;_0xd27cf1<=_0x10676d[_0xc491f6(0x265)]-0x1;_0xd27cf1++){const _0x20eacf=_0x10676d[_0xd27cf1];let _0x5de593='<tr>';_0x5de593+=_0xc491f6(0x35a)+_0x20eacf['_id'][_0xc491f6(0x277)]+_0xc491f6(0x264),_0x5de593+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x20eacf[_0xc491f6(0x209)][_0xc491f6(0x2ce)]+_0xc491f6(0x264),_0x5de593+=_0xc491f6(0x35a)+_0x20eacf[_0xc491f6(0x209)][_0xc491f6(0x237)]+_0xc491f6(0x264);let _0x1c4723={};var _0x3dd55f=0x0;for(let _0x162d2e=0x0;_0x162d2e<=_0x20eacf[_0xc491f6(0x20a)][_0xc491f6(0x265)]-0x1;_0x162d2e++){const _0xd47d6b=_0x20eacf[_0xc491f6(0x20a)][_0x162d2e];_0x1c4723[_0xd47d6b[_0xc491f6(0x2ab)]+'-'+_0xd47d6b['category']]=_0xd47d6b[_0xc491f6(0x2ca)];const _0x48c967=_0xd47d6b[_0xc491f6(0x2ab)]+'-'+_0xd47d6b['category'];!_0x445be7[_0x48c967]&&(_0x445be7[_0x48c967]=0x0),!Array[_0xc491f6(0x325)](_0xa9c9ff[_0x48c967])&&(_0xa9c9ff[_0x48c967]=[]),!Array[_0xc491f6(0x325)](_0xa9c9ff[_0x48c967])&&(_0xa9c9ff[_0x48c967]=[]),_0x445be7[_0x48c967]+=_0xd47d6b[_0xc491f6(0x2ca)],_0xa9c9ff[_0x48c967]['push'](_0xd47d6b[_0xc491f6(0x2ca)]),_0x3dd55f++;}console[_0xc491f6(0x1fd)](_0x20eacf);for(let _0x24af08=0x0;_0x24af08<=_0x1330ff[_0xc491f6(0x327)][_0xc491f6(0x265)]-0x1;_0x24af08++){const _0x3b41fa=_0x1330ff[_0xc491f6(0x327)][_0x24af08],_0x544d80=_0x3b41fa[_0xc491f6(0x209)]['brand']+'-'+_0x3b41fa[_0xc491f6(0x209)][_0xc491f6(0x36d)];_0x5de593+=_0xc491f6(0x2fa)+(_0x1c4723[_0x544d80]!==undefined?_0x1c4723[_0x544d80][_0xc491f6(0x337)](0x2):'')+_0xc491f6(0x264);}_0x5d908a=_0x20eacf[_0xc491f6(0x28f)]+_0x20eacf[_0xc491f6(0x27b)],_0x5de593+=_0xc491f6(0x1f8)+formatNumber(parseFloat(_0x20eacf[_0xc491f6(0x260)],0x2)[_0xc491f6(0x337)](0x2))+_0xc491f6(0x264),_0x5de593+=_0xc491f6(0x1f8)+formatNumber(_0x20eacf['totalGross'][_0xc491f6(0x337)](0x2))+_0xc491f6(0x264),_0x5de593+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5d908a)+'</td>',_0x5de593+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x20eacf['NetPrice']['toFixed'](0x2))+_0xc491f6(0x264),_0x5de593+=_0xc491f6(0x35e),_0x4c923a+=parseFloat(_0x20eacf['totalQty'][_0xc491f6(0x337)](0x2)),_0x5e60a9+=parseFloat(_0x20eacf[_0xc491f6(0x2b6)][_0xc491f6(0x337)](0x2)),_0x4d635d+=_0x5d908a,_0x543c20+=parseFloat(_0x20eacf['totalGross'][_0xc491f6(0x337)](0x2));if(_0xd27cf1==_0x10676d[_0xc491f6(0x265)]-0x1){_0x5de593+='<tr>',_0x5de593+=_0xc491f6(0x25d),_0x5de593+=_0xc491f6(0x264);for(let _0x502b91=0x0;_0x502b91<=_0x1330ff[_0xc491f6(0x327)]['length']-0x1;_0x502b91++){const _0x387d8e=_0x1330ff['cat_brand'][_0x502b91],_0x425fae=_0x387d8e['_id'][_0xc491f6(0x2ab)]+'-'+_0x387d8e[_0xc491f6(0x209)][_0xc491f6(0x36d)],_0x305913=_0xa9c9ff[_0x425fae]['reduce']((_0x257004,_0x3e9199)=>_0x257004+_0x3e9199,0x0);_0x5de593+=_0xc491f6(0x203)+(_0x305913!==undefined?formatNumber(_0x305913['toFixed'](0x2)):'')+_0xc491f6(0x1f0),console[_0xc491f6(0x1fd)](_0xa9c9ff[_0x425fae][_0xc491f6(0x300)]((_0x40e605,_0xf85972)=>_0x40e605+_0xf85972,0x0));}_0x5de593+=_0xc491f6(0x2d6)+formatNumber(_0x4c923a[_0xc491f6(0x337)](0x2))+_0xc491f6(0x1f0),_0x5de593+=_0xc491f6(0x2d6)+formatNumber(_0x543c20)+'</b></td>',_0x5de593+=_0xc491f6(0x2d6)+formatNumber(_0x4d635d)+'</b></td>',_0x5de593+=_0xc491f6(0x2d6)+formatNumber(_0x5e60a9)+_0xc491f6(0x1f0),_0x5de593+=_0xc491f6(0x35e);}_0x7b9849['push'](_0x5de593);}function _0x16e42f(_0xd769e8,_0x1a53be){const _0x3d1c6e=_0xc491f6,_0x44a24d=[];for(let _0x4d6532=0x0;_0x4d6532<=_0xd769e8[_0x3d1c6e(0x265)]-0x1;_0x4d6532+=_0x1a53be){_0x44a24d[_0x3d1c6e(0x23c)](_0xd769e8['slice'](_0x4d6532,_0x4d6532+_0x1a53be));}return _0x44a24d;}const _0x421672=_0x16e42f(_0x7b9849,_0x4ea983);let _0x928a00='';return _0x421672[_0xc491f6(0x2e8)]((_0xa87747,_0x461b18)=>{const _0xa1c708=_0xc491f6;_0x461b18>0x0&&(_0x928a00+=_0xa1c708(0x254));_0x928a00+=_0xa1c708(0x2e5),_0x928a00+=_0xa1c708(0x280),_0x928a00+=_0xa1c708(0x266),_0x928a00+=_0xa1c708(0x208),_0x928a00+=_0xa1c708(0x35e),_0x928a00+=_0xa1c708(0x266),_0x928a00+=_0xa1c708(0x2b1);for(let _0xbb3c77=0x0;_0xbb3c77<=_0x27fa55[_0xa1c708(0x265)]-0x1;_0xbb3c77++){const _0x49cf2b=_0x27fa55[_0xbb3c77];for(let _0x55587f=0x0;_0x55587f<_0x5bc6db[_0xa1c708(0x265)];_0x55587f++){const _0x5e76cc=_0x5bc6db[_0x55587f];_0x5e76cc[_0xa1c708(0x209)]===_0x49cf2b[_0xa1c708(0x209)][_0xa1c708(0x36d)]&&(_0x928a00+=_0xa1c708(0x241)+_0x5e76cc[_0xa1c708(0x2dd)]+_0xa1c708(0x33c)+_0x49cf2b[_0xa1c708(0x209)][_0xa1c708(0x36d)]+_0xa1c708(0x264));}}_0x928a00+=_0xa1c708(0x359),_0x928a00+=_0xa1c708(0x35e),_0x928a00+=_0xa1c708(0x266),_0x928a00+=_0xa1c708(0x29d),_0x928a00+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x928a00+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x5355c6=0x0;_0x5355c6<=_0x27fa55[_0xa1c708(0x265)]-0x1;_0x5355c6++){const _0x64102=_0x27fa55[_0x5355c6];for(let _0xce701e=0x0;_0xce701e<_0x1330ff[_0xa1c708(0x327)][_0xa1c708(0x265)];_0xce701e++){const _0x2bc6bd=_0x1330ff[_0xa1c708(0x327)][_0xce701e];_0x2bc6bd['_id'][_0xa1c708(0x36d)]===_0x64102[_0xa1c708(0x209)][_0xa1c708(0x36d)]&&(_0x928a00+=_0xa1c708(0x2d3)+_0x2bc6bd['_id'][_0xa1c708(0x2ab)]+_0xa1c708(0x264));}}_0x928a00+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x928a00+=_0xa1c708(0x272),_0x928a00+=_0xa1c708(0x29b),_0x928a00+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x928a00+='</tr>',_0x928a00+=_0xa1c708(0x24e),_0x928a00+=_0xa1c708(0x356),_0xa87747[_0xa1c708(0x2e8)](_0xd58c29=>{_0x928a00+=_0xd58c29;}),console[_0xa1c708(0x1fd)](_0xa9c9ff),_0x928a00+='</tbody>',_0x928a00+=_0xa1c708(0x2f7);}),_0x928a00;}function a0_0x5af8(){const _0x838d9c=['en-US','German','<tbody>','/balance/pdf','Products\x20warehouse_data','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<th>\x20INVOICE\x20AMOUNT\x20</th>','thin','</tr>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','rowspan','$product_name','No\x20data\x20was\x20Found!','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','</tbody>','<td\x20class=\x22row_data\x22></td>','$product_info.category','$customer','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','$products.NetPrice','<th\x20rowspan=\x272\x27>Production</th>','date_include','<h1>JAKA\x20EQUITIES\x20CORP</h1>','category','format','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','$totalGross','/total_sales_reports/view','$product.quantity','product_stock','$_id.dsi','$product_stock','text','filter','catch','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','create','</b></td>','slice','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','<th>\x20ITEM\x20CODE\x20</th>','attachment;\x20filename=\x22sales_report.xlsx\x22','<td\x20class=\x22cat_data\x22><b>FG</b></td>','<div\x20\x20id=\x22table-conatainer\x22>','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','<th>X-Truck</th>','post','setDate','log','../middleware/auth','sale_product.product_code','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','$product_details','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','Types','border-left','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<th\x20colspan=\x272\x27>SOLD</th>','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','_id','products','window.onload\x20=\x20function()\x20{','60mm','/getDSSR_no','replace','$product','dataqty','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','write','$sales_info.name','sumqty','<td\x20class=\x22cat_data\x22></td>','getMonth','sales_info','$products.product_details.category','name','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','redirect','$products.adj_discount','5arPeHk','deleteOne','$product.product_code','book_append_sheet','findById','cash','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','\x20-\x20','medium','path','/dev/null','16963224YnnaRY','application/pdf','product_info','border-right','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$sales_info','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$check_no','$product_docs','../public/language/languages.json','$sale_product.real_qty_unit_val','errors','5795382FKMrwY','customer','DateTimeFormat','aoa_to_sheet','$products.product_details.gross_price','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','push','totalGross','window.print();','<div\x20class=\x22col-sm-11\x22>','error','<td\x20colspan=\x22','1829352YZgdWh','valueOf','Router','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','NumberFormat','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','Household','json','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','$product_list.product_name','$_id.date','<p>INVENTORY\x20SUMMARY</p>','</thead>','Spanish','inventory_sum','$date','image','French','<div\x20style=\x22page-break-before:\x20always;\x22></div>','</div>','$discount','5339985uVmKKb','left','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','$sale_product._id','$_id.customer','$bank','<td\x20colspan=\x223\x22><b>TOTAL<b>','amount','thick','totalQty','buffer','$_id.category','$products.product_details','</td>','length','<tr>','product_details','staffs','sort','!cols','bottom','$products.product_details.prod_id','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','Asia/Manila','$product_info','/dsrr_admin/view_data/:id','/agent/view','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','sales_reports','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<th>\x20BEG\x20BALANCE\x20</th>','dsi','attr','Sales\x20Report','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','adj_discount','border-top','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','/dl_excel','beg_bal','<thead>','<p>SALES\x20REPORTS</p>','pdfkit-table','!merges','sales_bkg','email','<th\x20rowspan=\x272\x27>Category</th>','getFullYear','$sale_product.totalprice','/dsrr_admin/view','utils','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','\x20-\x20HH','/dsrr/view','$product_code','discount','$product_details.product_stock','excel','<div\x20class=\x22row\x22>','referenceNumber','</script>','$due_date','$products.discount','Content-Disposition','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','setHeader','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','totalPrice','html-pdf','exceljs','toStream','Standard','pipe','<script>','totalQTY','sales_ext','$product_list','status','$sale_product.product_name','$amount','brand','each','$sale_product','$NetPrice','includes','Portuguese\x20(BR)','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','$products','product_code','$sale_product.adj_discount','$product.product_name','NetPrice','border-bottom','$sale_product.product_code','save','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','<th>\x20SALES\x20</th>','Hindi','salesman_data','td,\x20th','get','express','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','blob-stream','0.1in','$product_info.gross_price','$sale_product.discount','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','send','xlsx','$cash','qty','/agent/pdf','getDate','dssr_view','date','20mm','$sale_product.prod_cat','findOne','numeric','<td\x20class=\x22cat_data\x22>','style','toLocaleString','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<p>FINISHED\x20GOODS\x20INVENTORY</p>','body','$sales_info._id','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','Content-Type','English','brandCount','/inventory_sum/pdf','$product_details.product_name','$sale_product.isFG','toISOString','$product_list.product_stock','<th>Booking</th>','<th\x20rowspan=\x272\x27>Products</th>','<table>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','true','forEach','long','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','631066Esgoet','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','\x22><b>','split','trim','load','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','prod_cat','due_date','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','8.5in','</table>','Portuguese','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','balanced','product_name','English\x20(US)','$sale_product.quantity','Arabic\x20(ae)','reduce','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','Error\x20generating\x20PDF','<td\x20class=\x22row_data\x22><b>','<th>\x20QTY\x20SOLD\x20</th>','book_new','\x22><b></b></td>','$products.qty','/balance/view','mongoose','Products\x20master','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','/dsrr/pdf','<th>\x20ENDING\x20BALANCE\x20</th>','$product_info.product_code','totalQTYsum','</th>','ObjectId','isFG','1019416wJJCuQ','$product_info.brand','success','<td\x20class=\x22row_data\x22>0</td>','Products\x20find_data','$status_data','$brand','render','$sales_staff_id','15in','aggregate','test','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','$_id.brand','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','$category','$adj_discount','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','isArray','table\x20tr','cat_brand','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','Arabic','stock','language','000000','$sale_product.stock','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','$dsi','product_details.product_name','flash','/agent_reports/pdf','colspan','top','right','toFixed','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<th>\x20INCOMING\x20</th>','<p>','\x22\x20class=\x22cat_data\x22>','Chinese','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$products.product_details.brand','false','sales_staff_id','$name','find','multer','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','$totalQty','html','toLocaleDateString','/agent_reports/view','dsi_sales','271092jxIvLx','landscape','</p>','$product_info.name','product_docs','user','<td\x20class=\x22row_data\x22>','map','canvas'];a0_0x5af8=function(){return _0x838d9c;};return a0_0x5af8();}router[a0_0x45d816(0x1fb)](a0_0x45d816(0x333),auth,async(_0x52bb4e,_0x44a2e3)=>{const _0x2b7afa=a0_0x45d816,{from_date:_0x1eb1ec,to_date:_0x4ec46e,isExcel:_0x42fb38}=_0x52bb4e[_0x2b7afa(0x2d8)],_0x2fba1c=_0x52bb4e[_0x2b7afa(0x350)],_0x23ee2e=await staff[_0x2b7afa(0x2d1)]({'email':_0x2fba1c[_0x2b7afa(0x285)]}),_0x2618e9=await master_shop[_0x2b7afa(0x343)]();console[_0x2b7afa(0x1fd)](_0x2618e9[0x0][_0x2b7afa(0x252)]);const _0x129477=await agentsdataDSICheck(_0x1eb1ec,_0x4ec46e,_0x23ee2e[_0x2b7afa(0x209)][_0x2b7afa(0x243)](),_0x42fb38),_0x1982dc=await agentsdataDSICheck_excel(_0x1eb1ec,_0x4ec46e,_0x23ee2e['_id'][_0x2b7afa(0x243)](),_0x42fb38);let _0x578695=_0x2b7afa(0x23b);var _0x2b1c88=new Date(_0x1eb1ec),_0x3a6f6f=new Date(_0x4ec46e);const _0x39d0ae={'year':_0x2b7afa(0x2d2),'month':_0x2b7afa(0x2e9),'day':_0x2b7afa(0x2d2)},_0x57ca70=new Intl[(_0x2b7afa(0x238))](_0x2b7afa(0x354),_0x39d0ae)[_0x2b7afa(0x36e)](_0x2b1c88),_0x51bafc=new Intl[(_0x2b7afa(0x238))](_0x2b7afa(0x354),_0x39d0ae)['format'](_0x3a6f6f);_0x578695+=_0x2b7afa(0x292),_0x578695+=_0x2b7afa(0x1f7),_0x578695+='<table>',_0x578695+=_0x129477,_0x578695+=_0x2b7afa(0x2f7),_0x578695+=_0x2b7afa(0x255),_0x578695+=_0x2b7afa(0x255);let _0x38e342=_0x2b7afa(0x23b);_0x38e342+=_0x2b7afa(0x292),_0x38e342+=_0x2b7afa(0x1f7),_0x38e342+=_0x2b7afa(0x2e5),_0x38e342+=_0x1982dc,_0x38e342+=_0x2b7afa(0x2f7),_0x38e342+=_0x2b7afa(0x255),_0x38e342+='</div>';let _0x36f87b='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x13c35c={'width':'15in','height':_0x2b7afa(0x2f6),'orientation':'landscape','border':{'top':_0x2b7afa(0x2c3),'right':_0x2b7afa(0x2c3),'bottom':_0x2b7afa(0x2c3),'left':_0x2b7afa(0x2c3)},'header':{'height':_0x2b7afa(0x20c),'contents':_0x2b7afa(0x2f5)+_0x36f87b+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x57ca70+_0x2b7afa(0x225)+_0x51bafc+_0x2b7afa(0x339)},'footer':{'height':_0x2b7afa(0x2cf),'contents':{'default':_0x2b7afa(0x206)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x2b7afa(0x228)}}};if(_0x42fb38=='on'){const _0xdb3a93=cheerio[_0x2b7afa(0x2f1)](_0x38e342);let _0x46fefb=[],_0x7ccf50=[],_0x4ddd90=[];const _0x873e90=_0x54ae0a=>{const _0x27a165=_0x2b7afa,_0x4d94bc={'top':{'style':_0x27a165(0x25f),'color':{'rgb':_0x27a165(0x32d)}},'bottom':{'style':_0x27a165(0x25f),'color':{'rgb':_0x27a165(0x32d)}},'left':{'style':_0x27a165(0x25f),'color':{'rgb':_0x27a165(0x32d)}},'right':{'style':_0x27a165(0x25f),'color':{'rgb':_0x27a165(0x32d)}}};if(_0x54ae0a){const _0xe0a48f=_0x54ae0a[_0x27a165(0x2ef)](';')['reduce']((_0x4905bd,_0x36acea)=>{const _0x4ddf12=_0x27a165,[_0x5e0142,_0x106bc5]=_0x36acea['split'](':')[_0x4ddf12(0x352)](_0x4470bb=>_0x4470bb['trim']());return _0x4905bd[_0x5e0142]=_0x106bc5,_0x4905bd;},{});_0xe0a48f[_0x27a165(0x27c)]&&(_0x4d94bc[_0x27a165(0x335)][_0x27a165(0x2d4)]=_0xe0a48f['border-top'][_0x27a165(0x2af)](_0x27a165(0x35d))?_0x27a165(0x35d):_0x27a165(0x226)),_0xe0a48f[_0x27a165(0x2b7)]&&(_0x4d94bc[_0x27a165(0x26b)]['style']=_0xe0a48f[_0x27a165(0x2b7)][_0x27a165(0x2af)](_0x27a165(0x35d))?_0x27a165(0x35d):'medium'),_0xe0a48f[_0x27a165(0x205)]&&(_0x4d94bc[_0x27a165(0x258)][_0x27a165(0x2d4)]=_0xe0a48f[_0x27a165(0x205)][_0x27a165(0x2af)](_0x27a165(0x35d))?_0x27a165(0x35d):_0x27a165(0x226)),_0xe0a48f[_0x27a165(0x22c)]&&(_0x4d94bc[_0x27a165(0x336)][_0x27a165(0x2d4)]=_0xe0a48f['border-right']['includes'](_0x27a165(0x35d))?_0x27a165(0x35d):'medium');}return _0x4d94bc;};_0xdb3a93(_0x2b7afa(0x326))['each']((_0x5864e1,_0x5ad904)=>{const _0x46c806=_0x2b7afa;let _0x1abaf5=[],_0x1ea726=0x0;while(_0x4ddd90[_0x1ea726]){_0x4ddd90[_0x1ea726]--,_0x1ea726++;}_0xdb3a93(_0x5ad904)[_0x46c806(0x343)](_0x46c806(0x2be))[_0x46c806(0x2ac)]((_0x555934,_0x39ef31)=>{const _0x4a1a05=_0x46c806;let _0x5693e6=_0xdb3a93(_0x39ef31)[_0x4a1a05(0x1eb)]()[_0x4a1a05(0x2f0)](),_0x4062c1=parseFloat(_0x5693e6[_0x4a1a05(0x20e)](/,/g,'')),_0x4761dd={};!isNaN(_0x4062c1)?(_0x4761dd['v']=_0x4062c1,_0x4761dd['t']='n'):(_0x4761dd['v']=_0x5693e6,_0x4761dd['t']='s');const _0x354bf1=_0xdb3a93(_0x39ef31)[_0x4a1a05(0x278)](_0x4a1a05(0x2d4)),_0x5f30e4=_0x873e90(_0x354bf1);_0x4761dd['s']={'border':_0x5f30e4},_0x1abaf5[_0x1ea726]=_0x4761dd;let _0x45813a=parseInt(_0xdb3a93(_0x39ef31)['attr'](_0x4a1a05(0x334)))||0x1,_0x4d4007=parseInt(_0xdb3a93(_0x39ef31)[_0x4a1a05(0x278)](_0x4a1a05(0x360)))||0x1;(_0x45813a>0x1||_0x4d4007>0x1)&&_0x7ccf50[_0x4a1a05(0x23c)]({'s':{'r':_0x5864e1,'c':_0x1ea726},'e':{'r':_0x5864e1+_0x4d4007-0x1,'c':_0x1ea726+_0x45813a-0x1}});for(let _0x4440cf=0x0;_0x4440cf<_0x45813a;_0x4440cf++){_0x4d4007>0x1&&(_0x4ddd90[_0x1ea726+_0x4440cf]=_0x4d4007-0x1);}_0x1ea726+=_0x45813a;}),_0x46fefb['push'](_0x1abaf5);});const _0x4ada50=XLSX[_0x2b7afa(0x28a)][_0x2b7afa(0x305)](),_0x46731d=XLSX[_0x2b7afa(0x28a)][_0x2b7afa(0x239)](_0x46fefb);_0x7ccf50[_0x2b7afa(0x265)]>0x0&&(_0x46731d[_0x2b7afa(0x283)]=_0x7ccf50);_0x46731d[_0x2b7afa(0x26a)]=_0x46fefb[0x0][_0x2b7afa(0x352)](()=>({'wpx':0x64})),XLSX[_0x2b7afa(0x28a)][_0x2b7afa(0x220)](_0x4ada50,_0x46731d,_0x2b7afa(0x279));const _0x2094d5=XLSX[_0x2b7afa(0x212)](_0x4ada50,{'bookType':_0x2b7afa(0x2c8),'type':_0x2b7afa(0x261)});_0x44a2e3['setHeader'](_0x2b7afa(0x297),_0x2b7afa(0x1f5)),_0x44a2e3[_0x2b7afa(0x299)](_0x2b7afa(0x2db),_0x2b7afa(0x28b)),_0x44a2e3['send'](_0x2094d5);}else pdf[_0x2b7afa(0x1ef)](_0x578695,_0x13c35c)['toStream'](function(_0x128179,_0x1674de){const _0x3ed4e3=_0x2b7afa;if(_0x128179){console[_0x3ed4e3(0x240)]('PDF\x20Generation\x20Error:',_0x128179),_0x44a2e3['status'](0x1f4)[_0x3ed4e3(0x2c7)](_0x3ed4e3(0x302)+_0x128179);return;}_0x44a2e3[_0x3ed4e3(0x299)](_0x3ed4e3(0x2db),'application/pdf'),_0x1674de[_0x3ed4e3(0x2a3)](_0x44a2e3);});}),router['get'](a0_0x45d816(0x1e6),auth,async(_0x3c0283,_0x2a1e11)=>{const _0xdc404e=a0_0x45d816;try{const {username:_0x13b387,email:_0x2a35a2,role:_0x183089}=_0x3c0283['user'],_0x15423e=_0x3c0283['user'],_0x203824=await profile['findOne']({'email':_0x15423e[_0xdc404e(0x285)]}),_0x45a4d8={'year':_0xdc404e(0x2d2),'month':_0xdc404e(0x2e9),'day':_0xdc404e(0x2d2)},_0x258dba=await master_shop[_0xdc404e(0x343)](),_0x586e7a=await product['find'](),_0x3c9818=await warehouse[_0xdc404e(0x31d)]([{'$unwind':_0xdc404e(0x202)},{'$lookup':{'from':_0xdc404e(0x20a),'localField':_0xdc404e(0x331),'foreignField':_0xdc404e(0x219),'as':_0xdc404e(0x34f)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0xdc404e(0x2df),'product_stock':_0xdc404e(0x290)}},{'$group':{'_id':_0xdc404e(0x361),'product_stock':{'$sum':'$product_stock'}}}]),_0x4247c6=await staff[_0xdc404e(0x2d1)]({'email':_0x15423e['email']});if(_0x258dba[0x0][_0xdc404e(0x32c)]==_0xdc404e(0x2fd))var _0x5ee603=users[_0xdc404e(0x2dc)];else{if(_0x258dba[0x0][_0xdc404e(0x32c)]==_0xdc404e(0x2bc))var _0x5ee603=users[_0xdc404e(0x2bc)];else{if(_0x258dba[0x0][_0xdc404e(0x32c)]==_0xdc404e(0x355))var _0x5ee603=users['German'];else{if(_0x258dba[0x0]['language']==_0xdc404e(0x24f))var _0x5ee603=users['Spanish'];else{if(_0x258dba[0x0][_0xdc404e(0x32c)]=='French')var _0x5ee603=users['French'];else{if(_0x258dba[0x0]['language']==_0xdc404e(0x2b0))var _0x5ee603=users[_0xdc404e(0x2f8)];else{if(_0x258dba[0x0][_0xdc404e(0x32c)]==_0xdc404e(0x33d))var _0x5ee603=users[_0xdc404e(0x33d)];else{if(_0x258dba[0x0]['language']=='Arabic\x20(ae)')var _0x5ee603=users[_0xdc404e(0x32a)];}}}}}}}_0x2a1e11[_0xdc404e(0x31a)](_0xdc404e(0x273),{'success':_0x3c0283[_0xdc404e(0x332)]('success'),'errors':_0x3c0283[_0xdc404e(0x332)](_0xdc404e(0x235)),'alldata':_0x586e7a,'profile':_0x203824,'master_shop':_0x258dba,'role':_0x15423e,'product_stock':_0x3c9818,'language':_0x5ee603,'staff_arr':_0x4247c6});}catch(_0x5f0588){}});async function dataSalesReports(_0x5e613f,_0x43c570,_0x49bf13){const _0x17329d=a0_0x45d816;let _0x3dc5f5='';const _0x19e4ec=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x5e613f,'$lte':_0x43c570},'sales_staff_id':_0x49bf13}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x17329d(0x340)}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x17329d(0x2b8)},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':_0x17329d(0x288)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x47ab4e=0x0,_0x4bc43f=0x0;for(let _0x29a6f6=0x0;_0x29a6f6<=_0x19e4ec[_0x17329d(0x265)]-0x1;_0x29a6f6++){const _0x16c2b0=_0x19e4ec[_0x29a6f6];var _0x2b53c5=_0x16c2b0[_0x17329d(0x29e)]['toLocaleString'](undefined),_0x32ade5=_0x16c2b0['sumqty']['toLocaleString'](undefined);_0x3dc5f5+=_0x17329d(0x266),_0x3dc5f5+='<td\x20class=\x22row_data\x22>'+_0x16c2b0['_id'][_0x17329d(0x2b3)]+_0x17329d(0x264),_0x3dc5f5+=_0x17329d(0x351)+_0x16c2b0[_0x17329d(0x209)]['product_name']+'</td>',_0x3dc5f5+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x16c2b0['sumqty'][_0x17329d(0x337)](0x2))+_0x17329d(0x264),_0x3dc5f5+=_0x17329d(0x351)+formatNumber(_0x16c2b0[_0x17329d(0x29e)][_0x17329d(0x337)](0x2))+_0x17329d(0x264),_0x3dc5f5+='</tr>',_0x47ab4e+=parseFloat(_0x16c2b0[_0x17329d(0x214)]),_0x4bc43f+=parseFloat(_0x16c2b0[_0x17329d(0x29e)]);}var _0x1afd34=_0x4bc43f[_0x17329d(0x2d5)](undefined),_0x1859a1=_0x47ab4e['toLocaleString'](undefined);return _0x3dc5f5+=_0x17329d(0x266),_0x3dc5f5+=_0x17329d(0x1f2),_0x3dc5f5+=_0x17329d(0x303)+formatNumber(_0x47ab4e['toFixed'](0x2))+_0x17329d(0x1f0),_0x3dc5f5+=_0x17329d(0x303)+formatNumber(_0x4bc43f[_0x17329d(0x337)](0x2))+_0x17329d(0x1f0),_0x3dc5f5+=_0x17329d(0x35e),_0x3dc5f5;}router[a0_0x45d816(0x1fb)]('/total_sales_reports/pdf',auth,async(_0x19507b,_0x112f60)=>{const _0x4087a7=a0_0x45d816;try{const {from_date:_0x3d0c56,to_date:_0x9d8bca,isExcel:_0x2bb2e8}=_0x19507b['body'],_0x38fb4b=_0x19507b[_0x4087a7(0x350)],_0x22a57c=await staff[_0x4087a7(0x2d1)]({'email':_0x38fb4b[_0x4087a7(0x285)]});let _0x1dce18=_0x4087a7(0x2c1);var _0x55f7a2=new Date(_0x3d0c56),_0xede339=new Date(_0x9d8bca);const _0x542b08={'year':_0x4087a7(0x2d2),'month':'long','day':_0x4087a7(0x2d2)},_0x4656e2=new Intl[(_0x4087a7(0x238))](_0x4087a7(0x354),_0x542b08)[_0x4087a7(0x36e)](_0x55f7a2),_0x14aa1f=new Intl[(_0x4087a7(0x238))](_0x4087a7(0x354),_0x542b08)[_0x4087a7(0x36e)](_0xede339);var _0x55a703=await dataSalesReports(_0x3d0c56,_0x9d8bca,_0x22a57c[_0x4087a7(0x209)]['valueOf']());_0x1dce18+=_0x4087a7(0x292),_0x1dce18+=_0x4087a7(0x23f),_0x1dce18+='<table>',_0x1dce18+=_0x4087a7(0x266),_0x1dce18+=_0x4087a7(0x1f4),_0x1dce18+=_0x4087a7(0x33e),_0x1dce18+=_0x4087a7(0x304),_0x1dce18+=_0x4087a7(0x35c),_0x1dce18+=_0x4087a7(0x266),_0x1dce18+=_0x55a703,_0x1dce18+=_0x4087a7(0x35e),_0x1dce18+=_0x4087a7(0x255),_0x1dce18+=_0x4087a7(0x255);let _0x116d57=_0x4087a7(0x36f);const _0x2be8b7={'width':_0x4087a7(0x31c),'height':_0x4087a7(0x2f6),'orientation':'landscape','border':{'top':'0.1in','right':_0x4087a7(0x2c3),'bottom':_0x4087a7(0x2c3),'left':'0.1in'},'header':{'height':_0x4087a7(0x20c),'contents':_0x4087a7(0x2f5)+_0x116d57+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x22a57c[_0x4087a7(0x219)]+_0x4087a7(0x2da)+_0x4656e2+_0x4087a7(0x225)+_0x14aa1f+_0x4087a7(0x339)},'footer':{'height':_0x4087a7(0x2cf),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x2bb2e8=='on'){const _0x504a4d=cheerio[_0x4087a7(0x2f1)](_0x1dce18);let _0xc78a19=[],_0x5ca163=[],_0x5cbb37=[];const _0x47115c=_0x51e858=>{const _0x58292a=_0x4087a7,_0x1a6694={'top':{'style':_0x58292a(0x25f),'color':{'rgb':_0x58292a(0x32d)}},'bottom':{'style':'thick','color':{'rgb':_0x58292a(0x32d)}},'left':{'style':_0x58292a(0x25f),'color':{'rgb':_0x58292a(0x32d)}},'right':{'style':_0x58292a(0x25f),'color':{'rgb':'000000'}}};if(_0x51e858){const _0x31c3c4=_0x51e858[_0x58292a(0x2ef)](';')[_0x58292a(0x300)]((_0x2e6698,_0x4c919a)=>{const _0xdd9be6=_0x58292a,[_0x5d889a,_0x5ce07f]=_0x4c919a[_0xdd9be6(0x2ef)](':')[_0xdd9be6(0x352)](_0x491338=>_0x491338[_0xdd9be6(0x2f0)]());return _0x2e6698[_0x5d889a]=_0x5ce07f,_0x2e6698;},{});_0x31c3c4[_0x58292a(0x27c)]&&(_0x1a6694['top'][_0x58292a(0x2d4)]=_0x31c3c4[_0x58292a(0x27c)]['includes'](_0x58292a(0x35d))?_0x58292a(0x35d):_0x58292a(0x226)),_0x31c3c4[_0x58292a(0x2b7)]&&(_0x1a6694[_0x58292a(0x26b)][_0x58292a(0x2d4)]=_0x31c3c4[_0x58292a(0x2b7)][_0x58292a(0x2af)]('thin')?_0x58292a(0x35d):_0x58292a(0x226)),_0x31c3c4[_0x58292a(0x205)]&&(_0x1a6694[_0x58292a(0x258)]['style']=_0x31c3c4[_0x58292a(0x205)]['includes']('thin')?'thin':_0x58292a(0x226)),_0x31c3c4['border-right']&&(_0x1a6694[_0x58292a(0x336)][_0x58292a(0x2d4)]=_0x31c3c4['border-right'][_0x58292a(0x2af)](_0x58292a(0x35d))?_0x58292a(0x35d):_0x58292a(0x226));}return _0x1a6694;};_0x504a4d(_0x4087a7(0x326))[_0x4087a7(0x2ac)]((_0x5c2d1c,_0x59bf19)=>{const _0x42519a=_0x4087a7;let _0x53cc15=[],_0x103c2f=0x0;while(_0x5cbb37[_0x103c2f]){_0x5cbb37[_0x103c2f]--,_0x103c2f++;}_0x504a4d(_0x59bf19)[_0x42519a(0x343)](_0x42519a(0x2be))[_0x42519a(0x2ac)]((_0x2c0eed,_0x3ebda9)=>{const _0x191651=_0x42519a;let _0x460efc=_0x504a4d(_0x3ebda9)[_0x191651(0x1eb)]()['trim'](),_0x536ee5=parseFloat(_0x460efc[_0x191651(0x20e)](/,/g,'')),_0x5eea4b={};!isNaN(_0x536ee5)?(_0x5eea4b['v']=_0x536ee5,_0x5eea4b['t']='n'):(_0x5eea4b['v']=_0x460efc,_0x5eea4b['t']='s');const _0xa93d69=_0x504a4d(_0x3ebda9)['attr'](_0x191651(0x2d4)),_0x4abbbd=_0x47115c(_0xa93d69);_0x5eea4b['s']={'border':_0x4abbbd},_0x53cc15[_0x103c2f]=_0x5eea4b;let _0x2dc46c=parseInt(_0x504a4d(_0x3ebda9)[_0x191651(0x278)](_0x191651(0x334)))||0x1,_0x20440d=parseInt(_0x504a4d(_0x3ebda9)[_0x191651(0x278)]('rowspan'))||0x1;(_0x2dc46c>0x1||_0x20440d>0x1)&&_0x5ca163[_0x191651(0x23c)]({'s':{'r':_0x5c2d1c,'c':_0x103c2f},'e':{'r':_0x5c2d1c+_0x20440d-0x1,'c':_0x103c2f+_0x2dc46c-0x1}});for(let _0x250b4f=0x0;_0x250b4f<_0x2dc46c;_0x250b4f++){_0x20440d>0x1&&(_0x5cbb37[_0x103c2f+_0x250b4f]=_0x20440d-0x1);}_0x103c2f+=_0x2dc46c;}),_0xc78a19['push'](_0x53cc15);});const _0x40335b=XLSX[_0x4087a7(0x28a)][_0x4087a7(0x305)](),_0x31a574=XLSX[_0x4087a7(0x28a)][_0x4087a7(0x239)](_0xc78a19);_0x5ca163[_0x4087a7(0x265)]>0x0&&(_0x31a574['!merges']=_0x5ca163);_0x31a574['!cols']=_0xc78a19[0x0][_0x4087a7(0x352)](()=>({'wpx':0x64})),XLSX['utils'][_0x4087a7(0x220)](_0x40335b,_0x31a574,'Sales\x20Report');const _0x2d082c=XLSX[_0x4087a7(0x212)](_0x40335b,{'bookType':_0x4087a7(0x2c8),'type':_0x4087a7(0x261)});_0x112f60[_0x4087a7(0x299)](_0x4087a7(0x297),_0x4087a7(0x1f5)),_0x112f60['setHeader'](_0x4087a7(0x2db),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x112f60['send'](_0x2d082c);}else pdf['create'](_0x1dce18,_0x2be8b7)[_0x4087a7(0x2a1)](function(_0x10a6cb,_0x1db638){const _0x4c16e9=_0x4087a7;if(_0x10a6cb){_0x112f60[_0x4c16e9(0x2a8)](0x1f4)[_0x4c16e9(0x2c7)](_0x4c16e9(0x302));return;}_0x112f60[_0x4c16e9(0x299)](_0x4c16e9(0x2db),_0x4c16e9(0x22a)),_0x1db638[_0x4c16e9(0x2a3)](_0x112f60);});}catch(_0x1c41fe){}}),router[a0_0x45d816(0x2bf)]('/inventory_sum/view',auth,async(_0x1d8b33,_0x5f0c3b)=>{const _0x54a2b9=a0_0x45d816;try{const {username:_0x41af2f,email:_0x307b81,role:_0x4f2b38}=_0x1d8b33[_0x54a2b9(0x350)],_0x385521=_0x1d8b33['user'],_0x4538f0=await profile['findOne']({'email':_0x385521[_0x54a2b9(0x285)]}),_0x7da446={'year':_0x54a2b9(0x2d2),'month':_0x54a2b9(0x2e9),'day':'numeric'},_0x2f797f=await master_shop[_0x54a2b9(0x343)](),_0x257d62=await product[_0x54a2b9(0x343)](),_0x3e087c=await warehouse[_0x54a2b9(0x31d)]([{'$unwind':_0x54a2b9(0x202)},{'$lookup':{'from':_0x54a2b9(0x20a),'localField':_0x54a2b9(0x331),'foreignField':_0x54a2b9(0x219),'as':_0x54a2b9(0x34f)}},{'$unwind':_0x54a2b9(0x232)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x54a2b9(0x361),'product_stock':{'$sum':_0x54a2b9(0x1ea)}}}]);if(_0x2f797f[0x0][_0x54a2b9(0x32c)]==_0x54a2b9(0x2fd))var _0xf2d5dd=users[_0x54a2b9(0x2dc)];else{if(_0x2f797f[0x0][_0x54a2b9(0x32c)]==_0x54a2b9(0x2bc))var _0xf2d5dd=users[_0x54a2b9(0x2bc)];else{if(_0x2f797f[0x0][_0x54a2b9(0x32c)]==_0x54a2b9(0x355))var _0xf2d5dd=users[_0x54a2b9(0x355)];else{if(_0x2f797f[0x0][_0x54a2b9(0x32c)]==_0x54a2b9(0x24f))var _0xf2d5dd=users[_0x54a2b9(0x24f)];else{if(_0x2f797f[0x0]['language']=='French')var _0xf2d5dd=users['French'];else{if(_0x2f797f[0x0][_0x54a2b9(0x32c)]=='Portuguese\x20(BR)')var _0xf2d5dd=users[_0x54a2b9(0x2f8)];else{if(_0x2f797f[0x0][_0x54a2b9(0x32c)]=='Chinese')var _0xf2d5dd=users[_0x54a2b9(0x33d)];else{if(_0x2f797f[0x0][_0x54a2b9(0x32c)]==_0x54a2b9(0x2ff))var _0xf2d5dd=users['Arabic'];}}}}}}}_0x5f0c3b[_0x54a2b9(0x31a)](_0x54a2b9(0x250),{'success':_0x1d8b33[_0x54a2b9(0x332)](_0x54a2b9(0x315)),'errors':_0x1d8b33[_0x54a2b9(0x332)](_0x54a2b9(0x235)),'alldata':_0x257d62,'profile':_0x4538f0,'master_shop':_0x2f797f,'role':_0x385521,'product_stock':_0x3e087c,'language':_0xf2d5dd});}catch(_0xf45506){}});async function dataInventoryReports(_0x26ab9c,_0x57ea43,_0x241115){const _0x78a8e7=a0_0x45d816,_0x65c5c9=await sales_sa[_0x78a8e7(0x31d)]([{'$match':{'date':{'$gte':_0x26ab9c,'$lte':_0x57ea43},'sales_staff_id':_0x241115}},{'$unwind':_0x78a8e7(0x2ad)},{'$group':{'_id':{'product_name':_0x78a8e7(0x2a9),'product_code':_0x78a8e7(0x2b8)},'sumqty':{'$sum':_0x78a8e7(0x2fe)}}},{'$sort':{'_id.product_name':0x1}}]),_0x37a249=mongoose[_0x78a8e7(0x204)][_0x78a8e7(0x311)],_0x592671=await staff[_0x78a8e7(0x31d)]([{'$match':{'_id':_0x37a249(_0x241115)}},{'$unwind':_0x78a8e7(0x2a7)},{'$match':{'product_list.isConfirm':_0x78a8e7(0x2e7)}},{'$group':{'_id':{'product_name':_0x78a8e7(0x24b),'product_code':'$product_list.product_code'},'sumqty':{'$sum':_0x78a8e7(0x2e2)}}},{'$sort':{'_id.product_name':0x1}}]),_0x2c7ae2=await sales_inv_data[_0x78a8e7(0x31d)]([{'$match':{'date':{'$gte':_0x26ab9c,'$lte':_0x57ea43},'sales_staff_id':_0x241115}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x78a8e7(0x2a9),'product_code':_0x78a8e7(0x2b8)},'totalQTYsum':{'$sum':_0x78a8e7(0x32e)}}}]);console[_0x78a8e7(0x1fd)](_0x2c7ae2);let _0x3c4e17='';var _0x9ec433=0x0;for(let _0x4b9460=0x0;_0x4b9460<=_0x592671[_0x78a8e7(0x265)]-0x1;_0x4b9460++){const _0x447f28=_0x592671[_0x4b9460];_0x3c4e17+='<tr>',_0x3c4e17+=_0x78a8e7(0x2eb)+_0x447f28[_0x78a8e7(0x209)][_0x78a8e7(0x2b3)]+_0x78a8e7(0x264),_0x3c4e17+=_0x78a8e7(0x24a)+_0x447f28['_id'][_0x78a8e7(0x2fc)]+_0x78a8e7(0x264);var _0x341957=_0x447f28['sumqty'],_0x5000f3=0x0;for(let _0x5f49a2=0x0;_0x5f49a2<=_0x65c5c9[_0x78a8e7(0x265)]-0x1;_0x5f49a2++){const _0x4d92f1=_0x65c5c9[_0x5f49a2];_0x447f28[_0x78a8e7(0x209)]['product_code']==_0x4d92f1[_0x78a8e7(0x209)][_0x78a8e7(0x2b3)]&&_0x447f28['_id'][_0x78a8e7(0x2fc)]==_0x4d92f1[_0x78a8e7(0x209)]['product_name']&&(_0x5000f3=_0x4d92f1[_0x78a8e7(0x214)]);}var _0x31255d=0x0;for(let _0x14c9b8=0x0;_0x14c9b8<=_0x2c7ae2[_0x78a8e7(0x265)]-0x1;_0x14c9b8++){const _0x3abf55=_0x2c7ae2[_0x14c9b8];_0x447f28[_0x78a8e7(0x209)][_0x78a8e7(0x2b3)]==_0x3abf55[_0x78a8e7(0x209)]['product_code']&&_0x447f28['_id']['product_name']==_0x3abf55[_0x78a8e7(0x209)][_0x78a8e7(0x2fc)]&&(_0x31255d=_0x3abf55[_0x78a8e7(0x30f)]);}_0x9ec433=_0x341957-_0x31255d+_0x5000f3,_0x3c4e17+=_0x78a8e7(0x351)+_0x9ec433+'</td>';let _0x2c95ae=![];for(let _0xd6862f=0x0;_0xd6862f<=_0x2c7ae2[_0x78a8e7(0x265)]-0x1;_0xd6862f++){const _0x65261c=_0x2c7ae2[_0xd6862f];if(_0x447f28[_0x78a8e7(0x209)][_0x78a8e7(0x2b3)]==_0x65261c['_id'][_0x78a8e7(0x2b3)]&&_0x447f28[_0x78a8e7(0x209)]['product_name']==_0x65261c[_0x78a8e7(0x209)][_0x78a8e7(0x2fc)]){_0x3c4e17+=_0x78a8e7(0x351)+_0x65261c[_0x78a8e7(0x30f)]+_0x78a8e7(0x264),_0x2c95ae=!![];break;}}!_0x2c95ae&&(_0x3c4e17+=_0x78a8e7(0x316));let _0x4431b3=![];for(let _0x416d27=0x0;_0x416d27<=_0x65c5c9[_0x78a8e7(0x265)]-0x1;_0x416d27++){const _0x4067d8=_0x65c5c9[_0x416d27];if(_0x447f28[_0x78a8e7(0x209)][_0x78a8e7(0x2b3)]==_0x4067d8[_0x78a8e7(0x209)][_0x78a8e7(0x2b3)]&&_0x447f28[_0x78a8e7(0x209)][_0x78a8e7(0x2fc)]==_0x4067d8[_0x78a8e7(0x209)]['product_name']){_0x3c4e17+='<td\x20class=\x22row_data\x22>'+_0x4067d8[_0x78a8e7(0x214)]+_0x78a8e7(0x264),_0x4431b3=!![];break;}}!_0x4431b3&&(_0x3c4e17+=_0x78a8e7(0x316)),_0x3c4e17+=_0x78a8e7(0x351)+_0x447f28[_0x78a8e7(0x214)]+_0x78a8e7(0x264),_0x3c4e17+=_0x78a8e7(0x35e);}return _0x3c4e17;}router[a0_0x45d816(0x1fb)](a0_0x45d816(0x2de),auth,async(_0x2a8405,_0x3b055d)=>{const _0x1ebe42=a0_0x45d816;try{const {from_date:_0x48feae,to_date:_0x50aaac}=_0x2a8405[_0x1ebe42(0x2d8)],_0x25ab7e=_0x2a8405['user'],_0x244fa8=await staff[_0x1ebe42(0x2d1)]({'email':_0x25ab7e[_0x1ebe42(0x285)]});let _0x1860f9=_0x1ebe42(0x2c1);var _0x2863e1=new Date(_0x48feae),_0x10693e=new Date(_0x50aaac);const _0x295b1d={'year':_0x1ebe42(0x2d2),'month':'long','day':'numeric'},_0x2d4160=new Intl[(_0x1ebe42(0x238))](_0x1ebe42(0x354),_0x295b1d)[_0x1ebe42(0x36e)](_0x2863e1),_0x12a49b=new Intl[(_0x1ebe42(0x238))](_0x1ebe42(0x354),_0x295b1d)[_0x1ebe42(0x36e)](_0x10693e);var _0xe24a61=await dataInventoryReports(_0x48feae,_0x50aaac,_0x244fa8['_id']['valueOf']());_0x1860f9+=_0x1ebe42(0x36c),_0x1860f9+=_0x1ebe42(0x24d),_0x1860f9+='<p>'+_0x2d4160+_0x1ebe42(0x225)+_0x12a49b+'</p>',_0x1860f9+=_0x1ebe42(0x292),_0x1860f9+=_0x1ebe42(0x23f),_0x1860f9+=_0x1ebe42(0x2e5),_0x1860f9+=_0x1ebe42(0x266),_0x1860f9+='<th>\x20ITEM\x20CODE\x20</th>',_0x1860f9+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x1860f9+=_0x1ebe42(0x276),_0x1860f9+=_0x1ebe42(0x33a),_0x1860f9+=_0x1ebe42(0x2bb),_0x1860f9+=_0x1ebe42(0x30d),_0x1860f9+=_0x1ebe42(0x266),_0x1860f9+=_0xe24a61,_0x1860f9+=_0x1ebe42(0x35e),_0x1860f9+='</div>',_0x1860f9+='</div>';const _0x24f428={'format':'Letter','orientation':_0x1ebe42(0x34c)};pdf[_0x1ebe42(0x1ef)](_0x1860f9,_0x24f428)['toStream'](function(_0x35910e,_0xe807c0){const _0x59cfb5=_0x1ebe42;if(_0x35910e){_0x3b055d[_0x59cfb5(0x2a8)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x3b055d[_0x59cfb5(0x299)](_0x59cfb5(0x2db),_0x59cfb5(0x22a)),_0xe807c0[_0x59cfb5(0x2a3)](_0x3b055d);});}catch(_0xffe1e7){}}),router[a0_0x45d816(0x2bf)](a0_0x45d816(0x28d),auth,async(_0x1f10e1,_0x2bbd50)=>{const _0x3874b7=a0_0x45d816;try{const {username:_0x90757f,email:_0x2bd5f4,role:_0x154015}=_0x1f10e1[_0x3874b7(0x350)],_0x4dd146=_0x1f10e1[_0x3874b7(0x350)],_0x53155c=await profile[_0x3874b7(0x2d1)]({'email':_0x4dd146['email']}),_0x28ea62={'year':_0x3874b7(0x2d2),'month':'long','day':_0x3874b7(0x2d2)},_0x103961=await master_shop[_0x3874b7(0x343)]();console[_0x3874b7(0x1fd)](_0x3874b7(0x30a),_0x103961);const _0x1b128c=await product[_0x3874b7(0x343)]();console[_0x3874b7(0x1fd)](_0x3874b7(0x317),_0x1b128c);const _0x9b68ad=await warehouse['aggregate']([{'$unwind':_0x3874b7(0x202)},{'$lookup':{'from':_0x3874b7(0x20a),'localField':_0x3874b7(0x331),'foreignField':_0x3874b7(0x219),'as':_0x3874b7(0x34f)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x3874b7(0x2df),'product_stock':_0x3874b7(0x290)}},{'$group':{'_id':_0x3874b7(0x361),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x3874b7(0x1fd)]('Products\x20warehouse_data',_0x9b68ad),_0x9b68ad[_0x3874b7(0x2e8)](_0x3aed83=>{const _0xb4541d=_0x3874b7,_0x81e34a=_0x1b128c[_0xb4541d(0x352)](_0x36aef6=>{const _0x46ee3a=_0xb4541d;_0x36aef6[_0x46ee3a(0x219)]==_0x3aed83[_0x46ee3a(0x209)]&&(_0x36aef6['stock']=parseInt(_0x36aef6[_0x46ee3a(0x32b)])+parseInt(_0x3aed83['product_stock']));});});const _0x393d4b=await staff['findOne']({'email':_0x4dd146[_0x3874b7(0x285)]});if(_0x103961[0x0][_0x3874b7(0x32c)]==_0x3874b7(0x2fd))var _0x472c75=users[_0x3874b7(0x2dc)];else{if(_0x103961[0x0][_0x3874b7(0x32c)]==_0x3874b7(0x2bc))var _0x472c75=users[_0x3874b7(0x2bc)];else{if(_0x103961[0x0]['language']==_0x3874b7(0x355))var _0x472c75=users[_0x3874b7(0x355)];else{if(_0x103961[0x0][_0x3874b7(0x32c)]==_0x3874b7(0x24f))var _0x472c75=users[_0x3874b7(0x24f)];else{if(_0x103961[0x0][_0x3874b7(0x32c)]=='French')var _0x472c75=users[_0x3874b7(0x253)];else{if(_0x103961[0x0]['language']==_0x3874b7(0x2b0))var _0x472c75=users[_0x3874b7(0x2f8)];else{if(_0x103961[0x0]['language']==_0x3874b7(0x33d))var _0x472c75=users[_0x3874b7(0x33d)];else{if(_0x103961[0x0]['language']==_0x3874b7(0x2ff))var _0x472c75=users[_0x3874b7(0x32a)];}}}}}}}_0x2bbd50[_0x3874b7(0x31a)](_0x3874b7(0x2cd),{'success':_0x1f10e1[_0x3874b7(0x332)](_0x3874b7(0x315)),'errors':_0x1f10e1['flash'](_0x3874b7(0x235)),'alldata':_0x1b128c,'profile':_0x53155c,'master_shop':_0x103961,'role':_0x4dd146,'product_stock':_0x9b68ad,'language':_0x472c75,'staff_arr':_0x393d4b});}catch(_0x4e92a5){}});async function agentsdataDSICheck_DSRR(_0x2079e1,_0x4a2fd1,_0x46df80,_0x1bf7aa){const _0x4238cb=a0_0x45d816;let _0x3ca7d3=new Date(_0x2079e1);_0x3ca7d3[_0x4238cb(0x1fc)](_0x3ca7d3[_0x4238cb(0x2cc)]()-0x1);let _0x1df5b2=_0x3ca7d3[_0x4238cb(0x2e1)]()['split']('T')[0x0];const _0x14bc7c=await product['aggregate']([{'$group':{'_id':{'brand':_0x4238cb(0x319),'category':_0x4238cb(0x322)},'products':{'$push':{'name':'$name','product_code':_0x4238cb(0x28e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x4270de=[];_0x4270de['cat_brand']=[];for(let _0x142ef2=0x0;_0x142ef2<=_0x14bc7c[_0x4238cb(0x265)]-0x1;_0x142ef2++){const _0x9799ec=_0x14bc7c[_0x142ef2];_0x4270de[_0x4238cb(0x327)]['push'](_0x9799ec);}const _0x5dfe7f=await product[_0x4238cb(0x31d)]([{'$group':{'_id':{'category':_0x4238cb(0x322)},'products':{'$push':{'brand':_0x4238cb(0x319),'product_code':_0x4238cb(0x28e),'product_name':_0x4238cb(0x342)}}}},{'$sort':{'_id.category':-0x1}}]),_0x526705=await product[_0x4238cb(0x31d)]([{'$group':{'_id':{'category':_0x4238cb(0x322),'brand':_0x4238cb(0x319)}}},{'$group':{'_id':_0x4238cb(0x262),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xab330e=await sales_sa['aggregate']([{'$match':{'date':_0x2079e1,'sales_staff_id':_0x4a2fd1,'sale_product.isFG':_0x4238cb(0x340)}},{'$unwind':_0x4238cb(0x2ad)},{'$lookup':{'from':_0x4238cb(0x20a),'localField':_0x4238cb(0x1ff),'foreignField':'product_code','as':_0x4238cb(0x22b)}},{'$unwind':_0x4238cb(0x26f)},{'$group':{'_id':{'dsi':'$dsi','date':_0x4238cb(0x251),'customer':_0x4238cb(0x367),'status_data':_0x4238cb(0x318)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':'$cash'},'amount':{'$first':_0x4238cb(0x2aa)},'bank':{'$first':_0x4238cb(0x25c)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x4238cb(0x234),'NetPrice':_0x4238cb(0x288),'discount':_0x4238cb(0x2c5),'adj_discount':_0x4238cb(0x2b4),'product_details':{'prod_name':_0x4238cb(0x34e),'product_code':_0x4238cb(0x30e),'category':_0x4238cb(0x366),'brand':'$product_info.brand','gross_price':'$product_info.gross_price','isFG':_0x4238cb(0x2e0),'prod_cat':_0x4238cb(0x2d0),'prod_id':_0x4238cb(0x25a)}}}}},{'$unwind':_0x4238cb(0x2b2)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x4238cb(0x24c),'customer':_0x4238cb(0x25b),'status_data':'$_id.status_data','category':_0x4238cb(0x218),'brand':'$products.product_details.brand','prod_id':_0x4238cb(0x26c)},'totalQty':{'$sum':_0x4238cb(0x307)},'totalGross':{'$sum':{'$multiply':[_0x4238cb(0x307),_0x4238cb(0x23a)]}},'NetPrice':{'$sum':_0x4238cb(0x369)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x4238cb(0x21c)},'cash':{'$first':_0x4238cb(0x2c9)},'amount':{'$first':_0x4238cb(0x2aa)},'bank':{'$first':_0x4238cb(0x25c)},'check_no':{'$first':_0x4238cb(0x231)},'due_date':{'$first':_0x4238cb(0x295)},'product_details':{'$first':_0x4238cb(0x263)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x4238cb(0x24c),'customer':_0x4238cb(0x25b),'status_data':'$_id.status_data'},'totalQty':{'$sum':_0x4238cb(0x346)},'totalGross':{'$sum':_0x4238cb(0x1e5)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'cash':{'$first':_0x4238cb(0x2c9)},'amount':{'$first':_0x4238cb(0x2aa)},'bank':{'$first':_0x4238cb(0x25c)},'check_no':{'$first':_0x4238cb(0x231)},'due_date':{'$first':_0x4238cb(0x295)},'products':{'$push':{'qty':_0x4238cb(0x346),'category':_0x4238cb(0x262),'brand':_0x4238cb(0x320),'product_details':_0x4238cb(0x202)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x303562=await sales_sa[_0x4238cb(0x31d)]([{'$match':{'date':_0x1df5b2,'sales_staff_id':_0x4a2fd1,'sale_product.isFG':_0x4238cb(0x340)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x4238cb(0x20a),'localField':'sale_product.product_code','foreignField':_0x4238cb(0x2b3),'as':'product_info'}},{'$unwind':_0x4238cb(0x26f)},{'$group':{'_id':{'dsi':_0x4238cb(0x330),'date':'$date','customer':_0x4238cb(0x367)},'totalQty':{'$sum':_0x4238cb(0x234)},'cash':{'$first':_0x4238cb(0x2c9)},'amount':{'$first':'$amount'},'bank':{'$first':_0x4238cb(0x25c)},'check_no':{'$first':_0x4238cb(0x231)},'due_date':{'$first':_0x4238cb(0x295)},'products':{'$push':{'qty':_0x4238cb(0x234),'NetPrice':_0x4238cb(0x288),'discount':_0x4238cb(0x2c5),'adj_discount':_0x4238cb(0x2b4),'product_details':{'prod_name':_0x4238cb(0x34e),'product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x4238cb(0x314),'gross_price':_0x4238cb(0x2c4),'isFG':_0x4238cb(0x2e0),'prod_cat':_0x4238cb(0x2d0),'prod_id':'$sale_product._id'}}}}},{'$unwind':_0x4238cb(0x2b2)},{'$group':{'_id':{'dsi':_0x4238cb(0x1e9),'date':_0x4238cb(0x24c),'customer':_0x4238cb(0x25b),'category':_0x4238cb(0x218),'brand':_0x4238cb(0x33f),'prod_id':_0x4238cb(0x26c)},'totalQty':{'$sum':_0x4238cb(0x307)},'cash':{'$first':'$cash'},'amount':{'$first':_0x4238cb(0x2aa)},'bank':{'$first':_0x4238cb(0x25c)},'check_no':{'$first':_0x4238cb(0x231)},'due_date':{'$first':_0x4238cb(0x295)},'totalGross':{'$sum':{'$multiply':[_0x4238cb(0x307),_0x4238cb(0x23a)]}},'NetPrice':{'$sum':_0x4238cb(0x369)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x4238cb(0x263)}}},{'$group':{'_id':{'dsi':_0x4238cb(0x1e9),'date':_0x4238cb(0x24c),'customer':_0x4238cb(0x25b)},'totalQty':{'$sum':_0x4238cb(0x346)},'cash':{'$first':_0x4238cb(0x2c9)},'amount':{'$first':'$amount'},'bank':{'$first':_0x4238cb(0x25c)},'check_no':{'$first':_0x4238cb(0x231)},'due_date':{'$first':_0x4238cb(0x295)},'totalGross':{'$sum':_0x4238cb(0x1e5)},'NetPrice':{'$sum':_0x4238cb(0x2ae)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x4238cb(0x323)},'products':{'$push':{'qty':_0x4238cb(0x346),'category':_0x4238cb(0x262),'brand':_0x4238cb(0x320),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5373f3=await sales_sa[_0x4238cb(0x31d)]([{'$match':{'date':_0x2079e1,'sales_staff_id':_0x4a2fd1,'status_data':_0x4238cb(0x2e7)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x50a0a5=await staff['findById'](_0x4a2fd1);let _0x385a83=[],_0x4b1772={},_0x2efe20={};var _0x2c2bb3=0x0,_0x262ab4=0x0,_0x4ffe8a=0x0,_0x3c8a6c=0x0,_0xc83168=0x0;const _0x722fad=0x6;var _0x14f619=0x0,_0x1dd1fc=0x0;for(let _0x4f3fa3=0x0;_0x4f3fa3<=_0xab330e[_0x4238cb(0x265)]-0x1;_0x4f3fa3++){const _0x541146=_0xab330e[_0x4f3fa3];let _0x2999f0=_0x4238cb(0x266);_0x2999f0+=_0x4238cb(0x259),_0x2999f0+=_0x4238cb(0x35a)+_0x541146[_0x4238cb(0x209)][_0x4238cb(0x237)]+_0x4238cb(0x264),_0x2999f0+=_0x4238cb(0x35a)+_0x541146[_0x4238cb(0x209)][_0x4238cb(0x277)]+_0x4238cb(0x264);let _0x52fd3d={},_0x37e457={},_0x24f34c={};var _0x4e43c1={},_0x17073b={},_0x49602e={},_0x190eb9=0x0;for(let _0x585c27=0x0;_0x585c27<=_0x541146['products'][_0x4238cb(0x265)]-0x1;_0x585c27++){const _0x41995a=_0x541146[_0x4238cb(0x20a)][_0x585c27];_0x52fd3d[_0x41995a[_0x4238cb(0x2ab)]+'-'+_0x41995a['category']]=_0x41995a[_0x4238cb(0x2ca)],_0x37e457[[_0x41995a[_0x4238cb(0x2ab)]+'-'+_0x41995a['category']]]=_0x41995a[_0x4238cb(0x267)][_0x4238cb(0x312)],_0x24f34c[[_0x41995a['brand']+'-'+_0x41995a['category']]]=_0x41995a['product_details'][_0x4238cb(0x2f3)];const _0xe13aa9=_0x41995a[_0x4238cb(0x2ab)]+'-'+_0x41995a[_0x4238cb(0x36d)];!Array[_0x4238cb(0x325)](_0x2efe20[_0xe13aa9])&&(_0x2efe20[_0xe13aa9]=[]);!Array[_0x4238cb(0x325)](_0x2efe20[_0xe13aa9])&&(_0x2efe20[_0xe13aa9]=[]);_0x2efe20[_0xe13aa9]['push'](_0x41995a['qty']);if(_0x41995a['product_details']['prod_cat']=='P')_0x41995a[_0x4238cb(0x267)][_0x4238cb(0x312)]==_0x4238cb(0x2e7)?(!_0x49602e[_0xe13aa9]&&(_0x49602e[_0xe13aa9]=0x0),_0x49602e[_0xe13aa9]=_0x41995a[_0x4238cb(0x2ca)]):(!_0x4e43c1[_0xe13aa9]&&(_0x4e43c1[_0xe13aa9]=0x0),_0x4e43c1[_0xe13aa9]=_0x41995a[_0x4238cb(0x2ca)]);else _0x41995a[_0x4238cb(0x267)]['prod_cat']=='S'&&(_0x41995a[_0x4238cb(0x267)][_0x4238cb(0x312)]==_0x4238cb(0x2e7)?(!_0x49602e[_0xe13aa9]&&(_0x49602e[_0xe13aa9]=0x0),_0x49602e[_0xe13aa9]=_0x41995a[_0x4238cb(0x2ca)]):(!_0x17073b[_0xe13aa9]&&(_0x17073b[_0xe13aa9]=0x0),_0x17073b[_0xe13aa9]=_0x41995a[_0x4238cb(0x2ca)]));_0x190eb9++;}for(let _0x3dbf4a=0x0;_0x3dbf4a<=_0x4270de[_0x4238cb(0x327)]['length']-0x1;_0x3dbf4a++){const _0x1ab663=_0x4270de['cat_brand'][_0x3dbf4a],_0x8a926d=_0x1ab663[_0x4238cb(0x209)][_0x4238cb(0x2ab)]+'-'+_0x1ab663[_0x4238cb(0x209)][_0x4238cb(0x36d)],_0x3e959b=_0x24f34c[_0x8a926d]!==undefined?_0x24f34c[_0x8a926d]:'NA';var _0x475432=_0x4e43c1[_0x8a926d]!==undefined?_0x4e43c1[_0x8a926d][_0x4238cb(0x337)](0x2):'',_0x1fc453=_0x17073b[_0x8a926d]!==undefined?_0x17073b[_0x8a926d]['toFixed'](0x2):'',_0x510108=_0x49602e[_0x8a926d]!==undefined?_0x49602e[_0x8a926d][_0x4238cb(0x337)](0x2):'';_0x2999f0+=_0x4238cb(0x2fa)+_0x475432+_0x4238cb(0x264),_0x2999f0+=_0x4238cb(0x2fa)+_0x1fc453+_0x4238cb(0x264),_0x2999f0+=_0x4238cb(0x2fa)+_0x510108+_0x4238cb(0x264);}var _0x2c7d51=formatNumber(parseFloat(_0x541146[_0x4238cb(0x222)])),_0x121c2c=formatNumber(parseFloat(_0x541146[_0x4238cb(0x25e)]));isNaN(_0x121c2c)&&(_0x121c2c=0x0),_0x2999f0+=_0x4238cb(0x2fa)+_0x2c7d51+_0x4238cb(0x264),_0x2999f0+=_0x4238cb(0x2fa)+_0x121c2c+_0x4238cb(0x264),_0x2999f0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x541146['bank']+_0x4238cb(0x264),_0x2999f0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x541146['check_no']+_0x4238cb(0x264),_0x2999f0+=_0x4238cb(0x35a)+_0x541146[_0x4238cb(0x2f4)]+_0x4238cb(0x264),_0x4ffe8a=_0x541146[_0x4238cb(0x28f)]+_0x541146['adj_discount'],_0x14f619+=parseFloat(_0x541146[_0x4238cb(0x222)]),_0x1dd1fc+=parseFloat(_0x121c2c),_0x385a83[_0x4238cb(0x23c)](_0x2999f0);}function _0x208fe2(_0x5a1808,_0x4a8d48){const _0x492cc8=_0x4238cb,_0x3d5403=[];for(let _0xa804ae=0x0;_0xa804ae<=_0x5a1808[_0x492cc8(0x265)]-0x1;_0xa804ae+=_0x4a8d48){_0x3d5403[_0x492cc8(0x23c)](_0x5a1808['slice'](_0xa804ae,_0xa804ae+_0x4a8d48));}return _0x3d5403;}const _0x3aa905=_0x208fe2(_0x385a83,_0x722fad);let _0x2f4759='';return _0x3aa905[_0x4238cb(0x2e8)]((_0x24d082,_0xd85a26)=>{const _0x436fa4=_0x4238cb;_0xd85a26>0x0&&(_0x2f4759+=_0x436fa4(0x254));_0x2f4759+=_0x436fa4(0x2e5),_0x2f4759+=_0x436fa4(0x280);const _0x575a01=new Date(_0x2079e1),_0x48d8dc={'year':_0x436fa4(0x2d2),'month':_0x436fa4(0x2e9),'day':_0x436fa4(0x2d2),'timeZone':_0x436fa4(0x26e)},_0x2a2196=_0x575a01[_0x436fa4(0x348)](_0x436fa4(0x354),_0x48d8dc);_0x2f4759+='<tr>',_0x2f4759+=_0x436fa4(0x2f2)+_0x1bf7aa+'</b></td>',_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+='<tr>',_0x2f4759+=_0x436fa4(0x201)+_0x50a0a5[_0x436fa4(0x219)]+_0x436fa4(0x264),_0x2f4759+=_0x436fa4(0x345),_0x2f4759+=_0x436fa4(0x29c),_0x2f4759+='<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>',_0x2f4759+=_0x436fa4(0x27d),_0x2f4759+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x2f4759+=_0x436fa4(0x338),_0x2f4759+=_0x436fa4(0x274),_0x2f4759+=_0x436fa4(0x298),_0x2f4759+='</tr>',_0x2f4759+=_0x436fa4(0x266),_0x2f4759+=_0x436fa4(0x21a),_0x2f4759+=_0x436fa4(0x29a)+_0x2a2196+_0x436fa4(0x264),_0x2f4759+=_0x436fa4(0x211),_0x2f4759+=_0x436fa4(0x22d),_0x2f4759+=_0x436fa4(0x2e6),_0x2f4759+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+='<tr>',_0x2f4759+=_0x436fa4(0x2ba),_0x2f4759+=_0x436fa4(0x200),_0x2f4759+=_0x436fa4(0x31f),_0x2f4759+=_0x436fa4(0x2e6),_0x2f4759+=_0x436fa4(0x2e6),_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+=_0x436fa4(0x266),_0x2f4759+=_0x436fa4(0x30b),_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+=_0x436fa4(0x266),_0x2f4759+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x2f4759+='<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>',_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+=_0x436fa4(0x266),_0x2f4759+=_0x436fa4(0x1f9),_0x2f4759+=_0x436fa4(0x324),_0x2f4759+=_0x436fa4(0x1f3);for(let _0x41877e=0x0;_0x41877e<=_0x5dfe7f[_0x436fa4(0x265)]-0x1;_0x41877e++){const _0xe28846=_0x5dfe7f[_0x41877e];for(let _0x490a5e=0x0;_0x490a5e<_0x4270de[_0x436fa4(0x327)][_0x436fa4(0x265)];_0x490a5e++){const _0x2f53b2=_0x4270de[_0x436fa4(0x327)][_0x490a5e];if(_0x2f53b2[_0x436fa4(0x209)][_0x436fa4(0x36d)]===_0xe28846[_0x436fa4(0x209)][_0x436fa4(0x36d)]){var _0x549f00='';switch(_0xe28846['_id'][_0x436fa4(0x36d)]){case _0x436fa4(0x2a2):_0x549f00=_0x2f53b2[_0x436fa4(0x209)]['brand']+'\x20-\x20STD';break;case _0x436fa4(0x248):_0x549f00=_0x2f53b2[_0x436fa4(0x209)][_0x436fa4(0x2ab)]+_0x436fa4(0x28c);break;default:_0x549f00=_0x2f53b2[_0x436fa4(0x209)][_0x436fa4(0x2ab)];break;}_0x2f4759+=_0x436fa4(0x328)+_0x549f00+_0x436fa4(0x1f0);}}}_0x2f4759+=_0x436fa4(0x1ee),_0x2f4759+=_0x436fa4(0x321),_0x2f4759+='<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>',_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+='<tr>',_0x2f4759+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x3d21c6=0x0;_0x3d21c6<=_0x4270de[_0x436fa4(0x327)][_0x436fa4(0x265)]-0x1;_0x3d21c6++){const _0x193bcc=_0x4270de[_0x3d21c6];_0x2f4759+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x2f4759+=_0x436fa4(0x32f),_0x2f4759+=_0x436fa4(0x1f6);}_0x2f4759+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>',_0x2f4759+=_0x436fa4(0x35f),_0x2f4759+=_0x436fa4(0x224),_0x2f4759+='</tr>',_0x2f4759+='</thead>',_0x2f4759+='<tbody>',_0x24d082[_0x436fa4(0x2e8)](_0x40a4cf=>{_0x2f4759+=_0x40a4cf;});let _0x29093={},_0x23d7ef={},_0x43e203={};for(let _0x2297c3=0x0;_0x2297c3<=_0xab330e[_0x436fa4(0x265)]-0x1;_0x2297c3++){const _0x4646af=_0xab330e[_0x2297c3];var _0x257174=0x0;for(let _0x135ebb=0x0;_0x135ebb<=_0x4646af[_0x436fa4(0x20a)][_0x436fa4(0x265)]-0x1;_0x135ebb++){const _0x3719b7=_0x4646af[_0x436fa4(0x20a)][_0x135ebb],_0xc097be=_0x3719b7[_0x436fa4(0x2ab)]+'-'+_0x3719b7[_0x436fa4(0x36d)];if(_0x3719b7[_0x436fa4(0x267)][_0x436fa4(0x2f3)]=='P')_0x3719b7[_0x436fa4(0x267)][_0x436fa4(0x312)]==_0x436fa4(0x2e7)?(!_0x43e203[_0xc097be]&&(_0x43e203[_0xc097be]=0x0),_0x43e203[_0xc097be]+=_0x3719b7[_0x436fa4(0x2ca)]):(!_0x29093[_0xc097be]&&(_0x29093[_0xc097be]=0x0),_0x29093[_0xc097be]+=_0x3719b7[_0x436fa4(0x2ca)]);else _0x3719b7[_0x436fa4(0x267)][_0x436fa4(0x2f3)]=='S'&&(_0x3719b7['product_details'][_0x436fa4(0x312)]=='true'?(!_0x43e203[_0xc097be]&&(_0x43e203[_0xc097be]=0x0),_0x43e203[_0xc097be]+=_0x3719b7['qty'],console[_0x436fa4(0x1fd)](_0x3719b7[_0x436fa4(0x2ca)])):(!_0x23d7ef[_0xc097be]&&(_0x23d7ef[_0xc097be]=0x0),_0x23d7ef[_0xc097be]+=_0x3719b7['qty']));_0x257174++;}}let _0x36ccbd={},_0x116b82={},_0x422374={};var _0x296915=0x0,_0x198540=0x0;for(let _0x5ee708=0x0;_0x5ee708<=_0x303562[_0x436fa4(0x265)]-0x1;_0x5ee708++){const _0xd33b4f=_0x303562[_0x5ee708];var _0x257174=0x0;for(let _0x56dc31=0x0;_0x56dc31<=_0xd33b4f[_0x436fa4(0x20a)][_0x436fa4(0x265)]-0x1;_0x56dc31++){const _0x45b9b2=_0xd33b4f[_0x436fa4(0x20a)][_0x56dc31],_0x35931a=_0x45b9b2[_0x436fa4(0x2ab)]+'-'+_0x45b9b2[_0x436fa4(0x36d)];if(_0x45b9b2['product_details'][_0x436fa4(0x2f3)]=='P')_0x45b9b2[_0x436fa4(0x267)][_0x436fa4(0x312)]==_0x436fa4(0x2e7)?(!_0x422374[_0x35931a]&&(_0x422374[_0x35931a]=0x0),_0x422374[_0x35931a]+=_0x45b9b2['qty']):(!_0x36ccbd[_0x35931a]&&(_0x36ccbd[_0x35931a]=0x0),_0x36ccbd[_0x35931a]+=_0x45b9b2[_0x436fa4(0x2ca)]);else _0x45b9b2[_0x436fa4(0x267)][_0x436fa4(0x2f3)]=='S'&&(_0x45b9b2['product_details']['isFG']==_0x436fa4(0x2e7)?(!_0x422374[_0x35931a]&&(_0x422374[_0x35931a]=0x0),_0x422374[_0x35931a]+=_0x45b9b2[_0x436fa4(0x2ca)]):(!_0x116b82[_0x35931a]&&(_0x116b82[_0x35931a]=0x0),_0x116b82[_0x35931a]+=_0x45b9b2[_0x436fa4(0x2ca)]));_0x257174++;}var _0x3eb6fd=parseFloat(_0xd33b4f[_0x436fa4(0x222)]),_0xa660db=parseFloat(_0xd33b4f[_0x436fa4(0x25e)]);isNaN(_0xa660db)&&(_0xa660db=0x0),_0x296915+=_0x3eb6fd,_0x198540+=_0xa660db;}if(_0x5373f3[_0x436fa4(0x265)]>0x0)for(let _0x102b29=0x0;_0x102b29<=_0x5373f3[_0x436fa4(0x265)]-0x1;_0x102b29++){const _0x5a5b17=_0x5373f3[_0x102b29];console[_0x436fa4(0x1fd)](_0x5a5b17),_0x2f4759+='<tr>',_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22'+(0x8+0x7*0x3)+_0x436fa4(0x2ee)+_0x5a5b17['note']+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x35e);}_0x2f4759+=_0x436fa4(0x266),_0x2f4759+=_0x436fa4(0x368),_0x2f4759+=_0x436fa4(0x2ed),_0x2f4759+=_0x436fa4(0x259);for(let _0x4421ca=0x0;_0x4421ca<=_0x4270de['cat_brand'][_0x436fa4(0x265)]-0x1;_0x4421ca++){const _0x531374=_0x4270de[_0x436fa4(0x327)][_0x4421ca],_0x2ae797=_0x531374['_id'][_0x436fa4(0x2ab)]+'-'+_0x531374[_0x436fa4(0x209)][_0x436fa4(0x36d)];var _0x12df5d=_0x29093[_0x2ae797]!==undefined?formatNumber(_0x29093[_0x2ae797][_0x436fa4(0x337)](0x2)):'',_0x44dc5f=_0x43e203[_0x2ae797]!==undefined?formatNumber(_0x43e203[_0x2ae797][_0x436fa4(0x337)](0x2)):'',_0x2cc80e=_0x23d7ef[_0x2ae797]!==undefined?formatNumber(_0x23d7ef[_0x2ae797][_0x436fa4(0x337)](0x2)):'';_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x12df5d+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x203)+_0x2cc80e+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x203)+_0x44dc5f+_0x436fa4(0x1f0);}_0x2f4759+=_0x436fa4(0x203)+formatNumber(_0x14f619)+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x203)+formatNumber(_0x1dd1fc)+_0x436fa4(0x1f0),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+='<tr>',_0x2f4759+=_0x436fa4(0x368),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>',_0x2f4759+=_0x436fa4(0x259);for(let _0x103a68=0x0;_0x103a68<=_0x4270de[_0x436fa4(0x327)][_0x436fa4(0x265)]-0x1;_0x103a68++){const _0x5e6c91=_0x4270de[_0x436fa4(0x327)][_0x103a68],_0x17e3d4=_0x5e6c91['_id'][_0x436fa4(0x2ab)]+'-'+_0x5e6c91[_0x436fa4(0x209)][_0x436fa4(0x36d)];var _0x12df5d=_0x36ccbd[_0x17e3d4]!==undefined?formatNumber(_0x36ccbd[_0x17e3d4][_0x436fa4(0x337)](0x2)):'',_0x44dc5f=_0x422374[_0x17e3d4]!==undefined?formatNumber(_0x422374[_0x17e3d4][_0x436fa4(0x337)](0x2)):'',_0x2cc80e=_0x116b82[_0x17e3d4]!==undefined?formatNumber(_0x116b82[_0x17e3d4][_0x436fa4(0x337)](0x2)):'';_0x2f4759+=_0x436fa4(0x203)+_0x12df5d+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x203)+_0x2cc80e+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x203)+_0x44dc5f+_0x436fa4(0x1f0);}_0x2f4759+=_0x436fa4(0x203)+formatNumber(_0x296915)+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x203)+formatNumber(_0x198540)+_0x436fa4(0x1f0),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+=_0x436fa4(0x266),_0x2f4759+=_0x436fa4(0x368),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x2f4759+=_0x436fa4(0x259);let _0x36d0e8=0x0,_0x196e15=0x0,_0x12f841=0x0;for(let _0x5ee6d6=0x0;_0x5ee6d6<=_0x4270de[_0x436fa4(0x327)][_0x436fa4(0x265)]-0x1;_0x5ee6d6++){const _0xb60f70=_0x4270de[_0x436fa4(0x327)][_0x5ee6d6],_0x1b698d=_0xb60f70['_id'][_0x436fa4(0x2ab)]+'-'+_0xb60f70[_0x436fa4(0x209)][_0x436fa4(0x36d)];var _0x1c2de8=_0x29093[_0x1b698d]!==undefined?_0x29093[_0x1b698d][_0x436fa4(0x337)](0x2):'0',_0xf16a28=_0x43e203[_0x1b698d]!==undefined?_0x43e203[_0x1b698d][_0x436fa4(0x337)](0x2):'0',_0x23320e=_0x23d7ef[_0x1b698d]!==undefined?_0x23d7ef[_0x1b698d]['toFixed'](0x2):'0',_0xcc8389=_0x36ccbd[_0x1b698d]!==undefined?_0x36ccbd[_0x1b698d][_0x436fa4(0x337)](0x2):'0',_0x419eea=_0x422374[_0x1b698d]!==undefined?_0x422374[_0x1b698d][_0x436fa4(0x337)](0x2):'0',_0x1a3b4f=_0x116b82[_0x1b698d]!==undefined?_0x116b82[_0x1b698d][_0x436fa4(0x337)](0x2):'0';_0x36d0e8=parseFloat(_0x1c2de8)+parseFloat(_0xcc8389),_0x196e15=parseFloat(_0x23320e)+parseFloat(_0x1a3b4f),_0x12f841=parseFloat(_0xf16a28)+parseFloat(_0x419eea),_0x2f4759+=_0x436fa4(0x203)+formatNumber(_0x36d0e8['toFixed'](0x2))+_0x436fa4(0x1f0),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x196e15[_0x436fa4(0x337)](0x2))+_0x436fa4(0x1f0),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x12f841[_0x436fa4(0x337)](0x2))+_0x436fa4(0x1f0);}var _0x5291d3=formatNumber(_0x14f619+_0x296915),_0x50d812=formatNumber(_0x1dd1fc+_0x198540);_0x2f4759+=_0x436fa4(0x203)+_0x5291d3+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x203)+_0x50d812+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+='<tr>',_0x2f4759+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x4270de['cat_brand'][_0x436fa4(0x265)]*0x3+0x9)+_0x436fa4(0x306),_0x2f4759+='</tr>',_0x2f4759+=_0x436fa4(0x266),_0x2f4759+=_0x436fa4(0x368),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x2f4759+=_0x436fa4(0x259);for(let _0x47d555=0x0;_0x47d555<=_0x4270de[_0x436fa4(0x327)][_0x436fa4(0x265)]-0x1;_0x47d555++){const _0x3900be=_0x4270de[_0x436fa4(0x327)][_0x47d555],_0x101e4b=_0x3900be[_0x436fa4(0x209)][_0x436fa4(0x2ab)]+'-'+_0x3900be[_0x436fa4(0x209)][_0x436fa4(0x36d)];var _0x1c2de8=_0x29093[_0x101e4b]!==undefined?_0x29093[_0x101e4b][_0x436fa4(0x337)](0x2):'0',_0xf16a28=_0x43e203[_0x101e4b]!==undefined?_0x43e203[_0x101e4b]['toFixed'](0x2):'0',_0x23320e=_0x23d7ef[_0x101e4b]!==undefined?_0x23d7ef[_0x101e4b]['toFixed'](0x2):'0',_0xcc8389=_0x36ccbd[_0x101e4b]!==undefined?_0x36ccbd[_0x101e4b]['toFixed'](0x2):'0',_0x419eea=_0x422374[_0x101e4b]!==undefined?_0x422374[_0x101e4b]['toFixed'](0x2):'0',_0x1a3b4f=_0x116b82[_0x101e4b]!==undefined?_0x116b82[_0x101e4b]['toFixed'](0x2):'0';_0x36d0e8=parseFloat(_0x1c2de8)+parseFloat(_0xcc8389),_0x196e15=parseFloat(_0x23320e)+parseFloat(_0x1a3b4f),_0x12f841=parseFloat(_0xf16a28)+parseFloat(_0x419eea),_0x2f4759+=_0x436fa4(0x35b),_0x2f4759+=_0x436fa4(0x35b),_0x2f4759+=_0x436fa4(0x35b);}_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+=_0x436fa4(0x266),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x2f4759+=_0x436fa4(0x301),_0x2f4759+=_0x436fa4(0x259);for(let _0x174e78=0x0;_0x174e78<=_0x4270de['cat_brand'][_0x436fa4(0x265)]-0x1;_0x174e78++){const _0x2ea944=_0x4270de[_0x436fa4(0x327)][_0x174e78],_0x4dced2=_0x2ea944[_0x436fa4(0x209)][_0x436fa4(0x2ab)]+'-'+_0x2ea944[_0x436fa4(0x209)][_0x436fa4(0x36d)];var _0x1c2de8=_0x29093[_0x4dced2]!==undefined?_0x29093[_0x4dced2][_0x436fa4(0x337)](0x2):'0',_0xf16a28=_0x43e203[_0x4dced2]!==undefined?_0x43e203[_0x4dced2][_0x436fa4(0x337)](0x2):'0',_0x23320e=_0x23d7ef[_0x4dced2]!==undefined?_0x23d7ef[_0x4dced2][_0x436fa4(0x337)](0x2):'0',_0xcc8389=_0x36ccbd[_0x4dced2]!==undefined?_0x36ccbd[_0x4dced2][_0x436fa4(0x337)](0x2):'0',_0x419eea=_0x422374[_0x4dced2]!==undefined?_0x422374[_0x4dced2][_0x436fa4(0x337)](0x2):'0',_0x1a3b4f=_0x116b82[_0x4dced2]!==undefined?_0x116b82[_0x4dced2][_0x436fa4(0x337)](0x2):'0';_0x36d0e8=parseFloat(_0x1c2de8)+parseFloat(_0xcc8389),_0x196e15=parseFloat(_0x23320e)+parseFloat(_0x1a3b4f),_0x12f841=parseFloat(_0xf16a28)+parseFloat(_0x419eea),_0x2f4759+=_0x436fa4(0x35b),_0x2f4759+=_0x436fa4(0x35b),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+='</tr>',_0x2f4759+='<tr>',_0x2f4759+=_0x436fa4(0x368),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x2f4759+=_0x436fa4(0x259);for(let _0x8650b1=0x0;_0x8650b1<=_0x4270de['cat_brand'][_0x436fa4(0x265)]-0x1;_0x8650b1++){const _0x5558d6=_0x4270de['cat_brand'][_0x8650b1],_0x256669=_0x5558d6[_0x436fa4(0x209)][_0x436fa4(0x2ab)]+'-'+_0x5558d6[_0x436fa4(0x209)][_0x436fa4(0x36d)];var _0x1c2de8=_0x29093[_0x256669]!==undefined?_0x29093[_0x256669][_0x436fa4(0x337)](0x2):'0',_0xf16a28=_0x43e203[_0x256669]!==undefined?_0x43e203[_0x256669][_0x436fa4(0x337)](0x2):'0',_0x23320e=_0x23d7ef[_0x256669]!==undefined?_0x23d7ef[_0x256669][_0x436fa4(0x337)](0x2):'0',_0xcc8389=_0x36ccbd[_0x256669]!==undefined?_0x36ccbd[_0x256669][_0x436fa4(0x337)](0x2):'0',_0x419eea=_0x422374[_0x256669]!==undefined?_0x422374[_0x256669][_0x436fa4(0x337)](0x2):'0',_0x1a3b4f=_0x116b82[_0x256669]!==undefined?_0x116b82[_0x256669]['toFixed'](0x2):'0';_0x36d0e8=parseFloat(_0x1c2de8)+parseFloat(_0xcc8389),_0x196e15=parseFloat(_0x23320e)+parseFloat(_0x1a3b4f),_0x12f841=parseFloat(_0xf16a28)+parseFloat(_0x419eea),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x2f4759+=_0x436fa4(0x35b),_0x2f4759+=_0x436fa4(0x35b);}_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+=_0x436fa4(0x266),_0x2f4759+=_0x436fa4(0x368),_0x2f4759+=_0x436fa4(0x2ed),_0x2f4759+=_0x436fa4(0x259);for(let _0x2986f3=0x0;_0x2986f3<=_0x4270de[_0x436fa4(0x327)][_0x436fa4(0x265)]-0x1;_0x2986f3++){const _0x2e1a0a=_0x4270de[_0x436fa4(0x327)][_0x2986f3],_0x5b3f92=_0x2e1a0a[_0x436fa4(0x209)][_0x436fa4(0x2ab)]+'-'+_0x2e1a0a[_0x436fa4(0x209)][_0x436fa4(0x36d)];var _0x1c2de8=_0x29093[_0x5b3f92]!==undefined?_0x29093[_0x5b3f92][_0x436fa4(0x337)](0x2):'',_0xf16a28=_0x43e203[_0x5b3f92]!==undefined?_0x43e203[_0x5b3f92][_0x436fa4(0x337)](0x2):'',_0x23320e=_0x23d7ef[_0x5b3f92]!==undefined?_0x23d7ef[_0x5b3f92][_0x436fa4(0x337)](0x2):'',_0xcc8389=_0x36ccbd[_0x5b3f92]!==undefined?_0x36ccbd[_0x5b3f92][_0x436fa4(0x337)](0x2):'',_0x419eea=_0x422374[_0x5b3f92]!==undefined?_0x422374[_0x5b3f92]['toFixed'](0x2):'',_0x1a3b4f=_0x116b82[_0x5b3f92]!==undefined?_0x116b82[_0x5b3f92][_0x436fa4(0x337)](0x2):'';_0x36d0e8=formatNumber(parseFloat(_0x1c2de8)+parseFloat(_0xcc8389)),_0x196e15=formatNumber(parseFloat(_0x23320e)+parseFloat(_0x1a3b4f)),_0x12f841=formatNumber(parseFloat(_0xf16a28)+parseFloat(_0x419eea)),_0x2f4759+=_0x436fa4(0x203)+_0x1c2de8+_0x436fa4(0x1f0),_0x2f4759+=_0x436fa4(0x203)+_0x23320e+'</b></td>',_0x2f4759+=_0x436fa4(0x203)+_0xf16a28+_0x436fa4(0x1f0);}_0x2f4759+=_0x436fa4(0x259),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+=_0x436fa4(0x259),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+=_0x436fa4(0x266),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x2f4759+=_0x436fa4(0x2ea),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x50d932=0x0;_0x50d932<=_0x4270de['cat_brand'][_0x436fa4(0x265)]-0x1;_0x50d932++){const _0xe28e9e=_0x4270de[_0x436fa4(0x327)][_0x50d932],_0x5ad4ec=_0xe28e9e[_0x436fa4(0x209)][_0x436fa4(0x2ab)]+'-'+_0xe28e9e[_0x436fa4(0x209)][_0x436fa4(0x36d)];var _0x1c2de8=_0x29093[_0x5ad4ec]!==undefined?_0x29093[_0x5ad4ec][_0x436fa4(0x337)](0x2):'0',_0xf16a28=_0x43e203[_0x5ad4ec]!==undefined?_0x43e203[_0x5ad4ec][_0x436fa4(0x337)](0x2):'0',_0x23320e=_0x23d7ef[_0x5ad4ec]!==undefined?_0x23d7ef[_0x5ad4ec][_0x436fa4(0x337)](0x2):'0',_0xcc8389=_0x36ccbd[_0x5ad4ec]!==undefined?_0x36ccbd[_0x5ad4ec][_0x436fa4(0x337)](0x2):'0',_0x419eea=_0x422374[_0x5ad4ec]!==undefined?_0x422374[_0x5ad4ec][_0x436fa4(0x337)](0x2):'0',_0x1a3b4f=_0x116b82[_0x5ad4ec]!==undefined?_0x116b82[_0x5ad4ec]['toFixed'](0x2):'0';_0x36d0e8=parseFloat(_0x1c2de8)+parseFloat(_0xcc8389),_0x196e15=parseFloat(_0x23320e)+parseFloat(_0x1a3b4f),_0x12f841=parseFloat(_0xf16a28)+parseFloat(_0x419eea),_0x2f4759+=_0x436fa4(0x35b),_0x2f4759+=_0x436fa4(0x35b),_0x2f4759+=_0x436fa4(0x35b);}_0x2f4759+=_0x436fa4(0x259),_0x2f4759+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x259),_0x2f4759+=_0x436fa4(0x35e),_0x2f4759+=_0x436fa4(0x364),_0x2f4759+=_0x436fa4(0x2f7);}),_0x2f4759;}async function generateReferenceNumber(_0x1489cc,_0x47ac97,_0x3e4d6c){const _0x44dbdb=a0_0x45d816,_0x174a53=new Date(_0x1489cc)[_0x44dbdb(0x287)](),_0x2fa502=('0'+(new Date(_0x1489cc)[_0x44dbdb(0x216)]()+0x1))[_0x44dbdb(0x1f1)](-0x2),_0xfd2585=('0'+new Date(_0x1489cc)[_0x44dbdb(0x2cc)]())['slice'](-0x2),_0x116baa=await staff[_0x44dbdb(0x2d1)]({'email':_0x3e4d6c[_0x44dbdb(0x285)]}),_0x5cac5f=_0x116baa['sales_man_code'],_0x44b1c7=_0x5cac5f+'-'+_0x174a53+_0x2fa502+_0xfd2585,_0x14be57=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x44b1c7),'salesman_code':_0x5cac5f})[_0x44dbdb(0x269)]({'createdAt':-0x1}),_0x1cb22e=_0x44b1c7;_0x14be57&&(_0x1cb22e=_0x14be57[_0x44dbdb(0x293)]);console[_0x44dbdb(0x1fd)](_0x1cb22e);const _0x525324=new Reference({'referenceNumber':_0x1cb22e,'staff_id':_0x47ac97,'salesman_code':_0x5cac5f});return await _0x525324[_0x44dbdb(0x2b9)](),_0x1cb22e;}router[a0_0x45d816(0x1fb)](a0_0x45d816(0x30c),auth,async(_0x112b28,_0x8d067e)=>{const _0x4ae16d=a0_0x45d816,{from_date:_0x4e4b16,dataview:_0x13f2ed}=_0x112b28[_0x4ae16d(0x2d8)],_0x548339=_0x112b28[_0x4ae16d(0x350)],_0x71a563=await staff['findOne']({'email':_0x548339[_0x4ae16d(0x285)]}),_0x42d0f9=await master_shop[_0x4ae16d(0x343)](),_0x112e8c='';var _0x8e23f7=new Date(_0x4e4b16);const _0x289f69={'year':_0x4ae16d(0x2d2),'month':_0x4ae16d(0x2e9),'day':_0x4ae16d(0x2d2)},_0x28cb8a=new Intl[(_0x4ae16d(0x238))]('en-US',_0x289f69)[_0x4ae16d(0x36e)](_0x8e23f7),_0x680641=await Reference['find']({'staff_id':_0x71a563[_0x4ae16d(0x209)][_0x4ae16d(0x243)](),'date_include':_0x4e4b16});if(_0x680641['length']>0x0){let _0x3026b7='';_0x3026b7+=_0x680641[0x0][_0x4ae16d(0x347)];if(_0x13f2ed==_0x4ae16d(0x291)){const _0x28cb8b=cheerio[_0x4ae16d(0x2f1)](_0x3026b7);let _0x5e5ffc=[],_0x44cbef=[],_0x10f458=[];const _0x307ecd=_0x376634=>{const _0x5d8c27=_0x4ae16d,_0x318990={'top':{'style':_0x5d8c27(0x25f),'color':{'rgb':_0x5d8c27(0x32d)}},'bottom':{'style':'thick','color':{'rgb':_0x5d8c27(0x32d)}},'left':{'style':'thick','color':{'rgb':_0x5d8c27(0x32d)}},'right':{'style':_0x5d8c27(0x25f),'color':{'rgb':_0x5d8c27(0x32d)}}};if(_0x376634){const _0x451755=_0x376634['split'](';')[_0x5d8c27(0x300)]((_0x28d6c8,_0x5878ea)=>{const _0xb9935d=_0x5d8c27,[_0x1e9761,_0x27c3b6]=_0x5878ea['split'](':')['map'](_0x2245d2=>_0x2245d2[_0xb9935d(0x2f0)]());return _0x28d6c8[_0x1e9761]=_0x27c3b6,_0x28d6c8;},{});_0x451755[_0x5d8c27(0x27c)]&&(_0x318990[_0x5d8c27(0x335)][_0x5d8c27(0x2d4)]=_0x451755['border-top'][_0x5d8c27(0x2af)](_0x5d8c27(0x35d))?_0x5d8c27(0x35d):'medium'),_0x451755[_0x5d8c27(0x2b7)]&&(_0x318990['bottom']['style']=_0x451755[_0x5d8c27(0x2b7)][_0x5d8c27(0x2af)]('thin')?_0x5d8c27(0x35d):_0x5d8c27(0x226)),_0x451755[_0x5d8c27(0x205)]&&(_0x318990['left'][_0x5d8c27(0x2d4)]=_0x451755['border-left'][_0x5d8c27(0x2af)](_0x5d8c27(0x35d))?_0x5d8c27(0x35d):_0x5d8c27(0x226)),_0x451755[_0x5d8c27(0x22c)]&&(_0x318990['right'][_0x5d8c27(0x2d4)]=_0x451755[_0x5d8c27(0x22c)][_0x5d8c27(0x2af)](_0x5d8c27(0x35d))?_0x5d8c27(0x35d):_0x5d8c27(0x226));}return _0x318990;};_0x28cb8b(_0x4ae16d(0x326))[_0x4ae16d(0x2ac)]((_0x5c118c,_0x229556)=>{const _0x280c5e=_0x4ae16d;let _0x56850c=[],_0x3ffa5e=0x0;while(_0x10f458[_0x3ffa5e]){_0x10f458[_0x3ffa5e]--,_0x3ffa5e++;}_0x28cb8b(_0x229556)['find'](_0x280c5e(0x2be))['each']((_0x26e475,_0x1697cc)=>{const _0x17a865=_0x280c5e;let _0x3d8950=_0x28cb8b(_0x1697cc)[_0x17a865(0x1eb)]()[_0x17a865(0x2f0)](),_0x1810d4=parseFloat(_0x3d8950['replace'](/,/g,''));isNaN(_0x1810d4)&&(_0x1810d4=_0x3d8950);let _0x382ffe=parseInt(_0x28cb8b(_0x1697cc)[_0x17a865(0x278)](_0x17a865(0x334)))||0x1,_0x593a50=parseInt(_0x28cb8b(_0x1697cc)['attr'](_0x17a865(0x360)))||0x1;const _0x76ba57=_0x28cb8b(_0x1697cc)[_0x17a865(0x278)]('style'),_0x1ade69=_0x307ecd(_0x76ba57);_0x56850c[_0x3ffa5e]={'v':_0x1810d4,'s':{'border':_0x1ade69}};(_0x382ffe>0x1||_0x593a50>0x1)&&_0x44cbef[_0x17a865(0x23c)]({'s':{'r':_0x5c118c,'c':_0x3ffa5e},'e':{'r':_0x5c118c+_0x593a50-0x1,'c':_0x3ffa5e+_0x382ffe-0x1}});for(let _0x2ba61d=0x0;_0x2ba61d<_0x382ffe;_0x2ba61d++){_0x593a50>0x1&&(_0x10f458[_0x3ffa5e+_0x2ba61d]=_0x593a50-0x1);}_0x3ffa5e+=_0x382ffe;}),_0x5e5ffc[_0x280c5e(0x23c)](_0x56850c);});const _0x5cfca5=XLSX[_0x4ae16d(0x28a)][_0x4ae16d(0x305)](),_0x39dd48=XLSX['utils'][_0x4ae16d(0x239)](_0x5e5ffc);_0x44cbef[_0x4ae16d(0x265)]>0x0&&(_0x39dd48['!merges']=_0x44cbef);_0x39dd48[_0x4ae16d(0x26a)]=_0x5e5ffc[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x4ae16d(0x28a)][_0x4ae16d(0x220)](_0x5cfca5,_0x39dd48,'Sales\x20Report');const _0x46fa61=XLSX[_0x4ae16d(0x212)](_0x5cfca5,{'bookType':'xlsx','type':'buffer'});_0x8d067e[_0x4ae16d(0x299)](_0x4ae16d(0x297),_0x4ae16d(0x1f5)),_0x8d067e[_0x4ae16d(0x299)](_0x4ae16d(0x2db),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x8d067e[_0x4ae16d(0x2c7)](_0x46fa61);}else{let _0x497ffe='';_0x497ffe+=_0x3026b7,_0x497ffe+='<script>',_0x497ffe+=_0x4ae16d(0x20b),_0x497ffe+='window.print();',_0x497ffe+='};',_0x497ffe+=_0x4ae16d(0x294),_0x8d067e[_0x4ae16d(0x2c7)](_0x497ffe);}}else generateReferenceNumber(_0x4e4b16,_0x71a563['_id']['valueOf'](),_0x548339)['then'](async _0xdf391e=>{const _0x363d22=_0x4ae16d,_0x3fe330=await agentsdataDSICheck_DSRR(_0x4e4b16,_0x71a563[_0x363d22(0x209)][_0x363d22(0x243)](),_0x112e8c,_0xdf391e);let _0x3607d4='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x3607d4+='<div\x20class=\x22row\x22>',_0x3607d4+='<div\x20\x20id=\x22table-conatainer\x22>',_0x3607d4+=_0x363d22(0x2e5),_0x3607d4+=_0x3fe330,_0x3607d4+='</table>',_0x3607d4+=_0x363d22(0x255),_0x3607d4+=_0x363d22(0x255);if(_0x3fe330[_0x363d22(0x265)]>0x0){const _0x2eb887=await Reference[_0x363d22(0x2d1)]({'staff_id':_0x71a563[_0x363d22(0x209)]['valueOf'](),'referenceNumber':_0xdf391e});_0x2eb887[_0x363d22(0x347)]=_0x3607d4,_0x2eb887[_0x363d22(0x36b)]=_0x4e4b16,await _0x2eb887[_0x363d22(0x2b9)]();if(_0x13f2ed==_0x363d22(0x291)){const _0x5e8336=cheerio[_0x363d22(0x2f1)](_0x3607d4);let _0x5beab4=[],_0x5902a0=[],_0x23fe7e=[];const _0x50b684=_0x169c6a=>{const _0x59cda3=_0x363d22,_0x11f8ee={'top':{'style':_0x59cda3(0x25f),'color':{'rgb':_0x59cda3(0x32d)}},'bottom':{'style':_0x59cda3(0x25f),'color':{'rgb':_0x59cda3(0x32d)}},'left':{'style':'thick','color':{'rgb':_0x59cda3(0x32d)}},'right':{'style':_0x59cda3(0x25f),'color':{'rgb':_0x59cda3(0x32d)}}};if(_0x169c6a){const _0x4df97e=_0x169c6a['split'](';')[_0x59cda3(0x300)]((_0x21f1f7,_0xe51111)=>{const _0x2e78ae=_0x59cda3,[_0x2a267c,_0x4334f7]=_0xe51111[_0x2e78ae(0x2ef)](':')[_0x2e78ae(0x352)](_0x41ad86=>_0x41ad86[_0x2e78ae(0x2f0)]());return _0x21f1f7[_0x2a267c]=_0x4334f7,_0x21f1f7;},{});_0x4df97e[_0x59cda3(0x27c)]&&(_0x11f8ee[_0x59cda3(0x335)][_0x59cda3(0x2d4)]=_0x4df97e['border-top'][_0x59cda3(0x2af)](_0x59cda3(0x35d))?_0x59cda3(0x35d):_0x59cda3(0x226)),_0x4df97e['border-bottom']&&(_0x11f8ee[_0x59cda3(0x26b)]['style']=_0x4df97e[_0x59cda3(0x2b7)][_0x59cda3(0x2af)]('thin')?_0x59cda3(0x35d):_0x59cda3(0x226)),_0x4df97e[_0x59cda3(0x205)]&&(_0x11f8ee[_0x59cda3(0x258)][_0x59cda3(0x2d4)]=_0x4df97e[_0x59cda3(0x205)][_0x59cda3(0x2af)](_0x59cda3(0x35d))?_0x59cda3(0x35d):'medium'),_0x4df97e[_0x59cda3(0x22c)]&&(_0x11f8ee[_0x59cda3(0x336)][_0x59cda3(0x2d4)]=_0x4df97e[_0x59cda3(0x22c)]['includes'](_0x59cda3(0x35d))?_0x59cda3(0x35d):'medium');}return _0x11f8ee;};_0x5e8336(_0x363d22(0x326))['each']((_0xb98dc4,_0x4de694)=>{const _0x288f98=_0x363d22;let _0x376d91=[],_0x77db=0x0;while(_0x23fe7e[_0x77db]){_0x23fe7e[_0x77db]--,_0x77db++;}_0x5e8336(_0x4de694)[_0x288f98(0x343)](_0x288f98(0x2be))['each']((_0x49c924,_0x330589)=>{const _0x275408=_0x288f98;let _0x2c108b=_0x5e8336(_0x330589)[_0x275408(0x1eb)]()[_0x275408(0x2f0)](),_0x1892ed=parseFloat(_0x2c108b['replace'](/,/g,''));isNaN(_0x1892ed)&&(_0x1892ed=_0x2c108b);let _0x4015b3=parseInt(_0x5e8336(_0x330589)[_0x275408(0x278)](_0x275408(0x334)))||0x1,_0x137943=parseInt(_0x5e8336(_0x330589)[_0x275408(0x278)](_0x275408(0x360)))||0x1;const _0x5bfb6a=_0x5e8336(_0x330589)['attr'](_0x275408(0x2d4)),_0x22fb08=_0x50b684(_0x5bfb6a);_0x376d91[_0x77db]={'v':_0x1892ed,'s':{'border':_0x22fb08}};(_0x4015b3>0x1||_0x137943>0x1)&&_0x5902a0[_0x275408(0x23c)]({'s':{'r':_0xb98dc4,'c':_0x77db},'e':{'r':_0xb98dc4+_0x137943-0x1,'c':_0x77db+_0x4015b3-0x1}});for(let _0x24f075=0x0;_0x24f075<_0x4015b3;_0x24f075++){_0x137943>0x1&&(_0x23fe7e[_0x77db+_0x24f075]=_0x137943-0x1);}_0x77db+=_0x4015b3;}),_0x5beab4[_0x288f98(0x23c)](_0x376d91);});const _0x11f068=XLSX[_0x363d22(0x28a)][_0x363d22(0x305)](),_0x4c3136=XLSX[_0x363d22(0x28a)][_0x363d22(0x239)](_0x5beab4);_0x5902a0[_0x363d22(0x265)]>0x0&&(_0x4c3136[_0x363d22(0x283)]=_0x5902a0);_0x4c3136[_0x363d22(0x26a)]=_0x5beab4[0x0][_0x363d22(0x352)](()=>({'wpx':0x64})),XLSX[_0x363d22(0x28a)][_0x363d22(0x220)](_0x11f068,_0x4c3136,'Sales\x20Report');const _0x2ae07e=XLSX['write'](_0x11f068,{'bookType':'xlsx','type':_0x363d22(0x261)});_0x8d067e[_0x363d22(0x299)](_0x363d22(0x297),_0x363d22(0x1f5)),_0x8d067e[_0x363d22(0x299)](_0x363d22(0x2db),_0x363d22(0x28b)),_0x8d067e[_0x363d22(0x2c7)](_0x2ae07e);}else _0x3607d4+=_0x363d22(0x2a4),_0x3607d4+=_0x363d22(0x20b),_0x3607d4+=_0x363d22(0x23e),_0x3607d4+='};',_0x3607d4+='</script>',_0x8d067e[_0x363d22(0x2c7)](_0x3607d4);}else await Reference[_0x363d22(0x21e)]({'referenceNumber':_0xdf391e}),_0x112b28['flash'](_0x363d22(0x235),_0x363d22(0x362)),_0x8d067e[_0x363d22(0x21b)]('/reports/dsrr/view');})[_0x4ae16d(0x1ed)](console[_0x4ae16d(0x240)]);}),router[a0_0x45d816(0x2bf)](a0_0x45d816(0x289),auth,async(_0x3653d1,_0x217cef)=>{const _0x343955=a0_0x45d816;try{const {username:_0x3d4a02,email:_0x2f98cf,role:_0x2c1cda}=_0x3653d1['user'],_0xa47459=_0x3653d1['user'],_0x3b275b=await profile[_0x343955(0x2d1)]({'email':_0xa47459[_0x343955(0x285)]}),_0x9fff21={'year':_0x343955(0x2d2),'month':_0x343955(0x2e9),'day':_0x343955(0x2d2)},_0x4a56b1=await master_shop['find']();console[_0x343955(0x1fd)](_0x343955(0x30a),_0x4a56b1);const _0x335e68=await product['find']();console[_0x343955(0x1fd)](_0x343955(0x317),_0x335e68);const _0x109db3=await warehouse[_0x343955(0x31d)]([{'$unwind':_0x343955(0x202)},{'$lookup':{'from':_0x343955(0x20a),'localField':_0x343955(0x331),'foreignField':_0x343955(0x219),'as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x343955(0x290)}},{'$group':{'_id':_0x343955(0x361),'product_stock':{'$sum':_0x343955(0x1ea)}}}]);console[_0x343955(0x1fd)](_0x343955(0x358),_0x109db3),_0x109db3[_0x343955(0x2e8)](_0x59e859=>{const _0x1f1171=_0x343955,_0x56b594=_0x335e68[_0x1f1171(0x352)](_0x2aeb40=>{const _0x280020=_0x1f1171;_0x2aeb40[_0x280020(0x219)]==_0x59e859[_0x280020(0x209)]&&(_0x2aeb40[_0x280020(0x32b)]=parseInt(_0x2aeb40[_0x280020(0x32b)])+parseInt(_0x59e859[_0x280020(0x1e8)]));});});const _0x583c1a=await staff[_0x343955(0x343)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x1f259b=await staff[_0x343955(0x2d1)]({'email':_0xa47459[_0x343955(0x285)]});if(_0x4a56b1[0x0][_0x343955(0x32c)]==_0x343955(0x2fd))var _0x18f54c=users[_0x343955(0x2dc)];else{if(_0x4a56b1[0x0][_0x343955(0x32c)]==_0x343955(0x2bc))var _0x18f54c=users[_0x343955(0x2bc)];else{if(_0x4a56b1[0x0]['language']==_0x343955(0x355))var _0x18f54c=users[_0x343955(0x355)];else{if(_0x4a56b1[0x0][_0x343955(0x32c)]=='Spanish')var _0x18f54c=users[_0x343955(0x24f)];else{if(_0x4a56b1[0x0][_0x343955(0x32c)]==_0x343955(0x253))var _0x18f54c=users[_0x343955(0x253)];else{if(_0x4a56b1[0x0][_0x343955(0x32c)]==_0x343955(0x2b0))var _0x18f54c=users[_0x343955(0x2f8)];else{if(_0x4a56b1[0x0]['language']==_0x343955(0x33d))var _0x18f54c=users[_0x343955(0x33d)];else{if(_0x4a56b1[0x0][_0x343955(0x32c)]=='Arabic\x20(ae)')var _0x18f54c=users[_0x343955(0x32a)];}}}}}}}_0x217cef[_0x343955(0x31a)]('dssr_view_admin',{'success':_0x3653d1[_0x343955(0x332)](_0x343955(0x315)),'errors':_0x3653d1['flash']('errors'),'alldata':_0x335e68,'profile':_0x3b275b,'master_shop':_0x4a56b1,'role':_0xa47459,'product_stock':_0x109db3,'language':_0x18f54c,'staff_arr':_0x1f259b,'staff_data_all':_0x583c1a});}catch(_0x2f2668){}}),router[a0_0x45d816(0x1fb)](a0_0x45d816(0x20d),auth,async(_0x544305,_0xcd060f)=>{const _0x18e820=a0_0x45d816;try{const {from:_0x55eaf9,to:_0x5afb06,staff_data:_0xad58ce}=_0x544305[_0x18e820(0x2d8)],_0x54d0ea=await Reference[_0x18e820(0x31d)]([{'$match':{'date_include':{'$gte':_0x55eaf9,'$lte':_0x5afb06},'staff_id':_0xad58ce}},{'$sort':{'date_include':0x1}}]);_0xcd060f[_0x18e820(0x249)](_0x54d0ea);}catch(_0x322d25){_0xcd060f[_0x18e820(0x249)](_0x322d25);}}),router[a0_0x45d816(0x2bf)](a0_0x45d816(0x270),auth,async(_0x397e57,_0x2f0df3)=>{const _0xcf7cf2=a0_0x45d816;try{const _0xf6cd04=_0x397e57['params']['id'],_0x67eb17=await Reference[_0xcf7cf2(0x221)](_0xf6cd04);let _0x1a627='';_0x1a627+=_0x67eb17[_0xcf7cf2(0x347)],_0x1a627+=_0xcf7cf2(0x2a4),_0x1a627+='window.onload\x20=\x20function()\x20{',_0x1a627+=_0xcf7cf2(0x23e),_0x1a627+='};',_0x1a627+=_0xcf7cf2(0x294),_0x2f0df3[_0xcf7cf2(0x2c7)](_0x1a627);}catch(_0x56f28b){_0x2f0df3[_0xcf7cf2(0x249)](_0x56f28b);}}),router[a0_0x45d816(0x1fb)](a0_0x45d816(0x27e),auth,async(_0x4347f1,_0xf2ba2b)=>{const _0x23e2a6=a0_0x45d816;try{const {ref_data:_0x21a7f5}=_0x4347f1[_0x23e2a6(0x2d8)],_0x364039=_0x21a7f5[_0x23e2a6(0x2ef)]('~'),_0x4544b3=_0x364039[_0x23e2a6(0x1ec)](_0x139db1=>_0x139db1!==''),_0x131b5d=await Reference[_0x23e2a6(0x31d)]([{'$match':{'referenceNumber':{'$in':_0x4544b3}}}]),_0x341f84=XLSX[_0x23e2a6(0x28a)][_0x23e2a6(0x305)]();_0x131b5d[_0x23e2a6(0x2e8)](_0x59c78=>{const _0x3b0673=_0x23e2a6,_0x554614=cheerio[_0x3b0673(0x2f1)](_0x59c78[_0x3b0673(0x347)]);let _0x487a12=[],_0x37a316=[],_0x4b2160=[];_0x554614(_0x3b0673(0x326))[_0x3b0673(0x2ac)]((_0x5c8d23,_0x37df6b)=>{const _0x4f5a44=_0x3b0673;let _0x498db0=[],_0x22fe70=0x0;while(_0x4b2160[_0x22fe70]){_0x4b2160[_0x22fe70]--,_0x22fe70++;}_0x554614(_0x37df6b)[_0x4f5a44(0x343)](_0x4f5a44(0x2be))[_0x4f5a44(0x2ac)]((_0x512395,_0x3b10c3)=>{const _0x475d67=_0x4f5a44;let _0x2c1bca=_0x554614(_0x3b10c3)[_0x475d67(0x1eb)]()[_0x475d67(0x2f0)](),_0x309590=parseFloat(_0x2c1bca['replace'](/,/g,''));isNaN(_0x309590)&&(_0x309590=_0x2c1bca);let _0x2bb3e3=parseInt(_0x554614(_0x3b10c3)[_0x475d67(0x278)]('colspan'))||0x1,_0x545090=parseInt(_0x554614(_0x3b10c3)[_0x475d67(0x278)](_0x475d67(0x360)))||0x1;_0x498db0[_0x22fe70]=_0x309590;(_0x2bb3e3>0x1||_0x545090>0x1)&&_0x37a316[_0x475d67(0x23c)]({'s':{'r':_0x5c8d23,'c':_0x22fe70},'e':{'r':_0x5c8d23+_0x545090-0x1,'c':_0x22fe70+_0x2bb3e3-0x1}});for(let _0x1b52ad=0x0;_0x1b52ad<_0x2bb3e3;_0x1b52ad++){_0x545090>0x1&&(_0x4b2160[_0x22fe70+_0x1b52ad]=_0x545090-0x1);}_0x22fe70+=_0x2bb3e3;}),_0x487a12[_0x4f5a44(0x23c)](_0x498db0);});const _0x217e38=XLSX[_0x3b0673(0x28a)][_0x3b0673(0x239)](_0x487a12);_0x37a316['length']>0x0&&(_0x217e38[_0x3b0673(0x283)]=_0x37a316),_0x217e38[_0x3b0673(0x26a)]=_0x487a12[0x0][_0x3b0673(0x352)](()=>({'wpx':0x64})),XLSX['utils'][_0x3b0673(0x220)](_0x341f84,_0x217e38,_0x59c78[_0x3b0673(0x293)]);});const _0x48d769=XLSX[_0x23e2a6(0x212)](_0x341f84,{'bookType':_0x23e2a6(0x2c8),'type':_0x23e2a6(0x261)});_0xf2ba2b[_0x23e2a6(0x299)](_0x23e2a6(0x297),'attachment;\x20filename=\x22reports.xlsx\x22'),_0xf2ba2b[_0x23e2a6(0x299)](_0x23e2a6(0x2db),_0x23e2a6(0x28b)),_0xf2ba2b[_0x23e2a6(0x2c7)](_0x48d769);}catch(_0x576f05){_0xf2ba2b[_0x23e2a6(0x249)](_0x576f05);}}),router[a0_0x45d816(0x1fb)]('/dsrr_admin/pdf_admin',auth,async(_0x48a4de,_0x59f2fe)=>{const _0x1b4c00=a0_0x45d816,{from_date:_0x20148c,agent_id:_0x235445}=_0x48a4de['body'],_0x45f166=_0x48a4de[_0x1b4c00(0x350)],_0x9a85e6=await staff[_0x1b4c00(0x2d1)]({'email':_0x45f166[_0x1b4c00(0x285)]}),_0x52feed=await master_shop[_0x1b4c00(0x343)](),_0x46f950=await agentsdataDSICheck_DSRR(_0x20148c,_0x235445,_0x4d74a8);let _0x37e99d=_0x1b4c00(0x230);var _0xd22041=new Date(_0x20148c);const _0x1c6a78={'year':'numeric','month':_0x1b4c00(0x2e9),'day':'numeric'},_0x2401b0=new Intl[(_0x1b4c00(0x238))](_0x1b4c00(0x354),_0x1c6a78)[_0x1b4c00(0x36e)](_0xd22041);_0x37e99d+=_0x1b4c00(0x292),_0x37e99d+=_0x1b4c00(0x1f7),_0x37e99d+=_0x1b4c00(0x2e5),_0x37e99d+=_0x46f950,_0x37e99d+=_0x1b4c00(0x2f7),_0x37e99d+=_0x1b4c00(0x255),_0x37e99d+=_0x1b4c00(0x255);let _0x4564c0=_0x1b4c00(0x36f);const _0x3862d2={'width':_0x1b4c00(0x31c),'height':_0x1b4c00(0x2f6),'orientation':_0x1b4c00(0x34c),'border':{'top':_0x1b4c00(0x2c3),'right':_0x1b4c00(0x2c3),'bottom':_0x1b4c00(0x2c3),'left':_0x1b4c00(0x2c3)},'header':{'height':_0x1b4c00(0x20c),'contents':_0x1b4c00(0x2f5)+_0x4564c0+_0x1b4c00(0x2c6)+_0x2401b0+_0x1b4c00(0x339)},'footer':{'height':'20mm','contents':{'default':_0x1b4c00(0x206)}},'dpi':0x5,'zoomFactor':'1'};var _0x4d74a8='on';if(_0x4d74a8=='on'){const _0x4a252a=cheerio['load'](_0x37e99d);let _0x387c40=[],_0x23b04e=[],_0x2c5e78=[];_0x4a252a(_0x1b4c00(0x326))['each']((_0x40d161,_0x4fd2d1)=>{const _0x5c27d6=_0x1b4c00;let _0x51c030=[],_0x41ebb8=0x0;while(_0x2c5e78[_0x41ebb8]){_0x2c5e78[_0x41ebb8]--,_0x41ebb8++;}_0x4a252a(_0x4fd2d1)[_0x5c27d6(0x343)](_0x5c27d6(0x2be))[_0x5c27d6(0x2ac)]((_0x4ba0a5,_0x268b2c)=>{const _0x2df124=_0x5c27d6;let _0x1a34e9=_0x4a252a(_0x268b2c)[_0x2df124(0x1eb)]()[_0x2df124(0x2f0)](),_0x56c7f4=parseFloat(_0x1a34e9['replace'](/,/g,''));isNaN(_0x56c7f4)&&(_0x56c7f4=_0x1a34e9);let _0xa43ebc=parseInt(_0x4a252a(_0x268b2c)['attr']('colspan'))||0x1,_0x1b1d9d=parseInt(_0x4a252a(_0x268b2c)['attr'](_0x2df124(0x360)))||0x1;_0x51c030[_0x41ebb8]=_0x56c7f4;(_0xa43ebc>0x1||_0x1b1d9d>0x1)&&_0x23b04e[_0x2df124(0x23c)]({'s':{'r':_0x40d161,'c':_0x41ebb8},'e':{'r':_0x40d161+_0x1b1d9d-0x1,'c':_0x41ebb8+_0xa43ebc-0x1}});for(let _0xdc28bf=0x0;_0xdc28bf<_0xa43ebc;_0xdc28bf++){_0x1b1d9d>0x1&&(_0x2c5e78[_0x41ebb8+_0xdc28bf]=_0x1b1d9d-0x1);}_0x41ebb8+=_0xa43ebc;}),_0x387c40[_0x5c27d6(0x23c)](_0x51c030);});const _0x10e7df=XLSX['utils'][_0x1b4c00(0x305)](),_0xdd13c6=XLSX[_0x1b4c00(0x28a)][_0x1b4c00(0x239)](_0x387c40);_0x23b04e[_0x1b4c00(0x265)]>0x0&&(_0xdd13c6[_0x1b4c00(0x283)]=_0x23b04e);_0xdd13c6[_0x1b4c00(0x26a)]=_0x387c40[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x1b4c00(0x28a)][_0x1b4c00(0x220)](_0x10e7df,_0xdd13c6,'Sales\x20Report');const _0x28d151=XLSX['write'](_0x10e7df,{'bookType':_0x1b4c00(0x2c8),'type':'buffer'});_0x59f2fe[_0x1b4c00(0x299)](_0x1b4c00(0x297),_0x1b4c00(0x1f5)),_0x59f2fe[_0x1b4c00(0x299)](_0x1b4c00(0x2db),_0x1b4c00(0x28b)),_0x59f2fe[_0x1b4c00(0x2c7)](_0x28d151);}else pdf[_0x1b4c00(0x1ef)](_0x37e99d,_0x3862d2)[_0x1b4c00(0x2a1)](function(_0x4cf096,_0x177c3f){const _0x343a26=_0x1b4c00;if(_0x4cf096){_0x59f2fe[_0x343a26(0x2a8)](0x1f4)[_0x343a26(0x2c7)](_0x343a26(0x302));return;}_0x59f2fe['setHeader'](_0x343a26(0x2db),_0x343a26(0x22a)),_0x177c3f['pipe'](_0x59f2fe);});}),module['exports']=router;