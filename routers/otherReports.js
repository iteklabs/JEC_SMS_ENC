const a0_0x5cb102=a0_0x1f28;(function(_0xf0b23e,_0x335db0){const _0x3d5098=a0_0x1f28,_0x36a368=_0xf0b23e();while(!![]){try{const _0x21442f=parseInt(_0x3d5098(0xd6))/0x1+parseInt(_0x3d5098(0xf1))/0x2*(parseInt(_0x3d5098(0x130))/0x3)+parseInt(_0x3d5098(0x1af))/0x4*(-parseInt(_0x3d5098(0x172))/0x5)+-parseInt(_0x3d5098(0x184))/0x6*(-parseInt(_0x3d5098(0x113))/0x7)+-parseInt(_0x3d5098(0x154))/0x8+-parseInt(_0x3d5098(0xe4))/0x9+-parseInt(_0x3d5098(0x167))/0xa*(-parseInt(_0x3d5098(0xfa))/0xb);if(_0x21442f===_0x335db0)break;else _0x36a368['push'](_0x36a368['shift']());}catch(_0x2d504c){_0x36a368['push'](_0x36a368['shift']());}}}(a0_0x5d82,0xb3a8d));const express=require('express'),res=require(a0_0x5cb102(0x18f)),app=express(),router=express[a0_0x5cb102(0xac)](),multer=require('multer'),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x5cb102(0xad)),auth=require(a0_0x5cb102(0x12a)),users=require(a0_0x5cb102(0x10f)),excelJS=require(a0_0x5cb102(0xaa)),XLSX=require('xlsx'),PDFDocument=require(a0_0x5cb102(0x193)),fs=require('fs'),blobStream=require(a0_0x5cb102(0x114)),JsBarcode=require(a0_0x5cb102(0x158)),{Canvas}=require(a0_0x5cb102(0xe8)),pdf=require(a0_0x5cb102(0xa2)),path=require(a0_0x5cb102(0xbd)),mongoose=require(a0_0x5cb102(0x16a)),cheerio=require('cheerio');router[a0_0x5cb102(0x1e8)](a0_0x5cb102(0x1a0),auth,async(_0x5ba40c,_0x138cf2)=>{const _0x387a54=a0_0x5cb102;try{const {username:_0x365707,email:_0x45cc88,role:_0x3cb0e4}=_0x5ba40c[_0x387a54(0x132)],_0x2df23a=_0x5ba40c[_0x387a54(0x132)],_0x23ab3b=await profile[_0x387a54(0x12d)]({'email':_0x2df23a[_0x387a54(0x186)]}),_0x3227fe={'year':_0x387a54(0x1ae),'month':_0x387a54(0xe2),'day':_0x387a54(0x1ae)},_0x1f91a4=await master_shop[_0x387a54(0x7a)]();console[_0x387a54(0x153)](_0x387a54(0x1e5),_0x1f91a4);const _0x550af8=await product[_0x387a54(0x7a)]();console[_0x387a54(0x153)](_0x387a54(0x1df),_0x550af8);const _0x4e0b15=await warehouse['aggregate']([{'$unwind':_0x387a54(0x10a)},{'$lookup':{'from':'products','localField':_0x387a54(0xf7),'foreignField':'name','as':_0x387a54(0x1c3)}},{'$unwind':_0x387a54(0x1b4)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x387a54(0xc2)}},{'$group':{'_id':_0x387a54(0x13c),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x387a54(0x153)](_0x387a54(0x1e0),_0x4e0b15),_0x4e0b15[_0x387a54(0x8b)](_0x5923bc=>{const _0x51e4e5=_0x387a54,_0x2107a7=_0x550af8[_0x51e4e5(0x142)](_0x521a8c=>{const _0xbbe7be=_0x51e4e5;_0x521a8c[_0xbbe7be(0xa4)]==_0x5923bc['_id']&&(_0x521a8c[_0xbbe7be(0xa1)]=parseInt(_0x521a8c['stock'])+parseInt(_0x5923bc[_0xbbe7be(0x103)]));});}),console[_0x387a54(0x153)](_0x387a54(0x1df),_0x550af8);if(_0x1f91a4[0x0][_0x387a54(0x1f8)]==_0x387a54(0x87))var _0x1a20f1=users[_0x387a54(0x14d)];else{if(_0x1f91a4[0x0][_0x387a54(0x1f8)]=='Hindi')var _0x1a20f1=users[_0x387a54(0x7f)];else{if(_0x1f91a4[0x0][_0x387a54(0x1f8)]==_0x387a54(0x13a))var _0x1a20f1=users[_0x387a54(0x13a)];else{if(_0x1f91a4[0x0][_0x387a54(0x1f8)]=='Spanish')var _0x1a20f1=users[_0x387a54(0x1e6)];else{if(_0x1f91a4[0x0]['language']==_0x387a54(0xf9))var _0x1a20f1=users['French'];else{if(_0x1f91a4[0x0][_0x387a54(0x1f8)]=='Portuguese\x20(BR)')var _0x1a20f1=users[_0x387a54(0x178)];else{if(_0x1f91a4[0x0][_0x387a54(0x1f8)]=='Chinese')var _0x1a20f1=users[_0x387a54(0xcf)];else{if(_0x1f91a4[0x0][_0x387a54(0x1f8)]==_0x387a54(0x128))var _0x1a20f1=users[_0x387a54(0xbc)];}}}}}}}_0x138cf2['render'](_0x387a54(0xeb),{'success':_0x5ba40c[_0x387a54(0x17f)](_0x387a54(0x171)),'errors':_0x5ba40c[_0x387a54(0x17f)](_0x387a54(0x118)),'alldata':_0x550af8,'profile':_0x23ab3b,'master_shop':_0x1f91a4,'role':_0x2df23a,'product_stock':_0x4e0b15,'language':_0x1a20f1});}catch(_0x3c3da8){}});async function dataCheck(_0x4d0734,_0x328942){const _0x5c7014=a0_0x5cb102,_0x49ce3b=await product[_0x5c7014(0x141)]([{'$group':{'_id':{'brand':_0x5c7014(0xd9),'category':_0x5c7014(0x151)},'products':{'$push':{'name':_0x5c7014(0x152),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5eeba2=[];_0x5eeba2['cat_brand']=[];for(let _0x2122d7=0x0;_0x2122d7<=_0x49ce3b[_0x5c7014(0xb7)]-0x1;_0x2122d7++){const _0x2a9b7a=_0x49ce3b[_0x2122d7];_0x5eeba2['cat_brand']['push'](_0x2a9b7a);}const _0xcaf8a4=await product[_0x5c7014(0x141)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x5c7014(0x1d1),'product_name':_0x5c7014(0x152)}}}},{'$sort':{'_id.category':-0x1}}]),_0x243bd8=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x4d0734,'$lte':_0x328942}}},{'$unwind':_0x5c7014(0x90)},{'$group':{'_id':{'product_name':'$product.product_name','product_code':_0x5c7014(0x1c0)},'totalQTY':{'$sum':_0x5c7014(0x108)}}}]);_0x5eeba2[_0x5c7014(0xa7)]=[];for(let _0x21e980=0x0;_0x21e980<=_0x243bd8[_0x5c7014(0xb7)]-0x1;_0x21e980++){const _0x3d22fa=_0x243bd8[_0x21e980];_0x5eeba2[_0x5c7014(0xa7)]['push'](_0x3d22fa);}const _0x4381d6=await sales_sa[_0x5c7014(0x141)]([{'$match':{'date':{'$gte':_0x4d0734,'$lte':_0x328942}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x5c7014(0x1f9),'localField':_0x5c7014(0xba),'foreignField':_0x5c7014(0xa5),'as':_0x5c7014(0x1ef)}},{'$unwind':_0x5c7014(0xbe)},{'$unwind':_0x5c7014(0x1bb)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x5c7014(0x119),'product_code':_0x5c7014(0x126)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console[_0x5c7014(0x153)](_0x4381d6[0x0]),_0x5eeba2[_0x5c7014(0x161)]=[];for(let _0x12e1cf=0x0;_0x12e1cf<=_0x4381d6['length']-0x1;_0x12e1cf++){const _0x31a486=_0x4381d6[_0x12e1cf];_0x5eeba2[_0x5c7014(0x161)]['push'](_0x31a486);}const _0x3b1d91=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x4d0734,'$lte':_0x328942}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5c7014(0x8e)}}},{'$lookup':{'from':_0x5c7014(0x1f9),'localField':_0x5c7014(0xba),'foreignField':_0x5c7014(0xa5),'as':'sales_info'}},{'$unwind':'$sales_info'},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x5c7014(0xb1)}},{'$group':{'_id':{'product_name':_0x5c7014(0x119),'product_code':_0x5c7014(0x126)},'totalQTY':{'$sum':_0x5c7014(0x77)}}}]);_0x5eeba2[_0x5c7014(0x1dc)]=[];for(let _0x167ece=0x0;_0x167ece<=_0x3b1d91[_0x5c7014(0xb7)]-0x1;_0x167ece++){const _0x1d24a2=_0x3b1d91[_0x167ece];_0x5eeba2[_0x5c7014(0x1dc)][_0x5c7014(0x199)](_0x1d24a2);}let _0x2ef50e='';for(let _0x204fd3=0x0;_0x204fd3<=_0xcaf8a4[_0x5c7014(0xb7)]-0x1;_0x204fd3++){const _0x15d67b=_0xcaf8a4[_0x204fd3];_0x2ef50e+=_0x5c7014(0xb8),_0x2ef50e+=_0x5c7014(0x181)+_0x15d67b[_0x5c7014(0xa5)][_0x5c7014(0x1f4)]+_0x5c7014(0x143),_0x2ef50e+=_0x5c7014(0xcd);for(let _0x97619a=0x0;_0x97619a<_0x5eeba2[_0x5c7014(0x189)][_0x5c7014(0xb7)];_0x97619a++){const _0x1d2c52=_0x5eeba2[_0x5c7014(0x189)][_0x97619a];if(_0x1d2c52['_id'][_0x5c7014(0x1f4)]==_0x15d67b['_id'][_0x5c7014(0x1f4)]){let _0x152eb7=[],_0x36e021=[],_0x93fa37=[];_0x152eb7[_0x1d2c52['_id'][_0x5c7014(0xdb)]]=[],_0x36e021[_0x1d2c52[_0x5c7014(0xa5)][_0x5c7014(0xdb)]]=[],_0x93fa37[_0x1d2c52[_0x5c7014(0xa5)][_0x5c7014(0xdb)]]=[];var _0xe39a1a=0x0,_0x39d2f1=0x0,_0x45a1bf=0x0;for(let _0x429ce0=0x0;_0x429ce0<_0x1d2c52[_0x5c7014(0x1f5)][_0x5c7014(0xb7)];_0x429ce0++){const _0x40c8c9=_0x1d2c52[_0x5c7014(0x1f5)][_0x429ce0];for(let _0x14902c=0x0;_0x14902c<=_0x5eeba2['beg_bal'][_0x5c7014(0xb7)]-0x1;_0x14902c++){const _0x37da3f=_0x5eeba2[_0x5c7014(0xa7)][_0x14902c];_0x37da3f['_id'][_0x5c7014(0x1a9)]==_0x40c8c9[_0x5c7014(0xa4)]&&_0x37da3f[_0x5c7014(0xa5)]['product_code']==_0x40c8c9['product_code']&&(_0xe39a1a+=parseInt(_0x37da3f['totalQTY'],0xa));}for(let _0x9c2654=0x0;_0x9c2654<=_0x5eeba2[_0x5c7014(0x1dc)][_0x5c7014(0xb7)]-0x1;_0x9c2654++){const _0x5682d0=_0x5eeba2[_0x5c7014(0x1dc)][_0x9c2654];_0x5682d0[_0x5c7014(0xa5)][_0x5c7014(0x1a9)]==_0x40c8c9[_0x5c7014(0xa4)]&&_0x5682d0['_id']['product_code']==_0x40c8c9[_0x5c7014(0x1e3)]&&(_0x39d2f1+=parseFloat(_0x5682d0[_0x5c7014(0xa8)],0xa)[_0x5c7014(0x1b1)](0x2));}for(let _0x5b7dec=0x0;_0x5b7dec<=_0x5eeba2[_0x5c7014(0x161)][_0x5c7014(0xb7)]-0x1;_0x5b7dec++){const _0x26abd6=_0x5eeba2[_0x5c7014(0x161)][_0x5b7dec];_0x26abd6[_0x5c7014(0xa5)]['product_name']==_0x40c8c9[_0x5c7014(0xa4)]&&_0x26abd6[_0x5c7014(0xa5)][_0x5c7014(0x1e3)]==_0x40c8c9[_0x5c7014(0x1e3)]&&(_0x45a1bf+=parseInt(_0x26abd6['totalQTY'],0xa));}}const _0x58383b=new Intl[(_0x5c7014(0xed))](_0x5c7014(0x13b));var _0x37bc57=_0x58383b['format'](_0xe39a1a);_0x152eb7[_0x1d2c52[_0x5c7014(0xa5)][_0x5c7014(0xdb)]][_0x5c7014(0x199)](_0x37bc57),_0x36e021[_0x1d2c52[_0x5c7014(0xa5)][_0x5c7014(0xdb)]][_0x5c7014(0x199)](_0x58383b[_0x5c7014(0x1e4)](_0x39d2f1)),_0x93fa37[_0x1d2c52[_0x5c7014(0xa5)][_0x5c7014(0xdb)]][_0x5c7014(0x199)](_0x58383b[_0x5c7014(0x1e4)](_0x45a1bf));var _0x1e09ec=_0x58383b[_0x5c7014(0x1e4)](_0xe39a1a-(_0x45a1bf+_0x39d2f1));_0x2ef50e+='<tr>',_0x2ef50e+=_0x5c7014(0x1c5),_0x2ef50e+=_0x5c7014(0x17a)+_0x1d2c52[_0x5c7014(0xa5)]['brand']+'</td>',_0x2ef50e+=_0x5c7014(0x17a)+_0x152eb7[_0x1d2c52[_0x5c7014(0xa5)][_0x5c7014(0xdb)]][0x0]+'</td>',_0x2ef50e+=_0x5c7014(0xc0),_0x2ef50e+=_0x5c7014(0x17a)+_0x93fa37[_0x1d2c52[_0x5c7014(0xa5)][_0x5c7014(0xdb)]][0x0]+_0x5c7014(0x143),_0x2ef50e+=_0x5c7014(0x17a)+_0x36e021[_0x1d2c52[_0x5c7014(0xa5)][_0x5c7014(0xdb)]][0x0]+_0x5c7014(0x143),_0x2ef50e+='<td\x20class=\x22row_data\x22>'+_0x1e09ec+_0x5c7014(0x143),_0x2ef50e+='</tr>';}}}return console['log'](_0x5eeba2['sales_bkg']),_0x2ef50e;}router[a0_0x5cb102(0x195)](a0_0x5cb102(0x106),auth,async(_0x29b68a,_0x1c667f)=>{const _0x5c1836=a0_0x5cb102,{from_date:_0x3c0293,to_date:_0x4dcedd}=_0x29b68a[_0x5c1836(0x17d)],_0x159610=await dataCheck(_0x3c0293,_0x4dcedd);{}let _0x2c5f91=_0x5c1836(0x196);var _0x221b75=new Date(_0x3c0293),_0xedb501=new Date(_0x4dcedd);const _0x1a3864={'year':_0x5c1836(0x1ae),'month':'long','day':_0x5c1836(0x1ae)},_0x24015a=new Intl[(_0x5c1836(0xcb))](_0x5c1836(0x13b),_0x1a3864)[_0x5c1836(0x1e4)](_0x221b75),_0x5b2895=new Intl[(_0x5c1836(0xcb))](_0x5c1836(0x13b),_0x1a3864)[_0x5c1836(0x1e4)](_0xedb501);_0x2c5f91+=_0x5c1836(0x80),_0x2c5f91+=_0x5c1836(0x12c),_0x2c5f91+=_0x5c1836(0x159)+_0x24015a+_0x5c1836(0x17e)+_0x5b2895+_0x5c1836(0x136),_0x2c5f91+=_0x5c1836(0x18a),_0x2c5f91+=_0x5c1836(0xb5),_0x2c5f91+=_0x5c1836(0x149),_0x2c5f91+=_0x5c1836(0xb8),_0x2c5f91+=_0x5c1836(0x16e),_0x2c5f91+=_0x5c1836(0x120),_0x2c5f91+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x24015a+'</th>',_0x2c5f91+=_0x5c1836(0x1e2),_0x2c5f91+=_0x5c1836(0x1c1),_0x2c5f91+=_0x5c1836(0x169)+_0x5b2895+_0x5c1836(0x7b),_0x2c5f91+=_0x5c1836(0xcd),_0x2c5f91+=_0x5c1836(0xb8),_0x2c5f91+='<th>Booking</th>',_0x2c5f91+='<th>X-Truck</th>',_0x2c5f91+='</tr>',_0x2c5f91+=_0x159610,_0x2c5f91+=_0x5c1836(0x9b),_0x2c5f91+=_0x5c1836(0x111),_0x2c5f91+='</div>';const _0x197f97={'format':_0x5c1836(0x84),'orientation':_0x5c1836(0x14a),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x5c1836(0xa0)}}};pdf[_0x5c1836(0xd4)](_0x2c5f91,_0x197f97)[_0x5c1836(0x1c6)](function(_0x580d5d,_0xb6a7a8){const _0x335d98=_0x5c1836;if(_0x580d5d){_0x1c667f[_0x335d98(0x1eb)](0x1f4)['send'](_0x335d98(0x15e));return;}_0x1c667f[_0x335d98(0x140)](_0x335d98(0x1be),_0x335d98(0x1f3)),_0xb6a7a8[_0x335d98(0x134)](_0x1c667f);});}),router[a0_0x5cb102(0x1e8)]('/agent/view',auth,async(_0x521f5f,_0xee1c0a)=>{const _0x364967=a0_0x5cb102;try{const {username:_0x39e387,email:_0x5bf6b6,role:_0x1b08e1}=_0x521f5f['user'],_0x2fd784=_0x521f5f[_0x364967(0x132)],_0x46e39=await profile[_0x364967(0x12d)]({'email':_0x2fd784[_0x364967(0x186)]}),_0x250edc={'year':_0x364967(0x1ae),'month':_0x364967(0xe2),'day':'numeric'},_0x2e76bd=await master_shop[_0x364967(0x7a)](),_0x4f60cf=await product[_0x364967(0x7a)](),_0x58b770=await warehouse[_0x364967(0x141)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x364967(0x1f5),'localField':_0x364967(0xf7),'foreignField':_0x364967(0xa4),'as':_0x364967(0x1c3)}},{'$unwind':_0x364967(0x1b4)},{'$project':{'product_name':_0x364967(0x1e7),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x364967(0x13c),'product_stock':{'$sum':_0x364967(0x109)}}}]);if(_0x2e76bd[0x0][_0x364967(0x1f8)]==_0x364967(0x87))var _0x1f9f5e=users['English'];else{if(_0x2e76bd[0x0][_0x364967(0x1f8)]==_0x364967(0x7f))var _0x1f9f5e=users[_0x364967(0x7f)];else{if(_0x2e76bd[0x0][_0x364967(0x1f8)]==_0x364967(0x13a))var _0x1f9f5e=users[_0x364967(0x13a)];else{if(_0x2e76bd[0x0][_0x364967(0x1f8)]==_0x364967(0x1e6))var _0x1f9f5e=users[_0x364967(0x1e6)];else{if(_0x2e76bd[0x0][_0x364967(0x1f8)]==_0x364967(0xf9))var _0x1f9f5e=users[_0x364967(0xf9)];else{if(_0x2e76bd[0x0][_0x364967(0x1f8)]==_0x364967(0x1ea))var _0x1f9f5e=users[_0x364967(0x178)];else{if(_0x2e76bd[0x0][_0x364967(0x1f8)]==_0x364967(0xcf))var _0x1f9f5e=users['Chinese'];else{if(_0x2e76bd[0x0][_0x364967(0x1f8)]==_0x364967(0x128))var _0x1f9f5e=users[_0x364967(0xbc)];}}}}}}}_0xee1c0a['render']('agent_sales',{'success':_0x521f5f[_0x364967(0x17f)]('success'),'errors':_0x521f5f[_0x364967(0x17f)](_0x364967(0x118)),'alldata':_0x4f60cf,'profile':_0x46e39,'master_shop':_0x2e76bd,'role':_0x2fd784,'product_stock':_0x58b770,'language':_0x1f9f5e});}catch(_0x3fdec7){}});async function agentsdataCheck(_0x23534c,_0x27f2e2){const _0xf7e043=a0_0x5cb102,_0x544cb9=await product['aggregate']([{'$group':{'_id':{'brand':_0xf7e043(0xd9),'category':_0xf7e043(0x151)},'products':{'$push':{'name':_0xf7e043(0x152),'product_code':_0xf7e043(0x1d1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x81f727=[];_0x81f727[_0xf7e043(0x189)]=[];for(let _0x3554cc=0x0;_0x3554cc<=_0x544cb9[_0xf7e043(0xb7)]-0x1;_0x3554cc++){const _0x54b064=_0x544cb9[_0x3554cc];_0x81f727[_0xf7e043(0x189)][_0xf7e043(0x199)](_0x54b064);}const _0x1475c1=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0xf7e043(0xd9),'product_code':_0xf7e043(0x1d1),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x4b3296=await product[_0xf7e043(0x141)]([{'$group':{'_id':{'category':_0xf7e043(0x151),'brand':_0xf7e043(0xd9)}}},{'$group':{'_id':_0xf7e043(0x1ed),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5b2096=await sales_sa[_0xf7e043(0x141)]([{'$match':{'date':{'$gte':_0x23534c,'$lte':_0x27f2e2}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0xf7e043(0x8e)}}},{'$lookup':{'from':'staffs','localField':_0xf7e043(0xba),'foreignField':_0xf7e043(0xa5),'as':_0xf7e043(0x1ef)}},{'$unwind':_0xf7e043(0xbe)},{'$unwind':_0xf7e043(0x1bb)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0xf7e043(0xb1)}},{'$lookup':{'from':_0xf7e043(0x1f5),'localField':'sale_product.product_code','foreignField':_0xf7e043(0x1e3),'as':_0xf7e043(0x174)}},{'$unwind':_0xf7e043(0x121)},{'$group':{'_id':{'sales_id':_0xf7e043(0x205),'category':_0xf7e043(0x93),'brand':_0xf7e043(0xe7)},'salesman_data':{'$first':_0xf7e043(0x10d)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0xf7e043(0x77),'product_details':{'prod_name':'$product_info.name','product_code':_0xf7e043(0x1d8),'category':_0xf7e043(0x93),'brand':'$product_info.brand'}}}}}]);let _0x1c7e00='';_0x1c7e00+=_0xf7e043(0xb8),_0x1c7e00+='<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x1c7e00+=_0xf7e043(0xcd),_0x1c7e00+=_0xf7e043(0xb8),_0x1c7e00+='<td\x20class=\x22cat_data\x22></td>';for(let _0x3f328c=0x0;_0x3f328c<=_0x1475c1['length']-0x1;_0x3f328c++){const _0x9ec310=_0x1475c1[_0x3f328c];for(let _0x434877=0x0;_0x434877<_0x4b3296[_0xf7e043(0xb7)];_0x434877++){const _0x257621=_0x4b3296[_0x434877];_0x257621[_0xf7e043(0xa5)]==_0x9ec310['_id'][_0xf7e043(0x1f4)]&&(_0x1c7e00+='<td\x20colspan=\x22'+_0x257621[_0xf7e043(0x89)]+_0xf7e043(0x1f1)+_0x9ec310[_0xf7e043(0xa5)][_0xf7e043(0x1f4)]+'</td>');}}_0x1c7e00+='<td\x20class=\x22cat_data\x22></td>',_0x1c7e00+='</tr>',_0x1c7e00+=_0xf7e043(0xb8),_0x1c7e00+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>';for(let _0x3332cc=0x0;_0x3332cc<=_0x1475c1['length']-0x1;_0x3332cc++){const _0x1cc1d9=_0x1475c1[_0x3332cc];for(let _0x4087f1=0x0;_0x4087f1<_0x81f727['cat_brand'][_0xf7e043(0xb7)];_0x4087f1++){const _0x186ca1=_0x81f727[_0xf7e043(0x189)][_0x4087f1];_0x186ca1[_0xf7e043(0xa5)][_0xf7e043(0x1f4)]==_0x1cc1d9[_0xf7e043(0xa5)][_0xf7e043(0x1f4)]&&(_0x1c7e00+=_0xf7e043(0x1fc)+_0x186ca1[_0xf7e043(0xa5)]['brand']+'</td>');}}_0x1c7e00+=_0xf7e043(0xdf),_0x1c7e00+=_0xf7e043(0xcd);let _0x4108c4={'name':[],'dataqty':{}};for(let _0x25baad=0x0;_0x25baad<_0x81f727[_0xf7e043(0x189)]['length'];_0x25baad++){const _0x2609d9=_0x81f727[_0xf7e043(0x189)][_0x25baad],_0x4274c7=_0x2609d9[_0xf7e043(0xa5)]['brand'],_0x308ff5=_0x2609d9[_0xf7e043(0xa5)][_0xf7e043(0x1f4)];!_0x4108c4[_0xf7e043(0x1b0)][_0x4274c7]&&(_0x4108c4[_0xf7e043(0x1b0)][_0x4274c7]={});!_0x4108c4[_0xf7e043(0x1b0)][_0x4274c7][_0x308ff5]&&(_0x4108c4[_0xf7e043(0x1b0)][_0x4274c7][_0x308ff5]=[]);for(let _0x478aed=0x0;_0x478aed<_0x5b2096[_0xf7e043(0xb7)];_0x478aed++){const _0x2ec2c7=_0x5b2096[_0x478aed];if(_0x4274c7===_0x2ec2c7[_0xf7e043(0xa5)]['brand']&&_0x308ff5===_0x2ec2c7[_0xf7e043(0xa5)][_0xf7e043(0x1f4)]){const _0x54c39d=_0x2ec2c7['salesman_data'];!_0x4108c4[_0xf7e043(0x1b0)][_0x4274c7][_0x308ff5][_0x54c39d]&&(_0x4108c4['dataqty'][_0x4274c7][_0x308ff5][_0x54c39d]=[]),_0x4108c4[_0xf7e043(0x1b0)][_0x4274c7][_0x308ff5][_0x54c39d][_0xf7e043(0x199)](_0x2ec2c7[_0xf7e043(0xa8)]),!_0x4108c4[_0xf7e043(0xa4)][_0xf7e043(0x201)](_0x54c39d)&&_0x4108c4['name'][_0xf7e043(0x199)](_0x54c39d);}}}_0x1c7e00+='<tr>';for(let _0x25aa78=0x0;_0x25aa78<=_0x4108c4[_0xf7e043(0xa4)][_0xf7e043(0xb7)]-0x1;_0x25aa78++){const _0x38dc35=_0x4108c4['name'][_0x25aa78];_0x1c7e00+=_0xf7e043(0x17a)+_0x38dc35+_0xf7e043(0x143);var _0x484975=0x0,_0x5b46c2=0x0;for(let _0x152bf4=0x0;_0x152bf4<=_0x81f727[_0xf7e043(0x189)][_0xf7e043(0xb7)]-0x1;_0x152bf4++){const _0x179323=_0x81f727[_0xf7e043(0x189)][_0x152bf4];var _0x8b8111=0x0;_0x4108c4[_0xf7e043(0x1b0)][_0x179323[_0xf7e043(0xa5)]['brand']][_0x179323['_id'][_0xf7e043(0x1f4)]][_0x38dc35]?(_0x8b8111=_0x4108c4[_0xf7e043(0x1b0)][_0x179323['_id']['brand']][_0x179323[_0xf7e043(0xa5)][_0xf7e043(0x1f4)]][_0x38dc35][0x0],_0x1c7e00+='<td\x20class=\x22row_data\x22>'+_0x8b8111[_0xf7e043(0x1b1)](0x2)+_0xf7e043(0x143)):(_0x8b8111=0x0,_0x1c7e00+=_0xf7e043(0x17a)+_0x8b8111+_0xf7e043(0x143)),_0x484975+=parseFloat(_0x8b8111[_0xf7e043(0x1b1)](0x2));}_0x1c7e00+=_0xf7e043(0x17a)+_0x484975[_0xf7e043(0x1b1)](0x2)+_0xf7e043(0x143);}return _0x1c7e00+=_0xf7e043(0xcd),_0x1c7e00;}router[a0_0x5cb102(0x195)](a0_0x5cb102(0xc6),auth,async(_0x36720f,_0x3ae7b0)=>{const _0x68371=a0_0x5cb102,{from_date:_0x398db9,to_date:_0x3b2c39}=_0x36720f[_0x68371(0x17d)],_0x4323cc=await agentsdataCheck(_0x398db9,_0x3b2c39);{}let _0x409db5=_0x68371(0x1c7);var _0x5a1a55=new Date(_0x398db9),_0x4afda5=new Date(_0x3b2c39);const _0x529c9b={'year':'numeric','month':_0x68371(0xe2),'day':_0x68371(0x1ae)},_0x1eba26=new Intl['DateTimeFormat'](_0x68371(0x13b),_0x529c9b)['format'](_0x5a1a55),_0x258f72=new Intl[(_0x68371(0xcb))]('en-US',_0x529c9b)['format'](_0x4afda5);_0x409db5+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x409db5+=_0x68371(0x7e),_0x409db5+='<p>'+_0x1eba26+_0x68371(0x17e)+_0x258f72+'</p>',_0x409db5+=_0x68371(0x18a),_0x409db5+=_0x68371(0xb5),_0x409db5+=_0x68371(0x149),_0x409db5+=_0x4323cc,_0x409db5+='</table>',_0x409db5+='</div>',_0x409db5+='</div>';const _0x151e69={'format':_0x68371(0x84),'orientation':_0x68371(0x14a),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x68371(0xa0)}}};pdf['create'](_0x409db5,_0x151e69)['toStream'](function(_0x49f48c,_0x335b04){const _0x51c6c3=_0x68371;if(_0x49f48c){_0x3ae7b0[_0x51c6c3(0x1eb)](0x1f4)[_0x51c6c3(0x182)]('Error\x20generating\x20PDF');return;}_0x3ae7b0[_0x51c6c3(0x140)](_0x51c6c3(0x1be),_0x51c6c3(0x1f3)),_0x335b04[_0x51c6c3(0x134)](_0x3ae7b0);});}),router[a0_0x5cb102(0x1e8)](a0_0x5cb102(0x125),auth,async(_0x19dfbc,_0x61eaa4)=>{const _0x53386b=a0_0x5cb102;try{const {username:_0x338dda,email:_0x136482,role:_0x16ab77}=_0x19dfbc[_0x53386b(0x132)],_0x4af7a3=_0x19dfbc[_0x53386b(0x132)],_0x542007=await profile[_0x53386b(0x12d)]({'email':_0x4af7a3[_0x53386b(0x186)]}),_0x3631e4={'year':_0x53386b(0x1ae),'month':'long','day':'numeric'},_0x3cc85d=await master_shop[_0x53386b(0x7a)](),_0x994b32=await staff[_0x53386b(0x12d)]({'email':_0x4af7a3[_0x53386b(0x186)]}),_0x5bc85c=await product[_0x53386b(0x7a)](),_0x128b3e=await warehouse[_0x53386b(0x141)]([{'$unwind':_0x53386b(0x10a)},{'$lookup':{'from':_0x53386b(0x1f5),'localField':'product_details.product_name','foreignField':'name','as':_0x53386b(0x1c3)}},{'$unwind':_0x53386b(0x1b4)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x53386b(0xc2)}},{'$group':{'_id':_0x53386b(0x13c),'product_stock':{'$sum':_0x53386b(0x109)}}}]),_0xde2b6e=await staff[_0x53386b(0x7a)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x3cc85d[0x0][_0x53386b(0x1f8)]==_0x53386b(0x87))var _0x1bc14c=users[_0x53386b(0x14d)];else{if(_0x3cc85d[0x0][_0x53386b(0x1f8)]==_0x53386b(0x7f))var _0x1bc14c=users[_0x53386b(0x7f)];else{if(_0x3cc85d[0x0][_0x53386b(0x1f8)]==_0x53386b(0x13a))var _0x1bc14c=users[_0x53386b(0x13a)];else{if(_0x3cc85d[0x0]['language']=='Spanish')var _0x1bc14c=users[_0x53386b(0x1e6)];else{if(_0x3cc85d[0x0][_0x53386b(0x1f8)]==_0x53386b(0xf9))var _0x1bc14c=users['French'];else{if(_0x3cc85d[0x0][_0x53386b(0x1f8)]==_0x53386b(0x1ea))var _0x1bc14c=users[_0x53386b(0x178)];else{if(_0x3cc85d[0x0][_0x53386b(0x1f8)]==_0x53386b(0xcf))var _0x1bc14c=users[_0x53386b(0xcf)];else{if(_0x3cc85d[0x0]['language']==_0x53386b(0x128))var _0x1bc14c=users[_0x53386b(0xbc)];}}}}}}}_0x61eaa4['render'](_0x53386b(0xfe),{'success':_0x19dfbc[_0x53386b(0x17f)](_0x53386b(0x171)),'errors':_0x19dfbc['flash'](_0x53386b(0x118)),'alldata':_0x5bc85c,'profile':_0x542007,'master_shop':_0x3cc85d,'role':_0x4af7a3,'product_stock':_0x128b3e,'language':_0x1bc14c,'staff_arr':_0x994b32,'staff_data_all':_0xde2b6e});}catch(_0x224332){_0x61eaa4[_0x53386b(0x170)](_0x224332);}});async function agentsdataDSICheck_admin(_0x34ae64,_0x23a44f,_0x200050,_0x471f3d){const _0x1aeada=a0_0x5cb102,_0x182c77=await product[_0x1aeada(0x141)]([{'$group':{'_id':{'brand':_0x1aeada(0xd9),'category':'$category'},'products':{'$push':{'name':_0x1aeada(0x152),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x481846=[];_0x481846['cat_brand']=[];for(let _0x1be466=0x0;_0x1be466<=_0x182c77[_0x1aeada(0xb7)]-0x1;_0x1be466++){const _0x495d0a=_0x182c77[_0x1be466];_0x481846[_0x1aeada(0x189)][_0x1aeada(0x199)](_0x495d0a);}const _0x388ad8=await product[_0x1aeada(0x141)]([{'$group':{'_id':{'category':_0x1aeada(0x151)},'products':{'$push':{'brand':_0x1aeada(0xd9),'product_code':_0x1aeada(0x1d1),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x5213e4=await product[_0x1aeada(0x141)]([{'$group':{'_id':{'category':_0x1aeada(0x151),'brand':_0x1aeada(0xd9)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1e9b30=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x34ae64,'$lte':_0x23a44f},'sales_staff_id':_0x200050,'sale_product.isFG':_0x1aeada(0xb1)}},{'$unwind':_0x1aeada(0x1bb)},{'$match':{'sale_product.isFG':_0x1aeada(0xb1)}},{'$lookup':{'from':_0x1aeada(0x1f5),'localField':'sale_product.product_code','foreignField':_0x1aeada(0x1e3),'as':_0x1aeada(0x174)}},{'$unwind':_0x1aeada(0x121)},{'$group':{'_id':{'dsi':'$dsi','date':_0x1aeada(0x16d),'customer':_0x1aeada(0x203)},'totalQty':{'$sum':_0x1aeada(0x77)},'products':{'$push':{'qty':_0x1aeada(0x77),'NetPrice':_0x1aeada(0x18b),'discount':_0x1aeada(0x1d7),'adj_discount':_0x1aeada(0xce),'product_details':{'prod_name':_0x1aeada(0x176),'product_code':'$product_info.product_code','category':_0x1aeada(0x93),'brand':_0x1aeada(0xe7),'gross_price':_0x1aeada(0x94)}}}}},{'$unwind':_0x1aeada(0x1ca)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1aeada(0x78),'customer':_0x1aeada(0xee),'category':'$products.product_details.category','brand':_0x1aeada(0x192)},'totalQty':{'$sum':_0x1aeada(0x188)},'totalGross':{'$sum':{'$multiply':[_0x1aeada(0x188),_0x1aeada(0x19d)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x1aeada(0xe5)},'adj_discount':{'$sum':_0x1aeada(0x187)},'product_details':{'$first':_0x1aeada(0x19f)}}},{'$group':{'_id':{'dsi':_0x1aeada(0x11a),'date':_0x1aeada(0x78),'customer':_0x1aeada(0xee)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x1aeada(0x168)},'NetPrice':{'$sum':_0x1aeada(0x83)},'discount':{'$sum':_0x1aeada(0x18c)},'adj_discount':{'$sum':_0x1aeada(0x146)},'products':{'$push':{'qty':'$totalQty','category':_0x1aeada(0x1ed),'brand':_0x1aeada(0x1ff),'product_details':_0x1aeada(0x10a)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x680d39=[],_0x400d01={},_0x5ebfcb={},_0x19e732={};var _0x470a67=0x0,_0x8e6ca6=0x0,_0x36e88d=0x0,_0x113cd2=0x0,_0x5a0590=0x0;const _0x37379c=0x6;for(let _0x17a2b0=0x0;_0x17a2b0<=_0x1e9b30['length']-0x1;_0x17a2b0++){const _0x56b40e=_0x1e9b30[_0x17a2b0];let _0x15a7df=_0x1aeada(0xb8);_0x15a7df+=_0x1aeada(0xc5)+_0x56b40e[_0x1aeada(0xa5)][_0x1aeada(0x10e)]+'</td>',_0x15a7df+=_0x1aeada(0xc5)+_0x56b40e[_0x1aeada(0xa5)][_0x1aeada(0x1aa)]+_0x1aeada(0x143),_0x15a7df+=_0x1aeada(0xc5)+_0x56b40e[_0x1aeada(0xa5)][_0x1aeada(0x16b)]+_0x1aeada(0x143);let _0x3671d4={};var _0x586e59=0x0;for(let _0x17c784=0x0;_0x17c784<=_0x56b40e[_0x1aeada(0x1f5)]['length']-0x1;_0x17c784++){const _0x239a9c=_0x56b40e[_0x1aeada(0x1f5)][_0x17c784];_0x3671d4[_0x239a9c[_0x1aeada(0xdb)]+'-'+_0x239a9c[_0x1aeada(0x1f4)]]=_0x239a9c[_0x1aeada(0x135)];const _0x3dd053=_0x239a9c['brand']+'-'+_0x239a9c[_0x1aeada(0x1f4)];!_0x400d01[_0x3dd053]&&(_0x400d01[_0x3dd053]=0x0),!Array[_0x1aeada(0x150)](_0x19e732[_0x3dd053])&&(_0x19e732[_0x3dd053]=[]),!Array[_0x1aeada(0x150)](_0x19e732[_0x3dd053])&&(_0x19e732[_0x3dd053]=[]),_0x400d01[_0x3dd053]+=_0x239a9c['qty'],_0x19e732[_0x3dd053][_0x1aeada(0x199)](_0x239a9c[_0x1aeada(0x135)]),_0x586e59++;}for(let _0x587726=0x0;_0x587726<=_0x481846[_0x1aeada(0x189)]['length']-0x1;_0x587726++){const _0xa92d=_0x481846[_0x1aeada(0x189)][_0x587726],_0xcf4ecc=_0xa92d[_0x1aeada(0xa5)]['brand']+'-'+_0xa92d[_0x1aeada(0xa5)][_0x1aeada(0x1f4)];_0x15a7df+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x3671d4[_0xcf4ecc]!==undefined?_0x3671d4[_0xcf4ecc]['toFixed'](0x2):'')+'</td>';}_0x36e88d=_0x56b40e[_0x1aeada(0x18e)]+_0x56b40e[_0x1aeada(0x1d9)],_0x15a7df+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x56b40e[_0x1aeada(0x15a)],0x2)[_0x1aeada(0x1b1)](0x2))+_0x1aeada(0x143),_0x15a7df+=_0x1aeada(0x95)+formatNumber(_0x56b40e[_0x1aeada(0xc4)][_0x1aeada(0x1b1)](0x2))+_0x1aeada(0x143),_0x15a7df+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x36e88d)+_0x1aeada(0x143),_0x15a7df+=_0x1aeada(0x95)+formatNumber(_0x56b40e[_0x1aeada(0x9c)][_0x1aeada(0x1b1)](0x2))+'</td>',_0x15a7df+=_0x1aeada(0xcd);var _0x3916bf=parseFloat(_0x56b40e[_0x1aeada(0x15a)][_0x1aeada(0x1b1)](0x3));_0x470a67+=_0x3916bf,console[_0x1aeada(0x153)]('total',_0x470a67+_0x1aeada(0x19e)+_0x3916bf),_0x8e6ca6+=parseFloat(_0x56b40e['NetPrice'][_0x1aeada(0x1b1)](0x2)),_0x113cd2+=_0x36e88d,_0x5a0590+=parseFloat(_0x56b40e[_0x1aeada(0xc4)][_0x1aeada(0x1b1)](0x2));if(_0x17a2b0==_0x1e9b30[_0x1aeada(0xb7)]-0x1){_0x15a7df+=_0x1aeada(0xb8),_0x15a7df+=_0x1aeada(0x165),_0x15a7df+=_0x1aeada(0x143);for(let _0x497376=0x0;_0x497376<=_0x481846['cat_brand'][_0x1aeada(0xb7)]-0x1;_0x497376++){const _0x444a13=_0x481846[_0x1aeada(0x189)][_0x497376],_0x574321=_0x444a13['_id'][_0x1aeada(0xdb)]+'-'+_0x444a13[_0x1aeada(0xa5)][_0x1aeada(0x1f4)];!_0x19e732[_0x574321]&&(_0x19e732[_0x574321]=[]);const _0x53d07c=_0x19e732[_0x574321][_0x1aeada(0x116)]((_0x48b8a6,_0x396140)=>_0x48b8a6+_0x396140,0x0);_0x15a7df+=_0x1aeada(0x82)+(_0x53d07c!==undefined?formatNumber(_0x53d07c[_0x1aeada(0x1b1)](0x2)):'')+_0x1aeada(0x1a3);}_0x15a7df+=_0x1aeada(0xf0)+formatNumber(_0x470a67['toFixed'](0x2),0x2)+'</b></td>',_0x15a7df+=_0x1aeada(0xf0)+formatNumber(_0x5a0590)+_0x1aeada(0x1a3),_0x15a7df+=_0x1aeada(0xf0)+formatNumber(_0x113cd2)+'</b></td>',_0x15a7df+=_0x1aeada(0xf0)+formatNumber(_0x8e6ca6)+_0x1aeada(0x1a3),_0x15a7df+=_0x1aeada(0xcd);}_0x680d39['push'](_0x15a7df);}function _0x3ef528(_0xb6e92,_0x3f1a4f){const _0x20626c=_0x1aeada,_0x28fa27=[];for(let _0x3c068d=0x0;_0x3c068d<=_0xb6e92[_0x20626c(0xb7)]-0x1;_0x3c068d+=_0x3f1a4f){_0x28fa27['push'](_0xb6e92['slice'](_0x3c068d,_0x3c068d+_0x3f1a4f));}return _0x28fa27;}const _0x6529=_0x3ef528(_0x680d39,_0x37379c);let _0x376746='';return _0x6529[_0x1aeada(0x8b)]((_0x102dbe,_0x4f8a7b)=>{const _0x73982a=_0x1aeada;_0x4f8a7b>0x0&&(_0x376746+=_0x73982a(0x1fa));_0x376746+=_0x73982a(0x149),_0x376746+=_0x73982a(0x147),_0x376746+=_0x73982a(0xb8),_0x376746+=_0x73982a(0x98),_0x376746+=_0x73982a(0xcd),_0x376746+='<tr>',_0x376746+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x418ba1=0x0;_0x418ba1<=_0x388ad8['length']-0x1;_0x418ba1++){const _0x4475e6=_0x388ad8[_0x418ba1];for(let _0x384247=0x0;_0x384247<_0x5213e4[_0x73982a(0xb7)];_0x384247++){const _0x1babbe=_0x5213e4[_0x384247];_0x1babbe[_0x73982a(0xa5)]===_0x4475e6[_0x73982a(0xa5)][_0x73982a(0x1f4)]&&(_0x376746+=_0x73982a(0x7c)+_0x1babbe['brandCount']+_0x73982a(0x1f1)+_0x4475e6['_id'][_0x73982a(0x1f4)]+_0x73982a(0x143));}}_0x376746+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x376746+='</tr>',_0x376746+=_0x73982a(0xb8),_0x376746+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x376746+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x376746+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x354f2e=0x0;_0x354f2e<=_0x388ad8[_0x73982a(0xb7)]-0x1;_0x354f2e++){const _0x36d180=_0x388ad8[_0x354f2e];for(let _0x77539d=0x0;_0x77539d<_0x481846[_0x73982a(0x189)][_0x73982a(0xb7)];_0x77539d++){const _0x57eee8=_0x481846['cat_brand'][_0x77539d];_0x57eee8['_id'][_0x73982a(0x1f4)]===_0x36d180['_id'][_0x73982a(0x1f4)]&&(_0x376746+='<td\x20class=\x22cat_data\x22>'+_0x57eee8[_0x73982a(0xa5)][_0x73982a(0xdb)]+_0x73982a(0x143));}}_0x376746+=_0x73982a(0xdf),_0x376746+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x376746+=_0x73982a(0x162),_0x376746+=_0x73982a(0x1ba),_0x376746+=_0x73982a(0xcd),_0x376746+=_0x73982a(0x1a7),_0x376746+='<tbody>',_0x102dbe['forEach'](_0x2a219c=>{_0x376746+=_0x2a219c;}),_0x376746+=_0x73982a(0x194),_0x376746+='</table>';}),_0x376746;}async function agentsdataDSICheck_admin_excel(_0x5b5005,_0x8da60f,_0x471109,_0x435f1d){const _0x168c85=a0_0x5cb102,_0x364c31=await product[_0x168c85(0x141)]([{'$group':{'_id':{'brand':_0x168c85(0xd9),'category':_0x168c85(0x151)},'products':{'$push':{'name':_0x168c85(0x152),'product_code':_0x168c85(0x1d1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x514d50=[];_0x514d50[_0x168c85(0x189)]=[];for(let _0x1813db=0x0;_0x1813db<=_0x364c31[_0x168c85(0xb7)]-0x1;_0x1813db++){const _0x20e6da=_0x364c31[_0x1813db];_0x514d50[_0x168c85(0x189)][_0x168c85(0x199)](_0x20e6da);}const _0x5df60e=await product[_0x168c85(0x141)]([{'$group':{'_id':{'category':_0x168c85(0x151)},'products':{'$push':{'brand':_0x168c85(0xd9),'product_code':'$product_code','product_name':_0x168c85(0x152)}}}},{'$sort':{'_id.category':-0x1}}]),_0x23436a=await product[_0x168c85(0x141)]([{'$group':{'_id':{'category':_0x168c85(0x151),'brand':_0x168c85(0xd9)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1a01d4=await sales_sa[_0x168c85(0x141)]([{'$match':{'date':{'$gte':_0x5b5005,'$lte':_0x8da60f},'sales_staff_id':_0x471109,'sale_product.isFG':_0x168c85(0xb1)}},{'$unwind':_0x168c85(0x1bb)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x168c85(0x1f5),'localField':_0x168c85(0x1da),'foreignField':_0x168c85(0x1e3),'as':_0x168c85(0x174)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x168c85(0xe1),'date':_0x168c85(0x16d),'customer':_0x168c85(0x203)},'totalQty':{'$sum':_0x168c85(0x77)},'products':{'$push':{'qty':_0x168c85(0x77),'NetPrice':_0x168c85(0x18b),'discount':_0x168c85(0x1d7),'adj_discount':_0x168c85(0xce),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x168c85(0x93),'brand':_0x168c85(0xe7),'gross_price':_0x168c85(0x94)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x168c85(0x11a),'date':_0x168c85(0x78),'customer':_0x168c85(0xee),'category':_0x168c85(0x81),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x168c85(0x188)},'totalGross':{'$sum':{'$multiply':[_0x168c85(0x188),_0x168c85(0x19d)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x168c85(0xe5)},'adj_discount':{'$sum':_0x168c85(0x187)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x168c85(0x78),'customer':_0x168c85(0xee)},'totalQty':{'$sum':_0x168c85(0x173)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x168c85(0x83)},'discount':{'$sum':_0x168c85(0x18c)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x168c85(0x173),'category':'$_id.category','brand':_0x168c85(0x1ff),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x6ca132=[],_0x34a39f={},_0x9cb174={},_0x1cb5f5={};var _0x1dbb31=0x0,_0x21a773=0x0,_0x12c7d2=0x0,_0x516397=0x0,_0x4cc2ee=0x0;const _0x484056=0x16345785d8a0000;for(let _0x225757=0x0;_0x225757<=_0x1a01d4[_0x168c85(0xb7)]-0x1;_0x225757++){const _0x2b3833=_0x1a01d4[_0x225757];let _0x46e1d5=_0x168c85(0xb8);_0x46e1d5+=_0x168c85(0xc5)+_0x2b3833[_0x168c85(0xa5)][_0x168c85(0x10e)]+_0x168c85(0x143),_0x46e1d5+=_0x168c85(0xc5)+_0x2b3833[_0x168c85(0xa5)][_0x168c85(0x1aa)]+_0x168c85(0x143),_0x46e1d5+=_0x168c85(0xc5)+_0x2b3833[_0x168c85(0xa5)][_0x168c85(0x16b)]+_0x168c85(0x143);let _0x139243={};var _0x139472=0x0;for(let _0xccd493=0x0;_0xccd493<=_0x2b3833[_0x168c85(0x1f5)][_0x168c85(0xb7)]-0x1;_0xccd493++){const _0x41f061=_0x2b3833['products'][_0xccd493];_0x139243[_0x41f061[_0x168c85(0xdb)]+'-'+_0x41f061[_0x168c85(0x1f4)]]=_0x41f061[_0x168c85(0x135)];const _0x23dcaf=_0x41f061[_0x168c85(0xdb)]+'-'+_0x41f061[_0x168c85(0x1f4)];!_0x34a39f[_0x23dcaf]&&(_0x34a39f[_0x23dcaf]=0x0),!Array[_0x168c85(0x150)](_0x1cb5f5[_0x23dcaf])&&(_0x1cb5f5[_0x23dcaf]=[]),!Array[_0x168c85(0x150)](_0x1cb5f5[_0x23dcaf])&&(_0x1cb5f5[_0x23dcaf]=[]),_0x34a39f[_0x23dcaf]+=_0x41f061['qty'],_0x1cb5f5[_0x23dcaf][_0x168c85(0x199)](_0x41f061['qty']),_0x139472++;}for(let _0x522c3f=0x0;_0x522c3f<=_0x514d50[_0x168c85(0x189)][_0x168c85(0xb7)]-0x1;_0x522c3f++){const _0x229176=_0x514d50[_0x168c85(0x189)][_0x522c3f],_0x471665=_0x229176[_0x168c85(0xa5)]['brand']+'-'+_0x229176[_0x168c85(0xa5)]['category'];_0x46e1d5+=_0x168c85(0x179)+(_0x139243[_0x471665]!==undefined?_0x139243[_0x471665][_0x168c85(0x1b1)](0x2):'')+_0x168c85(0x143);}_0x12c7d2=_0x2b3833[_0x168c85(0x18e)]+_0x2b3833[_0x168c85(0x1d9)],_0x46e1d5+=_0x168c85(0x95)+formatNumber(parseFloat(_0x2b3833[_0x168c85(0x15a)],0x2)['toFixed'](0x2))+_0x168c85(0x143),_0x46e1d5+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x2b3833[_0x168c85(0xc4)][_0x168c85(0x1b1)](0x2))+'</td>',_0x46e1d5+=_0x168c85(0x95)+formatNumber(_0x12c7d2)+_0x168c85(0x143),_0x46e1d5+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x2b3833[_0x168c85(0x9c)]['toFixed'](0x2))+_0x168c85(0x143),_0x46e1d5+=_0x168c85(0xcd),_0x1dbb31+=parseFloat(_0x2b3833[_0x168c85(0x15a)]),_0x21a773+=parseFloat(_0x2b3833[_0x168c85(0x9c)][_0x168c85(0x1b1)](0x2)),_0x516397+=_0x12c7d2,_0x4cc2ee+=parseFloat(_0x2b3833[_0x168c85(0xc4)][_0x168c85(0x1b1)](0x2));if(_0x225757==_0x1a01d4[_0x168c85(0xb7)]-0x1){_0x46e1d5+=_0x168c85(0xb8),_0x46e1d5+=_0x168c85(0x165),_0x46e1d5+=_0x168c85(0x143);for(let _0x436615=0x0;_0x436615<=_0x514d50['cat_brand'][_0x168c85(0xb7)]-0x1;_0x436615++){const _0x17f925=_0x514d50['cat_brand'][_0x436615],_0x2e4cfa=_0x17f925[_0x168c85(0xa5)]['brand']+'-'+_0x17f925[_0x168c85(0xa5)][_0x168c85(0x1f4)];!_0x1cb5f5[_0x2e4cfa]&&(_0x1cb5f5[_0x2e4cfa]=[]);const _0x149270=_0x1cb5f5[_0x2e4cfa]['reduce']((_0x4a3b66,_0x3c4d00)=>_0x4a3b66+_0x3c4d00,0x0);_0x46e1d5+=_0x168c85(0x82)+(_0x149270!==undefined?formatNumber(_0x149270[_0x168c85(0x1b1)](0x2)):'')+_0x168c85(0x1a3);}_0x46e1d5+=_0x168c85(0xf0)+formatNumber(_0x1dbb31)+_0x168c85(0x1a3),_0x46e1d5+=_0x168c85(0xf0)+formatNumber(_0x4cc2ee)+_0x168c85(0x1a3),_0x46e1d5+=_0x168c85(0xf0)+formatNumber(_0x516397)+'</b></td>',_0x46e1d5+=_0x168c85(0xf0)+formatNumber(_0x21a773)+_0x168c85(0x1a3),_0x46e1d5+='</tr>';}_0x6ca132[_0x168c85(0x199)](_0x46e1d5);}function _0x3b8b10(_0x2bcc47,_0x485d8c){const _0x4dac4f=_0x168c85,_0x315074=[];for(let _0x3b521d=0x0;_0x3b521d<=_0x2bcc47[_0x4dac4f(0xb7)]-0x1;_0x3b521d+=_0x485d8c){_0x315074[_0x4dac4f(0x199)](_0x2bcc47['slice'](_0x3b521d,_0x3b521d+_0x485d8c));}return _0x315074;}const _0x261bb9=_0x3b8b10(_0x6ca132,_0x484056);let _0x82c33d='';return _0x261bb9[_0x168c85(0x8b)]((_0x2491a2,_0x145628)=>{const _0x2cb54c=_0x168c85;_0x145628>0x0&&(_0x82c33d+=_0x2cb54c(0x1fa));_0x82c33d+='<table>',_0x82c33d+=_0x2cb54c(0x147),_0x82c33d+=_0x2cb54c(0xb8),_0x82c33d+=_0x2cb54c(0x98),_0x82c33d+=_0x2cb54c(0xcd),_0x82c33d+=_0x2cb54c(0xb8),_0x82c33d+=_0x2cb54c(0x91);for(let _0x24e439=0x0;_0x24e439<=_0x5df60e['length']-0x1;_0x24e439++){const _0x6c7f7f=_0x5df60e[_0x24e439];for(let _0x52a9e5=0x0;_0x52a9e5<_0x23436a[_0x2cb54c(0xb7)];_0x52a9e5++){const _0x1749b6=_0x23436a[_0x52a9e5];_0x1749b6[_0x2cb54c(0xa5)]===_0x6c7f7f[_0x2cb54c(0xa5)][_0x2cb54c(0x1f4)]&&(_0x82c33d+=_0x2cb54c(0x7c)+_0x1749b6['brandCount']+_0x2cb54c(0x1f1)+_0x6c7f7f[_0x2cb54c(0xa5)][_0x2cb54c(0x1f4)]+_0x2cb54c(0x143));}}_0x82c33d+=_0x2cb54c(0x15f),_0x82c33d+=_0x2cb54c(0xcd),_0x82c33d+=_0x2cb54c(0xb8),_0x82c33d+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x82c33d+=_0x2cb54c(0xc8),_0x82c33d+=_0x2cb54c(0x12b);for(let _0x39c8b6=0x0;_0x39c8b6<=_0x5df60e[_0x2cb54c(0xb7)]-0x1;_0x39c8b6++){const _0xea3806=_0x5df60e[_0x39c8b6];for(let _0x1c7b1b=0x0;_0x1c7b1b<_0x514d50['cat_brand']['length'];_0x1c7b1b++){const _0x392f39=_0x514d50[_0x2cb54c(0x189)][_0x1c7b1b];_0x392f39[_0x2cb54c(0xa5)][_0x2cb54c(0x1f4)]===_0xea3806['_id']['category']&&(_0x82c33d+='<td\x20class=\x22cat_data\x22>'+_0x392f39['_id'][_0x2cb54c(0xdb)]+_0x2cb54c(0x143));}}_0x82c33d+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x82c33d+=_0x2cb54c(0xd5),_0x82c33d+=_0x2cb54c(0x162),_0x82c33d+=_0x2cb54c(0x1ba),_0x82c33d+=_0x2cb54c(0xcd),_0x82c33d+=_0x2cb54c(0x1a7),_0x82c33d+=_0x2cb54c(0xb6),_0x2491a2['forEach'](_0x310e5d=>{_0x82c33d+=_0x310e5d;}),_0x82c33d+='</tbody>',_0x82c33d+='</table>';}),_0x82c33d;}router['post'](a0_0x5cb102(0x1db),auth,async(_0x1d694e,_0x2bb4e0)=>{const _0x773b01=a0_0x5cb102,{from_date:_0x11961e,to_date:_0x2fee4d,isExcel:_0x4bb4d7,agent_id:_0x53541f}=_0x1d694e[_0x773b01(0x17d)],_0x4ccfe9=_0x1d694e[_0x773b01(0x132)],_0x4d74cc=await staff[_0x773b01(0x12d)]({'email':_0x4ccfe9[_0x773b01(0x186)]}),_0x304520=await master_shop[_0x773b01(0x7a)](),_0x97abcd=await agentsdataDSICheck_admin(_0x11961e,_0x2fee4d,_0x53541f,_0x4bb4d7),_0x7ad32b=await agentsdataDSICheck_admin_excel(_0x11961e,_0x2fee4d,_0x53541f,_0x4bb4d7);let _0x202079=_0x773b01(0x1c4);var _0x4bee03=new Date(_0x11961e),_0x20e7c0=new Date(_0x2fee4d);const _0x33a4d9={'year':'numeric','month':_0x773b01(0xe2),'day':_0x773b01(0x1ae)},_0x291a76=new Intl[(_0x773b01(0xcb))](_0x773b01(0x13b),_0x33a4d9)[_0x773b01(0x1e4)](_0x4bee03),_0x51eadc=new Intl[(_0x773b01(0xcb))]('en-US',_0x33a4d9)['format'](_0x20e7c0);_0x202079+=_0x773b01(0x18a),_0x202079+=_0x773b01(0x122),_0x202079+=_0x773b01(0x149),_0x202079+=_0x97abcd,_0x202079+=_0x773b01(0x9b),_0x202079+=_0x773b01(0x111),_0x202079+='</div>';let _0x256fcb=_0x773b01(0x1c4);_0x256fcb+=_0x773b01(0x18a),_0x256fcb+=_0x773b01(0x122),_0x256fcb+=_0x773b01(0x149),_0x256fcb+=_0x7ad32b,_0x256fcb+='</table>',_0x256fcb+=_0x773b01(0x111),_0x256fcb+='</div>';let _0x228d70=_0x773b01(0x88);const _0x32b6ec={'width':_0x773b01(0xe3),'height':_0x773b01(0x8c),'orientation':_0x773b01(0x14a),'border':{'top':_0x773b01(0x1f6),'right':'0.1in','bottom':_0x773b01(0x1f6),'left':'0.1in'},'header':{'height':'60mm','contents':_0x773b01(0x1ec)+_0x228d70+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x291a76+_0x773b01(0x17e)+_0x51eadc+_0x773b01(0x8a)},'footer':{'height':_0x773b01(0xf6),'contents':{'default':_0x773b01(0x14e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x773b01(0xa0)}}};if(_0x4bb4d7=='on'){const _0x33d9a4=cheerio[_0x773b01(0x17c)](_0x256fcb);let _0x3b703f=[],_0x105d91=[],_0x1fa64d=[];_0x33d9a4(_0x773b01(0x1b2))[_0x773b01(0x1f0)]((_0x4a8791,_0x511ff1)=>{const _0xfc2aaa=_0x773b01;let _0x3153b6=[],_0x161641=0x0;while(_0x1fa64d[_0x161641]){_0x1fa64d[_0x161641]--,_0x161641++;}_0x33d9a4(_0x511ff1)[_0xfc2aaa(0x7a)](_0xfc2aaa(0x10c))[_0xfc2aaa(0x1f0)]((_0x5688e3,_0x273978)=>{const _0x1a507d=_0xfc2aaa;let _0x5eee5c=_0x33d9a4(_0x273978)[_0x1a507d(0x15d)]()[_0x1a507d(0x16f)](),_0x55a2f7=parseFloat(_0x5eee5c[_0x1a507d(0xef)](/,/g,''));isNaN(_0x55a2f7)&&(_0x55a2f7=_0x5eee5c);let _0xa4c2c1=parseInt(_0x33d9a4(_0x273978)['attr'](_0x1a507d(0x1a4)))||0x1,_0x4ef1c2=parseInt(_0x33d9a4(_0x273978)[_0x1a507d(0x1e1)]('rowspan'))||0x1;_0x3153b6[_0x161641]=_0x55a2f7;(_0xa4c2c1>0x1||_0x4ef1c2>0x1)&&_0x105d91[_0x1a507d(0x199)]({'s':{'r':_0x4a8791,'c':_0x161641},'e':{'r':_0x4a8791+_0x4ef1c2-0x1,'c':_0x161641+_0xa4c2c1-0x1}});for(let _0x27b73f=0x0;_0x27b73f<_0xa4c2c1;_0x27b73f++){_0x4ef1c2>0x1&&(_0x1fa64d[_0x161641+_0x27b73f]=_0x4ef1c2-0x1);}_0x161641+=_0xa4c2c1;}),_0x3b703f[_0xfc2aaa(0x199)](_0x3153b6);});const _0x4420a1=XLSX[_0x773b01(0x1b6)][_0x773b01(0x144)](),_0x590b4e=XLSX[_0x773b01(0x1b6)]['aoa_to_sheet'](_0x3b703f);_0x105d91[_0x773b01(0xb7)]>0x0&&(_0x590b4e[_0x773b01(0x1dd)]=_0x105d91);_0x590b4e[_0x773b01(0x19a)]=_0x3b703f[0x0][_0x773b01(0x142)](()=>({'wpx':0x64})),XLSX[_0x773b01(0x1b6)][_0x773b01(0x1ab)](_0x4420a1,_0x590b4e,'Sales\x20Report');const _0x400307=XLSX[_0x773b01(0x85)](_0x4420a1,{'bookType':_0x773b01(0x14b),'type':_0x773b01(0x8f)});_0x2bb4e0['setHeader'](_0x773b01(0xcc),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x2bb4e0[_0x773b01(0x140)](_0x773b01(0x1be),_0x773b01(0x11d)),_0x2bb4e0[_0x773b01(0x182)](_0x400307);}else pdf[_0x773b01(0xd4)](_0x202079,_0x32b6ec)[_0x773b01(0x1c6)](function(_0x52e80f,_0x1550a4){const _0x73dc10=_0x773b01;if(_0x52e80f){_0x2bb4e0[_0x73dc10(0x1eb)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x2bb4e0[_0x73dc10(0x140)](_0x73dc10(0x1be),'application/pdf'),_0x1550a4['pipe'](_0x2bb4e0);});}),router[a0_0x5cb102(0x1e8)](a0_0x5cb102(0x191),auth,async(_0x44fc05,_0x580222)=>{const _0x532539=a0_0x5cb102;try{const {username:_0x48eca9,email:_0x130f06,role:_0x9a3190}=_0x44fc05['user'],_0x4fdac5=_0x44fc05[_0x532539(0x132)],_0x1ee844=await profile['findOne']({'email':_0x4fdac5[_0x532539(0x186)]}),_0xd28e99={'year':_0x532539(0x1ae),'month':_0x532539(0xe2),'day':_0x532539(0x1ae)},_0x468c08=await master_shop[_0x532539(0x7a)](),_0x2910b4=await staff['findOne']({'email':_0x4fdac5[_0x532539(0x186)]}),_0x2eae9b=await product[_0x532539(0x7a)](),_0x5caaab=await warehouse[_0x532539(0x141)]([{'$unwind':_0x532539(0x10a)},{'$lookup':{'from':_0x532539(0x1f5),'localField':'product_details.product_name','foreignField':_0x532539(0xa4),'as':_0x532539(0x1c3)}},{'$unwind':_0x532539(0x1b4)},{'$project':{'product_name':_0x532539(0x1e7),'product_stock':_0x532539(0xc2)}},{'$group':{'_id':_0x532539(0x13c),'product_stock':{'$sum':_0x532539(0x109)}}}]);if(_0x468c08[0x0][_0x532539(0x1f8)]==_0x532539(0x87))var _0x3aca81=users[_0x532539(0x14d)];else{if(_0x468c08[0x0][_0x532539(0x1f8)]==_0x532539(0x7f))var _0x3aca81=users[_0x532539(0x7f)];else{if(_0x468c08[0x0][_0x532539(0x1f8)]==_0x532539(0x13a))var _0x3aca81=users[_0x532539(0x13a)];else{if(_0x468c08[0x0][_0x532539(0x1f8)]==_0x532539(0x1e6))var _0x3aca81=users['Spanish'];else{if(_0x468c08[0x0]['language']==_0x532539(0xf9))var _0x3aca81=users[_0x532539(0xf9)];else{if(_0x468c08[0x0][_0x532539(0x1f8)]=='Portuguese\x20(BR)')var _0x3aca81=users['Portuguese'];else{if(_0x468c08[0x0]['language']==_0x532539(0xcf))var _0x3aca81=users[_0x532539(0xcf)];else{if(_0x468c08[0x0][_0x532539(0x1f8)]==_0x532539(0x128))var _0x3aca81=users[_0x532539(0xbc)];}}}}}}}_0x580222['render'](_0x532539(0x11e),{'success':_0x44fc05[_0x532539(0x17f)](_0x532539(0x171)),'errors':_0x44fc05[_0x532539(0x17f)](_0x532539(0x118)),'alldata':_0x2eae9b,'profile':_0x1ee844,'master_shop':_0x468c08,'role':_0x4fdac5,'product_stock':_0x5caaab,'language':_0x3aca81,'staff_arr':_0x2910b4});}catch(_0x2d71a2){}});function formatNumber(_0x37e28d,_0x273766=a0_0x5cb102(0x13b),_0x37a1ce={'minimumFractionDigits':0x2}){const _0x5cae5f=a0_0x5cb102,_0x1f6222=new Intl['NumberFormat'](_0x273766,_0x37a1ce);return _0x1f6222[_0x5cae5f(0x1e4)](_0x37e28d);}async function agentsdataDSICheck(_0x4f100b,_0xf80338,_0x182908,_0x360ac8){const _0x5de1c2=a0_0x5cb102,_0x3d95d2=await product[_0x5de1c2(0x141)]([{'$group':{'_id':{'brand':_0x5de1c2(0xd9),'category':_0x5de1c2(0x151)},'products':{'$push':{'name':_0x5de1c2(0x152),'product_code':_0x5de1c2(0x1d1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2a14a4=[];_0x2a14a4[_0x5de1c2(0x189)]=[];for(let _0x190f4b=0x0;_0x190f4b<=_0x3d95d2[_0x5de1c2(0xb7)]-0x1;_0x190f4b++){const _0x22eb3b=_0x3d95d2[_0x190f4b];_0x2a14a4[_0x5de1c2(0x189)]['push'](_0x22eb3b);}const _0x9d4aba=await product[_0x5de1c2(0x141)]([{'$group':{'_id':{'category':_0x5de1c2(0x151)},'products':{'$push':{'brand':_0x5de1c2(0xd9),'product_code':_0x5de1c2(0x1d1),'product_name':_0x5de1c2(0x152)}}}},{'$sort':{'_id.category':-0x1}}]),_0x30c39f=await product[_0x5de1c2(0x141)]([{'$group':{'_id':{'category':_0x5de1c2(0x151),'brand':'$brand'}}},{'$group':{'_id':_0x5de1c2(0x1ed),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3e106f=await sales_sa[_0x5de1c2(0x141)]([{'$match':{'date':{'$gte':_0x4f100b,'$lte':_0xf80338},'sales_staff_id':_0x182908,'sale_product.isFG':_0x5de1c2(0xb1),'status_data':_0x5de1c2(0xb1)}},{'$unwind':_0x5de1c2(0x1bb)},{'$match':{'sale_product.isFG':_0x5de1c2(0xb1)}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':'product_code','as':'product_info'}},{'$unwind':_0x5de1c2(0x121)},{'$group':{'_id':{'dsi':_0x5de1c2(0xe1),'date':'$date','customer':_0x5de1c2(0x203)},'totalQty':{'$sum':_0x5de1c2(0x77)},'products':{'$push':{'qty':_0x5de1c2(0x77),'NetPrice':_0x5de1c2(0x18b),'discount':_0x5de1c2(0x1d7),'adj_discount':_0x5de1c2(0xce),'product_details':{'prod_name':_0x5de1c2(0x176),'product_code':_0x5de1c2(0x1d8),'category':_0x5de1c2(0x93),'brand':_0x5de1c2(0xe7),'gross_price':_0x5de1c2(0x94)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x5de1c2(0x11a),'date':_0x5de1c2(0x78),'customer':'$_id.customer','category':_0x5de1c2(0x81),'brand':_0x5de1c2(0x192)},'totalQty':{'$sum':_0x5de1c2(0x188)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x5de1c2(0x19d)]}},'NetPrice':{'$sum':_0x5de1c2(0xdc)},'discount':{'$sum':_0x5de1c2(0xe5)},'adj_discount':{'$sum':_0x5de1c2(0x187)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x5de1c2(0x11a),'date':_0x5de1c2(0x78),'customer':'$_id.customer'},'totalQty':{'$sum':_0x5de1c2(0x173)},'totalGross':{'$sum':_0x5de1c2(0x168)},'NetPrice':{'$sum':_0x5de1c2(0x83)},'discount':{'$sum':_0x5de1c2(0x18c)},'adj_discount':{'$sum':_0x5de1c2(0x146)},'products':{'$push':{'qty':_0x5de1c2(0x173),'category':_0x5de1c2(0x1ed),'brand':_0x5de1c2(0x1ff),'product_details':_0x5de1c2(0x10a)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4dce48=[],_0x210a16={},_0x3e0474={},_0x13520a={};var _0x133e90=0x0,_0xf69e91=0x0,_0x4f2c6a=0x0,_0x16fc8d=0x0,_0x3367dc=0x0;const _0x3ed3ee=0x6;for(let _0x5c1341=0x0;_0x5c1341<=_0x3e106f[_0x5de1c2(0xb7)]-0x1;_0x5c1341++){const _0xeed440=_0x3e106f[_0x5c1341];let _0x2cb68e=_0x5de1c2(0xb8);_0x2cb68e+=_0x5de1c2(0xc5)+_0xeed440[_0x5de1c2(0xa5)][_0x5de1c2(0x10e)]+_0x5de1c2(0x143),_0x2cb68e+=_0x5de1c2(0xc5)+_0xeed440[_0x5de1c2(0xa5)][_0x5de1c2(0x1aa)]+_0x5de1c2(0x143),_0x2cb68e+=_0x5de1c2(0xc5)+_0xeed440[_0x5de1c2(0xa5)]['customer']+_0x5de1c2(0x143);let _0x5ac09f={};var _0x3b9970=0x0;for(let _0x58ba72=0x0;_0x58ba72<=_0xeed440[_0x5de1c2(0x1f5)][_0x5de1c2(0xb7)]-0x1;_0x58ba72++){const _0x30078b=_0xeed440[_0x5de1c2(0x1f5)][_0x58ba72];_0x5ac09f[_0x30078b[_0x5de1c2(0xdb)]+'-'+_0x30078b[_0x5de1c2(0x1f4)]]=_0x30078b[_0x5de1c2(0x135)];const _0x17fe41=_0x30078b[_0x5de1c2(0xdb)]+'-'+_0x30078b['category'];!_0x210a16[_0x17fe41]&&(_0x210a16[_0x17fe41]=0x0),!Array[_0x5de1c2(0x150)](_0x13520a[_0x17fe41])&&(_0x13520a[_0x17fe41]=[]),!Array[_0x5de1c2(0x150)](_0x13520a[_0x17fe41])&&(_0x13520a[_0x17fe41]=[]),_0x210a16[_0x17fe41]+=_0x30078b[_0x5de1c2(0x135)],_0x13520a[_0x17fe41]['push'](_0x30078b[_0x5de1c2(0x135)]),_0x3b9970++;}for(let _0x48447e=0x0;_0x48447e<=_0x2a14a4['cat_brand']['length']-0x1;_0x48447e++){const _0x1a37f2=_0x2a14a4[_0x5de1c2(0x189)][_0x48447e],_0x2930c9=_0x1a37f2[_0x5de1c2(0xa5)][_0x5de1c2(0xdb)]+'-'+_0x1a37f2[_0x5de1c2(0xa5)][_0x5de1c2(0x1f4)];_0x2cb68e+=_0x5de1c2(0x179)+(_0x5ac09f[_0x2930c9]!==undefined?_0x5ac09f[_0x2930c9]['toFixed'](0x2):'')+_0x5de1c2(0x143);}_0x4f2c6a=_0xeed440[_0x5de1c2(0x18e)]+_0xeed440[_0x5de1c2(0x1d9)],_0x2cb68e+=_0x5de1c2(0x95)+formatNumber(parseFloat(_0xeed440['totalQty'],0x2)[_0x5de1c2(0x1b1)](0x2))+_0x5de1c2(0x143),_0x2cb68e+=_0x5de1c2(0x95)+formatNumber(_0xeed440[_0x5de1c2(0xc4)][_0x5de1c2(0x1b1)](0x2))+_0x5de1c2(0x143),_0x2cb68e+=_0x5de1c2(0x95)+formatNumber(_0x4f2c6a)+_0x5de1c2(0x143),_0x2cb68e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xeed440['NetPrice'][_0x5de1c2(0x1b1)](0x2))+_0x5de1c2(0x143),_0x2cb68e+=_0x5de1c2(0xcd),_0x133e90+=parseFloat(_0xeed440[_0x5de1c2(0x15a)]),_0xf69e91+=parseFloat(_0xeed440[_0x5de1c2(0x9c)][_0x5de1c2(0x1b1)](0x2)),_0x16fc8d+=_0x4f2c6a,_0x3367dc+=parseFloat(_0xeed440[_0x5de1c2(0xc4)]['toFixed'](0x2));if(_0x5c1341==_0x3e106f[_0x5de1c2(0xb7)]-0x1){_0x2cb68e+='<tr>',_0x2cb68e+=_0x5de1c2(0x165),_0x2cb68e+=_0x5de1c2(0x143);for(let _0x32dc56=0x0;_0x32dc56<=_0x2a14a4['cat_brand'][_0x5de1c2(0xb7)]-0x1;_0x32dc56++){const _0x3276c7=_0x2a14a4[_0x5de1c2(0x189)][_0x32dc56],_0x15f121=_0x3276c7['_id'][_0x5de1c2(0xdb)]+'-'+_0x3276c7[_0x5de1c2(0xa5)][_0x5de1c2(0x1f4)];!_0x13520a[_0x15f121]&&(_0x13520a[_0x15f121]=[]);const _0x5c634c=_0x13520a[_0x15f121]['reduce']((_0x4006da,_0x3020f9)=>_0x4006da+_0x3020f9,0x0);_0x2cb68e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x5c634c!==undefined?formatNumber(_0x5c634c[_0x5de1c2(0x1b1)](0x2)):'')+_0x5de1c2(0x1a3);}_0x2cb68e+=_0x5de1c2(0xf0)+formatNumber(_0x133e90[_0x5de1c2(0x1b1)](0x2))+'</b></td>',_0x2cb68e+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3367dc)+_0x5de1c2(0x1a3),_0x2cb68e+=_0x5de1c2(0xf0)+formatNumber(_0x16fc8d)+'</b></td>',_0x2cb68e+=_0x5de1c2(0xf0)+formatNumber(_0xf69e91)+'</b></td>',_0x2cb68e+=_0x5de1c2(0xcd);}console[_0x5de1c2(0x153)](_0x5de1c2(0x8d),_0x133e90+'+='+parseFloat(_0xeed440[_0x5de1c2(0x15a)])),_0x4dce48[_0x5de1c2(0x199)](_0x2cb68e);}function _0x47f4bd(_0x23e2dc,_0x142119){const _0x32fd32=_0x5de1c2,_0x384869=[];for(let _0x449e5b=0x0;_0x449e5b<=_0x23e2dc['length']-0x1;_0x449e5b+=_0x142119){_0x384869[_0x32fd32(0x199)](_0x23e2dc['slice'](_0x449e5b,_0x449e5b+_0x142119));}return _0x384869;}const _0xbe278b=_0x47f4bd(_0x4dce48,_0x3ed3ee);let _0x4ef658='';return _0xbe278b[_0x5de1c2(0x8b)]((_0x3a99a5,_0x522a4a)=>{const _0x226019=_0x5de1c2;_0x522a4a>0x0&&(_0x4ef658+=_0x226019(0x1fa));_0x4ef658+=_0x226019(0x149),_0x4ef658+=_0x226019(0x147),_0x4ef658+=_0x226019(0xb8),_0x4ef658+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4ef658+=_0x226019(0xcd),_0x4ef658+='<tr>',_0x4ef658+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x3633a9=0x0;_0x3633a9<=_0x9d4aba['length']-0x1;_0x3633a9++){const _0x598384=_0x9d4aba[_0x3633a9];for(let _0x1b3f85=0x0;_0x1b3f85<_0x30c39f[_0x226019(0xb7)];_0x1b3f85++){const _0x1d7a0c=_0x30c39f[_0x1b3f85];_0x1d7a0c[_0x226019(0xa5)]===_0x598384[_0x226019(0xa5)][_0x226019(0x1f4)]&&(_0x4ef658+='<td\x20colspan=\x22'+_0x1d7a0c['brandCount']+_0x226019(0x1f1)+_0x598384['_id']['category']+'</td>');}}_0x4ef658+=_0x226019(0x15f),_0x4ef658+=_0x226019(0xcd),_0x4ef658+=_0x226019(0xb8),_0x4ef658+=_0x226019(0x102),_0x4ef658+=_0x226019(0xc8),_0x4ef658+=_0x226019(0x12b);for(let _0x228ccf=0x0;_0x228ccf<=_0x9d4aba[_0x226019(0xb7)]-0x1;_0x228ccf++){const _0x4563b1=_0x9d4aba[_0x228ccf];for(let _0x47ec50=0x0;_0x47ec50<_0x2a14a4['cat_brand'][_0x226019(0xb7)];_0x47ec50++){const _0xebf733=_0x2a14a4[_0x226019(0x189)][_0x47ec50];_0xebf733['_id']['category']===_0x4563b1[_0x226019(0xa5)][_0x226019(0x1f4)]&&(_0x4ef658+=_0x226019(0x1fc)+_0xebf733[_0x226019(0xa5)]['brand']+_0x226019(0x143));}}_0x4ef658+=_0x226019(0xdf),_0x4ef658+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x4ef658+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x4ef658+=_0x226019(0x1ba),_0x4ef658+=_0x226019(0xcd),_0x4ef658+=_0x226019(0x1a7),_0x4ef658+=_0x226019(0xb6),_0x3a99a5['forEach'](_0xce53fa=>{_0x4ef658+=_0xce53fa;}),_0x4ef658+='</tbody>',_0x4ef658+='</table>';}),_0x4ef658;}async function agentsdataDSICheck_excel(_0x1689d0,_0x369c97,_0x29456a,_0x46407b){const _0x3af1f5=a0_0x5cb102,_0xd29599=await product['aggregate']([{'$group':{'_id':{'brand':_0x3af1f5(0xd9),'category':'$category'},'products':{'$push':{'name':_0x3af1f5(0x152),'product_code':_0x3af1f5(0x1d1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3c583e=[];_0x3c583e[_0x3af1f5(0x189)]=[];for(let _0x129c14=0x0;_0x129c14<=_0xd29599[_0x3af1f5(0xb7)]-0x1;_0x129c14++){const _0x6f92d1=_0xd29599[_0x129c14];_0x3c583e[_0x3af1f5(0x189)][_0x3af1f5(0x199)](_0x6f92d1);}const _0xbf0890=await product[_0x3af1f5(0x141)]([{'$group':{'_id':{'category':_0x3af1f5(0x151)},'products':{'$push':{'brand':_0x3af1f5(0xd9),'product_code':_0x3af1f5(0x1d1),'product_name':_0x3af1f5(0x152)}}}},{'$sort':{'_id.category':-0x1}}]),_0x448540=await product[_0x3af1f5(0x141)]([{'$group':{'_id':{'category':_0x3af1f5(0x151),'brand':'$brand'}}},{'$group':{'_id':_0x3af1f5(0x1ed),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x15ba9a=await sales_sa[_0x3af1f5(0x141)]([{'$match':{'date':{'$gte':_0x1689d0,'$lte':_0x369c97},'sales_staff_id':_0x29456a,'sale_product.isFG':_0x3af1f5(0xb1)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x3af1f5(0xb1)}},{'$lookup':{'from':_0x3af1f5(0x1f5),'localField':_0x3af1f5(0x1da),'foreignField':_0x3af1f5(0x1e3),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x3af1f5(0xe1),'date':_0x3af1f5(0x16d),'customer':_0x3af1f5(0x203)},'totalQty':{'$sum':_0x3af1f5(0x77)},'products':{'$push':{'qty':_0x3af1f5(0x77),'NetPrice':_0x3af1f5(0x18b),'discount':'$sale_product.discount','adj_discount':_0x3af1f5(0xce),'product_details':{'prod_name':_0x3af1f5(0x176),'product_code':_0x3af1f5(0x1d8),'category':_0x3af1f5(0x93),'brand':_0x3af1f5(0xe7),'gross_price':_0x3af1f5(0x94)}}}}},{'$unwind':_0x3af1f5(0x1ca)},{'$group':{'_id':{'dsi':_0x3af1f5(0x11a),'date':_0x3af1f5(0x78),'customer':_0x3af1f5(0xee),'category':_0x3af1f5(0x81),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x3af1f5(0x188)},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x3af1f5(0xdc)},'discount':{'$sum':_0x3af1f5(0xe5)},'adj_discount':{'$sum':_0x3af1f5(0x187)},'product_details':{'$first':_0x3af1f5(0x19f)}}},{'$group':{'_id':{'dsi':_0x3af1f5(0x11a),'date':_0x3af1f5(0x78),'customer':_0x3af1f5(0xee)},'totalQty':{'$sum':_0x3af1f5(0x173)},'totalGross':{'$sum':_0x3af1f5(0x168)},'NetPrice':{'$sum':_0x3af1f5(0x83)},'discount':{'$sum':_0x3af1f5(0x18c)},'adj_discount':{'$sum':_0x3af1f5(0x146)},'products':{'$push':{'qty':_0x3af1f5(0x173),'category':'$_id.category','brand':_0x3af1f5(0x1ff),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2cab59=[],_0x20f9fc={},_0xd71883={},_0x338183={};var _0x330465=0x0,_0x426583=0x0,_0x22143f=0x0,_0x2a9b40=0x0,_0xa0fb78=0x0;const _0x532b7c=0x9184e72a000;for(let _0xf2fc84=0x0;_0xf2fc84<=_0x15ba9a[_0x3af1f5(0xb7)]-0x1;_0xf2fc84++){const _0xfd640e=_0x15ba9a[_0xf2fc84];let _0x2806cb=_0x3af1f5(0xb8);_0x2806cb+=_0x3af1f5(0xc5)+_0xfd640e['_id']['dsi']+_0x3af1f5(0x143),_0x2806cb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xfd640e['_id'][_0x3af1f5(0x1aa)]+_0x3af1f5(0x143),_0x2806cb+=_0x3af1f5(0xc5)+_0xfd640e[_0x3af1f5(0xa5)][_0x3af1f5(0x16b)]+_0x3af1f5(0x143);let _0x24cc6b={};var _0x21db12=0x0;for(let _0x5a96da=0x0;_0x5a96da<=_0xfd640e[_0x3af1f5(0x1f5)]['length']-0x1;_0x5a96da++){const _0x69e9cc=_0xfd640e['products'][_0x5a96da];_0x24cc6b[_0x69e9cc[_0x3af1f5(0xdb)]+'-'+_0x69e9cc['category']]=_0x69e9cc[_0x3af1f5(0x135)];const _0x65ee2a=_0x69e9cc[_0x3af1f5(0xdb)]+'-'+_0x69e9cc[_0x3af1f5(0x1f4)];!_0x20f9fc[_0x65ee2a]&&(_0x20f9fc[_0x65ee2a]=0x0),!Array['isArray'](_0x338183[_0x65ee2a])&&(_0x338183[_0x65ee2a]=[]),!Array['isArray'](_0x338183[_0x65ee2a])&&(_0x338183[_0x65ee2a]=[]),_0x20f9fc[_0x65ee2a]+=_0x69e9cc[_0x3af1f5(0x135)],_0x338183[_0x65ee2a]['push'](_0x69e9cc[_0x3af1f5(0x135)]),_0x21db12++;}for(let _0x476c32=0x0;_0x476c32<=_0x3c583e['cat_brand'][_0x3af1f5(0xb7)]-0x1;_0x476c32++){const _0x29c2df=_0x3c583e['cat_brand'][_0x476c32],_0x4bd01f=_0x29c2df['_id'][_0x3af1f5(0xdb)]+'-'+_0x29c2df[_0x3af1f5(0xa5)]['category'];_0x2806cb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x24cc6b[_0x4bd01f]!==undefined?_0x24cc6b[_0x4bd01f][_0x3af1f5(0x1b1)](0x2):'')+_0x3af1f5(0x143);}_0x22143f=_0xfd640e[_0x3af1f5(0x18e)]+_0xfd640e['adj_discount'],_0x2806cb+=_0x3af1f5(0x95)+formatNumber(parseFloat(_0xfd640e[_0x3af1f5(0x15a)],0x2)[_0x3af1f5(0x1b1)](0x2))+_0x3af1f5(0x143),_0x2806cb+=_0x3af1f5(0x95)+formatNumber(_0xfd640e[_0x3af1f5(0xc4)][_0x3af1f5(0x1b1)](0x2))+_0x3af1f5(0x143),_0x2806cb+=_0x3af1f5(0x95)+formatNumber(_0x22143f)+_0x3af1f5(0x143),_0x2806cb+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xfd640e[_0x3af1f5(0x9c)][_0x3af1f5(0x1b1)](0x2))+'</td>',_0x2806cb+=_0x3af1f5(0xcd),_0x330465+=parseFloat(_0xfd640e[_0x3af1f5(0x15a)]['toFixed'](0x2)),_0x426583+=parseFloat(_0xfd640e[_0x3af1f5(0x9c)][_0x3af1f5(0x1b1)](0x2)),_0x2a9b40+=_0x22143f,_0xa0fb78+=parseFloat(_0xfd640e['totalGross'][_0x3af1f5(0x1b1)](0x2));if(_0xf2fc84==_0x15ba9a[_0x3af1f5(0xb7)]-0x1){_0x2806cb+=_0x3af1f5(0xb8),_0x2806cb+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x2806cb+=_0x3af1f5(0x143);for(let _0x3e6728=0x0;_0x3e6728<=_0x3c583e[_0x3af1f5(0x189)]['length']-0x1;_0x3e6728++){const _0x56e2a1=_0x3c583e['cat_brand'][_0x3e6728],_0xbe272=_0x56e2a1[_0x3af1f5(0xa5)][_0x3af1f5(0xdb)]+'-'+_0x56e2a1[_0x3af1f5(0xa5)]['category'];!_0x338183[_0xbe272]&&(_0x338183[_0xbe272]=[]);const _0x46d037=_0x338183[_0xbe272][_0x3af1f5(0x116)]((_0x1dd48d,_0x15c782)=>_0x1dd48d+_0x15c782,0x0);_0x2806cb+=_0x3af1f5(0x82)+(_0x46d037!==undefined?formatNumber(_0x46d037[_0x3af1f5(0x1b1)](0x2)):'')+_0x3af1f5(0x1a3);}_0x2806cb+=_0x3af1f5(0xf0)+formatNumber(_0x330465[_0x3af1f5(0x1b1)](0x2))+_0x3af1f5(0x1a3),_0x2806cb+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xa0fb78)+_0x3af1f5(0x1a3),_0x2806cb+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2a9b40)+'</b></td>',_0x2806cb+=_0x3af1f5(0xf0)+formatNumber(_0x426583)+_0x3af1f5(0x1a3),_0x2806cb+=_0x3af1f5(0xcd);}_0x2cab59[_0x3af1f5(0x199)](_0x2806cb);}function _0x844fd7(_0x3a1253,_0x3192dc){const _0x347e8d=_0x3af1f5,_0x31f098=[];for(let _0x3ac39d=0x0;_0x3ac39d<=_0x3a1253['length']-0x1;_0x3ac39d+=_0x3192dc){_0x31f098[_0x347e8d(0x199)](_0x3a1253[_0x347e8d(0x16c)](_0x3ac39d,_0x3ac39d+_0x3192dc));}return _0x31f098;}const _0x50e648=_0x844fd7(_0x2cab59,_0x532b7c);let _0x55ef88='';return _0x50e648[_0x3af1f5(0x8b)]((_0x5876a5,_0x4e6e50)=>{const _0x36bfdb=_0x3af1f5;_0x4e6e50>0x0&&(_0x55ef88+=_0x36bfdb(0x1fa));_0x55ef88+=_0x36bfdb(0x149),_0x55ef88+=_0x36bfdb(0x147),_0x55ef88+=_0x36bfdb(0xb8),_0x55ef88+=_0x36bfdb(0x98),_0x55ef88+=_0x36bfdb(0xcd),_0x55ef88+='<tr>',_0x55ef88+=_0x36bfdb(0x91);for(let _0x3a7245=0x0;_0x3a7245<=_0xbf0890['length']-0x1;_0x3a7245++){const _0x3228d2=_0xbf0890[_0x3a7245];for(let _0x492085=0x0;_0x492085<_0x448540[_0x36bfdb(0xb7)];_0x492085++){const _0x5e115a=_0x448540[_0x492085];_0x5e115a[_0x36bfdb(0xa5)]===_0x3228d2[_0x36bfdb(0xa5)][_0x36bfdb(0x1f4)]&&(_0x55ef88+=_0x36bfdb(0x7c)+_0x5e115a[_0x36bfdb(0x89)]+_0x36bfdb(0x1f1)+_0x3228d2[_0x36bfdb(0xa5)][_0x36bfdb(0x1f4)]+'</td>');}}_0x55ef88+=_0x36bfdb(0x15f),_0x55ef88+=_0x36bfdb(0xcd),_0x55ef88+=_0x36bfdb(0xb8),_0x55ef88+=_0x36bfdb(0x102),_0x55ef88+=_0x36bfdb(0xc8),_0x55ef88+=_0x36bfdb(0x12b);for(let _0x371818=0x0;_0x371818<=_0xbf0890['length']-0x1;_0x371818++){const _0xb63ba6=_0xbf0890[_0x371818];for(let _0x5956a0=0x0;_0x5956a0<_0x3c583e[_0x36bfdb(0x189)][_0x36bfdb(0xb7)];_0x5956a0++){const _0x354bc4=_0x3c583e[_0x36bfdb(0x189)][_0x5956a0];_0x354bc4[_0x36bfdb(0xa5)][_0x36bfdb(0x1f4)]===_0xb63ba6[_0x36bfdb(0xa5)][_0x36bfdb(0x1f4)]&&(_0x55ef88+='<td\x20class=\x22cat_data\x22>'+_0x354bc4[_0x36bfdb(0xa5)]['brand']+_0x36bfdb(0x143));}}_0x55ef88+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x55ef88+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x55ef88+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x55ef88+=_0x36bfdb(0x1ba),_0x55ef88+='</tr>',_0x55ef88+=_0x36bfdb(0x1a7),_0x55ef88+=_0x36bfdb(0xb6),_0x5876a5['forEach'](_0x342fb6=>{_0x55ef88+=_0x342fb6;}),console['log'](_0x338183),_0x55ef88+=_0x36bfdb(0x194),_0x55ef88+=_0x36bfdb(0x9b);}),_0x55ef88;}function a0_0x1f28(_0x5da3b6,_0x1185c2){const _0x5d8264=a0_0x5d82();return a0_0x1f28=function(_0x1f2838,_0x5bb238){_0x1f2838=_0x1f2838-0x75;let _0x3b101d=_0x5d8264[_0x1f2838];return _0x3b101d;},a0_0x1f28(_0x5da3b6,_0x1185c2);}router[a0_0x5cb102(0x195)](a0_0x5cb102(0x104),auth,async(_0x11fb7e,_0x48bd98)=>{const _0x23677d=a0_0x5cb102,{from_date:_0x185ab7,to_date:_0xcf8777,isExcel:_0x2b44b3}=_0x11fb7e[_0x23677d(0x17d)],_0x72da6=_0x11fb7e['user'],_0x3186fc=await staff[_0x23677d(0x12d)]({'email':_0x72da6['email']}),_0x52a86e=await master_shop['find'](),_0xcd853a=await agentsdataDSICheck(_0x185ab7,_0xcf8777,_0x3186fc[_0x23677d(0xa5)][_0x23677d(0xc7)](),_0x2b44b3),_0x65853d=await agentsdataDSICheck_excel(_0x185ab7,_0xcf8777,_0x3186fc[_0x23677d(0xa5)][_0x23677d(0xc7)](),_0x2b44b3);let _0x504dbe='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x4be051=new Date(_0x185ab7),_0x1d154b=new Date(_0xcf8777);const _0x344cad={'year':_0x23677d(0x1ae),'month':'long','day':_0x23677d(0x1ae)},_0x592dd4=new Intl[(_0x23677d(0xcb))](_0x23677d(0x13b),_0x344cad)[_0x23677d(0x1e4)](_0x4be051),_0x5d3ba7=new Intl['DateTimeFormat']('en-US',_0x344cad)[_0x23677d(0x1e4)](_0x1d154b);_0x504dbe+=_0x23677d(0x18a),_0x504dbe+=_0x23677d(0x122),_0x504dbe+=_0x23677d(0x149),_0x504dbe+=_0xcd853a,_0x504dbe+=_0x23677d(0x9b),_0x504dbe+=_0x23677d(0x111),_0x504dbe+=_0x23677d(0x111);let _0x4e54d7=_0x23677d(0x79);_0x4e54d7+=_0x23677d(0x18a),_0x4e54d7+=_0x23677d(0x122),_0x4e54d7+=_0x23677d(0x149),_0x4e54d7+=_0x65853d,_0x4e54d7+=_0x23677d(0x9b),_0x4e54d7+=_0x23677d(0x111),_0x4e54d7+=_0x23677d(0x111);let _0x58accd=_0x23677d(0x88);const _0x20844a={'width':'15in','height':_0x23677d(0x8c),'orientation':_0x23677d(0x14a),'border':{'top':_0x23677d(0x1f6),'right':_0x23677d(0x1f6),'bottom':_0x23677d(0x1f6),'left':'0.1in'},'header':{'height':_0x23677d(0xda),'contents':_0x23677d(0x1ec)+_0x58accd+_0x23677d(0x1d2)+_0x592dd4+_0x23677d(0x17e)+_0x5d3ba7+_0x23677d(0x8a)},'footer':{'height':'20mm','contents':{'default':_0x23677d(0x14e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x23677d(0xa0)}}};if(_0x2b44b3=='on'){const _0x87b80c=cheerio[_0x23677d(0x17c)](_0x4e54d7);let _0x4e8874=[],_0x3707a9=[],_0x2d1d0e=[];const _0x5193d7=_0x31df14=>{const _0xb01ef=_0x23677d,_0x22bf20={'top':{'style':'thick','color':{'rgb':_0xb01ef(0x1ce)}},'bottom':{'style':_0xb01ef(0x15c),'color':{'rgb':_0xb01ef(0x1ce)}},'left':{'style':_0xb01ef(0x15c),'color':{'rgb':_0xb01ef(0x1ce)}},'right':{'style':_0xb01ef(0x15c),'color':{'rgb':_0xb01ef(0x1ce)}}};if(_0x31df14){const _0x3f291c=_0x31df14[_0xb01ef(0xca)](';')[_0xb01ef(0x116)]((_0x5699a6,_0x450035)=>{const _0x1f5504=_0xb01ef,[_0x4c1502,_0x4b9be5]=_0x450035[_0x1f5504(0xca)](':')[_0x1f5504(0x142)](_0x554bf8=>_0x554bf8[_0x1f5504(0x16f)]());return _0x5699a6[_0x4c1502]=_0x4b9be5,_0x5699a6;},{});_0x3f291c[_0xb01ef(0x100)]&&(_0x22bf20['top'][_0xb01ef(0x1cd)]=_0x3f291c[_0xb01ef(0x100)][_0xb01ef(0x201)](_0xb01ef(0x110))?_0xb01ef(0x110):_0xb01ef(0x1b7)),_0x3f291c[_0xb01ef(0x137)]&&(_0x22bf20[_0xb01ef(0x1b9)][_0xb01ef(0x1cd)]=_0x3f291c[_0xb01ef(0x137)]['includes']('thin')?_0xb01ef(0x110):_0xb01ef(0x1b7)),_0x3f291c[_0xb01ef(0xae)]&&(_0x22bf20['left']['style']=_0x3f291c[_0xb01ef(0xae)][_0xb01ef(0x201)](_0xb01ef(0x110))?'thin':'medium'),_0x3f291c[_0xb01ef(0xb2)]&&(_0x22bf20[_0xb01ef(0x1ee)][_0xb01ef(0x1cd)]=_0x3f291c[_0xb01ef(0xb2)][_0xb01ef(0x201)]('thin')?'thin':_0xb01ef(0x1b7));}return _0x22bf20;};_0x87b80c('table\x20tr')[_0x23677d(0x1f0)]((_0x2755d5,_0x3c890e)=>{const _0x51ee3d=_0x23677d;let _0x22d3f4=[],_0x3ad476=0x0;while(_0x2d1d0e[_0x3ad476]){_0x2d1d0e[_0x3ad476]--,_0x3ad476++;}_0x87b80c(_0x3c890e)[_0x51ee3d(0x7a)](_0x51ee3d(0x10c))[_0x51ee3d(0x1f0)]((_0x57b213,_0xd847a)=>{const _0x33ece5=_0x51ee3d;let _0x1145bf=_0x87b80c(_0xd847a)[_0x33ece5(0x15d)]()['trim'](),_0x536785=parseFloat(_0x1145bf['replace'](/,/g,'')),_0x32f3ad={};!isNaN(_0x536785)?(_0x32f3ad['v']=_0x536785,_0x32f3ad['t']='n'):(_0x32f3ad['v']=_0x1145bf,_0x32f3ad['t']='s');const _0x406c95=_0x87b80c(_0xd847a)[_0x33ece5(0x1e1)](_0x33ece5(0x1cd)),_0x2f0224=_0x5193d7(_0x406c95);_0x32f3ad['s']={'border':_0x2f0224},_0x22d3f4[_0x3ad476]=_0x32f3ad;let _0x57ac68=parseInt(_0x87b80c(_0xd847a)[_0x33ece5(0x1e1)](_0x33ece5(0x1a4)))||0x1,_0x507dae=parseInt(_0x87b80c(_0xd847a)[_0x33ece5(0x1e1)]('rowspan'))||0x1;(_0x57ac68>0x1||_0x507dae>0x1)&&_0x3707a9[_0x33ece5(0x199)]({'s':{'r':_0x2755d5,'c':_0x3ad476},'e':{'r':_0x2755d5+_0x507dae-0x1,'c':_0x3ad476+_0x57ac68-0x1}});for(let _0x3244b0=0x0;_0x3244b0<_0x57ac68;_0x3244b0++){_0x507dae>0x1&&(_0x2d1d0e[_0x3ad476+_0x3244b0]=_0x507dae-0x1);}_0x3ad476+=_0x57ac68;}),_0x4e8874[_0x51ee3d(0x199)](_0x22d3f4);});const _0x56c37d=XLSX[_0x23677d(0x1b6)]['book_new'](),_0x101159=XLSX[_0x23677d(0x1b6)][_0x23677d(0x1a5)](_0x4e8874);_0x3707a9[_0x23677d(0xb7)]>0x0&&(_0x101159[_0x23677d(0x1dd)]=_0x3707a9);_0x101159[_0x23677d(0x19a)]=_0x4e8874[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x23677d(0x1b6)][_0x23677d(0x1ab)](_0x56c37d,_0x101159,_0x23677d(0xc3));const _0xe1f38c=XLSX['write'](_0x56c37d,{'bookType':_0x23677d(0x14b),'type':'buffer'});_0x48bd98[_0x23677d(0x140)](_0x23677d(0xcc),_0x23677d(0xd3)),_0x48bd98['setHeader'](_0x23677d(0x1be),_0x23677d(0x11d)),_0x48bd98[_0x23677d(0x182)](_0xe1f38c);}else pdf[_0x23677d(0xd4)](_0x504dbe,_0x20844a)[_0x23677d(0x1c6)](function(_0x1c7bcf,_0x2c854e){const _0x395a59=_0x23677d;if(_0x1c7bcf){console[_0x395a59(0xc1)](_0x395a59(0x156),_0x1c7bcf),_0x48bd98[_0x395a59(0x1eb)](0x1f4)[_0x395a59(0x182)](_0x395a59(0x15e)+_0x1c7bcf);return;}_0x48bd98[_0x395a59(0x140)](_0x395a59(0x1be),_0x395a59(0x1f3)),_0x2c854e[_0x395a59(0x134)](_0x48bd98);});}),router[a0_0x5cb102(0x1e8)](a0_0x5cb102(0x124),auth,async(_0x5e1e79,_0x24f8e3)=>{const _0x2c1fbe=a0_0x5cb102;try{const {username:_0x168bf4,email:_0x51e640,role:_0x5b6acb}=_0x5e1e79[_0x2c1fbe(0x132)],_0x55a569=_0x5e1e79['user'],_0x17471f=await profile[_0x2c1fbe(0x12d)]({'email':_0x55a569['email']}),_0xb2047={'year':_0x2c1fbe(0x1ae),'month':_0x2c1fbe(0xe2),'day':_0x2c1fbe(0x1ae)},_0x1aff86=await master_shop['find'](),_0x9b7c14=await product[_0x2c1fbe(0x7a)](),_0x4b2a7d=await warehouse['aggregate']([{'$unwind':_0x2c1fbe(0x10a)},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':_0x2c1fbe(0xa4),'as':_0x2c1fbe(0x1c3)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x2c1fbe(0x1e7),'product_stock':_0x2c1fbe(0xc2)}},{'$group':{'_id':_0x2c1fbe(0x13c),'product_stock':{'$sum':'$product_stock'}}}]),_0x1d5edf=await staff[_0x2c1fbe(0x12d)]({'email':_0x55a569[_0x2c1fbe(0x186)]});if(_0x1aff86[0x0]['language']==_0x2c1fbe(0x87))var _0x29d793=users[_0x2c1fbe(0x14d)];else{if(_0x1aff86[0x0][_0x2c1fbe(0x1f8)]==_0x2c1fbe(0x7f))var _0x29d793=users[_0x2c1fbe(0x7f)];else{if(_0x1aff86[0x0][_0x2c1fbe(0x1f8)]==_0x2c1fbe(0x13a))var _0x29d793=users[_0x2c1fbe(0x13a)];else{if(_0x1aff86[0x0][_0x2c1fbe(0x1f8)]=='Spanish')var _0x29d793=users['Spanish'];else{if(_0x1aff86[0x0][_0x2c1fbe(0x1f8)]=='French')var _0x29d793=users[_0x2c1fbe(0xf9)];else{if(_0x1aff86[0x0]['language']==_0x2c1fbe(0x1ea))var _0x29d793=users[_0x2c1fbe(0x178)];else{if(_0x1aff86[0x0][_0x2c1fbe(0x1f8)]=='Chinese')var _0x29d793=users['Chinese'];else{if(_0x1aff86[0x0][_0x2c1fbe(0x1f8)]==_0x2c1fbe(0x128))var _0x29d793=users['Arabic'];}}}}}}}_0x24f8e3[_0x2c1fbe(0x1d0)](_0x2c1fbe(0x101),{'success':_0x5e1e79['flash']('success'),'errors':_0x5e1e79['flash'](_0x2c1fbe(0x118)),'alldata':_0x9b7c14,'profile':_0x17471f,'master_shop':_0x1aff86,'role':_0x55a569,'product_stock':_0x4b2a7d,'language':_0x29d793,'staff_arr':_0x1d5edf});}catch(_0xb1a22d){}});async function dataSalesReports(_0x173940,_0x6c680f,_0x3293ed){const _0x144781=a0_0x5cb102;let _0x2b50f3='';const _0x5333c9=await sales_sa[_0x144781(0x141)]([{'$match':{'date':{'$gte':_0x173940,'$lte':_0x6c680f},'sales_staff_id':_0x3293ed}},{'$unwind':_0x144781(0x1bb)},{'$match':{'sale_product.isFG':_0x144781(0xb1)}},{'$group':{'_id':{'product_name':_0x144781(0x119),'product_code':_0x144781(0x126)},'sumqty':{'$sum':_0x144781(0x77)},'totalPrice':{'$sum':_0x144781(0x18b)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x27d50b=0x0,_0x45e228=0x0;for(let _0x28dc53=0x0;_0x28dc53<=_0x5333c9['length']-0x1;_0x28dc53++){const _0x51166b=_0x5333c9[_0x28dc53];var _0x34cfa1=_0x51166b['totalPrice'][_0x144781(0xdd)](undefined),_0x5d72ab=_0x51166b[_0x144781(0x7d)][_0x144781(0xdd)](undefined);_0x2b50f3+='<tr>',_0x2b50f3+='<td\x20class=\x22row_data\x22>'+_0x51166b[_0x144781(0xa5)][_0x144781(0x1e3)]+'</td>',_0x2b50f3+=_0x144781(0x17a)+_0x51166b[_0x144781(0xa5)][_0x144781(0x1a9)]+'</td>',_0x2b50f3+=_0x144781(0x17a)+formatNumber(_0x51166b[_0x144781(0x7d)][_0x144781(0x1b1)](0x2))+_0x144781(0x143),_0x2b50f3+=_0x144781(0x17a)+formatNumber(_0x51166b[_0x144781(0x75)][_0x144781(0x1b1)](0x2))+'</td>',_0x2b50f3+=_0x144781(0xcd),_0x27d50b+=parseFloat(_0x51166b['sumqty']),_0x45e228+=parseFloat(_0x51166b['totalPrice']);}var _0x5e8199=_0x45e228['toLocaleString'](undefined),_0x5881f9=_0x27d50b[_0x144781(0xdd)](undefined);return _0x2b50f3+=_0x144781(0xb8),_0x2b50f3+='<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>',_0x2b50f3+=_0x144781(0xab)+formatNumber(_0x27d50b[_0x144781(0x1b1)](0x2))+_0x144781(0x1a3),_0x2b50f3+=_0x144781(0xab)+formatNumber(_0x45e228[_0x144781(0x1b1)](0x2))+_0x144781(0x1a3),_0x2b50f3+=_0x144781(0xcd),_0x2b50f3;}router[a0_0x5cb102(0x195)](a0_0x5cb102(0x1bf),auth,async(_0x296a16,_0x5df318)=>{const _0x1eea3a=a0_0x5cb102;try{const {from_date:_0x30617b,to_date:_0x16fe71,isExcel:_0x155f53}=_0x296a16[_0x1eea3a(0x17d)],_0x19e9d2=_0x296a16[_0x1eea3a(0x132)],_0x2fd97e=await staff[_0x1eea3a(0x12d)]({'email':_0x19e9d2[_0x1eea3a(0x186)]});let _0x4b903a=_0x1eea3a(0x177);var _0x3402fe=new Date(_0x30617b),_0x30731f=new Date(_0x16fe71);const _0x1a6619={'year':_0x1eea3a(0x1ae),'month':_0x1eea3a(0xe2),'day':_0x1eea3a(0x1ae)},_0x36a54f=new Intl[(_0x1eea3a(0xcb))]('en-US',_0x1a6619)[_0x1eea3a(0x1e4)](_0x3402fe),_0x495275=new Intl[(_0x1eea3a(0xcb))]('en-US',_0x1a6619)[_0x1eea3a(0x1e4)](_0x30731f);var _0x522245=await dataSalesReports(_0x30617b,_0x16fe71,_0x2fd97e['_id'][_0x1eea3a(0xc7)]());_0x4b903a+=_0x1eea3a(0x18a),_0x4b903a+=_0x1eea3a(0xb5),_0x4b903a+=_0x1eea3a(0x149),_0x4b903a+=_0x1eea3a(0xb8),_0x4b903a+=_0x1eea3a(0x1a1),_0x4b903a+=_0x1eea3a(0xf8),_0x4b903a+=_0x1eea3a(0x1c8),_0x4b903a+=_0x1eea3a(0xfb),_0x4b903a+=_0x1eea3a(0xb8),_0x4b903a+=_0x522245,_0x4b903a+=_0x1eea3a(0xcd),_0x4b903a+='</div>',_0x4b903a+=_0x1eea3a(0x111);let _0x469bb0='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x257bc3={'width':_0x1eea3a(0xe3),'height':'8.5in','orientation':_0x1eea3a(0x14a),'border':{'top':_0x1eea3a(0x1f6),'right':'0.1in','bottom':'0.1in','left':_0x1eea3a(0x1f6)},'header':{'height':_0x1eea3a(0xda),'contents':_0x1eea3a(0x1ec)+_0x469bb0+_0x1eea3a(0x11c)+_0x2fd97e[_0x1eea3a(0xa4)]+_0x1eea3a(0x1f7)+_0x36a54f+_0x1eea3a(0x17e)+_0x495275+_0x1eea3a(0x8a)},'footer':{'height':_0x1eea3a(0xf6),'contents':{'default':_0x1eea3a(0x14e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x155f53=='on'){const _0x30fac7=cheerio['load'](_0x4b903a);let _0x114c64=[],_0xfdc559=[],_0x52d5c3=[];const _0x382747=_0x14a8b4=>{const _0xcc5a3=_0x1eea3a,_0x6031c3={'top':{'style':_0xcc5a3(0x15c),'color':{'rgb':_0xcc5a3(0x1ce)}},'bottom':{'style':_0xcc5a3(0x15c),'color':{'rgb':_0xcc5a3(0x1ce)}},'left':{'style':_0xcc5a3(0x15c),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0xcc5a3(0x1ce)}}};if(_0x14a8b4){const _0x2c1b74=_0x14a8b4[_0xcc5a3(0xca)](';')[_0xcc5a3(0x116)]((_0x3579d8,_0x3c2131)=>{const _0x3b79ac=_0xcc5a3,[_0x50b007,_0x3becaf]=_0x3c2131['split'](':')['map'](_0x50c8ec=>_0x50c8ec[_0x3b79ac(0x16f)]());return _0x3579d8[_0x50b007]=_0x3becaf,_0x3579d8;},{});_0x2c1b74['border-top']&&(_0x6031c3[_0xcc5a3(0xea)]['style']=_0x2c1b74[_0xcc5a3(0x100)][_0xcc5a3(0x201)](_0xcc5a3(0x110))?'thin':_0xcc5a3(0x1b7)),_0x2c1b74[_0xcc5a3(0x137)]&&(_0x6031c3[_0xcc5a3(0x1b9)][_0xcc5a3(0x1cd)]=_0x2c1b74[_0xcc5a3(0x137)]['includes']('thin')?_0xcc5a3(0x110):'medium'),_0x2c1b74[_0xcc5a3(0xae)]&&(_0x6031c3['left']['style']=_0x2c1b74[_0xcc5a3(0xae)][_0xcc5a3(0x201)](_0xcc5a3(0x110))?_0xcc5a3(0x110):_0xcc5a3(0x1b7)),_0x2c1b74[_0xcc5a3(0xb2)]&&(_0x6031c3[_0xcc5a3(0x1ee)][_0xcc5a3(0x1cd)]=_0x2c1b74['border-right'][_0xcc5a3(0x201)]('thin')?'thin':_0xcc5a3(0x1b7));}return _0x6031c3;};_0x30fac7(_0x1eea3a(0x1b2))['each']((_0x20694c,_0x8b941a)=>{const _0x3126c7=_0x1eea3a;let _0x272c2b=[],_0x45ea9a=0x0;while(_0x52d5c3[_0x45ea9a]){_0x52d5c3[_0x45ea9a]--,_0x45ea9a++;}_0x30fac7(_0x8b941a)[_0x3126c7(0x7a)]('td,\x20th')[_0x3126c7(0x1f0)]((_0x6646d6,_0x5681bd)=>{const _0xadd849=_0x3126c7;let _0x23d14f=_0x30fac7(_0x5681bd)['text']()[_0xadd849(0x16f)](),_0x46680b=parseFloat(_0x23d14f['replace'](/,/g,'')),_0x372779={};!isNaN(_0x46680b)?(_0x372779['v']=_0x46680b,_0x372779['t']='n'):(_0x372779['v']=_0x23d14f,_0x372779['t']='s');const _0x141288=_0x30fac7(_0x5681bd)[_0xadd849(0x1e1)](_0xadd849(0x1cd)),_0x4e54ac=_0x382747(_0x141288);_0x372779['s']={'border':_0x4e54ac},_0x272c2b[_0x45ea9a]=_0x372779;let _0x5b18be=parseInt(_0x30fac7(_0x5681bd)['attr'](_0xadd849(0x1a4)))||0x1,_0x3900c5=parseInt(_0x30fac7(_0x5681bd)[_0xadd849(0x1e1)](_0xadd849(0x1a2)))||0x1;(_0x5b18be>0x1||_0x3900c5>0x1)&&_0xfdc559[_0xadd849(0x199)]({'s':{'r':_0x20694c,'c':_0x45ea9a},'e':{'r':_0x20694c+_0x3900c5-0x1,'c':_0x45ea9a+_0x5b18be-0x1}});for(let _0x2940cd=0x0;_0x2940cd<_0x5b18be;_0x2940cd++){_0x3900c5>0x1&&(_0x52d5c3[_0x45ea9a+_0x2940cd]=_0x3900c5-0x1);}_0x45ea9a+=_0x5b18be;}),_0x114c64['push'](_0x272c2b);});const _0x9b5aa8=XLSX[_0x1eea3a(0x1b6)][_0x1eea3a(0x144)](),_0x2628d4=XLSX[_0x1eea3a(0x1b6)]['aoa_to_sheet'](_0x114c64);_0xfdc559[_0x1eea3a(0xb7)]>0x0&&(_0x2628d4['!merges']=_0xfdc559);_0x2628d4[_0x1eea3a(0x19a)]=_0x114c64[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x1eea3a(0x1ab)](_0x9b5aa8,_0x2628d4,_0x1eea3a(0xc3));const _0x50403b=XLSX['write'](_0x9b5aa8,{'bookType':_0x1eea3a(0x14b),'type':'buffer'});_0x5df318[_0x1eea3a(0x140)](_0x1eea3a(0xcc),_0x1eea3a(0xd3)),_0x5df318[_0x1eea3a(0x140)]('Content-Type',_0x1eea3a(0x11d)),_0x5df318[_0x1eea3a(0x182)](_0x50403b);}else pdf[_0x1eea3a(0xd4)](_0x4b903a,_0x257bc3)[_0x1eea3a(0x1c6)](function(_0x159c34,_0x425cf5){const _0x3435c3=_0x1eea3a;if(_0x159c34){_0x5df318[_0x3435c3(0x1eb)](0x1f4)['send'](_0x3435c3(0x15e));return;}_0x5df318[_0x3435c3(0x140)](_0x3435c3(0x1be),_0x3435c3(0x1f3)),_0x425cf5[_0x3435c3(0x134)](_0x5df318);});}catch(_0x927115){}}),router['get'](a0_0x5cb102(0xfc),auth,async(_0x1baf6d,_0x2c8505)=>{const _0x26e20e=a0_0x5cb102;try{const {username:_0x555d9f,email:_0x25f38c,role:_0x54bef4}=_0x1baf6d['user'],_0x4e9128=_0x1baf6d['user'],_0x808c78=await profile[_0x26e20e(0x12d)]({'email':_0x4e9128[_0x26e20e(0x186)]}),_0x2c14d1={'year':_0x26e20e(0x1ae),'month':'long','day':_0x26e20e(0x1ae)},_0x39bd03=await master_shop[_0x26e20e(0x7a)](),_0x3ab2c1=await product[_0x26e20e(0x7a)](),_0x2e1649=await warehouse[_0x26e20e(0x141)]([{'$unwind':_0x26e20e(0x10a)},{'$lookup':{'from':'products','localField':_0x26e20e(0xf7),'foreignField':_0x26e20e(0xa4),'as':_0x26e20e(0x1c3)}},{'$unwind':_0x26e20e(0x1b4)},{'$project':{'product_name':_0x26e20e(0x1e7),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x26e20e(0x13c),'product_stock':{'$sum':_0x26e20e(0x109)}}}]);if(_0x39bd03[0x0]['language']=='English\x20(US)')var _0x507845=users['English'];else{if(_0x39bd03[0x0][_0x26e20e(0x1f8)]==_0x26e20e(0x7f))var _0x507845=users['Hindi'];else{if(_0x39bd03[0x0]['language']=='German')var _0x507845=users[_0x26e20e(0x13a)];else{if(_0x39bd03[0x0][_0x26e20e(0x1f8)]=='Spanish')var _0x507845=users[_0x26e20e(0x1e6)];else{if(_0x39bd03[0x0][_0x26e20e(0x1f8)]==_0x26e20e(0xf9))var _0x507845=users[_0x26e20e(0xf9)];else{if(_0x39bd03[0x0][_0x26e20e(0x1f8)]==_0x26e20e(0x1ea))var _0x507845=users[_0x26e20e(0x178)];else{if(_0x39bd03[0x0][_0x26e20e(0x1f8)]==_0x26e20e(0xcf))var _0x507845=users[_0x26e20e(0xcf)];else{if(_0x39bd03[0x0][_0x26e20e(0x1f8)]==_0x26e20e(0x128))var _0x507845=users[_0x26e20e(0xbc)];}}}}}}}_0x2c8505[_0x26e20e(0x1d0)](_0x26e20e(0x10b),{'success':_0x1baf6d[_0x26e20e(0x17f)](_0x26e20e(0x171)),'errors':_0x1baf6d[_0x26e20e(0x17f)]('errors'),'alldata':_0x3ab2c1,'profile':_0x808c78,'master_shop':_0x39bd03,'role':_0x4e9128,'product_stock':_0x2e1649,'language':_0x507845});}catch(_0x736643){}});async function dataInventoryReports(_0x379a6a,_0x42dad5,_0x5dd446){const _0x315df7=a0_0x5cb102,_0x472a3e=await sales_sa[_0x315df7(0x141)]([{'$match':{'date':{'$gte':_0x379a6a,'$lte':_0x42dad5},'sales_staff_id':_0x5dd446}},{'$unwind':_0x315df7(0x1bb)},{'$group':{'_id':{'product_name':_0x315df7(0x119),'product_code':_0x315df7(0x126)},'sumqty':{'$sum':_0x315df7(0x13f)}}},{'$sort':{'_id.product_name':0x1}}]),_0x402f1d=mongoose[_0x315df7(0x185)][_0x315df7(0xb4)],_0x467fcc=await staff[_0x315df7(0x141)]([{'$match':{'_id':_0x402f1d(_0x5dd446)}},{'$unwind':_0x315df7(0x1d6)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x315df7(0x1d3),'product_code':_0x315df7(0x1cc)},'sumqty':{'$sum':_0x315df7(0xaf)}}},{'$sort':{'_id.product_name':0x1}}]),_0x546fa8=await sales_inv_data[_0x315df7(0x141)]([{'$match':{'date':{'$gte':_0x379a6a,'$lte':_0x42dad5},'sales_staff_id':_0x5dd446}},{'$unwind':_0x315df7(0x1bb)},{'$group':{'_id':{'product_name':_0x315df7(0x119),'product_code':'$sale_product.product_code'},'totalQTYsum':{'$sum':_0x315df7(0x19b)}}}]);console[_0x315df7(0x153)](_0x546fa8);let _0x3782e4='';var _0x13a457=0x0;for(let _0x1a6be6=0x0;_0x1a6be6<=_0x467fcc[_0x315df7(0xb7)]-0x1;_0x1a6be6++){const _0x55d9db=_0x467fcc[_0x1a6be6];_0x3782e4+='<tr>',_0x3782e4+=_0x315df7(0x12f)+_0x55d9db[_0x315df7(0xa5)]['product_code']+_0x315df7(0x143),_0x3782e4+=_0x315df7(0x1fb)+_0x55d9db[_0x315df7(0xa5)][_0x315df7(0x1a9)]+'</td>';var _0x30ec8c=_0x55d9db[_0x315df7(0x7d)],_0x2d23d6=0x0;for(let _0x5b58a3=0x0;_0x5b58a3<=_0x472a3e[_0x315df7(0xb7)]-0x1;_0x5b58a3++){const _0x33fdc1=_0x472a3e[_0x5b58a3];_0x55d9db[_0x315df7(0xa5)][_0x315df7(0x1e3)]==_0x33fdc1[_0x315df7(0xa5)]['product_code']&&_0x55d9db[_0x315df7(0xa5)][_0x315df7(0x1a9)]==_0x33fdc1[_0x315df7(0xa5)][_0x315df7(0x1a9)]&&(_0x2d23d6=_0x33fdc1[_0x315df7(0x7d)]);}var _0x236a45=0x0;for(let _0x9e403e=0x0;_0x9e403e<=_0x546fa8[_0x315df7(0xb7)]-0x1;_0x9e403e++){const _0x124f8b=_0x546fa8[_0x9e403e];_0x55d9db[_0x315df7(0xa5)]['product_code']==_0x124f8b[_0x315df7(0xa5)][_0x315df7(0x1e3)]&&_0x55d9db[_0x315df7(0xa5)]['product_name']==_0x124f8b['_id'][_0x315df7(0x1a9)]&&(_0x236a45=_0x124f8b[_0x315df7(0x138)]);}_0x13a457=_0x30ec8c-_0x236a45+_0x2d23d6,_0x3782e4+=_0x315df7(0x17a)+_0x13a457+_0x315df7(0x143);let _0x10ed2f=![];for(let _0x4526ac=0x0;_0x4526ac<=_0x546fa8[_0x315df7(0xb7)]-0x1;_0x4526ac++){const _0x842aa=_0x546fa8[_0x4526ac];if(_0x55d9db[_0x315df7(0xa5)][_0x315df7(0x1e3)]==_0x842aa[_0x315df7(0xa5)][_0x315df7(0x1e3)]&&_0x55d9db[_0x315df7(0xa5)][_0x315df7(0x1a9)]==_0x842aa[_0x315df7(0xa5)]['product_name']){_0x3782e4+=_0x315df7(0x17a)+_0x842aa['totalQTYsum']+_0x315df7(0x143),_0x10ed2f=!![];break;}}!_0x10ed2f&&(_0x3782e4+=_0x315df7(0xc0));let _0x3e6dff=![];for(let _0x24b91b=0x0;_0x24b91b<=_0x472a3e[_0x315df7(0xb7)]-0x1;_0x24b91b++){const _0x286066=_0x472a3e[_0x24b91b];if(_0x55d9db[_0x315df7(0xa5)][_0x315df7(0x1e3)]==_0x286066[_0x315df7(0xa5)][_0x315df7(0x1e3)]&&_0x55d9db[_0x315df7(0xa5)][_0x315df7(0x1a9)]==_0x286066['_id']['product_name']){_0x3782e4+=_0x315df7(0x17a)+_0x286066['sumqty']+_0x315df7(0x143),_0x3e6dff=!![];break;}}!_0x3e6dff&&(_0x3782e4+='<td\x20class=\x22row_data\x22>0</td>'),_0x3782e4+=_0x315df7(0x17a)+_0x55d9db['sumqty']+_0x315df7(0x143),_0x3782e4+='</tr>';}return _0x3782e4;}router[a0_0x5cb102(0x195)](a0_0x5cb102(0x1fd),auth,async(_0xca6787,_0x3d47ed)=>{const _0x622eea=a0_0x5cb102;try{const {from_date:_0x25d7bf,to_date:_0x4c4d36}=_0xca6787[_0x622eea(0x17d)],_0x413793=_0xca6787[_0x622eea(0x132)],_0x21f5d8=await staff[_0x622eea(0x12d)]({'email':_0x413793[_0x622eea(0x186)]});let _0x3494d0=_0x622eea(0x177);var _0x2ccb32=new Date(_0x25d7bf),_0x31b427=new Date(_0x4c4d36);const _0x5ba3bb={'year':_0x622eea(0x1ae),'month':'long','day':_0x622eea(0x1ae)},_0x458d0e=new Intl['DateTimeFormat']('en-US',_0x5ba3bb)['format'](_0x2ccb32),_0x564694=new Intl[(_0x622eea(0xcb))]('en-US',_0x5ba3bb)[_0x622eea(0x1e4)](_0x31b427);var _0x296512=await dataInventoryReports(_0x25d7bf,_0x4c4d36,_0x21f5d8[_0x622eea(0xa5)][_0x622eea(0xc7)]());_0x3494d0+=_0x622eea(0x80),_0x3494d0+=_0x622eea(0x160),_0x3494d0+=_0x622eea(0x159)+_0x458d0e+'\x20-\x20'+_0x564694+_0x622eea(0x136),_0x3494d0+=_0x622eea(0x18a),_0x3494d0+='<div\x20class=\x22col-sm-11\x22>',_0x3494d0+='<table>',_0x3494d0+=_0x622eea(0xb8),_0x3494d0+=_0x622eea(0x1a1),_0x3494d0+=_0x622eea(0xf8),_0x3494d0+=_0x622eea(0xa3),_0x3494d0+='<th>\x20INCOMING\x20</th>',_0x3494d0+=_0x622eea(0x117),_0x3494d0+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x3494d0+='<tr>',_0x3494d0+=_0x296512,_0x3494d0+=_0x622eea(0xcd),_0x3494d0+=_0x622eea(0x111),_0x3494d0+=_0x622eea(0x111);const _0x59b87d={'format':_0x622eea(0x84),'orientation':_0x622eea(0x14a),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x622eea(0xa0)}}};pdf['create'](_0x3494d0,_0x59b87d)[_0x622eea(0x1c6)](function(_0x5a3cb3,_0x2fb732){const _0xc15d22=_0x622eea;if(_0x5a3cb3){_0x3d47ed[_0xc15d22(0x1eb)](0x1f4)[_0xc15d22(0x182)](_0xc15d22(0x15e));return;}_0x3d47ed[_0xc15d22(0x140)]('Content-Type',_0xc15d22(0x1f3)),_0x2fb732[_0xc15d22(0x134)](_0x3d47ed);});}catch(_0x1181b2){}}),router[a0_0x5cb102(0x1e8)](a0_0x5cb102(0xf2),auth,async(_0xf4b129,_0x437661)=>{const _0x2df80b=a0_0x5cb102;try{const {username:_0x1396a7,email:_0x278616,role:_0x41274e}=_0xf4b129[_0x2df80b(0x132)],_0x1e8df0=_0xf4b129[_0x2df80b(0x132)],_0x19b1d6=await profile['findOne']({'email':_0x1e8df0['email']}),_0x176e7e={'year':_0x2df80b(0x1ae),'month':_0x2df80b(0xe2),'day':'numeric'},_0x1f2c67=await master_shop[_0x2df80b(0x7a)]();console['log'](_0x2df80b(0x1e5),_0x1f2c67);const _0x3e118d=await product[_0x2df80b(0x7a)]();console[_0x2df80b(0x153)](_0x2df80b(0x1df),_0x3e118d);const _0x24d86f=await warehouse[_0x2df80b(0x141)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x2df80b(0x1f5),'localField':_0x2df80b(0xf7),'foreignField':_0x2df80b(0xa4),'as':'product_docs'}},{'$unwind':_0x2df80b(0x1b4)},{'$project':{'product_name':_0x2df80b(0x1e7),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x2df80b(0x13c),'product_stock':{'$sum':_0x2df80b(0x109)}}}]);console[_0x2df80b(0x153)](_0x2df80b(0x1e0),_0x24d86f),_0x24d86f['forEach'](_0x2a5375=>{const _0x176b73=_0x3e118d['map'](_0x317026=>{const _0x4642fa=a0_0x1f28;_0x317026['name']==_0x2a5375[_0x4642fa(0xa5)]&&(_0x317026['stock']=parseInt(_0x317026[_0x4642fa(0xa1)])+parseInt(_0x2a5375[_0x4642fa(0x103)]));});});const _0x3291d5=await staff['findOne']({'email':_0x1e8df0['email']});if(_0x1f2c67[0x0][_0x2df80b(0x1f8)]==_0x2df80b(0x87))var _0x395371=users[_0x2df80b(0x14d)];else{if(_0x1f2c67[0x0][_0x2df80b(0x1f8)]=='Hindi')var _0x395371=users[_0x2df80b(0x7f)];else{if(_0x1f2c67[0x0][_0x2df80b(0x1f8)]==_0x2df80b(0x13a))var _0x395371=users['German'];else{if(_0x1f2c67[0x0]['language']==_0x2df80b(0x1e6))var _0x395371=users[_0x2df80b(0x1e6)];else{if(_0x1f2c67[0x0]['language']==_0x2df80b(0xf9))var _0x395371=users[_0x2df80b(0xf9)];else{if(_0x1f2c67[0x0]['language']=='Portuguese\x20(BR)')var _0x395371=users['Portuguese'];else{if(_0x1f2c67[0x0][_0x2df80b(0x1f8)]==_0x2df80b(0xcf))var _0x395371=users['Chinese'];else{if(_0x1f2c67[0x0]['language']==_0x2df80b(0x128))var _0x395371=users[_0x2df80b(0xbc)];}}}}}}}_0x437661['render']('dssr_view',{'success':_0xf4b129[_0x2df80b(0x17f)](_0x2df80b(0x171)),'errors':_0xf4b129[_0x2df80b(0x17f)](_0x2df80b(0x118)),'alldata':_0x3e118d,'profile':_0x19b1d6,'master_shop':_0x1f2c67,'role':_0x1e8df0,'product_stock':_0x24d86f,'language':_0x395371,'staff_arr':_0x3291d5});}catch(_0x3987ad){}});async function agentsdataDSICheck_DSRR(_0x77f91f,_0x4744bf,_0x2e2d57,_0x3a8b69){const _0x439959=a0_0x5cb102;let _0x4c3499=new Date(_0x77f91f);_0x4c3499[_0x439959(0xe9)](_0x4c3499[_0x439959(0x1cf)]()-0x1);let _0x59257e=_0x4c3499[_0x439959(0x99)]()[_0x439959(0xca)]('T')[0x0];const _0x9faa2d=await product[_0x439959(0x141)]([{'$group':{'_id':{'brand':_0x439959(0xd9),'category':_0x439959(0x151)},'products':{'$push':{'name':_0x439959(0x152),'product_code':_0x439959(0x1d1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x47c402=[];_0x47c402[_0x439959(0x189)]=[];for(let _0x22bca3=0x0;_0x22bca3<=_0x9faa2d[_0x439959(0xb7)]-0x1;_0x22bca3++){const _0x1ada4f=_0x9faa2d[_0x22bca3];_0x47c402[_0x439959(0x189)]['push'](_0x1ada4f);}const _0x476756=await product[_0x439959(0x141)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x439959(0xd9),'product_code':_0x439959(0x1d1),'product_name':_0x439959(0x152)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3c8b7b=await product[_0x439959(0x141)]([{'$group':{'_id':{'category':_0x439959(0x151),'brand':_0x439959(0xd9)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x32eaae=await sales_sa[_0x439959(0x141)]([{'$match':{'date':_0x77f91f,'sales_staff_id':_0x4744bf,'sale_product.isFG':_0x439959(0xb1)}},{'$unwind':_0x439959(0x1bb)},{'$lookup':{'from':_0x439959(0x1f5),'localField':'sale_product.product_code','foreignField':_0x439959(0x1e3),'as':_0x439959(0x174)}},{'$unwind':_0x439959(0x121)},{'$group':{'_id':{'dsi':_0x439959(0xe1),'date':'$date','customer':_0x439959(0x203),'status_data':_0x439959(0x97)},'totalQty':{'$sum':_0x439959(0x77)},'cash':{'$first':_0x439959(0x127)},'amount':{'$first':_0x439959(0xc9)},'bank':{'$first':_0x439959(0x129)},'check_no':{'$first':_0x439959(0x1de)},'due_date':{'$first':_0x439959(0xa9)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x439959(0x18b),'discount':'$sale_product.discount','adj_discount':_0x439959(0xce),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x439959(0x93),'brand':_0x439959(0xe7),'gross_price':_0x439959(0x94),'isFG':_0x439959(0xff),'prod_cat':'$sale_product.prod_cat','prod_id':_0x439959(0xec)}}}}},{'$unwind':_0x439959(0x1ca)},{'$group':{'_id':{'dsi':_0x439959(0x11a),'date':_0x439959(0x78),'customer':_0x439959(0xee),'status_data':'$_id.status_data','category':'$products.product_details.category','brand':_0x439959(0x192),'prod_id':_0x439959(0x14c)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x439959(0x188),_0x439959(0x19d)]}},'NetPrice':{'$sum':_0x439959(0xdc)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x439959(0x187)},'cash':{'$first':'$cash'},'amount':{'$first':_0x439959(0xc9)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x439959(0xa9)},'product_details':{'$first':_0x439959(0x19f)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x439959(0x78),'customer':'$_id.customer','status_data':_0x439959(0xb9)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x439959(0x18c)},'adj_discount':{'$sum':_0x439959(0x146)},'cash':{'$first':_0x439959(0x127)},'amount':{'$first':_0x439959(0xc9)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x439959(0x1de)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x439959(0x173),'category':'$_id.category','brand':_0x439959(0x1ff),'product_details':_0x439959(0x10a)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x211a3d=await sales_sa['aggregate']([{'$match':{'date':_0x59257e,'sales_staff_id':_0x4744bf,'sale_product.isFG':_0x439959(0xb1)}},{'$unwind':_0x439959(0x1bb)},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':'product_code','as':_0x439959(0x174)}},{'$unwind':_0x439959(0x121)},{'$group':{'_id':{'dsi':_0x439959(0xe1),'date':_0x439959(0x16d),'customer':_0x439959(0x203)},'totalQty':{'$sum':_0x439959(0x77)},'cash':{'$first':_0x439959(0x127)},'amount':{'$first':_0x439959(0xc9)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x439959(0x1de)},'due_date':{'$first':_0x439959(0xa9)},'products':{'$push':{'qty':_0x439959(0x77),'NetPrice':_0x439959(0x18b),'discount':'$sale_product.discount','adj_discount':_0x439959(0xce),'product_details':{'prod_name':_0x439959(0x176),'product_code':_0x439959(0x1d8),'category':_0x439959(0x93),'brand':_0x439959(0xe7),'gross_price':_0x439959(0x94),'isFG':_0x439959(0xff),'prod_cat':_0x439959(0x200),'prod_id':'$sale_product._id'}}}}},{'$unwind':_0x439959(0x1ca)},{'$group':{'_id':{'dsi':_0x439959(0x11a),'date':_0x439959(0x78),'customer':_0x439959(0xee),'category':_0x439959(0x81),'brand':_0x439959(0x192),'prod_id':_0x439959(0x14c)},'totalQty':{'$sum':_0x439959(0x188)},'cash':{'$first':'$cash'},'amount':{'$first':_0x439959(0xc9)},'bank':{'$first':_0x439959(0x129)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x439959(0xa9)},'totalGross':{'$sum':{'$multiply':[_0x439959(0x188),_0x439959(0x19d)]}},'NetPrice':{'$sum':_0x439959(0xdc)},'discount':{'$sum':_0x439959(0xe5)},'adj_discount':{'$sum':_0x439959(0x187)},'product_details':{'$first':_0x439959(0x19f)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x439959(0x78),'customer':'$_id.customer'},'totalQty':{'$sum':_0x439959(0x173)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x439959(0x129)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x439959(0xa9)},'totalGross':{'$sum':_0x439959(0x168)},'NetPrice':{'$sum':_0x439959(0x83)},'discount':{'$sum':_0x439959(0x18c)},'adj_discount':{'$sum':_0x439959(0x146)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x439959(0x1ff),'product_details':_0x439959(0x10a)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x4b2bea=await sales_sa[_0x439959(0x141)]([{'$match':{'date':_0x77f91f,'sales_staff_id':_0x4744bf,'status_data':_0x439959(0x15b)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x2fb7a6=await staff['findById'](_0x4744bf);let _0x1b3053=[],_0x23ba4c={},_0x2ec680={};var _0x3e7cb5=0x0,_0x168b78=0x0,_0x2f4577=0x0,_0x3b8252=0x0,_0xb8703a=0x0;const _0x558e59=0x6;var _0xf27cb7=0x0,_0x5d8716=0x0;for(let _0x1a6837=0x0;_0x1a6837<=_0x32eaae[_0x439959(0xb7)]-0x1;_0x1a6837++){const _0x1d82d7=_0x32eaae[_0x1a6837];let _0x61f242=_0x439959(0xb8);_0x61f242+=_0x439959(0xf3),_0x61f242+=_0x439959(0xc5)+_0x1d82d7[_0x439959(0xa5)]['customer']+_0x439959(0x143),_0x61f242+=_0x439959(0xc5)+_0x1d82d7[_0x439959(0xa5)][_0x439959(0x10e)]+'</td>';let _0x361f90={},_0x46a014={},_0x37588a={};var _0x567b66={},_0x27a45b={},_0x133a7e={},_0x1e2a15=0x0;for(let _0x2436a1=0x0;_0x2436a1<=_0x1d82d7['products'][_0x439959(0xb7)]-0x1;_0x2436a1++){const _0x22c56c=_0x1d82d7[_0x439959(0x1f5)][_0x2436a1];_0x361f90[_0x22c56c[_0x439959(0xdb)]+'-'+_0x22c56c[_0x439959(0x1f4)]]=_0x22c56c['qty'],_0x46a014[[_0x22c56c['brand']+'-'+_0x22c56c[_0x439959(0x1f4)]]]=_0x22c56c[_0x439959(0xe0)]['isFG'],_0x37588a[[_0x22c56c['brand']+'-'+_0x22c56c[_0x439959(0x1f4)]]]=_0x22c56c[_0x439959(0xe0)][_0x439959(0x1d5)];const _0x3a7ca5=_0x22c56c[_0x439959(0xdb)]+'-'+_0x22c56c['category'];!Array['isArray'](_0x2ec680[_0x3a7ca5])&&(_0x2ec680[_0x3a7ca5]=[]);!Array['isArray'](_0x2ec680[_0x3a7ca5])&&(_0x2ec680[_0x3a7ca5]=[]);_0x2ec680[_0x3a7ca5]['push'](_0x22c56c['qty']);if(_0x22c56c[_0x439959(0xe0)][_0x439959(0x1d5)]=='P')_0x22c56c[_0x439959(0xe0)]['isFG']==_0x439959(0x15b)?(!_0x133a7e[_0x3a7ca5]&&(_0x133a7e[_0x3a7ca5]=0x0),_0x133a7e[_0x3a7ca5]=_0x22c56c[_0x439959(0x135)]):(!_0x567b66[_0x3a7ca5]&&(_0x567b66[_0x3a7ca5]=0x0),_0x567b66[_0x3a7ca5]=_0x22c56c[_0x439959(0x135)]);else _0x22c56c[_0x439959(0xe0)]['prod_cat']=='S'&&(_0x22c56c[_0x439959(0xe0)][_0x439959(0x13d)]=='true'?(!_0x133a7e[_0x3a7ca5]&&(_0x133a7e[_0x3a7ca5]=0x0),_0x133a7e[_0x3a7ca5]=_0x22c56c[_0x439959(0x135)]):(!_0x27a45b[_0x3a7ca5]&&(_0x27a45b[_0x3a7ca5]=0x0),_0x27a45b[_0x3a7ca5]=_0x22c56c[_0x439959(0x135)]));_0x1e2a15++;}for(let _0x2d97ce=0x0;_0x2d97ce<=_0x47c402['cat_brand'][_0x439959(0xb7)]-0x1;_0x2d97ce++){const _0x2e77bf=_0x47c402[_0x439959(0x189)][_0x2d97ce],_0x2545c8=_0x2e77bf[_0x439959(0xa5)][_0x439959(0xdb)]+'-'+_0x2e77bf[_0x439959(0xa5)][_0x439959(0x1f4)],_0x5b6e3f=_0x37588a[_0x2545c8]!==undefined?_0x37588a[_0x2545c8]:'NA';var _0x469ae3=_0x567b66[_0x2545c8]!==undefined?_0x567b66[_0x2545c8][_0x439959(0x1b1)](0x2):'',_0x44f726=_0x27a45b[_0x2545c8]!==undefined?_0x27a45b[_0x2545c8][_0x439959(0x1b1)](0x2):'',_0x1ffe58=_0x133a7e[_0x2545c8]!==undefined?_0x133a7e[_0x2545c8][_0x439959(0x1b1)](0x2):'';_0x61f242+=_0x439959(0x179)+_0x469ae3+_0x439959(0x143),_0x61f242+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x44f726+'</td>',_0x61f242+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x1ffe58+_0x439959(0x143);}var _0x480c6a=formatNumber(parseFloat(_0x1d82d7[_0x439959(0x1c2)])),_0x23d3c7=formatNumber(parseFloat(_0x1d82d7[_0x439959(0x1d4)]));isNaN(_0x23d3c7)&&(_0x23d3c7=0x0),_0x61f242+=_0x439959(0x179)+_0x480c6a+_0x439959(0x143),_0x61f242+=_0x439959(0x179)+_0x23d3c7+'</td>',_0x61f242+=_0x439959(0xc5)+_0x1d82d7[_0x439959(0x9d)]+'</td>',_0x61f242+=_0x439959(0xc5)+_0x1d82d7[_0x439959(0x96)]+_0x439959(0x143),_0x61f242+=_0x439959(0xc5)+_0x1d82d7[_0x439959(0x13e)]+_0x439959(0x143),_0x2f4577=_0x1d82d7[_0x439959(0x18e)]+_0x1d82d7[_0x439959(0x1d9)],_0xf27cb7+=parseFloat(_0x1d82d7['cash']),_0x5d8716+=parseFloat(_0x23d3c7),_0x1b3053[_0x439959(0x199)](_0x61f242);}if(_0x4b2bea[_0x439959(0xb7)]>0x0)for(let _0x3f2c89=0x0;_0x3f2c89<=_0x4b2bea[_0x439959(0xb7)]-0x1;_0x3f2c89++){const _0x1ce165=_0x4b2bea[_0x3f2c89];console['log'](_0x1ce165);let _0xd00ed6=_0x439959(0xb8);_0xd00ed6+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22'+(0x8+0x7*0x3)+_0x439959(0xf5)+_0x1ce165['note']+_0x439959(0x1a3),_0xd00ed6+=_0x439959(0xcd),_0x1b3053['push'](_0xd00ed6);}function _0x5595d6(_0x22037e,_0x40a071){const _0x52b3e2=_0x439959,_0x143428=[];for(let _0x2d1984=0x0;_0x2d1984<=_0x22037e[_0x52b3e2(0xb7)]-0x1;_0x2d1984+=_0x40a071){_0x143428['push'](_0x22037e['slice'](_0x2d1984,_0x2d1984+_0x40a071));}return _0x143428;}const _0x51f60b=_0x5595d6(_0x1b3053,_0x558e59);let _0x55e685='';return _0x51f60b[_0x439959(0x8b)]((_0xa7ab75,_0x1f9f80)=>{const _0x41731d=_0x439959;_0x1f9f80>0x0&&(_0x55e685+=_0x41731d(0x1fa));_0x55e685+=_0x41731d(0x149),_0x55e685+=_0x41731d(0x147);const _0x1c67e4=new Date(_0x77f91f),_0x3cec51={'year':_0x41731d(0x1ae),'month':'long','day':_0x41731d(0x1ae),'timeZone':_0x41731d(0x155)},_0x2a0bb6=_0x1c67e4['toLocaleDateString']('en-US',_0x3cec51);_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0x133)+_0x3a8b69+_0x41731d(0x1a3),_0x55e685+='</tr>',_0x55e685+='<tr>',_0x55e685+=_0x41731d(0x1e9)+_0x2fb7a6[_0x41731d(0xa4)]+_0x41731d(0x143),_0x55e685+=_0x41731d(0x204),_0x55e685+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x55e685+=_0x41731d(0x145),_0x55e685+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x55e685+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x55e685+=_0x41731d(0x112),_0x55e685+=_0x41731d(0x9a),_0x55e685+=_0x41731d(0x166),_0x55e685+=_0x41731d(0xcd),_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0x1ad),_0x55e685+=_0x41731d(0x86)+_0x2a0bb6+_0x41731d(0x143),_0x55e685+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>',_0x55e685+=_0x41731d(0xbb),_0x55e685+=_0x41731d(0x202),_0x55e685+=_0x41731d(0x202),_0x55e685+=_0x41731d(0xcd),_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0xb3),_0x55e685+=_0x41731d(0xd8),_0x55e685+=_0x41731d(0x12e),_0x55e685+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x55e685+=_0x41731d(0x202),_0x55e685+=_0x41731d(0xcd),_0x55e685+='<tr>',_0x55e685+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x55e685+=_0x41731d(0xcd),_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0xde),_0x55e685+='<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>',_0x55e685+=_0x41731d(0xcd),_0x55e685+=_0x41731d(0xb8),_0x55e685+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>',_0x55e685+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x55e685+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x38df0e=0x0;_0x38df0e<=_0x476756[_0x41731d(0xb7)]-0x1;_0x38df0e++){const _0x58f3ff=_0x476756[_0x38df0e];for(let _0x535cf4=0x0;_0x535cf4<_0x47c402[_0x41731d(0x189)][_0x41731d(0xb7)];_0x535cf4++){const _0x40177c=_0x47c402[_0x41731d(0x189)][_0x535cf4];if(_0x40177c[_0x41731d(0xa5)][_0x41731d(0x1f4)]===_0x58f3ff[_0x41731d(0xa5)][_0x41731d(0x1f4)]){var _0x540034='';switch(_0x58f3ff[_0x41731d(0xa5)][_0x41731d(0x1f4)]){case _0x41731d(0xd7):_0x540034=_0x40177c[_0x41731d(0xa5)][_0x41731d(0xdb)]+_0x41731d(0xd0);break;case _0x41731d(0xf4):_0x540034=_0x40177c[_0x41731d(0xa5)]['brand']+_0x41731d(0x1fe);break;default:_0x540034=_0x40177c[_0x41731d(0xa5)][_0x41731d(0xdb)];break;}_0x55e685+=_0x41731d(0xd2)+_0x540034+_0x41731d(0x1a3);}}}_0x55e685+=_0x41731d(0x1ac),_0x55e685+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>',_0x55e685+=_0x41731d(0x183),_0x55e685+=_0x41731d(0xcd),_0x55e685+=_0x41731d(0xb8),_0x55e685+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x14ab67=0x0;_0x14ab67<=_0x47c402['cat_brand'][_0x41731d(0xb7)]-0x1;_0x14ab67++){const _0x474d6c=_0x47c402[_0x14ab67];_0x55e685+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x55e685+=_0x41731d(0x1bc),_0x55e685+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x55e685+=_0x41731d(0x19c),_0x55e685+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>',_0x55e685+=_0x41731d(0xb0),_0x55e685+=_0x41731d(0xcd),_0x55e685+=_0x41731d(0x1a7),_0x55e685+='<tbody>',_0xa7ab75[_0x41731d(0x8b)](_0x11c02e=>{_0x55e685+=_0x11c02e;});let _0x5b9f78={},_0x22efab={},_0x265157={};for(let _0x3317d7=0x0;_0x3317d7<=_0x32eaae[_0x41731d(0xb7)]-0x1;_0x3317d7++){const _0x3fa0d5=_0x32eaae[_0x3317d7];var _0x395e9a=0x0;for(let _0x1188a3=0x0;_0x1188a3<=_0x3fa0d5[_0x41731d(0x1f5)][_0x41731d(0xb7)]-0x1;_0x1188a3++){const _0x48af92=_0x3fa0d5[_0x41731d(0x1f5)][_0x1188a3],_0x235590=_0x48af92['brand']+'-'+_0x48af92[_0x41731d(0x1f4)];if(_0x48af92['product_details'][_0x41731d(0x1d5)]=='P')_0x48af92[_0x41731d(0xe0)][_0x41731d(0x13d)]==_0x41731d(0x15b)?(!_0x265157[_0x235590]&&(_0x265157[_0x235590]=0x0),_0x265157[_0x235590]+=_0x48af92[_0x41731d(0x135)]):(!_0x5b9f78[_0x235590]&&(_0x5b9f78[_0x235590]=0x0),_0x5b9f78[_0x235590]+=_0x48af92[_0x41731d(0x135)]);else _0x48af92[_0x41731d(0xe0)][_0x41731d(0x1d5)]=='S'&&(_0x48af92[_0x41731d(0xe0)][_0x41731d(0x13d)]=='true'?(!_0x265157[_0x235590]&&(_0x265157[_0x235590]=0x0),_0x265157[_0x235590]+=_0x48af92[_0x41731d(0x135)],console['log'](_0x48af92[_0x41731d(0x135)])):(!_0x22efab[_0x235590]&&(_0x22efab[_0x235590]=0x0),_0x22efab[_0x235590]+=_0x48af92[_0x41731d(0x135)]));_0x395e9a++;}}let _0x21e5bb={},_0x4fce27={},_0x179169={};var _0x431103=0x0,_0x3e5bb6=0x0;for(let _0x31b717=0x0;_0x31b717<=_0x211a3d['length']-0x1;_0x31b717++){const _0x51aa43=_0x211a3d[_0x31b717];var _0x395e9a=0x0;for(let _0x47fd87=0x0;_0x47fd87<=_0x51aa43[_0x41731d(0x1f5)][_0x41731d(0xb7)]-0x1;_0x47fd87++){const _0xba641b=_0x51aa43['products'][_0x47fd87],_0x1344ac=_0xba641b['brand']+'-'+_0xba641b['category'];if(_0xba641b[_0x41731d(0xe0)][_0x41731d(0x1d5)]=='P')_0xba641b['product_details']['isFG']==_0x41731d(0x15b)?(!_0x179169[_0x1344ac]&&(_0x179169[_0x1344ac]=0x0),_0x179169[_0x1344ac]+=_0xba641b[_0x41731d(0x135)]):(!_0x21e5bb[_0x1344ac]&&(_0x21e5bb[_0x1344ac]=0x0),_0x21e5bb[_0x1344ac]+=_0xba641b[_0x41731d(0x135)]);else _0xba641b[_0x41731d(0xe0)]['prod_cat']=='S'&&(_0xba641b[_0x41731d(0xe0)][_0x41731d(0x13d)]==_0x41731d(0x15b)?(!_0x179169[_0x1344ac]&&(_0x179169[_0x1344ac]=0x0),_0x179169[_0x1344ac]+=_0xba641b['qty']):(!_0x4fce27[_0x1344ac]&&(_0x4fce27[_0x1344ac]=0x0),_0x4fce27[_0x1344ac]+=_0xba641b[_0x41731d(0x135)]));_0x395e9a++;}var _0x427ae4=parseFloat(_0x51aa43[_0x41731d(0x1c2)]),_0x4f0e0f=parseFloat(_0x51aa43['amount']);isNaN(_0x4f0e0f)&&(_0x4f0e0f=0x0),_0x431103+=_0x427ae4,_0x3e5bb6+=_0x4f0e0f;}_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0x1cb),_0x55e685+=_0x41731d(0x139),_0x55e685+=_0x41731d(0xf3);for(let _0x9d2432=0x0;_0x9d2432<=_0x47c402['cat_brand'][_0x41731d(0xb7)]-0x1;_0x9d2432++){const _0x3b690d=_0x47c402[_0x41731d(0x189)][_0x9d2432],_0x492330=_0x3b690d['_id']['brand']+'-'+_0x3b690d[_0x41731d(0xa5)][_0x41731d(0x1f4)];var _0x5b71d3=_0x5b9f78[_0x492330]!==undefined?formatNumber(_0x5b9f78[_0x492330][_0x41731d(0x1b1)](0x2)):'',_0x36ec36=_0x265157[_0x492330]!==undefined?formatNumber(_0x265157[_0x492330][_0x41731d(0x1b1)](0x2)):'',_0x576356=_0x22efab[_0x492330]!==undefined?formatNumber(_0x22efab[_0x492330]['toFixed'](0x2)):'';_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x5b71d3+'</b></td>',_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x576356+_0x41731d(0x1a3),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x36ec36+'</b></td>';}_0x55e685+=_0x41731d(0x82)+formatNumber(_0xf27cb7)+'</b></td>',_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5d8716)+_0x41731d(0x1a3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xcd),_0x55e685+='<tr>',_0x55e685+=_0x41731d(0x1cb),_0x55e685+=_0x41731d(0x175),_0x55e685+=_0x41731d(0xf3);for(let _0x4cefc4=0x0;_0x4cefc4<=_0x47c402[_0x41731d(0x189)][_0x41731d(0xb7)]-0x1;_0x4cefc4++){const _0x9a56de=_0x47c402[_0x41731d(0x189)][_0x4cefc4],_0xbbd0d5=_0x9a56de[_0x41731d(0xa5)]['brand']+'-'+_0x9a56de[_0x41731d(0xa5)][_0x41731d(0x1f4)];var _0x5b71d3=_0x21e5bb[_0xbbd0d5]!==undefined?formatNumber(_0x21e5bb[_0xbbd0d5][_0x41731d(0x1b1)](0x2)):'',_0x36ec36=_0x179169[_0xbbd0d5]!==undefined?formatNumber(_0x179169[_0xbbd0d5]['toFixed'](0x2)):'',_0x576356=_0x4fce27[_0xbbd0d5]!==undefined?formatNumber(_0x4fce27[_0xbbd0d5]['toFixed'](0x2)):'';_0x55e685+=_0x41731d(0x82)+_0x5b71d3+_0x41731d(0x1a3),_0x55e685+=_0x41731d(0x82)+_0x576356+'</b></td>',_0x55e685+=_0x41731d(0x82)+_0x36ec36+_0x41731d(0x1a3);}_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x431103)+_0x41731d(0x1a3),_0x55e685+=_0x41731d(0x82)+formatNumber(_0x3e5bb6)+_0x41731d(0x1a3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+='</tr>',_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0x1cb),_0x55e685+=_0x41731d(0x190),_0x55e685+=_0x41731d(0xf3);let _0x282ebf=0x0,_0x3ad5b4=0x0,_0x192e70=0x0;for(let _0x1f984a=0x0;_0x1f984a<=_0x47c402[_0x41731d(0x189)][_0x41731d(0xb7)]-0x1;_0x1f984a++){const _0x139a03=_0x47c402['cat_brand'][_0x1f984a],_0x7ea276=_0x139a03['_id']['brand']+'-'+_0x139a03[_0x41731d(0xa5)]['category'];var _0x1f8597=_0x5b9f78[_0x7ea276]!==undefined?_0x5b9f78[_0x7ea276][_0x41731d(0x1b1)](0x2):'0',_0x4171df=_0x265157[_0x7ea276]!==undefined?_0x265157[_0x7ea276][_0x41731d(0x1b1)](0x2):'0',_0x43fbe7=_0x22efab[_0x7ea276]!==undefined?_0x22efab[_0x7ea276]['toFixed'](0x2):'0',_0x1cda57=_0x21e5bb[_0x7ea276]!==undefined?_0x21e5bb[_0x7ea276][_0x41731d(0x1b1)](0x2):'0',_0x392238=_0x179169[_0x7ea276]!==undefined?_0x179169[_0x7ea276][_0x41731d(0x1b1)](0x2):'0',_0x421d83=_0x4fce27[_0x7ea276]!==undefined?_0x4fce27[_0x7ea276]['toFixed'](0x2):'0';_0x282ebf=parseFloat(_0x1f8597)+parseFloat(_0x1cda57),_0x3ad5b4=parseFloat(_0x43fbe7)+parseFloat(_0x421d83),_0x192e70=parseFloat(_0x4171df)+parseFloat(_0x392238),_0x55e685+=_0x41731d(0x82)+formatNumber(_0x282ebf[_0x41731d(0x1b1)](0x2))+_0x41731d(0x1a3),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3ad5b4[_0x41731d(0x1b1)](0x2))+_0x41731d(0x1a3),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x192e70[_0x41731d(0x1b1)](0x2))+_0x41731d(0x1a3);}var _0x4e68ab=formatNumber(_0xf27cb7+_0x431103),_0x3a705a=formatNumber(_0x5d8716+_0x3e5bb6);_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x4e68ab+'</b></td>',_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3a705a+_0x41731d(0x1a3),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xcd),_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0x9f)+(_0x47c402[_0x41731d(0x189)][_0x41731d(0xb7)]*0x3+0x9)+'\x22><b></b></td>',_0x55e685+=_0x41731d(0xcd),_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0x1cb),_0x55e685+=_0x41731d(0x1a8),_0x55e685+=_0x41731d(0xf3);for(let _0x42a33c=0x0;_0x42a33c<=_0x47c402[_0x41731d(0x189)][_0x41731d(0xb7)]-0x1;_0x42a33c++){const _0x41273e=_0x47c402[_0x41731d(0x189)][_0x42a33c],_0x6f481e=_0x41273e[_0x41731d(0xa5)][_0x41731d(0xdb)]+'-'+_0x41273e[_0x41731d(0xa5)][_0x41731d(0x1f4)];var _0x1f8597=_0x5b9f78[_0x6f481e]!==undefined?_0x5b9f78[_0x6f481e][_0x41731d(0x1b1)](0x2):'0',_0x4171df=_0x265157[_0x6f481e]!==undefined?_0x265157[_0x6f481e][_0x41731d(0x1b1)](0x2):'0',_0x43fbe7=_0x22efab[_0x6f481e]!==undefined?_0x22efab[_0x6f481e][_0x41731d(0x1b1)](0x2):'0',_0x1cda57=_0x21e5bb[_0x6f481e]!==undefined?_0x21e5bb[_0x6f481e][_0x41731d(0x1b1)](0x2):'0',_0x392238=_0x179169[_0x6f481e]!==undefined?_0x179169[_0x6f481e][_0x41731d(0x1b1)](0x2):'0',_0x421d83=_0x4fce27[_0x6f481e]!==undefined?_0x4fce27[_0x6f481e][_0x41731d(0x1b1)](0x2):'0';_0x282ebf=parseFloat(_0x1f8597)+parseFloat(_0x1cda57),_0x3ad5b4=parseFloat(_0x43fbe7)+parseFloat(_0x421d83),_0x192e70=parseFloat(_0x4171df)+parseFloat(_0x392238),_0x55e685+=_0x41731d(0x197),_0x55e685+=_0x41731d(0x197),_0x55e685+=_0x41731d(0x197);}_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+=_0x41731d(0xf3),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+=_0x41731d(0xf3),_0x55e685+='</tr>',_0x55e685+='<tr>',_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x55e685+=_0x41731d(0x76),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x56bcc3=0x0;_0x56bcc3<=_0x47c402['cat_brand'][_0x41731d(0xb7)]-0x1;_0x56bcc3++){const _0xbb8bdc=_0x47c402['cat_brand'][_0x56bcc3],_0x27fc21=_0xbb8bdc[_0x41731d(0xa5)]['brand']+'-'+_0xbb8bdc['_id']['category'];var _0x1f8597=_0x5b9f78[_0x27fc21]!==undefined?_0x5b9f78[_0x27fc21][_0x41731d(0x1b1)](0x2):'0',_0x4171df=_0x265157[_0x27fc21]!==undefined?_0x265157[_0x27fc21][_0x41731d(0x1b1)](0x2):'0',_0x43fbe7=_0x22efab[_0x27fc21]!==undefined?_0x22efab[_0x27fc21]['toFixed'](0x2):'0',_0x1cda57=_0x21e5bb[_0x27fc21]!==undefined?_0x21e5bb[_0x27fc21][_0x41731d(0x1b1)](0x2):'0',_0x392238=_0x179169[_0x27fc21]!==undefined?_0x179169[_0x27fc21]['toFixed'](0x2):'0',_0x421d83=_0x4fce27[_0x27fc21]!==undefined?_0x4fce27[_0x27fc21]['toFixed'](0x2):'0';_0x282ebf=parseFloat(_0x1f8597)+parseFloat(_0x1cda57),_0x3ad5b4=parseFloat(_0x43fbe7)+parseFloat(_0x421d83),_0x192e70=parseFloat(_0x4171df)+parseFloat(_0x392238),_0x55e685+=_0x41731d(0x197),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x55e685+=_0x41731d(0x197);}_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xcd),_0x55e685+='<tr>',_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x55e685+=_0x41731d(0x163),_0x55e685+=_0x41731d(0xf3);for(let _0x10a992=0x0;_0x10a992<=_0x47c402[_0x41731d(0x189)][_0x41731d(0xb7)]-0x1;_0x10a992++){const _0x5eb62f=_0x47c402['cat_brand'][_0x10a992],_0x356d82=_0x5eb62f[_0x41731d(0xa5)][_0x41731d(0xdb)]+'-'+_0x5eb62f[_0x41731d(0xa5)]['category'];var _0x1f8597=_0x5b9f78[_0x356d82]!==undefined?_0x5b9f78[_0x356d82][_0x41731d(0x1b1)](0x2):'0',_0x4171df=_0x265157[_0x356d82]!==undefined?_0x265157[_0x356d82]['toFixed'](0x2):'0',_0x43fbe7=_0x22efab[_0x356d82]!==undefined?_0x22efab[_0x356d82][_0x41731d(0x1b1)](0x2):'0',_0x1cda57=_0x21e5bb[_0x356d82]!==undefined?_0x21e5bb[_0x356d82]['toFixed'](0x2):'0',_0x392238=_0x179169[_0x356d82]!==undefined?_0x179169[_0x356d82][_0x41731d(0x1b1)](0x2):'0',_0x421d83=_0x4fce27[_0x356d82]!==undefined?_0x4fce27[_0x356d82][_0x41731d(0x1b1)](0x2):'0';_0x282ebf=parseFloat(_0x1f8597)+parseFloat(_0x1cda57),_0x3ad5b4=parseFloat(_0x43fbe7)+parseFloat(_0x421d83),_0x192e70=parseFloat(_0x4171df)+parseFloat(_0x392238),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x55e685+=_0x41731d(0x197);}_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+='</tr>',_0x55e685+=_0x41731d(0xb8),_0x55e685+=_0x41731d(0x1cb),_0x55e685+=_0x41731d(0x139),_0x55e685+=_0x41731d(0xf3);for(let _0x48648c=0x0;_0x48648c<=_0x47c402['cat_brand'][_0x41731d(0xb7)]-0x1;_0x48648c++){const _0x4ac659=_0x47c402['cat_brand'][_0x48648c],_0x3667e8=_0x4ac659['_id'][_0x41731d(0xdb)]+'-'+_0x4ac659[_0x41731d(0xa5)]['category'];var _0x1f8597=_0x5b9f78[_0x3667e8]!==undefined?_0x5b9f78[_0x3667e8][_0x41731d(0x1b1)](0x2):'',_0x4171df=_0x265157[_0x3667e8]!==undefined?_0x265157[_0x3667e8][_0x41731d(0x1b1)](0x2):'',_0x43fbe7=_0x22efab[_0x3667e8]!==undefined?_0x22efab[_0x3667e8][_0x41731d(0x1b1)](0x2):'',_0x1cda57=_0x21e5bb[_0x3667e8]!==undefined?_0x21e5bb[_0x3667e8][_0x41731d(0x1b1)](0x2):'',_0x392238=_0x179169[_0x3667e8]!==undefined?_0x179169[_0x3667e8][_0x41731d(0x1b1)](0x2):'',_0x421d83=_0x4fce27[_0x3667e8]!==undefined?_0x4fce27[_0x3667e8][_0x41731d(0x1b1)](0x2):'';_0x282ebf=formatNumber(parseFloat(_0x1f8597)+parseFloat(_0x1cda57)),_0x3ad5b4=formatNumber(parseFloat(_0x43fbe7)+parseFloat(_0x421d83)),_0x192e70=formatNumber(parseFloat(_0x4171df)+parseFloat(_0x392238)),_0x55e685+=_0x41731d(0x82)+_0x1f8597+_0x41731d(0x1a3),_0x55e685+=_0x41731d(0x82)+_0x43fbe7+_0x41731d(0x1a3),_0x55e685+=_0x41731d(0x82)+_0x4171df+'</b></td>';}_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+=_0x41731d(0xf3),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+=_0x41731d(0xf3),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+='</tr>',_0x55e685+='<tr>',_0x55e685+=_0x41731d(0x1cb),_0x55e685+=_0x41731d(0x92),_0x55e685+=_0x41731d(0xf3);for(let _0x372ffc=0x0;_0x372ffc<=_0x47c402[_0x41731d(0x189)]['length']-0x1;_0x372ffc++){const _0x25c6d1=_0x47c402['cat_brand'][_0x372ffc],_0x2040c4=_0x25c6d1[_0x41731d(0xa5)][_0x41731d(0xdb)]+'-'+_0x25c6d1[_0x41731d(0xa5)][_0x41731d(0x1f4)];var _0x1f8597=_0x5b9f78[_0x2040c4]!==undefined?_0x5b9f78[_0x2040c4][_0x41731d(0x1b1)](0x2):'0',_0x4171df=_0x265157[_0x2040c4]!==undefined?_0x265157[_0x2040c4][_0x41731d(0x1b1)](0x2):'0',_0x43fbe7=_0x22efab[_0x2040c4]!==undefined?_0x22efab[_0x2040c4][_0x41731d(0x1b1)](0x2):'0',_0x1cda57=_0x21e5bb[_0x2040c4]!==undefined?_0x21e5bb[_0x2040c4][_0x41731d(0x1b1)](0x2):'0',_0x392238=_0x179169[_0x2040c4]!==undefined?_0x179169[_0x2040c4][_0x41731d(0x1b1)](0x2):'0',_0x421d83=_0x4fce27[_0x2040c4]!==undefined?_0x4fce27[_0x2040c4][_0x41731d(0x1b1)](0x2):'0';_0x282ebf=parseFloat(_0x1f8597)+parseFloat(_0x1cda57),_0x3ad5b4=parseFloat(_0x43fbe7)+parseFloat(_0x421d83),_0x192e70=parseFloat(_0x4171df)+parseFloat(_0x392238),_0x55e685+=_0x41731d(0x197),_0x55e685+=_0x41731d(0x197),_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+=_0x41731d(0xf3),_0x55e685+='</tr>',_0x55e685+=_0x41731d(0x194),_0x55e685+=_0x41731d(0x9b);}),_0x55e685;}async function generateReferenceNumber(_0x3bb2bb,_0x11850c,_0x35ee25){const _0x6cfa95=a0_0x5cb102,_0x3d98bb=new Date(_0x3bb2bb)['getFullYear'](),_0x5a6769=('0'+(new Date(_0x3bb2bb)[_0x6cfa95(0x131)]()+0x1))['slice'](-0x2),_0x5e5c3b=('0'+new Date(_0x3bb2bb)['getDate']())[_0x6cfa95(0x16c)](-0x2),_0x3c3f89=await staff[_0x6cfa95(0x12d)]({'email':_0x35ee25[_0x6cfa95(0x186)]}),_0x4463ac=_0x3c3f89[_0x6cfa95(0x1bd)],_0x2c11a0=_0x4463ac+'-'+_0x3d98bb+_0x5a6769+_0x5e5c3b,_0x5ceb82=await Reference[_0x6cfa95(0x12d)]({'referenceNumber':new RegExp('^'+_0x2c11a0),'salesman_code':_0x4463ac})[_0x6cfa95(0x164)]({'createdAt':-0x1}),_0x4f8667=_0x2c11a0;_0x5ceb82&&(_0x4f8667=_0x5ceb82[_0x6cfa95(0x1b3)]);console['log'](_0x4f8667);const _0x7108a5=new Reference({'referenceNumber':_0x4f8667,'staff_id':_0x11850c,'salesman_code':_0x4463ac});return await _0x7108a5[_0x6cfa95(0x123)](),_0x4f8667;}function a0_0x5d82(){const _0x4f3727=['slice','$date','<th\x20rowspan=\x272\x27>Category</th>','trim','json','success','2654165hTGmUz','$totalQty','product_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','$product_info.name','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','Portuguese','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20class=\x22row_data\x22>','/reports/dsrr/view','load','body','\x20-\x20','flash','<script>','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','send','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','6lmdSMH','Types','email','$products.adj_discount','$products.qty','cat_brand','<div\x20class=\x22row\x22>','$sale_product.totalprice','$discount','/dsrr_admin/view','discount','express/lib/response','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','/agent_reports/view','$products.product_details.brand','pdfkit-table','</tbody>','post','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','/getDSSR_no_sales','push','!cols','$sale_product.stock','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','$products.product_details.gross_price','\x20<>\x20','$products.product_details','/balance/view','<th>\x20ITEM\x20CODE\x20</th>','rowspan','</b></td>','colspan','aoa_to_sheet','html','</thead>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','product_name','date','book_append_sheet','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','numeric','4gCrSuD','dataqty','toFixed','table\x20tr','referenceNumber','$product_docs','then','utils','medium','findById','bottom','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','$sale_product','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','sales_man_code','Content-Type','/total_sales_reports/pdf','$product.product_code','<th\x20colspan=\x272\x27>SOLD</th>','cash','product_docs','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22row_data\x22></td>','toStream','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<th>\x20QTY\x20SOLD\x20</th>','/dsrr_admin/view_data/:id','$products','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','$product_list.product_code','style','000000','getDate','render','$product_code','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','$product_list.product_name','amount','prod_cat','$product_list','$sale_product.discount','$product_info.product_code','adj_discount','sale_product.product_code','/agent_reports/pdf_admin','sales_ext','!merges','$check_no','Products\x20find_data','Products\x20warehouse_data','attr','<th\x20rowspan=\x272\x27>Production</th>','product_code','format','Products\x20master','Spanish','$product_details.product_name','get','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','Portuguese\x20(BR)','status','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','$_id.category','right','sales_info','each','\x22\x20class=\x22cat_data\x22>','</script>','application/pdf','category','products','0.1in','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','language','staffs','<div\x20style=\x22page-break-before:\x20always;\x22></div>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','<td\x20class=\x22cat_data\x22>','/inventory_sum/pdf','\x20-\x20HH','$_id.brand','$sale_product.prod_cat','includes','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$customer','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','$sales_info._id','totalPrice','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','$sale_product.real_qty_unit_val','$_id.date','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','find','</th>','<td\x20colspan=\x22','sumqty','<p>SALES\x20REPORTS</p>','Hindi','<h1>JAKA\x20EQUITIES\x20CORP</h1>','$products.product_details.category','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$NetPrice','Letter','write','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','English\x20(US)','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','brandCount','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','forEach','8.5in','Checking:\x20','$sales_staff_id','buffer','$product','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','$product_info.category','$product_info.gross_price','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','check_no','$status_data','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','toISOString','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','</table>','NetPrice','bank','No\x20data\x20was\x20Found!','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','/dev/null','stock','html-pdf','<th>\x20BEG\x20BALANCE\x20</th>','name','_id','/getDSSR_no','beg_bal','totalQTY','$due_date','exceljs','<td\x20class=\x22row_data\x22><b>','Router','../models/all_models','border-left','$product_list.product_stock','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','false','border-right','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','ObjectId','<div\x20class=\x22col-sm-11\x22>','<tbody>','length','<tr>','$_id.status_data','sales_staff_id','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','Arabic','path','$sales_info','/dl_excel','<td\x20class=\x22row_data\x22>0</td>','error','$product_details.product_stock','Sales\x20Report','totalGross','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','/agent/pdf','valueOf','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$amount','split','DateTimeFormat','Content-Disposition','</tr>','$sale_product.adj_discount','Chinese','\x20-\x20STD','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','attachment;\x20filename=\x22sales_report.xlsx\x22','create','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','782572JTerrA','Standard','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','$brand','60mm','brand','$products.NetPrice','toLocaleString','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','product_details','$dsi','long','15in','10860264yVRroV','$products.discount','redirect','$product_info.brand','canvas','setDate','top','balanced','$sale_product._id','NumberFormat','$_id.customer','replace','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','1260472BQWkzh','/dsrr/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','Household','\x22><b>','20mm','product_details.product_name','<th>\x20ITEM\x20DESCRIPTION\x20</th>','French','679591pMLOMg','<th>\x20INVOICE\x20AMOUNT\x20</th>','/inventory_sum/view','date_include','dsi_sales_admin','$sale_product.isFG','border-top','sales_reports','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','product_stock','/agent_reports/pdf','params','/balance/pdf','window.onload\x20=\x20function()\x20{','$product.quantity','$product_stock','$product_details','inventory_sum','td,\x20th','$sales_info.name','dsi','../public/language/languages.json','thin','</div>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','3743208EzaNuy','blob-stream','deleteOne','reduce','<th>\x20SALES\x20</th>','errors','$sale_product.product_name','$_id.dsi','attachment;\x20filename=\x22reports.xlsx\x22','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','dsi_sales','left','<th\x20rowspan=\x272\x27>Products</th>','$product_info','<div\x20\x20id=\x22table-conatainer\x22>','save','/total_sales_reports/view','/agent_reports/sales_ad','$sale_product.product_code','$cash','Arabic\x20(ae)','$bank','../middleware/auth','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','<p>FINISHED\x20GOODS\x20INVENTORY</p>','findOne','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','3zntUTP','getMonth','user','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','pipe','qty','</p>','border-bottom','totalQTYsum','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','German','en-US','$product_name','isFG','due_date','$sale_product.quantity','setHeader','aggregate','map','</td>','book_new','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','$adj_discount','<thead>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<table>','landscape','xlsx','$products.product_details.prod_id','English','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','excel','isArray','$category','$name','log','11114792GMNglW','Asia/Manila','PDF\x20Generation\x20Error:','window.print();','jsbarcode','<p>','totalQty','true','thick','text','Error\x20generating\x20PDF','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','<p>INVENTORY\x20SUMMARY</p>','sales_bkg','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','sort','<td\x20colspan=\x223\x22><b>TOTAL<b>','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','310NNwVxT','$totalGross','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','mongoose','customer'];a0_0x5d82=function(){return _0x4f3727;};return a0_0x5d82();}router[a0_0x5cb102(0x195)]('/dsrr/pdf',auth,async(_0x31cb76,_0x185a55)=>{const _0x4a2038=a0_0x5cb102,{from_date:_0x14a8d0,dataview:_0x296c89}=_0x31cb76[_0x4a2038(0x17d)],_0x48f4ee=_0x31cb76[_0x4a2038(0x132)],_0x1159f4=await staff[_0x4a2038(0x12d)]({'email':_0x48f4ee[_0x4a2038(0x186)]}),_0x916851=await master_shop[_0x4a2038(0x7a)](),_0x1168f3='';var _0x55f913=new Date(_0x14a8d0);const _0x32ada0={'year':'numeric','month':_0x4a2038(0xe2),'day':_0x4a2038(0x1ae)},_0x5c1874=new Intl[(_0x4a2038(0xcb))](_0x4a2038(0x13b),_0x32ada0)[_0x4a2038(0x1e4)](_0x55f913),_0x269250=await Reference[_0x4a2038(0x7a)]({'staff_id':_0x1159f4[_0x4a2038(0xa5)][_0x4a2038(0xc7)](),'date_include':_0x14a8d0});if(_0x269250[_0x4a2038(0xb7)]>0x0){let _0x597e3a='';_0x597e3a+=_0x269250[0x0]['html'];if(_0x296c89=='excel'){const _0xeaf3fd=cheerio[_0x4a2038(0x17c)](_0x597e3a);let _0x4fc3ee=[],_0x28825c=[],_0x2664f8=[];const _0x51f46a=_0x34220f=>{const _0x2ba3dd=_0x4a2038,_0x5b6803={'top':{'style':_0x2ba3dd(0x15c),'color':{'rgb':'000000'}},'bottom':{'style':_0x2ba3dd(0x15c),'color':{'rgb':'000000'}},'left':{'style':_0x2ba3dd(0x15c),'color':{'rgb':_0x2ba3dd(0x1ce)}},'right':{'style':_0x2ba3dd(0x15c),'color':{'rgb':'000000'}}};if(_0x34220f){const _0x33b94e=_0x34220f[_0x2ba3dd(0xca)](';')[_0x2ba3dd(0x116)]((_0x4442e8,_0x3a86cd)=>{const _0x35c649=_0x2ba3dd,[_0x5d4c53,_0x403605]=_0x3a86cd['split'](':')[_0x35c649(0x142)](_0x1611db=>_0x1611db[_0x35c649(0x16f)]());return _0x4442e8[_0x5d4c53]=_0x403605,_0x4442e8;},{});_0x33b94e['border-top']&&(_0x5b6803['top'][_0x2ba3dd(0x1cd)]=_0x33b94e[_0x2ba3dd(0x100)][_0x2ba3dd(0x201)](_0x2ba3dd(0x110))?'thin':_0x2ba3dd(0x1b7)),_0x33b94e[_0x2ba3dd(0x137)]&&(_0x5b6803['bottom'][_0x2ba3dd(0x1cd)]=_0x33b94e[_0x2ba3dd(0x137)][_0x2ba3dd(0x201)]('thin')?_0x2ba3dd(0x110):_0x2ba3dd(0x1b7)),_0x33b94e['border-left']&&(_0x5b6803['left']['style']=_0x33b94e[_0x2ba3dd(0xae)][_0x2ba3dd(0x201)]('thin')?_0x2ba3dd(0x110):_0x2ba3dd(0x1b7)),_0x33b94e[_0x2ba3dd(0xb2)]&&(_0x5b6803[_0x2ba3dd(0x1ee)][_0x2ba3dd(0x1cd)]=_0x33b94e[_0x2ba3dd(0xb2)][_0x2ba3dd(0x201)]('thin')?'thin':_0x2ba3dd(0x1b7));}return _0x5b6803;};_0xeaf3fd('table\x20tr')[_0x4a2038(0x1f0)]((_0x568ca8,_0x16fdc6)=>{const _0x487d9b=_0x4a2038;let _0x37c0d8=[],_0x570e9f=0x0;while(_0x2664f8[_0x570e9f]){_0x2664f8[_0x570e9f]--,_0x570e9f++;}_0xeaf3fd(_0x16fdc6)[_0x487d9b(0x7a)]('td,\x20th')[_0x487d9b(0x1f0)]((_0x19c6d1,_0x6b2bf0)=>{const _0x19ead1=_0x487d9b;let _0x71856=_0xeaf3fd(_0x6b2bf0)[_0x19ead1(0x15d)]()[_0x19ead1(0x16f)](),_0x7c29d3=parseFloat(_0x71856[_0x19ead1(0xef)](/,/g,''));isNaN(_0x7c29d3)&&(_0x7c29d3=_0x71856);let _0x8602a0=parseInt(_0xeaf3fd(_0x6b2bf0)[_0x19ead1(0x1e1)]('colspan'))||0x1,_0x17ecf8=parseInt(_0xeaf3fd(_0x6b2bf0)['attr'](_0x19ead1(0x1a2)))||0x1;const _0x4514e9=_0xeaf3fd(_0x6b2bf0)[_0x19ead1(0x1e1)](_0x19ead1(0x1cd)),_0x5054cb=_0x51f46a(_0x4514e9);_0x37c0d8[_0x570e9f]={'v':_0x7c29d3,'s':{'border':_0x5054cb}};(_0x8602a0>0x1||_0x17ecf8>0x1)&&_0x28825c['push']({'s':{'r':_0x568ca8,'c':_0x570e9f},'e':{'r':_0x568ca8+_0x17ecf8-0x1,'c':_0x570e9f+_0x8602a0-0x1}});for(let _0x43e389=0x0;_0x43e389<_0x8602a0;_0x43e389++){_0x17ecf8>0x1&&(_0x2664f8[_0x570e9f+_0x43e389]=_0x17ecf8-0x1);}_0x570e9f+=_0x8602a0;}),_0x4fc3ee['push'](_0x37c0d8);});const _0x485d93=XLSX['utils'][_0x4a2038(0x144)](),_0x2595c1=XLSX[_0x4a2038(0x1b6)][_0x4a2038(0x1a5)](_0x4fc3ee);_0x28825c[_0x4a2038(0xb7)]>0x0&&(_0x2595c1[_0x4a2038(0x1dd)]=_0x28825c);_0x2595c1[_0x4a2038(0x19a)]=_0x4fc3ee[0x0][_0x4a2038(0x142)](()=>({'wpx':0x64})),XLSX['utils'][_0x4a2038(0x1ab)](_0x485d93,_0x2595c1,_0x4a2038(0xc3));const _0xde7813=XLSX[_0x4a2038(0x85)](_0x485d93,{'bookType':_0x4a2038(0x14b),'type':_0x4a2038(0x8f)});_0x185a55[_0x4a2038(0x140)]('Content-Disposition',_0x4a2038(0xd3)),_0x185a55[_0x4a2038(0x140)](_0x4a2038(0x1be),_0x4a2038(0x11d)),_0x185a55[_0x4a2038(0x182)](_0xde7813);}else{let _0x2644d5='';_0x2644d5+=_0x597e3a,_0x2644d5+=_0x4a2038(0x180),_0x2644d5+='window.onload\x20=\x20function()\x20{',_0x2644d5+=_0x4a2038(0x157),_0x2644d5+='};',_0x2644d5+=_0x4a2038(0x1f2),_0x185a55[_0x4a2038(0x182)](_0x2644d5);}}else generateReferenceNumber(_0x14a8d0,_0x1159f4[_0x4a2038(0xa5)][_0x4a2038(0xc7)](),_0x48f4ee)[_0x4a2038(0x1b5)](async _0x445a45=>{const _0x265a19=_0x4a2038,_0x15e0aa=await agentsdataDSICheck_DSRR(_0x14a8d0,_0x1159f4[_0x265a19(0xa5)][_0x265a19(0xc7)](),_0x1168f3,_0x445a45);console[_0x265a19(0x153)](_0x15e0aa);let _0x31d229=_0x265a19(0x148);_0x31d229+=_0x265a19(0x18a),_0x31d229+=_0x265a19(0x122),_0x31d229+=_0x265a19(0x149),_0x31d229+=_0x15e0aa,_0x31d229+=_0x265a19(0x9b),_0x31d229+=_0x265a19(0x111),_0x31d229+=_0x265a19(0x111);if(_0x15e0aa[_0x265a19(0xb7)]>0x0){const _0x3994ff=await Reference[_0x265a19(0x12d)]({'staff_id':_0x1159f4[_0x265a19(0xa5)][_0x265a19(0xc7)](),'referenceNumber':_0x445a45});_0x3994ff['html']=_0x31d229,_0x3994ff[_0x265a19(0xfd)]=_0x14a8d0,await _0x3994ff[_0x265a19(0x123)]();if(_0x296c89==_0x265a19(0x14f)){const _0x17ff97=cheerio[_0x265a19(0x17c)](_0x31d229);let _0xd9f67d=[],_0x1c5cde=[],_0x160d67=[];const _0x413da5=_0x54af12=>{const _0x324e96=_0x265a19,_0x169241={'top':{'style':_0x324e96(0x15c),'color':{'rgb':_0x324e96(0x1ce)}},'bottom':{'style':_0x324e96(0x15c),'color':{'rgb':_0x324e96(0x1ce)}},'left':{'style':_0x324e96(0x15c),'color':{'rgb':_0x324e96(0x1ce)}},'right':{'style':_0x324e96(0x15c),'color':{'rgb':_0x324e96(0x1ce)}}};if(_0x54af12){const _0x1ccfb1=_0x54af12[_0x324e96(0xca)](';')['reduce']((_0x402a13,_0x53fa21)=>{const _0x3a9c70=_0x324e96,[_0x16ba0a,_0x395af6]=_0x53fa21['split'](':')[_0x3a9c70(0x142)](_0x261e64=>_0x261e64[_0x3a9c70(0x16f)]());return _0x402a13[_0x16ba0a]=_0x395af6,_0x402a13;},{});_0x1ccfb1['border-top']&&(_0x169241[_0x324e96(0xea)][_0x324e96(0x1cd)]=_0x1ccfb1[_0x324e96(0x100)][_0x324e96(0x201)](_0x324e96(0x110))?_0x324e96(0x110):_0x324e96(0x1b7)),_0x1ccfb1[_0x324e96(0x137)]&&(_0x169241[_0x324e96(0x1b9)][_0x324e96(0x1cd)]=_0x1ccfb1[_0x324e96(0x137)][_0x324e96(0x201)]('thin')?_0x324e96(0x110):'medium'),_0x1ccfb1[_0x324e96(0xae)]&&(_0x169241[_0x324e96(0x11f)][_0x324e96(0x1cd)]=_0x1ccfb1[_0x324e96(0xae)][_0x324e96(0x201)](_0x324e96(0x110))?_0x324e96(0x110):_0x324e96(0x1b7)),_0x1ccfb1[_0x324e96(0xb2)]&&(_0x169241[_0x324e96(0x1ee)][_0x324e96(0x1cd)]=_0x1ccfb1[_0x324e96(0xb2)][_0x324e96(0x201)](_0x324e96(0x110))?'thin':'medium');}return _0x169241;};_0x17ff97(_0x265a19(0x1b2))[_0x265a19(0x1f0)]((_0x402d7a,_0x328a31)=>{const _0x5c4e9e=_0x265a19;let _0x270b61=[],_0x3a4909=0x0;while(_0x160d67[_0x3a4909]){_0x160d67[_0x3a4909]--,_0x3a4909++;}_0x17ff97(_0x328a31)[_0x5c4e9e(0x7a)](_0x5c4e9e(0x10c))['each']((_0x1dcc8f,_0x33a63f)=>{const _0x20fa56=_0x5c4e9e;let _0x4a8015=_0x17ff97(_0x33a63f)['text']()['trim'](),_0xafc010=parseFloat(_0x4a8015[_0x20fa56(0xef)](/,/g,''));isNaN(_0xafc010)&&(_0xafc010=_0x4a8015);let _0x59439f=parseInt(_0x17ff97(_0x33a63f)[_0x20fa56(0x1e1)](_0x20fa56(0x1a4)))||0x1,_0x2b5c51=parseInt(_0x17ff97(_0x33a63f)[_0x20fa56(0x1e1)](_0x20fa56(0x1a2)))||0x1;const _0x20546e=_0x17ff97(_0x33a63f)[_0x20fa56(0x1e1)](_0x20fa56(0x1cd)),_0xab11c0=_0x413da5(_0x20546e);_0x270b61[_0x3a4909]={'v':_0xafc010,'s':{'border':_0xab11c0}};(_0x59439f>0x1||_0x2b5c51>0x1)&&_0x1c5cde[_0x20fa56(0x199)]({'s':{'r':_0x402d7a,'c':_0x3a4909},'e':{'r':_0x402d7a+_0x2b5c51-0x1,'c':_0x3a4909+_0x59439f-0x1}});for(let _0x4954ee=0x0;_0x4954ee<_0x59439f;_0x4954ee++){_0x2b5c51>0x1&&(_0x160d67[_0x3a4909+_0x4954ee]=_0x2b5c51-0x1);}_0x3a4909+=_0x59439f;}),_0xd9f67d[_0x5c4e9e(0x199)](_0x270b61);});const _0x41e091=XLSX[_0x265a19(0x1b6)][_0x265a19(0x144)](),_0x546e89=XLSX[_0x265a19(0x1b6)][_0x265a19(0x1a5)](_0xd9f67d);_0x1c5cde[_0x265a19(0xb7)]>0x0&&(_0x546e89[_0x265a19(0x1dd)]=_0x1c5cde);_0x546e89[_0x265a19(0x19a)]=_0xd9f67d[0x0][_0x265a19(0x142)](()=>({'wpx':0x64})),XLSX[_0x265a19(0x1b6)][_0x265a19(0x1ab)](_0x41e091,_0x546e89,_0x265a19(0xc3));const _0x4d6d32=XLSX[_0x265a19(0x85)](_0x41e091,{'bookType':_0x265a19(0x14b),'type':_0x265a19(0x8f)});_0x185a55['setHeader'](_0x265a19(0xcc),_0x265a19(0xd3)),_0x185a55['setHeader']('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x185a55[_0x265a19(0x182)](_0x4d6d32);}else _0x31d229+=_0x265a19(0x180),_0x31d229+=_0x265a19(0x107),_0x31d229+=_0x265a19(0x157),_0x31d229+='};',_0x31d229+='</script>',_0x185a55[_0x265a19(0x182)](_0x31d229);}else await Reference[_0x265a19(0x115)]({'referenceNumber':_0x445a45}),_0x31cb76[_0x265a19(0x17f)](_0x265a19(0x118),_0x265a19(0x9e)),_0x185a55[_0x265a19(0xe6)](_0x265a19(0x17b));})['catch'](console[_0x4a2038(0xc1)]);}),router['get'](a0_0x5cb102(0x18d),auth,async(_0x5beb87,_0x1fa1a0)=>{const _0x1ac665=a0_0x5cb102;try{const {username:_0x4a18d6,email:_0x51fb96,role:_0x7ec773}=_0x5beb87[_0x1ac665(0x132)],_0xe129fe=_0x5beb87[_0x1ac665(0x132)],_0x518b0f=await profile[_0x1ac665(0x12d)]({'email':_0xe129fe[_0x1ac665(0x186)]}),_0x3eed1e={'year':'numeric','month':_0x1ac665(0xe2),'day':'numeric'},_0x1f8859=await master_shop[_0x1ac665(0x7a)]();console[_0x1ac665(0x153)]('Products\x20master',_0x1f8859);const _0x58afc7=await product[_0x1ac665(0x7a)]();console[_0x1ac665(0x153)]('Products\x20find_data',_0x58afc7);const _0x2e304c=await warehouse['aggregate']([{'$unwind':_0x1ac665(0x10a)},{'$lookup':{'from':'products','localField':_0x1ac665(0xf7),'foreignField':_0x1ac665(0xa4),'as':_0x1ac665(0x1c3)}},{'$unwind':_0x1ac665(0x1b4)},{'$project':{'product_name':_0x1ac665(0x1e7),'product_stock':_0x1ac665(0xc2)}},{'$group':{'_id':_0x1ac665(0x13c),'product_stock':{'$sum':_0x1ac665(0x109)}}}]);console[_0x1ac665(0x153)](_0x1ac665(0x1e0),_0x2e304c),_0x2e304c['forEach'](_0x5746f6=>{const _0x4e21cd=_0x58afc7['map'](_0x3a78cc=>{const _0x27b17f=a0_0x1f28;_0x3a78cc['name']==_0x5746f6[_0x27b17f(0xa5)]&&(_0x3a78cc[_0x27b17f(0xa1)]=parseInt(_0x3a78cc[_0x27b17f(0xa1)])+parseInt(_0x5746f6['product_stock']));});});const _0x14cca0=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x21d67b=await staff[_0x1ac665(0x12d)]({'email':_0xe129fe[_0x1ac665(0x186)]});if(_0x1f8859[0x0]['language']=='English\x20(US)')var _0x4a633b=users['English'];else{if(_0x1f8859[0x0]['language']==_0x1ac665(0x7f))var _0x4a633b=users[_0x1ac665(0x7f)];else{if(_0x1f8859[0x0][_0x1ac665(0x1f8)]==_0x1ac665(0x13a))var _0x4a633b=users[_0x1ac665(0x13a)];else{if(_0x1f8859[0x0][_0x1ac665(0x1f8)]==_0x1ac665(0x1e6))var _0x4a633b=users[_0x1ac665(0x1e6)];else{if(_0x1f8859[0x0][_0x1ac665(0x1f8)]==_0x1ac665(0xf9))var _0x4a633b=users['French'];else{if(_0x1f8859[0x0][_0x1ac665(0x1f8)]==_0x1ac665(0x1ea))var _0x4a633b=users[_0x1ac665(0x178)];else{if(_0x1f8859[0x0]['language']=='Chinese')var _0x4a633b=users[_0x1ac665(0xcf)];else{if(_0x1f8859[0x0][_0x1ac665(0x1f8)]=='Arabic\x20(ae)')var _0x4a633b=users[_0x1ac665(0xbc)];}}}}}}}_0x1fa1a0[_0x1ac665(0x1d0)]('dssr_view_admin',{'success':_0x5beb87[_0x1ac665(0x17f)]('success'),'errors':_0x5beb87[_0x1ac665(0x17f)](_0x1ac665(0x118)),'alldata':_0x58afc7,'profile':_0x518b0f,'master_shop':_0x1f8859,'role':_0xe129fe,'product_stock':_0x2e304c,'language':_0x4a633b,'staff_arr':_0x21d67b,'staff_data_all':_0x14cca0});}catch(_0x3991e2){}}),router[a0_0x5cb102(0x195)](a0_0x5cb102(0xa6),auth,async(_0x36bec6,_0x302644)=>{const _0x32d590=a0_0x5cb102;try{const {from:_0x763d5c,to:_0x532a4b,staff_data:_0x14bd92}=_0x36bec6[_0x32d590(0x17d)],_0x542ad2=await Reference[_0x32d590(0x141)]([{'$match':{'date_include':{'$gte':_0x763d5c,'$lte':_0x532a4b},'staff_id':_0x14bd92}},{'$sort':{'date_include':0x1}}]);_0x302644['json'](_0x542ad2);}catch(_0x23ed8f){_0x302644[_0x32d590(0x170)](_0x23ed8f);}}),router[a0_0x5cb102(0x195)](a0_0x5cb102(0x198),auth,async(_0x12d44e,_0x3d9542)=>{const _0x42062b=a0_0x5cb102;try{const {from:_0x3597d2,to:_0x445baa}=_0x12d44e[_0x42062b(0x17d)],{sttaff_id:_0x4d39bf}=_0x12d44e['user'],_0x2c56a1=await Reference[_0x42062b(0x141)]([{'$match':{'date_include':{'$gte':_0x3597d2,'$lte':_0x445baa},'staff_id':_0x4d39bf}},{'$sort':{'date_include':0x1}}]);_0x3d9542[_0x42062b(0x170)](_0x2c56a1);}catch(_0x133d5a){_0x3d9542[_0x42062b(0x170)](_0x133d5a);}}),router[a0_0x5cb102(0x1e8)](a0_0x5cb102(0x1c9),auth,async(_0x1f4697,_0x481525)=>{const _0x6ed687=a0_0x5cb102;try{const _0x49b63b=_0x1f4697[_0x6ed687(0x105)]['id'],_0x575673=await Reference[_0x6ed687(0x1b8)](_0x49b63b);let _0x22c915='';_0x22c915+=_0x575673['html'],_0x22c915+=_0x6ed687(0x180),_0x22c915+=_0x6ed687(0x107),_0x22c915+=_0x6ed687(0x157),_0x22c915+='};',_0x22c915+=_0x6ed687(0x1f2),_0x481525[_0x6ed687(0x182)](_0x22c915);}catch(_0x2450d9){_0x481525[_0x6ed687(0x170)](_0x2450d9);}}),router['post'](a0_0x5cb102(0xbf),auth,async(_0x3057cd,_0x55bb22)=>{const _0x5f2295=a0_0x5cb102;try{const {ref_data:_0x164316}=_0x3057cd['body'],_0x388025=_0x164316[_0x5f2295(0xca)]('~'),_0x35ac21=_0x388025['filter'](_0x16871d=>_0x16871d!==''),_0x11f98b=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x35ac21}}}]),_0x403d37=XLSX[_0x5f2295(0x1b6)][_0x5f2295(0x144)]();_0x11f98b[_0x5f2295(0x8b)](_0x1974e3=>{const _0x38d268=_0x5f2295,_0x34b213=cheerio[_0x38d268(0x17c)](_0x1974e3[_0x38d268(0x1a6)]);let _0x166165=[],_0x244a1c=[],_0x2b1333=[];_0x34b213(_0x38d268(0x1b2))[_0x38d268(0x1f0)]((_0x4b78b3,_0x5f2064)=>{const _0x44f272=_0x38d268;let _0x16712e=[],_0x59b205=0x0;while(_0x2b1333[_0x59b205]){_0x2b1333[_0x59b205]--,_0x59b205++;}_0x34b213(_0x5f2064)[_0x44f272(0x7a)]('td,\x20th')[_0x44f272(0x1f0)]((_0xb24a3d,_0x48bef9)=>{const _0x32b5c3=_0x44f272;let _0xf2f9dd=_0x34b213(_0x48bef9)[_0x32b5c3(0x15d)]()['trim'](),_0x53dbd2=parseFloat(_0xf2f9dd[_0x32b5c3(0xef)](/,/g,''));isNaN(_0x53dbd2)&&(_0x53dbd2=_0xf2f9dd);let _0x4eb941=parseInt(_0x34b213(_0x48bef9)[_0x32b5c3(0x1e1)](_0x32b5c3(0x1a4)))||0x1,_0x2e2fc5=parseInt(_0x34b213(_0x48bef9)[_0x32b5c3(0x1e1)](_0x32b5c3(0x1a2)))||0x1;_0x16712e[_0x59b205]=_0x53dbd2;(_0x4eb941>0x1||_0x2e2fc5>0x1)&&_0x244a1c['push']({'s':{'r':_0x4b78b3,'c':_0x59b205},'e':{'r':_0x4b78b3+_0x2e2fc5-0x1,'c':_0x59b205+_0x4eb941-0x1}});for(let _0x1b8bd9=0x0;_0x1b8bd9<_0x4eb941;_0x1b8bd9++){_0x2e2fc5>0x1&&(_0x2b1333[_0x59b205+_0x1b8bd9]=_0x2e2fc5-0x1);}_0x59b205+=_0x4eb941;}),_0x166165[_0x44f272(0x199)](_0x16712e);});const _0x343b26=XLSX[_0x38d268(0x1b6)]['aoa_to_sheet'](_0x166165);_0x244a1c['length']>0x0&&(_0x343b26[_0x38d268(0x1dd)]=_0x244a1c),_0x343b26[_0x38d268(0x19a)]=_0x166165[0x0][_0x38d268(0x142)](()=>({'wpx':0x64})),XLSX[_0x38d268(0x1b6)][_0x38d268(0x1ab)](_0x403d37,_0x343b26,_0x1974e3[_0x38d268(0x1b3)]);});const _0x307c7c=XLSX[_0x5f2295(0x85)](_0x403d37,{'bookType':'xlsx','type':'buffer'});_0x55bb22['setHeader'](_0x5f2295(0xcc),_0x5f2295(0x11b)),_0x55bb22['setHeader'](_0x5f2295(0x1be),_0x5f2295(0x11d)),_0x55bb22['send'](_0x307c7c);}catch(_0x421f33){_0x55bb22[_0x5f2295(0x170)](_0x421f33);}}),router[a0_0x5cb102(0x195)]('/dsrr_admin/pdf_admin',auth,async(_0x383444,_0x3f80fe)=>{const _0x59fd68=a0_0x5cb102,{from_date:_0x18a0b9,agent_id:_0x7bc8f1}=_0x383444[_0x59fd68(0x17d)],_0x510c52=_0x383444[_0x59fd68(0x132)],_0x4ee78f=await staff[_0x59fd68(0x12d)]({'email':_0x510c52[_0x59fd68(0x186)]}),_0x2a7a6d=await master_shop[_0x59fd68(0x7a)](),_0x2770dd=await agentsdataDSICheck_DSRR(_0x18a0b9,_0x7bc8f1,_0x5973f8);let _0x2ffbbf=_0x59fd68(0xd1);var _0x232e69=new Date(_0x18a0b9);const _0xa5d329={'year':_0x59fd68(0x1ae),'month':_0x59fd68(0xe2),'day':'numeric'},_0x1c12bd=new Intl[(_0x59fd68(0xcb))]('en-US',_0xa5d329)[_0x59fd68(0x1e4)](_0x232e69);_0x2ffbbf+=_0x59fd68(0x18a),_0x2ffbbf+='<div\x20\x20id=\x22table-conatainer\x22>',_0x2ffbbf+='<table>',_0x2ffbbf+=_0x2770dd,_0x2ffbbf+=_0x59fd68(0x9b),_0x2ffbbf+='</div>',_0x2ffbbf+=_0x59fd68(0x111);let _0x385564='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x41e11d={'width':_0x59fd68(0xe3),'height':_0x59fd68(0x8c),'orientation':_0x59fd68(0x14a),'border':{'top':_0x59fd68(0x1f6),'right':'0.1in','bottom':_0x59fd68(0x1f6),'left':_0x59fd68(0x1f6)},'header':{'height':_0x59fd68(0xda),'contents':_0x59fd68(0x1ec)+_0x385564+_0x59fd68(0x1d2)+_0x1c12bd+_0x59fd68(0x8a)},'footer':{'height':_0x59fd68(0xf6),'contents':{'default':_0x59fd68(0x14e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x59fd68(0xa0)}}};var _0x5973f8='on';if(_0x5973f8=='on'){const _0x218a44=cheerio[_0x59fd68(0x17c)](_0x2ffbbf);let _0x25b5d3=[],_0x312b21=[],_0x4ffb3f=[];_0x218a44(_0x59fd68(0x1b2))['each']((_0x2b3f59,_0x1f76cc)=>{const _0x21cd83=_0x59fd68;let _0x5b08bd=[],_0x377bc6=0x0;while(_0x4ffb3f[_0x377bc6]){_0x4ffb3f[_0x377bc6]--,_0x377bc6++;}_0x218a44(_0x1f76cc)[_0x21cd83(0x7a)](_0x21cd83(0x10c))['each']((_0x52f24e,_0xb49923)=>{const _0x2c0cb5=_0x21cd83;let _0x22476d=_0x218a44(_0xb49923)['text']()['trim'](),_0x14fba9=parseFloat(_0x22476d[_0x2c0cb5(0xef)](/,/g,''));isNaN(_0x14fba9)&&(_0x14fba9=_0x22476d);let _0x30282f=parseInt(_0x218a44(_0xb49923)['attr']('colspan'))||0x1,_0x16b578=parseInt(_0x218a44(_0xb49923)['attr'](_0x2c0cb5(0x1a2)))||0x1;_0x5b08bd[_0x377bc6]=_0x14fba9;(_0x30282f>0x1||_0x16b578>0x1)&&_0x312b21[_0x2c0cb5(0x199)]({'s':{'r':_0x2b3f59,'c':_0x377bc6},'e':{'r':_0x2b3f59+_0x16b578-0x1,'c':_0x377bc6+_0x30282f-0x1}});for(let _0x489e9b=0x0;_0x489e9b<_0x30282f;_0x489e9b++){_0x16b578>0x1&&(_0x4ffb3f[_0x377bc6+_0x489e9b]=_0x16b578-0x1);}_0x377bc6+=_0x30282f;}),_0x25b5d3[_0x21cd83(0x199)](_0x5b08bd);});const _0x39337d=XLSX['utils'][_0x59fd68(0x144)](),_0x50d0d1=XLSX['utils']['aoa_to_sheet'](_0x25b5d3);_0x312b21[_0x59fd68(0xb7)]>0x0&&(_0x50d0d1['!merges']=_0x312b21);_0x50d0d1['!cols']=_0x25b5d3[0x0][_0x59fd68(0x142)](()=>({'wpx':0x64})),XLSX[_0x59fd68(0x1b6)][_0x59fd68(0x1ab)](_0x39337d,_0x50d0d1,_0x59fd68(0xc3));const _0x598d05=XLSX[_0x59fd68(0x85)](_0x39337d,{'bookType':_0x59fd68(0x14b),'type':'buffer'});_0x3f80fe[_0x59fd68(0x140)](_0x59fd68(0xcc),_0x59fd68(0xd3)),_0x3f80fe[_0x59fd68(0x140)](_0x59fd68(0x1be),_0x59fd68(0x11d)),_0x3f80fe[_0x59fd68(0x182)](_0x598d05);}else pdf['create'](_0x2ffbbf,_0x41e11d)[_0x59fd68(0x1c6)](function(_0x29ce08,_0x42b3e7){const _0xf9f9c8=_0x59fd68;if(_0x29ce08){_0x3f80fe[_0xf9f9c8(0x1eb)](0x1f4)[_0xf9f9c8(0x182)](_0xf9f9c8(0x15e));return;}_0x3f80fe[_0xf9f9c8(0x140)]('Content-Type',_0xf9f9c8(0x1f3)),_0x42b3e7['pipe'](_0x3f80fe);});}),module['exports']=router;