const a0_0x47da6c=a0_0x46c7;(function(_0x4d5f91,_0x3b0995){const _0x325b=a0_0x46c7,_0x3dd94f=_0x4d5f91();while(!![]){try{const _0x349f89=parseInt(_0x325b(0x1fb))/0x1+parseInt(_0x325b(0x14f))/0x2*(-parseInt(_0x325b(0x17d))/0x3)+parseInt(_0x325b(0x157))/0x4*(-parseInt(_0x325b(0x247))/0x5)+parseInt(_0x325b(0x17c))/0x6*(-parseInt(_0x325b(0x257))/0x7)+-parseInt(_0x325b(0x1bb))/0x8*(-parseInt(_0x325b(0x234))/0x9)+parseInt(_0x325b(0x1c6))/0xa+parseInt(_0x325b(0x28f))/0xb*(parseInt(_0x325b(0x1d3))/0xc);if(_0x349f89===_0x3b0995)break;else _0x3dd94f['push'](_0x3dd94f['shift']());}catch(_0x213ee7){_0x3dd94f['push'](_0x3dd94f['shift']());}}}(a0_0x30ba,0x9b970));const express=require('express'),res=require(a0_0x47da6c(0x24e)),app=express(),router=express[a0_0x47da6c(0x16a)](),multer=require(a0_0x47da6c(0x1d2)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x47da6c(0x1ab)),auth=require(a0_0x47da6c(0x2aa)),users=require(a0_0x47da6c(0x2d6)),excelJS=require(a0_0x47da6c(0x21c)),XLSX=require(a0_0x47da6c(0x26f)),PDFDocument=require(a0_0x47da6c(0x19c)),fs=require('fs'),blobStream=require(a0_0x47da6c(0x290)),JsBarcode=require('jsbarcode'),{Canvas}=require(a0_0x47da6c(0x253)),pdf=require(a0_0x47da6c(0x163)),path=require('path'),mongoose=require(a0_0x47da6c(0x1c7)),cheerio=require('cheerio');router['get'](a0_0x47da6c(0x215),auth,async(_0x975234,_0x1cb5de)=>{const _0x5a07a5=a0_0x47da6c;try{const {username:_0x2be5ed,email:_0x30188c,role:_0x5d4f1a}=_0x975234['user'],_0x3a735e=_0x975234['user'],_0x3f4577=await profile[_0x5a07a5(0x23c)]({'email':_0x3a735e[_0x5a07a5(0x235)]}),_0x1b7c4f={'year':_0x5a07a5(0x181),'month':'long','day':_0x5a07a5(0x181)},_0x271022=await master_shop[_0x5a07a5(0x2b6)]();console[_0x5a07a5(0x22b)](_0x5a07a5(0x25d),_0x271022);const _0x151962=await product[_0x5a07a5(0x2b6)]();console[_0x5a07a5(0x22b)]('Products\x20find_data',_0x151962);const _0xf30f23=await warehouse[_0x5a07a5(0x288)]([{'$unwind':_0x5a07a5(0x263)},{'$lookup':{'from':_0x5a07a5(0x283),'localField':_0x5a07a5(0x24f),'foreignField':_0x5a07a5(0x29c),'as':_0x5a07a5(0x24d)}},{'$unwind':_0x5a07a5(0x27b)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x5a07a5(0x18a)}},{'$group':{'_id':_0x5a07a5(0x280),'product_stock':{'$sum':_0x5a07a5(0x177)}}}]);console[_0x5a07a5(0x22b)](_0x5a07a5(0x2a3),_0xf30f23),_0xf30f23[_0x5a07a5(0x1f3)](_0xb1aebf=>{const _0x24dcb9=_0x5a07a5,_0x349f7a=_0x151962[_0x24dcb9(0x29d)](_0x4fdc5c=>{const _0x2caa76=_0x24dcb9;_0x4fdc5c[_0x2caa76(0x29c)]==_0xb1aebf[_0x2caa76(0x28a)]&&(_0x4fdc5c[_0x2caa76(0x29a)]=parseInt(_0x4fdc5c[_0x2caa76(0x29a)])+parseInt(_0xb1aebf['product_stock']));});}),console[_0x5a07a5(0x22b)](_0x5a07a5(0x2d1),_0x151962);if(_0x271022[0x0]['language']=='English\x20(US)')var _0xcefedc=users['English'];else{if(_0x271022[0x0][_0x5a07a5(0x15f)]==_0x5a07a5(0x277))var _0xcefedc=users[_0x5a07a5(0x277)];else{if(_0x271022[0x0]['language']=='German')var _0xcefedc=users[_0x5a07a5(0x20b)];else{if(_0x271022[0x0][_0x5a07a5(0x15f)]=='Spanish')var _0xcefedc=users['Spanish'];else{if(_0x271022[0x0]['language']==_0x5a07a5(0x281))var _0xcefedc=users['French'];else{if(_0x271022[0x0][_0x5a07a5(0x15f)]==_0x5a07a5(0x227))var _0xcefedc=users[_0x5a07a5(0x25c)];else{if(_0x271022[0x0][_0x5a07a5(0x15f)]=='Chinese')var _0xcefedc=users['Chinese'];else{if(_0x271022[0x0]['language']==_0x5a07a5(0x25f))var _0xcefedc=users[_0x5a07a5(0x1cd)];}}}}}}}_0x1cb5de['render'](_0x5a07a5(0x199),{'success':_0x975234[_0x5a07a5(0x1c3)](_0x5a07a5(0x15d)),'errors':_0x975234[_0x5a07a5(0x1c3)](_0x5a07a5(0x2b3)),'alldata':_0x151962,'profile':_0x3f4577,'master_shop':_0x271022,'role':_0x3a735e,'product_stock':_0xf30f23,'language':_0xcefedc});}catch(_0x717a52){}});function a0_0x30ba(){const _0x469161=['aoa_to_sheet','text','Spanish','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','attachment;\x20filename=\x22sales_report.xlsx\x22','\x20-\x20HH','sales_ext','$NetPrice','getMonth','forEach','<th>Booking</th>','/agent_reports/sales_ad','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','bottom','$products.product_details.category','$sale_product.adj_discount','trim','942967RyEvqQ','/balance/pdf','border-top','$sale_product.prod_cat','$_id.dsi','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','<div\x20class=\x22col-sm-11\x22>','cat_brand','$product_info.name','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','<table>','$product_info.gross_price','amount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','rowspan','sales_reports','German','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','/inventory_sum/view','replace','test','status','Types','bank','user','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','/balance/view','\x20-\x20','border-bottom','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','$_id.category','DateTimeFormat','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','exceljs','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','isFG','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','$sales_info.name','$product','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','60mm','/dev/null','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','$due_date','Portuguese\x20(BR)','$cash','$sale_product.quantity','ObjectId','log','product_info','$product_info.product_code','$products','<tr>','totalPrice','Household','$discount','brandCount','2988ouseOG','email','utils','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','/agent_reports/view','isArray','sumqty','<th\x20rowspan=\x272\x27>Products</th>','findOne','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','$sales_info._id','<tbody>','<td\x20class=\x22cat_data\x22></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','$products.adj_discount','$_id.status_data','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$products.product_details.brand','305NmLzFA','$product.product_code','</div>','!merges','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<td\x20class=\x22row_data\x22>0</td>','product_docs','express/lib/response','product_details.product_name','<td\x20class=\x22row_data\x22>','Sales\x20Report','true','canvas','<td\x20colspan=\x223\x22><b>TOTAL<b>','totalGross','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','4963TfLYVj','includes','$date','$products.product_details','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','Portuguese','Products\x20master','top','Arabic\x20(ae)','\x20-\x20STD','thick','NetPrice','$product_details','sales_staff_id','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','$sale_product._id','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','en-US','!cols','$products.product_details.gross_price','border-left','$_id.customer','setHeader','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','xlsx','post','medium','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','Content-Disposition','window.print();','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','toLocaleString','Hindi','$product_details.product_name','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','$product_docs','create','$products.NetPrice','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<th\x20colspan=\x272\x27>SOLD</th>','$product_name','French','$sales_info','products','$sale_product.product_name','push','$sale_product.stock','15in','aggregate','dsi_sales','_id','toFixed','/agent/view','20mm','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','11LtqnjC','blob-stream','qty','$_id.date','sale_product.product_code','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','load','$totalGross','filter','$sale_product.product_code','product_details','stock','cash','name','map','prod_cat','catch','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','table\x20tr','Products\x20warehouse_data','sales_man_code','landscape','<div\x20style=\x22page-break-before:\x20always;\x22></div>','right','valueOf','<td\x20colspan=\x22','../middleware/auth','English\x20(US)','pipe','$check_no','referenceNumber','reduce','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','colspan','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','errors','split','<th>\x20INCOMING\x20</th>','find','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<th>\x20SALES\x20</th>','length','beg_bal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','buffer','NumberFormat','<div\x20\x20id=\x22table-conatainer\x22>','$name','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','$products.product_details.prod_id','write','000000','application/pdf','sort','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<script>','Content-Type','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','window.onload\x20=\x20function()\x20{','attr','toStream','book_new','/dsrr/pdf','$bank','customer','Products\x20find_data','each','<p>','$product_info.brand','$product_list.product_name','../public/language/languages.json','date_include','sales_bkg','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','get','<th>X-Truck</th>','$products.discount','$product.product_name','\x22><b>','$dsi','859822fOdsnh','8.5in','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','\x22><b></b></td>','</script>','<td\x20class=\x22cat_data\x22>','41684KFHhio','note','save','/total_sales_reports/view','<div\x20class=\x22row\x22>','sales_info','success','</td>','language','image','$product_code','<th>\x20ENDING\x20BALANCE\x20</th>','html-pdf','/agent_reports/pdf','<th\x20rowspan=\x272\x27>Category</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','then','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','Router','agent_sales','long','totalQty','/dsrr_admin/pdf_admin','<thead>','border-right','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','inventory_sum','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','findById','Chinese','adj_discount','$product_stock','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','book_append_sheet','$_id.brand','$product_info.category','8166zYyuvj','3YIocfR','<td\x20class=\x22row_data\x22></td>','$sales_staff_id','</b></td>','numeric','staffs','\x22\x20class=\x22cat_data\x22>','$customer','left','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','$status_data','dssr_view','$sale_product.real_qty_unit_val','$product_details.product_stock','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','$sale_product.isFG','html','$brand','<p>FINISHED\x20GOODS\x20INVENTORY</p>','/total_sales_reports/pdf','thin','$amount','category','excel','/dsrr_admin/view_data/:id','body','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','balanced','getDate','</tr>','pdfkit-table','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','$products.qty','td,\x20th','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','/dsrr/view','<td\x20class=\x22row_data\x22><b>','</thead>','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','toLocaleDateString','<p>SALES\x20REPORTS</p>','brand','slice','/agent_reports/pdf_admin','../models/all_models','Error\x20generating\x20PDF','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','0.1in','<h1>JAKA\x20EQUITIES\x20CORP</h1>','$product_info','$adj_discount','</table>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','product_stock','$product_list.product_code','English','<p>INVENTORY\x20SUMMARY</p>','check_no','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','11488PWZctS','attachment;\x20filename=\x22reports.xlsx\x22','render','discount','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','false','Letter','</th>','flash','dataqty','<th>\x20ITEM\x20CODE\x20</th>','9788450vkFMSI','mongoose','$sale_product.discount','product_code','No\x20data\x20was\x20Found!','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','Arabic','<th\x20rowspan=\x272\x27>Production</th>','getFullYear','$sale_product.totalprice','deleteOne','multer','3231276QsswGm','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','json','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','/reports/dsrr/view','PDF\x20Generation\x20Error:','error','date','$totalQty','send','dsi','dsi_sales_admin','format','$category','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','product_name','</tbody>','$sale_product','Standard','style'];a0_0x30ba=function(){return _0x469161;};return a0_0x30ba();}async function dataCheck(_0x59555b,_0x175beb){const _0x445e76=a0_0x47da6c,_0x3e08b4=await product[_0x445e76(0x288)]([{'$group':{'_id':{'brand':'$brand','category':_0x445e76(0x1e1)},'products':{'$push':{'name':'$name','product_code':_0x445e76(0x161)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x51e45a=[];_0x51e45a[_0x445e76(0x202)]=[];for(let _0x56f121=0x0;_0x56f121<=_0x3e08b4[_0x445e76(0x2b9)]-0x1;_0x56f121++){const _0x32e2c1=_0x3e08b4[_0x56f121];_0x51e45a[_0x445e76(0x202)]['push'](_0x32e2c1);}const _0x293e7c=await product[_0x445e76(0x288)]([{'$group':{'_id':{'category':_0x445e76(0x1e1)},'products':{'$push':{'brand':_0x445e76(0x18f),'product_code':_0x445e76(0x161),'product_name':_0x445e76(0x2bf)}}}},{'$sort':{'_id.category':-0x1}}]),_0x37e69d=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x59555b,'$lte':_0x175beb}}},{'$unwind':_0x445e76(0x221)},{'$group':{'_id':{'product_name':_0x445e76(0x14c),'product_code':_0x445e76(0x248)},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x51e45a[_0x445e76(0x2ba)]=[];for(let _0x33f0a3=0x0;_0x33f0a3<=_0x37e69d[_0x445e76(0x2b9)]-0x1;_0x33f0a3++){const _0x3b41b8=_0x37e69d[_0x33f0a3];_0x51e45a['beg_bal'][_0x445e76(0x285)](_0x3b41b8);}const _0x5b01f6=await sales_sa[_0x445e76(0x288)]([{'$match':{'date':{'$gte':_0x59555b,'$lte':_0x175beb}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x445e76(0x17f)}}},{'$lookup':{'from':_0x445e76(0x182),'localField':'sales_staff_id','foreignField':'_id','as':_0x445e76(0x15c)}},{'$unwind':_0x445e76(0x282)},{'$unwind':_0x445e76(0x1e5)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x445e76(0x284),'product_code':_0x445e76(0x298)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console[_0x445e76(0x22b)](_0x5b01f6[0x0]),_0x51e45a[_0x445e76(0x147)]=[];for(let _0x5764c5=0x0;_0x5764c5<=_0x5b01f6[_0x445e76(0x2b9)]-0x1;_0x5764c5++){const _0x2ee7fd=_0x5b01f6[_0x5764c5];_0x51e45a['sales_bkg'][_0x445e76(0x285)](_0x2ee7fd);}const _0x1fb8c0=await sales_sa[_0x445e76(0x288)]([{'$match':{'date':{'$gte':_0x59555b,'$lte':_0x175beb}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x445e76(0x17f)}}},{'$lookup':{'from':_0x445e76(0x182),'localField':_0x445e76(0x264),'foreignField':'_id','as':'sales_info'}},{'$unwind':_0x445e76(0x282)},{'$unwind':_0x445e76(0x1e5)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':'false'}},{'$group':{'_id':{'product_name':_0x445e76(0x284),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x445e76(0x189)}}}]);_0x51e45a[_0x445e76(0x1f0)]=[];for(let _0x468bf7=0x0;_0x468bf7<=_0x1fb8c0[_0x445e76(0x2b9)]-0x1;_0x468bf7++){const _0x5406c7=_0x1fb8c0[_0x468bf7];_0x51e45a[_0x445e76(0x1f0)][_0x445e76(0x285)](_0x5406c7);}let _0x46ffb4='';for(let _0xfc7721=0x0;_0xfc7721<=_0x293e7c['length']-0x1;_0xfc7721++){const _0x365590=_0x293e7c[_0xfc7721];_0x46ffb4+=_0x445e76(0x22f),_0x46ffb4+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x365590[_0x445e76(0x28a)]['category']+_0x445e76(0x15e),_0x46ffb4+=_0x445e76(0x19b);for(let _0x78ae81=0x0;_0x78ae81<_0x51e45a['cat_brand'][_0x445e76(0x2b9)];_0x78ae81++){const _0x120530=_0x51e45a[_0x445e76(0x202)][_0x78ae81];if(_0x120530[_0x445e76(0x28a)][_0x445e76(0x194)]==_0x365590[_0x445e76(0x28a)]['category']){let _0x1b29d1=[],_0x44904e=[],_0x1c0d2f=[];_0x1b29d1[_0x120530[_0x445e76(0x28a)][_0x445e76(0x1a8)]]=[],_0x44904e[_0x120530[_0x445e76(0x28a)]['brand']]=[],_0x1c0d2f[_0x120530[_0x445e76(0x28a)][_0x445e76(0x1a8)]]=[];var _0x26c59e=0x0,_0xc7a619=0x0,_0x44127d=0x0;for(let _0xc84bf2=0x0;_0xc84bf2<_0x120530[_0x445e76(0x283)][_0x445e76(0x2b9)];_0xc84bf2++){const _0x55e086=_0x120530['products'][_0xc84bf2];for(let _0xbdd424=0x0;_0xbdd424<=_0x51e45a['beg_bal'][_0x445e76(0x2b9)]-0x1;_0xbdd424++){const _0x2e3348=_0x51e45a['beg_bal'][_0xbdd424];_0x2e3348[_0x445e76(0x28a)][_0x445e76(0x1e3)]==_0x55e086[_0x445e76(0x29c)]&&_0x2e3348[_0x445e76(0x28a)][_0x445e76(0x1c9)]==_0x55e086[_0x445e76(0x1c9)]&&(_0x26c59e+=parseInt(_0x2e3348['totalQTY'],0xa));}for(let _0xb96853=0x0;_0xb96853<=_0x51e45a[_0x445e76(0x1f0)][_0x445e76(0x2b9)]-0x1;_0xb96853++){const _0x256ba9=_0x51e45a[_0x445e76(0x1f0)][_0xb96853];_0x256ba9[_0x445e76(0x28a)][_0x445e76(0x1e3)]==_0x55e086['name']&&_0x256ba9[_0x445e76(0x28a)][_0x445e76(0x1c9)]==_0x55e086[_0x445e76(0x1c9)]&&(_0xc7a619+=parseFloat(_0x256ba9['totalQTY'],0xa)['toFixed'](0x2));}for(let _0x6e25f0=0x0;_0x6e25f0<=_0x51e45a['sales_bkg']['length']-0x1;_0x6e25f0++){const _0x119790=_0x51e45a['sales_bkg'][_0x6e25f0];_0x119790[_0x445e76(0x28a)][_0x445e76(0x1e3)]==_0x55e086[_0x445e76(0x29c)]&&_0x119790['_id'][_0x445e76(0x1c9)]==_0x55e086['product_code']&&(_0x44127d+=parseInt(_0x119790['totalQTY'],0xa));}}const _0x2c1ad3=new Intl[(_0x445e76(0x2bd))]('en-US');var _0x10aa8b=_0x2c1ad3[_0x445e76(0x1e0)](_0x26c59e);_0x1b29d1[_0x120530[_0x445e76(0x28a)][_0x445e76(0x1a8)]][_0x445e76(0x285)](_0x10aa8b),_0x44904e[_0x120530['_id'][_0x445e76(0x1a8)]][_0x445e76(0x285)](_0x2c1ad3[_0x445e76(0x1e0)](_0xc7a619)),_0x1c0d2f[_0x120530[_0x445e76(0x28a)][_0x445e76(0x1a8)]][_0x445e76(0x285)](_0x2c1ad3[_0x445e76(0x1e0)](_0x44127d));var _0x4ca263=_0x2c1ad3[_0x445e76(0x1e0)](_0x26c59e-(_0x44127d+_0xc7a619));_0x46ffb4+=_0x445e76(0x22f),_0x46ffb4+=_0x445e76(0x17e),_0x46ffb4+=_0x445e76(0x250)+_0x120530[_0x445e76(0x28a)][_0x445e76(0x1a8)]+_0x445e76(0x15e),_0x46ffb4+=_0x445e76(0x250)+_0x1b29d1[_0x120530['_id']['brand']][0x0]+_0x445e76(0x15e),_0x46ffb4+=_0x445e76(0x24c),_0x46ffb4+=_0x445e76(0x250)+_0x1c0d2f[_0x120530[_0x445e76(0x28a)][_0x445e76(0x1a8)]][0x0]+_0x445e76(0x15e),_0x46ffb4+=_0x445e76(0x250)+_0x44904e[_0x120530[_0x445e76(0x28a)][_0x445e76(0x1a8)]][0x0]+_0x445e76(0x15e),_0x46ffb4+=_0x445e76(0x250)+_0x4ca263+'</td>',_0x46ffb4+=_0x445e76(0x19b);}}}return console[_0x445e76(0x22b)](_0x51e45a[_0x445e76(0x147)]),_0x46ffb4;}router[a0_0x47da6c(0x270)](a0_0x47da6c(0x1fc),auth,async(_0x7dd93,_0x3b10fc)=>{const _0xde5a6c=a0_0x47da6c,{from_date:_0x3228b0,to_date:_0x4312c2}=_0x7dd93[_0xde5a6c(0x197)],_0x229508=await dataCheck(_0x3228b0,_0x4312c2);{}let _0x27ef24=_0xde5a6c(0x267);var _0x1a875d=new Date(_0x3228b0),_0xd8dff2=new Date(_0x4312c2);const _0x297770={'year':_0xde5a6c(0x181),'month':_0xde5a6c(0x16c),'day':_0xde5a6c(0x181)},_0x4ea9da=new Intl['DateTimeFormat'](_0xde5a6c(0x268),_0x297770)[_0xde5a6c(0x1e0)](_0x1a875d),_0x513de4=new Intl['DateTimeFormat']('en-US',_0x297770)[_0xde5a6c(0x1e0)](_0xd8dff2);_0x27ef24+=_0xde5a6c(0x1af),_0x27ef24+=_0xde5a6c(0x190),_0x27ef24+=_0xde5a6c(0x2d3)+_0x4ea9da+'\x20-\x20'+_0x513de4+'</p>',_0x27ef24+=_0xde5a6c(0x15b),_0x27ef24+=_0xde5a6c(0x201),_0x27ef24+='<table>',_0x27ef24+=_0xde5a6c(0x22f),_0x27ef24+=_0xde5a6c(0x165),_0x27ef24+=_0xde5a6c(0x23b),_0x27ef24+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x4ea9da+_0xde5a6c(0x1c2),_0x27ef24+=_0xde5a6c(0x1ce),_0x27ef24+=_0xde5a6c(0x27f),_0x27ef24+=_0xde5a6c(0x21f)+_0x513de4+'</th>',_0x27ef24+=_0xde5a6c(0x19b),_0x27ef24+='<tr>',_0x27ef24+=_0xde5a6c(0x1f4),_0x27ef24+=_0xde5a6c(0x14a),_0x27ef24+='</tr>',_0x27ef24+=_0x229508,_0x27ef24+=_0xde5a6c(0x1b2),_0x27ef24+=_0xde5a6c(0x249),_0x27ef24+=_0xde5a6c(0x249);const _0x228f97={'format':_0xde5a6c(0x1c1),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0xde5a6c(0x224)}}};pdf[_0xde5a6c(0x27c)](_0x27ef24,_0x228f97)[_0xde5a6c(0x2cc)](function(_0x28fd5b,_0x1839b0){const _0x300489=_0xde5a6c;if(_0x28fd5b){_0x3b10fc[_0x300489(0x210)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x3b10fc[_0x300489(0x26d)](_0x300489(0x2c8),_0x300489(0x2c4)),_0x1839b0[_0x300489(0x2ac)](_0x3b10fc);});}),router[a0_0x47da6c(0x149)](a0_0x47da6c(0x28c),auth,async(_0x137eb2,_0x310300)=>{const _0x53efb7=a0_0x47da6c;try{const {username:_0x592cfd,email:_0x3d59f6,role:_0x5c465e}=_0x137eb2[_0x53efb7(0x213)],_0x1c312d=_0x137eb2['user'],_0x156a91=await profile[_0x53efb7(0x23c)]({'email':_0x1c312d[_0x53efb7(0x235)]}),_0x21c422={'year':_0x53efb7(0x181),'month':'long','day':'numeric'},_0xf2f60f=await master_shop[_0x53efb7(0x2b6)](),_0x91b158=await product['find'](),_0x465a47=await warehouse[_0x53efb7(0x288)]([{'$unwind':_0x53efb7(0x263)},{'$lookup':{'from':_0x53efb7(0x283),'localField':'product_details.product_name','foreignField':'name','as':_0x53efb7(0x24d)}},{'$unwind':_0x53efb7(0x27b)},{'$project':{'product_name':_0x53efb7(0x278),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x53efb7(0x280),'product_stock':{'$sum':_0x53efb7(0x177)}}}]);if(_0xf2f60f[0x0][_0x53efb7(0x15f)]=='English\x20(US)')var _0x3c4fa2=users[_0x53efb7(0x1b7)];else{if(_0xf2f60f[0x0][_0x53efb7(0x15f)]=='Hindi')var _0x3c4fa2=users['Hindi'];else{if(_0xf2f60f[0x0]['language']==_0x53efb7(0x20b))var _0x3c4fa2=users[_0x53efb7(0x20b)];else{if(_0xf2f60f[0x0]['language']=='Spanish')var _0x3c4fa2=users['Spanish'];else{if(_0xf2f60f[0x0][_0x53efb7(0x15f)]==_0x53efb7(0x281))var _0x3c4fa2=users[_0x53efb7(0x281)];else{if(_0xf2f60f[0x0][_0x53efb7(0x15f)]==_0x53efb7(0x227))var _0x3c4fa2=users[_0x53efb7(0x25c)];else{if(_0xf2f60f[0x0][_0x53efb7(0x15f)]==_0x53efb7(0x175))var _0x3c4fa2=users['Chinese'];else{if(_0xf2f60f[0x0][_0x53efb7(0x15f)]==_0x53efb7(0x25f))var _0x3c4fa2=users['Arabic'];}}}}}}}_0x310300[_0x53efb7(0x1bd)](_0x53efb7(0x16b),{'success':_0x137eb2[_0x53efb7(0x1c3)]('success'),'errors':_0x137eb2[_0x53efb7(0x1c3)](_0x53efb7(0x2b3)),'alldata':_0x91b158,'profile':_0x156a91,'master_shop':_0xf2f60f,'role':_0x1c312d,'product_stock':_0x465a47,'language':_0x3c4fa2});}catch(_0x45a882){}});async function agentsdataCheck(_0x37a9ef,_0x4ccb85){const _0x785947=a0_0x47da6c,_0x13e463=await product['aggregate']([{'$group':{'_id':{'brand':_0x785947(0x18f),'category':_0x785947(0x1e1)},'products':{'$push':{'name':_0x785947(0x2bf),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x170dd5=[];_0x170dd5[_0x785947(0x202)]=[];for(let _0x1a2121=0x0;_0x1a2121<=_0x13e463[_0x785947(0x2b9)]-0x1;_0x1a2121++){const _0x3a454b=_0x13e463[_0x1a2121];_0x170dd5[_0x785947(0x202)][_0x785947(0x285)](_0x3a454b);}const _0x9e97af=await product[_0x785947(0x288)]([{'$group':{'_id':{'category':_0x785947(0x1e1)},'products':{'$push':{'brand':_0x785947(0x18f),'product_code':_0x785947(0x161),'product_name':_0x785947(0x2bf)}}}},{'$sort':{'_id.category':-0x1}}]),_0x28ccb6=await product[_0x785947(0x288)]([{'$group':{'_id':{'category':'$category','brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5349ba=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x37a9ef,'$lte':_0x4ccb85}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x785947(0x17f)}}},{'$lookup':{'from':_0x785947(0x182),'localField':_0x785947(0x264),'foreignField':'_id','as':'sales_info'}},{'$unwind':'$sales_info'},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x785947(0x1c0)}},{'$lookup':{'from':_0x785947(0x283),'localField':_0x785947(0x293),'foreignField':_0x785947(0x1c9),'as':'product_info'}},{'$unwind':_0x785947(0x1b0)},{'$group':{'_id':{'sales_id':_0x785947(0x23e),'category':_0x785947(0x17b),'brand':'$product_info.brand'},'salesman_data':{'$first':_0x785947(0x220)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','product_details':{'prod_name':'$product_info.name','product_code':_0x785947(0x22d),'category':_0x785947(0x17b),'brand':_0x785947(0x2d4)}}}}}]);let _0x2dd1a1='';_0x2dd1a1+='<tr>',_0x2dd1a1+=_0x785947(0x256),_0x2dd1a1+=_0x785947(0x19b),_0x2dd1a1+=_0x785947(0x22f),_0x2dd1a1+=_0x785947(0x240);for(let _0x234dfa=0x0;_0x234dfa<=_0x9e97af[_0x785947(0x2b9)]-0x1;_0x234dfa++){const _0x3a24d8=_0x9e97af[_0x234dfa];for(let _0x39bec5=0x0;_0x39bec5<_0x28ccb6[_0x785947(0x2b9)];_0x39bec5++){const _0x3d91ab=_0x28ccb6[_0x39bec5];_0x3d91ab[_0x785947(0x28a)]==_0x3a24d8['_id'][_0x785947(0x194)]&&(_0x2dd1a1+='<td\x20colspan=\x22'+_0x3d91ab['brandCount']+_0x785947(0x183)+_0x3a24d8[_0x785947(0x28a)]['category']+_0x785947(0x15e));}}_0x2dd1a1+=_0x785947(0x240),_0x2dd1a1+=_0x785947(0x19b),_0x2dd1a1+=_0x785947(0x22f),_0x2dd1a1+=_0x785947(0x214);for(let _0x4db0eb=0x0;_0x4db0eb<=_0x9e97af['length']-0x1;_0x4db0eb++){const _0x556db5=_0x9e97af[_0x4db0eb];for(let _0x58ae16=0x0;_0x58ae16<_0x170dd5[_0x785947(0x202)][_0x785947(0x2b9)];_0x58ae16++){const _0x39b7ac=_0x170dd5[_0x785947(0x202)][_0x58ae16];_0x39b7ac[_0x785947(0x28a)]['category']==_0x556db5['_id'][_0x785947(0x194)]&&(_0x2dd1a1+=_0x785947(0x156)+_0x39b7ac[_0x785947(0x28a)]['brand']+'</td>');}}_0x2dd1a1+=_0x785947(0x26e),_0x2dd1a1+=_0x785947(0x19b);let _0x2cd281={'name':[],'dataqty':{}};for(let _0x24ef66=0x0;_0x24ef66<_0x170dd5['cat_brand'][_0x785947(0x2b9)];_0x24ef66++){const _0x11eddf=_0x170dd5[_0x785947(0x202)][_0x24ef66],_0x203321=_0x11eddf[_0x785947(0x28a)][_0x785947(0x1a8)],_0x40fe5f=_0x11eddf[_0x785947(0x28a)][_0x785947(0x194)];!_0x2cd281['dataqty'][_0x203321]&&(_0x2cd281[_0x785947(0x1c4)][_0x203321]={});!_0x2cd281[_0x785947(0x1c4)][_0x203321][_0x40fe5f]&&(_0x2cd281[_0x785947(0x1c4)][_0x203321][_0x40fe5f]=[]);for(let _0x2d8523=0x0;_0x2d8523<_0x5349ba[_0x785947(0x2b9)];_0x2d8523++){const _0x215440=_0x5349ba[_0x2d8523];if(_0x203321===_0x215440[_0x785947(0x28a)][_0x785947(0x1a8)]&&_0x40fe5f===_0x215440[_0x785947(0x28a)][_0x785947(0x194)]){const _0x1472b9=_0x215440['salesman_data'];!_0x2cd281[_0x785947(0x1c4)][_0x203321][_0x40fe5f][_0x1472b9]&&(_0x2cd281[_0x785947(0x1c4)][_0x203321][_0x40fe5f][_0x1472b9]=[]),_0x2cd281[_0x785947(0x1c4)][_0x203321][_0x40fe5f][_0x1472b9][_0x785947(0x285)](_0x215440['totalQTY']),!_0x2cd281['name'][_0x785947(0x258)](_0x1472b9)&&_0x2cd281[_0x785947(0x29c)][_0x785947(0x285)](_0x1472b9);}}}_0x2dd1a1+=_0x785947(0x22f);for(let _0x2c4b0b=0x0;_0x2c4b0b<=_0x2cd281[_0x785947(0x29c)]['length']-0x1;_0x2c4b0b++){const _0x1c694c=_0x2cd281[_0x785947(0x29c)][_0x2c4b0b];_0x2dd1a1+='<td\x20class=\x22row_data\x22>'+_0x1c694c+'</td>';var _0x40ce2c=0x0,_0x2ef052=0x0;for(let _0x34b68e=0x0;_0x34b68e<=_0x170dd5['cat_brand'][_0x785947(0x2b9)]-0x1;_0x34b68e++){const _0x2bebde=_0x170dd5[_0x785947(0x202)][_0x34b68e];var _0x36da92=0x0;_0x2cd281[_0x785947(0x1c4)][_0x2bebde[_0x785947(0x28a)][_0x785947(0x1a8)]][_0x2bebde[_0x785947(0x28a)]['category']][_0x1c694c]?(_0x36da92=_0x2cd281[_0x785947(0x1c4)][_0x2bebde[_0x785947(0x28a)][_0x785947(0x1a8)]][_0x2bebde[_0x785947(0x28a)][_0x785947(0x194)]][_0x1c694c][0x0],_0x2dd1a1+=_0x785947(0x250)+formatNumber(_0x36da92[_0x785947(0x28b)](0x2))+_0x785947(0x15e)):(_0x36da92=0x0,_0x2dd1a1+=_0x785947(0x250)+_0x36da92+_0x785947(0x15e)),_0x40ce2c+=_0x36da92;}_0x2dd1a1+=_0x785947(0x250)+formatNumber(_0x40ce2c[_0x785947(0x28b)](0x2))+_0x785947(0x15e);}return _0x2dd1a1+=_0x785947(0x19b),_0x2dd1a1;}router['post']('/agent/pdf',auth,async(_0x3a1cb8,_0x3df067)=>{const _0x2a6678=a0_0x47da6c,{from_date:_0x178ebe,to_date:_0x2c933e}=_0x3a1cb8[_0x2a6678(0x197)],_0x548859=await agentsdataCheck(_0x178ebe,_0x2c933e);{}let _0x4fc398=_0x2a6678(0x2c9);var _0x8ba1af=new Date(_0x178ebe),_0x4565b7=new Date(_0x2c933e);const _0x3e9e49={'year':_0x2a6678(0x181),'month':_0x2a6678(0x16c),'day':_0x2a6678(0x181)},_0x67023=new Intl[(_0x2a6678(0x21a))](_0x2a6678(0x268),_0x3e9e49)['format'](_0x8ba1af),_0x166b44=new Intl[(_0x2a6678(0x21a))](_0x2a6678(0x268),_0x3e9e49)[_0x2a6678(0x1e0)](_0x4565b7);_0x4fc398+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x4fc398+=_0x2a6678(0x1a7),_0x4fc398+=_0x2a6678(0x2d3)+_0x67023+_0x2a6678(0x216)+_0x166b44+'</p>',_0x4fc398+='<div\x20class=\x22row\x22>',_0x4fc398+=_0x2a6678(0x201),_0x4fc398+=_0x2a6678(0x205),_0x4fc398+=_0x548859,_0x4fc398+='</table>',_0x4fc398+=_0x2a6678(0x249),_0x4fc398+=_0x2a6678(0x249);const _0x2f580d={'format':_0x2a6678(0x1c1),'orientation':_0x2a6678(0x2a5),'childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf['create'](_0x4fc398,_0x2f580d)[_0x2a6678(0x2cc)](function(_0x2b45be,_0x195b1a){const _0x2ebca8=_0x2a6678;if(_0x2b45be){_0x3df067[_0x2ebca8(0x210)](0x1f4)[_0x2ebca8(0x1dd)](_0x2ebca8(0x1ac));return;}_0x3df067[_0x2ebca8(0x26d)](_0x2ebca8(0x2c8),_0x2ebca8(0x2c4)),_0x195b1a[_0x2ebca8(0x2ac)](_0x3df067);});}),router[a0_0x47da6c(0x149)](a0_0x47da6c(0x1f5),auth,async(_0x46309e,_0x2407e8)=>{const _0x2c5fc6=a0_0x47da6c;try{const {username:_0x52e572,email:_0x4cf5c0,role:_0x4496e9}=_0x46309e[_0x2c5fc6(0x213)],_0x106b69=_0x46309e[_0x2c5fc6(0x213)],_0x2ceed2=await profile[_0x2c5fc6(0x23c)]({'email':_0x106b69[_0x2c5fc6(0x235)]}),_0x2262af={'year':'numeric','month':_0x2c5fc6(0x16c),'day':_0x2c5fc6(0x181)},_0x2e9eca=await master_shop[_0x2c5fc6(0x2b6)](),_0xa3ba8a=await staff[_0x2c5fc6(0x23c)]({'email':_0x106b69['email']}),_0x162093=await product[_0x2c5fc6(0x2b6)](),_0x387d0b=await warehouse[_0x2c5fc6(0x288)]([{'$unwind':_0x2c5fc6(0x263)},{'$lookup':{'from':_0x2c5fc6(0x283),'localField':_0x2c5fc6(0x24f),'foreignField':_0x2c5fc6(0x29c),'as':_0x2c5fc6(0x24d)}},{'$unwind':_0x2c5fc6(0x27b)},{'$project':{'product_name':_0x2c5fc6(0x278),'product_stock':_0x2c5fc6(0x18a)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2c5fc6(0x177)}}}]),_0x5889aa=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x2e9eca[0x0][_0x2c5fc6(0x15f)]==_0x2c5fc6(0x2ab))var _0x55d2ec=users[_0x2c5fc6(0x1b7)];else{if(_0x2e9eca[0x0]['language']=='Hindi')var _0x55d2ec=users[_0x2c5fc6(0x277)];else{if(_0x2e9eca[0x0][_0x2c5fc6(0x15f)]==_0x2c5fc6(0x20b))var _0x55d2ec=users[_0x2c5fc6(0x20b)];else{if(_0x2e9eca[0x0]['language']=='Spanish')var _0x55d2ec=users[_0x2c5fc6(0x1ea)];else{if(_0x2e9eca[0x0]['language']=='French')var _0x55d2ec=users[_0x2c5fc6(0x281)];else{if(_0x2e9eca[0x0][_0x2c5fc6(0x15f)]=='Portuguese\x20(BR)')var _0x55d2ec=users[_0x2c5fc6(0x25c)];else{if(_0x2e9eca[0x0]['language']==_0x2c5fc6(0x175))var _0x55d2ec=users['Chinese'];else{if(_0x2e9eca[0x0][_0x2c5fc6(0x15f)]==_0x2c5fc6(0x25f))var _0x55d2ec=users['Arabic'];}}}}}}}_0x2407e8[_0x2c5fc6(0x1bd)](_0x2c5fc6(0x1df),{'success':_0x46309e[_0x2c5fc6(0x1c3)]('success'),'errors':_0x46309e[_0x2c5fc6(0x1c3)](_0x2c5fc6(0x2b3)),'alldata':_0x162093,'profile':_0x2ceed2,'master_shop':_0x2e9eca,'role':_0x106b69,'product_stock':_0x387d0b,'language':_0x55d2ec,'staff_arr':_0xa3ba8a,'staff_data_all':_0x5889aa});}catch(_0x555fe1){_0x2407e8[_0x2c5fc6(0x1d6)](_0x555fe1);}});async function agentsdataDSICheck_admin(_0x429f7b,_0x133f9b,_0x112a4d,_0x194e2b){const _0x3ecdb7=a0_0x47da6c,_0xf7a4c9=await product[_0x3ecdb7(0x288)]([{'$group':{'_id':{'brand':_0x3ecdb7(0x18f),'category':_0x3ecdb7(0x1e1)},'products':{'$push':{'name':_0x3ecdb7(0x2bf),'product_code':_0x3ecdb7(0x161)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1284d2=[];_0x1284d2['cat_brand']=[];for(let _0x322bfc=0x0;_0x322bfc<=_0xf7a4c9[_0x3ecdb7(0x2b9)]-0x1;_0x322bfc++){const _0x5a8da8=_0xf7a4c9[_0x322bfc];_0x1284d2[_0x3ecdb7(0x202)][_0x3ecdb7(0x285)](_0x5a8da8);}const _0x664e88=await product[_0x3ecdb7(0x288)]([{'$group':{'_id':{'category':_0x3ecdb7(0x1e1)},'products':{'$push':{'brand':_0x3ecdb7(0x18f),'product_code':_0x3ecdb7(0x161),'product_name':_0x3ecdb7(0x2bf)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4d0fda=await product[_0x3ecdb7(0x288)]([{'$group':{'_id':{'category':'$category','brand':_0x3ecdb7(0x18f)}}},{'$group':{'_id':_0x3ecdb7(0x219),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x36a1f8=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x429f7b,'$lte':_0x133f9b},'sales_staff_id':_0x112a4d,'sale_product.isFG':_0x3ecdb7(0x1c0)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x3ecdb7(0x283),'localField':'sale_product.product_code','foreignField':_0x3ecdb7(0x1c9),'as':_0x3ecdb7(0x22c)}},{'$unwind':_0x3ecdb7(0x1b0)},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':_0x3ecdb7(0x184)},'totalQty':{'$sum':_0x3ecdb7(0x189)},'products':{'$push':{'qty':_0x3ecdb7(0x189),'NetPrice':_0x3ecdb7(0x1d0),'discount':_0x3ecdb7(0x1c8),'adj_discount':_0x3ecdb7(0x1f9),'product_details':{'prod_name':_0x3ecdb7(0x203),'product_code':'$product_info.product_code','category':_0x3ecdb7(0x17b),'brand':_0x3ecdb7(0x2d4),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x3ecdb7(0x1ff),'date':_0x3ecdb7(0x292),'customer':'$_id.customer','category':_0x3ecdb7(0x1f8),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x3ecdb7(0x19e)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x3ecdb7(0x26a)]}},'NetPrice':{'$sum':_0x3ecdb7(0x27d)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x3ecdb7(0x243)},'product_details':{'$first':_0x3ecdb7(0x25a)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3ecdb7(0x292),'customer':_0x3ecdb7(0x26c)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x3ecdb7(0x296)},'NetPrice':{'$sum':_0x3ecdb7(0x1f1)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x3ecdb7(0x1b1)},'products':{'$push':{'qty':_0x3ecdb7(0x1dc),'category':_0x3ecdb7(0x219),'brand':_0x3ecdb7(0x17a),'product_details':_0x3ecdb7(0x263)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x348635=[],_0x26fb15={},_0x2b276c={},_0x130811={};var _0xc96dfb=0x0,_0x21f401=0x0,_0x20f817=0x0,_0x419988=0x0,_0x4071e5=0x0;const _0x3b8156=0x6;for(let _0x4ac4f1=0x0;_0x4ac4f1<=_0x36a1f8[_0x3ecdb7(0x2b9)]-0x1;_0x4ac4f1++){const _0x12832c=_0x36a1f8[_0x4ac4f1];let _0x283e35=_0x3ecdb7(0x22f);_0x283e35+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x12832c[_0x3ecdb7(0x28a)][_0x3ecdb7(0x1de)]+'</td>',_0x283e35+=_0x3ecdb7(0x166)+_0x12832c[_0x3ecdb7(0x28a)][_0x3ecdb7(0x1db)]+_0x3ecdb7(0x15e),_0x283e35+=_0x3ecdb7(0x166)+_0x12832c['_id'][_0x3ecdb7(0x2d0)]+_0x3ecdb7(0x15e);let _0x5d3f8d={};var _0x21af8e=0x0;for(let _0x19d68c=0x0;_0x19d68c<=_0x12832c['products'][_0x3ecdb7(0x2b9)]-0x1;_0x19d68c++){const _0x3ee379=_0x12832c[_0x3ecdb7(0x283)][_0x19d68c];_0x5d3f8d[_0x3ee379['brand']+'-'+_0x3ee379[_0x3ecdb7(0x194)]]=_0x3ee379[_0x3ecdb7(0x291)];const _0x38f8ff=_0x3ee379['brand']+'-'+_0x3ee379[_0x3ecdb7(0x194)];!_0x26fb15[_0x38f8ff]&&(_0x26fb15[_0x38f8ff]=0x0),!Array[_0x3ecdb7(0x239)](_0x130811[_0x38f8ff])&&(_0x130811[_0x38f8ff]=[]),!Array[_0x3ecdb7(0x239)](_0x130811[_0x38f8ff])&&(_0x130811[_0x38f8ff]=[]),_0x26fb15[_0x38f8ff]+=_0x3ee379[_0x3ecdb7(0x291)],_0x130811[_0x38f8ff]['push'](_0x3ee379['qty']),_0x21af8e++;}console[_0x3ecdb7(0x22b)](_0x12832c);for(let _0x471e9e=0x0;_0x471e9e<=_0x1284d2[_0x3ecdb7(0x202)][_0x3ecdb7(0x2b9)]-0x1;_0x471e9e++){const _0x26f74f=_0x1284d2[_0x3ecdb7(0x202)][_0x471e9e],_0xfc8c43=_0x26f74f[_0x3ecdb7(0x28a)]['brand']+'-'+_0x26f74f[_0x3ecdb7(0x28a)][_0x3ecdb7(0x194)];_0x283e35+=_0x3ecdb7(0x169)+(_0x5d3f8d[_0xfc8c43]!==undefined?_0x5d3f8d[_0xfc8c43][_0x3ecdb7(0x28b)](0x2):'')+_0x3ecdb7(0x15e);}_0x20f817=_0x12832c[_0x3ecdb7(0x1be)]+_0x12832c[_0x3ecdb7(0x176)],_0x283e35+=_0x3ecdb7(0x20c)+formatNumber(parseFloat(_0x12832c[_0x3ecdb7(0x16d)],0x2)[_0x3ecdb7(0x28b)](0x2))+_0x3ecdb7(0x15e),_0x283e35+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x12832c[_0x3ecdb7(0x255)]['toFixed'](0x2))+_0x3ecdb7(0x15e),_0x283e35+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x20f817)+'</td>',_0x283e35+=_0x3ecdb7(0x20c)+formatNumber(_0x12832c[_0x3ecdb7(0x262)][_0x3ecdb7(0x28b)](0x2))+_0x3ecdb7(0x15e),_0x283e35+=_0x3ecdb7(0x19b),_0xc96dfb+=parseFloat(_0x12832c[_0x3ecdb7(0x16d)][_0x3ecdb7(0x28b)](0x2)),_0x21f401+=parseFloat(_0x12832c[_0x3ecdb7(0x262)][_0x3ecdb7(0x28b)](0x2)),_0x419988+=_0x20f817,_0x4071e5+=parseFloat(_0x12832c[_0x3ecdb7(0x255)][_0x3ecdb7(0x28b)](0x2));if(_0x4ac4f1==_0x36a1f8['length']-0x1){_0x283e35+='<tr>',_0x283e35+=_0x3ecdb7(0x254),_0x283e35+=_0x3ecdb7(0x15e);for(let _0x5b5720=0x0;_0x5b5720<=_0x1284d2['cat_brand']['length']-0x1;_0x5b5720++){const _0x3c58db=_0x1284d2['cat_brand'][_0x5b5720],_0x326fd4=_0x3c58db[_0x3ecdb7(0x28a)][_0x3ecdb7(0x1a8)]+'-'+_0x3c58db['_id'][_0x3ecdb7(0x194)],_0x5ddbf9=_0x130811[_0x326fd4]['reduce']((_0x3245c7,_0x1a708d)=>_0x3245c7+_0x1a708d,0x0);console[_0x3ecdb7(0x22b)](_0x3ecdb7(0x20f),_0x326fd4),_0x283e35+=_0x3ecdb7(0x21b)+(_0x5ddbf9!==undefined?formatNumber(_0x5ddbf9[_0x3ecdb7(0x28b)](0x2)):'')+_0x3ecdb7(0x180),console['log'](_0x130811[_0x326fd4][_0x3ecdb7(0x2af)]((_0xa16612,_0x2d53fc)=>_0xa16612+_0x2d53fc,0x0));}_0x283e35+=_0x3ecdb7(0x1f6)+formatNumber(_0xc96dfb['toFixed'](0x2))+_0x3ecdb7(0x180),_0x283e35+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4071e5)+_0x3ecdb7(0x180),_0x283e35+=_0x3ecdb7(0x1f6)+formatNumber(_0x419988)+_0x3ecdb7(0x180),_0x283e35+=_0x3ecdb7(0x1f6)+formatNumber(_0x21f401)+'</b></td>',_0x283e35+=_0x3ecdb7(0x19b);}_0x348635[_0x3ecdb7(0x285)](_0x283e35);}function _0x50dc9e(_0x144a33,_0x334e79){const _0x36f846=_0x3ecdb7,_0x3930f0=[];for(let _0x167b11=0x0;_0x167b11<=_0x144a33['length']-0x1;_0x167b11+=_0x334e79){_0x3930f0[_0x36f846(0x285)](_0x144a33[_0x36f846(0x1a9)](_0x167b11,_0x167b11+_0x334e79));}return _0x3930f0;}const _0x381e8a=_0x50dc9e(_0x348635,_0x3b8156);let _0x4d8f81='';return _0x381e8a[_0x3ecdb7(0x1f3)]((_0x46f1ef,_0x222fbe)=>{const _0x250bc6=_0x3ecdb7;_0x222fbe>0x0&&(_0x4d8f81+=_0x250bc6(0x2a6));_0x4d8f81+='<table>',_0x4d8f81+=_0x250bc6(0x16f),_0x4d8f81+=_0x250bc6(0x22f),_0x4d8f81+=_0x250bc6(0x1ba),_0x4d8f81+=_0x250bc6(0x19b),_0x4d8f81+='<tr>',_0x4d8f81+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x1339fd=0x0;_0x1339fd<=_0x664e88[_0x250bc6(0x2b9)]-0x1;_0x1339fd++){const _0x264b85=_0x664e88[_0x1339fd];for(let _0x399127=0x0;_0x399127<_0x4d0fda[_0x250bc6(0x2b9)];_0x399127++){const _0x4a9b88=_0x4d0fda[_0x399127];_0x4a9b88['_id']===_0x264b85[_0x250bc6(0x28a)][_0x250bc6(0x194)]&&(_0x4d8f81+=_0x250bc6(0x2a9)+_0x4a9b88[_0x250bc6(0x233)]+_0x250bc6(0x183)+_0x264b85[_0x250bc6(0x28a)][_0x250bc6(0x194)]+'</td>');}}_0x4d8f81+=_0x250bc6(0x275),_0x4d8f81+=_0x250bc6(0x19b),_0x4d8f81+='<tr>',_0x4d8f81+=_0x250bc6(0x1a0),_0x4d8f81+=_0x250bc6(0x2b2),_0x4d8f81+=_0x250bc6(0x198);for(let _0x166894=0x0;_0x166894<=_0x664e88[_0x250bc6(0x2b9)]-0x1;_0x166894++){const _0xe5165e=_0x664e88[_0x166894];for(let _0xf894d4=0x0;_0xf894d4<_0x1284d2[_0x250bc6(0x202)][_0x250bc6(0x2b9)];_0xf894d4++){const _0x40cdb6=_0x1284d2['cat_brand'][_0xf894d4];_0x40cdb6[_0x250bc6(0x28a)]['category']===_0xe5165e['_id']['category']&&(_0x4d8f81+=_0x250bc6(0x156)+_0x40cdb6[_0x250bc6(0x28a)][_0x250bc6(0x1a8)]+'</td>');}}_0x4d8f81+=_0x250bc6(0x26e),_0x4d8f81+=_0x250bc6(0x148),_0x4d8f81+=_0x250bc6(0x265),_0x4d8f81+=_0x250bc6(0x173),_0x4d8f81+=_0x250bc6(0x19b),_0x4d8f81+='</thead>',_0x4d8f81+=_0x250bc6(0x23f),_0x46f1ef[_0x250bc6(0x1f3)](_0x4292c4=>{_0x4d8f81+=_0x4292c4;}),console[_0x250bc6(0x22b)](_0x130811),_0x4d8f81+='</tbody>',_0x4d8f81+='</table>';}),_0x4d8f81;}function a0_0x46c7(_0x4be558,_0xb4805b){const _0x30baec=a0_0x30ba();return a0_0x46c7=function(_0x46c792,_0xe9c2b1){_0x46c792=_0x46c792-0x147;let _0x45fa8c=_0x30baec[_0x46c792];return _0x45fa8c;},a0_0x46c7(_0x4be558,_0xb4805b);}async function agentsdataDSICheck_admin_excel(_0x443447,_0x56639b,_0x36024d,_0xe2a15a){const _0x4d761c=a0_0x47da6c,_0x1c3162=await product[_0x4d761c(0x288)]([{'$group':{'_id':{'brand':_0x4d761c(0x18f),'category':'$category'},'products':{'$push':{'name':_0x4d761c(0x2bf),'product_code':_0x4d761c(0x161)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x31bc0e=[];_0x31bc0e['cat_brand']=[];for(let _0x5d7620=0x0;_0x5d7620<=_0x1c3162[_0x4d761c(0x2b9)]-0x1;_0x5d7620++){const _0x3f14f7=_0x1c3162[_0x5d7620];_0x31bc0e[_0x4d761c(0x202)]['push'](_0x3f14f7);}const _0x559381=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x4d761c(0x18f),'product_code':_0x4d761c(0x161),'product_name':_0x4d761c(0x2bf)}}}},{'$sort':{'_id.category':-0x1}}]),_0x432bfc=await product[_0x4d761c(0x288)]([{'$group':{'_id':{'category':_0x4d761c(0x1e1),'brand':_0x4d761c(0x18f)}}},{'$group':{'_id':_0x4d761c(0x219),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4a2825=await sales_sa[_0x4d761c(0x288)]([{'$match':{'date':{'$gte':_0x443447,'$lte':_0x56639b},'sales_staff_id':_0x36024d,'sale_product.isFG':_0x4d761c(0x1c0)}},{'$unwind':_0x4d761c(0x1e5)},{'$match':{'sale_product.isFG':_0x4d761c(0x1c0)}},{'$lookup':{'from':'products','localField':_0x4d761c(0x293),'foreignField':'product_code','as':_0x4d761c(0x22c)}},{'$unwind':_0x4d761c(0x1b0)},{'$group':{'_id':{'dsi':_0x4d761c(0x14e),'date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x4d761c(0x189)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x4d761c(0x1d0),'discount':_0x4d761c(0x1c8),'adj_discount':_0x4d761c(0x1f9),'product_details':{'prod_name':_0x4d761c(0x203),'product_code':_0x4d761c(0x22d),'category':'$product_info.category','brand':_0x4d761c(0x2d4),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x4d761c(0x22e)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x4d761c(0x292),'customer':'$_id.customer','category':'$products.product_details.category','brand':_0x4d761c(0x246)},'totalQty':{'$sum':_0x4d761c(0x19e)},'totalGross':{'$sum':{'$multiply':[_0x4d761c(0x19e),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x4d761c(0x14b)},'adj_discount':{'$sum':_0x4d761c(0x243)},'product_details':{'$first':_0x4d761c(0x25a)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x4d761c(0x292),'customer':_0x4d761c(0x26c)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x4d761c(0x296)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x4d761c(0x1dc),'category':_0x4d761c(0x219),'brand':_0x4d761c(0x17a),'product_details':_0x4d761c(0x263)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4fe84d=[],_0x4de09f={},_0x1c49db={},_0x13d28a={};var _0x157115=0x0,_0x15af19=0x0,_0x4bbf1c=0x0,_0x41c14f=0x0,_0x41b351=0x0;const _0x95b8ca=0x16345785d8a0000;for(let _0x691009=0x0;_0x691009<=_0x4a2825[_0x4d761c(0x2b9)]-0x1;_0x691009++){const _0x3a79ed=_0x4a2825[_0x691009];let _0x429814=_0x4d761c(0x22f);_0x429814+=_0x4d761c(0x166)+_0x3a79ed['_id'][_0x4d761c(0x1de)]+'</td>',_0x429814+=_0x4d761c(0x166)+_0x3a79ed[_0x4d761c(0x28a)]['date']+_0x4d761c(0x15e),_0x429814+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3a79ed[_0x4d761c(0x28a)][_0x4d761c(0x2d0)]+_0x4d761c(0x15e);let _0x23305a={};var _0x5c47b1=0x0;for(let _0x3e812d=0x0;_0x3e812d<=_0x3a79ed[_0x4d761c(0x283)]['length']-0x1;_0x3e812d++){const _0x3089e1=_0x3a79ed[_0x4d761c(0x283)][_0x3e812d];_0x23305a[_0x3089e1[_0x4d761c(0x1a8)]+'-'+_0x3089e1[_0x4d761c(0x194)]]=_0x3089e1[_0x4d761c(0x291)];const _0x23eb3c=_0x3089e1[_0x4d761c(0x1a8)]+'-'+_0x3089e1[_0x4d761c(0x194)];!_0x4de09f[_0x23eb3c]&&(_0x4de09f[_0x23eb3c]=0x0),!Array['isArray'](_0x13d28a[_0x23eb3c])&&(_0x13d28a[_0x23eb3c]=[]),!Array['isArray'](_0x13d28a[_0x23eb3c])&&(_0x13d28a[_0x23eb3c]=[]),_0x4de09f[_0x23eb3c]+=_0x3089e1[_0x4d761c(0x291)],_0x13d28a[_0x23eb3c][_0x4d761c(0x285)](_0x3089e1['qty']),_0x5c47b1++;}console['log'](_0x3a79ed);for(let _0x298e74=0x0;_0x298e74<=_0x31bc0e[_0x4d761c(0x202)][_0x4d761c(0x2b9)]-0x1;_0x298e74++){const _0x43c06b=_0x31bc0e[_0x4d761c(0x202)][_0x298e74],_0x3d0c68=_0x43c06b[_0x4d761c(0x28a)]['brand']+'-'+_0x43c06b[_0x4d761c(0x28a)][_0x4d761c(0x194)];_0x429814+=_0x4d761c(0x169)+(_0x23305a[_0x3d0c68]!==undefined?_0x23305a[_0x3d0c68]['toFixed'](0x2):'')+'</td>';}_0x4bbf1c=_0x3a79ed[_0x4d761c(0x1be)]+_0x3a79ed[_0x4d761c(0x176)],_0x429814+=_0x4d761c(0x20c)+formatNumber(parseFloat(_0x3a79ed[_0x4d761c(0x16d)],0x2)[_0x4d761c(0x28b)](0x2))+_0x4d761c(0x15e),_0x429814+=_0x4d761c(0x20c)+formatNumber(_0x3a79ed[_0x4d761c(0x255)][_0x4d761c(0x28b)](0x2))+_0x4d761c(0x15e),_0x429814+=_0x4d761c(0x20c)+formatNumber(_0x4bbf1c)+_0x4d761c(0x15e),_0x429814+=_0x4d761c(0x20c)+formatNumber(_0x3a79ed['NetPrice'][_0x4d761c(0x28b)](0x2))+_0x4d761c(0x15e),_0x429814+=_0x4d761c(0x19b),_0x157115+=parseFloat(_0x3a79ed['totalQty'][_0x4d761c(0x28b)](0x2)),_0x15af19+=parseFloat(_0x3a79ed[_0x4d761c(0x262)][_0x4d761c(0x28b)](0x2)),_0x41c14f+=_0x4bbf1c,_0x41b351+=parseFloat(_0x3a79ed[_0x4d761c(0x255)][_0x4d761c(0x28b)](0x2));if(_0x691009==_0x4a2825['length']-0x1){_0x429814+=_0x4d761c(0x22f),_0x429814+=_0x4d761c(0x254),_0x429814+=_0x4d761c(0x15e);for(let _0x166a70=0x0;_0x166a70<=_0x31bc0e[_0x4d761c(0x202)]['length']-0x1;_0x166a70++){const _0x1ea856=_0x31bc0e['cat_brand'][_0x166a70],_0x38a30d=_0x1ea856[_0x4d761c(0x28a)][_0x4d761c(0x1a8)]+'-'+_0x1ea856[_0x4d761c(0x28a)][_0x4d761c(0x194)],_0x546708=_0x13d28a[_0x38a30d]['reduce']((_0x26ab40,_0x5514a6)=>_0x26ab40+_0x5514a6,0x0);console[_0x4d761c(0x22b)]('test',_0x38a30d),_0x429814+=_0x4d761c(0x21b)+(_0x546708!==undefined?formatNumber(_0x546708['toFixed'](0x2)):'')+_0x4d761c(0x180),console[_0x4d761c(0x22b)](_0x13d28a[_0x38a30d][_0x4d761c(0x2af)]((_0x2f0e9f,_0x4af1ae)=>_0x2f0e9f+_0x4af1ae,0x0));}_0x429814+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x157115[_0x4d761c(0x28b)](0x2))+_0x4d761c(0x180),_0x429814+=_0x4d761c(0x1f6)+formatNumber(_0x41b351)+_0x4d761c(0x180),_0x429814+=_0x4d761c(0x1f6)+formatNumber(_0x41c14f)+'</b></td>',_0x429814+=_0x4d761c(0x1f6)+formatNumber(_0x15af19)+_0x4d761c(0x180),_0x429814+=_0x4d761c(0x19b);}_0x4fe84d[_0x4d761c(0x285)](_0x429814);}function _0x4419d6(_0x5093d7,_0x29a5d1){const _0x39d0dd=_0x4d761c,_0x3ea8de=[];for(let _0x2b40df=0x0;_0x2b40df<=_0x5093d7[_0x39d0dd(0x2b9)]-0x1;_0x2b40df+=_0x29a5d1){_0x3ea8de[_0x39d0dd(0x285)](_0x5093d7['slice'](_0x2b40df,_0x2b40df+_0x29a5d1));}return _0x3ea8de;}const _0x5073d8=_0x4419d6(_0x4fe84d,_0x95b8ca);let _0x41dbad='';return _0x5073d8[_0x4d761c(0x1f3)]((_0x8b86f8,_0x21182f)=>{const _0x3eea87=_0x4d761c;_0x21182f>0x0&&(_0x41dbad+=_0x3eea87(0x2a6));_0x41dbad+=_0x3eea87(0x205),_0x41dbad+=_0x3eea87(0x16f),_0x41dbad+=_0x3eea87(0x22f),_0x41dbad+=_0x3eea87(0x1ba),_0x41dbad+='</tr>',_0x41dbad+=_0x3eea87(0x22f),_0x41dbad+=_0x3eea87(0x279);for(let _0x258ed2=0x0;_0x258ed2<=_0x559381[_0x3eea87(0x2b9)]-0x1;_0x258ed2++){const _0x421c53=_0x559381[_0x258ed2];for(let _0x1d1aaa=0x0;_0x1d1aaa<_0x432bfc[_0x3eea87(0x2b9)];_0x1d1aaa++){const _0x5a1d50=_0x432bfc[_0x1d1aaa];_0x5a1d50['_id']===_0x421c53[_0x3eea87(0x28a)][_0x3eea87(0x194)]&&(_0x41dbad+=_0x3eea87(0x2a9)+_0x5a1d50[_0x3eea87(0x233)]+'\x22\x20class=\x22cat_data\x22>'+_0x421c53[_0x3eea87(0x28a)][_0x3eea87(0x194)]+'</td>');}}_0x41dbad+=_0x3eea87(0x275),_0x41dbad+=_0x3eea87(0x19b),_0x41dbad+=_0x3eea87(0x22f),_0x41dbad+=_0x3eea87(0x1a0),_0x41dbad+=_0x3eea87(0x2b2),_0x41dbad+=_0x3eea87(0x198);for(let _0x540876=0x0;_0x540876<=_0x559381['length']-0x1;_0x540876++){const _0x2b3d93=_0x559381[_0x540876];for(let _0x480ed3=0x0;_0x480ed3<_0x31bc0e[_0x3eea87(0x202)][_0x3eea87(0x2b9)];_0x480ed3++){const _0xe1e265=_0x31bc0e[_0x3eea87(0x202)][_0x480ed3];_0xe1e265[_0x3eea87(0x28a)][_0x3eea87(0x194)]===_0x2b3d93[_0x3eea87(0x28a)][_0x3eea87(0x194)]&&(_0x41dbad+='<td\x20class=\x22cat_data\x22>'+_0xe1e265[_0x3eea87(0x28a)]['brand']+_0x3eea87(0x15e));}}_0x41dbad+=_0x3eea87(0x26e),_0x41dbad+=_0x3eea87(0x148),_0x41dbad+=_0x3eea87(0x265),_0x41dbad+=_0x3eea87(0x173),_0x41dbad+=_0x3eea87(0x19b),_0x41dbad+=_0x3eea87(0x1a3),_0x41dbad+=_0x3eea87(0x23f),_0x8b86f8[_0x3eea87(0x1f3)](_0x31c532=>{_0x41dbad+=_0x31c532;}),console[_0x3eea87(0x22b)](_0x13d28a),_0x41dbad+=_0x3eea87(0x1e4),_0x41dbad+='</table>';}),_0x41dbad;}router[a0_0x47da6c(0x270)](a0_0x47da6c(0x1aa),auth,async(_0x31d6f8,_0x54f5ca)=>{const _0x101cc5=a0_0x47da6c,{from_date:_0x1fe32c,to_date:_0x11acc6,isExcel:_0x117b7d,agent_id:_0x4de7d3}=_0x31d6f8[_0x101cc5(0x197)],_0x5482f3=_0x31d6f8['user'],_0x3801d5=await staff['findOne']({'email':_0x5482f3[_0x101cc5(0x235)]}),_0x397d88=await master_shop[_0x101cc5(0x2b6)](),_0x53d30a=await agentsdataDSICheck_admin(_0x1fe32c,_0x11acc6,_0x4de7d3,_0x117b7d),_0x3b93b5=await agentsdataDSICheck_admin_excel(_0x1fe32c,_0x11acc6,_0x4de7d3,_0x117b7d);let _0x3919d5=_0x101cc5(0x2a1);var _0x37368a=new Date(_0x1fe32c),_0x7f1254=new Date(_0x11acc6);const _0x300ae6={'year':_0x101cc5(0x181),'month':_0x101cc5(0x16c),'day':_0x101cc5(0x181)},_0x17fa58=new Intl[(_0x101cc5(0x21a))]('en-US',_0x300ae6)[_0x101cc5(0x1e0)](_0x37368a),_0x1f8662=new Intl[(_0x101cc5(0x21a))](_0x101cc5(0x268),_0x300ae6)['format'](_0x7f1254);_0x3919d5+=_0x101cc5(0x15b),_0x3919d5+=_0x101cc5(0x2be),_0x3919d5+='<table>',_0x3919d5+=_0x53d30a,_0x3919d5+=_0x101cc5(0x1b2),_0x3919d5+=_0x101cc5(0x249),_0x3919d5+='</div>';let _0x1d2c4b='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x1d2c4b+='<div\x20class=\x22row\x22>',_0x1d2c4b+='<div\x20\x20id=\x22table-conatainer\x22>',_0x1d2c4b+='<table>',_0x1d2c4b+=_0x3b93b5,_0x1d2c4b+=_0x101cc5(0x1b2),_0x1d2c4b+=_0x101cc5(0x249),_0x1d2c4b+=_0x101cc5(0x249);let _0xbbd13b=_0x101cc5(0x225);const _0xeab063={'width':_0x101cc5(0x287),'height':_0x101cc5(0x150),'orientation':_0x101cc5(0x2a5),'border':{'top':_0x101cc5(0x1ae),'right':'0.1in','bottom':_0x101cc5(0x1ae),'left':_0x101cc5(0x1ae)},'header':{'height':_0x101cc5(0x223),'contents':_0x101cc5(0x2bb)+_0xbbd13b+_0x101cc5(0x222)+_0x17fa58+_0x101cc5(0x216)+_0x1f8662+_0x101cc5(0x2b7)},'footer':{'height':_0x101cc5(0x28d),'contents':{'default':_0x101cc5(0x1bf)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x101cc5(0x224)}}};if(_0x117b7d=='on'){const _0x4b2bcd=cheerio['load'](_0x1d2c4b);let _0x37895d=[],_0x1d3bda=[],_0x188293=[];_0x4b2bcd(_0x101cc5(0x2a2))['each']((_0x3c3a54,_0x4e6809)=>{const _0x531883=_0x101cc5;let _0x44d26b=[],_0x175a75=0x0;while(_0x188293[_0x175a75]){_0x188293[_0x175a75]--,_0x175a75++;}_0x4b2bcd(_0x4e6809)['find'](_0x531883(0x19f))[_0x531883(0x2d2)]((_0x428f47,_0x4ca6b5)=>{const _0x5466d4=_0x531883;let _0xa9c877=_0x4b2bcd(_0x4ca6b5)['text']()['trim'](),_0x2ac46d=parseFloat(_0xa9c877[_0x5466d4(0x20e)](/,/g,''));isNaN(_0x2ac46d)&&(_0x2ac46d=_0xa9c877);let _0x2fcbac=parseInt(_0x4b2bcd(_0x4ca6b5)['attr']('colspan'))||0x1,_0x5e5b7f=parseInt(_0x4b2bcd(_0x4ca6b5)[_0x5466d4(0x2cb)](_0x5466d4(0x209)))||0x1;_0x44d26b[_0x175a75]=_0x2ac46d;(_0x2fcbac>0x1||_0x5e5b7f>0x1)&&_0x1d3bda['push']({'s':{'r':_0x3c3a54,'c':_0x175a75},'e':{'r':_0x3c3a54+_0x5e5b7f-0x1,'c':_0x175a75+_0x2fcbac-0x1}});for(let _0x2a01ff=0x0;_0x2a01ff<_0x2fcbac;_0x2a01ff++){_0x5e5b7f>0x1&&(_0x188293[_0x175a75+_0x2a01ff]=_0x5e5b7f-0x1);}_0x175a75+=_0x2fcbac;}),_0x37895d[_0x531883(0x285)](_0x44d26b);});const _0x329c90=XLSX[_0x101cc5(0x236)][_0x101cc5(0x2cd)](),_0x2a2009=XLSX[_0x101cc5(0x236)]['aoa_to_sheet'](_0x37895d);_0x1d3bda[_0x101cc5(0x2b9)]>0x0&&(_0x2a2009['!merges']=_0x1d3bda);_0x2a2009[_0x101cc5(0x269)]=_0x37895d[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x101cc5(0x236)][_0x101cc5(0x179)](_0x329c90,_0x2a2009,'Sales\x20Report');const _0x2bb94e=XLSX[_0x101cc5(0x2c2)](_0x329c90,{'bookType':_0x101cc5(0x26f),'type':_0x101cc5(0x2bc)});_0x54f5ca[_0x101cc5(0x26d)](_0x101cc5(0x273),_0x101cc5(0x1ee)),_0x54f5ca[_0x101cc5(0x26d)](_0x101cc5(0x2c8),_0x101cc5(0x19d)),_0x54f5ca[_0x101cc5(0x1dd)](_0x2bb94e);}else pdf['create'](_0x3919d5,_0xeab063)[_0x101cc5(0x2cc)](function(_0x3f20c9,_0x593820){const _0x57b274=_0x101cc5;if(_0x3f20c9){_0x54f5ca[_0x57b274(0x210)](0x1f4)[_0x57b274(0x1dd)]('Error\x20generating\x20PDF');return;}_0x54f5ca[_0x57b274(0x26d)](_0x57b274(0x2c8),_0x57b274(0x2c4)),_0x593820[_0x57b274(0x2ac)](_0x54f5ca);});}),router[a0_0x47da6c(0x149)](a0_0x47da6c(0x238),auth,async(_0xbb6ceb,_0x82560d)=>{const _0x3ad8db=a0_0x47da6c;try{const {username:_0x470e94,email:_0x3a676d,role:_0x49e21a}=_0xbb6ceb[_0x3ad8db(0x213)],_0x6cdcb5=_0xbb6ceb['user'],_0x2ce459=await profile[_0x3ad8db(0x23c)]({'email':_0x6cdcb5[_0x3ad8db(0x235)]}),_0x2a9209={'year':_0x3ad8db(0x181),'month':_0x3ad8db(0x16c),'day':_0x3ad8db(0x181)},_0x1f9fe9=await master_shop['find'](),_0x55659c=await staff[_0x3ad8db(0x23c)]({'email':_0x6cdcb5[_0x3ad8db(0x235)]}),_0x14de29=await product['find'](),_0x7f4d96=await warehouse[_0x3ad8db(0x288)]([{'$unwind':_0x3ad8db(0x263)},{'$lookup':{'from':'products','localField':_0x3ad8db(0x24f),'foreignField':'name','as':_0x3ad8db(0x24d)}},{'$unwind':_0x3ad8db(0x27b)},{'$project':{'product_name':_0x3ad8db(0x278),'product_stock':_0x3ad8db(0x18a)}},{'$group':{'_id':_0x3ad8db(0x280),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x1f9fe9[0x0][_0x3ad8db(0x15f)]=='English\x20(US)')var _0x5a82c1=users[_0x3ad8db(0x1b7)];else{if(_0x1f9fe9[0x0]['language']==_0x3ad8db(0x277))var _0x5a82c1=users[_0x3ad8db(0x277)];else{if(_0x1f9fe9[0x0]['language']==_0x3ad8db(0x20b))var _0x5a82c1=users[_0x3ad8db(0x20b)];else{if(_0x1f9fe9[0x0][_0x3ad8db(0x15f)]==_0x3ad8db(0x1ea))var _0x5a82c1=users[_0x3ad8db(0x1ea)];else{if(_0x1f9fe9[0x0][_0x3ad8db(0x15f)]=='French')var _0x5a82c1=users[_0x3ad8db(0x281)];else{if(_0x1f9fe9[0x0][_0x3ad8db(0x15f)]=='Portuguese\x20(BR)')var _0x5a82c1=users[_0x3ad8db(0x25c)];else{if(_0x1f9fe9[0x0][_0x3ad8db(0x15f)]=='Chinese')var _0x5a82c1=users[_0x3ad8db(0x175)];else{if(_0x1f9fe9[0x0]['language']==_0x3ad8db(0x25f))var _0x5a82c1=users[_0x3ad8db(0x1cd)];}}}}}}}_0x82560d[_0x3ad8db(0x1bd)](_0x3ad8db(0x289),{'success':_0xbb6ceb[_0x3ad8db(0x1c3)](_0x3ad8db(0x15d)),'errors':_0xbb6ceb[_0x3ad8db(0x1c3)](_0x3ad8db(0x2b3)),'alldata':_0x14de29,'profile':_0x2ce459,'master_shop':_0x1f9fe9,'role':_0x6cdcb5,'product_stock':_0x7f4d96,'language':_0x5a82c1,'staff_arr':_0x55659c});}catch(_0x21e610){}});function formatNumber(_0x47fa24,_0x11c903=a0_0x47da6c(0x268),_0x28bac3={'minimumFractionDigits':0x2}){const _0x614b71=a0_0x47da6c,_0x5663bf=new Intl[(_0x614b71(0x2bd))](_0x11c903,_0x28bac3);return _0x5663bf[_0x614b71(0x1e0)](_0x47fa24);}async function agentsdataDSICheck(_0x5048cf,_0xa26668,_0x337f20,_0xb6f45c){const _0x55ba54=a0_0x47da6c,_0xed449d=await product[_0x55ba54(0x288)]([{'$group':{'_id':{'brand':_0x55ba54(0x18f),'category':_0x55ba54(0x1e1)},'products':{'$push':{'name':_0x55ba54(0x2bf),'product_code':_0x55ba54(0x161)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x383ec0=[];_0x383ec0[_0x55ba54(0x202)]=[];for(let _0x375319=0x0;_0x375319<=_0xed449d[_0x55ba54(0x2b9)]-0x1;_0x375319++){const _0x9f5141=_0xed449d[_0x375319];_0x383ec0[_0x55ba54(0x202)][_0x55ba54(0x285)](_0x9f5141);}const _0x200d68=await product[_0x55ba54(0x288)]([{'$group':{'_id':{'category':_0x55ba54(0x1e1)},'products':{'$push':{'brand':_0x55ba54(0x18f),'product_code':_0x55ba54(0x161),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0xf9d973=await product['aggregate']([{'$group':{'_id':{'category':_0x55ba54(0x1e1),'brand':'$brand'}}},{'$group':{'_id':_0x55ba54(0x219),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x15f8fc=await sales_sa[_0x55ba54(0x288)]([{'$match':{'date':{'$gte':_0x5048cf,'$lte':_0xa26668},'sales_staff_id':_0x337f20,'sale_product.isFG':_0x55ba54(0x1c0)}},{'$unwind':_0x55ba54(0x1e5)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x55ba54(0x283),'localField':_0x55ba54(0x293),'foreignField':_0x55ba54(0x1c9),'as':_0x55ba54(0x22c)}},{'$unwind':_0x55ba54(0x1b0)},{'$group':{'_id':{'dsi':_0x55ba54(0x14e),'date':_0x55ba54(0x259),'customer':'$customer'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x55ba54(0x189),'NetPrice':_0x55ba54(0x1d0),'discount':_0x55ba54(0x1c8),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x55ba54(0x203),'product_code':_0x55ba54(0x22d),'category':_0x55ba54(0x17b),'brand':_0x55ba54(0x2d4),'gross_price':_0x55ba54(0x206)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x55ba54(0x1ff),'date':_0x55ba54(0x292),'customer':_0x55ba54(0x26c),'category':_0x55ba54(0x1f8),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x55ba54(0x19e)},'totalGross':{'$sum':{'$multiply':[_0x55ba54(0x19e),_0x55ba54(0x26a)]}},'NetPrice':{'$sum':_0x55ba54(0x27d)},'discount':{'$sum':_0x55ba54(0x14b)},'adj_discount':{'$sum':_0x55ba54(0x243)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x55ba54(0x292),'customer':_0x55ba54(0x26c)},'totalQty':{'$sum':_0x55ba54(0x1dc)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x55ba54(0x232)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':_0x55ba54(0x219),'brand':_0x55ba54(0x17a),'product_details':_0x55ba54(0x263)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x560285=[],_0x363fd7={},_0x424258={},_0x3b0ea9={};var _0x534c4e=0x0,_0xc344bf=0x0,_0x54ab1c=0x0,_0x4b874e=0x0,_0x56ed15=0x0;const _0x4cdacf=0x6;for(let _0x2420c8=0x0;_0x2420c8<=_0x15f8fc[_0x55ba54(0x2b9)]-0x1;_0x2420c8++){const _0x195a7a=_0x15f8fc[_0x2420c8];let _0x484b69='<tr>';_0x484b69+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x195a7a['_id'][_0x55ba54(0x1de)]+'</td>',_0x484b69+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x195a7a[_0x55ba54(0x28a)][_0x55ba54(0x1db)]+_0x55ba54(0x15e),_0x484b69+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x195a7a['_id'][_0x55ba54(0x2d0)]+_0x55ba54(0x15e);let _0x9f4161={};var _0x47c050=0x0;for(let _0x504567=0x0;_0x504567<=_0x195a7a[_0x55ba54(0x283)]['length']-0x1;_0x504567++){const _0x418db7=_0x195a7a[_0x55ba54(0x283)][_0x504567];_0x9f4161[_0x418db7[_0x55ba54(0x1a8)]+'-'+_0x418db7['category']]=_0x418db7[_0x55ba54(0x291)];const _0x5ebcfe=_0x418db7[_0x55ba54(0x1a8)]+'-'+_0x418db7[_0x55ba54(0x194)];!_0x363fd7[_0x5ebcfe]&&(_0x363fd7[_0x5ebcfe]=0x0),!Array[_0x55ba54(0x239)](_0x3b0ea9[_0x5ebcfe])&&(_0x3b0ea9[_0x5ebcfe]=[]),!Array['isArray'](_0x3b0ea9[_0x5ebcfe])&&(_0x3b0ea9[_0x5ebcfe]=[]),_0x363fd7[_0x5ebcfe]+=_0x418db7[_0x55ba54(0x291)],_0x3b0ea9[_0x5ebcfe][_0x55ba54(0x285)](_0x418db7[_0x55ba54(0x291)]),_0x47c050++;}console[_0x55ba54(0x22b)](_0x195a7a);for(let _0x4108c5=0x0;_0x4108c5<=_0x383ec0['cat_brand'][_0x55ba54(0x2b9)]-0x1;_0x4108c5++){const _0x3d9323=_0x383ec0[_0x55ba54(0x202)][_0x4108c5],_0x506d21=_0x3d9323[_0x55ba54(0x28a)][_0x55ba54(0x1a8)]+'-'+_0x3d9323[_0x55ba54(0x28a)]['category'];_0x484b69+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x9f4161[_0x506d21]!==undefined?_0x9f4161[_0x506d21][_0x55ba54(0x28b)](0x2):'')+_0x55ba54(0x15e);}_0x54ab1c=_0x195a7a[_0x55ba54(0x1be)]+_0x195a7a[_0x55ba54(0x176)],_0x484b69+=_0x55ba54(0x20c)+formatNumber(parseFloat(_0x195a7a[_0x55ba54(0x16d)],0x2)[_0x55ba54(0x28b)](0x2))+_0x55ba54(0x15e),_0x484b69+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x195a7a[_0x55ba54(0x255)]['toFixed'](0x2))+_0x55ba54(0x15e),_0x484b69+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x54ab1c)+'</td>',_0x484b69+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x195a7a['NetPrice']['toFixed'](0x2))+'</td>',_0x484b69+=_0x55ba54(0x19b),_0x534c4e+=parseFloat(_0x195a7a['totalQty']['toFixed'](0x2)),_0xc344bf+=parseFloat(_0x195a7a[_0x55ba54(0x262)][_0x55ba54(0x28b)](0x2)),_0x4b874e+=_0x54ab1c,_0x56ed15+=parseFloat(_0x195a7a[_0x55ba54(0x255)][_0x55ba54(0x28b)](0x2));if(_0x2420c8==_0x15f8fc[_0x55ba54(0x2b9)]-0x1){_0x484b69+='<tr>',_0x484b69+=_0x55ba54(0x254),_0x484b69+=_0x55ba54(0x15e);for(let _0x2d6b6c=0x0;_0x2d6b6c<=_0x383ec0['cat_brand'][_0x55ba54(0x2b9)]-0x1;_0x2d6b6c++){const _0x57e263=_0x383ec0['cat_brand'][_0x2d6b6c],_0x25b54a=_0x57e263[_0x55ba54(0x28a)][_0x55ba54(0x1a8)]+'-'+_0x57e263['_id'][_0x55ba54(0x194)],_0x3477e3=_0x3b0ea9[_0x25b54a][_0x55ba54(0x2af)]((_0x2d9449,_0x3121e9)=>_0x2d9449+_0x3121e9,0x0);_0x484b69+=_0x55ba54(0x21b)+(_0x3477e3!==undefined?formatNumber(_0x3477e3[_0x55ba54(0x28b)](0x2)):'')+'</b></td>',console[_0x55ba54(0x22b)](_0x3b0ea9[_0x25b54a][_0x55ba54(0x2af)]((_0x120419,_0x5e3e38)=>_0x120419+_0x5e3e38,0x0));}_0x484b69+=_0x55ba54(0x1f6)+formatNumber(_0x534c4e['toFixed'](0x2))+'</b></td>',_0x484b69+=_0x55ba54(0x1f6)+formatNumber(_0x56ed15)+_0x55ba54(0x180),_0x484b69+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4b874e)+_0x55ba54(0x180),_0x484b69+=_0x55ba54(0x1f6)+formatNumber(_0xc344bf)+_0x55ba54(0x180),_0x484b69+=_0x55ba54(0x19b);}_0x560285['push'](_0x484b69);}function _0x52622b(_0x451884,_0x527f27){const _0x28c256=_0x55ba54,_0x53dd0b=[];for(let _0x41f0cd=0x0;_0x41f0cd<=_0x451884['length']-0x1;_0x41f0cd+=_0x527f27){_0x53dd0b[_0x28c256(0x285)](_0x451884[_0x28c256(0x1a9)](_0x41f0cd,_0x41f0cd+_0x527f27));}return _0x53dd0b;}const _0xbafd8e=_0x52622b(_0x560285,_0x4cdacf);let _0x3a93ea='';return _0xbafd8e[_0x55ba54(0x1f3)]((_0x2351be,_0x1f4a68)=>{const _0x1192b3=_0x55ba54;_0x1f4a68>0x0&&(_0x3a93ea+=_0x1192b3(0x2a6));_0x3a93ea+=_0x1192b3(0x205),_0x3a93ea+=_0x1192b3(0x16f),_0x3a93ea+=_0x1192b3(0x22f),_0x3a93ea+=_0x1192b3(0x1ba),_0x3a93ea+='</tr>',_0x3a93ea+='<tr>',_0x3a93ea+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x505d05=0x0;_0x505d05<=_0x200d68[_0x1192b3(0x2b9)]-0x1;_0x505d05++){const _0x510827=_0x200d68[_0x505d05];for(let _0x1cdd1f=0x0;_0x1cdd1f<_0xf9d973[_0x1192b3(0x2b9)];_0x1cdd1f++){const _0x1be2a2=_0xf9d973[_0x1cdd1f];_0x1be2a2[_0x1192b3(0x28a)]===_0x510827['_id'][_0x1192b3(0x194)]&&(_0x3a93ea+=_0x1192b3(0x2a9)+_0x1be2a2[_0x1192b3(0x233)]+_0x1192b3(0x183)+_0x510827['_id'][_0x1192b3(0x194)]+'</td>');}}_0x3a93ea+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x3a93ea+=_0x1192b3(0x19b),_0x3a93ea+=_0x1192b3(0x22f),_0x3a93ea+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x3a93ea+=_0x1192b3(0x2b2),_0x3a93ea+=_0x1192b3(0x198);for(let _0x32285c=0x0;_0x32285c<=_0x200d68['length']-0x1;_0x32285c++){const _0x3dc320=_0x200d68[_0x32285c];for(let _0x3260d0=0x0;_0x3260d0<_0x383ec0['cat_brand'][_0x1192b3(0x2b9)];_0x3260d0++){const _0x249420=_0x383ec0[_0x1192b3(0x202)][_0x3260d0];_0x249420['_id'][_0x1192b3(0x194)]===_0x3dc320['_id'][_0x1192b3(0x194)]&&(_0x3a93ea+=_0x1192b3(0x156)+_0x249420[_0x1192b3(0x28a)][_0x1192b3(0x1a8)]+_0x1192b3(0x15e));}}_0x3a93ea+=_0x1192b3(0x26e),_0x3a93ea+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x3a93ea+=_0x1192b3(0x265),_0x3a93ea+=_0x1192b3(0x173),_0x3a93ea+=_0x1192b3(0x19b),_0x3a93ea+=_0x1192b3(0x1a3),_0x3a93ea+=_0x1192b3(0x23f),_0x2351be[_0x1192b3(0x1f3)](_0x48290e=>{_0x3a93ea+=_0x48290e;}),console[_0x1192b3(0x22b)](_0x3b0ea9),_0x3a93ea+=_0x1192b3(0x1e4),_0x3a93ea+=_0x1192b3(0x1b2);}),_0x3a93ea;}async function agentsdataDSICheck_excel(_0x576f07,_0x547820,_0x1b6e09,_0x4dd19e){const _0x2e2e53=a0_0x47da6c,_0x2b8b7e=await product[_0x2e2e53(0x288)]([{'$group':{'_id':{'brand':_0x2e2e53(0x18f),'category':_0x2e2e53(0x1e1)},'products':{'$push':{'name':_0x2e2e53(0x2bf),'product_code':_0x2e2e53(0x161)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x43981d=[];_0x43981d[_0x2e2e53(0x202)]=[];for(let _0x10e05d=0x0;_0x10e05d<=_0x2b8b7e['length']-0x1;_0x10e05d++){const _0x4cb837=_0x2b8b7e[_0x10e05d];_0x43981d[_0x2e2e53(0x202)]['push'](_0x4cb837);}const _0x579984=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x2e2e53(0x161),'product_name':_0x2e2e53(0x2bf)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4429b7=await product['aggregate']([{'$group':{'_id':{'category':_0x2e2e53(0x1e1),'brand':_0x2e2e53(0x18f)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x16d03c=await sales_sa[_0x2e2e53(0x288)]([{'$match':{'date':{'$gte':_0x576f07,'$lte':_0x547820},'sales_staff_id':_0x1b6e09,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x2e2e53(0x293),'foreignField':_0x2e2e53(0x1c9),'as':_0x2e2e53(0x22c)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x2e2e53(0x14e),'date':_0x2e2e53(0x259),'customer':_0x2e2e53(0x184)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x2e2e53(0x189),'NetPrice':'$sale_product.totalprice','discount':_0x2e2e53(0x1c8),'adj_discount':_0x2e2e53(0x1f9),'product_details':{'prod_name':_0x2e2e53(0x203),'product_code':_0x2e2e53(0x22d),'category':_0x2e2e53(0x17b),'brand':_0x2e2e53(0x2d4),'gross_price':_0x2e2e53(0x206)}}}}},{'$unwind':_0x2e2e53(0x22e)},{'$group':{'_id':{'dsi':_0x2e2e53(0x1ff),'date':'$_id.date','customer':'$_id.customer','category':_0x2e2e53(0x1f8),'brand':_0x2e2e53(0x246)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x2e2e53(0x243)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x2e2e53(0x1ff),'date':_0x2e2e53(0x292),'customer':_0x2e2e53(0x26c)},'totalQty':{'$sum':_0x2e2e53(0x1dc)},'totalGross':{'$sum':_0x2e2e53(0x296)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x2e2e53(0x232)},'adj_discount':{'$sum':_0x2e2e53(0x1b1)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x2e2e53(0x17a),'product_details':_0x2e2e53(0x263)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x455aa8=[],_0x5b5f51={},_0x55e219={},_0x45a366={};var _0x8ec504=0x0,_0x41ea54=0x0,_0x3cf0c5=0x0,_0x5ccb43=0x0,_0x22be51=0x0;const _0x582408=0x9184e72a000;for(let _0x2d33d2=0x0;_0x2d33d2<=_0x16d03c['length']-0x1;_0x2d33d2++){const _0x4671f4=_0x16d03c[_0x2d33d2];let _0x500208=_0x2e2e53(0x22f);_0x500208+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4671f4[_0x2e2e53(0x28a)][_0x2e2e53(0x1de)]+_0x2e2e53(0x15e),_0x500208+=_0x2e2e53(0x166)+_0x4671f4[_0x2e2e53(0x28a)][_0x2e2e53(0x1db)]+_0x2e2e53(0x15e),_0x500208+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4671f4['_id'][_0x2e2e53(0x2d0)]+'</td>';let _0x1fe657={};var _0x3f002f=0x0;for(let _0x58845b=0x0;_0x58845b<=_0x4671f4[_0x2e2e53(0x283)][_0x2e2e53(0x2b9)]-0x1;_0x58845b++){const _0x5b2af2=_0x4671f4['products'][_0x58845b];_0x1fe657[_0x5b2af2['brand']+'-'+_0x5b2af2['category']]=_0x5b2af2[_0x2e2e53(0x291)];const _0x4fbb5c=_0x5b2af2[_0x2e2e53(0x1a8)]+'-'+_0x5b2af2[_0x2e2e53(0x194)];!_0x5b5f51[_0x4fbb5c]&&(_0x5b5f51[_0x4fbb5c]=0x0),!Array[_0x2e2e53(0x239)](_0x45a366[_0x4fbb5c])&&(_0x45a366[_0x4fbb5c]=[]),!Array[_0x2e2e53(0x239)](_0x45a366[_0x4fbb5c])&&(_0x45a366[_0x4fbb5c]=[]),_0x5b5f51[_0x4fbb5c]+=_0x5b2af2['qty'],_0x45a366[_0x4fbb5c]['push'](_0x5b2af2['qty']),_0x3f002f++;}console[_0x2e2e53(0x22b)](_0x4671f4);for(let _0xaa0df0=0x0;_0xaa0df0<=_0x43981d[_0x2e2e53(0x202)][_0x2e2e53(0x2b9)]-0x1;_0xaa0df0++){const _0x1a19e0=_0x43981d[_0x2e2e53(0x202)][_0xaa0df0],_0x376300=_0x1a19e0[_0x2e2e53(0x28a)]['brand']+'-'+_0x1a19e0[_0x2e2e53(0x28a)][_0x2e2e53(0x194)];_0x500208+=_0x2e2e53(0x169)+(_0x1fe657[_0x376300]!==undefined?_0x1fe657[_0x376300][_0x2e2e53(0x28b)](0x2):'')+_0x2e2e53(0x15e);}_0x3cf0c5=_0x4671f4[_0x2e2e53(0x1be)]+_0x4671f4['adj_discount'],_0x500208+=_0x2e2e53(0x20c)+formatNumber(parseFloat(_0x4671f4[_0x2e2e53(0x16d)],0x2)[_0x2e2e53(0x28b)](0x2))+_0x2e2e53(0x15e),_0x500208+=_0x2e2e53(0x20c)+formatNumber(_0x4671f4[_0x2e2e53(0x255)][_0x2e2e53(0x28b)](0x2))+_0x2e2e53(0x15e),_0x500208+=_0x2e2e53(0x20c)+formatNumber(_0x3cf0c5)+_0x2e2e53(0x15e),_0x500208+=_0x2e2e53(0x20c)+formatNumber(_0x4671f4[_0x2e2e53(0x262)][_0x2e2e53(0x28b)](0x2))+_0x2e2e53(0x15e),_0x500208+=_0x2e2e53(0x19b),_0x8ec504+=parseFloat(_0x4671f4['totalQty'][_0x2e2e53(0x28b)](0x2)),_0x41ea54+=parseFloat(_0x4671f4['NetPrice'][_0x2e2e53(0x28b)](0x2)),_0x5ccb43+=_0x3cf0c5,_0x22be51+=parseFloat(_0x4671f4[_0x2e2e53(0x255)][_0x2e2e53(0x28b)](0x2));if(_0x2d33d2==_0x16d03c[_0x2e2e53(0x2b9)]-0x1){_0x500208+='<tr>',_0x500208+=_0x2e2e53(0x254),_0x500208+=_0x2e2e53(0x15e);for(let _0x589220=0x0;_0x589220<=_0x43981d[_0x2e2e53(0x202)][_0x2e2e53(0x2b9)]-0x1;_0x589220++){const _0x582932=_0x43981d[_0x2e2e53(0x202)][_0x589220],_0x26e8e1=_0x582932[_0x2e2e53(0x28a)][_0x2e2e53(0x1a8)]+'-'+_0x582932[_0x2e2e53(0x28a)][_0x2e2e53(0x194)],_0x519c1d=_0x45a366[_0x26e8e1][_0x2e2e53(0x2af)]((_0x25be76,_0x9c4599)=>_0x25be76+_0x9c4599,0x0);_0x500208+=_0x2e2e53(0x21b)+(_0x519c1d!==undefined?formatNumber(_0x519c1d[_0x2e2e53(0x28b)](0x2)):'')+_0x2e2e53(0x180),console[_0x2e2e53(0x22b)](_0x45a366[_0x26e8e1][_0x2e2e53(0x2af)]((_0x1b3aaf,_0x443c52)=>_0x1b3aaf+_0x443c52,0x0));}_0x500208+=_0x2e2e53(0x1f6)+formatNumber(_0x8ec504['toFixed'](0x2))+_0x2e2e53(0x180),_0x500208+=_0x2e2e53(0x1f6)+formatNumber(_0x22be51)+'</b></td>',_0x500208+=_0x2e2e53(0x1f6)+formatNumber(_0x5ccb43)+_0x2e2e53(0x180),_0x500208+=_0x2e2e53(0x1f6)+formatNumber(_0x41ea54)+_0x2e2e53(0x180),_0x500208+=_0x2e2e53(0x19b);}_0x455aa8['push'](_0x500208);}function _0x4e6368(_0x18d8ff,_0x2077f1){const _0xae98f5=_0x2e2e53,_0x49d2c1=[];for(let _0x2444aa=0x0;_0x2444aa<=_0x18d8ff['length']-0x1;_0x2444aa+=_0x2077f1){_0x49d2c1[_0xae98f5(0x285)](_0x18d8ff['slice'](_0x2444aa,_0x2444aa+_0x2077f1));}return _0x49d2c1;}const _0x1a17cb=_0x4e6368(_0x455aa8,_0x582408);let _0x5f11b4='';return _0x1a17cb[_0x2e2e53(0x1f3)]((_0x206997,_0x2505ac)=>{const _0x26e9f3=_0x2e2e53;_0x2505ac>0x0&&(_0x5f11b4+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x5f11b4+='<table>',_0x5f11b4+=_0x26e9f3(0x16f),_0x5f11b4+=_0x26e9f3(0x22f),_0x5f11b4+=_0x26e9f3(0x1ba),_0x5f11b4+=_0x26e9f3(0x19b),_0x5f11b4+=_0x26e9f3(0x22f),_0x5f11b4+=_0x26e9f3(0x279);for(let _0x425420=0x0;_0x425420<=_0x579984[_0x26e9f3(0x2b9)]-0x1;_0x425420++){const _0x40b552=_0x579984[_0x425420];for(let _0x247cf6=0x0;_0x247cf6<_0x4429b7['length'];_0x247cf6++){const _0x41511c=_0x4429b7[_0x247cf6];_0x41511c[_0x26e9f3(0x28a)]===_0x40b552['_id'][_0x26e9f3(0x194)]&&(_0x5f11b4+=_0x26e9f3(0x2a9)+_0x41511c[_0x26e9f3(0x233)]+'\x22\x20class=\x22cat_data\x22>'+_0x40b552[_0x26e9f3(0x28a)]['category']+'</td>');}}_0x5f11b4+=_0x26e9f3(0x275),_0x5f11b4+=_0x26e9f3(0x19b),_0x5f11b4+=_0x26e9f3(0x22f),_0x5f11b4+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x5f11b4+=_0x26e9f3(0x2b2),_0x5f11b4+=_0x26e9f3(0x198);for(let _0x4a2fa5=0x0;_0x4a2fa5<=_0x579984[_0x26e9f3(0x2b9)]-0x1;_0x4a2fa5++){const _0x46b942=_0x579984[_0x4a2fa5];for(let _0x1be63e=0x0;_0x1be63e<_0x43981d['cat_brand']['length'];_0x1be63e++){const _0x28a33d=_0x43981d[_0x26e9f3(0x202)][_0x1be63e];_0x28a33d[_0x26e9f3(0x28a)][_0x26e9f3(0x194)]===_0x46b942[_0x26e9f3(0x28a)]['category']&&(_0x5f11b4+='<td\x20class=\x22cat_data\x22>'+_0x28a33d[_0x26e9f3(0x28a)][_0x26e9f3(0x1a8)]+_0x26e9f3(0x15e));}}_0x5f11b4+=_0x26e9f3(0x26e),_0x5f11b4+=_0x26e9f3(0x148),_0x5f11b4+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x5f11b4+=_0x26e9f3(0x173),_0x5f11b4+=_0x26e9f3(0x19b),_0x5f11b4+=_0x26e9f3(0x1a3),_0x5f11b4+=_0x26e9f3(0x23f),_0x206997['forEach'](_0x42af09=>{_0x5f11b4+=_0x42af09;}),console[_0x26e9f3(0x22b)](_0x45a366),_0x5f11b4+=_0x26e9f3(0x1e4),_0x5f11b4+='</table>';}),_0x5f11b4;}router[a0_0x47da6c(0x270)](a0_0x47da6c(0x164),auth,async(_0x3832dd,_0x422888)=>{const _0x31c916=a0_0x47da6c,{from_date:_0x5049be,to_date:_0x133353,isExcel:_0x403fe8}=_0x3832dd[_0x31c916(0x197)],_0x453258=_0x3832dd[_0x31c916(0x213)],_0x10ea4c=await staff[_0x31c916(0x23c)]({'email':_0x453258[_0x31c916(0x235)]}),_0x1c8cbb=await master_shop[_0x31c916(0x2b6)]();console[_0x31c916(0x22b)](_0x1c8cbb[0x0][_0x31c916(0x160)]);const _0x149847=await agentsdataDSICheck(_0x5049be,_0x133353,_0x10ea4c['_id'][_0x31c916(0x2a8)](),_0x403fe8),_0x447a3e=await agentsdataDSICheck_excel(_0x5049be,_0x133353,_0x10ea4c[_0x31c916(0x28a)][_0x31c916(0x2a8)](),_0x403fe8);let _0x30df81=_0x31c916(0x241);var _0xab9e32=new Date(_0x5049be),_0x253a45=new Date(_0x133353);const _0x257706={'year':_0x31c916(0x181),'month':_0x31c916(0x16c),'day':'numeric'},_0x315e65=new Intl[(_0x31c916(0x21a))](_0x31c916(0x268),_0x257706)[_0x31c916(0x1e0)](_0xab9e32),_0x408623=new Intl[(_0x31c916(0x21a))](_0x31c916(0x268),_0x257706)[_0x31c916(0x1e0)](_0x253a45);_0x30df81+='<div\x20class=\x22row\x22>',_0x30df81+=_0x31c916(0x2be),_0x30df81+='<table>',_0x30df81+=_0x149847,_0x30df81+=_0x31c916(0x1b2),_0x30df81+='</div>',_0x30df81+='</div>';let _0x4f2922='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x4f2922+='<div\x20class=\x22row\x22>',_0x4f2922+=_0x31c916(0x2be),_0x4f2922+=_0x31c916(0x205),_0x4f2922+=_0x447a3e,_0x4f2922+=_0x31c916(0x1b2),_0x4f2922+='</div>',_0x4f2922+=_0x31c916(0x249);let _0x29d56a=_0x31c916(0x225);const _0x1e910e={'width':_0x31c916(0x287),'height':_0x31c916(0x150),'orientation':_0x31c916(0x2a5),'border':{'top':_0x31c916(0x1ae),'right':_0x31c916(0x1ae),'bottom':_0x31c916(0x1ae),'left':'0.1in'},'header':{'height':_0x31c916(0x223),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x29d56a+_0x31c916(0x222)+_0x315e65+_0x31c916(0x216)+_0x408623+_0x31c916(0x2b7)},'footer':{'height':_0x31c916(0x28d),'contents':{'default':_0x31c916(0x1bf)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x403fe8=='on'){const _0x3ac45=cheerio['load'](_0x4f2922);let _0x1ba3e8=[],_0x4bc05c=[],_0x46912a=[];const _0x404d8d=_0x482830=>{const _0x2b3877=_0x31c916,_0x140ca9={'top':{'style':_0x2b3877(0x261),'color':{'rgb':_0x2b3877(0x2c3)}},'bottom':{'style':_0x2b3877(0x261),'color':{'rgb':_0x2b3877(0x2c3)}},'left':{'style':_0x2b3877(0x261),'color':{'rgb':_0x2b3877(0x2c3)}},'right':{'style':_0x2b3877(0x261),'color':{'rgb':_0x2b3877(0x2c3)}}};if(_0x482830){const _0x431cf3=_0x482830[_0x2b3877(0x2b4)](';')[_0x2b3877(0x2af)]((_0x391a34,_0x100784)=>{const _0xffb37c=_0x2b3877,[_0x1c7fec,_0x1eda08]=_0x100784[_0xffb37c(0x2b4)](':')[_0xffb37c(0x29d)](_0xbc7c2=>_0xbc7c2[_0xffb37c(0x1fa)]());return _0x391a34[_0x1c7fec]=_0x1eda08,_0x391a34;},{});_0x431cf3[_0x2b3877(0x1fd)]&&(_0x140ca9[_0x2b3877(0x25e)][_0x2b3877(0x1e7)]=_0x431cf3[_0x2b3877(0x1fd)]['includes'](_0x2b3877(0x192))?'thin':'medium'),_0x431cf3['border-bottom']&&(_0x140ca9['bottom'][_0x2b3877(0x1e7)]=_0x431cf3[_0x2b3877(0x217)][_0x2b3877(0x258)](_0x2b3877(0x192))?_0x2b3877(0x192):_0x2b3877(0x271)),_0x431cf3[_0x2b3877(0x26b)]&&(_0x140ca9['left']['style']=_0x431cf3[_0x2b3877(0x26b)]['includes']('thin')?_0x2b3877(0x192):'medium'),_0x431cf3[_0x2b3877(0x170)]&&(_0x140ca9[_0x2b3877(0x2a7)][_0x2b3877(0x1e7)]=_0x431cf3[_0x2b3877(0x170)][_0x2b3877(0x258)](_0x2b3877(0x192))?_0x2b3877(0x192):_0x2b3877(0x271));}return _0x140ca9;};_0x3ac45(_0x31c916(0x2a2))[_0x31c916(0x2d2)]((_0x1e7dc5,_0x416d9d)=>{const _0x1808db=_0x31c916;let _0x3996af=[],_0x41a61e=0x0;while(_0x46912a[_0x41a61e]){_0x46912a[_0x41a61e]--,_0x41a61e++;}_0x3ac45(_0x416d9d)[_0x1808db(0x2b6)](_0x1808db(0x19f))[_0x1808db(0x2d2)]((_0x31f48d,_0x79da6f)=>{const _0xdbd8ba=_0x1808db;let _0x4f39c8=_0x3ac45(_0x79da6f)[_0xdbd8ba(0x1e9)]()[_0xdbd8ba(0x1fa)](),_0xc1a0e3=parseFloat(_0x4f39c8['replace'](/,/g,'')),_0x2a1cec={};!isNaN(_0xc1a0e3)?(_0x2a1cec['v']=_0xc1a0e3,_0x2a1cec['t']='n'):(_0x2a1cec['v']=_0x4f39c8,_0x2a1cec['t']='s');const _0x2c99bf=_0x3ac45(_0x79da6f)[_0xdbd8ba(0x2cb)]('style'),_0x28cffa=_0x404d8d(_0x2c99bf);_0x2a1cec['s']={'border':_0x28cffa},_0x3996af[_0x41a61e]=_0x2a1cec;let _0xea0673=parseInt(_0x3ac45(_0x79da6f)['attr']('colspan'))||0x1,_0x3d59b3=parseInt(_0x3ac45(_0x79da6f)[_0xdbd8ba(0x2cb)](_0xdbd8ba(0x209)))||0x1;(_0xea0673>0x1||_0x3d59b3>0x1)&&_0x4bc05c[_0xdbd8ba(0x285)]({'s':{'r':_0x1e7dc5,'c':_0x41a61e},'e':{'r':_0x1e7dc5+_0x3d59b3-0x1,'c':_0x41a61e+_0xea0673-0x1}});for(let _0x379e98=0x0;_0x379e98<_0xea0673;_0x379e98++){_0x3d59b3>0x1&&(_0x46912a[_0x41a61e+_0x379e98]=_0x3d59b3-0x1);}_0x41a61e+=_0xea0673;}),_0x1ba3e8[_0x1808db(0x285)](_0x3996af);});const _0x37e5ab=XLSX[_0x31c916(0x236)][_0x31c916(0x2cd)](),_0x11c958=XLSX['utils'][_0x31c916(0x1e8)](_0x1ba3e8);_0x4bc05c['length']>0x0&&(_0x11c958[_0x31c916(0x24a)]=_0x4bc05c);_0x11c958['!cols']=_0x1ba3e8[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x31c916(0x179)](_0x37e5ab,_0x11c958,_0x31c916(0x251));const _0x152bee=XLSX[_0x31c916(0x2c2)](_0x37e5ab,{'bookType':_0x31c916(0x26f),'type':_0x31c916(0x2bc)});_0x422888[_0x31c916(0x26d)](_0x31c916(0x273),_0x31c916(0x1ee)),_0x422888[_0x31c916(0x26d)](_0x31c916(0x2c8),_0x31c916(0x19d)),_0x422888[_0x31c916(0x1dd)](_0x152bee);}else pdf['create'](_0x30df81,_0x1e910e)[_0x31c916(0x2cc)](function(_0x35a8ca,_0x382ba3){const _0x3664d2=_0x31c916;if(_0x35a8ca){console['error'](_0x3664d2(0x1d9),_0x35a8ca),_0x422888[_0x3664d2(0x210)](0x1f4)[_0x3664d2(0x1dd)](_0x3664d2(0x1ac)+_0x35a8ca);return;}_0x422888[_0x3664d2(0x26d)](_0x3664d2(0x2c8),_0x3664d2(0x2c4)),_0x382ba3[_0x3664d2(0x2ac)](_0x422888);});}),router[a0_0x47da6c(0x149)](a0_0x47da6c(0x15a),auth,async(_0x4ff2ee,_0x4039be)=>{const _0x33c729=a0_0x47da6c;try{const {username:_0x45679e,email:_0x47358f,role:_0x48c62c}=_0x4ff2ee[_0x33c729(0x213)],_0x1008ce=_0x4ff2ee[_0x33c729(0x213)],_0x5cd38f=await profile['findOne']({'email':_0x1008ce[_0x33c729(0x235)]}),_0x559568={'year':'numeric','month':_0x33c729(0x16c),'day':_0x33c729(0x181)},_0x2505b3=await master_shop[_0x33c729(0x2b6)](),_0x1c65ca=await product[_0x33c729(0x2b6)](),_0x17235f=await warehouse[_0x33c729(0x288)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x33c729(0x283),'localField':_0x33c729(0x24f),'foreignField':'name','as':'product_docs'}},{'$unwind':_0x33c729(0x27b)},{'$project':{'product_name':_0x33c729(0x278),'product_stock':_0x33c729(0x18a)}},{'$group':{'_id':_0x33c729(0x280),'product_stock':{'$sum':_0x33c729(0x177)}}}]),_0x1f0c46=await staff['findOne']({'email':_0x1008ce['email']});if(_0x2505b3[0x0]['language']==_0x33c729(0x2ab))var _0x6e34a7=users[_0x33c729(0x1b7)];else{if(_0x2505b3[0x0]['language']==_0x33c729(0x277))var _0x6e34a7=users[_0x33c729(0x277)];else{if(_0x2505b3[0x0][_0x33c729(0x15f)]==_0x33c729(0x20b))var _0x6e34a7=users[_0x33c729(0x20b)];else{if(_0x2505b3[0x0]['language']=='Spanish')var _0x6e34a7=users['Spanish'];else{if(_0x2505b3[0x0][_0x33c729(0x15f)]==_0x33c729(0x281))var _0x6e34a7=users[_0x33c729(0x281)];else{if(_0x2505b3[0x0][_0x33c729(0x15f)]=='Portuguese\x20(BR)')var _0x6e34a7=users[_0x33c729(0x25c)];else{if(_0x2505b3[0x0][_0x33c729(0x15f)]==_0x33c729(0x175))var _0x6e34a7=users[_0x33c729(0x175)];else{if(_0x2505b3[0x0][_0x33c729(0x15f)]==_0x33c729(0x25f))var _0x6e34a7=users[_0x33c729(0x1cd)];}}}}}}}_0x4039be['render'](_0x33c729(0x20a),{'success':_0x4ff2ee[_0x33c729(0x1c3)](_0x33c729(0x15d)),'errors':_0x4ff2ee['flash']('errors'),'alldata':_0x1c65ca,'profile':_0x5cd38f,'master_shop':_0x2505b3,'role':_0x1008ce,'product_stock':_0x17235f,'language':_0x6e34a7,'staff_arr':_0x1f0c46});}catch(_0x2a976d){}});async function dataSalesReports(_0x71a82b,_0x21dff9,_0x2958b3){const _0x272464=a0_0x47da6c;let _0x1bd7dd='';const _0x289e5c=await sales_sa[_0x272464(0x288)]([{'$match':{'date':{'$gte':_0x71a82b,'$lte':_0x21dff9},'sales_staff_id':_0x2958b3}},{'$unwind':_0x272464(0x1e5)},{'$match':{'sale_product.isFG':_0x272464(0x1c0)}},{'$group':{'_id':{'product_name':_0x272464(0x284),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':_0x272464(0x189)},'totalPrice':{'$sum':_0x272464(0x1d0)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x31f032=0x0,_0x514373=0x0;for(let _0xb148ce=0x0;_0xb148ce<=_0x289e5c[_0x272464(0x2b9)]-0x1;_0xb148ce++){const _0x5164a9=_0x289e5c[_0xb148ce];var _0x4a84e8=_0x5164a9[_0x272464(0x230)][_0x272464(0x276)](undefined),_0x5d0d59=_0x5164a9[_0x272464(0x23a)]['toLocaleString'](undefined);_0x1bd7dd+=_0x272464(0x22f),_0x1bd7dd+='<td\x20class=\x22row_data\x22>'+_0x5164a9[_0x272464(0x28a)][_0x272464(0x1c9)]+_0x272464(0x15e),_0x1bd7dd+=_0x272464(0x250)+_0x5164a9['_id'][_0x272464(0x1e3)]+_0x272464(0x15e),_0x1bd7dd+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x5164a9[_0x272464(0x23a)][_0x272464(0x28b)](0x2))+_0x272464(0x15e),_0x1bd7dd+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x5164a9[_0x272464(0x230)]['toFixed'](0x2))+'</td>',_0x1bd7dd+=_0x272464(0x19b),_0x31f032+=parseFloat(_0x5164a9[_0x272464(0x23a)]),_0x514373+=parseFloat(_0x5164a9[_0x272464(0x230)]);}var _0xd44708=_0x514373['toLocaleString'](undefined),_0x317e0f=_0x31f032[_0x272464(0x276)](undefined);return _0x1bd7dd+='<tr>',_0x1bd7dd+=_0x272464(0x237),_0x1bd7dd+=_0x272464(0x1a2)+formatNumber(_0x31f032['toFixed'](0x2))+_0x272464(0x180),_0x1bd7dd+=_0x272464(0x1a2)+formatNumber(_0x514373['toFixed'](0x2))+_0x272464(0x180),_0x1bd7dd+=_0x272464(0x19b),_0x1bd7dd;}router[a0_0x47da6c(0x270)](a0_0x47da6c(0x191),auth,async(_0xcd8dc,_0x2c316e)=>{const _0x185112=a0_0x47da6c;try{const {from_date:_0x12007b,to_date:_0x49d758,isExcel:_0xac20c5}=_0xcd8dc[_0x185112(0x197)],_0x20dd97=_0xcd8dc[_0x185112(0x213)],_0x5c4a11=await staff['findOne']({'email':_0x20dd97[_0x185112(0x235)]});let _0x46ceb6=_0x185112(0x18b);var _0x3c0ec5=new Date(_0x12007b),_0x557e4a=new Date(_0x49d758);const _0x26a2ef={'year':_0x185112(0x181),'month':_0x185112(0x16c),'day':_0x185112(0x181)},_0x312467=new Intl[(_0x185112(0x21a))](_0x185112(0x268),_0x26a2ef)[_0x185112(0x1e0)](_0x3c0ec5),_0x2abce3=new Intl[(_0x185112(0x21a))](_0x185112(0x268),_0x26a2ef)[_0x185112(0x1e0)](_0x557e4a);var _0x3f0b8c=await dataSalesReports(_0x12007b,_0x49d758,_0x5c4a11['_id']['valueOf']());_0x46ceb6+=_0x185112(0x15b),_0x46ceb6+=_0x185112(0x201),_0x46ceb6+='<table>',_0x46ceb6+=_0x185112(0x22f),_0x46ceb6+=_0x185112(0x1c5),_0x46ceb6+=_0x185112(0x245),_0x46ceb6+='<th>\x20QTY\x20SOLD\x20</th>',_0x46ceb6+='<th>\x20INVOICE\x20AMOUNT\x20</th>',_0x46ceb6+='<tr>',_0x46ceb6+=_0x3f0b8c,_0x46ceb6+=_0x185112(0x19b),_0x46ceb6+='</div>',_0x46ceb6+=_0x185112(0x249);let _0x4334de='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x3871b5={'width':_0x185112(0x287),'height':_0x185112(0x150),'orientation':_0x185112(0x2a5),'border':{'top':_0x185112(0x1ae),'right':_0x185112(0x1ae),'bottom':_0x185112(0x1ae),'left':'0.1in'},'header':{'height':_0x185112(0x223),'contents':_0x185112(0x2bb)+_0x4334de+_0x185112(0x151)+_0x5c4a11['name']+_0x185112(0x2c6)+_0x312467+_0x185112(0x216)+_0x2abce3+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x185112(0x28d),'contents':{'default':_0x185112(0x1bf)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x185112(0x224)}}};if(_0xac20c5=='on'){const _0x41228a=cheerio[_0x185112(0x295)](_0x46ceb6);let _0x5cbcbc=[],_0x47e5d5=[],_0x2d862e=[];const _0x4dab08=_0x3f75ed=>{const _0x3c5247=_0x185112,_0xd2395a={'top':{'style':_0x3c5247(0x261),'color':{'rgb':_0x3c5247(0x2c3)}},'bottom':{'style':_0x3c5247(0x261),'color':{'rgb':_0x3c5247(0x2c3)}},'left':{'style':_0x3c5247(0x261),'color':{'rgb':'000000'}},'right':{'style':_0x3c5247(0x261),'color':{'rgb':'000000'}}};if(_0x3f75ed){const _0x39e0ee=_0x3f75ed[_0x3c5247(0x2b4)](';')[_0x3c5247(0x2af)]((_0x218ab7,_0x3d2987)=>{const _0x9ef796=_0x3c5247,[_0x3a2022,_0x39c1eb]=_0x3d2987[_0x9ef796(0x2b4)](':')[_0x9ef796(0x29d)](_0x5c005e=>_0x5c005e[_0x9ef796(0x1fa)]());return _0x218ab7[_0x3a2022]=_0x39c1eb,_0x218ab7;},{});_0x39e0ee[_0x3c5247(0x1fd)]&&(_0xd2395a[_0x3c5247(0x25e)][_0x3c5247(0x1e7)]=_0x39e0ee[_0x3c5247(0x1fd)][_0x3c5247(0x258)]('thin')?_0x3c5247(0x192):_0x3c5247(0x271)),_0x39e0ee[_0x3c5247(0x217)]&&(_0xd2395a[_0x3c5247(0x1f7)]['style']=_0x39e0ee['border-bottom'][_0x3c5247(0x258)](_0x3c5247(0x192))?'thin':_0x3c5247(0x271)),_0x39e0ee[_0x3c5247(0x26b)]&&(_0xd2395a['left'][_0x3c5247(0x1e7)]=_0x39e0ee['border-left'][_0x3c5247(0x258)]('thin')?_0x3c5247(0x192):_0x3c5247(0x271)),_0x39e0ee[_0x3c5247(0x170)]&&(_0xd2395a['right'][_0x3c5247(0x1e7)]=_0x39e0ee['border-right']['includes'](_0x3c5247(0x192))?_0x3c5247(0x192):'medium');}return _0xd2395a;};_0x41228a(_0x185112(0x2a2))['each']((_0x71b899,_0x50baac)=>{const _0x13a475=_0x185112;let _0x271fe7=[],_0x3d6ed3=0x0;while(_0x2d862e[_0x3d6ed3]){_0x2d862e[_0x3d6ed3]--,_0x3d6ed3++;}_0x41228a(_0x50baac)[_0x13a475(0x2b6)](_0x13a475(0x19f))[_0x13a475(0x2d2)]((_0x3efaf6,_0x5030ac)=>{const _0x41e302=_0x13a475;let _0x1750ca=_0x41228a(_0x5030ac)[_0x41e302(0x1e9)]()[_0x41e302(0x1fa)](),_0x159112=parseFloat(_0x1750ca[_0x41e302(0x20e)](/,/g,'')),_0x26a8f3={};!isNaN(_0x159112)?(_0x26a8f3['v']=_0x159112,_0x26a8f3['t']='n'):(_0x26a8f3['v']=_0x1750ca,_0x26a8f3['t']='s');const _0x13f3bd=_0x41228a(_0x5030ac)[_0x41e302(0x2cb)](_0x41e302(0x1e7)),_0x366093=_0x4dab08(_0x13f3bd);_0x26a8f3['s']={'border':_0x366093},_0x271fe7[_0x3d6ed3]=_0x26a8f3;let _0x5be6ff=parseInt(_0x41228a(_0x5030ac)[_0x41e302(0x2cb)](_0x41e302(0x2b1)))||0x1,_0x2d46cb=parseInt(_0x41228a(_0x5030ac)['attr'](_0x41e302(0x209)))||0x1;(_0x5be6ff>0x1||_0x2d46cb>0x1)&&_0x47e5d5[_0x41e302(0x285)]({'s':{'r':_0x71b899,'c':_0x3d6ed3},'e':{'r':_0x71b899+_0x2d46cb-0x1,'c':_0x3d6ed3+_0x5be6ff-0x1}});for(let _0x307219=0x0;_0x307219<_0x5be6ff;_0x307219++){_0x2d46cb>0x1&&(_0x2d862e[_0x3d6ed3+_0x307219]=_0x2d46cb-0x1);}_0x3d6ed3+=_0x5be6ff;}),_0x5cbcbc[_0x13a475(0x285)](_0x271fe7);});const _0x36fed7=XLSX['utils']['book_new'](),_0x23e00f=XLSX['utils']['aoa_to_sheet'](_0x5cbcbc);_0x47e5d5['length']>0x0&&(_0x23e00f['!merges']=_0x47e5d5);_0x23e00f[_0x185112(0x269)]=_0x5cbcbc[0x0][_0x185112(0x29d)](()=>({'wpx':0x64})),XLSX[_0x185112(0x236)][_0x185112(0x179)](_0x36fed7,_0x23e00f,'Sales\x20Report');const _0x105b75=XLSX[_0x185112(0x2c2)](_0x36fed7,{'bookType':'xlsx','type':'buffer'});_0x2c316e[_0x185112(0x26d)]('Content-Disposition',_0x185112(0x1ee)),_0x2c316e['setHeader']('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x2c316e[_0x185112(0x1dd)](_0x105b75);}else pdf[_0x185112(0x27c)](_0x46ceb6,_0x3871b5)[_0x185112(0x2cc)](function(_0x343b8f,_0x5c48a7){const _0x30466a=_0x185112;if(_0x343b8f){_0x2c316e['status'](0x1f4)[_0x30466a(0x1dd)]('Error\x20generating\x20PDF');return;}_0x2c316e['setHeader'](_0x30466a(0x2c8),_0x30466a(0x2c4)),_0x5c48a7[_0x30466a(0x2ac)](_0x2c316e);});}catch(_0x24a38a){}}),router[a0_0x47da6c(0x149)](a0_0x47da6c(0x20d),auth,async(_0x21f6bf,_0x185688)=>{const _0x5617f5=a0_0x47da6c;try{const {username:_0x167cfa,email:_0x3f1518,role:_0x2a7bd3}=_0x21f6bf[_0x5617f5(0x213)],_0x2f5a69=_0x21f6bf[_0x5617f5(0x213)],_0x2ed933=await profile[_0x5617f5(0x23c)]({'email':_0x2f5a69[_0x5617f5(0x235)]}),_0x53972d={'year':_0x5617f5(0x181),'month':_0x5617f5(0x16c),'day':_0x5617f5(0x181)},_0x169c61=await master_shop[_0x5617f5(0x2b6)](),_0x80b619=await product['find'](),_0x56b7bb=await warehouse[_0x5617f5(0x288)]([{'$unwind':_0x5617f5(0x263)},{'$lookup':{'from':_0x5617f5(0x283),'localField':_0x5617f5(0x24f),'foreignField':_0x5617f5(0x29c),'as':_0x5617f5(0x24d)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x5617f5(0x18a)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x5617f5(0x177)}}}]);if(_0x169c61[0x0][_0x5617f5(0x15f)]==_0x5617f5(0x2ab))var _0x2478c3=users['English'];else{if(_0x169c61[0x0][_0x5617f5(0x15f)]=='Hindi')var _0x2478c3=users[_0x5617f5(0x277)];else{if(_0x169c61[0x0][_0x5617f5(0x15f)]==_0x5617f5(0x20b))var _0x2478c3=users[_0x5617f5(0x20b)];else{if(_0x169c61[0x0][_0x5617f5(0x15f)]==_0x5617f5(0x1ea))var _0x2478c3=users['Spanish'];else{if(_0x169c61[0x0][_0x5617f5(0x15f)]==_0x5617f5(0x281))var _0x2478c3=users[_0x5617f5(0x281)];else{if(_0x169c61[0x0]['language']==_0x5617f5(0x227))var _0x2478c3=users[_0x5617f5(0x25c)];else{if(_0x169c61[0x0][_0x5617f5(0x15f)]=='Chinese')var _0x2478c3=users['Chinese'];else{if(_0x169c61[0x0][_0x5617f5(0x15f)]=='Arabic\x20(ae)')var _0x2478c3=users['Arabic'];}}}}}}}_0x185688[_0x5617f5(0x1bd)](_0x5617f5(0x172),{'success':_0x21f6bf[_0x5617f5(0x1c3)]('success'),'errors':_0x21f6bf[_0x5617f5(0x1c3)](_0x5617f5(0x2b3)),'alldata':_0x80b619,'profile':_0x2ed933,'master_shop':_0x169c61,'role':_0x2f5a69,'product_stock':_0x56b7bb,'language':_0x2478c3});}catch(_0x5bc7ff){}});async function dataInventoryReports(_0x4eac97,_0x3295cb,_0x469d63){const _0x49fa1c=a0_0x47da6c,_0x3486d6=await sales_sa[_0x49fa1c(0x288)]([{'$match':{'date':{'$gte':_0x4eac97,'$lte':_0x3295cb},'sales_staff_id':_0x469d63}},{'$unwind':_0x49fa1c(0x1e5)},{'$group':{'_id':{'product_name':_0x49fa1c(0x284),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':_0x49fa1c(0x229)}}},{'$sort':{'_id.product_name':0x1}}]),_0x42d85d=mongoose[_0x49fa1c(0x211)][_0x49fa1c(0x22a)],_0x35c478=await staff[_0x49fa1c(0x288)]([{'$match':{'_id':_0x42d85d(_0x469d63)}},{'$unwind':'$product_list'},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x49fa1c(0x2d5),'product_code':_0x49fa1c(0x1b6)},'sumqty':{'$sum':'$product_list.product_stock'}}},{'$sort':{'_id.product_name':0x1}}]),_0x3de181=await sales_inv_data[_0x49fa1c(0x288)]([{'$match':{'date':{'$gte':_0x4eac97,'$lte':_0x3295cb},'sales_staff_id':_0x469d63}},{'$unwind':_0x49fa1c(0x1e5)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x49fa1c(0x298)},'totalQTYsum':{'$sum':_0x49fa1c(0x286)}}}]);console['log'](_0x3de181);let _0x5acd7b='';var _0x4acee8=0x0;for(let _0x344dae=0x0;_0x344dae<=_0x35c478[_0x49fa1c(0x2b9)]-0x1;_0x344dae++){const _0x215705=_0x35c478[_0x344dae];_0x5acd7b+='<tr>',_0x5acd7b+=_0x49fa1c(0x1e2)+_0x215705['_id']['product_code']+'</td>',_0x5acd7b+=_0x49fa1c(0x1cb)+_0x215705['_id']['product_name']+'</td>';var _0x28e252=_0x215705['sumqty'],_0x45cffe=0x0;for(let _0x41a138=0x0;_0x41a138<=_0x3486d6[_0x49fa1c(0x2b9)]-0x1;_0x41a138++){const _0x12769d=_0x3486d6[_0x41a138];_0x215705[_0x49fa1c(0x28a)][_0x49fa1c(0x1c9)]==_0x12769d[_0x49fa1c(0x28a)][_0x49fa1c(0x1c9)]&&_0x215705[_0x49fa1c(0x28a)][_0x49fa1c(0x1e3)]==_0x12769d['_id'][_0x49fa1c(0x1e3)]&&(_0x45cffe=_0x12769d[_0x49fa1c(0x23a)]);}var _0x242e42=0x0;for(let _0x41b7f8=0x0;_0x41b7f8<=_0x3de181[_0x49fa1c(0x2b9)]-0x1;_0x41b7f8++){const _0x912a08=_0x3de181[_0x41b7f8];_0x215705[_0x49fa1c(0x28a)][_0x49fa1c(0x1c9)]==_0x912a08[_0x49fa1c(0x28a)][_0x49fa1c(0x1c9)]&&_0x215705['_id'][_0x49fa1c(0x1e3)]==_0x912a08[_0x49fa1c(0x28a)][_0x49fa1c(0x1e3)]&&(_0x242e42=_0x912a08['totalQTYsum']);}_0x4acee8=_0x28e252-_0x242e42+_0x45cffe,_0x5acd7b+='<td\x20class=\x22row_data\x22>'+_0x4acee8+'</td>';let _0x346975=![];for(let _0x13ee98=0x0;_0x13ee98<=_0x3de181[_0x49fa1c(0x2b9)]-0x1;_0x13ee98++){const _0x270a87=_0x3de181[_0x13ee98];if(_0x215705[_0x49fa1c(0x28a)]['product_code']==_0x270a87['_id']['product_code']&&_0x215705[_0x49fa1c(0x28a)]['product_name']==_0x270a87[_0x49fa1c(0x28a)][_0x49fa1c(0x1e3)]){_0x5acd7b+=_0x49fa1c(0x250)+_0x270a87['totalQTYsum']+'</td>',_0x346975=!![];break;}}!_0x346975&&(_0x5acd7b+=_0x49fa1c(0x24c));let _0x95c48b=![];for(let _0x48e5be=0x0;_0x48e5be<=_0x3486d6[_0x49fa1c(0x2b9)]-0x1;_0x48e5be++){const _0x5db378=_0x3486d6[_0x48e5be];if(_0x215705[_0x49fa1c(0x28a)][_0x49fa1c(0x1c9)]==_0x5db378['_id'][_0x49fa1c(0x1c9)]&&_0x215705[_0x49fa1c(0x28a)][_0x49fa1c(0x1e3)]==_0x5db378[_0x49fa1c(0x28a)]['product_name']){_0x5acd7b+='<td\x20class=\x22row_data\x22>'+_0x5db378[_0x49fa1c(0x23a)]+_0x49fa1c(0x15e),_0x95c48b=!![];break;}}!_0x95c48b&&(_0x5acd7b+=_0x49fa1c(0x24c)),_0x5acd7b+=_0x49fa1c(0x250)+_0x215705[_0x49fa1c(0x23a)]+_0x49fa1c(0x15e),_0x5acd7b+=_0x49fa1c(0x19b);}return _0x5acd7b;}router[a0_0x47da6c(0x270)]('/inventory_sum/pdf',auth,async(_0x1285cd,_0x291929)=>{const _0x18495f=a0_0x47da6c;try{const {from_date:_0x3f493a,to_date:_0x509c0d}=_0x1285cd[_0x18495f(0x197)],_0x4d7729=_0x1285cd[_0x18495f(0x213)],_0x14e6c6=await staff[_0x18495f(0x23c)]({'email':_0x4d7729['email']});let _0x14120c=_0x18495f(0x18b);var _0x3e8570=new Date(_0x3f493a),_0x2e5a9d=new Date(_0x509c0d);const _0x5b8f67={'year':_0x18495f(0x181),'month':_0x18495f(0x16c),'day':_0x18495f(0x181)},_0x5a0d33=new Intl[(_0x18495f(0x21a))]('en-US',_0x5b8f67)[_0x18495f(0x1e0)](_0x3e8570),_0x1c8705=new Intl[(_0x18495f(0x21a))](_0x18495f(0x268),_0x5b8f67)[_0x18495f(0x1e0)](_0x2e5a9d);var _0x54cf5f=await dataInventoryReports(_0x3f493a,_0x509c0d,_0x14e6c6['_id'][_0x18495f(0x2a8)]());_0x14120c+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x14120c+=_0x18495f(0x1b8),_0x14120c+='<p>'+_0x5a0d33+_0x18495f(0x216)+_0x1c8705+'</p>',_0x14120c+='<div\x20class=\x22row\x22>',_0x14120c+=_0x18495f(0x201),_0x14120c+='<table>',_0x14120c+=_0x18495f(0x22f),_0x14120c+=_0x18495f(0x1c5),_0x14120c+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x14120c+='<th>\x20BEG\x20BALANCE\x20</th>',_0x14120c+=_0x18495f(0x2b5),_0x14120c+=_0x18495f(0x2b8),_0x14120c+=_0x18495f(0x162),_0x14120c+=_0x18495f(0x22f),_0x14120c+=_0x54cf5f,_0x14120c+=_0x18495f(0x19b),_0x14120c+=_0x18495f(0x249),_0x14120c+=_0x18495f(0x249);const _0x428d8b={'format':'Letter','orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf['create'](_0x14120c,_0x428d8b)[_0x18495f(0x2cc)](function(_0x16cd16,_0x1c97ad){const _0x29fdf2=_0x18495f;if(_0x16cd16){_0x291929['status'](0x1f4)['send'](_0x29fdf2(0x1ac));return;}_0x291929[_0x29fdf2(0x26d)]('Content-Type',_0x29fdf2(0x2c4)),_0x1c97ad[_0x29fdf2(0x2ac)](_0x291929);});}catch(_0x80fa48){}}),router['get'](a0_0x47da6c(0x1a1),auth,async(_0x211b4a,_0xb41d09)=>{const _0x8a078d=a0_0x47da6c;try{const {username:_0x5b3af6,email:_0x304129,role:_0x29aa7e}=_0x211b4a[_0x8a078d(0x213)],_0x26952a=_0x211b4a[_0x8a078d(0x213)],_0x53ea84=await profile[_0x8a078d(0x23c)]({'email':_0x26952a[_0x8a078d(0x235)]}),_0xe142f3={'year':'numeric','month':'long','day':_0x8a078d(0x181)},_0x1d8def=await master_shop[_0x8a078d(0x2b6)]();console[_0x8a078d(0x22b)](_0x8a078d(0x25d),_0x1d8def);const _0x5478d8=await product[_0x8a078d(0x2b6)]();console['log'](_0x8a078d(0x2d1),_0x5478d8);const _0x9e04d5=await warehouse[_0x8a078d(0x288)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x8a078d(0x283),'localField':_0x8a078d(0x24f),'foreignField':_0x8a078d(0x29c),'as':_0x8a078d(0x24d)}},{'$unwind':_0x8a078d(0x27b)},{'$project':{'product_name':_0x8a078d(0x278),'product_stock':_0x8a078d(0x18a)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x8a078d(0x177)}}}]);console[_0x8a078d(0x22b)](_0x8a078d(0x2a3),_0x9e04d5),_0x9e04d5[_0x8a078d(0x1f3)](_0x4af707=>{const _0x2e1e23=_0x8a078d,_0x25cc06=_0x5478d8[_0x2e1e23(0x29d)](_0x4f9b94=>{const _0x93d5f4=_0x2e1e23;_0x4f9b94[_0x93d5f4(0x29c)]==_0x4af707['_id']&&(_0x4f9b94[_0x93d5f4(0x29a)]=parseInt(_0x4f9b94['stock'])+parseInt(_0x4af707[_0x93d5f4(0x1b5)]));});});const _0xba8c4e=await staff[_0x8a078d(0x23c)]({'email':_0x26952a[_0x8a078d(0x235)]});if(_0x1d8def[0x0][_0x8a078d(0x15f)]==_0x8a078d(0x2ab))var _0x215020=users[_0x8a078d(0x1b7)];else{if(_0x1d8def[0x0]['language']==_0x8a078d(0x277))var _0x215020=users['Hindi'];else{if(_0x1d8def[0x0][_0x8a078d(0x15f)]==_0x8a078d(0x20b))var _0x215020=users[_0x8a078d(0x20b)];else{if(_0x1d8def[0x0][_0x8a078d(0x15f)]=='Spanish')var _0x215020=users[_0x8a078d(0x1ea)];else{if(_0x1d8def[0x0][_0x8a078d(0x15f)]==_0x8a078d(0x281))var _0x215020=users[_0x8a078d(0x281)];else{if(_0x1d8def[0x0][_0x8a078d(0x15f)]==_0x8a078d(0x227))var _0x215020=users[_0x8a078d(0x25c)];else{if(_0x1d8def[0x0][_0x8a078d(0x15f)]=='Chinese')var _0x215020=users[_0x8a078d(0x175)];else{if(_0x1d8def[0x0]['language']=='Arabic\x20(ae)')var _0x215020=users[_0x8a078d(0x1cd)];}}}}}}}_0xb41d09[_0x8a078d(0x1bd)](_0x8a078d(0x188),{'success':_0x211b4a['flash'](_0x8a078d(0x15d)),'errors':_0x211b4a[_0x8a078d(0x1c3)](_0x8a078d(0x2b3)),'alldata':_0x5478d8,'profile':_0x53ea84,'master_shop':_0x1d8def,'role':_0x26952a,'product_stock':_0x9e04d5,'language':_0x215020,'staff_arr':_0xba8c4e});}catch(_0x460c81){}});async function agentsdataDSICheck_DSRR(_0x3d1a83,_0x3a2ce2,_0x2364cb,_0x56f388){const _0x47b2b7=a0_0x47da6c;let _0xa3ab54=new Date(_0x3d1a83);_0xa3ab54['setDate'](_0xa3ab54[_0x47b2b7(0x19a)]()-0x1);let _0x1695c2=_0xa3ab54['toISOString']()['split']('T')[0x0];const _0x49aac4=await product[_0x47b2b7(0x288)]([{'$group':{'_id':{'brand':_0x47b2b7(0x18f),'category':_0x47b2b7(0x1e1)},'products':{'$push':{'name':_0x47b2b7(0x2bf),'product_code':_0x47b2b7(0x161)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x422bf1=[];_0x422bf1[_0x47b2b7(0x202)]=[];for(let _0x46566c=0x0;_0x46566c<=_0x49aac4[_0x47b2b7(0x2b9)]-0x1;_0x46566c++){const _0xe2674f=_0x49aac4[_0x46566c];_0x422bf1[_0x47b2b7(0x202)]['push'](_0xe2674f);}const _0xa776ec=await product[_0x47b2b7(0x288)]([{'$group':{'_id':{'category':_0x47b2b7(0x1e1)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x47b2b7(0x2bf)}}}},{'$sort':{'_id.category':-0x1}}]),_0x411792=await product[_0x47b2b7(0x288)]([{'$group':{'_id':{'category':_0x47b2b7(0x1e1),'brand':'$brand'}}},{'$group':{'_id':_0x47b2b7(0x219),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x16f395=await sales_sa[_0x47b2b7(0x288)]([{'$match':{'date':_0x3d1a83,'sales_staff_id':_0x3a2ce2,'sale_product.isFG':_0x47b2b7(0x1c0)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x47b2b7(0x283),'localField':_0x47b2b7(0x293),'foreignField':_0x47b2b7(0x1c9),'as':_0x47b2b7(0x22c)}},{'$unwind':_0x47b2b7(0x1b0)},{'$group':{'_id':{'dsi':_0x47b2b7(0x14e),'date':_0x47b2b7(0x259),'customer':_0x47b2b7(0x184),'status_data':_0x47b2b7(0x187)},'totalQty':{'$sum':_0x47b2b7(0x189)},'cash':{'$first':'$cash'},'amount':{'$first':_0x47b2b7(0x193)},'bank':{'$first':_0x47b2b7(0x2cf)},'check_no':{'$first':_0x47b2b7(0x2ad)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x47b2b7(0x1d0),'discount':_0x47b2b7(0x1c8),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x47b2b7(0x203),'product_code':_0x47b2b7(0x22d),'category':_0x47b2b7(0x17b),'brand':_0x47b2b7(0x2d4),'gross_price':_0x47b2b7(0x206),'isFG':_0x47b2b7(0x18d),'prod_cat':'$sale_product.prod_cat','prod_id':_0x47b2b7(0x266)}}}}},{'$unwind':_0x47b2b7(0x22e)},{'$group':{'_id':{'dsi':_0x47b2b7(0x1ff),'date':'$_id.date','customer':'$_id.customer','status_data':_0x47b2b7(0x244),'category':_0x47b2b7(0x1f8),'brand':_0x47b2b7(0x246),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x47b2b7(0x19e)},'totalGross':{'$sum':{'$multiply':[_0x47b2b7(0x19e),_0x47b2b7(0x26a)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x47b2b7(0x14b)},'adj_discount':{'$sum':_0x47b2b7(0x243)},'cash':{'$first':_0x47b2b7(0x228)},'amount':{'$first':_0x47b2b7(0x193)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x47b2b7(0x2ad)},'due_date':{'$first':'$due_date'},'product_details':{'$first':_0x47b2b7(0x25a)}}},{'$group':{'_id':{'dsi':_0x47b2b7(0x1ff),'date':'$_id.date','customer':_0x47b2b7(0x26c),'status_data':_0x47b2b7(0x244)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x47b2b7(0x296)},'NetPrice':{'$sum':_0x47b2b7(0x1f1)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x47b2b7(0x1b1)},'cash':{'$first':_0x47b2b7(0x228)},'amount':{'$first':_0x47b2b7(0x193)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x47b2b7(0x2ad)},'due_date':{'$first':_0x47b2b7(0x226)},'products':{'$push':{'qty':_0x47b2b7(0x1dc),'category':_0x47b2b7(0x219),'brand':_0x47b2b7(0x17a),'product_details':_0x47b2b7(0x263)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x58cc79=await sales_sa['aggregate']([{'$match':{'date':_0x1695c2,'sales_staff_id':_0x3a2ce2,'sale_product.isFG':_0x47b2b7(0x1c0)}},{'$unwind':_0x47b2b7(0x1e5)},{'$lookup':{'from':'products','localField':_0x47b2b7(0x293),'foreignField':_0x47b2b7(0x1c9),'as':'product_info'}},{'$unwind':_0x47b2b7(0x1b0)},{'$group':{'_id':{'dsi':_0x47b2b7(0x14e),'date':_0x47b2b7(0x259),'customer':_0x47b2b7(0x184)},'totalQty':{'$sum':_0x47b2b7(0x189)},'cash':{'$first':_0x47b2b7(0x228)},'amount':{'$first':_0x47b2b7(0x193)},'bank':{'$first':_0x47b2b7(0x2cf)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x47b2b7(0x226)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x47b2b7(0x1c8),'adj_discount':_0x47b2b7(0x1f9),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x47b2b7(0x17b),'brand':_0x47b2b7(0x2d4),'gross_price':_0x47b2b7(0x206),'isFG':'$sale_product.isFG','prod_cat':_0x47b2b7(0x1fe),'prod_id':_0x47b2b7(0x266)}}}}},{'$unwind':_0x47b2b7(0x22e)},{'$group':{'_id':{'dsi':_0x47b2b7(0x1ff),'date':_0x47b2b7(0x292),'customer':_0x47b2b7(0x26c),'category':'$products.product_details.category','brand':_0x47b2b7(0x246),'prod_id':_0x47b2b7(0x2c1)},'totalQty':{'$sum':_0x47b2b7(0x19e)},'cash':{'$first':_0x47b2b7(0x228)},'amount':{'$first':_0x47b2b7(0x193)},'bank':{'$first':_0x47b2b7(0x2cf)},'check_no':{'$first':_0x47b2b7(0x2ad)},'due_date':{'$first':_0x47b2b7(0x226)},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x47b2b7(0x27d)},'discount':{'$sum':_0x47b2b7(0x14b)},'adj_discount':{'$sum':_0x47b2b7(0x243)},'product_details':{'$first':_0x47b2b7(0x25a)}}},{'$group':{'_id':{'dsi':_0x47b2b7(0x1ff),'date':_0x47b2b7(0x292),'customer':_0x47b2b7(0x26c)},'totalQty':{'$sum':_0x47b2b7(0x1dc)},'cash':{'$first':_0x47b2b7(0x228)},'amount':{'$first':'$amount'},'bank':{'$first':_0x47b2b7(0x2cf)},'check_no':{'$first':_0x47b2b7(0x2ad)},'due_date':{'$first':_0x47b2b7(0x226)},'totalGross':{'$sum':_0x47b2b7(0x296)},'NetPrice':{'$sum':_0x47b2b7(0x1f1)},'discount':{'$sum':_0x47b2b7(0x232)},'adj_discount':{'$sum':_0x47b2b7(0x1b1)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x47b2b7(0x17a),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x3d943f=await sales_sa[_0x47b2b7(0x288)]([{'$match':{'date':_0x3d1a83,'sales_staff_id':_0x3a2ce2,'status_data':'true'}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x206ff8=await staff[_0x47b2b7(0x174)](_0x3a2ce2);let _0x54c596=[],_0x38f9ff={},_0x32da86={};var _0x211338=0x0,_0x4dbbf8=0x0,_0x40287b=0x0,_0x140933=0x0,_0x5e726b=0x0;const _0x1244b0=0x6;var _0x2abb4a=0x0,_0x51c5ef=0x0;for(let _0x220493=0x0;_0x220493<=_0x16f395[_0x47b2b7(0x2b9)]-0x1;_0x220493++){const _0x39100a=_0x16f395[_0x220493];let _0x57d449=_0x47b2b7(0x22f);_0x57d449+=_0x47b2b7(0x1ed),_0x57d449+=_0x47b2b7(0x166)+_0x39100a[_0x47b2b7(0x28a)]['customer']+_0x47b2b7(0x15e),_0x57d449+=_0x47b2b7(0x166)+_0x39100a[_0x47b2b7(0x28a)][_0x47b2b7(0x1de)]+_0x47b2b7(0x15e);let _0x290ac7={},_0x1bc6ef={},_0xe68db8={};var _0x2302de={},_0x304395={},_0x1333e3={},_0x5ab407=0x0;for(let _0xcb9a76=0x0;_0xcb9a76<=_0x39100a[_0x47b2b7(0x283)][_0x47b2b7(0x2b9)]-0x1;_0xcb9a76++){const _0x3a35b9=_0x39100a['products'][_0xcb9a76];_0x290ac7[_0x3a35b9[_0x47b2b7(0x1a8)]+'-'+_0x3a35b9[_0x47b2b7(0x194)]]=_0x3a35b9[_0x47b2b7(0x291)],_0x1bc6ef[[_0x3a35b9[_0x47b2b7(0x1a8)]+'-'+_0x3a35b9[_0x47b2b7(0x194)]]]=_0x3a35b9['product_details'][_0x47b2b7(0x21e)],_0xe68db8[[_0x3a35b9[_0x47b2b7(0x1a8)]+'-'+_0x3a35b9[_0x47b2b7(0x194)]]]=_0x3a35b9['product_details'][_0x47b2b7(0x29e)];const _0x514180=_0x3a35b9[_0x47b2b7(0x1a8)]+'-'+_0x3a35b9[_0x47b2b7(0x194)];!Array[_0x47b2b7(0x239)](_0x32da86[_0x514180])&&(_0x32da86[_0x514180]=[]);!Array['isArray'](_0x32da86[_0x514180])&&(_0x32da86[_0x514180]=[]);_0x32da86[_0x514180][_0x47b2b7(0x285)](_0x3a35b9[_0x47b2b7(0x291)]);if(_0x3a35b9[_0x47b2b7(0x299)]['prod_cat']=='P')_0x3a35b9[_0x47b2b7(0x299)]['isFG']==_0x47b2b7(0x252)?(!_0x1333e3[_0x514180]&&(_0x1333e3[_0x514180]=0x0),_0x1333e3[_0x514180]=_0x3a35b9['qty']):(!_0x2302de[_0x514180]&&(_0x2302de[_0x514180]=0x0),_0x2302de[_0x514180]=_0x3a35b9[_0x47b2b7(0x291)]);else _0x3a35b9['product_details'][_0x47b2b7(0x29e)]=='S'&&(_0x3a35b9[_0x47b2b7(0x299)][_0x47b2b7(0x21e)]==_0x47b2b7(0x252)?(!_0x1333e3[_0x514180]&&(_0x1333e3[_0x514180]=0x0),_0x1333e3[_0x514180]=_0x3a35b9[_0x47b2b7(0x291)]):(!_0x304395[_0x514180]&&(_0x304395[_0x514180]=0x0),_0x304395[_0x514180]=_0x3a35b9[_0x47b2b7(0x291)]));_0x5ab407++;}for(let _0x4988f9=0x0;_0x4988f9<=_0x422bf1[_0x47b2b7(0x202)][_0x47b2b7(0x2b9)]-0x1;_0x4988f9++){const _0x2f3d6e=_0x422bf1[_0x47b2b7(0x202)][_0x4988f9],_0x943cb=_0x2f3d6e[_0x47b2b7(0x28a)][_0x47b2b7(0x1a8)]+'-'+_0x2f3d6e[_0x47b2b7(0x28a)]['category'],_0x114355=_0xe68db8[_0x943cb]!==undefined?_0xe68db8[_0x943cb]:'NA';var _0x4a6a2c=_0x2302de[_0x943cb]!==undefined?_0x2302de[_0x943cb][_0x47b2b7(0x28b)](0x2):'',_0x173681=_0x304395[_0x943cb]!==undefined?_0x304395[_0x943cb]['toFixed'](0x2):'',_0x11603f=_0x1333e3[_0x943cb]!==undefined?_0x1333e3[_0x943cb][_0x47b2b7(0x28b)](0x2):'';_0x57d449+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x4a6a2c+_0x47b2b7(0x15e),_0x57d449+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x173681+_0x47b2b7(0x15e),_0x57d449+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x11603f+_0x47b2b7(0x15e);}var _0x56681c=formatNumber(parseFloat(_0x39100a[_0x47b2b7(0x29b)])),_0x422d1c=formatNumber(parseFloat(_0x39100a['amount']));isNaN(_0x422d1c)&&(_0x422d1c=0x0),_0x57d449+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x56681c+_0x47b2b7(0x15e),_0x57d449+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x422d1c+_0x47b2b7(0x15e),_0x57d449+=_0x47b2b7(0x166)+_0x39100a[_0x47b2b7(0x212)]+_0x47b2b7(0x15e),_0x57d449+=_0x47b2b7(0x166)+_0x39100a[_0x47b2b7(0x1b9)]+_0x47b2b7(0x15e),_0x57d449+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x39100a['due_date']+_0x47b2b7(0x15e),_0x40287b=_0x39100a[_0x47b2b7(0x1be)]+_0x39100a['adj_discount'],_0x2abb4a+=parseFloat(_0x39100a['cash']),_0x51c5ef+=parseFloat(_0x422d1c),_0x54c596[_0x47b2b7(0x285)](_0x57d449);}function _0x26715c(_0x393c80,_0x445545){const _0x4f0fe0=_0x47b2b7,_0x5180ef=[];for(let _0x41e49b=0x0;_0x41e49b<=_0x393c80['length']-0x1;_0x41e49b+=_0x445545){_0x5180ef['push'](_0x393c80[_0x4f0fe0(0x1a9)](_0x41e49b,_0x41e49b+_0x445545));}return _0x5180ef;}const _0x30e7c1=_0x26715c(_0x54c596,_0x1244b0);let _0x111b63='';return _0x30e7c1[_0x47b2b7(0x1f3)]((_0xac111,_0x42be45)=>{const _0x35aabf=_0x47b2b7;_0x42be45>0x0&&(_0x111b63+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x111b63+=_0x35aabf(0x205),_0x111b63+='<thead>';const _0x519118=new Date(_0x3d1a83),_0x4c1796={'year':_0x35aabf(0x181),'month':_0x35aabf(0x16c),'day':_0x35aabf(0x181),'timeZone':'Asia/Manila'},_0x3d2782=_0x519118[_0x35aabf(0x1a6)](_0x35aabf(0x268),_0x4c1796);_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x1d4)+_0x56f388+_0x35aabf(0x180),_0x111b63+='</tr>',_0x111b63+=_0x35aabf(0x22f),_0x111b63+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0x206ff8[_0x35aabf(0x29c)]+_0x35aabf(0x15e),_0x111b63+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>',_0x111b63+=_0x35aabf(0x242),_0x111b63+='<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>',_0x111b63+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x111b63+=_0x35aabf(0x168),_0x111b63+=_0x35aabf(0x1cc),_0x111b63+=_0x35aabf(0x2b0),_0x111b63+=_0x35aabf(0x200),_0x111b63+=_0x35aabf(0x19b),_0x111b63+=_0x35aabf(0x22f),_0x111b63+=_0x35aabf(0x1a4),_0x111b63+=_0x35aabf(0x171)+_0x3d2782+_0x35aabf(0x15e),_0x111b63+=_0x35aabf(0x2a0),_0x111b63+=_0x35aabf(0x1d7),_0x111b63+=_0x35aabf(0x208),_0x111b63+=_0x35aabf(0x208),_0x111b63+='</tr>',_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x218),_0x111b63+=_0x35aabf(0x178),_0x111b63+=_0x35aabf(0x294),_0x111b63+=_0x35aabf(0x208),_0x111b63+=_0x35aabf(0x208),_0x111b63+=_0x35aabf(0x19b),_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x23d),_0x111b63+=_0x35aabf(0x19b),_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x1eb),_0x111b63+='<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>',_0x111b63+=_0x35aabf(0x19b),_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x1b4),_0x111b63+=_0x35aabf(0x204),_0x111b63+=_0x35aabf(0x18c);for(let _0x4902f7=0x0;_0x4902f7<=_0xa776ec[_0x35aabf(0x2b9)]-0x1;_0x4902f7++){const _0x3dcba3=_0xa776ec[_0x4902f7];for(let _0x45716f=0x0;_0x45716f<_0x422bf1[_0x35aabf(0x202)][_0x35aabf(0x2b9)];_0x45716f++){const _0xbae7bb=_0x422bf1[_0x35aabf(0x202)][_0x45716f];if(_0xbae7bb[_0x35aabf(0x28a)]['category']===_0x3dcba3['_id'][_0x35aabf(0x194)]){var _0x58908f='';switch(_0x3dcba3[_0x35aabf(0x28a)][_0x35aabf(0x194)]){case _0x35aabf(0x1e6):_0x58908f=_0xbae7bb[_0x35aabf(0x28a)]['brand']+_0x35aabf(0x260);break;case _0x35aabf(0x231):_0x58908f=_0xbae7bb[_0x35aabf(0x28a)][_0x35aabf(0x1a8)]+_0x35aabf(0x1ef);break;default:_0x58908f=_0xbae7bb[_0x35aabf(0x28a)][_0x35aabf(0x1a8)];break;}_0x111b63+=_0x35aabf(0x2c0)+_0x58908f+'</b></td>';}}}_0x111b63+=_0x35aabf(0x1ad),_0x111b63+=_0x35aabf(0x152),_0x111b63+=_0x35aabf(0x27a),_0x111b63+=_0x35aabf(0x19b),_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x279);for(let _0x24aed4=0x0;_0x24aed4<=_0x422bf1[_0x35aabf(0x202)][_0x35aabf(0x2b9)]-0x1;_0x24aed4++){const _0x4db84b=_0x422bf1[_0x24aed4];_0x111b63+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x111b63+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x111b63+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x111b63+=_0x35aabf(0x1ec),_0x111b63+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>',_0x111b63+=_0x35aabf(0x186),_0x111b63+=_0x35aabf(0x19b),_0x111b63+=_0x35aabf(0x1a3),_0x111b63+=_0x35aabf(0x23f),_0xac111['forEach'](_0x5e2866=>{_0x111b63+=_0x5e2866;});let _0x11e63a={},_0x1e94f6={},_0x29b5c0={};for(let _0x3b6329=0x0;_0x3b6329<=_0x16f395[_0x35aabf(0x2b9)]-0x1;_0x3b6329++){const _0x39b0ba=_0x16f395[_0x3b6329];var _0x5bc14f=0x0;for(let _0x3a5e72=0x0;_0x3a5e72<=_0x39b0ba[_0x35aabf(0x283)][_0x35aabf(0x2b9)]-0x1;_0x3a5e72++){const _0x49fa3e=_0x39b0ba[_0x35aabf(0x283)][_0x3a5e72],_0x1da894=_0x49fa3e[_0x35aabf(0x1a8)]+'-'+_0x49fa3e[_0x35aabf(0x194)];if(_0x49fa3e[_0x35aabf(0x299)]['prod_cat']=='P')_0x49fa3e[_0x35aabf(0x299)][_0x35aabf(0x21e)]==_0x35aabf(0x252)?(!_0x29b5c0[_0x1da894]&&(_0x29b5c0[_0x1da894]=0x0),_0x29b5c0[_0x1da894]+=_0x49fa3e[_0x35aabf(0x291)]):(!_0x11e63a[_0x1da894]&&(_0x11e63a[_0x1da894]=0x0),_0x11e63a[_0x1da894]+=_0x49fa3e[_0x35aabf(0x291)]);else _0x49fa3e[_0x35aabf(0x299)][_0x35aabf(0x29e)]=='S'&&(_0x49fa3e[_0x35aabf(0x299)][_0x35aabf(0x21e)]==_0x35aabf(0x252)?(!_0x29b5c0[_0x1da894]&&(_0x29b5c0[_0x1da894]=0x0),_0x29b5c0[_0x1da894]+=_0x49fa3e['qty'],console['log'](_0x49fa3e[_0x35aabf(0x291)])):(!_0x1e94f6[_0x1da894]&&(_0x1e94f6[_0x1da894]=0x0),_0x1e94f6[_0x1da894]+=_0x49fa3e[_0x35aabf(0x291)]));_0x5bc14f++;}}let _0x2fd8d3={},_0x2bca36={},_0x3cb7ff={};var _0x5b56a8=0x0,_0x579cfb=0x0;for(let _0x3c1ab1=0x0;_0x3c1ab1<=_0x58cc79['length']-0x1;_0x3c1ab1++){const _0x14053f=_0x58cc79[_0x3c1ab1];var _0x5bc14f=0x0;for(let _0x49d3d4=0x0;_0x49d3d4<=_0x14053f[_0x35aabf(0x283)][_0x35aabf(0x2b9)]-0x1;_0x49d3d4++){const _0x2c5eed=_0x14053f[_0x35aabf(0x283)][_0x49d3d4],_0x54c14e=_0x2c5eed[_0x35aabf(0x1a8)]+'-'+_0x2c5eed[_0x35aabf(0x194)];if(_0x2c5eed[_0x35aabf(0x299)][_0x35aabf(0x29e)]=='P')_0x2c5eed[_0x35aabf(0x299)][_0x35aabf(0x21e)]==_0x35aabf(0x252)?(!_0x3cb7ff[_0x54c14e]&&(_0x3cb7ff[_0x54c14e]=0x0),_0x3cb7ff[_0x54c14e]+=_0x2c5eed[_0x35aabf(0x291)]):(!_0x2fd8d3[_0x54c14e]&&(_0x2fd8d3[_0x54c14e]=0x0),_0x2fd8d3[_0x54c14e]+=_0x2c5eed[_0x35aabf(0x291)]);else _0x2c5eed[_0x35aabf(0x299)][_0x35aabf(0x29e)]=='S'&&(_0x2c5eed[_0x35aabf(0x299)][_0x35aabf(0x21e)]=='true'?(!_0x3cb7ff[_0x54c14e]&&(_0x3cb7ff[_0x54c14e]=0x0),_0x3cb7ff[_0x54c14e]+=_0x2c5eed[_0x35aabf(0x291)]):(!_0x2bca36[_0x54c14e]&&(_0x2bca36[_0x54c14e]=0x0),_0x2bca36[_0x54c14e]+=_0x2c5eed['qty']));_0x5bc14f++;}var _0x2a91b1=parseFloat(_0x14053f[_0x35aabf(0x29b)]),_0x124502=parseFloat(_0x14053f[_0x35aabf(0x207)]);isNaN(_0x124502)&&(_0x124502=0x0),_0x5b56a8+=_0x2a91b1,_0x579cfb+=_0x124502;}if(_0x3d943f[_0x35aabf(0x2b9)]>0x0)for(let _0x3b0e82=0x0;_0x3b0e82<=_0x3d943f[_0x35aabf(0x2b9)]-0x1;_0x3b0e82++){const _0x4eccc6=_0x3d943f[_0x3b0e82];console[_0x35aabf(0x22b)](_0x4eccc6),_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x272)+(0x8+0x7*0x3)+_0x35aabf(0x14d)+_0x4eccc6[_0x35aabf(0x158)]+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x19b);}_0x111b63+=_0x35aabf(0x22f),_0x111b63+=_0x35aabf(0x25b),_0x111b63+=_0x35aabf(0x1a5),_0x111b63+=_0x35aabf(0x1ed);for(let _0x4d2032=0x0;_0x4d2032<=_0x422bf1['cat_brand'][_0x35aabf(0x2b9)]-0x1;_0x4d2032++){const _0x43f20a=_0x422bf1[_0x35aabf(0x202)][_0x4d2032],_0xd0e223=_0x43f20a['_id'][_0x35aabf(0x1a8)]+'-'+_0x43f20a[_0x35aabf(0x28a)][_0x35aabf(0x194)];var _0x4cbdaa=_0x11e63a[_0xd0e223]!==undefined?formatNumber(_0x11e63a[_0xd0e223][_0x35aabf(0x28b)](0x2)):'',_0x30b44a=_0x29b5c0[_0xd0e223]!==undefined?formatNumber(_0x29b5c0[_0xd0e223][_0x35aabf(0x28b)](0x2)):'',_0x214f18=_0x1e94f6[_0xd0e223]!==undefined?formatNumber(_0x1e94f6[_0xd0e223][_0x35aabf(0x28b)](0x2)):'';_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x4cbdaa+_0x35aabf(0x180),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x214f18+'</b></td>',_0x111b63+=_0x35aabf(0x21b)+_0x30b44a+_0x35aabf(0x180);}_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2abb4a)+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x21b)+formatNumber(_0x51c5ef)+'</b></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x19b),_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x25b),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>',_0x111b63+=_0x35aabf(0x1ed);for(let _0x1973fd=0x0;_0x1973fd<=_0x422bf1['cat_brand'][_0x35aabf(0x2b9)]-0x1;_0x1973fd++){const _0x63c2f6=_0x422bf1['cat_brand'][_0x1973fd],_0x59981c=_0x63c2f6[_0x35aabf(0x28a)]['brand']+'-'+_0x63c2f6[_0x35aabf(0x28a)][_0x35aabf(0x194)];var _0x4cbdaa=_0x2fd8d3[_0x59981c]!==undefined?formatNumber(_0x2fd8d3[_0x59981c]['toFixed'](0x2)):'',_0x30b44a=_0x3cb7ff[_0x59981c]!==undefined?formatNumber(_0x3cb7ff[_0x59981c][_0x35aabf(0x28b)](0x2)):'',_0x214f18=_0x2bca36[_0x59981c]!==undefined?formatNumber(_0x2bca36[_0x59981c]['toFixed'](0x2)):'';_0x111b63+=_0x35aabf(0x21b)+_0x4cbdaa+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x21b)+_0x214f18+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x21b)+_0x30b44a+_0x35aabf(0x180);}_0x111b63+=_0x35aabf(0x21b)+formatNumber(_0x5b56a8)+_0x35aabf(0x180),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x579cfb)+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x19b),_0x111b63+=_0x35aabf(0x22f),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x111b63+=_0x35aabf(0x1b3),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';let _0x4ed957=0x0,_0x2f0732=0x0,_0x2f63dd=0x0;for(let _0x31e02c=0x0;_0x31e02c<=_0x422bf1[_0x35aabf(0x202)][_0x35aabf(0x2b9)]-0x1;_0x31e02c++){const _0xeacb2a=_0x422bf1['cat_brand'][_0x31e02c],_0x1d7b9f=_0xeacb2a[_0x35aabf(0x28a)]['brand']+'-'+_0xeacb2a['_id']['category'];var _0x51f121=_0x11e63a[_0x1d7b9f]!==undefined?_0x11e63a[_0x1d7b9f]['toFixed'](0x2):'0',_0x4d0d50=_0x29b5c0[_0x1d7b9f]!==undefined?_0x29b5c0[_0x1d7b9f][_0x35aabf(0x28b)](0x2):'0',_0x192deb=_0x1e94f6[_0x1d7b9f]!==undefined?_0x1e94f6[_0x1d7b9f][_0x35aabf(0x28b)](0x2):'0',_0x283e87=_0x2fd8d3[_0x1d7b9f]!==undefined?_0x2fd8d3[_0x1d7b9f][_0x35aabf(0x28b)](0x2):'0',_0x54d1db=_0x3cb7ff[_0x1d7b9f]!==undefined?_0x3cb7ff[_0x1d7b9f][_0x35aabf(0x28b)](0x2):'0',_0x1fdc88=_0x2bca36[_0x1d7b9f]!==undefined?_0x2bca36[_0x1d7b9f][_0x35aabf(0x28b)](0x2):'0';_0x4ed957=parseFloat(_0x51f121)+parseFloat(_0x283e87),_0x2f0732=parseFloat(_0x192deb)+parseFloat(_0x1fdc88),_0x2f63dd=parseFloat(_0x4d0d50)+parseFloat(_0x54d1db),_0x111b63+=_0x35aabf(0x21b)+formatNumber(_0x4ed957[_0x35aabf(0x28b)](0x2))+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x21b)+formatNumber(_0x2f0732[_0x35aabf(0x28b)](0x2))+_0x35aabf(0x180),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2f63dd[_0x35aabf(0x28b)](0x2))+'</b></td>';}var _0x696b88=formatNumber(_0x2abb4a+_0x5b56a8),_0x1caf1c=formatNumber(_0x51c5ef+_0x579cfb);_0x111b63+=_0x35aabf(0x21b)+_0x696b88+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x21b)+_0x1caf1c+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x19b),_0x111b63+=_0x35aabf(0x22f),_0x111b63+=_0x35aabf(0x1d5)+(_0x422bf1[_0x35aabf(0x202)][_0x35aabf(0x2b9)]*0x3+0x9)+_0x35aabf(0x154),_0x111b63+='</tr>',_0x111b63+=_0x35aabf(0x22f),_0x111b63+=_0x35aabf(0x25b),_0x111b63+=_0x35aabf(0x21d),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x46d3ee=0x0;_0x46d3ee<=_0x422bf1[_0x35aabf(0x202)][_0x35aabf(0x2b9)]-0x1;_0x46d3ee++){const _0x48faa9=_0x422bf1[_0x35aabf(0x202)][_0x46d3ee],_0x3c74f0=_0x48faa9[_0x35aabf(0x28a)]['brand']+'-'+_0x48faa9[_0x35aabf(0x28a)][_0x35aabf(0x194)];var _0x51f121=_0x11e63a[_0x3c74f0]!==undefined?_0x11e63a[_0x3c74f0][_0x35aabf(0x28b)](0x2):'0',_0x4d0d50=_0x29b5c0[_0x3c74f0]!==undefined?_0x29b5c0[_0x3c74f0][_0x35aabf(0x28b)](0x2):'0',_0x192deb=_0x1e94f6[_0x3c74f0]!==undefined?_0x1e94f6[_0x3c74f0][_0x35aabf(0x28b)](0x2):'0',_0x283e87=_0x2fd8d3[_0x3c74f0]!==undefined?_0x2fd8d3[_0x3c74f0][_0x35aabf(0x28b)](0x2):'0',_0x54d1db=_0x3cb7ff[_0x3c74f0]!==undefined?_0x3cb7ff[_0x3c74f0][_0x35aabf(0x28b)](0x2):'0',_0x1fdc88=_0x2bca36[_0x3c74f0]!==undefined?_0x2bca36[_0x3c74f0][_0x35aabf(0x28b)](0x2):'0';_0x4ed957=parseFloat(_0x51f121)+parseFloat(_0x283e87),_0x2f0732=parseFloat(_0x192deb)+parseFloat(_0x1fdc88),_0x2f63dd=parseFloat(_0x4d0d50)+parseFloat(_0x54d1db),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x111b63+=_0x35aabf(0x27e),_0x111b63+=_0x35aabf(0x27e);}_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x19b),_0x111b63+=_0x35aabf(0x22f),_0x111b63+=_0x35aabf(0x25b),_0x111b63+=_0x35aabf(0x28e),_0x111b63+=_0x35aabf(0x1ed);for(let _0x1da692=0x0;_0x1da692<=_0x422bf1[_0x35aabf(0x202)]['length']-0x1;_0x1da692++){const _0x13eacf=_0x422bf1['cat_brand'][_0x1da692],_0x3ca40f=_0x13eacf[_0x35aabf(0x28a)][_0x35aabf(0x1a8)]+'-'+_0x13eacf['_id'][_0x35aabf(0x194)];var _0x51f121=_0x11e63a[_0x3ca40f]!==undefined?_0x11e63a[_0x3ca40f][_0x35aabf(0x28b)](0x2):'0',_0x4d0d50=_0x29b5c0[_0x3ca40f]!==undefined?_0x29b5c0[_0x3ca40f][_0x35aabf(0x28b)](0x2):'0',_0x192deb=_0x1e94f6[_0x3ca40f]!==undefined?_0x1e94f6[_0x3ca40f][_0x35aabf(0x28b)](0x2):'0',_0x283e87=_0x2fd8d3[_0x3ca40f]!==undefined?_0x2fd8d3[_0x3ca40f]['toFixed'](0x2):'0',_0x54d1db=_0x3cb7ff[_0x3ca40f]!==undefined?_0x3cb7ff[_0x3ca40f]['toFixed'](0x2):'0',_0x1fdc88=_0x2bca36[_0x3ca40f]!==undefined?_0x2bca36[_0x3ca40f]['toFixed'](0x2):'0';_0x4ed957=parseFloat(_0x51f121)+parseFloat(_0x283e87),_0x2f0732=parseFloat(_0x192deb)+parseFloat(_0x1fdc88),_0x2f63dd=parseFloat(_0x4d0d50)+parseFloat(_0x54d1db),_0x111b63+=_0x35aabf(0x27e),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x111b63+=_0x35aabf(0x27e);}_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x19b),_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x25b),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x111b63+=_0x35aabf(0x1ed);for(let _0x12fe9f=0x0;_0x12fe9f<=_0x422bf1['cat_brand']['length']-0x1;_0x12fe9f++){const _0x416da3=_0x422bf1[_0x35aabf(0x202)][_0x12fe9f],_0x17ea46=_0x416da3['_id'][_0x35aabf(0x1a8)]+'-'+_0x416da3[_0x35aabf(0x28a)][_0x35aabf(0x194)];var _0x51f121=_0x11e63a[_0x17ea46]!==undefined?_0x11e63a[_0x17ea46][_0x35aabf(0x28b)](0x2):'0',_0x4d0d50=_0x29b5c0[_0x17ea46]!==undefined?_0x29b5c0[_0x17ea46][_0x35aabf(0x28b)](0x2):'0',_0x192deb=_0x1e94f6[_0x17ea46]!==undefined?_0x1e94f6[_0x17ea46][_0x35aabf(0x28b)](0x2):'0',_0x283e87=_0x2fd8d3[_0x17ea46]!==undefined?_0x2fd8d3[_0x17ea46][_0x35aabf(0x28b)](0x2):'0',_0x54d1db=_0x3cb7ff[_0x17ea46]!==undefined?_0x3cb7ff[_0x17ea46][_0x35aabf(0x28b)](0x2):'0',_0x1fdc88=_0x2bca36[_0x17ea46]!==undefined?_0x2bca36[_0x17ea46][_0x35aabf(0x28b)](0x2):'0';_0x4ed957=parseFloat(_0x51f121)+parseFloat(_0x283e87),_0x2f0732=parseFloat(_0x192deb)+parseFloat(_0x1fdc88),_0x2f63dd=parseFloat(_0x4d0d50)+parseFloat(_0x54d1db),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x111b63+=_0x35aabf(0x27e),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x19b),_0x111b63+=_0x35aabf(0x22f),_0x111b63+=_0x35aabf(0x25b),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x159f78=0x0;_0x159f78<=_0x422bf1[_0x35aabf(0x202)][_0x35aabf(0x2b9)]-0x1;_0x159f78++){const _0x4455c9=_0x422bf1['cat_brand'][_0x159f78],_0x55a789=_0x4455c9['_id'][_0x35aabf(0x1a8)]+'-'+_0x4455c9['_id']['category'];var _0x51f121=_0x11e63a[_0x55a789]!==undefined?_0x11e63a[_0x55a789][_0x35aabf(0x28b)](0x2):'',_0x4d0d50=_0x29b5c0[_0x55a789]!==undefined?_0x29b5c0[_0x55a789][_0x35aabf(0x28b)](0x2):'',_0x192deb=_0x1e94f6[_0x55a789]!==undefined?_0x1e94f6[_0x55a789]['toFixed'](0x2):'',_0x283e87=_0x2fd8d3[_0x55a789]!==undefined?_0x2fd8d3[_0x55a789][_0x35aabf(0x28b)](0x2):'',_0x54d1db=_0x3cb7ff[_0x55a789]!==undefined?_0x3cb7ff[_0x55a789][_0x35aabf(0x28b)](0x2):'',_0x1fdc88=_0x2bca36[_0x55a789]!==undefined?_0x2bca36[_0x55a789][_0x35aabf(0x28b)](0x2):'';_0x4ed957=formatNumber(parseFloat(_0x51f121)+parseFloat(_0x283e87)),_0x2f0732=formatNumber(parseFloat(_0x192deb)+parseFloat(_0x1fdc88)),_0x2f63dd=formatNumber(parseFloat(_0x4d0d50)+parseFloat(_0x54d1db)),_0x111b63+=_0x35aabf(0x21b)+_0x51f121+_0x35aabf(0x180),_0x111b63+=_0x35aabf(0x21b)+_0x192deb+'</b></td>',_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x4d0d50+'</b></td>';}_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x19b),_0x111b63+='<tr>',_0x111b63+=_0x35aabf(0x25b),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>',_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x10a582=0x0;_0x10a582<=_0x422bf1[_0x35aabf(0x202)][_0x35aabf(0x2b9)]-0x1;_0x10a582++){const _0x83eeda=_0x422bf1['cat_brand'][_0x10a582],_0x5cf3fa=_0x83eeda[_0x35aabf(0x28a)][_0x35aabf(0x1a8)]+'-'+_0x83eeda[_0x35aabf(0x28a)][_0x35aabf(0x194)];var _0x51f121=_0x11e63a[_0x5cf3fa]!==undefined?_0x11e63a[_0x5cf3fa][_0x35aabf(0x28b)](0x2):'0',_0x4d0d50=_0x29b5c0[_0x5cf3fa]!==undefined?_0x29b5c0[_0x5cf3fa]['toFixed'](0x2):'0',_0x192deb=_0x1e94f6[_0x5cf3fa]!==undefined?_0x1e94f6[_0x5cf3fa]['toFixed'](0x2):'0',_0x283e87=_0x2fd8d3[_0x5cf3fa]!==undefined?_0x2fd8d3[_0x5cf3fa][_0x35aabf(0x28b)](0x2):'0',_0x54d1db=_0x3cb7ff[_0x5cf3fa]!==undefined?_0x3cb7ff[_0x5cf3fa][_0x35aabf(0x28b)](0x2):'0',_0x1fdc88=_0x2bca36[_0x5cf3fa]!==undefined?_0x2bca36[_0x5cf3fa][_0x35aabf(0x28b)](0x2):'0';_0x4ed957=parseFloat(_0x51f121)+parseFloat(_0x283e87),_0x2f0732=parseFloat(_0x192deb)+parseFloat(_0x1fdc88),_0x2f63dd=parseFloat(_0x4d0d50)+parseFloat(_0x54d1db),_0x111b63+=_0x35aabf(0x27e),_0x111b63+=_0x35aabf(0x27e),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x111b63+=_0x35aabf(0x1ed),_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x1ed),_0x111b63+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x111b63+=_0x35aabf(0x19b),_0x111b63+='</tbody>',_0x111b63+=_0x35aabf(0x1b2);}),_0x111b63;}async function generateReferenceNumber(_0x3d0037,_0x1677a6,_0x57d5b5){const _0x377c56=a0_0x47da6c,_0x3ab439=new Date(_0x3d0037)[_0x377c56(0x1cf)](),_0x2bd9d7=('0'+(new Date(_0x3d0037)[_0x377c56(0x1f2)]()+0x1))[_0x377c56(0x1a9)](-0x2),_0x247844=('0'+new Date(_0x3d0037)[_0x377c56(0x19a)]())[_0x377c56(0x1a9)](-0x2),_0x4132a2=await staff[_0x377c56(0x23c)]({'email':_0x57d5b5[_0x377c56(0x235)]}),_0x320d60=_0x4132a2[_0x377c56(0x2a4)],_0x411183=_0x320d60+'-'+_0x3ab439+_0x2bd9d7+_0x247844,_0x34759e=await Reference[_0x377c56(0x23c)]({'referenceNumber':new RegExp('^'+_0x411183),'salesman_code':_0x320d60})[_0x377c56(0x2c5)]({'createdAt':-0x1}),_0x14e02d=_0x411183;_0x34759e&&(_0x14e02d=_0x34759e[_0x377c56(0x2ae)]);console[_0x377c56(0x22b)](_0x14e02d);const _0x39d189=new Reference({'referenceNumber':_0x14e02d,'staff_id':_0x1677a6,'salesman_code':_0x320d60});return await _0x39d189[_0x377c56(0x159)](),_0x14e02d;}router[a0_0x47da6c(0x270)](a0_0x47da6c(0x2ce),auth,async(_0x354eb5,_0x513dbe)=>{const _0x74c788=a0_0x47da6c,{from_date:_0x3982f8,dataview:_0x444700}=_0x354eb5[_0x74c788(0x197)],_0x52fe47=_0x354eb5[_0x74c788(0x213)],_0x2ed24d=await staff['findOne']({'email':_0x52fe47['email']}),_0x15f326=await master_shop[_0x74c788(0x2b6)](),_0x4216bf='';var _0x36b108=new Date(_0x3982f8);const _0xff4ca2={'year':_0x74c788(0x181),'month':_0x74c788(0x16c),'day':_0x74c788(0x181)},_0x8dac9c=new Intl[(_0x74c788(0x21a))](_0x74c788(0x268),_0xff4ca2)['format'](_0x36b108),_0x31272c=await Reference[_0x74c788(0x2b6)]({'staff_id':_0x2ed24d[_0x74c788(0x28a)][_0x74c788(0x2a8)](),'date_include':_0x3982f8});if(_0x31272c[_0x74c788(0x2b9)]>0x0){let _0x5aac7f='';_0x5aac7f+=_0x31272c[0x0]['html'];if(_0x444700==_0x74c788(0x195)){const _0x5cb610=cheerio['load'](_0x5aac7f);let _0x2dde68=[],_0x1209ed=[],_0x197e82=[];const _0x4003d4=_0x474bec=>{const _0x16106a=_0x74c788,_0x4fb73b={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0x16106a(0x261),'color':{'rgb':_0x16106a(0x2c3)}},'left':{'style':_0x16106a(0x261),'color':{'rgb':_0x16106a(0x2c3)}},'right':{'style':_0x16106a(0x261),'color':{'rgb':_0x16106a(0x2c3)}}};if(_0x474bec){const _0xbf203f=_0x474bec[_0x16106a(0x2b4)](';')[_0x16106a(0x2af)]((_0x123ca9,_0x41913b)=>{const _0x408a66=_0x16106a,[_0x4308f7,_0x41bb63]=_0x41913b[_0x408a66(0x2b4)](':')[_0x408a66(0x29d)](_0x33072d=>_0x33072d['trim']());return _0x123ca9[_0x4308f7]=_0x41bb63,_0x123ca9;},{});_0xbf203f['border-top']&&(_0x4fb73b[_0x16106a(0x25e)]['style']=_0xbf203f[_0x16106a(0x1fd)][_0x16106a(0x258)]('thin')?_0x16106a(0x192):_0x16106a(0x271)),_0xbf203f['border-bottom']&&(_0x4fb73b[_0x16106a(0x1f7)][_0x16106a(0x1e7)]=_0xbf203f[_0x16106a(0x217)][_0x16106a(0x258)](_0x16106a(0x192))?_0x16106a(0x192):'medium'),_0xbf203f[_0x16106a(0x26b)]&&(_0x4fb73b[_0x16106a(0x185)][_0x16106a(0x1e7)]=_0xbf203f[_0x16106a(0x26b)][_0x16106a(0x258)](_0x16106a(0x192))?_0x16106a(0x192):'medium'),_0xbf203f[_0x16106a(0x170)]&&(_0x4fb73b[_0x16106a(0x2a7)][_0x16106a(0x1e7)]=_0xbf203f[_0x16106a(0x170)][_0x16106a(0x258)](_0x16106a(0x192))?_0x16106a(0x192):_0x16106a(0x271));}return _0x4fb73b;};_0x5cb610('table\x20tr')[_0x74c788(0x2d2)]((_0x3e111c,_0x116ee7)=>{const _0x494ea8=_0x74c788;let _0x8a95f5=[],_0x56ceac=0x0;while(_0x197e82[_0x56ceac]){_0x197e82[_0x56ceac]--,_0x56ceac++;}_0x5cb610(_0x116ee7)[_0x494ea8(0x2b6)]('td,\x20th')['each']((_0x4854c2,_0x15fe9a)=>{const _0x18f03b=_0x494ea8;let _0x263abc=_0x5cb610(_0x15fe9a)['text']()[_0x18f03b(0x1fa)](),_0x1b4495=parseFloat(_0x263abc['replace'](/,/g,''));isNaN(_0x1b4495)&&(_0x1b4495=_0x263abc);let _0x307af7=parseInt(_0x5cb610(_0x15fe9a)['attr']('colspan'))||0x1,_0x4b4a0e=parseInt(_0x5cb610(_0x15fe9a)[_0x18f03b(0x2cb)](_0x18f03b(0x209)))||0x1;const _0x386658=_0x5cb610(_0x15fe9a)[_0x18f03b(0x2cb)](_0x18f03b(0x1e7)),_0xc04d70=_0x4003d4(_0x386658);_0x8a95f5[_0x56ceac]={'v':_0x1b4495,'s':{'border':_0xc04d70}};(_0x307af7>0x1||_0x4b4a0e>0x1)&&_0x1209ed[_0x18f03b(0x285)]({'s':{'r':_0x3e111c,'c':_0x56ceac},'e':{'r':_0x3e111c+_0x4b4a0e-0x1,'c':_0x56ceac+_0x307af7-0x1}});for(let _0x133c0a=0x0;_0x133c0a<_0x307af7;_0x133c0a++){_0x4b4a0e>0x1&&(_0x197e82[_0x56ceac+_0x133c0a]=_0x4b4a0e-0x1);}_0x56ceac+=_0x307af7;}),_0x2dde68[_0x494ea8(0x285)](_0x8a95f5);});const _0x1f86c3=XLSX[_0x74c788(0x236)][_0x74c788(0x2cd)](),_0x77b481=XLSX[_0x74c788(0x236)][_0x74c788(0x1e8)](_0x2dde68);_0x1209ed[_0x74c788(0x2b9)]>0x0&&(_0x77b481[_0x74c788(0x24a)]=_0x1209ed);_0x77b481[_0x74c788(0x269)]=_0x2dde68[0x0][_0x74c788(0x29d)](()=>({'wpx':0x64})),XLSX[_0x74c788(0x236)][_0x74c788(0x179)](_0x1f86c3,_0x77b481,_0x74c788(0x251));const _0x4bc520=XLSX[_0x74c788(0x2c2)](_0x1f86c3,{'bookType':_0x74c788(0x26f),'type':'buffer'});_0x513dbe[_0x74c788(0x26d)](_0x74c788(0x273),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x513dbe[_0x74c788(0x26d)]('Content-Type',_0x74c788(0x19d)),_0x513dbe[_0x74c788(0x1dd)](_0x4bc520);}else{let _0x4b2219='';_0x4b2219+=_0x5aac7f,_0x4b2219+=_0x74c788(0x2c7),_0x4b2219+='window.onload\x20=\x20function()\x20{',_0x4b2219+='window.print();',_0x4b2219+='};',_0x4b2219+=_0x74c788(0x155),_0x513dbe[_0x74c788(0x1dd)](_0x4b2219);}}else generateReferenceNumber(_0x3982f8,_0x2ed24d[_0x74c788(0x28a)]['valueOf'](),_0x52fe47)[_0x74c788(0x167)](async _0x1d6673=>{const _0x25624e=_0x74c788,_0x1a0b93=await agentsdataDSICheck_DSRR(_0x3982f8,_0x2ed24d[_0x25624e(0x28a)][_0x25624e(0x2a8)](),_0x4216bf,_0x1d6673);let _0x1eae56=_0x25624e(0x24b);_0x1eae56+=_0x25624e(0x15b),_0x1eae56+=_0x25624e(0x2be),_0x1eae56+='<table>',_0x1eae56+=_0x1a0b93,_0x1eae56+=_0x25624e(0x1b2),_0x1eae56+='</div>',_0x1eae56+='</div>';if(_0x1a0b93[_0x25624e(0x2b9)]>0x0){const _0x3202ea=await Reference[_0x25624e(0x23c)]({'staff_id':_0x2ed24d[_0x25624e(0x28a)]['valueOf'](),'referenceNumber':_0x1d6673});_0x3202ea['html']=_0x1eae56,_0x3202ea[_0x25624e(0x2d7)]=_0x3982f8,await _0x3202ea[_0x25624e(0x159)]();if(_0x444700==_0x25624e(0x195)){const _0x17e02a=cheerio['load'](_0x1eae56);let _0x238d31=[],_0x44a1be=[],_0x25bf38=[];const _0xfdbd28=_0x258081=>{const _0x159f85=_0x25624e,_0x2d74a5={'top':{'style':_0x159f85(0x261),'color':{'rgb':_0x159f85(0x2c3)}},'bottom':{'style':'thick','color':{'rgb':_0x159f85(0x2c3)}},'left':{'style':_0x159f85(0x261),'color':{'rgb':_0x159f85(0x2c3)}},'right':{'style':_0x159f85(0x261),'color':{'rgb':'000000'}}};if(_0x258081){const _0x155d81=_0x258081[_0x159f85(0x2b4)](';')[_0x159f85(0x2af)]((_0x530401,_0x4bf8ec)=>{const _0x3f207f=_0x159f85,[_0x1c897f,_0x296316]=_0x4bf8ec[_0x3f207f(0x2b4)](':')[_0x3f207f(0x29d)](_0x56b57a=>_0x56b57a['trim']());return _0x530401[_0x1c897f]=_0x296316,_0x530401;},{});_0x155d81[_0x159f85(0x1fd)]&&(_0x2d74a5[_0x159f85(0x25e)][_0x159f85(0x1e7)]=_0x155d81['border-top'][_0x159f85(0x258)](_0x159f85(0x192))?'thin':_0x159f85(0x271)),_0x155d81['border-bottom']&&(_0x2d74a5[_0x159f85(0x1f7)][_0x159f85(0x1e7)]=_0x155d81['border-bottom'][_0x159f85(0x258)]('thin')?'thin':_0x159f85(0x271)),_0x155d81[_0x159f85(0x26b)]&&(_0x2d74a5['left'][_0x159f85(0x1e7)]=_0x155d81[_0x159f85(0x26b)][_0x159f85(0x258)](_0x159f85(0x192))?_0x159f85(0x192):_0x159f85(0x271)),_0x155d81['border-right']&&(_0x2d74a5[_0x159f85(0x2a7)][_0x159f85(0x1e7)]=_0x155d81['border-right']['includes'](_0x159f85(0x192))?'thin':_0x159f85(0x271));}return _0x2d74a5;};_0x17e02a('table\x20tr')[_0x25624e(0x2d2)]((_0x473f9c,_0x34a9fb)=>{const _0x2d93a5=_0x25624e;let _0x542462=[],_0x2c39ef=0x0;while(_0x25bf38[_0x2c39ef]){_0x25bf38[_0x2c39ef]--,_0x2c39ef++;}_0x17e02a(_0x34a9fb)[_0x2d93a5(0x2b6)](_0x2d93a5(0x19f))[_0x2d93a5(0x2d2)]((_0x26c7ed,_0x3a55a3)=>{const _0x4ad745=_0x2d93a5;let _0x1060ff=_0x17e02a(_0x3a55a3)[_0x4ad745(0x1e9)]()[_0x4ad745(0x1fa)](),_0x14e9ba=parseFloat(_0x1060ff[_0x4ad745(0x20e)](/,/g,''));isNaN(_0x14e9ba)&&(_0x14e9ba=_0x1060ff);let _0x589a47=parseInt(_0x17e02a(_0x3a55a3)[_0x4ad745(0x2cb)](_0x4ad745(0x2b1)))||0x1,_0x1e8f1d=parseInt(_0x17e02a(_0x3a55a3)['attr'](_0x4ad745(0x209)))||0x1;const _0x4cff2e=_0x17e02a(_0x3a55a3)[_0x4ad745(0x2cb)](_0x4ad745(0x1e7)),_0x4b0dd9=_0xfdbd28(_0x4cff2e);_0x542462[_0x2c39ef]={'v':_0x14e9ba,'s':{'border':_0x4b0dd9}};(_0x589a47>0x1||_0x1e8f1d>0x1)&&_0x44a1be[_0x4ad745(0x285)]({'s':{'r':_0x473f9c,'c':_0x2c39ef},'e':{'r':_0x473f9c+_0x1e8f1d-0x1,'c':_0x2c39ef+_0x589a47-0x1}});for(let _0x1a1491=0x0;_0x1a1491<_0x589a47;_0x1a1491++){_0x1e8f1d>0x1&&(_0x25bf38[_0x2c39ef+_0x1a1491]=_0x1e8f1d-0x1);}_0x2c39ef+=_0x589a47;}),_0x238d31[_0x2d93a5(0x285)](_0x542462);});const _0x276f38=XLSX[_0x25624e(0x236)][_0x25624e(0x2cd)](),_0x252615=XLSX[_0x25624e(0x236)][_0x25624e(0x1e8)](_0x238d31);_0x44a1be['length']>0x0&&(_0x252615[_0x25624e(0x24a)]=_0x44a1be);_0x252615['!cols']=_0x238d31[0x0][_0x25624e(0x29d)](()=>({'wpx':0x64})),XLSX[_0x25624e(0x236)][_0x25624e(0x179)](_0x276f38,_0x252615,_0x25624e(0x251));const _0x4dd232=XLSX[_0x25624e(0x2c2)](_0x276f38,{'bookType':_0x25624e(0x26f),'type':'buffer'});_0x513dbe[_0x25624e(0x26d)](_0x25624e(0x273),_0x25624e(0x1ee)),_0x513dbe['setHeader'](_0x25624e(0x2c8),_0x25624e(0x19d)),_0x513dbe['send'](_0x4dd232);}else _0x1eae56+='<script>',_0x1eae56+=_0x25624e(0x2ca),_0x1eae56+=_0x25624e(0x274),_0x1eae56+='};',_0x1eae56+=_0x25624e(0x155),_0x513dbe[_0x25624e(0x1dd)](_0x1eae56);}else await Reference[_0x25624e(0x1d1)]({'referenceNumber':_0x1d6673}),_0x354eb5['flash']('errors',_0x25624e(0x1ca)),_0x513dbe['redirect'](_0x25624e(0x1d8));})[_0x74c788(0x29f)](console[_0x74c788(0x1da)]);}),router['get']('/dsrr_admin/view',auth,async(_0x45720d,_0xc1e216)=>{const _0x5123d2=a0_0x47da6c;try{const {username:_0x337a91,email:_0x47ba6b,role:_0x39a217}=_0x45720d[_0x5123d2(0x213)],_0xe6592=_0x45720d[_0x5123d2(0x213)],_0x1b8a4a=await profile['findOne']({'email':_0xe6592['email']}),_0x1d79b4={'year':_0x5123d2(0x181),'month':_0x5123d2(0x16c),'day':_0x5123d2(0x181)},_0x47e5c6=await master_shop[_0x5123d2(0x2b6)]();console[_0x5123d2(0x22b)](_0x5123d2(0x25d),_0x47e5c6);const _0x20fe40=await product[_0x5123d2(0x2b6)]();console[_0x5123d2(0x22b)]('Products\x20find_data',_0x20fe40);const _0x5da3e8=await warehouse['aggregate']([{'$unwind':_0x5123d2(0x263)},{'$lookup':{'from':'products','localField':_0x5123d2(0x24f),'foreignField':_0x5123d2(0x29c),'as':_0x5123d2(0x24d)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x5123d2(0x278),'product_stock':_0x5123d2(0x18a)}},{'$group':{'_id':_0x5123d2(0x280),'product_stock':{'$sum':_0x5123d2(0x177)}}}]);console[_0x5123d2(0x22b)]('Products\x20warehouse_data',_0x5da3e8),_0x5da3e8[_0x5123d2(0x1f3)](_0x2ab00f=>{const _0x448f20=_0x5123d2,_0x14421f=_0x20fe40[_0x448f20(0x29d)](_0x2f28b5=>{const _0x542d47=_0x448f20;_0x2f28b5['name']==_0x2ab00f[_0x542d47(0x28a)]&&(_0x2f28b5[_0x542d47(0x29a)]=parseInt(_0x2f28b5[_0x542d47(0x29a)])+parseInt(_0x2ab00f[_0x542d47(0x1b5)]));});});const _0x714b3d=await staff[_0x5123d2(0x2b6)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x4084b6=await staff[_0x5123d2(0x23c)]({'email':_0xe6592['email']});if(_0x47e5c6[0x0][_0x5123d2(0x15f)]==_0x5123d2(0x2ab))var _0x5eeeef=users[_0x5123d2(0x1b7)];else{if(_0x47e5c6[0x0]['language']==_0x5123d2(0x277))var _0x5eeeef=users[_0x5123d2(0x277)];else{if(_0x47e5c6[0x0]['language']==_0x5123d2(0x20b))var _0x5eeeef=users[_0x5123d2(0x20b)];else{if(_0x47e5c6[0x0]['language']==_0x5123d2(0x1ea))var _0x5eeeef=users[_0x5123d2(0x1ea)];else{if(_0x47e5c6[0x0][_0x5123d2(0x15f)]=='French')var _0x5eeeef=users[_0x5123d2(0x281)];else{if(_0x47e5c6[0x0][_0x5123d2(0x15f)]==_0x5123d2(0x227))var _0x5eeeef=users[_0x5123d2(0x25c)];else{if(_0x47e5c6[0x0]['language']==_0x5123d2(0x175))var _0x5eeeef=users['Chinese'];else{if(_0x47e5c6[0x0][_0x5123d2(0x15f)]==_0x5123d2(0x25f))var _0x5eeeef=users['Arabic'];}}}}}}}_0xc1e216[_0x5123d2(0x1bd)]('dssr_view_admin',{'success':_0x45720d['flash'](_0x5123d2(0x15d)),'errors':_0x45720d[_0x5123d2(0x1c3)](_0x5123d2(0x2b3)),'alldata':_0x20fe40,'profile':_0x1b8a4a,'master_shop':_0x47e5c6,'role':_0xe6592,'product_stock':_0x5da3e8,'language':_0x5eeeef,'staff_arr':_0x4084b6,'staff_data_all':_0x714b3d});}catch(_0x5d8015){}}),router[a0_0x47da6c(0x270)]('/getDSSR_no',auth,async(_0x26b8d2,_0x133ec2)=>{const _0x5dcbc1=a0_0x47da6c;try{const {from:_0x3516ba,to:_0x6a68c5,staff_data:_0x4d2036}=_0x26b8d2[_0x5dcbc1(0x197)],_0x10e99b=await Reference[_0x5dcbc1(0x288)]([{'$match':{'date_include':{'$gte':_0x3516ba,'$lte':_0x6a68c5},'staff_id':_0x4d2036}},{'$sort':{'date_include':0x1}}]);_0x133ec2[_0x5dcbc1(0x1d6)](_0x10e99b);}catch(_0xb9a446){_0x133ec2[_0x5dcbc1(0x1d6)](_0xb9a446);}}),router['post']('/getDSSR_no_sales',auth,async(_0xa584b0,_0x140e3d)=>{const _0x29b937=a0_0x47da6c;try{const {from:_0xce2a91,to:_0x29d6ba}=_0xa584b0['body'],{sttaff_id:_0x38d990}=_0xa584b0[_0x29b937(0x213)],_0x5f5a2a=await Reference[_0x29b937(0x288)]([{'$match':{'date_include':{'$gte':_0xce2a91,'$lte':_0x29d6ba},'staff_id':_0x38d990}},{'$sort':{'date_include':0x1}}]);_0x140e3d['json'](_0x5f5a2a);}catch(_0x42ee46){_0x140e3d[_0x29b937(0x1d6)](_0x42ee46);}}),router[a0_0x47da6c(0x149)](a0_0x47da6c(0x196),auth,async(_0x4ebddd,_0x88f45d)=>{const _0x5ae47e=a0_0x47da6c;try{const _0x1842f8=_0x4ebddd['params']['id'],_0x355869=await Reference[_0x5ae47e(0x174)](_0x1842f8);let _0x257e26='';_0x257e26+=_0x355869[_0x5ae47e(0x18e)],_0x257e26+=_0x5ae47e(0x2c7),_0x257e26+='window.onload\x20=\x20function()\x20{',_0x257e26+=_0x5ae47e(0x274),_0x257e26+='};',_0x257e26+='</script>',_0x88f45d['send'](_0x257e26);}catch(_0x5b12f8){_0x88f45d['json'](_0x5b12f8);}}),router[a0_0x47da6c(0x270)]('/dl_excel',auth,async(_0x258833,_0x22e2cd)=>{const _0x5a6c8b=a0_0x47da6c;try{const {ref_data:_0x41aba9}=_0x258833[_0x5a6c8b(0x197)],_0x2dc883=_0x41aba9[_0x5a6c8b(0x2b4)]('~'),_0x1d4fe5=_0x2dc883[_0x5a6c8b(0x297)](_0x3957e7=>_0x3957e7!==''),_0x28c00a=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x1d4fe5}}}]),_0x5ed099=XLSX[_0x5a6c8b(0x236)][_0x5a6c8b(0x2cd)]();_0x28c00a[_0x5a6c8b(0x1f3)](_0xc3059c=>{const _0x142a32=_0x5a6c8b,_0x4df2d7=cheerio[_0x142a32(0x295)](_0xc3059c[_0x142a32(0x18e)]);let _0x3ae315=[],_0x3137b4=[],_0x50443f=[];_0x4df2d7(_0x142a32(0x2a2))[_0x142a32(0x2d2)]((_0xc8f340,_0x5459a6)=>{const _0x2c3f22=_0x142a32;let _0x21953d=[],_0x42c737=0x0;while(_0x50443f[_0x42c737]){_0x50443f[_0x42c737]--,_0x42c737++;}_0x4df2d7(_0x5459a6)['find'](_0x2c3f22(0x19f))[_0x2c3f22(0x2d2)]((_0x203292,_0x3b5d54)=>{const _0x212c30=_0x2c3f22;let _0x408674=_0x4df2d7(_0x3b5d54)['text']()[_0x212c30(0x1fa)](),_0x4d7851=parseFloat(_0x408674[_0x212c30(0x20e)](/,/g,''));isNaN(_0x4d7851)&&(_0x4d7851=_0x408674);let _0x2dca72=parseInt(_0x4df2d7(_0x3b5d54)['attr'](_0x212c30(0x2b1)))||0x1,_0x16abe9=parseInt(_0x4df2d7(_0x3b5d54)['attr'](_0x212c30(0x209)))||0x1;_0x21953d[_0x42c737]=_0x4d7851;(_0x2dca72>0x1||_0x16abe9>0x1)&&_0x3137b4['push']({'s':{'r':_0xc8f340,'c':_0x42c737},'e':{'r':_0xc8f340+_0x16abe9-0x1,'c':_0x42c737+_0x2dca72-0x1}});for(let _0x5c57e5=0x0;_0x5c57e5<_0x2dca72;_0x5c57e5++){_0x16abe9>0x1&&(_0x50443f[_0x42c737+_0x5c57e5]=_0x16abe9-0x1);}_0x42c737+=_0x2dca72;}),_0x3ae315[_0x2c3f22(0x285)](_0x21953d);});const _0x18140e=XLSX[_0x142a32(0x236)][_0x142a32(0x1e8)](_0x3ae315);_0x3137b4[_0x142a32(0x2b9)]>0x0&&(_0x18140e['!merges']=_0x3137b4),_0x18140e[_0x142a32(0x269)]=_0x3ae315[0x0][_0x142a32(0x29d)](()=>({'wpx':0x64})),XLSX[_0x142a32(0x236)]['book_append_sheet'](_0x5ed099,_0x18140e,_0xc3059c[_0x142a32(0x2ae)]);});const _0x31f2f1=XLSX['write'](_0x5ed099,{'bookType':_0x5a6c8b(0x26f),'type':'buffer'});_0x22e2cd[_0x5a6c8b(0x26d)](_0x5a6c8b(0x273),_0x5a6c8b(0x1bc)),_0x22e2cd['setHeader'](_0x5a6c8b(0x2c8),_0x5a6c8b(0x19d)),_0x22e2cd[_0x5a6c8b(0x1dd)](_0x31f2f1);}catch(_0xc0c3af){_0x22e2cd[_0x5a6c8b(0x1d6)](_0xc0c3af);}}),router['post'](a0_0x47da6c(0x16e),auth,async(_0x108981,_0x5ad3b7)=>{const _0x2f9a2d=a0_0x47da6c,{from_date:_0x428219,agent_id:_0x258d09}=_0x108981['body'],_0x3d9fd8=_0x108981[_0x2f9a2d(0x213)],_0x157d7c=await staff[_0x2f9a2d(0x23c)]({'email':_0x3d9fd8[_0x2f9a2d(0x235)]}),_0x131836=await master_shop[_0x2f9a2d(0x2b6)](),_0x1f6a0b=await agentsdataDSICheck_DSRR(_0x428219,_0x258d09,_0x42a31d);let _0x1e0f70=_0x2f9a2d(0x153);var _0x571932=new Date(_0x428219);const _0x472525={'year':_0x2f9a2d(0x181),'month':_0x2f9a2d(0x16c),'day':_0x2f9a2d(0x181)},_0x410fb1=new Intl[(_0x2f9a2d(0x21a))]('en-US',_0x472525)[_0x2f9a2d(0x1e0)](_0x571932);_0x1e0f70+=_0x2f9a2d(0x15b),_0x1e0f70+=_0x2f9a2d(0x2be),_0x1e0f70+=_0x2f9a2d(0x205),_0x1e0f70+=_0x1f6a0b,_0x1e0f70+=_0x2f9a2d(0x1b2),_0x1e0f70+='</div>',_0x1e0f70+=_0x2f9a2d(0x249);let _0x2e3e3f=_0x2f9a2d(0x225);const _0x3cbf9a={'width':_0x2f9a2d(0x287),'height':_0x2f9a2d(0x150),'orientation':_0x2f9a2d(0x2a5),'border':{'top':_0x2f9a2d(0x1ae),'right':_0x2f9a2d(0x1ae),'bottom':_0x2f9a2d(0x1ae),'left':_0x2f9a2d(0x1ae)},'header':{'height':_0x2f9a2d(0x223),'contents':_0x2f9a2d(0x2bb)+_0x2e3e3f+_0x2f9a2d(0x222)+_0x410fb1+_0x2f9a2d(0x2b7)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x2f9a2d(0x224)}}};var _0x42a31d='on';if(_0x42a31d=='on'){const _0x325ed1=cheerio[_0x2f9a2d(0x295)](_0x1e0f70);let _0x1c8e68=[],_0x5d2327=[],_0x4c4147=[];_0x325ed1(_0x2f9a2d(0x2a2))['each']((_0x51c610,_0x4a2008)=>{const _0x48d760=_0x2f9a2d;let _0x13c5e4=[],_0xb2cae8=0x0;while(_0x4c4147[_0xb2cae8]){_0x4c4147[_0xb2cae8]--,_0xb2cae8++;}_0x325ed1(_0x4a2008)['find'](_0x48d760(0x19f))[_0x48d760(0x2d2)]((_0x57b0b9,_0x327406)=>{const _0x119ecd=_0x48d760;let _0x238f11=_0x325ed1(_0x327406)[_0x119ecd(0x1e9)]()['trim'](),_0x23da21=parseFloat(_0x238f11[_0x119ecd(0x20e)](/,/g,''));isNaN(_0x23da21)&&(_0x23da21=_0x238f11);let _0xcc9ae8=parseInt(_0x325ed1(_0x327406)[_0x119ecd(0x2cb)](_0x119ecd(0x2b1)))||0x1,_0x22fd6c=parseInt(_0x325ed1(_0x327406)[_0x119ecd(0x2cb)]('rowspan'))||0x1;_0x13c5e4[_0xb2cae8]=_0x23da21;(_0xcc9ae8>0x1||_0x22fd6c>0x1)&&_0x5d2327[_0x119ecd(0x285)]({'s':{'r':_0x51c610,'c':_0xb2cae8},'e':{'r':_0x51c610+_0x22fd6c-0x1,'c':_0xb2cae8+_0xcc9ae8-0x1}});for(let _0xf7c8a9=0x0;_0xf7c8a9<_0xcc9ae8;_0xf7c8a9++){_0x22fd6c>0x1&&(_0x4c4147[_0xb2cae8+_0xf7c8a9]=_0x22fd6c-0x1);}_0xb2cae8+=_0xcc9ae8;}),_0x1c8e68[_0x48d760(0x285)](_0x13c5e4);});const _0x1fee4c=XLSX['utils'][_0x2f9a2d(0x2cd)](),_0x1f4221=XLSX['utils']['aoa_to_sheet'](_0x1c8e68);_0x5d2327['length']>0x0&&(_0x1f4221[_0x2f9a2d(0x24a)]=_0x5d2327);_0x1f4221[_0x2f9a2d(0x269)]=_0x1c8e68[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x2f9a2d(0x236)][_0x2f9a2d(0x179)](_0x1fee4c,_0x1f4221,_0x2f9a2d(0x251));const _0x19c731=XLSX[_0x2f9a2d(0x2c2)](_0x1fee4c,{'bookType':_0x2f9a2d(0x26f),'type':_0x2f9a2d(0x2bc)});_0x5ad3b7[_0x2f9a2d(0x26d)](_0x2f9a2d(0x273),_0x2f9a2d(0x1ee)),_0x5ad3b7[_0x2f9a2d(0x26d)](_0x2f9a2d(0x2c8),_0x2f9a2d(0x19d)),_0x5ad3b7['send'](_0x19c731);}else pdf[_0x2f9a2d(0x27c)](_0x1e0f70,_0x3cbf9a)['toStream'](function(_0x5645de,_0x414cec){const _0x3ef489=_0x2f9a2d;if(_0x5645de){_0x5ad3b7[_0x3ef489(0x210)](0x1f4)[_0x3ef489(0x1dd)](_0x3ef489(0x1ac));return;}_0x5ad3b7['setHeader']('Content-Type',_0x3ef489(0x2c4)),_0x414cec[_0x3ef489(0x2ac)](_0x5ad3b7);});}),module['exports']=router;