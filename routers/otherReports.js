const a0_0x5c3944=a0_0x55a3;function a0_0x55a3(_0x4a57a7,_0x15c49d){const _0x237f60=a0_0x237f();return a0_0x55a3=function(_0x55a31e,_0x4c9198){_0x55a31e=_0x55a31e-0x192;let _0x108c66=_0x237f60[_0x55a31e];return _0x108c66;},a0_0x55a3(_0x4a57a7,_0x15c49d);}(function(_0x2d2a1d,_0x5c658d){const _0x9c3b77=a0_0x55a3,_0x226b8e=_0x2d2a1d();while(!![]){try{const _0x42b554=-parseInt(_0x9c3b77(0x212))/0x1*(-parseInt(_0x9c3b77(0x1e4))/0x2)+parseInt(_0x9c3b77(0x309))/0x3*(parseInt(_0x9c3b77(0x2e0))/0x4)+-parseInt(_0x9c3b77(0x204))/0x5+parseInt(_0x9c3b77(0x242))/0x6+parseInt(_0x9c3b77(0x2b5))/0x7+parseInt(_0x9c3b77(0x2f8))/0x8+parseInt(_0x9c3b77(0x1ee))/0x9*(-parseInt(_0x9c3b77(0x313))/0xa);if(_0x42b554===_0x5c658d)break;else _0x226b8e['push'](_0x226b8e['shift']());}catch(_0x103291){_0x226b8e['push'](_0x226b8e['shift']());}}}(a0_0x237f,0xf337e));const express=require(a0_0x5c3944(0x1f8)),res=require(a0_0x5c3944(0x307)),app=express(),router=express[a0_0x5c3944(0x223)](),multer=require(a0_0x5c3944(0x21f)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x5c3944(0x240)),auth=require(a0_0x5c3944(0x1dd)),users=require(a0_0x5c3944(0x214)),excelJS=require(a0_0x5c3944(0x262)),XLSX=require('xlsx'),PDFDocument=require(a0_0x5c3944(0x210)),fs=require('fs'),blobStream=require(a0_0x5c3944(0x1d8)),JsBarcode=require(a0_0x5c3944(0x1f4)),{Canvas}=require(a0_0x5c3944(0x1ce)),pdf=require(a0_0x5c3944(0x233)),path=require(a0_0x5c3944(0x28a)),mongoose=require(a0_0x5c3944(0x227)),cheerio=require('cheerio');router[a0_0x5c3944(0x295)](a0_0x5c3944(0x1e3),auth,async(_0x361543,_0x40bdc2)=>{const _0x2e2792=a0_0x5c3944;try{const {username:_0x4bd930,email:_0x4e4a2d,role:_0x448b73}=_0x361543['user'],_0x19849c=_0x361543[_0x2e2792(0x2a8)],_0x1f86a4=await profile[_0x2e2792(0x1c2)]({'email':_0x19849c[_0x2e2792(0x216)]}),_0x5f39f={'year':_0x2e2792(0x29e),'month':_0x2e2792(0x21e),'day':_0x2e2792(0x29e)},_0x4f9a7c=await master_shop['find']();console['log']('Products\x20master',_0x4f9a7c);const _0x4849b1=await product[_0x2e2792(0x279)]();console['log'](_0x2e2792(0x2db),_0x4849b1);const _0x1905c1=await warehouse[_0x2e2792(0x20b)]([{'$unwind':_0x2e2792(0x292)},{'$lookup':{'from':_0x2e2792(0x1b5),'localField':_0x2e2792(0x296),'foreignField':'name','as':_0x2e2792(0x209)}},{'$unwind':_0x2e2792(0x234)},{'$project':{'product_name':_0x2e2792(0x2dc),'product_stock':_0x2e2792(0x230)}},{'$group':{'_id':_0x2e2792(0x1f7),'product_stock':{'$sum':_0x2e2792(0x31e)}}}]);console[_0x2e2792(0x25d)](_0x2e2792(0x213),_0x1905c1),_0x1905c1['forEach'](_0x2f6cc1=>{const _0x1d85f1=_0x2e2792,_0x2e2eb0=_0x4849b1[_0x1d85f1(0x22e)](_0x414d88=>{const _0x1b22c6=_0x1d85f1;_0x414d88[_0x1b22c6(0x273)]==_0x2f6cc1[_0x1b22c6(0x200)]&&(_0x414d88[_0x1b22c6(0x2dd)]=parseInt(_0x414d88[_0x1b22c6(0x2dd)])+parseInt(_0x2f6cc1[_0x1b22c6(0x254)]));});}),console[_0x2e2792(0x25d)](_0x2e2792(0x2db),_0x4849b1);if(_0x4f9a7c[0x0]['language']==_0x2e2792(0x321))var _0x2d9913=users[_0x2e2792(0x2b0)];else{if(_0x4f9a7c[0x0][_0x2e2792(0x1d7)]==_0x2e2792(0x2d4))var _0x2d9913=users['Hindi'];else{if(_0x4f9a7c[0x0][_0x2e2792(0x1d7)]==_0x2e2792(0x30e))var _0x2d9913=users['German'];else{if(_0x4f9a7c[0x0]['language']==_0x2e2792(0x2b9))var _0x2d9913=users['Spanish'];else{if(_0x4f9a7c[0x0][_0x2e2792(0x1d7)]==_0x2e2792(0x2c2))var _0x2d9913=users[_0x2e2792(0x2c2)];else{if(_0x4f9a7c[0x0]['language']==_0x2e2792(0x1b9))var _0x2d9913=users[_0x2e2792(0x1cd)];else{if(_0x4f9a7c[0x0][_0x2e2792(0x1d7)]==_0x2e2792(0x1c8))var _0x2d9913=users[_0x2e2792(0x1c8)];else{if(_0x4f9a7c[0x0][_0x2e2792(0x1d7)]==_0x2e2792(0x1ca))var _0x2d9913=users['Arabic'];}}}}}}}_0x40bdc2[_0x2e2792(0x1bf)](_0x2e2792(0x1bd),{'success':_0x361543[_0x2e2792(0x300)](_0x2e2792(0x1fa)),'errors':_0x361543[_0x2e2792(0x300)](_0x2e2792(0x217)),'alldata':_0x4849b1,'profile':_0x1f86a4,'master_shop':_0x4f9a7c,'role':_0x19849c,'product_stock':_0x1905c1,'language':_0x2d9913});}catch(_0x4cf755){}});async function dataCheck(_0x3594b3,_0x438c80){const _0xc18db4=a0_0x5c3944,_0x1f91ca=await product[_0xc18db4(0x20b)]([{'$group':{'_id':{'brand':_0xc18db4(0x243),'category':_0xc18db4(0x2c9)},'products':{'$push':{'name':_0xc18db4(0x306),'product_code':_0xc18db4(0x1d9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x16cadf=[];_0x16cadf['cat_brand']=[];for(let _0x48cd35=0x0;_0x48cd35<=_0x1f91ca[_0xc18db4(0x261)]-0x1;_0x48cd35++){const _0x30d82c=_0x1f91ca[_0x48cd35];_0x16cadf['cat_brand'][_0xc18db4(0x2d0)](_0x30d82c);}const _0x359560=await product[_0xc18db4(0x20b)]([{'$group':{'_id':{'category':_0xc18db4(0x2c9)},'products':{'$push':{'brand':'$brand','product_code':_0xc18db4(0x1d9),'product_name':_0xc18db4(0x306)}}}},{'$sort':{'_id.category':-0x1}}]),_0xf73f96=await purchases_finished[_0xc18db4(0x20b)]([{'$match':{'date':{'$gte':_0x3594b3,'$lte':_0x438c80}}},{'$unwind':_0xc18db4(0x218)},{'$group':{'_id':{'product_name':_0xc18db4(0x303),'product_code':'$product.product_code'},'totalQTY':{'$sum':_0xc18db4(0x25c)}}}]);_0x16cadf[_0xc18db4(0x1ae)]=[];for(let _0x2c64a4=0x0;_0x2c64a4<=_0xf73f96[_0xc18db4(0x261)]-0x1;_0x2c64a4++){const _0x5d3a01=_0xf73f96[_0x2c64a4];_0x16cadf[_0xc18db4(0x1ae)]['push'](_0x5d3a01);}const _0x498e32=await sales_sa[_0xc18db4(0x20b)]([{'$match':{'date':{'$gte':_0x3594b3,'$lte':_0x438c80}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0xc18db4(0x26d)}}},{'$lookup':{'from':_0xc18db4(0x28e),'localField':_0xc18db4(0x252),'foreignField':_0xc18db4(0x200),'as':_0xc18db4(0x30c)}},{'$unwind':_0xc18db4(0x23c)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0xc18db4(0x288),'product_code':_0xc18db4(0x201)},'totalQTY':{'$sum':_0xc18db4(0x31b)}}}]);console[_0xc18db4(0x25d)](_0x498e32[0x0]),_0x16cadf[_0xc18db4(0x258)]=[];for(let _0x1b976e=0x0;_0x1b976e<=_0x498e32['length']-0x1;_0x1b976e++){const _0x2b18b7=_0x498e32[_0x1b976e];_0x16cadf[_0xc18db4(0x258)][_0xc18db4(0x2d0)](_0x2b18b7);}const _0x4b5a64=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3594b3,'$lte':_0x438c80}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0xc18db4(0x26d)}}},{'$lookup':{'from':_0xc18db4(0x28e),'localField':_0xc18db4(0x252),'foreignField':'_id','as':_0xc18db4(0x30c)}},{'$unwind':_0xc18db4(0x23c)},{'$unwind':_0xc18db4(0x308)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0xc18db4(0x2ff)}},{'$group':{'_id':{'product_name':_0xc18db4(0x288),'product_code':_0xc18db4(0x201)},'totalQTY':{'$sum':_0xc18db4(0x293)}}}]);_0x16cadf[_0xc18db4(0x2be)]=[];for(let _0x3f2e06=0x0;_0x3f2e06<=_0x4b5a64[_0xc18db4(0x261)]-0x1;_0x3f2e06++){const _0x369c22=_0x4b5a64[_0x3f2e06];_0x16cadf[_0xc18db4(0x2be)]['push'](_0x369c22);}let _0x8177c8='';for(let _0x47133f=0x0;_0x47133f<=_0x359560['length']-0x1;_0x47133f++){const _0x4f33ed=_0x359560[_0x47133f];_0x8177c8+=_0xc18db4(0x287),_0x8177c8+=_0xc18db4(0x25a)+_0x4f33ed[_0xc18db4(0x200)][_0xc18db4(0x1df)]+_0xc18db4(0x299),_0x8177c8+='</tr>';for(let _0x753c5d=0x0;_0x753c5d<_0x16cadf[_0xc18db4(0x1e0)][_0xc18db4(0x261)];_0x753c5d++){const _0x53e129=_0x16cadf['cat_brand'][_0x753c5d];if(_0x53e129[_0xc18db4(0x200)][_0xc18db4(0x1df)]==_0x4f33ed[_0xc18db4(0x200)][_0xc18db4(0x1df)]){let _0x52fa84=[],_0x210596=[],_0x5539cf=[];_0x52fa84[_0x53e129[_0xc18db4(0x200)]['brand']]=[],_0x210596[_0x53e129[_0xc18db4(0x200)][_0xc18db4(0x1f1)]]=[],_0x5539cf[_0x53e129['_id'][_0xc18db4(0x1f1)]]=[];var _0x323779=0x0,_0x342731=0x0,_0x44494b=0x0;for(let _0x59f3bb=0x0;_0x59f3bb<_0x53e129[_0xc18db4(0x1b5)][_0xc18db4(0x261)];_0x59f3bb++){const _0x26fe23=_0x53e129['products'][_0x59f3bb];for(let _0x107615=0x0;_0x107615<=_0x16cadf[_0xc18db4(0x1ae)][_0xc18db4(0x261)]-0x1;_0x107615++){const _0x195ea2=_0x16cadf[_0xc18db4(0x1ae)][_0x107615];_0x195ea2['_id'][_0xc18db4(0x283)]==_0x26fe23[_0xc18db4(0x273)]&&_0x195ea2[_0xc18db4(0x200)][_0xc18db4(0x225)]==_0x26fe23[_0xc18db4(0x225)]&&(_0x323779+=parseInt(_0x195ea2[_0xc18db4(0x219)],0xa));}for(let _0x52291e=0x0;_0x52291e<=_0x16cadf[_0xc18db4(0x2be)][_0xc18db4(0x261)]-0x1;_0x52291e++){const _0x3ed2f4=_0x16cadf[_0xc18db4(0x2be)][_0x52291e];_0x3ed2f4[_0xc18db4(0x200)][_0xc18db4(0x283)]==_0x26fe23[_0xc18db4(0x273)]&&_0x3ed2f4[_0xc18db4(0x200)][_0xc18db4(0x225)]==_0x26fe23[_0xc18db4(0x225)]&&(_0x342731+=parseFloat(_0x3ed2f4[_0xc18db4(0x219)],0xa)[_0xc18db4(0x1de)](0x2));}for(let _0x61fcd=0x0;_0x61fcd<=_0x16cadf[_0xc18db4(0x258)][_0xc18db4(0x261)]-0x1;_0x61fcd++){const _0x14cc71=_0x16cadf[_0xc18db4(0x258)][_0x61fcd];_0x14cc71[_0xc18db4(0x200)][_0xc18db4(0x283)]==_0x26fe23[_0xc18db4(0x273)]&&_0x14cc71[_0xc18db4(0x200)][_0xc18db4(0x225)]==_0x26fe23[_0xc18db4(0x225)]&&(_0x44494b+=parseInt(_0x14cc71['totalQTY'],0xa));}}const _0x2dfd76=new Intl[(_0xc18db4(0x2f4))](_0xc18db4(0x1b0));var _0x20be17=_0x2dfd76['format'](_0x323779);_0x52fa84[_0x53e129['_id'][_0xc18db4(0x1f1)]]['push'](_0x20be17),_0x210596[_0x53e129[_0xc18db4(0x200)][_0xc18db4(0x1f1)]][_0xc18db4(0x2d0)](_0x2dfd76['format'](_0x342731)),_0x5539cf[_0x53e129[_0xc18db4(0x200)]['brand']][_0xc18db4(0x2d0)](_0x2dfd76[_0xc18db4(0x19b)](_0x44494b));var _0x19ff13=_0x2dfd76['format'](_0x323779-(_0x44494b+_0x342731));_0x8177c8+=_0xc18db4(0x287),_0x8177c8+=_0xc18db4(0x1f0),_0x8177c8+=_0xc18db4(0x2ef)+_0x53e129[_0xc18db4(0x200)][_0xc18db4(0x1f1)]+_0xc18db4(0x299),_0x8177c8+=_0xc18db4(0x2ef)+_0x52fa84[_0x53e129[_0xc18db4(0x200)][_0xc18db4(0x1f1)]][0x0]+'</td>',_0x8177c8+=_0xc18db4(0x1c7),_0x8177c8+=_0xc18db4(0x2ef)+_0x5539cf[_0x53e129['_id']['brand']][0x0]+_0xc18db4(0x299),_0x8177c8+=_0xc18db4(0x2ef)+_0x210596[_0x53e129[_0xc18db4(0x200)]['brand']][0x0]+_0xc18db4(0x299),_0x8177c8+=_0xc18db4(0x2ef)+_0x19ff13+_0xc18db4(0x299),_0x8177c8+=_0xc18db4(0x266);}}}return console[_0xc18db4(0x25d)](_0x16cadf[_0xc18db4(0x258)]),_0x8177c8;}router[a0_0x5c3944(0x1ad)]('/balance/pdf',auth,async(_0x237f05,_0x362f35)=>{const _0x4ac6be=a0_0x5c3944,{from_date:_0x32efe0,to_date:_0x11ef92}=_0x237f05[_0x4ac6be(0x22f)],_0x371fa3=await dataCheck(_0x32efe0,_0x11ef92);{}let _0x56b085=_0x4ac6be(0x2a1);var _0x11f46d=new Date(_0x32efe0),_0x4a4a90=new Date(_0x11ef92);const _0x2760f8={'year':_0x4ac6be(0x29e),'month':'long','day':_0x4ac6be(0x29e)},_0x1ed9b5=new Intl[(_0x4ac6be(0x257))](_0x4ac6be(0x1b0),_0x2760f8)[_0x4ac6be(0x19b)](_0x11f46d),_0x2be690=new Intl[(_0x4ac6be(0x257))](_0x4ac6be(0x1b0),_0x2760f8)['format'](_0x4a4a90);_0x56b085+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x56b085+=_0x4ac6be(0x2e3),_0x56b085+=_0x4ac6be(0x1ff)+_0x1ed9b5+_0x4ac6be(0x2ee)+_0x2be690+_0x4ac6be(0x25f),_0x56b085+=_0x4ac6be(0x2e8),_0x56b085+=_0x4ac6be(0x2f1),_0x56b085+=_0x4ac6be(0x276),_0x56b085+='<tr>',_0x56b085+=_0x4ac6be(0x2bd),_0x56b085+=_0x4ac6be(0x304),_0x56b085+=_0x4ac6be(0x28b)+_0x1ed9b5+_0x4ac6be(0x1a4),_0x56b085+='<th\x20rowspan=\x272\x27>Production</th>',_0x56b085+=_0x4ac6be(0x1a6),_0x56b085+=_0x4ac6be(0x1c3)+_0x2be690+_0x4ac6be(0x1a4),_0x56b085+=_0x4ac6be(0x266),_0x56b085+=_0x4ac6be(0x287),_0x56b085+=_0x4ac6be(0x1cb),_0x56b085+=_0x4ac6be(0x1db),_0x56b085+='</tr>',_0x56b085+=_0x371fa3,_0x56b085+=_0x4ac6be(0x215),_0x56b085+=_0x4ac6be(0x2f2),_0x56b085+=_0x4ac6be(0x2f2);const _0x53f1d3={'format':'Letter','orientation':_0x4ac6be(0x237),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x4ac6be(0x23d)}}};pdf['create'](_0x56b085,_0x53f1d3)[_0x4ac6be(0x253)](function(_0x2ed573,_0x367ffc){const _0x4d8e31=_0x4ac6be;if(_0x2ed573){_0x362f35['status'](0x1f4)['send'](_0x4d8e31(0x21d));return;}_0x362f35['setHeader'](_0x4d8e31(0x226),_0x4d8e31(0x1a5)),_0x367ffc['pipe'](_0x362f35);});}),router[a0_0x5c3944(0x295)](a0_0x5c3944(0x2ec),auth,async(_0x197221,_0x4f8b36)=>{const _0x3c8317=a0_0x5c3944;try{const {username:_0x53fa63,email:_0x560451,role:_0x5bb063}=_0x197221[_0x3c8317(0x2a8)],_0x182e5c=_0x197221[_0x3c8317(0x2a8)],_0x55362c=await profile[_0x3c8317(0x1c2)]({'email':_0x182e5c[_0x3c8317(0x216)]}),_0x1f727a={'year':_0x3c8317(0x29e),'month':_0x3c8317(0x21e),'day':_0x3c8317(0x29e)},_0x9d6788=await master_shop[_0x3c8317(0x279)](),_0x244333=await product['find'](),_0x4887bd=await warehouse[_0x3c8317(0x20b)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x3c8317(0x1b5),'localField':'product_details.product_name','foreignField':_0x3c8317(0x273),'as':_0x3c8317(0x209)}},{'$unwind':_0x3c8317(0x234)},{'$project':{'product_name':_0x3c8317(0x2dc),'product_stock':_0x3c8317(0x230)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);if(_0x9d6788[0x0][_0x3c8317(0x1d7)]==_0x3c8317(0x321))var _0x2bc9e9=users['English'];else{if(_0x9d6788[0x0]['language']==_0x3c8317(0x2d4))var _0x2bc9e9=users[_0x3c8317(0x2d4)];else{if(_0x9d6788[0x0]['language']=='German')var _0x2bc9e9=users[_0x3c8317(0x30e)];else{if(_0x9d6788[0x0][_0x3c8317(0x1d7)]==_0x3c8317(0x2b9))var _0x2bc9e9=users['Spanish'];else{if(_0x9d6788[0x0][_0x3c8317(0x1d7)]=='French')var _0x2bc9e9=users[_0x3c8317(0x2c2)];else{if(_0x9d6788[0x0][_0x3c8317(0x1d7)]==_0x3c8317(0x1b9))var _0x2bc9e9=users['Portuguese'];else{if(_0x9d6788[0x0][_0x3c8317(0x1d7)]=='Chinese')var _0x2bc9e9=users[_0x3c8317(0x1c8)];else{if(_0x9d6788[0x0][_0x3c8317(0x1d7)]==_0x3c8317(0x1ca))var _0x2bc9e9=users[_0x3c8317(0x2a4)];}}}}}}}_0x4f8b36[_0x3c8317(0x1bf)](_0x3c8317(0x1c6),{'success':_0x197221['flash'](_0x3c8317(0x1fa)),'errors':_0x197221[_0x3c8317(0x300)](_0x3c8317(0x217)),'alldata':_0x244333,'profile':_0x55362c,'master_shop':_0x9d6788,'role':_0x182e5c,'product_stock':_0x4887bd,'language':_0x2bc9e9});}catch(_0x3aa9ee){}});async function agentsdataCheck(_0x4094e3,_0x300fa8){const _0x58125c=a0_0x5c3944,_0x589884=await product[_0x58125c(0x20b)]([{'$group':{'_id':{'brand':_0x58125c(0x243),'category':_0x58125c(0x2c9)},'products':{'$push':{'name':_0x58125c(0x306),'product_code':_0x58125c(0x1d9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xfa04e2=[];_0xfa04e2[_0x58125c(0x1e0)]=[];for(let _0x3c649f=0x0;_0x3c649f<=_0x589884[_0x58125c(0x261)]-0x1;_0x3c649f++){const _0xe30d0f=_0x589884[_0x3c649f];_0xfa04e2[_0x58125c(0x1e0)]['push'](_0xe30d0f);}const _0x4590c8=await product[_0x58125c(0x20b)]([{'$group':{'_id':{'category':_0x58125c(0x2c9)},'products':{'$push':{'brand':_0x58125c(0x243),'product_code':'$product_code','product_name':_0x58125c(0x306)}}}},{'$sort':{'_id.category':-0x1}}]),_0x586b27=await product['aggregate']([{'$group':{'_id':{'category':_0x58125c(0x2c9),'brand':_0x58125c(0x243)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5badfa=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x4094e3,'$lte':_0x300fa8}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x58125c(0x26d)}}},{'$lookup':{'from':'staffs','localField':_0x58125c(0x252),'foreignField':_0x58125c(0x200),'as':_0x58125c(0x30c)}},{'$unwind':_0x58125c(0x23c)},{'$unwind':_0x58125c(0x308)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x58125c(0x2ff)}},{'$lookup':{'from':_0x58125c(0x1b5),'localField':_0x58125c(0x2fa),'foreignField':_0x58125c(0x225),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'sales_id':'$sales_info._id','category':'$product_info.category','brand':_0x58125c(0x222)},'salesman_data':{'$first':'$sales_info.name'},'totalQTY':{'$sum':_0x58125c(0x293)},'products':{'$push':{'qty':_0x58125c(0x293),'product_details':{'prod_name':_0x58125c(0x277),'product_code':_0x58125c(0x1a8),'category':_0x58125c(0x2c8),'brand':_0x58125c(0x222)}}}}}]);let _0x33df11='';_0x33df11+=_0x58125c(0x287),_0x33df11+=_0x58125c(0x2f6),_0x33df11+=_0x58125c(0x266),_0x33df11+=_0x58125c(0x287),_0x33df11+=_0x58125c(0x2f5);for(let _0x5a11f4=0x0;_0x5a11f4<=_0x4590c8[_0x58125c(0x261)]-0x1;_0x5a11f4++){const _0xfc5a35=_0x4590c8[_0x5a11f4];for(let _0x53f7bf=0x0;_0x53f7bf<_0x586b27[_0x58125c(0x261)];_0x53f7bf++){const _0x3ad4f0=_0x586b27[_0x53f7bf];_0x3ad4f0[_0x58125c(0x200)]==_0xfc5a35[_0x58125c(0x200)]['category']&&(_0x33df11+='<td\x20colspan=\x22'+_0x3ad4f0[_0x58125c(0x24c)]+_0x58125c(0x27a)+_0xfc5a35[_0x58125c(0x200)][_0x58125c(0x1df)]+_0x58125c(0x299));}}_0x33df11+=_0x58125c(0x2f5),_0x33df11+='</tr>',_0x33df11+=_0x58125c(0x287),_0x33df11+=_0x58125c(0x236);for(let _0x32b8ad=0x0;_0x32b8ad<=_0x4590c8['length']-0x1;_0x32b8ad++){const _0x1de5e6=_0x4590c8[_0x32b8ad];for(let _0x5f0618=0x0;_0x5f0618<_0xfa04e2[_0x58125c(0x1e0)][_0x58125c(0x261)];_0x5f0618++){const _0x2cc80a=_0xfa04e2[_0x58125c(0x1e0)][_0x5f0618];_0x2cc80a[_0x58125c(0x200)]['category']==_0x1de5e6[_0x58125c(0x200)]['category']&&(_0x33df11+=_0x58125c(0x2a9)+_0x2cc80a[_0x58125c(0x200)]['brand']+_0x58125c(0x299));}}_0x33df11+=_0x58125c(0x205),_0x33df11+=_0x58125c(0x266);let _0x512b08={'name':[],'dataqty':{}};for(let _0x3620d0=0x0;_0x3620d0<_0xfa04e2[_0x58125c(0x1e0)]['length'];_0x3620d0++){const _0x3f0a60=_0xfa04e2[_0x58125c(0x1e0)][_0x3620d0],_0x1b1f97=_0x3f0a60[_0x58125c(0x200)]['brand'],_0x5147a7=_0x3f0a60['_id'][_0x58125c(0x1df)];!_0x512b08[_0x58125c(0x2e4)][_0x1b1f97]&&(_0x512b08[_0x58125c(0x2e4)][_0x1b1f97]={});!_0x512b08['dataqty'][_0x1b1f97][_0x5147a7]&&(_0x512b08[_0x58125c(0x2e4)][_0x1b1f97][_0x5147a7]=[]);for(let _0x4e0a45=0x0;_0x4e0a45<_0x5badfa[_0x58125c(0x261)];_0x4e0a45++){const _0x24a11d=_0x5badfa[_0x4e0a45];if(_0x1b1f97===_0x24a11d[_0x58125c(0x200)][_0x58125c(0x1f1)]&&_0x5147a7===_0x24a11d[_0x58125c(0x200)][_0x58125c(0x1df)]){const _0x17e1e2=_0x24a11d[_0x58125c(0x1a1)];!_0x512b08[_0x58125c(0x2e4)][_0x1b1f97][_0x5147a7][_0x17e1e2]&&(_0x512b08[_0x58125c(0x2e4)][_0x1b1f97][_0x5147a7][_0x17e1e2]=[]),_0x512b08['dataqty'][_0x1b1f97][_0x5147a7][_0x17e1e2][_0x58125c(0x2d0)](_0x24a11d[_0x58125c(0x219)]),!_0x512b08['name'][_0x58125c(0x298)](_0x17e1e2)&&_0x512b08[_0x58125c(0x273)]['push'](_0x17e1e2);}}}_0x33df11+=_0x58125c(0x287);for(let _0x348d65=0x0;_0x348d65<=_0x512b08['name'][_0x58125c(0x261)]-0x1;_0x348d65++){const _0x34fd00=_0x512b08[_0x58125c(0x273)][_0x348d65];_0x33df11+=_0x58125c(0x2ef)+_0x34fd00+_0x58125c(0x299);var _0x2e3691=0x0,_0x559268=0x0;for(let _0x417c28=0x0;_0x417c28<=_0xfa04e2[_0x58125c(0x1e0)][_0x58125c(0x261)]-0x1;_0x417c28++){const _0x1bc4fd=_0xfa04e2[_0x58125c(0x1e0)][_0x417c28];var _0x3f148d=0x0;_0x512b08[_0x58125c(0x2e4)][_0x1bc4fd[_0x58125c(0x200)][_0x58125c(0x1f1)]][_0x1bc4fd['_id'][_0x58125c(0x1df)]][_0x34fd00]?(_0x3f148d=_0x512b08[_0x58125c(0x2e4)][_0x1bc4fd[_0x58125c(0x200)][_0x58125c(0x1f1)]][_0x1bc4fd['_id']['category']][_0x34fd00][0x0],_0x33df11+=_0x58125c(0x2ef)+formatNumber(_0x3f148d[_0x58125c(0x1de)](0x2))+'</td>'):(_0x3f148d=0x0,_0x33df11+=_0x58125c(0x2ef)+_0x3f148d+_0x58125c(0x299)),_0x2e3691+=_0x3f148d;}_0x33df11+=_0x58125c(0x2ef)+formatNumber(_0x2e3691[_0x58125c(0x1de)](0x2))+'</td>';}return _0x33df11+='</tr>',_0x33df11;}router['post'](a0_0x5c3944(0x206),auth,async(_0x2122a6,_0x4c4413)=>{const _0x2953=a0_0x5c3944,{from_date:_0xc3bce9,to_date:_0x18e6fd}=_0x2122a6[_0x2953(0x22f)],_0x24960e=await agentsdataCheck(_0xc3bce9,_0x18e6fd);{}let _0x329c55=_0x2953(0x1f2);var _0x10cf78=new Date(_0xc3bce9),_0x130926=new Date(_0x18e6fd);const _0x5b51e5={'year':_0x2953(0x29e),'month':_0x2953(0x21e),'day':_0x2953(0x29e)},_0xbab957=new Intl[(_0x2953(0x257))](_0x2953(0x1b0),_0x5b51e5)[_0x2953(0x19b)](_0x10cf78),_0x40d408=new Intl[(_0x2953(0x257))](_0x2953(0x1b0),_0x5b51e5)['format'](_0x130926);_0x329c55+=_0x2953(0x221),_0x329c55+=_0x2953(0x2ea),_0x329c55+=_0x2953(0x1ff)+_0xbab957+_0x2953(0x2ee)+_0x40d408+_0x2953(0x25f),_0x329c55+='<div\x20class=\x22row\x22>',_0x329c55+='<div\x20class=\x22col-sm-11\x22>',_0x329c55+='<table>',_0x329c55+=_0x24960e,_0x329c55+=_0x2953(0x215),_0x329c55+=_0x2953(0x2f2),_0x329c55+='</div>';const _0x4e9c33={'format':_0x2953(0x2a0),'orientation':_0x2953(0x237),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x2953(0x23d)}}};pdf[_0x2953(0x2c5)](_0x329c55,_0x4e9c33)['toStream'](function(_0x4594a7,_0x10ec8b){const _0x559a85=_0x2953;if(_0x4594a7){_0x4c4413['status'](0x1f4)[_0x559a85(0x2a7)](_0x559a85(0x21d));return;}_0x4c4413['setHeader'](_0x559a85(0x226),'application/pdf'),_0x10ec8b[_0x559a85(0x29b)](_0x4c4413);});}),router['get'](a0_0x5c3944(0x247),auth,async(_0x44f454,_0x338c42)=>{const _0x30e8e9=a0_0x5c3944;try{const {username:_0x10b1f8,email:_0x3d8936,role:_0x4f3a18}=_0x44f454[_0x30e8e9(0x2a8)],_0x4178d6=_0x44f454['user'],_0x2d921d=await profile[_0x30e8e9(0x1c2)]({'email':_0x4178d6['email']}),_0x21f42f={'year':_0x30e8e9(0x29e),'month':_0x30e8e9(0x21e),'day':'numeric'},_0x5a276a=await master_shop[_0x30e8e9(0x279)](),_0xc3ceac=await staff[_0x30e8e9(0x1c2)]({'email':_0x4178d6[_0x30e8e9(0x216)]}),_0x2eb436=await product[_0x30e8e9(0x279)](),_0x1a9648=await warehouse[_0x30e8e9(0x20b)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x30e8e9(0x296),'foreignField':_0x30e8e9(0x273),'as':_0x30e8e9(0x209)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x30e8e9(0x2dc),'product_stock':_0x30e8e9(0x230)}},{'$group':{'_id':_0x30e8e9(0x1f7),'product_stock':{'$sum':_0x30e8e9(0x31e)}}}]),_0x341ffe=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x5a276a[0x0][_0x30e8e9(0x1d7)]=='English\x20(US)')var _0x4467b9=users['English'];else{if(_0x5a276a[0x0][_0x30e8e9(0x1d7)]==_0x30e8e9(0x2d4))var _0x4467b9=users[_0x30e8e9(0x2d4)];else{if(_0x5a276a[0x0][_0x30e8e9(0x1d7)]==_0x30e8e9(0x30e))var _0x4467b9=users[_0x30e8e9(0x30e)];else{if(_0x5a276a[0x0][_0x30e8e9(0x1d7)]==_0x30e8e9(0x2b9))var _0x4467b9=users[_0x30e8e9(0x2b9)];else{if(_0x5a276a[0x0][_0x30e8e9(0x1d7)]==_0x30e8e9(0x2c2))var _0x4467b9=users[_0x30e8e9(0x2c2)];else{if(_0x5a276a[0x0][_0x30e8e9(0x1d7)]==_0x30e8e9(0x1b9))var _0x4467b9=users[_0x30e8e9(0x1cd)];else{if(_0x5a276a[0x0][_0x30e8e9(0x1d7)]==_0x30e8e9(0x1c8))var _0x4467b9=users[_0x30e8e9(0x1c8)];else{if(_0x5a276a[0x0][_0x30e8e9(0x1d7)]==_0x30e8e9(0x1ca))var _0x4467b9=users[_0x30e8e9(0x2a4)];}}}}}}}_0x338c42[_0x30e8e9(0x1bf)](_0x30e8e9(0x27f),{'success':_0x44f454[_0x30e8e9(0x300)](_0x30e8e9(0x1fa)),'errors':_0x44f454[_0x30e8e9(0x300)](_0x30e8e9(0x217)),'alldata':_0x2eb436,'profile':_0x2d921d,'master_shop':_0x5a276a,'role':_0x4178d6,'product_stock':_0x1a9648,'language':_0x4467b9,'staff_arr':_0xc3ceac,'staff_data_all':_0x341ffe});}catch(_0x33e924){_0x338c42[_0x30e8e9(0x2e6)](_0x33e924);}});function a0_0x237f(){const _0x595ba8=['$products.product_details','French','findById','discount','create','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','</script>','$product_info.category','$category','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','$NetPrice','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','$product_list.product_name','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','thin','push','setDate','border-bottom','exports','Hindi','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','$sale_product.stock','Household','forEach','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','write','Products\x20find_data','$product_details.product_name','stock','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','top','432020sYgkZj','each','cash','<p>FINISHED\x20GOODS\x20INVENTORY</p>','dataqty','$product_list.product_code','json','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','<div\x20class=\x22row\x22>','$sale_product.isFG','<p>SALES\x20REPORTS</p>','$totalGross','/agent/view','</b></td>','\x20-\x20','<td\x20class=\x22row_data\x22>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','<div\x20class=\x22col-sm-11\x22>','</div>','attachment;\x20filename=\x22sales_report.xlsx\x22','NumberFormat','<td\x20class=\x22cat_data\x22></td>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','save','6227664iTPwrP','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','sale_product.product_code','!cols','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','td,\x20th','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','false','flash','</tbody>','setHeader','$product.product_name','<th\x20rowspan=\x272\x27>Products</th>','toISOString','$name','express/lib/response','$sale_product','9VkBOtQ','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','sales_info','$sale_product.totalprice','German','$dsi','$product_info.gross_price','<th>\x20INCOMING\x20</th>','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','84960ttoEsL','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','/dsrr/view','html','isFG','$_id.date','border-top','$sale_product.quantity','trim','/dsrr/pdf','$product_stock','bank','right','English\x20(US)','Sales\x20Report','window.print();','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','error','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','$totalQty','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','format','totalGross','colspan','<th>\x20ITEM\x20DESCRIPTION\x20</th>','note','product_details','salesman_data','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x223\x22><b>TOTAL<b>','</th>','application/pdf','<th\x20colspan=\x272\x27>SOLD</th>','$amount','$product_info.product_code','border-right','$_id.dsi','then','true','post','beg_bal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','en-US','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','/agent_reports/pdf_admin','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','style','products','redirect','referenceNumber','$_id.brand','Portuguese\x20(BR)','totalPrice','$bank','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','balanced','attachment;\x20filename=\x22reports.xlsx\x22','render','$_id.customer','load','findOne','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','sumqty','$products.discount','agent_sales','<td\x20class=\x22row_data\x22>0</td>','Chinese','<th>\x20ITEM\x20CODE\x20</th>','Arabic\x20(ae)','<th>Booking</th>','dsi','Portuguese','canvas','replace','book_new','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','$date','table\x20tr','$products.product_details.prod_id','$products.NetPrice','$products.product_details.gross_price','language','blob-stream','$product_code','$products','<th>X-Truck</th>','/dsrr_admin/view_data/:id','../middleware/auth','toFixed','category','cat_brand','Asia/Manila','bottom','/balance/view','1178mVzJvu','$check_no','$due_date','status','window.onload\x20=\x20function()\x20{','<tbody>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','border-left','000000','$sale_product.discount','738ONYqwS','$discount','<td\x20class=\x22row_data\x22></td>','brand','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','date','jsbarcode','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$product_name','express','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','success','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','20mm','<th>\x20SALES\x20</th>','<p>','_id','$sale_product.product_code','excel','qty','1554540FYJiXA','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','/agent/pdf','<script>','left','product_docs','/dsrr_admin/pdf_admin','aggregate','$products.qty','test','/reports/dsrr/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','pdfkit-table','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','361jtWvGt','Products\x20warehouse_data','../public/language/languages.json','</table>','email','errors','$product','totalQTY','/agent_reports/view','aoa_to_sheet','attr','Error\x20generating\x20PDF','long','multer','No\x20data\x20was\x20Found!','<h1>JAKA\x20EQUITIES\x20CORP</h1>','$product_info.brand','Router','sort','product_code','Content-Type','mongoose','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','</thead>','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','$cash','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','map','body','$product_details.product_stock','Content-Disposition','rowspan','html-pdf','$product_docs','0.1in','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','landscape','\x20-\x20HH','product_info','$status_data','sales_man_code','$sales_info','/dev/null','$_id.category','$sale_product.prod_cat','../models/all_models','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','905562ZMwIVB','$brand','<td\x20colspan=\x22','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','/dl_excel','/agent_reports/sales_ad','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','$product_list.product_stock','$sale_product.adj_discount','$products.adj_discount','brandCount','$product_info','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','amount','utils','\x22><b></b></td>','sales_staff_id','toStream','product_stock','check_no','/inventory_sum/view','DateTimeFormat','sales_bkg','thick','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','<td\x20class=\x22row_data\x22><b>','$product.quantity','log','image','</p>','$sale_product._id','length','exceljs','prod_cat','PDF\x20Generation\x20Error:','catch','</tr>','dssr_view_admin','xlsx','!merges','buffer','valueOf','/agent_reports/pdf','$sales_staff_id','<thead>','due_date','customer','adj_discount','reduce','name','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','<table>','$product_info.name','$products.product_details.brand','find','\x22\x20class=\x22cat_data\x22>','<div\x20\x20id=\x22table-conatainer\x22>','sales_reports','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','15in','dsi_sales_admin','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','toLocaleString','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','product_name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','$products.product_details.category','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','<tr>','$sale_product.product_name','\x20-\x20STD','path','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','<div\x20style=\x22page-break-before:\x20always;\x22></div>','8.5in','staffs','params','Products\x20master','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','$product_details','$sale_product.real_qty_unit_val','totalQty','get','product_details.product_name','medium','includes','</td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','pipe','\x22><b>','text','numeric','getFullYear','Letter','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','Arabic','NetPrice','totalQTYsum','send','user','<td\x20class=\x22cat_data\x22>','slice','60mm','<p>INVENTORY\x20SUMMARY</p>','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','isArray','English','book_append_sheet','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$adj_discount','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','3764411zrCLtB','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','$customer','Types','Spanish','ObjectId','split','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','<th\x20rowspan=\x272\x27>Category</th>','sales_ext','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','$product_list'];a0_0x237f=function(){return _0x595ba8;};return a0_0x237f();}async function agentsdataDSICheck_admin(_0x283fab,_0xa7c515,_0x4008e8,_0x59b794){const _0x23ee63=a0_0x5c3944,_0x3619ad=await product['aggregate']([{'$group':{'_id':{'brand':_0x23ee63(0x243),'category':_0x23ee63(0x2c9)},'products':{'$push':{'name':_0x23ee63(0x306),'product_code':_0x23ee63(0x1d9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2efae2=[];_0x2efae2[_0x23ee63(0x1e0)]=[];for(let _0xf967ab=0x0;_0xf967ab<=_0x3619ad[_0x23ee63(0x261)]-0x1;_0xf967ab++){const _0x438008=_0x3619ad[_0xf967ab];_0x2efae2[_0x23ee63(0x1e0)][_0x23ee63(0x2d0)](_0x438008);}const _0x12b9f8=await product[_0x23ee63(0x20b)]([{'$group':{'_id':{'category':_0x23ee63(0x2c9)},'products':{'$push':{'brand':_0x23ee63(0x243),'product_code':_0x23ee63(0x1d9),'product_name':_0x23ee63(0x306)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1fc40c=await product[_0x23ee63(0x20b)]([{'$group':{'_id':{'category':_0x23ee63(0x2c9),'brand':'$brand'}}},{'$group':{'_id':_0x23ee63(0x23e),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x17c1c8=await sales_sa[_0x23ee63(0x20b)]([{'$match':{'date':{'$gte':_0x283fab,'$lte':_0xa7c515},'sales_staff_id':_0x4008e8,'sale_product.isFG':_0x23ee63(0x2ff)}},{'$unwind':_0x23ee63(0x308)},{'$match':{'sale_product.isFG':_0x23ee63(0x2ff)}},{'$lookup':{'from':_0x23ee63(0x1b5),'localField':'sale_product.product_code','foreignField':_0x23ee63(0x225),'as':_0x23ee63(0x239)}},{'$unwind':_0x23ee63(0x24d)},{'$group':{'_id':{'dsi':_0x23ee63(0x30f),'date':'$date','customer':_0x23ee63(0x2b7)},'totalQty':{'$sum':_0x23ee63(0x293)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x23ee63(0x30d),'discount':'$sale_product.discount','adj_discount':_0x23ee63(0x24a),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x23ee63(0x2c8),'brand':_0x23ee63(0x222),'gross_price':_0x23ee63(0x310)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x23ee63(0x319),'customer':_0x23ee63(0x1c0),'category':'$products.product_details.category','brand':_0x23ee63(0x278)},'totalQty':{'$sum':_0x23ee63(0x20c)},'totalGross':{'$sum':{'$multiply':[_0x23ee63(0x20c),_0x23ee63(0x1d6)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x23ee63(0x24b)},'product_details':{'$first':_0x23ee63(0x2c1)}}},{'$group':{'_id':{'dsi':_0x23ee63(0x1aa),'date':_0x23ee63(0x319),'customer':_0x23ee63(0x1c0)},'totalQty':{'$sum':_0x23ee63(0x199)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x23ee63(0x2cb)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x23ee63(0x2b3)},'products':{'$push':{'qty':'$totalQty','category':_0x23ee63(0x23e),'brand':_0x23ee63(0x1b8),'product_details':_0x23ee63(0x292)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4b53ea=[],_0x164ce6={},_0x2ad3fe={},_0xa1ddea={};var _0x3f19e3=0x0,_0x26fb84=0x0,_0x2dfb42=0x0,_0x490c69=0x0,_0x3d7b32=0x0;const _0x3bcdeb=0x6;for(let _0x6c1303=0x0;_0x6c1303<=_0x17c1c8[_0x23ee63(0x261)]-0x1;_0x6c1303++){const _0x289ba7=_0x17c1c8[_0x6c1303];let _0x255519=_0x23ee63(0x287);_0x255519+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x289ba7[_0x23ee63(0x200)][_0x23ee63(0x1cc)]+'</td>',_0x255519+=_0x23ee63(0x211)+_0x289ba7['_id'][_0x23ee63(0x1f3)]+_0x23ee63(0x299),_0x255519+=_0x23ee63(0x211)+_0x289ba7['_id'][_0x23ee63(0x270)]+_0x23ee63(0x299);let _0x53f49b={};var _0x4fe045=0x0;for(let _0x2b8a98=0x0;_0x2b8a98<=_0x289ba7['products'][_0x23ee63(0x261)]-0x1;_0x2b8a98++){const _0x344e33=_0x289ba7[_0x23ee63(0x1b5)][_0x2b8a98];_0x53f49b[_0x344e33['brand']+'-'+_0x344e33[_0x23ee63(0x1df)]]=_0x344e33['qty'];const _0x12ef7=_0x344e33[_0x23ee63(0x1f1)]+'-'+_0x344e33[_0x23ee63(0x1df)];!_0x164ce6[_0x12ef7]&&(_0x164ce6[_0x12ef7]=0x0),!Array[_0x23ee63(0x2af)](_0xa1ddea[_0x12ef7])&&(_0xa1ddea[_0x12ef7]=[]),!Array[_0x23ee63(0x2af)](_0xa1ddea[_0x12ef7])&&(_0xa1ddea[_0x12ef7]=[]),_0x164ce6[_0x12ef7]+=_0x344e33[_0x23ee63(0x203)],_0xa1ddea[_0x12ef7][_0x23ee63(0x2d0)](_0x344e33['qty']),_0x4fe045++;}console[_0x23ee63(0x25d)](_0x289ba7);for(let _0x2b3574=0x0;_0x2b3574<=_0x2efae2[_0x23ee63(0x1e0)][_0x23ee63(0x261)]-0x1;_0x2b3574++){const _0x1dd3d0=_0x2efae2['cat_brand'][_0x2b3574],_0x3a03c5=_0x1dd3d0[_0x23ee63(0x200)]['brand']+'-'+_0x1dd3d0[_0x23ee63(0x200)][_0x23ee63(0x1df)];_0x255519+=_0x23ee63(0x1fb)+(_0x53f49b[_0x3a03c5]!==undefined?_0x53f49b[_0x3a03c5][_0x23ee63(0x1de)](0x2):'')+_0x23ee63(0x299);}_0x2dfb42=_0x289ba7[_0x23ee63(0x2c4)]+_0x289ba7[_0x23ee63(0x271)],_0x255519+=_0x23ee63(0x2fe)+formatNumber(parseFloat(_0x289ba7[_0x23ee63(0x294)],0x2)[_0x23ee63(0x1de)](0x2))+_0x23ee63(0x299),_0x255519+=_0x23ee63(0x2fe)+formatNumber(_0x289ba7[_0x23ee63(0x19c)][_0x23ee63(0x1de)](0x2))+_0x23ee63(0x299),_0x255519+=_0x23ee63(0x2fe)+formatNumber(_0x2dfb42)+_0x23ee63(0x299),_0x255519+=_0x23ee63(0x2fe)+formatNumber(_0x289ba7[_0x23ee63(0x2a5)]['toFixed'](0x2))+_0x23ee63(0x299),_0x255519+='</tr>',_0x3f19e3+=parseFloat(_0x289ba7['totalQty'][_0x23ee63(0x1de)](0x2)),_0x26fb84+=parseFloat(_0x289ba7['NetPrice'][_0x23ee63(0x1de)](0x2)),_0x490c69+=_0x2dfb42,_0x3d7b32+=parseFloat(_0x289ba7[_0x23ee63(0x19c)][_0x23ee63(0x1de)](0x2));if(_0x6c1303==_0x17c1c8[_0x23ee63(0x261)]-0x1){_0x255519+='<tr>',_0x255519+=_0x23ee63(0x1a3),_0x255519+=_0x23ee63(0x299);for(let _0x1006a4=0x0;_0x1006a4<=_0x2efae2[_0x23ee63(0x1e0)][_0x23ee63(0x261)]-0x1;_0x1006a4++){const _0x4a13cc=_0x2efae2[_0x23ee63(0x1e0)][_0x1006a4],_0x5a540d=_0x4a13cc[_0x23ee63(0x200)]['brand']+'-'+_0x4a13cc['_id'][_0x23ee63(0x1df)],_0x469c9e=_0xa1ddea[_0x5a540d][_0x23ee63(0x272)]((_0x31406b,_0x5a5210)=>_0x31406b+_0x5a5210,0x0);console[_0x23ee63(0x25d)]('test',_0x5a540d),_0x255519+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x469c9e!==undefined?formatNumber(_0x469c9e[_0x23ee63(0x1de)](0x2)):'')+_0x23ee63(0x2ed),console[_0x23ee63(0x25d)](_0xa1ddea[_0x5a540d][_0x23ee63(0x272)]((_0x5c82b0,_0x234028)=>_0x5c82b0+_0x234028,0x0));}_0x255519+=_0x23ee63(0x19a)+formatNumber(_0x3f19e3[_0x23ee63(0x1de)](0x2))+'</b></td>',_0x255519+=_0x23ee63(0x19a)+formatNumber(_0x3d7b32)+_0x23ee63(0x2ed),_0x255519+=_0x23ee63(0x19a)+formatNumber(_0x490c69)+_0x23ee63(0x2ed),_0x255519+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x26fb84)+_0x23ee63(0x2ed),_0x255519+=_0x23ee63(0x266);}_0x4b53ea[_0x23ee63(0x2d0)](_0x255519);}function _0x4cc7ea(_0x51bf4e,_0x468001){const _0x484d86=_0x23ee63,_0x5605b3=[];for(let _0x423338=0x0;_0x423338<=_0x51bf4e[_0x484d86(0x261)]-0x1;_0x423338+=_0x468001){_0x5605b3['push'](_0x51bf4e[_0x484d86(0x2aa)](_0x423338,_0x423338+_0x468001));}return _0x5605b3;}const _0x2a69af=_0x4cc7ea(_0x4b53ea,_0x3bcdeb);let _0x39f895='';return _0x2a69af[_0x23ee63(0x2d8)]((_0x154d3c,_0x4b3046)=>{const _0x324289=_0x23ee63;_0x4b3046>0x0&&(_0x39f895+=_0x324289(0x28c));_0x39f895+=_0x324289(0x276),_0x39f895+=_0x324289(0x26e),_0x39f895+=_0x324289(0x287),_0x39f895+=_0x324289(0x2d5),_0x39f895+='</tr>',_0x39f895+='<tr>',_0x39f895+=_0x324289(0x1bc);for(let _0x5c50ec=0x0;_0x5c50ec<=_0x12b9f8['length']-0x1;_0x5c50ec++){const _0x1504a9=_0x12b9f8[_0x5c50ec];for(let _0x553a67=0x0;_0x553a67<_0x1fc40c['length'];_0x553a67++){const _0x721ef7=_0x1fc40c[_0x553a67];_0x721ef7[_0x324289(0x200)]===_0x1504a9[_0x324289(0x200)][_0x324289(0x1df)]&&(_0x39f895+=_0x324289(0x244)+_0x721ef7['brandCount']+_0x324289(0x27a)+_0x1504a9[_0x324289(0x200)][_0x324289(0x1df)]+_0x324289(0x299));}}_0x39f895+=_0x324289(0x282),_0x39f895+=_0x324289(0x266),_0x39f895+=_0x324289(0x287),_0x39f895+=_0x324289(0x27d),_0x39f895+=_0x324289(0x2d9),_0x39f895+=_0x324289(0x24e);for(let _0x41c043=0x0;_0x41c043<=_0x12b9f8[_0x324289(0x261)]-0x1;_0x41c043++){const _0x2ec1a8=_0x12b9f8[_0x41c043];for(let _0x1fce2d=0x0;_0x1fce2d<_0x2efae2[_0x324289(0x1e0)][_0x324289(0x261)];_0x1fce2d++){const _0x216e5f=_0x2efae2[_0x324289(0x1e0)][_0x1fce2d];_0x216e5f[_0x324289(0x200)][_0x324289(0x1df)]===_0x2ec1a8[_0x324289(0x200)][_0x324289(0x1df)]&&(_0x39f895+=_0x324289(0x2a9)+_0x216e5f['_id'][_0x324289(0x1f1)]+_0x324289(0x299));}}_0x39f895+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x39f895+=_0x324289(0x2f0),_0x39f895+=_0x324289(0x314),_0x39f895+=_0x324289(0x1fc),_0x39f895+='</tr>',_0x39f895+='</thead>',_0x39f895+=_0x324289(0x1e9),_0x154d3c[_0x324289(0x2d8)](_0x1d587b=>{_0x39f895+=_0x1d587b;}),console[_0x324289(0x25d)](_0xa1ddea),_0x39f895+=_0x324289(0x301),_0x39f895+=_0x324289(0x215);}),_0x39f895;}async function agentsdataDSICheck_admin_excel(_0x2415bf,_0x1e6cd4,_0x25deff,_0x5f3517){const _0x143c0b=a0_0x5c3944,_0x7c051=await product[_0x143c0b(0x20b)]([{'$group':{'_id':{'brand':_0x143c0b(0x243),'category':_0x143c0b(0x2c9)},'products':{'$push':{'name':'$name','product_code':_0x143c0b(0x1d9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x23b339=[];_0x23b339[_0x143c0b(0x1e0)]=[];for(let _0x101adf=0x0;_0x101adf<=_0x7c051[_0x143c0b(0x261)]-0x1;_0x101adf++){const _0x18d955=_0x7c051[_0x101adf];_0x23b339[_0x143c0b(0x1e0)]['push'](_0x18d955);}const _0x16c06a=await product[_0x143c0b(0x20b)]([{'$group':{'_id':{'category':_0x143c0b(0x2c9)},'products':{'$push':{'brand':_0x143c0b(0x243),'product_code':_0x143c0b(0x1d9),'product_name':_0x143c0b(0x306)}}}},{'$sort':{'_id.category':-0x1}}]),_0x17c598=await product['aggregate']([{'$group':{'_id':{'category':_0x143c0b(0x2c9),'brand':_0x143c0b(0x243)}}},{'$group':{'_id':_0x143c0b(0x23e),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1f460a=await sales_sa[_0x143c0b(0x20b)]([{'$match':{'date':{'$gte':_0x2415bf,'$lte':_0x1e6cd4},'sales_staff_id':_0x25deff,'sale_product.isFG':_0x143c0b(0x2ff)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x143c0b(0x2ff)}},{'$lookup':{'from':_0x143c0b(0x1b5),'localField':_0x143c0b(0x2fa),'foreignField':_0x143c0b(0x225),'as':_0x143c0b(0x239)}},{'$unwind':_0x143c0b(0x24d)},{'$group':{'_id':{'dsi':_0x143c0b(0x30f),'date':'$date','customer':_0x143c0b(0x2b7)},'totalQty':{'$sum':_0x143c0b(0x293)},'products':{'$push':{'qty':_0x143c0b(0x293),'NetPrice':_0x143c0b(0x30d),'discount':'$sale_product.discount','adj_discount':_0x143c0b(0x24a),'product_details':{'prod_name':_0x143c0b(0x277),'product_code':_0x143c0b(0x1a8),'category':_0x143c0b(0x2c8),'brand':_0x143c0b(0x222),'gross_price':_0x143c0b(0x310)}}}}},{'$unwind':_0x143c0b(0x1da)},{'$group':{'_id':{'dsi':_0x143c0b(0x1aa),'date':'$_id.date','customer':_0x143c0b(0x1c0),'category':_0x143c0b(0x285),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x143c0b(0x20c)},'totalGross':{'$sum':{'$multiply':[_0x143c0b(0x20c),_0x143c0b(0x1d6)]}},'NetPrice':{'$sum':_0x143c0b(0x1d5)},'discount':{'$sum':_0x143c0b(0x1c5)},'adj_discount':{'$sum':_0x143c0b(0x24b)},'product_details':{'$first':_0x143c0b(0x2c1)}}},{'$group':{'_id':{'dsi':_0x143c0b(0x1aa),'date':_0x143c0b(0x319),'customer':'$_id.customer'},'totalQty':{'$sum':_0x143c0b(0x199)},'totalGross':{'$sum':_0x143c0b(0x2eb)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x143c0b(0x1ef)},'adj_discount':{'$sum':_0x143c0b(0x2b3)},'products':{'$push':{'qty':_0x143c0b(0x199),'category':_0x143c0b(0x23e),'brand':_0x143c0b(0x1b8),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x42b6fe=[],_0x27d385={},_0x2a2e09={},_0x536376={};var _0x3d6030=0x0,_0x5770c7=0x0,_0x5e2426=0x0,_0x4f651d=0x0,_0x46fe6d=0x0;const _0x1f2592=0x16345785d8a0000;for(let _0x50adbe=0x0;_0x50adbe<=_0x1f460a['length']-0x1;_0x50adbe++){const _0x186f96=_0x1f460a[_0x50adbe];let _0x5adcd8=_0x143c0b(0x287);_0x5adcd8+=_0x143c0b(0x211)+_0x186f96[_0x143c0b(0x200)][_0x143c0b(0x1cc)]+_0x143c0b(0x299),_0x5adcd8+=_0x143c0b(0x211)+_0x186f96[_0x143c0b(0x200)][_0x143c0b(0x1f3)]+_0x143c0b(0x299),_0x5adcd8+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x186f96[_0x143c0b(0x200)][_0x143c0b(0x270)]+_0x143c0b(0x299);let _0x27f556={};var _0x116684=0x0;for(let _0x497291=0x0;_0x497291<=_0x186f96[_0x143c0b(0x1b5)][_0x143c0b(0x261)]-0x1;_0x497291++){const _0xba6f7c=_0x186f96[_0x143c0b(0x1b5)][_0x497291];_0x27f556[_0xba6f7c[_0x143c0b(0x1f1)]+'-'+_0xba6f7c[_0x143c0b(0x1df)]]=_0xba6f7c[_0x143c0b(0x203)];const _0x7f0c88=_0xba6f7c[_0x143c0b(0x1f1)]+'-'+_0xba6f7c[_0x143c0b(0x1df)];!_0x27d385[_0x7f0c88]&&(_0x27d385[_0x7f0c88]=0x0),!Array[_0x143c0b(0x2af)](_0x536376[_0x7f0c88])&&(_0x536376[_0x7f0c88]=[]),!Array[_0x143c0b(0x2af)](_0x536376[_0x7f0c88])&&(_0x536376[_0x7f0c88]=[]),_0x27d385[_0x7f0c88]+=_0xba6f7c[_0x143c0b(0x203)],_0x536376[_0x7f0c88]['push'](_0xba6f7c[_0x143c0b(0x203)]),_0x116684++;}console[_0x143c0b(0x25d)](_0x186f96);for(let _0x4169f6=0x0;_0x4169f6<=_0x23b339['cat_brand']['length']-0x1;_0x4169f6++){const _0x3786aa=_0x23b339[_0x143c0b(0x1e0)][_0x4169f6],_0x499189=_0x3786aa[_0x143c0b(0x200)][_0x143c0b(0x1f1)]+'-'+_0x3786aa[_0x143c0b(0x200)][_0x143c0b(0x1df)];_0x5adcd8+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x27f556[_0x499189]!==undefined?_0x27f556[_0x499189][_0x143c0b(0x1de)](0x2):'')+'</td>';}_0x5e2426=_0x186f96[_0x143c0b(0x2c4)]+_0x186f96[_0x143c0b(0x271)],_0x5adcd8+=_0x143c0b(0x2fe)+formatNumber(parseFloat(_0x186f96[_0x143c0b(0x294)],0x2)[_0x143c0b(0x1de)](0x2))+_0x143c0b(0x299),_0x5adcd8+=_0x143c0b(0x2fe)+formatNumber(_0x186f96['totalGross'][_0x143c0b(0x1de)](0x2))+_0x143c0b(0x299),_0x5adcd8+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5e2426)+_0x143c0b(0x299),_0x5adcd8+=_0x143c0b(0x2fe)+formatNumber(_0x186f96[_0x143c0b(0x2a5)]['toFixed'](0x2))+'</td>',_0x5adcd8+=_0x143c0b(0x266),_0x3d6030+=parseFloat(_0x186f96['totalQty'][_0x143c0b(0x1de)](0x2)),_0x5770c7+=parseFloat(_0x186f96[_0x143c0b(0x2a5)][_0x143c0b(0x1de)](0x2)),_0x4f651d+=_0x5e2426,_0x46fe6d+=parseFloat(_0x186f96[_0x143c0b(0x19c)]['toFixed'](0x2));if(_0x50adbe==_0x1f460a[_0x143c0b(0x261)]-0x1){_0x5adcd8+=_0x143c0b(0x287),_0x5adcd8+=_0x143c0b(0x1a3),_0x5adcd8+=_0x143c0b(0x299);for(let _0x2fa756=0x0;_0x2fa756<=_0x23b339['cat_brand'][_0x143c0b(0x261)]-0x1;_0x2fa756++){const _0x3882a2=_0x23b339[_0x143c0b(0x1e0)][_0x2fa756],_0x13608b=_0x3882a2[_0x143c0b(0x200)][_0x143c0b(0x1f1)]+'-'+_0x3882a2['_id'][_0x143c0b(0x1df)],_0x3645bc=_0x536376[_0x13608b]['reduce']((_0x1bda3f,_0x1724a8)=>_0x1bda3f+_0x1724a8,0x0);console['log'](_0x143c0b(0x20d),_0x13608b),_0x5adcd8+=_0x143c0b(0x1f6)+(_0x3645bc!==undefined?formatNumber(_0x3645bc['toFixed'](0x2)):'')+'</b></td>',console[_0x143c0b(0x25d)](_0x536376[_0x13608b][_0x143c0b(0x272)]((_0x322d14,_0x3beb40)=>_0x322d14+_0x3beb40,0x0));}_0x5adcd8+=_0x143c0b(0x19a)+formatNumber(_0x3d6030['toFixed'](0x2))+'</b></td>',_0x5adcd8+=_0x143c0b(0x19a)+formatNumber(_0x46fe6d)+_0x143c0b(0x2ed),_0x5adcd8+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4f651d)+'</b></td>',_0x5adcd8+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5770c7)+'</b></td>',_0x5adcd8+=_0x143c0b(0x266);}_0x42b6fe[_0x143c0b(0x2d0)](_0x5adcd8);}function _0x4dac26(_0xb9bd0b,_0x53df38){const _0x5cfcea=_0x143c0b,_0x1ce01f=[];for(let _0x210a3d=0x0;_0x210a3d<=_0xb9bd0b['length']-0x1;_0x210a3d+=_0x53df38){_0x1ce01f[_0x5cfcea(0x2d0)](_0xb9bd0b[_0x5cfcea(0x2aa)](_0x210a3d,_0x210a3d+_0x53df38));}return _0x1ce01f;}const _0x228f70=_0x4dac26(_0x42b6fe,_0x1f2592);let _0x148029='';return _0x228f70[_0x143c0b(0x2d8)]((_0x1c4b40,_0x573b31)=>{const _0x542d81=_0x143c0b;_0x573b31>0x0&&(_0x148029+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x148029+=_0x542d81(0x276),_0x148029+=_0x542d81(0x26e),_0x148029+=_0x542d81(0x287),_0x148029+=_0x542d81(0x2d5),_0x148029+=_0x542d81(0x266),_0x148029+='<tr>',_0x148029+=_0x542d81(0x1bc);for(let _0xd89feb=0x0;_0xd89feb<=_0x16c06a[_0x542d81(0x261)]-0x1;_0xd89feb++){const _0xf9cffd=_0x16c06a[_0xd89feb];for(let _0x26947e=0x0;_0x26947e<_0x17c598[_0x542d81(0x261)];_0x26947e++){const _0x5e4c0a=_0x17c598[_0x26947e];_0x5e4c0a[_0x542d81(0x200)]===_0xf9cffd[_0x542d81(0x200)][_0x542d81(0x1df)]&&(_0x148029+='<td\x20colspan=\x22'+_0x5e4c0a[_0x542d81(0x24c)]+'\x22\x20class=\x22cat_data\x22>'+_0xf9cffd[_0x542d81(0x200)][_0x542d81(0x1df)]+_0x542d81(0x299));}}_0x148029+=_0x542d81(0x282),_0x148029+=_0x542d81(0x266),_0x148029+=_0x542d81(0x287),_0x148029+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x148029+=_0x542d81(0x2d9),_0x148029+=_0x542d81(0x24e);for(let _0x2cb0e6=0x0;_0x2cb0e6<=_0x16c06a['length']-0x1;_0x2cb0e6++){const _0x47f380=_0x16c06a[_0x2cb0e6];for(let _0x4a1d49=0x0;_0x4a1d49<_0x23b339[_0x542d81(0x1e0)][_0x542d81(0x261)];_0x4a1d49++){const _0x1c543e=_0x23b339[_0x542d81(0x1e0)][_0x4a1d49];_0x1c543e['_id'][_0x542d81(0x1df)]===_0x47f380['_id'][_0x542d81(0x1df)]&&(_0x148029+='<td\x20class=\x22cat_data\x22>'+_0x1c543e[_0x542d81(0x200)]['brand']+'</td>');}}_0x148029+=_0x542d81(0x205),_0x148029+=_0x542d81(0x2f0),_0x148029+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x148029+=_0x542d81(0x1fc),_0x148029+='</tr>',_0x148029+=_0x542d81(0x229),_0x148029+=_0x542d81(0x1e9),_0x1c4b40[_0x542d81(0x2d8)](_0x504d80=>{_0x148029+=_0x504d80;}),console['log'](_0x536376),_0x148029+='</tbody>',_0x148029+='</table>';}),_0x148029;}router[a0_0x5c3944(0x1ad)](a0_0x5c3944(0x1b2),auth,async(_0x4252fe,_0x2a0492)=>{const _0x2a31d1=a0_0x5c3944,{from_date:_0x56eff0,to_date:_0x3a7638,isExcel:_0x298705,agent_id:_0x380351}=_0x4252fe['body'],_0x5103d2=_0x4252fe[_0x2a31d1(0x2a8)],_0x2d3b54=await staff[_0x2a31d1(0x1c2)]({'email':_0x5103d2[_0x2a31d1(0x216)]}),_0x75e7a1=await master_shop['find'](),_0x577a21=await agentsdataDSICheck_admin(_0x56eff0,_0x3a7638,_0x380351,_0x298705),_0x4910a8=await agentsdataDSICheck_admin_excel(_0x56eff0,_0x3a7638,_0x380351,_0x298705);let _0x1148e2='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x11036b=new Date(_0x56eff0),_0x376bd6=new Date(_0x3a7638);const _0x1e6dfd={'year':_0x2a31d1(0x29e),'month':_0x2a31d1(0x21e),'day':'numeric'},_0x3d24e5=new Intl[(_0x2a31d1(0x257))](_0x2a31d1(0x1b0),_0x1e6dfd)[_0x2a31d1(0x19b)](_0x11036b),_0x329076=new Intl['DateTimeFormat'](_0x2a31d1(0x1b0),_0x1e6dfd)[_0x2a31d1(0x19b)](_0x376bd6);_0x1148e2+=_0x2a31d1(0x2e8),_0x1148e2+=_0x2a31d1(0x27b),_0x1148e2+=_0x2a31d1(0x276),_0x1148e2+=_0x577a21,_0x1148e2+='</table>',_0x1148e2+=_0x2a31d1(0x2f2),_0x1148e2+='</div>';let _0x1a8d0c=_0x2a31d1(0x2b2);_0x1a8d0c+='<div\x20class=\x22row\x22>',_0x1a8d0c+='<div\x20\x20id=\x22table-conatainer\x22>',_0x1a8d0c+=_0x2a31d1(0x276),_0x1a8d0c+=_0x4910a8,_0x1a8d0c+=_0x2a31d1(0x215),_0x1a8d0c+=_0x2a31d1(0x2f2),_0x1a8d0c+=_0x2a31d1(0x2f2);let _0x163e3e=_0x2a31d1(0x29a);const _0x31700a={'width':'15in','height':_0x2a31d1(0x28d),'orientation':_0x2a31d1(0x237),'border':{'top':_0x2a31d1(0x235),'right':'0.1in','bottom':_0x2a31d1(0x235),'left':_0x2a31d1(0x235)},'header':{'height':_0x2a31d1(0x2ab),'contents':_0x2a31d1(0x1af)+_0x163e3e+_0x2a31d1(0x30b)+_0x3d24e5+_0x2a31d1(0x2ee)+_0x329076+_0x2a31d1(0x274)},'footer':{'height':_0x2a31d1(0x1fd),'contents':{'default':_0x2a31d1(0x2fc)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x298705=='on'){const _0x498465=cheerio[_0x2a31d1(0x1c1)](_0x1a8d0c);let _0x1ed063=[],_0xb19b85=[],_0x2092bd=[];_0x498465(_0x2a31d1(0x1d3))[_0x2a31d1(0x2e1)]((_0x207ee9,_0x1c9b88)=>{const _0xf965db=_0x2a31d1;let _0x2e9d91=[],_0x45b80d=0x0;while(_0x2092bd[_0x45b80d]){_0x2092bd[_0x45b80d]--,_0x45b80d++;}_0x498465(_0x1c9b88)[_0xf965db(0x279)](_0xf965db(0x2fd))[_0xf965db(0x2e1)]((_0x4d553f,_0x2f4dc8)=>{const _0x3bf660=_0xf965db;let _0x29b327=_0x498465(_0x2f4dc8)[_0x3bf660(0x29d)]()[_0x3bf660(0x31c)](),_0x4d388d=parseFloat(_0x29b327['replace'](/,/g,''));isNaN(_0x4d388d)&&(_0x4d388d=_0x29b327);let _0x4d83a5=parseInt(_0x498465(_0x2f4dc8)['attr']('colspan'))||0x1,_0x34df25=parseInt(_0x498465(_0x2f4dc8)[_0x3bf660(0x21c)](_0x3bf660(0x232)))||0x1;_0x2e9d91[_0x45b80d]=_0x4d388d;(_0x4d83a5>0x1||_0x34df25>0x1)&&_0xb19b85[_0x3bf660(0x2d0)]({'s':{'r':_0x207ee9,'c':_0x45b80d},'e':{'r':_0x207ee9+_0x34df25-0x1,'c':_0x45b80d+_0x4d83a5-0x1}});for(let _0x5097c4=0x0;_0x5097c4<_0x4d83a5;_0x5097c4++){_0x34df25>0x1&&(_0x2092bd[_0x45b80d+_0x5097c4]=_0x34df25-0x1);}_0x45b80d+=_0x4d83a5;}),_0x1ed063[_0xf965db(0x2d0)](_0x2e9d91);});const _0x4853d7=XLSX[_0x2a31d1(0x250)][_0x2a31d1(0x1d0)](),_0x112a77=XLSX['utils'][_0x2a31d1(0x21b)](_0x1ed063);_0xb19b85[_0x2a31d1(0x261)]>0x0&&(_0x112a77[_0x2a31d1(0x269)]=_0xb19b85);_0x112a77[_0x2a31d1(0x2fb)]=_0x1ed063[0x0][_0x2a31d1(0x22e)](()=>({'wpx':0x64})),XLSX[_0x2a31d1(0x250)][_0x2a31d1(0x2b1)](_0x4853d7,_0x112a77,'Sales\x20Report');const _0x166b27=XLSX[_0x2a31d1(0x2da)](_0x4853d7,{'bookType':_0x2a31d1(0x268),'type':_0x2a31d1(0x26a)});_0x2a0492[_0x2a31d1(0x302)](_0x2a31d1(0x231),_0x2a31d1(0x2f3)),_0x2a0492['setHeader']('Content-Type',_0x2a31d1(0x22d)),_0x2a0492['send'](_0x166b27);}else pdf['create'](_0x1148e2,_0x31700a)[_0x2a31d1(0x253)](function(_0x87947d,_0x1e0016){const _0x5c9719=_0x2a31d1;if(_0x87947d){_0x2a0492[_0x5c9719(0x1e7)](0x1f4)[_0x5c9719(0x2a7)]('Error\x20generating\x20PDF');return;}_0x2a0492[_0x5c9719(0x302)](_0x5c9719(0x226),'application/pdf'),_0x1e0016[_0x5c9719(0x29b)](_0x2a0492);});}),router[a0_0x5c3944(0x295)](a0_0x5c3944(0x21a),auth,async(_0xcb67aa,_0x4178d5)=>{const _0x3ef268=a0_0x5c3944;try{const {username:_0x2986fc,email:_0x5544bc,role:_0x36903f}=_0xcb67aa['user'],_0x580e9b=_0xcb67aa['user'],_0x2bdc4a=await profile['findOne']({'email':_0x580e9b['email']}),_0x4f9dad={'year':_0x3ef268(0x29e),'month':'long','day':_0x3ef268(0x29e)},_0x3fcee5=await master_shop[_0x3ef268(0x279)](),_0x3f2710=await staff[_0x3ef268(0x1c2)]({'email':_0x580e9b['email']}),_0x482c46=await product['find'](),_0x5b1eaf=await warehouse[_0x3ef268(0x20b)]([{'$unwind':_0x3ef268(0x292)},{'$lookup':{'from':'products','localField':_0x3ef268(0x296),'foreignField':'name','as':_0x3ef268(0x209)}},{'$unwind':_0x3ef268(0x234)},{'$project':{'product_name':_0x3ef268(0x2dc),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x3ef268(0x1f7),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x3fcee5[0x0]['language']==_0x3ef268(0x321))var _0x40b301=users[_0x3ef268(0x2b0)];else{if(_0x3fcee5[0x0][_0x3ef268(0x1d7)]==_0x3ef268(0x2d4))var _0x40b301=users[_0x3ef268(0x2d4)];else{if(_0x3fcee5[0x0][_0x3ef268(0x1d7)]==_0x3ef268(0x30e))var _0x40b301=users[_0x3ef268(0x30e)];else{if(_0x3fcee5[0x0][_0x3ef268(0x1d7)]==_0x3ef268(0x2b9))var _0x40b301=users[_0x3ef268(0x2b9)];else{if(_0x3fcee5[0x0][_0x3ef268(0x1d7)]==_0x3ef268(0x2c2))var _0x40b301=users[_0x3ef268(0x2c2)];else{if(_0x3fcee5[0x0][_0x3ef268(0x1d7)]==_0x3ef268(0x1b9))var _0x40b301=users[_0x3ef268(0x1cd)];else{if(_0x3fcee5[0x0][_0x3ef268(0x1d7)]=='Chinese')var _0x40b301=users[_0x3ef268(0x1c8)];else{if(_0x3fcee5[0x0][_0x3ef268(0x1d7)]==_0x3ef268(0x1ca))var _0x40b301=users['Arabic'];}}}}}}}_0x4178d5[_0x3ef268(0x1bf)]('dsi_sales',{'success':_0xcb67aa['flash']('success'),'errors':_0xcb67aa['flash'](_0x3ef268(0x217)),'alldata':_0x482c46,'profile':_0x2bdc4a,'master_shop':_0x3fcee5,'role':_0x580e9b,'product_stock':_0x5b1eaf,'language':_0x40b301,'staff_arr':_0x3f2710});}catch(_0xb23434){}});function formatNumber(_0x4fca77,_0x3fb889=a0_0x5c3944(0x1b0),_0x590ffb={'minimumFractionDigits':0x2}){const _0x3ad10d=a0_0x5c3944,_0x2cb73c=new Intl['NumberFormat'](_0x3fb889,_0x590ffb);return _0x2cb73c[_0x3ad10d(0x19b)](_0x4fca77);}async function agentsdataDSICheck(_0x3de293,_0x3bd7f1,_0x34cb1d,_0x2f46a4){const _0x166598=a0_0x5c3944,_0x207082=await product[_0x166598(0x20b)]([{'$group':{'_id':{'brand':_0x166598(0x243),'category':_0x166598(0x2c9)},'products':{'$push':{'name':'$name','product_code':_0x166598(0x1d9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x45aaeb=[];_0x45aaeb['cat_brand']=[];for(let _0x11eb74=0x0;_0x11eb74<=_0x207082[_0x166598(0x261)]-0x1;_0x11eb74++){const _0x280cb0=_0x207082[_0x11eb74];_0x45aaeb[_0x166598(0x1e0)][_0x166598(0x2d0)](_0x280cb0);}const _0x56baa1=await product[_0x166598(0x20b)]([{'$group':{'_id':{'category':_0x166598(0x2c9)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x166598(0x306)}}}},{'$sort':{'_id.category':-0x1}}]),_0x25c170=await product[_0x166598(0x20b)]([{'$group':{'_id':{'category':_0x166598(0x2c9),'brand':_0x166598(0x243)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2fbd04=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3de293,'$lte':_0x3bd7f1},'sales_staff_id':_0x34cb1d,'sale_product.isFG':_0x166598(0x2ff)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x166598(0x2ff)}},{'$lookup':{'from':_0x166598(0x1b5),'localField':'sale_product.product_code','foreignField':_0x166598(0x225),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':_0x166598(0x1d2),'customer':_0x166598(0x2b7)},'totalQty':{'$sum':_0x166598(0x293)},'products':{'$push':{'qty':_0x166598(0x293),'NetPrice':_0x166598(0x30d),'discount':_0x166598(0x1ed),'adj_discount':_0x166598(0x24a),'product_details':{'prod_name':'$product_info.name','product_code':_0x166598(0x1a8),'category':_0x166598(0x2c8),'brand':_0x166598(0x222),'gross_price':_0x166598(0x310)}}}}},{'$unwind':_0x166598(0x1da)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x166598(0x319),'customer':_0x166598(0x1c0),'category':_0x166598(0x285),'brand':_0x166598(0x278)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x166598(0x1d6)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x166598(0x1c5)},'adj_discount':{'$sum':_0x166598(0x24b)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x166598(0x319),'customer':_0x166598(0x1c0)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x166598(0x2eb)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x166598(0x1ef)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x166598(0x1b8),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x36a557=[],_0x15d936={},_0xdf83c4={},_0x3501d4={};var _0x15f264=0x0,_0xec7c63=0x0,_0x448c2a=0x0,_0x3b0fab=0x0,_0x48a01b=0x0;const _0x5d12c8=0x6;for(let _0x21ac68=0x0;_0x21ac68<=_0x2fbd04[_0x166598(0x261)]-0x1;_0x21ac68++){const _0x20fed6=_0x2fbd04[_0x21ac68];let _0x4c1522=_0x166598(0x287);_0x4c1522+=_0x166598(0x211)+_0x20fed6[_0x166598(0x200)][_0x166598(0x1cc)]+_0x166598(0x299),_0x4c1522+=_0x166598(0x211)+_0x20fed6[_0x166598(0x200)][_0x166598(0x1f3)]+_0x166598(0x299),_0x4c1522+=_0x166598(0x211)+_0x20fed6['_id'][_0x166598(0x270)]+_0x166598(0x299);let _0x3324f3={};var _0x17d416=0x0;for(let _0x2396fa=0x0;_0x2396fa<=_0x20fed6['products']['length']-0x1;_0x2396fa++){const _0x275415=_0x20fed6['products'][_0x2396fa];_0x3324f3[_0x275415[_0x166598(0x1f1)]+'-'+_0x275415[_0x166598(0x1df)]]=_0x275415[_0x166598(0x203)];const _0x4abde8=_0x275415['brand']+'-'+_0x275415['category'];!_0x15d936[_0x4abde8]&&(_0x15d936[_0x4abde8]=0x0),!Array[_0x166598(0x2af)](_0x3501d4[_0x4abde8])&&(_0x3501d4[_0x4abde8]=[]),!Array['isArray'](_0x3501d4[_0x4abde8])&&(_0x3501d4[_0x4abde8]=[]),_0x15d936[_0x4abde8]+=_0x275415['qty'],_0x3501d4[_0x4abde8][_0x166598(0x2d0)](_0x275415['qty']),_0x17d416++;}console[_0x166598(0x25d)](_0x20fed6);for(let _0x358605=0x0;_0x358605<=_0x45aaeb['cat_brand'][_0x166598(0x261)]-0x1;_0x358605++){const _0x5003e4=_0x45aaeb[_0x166598(0x1e0)][_0x358605],_0x1d9c15=_0x5003e4[_0x166598(0x200)][_0x166598(0x1f1)]+'-'+_0x5003e4[_0x166598(0x200)]['category'];_0x4c1522+=_0x166598(0x1fb)+(_0x3324f3[_0x1d9c15]!==undefined?_0x3324f3[_0x1d9c15][_0x166598(0x1de)](0x2):'')+'</td>';}_0x448c2a=_0x20fed6['discount']+_0x20fed6['adj_discount'],_0x4c1522+=_0x166598(0x2fe)+formatNumber(parseFloat(_0x20fed6[_0x166598(0x294)],0x2)[_0x166598(0x1de)](0x2))+_0x166598(0x299),_0x4c1522+=_0x166598(0x2fe)+formatNumber(_0x20fed6[_0x166598(0x19c)][_0x166598(0x1de)](0x2))+_0x166598(0x299),_0x4c1522+=_0x166598(0x2fe)+formatNumber(_0x448c2a)+_0x166598(0x299),_0x4c1522+=_0x166598(0x2fe)+formatNumber(_0x20fed6[_0x166598(0x2a5)][_0x166598(0x1de)](0x2))+_0x166598(0x299),_0x4c1522+=_0x166598(0x266),_0x15f264+=parseFloat(_0x20fed6[_0x166598(0x294)][_0x166598(0x1de)](0x2)),_0xec7c63+=parseFloat(_0x20fed6[_0x166598(0x2a5)][_0x166598(0x1de)](0x2)),_0x3b0fab+=_0x448c2a,_0x48a01b+=parseFloat(_0x20fed6[_0x166598(0x19c)]['toFixed'](0x2));if(_0x21ac68==_0x2fbd04['length']-0x1){_0x4c1522+=_0x166598(0x287),_0x4c1522+=_0x166598(0x1a3),_0x4c1522+=_0x166598(0x299);for(let _0x2434b7=0x0;_0x2434b7<=_0x45aaeb[_0x166598(0x1e0)][_0x166598(0x261)]-0x1;_0x2434b7++){const _0x1567cf=_0x45aaeb['cat_brand'][_0x2434b7],_0x3b018e=_0x1567cf['_id'][_0x166598(0x1f1)]+'-'+_0x1567cf[_0x166598(0x200)][_0x166598(0x1df)],_0x20ae60=_0x3501d4[_0x3b018e][_0x166598(0x272)]((_0x216e1a,_0x2c912e)=>_0x216e1a+_0x2c912e,0x0);_0x4c1522+=_0x166598(0x1f6)+(_0x20ae60!==undefined?formatNumber(_0x20ae60['toFixed'](0x2)):'')+_0x166598(0x2ed),console[_0x166598(0x25d)](_0x3501d4[_0x3b018e][_0x166598(0x272)]((_0x42fc9c,_0x2d895d)=>_0x42fc9c+_0x2d895d,0x0));}_0x4c1522+=_0x166598(0x19a)+formatNumber(_0x15f264['toFixed'](0x2))+_0x166598(0x2ed),_0x4c1522+=_0x166598(0x19a)+formatNumber(_0x48a01b)+_0x166598(0x2ed),_0x4c1522+=_0x166598(0x19a)+formatNumber(_0x3b0fab)+_0x166598(0x2ed),_0x4c1522+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xec7c63)+_0x166598(0x2ed),_0x4c1522+=_0x166598(0x266);}_0x36a557[_0x166598(0x2d0)](_0x4c1522);}function _0x155efe(_0x3e0437,_0x3ff4b5){const _0x379d3a=_0x166598,_0x559d49=[];for(let _0x17c148=0x0;_0x17c148<=_0x3e0437[_0x379d3a(0x261)]-0x1;_0x17c148+=_0x3ff4b5){_0x559d49['push'](_0x3e0437[_0x379d3a(0x2aa)](_0x17c148,_0x17c148+_0x3ff4b5));}return _0x559d49;}const _0xbb3087=_0x155efe(_0x36a557,_0x5d12c8);let _0x15de49='';return _0xbb3087[_0x166598(0x2d8)]((_0x453d9e,_0x1d1099)=>{const _0x5ea0ac=_0x166598;_0x1d1099>0x0&&(_0x15de49+=_0x5ea0ac(0x28c));_0x15de49+=_0x5ea0ac(0x276),_0x15de49+=_0x5ea0ac(0x26e),_0x15de49+=_0x5ea0ac(0x287),_0x15de49+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x15de49+=_0x5ea0ac(0x266),_0x15de49+=_0x5ea0ac(0x287),_0x15de49+=_0x5ea0ac(0x1bc);for(let _0x1d4371=0x0;_0x1d4371<=_0x56baa1[_0x5ea0ac(0x261)]-0x1;_0x1d4371++){const _0x19c018=_0x56baa1[_0x1d4371];for(let _0x3bf356=0x0;_0x3bf356<_0x25c170[_0x5ea0ac(0x261)];_0x3bf356++){const _0x226280=_0x25c170[_0x3bf356];_0x226280[_0x5ea0ac(0x200)]===_0x19c018['_id'][_0x5ea0ac(0x1df)]&&(_0x15de49+=_0x5ea0ac(0x244)+_0x226280[_0x5ea0ac(0x24c)]+'\x22\x20class=\x22cat_data\x22>'+_0x19c018[_0x5ea0ac(0x200)]['category']+_0x5ea0ac(0x299));}}_0x15de49+=_0x5ea0ac(0x282),_0x15de49+=_0x5ea0ac(0x266),_0x15de49+=_0x5ea0ac(0x287),_0x15de49+=_0x5ea0ac(0x27d),_0x15de49+=_0x5ea0ac(0x2d9),_0x15de49+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x5b10cf=0x0;_0x5b10cf<=_0x56baa1[_0x5ea0ac(0x261)]-0x1;_0x5b10cf++){const _0x1045f6=_0x56baa1[_0x5b10cf];for(let _0x420795=0x0;_0x420795<_0x45aaeb['cat_brand'][_0x5ea0ac(0x261)];_0x420795++){const _0x36062a=_0x45aaeb[_0x5ea0ac(0x1e0)][_0x420795];_0x36062a[_0x5ea0ac(0x200)]['category']===_0x1045f6[_0x5ea0ac(0x200)][_0x5ea0ac(0x1df)]&&(_0x15de49+=_0x5ea0ac(0x2a9)+_0x36062a[_0x5ea0ac(0x200)]['brand']+_0x5ea0ac(0x299));}}_0x15de49+=_0x5ea0ac(0x205),_0x15de49+=_0x5ea0ac(0x2f0),_0x15de49+=_0x5ea0ac(0x314),_0x15de49+=_0x5ea0ac(0x1fc),_0x15de49+=_0x5ea0ac(0x266),_0x15de49+=_0x5ea0ac(0x229),_0x15de49+=_0x5ea0ac(0x1e9),_0x453d9e[_0x5ea0ac(0x2d8)](_0x1ee523=>{_0x15de49+=_0x1ee523;}),console[_0x5ea0ac(0x25d)](_0x3501d4),_0x15de49+=_0x5ea0ac(0x301),_0x15de49+=_0x5ea0ac(0x215);}),_0x15de49;}async function agentsdataDSICheck_excel(_0x152a6a,_0x4dfcc7,_0x59d9b7,_0x3ef86e){const _0x3c8f91=a0_0x5c3944,_0x4ec11f=await product[_0x3c8f91(0x20b)]([{'$group':{'_id':{'brand':_0x3c8f91(0x243),'category':'$category'},'products':{'$push':{'name':_0x3c8f91(0x306),'product_code':_0x3c8f91(0x1d9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x54650e=[];_0x54650e[_0x3c8f91(0x1e0)]=[];for(let _0x1d52bd=0x0;_0x1d52bd<=_0x4ec11f[_0x3c8f91(0x261)]-0x1;_0x1d52bd++){const _0x1ef716=_0x4ec11f[_0x1d52bd];_0x54650e[_0x3c8f91(0x1e0)][_0x3c8f91(0x2d0)](_0x1ef716);}const _0x44e2a1=await product['aggregate']([{'$group':{'_id':{'category':_0x3c8f91(0x2c9)},'products':{'$push':{'brand':'$brand','product_code':_0x3c8f91(0x1d9),'product_name':_0x3c8f91(0x306)}}}},{'$sort':{'_id.category':-0x1}}]),_0x206332=await product['aggregate']([{'$group':{'_id':{'category':_0x3c8f91(0x2c9),'brand':_0x3c8f91(0x243)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x54cc7c=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x152a6a,'$lte':_0x4dfcc7},'sales_staff_id':_0x59d9b7,'sale_product.isFG':_0x3c8f91(0x2ff)}},{'$unwind':_0x3c8f91(0x308)},{'$match':{'sale_product.isFG':_0x3c8f91(0x2ff)}},{'$lookup':{'from':_0x3c8f91(0x1b5),'localField':_0x3c8f91(0x2fa),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x3c8f91(0x24d)},{'$group':{'_id':{'dsi':_0x3c8f91(0x30f),'date':_0x3c8f91(0x1d2),'customer':'$customer'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x3c8f91(0x293),'NetPrice':'$sale_product.totalprice','discount':_0x3c8f91(0x1ed),'adj_discount':_0x3c8f91(0x24a),'product_details':{'prod_name':_0x3c8f91(0x277),'product_code':'$product_info.product_code','category':_0x3c8f91(0x2c8),'brand':_0x3c8f91(0x222),'gross_price':_0x3c8f91(0x310)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x3c8f91(0x1aa),'date':'$_id.date','customer':_0x3c8f91(0x1c0),'category':_0x3c8f91(0x285),'brand':_0x3c8f91(0x278)},'totalQty':{'$sum':_0x3c8f91(0x20c)},'totalGross':{'$sum':{'$multiply':[_0x3c8f91(0x20c),_0x3c8f91(0x1d6)]}},'NetPrice':{'$sum':_0x3c8f91(0x1d5)},'discount':{'$sum':_0x3c8f91(0x1c5)},'adj_discount':{'$sum':_0x3c8f91(0x24b)},'product_details':{'$first':_0x3c8f91(0x2c1)}}},{'$group':{'_id':{'dsi':_0x3c8f91(0x1aa),'date':_0x3c8f91(0x319),'customer':_0x3c8f91(0x1c0)},'totalQty':{'$sum':_0x3c8f91(0x199)},'totalGross':{'$sum':_0x3c8f91(0x2eb)},'NetPrice':{'$sum':_0x3c8f91(0x2cb)},'discount':{'$sum':_0x3c8f91(0x1ef)},'adj_discount':{'$sum':_0x3c8f91(0x2b3)},'products':{'$push':{'qty':_0x3c8f91(0x199),'category':'$_id.category','brand':_0x3c8f91(0x1b8),'product_details':_0x3c8f91(0x292)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x3be339=[],_0x4826e3={},_0x963e29={},_0x8073ef={};var _0x2c356f=0x0,_0x5dd7c2=0x0,_0x40a0e=0x0,_0x4a9aea=0x0,_0xae3b02=0x0;const _0x3a0e16=0x9184e72a000;for(let _0x1375b4=0x0;_0x1375b4<=_0x54cc7c[_0x3c8f91(0x261)]-0x1;_0x1375b4++){const _0x470892=_0x54cc7c[_0x1375b4];let _0x273aea=_0x3c8f91(0x287);_0x273aea+=_0x3c8f91(0x211)+_0x470892[_0x3c8f91(0x200)][_0x3c8f91(0x1cc)]+'</td>',_0x273aea+=_0x3c8f91(0x211)+_0x470892[_0x3c8f91(0x200)][_0x3c8f91(0x1f3)]+'</td>',_0x273aea+=_0x3c8f91(0x211)+_0x470892[_0x3c8f91(0x200)][_0x3c8f91(0x270)]+_0x3c8f91(0x299);let _0x475aed={};var _0x46ebba=0x0;for(let _0x37fce5=0x0;_0x37fce5<=_0x470892[_0x3c8f91(0x1b5)][_0x3c8f91(0x261)]-0x1;_0x37fce5++){const _0x4566b4=_0x470892[_0x3c8f91(0x1b5)][_0x37fce5];_0x475aed[_0x4566b4['brand']+'-'+_0x4566b4[_0x3c8f91(0x1df)]]=_0x4566b4['qty'];const _0x12cfa2=_0x4566b4[_0x3c8f91(0x1f1)]+'-'+_0x4566b4['category'];!_0x4826e3[_0x12cfa2]&&(_0x4826e3[_0x12cfa2]=0x0),!Array['isArray'](_0x8073ef[_0x12cfa2])&&(_0x8073ef[_0x12cfa2]=[]),!Array[_0x3c8f91(0x2af)](_0x8073ef[_0x12cfa2])&&(_0x8073ef[_0x12cfa2]=[]),_0x4826e3[_0x12cfa2]+=_0x4566b4[_0x3c8f91(0x203)],_0x8073ef[_0x12cfa2][_0x3c8f91(0x2d0)](_0x4566b4[_0x3c8f91(0x203)]),_0x46ebba++;}console[_0x3c8f91(0x25d)](_0x470892);for(let _0x25f725=0x0;_0x25f725<=_0x54650e['cat_brand'][_0x3c8f91(0x261)]-0x1;_0x25f725++){const _0x17023f=_0x54650e['cat_brand'][_0x25f725],_0x5f47a2=_0x17023f[_0x3c8f91(0x200)]['brand']+'-'+_0x17023f['_id'][_0x3c8f91(0x1df)];_0x273aea+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x475aed[_0x5f47a2]!==undefined?_0x475aed[_0x5f47a2][_0x3c8f91(0x1de)](0x2):'')+_0x3c8f91(0x299);}_0x40a0e=_0x470892[_0x3c8f91(0x2c4)]+_0x470892['adj_discount'],_0x273aea+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x470892['totalQty'],0x2)[_0x3c8f91(0x1de)](0x2))+_0x3c8f91(0x299),_0x273aea+=_0x3c8f91(0x2fe)+formatNumber(_0x470892[_0x3c8f91(0x19c)]['toFixed'](0x2))+_0x3c8f91(0x299),_0x273aea+=_0x3c8f91(0x2fe)+formatNumber(_0x40a0e)+_0x3c8f91(0x299),_0x273aea+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x470892[_0x3c8f91(0x2a5)][_0x3c8f91(0x1de)](0x2))+_0x3c8f91(0x299),_0x273aea+=_0x3c8f91(0x266),_0x2c356f+=parseFloat(_0x470892['totalQty'][_0x3c8f91(0x1de)](0x2)),_0x5dd7c2+=parseFloat(_0x470892[_0x3c8f91(0x2a5)][_0x3c8f91(0x1de)](0x2)),_0x4a9aea+=_0x40a0e,_0xae3b02+=parseFloat(_0x470892[_0x3c8f91(0x19c)][_0x3c8f91(0x1de)](0x2));if(_0x1375b4==_0x54cc7c[_0x3c8f91(0x261)]-0x1){_0x273aea+='<tr>',_0x273aea+=_0x3c8f91(0x1a3),_0x273aea+=_0x3c8f91(0x299);for(let _0x440e52=0x0;_0x440e52<=_0x54650e['cat_brand']['length']-0x1;_0x440e52++){const _0x4bf681=_0x54650e[_0x3c8f91(0x1e0)][_0x440e52],_0x2e6ee2=_0x4bf681[_0x3c8f91(0x200)][_0x3c8f91(0x1f1)]+'-'+_0x4bf681[_0x3c8f91(0x200)][_0x3c8f91(0x1df)],_0xd07a1c=_0x8073ef[_0x2e6ee2]['reduce']((_0x11c32c,_0x2b553b)=>_0x11c32c+_0x2b553b,0x0);_0x273aea+=_0x3c8f91(0x1f6)+(_0xd07a1c!==undefined?formatNumber(_0xd07a1c[_0x3c8f91(0x1de)](0x2)):'')+_0x3c8f91(0x2ed),console[_0x3c8f91(0x25d)](_0x8073ef[_0x2e6ee2][_0x3c8f91(0x272)]((_0x2313c6,_0x2fe6d9)=>_0x2313c6+_0x2fe6d9,0x0));}_0x273aea+=_0x3c8f91(0x19a)+formatNumber(_0x2c356f[_0x3c8f91(0x1de)](0x2))+_0x3c8f91(0x2ed),_0x273aea+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xae3b02)+_0x3c8f91(0x2ed),_0x273aea+=_0x3c8f91(0x19a)+formatNumber(_0x4a9aea)+_0x3c8f91(0x2ed),_0x273aea+=_0x3c8f91(0x19a)+formatNumber(_0x5dd7c2)+_0x3c8f91(0x2ed),_0x273aea+=_0x3c8f91(0x266);}_0x3be339[_0x3c8f91(0x2d0)](_0x273aea);}function _0x4ee9c2(_0x3ced28,_0x4ace75){const _0xa1a8d8=_0x3c8f91,_0x15f716=[];for(let _0x64ad48=0x0;_0x64ad48<=_0x3ced28[_0xa1a8d8(0x261)]-0x1;_0x64ad48+=_0x4ace75){_0x15f716[_0xa1a8d8(0x2d0)](_0x3ced28['slice'](_0x64ad48,_0x64ad48+_0x4ace75));}return _0x15f716;}const _0x1a83f3=_0x4ee9c2(_0x3be339,_0x3a0e16);let _0x515bda='';return _0x1a83f3[_0x3c8f91(0x2d8)]((_0x28c243,_0x660ac9)=>{const _0x2fe3aa=_0x3c8f91;_0x660ac9>0x0&&(_0x515bda+=_0x2fe3aa(0x28c));_0x515bda+=_0x2fe3aa(0x276),_0x515bda+=_0x2fe3aa(0x26e),_0x515bda+=_0x2fe3aa(0x287),_0x515bda+=_0x2fe3aa(0x2d5),_0x515bda+=_0x2fe3aa(0x266),_0x515bda+='<tr>',_0x515bda+=_0x2fe3aa(0x1bc);for(let _0x14f73c=0x0;_0x14f73c<=_0x44e2a1[_0x2fe3aa(0x261)]-0x1;_0x14f73c++){const _0x4cbfbf=_0x44e2a1[_0x14f73c];for(let _0x2462f2=0x0;_0x2462f2<_0x206332['length'];_0x2462f2++){const _0x4f9af9=_0x206332[_0x2462f2];_0x4f9af9['_id']===_0x4cbfbf[_0x2fe3aa(0x200)][_0x2fe3aa(0x1df)]&&(_0x515bda+=_0x2fe3aa(0x244)+_0x4f9af9['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x4cbfbf[_0x2fe3aa(0x200)][_0x2fe3aa(0x1df)]+_0x2fe3aa(0x299));}}_0x515bda+=_0x2fe3aa(0x282),_0x515bda+='</tr>',_0x515bda+=_0x2fe3aa(0x287),_0x515bda+=_0x2fe3aa(0x27d),_0x515bda+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x515bda+=_0x2fe3aa(0x24e);for(let _0x30b09f=0x0;_0x30b09f<=_0x44e2a1[_0x2fe3aa(0x261)]-0x1;_0x30b09f++){const _0x2bcdba=_0x44e2a1[_0x30b09f];for(let _0x5d0117=0x0;_0x5d0117<_0x54650e[_0x2fe3aa(0x1e0)]['length'];_0x5d0117++){const _0x3b3b73=_0x54650e[_0x2fe3aa(0x1e0)][_0x5d0117];_0x3b3b73['_id'][_0x2fe3aa(0x1df)]===_0x2bcdba[_0x2fe3aa(0x200)][_0x2fe3aa(0x1df)]&&(_0x515bda+='<td\x20class=\x22cat_data\x22>'+_0x3b3b73[_0x2fe3aa(0x200)][_0x2fe3aa(0x1f1)]+'</td>');}}_0x515bda+=_0x2fe3aa(0x205),_0x515bda+=_0x2fe3aa(0x2f0),_0x515bda+=_0x2fe3aa(0x314),_0x515bda+=_0x2fe3aa(0x1fc),_0x515bda+='</tr>',_0x515bda+=_0x2fe3aa(0x229),_0x515bda+=_0x2fe3aa(0x1e9),_0x28c243[_0x2fe3aa(0x2d8)](_0x376536=>{_0x515bda+=_0x376536;}),console[_0x2fe3aa(0x25d)](_0x8073ef),_0x515bda+=_0x2fe3aa(0x301),_0x515bda+='</table>';}),_0x515bda;}router[a0_0x5c3944(0x1ad)](a0_0x5c3944(0x26c),auth,async(_0x24c770,_0x209674)=>{const _0x261e6f=a0_0x5c3944,{from_date:_0x13bce0,to_date:_0xf3acdc,isExcel:_0x18fbec}=_0x24c770['body'],_0x4efb78=_0x24c770[_0x261e6f(0x2a8)],_0x150ec4=await staff[_0x261e6f(0x1c2)]({'email':_0x4efb78['email']}),_0x5a2937=await master_shop['find']();console[_0x261e6f(0x25d)](_0x5a2937[0x0][_0x261e6f(0x25e)]);const _0x34ae5a=await agentsdataDSICheck(_0x13bce0,_0xf3acdc,_0x150ec4[_0x261e6f(0x200)]['valueOf'](),_0x18fbec),_0x45bf92=await agentsdataDSICheck_excel(_0x13bce0,_0xf3acdc,_0x150ec4[_0x261e6f(0x200)][_0x261e6f(0x26b)](),_0x18fbec);let _0x3fc938=_0x261e6f(0x1a2);var _0x79e94b=new Date(_0x13bce0),_0x474c09=new Date(_0xf3acdc);const _0x4e8406={'year':'numeric','month':_0x261e6f(0x21e),'day':_0x261e6f(0x29e)},_0x3e9994=new Intl['DateTimeFormat']('en-US',_0x4e8406)['format'](_0x79e94b),_0x56c820=new Intl[(_0x261e6f(0x257))](_0x261e6f(0x1b0),_0x4e8406)[_0x261e6f(0x19b)](_0x474c09);_0x3fc938+=_0x261e6f(0x2e8),_0x3fc938+=_0x261e6f(0x27b),_0x3fc938+=_0x261e6f(0x276),_0x3fc938+=_0x34ae5a,_0x3fc938+='</table>',_0x3fc938+=_0x261e6f(0x2f2),_0x3fc938+=_0x261e6f(0x2f2);let _0x3892dd='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x3892dd+='<div\x20class=\x22row\x22>',_0x3892dd+=_0x261e6f(0x27b),_0x3892dd+=_0x261e6f(0x276),_0x3892dd+=_0x45bf92,_0x3892dd+=_0x261e6f(0x215),_0x3892dd+=_0x261e6f(0x2f2),_0x3892dd+='</div>';let _0x4f9433=_0x261e6f(0x29a);const _0x32a261={'width':'15in','height':_0x261e6f(0x28d),'orientation':'landscape','border':{'top':_0x261e6f(0x235),'right':_0x261e6f(0x235),'bottom':_0x261e6f(0x235),'left':_0x261e6f(0x235)},'header':{'height':_0x261e6f(0x2ab),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4f9433+_0x261e6f(0x30b)+_0x3e9994+_0x261e6f(0x2ee)+_0x56c820+_0x261e6f(0x274)},'footer':{'height':_0x261e6f(0x1fd),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x261e6f(0x23d)}}};if(_0x18fbec=='on'){const _0x1abfa2=cheerio[_0x261e6f(0x1c1)](_0x3892dd);let _0x4b8e18=[],_0x1759a8=[],_0x47bddd=[];const _0x40a80f=_0x187893=>{const _0x10f69a=_0x261e6f,_0x5b08f8={'top':{'style':'thick','color':{'rgb':_0x10f69a(0x1ec)}},'bottom':{'style':_0x10f69a(0x259),'color':{'rgb':_0x10f69a(0x1ec)}},'left':{'style':_0x10f69a(0x259),'color':{'rgb':_0x10f69a(0x1ec)}},'right':{'style':_0x10f69a(0x259),'color':{'rgb':_0x10f69a(0x1ec)}}};if(_0x187893){const _0x448981=_0x187893['split'](';')[_0x10f69a(0x272)]((_0x2de419,_0x5bc85f)=>{const _0x37573c=_0x10f69a,[_0x526096,_0x2e49a6]=_0x5bc85f['split'](':')[_0x37573c(0x22e)](_0x5040d8=>_0x5040d8[_0x37573c(0x31c)]());return _0x2de419[_0x526096]=_0x2e49a6,_0x2de419;},{});_0x448981[_0x10f69a(0x31a)]&&(_0x5b08f8[_0x10f69a(0x2df)][_0x10f69a(0x1b4)]=_0x448981[_0x10f69a(0x31a)][_0x10f69a(0x298)](_0x10f69a(0x2cf))?'thin':_0x10f69a(0x297)),_0x448981[_0x10f69a(0x2d2)]&&(_0x5b08f8[_0x10f69a(0x1e2)]['style']=_0x448981[_0x10f69a(0x2d2)][_0x10f69a(0x298)](_0x10f69a(0x2cf))?'thin':_0x10f69a(0x297)),_0x448981[_0x10f69a(0x1eb)]&&(_0x5b08f8[_0x10f69a(0x208)][_0x10f69a(0x1b4)]=_0x448981['border-left'][_0x10f69a(0x298)]('thin')?_0x10f69a(0x2cf):_0x10f69a(0x297)),_0x448981[_0x10f69a(0x1a9)]&&(_0x5b08f8['right'][_0x10f69a(0x1b4)]=_0x448981['border-right'][_0x10f69a(0x298)](_0x10f69a(0x2cf))?'thin':'medium');}return _0x5b08f8;};_0x1abfa2(_0x261e6f(0x1d3))[_0x261e6f(0x2e1)]((_0x517fc1,_0x353213)=>{const _0x4f5ec9=_0x261e6f;let _0xcc7a41=[],_0x17b53f=0x0;while(_0x47bddd[_0x17b53f]){_0x47bddd[_0x17b53f]--,_0x17b53f++;}_0x1abfa2(_0x353213)['find']('td,\x20th')[_0x4f5ec9(0x2e1)]((_0x259fcd,_0x347642)=>{const _0x345133=_0x4f5ec9;let _0x494d18=_0x1abfa2(_0x347642)[_0x345133(0x29d)]()[_0x345133(0x31c)](),_0x2e5c40=parseFloat(_0x494d18[_0x345133(0x1cf)](/,/g,'')),_0x16c0d7={};!isNaN(_0x2e5c40)?(_0x16c0d7['v']=_0x2e5c40,_0x16c0d7['t']='n'):(_0x16c0d7['v']=_0x494d18,_0x16c0d7['t']='s');const _0x415acf=_0x1abfa2(_0x347642)[_0x345133(0x21c)](_0x345133(0x1b4)),_0x3867ab=_0x40a80f(_0x415acf);_0x16c0d7['s']={'border':_0x3867ab},_0xcc7a41[_0x17b53f]=_0x16c0d7;let _0x5c0aa2=parseInt(_0x1abfa2(_0x347642)['attr'](_0x345133(0x19d)))||0x1,_0x583cab=parseInt(_0x1abfa2(_0x347642)[_0x345133(0x21c)]('rowspan'))||0x1;(_0x5c0aa2>0x1||_0x583cab>0x1)&&_0x1759a8[_0x345133(0x2d0)]({'s':{'r':_0x517fc1,'c':_0x17b53f},'e':{'r':_0x517fc1+_0x583cab-0x1,'c':_0x17b53f+_0x5c0aa2-0x1}});for(let _0x59f5da=0x0;_0x59f5da<_0x5c0aa2;_0x59f5da++){_0x583cab>0x1&&(_0x47bddd[_0x17b53f+_0x59f5da]=_0x583cab-0x1);}_0x17b53f+=_0x5c0aa2;}),_0x4b8e18[_0x4f5ec9(0x2d0)](_0xcc7a41);});const _0x30385e=XLSX['utils'][_0x261e6f(0x1d0)](),_0x27c278=XLSX[_0x261e6f(0x250)][_0x261e6f(0x21b)](_0x4b8e18);_0x1759a8[_0x261e6f(0x261)]>0x0&&(_0x27c278['!merges']=_0x1759a8);_0x27c278[_0x261e6f(0x2fb)]=_0x4b8e18[0x0][_0x261e6f(0x22e)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x30385e,_0x27c278,_0x261e6f(0x192));const _0xca5a52=XLSX[_0x261e6f(0x2da)](_0x30385e,{'bookType':_0x261e6f(0x268),'type':_0x261e6f(0x26a)});_0x209674[_0x261e6f(0x302)]('Content-Disposition',_0x261e6f(0x2f3)),_0x209674[_0x261e6f(0x302)]('Content-Type',_0x261e6f(0x22d)),_0x209674[_0x261e6f(0x2a7)](_0xca5a52);}else pdf[_0x261e6f(0x2c5)](_0x3fc938,_0x32a261)[_0x261e6f(0x253)](function(_0x17b4d1,_0x30c0e8){const _0x2bcd9c=_0x261e6f;if(_0x17b4d1){console[_0x2bcd9c(0x195)](_0x2bcd9c(0x264),_0x17b4d1),_0x209674['status'](0x1f4)[_0x2bcd9c(0x2a7)](_0x2bcd9c(0x21d)+_0x17b4d1);return;}_0x209674['setHeader'](_0x2bcd9c(0x226),'application/pdf'),_0x30c0e8[_0x2bcd9c(0x29b)](_0x209674);});}),router[a0_0x5c3944(0x295)]('/total_sales_reports/view',auth,async(_0x19f41c,_0x18ff8f)=>{const _0x553ace=a0_0x5c3944;try{const {username:_0x1d4c3e,email:_0x337f2f,role:_0x355760}=_0x19f41c[_0x553ace(0x2a8)],_0x55de2c=_0x19f41c[_0x553ace(0x2a8)],_0x170c83=await profile[_0x553ace(0x1c2)]({'email':_0x55de2c[_0x553ace(0x216)]}),_0x5db8e4={'year':_0x553ace(0x29e),'month':_0x553ace(0x21e),'day':'numeric'},_0x1dd131=await master_shop['find'](),_0x154c62=await product[_0x553ace(0x279)](),_0x3a0b29=await warehouse[_0x553ace(0x20b)]([{'$unwind':_0x553ace(0x292)},{'$lookup':{'from':_0x553ace(0x1b5),'localField':'product_details.product_name','foreignField':_0x553ace(0x273),'as':'product_docs'}},{'$unwind':_0x553ace(0x234)},{'$project':{'product_name':_0x553ace(0x2dc),'product_stock':_0x553ace(0x230)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]),_0x49e96f=await staff[_0x553ace(0x1c2)]({'email':_0x55de2c[_0x553ace(0x216)]});if(_0x1dd131[0x0][_0x553ace(0x1d7)]==_0x553ace(0x321))var _0x4e2928=users[_0x553ace(0x2b0)];else{if(_0x1dd131[0x0]['language']==_0x553ace(0x2d4))var _0x4e2928=users[_0x553ace(0x2d4)];else{if(_0x1dd131[0x0][_0x553ace(0x1d7)]==_0x553ace(0x30e))var _0x4e2928=users[_0x553ace(0x30e)];else{if(_0x1dd131[0x0][_0x553ace(0x1d7)]==_0x553ace(0x2b9))var _0x4e2928=users[_0x553ace(0x2b9)];else{if(_0x1dd131[0x0][_0x553ace(0x1d7)]==_0x553ace(0x2c2))var _0x4e2928=users[_0x553ace(0x2c2)];else{if(_0x1dd131[0x0]['language']==_0x553ace(0x1b9))var _0x4e2928=users['Portuguese'];else{if(_0x1dd131[0x0][_0x553ace(0x1d7)]==_0x553ace(0x1c8))var _0x4e2928=users['Chinese'];else{if(_0x1dd131[0x0][_0x553ace(0x1d7)]==_0x553ace(0x1ca))var _0x4e2928=users['Arabic'];}}}}}}}_0x18ff8f[_0x553ace(0x1bf)](_0x553ace(0x27c),{'success':_0x19f41c[_0x553ace(0x300)](_0x553ace(0x1fa)),'errors':_0x19f41c[_0x553ace(0x300)]('errors'),'alldata':_0x154c62,'profile':_0x170c83,'master_shop':_0x1dd131,'role':_0x55de2c,'product_stock':_0x3a0b29,'language':_0x4e2928,'staff_arr':_0x49e96f});}catch(_0x267571){}});async function dataSalesReports(_0x469551,_0x2670f2,_0x1fcb4e){const _0x4c721b=a0_0x5c3944;let _0x180c72='';const _0x208034=await sales_sa[_0x4c721b(0x20b)]([{'$match':{'date':{'$gte':_0x469551,'$lte':_0x2670f2},'sales_staff_id':_0x1fcb4e}},{'$unwind':_0x4c721b(0x308)},{'$match':{'sale_product.isFG':_0x4c721b(0x2ff)}},{'$group':{'_id':{'product_name':_0x4c721b(0x288),'product_code':_0x4c721b(0x201)},'sumqty':{'$sum':_0x4c721b(0x293)},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x1bebbf=0x0,_0x33d572=0x0;for(let _0x458de1=0x0;_0x458de1<=_0x208034[_0x4c721b(0x261)]-0x1;_0x458de1++){const _0x1312dd=_0x208034[_0x458de1];var _0x21c70f=_0x1312dd['totalPrice'][_0x4c721b(0x281)](undefined),_0x4c60dc=_0x1312dd[_0x4c721b(0x1c4)][_0x4c721b(0x281)](undefined);_0x180c72+='<tr>',_0x180c72+=_0x4c721b(0x2ef)+_0x1312dd['_id'][_0x4c721b(0x225)]+_0x4c721b(0x299),_0x180c72+=_0x4c721b(0x2ef)+_0x1312dd[_0x4c721b(0x200)][_0x4c721b(0x283)]+_0x4c721b(0x299),_0x180c72+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x1312dd['sumqty'][_0x4c721b(0x1de)](0x2))+_0x4c721b(0x299),_0x180c72+=_0x4c721b(0x2ef)+formatNumber(_0x1312dd[_0x4c721b(0x1ba)]['toFixed'](0x2))+_0x4c721b(0x299),_0x180c72+='</tr>',_0x1bebbf+=parseFloat(_0x1312dd[_0x4c721b(0x1c4)]),_0x33d572+=parseFloat(_0x1312dd['totalPrice']);}var _0x15e419=_0x33d572[_0x4c721b(0x281)](undefined),_0x414fd3=_0x1bebbf[_0x4c721b(0x281)](undefined);return _0x180c72+=_0x4c721b(0x287),_0x180c72+=_0x4c721b(0x2ad),_0x180c72+=_0x4c721b(0x25b)+formatNumber(_0x1bebbf[_0x4c721b(0x1de)](0x2))+_0x4c721b(0x2ed),_0x180c72+=_0x4c721b(0x25b)+formatNumber(_0x33d572[_0x4c721b(0x1de)](0x2))+_0x4c721b(0x2ed),_0x180c72+=_0x4c721b(0x266),_0x180c72;}router[a0_0x5c3944(0x1ad)]('/total_sales_reports/pdf',auth,async(_0x5147d1,_0x518998)=>{const _0x1d7cf9=a0_0x5c3944;try{const {from_date:_0x1aa8ee,to_date:_0x1de4f4,isExcel:_0x3e1d6b}=_0x5147d1['body'],_0x25570f=_0x5147d1['user'],_0x7e3dc8=await staff['findOne']({'email':_0x25570f['email']});let _0x18398f=_0x1d7cf9(0x22c);var _0x150530=new Date(_0x1aa8ee),_0xbe18de=new Date(_0x1de4f4);const _0x13fe39={'year':_0x1d7cf9(0x29e),'month':_0x1d7cf9(0x21e),'day':_0x1d7cf9(0x29e)},_0x3db86e=new Intl[(_0x1d7cf9(0x257))](_0x1d7cf9(0x1b0),_0x13fe39)[_0x1d7cf9(0x19b)](_0x150530),_0x326440=new Intl[(_0x1d7cf9(0x257))](_0x1d7cf9(0x1b0),_0x13fe39)['format'](_0xbe18de);var _0x3199a3=await dataSalesReports(_0x1aa8ee,_0x1de4f4,_0x7e3dc8[_0x1d7cf9(0x200)][_0x1d7cf9(0x26b)]());_0x18398f+=_0x1d7cf9(0x2e8),_0x18398f+=_0x1d7cf9(0x2f1),_0x18398f+=_0x1d7cf9(0x276),_0x18398f+='<tr>',_0x18398f+=_0x1d7cf9(0x1c9),_0x18398f+=_0x1d7cf9(0x19e),_0x18398f+='<th>\x20QTY\x20SOLD\x20</th>',_0x18398f+='<th>\x20INVOICE\x20AMOUNT\x20</th>',_0x18398f+=_0x1d7cf9(0x287),_0x18398f+=_0x3199a3,_0x18398f+=_0x1d7cf9(0x266),_0x18398f+=_0x1d7cf9(0x2f2),_0x18398f+=_0x1d7cf9(0x2f2);let _0x7bf005=_0x1d7cf9(0x29a);const _0xf2c8e4={'width':_0x1d7cf9(0x27e),'height':_0x1d7cf9(0x28d),'orientation':'landscape','border':{'top':'0.1in','right':_0x1d7cf9(0x235),'bottom':_0x1d7cf9(0x235),'left':_0x1d7cf9(0x235)},'header':{'height':_0x1d7cf9(0x2ab),'contents':_0x1d7cf9(0x1af)+_0x7bf005+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x7e3dc8[_0x1d7cf9(0x273)]+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x3db86e+_0x1d7cf9(0x2ee)+_0x326440+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x1d7cf9(0x1fd),'contents':{'default':_0x1d7cf9(0x2fc)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x3e1d6b=='on'){const _0x4c8bca=cheerio[_0x1d7cf9(0x1c1)](_0x18398f);let _0x2dfea9=[],_0x50fcd0=[],_0x232e42=[];const _0xeae590=_0x302892=>{const _0x4399fb=_0x1d7cf9,_0x2d3483={'top':{'style':'thick','color':{'rgb':_0x4399fb(0x1ec)}},'bottom':{'style':_0x4399fb(0x259),'color':{'rgb':_0x4399fb(0x1ec)}},'left':{'style':_0x4399fb(0x259),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x302892){const _0x7a6e3f=_0x302892[_0x4399fb(0x2bb)](';')[_0x4399fb(0x272)]((_0x398969,_0x54cf73)=>{const _0xf1dcb3=_0x4399fb,[_0x37c080,_0x48d6da]=_0x54cf73['split'](':')[_0xf1dcb3(0x22e)](_0x2d53c5=>_0x2d53c5['trim']());return _0x398969[_0x37c080]=_0x48d6da,_0x398969;},{});_0x7a6e3f[_0x4399fb(0x31a)]&&(_0x2d3483['top'][_0x4399fb(0x1b4)]=_0x7a6e3f['border-top']['includes'](_0x4399fb(0x2cf))?_0x4399fb(0x2cf):'medium'),_0x7a6e3f[_0x4399fb(0x2d2)]&&(_0x2d3483[_0x4399fb(0x1e2)][_0x4399fb(0x1b4)]=_0x7a6e3f['border-bottom'][_0x4399fb(0x298)](_0x4399fb(0x2cf))?_0x4399fb(0x2cf):_0x4399fb(0x297)),_0x7a6e3f['border-left']&&(_0x2d3483[_0x4399fb(0x208)]['style']=_0x7a6e3f['border-left'][_0x4399fb(0x298)]('thin')?_0x4399fb(0x2cf):_0x4399fb(0x297)),_0x7a6e3f[_0x4399fb(0x1a9)]&&(_0x2d3483[_0x4399fb(0x320)][_0x4399fb(0x1b4)]=_0x7a6e3f[_0x4399fb(0x1a9)][_0x4399fb(0x298)](_0x4399fb(0x2cf))?'thin':_0x4399fb(0x297));}return _0x2d3483;};_0x4c8bca(_0x1d7cf9(0x1d3))[_0x1d7cf9(0x2e1)]((_0x40c362,_0x49b9bc)=>{const _0xabd2e6=_0x1d7cf9;let _0x4970f8=[],_0x4ac917=0x0;while(_0x232e42[_0x4ac917]){_0x232e42[_0x4ac917]--,_0x4ac917++;}_0x4c8bca(_0x49b9bc)['find'](_0xabd2e6(0x2fd))['each']((_0x5441d2,_0x1ead12)=>{const _0x2ab773=_0xabd2e6;let _0x2f71e9=_0x4c8bca(_0x1ead12)[_0x2ab773(0x29d)]()['trim'](),_0x5d6760=parseFloat(_0x2f71e9[_0x2ab773(0x1cf)](/,/g,'')),_0x5eb819={};!isNaN(_0x5d6760)?(_0x5eb819['v']=_0x5d6760,_0x5eb819['t']='n'):(_0x5eb819['v']=_0x2f71e9,_0x5eb819['t']='s');const _0x3cf120=_0x4c8bca(_0x1ead12)[_0x2ab773(0x21c)](_0x2ab773(0x1b4)),_0x9ebbe7=_0xeae590(_0x3cf120);_0x5eb819['s']={'border':_0x9ebbe7},_0x4970f8[_0x4ac917]=_0x5eb819;let _0xbe8d3f=parseInt(_0x4c8bca(_0x1ead12)[_0x2ab773(0x21c)](_0x2ab773(0x19d)))||0x1,_0x1e6413=parseInt(_0x4c8bca(_0x1ead12)[_0x2ab773(0x21c)]('rowspan'))||0x1;(_0xbe8d3f>0x1||_0x1e6413>0x1)&&_0x50fcd0['push']({'s':{'r':_0x40c362,'c':_0x4ac917},'e':{'r':_0x40c362+_0x1e6413-0x1,'c':_0x4ac917+_0xbe8d3f-0x1}});for(let _0x13ef30=0x0;_0x13ef30<_0xbe8d3f;_0x13ef30++){_0x1e6413>0x1&&(_0x232e42[_0x4ac917+_0x13ef30]=_0x1e6413-0x1);}_0x4ac917+=_0xbe8d3f;}),_0x2dfea9[_0xabd2e6(0x2d0)](_0x4970f8);});const _0x343100=XLSX[_0x1d7cf9(0x250)][_0x1d7cf9(0x1d0)](),_0x53f506=XLSX[_0x1d7cf9(0x250)][_0x1d7cf9(0x21b)](_0x2dfea9);_0x50fcd0['length']>0x0&&(_0x53f506[_0x1d7cf9(0x269)]=_0x50fcd0);_0x53f506[_0x1d7cf9(0x2fb)]=_0x2dfea9[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x1d7cf9(0x250)][_0x1d7cf9(0x2b1)](_0x343100,_0x53f506,'Sales\x20Report');const _0x12c5c3=XLSX['write'](_0x343100,{'bookType':_0x1d7cf9(0x268),'type':_0x1d7cf9(0x26a)});_0x518998['setHeader'](_0x1d7cf9(0x231),_0x1d7cf9(0x2f3)),_0x518998[_0x1d7cf9(0x302)]('Content-Type',_0x1d7cf9(0x22d)),_0x518998[_0x1d7cf9(0x2a7)](_0x12c5c3);}else pdf[_0x1d7cf9(0x2c5)](_0x18398f,_0xf2c8e4)[_0x1d7cf9(0x253)](function(_0x5bb28b,_0x20d96e){const _0x4f6295=_0x1d7cf9;if(_0x5bb28b){_0x518998[_0x4f6295(0x1e7)](0x1f4)[_0x4f6295(0x2a7)]('Error\x20generating\x20PDF');return;}_0x518998[_0x4f6295(0x302)](_0x4f6295(0x226),'application/pdf'),_0x20d96e[_0x4f6295(0x29b)](_0x518998);});}catch(_0x573c80){}}),router[a0_0x5c3944(0x295)](a0_0x5c3944(0x256),auth,async(_0x14d46f,_0x183e2e)=>{const _0x40de0d=a0_0x5c3944;try{const {username:_0x214250,email:_0x3394b8,role:_0x29c3cf}=_0x14d46f[_0x40de0d(0x2a8)],_0x51b6ab=_0x14d46f['user'],_0x2bd6ba=await profile[_0x40de0d(0x1c2)]({'email':_0x51b6ab['email']}),_0x5a0594={'year':_0x40de0d(0x29e),'month':_0x40de0d(0x21e),'day':'numeric'},_0x37238c=await master_shop[_0x40de0d(0x279)](),_0x1c4d76=await product['find'](),_0x1023a9=await warehouse[_0x40de0d(0x20b)]([{'$unwind':_0x40de0d(0x292)},{'$lookup':{'from':'products','localField':_0x40de0d(0x296),'foreignField':_0x40de0d(0x273),'as':_0x40de0d(0x209)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x40de0d(0x2dc),'product_stock':_0x40de0d(0x230)}},{'$group':{'_id':_0x40de0d(0x1f7),'product_stock':{'$sum':_0x40de0d(0x31e)}}}]);if(_0x37238c[0x0][_0x40de0d(0x1d7)]==_0x40de0d(0x321))var _0x67e18d=users[_0x40de0d(0x2b0)];else{if(_0x37238c[0x0][_0x40de0d(0x1d7)]==_0x40de0d(0x2d4))var _0x67e18d=users['Hindi'];else{if(_0x37238c[0x0][_0x40de0d(0x1d7)]=='German')var _0x67e18d=users['German'];else{if(_0x37238c[0x0][_0x40de0d(0x1d7)]==_0x40de0d(0x2b9))var _0x67e18d=users['Spanish'];else{if(_0x37238c[0x0]['language']=='French')var _0x67e18d=users[_0x40de0d(0x2c2)];else{if(_0x37238c[0x0]['language']==_0x40de0d(0x1b9))var _0x67e18d=users[_0x40de0d(0x1cd)];else{if(_0x37238c[0x0][_0x40de0d(0x1d7)]==_0x40de0d(0x1c8))var _0x67e18d=users[_0x40de0d(0x1c8)];else{if(_0x37238c[0x0]['language']==_0x40de0d(0x1ca))var _0x67e18d=users[_0x40de0d(0x2a4)];}}}}}}}_0x183e2e['render']('inventory_sum',{'success':_0x14d46f[_0x40de0d(0x300)](_0x40de0d(0x1fa)),'errors':_0x14d46f[_0x40de0d(0x300)]('errors'),'alldata':_0x1c4d76,'profile':_0x2bd6ba,'master_shop':_0x37238c,'role':_0x51b6ab,'product_stock':_0x1023a9,'language':_0x67e18d});}catch(_0x44c1ac){}});async function dataInventoryReports(_0x16f101,_0x34daaf,_0x393160){const _0x43d1b4=a0_0x5c3944,_0xd9431c=await sales_sa[_0x43d1b4(0x20b)]([{'$match':{'date':{'$gte':_0x16f101,'$lte':_0x34daaf},'sales_staff_id':_0x393160}},{'$unwind':_0x43d1b4(0x308)},{'$group':{'_id':{'product_name':_0x43d1b4(0x288),'product_code':_0x43d1b4(0x201)},'sumqty':{'$sum':_0x43d1b4(0x31b)}}},{'$sort':{'_id.product_name':0x1}}]),_0xc9fd68=mongoose[_0x43d1b4(0x2b8)][_0x43d1b4(0x2ba)],_0x268ffe=await staff[_0x43d1b4(0x20b)]([{'$match':{'_id':_0xc9fd68(_0x393160)}},{'$unwind':_0x43d1b4(0x2c0)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x43d1b4(0x2cd),'product_code':_0x43d1b4(0x2e5)},'sumqty':{'$sum':_0x43d1b4(0x249)}}},{'$sort':{'_id.product_name':0x1}}]),_0x564c8a=await sales_inv_data[_0x43d1b4(0x20b)]([{'$match':{'date':{'$gte':_0x16f101,'$lte':_0x34daaf},'sales_staff_id':_0x393160}},{'$unwind':_0x43d1b4(0x308)},{'$group':{'_id':{'product_name':_0x43d1b4(0x288),'product_code':_0x43d1b4(0x201)},'totalQTYsum':{'$sum':_0x43d1b4(0x2d6)}}}]);console[_0x43d1b4(0x25d)](_0x564c8a);let _0x198692='';var _0x388645=0x0;for(let _0xbd36a4=0x0;_0xbd36a4<=_0x268ffe[_0x43d1b4(0x261)]-0x1;_0xbd36a4++){const _0x56e0c8=_0x268ffe[_0xbd36a4];_0x198692+=_0x43d1b4(0x287),_0x198692+=_0x43d1b4(0x280)+_0x56e0c8[_0x43d1b4(0x200)]['product_code']+_0x43d1b4(0x299),_0x198692+=_0x43d1b4(0x241)+_0x56e0c8[_0x43d1b4(0x200)][_0x43d1b4(0x283)]+_0x43d1b4(0x299);var _0x11c119=_0x56e0c8['sumqty'],_0x20ec6c=0x0;for(let _0x6aff83=0x0;_0x6aff83<=_0xd9431c[_0x43d1b4(0x261)]-0x1;_0x6aff83++){const _0x1bd975=_0xd9431c[_0x6aff83];_0x56e0c8[_0x43d1b4(0x200)]['product_code']==_0x1bd975['_id'][_0x43d1b4(0x225)]&&_0x56e0c8['_id'][_0x43d1b4(0x283)]==_0x1bd975['_id']['product_name']&&(_0x20ec6c=_0x1bd975['sumqty']);}var _0x4e683e=0x0;for(let _0x15d132=0x0;_0x15d132<=_0x564c8a[_0x43d1b4(0x261)]-0x1;_0x15d132++){const _0x3054d3=_0x564c8a[_0x15d132];_0x56e0c8['_id'][_0x43d1b4(0x225)]==_0x3054d3[_0x43d1b4(0x200)]['product_code']&&_0x56e0c8[_0x43d1b4(0x200)][_0x43d1b4(0x283)]==_0x3054d3[_0x43d1b4(0x200)][_0x43d1b4(0x283)]&&(_0x4e683e=_0x3054d3[_0x43d1b4(0x2a6)]);}_0x388645=_0x11c119-_0x4e683e+_0x20ec6c,_0x198692+=_0x43d1b4(0x2ef)+_0x388645+_0x43d1b4(0x299);let _0x2f8751=![];for(let _0x47a988=0x0;_0x47a988<=_0x564c8a[_0x43d1b4(0x261)]-0x1;_0x47a988++){const _0x449837=_0x564c8a[_0x47a988];if(_0x56e0c8[_0x43d1b4(0x200)][_0x43d1b4(0x225)]==_0x449837[_0x43d1b4(0x200)][_0x43d1b4(0x225)]&&_0x56e0c8[_0x43d1b4(0x200)][_0x43d1b4(0x283)]==_0x449837[_0x43d1b4(0x200)][_0x43d1b4(0x283)]){_0x198692+=_0x43d1b4(0x2ef)+_0x449837[_0x43d1b4(0x2a6)]+_0x43d1b4(0x299),_0x2f8751=!![];break;}}!_0x2f8751&&(_0x198692+=_0x43d1b4(0x1c7));let _0x31bb9d=![];for(let _0x2c1c7e=0x0;_0x2c1c7e<=_0xd9431c['length']-0x1;_0x2c1c7e++){const _0x4ba0ef=_0xd9431c[_0x2c1c7e];if(_0x56e0c8[_0x43d1b4(0x200)][_0x43d1b4(0x225)]==_0x4ba0ef['_id'][_0x43d1b4(0x225)]&&_0x56e0c8[_0x43d1b4(0x200)][_0x43d1b4(0x283)]==_0x4ba0ef[_0x43d1b4(0x200)][_0x43d1b4(0x283)]){_0x198692+='<td\x20class=\x22row_data\x22>'+_0x4ba0ef['sumqty']+'</td>',_0x31bb9d=!![];break;}}!_0x31bb9d&&(_0x198692+=_0x43d1b4(0x1c7)),_0x198692+='<td\x20class=\x22row_data\x22>'+_0x56e0c8[_0x43d1b4(0x1c4)]+_0x43d1b4(0x299),_0x198692+='</tr>';}return _0x198692;}router[a0_0x5c3944(0x1ad)]('/inventory_sum/pdf',auth,async(_0x5431de,_0x5dbe15)=>{const _0x5d4eec=a0_0x5c3944;try{const {from_date:_0x23ed43,to_date:_0x48a940}=_0x5431de[_0x5d4eec(0x22f)],_0x4420bd=_0x5431de[_0x5d4eec(0x2a8)],_0x2ff9a6=await staff['findOne']({'email':_0x4420bd['email']});let _0x4bb8ef='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x5319ed=new Date(_0x23ed43),_0x3bbf06=new Date(_0x48a940);const _0x2a27a6={'year':'numeric','month':_0x5d4eec(0x21e),'day':_0x5d4eec(0x29e)},_0x117ae0=new Intl['DateTimeFormat'](_0x5d4eec(0x1b0),_0x2a27a6)[_0x5d4eec(0x19b)](_0x5319ed),_0x226319=new Intl[(_0x5d4eec(0x257))](_0x5d4eec(0x1b0),_0x2a27a6)[_0x5d4eec(0x19b)](_0x3bbf06);var _0x32d938=await dataInventoryReports(_0x23ed43,_0x48a940,_0x2ff9a6[_0x5d4eec(0x200)][_0x5d4eec(0x26b)]());_0x4bb8ef+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x4bb8ef+=_0x5d4eec(0x2ac),_0x4bb8ef+='<p>'+_0x117ae0+_0x5d4eec(0x2ee)+_0x226319+_0x5d4eec(0x25f),_0x4bb8ef+=_0x5d4eec(0x2e8),_0x4bb8ef+=_0x5d4eec(0x2f1),_0x4bb8ef+=_0x5d4eec(0x276),_0x4bb8ef+='<tr>',_0x4bb8ef+=_0x5d4eec(0x1c9),_0x4bb8ef+=_0x5d4eec(0x19e),_0x4bb8ef+='<th>\x20BEG\x20BALANCE\x20</th>',_0x4bb8ef+=_0x5d4eec(0x311),_0x4bb8ef+=_0x5d4eec(0x1fe),_0x4bb8ef+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x4bb8ef+=_0x5d4eec(0x287),_0x4bb8ef+=_0x32d938,_0x4bb8ef+='</tr>',_0x4bb8ef+=_0x5d4eec(0x2f2),_0x4bb8ef+='</div>';const _0x2fa744={'format':_0x5d4eec(0x2a0),'orientation':_0x5d4eec(0x237),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x5d4eec(0x23d)}}};pdf['create'](_0x4bb8ef,_0x2fa744)[_0x5d4eec(0x253)](function(_0x30e05f,_0x206cb8){const _0x82e955=_0x5d4eec;if(_0x30e05f){_0x5dbe15[_0x82e955(0x1e7)](0x1f4)[_0x82e955(0x2a7)](_0x82e955(0x21d));return;}_0x5dbe15[_0x82e955(0x302)](_0x82e955(0x226),_0x82e955(0x1a5)),_0x206cb8[_0x82e955(0x29b)](_0x5dbe15);});}catch(_0x12856c){}}),router[a0_0x5c3944(0x295)](a0_0x5c3944(0x316),auth,async(_0x55be77,_0x739783)=>{const _0x3e7173=a0_0x5c3944;try{const {username:_0x23e879,email:_0x57193f,role:_0x16ac94}=_0x55be77[_0x3e7173(0x2a8)],_0x17bea8=_0x55be77[_0x3e7173(0x2a8)],_0x2dfc8e=await profile['findOne']({'email':_0x17bea8[_0x3e7173(0x216)]}),_0x126545={'year':_0x3e7173(0x29e),'month':'long','day':'numeric'},_0x58da4e=await master_shop[_0x3e7173(0x279)]();console[_0x3e7173(0x25d)](_0x3e7173(0x290),_0x58da4e);const _0x58b279=await product[_0x3e7173(0x279)]();console[_0x3e7173(0x25d)](_0x3e7173(0x2db),_0x58b279);const _0x3b2148=await warehouse[_0x3e7173(0x20b)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x3e7173(0x1b5),'localField':'product_details.product_name','foreignField':_0x3e7173(0x273),'as':_0x3e7173(0x209)}},{'$unwind':_0x3e7173(0x234)},{'$project':{'product_name':_0x3e7173(0x2dc),'product_stock':_0x3e7173(0x230)}},{'$group':{'_id':_0x3e7173(0x1f7),'product_stock':{'$sum':_0x3e7173(0x31e)}}}]);console[_0x3e7173(0x25d)]('Products\x20warehouse_data',_0x3b2148),_0x3b2148['forEach'](_0x454f2e=>{const _0x54312f=_0x3e7173,_0x5e2a2c=_0x58b279[_0x54312f(0x22e)](_0x3bc9c6=>{const _0x263e9e=_0x54312f;_0x3bc9c6[_0x263e9e(0x273)]==_0x454f2e['_id']&&(_0x3bc9c6[_0x263e9e(0x2dd)]=parseInt(_0x3bc9c6[_0x263e9e(0x2dd)])+parseInt(_0x454f2e['product_stock']));});});const _0x101305=await staff['findOne']({'email':_0x17bea8[_0x3e7173(0x216)]});if(_0x58da4e[0x0]['language']==_0x3e7173(0x321))var _0x48ee96=users[_0x3e7173(0x2b0)];else{if(_0x58da4e[0x0][_0x3e7173(0x1d7)]==_0x3e7173(0x2d4))var _0x48ee96=users[_0x3e7173(0x2d4)];else{if(_0x58da4e[0x0]['language']=='German')var _0x48ee96=users[_0x3e7173(0x30e)];else{if(_0x58da4e[0x0]['language']=='Spanish')var _0x48ee96=users[_0x3e7173(0x2b9)];else{if(_0x58da4e[0x0][_0x3e7173(0x1d7)]==_0x3e7173(0x2c2))var _0x48ee96=users['French'];else{if(_0x58da4e[0x0][_0x3e7173(0x1d7)]=='Portuguese\x20(BR)')var _0x48ee96=users['Portuguese'];else{if(_0x58da4e[0x0]['language']==_0x3e7173(0x1c8))var _0x48ee96=users[_0x3e7173(0x1c8)];else{if(_0x58da4e[0x0][_0x3e7173(0x1d7)]=='Arabic\x20(ae)')var _0x48ee96=users[_0x3e7173(0x2a4)];}}}}}}}_0x739783[_0x3e7173(0x1bf)]('dssr_view',{'success':_0x55be77[_0x3e7173(0x300)](_0x3e7173(0x1fa)),'errors':_0x55be77[_0x3e7173(0x300)](_0x3e7173(0x217)),'alldata':_0x58b279,'profile':_0x2dfc8e,'master_shop':_0x58da4e,'role':_0x17bea8,'product_stock':_0x3b2148,'language':_0x48ee96,'staff_arr':_0x101305});}catch(_0x406894){}});async function agentsdataDSICheck_DSRR(_0x16a43e,_0x121db8,_0x5a0fdd,_0x93834a){const _0x1e5b88=a0_0x5c3944;let _0x553540=new Date(_0x16a43e);_0x553540[_0x1e5b88(0x2d1)](_0x553540['getDate']()-0x1);let _0x21d518=_0x553540[_0x1e5b88(0x305)]()[_0x1e5b88(0x2bb)]('T')[0x0];const _0x4ae8f9=await product[_0x1e5b88(0x20b)]([{'$group':{'_id':{'brand':_0x1e5b88(0x243),'category':_0x1e5b88(0x2c9)},'products':{'$push':{'name':'$name','product_code':_0x1e5b88(0x1d9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x17b8eb=[];_0x17b8eb[_0x1e5b88(0x1e0)]=[];for(let _0xe16d7a=0x0;_0xe16d7a<=_0x4ae8f9['length']-0x1;_0xe16d7a++){const _0x5acb69=_0x4ae8f9[_0xe16d7a];_0x17b8eb[_0x1e5b88(0x1e0)][_0x1e5b88(0x2d0)](_0x5acb69);}const _0x3ade1b=await product[_0x1e5b88(0x20b)]([{'$group':{'_id':{'category':_0x1e5b88(0x2c9)},'products':{'$push':{'brand':_0x1e5b88(0x243),'product_code':_0x1e5b88(0x1d9),'product_name':_0x1e5b88(0x306)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5eae24=await product[_0x1e5b88(0x20b)]([{'$group':{'_id':{'category':_0x1e5b88(0x2c9),'brand':_0x1e5b88(0x243)}}},{'$group':{'_id':_0x1e5b88(0x23e),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1d3f44=await sales_sa[_0x1e5b88(0x20b)]([{'$match':{'date':_0x16a43e,'sales_staff_id':_0x121db8,'sale_product.isFG':_0x1e5b88(0x2ff)}},{'$unwind':_0x1e5b88(0x308)},{'$lookup':{'from':'products','localField':_0x1e5b88(0x2fa),'foreignField':'product_code','as':_0x1e5b88(0x239)}},{'$unwind':_0x1e5b88(0x24d)},{'$group':{'_id':{'dsi':_0x1e5b88(0x30f),'date':_0x1e5b88(0x1d2),'customer':'$customer','status_data':_0x1e5b88(0x23a)},'totalQty':{'$sum':_0x1e5b88(0x293)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':'$bank'},'check_no':{'$first':_0x1e5b88(0x1e5)},'due_date':{'$first':_0x1e5b88(0x1e6)},'products':{'$push':{'qty':_0x1e5b88(0x293),'NetPrice':_0x1e5b88(0x30d),'discount':'$sale_product.discount','adj_discount':_0x1e5b88(0x24a),'product_details':{'prod_name':_0x1e5b88(0x277),'product_code':_0x1e5b88(0x1a8),'category':_0x1e5b88(0x2c8),'brand':_0x1e5b88(0x222),'gross_price':_0x1e5b88(0x310),'isFG':_0x1e5b88(0x2e9),'prod_cat':_0x1e5b88(0x23f),'prod_id':_0x1e5b88(0x260)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x1e5b88(0x1aa),'date':_0x1e5b88(0x319),'customer':'$_id.customer','status_data':'$_id.status_data','category':_0x1e5b88(0x285),'brand':'$products.product_details.brand','prod_id':_0x1e5b88(0x1d4)},'totalQty':{'$sum':_0x1e5b88(0x20c)},'totalGross':{'$sum':{'$multiply':[_0x1e5b88(0x20c),_0x1e5b88(0x1d6)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x1e5b88(0x1c5)},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':'$cash'},'amount':{'$first':_0x1e5b88(0x1a7)},'bank':{'$first':_0x1e5b88(0x1bb)},'check_no':{'$first':_0x1e5b88(0x1e5)},'due_date':{'$first':_0x1e5b88(0x1e6)},'product_details':{'$first':_0x1e5b88(0x2c1)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1e5b88(0x319),'customer':_0x1e5b88(0x1c0),'status_data':'$_id.status_data'},'totalQty':{'$sum':_0x1e5b88(0x199)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x1e5b88(0x2cb)},'discount':{'$sum':_0x1e5b88(0x1ef)},'adj_discount':{'$sum':'$adj_discount'},'cash':{'$first':_0x1e5b88(0x22b)},'amount':{'$first':_0x1e5b88(0x1a7)},'bank':{'$first':_0x1e5b88(0x1bb)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x1e5b88(0x1b8),'product_details':_0x1e5b88(0x292)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x58024e=await sales_sa[_0x1e5b88(0x20b)]([{'$match':{'date':_0x21d518,'sales_staff_id':_0x121db8,'sale_product.isFG':_0x1e5b88(0x2ff)}},{'$unwind':_0x1e5b88(0x308)},{'$lookup':{'from':_0x1e5b88(0x1b5),'localField':_0x1e5b88(0x2fa),'foreignField':_0x1e5b88(0x225),'as':'product_info'}},{'$unwind':_0x1e5b88(0x24d)},{'$group':{'_id':{'dsi':_0x1e5b88(0x30f),'date':_0x1e5b88(0x1d2),'customer':'$customer'},'totalQty':{'$sum':_0x1e5b88(0x293)},'cash':{'$first':_0x1e5b88(0x22b)},'amount':{'$first':_0x1e5b88(0x1a7)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x1e5b88(0x1e5)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x1e5b88(0x30d),'discount':_0x1e5b88(0x1ed),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x1e5b88(0x277),'product_code':_0x1e5b88(0x1a8),'category':_0x1e5b88(0x2c8),'brand':_0x1e5b88(0x222),'gross_price':_0x1e5b88(0x310),'isFG':_0x1e5b88(0x2e9),'prod_cat':'$sale_product.prod_cat','prod_id':_0x1e5b88(0x260)}}}}},{'$unwind':_0x1e5b88(0x1da)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1e5b88(0x319),'customer':_0x1e5b88(0x1c0),'category':_0x1e5b88(0x285),'brand':_0x1e5b88(0x278),'prod_id':_0x1e5b88(0x1d4)},'totalQty':{'$sum':_0x1e5b88(0x20c)},'cash':{'$first':_0x1e5b88(0x22b)},'amount':{'$first':'$amount'},'bank':{'$first':'$bank'},'check_no':{'$first':_0x1e5b88(0x1e5)},'due_date':{'$first':_0x1e5b88(0x1e6)},'totalGross':{'$sum':{'$multiply':[_0x1e5b88(0x20c),_0x1e5b88(0x1d6)]}},'NetPrice':{'$sum':_0x1e5b88(0x1d5)},'discount':{'$sum':_0x1e5b88(0x1c5)},'adj_discount':{'$sum':_0x1e5b88(0x24b)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x1e5b88(0x1aa),'date':'$_id.date','customer':_0x1e5b88(0x1c0)},'totalQty':{'$sum':_0x1e5b88(0x199)},'cash':{'$first':_0x1e5b88(0x22b)},'amount':{'$first':_0x1e5b88(0x1a7)},'bank':{'$first':_0x1e5b88(0x1bb)},'check_no':{'$first':_0x1e5b88(0x1e5)},'due_date':{'$first':_0x1e5b88(0x1e6)},'totalGross':{'$sum':_0x1e5b88(0x2eb)},'NetPrice':{'$sum':_0x1e5b88(0x2cb)},'discount':{'$sum':_0x1e5b88(0x1ef)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x1e5b88(0x199),'category':_0x1e5b88(0x23e),'brand':_0x1e5b88(0x1b8),'product_details':_0x1e5b88(0x292)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x2aceff=await sales_sa[_0x1e5b88(0x20b)]([{'$match':{'date':_0x16a43e,'sales_staff_id':_0x121db8,'status_data':_0x1e5b88(0x1ac)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x514bdf=await staff['findById'](_0x121db8);let _0x4fb072=[],_0x1ce832={},_0x1768ec={};var _0x184ca9=0x0,_0x550140=0x0,_0x48bcb4=0x0,_0x27967a=0x0,_0x5040da=0x0;const _0x3ad899=0x6;var _0x18d54a=0x0,_0x1e07ae=0x0;for(let _0x514810=0x0;_0x514810<=_0x1d3f44[_0x1e5b88(0x261)]-0x1;_0x514810++){const _0x194921=_0x1d3f44[_0x514810];let _0x1b3985=_0x1e5b88(0x287);_0x1b3985+=_0x1e5b88(0x20f),_0x1b3985+=_0x1e5b88(0x211)+_0x194921['_id'][_0x1e5b88(0x270)]+_0x1e5b88(0x299),_0x1b3985+=_0x1e5b88(0x211)+_0x194921['_id']['dsi']+'</td>';let _0x4c5c46={},_0x143d35={},_0x424064={};var _0x627eb={},_0x15bb67={},_0x1a4d86={},_0x4c2c44=0x0;for(let _0x4e15e0=0x0;_0x4e15e0<=_0x194921['products'][_0x1e5b88(0x261)]-0x1;_0x4e15e0++){const _0x767a93=_0x194921[_0x1e5b88(0x1b5)][_0x4e15e0];_0x4c5c46[_0x767a93[_0x1e5b88(0x1f1)]+'-'+_0x767a93['category']]=_0x767a93[_0x1e5b88(0x203)],_0x143d35[[_0x767a93[_0x1e5b88(0x1f1)]+'-'+_0x767a93[_0x1e5b88(0x1df)]]]=_0x767a93['product_details']['isFG'],_0x424064[[_0x767a93['brand']+'-'+_0x767a93['category']]]=_0x767a93[_0x1e5b88(0x1a0)][_0x1e5b88(0x263)];const _0x2cdeaa=_0x767a93[_0x1e5b88(0x1f1)]+'-'+_0x767a93['category'];!Array[_0x1e5b88(0x2af)](_0x1768ec[_0x2cdeaa])&&(_0x1768ec[_0x2cdeaa]=[]);!Array['isArray'](_0x1768ec[_0x2cdeaa])&&(_0x1768ec[_0x2cdeaa]=[]);_0x1768ec[_0x2cdeaa][_0x1e5b88(0x2d0)](_0x767a93[_0x1e5b88(0x203)]);if(_0x767a93['product_details'][_0x1e5b88(0x263)]=='P')_0x767a93[_0x1e5b88(0x1a0)][_0x1e5b88(0x318)]==_0x1e5b88(0x1ac)?(!_0x1a4d86[_0x2cdeaa]&&(_0x1a4d86[_0x2cdeaa]=0x0),_0x1a4d86[_0x2cdeaa]=_0x767a93[_0x1e5b88(0x203)]):(!_0x627eb[_0x2cdeaa]&&(_0x627eb[_0x2cdeaa]=0x0),_0x627eb[_0x2cdeaa]=_0x767a93[_0x1e5b88(0x203)]);else _0x767a93['product_details']['prod_cat']=='S'&&(_0x767a93[_0x1e5b88(0x1a0)][_0x1e5b88(0x318)]==_0x1e5b88(0x1ac)?(!_0x1a4d86[_0x2cdeaa]&&(_0x1a4d86[_0x2cdeaa]=0x0),_0x1a4d86[_0x2cdeaa]=_0x767a93[_0x1e5b88(0x203)]):(!_0x15bb67[_0x2cdeaa]&&(_0x15bb67[_0x2cdeaa]=0x0),_0x15bb67[_0x2cdeaa]=_0x767a93['qty']));_0x4c2c44++;}for(let _0x10e4f8=0x0;_0x10e4f8<=_0x17b8eb[_0x1e5b88(0x1e0)]['length']-0x1;_0x10e4f8++){const _0x1e1b4d=_0x17b8eb[_0x1e5b88(0x1e0)][_0x10e4f8],_0x5f11a4=_0x1e1b4d[_0x1e5b88(0x200)]['brand']+'-'+_0x1e1b4d[_0x1e5b88(0x200)][_0x1e5b88(0x1df)],_0xb52545=_0x424064[_0x5f11a4]!==undefined?_0x424064[_0x5f11a4]:'NA';var _0x2c1bbc=_0x627eb[_0x5f11a4]!==undefined?_0x627eb[_0x5f11a4][_0x1e5b88(0x1de)](0x2):'',_0x5d60a4=_0x15bb67[_0x5f11a4]!==undefined?_0x15bb67[_0x5f11a4]['toFixed'](0x2):'',_0x2af525=_0x1a4d86[_0x5f11a4]!==undefined?_0x1a4d86[_0x5f11a4][_0x1e5b88(0x1de)](0x2):'';_0x1b3985+=_0x1e5b88(0x1fb)+_0x2c1bbc+_0x1e5b88(0x299),_0x1b3985+=_0x1e5b88(0x1fb)+_0x5d60a4+_0x1e5b88(0x299),_0x1b3985+=_0x1e5b88(0x1fb)+_0x2af525+'</td>';}var _0x181685=formatNumber(parseFloat(_0x194921[_0x1e5b88(0x2e2)])),_0x497eaa=formatNumber(parseFloat(_0x194921[_0x1e5b88(0x24f)]));isNaN(_0x497eaa)&&(_0x497eaa=0x0),_0x1b3985+=_0x1e5b88(0x1fb)+_0x181685+_0x1e5b88(0x299),_0x1b3985+=_0x1e5b88(0x1fb)+_0x497eaa+_0x1e5b88(0x299),_0x1b3985+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x194921[_0x1e5b88(0x31f)]+_0x1e5b88(0x299),_0x1b3985+=_0x1e5b88(0x211)+_0x194921[_0x1e5b88(0x255)]+'</td>',_0x1b3985+=_0x1e5b88(0x211)+_0x194921[_0x1e5b88(0x26f)]+_0x1e5b88(0x299),_0x48bcb4=_0x194921[_0x1e5b88(0x2c4)]+_0x194921[_0x1e5b88(0x271)],_0x18d54a+=parseFloat(_0x194921['cash']),_0x1e07ae+=parseFloat(_0x497eaa),_0x4fb072['push'](_0x1b3985);}if(_0x2aceff[_0x1e5b88(0x261)]>0x0)for(let _0x3506f0=0x0;_0x3506f0<=_0x2aceff['length']-0x1;_0x3506f0++){const _0x4e9a54=_0x2aceff[_0x3506f0];console[_0x1e5b88(0x25d)](_0x4e9a54);let _0x49c5b6=_0x1e5b88(0x287);_0x49c5b6+=_0x1e5b88(0x1b1)+(0x8+0x7*0x3)+_0x1e5b88(0x29c)+_0x4e9a54[_0x1e5b88(0x19f)]+_0x1e5b88(0x2ed),_0x49c5b6+=_0x1e5b88(0x266),_0x4fb072[_0x1e5b88(0x2d0)](_0x49c5b6);}function _0x2258bb(_0x58d233,_0x1514b5){const _0x56a4fd=_0x1e5b88,_0x101176=[];for(let _0x1105a1=0x0;_0x1105a1<=_0x58d233[_0x56a4fd(0x261)]-0x1;_0x1105a1+=_0x1514b5){_0x101176['push'](_0x58d233[_0x56a4fd(0x2aa)](_0x1105a1,_0x1105a1+_0x1514b5));}return _0x101176;}const _0x33b015=_0x2258bb(_0x4fb072,_0x3ad899);let _0x7f5e22='';return _0x33b015[_0x1e5b88(0x2d8)]((_0x9b4e20,_0x4f78f0)=>{const _0xee6c5c=_0x1e5b88;_0x4f78f0>0x0&&(_0x7f5e22+=_0xee6c5c(0x28c));_0x7f5e22+=_0xee6c5c(0x276),_0x7f5e22+=_0xee6c5c(0x26e);const _0x16798d=new Date(_0x16a43e),_0x3ee661={'year':_0xee6c5c(0x29e),'month':_0xee6c5c(0x21e),'day':_0xee6c5c(0x29e),'timeZone':_0xee6c5c(0x1e1)},_0x426ed7=_0x16798d['toLocaleDateString'](_0xee6c5c(0x1b0),_0x3ee661);_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+='<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20'+_0x93834a+'</b></td>',_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0x514bdf['name']+_0xee6c5c(0x299),_0x7f5e22+=_0xee6c5c(0x2b4),_0x7f5e22+=_0xee6c5c(0x2b6),_0x7f5e22+=_0xee6c5c(0x275),_0x7f5e22+=_0xee6c5c(0x1b3),_0x7f5e22+=_0xee6c5c(0x284),_0x7f5e22+=_0xee6c5c(0x2a3),_0x7f5e22+='<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>',_0x7f5e22+=_0xee6c5c(0x2bc),_0x7f5e22+='</tr>',_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x245),_0x7f5e22+=_0xee6c5c(0x2ae)+_0x426ed7+_0xee6c5c(0x299),_0x7f5e22+=_0xee6c5c(0x2ca),_0x7f5e22+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>',_0x7f5e22+=_0xee6c5c(0x1f5),_0x7f5e22+=_0xee6c5c(0x1f5),_0x7f5e22+='</tr>',_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x291),_0x7f5e22+=_0xee6c5c(0x1d1),_0x7f5e22+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>',_0x7f5e22+=_0xee6c5c(0x1f5),_0x7f5e22+=_0xee6c5c(0x1f5),_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x2ce),_0x7f5e22+=_0xee6c5c(0x198),_0x7f5e22+='</tr>',_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x2de),_0x7f5e22+=_0xee6c5c(0x315),_0x7f5e22+=_0xee6c5c(0x194);for(let _0x22c5bd=0x0;_0x22c5bd<=_0x3ade1b[_0xee6c5c(0x261)]-0x1;_0x22c5bd++){const _0x5b78d9=_0x3ade1b[_0x22c5bd];for(let _0x14558a=0x0;_0x14558a<_0x17b8eb[_0xee6c5c(0x1e0)][_0xee6c5c(0x261)];_0x14558a++){const _0x2f27c3=_0x17b8eb[_0xee6c5c(0x1e0)][_0x14558a];if(_0x2f27c3['_id'][_0xee6c5c(0x1df)]===_0x5b78d9['_id'][_0xee6c5c(0x1df)]){var _0x22739a='';switch(_0x5b78d9[_0xee6c5c(0x200)][_0xee6c5c(0x1df)]){case'Standard':_0x22739a=_0x2f27c3[_0xee6c5c(0x200)][_0xee6c5c(0x1f1)]+_0xee6c5c(0x289);break;case _0xee6c5c(0x2d7):_0x22739a=_0x2f27c3['_id'][_0xee6c5c(0x1f1)]+_0xee6c5c(0x238);break;default:_0x22739a=_0x2f27c3[_0xee6c5c(0x200)][_0xee6c5c(0x1f1)];break;}_0x7f5e22+=_0xee6c5c(0x2a2)+_0x22739a+_0xee6c5c(0x2ed);}}}_0x7f5e22+=_0xee6c5c(0x312),_0x7f5e22+=_0xee6c5c(0x22a),_0x7f5e22+=_0xee6c5c(0x286),_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x1bc);for(let _0x6a25d=0x0;_0x6a25d<=_0x17b8eb[_0xee6c5c(0x1e0)][_0xee6c5c(0x261)]-0x1;_0x6a25d++){const _0x3e78cd=_0x17b8eb[_0x6a25d];_0x7f5e22+=_0xee6c5c(0x2bf),_0x7f5e22+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x7f5e22+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x7f5e22+=_0xee6c5c(0x248),_0x7f5e22+=_0xee6c5c(0x1f9),_0x7f5e22+=_0xee6c5c(0x2f9),_0x7f5e22+='</tr>',_0x7f5e22+=_0xee6c5c(0x229),_0x7f5e22+=_0xee6c5c(0x1e9),_0x9b4e20[_0xee6c5c(0x2d8)](_0x4848df=>{_0x7f5e22+=_0x4848df;});let _0x406126={},_0x295620={},_0x1d3275={};for(let _0x4f1c5d=0x0;_0x4f1c5d<=_0x1d3f44[_0xee6c5c(0x261)]-0x1;_0x4f1c5d++){const _0x26f916=_0x1d3f44[_0x4f1c5d];var _0x3992e1=0x0;for(let _0x39b41b=0x0;_0x39b41b<=_0x26f916[_0xee6c5c(0x1b5)][_0xee6c5c(0x261)]-0x1;_0x39b41b++){const _0x536fd9=_0x26f916['products'][_0x39b41b],_0x312520=_0x536fd9[_0xee6c5c(0x1f1)]+'-'+_0x536fd9['category'];if(_0x536fd9[_0xee6c5c(0x1a0)][_0xee6c5c(0x263)]=='P')_0x536fd9[_0xee6c5c(0x1a0)][_0xee6c5c(0x318)]==_0xee6c5c(0x1ac)?(!_0x1d3275[_0x312520]&&(_0x1d3275[_0x312520]=0x0),_0x1d3275[_0x312520]+=_0x536fd9[_0xee6c5c(0x203)]):(!_0x406126[_0x312520]&&(_0x406126[_0x312520]=0x0),_0x406126[_0x312520]+=_0x536fd9[_0xee6c5c(0x203)]);else _0x536fd9['product_details'][_0xee6c5c(0x263)]=='S'&&(_0x536fd9['product_details'][_0xee6c5c(0x318)]=='true'?(!_0x1d3275[_0x312520]&&(_0x1d3275[_0x312520]=0x0),_0x1d3275[_0x312520]+=_0x536fd9[_0xee6c5c(0x203)],console[_0xee6c5c(0x25d)](_0x536fd9[_0xee6c5c(0x203)])):(!_0x295620[_0x312520]&&(_0x295620[_0x312520]=0x0),_0x295620[_0x312520]+=_0x536fd9['qty']));_0x3992e1++;}}let _0x9aca80={},_0x3a2a27={},_0xdcff1c={};var _0x22b625=0x0,_0x6dd4f7=0x0;for(let _0x591a2a=0x0;_0x591a2a<=_0x58024e[_0xee6c5c(0x261)]-0x1;_0x591a2a++){const _0x468295=_0x58024e[_0x591a2a];var _0x3992e1=0x0;for(let _0x2cd494=0x0;_0x2cd494<=_0x468295[_0xee6c5c(0x1b5)][_0xee6c5c(0x261)]-0x1;_0x2cd494++){const _0x5c59fe=_0x468295[_0xee6c5c(0x1b5)][_0x2cd494],_0x43ed29=_0x5c59fe['brand']+'-'+_0x5c59fe['category'];if(_0x5c59fe['product_details'][_0xee6c5c(0x263)]=='P')_0x5c59fe['product_details'][_0xee6c5c(0x318)]==_0xee6c5c(0x1ac)?(!_0xdcff1c[_0x43ed29]&&(_0xdcff1c[_0x43ed29]=0x0),_0xdcff1c[_0x43ed29]+=_0x5c59fe[_0xee6c5c(0x203)]):(!_0x9aca80[_0x43ed29]&&(_0x9aca80[_0x43ed29]=0x0),_0x9aca80[_0x43ed29]+=_0x5c59fe[_0xee6c5c(0x203)]);else _0x5c59fe[_0xee6c5c(0x1a0)][_0xee6c5c(0x263)]=='S'&&(_0x5c59fe[_0xee6c5c(0x1a0)][_0xee6c5c(0x318)]==_0xee6c5c(0x1ac)?(!_0xdcff1c[_0x43ed29]&&(_0xdcff1c[_0x43ed29]=0x0),_0xdcff1c[_0x43ed29]+=_0x5c59fe[_0xee6c5c(0x203)]):(!_0x3a2a27[_0x43ed29]&&(_0x3a2a27[_0x43ed29]=0x0),_0x3a2a27[_0x43ed29]+=_0x5c59fe[_0xee6c5c(0x203)]));_0x3992e1++;}var _0x22a0a3=parseFloat(_0x468295[_0xee6c5c(0x2e2)]),_0xdc5d0a=parseFloat(_0x468295[_0xee6c5c(0x24f)]);isNaN(_0xdc5d0a)&&(_0xdc5d0a=0x0),_0x22b625+=_0x22a0a3,_0x6dd4f7+=_0xdc5d0a;}_0x7f5e22+='<tr>',_0x7f5e22+=_0xee6c5c(0x2cc),_0x7f5e22+=_0xee6c5c(0x2c6),_0x7f5e22+=_0xee6c5c(0x20f);for(let _0x2fc875=0x0;_0x2fc875<=_0x17b8eb[_0xee6c5c(0x1e0)]['length']-0x1;_0x2fc875++){const _0x4a0da8=_0x17b8eb['cat_brand'][_0x2fc875],_0x198a9c=_0x4a0da8[_0xee6c5c(0x200)][_0xee6c5c(0x1f1)]+'-'+_0x4a0da8[_0xee6c5c(0x200)][_0xee6c5c(0x1df)];var _0x14dd22=_0x406126[_0x198a9c]!==undefined?formatNumber(_0x406126[_0x198a9c][_0xee6c5c(0x1de)](0x2)):'',_0xf1b8db=_0x1d3275[_0x198a9c]!==undefined?formatNumber(_0x1d3275[_0x198a9c][_0xee6c5c(0x1de)](0x2)):'',_0x1fefca=_0x295620[_0x198a9c]!==undefined?formatNumber(_0x295620[_0x198a9c][_0xee6c5c(0x1de)](0x2)):'';_0x7f5e22+=_0xee6c5c(0x1f6)+_0x14dd22+_0xee6c5c(0x2ed),_0x7f5e22+=_0xee6c5c(0x1f6)+_0x1fefca+'</b></td>',_0x7f5e22+=_0xee6c5c(0x1f6)+_0xf1b8db+'</b></td>';}_0x7f5e22+=_0xee6c5c(0x1f6)+formatNumber(_0x18d54a)+_0xee6c5c(0x2ed),_0x7f5e22+=_0xee6c5c(0x1f6)+formatNumber(_0x1e07ae)+_0xee6c5c(0x2ed),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>',_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x524b87=0x0;_0x524b87<=_0x17b8eb[_0xee6c5c(0x1e0)][_0xee6c5c(0x261)]-0x1;_0x524b87++){const _0x3e6a19=_0x17b8eb[_0xee6c5c(0x1e0)][_0x524b87],_0x256e4f=_0x3e6a19[_0xee6c5c(0x200)][_0xee6c5c(0x1f1)]+'-'+_0x3e6a19[_0xee6c5c(0x200)][_0xee6c5c(0x1df)];var _0x14dd22=_0x9aca80[_0x256e4f]!==undefined?formatNumber(_0x9aca80[_0x256e4f][_0xee6c5c(0x1de)](0x2)):'',_0xf1b8db=_0xdcff1c[_0x256e4f]!==undefined?formatNumber(_0xdcff1c[_0x256e4f]['toFixed'](0x2)):'',_0x1fefca=_0x3a2a27[_0x256e4f]!==undefined?formatNumber(_0x3a2a27[_0x256e4f][_0xee6c5c(0x1de)](0x2)):'';_0x7f5e22+=_0xee6c5c(0x1f6)+_0x14dd22+'</b></td>',_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1fefca+_0xee6c5c(0x2ed),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0xf1b8db+_0xee6c5c(0x2ed);}_0x7f5e22+=_0xee6c5c(0x1f6)+formatNumber(_0x22b625)+_0xee6c5c(0x2ed),_0x7f5e22+=_0xee6c5c(0x1f6)+formatNumber(_0x6dd4f7)+_0xee6c5c(0x2ed),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x2cc),_0x7f5e22+=_0xee6c5c(0x228),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';let _0x2eaaab=0x0,_0x290d4b=0x0,_0x5887e7=0x0;for(let _0x578418=0x0;_0x578418<=_0x17b8eb[_0xee6c5c(0x1e0)]['length']-0x1;_0x578418++){const _0x54eced=_0x17b8eb[_0xee6c5c(0x1e0)][_0x578418],_0x360600=_0x54eced[_0xee6c5c(0x200)]['brand']+'-'+_0x54eced['_id']['category'];var _0x6d263e=_0x406126[_0x360600]!==undefined?_0x406126[_0x360600][_0xee6c5c(0x1de)](0x2):'0',_0x58e308=_0x1d3275[_0x360600]!==undefined?_0x1d3275[_0x360600][_0xee6c5c(0x1de)](0x2):'0',_0x7487e4=_0x295620[_0x360600]!==undefined?_0x295620[_0x360600][_0xee6c5c(0x1de)](0x2):'0',_0x17fe1e=_0x9aca80[_0x360600]!==undefined?_0x9aca80[_0x360600][_0xee6c5c(0x1de)](0x2):'0',_0x5a3ff0=_0xdcff1c[_0x360600]!==undefined?_0xdcff1c[_0x360600][_0xee6c5c(0x1de)](0x2):'0',_0x245c17=_0x3a2a27[_0x360600]!==undefined?_0x3a2a27[_0x360600][_0xee6c5c(0x1de)](0x2):'0';_0x2eaaab=parseFloat(_0x6d263e)+parseFloat(_0x17fe1e),_0x290d4b=parseFloat(_0x7487e4)+parseFloat(_0x245c17),_0x5887e7=parseFloat(_0x58e308)+parseFloat(_0x5a3ff0),_0x7f5e22+=_0xee6c5c(0x1f6)+formatNumber(_0x2eaaab[_0xee6c5c(0x1de)](0x2))+'</b></td>',_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x290d4b[_0xee6c5c(0x1de)](0x2))+'</b></td>',_0x7f5e22+=_0xee6c5c(0x1f6)+formatNumber(_0x5887e7[_0xee6c5c(0x1de)](0x2))+'</b></td>';}var _0xd3b7e8=formatNumber(_0x18d54a+_0x22b625),_0x1144c8=formatNumber(_0x1e07ae+_0x6dd4f7);_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0xd3b7e8+_0xee6c5c(0x2ed),_0x7f5e22+=_0xee6c5c(0x1f6)+_0x1144c8+'</b></td>',_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x17b8eb['cat_brand'][_0xee6c5c(0x261)]*0x3+0x9)+_0xee6c5c(0x251),_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x2cc),_0x7f5e22+=_0xee6c5c(0x196),_0x7f5e22+=_0xee6c5c(0x20f);for(let _0x24939f=0x0;_0x24939f<=_0x17b8eb[_0xee6c5c(0x1e0)][_0xee6c5c(0x261)]-0x1;_0x24939f++){const _0x555aff=_0x17b8eb['cat_brand'][_0x24939f],_0x16530e=_0x555aff[_0xee6c5c(0x200)]['brand']+'-'+_0x555aff[_0xee6c5c(0x200)][_0xee6c5c(0x1df)];var _0x6d263e=_0x406126[_0x16530e]!==undefined?_0x406126[_0x16530e][_0xee6c5c(0x1de)](0x2):'0',_0x58e308=_0x1d3275[_0x16530e]!==undefined?_0x1d3275[_0x16530e]['toFixed'](0x2):'0',_0x7487e4=_0x295620[_0x16530e]!==undefined?_0x295620[_0x16530e][_0xee6c5c(0x1de)](0x2):'0',_0x17fe1e=_0x9aca80[_0x16530e]!==undefined?_0x9aca80[_0x16530e][_0xee6c5c(0x1de)](0x2):'0',_0x5a3ff0=_0xdcff1c[_0x16530e]!==undefined?_0xdcff1c[_0x16530e]['toFixed'](0x2):'0',_0x245c17=_0x3a2a27[_0x16530e]!==undefined?_0x3a2a27[_0x16530e][_0xee6c5c(0x1de)](0x2):'0';_0x2eaaab=parseFloat(_0x6d263e)+parseFloat(_0x17fe1e),_0x290d4b=parseFloat(_0x7487e4)+parseFloat(_0x245c17),_0x5887e7=parseFloat(_0x58e308)+parseFloat(_0x5a3ff0),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x7f5e22+=_0xee6c5c(0x1ea),_0x7f5e22+=_0xee6c5c(0x1ea);}_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x2cc),_0x7f5e22+=_0xee6c5c(0x2e7),_0x7f5e22+=_0xee6c5c(0x20f);for(let _0x15606c=0x0;_0x15606c<=_0x17b8eb[_0xee6c5c(0x1e0)]['length']-0x1;_0x15606c++){const _0x4b9bf2=_0x17b8eb[_0xee6c5c(0x1e0)][_0x15606c],_0x36259f=_0x4b9bf2[_0xee6c5c(0x200)][_0xee6c5c(0x1f1)]+'-'+_0x4b9bf2[_0xee6c5c(0x200)][_0xee6c5c(0x1df)];var _0x6d263e=_0x406126[_0x36259f]!==undefined?_0x406126[_0x36259f][_0xee6c5c(0x1de)](0x2):'0',_0x58e308=_0x1d3275[_0x36259f]!==undefined?_0x1d3275[_0x36259f][_0xee6c5c(0x1de)](0x2):'0',_0x7487e4=_0x295620[_0x36259f]!==undefined?_0x295620[_0x36259f]['toFixed'](0x2):'0',_0x17fe1e=_0x9aca80[_0x36259f]!==undefined?_0x9aca80[_0x36259f][_0xee6c5c(0x1de)](0x2):'0',_0x5a3ff0=_0xdcff1c[_0x36259f]!==undefined?_0xdcff1c[_0x36259f]['toFixed'](0x2):'0',_0x245c17=_0x3a2a27[_0x36259f]!==undefined?_0x3a2a27[_0x36259f]['toFixed'](0x2):'0';_0x2eaaab=parseFloat(_0x6d263e)+parseFloat(_0x17fe1e),_0x290d4b=parseFloat(_0x7487e4)+parseFloat(_0x245c17),_0x5887e7=parseFloat(_0x58e308)+parseFloat(_0x5a3ff0),_0x7f5e22+=_0xee6c5c(0x1ea),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x7f5e22+=_0xee6c5c(0x1ea);}_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x287),_0x7f5e22+=_0xee6c5c(0x2cc),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x7f5e22+=_0xee6c5c(0x20f);for(let _0x280e18=0x0;_0x280e18<=_0x17b8eb[_0xee6c5c(0x1e0)]['length']-0x1;_0x280e18++){const _0x457e81=_0x17b8eb[_0xee6c5c(0x1e0)][_0x280e18],_0x3e8b9c=_0x457e81[_0xee6c5c(0x200)][_0xee6c5c(0x1f1)]+'-'+_0x457e81[_0xee6c5c(0x200)][_0xee6c5c(0x1df)];var _0x6d263e=_0x406126[_0x3e8b9c]!==undefined?_0x406126[_0x3e8b9c]['toFixed'](0x2):'0',_0x58e308=_0x1d3275[_0x3e8b9c]!==undefined?_0x1d3275[_0x3e8b9c][_0xee6c5c(0x1de)](0x2):'0',_0x7487e4=_0x295620[_0x3e8b9c]!==undefined?_0x295620[_0x3e8b9c][_0xee6c5c(0x1de)](0x2):'0',_0x17fe1e=_0x9aca80[_0x3e8b9c]!==undefined?_0x9aca80[_0x3e8b9c][_0xee6c5c(0x1de)](0x2):'0',_0x5a3ff0=_0xdcff1c[_0x3e8b9c]!==undefined?_0xdcff1c[_0x3e8b9c][_0xee6c5c(0x1de)](0x2):'0',_0x245c17=_0x3a2a27[_0x3e8b9c]!==undefined?_0x3a2a27[_0x3e8b9c][_0xee6c5c(0x1de)](0x2):'0';_0x2eaaab=parseFloat(_0x6d263e)+parseFloat(_0x17fe1e),_0x290d4b=parseFloat(_0x7487e4)+parseFloat(_0x245c17),_0x5887e7=parseFloat(_0x58e308)+parseFloat(_0x5a3ff0),_0x7f5e22+=_0xee6c5c(0x1ea),_0x7f5e22+=_0xee6c5c(0x1ea),_0x7f5e22+=_0xee6c5c(0x1ea);}_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+='<tr>',_0x7f5e22+=_0xee6c5c(0x2cc),_0x7f5e22+=_0xee6c5c(0x2c6),_0x7f5e22+=_0xee6c5c(0x20f);for(let _0x4c01ff=0x0;_0x4c01ff<=_0x17b8eb['cat_brand'][_0xee6c5c(0x261)]-0x1;_0x4c01ff++){const _0x4dace3=_0x17b8eb[_0xee6c5c(0x1e0)][_0x4c01ff],_0x4dd2ed=_0x4dace3[_0xee6c5c(0x200)][_0xee6c5c(0x1f1)]+'-'+_0x4dace3['_id'][_0xee6c5c(0x1df)];var _0x6d263e=_0x406126[_0x4dd2ed]!==undefined?_0x406126[_0x4dd2ed]['toFixed'](0x2):'',_0x58e308=_0x1d3275[_0x4dd2ed]!==undefined?_0x1d3275[_0x4dd2ed]['toFixed'](0x2):'',_0x7487e4=_0x295620[_0x4dd2ed]!==undefined?_0x295620[_0x4dd2ed][_0xee6c5c(0x1de)](0x2):'',_0x17fe1e=_0x9aca80[_0x4dd2ed]!==undefined?_0x9aca80[_0x4dd2ed][_0xee6c5c(0x1de)](0x2):'',_0x5a3ff0=_0xdcff1c[_0x4dd2ed]!==undefined?_0xdcff1c[_0x4dd2ed]['toFixed'](0x2):'',_0x245c17=_0x3a2a27[_0x4dd2ed]!==undefined?_0x3a2a27[_0x4dd2ed]['toFixed'](0x2):'';_0x2eaaab=formatNumber(parseFloat(_0x6d263e)+parseFloat(_0x17fe1e)),_0x290d4b=formatNumber(parseFloat(_0x7487e4)+parseFloat(_0x245c17)),_0x5887e7=formatNumber(parseFloat(_0x58e308)+parseFloat(_0x5a3ff0)),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x6d263e+_0xee6c5c(0x2ed),_0x7f5e22+=_0xee6c5c(0x1f6)+_0x7487e4+_0xee6c5c(0x2ed),_0x7f5e22+=_0xee6c5c(0x1f6)+_0x58e308+'</b></td>';}_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+='</tr>',_0x7f5e22+='<tr>',_0x7f5e22+=_0xee6c5c(0x2cc),_0x7f5e22+=_0xee6c5c(0x30a),_0x7f5e22+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x8be29d=0x0;_0x8be29d<=_0x17b8eb[_0xee6c5c(0x1e0)][_0xee6c5c(0x261)]-0x1;_0x8be29d++){const _0x5d8515=_0x17b8eb[_0xee6c5c(0x1e0)][_0x8be29d],_0x4f8bd7=_0x5d8515[_0xee6c5c(0x200)][_0xee6c5c(0x1f1)]+'-'+_0x5d8515[_0xee6c5c(0x200)][_0xee6c5c(0x1df)];var _0x6d263e=_0x406126[_0x4f8bd7]!==undefined?_0x406126[_0x4f8bd7][_0xee6c5c(0x1de)](0x2):'0',_0x58e308=_0x1d3275[_0x4f8bd7]!==undefined?_0x1d3275[_0x4f8bd7]['toFixed'](0x2):'0',_0x7487e4=_0x295620[_0x4f8bd7]!==undefined?_0x295620[_0x4f8bd7][_0xee6c5c(0x1de)](0x2):'0',_0x17fe1e=_0x9aca80[_0x4f8bd7]!==undefined?_0x9aca80[_0x4f8bd7][_0xee6c5c(0x1de)](0x2):'0',_0x5a3ff0=_0xdcff1c[_0x4f8bd7]!==undefined?_0xdcff1c[_0x4f8bd7][_0xee6c5c(0x1de)](0x2):'0',_0x245c17=_0x3a2a27[_0x4f8bd7]!==undefined?_0x3a2a27[_0x4f8bd7][_0xee6c5c(0x1de)](0x2):'0';_0x2eaaab=parseFloat(_0x6d263e)+parseFloat(_0x17fe1e),_0x290d4b=parseFloat(_0x7487e4)+parseFloat(_0x245c17),_0x5887e7=parseFloat(_0x58e308)+parseFloat(_0x5a3ff0),_0x7f5e22+=_0xee6c5c(0x1ea),_0x7f5e22+=_0xee6c5c(0x1ea),_0x7f5e22+=_0xee6c5c(0x1ea);}_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x20f),_0x7f5e22+=_0xee6c5c(0x266),_0x7f5e22+=_0xee6c5c(0x301),_0x7f5e22+=_0xee6c5c(0x215);}),_0x7f5e22;}async function generateReferenceNumber(_0x91adad,_0x12183e,_0x38ac5a){const _0x6fbe24=a0_0x5c3944,_0x2af159=new Date(_0x91adad)[_0x6fbe24(0x29f)](),_0x1a1485=('0'+(new Date(_0x91adad)['getMonth']()+0x1))[_0x6fbe24(0x2aa)](-0x2),_0x219d4d=('0'+new Date(_0x91adad)['getDate']())[_0x6fbe24(0x2aa)](-0x2),_0x7c086f=await staff[_0x6fbe24(0x1c2)]({'email':_0x38ac5a[_0x6fbe24(0x216)]}),_0x149f07=_0x7c086f[_0x6fbe24(0x23b)],_0x3b1593=_0x149f07+'-'+_0x2af159+_0x1a1485+_0x219d4d,_0x3d6629=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x3b1593),'salesman_code':_0x149f07})[_0x6fbe24(0x224)]({'createdAt':-0x1}),_0x41198c=_0x3b1593;_0x3d6629&&(_0x41198c=_0x3d6629[_0x6fbe24(0x1b7)]);console['log'](_0x41198c);const _0x38bc02=new Reference({'referenceNumber':_0x41198c,'staff_id':_0x12183e,'salesman_code':_0x149f07});return await _0x38bc02[_0x6fbe24(0x2f7)](),_0x41198c;}router[a0_0x5c3944(0x1ad)](a0_0x5c3944(0x31d),auth,async(_0x32ca5b,_0x4a2f9a)=>{const _0x4b9ba4=a0_0x5c3944,{from_date:_0x366498,dataview:_0x983461}=_0x32ca5b['body'],_0x3d56ee=_0x32ca5b[_0x4b9ba4(0x2a8)],_0x4e4bae=await staff[_0x4b9ba4(0x1c2)]({'email':_0x3d56ee[_0x4b9ba4(0x216)]}),_0x1c4fbf=await master_shop[_0x4b9ba4(0x279)](),_0x407d41='';var _0x56b3af=new Date(_0x366498);const _0x35a587={'year':_0x4b9ba4(0x29e),'month':_0x4b9ba4(0x21e),'day':_0x4b9ba4(0x29e)},_0xf8afa5=new Intl[(_0x4b9ba4(0x257))](_0x4b9ba4(0x1b0),_0x35a587)['format'](_0x56b3af),_0x51f21c=await Reference['find']({'staff_id':_0x4e4bae['_id']['valueOf'](),'date_include':_0x366498});if(_0x51f21c['length']>0x0){let _0x407e90='';_0x407e90+=_0x51f21c[0x0][_0x4b9ba4(0x317)];if(_0x983461=='excel'){const _0x4f67fa=cheerio[_0x4b9ba4(0x1c1)](_0x407e90);let _0x328f50=[],_0xcef612=[],_0x3b76f9=[];const _0x555e04=_0x2f161b=>{const _0x2f8347=_0x4b9ba4,_0x131a7e={'top':{'style':_0x2f8347(0x259),'color':{'rgb':_0x2f8347(0x1ec)}},'bottom':{'style':_0x2f8347(0x259),'color':{'rgb':_0x2f8347(0x1ec)}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x2f8347(0x1ec)}}};if(_0x2f161b){const _0xa1c07d=_0x2f161b[_0x2f8347(0x2bb)](';')['reduce']((_0x1e4d7b,_0x12069b)=>{const _0x37b69e=_0x2f8347,[_0x33935b,_0x4073ba]=_0x12069b['split'](':')['map'](_0x12d5cf=>_0x12d5cf[_0x37b69e(0x31c)]());return _0x1e4d7b[_0x33935b]=_0x4073ba,_0x1e4d7b;},{});_0xa1c07d[_0x2f8347(0x31a)]&&(_0x131a7e[_0x2f8347(0x2df)][_0x2f8347(0x1b4)]=_0xa1c07d[_0x2f8347(0x31a)]['includes']('thin')?_0x2f8347(0x2cf):'medium'),_0xa1c07d[_0x2f8347(0x2d2)]&&(_0x131a7e[_0x2f8347(0x1e2)]['style']=_0xa1c07d[_0x2f8347(0x2d2)][_0x2f8347(0x298)]('thin')?_0x2f8347(0x2cf):_0x2f8347(0x297)),_0xa1c07d['border-left']&&(_0x131a7e[_0x2f8347(0x208)][_0x2f8347(0x1b4)]=_0xa1c07d[_0x2f8347(0x1eb)][_0x2f8347(0x298)](_0x2f8347(0x2cf))?_0x2f8347(0x2cf):'medium'),_0xa1c07d[_0x2f8347(0x1a9)]&&(_0x131a7e[_0x2f8347(0x320)]['style']=_0xa1c07d[_0x2f8347(0x1a9)]['includes']('thin')?_0x2f8347(0x2cf):'medium');}return _0x131a7e;};_0x4f67fa(_0x4b9ba4(0x1d3))['each']((_0x2c6ca8,_0x48f075)=>{const _0x1ee5b0=_0x4b9ba4;let _0xf82d97=[],_0x21f4c4=0x0;while(_0x3b76f9[_0x21f4c4]){_0x3b76f9[_0x21f4c4]--,_0x21f4c4++;}_0x4f67fa(_0x48f075)[_0x1ee5b0(0x279)](_0x1ee5b0(0x2fd))[_0x1ee5b0(0x2e1)]((_0x449283,_0x38197b)=>{const _0x4e4d84=_0x1ee5b0;let _0x1dd226=_0x4f67fa(_0x38197b)[_0x4e4d84(0x29d)]()[_0x4e4d84(0x31c)](),_0x125b0a=parseFloat(_0x1dd226['replace'](/,/g,''));isNaN(_0x125b0a)&&(_0x125b0a=_0x1dd226);let _0x1e9de4=parseInt(_0x4f67fa(_0x38197b)[_0x4e4d84(0x21c)](_0x4e4d84(0x19d)))||0x1,_0x31ddd6=parseInt(_0x4f67fa(_0x38197b)[_0x4e4d84(0x21c)](_0x4e4d84(0x232)))||0x1;const _0x146996=_0x4f67fa(_0x38197b)[_0x4e4d84(0x21c)]('style'),_0xd63088=_0x555e04(_0x146996);_0xf82d97[_0x21f4c4]={'v':_0x125b0a,'s':{'border':_0xd63088}};(_0x1e9de4>0x1||_0x31ddd6>0x1)&&_0xcef612[_0x4e4d84(0x2d0)]({'s':{'r':_0x2c6ca8,'c':_0x21f4c4},'e':{'r':_0x2c6ca8+_0x31ddd6-0x1,'c':_0x21f4c4+_0x1e9de4-0x1}});for(let _0x51491f=0x0;_0x51491f<_0x1e9de4;_0x51491f++){_0x31ddd6>0x1&&(_0x3b76f9[_0x21f4c4+_0x51491f]=_0x31ddd6-0x1);}_0x21f4c4+=_0x1e9de4;}),_0x328f50['push'](_0xf82d97);});const _0x5cec0b=XLSX[_0x4b9ba4(0x250)][_0x4b9ba4(0x1d0)](),_0x16cd1c=XLSX[_0x4b9ba4(0x250)]['aoa_to_sheet'](_0x328f50);_0xcef612[_0x4b9ba4(0x261)]>0x0&&(_0x16cd1c[_0x4b9ba4(0x269)]=_0xcef612);_0x16cd1c[_0x4b9ba4(0x2fb)]=_0x328f50[0x0][_0x4b9ba4(0x22e)](()=>({'wpx':0x64})),XLSX[_0x4b9ba4(0x250)]['book_append_sheet'](_0x5cec0b,_0x16cd1c,_0x4b9ba4(0x192));const _0x424537=XLSX[_0x4b9ba4(0x2da)](_0x5cec0b,{'bookType':_0x4b9ba4(0x268),'type':_0x4b9ba4(0x26a)});_0x4a2f9a[_0x4b9ba4(0x302)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x4a2f9a[_0x4b9ba4(0x302)](_0x4b9ba4(0x226),_0x4b9ba4(0x22d)),_0x4a2f9a['send'](_0x424537);}else{let _0x31b028='';_0x31b028+=_0x407e90,_0x31b028+=_0x4b9ba4(0x207),_0x31b028+=_0x4b9ba4(0x1e8),_0x31b028+=_0x4b9ba4(0x193),_0x31b028+='};',_0x31b028+=_0x4b9ba4(0x2c7),_0x4a2f9a[_0x4b9ba4(0x2a7)](_0x31b028);}}else generateReferenceNumber(_0x366498,_0x4e4bae[_0x4b9ba4(0x200)][_0x4b9ba4(0x26b)](),_0x3d56ee)[_0x4b9ba4(0x1ab)](async _0x57562b=>{const _0x2407f8=_0x4b9ba4,_0x372adb=await agentsdataDSICheck_DSRR(_0x366498,_0x4e4bae[_0x2407f8(0x200)]['valueOf'](),_0x407d41,_0x57562b);console['log'](_0x372adb);let _0x191758=_0x2407f8(0x197);_0x191758+=_0x2407f8(0x2e8),_0x191758+=_0x2407f8(0x27b),_0x191758+=_0x2407f8(0x276),_0x191758+=_0x372adb,_0x191758+='</table>',_0x191758+='</div>',_0x191758+='</div>';if(_0x372adb[_0x2407f8(0x261)]>0x0){const _0x4d8f09=await Reference[_0x2407f8(0x1c2)]({'staff_id':_0x4e4bae['_id']['valueOf'](),'referenceNumber':_0x57562b});_0x4d8f09[_0x2407f8(0x317)]=_0x191758,_0x4d8f09['date_include']=_0x366498,await _0x4d8f09[_0x2407f8(0x2f7)]();if(_0x983461==_0x2407f8(0x202)){const _0xf9aef9=cheerio[_0x2407f8(0x1c1)](_0x191758);let _0x30e788=[],_0x5460e7=[],_0x40d1aa=[];const _0x58efe3=_0x8bcc31=>{const _0x2b3cc9=_0x2407f8,_0x581a77={'top':{'style':'thick','color':{'rgb':_0x2b3cc9(0x1ec)}},'bottom':{'style':_0x2b3cc9(0x259),'color':{'rgb':_0x2b3cc9(0x1ec)}},'left':{'style':'thick','color':{'rgb':_0x2b3cc9(0x1ec)}},'right':{'style':_0x2b3cc9(0x259),'color':{'rgb':_0x2b3cc9(0x1ec)}}};if(_0x8bcc31){const _0x133660=_0x8bcc31[_0x2b3cc9(0x2bb)](';')[_0x2b3cc9(0x272)]((_0x27752f,_0x2892b2)=>{const _0x283565=_0x2b3cc9,[_0xcef026,_0x3fed84]=_0x2892b2['split'](':')[_0x283565(0x22e)](_0xc4df51=>_0xc4df51['trim']());return _0x27752f[_0xcef026]=_0x3fed84,_0x27752f;},{});_0x133660[_0x2b3cc9(0x31a)]&&(_0x581a77[_0x2b3cc9(0x2df)][_0x2b3cc9(0x1b4)]=_0x133660[_0x2b3cc9(0x31a)][_0x2b3cc9(0x298)](_0x2b3cc9(0x2cf))?_0x2b3cc9(0x2cf):_0x2b3cc9(0x297)),_0x133660[_0x2b3cc9(0x2d2)]&&(_0x581a77[_0x2b3cc9(0x1e2)][_0x2b3cc9(0x1b4)]=_0x133660[_0x2b3cc9(0x2d2)][_0x2b3cc9(0x298)](_0x2b3cc9(0x2cf))?_0x2b3cc9(0x2cf):_0x2b3cc9(0x297)),_0x133660[_0x2b3cc9(0x1eb)]&&(_0x581a77['left']['style']=_0x133660[_0x2b3cc9(0x1eb)]['includes'](_0x2b3cc9(0x2cf))?'thin':_0x2b3cc9(0x297)),_0x133660[_0x2b3cc9(0x1a9)]&&(_0x581a77[_0x2b3cc9(0x320)][_0x2b3cc9(0x1b4)]=_0x133660['border-right'][_0x2b3cc9(0x298)](_0x2b3cc9(0x2cf))?_0x2b3cc9(0x2cf):'medium');}return _0x581a77;};_0xf9aef9(_0x2407f8(0x1d3))[_0x2407f8(0x2e1)]((_0x1c0d21,_0x3486a8)=>{const _0x295462=_0x2407f8;let _0x6b4e57=[],_0x2a2fc9=0x0;while(_0x40d1aa[_0x2a2fc9]){_0x40d1aa[_0x2a2fc9]--,_0x2a2fc9++;}_0xf9aef9(_0x3486a8)['find'](_0x295462(0x2fd))[_0x295462(0x2e1)]((_0x555996,_0x30ed66)=>{const _0xe552b0=_0x295462;let _0xa1d858=_0xf9aef9(_0x30ed66)['text']()[_0xe552b0(0x31c)](),_0x468643=parseFloat(_0xa1d858[_0xe552b0(0x1cf)](/,/g,''));isNaN(_0x468643)&&(_0x468643=_0xa1d858);let _0x55b197=parseInt(_0xf9aef9(_0x30ed66)[_0xe552b0(0x21c)](_0xe552b0(0x19d)))||0x1,_0x3e2966=parseInt(_0xf9aef9(_0x30ed66)['attr']('rowspan'))||0x1;const _0x4af7a7=_0xf9aef9(_0x30ed66)[_0xe552b0(0x21c)](_0xe552b0(0x1b4)),_0x9de2c6=_0x58efe3(_0x4af7a7);_0x6b4e57[_0x2a2fc9]={'v':_0x468643,'s':{'border':_0x9de2c6}};(_0x55b197>0x1||_0x3e2966>0x1)&&_0x5460e7[_0xe552b0(0x2d0)]({'s':{'r':_0x1c0d21,'c':_0x2a2fc9},'e':{'r':_0x1c0d21+_0x3e2966-0x1,'c':_0x2a2fc9+_0x55b197-0x1}});for(let _0x3de425=0x0;_0x3de425<_0x55b197;_0x3de425++){_0x3e2966>0x1&&(_0x40d1aa[_0x2a2fc9+_0x3de425]=_0x3e2966-0x1);}_0x2a2fc9+=_0x55b197;}),_0x30e788[_0x295462(0x2d0)](_0x6b4e57);});const _0x42d058=XLSX[_0x2407f8(0x250)][_0x2407f8(0x1d0)](),_0xa8c719=XLSX['utils'][_0x2407f8(0x21b)](_0x30e788);_0x5460e7[_0x2407f8(0x261)]>0x0&&(_0xa8c719[_0x2407f8(0x269)]=_0x5460e7);_0xa8c719[_0x2407f8(0x2fb)]=_0x30e788[0x0][_0x2407f8(0x22e)](()=>({'wpx':0x64})),XLSX[_0x2407f8(0x250)][_0x2407f8(0x2b1)](_0x42d058,_0xa8c719,_0x2407f8(0x192));const _0x480913=XLSX['write'](_0x42d058,{'bookType':_0x2407f8(0x268),'type':_0x2407f8(0x26a)});_0x4a2f9a[_0x2407f8(0x302)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x4a2f9a[_0x2407f8(0x302)](_0x2407f8(0x226),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x4a2f9a[_0x2407f8(0x2a7)](_0x480913);}else _0x191758+='<script>',_0x191758+='window.onload\x20=\x20function()\x20{',_0x191758+='window.print();',_0x191758+='};',_0x191758+=_0x2407f8(0x2c7),_0x4a2f9a[_0x2407f8(0x2a7)](_0x191758);}else await Reference['deleteOne']({'referenceNumber':_0x57562b}),_0x32ca5b['flash'](_0x2407f8(0x217),_0x2407f8(0x220)),_0x4a2f9a[_0x2407f8(0x1b6)](_0x2407f8(0x20e));})[_0x4b9ba4(0x265)](console[_0x4b9ba4(0x195)]);}),router[a0_0x5c3944(0x295)]('/dsrr_admin/view',auth,async(_0x29611f,_0x3d39f2)=>{const _0x5b0a09=a0_0x5c3944;try{const {username:_0x514fd8,email:_0x3083e6,role:_0x15bea}=_0x29611f[_0x5b0a09(0x2a8)],_0x520bdc=_0x29611f['user'],_0x7dcc6c=await profile[_0x5b0a09(0x1c2)]({'email':_0x520bdc[_0x5b0a09(0x216)]}),_0x2421e5={'year':'numeric','month':_0x5b0a09(0x21e),'day':_0x5b0a09(0x29e)},_0x33a953=await master_shop['find']();console[_0x5b0a09(0x25d)](_0x5b0a09(0x290),_0x33a953);const _0x12f00d=await product[_0x5b0a09(0x279)]();console['log']('Products\x20find_data',_0x12f00d);const _0x1abe32=await warehouse[_0x5b0a09(0x20b)]([{'$unwind':_0x5b0a09(0x292)},{'$lookup':{'from':_0x5b0a09(0x1b5),'localField':_0x5b0a09(0x296),'foreignField':_0x5b0a09(0x273),'as':_0x5b0a09(0x209)}},{'$unwind':_0x5b0a09(0x234)},{'$project':{'product_name':_0x5b0a09(0x2dc),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x5b0a09(0x1f7),'product_stock':{'$sum':_0x5b0a09(0x31e)}}}]);console[_0x5b0a09(0x25d)](_0x5b0a09(0x213),_0x1abe32),_0x1abe32[_0x5b0a09(0x2d8)](_0x4d36c1=>{const _0x44734f=_0x5b0a09,_0x561633=_0x12f00d[_0x44734f(0x22e)](_0x59ea75=>{const _0x141a92=_0x44734f;_0x59ea75[_0x141a92(0x273)]==_0x4d36c1[_0x141a92(0x200)]&&(_0x59ea75[_0x141a92(0x2dd)]=parseInt(_0x59ea75[_0x141a92(0x2dd)])+parseInt(_0x4d36c1[_0x141a92(0x254)]));});});const _0x509b1a=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x4322d3=await staff['findOne']({'email':_0x520bdc[_0x5b0a09(0x216)]});if(_0x33a953[0x0][_0x5b0a09(0x1d7)]==_0x5b0a09(0x321))var _0x3e0740=users[_0x5b0a09(0x2b0)];else{if(_0x33a953[0x0][_0x5b0a09(0x1d7)]==_0x5b0a09(0x2d4))var _0x3e0740=users[_0x5b0a09(0x2d4)];else{if(_0x33a953[0x0][_0x5b0a09(0x1d7)]==_0x5b0a09(0x30e))var _0x3e0740=users['German'];else{if(_0x33a953[0x0][_0x5b0a09(0x1d7)]==_0x5b0a09(0x2b9))var _0x3e0740=users[_0x5b0a09(0x2b9)];else{if(_0x33a953[0x0]['language']==_0x5b0a09(0x2c2))var _0x3e0740=users[_0x5b0a09(0x2c2)];else{if(_0x33a953[0x0]['language']=='Portuguese\x20(BR)')var _0x3e0740=users[_0x5b0a09(0x1cd)];else{if(_0x33a953[0x0][_0x5b0a09(0x1d7)]==_0x5b0a09(0x1c8))var _0x3e0740=users['Chinese'];else{if(_0x33a953[0x0][_0x5b0a09(0x1d7)]==_0x5b0a09(0x1ca))var _0x3e0740=users['Arabic'];}}}}}}}_0x3d39f2['render'](_0x5b0a09(0x267),{'success':_0x29611f[_0x5b0a09(0x300)](_0x5b0a09(0x1fa)),'errors':_0x29611f[_0x5b0a09(0x300)](_0x5b0a09(0x217)),'alldata':_0x12f00d,'profile':_0x7dcc6c,'master_shop':_0x33a953,'role':_0x520bdc,'product_stock':_0x1abe32,'language':_0x3e0740,'staff_arr':_0x4322d3,'staff_data_all':_0x509b1a});}catch(_0x42f15d){}}),router[a0_0x5c3944(0x1ad)]('/getDSSR_no',auth,async(_0x4fb53e,_0x17e178)=>{const _0x34dd75=a0_0x5c3944;try{const {from:_0xf2c3a8,to:_0x20df56,staff_data:_0x511ca0}=_0x4fb53e[_0x34dd75(0x22f)],_0x13df91=await Reference[_0x34dd75(0x20b)]([{'$match':{'date_include':{'$gte':_0xf2c3a8,'$lte':_0x20df56},'staff_id':_0x511ca0}},{'$sort':{'date_include':0x1}}]);_0x17e178[_0x34dd75(0x2e6)](_0x13df91);}catch(_0x56e2ef){_0x17e178['json'](_0x56e2ef);}}),router['post']('/getDSSR_no_sales',auth,async(_0x1f6f54,_0x2159cd)=>{const _0x251114=a0_0x5c3944;try{const {from:_0x11a6d5,to:_0x5f1607}=_0x1f6f54[_0x251114(0x22f)],{sttaff_id:_0x1bdce8}=_0x1f6f54['user'],_0x5bb867=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x11a6d5,'$lte':_0x5f1607},'staff_id':_0x1bdce8}},{'$sort':{'date_include':0x1}}]);_0x2159cd[_0x251114(0x2e6)](_0x5bb867);}catch(_0x292cab){_0x2159cd[_0x251114(0x2e6)](_0x292cab);}}),router[a0_0x5c3944(0x295)](a0_0x5c3944(0x1dc),auth,async(_0xe76649,_0x127691)=>{const _0x265670=a0_0x5c3944;try{const _0x5610db=_0xe76649[_0x265670(0x28f)]['id'],_0x4a4de4=await Reference[_0x265670(0x2c3)](_0x5610db);let _0xf2fbe3='';_0xf2fbe3+=_0x4a4de4[_0x265670(0x317)],_0xf2fbe3+='<script>',_0xf2fbe3+=_0x265670(0x1e8),_0xf2fbe3+=_0x265670(0x193),_0xf2fbe3+='};',_0xf2fbe3+=_0x265670(0x2c7),_0x127691[_0x265670(0x2a7)](_0xf2fbe3);}catch(_0x5c4fae){_0x127691[_0x265670(0x2e6)](_0x5c4fae);}}),router[a0_0x5c3944(0x1ad)](a0_0x5c3944(0x246),auth,async(_0x5e440a,_0x362812)=>{const _0x4d604e=a0_0x5c3944;try{const {ref_data:_0x5efa45}=_0x5e440a[_0x4d604e(0x22f)],_0x35de32=_0x5efa45[_0x4d604e(0x2bb)]('~'),_0x32d707=_0x35de32['filter'](_0x22f03a=>_0x22f03a!==''),_0x382f23=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x32d707}}}]),_0x4f2bd6=XLSX[_0x4d604e(0x250)][_0x4d604e(0x1d0)]();_0x382f23[_0x4d604e(0x2d8)](_0x10b934=>{const _0x334d12=_0x4d604e,_0x49f13f=cheerio[_0x334d12(0x1c1)](_0x10b934[_0x334d12(0x317)]);let _0x17e8bc=[],_0xe02d7e=[],_0xc99125=[];_0x49f13f('table\x20tr')[_0x334d12(0x2e1)]((_0x51f9e8,_0x27b8c9)=>{const _0x437ffb=_0x334d12;let _0x450323=[],_0x27688f=0x0;while(_0xc99125[_0x27688f]){_0xc99125[_0x27688f]--,_0x27688f++;}_0x49f13f(_0x27b8c9)[_0x437ffb(0x279)]('td,\x20th')[_0x437ffb(0x2e1)]((_0x1294ff,_0x1fef15)=>{const _0x2ec426=_0x437ffb;let _0x1ebeec=_0x49f13f(_0x1fef15)[_0x2ec426(0x29d)]()['trim'](),_0x22b719=parseFloat(_0x1ebeec['replace'](/,/g,''));isNaN(_0x22b719)&&(_0x22b719=_0x1ebeec);let _0x2386d1=parseInt(_0x49f13f(_0x1fef15)[_0x2ec426(0x21c)](_0x2ec426(0x19d)))||0x1,_0x582118=parseInt(_0x49f13f(_0x1fef15)[_0x2ec426(0x21c)](_0x2ec426(0x232)))||0x1;_0x450323[_0x27688f]=_0x22b719;(_0x2386d1>0x1||_0x582118>0x1)&&_0xe02d7e['push']({'s':{'r':_0x51f9e8,'c':_0x27688f},'e':{'r':_0x51f9e8+_0x582118-0x1,'c':_0x27688f+_0x2386d1-0x1}});for(let _0x46c470=0x0;_0x46c470<_0x2386d1;_0x46c470++){_0x582118>0x1&&(_0xc99125[_0x27688f+_0x46c470]=_0x582118-0x1);}_0x27688f+=_0x2386d1;}),_0x17e8bc['push'](_0x450323);});const _0x5104c6=XLSX[_0x334d12(0x250)][_0x334d12(0x21b)](_0x17e8bc);_0xe02d7e[_0x334d12(0x261)]>0x0&&(_0x5104c6[_0x334d12(0x269)]=_0xe02d7e),_0x5104c6[_0x334d12(0x2fb)]=_0x17e8bc[0x0][_0x334d12(0x22e)](()=>({'wpx':0x64})),XLSX[_0x334d12(0x250)][_0x334d12(0x2b1)](_0x4f2bd6,_0x5104c6,_0x10b934[_0x334d12(0x1b7)]);});const _0x231fd8=XLSX[_0x4d604e(0x2da)](_0x4f2bd6,{'bookType':_0x4d604e(0x268),'type':_0x4d604e(0x26a)});_0x362812['setHeader'](_0x4d604e(0x231),_0x4d604e(0x1be)),_0x362812['setHeader'](_0x4d604e(0x226),_0x4d604e(0x22d)),_0x362812[_0x4d604e(0x2a7)](_0x231fd8);}catch(_0x1cfb1f){_0x362812[_0x4d604e(0x2e6)](_0x1cfb1f);}}),router[a0_0x5c3944(0x1ad)](a0_0x5c3944(0x20a),auth,async(_0x564a6f,_0x35f789)=>{const _0x40a1bc=a0_0x5c3944,{from_date:_0x2917a9,agent_id:_0x5d638a}=_0x564a6f[_0x40a1bc(0x22f)],_0x955d76=_0x564a6f[_0x40a1bc(0x2a8)],_0x32d24f=await staff[_0x40a1bc(0x1c2)]({'email':_0x955d76['email']}),_0x460951=await master_shop[_0x40a1bc(0x279)](),_0x3c23b9=await agentsdataDSICheck_DSRR(_0x2917a9,_0x5d638a,_0x5dd30c);let _0xf5f500='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x5a286a=new Date(_0x2917a9);const _0xe9782d={'year':_0x40a1bc(0x29e),'month':'long','day':_0x40a1bc(0x29e)},_0x4f75ad=new Intl[(_0x40a1bc(0x257))]('en-US',_0xe9782d)[_0x40a1bc(0x19b)](_0x5a286a);_0xf5f500+=_0x40a1bc(0x2e8),_0xf5f500+=_0x40a1bc(0x27b),_0xf5f500+=_0x40a1bc(0x276),_0xf5f500+=_0x3c23b9,_0xf5f500+=_0x40a1bc(0x215),_0xf5f500+='</div>',_0xf5f500+=_0x40a1bc(0x2f2);let _0x2efca8='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x5d1843={'width':_0x40a1bc(0x27e),'height':_0x40a1bc(0x28d),'orientation':_0x40a1bc(0x237),'border':{'top':_0x40a1bc(0x235),'right':'0.1in','bottom':_0x40a1bc(0x235),'left':_0x40a1bc(0x235)},'header':{'height':_0x40a1bc(0x2ab),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x2efca8+_0x40a1bc(0x30b)+_0x4f75ad+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x40a1bc(0x1fd),'contents':{'default':_0x40a1bc(0x2fc)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x40a1bc(0x23d)}}};var _0x5dd30c='on';if(_0x5dd30c=='on'){const _0x11d4e5=cheerio[_0x40a1bc(0x1c1)](_0xf5f500);let _0x51b208=[],_0x387c7b=[],_0x4550df=[];_0x11d4e5(_0x40a1bc(0x1d3))[_0x40a1bc(0x2e1)]((_0x1d9fd2,_0x3df394)=>{const _0x1fea20=_0x40a1bc;let _0x4f5f78=[],_0x1d79a9=0x0;while(_0x4550df[_0x1d79a9]){_0x4550df[_0x1d79a9]--,_0x1d79a9++;}_0x11d4e5(_0x3df394)[_0x1fea20(0x279)](_0x1fea20(0x2fd))[_0x1fea20(0x2e1)]((_0x360f71,_0x87e359)=>{const _0x3dfb78=_0x1fea20;let _0x111544=_0x11d4e5(_0x87e359)['text']()[_0x3dfb78(0x31c)](),_0x25508f=parseFloat(_0x111544[_0x3dfb78(0x1cf)](/,/g,''));isNaN(_0x25508f)&&(_0x25508f=_0x111544);let _0x38447a=parseInt(_0x11d4e5(_0x87e359)[_0x3dfb78(0x21c)](_0x3dfb78(0x19d)))||0x1,_0x5816cf=parseInt(_0x11d4e5(_0x87e359)[_0x3dfb78(0x21c)](_0x3dfb78(0x232)))||0x1;_0x4f5f78[_0x1d79a9]=_0x25508f;(_0x38447a>0x1||_0x5816cf>0x1)&&_0x387c7b[_0x3dfb78(0x2d0)]({'s':{'r':_0x1d9fd2,'c':_0x1d79a9},'e':{'r':_0x1d9fd2+_0x5816cf-0x1,'c':_0x1d79a9+_0x38447a-0x1}});for(let _0x1f9189=0x0;_0x1f9189<_0x38447a;_0x1f9189++){_0x5816cf>0x1&&(_0x4550df[_0x1d79a9+_0x1f9189]=_0x5816cf-0x1);}_0x1d79a9+=_0x38447a;}),_0x51b208[_0x1fea20(0x2d0)](_0x4f5f78);});const _0x5dcc4f=XLSX['utils'][_0x40a1bc(0x1d0)](),_0x47110b=XLSX[_0x40a1bc(0x250)][_0x40a1bc(0x21b)](_0x51b208);_0x387c7b[_0x40a1bc(0x261)]>0x0&&(_0x47110b[_0x40a1bc(0x269)]=_0x387c7b);_0x47110b['!cols']=_0x51b208[0x0][_0x40a1bc(0x22e)](()=>({'wpx':0x64})),XLSX[_0x40a1bc(0x250)][_0x40a1bc(0x2b1)](_0x5dcc4f,_0x47110b,'Sales\x20Report');const _0x578c62=XLSX[_0x40a1bc(0x2da)](_0x5dcc4f,{'bookType':_0x40a1bc(0x268),'type':_0x40a1bc(0x26a)});_0x35f789[_0x40a1bc(0x302)](_0x40a1bc(0x231),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x35f789[_0x40a1bc(0x302)]('Content-Type',_0x40a1bc(0x22d)),_0x35f789[_0x40a1bc(0x2a7)](_0x578c62);}else pdf[_0x40a1bc(0x2c5)](_0xf5f500,_0x5d1843)[_0x40a1bc(0x253)](function(_0x444cda,_0x2d0c96){const _0xc7afea=_0x40a1bc;if(_0x444cda){_0x35f789[_0xc7afea(0x1e7)](0x1f4)['send'](_0xc7afea(0x21d));return;}_0x35f789[_0xc7afea(0x302)](_0xc7afea(0x226),_0xc7afea(0x1a5)),_0x2d0c96[_0xc7afea(0x29b)](_0x35f789);});}),module[a0_0x5c3944(0x2d3)]=router;