const a0_0x4ca221=a0_0x1558;(function(_0x2547de,_0x3868e3){const _0x1751b9=a0_0x1558,_0x5dfe95=_0x2547de();while(!![]){try{const _0x5ba9cd=-parseInt(_0x1751b9(0x27a))/0x1*(parseInt(_0x1751b9(0x219))/0x2)+parseInt(_0x1751b9(0x179))/0x3+-parseInt(_0x1751b9(0x2b3))/0x4*(-parseInt(_0x1751b9(0x1eb))/0x5)+parseInt(_0x1751b9(0x2e2))/0x6+-parseInt(_0x1751b9(0x23a))/0x7+parseInt(_0x1751b9(0x2e1))/0x8+-parseInt(_0x1751b9(0x2a7))/0x9*(parseInt(_0x1751b9(0x230))/0xa);if(_0x5ba9cd===_0x3868e3)break;else _0x5dfe95['push'](_0x5dfe95['shift']());}catch(_0x2d1683){_0x5dfe95['push'](_0x5dfe95['shift']());}}}(a0_0x46f1,0x77551));const express=require(a0_0x4ca221(0x292)),res=require(a0_0x4ca221(0x180)),app=express(),router=express['Router'](),multer=require(a0_0x4ca221(0x23e)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x4ca221(0x164)),auth=require('../middleware/auth'),users=require(a0_0x4ca221(0x1c9)),excelJS=require(a0_0x4ca221(0x23b)),XLSX=require(a0_0x4ca221(0x2d5)),PDFDocument=require(a0_0x4ca221(0x2b1)),fs=require('fs'),blobStream=require(a0_0x4ca221(0x267)),JsBarcode=require('jsbarcode'),{Canvas}=require(a0_0x4ca221(0x210)),pdf=require(a0_0x4ca221(0x167)),path=require(a0_0x4ca221(0x2c1)),mongoose=require(a0_0x4ca221(0x263)),cheerio=require(a0_0x4ca221(0x198));router['get'](a0_0x4ca221(0x254),auth,async(_0x330c6b,_0x3979ef)=>{const _0x3a672d=a0_0x4ca221;try{const {username:_0x1cbbd4,email:_0x47fe98,role:_0x1551fd}=_0x330c6b[_0x3a672d(0x2b9)],_0x128eb1=_0x330c6b[_0x3a672d(0x2b9)],_0x28b322=await profile[_0x3a672d(0x1ff)]({'email':_0x128eb1[_0x3a672d(0x2eb)]}),_0x2952ed={'year':_0x3a672d(0x1e6),'month':'long','day':'numeric'},_0x4941ff=await master_shop[_0x3a672d(0x2b2)]();console[_0x3a672d(0x21d)](_0x3a672d(0x1d2),_0x4941ff);const _0x5c16d2=await product[_0x3a672d(0x2b2)]();console[_0x3a672d(0x21d)](_0x3a672d(0x273),_0x5c16d2);const _0x38a06d=await warehouse['aggregate']([{'$unwind':_0x3a672d(0x163)},{'$lookup':{'from':_0x3a672d(0x1f3),'localField':_0x3a672d(0x245),'foreignField':_0x3a672d(0x200),'as':_0x3a672d(0x201)}},{'$unwind':_0x3a672d(0x256)},{'$project':{'product_name':_0x3a672d(0x20c),'product_stock':_0x3a672d(0x1c5)}},{'$group':{'_id':_0x3a672d(0x173),'product_stock':{'$sum':_0x3a672d(0x23f)}}}]);console[_0x3a672d(0x21d)](_0x3a672d(0x276),_0x38a06d),_0x38a06d[_0x3a672d(0x290)](_0x35ae19=>{const _0x19154e=_0x5c16d2['map'](_0x49f73d=>{const _0x505d7c=a0_0x1558;_0x49f73d[_0x505d7c(0x200)]==_0x35ae19[_0x505d7c(0x213)]&&(_0x49f73d[_0x505d7c(0x287)]=parseInt(_0x49f73d[_0x505d7c(0x287)])+parseInt(_0x35ae19['product_stock']));});}),console[_0x3a672d(0x21d)](_0x3a672d(0x273),_0x5c16d2);if(_0x4941ff[0x0][_0x3a672d(0x196)]==_0x3a672d(0x2c6))var _0xf87021=users['English'];else{if(_0x4941ff[0x0][_0x3a672d(0x196)]==_0x3a672d(0x2de))var _0xf87021=users[_0x3a672d(0x2de)];else{if(_0x4941ff[0x0][_0x3a672d(0x196)]==_0x3a672d(0x1aa))var _0xf87021=users[_0x3a672d(0x1aa)];else{if(_0x4941ff[0x0][_0x3a672d(0x196)]==_0x3a672d(0x2e6))var _0xf87021=users[_0x3a672d(0x2e6)];else{if(_0x4941ff[0x0][_0x3a672d(0x196)]==_0x3a672d(0x26d))var _0xf87021=users['French'];else{if(_0x4941ff[0x0][_0x3a672d(0x196)]==_0x3a672d(0x195))var _0xf87021=users['Portuguese'];else{if(_0x4941ff[0x0][_0x3a672d(0x196)]==_0x3a672d(0x28e))var _0xf87021=users[_0x3a672d(0x28e)];else{if(_0x4941ff[0x0]['language']=='Arabic\x20(ae)')var _0xf87021=users[_0x3a672d(0x2a0)];}}}}}}}_0x3979ef[_0x3a672d(0x2c2)](_0x3a672d(0x1e2),{'success':_0x330c6b[_0x3a672d(0x26a)](_0x3a672d(0x1cc)),'errors':_0x330c6b['flash'](_0x3a672d(0x18f)),'alldata':_0x5c16d2,'profile':_0x28b322,'master_shop':_0x4941ff,'role':_0x128eb1,'product_stock':_0x38a06d,'language':_0xf87021});}catch(_0x5074a0){}});async function dataCheck(_0x1e3adc,_0x2ffc0b){const _0x582e6a=a0_0x4ca221,_0x37996b=await product[_0x582e6a(0x261)]([{'$group':{'_id':{'brand':_0x582e6a(0x1fc),'category':'$category'},'products':{'$push':{'name':_0x582e6a(0x2e7),'product_code':_0x582e6a(0x239)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x36197b=[];_0x36197b[_0x582e6a(0x2a2)]=[];for(let _0x3f4416=0x0;_0x3f4416<=_0x37996b[_0x582e6a(0x1a0)]-0x1;_0x3f4416++){const _0x18d89a=_0x37996b[_0x3f4416];_0x36197b['cat_brand']['push'](_0x18d89a);}const _0x43d22a=await product[_0x582e6a(0x261)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x582e6a(0x1fc),'product_code':'$product_code','product_name':_0x582e6a(0x2e7)}}}},{'$sort':{'_id.category':-0x1}}]),_0x752cf=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x1e3adc,'$lte':_0x2ffc0b}}},{'$unwind':'$product'},{'$group':{'_id':{'product_name':_0x582e6a(0x1c7),'product_code':_0x582e6a(0x1f5)},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x36197b['beg_bal']=[];for(let _0xe5aaf6=0x0;_0xe5aaf6<=_0x752cf[_0x582e6a(0x1a0)]-0x1;_0xe5aaf6++){const _0x1b208b=_0x752cf[_0xe5aaf6];_0x36197b['beg_bal']['push'](_0x1b208b);}const _0x2d3a8b=await sales_sa[_0x582e6a(0x261)]([{'$match':{'date':{'$gte':_0x1e3adc,'$lte':_0x2ffc0b}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x582e6a(0x255)}}},{'$lookup':{'from':_0x582e6a(0x1ce),'localField':_0x582e6a(0x1ea),'foreignField':'_id','as':_0x582e6a(0x22b)}},{'$unwind':_0x582e6a(0x1f6)},{'$unwind':_0x582e6a(0x1cd)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x582e6a(0x26b),'product_code':_0x582e6a(0x1ae)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console[_0x582e6a(0x21d)](_0x2d3a8b[0x0]),_0x36197b['sales_bkg']=[];for(let _0x11ccd0=0x0;_0x11ccd0<=_0x2d3a8b[_0x582e6a(0x1a0)]-0x1;_0x11ccd0++){const _0x131d9a=_0x2d3a8b[_0x11ccd0];_0x36197b[_0x582e6a(0x277)]['push'](_0x131d9a);}const _0xd29265=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x1e3adc,'$lte':_0x2ffc0b}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x582e6a(0x1ce),'localField':_0x582e6a(0x1ea),'foreignField':_0x582e6a(0x213),'as':'sales_info'}},{'$unwind':_0x582e6a(0x1f6)},{'$unwind':_0x582e6a(0x1cd)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x582e6a(0x250)}},{'$group':{'_id':{'product_name':_0x582e6a(0x26b),'product_code':_0x582e6a(0x1ae)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'}}}]);_0x36197b[_0x582e6a(0x2d8)]=[];for(let _0xa29de1=0x0;_0xa29de1<=_0xd29265[_0x582e6a(0x1a0)]-0x1;_0xa29de1++){const _0x3a4ba2=_0xd29265[_0xa29de1];_0x36197b[_0x582e6a(0x2d8)][_0x582e6a(0x2b8)](_0x3a4ba2);}let _0x35facd='';for(let _0x5d2889=0x0;_0x5d2889<=_0x43d22a[_0x582e6a(0x1a0)]-0x1;_0x5d2889++){const _0x21af98=_0x43d22a[_0x5d2889];_0x35facd+='<tr>',_0x35facd+=_0x582e6a(0x172)+_0x21af98[_0x582e6a(0x213)][_0x582e6a(0x22f)]+_0x582e6a(0x217),_0x35facd+=_0x582e6a(0x206);for(let _0x2dc703=0x0;_0x2dc703<_0x36197b[_0x582e6a(0x2a2)][_0x582e6a(0x1a0)];_0x2dc703++){const _0x365244=_0x36197b['cat_brand'][_0x2dc703];if(_0x365244[_0x582e6a(0x213)][_0x582e6a(0x22f)]==_0x21af98[_0x582e6a(0x213)][_0x582e6a(0x22f)]){let _0x3538da=[],_0x1661f2=[],_0x1cb716=[];_0x3538da[_0x365244[_0x582e6a(0x213)][_0x582e6a(0x24a)]]=[],_0x1661f2[_0x365244[_0x582e6a(0x213)][_0x582e6a(0x24a)]]=[],_0x1cb716[_0x365244[_0x582e6a(0x213)][_0x582e6a(0x24a)]]=[];var _0x5bf160=0x0,_0x1510e4=0x0,_0x553057=0x0;for(let _0x22cbdc=0x0;_0x22cbdc<_0x365244[_0x582e6a(0x1f3)][_0x582e6a(0x1a0)];_0x22cbdc++){const _0x4b7400=_0x365244[_0x582e6a(0x1f3)][_0x22cbdc];for(let _0x2bfc02=0x0;_0x2bfc02<=_0x36197b['beg_bal'][_0x582e6a(0x1a0)]-0x1;_0x2bfc02++){const _0x223cbf=_0x36197b[_0x582e6a(0x1f0)][_0x2bfc02];_0x223cbf[_0x582e6a(0x213)]['product_name']==_0x4b7400[_0x582e6a(0x200)]&&_0x223cbf[_0x582e6a(0x213)][_0x582e6a(0x1a9)]==_0x4b7400[_0x582e6a(0x1a9)]&&(_0x5bf160+=parseInt(_0x223cbf[_0x582e6a(0x193)],0xa));}for(let _0x230c41=0x0;_0x230c41<=_0x36197b[_0x582e6a(0x2d8)][_0x582e6a(0x1a0)]-0x1;_0x230c41++){const _0xcb407d=_0x36197b[_0x582e6a(0x2d8)][_0x230c41];_0xcb407d[_0x582e6a(0x213)][_0x582e6a(0x18d)]==_0x4b7400['name']&&_0xcb407d[_0x582e6a(0x213)][_0x582e6a(0x1a9)]==_0x4b7400[_0x582e6a(0x1a9)]&&(_0x1510e4+=parseFloat(_0xcb407d[_0x582e6a(0x193)],0xa)[_0x582e6a(0x2b0)](0x2));}for(let _0x1cccee=0x0;_0x1cccee<=_0x36197b[_0x582e6a(0x277)][_0x582e6a(0x1a0)]-0x1;_0x1cccee++){const _0x2cf8cd=_0x36197b[_0x582e6a(0x277)][_0x1cccee];_0x2cf8cd[_0x582e6a(0x213)][_0x582e6a(0x18d)]==_0x4b7400[_0x582e6a(0x200)]&&_0x2cf8cd[_0x582e6a(0x213)]['product_code']==_0x4b7400[_0x582e6a(0x1a9)]&&(_0x553057+=parseInt(_0x2cf8cd['totalQTY'],0xa));}}const _0x188997=new Intl['NumberFormat'](_0x582e6a(0x289));var _0x4e6aba=_0x188997[_0x582e6a(0x204)](_0x5bf160);_0x3538da[_0x365244['_id']['brand']][_0x582e6a(0x2b8)](_0x4e6aba),_0x1661f2[_0x365244['_id'][_0x582e6a(0x24a)]][_0x582e6a(0x2b8)](_0x188997['format'](_0x1510e4)),_0x1cb716[_0x365244[_0x582e6a(0x213)]['brand']][_0x582e6a(0x2b8)](_0x188997[_0x582e6a(0x204)](_0x553057));var _0x43006e=_0x188997['format'](_0x5bf160-(_0x553057+_0x1510e4));_0x35facd+=_0x582e6a(0x188),_0x35facd+=_0x582e6a(0x24f),_0x35facd+=_0x582e6a(0x20a)+_0x365244[_0x582e6a(0x213)][_0x582e6a(0x24a)]+_0x582e6a(0x217),_0x35facd+=_0x582e6a(0x20a)+_0x3538da[_0x365244['_id']['brand']][0x0]+_0x582e6a(0x217),_0x35facd+=_0x582e6a(0x2db),_0x35facd+=_0x582e6a(0x20a)+_0x1cb716[_0x365244['_id'][_0x582e6a(0x24a)]][0x0]+_0x582e6a(0x217),_0x35facd+=_0x582e6a(0x20a)+_0x1661f2[_0x365244[_0x582e6a(0x213)][_0x582e6a(0x24a)]][0x0]+_0x582e6a(0x217),_0x35facd+=_0x582e6a(0x20a)+_0x43006e+_0x582e6a(0x217),_0x35facd+=_0x582e6a(0x206);}}}return console[_0x582e6a(0x21d)](_0x36197b[_0x582e6a(0x277)]),_0x35facd;}router[a0_0x4ca221(0x1da)](a0_0x4ca221(0x214),auth,async(_0x5dbc76,_0x4e6fad)=>{const _0x5fb191=a0_0x4ca221,{from_date:_0x27cbd2,to_date:_0x291ad5}=_0x5dbc76[_0x5fb191(0x271)],_0x41bacd=await dataCheck(_0x27cbd2,_0x291ad5);{}let _0x5edf9f=_0x5fb191(0x2ac);var _0x293889=new Date(_0x27cbd2),_0xa8c457=new Date(_0x291ad5);const _0x17d646={'year':_0x5fb191(0x1e6),'month':_0x5fb191(0x19d),'day':_0x5fb191(0x1e6)},_0x4bf46e=new Intl[(_0x5fb191(0x183))](_0x5fb191(0x289),_0x17d646)[_0x5fb191(0x204)](_0x293889),_0x3ef902=new Intl[(_0x5fb191(0x183))]('en-US',_0x17d646)[_0x5fb191(0x204)](_0xa8c457);_0x5edf9f+=_0x5fb191(0x2c4),_0x5edf9f+=_0x5fb191(0x1d9),_0x5edf9f+=_0x5fb191(0x178)+_0x4bf46e+_0x5fb191(0x262)+_0x3ef902+_0x5fb191(0x2d6),_0x5edf9f+=_0x5fb191(0x1ad),_0x5edf9f+=_0x5fb191(0x1bd),_0x5edf9f+='<table>',_0x5edf9f+='<tr>',_0x5edf9f+=_0x5fb191(0x18e),_0x5edf9f+=_0x5fb191(0x2a5),_0x5edf9f+=_0x5fb191(0x17a)+_0x4bf46e+_0x5fb191(0x197),_0x5edf9f+=_0x5fb191(0x275),_0x5edf9f+=_0x5fb191(0x291),_0x5edf9f+=_0x5fb191(0x207)+_0x3ef902+'</th>',_0x5edf9f+=_0x5fb191(0x206),_0x5edf9f+=_0x5fb191(0x188),_0x5edf9f+='<th>Booking</th>',_0x5edf9f+=_0x5fb191(0x1a8),_0x5edf9f+=_0x5fb191(0x206),_0x5edf9f+=_0x41bacd,_0x5edf9f+=_0x5fb191(0x1d4),_0x5edf9f+=_0x5fb191(0x1ac),_0x5edf9f+='</div>';const _0x299d2d={'format':'Letter','orientation':_0x5fb191(0x166),'childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf[_0x5fb191(0x1cf)](_0x5edf9f,_0x299d2d)[_0x5fb191(0x1f4)](function(_0x3980b8,_0x569d29){const _0x40812a=_0x5fb191;if(_0x3980b8){_0x4e6fad[_0x40812a(0x284)](0x1f4)[_0x40812a(0x17c)](_0x40812a(0x2b5));return;}_0x4e6fad['setHeader'](_0x40812a(0x1be),_0x40812a(0x243)),_0x569d29[_0x40812a(0x268)](_0x4e6fad);});}),router[a0_0x4ca221(0x1f9)](a0_0x4ca221(0x19f),auth,async(_0x320f0e,_0x3524cb)=>{const _0x48026b=a0_0x4ca221;try{const {username:_0x36dc0b,email:_0x474729,role:_0x3160c9}=_0x320f0e[_0x48026b(0x2b9)],_0x29080e=_0x320f0e[_0x48026b(0x2b9)],_0x44f9c3=await profile[_0x48026b(0x1ff)]({'email':_0x29080e[_0x48026b(0x2eb)]}),_0x4a0a08={'year':_0x48026b(0x1e6),'month':_0x48026b(0x19d),'day':_0x48026b(0x1e6)},_0x18eabc=await master_shop[_0x48026b(0x2b2)](),_0x222c10=await product['find'](),_0x3abc71=await warehouse[_0x48026b(0x261)]([{'$unwind':_0x48026b(0x163)},{'$lookup':{'from':_0x48026b(0x1f3),'localField':_0x48026b(0x245),'foreignField':'name','as':_0x48026b(0x201)}},{'$unwind':_0x48026b(0x256)},{'$project':{'product_name':_0x48026b(0x20c),'product_stock':_0x48026b(0x1c5)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x48026b(0x23f)}}}]);if(_0x18eabc[0x0][_0x48026b(0x196)]==_0x48026b(0x2c6))var _0x28cfb8=users[_0x48026b(0x246)];else{if(_0x18eabc[0x0]['language']==_0x48026b(0x2de))var _0x28cfb8=users[_0x48026b(0x2de)];else{if(_0x18eabc[0x0][_0x48026b(0x196)]==_0x48026b(0x1aa))var _0x28cfb8=users[_0x48026b(0x1aa)];else{if(_0x18eabc[0x0]['language']==_0x48026b(0x2e6))var _0x28cfb8=users[_0x48026b(0x2e6)];else{if(_0x18eabc[0x0][_0x48026b(0x196)]==_0x48026b(0x26d))var _0x28cfb8=users[_0x48026b(0x26d)];else{if(_0x18eabc[0x0][_0x48026b(0x196)]=='Portuguese\x20(BR)')var _0x28cfb8=users[_0x48026b(0x1a7)];else{if(_0x18eabc[0x0][_0x48026b(0x196)]==_0x48026b(0x28e))var _0x28cfb8=users['Chinese'];else{if(_0x18eabc[0x0]['language']=='Arabic\x20(ae)')var _0x28cfb8=users[_0x48026b(0x2a0)];}}}}}}}_0x3524cb[_0x48026b(0x2c2)](_0x48026b(0x192),{'success':_0x320f0e[_0x48026b(0x26a)]('success'),'errors':_0x320f0e['flash'](_0x48026b(0x18f)),'alldata':_0x222c10,'profile':_0x44f9c3,'master_shop':_0x18eabc,'role':_0x29080e,'product_stock':_0x3abc71,'language':_0x28cfb8});}catch(_0x30266c){}});async function agentsdataCheck(_0x43afac,_0x247042){const _0x274539=a0_0x4ca221,_0x140384=await product[_0x274539(0x261)]([{'$group':{'_id':{'brand':_0x274539(0x1fc),'category':_0x274539(0x265)},'products':{'$push':{'name':_0x274539(0x2e7),'product_code':_0x274539(0x239)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x171d99=[];_0x171d99['cat_brand']=[];for(let _0x212adc=0x0;_0x212adc<=_0x140384['length']-0x1;_0x212adc++){const _0xbdcf7d=_0x140384[_0x212adc];_0x171d99[_0x274539(0x2a2)][_0x274539(0x2b8)](_0xbdcf7d);}const _0x54287e=await product[_0x274539(0x261)]([{'$group':{'_id':{'category':_0x274539(0x265)},'products':{'$push':{'brand':_0x274539(0x1fc),'product_code':_0x274539(0x239),'product_name':_0x274539(0x2e7)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3172f5=await product[_0x274539(0x261)]([{'$group':{'_id':{'category':'$category','brand':_0x274539(0x1fc)}}},{'$group':{'_id':_0x274539(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xc5aaf6=await sales_sa[_0x274539(0x261)]([{'$match':{'date':{'$gte':_0x43afac,'$lte':_0x247042}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x274539(0x255)}}},{'$lookup':{'from':_0x274539(0x1ce),'localField':_0x274539(0x1ea),'foreignField':_0x274539(0x213),'as':'sales_info'}},{'$unwind':_0x274539(0x1f6)},{'$unwind':_0x274539(0x1cd)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x274539(0x250)}},{'$lookup':{'from':_0x274539(0x1f3),'localField':'sale_product.product_code','foreignField':_0x274539(0x1a9),'as':_0x274539(0x22c)}},{'$unwind':_0x274539(0x19a)},{'$group':{'_id':{'sales_id':_0x274539(0x1c6),'category':_0x274539(0x2e9),'brand':_0x274539(0x298)},'salesman_data':{'$first':_0x274539(0x20d)},'totalQTY':{'$sum':_0x274539(0x1df)},'products':{'$push':{'qty':_0x274539(0x1df),'product_details':{'prod_name':_0x274539(0x279),'product_code':_0x274539(0x2a3),'category':_0x274539(0x2e9),'brand':'$product_info.brand'}}}}}]);let _0x5612e8='';_0x5612e8+=_0x274539(0x188),_0x5612e8+='<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x5612e8+='</tr>',_0x5612e8+='<tr>',_0x5612e8+=_0x274539(0x28f);for(let _0x13cf0e=0x0;_0x13cf0e<=_0x54287e['length']-0x1;_0x13cf0e++){const _0x33d208=_0x54287e[_0x13cf0e];for(let _0x5b7d16=0x0;_0x5b7d16<_0x3172f5[_0x274539(0x1a0)];_0x5b7d16++){const _0x5a8313=_0x3172f5[_0x5b7d16];_0x5a8313[_0x274539(0x213)]==_0x33d208[_0x274539(0x213)][_0x274539(0x22f)]&&(_0x5612e8+=_0x274539(0x232)+_0x5a8313[_0x274539(0x1e8)]+'\x22\x20class=\x22cat_data\x22>'+_0x33d208[_0x274539(0x213)][_0x274539(0x22f)]+_0x274539(0x217));}}_0x5612e8+=_0x274539(0x28f),_0x5612e8+='</tr>',_0x5612e8+='<tr>',_0x5612e8+=_0x274539(0x1b2);for(let _0x46b5b2=0x0;_0x46b5b2<=_0x54287e[_0x274539(0x1a0)]-0x1;_0x46b5b2++){const _0x5a30fc=_0x54287e[_0x46b5b2];for(let _0x436d33=0x0;_0x436d33<_0x171d99[_0x274539(0x2a2)][_0x274539(0x1a0)];_0x436d33++){const _0x2cd7af=_0x171d99['cat_brand'][_0x436d33];_0x2cd7af['_id'][_0x274539(0x22f)]==_0x5a30fc[_0x274539(0x213)]['category']&&(_0x5612e8+=_0x274539(0x215)+_0x2cd7af[_0x274539(0x213)][_0x274539(0x24a)]+_0x274539(0x217));}}_0x5612e8+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x5612e8+=_0x274539(0x206);let _0x1db63b={'name':[],'dataqty':{}};for(let _0x46cf31=0x0;_0x46cf31<_0x171d99[_0x274539(0x2a2)][_0x274539(0x1a0)];_0x46cf31++){const _0x1954a3=_0x171d99['cat_brand'][_0x46cf31],_0x2b775e=_0x1954a3['_id']['brand'],_0x33316c=_0x1954a3[_0x274539(0x213)][_0x274539(0x22f)];!_0x1db63b[_0x274539(0x2ad)][_0x2b775e]&&(_0x1db63b[_0x274539(0x2ad)][_0x2b775e]={});!_0x1db63b[_0x274539(0x2ad)][_0x2b775e][_0x33316c]&&(_0x1db63b[_0x274539(0x2ad)][_0x2b775e][_0x33316c]=[]);for(let _0x2b1df5=0x0;_0x2b1df5<_0xc5aaf6[_0x274539(0x1a0)];_0x2b1df5++){const _0x3b60ea=_0xc5aaf6[_0x2b1df5];if(_0x2b775e===_0x3b60ea[_0x274539(0x213)][_0x274539(0x24a)]&&_0x33316c===_0x3b60ea[_0x274539(0x213)][_0x274539(0x22f)]){const _0x12d63c=_0x3b60ea[_0x274539(0x294)];!_0x1db63b[_0x274539(0x2ad)][_0x2b775e][_0x33316c][_0x12d63c]&&(_0x1db63b[_0x274539(0x2ad)][_0x2b775e][_0x33316c][_0x12d63c]=[]),_0x1db63b[_0x274539(0x2ad)][_0x2b775e][_0x33316c][_0x12d63c][_0x274539(0x2b8)](_0x3b60ea[_0x274539(0x193)]),!_0x1db63b['name']['includes'](_0x12d63c)&&_0x1db63b[_0x274539(0x200)][_0x274539(0x2b8)](_0x12d63c);}}}_0x5612e8+=_0x274539(0x188);for(let _0x59e617=0x0;_0x59e617<=_0x1db63b[_0x274539(0x200)]['length']-0x1;_0x59e617++){const _0x52662c=_0x1db63b[_0x274539(0x200)][_0x59e617];_0x5612e8+=_0x274539(0x20a)+_0x52662c+_0x274539(0x217);var _0x2aa323=0x0,_0x31ac30=0x0;for(let _0x1d3994=0x0;_0x1d3994<=_0x171d99[_0x274539(0x2a2)]['length']-0x1;_0x1d3994++){const _0x5e9aed=_0x171d99[_0x274539(0x2a2)][_0x1d3994];var _0x24af3f=0x0;_0x1db63b[_0x274539(0x2ad)][_0x5e9aed[_0x274539(0x213)]['brand']][_0x5e9aed['_id']['category']][_0x52662c]?(_0x24af3f=_0x1db63b[_0x274539(0x2ad)][_0x5e9aed[_0x274539(0x213)][_0x274539(0x24a)]][_0x5e9aed[_0x274539(0x213)][_0x274539(0x22f)]][_0x52662c][0x0],_0x5612e8+=_0x274539(0x20a)+formatNumber(_0x24af3f['toFixed'](0x2))+_0x274539(0x217)):(_0x24af3f=0x0,_0x5612e8+=_0x274539(0x20a)+_0x24af3f+_0x274539(0x217)),_0x2aa323+=_0x24af3f;}_0x5612e8+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x2aa323[_0x274539(0x2b0)](0x2))+_0x274539(0x217);}return _0x5612e8+=_0x274539(0x206),_0x5612e8;}router[a0_0x4ca221(0x1da)](a0_0x4ca221(0x25d),auth,async(_0x5eb2f1,_0x439c24)=>{const _0x23ec9d=a0_0x4ca221,{from_date:_0x1744f9,to_date:_0x4ebc0f}=_0x5eb2f1[_0x23ec9d(0x271)],_0x15dcdd=await agentsdataCheck(_0x1744f9,_0x4ebc0f);{}let _0x19b2dd='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x1663b2=new Date(_0x1744f9),_0x5e3c3f=new Date(_0x4ebc0f);const _0x46c0b0={'year':'numeric','month':_0x23ec9d(0x19d),'day':_0x23ec9d(0x1e6)},_0x3ab1f8=new Intl[(_0x23ec9d(0x183))]('en-US',_0x46c0b0)[_0x23ec9d(0x204)](_0x1663b2),_0x97d1e8=new Intl[(_0x23ec9d(0x183))]('en-US',_0x46c0b0)['format'](_0x5e3c3f);_0x19b2dd+=_0x23ec9d(0x2c4),_0x19b2dd+='<p>SALES\x20REPORTS</p>',_0x19b2dd+=_0x23ec9d(0x178)+_0x3ab1f8+_0x23ec9d(0x262)+_0x97d1e8+_0x23ec9d(0x2d6),_0x19b2dd+=_0x23ec9d(0x1ad),_0x19b2dd+=_0x23ec9d(0x1bd),_0x19b2dd+='<table>',_0x19b2dd+=_0x15dcdd,_0x19b2dd+=_0x23ec9d(0x1d4),_0x19b2dd+=_0x23ec9d(0x1ac),_0x19b2dd+='</div>';const _0x445f77={'format':_0x23ec9d(0x1e7),'orientation':_0x23ec9d(0x166),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x23ec9d(0x29c)}}};pdf[_0x23ec9d(0x1cf)](_0x19b2dd,_0x445f77)[_0x23ec9d(0x1f4)](function(_0x303a7a,_0x14d37b){const _0xa1c651=_0x23ec9d;if(_0x303a7a){_0x439c24['status'](0x1f4)[_0xa1c651(0x17c)](_0xa1c651(0x2b5));return;}_0x439c24[_0xa1c651(0x2b6)]('Content-Type',_0xa1c651(0x243)),_0x14d37b['pipe'](_0x439c24);});}),router['get'](a0_0x4ca221(0x2ab),auth,async(_0x258592,_0x5b4924)=>{const _0x3dd30=a0_0x4ca221;try{const {username:_0x4a6055,email:_0x453a25,role:_0x2c7bd2}=_0x258592[_0x3dd30(0x2b9)],_0x3c1ab0=_0x258592[_0x3dd30(0x2b9)],_0x526090=await profile['findOne']({'email':_0x3c1ab0[_0x3dd30(0x2eb)]}),_0xb67dc2={'year':_0x3dd30(0x1e6),'month':_0x3dd30(0x19d),'day':_0x3dd30(0x1e6)},_0x4e69ea=await master_shop[_0x3dd30(0x2b2)](),_0x583fa7=await staff[_0x3dd30(0x1ff)]({'email':_0x3c1ab0[_0x3dd30(0x2eb)]}),_0x310dcf=await product['find'](),_0x10b56f=await warehouse['aggregate']([{'$unwind':_0x3dd30(0x163)},{'$lookup':{'from':_0x3dd30(0x1f3),'localField':'product_details.product_name','foreignField':_0x3dd30(0x200),'as':_0x3dd30(0x201)}},{'$unwind':_0x3dd30(0x256)},{'$project':{'product_name':_0x3dd30(0x20c),'product_stock':_0x3dd30(0x1c5)}},{'$group':{'_id':_0x3dd30(0x173),'product_stock':{'$sum':_0x3dd30(0x23f)}}}]),_0x504740=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x4e69ea[0x0][_0x3dd30(0x196)]==_0x3dd30(0x2c6))var _0x15cb38=users[_0x3dd30(0x246)];else{if(_0x4e69ea[0x0][_0x3dd30(0x196)]=='Hindi')var _0x15cb38=users[_0x3dd30(0x2de)];else{if(_0x4e69ea[0x0]['language']==_0x3dd30(0x1aa))var _0x15cb38=users[_0x3dd30(0x1aa)];else{if(_0x4e69ea[0x0][_0x3dd30(0x196)]=='Spanish')var _0x15cb38=users[_0x3dd30(0x2e6)];else{if(_0x4e69ea[0x0][_0x3dd30(0x196)]==_0x3dd30(0x26d))var _0x15cb38=users[_0x3dd30(0x26d)];else{if(_0x4e69ea[0x0][_0x3dd30(0x196)]=='Portuguese\x20(BR)')var _0x15cb38=users[_0x3dd30(0x1a7)];else{if(_0x4e69ea[0x0][_0x3dd30(0x196)]==_0x3dd30(0x28e))var _0x15cb38=users['Chinese'];else{if(_0x4e69ea[0x0][_0x3dd30(0x196)]=='Arabic\x20(ae)')var _0x15cb38=users[_0x3dd30(0x2a0)];}}}}}}}_0x5b4924[_0x3dd30(0x2c2)]('dsi_sales_admin',{'success':_0x258592[_0x3dd30(0x26a)](_0x3dd30(0x1cc)),'errors':_0x258592[_0x3dd30(0x26a)](_0x3dd30(0x18f)),'alldata':_0x310dcf,'profile':_0x526090,'master_shop':_0x4e69ea,'role':_0x3c1ab0,'product_stock':_0x10b56f,'language':_0x15cb38,'staff_arr':_0x583fa7,'staff_data_all':_0x504740});}catch(_0x37e02a){_0x5b4924[_0x3dd30(0x211)](_0x37e02a);}});async function agentsdataDSICheck_admin(_0x36fd10,_0xaaa7f1,_0x866451,_0x2ffe5f){const _0x35c9e2=a0_0x4ca221,_0x3e6341=await product[_0x35c9e2(0x261)]([{'$group':{'_id':{'brand':_0x35c9e2(0x1fc),'category':_0x35c9e2(0x265)},'products':{'$push':{'name':_0x35c9e2(0x2e7),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2f704e=[];_0x2f704e['cat_brand']=[];for(let _0xc22955=0x0;_0xc22955<=_0x3e6341[_0x35c9e2(0x1a0)]-0x1;_0xc22955++){const _0x3c0436=_0x3e6341[_0xc22955];_0x2f704e['cat_brand'][_0x35c9e2(0x2b8)](_0x3c0436);}const _0x443b1c=await product[_0x35c9e2(0x261)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x35c9e2(0x1fc),'product_code':'$product_code','product_name':_0x35c9e2(0x2e7)}}}},{'$sort':{'_id.category':-0x1}}]),_0x280626=await product[_0x35c9e2(0x261)]([{'$group':{'_id':{'category':_0x35c9e2(0x265),'brand':'$brand'}}},{'$group':{'_id':_0x35c9e2(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1af449=await sales_sa[_0x35c9e2(0x261)]([{'$match':{'date':{'$gte':_0x36fd10,'$lte':_0xaaa7f1},'sales_staff_id':_0x866451,'sale_product.isFG':'false'}},{'$unwind':_0x35c9e2(0x1cd)},{'$match':{'sale_product.isFG':_0x35c9e2(0x250)}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0x35c9e2(0x1a9),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x35c9e2(0x1df)},'products':{'$push':{'qty':_0x35c9e2(0x1df),'NetPrice':_0x35c9e2(0x19c),'discount':_0x35c9e2(0x1e9),'adj_discount':_0x35c9e2(0x249),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x35c9e2(0x2e9),'brand':_0x35c9e2(0x298),'gross_price':_0x35c9e2(0x281)}}}}},{'$unwind':_0x35c9e2(0x22d)},{'$group':{'_id':{'dsi':_0x35c9e2(0x2ca),'date':'$_id.date','customer':'$_id.customer','category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x35c9e2(0x2c7)},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x35c9e2(0x1a2)},'discount':{'$sum':_0x35c9e2(0x1e0)},'adj_discount':{'$sum':_0x35c9e2(0x161)},'product_details':{'$first':_0x35c9e2(0x27c)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x35c9e2(0x1bf),'customer':_0x35c9e2(0x174)},'totalQty':{'$sum':_0x35c9e2(0x1f7)},'totalGross':{'$sum':_0x35c9e2(0x191)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x35c9e2(0x2a6)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x35c9e2(0x1f7),'category':_0x35c9e2(0x1b0),'brand':_0x35c9e2(0x237),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x22e5c6=[],_0x597cd4={},_0x32357c={},_0x3ed901={};var _0x36fca2=0x0,_0x371ab0=0x0,_0x4dccd7=0x0,_0x7046c=0x0,_0x2b2097=0x0;const _0x239907=0x6;for(let _0x289185=0x0;_0x289185<=_0x1af449[_0x35c9e2(0x1a0)]-0x1;_0x289185++){const _0x223693=_0x1af449[_0x289185];let _0x3e4c41='<tr>';_0x3e4c41+=_0x35c9e2(0x20e)+_0x223693[_0x35c9e2(0x213)]['dsi']+_0x35c9e2(0x217),_0x3e4c41+=_0x35c9e2(0x20e)+_0x223693[_0x35c9e2(0x213)]['date']+_0x35c9e2(0x217),_0x3e4c41+=_0x35c9e2(0x20e)+_0x223693['_id']['customer']+_0x35c9e2(0x217);let _0x5a63f3={};var _0x199399=0x0;for(let _0x261f89=0x0;_0x261f89<=_0x223693[_0x35c9e2(0x1f3)][_0x35c9e2(0x1a0)]-0x1;_0x261f89++){const _0xfffecd=_0x223693[_0x35c9e2(0x1f3)][_0x261f89];_0x5a63f3[_0xfffecd[_0x35c9e2(0x24a)]+'-'+_0xfffecd[_0x35c9e2(0x22f)]]=_0xfffecd[_0x35c9e2(0x1fd)];const _0xb9aa4b=_0xfffecd[_0x35c9e2(0x24a)]+'-'+_0xfffecd[_0x35c9e2(0x22f)];!_0x597cd4[_0xb9aa4b]&&(_0x597cd4[_0xb9aa4b]=0x0),!Array['isArray'](_0x3ed901[_0xb9aa4b])&&(_0x3ed901[_0xb9aa4b]=[]),!Array[_0x35c9e2(0x241)](_0x3ed901[_0xb9aa4b])&&(_0x3ed901[_0xb9aa4b]=[]),_0x597cd4[_0xb9aa4b]+=_0xfffecd[_0x35c9e2(0x1fd)],_0x3ed901[_0xb9aa4b][_0x35c9e2(0x2b8)](_0xfffecd[_0x35c9e2(0x1fd)]),_0x199399++;}console[_0x35c9e2(0x21d)](_0x223693);for(let _0xfceb6f=0x0;_0xfceb6f<=_0x2f704e[_0x35c9e2(0x2a2)][_0x35c9e2(0x1a0)]-0x1;_0xfceb6f++){const _0x326ef6=_0x2f704e[_0x35c9e2(0x2a2)][_0xfceb6f],_0x30e79f=_0x326ef6[_0x35c9e2(0x213)][_0x35c9e2(0x24a)]+'-'+_0x326ef6[_0x35c9e2(0x213)][_0x35c9e2(0x22f)];_0x3e4c41+=_0x35c9e2(0x253)+(_0x5a63f3[_0x30e79f]!==undefined?_0x5a63f3[_0x30e79f]['toFixed'](0x2):'')+'</td>';}_0x4dccd7=_0x223693[_0x35c9e2(0x218)]+_0x223693['adj_discount'],_0x3e4c41+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x223693['totalQty'],0x2)[_0x35c9e2(0x2b0)](0x2))+_0x35c9e2(0x217),_0x3e4c41+=_0x35c9e2(0x162)+formatNumber(_0x223693[_0x35c9e2(0x16d)][_0x35c9e2(0x2b0)](0x2))+_0x35c9e2(0x217),_0x3e4c41+=_0x35c9e2(0x162)+formatNumber(_0x4dccd7)+_0x35c9e2(0x217),_0x3e4c41+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x223693[_0x35c9e2(0x247)][_0x35c9e2(0x2b0)](0x2))+_0x35c9e2(0x217),_0x3e4c41+=_0x35c9e2(0x206),_0x36fca2+=parseFloat(_0x223693[_0x35c9e2(0x23d)]['toFixed'](0x2)),_0x371ab0+=parseFloat(_0x223693['NetPrice'][_0x35c9e2(0x2b0)](0x2)),_0x7046c+=_0x4dccd7,_0x2b2097+=parseFloat(_0x223693['totalGross'][_0x35c9e2(0x2b0)](0x2));if(_0x289185==_0x1af449[_0x35c9e2(0x1a0)]-0x1){_0x3e4c41+=_0x35c9e2(0x188),_0x3e4c41+=_0x35c9e2(0x293),_0x3e4c41+='</td>';for(let _0xc5c3ed=0x0;_0xc5c3ed<=_0x2f704e['cat_brand'][_0x35c9e2(0x1a0)]-0x1;_0xc5c3ed++){const _0x255917=_0x2f704e[_0x35c9e2(0x2a2)][_0xc5c3ed],_0x9e9f97=_0x255917[_0x35c9e2(0x213)][_0x35c9e2(0x24a)]+'-'+_0x255917[_0x35c9e2(0x213)][_0x35c9e2(0x22f)],_0x2e37fc=_0x3ed901[_0x9e9f97][_0x35c9e2(0x1ca)]((_0x1fa2da,_0x3969da)=>_0x1fa2da+_0x3969da,0x0);console['log']('test',_0x9e9f97),_0x3e4c41+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x2e37fc!==undefined?formatNumber(_0x2e37fc[_0x35c9e2(0x2b0)](0x2)):'')+_0x35c9e2(0x2bd),console[_0x35c9e2(0x21d)](_0x3ed901[_0x9e9f97][_0x35c9e2(0x1ca)]((_0x2e9a6c,_0x562c0e)=>_0x2e9a6c+_0x562c0e,0x0));}_0x3e4c41+=_0x35c9e2(0x1d8)+formatNumber(_0x36fca2[_0x35c9e2(0x2b0)](0x2))+_0x35c9e2(0x2bd),_0x3e4c41+=_0x35c9e2(0x1d8)+formatNumber(_0x2b2097)+_0x35c9e2(0x2bd),_0x3e4c41+=_0x35c9e2(0x1d8)+formatNumber(_0x7046c)+_0x35c9e2(0x2bd),_0x3e4c41+=_0x35c9e2(0x1d8)+formatNumber(_0x371ab0)+'</b></td>',_0x3e4c41+='</tr>';}_0x22e5c6['push'](_0x3e4c41);}function _0x1935ba(_0x36e9a7,_0x1fbf0c){const _0x11161a=_0x35c9e2,_0x27666c=[];for(let _0x4d5706=0x0;_0x4d5706<=_0x36e9a7[_0x11161a(0x1a0)]-0x1;_0x4d5706+=_0x1fbf0c){_0x27666c[_0x11161a(0x2b8)](_0x36e9a7[_0x11161a(0x1a1)](_0x4d5706,_0x4d5706+_0x1fbf0c));}return _0x27666c;}const _0x3b5d89=_0x1935ba(_0x22e5c6,_0x239907);let _0xee7b20='';return _0x3b5d89[_0x35c9e2(0x290)]((_0x15c7f9,_0x97db8d)=>{const _0x829f91=_0x35c9e2;_0x97db8d>0x0&&(_0xee7b20+=_0x829f91(0x2d7));_0xee7b20+=_0x829f91(0x1af),_0xee7b20+='<thead>',_0xee7b20+=_0x829f91(0x188),_0xee7b20+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0xee7b20+=_0x829f91(0x206),_0xee7b20+=_0x829f91(0x188),_0xee7b20+=_0x829f91(0x280);for(let _0x2e27d1=0x0;_0x2e27d1<=_0x443b1c[_0x829f91(0x1a0)]-0x1;_0x2e27d1++){const _0x170940=_0x443b1c[_0x2e27d1];for(let _0x3dbffe=0x0;_0x3dbffe<_0x280626[_0x829f91(0x1a0)];_0x3dbffe++){const _0xfdcc7a=_0x280626[_0x3dbffe];_0xfdcc7a[_0x829f91(0x213)]===_0x170940[_0x829f91(0x213)][_0x829f91(0x22f)]&&(_0xee7b20+=_0x829f91(0x232)+_0xfdcc7a[_0x829f91(0x1e8)]+_0x829f91(0x27b)+_0x170940[_0x829f91(0x213)][_0x829f91(0x22f)]+_0x829f91(0x217));}}_0xee7b20+=_0x829f91(0x2c8),_0xee7b20+='</tr>',_0xee7b20+='<tr>',_0xee7b20+=_0x829f91(0x20b),_0xee7b20+=_0x829f91(0x258),_0xee7b20+=_0x829f91(0x190);for(let _0x4371c5=0x0;_0x4371c5<=_0x443b1c[_0x829f91(0x1a0)]-0x1;_0x4371c5++){const _0x31c202=_0x443b1c[_0x4371c5];for(let _0x4189af=0x0;_0x4189af<_0x2f704e['cat_brand']['length'];_0x4189af++){const _0x55e3d8=_0x2f704e[_0x829f91(0x2a2)][_0x4189af];_0x55e3d8['_id']['category']===_0x31c202['_id']['category']&&(_0xee7b20+=_0x829f91(0x215)+_0x55e3d8['_id'][_0x829f91(0x24a)]+'</td>');}}_0xee7b20+=_0x829f91(0x2cd),_0xee7b20+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0xee7b20+=_0x829f91(0x208),_0xee7b20+=_0x829f91(0x1ec),_0xee7b20+=_0x829f91(0x206),_0xee7b20+=_0x829f91(0x15f),_0xee7b20+=_0x829f91(0x18a),_0x15c7f9[_0x829f91(0x290)](_0x5edde1=>{_0xee7b20+=_0x5edde1;}),console[_0x829f91(0x21d)](_0x3ed901),_0xee7b20+=_0x829f91(0x1cb),_0xee7b20+='</table>';}),_0xee7b20;}function a0_0x1558(_0x4c7936,_0x586831){const _0x46f1ad=a0_0x46f1();return a0_0x1558=function(_0x155854,_0x46ab14){_0x155854=_0x155854-0x15e;let _0x26ef4f=_0x46f1ad[_0x155854];return _0x26ef4f;},a0_0x1558(_0x4c7936,_0x586831);}async function agentsdataDSICheck_admin_excel(_0x488193,_0x397f3e,_0x4506c3,_0x21ba3d){const _0x58ac71=a0_0x4ca221,_0xba53b7=await product[_0x58ac71(0x261)]([{'$group':{'_id':{'brand':_0x58ac71(0x1fc),'category':'$category'},'products':{'$push':{'name':_0x58ac71(0x2e7),'product_code':_0x58ac71(0x239)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3073d7=[];_0x3073d7[_0x58ac71(0x2a2)]=[];for(let _0x2af224=0x0;_0x2af224<=_0xba53b7[_0x58ac71(0x1a0)]-0x1;_0x2af224++){const _0x3bf28b=_0xba53b7[_0x2af224];_0x3073d7[_0x58ac71(0x2a2)][_0x58ac71(0x2b8)](_0x3bf28b);}const _0x37e776=await product[_0x58ac71(0x261)]([{'$group':{'_id':{'category':_0x58ac71(0x265)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x58ac71(0x2e7)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3f95c1=await product[_0x58ac71(0x261)]([{'$group':{'_id':{'category':_0x58ac71(0x265),'brand':'$brand'}}},{'$group':{'_id':_0x58ac71(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x84289b=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x488193,'$lte':_0x397f3e},'sales_staff_id':_0x4506c3,'sale_product.isFG':_0x58ac71(0x250)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x58ac71(0x250)}},{'$lookup':{'from':_0x58ac71(0x1f3),'localField':_0x58ac71(0x1c3),'foreignField':_0x58ac71(0x1a9),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x58ac71(0x202),'date':_0x58ac71(0x189),'customer':_0x58ac71(0x248)},'totalQty':{'$sum':_0x58ac71(0x1df)},'products':{'$push':{'qty':_0x58ac71(0x1df),'NetPrice':'$sale_product.totalprice','discount':_0x58ac71(0x1e9),'adj_discount':_0x58ac71(0x249),'product_details':{'prod_name':'$product_info.name','product_code':_0x58ac71(0x2a3),'category':_0x58ac71(0x2e9),'brand':'$product_info.brand','gross_price':_0x58ac71(0x281)}}}}},{'$unwind':_0x58ac71(0x22d)},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x58ac71(0x174),'category':_0x58ac71(0x29f),'brand':_0x58ac71(0x236)},'totalQty':{'$sum':_0x58ac71(0x2c7)},'totalGross':{'$sum':{'$multiply':[_0x58ac71(0x2c7),_0x58ac71(0x278)]}},'NetPrice':{'$sum':_0x58ac71(0x1a2)},'discount':{'$sum':_0x58ac71(0x1e0)},'adj_discount':{'$sum':_0x58ac71(0x161)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x58ac71(0x2ca),'date':_0x58ac71(0x1bf),'customer':_0x58ac71(0x174)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x58ac71(0x191)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x58ac71(0x2a6)},'adj_discount':{'$sum':_0x58ac71(0x2bc)},'products':{'$push':{'qty':_0x58ac71(0x1f7),'category':_0x58ac71(0x1b0),'brand':_0x58ac71(0x237),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x28e666=[],_0x18d434={},_0x2754e6={},_0x317c64={};var _0x2e12dd=0x0,_0x4a788e=0x0,_0x24d13b=0x0,_0x3f83f8=0x0,_0x38aa10=0x0;const _0x137ec2=0x16345785d8a0000;for(let _0x19399c=0x0;_0x19399c<=_0x84289b[_0x58ac71(0x1a0)]-0x1;_0x19399c++){const _0x3c959a=_0x84289b[_0x19399c];let _0x53e1a1=_0x58ac71(0x188);_0x53e1a1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3c959a['_id'][_0x58ac71(0x1d5)]+_0x58ac71(0x217),_0x53e1a1+=_0x58ac71(0x20e)+_0x3c959a[_0x58ac71(0x213)]['date']+_0x58ac71(0x217),_0x53e1a1+=_0x58ac71(0x20e)+_0x3c959a['_id'][_0x58ac71(0x27e)]+_0x58ac71(0x217);let _0x58863e={};var _0x8f07e9=0x0;for(let _0xc0d5f3=0x0;_0xc0d5f3<=_0x3c959a[_0x58ac71(0x1f3)][_0x58ac71(0x1a0)]-0x1;_0xc0d5f3++){const _0xd6a6bb=_0x3c959a[_0x58ac71(0x1f3)][_0xc0d5f3];_0x58863e[_0xd6a6bb[_0x58ac71(0x24a)]+'-'+_0xd6a6bb[_0x58ac71(0x22f)]]=_0xd6a6bb[_0x58ac71(0x1fd)];const _0xe4221=_0xd6a6bb[_0x58ac71(0x24a)]+'-'+_0xd6a6bb['category'];!_0x18d434[_0xe4221]&&(_0x18d434[_0xe4221]=0x0),!Array['isArray'](_0x317c64[_0xe4221])&&(_0x317c64[_0xe4221]=[]),!Array[_0x58ac71(0x241)](_0x317c64[_0xe4221])&&(_0x317c64[_0xe4221]=[]),_0x18d434[_0xe4221]+=_0xd6a6bb['qty'],_0x317c64[_0xe4221][_0x58ac71(0x2b8)](_0xd6a6bb[_0x58ac71(0x1fd)]),_0x8f07e9++;}console[_0x58ac71(0x21d)](_0x3c959a);for(let _0x3eb410=0x0;_0x3eb410<=_0x3073d7[_0x58ac71(0x2a2)][_0x58ac71(0x1a0)]-0x1;_0x3eb410++){const _0x58b9ee=_0x3073d7['cat_brand'][_0x3eb410],_0x499bb7=_0x58b9ee['_id'][_0x58ac71(0x24a)]+'-'+_0x58b9ee[_0x58ac71(0x213)][_0x58ac71(0x22f)];_0x53e1a1+=_0x58ac71(0x253)+(_0x58863e[_0x499bb7]!==undefined?_0x58863e[_0x499bb7][_0x58ac71(0x2b0)](0x2):'')+_0x58ac71(0x217);}_0x24d13b=_0x3c959a[_0x58ac71(0x218)]+_0x3c959a[_0x58ac71(0x199)],_0x53e1a1+=_0x58ac71(0x162)+formatNumber(parseFloat(_0x3c959a[_0x58ac71(0x23d)],0x2)['toFixed'](0x2))+_0x58ac71(0x217),_0x53e1a1+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x3c959a['totalGross'][_0x58ac71(0x2b0)](0x2))+_0x58ac71(0x217),_0x53e1a1+=_0x58ac71(0x162)+formatNumber(_0x24d13b)+_0x58ac71(0x217),_0x53e1a1+=_0x58ac71(0x162)+formatNumber(_0x3c959a[_0x58ac71(0x247)][_0x58ac71(0x2b0)](0x2))+_0x58ac71(0x217),_0x53e1a1+=_0x58ac71(0x206),_0x2e12dd+=parseFloat(_0x3c959a[_0x58ac71(0x23d)]['toFixed'](0x2)),_0x4a788e+=parseFloat(_0x3c959a[_0x58ac71(0x247)][_0x58ac71(0x2b0)](0x2)),_0x3f83f8+=_0x24d13b,_0x38aa10+=parseFloat(_0x3c959a[_0x58ac71(0x16d)][_0x58ac71(0x2b0)](0x2));if(_0x19399c==_0x84289b['length']-0x1){_0x53e1a1+=_0x58ac71(0x188),_0x53e1a1+=_0x58ac71(0x293),_0x53e1a1+=_0x58ac71(0x217);for(let _0x2bbd9a=0x0;_0x2bbd9a<=_0x3073d7[_0x58ac71(0x2a2)][_0x58ac71(0x1a0)]-0x1;_0x2bbd9a++){const _0x214520=_0x3073d7[_0x58ac71(0x2a2)][_0x2bbd9a],_0xe003e1=_0x214520[_0x58ac71(0x213)]['brand']+'-'+_0x214520['_id'][_0x58ac71(0x22f)],_0x438933=_0x317c64[_0xe003e1][_0x58ac71(0x1ca)]((_0x3d937c,_0x1fb881)=>_0x3d937c+_0x1fb881,0x0);console[_0x58ac71(0x21d)]('test',_0xe003e1),_0x53e1a1+=_0x58ac71(0x296)+(_0x438933!==undefined?formatNumber(_0x438933['toFixed'](0x2)):'')+'</b></td>',console[_0x58ac71(0x21d)](_0x317c64[_0xe003e1][_0x58ac71(0x1ca)]((_0x2f5bee,_0xe91cd3)=>_0x2f5bee+_0xe91cd3,0x0));}_0x53e1a1+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2e12dd['toFixed'](0x2))+_0x58ac71(0x2bd),_0x53e1a1+=_0x58ac71(0x1d8)+formatNumber(_0x38aa10)+'</b></td>',_0x53e1a1+=_0x58ac71(0x1d8)+formatNumber(_0x3f83f8)+_0x58ac71(0x2bd),_0x53e1a1+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4a788e)+_0x58ac71(0x2bd),_0x53e1a1+=_0x58ac71(0x206);}_0x28e666[_0x58ac71(0x2b8)](_0x53e1a1);}function _0x98e6bd(_0x55a10c,_0x25c5b6){const _0x4ed037=_0x58ac71,_0x25222e=[];for(let _0x105e18=0x0;_0x105e18<=_0x55a10c[_0x4ed037(0x1a0)]-0x1;_0x105e18+=_0x25c5b6){_0x25222e['push'](_0x55a10c[_0x4ed037(0x1a1)](_0x105e18,_0x105e18+_0x25c5b6));}return _0x25222e;}const _0x3da02b=_0x98e6bd(_0x28e666,_0x137ec2);let _0x3f8024='';return _0x3da02b[_0x58ac71(0x290)]((_0xf70049,_0x75bec8)=>{const _0x496db1=_0x58ac71;_0x75bec8>0x0&&(_0x3f8024+=_0x496db1(0x2d7));_0x3f8024+='<table>',_0x3f8024+=_0x496db1(0x2e3),_0x3f8024+=_0x496db1(0x188),_0x3f8024+=_0x496db1(0x26f),_0x3f8024+=_0x496db1(0x206),_0x3f8024+='<tr>',_0x3f8024+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x25523b=0x0;_0x25523b<=_0x37e776['length']-0x1;_0x25523b++){const _0x4dba88=_0x37e776[_0x25523b];for(let _0x5bb0a4=0x0;_0x5bb0a4<_0x3f95c1['length'];_0x5bb0a4++){const _0x2cca04=_0x3f95c1[_0x5bb0a4];_0x2cca04[_0x496db1(0x213)]===_0x4dba88['_id']['category']&&(_0x3f8024+='<td\x20colspan=\x22'+_0x2cca04[_0x496db1(0x1e8)]+_0x496db1(0x27b)+_0x4dba88[_0x496db1(0x213)][_0x496db1(0x22f)]+'</td>');}}_0x3f8024+=_0x496db1(0x2c8),_0x3f8024+='</tr>',_0x3f8024+=_0x496db1(0x188),_0x3f8024+=_0x496db1(0x20b),_0x3f8024+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x3f8024+=_0x496db1(0x190);for(let _0x46afa1=0x0;_0x46afa1<=_0x37e776[_0x496db1(0x1a0)]-0x1;_0x46afa1++){const _0x109ceb=_0x37e776[_0x46afa1];for(let _0xd98920=0x0;_0xd98920<_0x3073d7[_0x496db1(0x2a2)]['length'];_0xd98920++){const _0x4f57d3=_0x3073d7[_0x496db1(0x2a2)][_0xd98920];_0x4f57d3[_0x496db1(0x213)][_0x496db1(0x22f)]===_0x109ceb['_id'][_0x496db1(0x22f)]&&(_0x3f8024+='<td\x20class=\x22cat_data\x22>'+_0x4f57d3[_0x496db1(0x213)][_0x496db1(0x24a)]+'</td>');}}_0x3f8024+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x3f8024+=_0x496db1(0x20f),_0x3f8024+=_0x496db1(0x208),_0x3f8024+=_0x496db1(0x1ec),_0x3f8024+=_0x496db1(0x206),_0x3f8024+=_0x496db1(0x15f),_0x3f8024+='<tbody>',_0xf70049[_0x496db1(0x290)](_0x5427b9=>{_0x3f8024+=_0x5427b9;}),console[_0x496db1(0x21d)](_0x317c64),_0x3f8024+=_0x496db1(0x1cb),_0x3f8024+=_0x496db1(0x1d4);}),_0x3f8024;}router['post'](a0_0x4ca221(0x1fb),auth,async(_0x4e016c,_0x8711c5)=>{const _0x3eb077=a0_0x4ca221,{from_date:_0x55fe08,to_date:_0x413a08,isExcel:_0x91797,agent_id:_0x561ff9}=_0x4e016c[_0x3eb077(0x271)],_0x75ea3d=_0x4e016c[_0x3eb077(0x2b9)],_0x4970cb=await staff[_0x3eb077(0x1ff)]({'email':_0x75ea3d[_0x3eb077(0x2eb)]}),_0x452852=await master_shop[_0x3eb077(0x2b2)](),_0xd8e7ed=await agentsdataDSICheck_admin(_0x55fe08,_0x413a08,_0x561ff9,_0x91797),_0x50d12c=await agentsdataDSICheck_admin_excel(_0x55fe08,_0x413a08,_0x561ff9,_0x91797);let _0x599073=_0x3eb077(0x169);var _0x768988=new Date(_0x55fe08),_0x5dffec=new Date(_0x413a08);const _0x130db7={'year':_0x3eb077(0x1e6),'month':_0x3eb077(0x19d),'day':'numeric'},_0x1974cc=new Intl[(_0x3eb077(0x183))](_0x3eb077(0x289),_0x130db7)[_0x3eb077(0x204)](_0x768988),_0x45ed2b=new Intl['DateTimeFormat']('en-US',_0x130db7)[_0x3eb077(0x204)](_0x5dffec);_0x599073+='<div\x20class=\x22row\x22>',_0x599073+=_0x3eb077(0x286),_0x599073+=_0x3eb077(0x1af),_0x599073+=_0xd8e7ed,_0x599073+=_0x3eb077(0x1d4),_0x599073+=_0x3eb077(0x1ac),_0x599073+=_0x3eb077(0x1ac);let _0x2a963c=_0x3eb077(0x169);_0x2a963c+=_0x3eb077(0x1ad),_0x2a963c+='<div\x20\x20id=\x22table-conatainer\x22>',_0x2a963c+='<table>',_0x2a963c+=_0x50d12c,_0x2a963c+='</table>',_0x2a963c+=_0x3eb077(0x1ac),_0x2a963c+=_0x3eb077(0x1ac);let _0x452052=_0x3eb077(0x2dd);const _0x4a4dd7={'width':_0x3eb077(0x182),'height':_0x3eb077(0x205),'orientation':_0x3eb077(0x166),'border':{'top':_0x3eb077(0x2a1),'right':'0.1in','bottom':'0.1in','left':_0x3eb077(0x2a1)},'header':{'height':_0x3eb077(0x209),'contents':_0x3eb077(0x1b1)+_0x452052+_0x3eb077(0x1d6)+_0x1974cc+_0x3eb077(0x262)+_0x45ed2b+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':'20mm','contents':{'default':_0x3eb077(0x274)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3eb077(0x29c)}}};if(_0x91797=='on'){const _0x599650=cheerio['load'](_0x2a963c);let _0x463a10=[],_0x132d44=[],_0x45d819=[];_0x599650(_0x3eb077(0x1de))[_0x3eb077(0x234)]((_0x10893c,_0x1e1b39)=>{const _0x25a580=_0x3eb077;let _0x49ee57=[],_0x27fdcf=0x0;while(_0x45d819[_0x27fdcf]){_0x45d819[_0x27fdcf]--,_0x27fdcf++;}_0x599650(_0x1e1b39)[_0x25a580(0x2b2)](_0x25a580(0x176))[_0x25a580(0x234)]((_0x3ce5a9,_0xef9dbb)=>{const _0x5b5680=_0x25a580;let _0x18fc37=_0x599650(_0xef9dbb)['text']()['trim'](),_0x5df2aa=parseFloat(_0x18fc37[_0x5b5680(0x2dc)](/,/g,''));isNaN(_0x5df2aa)&&(_0x5df2aa=_0x18fc37);let _0x3e56a7=parseInt(_0x599650(_0xef9dbb)[_0x5b5680(0x223)](_0x5b5680(0x2d3)))||0x1,_0x43c710=parseInt(_0x599650(_0xef9dbb)[_0x5b5680(0x223)](_0x5b5680(0x227)))||0x1;_0x49ee57[_0x27fdcf]=_0x5df2aa;(_0x3e56a7>0x1||_0x43c710>0x1)&&_0x132d44['push']({'s':{'r':_0x10893c,'c':_0x27fdcf},'e':{'r':_0x10893c+_0x43c710-0x1,'c':_0x27fdcf+_0x3e56a7-0x1}});for(let _0x358efe=0x0;_0x358efe<_0x3e56a7;_0x358efe++){_0x43c710>0x1&&(_0x45d819[_0x27fdcf+_0x358efe]=_0x43c710-0x1);}_0x27fdcf+=_0x3e56a7;}),_0x463a10['push'](_0x49ee57);});const _0x43e989=XLSX['utils'][_0x3eb077(0x22e)](),_0x300dbc=XLSX['utils']['aoa_to_sheet'](_0x463a10);_0x132d44[_0x3eb077(0x1a0)]>0x0&&(_0x300dbc[_0x3eb077(0x186)]=_0x132d44);_0x300dbc[_0x3eb077(0x269)]=_0x463a10[0x0][_0x3eb077(0x1ba)](()=>({'wpx':0x64})),XLSX['utils'][_0x3eb077(0x266)](_0x43e989,_0x300dbc,_0x3eb077(0x17d));const _0x332f4b=XLSX[_0x3eb077(0x1d1)](_0x43e989,{'bookType':_0x3eb077(0x2d5),'type':_0x3eb077(0x1ab)});_0x8711c5[_0x3eb077(0x2b6)](_0x3eb077(0x212),_0x3eb077(0x2e5)),_0x8711c5[_0x3eb077(0x2b6)](_0x3eb077(0x1be),_0x3eb077(0x1b3)),_0x8711c5[_0x3eb077(0x17c)](_0x332f4b);}else pdf['create'](_0x599073,_0x4a4dd7)[_0x3eb077(0x1f4)](function(_0x1a8218,_0x12b00d){const _0x52572d=_0x3eb077;if(_0x1a8218){_0x8711c5['status'](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x8711c5[_0x52572d(0x2b6)](_0x52572d(0x1be),_0x52572d(0x243)),_0x12b00d['pipe'](_0x8711c5);});}),router[a0_0x4ca221(0x1f9)](a0_0x4ca221(0x228),auth,async(_0x2a28a3,_0x1f0832)=>{const _0xe10336=a0_0x4ca221;try{const {username:_0x20e4b4,email:_0xa2396e,role:_0x313c12}=_0x2a28a3[_0xe10336(0x2b9)],_0x3287e4=_0x2a28a3[_0xe10336(0x2b9)],_0x5a7f11=await profile[_0xe10336(0x1ff)]({'email':_0x3287e4[_0xe10336(0x2eb)]}),_0x2b946a={'year':_0xe10336(0x1e6),'month':_0xe10336(0x19d),'day':_0xe10336(0x1e6)},_0x32f3ea=await master_shop[_0xe10336(0x2b2)](),_0x1aa812=await staff[_0xe10336(0x1ff)]({'email':_0x3287e4[_0xe10336(0x2eb)]}),_0x22f947=await product[_0xe10336(0x2b2)](),_0xe9a319=await warehouse['aggregate']([{'$unwind':_0xe10336(0x163)},{'$lookup':{'from':_0xe10336(0x1f3),'localField':_0xe10336(0x245),'foreignField':_0xe10336(0x200),'as':_0xe10336(0x201)}},{'$unwind':_0xe10336(0x256)},{'$project':{'product_name':_0xe10336(0x20c),'product_stock':_0xe10336(0x1c5)}},{'$group':{'_id':_0xe10336(0x173),'product_stock':{'$sum':_0xe10336(0x23f)}}}]);if(_0x32f3ea[0x0][_0xe10336(0x196)]==_0xe10336(0x2c6))var _0x9fae99=users['English'];else{if(_0x32f3ea[0x0]['language']==_0xe10336(0x2de))var _0x9fae99=users[_0xe10336(0x2de)];else{if(_0x32f3ea[0x0][_0xe10336(0x196)]=='German')var _0x9fae99=users[_0xe10336(0x1aa)];else{if(_0x32f3ea[0x0][_0xe10336(0x196)]==_0xe10336(0x2e6))var _0x9fae99=users[_0xe10336(0x2e6)];else{if(_0x32f3ea[0x0][_0xe10336(0x196)]==_0xe10336(0x26d))var _0x9fae99=users['French'];else{if(_0x32f3ea[0x0][_0xe10336(0x196)]==_0xe10336(0x195))var _0x9fae99=users[_0xe10336(0x1a7)];else{if(_0x32f3ea[0x0][_0xe10336(0x196)]==_0xe10336(0x28e))var _0x9fae99=users[_0xe10336(0x28e)];else{if(_0x32f3ea[0x0][_0xe10336(0x196)]==_0xe10336(0x1bb))var _0x9fae99=users['Arabic'];}}}}}}}_0x1f0832[_0xe10336(0x2c2)](_0xe10336(0x238),{'success':_0x2a28a3[_0xe10336(0x26a)](_0xe10336(0x1cc)),'errors':_0x2a28a3[_0xe10336(0x26a)](_0xe10336(0x18f)),'alldata':_0x22f947,'profile':_0x5a7f11,'master_shop':_0x32f3ea,'role':_0x3287e4,'product_stock':_0xe9a319,'language':_0x9fae99,'staff_arr':_0x1aa812});}catch(_0x127fb0){}});function formatNumber(_0x4216ed,_0x3dcf1e=a0_0x4ca221(0x289),_0x3f908={'minimumFractionDigits':0x2}){const _0x12ba15=a0_0x4ca221,_0xadca47=new Intl[(_0x12ba15(0x1b7))](_0x3dcf1e,_0x3f908);return _0xadca47[_0x12ba15(0x204)](_0x4216ed);}async function agentsdataDSICheck(_0x3649bd,_0x26258d,_0x57b55a,_0x59ad84){const _0x5bcbe1=a0_0x4ca221,_0x4d0dec=await product['aggregate']([{'$group':{'_id':{'brand':_0x5bcbe1(0x1fc),'category':'$category'},'products':{'$push':{'name':_0x5bcbe1(0x2e7),'product_code':_0x5bcbe1(0x239)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x354ab6=[];_0x354ab6[_0x5bcbe1(0x2a2)]=[];for(let _0x39dc39=0x0;_0x39dc39<=_0x4d0dec[_0x5bcbe1(0x1a0)]-0x1;_0x39dc39++){const _0x2f39b5=_0x4d0dec[_0x39dc39];_0x354ab6[_0x5bcbe1(0x2a2)][_0x5bcbe1(0x2b8)](_0x2f39b5);}const _0xcb4a61=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x5bcbe1(0x239),'product_name':_0x5bcbe1(0x2e7)}}}},{'$sort':{'_id.category':-0x1}}]),_0x203e25=await product['aggregate']([{'$group':{'_id':{'category':_0x5bcbe1(0x265),'brand':_0x5bcbe1(0x1fc)}}},{'$group':{'_id':_0x5bcbe1(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x59d3f3=await sales_sa[_0x5bcbe1(0x261)]([{'$match':{'date':{'$gte':_0x3649bd,'$lte':_0x26258d},'sales_staff_id':_0x57b55a,'sale_product.isFG':'false'}},{'$unwind':_0x5bcbe1(0x1cd)},{'$match':{'sale_product.isFG':_0x5bcbe1(0x250)}},{'$lookup':{'from':_0x5bcbe1(0x1f3),'localField':_0x5bcbe1(0x1c3),'foreignField':_0x5bcbe1(0x1a9),'as':'product_info'}},{'$unwind':_0x5bcbe1(0x19a)},{'$group':{'_id':{'dsi':_0x5bcbe1(0x202),'date':_0x5bcbe1(0x189),'customer':_0x5bcbe1(0x248)},'totalQty':{'$sum':_0x5bcbe1(0x1df)},'products':{'$push':{'qty':_0x5bcbe1(0x1df),'NetPrice':_0x5bcbe1(0x19c),'discount':_0x5bcbe1(0x1e9),'adj_discount':_0x5bcbe1(0x249),'product_details':{'prod_name':_0x5bcbe1(0x279),'product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x5bcbe1(0x298),'gross_price':_0x5bcbe1(0x281)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x5bcbe1(0x2ca),'date':_0x5bcbe1(0x1bf),'customer':_0x5bcbe1(0x174),'category':_0x5bcbe1(0x29f),'brand':_0x5bcbe1(0x236)},'totalQty':{'$sum':_0x5bcbe1(0x2c7)},'totalGross':{'$sum':{'$multiply':[_0x5bcbe1(0x2c7),_0x5bcbe1(0x278)]}},'NetPrice':{'$sum':_0x5bcbe1(0x1a2)},'discount':{'$sum':_0x5bcbe1(0x1e0)},'adj_discount':{'$sum':_0x5bcbe1(0x161)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x5bcbe1(0x1bf),'customer':'$_id.customer'},'totalQty':{'$sum':_0x5bcbe1(0x1f7)},'totalGross':{'$sum':_0x5bcbe1(0x191)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x5bcbe1(0x2bc)},'products':{'$push':{'qty':'$totalQty','category':_0x5bcbe1(0x1b0),'brand':_0x5bcbe1(0x237),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x15773d=[],_0x270b51={},_0x2bad23={},_0x4cccf6={};var _0x1677ee=0x0,_0x11588a=0x0,_0x2a097d=0x0,_0x3087ff=0x0,_0x515936=0x0;const _0x1eaff1=0x6;for(let _0x2304a4=0x0;_0x2304a4<=_0x59d3f3['length']-0x1;_0x2304a4++){const _0x2b5e05=_0x59d3f3[_0x2304a4];let _0x46ccb4=_0x5bcbe1(0x188);_0x46ccb4+=_0x5bcbe1(0x20e)+_0x2b5e05[_0x5bcbe1(0x213)]['dsi']+_0x5bcbe1(0x217),_0x46ccb4+=_0x5bcbe1(0x20e)+_0x2b5e05['_id']['date']+'</td>',_0x46ccb4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2b5e05[_0x5bcbe1(0x213)][_0x5bcbe1(0x27e)]+_0x5bcbe1(0x217);let _0x47df68={};var _0x573f9a=0x0;for(let _0x2b7497=0x0;_0x2b7497<=_0x2b5e05[_0x5bcbe1(0x1f3)][_0x5bcbe1(0x1a0)]-0x1;_0x2b7497++){const _0x526a56=_0x2b5e05[_0x5bcbe1(0x1f3)][_0x2b7497];_0x47df68[_0x526a56[_0x5bcbe1(0x24a)]+'-'+_0x526a56[_0x5bcbe1(0x22f)]]=_0x526a56['qty'];const _0x4a92c1=_0x526a56[_0x5bcbe1(0x24a)]+'-'+_0x526a56[_0x5bcbe1(0x22f)];!_0x270b51[_0x4a92c1]&&(_0x270b51[_0x4a92c1]=0x0),!Array[_0x5bcbe1(0x241)](_0x4cccf6[_0x4a92c1])&&(_0x4cccf6[_0x4a92c1]=[]),!Array[_0x5bcbe1(0x241)](_0x4cccf6[_0x4a92c1])&&(_0x4cccf6[_0x4a92c1]=[]),_0x270b51[_0x4a92c1]+=_0x526a56['qty'],_0x4cccf6[_0x4a92c1]['push'](_0x526a56[_0x5bcbe1(0x1fd)]),_0x573f9a++;}console['log'](_0x2b5e05);for(let _0x1cd939=0x0;_0x1cd939<=_0x354ab6[_0x5bcbe1(0x2a2)]['length']-0x1;_0x1cd939++){const _0x355bb2=_0x354ab6[_0x5bcbe1(0x2a2)][_0x1cd939],_0xdf752c=_0x355bb2['_id'][_0x5bcbe1(0x24a)]+'-'+_0x355bb2[_0x5bcbe1(0x213)][_0x5bcbe1(0x22f)];_0x46ccb4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x47df68[_0xdf752c]!==undefined?_0x47df68[_0xdf752c][_0x5bcbe1(0x2b0)](0x2):'')+_0x5bcbe1(0x217);}_0x2a097d=_0x2b5e05[_0x5bcbe1(0x218)]+_0x2b5e05[_0x5bcbe1(0x199)],_0x46ccb4+=_0x5bcbe1(0x162)+formatNumber(parseFloat(_0x2b5e05[_0x5bcbe1(0x23d)],0x2)['toFixed'](0x2))+_0x5bcbe1(0x217),_0x46ccb4+=_0x5bcbe1(0x162)+formatNumber(_0x2b5e05['totalGross'][_0x5bcbe1(0x2b0)](0x2))+_0x5bcbe1(0x217),_0x46ccb4+=_0x5bcbe1(0x162)+formatNumber(_0x2a097d)+_0x5bcbe1(0x217),_0x46ccb4+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x2b5e05[_0x5bcbe1(0x247)][_0x5bcbe1(0x2b0)](0x2))+_0x5bcbe1(0x217),_0x46ccb4+=_0x5bcbe1(0x206),_0x1677ee+=parseFloat(_0x2b5e05[_0x5bcbe1(0x23d)][_0x5bcbe1(0x2b0)](0x2)),_0x11588a+=parseFloat(_0x2b5e05[_0x5bcbe1(0x247)][_0x5bcbe1(0x2b0)](0x2)),_0x3087ff+=_0x2a097d,_0x515936+=parseFloat(_0x2b5e05[_0x5bcbe1(0x16d)][_0x5bcbe1(0x2b0)](0x2));if(_0x2304a4==_0x59d3f3[_0x5bcbe1(0x1a0)]-0x1){_0x46ccb4+=_0x5bcbe1(0x188),_0x46ccb4+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x46ccb4+=_0x5bcbe1(0x217);for(let _0x408780=0x0;_0x408780<=_0x354ab6[_0x5bcbe1(0x2a2)][_0x5bcbe1(0x1a0)]-0x1;_0x408780++){const _0x1abcb2=_0x354ab6[_0x5bcbe1(0x2a2)][_0x408780],_0x2d80ff=_0x1abcb2[_0x5bcbe1(0x213)][_0x5bcbe1(0x24a)]+'-'+_0x1abcb2[_0x5bcbe1(0x213)][_0x5bcbe1(0x22f)],_0x92f561=_0x4cccf6[_0x2d80ff]['reduce']((_0x1c13e6,_0x2db4c8)=>_0x1c13e6+_0x2db4c8,0x0);_0x46ccb4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x92f561!==undefined?formatNumber(_0x92f561[_0x5bcbe1(0x2b0)](0x2)):'')+_0x5bcbe1(0x2bd),console[_0x5bcbe1(0x21d)](_0x4cccf6[_0x2d80ff][_0x5bcbe1(0x1ca)]((_0x3fa35d,_0x1cd1a2)=>_0x3fa35d+_0x1cd1a2,0x0));}_0x46ccb4+=_0x5bcbe1(0x1d8)+formatNumber(_0x1677ee['toFixed'](0x2))+'</b></td>',_0x46ccb4+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x515936)+_0x5bcbe1(0x2bd),_0x46ccb4+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3087ff)+_0x5bcbe1(0x2bd),_0x46ccb4+=_0x5bcbe1(0x1d8)+formatNumber(_0x11588a)+_0x5bcbe1(0x2bd),_0x46ccb4+=_0x5bcbe1(0x206);}_0x15773d[_0x5bcbe1(0x2b8)](_0x46ccb4);}function _0x479a88(_0x1ceb60,_0x26e250){const _0x260f99=_0x5bcbe1,_0x44f1da=[];for(let _0x1c2114=0x0;_0x1c2114<=_0x1ceb60[_0x260f99(0x1a0)]-0x1;_0x1c2114+=_0x26e250){_0x44f1da['push'](_0x1ceb60['slice'](_0x1c2114,_0x1c2114+_0x26e250));}return _0x44f1da;}const _0x12fbd7=_0x479a88(_0x15773d,_0x1eaff1);let _0x5a0b59='';return _0x12fbd7[_0x5bcbe1(0x290)]((_0x4c4d31,_0x33abcc)=>{const _0x498547=_0x5bcbe1;_0x33abcc>0x0&&(_0x5a0b59+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x5a0b59+=_0x498547(0x1af),_0x5a0b59+=_0x498547(0x2e3),_0x5a0b59+='<tr>',_0x5a0b59+=_0x498547(0x26f),_0x5a0b59+=_0x498547(0x206),_0x5a0b59+=_0x498547(0x188),_0x5a0b59+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x117681=0x0;_0x117681<=_0xcb4a61[_0x498547(0x1a0)]-0x1;_0x117681++){const _0x5ac356=_0xcb4a61[_0x117681];for(let _0x386b81=0x0;_0x386b81<_0x203e25[_0x498547(0x1a0)];_0x386b81++){const _0xb9a899=_0x203e25[_0x386b81];_0xb9a899[_0x498547(0x213)]===_0x5ac356[_0x498547(0x213)][_0x498547(0x22f)]&&(_0x5a0b59+=_0x498547(0x232)+_0xb9a899[_0x498547(0x1e8)]+_0x498547(0x27b)+_0x5ac356[_0x498547(0x213)][_0x498547(0x22f)]+_0x498547(0x217));}}_0x5a0b59+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x5a0b59+=_0x498547(0x206),_0x5a0b59+=_0x498547(0x188),_0x5a0b59+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x5a0b59+=_0x498547(0x258),_0x5a0b59+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0xa2682c=0x0;_0xa2682c<=_0xcb4a61[_0x498547(0x1a0)]-0x1;_0xa2682c++){const _0x244b2a=_0xcb4a61[_0xa2682c];for(let _0x3f3260=0x0;_0x3f3260<_0x354ab6[_0x498547(0x2a2)][_0x498547(0x1a0)];_0x3f3260++){const _0x454737=_0x354ab6[_0x498547(0x2a2)][_0x3f3260];_0x454737['_id'][_0x498547(0x22f)]===_0x244b2a[_0x498547(0x213)]['category']&&(_0x5a0b59+=_0x498547(0x215)+_0x454737[_0x498547(0x213)]['brand']+_0x498547(0x217));}}_0x5a0b59+=_0x498547(0x2cd),_0x5a0b59+=_0x498547(0x20f),_0x5a0b59+=_0x498547(0x208),_0x5a0b59+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x5a0b59+=_0x498547(0x206),_0x5a0b59+=_0x498547(0x15f),_0x5a0b59+=_0x498547(0x18a),_0x4c4d31[_0x498547(0x290)](_0x49ba7c=>{_0x5a0b59+=_0x49ba7c;}),console[_0x498547(0x21d)](_0x4cccf6),_0x5a0b59+=_0x498547(0x1cb),_0x5a0b59+=_0x498547(0x1d4);}),_0x5a0b59;}async function agentsdataDSICheck_excel(_0x13369e,_0x546b39,_0x57c3ab,_0x3d9d6e){const _0x1727af=a0_0x4ca221,_0x19f8b5=await product['aggregate']([{'$group':{'_id':{'brand':_0x1727af(0x1fc),'category':'$category'},'products':{'$push':{'name':_0x1727af(0x2e7),'product_code':_0x1727af(0x239)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x21749b=[];_0x21749b[_0x1727af(0x2a2)]=[];for(let _0x3bc3a8=0x0;_0x3bc3a8<=_0x19f8b5[_0x1727af(0x1a0)]-0x1;_0x3bc3a8++){const _0x3a8faa=_0x19f8b5[_0x3bc3a8];_0x21749b[_0x1727af(0x2a2)][_0x1727af(0x2b8)](_0x3a8faa);}const _0x55bc99=await product[_0x1727af(0x261)]([{'$group':{'_id':{'category':_0x1727af(0x265)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x1727af(0x2e7)}}}},{'$sort':{'_id.category':-0x1}}]),_0x58cd79=await product[_0x1727af(0x261)]([{'$group':{'_id':{'category':'$category','brand':_0x1727af(0x1fc)}}},{'$group':{'_id':_0x1727af(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x17f5f7=await sales_sa[_0x1727af(0x261)]([{'$match':{'date':{'$gte':_0x13369e,'$lte':_0x546b39},'sales_staff_id':_0x57c3ab,'sale_product.isFG':_0x1727af(0x250)}},{'$unwind':_0x1727af(0x1cd)},{'$match':{'sale_product.isFG':_0x1727af(0x250)}},{'$lookup':{'from':_0x1727af(0x1f3),'localField':_0x1727af(0x1c3),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x1727af(0x19a)},{'$group':{'_id':{'dsi':_0x1727af(0x202),'date':_0x1727af(0x189),'customer':_0x1727af(0x248)},'totalQty':{'$sum':_0x1727af(0x1df)},'products':{'$push':{'qty':_0x1727af(0x1df),'NetPrice':_0x1727af(0x19c),'discount':_0x1727af(0x1e9),'adj_discount':_0x1727af(0x249),'product_details':{'prod_name':_0x1727af(0x279),'product_code':'$product_info.product_code','category':_0x1727af(0x2e9),'brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x1727af(0x22d)},{'$group':{'_id':{'dsi':_0x1727af(0x2ca),'date':_0x1727af(0x1bf),'customer':_0x1727af(0x174),'category':_0x1727af(0x29f),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x1727af(0x2c7)},'totalGross':{'$sum':{'$multiply':[_0x1727af(0x2c7),_0x1727af(0x278)]}},'NetPrice':{'$sum':_0x1727af(0x1a2)},'discount':{'$sum':_0x1727af(0x1e0)},'adj_discount':{'$sum':_0x1727af(0x161)},'product_details':{'$first':_0x1727af(0x27c)}}},{'$group':{'_id':{'dsi':_0x1727af(0x2ca),'date':_0x1727af(0x1bf),'customer':_0x1727af(0x174)},'totalQty':{'$sum':_0x1727af(0x1f7)},'totalGross':{'$sum':_0x1727af(0x191)},'NetPrice':{'$sum':_0x1727af(0x1dc)},'discount':{'$sum':_0x1727af(0x2a6)},'adj_discount':{'$sum':_0x1727af(0x2bc)},'products':{'$push':{'qty':'$totalQty','category':_0x1727af(0x1b0),'brand':_0x1727af(0x237),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x18f263=[],_0x1b2195={},_0x8d84fc={},_0x153dc2={};var _0x3e260e=0x0,_0x1cf746=0x0,_0x391b9e=0x0,_0x1175f6=0x0,_0x4534b6=0x0;const _0x426ffd=0x9184e72a000;for(let _0x377a4f=0x0;_0x377a4f<=_0x17f5f7['length']-0x1;_0x377a4f++){const _0x2623d0=_0x17f5f7[_0x377a4f];let _0x228146=_0x1727af(0x188);_0x228146+=_0x1727af(0x20e)+_0x2623d0['_id'][_0x1727af(0x1d5)]+_0x1727af(0x217),_0x228146+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2623d0['_id']['date']+_0x1727af(0x217),_0x228146+=_0x1727af(0x20e)+_0x2623d0[_0x1727af(0x213)][_0x1727af(0x27e)]+_0x1727af(0x217);let _0x15689e={};var _0x321116=0x0;for(let _0x5a5ab6=0x0;_0x5a5ab6<=_0x2623d0[_0x1727af(0x1f3)][_0x1727af(0x1a0)]-0x1;_0x5a5ab6++){const _0x170c52=_0x2623d0[_0x1727af(0x1f3)][_0x5a5ab6];_0x15689e[_0x170c52[_0x1727af(0x24a)]+'-'+_0x170c52[_0x1727af(0x22f)]]=_0x170c52[_0x1727af(0x1fd)];const _0x3654b5=_0x170c52[_0x1727af(0x24a)]+'-'+_0x170c52[_0x1727af(0x22f)];!_0x1b2195[_0x3654b5]&&(_0x1b2195[_0x3654b5]=0x0),!Array['isArray'](_0x153dc2[_0x3654b5])&&(_0x153dc2[_0x3654b5]=[]),!Array[_0x1727af(0x241)](_0x153dc2[_0x3654b5])&&(_0x153dc2[_0x3654b5]=[]),_0x1b2195[_0x3654b5]+=_0x170c52[_0x1727af(0x1fd)],_0x153dc2[_0x3654b5][_0x1727af(0x2b8)](_0x170c52[_0x1727af(0x1fd)]),_0x321116++;}console['log'](_0x2623d0);for(let _0x254836=0x0;_0x254836<=_0x21749b[_0x1727af(0x2a2)][_0x1727af(0x1a0)]-0x1;_0x254836++){const _0x13bbe9=_0x21749b['cat_brand'][_0x254836],_0x544c0d=_0x13bbe9[_0x1727af(0x213)][_0x1727af(0x24a)]+'-'+_0x13bbe9[_0x1727af(0x213)]['category'];_0x228146+=_0x1727af(0x253)+(_0x15689e[_0x544c0d]!==undefined?_0x15689e[_0x544c0d][_0x1727af(0x2b0)](0x2):'')+_0x1727af(0x217);}_0x391b9e=_0x2623d0[_0x1727af(0x218)]+_0x2623d0['adj_discount'],_0x228146+=_0x1727af(0x162)+formatNumber(parseFloat(_0x2623d0['totalQty'],0x2)[_0x1727af(0x2b0)](0x2))+_0x1727af(0x217),_0x228146+=_0x1727af(0x162)+formatNumber(_0x2623d0[_0x1727af(0x16d)][_0x1727af(0x2b0)](0x2))+_0x1727af(0x217),_0x228146+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x391b9e)+_0x1727af(0x217),_0x228146+=_0x1727af(0x162)+formatNumber(_0x2623d0[_0x1727af(0x247)][_0x1727af(0x2b0)](0x2))+_0x1727af(0x217),_0x228146+='</tr>',_0x3e260e+=parseFloat(_0x2623d0[_0x1727af(0x23d)][_0x1727af(0x2b0)](0x2)),_0x1cf746+=parseFloat(_0x2623d0[_0x1727af(0x247)][_0x1727af(0x2b0)](0x2)),_0x1175f6+=_0x391b9e,_0x4534b6+=parseFloat(_0x2623d0[_0x1727af(0x16d)]['toFixed'](0x2));if(_0x377a4f==_0x17f5f7[_0x1727af(0x1a0)]-0x1){_0x228146+=_0x1727af(0x188),_0x228146+=_0x1727af(0x293),_0x228146+=_0x1727af(0x217);for(let _0x4fd174=0x0;_0x4fd174<=_0x21749b[_0x1727af(0x2a2)]['length']-0x1;_0x4fd174++){const _0x4892bf=_0x21749b[_0x1727af(0x2a2)][_0x4fd174],_0x2bf939=_0x4892bf[_0x1727af(0x213)][_0x1727af(0x24a)]+'-'+_0x4892bf[_0x1727af(0x213)][_0x1727af(0x22f)],_0x102029=_0x153dc2[_0x2bf939][_0x1727af(0x1ca)]((_0x7eb68d,_0x568562)=>_0x7eb68d+_0x568562,0x0);_0x228146+=_0x1727af(0x296)+(_0x102029!==undefined?formatNumber(_0x102029['toFixed'](0x2)):'')+'</b></td>',console[_0x1727af(0x21d)](_0x153dc2[_0x2bf939]['reduce']((_0x32c9eb,_0x3a883b)=>_0x32c9eb+_0x3a883b,0x0));}_0x228146+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3e260e['toFixed'](0x2))+_0x1727af(0x2bd),_0x228146+=_0x1727af(0x1d8)+formatNumber(_0x4534b6)+'</b></td>',_0x228146+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1175f6)+_0x1727af(0x2bd),_0x228146+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1cf746)+_0x1727af(0x2bd),_0x228146+=_0x1727af(0x206);}_0x18f263['push'](_0x228146);}function _0x18ae3f(_0xf9ec2c,_0x3e064c){const _0x3f79a1=_0x1727af,_0x95b0a2=[];for(let _0x2a64f0=0x0;_0x2a64f0<=_0xf9ec2c[_0x3f79a1(0x1a0)]-0x1;_0x2a64f0+=_0x3e064c){_0x95b0a2['push'](_0xf9ec2c[_0x3f79a1(0x1a1)](_0x2a64f0,_0x2a64f0+_0x3e064c));}return _0x95b0a2;}const _0x1d3d51=_0x18ae3f(_0x18f263,_0x426ffd);let _0x10bc0c='';return _0x1d3d51['forEach']((_0x194f28,_0x5a1ffc)=>{const _0x5547fe=_0x1727af;_0x5a1ffc>0x0&&(_0x10bc0c+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x10bc0c+=_0x5547fe(0x1af),_0x10bc0c+=_0x5547fe(0x2e3),_0x10bc0c+=_0x5547fe(0x188),_0x10bc0c+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x10bc0c+='</tr>',_0x10bc0c+=_0x5547fe(0x188),_0x10bc0c+=_0x5547fe(0x280);for(let _0x3518cd=0x0;_0x3518cd<=_0x55bc99[_0x5547fe(0x1a0)]-0x1;_0x3518cd++){const _0x47f1a5=_0x55bc99[_0x3518cd];for(let _0x40703e=0x0;_0x40703e<_0x58cd79[_0x5547fe(0x1a0)];_0x40703e++){const _0x148c6e=_0x58cd79[_0x40703e];_0x148c6e[_0x5547fe(0x213)]===_0x47f1a5[_0x5547fe(0x213)]['category']&&(_0x10bc0c+='<td\x20colspan=\x22'+_0x148c6e[_0x5547fe(0x1e8)]+_0x5547fe(0x27b)+_0x47f1a5[_0x5547fe(0x213)][_0x5547fe(0x22f)]+'</td>');}}_0x10bc0c+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x10bc0c+='</tr>',_0x10bc0c+=_0x5547fe(0x188),_0x10bc0c+=_0x5547fe(0x20b),_0x10bc0c+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x10bc0c+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x2c789b=0x0;_0x2c789b<=_0x55bc99[_0x5547fe(0x1a0)]-0x1;_0x2c789b++){const _0x28037a=_0x55bc99[_0x2c789b];for(let _0x2d0f0c=0x0;_0x2d0f0c<_0x21749b[_0x5547fe(0x2a2)][_0x5547fe(0x1a0)];_0x2d0f0c++){const _0x16a63a=_0x21749b[_0x5547fe(0x2a2)][_0x2d0f0c];_0x16a63a[_0x5547fe(0x213)][_0x5547fe(0x22f)]===_0x28037a['_id'][_0x5547fe(0x22f)]&&(_0x10bc0c+=_0x5547fe(0x215)+_0x16a63a['_id']['brand']+_0x5547fe(0x217));}}_0x10bc0c+=_0x5547fe(0x2cd),_0x10bc0c+=_0x5547fe(0x20f),_0x10bc0c+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x10bc0c+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x10bc0c+=_0x5547fe(0x206),_0x10bc0c+=_0x5547fe(0x15f),_0x10bc0c+=_0x5547fe(0x18a),_0x194f28['forEach'](_0x5104a6=>{_0x10bc0c+=_0x5104a6;}),console[_0x5547fe(0x21d)](_0x153dc2),_0x10bc0c+='</tbody>',_0x10bc0c+=_0x5547fe(0x1d4);}),_0x10bc0c;}router[a0_0x4ca221(0x1da)](a0_0x4ca221(0x233),auth,async(_0x223cc8,_0x1f43d1)=>{const _0x31bd50=a0_0x4ca221,{from_date:_0x3b000e,to_date:_0x44522b,isExcel:_0x2c25d4}=_0x223cc8[_0x31bd50(0x271)],_0x24ec1c=_0x223cc8[_0x31bd50(0x2b9)],_0x5571b9=await staff[_0x31bd50(0x1ff)]({'email':_0x24ec1c[_0x31bd50(0x2eb)]}),_0x5dac68=await master_shop[_0x31bd50(0x2b2)]();console['log'](_0x5dac68[0x0][_0x31bd50(0x222)]);const _0x102639=await agentsdataDSICheck(_0x3b000e,_0x44522b,_0x5571b9['_id'][_0x31bd50(0x1c1)](),_0x2c25d4),_0x3f5660=await agentsdataDSICheck_excel(_0x3b000e,_0x44522b,_0x5571b9[_0x31bd50(0x213)][_0x31bd50(0x1c1)](),_0x2c25d4);let _0xb8b061='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x24ccfc=new Date(_0x3b000e),_0x1a85e7=new Date(_0x44522b);const _0x11862c={'year':_0x31bd50(0x1e6),'month':_0x31bd50(0x19d),'day':_0x31bd50(0x1e6)},_0x420946=new Intl['DateTimeFormat'](_0x31bd50(0x289),_0x11862c)['format'](_0x24ccfc),_0xea661b=new Intl[(_0x31bd50(0x183))](_0x31bd50(0x289),_0x11862c)['format'](_0x1a85e7);_0xb8b061+=_0x31bd50(0x1ad),_0xb8b061+=_0x31bd50(0x286),_0xb8b061+=_0x31bd50(0x1af),_0xb8b061+=_0x102639,_0xb8b061+=_0x31bd50(0x1d4),_0xb8b061+=_0x31bd50(0x1ac),_0xb8b061+=_0x31bd50(0x1ac);let _0x322f50='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x322f50+='<div\x20class=\x22row\x22>',_0x322f50+=_0x31bd50(0x286),_0x322f50+='<table>',_0x322f50+=_0x3f5660,_0x322f50+=_0x31bd50(0x1d4),_0x322f50+=_0x31bd50(0x1ac),_0x322f50+='</div>';let _0x4b5869=_0x31bd50(0x2dd);const _0x307997={'width':_0x31bd50(0x182),'height':_0x31bd50(0x205),'orientation':_0x31bd50(0x166),'border':{'top':_0x31bd50(0x2a1),'right':_0x31bd50(0x2a1),'bottom':_0x31bd50(0x2a1),'left':_0x31bd50(0x2a1)},'header':{'height':'60mm','contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4b5869+_0x31bd50(0x1d6)+_0x420946+_0x31bd50(0x262)+_0xea661b+_0x31bd50(0x187)},'footer':{'height':_0x31bd50(0x225),'contents':{'default':_0x31bd50(0x274)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x31bd50(0x29c)}}};if(_0x2c25d4=='on'){const _0x3e5198=cheerio[_0x31bd50(0x1c8)](_0x322f50);let _0x197642=[],_0x5de665=[],_0x5b1569=[];const _0x9522b6=_0x452b48=>{const _0x22f69e=_0x31bd50,_0x2bc7ff={'top':{'style':_0x22f69e(0x285),'color':{'rgb':_0x22f69e(0x29e)}},'bottom':{'style':_0x22f69e(0x285),'color':{'rgb':_0x22f69e(0x29e)}},'left':{'style':'thick','color':{'rgb':_0x22f69e(0x29e)}},'right':{'style':_0x22f69e(0x285),'color':{'rgb':_0x22f69e(0x29e)}}};if(_0x452b48){const _0x25618b=_0x452b48[_0x22f69e(0x2c5)](';')[_0x22f69e(0x1ca)]((_0x527280,_0x3e2fff)=>{const _0x3421b4=_0x22f69e,[_0x333de5,_0x3699d6]=_0x3e2fff[_0x3421b4(0x2c5)](':')[_0x3421b4(0x1ba)](_0x139c1c=>_0x139c1c[_0x3421b4(0x251)]());return _0x527280[_0x333de5]=_0x3699d6,_0x527280;},{});_0x25618b[_0x22f69e(0x1a5)]&&(_0x2bc7ff[_0x22f69e(0x26c)]['style']=_0x25618b[_0x22f69e(0x1a5)]['includes']('thin')?_0x22f69e(0x260):'medium'),_0x25618b[_0x22f69e(0x177)]&&(_0x2bc7ff['bottom']['style']=_0x25618b['border-bottom'][_0x22f69e(0x160)](_0x22f69e(0x260))?_0x22f69e(0x260):'medium'),_0x25618b['border-left']&&(_0x2bc7ff[_0x22f69e(0x17f)][_0x22f69e(0x1ed)]=_0x25618b[_0x22f69e(0x283)]['includes'](_0x22f69e(0x260))?_0x22f69e(0x260):'medium'),_0x25618b[_0x22f69e(0x2cf)]&&(_0x2bc7ff[_0x22f69e(0x2d9)][_0x22f69e(0x1ed)]=_0x25618b[_0x22f69e(0x2cf)]['includes'](_0x22f69e(0x260))?'thin':_0x22f69e(0x16a));}return _0x2bc7ff;};_0x3e5198('table\x20tr')[_0x31bd50(0x234)]((_0x357f5a,_0x15d282)=>{const _0x30891f=_0x31bd50;let _0x47b3ba=[],_0x73c773=0x0;while(_0x5b1569[_0x73c773]){_0x5b1569[_0x73c773]--,_0x73c773++;}_0x3e5198(_0x15d282)['find'](_0x30891f(0x176))[_0x30891f(0x234)]((_0xe6f8a3,_0x29fd40)=>{const _0x3f4734=_0x30891f;let _0x5bdf0b=_0x3e5198(_0x29fd40)[_0x3f4734(0x2d0)]()[_0x3f4734(0x251)](),_0x319b0e=parseFloat(_0x5bdf0b[_0x3f4734(0x2dc)](/,/g,'')),_0x11c63d={};!isNaN(_0x319b0e)?(_0x11c63d['v']=_0x319b0e,_0x11c63d['t']='n'):(_0x11c63d['v']=_0x5bdf0b,_0x11c63d['t']='s');const _0x253f53=_0x3e5198(_0x29fd40)['attr'](_0x3f4734(0x1ed)),_0x11ad38=_0x9522b6(_0x253f53);_0x11c63d['s']={'border':_0x11ad38},_0x47b3ba[_0x73c773]=_0x11c63d;let _0x4dd374=parseInt(_0x3e5198(_0x29fd40)[_0x3f4734(0x223)]('colspan'))||0x1,_0x4b0bb3=parseInt(_0x3e5198(_0x29fd40)[_0x3f4734(0x223)](_0x3f4734(0x227)))||0x1;(_0x4dd374>0x1||_0x4b0bb3>0x1)&&_0x5de665['push']({'s':{'r':_0x357f5a,'c':_0x73c773},'e':{'r':_0x357f5a+_0x4b0bb3-0x1,'c':_0x73c773+_0x4dd374-0x1}});for(let _0x3e47c1=0x0;_0x3e47c1<_0x4dd374;_0x3e47c1++){_0x4b0bb3>0x1&&(_0x5b1569[_0x73c773+_0x3e47c1]=_0x4b0bb3-0x1);}_0x73c773+=_0x4dd374;}),_0x197642[_0x30891f(0x2b8)](_0x47b3ba);});const _0x52466e=XLSX[_0x31bd50(0x17b)]['book_new'](),_0xd5bc56=XLSX['utils'][_0x31bd50(0x1f2)](_0x197642);_0x5de665[_0x31bd50(0x1a0)]>0x0&&(_0xd5bc56[_0x31bd50(0x186)]=_0x5de665);_0xd5bc56[_0x31bd50(0x269)]=_0x197642[0x0][_0x31bd50(0x1ba)](()=>({'wpx':0x64})),XLSX[_0x31bd50(0x17b)][_0x31bd50(0x266)](_0x52466e,_0xd5bc56,_0x31bd50(0x17d));const _0x184b08=XLSX[_0x31bd50(0x1d1)](_0x52466e,{'bookType':_0x31bd50(0x2d5),'type':_0x31bd50(0x1ab)});_0x1f43d1[_0x31bd50(0x2b6)](_0x31bd50(0x212),_0x31bd50(0x2e5)),_0x1f43d1['setHeader'](_0x31bd50(0x1be),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x1f43d1[_0x31bd50(0x17c)](_0x184b08);}else pdf['create'](_0xb8b061,_0x307997)[_0x31bd50(0x1f4)](function(_0x4226f1,_0x1da999){const _0x241825=_0x31bd50;if(_0x4226f1){console[_0x241825(0x1c0)]('PDF\x20Generation\x20Error:',_0x4226f1),_0x1f43d1[_0x241825(0x284)](0x1f4)[_0x241825(0x17c)](_0x241825(0x2b5)+_0x4226f1);return;}_0x1f43d1[_0x241825(0x2b6)](_0x241825(0x1be),_0x241825(0x243)),_0x1da999[_0x241825(0x268)](_0x1f43d1);});}),router[a0_0x4ca221(0x1f9)]('/total_sales_reports/view',auth,async(_0x163869,_0x288862)=>{const _0x259910=a0_0x4ca221;try{const {username:_0xf4077d,email:_0x28d710,role:_0x3c9cb2}=_0x163869[_0x259910(0x2b9)],_0x30886a=_0x163869[_0x259910(0x2b9)],_0x394773=await profile['findOne']({'email':_0x30886a[_0x259910(0x2eb)]}),_0x20c569={'year':'numeric','month':_0x259910(0x19d),'day':_0x259910(0x1e6)},_0x2af98a=await master_shop[_0x259910(0x2b2)](),_0x4cdd5d=await product[_0x259910(0x2b2)](),_0x5538a7=await warehouse[_0x259910(0x261)]([{'$unwind':_0x259910(0x163)},{'$lookup':{'from':_0x259910(0x1f3),'localField':'product_details.product_name','foreignField':_0x259910(0x200),'as':_0x259910(0x201)}},{'$unwind':_0x259910(0x256)},{'$project':{'product_name':_0x259910(0x20c),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x259910(0x173),'product_stock':{'$sum':_0x259910(0x23f)}}}]),_0x585b33=await staff['findOne']({'email':_0x30886a['email']});if(_0x2af98a[0x0]['language']=='English\x20(US)')var _0x42f0cb=users[_0x259910(0x246)];else{if(_0x2af98a[0x0][_0x259910(0x196)]=='Hindi')var _0x42f0cb=users['Hindi'];else{if(_0x2af98a[0x0]['language']==_0x259910(0x1aa))var _0x42f0cb=users[_0x259910(0x1aa)];else{if(_0x2af98a[0x0][_0x259910(0x196)]=='Spanish')var _0x42f0cb=users[_0x259910(0x2e6)];else{if(_0x2af98a[0x0][_0x259910(0x196)]==_0x259910(0x26d))var _0x42f0cb=users[_0x259910(0x26d)];else{if(_0x2af98a[0x0][_0x259910(0x196)]==_0x259910(0x195))var _0x42f0cb=users[_0x259910(0x1a7)];else{if(_0x2af98a[0x0]['language']==_0x259910(0x28e))var _0x42f0cb=users[_0x259910(0x28e)];else{if(_0x2af98a[0x0][_0x259910(0x196)]=='Arabic\x20(ae)')var _0x42f0cb=users[_0x259910(0x2a0)];}}}}}}}_0x288862[_0x259910(0x2c2)](_0x259910(0x1f8),{'success':_0x163869[_0x259910(0x26a)](_0x259910(0x1cc)),'errors':_0x163869['flash']('errors'),'alldata':_0x4cdd5d,'profile':_0x394773,'master_shop':_0x2af98a,'role':_0x30886a,'product_stock':_0x5538a7,'language':_0x42f0cb,'staff_arr':_0x585b33});}catch(_0x53e147){}});async function dataSalesReports(_0xd10259,_0x493e91,_0x457432){const _0x3e4725=a0_0x4ca221;let _0x14c7d6='';const _0x38e7cf=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0xd10259,'$lte':_0x493e91},'sales_staff_id':_0x457432}},{'$unwind':_0x3e4725(0x1cd)},{'$match':{'sale_product.isFG':_0x3e4725(0x250)}},{'$group':{'_id':{'product_name':_0x3e4725(0x26b),'product_code':_0x3e4725(0x1ae)},'sumqty':{'$sum':_0x3e4725(0x1df)},'totalPrice':{'$sum':_0x3e4725(0x19c)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x2760e6=0x0,_0x19b1cd=0x0;for(let _0x58f3e0=0x0;_0x58f3e0<=_0x38e7cf[_0x3e4725(0x1a0)]-0x1;_0x58f3e0++){const _0x2c1727=_0x38e7cf[_0x58f3e0];var _0x3893d2=_0x2c1727[_0x3e4725(0x242)][_0x3e4725(0x21e)](undefined),_0x2d40a2=_0x2c1727[_0x3e4725(0x240)][_0x3e4725(0x21e)](undefined);_0x14c7d6+=_0x3e4725(0x188),_0x14c7d6+=_0x3e4725(0x20a)+_0x2c1727[_0x3e4725(0x213)][_0x3e4725(0x1a9)]+'</td>',_0x14c7d6+=_0x3e4725(0x20a)+_0x2c1727[_0x3e4725(0x213)][_0x3e4725(0x18d)]+_0x3e4725(0x217),_0x14c7d6+=_0x3e4725(0x20a)+formatNumber(_0x2c1727['sumqty']['toFixed'](0x2))+'</td>',_0x14c7d6+=_0x3e4725(0x20a)+formatNumber(_0x2c1727[_0x3e4725(0x242)]['toFixed'](0x2))+_0x3e4725(0x217),_0x14c7d6+=_0x3e4725(0x206),_0x2760e6+=parseFloat(_0x2c1727[_0x3e4725(0x240)]),_0x19b1cd+=parseFloat(_0x2c1727[_0x3e4725(0x242)]);}var _0x11e0b3=_0x19b1cd['toLocaleString'](undefined),_0x47cfdb=_0x2760e6['toLocaleString'](undefined);return _0x14c7d6+=_0x3e4725(0x188),_0x14c7d6+=_0x3e4725(0x1d3),_0x14c7d6+=_0x3e4725(0x2a9)+formatNumber(_0x2760e6[_0x3e4725(0x2b0)](0x2))+_0x3e4725(0x2bd),_0x14c7d6+=_0x3e4725(0x2a9)+formatNumber(_0x19b1cd[_0x3e4725(0x2b0)](0x2))+'</b></td>',_0x14c7d6+=_0x3e4725(0x206),_0x14c7d6;}router['post'](a0_0x4ca221(0x1ef),auth,async(_0x334aa7,_0x24d713)=>{const _0x81e115=a0_0x4ca221;try{const {from_date:_0x3278a5,to_date:_0x1c9f79,isExcel:_0x55d7c3}=_0x334aa7[_0x81e115(0x271)],_0x41d39e=_0x334aa7['user'],_0x321730=await staff[_0x81e115(0x1ff)]({'email':_0x41d39e[_0x81e115(0x2eb)]});let _0x58c09d=_0x81e115(0x203);var _0x4cd7e4=new Date(_0x3278a5),_0x2bde5d=new Date(_0x1c9f79);const _0x2bf7dd={'year':'numeric','month':'long','day':'numeric'},_0x33b77f=new Intl['DateTimeFormat'](_0x81e115(0x289),_0x2bf7dd)['format'](_0x4cd7e4),_0x2bdc6d=new Intl[(_0x81e115(0x183))]('en-US',_0x2bf7dd)[_0x81e115(0x204)](_0x2bde5d);var _0x3c2d90=await dataSalesReports(_0x3278a5,_0x1c9f79,_0x321730[_0x81e115(0x213)][_0x81e115(0x1c1)]());_0x58c09d+='<div\x20class=\x22row\x22>',_0x58c09d+=_0x81e115(0x1bd),_0x58c09d+=_0x81e115(0x1af),_0x58c09d+=_0x81e115(0x188),_0x58c09d+='<th>\x20ITEM\x20CODE\x20</th>',_0x58c09d+=_0x81e115(0x252),_0x58c09d+=_0x81e115(0x25f),_0x58c09d+=_0x81e115(0x259),_0x58c09d+=_0x81e115(0x188),_0x58c09d+=_0x3c2d90,_0x58c09d+=_0x81e115(0x206),_0x58c09d+=_0x81e115(0x1ac),_0x58c09d+=_0x81e115(0x1ac);let _0x2cfc22='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x41b2eb={'width':'15in','height':_0x81e115(0x205),'orientation':_0x81e115(0x166),'border':{'top':'0.1in','right':_0x81e115(0x2a1),'bottom':'0.1in','left':_0x81e115(0x2a1)},'header':{'height':_0x81e115(0x209),'contents':_0x81e115(0x1b1)+_0x2cfc22+_0x81e115(0x220)+_0x321730[_0x81e115(0x200)]+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x33b77f+_0x81e115(0x262)+_0x2bdc6d+_0x81e115(0x187)},'footer':{'height':_0x81e115(0x225),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x81e115(0x29c)}}};if(_0x55d7c3=='on'){const _0x3bcc6b=cheerio['load'](_0x58c09d);let _0x4e217e=[],_0xf06b0f=[],_0x21a305=[];const _0x2b6bdc=_0x390f44=>{const _0x36ff37=_0x81e115,_0x4d9888={'top':{'style':_0x36ff37(0x285),'color':{'rgb':_0x36ff37(0x29e)}},'bottom':{'style':_0x36ff37(0x285),'color':{'rgb':_0x36ff37(0x29e)}},'left':{'style':_0x36ff37(0x285),'color':{'rgb':_0x36ff37(0x29e)}},'right':{'style':_0x36ff37(0x285),'color':{'rgb':_0x36ff37(0x29e)}}};if(_0x390f44){const _0x59fcf9=_0x390f44[_0x36ff37(0x2c5)](';')[_0x36ff37(0x1ca)]((_0xfd0c16,_0x463eae)=>{const [_0x3df538,_0x13d7dd]=_0x463eae['split'](':')['map'](_0x50fcb8=>_0x50fcb8['trim']());return _0xfd0c16[_0x3df538]=_0x13d7dd,_0xfd0c16;},{});_0x59fcf9[_0x36ff37(0x1a5)]&&(_0x4d9888[_0x36ff37(0x26c)]['style']=_0x59fcf9[_0x36ff37(0x1a5)][_0x36ff37(0x160)](_0x36ff37(0x260))?_0x36ff37(0x260):'medium'),_0x59fcf9[_0x36ff37(0x177)]&&(_0x4d9888[_0x36ff37(0x299)][_0x36ff37(0x1ed)]=_0x59fcf9['border-bottom'][_0x36ff37(0x160)]('thin')?_0x36ff37(0x260):'medium'),_0x59fcf9['border-left']&&(_0x4d9888['left'][_0x36ff37(0x1ed)]=_0x59fcf9[_0x36ff37(0x283)][_0x36ff37(0x160)](_0x36ff37(0x260))?'thin':_0x36ff37(0x16a)),_0x59fcf9[_0x36ff37(0x2cf)]&&(_0x4d9888[_0x36ff37(0x2d9)][_0x36ff37(0x1ed)]=_0x59fcf9['border-right']['includes'](_0x36ff37(0x260))?_0x36ff37(0x260):'medium');}return _0x4d9888;};_0x3bcc6b(_0x81e115(0x1de))[_0x81e115(0x234)]((_0x24153c,_0x5255db)=>{const _0x51843c=_0x81e115;let _0x5a06a7=[],_0x26ae29=0x0;while(_0x21a305[_0x26ae29]){_0x21a305[_0x26ae29]--,_0x26ae29++;}_0x3bcc6b(_0x5255db)[_0x51843c(0x2b2)]('td,\x20th')[_0x51843c(0x234)]((_0x12c625,_0xd79a2f)=>{const _0x599e7b=_0x51843c;let _0x3076b1=_0x3bcc6b(_0xd79a2f)[_0x599e7b(0x2d0)]()[_0x599e7b(0x251)](),_0x254b0f=parseFloat(_0x3076b1[_0x599e7b(0x2dc)](/,/g,'')),_0x49d1cd={};!isNaN(_0x254b0f)?(_0x49d1cd['v']=_0x254b0f,_0x49d1cd['t']='n'):(_0x49d1cd['v']=_0x3076b1,_0x49d1cd['t']='s');const _0x38c0e8=_0x3bcc6b(_0xd79a2f)[_0x599e7b(0x223)](_0x599e7b(0x1ed)),_0x4e61fd=_0x2b6bdc(_0x38c0e8);_0x49d1cd['s']={'border':_0x4e61fd},_0x5a06a7[_0x26ae29]=_0x49d1cd;let _0x2afc8d=parseInt(_0x3bcc6b(_0xd79a2f)[_0x599e7b(0x223)](_0x599e7b(0x2d3)))||0x1,_0x34965c=parseInt(_0x3bcc6b(_0xd79a2f)['attr'](_0x599e7b(0x227)))||0x1;(_0x2afc8d>0x1||_0x34965c>0x1)&&_0xf06b0f[_0x599e7b(0x2b8)]({'s':{'r':_0x24153c,'c':_0x26ae29},'e':{'r':_0x24153c+_0x34965c-0x1,'c':_0x26ae29+_0x2afc8d-0x1}});for(let _0x59c28e=0x0;_0x59c28e<_0x2afc8d;_0x59c28e++){_0x34965c>0x1&&(_0x21a305[_0x26ae29+_0x59c28e]=_0x34965c-0x1);}_0x26ae29+=_0x2afc8d;}),_0x4e217e[_0x51843c(0x2b8)](_0x5a06a7);});const _0x2f0e6c=XLSX[_0x81e115(0x17b)][_0x81e115(0x22e)](),_0x329fc0=XLSX[_0x81e115(0x17b)][_0x81e115(0x1f2)](_0x4e217e);_0xf06b0f['length']>0x0&&(_0x329fc0[_0x81e115(0x186)]=_0xf06b0f);_0x329fc0[_0x81e115(0x269)]=_0x4e217e[0x0][_0x81e115(0x1ba)](()=>({'wpx':0x64})),XLSX[_0x81e115(0x17b)][_0x81e115(0x266)](_0x2f0e6c,_0x329fc0,_0x81e115(0x17d));const _0x4d7e3f=XLSX['write'](_0x2f0e6c,{'bookType':'xlsx','type':_0x81e115(0x1ab)});_0x24d713[_0x81e115(0x2b6)]('Content-Disposition',_0x81e115(0x2e5)),_0x24d713[_0x81e115(0x2b6)](_0x81e115(0x1be),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x24d713['send'](_0x4d7e3f);}else pdf['create'](_0x58c09d,_0x41b2eb)[_0x81e115(0x1f4)](function(_0x1a8cc7,_0x1461f9){const _0x27711b=_0x81e115;if(_0x1a8cc7){_0x24d713['status'](0x1f4)[_0x27711b(0x17c)]('Error\x20generating\x20PDF');return;}_0x24d713['setHeader'](_0x27711b(0x1be),'application/pdf'),_0x1461f9[_0x27711b(0x268)](_0x24d713);});}catch(_0x4d8dc8){}}),router[a0_0x4ca221(0x1f9)]('/inventory_sum/view',auth,async(_0x2a98c4,_0x55f6a6)=>{const _0x1f7d9b=a0_0x4ca221;try{const {username:_0x14ae73,email:_0x2e2245,role:_0x22a527}=_0x2a98c4[_0x1f7d9b(0x2b9)],_0x4718ee=_0x2a98c4[_0x1f7d9b(0x2b9)],_0x4258cd=await profile['findOne']({'email':_0x4718ee[_0x1f7d9b(0x2eb)]}),_0x5d9e00={'year':_0x1f7d9b(0x1e6),'month':_0x1f7d9b(0x19d),'day':_0x1f7d9b(0x1e6)},_0x2d397f=await master_shop[_0x1f7d9b(0x2b2)](),_0x122f24=await product['find'](),_0x28bda9=await warehouse[_0x1f7d9b(0x261)]([{'$unwind':_0x1f7d9b(0x163)},{'$lookup':{'from':_0x1f7d9b(0x1f3),'localField':'product_details.product_name','foreignField':'name','as':'product_docs'}},{'$unwind':_0x1f7d9b(0x256)},{'$project':{'product_name':_0x1f7d9b(0x20c),'product_stock':_0x1f7d9b(0x1c5)}},{'$group':{'_id':_0x1f7d9b(0x173),'product_stock':{'$sum':_0x1f7d9b(0x23f)}}}]);if(_0x2d397f[0x0][_0x1f7d9b(0x196)]==_0x1f7d9b(0x2c6))var _0x58541f=users[_0x1f7d9b(0x246)];else{if(_0x2d397f[0x0][_0x1f7d9b(0x196)]==_0x1f7d9b(0x2de))var _0x58541f=users[_0x1f7d9b(0x2de)];else{if(_0x2d397f[0x0][_0x1f7d9b(0x196)]==_0x1f7d9b(0x1aa))var _0x58541f=users[_0x1f7d9b(0x1aa)];else{if(_0x2d397f[0x0][_0x1f7d9b(0x196)]=='Spanish')var _0x58541f=users[_0x1f7d9b(0x2e6)];else{if(_0x2d397f[0x0][_0x1f7d9b(0x196)]==_0x1f7d9b(0x26d))var _0x58541f=users['French'];else{if(_0x2d397f[0x0]['language']==_0x1f7d9b(0x195))var _0x58541f=users[_0x1f7d9b(0x1a7)];else{if(_0x2d397f[0x0][_0x1f7d9b(0x196)]==_0x1f7d9b(0x28e))var _0x58541f=users[_0x1f7d9b(0x28e)];else{if(_0x2d397f[0x0][_0x1f7d9b(0x196)]==_0x1f7d9b(0x1bb))var _0x58541f=users[_0x1f7d9b(0x2a0)];}}}}}}}_0x55f6a6[_0x1f7d9b(0x2c2)](_0x1f7d9b(0x19b),{'success':_0x2a98c4[_0x1f7d9b(0x26a)](_0x1f7d9b(0x1cc)),'errors':_0x2a98c4[_0x1f7d9b(0x26a)](_0x1f7d9b(0x18f)),'alldata':_0x122f24,'profile':_0x4258cd,'master_shop':_0x2d397f,'role':_0x4718ee,'product_stock':_0x28bda9,'language':_0x58541f});}catch(_0x5eaf6d){}});function a0_0x46f1(){const _0x4dac02=['<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','rowspan','/agent_reports/view','prod_cat','<th>\x20BEG\x20BALANCE\x20</th>','sales_info','product_info','$products','book_new','category','8258690DhXjfI','check_no','<td\x20colspan=\x22','/agent_reports/pdf','each','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','$products.product_details.brand','$_id.brand','dsi_sales','$product_code','2908241XRrITs','exceljs','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','totalQty','multer','$product_stock','sumqty','isArray','totalPrice','application/pdf','\x22><b></b></td>','product_details.product_name','English','NetPrice','$customer','$sale_product.adj_discount','brand','getFullYear','cash','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','ObjectId','<td\x20class=\x22row_data\x22></td>','false','trim','<th>\x20ITEM\x20DESCRIPTION\x20</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','/balance/view','$sales_staff_id','$product_docs','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','<th>\x20INVOICE\x20AMOUNT\x20</th>','$product_list','save','$amount','/agent/pdf','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<th>\x20QTY\x20SOLD\x20</th>','thin','aggregate','\x20-\x20','mongoose','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','$category','book_append_sheet','blob-stream','pipe','!cols','flash','$sale_product.product_name','top','French','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','product_details','body','true','Products\x20find_data','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<th\x20rowspan=\x272\x27>Production</th>','Products\x20warehouse_data','sales_bkg','$products.product_details.gross_price','$product_info.name','842818hrggwa','\x22\x20class=\x22cat_data\x22>','$products.product_details','Asia/Manila','customer','$check_no','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','$product_info.gross_price','$sale_product.isFG','border-left','status','thick','<div\x20\x20id=\x22table-conatainer\x22>','stock','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','en-US','$bank','product_stock','due_date','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','Chinese','<td\x20class=\x22cat_data\x22></td>','forEach','<th\x20colspan=\x272\x27>SOLD</th>','express','<td\x20colspan=\x223\x22><b>TOTAL<b>','salesman_data','then','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$cash','$product_info.brand','bottom','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','/dev/null','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','000000','$products.product_details.category','Arabic','0.1in','cat_brand','$product_info.product_code','/reports/dsrr/view','<th\x20rowspan=\x272\x27>Products</th>','$discount','9XAtiQy','findById','<td\x20class=\x22row_data\x22><b>','toLocaleDateString','/agent_reports/sales_ad','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','dataqty','\x20-\x20HH','<th>\x20ITEM\x20CODE\x20</th>','toFixed','pdfkit-table','find','4psQlRL','$product_list.product_name','Error\x20generating\x20PDF','setHeader','<th>\x20ENDING\x20BALANCE\x20</th>','push','user','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','$adj_discount','</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','dssr_view','$sale_product.stock','path','render','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','<h1>JAKA\x20EQUITIES\x20CORP</h1>','split','English\x20(US)','$products.qty','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','toISOString','$_id.dsi','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','/dsrr_admin/pdf_admin','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','sales_man_code','border-right','text','$sale_product._id','No\x20data\x20was\x20Found!','colspan','window.onload\x20=\x20function()\x20{','xlsx','</p>','<div\x20style=\x22page-break-before:\x20always;\x22></div>','sales_ext','right','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22row_data\x22>0</td>','replace','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','Hindi','filter','\x22><b>','6422304CQAoZk','3785994JKpEML','<thead>','/dl_excel','attachment;\x20filename=\x22sales_report.xlsx\x22','Spanish','$name','referenceNumber','$product_info.category','isFG','email','$product_list.product_code','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','</thead>','includes','$products.adj_discount','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','$product_details','../models/all_models','<td\x20class=\x22cat_data\x22><b>FG</b></td>','landscape','html-pdf','window.print();','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','medium','/dsrr/view','\x20-\x20STD','totalGross','</script>','getDate','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','setDate','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','$product_name','$_id.customer','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','td,\x20th','border-bottom','<p>','1741827JQjfrp','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','utils','send','Sales\x20Report','/dsrr_admin/view_data/:id','left','express/lib/response','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','15in','DateTimeFormat','$due_date','$_id.status_data','!merges','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<tr>','$date','<tbody>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','/inventory_sum/pdf','product_name','<th\x20rowspan=\x272\x27>Category</th>','errors','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','$totalGross','agent_sales','totalQTY','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','Portuguese\x20(BR)','language','</th>','cheerio','adj_discount','$product_info','inventory_sum','$sale_product.totalprice','long','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','/agent/view','length','slice','$products.NetPrice','redirect','<script>','border-top','date_include','Portuguese','<th>X-Truck</th>','product_code','German','buffer','</div>','<div\x20class=\x22row\x22>','$sale_product.product_code','<table>','$_id.category','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','totalQTYsum','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','NumberFormat','amount','getMonth','map','Arabic\x20(ae)','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','<div\x20class=\x22col-sm-11\x22>','Content-Type','$_id.date','error','valueOf','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','sale_product.product_code','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','$product_details.product_stock','$sales_info._id','$product.product_name','load','../public/language/languages.json','reduce','</tbody>','success','$sale_product','staffs','create','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','write','Products\x20master','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','</table>','dsi','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<p>FINISHED\x20GOODS\x20INVENTORY</p>','post','<p>INVENTORY\x20SUMMARY</p>','$NetPrice','dssr_view_admin','table\x20tr','$sale_product.real_qty_unit_val','$products.discount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','balanced','html','Types','$products.product_details.prod_id','numeric','Letter','brandCount','$sale_product.discount','sales_staff_id','2792695ZfHZeC','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','style','note','/total_sales_reports/pdf','beg_bal','excel','aoa_to_sheet','products','toStream','$product.product_code','$sales_info','$totalQty','sales_reports','get','exports','/agent_reports/pdf_admin','$brand','qty','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','findOne','name','product_docs','$dsi','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','format','8.5in','</tr>','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','60mm','<td\x20class=\x22row_data\x22>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','$product_details.product_name','$sales_info.name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','canvas','json','Content-Disposition','_id','/balance/pdf','<td\x20class=\x22cat_data\x22>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','</td>','discount','2AqvBUP','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','bank','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','log','toLocaleString','sort','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','Household','image','attr','$sale_product.prod_cat','20mm'];a0_0x46f1=function(){return _0x4dac02;};return a0_0x46f1();}async function dataInventoryReports(_0x2d2c1f,_0xe7910f,_0x56e2e5){const _0x3d72d7=a0_0x4ca221,_0x23f6b9=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x2d2c1f,'$lte':_0xe7910f},'sales_staff_id':_0x56e2e5}},{'$unwind':_0x3d72d7(0x1cd)},{'$group':{'_id':{'product_name':_0x3d72d7(0x26b),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x541a0a=mongoose[_0x3d72d7(0x1e4)][_0x3d72d7(0x24e)],_0x2b5aee=await staff[_0x3d72d7(0x261)]([{'$match':{'_id':_0x541a0a(_0x56e2e5)}},{'$unwind':_0x3d72d7(0x25a)},{'$match':{'product_list.isConfirm':_0x3d72d7(0x272)}},{'$group':{'_id':{'product_name':_0x3d72d7(0x2b4),'product_code':_0x3d72d7(0x2ec)},'sumqty':{'$sum':'$product_list.product_stock'}}},{'$sort':{'_id.product_name':0x1}}]),_0xb06241=await sales_inv_data['aggregate']([{'$match':{'date':{'$gte':_0x2d2c1f,'$lte':_0xe7910f},'sales_staff_id':_0x56e2e5}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x3d72d7(0x26b),'product_code':_0x3d72d7(0x1ae)},'totalQTYsum':{'$sum':_0x3d72d7(0x2c0)}}}]);console[_0x3d72d7(0x21d)](_0xb06241);let _0x59c12b='';var _0x98c1be=0x0;for(let _0x34aa40=0x0;_0x34aa40<=_0x2b5aee[_0x3d72d7(0x1a0)]-0x1;_0x34aa40++){const _0x9b2e98=_0x2b5aee[_0x34aa40];_0x59c12b+='<tr>',_0x59c12b+=_0x3d72d7(0x24d)+_0x9b2e98[_0x3d72d7(0x213)][_0x3d72d7(0x1a9)]+_0x3d72d7(0x217),_0x59c12b+=_0x3d72d7(0x2be)+_0x9b2e98[_0x3d72d7(0x213)]['product_name']+_0x3d72d7(0x217);var _0x4629b8=_0x9b2e98['sumqty'],_0x3a4fa5=0x0;for(let _0x206919=0x0;_0x206919<=_0x23f6b9[_0x3d72d7(0x1a0)]-0x1;_0x206919++){const _0x444ef3=_0x23f6b9[_0x206919];_0x9b2e98[_0x3d72d7(0x213)][_0x3d72d7(0x1a9)]==_0x444ef3[_0x3d72d7(0x213)][_0x3d72d7(0x1a9)]&&_0x9b2e98[_0x3d72d7(0x213)][_0x3d72d7(0x18d)]==_0x444ef3['_id'][_0x3d72d7(0x18d)]&&(_0x3a4fa5=_0x444ef3[_0x3d72d7(0x240)]);}var _0x49beb2=0x0;for(let _0x3d094b=0x0;_0x3d094b<=_0xb06241['length']-0x1;_0x3d094b++){const _0x128ead=_0xb06241[_0x3d094b];_0x9b2e98['_id'][_0x3d72d7(0x1a9)]==_0x128ead['_id'][_0x3d72d7(0x1a9)]&&_0x9b2e98[_0x3d72d7(0x213)][_0x3d72d7(0x18d)]==_0x128ead[_0x3d72d7(0x213)]['product_name']&&(_0x49beb2=_0x128ead[_0x3d72d7(0x1b5)]);}_0x98c1be=_0x4629b8-_0x49beb2+_0x3a4fa5,_0x59c12b+=_0x3d72d7(0x20a)+_0x98c1be+'</td>';let _0x547f19=![];for(let _0x4168d4=0x0;_0x4168d4<=_0xb06241[_0x3d72d7(0x1a0)]-0x1;_0x4168d4++){const _0x1959ee=_0xb06241[_0x4168d4];if(_0x9b2e98['_id'][_0x3d72d7(0x1a9)]==_0x1959ee[_0x3d72d7(0x213)]['product_code']&&_0x9b2e98[_0x3d72d7(0x213)][_0x3d72d7(0x18d)]==_0x1959ee[_0x3d72d7(0x213)][_0x3d72d7(0x18d)]){_0x59c12b+='<td\x20class=\x22row_data\x22>'+_0x1959ee[_0x3d72d7(0x1b5)]+_0x3d72d7(0x217),_0x547f19=!![];break;}}!_0x547f19&&(_0x59c12b+=_0x3d72d7(0x2db));let _0x2df297=![];for(let _0x4132ae=0x0;_0x4132ae<=_0x23f6b9[_0x3d72d7(0x1a0)]-0x1;_0x4132ae++){const _0x264375=_0x23f6b9[_0x4132ae];if(_0x9b2e98[_0x3d72d7(0x213)][_0x3d72d7(0x1a9)]==_0x264375['_id'][_0x3d72d7(0x1a9)]&&_0x9b2e98[_0x3d72d7(0x213)][_0x3d72d7(0x18d)]==_0x264375[_0x3d72d7(0x213)][_0x3d72d7(0x18d)]){_0x59c12b+='<td\x20class=\x22row_data\x22>'+_0x264375[_0x3d72d7(0x240)]+_0x3d72d7(0x217),_0x2df297=!![];break;}}!_0x2df297&&(_0x59c12b+='<td\x20class=\x22row_data\x22>0</td>'),_0x59c12b+=_0x3d72d7(0x20a)+_0x9b2e98[_0x3d72d7(0x240)]+_0x3d72d7(0x217),_0x59c12b+=_0x3d72d7(0x206);}return _0x59c12b;}router['post'](a0_0x4ca221(0x18c),auth,async(_0x107ef3,_0x1be461)=>{const _0x40c1d7=a0_0x4ca221;try{const {from_date:_0x520bd9,to_date:_0x4a8965}=_0x107ef3[_0x40c1d7(0x271)],_0x1a32fc=_0x107ef3[_0x40c1d7(0x2b9)],_0xedb88d=await staff[_0x40c1d7(0x1ff)]({'email':_0x1a32fc['email']});let _0x31d961='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x24ff52=new Date(_0x520bd9),_0x1fa341=new Date(_0x4a8965);const _0x1080d9={'year':_0x40c1d7(0x1e6),'month':_0x40c1d7(0x19d),'day':_0x40c1d7(0x1e6)},_0xa83b74=new Intl[(_0x40c1d7(0x183))](_0x40c1d7(0x289),_0x1080d9)[_0x40c1d7(0x204)](_0x24ff52),_0x588c4f=new Intl[(_0x40c1d7(0x183))]('en-US',_0x1080d9)[_0x40c1d7(0x204)](_0x1fa341);var _0x192bc7=await dataInventoryReports(_0x520bd9,_0x4a8965,_0xedb88d[_0x40c1d7(0x213)][_0x40c1d7(0x1c1)]());_0x31d961+=_0x40c1d7(0x2c4),_0x31d961+=_0x40c1d7(0x1db),_0x31d961+='<p>'+_0xa83b74+'\x20-\x20'+_0x588c4f+'</p>',_0x31d961+=_0x40c1d7(0x1ad),_0x31d961+=_0x40c1d7(0x1bd),_0x31d961+=_0x40c1d7(0x1af),_0x31d961+=_0x40c1d7(0x188),_0x31d961+=_0x40c1d7(0x2af),_0x31d961+=_0x40c1d7(0x252),_0x31d961+=_0x40c1d7(0x22a),_0x31d961+='<th>\x20INCOMING\x20</th>',_0x31d961+='<th>\x20SALES\x20</th>',_0x31d961+=_0x40c1d7(0x2b7),_0x31d961+=_0x40c1d7(0x188),_0x31d961+=_0x192bc7,_0x31d961+=_0x40c1d7(0x206),_0x31d961+='</div>',_0x31d961+=_0x40c1d7(0x1ac);const _0x278a61={'format':'Letter','orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x40c1d7(0x29c)}}};pdf['create'](_0x31d961,_0x278a61)[_0x40c1d7(0x1f4)](function(_0x578781,_0x28834c){const _0x27479d=_0x40c1d7;if(_0x578781){_0x1be461[_0x27479d(0x284)](0x1f4)['send'](_0x27479d(0x2b5));return;}_0x1be461[_0x27479d(0x2b6)](_0x27479d(0x1be),_0x27479d(0x243)),_0x28834c[_0x27479d(0x268)](_0x1be461);});}catch(_0x2930e9){}}),router[a0_0x4ca221(0x1f9)](a0_0x4ca221(0x16b),auth,async(_0xa9d14c,_0x4d8aa5)=>{const _0x47afd9=a0_0x4ca221;try{const {username:_0x465ad0,email:_0x11104d,role:_0x58f807}=_0xa9d14c['user'],_0x2cbdbd=_0xa9d14c['user'],_0x5f42ee=await profile['findOne']({'email':_0x2cbdbd[_0x47afd9(0x2eb)]}),_0x4a5cde={'year':_0x47afd9(0x1e6),'month':_0x47afd9(0x19d),'day':'numeric'},_0x2950dc=await master_shop[_0x47afd9(0x2b2)]();console[_0x47afd9(0x21d)]('Products\x20master',_0x2950dc);const _0x321711=await product[_0x47afd9(0x2b2)]();console[_0x47afd9(0x21d)](_0x47afd9(0x273),_0x321711);const _0x587b1c=await warehouse[_0x47afd9(0x261)]([{'$unwind':_0x47afd9(0x163)},{'$lookup':{'from':'products','localField':_0x47afd9(0x245),'foreignField':_0x47afd9(0x200),'as':'product_docs'}},{'$unwind':_0x47afd9(0x256)},{'$project':{'product_name':_0x47afd9(0x20c),'product_stock':_0x47afd9(0x1c5)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x47afd9(0x23f)}}}]);console['log'](_0x47afd9(0x276),_0x587b1c),_0x587b1c[_0x47afd9(0x290)](_0x1545b2=>{const _0x423328=_0x47afd9,_0x28ee10=_0x321711[_0x423328(0x1ba)](_0x168ece=>{const _0x4724b2=_0x423328;_0x168ece[_0x4724b2(0x200)]==_0x1545b2[_0x4724b2(0x213)]&&(_0x168ece[_0x4724b2(0x287)]=parseInt(_0x168ece[_0x4724b2(0x287)])+parseInt(_0x1545b2[_0x4724b2(0x28b)]));});});const _0x5c036f=await staff[_0x47afd9(0x1ff)]({'email':_0x2cbdbd[_0x47afd9(0x2eb)]});if(_0x2950dc[0x0][_0x47afd9(0x196)]==_0x47afd9(0x2c6))var _0x565865=users[_0x47afd9(0x246)];else{if(_0x2950dc[0x0][_0x47afd9(0x196)]==_0x47afd9(0x2de))var _0x565865=users[_0x47afd9(0x2de)];else{if(_0x2950dc[0x0][_0x47afd9(0x196)]=='German')var _0x565865=users[_0x47afd9(0x1aa)];else{if(_0x2950dc[0x0][_0x47afd9(0x196)]=='Spanish')var _0x565865=users[_0x47afd9(0x2e6)];else{if(_0x2950dc[0x0][_0x47afd9(0x196)]==_0x47afd9(0x26d))var _0x565865=users[_0x47afd9(0x26d)];else{if(_0x2950dc[0x0][_0x47afd9(0x196)]==_0x47afd9(0x195))var _0x565865=users['Portuguese'];else{if(_0x2950dc[0x0][_0x47afd9(0x196)]==_0x47afd9(0x28e))var _0x565865=users['Chinese'];else{if(_0x2950dc[0x0][_0x47afd9(0x196)]==_0x47afd9(0x1bb))var _0x565865=users['Arabic'];}}}}}}}_0x4d8aa5[_0x47afd9(0x2c2)](_0x47afd9(0x2bf),{'success':_0xa9d14c[_0x47afd9(0x26a)]('success'),'errors':_0xa9d14c['flash']('errors'),'alldata':_0x321711,'profile':_0x5f42ee,'master_shop':_0x2950dc,'role':_0x2cbdbd,'product_stock':_0x587b1c,'language':_0x565865,'staff_arr':_0x5c036f});}catch(_0xc45b99){}});async function agentsdataDSICheck_DSRR(_0x5232c4,_0x21d3d0,_0x3b920b,_0x2b814d){const _0x3f45a6=a0_0x4ca221;let _0x57c1f6=new Date(_0x5232c4);_0x57c1f6[_0x3f45a6(0x171)](_0x57c1f6[_0x3f45a6(0x16f)]()-0x1);let _0x5d60b9=_0x57c1f6[_0x3f45a6(0x2c9)]()[_0x3f45a6(0x2c5)]('T')[0x0];const _0x49387d=await product['aggregate']([{'$group':{'_id':{'brand':_0x3f45a6(0x1fc),'category':'$category'},'products':{'$push':{'name':_0x3f45a6(0x2e7),'product_code':_0x3f45a6(0x239)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x537ae2=[];_0x537ae2[_0x3f45a6(0x2a2)]=[];for(let _0x4e5752=0x0;_0x4e5752<=_0x49387d[_0x3f45a6(0x1a0)]-0x1;_0x4e5752++){const _0x5858e2=_0x49387d[_0x4e5752];_0x537ae2['cat_brand'][_0x3f45a6(0x2b8)](_0x5858e2);}const _0x5b1c73=await product[_0x3f45a6(0x261)]([{'$group':{'_id':{'category':_0x3f45a6(0x265)},'products':{'$push':{'brand':'$brand','product_code':_0x3f45a6(0x239),'product_name':_0x3f45a6(0x2e7)}}}},{'$sort':{'_id.category':-0x1}}]),_0x17dc94=await product[_0x3f45a6(0x261)]([{'$group':{'_id':{'category':_0x3f45a6(0x265),'brand':'$brand'}}},{'$group':{'_id':_0x3f45a6(0x1b0),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2e010f=await sales_sa[_0x3f45a6(0x261)]([{'$match':{'date':_0x5232c4,'sales_staff_id':_0x21d3d0,'sale_product.isFG':_0x3f45a6(0x250)}},{'$unwind':_0x3f45a6(0x1cd)},{'$lookup':{'from':'products','localField':_0x3f45a6(0x1c3),'foreignField':_0x3f45a6(0x1a9),'as':_0x3f45a6(0x22c)}},{'$unwind':_0x3f45a6(0x19a)},{'$group':{'_id':{'dsi':_0x3f45a6(0x202),'date':_0x3f45a6(0x189),'customer':_0x3f45a6(0x248),'status_data':'$status_data'},'totalQty':{'$sum':_0x3f45a6(0x1df)},'cash':{'$first':_0x3f45a6(0x297)},'amount':{'$first':_0x3f45a6(0x25c)},'bank':{'$first':_0x3f45a6(0x28a)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x3f45a6(0x1e9),'adj_discount':_0x3f45a6(0x249),'product_details':{'prod_name':_0x3f45a6(0x279),'product_code':_0x3f45a6(0x2a3),'category':_0x3f45a6(0x2e9),'brand':_0x3f45a6(0x298),'gross_price':'$product_info.gross_price','isFG':'$sale_product.isFG','prod_cat':'$sale_product.prod_cat','prod_id':_0x3f45a6(0x2d1)}}}}},{'$unwind':_0x3f45a6(0x22d)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3f45a6(0x1bf),'customer':'$_id.customer','status_data':'$_id.status_data','category':'$products.product_details.category','brand':'$products.product_details.brand','prod_id':_0x3f45a6(0x1e5)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x3f45a6(0x2c7),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x3f45a6(0x1e0)},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':_0x3f45a6(0x297)},'amount':{'$first':'$amount'},'bank':{'$first':_0x3f45a6(0x28a)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3f45a6(0x184)},'product_details':{'$first':_0x3f45a6(0x27c)}}},{'$group':{'_id':{'dsi':_0x3f45a6(0x2ca),'date':_0x3f45a6(0x1bf),'customer':_0x3f45a6(0x174),'status_data':_0x3f45a6(0x185)},'totalQty':{'$sum':_0x3f45a6(0x1f7)},'totalGross':{'$sum':_0x3f45a6(0x191)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x3f45a6(0x2a6)},'adj_discount':{'$sum':_0x3f45a6(0x2bc)},'cash':{'$first':_0x3f45a6(0x297)},'amount':{'$first':_0x3f45a6(0x25c)},'bank':{'$first':_0x3f45a6(0x28a)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':'$totalQty','category':_0x3f45a6(0x1b0),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5d349b=await sales_sa[_0x3f45a6(0x261)]([{'$match':{'date':_0x5d60b9,'sales_staff_id':_0x21d3d0,'sale_product.isFG':_0x3f45a6(0x250)}},{'$unwind':_0x3f45a6(0x1cd)},{'$lookup':{'from':'products','localField':_0x3f45a6(0x1c3),'foreignField':_0x3f45a6(0x1a9),'as':_0x3f45a6(0x22c)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x3f45a6(0x202),'date':_0x3f45a6(0x189),'customer':_0x3f45a6(0x248)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':_0x3f45a6(0x297)},'amount':{'$first':_0x3f45a6(0x25c)},'bank':{'$first':_0x3f45a6(0x28a)},'check_no':{'$first':_0x3f45a6(0x27f)},'due_date':{'$first':_0x3f45a6(0x184)},'products':{'$push':{'qty':_0x3f45a6(0x1df),'NetPrice':_0x3f45a6(0x19c),'discount':'$sale_product.discount','adj_discount':_0x3f45a6(0x249),'product_details':{'prod_name':_0x3f45a6(0x279),'product_code':_0x3f45a6(0x2a3),'category':_0x3f45a6(0x2e9),'brand':'$product_info.brand','gross_price':_0x3f45a6(0x281),'isFG':_0x3f45a6(0x282),'prod_cat':_0x3f45a6(0x224),'prod_id':_0x3f45a6(0x2d1)}}}}},{'$unwind':_0x3f45a6(0x22d)},{'$group':{'_id':{'dsi':_0x3f45a6(0x2ca),'date':_0x3f45a6(0x1bf),'customer':_0x3f45a6(0x174),'category':'$products.product_details.category','brand':'$products.product_details.brand','prod_id':_0x3f45a6(0x1e5)},'totalQty':{'$sum':_0x3f45a6(0x2c7)},'cash':{'$first':_0x3f45a6(0x297)},'amount':{'$first':'$amount'},'bank':{'$first':_0x3f45a6(0x28a)},'check_no':{'$first':_0x3f45a6(0x27f)},'due_date':{'$first':_0x3f45a6(0x184)},'totalGross':{'$sum':{'$multiply':[_0x3f45a6(0x2c7),_0x3f45a6(0x278)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x3f45a6(0x161)},'product_details':{'$first':_0x3f45a6(0x27c)}}},{'$group':{'_id':{'dsi':_0x3f45a6(0x2ca),'date':'$_id.date','customer':_0x3f45a6(0x174)},'totalQty':{'$sum':_0x3f45a6(0x1f7)},'cash':{'$first':_0x3f45a6(0x297)},'amount':{'$first':_0x3f45a6(0x25c)},'bank':{'$first':_0x3f45a6(0x28a)},'check_no':{'$first':_0x3f45a6(0x27f)},'due_date':{'$first':_0x3f45a6(0x184)},'totalGross':{'$sum':_0x3f45a6(0x191)},'NetPrice':{'$sum':_0x3f45a6(0x1dc)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x3f45a6(0x2bc)},'products':{'$push':{'qty':_0x3f45a6(0x1f7),'category':_0x3f45a6(0x1b0),'brand':_0x3f45a6(0x237),'product_details':_0x3f45a6(0x163)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x2fc8b0=await sales_sa[_0x3f45a6(0x261)]([{'$match':{'date':_0x5232c4,'sales_staff_id':_0x21d3d0,'status_data':_0x3f45a6(0x272)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x14eda4=await staff['findById'](_0x21d3d0);let _0x551f1d=[],_0x526caa={},_0x397d22={};var _0x4f9b46=0x0,_0x64ed1a=0x0,_0x39809a=0x0,_0x12a50d=0x0,_0x399f60=0x0;const _0xe68903=0x6;var _0x5e402a=0x0,_0x5ad23c=0x0;for(let _0x221554=0x0;_0x221554<=_0x2e010f[_0x3f45a6(0x1a0)]-0x1;_0x221554++){const _0x7013b5=_0x2e010f[_0x221554];let _0x373372=_0x3f45a6(0x188);_0x373372+=_0x3f45a6(0x1e1),_0x373372+=_0x3f45a6(0x20e)+_0x7013b5[_0x3f45a6(0x213)][_0x3f45a6(0x27e)]+'</td>',_0x373372+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x7013b5[_0x3f45a6(0x213)]['dsi']+'</td>';let _0x42fcf9={},_0x386226={},_0x5b1eed={};var _0x63ab21={},_0x1a3060={},_0x1280e5={},_0x270a0c=0x0;for(let _0x5409c2=0x0;_0x5409c2<=_0x7013b5[_0x3f45a6(0x1f3)][_0x3f45a6(0x1a0)]-0x1;_0x5409c2++){const _0xa3f29d=_0x7013b5[_0x3f45a6(0x1f3)][_0x5409c2];_0x42fcf9[_0xa3f29d[_0x3f45a6(0x24a)]+'-'+_0xa3f29d[_0x3f45a6(0x22f)]]=_0xa3f29d[_0x3f45a6(0x1fd)],_0x386226[[_0xa3f29d[_0x3f45a6(0x24a)]+'-'+_0xa3f29d[_0x3f45a6(0x22f)]]]=_0xa3f29d[_0x3f45a6(0x270)]['isFG'],_0x5b1eed[[_0xa3f29d[_0x3f45a6(0x24a)]+'-'+_0xa3f29d[_0x3f45a6(0x22f)]]]=_0xa3f29d[_0x3f45a6(0x270)][_0x3f45a6(0x229)];const _0x34993d=_0xa3f29d[_0x3f45a6(0x24a)]+'-'+_0xa3f29d[_0x3f45a6(0x22f)];!Array[_0x3f45a6(0x241)](_0x397d22[_0x34993d])&&(_0x397d22[_0x34993d]=[]);!Array[_0x3f45a6(0x241)](_0x397d22[_0x34993d])&&(_0x397d22[_0x34993d]=[]);_0x397d22[_0x34993d][_0x3f45a6(0x2b8)](_0xa3f29d[_0x3f45a6(0x1fd)]);if(_0xa3f29d[_0x3f45a6(0x270)][_0x3f45a6(0x229)]=='P')_0xa3f29d['product_details'][_0x3f45a6(0x2ea)]=='true'?(!_0x1280e5[_0x34993d]&&(_0x1280e5[_0x34993d]=0x0),_0x1280e5[_0x34993d]=_0xa3f29d['qty']):(!_0x63ab21[_0x34993d]&&(_0x63ab21[_0x34993d]=0x0),_0x63ab21[_0x34993d]=_0xa3f29d['qty']);else _0xa3f29d[_0x3f45a6(0x270)][_0x3f45a6(0x229)]=='S'&&(_0xa3f29d[_0x3f45a6(0x270)][_0x3f45a6(0x2ea)]=='true'?(!_0x1280e5[_0x34993d]&&(_0x1280e5[_0x34993d]=0x0),_0x1280e5[_0x34993d]=_0xa3f29d['qty']):(!_0x1a3060[_0x34993d]&&(_0x1a3060[_0x34993d]=0x0),_0x1a3060[_0x34993d]=_0xa3f29d[_0x3f45a6(0x1fd)]));_0x270a0c++;}for(let _0xfe53e=0x0;_0xfe53e<=_0x537ae2[_0x3f45a6(0x2a2)][_0x3f45a6(0x1a0)]-0x1;_0xfe53e++){const _0x591d50=_0x537ae2[_0x3f45a6(0x2a2)][_0xfe53e],_0x45b371=_0x591d50[_0x3f45a6(0x213)][_0x3f45a6(0x24a)]+'-'+_0x591d50[_0x3f45a6(0x213)][_0x3f45a6(0x22f)],_0x346f09=_0x5b1eed[_0x45b371]!==undefined?_0x5b1eed[_0x45b371]:'NA';var _0x12aa68=_0x63ab21[_0x45b371]!==undefined?_0x63ab21[_0x45b371]['toFixed'](0x2):'',_0x24db39=_0x1a3060[_0x45b371]!==undefined?_0x1a3060[_0x45b371][_0x3f45a6(0x2b0)](0x2):'',_0x2d3d12=_0x1280e5[_0x45b371]!==undefined?_0x1280e5[_0x45b371][_0x3f45a6(0x2b0)](0x2):'';_0x373372+=_0x3f45a6(0x253)+_0x12aa68+'</td>',_0x373372+=_0x3f45a6(0x253)+_0x24db39+_0x3f45a6(0x217),_0x373372+=_0x3f45a6(0x253)+_0x2d3d12+_0x3f45a6(0x217);}var _0xe4fa5=formatNumber(parseFloat(_0x7013b5[_0x3f45a6(0x24c)])),_0x179f86=formatNumber(parseFloat(_0x7013b5[_0x3f45a6(0x1b8)]));isNaN(_0x179f86)&&(_0x179f86=0x0),_0x373372+=_0x3f45a6(0x253)+_0xe4fa5+_0x3f45a6(0x217),_0x373372+=_0x3f45a6(0x253)+_0x179f86+'</td>',_0x373372+=_0x3f45a6(0x20e)+_0x7013b5[_0x3f45a6(0x21b)]+_0x3f45a6(0x217),_0x373372+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x7013b5[_0x3f45a6(0x231)]+_0x3f45a6(0x217),_0x373372+=_0x3f45a6(0x20e)+_0x7013b5[_0x3f45a6(0x28c)]+_0x3f45a6(0x217),_0x39809a=_0x7013b5[_0x3f45a6(0x218)]+_0x7013b5[_0x3f45a6(0x199)],_0x5e402a+=parseFloat(_0x7013b5['cash']),_0x5ad23c+=parseFloat(_0x179f86),_0x551f1d['push'](_0x373372);}function _0x1799ff(_0x3788ff,_0x56ec93){const _0x14c240=_0x3f45a6,_0x33e8e2=[];for(let _0x3a346a=0x0;_0x3a346a<=_0x3788ff['length']-0x1;_0x3a346a+=_0x56ec93){_0x33e8e2['push'](_0x3788ff[_0x14c240(0x1a1)](_0x3a346a,_0x3a346a+_0x56ec93));}return _0x33e8e2;}const _0x4a8f2b=_0x1799ff(_0x551f1d,_0xe68903);let _0x820dd1='';return _0x4a8f2b[_0x3f45a6(0x290)]((_0x58fe55,_0x5a151a)=>{const _0x1581c0=_0x3f45a6;_0x5a151a>0x0&&(_0x820dd1+=_0x1581c0(0x2d7));_0x820dd1+=_0x1581c0(0x1af),_0x820dd1+=_0x1581c0(0x2e3);const _0x110542=new Date(_0x5232c4),_0x555880={'year':_0x1581c0(0x1e6),'month':_0x1581c0(0x19d),'day':'numeric','timeZone':_0x1581c0(0x27d)},_0x5d5205=_0x110542[_0x1581c0(0x2aa)]('en-US',_0x555880);_0x820dd1+='<tr>',_0x820dd1+=_0x1581c0(0x257)+_0x2b814d+_0x1581c0(0x2bd),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+=_0x1581c0(0x188),_0x820dd1+=_0x1581c0(0x1c2)+_0x14eda4[_0x1581c0(0x200)]+'</td>',_0x820dd1+=_0x1581c0(0x175),_0x820dd1+=_0x1581c0(0x29a),_0x820dd1+='<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>',_0x820dd1+=_0x1581c0(0x28d),_0x820dd1+=_0x1581c0(0x288),_0x820dd1+=_0x1581c0(0x21c),_0x820dd1+=_0x1581c0(0x29b),_0x820dd1+=_0x1581c0(0x235),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+='<tr>',_0x820dd1+=_0x1581c0(0x1d0),_0x820dd1+=_0x1581c0(0x216)+_0x5d5205+_0x1581c0(0x217),_0x820dd1+=_0x1581c0(0x19e),_0x820dd1+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>',_0x820dd1+=_0x1581c0(0x18b),_0x820dd1+=_0x1581c0(0x18b),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+='<tr>',_0x820dd1+='<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>',_0x820dd1+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0x820dd1+=_0x1581c0(0x2ba),_0x820dd1+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x820dd1+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x820dd1+=_0x1581c0(0x206),_0x820dd1+=_0x1581c0(0x188),_0x820dd1+=_0x1581c0(0x194),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+='<tr>',_0x820dd1+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x820dd1+=_0x1581c0(0x15e),_0x820dd1+='</tr>',_0x820dd1+=_0x1581c0(0x188),_0x820dd1+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>',_0x820dd1+=_0x1581c0(0x1b6),_0x820dd1+=_0x1581c0(0x1fe);for(let _0x27ea0c=0x0;_0x27ea0c<=_0x5b1c73['length']-0x1;_0x27ea0c++){const _0x2c7ef2=_0x5b1c73[_0x27ea0c];for(let _0x195f1d=0x0;_0x195f1d<_0x537ae2[_0x1581c0(0x2a2)][_0x1581c0(0x1a0)];_0x195f1d++){const _0x2e01a5=_0x537ae2['cat_brand'][_0x195f1d];if(_0x2e01a5[_0x1581c0(0x213)][_0x1581c0(0x22f)]===_0x2c7ef2[_0x1581c0(0x213)][_0x1581c0(0x22f)]){var _0x1dd74a='';switch(_0x2c7ef2[_0x1581c0(0x213)][_0x1581c0(0x22f)]){case'Standard':_0x1dd74a=_0x2e01a5[_0x1581c0(0x213)]['brand']+_0x1581c0(0x16c);break;case _0x1581c0(0x221):_0x1dd74a=_0x2e01a5[_0x1581c0(0x213)][_0x1581c0(0x24a)]+_0x1581c0(0x2ae);break;default:_0x1dd74a=_0x2e01a5['_id'][_0x1581c0(0x24a)];break;}_0x820dd1+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>'+_0x1dd74a+'</b></td>';}}}_0x820dd1+=_0x1581c0(0x25e),_0x820dd1+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>',_0x820dd1+=_0x1581c0(0x2cb),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+='<tr>',_0x820dd1+=_0x1581c0(0x280);for(let _0x1eb80d=0x0;_0x1eb80d<=_0x537ae2[_0x1581c0(0x2a2)][_0x1581c0(0x1a0)]-0x1;_0x1eb80d++){const _0x23c976=_0x537ae2[_0x1eb80d];_0x820dd1+=_0x1581c0(0x26e),_0x820dd1+=_0x1581c0(0x2bb),_0x820dd1+=_0x1581c0(0x165);}_0x820dd1+=_0x1581c0(0x29d),_0x820dd1+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>',_0x820dd1+=_0x1581c0(0x181),_0x820dd1+='</tr>',_0x820dd1+=_0x1581c0(0x15f),_0x820dd1+=_0x1581c0(0x18a),_0x58fe55[_0x1581c0(0x290)](_0x3ae22b=>{_0x820dd1+=_0x3ae22b;});let _0x5b630e={},_0x258016={},_0xe65770={};for(let _0x3fdb21=0x0;_0x3fdb21<=_0x2e010f['length']-0x1;_0x3fdb21++){const _0x163a82=_0x2e010f[_0x3fdb21];var _0x14486a=0x0;for(let _0x4a7510=0x0;_0x4a7510<=_0x163a82['products'][_0x1581c0(0x1a0)]-0x1;_0x4a7510++){const _0x5388c5=_0x163a82[_0x1581c0(0x1f3)][_0x4a7510],_0x12ff2c=_0x5388c5[_0x1581c0(0x24a)]+'-'+_0x5388c5[_0x1581c0(0x22f)];if(_0x5388c5[_0x1581c0(0x270)][_0x1581c0(0x229)]=='P')_0x5388c5['product_details'][_0x1581c0(0x2ea)]=='true'?(!_0xe65770[_0x12ff2c]&&(_0xe65770[_0x12ff2c]=0x0),_0xe65770[_0x12ff2c]+=_0x5388c5[_0x1581c0(0x1fd)]):(!_0x5b630e[_0x12ff2c]&&(_0x5b630e[_0x12ff2c]=0x0),_0x5b630e[_0x12ff2c]+=_0x5388c5[_0x1581c0(0x1fd)]);else _0x5388c5[_0x1581c0(0x270)][_0x1581c0(0x229)]=='S'&&(_0x5388c5[_0x1581c0(0x270)][_0x1581c0(0x2ea)]==_0x1581c0(0x272)?(!_0xe65770[_0x12ff2c]&&(_0xe65770[_0x12ff2c]=0x0),_0xe65770[_0x12ff2c]+=_0x5388c5[_0x1581c0(0x1fd)],console[_0x1581c0(0x21d)](_0x5388c5[_0x1581c0(0x1fd)])):(!_0x258016[_0x12ff2c]&&(_0x258016[_0x12ff2c]=0x0),_0x258016[_0x12ff2c]+=_0x5388c5[_0x1581c0(0x1fd)]));_0x14486a++;}}let _0x1898a4={},_0x92ce7c={},_0x10ca45={};var _0x562427=0x0,_0x41e076=0x0;for(let _0x414586=0x0;_0x414586<=_0x5d349b[_0x1581c0(0x1a0)]-0x1;_0x414586++){const _0x32c4b9=_0x5d349b[_0x414586];var _0x14486a=0x0;for(let _0x1346bb=0x0;_0x1346bb<=_0x32c4b9['products'][_0x1581c0(0x1a0)]-0x1;_0x1346bb++){const _0x3e2158=_0x32c4b9[_0x1581c0(0x1f3)][_0x1346bb],_0x155867=_0x3e2158[_0x1581c0(0x24a)]+'-'+_0x3e2158[_0x1581c0(0x22f)];if(_0x3e2158[_0x1581c0(0x270)]['prod_cat']=='P')_0x3e2158[_0x1581c0(0x270)][_0x1581c0(0x2ea)]==_0x1581c0(0x272)?(!_0x10ca45[_0x155867]&&(_0x10ca45[_0x155867]=0x0),_0x10ca45[_0x155867]+=_0x3e2158[_0x1581c0(0x1fd)]):(!_0x1898a4[_0x155867]&&(_0x1898a4[_0x155867]=0x0),_0x1898a4[_0x155867]+=_0x3e2158[_0x1581c0(0x1fd)]);else _0x3e2158['product_details']['prod_cat']=='S'&&(_0x3e2158[_0x1581c0(0x270)]['isFG']==_0x1581c0(0x272)?(!_0x10ca45[_0x155867]&&(_0x10ca45[_0x155867]=0x0),_0x10ca45[_0x155867]+=_0x3e2158[_0x1581c0(0x1fd)]):(!_0x92ce7c[_0x155867]&&(_0x92ce7c[_0x155867]=0x0),_0x92ce7c[_0x155867]+=_0x3e2158['qty']));_0x14486a++;}var _0x331eb2=parseFloat(_0x32c4b9['cash']),_0x183639=parseFloat(_0x32c4b9[_0x1581c0(0x1b8)]);isNaN(_0x183639)&&(_0x183639=0x0),_0x562427+=_0x331eb2,_0x41e076+=_0x183639;}if(_0x2fc8b0['length']>0x0)for(let _0x94e8bf=0x0;_0x94e8bf<=_0x2fc8b0[_0x1581c0(0x1a0)]-0x1;_0x94e8bf++){const _0x38619f=_0x2fc8b0[_0x94e8bf];console['log'](_0x38619f),_0x820dd1+=_0x1581c0(0x188),_0x820dd1+=_0x1581c0(0x1d7)+(0x8+0x7*0x3)+_0x1581c0(0x2e0)+_0x38619f[_0x1581c0(0x1ee)]+'</b></td>',_0x820dd1+=_0x1581c0(0x206);}_0x820dd1+=_0x1581c0(0x188),_0x820dd1+=_0x1581c0(0x264),_0x820dd1+=_0x1581c0(0x21a),_0x820dd1+=_0x1581c0(0x1e1);for(let _0x10984b=0x0;_0x10984b<=_0x537ae2[_0x1581c0(0x2a2)][_0x1581c0(0x1a0)]-0x1;_0x10984b++){const _0x131108=_0x537ae2[_0x1581c0(0x2a2)][_0x10984b],_0x260689=_0x131108[_0x1581c0(0x213)][_0x1581c0(0x24a)]+'-'+_0x131108[_0x1581c0(0x213)][_0x1581c0(0x22f)];var _0x3a6839=_0x5b630e[_0x260689]!==undefined?formatNumber(_0x5b630e[_0x260689][_0x1581c0(0x2b0)](0x2)):'',_0x38b1c6=_0xe65770[_0x260689]!==undefined?formatNumber(_0xe65770[_0x260689][_0x1581c0(0x2b0)](0x2)):'',_0x790efe=_0x258016[_0x260689]!==undefined?formatNumber(_0x258016[_0x260689]['toFixed'](0x2)):'';_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3a6839+_0x1581c0(0x2bd),_0x820dd1+=_0x1581c0(0x296)+_0x790efe+_0x1581c0(0x2bd),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x38b1c6+'</b></td>';}_0x820dd1+=_0x1581c0(0x296)+formatNumber(_0x5e402a)+'</b></td>',_0x820dd1+=_0x1581c0(0x296)+formatNumber(_0x5ad23c)+'</b></td>',_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+=_0x1581c0(0x188),_0x820dd1+=_0x1581c0(0x264),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>',_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x11d473=0x0;_0x11d473<=_0x537ae2[_0x1581c0(0x2a2)][_0x1581c0(0x1a0)]-0x1;_0x11d473++){const _0x3a2a0e=_0x537ae2[_0x1581c0(0x2a2)][_0x11d473],_0x4da52a=_0x3a2a0e['_id'][_0x1581c0(0x24a)]+'-'+_0x3a2a0e['_id'][_0x1581c0(0x22f)];var _0x3a6839=_0x1898a4[_0x4da52a]!==undefined?formatNumber(_0x1898a4[_0x4da52a][_0x1581c0(0x2b0)](0x2)):'',_0x38b1c6=_0x10ca45[_0x4da52a]!==undefined?formatNumber(_0x10ca45[_0x4da52a][_0x1581c0(0x2b0)](0x2)):'',_0x790efe=_0x92ce7c[_0x4da52a]!==undefined?formatNumber(_0x92ce7c[_0x4da52a]['toFixed'](0x2)):'';_0x820dd1+=_0x1581c0(0x296)+_0x3a6839+_0x1581c0(0x2bd),_0x820dd1+=_0x1581c0(0x296)+_0x790efe+_0x1581c0(0x2bd),_0x820dd1+=_0x1581c0(0x296)+_0x38b1c6+_0x1581c0(0x2bd);}_0x820dd1+=_0x1581c0(0x296)+formatNumber(_0x562427)+_0x1581c0(0x2bd),_0x820dd1+=_0x1581c0(0x296)+formatNumber(_0x41e076)+'</b></td>',_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x820dd1+=_0x1581c0(0x206),_0x820dd1+=_0x1581c0(0x188),_0x820dd1+=_0x1581c0(0x264),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x820dd1+=_0x1581c0(0x1e1);let _0x4b2ef4=0x0,_0x311304=0x0,_0x50411d=0x0;for(let _0x3a3e9f=0x0;_0x3a3e9f<=_0x537ae2['cat_brand']['length']-0x1;_0x3a3e9f++){const _0x5e6751=_0x537ae2[_0x1581c0(0x2a2)][_0x3a3e9f],_0x4b63b0=_0x5e6751[_0x1581c0(0x213)][_0x1581c0(0x24a)]+'-'+_0x5e6751[_0x1581c0(0x213)][_0x1581c0(0x22f)];var _0x571d7a=_0x5b630e[_0x4b63b0]!==undefined?_0x5b630e[_0x4b63b0]['toFixed'](0x2):'0',_0x2b5b31=_0xe65770[_0x4b63b0]!==undefined?_0xe65770[_0x4b63b0]['toFixed'](0x2):'0',_0x6f525c=_0x258016[_0x4b63b0]!==undefined?_0x258016[_0x4b63b0][_0x1581c0(0x2b0)](0x2):'0',_0x49dd8f=_0x1898a4[_0x4b63b0]!==undefined?_0x1898a4[_0x4b63b0][_0x1581c0(0x2b0)](0x2):'0',_0x58d35a=_0x10ca45[_0x4b63b0]!==undefined?_0x10ca45[_0x4b63b0][_0x1581c0(0x2b0)](0x2):'0',_0xc7b18f=_0x92ce7c[_0x4b63b0]!==undefined?_0x92ce7c[_0x4b63b0][_0x1581c0(0x2b0)](0x2):'0';_0x4b2ef4=parseFloat(_0x571d7a)+parseFloat(_0x49dd8f),_0x311304=parseFloat(_0x6f525c)+parseFloat(_0xc7b18f),_0x50411d=parseFloat(_0x2b5b31)+parseFloat(_0x58d35a),_0x820dd1+=_0x1581c0(0x296)+formatNumber(_0x4b2ef4[_0x1581c0(0x2b0)](0x2))+'</b></td>',_0x820dd1+=_0x1581c0(0x296)+formatNumber(_0x311304[_0x1581c0(0x2b0)](0x2))+_0x1581c0(0x2bd),_0x820dd1+=_0x1581c0(0x296)+formatNumber(_0x50411d[_0x1581c0(0x2b0)](0x2))+_0x1581c0(0x2bd);}var _0x333797=formatNumber(_0x5e402a+_0x562427),_0x323614=formatNumber(_0x5ad23c+_0x41e076);_0x820dd1+=_0x1581c0(0x296)+_0x333797+_0x1581c0(0x2bd),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x323614+_0x1581c0(0x2bd),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+='<tr>',_0x820dd1+=_0x1581c0(0x1bc)+(_0x537ae2[_0x1581c0(0x2a2)][_0x1581c0(0x1a0)]*0x3+0x9)+_0x1581c0(0x244),_0x820dd1+='</tr>',_0x820dd1+='<tr>',_0x820dd1+=_0x1581c0(0x264),_0x820dd1+=_0x1581c0(0x2c3),_0x820dd1+=_0x1581c0(0x1e1);for(let _0x24f62d=0x0;_0x24f62d<=_0x537ae2[_0x1581c0(0x2a2)][_0x1581c0(0x1a0)]-0x1;_0x24f62d++){const _0x4c5870=_0x537ae2[_0x1581c0(0x2a2)][_0x24f62d],_0x38368c=_0x4c5870[_0x1581c0(0x213)][_0x1581c0(0x24a)]+'-'+_0x4c5870['_id'][_0x1581c0(0x22f)];var _0x571d7a=_0x5b630e[_0x38368c]!==undefined?_0x5b630e[_0x38368c][_0x1581c0(0x2b0)](0x2):'0',_0x2b5b31=_0xe65770[_0x38368c]!==undefined?_0xe65770[_0x38368c]['toFixed'](0x2):'0',_0x6f525c=_0x258016[_0x38368c]!==undefined?_0x258016[_0x38368c][_0x1581c0(0x2b0)](0x2):'0',_0x49dd8f=_0x1898a4[_0x38368c]!==undefined?_0x1898a4[_0x38368c][_0x1581c0(0x2b0)](0x2):'0',_0x58d35a=_0x10ca45[_0x38368c]!==undefined?_0x10ca45[_0x38368c][_0x1581c0(0x2b0)](0x2):'0',_0xc7b18f=_0x92ce7c[_0x38368c]!==undefined?_0x92ce7c[_0x38368c][_0x1581c0(0x2b0)](0x2):'0';_0x4b2ef4=parseFloat(_0x571d7a)+parseFloat(_0x49dd8f),_0x311304=parseFloat(_0x6f525c)+parseFloat(_0xc7b18f),_0x50411d=parseFloat(_0x2b5b31)+parseFloat(_0x58d35a),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x820dd1+=_0x1581c0(0x170),_0x820dd1+=_0x1581c0(0x170);}_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+='</tr>',_0x820dd1+=_0x1581c0(0x188),_0x820dd1+=_0x1581c0(0x264),_0x820dd1+=_0x1581c0(0x226),_0x820dd1+=_0x1581c0(0x1e1);for(let _0x1a4f08=0x0;_0x1a4f08<=_0x537ae2[_0x1581c0(0x2a2)][_0x1581c0(0x1a0)]-0x1;_0x1a4f08++){const _0x4109d4=_0x537ae2['cat_brand'][_0x1a4f08],_0x48c628=_0x4109d4[_0x1581c0(0x213)][_0x1581c0(0x24a)]+'-'+_0x4109d4[_0x1581c0(0x213)]['category'];var _0x571d7a=_0x5b630e[_0x48c628]!==undefined?_0x5b630e[_0x48c628][_0x1581c0(0x2b0)](0x2):'0',_0x2b5b31=_0xe65770[_0x48c628]!==undefined?_0xe65770[_0x48c628]['toFixed'](0x2):'0',_0x6f525c=_0x258016[_0x48c628]!==undefined?_0x258016[_0x48c628][_0x1581c0(0x2b0)](0x2):'0',_0x49dd8f=_0x1898a4[_0x48c628]!==undefined?_0x1898a4[_0x48c628]['toFixed'](0x2):'0',_0x58d35a=_0x10ca45[_0x48c628]!==undefined?_0x10ca45[_0x48c628][_0x1581c0(0x2b0)](0x2):'0',_0xc7b18f=_0x92ce7c[_0x48c628]!==undefined?_0x92ce7c[_0x48c628][_0x1581c0(0x2b0)](0x2):'0';_0x4b2ef4=parseFloat(_0x571d7a)+parseFloat(_0x49dd8f),_0x311304=parseFloat(_0x6f525c)+parseFloat(_0xc7b18f),_0x50411d=parseFloat(_0x2b5b31)+parseFloat(_0x58d35a),_0x820dd1+=_0x1581c0(0x170),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x820dd1+=_0x1581c0(0x170);}_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+=_0x1581c0(0x188),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x820dd1+=_0x1581c0(0x1b4),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x1c5186=0x0;_0x1c5186<=_0x537ae2['cat_brand']['length']-0x1;_0x1c5186++){const _0x8cc74e=_0x537ae2[_0x1581c0(0x2a2)][_0x1c5186],_0x424486=_0x8cc74e[_0x1581c0(0x213)][_0x1581c0(0x24a)]+'-'+_0x8cc74e[_0x1581c0(0x213)][_0x1581c0(0x22f)];var _0x571d7a=_0x5b630e[_0x424486]!==undefined?_0x5b630e[_0x424486]['toFixed'](0x2):'0',_0x2b5b31=_0xe65770[_0x424486]!==undefined?_0xe65770[_0x424486][_0x1581c0(0x2b0)](0x2):'0',_0x6f525c=_0x258016[_0x424486]!==undefined?_0x258016[_0x424486][_0x1581c0(0x2b0)](0x2):'0',_0x49dd8f=_0x1898a4[_0x424486]!==undefined?_0x1898a4[_0x424486][_0x1581c0(0x2b0)](0x2):'0',_0x58d35a=_0x10ca45[_0x424486]!==undefined?_0x10ca45[_0x424486]['toFixed'](0x2):'0',_0xc7b18f=_0x92ce7c[_0x424486]!==undefined?_0x92ce7c[_0x424486][_0x1581c0(0x2b0)](0x2):'0';_0x4b2ef4=parseFloat(_0x571d7a)+parseFloat(_0x49dd8f),_0x311304=parseFloat(_0x6f525c)+parseFloat(_0xc7b18f),_0x50411d=parseFloat(_0x2b5b31)+parseFloat(_0x58d35a),_0x820dd1+=_0x1581c0(0x170),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x820dd1+=_0x1581c0(0x170);}_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+='</tr>',_0x820dd1+=_0x1581c0(0x188),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x820dd1+=_0x1581c0(0x21a),_0x820dd1+=_0x1581c0(0x1e1);for(let _0x4a91bb=0x0;_0x4a91bb<=_0x537ae2['cat_brand']['length']-0x1;_0x4a91bb++){const _0x4fff5b=_0x537ae2[_0x1581c0(0x2a2)][_0x4a91bb],_0x3622c3=_0x4fff5b['_id'][_0x1581c0(0x24a)]+'-'+_0x4fff5b['_id'][_0x1581c0(0x22f)];var _0x571d7a=_0x5b630e[_0x3622c3]!==undefined?_0x5b630e[_0x3622c3][_0x1581c0(0x2b0)](0x2):'',_0x2b5b31=_0xe65770[_0x3622c3]!==undefined?_0xe65770[_0x3622c3][_0x1581c0(0x2b0)](0x2):'',_0x6f525c=_0x258016[_0x3622c3]!==undefined?_0x258016[_0x3622c3][_0x1581c0(0x2b0)](0x2):'',_0x49dd8f=_0x1898a4[_0x3622c3]!==undefined?_0x1898a4[_0x3622c3][_0x1581c0(0x2b0)](0x2):'',_0x58d35a=_0x10ca45[_0x3622c3]!==undefined?_0x10ca45[_0x3622c3][_0x1581c0(0x2b0)](0x2):'',_0xc7b18f=_0x92ce7c[_0x3622c3]!==undefined?_0x92ce7c[_0x3622c3][_0x1581c0(0x2b0)](0x2):'';_0x4b2ef4=formatNumber(parseFloat(_0x571d7a)+parseFloat(_0x49dd8f)),_0x311304=formatNumber(parseFloat(_0x6f525c)+parseFloat(_0xc7b18f)),_0x50411d=formatNumber(parseFloat(_0x2b5b31)+parseFloat(_0x58d35a)),_0x820dd1+=_0x1581c0(0x296)+_0x571d7a+_0x1581c0(0x2bd),_0x820dd1+=_0x1581c0(0x296)+_0x6f525c+'</b></td>',_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x2b5b31+_0x1581c0(0x2bd);}_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+=_0x1581c0(0x188),_0x820dd1+=_0x1581c0(0x264),_0x820dd1+=_0x1581c0(0x1c4),_0x820dd1+=_0x1581c0(0x1e1);for(let _0x1d32bf=0x0;_0x1d32bf<=_0x537ae2[_0x1581c0(0x2a2)][_0x1581c0(0x1a0)]-0x1;_0x1d32bf++){const _0x53567c=_0x537ae2['cat_brand'][_0x1d32bf],_0x56e07c=_0x53567c[_0x1581c0(0x213)][_0x1581c0(0x24a)]+'-'+_0x53567c[_0x1581c0(0x213)][_0x1581c0(0x22f)];var _0x571d7a=_0x5b630e[_0x56e07c]!==undefined?_0x5b630e[_0x56e07c][_0x1581c0(0x2b0)](0x2):'0',_0x2b5b31=_0xe65770[_0x56e07c]!==undefined?_0xe65770[_0x56e07c][_0x1581c0(0x2b0)](0x2):'0',_0x6f525c=_0x258016[_0x56e07c]!==undefined?_0x258016[_0x56e07c][_0x1581c0(0x2b0)](0x2):'0',_0x49dd8f=_0x1898a4[_0x56e07c]!==undefined?_0x1898a4[_0x56e07c][_0x1581c0(0x2b0)](0x2):'0',_0x58d35a=_0x10ca45[_0x56e07c]!==undefined?_0x10ca45[_0x56e07c]['toFixed'](0x2):'0',_0xc7b18f=_0x92ce7c[_0x56e07c]!==undefined?_0x92ce7c[_0x56e07c][_0x1581c0(0x2b0)](0x2):'0';_0x4b2ef4=parseFloat(_0x571d7a)+parseFloat(_0x49dd8f),_0x311304=parseFloat(_0x6f525c)+parseFloat(_0xc7b18f),_0x50411d=parseFloat(_0x2b5b31)+parseFloat(_0x58d35a),_0x820dd1+=_0x1581c0(0x170),_0x820dd1+=_0x1581c0(0x170),_0x820dd1+=_0x1581c0(0x170);}_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x1e1),_0x820dd1+=_0x1581c0(0x206),_0x820dd1+=_0x1581c0(0x1cb),_0x820dd1+=_0x1581c0(0x1d4);}),_0x820dd1;}async function generateReferenceNumber(_0x521fdc,_0x17c0a9,_0x2699e2){const _0x27b68e=a0_0x4ca221,_0x15ddb9=new Date(_0x521fdc)[_0x27b68e(0x24b)](),_0x110c5e=('0'+(new Date(_0x521fdc)[_0x27b68e(0x1b9)]()+0x1))[_0x27b68e(0x1a1)](-0x2),_0x1d2412=('0'+new Date(_0x521fdc)[_0x27b68e(0x16f)]())[_0x27b68e(0x1a1)](-0x2),_0x2af4c2=await staff['findOne']({'email':_0x2699e2[_0x27b68e(0x2eb)]}),_0x17bd48=_0x2af4c2[_0x27b68e(0x2ce)],_0x416685=_0x17bd48+'-'+_0x15ddb9+_0x110c5e+_0x1d2412,_0x231c1c=await Reference[_0x27b68e(0x1ff)]({'referenceNumber':new RegExp('^'+_0x416685),'salesman_code':_0x17bd48})[_0x27b68e(0x21f)]({'createdAt':-0x1}),_0x23e543=_0x416685;_0x231c1c&&(_0x23e543=_0x231c1c[_0x27b68e(0x2e8)]);console['log'](_0x23e543);const _0x55571d=new Reference({'referenceNumber':_0x23e543,'staff_id':_0x17c0a9,'salesman_code':_0x17bd48});return await _0x55571d[_0x27b68e(0x25b)](),_0x23e543;}router[a0_0x4ca221(0x1da)]('/dsrr/pdf',auth,async(_0x36eb57,_0x256a69)=>{const _0xdbf6f2=a0_0x4ca221,{from_date:_0x56ff61,dataview:_0x536255}=_0x36eb57['body'],_0x2dc503=_0x36eb57[_0xdbf6f2(0x2b9)],_0x2230a0=await staff['findOne']({'email':_0x2dc503[_0xdbf6f2(0x2eb)]}),_0x170f81=await master_shop[_0xdbf6f2(0x2b2)](),_0x5a04ea='';var _0x1267ea=new Date(_0x56ff61);const _0x9d3e0e={'year':_0xdbf6f2(0x1e6),'month':'long','day':_0xdbf6f2(0x1e6)},_0xe21f8a=new Intl[(_0xdbf6f2(0x183))]('en-US',_0x9d3e0e)[_0xdbf6f2(0x204)](_0x1267ea),_0x4046e6=await Reference[_0xdbf6f2(0x2b2)]({'staff_id':_0x2230a0[_0xdbf6f2(0x213)][_0xdbf6f2(0x1c1)](),'date_include':_0x56ff61});if(_0x4046e6[_0xdbf6f2(0x1a0)]>0x0){let _0x1a8669='';_0x1a8669+=_0x4046e6[0x0]['html'];if(_0x536255==_0xdbf6f2(0x1f1)){const _0xff2250=cheerio['load'](_0x1a8669);let _0x258913=[],_0x366fd0=[],_0x40b504=[];const _0x20bff4=_0xd0a714=>{const _0x10fee8=_0xdbf6f2,_0xa1b059={'top':{'style':_0x10fee8(0x285),'color':{'rgb':_0x10fee8(0x29e)}},'bottom':{'style':_0x10fee8(0x285),'color':{'rgb':_0x10fee8(0x29e)}},'left':{'style':_0x10fee8(0x285),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x10fee8(0x29e)}}};if(_0xd0a714){const _0x12775e=_0xd0a714[_0x10fee8(0x2c5)](';')['reduce']((_0x510521,_0x17f603)=>{const _0x244195=_0x10fee8,[_0x4bf90d,_0x3243e8]=_0x17f603[_0x244195(0x2c5)](':')['map'](_0x2e5760=>_0x2e5760[_0x244195(0x251)]());return _0x510521[_0x4bf90d]=_0x3243e8,_0x510521;},{});_0x12775e['border-top']&&(_0xa1b059['top'][_0x10fee8(0x1ed)]=_0x12775e['border-top'][_0x10fee8(0x160)](_0x10fee8(0x260))?_0x10fee8(0x260):_0x10fee8(0x16a)),_0x12775e['border-bottom']&&(_0xa1b059['bottom'][_0x10fee8(0x1ed)]=_0x12775e[_0x10fee8(0x177)]['includes']('thin')?'thin':_0x10fee8(0x16a)),_0x12775e[_0x10fee8(0x283)]&&(_0xa1b059[_0x10fee8(0x17f)][_0x10fee8(0x1ed)]=_0x12775e[_0x10fee8(0x283)][_0x10fee8(0x160)]('thin')?'thin':'medium'),_0x12775e[_0x10fee8(0x2cf)]&&(_0xa1b059[_0x10fee8(0x2d9)]['style']=_0x12775e[_0x10fee8(0x2cf)]['includes'](_0x10fee8(0x260))?_0x10fee8(0x260):'medium');}return _0xa1b059;};_0xff2250(_0xdbf6f2(0x1de))[_0xdbf6f2(0x234)]((_0x2ae3ba,_0x4b4b8d)=>{const _0x16e7ee=_0xdbf6f2;let _0x1a745c=[],_0x257833=0x0;while(_0x40b504[_0x257833]){_0x40b504[_0x257833]--,_0x257833++;}_0xff2250(_0x4b4b8d)['find'](_0x16e7ee(0x176))[_0x16e7ee(0x234)]((_0x427e84,_0x4f2758)=>{const _0x282632=_0x16e7ee;let _0x237dd7=_0xff2250(_0x4f2758)[_0x282632(0x2d0)]()[_0x282632(0x251)](),_0x504b07=parseFloat(_0x237dd7[_0x282632(0x2dc)](/,/g,''));isNaN(_0x504b07)&&(_0x504b07=_0x237dd7);let _0x455924=parseInt(_0xff2250(_0x4f2758)[_0x282632(0x223)](_0x282632(0x2d3)))||0x1,_0x1208dd=parseInt(_0xff2250(_0x4f2758)[_0x282632(0x223)](_0x282632(0x227)))||0x1;const _0x429365=_0xff2250(_0x4f2758)['attr'](_0x282632(0x1ed)),_0x38f948=_0x20bff4(_0x429365);_0x1a745c[_0x257833]={'v':_0x504b07,'s':{'border':_0x38f948}};(_0x455924>0x1||_0x1208dd>0x1)&&_0x366fd0[_0x282632(0x2b8)]({'s':{'r':_0x2ae3ba,'c':_0x257833},'e':{'r':_0x2ae3ba+_0x1208dd-0x1,'c':_0x257833+_0x455924-0x1}});for(let _0x4aab2f=0x0;_0x4aab2f<_0x455924;_0x4aab2f++){_0x1208dd>0x1&&(_0x40b504[_0x257833+_0x4aab2f]=_0x1208dd-0x1);}_0x257833+=_0x455924;}),_0x258913['push'](_0x1a745c);});const _0x370748=XLSX[_0xdbf6f2(0x17b)]['book_new'](),_0x1b5a0f=XLSX[_0xdbf6f2(0x17b)][_0xdbf6f2(0x1f2)](_0x258913);_0x366fd0[_0xdbf6f2(0x1a0)]>0x0&&(_0x1b5a0f[_0xdbf6f2(0x186)]=_0x366fd0);_0x1b5a0f[_0xdbf6f2(0x269)]=_0x258913[0x0][_0xdbf6f2(0x1ba)](()=>({'wpx':0x64})),XLSX[_0xdbf6f2(0x17b)][_0xdbf6f2(0x266)](_0x370748,_0x1b5a0f,_0xdbf6f2(0x17d));const _0x29aa78=XLSX[_0xdbf6f2(0x1d1)](_0x370748,{'bookType':_0xdbf6f2(0x2d5),'type':'buffer'});_0x256a69[_0xdbf6f2(0x2b6)](_0xdbf6f2(0x212),_0xdbf6f2(0x2e5)),_0x256a69[_0xdbf6f2(0x2b6)](_0xdbf6f2(0x1be),_0xdbf6f2(0x1b3)),_0x256a69['send'](_0x29aa78);}else{let _0x57b5eb='';_0x57b5eb+=_0x1a8669,_0x57b5eb+='<script>',_0x57b5eb+=_0xdbf6f2(0x2d4),_0x57b5eb+='window.print();',_0x57b5eb+='};',_0x57b5eb+=_0xdbf6f2(0x16e),_0x256a69[_0xdbf6f2(0x17c)](_0x57b5eb);}}else generateReferenceNumber(_0x56ff61,_0x2230a0[_0xdbf6f2(0x213)][_0xdbf6f2(0x1c1)](),_0x2dc503)[_0xdbf6f2(0x295)](async _0x238ea9=>{const _0x208bd5=_0xdbf6f2,_0x1f74b7=await agentsdataDSICheck_DSRR(_0x56ff61,_0x2230a0[_0x208bd5(0x213)]['valueOf'](),_0x5a04ea,_0x238ea9);let _0x25dc37=_0x208bd5(0x23c);_0x25dc37+=_0x208bd5(0x1ad),_0x25dc37+='<div\x20\x20id=\x22table-conatainer\x22>',_0x25dc37+=_0x208bd5(0x1af),_0x25dc37+=_0x1f74b7,_0x25dc37+=_0x208bd5(0x1d4),_0x25dc37+=_0x208bd5(0x1ac),_0x25dc37+=_0x208bd5(0x1ac);if(_0x1f74b7[_0x208bd5(0x1a0)]>0x0){const _0x1f4d86=await Reference[_0x208bd5(0x1ff)]({'staff_id':_0x2230a0[_0x208bd5(0x213)][_0x208bd5(0x1c1)](),'referenceNumber':_0x238ea9});_0x1f4d86[_0x208bd5(0x1e3)]=_0x25dc37,_0x1f4d86[_0x208bd5(0x1a6)]=_0x56ff61,await _0x1f4d86['save']();if(_0x536255=='excel'){const _0x711f49=cheerio[_0x208bd5(0x1c8)](_0x25dc37);let _0x3cccfb=[],_0x49072b=[],_0xbdae09=[];const _0x4ff9c6=_0x646f05=>{const _0x31c672=_0x208bd5,_0x375ae7={'top':{'style':_0x31c672(0x285),'color':{'rgb':_0x31c672(0x29e)}},'bottom':{'style':'thick','color':{'rgb':_0x31c672(0x29e)}},'left':{'style':_0x31c672(0x285),'color':{'rgb':_0x31c672(0x29e)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x646f05){const _0x3a4ea8=_0x646f05['split'](';')[_0x31c672(0x1ca)]((_0x43d02a,_0x2a6b7a)=>{const _0x344782=_0x31c672,[_0x280f22,_0x3c8181]=_0x2a6b7a[_0x344782(0x2c5)](':')[_0x344782(0x1ba)](_0x1c19d4=>_0x1c19d4[_0x344782(0x251)]());return _0x43d02a[_0x280f22]=_0x3c8181,_0x43d02a;},{});_0x3a4ea8[_0x31c672(0x1a5)]&&(_0x375ae7['top'][_0x31c672(0x1ed)]=_0x3a4ea8[_0x31c672(0x1a5)]['includes']('thin')?_0x31c672(0x260):_0x31c672(0x16a)),_0x3a4ea8['border-bottom']&&(_0x375ae7['bottom'][_0x31c672(0x1ed)]=_0x3a4ea8[_0x31c672(0x177)]['includes'](_0x31c672(0x260))?_0x31c672(0x260):_0x31c672(0x16a)),_0x3a4ea8[_0x31c672(0x283)]&&(_0x375ae7[_0x31c672(0x17f)][_0x31c672(0x1ed)]=_0x3a4ea8['border-left']['includes'](_0x31c672(0x260))?_0x31c672(0x260):_0x31c672(0x16a)),_0x3a4ea8['border-right']&&(_0x375ae7[_0x31c672(0x2d9)][_0x31c672(0x1ed)]=_0x3a4ea8[_0x31c672(0x2cf)][_0x31c672(0x160)](_0x31c672(0x260))?_0x31c672(0x260):_0x31c672(0x16a));}return _0x375ae7;};_0x711f49(_0x208bd5(0x1de))[_0x208bd5(0x234)]((_0x5ec434,_0x58284a)=>{const _0xa40cf1=_0x208bd5;let _0x75782=[],_0x3cff31=0x0;while(_0xbdae09[_0x3cff31]){_0xbdae09[_0x3cff31]--,_0x3cff31++;}_0x711f49(_0x58284a)[_0xa40cf1(0x2b2)](_0xa40cf1(0x176))['each']((_0x2690cd,_0x2ca227)=>{const _0x1aec60=_0xa40cf1;let _0x5ad757=_0x711f49(_0x2ca227)[_0x1aec60(0x2d0)]()[_0x1aec60(0x251)](),_0x8bb663=parseFloat(_0x5ad757[_0x1aec60(0x2dc)](/,/g,''));isNaN(_0x8bb663)&&(_0x8bb663=_0x5ad757);let _0x4cf723=parseInt(_0x711f49(_0x2ca227)[_0x1aec60(0x223)](_0x1aec60(0x2d3)))||0x1,_0x2205d4=parseInt(_0x711f49(_0x2ca227)['attr'](_0x1aec60(0x227)))||0x1;const _0x31047f=_0x711f49(_0x2ca227)[_0x1aec60(0x223)]('style'),_0x30ee42=_0x4ff9c6(_0x31047f);_0x75782[_0x3cff31]={'v':_0x8bb663,'s':{'border':_0x30ee42}};(_0x4cf723>0x1||_0x2205d4>0x1)&&_0x49072b['push']({'s':{'r':_0x5ec434,'c':_0x3cff31},'e':{'r':_0x5ec434+_0x2205d4-0x1,'c':_0x3cff31+_0x4cf723-0x1}});for(let _0x4f6855=0x0;_0x4f6855<_0x4cf723;_0x4f6855++){_0x2205d4>0x1&&(_0xbdae09[_0x3cff31+_0x4f6855]=_0x2205d4-0x1);}_0x3cff31+=_0x4cf723;}),_0x3cccfb[_0xa40cf1(0x2b8)](_0x75782);});const _0x53e0c6=XLSX[_0x208bd5(0x17b)][_0x208bd5(0x22e)](),_0x1570e3=XLSX[_0x208bd5(0x17b)][_0x208bd5(0x1f2)](_0x3cccfb);_0x49072b[_0x208bd5(0x1a0)]>0x0&&(_0x1570e3['!merges']=_0x49072b);_0x1570e3[_0x208bd5(0x269)]=_0x3cccfb[0x0][_0x208bd5(0x1ba)](()=>({'wpx':0x64})),XLSX[_0x208bd5(0x17b)][_0x208bd5(0x266)](_0x53e0c6,_0x1570e3,'Sales\x20Report');const _0xebb78f=XLSX[_0x208bd5(0x1d1)](_0x53e0c6,{'bookType':'xlsx','type':'buffer'});_0x256a69[_0x208bd5(0x2b6)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x256a69[_0x208bd5(0x2b6)](_0x208bd5(0x1be),_0x208bd5(0x1b3)),_0x256a69[_0x208bd5(0x17c)](_0xebb78f);}else _0x25dc37+=_0x208bd5(0x1a4),_0x25dc37+=_0x208bd5(0x2d4),_0x25dc37+=_0x208bd5(0x168),_0x25dc37+='};',_0x25dc37+=_0x208bd5(0x16e),_0x256a69[_0x208bd5(0x17c)](_0x25dc37);}else await Reference['deleteOne']({'referenceNumber':_0x238ea9}),_0x36eb57[_0x208bd5(0x26a)](_0x208bd5(0x18f),_0x208bd5(0x2d2)),_0x256a69[_0x208bd5(0x1a3)](_0x208bd5(0x2a4));})['catch'](console[_0xdbf6f2(0x1c0)]);}),router['get']('/dsrr_admin/view',auth,async(_0x5d6330,_0x55b348)=>{const _0x4a644b=a0_0x4ca221;try{const {username:_0x49f20a,email:_0x5c6932,role:_0x22ce46}=_0x5d6330[_0x4a644b(0x2b9)],_0x493bf6=_0x5d6330[_0x4a644b(0x2b9)],_0x56725f=await profile['findOne']({'email':_0x493bf6[_0x4a644b(0x2eb)]}),_0x4d21a1={'year':'numeric','month':_0x4a644b(0x19d),'day':'numeric'},_0x479e35=await master_shop[_0x4a644b(0x2b2)]();console[_0x4a644b(0x21d)]('Products\x20master',_0x479e35);const _0x4e5e5a=await product[_0x4a644b(0x2b2)]();console['log'](_0x4a644b(0x273),_0x4e5e5a);const _0x150d60=await warehouse['aggregate']([{'$unwind':_0x4a644b(0x163)},{'$lookup':{'from':_0x4a644b(0x1f3),'localField':_0x4a644b(0x245),'foreignField':_0x4a644b(0x200),'as':_0x4a644b(0x201)}},{'$unwind':_0x4a644b(0x256)},{'$project':{'product_name':_0x4a644b(0x20c),'product_stock':_0x4a644b(0x1c5)}},{'$group':{'_id':_0x4a644b(0x173),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x4a644b(0x21d)]('Products\x20warehouse_data',_0x150d60),_0x150d60[_0x4a644b(0x290)](_0x80ac4f=>{const _0x22d860=_0x4a644b,_0x111de3=_0x4e5e5a[_0x22d860(0x1ba)](_0x4bc881=>{const _0x5b7583=_0x22d860;_0x4bc881[_0x5b7583(0x200)]==_0x80ac4f['_id']&&(_0x4bc881[_0x5b7583(0x287)]=parseInt(_0x4bc881[_0x5b7583(0x287)])+parseInt(_0x80ac4f['product_stock']));});});const _0x5f42f0=await staff[_0x4a644b(0x2b2)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x49aa55=await staff[_0x4a644b(0x1ff)]({'email':_0x493bf6['email']});if(_0x479e35[0x0]['language']=='English\x20(US)')var _0x5605a0=users[_0x4a644b(0x246)];else{if(_0x479e35[0x0]['language']==_0x4a644b(0x2de))var _0x5605a0=users['Hindi'];else{if(_0x479e35[0x0][_0x4a644b(0x196)]==_0x4a644b(0x1aa))var _0x5605a0=users[_0x4a644b(0x1aa)];else{if(_0x479e35[0x0][_0x4a644b(0x196)]==_0x4a644b(0x2e6))var _0x5605a0=users[_0x4a644b(0x2e6)];else{if(_0x479e35[0x0]['language']==_0x4a644b(0x26d))var _0x5605a0=users[_0x4a644b(0x26d)];else{if(_0x479e35[0x0][_0x4a644b(0x196)]==_0x4a644b(0x195))var _0x5605a0=users[_0x4a644b(0x1a7)];else{if(_0x479e35[0x0][_0x4a644b(0x196)]==_0x4a644b(0x28e))var _0x5605a0=users[_0x4a644b(0x28e)];else{if(_0x479e35[0x0][_0x4a644b(0x196)]=='Arabic\x20(ae)')var _0x5605a0=users[_0x4a644b(0x2a0)];}}}}}}}_0x55b348[_0x4a644b(0x2c2)](_0x4a644b(0x1dd),{'success':_0x5d6330[_0x4a644b(0x26a)]('success'),'errors':_0x5d6330[_0x4a644b(0x26a)](_0x4a644b(0x18f)),'alldata':_0x4e5e5a,'profile':_0x56725f,'master_shop':_0x479e35,'role':_0x493bf6,'product_stock':_0x150d60,'language':_0x5605a0,'staff_arr':_0x49aa55,'staff_data_all':_0x5f42f0});}catch(_0x34c9c1){}}),router[a0_0x4ca221(0x1da)]('/getDSSR_no',auth,async(_0x114af5,_0x312e4c)=>{const _0x4d8333=a0_0x4ca221;try{const {from:_0xb01aab,to:_0x5bb4d7,staff_data:_0x169bdf}=_0x114af5[_0x4d8333(0x271)],_0x4b110f=await Reference[_0x4d8333(0x261)]([{'$match':{'date_include':{'$gte':_0xb01aab,'$lte':_0x5bb4d7},'staff_id':_0x169bdf}},{'$sort':{'date_include':0x1}}]);_0x312e4c[_0x4d8333(0x211)](_0x4b110f);}catch(_0x18d349){_0x312e4c[_0x4d8333(0x211)](_0x18d349);}}),router[a0_0x4ca221(0x1f9)](a0_0x4ca221(0x17e),auth,async(_0x26c92e,_0x1807c8)=>{const _0x525839=a0_0x4ca221;try{const _0x363c14=_0x26c92e['params']['id'],_0x3d31eb=await Reference[_0x525839(0x2a8)](_0x363c14);let _0x5dc6f3='';_0x5dc6f3+=_0x3d31eb['html'],_0x5dc6f3+=_0x525839(0x1a4),_0x5dc6f3+=_0x525839(0x2d4),_0x5dc6f3+='window.print();',_0x5dc6f3+='};',_0x5dc6f3+=_0x525839(0x16e),_0x1807c8[_0x525839(0x17c)](_0x5dc6f3);}catch(_0x171d54){_0x1807c8[_0x525839(0x211)](_0x171d54);}}),router[a0_0x4ca221(0x1da)](a0_0x4ca221(0x2e4),auth,async(_0x1ee9cb,_0x2f85a5)=>{const _0x5da795=a0_0x4ca221;try{const {ref_data:_0xbc6edc}=_0x1ee9cb[_0x5da795(0x271)],_0x5b566f=_0xbc6edc['split']('~'),_0xec3208=_0x5b566f[_0x5da795(0x2df)](_0x4ea3b6=>_0x4ea3b6!==''),_0x111fbf=await Reference[_0x5da795(0x261)]([{'$match':{'referenceNumber':{'$in':_0xec3208}}}]),_0x2d7474=XLSX[_0x5da795(0x17b)]['book_new']();_0x111fbf[_0x5da795(0x290)](_0x153cff=>{const _0xc6690f=_0x5da795,_0xe31321=cheerio[_0xc6690f(0x1c8)](_0x153cff[_0xc6690f(0x1e3)]);let _0x532e7c=[],_0x1f6d97=[],_0x537add=[];_0xe31321(_0xc6690f(0x1de))[_0xc6690f(0x234)]((_0x4051c6,_0x1db39f)=>{const _0x1c17a0=_0xc6690f;let _0x22e8ad=[],_0x2ff23f=0x0;while(_0x537add[_0x2ff23f]){_0x537add[_0x2ff23f]--,_0x2ff23f++;}_0xe31321(_0x1db39f)[_0x1c17a0(0x2b2)]('td,\x20th')[_0x1c17a0(0x234)]((_0x4389b7,_0x18f85d)=>{const _0x523ffd=_0x1c17a0;let _0x34b4ff=_0xe31321(_0x18f85d)[_0x523ffd(0x2d0)]()[_0x523ffd(0x251)](),_0x48709f=parseFloat(_0x34b4ff['replace'](/,/g,''));isNaN(_0x48709f)&&(_0x48709f=_0x34b4ff);let _0x3ca1d3=parseInt(_0xe31321(_0x18f85d)[_0x523ffd(0x223)](_0x523ffd(0x2d3)))||0x1,_0x24b2c6=parseInt(_0xe31321(_0x18f85d)[_0x523ffd(0x223)](_0x523ffd(0x227)))||0x1;_0x22e8ad[_0x2ff23f]=_0x48709f;(_0x3ca1d3>0x1||_0x24b2c6>0x1)&&_0x1f6d97[_0x523ffd(0x2b8)]({'s':{'r':_0x4051c6,'c':_0x2ff23f},'e':{'r':_0x4051c6+_0x24b2c6-0x1,'c':_0x2ff23f+_0x3ca1d3-0x1}});for(let _0x4f09ef=0x0;_0x4f09ef<_0x3ca1d3;_0x4f09ef++){_0x24b2c6>0x1&&(_0x537add[_0x2ff23f+_0x4f09ef]=_0x24b2c6-0x1);}_0x2ff23f+=_0x3ca1d3;}),_0x532e7c[_0x1c17a0(0x2b8)](_0x22e8ad);});const _0x2d1ac9=XLSX[_0xc6690f(0x17b)][_0xc6690f(0x1f2)](_0x532e7c);_0x1f6d97[_0xc6690f(0x1a0)]>0x0&&(_0x2d1ac9[_0xc6690f(0x186)]=_0x1f6d97),_0x2d1ac9[_0xc6690f(0x269)]=_0x532e7c[0x0][_0xc6690f(0x1ba)](()=>({'wpx':0x64})),XLSX[_0xc6690f(0x17b)][_0xc6690f(0x266)](_0x2d7474,_0x2d1ac9,_0x153cff[_0xc6690f(0x2e8)]);});const _0x232cf7=XLSX[_0x5da795(0x1d1)](_0x2d7474,{'bookType':_0x5da795(0x2d5),'type':_0x5da795(0x1ab)});_0x2f85a5['setHeader']('Content-Disposition','attachment;\x20filename=\x22reports.xlsx\x22'),_0x2f85a5['setHeader'](_0x5da795(0x1be),_0x5da795(0x1b3)),_0x2f85a5[_0x5da795(0x17c)](_0x232cf7);}catch(_0x32566d){_0x2f85a5[_0x5da795(0x211)](_0x32566d);}}),router[a0_0x4ca221(0x1da)](a0_0x4ca221(0x2cc),auth,async(_0x5bb0ec,_0xa30236)=>{const _0x5d669c=a0_0x4ca221,{from_date:_0x3e3564,agent_id:_0x5b363d}=_0x5bb0ec['body'],_0x22b4af=_0x5bb0ec[_0x5d669c(0x2b9)],_0x4b888a=await staff[_0x5d669c(0x1ff)]({'email':_0x22b4af[_0x5d669c(0x2eb)]}),_0x43fdf4=await master_shop[_0x5d669c(0x2b2)](),_0x49712a=await agentsdataDSICheck_DSRR(_0x3e3564,_0x5b363d,_0x44d21d);let _0xb4d933=_0x5d669c(0x2da);var _0x2292ad=new Date(_0x3e3564);const _0x2a1940={'year':'numeric','month':_0x5d669c(0x19d),'day':_0x5d669c(0x1e6)},_0x1491de=new Intl['DateTimeFormat'](_0x5d669c(0x289),_0x2a1940)[_0x5d669c(0x204)](_0x2292ad);_0xb4d933+=_0x5d669c(0x1ad),_0xb4d933+=_0x5d669c(0x286),_0xb4d933+=_0x5d669c(0x1af),_0xb4d933+=_0x49712a,_0xb4d933+=_0x5d669c(0x1d4),_0xb4d933+=_0x5d669c(0x1ac),_0xb4d933+='</div>';let _0x4393f8='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x4d7b69={'width':'15in','height':'8.5in','orientation':_0x5d669c(0x166),'border':{'top':_0x5d669c(0x2a1),'right':_0x5d669c(0x2a1),'bottom':_0x5d669c(0x2a1),'left':'0.1in'},'header':{'height':_0x5d669c(0x209),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4393f8+_0x5d669c(0x1d6)+_0x1491de+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':'20mm','contents':{'default':_0x5d669c(0x274)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x5d669c(0x29c)}}};var _0x44d21d='on';if(_0x44d21d=='on'){const _0x366a98=cheerio[_0x5d669c(0x1c8)](_0xb4d933);let _0x40523a=[],_0x6bd191=[],_0x596944=[];_0x366a98(_0x5d669c(0x1de))['each']((_0x102b22,_0x1d363e)=>{const _0x5e23d0=_0x5d669c;let _0x23dde7=[],_0x3c16a3=0x0;while(_0x596944[_0x3c16a3]){_0x596944[_0x3c16a3]--,_0x3c16a3++;}_0x366a98(_0x1d363e)[_0x5e23d0(0x2b2)](_0x5e23d0(0x176))[_0x5e23d0(0x234)]((_0xb35475,_0x996b81)=>{const _0x5b1611=_0x5e23d0;let _0x4749a7=_0x366a98(_0x996b81)[_0x5b1611(0x2d0)]()['trim'](),_0x562a7d=parseFloat(_0x4749a7[_0x5b1611(0x2dc)](/,/g,''));isNaN(_0x562a7d)&&(_0x562a7d=_0x4749a7);let _0x2c8190=parseInt(_0x366a98(_0x996b81)[_0x5b1611(0x223)](_0x5b1611(0x2d3)))||0x1,_0x4424c3=parseInt(_0x366a98(_0x996b81)[_0x5b1611(0x223)](_0x5b1611(0x227)))||0x1;_0x23dde7[_0x3c16a3]=_0x562a7d;(_0x2c8190>0x1||_0x4424c3>0x1)&&_0x6bd191[_0x5b1611(0x2b8)]({'s':{'r':_0x102b22,'c':_0x3c16a3},'e':{'r':_0x102b22+_0x4424c3-0x1,'c':_0x3c16a3+_0x2c8190-0x1}});for(let _0x1f01d6=0x0;_0x1f01d6<_0x2c8190;_0x1f01d6++){_0x4424c3>0x1&&(_0x596944[_0x3c16a3+_0x1f01d6]=_0x4424c3-0x1);}_0x3c16a3+=_0x2c8190;}),_0x40523a[_0x5e23d0(0x2b8)](_0x23dde7);});const _0x1b99d1=XLSX['utils'][_0x5d669c(0x22e)](),_0xa1219c=XLSX[_0x5d669c(0x17b)][_0x5d669c(0x1f2)](_0x40523a);_0x6bd191[_0x5d669c(0x1a0)]>0x0&&(_0xa1219c['!merges']=_0x6bd191);_0xa1219c[_0x5d669c(0x269)]=_0x40523a[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x5d669c(0x266)](_0x1b99d1,_0xa1219c,_0x5d669c(0x17d));const _0x2293e3=XLSX[_0x5d669c(0x1d1)](_0x1b99d1,{'bookType':_0x5d669c(0x2d5),'type':_0x5d669c(0x1ab)});_0xa30236[_0x5d669c(0x2b6)]('Content-Disposition',_0x5d669c(0x2e5)),_0xa30236[_0x5d669c(0x2b6)](_0x5d669c(0x1be),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0xa30236['send'](_0x2293e3);}else pdf['create'](_0xb4d933,_0x4d7b69)[_0x5d669c(0x1f4)](function(_0x124149,_0x40cf28){const _0x49cc31=_0x5d669c;if(_0x124149){_0xa30236['status'](0x1f4)[_0x49cc31(0x17c)]('Error\x20generating\x20PDF');return;}_0xa30236[_0x49cc31(0x2b6)](_0x49cc31(0x1be),_0x49cc31(0x243)),_0x40cf28[_0x49cc31(0x268)](_0xa30236);});}),module[a0_0x4ca221(0x1fa)]=router;