const a0_0x2c4080=a0_0x74ea;(function(_0x1183e1,_0x43ef4f){const _0x5a3cf4=a0_0x74ea,_0x36452c=_0x1183e1();while(!![]){try{const _0x4c9050=-parseInt(_0x5a3cf4(0x178))/0x1*(-parseInt(_0x5a3cf4(0x1da))/0x2)+-parseInt(_0x5a3cf4(0x165))/0x3*(-parseInt(_0x5a3cf4(0xb6))/0x4)+-parseInt(_0x5a3cf4(0x142))/0x5*(-parseInt(_0x5a3cf4(0x16b))/0x6)+parseInt(_0x5a3cf4(0xe3))/0x7+parseInt(_0x5a3cf4(0x1d1))/0x8*(-parseInt(_0x5a3cf4(0xe8))/0x9)+-parseInt(_0x5a3cf4(0xdf))/0xa*(-parseInt(_0x5a3cf4(0x100))/0xb)+parseInt(_0x5a3cf4(0x1b8))/0xc*(-parseInt(_0x5a3cf4(0x1f7))/0xd);if(_0x4c9050===_0x43ef4f)break;else _0x36452c['push'](_0x36452c['shift']());}catch(_0x46a84c){_0x36452c['push'](_0x36452c['shift']());}}}(a0_0x5ca1,0x929c6));const express=require(a0_0x2c4080(0x1dd)),res=require(a0_0x2c4080(0x1bc)),app=express(),router=express[a0_0x2c4080(0x189)](),multer=require(a0_0x2c4080(0xbd)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x2c4080(0x173)),auth=require(a0_0x2c4080(0x10b)),users=require(a0_0x2c4080(0x1e0)),excelJS=require(a0_0x2c4080(0x107)),XLSX=require(a0_0x2c4080(0xe7)),PDFDocument=require(a0_0x2c4080(0x18a)),fs=require('fs'),blobStream=require('blob-stream'),JsBarcode=require(a0_0x2c4080(0x117)),{Canvas}=require('canvas'),pdf=require('html-pdf'),path=require('path'),mongoose=require(a0_0x2c4080(0x1b4)),cheerio=require(a0_0x2c4080(0x21c));router[a0_0x2c4080(0x225)](a0_0x2c4080(0xf6),auth,async(_0x7974ee,_0x3b837)=>{const _0x17ae4a=a0_0x2c4080;try{const {username:_0x23f1cd,email:_0xe4ab04,role:_0x3778ff}=_0x7974ee[_0x17ae4a(0xe4)],_0x113b26=_0x7974ee[_0x17ae4a(0xe4)],_0x3a2491=await profile[_0x17ae4a(0x13d)]({'email':_0x113b26[_0x17ae4a(0x1c6)]}),_0x10e17c={'year':_0x17ae4a(0x1ca),'month':_0x17ae4a(0x19e),'day':'numeric'},_0x2964ef=await master_shop[_0x17ae4a(0x131)]();console[_0x17ae4a(0x12b)](_0x17ae4a(0x1b0),_0x2964ef);const _0x428588=await product[_0x17ae4a(0x131)]();console[_0x17ae4a(0x12b)]('Products\x20find_data',_0x428588);const _0x1dd8d3=await warehouse[_0x17ae4a(0xcd)]([{'$unwind':_0x17ae4a(0x177)},{'$lookup':{'from':_0x17ae4a(0xab),'localField':_0x17ae4a(0x1bd),'foreignField':_0x17ae4a(0xd1),'as':'product_docs'}},{'$unwind':_0x17ae4a(0x22d)},{'$project':{'product_name':_0x17ae4a(0x147),'product_stock':_0x17ae4a(0x157)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x17ae4a(0x1d9)}}}]);console[_0x17ae4a(0x12b)](_0x17ae4a(0x161),_0x1dd8d3),_0x1dd8d3[_0x17ae4a(0x1e2)](_0x1dca0d=>{const _0x39807d=_0x17ae4a,_0x19a97b=_0x428588[_0x39807d(0xe2)](_0x5f1bb3=>{const _0x2b8ed3=_0x39807d;_0x5f1bb3[_0x2b8ed3(0xd1)]==_0x1dca0d[_0x2b8ed3(0x156)]&&(_0x5f1bb3[_0x2b8ed3(0x1ac)]=parseInt(_0x5f1bb3[_0x2b8ed3(0x1ac)])+parseInt(_0x1dca0d[_0x2b8ed3(0x1a5)]));});}),console[_0x17ae4a(0x12b)]('Products\x20find_data',_0x428588);if(_0x2964ef[0x0][_0x17ae4a(0x1e9)]==_0x17ae4a(0x210))var _0x2abb28=users[_0x17ae4a(0x1a6)];else{if(_0x2964ef[0x0]['language']==_0x17ae4a(0x1d5))var _0x2abb28=users[_0x17ae4a(0x1d5)];else{if(_0x2964ef[0x0][_0x17ae4a(0x1e9)]==_0x17ae4a(0x216))var _0x2abb28=users[_0x17ae4a(0x216)];else{if(_0x2964ef[0x0]['language']==_0x17ae4a(0xa1))var _0x2abb28=users[_0x17ae4a(0xa1)];else{if(_0x2964ef[0x0][_0x17ae4a(0x1e9)]==_0x17ae4a(0xd5))var _0x2abb28=users[_0x17ae4a(0xd5)];else{if(_0x2964ef[0x0][_0x17ae4a(0x1e9)]==_0x17ae4a(0x209))var _0x2abb28=users[_0x17ae4a(0x18d)];else{if(_0x2964ef[0x0][_0x17ae4a(0x1e9)]==_0x17ae4a(0x185))var _0x2abb28=users[_0x17ae4a(0x185)];else{if(_0x2964ef[0x0]['language']==_0x17ae4a(0x10f))var _0x2abb28=users[_0x17ae4a(0x1f5)];}}}}}}}_0x3b837[_0x17ae4a(0x1fa)](_0x17ae4a(0xb2),{'success':_0x7974ee['flash'](_0x17ae4a(0x219)),'errors':_0x7974ee['flash']('errors'),'alldata':_0x428588,'profile':_0x3a2491,'master_shop':_0x2964ef,'role':_0x113b26,'product_stock':_0x1dd8d3,'language':_0x2abb28});}catch(_0x4ec307){}});async function dataCheck(_0x5c3494,_0x1159cb){const _0x2a6bf8=a0_0x2c4080,_0x3e1fcf=await product[_0x2a6bf8(0xcd)]([{'$group':{'_id':{'brand':'$brand','category':_0x2a6bf8(0x1b9)},'products':{'$push':{'name':'$name','product_code':_0x2a6bf8(0x1a3)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5bbf71=[];_0x5bbf71[_0x2a6bf8(0x213)]=[];for(let _0x558f0f=0x0;_0x558f0f<=_0x3e1fcf[_0x2a6bf8(0xc4)]-0x1;_0x558f0f++){const _0x59cde0=_0x3e1fcf[_0x558f0f];_0x5bbf71['cat_brand'][_0x2a6bf8(0x175)](_0x59cde0);}const _0x45967f=await product['aggregate']([{'$group':{'_id':{'category':_0x2a6bf8(0x1b9)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x2a6bf8(0x184)}}}},{'$sort':{'_id.category':-0x1}}]),_0x43facb=await purchases_finished[_0x2a6bf8(0xcd)]([{'$match':{'date':{'$gte':_0x5c3494,'$lte':_0x1159cb}}},{'$unwind':_0x2a6bf8(0xf3)},{'$group':{'_id':{'product_name':_0x2a6bf8(0x1f8),'product_code':_0x2a6bf8(0xee)},'totalQTY':{'$sum':_0x2a6bf8(0xa9)}}}]);_0x5bbf71[_0x2a6bf8(0x1de)]=[];for(let _0x377d8c=0x0;_0x377d8c<=_0x43facb[_0x2a6bf8(0xc4)]-0x1;_0x377d8c++){const _0x6d7203=_0x43facb[_0x377d8c];_0x5bbf71['beg_bal']['push'](_0x6d7203);}const _0x39ee10=await sales_sa[_0x2a6bf8(0xcd)]([{'$match':{'date':{'$gte':_0x5c3494,'$lte':_0x1159cb}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':'staffs','localField':_0x2a6bf8(0x125),'foreignField':_0x2a6bf8(0x156),'as':_0x2a6bf8(0x149)}},{'$unwind':_0x2a6bf8(0x170)},{'$unwind':_0x2a6bf8(0x18f)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x2a6bf8(0x152),'product_code':_0x2a6bf8(0xb1)},'totalQTY':{'$sum':_0x2a6bf8(0x153)}}}]);console[_0x2a6bf8(0x12b)](_0x39ee10[0x0]),_0x5bbf71[_0x2a6bf8(0x17a)]=[];for(let _0x4de55e=0x0;_0x4de55e<=_0x39ee10[_0x2a6bf8(0xc4)]-0x1;_0x4de55e++){const _0x5c3a67=_0x39ee10[_0x4de55e];_0x5bbf71['sales_bkg'][_0x2a6bf8(0x175)](_0x5c3a67);}const _0x1ad892=await sales_sa[_0x2a6bf8(0xcd)]([{'$match':{'date':{'$gte':_0x5c3494,'$lte':_0x1159cb}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x2a6bf8(0x15a)}}},{'$lookup':{'from':'staffs','localField':_0x2a6bf8(0x125),'foreignField':_0x2a6bf8(0x156),'as':'sales_info'}},{'$unwind':_0x2a6bf8(0x170)},{'$unwind':_0x2a6bf8(0x18f)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':'false'}},{'$group':{'_id':{'product_name':_0x2a6bf8(0x152),'product_code':_0x2a6bf8(0xb1)},'totalQTY':{'$sum':_0x2a6bf8(0x1db)}}}]);_0x5bbf71['sales_ext']=[];for(let _0x28d715=0x0;_0x28d715<=_0x1ad892[_0x2a6bf8(0xc4)]-0x1;_0x28d715++){const _0x26b3c6=_0x1ad892[_0x28d715];_0x5bbf71['sales_ext'][_0x2a6bf8(0x175)](_0x26b3c6);}let _0x5a7376='';for(let _0x192a0b=0x0;_0x192a0b<=_0x45967f[_0x2a6bf8(0xc4)]-0x1;_0x192a0b++){const _0x43f9e1=_0x45967f[_0x192a0b];_0x5a7376+=_0x2a6bf8(0xd6),_0x5a7376+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x43f9e1[_0x2a6bf8(0x156)][_0x2a6bf8(0x1f4)]+'</td>',_0x5a7376+=_0x2a6bf8(0x1c2);for(let _0x1a6926=0x0;_0x1a6926<_0x5bbf71[_0x2a6bf8(0x213)][_0x2a6bf8(0xc4)];_0x1a6926++){const _0x5cb342=_0x5bbf71[_0x2a6bf8(0x213)][_0x1a6926];if(_0x5cb342[_0x2a6bf8(0x156)]['category']==_0x43f9e1[_0x2a6bf8(0x156)][_0x2a6bf8(0x1f4)]){let _0x3316dc=[],_0x52756=[],_0x4ba985=[];_0x3316dc[_0x5cb342[_0x2a6bf8(0x156)][_0x2a6bf8(0xc7)]]=[],_0x52756[_0x5cb342[_0x2a6bf8(0x156)]['brand']]=[],_0x4ba985[_0x5cb342[_0x2a6bf8(0x156)]['brand']]=[];var _0x3d7ab9=0x0,_0x4c6e67=0x0,_0x3d24c4=0x0;for(let _0x17f084=0x0;_0x17f084<_0x5cb342[_0x2a6bf8(0xab)]['length'];_0x17f084++){const _0x4a5124=_0x5cb342[_0x2a6bf8(0xab)][_0x17f084];for(let _0x55630a=0x0;_0x55630a<=_0x5bbf71[_0x2a6bf8(0x1de)][_0x2a6bf8(0xc4)]-0x1;_0x55630a++){const _0x1e2460=_0x5bbf71[_0x2a6bf8(0x1de)][_0x55630a];_0x1e2460['_id'][_0x2a6bf8(0x115)]==_0x4a5124[_0x2a6bf8(0xd1)]&&_0x1e2460[_0x2a6bf8(0x156)][_0x2a6bf8(0xba)]==_0x4a5124[_0x2a6bf8(0xba)]&&(_0x3d7ab9+=parseInt(_0x1e2460['totalQTY'],0xa));}for(let _0xd177cf=0x0;_0xd177cf<=_0x5bbf71[_0x2a6bf8(0x1c0)]['length']-0x1;_0xd177cf++){const _0x90fee=_0x5bbf71[_0x2a6bf8(0x1c0)][_0xd177cf];_0x90fee[_0x2a6bf8(0x156)][_0x2a6bf8(0x115)]==_0x4a5124[_0x2a6bf8(0xd1)]&&_0x90fee[_0x2a6bf8(0x156)][_0x2a6bf8(0xba)]==_0x4a5124['product_code']&&(_0x4c6e67+=parseFloat(_0x90fee[_0x2a6bf8(0x18c)],0xa)['toFixed'](0x2));}for(let _0xe5414b=0x0;_0xe5414b<=_0x5bbf71[_0x2a6bf8(0x17a)][_0x2a6bf8(0xc4)]-0x1;_0xe5414b++){const _0x18d961=_0x5bbf71['sales_bkg'][_0xe5414b];_0x18d961[_0x2a6bf8(0x156)][_0x2a6bf8(0x115)]==_0x4a5124[_0x2a6bf8(0xd1)]&&_0x18d961['_id'][_0x2a6bf8(0xba)]==_0x4a5124[_0x2a6bf8(0xba)]&&(_0x3d24c4+=parseInt(_0x18d961['totalQTY'],0xa));}}const _0x18de98=new Intl[(_0x2a6bf8(0x146))]('en-US');var _0x49a05e=_0x18de98[_0x2a6bf8(0xea)](_0x3d7ab9);_0x3316dc[_0x5cb342['_id']['brand']][_0x2a6bf8(0x175)](_0x49a05e),_0x52756[_0x5cb342['_id'][_0x2a6bf8(0xc7)]][_0x2a6bf8(0x175)](_0x18de98[_0x2a6bf8(0xea)](_0x4c6e67)),_0x4ba985[_0x5cb342[_0x2a6bf8(0x156)][_0x2a6bf8(0xc7)]]['push'](_0x18de98[_0x2a6bf8(0xea)](_0x3d24c4));var _0xf32d3d=_0x18de98[_0x2a6bf8(0xea)](_0x3d7ab9-(_0x3d24c4+_0x4c6e67));_0x5a7376+=_0x2a6bf8(0xd6),_0x5a7376+=_0x2a6bf8(0xa3),_0x5a7376+=_0x2a6bf8(0x187)+_0x5cb342[_0x2a6bf8(0x156)][_0x2a6bf8(0xc7)]+_0x2a6bf8(0x1c5),_0x5a7376+=_0x2a6bf8(0x187)+_0x3316dc[_0x5cb342[_0x2a6bf8(0x156)][_0x2a6bf8(0xc7)]][0x0]+'</td>',_0x5a7376+=_0x2a6bf8(0x11f),_0x5a7376+=_0x2a6bf8(0x187)+_0x4ba985[_0x5cb342[_0x2a6bf8(0x156)][_0x2a6bf8(0xc7)]][0x0]+_0x2a6bf8(0x1c5),_0x5a7376+='<td\x20class=\x22row_data\x22>'+_0x52756[_0x5cb342[_0x2a6bf8(0x156)][_0x2a6bf8(0xc7)]][0x0]+_0x2a6bf8(0x1c5),_0x5a7376+=_0x2a6bf8(0x187)+_0xf32d3d+_0x2a6bf8(0x1c5),_0x5a7376+=_0x2a6bf8(0x1c2);}}}return console[_0x2a6bf8(0x12b)](_0x5bbf71[_0x2a6bf8(0x17a)]),_0x5a7376;}router['post'](a0_0x2c4080(0x167),auth,async(_0x527b0f,_0x4f8c6d)=>{const _0x133aee=a0_0x2c4080,{from_date:_0x2bc54e,to_date:_0x8cbcf3}=_0x527b0f[_0x133aee(0x1a1)],_0x24e7dd=await dataCheck(_0x2bc54e,_0x8cbcf3);{}let _0x5e4477=_0x133aee(0x14b);var _0x27c4f4=new Date(_0x2bc54e),_0x538af7=new Date(_0x8cbcf3);const _0x20529c={'year':'numeric','month':'long','day':_0x133aee(0x1ca)},_0xe1c432=new Intl[(_0x133aee(0xc6))]('en-US',_0x20529c)['format'](_0x27c4f4),_0x31e738=new Intl[(_0x133aee(0xc6))](_0x133aee(0x218),_0x20529c)[_0x133aee(0xea)](_0x538af7);_0x5e4477+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x5e4477+=_0x133aee(0x104),_0x5e4477+='<p>'+_0xe1c432+_0x133aee(0xd8)+_0x31e738+'</p>',_0x5e4477+=_0x133aee(0xb8),_0x5e4477+='<div\x20class=\x22col-sm-11\x22>',_0x5e4477+=_0x133aee(0x137),_0x5e4477+='<tr>',_0x5e4477+='<th\x20rowspan=\x272\x27>Category</th>',_0x5e4477+=_0x133aee(0x197),_0x5e4477+=_0x133aee(0x1cb)+_0xe1c432+_0x133aee(0xec),_0x5e4477+=_0x133aee(0x14e),_0x5e4477+=_0x133aee(0x22b),_0x5e4477+=_0x133aee(0x1cc)+_0x31e738+'</th>',_0x5e4477+='</tr>',_0x5e4477+='<tr>',_0x5e4477+=_0x133aee(0x222),_0x5e4477+=_0x133aee(0x1eb),_0x5e4477+=_0x133aee(0x1c2),_0x5e4477+=_0x24e7dd,_0x5e4477+=_0x133aee(0x16e),_0x5e4477+='</div>',_0x5e4477+=_0x133aee(0x1a7);const _0x47b4f1={'format':'Letter','orientation':_0x133aee(0x1cf),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x133aee(0x200)}}};pdf['create'](_0x5e4477,_0x47b4f1)[_0x133aee(0x1f1)](function(_0x2b45ba,_0x2cf671){const _0x135d47=_0x133aee;if(_0x2b45ba){_0x4f8c6d['status'](0x1f4)[_0x135d47(0x12a)](_0x135d47(0xc9));return;}_0x4f8c6d[_0x135d47(0x229)](_0x135d47(0xae),_0x135d47(0xa2)),_0x2cf671[_0x135d47(0x1f9)](_0x4f8c6d);});}),router[a0_0x2c4080(0x225)](a0_0x2c4080(0xb0),auth,async(_0x18598d,_0x27ac9d)=>{const _0x52c912=a0_0x2c4080;try{const {username:_0xcebd01,email:_0x1f14c1,role:_0x34b00e}=_0x18598d['user'],_0x26ba20=_0x18598d[_0x52c912(0xe4)],_0x48f6a3=await profile[_0x52c912(0x13d)]({'email':_0x26ba20[_0x52c912(0x1c6)]}),_0x2dca37={'year':_0x52c912(0x1ca),'month':'long','day':_0x52c912(0x1ca)},_0x264a9c=await master_shop[_0x52c912(0x131)](),_0x2eb4d6=await product[_0x52c912(0x131)](),_0x13136e=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x52c912(0x1bd),'foreignField':_0x52c912(0xd1),'as':_0x52c912(0x159)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x52c912(0x147),'product_stock':_0x52c912(0x157)}},{'$group':{'_id':_0x52c912(0xde),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x264a9c[0x0]['language']==_0x52c912(0x210))var _0x2f1c58=users[_0x52c912(0x1a6)];else{if(_0x264a9c[0x0]['language']==_0x52c912(0x1d5))var _0x2f1c58=users['Hindi'];else{if(_0x264a9c[0x0][_0x52c912(0x1e9)]==_0x52c912(0x216))var _0x2f1c58=users[_0x52c912(0x216)];else{if(_0x264a9c[0x0]['language']=='Spanish')var _0x2f1c58=users['Spanish'];else{if(_0x264a9c[0x0][_0x52c912(0x1e9)]==_0x52c912(0xd5))var _0x2f1c58=users[_0x52c912(0xd5)];else{if(_0x264a9c[0x0]['language']==_0x52c912(0x209))var _0x2f1c58=users[_0x52c912(0x18d)];else{if(_0x264a9c[0x0][_0x52c912(0x1e9)]==_0x52c912(0x185))var _0x2f1c58=users['Chinese'];else{if(_0x264a9c[0x0][_0x52c912(0x1e9)]==_0x52c912(0x10f))var _0x2f1c58=users[_0x52c912(0x1f5)];}}}}}}}_0x27ac9d[_0x52c912(0x1fa)](_0x52c912(0xc1),{'success':_0x18598d[_0x52c912(0x160)]('success'),'errors':_0x18598d[_0x52c912(0x160)](_0x52c912(0x220)),'alldata':_0x2eb4d6,'profile':_0x48f6a3,'master_shop':_0x264a9c,'role':_0x26ba20,'product_stock':_0x13136e,'language':_0x2f1c58});}catch(_0x918fa3){}});async function agentsdataCheck(_0x317b2e,_0x1f8b91){const _0x54c406=a0_0x2c4080,_0x367544=await product[_0x54c406(0xcd)]([{'$group':{'_id':{'brand':_0x54c406(0x127),'category':'$category'},'products':{'$push':{'name':'$name','product_code':_0x54c406(0x1a3)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x345735=[];_0x345735['cat_brand']=[];for(let _0x10ec95=0x0;_0x10ec95<=_0x367544['length']-0x1;_0x10ec95++){const _0x27a95e=_0x367544[_0x10ec95];_0x345735['cat_brand'][_0x54c406(0x175)](_0x27a95e);}const _0x9ecfd3=await product[_0x54c406(0xcd)]([{'$group':{'_id':{'category':_0x54c406(0x1b9)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x54c406(0x184)}}}},{'$sort':{'_id.category':-0x1}}]),_0x376626=await product[_0x54c406(0xcd)]([{'$group':{'_id':{'category':'$category','brand':_0x54c406(0x127)}}},{'$group':{'_id':_0x54c406(0x14d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x32e695=await sales_sa[_0x54c406(0xcd)]([{'$match':{'date':{'$gte':_0x317b2e,'$lte':_0x1f8b91}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x54c406(0x15a)}}},{'$lookup':{'from':_0x54c406(0xf5),'localField':'sales_staff_id','foreignField':_0x54c406(0x156),'as':_0x54c406(0x149)}},{'$unwind':_0x54c406(0x170)},{'$unwind':_0x54c406(0x18f)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x54c406(0x1ab)}},{'$lookup':{'from':_0x54c406(0xab),'localField':_0x54c406(0x1a9),'foreignField':_0x54c406(0xba),'as':_0x54c406(0x1fd)}},{'$unwind':_0x54c406(0x1f2)},{'$group':{'_id':{'sales_id':_0x54c406(0x1bf),'category':_0x54c406(0x228),'brand':'$product_info.brand'},'salesman_data':{'$first':'$sales_info.name'},'totalQTY':{'$sum':_0x54c406(0x1db)},'products':{'$push':{'qty':_0x54c406(0x1db),'product_details':{'prod_name':_0x54c406(0x163),'product_code':_0x54c406(0x20a),'category':'$product_info.category','brand':_0x54c406(0xfb)}}}}}]);let _0xaa27a='';_0xaa27a+=_0x54c406(0xd6),_0xaa27a+='<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0xaa27a+=_0x54c406(0x1c2),_0xaa27a+=_0x54c406(0xd6),_0xaa27a+=_0x54c406(0x22f);for(let _0x41be9b=0x0;_0x41be9b<=_0x9ecfd3[_0x54c406(0xc4)]-0x1;_0x41be9b++){const _0x36be4a=_0x9ecfd3[_0x41be9b];for(let _0x11a38c=0x0;_0x11a38c<_0x376626['length'];_0x11a38c++){const _0x58c76a=_0x376626[_0x11a38c];_0x58c76a[_0x54c406(0x156)]==_0x36be4a[_0x54c406(0x156)]['category']&&(_0xaa27a+=_0x54c406(0x114)+_0x58c76a[_0x54c406(0x202)]+_0x54c406(0x12c)+_0x36be4a[_0x54c406(0x156)]['category']+_0x54c406(0x1c5));}}_0xaa27a+=_0x54c406(0x22f),_0xaa27a+='</tr>',_0xaa27a+=_0x54c406(0xd6),_0xaa27a+=_0x54c406(0xbf);for(let _0x326f49=0x0;_0x326f49<=_0x9ecfd3[_0x54c406(0xc4)]-0x1;_0x326f49++){const _0x3251dd=_0x9ecfd3[_0x326f49];for(let _0x29d37b=0x0;_0x29d37b<_0x345735['cat_brand'][_0x54c406(0xc4)];_0x29d37b++){const _0x2fa7ee=_0x345735['cat_brand'][_0x29d37b];_0x2fa7ee[_0x54c406(0x156)]['category']==_0x3251dd[_0x54c406(0x156)]['category']&&(_0xaa27a+=_0x54c406(0x13a)+_0x2fa7ee[_0x54c406(0x156)][_0x54c406(0xc7)]+_0x54c406(0x1c5));}}_0xaa27a+=_0x54c406(0x10e),_0xaa27a+=_0x54c406(0x1c2);let _0x44ecc8={'name':[],'dataqty':{}};for(let _0x45c9c5=0x0;_0x45c9c5<_0x345735[_0x54c406(0x213)][_0x54c406(0xc4)];_0x45c9c5++){const _0x1a9983=_0x345735[_0x54c406(0x213)][_0x45c9c5],_0x3732c5=_0x1a9983[_0x54c406(0x156)][_0x54c406(0xc7)],_0x292621=_0x1a9983[_0x54c406(0x156)][_0x54c406(0x1f4)];!_0x44ecc8['dataqty'][_0x3732c5]&&(_0x44ecc8[_0x54c406(0x1c1)][_0x3732c5]={});!_0x44ecc8[_0x54c406(0x1c1)][_0x3732c5][_0x292621]&&(_0x44ecc8['dataqty'][_0x3732c5][_0x292621]=[]);for(let _0x3b2bf4=0x0;_0x3b2bf4<_0x32e695[_0x54c406(0xc4)];_0x3b2bf4++){const _0x1a9446=_0x32e695[_0x3b2bf4];if(_0x3732c5===_0x1a9446[_0x54c406(0x156)][_0x54c406(0xc7)]&&_0x292621===_0x1a9446[_0x54c406(0x156)][_0x54c406(0x1f4)]){const _0x10d9c4=_0x1a9446[_0x54c406(0x111)];!_0x44ecc8[_0x54c406(0x1c1)][_0x3732c5][_0x292621][_0x10d9c4]&&(_0x44ecc8['dataqty'][_0x3732c5][_0x292621][_0x10d9c4]=[]),_0x44ecc8[_0x54c406(0x1c1)][_0x3732c5][_0x292621][_0x10d9c4][_0x54c406(0x175)](_0x1a9446['totalQTY']),!_0x44ecc8['name']['includes'](_0x10d9c4)&&_0x44ecc8[_0x54c406(0xd1)]['push'](_0x10d9c4);}}}_0xaa27a+=_0x54c406(0xd6);for(let _0x5c0119=0x0;_0x5c0119<=_0x44ecc8['name'][_0x54c406(0xc4)]-0x1;_0x5c0119++){const _0x557660=_0x44ecc8['name'][_0x5c0119];_0xaa27a+=_0x54c406(0x187)+_0x557660+_0x54c406(0x1c5);var _0x12af09=0x0,_0x2d8aeb=0x0;for(let _0x17e162=0x0;_0x17e162<=_0x345735[_0x54c406(0x213)][_0x54c406(0xc4)]-0x1;_0x17e162++){const _0x3a4044=_0x345735[_0x54c406(0x213)][_0x17e162];var _0x1e4d9c=0x0;_0x44ecc8[_0x54c406(0x1c1)][_0x3a4044[_0x54c406(0x156)][_0x54c406(0xc7)]][_0x3a4044[_0x54c406(0x156)][_0x54c406(0x1f4)]][_0x557660]?(_0x1e4d9c=_0x44ecc8[_0x54c406(0x1c1)][_0x3a4044['_id'][_0x54c406(0xc7)]][_0x3a4044[_0x54c406(0x156)][_0x54c406(0x1f4)]][_0x557660][0x0],_0xaa27a+=_0x54c406(0x187)+formatNumber(_0x1e4d9c[_0x54c406(0x10a)](0x2))+_0x54c406(0x1c5)):(_0x1e4d9c=0x0,_0xaa27a+=_0x54c406(0x187)+_0x1e4d9c+_0x54c406(0x1c5)),_0x12af09+=_0x1e4d9c;}_0xaa27a+=_0x54c406(0x187)+formatNumber(_0x12af09[_0x54c406(0x10a)](0x2))+_0x54c406(0x1c5);}return _0xaa27a+=_0x54c406(0x1c2),_0xaa27a;}router[a0_0x2c4080(0xd4)]('/agent/pdf',auth,async(_0x2a746f,_0x14ffe1)=>{const _0x545dee=a0_0x2c4080,{from_date:_0x37fa40,to_date:_0x82528b}=_0x2a746f[_0x545dee(0x1a1)],_0x1c4cb5=await agentsdataCheck(_0x37fa40,_0x82528b);{}let _0x44f1b3=_0x545dee(0x193);var _0x11c163=new Date(_0x37fa40),_0x53d86a=new Date(_0x82528b);const _0x7893af={'year':'numeric','month':'long','day':'numeric'},_0x2924a5=new Intl['DateTimeFormat'](_0x545dee(0x218),_0x7893af)[_0x545dee(0xea)](_0x11c163),_0x33b7a6=new Intl[(_0x545dee(0xc6))](_0x545dee(0x218),_0x7893af)[_0x545dee(0xea)](_0x53d86a);_0x44f1b3+=_0x545dee(0x223),_0x44f1b3+=_0x545dee(0x1bb),_0x44f1b3+=_0x545dee(0xa4)+_0x2924a5+_0x545dee(0xd8)+_0x33b7a6+_0x545dee(0x1b2),_0x44f1b3+=_0x545dee(0xb8),_0x44f1b3+=_0x545dee(0x1fe),_0x44f1b3+=_0x545dee(0x137),_0x44f1b3+=_0x1c4cb5,_0x44f1b3+=_0x545dee(0x16e),_0x44f1b3+=_0x545dee(0x1a7),_0x44f1b3+=_0x545dee(0x1a7);const _0x5eb649={'format':_0x545dee(0x9f),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x545dee(0x200)}}};pdf[_0x545dee(0x158)](_0x44f1b3,_0x5eb649)[_0x545dee(0x1f1)](function(_0x59ae9c,_0x400447){const _0x5983ec=_0x545dee;if(_0x59ae9c){_0x14ffe1[_0x5983ec(0x1ee)](0x1f4)[_0x5983ec(0x12a)](_0x5983ec(0xc9));return;}_0x14ffe1['setHeader']('Content-Type',_0x5983ec(0xa2)),_0x400447[_0x5983ec(0x1f9)](_0x14ffe1);});}),router[a0_0x2c4080(0x225)](a0_0x2c4080(0x1fc),auth,async(_0x422b9e,_0xb9b20c)=>{const _0x3ee2f3=a0_0x2c4080;try{const {username:_0x241fb7,email:_0x339d9a,role:_0xc15a40}=_0x422b9e[_0x3ee2f3(0xe4)],_0x320c2c=_0x422b9e[_0x3ee2f3(0xe4)],_0x10637e=await profile[_0x3ee2f3(0x13d)]({'email':_0x320c2c[_0x3ee2f3(0x1c6)]}),_0x23efb2={'year':_0x3ee2f3(0x1ca),'month':'long','day':_0x3ee2f3(0x1ca)},_0x4090b6=await master_shop[_0x3ee2f3(0x131)](),_0x10c935=await staff[_0x3ee2f3(0x13d)]({'email':_0x320c2c[_0x3ee2f3(0x1c6)]}),_0x8cfbbf=await product[_0x3ee2f3(0x131)](),_0x4971e0=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x3ee2f3(0xab),'localField':_0x3ee2f3(0x1bd),'foreignField':_0x3ee2f3(0xd1),'as':_0x3ee2f3(0x159)}},{'$unwind':_0x3ee2f3(0x22d)},{'$project':{'product_name':_0x3ee2f3(0x147),'product_stock':_0x3ee2f3(0x157)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]),_0x3684e1=await staff[_0x3ee2f3(0x131)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x4090b6[0x0]['language']=='English\x20(US)')var _0x90c396=users[_0x3ee2f3(0x1a6)];else{if(_0x4090b6[0x0][_0x3ee2f3(0x1e9)]==_0x3ee2f3(0x1d5))var _0x90c396=users[_0x3ee2f3(0x1d5)];else{if(_0x4090b6[0x0][_0x3ee2f3(0x1e9)]==_0x3ee2f3(0x216))var _0x90c396=users[_0x3ee2f3(0x216)];else{if(_0x4090b6[0x0][_0x3ee2f3(0x1e9)]=='Spanish')var _0x90c396=users[_0x3ee2f3(0xa1)];else{if(_0x4090b6[0x0][_0x3ee2f3(0x1e9)]==_0x3ee2f3(0xd5))var _0x90c396=users[_0x3ee2f3(0xd5)];else{if(_0x4090b6[0x0][_0x3ee2f3(0x1e9)]=='Portuguese\x20(BR)')var _0x90c396=users[_0x3ee2f3(0x18d)];else{if(_0x4090b6[0x0][_0x3ee2f3(0x1e9)]==_0x3ee2f3(0x185))var _0x90c396=users[_0x3ee2f3(0x185)];else{if(_0x4090b6[0x0][_0x3ee2f3(0x1e9)]=='Arabic\x20(ae)')var _0x90c396=users[_0x3ee2f3(0x1f5)];}}}}}}}_0xb9b20c[_0x3ee2f3(0x1fa)](_0x3ee2f3(0x227),{'success':_0x422b9e[_0x3ee2f3(0x160)](_0x3ee2f3(0x219)),'errors':_0x422b9e[_0x3ee2f3(0x160)](_0x3ee2f3(0x220)),'alldata':_0x8cfbbf,'profile':_0x10637e,'master_shop':_0x4090b6,'role':_0x320c2c,'product_stock':_0x4971e0,'language':_0x90c396,'staff_arr':_0x10c935,'staff_data_all':_0x3684e1});}catch(_0x2d7677){_0xb9b20c[_0x3ee2f3(0x164)](_0x2d7677);}});async function agentsdataDSICheck_admin(_0x85a7e6,_0x53cfac,_0x212c11,_0x4d0127){const _0x16dbad=a0_0x2c4080,_0x303aef=await product[_0x16dbad(0xcd)]([{'$group':{'_id':{'brand':_0x16dbad(0x127),'category':_0x16dbad(0x1b9)},'products':{'$push':{'name':_0x16dbad(0x184),'product_code':_0x16dbad(0x1a3)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x725fa3=[];_0x725fa3['cat_brand']=[];for(let _0x542715=0x0;_0x542715<=_0x303aef[_0x16dbad(0xc4)]-0x1;_0x542715++){const _0x136d00=_0x303aef[_0x542715];_0x725fa3[_0x16dbad(0x213)]['push'](_0x136d00);}const _0x590f63=await product[_0x16dbad(0xcd)]([{'$group':{'_id':{'category':_0x16dbad(0x1b9)},'products':{'$push':{'brand':_0x16dbad(0x127),'product_code':_0x16dbad(0x1a3),'product_name':_0x16dbad(0x184)}}}},{'$sort':{'_id.category':-0x1}}]),_0x27cd82=await product['aggregate']([{'$group':{'_id':{'category':_0x16dbad(0x1b9),'brand':_0x16dbad(0x127)}}},{'$group':{'_id':_0x16dbad(0x14d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1fb324=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x85a7e6,'$lte':_0x53cfac},'sales_staff_id':_0x212c11,'sale_product.isFG':_0x16dbad(0x1ab)}},{'$unwind':_0x16dbad(0x18f)},{'$match':{'sale_product.isFG':_0x16dbad(0x1ab)}},{'$lookup':{'from':_0x16dbad(0xab),'localField':'sale_product.product_code','foreignField':_0x16dbad(0xba),'as':_0x16dbad(0x1fd)}},{'$unwind':_0x16dbad(0x1f2)},{'$group':{'_id':{'dsi':_0x16dbad(0x113),'date':_0x16dbad(0x196),'customer':_0x16dbad(0x198)},'totalQty':{'$sum':_0x16dbad(0x1db)},'products':{'$push':{'qty':_0x16dbad(0x1db),'NetPrice':_0x16dbad(0x192),'discount':'$sale_product.discount','adj_discount':_0x16dbad(0x1df),'product_details':{'prod_name':_0x16dbad(0x163),'product_code':_0x16dbad(0x20a),'category':_0x16dbad(0x228),'brand':_0x16dbad(0xfb),'gross_price':_0x16dbad(0x21d)}}}}},{'$unwind':_0x16dbad(0x169)},{'$group':{'_id':{'dsi':_0x16dbad(0x12d),'date':_0x16dbad(0x13b),'customer':_0x16dbad(0x11b),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x16dbad(0x1ce)},'discount':{'$sum':_0x16dbad(0x155)},'adj_discount':{'$sum':_0x16dbad(0x1e7)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x16dbad(0x12d),'date':_0x16dbad(0x13b),'customer':_0x16dbad(0x11b)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x16dbad(0xef)},'adj_discount':{'$sum':_0x16dbad(0x1e6)},'products':{'$push':{'qty':_0x16dbad(0x20b),'category':'$_id.category','brand':_0x16dbad(0x1f0),'product_details':_0x16dbad(0x177)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4097a6=[],_0x4dc94c={},_0x53cc05={},_0x51fc38={};var _0x289f9b=0x0,_0x5ed9e9=0x0,_0x188cec=0x0,_0x32edfd=0x0,_0x37624d=0x0;const _0x5a7306=0x6;for(let _0x5ebfef=0x0;_0x5ebfef<=_0x1fb324[_0x16dbad(0xc4)]-0x1;_0x5ebfef++){const _0x3422eb=_0x1fb324[_0x5ebfef];let _0x168628='<tr>';_0x168628+=_0x16dbad(0x171)+_0x3422eb[_0x16dbad(0x156)][_0x16dbad(0x138)]+'</td>',_0x168628+=_0x16dbad(0x171)+_0x3422eb[_0x16dbad(0x156)][_0x16dbad(0x176)]+'</td>',_0x168628+=_0x16dbad(0x171)+_0x3422eb[_0x16dbad(0x156)]['customer']+'</td>';let _0x3270f3={};var _0x329b3f=0x0;for(let _0x5d6fbd=0x0;_0x5d6fbd<=_0x3422eb['products'][_0x16dbad(0xc4)]-0x1;_0x5d6fbd++){const _0x5cf44d=_0x3422eb[_0x16dbad(0xab)][_0x5d6fbd];_0x3270f3[_0x5cf44d['brand']+'-'+_0x5cf44d['category']]=_0x5cf44d[_0x16dbad(0x206)];const _0x72927a=_0x5cf44d[_0x16dbad(0xc7)]+'-'+_0x5cf44d[_0x16dbad(0x1f4)];!_0x4dc94c[_0x72927a]&&(_0x4dc94c[_0x72927a]=0x0),!Array[_0x16dbad(0xa5)](_0x51fc38[_0x72927a])&&(_0x51fc38[_0x72927a]=[]),!Array[_0x16dbad(0xa5)](_0x51fc38[_0x72927a])&&(_0x51fc38[_0x72927a]=[]),_0x4dc94c[_0x72927a]+=_0x5cf44d['qty'],_0x51fc38[_0x72927a][_0x16dbad(0x175)](_0x5cf44d[_0x16dbad(0x206)]),_0x329b3f++;}console[_0x16dbad(0x12b)](_0x3422eb);for(let _0x2cd108=0x0;_0x2cd108<=_0x725fa3['cat_brand'][_0x16dbad(0xc4)]-0x1;_0x2cd108++){const _0x4c498c=_0x725fa3['cat_brand'][_0x2cd108],_0x1ede1e=_0x4c498c[_0x16dbad(0x156)][_0x16dbad(0xc7)]+'-'+_0x4c498c[_0x16dbad(0x156)]['category'];_0x168628+=_0x16dbad(0xac)+(_0x3270f3[_0x1ede1e]!==undefined?_0x3270f3[_0x1ede1e][_0x16dbad(0x10a)](0x2):'')+_0x16dbad(0x1c5);}_0x188cec=_0x3422eb['discount']+_0x3422eb[_0x16dbad(0xf4)],_0x168628+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x3422eb[_0x16dbad(0x20c)],0x2)[_0x16dbad(0x10a)](0x2))+_0x16dbad(0x1c5),_0x168628+=_0x16dbad(0x135)+formatNumber(_0x3422eb[_0x16dbad(0x230)][_0x16dbad(0x10a)](0x2))+_0x16dbad(0x1c5),_0x168628+=_0x16dbad(0x135)+formatNumber(_0x188cec)+_0x16dbad(0x1c5),_0x168628+=_0x16dbad(0x135)+formatNumber(_0x3422eb[_0x16dbad(0x15c)]['toFixed'](0x2))+_0x16dbad(0x1c5),_0x168628+=_0x16dbad(0x1c2),_0x289f9b+=parseFloat(_0x3422eb[_0x16dbad(0x20c)][_0x16dbad(0x10a)](0x2)),_0x5ed9e9+=parseFloat(_0x3422eb[_0x16dbad(0x15c)][_0x16dbad(0x10a)](0x2)),_0x32edfd+=_0x188cec,_0x37624d+=parseFloat(_0x3422eb[_0x16dbad(0x230)][_0x16dbad(0x10a)](0x2));if(_0x5ebfef==_0x1fb324[_0x16dbad(0xc4)]-0x1){_0x168628+=_0x16dbad(0xd6),_0x168628+=_0x16dbad(0x1ad),_0x168628+=_0x16dbad(0x1c5);for(let _0x4abb53=0x0;_0x4abb53<=_0x725fa3['cat_brand'][_0x16dbad(0xc4)]-0x1;_0x4abb53++){const _0x209746=_0x725fa3[_0x16dbad(0x213)][_0x4abb53],_0x8f43f9=_0x209746[_0x16dbad(0x156)][_0x16dbad(0xc7)]+'-'+_0x209746[_0x16dbad(0x156)][_0x16dbad(0x1f4)],_0x2a6fb9=_0x51fc38[_0x8f43f9]['reduce']((_0x1866a0,_0x1d9917)=>_0x1866a0+_0x1d9917,0x0);console[_0x16dbad(0x12b)](_0x16dbad(0xce),_0x8f43f9),_0x168628+=_0x16dbad(0x231)+(_0x2a6fb9!==undefined?formatNumber(_0x2a6fb9[_0x16dbad(0x10a)](0x2)):'')+_0x16dbad(0x21e),console[_0x16dbad(0x12b)](_0x51fc38[_0x8f43f9][_0x16dbad(0x20f)]((_0x12ce12,_0x556992)=>_0x12ce12+_0x556992,0x0));}_0x168628+=_0x16dbad(0x102)+formatNumber(_0x289f9b[_0x16dbad(0x10a)](0x2))+_0x16dbad(0x21e),_0x168628+=_0x16dbad(0x102)+formatNumber(_0x37624d)+'</b></td>',_0x168628+=_0x16dbad(0x102)+formatNumber(_0x32edfd)+_0x16dbad(0x21e),_0x168628+=_0x16dbad(0x102)+formatNumber(_0x5ed9e9)+_0x16dbad(0x21e),_0x168628+=_0x16dbad(0x1c2);}_0x4097a6[_0x16dbad(0x175)](_0x168628);}function _0x580b09(_0x3294a3,_0x2a6979){const _0x51b7a6=_0x16dbad,_0x20663b=[];for(let _0xa344e=0x0;_0xa344e<=_0x3294a3['length']-0x1;_0xa344e+=_0x2a6979){_0x20663b[_0x51b7a6(0x175)](_0x3294a3[_0x51b7a6(0x1b6)](_0xa344e,_0xa344e+_0x2a6979));}return _0x20663b;}const _0x28578a=_0x580b09(_0x4097a6,_0x5a7306);let _0x3f1863='';return _0x28578a[_0x16dbad(0x1e2)]((_0x444acd,_0x20c95e)=>{const _0x285e1a=_0x16dbad;_0x20c95e>0x0&&(_0x3f1863+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x3f1863+=_0x285e1a(0x137),_0x3f1863+=_0x285e1a(0x1ba),_0x3f1863+=_0x285e1a(0xd6),_0x3f1863+=_0x285e1a(0x16d),_0x3f1863+=_0x285e1a(0x1c2),_0x3f1863+='<tr>',_0x3f1863+=_0x285e1a(0x1c3);for(let _0x3532c5=0x0;_0x3532c5<=_0x590f63[_0x285e1a(0xc4)]-0x1;_0x3532c5++){const _0x3dbe02=_0x590f63[_0x3532c5];for(let _0x44ef18=0x0;_0x44ef18<_0x27cd82[_0x285e1a(0xc4)];_0x44ef18++){const _0x1a3b3b=_0x27cd82[_0x44ef18];_0x1a3b3b[_0x285e1a(0x156)]===_0x3dbe02[_0x285e1a(0x156)][_0x285e1a(0x1f4)]&&(_0x3f1863+=_0x285e1a(0x114)+_0x1a3b3b[_0x285e1a(0x202)]+_0x285e1a(0x12c)+_0x3dbe02[_0x285e1a(0x156)][_0x285e1a(0x1f4)]+'</td>');}}_0x3f1863+=_0x285e1a(0xf7),_0x3f1863+=_0x285e1a(0x1c2),_0x3f1863+='<tr>',_0x3f1863+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x3f1863+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x3f1863+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x24382d=0x0;_0x24382d<=_0x590f63[_0x285e1a(0xc4)]-0x1;_0x24382d++){const _0x1110db=_0x590f63[_0x24382d];for(let _0x5e1124=0x0;_0x5e1124<_0x725fa3[_0x285e1a(0x213)]['length'];_0x5e1124++){const _0x17a9d8=_0x725fa3['cat_brand'][_0x5e1124];_0x17a9d8['_id'][_0x285e1a(0x1f4)]===_0x1110db['_id'][_0x285e1a(0x1f4)]&&(_0x3f1863+=_0x285e1a(0x13a)+_0x17a9d8['_id'][_0x285e1a(0xc7)]+_0x285e1a(0x1c5));}}_0x3f1863+=_0x285e1a(0x10e),_0x3f1863+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x3f1863+=_0x285e1a(0xdc),_0x3f1863+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x3f1863+=_0x285e1a(0x1c2),_0x3f1863+=_0x285e1a(0xb9),_0x3f1863+='<tbody>',_0x444acd[_0x285e1a(0x1e2)](_0x36cf9a=>{_0x3f1863+=_0x36cf9a;}),console[_0x285e1a(0x12b)](_0x51fc38),_0x3f1863+=_0x285e1a(0xb7),_0x3f1863+=_0x285e1a(0x16e);}),_0x3f1863;}function a0_0x5ca1(){const _0x3cfffd=['$discount','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','$product','adj_discount','staffs','/balance/view','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','deleteOne','$sale_product._id','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','$product_info.brand','Content-Disposition','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','$products.product_details.category','trim','22LRZJtl','$sale_product.prod_cat','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','attachment;\x20filename=\x22reports.xlsx\x22','<p>FINISHED\x20GOODS\x20INVENTORY</p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','<th>\x20SALES\x20</th>','exceljs','note','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','toFixed','../middleware/auth','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','!merges','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','Arabic\x20(ae)','$check_no','salesman_data','save','$dsi','<td\x20colspan=\x22','product_name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','jsbarcode','$bank','amount','each','$_id.customer','toISOString','attr','15in','<td\x20class=\x22row_data\x22>0</td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','params','true','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','60mm','sales_staff_id','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','$brand','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','Products\x20find_data','send','log','\x22\x20class=\x22cat_data\x22>','$_id.dsi','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','find','$products.product_details.gross_price','/inventory_sum/view','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','<table>','dsi','$due_date','<td\x20class=\x22cat_data\x22>','$_id.date','isFG','findOne','<tbody>','8.5in','$amount','getFullYear','10IXXovR','dssr_view_admin','/dsrr_admin/pdf_admin','split','NumberFormat','$product_details.product_name','\x22><b></b></td>','sales_info','text','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<th>\x20BEG\x20BALANCE\x20</th>','$_id.category','<th\x20rowspan=\x272\x27>Production</th>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','/reports/dsrr/view','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$sale_product.product_name','$sale_product.quantity','totalQTYsum','$products.discount','_id','$product_details.product_stock','create','product_docs','$sales_staff_id','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','NetPrice','border-right','<div\x20style=\x22page-break-before:\x20always;\x22></div>','<th>\x20QTY\x20SOLD\x20</th>','flash','Products\x20warehouse_data','book_append_sheet','$product_info.name','json','117MNoEBF','sumqty','/balance/pdf','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','$products','excel','257118EZHZSm','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','</table>','redirect','$sales_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','date_include','../models/all_models','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','push','date','$product_details','588911Dgfcdx','</script>','sales_bkg','20mm','$products.product_details.brand','left','000000','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<th>\x20INVOICE\x20AMOUNT\x20</th>','$sale_product.discount','$name','Chinese','window.onload\x20=\x20function()\x20{','<td\x20class=\x22row_data\x22>','toLocaleString','Router','pdfkit-table','<th>\x20ITEM\x20CODE\x20</th>','totalQTY','Portuguese','style','$sale_product','dsi_sales','No\x20data\x20was\x20Found!','$sale_product.totalprice','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','\x22><b>','getMonth','$date','<th\x20rowspan=\x272\x27>Products</th>','$customer','cash','getDate','border-top','totalPrice','Household','long','attachment;\x20filename=\x22sales_report.xlsx\x22','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','body','$sale_product.stock','$product_code','rowspan','product_stock','English','</div>','due_date','sale_product.product_code','0.1in','false','stock','<td\x20colspan=\x223\x22><b>TOTAL<b>','sales_man_code','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','Products\x20master','/total_sales_reports/pdf','</p>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','mongoose','discount','slice','then','11504724PJqPnE','$category','<thead>','<p>SALES\x20REPORTS</p>','express/lib/response','product_details.product_name','buffer','$sales_info._id','sales_ext','dataqty','</tr>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','<td\x20class=\x22row_data\x22><b>','</td>','email','/getDSSR_no_sales','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','bank','numeric','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','$products.NetPrice','landscape','border-left','1309720RPHFNF','/dsrr_admin/view','write','image','Hindi','/inventory_sum/pdf','$products.qty','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','$product_stock','2nZArGu','$sale_product.real_qty_unit_val','/dsrr/pdf','express','beg_bal','$sale_product.adj_discount','../public/language/languages.json','thick','forEach','medium','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','$NetPrice','$adj_discount','$products.adj_discount','$products.product_details.prod_id','language','aoa_to_sheet','<th>X-Truck</th>','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','thin','status','$status_data','$_id.brand','toStream','$product_info','utils','category','Arabic','border-bottom','13PHxgWi','$product.product_name','pipe','render','/getDSSR_no','/agent_reports/sales_ad','product_info','<div\x20class=\x22col-sm-11\x22>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','/dev/null','toLocaleDateString','brandCount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','$product_list.product_code','qty','setDate','$_id.status_data','Portuguese\x20(BR)','$product_info.product_code','$totalQty','totalQty','table\x20tr','sort','reduce','English\x20(US)','valueOf','bottom','cat_brand','includes','replace','German','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','en-US','success','$sale_product.isFG','Sales\x20Report','cheerio','$product_info.gross_price','</b></td>','sales_reports','errors','/dl_excel','<th>Booking</th>','<h1>JAKA\x20EQUITIES\x20CORP</h1>','$totalGross','get','inventory_sum','dsi_sales_admin','$product_info.category','setHeader','!cols','<th\x20colspan=\x272\x27>SOLD</th>','customer','$product_docs','$cash','<td\x20class=\x22cat_data\x22></td>','totalGross','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','Letter','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','Spanish','application/pdf','<td\x20class=\x22row_data\x22></td>','<p>','isArray','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','filter','td,\x20th','$product.quantity','window.print();','products','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','/dsrr_admin/view_data/:id','Content-Type','load','/agent/view','$sale_product.product_code','balanced','Standard','error','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','69100FRtuow','</tbody>','<div\x20class=\x22row\x22>','</thead>','product_code','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','colspan','multer','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','book_new','agent_sales','check_no','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','length','$products.product_details','DateTimeFormat','brand','product_details','Error\x20generating\x20PDF','top','$product_list','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','aggregate','test','dssr_view','<div\x20\x20id=\x22table-conatainer\x22>','name','/agent_reports/pdf','right','post','French','<tr>','referenceNumber','\x20-\x20','prod_cat','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','\x20-\x20STD','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','/dsrr/view','$product_name','4920710rJdqaO','<script>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','map','1463357QxYYJY','user','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','xlsx','54jjGVYR','html','format','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</th>','$product_list.product_name','$product.product_code'];a0_0x5ca1=function(){return _0x3cfffd;};return a0_0x5ca1();}async function agentsdataDSICheck_admin_excel(_0x3790fc,_0x2cc69e,_0x46604b,_0x21cdb0){const _0x1b0b23=a0_0x2c4080,_0x25aa42=await product[_0x1b0b23(0xcd)]([{'$group':{'_id':{'brand':_0x1b0b23(0x127),'category':'$category'},'products':{'$push':{'name':_0x1b0b23(0x184),'product_code':_0x1b0b23(0x1a3)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5de756=[];_0x5de756['cat_brand']=[];for(let _0x4b884a=0x0;_0x4b884a<=_0x25aa42['length']-0x1;_0x4b884a++){const _0x43664e=_0x25aa42[_0x4b884a];_0x5de756[_0x1b0b23(0x213)][_0x1b0b23(0x175)](_0x43664e);}const _0x282f78=await product[_0x1b0b23(0xcd)]([{'$group':{'_id':{'category':_0x1b0b23(0x1b9)},'products':{'$push':{'brand':_0x1b0b23(0x127),'product_code':_0x1b0b23(0x1a3),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x41a663=await product[_0x1b0b23(0xcd)]([{'$group':{'_id':{'category':_0x1b0b23(0x1b9),'brand':'$brand'}}},{'$group':{'_id':_0x1b0b23(0x14d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2b3247=await sales_sa[_0x1b0b23(0xcd)]([{'$match':{'date':{'$gte':_0x3790fc,'$lte':_0x2cc69e},'sales_staff_id':_0x46604b,'sale_product.isFG':_0x1b0b23(0x1ab)}},{'$unwind':_0x1b0b23(0x18f)},{'$match':{'sale_product.isFG':_0x1b0b23(0x1ab)}},{'$lookup':{'from':_0x1b0b23(0xab),'localField':_0x1b0b23(0x1a9),'foreignField':_0x1b0b23(0xba),'as':_0x1b0b23(0x1fd)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x1b0b23(0x113),'date':_0x1b0b23(0x196),'customer':_0x1b0b23(0x198)},'totalQty':{'$sum':_0x1b0b23(0x1db)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x1b0b23(0x192),'discount':_0x1b0b23(0x183),'adj_discount':_0x1b0b23(0x1df),'product_details':{'prod_name':_0x1b0b23(0x163),'product_code':'$product_info.product_code','category':_0x1b0b23(0x228),'brand':_0x1b0b23(0xfb),'gross_price':_0x1b0b23(0x21d)}}}}},{'$unwind':_0x1b0b23(0x169)},{'$group':{'_id':{'dsi':_0x1b0b23(0x12d),'date':'$_id.date','customer':_0x1b0b23(0x11b),'category':_0x1b0b23(0xfe),'brand':_0x1b0b23(0x17c)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x1b0b23(0x132)]}},'NetPrice':{'$sum':_0x1b0b23(0x1ce)},'discount':{'$sum':_0x1b0b23(0x155)},'adj_discount':{'$sum':_0x1b0b23(0x1e7)},'product_details':{'$first':_0x1b0b23(0xc5)}}},{'$group':{'_id':{'dsi':_0x1b0b23(0x12d),'date':_0x1b0b23(0x13b),'customer':_0x1b0b23(0x11b)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x1b0b23(0x1e5)},'discount':{'$sum':_0x1b0b23(0xef)},'adj_discount':{'$sum':_0x1b0b23(0x1e6)},'products':{'$push':{'qty':_0x1b0b23(0x20b),'category':_0x1b0b23(0x14d),'brand':_0x1b0b23(0x1f0),'product_details':_0x1b0b23(0x177)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x185549=[],_0x5aae7d={},_0x24c617={},_0x1e8a00={};var _0x2f600e=0x0,_0x258504=0x0,_0xaef759=0x0,_0x293faa=0x0,_0x3172d9=0x0;const _0x48f70a=0x16345785d8a0000;for(let _0xec5e5f=0x0;_0xec5e5f<=_0x2b3247[_0x1b0b23(0xc4)]-0x1;_0xec5e5f++){const _0x43bd66=_0x2b3247[_0xec5e5f];let _0x427fe8=_0x1b0b23(0xd6);_0x427fe8+=_0x1b0b23(0x171)+_0x43bd66['_id'][_0x1b0b23(0x138)]+_0x1b0b23(0x1c5),_0x427fe8+=_0x1b0b23(0x171)+_0x43bd66[_0x1b0b23(0x156)][_0x1b0b23(0x176)]+'</td>',_0x427fe8+=_0x1b0b23(0x171)+_0x43bd66[_0x1b0b23(0x156)]['customer']+_0x1b0b23(0x1c5);let _0x48b0f7={};var _0x2be8f2=0x0;for(let _0x254885=0x0;_0x254885<=_0x43bd66[_0x1b0b23(0xab)][_0x1b0b23(0xc4)]-0x1;_0x254885++){const _0x4a828b=_0x43bd66[_0x1b0b23(0xab)][_0x254885];_0x48b0f7[_0x4a828b[_0x1b0b23(0xc7)]+'-'+_0x4a828b[_0x1b0b23(0x1f4)]]=_0x4a828b['qty'];const _0x1969f7=_0x4a828b[_0x1b0b23(0xc7)]+'-'+_0x4a828b[_0x1b0b23(0x1f4)];!_0x5aae7d[_0x1969f7]&&(_0x5aae7d[_0x1969f7]=0x0),!Array['isArray'](_0x1e8a00[_0x1969f7])&&(_0x1e8a00[_0x1969f7]=[]),!Array[_0x1b0b23(0xa5)](_0x1e8a00[_0x1969f7])&&(_0x1e8a00[_0x1969f7]=[]),_0x5aae7d[_0x1969f7]+=_0x4a828b[_0x1b0b23(0x206)],_0x1e8a00[_0x1969f7][_0x1b0b23(0x175)](_0x4a828b[_0x1b0b23(0x206)]),_0x2be8f2++;}console[_0x1b0b23(0x12b)](_0x43bd66);for(let _0x3e0d4e=0x0;_0x3e0d4e<=_0x5de756['cat_brand'][_0x1b0b23(0xc4)]-0x1;_0x3e0d4e++){const _0x25b294=_0x5de756[_0x1b0b23(0x213)][_0x3e0d4e],_0x5694af=_0x25b294[_0x1b0b23(0x156)]['brand']+'-'+_0x25b294['_id'][_0x1b0b23(0x1f4)];_0x427fe8+=_0x1b0b23(0xac)+(_0x48b0f7[_0x5694af]!==undefined?_0x48b0f7[_0x5694af][_0x1b0b23(0x10a)](0x2):'')+_0x1b0b23(0x1c5);}_0xaef759=_0x43bd66[_0x1b0b23(0x1b5)]+_0x43bd66['adj_discount'],_0x427fe8+=_0x1b0b23(0x135)+formatNumber(parseFloat(_0x43bd66[_0x1b0b23(0x20c)],0x2)[_0x1b0b23(0x10a)](0x2))+_0x1b0b23(0x1c5),_0x427fe8+=_0x1b0b23(0x135)+formatNumber(_0x43bd66['totalGross'][_0x1b0b23(0x10a)](0x2))+'</td>',_0x427fe8+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xaef759)+_0x1b0b23(0x1c5),_0x427fe8+=_0x1b0b23(0x135)+formatNumber(_0x43bd66['NetPrice'][_0x1b0b23(0x10a)](0x2))+'</td>',_0x427fe8+='</tr>',_0x2f600e+=parseFloat(_0x43bd66[_0x1b0b23(0x20c)][_0x1b0b23(0x10a)](0x2)),_0x258504+=parseFloat(_0x43bd66[_0x1b0b23(0x15c)][_0x1b0b23(0x10a)](0x2)),_0x293faa+=_0xaef759,_0x3172d9+=parseFloat(_0x43bd66[_0x1b0b23(0x230)][_0x1b0b23(0x10a)](0x2));if(_0xec5e5f==_0x2b3247[_0x1b0b23(0xc4)]-0x1){_0x427fe8+=_0x1b0b23(0xd6),_0x427fe8+=_0x1b0b23(0x1ad),_0x427fe8+=_0x1b0b23(0x1c5);for(let _0x4bb5ad=0x0;_0x4bb5ad<=_0x5de756[_0x1b0b23(0x213)]['length']-0x1;_0x4bb5ad++){const _0x5e789c=_0x5de756[_0x1b0b23(0x213)][_0x4bb5ad],_0x41169b=_0x5e789c[_0x1b0b23(0x156)][_0x1b0b23(0xc7)]+'-'+_0x5e789c[_0x1b0b23(0x156)]['category'],_0x325c92=_0x1e8a00[_0x41169b]['reduce']((_0xdf7a12,_0x312f9d)=>_0xdf7a12+_0x312f9d,0x0);console[_0x1b0b23(0x12b)](_0x1b0b23(0xce),_0x41169b),_0x427fe8+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x325c92!==undefined?formatNumber(_0x325c92[_0x1b0b23(0x10a)](0x2)):'')+_0x1b0b23(0x21e),console[_0x1b0b23(0x12b)](_0x1e8a00[_0x41169b][_0x1b0b23(0x20f)]((_0x44fe2a,_0x1294dd)=>_0x44fe2a+_0x1294dd,0x0));}_0x427fe8+=_0x1b0b23(0x102)+formatNumber(_0x2f600e['toFixed'](0x2))+_0x1b0b23(0x21e),_0x427fe8+=_0x1b0b23(0x102)+formatNumber(_0x3172d9)+'</b></td>',_0x427fe8+=_0x1b0b23(0x102)+formatNumber(_0x293faa)+_0x1b0b23(0x21e),_0x427fe8+=_0x1b0b23(0x102)+formatNumber(_0x258504)+'</b></td>',_0x427fe8+=_0x1b0b23(0x1c2);}_0x185549['push'](_0x427fe8);}function _0x416a08(_0x3bf033,_0x342681){const _0x2bd8e9=_0x1b0b23,_0x3c9955=[];for(let _0x21fd76=0x0;_0x21fd76<=_0x3bf033[_0x2bd8e9(0xc4)]-0x1;_0x21fd76+=_0x342681){_0x3c9955['push'](_0x3bf033[_0x2bd8e9(0x1b6)](_0x21fd76,_0x21fd76+_0x342681));}return _0x3c9955;}const _0x3672b1=_0x416a08(_0x185549,_0x48f70a);let _0x54a910='';return _0x3672b1[_0x1b0b23(0x1e2)]((_0x2867a7,_0x3926ee)=>{const _0x4a0bdf=_0x1b0b23;_0x3926ee>0x0&&(_0x54a910+=_0x4a0bdf(0x15e));_0x54a910+=_0x4a0bdf(0x137),_0x54a910+=_0x4a0bdf(0x1ba),_0x54a910+=_0x4a0bdf(0xd6),_0x54a910+=_0x4a0bdf(0x16d),_0x54a910+='</tr>',_0x54a910+=_0x4a0bdf(0xd6),_0x54a910+=_0x4a0bdf(0x1c3);for(let _0x386024=0x0;_0x386024<=_0x282f78[_0x4a0bdf(0xc4)]-0x1;_0x386024++){const _0x424c68=_0x282f78[_0x386024];for(let _0x1b1d25=0x0;_0x1b1d25<_0x41a663[_0x4a0bdf(0xc4)];_0x1b1d25++){const _0xbdabc=_0x41a663[_0x1b1d25];_0xbdabc[_0x4a0bdf(0x156)]===_0x424c68[_0x4a0bdf(0x156)][_0x4a0bdf(0x1f4)]&&(_0x54a910+=_0x4a0bdf(0x114)+_0xbdabc[_0x4a0bdf(0x202)]+_0x4a0bdf(0x12c)+_0x424c68[_0x4a0bdf(0x156)]['category']+_0x4a0bdf(0x1c5));}}_0x54a910+=_0x4a0bdf(0xf7),_0x54a910+=_0x4a0bdf(0x1c2),_0x54a910+=_0x4a0bdf(0xd6),_0x54a910+=_0x4a0bdf(0xbb),_0x54a910+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x54a910+=_0x4a0bdf(0xfd);for(let _0x3b951d=0x0;_0x3b951d<=_0x282f78[_0x4a0bdf(0xc4)]-0x1;_0x3b951d++){const _0x1a5eb0=_0x282f78[_0x3b951d];for(let _0x60096a=0x0;_0x60096a<_0x5de756[_0x4a0bdf(0x213)][_0x4a0bdf(0xc4)];_0x60096a++){const _0x3c33b3=_0x5de756['cat_brand'][_0x60096a];_0x3c33b3['_id']['category']===_0x1a5eb0[_0x4a0bdf(0x156)][_0x4a0bdf(0x1f4)]&&(_0x54a910+=_0x4a0bdf(0x13a)+_0x3c33b3['_id'][_0x4a0bdf(0xc7)]+'</td>');}}_0x54a910+=_0x4a0bdf(0x10e),_0x54a910+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x54a910+=_0x4a0bdf(0xdc),_0x54a910+=_0x4a0bdf(0x130),_0x54a910+=_0x4a0bdf(0x1c2),_0x54a910+=_0x4a0bdf(0xb9),_0x54a910+=_0x4a0bdf(0x13e),_0x2867a7[_0x4a0bdf(0x1e2)](_0x10dd90=>{_0x54a910+=_0x10dd90;}),console[_0x4a0bdf(0x12b)](_0x1e8a00),_0x54a910+='</tbody>',_0x54a910+=_0x4a0bdf(0x16e);}),_0x54a910;}router[a0_0x2c4080(0xd4)]('/agent_reports/pdf_admin',auth,async(_0x2e372d,_0xe8aebf)=>{const _0x24b4f3=a0_0x2c4080,{from_date:_0x4a1eb6,to_date:_0x321285,isExcel:_0x41c399,agent_id:_0x42b467}=_0x2e372d[_0x24b4f3(0x1a1)],_0x4c9e12=_0x2e372d['user'],_0x2a7d7c=await staff[_0x24b4f3(0x13d)]({'email':_0x4c9e12[_0x24b4f3(0x1c6)]}),_0x28859b=await master_shop[_0x24b4f3(0x131)](),_0x4b4dec=await agentsdataDSICheck_admin(_0x4a1eb6,_0x321285,_0x42b467,_0x41c399),_0x1879bb=await agentsdataDSICheck_admin_excel(_0x4a1eb6,_0x321285,_0x42b467,_0x41c399);let _0x3c7aba='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x2c88c4=new Date(_0x4a1eb6),_0xae3c9d=new Date(_0x321285);const _0x2de454={'year':_0x24b4f3(0x1ca),'month':'long','day':_0x24b4f3(0x1ca)},_0x27024c=new Intl[(_0x24b4f3(0xc6))](_0x24b4f3(0x218),_0x2de454)[_0x24b4f3(0xea)](_0x2c88c4),_0x3b8e61=new Intl[(_0x24b4f3(0xc6))]('en-US',_0x2de454)['format'](_0xae3c9d);_0x3c7aba+='<div\x20class=\x22row\x22>',_0x3c7aba+=_0x24b4f3(0xd0),_0x3c7aba+='<table>',_0x3c7aba+=_0x4b4dec,_0x3c7aba+=_0x24b4f3(0x16e),_0x3c7aba+='</div>',_0x3c7aba+=_0x24b4f3(0x1a7);let _0xb2846d='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0xb2846d+=_0x24b4f3(0xb8),_0xb2846d+=_0x24b4f3(0xd0),_0xb2846d+=_0x24b4f3(0x137),_0xb2846d+=_0x1879bb,_0xb2846d+=_0x24b4f3(0x16e),_0xb2846d+='</div>',_0xb2846d+='</div>';let _0x36677b=_0x24b4f3(0x204);const _0x83ba21={'width':'15in','height':_0x24b4f3(0x13f),'orientation':'landscape','border':{'top':_0x24b4f3(0x1aa),'right':'0.1in','bottom':_0x24b4f3(0x1aa),'left':_0x24b4f3(0x1aa)},'header':{'height':_0x24b4f3(0x124),'contents':_0x24b4f3(0x181)+_0x36677b+_0x24b4f3(0x1c8)+_0x27024c+_0x24b4f3(0xd8)+_0x3b8e61+_0x24b4f3(0xeb)},'footer':{'height':'20mm','contents':{'default':_0x24b4f3(0x17f)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x41c399=='on'){const _0x4bb804=cheerio['load'](_0xb2846d);let _0x2e7a24=[],_0x4445a3=[],_0x212984=[];_0x4bb804('table\x20tr')[_0x24b4f3(0x11a)]((_0x7ceff,_0x721673)=>{const _0x9ead33=_0x24b4f3;let _0x52d2d9=[],_0x4e8131=0x0;while(_0x212984[_0x4e8131]){_0x212984[_0x4e8131]--,_0x4e8131++;}_0x4bb804(_0x721673)[_0x9ead33(0x131)]('td,\x20th')[_0x9ead33(0x11a)]((_0x44684a,_0xdbadcf)=>{const _0x158fa3=_0x9ead33;let _0x2e5bdf=_0x4bb804(_0xdbadcf)[_0x158fa3(0x14a)]()[_0x158fa3(0xff)](),_0x4e5462=parseFloat(_0x2e5bdf[_0x158fa3(0x215)](/,/g,''));isNaN(_0x4e5462)&&(_0x4e5462=_0x2e5bdf);let _0x2f5dc6=parseInt(_0x4bb804(_0xdbadcf)[_0x158fa3(0x11d)](_0x158fa3(0xbc)))||0x1,_0x232a62=parseInt(_0x4bb804(_0xdbadcf)[_0x158fa3(0x11d)](_0x158fa3(0x1a4)))||0x1;_0x52d2d9[_0x4e8131]=_0x4e5462;(_0x2f5dc6>0x1||_0x232a62>0x1)&&_0x4445a3[_0x158fa3(0x175)]({'s':{'r':_0x7ceff,'c':_0x4e8131},'e':{'r':_0x7ceff+_0x232a62-0x1,'c':_0x4e8131+_0x2f5dc6-0x1}});for(let _0x1f889c=0x0;_0x1f889c<_0x2f5dc6;_0x1f889c++){_0x232a62>0x1&&(_0x212984[_0x4e8131+_0x1f889c]=_0x232a62-0x1);}_0x4e8131+=_0x2f5dc6;}),_0x2e7a24[_0x9ead33(0x175)](_0x52d2d9);});const _0x37bffb=XLSX[_0x24b4f3(0x1f3)][_0x24b4f3(0xc0)](),_0x470254=XLSX[_0x24b4f3(0x1f3)][_0x24b4f3(0x1ea)](_0x2e7a24);_0x4445a3[_0x24b4f3(0xc4)]>0x0&&(_0x470254[_0x24b4f3(0x10d)]=_0x4445a3);_0x470254[_0x24b4f3(0x22a)]=_0x2e7a24[0x0][_0x24b4f3(0xe2)](()=>({'wpx':0x64})),XLSX[_0x24b4f3(0x1f3)][_0x24b4f3(0x162)](_0x37bffb,_0x470254,'Sales\x20Report');const _0x2c32b8=XLSX['write'](_0x37bffb,{'bookType':_0x24b4f3(0xe7),'type':_0x24b4f3(0x1be)});_0xe8aebf[_0x24b4f3(0x229)](_0x24b4f3(0xfc),_0x24b4f3(0x19f)),_0xe8aebf['setHeader'](_0x24b4f3(0xae),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0xe8aebf['send'](_0x2c32b8);}else pdf[_0x24b4f3(0x158)](_0x3c7aba,_0x83ba21)[_0x24b4f3(0x1f1)](function(_0x27aaf2,_0x5956b6){const _0x4ddc32=_0x24b4f3;if(_0x27aaf2){_0xe8aebf['status'](0x1f4)[_0x4ddc32(0x12a)](_0x4ddc32(0xc9));return;}_0xe8aebf['setHeader'](_0x4ddc32(0xae),_0x4ddc32(0xa2)),_0x5956b6[_0x4ddc32(0x1f9)](_0xe8aebf);});}),router[a0_0x2c4080(0x225)]('/agent_reports/view',auth,async(_0x3cf782,_0x36bd8f)=>{const _0x59a395=a0_0x2c4080;try{const {username:_0x4f76bd,email:_0xaaff92,role:_0x2610c4}=_0x3cf782[_0x59a395(0xe4)],_0x30a52c=_0x3cf782[_0x59a395(0xe4)],_0x13192f=await profile[_0x59a395(0x13d)]({'email':_0x30a52c[_0x59a395(0x1c6)]}),_0xad63f={'year':_0x59a395(0x1ca),'month':_0x59a395(0x19e),'day':_0x59a395(0x1ca)},_0x2b803b=await master_shop[_0x59a395(0x131)](),_0x410e55=await staff['findOne']({'email':_0x30a52c[_0x59a395(0x1c6)]}),_0x5b483f=await product[_0x59a395(0x131)](),_0x50cadd=await warehouse[_0x59a395(0xcd)]([{'$unwind':_0x59a395(0x177)},{'$lookup':{'from':_0x59a395(0xab),'localField':_0x59a395(0x1bd),'foreignField':_0x59a395(0xd1),'as':_0x59a395(0x159)}},{'$unwind':_0x59a395(0x22d)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x59a395(0x157)}},{'$group':{'_id':_0x59a395(0xde),'product_stock':{'$sum':_0x59a395(0x1d9)}}}]);if(_0x2b803b[0x0][_0x59a395(0x1e9)]==_0x59a395(0x210))var _0x236c86=users[_0x59a395(0x1a6)];else{if(_0x2b803b[0x0][_0x59a395(0x1e9)]=='Hindi')var _0x236c86=users['Hindi'];else{if(_0x2b803b[0x0][_0x59a395(0x1e9)]==_0x59a395(0x216))var _0x236c86=users['German'];else{if(_0x2b803b[0x0][_0x59a395(0x1e9)]=='Spanish')var _0x236c86=users[_0x59a395(0xa1)];else{if(_0x2b803b[0x0]['language']==_0x59a395(0xd5))var _0x236c86=users[_0x59a395(0xd5)];else{if(_0x2b803b[0x0][_0x59a395(0x1e9)]==_0x59a395(0x209))var _0x236c86=users[_0x59a395(0x18d)];else{if(_0x2b803b[0x0][_0x59a395(0x1e9)]==_0x59a395(0x185))var _0x236c86=users[_0x59a395(0x185)];else{if(_0x2b803b[0x0][_0x59a395(0x1e9)]==_0x59a395(0x10f))var _0x236c86=users[_0x59a395(0x1f5)];}}}}}}}_0x36bd8f[_0x59a395(0x1fa)](_0x59a395(0x190),{'success':_0x3cf782[_0x59a395(0x160)](_0x59a395(0x219)),'errors':_0x3cf782['flash'](_0x59a395(0x220)),'alldata':_0x5b483f,'profile':_0x13192f,'master_shop':_0x2b803b,'role':_0x30a52c,'product_stock':_0x50cadd,'language':_0x236c86,'staff_arr':_0x410e55});}catch(_0x1fba58){}});function a0_0x74ea(_0x14cb09,_0x5912a6){const _0x5ca14b=a0_0x5ca1();return a0_0x74ea=function(_0x74ea6f,_0x2631de){_0x74ea6f=_0x74ea6f-0x9e;let _0x3782f7=_0x5ca14b[_0x74ea6f];return _0x3782f7;},a0_0x74ea(_0x14cb09,_0x5912a6);}function formatNumber(_0xafb58d,_0x3c890e=a0_0x2c4080(0x218),_0x4a9721={'minimumFractionDigits':0x2}){const _0x1e1d40=a0_0x2c4080,_0x3c3247=new Intl[(_0x1e1d40(0x146))](_0x3c890e,_0x4a9721);return _0x3c3247[_0x1e1d40(0xea)](_0xafb58d);}async function agentsdataDSICheck(_0x2a28b5,_0x3beb28,_0x4f16af,_0x7eec90){const _0x59d23b=a0_0x2c4080,_0x3a1081=await product['aggregate']([{'$group':{'_id':{'brand':_0x59d23b(0x127),'category':_0x59d23b(0x1b9)},'products':{'$push':{'name':'$name','product_code':_0x59d23b(0x1a3)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x508d31=[];_0x508d31[_0x59d23b(0x213)]=[];for(let _0x9d2133=0x0;_0x9d2133<=_0x3a1081[_0x59d23b(0xc4)]-0x1;_0x9d2133++){const _0x2879ba=_0x3a1081[_0x9d2133];_0x508d31['cat_brand'][_0x59d23b(0x175)](_0x2879ba);}const _0x2315bb=await product[_0x59d23b(0xcd)]([{'$group':{'_id':{'category':_0x59d23b(0x1b9)},'products':{'$push':{'brand':_0x59d23b(0x127),'product_code':'$product_code','product_name':_0x59d23b(0x184)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3cf728=await product['aggregate']([{'$group':{'_id':{'category':_0x59d23b(0x1b9),'brand':'$brand'}}},{'$group':{'_id':_0x59d23b(0x14d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4be718=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x2a28b5,'$lte':_0x3beb28},'sales_staff_id':_0x4f16af,'sale_product.isFG':'false'}},{'$unwind':_0x59d23b(0x18f)},{'$match':{'sale_product.isFG':_0x59d23b(0x1ab)}},{'$lookup':{'from':_0x59d23b(0xab),'localField':_0x59d23b(0x1a9),'foreignField':'product_code','as':_0x59d23b(0x1fd)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x59d23b(0x113),'date':_0x59d23b(0x196),'customer':_0x59d23b(0x198)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x59d23b(0x1db),'NetPrice':_0x59d23b(0x192),'discount':'$sale_product.discount','adj_discount':_0x59d23b(0x1df),'product_details':{'prod_name':'$product_info.name','product_code':_0x59d23b(0x20a),'category':'$product_info.category','brand':_0x59d23b(0xfb),'gross_price':_0x59d23b(0x21d)}}}}},{'$unwind':_0x59d23b(0x169)},{'$group':{'_id':{'dsi':_0x59d23b(0x12d),'date':_0x59d23b(0x13b),'customer':_0x59d23b(0x11b),'category':_0x59d23b(0xfe),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x59d23b(0x1d7)},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x59d23b(0x1ce)},'discount':{'$sum':_0x59d23b(0x155)},'adj_discount':{'$sum':_0x59d23b(0x1e7)},'product_details':{'$first':_0x59d23b(0xc5)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x59d23b(0x13b),'customer':_0x59d23b(0x11b)},'totalQty':{'$sum':_0x59d23b(0x20b)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x59d23b(0x1e5)},'discount':{'$sum':_0x59d23b(0xef)},'adj_discount':{'$sum':_0x59d23b(0x1e6)},'products':{'$push':{'qty':_0x59d23b(0x20b),'category':_0x59d23b(0x14d),'brand':_0x59d23b(0x1f0),'product_details':_0x59d23b(0x177)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x5391db=[],_0xcffa27={},_0x1f6baa={},_0x3c5052={};var _0x48a441=0x0,_0x17fbe0=0x0,_0x59275f=0x0,_0x1680e7=0x0,_0x5a183f=0x0;const _0xf646f0=0x6;for(let _0x43e212=0x0;_0x43e212<=_0x4be718['length']-0x1;_0x43e212++){const _0x4772b2=_0x4be718[_0x43e212];let _0x4c41fb=_0x59d23b(0xd6);_0x4c41fb+=_0x59d23b(0x171)+_0x4772b2[_0x59d23b(0x156)]['dsi']+_0x59d23b(0x1c5),_0x4c41fb+=_0x59d23b(0x171)+_0x4772b2['_id'][_0x59d23b(0x176)]+'</td>',_0x4c41fb+=_0x59d23b(0x171)+_0x4772b2[_0x59d23b(0x156)][_0x59d23b(0x22c)]+_0x59d23b(0x1c5);let _0x1646ec={};var _0x38fdc2=0x0;for(let _0x46ec16=0x0;_0x46ec16<=_0x4772b2[_0x59d23b(0xab)][_0x59d23b(0xc4)]-0x1;_0x46ec16++){const _0x17f240=_0x4772b2[_0x59d23b(0xab)][_0x46ec16];_0x1646ec[_0x17f240[_0x59d23b(0xc7)]+'-'+_0x17f240[_0x59d23b(0x1f4)]]=_0x17f240[_0x59d23b(0x206)];const _0x1a9639=_0x17f240[_0x59d23b(0xc7)]+'-'+_0x17f240['category'];!_0xcffa27[_0x1a9639]&&(_0xcffa27[_0x1a9639]=0x0),!Array['isArray'](_0x3c5052[_0x1a9639])&&(_0x3c5052[_0x1a9639]=[]),!Array['isArray'](_0x3c5052[_0x1a9639])&&(_0x3c5052[_0x1a9639]=[]),_0xcffa27[_0x1a9639]+=_0x17f240[_0x59d23b(0x206)],_0x3c5052[_0x1a9639][_0x59d23b(0x175)](_0x17f240['qty']),_0x38fdc2++;}console['log'](_0x4772b2);for(let _0x4778a0=0x0;_0x4778a0<=_0x508d31[_0x59d23b(0x213)]['length']-0x1;_0x4778a0++){const _0x4c50a6=_0x508d31[_0x59d23b(0x213)][_0x4778a0],_0x33a1d3=_0x4c50a6[_0x59d23b(0x156)][_0x59d23b(0xc7)]+'-'+_0x4c50a6[_0x59d23b(0x156)][_0x59d23b(0x1f4)];_0x4c41fb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x1646ec[_0x33a1d3]!==undefined?_0x1646ec[_0x33a1d3][_0x59d23b(0x10a)](0x2):'')+_0x59d23b(0x1c5);}_0x59275f=_0x4772b2[_0x59d23b(0x1b5)]+_0x4772b2[_0x59d23b(0xf4)],_0x4c41fb+=_0x59d23b(0x135)+formatNumber(parseFloat(_0x4772b2['totalQty'],0x2)[_0x59d23b(0x10a)](0x2))+'</td>',_0x4c41fb+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x4772b2[_0x59d23b(0x230)]['toFixed'](0x2))+_0x59d23b(0x1c5),_0x4c41fb+=_0x59d23b(0x135)+formatNumber(_0x59275f)+_0x59d23b(0x1c5),_0x4c41fb+=_0x59d23b(0x135)+formatNumber(_0x4772b2['NetPrice'][_0x59d23b(0x10a)](0x2))+_0x59d23b(0x1c5),_0x4c41fb+=_0x59d23b(0x1c2),_0x48a441+=parseFloat(_0x4772b2[_0x59d23b(0x20c)][_0x59d23b(0x10a)](0x2)),_0x17fbe0+=parseFloat(_0x4772b2[_0x59d23b(0x15c)][_0x59d23b(0x10a)](0x2)),_0x1680e7+=_0x59275f,_0x5a183f+=parseFloat(_0x4772b2[_0x59d23b(0x230)]['toFixed'](0x2));if(_0x43e212==_0x4be718[_0x59d23b(0xc4)]-0x1){_0x4c41fb+=_0x59d23b(0xd6),_0x4c41fb+=_0x59d23b(0x1ad),_0x4c41fb+=_0x59d23b(0x1c5);for(let _0x22a55f=0x0;_0x22a55f<=_0x508d31[_0x59d23b(0x213)][_0x59d23b(0xc4)]-0x1;_0x22a55f++){const _0x272fd1=_0x508d31[_0x59d23b(0x213)][_0x22a55f],_0x4c76c4=_0x272fd1['_id'][_0x59d23b(0xc7)]+'-'+_0x272fd1[_0x59d23b(0x156)][_0x59d23b(0x1f4)],_0x292e3e=_0x3c5052[_0x4c76c4]['reduce']((_0x2f9802,_0x4b4a8d)=>_0x2f9802+_0x4b4a8d,0x0);_0x4c41fb+=_0x59d23b(0x231)+(_0x292e3e!==undefined?formatNumber(_0x292e3e[_0x59d23b(0x10a)](0x2)):'')+'</b></td>',console[_0x59d23b(0x12b)](_0x3c5052[_0x4c76c4]['reduce']((_0x5c800e,_0x188e31)=>_0x5c800e+_0x188e31,0x0));}_0x4c41fb+=_0x59d23b(0x102)+formatNumber(_0x48a441['toFixed'](0x2))+'</b></td>',_0x4c41fb+=_0x59d23b(0x102)+formatNumber(_0x5a183f)+_0x59d23b(0x21e),_0x4c41fb+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1680e7)+'</b></td>',_0x4c41fb+=_0x59d23b(0x102)+formatNumber(_0x17fbe0)+_0x59d23b(0x21e),_0x4c41fb+=_0x59d23b(0x1c2);}_0x5391db[_0x59d23b(0x175)](_0x4c41fb);}function _0x5cb7a6(_0x2ab7dc,_0x10e445){const _0x3fe109=_0x59d23b,_0x1e638a=[];for(let _0x5be6e2=0x0;_0x5be6e2<=_0x2ab7dc[_0x3fe109(0xc4)]-0x1;_0x5be6e2+=_0x10e445){_0x1e638a[_0x3fe109(0x175)](_0x2ab7dc['slice'](_0x5be6e2,_0x5be6e2+_0x10e445));}return _0x1e638a;}const _0x4f4022=_0x5cb7a6(_0x5391db,_0xf646f0);let _0x32d0ef='';return _0x4f4022[_0x59d23b(0x1e2)]((_0x16529e,_0x26f220)=>{const _0x34f3e1=_0x59d23b;_0x26f220>0x0&&(_0x32d0ef+=_0x34f3e1(0x15e));_0x32d0ef+=_0x34f3e1(0x137),_0x32d0ef+=_0x34f3e1(0x1ba),_0x32d0ef+=_0x34f3e1(0xd6),_0x32d0ef+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x32d0ef+=_0x34f3e1(0x1c2),_0x32d0ef+=_0x34f3e1(0xd6),_0x32d0ef+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x42dfbd=0x0;_0x42dfbd<=_0x2315bb['length']-0x1;_0x42dfbd++){const _0x38e022=_0x2315bb[_0x42dfbd];for(let _0x374e15=0x0;_0x374e15<_0x3cf728[_0x34f3e1(0xc4)];_0x374e15++){const _0x13c84f=_0x3cf728[_0x374e15];_0x13c84f['_id']===_0x38e022[_0x34f3e1(0x156)]['category']&&(_0x32d0ef+=_0x34f3e1(0x114)+_0x13c84f[_0x34f3e1(0x202)]+_0x34f3e1(0x12c)+_0x38e022[_0x34f3e1(0x156)][_0x34f3e1(0x1f4)]+'</td>');}}_0x32d0ef+=_0x34f3e1(0xf7),_0x32d0ef+=_0x34f3e1(0x1c2),_0x32d0ef+=_0x34f3e1(0xd6),_0x32d0ef+=_0x34f3e1(0xbb),_0x32d0ef+=_0x34f3e1(0xc3),_0x32d0ef+=_0x34f3e1(0xfd);for(let _0x282af2=0x0;_0x282af2<=_0x2315bb[_0x34f3e1(0xc4)]-0x1;_0x282af2++){const _0x1be31f=_0x2315bb[_0x282af2];for(let _0x5490d9=0x0;_0x5490d9<_0x508d31[_0x34f3e1(0x213)][_0x34f3e1(0xc4)];_0x5490d9++){const _0x44eec0=_0x508d31['cat_brand'][_0x5490d9];_0x44eec0['_id']['category']===_0x1be31f['_id'][_0x34f3e1(0x1f4)]&&(_0x32d0ef+=_0x34f3e1(0x13a)+_0x44eec0[_0x34f3e1(0x156)][_0x34f3e1(0xc7)]+'</td>');}}_0x32d0ef+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x32d0ef+=_0x34f3e1(0xe1),_0x32d0ef+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x32d0ef+=_0x34f3e1(0x130),_0x32d0ef+=_0x34f3e1(0x1c2),_0x32d0ef+='</thead>',_0x32d0ef+='<tbody>',_0x16529e[_0x34f3e1(0x1e2)](_0xd2cadc=>{_0x32d0ef+=_0xd2cadc;}),console[_0x34f3e1(0x12b)](_0x3c5052),_0x32d0ef+=_0x34f3e1(0xb7),_0x32d0ef+=_0x34f3e1(0x16e);}),_0x32d0ef;}async function agentsdataDSICheck_excel(_0x564eae,_0x479573,_0x583f51,_0xdefde7){const _0x527743=a0_0x2c4080,_0x3c75f9=await product[_0x527743(0xcd)]([{'$group':{'_id':{'brand':_0x527743(0x127),'category':_0x527743(0x1b9)},'products':{'$push':{'name':_0x527743(0x184),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3ed8c2=[];_0x3ed8c2[_0x527743(0x213)]=[];for(let _0x4b42e0=0x0;_0x4b42e0<=_0x3c75f9[_0x527743(0xc4)]-0x1;_0x4b42e0++){const _0x1b77fa=_0x3c75f9[_0x4b42e0];_0x3ed8c2[_0x527743(0x213)]['push'](_0x1b77fa);}const _0x4fcbdd=await product[_0x527743(0xcd)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x527743(0x127),'product_code':_0x527743(0x1a3),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x3ea187=await product[_0x527743(0xcd)]([{'$group':{'_id':{'category':'$category','brand':_0x527743(0x127)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4854e5=await sales_sa[_0x527743(0xcd)]([{'$match':{'date':{'$gte':_0x564eae,'$lte':_0x479573},'sales_staff_id':_0x583f51,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x527743(0x1ab)}},{'$lookup':{'from':_0x527743(0xab),'localField':_0x527743(0x1a9),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x527743(0x1f2)},{'$group':{'_id':{'dsi':_0x527743(0x113),'date':_0x527743(0x196),'customer':_0x527743(0x198)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x527743(0x183),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x527743(0xfb),'gross_price':_0x527743(0x21d)}}}}},{'$unwind':_0x527743(0x169)},{'$group':{'_id':{'dsi':_0x527743(0x12d),'date':_0x527743(0x13b),'customer':_0x527743(0x11b),'category':'$products.product_details.category','brand':_0x527743(0x17c)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x527743(0x1d7),_0x527743(0x132)]}},'NetPrice':{'$sum':_0x527743(0x1ce)},'discount':{'$sum':_0x527743(0x155)},'adj_discount':{'$sum':_0x527743(0x1e7)},'product_details':{'$first':_0x527743(0xc5)}}},{'$group':{'_id':{'dsi':_0x527743(0x12d),'date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':_0x527743(0x20b)},'totalGross':{'$sum':_0x527743(0x224)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x527743(0xef)},'adj_discount':{'$sum':_0x527743(0x1e6)},'products':{'$push':{'qty':_0x527743(0x20b),'category':_0x527743(0x14d),'brand':_0x527743(0x1f0),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x360a1c=[],_0x508cfc={},_0x33d29c={},_0x2783fa={};var _0x530540=0x0,_0x3b0e0d=0x0,_0xb03244=0x0,_0x437cf8=0x0,_0xcd3ff4=0x0;const _0x16e49d=0x9184e72a000;for(let _0x260004=0x0;_0x260004<=_0x4854e5[_0x527743(0xc4)]-0x1;_0x260004++){const _0x12470e=_0x4854e5[_0x260004];let _0x25222e=_0x527743(0xd6);_0x25222e+=_0x527743(0x171)+_0x12470e[_0x527743(0x156)][_0x527743(0x138)]+_0x527743(0x1c5),_0x25222e+=_0x527743(0x171)+_0x12470e[_0x527743(0x156)]['date']+_0x527743(0x1c5),_0x25222e+=_0x527743(0x171)+_0x12470e[_0x527743(0x156)][_0x527743(0x22c)]+_0x527743(0x1c5);let _0x55c770={};var _0x1d1ff=0x0;for(let _0x12424a=0x0;_0x12424a<=_0x12470e['products'][_0x527743(0xc4)]-0x1;_0x12424a++){const _0x503df7=_0x12470e['products'][_0x12424a];_0x55c770[_0x503df7[_0x527743(0xc7)]+'-'+_0x503df7[_0x527743(0x1f4)]]=_0x503df7[_0x527743(0x206)];const _0x56f0eb=_0x503df7[_0x527743(0xc7)]+'-'+_0x503df7[_0x527743(0x1f4)];!_0x508cfc[_0x56f0eb]&&(_0x508cfc[_0x56f0eb]=0x0),!Array[_0x527743(0xa5)](_0x2783fa[_0x56f0eb])&&(_0x2783fa[_0x56f0eb]=[]),!Array[_0x527743(0xa5)](_0x2783fa[_0x56f0eb])&&(_0x2783fa[_0x56f0eb]=[]),_0x508cfc[_0x56f0eb]+=_0x503df7['qty'],_0x2783fa[_0x56f0eb][_0x527743(0x175)](_0x503df7[_0x527743(0x206)]),_0x1d1ff++;}console[_0x527743(0x12b)](_0x12470e);for(let _0x30c775=0x0;_0x30c775<=_0x3ed8c2[_0x527743(0x213)][_0x527743(0xc4)]-0x1;_0x30c775++){const _0x59e26b=_0x3ed8c2[_0x527743(0x213)][_0x30c775],_0x1c2e86=_0x59e26b[_0x527743(0x156)][_0x527743(0xc7)]+'-'+_0x59e26b[_0x527743(0x156)]['category'];_0x25222e+=_0x527743(0xac)+(_0x55c770[_0x1c2e86]!==undefined?_0x55c770[_0x1c2e86][_0x527743(0x10a)](0x2):'')+_0x527743(0x1c5);}_0xb03244=_0x12470e['discount']+_0x12470e[_0x527743(0xf4)],_0x25222e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x12470e[_0x527743(0x20c)],0x2)[_0x527743(0x10a)](0x2))+_0x527743(0x1c5),_0x25222e+=_0x527743(0x135)+formatNumber(_0x12470e['totalGross'][_0x527743(0x10a)](0x2))+'</td>',_0x25222e+=_0x527743(0x135)+formatNumber(_0xb03244)+_0x527743(0x1c5),_0x25222e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x12470e[_0x527743(0x15c)][_0x527743(0x10a)](0x2))+_0x527743(0x1c5),_0x25222e+=_0x527743(0x1c2),_0x530540+=parseFloat(_0x12470e['totalQty']['toFixed'](0x2)),_0x3b0e0d+=parseFloat(_0x12470e[_0x527743(0x15c)]['toFixed'](0x2)),_0x437cf8+=_0xb03244,_0xcd3ff4+=parseFloat(_0x12470e[_0x527743(0x230)]['toFixed'](0x2));if(_0x260004==_0x4854e5['length']-0x1){_0x25222e+='<tr>',_0x25222e+=_0x527743(0x1ad),_0x25222e+=_0x527743(0x1c5);for(let _0x59263a=0x0;_0x59263a<=_0x3ed8c2[_0x527743(0x213)][_0x527743(0xc4)]-0x1;_0x59263a++){const _0x435ef3=_0x3ed8c2[_0x527743(0x213)][_0x59263a],_0x325291=_0x435ef3[_0x527743(0x156)][_0x527743(0xc7)]+'-'+_0x435ef3[_0x527743(0x156)]['category'],_0x117a15=_0x2783fa[_0x325291]['reduce']((_0x10d480,_0x9ebfe0)=>_0x10d480+_0x9ebfe0,0x0);_0x25222e+=_0x527743(0x231)+(_0x117a15!==undefined?formatNumber(_0x117a15['toFixed'](0x2)):'')+_0x527743(0x21e),console[_0x527743(0x12b)](_0x2783fa[_0x325291][_0x527743(0x20f)]((_0x43da2b,_0x494172)=>_0x43da2b+_0x494172,0x0));}_0x25222e+=_0x527743(0x102)+formatNumber(_0x530540[_0x527743(0x10a)](0x2))+'</b></td>',_0x25222e+=_0x527743(0x102)+formatNumber(_0xcd3ff4)+_0x527743(0x21e),_0x25222e+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x437cf8)+_0x527743(0x21e),_0x25222e+=_0x527743(0x102)+formatNumber(_0x3b0e0d)+_0x527743(0x21e),_0x25222e+=_0x527743(0x1c2);}_0x360a1c[_0x527743(0x175)](_0x25222e);}function _0x10be03(_0x399ba0,_0x361fda){const _0x32786e=_0x527743,_0x566f27=[];for(let _0x16a02e=0x0;_0x16a02e<=_0x399ba0[_0x32786e(0xc4)]-0x1;_0x16a02e+=_0x361fda){_0x566f27[_0x32786e(0x175)](_0x399ba0[_0x32786e(0x1b6)](_0x16a02e,_0x16a02e+_0x361fda));}return _0x566f27;}const _0x55a113=_0x10be03(_0x360a1c,_0x16e49d);let _0x5e0450='';return _0x55a113[_0x527743(0x1e2)]((_0x260f31,_0x4ee9d0)=>{const _0x362d21=_0x527743;_0x4ee9d0>0x0&&(_0x5e0450+=_0x362d21(0x15e));_0x5e0450+=_0x362d21(0x137),_0x5e0450+=_0x362d21(0x1ba),_0x5e0450+=_0x362d21(0xd6),_0x5e0450+=_0x362d21(0x16d),_0x5e0450+=_0x362d21(0x1c2),_0x5e0450+=_0x362d21(0xd6),_0x5e0450+=_0x362d21(0x1c3);for(let _0x497956=0x0;_0x497956<=_0x4fcbdd[_0x362d21(0xc4)]-0x1;_0x497956++){const _0x50381d=_0x4fcbdd[_0x497956];for(let _0x57f247=0x0;_0x57f247<_0x3ea187['length'];_0x57f247++){const _0x129797=_0x3ea187[_0x57f247];_0x129797[_0x362d21(0x156)]===_0x50381d[_0x362d21(0x156)]['category']&&(_0x5e0450+=_0x362d21(0x114)+_0x129797[_0x362d21(0x202)]+'\x22\x20class=\x22cat_data\x22>'+_0x50381d['_id'][_0x362d21(0x1f4)]+_0x362d21(0x1c5));}}_0x5e0450+=_0x362d21(0xf7),_0x5e0450+=_0x362d21(0x1c2),_0x5e0450+=_0x362d21(0xd6),_0x5e0450+=_0x362d21(0xbb),_0x5e0450+=_0x362d21(0xc3),_0x5e0450+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x1b5a35=0x0;_0x1b5a35<=_0x4fcbdd[_0x362d21(0xc4)]-0x1;_0x1b5a35++){const _0x50f1a6=_0x4fcbdd[_0x1b5a35];for(let _0x4a7e9a=0x0;_0x4a7e9a<_0x3ed8c2[_0x362d21(0x213)][_0x362d21(0xc4)];_0x4a7e9a++){const _0x1eaf33=_0x3ed8c2[_0x362d21(0x213)][_0x4a7e9a];_0x1eaf33[_0x362d21(0x156)][_0x362d21(0x1f4)]===_0x50f1a6[_0x362d21(0x156)][_0x362d21(0x1f4)]&&(_0x5e0450+=_0x362d21(0x13a)+_0x1eaf33[_0x362d21(0x156)][_0x362d21(0xc7)]+'</td>');}}_0x5e0450+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x5e0450+=_0x362d21(0xe1),_0x5e0450+=_0x362d21(0xdc),_0x5e0450+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x5e0450+=_0x362d21(0x1c2),_0x5e0450+=_0x362d21(0xb9),_0x5e0450+=_0x362d21(0x13e),_0x260f31['forEach'](_0x80880=>{_0x5e0450+=_0x80880;}),console[_0x362d21(0x12b)](_0x2783fa),_0x5e0450+=_0x362d21(0xb7),_0x5e0450+=_0x362d21(0x16e);}),_0x5e0450;}router[a0_0x2c4080(0xd4)](a0_0x2c4080(0xd2),auth,async(_0x3ba09f,_0x305266)=>{const _0x3e26ea=a0_0x2c4080,{from_date:_0x332d1d,to_date:_0x19d28d,isExcel:_0x179d7b}=_0x3ba09f[_0x3e26ea(0x1a1)],_0x22b3d7=_0x3ba09f[_0x3e26ea(0xe4)],_0x3e17c9=await staff['findOne']({'email':_0x22b3d7['email']}),_0x23c50b=await master_shop[_0x3e26ea(0x131)]();console['log'](_0x23c50b[0x0][_0x3e26ea(0x1d4)]);const _0x555a58=await agentsdataDSICheck(_0x332d1d,_0x19d28d,_0x3e17c9[_0x3e26ea(0x156)][_0x3e26ea(0x211)](),_0x179d7b),_0x220fb6=await agentsdataDSICheck_excel(_0x332d1d,_0x19d28d,_0x3e17c9['_id'][_0x3e26ea(0x211)](),_0x179d7b);let _0x322311=_0x3e26ea(0x9e);var _0x2a7182=new Date(_0x332d1d),_0x36ada6=new Date(_0x19d28d);const _0xcf68c5={'year':_0x3e26ea(0x1ca),'month':_0x3e26ea(0x19e),'day':_0x3e26ea(0x1ca)},_0x159035=new Intl[(_0x3e26ea(0xc6))](_0x3e26ea(0x218),_0xcf68c5)['format'](_0x2a7182),_0xddcdb3=new Intl[(_0x3e26ea(0xc6))](_0x3e26ea(0x218),_0xcf68c5)[_0x3e26ea(0xea)](_0x36ada6);_0x322311+=_0x3e26ea(0xb8),_0x322311+=_0x3e26ea(0xd0),_0x322311+=_0x3e26ea(0x137),_0x322311+=_0x555a58,_0x322311+=_0x3e26ea(0x16e),_0x322311+='</div>',_0x322311+='</div>';let _0x1e7513=_0x3e26ea(0x9e);_0x1e7513+=_0x3e26ea(0xb8),_0x1e7513+='<div\x20\x20id=\x22table-conatainer\x22>',_0x1e7513+=_0x3e26ea(0x137),_0x1e7513+=_0x220fb6,_0x1e7513+=_0x3e26ea(0x16e),_0x1e7513+=_0x3e26ea(0x1a7),_0x1e7513+=_0x3e26ea(0x1a7);let _0x5cb535=_0x3e26ea(0x204);const _0x4ba249={'width':_0x3e26ea(0x11e),'height':'8.5in','orientation':'landscape','border':{'top':'0.1in','right':'0.1in','bottom':_0x3e26ea(0x1aa),'left':_0x3e26ea(0x1aa)},'header':{'height':'60mm','contents':_0x3e26ea(0x181)+_0x5cb535+_0x3e26ea(0x1c8)+_0x159035+_0x3e26ea(0xd8)+_0xddcdb3+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x3e26ea(0x17b),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x179d7b=='on'){const _0xa3468=cheerio[_0x3e26ea(0xaf)](_0x1e7513);let _0x2da5d5=[],_0x3fc03d=[],_0x39052a=[];const _0x5ca8ec=_0x1c65f9=>{const _0x54e8e9=_0x3e26ea,_0x58567b={'top':{'style':_0x54e8e9(0x1e1),'color':{'rgb':_0x54e8e9(0x17e)}},'bottom':{'style':'thick','color':{'rgb':_0x54e8e9(0x17e)}},'left':{'style':_0x54e8e9(0x1e1),'color':{'rgb':'000000'}},'right':{'style':_0x54e8e9(0x1e1),'color':{'rgb':_0x54e8e9(0x17e)}}};if(_0x1c65f9){const _0x4e3e6b=_0x1c65f9[_0x54e8e9(0x145)](';')[_0x54e8e9(0x20f)]((_0x47da6a,_0x11dbbc)=>{const _0x2655a0=_0x54e8e9,[_0x5425a9,_0x227f75]=_0x11dbbc[_0x2655a0(0x145)](':')['map'](_0x2638ae=>_0x2638ae[_0x2655a0(0xff)]());return _0x47da6a[_0x5425a9]=_0x227f75,_0x47da6a;},{});_0x4e3e6b[_0x54e8e9(0x19b)]&&(_0x58567b['top']['style']=_0x4e3e6b[_0x54e8e9(0x19b)][_0x54e8e9(0x214)](_0x54e8e9(0x1ed))?_0x54e8e9(0x1ed):_0x54e8e9(0x1e3)),_0x4e3e6b[_0x54e8e9(0x1f6)]&&(_0x58567b[_0x54e8e9(0x212)][_0x54e8e9(0x18e)]=_0x4e3e6b[_0x54e8e9(0x1f6)][_0x54e8e9(0x214)](_0x54e8e9(0x1ed))?_0x54e8e9(0x1ed):_0x54e8e9(0x1e3)),_0x4e3e6b['border-left']&&(_0x58567b['left'][_0x54e8e9(0x18e)]=_0x4e3e6b[_0x54e8e9(0x1d0)][_0x54e8e9(0x214)](_0x54e8e9(0x1ed))?_0x54e8e9(0x1ed):_0x54e8e9(0x1e3)),_0x4e3e6b[_0x54e8e9(0x15d)]&&(_0x58567b[_0x54e8e9(0xd3)][_0x54e8e9(0x18e)]=_0x4e3e6b[_0x54e8e9(0x15d)][_0x54e8e9(0x214)](_0x54e8e9(0x1ed))?_0x54e8e9(0x1ed):_0x54e8e9(0x1e3));}return _0x58567b;};_0xa3468(_0x3e26ea(0x20d))[_0x3e26ea(0x11a)]((_0x3b678a,_0xaa3584)=>{const _0x51ab29=_0x3e26ea;let _0x162354=[],_0x4b0ab8=0x0;while(_0x39052a[_0x4b0ab8]){_0x39052a[_0x4b0ab8]--,_0x4b0ab8++;}_0xa3468(_0xaa3584)['find']('td,\x20th')[_0x51ab29(0x11a)]((_0x4b167a,_0x18d81b)=>{const _0x1d3ddf=_0x51ab29;let _0x4b94e9=_0xa3468(_0x18d81b)[_0x1d3ddf(0x14a)]()[_0x1d3ddf(0xff)](),_0x24b801=parseFloat(_0x4b94e9[_0x1d3ddf(0x215)](/,/g,'')),_0x4e3067={};!isNaN(_0x24b801)?(_0x4e3067['v']=_0x24b801,_0x4e3067['t']='n'):(_0x4e3067['v']=_0x4b94e9,_0x4e3067['t']='s');const _0x27f7f0=_0xa3468(_0x18d81b)[_0x1d3ddf(0x11d)](_0x1d3ddf(0x18e)),_0x28014e=_0x5ca8ec(_0x27f7f0);_0x4e3067['s']={'border':_0x28014e},_0x162354[_0x4b0ab8]=_0x4e3067;let _0x3138b8=parseInt(_0xa3468(_0x18d81b)[_0x1d3ddf(0x11d)](_0x1d3ddf(0xbc)))||0x1,_0x126384=parseInt(_0xa3468(_0x18d81b)['attr'](_0x1d3ddf(0x1a4)))||0x1;(_0x3138b8>0x1||_0x126384>0x1)&&_0x3fc03d['push']({'s':{'r':_0x3b678a,'c':_0x4b0ab8},'e':{'r':_0x3b678a+_0x126384-0x1,'c':_0x4b0ab8+_0x3138b8-0x1}});for(let _0x4d3d18=0x0;_0x4d3d18<_0x3138b8;_0x4d3d18++){_0x126384>0x1&&(_0x39052a[_0x4b0ab8+_0x4d3d18]=_0x126384-0x1);}_0x4b0ab8+=_0x3138b8;}),_0x2da5d5['push'](_0x162354);});const _0x1ca0d0=XLSX['utils'][_0x3e26ea(0xc0)](),_0x4724a5=XLSX['utils'][_0x3e26ea(0x1ea)](_0x2da5d5);_0x3fc03d[_0x3e26ea(0xc4)]>0x0&&(_0x4724a5[_0x3e26ea(0x10d)]=_0x3fc03d);_0x4724a5[_0x3e26ea(0x22a)]=_0x2da5d5[0x0][_0x3e26ea(0xe2)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x1ca0d0,_0x4724a5,_0x3e26ea(0x21b));const _0x508a0a=XLSX[_0x3e26ea(0x1d3)](_0x1ca0d0,{'bookType':'xlsx','type':_0x3e26ea(0x1be)});_0x305266['setHeader'](_0x3e26ea(0xfc),_0x3e26ea(0x19f)),_0x305266[_0x3e26ea(0x229)](_0x3e26ea(0xae),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x305266[_0x3e26ea(0x12a)](_0x508a0a);}else pdf[_0x3e26ea(0x158)](_0x322311,_0x4ba249)['toStream'](function(_0x31840c,_0x53083e){const _0x16a538=_0x3e26ea;if(_0x31840c){console['error']('PDF\x20Generation\x20Error:',_0x31840c),_0x305266[_0x16a538(0x1ee)](0x1f4)['send']('Error\x20generating\x20PDF'+_0x31840c);return;}_0x305266[_0x16a538(0x229)](_0x16a538(0xae),_0x16a538(0xa2)),_0x53083e[_0x16a538(0x1f9)](_0x305266);});}),router[a0_0x2c4080(0x225)]('/total_sales_reports/view',auth,async(_0x53e46a,_0x1fe543)=>{const _0x15b14b=a0_0x2c4080;try{const {username:_0x3f6f71,email:_0x29c461,role:_0xa042ea}=_0x53e46a[_0x15b14b(0xe4)],_0x2871c1=_0x53e46a[_0x15b14b(0xe4)],_0x5b9d10=await profile[_0x15b14b(0x13d)]({'email':_0x2871c1[_0x15b14b(0x1c6)]}),_0xc045={'year':'numeric','month':'long','day':_0x15b14b(0x1ca)},_0x52fe58=await master_shop[_0x15b14b(0x131)](),_0x3535db=await product[_0x15b14b(0x131)](),_0x1cd52c=await warehouse['aggregate']([{'$unwind':_0x15b14b(0x177)},{'$lookup':{'from':'products','localField':_0x15b14b(0x1bd),'foreignField':_0x15b14b(0xd1),'as':_0x15b14b(0x159)}},{'$unwind':_0x15b14b(0x22d)},{'$project':{'product_name':_0x15b14b(0x147),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x15b14b(0xde),'product_stock':{'$sum':_0x15b14b(0x1d9)}}}]),_0x384f3d=await staff[_0x15b14b(0x13d)]({'email':_0x2871c1[_0x15b14b(0x1c6)]});if(_0x52fe58[0x0]['language']=='English\x20(US)')var _0x768d70=users[_0x15b14b(0x1a6)];else{if(_0x52fe58[0x0]['language']==_0x15b14b(0x1d5))var _0x768d70=users[_0x15b14b(0x1d5)];else{if(_0x52fe58[0x0][_0x15b14b(0x1e9)]=='German')var _0x768d70=users['German'];else{if(_0x52fe58[0x0][_0x15b14b(0x1e9)]=='Spanish')var _0x768d70=users[_0x15b14b(0xa1)];else{if(_0x52fe58[0x0]['language']==_0x15b14b(0xd5))var _0x768d70=users[_0x15b14b(0xd5)];else{if(_0x52fe58[0x0][_0x15b14b(0x1e9)]==_0x15b14b(0x209))var _0x768d70=users[_0x15b14b(0x18d)];else{if(_0x52fe58[0x0]['language']=='Chinese')var _0x768d70=users[_0x15b14b(0x185)];else{if(_0x52fe58[0x0]['language']==_0x15b14b(0x10f))var _0x768d70=users['Arabic'];}}}}}}}_0x1fe543['render'](_0x15b14b(0x21f),{'success':_0x53e46a[_0x15b14b(0x160)]('success'),'errors':_0x53e46a['flash'](_0x15b14b(0x220)),'alldata':_0x3535db,'profile':_0x5b9d10,'master_shop':_0x52fe58,'role':_0x2871c1,'product_stock':_0x1cd52c,'language':_0x768d70,'staff_arr':_0x384f3d});}catch(_0xc253df){}});async function dataSalesReports(_0x597a22,_0x3bc963,_0xaec3d6){const _0x518293=a0_0x2c4080;let _0x3a19a4='';const _0x5e0d5d=await sales_sa[_0x518293(0xcd)]([{'$match':{'date':{'$gte':_0x597a22,'$lte':_0x3bc963},'sales_staff_id':_0xaec3d6}},{'$unwind':_0x518293(0x18f)},{'$match':{'sale_product.isFG':'false'}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x518293(0xb1)},'sumqty':{'$sum':_0x518293(0x1db)},'totalPrice':{'$sum':_0x518293(0x192)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x72e71d=0x0,_0x5dd688=0x0;for(let _0x105165=0x0;_0x105165<=_0x5e0d5d[_0x518293(0xc4)]-0x1;_0x105165++){const _0xfce7f4=_0x5e0d5d[_0x105165];var _0x4d3a14=_0xfce7f4['totalPrice'][_0x518293(0x188)](undefined),_0x4d324f=_0xfce7f4['sumqty']['toLocaleString'](undefined);_0x3a19a4+=_0x518293(0xd6),_0x3a19a4+=_0x518293(0x187)+_0xfce7f4['_id'][_0x518293(0xba)]+_0x518293(0x1c5),_0x3a19a4+=_0x518293(0x187)+_0xfce7f4[_0x518293(0x156)][_0x518293(0x115)]+_0x518293(0x1c5),_0x3a19a4+=_0x518293(0x187)+formatNumber(_0xfce7f4[_0x518293(0x166)][_0x518293(0x10a)](0x2))+_0x518293(0x1c5),_0x3a19a4+=_0x518293(0x187)+formatNumber(_0xfce7f4[_0x518293(0x19c)][_0x518293(0x10a)](0x2))+'</td>',_0x3a19a4+=_0x518293(0x1c2),_0x72e71d+=parseFloat(_0xfce7f4[_0x518293(0x166)]),_0x5dd688+=parseFloat(_0xfce7f4[_0x518293(0x19c)]);}var _0x3a9448=_0x5dd688[_0x518293(0x188)](undefined),_0x4a5dda=_0x72e71d[_0x518293(0x188)](undefined);return _0x3a19a4+='<tr>',_0x3a19a4+=_0x518293(0x109),_0x3a19a4+=_0x518293(0x1c4)+formatNumber(_0x72e71d[_0x518293(0x10a)](0x2))+_0x518293(0x21e),_0x3a19a4+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x5dd688[_0x518293(0x10a)](0x2))+_0x518293(0x21e),_0x3a19a4+='</tr>',_0x3a19a4;}router[a0_0x2c4080(0xd4)](a0_0x2c4080(0x1b1),auth,async(_0xb86b19,_0x59e042)=>{const _0x526752=a0_0x2c4080;try{const {from_date:_0x3593c7,to_date:_0x1d3425,isExcel:_0x2886cb}=_0xb86b19[_0x526752(0x1a1)],_0x5567fc=_0xb86b19[_0x526752(0xe4)],_0x3eebbe=await staff['findOne']({'email':_0x5567fc['email']});let _0x955e1=_0x526752(0x1af);var _0x5c2090=new Date(_0x3593c7),_0x54c02d=new Date(_0x1d3425);const _0x5cb80d={'year':_0x526752(0x1ca),'month':_0x526752(0x19e),'day':_0x526752(0x1ca)},_0x3e756d=new Intl['DateTimeFormat']('en-US',_0x5cb80d)['format'](_0x5c2090),_0x10b381=new Intl['DateTimeFormat']('en-US',_0x5cb80d)['format'](_0x54c02d);var _0xc21e15=await dataSalesReports(_0x3593c7,_0x1d3425,_0x3eebbe[_0x526752(0x156)][_0x526752(0x211)]());_0x955e1+='<div\x20class=\x22row\x22>',_0x955e1+='<div\x20class=\x22col-sm-11\x22>',_0x955e1+=_0x526752(0x137),_0x955e1+=_0x526752(0xd6),_0x955e1+=_0x526752(0x18b),_0x955e1+=_0x526752(0x14f),_0x955e1+=_0x526752(0x15f),_0x955e1+=_0x526752(0x182),_0x955e1+=_0x526752(0xd6),_0x955e1+=_0xc21e15,_0x955e1+='</tr>',_0x955e1+=_0x526752(0x1a7),_0x955e1+='</div>';let _0x494514='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x267ba9={'width':_0x526752(0x11e),'height':'8.5in','orientation':_0x526752(0x1cf),'border':{'top':'0.1in','right':'0.1in','bottom':_0x526752(0x1aa),'left':_0x526752(0x1aa)},'header':{'height':'60mm','contents':_0x526752(0x181)+_0x494514+_0x526752(0x1e4)+_0x3eebbe[_0x526752(0xd1)]+_0x526752(0x174)+_0x3e756d+_0x526752(0xd8)+_0x10b381+_0x526752(0xeb)},'footer':{'height':_0x526752(0x17b),'contents':{'default':_0x526752(0x17f)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x526752(0x200)}}};if(_0x2886cb=='on'){const _0x21b9ce=cheerio[_0x526752(0xaf)](_0x955e1);let _0x34b14d=[],_0x2fdb98=[],_0x570d69=[];const _0x12981e=_0x226998=>{const _0x1b79bd=_0x526752,_0x1fbf25={'top':{'style':_0x1b79bd(0x1e1),'color':{'rgb':_0x1b79bd(0x17e)}},'bottom':{'style':_0x1b79bd(0x1e1),'color':{'rgb':_0x1b79bd(0x17e)}},'left':{'style':_0x1b79bd(0x1e1),'color':{'rgb':_0x1b79bd(0x17e)}},'right':{'style':_0x1b79bd(0x1e1),'color':{'rgb':_0x1b79bd(0x17e)}}};if(_0x226998){const _0x2385f0=_0x226998[_0x1b79bd(0x145)](';')[_0x1b79bd(0x20f)]((_0x48873f,_0x2ce42a)=>{const _0x5eadfe=_0x1b79bd,[_0x2dc945,_0x3f984a]=_0x2ce42a[_0x5eadfe(0x145)](':')[_0x5eadfe(0xe2)](_0x357d7b=>_0x357d7b['trim']());return _0x48873f[_0x2dc945]=_0x3f984a,_0x48873f;},{});_0x2385f0[_0x1b79bd(0x19b)]&&(_0x1fbf25[_0x1b79bd(0xca)][_0x1b79bd(0x18e)]=_0x2385f0[_0x1b79bd(0x19b)][_0x1b79bd(0x214)]('thin')?'thin':'medium'),_0x2385f0['border-bottom']&&(_0x1fbf25[_0x1b79bd(0x212)][_0x1b79bd(0x18e)]=_0x2385f0['border-bottom'][_0x1b79bd(0x214)](_0x1b79bd(0x1ed))?'thin':'medium'),_0x2385f0[_0x1b79bd(0x1d0)]&&(_0x1fbf25[_0x1b79bd(0x17d)][_0x1b79bd(0x18e)]=_0x2385f0['border-left'][_0x1b79bd(0x214)](_0x1b79bd(0x1ed))?'thin':_0x1b79bd(0x1e3)),_0x2385f0[_0x1b79bd(0x15d)]&&(_0x1fbf25[_0x1b79bd(0xd3)][_0x1b79bd(0x18e)]=_0x2385f0[_0x1b79bd(0x15d)][_0x1b79bd(0x214)](_0x1b79bd(0x1ed))?_0x1b79bd(0x1ed):_0x1b79bd(0x1e3));}return _0x1fbf25;};_0x21b9ce(_0x526752(0x20d))[_0x526752(0x11a)]((_0x4d14be,_0x4dfe2d)=>{const _0x560daa=_0x526752;let _0x56f82c=[],_0x2d3ad3=0x0;while(_0x570d69[_0x2d3ad3]){_0x570d69[_0x2d3ad3]--,_0x2d3ad3++;}_0x21b9ce(_0x4dfe2d)[_0x560daa(0x131)](_0x560daa(0xa8))[_0x560daa(0x11a)]((_0x218b1e,_0x4ef98e)=>{const _0xac5afe=_0x560daa;let _0x232e1d=_0x21b9ce(_0x4ef98e)[_0xac5afe(0x14a)]()['trim'](),_0x5e5646=parseFloat(_0x232e1d[_0xac5afe(0x215)](/,/g,'')),_0xb7006b={};!isNaN(_0x5e5646)?(_0xb7006b['v']=_0x5e5646,_0xb7006b['t']='n'):(_0xb7006b['v']=_0x232e1d,_0xb7006b['t']='s');const _0x305638=_0x21b9ce(_0x4ef98e)[_0xac5afe(0x11d)]('style'),_0x40c8d9=_0x12981e(_0x305638);_0xb7006b['s']={'border':_0x40c8d9},_0x56f82c[_0x2d3ad3]=_0xb7006b;let _0x3e9312=parseInt(_0x21b9ce(_0x4ef98e)['attr']('colspan'))||0x1,_0xe2081=parseInt(_0x21b9ce(_0x4ef98e)[_0xac5afe(0x11d)](_0xac5afe(0x1a4)))||0x1;(_0x3e9312>0x1||_0xe2081>0x1)&&_0x2fdb98[_0xac5afe(0x175)]({'s':{'r':_0x4d14be,'c':_0x2d3ad3},'e':{'r':_0x4d14be+_0xe2081-0x1,'c':_0x2d3ad3+_0x3e9312-0x1}});for(let _0x4e0002=0x0;_0x4e0002<_0x3e9312;_0x4e0002++){_0xe2081>0x1&&(_0x570d69[_0x2d3ad3+_0x4e0002]=_0xe2081-0x1);}_0x2d3ad3+=_0x3e9312;}),_0x34b14d[_0x560daa(0x175)](_0x56f82c);});const _0x2d99d2=XLSX[_0x526752(0x1f3)][_0x526752(0xc0)](),_0x3a6224=XLSX['utils']['aoa_to_sheet'](_0x34b14d);_0x2fdb98[_0x526752(0xc4)]>0x0&&(_0x3a6224[_0x526752(0x10d)]=_0x2fdb98);_0x3a6224[_0x526752(0x22a)]=_0x34b14d[0x0][_0x526752(0xe2)](()=>({'wpx':0x64})),XLSX[_0x526752(0x1f3)][_0x526752(0x162)](_0x2d99d2,_0x3a6224,_0x526752(0x21b));const _0x3d927c=XLSX[_0x526752(0x1d3)](_0x2d99d2,{'bookType':_0x526752(0xe7),'type':_0x526752(0x1be)});_0x59e042[_0x526752(0x229)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x59e042['setHeader'](_0x526752(0xae),_0x526752(0xcc)),_0x59e042[_0x526752(0x12a)](_0x3d927c);}else pdf['create'](_0x955e1,_0x267ba9)[_0x526752(0x1f1)](function(_0x39e1fe,_0x2b5cdd){const _0x5bcdfd=_0x526752;if(_0x39e1fe){_0x59e042[_0x5bcdfd(0x1ee)](0x1f4)[_0x5bcdfd(0x12a)](_0x5bcdfd(0xc9));return;}_0x59e042[_0x5bcdfd(0x229)]('Content-Type',_0x5bcdfd(0xa2)),_0x2b5cdd[_0x5bcdfd(0x1f9)](_0x59e042);});}catch(_0x39238d){}}),router[a0_0x2c4080(0x225)](a0_0x2c4080(0x133),auth,async(_0x5b6b10,_0x527218)=>{const _0x322d97=a0_0x2c4080;try{const {username:_0x5b51a5,email:_0x2c376d,role:_0x11afe2}=_0x5b6b10[_0x322d97(0xe4)],_0x2f772e=_0x5b6b10[_0x322d97(0xe4)],_0x328c5d=await profile['findOne']({'email':_0x2f772e[_0x322d97(0x1c6)]}),_0x53c4e3={'year':_0x322d97(0x1ca),'month':_0x322d97(0x19e),'day':_0x322d97(0x1ca)},_0x1bd79c=await master_shop[_0x322d97(0x131)](),_0x25e503=await product[_0x322d97(0x131)](),_0x3e3dc4=await warehouse[_0x322d97(0xcd)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x322d97(0xab),'localField':_0x322d97(0x1bd),'foreignField':_0x322d97(0xd1),'as':_0x322d97(0x159)}},{'$unwind':_0x322d97(0x22d)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x322d97(0x157)}},{'$group':{'_id':_0x322d97(0xde),'product_stock':{'$sum':_0x322d97(0x1d9)}}}]);if(_0x1bd79c[0x0][_0x322d97(0x1e9)]==_0x322d97(0x210))var _0x214b7b=users[_0x322d97(0x1a6)];else{if(_0x1bd79c[0x0][_0x322d97(0x1e9)]==_0x322d97(0x1d5))var _0x214b7b=users['Hindi'];else{if(_0x1bd79c[0x0][_0x322d97(0x1e9)]==_0x322d97(0x216))var _0x214b7b=users[_0x322d97(0x216)];else{if(_0x1bd79c[0x0][_0x322d97(0x1e9)]==_0x322d97(0xa1))var _0x214b7b=users['Spanish'];else{if(_0x1bd79c[0x0][_0x322d97(0x1e9)]==_0x322d97(0xd5))var _0x214b7b=users[_0x322d97(0xd5)];else{if(_0x1bd79c[0x0][_0x322d97(0x1e9)]=='Portuguese\x20(BR)')var _0x214b7b=users[_0x322d97(0x18d)];else{if(_0x1bd79c[0x0][_0x322d97(0x1e9)]==_0x322d97(0x185))var _0x214b7b=users[_0x322d97(0x185)];else{if(_0x1bd79c[0x0][_0x322d97(0x1e9)]==_0x322d97(0x10f))var _0x214b7b=users[_0x322d97(0x1f5)];}}}}}}}_0x527218[_0x322d97(0x1fa)](_0x322d97(0x226),{'success':_0x5b6b10['flash'](_0x322d97(0x219)),'errors':_0x5b6b10['flash'](_0x322d97(0x220)),'alldata':_0x25e503,'profile':_0x328c5d,'master_shop':_0x1bd79c,'role':_0x2f772e,'product_stock':_0x3e3dc4,'language':_0x214b7b});}catch(_0x180d36){}});async function dataInventoryReports(_0xec55be,_0x36e609,_0x5cd6c6){const _0x1267fb=a0_0x2c4080,_0x563d09=await sales_sa[_0x1267fb(0xcd)]([{'$match':{'date':{'$gte':_0xec55be,'$lte':_0x36e609},'sales_staff_id':_0x5cd6c6}},{'$unwind':_0x1267fb(0x18f)},{'$group':{'_id':{'product_name':_0x1267fb(0x152),'product_code':_0x1267fb(0xb1)},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x4d96e7=mongoose['Types']['ObjectId'],_0x2dfbb6=await staff[_0x1267fb(0xcd)]([{'$match':{'_id':_0x4d96e7(_0x5cd6c6)}},{'$unwind':_0x1267fb(0xcb)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x1267fb(0xed),'product_code':_0x1267fb(0x205)},'sumqty':{'$sum':'$product_list.product_stock'}}},{'$sort':{'_id.product_name':0x1}}]),_0x22945c=await sales_inv_data[_0x1267fb(0xcd)]([{'$match':{'date':{'$gte':_0xec55be,'$lte':_0x36e609},'sales_staff_id':_0x5cd6c6}},{'$unwind':_0x1267fb(0x18f)},{'$group':{'_id':{'product_name':_0x1267fb(0x152),'product_code':'$sale_product.product_code'},'totalQTYsum':{'$sum':_0x1267fb(0x1a2)}}}]);console['log'](_0x22945c);let _0x5c78c6='';var _0x4e9e21=0x0;for(let _0x3b2c22=0x0;_0x3b2c22<=_0x2dfbb6[_0x1267fb(0xc4)]-0x1;_0x3b2c22++){const _0xbc3e94=_0x2dfbb6[_0x3b2c22];_0x5c78c6+='<tr>',_0x5c78c6+=_0x1267fb(0x1cd)+_0xbc3e94[_0x1267fb(0x156)][_0x1267fb(0xba)]+_0x1267fb(0x1c5),_0x5c78c6+=_0x1267fb(0xfa)+_0xbc3e94[_0x1267fb(0x156)][_0x1267fb(0x115)]+_0x1267fb(0x1c5);var _0x19bde8=_0xbc3e94[_0x1267fb(0x166)],_0x54d8f1=0x0;for(let _0x13ff6a=0x0;_0x13ff6a<=_0x563d09[_0x1267fb(0xc4)]-0x1;_0x13ff6a++){const _0xe61664=_0x563d09[_0x13ff6a];_0xbc3e94[_0x1267fb(0x156)][_0x1267fb(0xba)]==_0xe61664[_0x1267fb(0x156)]['product_code']&&_0xbc3e94[_0x1267fb(0x156)][_0x1267fb(0x115)]==_0xe61664[_0x1267fb(0x156)][_0x1267fb(0x115)]&&(_0x54d8f1=_0xe61664[_0x1267fb(0x166)]);}var _0x214ed9=0x0;for(let _0x196766=0x0;_0x196766<=_0x22945c['length']-0x1;_0x196766++){const _0x8188b5=_0x22945c[_0x196766];_0xbc3e94[_0x1267fb(0x156)][_0x1267fb(0xba)]==_0x8188b5[_0x1267fb(0x156)][_0x1267fb(0xba)]&&_0xbc3e94['_id']['product_name']==_0x8188b5[_0x1267fb(0x156)]['product_name']&&(_0x214ed9=_0x8188b5[_0x1267fb(0x154)]);}_0x4e9e21=_0x19bde8-_0x214ed9+_0x54d8f1,_0x5c78c6+=_0x1267fb(0x187)+_0x4e9e21+_0x1267fb(0x1c5);let _0x3f7d03=![];for(let _0xe3bb48=0x0;_0xe3bb48<=_0x22945c[_0x1267fb(0xc4)]-0x1;_0xe3bb48++){const _0x5651ca=_0x22945c[_0xe3bb48];if(_0xbc3e94[_0x1267fb(0x156)]['product_code']==_0x5651ca[_0x1267fb(0x156)][_0x1267fb(0xba)]&&_0xbc3e94[_0x1267fb(0x156)][_0x1267fb(0x115)]==_0x5651ca[_0x1267fb(0x156)]['product_name']){_0x5c78c6+=_0x1267fb(0x187)+_0x5651ca[_0x1267fb(0x154)]+_0x1267fb(0x1c5),_0x3f7d03=!![];break;}}!_0x3f7d03&&(_0x5c78c6+=_0x1267fb(0x11f));let _0x59fbe5=![];for(let _0x322d90=0x0;_0x322d90<=_0x563d09[_0x1267fb(0xc4)]-0x1;_0x322d90++){const _0x130f1c=_0x563d09[_0x322d90];if(_0xbc3e94[_0x1267fb(0x156)][_0x1267fb(0xba)]==_0x130f1c[_0x1267fb(0x156)][_0x1267fb(0xba)]&&_0xbc3e94[_0x1267fb(0x156)][_0x1267fb(0x115)]==_0x130f1c[_0x1267fb(0x156)][_0x1267fb(0x115)]){_0x5c78c6+=_0x1267fb(0x187)+_0x130f1c[_0x1267fb(0x166)]+'</td>',_0x59fbe5=!![];break;}}!_0x59fbe5&&(_0x5c78c6+=_0x1267fb(0x11f)),_0x5c78c6+='<td\x20class=\x22row_data\x22>'+_0xbc3e94[_0x1267fb(0x166)]+_0x1267fb(0x1c5),_0x5c78c6+=_0x1267fb(0x1c2);}return _0x5c78c6;}router['post'](a0_0x2c4080(0x1d6),auth,async(_0x465c0c,_0x35ea28)=>{const _0x9a0c6c=a0_0x2c4080;try{const {from_date:_0x3d1c32,to_date:_0x79ba98}=_0x465c0c[_0x9a0c6c(0x1a1)],_0xd93643=_0x465c0c[_0x9a0c6c(0xe4)],_0x195487=await staff[_0x9a0c6c(0x13d)]({'email':_0xd93643[_0x9a0c6c(0x1c6)]});let _0x229d79='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x51c49b=new Date(_0x3d1c32),_0x32936e=new Date(_0x79ba98);const _0x105df7={'year':_0x9a0c6c(0x1ca),'month':'long','day':_0x9a0c6c(0x1ca)},_0x26f386=new Intl[(_0x9a0c6c(0xc6))]('en-US',_0x105df7)['format'](_0x51c49b),_0x2f8199=new Intl[(_0x9a0c6c(0xc6))](_0x9a0c6c(0x218),_0x105df7)[_0x9a0c6c(0xea)](_0x32936e);var _0x52254d=await dataInventoryReports(_0x3d1c32,_0x79ba98,_0x195487[_0x9a0c6c(0x156)]['valueOf']());_0x229d79+=_0x9a0c6c(0x223),_0x229d79+='<p>INVENTORY\x20SUMMARY</p>',_0x229d79+='<p>'+_0x26f386+'\x20-\x20'+_0x2f8199+_0x9a0c6c(0x1b2),_0x229d79+=_0x9a0c6c(0xb8),_0x229d79+=_0x9a0c6c(0x1fe),_0x229d79+=_0x9a0c6c(0x137),_0x229d79+=_0x9a0c6c(0xd6),_0x229d79+=_0x9a0c6c(0x18b),_0x229d79+=_0x9a0c6c(0x14f),_0x229d79+=_0x9a0c6c(0x14c),_0x229d79+='<th>\x20INCOMING\x20</th>',_0x229d79+=_0x9a0c6c(0x106),_0x229d79+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x229d79+=_0x9a0c6c(0xd6),_0x229d79+=_0x52254d,_0x229d79+=_0x9a0c6c(0x1c2),_0x229d79+=_0x9a0c6c(0x1a7),_0x229d79+=_0x9a0c6c(0x1a7);const _0x485e55={'format':'Letter','orientation':_0x9a0c6c(0x1cf),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x9a0c6c(0x200)}}};pdf[_0x9a0c6c(0x158)](_0x229d79,_0x485e55)[_0x9a0c6c(0x1f1)](function(_0x163878,_0x4d2f07){const _0xe903d9=_0x9a0c6c;if(_0x163878){_0x35ea28[_0xe903d9(0x1ee)](0x1f4)['send'](_0xe903d9(0xc9));return;}_0x35ea28['setHeader'](_0xe903d9(0xae),_0xe903d9(0xa2)),_0x4d2f07[_0xe903d9(0x1f9)](_0x35ea28);});}catch(_0x48cf88){}}),router[a0_0x2c4080(0x225)](a0_0x2c4080(0xdd),auth,async(_0x53b9fc,_0x173252)=>{const _0x203801=a0_0x2c4080;try{const {username:_0x238167,email:_0xc34945,role:_0x5761f8}=_0x53b9fc['user'],_0x1d03d0=_0x53b9fc['user'],_0x121afb=await profile['findOne']({'email':_0x1d03d0[_0x203801(0x1c6)]}),_0x4d4bdc={'year':_0x203801(0x1ca),'month':_0x203801(0x19e),'day':'numeric'},_0x51f71b=await master_shop[_0x203801(0x131)]();console[_0x203801(0x12b)]('Products\x20master',_0x51f71b);const _0x15e3e7=await product['find']();console[_0x203801(0x12b)](_0x203801(0x129),_0x15e3e7);const _0x360c49=await warehouse[_0x203801(0xcd)]([{'$unwind':_0x203801(0x177)},{'$lookup':{'from':_0x203801(0xab),'localField':_0x203801(0x1bd),'foreignField':_0x203801(0xd1),'as':_0x203801(0x159)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x203801(0x147),'product_stock':_0x203801(0x157)}},{'$group':{'_id':_0x203801(0xde),'product_stock':{'$sum':_0x203801(0x1d9)}}}]);console[_0x203801(0x12b)](_0x203801(0x161),_0x360c49),_0x360c49[_0x203801(0x1e2)](_0x3225f9=>{const _0x5b12e5=_0x203801,_0x179ad6=_0x15e3e7[_0x5b12e5(0xe2)](_0x2521e8=>{const _0x82bbc9=_0x5b12e5;_0x2521e8['name']==_0x3225f9[_0x82bbc9(0x156)]&&(_0x2521e8['stock']=parseInt(_0x2521e8[_0x82bbc9(0x1ac)])+parseInt(_0x3225f9[_0x82bbc9(0x1a5)]));});});const _0xa7a5cc=await staff[_0x203801(0x13d)]({'email':_0x1d03d0[_0x203801(0x1c6)]});if(_0x51f71b[0x0]['language']==_0x203801(0x210))var _0x5a2310=users['English'];else{if(_0x51f71b[0x0][_0x203801(0x1e9)]==_0x203801(0x1d5))var _0x5a2310=users[_0x203801(0x1d5)];else{if(_0x51f71b[0x0][_0x203801(0x1e9)]==_0x203801(0x216))var _0x5a2310=users[_0x203801(0x216)];else{if(_0x51f71b[0x0][_0x203801(0x1e9)]=='Spanish')var _0x5a2310=users[_0x203801(0xa1)];else{if(_0x51f71b[0x0][_0x203801(0x1e9)]==_0x203801(0xd5))var _0x5a2310=users['French'];else{if(_0x51f71b[0x0][_0x203801(0x1e9)]==_0x203801(0x209))var _0x5a2310=users[_0x203801(0x18d)];else{if(_0x51f71b[0x0][_0x203801(0x1e9)]==_0x203801(0x185))var _0x5a2310=users[_0x203801(0x185)];else{if(_0x51f71b[0x0][_0x203801(0x1e9)]==_0x203801(0x10f))var _0x5a2310=users[_0x203801(0x1f5)];}}}}}}}_0x173252['render'](_0x203801(0xcf),{'success':_0x53b9fc[_0x203801(0x160)]('success'),'errors':_0x53b9fc[_0x203801(0x160)](_0x203801(0x220)),'alldata':_0x15e3e7,'profile':_0x121afb,'master_shop':_0x51f71b,'role':_0x1d03d0,'product_stock':_0x360c49,'language':_0x5a2310,'staff_arr':_0xa7a5cc});}catch(_0x3976d3){}});async function agentsdataDSICheck_DSRR(_0x400eab,_0x228548,_0x40d53c,_0x509c6c){const _0x34d442=a0_0x2c4080;let _0x1c48d0=new Date(_0x400eab);_0x1c48d0[_0x34d442(0x207)](_0x1c48d0[_0x34d442(0x19a)]()-0x1);let _0x228d90=_0x1c48d0[_0x34d442(0x11c)]()[_0x34d442(0x145)]('T')[0x0];const _0x24d761=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':_0x34d442(0x1b9)},'products':{'$push':{'name':_0x34d442(0x184),'product_code':_0x34d442(0x1a3)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x54bd64=[];_0x54bd64[_0x34d442(0x213)]=[];for(let _0x125fe1=0x0;_0x125fe1<=_0x24d761['length']-0x1;_0x125fe1++){const _0x40aabb=_0x24d761[_0x125fe1];_0x54bd64['cat_brand']['push'](_0x40aabb);}const _0x21edaa=await product[_0x34d442(0xcd)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x34d442(0x1a3),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x3c34f7=await product[_0x34d442(0xcd)]([{'$group':{'_id':{'category':_0x34d442(0x1b9),'brand':_0x34d442(0x127)}}},{'$group':{'_id':_0x34d442(0x14d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5ef274=await sales_sa[_0x34d442(0xcd)]([{'$match':{'date':_0x400eab,'sales_staff_id':_0x228548,'sale_product.isFG':_0x34d442(0x1ab)}},{'$unwind':_0x34d442(0x18f)},{'$lookup':{'from':_0x34d442(0xab),'localField':_0x34d442(0x1a9),'foreignField':_0x34d442(0xba),'as':_0x34d442(0x1fd)}},{'$unwind':_0x34d442(0x1f2)},{'$group':{'_id':{'dsi':_0x34d442(0x113),'date':_0x34d442(0x196),'customer':'$customer','status_data':_0x34d442(0x1ef)},'totalQty':{'$sum':_0x34d442(0x1db)},'cash':{'$first':_0x34d442(0x22e)},'amount':{'$first':_0x34d442(0x140)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x34d442(0x110)},'due_date':{'$first':_0x34d442(0x139)},'products':{'$push':{'qty':_0x34d442(0x1db),'NetPrice':_0x34d442(0x192),'discount':'$sale_product.discount','adj_discount':_0x34d442(0x1df),'product_details':{'prod_name':_0x34d442(0x163),'product_code':_0x34d442(0x20a),'category':_0x34d442(0x228),'brand':_0x34d442(0xfb),'gross_price':'$product_info.gross_price','isFG':_0x34d442(0x21a),'prod_cat':'$sale_product.prod_cat','prod_id':'$sale_product._id'}}}}},{'$unwind':_0x34d442(0x169)},{'$group':{'_id':{'dsi':_0x34d442(0x12d),'date':_0x34d442(0x13b),'customer':_0x34d442(0x11b),'status_data':'$_id.status_data','category':_0x34d442(0xfe),'brand':'$products.product_details.brand','prod_id':_0x34d442(0x1e8)},'totalQty':{'$sum':_0x34d442(0x1d7)},'totalGross':{'$sum':{'$multiply':[_0x34d442(0x1d7),_0x34d442(0x132)]}},'NetPrice':{'$sum':_0x34d442(0x1ce)},'discount':{'$sum':_0x34d442(0x155)},'adj_discount':{'$sum':_0x34d442(0x1e7)},'cash':{'$first':_0x34d442(0x22e)},'amount':{'$first':'$amount'},'bank':{'$first':_0x34d442(0x118)},'check_no':{'$first':_0x34d442(0x110)},'due_date':{'$first':_0x34d442(0x139)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x34d442(0x12d),'date':'$_id.date','customer':_0x34d442(0x11b),'status_data':_0x34d442(0x208)},'totalQty':{'$sum':_0x34d442(0x20b)},'totalGross':{'$sum':_0x34d442(0x224)},'NetPrice':{'$sum':_0x34d442(0x1e5)},'discount':{'$sum':_0x34d442(0xef)},'adj_discount':{'$sum':_0x34d442(0x1e6)},'cash':{'$first':_0x34d442(0x22e)},'amount':{'$first':_0x34d442(0x140)},'bank':{'$first':_0x34d442(0x118)},'check_no':{'$first':_0x34d442(0x110)},'due_date':{'$first':_0x34d442(0x139)},'products':{'$push':{'qty':_0x34d442(0x20b),'category':'$_id.category','brand':_0x34d442(0x1f0),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x178630=await sales_sa['aggregate']([{'$match':{'date':_0x228d90,'sales_staff_id':_0x228548,'sale_product.isFG':_0x34d442(0x1ab)}},{'$unwind':'$sale_product'},{'$lookup':{'from':'products','localField':_0x34d442(0x1a9),'foreignField':_0x34d442(0xba),'as':'product_info'}},{'$unwind':_0x34d442(0x1f2)},{'$group':{'_id':{'dsi':'$dsi','date':_0x34d442(0x196),'customer':_0x34d442(0x198)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':_0x34d442(0x22e)},'amount':{'$first':_0x34d442(0x140)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x34d442(0x110)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x34d442(0x1db),'NetPrice':_0x34d442(0x192),'discount':'$sale_product.discount','adj_discount':_0x34d442(0x1df),'product_details':{'prod_name':_0x34d442(0x163),'product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x34d442(0xfb),'gross_price':'$product_info.gross_price','isFG':_0x34d442(0x21a),'prod_cat':_0x34d442(0x101),'prod_id':_0x34d442(0xf9)}}}}},{'$unwind':_0x34d442(0x169)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x34d442(0x13b),'customer':'$_id.customer','category':'$products.product_details.category','brand':_0x34d442(0x17c),'prod_id':_0x34d442(0x1e8)},'totalQty':{'$sum':_0x34d442(0x1d7)},'cash':{'$first':'$cash'},'amount':{'$first':_0x34d442(0x140)},'bank':{'$first':_0x34d442(0x118)},'check_no':{'$first':_0x34d442(0x110)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':{'$multiply':[_0x34d442(0x1d7),_0x34d442(0x132)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x34d442(0x155)},'adj_discount':{'$sum':_0x34d442(0x1e7)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x34d442(0x12d),'date':_0x34d442(0x13b),'customer':'$_id.customer'},'totalQty':{'$sum':_0x34d442(0x20b)},'cash':{'$first':_0x34d442(0x22e)},'amount':{'$first':_0x34d442(0x140)},'bank':{'$first':_0x34d442(0x118)},'check_no':{'$first':_0x34d442(0x110)},'due_date':{'$first':_0x34d442(0x139)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x34d442(0xef)},'adj_discount':{'$sum':_0x34d442(0x1e6)},'products':{'$push':{'qty':'$totalQty','category':_0x34d442(0x14d),'brand':_0x34d442(0x1f0),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x41cf7c=await sales_sa[_0x34d442(0xcd)]([{'$match':{'date':_0x400eab,'sales_staff_id':_0x228548,'status_data':'true'}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x26d83f=await staff['findById'](_0x228548);let _0x2e6548=[],_0x264cdd={},_0x2e472e={};var _0x2c4c5a=0x0,_0x386f13=0x0,_0x441f6f=0x0,_0x5a66a9=0x0,_0x4a39ac=0x0;const _0x1d37b5=0x6;var _0xfe7bdb=0x0,_0x206756=0x0;for(let _0x2c89d4=0x0;_0x2c89d4<=_0x5ef274['length']-0x1;_0x2c89d4++){const _0x2bd145=_0x5ef274[_0x2c89d4];let _0x79f319=_0x34d442(0xd6);_0x79f319+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x79f319+=_0x34d442(0x171)+_0x2bd145[_0x34d442(0x156)]['customer']+_0x34d442(0x1c5),_0x79f319+=_0x34d442(0x171)+_0x2bd145[_0x34d442(0x156)]['dsi']+_0x34d442(0x1c5);let _0xeab302={},_0x5157da={},_0x2bdfa8={};var _0x2caabf={},_0x3bbf4e={},_0x37c3b7={},_0x58d38a=0x0;for(let _0x5a288f=0x0;_0x5a288f<=_0x2bd145[_0x34d442(0xab)][_0x34d442(0xc4)]-0x1;_0x5a288f++){const _0x261884=_0x2bd145['products'][_0x5a288f];_0xeab302[_0x261884[_0x34d442(0xc7)]+'-'+_0x261884[_0x34d442(0x1f4)]]=_0x261884[_0x34d442(0x206)],_0x5157da[[_0x261884[_0x34d442(0xc7)]+'-'+_0x261884['category']]]=_0x261884[_0x34d442(0xc8)]['isFG'],_0x2bdfa8[[_0x261884[_0x34d442(0xc7)]+'-'+_0x261884[_0x34d442(0x1f4)]]]=_0x261884[_0x34d442(0xc8)][_0x34d442(0xd9)];const _0x4b9a58=_0x261884[_0x34d442(0xc7)]+'-'+_0x261884['category'];!Array[_0x34d442(0xa5)](_0x2e472e[_0x4b9a58])&&(_0x2e472e[_0x4b9a58]=[]);!Array['isArray'](_0x2e472e[_0x4b9a58])&&(_0x2e472e[_0x4b9a58]=[]);_0x2e472e[_0x4b9a58][_0x34d442(0x175)](_0x261884[_0x34d442(0x206)]);if(_0x261884[_0x34d442(0xc8)]['prod_cat']=='P')_0x261884['product_details'][_0x34d442(0x13c)]==_0x34d442(0x122)?(!_0x37c3b7[_0x4b9a58]&&(_0x37c3b7[_0x4b9a58]=0x0),_0x37c3b7[_0x4b9a58]=_0x261884[_0x34d442(0x206)]):(!_0x2caabf[_0x4b9a58]&&(_0x2caabf[_0x4b9a58]=0x0),_0x2caabf[_0x4b9a58]=_0x261884['qty']);else _0x261884[_0x34d442(0xc8)][_0x34d442(0xd9)]=='S'&&(_0x261884['product_details'][_0x34d442(0x13c)]==_0x34d442(0x122)?(!_0x37c3b7[_0x4b9a58]&&(_0x37c3b7[_0x4b9a58]=0x0),_0x37c3b7[_0x4b9a58]=_0x261884[_0x34d442(0x206)]):(!_0x3bbf4e[_0x4b9a58]&&(_0x3bbf4e[_0x4b9a58]=0x0),_0x3bbf4e[_0x4b9a58]=_0x261884[_0x34d442(0x206)]));_0x58d38a++;}for(let _0x152fcc=0x0;_0x152fcc<=_0x54bd64['cat_brand'][_0x34d442(0xc4)]-0x1;_0x152fcc++){const _0x69890a=_0x54bd64[_0x34d442(0x213)][_0x152fcc],_0xaf0a92=_0x69890a[_0x34d442(0x156)][_0x34d442(0xc7)]+'-'+_0x69890a[_0x34d442(0x156)][_0x34d442(0x1f4)],_0x5130f1=_0x2bdfa8[_0xaf0a92]!==undefined?_0x2bdfa8[_0xaf0a92]:'NA';var _0x112b35=_0x2caabf[_0xaf0a92]!==undefined?_0x2caabf[_0xaf0a92]['toFixed'](0x2):'',_0x4f4a56=_0x3bbf4e[_0xaf0a92]!==undefined?_0x3bbf4e[_0xaf0a92]['toFixed'](0x2):'',_0x4b3634=_0x37c3b7[_0xaf0a92]!==undefined?_0x37c3b7[_0xaf0a92][_0x34d442(0x10a)](0x2):'';_0x79f319+=_0x34d442(0xac)+_0x112b35+_0x34d442(0x1c5),_0x79f319+=_0x34d442(0xac)+_0x4f4a56+_0x34d442(0x1c5),_0x79f319+=_0x34d442(0xac)+_0x4b3634+_0x34d442(0x1c5);}var _0x2517f4=formatNumber(parseFloat(_0x2bd145['cash'])),_0x37a47d=formatNumber(parseFloat(_0x2bd145['amount']));isNaN(_0x37a47d)&&(_0x37a47d=0x0),_0x79f319+=_0x34d442(0xac)+_0x2517f4+_0x34d442(0x1c5),_0x79f319+=_0x34d442(0xac)+_0x37a47d+_0x34d442(0x1c5),_0x79f319+=_0x34d442(0x171)+_0x2bd145[_0x34d442(0x1c9)]+_0x34d442(0x1c5),_0x79f319+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2bd145[_0x34d442(0xc2)]+'</td>',_0x79f319+=_0x34d442(0x171)+_0x2bd145[_0x34d442(0x1a8)]+'</td>',_0x441f6f=_0x2bd145['discount']+_0x2bd145[_0x34d442(0xf4)],_0xfe7bdb+=parseFloat(_0x2bd145[_0x34d442(0x199)]),_0x206756+=parseFloat(_0x37a47d),_0x2e6548[_0x34d442(0x175)](_0x79f319);}function _0x26dc83(_0x1975aa,_0x530b89){const _0x1e5c39=_0x34d442,_0x351d98=[];for(let _0x130bbd=0x0;_0x130bbd<=_0x1975aa[_0x1e5c39(0xc4)]-0x1;_0x130bbd+=_0x530b89){_0x351d98[_0x1e5c39(0x175)](_0x1975aa[_0x1e5c39(0x1b6)](_0x130bbd,_0x130bbd+_0x530b89));}return _0x351d98;}const _0x47bc75=_0x26dc83(_0x2e6548,_0x1d37b5);let _0x8436cd='';return _0x47bc75[_0x34d442(0x1e2)]((_0x2ded1e,_0x53b24d)=>{const _0x2bedff=_0x34d442;_0x53b24d>0x0&&(_0x8436cd+=_0x2bedff(0x15e));_0x8436cd+=_0x2bedff(0x137),_0x8436cd+='<thead>';const _0xaa152d=new Date(_0x400eab),_0x4eea57={'year':'numeric','month':_0x2bedff(0x19e),'day':_0x2bedff(0x1ca),'timeZone':'Asia/Manila'},_0x4aeda2=_0xaa152d[_0x2bedff(0x201)](_0x2bedff(0x218),_0x4eea57);_0x8436cd+='<tr>',_0x8436cd+=_0x2bedff(0xf1)+_0x509c6c+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+='<tr>',_0x8436cd+=_0x2bedff(0x134)+_0x26d83f[_0x2bedff(0xd1)]+'</td>',_0x8436cd+=_0x2bedff(0xda),_0x8436cd+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x8436cd+=_0x2bedff(0xf2),_0x8436cd+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x8436cd+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x8436cd+=_0x2bedff(0x116),_0x8436cd+='<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>',_0x8436cd+=_0x2bedff(0x136),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+='<tr>',_0x8436cd+=_0x2bedff(0xe6),_0x8436cd+=_0x2bedff(0x217)+_0x4aeda2+'</td>',_0x8436cd+=_0x2bedff(0x1b3),_0x8436cd+=_0x2bedff(0x126),_0x8436cd+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x8436cd+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+=_0x2bedff(0xd6),_0x8436cd+=_0x2bedff(0xa0),_0x8436cd+=_0x2bedff(0x180),_0x8436cd+=_0x2bedff(0x16c),_0x8436cd+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x8436cd+=_0x2bedff(0x151),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+='<tr>',_0x8436cd+=_0x2bedff(0x1ec),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+=_0x2bedff(0xd6),_0x8436cd+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x8436cd+=_0x2bedff(0xf0),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+='<tr>',_0x8436cd+=_0x2bedff(0x123),_0x8436cd+=_0x2bedff(0x128),_0x8436cd+=_0x2bedff(0x168);for(let _0x1f0d47=0x0;_0x1f0d47<=_0x21edaa[_0x2bedff(0xc4)]-0x1;_0x1f0d47++){const _0x267094=_0x21edaa[_0x1f0d47];for(let _0x4b1234=0x0;_0x4b1234<_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)];_0x4b1234++){const _0x58e32f=_0x54bd64[_0x2bedff(0x213)][_0x4b1234];if(_0x58e32f[_0x2bedff(0x156)][_0x2bedff(0x1f4)]===_0x267094[_0x2bedff(0x156)][_0x2bedff(0x1f4)]){var _0x95aa8a='';switch(_0x267094[_0x2bedff(0x156)][_0x2bedff(0x1f4)]){case _0x2bedff(0xb3):_0x95aa8a=_0x58e32f[_0x2bedff(0x156)]['brand']+_0x2bedff(0xdb);break;case _0x2bedff(0x19d):_0x95aa8a=_0x58e32f['_id'][_0x2bedff(0xc7)]+'\x20-\x20HH';break;default:_0x95aa8a=_0x58e32f[_0x2bedff(0x156)][_0x2bedff(0xc7)];break;}_0x8436cd+=_0x2bedff(0x1d8)+_0x95aa8a+_0x2bedff(0x21e);}}}_0x8436cd+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x8436cd+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>',_0x8436cd+=_0x2bedff(0xbe),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+='<tr>',_0x8436cd+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x35614e=0x0;_0x35614e<=_0x54bd64[_0x2bedff(0x213)]['length']-0x1;_0x35614e++){const _0x320d2b=_0x54bd64[_0x35614e];_0x8436cd+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x8436cd+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x8436cd+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x8436cd+=_0x2bedff(0x1ff),_0x8436cd+=_0x2bedff(0xa6),_0x8436cd+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>',_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+=_0x2bedff(0xb9),_0x8436cd+=_0x2bedff(0x13e),_0x2ded1e[_0x2bedff(0x1e2)](_0x2e53ce=>{_0x8436cd+=_0x2e53ce;});let _0xad81e5={},_0x29d6d3={},_0x355386={};for(let _0x223f2f=0x0;_0x223f2f<=_0x5ef274[_0x2bedff(0xc4)]-0x1;_0x223f2f++){const _0x22d15e=_0x5ef274[_0x223f2f];var _0x45d1bc=0x0;for(let _0x3931fa=0x0;_0x3931fa<=_0x22d15e[_0x2bedff(0xab)][_0x2bedff(0xc4)]-0x1;_0x3931fa++){const _0x38e5cc=_0x22d15e['products'][_0x3931fa],_0x485d67=_0x38e5cc[_0x2bedff(0xc7)]+'-'+_0x38e5cc['category'];if(_0x38e5cc[_0x2bedff(0xc8)][_0x2bedff(0xd9)]=='P')_0x38e5cc['product_details']['isFG']=='true'?(!_0x355386[_0x485d67]&&(_0x355386[_0x485d67]=0x0),_0x355386[_0x485d67]+=_0x38e5cc['qty']):(!_0xad81e5[_0x485d67]&&(_0xad81e5[_0x485d67]=0x0),_0xad81e5[_0x485d67]+=_0x38e5cc[_0x2bedff(0x206)]);else _0x38e5cc['product_details'][_0x2bedff(0xd9)]=='S'&&(_0x38e5cc[_0x2bedff(0xc8)][_0x2bedff(0x13c)]==_0x2bedff(0x122)?(!_0x355386[_0x485d67]&&(_0x355386[_0x485d67]=0x0),_0x355386[_0x485d67]+=_0x38e5cc[_0x2bedff(0x206)],console['log'](_0x38e5cc[_0x2bedff(0x206)])):(!_0x29d6d3[_0x485d67]&&(_0x29d6d3[_0x485d67]=0x0),_0x29d6d3[_0x485d67]+=_0x38e5cc[_0x2bedff(0x206)]));_0x45d1bc++;}}let _0x41e477={},_0x578361={},_0x1b5a6c={};var _0x2073da=0x0,_0x3507b5=0x0;for(let _0x29cd23=0x0;_0x29cd23<=_0x178630[_0x2bedff(0xc4)]-0x1;_0x29cd23++){const _0x362b21=_0x178630[_0x29cd23];var _0x45d1bc=0x0;for(let _0x3f9408=0x0;_0x3f9408<=_0x362b21[_0x2bedff(0xab)][_0x2bedff(0xc4)]-0x1;_0x3f9408++){const _0xb3458c=_0x362b21[_0x2bedff(0xab)][_0x3f9408],_0x4e91b3=_0xb3458c[_0x2bedff(0xc7)]+'-'+_0xb3458c[_0x2bedff(0x1f4)];if(_0xb3458c[_0x2bedff(0xc8)]['prod_cat']=='P')_0xb3458c['product_details'][_0x2bedff(0x13c)]=='true'?(!_0x1b5a6c[_0x4e91b3]&&(_0x1b5a6c[_0x4e91b3]=0x0),_0x1b5a6c[_0x4e91b3]+=_0xb3458c['qty']):(!_0x41e477[_0x4e91b3]&&(_0x41e477[_0x4e91b3]=0x0),_0x41e477[_0x4e91b3]+=_0xb3458c[_0x2bedff(0x206)]);else _0xb3458c[_0x2bedff(0xc8)][_0x2bedff(0xd9)]=='S'&&(_0xb3458c[_0x2bedff(0xc8)][_0x2bedff(0x13c)]==_0x2bedff(0x122)?(!_0x1b5a6c[_0x4e91b3]&&(_0x1b5a6c[_0x4e91b3]=0x0),_0x1b5a6c[_0x4e91b3]+=_0xb3458c[_0x2bedff(0x206)]):(!_0x578361[_0x4e91b3]&&(_0x578361[_0x4e91b3]=0x0),_0x578361[_0x4e91b3]+=_0xb3458c[_0x2bedff(0x206)]));_0x45d1bc++;}var _0x1e1665=parseFloat(_0x362b21[_0x2bedff(0x199)]),_0x264cd0=parseFloat(_0x362b21[_0x2bedff(0x119)]);isNaN(_0x264cd0)&&(_0x264cd0=0x0),_0x2073da+=_0x1e1665,_0x3507b5+=_0x264cd0;}if(_0x41cf7c['length']>0x0)for(let _0x187c3d=0x0;_0x187c3d<=_0x41cf7c[_0x2bedff(0xc4)]-0x1;_0x187c3d++){const _0x12a5ed=_0x41cf7c[_0x187c3d];console[_0x2bedff(0x12b)](_0x12a5ed),_0x8436cd+=_0x2bedff(0xd6),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22'+(0x8+0x7*0x3)+_0x2bedff(0x194)+_0x12a5ed[_0x2bedff(0x108)]+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x1c2);}_0x8436cd+='<tr>',_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x8436cd+=_0x2bedff(0x15b),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x5b42da=0x0;_0x5b42da<=_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)]-0x1;_0x5b42da++){const _0x35a8d9=_0x54bd64['cat_brand'][_0x5b42da],_0x4021a6=_0x35a8d9[_0x2bedff(0x156)][_0x2bedff(0xc7)]+'-'+_0x35a8d9[_0x2bedff(0x156)][_0x2bedff(0x1f4)];var _0x2f8687=_0xad81e5[_0x4021a6]!==undefined?formatNumber(_0xad81e5[_0x4021a6]['toFixed'](0x2)):'',_0x472b02=_0x355386[_0x4021a6]!==undefined?formatNumber(_0x355386[_0x4021a6][_0x2bedff(0x10a)](0x2)):'',_0x512e4e=_0x29d6d3[_0x4021a6]!==undefined?formatNumber(_0x29d6d3[_0x4021a6][_0x2bedff(0x10a)](0x2)):'';_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x2f8687+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x231)+_0x512e4e+'</b></td>',_0x8436cd+=_0x2bedff(0x231)+_0x472b02+_0x2bedff(0x21e);}_0x8436cd+=_0x2bedff(0x231)+formatNumber(_0xfe7bdb)+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x231)+formatNumber(_0x206756)+'</b></td>',_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+=_0x2bedff(0xd6),_0x8436cd+=_0x2bedff(0xb5),_0x8436cd+=_0x2bedff(0x105),_0x8436cd+=_0x2bedff(0x120);for(let _0x118a6d=0x0;_0x118a6d<=_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)]-0x1;_0x118a6d++){const _0x6ae71e=_0x54bd64[_0x2bedff(0x213)][_0x118a6d],_0x1bb998=_0x6ae71e[_0x2bedff(0x156)][_0x2bedff(0xc7)]+'-'+_0x6ae71e[_0x2bedff(0x156)][_0x2bedff(0x1f4)];var _0x2f8687=_0x41e477[_0x1bb998]!==undefined?formatNumber(_0x41e477[_0x1bb998][_0x2bedff(0x10a)](0x2)):'',_0x472b02=_0x1b5a6c[_0x1bb998]!==undefined?formatNumber(_0x1b5a6c[_0x1bb998][_0x2bedff(0x10a)](0x2)):'',_0x512e4e=_0x578361[_0x1bb998]!==undefined?formatNumber(_0x578361[_0x1bb998][_0x2bedff(0x10a)](0x2)):'';_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x2f8687+_0x2bedff(0x21e),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x512e4e+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x231)+_0x472b02+_0x2bedff(0x21e);}_0x8436cd+=_0x2bedff(0x231)+formatNumber(_0x2073da)+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x231)+formatNumber(_0x3507b5)+'</b></td>',_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+=_0x2bedff(0xd6),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x8436cd+=_0x2bedff(0x12e),_0x8436cd+=_0x2bedff(0x120);let _0x3eeb3c=0x0,_0x1c1900=0x0,_0x309460=0x0;for(let _0x3768ea=0x0;_0x3768ea<=_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)]-0x1;_0x3768ea++){const _0x39e326=_0x54bd64[_0x2bedff(0x213)][_0x3768ea],_0x4cdf6e=_0x39e326[_0x2bedff(0x156)][_0x2bedff(0xc7)]+'-'+_0x39e326[_0x2bedff(0x156)][_0x2bedff(0x1f4)];var _0x4a1ac6=_0xad81e5[_0x4cdf6e]!==undefined?_0xad81e5[_0x4cdf6e][_0x2bedff(0x10a)](0x2):'0',_0x5274e0=_0x355386[_0x4cdf6e]!==undefined?_0x355386[_0x4cdf6e][_0x2bedff(0x10a)](0x2):'0',_0x41f860=_0x29d6d3[_0x4cdf6e]!==undefined?_0x29d6d3[_0x4cdf6e][_0x2bedff(0x10a)](0x2):'0',_0x170884=_0x41e477[_0x4cdf6e]!==undefined?_0x41e477[_0x4cdf6e]['toFixed'](0x2):'0',_0x2406e3=_0x1b5a6c[_0x4cdf6e]!==undefined?_0x1b5a6c[_0x4cdf6e][_0x2bedff(0x10a)](0x2):'0',_0x2d4499=_0x578361[_0x4cdf6e]!==undefined?_0x578361[_0x4cdf6e]['toFixed'](0x2):'0';_0x3eeb3c=parseFloat(_0x4a1ac6)+parseFloat(_0x170884),_0x1c1900=parseFloat(_0x41f860)+parseFloat(_0x2d4499),_0x309460=parseFloat(_0x5274e0)+parseFloat(_0x2406e3),_0x8436cd+=_0x2bedff(0x231)+formatNumber(_0x3eeb3c[_0x2bedff(0x10a)](0x2))+_0x2bedff(0x21e),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1c1900[_0x2bedff(0x10a)](0x2))+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x231)+formatNumber(_0x309460[_0x2bedff(0x10a)](0x2))+_0x2bedff(0x21e);}var _0x761c36=formatNumber(_0xfe7bdb+_0x2073da),_0xb7d87d=formatNumber(_0x206756+_0x3507b5);_0x8436cd+=_0x2bedff(0x231)+_0x761c36+'</b></td>',_0x8436cd+=_0x2bedff(0x231)+_0xb7d87d+'</b></td>',_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+='<tr>',_0x8436cd+=_0x2bedff(0x1a0)+(_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)]*0x3+0x9)+_0x2bedff(0x148),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+=_0x2bedff(0xd6),_0x8436cd+=_0x2bedff(0xb5),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x8436cd+=_0x2bedff(0x120);for(let _0xb5cf7b=0x0;_0xb5cf7b<=_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)]-0x1;_0xb5cf7b++){const _0x5498a6=_0x54bd64[_0x2bedff(0x213)][_0xb5cf7b],_0x468cef=_0x5498a6[_0x2bedff(0x156)][_0x2bedff(0xc7)]+'-'+_0x5498a6['_id']['category'];var _0x4a1ac6=_0xad81e5[_0x468cef]!==undefined?_0xad81e5[_0x468cef][_0x2bedff(0x10a)](0x2):'0',_0x5274e0=_0x355386[_0x468cef]!==undefined?_0x355386[_0x468cef][_0x2bedff(0x10a)](0x2):'0',_0x41f860=_0x29d6d3[_0x468cef]!==undefined?_0x29d6d3[_0x468cef][_0x2bedff(0x10a)](0x2):'0',_0x170884=_0x41e477[_0x468cef]!==undefined?_0x41e477[_0x468cef][_0x2bedff(0x10a)](0x2):'0',_0x2406e3=_0x1b5a6c[_0x468cef]!==undefined?_0x1b5a6c[_0x468cef][_0x2bedff(0x10a)](0x2):'0',_0x2d4499=_0x578361[_0x468cef]!==undefined?_0x578361[_0x468cef][_0x2bedff(0x10a)](0x2):'0';_0x3eeb3c=parseFloat(_0x4a1ac6)+parseFloat(_0x170884),_0x1c1900=parseFloat(_0x41f860)+parseFloat(_0x2d4499),_0x309460=parseFloat(_0x5274e0)+parseFloat(_0x2406e3),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+=_0x2bedff(0xd6),_0x8436cd+=_0x2bedff(0xb5),_0x8436cd+=_0x2bedff(0x203),_0x8436cd+=_0x2bedff(0x120);for(let _0x26d445=0x0;_0x26d445<=_0x54bd64[_0x2bedff(0x213)]['length']-0x1;_0x26d445++){const _0x3243a0=_0x54bd64[_0x2bedff(0x213)][_0x26d445],_0x327583=_0x3243a0[_0x2bedff(0x156)][_0x2bedff(0xc7)]+'-'+_0x3243a0[_0x2bedff(0x156)][_0x2bedff(0x1f4)];var _0x4a1ac6=_0xad81e5[_0x327583]!==undefined?_0xad81e5[_0x327583]['toFixed'](0x2):'0',_0x5274e0=_0x355386[_0x327583]!==undefined?_0x355386[_0x327583]['toFixed'](0x2):'0',_0x41f860=_0x29d6d3[_0x327583]!==undefined?_0x29d6d3[_0x327583][_0x2bedff(0x10a)](0x2):'0',_0x170884=_0x41e477[_0x327583]!==undefined?_0x41e477[_0x327583]['toFixed'](0x2):'0',_0x2406e3=_0x1b5a6c[_0x327583]!==undefined?_0x1b5a6c[_0x327583][_0x2bedff(0x10a)](0x2):'0',_0x2d4499=_0x578361[_0x327583]!==undefined?_0x578361[_0x327583][_0x2bedff(0x10a)](0x2):'0';_0x3eeb3c=parseFloat(_0x4a1ac6)+parseFloat(_0x170884),_0x1c1900=parseFloat(_0x41f860)+parseFloat(_0x2d4499),_0x309460=parseFloat(_0x5274e0)+parseFloat(_0x2406e3),_0x8436cd+=_0x2bedff(0x10c),_0x8436cd+=_0x2bedff(0x10c),_0x8436cd+=_0x2bedff(0x10c);}_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+='<tr>',_0x8436cd+=_0x2bedff(0xb5),_0x8436cd+=_0x2bedff(0xe5),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x50dfa3=0x0;_0x50dfa3<=_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)]-0x1;_0x50dfa3++){const _0x459d93=_0x54bd64['cat_brand'][_0x50dfa3],_0x1466e6=_0x459d93[_0x2bedff(0x156)][_0x2bedff(0xc7)]+'-'+_0x459d93[_0x2bedff(0x156)]['category'];var _0x4a1ac6=_0xad81e5[_0x1466e6]!==undefined?_0xad81e5[_0x1466e6]['toFixed'](0x2):'0',_0x5274e0=_0x355386[_0x1466e6]!==undefined?_0x355386[_0x1466e6][_0x2bedff(0x10a)](0x2):'0',_0x41f860=_0x29d6d3[_0x1466e6]!==undefined?_0x29d6d3[_0x1466e6]['toFixed'](0x2):'0',_0x170884=_0x41e477[_0x1466e6]!==undefined?_0x41e477[_0x1466e6][_0x2bedff(0x10a)](0x2):'0',_0x2406e3=_0x1b5a6c[_0x1466e6]!==undefined?_0x1b5a6c[_0x1466e6][_0x2bedff(0x10a)](0x2):'0',_0x2d4499=_0x578361[_0x1466e6]!==undefined?_0x578361[_0x1466e6][_0x2bedff(0x10a)](0x2):'0';_0x3eeb3c=parseFloat(_0x4a1ac6)+parseFloat(_0x170884),_0x1c1900=parseFloat(_0x41f860)+parseFloat(_0x2d4499),_0x309460=parseFloat(_0x5274e0)+parseFloat(_0x2406e3),_0x8436cd+=_0x2bedff(0x10c),_0x8436cd+=_0x2bedff(0x10c),_0x8436cd+=_0x2bedff(0x10c);}_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+=_0x2bedff(0xd6),_0x8436cd+=_0x2bedff(0xb5),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x8436cd+=_0x2bedff(0x120);for(let _0x3149f1=0x0;_0x3149f1<=_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)]-0x1;_0x3149f1++){const _0x47346b=_0x54bd64[_0x2bedff(0x213)][_0x3149f1],_0x2df3ae=_0x47346b[_0x2bedff(0x156)][_0x2bedff(0xc7)]+'-'+_0x47346b[_0x2bedff(0x156)][_0x2bedff(0x1f4)];var _0x4a1ac6=_0xad81e5[_0x2df3ae]!==undefined?_0xad81e5[_0x2df3ae][_0x2bedff(0x10a)](0x2):'',_0x5274e0=_0x355386[_0x2df3ae]!==undefined?_0x355386[_0x2df3ae][_0x2bedff(0x10a)](0x2):'',_0x41f860=_0x29d6d3[_0x2df3ae]!==undefined?_0x29d6d3[_0x2df3ae][_0x2bedff(0x10a)](0x2):'',_0x170884=_0x41e477[_0x2df3ae]!==undefined?_0x41e477[_0x2df3ae][_0x2bedff(0x10a)](0x2):'',_0x2406e3=_0x1b5a6c[_0x2df3ae]!==undefined?_0x1b5a6c[_0x2df3ae][_0x2bedff(0x10a)](0x2):'',_0x2d4499=_0x578361[_0x2df3ae]!==undefined?_0x578361[_0x2df3ae]['toFixed'](0x2):'';_0x3eeb3c=formatNumber(parseFloat(_0x4a1ac6)+parseFloat(_0x170884)),_0x1c1900=formatNumber(parseFloat(_0x41f860)+parseFloat(_0x2d4499)),_0x309460=formatNumber(parseFloat(_0x5274e0)+parseFloat(_0x2406e3)),_0x8436cd+=_0x2bedff(0x231)+_0x4a1ac6+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x231)+_0x41f860+_0x2bedff(0x21e),_0x8436cd+=_0x2bedff(0x231)+_0x5274e0+'</b></td>';}_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x8436cd+=_0x2bedff(0x1c2),_0x8436cd+='<tr>',_0x8436cd+=_0x2bedff(0xb5),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>',_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x327be4=0x0;_0x327be4<=_0x54bd64[_0x2bedff(0x213)][_0x2bedff(0xc4)]-0x1;_0x327be4++){const _0x451d0a=_0x54bd64[_0x2bedff(0x213)][_0x327be4],_0x334e11=_0x451d0a['_id'][_0x2bedff(0xc7)]+'-'+_0x451d0a[_0x2bedff(0x156)]['category'];var _0x4a1ac6=_0xad81e5[_0x334e11]!==undefined?_0xad81e5[_0x334e11][_0x2bedff(0x10a)](0x2):'0',_0x5274e0=_0x355386[_0x334e11]!==undefined?_0x355386[_0x334e11][_0x2bedff(0x10a)](0x2):'0',_0x41f860=_0x29d6d3[_0x334e11]!==undefined?_0x29d6d3[_0x334e11]['toFixed'](0x2):'0',_0x170884=_0x41e477[_0x334e11]!==undefined?_0x41e477[_0x334e11][_0x2bedff(0x10a)](0x2):'0',_0x2406e3=_0x1b5a6c[_0x334e11]!==undefined?_0x1b5a6c[_0x334e11][_0x2bedff(0x10a)](0x2):'0',_0x2d4499=_0x578361[_0x334e11]!==undefined?_0x578361[_0x334e11][_0x2bedff(0x10a)](0x2):'0';_0x3eeb3c=parseFloat(_0x4a1ac6)+parseFloat(_0x170884),_0x1c1900=parseFloat(_0x41f860)+parseFloat(_0x2d4499),_0x309460=parseFloat(_0x5274e0)+parseFloat(_0x2406e3),_0x8436cd+=_0x2bedff(0x10c),_0x8436cd+=_0x2bedff(0x10c),_0x8436cd+=_0x2bedff(0x10c);}_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x8436cd+=_0x2bedff(0x120),_0x8436cd+=_0x2bedff(0x120),_0x8436cd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x8436cd+=_0x2bedff(0x120),_0x8436cd+='</tr>',_0x8436cd+=_0x2bedff(0xb7),_0x8436cd+=_0x2bedff(0x16e);}),_0x8436cd;}async function generateReferenceNumber(_0x3526b8,_0x3a6c46,_0x2ec755){const _0x15f990=a0_0x2c4080,_0x18411=new Date(_0x3526b8)[_0x15f990(0x141)](),_0x13458b=('0'+(new Date(_0x3526b8)[_0x15f990(0x195)]()+0x1))[_0x15f990(0x1b6)](-0x2),_0x1f8283=('0'+new Date(_0x3526b8)[_0x15f990(0x19a)]())[_0x15f990(0x1b6)](-0x2),_0x266a37=await staff['findOne']({'email':_0x2ec755[_0x15f990(0x1c6)]}),_0x486db8=_0x266a37[_0x15f990(0x1ae)],_0x39138b=_0x486db8+'-'+_0x18411+_0x13458b+_0x1f8283,_0x31f344=await Reference[_0x15f990(0x13d)]({'referenceNumber':new RegExp('^'+_0x39138b),'salesman_code':_0x486db8})[_0x15f990(0x20e)]({'createdAt':-0x1}),_0x406401=_0x39138b;_0x31f344&&(_0x406401=_0x31f344[_0x15f990(0xd7)]);console['log'](_0x406401);const _0x20e3d2=new Reference({'referenceNumber':_0x406401,'staff_id':_0x3a6c46,'salesman_code':_0x486db8});return await _0x20e3d2[_0x15f990(0x112)](),_0x406401;}router['post'](a0_0x2c4080(0x1dc),auth,async(_0x2ec88b,_0x21f9ea)=>{const _0x307046=a0_0x2c4080,{from_date:_0x2e7eac,dataview:_0x11a2bd}=_0x2ec88b[_0x307046(0x1a1)],_0x2cb3f3=_0x2ec88b[_0x307046(0xe4)],_0x29b2eb=await staff['findOne']({'email':_0x2cb3f3[_0x307046(0x1c6)]}),_0x257432=await master_shop['find'](),_0x5e7ccd='';var _0x6e22a8=new Date(_0x2e7eac);const _0x4056fd={'year':_0x307046(0x1ca),'month':_0x307046(0x19e),'day':_0x307046(0x1ca)},_0x164d3e=new Intl[(_0x307046(0xc6))]('en-US',_0x4056fd)[_0x307046(0xea)](_0x6e22a8),_0x1792b4=await Reference[_0x307046(0x131)]({'staff_id':_0x29b2eb[_0x307046(0x156)][_0x307046(0x211)](),'date_include':_0x2e7eac});if(_0x1792b4[_0x307046(0xc4)]>0x0){let _0x4399db='';_0x4399db+=_0x1792b4[0x0]['html'];if(_0x11a2bd==_0x307046(0x16a)){const _0x2d2128=cheerio['load'](_0x4399db);let _0x3f0f28=[],_0x1f117c=[],_0x152495=[];const _0x543e9d=_0x596075=>{const _0x8ca96f=_0x307046,_0x4e0b97={'top':{'style':_0x8ca96f(0x1e1),'color':{'rgb':_0x8ca96f(0x17e)}},'bottom':{'style':_0x8ca96f(0x1e1),'color':{'rgb':_0x8ca96f(0x17e)}},'left':{'style':'thick','color':{'rgb':_0x8ca96f(0x17e)}},'right':{'style':_0x8ca96f(0x1e1),'color':{'rgb':_0x8ca96f(0x17e)}}};if(_0x596075){const _0x179a42=_0x596075[_0x8ca96f(0x145)](';')[_0x8ca96f(0x20f)]((_0x3ddc5e,_0x62ece0)=>{const _0x54c8b1=_0x8ca96f,[_0x24d3f7,_0x35cd1b]=_0x62ece0[_0x54c8b1(0x145)](':')['map'](_0x1eab75=>_0x1eab75[_0x54c8b1(0xff)]());return _0x3ddc5e[_0x24d3f7]=_0x35cd1b,_0x3ddc5e;},{});_0x179a42['border-top']&&(_0x4e0b97[_0x8ca96f(0xca)][_0x8ca96f(0x18e)]=_0x179a42[_0x8ca96f(0x19b)][_0x8ca96f(0x214)](_0x8ca96f(0x1ed))?_0x8ca96f(0x1ed):_0x8ca96f(0x1e3)),_0x179a42[_0x8ca96f(0x1f6)]&&(_0x4e0b97[_0x8ca96f(0x212)][_0x8ca96f(0x18e)]=_0x179a42['border-bottom'][_0x8ca96f(0x214)](_0x8ca96f(0x1ed))?_0x8ca96f(0x1ed):'medium'),_0x179a42[_0x8ca96f(0x1d0)]&&(_0x4e0b97[_0x8ca96f(0x17d)]['style']=_0x179a42['border-left'][_0x8ca96f(0x214)](_0x8ca96f(0x1ed))?_0x8ca96f(0x1ed):_0x8ca96f(0x1e3)),_0x179a42[_0x8ca96f(0x15d)]&&(_0x4e0b97[_0x8ca96f(0xd3)][_0x8ca96f(0x18e)]=_0x179a42[_0x8ca96f(0x15d)][_0x8ca96f(0x214)](_0x8ca96f(0x1ed))?_0x8ca96f(0x1ed):_0x8ca96f(0x1e3));}return _0x4e0b97;};_0x2d2128(_0x307046(0x20d))[_0x307046(0x11a)]((_0x59b947,_0x563fc2)=>{const _0x40b343=_0x307046;let _0x14bd83=[],_0x18489d=0x0;while(_0x152495[_0x18489d]){_0x152495[_0x18489d]--,_0x18489d++;}_0x2d2128(_0x563fc2)[_0x40b343(0x131)](_0x40b343(0xa8))[_0x40b343(0x11a)]((_0x93c268,_0x3b2514)=>{const _0x427905=_0x40b343;let _0x65755b=_0x2d2128(_0x3b2514)[_0x427905(0x14a)]()['trim'](),_0x46c7e8=parseFloat(_0x65755b['replace'](/,/g,''));isNaN(_0x46c7e8)&&(_0x46c7e8=_0x65755b);let _0x3ff68b=parseInt(_0x2d2128(_0x3b2514)[_0x427905(0x11d)](_0x427905(0xbc)))||0x1,_0x20ebe5=parseInt(_0x2d2128(_0x3b2514)['attr'](_0x427905(0x1a4)))||0x1;const _0xa6471f=_0x2d2128(_0x3b2514)[_0x427905(0x11d)](_0x427905(0x18e)),_0x565348=_0x543e9d(_0xa6471f);_0x14bd83[_0x18489d]={'v':_0x46c7e8,'s':{'border':_0x565348}};(_0x3ff68b>0x1||_0x20ebe5>0x1)&&_0x1f117c[_0x427905(0x175)]({'s':{'r':_0x59b947,'c':_0x18489d},'e':{'r':_0x59b947+_0x20ebe5-0x1,'c':_0x18489d+_0x3ff68b-0x1}});for(let _0x4255cc=0x0;_0x4255cc<_0x3ff68b;_0x4255cc++){_0x20ebe5>0x1&&(_0x152495[_0x18489d+_0x4255cc]=_0x20ebe5-0x1);}_0x18489d+=_0x3ff68b;}),_0x3f0f28[_0x40b343(0x175)](_0x14bd83);});const _0x45746c=XLSX[_0x307046(0x1f3)]['book_new'](),_0x402fe1=XLSX['utils'][_0x307046(0x1ea)](_0x3f0f28);_0x1f117c['length']>0x0&&(_0x402fe1[_0x307046(0x10d)]=_0x1f117c);_0x402fe1[_0x307046(0x22a)]=_0x3f0f28[0x0][_0x307046(0xe2)](()=>({'wpx':0x64})),XLSX[_0x307046(0x1f3)][_0x307046(0x162)](_0x45746c,_0x402fe1,_0x307046(0x21b));const _0x16f49a=XLSX[_0x307046(0x1d3)](_0x45746c,{'bookType':_0x307046(0xe7),'type':_0x307046(0x1be)});_0x21f9ea[_0x307046(0x229)](_0x307046(0xfc),_0x307046(0x19f)),_0x21f9ea['setHeader']('Content-Type',_0x307046(0xcc)),_0x21f9ea[_0x307046(0x12a)](_0x16f49a);}else{let _0x5ab03e='';_0x5ab03e+=_0x4399db,_0x5ab03e+='<script>',_0x5ab03e+='window.onload\x20=\x20function()\x20{',_0x5ab03e+=_0x307046(0xaa),_0x5ab03e+='};',_0x5ab03e+=_0x307046(0x179),_0x21f9ea['send'](_0x5ab03e);}}else generateReferenceNumber(_0x2e7eac,_0x29b2eb[_0x307046(0x156)][_0x307046(0x211)](),_0x2cb3f3)[_0x307046(0x1b7)](async _0x180ea8=>{const _0x56136a=_0x307046,_0x46a48b=await agentsdataDSICheck_DSRR(_0x2e7eac,_0x29b2eb['_id'][_0x56136a(0x211)](),_0x5e7ccd,_0x180ea8);let _0x35b8b8=_0x56136a(0x12f);_0x35b8b8+=_0x56136a(0xb8),_0x35b8b8+=_0x56136a(0xd0),_0x35b8b8+='<table>',_0x35b8b8+=_0x46a48b,_0x35b8b8+=_0x56136a(0x16e),_0x35b8b8+=_0x56136a(0x1a7),_0x35b8b8+=_0x56136a(0x1a7);if(_0x46a48b['length']>0x0){const _0x41b686=await Reference[_0x56136a(0x13d)]({'staff_id':_0x29b2eb['_id'][_0x56136a(0x211)](),'referenceNumber':_0x180ea8});_0x41b686[_0x56136a(0xe9)]=_0x35b8b8,_0x41b686[_0x56136a(0x172)]=_0x2e7eac,await _0x41b686[_0x56136a(0x112)]();if(_0x11a2bd=='excel'){const _0x5f2cae=cheerio['load'](_0x35b8b8);let _0x1f03b0=[],_0x19caf9=[],_0x42d621=[];const _0x43fb39=_0x139e4f=>{const _0x46132a=_0x56136a,_0x5853e8={'top':{'style':_0x46132a(0x1e1),'color':{'rgb':_0x46132a(0x17e)}},'bottom':{'style':_0x46132a(0x1e1),'color':{'rgb':_0x46132a(0x17e)}},'left':{'style':_0x46132a(0x1e1),'color':{'rgb':_0x46132a(0x17e)}},'right':{'style':_0x46132a(0x1e1),'color':{'rgb':'000000'}}};if(_0x139e4f){const _0x217a76=_0x139e4f[_0x46132a(0x145)](';')[_0x46132a(0x20f)]((_0x4c4e2c,_0x1d556f)=>{const _0x3b7d1f=_0x46132a,[_0x42a6e6,_0x30783a]=_0x1d556f['split'](':')[_0x3b7d1f(0xe2)](_0x2b70c7=>_0x2b70c7[_0x3b7d1f(0xff)]());return _0x4c4e2c[_0x42a6e6]=_0x30783a,_0x4c4e2c;},{});_0x217a76[_0x46132a(0x19b)]&&(_0x5853e8[_0x46132a(0xca)][_0x46132a(0x18e)]=_0x217a76[_0x46132a(0x19b)][_0x46132a(0x214)](_0x46132a(0x1ed))?_0x46132a(0x1ed):'medium'),_0x217a76[_0x46132a(0x1f6)]&&(_0x5853e8[_0x46132a(0x212)][_0x46132a(0x18e)]=_0x217a76[_0x46132a(0x1f6)][_0x46132a(0x214)]('thin')?_0x46132a(0x1ed):_0x46132a(0x1e3)),_0x217a76[_0x46132a(0x1d0)]&&(_0x5853e8[_0x46132a(0x17d)][_0x46132a(0x18e)]=_0x217a76['border-left'][_0x46132a(0x214)](_0x46132a(0x1ed))?'thin':'medium'),_0x217a76[_0x46132a(0x15d)]&&(_0x5853e8[_0x46132a(0xd3)][_0x46132a(0x18e)]=_0x217a76[_0x46132a(0x15d)]['includes'](_0x46132a(0x1ed))?'thin':_0x46132a(0x1e3));}return _0x5853e8;};_0x5f2cae(_0x56136a(0x20d))[_0x56136a(0x11a)]((_0x4813a4,_0x4e5385)=>{const _0x9c1f9a=_0x56136a;let _0x984ff9=[],_0x4f08e1=0x0;while(_0x42d621[_0x4f08e1]){_0x42d621[_0x4f08e1]--,_0x4f08e1++;}_0x5f2cae(_0x4e5385)[_0x9c1f9a(0x131)]('td,\x20th')[_0x9c1f9a(0x11a)]((_0x5a651b,_0x274e89)=>{const _0x5ac866=_0x9c1f9a;let _0x561443=_0x5f2cae(_0x274e89)[_0x5ac866(0x14a)]()['trim'](),_0xf44a74=parseFloat(_0x561443['replace'](/,/g,''));isNaN(_0xf44a74)&&(_0xf44a74=_0x561443);let _0x5490d4=parseInt(_0x5f2cae(_0x274e89)[_0x5ac866(0x11d)]('colspan'))||0x1,_0x4ab2fc=parseInt(_0x5f2cae(_0x274e89)[_0x5ac866(0x11d)](_0x5ac866(0x1a4)))||0x1;const _0x12515f=_0x5f2cae(_0x274e89)[_0x5ac866(0x11d)](_0x5ac866(0x18e)),_0x55e607=_0x43fb39(_0x12515f);_0x984ff9[_0x4f08e1]={'v':_0xf44a74,'s':{'border':_0x55e607}};(_0x5490d4>0x1||_0x4ab2fc>0x1)&&_0x19caf9[_0x5ac866(0x175)]({'s':{'r':_0x4813a4,'c':_0x4f08e1},'e':{'r':_0x4813a4+_0x4ab2fc-0x1,'c':_0x4f08e1+_0x5490d4-0x1}});for(let _0x5d5aab=0x0;_0x5d5aab<_0x5490d4;_0x5d5aab++){_0x4ab2fc>0x1&&(_0x42d621[_0x4f08e1+_0x5d5aab]=_0x4ab2fc-0x1);}_0x4f08e1+=_0x5490d4;}),_0x1f03b0['push'](_0x984ff9);});const _0x370d69=XLSX[_0x56136a(0x1f3)][_0x56136a(0xc0)](),_0x2e66b3=XLSX['utils'][_0x56136a(0x1ea)](_0x1f03b0);_0x19caf9[_0x56136a(0xc4)]>0x0&&(_0x2e66b3[_0x56136a(0x10d)]=_0x19caf9);_0x2e66b3[_0x56136a(0x22a)]=_0x1f03b0[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x56136a(0x1f3)][_0x56136a(0x162)](_0x370d69,_0x2e66b3,_0x56136a(0x21b));const _0x49df4d=XLSX[_0x56136a(0x1d3)](_0x370d69,{'bookType':'xlsx','type':'buffer'});_0x21f9ea[_0x56136a(0x229)](_0x56136a(0xfc),_0x56136a(0x19f)),_0x21f9ea[_0x56136a(0x229)](_0x56136a(0xae),_0x56136a(0xcc)),_0x21f9ea[_0x56136a(0x12a)](_0x49df4d);}else _0x35b8b8+='<script>',_0x35b8b8+=_0x56136a(0x186),_0x35b8b8+=_0x56136a(0xaa),_0x35b8b8+='};',_0x35b8b8+='</script>',_0x21f9ea['send'](_0x35b8b8);}else await Reference[_0x56136a(0xf8)]({'referenceNumber':_0x180ea8}),_0x2ec88b[_0x56136a(0x160)](_0x56136a(0x220),_0x56136a(0x191)),_0x21f9ea[_0x56136a(0x16f)](_0x56136a(0x150));})['catch'](console[_0x307046(0xb4)]);}),router['get'](a0_0x2c4080(0x1d2),auth,async(_0x250e29,_0x362ba2)=>{const _0xc1a2f7=a0_0x2c4080;try{const {username:_0x52a652,email:_0x5b7c01,role:_0x157569}=_0x250e29[_0xc1a2f7(0xe4)],_0x2573ab=_0x250e29[_0xc1a2f7(0xe4)],_0x5c9633=await profile[_0xc1a2f7(0x13d)]({'email':_0x2573ab['email']}),_0x4f3824={'year':_0xc1a2f7(0x1ca),'month':_0xc1a2f7(0x19e),'day':_0xc1a2f7(0x1ca)},_0x21b47d=await master_shop[_0xc1a2f7(0x131)]();console[_0xc1a2f7(0x12b)](_0xc1a2f7(0x1b0),_0x21b47d);const _0x544d3a=await product['find']();console[_0xc1a2f7(0x12b)](_0xc1a2f7(0x129),_0x544d3a);const _0x524658=await warehouse[_0xc1a2f7(0xcd)]([{'$unwind':_0xc1a2f7(0x177)},{'$lookup':{'from':_0xc1a2f7(0xab),'localField':_0xc1a2f7(0x1bd),'foreignField':_0xc1a2f7(0xd1),'as':_0xc1a2f7(0x159)}},{'$unwind':_0xc1a2f7(0x22d)},{'$project':{'product_name':_0xc1a2f7(0x147),'product_stock':_0xc1a2f7(0x157)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0xc1a2f7(0x1d9)}}}]);console[_0xc1a2f7(0x12b)](_0xc1a2f7(0x161),_0x524658),_0x524658[_0xc1a2f7(0x1e2)](_0x3076de=>{const _0xca39fa=_0xc1a2f7,_0x1af5e9=_0x544d3a[_0xca39fa(0xe2)](_0x533bb1=>{const _0x3e421f=_0xca39fa;_0x533bb1[_0x3e421f(0xd1)]==_0x3076de['_id']&&(_0x533bb1[_0x3e421f(0x1ac)]=parseInt(_0x533bb1['stock'])+parseInt(_0x3076de['product_stock']));});});const _0x4614bc=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x410d39=await staff['findOne']({'email':_0x2573ab[_0xc1a2f7(0x1c6)]});if(_0x21b47d[0x0][_0xc1a2f7(0x1e9)]=='English\x20(US)')var _0x94115e=users['English'];else{if(_0x21b47d[0x0][_0xc1a2f7(0x1e9)]==_0xc1a2f7(0x1d5))var _0x94115e=users[_0xc1a2f7(0x1d5)];else{if(_0x21b47d[0x0]['language']==_0xc1a2f7(0x216))var _0x94115e=users[_0xc1a2f7(0x216)];else{if(_0x21b47d[0x0]['language']==_0xc1a2f7(0xa1))var _0x94115e=users[_0xc1a2f7(0xa1)];else{if(_0x21b47d[0x0][_0xc1a2f7(0x1e9)]=='French')var _0x94115e=users[_0xc1a2f7(0xd5)];else{if(_0x21b47d[0x0]['language']=='Portuguese\x20(BR)')var _0x94115e=users[_0xc1a2f7(0x18d)];else{if(_0x21b47d[0x0][_0xc1a2f7(0x1e9)]==_0xc1a2f7(0x185))var _0x94115e=users[_0xc1a2f7(0x185)];else{if(_0x21b47d[0x0][_0xc1a2f7(0x1e9)]=='Arabic\x20(ae)')var _0x94115e=users[_0xc1a2f7(0x1f5)];}}}}}}}_0x362ba2[_0xc1a2f7(0x1fa)](_0xc1a2f7(0x143),{'success':_0x250e29[_0xc1a2f7(0x160)](_0xc1a2f7(0x219)),'errors':_0x250e29[_0xc1a2f7(0x160)](_0xc1a2f7(0x220)),'alldata':_0x544d3a,'profile':_0x5c9633,'master_shop':_0x21b47d,'role':_0x2573ab,'product_stock':_0x524658,'language':_0x94115e,'staff_arr':_0x410d39,'staff_data_all':_0x4614bc});}catch(_0x45ce17){}}),router[a0_0x2c4080(0xd4)](a0_0x2c4080(0x1fb),auth,async(_0x470f74,_0x2b3751)=>{const _0x26bb51=a0_0x2c4080;try{const {from:_0x1e8af3,to:_0x216f9c,staff_data:_0x29d4e9}=_0x470f74[_0x26bb51(0x1a1)],_0x3db86f=await Reference[_0x26bb51(0xcd)]([{'$match':{'date_include':{'$gte':_0x1e8af3,'$lte':_0x216f9c},'staff_id':_0x29d4e9}},{'$sort':{'date_include':0x1}}]);_0x2b3751['json'](_0x3db86f);}catch(_0x3f3825){_0x2b3751[_0x26bb51(0x164)](_0x3f3825);}}),router[a0_0x2c4080(0xd4)](a0_0x2c4080(0x1c7),auth,async(_0x5c78bc,_0x3755a6)=>{const _0x59151c=a0_0x2c4080;try{const {from:_0x2f97f2,to:_0x25e154}=_0x5c78bc[_0x59151c(0x1a1)],{sttaff_id:_0x47ce43}=_0x5c78bc[_0x59151c(0xe4)],_0x232212=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x2f97f2,'$lte':_0x25e154},'staff_id':_0x47ce43}},{'$sort':{'date_include':0x1}}]);_0x3755a6[_0x59151c(0x164)](_0x232212);}catch(_0x16bda3){_0x3755a6[_0x59151c(0x164)](_0x16bda3);}}),router['get'](a0_0x2c4080(0xad),auth,async(_0x23ebbb,_0x36d975)=>{const _0x6f59d8=a0_0x2c4080;try{const _0x378b0d=_0x23ebbb[_0x6f59d8(0x121)]['id'],_0x587cea=await Reference['findById'](_0x378b0d);let _0x5a8f5d='';_0x5a8f5d+=_0x587cea[_0x6f59d8(0xe9)],_0x5a8f5d+=_0x6f59d8(0xe0),_0x5a8f5d+=_0x6f59d8(0x186),_0x5a8f5d+='window.print();',_0x5a8f5d+='};',_0x5a8f5d+=_0x6f59d8(0x179),_0x36d975[_0x6f59d8(0x12a)](_0x5a8f5d);}catch(_0x40366d){_0x36d975[_0x6f59d8(0x164)](_0x40366d);}}),router['post'](a0_0x2c4080(0x221),auth,async(_0x215165,_0x5881f4)=>{const _0x258bdb=a0_0x2c4080;try{const {ref_data:_0x50b411}=_0x215165[_0x258bdb(0x1a1)],_0x284472=_0x50b411[_0x258bdb(0x145)]('~'),_0x432cdd=_0x284472[_0x258bdb(0xa7)](_0x5d5f79=>_0x5d5f79!==''),_0x4b76a6=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x432cdd}}}]),_0x8285e4=XLSX[_0x258bdb(0x1f3)]['book_new']();_0x4b76a6[_0x258bdb(0x1e2)](_0x249cf7=>{const _0x47b8f1=_0x258bdb,_0x38f3da=cheerio['load'](_0x249cf7[_0x47b8f1(0xe9)]);let _0x2c15c8=[],_0x55a895=[],_0x5617af=[];_0x38f3da(_0x47b8f1(0x20d))[_0x47b8f1(0x11a)]((_0x125fd2,_0x4fdeb2)=>{const _0x59b777=_0x47b8f1;let _0xcf8852=[],_0x35fad6=0x0;while(_0x5617af[_0x35fad6]){_0x5617af[_0x35fad6]--,_0x35fad6++;}_0x38f3da(_0x4fdeb2)[_0x59b777(0x131)](_0x59b777(0xa8))[_0x59b777(0x11a)]((_0x2fb69a,_0x46ba44)=>{const _0x5b8eab=_0x59b777;let _0x4f9448=_0x38f3da(_0x46ba44)[_0x5b8eab(0x14a)]()[_0x5b8eab(0xff)](),_0x52f50b=parseFloat(_0x4f9448[_0x5b8eab(0x215)](/,/g,''));isNaN(_0x52f50b)&&(_0x52f50b=_0x4f9448);let _0x27d50e=parseInt(_0x38f3da(_0x46ba44)[_0x5b8eab(0x11d)]('colspan'))||0x1,_0x4bf63b=parseInt(_0x38f3da(_0x46ba44)['attr']('rowspan'))||0x1;_0xcf8852[_0x35fad6]=_0x52f50b;(_0x27d50e>0x1||_0x4bf63b>0x1)&&_0x55a895[_0x5b8eab(0x175)]({'s':{'r':_0x125fd2,'c':_0x35fad6},'e':{'r':_0x125fd2+_0x4bf63b-0x1,'c':_0x35fad6+_0x27d50e-0x1}});for(let _0x9a2a0f=0x0;_0x9a2a0f<_0x27d50e;_0x9a2a0f++){_0x4bf63b>0x1&&(_0x5617af[_0x35fad6+_0x9a2a0f]=_0x4bf63b-0x1);}_0x35fad6+=_0x27d50e;}),_0x2c15c8[_0x59b777(0x175)](_0xcf8852);});const _0x216e54=XLSX[_0x47b8f1(0x1f3)]['aoa_to_sheet'](_0x2c15c8);_0x55a895[_0x47b8f1(0xc4)]>0x0&&(_0x216e54[_0x47b8f1(0x10d)]=_0x55a895),_0x216e54[_0x47b8f1(0x22a)]=_0x2c15c8[0x0][_0x47b8f1(0xe2)](()=>({'wpx':0x64})),XLSX[_0x47b8f1(0x1f3)][_0x47b8f1(0x162)](_0x8285e4,_0x216e54,_0x249cf7[_0x47b8f1(0xd7)]);});const _0x250ab0=XLSX[_0x258bdb(0x1d3)](_0x8285e4,{'bookType':'xlsx','type':_0x258bdb(0x1be)});_0x5881f4[_0x258bdb(0x229)](_0x258bdb(0xfc),_0x258bdb(0x103)),_0x5881f4[_0x258bdb(0x229)](_0x258bdb(0xae),_0x258bdb(0xcc)),_0x5881f4[_0x258bdb(0x12a)](_0x250ab0);}catch(_0x54de18){_0x5881f4[_0x258bdb(0x164)](_0x54de18);}}),router[a0_0x2c4080(0xd4)](a0_0x2c4080(0x144),auth,async(_0x169814,_0x2822fc)=>{const _0x5720e0=a0_0x2c4080,{from_date:_0x1c4888,agent_id:_0x5453e5}=_0x169814[_0x5720e0(0x1a1)],_0x356657=_0x169814[_0x5720e0(0xe4)],_0x53c8b3=await staff[_0x5720e0(0x13d)]({'email':_0x356657[_0x5720e0(0x1c6)]}),_0x515ab7=await master_shop[_0x5720e0(0x131)](),_0x3ff26a=await agentsdataDSICheck_DSRR(_0x1c4888,_0x5453e5,_0x503a98);let _0x239041='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x55e1b8=new Date(_0x1c4888);const _0x536350={'year':'numeric','month':_0x5720e0(0x19e),'day':_0x5720e0(0x1ca)},_0x318241=new Intl[(_0x5720e0(0xc6))](_0x5720e0(0x218),_0x536350)[_0x5720e0(0xea)](_0x55e1b8);_0x239041+='<div\x20class=\x22row\x22>',_0x239041+=_0x5720e0(0xd0),_0x239041+=_0x5720e0(0x137),_0x239041+=_0x3ff26a,_0x239041+=_0x5720e0(0x16e),_0x239041+=_0x5720e0(0x1a7),_0x239041+=_0x5720e0(0x1a7);let _0x4c2b98=_0x5720e0(0x204);const _0x528a6e={'width':_0x5720e0(0x11e),'height':_0x5720e0(0x13f),'orientation':_0x5720e0(0x1cf),'border':{'top':_0x5720e0(0x1aa),'right':_0x5720e0(0x1aa),'bottom':_0x5720e0(0x1aa),'left':_0x5720e0(0x1aa)},'header':{'height':_0x5720e0(0x124),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4c2b98+_0x5720e0(0x1c8)+_0x318241+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x5720e0(0x17b),'contents':{'default':_0x5720e0(0x17f)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x5720e0(0x200)}}};var _0x503a98='on';if(_0x503a98=='on'){const _0x917a14=cheerio[_0x5720e0(0xaf)](_0x239041);let _0x23f39a=[],_0x1010bf=[],_0x58b441=[];_0x917a14(_0x5720e0(0x20d))[_0x5720e0(0x11a)]((_0x40530f,_0x41e176)=>{const _0x5e431a=_0x5720e0;let _0x2f069f=[],_0x230c42=0x0;while(_0x58b441[_0x230c42]){_0x58b441[_0x230c42]--,_0x230c42++;}_0x917a14(_0x41e176)[_0x5e431a(0x131)]('td,\x20th')[_0x5e431a(0x11a)]((_0xa08c68,_0x16d1b9)=>{const _0x5566da=_0x5e431a;let _0x5a7195=_0x917a14(_0x16d1b9)[_0x5566da(0x14a)]()[_0x5566da(0xff)](),_0x3cd395=parseFloat(_0x5a7195[_0x5566da(0x215)](/,/g,''));isNaN(_0x3cd395)&&(_0x3cd395=_0x5a7195);let _0x3b07ef=parseInt(_0x917a14(_0x16d1b9)['attr'](_0x5566da(0xbc)))||0x1,_0x26b430=parseInt(_0x917a14(_0x16d1b9)[_0x5566da(0x11d)]('rowspan'))||0x1;_0x2f069f[_0x230c42]=_0x3cd395;(_0x3b07ef>0x1||_0x26b430>0x1)&&_0x1010bf[_0x5566da(0x175)]({'s':{'r':_0x40530f,'c':_0x230c42},'e':{'r':_0x40530f+_0x26b430-0x1,'c':_0x230c42+_0x3b07ef-0x1}});for(let _0x4a0a47=0x0;_0x4a0a47<_0x3b07ef;_0x4a0a47++){_0x26b430>0x1&&(_0x58b441[_0x230c42+_0x4a0a47]=_0x26b430-0x1);}_0x230c42+=_0x3b07ef;}),_0x23f39a[_0x5e431a(0x175)](_0x2f069f);});const _0x14a62c=XLSX['utils'][_0x5720e0(0xc0)](),_0x39828c=XLSX[_0x5720e0(0x1f3)]['aoa_to_sheet'](_0x23f39a);_0x1010bf['length']>0x0&&(_0x39828c[_0x5720e0(0x10d)]=_0x1010bf);_0x39828c[_0x5720e0(0x22a)]=_0x23f39a[0x0][_0x5720e0(0xe2)](()=>({'wpx':0x64})),XLSX[_0x5720e0(0x1f3)][_0x5720e0(0x162)](_0x14a62c,_0x39828c,_0x5720e0(0x21b));const _0x159d6b=XLSX[_0x5720e0(0x1d3)](_0x14a62c,{'bookType':'xlsx','type':_0x5720e0(0x1be)});_0x2822fc[_0x5720e0(0x229)]('Content-Disposition',_0x5720e0(0x19f)),_0x2822fc[_0x5720e0(0x229)]('Content-Type',_0x5720e0(0xcc)),_0x2822fc[_0x5720e0(0x12a)](_0x159d6b);}else pdf[_0x5720e0(0x158)](_0x239041,_0x528a6e)['toStream'](function(_0x5d992f,_0xfebdc1){const _0x4f29e2=_0x5720e0;if(_0x5d992f){_0x2822fc[_0x4f29e2(0x1ee)](0x1f4)[_0x4f29e2(0x12a)]('Error\x20generating\x20PDF');return;}_0x2822fc[_0x4f29e2(0x229)](_0x4f29e2(0xae),_0x4f29e2(0xa2)),_0xfebdc1['pipe'](_0x2822fc);});}),module['exports']=router;