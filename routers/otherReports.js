const a0_0x46c47e=a0_0x2fcf;(function(_0xe6cf65,_0x59af8b){const _0x4e740f=a0_0x2fcf,_0x377554=_0xe6cf65();while(!![]){try{const _0xb7dd9=parseInt(_0x4e740f(0x277))/0x1*(parseInt(_0x4e740f(0x266))/0x2)+parseInt(_0x4e740f(0x320))/0x3+parseInt(_0x4e740f(0x287))/0x4+parseInt(_0x4e740f(0x275))/0x5+parseInt(_0x4e740f(0x1c8))/0x6*(parseInt(_0x4e740f(0x303))/0x7)+-parseInt(_0x4e740f(0x23e))/0x8+-parseInt(_0x4e740f(0x2c1))/0x9;if(_0xb7dd9===_0x59af8b)break;else _0x377554['push'](_0x377554['shift']());}catch(_0x559e44){_0x377554['push'](_0x377554['shift']());}}}(a0_0x327f,0x9aa47));const express=require(a0_0x46c47e(0x1e1)),res=require(a0_0x46c47e(0x2de)),app=express(),router=express[a0_0x46c47e(0x24b)](),multer=require(a0_0x46c47e(0x261)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x46c47e(0x1e0)),auth=require('../middleware/auth'),users=require(a0_0x46c47e(0x1de)),excelJS=require('exceljs'),XLSX=require(a0_0x46c47e(0x1b1)),PDFDocument=require(a0_0x46c47e(0x202)),fs=require('fs'),blobStream=require('blob-stream'),JsBarcode=require(a0_0x46c47e(0x24a)),{Canvas}=require(a0_0x46c47e(0x1f7)),pdf=require('html-pdf'),path=require(a0_0x46c47e(0x30d)),mongoose=require('mongoose'),cheerio=require('cheerio');router[a0_0x46c47e(0x31e)](a0_0x46c47e(0x2e4),auth,async(_0x194ec1,_0x15cbac)=>{const _0x56ae27=a0_0x46c47e;try{const {username:_0x4eac65,email:_0x464ee6,role:_0x89dd5a}=_0x194ec1[_0x56ae27(0x253)],_0xd0659e=_0x194ec1[_0x56ae27(0x253)],_0x16d645=await profile[_0x56ae27(0x244)]({'email':_0xd0659e[_0x56ae27(0x228)]}),_0x4a6898={'year':'numeric','month':_0x56ae27(0x296),'day':_0x56ae27(0x242)},_0x30ddaf=await master_shop[_0x56ae27(0x1b6)]();console['log']('Products\x20master',_0x30ddaf);const _0x4bc267=await product[_0x56ae27(0x1b6)]();console['log'](_0x56ae27(0x2f7),_0x4bc267);const _0x34c609=await warehouse['aggregate']([{'$unwind':_0x56ae27(0x255)},{'$lookup':{'from':_0x56ae27(0x2dc),'localField':_0x56ae27(0x1d0),'foreignField':_0x56ae27(0x248),'as':_0x56ae27(0x1b9)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x56ae27(0x25c)}}}]);console[_0x56ae27(0x1ef)](_0x56ae27(0x1ab),_0x34c609),_0x34c609[_0x56ae27(0x1af)](_0x2e105e=>{const _0x6248e3=_0x56ae27,_0x5404ca=_0x4bc267[_0x6248e3(0x28b)](_0x3ea14f=>{const _0x51f5ae=_0x6248e3;_0x3ea14f[_0x51f5ae(0x248)]==_0x2e105e[_0x51f5ae(0x31c)]&&(_0x3ea14f['stock']=parseInt(_0x3ea14f[_0x51f5ae(0x2cb)])+parseInt(_0x2e105e[_0x51f5ae(0x222)]));});}),console[_0x56ae27(0x1ef)](_0x56ae27(0x2f7),_0x4bc267);if(_0x30ddaf[0x0][_0x56ae27(0x230)]=='English\x20(US)')var _0x2a73eb=users[_0x56ae27(0x1ae)];else{if(_0x30ddaf[0x0]['language']==_0x56ae27(0x306))var _0x2a73eb=users[_0x56ae27(0x306)];else{if(_0x30ddaf[0x0][_0x56ae27(0x230)]==_0x56ae27(0x22e))var _0x2a73eb=users[_0x56ae27(0x22e)];else{if(_0x30ddaf[0x0][_0x56ae27(0x230)]==_0x56ae27(0x292))var _0x2a73eb=users[_0x56ae27(0x292)];else{if(_0x30ddaf[0x0][_0x56ae27(0x230)]==_0x56ae27(0x213))var _0x2a73eb=users[_0x56ae27(0x213)];else{if(_0x30ddaf[0x0][_0x56ae27(0x230)]==_0x56ae27(0x1e4))var _0x2a73eb=users[_0x56ae27(0x2ad)];else{if(_0x30ddaf[0x0][_0x56ae27(0x230)]==_0x56ae27(0x1a1))var _0x2a73eb=users[_0x56ae27(0x1a1)];else{if(_0x30ddaf[0x0][_0x56ae27(0x230)]==_0x56ae27(0x31f))var _0x2a73eb=users[_0x56ae27(0x1f4)];}}}}}}}_0x15cbac['render']('balanced',{'success':_0x194ec1[_0x56ae27(0x1fb)]('success'),'errors':_0x194ec1[_0x56ae27(0x1fb)](_0x56ae27(0x25f)),'alldata':_0x4bc267,'profile':_0x16d645,'master_shop':_0x30ddaf,'role':_0xd0659e,'product_stock':_0x34c609,'language':_0x2a73eb});}catch(_0x3014d8){}});async function dataCheck(_0x523b13,_0x2c5248){const _0x422647=a0_0x46c47e,_0x3e8459=await product[_0x422647(0x1fc)]([{'$group':{'_id':{'brand':_0x422647(0x27c),'category':_0x422647(0x1ad)},'products':{'$push':{'name':_0x422647(0x278),'product_code':_0x422647(0x21e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x451f58=[];_0x451f58[_0x422647(0x1bb)]=[];for(let _0x4e552b=0x0;_0x4e552b<=_0x3e8459[_0x422647(0x241)]-0x1;_0x4e552b++){const _0x2a09b2=_0x3e8459[_0x4e552b];_0x451f58[_0x422647(0x1bb)]['push'](_0x2a09b2);}const _0x23f99e=await product[_0x422647(0x1fc)]([{'$group':{'_id':{'category':_0x422647(0x1ad)},'products':{'$push':{'brand':_0x422647(0x27c),'product_code':_0x422647(0x21e),'product_name':_0x422647(0x278)}}}},{'$sort':{'_id.category':-0x1}}]),_0x244285=await purchases_finished[_0x422647(0x1fc)]([{'$match':{'date':{'$gte':_0x523b13,'$lte':_0x2c5248}}},{'$unwind':'$product'},{'$group':{'_id':{'product_name':_0x422647(0x24e),'product_code':_0x422647(0x25e)},'totalQTY':{'$sum':_0x422647(0x24d)}}}]);_0x451f58[_0x422647(0x1a5)]=[];for(let _0x3aa78f=0x0;_0x3aa78f<=_0x244285[_0x422647(0x241)]-0x1;_0x3aa78f++){const _0x56bf3e=_0x244285[_0x3aa78f];_0x451f58[_0x422647(0x1a5)][_0x422647(0x26c)](_0x56bf3e);}const _0x3b1684=await sales_sa[_0x422647(0x1fc)]([{'$match':{'date':{'$gte':_0x523b13,'$lte':_0x2c5248}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x422647(0x2b8),'localField':_0x422647(0x263),'foreignField':_0x422647(0x31c),'as':_0x422647(0x2d9)}},{'$unwind':'$sales_info'},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x422647(0x2a6),'product_code':_0x422647(0x1a9)},'totalQTY':{'$sum':_0x422647(0x1f2)}}}]);console[_0x422647(0x1ef)](_0x3b1684[0x0]),_0x451f58[_0x422647(0x21c)]=[];for(let _0x45b535=0x0;_0x45b535<=_0x3b1684[_0x422647(0x241)]-0x1;_0x45b535++){const _0x3e0050=_0x3b1684[_0x45b535];_0x451f58[_0x422647(0x21c)][_0x422647(0x26c)](_0x3e0050);}const _0x536821=await sales_sa[_0x422647(0x1fc)]([{'$match':{'date':{'$gte':_0x523b13,'$lte':_0x2c5248}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x422647(0x1a6)}}},{'$lookup':{'from':_0x422647(0x2b8),'localField':'sales_staff_id','foreignField':_0x422647(0x31c),'as':_0x422647(0x2d9)}},{'$unwind':_0x422647(0x1c3)},{'$unwind':_0x422647(0x2e3)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x422647(0x301)}},{'$group':{'_id':{'product_name':_0x422647(0x2a6),'product_code':_0x422647(0x1a9)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'}}}]);_0x451f58[_0x422647(0x210)]=[];for(let _0x2b072e=0x0;_0x2b072e<=_0x536821['length']-0x1;_0x2b072e++){const _0x17a148=_0x536821[_0x2b072e];_0x451f58[_0x422647(0x210)][_0x422647(0x26c)](_0x17a148);}let _0x4a904d='';for(let _0x630bf4=0x0;_0x630bf4<=_0x23f99e['length']-0x1;_0x630bf4++){const _0x1ddff5=_0x23f99e[_0x630bf4];_0x4a904d+=_0x422647(0x29f),_0x4a904d+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x1ddff5[_0x422647(0x31c)]['category']+_0x422647(0x293),_0x4a904d+=_0x422647(0x25d);for(let _0x45ee03=0x0;_0x45ee03<_0x451f58[_0x422647(0x1bb)][_0x422647(0x241)];_0x45ee03++){const _0x25b301=_0x451f58[_0x422647(0x1bb)][_0x45ee03];if(_0x25b301[_0x422647(0x31c)][_0x422647(0x2b3)]==_0x1ddff5[_0x422647(0x31c)]['category']){let _0xc91c04=[],_0x572b77=[],_0x184dad=[];_0xc91c04[_0x25b301[_0x422647(0x31c)][_0x422647(0x2c7)]]=[],_0x572b77[_0x25b301[_0x422647(0x31c)][_0x422647(0x2c7)]]=[],_0x184dad[_0x25b301['_id'][_0x422647(0x2c7)]]=[];var _0x3de97e=0x0,_0x5a8e86=0x0,_0x5d36a7=0x0;for(let _0x4ae9d0=0x0;_0x4ae9d0<_0x25b301[_0x422647(0x2dc)][_0x422647(0x241)];_0x4ae9d0++){const _0x5ebe83=_0x25b301[_0x422647(0x2dc)][_0x4ae9d0];for(let _0x237000=0x0;_0x237000<=_0x451f58[_0x422647(0x1a5)][_0x422647(0x241)]-0x1;_0x237000++){const _0x2c2478=_0x451f58[_0x422647(0x1a5)][_0x237000];_0x2c2478[_0x422647(0x31c)][_0x422647(0x302)]==_0x5ebe83[_0x422647(0x248)]&&_0x2c2478[_0x422647(0x31c)]['product_code']==_0x5ebe83[_0x422647(0x2cd)]&&(_0x3de97e+=parseInt(_0x2c2478[_0x422647(0x298)],0xa));}for(let _0x13799e=0x0;_0x13799e<=_0x451f58[_0x422647(0x210)][_0x422647(0x241)]-0x1;_0x13799e++){const _0xeced64=_0x451f58[_0x422647(0x210)][_0x13799e];_0xeced64[_0x422647(0x31c)][_0x422647(0x302)]==_0x5ebe83[_0x422647(0x248)]&&_0xeced64['_id'][_0x422647(0x2cd)]==_0x5ebe83['product_code']&&(_0x5a8e86+=parseFloat(_0xeced64[_0x422647(0x298)],0xa)[_0x422647(0x1b2)](0x2));}for(let _0x2ba89d=0x0;_0x2ba89d<=_0x451f58[_0x422647(0x21c)][_0x422647(0x241)]-0x1;_0x2ba89d++){const _0x1e62d4=_0x451f58[_0x422647(0x21c)][_0x2ba89d];_0x1e62d4['_id'][_0x422647(0x302)]==_0x5ebe83[_0x422647(0x248)]&&_0x1e62d4[_0x422647(0x31c)]['product_code']==_0x5ebe83[_0x422647(0x2cd)]&&(_0x5d36a7+=parseInt(_0x1e62d4[_0x422647(0x298)],0xa));}}const _0x127ed0=new Intl['NumberFormat']('en-US');var _0xd4d42c=_0x127ed0['format'](_0x3de97e);_0xc91c04[_0x25b301[_0x422647(0x31c)][_0x422647(0x2c7)]][_0x422647(0x26c)](_0xd4d42c),_0x572b77[_0x25b301[_0x422647(0x31c)]['brand']][_0x422647(0x26c)](_0x127ed0[_0x422647(0x2f5)](_0x5a8e86)),_0x184dad[_0x25b301[_0x422647(0x31c)][_0x422647(0x2c7)]][_0x422647(0x26c)](_0x127ed0[_0x422647(0x2f5)](_0x5d36a7));var _0x1b1738=_0x127ed0[_0x422647(0x2f5)](_0x3de97e-(_0x5d36a7+_0x5a8e86));_0x4a904d+=_0x422647(0x29f),_0x4a904d+='<td\x20class=\x22row_data\x22></td>',_0x4a904d+=_0x422647(0x2f0)+_0x25b301[_0x422647(0x31c)][_0x422647(0x2c7)]+_0x422647(0x293),_0x4a904d+=_0x422647(0x2f0)+_0xc91c04[_0x25b301[_0x422647(0x31c)][_0x422647(0x2c7)]][0x0]+'</td>',_0x4a904d+='<td\x20class=\x22row_data\x22>0</td>',_0x4a904d+=_0x422647(0x2f0)+_0x184dad[_0x25b301[_0x422647(0x31c)][_0x422647(0x2c7)]][0x0]+_0x422647(0x293),_0x4a904d+=_0x422647(0x2f0)+_0x572b77[_0x25b301[_0x422647(0x31c)]['brand']][0x0]+_0x422647(0x293),_0x4a904d+=_0x422647(0x2f0)+_0x1b1738+_0x422647(0x293),_0x4a904d+=_0x422647(0x25d);}}}return console[_0x422647(0x1ef)](_0x451f58['sales_bkg']),_0x4a904d;}router[a0_0x46c47e(0x321)]('/balance/pdf',auth,async(_0x5b5345,_0x18a761)=>{const _0x40852d=a0_0x46c47e,{from_date:_0x437437,to_date:_0x4031b9}=_0x5b5345[_0x40852d(0x30a)],_0x23142b=await dataCheck(_0x437437,_0x4031b9);{}let _0xc843e3=_0x40852d(0x1cf);var _0x3f3e57=new Date(_0x437437),_0x17b266=new Date(_0x4031b9);const _0x204008={'year':_0x40852d(0x242),'month':_0x40852d(0x296),'day':_0x40852d(0x242)},_0x5f1119=new Intl['DateTimeFormat'](_0x40852d(0x318),_0x204008)[_0x40852d(0x2f5)](_0x3f3e57),_0x2a0677=new Intl[(_0x40852d(0x2f2))](_0x40852d(0x318),_0x204008)[_0x40852d(0x2f5)](_0x17b266);_0xc843e3+=_0x40852d(0x209),_0xc843e3+=_0x40852d(0x2d4),_0xc843e3+=_0x40852d(0x232)+_0x5f1119+_0x40852d(0x1dd)+_0x2a0677+_0x40852d(0x312),_0xc843e3+=_0x40852d(0x23d),_0xc843e3+=_0x40852d(0x309),_0xc843e3+=_0x40852d(0x252),_0xc843e3+=_0x40852d(0x29f),_0xc843e3+=_0x40852d(0x2ec),_0xc843e3+='<th\x20rowspan=\x272\x27>Products</th>',_0xc843e3+=_0x40852d(0x21b)+_0x5f1119+_0x40852d(0x291),_0xc843e3+=_0x40852d(0x1cd),_0xc843e3+='<th\x20colspan=\x272\x27>SOLD</th>',_0xc843e3+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x2a0677+_0x40852d(0x291),_0xc843e3+=_0x40852d(0x25d),_0xc843e3+=_0x40852d(0x29f),_0xc843e3+='<th>Booking</th>',_0xc843e3+=_0x40852d(0x22a),_0xc843e3+=_0x40852d(0x25d),_0xc843e3+=_0x23142b,_0xc843e3+=_0x40852d(0x2ed),_0xc843e3+=_0x40852d(0x21d),_0xc843e3+=_0x40852d(0x21d);const _0x4543cb={'format':_0x40852d(0x233),'orientation':_0x40852d(0x243)};pdf[_0x40852d(0x1ce)](_0xc843e3,_0x4543cb)[_0x40852d(0x28e)](function(_0x3406d4,_0x5b506e){const _0x547046=_0x40852d;if(_0x3406d4){_0x18a761[_0x547046(0x2e9)](0x1f4)[_0x547046(0x259)](_0x547046(0x1d8));return;}_0x18a761[_0x547046(0x2d0)](_0x547046(0x284),_0x547046(0x1b8)),_0x5b506e['pipe'](_0x18a761);});}),router[a0_0x46c47e(0x31e)]('/agent/view',auth,async(_0x396522,_0x1b06cf)=>{const _0x50d7ff=a0_0x46c47e;try{const {username:_0x3eddad,email:_0x6052c0,role:_0x2923b1}=_0x396522[_0x50d7ff(0x253)],_0x1c5238=_0x396522[_0x50d7ff(0x253)],_0x438e2d=await profile[_0x50d7ff(0x244)]({'email':_0x1c5238[_0x50d7ff(0x228)]}),_0xfcb07a={'year':'numeric','month':_0x50d7ff(0x296),'day':_0x50d7ff(0x242)},_0x40d568=await master_shop[_0x50d7ff(0x1b6)](),_0xf4bd86=await product[_0x50d7ff(0x1b6)](),_0x57f710=await warehouse[_0x50d7ff(0x1fc)]([{'$unwind':_0x50d7ff(0x255)},{'$lookup':{'from':_0x50d7ff(0x2dc),'localField':_0x50d7ff(0x1d0),'foreignField':_0x50d7ff(0x248),'as':_0x50d7ff(0x1b9)}},{'$unwind':_0x50d7ff(0x2b9)},{'$project':{'product_name':_0x50d7ff(0x297),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x50d7ff(0x1a0),'product_stock':{'$sum':_0x50d7ff(0x25c)}}}]);if(_0x40d568[0x0]['language']==_0x50d7ff(0x288))var _0x3818e2=users['English'];else{if(_0x40d568[0x0]['language']==_0x50d7ff(0x306))var _0x3818e2=users[_0x50d7ff(0x306)];else{if(_0x40d568[0x0][_0x50d7ff(0x230)]==_0x50d7ff(0x22e))var _0x3818e2=users[_0x50d7ff(0x22e)];else{if(_0x40d568[0x0][_0x50d7ff(0x230)]==_0x50d7ff(0x292))var _0x3818e2=users[_0x50d7ff(0x292)];else{if(_0x40d568[0x0][_0x50d7ff(0x230)]==_0x50d7ff(0x213))var _0x3818e2=users['French'];else{if(_0x40d568[0x0][_0x50d7ff(0x230)]==_0x50d7ff(0x1e4))var _0x3818e2=users[_0x50d7ff(0x2ad)];else{if(_0x40d568[0x0][_0x50d7ff(0x230)]=='Chinese')var _0x3818e2=users[_0x50d7ff(0x1a1)];else{if(_0x40d568[0x0][_0x50d7ff(0x230)]==_0x50d7ff(0x31f))var _0x3818e2=users[_0x50d7ff(0x1f4)];}}}}}}}_0x1b06cf[_0x50d7ff(0x234)]('agent_sales',{'success':_0x396522[_0x50d7ff(0x1fb)](_0x50d7ff(0x231)),'errors':_0x396522[_0x50d7ff(0x1fb)]('errors'),'alldata':_0xf4bd86,'profile':_0x438e2d,'master_shop':_0x40d568,'role':_0x1c5238,'product_stock':_0x57f710,'language':_0x3818e2});}catch(_0x2e1bfb){}});async function agentsdataCheck(_0x312615,_0x47f7a1){const _0xd5413b=a0_0x46c47e,_0x35e80d=await product[_0xd5413b(0x1fc)]([{'$group':{'_id':{'brand':'$brand','category':_0xd5413b(0x1ad)},'products':{'$push':{'name':_0xd5413b(0x278),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x37a425=[];_0x37a425[_0xd5413b(0x1bb)]=[];for(let _0x2331f8=0x0;_0x2331f8<=_0x35e80d[_0xd5413b(0x241)]-0x1;_0x2331f8++){const _0x2cb41c=_0x35e80d[_0x2331f8];_0x37a425[_0xd5413b(0x1bb)][_0xd5413b(0x26c)](_0x2cb41c);}const _0x5b778c=await product['aggregate']([{'$group':{'_id':{'category':_0xd5413b(0x1ad)},'products':{'$push':{'brand':_0xd5413b(0x27c),'product_code':_0xd5413b(0x21e),'product_name':_0xd5413b(0x278)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5365fc=await product[_0xd5413b(0x1fc)]([{'$group':{'_id':{'category':_0xd5413b(0x1ad),'brand':_0xd5413b(0x27c)}}},{'$group':{'_id':_0xd5413b(0x27a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4de297=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x312615,'$lte':_0x47f7a1}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0xd5413b(0x1a6)}}},{'$lookup':{'from':_0xd5413b(0x2b8),'localField':_0xd5413b(0x263),'foreignField':'_id','as':_0xd5413b(0x2d9)}},{'$unwind':_0xd5413b(0x1c3)},{'$unwind':_0xd5413b(0x2e3)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0xd5413b(0x301)}},{'$lookup':{'from':_0xd5413b(0x2dc),'localField':_0xd5413b(0x276),'foreignField':_0xd5413b(0x2cd),'as':_0xd5413b(0x2a2)}},{'$unwind':'$product_info'},{'$group':{'_id':{'sales_id':_0xd5413b(0x207),'category':'$product_info.category','brand':'$product_info.brand'},'salesman_data':{'$first':_0xd5413b(0x2db)},'totalQTY':{'$sum':_0xd5413b(0x1ac)},'products':{'$push':{'qty':_0xd5413b(0x1ac),'product_details':{'prod_name':_0xd5413b(0x2b7),'product_code':'$product_info.product_code','category':_0xd5413b(0x315),'brand':_0xd5413b(0x310)}}}}}]);let _0x15d656='';_0x15d656+=_0xd5413b(0x29f),_0x15d656+=_0xd5413b(0x2a8),_0x15d656+=_0xd5413b(0x25d),_0x15d656+=_0xd5413b(0x29f),_0x15d656+='<td\x20class=\x22cat_data\x22></td>';for(let _0x21f4d1=0x0;_0x21f4d1<=_0x5b778c[_0xd5413b(0x241)]-0x1;_0x21f4d1++){const _0x4aa890=_0x5b778c[_0x21f4d1];for(let _0x47e5b9=0x0;_0x47e5b9<_0x5365fc[_0xd5413b(0x241)];_0x47e5b9++){const _0x9e0478=_0x5365fc[_0x47e5b9];_0x9e0478[_0xd5413b(0x31c)]==_0x4aa890['_id'][_0xd5413b(0x2b3)]&&(_0x15d656+=_0xd5413b(0x2bb)+_0x9e0478[_0xd5413b(0x1f8)]+_0xd5413b(0x2df)+_0x4aa890[_0xd5413b(0x31c)][_0xd5413b(0x2b3)]+_0xd5413b(0x293));}}_0x15d656+=_0xd5413b(0x322),_0x15d656+=_0xd5413b(0x25d),_0x15d656+=_0xd5413b(0x29f),_0x15d656+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>';for(let _0x52395f=0x0;_0x52395f<=_0x5b778c[_0xd5413b(0x241)]-0x1;_0x52395f++){const _0x5d3bc4=_0x5b778c[_0x52395f];for(let _0x30e58a=0x0;_0x30e58a<_0x37a425['cat_brand'][_0xd5413b(0x241)];_0x30e58a++){const _0x55a43c=_0x37a425[_0xd5413b(0x1bb)][_0x30e58a];_0x55a43c[_0xd5413b(0x31c)][_0xd5413b(0x2b3)]==_0x5d3bc4[_0xd5413b(0x31c)][_0xd5413b(0x2b3)]&&(_0x15d656+=_0xd5413b(0x19f)+_0x55a43c['_id']['brand']+_0xd5413b(0x293));}}_0x15d656+=_0xd5413b(0x2fe),_0x15d656+=_0xd5413b(0x25d);let _0x4685d2={'name':[],'dataqty':{}};for(let _0x2d0e44=0x0;_0x2d0e44<_0x37a425['cat_brand'][_0xd5413b(0x241)];_0x2d0e44++){const _0x340d65=_0x37a425[_0xd5413b(0x1bb)][_0x2d0e44],_0x337a22=_0x340d65[_0xd5413b(0x31c)][_0xd5413b(0x2c7)],_0x84dd0e=_0x340d65['_id'][_0xd5413b(0x2b3)];!_0x4685d2[_0xd5413b(0x2dd)][_0x337a22]&&(_0x4685d2[_0xd5413b(0x2dd)][_0x337a22]={});!_0x4685d2['dataqty'][_0x337a22][_0x84dd0e]&&(_0x4685d2[_0xd5413b(0x2dd)][_0x337a22][_0x84dd0e]=[]);for(let _0x51e1ef=0x0;_0x51e1ef<_0x4de297[_0xd5413b(0x241)];_0x51e1ef++){const _0x470ec6=_0x4de297[_0x51e1ef];if(_0x337a22===_0x470ec6[_0xd5413b(0x31c)][_0xd5413b(0x2c7)]&&_0x84dd0e===_0x470ec6[_0xd5413b(0x31c)][_0xd5413b(0x2b3)]){const _0x1cbb0c=_0x470ec6['salesman_data'];!_0x4685d2[_0xd5413b(0x2dd)][_0x337a22][_0x84dd0e][_0x1cbb0c]&&(_0x4685d2['dataqty'][_0x337a22][_0x84dd0e][_0x1cbb0c]=[]),_0x4685d2[_0xd5413b(0x2dd)][_0x337a22][_0x84dd0e][_0x1cbb0c][_0xd5413b(0x26c)](_0x470ec6['totalQTY']),!_0x4685d2[_0xd5413b(0x248)][_0xd5413b(0x1be)](_0x1cbb0c)&&_0x4685d2[_0xd5413b(0x248)]['push'](_0x1cbb0c);}}}_0x15d656+=_0xd5413b(0x29f);for(let _0x241637=0x0;_0x241637<=_0x4685d2[_0xd5413b(0x248)][_0xd5413b(0x241)]-0x1;_0x241637++){const _0x13561e=_0x4685d2['name'][_0x241637];_0x15d656+=_0xd5413b(0x2f0)+_0x13561e+_0xd5413b(0x293);var _0x248a56=0x0,_0x33569f=0x0;for(let _0x112688=0x0;_0x112688<=_0x37a425[_0xd5413b(0x1bb)][_0xd5413b(0x241)]-0x1;_0x112688++){const _0x52cadc=_0x37a425[_0xd5413b(0x1bb)][_0x112688];var _0xde2a3c=0x0;_0x4685d2[_0xd5413b(0x2dd)][_0x52cadc['_id'][_0xd5413b(0x2c7)]][_0x52cadc[_0xd5413b(0x31c)][_0xd5413b(0x2b3)]][_0x13561e]?(_0xde2a3c=_0x4685d2['dataqty'][_0x52cadc['_id'][_0xd5413b(0x2c7)]][_0x52cadc[_0xd5413b(0x31c)]['category']][_0x13561e][0x0],_0x15d656+=_0xd5413b(0x2f0)+formatNumber(_0xde2a3c[_0xd5413b(0x1b2)](0x2))+_0xd5413b(0x293)):(_0xde2a3c=0x0,_0x15d656+='<td\x20class=\x22row_data\x22>'+_0xde2a3c+'</td>'),_0x248a56+=_0xde2a3c;}_0x15d656+=_0xd5413b(0x2f0)+formatNumber(_0x248a56[_0xd5413b(0x1b2)](0x2))+_0xd5413b(0x293);}return _0x15d656+='</tr>',_0x15d656;}router[a0_0x46c47e(0x321)]('/agent/pdf',auth,async(_0x2d78c2,_0x424920)=>{const _0x15364c=a0_0x46c47e,{from_date:_0x7c15b9,to_date:_0x2d7dfb}=_0x2d78c2[_0x15364c(0x30a)],_0x2a5b8c=await agentsdataCheck(_0x7c15b9,_0x2d7dfb);{}let _0x2cfe15=_0x15364c(0x1a8);var _0x10da7c=new Date(_0x7c15b9),_0x432b2d=new Date(_0x2d7dfb);const _0xe8fb34={'year':_0x15364c(0x242),'month':_0x15364c(0x296),'day':_0x15364c(0x242)},_0x400120=new Intl[(_0x15364c(0x2f2))](_0x15364c(0x318),_0xe8fb34)[_0x15364c(0x2f5)](_0x10da7c),_0x1f4d69=new Intl[(_0x15364c(0x2f2))](_0x15364c(0x318),_0xe8fb34)[_0x15364c(0x2f5)](_0x432b2d);_0x2cfe15+=_0x15364c(0x209),_0x2cfe15+=_0x15364c(0x23c),_0x2cfe15+=_0x15364c(0x232)+_0x400120+_0x15364c(0x1dd)+_0x1f4d69+'</p>',_0x2cfe15+=_0x15364c(0x23d),_0x2cfe15+='<div\x20class=\x22col-sm-11\x22>',_0x2cfe15+=_0x15364c(0x252),_0x2cfe15+=_0x2a5b8c,_0x2cfe15+=_0x15364c(0x2ed),_0x2cfe15+=_0x15364c(0x21d),_0x2cfe15+=_0x15364c(0x21d);const _0x27a38f={'format':_0x15364c(0x233),'orientation':_0x15364c(0x243)};pdf['create'](_0x2cfe15,_0x27a38f)[_0x15364c(0x28e)](function(_0x59735e,_0x2b3c5f){const _0x404aec=_0x15364c;if(_0x59735e){_0x424920[_0x404aec(0x2e9)](0x1f4)[_0x404aec(0x259)](_0x404aec(0x1d8));return;}_0x424920['setHeader'](_0x404aec(0x284),'application/pdf'),_0x2b3c5f[_0x404aec(0x279)](_0x424920);});}),router[a0_0x46c47e(0x31e)](a0_0x46c47e(0x2cc),auth,async(_0x4d43ba,_0xf13986)=>{const _0x2b0904=a0_0x46c47e;try{const {username:_0x1f3d36,email:_0x48bfce,role:_0x4a10ca}=_0x4d43ba[_0x2b0904(0x253)],_0x170d43=_0x4d43ba[_0x2b0904(0x253)],_0x296148=await profile[_0x2b0904(0x244)]({'email':_0x170d43['email']}),_0x34d83a={'year':'numeric','month':_0x2b0904(0x296),'day':_0x2b0904(0x242)},_0x2e9f16=await master_shop['find'](),_0x1686e3=await staff['findOne']({'email':_0x170d43[_0x2b0904(0x228)]}),_0x789639=await product[_0x2b0904(0x1b6)](),_0x45dea7=await warehouse[_0x2b0904(0x1fc)]([{'$unwind':_0x2b0904(0x255)},{'$lookup':{'from':_0x2b0904(0x2dc),'localField':_0x2b0904(0x1d0),'foreignField':_0x2b0904(0x248),'as':_0x2b0904(0x1b9)}},{'$unwind':_0x2b0904(0x2b9)},{'$project':{'product_name':_0x2b0904(0x297),'product_stock':_0x2b0904(0x237)}},{'$group':{'_id':_0x2b0904(0x1a0),'product_stock':{'$sum':_0x2b0904(0x25c)}}}]),_0x3a23a0=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x2e9f16[0x0][_0x2b0904(0x230)]=='English\x20(US)')var _0x8d7b25=users[_0x2b0904(0x1ae)];else{if(_0x2e9f16[0x0][_0x2b0904(0x230)]==_0x2b0904(0x306))var _0x8d7b25=users[_0x2b0904(0x306)];else{if(_0x2e9f16[0x0][_0x2b0904(0x230)]==_0x2b0904(0x22e))var _0x8d7b25=users[_0x2b0904(0x22e)];else{if(_0x2e9f16[0x0][_0x2b0904(0x230)]==_0x2b0904(0x292))var _0x8d7b25=users[_0x2b0904(0x292)];else{if(_0x2e9f16[0x0][_0x2b0904(0x230)]==_0x2b0904(0x213))var _0x8d7b25=users[_0x2b0904(0x213)];else{if(_0x2e9f16[0x0]['language']==_0x2b0904(0x1e4))var _0x8d7b25=users['Portuguese'];else{if(_0x2e9f16[0x0][_0x2b0904(0x230)]==_0x2b0904(0x1a1))var _0x8d7b25=users[_0x2b0904(0x1a1)];else{if(_0x2e9f16[0x0][_0x2b0904(0x230)]==_0x2b0904(0x31f))var _0x8d7b25=users[_0x2b0904(0x1f4)];}}}}}}}_0xf13986[_0x2b0904(0x234)]('dsi_sales_admin',{'success':_0x4d43ba[_0x2b0904(0x1fb)](_0x2b0904(0x231)),'errors':_0x4d43ba[_0x2b0904(0x1fb)](_0x2b0904(0x25f)),'alldata':_0x789639,'profile':_0x296148,'master_shop':_0x2e9f16,'role':_0x170d43,'product_stock':_0x45dea7,'language':_0x8d7b25,'staff_arr':_0x1686e3,'staff_data_all':_0x3a23a0});}catch(_0x1c9a23){_0xf13986['json'](_0x1c9a23);}});async function agentsdataDSICheck_admin(_0x3569ee,_0x244d47,_0x33c2f9,_0x51d300){const _0x3c5ceb=a0_0x46c47e,_0x34b421=await product[_0x3c5ceb(0x1fc)]([{'$group':{'_id':{'brand':'$brand','category':_0x3c5ceb(0x1ad)},'products':{'$push':{'name':'$name','product_code':_0x3c5ceb(0x21e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1b2127=[];_0x1b2127['cat_brand']=[];for(let _0x316cfc=0x0;_0x316cfc<=_0x34b421[_0x3c5ceb(0x241)]-0x1;_0x316cfc++){const _0x3f2e2f=_0x34b421[_0x316cfc];_0x1b2127[_0x3c5ceb(0x1bb)][_0x3c5ceb(0x26c)](_0x3f2e2f);}const _0x551344=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x3c5ceb(0x27c),'product_code':'$product_code','product_name':_0x3c5ceb(0x278)}}}},{'$sort':{'_id.category':-0x1}}]),_0x32e721=await product[_0x3c5ceb(0x1fc)]([{'$group':{'_id':{'category':_0x3c5ceb(0x1ad),'brand':_0x3c5ceb(0x27c)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2f5f31=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3569ee,'$lte':_0x244d47},'sales_staff_id':_0x33c2f9,'sale_product.isFG':_0x3c5ceb(0x301)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x3c5ceb(0x301)}},{'$lookup':{'from':_0x3c5ceb(0x2dc),'localField':'sale_product.product_code','foreignField':_0x3c5ceb(0x2cd),'as':_0x3c5ceb(0x2a2)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x3c5ceb(0x2e6),'date':_0x3c5ceb(0x1fe),'customer':_0x3c5ceb(0x2f4)},'totalQty':{'$sum':_0x3c5ceb(0x1ac)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x3c5ceb(0x225),'discount':_0x3c5ceb(0x1f5),'adj_discount':_0x3c5ceb(0x1c1),'product_details':{'prod_name':'$product_info.name','product_code':_0x3c5ceb(0x1cb),'category':'$product_info.category','brand':'$product_info.brand','gross_price':_0x3c5ceb(0x2bc)}}}}},{'$unwind':_0x3c5ceb(0x1d5)},{'$group':{'_id':{'dsi':_0x3c5ceb(0x236),'date':_0x3c5ceb(0x29e),'customer':_0x3c5ceb(0x2ef),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x3c5ceb(0x21f),_0x3c5ceb(0x2c0)]}},'NetPrice':{'$sum':_0x3c5ceb(0x2ee)},'discount':{'$sum':_0x3c5ceb(0x224)},'adj_discount':{'$sum':_0x3c5ceb(0x265)},'product_details':{'$first':_0x3c5ceb(0x283)}}},{'$group':{'_id':{'dsi':_0x3c5ceb(0x236),'date':_0x3c5ceb(0x29e),'customer':_0x3c5ceb(0x2ef)},'totalQty':{'$sum':_0x3c5ceb(0x2d7)},'totalGross':{'$sum':_0x3c5ceb(0x250)},'NetPrice':{'$sum':_0x3c5ceb(0x1db)},'discount':{'$sum':_0x3c5ceb(0x304)},'adj_discount':{'$sum':_0x3c5ceb(0x2b0)},'products':{'$push':{'qty':_0x3c5ceb(0x2d7),'category':_0x3c5ceb(0x27a),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x5ba7e3=[],_0x477cb5={},_0x14235f={},_0x47c60a={};var _0x3beb10=0x0,_0xeefd60=0x0,_0x42215e=0x0,_0x44df43=0x0,_0x3810ee=0x0;const _0x3c4108=0x6;for(let _0x5454ee=0x0;_0x5454ee<=_0x2f5f31[_0x3c5ceb(0x241)]-0x1;_0x5454ee++){const _0xebac3e=_0x2f5f31[_0x5454ee];let _0x727d9c=_0x3c5ceb(0x29f);_0x727d9c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xebac3e['_id'][_0x3c5ceb(0x22b)]+_0x3c5ceb(0x293),_0x727d9c+=_0x3c5ceb(0x31a)+_0xebac3e[_0x3c5ceb(0x31c)][_0x3c5ceb(0x280)]+'</td>',_0x727d9c+=_0x3c5ceb(0x31a)+_0xebac3e[_0x3c5ceb(0x31c)][_0x3c5ceb(0x2b1)]+_0x3c5ceb(0x293);let _0x1be9a7={};var _0x107ba6=0x0;for(let _0x3d1a53=0x0;_0x3d1a53<=_0xebac3e[_0x3c5ceb(0x2dc)][_0x3c5ceb(0x241)]-0x1;_0x3d1a53++){const _0x3dbca5=_0xebac3e['products'][_0x3d1a53];_0x1be9a7[_0x3dbca5[_0x3c5ceb(0x2c7)]+'-'+_0x3dbca5['category']]=_0x3dbca5[_0x3c5ceb(0x269)];const _0x3625fa=_0x3dbca5[_0x3c5ceb(0x2c7)]+'-'+_0x3dbca5[_0x3c5ceb(0x2b3)];!_0x477cb5[_0x3625fa]&&(_0x477cb5[_0x3625fa]=0x0),!Array[_0x3c5ceb(0x2fc)](_0x47c60a[_0x3625fa])&&(_0x47c60a[_0x3625fa]=[]),!Array[_0x3c5ceb(0x2fc)](_0x47c60a[_0x3625fa])&&(_0x47c60a[_0x3625fa]=[]),_0x477cb5[_0x3625fa]+=_0x3dbca5[_0x3c5ceb(0x269)],_0x47c60a[_0x3625fa]['push'](_0x3dbca5[_0x3c5ceb(0x269)]),_0x107ba6++;}console[_0x3c5ceb(0x1ef)](_0xebac3e);for(let _0x2bd1c8=0x0;_0x2bd1c8<=_0x1b2127['cat_brand'][_0x3c5ceb(0x241)]-0x1;_0x2bd1c8++){const _0x510d8e=_0x1b2127['cat_brand'][_0x2bd1c8],_0xa072c0=_0x510d8e[_0x3c5ceb(0x31c)][_0x3c5ceb(0x2c7)]+'-'+_0x510d8e[_0x3c5ceb(0x31c)][_0x3c5ceb(0x2b3)];_0x727d9c+=_0x3c5ceb(0x31d)+(_0x1be9a7[_0xa072c0]!==undefined?_0x1be9a7[_0xa072c0][_0x3c5ceb(0x1b2)](0x2):'')+_0x3c5ceb(0x293);}_0x42215e=_0xebac3e[_0x3c5ceb(0x1e9)]+_0xebac3e[_0x3c5ceb(0x2b6)],_0x727d9c+=_0x3c5ceb(0x2a0)+formatNumber(parseFloat(_0xebac3e[_0x3c5ceb(0x26b)],0x2)['toFixed'](0x2))+_0x3c5ceb(0x293),_0x727d9c+=_0x3c5ceb(0x2a0)+formatNumber(_0xebac3e[_0x3c5ceb(0x23b)]['toFixed'](0x2))+'</td>',_0x727d9c+=_0x3c5ceb(0x2a0)+formatNumber(_0x42215e)+_0x3c5ceb(0x293),_0x727d9c+=_0x3c5ceb(0x2a0)+formatNumber(_0xebac3e['NetPrice']['toFixed'](0x2))+_0x3c5ceb(0x293),_0x727d9c+=_0x3c5ceb(0x25d),_0x3beb10+=parseFloat(_0xebac3e['totalQty']['toFixed'](0x2)),_0xeefd60+=parseFloat(_0xebac3e[_0x3c5ceb(0x1da)]['toFixed'](0x2)),_0x44df43+=_0x42215e,_0x3810ee+=parseFloat(_0xebac3e[_0x3c5ceb(0x23b)][_0x3c5ceb(0x1b2)](0x2));if(_0x5454ee==_0x2f5f31[_0x3c5ceb(0x241)]-0x1){_0x727d9c+=_0x3c5ceb(0x29f),_0x727d9c+=_0x3c5ceb(0x29a),_0x727d9c+=_0x3c5ceb(0x293);for(let _0xb94a16=0x0;_0xb94a16<=_0x1b2127[_0x3c5ceb(0x1bb)][_0x3c5ceb(0x241)]-0x1;_0xb94a16++){const _0x36a7f0=_0x1b2127['cat_brand'][_0xb94a16],_0x5c283e=_0x36a7f0[_0x3c5ceb(0x31c)][_0x3c5ceb(0x2c7)]+'-'+_0x36a7f0[_0x3c5ceb(0x31c)]['category'],_0x2dd7a5=_0x47c60a[_0x5c283e][_0x3c5ceb(0x27d)]((_0x3f1d05,_0x21d45f)=>_0x3f1d05+_0x21d45f,0x0);console[_0x3c5ceb(0x1ef)](_0x3c5ceb(0x30e),_0x5c283e),_0x727d9c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x2dd7a5!==undefined?formatNumber(_0x2dd7a5[_0x3c5ceb(0x1b2)](0x2)):'')+'</b></td>',console['log'](_0x47c60a[_0x5c283e][_0x3c5ceb(0x27d)]((_0x575861,_0x1cb937)=>_0x575861+_0x1cb937,0x0));}_0x727d9c+=_0x3c5ceb(0x1d2)+formatNumber(_0x3beb10[_0x3c5ceb(0x1b2)](0x2))+_0x3c5ceb(0x2c9),_0x727d9c+=_0x3c5ceb(0x1d2)+formatNumber(_0x3810ee)+'</b></td>',_0x727d9c+=_0x3c5ceb(0x1d2)+formatNumber(_0x44df43)+'</b></td>',_0x727d9c+=_0x3c5ceb(0x1d2)+formatNumber(_0xeefd60)+'</b></td>',_0x727d9c+=_0x3c5ceb(0x25d);}_0x5ba7e3['push'](_0x727d9c);}function _0x4894ea(_0x13ad8a,_0x535316){const _0x223e3a=_0x3c5ceb,_0x1c5e0e=[];for(let _0x31cbbe=0x0;_0x31cbbe<=_0x13ad8a[_0x223e3a(0x241)]-0x1;_0x31cbbe+=_0x535316){_0x1c5e0e[_0x223e3a(0x26c)](_0x13ad8a[_0x223e3a(0x2e5)](_0x31cbbe,_0x31cbbe+_0x535316));}return _0x1c5e0e;}const _0x230672=_0x4894ea(_0x5ba7e3,_0x3c4108);let _0x4400a2='';return _0x230672[_0x3c5ceb(0x1af)]((_0x38ed59,_0x1173f4)=>{const _0x182ec1=_0x3c5ceb;_0x1173f4>0x0&&(_0x4400a2+=_0x182ec1(0x1bd));_0x4400a2+=_0x182ec1(0x252),_0x4400a2+='<thead>',_0x4400a2+='<tr>',_0x4400a2+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4400a2+=_0x182ec1(0x25d),_0x4400a2+='<tr>',_0x4400a2+=_0x182ec1(0x1a2);for(let _0x5525bd=0x0;_0x5525bd<=_0x551344[_0x182ec1(0x241)]-0x1;_0x5525bd++){const _0x3ce43d=_0x551344[_0x5525bd];for(let _0x4dfbd4=0x0;_0x4dfbd4<_0x32e721[_0x182ec1(0x241)];_0x4dfbd4++){const _0x312340=_0x32e721[_0x4dfbd4];_0x312340[_0x182ec1(0x31c)]===_0x3ce43d[_0x182ec1(0x31c)][_0x182ec1(0x2b3)]&&(_0x4400a2+='<td\x20colspan=\x22'+_0x312340['brandCount']+_0x182ec1(0x2df)+_0x3ce43d[_0x182ec1(0x31c)][_0x182ec1(0x2b3)]+_0x182ec1(0x293));}}_0x4400a2+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x4400a2+=_0x182ec1(0x25d),_0x4400a2+=_0x182ec1(0x29f),_0x4400a2+=_0x182ec1(0x203),_0x4400a2+=_0x182ec1(0x1b0),_0x4400a2+=_0x182ec1(0x1ee);for(let _0x8bd6ee=0x0;_0x8bd6ee<=_0x551344[_0x182ec1(0x241)]-0x1;_0x8bd6ee++){const _0x5b4e7e=_0x551344[_0x8bd6ee];for(let _0x1e61c8=0x0;_0x1e61c8<_0x1b2127[_0x182ec1(0x1bb)][_0x182ec1(0x241)];_0x1e61c8++){const _0x3c8c46=_0x1b2127[_0x182ec1(0x1bb)][_0x1e61c8];_0x3c8c46[_0x182ec1(0x31c)][_0x182ec1(0x2b3)]===_0x5b4e7e['_id'][_0x182ec1(0x2b3)]&&(_0x4400a2+=_0x182ec1(0x19f)+_0x3c8c46[_0x182ec1(0x31c)][_0x182ec1(0x2c7)]+'</td>');}}_0x4400a2+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x4400a2+=_0x182ec1(0x220),_0x4400a2+=_0x182ec1(0x264),_0x4400a2+=_0x182ec1(0x313),_0x4400a2+=_0x182ec1(0x25d),_0x4400a2+='</thead>',_0x4400a2+='<tbody>',_0x38ed59[_0x182ec1(0x1af)](_0x2c60cd=>{_0x4400a2+=_0x2c60cd;}),console['log'](_0x47c60a),_0x4400a2+=_0x182ec1(0x212),_0x4400a2+=_0x182ec1(0x2ed);}),_0x4400a2;}async function agentsdataDSICheck_admin_excel(_0x439906,_0x1dafae,_0x19547d,_0x3c032c){const _0x1a1a9b=a0_0x46c47e,_0x1b9584=await product[_0x1a1a9b(0x1fc)]([{'$group':{'_id':{'brand':'$brand','category':_0x1a1a9b(0x1ad)},'products':{'$push':{'name':_0x1a1a9b(0x278),'product_code':_0x1a1a9b(0x21e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5c8442=[];_0x5c8442[_0x1a1a9b(0x1bb)]=[];for(let _0x24c408=0x0;_0x24c408<=_0x1b9584[_0x1a1a9b(0x241)]-0x1;_0x24c408++){const _0x3a098b=_0x1b9584[_0x24c408];_0x5c8442[_0x1a1a9b(0x1bb)][_0x1a1a9b(0x26c)](_0x3a098b);}const _0x335e37=await product[_0x1a1a9b(0x1fc)]([{'$group':{'_id':{'category':_0x1a1a9b(0x1ad)},'products':{'$push':{'brand':_0x1a1a9b(0x27c),'product_code':_0x1a1a9b(0x21e),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1d573c=await product['aggregate']([{'$group':{'_id':{'category':_0x1a1a9b(0x1ad),'brand':_0x1a1a9b(0x27c)}}},{'$group':{'_id':_0x1a1a9b(0x27a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3a1ff5=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x439906,'$lte':_0x1dafae},'sales_staff_id':_0x19547d,'sale_product.isFG':_0x1a1a9b(0x301)}},{'$unwind':_0x1a1a9b(0x2e3)},{'$match':{'sale_product.isFG':_0x1a1a9b(0x301)}},{'$lookup':{'from':_0x1a1a9b(0x2dc),'localField':_0x1a1a9b(0x276),'foreignField':_0x1a1a9b(0x2cd),'as':_0x1a1a9b(0x2a2)}},{'$unwind':_0x1a1a9b(0x1d3)},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':_0x1a1a9b(0x2f4)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x1a1a9b(0x1ac),'NetPrice':_0x1a1a9b(0x225),'discount':_0x1a1a9b(0x1f5),'adj_discount':_0x1a1a9b(0x1c1),'product_details':{'prod_name':'$product_info.name','product_code':_0x1a1a9b(0x1cb),'category':_0x1a1a9b(0x315),'brand':_0x1a1a9b(0x310),'gross_price':_0x1a1a9b(0x2bc)}}}}},{'$unwind':_0x1a1a9b(0x1d5)},{'$group':{'_id':{'dsi':_0x1a1a9b(0x236),'date':_0x1a1a9b(0x29e),'customer':'$_id.customer','category':_0x1a1a9b(0x317),'brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x1a1a9b(0x21f),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x1a1a9b(0x2ee)},'discount':{'$sum':_0x1a1a9b(0x224)},'adj_discount':{'$sum':_0x1a1a9b(0x265)},'product_details':{'$first':_0x1a1a9b(0x283)}}},{'$group':{'_id':{'dsi':_0x1a1a9b(0x236),'date':_0x1a1a9b(0x29e),'customer':_0x1a1a9b(0x2ef)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x1a1a9b(0x1db)},'discount':{'$sum':_0x1a1a9b(0x304)},'adj_discount':{'$sum':_0x1a1a9b(0x2b0)},'products':{'$push':{'qty':_0x1a1a9b(0x2d7),'category':_0x1a1a9b(0x27a),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x3271aa=[],_0x534166={},_0x95f6b6={},_0x2e9d17={};var _0xc4315a=0x0,_0x18fcb5=0x0,_0xc184d=0x0,_0x5dbb12=0x0,_0x268527=0x0;const _0x11fb9b=0x16345785d8a0000;for(let _0x5a15c8=0x0;_0x5a15c8<=_0x3a1ff5['length']-0x1;_0x5a15c8++){const _0x11a97a=_0x3a1ff5[_0x5a15c8];let _0xf6537e=_0x1a1a9b(0x29f);_0xf6537e+=_0x1a1a9b(0x31a)+_0x11a97a[_0x1a1a9b(0x31c)][_0x1a1a9b(0x22b)]+_0x1a1a9b(0x293),_0xf6537e+=_0x1a1a9b(0x31a)+_0x11a97a[_0x1a1a9b(0x31c)][_0x1a1a9b(0x280)]+_0x1a1a9b(0x293),_0xf6537e+=_0x1a1a9b(0x31a)+_0x11a97a[_0x1a1a9b(0x31c)][_0x1a1a9b(0x2b1)]+_0x1a1a9b(0x293);let _0xb033e8={};var _0x41e266=0x0;for(let _0x172dc2=0x0;_0x172dc2<=_0x11a97a['products'][_0x1a1a9b(0x241)]-0x1;_0x172dc2++){const _0x4cf523=_0x11a97a[_0x1a1a9b(0x2dc)][_0x172dc2];_0xb033e8[_0x4cf523[_0x1a1a9b(0x2c7)]+'-'+_0x4cf523[_0x1a1a9b(0x2b3)]]=_0x4cf523['qty'];const _0xb5fcc=_0x4cf523[_0x1a1a9b(0x2c7)]+'-'+_0x4cf523['category'];!_0x534166[_0xb5fcc]&&(_0x534166[_0xb5fcc]=0x0),!Array[_0x1a1a9b(0x2fc)](_0x2e9d17[_0xb5fcc])&&(_0x2e9d17[_0xb5fcc]=[]),!Array[_0x1a1a9b(0x2fc)](_0x2e9d17[_0xb5fcc])&&(_0x2e9d17[_0xb5fcc]=[]),_0x534166[_0xb5fcc]+=_0x4cf523[_0x1a1a9b(0x269)],_0x2e9d17[_0xb5fcc][_0x1a1a9b(0x26c)](_0x4cf523[_0x1a1a9b(0x269)]),_0x41e266++;}console['log'](_0x11a97a);for(let _0x144775=0x0;_0x144775<=_0x5c8442[_0x1a1a9b(0x1bb)][_0x1a1a9b(0x241)]-0x1;_0x144775++){const _0x46f3dc=_0x5c8442[_0x1a1a9b(0x1bb)][_0x144775],_0x1fcb70=_0x46f3dc[_0x1a1a9b(0x31c)][_0x1a1a9b(0x2c7)]+'-'+_0x46f3dc[_0x1a1a9b(0x31c)]['category'];_0xf6537e+=_0x1a1a9b(0x31d)+(_0xb033e8[_0x1fcb70]!==undefined?_0xb033e8[_0x1fcb70][_0x1a1a9b(0x1b2)](0x2):'')+_0x1a1a9b(0x293);}_0xc184d=_0x11a97a['discount']+_0x11a97a[_0x1a1a9b(0x2b6)],_0xf6537e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x11a97a[_0x1a1a9b(0x26b)],0x2)[_0x1a1a9b(0x1b2)](0x2))+_0x1a1a9b(0x293),_0xf6537e+=_0x1a1a9b(0x2a0)+formatNumber(_0x11a97a[_0x1a1a9b(0x23b)][_0x1a1a9b(0x1b2)](0x2))+_0x1a1a9b(0x293),_0xf6537e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xc184d)+_0x1a1a9b(0x293),_0xf6537e+=_0x1a1a9b(0x2a0)+formatNumber(_0x11a97a[_0x1a1a9b(0x1da)][_0x1a1a9b(0x1b2)](0x2))+_0x1a1a9b(0x293),_0xf6537e+=_0x1a1a9b(0x25d),_0xc4315a+=parseFloat(_0x11a97a[_0x1a1a9b(0x26b)][_0x1a1a9b(0x1b2)](0x2)),_0x18fcb5+=parseFloat(_0x11a97a[_0x1a1a9b(0x1da)]['toFixed'](0x2)),_0x5dbb12+=_0xc184d,_0x268527+=parseFloat(_0x11a97a[_0x1a1a9b(0x23b)][_0x1a1a9b(0x1b2)](0x2));if(_0x5a15c8==_0x3a1ff5[_0x1a1a9b(0x241)]-0x1){_0xf6537e+=_0x1a1a9b(0x29f),_0xf6537e+=_0x1a1a9b(0x29a),_0xf6537e+=_0x1a1a9b(0x293);for(let _0x4237de=0x0;_0x4237de<=_0x5c8442[_0x1a1a9b(0x1bb)][_0x1a1a9b(0x241)]-0x1;_0x4237de++){const _0x3ab756=_0x5c8442[_0x1a1a9b(0x1bb)][_0x4237de],_0x3c3f8b=_0x3ab756[_0x1a1a9b(0x31c)][_0x1a1a9b(0x2c7)]+'-'+_0x3ab756[_0x1a1a9b(0x31c)][_0x1a1a9b(0x2b3)],_0xfd0854=_0x2e9d17[_0x3c3f8b][_0x1a1a9b(0x27d)]((_0x239536,_0x251fb3)=>_0x239536+_0x251fb3,0x0);console[_0x1a1a9b(0x1ef)](_0x1a1a9b(0x30e),_0x3c3f8b),_0xf6537e+=_0x1a1a9b(0x2a4)+(_0xfd0854!==undefined?formatNumber(_0xfd0854[_0x1a1a9b(0x1b2)](0x2)):'')+_0x1a1a9b(0x2c9),console[_0x1a1a9b(0x1ef)](_0x2e9d17[_0x3c3f8b][_0x1a1a9b(0x27d)]((_0x3f5cb0,_0x180a96)=>_0x3f5cb0+_0x180a96,0x0));}_0xf6537e+=_0x1a1a9b(0x1d2)+formatNumber(_0xc4315a['toFixed'](0x2))+_0x1a1a9b(0x2c9),_0xf6537e+=_0x1a1a9b(0x1d2)+formatNumber(_0x268527)+'</b></td>',_0xf6537e+=_0x1a1a9b(0x1d2)+formatNumber(_0x5dbb12)+'</b></td>',_0xf6537e+=_0x1a1a9b(0x1d2)+formatNumber(_0x18fcb5)+_0x1a1a9b(0x2c9),_0xf6537e+='</tr>';}_0x3271aa['push'](_0xf6537e);}function _0x2cb38c(_0x5533f0,_0x421844){const _0x224e6d=_0x1a1a9b,_0x591fdd=[];for(let _0x3227ca=0x0;_0x3227ca<=_0x5533f0[_0x224e6d(0x241)]-0x1;_0x3227ca+=_0x421844){_0x591fdd[_0x224e6d(0x26c)](_0x5533f0[_0x224e6d(0x2e5)](_0x3227ca,_0x3227ca+_0x421844));}return _0x591fdd;}const _0x419df3=_0x2cb38c(_0x3271aa,_0x11fb9b);let _0x113078='';return _0x419df3[_0x1a1a9b(0x1af)]((_0x39c9d2,_0x5cafc5)=>{const _0x2e7f4a=_0x1a1a9b;_0x5cafc5>0x0&&(_0x113078+=_0x2e7f4a(0x1bd));_0x113078+=_0x2e7f4a(0x252),_0x113078+='<thead>',_0x113078+=_0x2e7f4a(0x29f),_0x113078+=_0x2e7f4a(0x1a7),_0x113078+=_0x2e7f4a(0x25d),_0x113078+='<tr>',_0x113078+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x515c6b=0x0;_0x515c6b<=_0x335e37[_0x2e7f4a(0x241)]-0x1;_0x515c6b++){const _0x5ac772=_0x335e37[_0x515c6b];for(let _0x3677d5=0x0;_0x3677d5<_0x1d573c[_0x2e7f4a(0x241)];_0x3677d5++){const _0x5d2c36=_0x1d573c[_0x3677d5];_0x5d2c36['_id']===_0x5ac772[_0x2e7f4a(0x31c)]['category']&&(_0x113078+=_0x2e7f4a(0x2bb)+_0x5d2c36[_0x2e7f4a(0x1f8)]+_0x2e7f4a(0x2df)+_0x5ac772['_id'][_0x2e7f4a(0x2b3)]+_0x2e7f4a(0x293));}}_0x113078+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x113078+=_0x2e7f4a(0x25d),_0x113078+='<tr>',_0x113078+=_0x2e7f4a(0x203),_0x113078+=_0x2e7f4a(0x1b0),_0x113078+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x2466ac=0x0;_0x2466ac<=_0x335e37['length']-0x1;_0x2466ac++){const _0x583e2f=_0x335e37[_0x2466ac];for(let _0x576d5b=0x0;_0x576d5b<_0x5c8442[_0x2e7f4a(0x1bb)][_0x2e7f4a(0x241)];_0x576d5b++){const _0x367532=_0x5c8442['cat_brand'][_0x576d5b];_0x367532[_0x2e7f4a(0x31c)]['category']===_0x583e2f[_0x2e7f4a(0x31c)][_0x2e7f4a(0x2b3)]&&(_0x113078+=_0x2e7f4a(0x19f)+_0x367532[_0x2e7f4a(0x31c)][_0x2e7f4a(0x2c7)]+_0x2e7f4a(0x293));}}_0x113078+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x113078+=_0x2e7f4a(0x220),_0x113078+=_0x2e7f4a(0x264),_0x113078+=_0x2e7f4a(0x313),_0x113078+='</tr>',_0x113078+=_0x2e7f4a(0x201),_0x113078+=_0x2e7f4a(0x200),_0x39c9d2[_0x2e7f4a(0x1af)](_0x122c15=>{_0x113078+=_0x122c15;}),console['log'](_0x2e9d17),_0x113078+=_0x2e7f4a(0x212),_0x113078+=_0x2e7f4a(0x2ed);}),_0x113078;}function a0_0x327f(){const _0x19c255=['render','/inventory_sum/pdf','$_id.dsi','$product_details.product_stock','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','$sale_product.isFG','totalGross','<p>SALES\x20REPORTS</p>','<div\x20class=\x22row\x22>','1289848xInBli','/getDSSR_no','/dsrr_admin/view_data/:id','length','numeric','landscape','findOne','border-left','<td\x20class=\x22row_data\x22>0</td>','inventory_sum','name','$amount','jsbarcode','Router','thick','$product.quantity','$product.product_name','8.5in','$totalGross','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<table>','user','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','$product_details','Products\x20master','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','send','bottom','html','$product_stock','</tr>','$product.product_code','errors','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','multer','product_details','sales_staff_id','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','$products.adj_discount','26gQaqaa','error','buffer','qty','totalQTYsum','totalQty','push','dssr_view','Content-Disposition','/total_sales_reports/view','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','<th>\x20BEG\x20BALANCE\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','window.print();','5671125tzgmTg','sale_product.product_code','21657fMdkbe','$name','pipe','$_id.category','sales_reports','$brand','reduce','isFG','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','date','dssr_view_admin','each','$products.product_details','Content-Type','15in','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','4169956XTvxkO','English\x20(US)','toLocaleString','valueOf','map','book_append_sheet','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','toStream','sort','trim','</th>','Spanish','</td>','NumberFormat','split','long','$product_details.product_name','totalQTY','$sale_product.prod_cat','<td\x20colspan=\x223\x22><b>TOTAL<b>','<script>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','$product_list.product_name','$_id.date','<tr>','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','product_info','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','$sale_product.product_name','$_id.status_data','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','$bank','<thead>','setDate','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','Portuguese','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','60mm','$adj_discount','customer','$sale_product.stock','category','0.1in','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','adj_discount','$product_info.name','staffs','$product_docs','text','<td\x20colspan=\x22','$product_info.gross_price','$_id.brand','!merges','book_new','$products.product_details.gross_price','20600883DTcISl','/dsrr/pdf','bank','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','brand','true','</b></td>','table\x20tr','stock','/agent_reports/sales_ad','product_code','$product_list','findById','setHeader','excel','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','Types','<p>FINISHED\x20GOODS\x20INVENTORY</p>','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','/dsrr_admin/view','$totalQty','utils','sales_info','window.onload\x20=\x20function()\x20{','$sales_info.name','products','dataqty','express/lib/response','\x22\x20class=\x22cat_data\x22>','totalPrice','attachment;\x20filename=\x22sales_report.xlsx\x22','right','$sale_product','/balance/view','slice','$dsi','border-bottom','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','status','rowspan','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<th\x20rowspan=\x272\x27>Category</th>','</table>','$products.NetPrice','$_id.customer','<td\x20class=\x22row_data\x22>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','DateTimeFormat','<th>\x20SALES\x20</th>','$customer','format','000000','Products\x20find_data','\x22><b></b></td>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','sumqty','/total_sales_reports/pdf','isArray','referenceNumber','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','left','false','product_name','7FAMEpT','$discount','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','Hindi','attachment;\x20filename=\x22reports.xlsx\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22col-sm-11\x22>','body','/agent_reports/pdf_admin','due_date','path','test','/inventory_sum/view','$product_info.brand','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','</p>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','thin','$product_info.category','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','$products.product_details.category','en-US','<th>\x20ENDING\x20BALANCE\x20</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','aoa_to_sheet','_id','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','get','Arabic\x20(ae)','118131FDOOIt','post','<td\x20class=\x22cat_data\x22></td>','Sales\x20Report','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','<td\x20class=\x22cat_data\x22>','$product_name','Chinese','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','\x20-\x20STD','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','beg_bal','$sales_staff_id','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$sale_product.product_code','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','Products\x20warehouse_data','$sale_product.real_qty_unit_val','$category','English','forEach','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','xlsx','toFixed','<th>\x20INVOICE\x20AMOUNT\x20</th>','params','image','find','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','application/pdf','product_docs','toISOString','cat_brand','$product_list.product_stock','<div\x20style=\x22page-break-before:\x20always;\x22></div>','includes','top','/agent_reports/view','$sale_product.adj_discount','style','$sales_info','save','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','catch','amount','3516006hjZEWY','<th>\x20ITEM\x20CODE\x20</th>','sales_man_code','$product_info.product_code','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','<th\x20rowspan=\x272\x27>Production</th>','create','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','product_details.product_name','getMonth','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$product_info','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','$products','filter','</script>','Error\x20generating\x20PDF','then','NetPrice','$NetPrice','$sale_product._id','\x20-\x20','../public/language/languages.json','No\x20data\x20was\x20Found!','../models/all_models','express','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','date_include','Portuguese\x20(BR)','<div\x20\x20id=\x22table-conatainer\x22>','/reports/dsrr/view','/dsrr_admin/pdf_admin','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','discount','write','$cash','prod_cat','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','log','td,\x20th','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','$sale_product.quantity','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','Arabic','$sale_product.discount','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','canvas','brandCount','\x22><b>','$products.product_details.prod_id','flash','aggregate','<td\x20class=\x22row_data\x22><b>','$date','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<tbody>','</thead>','pdfkit-table','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','/dsrr/view','attr','border-right','$sales_info._id','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','<h1>JAKA\x20EQUITIES\x20CORP</h1>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','20mm','colspan','load','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','cash','sales_ext','$due_date','</tbody>','French','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','!cols','border-top','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','medium','$check_no','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','sales_bkg','</div>','$product_code','$products.qty','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','json','product_stock','exports','$products.discount','$sale_product.totalprice','$product_list.product_code','getDate','email','replace','<th>X-Truck</th>','dsi','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','$products.product_details.brand','German','Asia/Manila','language','success','<p>','Letter'];a0_0x327f=function(){return _0x19c255;};return a0_0x327f();}router[a0_0x46c47e(0x321)](a0_0x46c47e(0x30b),auth,async(_0xc55b2,_0x207b23)=>{const _0x5d063b=a0_0x46c47e,{from_date:_0x32c217,to_date:_0x3867cf,isExcel:_0x914391,agent_id:_0x1605f8}=_0xc55b2['body'],_0x2d279f=_0xc55b2[_0x5d063b(0x253)],_0x18edb=await staff[_0x5d063b(0x244)]({'email':_0x2d279f[_0x5d063b(0x228)]}),_0x22270c=await master_shop[_0x5d063b(0x1b6)](),_0x9d2f17=await agentsdataDSICheck_admin(_0x32c217,_0x3867cf,_0x1605f8,_0x914391),_0x40b738=await agentsdataDSICheck_admin_excel(_0x32c217,_0x3867cf,_0x1605f8,_0x914391);let _0x38a4cb=_0x5d063b(0x257);var _0x3e33d5=new Date(_0x32c217),_0x358d25=new Date(_0x3867cf);const _0x3d24f3={'year':_0x5d063b(0x242),'month':'long','day':_0x5d063b(0x242)},_0x34b275=new Intl[(_0x5d063b(0x2f2))](_0x5d063b(0x318),_0x3d24f3)[_0x5d063b(0x2f5)](_0x3e33d5),_0x295f67=new Intl[(_0x5d063b(0x2f2))](_0x5d063b(0x318),_0x3d24f3)[_0x5d063b(0x2f5)](_0x358d25);_0x38a4cb+=_0x5d063b(0x23d),_0x38a4cb+=_0x5d063b(0x1e5),_0x38a4cb+=_0x5d063b(0x252),_0x38a4cb+=_0x9d2f17,_0x38a4cb+=_0x5d063b(0x2ed),_0x38a4cb+=_0x5d063b(0x21d),_0x38a4cb+='</div>';let _0x335f26='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x335f26+='<div\x20class=\x22row\x22>',_0x335f26+=_0x5d063b(0x1e5),_0x335f26+='<table>',_0x335f26+=_0x40b738,_0x335f26+=_0x5d063b(0x2ed),_0x335f26+='</div>',_0x335f26+=_0x5d063b(0x21d);let _0x388d08=_0x5d063b(0x2f1);const _0x5a84bb={'width':_0x5d063b(0x285),'height':'8.5in','orientation':_0x5d063b(0x243),'border':{'top':_0x5d063b(0x2b4),'right':_0x5d063b(0x2b4),'bottom':'0.1in','left':_0x5d063b(0x2b4)},'header':{'height':_0x5d063b(0x2af),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x388d08+_0x5d063b(0x251)+_0x34b275+_0x5d063b(0x1dd)+_0x295f67+_0x5d063b(0x2ae)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x914391=='on'){const _0xd16f45=cheerio[_0x5d063b(0x20d)](_0x335f26);let _0x112932=[],_0x22408e=[],_0x4d0a50=[];_0xd16f45(_0x5d063b(0x2ca))[_0x5d063b(0x282)]((_0x504da0,_0x2533e2)=>{const _0x325b19=_0x5d063b;let _0x39dde0=[],_0x28b0fc=0x0;while(_0x4d0a50[_0x28b0fc]){_0x4d0a50[_0x28b0fc]--,_0x28b0fc++;}_0xd16f45(_0x2533e2)[_0x325b19(0x1b6)](_0x325b19(0x1f0))[_0x325b19(0x282)]((_0x4ea05a,_0x41235b)=>{const _0x474608=_0x325b19;let _0x567b2d=_0xd16f45(_0x41235b)[_0x474608(0x2ba)]()['trim'](),_0x3bff87=parseFloat(_0x567b2d['replace'](/,/g,''));isNaN(_0x3bff87)&&(_0x3bff87=_0x567b2d);let _0x46cd84=parseInt(_0xd16f45(_0x41235b)['attr'](_0x474608(0x20c)))||0x1,_0x480d82=parseInt(_0xd16f45(_0x41235b)[_0x474608(0x205)](_0x474608(0x2ea)))||0x1;_0x39dde0[_0x28b0fc]=_0x3bff87;(_0x46cd84>0x1||_0x480d82>0x1)&&_0x22408e[_0x474608(0x26c)]({'s':{'r':_0x504da0,'c':_0x28b0fc},'e':{'r':_0x504da0+_0x480d82-0x1,'c':_0x28b0fc+_0x46cd84-0x1}});for(let _0x9f7708=0x0;_0x9f7708<_0x46cd84;_0x9f7708++){_0x480d82>0x1&&(_0x4d0a50[_0x28b0fc+_0x9f7708]=_0x480d82-0x1);}_0x28b0fc+=_0x46cd84;}),_0x112932[_0x325b19(0x26c)](_0x39dde0);});const _0x525895=XLSX[_0x5d063b(0x2d8)][_0x5d063b(0x2bf)](),_0x26a7ce=XLSX[_0x5d063b(0x2d8)][_0x5d063b(0x31b)](_0x112932);_0x22408e['length']>0x0&&(_0x26a7ce[_0x5d063b(0x2be)]=_0x22408e);_0x26a7ce['!cols']=_0x112932[0x0][_0x5d063b(0x28b)](()=>({'wpx':0x64})),XLSX[_0x5d063b(0x2d8)][_0x5d063b(0x28c)](_0x525895,_0x26a7ce,'Sales\x20Report');const _0x42af72=XLSX[_0x5d063b(0x1ea)](_0x525895,{'bookType':_0x5d063b(0x1b1),'type':'buffer'});_0x207b23[_0x5d063b(0x2d0)](_0x5d063b(0x26e),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x207b23[_0x5d063b(0x2d0)](_0x5d063b(0x284),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x207b23[_0x5d063b(0x259)](_0x42af72);}else pdf['create'](_0x38a4cb,_0x5a84bb)[_0x5d063b(0x28e)](function(_0x24cb73,_0x25a7ef){const _0x4794e2=_0x5d063b;if(_0x24cb73){_0x207b23['status'](0x1f4)[_0x4794e2(0x259)](_0x4794e2(0x1d8));return;}_0x207b23[_0x4794e2(0x2d0)]('Content-Type','application/pdf'),_0x25a7ef[_0x4794e2(0x279)](_0x207b23);});}),router['get'](a0_0x46c47e(0x1c0),auth,async(_0x2fd3e5,_0x9820ef)=>{const _0x23c727=a0_0x46c47e;try{const {username:_0x290953,email:_0x3c302d,role:_0x235584}=_0x2fd3e5['user'],_0x4e36a8=_0x2fd3e5[_0x23c727(0x253)],_0x460c68=await profile[_0x23c727(0x244)]({'email':_0x4e36a8[_0x23c727(0x228)]}),_0x45fac0={'year':_0x23c727(0x242),'month':_0x23c727(0x296),'day':_0x23c727(0x242)},_0x5cfb43=await master_shop[_0x23c727(0x1b6)](),_0x1a1ebd=await staff['findOne']({'email':_0x4e36a8[_0x23c727(0x228)]}),_0x37f562=await product[_0x23c727(0x1b6)](),_0xfbfb73=await warehouse[_0x23c727(0x1fc)]([{'$unwind':_0x23c727(0x255)},{'$lookup':{'from':_0x23c727(0x2dc),'localField':_0x23c727(0x1d0),'foreignField':'name','as':_0x23c727(0x1b9)}},{'$unwind':_0x23c727(0x2b9)},{'$project':{'product_name':_0x23c727(0x297),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x23c727(0x1a0),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x5cfb43[0x0]['language']==_0x23c727(0x288))var _0x2b5e87=users[_0x23c727(0x1ae)];else{if(_0x5cfb43[0x0]['language']==_0x23c727(0x306))var _0x2b5e87=users['Hindi'];else{if(_0x5cfb43[0x0][_0x23c727(0x230)]=='German')var _0x2b5e87=users[_0x23c727(0x22e)];else{if(_0x5cfb43[0x0][_0x23c727(0x230)]==_0x23c727(0x292))var _0x2b5e87=users[_0x23c727(0x292)];else{if(_0x5cfb43[0x0][_0x23c727(0x230)]==_0x23c727(0x213))var _0x2b5e87=users[_0x23c727(0x213)];else{if(_0x5cfb43[0x0][_0x23c727(0x230)]=='Portuguese\x20(BR)')var _0x2b5e87=users[_0x23c727(0x2ad)];else{if(_0x5cfb43[0x0][_0x23c727(0x230)]==_0x23c727(0x1a1))var _0x2b5e87=users[_0x23c727(0x1a1)];else{if(_0x5cfb43[0x0][_0x23c727(0x230)]==_0x23c727(0x31f))var _0x2b5e87=users[_0x23c727(0x1f4)];}}}}}}}_0x9820ef[_0x23c727(0x234)]('dsi_sales',{'success':_0x2fd3e5[_0x23c727(0x1fb)]('success'),'errors':_0x2fd3e5['flash']('errors'),'alldata':_0x37f562,'profile':_0x460c68,'master_shop':_0x5cfb43,'role':_0x4e36a8,'product_stock':_0xfbfb73,'language':_0x2b5e87,'staff_arr':_0x1a1ebd});}catch(_0x5194f7){}});function formatNumber(_0x39dae0,_0x3797c3=a0_0x46c47e(0x318),_0x334915={'minimumFractionDigits':0x2}){const _0x458b3c=a0_0x46c47e,_0x107961=new Intl[(_0x458b3c(0x294))](_0x3797c3,_0x334915);return _0x107961[_0x458b3c(0x2f5)](_0x39dae0);}async function agentsdataDSICheck(_0x2197f3,_0x5e00ad,_0x16403e,_0xc93c80){const _0x113da8=a0_0x46c47e,_0xdfe7=await product[_0x113da8(0x1fc)]([{'$group':{'_id':{'brand':_0x113da8(0x27c),'category':_0x113da8(0x1ad)},'products':{'$push':{'name':_0x113da8(0x278),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2d9ac0=[];_0x2d9ac0[_0x113da8(0x1bb)]=[];for(let _0x1b1d32=0x0;_0x1b1d32<=_0xdfe7['length']-0x1;_0x1b1d32++){const _0x3e1fea=_0xdfe7[_0x1b1d32];_0x2d9ac0[_0x113da8(0x1bb)][_0x113da8(0x26c)](_0x3e1fea);}const _0x33c5f5=await product[_0x113da8(0x1fc)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x113da8(0x27c),'product_code':_0x113da8(0x21e),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x588b9f=await product[_0x113da8(0x1fc)]([{'$group':{'_id':{'category':_0x113da8(0x1ad),'brand':_0x113da8(0x27c)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x443eb2=await sales_sa[_0x113da8(0x1fc)]([{'$match':{'date':{'$gte':_0x2197f3,'$lte':_0x5e00ad},'sales_staff_id':_0x16403e,'sale_product.isFG':_0x113da8(0x301)}},{'$unwind':_0x113da8(0x2e3)},{'$match':{'sale_product.isFG':_0x113da8(0x301)}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0x113da8(0x2cd),'as':_0x113da8(0x2a2)}},{'$unwind':_0x113da8(0x1d3)},{'$group':{'_id':{'dsi':_0x113da8(0x2e6),'date':_0x113da8(0x1fe),'customer':'$customer'},'totalQty':{'$sum':_0x113da8(0x1ac)},'products':{'$push':{'qty':_0x113da8(0x1ac),'NetPrice':_0x113da8(0x225),'discount':_0x113da8(0x1f5),'adj_discount':_0x113da8(0x1c1),'product_details':{'prod_name':_0x113da8(0x2b7),'product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x113da8(0x310),'gross_price':_0x113da8(0x2bc)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x113da8(0x236),'date':_0x113da8(0x29e),'customer':'$_id.customer','category':'$products.product_details.category','brand':_0x113da8(0x22d)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x113da8(0x2ee)},'discount':{'$sum':_0x113da8(0x224)},'adj_discount':{'$sum':_0x113da8(0x265)},'product_details':{'$first':_0x113da8(0x283)}}},{'$group':{'_id':{'dsi':_0x113da8(0x236),'date':_0x113da8(0x29e),'customer':'$_id.customer'},'totalQty':{'$sum':_0x113da8(0x2d7)},'totalGross':{'$sum':_0x113da8(0x250)},'NetPrice':{'$sum':_0x113da8(0x1db)},'discount':{'$sum':_0x113da8(0x304)},'adj_discount':{'$sum':_0x113da8(0x2b0)},'products':{'$push':{'qty':'$totalQty','category':_0x113da8(0x27a),'brand':'$_id.brand','product_details':_0x113da8(0x255)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2d93d3=[],_0xc9da60={},_0x48e0f5={},_0x4e91d0={};var _0x3ab07a=0x0,_0x498a81=0x0,_0x1cd227=0x0,_0x5a4b31=0x0,_0x534fc6=0x0;const _0x32214f=0x6;for(let _0x1a4f84=0x0;_0x1a4f84<=_0x443eb2[_0x113da8(0x241)]-0x1;_0x1a4f84++){const _0x31ba5e=_0x443eb2[_0x1a4f84];let _0xb605be='<tr>';_0xb605be+=_0x113da8(0x31a)+_0x31ba5e[_0x113da8(0x31c)][_0x113da8(0x22b)]+_0x113da8(0x293),_0xb605be+=_0x113da8(0x31a)+_0x31ba5e[_0x113da8(0x31c)][_0x113da8(0x280)]+_0x113da8(0x293),_0xb605be+=_0x113da8(0x31a)+_0x31ba5e[_0x113da8(0x31c)][_0x113da8(0x2b1)]+_0x113da8(0x293);let _0x45d935={};var _0x1fd314=0x0;for(let _0x2ff443=0x0;_0x2ff443<=_0x31ba5e[_0x113da8(0x2dc)][_0x113da8(0x241)]-0x1;_0x2ff443++){const _0x2f78d3=_0x31ba5e[_0x113da8(0x2dc)][_0x2ff443];_0x45d935[_0x2f78d3[_0x113da8(0x2c7)]+'-'+_0x2f78d3[_0x113da8(0x2b3)]]=_0x2f78d3['qty'];const _0x11c92f=_0x2f78d3[_0x113da8(0x2c7)]+'-'+_0x2f78d3[_0x113da8(0x2b3)];!_0xc9da60[_0x11c92f]&&(_0xc9da60[_0x11c92f]=0x0),!Array['isArray'](_0x4e91d0[_0x11c92f])&&(_0x4e91d0[_0x11c92f]=[]),!Array[_0x113da8(0x2fc)](_0x4e91d0[_0x11c92f])&&(_0x4e91d0[_0x11c92f]=[]),_0xc9da60[_0x11c92f]+=_0x2f78d3[_0x113da8(0x269)],_0x4e91d0[_0x11c92f][_0x113da8(0x26c)](_0x2f78d3['qty']),_0x1fd314++;}console[_0x113da8(0x1ef)](_0x31ba5e);for(let _0x57e6c7=0x0;_0x57e6c7<=_0x2d9ac0['cat_brand'][_0x113da8(0x241)]-0x1;_0x57e6c7++){const _0x5e6cf0=_0x2d9ac0[_0x113da8(0x1bb)][_0x57e6c7],_0x735155=_0x5e6cf0[_0x113da8(0x31c)][_0x113da8(0x2c7)]+'-'+_0x5e6cf0[_0x113da8(0x31c)][_0x113da8(0x2b3)];_0xb605be+=_0x113da8(0x31d)+(_0x45d935[_0x735155]!==undefined?_0x45d935[_0x735155][_0x113da8(0x1b2)](0x2):'')+_0x113da8(0x293);}_0x1cd227=_0x31ba5e[_0x113da8(0x1e9)]+_0x31ba5e[_0x113da8(0x2b6)],_0xb605be+=_0x113da8(0x2a0)+formatNumber(parseFloat(_0x31ba5e[_0x113da8(0x26b)],0x2)[_0x113da8(0x1b2)](0x2))+_0x113da8(0x293),_0xb605be+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x31ba5e[_0x113da8(0x23b)]['toFixed'](0x2))+_0x113da8(0x293),_0xb605be+=_0x113da8(0x2a0)+formatNumber(_0x1cd227)+_0x113da8(0x293),_0xb605be+=_0x113da8(0x2a0)+formatNumber(_0x31ba5e[_0x113da8(0x1da)][_0x113da8(0x1b2)](0x2))+_0x113da8(0x293),_0xb605be+=_0x113da8(0x25d),_0x3ab07a+=parseFloat(_0x31ba5e[_0x113da8(0x26b)][_0x113da8(0x1b2)](0x2)),_0x498a81+=parseFloat(_0x31ba5e['NetPrice']['toFixed'](0x2)),_0x5a4b31+=_0x1cd227,_0x534fc6+=parseFloat(_0x31ba5e[_0x113da8(0x23b)][_0x113da8(0x1b2)](0x2));if(_0x1a4f84==_0x443eb2[_0x113da8(0x241)]-0x1){_0xb605be+=_0x113da8(0x29f),_0xb605be+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0xb605be+=_0x113da8(0x293);for(let _0x1938e3=0x0;_0x1938e3<=_0x2d9ac0[_0x113da8(0x1bb)][_0x113da8(0x241)]-0x1;_0x1938e3++){const _0x1ee3f3=_0x2d9ac0[_0x113da8(0x1bb)][_0x1938e3],_0x2596f0=_0x1ee3f3['_id']['brand']+'-'+_0x1ee3f3[_0x113da8(0x31c)][_0x113da8(0x2b3)],_0x4af351=_0x4e91d0[_0x2596f0]['reduce']((_0x530dc5,_0x276605)=>_0x530dc5+_0x276605,0x0);_0xb605be+=_0x113da8(0x2a4)+(_0x4af351!==undefined?formatNumber(_0x4af351[_0x113da8(0x1b2)](0x2)):'')+_0x113da8(0x2c9),console[_0x113da8(0x1ef)](_0x4e91d0[_0x2596f0][_0x113da8(0x27d)]((_0x3671b0,_0x486a1d)=>_0x3671b0+_0x486a1d,0x0));}_0xb605be+=_0x113da8(0x1d2)+formatNumber(_0x3ab07a[_0x113da8(0x1b2)](0x2))+_0x113da8(0x2c9),_0xb605be+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x534fc6)+_0x113da8(0x2c9),_0xb605be+=_0x113da8(0x1d2)+formatNumber(_0x5a4b31)+_0x113da8(0x2c9),_0xb605be+=_0x113da8(0x1d2)+formatNumber(_0x498a81)+_0x113da8(0x2c9),_0xb605be+=_0x113da8(0x25d);}_0x2d93d3[_0x113da8(0x26c)](_0xb605be);}function _0x3e0a47(_0x41dab7,_0x580443){const _0x3be6e8=_0x113da8,_0x3be865=[];for(let _0x4db328=0x0;_0x4db328<=_0x41dab7[_0x3be6e8(0x241)]-0x1;_0x4db328+=_0x580443){_0x3be865['push'](_0x41dab7[_0x3be6e8(0x2e5)](_0x4db328,_0x4db328+_0x580443));}return _0x3be865;}const _0x20e956=_0x3e0a47(_0x2d93d3,_0x32214f);let _0x4de6b7='';return _0x20e956[_0x113da8(0x1af)]((_0x384d4a,_0x1712e9)=>{const _0x2abc9d=_0x113da8;_0x1712e9>0x0&&(_0x4de6b7+=_0x2abc9d(0x1bd));_0x4de6b7+='<table>',_0x4de6b7+=_0x2abc9d(0x2aa),_0x4de6b7+=_0x2abc9d(0x29f),_0x4de6b7+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4de6b7+=_0x2abc9d(0x25d),_0x4de6b7+='<tr>',_0x4de6b7+=_0x2abc9d(0x1a2);for(let _0x2b5d05=0x0;_0x2b5d05<=_0x33c5f5['length']-0x1;_0x2b5d05++){const _0x4ea50a=_0x33c5f5[_0x2b5d05];for(let _0x9e9f2a=0x0;_0x9e9f2a<_0x588b9f[_0x2abc9d(0x241)];_0x9e9f2a++){const _0x24bd8b=_0x588b9f[_0x9e9f2a];_0x24bd8b['_id']===_0x4ea50a[_0x2abc9d(0x31c)][_0x2abc9d(0x2b3)]&&(_0x4de6b7+=_0x2abc9d(0x2bb)+_0x24bd8b[_0x2abc9d(0x1f8)]+_0x2abc9d(0x2df)+_0x4ea50a[_0x2abc9d(0x31c)][_0x2abc9d(0x2b3)]+_0x2abc9d(0x293));}}_0x4de6b7+=_0x2abc9d(0x27f),_0x4de6b7+=_0x2abc9d(0x25d),_0x4de6b7+=_0x2abc9d(0x29f),_0x4de6b7+=_0x2abc9d(0x203),_0x4de6b7+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x4de6b7+=_0x2abc9d(0x1ee);for(let _0x237f4e=0x0;_0x237f4e<=_0x33c5f5[_0x2abc9d(0x241)]-0x1;_0x237f4e++){const _0x189eb1=_0x33c5f5[_0x237f4e];for(let _0x4e6b89=0x0;_0x4e6b89<_0x2d9ac0['cat_brand'][_0x2abc9d(0x241)];_0x4e6b89++){const _0x4a834a=_0x2d9ac0['cat_brand'][_0x4e6b89];_0x4a834a[_0x2abc9d(0x31c)][_0x2abc9d(0x2b3)]===_0x189eb1[_0x2abc9d(0x31c)][_0x2abc9d(0x2b3)]&&(_0x4de6b7+=_0x2abc9d(0x19f)+_0x4a834a['_id'][_0x2abc9d(0x2c7)]+'</td>');}}_0x4de6b7+=_0x2abc9d(0x2fe),_0x4de6b7+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x4de6b7+=_0x2abc9d(0x264),_0x4de6b7+=_0x2abc9d(0x313),_0x4de6b7+='</tr>',_0x4de6b7+=_0x2abc9d(0x201),_0x4de6b7+=_0x2abc9d(0x200),_0x384d4a['forEach'](_0x14aa2b=>{_0x4de6b7+=_0x14aa2b;}),console[_0x2abc9d(0x1ef)](_0x4e91d0),_0x4de6b7+=_0x2abc9d(0x212),_0x4de6b7+=_0x2abc9d(0x2ed);}),_0x4de6b7;}async function agentsdataDSICheck_excel(_0x2ab72a,_0x3c596f,_0x290f55,_0x20ad3d){const _0x1266fc=a0_0x46c47e,_0x3c6528=await product['aggregate']([{'$group':{'_id':{'brand':_0x1266fc(0x27c),'category':_0x1266fc(0x1ad)},'products':{'$push':{'name':_0x1266fc(0x278),'product_code':_0x1266fc(0x21e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x301083=[];_0x301083['cat_brand']=[];for(let _0x28c22c=0x0;_0x28c22c<=_0x3c6528[_0x1266fc(0x241)]-0x1;_0x28c22c++){const _0x29f987=_0x3c6528[_0x28c22c];_0x301083['cat_brand'][_0x1266fc(0x26c)](_0x29f987);}const _0x141c05=await product[_0x1266fc(0x1fc)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x1266fc(0x27c),'product_code':_0x1266fc(0x21e),'product_name':_0x1266fc(0x278)}}}},{'$sort':{'_id.category':-0x1}}]),_0x224fdd=await product[_0x1266fc(0x1fc)]([{'$group':{'_id':{'category':_0x1266fc(0x1ad),'brand':'$brand'}}},{'$group':{'_id':_0x1266fc(0x27a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x37bc55=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x2ab72a,'$lte':_0x3c596f},'sales_staff_id':_0x290f55,'sale_product.isFG':_0x1266fc(0x301)}},{'$unwind':_0x1266fc(0x2e3)},{'$match':{'sale_product.isFG':_0x1266fc(0x301)}},{'$lookup':{'from':'products','localField':_0x1266fc(0x276),'foreignField':_0x1266fc(0x2cd),'as':_0x1266fc(0x2a2)}},{'$unwind':_0x1266fc(0x1d3)},{'$group':{'_id':{'dsi':_0x1266fc(0x2e6),'date':_0x1266fc(0x1fe),'customer':_0x1266fc(0x2f4)},'totalQty':{'$sum':_0x1266fc(0x1ac)},'products':{'$push':{'qty':_0x1266fc(0x1ac),'NetPrice':_0x1266fc(0x225),'discount':_0x1266fc(0x1f5),'adj_discount':_0x1266fc(0x1c1),'product_details':{'prod_name':'$product_info.name','product_code':_0x1266fc(0x1cb),'category':'$product_info.category','brand':_0x1266fc(0x310),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x1266fc(0x236),'date':_0x1266fc(0x29e),'customer':_0x1266fc(0x2ef),'category':'$products.product_details.category','brand':_0x1266fc(0x22d)},'totalQty':{'$sum':_0x1266fc(0x21f)},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x1266fc(0x2ee)},'discount':{'$sum':_0x1266fc(0x224)},'adj_discount':{'$sum':_0x1266fc(0x265)},'product_details':{'$first':_0x1266fc(0x283)}}},{'$group':{'_id':{'dsi':_0x1266fc(0x236),'date':'$_id.date','customer':_0x1266fc(0x2ef)},'totalQty':{'$sum':_0x1266fc(0x2d7)},'totalGross':{'$sum':_0x1266fc(0x250)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x1266fc(0x304)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x1266fc(0x2bd),'product_details':_0x1266fc(0x255)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x22f9de=[],_0x25a864={},_0x58ad75={},_0x44baf4={};var _0x462a82=0x0,_0x412181=0x0,_0x3f0f50=0x0,_0x2ea2c2=0x0,_0x1ddf50=0x0;const _0x224890=0x9184e72a000;for(let _0x47a6c1=0x0;_0x47a6c1<=_0x37bc55['length']-0x1;_0x47a6c1++){const _0xd8a79=_0x37bc55[_0x47a6c1];let _0x1370b1=_0x1266fc(0x29f);_0x1370b1+=_0x1266fc(0x31a)+_0xd8a79['_id'][_0x1266fc(0x22b)]+_0x1266fc(0x293),_0x1370b1+=_0x1266fc(0x31a)+_0xd8a79['_id'][_0x1266fc(0x280)]+_0x1266fc(0x293),_0x1370b1+=_0x1266fc(0x31a)+_0xd8a79[_0x1266fc(0x31c)][_0x1266fc(0x2b1)]+_0x1266fc(0x293);let _0x115d79={};var _0x1a0187=0x0;for(let _0x1dd568=0x0;_0x1dd568<=_0xd8a79[_0x1266fc(0x2dc)][_0x1266fc(0x241)]-0x1;_0x1dd568++){const _0x41ce3e=_0xd8a79['products'][_0x1dd568];_0x115d79[_0x41ce3e[_0x1266fc(0x2c7)]+'-'+_0x41ce3e[_0x1266fc(0x2b3)]]=_0x41ce3e[_0x1266fc(0x269)];const _0x1d28b=_0x41ce3e[_0x1266fc(0x2c7)]+'-'+_0x41ce3e[_0x1266fc(0x2b3)];!_0x25a864[_0x1d28b]&&(_0x25a864[_0x1d28b]=0x0),!Array[_0x1266fc(0x2fc)](_0x44baf4[_0x1d28b])&&(_0x44baf4[_0x1d28b]=[]),!Array[_0x1266fc(0x2fc)](_0x44baf4[_0x1d28b])&&(_0x44baf4[_0x1d28b]=[]),_0x25a864[_0x1d28b]+=_0x41ce3e[_0x1266fc(0x269)],_0x44baf4[_0x1d28b][_0x1266fc(0x26c)](_0x41ce3e['qty']),_0x1a0187++;}console[_0x1266fc(0x1ef)](_0xd8a79);for(let _0x18ab58=0x0;_0x18ab58<=_0x301083[_0x1266fc(0x1bb)][_0x1266fc(0x241)]-0x1;_0x18ab58++){const _0x39574b=_0x301083[_0x1266fc(0x1bb)][_0x18ab58],_0x1caceb=_0x39574b[_0x1266fc(0x31c)][_0x1266fc(0x2c7)]+'-'+_0x39574b[_0x1266fc(0x31c)][_0x1266fc(0x2b3)];_0x1370b1+=_0x1266fc(0x31d)+(_0x115d79[_0x1caceb]!==undefined?_0x115d79[_0x1caceb][_0x1266fc(0x1b2)](0x2):'')+_0x1266fc(0x293);}_0x3f0f50=_0xd8a79[_0x1266fc(0x1e9)]+_0xd8a79[_0x1266fc(0x2b6)],_0x1370b1+=_0x1266fc(0x2a0)+formatNumber(parseFloat(_0xd8a79[_0x1266fc(0x26b)],0x2)[_0x1266fc(0x1b2)](0x2))+_0x1266fc(0x293),_0x1370b1+=_0x1266fc(0x2a0)+formatNumber(_0xd8a79[_0x1266fc(0x23b)][_0x1266fc(0x1b2)](0x2))+'</td>',_0x1370b1+=_0x1266fc(0x2a0)+formatNumber(_0x3f0f50)+_0x1266fc(0x293),_0x1370b1+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xd8a79[_0x1266fc(0x1da)][_0x1266fc(0x1b2)](0x2))+_0x1266fc(0x293),_0x1370b1+=_0x1266fc(0x25d),_0x462a82+=parseFloat(_0xd8a79[_0x1266fc(0x26b)]['toFixed'](0x2)),_0x412181+=parseFloat(_0xd8a79['NetPrice'][_0x1266fc(0x1b2)](0x2)),_0x2ea2c2+=_0x3f0f50,_0x1ddf50+=parseFloat(_0xd8a79[_0x1266fc(0x23b)][_0x1266fc(0x1b2)](0x2));if(_0x47a6c1==_0x37bc55['length']-0x1){_0x1370b1+='<tr>',_0x1370b1+=_0x1266fc(0x29a),_0x1370b1+=_0x1266fc(0x293);for(let _0x23acb1=0x0;_0x23acb1<=_0x301083[_0x1266fc(0x1bb)][_0x1266fc(0x241)]-0x1;_0x23acb1++){const _0x761a09=_0x301083['cat_brand'][_0x23acb1],_0x5d69c2=_0x761a09[_0x1266fc(0x31c)]['brand']+'-'+_0x761a09[_0x1266fc(0x31c)][_0x1266fc(0x2b3)],_0x31c859=_0x44baf4[_0x5d69c2][_0x1266fc(0x27d)]((_0x423d3a,_0x30d683)=>_0x423d3a+_0x30d683,0x0);_0x1370b1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x31c859!==undefined?formatNumber(_0x31c859[_0x1266fc(0x1b2)](0x2)):'')+'</b></td>',console[_0x1266fc(0x1ef)](_0x44baf4[_0x5d69c2]['reduce']((_0x34ecf6,_0x1a3b34)=>_0x34ecf6+_0x1a3b34,0x0));}_0x1370b1+=_0x1266fc(0x1d2)+formatNumber(_0x462a82[_0x1266fc(0x1b2)](0x2))+'</b></td>',_0x1370b1+=_0x1266fc(0x1d2)+formatNumber(_0x1ddf50)+_0x1266fc(0x2c9),_0x1370b1+=_0x1266fc(0x1d2)+formatNumber(_0x2ea2c2)+_0x1266fc(0x2c9),_0x1370b1+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x412181)+_0x1266fc(0x2c9),_0x1370b1+=_0x1266fc(0x25d);}_0x22f9de[_0x1266fc(0x26c)](_0x1370b1);}function _0x4a83e1(_0x23e7c8,_0x28732c){const _0x528f51=_0x1266fc,_0x13b3b8=[];for(let _0x8bee08=0x0;_0x8bee08<=_0x23e7c8[_0x528f51(0x241)]-0x1;_0x8bee08+=_0x28732c){_0x13b3b8['push'](_0x23e7c8[_0x528f51(0x2e5)](_0x8bee08,_0x8bee08+_0x28732c));}return _0x13b3b8;}const _0x30f49a=_0x4a83e1(_0x22f9de,_0x224890);let _0x4dceb9='';return _0x30f49a[_0x1266fc(0x1af)]((_0xa23ce8,_0x228225)=>{const _0x2929f4=_0x1266fc;_0x228225>0x0&&(_0x4dceb9+=_0x2929f4(0x1bd));_0x4dceb9+='<table>',_0x4dceb9+=_0x2929f4(0x2aa),_0x4dceb9+=_0x2929f4(0x29f),_0x4dceb9+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4dceb9+=_0x2929f4(0x25d),_0x4dceb9+=_0x2929f4(0x29f),_0x4dceb9+=_0x2929f4(0x1a2);for(let _0x1e27ad=0x0;_0x1e27ad<=_0x141c05[_0x2929f4(0x241)]-0x1;_0x1e27ad++){const _0x63d03d=_0x141c05[_0x1e27ad];for(let _0x156931=0x0;_0x156931<_0x224fdd[_0x2929f4(0x241)];_0x156931++){const _0x53aacd=_0x224fdd[_0x156931];_0x53aacd[_0x2929f4(0x31c)]===_0x63d03d[_0x2929f4(0x31c)][_0x2929f4(0x2b3)]&&(_0x4dceb9+=_0x2929f4(0x2bb)+_0x53aacd[_0x2929f4(0x1f8)]+_0x2929f4(0x2df)+_0x63d03d[_0x2929f4(0x31c)]['category']+'</td>');}}_0x4dceb9+=_0x2929f4(0x27f),_0x4dceb9+=_0x2929f4(0x25d),_0x4dceb9+=_0x2929f4(0x29f),_0x4dceb9+=_0x2929f4(0x203),_0x4dceb9+=_0x2929f4(0x1b0),_0x4dceb9+=_0x2929f4(0x1ee);for(let _0x17e703=0x0;_0x17e703<=_0x141c05['length']-0x1;_0x17e703++){const _0x3623a6=_0x141c05[_0x17e703];for(let _0x4d5877=0x0;_0x4d5877<_0x301083['cat_brand'][_0x2929f4(0x241)];_0x4d5877++){const _0x26a595=_0x301083['cat_brand'][_0x4d5877];_0x26a595[_0x2929f4(0x31c)][_0x2929f4(0x2b3)]===_0x3623a6[_0x2929f4(0x31c)][_0x2929f4(0x2b3)]&&(_0x4dceb9+=_0x2929f4(0x19f)+_0x26a595['_id']['brand']+'</td>');}}_0x4dceb9+=_0x2929f4(0x2fe),_0x4dceb9+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x4dceb9+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x4dceb9+=_0x2929f4(0x313),_0x4dceb9+='</tr>',_0x4dceb9+=_0x2929f4(0x201),_0x4dceb9+='<tbody>',_0xa23ce8[_0x2929f4(0x1af)](_0x557134=>{_0x4dceb9+=_0x557134;}),console[_0x2929f4(0x1ef)](_0x44baf4),_0x4dceb9+='</tbody>',_0x4dceb9+='</table>';}),_0x4dceb9;}router[a0_0x46c47e(0x321)]('/agent_reports/pdf',auth,async(_0x5acd82,_0x4b558f)=>{const _0x14672b=a0_0x46c47e,{from_date:_0x16860e,to_date:_0x5ce059,isExcel:_0x426e8d}=_0x5acd82[_0x14672b(0x30a)],_0x1589ee=_0x5acd82['user'],_0x1fa30e=await staff[_0x14672b(0x244)]({'email':_0x1589ee[_0x14672b(0x228)]}),_0x5c41b6=await master_shop[_0x14672b(0x1b6)]();console['log'](_0x5c41b6[0x0][_0x14672b(0x1b5)]);const _0x3e7325=await agentsdataDSICheck(_0x16860e,_0x5ce059,_0x1fa30e[_0x14672b(0x31c)][_0x14672b(0x28a)](),_0x426e8d),_0x1eada9=await agentsdataDSICheck_excel(_0x16860e,_0x5ce059,_0x1fa30e['_id'][_0x14672b(0x28a)](),_0x426e8d);let _0xcfcdce=_0x14672b(0x258);var _0xcdf893=new Date(_0x16860e),_0xd40a13=new Date(_0x5ce059);const _0x38a331={'year':_0x14672b(0x242),'month':_0x14672b(0x296),'day':_0x14672b(0x242)},_0x50f5e2=new Intl[(_0x14672b(0x2f2))](_0x14672b(0x318),_0x38a331)[_0x14672b(0x2f5)](_0xcdf893),_0x24cde7=new Intl[(_0x14672b(0x2f2))](_0x14672b(0x318),_0x38a331)[_0x14672b(0x2f5)](_0xd40a13);_0xcfcdce+='<div\x20class=\x22row\x22>',_0xcfcdce+=_0x14672b(0x1e5),_0xcfcdce+=_0x14672b(0x252),_0xcfcdce+=_0x3e7325,_0xcfcdce+=_0x14672b(0x2ed),_0xcfcdce+=_0x14672b(0x21d),_0xcfcdce+='</div>';let _0x4e9d06=_0x14672b(0x258);_0x4e9d06+='<div\x20class=\x22row\x22>',_0x4e9d06+=_0x14672b(0x1e5),_0x4e9d06+='<table>',_0x4e9d06+=_0x1eada9,_0x4e9d06+=_0x14672b(0x2ed),_0x4e9d06+=_0x14672b(0x21d),_0x4e9d06+=_0x14672b(0x21d);let _0xfb0d53=_0x14672b(0x2f1);const _0x8831a={'width':_0x14672b(0x285),'height':_0x14672b(0x24f),'orientation':'landscape','border':{'top':_0x14672b(0x2b4),'right':_0x14672b(0x2b4),'bottom':_0x14672b(0x2b4),'left':'0.1in'},'header':{'height':_0x14672b(0x2af),'contents':_0x14672b(0x1f3)+_0xfb0d53+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x50f5e2+'\x20-\x20'+_0x24cde7+_0x14672b(0x2ae)},'footer':{'height':_0x14672b(0x20b),'contents':{'default':_0x14672b(0x260)}},'dpi':0x5,'zoomFactor':'1'};if(_0x426e8d=='on'){const _0x2b2b26=cheerio[_0x14672b(0x20d)](_0x4e9d06);let _0x5f22d5=[],_0x27dcd1=[],_0xb16091=[];const _0xd51203=_0x1cc7ed=>{const _0xe136b6=_0x14672b,_0x4e7354={'top':{'style':_0xe136b6(0x24c),'color':{'rgb':_0xe136b6(0x2f6)}},'bottom':{'style':'thick','color':{'rgb':_0xe136b6(0x2f6)}},'left':{'style':_0xe136b6(0x24c),'color':{'rgb':_0xe136b6(0x2f6)}},'right':{'style':_0xe136b6(0x24c),'color':{'rgb':_0xe136b6(0x2f6)}}};if(_0x1cc7ed){const _0x35980e=_0x1cc7ed[_0xe136b6(0x295)](';')[_0xe136b6(0x27d)]((_0x4b4faa,_0x2ad719)=>{const _0x5914cf=_0xe136b6,[_0x39ea01,_0x140bf5]=_0x2ad719[_0x5914cf(0x295)](':')[_0x5914cf(0x28b)](_0x4af8ed=>_0x4af8ed[_0x5914cf(0x290)]());return _0x4b4faa[_0x39ea01]=_0x140bf5,_0x4b4faa;},{});_0x35980e['border-top']&&(_0x4e7354[_0xe136b6(0x1bf)][_0xe136b6(0x1c2)]=_0x35980e[_0xe136b6(0x216)]['includes'](_0xe136b6(0x314))?_0xe136b6(0x314):_0xe136b6(0x218)),_0x35980e[_0xe136b6(0x2e7)]&&(_0x4e7354[_0xe136b6(0x25a)][_0xe136b6(0x1c2)]=_0x35980e[_0xe136b6(0x2e7)][_0xe136b6(0x1be)](_0xe136b6(0x314))?_0xe136b6(0x314):_0xe136b6(0x218)),_0x35980e[_0xe136b6(0x245)]&&(_0x4e7354['left'][_0xe136b6(0x1c2)]=_0x35980e[_0xe136b6(0x245)][_0xe136b6(0x1be)](_0xe136b6(0x314))?_0xe136b6(0x314):_0xe136b6(0x218)),_0x35980e[_0xe136b6(0x206)]&&(_0x4e7354['right']['style']=_0x35980e['border-right']['includes'](_0xe136b6(0x314))?'thin':'medium');}return _0x4e7354;};_0x2b2b26('table\x20tr')[_0x14672b(0x282)]((_0x1e8220,_0xc89f78)=>{const _0x5cd0a6=_0x14672b;let _0x538d9d=[],_0x49d94c=0x0;while(_0xb16091[_0x49d94c]){_0xb16091[_0x49d94c]--,_0x49d94c++;}_0x2b2b26(_0xc89f78)[_0x5cd0a6(0x1b6)]('td,\x20th')[_0x5cd0a6(0x282)]((_0xaad068,_0xcd8c38)=>{const _0x50b4e2=_0x5cd0a6;let _0x9435dd=_0x2b2b26(_0xcd8c38)[_0x50b4e2(0x2ba)]()[_0x50b4e2(0x290)](),_0x2779cb=parseFloat(_0x9435dd[_0x50b4e2(0x229)](/,/g,'')),_0x5510ca={};!isNaN(_0x2779cb)?(_0x5510ca['v']=_0x2779cb,_0x5510ca['t']='n'):(_0x5510ca['v']=_0x9435dd,_0x5510ca['t']='s');const _0x4313ee=_0x2b2b26(_0xcd8c38)[_0x50b4e2(0x205)](_0x50b4e2(0x1c2)),_0x57bbbe=_0xd51203(_0x4313ee);_0x5510ca['s']={'border':_0x57bbbe},_0x538d9d[_0x49d94c]=_0x5510ca;let _0x70871=parseInt(_0x2b2b26(_0xcd8c38)[_0x50b4e2(0x205)](_0x50b4e2(0x20c)))||0x1,_0x2fe3fd=parseInt(_0x2b2b26(_0xcd8c38)[_0x50b4e2(0x205)](_0x50b4e2(0x2ea)))||0x1;(_0x70871>0x1||_0x2fe3fd>0x1)&&_0x27dcd1[_0x50b4e2(0x26c)]({'s':{'r':_0x1e8220,'c':_0x49d94c},'e':{'r':_0x1e8220+_0x2fe3fd-0x1,'c':_0x49d94c+_0x70871-0x1}});for(let _0x52a8a6=0x0;_0x52a8a6<_0x70871;_0x52a8a6++){_0x2fe3fd>0x1&&(_0xb16091[_0x49d94c+_0x52a8a6]=_0x2fe3fd-0x1);}_0x49d94c+=_0x70871;}),_0x5f22d5[_0x5cd0a6(0x26c)](_0x538d9d);});const _0x49aca4=XLSX['utils']['book_new'](),_0x371c34=XLSX['utils'][_0x14672b(0x31b)](_0x5f22d5);_0x27dcd1[_0x14672b(0x241)]>0x0&&(_0x371c34[_0x14672b(0x2be)]=_0x27dcd1);_0x371c34['!cols']=_0x5f22d5[0x0][_0x14672b(0x28b)](()=>({'wpx':0x64})),XLSX[_0x14672b(0x2d8)]['book_append_sheet'](_0x49aca4,_0x371c34,_0x14672b(0x19d));const _0x3bcf96=XLSX[_0x14672b(0x1ea)](_0x49aca4,{'bookType':_0x14672b(0x1b1),'type':_0x14672b(0x268)});_0x4b558f[_0x14672b(0x2d0)](_0x14672b(0x26e),_0x14672b(0x2e1)),_0x4b558f[_0x14672b(0x2d0)](_0x14672b(0x284),_0x14672b(0x1ed)),_0x4b558f[_0x14672b(0x259)](_0x3bcf96);}else pdf[_0x14672b(0x1ce)](_0xcfcdce,_0x8831a)['toStream'](function(_0x39e8c2,_0x5b4346){const _0xa8e34f=_0x14672b;if(_0x39e8c2){_0x4b558f['status'](0x1f4)[_0xa8e34f(0x259)](_0xa8e34f(0x1d8));return;}_0x4b558f[_0xa8e34f(0x2d0)]('Content-Type','application/pdf'),_0x5b4346[_0xa8e34f(0x279)](_0x4b558f);});}),router[a0_0x46c47e(0x31e)](a0_0x46c47e(0x26f),auth,async(_0xc3475,_0x1e870a)=>{const _0x13d93c=a0_0x46c47e;try{const {username:_0x2c3de1,email:_0x28257d,role:_0x4b29d0}=_0xc3475[_0x13d93c(0x253)],_0x9e1dcf=_0xc3475['user'],_0x5b50cc=await profile['findOne']({'email':_0x9e1dcf[_0x13d93c(0x228)]}),_0x3b616c={'year':'numeric','month':_0x13d93c(0x296),'day':'numeric'},_0x53d2b4=await master_shop[_0x13d93c(0x1b6)](),_0xb053f2=await product[_0x13d93c(0x1b6)](),_0x32b0ed=await warehouse['aggregate']([{'$unwind':_0x13d93c(0x255)},{'$lookup':{'from':_0x13d93c(0x2dc),'localField':_0x13d93c(0x1d0),'foreignField':'name','as':_0x13d93c(0x1b9)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x13d93c(0x25c)}}}]),_0x1de25d=await staff[_0x13d93c(0x244)]({'email':_0x9e1dcf['email']});if(_0x53d2b4[0x0][_0x13d93c(0x230)]=='English\x20(US)')var _0x183c8d=users[_0x13d93c(0x1ae)];else{if(_0x53d2b4[0x0][_0x13d93c(0x230)]==_0x13d93c(0x306))var _0x183c8d=users[_0x13d93c(0x306)];else{if(_0x53d2b4[0x0][_0x13d93c(0x230)]==_0x13d93c(0x22e))var _0x183c8d=users[_0x13d93c(0x22e)];else{if(_0x53d2b4[0x0][_0x13d93c(0x230)]=='Spanish')var _0x183c8d=users[_0x13d93c(0x292)];else{if(_0x53d2b4[0x0][_0x13d93c(0x230)]==_0x13d93c(0x213))var _0x183c8d=users[_0x13d93c(0x213)];else{if(_0x53d2b4[0x0][_0x13d93c(0x230)]==_0x13d93c(0x1e4))var _0x183c8d=users[_0x13d93c(0x2ad)];else{if(_0x53d2b4[0x0][_0x13d93c(0x230)]=='Chinese')var _0x183c8d=users[_0x13d93c(0x1a1)];else{if(_0x53d2b4[0x0]['language']==_0x13d93c(0x31f))var _0x183c8d=users[_0x13d93c(0x1f4)];}}}}}}}_0x1e870a[_0x13d93c(0x234)](_0x13d93c(0x27b),{'success':_0xc3475[_0x13d93c(0x1fb)](_0x13d93c(0x231)),'errors':_0xc3475[_0x13d93c(0x1fb)](_0x13d93c(0x25f)),'alldata':_0xb053f2,'profile':_0x5b50cc,'master_shop':_0x53d2b4,'role':_0x9e1dcf,'product_stock':_0x32b0ed,'language':_0x183c8d,'staff_arr':_0x1de25d});}catch(_0x5f386e){}});function a0_0x2fcf(_0x321465,_0x4ca563){const _0x327ff3=a0_0x327f();return a0_0x2fcf=function(_0x2fcf51,_0x444a11){_0x2fcf51=_0x2fcf51-0x19d;let _0x58c95c=_0x327ff3[_0x2fcf51];return _0x58c95c;},a0_0x2fcf(_0x321465,_0x4ca563);}async function dataSalesReports(_0x4ee6be,_0x403e07,_0x2231a1){const _0x34416a=a0_0x46c47e;let _0x2df286='';const _0x7299de=await sales_sa[_0x34416a(0x1fc)]([{'$match':{'date':{'$gte':_0x4ee6be,'$lte':_0x403e07},'sales_staff_id':_0x2231a1}},{'$unwind':_0x34416a(0x2e3)},{'$match':{'sale_product.isFG':'false'}},{'$group':{'_id':{'product_name':_0x34416a(0x2a6),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x246039=0x0,_0x35d86c=0x0;for(let _0x5d8682=0x0;_0x5d8682<=_0x7299de[_0x34416a(0x241)]-0x1;_0x5d8682++){const _0x27d6a4=_0x7299de[_0x5d8682];var _0x43b0fe=_0x27d6a4[_0x34416a(0x2e0)]['toLocaleString'](undefined),_0x4720e4=_0x27d6a4[_0x34416a(0x2fa)][_0x34416a(0x289)](undefined);_0x2df286+='<tr>',_0x2df286+=_0x34416a(0x2f0)+_0x27d6a4[_0x34416a(0x31c)]['product_code']+_0x34416a(0x293),_0x2df286+='<td\x20class=\x22row_data\x22>'+_0x27d6a4[_0x34416a(0x31c)][_0x34416a(0x302)]+_0x34416a(0x293),_0x2df286+=_0x34416a(0x2f0)+formatNumber(_0x27d6a4[_0x34416a(0x2fa)][_0x34416a(0x1b2)](0x2))+_0x34416a(0x293),_0x2df286+=_0x34416a(0x2f0)+formatNumber(_0x27d6a4['totalPrice'][_0x34416a(0x1b2)](0x2))+'</td>',_0x2df286+='</tr>',_0x246039+=parseFloat(_0x27d6a4[_0x34416a(0x2fa)]),_0x35d86c+=parseFloat(_0x27d6a4[_0x34416a(0x2e0)]);}var _0x58b315=_0x35d86c[_0x34416a(0x289)](undefined),_0x42a0b4=_0x246039['toLocaleString'](undefined);return _0x2df286+=_0x34416a(0x29f),_0x2df286+='<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>',_0x2df286+=_0x34416a(0x1fd)+formatNumber(_0x246039[_0x34416a(0x1b2)](0x2))+_0x34416a(0x2c9),_0x2df286+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x35d86c['toFixed'](0x2))+_0x34416a(0x2c9),_0x2df286+='</tr>',_0x2df286;}router['post'](a0_0x46c47e(0x2fb),auth,async(_0x353edc,_0x6361ba)=>{const _0x25a537=a0_0x46c47e;try{const {from_date:_0x54fb3e,to_date:_0xceef22,isExcel:_0x4face1}=_0x353edc[_0x25a537(0x30a)],_0x52c208=_0x353edc['user'],_0x463572=await staff[_0x25a537(0x244)]({'email':_0x52c208['email']});let _0x17f672=_0x25a537(0x21a);var _0xaf2877=new Date(_0x54fb3e),_0x149982=new Date(_0xceef22);const _0x7629d6={'year':_0x25a537(0x242),'month':_0x25a537(0x296),'day':'numeric'},_0x481994=new Intl['DateTimeFormat'](_0x25a537(0x318),_0x7629d6)[_0x25a537(0x2f5)](_0xaf2877),_0x17400e=new Intl[(_0x25a537(0x2f2))](_0x25a537(0x318),_0x7629d6)[_0x25a537(0x2f5)](_0x149982);var _0x59c003=await dataSalesReports(_0x54fb3e,_0xceef22,_0x463572['_id'][_0x25a537(0x28a)]());_0x17f672+=_0x25a537(0x23d),_0x17f672+=_0x25a537(0x309),_0x17f672+=_0x25a537(0x252),_0x17f672+='<tr>',_0x17f672+=_0x25a537(0x1c9),_0x17f672+=_0x25a537(0x2f9),_0x17f672+='<th>\x20QTY\x20SOLD\x20</th>',_0x17f672+=_0x25a537(0x1b3),_0x17f672+=_0x25a537(0x29f),_0x17f672+=_0x59c003,_0x17f672+=_0x25a537(0x25d),_0x17f672+=_0x25a537(0x21d),_0x17f672+='</div>';let _0x3cb2d1=_0x25a537(0x2f1);const _0x2fd830={'width':_0x25a537(0x285),'height':_0x25a537(0x24f),'orientation':_0x25a537(0x243),'border':{'top':'0.1in','right':'0.1in','bottom':'0.1in','left':_0x25a537(0x2b4)},'header':{'height':_0x25a537(0x2af),'contents':_0x25a537(0x1f3)+_0x3cb2d1+_0x25a537(0x2c4)+_0x463572[_0x25a537(0x248)]+_0x25a537(0x1aa)+_0x481994+'\x20-\x20'+_0x17400e+_0x25a537(0x2ae)},'footer':{'height':_0x25a537(0x20b),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x4face1=='on'){const _0x5ade71=cheerio[_0x25a537(0x20d)](_0x17f672);let _0x2f3465=[],_0x2e1aac=[],_0x1d392b=[];const _0x10a200=_0x2afc99=>{const _0x415059=_0x25a537,_0x44c798={'top':{'style':'thick','color':{'rgb':_0x415059(0x2f6)}},'bottom':{'style':_0x415059(0x24c),'color':{'rgb':_0x415059(0x2f6)}},'left':{'style':_0x415059(0x24c),'color':{'rgb':_0x415059(0x2f6)}},'right':{'style':_0x415059(0x24c),'color':{'rgb':'000000'}}};if(_0x2afc99){const _0x136b1c=_0x2afc99['split'](';')[_0x415059(0x27d)]((_0x8da169,_0x13a5fd)=>{const _0x1a879a=_0x415059,[_0x172d11,_0x5b61a3]=_0x13a5fd['split'](':')[_0x1a879a(0x28b)](_0x2148ea=>_0x2148ea[_0x1a879a(0x290)]());return _0x8da169[_0x172d11]=_0x5b61a3,_0x8da169;},{});_0x136b1c[_0x415059(0x216)]&&(_0x44c798[_0x415059(0x1bf)][_0x415059(0x1c2)]=_0x136b1c[_0x415059(0x216)][_0x415059(0x1be)](_0x415059(0x314))?_0x415059(0x314):_0x415059(0x218)),_0x136b1c[_0x415059(0x2e7)]&&(_0x44c798[_0x415059(0x25a)][_0x415059(0x1c2)]=_0x136b1c[_0x415059(0x2e7)]['includes'](_0x415059(0x314))?_0x415059(0x314):_0x415059(0x218)),_0x136b1c[_0x415059(0x245)]&&(_0x44c798['left']['style']=_0x136b1c[_0x415059(0x245)][_0x415059(0x1be)](_0x415059(0x314))?_0x415059(0x314):_0x415059(0x218)),_0x136b1c[_0x415059(0x206)]&&(_0x44c798[_0x415059(0x2e2)][_0x415059(0x1c2)]=_0x136b1c[_0x415059(0x206)][_0x415059(0x1be)](_0x415059(0x314))?_0x415059(0x314):'medium');}return _0x44c798;};_0x5ade71(_0x25a537(0x2ca))[_0x25a537(0x282)]((_0x22c3f0,_0x4a714d)=>{const _0x297843=_0x25a537;let _0x493016=[],_0x524fe0=0x0;while(_0x1d392b[_0x524fe0]){_0x1d392b[_0x524fe0]--,_0x524fe0++;}_0x5ade71(_0x4a714d)[_0x297843(0x1b6)](_0x297843(0x1f0))[_0x297843(0x282)]((_0xa61a68,_0x3cb212)=>{const _0x82c547=_0x297843;let _0x189ec5=_0x5ade71(_0x3cb212)[_0x82c547(0x2ba)]()['trim'](),_0x183f6d=parseFloat(_0x189ec5['replace'](/,/g,'')),_0xd182ad={};!isNaN(_0x183f6d)?(_0xd182ad['v']=_0x183f6d,_0xd182ad['t']='n'):(_0xd182ad['v']=_0x189ec5,_0xd182ad['t']='s');const _0x25dadc=_0x5ade71(_0x3cb212)[_0x82c547(0x205)]('style'),_0x1d7a76=_0x10a200(_0x25dadc);_0xd182ad['s']={'border':_0x1d7a76},_0x493016[_0x524fe0]=_0xd182ad;let _0x314026=parseInt(_0x5ade71(_0x3cb212)['attr'](_0x82c547(0x20c)))||0x1,_0xcd4f1=parseInt(_0x5ade71(_0x3cb212)[_0x82c547(0x205)](_0x82c547(0x2ea)))||0x1;(_0x314026>0x1||_0xcd4f1>0x1)&&_0x2e1aac[_0x82c547(0x26c)]({'s':{'r':_0x22c3f0,'c':_0x524fe0},'e':{'r':_0x22c3f0+_0xcd4f1-0x1,'c':_0x524fe0+_0x314026-0x1}});for(let _0x3ce2bc=0x0;_0x3ce2bc<_0x314026;_0x3ce2bc++){_0xcd4f1>0x1&&(_0x1d392b[_0x524fe0+_0x3ce2bc]=_0xcd4f1-0x1);}_0x524fe0+=_0x314026;}),_0x2f3465[_0x297843(0x26c)](_0x493016);});const _0x344fa6=XLSX[_0x25a537(0x2d8)][_0x25a537(0x2bf)](),_0x1cb79d=XLSX[_0x25a537(0x2d8)][_0x25a537(0x31b)](_0x2f3465);_0x2e1aac[_0x25a537(0x241)]>0x0&&(_0x1cb79d[_0x25a537(0x2be)]=_0x2e1aac);_0x1cb79d[_0x25a537(0x215)]=_0x2f3465[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x25a537(0x2d8)]['book_append_sheet'](_0x344fa6,_0x1cb79d,_0x25a537(0x19d));const _0x486478=XLSX[_0x25a537(0x1ea)](_0x344fa6,{'bookType':_0x25a537(0x1b1),'type':_0x25a537(0x268)});_0x6361ba['setHeader'](_0x25a537(0x26e),_0x25a537(0x2e1)),_0x6361ba[_0x25a537(0x2d0)]('Content-Type',_0x25a537(0x1ed)),_0x6361ba['send'](_0x486478);}else pdf[_0x25a537(0x1ce)](_0x17f672,_0x2fd830)[_0x25a537(0x28e)](function(_0x1e8db2,_0x5d6326){const _0x3ad3a5=_0x25a537;if(_0x1e8db2){_0x6361ba[_0x3ad3a5(0x2e9)](0x1f4)[_0x3ad3a5(0x259)](_0x3ad3a5(0x1d8));return;}_0x6361ba[_0x3ad3a5(0x2d0)](_0x3ad3a5(0x284),_0x3ad3a5(0x1b8)),_0x5d6326['pipe'](_0x6361ba);});}catch(_0x3a77df){}}),router[a0_0x46c47e(0x31e)](a0_0x46c47e(0x30f),auth,async(_0x10324c,_0xaf1630)=>{const _0x3f8e51=a0_0x46c47e;try{const {username:_0xa18fc9,email:_0x1c5863,role:_0x50ba7d}=_0x10324c[_0x3f8e51(0x253)],_0xc2d0a=_0x10324c[_0x3f8e51(0x253)],_0x2de74a=await profile[_0x3f8e51(0x244)]({'email':_0xc2d0a['email']}),_0x4ab693={'year':_0x3f8e51(0x242),'month':_0x3f8e51(0x296),'day':'numeric'},_0x5c16c3=await master_shop[_0x3f8e51(0x1b6)](),_0x426480=await product[_0x3f8e51(0x1b6)](),_0x25fa8f=await warehouse['aggregate']([{'$unwind':_0x3f8e51(0x255)},{'$lookup':{'from':_0x3f8e51(0x2dc),'localField':'product_details.product_name','foreignField':_0x3f8e51(0x248),'as':_0x3f8e51(0x1b9)}},{'$unwind':_0x3f8e51(0x2b9)},{'$project':{'product_name':_0x3f8e51(0x297),'product_stock':_0x3f8e51(0x237)}},{'$group':{'_id':_0x3f8e51(0x1a0),'product_stock':{'$sum':_0x3f8e51(0x25c)}}}]);if(_0x5c16c3[0x0][_0x3f8e51(0x230)]==_0x3f8e51(0x288))var _0x9f82c3=users[_0x3f8e51(0x1ae)];else{if(_0x5c16c3[0x0][_0x3f8e51(0x230)]==_0x3f8e51(0x306))var _0x9f82c3=users[_0x3f8e51(0x306)];else{if(_0x5c16c3[0x0][_0x3f8e51(0x230)]==_0x3f8e51(0x22e))var _0x9f82c3=users[_0x3f8e51(0x22e)];else{if(_0x5c16c3[0x0]['language']=='Spanish')var _0x9f82c3=users[_0x3f8e51(0x292)];else{if(_0x5c16c3[0x0]['language']==_0x3f8e51(0x213))var _0x9f82c3=users[_0x3f8e51(0x213)];else{if(_0x5c16c3[0x0][_0x3f8e51(0x230)]==_0x3f8e51(0x1e4))var _0x9f82c3=users[_0x3f8e51(0x2ad)];else{if(_0x5c16c3[0x0]['language']=='Chinese')var _0x9f82c3=users[_0x3f8e51(0x1a1)];else{if(_0x5c16c3[0x0][_0x3f8e51(0x230)]==_0x3f8e51(0x31f))var _0x9f82c3=users[_0x3f8e51(0x1f4)];}}}}}}}_0xaf1630[_0x3f8e51(0x234)](_0x3f8e51(0x247),{'success':_0x10324c['flash'](_0x3f8e51(0x231)),'errors':_0x10324c[_0x3f8e51(0x1fb)](_0x3f8e51(0x25f)),'alldata':_0x426480,'profile':_0x2de74a,'master_shop':_0x5c16c3,'role':_0xc2d0a,'product_stock':_0x25fa8f,'language':_0x9f82c3});}catch(_0x113833){}});async function dataInventoryReports(_0x36d411,_0x3da21d,_0x4de2b6){const _0x2807f0=a0_0x46c47e,_0x335c0e=await sales_sa[_0x2807f0(0x1fc)]([{'$match':{'date':{'$gte':_0x36d411,'$lte':_0x3da21d},'sales_staff_id':_0x4de2b6}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x2807f0(0x2a6),'product_code':_0x2807f0(0x1a9)},'sumqty':{'$sum':_0x2807f0(0x1f2)}}},{'$sort':{'_id.product_name':0x1}}]),_0x2929c8=mongoose[_0x2807f0(0x2d3)]['ObjectId'],_0x449b97=await staff[_0x2807f0(0x1fc)]([{'$match':{'_id':_0x2929c8(_0x4de2b6)}},{'$unwind':_0x2807f0(0x2ce)},{'$match':{'product_list.isConfirm':_0x2807f0(0x2c8)}},{'$group':{'_id':{'product_name':_0x2807f0(0x29d),'product_code':_0x2807f0(0x226)},'sumqty':{'$sum':_0x2807f0(0x1bc)}}},{'$sort':{'_id.product_name':0x1}}]),_0x206557=await sales_inv_data[_0x2807f0(0x1fc)]([{'$match':{'date':{'$gte':_0x36d411,'$lte':_0x3da21d},'sales_staff_id':_0x4de2b6}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':'$sale_product.product_code'},'totalQTYsum':{'$sum':_0x2807f0(0x2b2)}}}]);console[_0x2807f0(0x1ef)](_0x206557);let _0x44abc3='';var _0x272d7c=0x0;for(let _0x3e06bd=0x0;_0x3e06bd<=_0x449b97[_0x2807f0(0x241)]-0x1;_0x3e06bd++){const _0xcdcd2c=_0x449b97[_0x3e06bd];_0x44abc3+='<tr>',_0x44abc3+=_0x2807f0(0x2ff)+_0xcdcd2c[_0x2807f0(0x31c)][_0x2807f0(0x2cd)]+'</td>',_0x44abc3+=_0x2807f0(0x29c)+_0xcdcd2c[_0x2807f0(0x31c)][_0x2807f0(0x302)]+_0x2807f0(0x293);var _0x398f3e=_0xcdcd2c[_0x2807f0(0x2fa)],_0x5039d9=0x0;for(let _0x58dfcd=0x0;_0x58dfcd<=_0x335c0e[_0x2807f0(0x241)]-0x1;_0x58dfcd++){const _0x2ab33f=_0x335c0e[_0x58dfcd];_0xcdcd2c['_id'][_0x2807f0(0x2cd)]==_0x2ab33f[_0x2807f0(0x31c)][_0x2807f0(0x2cd)]&&_0xcdcd2c[_0x2807f0(0x31c)][_0x2807f0(0x302)]==_0x2ab33f['_id'][_0x2807f0(0x302)]&&(_0x5039d9=_0x2ab33f[_0x2807f0(0x2fa)]);}var _0x14c964=0x0;for(let _0x10c877=0x0;_0x10c877<=_0x206557['length']-0x1;_0x10c877++){const _0x2ce81f=_0x206557[_0x10c877];_0xcdcd2c[_0x2807f0(0x31c)][_0x2807f0(0x2cd)]==_0x2ce81f[_0x2807f0(0x31c)]['product_code']&&_0xcdcd2c[_0x2807f0(0x31c)][_0x2807f0(0x302)]==_0x2ce81f['_id'][_0x2807f0(0x302)]&&(_0x14c964=_0x2ce81f[_0x2807f0(0x26a)]);}_0x272d7c=_0x398f3e-_0x14c964+_0x5039d9,_0x44abc3+=_0x2807f0(0x2f0)+_0x272d7c+'</td>';let _0x100698=![];for(let _0x1fd60b=0x0;_0x1fd60b<=_0x206557[_0x2807f0(0x241)]-0x1;_0x1fd60b++){const _0x46267a=_0x206557[_0x1fd60b];if(_0xcdcd2c[_0x2807f0(0x31c)][_0x2807f0(0x2cd)]==_0x46267a[_0x2807f0(0x31c)][_0x2807f0(0x2cd)]&&_0xcdcd2c[_0x2807f0(0x31c)]['product_name']==_0x46267a[_0x2807f0(0x31c)][_0x2807f0(0x302)]){_0x44abc3+='<td\x20class=\x22row_data\x22>'+_0x46267a['totalQTYsum']+_0x2807f0(0x293),_0x100698=!![];break;}}!_0x100698&&(_0x44abc3+=_0x2807f0(0x246));let _0x2d0925=![];for(let _0xad03d3=0x0;_0xad03d3<=_0x335c0e[_0x2807f0(0x241)]-0x1;_0xad03d3++){const _0x33f4cc=_0x335c0e[_0xad03d3];if(_0xcdcd2c[_0x2807f0(0x31c)][_0x2807f0(0x2cd)]==_0x33f4cc['_id'][_0x2807f0(0x2cd)]&&_0xcdcd2c[_0x2807f0(0x31c)]['product_name']==_0x33f4cc[_0x2807f0(0x31c)][_0x2807f0(0x302)]){_0x44abc3+=_0x2807f0(0x2f0)+_0x33f4cc['sumqty']+_0x2807f0(0x293),_0x2d0925=!![];break;}}!_0x2d0925&&(_0x44abc3+=_0x2807f0(0x246)),_0x44abc3+=_0x2807f0(0x2f0)+_0xcdcd2c[_0x2807f0(0x2fa)]+_0x2807f0(0x293),_0x44abc3+='</tr>';}return _0x44abc3;}router[a0_0x46c47e(0x321)](a0_0x46c47e(0x235),auth,async(_0x34dc09,_0x46c04f)=>{const _0x3527f0=a0_0x46c47e;try{const {from_date:_0x3128e6,to_date:_0x5dcebd}=_0x34dc09[_0x3527f0(0x30a)],_0x42478e=_0x34dc09[_0x3527f0(0x253)],_0x5e9e1d=await staff[_0x3527f0(0x244)]({'email':_0x42478e[_0x3527f0(0x228)]});let _0x575f51=_0x3527f0(0x21a);var _0xb140a9=new Date(_0x3128e6),_0xfe367c=new Date(_0x5dcebd);const _0x307190={'year':'numeric','month':_0x3527f0(0x296),'day':_0x3527f0(0x242)},_0x3d11e0=new Intl[(_0x3527f0(0x2f2))](_0x3527f0(0x318),_0x307190)[_0x3527f0(0x2f5)](_0xb140a9),_0xf3d472=new Intl[(_0x3527f0(0x2f2))](_0x3527f0(0x318),_0x307190)[_0x3527f0(0x2f5)](_0xfe367c);var _0x23430b=await dataInventoryReports(_0x3128e6,_0x5dcebd,_0x5e9e1d[_0x3527f0(0x31c)][_0x3527f0(0x28a)]());_0x575f51+=_0x3527f0(0x209),_0x575f51+='<p>INVENTORY\x20SUMMARY</p>',_0x575f51+='<p>'+_0x3d11e0+_0x3527f0(0x1dd)+_0xf3d472+'</p>',_0x575f51+=_0x3527f0(0x23d),_0x575f51+=_0x3527f0(0x309),_0x575f51+=_0x3527f0(0x252),_0x575f51+=_0x3527f0(0x29f),_0x575f51+=_0x3527f0(0x1c9),_0x575f51+=_0x3527f0(0x2f9),_0x575f51+=_0x3527f0(0x272),_0x575f51+='<th>\x20INCOMING\x20</th>',_0x575f51+=_0x3527f0(0x2f3),_0x575f51+=_0x3527f0(0x319),_0x575f51+=_0x3527f0(0x29f),_0x575f51+=_0x23430b,_0x575f51+=_0x3527f0(0x25d),_0x575f51+=_0x3527f0(0x21d),_0x575f51+=_0x3527f0(0x21d);const _0x4f706a={'format':'Letter','orientation':_0x3527f0(0x243)};pdf[_0x3527f0(0x1ce)](_0x575f51,_0x4f706a)['toStream'](function(_0x3d5827,_0x3b58cc){const _0x55e0ef=_0x3527f0;if(_0x3d5827){_0x46c04f[_0x55e0ef(0x2e9)](0x1f4)[_0x55e0ef(0x259)](_0x55e0ef(0x1d8));return;}_0x46c04f['setHeader'](_0x55e0ef(0x284),_0x55e0ef(0x1b8)),_0x3b58cc[_0x55e0ef(0x279)](_0x46c04f);});}catch(_0xee85c2){}}),router[a0_0x46c47e(0x31e)](a0_0x46c47e(0x204),auth,async(_0xb3b2a,_0x1d8d7d)=>{const _0x11f5ce=a0_0x46c47e;try{const {username:_0x3ebdc5,email:_0x40a475,role:_0x5c031d}=_0xb3b2a[_0x11f5ce(0x253)],_0x4eb598=_0xb3b2a['user'],_0x3e8e1d=await profile[_0x11f5ce(0x244)]({'email':_0x4eb598[_0x11f5ce(0x228)]}),_0x3e3013={'year':'numeric','month':_0x11f5ce(0x296),'day':_0x11f5ce(0x242)},_0x1d6e9b=await master_shop[_0x11f5ce(0x1b6)]();console[_0x11f5ce(0x1ef)](_0x11f5ce(0x256),_0x1d6e9b);const _0x4b1993=await product[_0x11f5ce(0x1b6)]();console[_0x11f5ce(0x1ef)](_0x11f5ce(0x2f7),_0x4b1993);const _0x2548b9=await warehouse[_0x11f5ce(0x1fc)]([{'$unwind':_0x11f5ce(0x255)},{'$lookup':{'from':'products','localField':_0x11f5ce(0x1d0),'foreignField':_0x11f5ce(0x248),'as':_0x11f5ce(0x1b9)}},{'$unwind':_0x11f5ce(0x2b9)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x11f5ce(0x1a0),'product_stock':{'$sum':_0x11f5ce(0x25c)}}}]);console[_0x11f5ce(0x1ef)](_0x11f5ce(0x1ab),_0x2548b9),_0x2548b9['forEach'](_0xa87f1a=>{const _0x410edf=_0x4b1993['map'](_0x1f4715=>{const _0x3f5180=a0_0x2fcf;_0x1f4715[_0x3f5180(0x248)]==_0xa87f1a[_0x3f5180(0x31c)]&&(_0x1f4715[_0x3f5180(0x2cb)]=parseInt(_0x1f4715['stock'])+parseInt(_0xa87f1a[_0x3f5180(0x222)]));});});const _0x211e99=await staff[_0x11f5ce(0x244)]({'email':_0x4eb598[_0x11f5ce(0x228)]});if(_0x1d6e9b[0x0][_0x11f5ce(0x230)]=='English\x20(US)')var _0x3849cd=users[_0x11f5ce(0x1ae)];else{if(_0x1d6e9b[0x0]['language']==_0x11f5ce(0x306))var _0x3849cd=users[_0x11f5ce(0x306)];else{if(_0x1d6e9b[0x0][_0x11f5ce(0x230)]=='German')var _0x3849cd=users[_0x11f5ce(0x22e)];else{if(_0x1d6e9b[0x0][_0x11f5ce(0x230)]==_0x11f5ce(0x292))var _0x3849cd=users[_0x11f5ce(0x292)];else{if(_0x1d6e9b[0x0][_0x11f5ce(0x230)]=='French')var _0x3849cd=users[_0x11f5ce(0x213)];else{if(_0x1d6e9b[0x0][_0x11f5ce(0x230)]==_0x11f5ce(0x1e4))var _0x3849cd=users[_0x11f5ce(0x2ad)];else{if(_0x1d6e9b[0x0][_0x11f5ce(0x230)]==_0x11f5ce(0x1a1))var _0x3849cd=users[_0x11f5ce(0x1a1)];else{if(_0x1d6e9b[0x0][_0x11f5ce(0x230)]=='Arabic\x20(ae)')var _0x3849cd=users[_0x11f5ce(0x1f4)];}}}}}}}_0x1d8d7d[_0x11f5ce(0x234)](_0x11f5ce(0x26d),{'success':_0xb3b2a[_0x11f5ce(0x1fb)](_0x11f5ce(0x231)),'errors':_0xb3b2a['flash'](_0x11f5ce(0x25f)),'alldata':_0x4b1993,'profile':_0x3e8e1d,'master_shop':_0x1d6e9b,'role':_0x4eb598,'product_stock':_0x2548b9,'language':_0x3849cd,'staff_arr':_0x211e99});}catch(_0xe5c3a){}});async function agentsdataDSICheck_DSRR(_0x17ecba,_0x2938b0,_0x11e6a3,_0x5cc87e){const _0x54ecd8=a0_0x46c47e;let _0x2283d6=new Date(_0x17ecba);_0x2283d6[_0x54ecd8(0x2ab)](_0x2283d6[_0x54ecd8(0x227)]()-0x1);let _0x133667=_0x2283d6[_0x54ecd8(0x1ba)]()['split']('T')[0x0];const _0xb07b89=await product[_0x54ecd8(0x1fc)]([{'$group':{'_id':{'brand':_0x54ecd8(0x27c),'category':'$category'},'products':{'$push':{'name':_0x54ecd8(0x278),'product_code':_0x54ecd8(0x21e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x145984=[];_0x145984['cat_brand']=[];for(let _0xd1d5d1=0x0;_0xd1d5d1<=_0xb07b89[_0x54ecd8(0x241)]-0x1;_0xd1d5d1++){const _0x1ebcef=_0xb07b89[_0xd1d5d1];_0x145984[_0x54ecd8(0x1bb)]['push'](_0x1ebcef);}const _0x3a6fbc=await product[_0x54ecd8(0x1fc)]([{'$group':{'_id':{'category':_0x54ecd8(0x1ad)},'products':{'$push':{'brand':_0x54ecd8(0x27c),'product_code':_0x54ecd8(0x21e),'product_name':_0x54ecd8(0x278)}}}},{'$sort':{'_id.category':-0x1}}]),_0x23cde0=await product[_0x54ecd8(0x1fc)]([{'$group':{'_id':{'category':_0x54ecd8(0x1ad),'brand':_0x54ecd8(0x27c)}}},{'$group':{'_id':_0x54ecd8(0x27a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x335e28=await sales_sa[_0x54ecd8(0x1fc)]([{'$match':{'date':_0x17ecba,'sales_staff_id':_0x2938b0,'sale_product.isFG':'false'}},{'$unwind':_0x54ecd8(0x2e3)},{'$lookup':{'from':_0x54ecd8(0x2dc),'localField':'sale_product.product_code','foreignField':_0x54ecd8(0x2cd),'as':_0x54ecd8(0x2a2)}},{'$unwind':_0x54ecd8(0x1d3)},{'$group':{'_id':{'dsi':'$dsi','date':_0x54ecd8(0x1fe),'customer':_0x54ecd8(0x2f4),'status_data':'$status_data'},'totalQty':{'$sum':_0x54ecd8(0x1ac)},'cash':{'$first':_0x54ecd8(0x1eb)},'amount':{'$first':_0x54ecd8(0x249)},'bank':{'$first':_0x54ecd8(0x2a9)},'check_no':{'$first':_0x54ecd8(0x219)},'due_date':{'$first':_0x54ecd8(0x211)},'products':{'$push':{'qty':_0x54ecd8(0x1ac),'NetPrice':_0x54ecd8(0x225),'discount':_0x54ecd8(0x1f5),'adj_discount':_0x54ecd8(0x1c1),'product_details':{'prod_name':_0x54ecd8(0x2b7),'product_code':_0x54ecd8(0x1cb),'category':_0x54ecd8(0x315),'brand':_0x54ecd8(0x310),'gross_price':'$product_info.gross_price','isFG':_0x54ecd8(0x23a),'prod_cat':_0x54ecd8(0x299),'prod_id':_0x54ecd8(0x1dc)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x54ecd8(0x236),'date':'$_id.date','customer':_0x54ecd8(0x2ef),'status_data':'$_id.status_data','category':_0x54ecd8(0x317),'brand':_0x54ecd8(0x22d),'prod_id':_0x54ecd8(0x1fa)},'totalQty':{'$sum':_0x54ecd8(0x21f)},'totalGross':{'$sum':{'$multiply':[_0x54ecd8(0x21f),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x54ecd8(0x2ee)},'discount':{'$sum':_0x54ecd8(0x224)},'adj_discount':{'$sum':_0x54ecd8(0x265)},'cash':{'$first':_0x54ecd8(0x1eb)},'amount':{'$first':_0x54ecd8(0x249)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x54ecd8(0x211)},'product_details':{'$first':_0x54ecd8(0x283)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x54ecd8(0x29e),'customer':'$_id.customer','status_data':_0x54ecd8(0x2a7)},'totalQty':{'$sum':_0x54ecd8(0x2d7)},'totalGross':{'$sum':_0x54ecd8(0x250)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x54ecd8(0x304)},'adj_discount':{'$sum':'$adj_discount'},'cash':{'$first':_0x54ecd8(0x1eb)},'amount':{'$first':_0x54ecd8(0x249)},'bank':{'$first':_0x54ecd8(0x2a9)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x54ecd8(0x211)},'products':{'$push':{'qty':_0x54ecd8(0x2d7),'category':_0x54ecd8(0x27a),'brand':'$_id.brand','product_details':_0x54ecd8(0x255)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x2a255f=await sales_sa[_0x54ecd8(0x1fc)]([{'$match':{'date':_0x133667,'sales_staff_id':_0x2938b0,'sale_product.isFG':_0x54ecd8(0x301)}},{'$unwind':_0x54ecd8(0x2e3)},{'$lookup':{'from':_0x54ecd8(0x2dc),'localField':'sale_product.product_code','foreignField':'product_code','as':_0x54ecd8(0x2a2)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x54ecd8(0x2e6),'date':_0x54ecd8(0x1fe),'customer':_0x54ecd8(0x2f4)},'totalQty':{'$sum':_0x54ecd8(0x1ac)},'cash':{'$first':_0x54ecd8(0x1eb)},'amount':{'$first':_0x54ecd8(0x249)},'bank':{'$first':_0x54ecd8(0x2a9)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x54ecd8(0x211)},'products':{'$push':{'qty':_0x54ecd8(0x1ac),'NetPrice':'$sale_product.totalprice','discount':_0x54ecd8(0x1f5),'adj_discount':_0x54ecd8(0x1c1),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x54ecd8(0x315),'brand':_0x54ecd8(0x310),'gross_price':'$product_info.gross_price','isFG':_0x54ecd8(0x23a),'prod_cat':_0x54ecd8(0x299),'prod_id':'$sale_product._id'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x54ecd8(0x236),'date':_0x54ecd8(0x29e),'customer':_0x54ecd8(0x2ef),'category':'$products.product_details.category','brand':'$products.product_details.brand','prod_id':_0x54ecd8(0x1fa)},'totalQty':{'$sum':_0x54ecd8(0x21f)},'cash':{'$first':_0x54ecd8(0x1eb)},'amount':{'$first':_0x54ecd8(0x249)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x54ecd8(0x211)},'totalGross':{'$sum':{'$multiply':[_0x54ecd8(0x21f),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x54ecd8(0x2ee)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x54ecd8(0x265)},'product_details':{'$first':_0x54ecd8(0x283)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x54ecd8(0x2ef)},'totalQty':{'$sum':_0x54ecd8(0x2d7)},'cash':{'$first':_0x54ecd8(0x1eb)},'amount':{'$first':_0x54ecd8(0x249)},'bank':{'$first':_0x54ecd8(0x2a9)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x54ecd8(0x211)},'totalGross':{'$sum':_0x54ecd8(0x250)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x54ecd8(0x304)},'adj_discount':{'$sum':_0x54ecd8(0x2b0)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x54ecd8(0x2bd),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x589b7f=await sales_sa[_0x54ecd8(0x1fc)]([{'$match':{'date':_0x17ecba,'sales_staff_id':_0x2938b0,'status_data':_0x54ecd8(0x2c8)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x599af2=await staff[_0x54ecd8(0x2cf)](_0x2938b0);let _0x148dd0=[],_0x935a21={},_0x3c3bf1={};var _0x251d5b=0x0,_0x2772c3=0x0,_0x4e85aa=0x0,_0x15db1d=0x0,_0x3d9acb=0x0;const _0x3e0952=0x6;var _0x8d2766=0x0,_0x17b625=0x0;for(let _0x1274aa=0x0;_0x1274aa<=_0x335e28[_0x54ecd8(0x241)]-0x1;_0x1274aa++){const _0x5aa366=_0x335e28[_0x1274aa];let _0x5ada21=_0x54ecd8(0x29f);_0x5ada21+=_0x54ecd8(0x239),_0x5ada21+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5aa366[_0x54ecd8(0x31c)][_0x54ecd8(0x2b1)]+_0x54ecd8(0x293),_0x5ada21+=_0x54ecd8(0x31a)+_0x5aa366[_0x54ecd8(0x31c)]['dsi']+'</td>';let _0x4f9f43={},_0x819842={},_0x5dfefb={};var _0x5e0a5d={},_0x2c5caf={},_0x1434e2={},_0x379a86=0x0;for(let _0x1930a1=0x0;_0x1930a1<=_0x5aa366[_0x54ecd8(0x2dc)]['length']-0x1;_0x1930a1++){const _0x2aafda=_0x5aa366['products'][_0x1930a1];_0x4f9f43[_0x2aafda['brand']+'-'+_0x2aafda['category']]=_0x2aafda['qty'],_0x819842[[_0x2aafda[_0x54ecd8(0x2c7)]+'-'+_0x2aafda[_0x54ecd8(0x2b3)]]]=_0x2aafda['product_details'][_0x54ecd8(0x27e)],_0x5dfefb[[_0x2aafda[_0x54ecd8(0x2c7)]+'-'+_0x2aafda['category']]]=_0x2aafda[_0x54ecd8(0x262)]['prod_cat'];const _0x4f9926=_0x2aafda[_0x54ecd8(0x2c7)]+'-'+_0x2aafda['category'];!Array[_0x54ecd8(0x2fc)](_0x3c3bf1[_0x4f9926])&&(_0x3c3bf1[_0x4f9926]=[]);!Array[_0x54ecd8(0x2fc)](_0x3c3bf1[_0x4f9926])&&(_0x3c3bf1[_0x4f9926]=[]);_0x3c3bf1[_0x4f9926][_0x54ecd8(0x26c)](_0x2aafda[_0x54ecd8(0x269)]);if(_0x2aafda['product_details'][_0x54ecd8(0x1ec)]=='P')_0x2aafda[_0x54ecd8(0x262)][_0x54ecd8(0x27e)]==_0x54ecd8(0x2c8)?(!_0x1434e2[_0x4f9926]&&(_0x1434e2[_0x4f9926]=0x0),_0x1434e2[_0x4f9926]=_0x2aafda[_0x54ecd8(0x269)]):(!_0x5e0a5d[_0x4f9926]&&(_0x5e0a5d[_0x4f9926]=0x0),_0x5e0a5d[_0x4f9926]=_0x2aafda[_0x54ecd8(0x269)]);else _0x2aafda[_0x54ecd8(0x262)][_0x54ecd8(0x1ec)]=='S'&&(_0x2aafda[_0x54ecd8(0x262)][_0x54ecd8(0x27e)]=='true'?(!_0x1434e2[_0x4f9926]&&(_0x1434e2[_0x4f9926]=0x0),_0x1434e2[_0x4f9926]=_0x2aafda[_0x54ecd8(0x269)]):(!_0x2c5caf[_0x4f9926]&&(_0x2c5caf[_0x4f9926]=0x0),_0x2c5caf[_0x4f9926]=_0x2aafda[_0x54ecd8(0x269)]));_0x379a86++;}for(let _0x32a665=0x0;_0x32a665<=_0x145984[_0x54ecd8(0x1bb)][_0x54ecd8(0x241)]-0x1;_0x32a665++){const _0x253b89=_0x145984[_0x54ecd8(0x1bb)][_0x32a665],_0x5ac145=_0x253b89['_id']['brand']+'-'+_0x253b89[_0x54ecd8(0x31c)]['category'],_0x2322b7=_0x5dfefb[_0x5ac145]!==undefined?_0x5dfefb[_0x5ac145]:'NA';var _0x253656=_0x5e0a5d[_0x5ac145]!==undefined?_0x5e0a5d[_0x5ac145]['toFixed'](0x2):'',_0x5f46b9=_0x2c5caf[_0x5ac145]!==undefined?_0x2c5caf[_0x5ac145][_0x54ecd8(0x1b2)](0x2):'',_0x319fea=_0x1434e2[_0x5ac145]!==undefined?_0x1434e2[_0x5ac145][_0x54ecd8(0x1b2)](0x2):'';_0x5ada21+=_0x54ecd8(0x31d)+_0x253656+_0x54ecd8(0x293),_0x5ada21+=_0x54ecd8(0x31d)+_0x5f46b9+_0x54ecd8(0x293),_0x5ada21+=_0x54ecd8(0x31d)+_0x319fea+_0x54ecd8(0x293);}var _0x14f2de=formatNumber(parseFloat(_0x5aa366['cash'])),_0x287afd=formatNumber(parseFloat(_0x5aa366[_0x54ecd8(0x1c7)]));isNaN(_0x287afd)&&(_0x287afd=0x0),_0x5ada21+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x14f2de+'</td>',_0x5ada21+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x287afd+'</td>',_0x5ada21+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5aa366[_0x54ecd8(0x2c3)]+_0x54ecd8(0x293),_0x5ada21+=_0x54ecd8(0x31a)+_0x5aa366['check_no']+'</td>',_0x5ada21+=_0x54ecd8(0x31a)+_0x5aa366[_0x54ecd8(0x30c)]+'</td>',_0x4e85aa=_0x5aa366[_0x54ecd8(0x1e9)]+_0x5aa366[_0x54ecd8(0x2b6)],_0x8d2766+=parseFloat(_0x5aa366[_0x54ecd8(0x20f)]),_0x17b625+=parseFloat(_0x287afd),_0x148dd0['push'](_0x5ada21);}function _0xc1bcba(_0x350a76,_0x518cc0){const _0x4029a4=_0x54ecd8,_0x7c971c=[];for(let _0x464382=0x0;_0x464382<=_0x350a76[_0x4029a4(0x241)]-0x1;_0x464382+=_0x518cc0){_0x7c971c[_0x4029a4(0x26c)](_0x350a76[_0x4029a4(0x2e5)](_0x464382,_0x464382+_0x518cc0));}return _0x7c971c;}const _0x582a53=_0xc1bcba(_0x148dd0,_0x3e0952);let _0x42adfa='';return _0x582a53[_0x54ecd8(0x1af)]((_0x10c5cf,_0x39b14e)=>{const _0x295832=_0x54ecd8;_0x39b14e>0x0&&(_0x42adfa+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x42adfa+=_0x295832(0x252),_0x42adfa+=_0x295832(0x2aa);const _0x246075=new Date(_0x17ecba),_0x10f00d={'year':_0x295832(0x242),'month':_0x295832(0x296),'day':_0x295832(0x242),'timeZone':_0x295832(0x22f)},_0x51c219=_0x246075['toLocaleDateString'](_0x295832(0x318),_0x10f00d);_0x42adfa+='<tr>',_0x42adfa+=_0x295832(0x1b7)+_0x5cc87e+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x254)+_0x599af2[_0x295832(0x248)]+_0x295832(0x293),_0x42adfa+=_0x295832(0x316),_0x42adfa+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x42adfa+=_0x295832(0x286),_0x42adfa+=_0x295832(0x214),_0x42adfa+=_0x295832(0x2d2),_0x42adfa+=_0x295832(0x1d4),_0x42adfa+=_0x295832(0x19e),_0x42adfa+=_0x295832(0x271),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x2d5),_0x42adfa+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20'+_0x51c219+_0x295832(0x293),_0x42adfa+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>',_0x42adfa+=_0x295832(0x28d),_0x42adfa+=_0x295832(0x20a),_0x42adfa+=_0x295832(0x20a),_0x42adfa+=_0x295832(0x25d),_0x42adfa+='<tr>',_0x42adfa+=_0x295832(0x208),_0x42adfa+=_0x295832(0x217),_0x42adfa+=_0x295832(0x238),_0x42adfa+=_0x295832(0x20a),_0x42adfa+=_0x295832(0x20a),_0x42adfa+=_0x295832(0x25d),_0x42adfa+='<tr>',_0x42adfa+=_0x295832(0x270),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x1ff),_0x42adfa+=_0x295832(0x2a3),_0x42adfa+='</tr>',_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x1f1),_0x42adfa+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x42adfa+=_0x295832(0x2a5);for(let _0x14b800=0x0;_0x14b800<=_0x3a6fbc['length']-0x1;_0x14b800++){const _0x52dccd=_0x3a6fbc[_0x14b800];for(let _0xf66cb3=0x0;_0xf66cb3<_0x145984['cat_brand'][_0x295832(0x241)];_0xf66cb3++){const _0x1a0bd8=_0x145984[_0x295832(0x1bb)][_0xf66cb3];if(_0x1a0bd8['_id']['category']===_0x52dccd[_0x295832(0x31c)][_0x295832(0x2b3)]){var _0x4bad08='';switch(_0x52dccd[_0x295832(0x31c)][_0x295832(0x2b3)]){case'Standard':_0x4bad08=_0x1a0bd8[_0x295832(0x31c)][_0x295832(0x2c7)]+_0x295832(0x1a3);break;case'Household':_0x4bad08=_0x1a0bd8[_0x295832(0x31c)][_0x295832(0x2c7)]+'\x20-\x20HH';break;default:_0x4bad08=_0x1a0bd8[_0x295832(0x31c)][_0x295832(0x2c7)];break;}_0x42adfa+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>'+_0x4bad08+_0x295832(0x2c9);}}}_0x42adfa+=_0x295832(0x1e8),_0x42adfa+=_0x295832(0x1f6),_0x42adfa+=_0x295832(0x1c5),_0x42adfa+='</tr>',_0x42adfa+=_0x295832(0x29f),_0x42adfa+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x253654=0x0;_0x253654<=_0x145984[_0x295832(0x1bb)][_0x295832(0x241)]-0x1;_0x253654++){const _0x305397=_0x145984[_0x253654];_0x42adfa+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x42adfa+=_0x295832(0x1a4),_0x42adfa+=_0x295832(0x2c6);}_0x42adfa+=_0x295832(0x1cc),_0x42adfa+=_0x295832(0x273),_0x42adfa+=_0x295832(0x2c5),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x201),_0x42adfa+=_0x295832(0x200),_0x10c5cf[_0x295832(0x1af)](_0x1d499f=>{_0x42adfa+=_0x1d499f;});let _0x2dc960={},_0x2fbf76={},_0x4f9270={};for(let _0x3c8f24=0x0;_0x3c8f24<=_0x335e28[_0x295832(0x241)]-0x1;_0x3c8f24++){const _0x19b479=_0x335e28[_0x3c8f24];var _0x5dd43a=0x0;for(let _0x56e1a7=0x0;_0x56e1a7<=_0x19b479[_0x295832(0x2dc)][_0x295832(0x241)]-0x1;_0x56e1a7++){const _0x367a56=_0x19b479[_0x295832(0x2dc)][_0x56e1a7],_0xc9b74a=_0x367a56['brand']+'-'+_0x367a56[_0x295832(0x2b3)];if(_0x367a56[_0x295832(0x262)][_0x295832(0x1ec)]=='P')_0x367a56[_0x295832(0x262)][_0x295832(0x27e)]==_0x295832(0x2c8)?(!_0x4f9270[_0xc9b74a]&&(_0x4f9270[_0xc9b74a]=0x0),_0x4f9270[_0xc9b74a]+=_0x367a56[_0x295832(0x269)]):(!_0x2dc960[_0xc9b74a]&&(_0x2dc960[_0xc9b74a]=0x0),_0x2dc960[_0xc9b74a]+=_0x367a56['qty']);else _0x367a56[_0x295832(0x262)]['prod_cat']=='S'&&(_0x367a56['product_details'][_0x295832(0x27e)]=='true'?(!_0x4f9270[_0xc9b74a]&&(_0x4f9270[_0xc9b74a]=0x0),_0x4f9270[_0xc9b74a]+=_0x367a56[_0x295832(0x269)],console[_0x295832(0x1ef)](_0x367a56[_0x295832(0x269)])):(!_0x2fbf76[_0xc9b74a]&&(_0x2fbf76[_0xc9b74a]=0x0),_0x2fbf76[_0xc9b74a]+=_0x367a56[_0x295832(0x269)]));_0x5dd43a++;}}let _0x589ccb={},_0x165935={},_0x2aeb65={};var _0x3bcbf7=0x0,_0x5bfcba=0x0;for(let _0x17f211=0x0;_0x17f211<=_0x2a255f['length']-0x1;_0x17f211++){const _0x23bf9d=_0x2a255f[_0x17f211];var _0x5dd43a=0x0;for(let _0x4cf5ab=0x0;_0x4cf5ab<=_0x23bf9d['products'][_0x295832(0x241)]-0x1;_0x4cf5ab++){const _0xc42095=_0x23bf9d[_0x295832(0x2dc)][_0x4cf5ab],_0x58a264=_0xc42095['brand']+'-'+_0xc42095[_0x295832(0x2b3)];if(_0xc42095['product_details']['prod_cat']=='P')_0xc42095[_0x295832(0x262)][_0x295832(0x27e)]==_0x295832(0x2c8)?(!_0x2aeb65[_0x58a264]&&(_0x2aeb65[_0x58a264]=0x0),_0x2aeb65[_0x58a264]+=_0xc42095[_0x295832(0x269)]):(!_0x589ccb[_0x58a264]&&(_0x589ccb[_0x58a264]=0x0),_0x589ccb[_0x58a264]+=_0xc42095['qty']);else _0xc42095[_0x295832(0x262)][_0x295832(0x1ec)]=='S'&&(_0xc42095['product_details'][_0x295832(0x27e)]=='true'?(!_0x2aeb65[_0x58a264]&&(_0x2aeb65[_0x58a264]=0x0),_0x2aeb65[_0x58a264]+=_0xc42095[_0x295832(0x269)]):(!_0x165935[_0x58a264]&&(_0x165935[_0x58a264]=0x0),_0x165935[_0x58a264]+=_0xc42095['qty']));_0x5dd43a++;}var _0x14f18a=parseFloat(_0x23bf9d[_0x295832(0x20f)]),_0x57f48c=parseFloat(_0x23bf9d[_0x295832(0x1c7)]);isNaN(_0x57f48c)&&(_0x57f48c=0x0),_0x3bcbf7+=_0x14f18a,_0x5bfcba+=_0x57f48c;}if(_0x589b7f[_0x295832(0x241)]>0x0)for(let _0x423c2e=0x0;_0x423c2e<=_0x589b7f['length']-0x1;_0x423c2e++){const _0x1ab572=_0x589b7f[_0x423c2e];console[_0x295832(0x1ef)](_0x1ab572),_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x22c)+(0x8+0x7*0x3)+_0x295832(0x1f9)+_0x1ab572['note']+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x25d);}_0x42adfa+=_0x295832(0x29f),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x42adfa+=_0x295832(0x2a1),_0x42adfa+=_0x295832(0x239);for(let _0x3b943f=0x0;_0x3b943f<=_0x145984['cat_brand'][_0x295832(0x241)]-0x1;_0x3b943f++){const _0x518750=_0x145984['cat_brand'][_0x3b943f],_0x1d9ff0=_0x518750['_id'][_0x295832(0x2c7)]+'-'+_0x518750['_id'][_0x295832(0x2b3)];var _0x56ed00=_0x2dc960[_0x1d9ff0]!==undefined?formatNumber(_0x2dc960[_0x1d9ff0][_0x295832(0x1b2)](0x2)):'',_0x17a923=_0x4f9270[_0x1d9ff0]!==undefined?formatNumber(_0x4f9270[_0x1d9ff0][_0x295832(0x1b2)](0x2)):'',_0x6eb400=_0x2fbf76[_0x1d9ff0]!==undefined?formatNumber(_0x2fbf76[_0x1d9ff0][_0x295832(0x1b2)](0x2)):'';_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x56ed00+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x2a4)+_0x6eb400+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x2a4)+_0x17a923+'</b></td>';}_0x42adfa+=_0x295832(0x2a4)+formatNumber(_0x8d2766)+_0x295832(0x2c9),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x17b625)+'</b></td>',_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x2e8),_0x42adfa+=_0x295832(0x2b5),_0x42adfa+=_0x295832(0x239);for(let _0x376f12=0x0;_0x376f12<=_0x145984[_0x295832(0x1bb)]['length']-0x1;_0x376f12++){const _0x2a6449=_0x145984[_0x295832(0x1bb)][_0x376f12],_0x55aa19=_0x2a6449[_0x295832(0x31c)]['brand']+'-'+_0x2a6449[_0x295832(0x31c)][_0x295832(0x2b3)];var _0x56ed00=_0x589ccb[_0x55aa19]!==undefined?formatNumber(_0x589ccb[_0x55aa19]['toFixed'](0x2)):'',_0x17a923=_0x2aeb65[_0x55aa19]!==undefined?formatNumber(_0x2aeb65[_0x55aa19]['toFixed'](0x2)):'',_0x6eb400=_0x165935[_0x55aa19]!==undefined?formatNumber(_0x165935[_0x55aa19]['toFixed'](0x2)):'';_0x42adfa+=_0x295832(0x2a4)+_0x56ed00+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x2a4)+_0x6eb400+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x2a4)+_0x17a923+_0x295832(0x2c9);}_0x42adfa+=_0x295832(0x2a4)+formatNumber(_0x3bcbf7)+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x2a4)+formatNumber(_0x5bfcba)+'</b></td>',_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+='</tr>',_0x42adfa+='<tr>',_0x42adfa+=_0x295832(0x2e8),_0x42adfa+=_0x295832(0x2ac),_0x42adfa+=_0x295832(0x239);let _0x575080=0x0,_0x560084=0x0,_0x2ba9b9=0x0;for(let _0x10aac0=0x0;_0x10aac0<=_0x145984[_0x295832(0x1bb)][_0x295832(0x241)]-0x1;_0x10aac0++){const _0x11ae41=_0x145984[_0x295832(0x1bb)][_0x10aac0],_0x38150e=_0x11ae41['_id'][_0x295832(0x2c7)]+'-'+_0x11ae41[_0x295832(0x31c)][_0x295832(0x2b3)];var _0x4eabff=_0x2dc960[_0x38150e]!==undefined?_0x2dc960[_0x38150e][_0x295832(0x1b2)](0x2):'0',_0x2d01a9=_0x4f9270[_0x38150e]!==undefined?_0x4f9270[_0x38150e][_0x295832(0x1b2)](0x2):'0',_0x3a2160=_0x2fbf76[_0x38150e]!==undefined?_0x2fbf76[_0x38150e][_0x295832(0x1b2)](0x2):'0',_0x258d3a=_0x589ccb[_0x38150e]!==undefined?_0x589ccb[_0x38150e]['toFixed'](0x2):'0',_0x2d57be=_0x2aeb65[_0x38150e]!==undefined?_0x2aeb65[_0x38150e]['toFixed'](0x2):'0',_0x3cb730=_0x165935[_0x38150e]!==undefined?_0x165935[_0x38150e][_0x295832(0x1b2)](0x2):'0';_0x575080=parseFloat(_0x4eabff)+parseFloat(_0x258d3a),_0x560084=parseFloat(_0x3a2160)+parseFloat(_0x3cb730),_0x2ba9b9=parseFloat(_0x2d01a9)+parseFloat(_0x2d57be),_0x42adfa+=_0x295832(0x2a4)+formatNumber(_0x575080[_0x295832(0x1b2)](0x2))+'</b></td>',_0x42adfa+=_0x295832(0x2a4)+formatNumber(_0x560084[_0x295832(0x1b2)](0x2))+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x2a4)+formatNumber(_0x2ba9b9[_0x295832(0x1b2)](0x2))+_0x295832(0x2c9);}var _0x23c100=formatNumber(_0x8d2766+_0x3bcbf7),_0x1d02c7=formatNumber(_0x17b625+_0x5bfcba);_0x42adfa+=_0x295832(0x2a4)+_0x23c100+_0x295832(0x2c9),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1d02c7+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x305)+(_0x145984[_0x295832(0x1bb)][_0x295832(0x241)]*0x3+0x9)+_0x295832(0x2f8),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x42adfa+=_0x295832(0x239);for(let _0x4d1a0e=0x0;_0x4d1a0e<=_0x145984[_0x295832(0x1bb)][_0x295832(0x241)]-0x1;_0x4d1a0e++){const _0x1b4e4e=_0x145984[_0x295832(0x1bb)][_0x4d1a0e],_0x1cf868=_0x1b4e4e[_0x295832(0x31c)][_0x295832(0x2c7)]+'-'+_0x1b4e4e[_0x295832(0x31c)][_0x295832(0x2b3)];var _0x4eabff=_0x2dc960[_0x1cf868]!==undefined?_0x2dc960[_0x1cf868][_0x295832(0x1b2)](0x2):'0',_0x2d01a9=_0x4f9270[_0x1cf868]!==undefined?_0x4f9270[_0x1cf868][_0x295832(0x1b2)](0x2):'0',_0x3a2160=_0x2fbf76[_0x1cf868]!==undefined?_0x2fbf76[_0x1cf868][_0x295832(0x1b2)](0x2):'0',_0x258d3a=_0x589ccb[_0x1cf868]!==undefined?_0x589ccb[_0x1cf868][_0x295832(0x1b2)](0x2):'0',_0x2d57be=_0x2aeb65[_0x1cf868]!==undefined?_0x2aeb65[_0x1cf868][_0x295832(0x1b2)](0x2):'0',_0x3cb730=_0x165935[_0x1cf868]!==undefined?_0x165935[_0x1cf868][_0x295832(0x1b2)](0x2):'0';_0x575080=parseFloat(_0x4eabff)+parseFloat(_0x258d3a),_0x560084=parseFloat(_0x3a2160)+parseFloat(_0x3cb730),_0x2ba9b9=parseFloat(_0x2d01a9)+parseFloat(_0x2d57be),_0x42adfa+=_0x295832(0x2eb),_0x42adfa+=_0x295832(0x2eb),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x2e8),_0x42adfa+=_0x295832(0x1e2),_0x42adfa+=_0x295832(0x239);for(let _0x3361e4=0x0;_0x3361e4<=_0x145984[_0x295832(0x1bb)][_0x295832(0x241)]-0x1;_0x3361e4++){const _0x3371a9=_0x145984[_0x295832(0x1bb)][_0x3361e4],_0x55dbf6=_0x3371a9[_0x295832(0x31c)]['brand']+'-'+_0x3371a9['_id'][_0x295832(0x2b3)];var _0x4eabff=_0x2dc960[_0x55dbf6]!==undefined?_0x2dc960[_0x55dbf6]['toFixed'](0x2):'0',_0x2d01a9=_0x4f9270[_0x55dbf6]!==undefined?_0x4f9270[_0x55dbf6][_0x295832(0x1b2)](0x2):'0',_0x3a2160=_0x2fbf76[_0x55dbf6]!==undefined?_0x2fbf76[_0x55dbf6][_0x295832(0x1b2)](0x2):'0',_0x258d3a=_0x589ccb[_0x55dbf6]!==undefined?_0x589ccb[_0x55dbf6]['toFixed'](0x2):'0',_0x2d57be=_0x2aeb65[_0x55dbf6]!==undefined?_0x2aeb65[_0x55dbf6]['toFixed'](0x2):'0',_0x3cb730=_0x165935[_0x55dbf6]!==undefined?_0x165935[_0x55dbf6][_0x295832(0x1b2)](0x2):'0';_0x575080=parseFloat(_0x4eabff)+parseFloat(_0x258d3a),_0x560084=parseFloat(_0x3a2160)+parseFloat(_0x3cb730),_0x2ba9b9=parseFloat(_0x2d01a9)+parseFloat(_0x2d57be),_0x42adfa+=_0x295832(0x2eb),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x42adfa+=_0x295832(0x311),_0x42adfa+=_0x295832(0x239);for(let _0x2fa2f4=0x0;_0x2fa2f4<=_0x145984[_0x295832(0x1bb)][_0x295832(0x241)]-0x1;_0x2fa2f4++){const _0x45c6e6=_0x145984[_0x295832(0x1bb)][_0x2fa2f4],_0x3d26e8=_0x45c6e6[_0x295832(0x31c)][_0x295832(0x2c7)]+'-'+_0x45c6e6[_0x295832(0x31c)]['category'];var _0x4eabff=_0x2dc960[_0x3d26e8]!==undefined?_0x2dc960[_0x3d26e8]['toFixed'](0x2):'0',_0x2d01a9=_0x4f9270[_0x3d26e8]!==undefined?_0x4f9270[_0x3d26e8][_0x295832(0x1b2)](0x2):'0',_0x3a2160=_0x2fbf76[_0x3d26e8]!==undefined?_0x2fbf76[_0x3d26e8][_0x295832(0x1b2)](0x2):'0',_0x258d3a=_0x589ccb[_0x3d26e8]!==undefined?_0x589ccb[_0x3d26e8]['toFixed'](0x2):'0',_0x2d57be=_0x2aeb65[_0x3d26e8]!==undefined?_0x2aeb65[_0x3d26e8][_0x295832(0x1b2)](0x2):'0',_0x3cb730=_0x165935[_0x3d26e8]!==undefined?_0x165935[_0x3d26e8][_0x295832(0x1b2)](0x2):'0';_0x575080=parseFloat(_0x4eabff)+parseFloat(_0x258d3a),_0x560084=parseFloat(_0x3a2160)+parseFloat(_0x3cb730),_0x2ba9b9=parseFloat(_0x2d01a9)+parseFloat(_0x2d57be),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x42adfa+=_0x295832(0x2eb),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x25d),_0x42adfa+='<tr>',_0x42adfa+=_0x295832(0x2e8),_0x42adfa+=_0x295832(0x2a1),_0x42adfa+=_0x295832(0x239);for(let _0x528a29=0x0;_0x528a29<=_0x145984[_0x295832(0x1bb)][_0x295832(0x241)]-0x1;_0x528a29++){const _0x1c50c5=_0x145984[_0x295832(0x1bb)][_0x528a29],_0x21ee5a=_0x1c50c5[_0x295832(0x31c)][_0x295832(0x2c7)]+'-'+_0x1c50c5[_0x295832(0x31c)]['category'];var _0x4eabff=_0x2dc960[_0x21ee5a]!==undefined?_0x2dc960[_0x21ee5a][_0x295832(0x1b2)](0x2):'',_0x2d01a9=_0x4f9270[_0x21ee5a]!==undefined?_0x4f9270[_0x21ee5a][_0x295832(0x1b2)](0x2):'',_0x3a2160=_0x2fbf76[_0x21ee5a]!==undefined?_0x2fbf76[_0x21ee5a][_0x295832(0x1b2)](0x2):'',_0x258d3a=_0x589ccb[_0x21ee5a]!==undefined?_0x589ccb[_0x21ee5a]['toFixed'](0x2):'',_0x2d57be=_0x2aeb65[_0x21ee5a]!==undefined?_0x2aeb65[_0x21ee5a][_0x295832(0x1b2)](0x2):'',_0x3cb730=_0x165935[_0x21ee5a]!==undefined?_0x165935[_0x21ee5a]['toFixed'](0x2):'';_0x575080=formatNumber(parseFloat(_0x4eabff)+parseFloat(_0x258d3a)),_0x560084=formatNumber(parseFloat(_0x3a2160)+parseFloat(_0x3cb730)),_0x2ba9b9=formatNumber(parseFloat(_0x2d01a9)+parseFloat(_0x2d57be)),_0x42adfa+=_0x295832(0x2a4)+_0x4eabff+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x2a4)+_0x3a2160+_0x295832(0x2c9),_0x42adfa+=_0x295832(0x2a4)+_0x2d01a9+_0x295832(0x2c9);}_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x25d),_0x42adfa+=_0x295832(0x29f),_0x42adfa+=_0x295832(0x2e8),_0x42adfa+=_0x295832(0x20e),_0x42adfa+=_0x295832(0x239);for(let _0x46c367=0x0;_0x46c367<=_0x145984[_0x295832(0x1bb)][_0x295832(0x241)]-0x1;_0x46c367++){const _0x179023=_0x145984[_0x295832(0x1bb)][_0x46c367],_0x4d20d5=_0x179023[_0x295832(0x31c)][_0x295832(0x2c7)]+'-'+_0x179023[_0x295832(0x31c)][_0x295832(0x2b3)];var _0x4eabff=_0x2dc960[_0x4d20d5]!==undefined?_0x2dc960[_0x4d20d5][_0x295832(0x1b2)](0x2):'0',_0x2d01a9=_0x4f9270[_0x4d20d5]!==undefined?_0x4f9270[_0x4d20d5][_0x295832(0x1b2)](0x2):'0',_0x3a2160=_0x2fbf76[_0x4d20d5]!==undefined?_0x2fbf76[_0x4d20d5][_0x295832(0x1b2)](0x2):'0',_0x258d3a=_0x589ccb[_0x4d20d5]!==undefined?_0x589ccb[_0x4d20d5]['toFixed'](0x2):'0',_0x2d57be=_0x2aeb65[_0x4d20d5]!==undefined?_0x2aeb65[_0x4d20d5]['toFixed'](0x2):'0',_0x3cb730=_0x165935[_0x4d20d5]!==undefined?_0x165935[_0x4d20d5][_0x295832(0x1b2)](0x2):'0';_0x575080=parseFloat(_0x4eabff)+parseFloat(_0x258d3a),_0x560084=parseFloat(_0x3a2160)+parseFloat(_0x3cb730),_0x2ba9b9=parseFloat(_0x2d01a9)+parseFloat(_0x2d57be),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x42adfa+=_0x295832(0x2eb),_0x42adfa+=_0x295832(0x2eb);}_0x42adfa+=_0x295832(0x239),_0x42adfa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+=_0x295832(0x239),_0x42adfa+='</tr>',_0x42adfa+=_0x295832(0x212),_0x42adfa+='</table>';}),_0x42adfa;}async function generateReferenceNumber(_0x14bf1a,_0x1ffc8b,_0x575e60){const _0x1cc4e1=a0_0x46c47e,_0x304444=new Date(_0x14bf1a)['getFullYear'](),_0x427230=('0'+(new Date(_0x14bf1a)[_0x1cc4e1(0x1d1)]()+0x1))['slice'](-0x2),_0x351b6a=('0'+new Date(_0x14bf1a)[_0x1cc4e1(0x227)]())['slice'](-0x2),_0x50092b=await staff[_0x1cc4e1(0x244)]({'email':_0x575e60['email']}),_0x4dc422=_0x50092b[_0x1cc4e1(0x1ca)],_0x301955=_0x4dc422+'-'+_0x304444+_0x427230+_0x351b6a,_0x1ffb0b=await Reference[_0x1cc4e1(0x244)]({'referenceNumber':new RegExp('^'+_0x301955),'salesman_code':_0x4dc422})[_0x1cc4e1(0x28f)]({'createdAt':-0x1}),_0x53a830=_0x301955;_0x1ffb0b&&(_0x53a830=_0x1ffb0b[_0x1cc4e1(0x2fd)]);console[_0x1cc4e1(0x1ef)](_0x53a830);const _0x4f4815=new Reference({'referenceNumber':_0x53a830,'staff_id':_0x1ffc8b,'salesman_code':_0x4dc422});return await _0x4f4815[_0x1cc4e1(0x1c4)](),_0x53a830;}router[a0_0x46c47e(0x321)](a0_0x46c47e(0x2c2),auth,async(_0x4f64ff,_0x347d91)=>{const _0x433d69=a0_0x46c47e,{from_date:_0x54db5c,dataview:_0x18abc8}=_0x4f64ff[_0x433d69(0x30a)],_0x4e2587=_0x4f64ff[_0x433d69(0x253)],_0x26e838=await staff['findOne']({'email':_0x4e2587[_0x433d69(0x228)]}),_0x150406=await master_shop['find'](),_0x15e6ff='';var _0x35544c=new Date(_0x54db5c);const _0xc34e95={'year':'numeric','month':_0x433d69(0x296),'day':_0x433d69(0x242)},_0x105c5b=new Intl[(_0x433d69(0x2f2))](_0x433d69(0x318),_0xc34e95)[_0x433d69(0x2f5)](_0x35544c),_0x5208cf=await Reference[_0x433d69(0x1b6)]({'staff_id':_0x26e838[_0x433d69(0x31c)][_0x433d69(0x28a)](),'date_include':_0x54db5c});if(_0x5208cf[_0x433d69(0x241)]>0x0){let _0x3bb226='';_0x3bb226+=_0x5208cf[0x0][_0x433d69(0x25b)];if(_0x18abc8=='excel'){const _0xf4df2=cheerio['load'](_0x3bb226);let _0x5899ae=[],_0x504940=[],_0x329c81=[];const _0x467bfe=_0x207a01=>{const _0x47ee12=_0x433d69,_0x329b24={'top':{'style':_0x47ee12(0x24c),'color':{'rgb':_0x47ee12(0x2f6)}},'bottom':{'style':_0x47ee12(0x24c),'color':{'rgb':_0x47ee12(0x2f6)}},'left':{'style':_0x47ee12(0x24c),'color':{'rgb':'000000'}},'right':{'style':_0x47ee12(0x24c),'color':{'rgb':'000000'}}};if(_0x207a01){const _0x284a08=_0x207a01[_0x47ee12(0x295)](';')[_0x47ee12(0x27d)]((_0x454ff3,_0x148377)=>{const _0x42c21b=_0x47ee12,[_0x2b506f,_0x5aed84]=_0x148377[_0x42c21b(0x295)](':')[_0x42c21b(0x28b)](_0x11a938=>_0x11a938[_0x42c21b(0x290)]());return _0x454ff3[_0x2b506f]=_0x5aed84,_0x454ff3;},{});_0x284a08[_0x47ee12(0x216)]&&(_0x329b24[_0x47ee12(0x1bf)][_0x47ee12(0x1c2)]=_0x284a08[_0x47ee12(0x216)][_0x47ee12(0x1be)](_0x47ee12(0x314))?_0x47ee12(0x314):_0x47ee12(0x218)),_0x284a08[_0x47ee12(0x2e7)]&&(_0x329b24[_0x47ee12(0x25a)][_0x47ee12(0x1c2)]=_0x284a08[_0x47ee12(0x2e7)]['includes']('thin')?'thin':_0x47ee12(0x218)),_0x284a08[_0x47ee12(0x245)]&&(_0x329b24['left'][_0x47ee12(0x1c2)]=_0x284a08[_0x47ee12(0x245)][_0x47ee12(0x1be)](_0x47ee12(0x314))?_0x47ee12(0x314):_0x47ee12(0x218)),_0x284a08[_0x47ee12(0x206)]&&(_0x329b24[_0x47ee12(0x2e2)]['style']=_0x284a08[_0x47ee12(0x206)][_0x47ee12(0x1be)](_0x47ee12(0x314))?_0x47ee12(0x314):_0x47ee12(0x218));}return _0x329b24;};_0xf4df2('table\x20tr')[_0x433d69(0x282)]((_0x4fa5e4,_0x57f3d0)=>{const _0x1c6a25=_0x433d69;let _0x3c9f0a=[],_0x5bb0b8=0x0;while(_0x329c81[_0x5bb0b8]){_0x329c81[_0x5bb0b8]--,_0x5bb0b8++;}_0xf4df2(_0x57f3d0)[_0x1c6a25(0x1b6)]('td,\x20th')[_0x1c6a25(0x282)]((_0x3956d1,_0x572d99)=>{const _0x486aea=_0x1c6a25;let _0x8fbef2=_0xf4df2(_0x572d99)['text']()['trim'](),_0xd2c894=parseFloat(_0x8fbef2[_0x486aea(0x229)](/,/g,''));isNaN(_0xd2c894)&&(_0xd2c894=_0x8fbef2);let _0xc5566=parseInt(_0xf4df2(_0x572d99)['attr'](_0x486aea(0x20c)))||0x1,_0x58b58b=parseInt(_0xf4df2(_0x572d99)['attr'](_0x486aea(0x2ea)))||0x1;const _0x107c4b=_0xf4df2(_0x572d99)[_0x486aea(0x205)]('style'),_0x57e187=_0x467bfe(_0x107c4b);_0x3c9f0a[_0x5bb0b8]={'v':_0xd2c894,'s':{'border':_0x57e187}};(_0xc5566>0x1||_0x58b58b>0x1)&&_0x504940['push']({'s':{'r':_0x4fa5e4,'c':_0x5bb0b8},'e':{'r':_0x4fa5e4+_0x58b58b-0x1,'c':_0x5bb0b8+_0xc5566-0x1}});for(let _0x4d860c=0x0;_0x4d860c<_0xc5566;_0x4d860c++){_0x58b58b>0x1&&(_0x329c81[_0x5bb0b8+_0x4d860c]=_0x58b58b-0x1);}_0x5bb0b8+=_0xc5566;}),_0x5899ae[_0x1c6a25(0x26c)](_0x3c9f0a);});const _0x4e82ff=XLSX['utils'][_0x433d69(0x2bf)](),_0xe7dac3=XLSX[_0x433d69(0x2d8)][_0x433d69(0x31b)](_0x5899ae);_0x504940[_0x433d69(0x241)]>0x0&&(_0xe7dac3[_0x433d69(0x2be)]=_0x504940);_0xe7dac3[_0x433d69(0x215)]=_0x5899ae[0x0][_0x433d69(0x28b)](()=>({'wpx':0x64})),XLSX[_0x433d69(0x2d8)][_0x433d69(0x28c)](_0x4e82ff,_0xe7dac3,'Sales\x20Report');const _0x44c968=XLSX[_0x433d69(0x1ea)](_0x4e82ff,{'bookType':'xlsx','type':'buffer'});_0x347d91['setHeader'](_0x433d69(0x26e),_0x433d69(0x2e1)),_0x347d91['setHeader'](_0x433d69(0x284),_0x433d69(0x1ed)),_0x347d91[_0x433d69(0x259)](_0x44c968);}else{let _0x16caf8='';_0x16caf8+=_0x3bb226,_0x16caf8+=_0x433d69(0x29b),_0x16caf8+=_0x433d69(0x2da),_0x16caf8+=_0x433d69(0x274),_0x16caf8+='};',_0x16caf8+='</script>',_0x347d91[_0x433d69(0x259)](_0x16caf8);}}else generateReferenceNumber(_0x54db5c,_0x26e838[_0x433d69(0x31c)]['valueOf'](),_0x4e2587)[_0x433d69(0x1d9)](async _0x373ef3=>{const _0x22479a=_0x433d69,_0x18a562=await agentsdataDSICheck_DSRR(_0x54db5c,_0x26e838['_id'][_0x22479a(0x28a)](),_0x15e6ff,_0x373ef3);let _0x34e8de=_0x22479a(0x308);_0x34e8de+=_0x22479a(0x23d),_0x34e8de+=_0x22479a(0x1e5),_0x34e8de+=_0x22479a(0x252),_0x34e8de+=_0x18a562,_0x34e8de+='</table>',_0x34e8de+=_0x22479a(0x21d),_0x34e8de+=_0x22479a(0x21d);if(_0x18a562[_0x22479a(0x241)]>0x0){const _0x288b26=await Reference[_0x22479a(0x244)]({'staff_id':_0x26e838[_0x22479a(0x31c)][_0x22479a(0x28a)](),'referenceNumber':_0x373ef3});_0x288b26[_0x22479a(0x25b)]=_0x34e8de,_0x288b26[_0x22479a(0x1e3)]=_0x54db5c,await _0x288b26[_0x22479a(0x1c4)]();if(_0x18abc8==_0x22479a(0x2d1)){const _0x3c146c=cheerio[_0x22479a(0x20d)](_0x34e8de);let _0x9634d8=[],_0x2b442e=[],_0x19412f=[];const _0x257d0a=_0x5a3d36=>{const _0x7e6ba8=_0x22479a,_0xe93d6={'top':{'style':_0x7e6ba8(0x24c),'color':{'rgb':_0x7e6ba8(0x2f6)}},'bottom':{'style':'thick','color':{'rgb':'000000'}},'left':{'style':_0x7e6ba8(0x24c),'color':{'rgb':_0x7e6ba8(0x2f6)}},'right':{'style':_0x7e6ba8(0x24c),'color':{'rgb':'000000'}}};if(_0x5a3d36){const _0xd7981b=_0x5a3d36[_0x7e6ba8(0x295)](';')[_0x7e6ba8(0x27d)]((_0xc81cec,_0x343302)=>{const _0x4a89bf=_0x7e6ba8,[_0x405600,_0x1f8759]=_0x343302[_0x4a89bf(0x295)](':')[_0x4a89bf(0x28b)](_0x41bd30=>_0x41bd30['trim']());return _0xc81cec[_0x405600]=_0x1f8759,_0xc81cec;},{});_0xd7981b[_0x7e6ba8(0x216)]&&(_0xe93d6[_0x7e6ba8(0x1bf)][_0x7e6ba8(0x1c2)]=_0xd7981b[_0x7e6ba8(0x216)][_0x7e6ba8(0x1be)](_0x7e6ba8(0x314))?_0x7e6ba8(0x314):_0x7e6ba8(0x218)),_0xd7981b[_0x7e6ba8(0x2e7)]&&(_0xe93d6[_0x7e6ba8(0x25a)][_0x7e6ba8(0x1c2)]=_0xd7981b['border-bottom'][_0x7e6ba8(0x1be)]('thin')?'thin':'medium'),_0xd7981b[_0x7e6ba8(0x245)]&&(_0xe93d6[_0x7e6ba8(0x300)][_0x7e6ba8(0x1c2)]=_0xd7981b[_0x7e6ba8(0x245)]['includes'](_0x7e6ba8(0x314))?'thin':'medium'),_0xd7981b[_0x7e6ba8(0x206)]&&(_0xe93d6[_0x7e6ba8(0x2e2)][_0x7e6ba8(0x1c2)]=_0xd7981b[_0x7e6ba8(0x206)][_0x7e6ba8(0x1be)](_0x7e6ba8(0x314))?_0x7e6ba8(0x314):_0x7e6ba8(0x218));}return _0xe93d6;};_0x3c146c(_0x22479a(0x2ca))[_0x22479a(0x282)]((_0x2814bf,_0x4deb3e)=>{const _0xc9d991=_0x22479a;let _0x299af6=[],_0x2f484e=0x0;while(_0x19412f[_0x2f484e]){_0x19412f[_0x2f484e]--,_0x2f484e++;}_0x3c146c(_0x4deb3e)['find'](_0xc9d991(0x1f0))[_0xc9d991(0x282)]((_0x436de0,_0xe834af)=>{const _0x586124=_0xc9d991;let _0x1d0d29=_0x3c146c(_0xe834af)[_0x586124(0x2ba)]()[_0x586124(0x290)](),_0x23fc55=parseFloat(_0x1d0d29[_0x586124(0x229)](/,/g,''));isNaN(_0x23fc55)&&(_0x23fc55=_0x1d0d29);let _0x17be77=parseInt(_0x3c146c(_0xe834af)['attr'](_0x586124(0x20c)))||0x1,_0x50fa19=parseInt(_0x3c146c(_0xe834af)['attr'](_0x586124(0x2ea)))||0x1;const _0x5af066=_0x3c146c(_0xe834af)[_0x586124(0x205)](_0x586124(0x1c2)),_0x2ac281=_0x257d0a(_0x5af066);_0x299af6[_0x2f484e]={'v':_0x23fc55,'s':{'border':_0x2ac281}};(_0x17be77>0x1||_0x50fa19>0x1)&&_0x2b442e[_0x586124(0x26c)]({'s':{'r':_0x2814bf,'c':_0x2f484e},'e':{'r':_0x2814bf+_0x50fa19-0x1,'c':_0x2f484e+_0x17be77-0x1}});for(let _0x2274d9=0x0;_0x2274d9<_0x17be77;_0x2274d9++){_0x50fa19>0x1&&(_0x19412f[_0x2f484e+_0x2274d9]=_0x50fa19-0x1);}_0x2f484e+=_0x17be77;}),_0x9634d8[_0xc9d991(0x26c)](_0x299af6);});const _0x429844=XLSX[_0x22479a(0x2d8)][_0x22479a(0x2bf)](),_0x480e6f=XLSX[_0x22479a(0x2d8)][_0x22479a(0x31b)](_0x9634d8);_0x2b442e[_0x22479a(0x241)]>0x0&&(_0x480e6f[_0x22479a(0x2be)]=_0x2b442e);_0x480e6f[_0x22479a(0x215)]=_0x9634d8[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x22479a(0x28c)](_0x429844,_0x480e6f,'Sales\x20Report');const _0x1046b7=XLSX['write'](_0x429844,{'bookType':_0x22479a(0x1b1),'type':_0x22479a(0x268)});_0x347d91[_0x22479a(0x2d0)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x347d91[_0x22479a(0x2d0)](_0x22479a(0x284),_0x22479a(0x1ed)),_0x347d91['send'](_0x1046b7);}else _0x34e8de+=_0x22479a(0x29b),_0x34e8de+=_0x22479a(0x2da),_0x34e8de+='window.print();',_0x34e8de+='};',_0x34e8de+=_0x22479a(0x1d7),_0x347d91[_0x22479a(0x259)](_0x34e8de);}else await Reference['deleteOne']({'referenceNumber':_0x373ef3}),_0x4f64ff['flash']('errors',_0x22479a(0x1df)),_0x347d91['redirect'](_0x22479a(0x1e6));})[_0x433d69(0x1c6)](console[_0x433d69(0x267)]);}),router[a0_0x46c47e(0x31e)](a0_0x46c47e(0x2d6),auth,async(_0x20cabc,_0x5e224d)=>{const _0x4d80e7=a0_0x46c47e;try{const {username:_0x5bcc25,email:_0x1c5619,role:_0x33c495}=_0x20cabc[_0x4d80e7(0x253)],_0x3aaf34=_0x20cabc[_0x4d80e7(0x253)],_0x4bb2c1=await profile[_0x4d80e7(0x244)]({'email':_0x3aaf34['email']}),_0x122705={'year':_0x4d80e7(0x242),'month':'long','day':_0x4d80e7(0x242)},_0x45f0b8=await master_shop[_0x4d80e7(0x1b6)]();console[_0x4d80e7(0x1ef)](_0x4d80e7(0x256),_0x45f0b8);const _0x2e2db0=await product['find']();console[_0x4d80e7(0x1ef)]('Products\x20find_data',_0x2e2db0);const _0x57d82f=await warehouse[_0x4d80e7(0x1fc)]([{'$unwind':_0x4d80e7(0x255)},{'$lookup':{'from':_0x4d80e7(0x2dc),'localField':_0x4d80e7(0x1d0),'foreignField':_0x4d80e7(0x248),'as':_0x4d80e7(0x1b9)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x4d80e7(0x297),'product_stock':_0x4d80e7(0x237)}},{'$group':{'_id':_0x4d80e7(0x1a0),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x4d80e7(0x1ef)](_0x4d80e7(0x1ab),_0x57d82f),_0x57d82f[_0x4d80e7(0x1af)](_0x2dff68=>{const _0x3da0a6=_0x4d80e7,_0x3cc1a8=_0x2e2db0[_0x3da0a6(0x28b)](_0x56164a=>{const _0x17d4bc=_0x3da0a6;_0x56164a[_0x17d4bc(0x248)]==_0x2dff68[_0x17d4bc(0x31c)]&&(_0x56164a['stock']=parseInt(_0x56164a['stock'])+parseInt(_0x2dff68[_0x17d4bc(0x222)]));});});const _0x9fd4a1=await staff[_0x4d80e7(0x1b6)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x6c1138=await staff[_0x4d80e7(0x244)]({'email':_0x3aaf34[_0x4d80e7(0x228)]});if(_0x45f0b8[0x0][_0x4d80e7(0x230)]==_0x4d80e7(0x288))var _0x84943=users['English'];else{if(_0x45f0b8[0x0][_0x4d80e7(0x230)]==_0x4d80e7(0x306))var _0x84943=users['Hindi'];else{if(_0x45f0b8[0x0][_0x4d80e7(0x230)]==_0x4d80e7(0x22e))var _0x84943=users[_0x4d80e7(0x22e)];else{if(_0x45f0b8[0x0][_0x4d80e7(0x230)]==_0x4d80e7(0x292))var _0x84943=users[_0x4d80e7(0x292)];else{if(_0x45f0b8[0x0][_0x4d80e7(0x230)]==_0x4d80e7(0x213))var _0x84943=users[_0x4d80e7(0x213)];else{if(_0x45f0b8[0x0][_0x4d80e7(0x230)]==_0x4d80e7(0x1e4))var _0x84943=users[_0x4d80e7(0x2ad)];else{if(_0x45f0b8[0x0][_0x4d80e7(0x230)]==_0x4d80e7(0x1a1))var _0x84943=users[_0x4d80e7(0x1a1)];else{if(_0x45f0b8[0x0][_0x4d80e7(0x230)]==_0x4d80e7(0x31f))var _0x84943=users['Arabic'];}}}}}}}_0x5e224d[_0x4d80e7(0x234)](_0x4d80e7(0x281),{'success':_0x20cabc['flash'](_0x4d80e7(0x231)),'errors':_0x20cabc['flash'](_0x4d80e7(0x25f)),'alldata':_0x2e2db0,'profile':_0x4bb2c1,'master_shop':_0x45f0b8,'role':_0x3aaf34,'product_stock':_0x57d82f,'language':_0x84943,'staff_arr':_0x6c1138,'staff_data_all':_0x9fd4a1});}catch(_0x46ffd9){}}),router[a0_0x46c47e(0x321)](a0_0x46c47e(0x23f),auth,async(_0x360c02,_0xebfd41)=>{const _0x25d783=a0_0x46c47e;try{const {from:_0x3c4098,to:_0xbfb863,staff_data:_0x5bf5fd}=_0x360c02[_0x25d783(0x30a)],_0x20a461=await Reference[_0x25d783(0x1fc)]([{'$match':{'date_include':{'$gte':_0x3c4098,'$lte':_0xbfb863},'staff_id':_0x5bf5fd}},{'$sort':{'date_include':0x1}}]);_0xebfd41[_0x25d783(0x221)](_0x20a461);}catch(_0x492969){_0xebfd41[_0x25d783(0x221)](_0x492969);}}),router[a0_0x46c47e(0x31e)](a0_0x46c47e(0x240),auth,async(_0x44443f,_0x26b1ec)=>{const _0x3996fb=a0_0x46c47e;try{const _0x446ed6=_0x44443f[_0x3996fb(0x1b4)]['id'],_0x24593e=await Reference[_0x3996fb(0x2cf)](_0x446ed6);let _0xfff690='';_0xfff690+=_0x24593e[_0x3996fb(0x25b)],_0xfff690+='<script>',_0xfff690+=_0x3996fb(0x2da),_0xfff690+=_0x3996fb(0x274),_0xfff690+='};',_0xfff690+=_0x3996fb(0x1d7),_0x26b1ec[_0x3996fb(0x259)](_0xfff690);}catch(_0x2f3dfb){_0x26b1ec['json'](_0x2f3dfb);}}),router[a0_0x46c47e(0x321)]('/dl_excel',auth,async(_0x33131b,_0x463824)=>{const _0x49e3c9=a0_0x46c47e;try{const {ref_data:_0x15e012}=_0x33131b[_0x49e3c9(0x30a)],_0x30787d=_0x15e012[_0x49e3c9(0x295)]('~'),_0x49a32e=_0x30787d[_0x49e3c9(0x1d6)](_0x12575f=>_0x12575f!==''),_0x3679d9=await Reference[_0x49e3c9(0x1fc)]([{'$match':{'referenceNumber':{'$in':_0x49a32e}}}]),_0x2c254a=XLSX[_0x49e3c9(0x2d8)]['book_new']();_0x3679d9[_0x49e3c9(0x1af)](_0x5d6b64=>{const _0xe65551=_0x49e3c9,_0xf97925=cheerio['load'](_0x5d6b64[_0xe65551(0x25b)]);let _0x4a3fde=[],_0x1b71b6=[],_0x4ead5b=[];_0xf97925('table\x20tr')['each']((_0x272dc7,_0x4877ec)=>{const _0x2648e9=_0xe65551;let _0x1f9ad1=[],_0x3cc673=0x0;while(_0x4ead5b[_0x3cc673]){_0x4ead5b[_0x3cc673]--,_0x3cc673++;}_0xf97925(_0x4877ec)[_0x2648e9(0x1b6)]('td,\x20th')[_0x2648e9(0x282)]((_0x441b8c,_0xcf2532)=>{const _0xae3c11=_0x2648e9;let _0x15ae27=_0xf97925(_0xcf2532)[_0xae3c11(0x2ba)]()['trim'](),_0x1d72bd=parseFloat(_0x15ae27[_0xae3c11(0x229)](/,/g,''));isNaN(_0x1d72bd)&&(_0x1d72bd=_0x15ae27);let _0x15cc94=parseInt(_0xf97925(_0xcf2532)[_0xae3c11(0x205)]('colspan'))||0x1,_0x2953fb=parseInt(_0xf97925(_0xcf2532)['attr'](_0xae3c11(0x2ea)))||0x1;_0x1f9ad1[_0x3cc673]=_0x1d72bd;(_0x15cc94>0x1||_0x2953fb>0x1)&&_0x1b71b6['push']({'s':{'r':_0x272dc7,'c':_0x3cc673},'e':{'r':_0x272dc7+_0x2953fb-0x1,'c':_0x3cc673+_0x15cc94-0x1}});for(let _0xa26897=0x0;_0xa26897<_0x15cc94;_0xa26897++){_0x2953fb>0x1&&(_0x4ead5b[_0x3cc673+_0xa26897]=_0x2953fb-0x1);}_0x3cc673+=_0x15cc94;}),_0x4a3fde[_0x2648e9(0x26c)](_0x1f9ad1);});const _0x12a585=XLSX[_0xe65551(0x2d8)][_0xe65551(0x31b)](_0x4a3fde);_0x1b71b6[_0xe65551(0x241)]>0x0&&(_0x12a585[_0xe65551(0x2be)]=_0x1b71b6),_0x12a585[_0xe65551(0x215)]=_0x4a3fde[0x0][_0xe65551(0x28b)](()=>({'wpx':0x64})),XLSX[_0xe65551(0x2d8)][_0xe65551(0x28c)](_0x2c254a,_0x12a585,_0x5d6b64[_0xe65551(0x2fd)]);});const _0x3f8678=XLSX[_0x49e3c9(0x1ea)](_0x2c254a,{'bookType':_0x49e3c9(0x1b1),'type':_0x49e3c9(0x268)});_0x463824[_0x49e3c9(0x2d0)](_0x49e3c9(0x26e),_0x49e3c9(0x307)),_0x463824['setHeader'](_0x49e3c9(0x284),_0x49e3c9(0x1ed)),_0x463824['send'](_0x3f8678);}catch(_0x2206c7){_0x463824['json'](_0x2206c7);}}),router[a0_0x46c47e(0x321)](a0_0x46c47e(0x1e7),auth,async(_0x4813b3,_0x295374)=>{const _0x37567a=a0_0x46c47e,{from_date:_0x56964f,agent_id:_0xcdb50f}=_0x4813b3[_0x37567a(0x30a)],_0xcf7990=_0x4813b3['user'],_0x4010e3=await staff[_0x37567a(0x244)]({'email':_0xcf7990[_0x37567a(0x228)]}),_0x4b6f7f=await master_shop[_0x37567a(0x1b6)](),_0x474f20=await agentsdataDSICheck_DSRR(_0x56964f,_0xcdb50f,_0x5d9eaf);let _0x57ffa5='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x569885=new Date(_0x56964f);const _0x371ae9={'year':_0x37567a(0x242),'month':_0x37567a(0x296),'day':_0x37567a(0x242)},_0x5e4e9a=new Intl['DateTimeFormat'](_0x37567a(0x318),_0x371ae9)[_0x37567a(0x2f5)](_0x569885);_0x57ffa5+=_0x37567a(0x23d),_0x57ffa5+=_0x37567a(0x1e5),_0x57ffa5+=_0x37567a(0x252),_0x57ffa5+=_0x474f20,_0x57ffa5+=_0x37567a(0x2ed),_0x57ffa5+=_0x37567a(0x21d),_0x57ffa5+='</div>';let _0x313326=_0x37567a(0x2f1);const _0x1c2b0b={'width':'15in','height':_0x37567a(0x24f),'orientation':_0x37567a(0x243),'border':{'top':_0x37567a(0x2b4),'right':'0.1in','bottom':_0x37567a(0x2b4),'left':'0.1in'},'header':{'height':_0x37567a(0x2af),'contents':_0x37567a(0x1f3)+_0x313326+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x5e4e9a+_0x37567a(0x2ae)},'footer':{'height':_0x37567a(0x20b),'contents':{'default':_0x37567a(0x260)}},'dpi':0x5,'zoomFactor':'1'};var _0x5d9eaf='on';if(_0x5d9eaf=='on'){const _0x30ea1e=cheerio[_0x37567a(0x20d)](_0x57ffa5);let _0x15b0e1=[],_0xf51d47=[],_0x569bc3=[];_0x30ea1e(_0x37567a(0x2ca))[_0x37567a(0x282)]((_0x59fa40,_0x408a85)=>{const _0x171673=_0x37567a;let _0x42dc73=[],_0x5cadc3=0x0;while(_0x569bc3[_0x5cadc3]){_0x569bc3[_0x5cadc3]--,_0x5cadc3++;}_0x30ea1e(_0x408a85)[_0x171673(0x1b6)](_0x171673(0x1f0))[_0x171673(0x282)]((_0x5b7bb8,_0x21ad60)=>{const _0x5d4deb=_0x171673;let _0x4c413c=_0x30ea1e(_0x21ad60)[_0x5d4deb(0x2ba)]()[_0x5d4deb(0x290)](),_0x56d1a0=parseFloat(_0x4c413c[_0x5d4deb(0x229)](/,/g,''));isNaN(_0x56d1a0)&&(_0x56d1a0=_0x4c413c);let _0x2d9f7e=parseInt(_0x30ea1e(_0x21ad60)['attr'](_0x5d4deb(0x20c)))||0x1,_0x52a452=parseInt(_0x30ea1e(_0x21ad60)['attr'](_0x5d4deb(0x2ea)))||0x1;_0x42dc73[_0x5cadc3]=_0x56d1a0;(_0x2d9f7e>0x1||_0x52a452>0x1)&&_0xf51d47['push']({'s':{'r':_0x59fa40,'c':_0x5cadc3},'e':{'r':_0x59fa40+_0x52a452-0x1,'c':_0x5cadc3+_0x2d9f7e-0x1}});for(let _0x4dc8c4=0x0;_0x4dc8c4<_0x2d9f7e;_0x4dc8c4++){_0x52a452>0x1&&(_0x569bc3[_0x5cadc3+_0x4dc8c4]=_0x52a452-0x1);}_0x5cadc3+=_0x2d9f7e;}),_0x15b0e1[_0x171673(0x26c)](_0x42dc73);});const _0x2621ce=XLSX[_0x37567a(0x2d8)][_0x37567a(0x2bf)](),_0x20b2e3=XLSX['utils']['aoa_to_sheet'](_0x15b0e1);_0xf51d47[_0x37567a(0x241)]>0x0&&(_0x20b2e3['!merges']=_0xf51d47);_0x20b2e3[_0x37567a(0x215)]=_0x15b0e1[0x0][_0x37567a(0x28b)](()=>({'wpx':0x64})),XLSX[_0x37567a(0x2d8)]['book_append_sheet'](_0x2621ce,_0x20b2e3,_0x37567a(0x19d));const _0x184338=XLSX['write'](_0x2621ce,{'bookType':_0x37567a(0x1b1),'type':'buffer'});_0x295374[_0x37567a(0x2d0)](_0x37567a(0x26e),_0x37567a(0x2e1)),_0x295374[_0x37567a(0x2d0)]('Content-Type',_0x37567a(0x1ed)),_0x295374[_0x37567a(0x259)](_0x184338);}else pdf[_0x37567a(0x1ce)](_0x57ffa5,_0x1c2b0b)[_0x37567a(0x28e)](function(_0x3a3e6b,_0x16b743){const _0x29af87=_0x37567a;if(_0x3a3e6b){_0x295374[_0x29af87(0x2e9)](0x1f4)[_0x29af87(0x259)]('Error\x20generating\x20PDF');return;}_0x295374[_0x29af87(0x2d0)](_0x29af87(0x284),_0x29af87(0x1b8)),_0x16b743[_0x29af87(0x279)](_0x295374);});}),module[a0_0x46c47e(0x223)]=router;