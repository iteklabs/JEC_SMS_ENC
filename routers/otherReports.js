const a0_0x4b16db=a0_0x3c7e;(function(_0x5629b0,_0x14f1bf){const _0x5507de=a0_0x3c7e,_0x283b3d=_0x5629b0();while(!![]){try{const _0x2da98b=-parseInt(_0x5507de(0x1d1))/0x1+-parseInt(_0x5507de(0x24d))/0x2*(parseInt(_0x5507de(0x1ee))/0x3)+-parseInt(_0x5507de(0x186))/0x4*(-parseInt(_0x5507de(0x1b6))/0x5)+parseInt(_0x5507de(0x126))/0x6+-parseInt(_0x5507de(0x18d))/0x7*(parseInt(_0x5507de(0x120))/0x8)+parseInt(_0x5507de(0x231))/0x9+parseInt(_0x5507de(0x267))/0xa*(parseInt(_0x5507de(0x230))/0xb);if(_0x2da98b===_0x14f1bf)break;else _0x283b3d['push'](_0x283b3d['shift']());}catch(_0x29d2d6){_0x283b3d['push'](_0x283b3d['shift']());}}}(a0_0x161a,0x55e53));const express=require(a0_0x4b16db(0x1cc)),res=require(a0_0x4b16db(0x274)),app=express(),router=express['Router'](),multer=require(a0_0x4b16db(0x1a1)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x4b16db(0x121)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require('exceljs'),XLSX=require(a0_0x4b16db(0x11a)),PDFDocument=require(a0_0x4b16db(0x166)),fs=require('fs'),blobStream=require('blob-stream'),JsBarcode=require(a0_0x4b16db(0x28b)),{Canvas}=require(a0_0x4b16db(0x146)),pdf=require(a0_0x4b16db(0x26f)),path=require(a0_0x4b16db(0x249)),mongoose=require(a0_0x4b16db(0x1a2)),cheerio=require(a0_0x4b16db(0x12f));router[a0_0x4b16db(0x209)](a0_0x4b16db(0x20f),auth,async(_0x757fe0,_0x5d96a3)=>{const _0x2959b4=a0_0x4b16db;try{const {username:_0x769fa3,email:_0x19885b,role:_0x3d9e84}=_0x757fe0[_0x2959b4(0x10d)],_0x3dfd32=_0x757fe0[_0x2959b4(0x10d)],_0x2c7f7e=await profile['findOne']({'email':_0x3dfd32['email']}),_0x407736={'year':_0x2959b4(0x234),'month':'long','day':_0x2959b4(0x234)},_0x434e77=await master_shop[_0x2959b4(0x288)]();console['log']('Products\x20master',_0x434e77);const _0x5ca3d7=await product['find']();console[_0x2959b4(0x1d7)](_0x2959b4(0x1a9),_0x5ca3d7);const _0x3e78b5=await warehouse['aggregate']([{'$unwind':_0x2959b4(0x1b7)},{'$lookup':{'from':'products','localField':_0x2959b4(0x266),'foreignField':_0x2959b4(0x18f),'as':'product_docs'}},{'$unwind':_0x2959b4(0x16f)},{'$project':{'product_name':_0x2959b4(0x269),'product_stock':_0x2959b4(0x157)}},{'$group':{'_id':_0x2959b4(0x27e),'product_stock':{'$sum':_0x2959b4(0x1e7)}}}]);console[_0x2959b4(0x1d7)](_0x2959b4(0x1f9),_0x3e78b5),_0x3e78b5[_0x2959b4(0x289)](_0x4c517a=>{const _0x65b91e=_0x2959b4,_0x16fb55=_0x5ca3d7[_0x65b91e(0x243)](_0x1d6361=>{const _0x579bcd=_0x65b91e;_0x1d6361['name']==_0x4c517a[_0x579bcd(0x129)]&&(_0x1d6361['stock']=parseInt(_0x1d6361[_0x579bcd(0x24a)])+parseInt(_0x4c517a[_0x579bcd(0x26b)]));});}),console[_0x2959b4(0x1d7)](_0x2959b4(0x1a9),_0x5ca3d7);if(_0x434e77[0x0][_0x2959b4(0x1df)]==_0x2959b4(0x260))var _0x37f0e8=users[_0x2959b4(0x12b)];else{if(_0x434e77[0x0]['language']==_0x2959b4(0x171))var _0x37f0e8=users['Hindi'];else{if(_0x434e77[0x0][_0x2959b4(0x1df)]=='German')var _0x37f0e8=users[_0x2959b4(0x12a)];else{if(_0x434e77[0x0][_0x2959b4(0x1df)]==_0x2959b4(0x13f))var _0x37f0e8=users[_0x2959b4(0x13f)];else{if(_0x434e77[0x0]['language']==_0x2959b4(0x122))var _0x37f0e8=users[_0x2959b4(0x122)];else{if(_0x434e77[0x0][_0x2959b4(0x1df)]==_0x2959b4(0x14c))var _0x37f0e8=users[_0x2959b4(0x1a5)];else{if(_0x434e77[0x0]['language']==_0x2959b4(0x1fa))var _0x37f0e8=users[_0x2959b4(0x1fa)];else{if(_0x434e77[0x0][_0x2959b4(0x1df)]==_0x2959b4(0x145))var _0x37f0e8=users[_0x2959b4(0x273)];}}}}}}}_0x5d96a3[_0x2959b4(0x123)](_0x2959b4(0x10f),{'success':_0x757fe0[_0x2959b4(0x252)](_0x2959b4(0x1c8)),'errors':_0x757fe0[_0x2959b4(0x252)](_0x2959b4(0x22c)),'alldata':_0x5ca3d7,'profile':_0x2c7f7e,'master_shop':_0x434e77,'role':_0x3dfd32,'product_stock':_0x3e78b5,'language':_0x37f0e8});}catch(_0xd86f79){}});async function dataCheck(_0x3cabb4,_0x412fb6){const _0x1d3337=a0_0x4b16db,_0x483fc8=await product[_0x1d3337(0x240)]([{'$group':{'_id':{'brand':'$brand','category':_0x1d3337(0x188)},'products':{'$push':{'name':'$name','product_code':_0x1d3337(0x1ae)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x43b09d=[];_0x43b09d[_0x1d3337(0x254)]=[];for(let _0x516142=0x0;_0x516142<=_0x483fc8[_0x1d3337(0x1c6)]-0x1;_0x516142++){const _0x4f9e78=_0x483fc8[_0x516142];_0x43b09d[_0x1d3337(0x254)]['push'](_0x4f9e78);}const _0x163a8d=await product['aggregate']([{'$group':{'_id':{'category':_0x1d3337(0x188)},'products':{'$push':{'brand':_0x1d3337(0x18b),'product_code':'$product_code','product_name':_0x1d3337(0x14b)}}}},{'$sort':{'_id.category':-0x1}}]),_0xd444be=await purchases_finished[_0x1d3337(0x240)]([{'$match':{'date':{'$gte':_0x3cabb4,'$lte':_0x412fb6}}},{'$unwind':'$product'},{'$group':{'_id':{'product_name':_0x1d3337(0x1b8),'product_code':_0x1d3337(0x1b3)},'totalQTY':{'$sum':_0x1d3337(0x26c)}}}]);_0x43b09d['beg_bal']=[];for(let _0x81f6e=0x0;_0x81f6e<=_0xd444be[_0x1d3337(0x1c6)]-0x1;_0x81f6e++){const _0xbfa50a=_0xd444be[_0x81f6e];_0x43b09d['beg_bal']['push'](_0xbfa50a);}const _0x40b625=await sales_sa[_0x1d3337(0x240)]([{'$match':{'date':{'$gte':_0x3cabb4,'$lte':_0x412fb6}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x1d3337(0x13a)}}},{'$lookup':{'from':_0x1d3337(0x1d9),'localField':'sales_staff_id','foreignField':_0x1d3337(0x129),'as':_0x1d3337(0x172)}},{'$unwind':_0x1d3337(0x258)},{'$unwind':_0x1d3337(0x1bc)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x1d3337(0x143),'product_code':_0x1d3337(0x189)},'totalQTY':{'$sum':_0x1d3337(0x16d)}}}]);console['log'](_0x40b625[0x0]),_0x43b09d[_0x1d3337(0x1c1)]=[];for(let _0x2ec4b5=0x0;_0x2ec4b5<=_0x40b625[_0x1d3337(0x1c6)]-0x1;_0x2ec4b5++){const _0x52edce=_0x40b625[_0x2ec4b5];_0x43b09d[_0x1d3337(0x1c1)][_0x1d3337(0x1e5)](_0x52edce);}const _0x5a2096=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3cabb4,'$lte':_0x412fb6}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x1d3337(0x1d9),'localField':_0x1d3337(0x136),'foreignField':'_id','as':_0x1d3337(0x172)}},{'$unwind':_0x1d3337(0x258)},{'$unwind':_0x1d3337(0x1bc)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x1d3337(0x1ef)}},{'$group':{'_id':{'product_name':_0x1d3337(0x143),'product_code':_0x1d3337(0x189)},'totalQTY':{'$sum':_0x1d3337(0x1de)}}}]);_0x43b09d['sales_ext']=[];for(let _0x3cec9d=0x0;_0x3cec9d<=_0x5a2096['length']-0x1;_0x3cec9d++){const _0x1983a1=_0x5a2096[_0x3cec9d];_0x43b09d[_0x1d3337(0x178)][_0x1d3337(0x1e5)](_0x1983a1);}let _0x2111a1='';for(let _0x474892=0x0;_0x474892<=_0x163a8d['length']-0x1;_0x474892++){const _0x4673fb=_0x163a8d[_0x474892];_0x2111a1+=_0x1d3337(0x197),_0x2111a1+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x4673fb[_0x1d3337(0x129)]['category']+'</td>',_0x2111a1+=_0x1d3337(0x13c);for(let _0xa31254=0x0;_0xa31254<_0x43b09d[_0x1d3337(0x254)]['length'];_0xa31254++){const _0x1f2eed=_0x43b09d['cat_brand'][_0xa31254];if(_0x1f2eed['_id'][_0x1d3337(0x22d)]==_0x4673fb[_0x1d3337(0x129)][_0x1d3337(0x22d)]){let _0x2e7f6d=[],_0x108d8c=[],_0x557281=[];_0x2e7f6d[_0x1f2eed[_0x1d3337(0x129)][_0x1d3337(0x16e)]]=[],_0x108d8c[_0x1f2eed[_0x1d3337(0x129)][_0x1d3337(0x16e)]]=[],_0x557281[_0x1f2eed['_id'][_0x1d3337(0x16e)]]=[];var _0x18c69f=0x0,_0x1d3b4e=0x0,_0x4e647f=0x0;for(let _0x9cc717=0x0;_0x9cc717<_0x1f2eed[_0x1d3337(0x117)][_0x1d3337(0x1c6)];_0x9cc717++){const _0x1ab5a9=_0x1f2eed[_0x1d3337(0x117)][_0x9cc717];for(let _0x47984c=0x0;_0x47984c<=_0x43b09d['beg_bal'][_0x1d3337(0x1c6)]-0x1;_0x47984c++){const _0x1153a5=_0x43b09d[_0x1d3337(0x151)][_0x47984c];_0x1153a5[_0x1d3337(0x129)][_0x1d3337(0x21e)]==_0x1ab5a9[_0x1d3337(0x18f)]&&_0x1153a5[_0x1d3337(0x129)][_0x1d3337(0x25c)]==_0x1ab5a9['product_code']&&(_0x18c69f+=parseInt(_0x1153a5['totalQTY'],0xa));}for(let _0x2f46ac=0x0;_0x2f46ac<=_0x43b09d['sales_ext'][_0x1d3337(0x1c6)]-0x1;_0x2f46ac++){const _0x49b54c=_0x43b09d[_0x1d3337(0x178)][_0x2f46ac];_0x49b54c['_id'][_0x1d3337(0x21e)]==_0x1ab5a9[_0x1d3337(0x18f)]&&_0x49b54c[_0x1d3337(0x129)][_0x1d3337(0x25c)]==_0x1ab5a9[_0x1d3337(0x25c)]&&(_0x1d3b4e+=parseFloat(_0x49b54c['totalQTY'],0xa)[_0x1d3337(0x26e)](0x2));}for(let _0x19edf3=0x0;_0x19edf3<=_0x43b09d[_0x1d3337(0x1c1)][_0x1d3337(0x1c6)]-0x1;_0x19edf3++){const _0x6cfa7b=_0x43b09d[_0x1d3337(0x1c1)][_0x19edf3];_0x6cfa7b[_0x1d3337(0x129)][_0x1d3337(0x21e)]==_0x1ab5a9['name']&&_0x6cfa7b[_0x1d3337(0x129)][_0x1d3337(0x25c)]==_0x1ab5a9['product_code']&&(_0x4e647f+=parseInt(_0x6cfa7b[_0x1d3337(0x1da)],0xa));}}const _0x23c562=new Intl[(_0x1d3337(0x24e))](_0x1d3337(0x17d));var _0x393b72=_0x23c562[_0x1d3337(0x213)](_0x18c69f);_0x2e7f6d[_0x1f2eed['_id'][_0x1d3337(0x16e)]][_0x1d3337(0x1e5)](_0x393b72),_0x108d8c[_0x1f2eed[_0x1d3337(0x129)]['brand']][_0x1d3337(0x1e5)](_0x23c562[_0x1d3337(0x213)](_0x1d3b4e)),_0x557281[_0x1f2eed[_0x1d3337(0x129)][_0x1d3337(0x16e)]][_0x1d3337(0x1e5)](_0x23c562[_0x1d3337(0x213)](_0x4e647f));var _0xf5f745=_0x23c562['format'](_0x18c69f-(_0x4e647f+_0x1d3b4e));_0x2111a1+='<tr>',_0x2111a1+='<td\x20class=\x22row_data\x22></td>',_0x2111a1+='<td\x20class=\x22row_data\x22>'+_0x1f2eed[_0x1d3337(0x129)][_0x1d3337(0x16e)]+_0x1d3337(0x1e6),_0x2111a1+=_0x1d3337(0x179)+_0x2e7f6d[_0x1f2eed[_0x1d3337(0x129)][_0x1d3337(0x16e)]][0x0]+_0x1d3337(0x1e6),_0x2111a1+='<td\x20class=\x22row_data\x22>0</td>',_0x2111a1+='<td\x20class=\x22row_data\x22>'+_0x557281[_0x1f2eed[_0x1d3337(0x129)]['brand']][0x0]+'</td>',_0x2111a1+=_0x1d3337(0x179)+_0x108d8c[_0x1f2eed[_0x1d3337(0x129)][_0x1d3337(0x16e)]][0x0]+_0x1d3337(0x1e6),_0x2111a1+=_0x1d3337(0x179)+_0xf5f745+'</td>',_0x2111a1+=_0x1d3337(0x13c);}}}return console[_0x1d3337(0x1d7)](_0x43b09d['sales_bkg']),_0x2111a1;}router[a0_0x4b16db(0x225)]('/balance/pdf',auth,async(_0x3f1202,_0x1ba3e1)=>{const _0x579f2a=a0_0x4b16db,{from_date:_0x4ac157,to_date:_0x3bb203}=_0x3f1202['body'],_0x40653c=await dataCheck(_0x4ac157,_0x3bb203);{}let _0x7b053f='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x259096=new Date(_0x4ac157),_0x5df451=new Date(_0x3bb203);const _0x27bcd1={'year':_0x579f2a(0x234),'month':_0x579f2a(0x1e8),'day':_0x579f2a(0x234)},_0x57b314=new Intl['DateTimeFormat'](_0x579f2a(0x17d),_0x27bcd1)['format'](_0x259096),_0x20e06d=new Intl['DateTimeFormat']('en-US',_0x27bcd1)['format'](_0x5df451);_0x7b053f+=_0x579f2a(0x110),_0x7b053f+=_0x579f2a(0x1f8),_0x7b053f+=_0x579f2a(0x119)+_0x57b314+_0x579f2a(0x180)+_0x20e06d+'</p>',_0x7b053f+='<div\x20class=\x22row\x22>',_0x7b053f+=_0x579f2a(0x13e),_0x7b053f+=_0x579f2a(0x25f),_0x7b053f+=_0x579f2a(0x197),_0x7b053f+='<th\x20rowspan=\x272\x27>Category</th>',_0x7b053f+='<th\x20rowspan=\x272\x27>Products</th>',_0x7b053f+=_0x579f2a(0x148)+_0x57b314+_0x579f2a(0x158),_0x7b053f+=_0x579f2a(0x116),_0x7b053f+=_0x579f2a(0x1e4),_0x7b053f+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x20e06d+_0x579f2a(0x158),_0x7b053f+=_0x579f2a(0x13c),_0x7b053f+=_0x579f2a(0x197),_0x7b053f+=_0x579f2a(0x18a),_0x7b053f+=_0x579f2a(0x160),_0x7b053f+=_0x579f2a(0x13c),_0x7b053f+=_0x40653c,_0x7b053f+=_0x579f2a(0x154),_0x7b053f+=_0x579f2a(0x10e),_0x7b053f+=_0x579f2a(0x10e);const _0x5393f5={'format':_0x579f2a(0x114),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x579f2a(0x138)}}};pdf['create'](_0x7b053f,_0x5393f5)[_0x579f2a(0x28a)](function(_0xa2f07a,_0x3b0b3b){const _0x47c39c=_0x579f2a;if(_0xa2f07a){_0x1ba3e1[_0x47c39c(0x27a)](0x1f4)[_0x47c39c(0x1ac)](_0x47c39c(0x14f));return;}_0x1ba3e1[_0x47c39c(0x190)](_0x47c39c(0x147),_0x47c39c(0x202)),_0x3b0b3b['pipe'](_0x1ba3e1);});}),router['get'](a0_0x4b16db(0x1fd),auth,async(_0x1247ef,_0x169573)=>{const _0x2e9312=a0_0x4b16db;try{const {username:_0x20cd04,email:_0x58abb7,role:_0x1b9cd8}=_0x1247ef['user'],_0x2ebf56=_0x1247ef[_0x2e9312(0x10d)],_0x218b95=await profile[_0x2e9312(0x261)]({'email':_0x2ebf56[_0x2e9312(0x194)]}),_0x42451d={'year':'numeric','month':_0x2e9312(0x1e8),'day':_0x2e9312(0x234)},_0x3d37f5=await master_shop[_0x2e9312(0x288)](),_0xfbf822=await product['find'](),_0x51c1fd=await warehouse['aggregate']([{'$unwind':_0x2e9312(0x1b7)},{'$lookup':{'from':_0x2e9312(0x117),'localField':_0x2e9312(0x266),'foreignField':_0x2e9312(0x18f),'as':_0x2e9312(0x1a7)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x2e9312(0x269),'product_stock':_0x2e9312(0x157)}},{'$group':{'_id':_0x2e9312(0x27e),'product_stock':{'$sum':_0x2e9312(0x1e7)}}}]);if(_0x3d37f5[0x0][_0x2e9312(0x1df)]==_0x2e9312(0x260))var _0x396b1f=users[_0x2e9312(0x12b)];else{if(_0x3d37f5[0x0][_0x2e9312(0x1df)]=='Hindi')var _0x396b1f=users[_0x2e9312(0x171)];else{if(_0x3d37f5[0x0][_0x2e9312(0x1df)]==_0x2e9312(0x12a))var _0x396b1f=users[_0x2e9312(0x12a)];else{if(_0x3d37f5[0x0][_0x2e9312(0x1df)]==_0x2e9312(0x13f))var _0x396b1f=users[_0x2e9312(0x13f)];else{if(_0x3d37f5[0x0]['language']=='French')var _0x396b1f=users[_0x2e9312(0x122)];else{if(_0x3d37f5[0x0][_0x2e9312(0x1df)]==_0x2e9312(0x14c))var _0x396b1f=users['Portuguese'];else{if(_0x3d37f5[0x0]['language']=='Chinese')var _0x396b1f=users[_0x2e9312(0x1fa)];else{if(_0x3d37f5[0x0][_0x2e9312(0x1df)]==_0x2e9312(0x145))var _0x396b1f=users[_0x2e9312(0x273)];}}}}}}}_0x169573['render']('agent_sales',{'success':_0x1247ef[_0x2e9312(0x252)](_0x2e9312(0x1c8)),'errors':_0x1247ef[_0x2e9312(0x252)]('errors'),'alldata':_0xfbf822,'profile':_0x218b95,'master_shop':_0x3d37f5,'role':_0x2ebf56,'product_stock':_0x51c1fd,'language':_0x396b1f});}catch(_0x182a31){}});async function agentsdataCheck(_0x3bf54f,_0x2055d5){const _0x2fe701=a0_0x4b16db,_0x308814=await product[_0x2fe701(0x240)]([{'$group':{'_id':{'brand':_0x2fe701(0x18b),'category':_0x2fe701(0x188)},'products':{'$push':{'name':_0x2fe701(0x14b),'product_code':_0x2fe701(0x1ae)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x34b8b7=[];_0x34b8b7[_0x2fe701(0x254)]=[];for(let _0x156c0f=0x0;_0x156c0f<=_0x308814[_0x2fe701(0x1c6)]-0x1;_0x156c0f++){const _0x688881=_0x308814[_0x156c0f];_0x34b8b7[_0x2fe701(0x254)][_0x2fe701(0x1e5)](_0x688881);}const _0x16af5b=await product[_0x2fe701(0x240)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x2fe701(0x18b),'product_code':'$product_code','product_name':_0x2fe701(0x14b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x28959e=await product['aggregate']([{'$group':{'_id':{'category':_0x2fe701(0x188),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2e704e=await sales_sa[_0x2fe701(0x240)]([{'$match':{'date':{'$gte':_0x3bf54f,'$lte':_0x2055d5}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x2fe701(0x13a)}}},{'$lookup':{'from':'staffs','localField':_0x2fe701(0x136),'foreignField':_0x2fe701(0x129),'as':_0x2fe701(0x172)}},{'$unwind':_0x2fe701(0x258)},{'$unwind':_0x2fe701(0x1bc)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':'false'}},{'$lookup':{'from':_0x2fe701(0x117),'localField':_0x2fe701(0x131),'foreignField':_0x2fe701(0x25c),'as':_0x2fe701(0x251)}},{'$unwind':_0x2fe701(0x20e)},{'$group':{'_id':{'sales_id':'$sales_info._id','category':'$product_info.category','brand':_0x2fe701(0x1e9)},'salesman_data':{'$first':_0x2fe701(0x1a0)},'totalQTY':{'$sum':_0x2fe701(0x1de)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','product_details':{'prod_name':_0x2fe701(0x192),'product_code':_0x2fe701(0x14a),'category':_0x2fe701(0x1cf),'brand':_0x2fe701(0x1e9)}}}}}]);let _0x41896f='';_0x41896f+=_0x2fe701(0x197),_0x41896f+=_0x2fe701(0x134),_0x41896f+='</tr>',_0x41896f+=_0x2fe701(0x197),_0x41896f+='<td\x20class=\x22cat_data\x22></td>';for(let _0x19960b=0x0;_0x19960b<=_0x16af5b[_0x2fe701(0x1c6)]-0x1;_0x19960b++){const _0x4706c0=_0x16af5b[_0x19960b];for(let _0x40c8d8=0x0;_0x40c8d8<_0x28959e[_0x2fe701(0x1c6)];_0x40c8d8++){const _0x55b705=_0x28959e[_0x40c8d8];_0x55b705[_0x2fe701(0x129)]==_0x4706c0[_0x2fe701(0x129)][_0x2fe701(0x22d)]&&(_0x41896f+=_0x2fe701(0x1ad)+_0x55b705[_0x2fe701(0x16b)]+_0x2fe701(0x283)+_0x4706c0[_0x2fe701(0x129)][_0x2fe701(0x22d)]+'</td>');}}_0x41896f+=_0x2fe701(0x177),_0x41896f+=_0x2fe701(0x13c),_0x41896f+=_0x2fe701(0x197),_0x41896f+=_0x2fe701(0x109);for(let _0x3c161e=0x0;_0x3c161e<=_0x16af5b['length']-0x1;_0x3c161e++){const _0x546f20=_0x16af5b[_0x3c161e];for(let _0x7b0129=0x0;_0x7b0129<_0x34b8b7[_0x2fe701(0x254)]['length'];_0x7b0129++){const _0x242d77=_0x34b8b7[_0x2fe701(0x254)][_0x7b0129];_0x242d77[_0x2fe701(0x129)][_0x2fe701(0x22d)]==_0x546f20[_0x2fe701(0x129)][_0x2fe701(0x22d)]&&(_0x41896f+='<td\x20class=\x22cat_data\x22>'+_0x242d77['_id'][_0x2fe701(0x16e)]+_0x2fe701(0x1e6));}}_0x41896f+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x41896f+=_0x2fe701(0x13c);let _0x121a1d={'name':[],'dataqty':{}};for(let _0x4064ec=0x0;_0x4064ec<_0x34b8b7[_0x2fe701(0x254)][_0x2fe701(0x1c6)];_0x4064ec++){const _0x3d715c=_0x34b8b7[_0x2fe701(0x254)][_0x4064ec],_0x3d5f25=_0x3d715c[_0x2fe701(0x129)][_0x2fe701(0x16e)],_0x3eed28=_0x3d715c[_0x2fe701(0x129)][_0x2fe701(0x22d)];!_0x121a1d[_0x2fe701(0x223)][_0x3d5f25]&&(_0x121a1d[_0x2fe701(0x223)][_0x3d5f25]={});!_0x121a1d[_0x2fe701(0x223)][_0x3d5f25][_0x3eed28]&&(_0x121a1d[_0x2fe701(0x223)][_0x3d5f25][_0x3eed28]=[]);for(let _0xca558=0x0;_0xca558<_0x2e704e[_0x2fe701(0x1c6)];_0xca558++){const _0x2b3374=_0x2e704e[_0xca558];if(_0x3d5f25===_0x2b3374[_0x2fe701(0x129)][_0x2fe701(0x16e)]&&_0x3eed28===_0x2b3374['_id'][_0x2fe701(0x22d)]){const _0x24b3c4=_0x2b3374[_0x2fe701(0x10c)];!_0x121a1d[_0x2fe701(0x223)][_0x3d5f25][_0x3eed28][_0x24b3c4]&&(_0x121a1d[_0x2fe701(0x223)][_0x3d5f25][_0x3eed28][_0x24b3c4]=[]),_0x121a1d[_0x2fe701(0x223)][_0x3d5f25][_0x3eed28][_0x24b3c4][_0x2fe701(0x1e5)](_0x2b3374[_0x2fe701(0x1da)]),!_0x121a1d[_0x2fe701(0x18f)][_0x2fe701(0x1ba)](_0x24b3c4)&&_0x121a1d[_0x2fe701(0x18f)][_0x2fe701(0x1e5)](_0x24b3c4);}}}_0x41896f+=_0x2fe701(0x197);for(let _0x208098=0x0;_0x208098<=_0x121a1d[_0x2fe701(0x18f)][_0x2fe701(0x1c6)]-0x1;_0x208098++){const _0x3be3ce=_0x121a1d[_0x2fe701(0x18f)][_0x208098];_0x41896f+='<td\x20class=\x22row_data\x22>'+_0x3be3ce+_0x2fe701(0x1e6);var _0x41d2e8=0x0,_0x29a848=0x0;for(let _0x32df22=0x0;_0x32df22<=_0x34b8b7['cat_brand'][_0x2fe701(0x1c6)]-0x1;_0x32df22++){const _0x3a6c97=_0x34b8b7[_0x2fe701(0x254)][_0x32df22];var _0x1f0123=0x0;_0x121a1d[_0x2fe701(0x223)][_0x3a6c97[_0x2fe701(0x129)][_0x2fe701(0x16e)]][_0x3a6c97[_0x2fe701(0x129)][_0x2fe701(0x22d)]][_0x3be3ce]?(_0x1f0123=_0x121a1d['dataqty'][_0x3a6c97[_0x2fe701(0x129)]['brand']][_0x3a6c97['_id'][_0x2fe701(0x22d)]][_0x3be3ce][0x0],_0x41896f+=_0x2fe701(0x179)+formatNumber(_0x1f0123[_0x2fe701(0x26e)](0x2))+'</td>'):(_0x1f0123=0x0,_0x41896f+=_0x2fe701(0x179)+_0x1f0123+'</td>'),_0x41d2e8+=_0x1f0123;}_0x41896f+=_0x2fe701(0x179)+formatNumber(_0x41d2e8['toFixed'](0x2))+_0x2fe701(0x1e6);}return _0x41896f+=_0x2fe701(0x13c),_0x41896f;}router[a0_0x4b16db(0x225)](a0_0x4b16db(0x191),auth,async(_0x25c960,_0x212a1c)=>{const _0x3a6f19=a0_0x4b16db,{from_date:_0xede6a4,to_date:_0x37a0ea}=_0x25c960[_0x3a6f19(0x15c)],_0x3332c8=await agentsdataCheck(_0xede6a4,_0x37a0ea);{}let _0x572b27=_0x3a6f19(0x170);var _0x280c5e=new Date(_0xede6a4),_0x33f0d0=new Date(_0x37a0ea);const _0x13aad0={'year':'numeric','month':'long','day':_0x3a6f19(0x234)},_0x4ed636=new Intl[(_0x3a6f19(0x221))](_0x3a6f19(0x17d),_0x13aad0)[_0x3a6f19(0x213)](_0x280c5e),_0x133276=new Intl[(_0x3a6f19(0x221))](_0x3a6f19(0x17d),_0x13aad0)[_0x3a6f19(0x213)](_0x33f0d0);_0x572b27+=_0x3a6f19(0x110),_0x572b27+='<p>SALES\x20REPORTS</p>',_0x572b27+='<p>'+_0x4ed636+_0x3a6f19(0x180)+_0x133276+_0x3a6f19(0x113),_0x572b27+=_0x3a6f19(0x173),_0x572b27+=_0x3a6f19(0x13e),_0x572b27+=_0x3a6f19(0x25f),_0x572b27+=_0x3332c8,_0x572b27+=_0x3a6f19(0x154),_0x572b27+=_0x3a6f19(0x10e),_0x572b27+=_0x3a6f19(0x10e);const _0x57e4da={'format':_0x3a6f19(0x114),'orientation':_0x3a6f19(0x142),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x3a6f19(0x138)}}};pdf['create'](_0x572b27,_0x57e4da)[_0x3a6f19(0x28a)](function(_0x54aaf7,_0x48f84f){const _0x599977=_0x3a6f19;if(_0x54aaf7){_0x212a1c[_0x599977(0x27a)](0x1f4)['send'](_0x599977(0x14f));return;}_0x212a1c[_0x599977(0x190)]('Content-Type',_0x599977(0x202)),_0x48f84f[_0x599977(0x141)](_0x212a1c);});}),router['get'](a0_0x4b16db(0x1ca),auth,async(_0x481ec9,_0x187c79)=>{const _0x10d0dc=a0_0x4b16db;try{const {username:_0x9c246f,email:_0x51d15,role:_0x2214be}=_0x481ec9['user'],_0xbe18b7=_0x481ec9[_0x10d0dc(0x10d)],_0x4df099=await profile[_0x10d0dc(0x261)]({'email':_0xbe18b7[_0x10d0dc(0x194)]}),_0x13a759={'year':_0x10d0dc(0x234),'month':_0x10d0dc(0x1e8),'day':_0x10d0dc(0x234)},_0x14bf0f=await master_shop[_0x10d0dc(0x288)](),_0x414a9c=await staff[_0x10d0dc(0x261)]({'email':_0xbe18b7[_0x10d0dc(0x194)]}),_0x42eb98=await product['find'](),_0x6c613=await warehouse[_0x10d0dc(0x240)]([{'$unwind':_0x10d0dc(0x1b7)},{'$lookup':{'from':_0x10d0dc(0x117),'localField':_0x10d0dc(0x266),'foreignField':'name','as':_0x10d0dc(0x1a7)}},{'$unwind':_0x10d0dc(0x16f)},{'$project':{'product_name':_0x10d0dc(0x269),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x10d0dc(0x27e),'product_stock':{'$sum':_0x10d0dc(0x1e7)}}}]),_0x3ac312=await staff[_0x10d0dc(0x288)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x14bf0f[0x0][_0x10d0dc(0x1df)]==_0x10d0dc(0x260))var _0x40650f=users[_0x10d0dc(0x12b)];else{if(_0x14bf0f[0x0][_0x10d0dc(0x1df)]==_0x10d0dc(0x171))var _0x40650f=users['Hindi'];else{if(_0x14bf0f[0x0][_0x10d0dc(0x1df)]==_0x10d0dc(0x12a))var _0x40650f=users[_0x10d0dc(0x12a)];else{if(_0x14bf0f[0x0][_0x10d0dc(0x1df)]==_0x10d0dc(0x13f))var _0x40650f=users['Spanish'];else{if(_0x14bf0f[0x0][_0x10d0dc(0x1df)]==_0x10d0dc(0x122))var _0x40650f=users[_0x10d0dc(0x122)];else{if(_0x14bf0f[0x0][_0x10d0dc(0x1df)]==_0x10d0dc(0x14c))var _0x40650f=users[_0x10d0dc(0x1a5)];else{if(_0x14bf0f[0x0]['language']==_0x10d0dc(0x1fa))var _0x40650f=users[_0x10d0dc(0x1fa)];else{if(_0x14bf0f[0x0][_0x10d0dc(0x1df)]==_0x10d0dc(0x145))var _0x40650f=users[_0x10d0dc(0x273)];}}}}}}}_0x187c79[_0x10d0dc(0x123)](_0x10d0dc(0x1c7),{'success':_0x481ec9[_0x10d0dc(0x252)](_0x10d0dc(0x1c8)),'errors':_0x481ec9['flash'](_0x10d0dc(0x22c)),'alldata':_0x42eb98,'profile':_0x4df099,'master_shop':_0x14bf0f,'role':_0xbe18b7,'product_stock':_0x6c613,'language':_0x40650f,'staff_arr':_0x414a9c,'staff_data_all':_0x3ac312});}catch(_0x2948e9){_0x187c79[_0x10d0dc(0x248)](_0x2948e9);}});async function agentsdataDSICheck_admin(_0xfc991,_0x4c74f8,_0x29d7b6,_0x3a8536){const _0x477ccc=a0_0x4b16db,_0x1dd901=await product[_0x477ccc(0x240)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':_0x477ccc(0x14b),'product_code':_0x477ccc(0x1ae)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x160556=[];_0x160556[_0x477ccc(0x254)]=[];for(let _0x1a2eee=0x0;_0x1a2eee<=_0x1dd901[_0x477ccc(0x1c6)]-0x1;_0x1a2eee++){const _0x1c9fce=_0x1dd901[_0x1a2eee];_0x160556[_0x477ccc(0x254)][_0x477ccc(0x1e5)](_0x1c9fce);}const _0x3d4f11=await product['aggregate']([{'$group':{'_id':{'category':_0x477ccc(0x188)},'products':{'$push':{'brand':_0x477ccc(0x18b),'product_code':_0x477ccc(0x1ae),'product_name':_0x477ccc(0x14b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x11068b=await product[_0x477ccc(0x240)]([{'$group':{'_id':{'category':'$category','brand':_0x477ccc(0x18b)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x402527=await sales_sa[_0x477ccc(0x240)]([{'$match':{'date':{'$gte':_0xfc991,'$lte':_0x4c74f8},'sales_staff_id':_0x29d7b6,'sale_product.isFG':_0x477ccc(0x1ef)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x477ccc(0x1ef)}},{'$lookup':{'from':_0x477ccc(0x117),'localField':_0x477ccc(0x131),'foreignField':_0x477ccc(0x25c),'as':_0x477ccc(0x251)}},{'$unwind':_0x477ccc(0x20e)},{'$group':{'_id':{'dsi':_0x477ccc(0x1f3),'date':_0x477ccc(0x15f),'customer':'$customer'},'totalQty':{'$sum':_0x477ccc(0x1de)},'products':{'$push':{'qty':_0x477ccc(0x1de),'NetPrice':_0x477ccc(0x187),'discount':_0x477ccc(0x23e),'adj_discount':_0x477ccc(0x28d),'product_details':{'prod_name':_0x477ccc(0x192),'product_code':'$product_info.product_code','category':_0x477ccc(0x1cf),'brand':'$product_info.brand','gross_price':_0x477ccc(0x215)}}}}},{'$unwind':_0x477ccc(0x1aa)},{'$group':{'_id':{'dsi':_0x477ccc(0x16a),'date':_0x477ccc(0x1b0),'customer':_0x477ccc(0x184),'category':_0x477ccc(0x235),'brand':_0x477ccc(0x19c)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x477ccc(0x272)]}},'NetPrice':{'$sum':_0x477ccc(0x205)},'discount':{'$sum':_0x477ccc(0x1f6)},'adj_discount':{'$sum':_0x477ccc(0x28c)},'product_details':{'$first':_0x477ccc(0x1fc)}}},{'$group':{'_id':{'dsi':_0x477ccc(0x16a),'date':_0x477ccc(0x1b0),'customer':_0x477ccc(0x184)},'totalQty':{'$sum':_0x477ccc(0x270)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x477ccc(0x276)},'discount':{'$sum':_0x477ccc(0x19b)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x477ccc(0x270),'category':'$_id.category','brand':_0x477ccc(0x1d4),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x414c91=[],_0x2b9aa1={},_0x3c9564={},_0x19257a={};var _0x622788=0x0,_0x39de8c=0x0,_0x98f056=0x0,_0x539244=0x0,_0x382538=0x0;const _0x209ef6=0x6;for(let _0x57834f=0x0;_0x57834f<=_0x402527[_0x477ccc(0x1c6)]-0x1;_0x57834f++){const _0x160469=_0x402527[_0x57834f];let _0x12d925=_0x477ccc(0x197);_0x12d925+=_0x477ccc(0x1dc)+_0x160469[_0x477ccc(0x129)][_0x477ccc(0x15a)]+_0x477ccc(0x1e6),_0x12d925+=_0x477ccc(0x1dc)+_0x160469[_0x477ccc(0x129)][_0x477ccc(0x23d)]+'</td>',_0x12d925+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x160469[_0x477ccc(0x129)][_0x477ccc(0x238)]+_0x477ccc(0x1e6);let _0x27fe91={};var _0x3e469b=0x0;for(let _0x166971=0x0;_0x166971<=_0x160469[_0x477ccc(0x117)]['length']-0x1;_0x166971++){const _0x3dc188=_0x160469['products'][_0x166971];_0x27fe91[_0x3dc188[_0x477ccc(0x16e)]+'-'+_0x3dc188[_0x477ccc(0x22d)]]=_0x3dc188['qty'];const _0x144ed5=_0x3dc188[_0x477ccc(0x16e)]+'-'+_0x3dc188[_0x477ccc(0x22d)];!_0x2b9aa1[_0x144ed5]&&(_0x2b9aa1[_0x144ed5]=0x0),!Array[_0x477ccc(0x1a4)](_0x19257a[_0x144ed5])&&(_0x19257a[_0x144ed5]=[]),!Array[_0x477ccc(0x1a4)](_0x19257a[_0x144ed5])&&(_0x19257a[_0x144ed5]=[]),_0x2b9aa1[_0x144ed5]+=_0x3dc188[_0x477ccc(0x26a)],_0x19257a[_0x144ed5][_0x477ccc(0x1e5)](_0x3dc188[_0x477ccc(0x26a)]),_0x3e469b++;}console[_0x477ccc(0x1d7)](_0x160469);for(let _0x29b6ba=0x0;_0x29b6ba<=_0x160556['cat_brand'][_0x477ccc(0x1c6)]-0x1;_0x29b6ba++){const _0x4f9832=_0x160556[_0x477ccc(0x254)][_0x29b6ba],_0x4f583a=_0x4f9832['_id']['brand']+'-'+_0x4f9832['_id'][_0x477ccc(0x22d)];_0x12d925+=_0x477ccc(0x15b)+(_0x27fe91[_0x4f583a]!==undefined?_0x27fe91[_0x4f583a][_0x477ccc(0x26e)](0x2):'')+_0x477ccc(0x1e6);}_0x98f056=_0x160469[_0x477ccc(0x229)]+_0x160469[_0x477ccc(0x25d)],_0x12d925+=_0x477ccc(0x280)+formatNumber(parseFloat(_0x160469['totalQty'],0x2)[_0x477ccc(0x26e)](0x2))+'</td>',_0x12d925+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x160469[_0x477ccc(0x1d3)][_0x477ccc(0x26e)](0x2))+'</td>',_0x12d925+=_0x477ccc(0x280)+formatNumber(_0x98f056)+_0x477ccc(0x1e6),_0x12d925+=_0x477ccc(0x280)+formatNumber(_0x160469[_0x477ccc(0x12e)]['toFixed'](0x2))+_0x477ccc(0x1e6),_0x12d925+=_0x477ccc(0x13c),_0x622788+=parseFloat(_0x160469[_0x477ccc(0x195)][_0x477ccc(0x26e)](0x2)),_0x39de8c+=parseFloat(_0x160469[_0x477ccc(0x12e)][_0x477ccc(0x26e)](0x2)),_0x539244+=_0x98f056,_0x382538+=parseFloat(_0x160469[_0x477ccc(0x1d3)]['toFixed'](0x2));if(_0x57834f==_0x402527[_0x477ccc(0x1c6)]-0x1){_0x12d925+='<tr>',_0x12d925+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x12d925+=_0x477ccc(0x1e6);for(let _0xde9713=0x0;_0xde9713<=_0x160556[_0x477ccc(0x254)]['length']-0x1;_0xde9713++){const _0x3822ee=_0x160556[_0x477ccc(0x254)][_0xde9713],_0x270d0d=_0x3822ee[_0x477ccc(0x129)][_0x477ccc(0x16e)]+'-'+_0x3822ee['_id'][_0x477ccc(0x22d)],_0x20fd2d=_0x19257a[_0x270d0d][_0x477ccc(0x16c)]((_0x46b35e,_0x5e8011)=>_0x46b35e+_0x5e8011,0x0);console['log'](_0x477ccc(0x1b4),_0x270d0d),_0x12d925+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x20fd2d!==undefined?formatNumber(_0x20fd2d[_0x477ccc(0x26e)](0x2)):'')+_0x477ccc(0x1fe),console[_0x477ccc(0x1d7)](_0x19257a[_0x270d0d]['reduce']((_0x12f13e,_0x524612)=>_0x12f13e+_0x524612,0x0));}_0x12d925+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x622788[_0x477ccc(0x26e)](0x2))+_0x477ccc(0x1fe),_0x12d925+=_0x477ccc(0x275)+formatNumber(_0x382538)+'</b></td>',_0x12d925+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x539244)+'</b></td>',_0x12d925+=_0x477ccc(0x275)+formatNumber(_0x39de8c)+_0x477ccc(0x1fe),_0x12d925+=_0x477ccc(0x13c);}_0x414c91[_0x477ccc(0x1e5)](_0x12d925);}function _0x3439e0(_0x4dfd14,_0xdff954){const _0x2c92f1=_0x477ccc,_0x24a46f=[];for(let _0x4cd28f=0x0;_0x4cd28f<=_0x4dfd14[_0x2c92f1(0x1c6)]-0x1;_0x4cd28f+=_0xdff954){_0x24a46f[_0x2c92f1(0x1e5)](_0x4dfd14['slice'](_0x4cd28f,_0x4cd28f+_0xdff954));}return _0x24a46f;}const _0x3edadb=_0x3439e0(_0x414c91,_0x209ef6);let _0x55b363='';return _0x3edadb[_0x477ccc(0x289)]((_0x13a116,_0x266ca2)=>{const _0x4e900c=_0x477ccc;_0x266ca2>0x0&&(_0x55b363+=_0x4e900c(0x28e));_0x55b363+=_0x4e900c(0x25f),_0x55b363+='<thead>',_0x55b363+=_0x4e900c(0x197),_0x55b363+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x55b363+=_0x4e900c(0x13c),_0x55b363+=_0x4e900c(0x197),_0x55b363+=_0x4e900c(0x1c4);for(let _0x528213=0x0;_0x528213<=_0x3d4f11['length']-0x1;_0x528213++){const _0x438e11=_0x3d4f11[_0x528213];for(let _0x27df1c=0x0;_0x27df1c<_0x11068b[_0x4e900c(0x1c6)];_0x27df1c++){const _0x1764ad=_0x11068b[_0x27df1c];_0x1764ad['_id']===_0x438e11[_0x4e900c(0x129)][_0x4e900c(0x22d)]&&(_0x55b363+=_0x4e900c(0x1ad)+_0x1764ad[_0x4e900c(0x16b)]+'\x22\x20class=\x22cat_data\x22>'+_0x438e11[_0x4e900c(0x129)][_0x4e900c(0x22d)]+_0x4e900c(0x1e6));}}_0x55b363+=_0x4e900c(0x20b),_0x55b363+=_0x4e900c(0x13c),_0x55b363+='<tr>',_0x55b363+=_0x4e900c(0x155),_0x55b363+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x55b363+=_0x4e900c(0x257);for(let _0x316602=0x0;_0x316602<=_0x3d4f11[_0x4e900c(0x1c6)]-0x1;_0x316602++){const _0x4b85f0=_0x3d4f11[_0x316602];for(let _0x4fce25=0x0;_0x4fce25<_0x160556[_0x4e900c(0x254)]['length'];_0x4fce25++){const _0x11b809=_0x160556[_0x4e900c(0x254)][_0x4fce25];_0x11b809[_0x4e900c(0x129)]['category']===_0x4b85f0[_0x4e900c(0x129)][_0x4e900c(0x22d)]&&(_0x55b363+=_0x4e900c(0x285)+_0x11b809['_id'][_0x4e900c(0x16e)]+_0x4e900c(0x1e6));}}_0x55b363+=_0x4e900c(0x21c),_0x55b363+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x55b363+=_0x4e900c(0x1f0),_0x55b363+=_0x4e900c(0x159),_0x55b363+=_0x4e900c(0x13c),_0x55b363+=_0x4e900c(0x165),_0x55b363+='<tbody>',_0x13a116[_0x4e900c(0x289)](_0x35b7e8=>{_0x55b363+=_0x35b7e8;}),console['log'](_0x19257a),_0x55b363+=_0x4e900c(0x206),_0x55b363+='</table>';}),_0x55b363;}async function agentsdataDSICheck_admin_excel(_0x4c4968,_0x547e7c,_0x4a1a5f,_0x22b29a){const _0x2b7747=a0_0x4b16db,_0x283e6b=await product[_0x2b7747(0x240)]([{'$group':{'_id':{'brand':'$brand','category':_0x2b7747(0x188)},'products':{'$push':{'name':_0x2b7747(0x14b),'product_code':_0x2b7747(0x1ae)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3f9be5=[];_0x3f9be5[_0x2b7747(0x254)]=[];for(let _0x4b006d=0x0;_0x4b006d<=_0x283e6b[_0x2b7747(0x1c6)]-0x1;_0x4b006d++){const _0x309097=_0x283e6b[_0x4b006d];_0x3f9be5['cat_brand'][_0x2b7747(0x1e5)](_0x309097);}const _0x302949=await product[_0x2b7747(0x240)]([{'$group':{'_id':{'category':_0x2b7747(0x188)},'products':{'$push':{'brand':_0x2b7747(0x18b),'product_code':_0x2b7747(0x1ae),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x2882cb=await product[_0x2b7747(0x240)]([{'$group':{'_id':{'category':_0x2b7747(0x188),'brand':_0x2b7747(0x18b)}}},{'$group':{'_id':_0x2b7747(0x185),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1f1e54=await sales_sa[_0x2b7747(0x240)]([{'$match':{'date':{'$gte':_0x4c4968,'$lte':_0x547e7c},'sales_staff_id':_0x4a1a5f,'sale_product.isFG':_0x2b7747(0x1ef)}},{'$unwind':_0x2b7747(0x1bc)},{'$match':{'sale_product.isFG':_0x2b7747(0x1ef)}},{'$lookup':{'from':_0x2b7747(0x117),'localField':_0x2b7747(0x131),'foreignField':_0x2b7747(0x25c),'as':_0x2b7747(0x251)}},{'$unwind':_0x2b7747(0x20e)},{'$group':{'_id':{'dsi':_0x2b7747(0x1f3),'date':_0x2b7747(0x15f),'customer':_0x2b7747(0x24b)},'totalQty':{'$sum':_0x2b7747(0x1de)},'products':{'$push':{'qty':_0x2b7747(0x1de),'NetPrice':_0x2b7747(0x187),'discount':_0x2b7747(0x23e),'adj_discount':_0x2b7747(0x28d),'product_details':{'prod_name':_0x2b7747(0x192),'product_code':_0x2b7747(0x14a),'category':_0x2b7747(0x1cf),'brand':'$product_info.brand','gross_price':_0x2b7747(0x215)}}}}},{'$unwind':_0x2b7747(0x1aa)},{'$group':{'_id':{'dsi':_0x2b7747(0x16a),'date':_0x2b7747(0x1b0),'customer':_0x2b7747(0x184),'category':'$products.product_details.category','brand':_0x2b7747(0x19c)},'totalQty':{'$sum':_0x2b7747(0x14d)},'totalGross':{'$sum':{'$multiply':[_0x2b7747(0x14d),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x2b7747(0x205)},'discount':{'$sum':_0x2b7747(0x1f6)},'adj_discount':{'$sum':_0x2b7747(0x28c)},'product_details':{'$first':_0x2b7747(0x1fc)}}},{'$group':{'_id':{'dsi':_0x2b7747(0x16a),'date':_0x2b7747(0x1b0),'customer':_0x2b7747(0x184)},'totalQty':{'$sum':_0x2b7747(0x270)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x2b7747(0x276)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x2b7747(0x253)},'products':{'$push':{'qty':_0x2b7747(0x270),'category':_0x2b7747(0x185),'brand':_0x2b7747(0x1d4),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x525769=[],_0x50f7ff={},_0x1f79a0={},_0x1748e5={};var _0x573439=0x0,_0x3a2ec3=0x0,_0x407c83=0x0,_0x18f06f=0x0,_0x494925=0x0;const _0x1fd605=0x16345785d8a0000;for(let _0x259ba8=0x0;_0x259ba8<=_0x1f1e54['length']-0x1;_0x259ba8++){const _0x505058=_0x1f1e54[_0x259ba8];let _0x44ce1f=_0x2b7747(0x197);_0x44ce1f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x505058[_0x2b7747(0x129)][_0x2b7747(0x15a)]+_0x2b7747(0x1e6),_0x44ce1f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x505058[_0x2b7747(0x129)][_0x2b7747(0x23d)]+'</td>',_0x44ce1f+=_0x2b7747(0x1dc)+_0x505058[_0x2b7747(0x129)]['customer']+'</td>';let _0x25e76e={};var _0x62583a=0x0;for(let _0xd7e0d2=0x0;_0xd7e0d2<=_0x505058[_0x2b7747(0x117)][_0x2b7747(0x1c6)]-0x1;_0xd7e0d2++){const _0x2b43fa=_0x505058['products'][_0xd7e0d2];_0x25e76e[_0x2b43fa['brand']+'-'+_0x2b43fa[_0x2b7747(0x22d)]]=_0x2b43fa['qty'];const _0x1ce6f3=_0x2b43fa['brand']+'-'+_0x2b43fa[_0x2b7747(0x22d)];!_0x50f7ff[_0x1ce6f3]&&(_0x50f7ff[_0x1ce6f3]=0x0),!Array['isArray'](_0x1748e5[_0x1ce6f3])&&(_0x1748e5[_0x1ce6f3]=[]),!Array[_0x2b7747(0x1a4)](_0x1748e5[_0x1ce6f3])&&(_0x1748e5[_0x1ce6f3]=[]),_0x50f7ff[_0x1ce6f3]+=_0x2b43fa[_0x2b7747(0x26a)],_0x1748e5[_0x1ce6f3]['push'](_0x2b43fa['qty']),_0x62583a++;}console[_0x2b7747(0x1d7)](_0x505058);for(let _0x53544e=0x0;_0x53544e<=_0x3f9be5[_0x2b7747(0x254)][_0x2b7747(0x1c6)]-0x1;_0x53544e++){const _0x19e342=_0x3f9be5['cat_brand'][_0x53544e],_0x4938db=_0x19e342['_id'][_0x2b7747(0x16e)]+'-'+_0x19e342[_0x2b7747(0x129)][_0x2b7747(0x22d)];_0x44ce1f+=_0x2b7747(0x15b)+(_0x25e76e[_0x4938db]!==undefined?_0x25e76e[_0x4938db][_0x2b7747(0x26e)](0x2):'')+_0x2b7747(0x1e6);}_0x407c83=_0x505058[_0x2b7747(0x229)]+_0x505058[_0x2b7747(0x25d)],_0x44ce1f+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x505058[_0x2b7747(0x195)],0x2)[_0x2b7747(0x26e)](0x2))+_0x2b7747(0x1e6),_0x44ce1f+=_0x2b7747(0x280)+formatNumber(_0x505058[_0x2b7747(0x1d3)][_0x2b7747(0x26e)](0x2))+'</td>',_0x44ce1f+=_0x2b7747(0x280)+formatNumber(_0x407c83)+_0x2b7747(0x1e6),_0x44ce1f+=_0x2b7747(0x280)+formatNumber(_0x505058[_0x2b7747(0x12e)][_0x2b7747(0x26e)](0x2))+_0x2b7747(0x1e6),_0x44ce1f+=_0x2b7747(0x13c),_0x573439+=parseFloat(_0x505058[_0x2b7747(0x195)]['toFixed'](0x2)),_0x3a2ec3+=parseFloat(_0x505058['NetPrice'][_0x2b7747(0x26e)](0x2)),_0x18f06f+=_0x407c83,_0x494925+=parseFloat(_0x505058[_0x2b7747(0x1d3)]['toFixed'](0x2));if(_0x259ba8==_0x1f1e54[_0x2b7747(0x1c6)]-0x1){_0x44ce1f+=_0x2b7747(0x197),_0x44ce1f+=_0x2b7747(0x11d),_0x44ce1f+=_0x2b7747(0x1e6);for(let _0x363779=0x0;_0x363779<=_0x3f9be5[_0x2b7747(0x254)][_0x2b7747(0x1c6)]-0x1;_0x363779++){const _0x4b9f08=_0x3f9be5['cat_brand'][_0x363779],_0x160a67=_0x4b9f08['_id'][_0x2b7747(0x16e)]+'-'+_0x4b9f08[_0x2b7747(0x129)][_0x2b7747(0x22d)],_0x481e5d=_0x1748e5[_0x160a67][_0x2b7747(0x16c)]((_0x347e49,_0x4cd445)=>_0x347e49+_0x4cd445,0x0);console['log']('test',_0x160a67),_0x44ce1f+=_0x2b7747(0x181)+(_0x481e5d!==undefined?formatNumber(_0x481e5d[_0x2b7747(0x26e)](0x2)):'')+_0x2b7747(0x1fe),console['log'](_0x1748e5[_0x160a67][_0x2b7747(0x16c)]((_0x47b98c,_0x57f277)=>_0x47b98c+_0x57f277,0x0));}_0x44ce1f+=_0x2b7747(0x275)+formatNumber(_0x573439['toFixed'](0x2))+'</b></td>',_0x44ce1f+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x494925)+'</b></td>',_0x44ce1f+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x18f06f)+_0x2b7747(0x1fe),_0x44ce1f+=_0x2b7747(0x275)+formatNumber(_0x3a2ec3)+'</b></td>',_0x44ce1f+=_0x2b7747(0x13c);}_0x525769[_0x2b7747(0x1e5)](_0x44ce1f);}function _0x4f178a(_0x139aca,_0x22c0d3){const _0x49f487=_0x2b7747,_0x25c35a=[];for(let _0x1e89d1=0x0;_0x1e89d1<=_0x139aca[_0x49f487(0x1c6)]-0x1;_0x1e89d1+=_0x22c0d3){_0x25c35a['push'](_0x139aca[_0x49f487(0x277)](_0x1e89d1,_0x1e89d1+_0x22c0d3));}return _0x25c35a;}const _0x304020=_0x4f178a(_0x525769,_0x1fd605);let _0x32d61f='';return _0x304020['forEach']((_0x9cac35,_0x906ebb)=>{const _0x39e471=_0x2b7747;_0x906ebb>0x0&&(_0x32d61f+=_0x39e471(0x28e));_0x32d61f+=_0x39e471(0x25f),_0x32d61f+=_0x39e471(0x236),_0x32d61f+=_0x39e471(0x197),_0x32d61f+=_0x39e471(0x23c),_0x32d61f+=_0x39e471(0x13c),_0x32d61f+='<tr>',_0x32d61f+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0xf07a48=0x0;_0xf07a48<=_0x302949[_0x39e471(0x1c6)]-0x1;_0xf07a48++){const _0x1315b8=_0x302949[_0xf07a48];for(let _0x5533b7=0x0;_0x5533b7<_0x2882cb['length'];_0x5533b7++){const _0x2671b0=_0x2882cb[_0x5533b7];_0x2671b0[_0x39e471(0x129)]===_0x1315b8['_id'][_0x39e471(0x22d)]&&(_0x32d61f+=_0x39e471(0x1ad)+_0x2671b0[_0x39e471(0x16b)]+'\x22\x20class=\x22cat_data\x22>'+_0x1315b8[_0x39e471(0x129)]['category']+_0x39e471(0x1e6));}}_0x32d61f+=_0x39e471(0x20b),_0x32d61f+='</tr>',_0x32d61f+=_0x39e471(0x197),_0x32d61f+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x32d61f+=_0x39e471(0x279),_0x32d61f+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0xe6ad00=0x0;_0xe6ad00<=_0x302949[_0x39e471(0x1c6)]-0x1;_0xe6ad00++){const _0x5492f8=_0x302949[_0xe6ad00];for(let _0x4e10c5=0x0;_0x4e10c5<_0x3f9be5[_0x39e471(0x254)]['length'];_0x4e10c5++){const _0x36d92e=_0x3f9be5['cat_brand'][_0x4e10c5];_0x36d92e[_0x39e471(0x129)][_0x39e471(0x22d)]===_0x5492f8[_0x39e471(0x129)][_0x39e471(0x22d)]&&(_0x32d61f+=_0x39e471(0x285)+_0x36d92e[_0x39e471(0x129)][_0x39e471(0x16e)]+_0x39e471(0x1e6));}}_0x32d61f+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x32d61f+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x32d61f+=_0x39e471(0x1f0),_0x32d61f+=_0x39e471(0x159),_0x32d61f+='</tr>',_0x32d61f+=_0x39e471(0x165),_0x32d61f+=_0x39e471(0x265),_0x9cac35[_0x39e471(0x289)](_0xf49b0e=>{_0x32d61f+=_0xf49b0e;}),console[_0x39e471(0x1d7)](_0x1748e5),_0x32d61f+=_0x39e471(0x206),_0x32d61f+=_0x39e471(0x154);}),_0x32d61f;}router['post'](a0_0x4b16db(0x12d),auth,async(_0x40c853,_0x3e9613)=>{const _0x1bfeb1=a0_0x4b16db,{from_date:_0x2d3531,to_date:_0x2945d7,isExcel:_0x4ec473,agent_id:_0x4f1347}=_0x40c853[_0x1bfeb1(0x15c)],_0x3aca63=_0x40c853[_0x1bfeb1(0x10d)],_0x243cb7=await staff[_0x1bfeb1(0x261)]({'email':_0x3aca63[_0x1bfeb1(0x194)]}),_0x29bc9c=await master_shop[_0x1bfeb1(0x288)](),_0x53b7a2=await agentsdataDSICheck_admin(_0x2d3531,_0x2945d7,_0x4f1347,_0x4ec473),_0x16c848=await agentsdataDSICheck_admin_excel(_0x2d3531,_0x2945d7,_0x4f1347,_0x4ec473);let _0x5c93fa=_0x1bfeb1(0x24f);var _0x37ca32=new Date(_0x2d3531),_0x2958a4=new Date(_0x2945d7);const _0x4b2d3c={'year':_0x1bfeb1(0x234),'month':_0x1bfeb1(0x1e8),'day':_0x1bfeb1(0x234)},_0x16c977=new Intl[(_0x1bfeb1(0x221))](_0x1bfeb1(0x17d),_0x4b2d3c)[_0x1bfeb1(0x213)](_0x37ca32),_0x45ee52=new Intl[(_0x1bfeb1(0x221))]('en-US',_0x4b2d3c)[_0x1bfeb1(0x213)](_0x2958a4);_0x5c93fa+=_0x1bfeb1(0x173),_0x5c93fa+=_0x1bfeb1(0x21f),_0x5c93fa+='<table>',_0x5c93fa+=_0x53b7a2,_0x5c93fa+='</table>',_0x5c93fa+=_0x1bfeb1(0x10e),_0x5c93fa+=_0x1bfeb1(0x10e);let _0x4803f3=_0x1bfeb1(0x24f);_0x4803f3+='<div\x20class=\x22row\x22>',_0x4803f3+='<div\x20\x20id=\x22table-conatainer\x22>',_0x4803f3+='<table>',_0x4803f3+=_0x16c848,_0x4803f3+=_0x1bfeb1(0x154),_0x4803f3+='</div>',_0x4803f3+=_0x1bfeb1(0x10e);let _0x3ab98b=_0x1bfeb1(0x22f);const _0x2e651d={'width':_0x1bfeb1(0x13b),'height':'8.5in','orientation':_0x1bfeb1(0x142),'border':{'top':_0x1bfeb1(0x255),'right':_0x1bfeb1(0x255),'bottom':_0x1bfeb1(0x255),'left':_0x1bfeb1(0x255)},'header':{'height':'60mm','contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3ab98b+_0x1bfeb1(0x211)+_0x16c977+_0x1bfeb1(0x180)+_0x45ee52+_0x1bfeb1(0x182)},'footer':{'height':_0x1bfeb1(0x108),'contents':{'default':_0x1bfeb1(0x24c)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x1bfeb1(0x138)}}};if(_0x4ec473=='on'){const _0x58cbbd=cheerio['load'](_0x4803f3);let _0x338f9e=[],_0x182f8d=[],_0x35cd50=[];_0x58cbbd(_0x1bfeb1(0x17c))[_0x1bfeb1(0x23b)]((_0x47aaf7,_0x24a45f)=>{const _0xce2d93=_0x1bfeb1;let _0x55386f=[],_0x1b80fe=0x0;while(_0x35cd50[_0x1b80fe]){_0x35cd50[_0x1b80fe]--,_0x1b80fe++;}_0x58cbbd(_0x24a45f)['find'](_0xce2d93(0x153))['each']((_0x2d578c,_0x1bcee4)=>{const _0x2428dd=_0xce2d93;let _0x5ed4f1=_0x58cbbd(_0x1bcee4)[_0x2428dd(0x1ab)]()['trim'](),_0x1224c6=parseFloat(_0x5ed4f1[_0x2428dd(0x1a8)](/,/g,''));isNaN(_0x1224c6)&&(_0x1224c6=_0x5ed4f1);let _0x50499f=parseInt(_0x58cbbd(_0x1bcee4)[_0x2428dd(0x1f4)]('colspan'))||0x1,_0x648e01=parseInt(_0x58cbbd(_0x1bcee4)[_0x2428dd(0x1f4)]('rowspan'))||0x1;_0x55386f[_0x1b80fe]=_0x1224c6;(_0x50499f>0x1||_0x648e01>0x1)&&_0x182f8d['push']({'s':{'r':_0x47aaf7,'c':_0x1b80fe},'e':{'r':_0x47aaf7+_0x648e01-0x1,'c':_0x1b80fe+_0x50499f-0x1}});for(let _0x430ca4=0x0;_0x430ca4<_0x50499f;_0x430ca4++){_0x648e01>0x1&&(_0x35cd50[_0x1b80fe+_0x430ca4]=_0x648e01-0x1);}_0x1b80fe+=_0x50499f;}),_0x338f9e[_0xce2d93(0x1e5)](_0x55386f);});const _0x2a95c1=XLSX[_0x1bfeb1(0x256)][_0x1bfeb1(0x1be)](),_0x18d618=XLSX[_0x1bfeb1(0x256)][_0x1bfeb1(0x183)](_0x338f9e);_0x182f8d[_0x1bfeb1(0x1c6)]>0x0&&(_0x18d618[_0x1bfeb1(0x282)]=_0x182f8d);_0x18d618[_0x1bfeb1(0x1b9)]=_0x338f9e[0x0][_0x1bfeb1(0x243)](()=>({'wpx':0x64})),XLSX[_0x1bfeb1(0x256)][_0x1bfeb1(0x17e)](_0x2a95c1,_0x18d618,_0x1bfeb1(0x207));const _0x280401=XLSX[_0x1bfeb1(0x1fb)](_0x2a95c1,{'bookType':_0x1bfeb1(0x11a),'type':_0x1bfeb1(0x112)});_0x3e9613[_0x1bfeb1(0x190)]('Content-Disposition',_0x1bfeb1(0x246)),_0x3e9613[_0x1bfeb1(0x190)](_0x1bfeb1(0x147),_0x1bfeb1(0x10b)),_0x3e9613[_0x1bfeb1(0x1ac)](_0x280401);}else pdf['create'](_0x5c93fa,_0x2e651d)[_0x1bfeb1(0x28a)](function(_0x1c224c,_0x2055d2){const _0x39301d=_0x1bfeb1;if(_0x1c224c){_0x3e9613[_0x39301d(0x27a)](0x1f4)[_0x39301d(0x1ac)](_0x39301d(0x14f));return;}_0x3e9613[_0x39301d(0x190)](_0x39301d(0x147),'application/pdf'),_0x2055d2[_0x39301d(0x141)](_0x3e9613);});}),router[a0_0x4b16db(0x209)](a0_0x4b16db(0x220),auth,async(_0x3bfa36,_0x13753c)=>{const _0x55fd5f=a0_0x4b16db;try{const {username:_0x30361e,email:_0x5ddb53,role:_0x5d13de}=_0x3bfa36[_0x55fd5f(0x10d)],_0x1e46f2=_0x3bfa36[_0x55fd5f(0x10d)],_0x58eada=await profile[_0x55fd5f(0x261)]({'email':_0x1e46f2[_0x55fd5f(0x194)]}),_0x1df70a={'year':'numeric','month':'long','day':_0x55fd5f(0x234)},_0x36b5ce=await master_shop[_0x55fd5f(0x288)](),_0x9dd137=await staff[_0x55fd5f(0x261)]({'email':_0x1e46f2[_0x55fd5f(0x194)]}),_0x1d42e9=await product['find'](),_0x5307f4=await warehouse[_0x55fd5f(0x240)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x55fd5f(0x117),'localField':'product_details.product_name','foreignField':_0x55fd5f(0x18f),'as':_0x55fd5f(0x1a7)}},{'$unwind':_0x55fd5f(0x16f)},{'$project':{'product_name':_0x55fd5f(0x269),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x55fd5f(0x27e),'product_stock':{'$sum':_0x55fd5f(0x1e7)}}}]);if(_0x36b5ce[0x0][_0x55fd5f(0x1df)]=='English\x20(US)')var _0x5ab7cd=users['English'];else{if(_0x36b5ce[0x0][_0x55fd5f(0x1df)]==_0x55fd5f(0x171))var _0x5ab7cd=users['Hindi'];else{if(_0x36b5ce[0x0]['language']==_0x55fd5f(0x12a))var _0x5ab7cd=users['German'];else{if(_0x36b5ce[0x0][_0x55fd5f(0x1df)]=='Spanish')var _0x5ab7cd=users['Spanish'];else{if(_0x36b5ce[0x0][_0x55fd5f(0x1df)]==_0x55fd5f(0x122))var _0x5ab7cd=users[_0x55fd5f(0x122)];else{if(_0x36b5ce[0x0]['language']==_0x55fd5f(0x14c))var _0x5ab7cd=users[_0x55fd5f(0x1a5)];else{if(_0x36b5ce[0x0][_0x55fd5f(0x1df)]=='Chinese')var _0x5ab7cd=users[_0x55fd5f(0x1fa)];else{if(_0x36b5ce[0x0][_0x55fd5f(0x1df)]==_0x55fd5f(0x145))var _0x5ab7cd=users['Arabic'];}}}}}}}_0x13753c[_0x55fd5f(0x123)](_0x55fd5f(0x25a),{'success':_0x3bfa36[_0x55fd5f(0x252)](_0x55fd5f(0x1c8)),'errors':_0x3bfa36[_0x55fd5f(0x252)]('errors'),'alldata':_0x1d42e9,'profile':_0x58eada,'master_shop':_0x36b5ce,'role':_0x1e46f2,'product_stock':_0x5307f4,'language':_0x5ab7cd,'staff_arr':_0x9dd137});}catch(_0xde1c07){}});function formatNumber(_0x260a6c,_0x73dd69=a0_0x4b16db(0x17d),_0x5dd002={'minimumFractionDigits':0x2}){const _0x3e5e15=a0_0x4b16db,_0x22134d=new Intl[(_0x3e5e15(0x24e))](_0x73dd69,_0x5dd002);return _0x22134d[_0x3e5e15(0x213)](_0x260a6c);}async function agentsdataDSICheck(_0x52f075,_0x172557,_0x4757a6,_0xb0ba3){const _0x2b0074=a0_0x4b16db,_0x420646=await product[_0x2b0074(0x240)]([{'$group':{'_id':{'brand':_0x2b0074(0x18b),'category':_0x2b0074(0x188)},'products':{'$push':{'name':_0x2b0074(0x14b),'product_code':_0x2b0074(0x1ae)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3afb04=[];_0x3afb04['cat_brand']=[];for(let _0xd139dc=0x0;_0xd139dc<=_0x420646[_0x2b0074(0x1c6)]-0x1;_0xd139dc++){const _0x2a075c=_0x420646[_0xd139dc];_0x3afb04['cat_brand'][_0x2b0074(0x1e5)](_0x2a075c);}const _0x1444a2=await product[_0x2b0074(0x240)]([{'$group':{'_id':{'category':_0x2b0074(0x188)},'products':{'$push':{'brand':_0x2b0074(0x18b),'product_code':'$product_code','product_name':_0x2b0074(0x14b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x43563f=await product[_0x2b0074(0x240)]([{'$group':{'_id':{'category':_0x2b0074(0x188),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x19a526=await sales_sa[_0x2b0074(0x240)]([{'$match':{'date':{'$gte':_0x52f075,'$lte':_0x172557},'sales_staff_id':_0x4757a6,'sale_product.isFG':_0x2b0074(0x1ef)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x2b0074(0x1ef)}},{'$lookup':{'from':_0x2b0074(0x117),'localField':_0x2b0074(0x131),'foreignField':_0x2b0074(0x25c),'as':_0x2b0074(0x251)}},{'$unwind':_0x2b0074(0x20e)},{'$group':{'_id':{'dsi':_0x2b0074(0x1f3),'date':_0x2b0074(0x15f),'customer':'$customer'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x2b0074(0x1de),'NetPrice':_0x2b0074(0x187),'discount':_0x2b0074(0x23e),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x2b0074(0x192),'product_code':_0x2b0074(0x14a),'category':_0x2b0074(0x1cf),'brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x2b0074(0x1aa)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x2b0074(0x1b0),'customer':_0x2b0074(0x184),'category':'$products.product_details.category','brand':_0x2b0074(0x19c)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x2b0074(0x14d),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x2b0074(0x205)},'discount':{'$sum':_0x2b0074(0x1f6)},'adj_discount':{'$sum':_0x2b0074(0x28c)},'product_details':{'$first':_0x2b0074(0x1fc)}}},{'$group':{'_id':{'dsi':_0x2b0074(0x16a),'date':_0x2b0074(0x1b0),'customer':_0x2b0074(0x184)},'totalQty':{'$sum':_0x2b0074(0x270)},'totalGross':{'$sum':_0x2b0074(0x10a)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x2b0074(0x253)},'products':{'$push':{'qty':_0x2b0074(0x270),'category':_0x2b0074(0x185),'brand':'$_id.brand','product_details':_0x2b0074(0x1b7)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x1b7e12=[],_0x1e13d2={},_0x921be3={},_0x238f65={};var _0x393965=0x0,_0x2b5387=0x0,_0x3e6f65=0x0,_0x36c788=0x0,_0x584db0=0x0;const _0x5d75d4=0x6;for(let _0x16a604=0x0;_0x16a604<=_0x19a526[_0x2b0074(0x1c6)]-0x1;_0x16a604++){const _0x516d00=_0x19a526[_0x16a604];let _0xdbd031='<tr>';_0xdbd031+=_0x2b0074(0x1dc)+_0x516d00[_0x2b0074(0x129)]['dsi']+'</td>',_0xdbd031+=_0x2b0074(0x1dc)+_0x516d00['_id']['date']+_0x2b0074(0x1e6),_0xdbd031+=_0x2b0074(0x1dc)+_0x516d00[_0x2b0074(0x129)][_0x2b0074(0x238)]+'</td>';let _0x59c91a={};var _0x395951=0x0;for(let _0x499467=0x0;_0x499467<=_0x516d00['products'][_0x2b0074(0x1c6)]-0x1;_0x499467++){const _0x420843=_0x516d00[_0x2b0074(0x117)][_0x499467];_0x59c91a[_0x420843[_0x2b0074(0x16e)]+'-'+_0x420843[_0x2b0074(0x22d)]]=_0x420843[_0x2b0074(0x26a)];const _0x184457=_0x420843[_0x2b0074(0x16e)]+'-'+_0x420843['category'];!_0x1e13d2[_0x184457]&&(_0x1e13d2[_0x184457]=0x0),!Array[_0x2b0074(0x1a4)](_0x238f65[_0x184457])&&(_0x238f65[_0x184457]=[]),!Array[_0x2b0074(0x1a4)](_0x238f65[_0x184457])&&(_0x238f65[_0x184457]=[]),_0x1e13d2[_0x184457]+=_0x420843[_0x2b0074(0x26a)],_0x238f65[_0x184457][_0x2b0074(0x1e5)](_0x420843[_0x2b0074(0x26a)]),_0x395951++;}console[_0x2b0074(0x1d7)](_0x516d00);for(let _0x51223a=0x0;_0x51223a<=_0x3afb04[_0x2b0074(0x254)][_0x2b0074(0x1c6)]-0x1;_0x51223a++){const _0x357165=_0x3afb04[_0x2b0074(0x254)][_0x51223a],_0x466692=_0x357165[_0x2b0074(0x129)][_0x2b0074(0x16e)]+'-'+_0x357165['_id'][_0x2b0074(0x22d)];_0xdbd031+=_0x2b0074(0x15b)+(_0x59c91a[_0x466692]!==undefined?_0x59c91a[_0x466692][_0x2b0074(0x26e)](0x2):'')+_0x2b0074(0x1e6);}_0x3e6f65=_0x516d00[_0x2b0074(0x229)]+_0x516d00[_0x2b0074(0x25d)],_0xdbd031+=_0x2b0074(0x280)+formatNumber(parseFloat(_0x516d00[_0x2b0074(0x195)],0x2)['toFixed'](0x2))+_0x2b0074(0x1e6),_0xdbd031+=_0x2b0074(0x280)+formatNumber(_0x516d00['totalGross'][_0x2b0074(0x26e)](0x2))+_0x2b0074(0x1e6),_0xdbd031+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x3e6f65)+_0x2b0074(0x1e6),_0xdbd031+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x516d00[_0x2b0074(0x12e)][_0x2b0074(0x26e)](0x2))+_0x2b0074(0x1e6),_0xdbd031+=_0x2b0074(0x13c),_0x393965+=parseFloat(_0x516d00['totalQty'][_0x2b0074(0x26e)](0x2)),_0x2b5387+=parseFloat(_0x516d00['NetPrice'][_0x2b0074(0x26e)](0x2)),_0x36c788+=_0x3e6f65,_0x584db0+=parseFloat(_0x516d00['totalGross'][_0x2b0074(0x26e)](0x2));if(_0x16a604==_0x19a526[_0x2b0074(0x1c6)]-0x1){_0xdbd031+=_0x2b0074(0x197),_0xdbd031+=_0x2b0074(0x11d),_0xdbd031+=_0x2b0074(0x1e6);for(let _0x56fbe4=0x0;_0x56fbe4<=_0x3afb04[_0x2b0074(0x254)][_0x2b0074(0x1c6)]-0x1;_0x56fbe4++){const _0x2ffad2=_0x3afb04[_0x2b0074(0x254)][_0x56fbe4],_0x30291e=_0x2ffad2[_0x2b0074(0x129)][_0x2b0074(0x16e)]+'-'+_0x2ffad2[_0x2b0074(0x129)][_0x2b0074(0x22d)],_0x328c6a=_0x238f65[_0x30291e][_0x2b0074(0x16c)]((_0x42594c,_0x4dd2b2)=>_0x42594c+_0x4dd2b2,0x0);_0xdbd031+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x328c6a!==undefined?formatNumber(_0x328c6a[_0x2b0074(0x26e)](0x2)):'')+_0x2b0074(0x1fe),console[_0x2b0074(0x1d7)](_0x238f65[_0x30291e][_0x2b0074(0x16c)]((_0xe596ec,_0x351aee)=>_0xe596ec+_0x351aee,0x0));}_0xdbd031+=_0x2b0074(0x275)+formatNumber(_0x393965[_0x2b0074(0x26e)](0x2))+_0x2b0074(0x1fe),_0xdbd031+=_0x2b0074(0x275)+formatNumber(_0x584db0)+_0x2b0074(0x1fe),_0xdbd031+=_0x2b0074(0x275)+formatNumber(_0x36c788)+_0x2b0074(0x1fe),_0xdbd031+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2b5387)+_0x2b0074(0x1fe),_0xdbd031+='</tr>';}_0x1b7e12[_0x2b0074(0x1e5)](_0xdbd031);}function _0x4cea06(_0x289ed0,_0x1a996e){const _0x277db5=_0x2b0074,_0x302fc5=[];for(let _0x32434e=0x0;_0x32434e<=_0x289ed0[_0x277db5(0x1c6)]-0x1;_0x32434e+=_0x1a996e){_0x302fc5[_0x277db5(0x1e5)](_0x289ed0[_0x277db5(0x277)](_0x32434e,_0x32434e+_0x1a996e));}return _0x302fc5;}const _0x9970e7=_0x4cea06(_0x1b7e12,_0x5d75d4);let _0x307a46='';return _0x9970e7['forEach']((_0x37f3b8,_0x2ea952)=>{const _0x369a33=_0x2b0074;_0x2ea952>0x0&&(_0x307a46+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x307a46+=_0x369a33(0x25f),_0x307a46+='<thead>',_0x307a46+=_0x369a33(0x197),_0x307a46+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x307a46+=_0x369a33(0x13c),_0x307a46+=_0x369a33(0x197),_0x307a46+=_0x369a33(0x1c4);for(let _0x1b4189=0x0;_0x1b4189<=_0x1444a2['length']-0x1;_0x1b4189++){const _0x43db88=_0x1444a2[_0x1b4189];for(let _0x4c6af3=0x0;_0x4c6af3<_0x43563f['length'];_0x4c6af3++){const _0x3d2b6b=_0x43563f[_0x4c6af3];_0x3d2b6b[_0x369a33(0x129)]===_0x43db88[_0x369a33(0x129)]['category']&&(_0x307a46+=_0x369a33(0x1ad)+_0x3d2b6b['brandCount']+_0x369a33(0x283)+_0x43db88[_0x369a33(0x129)][_0x369a33(0x22d)]+_0x369a33(0x1e6));}}_0x307a46+=_0x369a33(0x20b),_0x307a46+='</tr>',_0x307a46+=_0x369a33(0x197),_0x307a46+=_0x369a33(0x155),_0x307a46+=_0x369a33(0x279),_0x307a46+=_0x369a33(0x257);for(let _0x28912c=0x0;_0x28912c<=_0x1444a2[_0x369a33(0x1c6)]-0x1;_0x28912c++){const _0x4aea41=_0x1444a2[_0x28912c];for(let _0x6be39=0x0;_0x6be39<_0x3afb04['cat_brand'][_0x369a33(0x1c6)];_0x6be39++){const _0x2d9085=_0x3afb04[_0x369a33(0x254)][_0x6be39];_0x2d9085[_0x369a33(0x129)][_0x369a33(0x22d)]===_0x4aea41[_0x369a33(0x129)][_0x369a33(0x22d)]&&(_0x307a46+=_0x369a33(0x285)+_0x2d9085[_0x369a33(0x129)][_0x369a33(0x16e)]+_0x369a33(0x1e6));}}_0x307a46+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x307a46+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x307a46+=_0x369a33(0x1f0),_0x307a46+=_0x369a33(0x159),_0x307a46+=_0x369a33(0x13c),_0x307a46+=_0x369a33(0x165),_0x307a46+=_0x369a33(0x265),_0x37f3b8['forEach'](_0x536b0e=>{_0x307a46+=_0x536b0e;}),console[_0x369a33(0x1d7)](_0x238f65),_0x307a46+=_0x369a33(0x206),_0x307a46+='</table>';}),_0x307a46;}async function agentsdataDSICheck_excel(_0x167b06,_0x3abe81,_0x521078,_0x4b172f){const _0xa578b0=a0_0x4b16db,_0x7b4768=await product[_0xa578b0(0x240)]([{'$group':{'_id':{'brand':_0xa578b0(0x18b),'category':'$category'},'products':{'$push':{'name':'$name','product_code':_0xa578b0(0x1ae)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x4e1df8=[];_0x4e1df8[_0xa578b0(0x254)]=[];for(let _0x58a79b=0x0;_0x58a79b<=_0x7b4768[_0xa578b0(0x1c6)]-0x1;_0x58a79b++){const _0x504a62=_0x7b4768[_0x58a79b];_0x4e1df8[_0xa578b0(0x254)][_0xa578b0(0x1e5)](_0x504a62);}const _0x225b73=await product[_0xa578b0(0x240)]([{'$group':{'_id':{'category':_0xa578b0(0x188)},'products':{'$push':{'brand':_0xa578b0(0x18b),'product_code':_0xa578b0(0x1ae),'product_name':_0xa578b0(0x14b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1778a4=await product[_0xa578b0(0x240)]([{'$group':{'_id':{'category':'$category','brand':_0xa578b0(0x18b)}}},{'$group':{'_id':_0xa578b0(0x185),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x769f25=await sales_sa[_0xa578b0(0x240)]([{'$match':{'date':{'$gte':_0x167b06,'$lte':_0x3abe81},'sales_staff_id':_0x521078,'sale_product.isFG':_0xa578b0(0x1ef)}},{'$unwind':_0xa578b0(0x1bc)},{'$match':{'sale_product.isFG':_0xa578b0(0x1ef)}},{'$lookup':{'from':_0xa578b0(0x117),'localField':_0xa578b0(0x131),'foreignField':_0xa578b0(0x25c),'as':_0xa578b0(0x251)}},{'$unwind':_0xa578b0(0x20e)},{'$group':{'_id':{'dsi':_0xa578b0(0x1f3),'date':_0xa578b0(0x15f),'customer':'$customer'},'totalQty':{'$sum':_0xa578b0(0x1de)},'products':{'$push':{'qty':_0xa578b0(0x1de),'NetPrice':_0xa578b0(0x187),'discount':_0xa578b0(0x23e),'adj_discount':_0xa578b0(0x28d),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':'$product_info.category','brand':_0xa578b0(0x1e9),'gross_price':_0xa578b0(0x215)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0xa578b0(0x16a),'date':_0xa578b0(0x1b0),'customer':_0xa578b0(0x184),'category':_0xa578b0(0x235),'brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0xa578b0(0x272)]}},'NetPrice':{'$sum':_0xa578b0(0x205)},'discount':{'$sum':_0xa578b0(0x1f6)},'adj_discount':{'$sum':_0xa578b0(0x28c)},'product_details':{'$first':_0xa578b0(0x1fc)}}},{'$group':{'_id':{'dsi':_0xa578b0(0x16a),'date':_0xa578b0(0x1b0),'customer':_0xa578b0(0x184)},'totalQty':{'$sum':_0xa578b0(0x270)},'totalGross':{'$sum':_0xa578b0(0x10a)},'NetPrice':{'$sum':_0xa578b0(0x276)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0xa578b0(0x253)},'products':{'$push':{'qty':_0xa578b0(0x270),'category':_0xa578b0(0x185),'brand':_0xa578b0(0x1d4),'product_details':_0xa578b0(0x1b7)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x132808=[],_0x55bbc2={},_0x43bdef={},_0x1e2233={};var _0x4bef50=0x0,_0x3b63dd=0x0,_0x57bd0d=0x0,_0x24b55b=0x0,_0x400c4f=0x0;const _0x36c3a3=0x9184e72a000;for(let _0x10effd=0x0;_0x10effd<=_0x769f25[_0xa578b0(0x1c6)]-0x1;_0x10effd++){const _0xa8a8fc=_0x769f25[_0x10effd];let _0x1c60d1=_0xa578b0(0x197);_0x1c60d1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xa8a8fc[_0xa578b0(0x129)]['dsi']+'</td>',_0x1c60d1+=_0xa578b0(0x1dc)+_0xa8a8fc[_0xa578b0(0x129)][_0xa578b0(0x23d)]+'</td>',_0x1c60d1+=_0xa578b0(0x1dc)+_0xa8a8fc[_0xa578b0(0x129)][_0xa578b0(0x238)]+_0xa578b0(0x1e6);let _0x2b264c={};var _0x578423=0x0;for(let _0x4b6113=0x0;_0x4b6113<=_0xa8a8fc[_0xa578b0(0x117)]['length']-0x1;_0x4b6113++){const _0x2c71bd=_0xa8a8fc[_0xa578b0(0x117)][_0x4b6113];_0x2b264c[_0x2c71bd[_0xa578b0(0x16e)]+'-'+_0x2c71bd[_0xa578b0(0x22d)]]=_0x2c71bd[_0xa578b0(0x26a)];const _0x70fd0e=_0x2c71bd[_0xa578b0(0x16e)]+'-'+_0x2c71bd[_0xa578b0(0x22d)];!_0x55bbc2[_0x70fd0e]&&(_0x55bbc2[_0x70fd0e]=0x0),!Array[_0xa578b0(0x1a4)](_0x1e2233[_0x70fd0e])&&(_0x1e2233[_0x70fd0e]=[]),!Array['isArray'](_0x1e2233[_0x70fd0e])&&(_0x1e2233[_0x70fd0e]=[]),_0x55bbc2[_0x70fd0e]+=_0x2c71bd[_0xa578b0(0x26a)],_0x1e2233[_0x70fd0e][_0xa578b0(0x1e5)](_0x2c71bd[_0xa578b0(0x26a)]),_0x578423++;}console['log'](_0xa8a8fc);for(let _0x18ad88=0x0;_0x18ad88<=_0x4e1df8[_0xa578b0(0x254)][_0xa578b0(0x1c6)]-0x1;_0x18ad88++){const _0x3fd195=_0x4e1df8[_0xa578b0(0x254)][_0x18ad88],_0x5e2ce3=_0x3fd195['_id']['brand']+'-'+_0x3fd195['_id'][_0xa578b0(0x22d)];_0x1c60d1+=_0xa578b0(0x15b)+(_0x2b264c[_0x5e2ce3]!==undefined?_0x2b264c[_0x5e2ce3][_0xa578b0(0x26e)](0x2):'')+_0xa578b0(0x1e6);}_0x57bd0d=_0xa8a8fc[_0xa578b0(0x229)]+_0xa8a8fc[_0xa578b0(0x25d)],_0x1c60d1+=_0xa578b0(0x280)+formatNumber(parseFloat(_0xa8a8fc[_0xa578b0(0x195)],0x2)[_0xa578b0(0x26e)](0x2))+_0xa578b0(0x1e6),_0x1c60d1+=_0xa578b0(0x280)+formatNumber(_0xa8a8fc[_0xa578b0(0x1d3)][_0xa578b0(0x26e)](0x2))+_0xa578b0(0x1e6),_0x1c60d1+=_0xa578b0(0x280)+formatNumber(_0x57bd0d)+'</td>',_0x1c60d1+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xa8a8fc[_0xa578b0(0x12e)][_0xa578b0(0x26e)](0x2))+_0xa578b0(0x1e6),_0x1c60d1+=_0xa578b0(0x13c),_0x4bef50+=parseFloat(_0xa8a8fc['totalQty']['toFixed'](0x2)),_0x3b63dd+=parseFloat(_0xa8a8fc[_0xa578b0(0x12e)][_0xa578b0(0x26e)](0x2)),_0x24b55b+=_0x57bd0d,_0x400c4f+=parseFloat(_0xa8a8fc[_0xa578b0(0x1d3)][_0xa578b0(0x26e)](0x2));if(_0x10effd==_0x769f25[_0xa578b0(0x1c6)]-0x1){_0x1c60d1+=_0xa578b0(0x197),_0x1c60d1+=_0xa578b0(0x11d),_0x1c60d1+=_0xa578b0(0x1e6);for(let _0x670ce9=0x0;_0x670ce9<=_0x4e1df8['cat_brand'][_0xa578b0(0x1c6)]-0x1;_0x670ce9++){const _0x26ad12=_0x4e1df8[_0xa578b0(0x254)][_0x670ce9],_0x3cd8a7=_0x26ad12[_0xa578b0(0x129)]['brand']+'-'+_0x26ad12['_id']['category'],_0x1baf42=_0x1e2233[_0x3cd8a7][_0xa578b0(0x16c)]((_0x4cd050,_0x4f7171)=>_0x4cd050+_0x4f7171,0x0);_0x1c60d1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x1baf42!==undefined?formatNumber(_0x1baf42[_0xa578b0(0x26e)](0x2)):'')+_0xa578b0(0x1fe),console[_0xa578b0(0x1d7)](_0x1e2233[_0x3cd8a7]['reduce']((_0x3f42a,_0x4e03e8)=>_0x3f42a+_0x4e03e8,0x0));}_0x1c60d1+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4bef50[_0xa578b0(0x26e)](0x2))+'</b></td>',_0x1c60d1+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x400c4f)+_0xa578b0(0x1fe),_0x1c60d1+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x24b55b)+'</b></td>',_0x1c60d1+=_0xa578b0(0x275)+formatNumber(_0x3b63dd)+_0xa578b0(0x1fe),_0x1c60d1+='</tr>';}_0x132808[_0xa578b0(0x1e5)](_0x1c60d1);}function _0x53a4bc(_0x3b5898,_0x170510){const _0x8c4674=_0xa578b0,_0x998833=[];for(let _0x2d4c5e=0x0;_0x2d4c5e<=_0x3b5898[_0x8c4674(0x1c6)]-0x1;_0x2d4c5e+=_0x170510){_0x998833['push'](_0x3b5898[_0x8c4674(0x277)](_0x2d4c5e,_0x2d4c5e+_0x170510));}return _0x998833;}const _0x3783b5=_0x53a4bc(_0x132808,_0x36c3a3);let _0x2ef075='';return _0x3783b5['forEach']((_0x55afc4,_0x2c4f02)=>{const _0x18c751=_0xa578b0;_0x2c4f02>0x0&&(_0x2ef075+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x2ef075+=_0x18c751(0x25f),_0x2ef075+=_0x18c751(0x236),_0x2ef075+=_0x18c751(0x197),_0x2ef075+=_0x18c751(0x23c),_0x2ef075+='</tr>',_0x2ef075+=_0x18c751(0x197),_0x2ef075+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x3fad8d=0x0;_0x3fad8d<=_0x225b73[_0x18c751(0x1c6)]-0x1;_0x3fad8d++){const _0x58c994=_0x225b73[_0x3fad8d];for(let _0x20cf86=0x0;_0x20cf86<_0x1778a4[_0x18c751(0x1c6)];_0x20cf86++){const _0x24af6b=_0x1778a4[_0x20cf86];_0x24af6b[_0x18c751(0x129)]===_0x58c994[_0x18c751(0x129)]['category']&&(_0x2ef075+=_0x18c751(0x1ad)+_0x24af6b[_0x18c751(0x16b)]+_0x18c751(0x283)+_0x58c994[_0x18c751(0x129)]['category']+_0x18c751(0x1e6));}}_0x2ef075+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x2ef075+=_0x18c751(0x13c),_0x2ef075+=_0x18c751(0x197),_0x2ef075+=_0x18c751(0x155),_0x2ef075+=_0x18c751(0x279),_0x2ef075+=_0x18c751(0x257);for(let _0x4994ac=0x0;_0x4994ac<=_0x225b73[_0x18c751(0x1c6)]-0x1;_0x4994ac++){const _0x4edbfe=_0x225b73[_0x4994ac];for(let _0x20f5fd=0x0;_0x20f5fd<_0x4e1df8[_0x18c751(0x254)][_0x18c751(0x1c6)];_0x20f5fd++){const _0x21966b=_0x4e1df8['cat_brand'][_0x20f5fd];_0x21966b[_0x18c751(0x129)]['category']===_0x4edbfe[_0x18c751(0x129)][_0x18c751(0x22d)]&&(_0x2ef075+=_0x18c751(0x285)+_0x21966b[_0x18c751(0x129)][_0x18c751(0x16e)]+_0x18c751(0x1e6));}}_0x2ef075+=_0x18c751(0x21c),_0x2ef075+=_0x18c751(0x18e),_0x2ef075+=_0x18c751(0x1f0),_0x2ef075+=_0x18c751(0x159),_0x2ef075+=_0x18c751(0x13c),_0x2ef075+='</thead>',_0x2ef075+='<tbody>',_0x55afc4[_0x18c751(0x289)](_0x1e127c=>{_0x2ef075+=_0x1e127c;}),console[_0x18c751(0x1d7)](_0x1e2233),_0x2ef075+=_0x18c751(0x206),_0x2ef075+=_0x18c751(0x154);}),_0x2ef075;}function a0_0x3c7e(_0x1cb96e,_0x52343b){const _0x161a99=a0_0x161a();return a0_0x3c7e=function(_0x3c7e3a,_0xadce29){_0x3c7e3a=_0x3c7e3a-0x108;let _0x37c839=_0x161a99[_0x3c7e3a];return _0x37c839;},a0_0x3c7e(_0x1cb96e,_0x52343b);}router[a0_0x4b16db(0x225)](a0_0x4b16db(0x115),auth,async(_0x4aac55,_0x6b7535)=>{const _0x3d194d=a0_0x4b16db,{from_date:_0x120ae5,to_date:_0x2b7f7f,isExcel:_0x5dd79e}=_0x4aac55['body'],_0x2f4e28=_0x4aac55[_0x3d194d(0x10d)],_0xd669f3=await staff[_0x3d194d(0x261)]({'email':_0x2f4e28[_0x3d194d(0x194)]}),_0x512308=await master_shop['find']();console[_0x3d194d(0x1d7)](_0x512308[0x0][_0x3d194d(0x25b)]);const _0x2aadee=await agentsdataDSICheck(_0x120ae5,_0x2b7f7f,_0xd669f3['_id'][_0x3d194d(0x1c3)](),_0x5dd79e),_0x278f6f=await agentsdataDSICheck_excel(_0x120ae5,_0x2b7f7f,_0xd669f3[_0x3d194d(0x129)]['valueOf'](),_0x5dd79e);let _0x4232b7='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x1a4be5=new Date(_0x120ae5),_0xb32a4d=new Date(_0x2b7f7f);const _0x3748ab={'year':_0x3d194d(0x234),'month':'long','day':'numeric'},_0xa534bf=new Intl['DateTimeFormat'](_0x3d194d(0x17d),_0x3748ab)[_0x3d194d(0x213)](_0x1a4be5),_0x506b70=new Intl[(_0x3d194d(0x221))]('en-US',_0x3748ab)['format'](_0xb32a4d);_0x4232b7+=_0x3d194d(0x173),_0x4232b7+='<div\x20\x20id=\x22table-conatainer\x22>',_0x4232b7+=_0x3d194d(0x25f),_0x4232b7+=_0x2aadee,_0x4232b7+='</table>',_0x4232b7+=_0x3d194d(0x10e),_0x4232b7+=_0x3d194d(0x10e);let _0x502097=_0x3d194d(0x163);_0x502097+='<div\x20class=\x22row\x22>',_0x502097+=_0x3d194d(0x21f),_0x502097+=_0x3d194d(0x25f),_0x502097+=_0x278f6f,_0x502097+='</table>',_0x502097+=_0x3d194d(0x10e),_0x502097+=_0x3d194d(0x10e);let _0x146aeb=_0x3d194d(0x22f);const _0x4d21b8={'width':_0x3d194d(0x13b),'height':'8.5in','orientation':_0x3d194d(0x142),'border':{'top':_0x3d194d(0x255),'right':_0x3d194d(0x255),'bottom':_0x3d194d(0x255),'left':'0.1in'},'header':{'height':_0x3d194d(0x287),'contents':_0x3d194d(0x150)+_0x146aeb+_0x3d194d(0x211)+_0xa534bf+_0x3d194d(0x180)+_0x506b70+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x3d194d(0x108),'contents':{'default':_0x3d194d(0x24c)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3d194d(0x138)}}};if(_0x5dd79e=='on'){const _0x9d1bd4=cheerio[_0x3d194d(0x281)](_0x502097);let _0x35e815=[],_0x1d2e0a=[],_0x3e246e=[];const _0x485362=_0x253236=>{const _0xb6b815=_0x3d194d,_0x365331={'top':{'style':_0xb6b815(0x111),'color':{'rgb':'000000'}},'bottom':{'style':_0xb6b815(0x111),'color':{'rgb':_0xb6b815(0x19d)}},'left':{'style':_0xb6b815(0x111),'color':{'rgb':_0xb6b815(0x19d)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x253236){const _0x3ed140=_0x253236[_0xb6b815(0x21b)](';')[_0xb6b815(0x16c)]((_0x551beb,_0x56bca6)=>{const _0x4acb05=_0xb6b815,[_0x1d1be4,_0x1f30ef]=_0x56bca6[_0x4acb05(0x21b)](':')[_0x4acb05(0x243)](_0x49a149=>_0x49a149[_0x4acb05(0x125)]());return _0x551beb[_0x1d1be4]=_0x1f30ef,_0x551beb;},{});_0x3ed140[_0xb6b815(0x167)]&&(_0x365331['top'][_0xb6b815(0x1d2)]=_0x3ed140[_0xb6b815(0x167)][_0xb6b815(0x1ba)](_0xb6b815(0x224))?_0xb6b815(0x224):_0xb6b815(0x1c0)),_0x3ed140[_0xb6b815(0x200)]&&(_0x365331[_0xb6b815(0x21d)][_0xb6b815(0x1d2)]=_0x3ed140['border-bottom'][_0xb6b815(0x1ba)]('thin')?_0xb6b815(0x224):_0xb6b815(0x1c0)),_0x3ed140[_0xb6b815(0x212)]&&(_0x365331[_0xb6b815(0x162)][_0xb6b815(0x1d2)]=_0x3ed140[_0xb6b815(0x212)][_0xb6b815(0x1ba)](_0xb6b815(0x224))?'thin':_0xb6b815(0x1c0)),_0x3ed140[_0xb6b815(0x1ce)]&&(_0x365331[_0xb6b815(0x216)][_0xb6b815(0x1d2)]=_0x3ed140['border-right'][_0xb6b815(0x1ba)]('thin')?'thin':_0xb6b815(0x1c0));}return _0x365331;};_0x9d1bd4(_0x3d194d(0x17c))['each']((_0x4b2225,_0x45f759)=>{const _0x33f63b=_0x3d194d;let _0x3a09e3=[],_0x3d6775=0x0;while(_0x3e246e[_0x3d6775]){_0x3e246e[_0x3d6775]--,_0x3d6775++;}_0x9d1bd4(_0x45f759)[_0x33f63b(0x288)]('td,\x20th')['each']((_0x5a1791,_0x4177f8)=>{const _0x1a9982=_0x33f63b;let _0x508c86=_0x9d1bd4(_0x4177f8)[_0x1a9982(0x1ab)]()[_0x1a9982(0x125)](),_0x38b1d1=parseFloat(_0x508c86[_0x1a9982(0x1a8)](/,/g,'')),_0x2dd419={};!isNaN(_0x38b1d1)?(_0x2dd419['v']=_0x38b1d1,_0x2dd419['t']='n'):(_0x2dd419['v']=_0x508c86,_0x2dd419['t']='s');const _0x5cecf8=_0x9d1bd4(_0x4177f8)[_0x1a9982(0x1f4)](_0x1a9982(0x1d2)),_0x3ae3a7=_0x485362(_0x5cecf8);_0x2dd419['s']={'border':_0x3ae3a7},_0x3a09e3[_0x3d6775]=_0x2dd419;let _0x139855=parseInt(_0x9d1bd4(_0x4177f8)[_0x1a9982(0x1f4)](_0x1a9982(0x1f2)))||0x1,_0x521ea2=parseInt(_0x9d1bd4(_0x4177f8)['attr'](_0x1a9982(0x18c)))||0x1;(_0x139855>0x1||_0x521ea2>0x1)&&_0x1d2e0a['push']({'s':{'r':_0x4b2225,'c':_0x3d6775},'e':{'r':_0x4b2225+_0x521ea2-0x1,'c':_0x3d6775+_0x139855-0x1}});for(let _0x3e0e0c=0x0;_0x3e0e0c<_0x139855;_0x3e0e0c++){_0x521ea2>0x1&&(_0x3e246e[_0x3d6775+_0x3e0e0c]=_0x521ea2-0x1);}_0x3d6775+=_0x139855;}),_0x35e815[_0x33f63b(0x1e5)](_0x3a09e3);});const _0x4901e7=XLSX[_0x3d194d(0x256)][_0x3d194d(0x1be)](),_0x5af5a1=XLSX[_0x3d194d(0x256)][_0x3d194d(0x183)](_0x35e815);_0x1d2e0a[_0x3d194d(0x1c6)]>0x0&&(_0x5af5a1[_0x3d194d(0x282)]=_0x1d2e0a);_0x5af5a1['!cols']=_0x35e815[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x3d194d(0x17e)](_0x4901e7,_0x5af5a1,_0x3d194d(0x207));const _0x432bc6=XLSX[_0x3d194d(0x1fb)](_0x4901e7,{'bookType':_0x3d194d(0x11a),'type':'buffer'});_0x6b7535[_0x3d194d(0x190)](_0x3d194d(0x199),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x6b7535[_0x3d194d(0x190)]('Content-Type',_0x3d194d(0x10b)),_0x6b7535['send'](_0x432bc6);}else pdf[_0x3d194d(0x27d)](_0x4232b7,_0x4d21b8)[_0x3d194d(0x28a)](function(_0x1147e4,_0x5a696c){const _0x3df6fe=_0x3d194d;if(_0x1147e4){console[_0x3df6fe(0x1bf)](_0x3df6fe(0x1a3),_0x1147e4),_0x6b7535[_0x3df6fe(0x27a)](0x1f4)['send']('Error\x20generating\x20PDF'+_0x1147e4);return;}_0x6b7535[_0x3df6fe(0x190)]('Content-Type',_0x3df6fe(0x202)),_0x5a696c[_0x3df6fe(0x141)](_0x6b7535);});}),router[a0_0x4b16db(0x209)]('/total_sales_reports/view',auth,async(_0x1884a5,_0x448a8b)=>{const _0x476461=a0_0x4b16db;try{const {username:_0x59ca78,email:_0xe829c,role:_0x537394}=_0x1884a5[_0x476461(0x10d)],_0x51f862=_0x1884a5['user'],_0x57029c=await profile[_0x476461(0x261)]({'email':_0x51f862[_0x476461(0x194)]}),_0x52e26a={'year':_0x476461(0x234),'month':_0x476461(0x1e8),'day':_0x476461(0x234)},_0x3a2775=await master_shop[_0x476461(0x288)](),_0x55dbdf=await product['find'](),_0x40660b=await warehouse[_0x476461(0x240)]([{'$unwind':_0x476461(0x1b7)},{'$lookup':{'from':_0x476461(0x117),'localField':_0x476461(0x266),'foreignField':'name','as':_0x476461(0x1a7)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x476461(0x269),'product_stock':_0x476461(0x157)}},{'$group':{'_id':_0x476461(0x27e),'product_stock':{'$sum':'$product_stock'}}}]),_0x295bf2=await staff['findOne']({'email':_0x51f862[_0x476461(0x194)]});if(_0x3a2775[0x0]['language']=='English\x20(US)')var _0x592872=users[_0x476461(0x12b)];else{if(_0x3a2775[0x0][_0x476461(0x1df)]==_0x476461(0x171))var _0x592872=users[_0x476461(0x171)];else{if(_0x3a2775[0x0][_0x476461(0x1df)]=='German')var _0x592872=users[_0x476461(0x12a)];else{if(_0x3a2775[0x0][_0x476461(0x1df)]==_0x476461(0x13f))var _0x592872=users['Spanish'];else{if(_0x3a2775[0x0][_0x476461(0x1df)]==_0x476461(0x122))var _0x592872=users[_0x476461(0x122)];else{if(_0x3a2775[0x0]['language']=='Portuguese\x20(BR)')var _0x592872=users[_0x476461(0x1a5)];else{if(_0x3a2775[0x0][_0x476461(0x1df)]==_0x476461(0x1fa))var _0x592872=users[_0x476461(0x1fa)];else{if(_0x3a2775[0x0][_0x476461(0x1df)]==_0x476461(0x145))var _0x592872=users[_0x476461(0x273)];}}}}}}}_0x448a8b[_0x476461(0x123)](_0x476461(0x25e),{'success':_0x1884a5[_0x476461(0x252)](_0x476461(0x1c8)),'errors':_0x1884a5[_0x476461(0x252)](_0x476461(0x22c)),'alldata':_0x55dbdf,'profile':_0x57029c,'master_shop':_0x3a2775,'role':_0x51f862,'product_stock':_0x40660b,'language':_0x592872,'staff_arr':_0x295bf2});}catch(_0x4f2bec){}});async function dataSalesReports(_0x413eb2,_0x408dbb,_0x2f45a5){const _0x18533a=a0_0x4b16db;let _0x1589ce='';const _0x139d85=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x413eb2,'$lte':_0x408dbb},'sales_staff_id':_0x2f45a5}},{'$unwind':_0x18533a(0x1bc)},{'$match':{'sale_product.isFG':'false'}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x263bf6=0x0,_0x23f004=0x0;for(let _0x155ecc=0x0;_0x155ecc<=_0x139d85[_0x18533a(0x1c6)]-0x1;_0x155ecc++){const _0x49cda1=_0x139d85[_0x155ecc];var _0x4789b8=_0x49cda1[_0x18533a(0x23a)][_0x18533a(0x15e)](undefined),_0x35123a=_0x49cda1[_0x18533a(0x27f)][_0x18533a(0x15e)](undefined);_0x1589ce+=_0x18533a(0x197),_0x1589ce+=_0x18533a(0x179)+_0x49cda1['_id'][_0x18533a(0x25c)]+'</td>',_0x1589ce+=_0x18533a(0x179)+_0x49cda1[_0x18533a(0x129)][_0x18533a(0x21e)]+_0x18533a(0x1e6),_0x1589ce+=_0x18533a(0x179)+formatNumber(_0x49cda1[_0x18533a(0x27f)]['toFixed'](0x2))+_0x18533a(0x1e6),_0x1589ce+=_0x18533a(0x179)+formatNumber(_0x49cda1[_0x18533a(0x23a)][_0x18533a(0x26e)](0x2))+_0x18533a(0x1e6),_0x1589ce+='</tr>',_0x263bf6+=parseFloat(_0x49cda1[_0x18533a(0x27f)]),_0x23f004+=parseFloat(_0x49cda1[_0x18533a(0x23a)]);}var _0x44735a=_0x23f004[_0x18533a(0x15e)](undefined),_0x38eed7=_0x263bf6['toLocaleString'](undefined);return _0x1589ce+='<tr>',_0x1589ce+='<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>',_0x1589ce+=_0x18533a(0x259)+formatNumber(_0x263bf6[_0x18533a(0x26e)](0x2))+_0x18533a(0x1fe),_0x1589ce+=_0x18533a(0x259)+formatNumber(_0x23f004[_0x18533a(0x26e)](0x2))+'</b></td>',_0x1589ce+='</tr>',_0x1589ce;}router[a0_0x4b16db(0x225)]('/total_sales_reports/pdf',auth,async(_0x526a95,_0x13f7de)=>{const _0xf41744=a0_0x4b16db;try{const {from_date:_0x6a45e4,to_date:_0x469784,isExcel:_0x3eabc9}=_0x526a95[_0xf41744(0x15c)],_0x3ec308=_0x526a95['user'],_0x133d25=await staff[_0xf41744(0x261)]({'email':_0x3ec308[_0xf41744(0x194)]});let _0x43d134=_0xf41744(0x27b);var _0x1069c2=new Date(_0x6a45e4),_0x10e9f7=new Date(_0x469784);const _0x19ae7f={'year':_0xf41744(0x234),'month':_0xf41744(0x1e8),'day':'numeric'},_0x41b5a5=new Intl['DateTimeFormat']('en-US',_0x19ae7f)[_0xf41744(0x213)](_0x1069c2),_0x1a0943=new Intl[(_0xf41744(0x221))]('en-US',_0x19ae7f)[_0xf41744(0x213)](_0x10e9f7);var _0x35c38f=await dataSalesReports(_0x6a45e4,_0x469784,_0x133d25[_0xf41744(0x129)][_0xf41744(0x1c3)]());_0x43d134+=_0xf41744(0x173),_0x43d134+=_0xf41744(0x13e),_0x43d134+='<table>',_0x43d134+=_0xf41744(0x197),_0x43d134+='<th>\x20ITEM\x20CODE\x20</th>',_0x43d134+=_0xf41744(0x11b),_0x43d134+=_0xf41744(0x1b1),_0x43d134+=_0xf41744(0x264),_0x43d134+='<tr>',_0x43d134+=_0x35c38f,_0x43d134+=_0xf41744(0x13c),_0x43d134+=_0xf41744(0x10e),_0x43d134+='</div>';let _0x40c352=_0xf41744(0x22f);const _0x6fea6e={'width':_0xf41744(0x13b),'height':_0xf41744(0x214),'orientation':_0xf41744(0x142),'border':{'top':_0xf41744(0x255),'right':_0xf41744(0x255),'bottom':_0xf41744(0x255),'left':_0xf41744(0x255)},'header':{'height':_0xf41744(0x287),'contents':_0xf41744(0x150)+_0x40c352+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x133d25[_0xf41744(0x18f)]+_0xf41744(0x208)+_0x41b5a5+_0xf41744(0x180)+_0x1a0943+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0xf41744(0x108),'contents':{'default':_0xf41744(0x24c)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0xf41744(0x138)}}};if(_0x3eabc9=='on'){const _0x21310d=cheerio[_0xf41744(0x281)](_0x43d134);let _0x543f54=[],_0x6bce6=[],_0x57073d=[];const _0x5239c8=_0x2694d7=>{const _0x4e5cf1=_0xf41744,_0x46edfc={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0x4e5cf1(0x111),'color':{'rgb':'000000'}},'left':{'style':'thick','color':{'rgb':_0x4e5cf1(0x19d)}},'right':{'style':'thick','color':{'rgb':_0x4e5cf1(0x19d)}}};if(_0x2694d7){const _0x1171de=_0x2694d7['split'](';')[_0x4e5cf1(0x16c)]((_0x5dc13c,_0x2a6737)=>{const _0x4ff86a=_0x4e5cf1,[_0xddc077,_0x2053ae]=_0x2a6737[_0x4ff86a(0x21b)](':')[_0x4ff86a(0x243)](_0x433a02=>_0x433a02['trim']());return _0x5dc13c[_0xddc077]=_0x2053ae,_0x5dc13c;},{});_0x1171de['border-top']&&(_0x46edfc['top'][_0x4e5cf1(0x1d2)]=_0x1171de[_0x4e5cf1(0x167)][_0x4e5cf1(0x1ba)]('thin')?_0x4e5cf1(0x224):_0x4e5cf1(0x1c0)),_0x1171de[_0x4e5cf1(0x200)]&&(_0x46edfc[_0x4e5cf1(0x21d)][_0x4e5cf1(0x1d2)]=_0x1171de[_0x4e5cf1(0x200)][_0x4e5cf1(0x1ba)](_0x4e5cf1(0x224))?_0x4e5cf1(0x224):_0x4e5cf1(0x1c0)),_0x1171de[_0x4e5cf1(0x212)]&&(_0x46edfc[_0x4e5cf1(0x162)][_0x4e5cf1(0x1d2)]=_0x1171de[_0x4e5cf1(0x212)][_0x4e5cf1(0x1ba)](_0x4e5cf1(0x224))?_0x4e5cf1(0x224):_0x4e5cf1(0x1c0)),_0x1171de[_0x4e5cf1(0x1ce)]&&(_0x46edfc['right'][_0x4e5cf1(0x1d2)]=_0x1171de[_0x4e5cf1(0x1ce)][_0x4e5cf1(0x1ba)](_0x4e5cf1(0x224))?'thin':_0x4e5cf1(0x1c0));}return _0x46edfc;};_0x21310d('table\x20tr')['each']((_0x5a697e,_0x5dcd38)=>{const _0x3d9096=_0xf41744;let _0x5b4f52=[],_0x247f97=0x0;while(_0x57073d[_0x247f97]){_0x57073d[_0x247f97]--,_0x247f97++;}_0x21310d(_0x5dcd38)['find'](_0x3d9096(0x153))['each']((_0x1e956e,_0x48d674)=>{const _0x3ef179=_0x3d9096;let _0x4075f6=_0x21310d(_0x48d674)['text']()[_0x3ef179(0x125)](),_0x455789=parseFloat(_0x4075f6[_0x3ef179(0x1a8)](/,/g,'')),_0xe68823={};!isNaN(_0x455789)?(_0xe68823['v']=_0x455789,_0xe68823['t']='n'):(_0xe68823['v']=_0x4075f6,_0xe68823['t']='s');const _0x1eb3ba=_0x21310d(_0x48d674)[_0x3ef179(0x1f4)](_0x3ef179(0x1d2)),_0xe07b79=_0x5239c8(_0x1eb3ba);_0xe68823['s']={'border':_0xe07b79},_0x5b4f52[_0x247f97]=_0xe68823;let _0x1d9e40=parseInt(_0x21310d(_0x48d674)['attr']('colspan'))||0x1,_0x3edc51=parseInt(_0x21310d(_0x48d674)[_0x3ef179(0x1f4)](_0x3ef179(0x18c)))||0x1;(_0x1d9e40>0x1||_0x3edc51>0x1)&&_0x6bce6[_0x3ef179(0x1e5)]({'s':{'r':_0x5a697e,'c':_0x247f97},'e':{'r':_0x5a697e+_0x3edc51-0x1,'c':_0x247f97+_0x1d9e40-0x1}});for(let _0x5a1f07=0x0;_0x5a1f07<_0x1d9e40;_0x5a1f07++){_0x3edc51>0x1&&(_0x57073d[_0x247f97+_0x5a1f07]=_0x3edc51-0x1);}_0x247f97+=_0x1d9e40;}),_0x543f54[_0x3d9096(0x1e5)](_0x5b4f52);});const _0x4f5781=XLSX[_0xf41744(0x256)][_0xf41744(0x1be)](),_0x3e468b=XLSX[_0xf41744(0x256)][_0xf41744(0x183)](_0x543f54);_0x6bce6[_0xf41744(0x1c6)]>0x0&&(_0x3e468b[_0xf41744(0x282)]=_0x6bce6);_0x3e468b['!cols']=_0x543f54[0x0][_0xf41744(0x243)](()=>({'wpx':0x64})),XLSX[_0xf41744(0x256)][_0xf41744(0x17e)](_0x4f5781,_0x3e468b,'Sales\x20Report');const _0x31d8ae=XLSX[_0xf41744(0x1fb)](_0x4f5781,{'bookType':_0xf41744(0x11a),'type':_0xf41744(0x112)});_0x13f7de[_0xf41744(0x190)](_0xf41744(0x199),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x13f7de['setHeader']('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x13f7de[_0xf41744(0x1ac)](_0x31d8ae);}else pdf[_0xf41744(0x27d)](_0x43d134,_0x6fea6e)[_0xf41744(0x28a)](function(_0x4a1001,_0x55b1bb){const _0x35ce28=_0xf41744;if(_0x4a1001){_0x13f7de[_0x35ce28(0x27a)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x13f7de[_0x35ce28(0x190)]('Content-Type',_0x35ce28(0x202)),_0x55b1bb[_0x35ce28(0x141)](_0x13f7de);});}catch(_0x52f40b){}}),router[a0_0x4b16db(0x209)](a0_0x4b16db(0x228),auth,async(_0x346a34,_0x12f6ab)=>{const _0x4d652b=a0_0x4b16db;try{const {username:_0x2de12d,email:_0x3eae70,role:_0x26a201}=_0x346a34[_0x4d652b(0x10d)],_0x2b04d5=_0x346a34['user'],_0x44a676=await profile[_0x4d652b(0x261)]({'email':_0x2b04d5[_0x4d652b(0x194)]}),_0x32177e={'year':_0x4d652b(0x234),'month':_0x4d652b(0x1e8),'day':_0x4d652b(0x234)},_0x198317=await master_shop[_0x4d652b(0x288)](),_0x24c015=await product[_0x4d652b(0x288)](),_0x1af874=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x4d652b(0x117),'localField':'product_details.product_name','foreignField':_0x4d652b(0x18f),'as':_0x4d652b(0x1a7)}},{'$unwind':_0x4d652b(0x16f)},{'$project':{'product_name':_0x4d652b(0x269),'product_stock':_0x4d652b(0x157)}},{'$group':{'_id':_0x4d652b(0x27e),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x198317[0x0][_0x4d652b(0x1df)]==_0x4d652b(0x260))var _0x3717f6=users[_0x4d652b(0x12b)];else{if(_0x198317[0x0][_0x4d652b(0x1df)]==_0x4d652b(0x171))var _0x3717f6=users[_0x4d652b(0x171)];else{if(_0x198317[0x0][_0x4d652b(0x1df)]==_0x4d652b(0x12a))var _0x3717f6=users[_0x4d652b(0x12a)];else{if(_0x198317[0x0][_0x4d652b(0x1df)]==_0x4d652b(0x13f))var _0x3717f6=users[_0x4d652b(0x13f)];else{if(_0x198317[0x0][_0x4d652b(0x1df)]==_0x4d652b(0x122))var _0x3717f6=users[_0x4d652b(0x122)];else{if(_0x198317[0x0][_0x4d652b(0x1df)]==_0x4d652b(0x14c))var _0x3717f6=users[_0x4d652b(0x1a5)];else{if(_0x198317[0x0]['language']==_0x4d652b(0x1fa))var _0x3717f6=users[_0x4d652b(0x1fa)];else{if(_0x198317[0x0][_0x4d652b(0x1df)]==_0x4d652b(0x145))var _0x3717f6=users[_0x4d652b(0x273)];}}}}}}}_0x12f6ab[_0x4d652b(0x123)](_0x4d652b(0x1ff),{'success':_0x346a34['flash']('success'),'errors':_0x346a34['flash'](_0x4d652b(0x22c)),'alldata':_0x24c015,'profile':_0x44a676,'master_shop':_0x198317,'role':_0x2b04d5,'product_stock':_0x1af874,'language':_0x3717f6});}catch(_0x1a09f0){}});async function dataInventoryReports(_0x4d72eb,_0x3e57f1,_0x187fd2){const _0x504942=a0_0x4b16db,_0x7aa20d=await sales_sa[_0x504942(0x240)]([{'$match':{'date':{'$gte':_0x4d72eb,'$lte':_0x3e57f1},'sales_staff_id':_0x187fd2}},{'$unwind':_0x504942(0x1bc)},{'$group':{'_id':{'product_name':_0x504942(0x143),'product_code':_0x504942(0x189)},'sumqty':{'$sum':_0x504942(0x16d)}}},{'$sort':{'_id.product_name':0x1}}]),_0x26c30e=mongoose[_0x504942(0x144)][_0x504942(0x128)],_0x40dee9=await staff[_0x504942(0x240)]([{'$match':{'_id':_0x26c30e(_0x187fd2)}},{'$unwind':_0x504942(0x19f)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x504942(0x233),'product_code':_0x504942(0x239)},'sumqty':{'$sum':_0x504942(0x14e)}}},{'$sort':{'_id.product_name':0x1}}]),_0x519dd2=await sales_inv_data[_0x504942(0x240)]([{'$match':{'date':{'$gte':_0x4d72eb,'$lte':_0x3e57f1},'sales_staff_id':_0x187fd2}},{'$unwind':_0x504942(0x1bc)},{'$group':{'_id':{'product_name':_0x504942(0x143),'product_code':_0x504942(0x189)},'totalQTYsum':{'$sum':_0x504942(0x15d)}}}]);console[_0x504942(0x1d7)](_0x519dd2);let _0xb26394='';var _0x333f4a=0x0;for(let _0x102d2b=0x0;_0x102d2b<=_0x40dee9[_0x504942(0x1c6)]-0x1;_0x102d2b++){const _0x3a667e=_0x40dee9[_0x102d2b];_0xb26394+=_0x504942(0x197),_0xb26394+=_0x504942(0x1eb)+_0x3a667e[_0x504942(0x129)]['product_code']+_0x504942(0x1e6),_0xb26394+=_0x504942(0x132)+_0x3a667e[_0x504942(0x129)][_0x504942(0x21e)]+_0x504942(0x1e6);var _0x593d67=_0x3a667e[_0x504942(0x27f)],_0x4f8a26=0x0;for(let _0x575b16=0x0;_0x575b16<=_0x7aa20d[_0x504942(0x1c6)]-0x1;_0x575b16++){const _0x2607fe=_0x7aa20d[_0x575b16];_0x3a667e[_0x504942(0x129)][_0x504942(0x25c)]==_0x2607fe[_0x504942(0x129)]['product_code']&&_0x3a667e[_0x504942(0x129)][_0x504942(0x21e)]==_0x2607fe[_0x504942(0x129)]['product_name']&&(_0x4f8a26=_0x2607fe['sumqty']);}var _0x205ecb=0x0;for(let _0x25ef75=0x0;_0x25ef75<=_0x519dd2[_0x504942(0x1c6)]-0x1;_0x25ef75++){const _0x53e11b=_0x519dd2[_0x25ef75];_0x3a667e[_0x504942(0x129)][_0x504942(0x25c)]==_0x53e11b[_0x504942(0x129)][_0x504942(0x25c)]&&_0x3a667e[_0x504942(0x129)][_0x504942(0x21e)]==_0x53e11b['_id'][_0x504942(0x21e)]&&(_0x205ecb=_0x53e11b[_0x504942(0x244)]);}_0x333f4a=_0x593d67-_0x205ecb+_0x4f8a26,_0xb26394+='<td\x20class=\x22row_data\x22>'+_0x333f4a+_0x504942(0x1e6);let _0x3a2208=![];for(let _0x20246c=0x0;_0x20246c<=_0x519dd2[_0x504942(0x1c6)]-0x1;_0x20246c++){const _0x57ecb6=_0x519dd2[_0x20246c];if(_0x3a667e[_0x504942(0x129)][_0x504942(0x25c)]==_0x57ecb6[_0x504942(0x129)]['product_code']&&_0x3a667e[_0x504942(0x129)][_0x504942(0x21e)]==_0x57ecb6[_0x504942(0x129)]['product_name']){_0xb26394+=_0x504942(0x179)+_0x57ecb6[_0x504942(0x244)]+_0x504942(0x1e6),_0x3a2208=!![];break;}}!_0x3a2208&&(_0xb26394+='<td\x20class=\x22row_data\x22>0</td>');let _0xe95ecb=![];for(let _0x5c6ade=0x0;_0x5c6ade<=_0x7aa20d[_0x504942(0x1c6)]-0x1;_0x5c6ade++){const _0x4f169e=_0x7aa20d[_0x5c6ade];if(_0x3a667e[_0x504942(0x129)][_0x504942(0x25c)]==_0x4f169e[_0x504942(0x129)][_0x504942(0x25c)]&&_0x3a667e[_0x504942(0x129)][_0x504942(0x21e)]==_0x4f169e[_0x504942(0x129)][_0x504942(0x21e)]){_0xb26394+=_0x504942(0x179)+_0x4f169e[_0x504942(0x27f)]+_0x504942(0x1e6),_0xe95ecb=!![];break;}}!_0xe95ecb&&(_0xb26394+='<td\x20class=\x22row_data\x22>0</td>'),_0xb26394+=_0x504942(0x179)+_0x3a667e['sumqty']+_0x504942(0x1e6),_0xb26394+=_0x504942(0x13c);}return _0xb26394;}function a0_0x161a(){const _0x6a50b1=['</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','get','$sale_product.prod_cat','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','$product_info','/balance/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','border-left','format','8.5in','$product_info.gross_price','right','/reports/dsrr/view','toLocaleDateString','</script>','$products.product_details.prod_id','split','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','bottom','product_name','<div\x20\x20id=\x22table-conatainer\x22>','/agent_reports/view','DateTimeFormat','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','dataqty','thin','post','$sale_product.isFG','catch','/inventory_sum/view','discount','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','errors','category','<td\x20class=\x22cat_data\x22><b>FG</b></td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','5193749IiyYHf','4986306zSCOYf','\x20-\x20STD','$product_list.product_name','numeric','$products.product_details.category','<thead>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','customer','$product_list.product_code','totalPrice','each','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','date','$sale_product.discount','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','aggregate','<th>\x20ITEM\x20CODE\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','map','totalQTYsum','deleteOne','attachment;\x20filename=\x22sales_report.xlsx\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','json','path','stock','$customer','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','298594DAfNqu','NumberFormat','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','product_info','flash','$adj_discount','cat_brand','0.1in','utils','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','$sales_info','<td\x20class=\x22row_data\x22><b>','dsi_sales','image','product_code','adj_discount','sales_reports','<table>','English\x20(US)','findOne','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','$cash','<th>\x20INVOICE\x20AMOUNT\x20</th>','<tbody>','product_details.product_name','10ysIdVE','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','$product_details.product_name','qty','product_stock','$product.quantity','$sale_product._id','toFixed','html-pdf','$totalQty','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','$products.product_details.gross_price','Arabic','express/lib/response','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$NetPrice','slice','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','status','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','/inventory_sum/pdf','create','$product_name','sumqty','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','load','!merges','\x22\x20class=\x22cat_data\x22>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','<td\x20class=\x22cat_data\x22>','window.onload\x20=\x20function()\x20{','60mm','find','forEach','toStream','jsbarcode','$products.adj_discount','$sale_product.adj_discount','<div\x20style=\x22page-break-before:\x20always;\x22></div>','20mm','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','$totalGross','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','salesman_data','user','</div>','balanced','<h1>JAKA\x20EQUITIES\x20CORP</h1>','thick','buffer','</p>','Letter','/agent_reports/pdf','<th\x20rowspan=\x272\x27>Production</th>','products','prod_cat','<p>','xlsx','<th>\x20ITEM\x20DESCRIPTION\x20</th>','getFullYear','<td\x20colspan=\x223\x22><b>TOTAL<b>','<th>\x20SALES\x20</th>','referenceNumber','4790000OlXmOB','../models/all_models','French','render','window.print();','trim','601536pTGmVk','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','ObjectId','_id','German','English','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','/agent_reports/pdf_admin','NetPrice','cheerio','/dsrr/view','sale_product.product_code','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','exports','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','sales_staff_id','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','/dev/null','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','$sales_staff_id','15in','</tr>','Asia/Manila','<div\x20class=\x22col-sm-11\x22>','Spanish','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','pipe','landscape','$sale_product.product_name','Types','Arabic\x20(ae)','canvas','Content-Type','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','findById','$product_info.product_code','$name','Portuguese\x20(BR)','$products.qty','$product_list.product_stock','Error\x20generating\x20PDF','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','beg_bal','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','td,\x20th','</table>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','due_date','$product_details.product_stock','</th>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','dsi','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','body','$sale_product.stock','toLocaleString','$date','<th>X-Truck</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','left','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','</thead>','pdfkit-table','border-top','$_id.status_data','<th>\x20BEG\x20BALANCE\x20</th>','$_id.dsi','brandCount','reduce','$sale_product.quantity','brand','$product_docs','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','Hindi','sales_info','<div\x20class=\x22row\x22>','date_include','sales_man_code','amount','<td\x20class=\x22cat_data\x22></td>','sales_ext','<td\x20class=\x22row_data\x22>','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','table\x20tr','en-US','book_append_sheet','$bank','\x20-\x20','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','aoa_to_sheet','$_id.customer','$_id.category','621652dVOVae','$sale_product.totalprice','$category','$sale_product.product_code','<th>Booking</th>','$brand','rowspan','7dtFXtP','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','name','setHeader','/agent/pdf','$product_info.name','Products\x20master','email','totalQty','excel','<tr>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','Content-Disposition','cash','$discount','$products.product_details.brand','000000','\x22><b></b></td>','$product_list','$sales_info.name','multer','mongoose','PDF\x20Generation\x20Error:','isArray','Portuguese','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','product_docs','replace','Products\x20find_data','$products','text','send','<td\x20colspan=\x22','$product_code','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','$_id.date','<th>\x20QTY\x20SOLD\x20</th>','attachment;\x20filename=\x22reports.xlsx\x22','$product.product_code','test','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','10UTEiXY','$product_details','$product.product_name','!cols','includes','product_details','$sale_product','note','book_new','error','medium','sales_bkg','html','valueOf','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','length','dsi_sales_admin','success','<th>\x20ENDING\x20BALANCE\x20</th>','/agent_reports/sales_ad','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','express','Standard','border-right','$product_info.category','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','337401plKlNA','style','totalGross','$_id.brand','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','\x22><b>','log','then','staffs','totalQTY','isFG','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','$sale_product.real_qty_unit_val','language','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','<script>','$amount','toISOString','<th\x20colspan=\x272\x27>SOLD</th>','push','</td>','$product_stock','long','$product_info.brand','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','$due_date','top','3hCwsGt','false','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','true','colspan','$dsi','attr','<p>INVENTORY\x20SUMMARY</p>','$products.discount','/dsrr/pdf','<p>FINISHED\x20GOODS\x20INVENTORY</p>','Products\x20warehouse_data','Chinese','write','$products.product_details','/agent/view','</b></td>','inventory_sum','border-bottom','dssr_view','application/pdf','$check_no','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','$products.NetPrice','</tbody>','Sales\x20Report'];a0_0x161a=function(){return _0x6a50b1;};return a0_0x161a();}router[a0_0x4b16db(0x225)](a0_0x4b16db(0x27c),auth,async(_0xd56fee,_0x82a269)=>{const _0x59f35f=a0_0x4b16db;try{const {from_date:_0x50581d,to_date:_0x124acd}=_0xd56fee[_0x59f35f(0x15c)],_0x52f58d=_0xd56fee[_0x59f35f(0x10d)],_0x593323=await staff[_0x59f35f(0x261)]({'email':_0x52f58d[_0x59f35f(0x194)]});let _0x422176=_0x59f35f(0x27b);var _0xd85c68=new Date(_0x50581d),_0x7a9ca5=new Date(_0x124acd);const _0x4cd493={'year':_0x59f35f(0x234),'month':_0x59f35f(0x1e8),'day':_0x59f35f(0x234)},_0x19169b=new Intl[(_0x59f35f(0x221))]('en-US',_0x4cd493)[_0x59f35f(0x213)](_0xd85c68),_0x2a142a=new Intl[(_0x59f35f(0x221))](_0x59f35f(0x17d),_0x4cd493)['format'](_0x7a9ca5);var _0x302896=await dataInventoryReports(_0x50581d,_0x124acd,_0x593323['_id'][_0x59f35f(0x1c3)]());_0x422176+=_0x59f35f(0x110),_0x422176+=_0x59f35f(0x1f5),_0x422176+=_0x59f35f(0x119)+_0x19169b+'\x20-\x20'+_0x2a142a+_0x59f35f(0x113),_0x422176+='<div\x20class=\x22row\x22>',_0x422176+=_0x59f35f(0x13e),_0x422176+=_0x59f35f(0x25f),_0x422176+=_0x59f35f(0x197),_0x422176+=_0x59f35f(0x241),_0x422176+=_0x59f35f(0x11b),_0x422176+=_0x59f35f(0x169),_0x422176+='<th>\x20INCOMING\x20</th>',_0x422176+=_0x59f35f(0x11e),_0x422176+=_0x59f35f(0x1c9),_0x422176+=_0x59f35f(0x197),_0x422176+=_0x302896,_0x422176+=_0x59f35f(0x13c),_0x422176+=_0x59f35f(0x10e),_0x422176+=_0x59f35f(0x10e);const _0x5e1818={'format':_0x59f35f(0x114),'orientation':_0x59f35f(0x142),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x59f35f(0x138)}}};pdf[_0x59f35f(0x27d)](_0x422176,_0x5e1818)[_0x59f35f(0x28a)](function(_0x21697e,_0x15a22d){const _0x49a447=_0x59f35f;if(_0x21697e){_0x82a269[_0x49a447(0x27a)](0x1f4)['send'](_0x49a447(0x14f));return;}_0x82a269['setHeader'](_0x49a447(0x147),_0x49a447(0x202)),_0x15a22d[_0x49a447(0x141)](_0x82a269);});}catch(_0x4518eb){}}),router[a0_0x4b16db(0x209)](a0_0x4b16db(0x130),auth,async(_0x1b0171,_0x1ec513)=>{const _0x48fb5d=a0_0x4b16db;try{const {username:_0x1f6e45,email:_0x539563,role:_0x357b97}=_0x1b0171[_0x48fb5d(0x10d)],_0xc730e6=_0x1b0171[_0x48fb5d(0x10d)],_0x162dfa=await profile['findOne']({'email':_0xc730e6['email']}),_0x41931c={'year':_0x48fb5d(0x234),'month':_0x48fb5d(0x1e8),'day':_0x48fb5d(0x234)},_0xf9630=await master_shop[_0x48fb5d(0x288)]();console[_0x48fb5d(0x1d7)](_0x48fb5d(0x193),_0xf9630);const _0x68fc7f=await product['find']();console[_0x48fb5d(0x1d7)](_0x48fb5d(0x1a9),_0x68fc7f);const _0x246a8a=await warehouse[_0x48fb5d(0x240)]([{'$unwind':_0x48fb5d(0x1b7)},{'$lookup':{'from':_0x48fb5d(0x117),'localField':_0x48fb5d(0x266),'foreignField':'name','as':_0x48fb5d(0x1a7)}},{'$unwind':_0x48fb5d(0x16f)},{'$project':{'product_name':_0x48fb5d(0x269),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x48fb5d(0x27e),'product_stock':{'$sum':_0x48fb5d(0x1e7)}}}]);console[_0x48fb5d(0x1d7)]('Products\x20warehouse_data',_0x246a8a),_0x246a8a[_0x48fb5d(0x289)](_0x32d385=>{const _0x2854b2=_0x48fb5d,_0x54de17=_0x68fc7f[_0x2854b2(0x243)](_0x581fec=>{const _0x52c471=_0x2854b2;_0x581fec[_0x52c471(0x18f)]==_0x32d385[_0x52c471(0x129)]&&(_0x581fec[_0x52c471(0x24a)]=parseInt(_0x581fec[_0x52c471(0x24a)])+parseInt(_0x32d385[_0x52c471(0x26b)]));});});const _0x416796=await staff[_0x48fb5d(0x261)]({'email':_0xc730e6[_0x48fb5d(0x194)]});if(_0xf9630[0x0][_0x48fb5d(0x1df)]==_0x48fb5d(0x260))var _0x103f03=users['English'];else{if(_0xf9630[0x0][_0x48fb5d(0x1df)]==_0x48fb5d(0x171))var _0x103f03=users[_0x48fb5d(0x171)];else{if(_0xf9630[0x0]['language']==_0x48fb5d(0x12a))var _0x103f03=users[_0x48fb5d(0x12a)];else{if(_0xf9630[0x0][_0x48fb5d(0x1df)]==_0x48fb5d(0x13f))var _0x103f03=users['Spanish'];else{if(_0xf9630[0x0][_0x48fb5d(0x1df)]=='French')var _0x103f03=users[_0x48fb5d(0x122)];else{if(_0xf9630[0x0][_0x48fb5d(0x1df)]==_0x48fb5d(0x14c))var _0x103f03=users[_0x48fb5d(0x1a5)];else{if(_0xf9630[0x0][_0x48fb5d(0x1df)]==_0x48fb5d(0x1fa))var _0x103f03=users[_0x48fb5d(0x1fa)];else{if(_0xf9630[0x0][_0x48fb5d(0x1df)]==_0x48fb5d(0x145))var _0x103f03=users[_0x48fb5d(0x273)];}}}}}}}_0x1ec513[_0x48fb5d(0x123)](_0x48fb5d(0x201),{'success':_0x1b0171[_0x48fb5d(0x252)](_0x48fb5d(0x1c8)),'errors':_0x1b0171[_0x48fb5d(0x252)](_0x48fb5d(0x22c)),'alldata':_0x68fc7f,'profile':_0x162dfa,'master_shop':_0xf9630,'role':_0xc730e6,'product_stock':_0x246a8a,'language':_0x103f03,'staff_arr':_0x416796});}catch(_0x43c6f9){}});async function agentsdataDSICheck_DSRR(_0x8217b3,_0x4e3740,_0x16dee6,_0x31ea18){const _0x1885f8=a0_0x4b16db;let _0x1f828c=new Date(_0x8217b3);_0x1f828c['setDate'](_0x1f828c['getDate']()-0x1);let _0x365bc2=_0x1f828c[_0x1885f8(0x1e3)]()[_0x1885f8(0x21b)]('T')[0x0];const _0x367359=await product[_0x1885f8(0x240)]([{'$group':{'_id':{'brand':_0x1885f8(0x18b),'category':'$category'},'products':{'$push':{'name':_0x1885f8(0x14b),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x6b75a9=[];_0x6b75a9[_0x1885f8(0x254)]=[];for(let _0x27e5b3=0x0;_0x27e5b3<=_0x367359['length']-0x1;_0x27e5b3++){const _0xc76dd8=_0x367359[_0x27e5b3];_0x6b75a9[_0x1885f8(0x254)]['push'](_0xc76dd8);}const _0x1432e8=await product['aggregate']([{'$group':{'_id':{'category':_0x1885f8(0x188)},'products':{'$push':{'brand':_0x1885f8(0x18b),'product_code':'$product_code','product_name':_0x1885f8(0x14b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x24dc8d=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':'$brand'}}},{'$group':{'_id':_0x1885f8(0x185),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x70613a=await sales_sa[_0x1885f8(0x240)]([{'$match':{'date':_0x8217b3,'sales_staff_id':_0x4e3740,'sale_product.isFG':'false'}},{'$unwind':_0x1885f8(0x1bc)},{'$lookup':{'from':_0x1885f8(0x117),'localField':'sale_product.product_code','foreignField':'product_code','as':_0x1885f8(0x251)}},{'$unwind':_0x1885f8(0x20e)},{'$group':{'_id':{'dsi':_0x1885f8(0x1f3),'date':_0x1885f8(0x15f),'customer':_0x1885f8(0x24b),'status_data':'$status_data'},'totalQty':{'$sum':_0x1885f8(0x1de)},'cash':{'$first':_0x1885f8(0x263)},'amount':{'$first':'$amount'},'bank':{'$first':'$bank'},'check_no':{'$first':_0x1885f8(0x203)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x1885f8(0x1de),'NetPrice':_0x1885f8(0x187),'discount':_0x1885f8(0x23e),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':_0x1885f8(0x14a),'category':_0x1885f8(0x1cf),'brand':_0x1885f8(0x1e9),'gross_price':'$product_info.gross_price','isFG':_0x1885f8(0x226),'prod_cat':_0x1885f8(0x20a),'prod_id':_0x1885f8(0x26d)}}}}},{'$unwind':_0x1885f8(0x1aa)},{'$group':{'_id':{'dsi':_0x1885f8(0x16a),'date':_0x1885f8(0x1b0),'customer':'$_id.customer','status_data':'$_id.status_data','category':_0x1885f8(0x235),'brand':_0x1885f8(0x19c),'prod_id':_0x1885f8(0x21a)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x1885f8(0x14d),_0x1885f8(0x272)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x1885f8(0x28c)},'cash':{'$first':_0x1885f8(0x263)},'amount':{'$first':_0x1885f8(0x1e2)},'bank':{'$first':_0x1885f8(0x17f)},'check_no':{'$first':_0x1885f8(0x203)},'due_date':{'$first':_0x1885f8(0x1ec)},'product_details':{'$first':_0x1885f8(0x1fc)}}},{'$group':{'_id':{'dsi':_0x1885f8(0x16a),'date':_0x1885f8(0x1b0),'customer':_0x1885f8(0x184),'status_data':_0x1885f8(0x168)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x1885f8(0x10a)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x1885f8(0x253)},'cash':{'$first':_0x1885f8(0x263)},'amount':{'$first':_0x1885f8(0x1e2)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x1885f8(0x203)},'due_date':{'$first':_0x1885f8(0x1ec)},'products':{'$push':{'qty':_0x1885f8(0x270),'category':_0x1885f8(0x185),'brand':_0x1885f8(0x1d4),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xf12002=await sales_sa[_0x1885f8(0x240)]([{'$match':{'date':_0x365bc2,'sales_staff_id':_0x4e3740,'sale_product.isFG':_0x1885f8(0x1ef)}},{'$unwind':_0x1885f8(0x1bc)},{'$lookup':{'from':_0x1885f8(0x117),'localField':_0x1885f8(0x131),'foreignField':_0x1885f8(0x25c),'as':_0x1885f8(0x251)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x1885f8(0x1f3),'date':_0x1885f8(0x15f),'customer':_0x1885f8(0x24b)},'totalQty':{'$sum':_0x1885f8(0x1de)},'cash':{'$first':'$cash'},'amount':{'$first':_0x1885f8(0x1e2)},'bank':{'$first':_0x1885f8(0x17f)},'check_no':{'$first':_0x1885f8(0x203)},'due_date':{'$first':_0x1885f8(0x1ec)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x1885f8(0x187),'discount':'$sale_product.discount','adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x1885f8(0x1cf),'brand':_0x1885f8(0x1e9),'gross_price':_0x1885f8(0x215),'isFG':_0x1885f8(0x226),'prod_cat':_0x1885f8(0x20a),'prod_id':_0x1885f8(0x26d)}}}}},{'$unwind':_0x1885f8(0x1aa)},{'$group':{'_id':{'dsi':_0x1885f8(0x16a),'date':_0x1885f8(0x1b0),'customer':_0x1885f8(0x184),'category':_0x1885f8(0x235),'brand':_0x1885f8(0x19c),'prod_id':_0x1885f8(0x21a)},'totalQty':{'$sum':_0x1885f8(0x14d)},'cash':{'$first':_0x1885f8(0x263)},'amount':{'$first':_0x1885f8(0x1e2)},'bank':{'$first':_0x1885f8(0x17f)},'check_no':{'$first':_0x1885f8(0x203)},'due_date':{'$first':_0x1885f8(0x1ec)},'totalGross':{'$sum':{'$multiply':[_0x1885f8(0x14d),_0x1885f8(0x272)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x1885f8(0x1fc)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x1885f8(0x184)},'totalQty':{'$sum':_0x1885f8(0x270)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x1885f8(0x17f)},'check_no':{'$first':_0x1885f8(0x203)},'due_date':{'$first':_0x1885f8(0x1ec)},'totalGross':{'$sum':_0x1885f8(0x10a)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x1885f8(0x253)},'products':{'$push':{'qty':_0x1885f8(0x270),'category':_0x1885f8(0x185),'brand':_0x1885f8(0x1d4),'product_details':_0x1885f8(0x1b7)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x17c60b=await sales_sa[_0x1885f8(0x240)]([{'$match':{'date':_0x8217b3,'sales_staff_id':_0x4e3740,'status_data':_0x1885f8(0x1f1)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xe82d8=await staff[_0x1885f8(0x149)](_0x4e3740);let _0x2e4bcc=[],_0xad3082={},_0x4fde8e={};var _0x279db4=0x0,_0x6bd3=0x0,_0x3adfbc=0x0,_0x51bbab=0x0,_0x2d3df5=0x0;const _0xbde431=0x6;var _0x5d27a1=0x0,_0x32ef3d=0x0;for(let _0x2ae7fc=0x0;_0x2ae7fc<=_0x70613a[_0x1885f8(0x1c6)]-0x1;_0x2ae7fc++){const _0x5e05f3=_0x70613a[_0x2ae7fc];let _0x421413='<tr>';_0x421413+=_0x1885f8(0x127),_0x421413+=_0x1885f8(0x1dc)+_0x5e05f3[_0x1885f8(0x129)][_0x1885f8(0x238)]+_0x1885f8(0x1e6),_0x421413+=_0x1885f8(0x1dc)+_0x5e05f3[_0x1885f8(0x129)][_0x1885f8(0x15a)]+'</td>';let _0x6281b2={},_0x5533ae={},_0x35acd7={};var _0x2d74d2={},_0x4cdf51={},_0x22d736={},_0x38d2e3=0x0;for(let _0x1bc84a=0x0;_0x1bc84a<=_0x5e05f3['products'][_0x1885f8(0x1c6)]-0x1;_0x1bc84a++){const _0x514d6d=_0x5e05f3[_0x1885f8(0x117)][_0x1bc84a];_0x6281b2[_0x514d6d[_0x1885f8(0x16e)]+'-'+_0x514d6d[_0x1885f8(0x22d)]]=_0x514d6d[_0x1885f8(0x26a)],_0x5533ae[[_0x514d6d[_0x1885f8(0x16e)]+'-'+_0x514d6d['category']]]=_0x514d6d[_0x1885f8(0x1bb)][_0x1885f8(0x1db)],_0x35acd7[[_0x514d6d[_0x1885f8(0x16e)]+'-'+_0x514d6d['category']]]=_0x514d6d[_0x1885f8(0x1bb)]['prod_cat'];const _0x59bd40=_0x514d6d[_0x1885f8(0x16e)]+'-'+_0x514d6d['category'];!Array[_0x1885f8(0x1a4)](_0x4fde8e[_0x59bd40])&&(_0x4fde8e[_0x59bd40]=[]);!Array['isArray'](_0x4fde8e[_0x59bd40])&&(_0x4fde8e[_0x59bd40]=[]);_0x4fde8e[_0x59bd40][_0x1885f8(0x1e5)](_0x514d6d['qty']);if(_0x514d6d['product_details'][_0x1885f8(0x118)]=='P')_0x514d6d[_0x1885f8(0x1bb)][_0x1885f8(0x1db)]==_0x1885f8(0x1f1)?(!_0x22d736[_0x59bd40]&&(_0x22d736[_0x59bd40]=0x0),_0x22d736[_0x59bd40]=_0x514d6d[_0x1885f8(0x26a)]):(!_0x2d74d2[_0x59bd40]&&(_0x2d74d2[_0x59bd40]=0x0),_0x2d74d2[_0x59bd40]=_0x514d6d[_0x1885f8(0x26a)]);else _0x514d6d['product_details'][_0x1885f8(0x118)]=='S'&&(_0x514d6d[_0x1885f8(0x1bb)][_0x1885f8(0x1db)]==_0x1885f8(0x1f1)?(!_0x22d736[_0x59bd40]&&(_0x22d736[_0x59bd40]=0x0),_0x22d736[_0x59bd40]=_0x514d6d['qty']):(!_0x4cdf51[_0x59bd40]&&(_0x4cdf51[_0x59bd40]=0x0),_0x4cdf51[_0x59bd40]=_0x514d6d[_0x1885f8(0x26a)]));_0x38d2e3++;}for(let _0x34bb43=0x0;_0x34bb43<=_0x6b75a9[_0x1885f8(0x254)]['length']-0x1;_0x34bb43++){const _0x2bee40=_0x6b75a9[_0x1885f8(0x254)][_0x34bb43],_0x14dcb2=_0x2bee40[_0x1885f8(0x129)]['brand']+'-'+_0x2bee40[_0x1885f8(0x129)][_0x1885f8(0x22d)],_0x5df507=_0x35acd7[_0x14dcb2]!==undefined?_0x35acd7[_0x14dcb2]:'NA';var _0x176b26=_0x2d74d2[_0x14dcb2]!==undefined?_0x2d74d2[_0x14dcb2]['toFixed'](0x2):'',_0x1625c3=_0x4cdf51[_0x14dcb2]!==undefined?_0x4cdf51[_0x14dcb2][_0x1885f8(0x26e)](0x2):'',_0x116e46=_0x22d736[_0x14dcb2]!==undefined?_0x22d736[_0x14dcb2][_0x1885f8(0x26e)](0x2):'';_0x421413+=_0x1885f8(0x15b)+_0x176b26+_0x1885f8(0x1e6),_0x421413+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x1625c3+_0x1885f8(0x1e6),_0x421413+=_0x1885f8(0x15b)+_0x116e46+_0x1885f8(0x1e6);}var _0x981446=formatNumber(parseFloat(_0x5e05f3[_0x1885f8(0x19a)])),_0x322694=formatNumber(parseFloat(_0x5e05f3[_0x1885f8(0x176)]));isNaN(_0x322694)&&(_0x322694=0x0),_0x421413+=_0x1885f8(0x15b)+_0x981446+'</td>',_0x421413+=_0x1885f8(0x15b)+_0x322694+_0x1885f8(0x1e6),_0x421413+=_0x1885f8(0x1dc)+_0x5e05f3['bank']+_0x1885f8(0x1e6),_0x421413+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5e05f3['check_no']+_0x1885f8(0x1e6),_0x421413+=_0x1885f8(0x1dc)+_0x5e05f3[_0x1885f8(0x156)]+_0x1885f8(0x1e6),_0x3adfbc=_0x5e05f3['discount']+_0x5e05f3[_0x1885f8(0x25d)],_0x5d27a1+=parseFloat(_0x5e05f3[_0x1885f8(0x19a)]),_0x32ef3d+=parseFloat(_0x322694),_0x2e4bcc[_0x1885f8(0x1e5)](_0x421413);}if(_0x17c60b[_0x1885f8(0x1c6)]>0x0)for(let _0x57813d=0x0;_0x57813d<=_0x17c60b['length']-0x1;_0x57813d++){const _0x6b66b1=_0x17c60b[_0x57813d];console[_0x1885f8(0x1d7)](_0x6b66b1);let _0x171ae7=_0x1885f8(0x197);_0x171ae7+=_0x1885f8(0x161)+(0x8+0x7*0x3)+_0x1885f8(0x1d6)+_0x6b66b1[_0x1885f8(0x1bd)]+'</b></td>',_0x171ae7+=_0x1885f8(0x13c),_0x2e4bcc[_0x1885f8(0x1e5)](_0x171ae7);}function _0x471fa9(_0xe88671,_0x2271a0){const _0x2a7102=_0x1885f8,_0x1f740f=[];for(let _0x50772f=0x0;_0x50772f<=_0xe88671[_0x2a7102(0x1c6)]-0x1;_0x50772f+=_0x2271a0){_0x1f740f['push'](_0xe88671[_0x2a7102(0x277)](_0x50772f,_0x50772f+_0x2271a0));}return _0x1f740f;}const _0x441c05=_0x471fa9(_0x2e4bcc,_0xbde431);let _0x15a5e9='';return _0x441c05[_0x1885f8(0x289)]((_0xad71cf,_0x511ef0)=>{const _0x676bd2=_0x1885f8;_0x511ef0>0x0&&(_0x15a5e9+=_0x676bd2(0x28e));_0x15a5e9+='<table>',_0x15a5e9+=_0x676bd2(0x236);const _0x4ffe42=new Date(_0x8217b3),_0x31a9e5={'year':_0x676bd2(0x234),'month':_0x676bd2(0x1e8),'day':'numeric','timeZone':_0x676bd2(0x13d)},_0x53884d=_0x4ffe42[_0x676bd2(0x218)](_0x676bd2(0x17d),_0x31a9e5);_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x135)+_0x31ea18+_0x676bd2(0x1fe),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x222)+_0xe82d8[_0x676bd2(0x18f)]+_0x676bd2(0x1e6),_0x15a5e9+=_0x676bd2(0x23f),_0x15a5e9+=_0x676bd2(0x22a),_0x15a5e9+=_0x676bd2(0x17a),_0x15a5e9+=_0x676bd2(0x137),_0x15a5e9+=_0x676bd2(0x20d),_0x15a5e9+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>',_0x15a5e9+=_0x676bd2(0x1af),_0x15a5e9+=_0x676bd2(0x1d0),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+='<tr>',_0x15a5e9+=_0x676bd2(0x271),_0x15a5e9+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20'+_0x53884d+'</td>',_0x15a5e9+=_0x676bd2(0x284),_0x15a5e9+=_0x676bd2(0x1a6),_0x15a5e9+=_0x676bd2(0x152),_0x15a5e9+=_0x676bd2(0x152),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+='<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>',_0x15a5e9+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0x15a5e9+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>',_0x15a5e9+=_0x676bd2(0x152),_0x15a5e9+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x164),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x278),_0x15a5e9+='<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>',_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+='<tr>',_0x15a5e9+=_0x676bd2(0x1c5),_0x15a5e9+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x15a5e9+=_0x676bd2(0x250);for(let _0x28d5fa=0x0;_0x28d5fa<=_0x1432e8[_0x676bd2(0x1c6)]-0x1;_0x28d5fa++){const _0x23e4e2=_0x1432e8[_0x28d5fa];for(let _0x3f6166=0x0;_0x3f6166<_0x6b75a9[_0x676bd2(0x254)]['length'];_0x3f6166++){const _0x33ceb8=_0x6b75a9[_0x676bd2(0x254)][_0x3f6166];if(_0x33ceb8[_0x676bd2(0x129)][_0x676bd2(0x22d)]===_0x23e4e2[_0x676bd2(0x129)]['category']){var _0x23d090='';switch(_0x23e4e2[_0x676bd2(0x129)]['category']){case _0x676bd2(0x1cd):_0x23d090=_0x33ceb8[_0x676bd2(0x129)]['brand']+_0x676bd2(0x232);break;case'Household':_0x23d090=_0x33ceb8[_0x676bd2(0x129)][_0x676bd2(0x16e)]+'\x20-\x20HH';break;default:_0x23d090=_0x33ceb8['_id'][_0x676bd2(0x16e)];break;}_0x15a5e9+=_0x676bd2(0x242)+_0x23d090+_0x676bd2(0x1fe);}}}_0x15a5e9+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x15a5e9+=_0x676bd2(0x1dd),_0x15a5e9+=_0x676bd2(0x1ea),_0x15a5e9+='</tr>',_0x15a5e9+='<tr>',_0x15a5e9+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x56bfbc=0x0;_0x56bfbc<=_0x6b75a9[_0x676bd2(0x254)]['length']-0x1;_0x56bfbc++){const _0x3e932a=_0x6b75a9[_0x56bfbc];_0x15a5e9+=_0x676bd2(0x262),_0x15a5e9+=_0x676bd2(0x204),_0x15a5e9+=_0x676bd2(0x22e);}_0x15a5e9+=_0x676bd2(0x1cb),_0x15a5e9+=_0x676bd2(0x12c),_0x15a5e9+=_0x676bd2(0x237),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x165),_0x15a5e9+=_0x676bd2(0x265),_0xad71cf[_0x676bd2(0x289)](_0x516d2f=>{_0x15a5e9+=_0x516d2f;});let _0xa35e78={},_0x2b0dad={},_0x34aa00={};for(let _0x3797c3=0x0;_0x3797c3<=_0x70613a[_0x676bd2(0x1c6)]-0x1;_0x3797c3++){const _0x56b0fe=_0x70613a[_0x3797c3];var _0x4adec9=0x0;for(let _0x22991a=0x0;_0x22991a<=_0x56b0fe['products'][_0x676bd2(0x1c6)]-0x1;_0x22991a++){const _0x392929=_0x56b0fe[_0x676bd2(0x117)][_0x22991a],_0x140cad=_0x392929[_0x676bd2(0x16e)]+'-'+_0x392929[_0x676bd2(0x22d)];if(_0x392929[_0x676bd2(0x1bb)][_0x676bd2(0x118)]=='P')_0x392929[_0x676bd2(0x1bb)][_0x676bd2(0x1db)]=='true'?(!_0x34aa00[_0x140cad]&&(_0x34aa00[_0x140cad]=0x0),_0x34aa00[_0x140cad]+=_0x392929[_0x676bd2(0x26a)]):(!_0xa35e78[_0x140cad]&&(_0xa35e78[_0x140cad]=0x0),_0xa35e78[_0x140cad]+=_0x392929[_0x676bd2(0x26a)]);else _0x392929['product_details']['prod_cat']=='S'&&(_0x392929[_0x676bd2(0x1bb)][_0x676bd2(0x1db)]=='true'?(!_0x34aa00[_0x140cad]&&(_0x34aa00[_0x140cad]=0x0),_0x34aa00[_0x140cad]+=_0x392929['qty'],console[_0x676bd2(0x1d7)](_0x392929[_0x676bd2(0x26a)])):(!_0x2b0dad[_0x140cad]&&(_0x2b0dad[_0x140cad]=0x0),_0x2b0dad[_0x140cad]+=_0x392929['qty']));_0x4adec9++;}}let _0x4d8dd5={},_0x24ca6b={},_0xa7169b={};var _0x17ffc7=0x0,_0x2c1ceb=0x0;for(let _0x3a647=0x0;_0x3a647<=_0xf12002[_0x676bd2(0x1c6)]-0x1;_0x3a647++){const _0x5f1762=_0xf12002[_0x3a647];var _0x4adec9=0x0;for(let _0x20b93c=0x0;_0x20b93c<=_0x5f1762[_0x676bd2(0x117)][_0x676bd2(0x1c6)]-0x1;_0x20b93c++){const _0x20af89=_0x5f1762['products'][_0x20b93c],_0x251dd9=_0x20af89['brand']+'-'+_0x20af89['category'];if(_0x20af89[_0x676bd2(0x1bb)][_0x676bd2(0x118)]=='P')_0x20af89[_0x676bd2(0x1bb)][_0x676bd2(0x1db)]==_0x676bd2(0x1f1)?(!_0xa7169b[_0x251dd9]&&(_0xa7169b[_0x251dd9]=0x0),_0xa7169b[_0x251dd9]+=_0x20af89[_0x676bd2(0x26a)]):(!_0x4d8dd5[_0x251dd9]&&(_0x4d8dd5[_0x251dd9]=0x0),_0x4d8dd5[_0x251dd9]+=_0x20af89[_0x676bd2(0x26a)]);else _0x20af89[_0x676bd2(0x1bb)][_0x676bd2(0x118)]=='S'&&(_0x20af89['product_details']['isFG']==_0x676bd2(0x1f1)?(!_0xa7169b[_0x251dd9]&&(_0xa7169b[_0x251dd9]=0x0),_0xa7169b[_0x251dd9]+=_0x20af89[_0x676bd2(0x26a)]):(!_0x24ca6b[_0x251dd9]&&(_0x24ca6b[_0x251dd9]=0x0),_0x24ca6b[_0x251dd9]+=_0x20af89[_0x676bd2(0x26a)]));_0x4adec9++;}var _0x4e4c01=parseFloat(_0x5f1762['cash']),_0x9004b2=parseFloat(_0x5f1762[_0x676bd2(0x176)]);isNaN(_0x9004b2)&&(_0x9004b2=0x0),_0x17ffc7+=_0x4e4c01,_0x2c1ceb+=_0x9004b2;}_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x1b5),_0x15a5e9+=_0x676bd2(0x268),_0x15a5e9+=_0x676bd2(0x127);for(let _0x407ba0=0x0;_0x407ba0<=_0x6b75a9[_0x676bd2(0x254)][_0x676bd2(0x1c6)]-0x1;_0x407ba0++){const _0x1350cf=_0x6b75a9[_0x676bd2(0x254)][_0x407ba0],_0x430b74=_0x1350cf[_0x676bd2(0x129)][_0x676bd2(0x16e)]+'-'+_0x1350cf['_id']['category'];var _0x2615fe=_0xa35e78[_0x430b74]!==undefined?formatNumber(_0xa35e78[_0x430b74][_0x676bd2(0x26e)](0x2)):'',_0x2f226f=_0x34aa00[_0x430b74]!==undefined?formatNumber(_0x34aa00[_0x430b74][_0x676bd2(0x26e)](0x2)):'',_0x16e92e=_0x2b0dad[_0x430b74]!==undefined?formatNumber(_0x2b0dad[_0x430b74][_0x676bd2(0x26e)](0x2)):'';_0x15a5e9+=_0x676bd2(0x181)+_0x2615fe+_0x676bd2(0x1fe),_0x15a5e9+=_0x676bd2(0x181)+_0x16e92e+_0x676bd2(0x1fe),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x2f226f+_0x676bd2(0x1fe);}_0x15a5e9+=_0x676bd2(0x181)+formatNumber(_0x5d27a1)+_0x676bd2(0x1fe),_0x15a5e9+=_0x676bd2(0x181)+formatNumber(_0x32ef3d)+'</b></td>',_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+='<tr>',_0x15a5e9+=_0x676bd2(0x1b5),_0x15a5e9+=_0x676bd2(0x198),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x1fd11d=0x0;_0x1fd11d<=_0x6b75a9[_0x676bd2(0x254)][_0x676bd2(0x1c6)]-0x1;_0x1fd11d++){const _0x321452=_0x6b75a9[_0x676bd2(0x254)][_0x1fd11d],_0x54cd91=_0x321452['_id'][_0x676bd2(0x16e)]+'-'+_0x321452[_0x676bd2(0x129)]['category'];var _0x2615fe=_0x4d8dd5[_0x54cd91]!==undefined?formatNumber(_0x4d8dd5[_0x54cd91][_0x676bd2(0x26e)](0x2)):'',_0x2f226f=_0xa7169b[_0x54cd91]!==undefined?formatNumber(_0xa7169b[_0x54cd91][_0x676bd2(0x26e)](0x2)):'',_0x16e92e=_0x24ca6b[_0x54cd91]!==undefined?formatNumber(_0x24ca6b[_0x54cd91][_0x676bd2(0x26e)](0x2)):'';_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x2615fe+'</b></td>',_0x15a5e9+=_0x676bd2(0x181)+_0x16e92e+_0x676bd2(0x1fe),_0x15a5e9+=_0x676bd2(0x181)+_0x2f226f+_0x676bd2(0x1fe);}_0x15a5e9+=_0x676bd2(0x181)+formatNumber(_0x17ffc7)+_0x676bd2(0x1fe),_0x15a5e9+=_0x676bd2(0x181)+formatNumber(_0x2c1ceb)+'</b></td>',_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x1b5),_0x15a5e9+=_0x676bd2(0x140),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';let _0x40113d=0x0,_0x309321=0x0,_0x2819b2=0x0;for(let _0x339149=0x0;_0x339149<=_0x6b75a9['cat_brand'][_0x676bd2(0x1c6)]-0x1;_0x339149++){const _0x1e388b=_0x6b75a9[_0x676bd2(0x254)][_0x339149],_0x46b92f=_0x1e388b[_0x676bd2(0x129)][_0x676bd2(0x16e)]+'-'+_0x1e388b[_0x676bd2(0x129)]['category'];var _0x41c15d=_0xa35e78[_0x46b92f]!==undefined?_0xa35e78[_0x46b92f][_0x676bd2(0x26e)](0x2):'0',_0x4b5d01=_0x34aa00[_0x46b92f]!==undefined?_0x34aa00[_0x46b92f][_0x676bd2(0x26e)](0x2):'0',_0x1a7fab=_0x2b0dad[_0x46b92f]!==undefined?_0x2b0dad[_0x46b92f][_0x676bd2(0x26e)](0x2):'0',_0x4ed618=_0x4d8dd5[_0x46b92f]!==undefined?_0x4d8dd5[_0x46b92f][_0x676bd2(0x26e)](0x2):'0',_0x3b02be=_0xa7169b[_0x46b92f]!==undefined?_0xa7169b[_0x46b92f][_0x676bd2(0x26e)](0x2):'0',_0x49fb04=_0x24ca6b[_0x46b92f]!==undefined?_0x24ca6b[_0x46b92f][_0x676bd2(0x26e)](0x2):'0';_0x40113d=parseFloat(_0x41c15d)+parseFloat(_0x4ed618),_0x309321=parseFloat(_0x1a7fab)+parseFloat(_0x49fb04),_0x2819b2=parseFloat(_0x4b5d01)+parseFloat(_0x3b02be),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x40113d[_0x676bd2(0x26e)](0x2))+_0x676bd2(0x1fe),_0x15a5e9+=_0x676bd2(0x181)+formatNumber(_0x309321[_0x676bd2(0x26e)](0x2))+_0x676bd2(0x1fe),_0x15a5e9+=_0x676bd2(0x181)+formatNumber(_0x2819b2[_0x676bd2(0x26e)](0x2))+_0x676bd2(0x1fe);}var _0x24166d=formatNumber(_0x5d27a1+_0x17ffc7),_0x53c798=formatNumber(_0x32ef3d+_0x2c1ceb);_0x15a5e9+=_0x676bd2(0x181)+_0x24166d+'</b></td>',_0x15a5e9+=_0x676bd2(0x181)+_0x53c798+_0x676bd2(0x1fe),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='</tr>',_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x20c)+(_0x6b75a9[_0x676bd2(0x254)]['length']*0x3+0x9)+_0x676bd2(0x19e),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x1b5),_0x15a5e9+=_0x676bd2(0x139),_0x15a5e9+=_0x676bd2(0x127);for(let _0x39419d=0x0;_0x39419d<=_0x6b75a9[_0x676bd2(0x254)][_0x676bd2(0x1c6)]-0x1;_0x39419d++){const _0x5b32bf=_0x6b75a9[_0x676bd2(0x254)][_0x39419d],_0x2c2a2a=_0x5b32bf[_0x676bd2(0x129)]['brand']+'-'+_0x5b32bf['_id'][_0x676bd2(0x22d)];var _0x41c15d=_0xa35e78[_0x2c2a2a]!==undefined?_0xa35e78[_0x2c2a2a]['toFixed'](0x2):'0',_0x4b5d01=_0x34aa00[_0x2c2a2a]!==undefined?_0x34aa00[_0x2c2a2a]['toFixed'](0x2):'0',_0x1a7fab=_0x2b0dad[_0x2c2a2a]!==undefined?_0x2b0dad[_0x2c2a2a][_0x676bd2(0x26e)](0x2):'0',_0x4ed618=_0x4d8dd5[_0x2c2a2a]!==undefined?_0x4d8dd5[_0x2c2a2a]['toFixed'](0x2):'0',_0x3b02be=_0xa7169b[_0x2c2a2a]!==undefined?_0xa7169b[_0x2c2a2a][_0x676bd2(0x26e)](0x2):'0',_0x49fb04=_0x24ca6b[_0x2c2a2a]!==undefined?_0x24ca6b[_0x2c2a2a][_0x676bd2(0x26e)](0x2):'0';_0x40113d=parseFloat(_0x41c15d)+parseFloat(_0x4ed618),_0x309321=parseFloat(_0x1a7fab)+parseFloat(_0x49fb04),_0x2819b2=parseFloat(_0x4b5d01)+parseFloat(_0x3b02be),_0x15a5e9+=_0x676bd2(0x1d5),_0x15a5e9+=_0x676bd2(0x1d5),_0x15a5e9+=_0x676bd2(0x1d5);}_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x15a5e9+=_0x676bd2(0x22b),_0x15a5e9+=_0x676bd2(0x127);for(let _0x2bc9bf=0x0;_0x2bc9bf<=_0x6b75a9['cat_brand'][_0x676bd2(0x1c6)]-0x1;_0x2bc9bf++){const _0x59736e=_0x6b75a9['cat_brand'][_0x2bc9bf],_0x16aab4=_0x59736e[_0x676bd2(0x129)][_0x676bd2(0x16e)]+'-'+_0x59736e[_0x676bd2(0x129)]['category'];var _0x41c15d=_0xa35e78[_0x16aab4]!==undefined?_0xa35e78[_0x16aab4][_0x676bd2(0x26e)](0x2):'0',_0x4b5d01=_0x34aa00[_0x16aab4]!==undefined?_0x34aa00[_0x16aab4][_0x676bd2(0x26e)](0x2):'0',_0x1a7fab=_0x2b0dad[_0x16aab4]!==undefined?_0x2b0dad[_0x16aab4][_0x676bd2(0x26e)](0x2):'0',_0x4ed618=_0x4d8dd5[_0x16aab4]!==undefined?_0x4d8dd5[_0x16aab4][_0x676bd2(0x26e)](0x2):'0',_0x3b02be=_0xa7169b[_0x16aab4]!==undefined?_0xa7169b[_0x16aab4]['toFixed'](0x2):'0',_0x49fb04=_0x24ca6b[_0x16aab4]!==undefined?_0x24ca6b[_0x16aab4][_0x676bd2(0x26e)](0x2):'0';_0x40113d=parseFloat(_0x41c15d)+parseFloat(_0x4ed618),_0x309321=parseFloat(_0x1a7fab)+parseFloat(_0x49fb04),_0x2819b2=parseFloat(_0x4b5d01)+parseFloat(_0x3b02be),_0x15a5e9+=_0x676bd2(0x1d5),_0x15a5e9+=_0x676bd2(0x1d5),_0x15a5e9+=_0x676bd2(0x1d5);}_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x15a5e9+=_0x676bd2(0x210),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x907def=0x0;_0x907def<=_0x6b75a9['cat_brand'][_0x676bd2(0x1c6)]-0x1;_0x907def++){const _0x49cdaa=_0x6b75a9[_0x676bd2(0x254)][_0x907def],_0x407326=_0x49cdaa['_id'][_0x676bd2(0x16e)]+'-'+_0x49cdaa['_id']['category'];var _0x41c15d=_0xa35e78[_0x407326]!==undefined?_0xa35e78[_0x407326][_0x676bd2(0x26e)](0x2):'0',_0x4b5d01=_0x34aa00[_0x407326]!==undefined?_0x34aa00[_0x407326][_0x676bd2(0x26e)](0x2):'0',_0x1a7fab=_0x2b0dad[_0x407326]!==undefined?_0x2b0dad[_0x407326][_0x676bd2(0x26e)](0x2):'0',_0x4ed618=_0x4d8dd5[_0x407326]!==undefined?_0x4d8dd5[_0x407326][_0x676bd2(0x26e)](0x2):'0',_0x3b02be=_0xa7169b[_0x407326]!==undefined?_0xa7169b[_0x407326]['toFixed'](0x2):'0',_0x49fb04=_0x24ca6b[_0x407326]!==undefined?_0x24ca6b[_0x407326][_0x676bd2(0x26e)](0x2):'0';_0x40113d=parseFloat(_0x41c15d)+parseFloat(_0x4ed618),_0x309321=parseFloat(_0x1a7fab)+parseFloat(_0x49fb04),_0x2819b2=parseFloat(_0x4b5d01)+parseFloat(_0x3b02be),_0x15a5e9+=_0x676bd2(0x1d5),_0x15a5e9+=_0x676bd2(0x1d5),_0x15a5e9+=_0x676bd2(0x1d5);}_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='</tr>',_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x1b5),_0x15a5e9+=_0x676bd2(0x268),_0x15a5e9+=_0x676bd2(0x127);for(let _0x309bb7=0x0;_0x309bb7<=_0x6b75a9[_0x676bd2(0x254)][_0x676bd2(0x1c6)]-0x1;_0x309bb7++){const _0x19e973=_0x6b75a9[_0x676bd2(0x254)][_0x309bb7],_0x41270d=_0x19e973[_0x676bd2(0x129)][_0x676bd2(0x16e)]+'-'+_0x19e973[_0x676bd2(0x129)][_0x676bd2(0x22d)];var _0x41c15d=_0xa35e78[_0x41270d]!==undefined?_0xa35e78[_0x41270d][_0x676bd2(0x26e)](0x2):'',_0x4b5d01=_0x34aa00[_0x41270d]!==undefined?_0x34aa00[_0x41270d]['toFixed'](0x2):'',_0x1a7fab=_0x2b0dad[_0x41270d]!==undefined?_0x2b0dad[_0x41270d]['toFixed'](0x2):'',_0x4ed618=_0x4d8dd5[_0x41270d]!==undefined?_0x4d8dd5[_0x41270d][_0x676bd2(0x26e)](0x2):'',_0x3b02be=_0xa7169b[_0x41270d]!==undefined?_0xa7169b[_0x41270d][_0x676bd2(0x26e)](0x2):'',_0x49fb04=_0x24ca6b[_0x41270d]!==undefined?_0x24ca6b[_0x41270d][_0x676bd2(0x26e)](0x2):'';_0x40113d=formatNumber(parseFloat(_0x41c15d)+parseFloat(_0x4ed618)),_0x309321=formatNumber(parseFloat(_0x1a7fab)+parseFloat(_0x49fb04)),_0x2819b2=formatNumber(parseFloat(_0x4b5d01)+parseFloat(_0x3b02be)),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x41c15d+'</b></td>',_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1a7fab+'</b></td>',_0x15a5e9+=_0x676bd2(0x181)+_0x4b5d01+_0x676bd2(0x1fe);}_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x197),_0x15a5e9+=_0x676bd2(0x1b5),_0x15a5e9+=_0x676bd2(0x1e0),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x333f2b=0x0;_0x333f2b<=_0x6b75a9[_0x676bd2(0x254)][_0x676bd2(0x1c6)]-0x1;_0x333f2b++){const _0x50b845=_0x6b75a9[_0x676bd2(0x254)][_0x333f2b],_0x5757a6=_0x50b845[_0x676bd2(0x129)]['brand']+'-'+_0x50b845[_0x676bd2(0x129)][_0x676bd2(0x22d)];var _0x41c15d=_0xa35e78[_0x5757a6]!==undefined?_0xa35e78[_0x5757a6]['toFixed'](0x2):'0',_0x4b5d01=_0x34aa00[_0x5757a6]!==undefined?_0x34aa00[_0x5757a6][_0x676bd2(0x26e)](0x2):'0',_0x1a7fab=_0x2b0dad[_0x5757a6]!==undefined?_0x2b0dad[_0x5757a6]['toFixed'](0x2):'0',_0x4ed618=_0x4d8dd5[_0x5757a6]!==undefined?_0x4d8dd5[_0x5757a6][_0x676bd2(0x26e)](0x2):'0',_0x3b02be=_0xa7169b[_0x5757a6]!==undefined?_0xa7169b[_0x5757a6][_0x676bd2(0x26e)](0x2):'0',_0x49fb04=_0x24ca6b[_0x5757a6]!==undefined?_0x24ca6b[_0x5757a6][_0x676bd2(0x26e)](0x2):'0';_0x40113d=parseFloat(_0x41c15d)+parseFloat(_0x4ed618),_0x309321=parseFloat(_0x1a7fab)+parseFloat(_0x49fb04),_0x2819b2=parseFloat(_0x4b5d01)+parseFloat(_0x3b02be),_0x15a5e9+=_0x676bd2(0x1d5),_0x15a5e9+=_0x676bd2(0x1d5),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+=_0x676bd2(0x127),_0x15a5e9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x15a5e9+=_0x676bd2(0x13c),_0x15a5e9+=_0x676bd2(0x206),_0x15a5e9+='</table>';}),_0x15a5e9;}async function generateReferenceNumber(_0x39f924,_0x54989e,_0xd0b123){const _0x274061=a0_0x4b16db,_0x5d36bc=new Date(_0x39f924)[_0x274061(0x11c)](),_0x2bdfee=('0'+(new Date(_0x39f924)['getMonth']()+0x1))[_0x274061(0x277)](-0x2),_0x3ab436=('0'+new Date(_0x39f924)['getDate']())[_0x274061(0x277)](-0x2),_0x1e8ff9=await staff[_0x274061(0x261)]({'email':_0xd0b123['email']}),_0x4a4206=_0x1e8ff9[_0x274061(0x175)],_0x1475be=_0x4a4206+'-'+_0x5d36bc+_0x2bdfee+_0x3ab436,_0x4dabc9=await Reference[_0x274061(0x261)]({'referenceNumber':new RegExp('^'+_0x1475be),'salesman_code':_0x4a4206})['sort']({'createdAt':-0x1}),_0x4e854c=_0x1475be;_0x4dabc9&&(_0x4e854c=_0x4dabc9[_0x274061(0x11f)]);console[_0x274061(0x1d7)](_0x4e854c);const _0x53b6f4=new Reference({'referenceNumber':_0x4e854c,'staff_id':_0x54989e,'salesman_code':_0x4a4206});return await _0x53b6f4['save'](),_0x4e854c;}router[a0_0x4b16db(0x225)](a0_0x4b16db(0x1f7),auth,async(_0x53e276,_0x55a50a)=>{const _0x172d40=a0_0x4b16db,{from_date:_0x5ab66b,dataview:_0x88ce7a}=_0x53e276[_0x172d40(0x15c)],_0x3b1df4=_0x53e276[_0x172d40(0x10d)],_0x51ef1e=await staff['findOne']({'email':_0x3b1df4[_0x172d40(0x194)]}),_0x450c46=await master_shop['find'](),_0x8554fb='';var _0x275533=new Date(_0x5ab66b);const _0x5deaa4={'year':_0x172d40(0x234),'month':'long','day':_0x172d40(0x234)},_0x47af5d=new Intl[(_0x172d40(0x221))](_0x172d40(0x17d),_0x5deaa4)['format'](_0x275533),_0x2814f7=await Reference[_0x172d40(0x288)]({'staff_id':_0x51ef1e[_0x172d40(0x129)]['valueOf'](),'date_include':_0x5ab66b});if(_0x2814f7[_0x172d40(0x1c6)]>0x0){let _0x1cdb97='';_0x1cdb97+=_0x2814f7[0x0][_0x172d40(0x1c2)];if(_0x88ce7a==_0x172d40(0x196)){const _0x48f2aa=cheerio['load'](_0x1cdb97);let _0x588055=[],_0x5727dc=[],_0x112239=[];const _0x46e1ab=_0x3dbe74=>{const _0x2a8819=_0x172d40,_0x187150={'top':{'style':_0x2a8819(0x111),'color':{'rgb':_0x2a8819(0x19d)}},'bottom':{'style':'thick','color':{'rgb':_0x2a8819(0x19d)}},'left':{'style':'thick','color':{'rgb':_0x2a8819(0x19d)}},'right':{'style':'thick','color':{'rgb':_0x2a8819(0x19d)}}};if(_0x3dbe74){const _0x48fe29=_0x3dbe74[_0x2a8819(0x21b)](';')[_0x2a8819(0x16c)]((_0x3ffc33,_0x5b3342)=>{const _0x1725a3=_0x2a8819,[_0x54201e,_0xe48075]=_0x5b3342['split'](':')[_0x1725a3(0x243)](_0x4cfae2=>_0x4cfae2[_0x1725a3(0x125)]());return _0x3ffc33[_0x54201e]=_0xe48075,_0x3ffc33;},{});_0x48fe29[_0x2a8819(0x167)]&&(_0x187150[_0x2a8819(0x1ed)][_0x2a8819(0x1d2)]=_0x48fe29['border-top'][_0x2a8819(0x1ba)](_0x2a8819(0x224))?_0x2a8819(0x224):_0x2a8819(0x1c0)),_0x48fe29[_0x2a8819(0x200)]&&(_0x187150['bottom']['style']=_0x48fe29[_0x2a8819(0x200)][_0x2a8819(0x1ba)]('thin')?'thin':_0x2a8819(0x1c0)),_0x48fe29[_0x2a8819(0x212)]&&(_0x187150[_0x2a8819(0x162)][_0x2a8819(0x1d2)]=_0x48fe29[_0x2a8819(0x212)][_0x2a8819(0x1ba)](_0x2a8819(0x224))?_0x2a8819(0x224):_0x2a8819(0x1c0)),_0x48fe29[_0x2a8819(0x1ce)]&&(_0x187150[_0x2a8819(0x216)][_0x2a8819(0x1d2)]=_0x48fe29[_0x2a8819(0x1ce)]['includes'](_0x2a8819(0x224))?_0x2a8819(0x224):'medium');}return _0x187150;};_0x48f2aa(_0x172d40(0x17c))[_0x172d40(0x23b)]((_0x5c902e,_0xd78edf)=>{const _0x496b39=_0x172d40;let _0x3b5516=[],_0x30be4f=0x0;while(_0x112239[_0x30be4f]){_0x112239[_0x30be4f]--,_0x30be4f++;}_0x48f2aa(_0xd78edf)[_0x496b39(0x288)](_0x496b39(0x153))[_0x496b39(0x23b)]((_0x2af7fc,_0xb27700)=>{const _0x221442=_0x496b39;let _0xd0030f=_0x48f2aa(_0xb27700)['text']()[_0x221442(0x125)](),_0x103137=parseFloat(_0xd0030f[_0x221442(0x1a8)](/,/g,''));isNaN(_0x103137)&&(_0x103137=_0xd0030f);let _0x71e400=parseInt(_0x48f2aa(_0xb27700)[_0x221442(0x1f4)](_0x221442(0x1f2)))||0x1,_0x28ab86=parseInt(_0x48f2aa(_0xb27700)[_0x221442(0x1f4)](_0x221442(0x18c)))||0x1;const _0x5146dd=_0x48f2aa(_0xb27700)[_0x221442(0x1f4)](_0x221442(0x1d2)),_0x1be17e=_0x46e1ab(_0x5146dd);_0x3b5516[_0x30be4f]={'v':_0x103137,'s':{'border':_0x1be17e}};(_0x71e400>0x1||_0x28ab86>0x1)&&_0x5727dc[_0x221442(0x1e5)]({'s':{'r':_0x5c902e,'c':_0x30be4f},'e':{'r':_0x5c902e+_0x28ab86-0x1,'c':_0x30be4f+_0x71e400-0x1}});for(let _0x69269a=0x0;_0x69269a<_0x71e400;_0x69269a++){_0x28ab86>0x1&&(_0x112239[_0x30be4f+_0x69269a]=_0x28ab86-0x1);}_0x30be4f+=_0x71e400;}),_0x588055[_0x496b39(0x1e5)](_0x3b5516);});const _0x4da269=XLSX[_0x172d40(0x256)][_0x172d40(0x1be)](),_0x3a0971=XLSX[_0x172d40(0x256)][_0x172d40(0x183)](_0x588055);_0x5727dc['length']>0x0&&(_0x3a0971['!merges']=_0x5727dc);_0x3a0971[_0x172d40(0x1b9)]=_0x588055[0x0][_0x172d40(0x243)](()=>({'wpx':0x64})),XLSX[_0x172d40(0x256)][_0x172d40(0x17e)](_0x4da269,_0x3a0971,'Sales\x20Report');const _0x56a02b=XLSX[_0x172d40(0x1fb)](_0x4da269,{'bookType':_0x172d40(0x11a),'type':_0x172d40(0x112)});_0x55a50a[_0x172d40(0x190)]('Content-Disposition',_0x172d40(0x246)),_0x55a50a[_0x172d40(0x190)]('Content-Type',_0x172d40(0x10b)),_0x55a50a[_0x172d40(0x1ac)](_0x56a02b);}else{let _0x2319b6='';_0x2319b6+=_0x1cdb97,_0x2319b6+='<script>',_0x2319b6+=_0x172d40(0x286),_0x2319b6+=_0x172d40(0x124),_0x2319b6+='};',_0x2319b6+='</script>',_0x55a50a['send'](_0x2319b6);}}else generateReferenceNumber(_0x5ab66b,_0x51ef1e['_id']['valueOf'](),_0x3b1df4)[_0x172d40(0x1d8)](async _0x47c6b0=>{const _0xcff475=_0x172d40,_0x23781b=await agentsdataDSICheck_DSRR(_0x5ab66b,_0x51ef1e[_0xcff475(0x129)][_0xcff475(0x1c3)](),_0x8554fb,_0x47c6b0);console[_0xcff475(0x1d7)](_0x23781b);let _0x232bb0=_0xcff475(0x247);_0x232bb0+='<div\x20class=\x22row\x22>',_0x232bb0+=_0xcff475(0x21f),_0x232bb0+=_0xcff475(0x25f),_0x232bb0+=_0x23781b,_0x232bb0+=_0xcff475(0x154),_0x232bb0+=_0xcff475(0x10e),_0x232bb0+=_0xcff475(0x10e);if(_0x23781b[_0xcff475(0x1c6)]>0x0){const _0x187243=await Reference[_0xcff475(0x261)]({'staff_id':_0x51ef1e[_0xcff475(0x129)]['valueOf'](),'referenceNumber':_0x47c6b0});_0x187243[_0xcff475(0x1c2)]=_0x232bb0,_0x187243[_0xcff475(0x174)]=_0x5ab66b,await _0x187243['save']();if(_0x88ce7a==_0xcff475(0x196)){const _0x10cbf=cheerio[_0xcff475(0x281)](_0x232bb0);let _0x35b4ad=[],_0x3a62eb=[],_0x3b7a71=[];const _0xd1b8b=_0x4d5142=>{const _0x5e941f=_0xcff475,_0x8ffe82={'top':{'style':_0x5e941f(0x111),'color':{'rgb':'000000'}},'bottom':{'style':_0x5e941f(0x111),'color':{'rgb':_0x5e941f(0x19d)}},'left':{'style':_0x5e941f(0x111),'color':{'rgb':_0x5e941f(0x19d)}},'right':{'style':_0x5e941f(0x111),'color':{'rgb':_0x5e941f(0x19d)}}};if(_0x4d5142){const _0x1e9285=_0x4d5142[_0x5e941f(0x21b)](';')['reduce']((_0x16ef92,_0x2e2f2c)=>{const _0x8a942d=_0x5e941f,[_0x142355,_0x3071a9]=_0x2e2f2c[_0x8a942d(0x21b)](':')[_0x8a942d(0x243)](_0x578c47=>_0x578c47[_0x8a942d(0x125)]());return _0x16ef92[_0x142355]=_0x3071a9,_0x16ef92;},{});_0x1e9285[_0x5e941f(0x167)]&&(_0x8ffe82[_0x5e941f(0x1ed)]['style']=_0x1e9285['border-top'][_0x5e941f(0x1ba)](_0x5e941f(0x224))?_0x5e941f(0x224):_0x5e941f(0x1c0)),_0x1e9285[_0x5e941f(0x200)]&&(_0x8ffe82['bottom'][_0x5e941f(0x1d2)]=_0x1e9285[_0x5e941f(0x200)][_0x5e941f(0x1ba)]('thin')?_0x5e941f(0x224):_0x5e941f(0x1c0)),_0x1e9285[_0x5e941f(0x212)]&&(_0x8ffe82['left'][_0x5e941f(0x1d2)]=_0x1e9285[_0x5e941f(0x212)]['includes'](_0x5e941f(0x224))?_0x5e941f(0x224):'medium'),_0x1e9285[_0x5e941f(0x1ce)]&&(_0x8ffe82[_0x5e941f(0x216)][_0x5e941f(0x1d2)]=_0x1e9285[_0x5e941f(0x1ce)][_0x5e941f(0x1ba)]('thin')?'thin':_0x5e941f(0x1c0));}return _0x8ffe82;};_0x10cbf(_0xcff475(0x17c))[_0xcff475(0x23b)]((_0x46ee71,_0x386a6e)=>{const _0x239d03=_0xcff475;let _0x588fed=[],_0x82a7ee=0x0;while(_0x3b7a71[_0x82a7ee]){_0x3b7a71[_0x82a7ee]--,_0x82a7ee++;}_0x10cbf(_0x386a6e)[_0x239d03(0x288)](_0x239d03(0x153))[_0x239d03(0x23b)]((_0x36c1a5,_0x4a91bc)=>{const _0x53c355=_0x239d03;let _0x9244dc=_0x10cbf(_0x4a91bc)[_0x53c355(0x1ab)]()[_0x53c355(0x125)](),_0x5f2224=parseFloat(_0x9244dc[_0x53c355(0x1a8)](/,/g,''));isNaN(_0x5f2224)&&(_0x5f2224=_0x9244dc);let _0x4d665a=parseInt(_0x10cbf(_0x4a91bc)[_0x53c355(0x1f4)](_0x53c355(0x1f2)))||0x1,_0x445487=parseInt(_0x10cbf(_0x4a91bc)[_0x53c355(0x1f4)](_0x53c355(0x18c)))||0x1;const _0xccd3a3=_0x10cbf(_0x4a91bc)['attr'](_0x53c355(0x1d2)),_0x3584f9=_0xd1b8b(_0xccd3a3);_0x588fed[_0x82a7ee]={'v':_0x5f2224,'s':{'border':_0x3584f9}};(_0x4d665a>0x1||_0x445487>0x1)&&_0x3a62eb[_0x53c355(0x1e5)]({'s':{'r':_0x46ee71,'c':_0x82a7ee},'e':{'r':_0x46ee71+_0x445487-0x1,'c':_0x82a7ee+_0x4d665a-0x1}});for(let _0x3cb573=0x0;_0x3cb573<_0x4d665a;_0x3cb573++){_0x445487>0x1&&(_0x3b7a71[_0x82a7ee+_0x3cb573]=_0x445487-0x1);}_0x82a7ee+=_0x4d665a;}),_0x35b4ad[_0x239d03(0x1e5)](_0x588fed);});const _0x26eced=XLSX[_0xcff475(0x256)][_0xcff475(0x1be)](),_0x185866=XLSX[_0xcff475(0x256)][_0xcff475(0x183)](_0x35b4ad);_0x3a62eb[_0xcff475(0x1c6)]>0x0&&(_0x185866[_0xcff475(0x282)]=_0x3a62eb);_0x185866[_0xcff475(0x1b9)]=_0x35b4ad[0x0][_0xcff475(0x243)](()=>({'wpx':0x64})),XLSX[_0xcff475(0x256)]['book_append_sheet'](_0x26eced,_0x185866,_0xcff475(0x207));const _0x228c19=XLSX[_0xcff475(0x1fb)](_0x26eced,{'bookType':_0xcff475(0x11a),'type':'buffer'});_0x55a50a[_0xcff475(0x190)](_0xcff475(0x199),_0xcff475(0x246)),_0x55a50a['setHeader'](_0xcff475(0x147),_0xcff475(0x10b)),_0x55a50a[_0xcff475(0x1ac)](_0x228c19);}else _0x232bb0+=_0xcff475(0x1e1),_0x232bb0+=_0xcff475(0x286),_0x232bb0+=_0xcff475(0x124),_0x232bb0+='};',_0x232bb0+='</script>',_0x55a50a['send'](_0x232bb0);}else await Reference[_0xcff475(0x245)]({'referenceNumber':_0x47c6b0}),_0x53e276[_0xcff475(0x252)](_0xcff475(0x22c),'No\x20data\x20was\x20Found!'),_0x55a50a['redirect'](_0xcff475(0x217));})[_0x172d40(0x227)](console[_0x172d40(0x1bf)]);}),router[a0_0x4b16db(0x209)]('/dsrr_admin/view',auth,async(_0x53169b,_0x429bd8)=>{const _0xe41ea5=a0_0x4b16db;try{const {username:_0x317492,email:_0x5d6840,role:_0x57cf1c}=_0x53169b[_0xe41ea5(0x10d)],_0x804169=_0x53169b[_0xe41ea5(0x10d)],_0x2da0f2=await profile[_0xe41ea5(0x261)]({'email':_0x804169[_0xe41ea5(0x194)]}),_0x83f615={'year':_0xe41ea5(0x234),'month':_0xe41ea5(0x1e8),'day':_0xe41ea5(0x234)},_0xc52d63=await master_shop[_0xe41ea5(0x288)]();console[_0xe41ea5(0x1d7)](_0xe41ea5(0x193),_0xc52d63);const _0x47fcee=await product[_0xe41ea5(0x288)]();console[_0xe41ea5(0x1d7)](_0xe41ea5(0x1a9),_0x47fcee);const _0x1b2b48=await warehouse[_0xe41ea5(0x240)]([{'$unwind':_0xe41ea5(0x1b7)},{'$lookup':{'from':_0xe41ea5(0x117),'localField':'product_details.product_name','foreignField':_0xe41ea5(0x18f),'as':_0xe41ea5(0x1a7)}},{'$unwind':_0xe41ea5(0x16f)},{'$project':{'product_name':_0xe41ea5(0x269),'product_stock':_0xe41ea5(0x157)}},{'$group':{'_id':_0xe41ea5(0x27e),'product_stock':{'$sum':_0xe41ea5(0x1e7)}}}]);console['log']('Products\x20warehouse_data',_0x1b2b48),_0x1b2b48[_0xe41ea5(0x289)](_0x4f497b=>{const _0x31365a=_0xe41ea5,_0x27616=_0x47fcee[_0x31365a(0x243)](_0x17af25=>{const _0x1c2261=_0x31365a;_0x17af25[_0x1c2261(0x18f)]==_0x4f497b[_0x1c2261(0x129)]&&(_0x17af25['stock']=parseInt(_0x17af25[_0x1c2261(0x24a)])+parseInt(_0x4f497b[_0x1c2261(0x26b)]));});});const _0x5f5951=await staff[_0xe41ea5(0x288)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x4522c4=await staff[_0xe41ea5(0x261)]({'email':_0x804169['email']});if(_0xc52d63[0x0][_0xe41ea5(0x1df)]=='English\x20(US)')var _0x279f80=users[_0xe41ea5(0x12b)];else{if(_0xc52d63[0x0]['language']==_0xe41ea5(0x171))var _0x279f80=users[_0xe41ea5(0x171)];else{if(_0xc52d63[0x0][_0xe41ea5(0x1df)]==_0xe41ea5(0x12a))var _0x279f80=users['German'];else{if(_0xc52d63[0x0][_0xe41ea5(0x1df)]==_0xe41ea5(0x13f))var _0x279f80=users[_0xe41ea5(0x13f)];else{if(_0xc52d63[0x0][_0xe41ea5(0x1df)]==_0xe41ea5(0x122))var _0x279f80=users[_0xe41ea5(0x122)];else{if(_0xc52d63[0x0][_0xe41ea5(0x1df)]==_0xe41ea5(0x14c))var _0x279f80=users[_0xe41ea5(0x1a5)];else{if(_0xc52d63[0x0]['language']=='Chinese')var _0x279f80=users['Chinese'];else{if(_0xc52d63[0x0][_0xe41ea5(0x1df)]==_0xe41ea5(0x145))var _0x279f80=users['Arabic'];}}}}}}}_0x429bd8['render']('dssr_view_admin',{'success':_0x53169b[_0xe41ea5(0x252)](_0xe41ea5(0x1c8)),'errors':_0x53169b[_0xe41ea5(0x252)](_0xe41ea5(0x22c)),'alldata':_0x47fcee,'profile':_0x2da0f2,'master_shop':_0xc52d63,'role':_0x804169,'product_stock':_0x1b2b48,'language':_0x279f80,'staff_arr':_0x4522c4,'staff_data_all':_0x5f5951});}catch(_0x1dce6e){}}),router[a0_0x4b16db(0x225)]('/getDSSR_no',auth,async(_0x12093e,_0x4efd99)=>{const _0x109b5b=a0_0x4b16db;try{const {from:_0x4b8434,to:_0x25a1d4,staff_data:_0xda814a}=_0x12093e[_0x109b5b(0x15c)],_0x3ebb78=await Reference[_0x109b5b(0x240)]([{'$match':{'date_include':{'$gte':_0x4b8434,'$lte':_0x25a1d4},'staff_id':_0xda814a}},{'$sort':{'date_include':0x1}}]);_0x4efd99['json'](_0x3ebb78);}catch(_0x3877a9){_0x4efd99[_0x109b5b(0x248)](_0x3877a9);}}),router['post']('/getDSSR_no_sales',auth,async(_0x3811ed,_0x1611b9)=>{const _0x50c08a=a0_0x4b16db;try{const {from:_0x49beeb,to:_0x182647}=_0x3811ed[_0x50c08a(0x15c)],{sttaff_id:_0x3e7f39}=_0x3811ed[_0x50c08a(0x10d)],_0x21fa85=await Reference[_0x50c08a(0x240)]([{'$match':{'date_include':{'$gte':_0x49beeb,'$lte':_0x182647},'staff_id':_0x3e7f39}},{'$sort':{'date_include':0x1}}]);_0x1611b9[_0x50c08a(0x248)](_0x21fa85);}catch(_0x5bc0c2){_0x1611b9[_0x50c08a(0x248)](_0x5bc0c2);}}),router[a0_0x4b16db(0x209)]('/dsrr_admin/view_data/:id',auth,async(_0x2706d7,_0x2a7f0f)=>{const _0x399094=a0_0x4b16db;try{const _0x34b149=_0x2706d7['params']['id'],_0x25fbb8=await Reference[_0x399094(0x149)](_0x34b149);let _0x103fc6='';_0x103fc6+=_0x25fbb8[_0x399094(0x1c2)],_0x103fc6+='<script>',_0x103fc6+=_0x399094(0x286),_0x103fc6+=_0x399094(0x124),_0x103fc6+='};',_0x103fc6+=_0x399094(0x219),_0x2a7f0f[_0x399094(0x1ac)](_0x103fc6);}catch(_0xf1c585){_0x2a7f0f[_0x399094(0x248)](_0xf1c585);}}),router[a0_0x4b16db(0x225)]('/dl_excel',auth,async(_0x3f9a99,_0x214c52)=>{const _0x52cb54=a0_0x4b16db;try{const {ref_data:_0x317467}=_0x3f9a99['body'],_0x67aabd=_0x317467['split']('~'),_0x39f25a=_0x67aabd['filter'](_0x622c04=>_0x622c04!==''),_0x1684f4=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x39f25a}}}]),_0x3bd6ef=XLSX[_0x52cb54(0x256)][_0x52cb54(0x1be)]();_0x1684f4[_0x52cb54(0x289)](_0x3594b2=>{const _0x17ba36=_0x52cb54,_0x3749e3=cheerio[_0x17ba36(0x281)](_0x3594b2['html']);let _0x31da6a=[],_0x4f63ad=[],_0x2352a2=[];_0x3749e3('table\x20tr')[_0x17ba36(0x23b)]((_0x5b2083,_0x51e7dd)=>{const _0x464a48=_0x17ba36;let _0x5e52d6=[],_0x3ccd35=0x0;while(_0x2352a2[_0x3ccd35]){_0x2352a2[_0x3ccd35]--,_0x3ccd35++;}_0x3749e3(_0x51e7dd)[_0x464a48(0x288)](_0x464a48(0x153))[_0x464a48(0x23b)]((_0x4c6b2f,_0x425891)=>{const _0x565c80=_0x464a48;let _0x55331e=_0x3749e3(_0x425891)['text']()[_0x565c80(0x125)](),_0x28be09=parseFloat(_0x55331e[_0x565c80(0x1a8)](/,/g,''));isNaN(_0x28be09)&&(_0x28be09=_0x55331e);let _0x560a27=parseInt(_0x3749e3(_0x425891)['attr'](_0x565c80(0x1f2)))||0x1,_0x3fa535=parseInt(_0x3749e3(_0x425891)[_0x565c80(0x1f4)]('rowspan'))||0x1;_0x5e52d6[_0x3ccd35]=_0x28be09;(_0x560a27>0x1||_0x3fa535>0x1)&&_0x4f63ad['push']({'s':{'r':_0x5b2083,'c':_0x3ccd35},'e':{'r':_0x5b2083+_0x3fa535-0x1,'c':_0x3ccd35+_0x560a27-0x1}});for(let _0x4f45ee=0x0;_0x4f45ee<_0x560a27;_0x4f45ee++){_0x3fa535>0x1&&(_0x2352a2[_0x3ccd35+_0x4f45ee]=_0x3fa535-0x1);}_0x3ccd35+=_0x560a27;}),_0x31da6a[_0x464a48(0x1e5)](_0x5e52d6);});const _0x490521=XLSX[_0x17ba36(0x256)][_0x17ba36(0x183)](_0x31da6a);_0x4f63ad[_0x17ba36(0x1c6)]>0x0&&(_0x490521[_0x17ba36(0x282)]=_0x4f63ad),_0x490521['!cols']=_0x31da6a[0x0][_0x17ba36(0x243)](()=>({'wpx':0x64})),XLSX[_0x17ba36(0x256)][_0x17ba36(0x17e)](_0x3bd6ef,_0x490521,_0x3594b2['referenceNumber']);});const _0x1a9a18=XLSX[_0x52cb54(0x1fb)](_0x3bd6ef,{'bookType':_0x52cb54(0x11a),'type':_0x52cb54(0x112)});_0x214c52['setHeader']('Content-Disposition',_0x52cb54(0x1b2)),_0x214c52[_0x52cb54(0x190)]('Content-Type',_0x52cb54(0x10b)),_0x214c52['send'](_0x1a9a18);}catch(_0x303373){_0x214c52[_0x52cb54(0x248)](_0x303373);}}),router[a0_0x4b16db(0x225)]('/dsrr_admin/pdf_admin',auth,async(_0x4afe21,_0x2e50c9)=>{const _0x158e9a=a0_0x4b16db,{from_date:_0x5145e6,agent_id:_0x52cda9}=_0x4afe21[_0x158e9a(0x15c)],_0x4175bf=_0x4afe21['user'],_0xf31664=await staff['findOne']({'email':_0x4175bf[_0x158e9a(0x194)]}),_0x2de639=await master_shop['find'](),_0x1527d8=await agentsdataDSICheck_DSRR(_0x5145e6,_0x52cda9,_0x44e07e);let _0x1db190=_0x158e9a(0x17b);var _0x303840=new Date(_0x5145e6);const _0x26d03c={'year':'numeric','month':_0x158e9a(0x1e8),'day':'numeric'},_0xa8348f=new Intl['DateTimeFormat']('en-US',_0x26d03c)[_0x158e9a(0x213)](_0x303840);_0x1db190+=_0x158e9a(0x173),_0x1db190+=_0x158e9a(0x21f),_0x1db190+=_0x158e9a(0x25f),_0x1db190+=_0x1527d8,_0x1db190+=_0x158e9a(0x154),_0x1db190+=_0x158e9a(0x10e),_0x1db190+=_0x158e9a(0x10e);let _0x58e780=_0x158e9a(0x22f);const _0x2062e1={'width':_0x158e9a(0x13b),'height':_0x158e9a(0x214),'orientation':_0x158e9a(0x142),'border':{'top':'0.1in','right':_0x158e9a(0x255),'bottom':'0.1in','left':_0x158e9a(0x255)},'header':{'height':_0x158e9a(0x287),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x58e780+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0xa8348f+_0x158e9a(0x182)},'footer':{'height':'20mm','contents':{'default':_0x158e9a(0x24c)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x158e9a(0x138)}}};var _0x44e07e='on';if(_0x44e07e=='on'){const _0x40800f=cheerio[_0x158e9a(0x281)](_0x1db190);let _0x15ceaf=[],_0x45428c=[],_0x287f8d=[];_0x40800f(_0x158e9a(0x17c))['each']((_0x43790f,_0x367fcb)=>{const _0x33a49c=_0x158e9a;let _0x244e23=[],_0x5e7845=0x0;while(_0x287f8d[_0x5e7845]){_0x287f8d[_0x5e7845]--,_0x5e7845++;}_0x40800f(_0x367fcb)[_0x33a49c(0x288)](_0x33a49c(0x153))['each']((_0x258b61,_0x23f60e)=>{const _0x2211a6=_0x33a49c;let _0x38f0f1=_0x40800f(_0x23f60e)[_0x2211a6(0x1ab)]()[_0x2211a6(0x125)](),_0x28af31=parseFloat(_0x38f0f1['replace'](/,/g,''));isNaN(_0x28af31)&&(_0x28af31=_0x38f0f1);let _0x3f7325=parseInt(_0x40800f(_0x23f60e)[_0x2211a6(0x1f4)](_0x2211a6(0x1f2)))||0x1,_0x353087=parseInt(_0x40800f(_0x23f60e)[_0x2211a6(0x1f4)]('rowspan'))||0x1;_0x244e23[_0x5e7845]=_0x28af31;(_0x3f7325>0x1||_0x353087>0x1)&&_0x45428c[_0x2211a6(0x1e5)]({'s':{'r':_0x43790f,'c':_0x5e7845},'e':{'r':_0x43790f+_0x353087-0x1,'c':_0x5e7845+_0x3f7325-0x1}});for(let _0x14396c=0x0;_0x14396c<_0x3f7325;_0x14396c++){_0x353087>0x1&&(_0x287f8d[_0x5e7845+_0x14396c]=_0x353087-0x1);}_0x5e7845+=_0x3f7325;}),_0x15ceaf['push'](_0x244e23);});const _0x1a165d=XLSX['utils'][_0x158e9a(0x1be)](),_0x38b06d=XLSX[_0x158e9a(0x256)][_0x158e9a(0x183)](_0x15ceaf);_0x45428c[_0x158e9a(0x1c6)]>0x0&&(_0x38b06d[_0x158e9a(0x282)]=_0x45428c);_0x38b06d[_0x158e9a(0x1b9)]=_0x15ceaf[0x0][_0x158e9a(0x243)](()=>({'wpx':0x64})),XLSX[_0x158e9a(0x256)]['book_append_sheet'](_0x1a165d,_0x38b06d,_0x158e9a(0x207));const _0x21c231=XLSX[_0x158e9a(0x1fb)](_0x1a165d,{'bookType':_0x158e9a(0x11a),'type':_0x158e9a(0x112)});_0x2e50c9['setHeader']('Content-Disposition',_0x158e9a(0x246)),_0x2e50c9['setHeader']('Content-Type',_0x158e9a(0x10b)),_0x2e50c9[_0x158e9a(0x1ac)](_0x21c231);}else pdf[_0x158e9a(0x27d)](_0x1db190,_0x2062e1)['toStream'](function(_0x4ffc73,_0x56b765){const _0x17d880=_0x158e9a;if(_0x4ffc73){_0x2e50c9[_0x17d880(0x27a)](0x1f4)['send'](_0x17d880(0x14f));return;}_0x2e50c9[_0x17d880(0x190)](_0x17d880(0x147),_0x17d880(0x202)),_0x56b765[_0x17d880(0x141)](_0x2e50c9);});}),module[a0_0x4b16db(0x133)]=router;