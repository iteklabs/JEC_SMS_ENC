const a0_0x12c55b=a0_0xb365;function a0_0xb365(_0x3917ba,_0x1fc4ad){const _0x1267a6=a0_0x1267();return a0_0xb365=function(_0xb365ab,_0x436bf5){_0xb365ab=_0xb365ab-0xfd;let _0x798c77=_0x1267a6[_0xb365ab];return _0x798c77;},a0_0xb365(_0x3917ba,_0x1fc4ad);}(function(_0x54789d,_0x299647){const _0xedc622=a0_0xb365,_0x140593=_0x54789d();while(!![]){try{const _0xfab7f9=-parseInt(_0xedc622(0x1c4))/0x1+parseInt(_0xedc622(0x1dd))/0x2*(-parseInt(_0xedc622(0x255))/0x3)+-parseInt(_0xedc622(0x217))/0x4+-parseInt(_0xedc622(0x1ef))/0x5+parseInt(_0xedc622(0x271))/0x6*(-parseInt(_0xedc622(0x1a5))/0x7)+-parseInt(_0xedc622(0x220))/0x8+parseInt(_0xedc622(0x100))/0x9;if(_0xfab7f9===_0x299647)break;else _0x140593['push'](_0x140593['shift']());}catch(_0x58f3ee){_0x140593['push'](_0x140593['shift']());}}}(a0_0x1267,0x4c567));const express=require(a0_0x12c55b(0x270)),res=require(a0_0x12c55b(0x19c)),app=express(),router=express[a0_0x12c55b(0x12a)](),multer=require(a0_0x12c55b(0x151)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x12c55b(0x250)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x12c55b(0x1cb)),XLSX=require(a0_0x12c55b(0x204)),PDFDocument=require('pdfkit-table'),fs=require('fs'),blobStream=require(a0_0x12c55b(0x15d)),JsBarcode=require(a0_0x12c55b(0x152)),{Canvas}=require(a0_0x12c55b(0x144)),pdf=require(a0_0x12c55b(0x1ed)),path=require(a0_0x12c55b(0x1ee)),mongoose=require(a0_0x12c55b(0x207)),cheerio=require(a0_0x12c55b(0x193));function a0_0x1267(){const _0x2a5658=['valueOf','PDF\x20Generation\x20Error:','book_append_sheet','English','ObjectId','aggregate','<td\x20colspan=\x223\x22><b>TOTAL<b>','toLocaleString','</thead>','errors','totalQty','replace','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','</b></td>','$products.product_details.prod_id','products','salesman_data','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','getDate','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','$products.product_details','border-top','product_name','discount','23819148zrwonG','note','/dl_excel','$sale_product.product_name','$products','balanced','$dsi','<th>\x20ITEM\x20CODE\x20</th>','</td>','buffer','language','<p>SALES\x20REPORTS</p>','$due_date','/dev/null','<th\x20colspan=\x272\x27>SOLD</th>','split','<td\x20class=\x22row_data\x22>0</td>','brandCount','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','create','French','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','beg_bal','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','$NetPrice','$_id.customer','totalQTY','setHeader','<td\x20class=\x22cat_data\x22>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','top','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','product_stock','$sale_product.isFG','Asia/Manila','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','Spanish','isArray','$product_details','$product_details.product_stock','Router','forEach','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','<th>Booking</th>','/agent_reports/pdf','post','Sales\x20Report','$date','$_id.category','<td\x20class=\x22row_data\x22></td>','$discount','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','$product_code','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','Content-Disposition','000000','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<div\x20\x20id=\x22table-conatainer\x22>','$sales_info.name','</tbody>','$product.quantity','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','$product_info.gross_price','Portuguese','canvas','0.1in','table\x20tr','$product_info.brand','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','<td\x20colspan=\x22','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','\x20-\x20','No\x20data\x20was\x20Found!','html','$_id.brand','_id','sale_product.product_code','multer','jsbarcode','<p>FINISHED\x20GOODS\x20INVENTORY</p>','\x22><b></b></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','redirect','$product.product_name','sumqty','cash','window.onload\x20=\x20function()\x20{','</script>','Arabic\x20(ae)','blob-stream','!merges','$product_stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','$check_no','toFixed','body','</th>','/agent_reports/sales_ad','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','dsi_sales_admin','$sales_staff_id','name','Types','60mm','sales_ext','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','utils','$sale_product.stock','$product_info.name','referenceNumber','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','send','attr','product_details.product_name','format','$products.product_details.brand','$adj_discount','/agent_reports/pdf_admin','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','20mm','!cols','sales_man_code','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','save','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','qty','German','Chinese','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','then','date','$_id.dsi','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','category','pipe','<div\x20style=\x22page-break-before:\x20always;\x22></div>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','NetPrice','cheerio','colspan','$product_list.product_name','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','aoa_to_sheet','load','flash','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','express/lib/response','dsi','true','/inventory_sum/pdf','NumberFormat','$product_info','agent_sales','$product_info.category','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','7xiQtAP','$sales_info','customer','toISOString','sales_bkg','$sale_product.prod_cat','$product_docs','$customer','$cash','$sale_product.product_code','$brand','DateTimeFormat','\x22><b>','brand','td,\x20th','$totalQty','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','<td\x20class=\x22row_data\x22>','/inventory_sum/view','thin','sales_info','<tbody>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','book_new','totalGross','trim','log','each','\x20-\x20HH','$_id.date','</tr>','66466XcVruR','product_details','<th>\x20INVOICE\x20AMOUNT\x20</th>','$product_details.product_name','<thead>','$sale_product.discount','<th>\x20ITEM\x20DESCRIPTION\x20</th>','exceljs','map','exports','Products\x20warehouse_data','rowspan','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','Error\x20generating\x20PDF','date_include','email','<td\x20class=\x22row_data\x22><b>','$sale_product.quantity','15in','en-US','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','json','staffs','$products.product_details.gross_price','/agent_reports/view','10pIgRJw','<p>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','Products\x20find_data','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','window.print();','$products.qty','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','/dsrr_admin/pdf_admin','<script>','8.5in','product_code','test','$_id.status_data','html-pdf','path','3103400xkoGBI','<th\x20rowspan=\x272\x27>Category</th>','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','$amount','product_docs','$products.NetPrice','landscape','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','/balance/view','$sale_product','get','\x22\x20class=\x22cat_data\x22>','<table>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','numeric','$status_data','$product','/reports/dsrr/view','<div\x20class=\x22row\x22>','/dsrr_admin/view','left','xlsx','border-right','error','mongoose','<th>\x20ENDING\x20BALANCE\x20</th>','Portuguese\x20(BR)','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','slice','$product_info.product_code','toLocaleDateString','<p>INVENTORY\x20SUMMARY</p>','</div>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','$product_list','<tr>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','isFG','2121292rqhHBF','text','$sale_product.totalprice','$bank','reduce','dssr_view','bottom','catch','application/pdf','3737840zBPPHg','$product_list.product_code','prod_cat','<td\x20class=\x22cat_data\x22></td>','Household','<div\x20class=\x22col-sm-11\x22>','adj_discount','amount','findById','long','Arabic','deleteOne','<th>\x20SALES\x20</th>','sort','dataqty','product_info','cat_brand','$sale_product.real_qty_unit_val','bank','image','border-left','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','render','success','$totalGross','totalPrice','thick','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','$category','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','length','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','user','border-bottom','dsi_sales','medium','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','/agent/view','findOne','</table>','$name','stock','push','$product.product_code','<th>\x20BEG\x20BALANCE\x20</th>','../models/all_models','includes','status','$sale_product.adj_discount','sales_reports','235281iYCsZz','Hindi','English\x20(US)','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','write','$product_list.product_stock','Products\x20master','find','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','Content-Type','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','$product_name','/dsrr/pdf','</p>','right','inventory_sum','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','$products.product_details.category','attachment;\x20filename=\x22sales_report.xlsx\x22','toStream','Letter','$products.discount','<h1>JAKA\x20EQUITIES\x20CORP</h1>','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','sales_staff_id','express','1542354nAXkqj','$products.adj_discount','excel','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','style','false'];a0_0x1267=function(){return _0x2a5658;};return a0_0x1267();}router[a0_0x12c55b(0x1f9)](a0_0x12c55b(0x1f7),auth,async(_0x3092db,_0x3da0f3)=>{const _0x524e95=a0_0x12c55b;try{const {username:_0xdd334a,email:_0x292cad,role:_0x8031c8}=_0x3092db[_0x524e95(0x242)],_0x5272bc=_0x3092db[_0x524e95(0x242)],_0x1e5e56=await profile['findOne']({'email':_0x5272bc[_0x524e95(0x1d3)]}),_0x2ab54c={'year':_0x524e95(0x1fd),'month':_0x524e95(0x229),'day':_0x524e95(0x1fd)},_0x4f36b6=await master_shop[_0x524e95(0x25d)]();console['log'](_0x524e95(0x25c),_0x4f36b6);const _0x197ce0=await product[_0x524e95(0x25d)]();console['log'](_0x524e95(0x1e2),_0x197ce0);const _0x54f276=await warehouse[_0x524e95(0x27d)]([{'$unwind':_0x524e95(0x128)},{'$lookup':{'from':_0x524e95(0x287),'localField':'product_details.product_name','foreignField':'name','as':_0x524e95(0x1f3)}},{'$unwind':_0x524e95(0x1ab)},{'$project':{'product_name':_0x524e95(0x1c7),'product_stock':_0x524e95(0x129)}},{'$group':{'_id':_0x524e95(0x262),'product_stock':{'$sum':_0x524e95(0x15f)}}}]);console['log'](_0x524e95(0x1ce),_0x54f276),_0x54f276[_0x524e95(0x12b)](_0x444a95=>{const _0x156556=_0x197ce0['map'](_0x23b891=>{const _0xca409b=a0_0xb365;_0x23b891[_0xca409b(0x16a)]==_0x444a95['_id']&&(_0x23b891[_0xca409b(0x24c)]=parseInt(_0x23b891[_0xca409b(0x24c)])+parseInt(_0x444a95[_0xca409b(0x120)]));});}),console[_0x524e95(0x1bf)]('Products\x20find_data',_0x197ce0);if(_0x4f36b6[0x0][_0x524e95(0x10a)]==_0x524e95(0x257))var _0x4797b7=users[_0x524e95(0x27b)];else{if(_0x4f36b6[0x0][_0x524e95(0x10a)]==_0x524e95(0x256))var _0x4797b7=users[_0x524e95(0x256)];else{if(_0x4f36b6[0x0][_0x524e95(0x10a)]=='German')var _0x4797b7=users['German'];else{if(_0x4f36b6[0x0][_0x524e95(0x10a)]==_0x524e95(0x126))var _0x4797b7=users[_0x524e95(0x126)];else{if(_0x4f36b6[0x0][_0x524e95(0x10a)]=='French')var _0x4797b7=users[_0x524e95(0x114)];else{if(_0x4f36b6[0x0][_0x524e95(0x10a)]=='Portuguese\x20(BR)')var _0x4797b7=users['Portuguese'];else{if(_0x4f36b6[0x0][_0x524e95(0x10a)]==_0x524e95(0x188))var _0x4797b7=users[_0x524e95(0x188)];else{if(_0x4f36b6[0x0][_0x524e95(0x10a)]==_0x524e95(0x15c))var _0x4797b7=users[_0x524e95(0x22a)];}}}}}}}_0x3da0f3[_0x524e95(0x237)](_0x524e95(0x105),{'success':_0x3092db['flash'](_0x524e95(0x238)),'errors':_0x3092db[_0x524e95(0x19a)](_0x524e95(0x281)),'alldata':_0x197ce0,'profile':_0x1e5e56,'master_shop':_0x4f36b6,'role':_0x5272bc,'product_stock':_0x54f276,'language':_0x4797b7});}catch(_0x3b3f78){}});async function dataCheck(_0x41f457,_0x31fae4){const _0x48f36e=a0_0x12c55b,_0x16c09e=await product[_0x48f36e(0x27d)]([{'$group':{'_id':{'brand':'$brand','category':_0x48f36e(0x23d)},'products':{'$push':{'name':_0x48f36e(0x24b),'product_code':_0x48f36e(0x138)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2613b4=[];_0x2613b4[_0x48f36e(0x230)]=[];for(let _0xd35b6e=0x0;_0xd35b6e<=_0x16c09e[_0x48f36e(0x23f)]-0x1;_0xd35b6e++){const _0x29fb6c=_0x16c09e[_0xd35b6e];_0x2613b4[_0x48f36e(0x230)][_0x48f36e(0x24d)](_0x29fb6c);}const _0x2b5f55=await product[_0x48f36e(0x27d)]([{'$group':{'_id':{'category':_0x48f36e(0x23d)},'products':{'$push':{'brand':_0x48f36e(0x1af),'product_code':_0x48f36e(0x138),'product_name':_0x48f36e(0x24b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1b3da9=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x41f457,'$lte':_0x31fae4}}},{'$unwind':_0x48f36e(0x1ff)},{'$group':{'_id':{'product_name':_0x48f36e(0x157),'product_code':_0x48f36e(0x24e)},'totalQTY':{'$sum':_0x48f36e(0x140)}}}]);_0x2613b4['beg_bal']=[];for(let _0x811cfc=0x0;_0x811cfc<=_0x1b3da9[_0x48f36e(0x23f)]-0x1;_0x811cfc++){const _0x56563f=_0x1b3da9[_0x811cfc];_0x2613b4[_0x48f36e(0x116)]['push'](_0x56563f);}const _0x1cf546=await sales_sa[_0x48f36e(0x27d)]([{'$match':{'date':{'$gte':_0x41f457,'$lte':_0x31fae4}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x48f36e(0x169)}}},{'$lookup':{'from':_0x48f36e(0x1da),'localField':'sales_staff_id','foreignField':_0x48f36e(0x14f),'as':_0x48f36e(0x1b9)}},{'$unwind':_0x48f36e(0x1a6)},{'$unwind':_0x48f36e(0x1f8)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x48f36e(0x103),'product_code':_0x48f36e(0x1ae)},'totalQTY':{'$sum':_0x48f36e(0x1d5)}}}]);console['log'](_0x1cf546[0x0]),_0x2613b4['sales_bkg']=[];for(let _0x352ad6=0x0;_0x352ad6<=_0x1cf546[_0x48f36e(0x23f)]-0x1;_0x352ad6++){const _0x2bdf2b=_0x1cf546[_0x352ad6];_0x2613b4[_0x48f36e(0x1a9)]['push'](_0x2bdf2b);}const _0x1367d0=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x41f457,'$lte':_0x31fae4}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x48f36e(0x169)}}},{'$lookup':{'from':_0x48f36e(0x1da),'localField':'sales_staff_id','foreignField':'_id','as':'sales_info'}},{'$unwind':_0x48f36e(0x1a6)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x48f36e(0x277)}},{'$group':{'_id':{'product_name':_0x48f36e(0x103),'product_code':_0x48f36e(0x1ae)},'totalQTY':{'$sum':_0x48f36e(0x231)}}}]);_0x2613b4[_0x48f36e(0x16d)]=[];for(let _0x46a2d0=0x0;_0x46a2d0<=_0x1367d0[_0x48f36e(0x23f)]-0x1;_0x46a2d0++){const _0x20f93b=_0x1367d0[_0x46a2d0];_0x2613b4['sales_ext'][_0x48f36e(0x24d)](_0x20f93b);}let _0x53f699='';for(let _0x56f8ee=0x0;_0x56f8ee<=_0x2b5f55[_0x48f36e(0x23f)]-0x1;_0x56f8ee++){const _0x5b3310=_0x2b5f55[_0x56f8ee];_0x53f699+='<tr>',_0x53f699+=_0x48f36e(0x174)+_0x5b3310[_0x48f36e(0x14f)]['category']+_0x48f36e(0x108),_0x53f699+='</tr>';for(let _0x4295e8=0x0;_0x4295e8<_0x2613b4['cat_brand'][_0x48f36e(0x23f)];_0x4295e8++){const _0x34b783=_0x2613b4[_0x48f36e(0x230)][_0x4295e8];if(_0x34b783['_id'][_0x48f36e(0x18e)]==_0x5b3310[_0x48f36e(0x14f)][_0x48f36e(0x18e)]){let _0x12c92e=[],_0x58142c=[],_0x3ad726=[];_0x12c92e[_0x34b783['_id']['brand']]=[],_0x58142c[_0x34b783[_0x48f36e(0x14f)][_0x48f36e(0x1b2)]]=[],_0x3ad726[_0x34b783[_0x48f36e(0x14f)][_0x48f36e(0x1b2)]]=[];var _0x3ef492=0x0,_0x1ac6a7=0x0,_0x4c5b9a=0x0;for(let _0x40d21d=0x0;_0x40d21d<_0x34b783[_0x48f36e(0x287)]['length'];_0x40d21d++){const _0x606ad7=_0x34b783[_0x48f36e(0x287)][_0x40d21d];for(let _0x44c241=0x0;_0x44c241<=_0x2613b4[_0x48f36e(0x116)][_0x48f36e(0x23f)]-0x1;_0x44c241++){const _0x112f4d=_0x2613b4['beg_bal'][_0x44c241];_0x112f4d[_0x48f36e(0x14f)][_0x48f36e(0xfe)]==_0x606ad7['name']&&_0x112f4d[_0x48f36e(0x14f)][_0x48f36e(0x1ea)]==_0x606ad7[_0x48f36e(0x1ea)]&&(_0x3ef492+=parseInt(_0x112f4d[_0x48f36e(0x11a)],0xa));}for(let _0x47ab9e=0x0;_0x47ab9e<=_0x2613b4['sales_ext'][_0x48f36e(0x23f)]-0x1;_0x47ab9e++){const _0x542453=_0x2613b4[_0x48f36e(0x16d)][_0x47ab9e];_0x542453[_0x48f36e(0x14f)][_0x48f36e(0xfe)]==_0x606ad7[_0x48f36e(0x16a)]&&_0x542453[_0x48f36e(0x14f)][_0x48f36e(0x1ea)]==_0x606ad7[_0x48f36e(0x1ea)]&&(_0x1ac6a7+=parseFloat(_0x542453[_0x48f36e(0x11a)],0xa)[_0x48f36e(0x162)](0x2));}for(let _0x5252a2=0x0;_0x5252a2<=_0x2613b4['sales_bkg'][_0x48f36e(0x23f)]-0x1;_0x5252a2++){const _0x581d80=_0x2613b4['sales_bkg'][_0x5252a2];_0x581d80[_0x48f36e(0x14f)]['product_name']==_0x606ad7['name']&&_0x581d80['_id']['product_code']==_0x606ad7[_0x48f36e(0x1ea)]&&(_0x4c5b9a+=parseInt(_0x581d80['totalQTY'],0xa));}}const _0x1aa82d=new Intl[(_0x48f36e(0x1a0))](_0x48f36e(0x1d7));var _0x31e6b4=_0x1aa82d[_0x48f36e(0x17a)](_0x3ef492);_0x12c92e[_0x34b783['_id'][_0x48f36e(0x1b2)]][_0x48f36e(0x24d)](_0x31e6b4),_0x58142c[_0x34b783[_0x48f36e(0x14f)][_0x48f36e(0x1b2)]][_0x48f36e(0x24d)](_0x1aa82d['format'](_0x1ac6a7)),_0x3ad726[_0x34b783[_0x48f36e(0x14f)][_0x48f36e(0x1b2)]]['push'](_0x1aa82d[_0x48f36e(0x17a)](_0x4c5b9a));var _0x160f4e=_0x1aa82d[_0x48f36e(0x17a)](_0x3ef492-(_0x4c5b9a+_0x1ac6a7));_0x53f699+='<tr>',_0x53f699+=_0x48f36e(0x135),_0x53f699+=_0x48f36e(0x1b6)+_0x34b783['_id'][_0x48f36e(0x1b2)]+_0x48f36e(0x108),_0x53f699+=_0x48f36e(0x1b6)+_0x12c92e[_0x34b783[_0x48f36e(0x14f)][_0x48f36e(0x1b2)]][0x0]+'</td>',_0x53f699+=_0x48f36e(0x110),_0x53f699+=_0x48f36e(0x1b6)+_0x3ad726[_0x34b783[_0x48f36e(0x14f)][_0x48f36e(0x1b2)]][0x0]+_0x48f36e(0x108),_0x53f699+=_0x48f36e(0x1b6)+_0x58142c[_0x34b783[_0x48f36e(0x14f)][_0x48f36e(0x1b2)]][0x0]+_0x48f36e(0x108),_0x53f699+=_0x48f36e(0x1b6)+_0x160f4e+_0x48f36e(0x108),_0x53f699+=_0x48f36e(0x1c3);}}}return console[_0x48f36e(0x1bf)](_0x2613b4[_0x48f36e(0x1a9)]),_0x53f699;}router[a0_0x12c55b(0x131)]('/balance/pdf',auth,async(_0x823459,_0x451885)=>{const _0x4a3890=a0_0x12c55b,{from_date:_0x4bfafb,to_date:_0x2494db}=_0x823459[_0x4a3890(0x163)],_0x134e70=await dataCheck(_0x4bfafb,_0x2494db);{}let _0xce3fb6=_0x4a3890(0x124);var _0x27c925=new Date(_0x4bfafb),_0x37b105=new Date(_0x2494db);const _0x2829e2={'year':_0x4a3890(0x1fd),'month':'long','day':_0x4a3890(0x1fd)},_0x2bb0c9=new Intl[(_0x4a3890(0x1b0))](_0x4a3890(0x1d7),_0x2829e2)[_0x4a3890(0x17a)](_0x27c925),_0x59393c=new Intl[(_0x4a3890(0x1b0))]('en-US',_0x2829e2)['format'](_0x37b105);_0xce3fb6+=_0x4a3890(0x26d),_0xce3fb6+=_0x4a3890(0x153),_0xce3fb6+=_0x4a3890(0x1de)+_0x2bb0c9+'\x20-\x20'+_0x59393c+_0x4a3890(0x264),_0xce3fb6+=_0x4a3890(0x201),_0xce3fb6+=_0x4a3890(0x225),_0xce3fb6+=_0x4a3890(0x1fb),_0xce3fb6+=_0x4a3890(0x214),_0xce3fb6+=_0x4a3890(0x1f0),_0xce3fb6+='<th\x20rowspan=\x272\x27>Products</th>',_0xce3fb6+=_0x4a3890(0x1f1)+_0x2bb0c9+'</th>',_0xce3fb6+='<th\x20rowspan=\x272\x27>Production</th>',_0xce3fb6+=_0x4a3890(0x10e),_0xce3fb6+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x59393c+_0x4a3890(0x164),_0xce3fb6+='</tr>',_0xce3fb6+='<tr>',_0xce3fb6+=_0x4a3890(0x12f),_0xce3fb6+='<th>X-Truck</th>',_0xce3fb6+=_0x4a3890(0x1c3),_0xce3fb6+=_0x134e70,_0xce3fb6+=_0x4a3890(0x24a),_0xce3fb6+=_0x4a3890(0x210),_0xce3fb6+=_0x4a3890(0x210);const _0x22a4d1={'format':'Letter','orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x4a3890(0x10d)}}};pdf[_0x4a3890(0x113)](_0xce3fb6,_0x22a4d1)['toStream'](function(_0x1e06a8,_0x2f1dde){const _0x1c9fdb=_0x4a3890;if(_0x1e06a8){_0x451885[_0x1c9fdb(0x252)](0x1f4)['send'](_0x1c9fdb(0x1d1));return;}_0x451885[_0x1c9fdb(0x11b)](_0x1c9fdb(0x260),_0x1c9fdb(0x21f)),_0x2f1dde['pipe'](_0x451885);});}),router[a0_0x12c55b(0x1f9)](a0_0x12c55b(0x248),auth,async(_0x209f5f,_0x267d8b)=>{const _0x589390=a0_0x12c55b;try{const {username:_0x2deeb3,email:_0x50c1d6,role:_0x5c50b5}=_0x209f5f[_0x589390(0x242)],_0x11cf9a=_0x209f5f[_0x589390(0x242)],_0x19a5d8=await profile[_0x589390(0x249)]({'email':_0x11cf9a['email']}),_0x2be68b={'year':_0x589390(0x1fd),'month':_0x589390(0x229),'day':_0x589390(0x1fd)},_0x3817c7=await master_shop[_0x589390(0x25d)](),_0x3bc5e7=await product['find'](),_0x1b6dce=await warehouse[_0x589390(0x27d)]([{'$unwind':_0x589390(0x128)},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':'name','as':_0x589390(0x1f3)}},{'$unwind':_0x589390(0x1ab)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x589390(0x129)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x589390(0x15f)}}}]);if(_0x3817c7[0x0]['language']==_0x589390(0x257))var _0x3879d8=users['English'];else{if(_0x3817c7[0x0][_0x589390(0x10a)]==_0x589390(0x256))var _0x3879d8=users[_0x589390(0x256)];else{if(_0x3817c7[0x0][_0x589390(0x10a)]==_0x589390(0x187))var _0x3879d8=users['German'];else{if(_0x3817c7[0x0][_0x589390(0x10a)]==_0x589390(0x126))var _0x3879d8=users[_0x589390(0x126)];else{if(_0x3817c7[0x0][_0x589390(0x10a)]=='French')var _0x3879d8=users[_0x589390(0x114)];else{if(_0x3817c7[0x0][_0x589390(0x10a)]==_0x589390(0x209))var _0x3879d8=users[_0x589390(0x143)];else{if(_0x3817c7[0x0]['language']==_0x589390(0x188))var _0x3879d8=users[_0x589390(0x188)];else{if(_0x3817c7[0x0][_0x589390(0x10a)]==_0x589390(0x15c))var _0x3879d8=users[_0x589390(0x22a)];}}}}}}}_0x267d8b[_0x589390(0x237)](_0x589390(0x1a2),{'success':_0x209f5f[_0x589390(0x19a)](_0x589390(0x238)),'errors':_0x209f5f[_0x589390(0x19a)]('errors'),'alldata':_0x3bc5e7,'profile':_0x19a5d8,'master_shop':_0x3817c7,'role':_0x11cf9a,'product_stock':_0x1b6dce,'language':_0x3879d8});}catch(_0x44cb6f){}});async function agentsdataCheck(_0x1e88a8,_0xbd20){const _0x116465=a0_0x12c55b,_0x1902ee=await product[_0x116465(0x27d)]([{'$group':{'_id':{'brand':_0x116465(0x1af),'category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x36f2a8=[];_0x36f2a8[_0x116465(0x230)]=[];for(let _0xa478d=0x0;_0xa478d<=_0x1902ee[_0x116465(0x23f)]-0x1;_0xa478d++){const _0x12bfe1=_0x1902ee[_0xa478d];_0x36f2a8[_0x116465(0x230)][_0x116465(0x24d)](_0x12bfe1);}const _0x497c5e=await product[_0x116465(0x27d)]([{'$group':{'_id':{'category':_0x116465(0x23d)},'products':{'$push':{'brand':'$brand','product_code':_0x116465(0x138),'product_name':_0x116465(0x24b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x57df36=await product[_0x116465(0x27d)]([{'$group':{'_id':{'category':_0x116465(0x23d),'brand':'$brand'}}},{'$group':{'_id':_0x116465(0x134),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4f7d29=await sales_sa[_0x116465(0x27d)]([{'$match':{'date':{'$gte':_0x1e88a8,'$lte':_0xbd20}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x116465(0x169)}}},{'$lookup':{'from':_0x116465(0x1da),'localField':_0x116465(0x26f),'foreignField':'_id','as':_0x116465(0x1b9)}},{'$unwind':_0x116465(0x1a6)},{'$unwind':_0x116465(0x1f8)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x116465(0x277)}},{'$lookup':{'from':_0x116465(0x287),'localField':_0x116465(0x150),'foreignField':_0x116465(0x1ea),'as':_0x116465(0x22f)}},{'$unwind':_0x116465(0x1a1)},{'$group':{'_id':{'sales_id':'$sales_info._id','category':_0x116465(0x1a3),'brand':_0x116465(0x147)},'salesman_data':{'$first':_0x116465(0x13e)},'totalQTY':{'$sum':_0x116465(0x231)},'products':{'$push':{'qty':_0x116465(0x231),'product_details':{'prod_name':_0x116465(0x171),'product_code':_0x116465(0x20d),'category':_0x116465(0x1a3),'brand':_0x116465(0x147)}}}}}]);let _0x42e2df='';_0x42e2df+=_0x116465(0x214),_0x42e2df+=_0x116465(0x1fc),_0x42e2df+=_0x116465(0x1c3),_0x42e2df+='<tr>',_0x42e2df+='<td\x20class=\x22cat_data\x22></td>';for(let _0x2695c9=0x0;_0x2695c9<=_0x497c5e[_0x116465(0x23f)]-0x1;_0x2695c9++){const _0x11452e=_0x497c5e[_0x2695c9];for(let _0x46fe05=0x0;_0x46fe05<_0x57df36[_0x116465(0x23f)];_0x46fe05++){const _0x559949=_0x57df36[_0x46fe05];_0x559949['_id']==_0x11452e[_0x116465(0x14f)][_0x116465(0x18e)]&&(_0x42e2df+='<td\x20colspan=\x22'+_0x559949['brandCount']+_0x116465(0x1fa)+_0x11452e['_id']['category']+_0x116465(0x108));}}_0x42e2df+=_0x116465(0x223),_0x42e2df+=_0x116465(0x1c3),_0x42e2df+=_0x116465(0x214),_0x42e2df+=_0x116465(0x1df);for(let _0xf784d7=0x0;_0xf784d7<=_0x497c5e[_0x116465(0x23f)]-0x1;_0xf784d7++){const _0x41a8c1=_0x497c5e[_0xf784d7];for(let _0x488140=0x0;_0x488140<_0x36f2a8[_0x116465(0x230)]['length'];_0x488140++){const _0x476b7c=_0x36f2a8[_0x116465(0x230)][_0x488140];_0x476b7c[_0x116465(0x14f)][_0x116465(0x18e)]==_0x41a8c1[_0x116465(0x14f)][_0x116465(0x18e)]&&(_0x42e2df+=_0x116465(0x11c)+_0x476b7c['_id'][_0x116465(0x1b2)]+_0x116465(0x108));}}_0x42e2df+=_0x116465(0x241),_0x42e2df+=_0x116465(0x1c3);let _0x43b1d9={'name':[],'dataqty':{}};for(let _0x1b3588=0x0;_0x1b3588<_0x36f2a8[_0x116465(0x230)][_0x116465(0x23f)];_0x1b3588++){const _0x4deef6=_0x36f2a8[_0x116465(0x230)][_0x1b3588],_0x40bc35=_0x4deef6[_0x116465(0x14f)][_0x116465(0x1b2)],_0x28af73=_0x4deef6[_0x116465(0x14f)][_0x116465(0x18e)];!_0x43b1d9['dataqty'][_0x40bc35]&&(_0x43b1d9[_0x116465(0x22e)][_0x40bc35]={});!_0x43b1d9[_0x116465(0x22e)][_0x40bc35][_0x28af73]&&(_0x43b1d9['dataqty'][_0x40bc35][_0x28af73]=[]);for(let _0x40ffc2=0x0;_0x40ffc2<_0x4f7d29['length'];_0x40ffc2++){const _0x20eff8=_0x4f7d29[_0x40ffc2];if(_0x40bc35===_0x20eff8[_0x116465(0x14f)][_0x116465(0x1b2)]&&_0x28af73===_0x20eff8[_0x116465(0x14f)][_0x116465(0x18e)]){const _0x41c34a=_0x20eff8[_0x116465(0x288)];!_0x43b1d9[_0x116465(0x22e)][_0x40bc35][_0x28af73][_0x41c34a]&&(_0x43b1d9['dataqty'][_0x40bc35][_0x28af73][_0x41c34a]=[]),_0x43b1d9[_0x116465(0x22e)][_0x40bc35][_0x28af73][_0x41c34a][_0x116465(0x24d)](_0x20eff8[_0x116465(0x11a)]),!_0x43b1d9[_0x116465(0x16a)][_0x116465(0x251)](_0x41c34a)&&_0x43b1d9[_0x116465(0x16a)][_0x116465(0x24d)](_0x41c34a);}}}_0x42e2df+=_0x116465(0x214);for(let _0x3fe7e9=0x0;_0x3fe7e9<=_0x43b1d9[_0x116465(0x16a)][_0x116465(0x23f)]-0x1;_0x3fe7e9++){const _0x52f755=_0x43b1d9['name'][_0x3fe7e9];_0x42e2df+=_0x116465(0x1b6)+_0x52f755+_0x116465(0x108);var _0x478a53=0x0,_0x6c61c5=0x0;for(let _0x5eb5ab=0x0;_0x5eb5ab<=_0x36f2a8[_0x116465(0x230)][_0x116465(0x23f)]-0x1;_0x5eb5ab++){const _0x5caaa8=_0x36f2a8[_0x116465(0x230)][_0x5eb5ab];var _0x40104f=0x0;_0x43b1d9[_0x116465(0x22e)][_0x5caaa8[_0x116465(0x14f)]['brand']][_0x5caaa8[_0x116465(0x14f)][_0x116465(0x18e)]][_0x52f755]?(_0x40104f=_0x43b1d9['dataqty'][_0x5caaa8[_0x116465(0x14f)]['brand']][_0x5caaa8['_id'][_0x116465(0x18e)]][_0x52f755][0x0],_0x42e2df+=_0x116465(0x1b6)+formatNumber(_0x40104f[_0x116465(0x162)](0x2))+_0x116465(0x108)):(_0x40104f=0x0,_0x42e2df+=_0x116465(0x1b6)+_0x40104f+_0x116465(0x108)),_0x478a53+=_0x40104f;}_0x42e2df+=_0x116465(0x1b6)+formatNumber(_0x478a53['toFixed'](0x2))+_0x116465(0x108);}return _0x42e2df+='</tr>',_0x42e2df;}router[a0_0x12c55b(0x131)]('/agent/pdf',auth,async(_0x28ad69,_0x2e6714)=>{const _0x21192d=a0_0x12c55b,{from_date:_0x47a184,to_date:_0x3cbba0}=_0x28ad69[_0x21192d(0x163)],_0x2995c2=await agentsdataCheck(_0x47a184,_0x3cbba0);{}let _0x5a0565=_0x21192d(0x112);var _0x289ad4=new Date(_0x47a184),_0x4d5c31=new Date(_0x3cbba0);const _0x42e095={'year':_0x21192d(0x1fd),'month':_0x21192d(0x229),'day':'numeric'},_0x53c414=new Intl[(_0x21192d(0x1b0))](_0x21192d(0x1d7),_0x42e095)[_0x21192d(0x17a)](_0x289ad4),_0x39f772=new Intl['DateTimeFormat'](_0x21192d(0x1d7),_0x42e095)['format'](_0x4d5c31);_0x5a0565+=_0x21192d(0x26d),_0x5a0565+=_0x21192d(0x10b),_0x5a0565+='<p>'+_0x53c414+_0x21192d(0x14b)+_0x39f772+_0x21192d(0x264),_0x5a0565+=_0x21192d(0x201),_0x5a0565+=_0x21192d(0x225),_0x5a0565+=_0x21192d(0x1fb),_0x5a0565+=_0x2995c2,_0x5a0565+=_0x21192d(0x24a),_0x5a0565+='</div>',_0x5a0565+=_0x21192d(0x210);const _0x5ada8c={'format':_0x21192d(0x26b),'orientation':_0x21192d(0x1f5),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x21192d(0x10d)}}};pdf[_0x21192d(0x113)](_0x5a0565,_0x5ada8c)['toStream'](function(_0x189bf3,_0x5a84d5){const _0x35fb17=_0x21192d;if(_0x189bf3){_0x2e6714[_0x35fb17(0x252)](0x1f4)[_0x35fb17(0x177)](_0x35fb17(0x1d1));return;}_0x2e6714[_0x35fb17(0x11b)](_0x35fb17(0x260),'application/pdf'),_0x5a84d5[_0x35fb17(0x18f)](_0x2e6714);});}),router[a0_0x12c55b(0x1f9)](a0_0x12c55b(0x165),auth,async(_0x52587a,_0xecad61)=>{const _0x4ab408=a0_0x12c55b;try{const {username:_0x3c83b2,email:_0x2a051c,role:_0x28696e}=_0x52587a['user'],_0x21f94c=_0x52587a[_0x4ab408(0x242)],_0x44ad3e=await profile[_0x4ab408(0x249)]({'email':_0x21f94c[_0x4ab408(0x1d3)]}),_0x3a2a92={'year':_0x4ab408(0x1fd),'month':_0x4ab408(0x229),'day':_0x4ab408(0x1fd)},_0x22f796=await master_shop[_0x4ab408(0x25d)](),_0xc28e61=await staff[_0x4ab408(0x249)]({'email':_0x21f94c['email']}),_0x106f71=await product[_0x4ab408(0x25d)](),_0x296900=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x4ab408(0x287),'localField':_0x4ab408(0x179),'foreignField':'name','as':_0x4ab408(0x1f3)}},{'$unwind':_0x4ab408(0x1ab)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x4ab408(0x129)}},{'$group':{'_id':_0x4ab408(0x262),'product_stock':{'$sum':'$product_stock'}}}]),_0x3ea78e=await staff[_0x4ab408(0x25d)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x22f796[0x0]['language']=='English\x20(US)')var _0x1ec132=users[_0x4ab408(0x27b)];else{if(_0x22f796[0x0][_0x4ab408(0x10a)]==_0x4ab408(0x256))var _0x1ec132=users[_0x4ab408(0x256)];else{if(_0x22f796[0x0][_0x4ab408(0x10a)]=='German')var _0x1ec132=users[_0x4ab408(0x187)];else{if(_0x22f796[0x0][_0x4ab408(0x10a)]==_0x4ab408(0x126))var _0x1ec132=users['Spanish'];else{if(_0x22f796[0x0]['language']=='French')var _0x1ec132=users['French'];else{if(_0x22f796[0x0]['language']==_0x4ab408(0x209))var _0x1ec132=users[_0x4ab408(0x143)];else{if(_0x22f796[0x0]['language']==_0x4ab408(0x188))var _0x1ec132=users[_0x4ab408(0x188)];else{if(_0x22f796[0x0][_0x4ab408(0x10a)]==_0x4ab408(0x15c))var _0x1ec132=users[_0x4ab408(0x22a)];}}}}}}}_0xecad61[_0x4ab408(0x237)](_0x4ab408(0x168),{'success':_0x52587a[_0x4ab408(0x19a)](_0x4ab408(0x238)),'errors':_0x52587a[_0x4ab408(0x19a)]('errors'),'alldata':_0x106f71,'profile':_0x44ad3e,'master_shop':_0x22f796,'role':_0x21f94c,'product_stock':_0x296900,'language':_0x1ec132,'staff_arr':_0xc28e61,'staff_data_all':_0x3ea78e});}catch(_0x105478){_0xecad61[_0x4ab408(0x1d9)](_0x105478);}});async function agentsdataDSICheck_admin(_0x2139e9,_0x2f1920,_0x5a9398,_0x5a4489){const _0x2f5a11=a0_0x12c55b,_0x29b527=await product[_0x2f5a11(0x27d)]([{'$group':{'_id':{'brand':_0x2f5a11(0x1af),'category':'$category'},'products':{'$push':{'name':'$name','product_code':_0x2f5a11(0x138)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1fb098=[];_0x1fb098[_0x2f5a11(0x230)]=[];for(let _0x107847=0x0;_0x107847<=_0x29b527[_0x2f5a11(0x23f)]-0x1;_0x107847++){const _0x570e18=_0x29b527[_0x107847];_0x1fb098[_0x2f5a11(0x230)][_0x2f5a11(0x24d)](_0x570e18);}const _0x51fb90=await product[_0x2f5a11(0x27d)]([{'$group':{'_id':{'category':_0x2f5a11(0x23d)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x2f5413=await product[_0x2f5a11(0x27d)]([{'$group':{'_id':{'category':_0x2f5a11(0x23d),'brand':_0x2f5a11(0x1af)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x184e05=await sales_sa[_0x2f5a11(0x27d)]([{'$match':{'date':{'$gte':_0x2139e9,'$lte':_0x2f1920},'sales_staff_id':_0x5a9398,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x2f5a11(0x277)}},{'$lookup':{'from':_0x2f5a11(0x287),'localField':'sale_product.product_code','foreignField':_0x2f5a11(0x1ea),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x2f5a11(0x106),'date':_0x2f5a11(0x133),'customer':_0x2f5a11(0x1ac)},'totalQty':{'$sum':_0x2f5a11(0x231)},'products':{'$push':{'qty':_0x2f5a11(0x231),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0x2f5a11(0x253),'product_details':{'prod_name':_0x2f5a11(0x171),'product_code':'$product_info.product_code','category':_0x2f5a11(0x1a3),'brand':_0x2f5a11(0x147),'gross_price':_0x2f5a11(0x142)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x2f5a11(0x18c),'date':_0x2f5a11(0x1c2),'customer':_0x2f5a11(0x119),'category':'$products.product_details.category','brand':_0x2f5a11(0x17b)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x2f5a11(0x1e5),_0x2f5a11(0x1db)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x2f5a11(0x26c)},'adj_discount':{'$sum':_0x2f5a11(0x272)},'product_details':{'$first':_0x2f5a11(0x28d)}}},{'$group':{'_id':{'dsi':_0x2f5a11(0x18c),'date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x2f5a11(0x239)},'NetPrice':{'$sum':_0x2f5a11(0x118)},'discount':{'$sum':_0x2f5a11(0x136)},'adj_discount':{'$sum':_0x2f5a11(0x17c)},'products':{'$push':{'qty':_0x2f5a11(0x1b4),'category':_0x2f5a11(0x134),'brand':'$_id.brand','product_details':_0x2f5a11(0x128)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4489da=[],_0x408c34={},_0x51221d={},_0x1ebcdb={};var _0x1c3310=0x0,_0x1b2f20=0x0,_0x138950=0x0,_0x4ce63b=0x0,_0x4ef447=0x0;const _0x524194=0x6;for(let _0x17575a=0x0;_0x17575a<=_0x184e05[_0x2f5a11(0x23f)]-0x1;_0x17575a++){const _0x3a9c8b=_0x184e05[_0x17575a];let _0x3b704a=_0x2f5a11(0x214);_0x3b704a+=_0x2f5a11(0x185)+_0x3a9c8b[_0x2f5a11(0x14f)]['dsi']+'</td>',_0x3b704a+=_0x2f5a11(0x185)+_0x3a9c8b[_0x2f5a11(0x14f)][_0x2f5a11(0x18b)]+_0x2f5a11(0x108),_0x3b704a+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3a9c8b[_0x2f5a11(0x14f)][_0x2f5a11(0x1a7)]+_0x2f5a11(0x108);let _0x430338={};var _0x187800=0x0;for(let _0x2fdd60=0x0;_0x2fdd60<=_0x3a9c8b[_0x2f5a11(0x287)][_0x2f5a11(0x23f)]-0x1;_0x2fdd60++){const _0x9819cb=_0x3a9c8b['products'][_0x2fdd60];_0x430338[_0x9819cb[_0x2f5a11(0x1b2)]+'-'+_0x9819cb['category']]=_0x9819cb['qty'];const _0x30a5a8=_0x9819cb[_0x2f5a11(0x1b2)]+'-'+_0x9819cb[_0x2f5a11(0x18e)];!_0x408c34[_0x30a5a8]&&(_0x408c34[_0x30a5a8]=0x0),!Array['isArray'](_0x1ebcdb[_0x30a5a8])&&(_0x1ebcdb[_0x30a5a8]=[]),!Array[_0x2f5a11(0x127)](_0x1ebcdb[_0x30a5a8])&&(_0x1ebcdb[_0x30a5a8]=[]),_0x408c34[_0x30a5a8]+=_0x9819cb[_0x2f5a11(0x186)],_0x1ebcdb[_0x30a5a8]['push'](_0x9819cb['qty']),_0x187800++;}console[_0x2f5a11(0x1bf)](_0x3a9c8b);for(let _0x4682e0=0x0;_0x4682e0<=_0x1fb098[_0x2f5a11(0x230)]['length']-0x1;_0x4682e0++){const _0x2284d4=_0x1fb098[_0x2f5a11(0x230)][_0x4682e0],_0x29a97d=_0x2284d4[_0x2f5a11(0x14f)][_0x2f5a11(0x1b2)]+'-'+_0x2284d4['_id'][_0x2f5a11(0x18e)];_0x3b704a+=_0x2f5a11(0x211)+(_0x430338[_0x29a97d]!==undefined?_0x430338[_0x29a97d][_0x2f5a11(0x162)](0x2):'')+'</td>';}_0x138950=_0x3a9c8b[_0x2f5a11(0xff)]+_0x3a9c8b[_0x2f5a11(0x226)],_0x3b704a+=_0x2f5a11(0x20b)+formatNumber(parseFloat(_0x3a9c8b['totalQty'],0x2)[_0x2f5a11(0x162)](0x2))+_0x2f5a11(0x108),_0x3b704a+=_0x2f5a11(0x20b)+formatNumber(_0x3a9c8b[_0x2f5a11(0x1bd)][_0x2f5a11(0x162)](0x2))+_0x2f5a11(0x108),_0x3b704a+=_0x2f5a11(0x20b)+formatNumber(_0x138950)+_0x2f5a11(0x108),_0x3b704a+=_0x2f5a11(0x20b)+formatNumber(_0x3a9c8b[_0x2f5a11(0x192)][_0x2f5a11(0x162)](0x2))+_0x2f5a11(0x108),_0x3b704a+='</tr>',_0x1c3310+=parseFloat(_0x3a9c8b['totalQty'][_0x2f5a11(0x162)](0x2)),_0x1b2f20+=parseFloat(_0x3a9c8b['NetPrice'][_0x2f5a11(0x162)](0x2)),_0x4ce63b+=_0x138950,_0x4ef447+=parseFloat(_0x3a9c8b[_0x2f5a11(0x1bd)][_0x2f5a11(0x162)](0x2));if(_0x17575a==_0x184e05[_0x2f5a11(0x23f)]-0x1){_0x3b704a+=_0x2f5a11(0x214),_0x3b704a+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x3b704a+=_0x2f5a11(0x108);for(let _0x5d290a=0x0;_0x5d290a<=_0x1fb098['cat_brand']['length']-0x1;_0x5d290a++){const _0x4a242f=_0x1fb098[_0x2f5a11(0x230)][_0x5d290a],_0x4bfeab=_0x4a242f['_id'][_0x2f5a11(0x1b2)]+'-'+_0x4a242f[_0x2f5a11(0x14f)][_0x2f5a11(0x18e)],_0x17eeb9=_0x1ebcdb[_0x4bfeab][_0x2f5a11(0x21b)]((_0x16d320,_0x545385)=>_0x16d320+_0x545385,0x0);console[_0x2f5a11(0x1bf)](_0x2f5a11(0x1eb),_0x4bfeab),_0x3b704a+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x17eeb9!==undefined?formatNumber(_0x17eeb9[_0x2f5a11(0x162)](0x2)):'')+_0x2f5a11(0x285),console[_0x2f5a11(0x1bf)](_0x1ebcdb[_0x4bfeab][_0x2f5a11(0x21b)]((_0xb8717a,_0x385abd)=>_0xb8717a+_0x385abd,0x0));}_0x3b704a+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1c3310[_0x2f5a11(0x162)](0x2))+_0x2f5a11(0x285),_0x3b704a+=_0x2f5a11(0x16e)+formatNumber(_0x4ef447)+_0x2f5a11(0x285),_0x3b704a+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4ce63b)+_0x2f5a11(0x285),_0x3b704a+=_0x2f5a11(0x16e)+formatNumber(_0x1b2f20)+_0x2f5a11(0x285),_0x3b704a+='</tr>';}_0x4489da[_0x2f5a11(0x24d)](_0x3b704a);}function _0x165e1d(_0x3e21a0,_0x4b50c4){const _0x57f59a=_0x2f5a11,_0x3cd427=[];for(let _0x50bf97=0x0;_0x50bf97<=_0x3e21a0[_0x57f59a(0x23f)]-0x1;_0x50bf97+=_0x4b50c4){_0x3cd427[_0x57f59a(0x24d)](_0x3e21a0[_0x57f59a(0x20c)](_0x50bf97,_0x50bf97+_0x4b50c4));}return _0x3cd427;}const _0x16a1cc=_0x165e1d(_0x4489da,_0x524194);let _0x269147='';return _0x16a1cc[_0x2f5a11(0x12b)]((_0x5f2f9c,_0x6988ab)=>{const _0xf5070e=_0x2f5a11;_0x6988ab>0x0&&(_0x269147+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x269147+=_0xf5070e(0x1fb),_0x269147+=_0xf5070e(0x1c8),_0x269147+=_0xf5070e(0x214),_0x269147+=_0xf5070e(0x125),_0x269147+='</tr>',_0x269147+='<tr>',_0x269147+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x2b98a2=0x0;_0x2b98a2<=_0x51fb90['length']-0x1;_0x2b98a2++){const _0x4db6a2=_0x51fb90[_0x2b98a2];for(let _0x152250=0x0;_0x152250<_0x2f5413[_0xf5070e(0x23f)];_0x152250++){const _0x4fb8e1=_0x2f5413[_0x152250];_0x4fb8e1[_0xf5070e(0x14f)]===_0x4db6a2['_id']['category']&&(_0x269147+='<td\x20colspan=\x22'+_0x4fb8e1[_0xf5070e(0x111)]+_0xf5070e(0x1fa)+_0x4db6a2[_0xf5070e(0x14f)][_0xf5070e(0x18e)]+'</td>');}}_0x269147+=_0xf5070e(0x26e),_0x269147+=_0xf5070e(0x1c3),_0x269147+=_0xf5070e(0x214),_0x269147+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x269147+=_0xf5070e(0x18d),_0x269147+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x2b9841=0x0;_0x2b9841<=_0x51fb90[_0xf5070e(0x23f)]-0x1;_0x2b9841++){const _0x245269=_0x51fb90[_0x2b9841];for(let _0x3e42ea=0x0;_0x3e42ea<_0x1fb098[_0xf5070e(0x230)][_0xf5070e(0x23f)];_0x3e42ea++){const _0x2624dc=_0x1fb098['cat_brand'][_0x3e42ea];_0x2624dc[_0xf5070e(0x14f)][_0xf5070e(0x18e)]===_0x245269[_0xf5070e(0x14f)][_0xf5070e(0x18e)]&&(_0x269147+=_0xf5070e(0x11c)+_0x2624dc[_0xf5070e(0x14f)][_0xf5070e(0x1b2)]+_0xf5070e(0x108));}}_0x269147+=_0xf5070e(0x241),_0x269147+=_0xf5070e(0x289),_0x269147+=_0xf5070e(0x19b),_0x269147+=_0xf5070e(0x166),_0x269147+=_0xf5070e(0x1c3),_0x269147+=_0xf5070e(0x280),_0x269147+=_0xf5070e(0x1ba),_0x5f2f9c['forEach'](_0x134541=>{_0x269147+=_0x134541;}),console['log'](_0x1ebcdb),_0x269147+=_0xf5070e(0x13f),_0x269147+=_0xf5070e(0x24a);}),_0x269147;}async function agentsdataDSICheck_admin_excel(_0xc0cf6c,_0x1efd3b,_0x2ac25a,_0xcfcba1){const _0x31aba5=a0_0x12c55b,_0x27b0c4=await product[_0x31aba5(0x27d)]([{'$group':{'_id':{'brand':_0x31aba5(0x1af),'category':_0x31aba5(0x23d)},'products':{'$push':{'name':_0x31aba5(0x24b),'product_code':_0x31aba5(0x138)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x58dbe8=[];_0x58dbe8[_0x31aba5(0x230)]=[];for(let _0x27b71a=0x0;_0x27b71a<=_0x27b0c4[_0x31aba5(0x23f)]-0x1;_0x27b71a++){const _0x2f4a8b=_0x27b0c4[_0x27b71a];_0x58dbe8[_0x31aba5(0x230)][_0x31aba5(0x24d)](_0x2f4a8b);}const _0xac86a5=await product[_0x31aba5(0x27d)]([{'$group':{'_id':{'category':_0x31aba5(0x23d)},'products':{'$push':{'brand':_0x31aba5(0x1af),'product_code':_0x31aba5(0x138),'product_name':_0x31aba5(0x24b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3b370f=await product[_0x31aba5(0x27d)]([{'$group':{'_id':{'category':_0x31aba5(0x23d),'brand':'$brand'}}},{'$group':{'_id':_0x31aba5(0x134),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x466f99=await sales_sa[_0x31aba5(0x27d)]([{'$match':{'date':{'$gte':_0xc0cf6c,'$lte':_0x1efd3b},'sales_staff_id':_0x2ac25a,'sale_product.isFG':_0x31aba5(0x277)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x31aba5(0x150),'foreignField':'product_code','as':_0x31aba5(0x22f)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x31aba5(0x106),'date':_0x31aba5(0x133),'customer':_0x31aba5(0x1ac)},'totalQty':{'$sum':_0x31aba5(0x231)},'products':{'$push':{'qty':_0x31aba5(0x231),'NetPrice':_0x31aba5(0x219),'discount':_0x31aba5(0x1c9),'adj_discount':_0x31aba5(0x253),'product_details':{'prod_name':_0x31aba5(0x171),'product_code':_0x31aba5(0x20d),'category':_0x31aba5(0x1a3),'brand':_0x31aba5(0x147),'gross_price':_0x31aba5(0x142)}}}}},{'$unwind':_0x31aba5(0x104)},{'$group':{'_id':{'dsi':_0x31aba5(0x18c),'date':'$_id.date','customer':_0x31aba5(0x119),'category':'$products.product_details.category','brand':_0x31aba5(0x17b)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x31aba5(0x1db)]}},'NetPrice':{'$sum':_0x31aba5(0x1f4)},'discount':{'$sum':_0x31aba5(0x26c)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x31aba5(0x18c),'date':_0x31aba5(0x1c2),'customer':'$_id.customer'},'totalQty':{'$sum':_0x31aba5(0x1b4)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x31aba5(0x118)},'discount':{'$sum':_0x31aba5(0x136)},'adj_discount':{'$sum':_0x31aba5(0x17c)},'products':{'$push':{'qty':_0x31aba5(0x1b4),'category':'$_id.category','brand':_0x31aba5(0x14e),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x5bf3be=[],_0x43f2bb={},_0x312e87={},_0x4459ec={};var _0x3607bd=0x0,_0xffd73d=0x0,_0x42329a=0x0,_0x298fc8=0x0,_0x5ec744=0x0;const _0x429f41=0x16345785d8a0000;for(let _0x4d871f=0x0;_0x4d871f<=_0x466f99[_0x31aba5(0x23f)]-0x1;_0x4d871f++){const _0x456cbd=_0x466f99[_0x4d871f];let _0x4a49fe=_0x31aba5(0x214);_0x4a49fe+=_0x31aba5(0x185)+_0x456cbd['_id'][_0x31aba5(0x19d)]+'</td>',_0x4a49fe+=_0x31aba5(0x185)+_0x456cbd[_0x31aba5(0x14f)][_0x31aba5(0x18b)]+_0x31aba5(0x108),_0x4a49fe+=_0x31aba5(0x185)+_0x456cbd['_id'][_0x31aba5(0x1a7)]+'</td>';let _0xb3095a={};var _0x5be374=0x0;for(let _0x51e9c8=0x0;_0x51e9c8<=_0x456cbd[_0x31aba5(0x287)][_0x31aba5(0x23f)]-0x1;_0x51e9c8++){const _0x993299=_0x456cbd[_0x31aba5(0x287)][_0x51e9c8];_0xb3095a[_0x993299[_0x31aba5(0x1b2)]+'-'+_0x993299[_0x31aba5(0x18e)]]=_0x993299[_0x31aba5(0x186)];const _0x183714=_0x993299[_0x31aba5(0x1b2)]+'-'+_0x993299['category'];!_0x43f2bb[_0x183714]&&(_0x43f2bb[_0x183714]=0x0),!Array['isArray'](_0x4459ec[_0x183714])&&(_0x4459ec[_0x183714]=[]),!Array[_0x31aba5(0x127)](_0x4459ec[_0x183714])&&(_0x4459ec[_0x183714]=[]),_0x43f2bb[_0x183714]+=_0x993299['qty'],_0x4459ec[_0x183714]['push'](_0x993299[_0x31aba5(0x186)]),_0x5be374++;}console[_0x31aba5(0x1bf)](_0x456cbd);for(let _0x43e32c=0x0;_0x43e32c<=_0x58dbe8['cat_brand'][_0x31aba5(0x23f)]-0x1;_0x43e32c++){const _0x1fa58d=_0x58dbe8['cat_brand'][_0x43e32c],_0x194a7d=_0x1fa58d[_0x31aba5(0x14f)][_0x31aba5(0x1b2)]+'-'+_0x1fa58d[_0x31aba5(0x14f)][_0x31aba5(0x18e)];_0x4a49fe+=_0x31aba5(0x211)+(_0xb3095a[_0x194a7d]!==undefined?_0xb3095a[_0x194a7d]['toFixed'](0x2):'')+_0x31aba5(0x108);}_0x42329a=_0x456cbd['discount']+_0x456cbd[_0x31aba5(0x226)],_0x4a49fe+=_0x31aba5(0x20b)+formatNumber(parseFloat(_0x456cbd['totalQty'],0x2)['toFixed'](0x2))+_0x31aba5(0x108),_0x4a49fe+=_0x31aba5(0x20b)+formatNumber(_0x456cbd['totalGross'][_0x31aba5(0x162)](0x2))+_0x31aba5(0x108),_0x4a49fe+=_0x31aba5(0x20b)+formatNumber(_0x42329a)+'</td>',_0x4a49fe+=_0x31aba5(0x20b)+formatNumber(_0x456cbd['NetPrice'][_0x31aba5(0x162)](0x2))+_0x31aba5(0x108),_0x4a49fe+=_0x31aba5(0x1c3),_0x3607bd+=parseFloat(_0x456cbd['totalQty'][_0x31aba5(0x162)](0x2)),_0xffd73d+=parseFloat(_0x456cbd[_0x31aba5(0x192)]['toFixed'](0x2)),_0x298fc8+=_0x42329a,_0x5ec744+=parseFloat(_0x456cbd['totalGross'][_0x31aba5(0x162)](0x2));if(_0x4d871f==_0x466f99['length']-0x1){_0x4a49fe+='<tr>',_0x4a49fe+=_0x31aba5(0x27e),_0x4a49fe+=_0x31aba5(0x108);for(let _0x5c5528=0x0;_0x5c5528<=_0x58dbe8[_0x31aba5(0x230)][_0x31aba5(0x23f)]-0x1;_0x5c5528++){const _0x48b6f3=_0x58dbe8[_0x31aba5(0x230)][_0x5c5528],_0x1e590d=_0x48b6f3[_0x31aba5(0x14f)][_0x31aba5(0x1b2)]+'-'+_0x48b6f3[_0x31aba5(0x14f)][_0x31aba5(0x18e)],_0x49d169=_0x4459ec[_0x1e590d][_0x31aba5(0x21b)]((_0x420452,_0x511bde)=>_0x420452+_0x511bde,0x0);console[_0x31aba5(0x1bf)](_0x31aba5(0x1eb),_0x1e590d),_0x4a49fe+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x49d169!==undefined?formatNumber(_0x49d169['toFixed'](0x2)):'')+'</b></td>',console[_0x31aba5(0x1bf)](_0x4459ec[_0x1e590d]['reduce']((_0xb63dd4,_0x47934d)=>_0xb63dd4+_0x47934d,0x0));}_0x4a49fe+=_0x31aba5(0x16e)+formatNumber(_0x3607bd[_0x31aba5(0x162)](0x2))+_0x31aba5(0x285),_0x4a49fe+=_0x31aba5(0x16e)+formatNumber(_0x5ec744)+_0x31aba5(0x285),_0x4a49fe+=_0x31aba5(0x16e)+formatNumber(_0x298fc8)+_0x31aba5(0x285),_0x4a49fe+=_0x31aba5(0x16e)+formatNumber(_0xffd73d)+_0x31aba5(0x285),_0x4a49fe+=_0x31aba5(0x1c3);}_0x5bf3be['push'](_0x4a49fe);}function _0x4c4b8e(_0x3c42cf,_0x423521){const _0x27f98b=_0x31aba5,_0x31468b=[];for(let _0x24bc3e=0x0;_0x24bc3e<=_0x3c42cf[_0x27f98b(0x23f)]-0x1;_0x24bc3e+=_0x423521){_0x31468b['push'](_0x3c42cf[_0x27f98b(0x20c)](_0x24bc3e,_0x24bc3e+_0x423521));}return _0x31468b;}const _0x567825=_0x4c4b8e(_0x5bf3be,_0x429f41);let _0x5c04e5='';return _0x567825[_0x31aba5(0x12b)]((_0x3ec685,_0x56487a)=>{const _0x37e135=_0x31aba5;_0x56487a>0x0&&(_0x5c04e5+=_0x37e135(0x190));_0x5c04e5+=_0x37e135(0x1fb),_0x5c04e5+=_0x37e135(0x1c8),_0x5c04e5+='<tr>',_0x5c04e5+=_0x37e135(0x125),_0x5c04e5+='</tr>',_0x5c04e5+=_0x37e135(0x214),_0x5c04e5+=_0x37e135(0x115);for(let _0x487e49=0x0;_0x487e49<=_0xac86a5[_0x37e135(0x23f)]-0x1;_0x487e49++){const _0x451d6a=_0xac86a5[_0x487e49];for(let _0x4b0cf2=0x0;_0x4b0cf2<_0x3b370f[_0x37e135(0x23f)];_0x4b0cf2++){const _0x1e235b=_0x3b370f[_0x4b0cf2];_0x1e235b[_0x37e135(0x14f)]===_0x451d6a[_0x37e135(0x14f)][_0x37e135(0x18e)]&&(_0x5c04e5+=_0x37e135(0x149)+_0x1e235b[_0x37e135(0x111)]+_0x37e135(0x1fa)+_0x451d6a[_0x37e135(0x14f)][_0x37e135(0x18e)]+'</td>');}}_0x5c04e5+=_0x37e135(0x26e),_0x5c04e5+=_0x37e135(0x1c3),_0x5c04e5+=_0x37e135(0x214),_0x5c04e5+=_0x37e135(0x240),_0x5c04e5+=_0x37e135(0x18d),_0x5c04e5+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x52270a=0x0;_0x52270a<=_0xac86a5[_0x37e135(0x23f)]-0x1;_0x52270a++){const _0x2403ad=_0xac86a5[_0x52270a];for(let _0x4ef228=0x0;_0x4ef228<_0x58dbe8[_0x37e135(0x230)][_0x37e135(0x23f)];_0x4ef228++){const _0x7241d6=_0x58dbe8[_0x37e135(0x230)][_0x4ef228];_0x7241d6[_0x37e135(0x14f)][_0x37e135(0x18e)]===_0x2403ad[_0x37e135(0x14f)][_0x37e135(0x18e)]&&(_0x5c04e5+=_0x37e135(0x11c)+_0x7241d6[_0x37e135(0x14f)]['brand']+'</td>');}}_0x5c04e5+=_0x37e135(0x241),_0x5c04e5+=_0x37e135(0x289),_0x5c04e5+=_0x37e135(0x19b),_0x5c04e5+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x5c04e5+=_0x37e135(0x1c3),_0x5c04e5+=_0x37e135(0x280),_0x5c04e5+=_0x37e135(0x1ba),_0x3ec685[_0x37e135(0x12b)](_0x20024b=>{_0x5c04e5+=_0x20024b;}),console[_0x37e135(0x1bf)](_0x4459ec),_0x5c04e5+='</tbody>',_0x5c04e5+='</table>';}),_0x5c04e5;}router['post'](a0_0x12c55b(0x17d),auth,async(_0x5269db,_0x21180d)=>{const _0x154403=a0_0x12c55b,{from_date:_0x2555f3,to_date:_0x2799d6,isExcel:_0x3d1add,agent_id:_0x56f954}=_0x5269db['body'],_0x3271c4=_0x5269db['user'],_0x40de18=await staff[_0x154403(0x249)]({'email':_0x3271c4[_0x154403(0x1d3)]}),_0x5198a5=await master_shop[_0x154403(0x25d)](),_0x141dbb=await agentsdataDSICheck_admin(_0x2555f3,_0x2799d6,_0x56f954,_0x3d1add),_0x360fae=await agentsdataDSICheck_admin_excel(_0x2555f3,_0x2799d6,_0x56f954,_0x3d1add);let _0x5b3632=_0x154403(0x1e0);var _0xc47efc=new Date(_0x2555f3),_0x1da332=new Date(_0x2799d6);const _0x188874={'year':_0x154403(0x1fd),'month':_0x154403(0x229),'day':_0x154403(0x1fd)},_0x4ee81e=new Intl[(_0x154403(0x1b0))](_0x154403(0x1d7),_0x188874)[_0x154403(0x17a)](_0xc47efc),_0x1e05fe=new Intl[(_0x154403(0x1b0))](_0x154403(0x1d7),_0x188874)['format'](_0x1da332);_0x5b3632+='<div\x20class=\x22row\x22>',_0x5b3632+='<div\x20\x20id=\x22table-conatainer\x22>',_0x5b3632+=_0x154403(0x1fb),_0x5b3632+=_0x141dbb,_0x5b3632+='</table>',_0x5b3632+=_0x154403(0x210),_0x5b3632+=_0x154403(0x210);let _0x50ee94=_0x154403(0x1e0);_0x50ee94+=_0x154403(0x201),_0x50ee94+='<div\x20\x20id=\x22table-conatainer\x22>',_0x50ee94+='<table>',_0x50ee94+=_0x360fae,_0x50ee94+=_0x154403(0x24a),_0x50ee94+='</div>',_0x50ee94+='</div>';let _0x425a97='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x361337={'width':_0x154403(0x1d6),'height':_0x154403(0x1e9),'orientation':'landscape','border':{'top':'0.1in','right':_0x154403(0x145),'bottom':'0.1in','left':_0x154403(0x145)},'header':{'height':'60mm','contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x425a97+_0x154403(0x175)+_0x4ee81e+_0x154403(0x14b)+_0x1e05fe+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x154403(0x17f),'contents':{'default':_0x154403(0x23e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x154403(0x10d)}}};if(_0x3d1add=='on'){const _0x22181b=cheerio[_0x154403(0x199)](_0x50ee94);let _0x1f8deb=[],_0x463533=[],_0x372e32=[];_0x22181b('table\x20tr')[_0x154403(0x1c0)]((_0x2c7885,_0x2b1652)=>{const _0x4fcb3a=_0x154403;let _0x2a6498=[],_0x307657=0x0;while(_0x372e32[_0x307657]){_0x372e32[_0x307657]--,_0x307657++;}_0x22181b(_0x2b1652)['find'](_0x4fcb3a(0x1b3))[_0x4fcb3a(0x1c0)]((_0x3cdc7d,_0xc8287c)=>{const _0x3c92d5=_0x4fcb3a;let _0x412660=_0x22181b(_0xc8287c)[_0x3c92d5(0x218)]()['trim'](),_0x2f2e6d=parseFloat(_0x412660[_0x3c92d5(0x283)](/,/g,''));isNaN(_0x2f2e6d)&&(_0x2f2e6d=_0x412660);let _0x423c1c=parseInt(_0x22181b(_0xc8287c)[_0x3c92d5(0x178)](_0x3c92d5(0x194)))||0x1,_0x5226b6=parseInt(_0x22181b(_0xc8287c)[_0x3c92d5(0x178)](_0x3c92d5(0x1cf)))||0x1;_0x2a6498[_0x307657]=_0x2f2e6d;(_0x423c1c>0x1||_0x5226b6>0x1)&&_0x463533[_0x3c92d5(0x24d)]({'s':{'r':_0x2c7885,'c':_0x307657},'e':{'r':_0x2c7885+_0x5226b6-0x1,'c':_0x307657+_0x423c1c-0x1}});for(let _0x2f277c=0x0;_0x2f277c<_0x423c1c;_0x2f277c++){_0x5226b6>0x1&&(_0x372e32[_0x307657+_0x2f277c]=_0x5226b6-0x1);}_0x307657+=_0x423c1c;}),_0x1f8deb[_0x4fcb3a(0x24d)](_0x2a6498);});const _0x3ba875=XLSX[_0x154403(0x16f)][_0x154403(0x1bc)](),_0xbc0bc6=XLSX['utils'][_0x154403(0x198)](_0x1f8deb);_0x463533[_0x154403(0x23f)]>0x0&&(_0xbc0bc6['!merges']=_0x463533);_0xbc0bc6[_0x154403(0x180)]=_0x1f8deb[0x0][_0x154403(0x1cc)](()=>({'wpx':0x64})),XLSX[_0x154403(0x16f)][_0x154403(0x27a)](_0x3ba875,_0xbc0bc6,_0x154403(0x132));const _0x2cf498=XLSX[_0x154403(0x25a)](_0x3ba875,{'bookType':'xlsx','type':'buffer'});_0x21180d[_0x154403(0x11b)](_0x154403(0x13a),_0x154403(0x269)),_0x21180d[_0x154403(0x11b)](_0x154403(0x260),_0x154403(0x1a4)),_0x21180d['send'](_0x2cf498);}else pdf['create'](_0x5b3632,_0x361337)[_0x154403(0x26a)](function(_0x42a363,_0x29277c){const _0x3398a2=_0x154403;if(_0x42a363){_0x21180d[_0x3398a2(0x252)](0x1f4)[_0x3398a2(0x177)](_0x3398a2(0x1d1));return;}_0x21180d[_0x3398a2(0x11b)](_0x3398a2(0x260),'application/pdf'),_0x29277c['pipe'](_0x21180d);});}),router[a0_0x12c55b(0x1f9)](a0_0x12c55b(0x1dc),auth,async(_0x29ad17,_0x2d905b)=>{const _0x4835ff=a0_0x12c55b;try{const {username:_0x456ed2,email:_0x492e8e,role:_0x57e661}=_0x29ad17[_0x4835ff(0x242)],_0x132efe=_0x29ad17[_0x4835ff(0x242)],_0x13147f=await profile['findOne']({'email':_0x132efe[_0x4835ff(0x1d3)]}),_0x23ff00={'year':_0x4835ff(0x1fd),'month':_0x4835ff(0x229),'day':_0x4835ff(0x1fd)},_0x46a22f=await master_shop[_0x4835ff(0x25d)](),_0x580922=await staff[_0x4835ff(0x249)]({'email':_0x132efe[_0x4835ff(0x1d3)]}),_0x3809dd=await product['find'](),_0x2cb640=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x4835ff(0x179),'foreignField':_0x4835ff(0x16a),'as':_0x4835ff(0x1f3)}},{'$unwind':_0x4835ff(0x1ab)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x4835ff(0x129)}},{'$group':{'_id':_0x4835ff(0x262),'product_stock':{'$sum':_0x4835ff(0x15f)}}}]);if(_0x46a22f[0x0]['language']=='English\x20(US)')var _0x142238=users['English'];else{if(_0x46a22f[0x0][_0x4835ff(0x10a)]==_0x4835ff(0x256))var _0x142238=users[_0x4835ff(0x256)];else{if(_0x46a22f[0x0][_0x4835ff(0x10a)]==_0x4835ff(0x187))var _0x142238=users[_0x4835ff(0x187)];else{if(_0x46a22f[0x0][_0x4835ff(0x10a)]==_0x4835ff(0x126))var _0x142238=users[_0x4835ff(0x126)];else{if(_0x46a22f[0x0][_0x4835ff(0x10a)]==_0x4835ff(0x114))var _0x142238=users[_0x4835ff(0x114)];else{if(_0x46a22f[0x0][_0x4835ff(0x10a)]==_0x4835ff(0x209))var _0x142238=users[_0x4835ff(0x143)];else{if(_0x46a22f[0x0][_0x4835ff(0x10a)]=='Chinese')var _0x142238=users[_0x4835ff(0x188)];else{if(_0x46a22f[0x0][_0x4835ff(0x10a)]==_0x4835ff(0x15c))var _0x142238=users['Arabic'];}}}}}}}_0x2d905b[_0x4835ff(0x237)](_0x4835ff(0x244),{'success':_0x29ad17[_0x4835ff(0x19a)]('success'),'errors':_0x29ad17[_0x4835ff(0x19a)](_0x4835ff(0x281)),'alldata':_0x3809dd,'profile':_0x13147f,'master_shop':_0x46a22f,'role':_0x132efe,'product_stock':_0x2cb640,'language':_0x142238,'staff_arr':_0x580922});}catch(_0x4f11fd){}});function formatNumber(_0xd18881,_0x1540e4=a0_0x12c55b(0x1d7),_0xa0db5e={'minimumFractionDigits':0x2}){const _0x6c3fe0=a0_0x12c55b,_0x1310eb=new Intl[(_0x6c3fe0(0x1a0))](_0x1540e4,_0xa0db5e);return _0x1310eb[_0x6c3fe0(0x17a)](_0xd18881);}async function agentsdataDSICheck(_0x91a0d5,_0x161601,_0x2db0ca,_0x57c47e){const _0x5a5873=a0_0x12c55b,_0x25b946=await product[_0x5a5873(0x27d)]([{'$group':{'_id':{'brand':_0x5a5873(0x1af),'category':_0x5a5873(0x23d)},'products':{'$push':{'name':_0x5a5873(0x24b),'product_code':_0x5a5873(0x138)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x18b63e=[];_0x18b63e[_0x5a5873(0x230)]=[];for(let _0x5e58ff=0x0;_0x5e58ff<=_0x25b946['length']-0x1;_0x5e58ff++){const _0x362028=_0x25b946[_0x5e58ff];_0x18b63e[_0x5a5873(0x230)][_0x5a5873(0x24d)](_0x362028);}const _0x52a397=await product[_0x5a5873(0x27d)]([{'$group':{'_id':{'category':_0x5a5873(0x23d)},'products':{'$push':{'brand':_0x5a5873(0x1af),'product_code':_0x5a5873(0x138),'product_name':_0x5a5873(0x24b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x45f718=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0x5a5873(0x1af)}}},{'$group':{'_id':_0x5a5873(0x134),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2f3ee5=await sales_sa[_0x5a5873(0x27d)]([{'$match':{'date':{'$gte':_0x91a0d5,'$lte':_0x161601},'sales_staff_id':_0x2db0ca,'sale_product.isFG':_0x5a5873(0x277)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x5a5873(0x277)}},{'$lookup':{'from':_0x5a5873(0x287),'localField':_0x5a5873(0x150),'foreignField':_0x5a5873(0x1ea),'as':_0x5a5873(0x22f)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x5a5873(0x106),'date':_0x5a5873(0x133),'customer':'$customer'},'totalQty':{'$sum':_0x5a5873(0x231)},'products':{'$push':{'qty':_0x5a5873(0x231),'NetPrice':_0x5a5873(0x219),'discount':_0x5a5873(0x1c9),'adj_discount':_0x5a5873(0x253),'product_details':{'prod_name':_0x5a5873(0x171),'product_code':_0x5a5873(0x20d),'category':_0x5a5873(0x1a3),'brand':_0x5a5873(0x147),'gross_price':_0x5a5873(0x142)}}}}},{'$unwind':_0x5a5873(0x104)},{'$group':{'_id':{'dsi':_0x5a5873(0x18c),'date':_0x5a5873(0x1c2),'customer':_0x5a5873(0x119),'category':_0x5a5873(0x268),'brand':_0x5a5873(0x17b)},'totalQty':{'$sum':_0x5a5873(0x1e5)},'totalGross':{'$sum':{'$multiply':[_0x5a5873(0x1e5),_0x5a5873(0x1db)]}},'NetPrice':{'$sum':_0x5a5873(0x1f4)},'discount':{'$sum':_0x5a5873(0x26c)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x5a5873(0x28d)}}},{'$group':{'_id':{'dsi':_0x5a5873(0x18c),'date':'$_id.date','customer':_0x5a5873(0x119)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x5a5873(0x239)},'NetPrice':{'$sum':_0x5a5873(0x118)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x5a5873(0x17c)},'products':{'$push':{'qty':_0x5a5873(0x1b4),'category':_0x5a5873(0x134),'brand':_0x5a5873(0x14e),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x59a718=[],_0x13a566={},_0x31225a={},_0x1e43cf={};var _0x38e560=0x0,_0x81ab99=0x0,_0x4d928b=0x0,_0x586845=0x0,_0x85f074=0x0;const _0x2fdeb8=0x6;for(let _0x4265ad=0x0;_0x4265ad<=_0x2f3ee5[_0x5a5873(0x23f)]-0x1;_0x4265ad++){const _0xd46166=_0x2f3ee5[_0x4265ad];let _0x3ccbde=_0x5a5873(0x214);_0x3ccbde+=_0x5a5873(0x185)+_0xd46166['_id'][_0x5a5873(0x19d)]+_0x5a5873(0x108),_0x3ccbde+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xd46166[_0x5a5873(0x14f)][_0x5a5873(0x18b)]+'</td>',_0x3ccbde+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xd46166[_0x5a5873(0x14f)][_0x5a5873(0x1a7)]+_0x5a5873(0x108);let _0xdb80cd={};var _0x31a3eb=0x0;for(let _0x46d937=0x0;_0x46d937<=_0xd46166[_0x5a5873(0x287)][_0x5a5873(0x23f)]-0x1;_0x46d937++){const _0x1af7a9=_0xd46166[_0x5a5873(0x287)][_0x46d937];_0xdb80cd[_0x1af7a9[_0x5a5873(0x1b2)]+'-'+_0x1af7a9[_0x5a5873(0x18e)]]=_0x1af7a9[_0x5a5873(0x186)];const _0xb098f=_0x1af7a9[_0x5a5873(0x1b2)]+'-'+_0x1af7a9[_0x5a5873(0x18e)];!_0x13a566[_0xb098f]&&(_0x13a566[_0xb098f]=0x0),!Array[_0x5a5873(0x127)](_0x1e43cf[_0xb098f])&&(_0x1e43cf[_0xb098f]=[]),!Array[_0x5a5873(0x127)](_0x1e43cf[_0xb098f])&&(_0x1e43cf[_0xb098f]=[]),_0x13a566[_0xb098f]+=_0x1af7a9[_0x5a5873(0x186)],_0x1e43cf[_0xb098f][_0x5a5873(0x24d)](_0x1af7a9[_0x5a5873(0x186)]),_0x31a3eb++;}console[_0x5a5873(0x1bf)](_0xd46166);for(let _0x43b59f=0x0;_0x43b59f<=_0x18b63e['cat_brand'][_0x5a5873(0x23f)]-0x1;_0x43b59f++){const _0x596ad9=_0x18b63e[_0x5a5873(0x230)][_0x43b59f],_0x599218=_0x596ad9[_0x5a5873(0x14f)][_0x5a5873(0x1b2)]+'-'+_0x596ad9[_0x5a5873(0x14f)]['category'];_0x3ccbde+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0xdb80cd[_0x599218]!==undefined?_0xdb80cd[_0x599218][_0x5a5873(0x162)](0x2):'')+_0x5a5873(0x108);}_0x4d928b=_0xd46166[_0x5a5873(0xff)]+_0xd46166[_0x5a5873(0x226)],_0x3ccbde+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0xd46166[_0x5a5873(0x282)],0x2)[_0x5a5873(0x162)](0x2))+_0x5a5873(0x108),_0x3ccbde+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xd46166['totalGross']['toFixed'](0x2))+_0x5a5873(0x108),_0x3ccbde+=_0x5a5873(0x20b)+formatNumber(_0x4d928b)+_0x5a5873(0x108),_0x3ccbde+=_0x5a5873(0x20b)+formatNumber(_0xd46166['NetPrice']['toFixed'](0x2))+_0x5a5873(0x108),_0x3ccbde+=_0x5a5873(0x1c3),_0x38e560+=parseFloat(_0xd46166[_0x5a5873(0x282)][_0x5a5873(0x162)](0x2)),_0x81ab99+=parseFloat(_0xd46166[_0x5a5873(0x192)]['toFixed'](0x2)),_0x586845+=_0x4d928b,_0x85f074+=parseFloat(_0xd46166['totalGross'][_0x5a5873(0x162)](0x2));if(_0x4265ad==_0x2f3ee5[_0x5a5873(0x23f)]-0x1){_0x3ccbde+=_0x5a5873(0x214),_0x3ccbde+=_0x5a5873(0x27e),_0x3ccbde+=_0x5a5873(0x108);for(let _0x29a101=0x0;_0x29a101<=_0x18b63e[_0x5a5873(0x230)]['length']-0x1;_0x29a101++){const _0x5c8c86=_0x18b63e[_0x5a5873(0x230)][_0x29a101],_0x650e68=_0x5c8c86['_id'][_0x5a5873(0x1b2)]+'-'+_0x5c8c86['_id'][_0x5a5873(0x18e)],_0x3d2a06=_0x1e43cf[_0x650e68][_0x5a5873(0x21b)]((_0x4bf3c3,_0x41ab43)=>_0x4bf3c3+_0x41ab43,0x0);_0x3ccbde+=_0x5a5873(0x284)+(_0x3d2a06!==undefined?formatNumber(_0x3d2a06['toFixed'](0x2)):'')+_0x5a5873(0x285),console[_0x5a5873(0x1bf)](_0x1e43cf[_0x650e68][_0x5a5873(0x21b)]((_0xcc1b26,_0x1db56c)=>_0xcc1b26+_0x1db56c,0x0));}_0x3ccbde+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x38e560[_0x5a5873(0x162)](0x2))+_0x5a5873(0x285),_0x3ccbde+=_0x5a5873(0x16e)+formatNumber(_0x85f074)+_0x5a5873(0x285),_0x3ccbde+=_0x5a5873(0x16e)+formatNumber(_0x586845)+_0x5a5873(0x285),_0x3ccbde+=_0x5a5873(0x16e)+formatNumber(_0x81ab99)+_0x5a5873(0x285),_0x3ccbde+=_0x5a5873(0x1c3);}_0x59a718[_0x5a5873(0x24d)](_0x3ccbde);}function _0x5a2fd0(_0x5b7810,_0x2da59b){const _0x187b3c=_0x5a5873,_0x14da0c=[];for(let _0x29f9ab=0x0;_0x29f9ab<=_0x5b7810[_0x187b3c(0x23f)]-0x1;_0x29f9ab+=_0x2da59b){_0x14da0c[_0x187b3c(0x24d)](_0x5b7810['slice'](_0x29f9ab,_0x29f9ab+_0x2da59b));}return _0x14da0c;}const _0x5cb370=_0x5a2fd0(_0x59a718,_0x2fdeb8);let _0x7794a='';return _0x5cb370[_0x5a5873(0x12b)]((_0x45f132,_0x13273c)=>{const _0x4f9159=_0x5a5873;_0x13273c>0x0&&(_0x7794a+=_0x4f9159(0x190));_0x7794a+=_0x4f9159(0x1fb),_0x7794a+=_0x4f9159(0x1c8),_0x7794a+=_0x4f9159(0x214),_0x7794a+=_0x4f9159(0x125),_0x7794a+='</tr>',_0x7794a+=_0x4f9159(0x214),_0x7794a+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x1577f1=0x0;_0x1577f1<=_0x52a397['length']-0x1;_0x1577f1++){const _0xc0a7b3=_0x52a397[_0x1577f1];for(let _0x184ade=0x0;_0x184ade<_0x45f718['length'];_0x184ade++){const _0x149a0e=_0x45f718[_0x184ade];_0x149a0e['_id']===_0xc0a7b3[_0x4f9159(0x14f)][_0x4f9159(0x18e)]&&(_0x7794a+='<td\x20colspan=\x22'+_0x149a0e[_0x4f9159(0x111)]+_0x4f9159(0x1fa)+_0xc0a7b3[_0x4f9159(0x14f)][_0x4f9159(0x18e)]+'</td>');}}_0x7794a+=_0x4f9159(0x26e),_0x7794a+=_0x4f9159(0x1c3),_0x7794a+=_0x4f9159(0x214),_0x7794a+=_0x4f9159(0x240),_0x7794a+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x7794a+=_0x4f9159(0x1e1);for(let _0x1b3220=0x0;_0x1b3220<=_0x52a397['length']-0x1;_0x1b3220++){const _0x2e979e=_0x52a397[_0x1b3220];for(let _0x2a428f=0x0;_0x2a428f<_0x18b63e[_0x4f9159(0x230)]['length'];_0x2a428f++){const _0x3875e8=_0x18b63e[_0x4f9159(0x230)][_0x2a428f];_0x3875e8['_id']['category']===_0x2e979e[_0x4f9159(0x14f)][_0x4f9159(0x18e)]&&(_0x7794a+=_0x4f9159(0x11c)+_0x3875e8['_id'][_0x4f9159(0x1b2)]+'</td>');}}_0x7794a+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x7794a+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x7794a+=_0x4f9159(0x19b),_0x7794a+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x7794a+=_0x4f9159(0x1c3),_0x7794a+=_0x4f9159(0x280),_0x7794a+='<tbody>',_0x45f132[_0x4f9159(0x12b)](_0xd38af0=>{_0x7794a+=_0xd38af0;}),console[_0x4f9159(0x1bf)](_0x1e43cf),_0x7794a+=_0x4f9159(0x13f),_0x7794a+=_0x4f9159(0x24a);}),_0x7794a;}async function agentsdataDSICheck_excel(_0x5d8612,_0x5b91c3,_0x4b38b7,_0x43a4d5){const _0x23215f=a0_0x12c55b,_0x57aebb=await product['aggregate']([{'$group':{'_id':{'brand':_0x23215f(0x1af),'category':_0x23215f(0x23d)},'products':{'$push':{'name':_0x23215f(0x24b),'product_code':_0x23215f(0x138)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2af25a=[];_0x2af25a[_0x23215f(0x230)]=[];for(let _0x41e67a=0x0;_0x41e67a<=_0x57aebb[_0x23215f(0x23f)]-0x1;_0x41e67a++){const _0x11544b=_0x57aebb[_0x41e67a];_0x2af25a['cat_brand'][_0x23215f(0x24d)](_0x11544b);}const _0x367a88=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x23215f(0x1af),'product_code':_0x23215f(0x138),'product_name':_0x23215f(0x24b)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4e2dbd=await product[_0x23215f(0x27d)]([{'$group':{'_id':{'category':_0x23215f(0x23d),'brand':_0x23215f(0x1af)}}},{'$group':{'_id':_0x23215f(0x134),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3af7d2=await sales_sa[_0x23215f(0x27d)]([{'$match':{'date':{'$gte':_0x5d8612,'$lte':_0x5b91c3},'sales_staff_id':_0x4b38b7,'sale_product.isFG':'false'}},{'$unwind':_0x23215f(0x1f8)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x23215f(0x287),'localField':_0x23215f(0x150),'foreignField':_0x23215f(0x1ea),'as':_0x23215f(0x22f)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x23215f(0x106),'date':'$date','customer':_0x23215f(0x1ac)},'totalQty':{'$sum':_0x23215f(0x231)},'products':{'$push':{'qty':_0x23215f(0x231),'NetPrice':_0x23215f(0x219),'discount':_0x23215f(0x1c9),'adj_discount':_0x23215f(0x253),'product_details':{'prod_name':_0x23215f(0x171),'product_code':'$product_info.product_code','category':_0x23215f(0x1a3),'brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x23215f(0x104)},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x23215f(0x119),'category':'$products.product_details.category','brand':_0x23215f(0x17b)},'totalQty':{'$sum':_0x23215f(0x1e5)},'totalGross':{'$sum':{'$multiply':[_0x23215f(0x1e5),_0x23215f(0x1db)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x23215f(0x26c)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x23215f(0x18c),'date':_0x23215f(0x1c2),'customer':_0x23215f(0x119)},'totalQty':{'$sum':_0x23215f(0x1b4)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x23215f(0x118)},'discount':{'$sum':_0x23215f(0x136)},'adj_discount':{'$sum':_0x23215f(0x17c)},'products':{'$push':{'qty':'$totalQty','category':_0x23215f(0x134),'brand':_0x23215f(0x14e),'product_details':_0x23215f(0x128)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2a3580=[],_0x39aefb={},_0x127b32={},_0x20438d={};var _0xb04708=0x0,_0x5e1c3b=0x0,_0x33b71c=0x0,_0x20b36f=0x0,_0x453cb2=0x0;const _0x1f1af3=0x9184e72a000;for(let _0xc29684=0x0;_0xc29684<=_0x3af7d2[_0x23215f(0x23f)]-0x1;_0xc29684++){const _0x17cd83=_0x3af7d2[_0xc29684];let _0x248f67=_0x23215f(0x214);_0x248f67+=_0x23215f(0x185)+_0x17cd83[_0x23215f(0x14f)][_0x23215f(0x19d)]+'</td>',_0x248f67+=_0x23215f(0x185)+_0x17cd83[_0x23215f(0x14f)]['date']+_0x23215f(0x108),_0x248f67+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x17cd83['_id'][_0x23215f(0x1a7)]+'</td>';let _0x3877da={};var _0x53c33f=0x0;for(let _0x40d83c=0x0;_0x40d83c<=_0x17cd83[_0x23215f(0x287)]['length']-0x1;_0x40d83c++){const _0x5d23e8=_0x17cd83[_0x23215f(0x287)][_0x40d83c];_0x3877da[_0x5d23e8[_0x23215f(0x1b2)]+'-'+_0x5d23e8['category']]=_0x5d23e8[_0x23215f(0x186)];const _0x37d282=_0x5d23e8['brand']+'-'+_0x5d23e8[_0x23215f(0x18e)];!_0x39aefb[_0x37d282]&&(_0x39aefb[_0x37d282]=0x0),!Array[_0x23215f(0x127)](_0x20438d[_0x37d282])&&(_0x20438d[_0x37d282]=[]),!Array['isArray'](_0x20438d[_0x37d282])&&(_0x20438d[_0x37d282]=[]),_0x39aefb[_0x37d282]+=_0x5d23e8[_0x23215f(0x186)],_0x20438d[_0x37d282][_0x23215f(0x24d)](_0x5d23e8['qty']),_0x53c33f++;}console[_0x23215f(0x1bf)](_0x17cd83);for(let _0x81c829=0x0;_0x81c829<=_0x2af25a[_0x23215f(0x230)]['length']-0x1;_0x81c829++){const _0x2523b8=_0x2af25a[_0x23215f(0x230)][_0x81c829],_0x337148=_0x2523b8[_0x23215f(0x14f)]['brand']+'-'+_0x2523b8[_0x23215f(0x14f)][_0x23215f(0x18e)];_0x248f67+=_0x23215f(0x211)+(_0x3877da[_0x337148]!==undefined?_0x3877da[_0x337148][_0x23215f(0x162)](0x2):'')+_0x23215f(0x108);}_0x33b71c=_0x17cd83['discount']+_0x17cd83[_0x23215f(0x226)],_0x248f67+=_0x23215f(0x20b)+formatNumber(parseFloat(_0x17cd83[_0x23215f(0x282)],0x2)[_0x23215f(0x162)](0x2))+_0x23215f(0x108),_0x248f67+=_0x23215f(0x20b)+formatNumber(_0x17cd83[_0x23215f(0x1bd)][_0x23215f(0x162)](0x2))+_0x23215f(0x108),_0x248f67+=_0x23215f(0x20b)+formatNumber(_0x33b71c)+_0x23215f(0x108),_0x248f67+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x17cd83['NetPrice'][_0x23215f(0x162)](0x2))+'</td>',_0x248f67+='</tr>',_0xb04708+=parseFloat(_0x17cd83[_0x23215f(0x282)][_0x23215f(0x162)](0x2)),_0x5e1c3b+=parseFloat(_0x17cd83[_0x23215f(0x192)][_0x23215f(0x162)](0x2)),_0x20b36f+=_0x33b71c,_0x453cb2+=parseFloat(_0x17cd83[_0x23215f(0x1bd)][_0x23215f(0x162)](0x2));if(_0xc29684==_0x3af7d2['length']-0x1){_0x248f67+='<tr>',_0x248f67+=_0x23215f(0x27e),_0x248f67+='</td>';for(let _0x4a164b=0x0;_0x4a164b<=_0x2af25a[_0x23215f(0x230)][_0x23215f(0x23f)]-0x1;_0x4a164b++){const _0x53153e=_0x2af25a[_0x23215f(0x230)][_0x4a164b],_0xdc8619=_0x53153e[_0x23215f(0x14f)]['brand']+'-'+_0x53153e[_0x23215f(0x14f)]['category'],_0x344e72=_0x20438d[_0xdc8619][_0x23215f(0x21b)]((_0xa65376,_0x17ceaa)=>_0xa65376+_0x17ceaa,0x0);_0x248f67+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x344e72!==undefined?formatNumber(_0x344e72[_0x23215f(0x162)](0x2)):'')+_0x23215f(0x285),console[_0x23215f(0x1bf)](_0x20438d[_0xdc8619][_0x23215f(0x21b)]((_0x386b12,_0x4fbeae)=>_0x386b12+_0x4fbeae,0x0));}_0x248f67+=_0x23215f(0x16e)+formatNumber(_0xb04708[_0x23215f(0x162)](0x2))+_0x23215f(0x285),_0x248f67+=_0x23215f(0x16e)+formatNumber(_0x453cb2)+'</b></td>',_0x248f67+=_0x23215f(0x16e)+formatNumber(_0x20b36f)+_0x23215f(0x285),_0x248f67+=_0x23215f(0x16e)+formatNumber(_0x5e1c3b)+_0x23215f(0x285),_0x248f67+=_0x23215f(0x1c3);}_0x2a3580[_0x23215f(0x24d)](_0x248f67);}function _0x44399e(_0x1c5d25,_0x327f24){const _0x1b76b7=_0x23215f,_0x25e6bd=[];for(let _0x185102=0x0;_0x185102<=_0x1c5d25[_0x1b76b7(0x23f)]-0x1;_0x185102+=_0x327f24){_0x25e6bd[_0x1b76b7(0x24d)](_0x1c5d25[_0x1b76b7(0x20c)](_0x185102,_0x185102+_0x327f24));}return _0x25e6bd;}const _0x37e916=_0x44399e(_0x2a3580,_0x1f1af3);let _0x1853b1='';return _0x37e916[_0x23215f(0x12b)]((_0x43330a,_0x58f356)=>{const _0x978842=_0x23215f;_0x58f356>0x0&&(_0x1853b1+=_0x978842(0x190));_0x1853b1+='<table>',_0x1853b1+=_0x978842(0x1c8),_0x1853b1+=_0x978842(0x214),_0x1853b1+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x1853b1+='</tr>',_0x1853b1+='<tr>',_0x1853b1+=_0x978842(0x115);for(let _0x3b0fc6=0x0;_0x3b0fc6<=_0x367a88[_0x978842(0x23f)]-0x1;_0x3b0fc6++){const _0x55e23f=_0x367a88[_0x3b0fc6];for(let _0x5ea506=0x0;_0x5ea506<_0x4e2dbd['length'];_0x5ea506++){const _0x84a5dc=_0x4e2dbd[_0x5ea506];_0x84a5dc[_0x978842(0x14f)]===_0x55e23f[_0x978842(0x14f)]['category']&&(_0x1853b1+=_0x978842(0x149)+_0x84a5dc[_0x978842(0x111)]+_0x978842(0x1fa)+_0x55e23f[_0x978842(0x14f)][_0x978842(0x18e)]+_0x978842(0x108));}}_0x1853b1+=_0x978842(0x26e),_0x1853b1+='</tr>',_0x1853b1+=_0x978842(0x214),_0x1853b1+=_0x978842(0x240),_0x1853b1+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x1853b1+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x169a82=0x0;_0x169a82<=_0x367a88[_0x978842(0x23f)]-0x1;_0x169a82++){const _0x446ab1=_0x367a88[_0x169a82];for(let _0x4d54aa=0x0;_0x4d54aa<_0x2af25a[_0x978842(0x230)][_0x978842(0x23f)];_0x4d54aa++){const _0x546e24=_0x2af25a[_0x978842(0x230)][_0x4d54aa];_0x546e24[_0x978842(0x14f)][_0x978842(0x18e)]===_0x446ab1['_id'][_0x978842(0x18e)]&&(_0x1853b1+=_0x978842(0x11c)+_0x546e24[_0x978842(0x14f)][_0x978842(0x1b2)]+_0x978842(0x108));}}_0x1853b1+=_0x978842(0x241),_0x1853b1+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x1853b1+=_0x978842(0x19b),_0x1853b1+=_0x978842(0x166),_0x1853b1+='</tr>',_0x1853b1+=_0x978842(0x280),_0x1853b1+=_0x978842(0x1ba),_0x43330a[_0x978842(0x12b)](_0x3851dc=>{_0x1853b1+=_0x3851dc;}),console['log'](_0x20438d),_0x1853b1+=_0x978842(0x13f),_0x1853b1+=_0x978842(0x24a);}),_0x1853b1;}router[a0_0x12c55b(0x131)](a0_0x12c55b(0x130),auth,async(_0x14d37b,_0x3796b7)=>{const _0x438860=a0_0x12c55b,{from_date:_0x2869ce,to_date:_0x3dd18e,isExcel:_0x5dbdf3}=_0x14d37b[_0x438860(0x163)],_0x4ec450=_0x14d37b[_0x438860(0x242)],_0x39846f=await staff[_0x438860(0x249)]({'email':_0x4ec450[_0x438860(0x1d3)]}),_0x19f947=await master_shop[_0x438860(0x25d)]();console[_0x438860(0x1bf)](_0x19f947[0x0][_0x438860(0x233)]);const _0x50aacd=await agentsdataDSICheck(_0x2869ce,_0x3dd18e,_0x39846f[_0x438860(0x14f)][_0x438860(0x278)](),_0x5dbdf3),_0x4380e5=await agentsdataDSICheck_excel(_0x2869ce,_0x3dd18e,_0x39846f[_0x438860(0x14f)][_0x438860(0x278)](),_0x5dbdf3);let _0xd7050=_0x438860(0x155);var _0x3399f8=new Date(_0x2869ce),_0x3f8b07=new Date(_0x3dd18e);const _0x184325={'year':_0x438860(0x1fd),'month':_0x438860(0x229),'day':_0x438860(0x1fd)},_0x2f94b5=new Intl[(_0x438860(0x1b0))](_0x438860(0x1d7),_0x184325)['format'](_0x3399f8),_0x1722fe=new Intl[(_0x438860(0x1b0))](_0x438860(0x1d7),_0x184325)[_0x438860(0x17a)](_0x3f8b07);_0xd7050+=_0x438860(0x201),_0xd7050+=_0x438860(0x13d),_0xd7050+=_0x438860(0x1fb),_0xd7050+=_0x50aacd,_0xd7050+=_0x438860(0x24a),_0xd7050+=_0x438860(0x210),_0xd7050+='</div>';let _0x4c5b05=_0x438860(0x155);_0x4c5b05+=_0x438860(0x201),_0x4c5b05+='<div\x20\x20id=\x22table-conatainer\x22>',_0x4c5b05+=_0x438860(0x1fb),_0x4c5b05+=_0x4380e5,_0x4c5b05+='</table>',_0x4c5b05+=_0x438860(0x210),_0x4c5b05+=_0x438860(0x210);let _0x2c8e31=_0x438860(0x173);const _0x2309f8={'width':_0x438860(0x1d6),'height':_0x438860(0x1e9),'orientation':_0x438860(0x1f5),'border':{'top':_0x438860(0x145),'right':_0x438860(0x145),'bottom':_0x438860(0x145),'left':'0.1in'},'header':{'height':'60mm','contents':_0x438860(0x212)+_0x2c8e31+_0x438860(0x175)+_0x2f94b5+'\x20-\x20'+_0x1722fe+_0x438860(0x196)},'footer':{'height':_0x438860(0x17f),'contents':{'default':_0x438860(0x23e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x438860(0x10d)}}};if(_0x5dbdf3=='on'){const _0x5a5bbd=cheerio['load'](_0x4c5b05);let _0x19a11e=[],_0x7809ac=[],_0x156df1=[];const _0x302080=_0x1334f0=>{const _0x575748=_0x438860,_0x42c56c={'top':{'style':_0x575748(0x23b),'color':{'rgb':_0x575748(0x13b)}},'bottom':{'style':_0x575748(0x23b),'color':{'rgb':_0x575748(0x13b)}},'left':{'style':_0x575748(0x23b),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x1334f0){const _0x29e598=_0x1334f0['split'](';')['reduce']((_0x2d5194,_0x284a51)=>{const _0x43c7e0=_0x575748,[_0x353e26,_0x3e311a]=_0x284a51[_0x43c7e0(0x10f)](':')[_0x43c7e0(0x1cc)](_0x482833=>_0x482833[_0x43c7e0(0x1be)]());return _0x2d5194[_0x353e26]=_0x3e311a,_0x2d5194;},{});_0x29e598[_0x575748(0xfd)]&&(_0x42c56c['top'][_0x575748(0x276)]=_0x29e598['border-top'][_0x575748(0x251)]('thin')?_0x575748(0x1b8):_0x575748(0x245)),_0x29e598['border-bottom']&&(_0x42c56c[_0x575748(0x21d)]['style']=_0x29e598[_0x575748(0x243)][_0x575748(0x251)](_0x575748(0x1b8))?'thin':_0x575748(0x245)),_0x29e598['border-left']&&(_0x42c56c[_0x575748(0x203)][_0x575748(0x276)]=_0x29e598[_0x575748(0x234)][_0x575748(0x251)](_0x575748(0x1b8))?_0x575748(0x1b8):_0x575748(0x245)),_0x29e598[_0x575748(0x205)]&&(_0x42c56c[_0x575748(0x265)][_0x575748(0x276)]=_0x29e598[_0x575748(0x205)]['includes'](_0x575748(0x1b8))?_0x575748(0x1b8):_0x575748(0x245));}return _0x42c56c;};_0x5a5bbd(_0x438860(0x146))[_0x438860(0x1c0)]((_0x297839,_0x3d0b05)=>{const _0x41362f=_0x438860;let _0x5a43b8=[],_0x99a82b=0x0;while(_0x156df1[_0x99a82b]){_0x156df1[_0x99a82b]--,_0x99a82b++;}_0x5a5bbd(_0x3d0b05)['find'](_0x41362f(0x1b3))['each']((_0x55e798,_0x5975c4)=>{const _0xc9833a=_0x41362f;let _0x55ae7c=_0x5a5bbd(_0x5975c4)[_0xc9833a(0x218)]()[_0xc9833a(0x1be)](),_0x1cc21c=parseFloat(_0x55ae7c[_0xc9833a(0x283)](/,/g,'')),_0x517b48={};!isNaN(_0x1cc21c)?(_0x517b48['v']=_0x1cc21c,_0x517b48['t']='n'):(_0x517b48['v']=_0x55ae7c,_0x517b48['t']='s');const _0x116ecb=_0x5a5bbd(_0x5975c4)[_0xc9833a(0x178)]('style'),_0x162ee0=_0x302080(_0x116ecb);_0x517b48['s']={'border':_0x162ee0},_0x5a43b8[_0x99a82b]=_0x517b48;let _0x341c5d=parseInt(_0x5a5bbd(_0x5975c4)[_0xc9833a(0x178)](_0xc9833a(0x194)))||0x1,_0x345107=parseInt(_0x5a5bbd(_0x5975c4)[_0xc9833a(0x178)](_0xc9833a(0x1cf)))||0x1;(_0x341c5d>0x1||_0x345107>0x1)&&_0x7809ac[_0xc9833a(0x24d)]({'s':{'r':_0x297839,'c':_0x99a82b},'e':{'r':_0x297839+_0x345107-0x1,'c':_0x99a82b+_0x341c5d-0x1}});for(let _0x4de58e=0x0;_0x4de58e<_0x341c5d;_0x4de58e++){_0x345107>0x1&&(_0x156df1[_0x99a82b+_0x4de58e]=_0x345107-0x1);}_0x99a82b+=_0x341c5d;}),_0x19a11e[_0x41362f(0x24d)](_0x5a43b8);});const _0x1d6111=XLSX[_0x438860(0x16f)]['book_new'](),_0x29eb9a=XLSX[_0x438860(0x16f)][_0x438860(0x198)](_0x19a11e);_0x7809ac[_0x438860(0x23f)]>0x0&&(_0x29eb9a[_0x438860(0x15e)]=_0x7809ac);_0x29eb9a[_0x438860(0x180)]=_0x19a11e[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x438860(0x27a)](_0x1d6111,_0x29eb9a,'Sales\x20Report');const _0x375990=XLSX[_0x438860(0x25a)](_0x1d6111,{'bookType':'xlsx','type':_0x438860(0x109)});_0x3796b7[_0x438860(0x11b)](_0x438860(0x13a),_0x438860(0x269)),_0x3796b7[_0x438860(0x11b)](_0x438860(0x260),_0x438860(0x1a4)),_0x3796b7['send'](_0x375990);}else pdf[_0x438860(0x113)](_0xd7050,_0x2309f8)['toStream'](function(_0x334a9e,_0x1d8036){const _0xcc81f3=_0x438860;if(_0x334a9e){console['error'](_0xcc81f3(0x279),_0x334a9e),_0x3796b7[_0xcc81f3(0x252)](0x1f4)[_0xcc81f3(0x177)]('Error\x20generating\x20PDF'+_0x334a9e);return;}_0x3796b7[_0xcc81f3(0x11b)](_0xcc81f3(0x260),_0xcc81f3(0x21f)),_0x1d8036[_0xcc81f3(0x18f)](_0x3796b7);});}),router[a0_0x12c55b(0x1f9)]('/total_sales_reports/view',auth,async(_0x31d61e,_0x5bd20c)=>{const _0x1f04ee=a0_0x12c55b;try{const {username:_0x34a759,email:_0x43b31f,role:_0x24464a}=_0x31d61e[_0x1f04ee(0x242)],_0x2b3906=_0x31d61e['user'],_0x5a1848=await profile[_0x1f04ee(0x249)]({'email':_0x2b3906[_0x1f04ee(0x1d3)]}),_0x471608={'year':'numeric','month':_0x1f04ee(0x229),'day':_0x1f04ee(0x1fd)},_0x35c149=await master_shop['find'](),_0xdb64d0=await product[_0x1f04ee(0x25d)](),_0x36cd24=await warehouse['aggregate']([{'$unwind':_0x1f04ee(0x128)},{'$lookup':{'from':_0x1f04ee(0x287),'localField':_0x1f04ee(0x179),'foreignField':'name','as':_0x1f04ee(0x1f3)}},{'$unwind':_0x1f04ee(0x1ab)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x1f04ee(0x129)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x1f04ee(0x15f)}}}]),_0x41ab77=await staff[_0x1f04ee(0x249)]({'email':_0x2b3906[_0x1f04ee(0x1d3)]});if(_0x35c149[0x0][_0x1f04ee(0x10a)]==_0x1f04ee(0x257))var _0x3e61e1=users[_0x1f04ee(0x27b)];else{if(_0x35c149[0x0][_0x1f04ee(0x10a)]=='Hindi')var _0x3e61e1=users[_0x1f04ee(0x256)];else{if(_0x35c149[0x0][_0x1f04ee(0x10a)]==_0x1f04ee(0x187))var _0x3e61e1=users[_0x1f04ee(0x187)];else{if(_0x35c149[0x0][_0x1f04ee(0x10a)]==_0x1f04ee(0x126))var _0x3e61e1=users[_0x1f04ee(0x126)];else{if(_0x35c149[0x0][_0x1f04ee(0x10a)]=='French')var _0x3e61e1=users['French'];else{if(_0x35c149[0x0][_0x1f04ee(0x10a)]==_0x1f04ee(0x209))var _0x3e61e1=users['Portuguese'];else{if(_0x35c149[0x0]['language']==_0x1f04ee(0x188))var _0x3e61e1=users['Chinese'];else{if(_0x35c149[0x0][_0x1f04ee(0x10a)]==_0x1f04ee(0x15c))var _0x3e61e1=users[_0x1f04ee(0x22a)];}}}}}}}_0x5bd20c[_0x1f04ee(0x237)](_0x1f04ee(0x254),{'success':_0x31d61e[_0x1f04ee(0x19a)](_0x1f04ee(0x238)),'errors':_0x31d61e[_0x1f04ee(0x19a)]('errors'),'alldata':_0xdb64d0,'profile':_0x5a1848,'master_shop':_0x35c149,'role':_0x2b3906,'product_stock':_0x36cd24,'language':_0x3e61e1,'staff_arr':_0x41ab77});}catch(_0x33e7fe){}});async function dataSalesReports(_0x15aa2d,_0x27dc08,_0x5c2642){const _0x4d78a5=a0_0x12c55b;let _0x39d74e='';const _0x4a3225=await sales_sa[_0x4d78a5(0x27d)]([{'$match':{'date':{'$gte':_0x15aa2d,'$lte':_0x27dc08},'sales_staff_id':_0x5c2642}},{'$unwind':_0x4d78a5(0x1f8)},{'$match':{'sale_product.isFG':_0x4d78a5(0x277)}},{'$group':{'_id':{'product_name':_0x4d78a5(0x103),'product_code':_0x4d78a5(0x1ae)},'sumqty':{'$sum':_0x4d78a5(0x231)},'totalPrice':{'$sum':_0x4d78a5(0x219)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x3e6b0c=0x0,_0x490e1f=0x0;for(let _0xd2091e=0x0;_0xd2091e<=_0x4a3225['length']-0x1;_0xd2091e++){const _0x54ef32=_0x4a3225[_0xd2091e];var _0x481f10=_0x54ef32[_0x4d78a5(0x23a)][_0x4d78a5(0x27f)](undefined),_0x27c337=_0x54ef32[_0x4d78a5(0x158)][_0x4d78a5(0x27f)](undefined);_0x39d74e+=_0x4d78a5(0x214),_0x39d74e+=_0x4d78a5(0x1b6)+_0x54ef32[_0x4d78a5(0x14f)][_0x4d78a5(0x1ea)]+_0x4d78a5(0x108),_0x39d74e+='<td\x20class=\x22row_data\x22>'+_0x54ef32[_0x4d78a5(0x14f)]['product_name']+'</td>',_0x39d74e+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x54ef32['sumqty'][_0x4d78a5(0x162)](0x2))+_0x4d78a5(0x108),_0x39d74e+=_0x4d78a5(0x1b6)+formatNumber(_0x54ef32[_0x4d78a5(0x23a)]['toFixed'](0x2))+'</td>',_0x39d74e+='</tr>',_0x3e6b0c+=parseFloat(_0x54ef32['sumqty']),_0x490e1f+=parseFloat(_0x54ef32[_0x4d78a5(0x23a)]);}var _0x36747c=_0x490e1f[_0x4d78a5(0x27f)](undefined),_0x34f7c5=_0x3e6b0c[_0x4d78a5(0x27f)](undefined);return _0x39d74e+=_0x4d78a5(0x214),_0x39d74e+=_0x4d78a5(0x117),_0x39d74e+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x3e6b0c[_0x4d78a5(0x162)](0x2))+'</b></td>',_0x39d74e+=_0x4d78a5(0x1d4)+formatNumber(_0x490e1f[_0x4d78a5(0x162)](0x2))+_0x4d78a5(0x285),_0x39d74e+=_0x4d78a5(0x1c3),_0x39d74e;}router['post']('/total_sales_reports/pdf',auth,async(_0x563fc5,_0xd17d3)=>{const _0x3771ec=a0_0x12c55b;try{const {from_date:_0x1c6fe8,to_date:_0x29c211,isExcel:_0x3353ba}=_0x563fc5['body'],_0xb5e992=_0x563fc5[_0x3771ec(0x242)],_0x4dd7f=await staff[_0x3771ec(0x249)]({'email':_0xb5e992[_0x3771ec(0x1d3)]});let _0x383048='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x37f764=new Date(_0x1c6fe8),_0xf8e9d=new Date(_0x29c211);const _0x194a52={'year':_0x3771ec(0x1fd),'month':'long','day':_0x3771ec(0x1fd)},_0x29c0ed=new Intl[(_0x3771ec(0x1b0))](_0x3771ec(0x1d7),_0x194a52)['format'](_0x37f764),_0x1de427=new Intl['DateTimeFormat']('en-US',_0x194a52)[_0x3771ec(0x17a)](_0xf8e9d);var _0x3a8f1a=await dataSalesReports(_0x1c6fe8,_0x29c211,_0x4dd7f[_0x3771ec(0x14f)][_0x3771ec(0x278)]());_0x383048+='<div\x20class=\x22row\x22>',_0x383048+=_0x3771ec(0x225),_0x383048+='<table>',_0x383048+=_0x3771ec(0x214),_0x383048+=_0x3771ec(0x107),_0x383048+=_0x3771ec(0x1ca),_0x383048+='<th>\x20QTY\x20SOLD\x20</th>',_0x383048+=_0x3771ec(0x1c6),_0x383048+=_0x3771ec(0x214),_0x383048+=_0x3a8f1a,_0x383048+=_0x3771ec(0x1c3),_0x383048+=_0x3771ec(0x210),_0x383048+=_0x3771ec(0x210);let _0x2f95a8='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x4a51cc={'width':_0x3771ec(0x1d6),'height':_0x3771ec(0x1e9),'orientation':'landscape','border':{'top':'0.1in','right':_0x3771ec(0x145),'bottom':_0x3771ec(0x145),'left':'0.1in'},'header':{'height':'60mm','contents':_0x3771ec(0x212)+_0x2f95a8+_0x3771ec(0x11d)+_0x4dd7f['name']+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x29c0ed+_0x3771ec(0x14b)+_0x1de427+_0x3771ec(0x196)},'footer':{'height':'20mm','contents':{'default':_0x3771ec(0x23e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3771ec(0x10d)}}};if(_0x3353ba=='on'){const _0x81e288=cheerio[_0x3771ec(0x199)](_0x383048);let _0x74a6ed=[],_0x563e5e=[],_0x22887=[];const _0x154a11=_0x33b6d1=>{const _0x5e1219=_0x3771ec,_0xb5256c={'top':{'style':_0x5e1219(0x23b),'color':{'rgb':'000000'}},'bottom':{'style':_0x5e1219(0x23b),'color':{'rgb':_0x5e1219(0x13b)}},'left':{'style':_0x5e1219(0x23b),'color':{'rgb':_0x5e1219(0x13b)}},'right':{'style':'thick','color':{'rgb':_0x5e1219(0x13b)}}};if(_0x33b6d1){const _0x180f2c=_0x33b6d1[_0x5e1219(0x10f)](';')[_0x5e1219(0x21b)]((_0x167b60,_0x5468b2)=>{const _0x4a58e4=_0x5e1219,[_0x1799da,_0x50995b]=_0x5468b2[_0x4a58e4(0x10f)](':')['map'](_0x2517f7=>_0x2517f7[_0x4a58e4(0x1be)]());return _0x167b60[_0x1799da]=_0x50995b,_0x167b60;},{});_0x180f2c[_0x5e1219(0xfd)]&&(_0xb5256c[_0x5e1219(0x11e)][_0x5e1219(0x276)]=_0x180f2c[_0x5e1219(0xfd)][_0x5e1219(0x251)](_0x5e1219(0x1b8))?_0x5e1219(0x1b8):'medium'),_0x180f2c['border-bottom']&&(_0xb5256c[_0x5e1219(0x21d)][_0x5e1219(0x276)]=_0x180f2c[_0x5e1219(0x243)]['includes']('thin')?_0x5e1219(0x1b8):_0x5e1219(0x245)),_0x180f2c[_0x5e1219(0x234)]&&(_0xb5256c[_0x5e1219(0x203)][_0x5e1219(0x276)]=_0x180f2c[_0x5e1219(0x234)][_0x5e1219(0x251)]('thin')?'thin':_0x5e1219(0x245)),_0x180f2c[_0x5e1219(0x205)]&&(_0xb5256c[_0x5e1219(0x265)][_0x5e1219(0x276)]=_0x180f2c[_0x5e1219(0x205)][_0x5e1219(0x251)](_0x5e1219(0x1b8))?'thin':'medium');}return _0xb5256c;};_0x81e288('table\x20tr')[_0x3771ec(0x1c0)]((_0x4f033c,_0x580619)=>{const _0x1acf54=_0x3771ec;let _0x5cc000=[],_0x381720=0x0;while(_0x22887[_0x381720]){_0x22887[_0x381720]--,_0x381720++;}_0x81e288(_0x580619)['find'](_0x1acf54(0x1b3))['each']((_0x50de85,_0x5509cf)=>{const _0x23889e=_0x1acf54;let _0x4669a9=_0x81e288(_0x5509cf)[_0x23889e(0x218)]()[_0x23889e(0x1be)](),_0x37ed84=parseFloat(_0x4669a9[_0x23889e(0x283)](/,/g,'')),_0x114181={};!isNaN(_0x37ed84)?(_0x114181['v']=_0x37ed84,_0x114181['t']='n'):(_0x114181['v']=_0x4669a9,_0x114181['t']='s');const _0x51825a=_0x81e288(_0x5509cf)[_0x23889e(0x178)](_0x23889e(0x276)),_0x42c7ef=_0x154a11(_0x51825a);_0x114181['s']={'border':_0x42c7ef},_0x5cc000[_0x381720]=_0x114181;let _0x22bcc6=parseInt(_0x81e288(_0x5509cf)[_0x23889e(0x178)](_0x23889e(0x194)))||0x1,_0x1d9c3d=parseInt(_0x81e288(_0x5509cf)[_0x23889e(0x178)](_0x23889e(0x1cf)))||0x1;(_0x22bcc6>0x1||_0x1d9c3d>0x1)&&_0x563e5e[_0x23889e(0x24d)]({'s':{'r':_0x4f033c,'c':_0x381720},'e':{'r':_0x4f033c+_0x1d9c3d-0x1,'c':_0x381720+_0x22bcc6-0x1}});for(let _0x5395da=0x0;_0x5395da<_0x22bcc6;_0x5395da++){_0x1d9c3d>0x1&&(_0x22887[_0x381720+_0x5395da]=_0x1d9c3d-0x1);}_0x381720+=_0x22bcc6;}),_0x74a6ed[_0x1acf54(0x24d)](_0x5cc000);});const _0x4acecc=XLSX['utils'][_0x3771ec(0x1bc)](),_0x63d45e=XLSX[_0x3771ec(0x16f)][_0x3771ec(0x198)](_0x74a6ed);_0x563e5e[_0x3771ec(0x23f)]>0x0&&(_0x63d45e[_0x3771ec(0x15e)]=_0x563e5e);_0x63d45e[_0x3771ec(0x180)]=_0x74a6ed[0x0][_0x3771ec(0x1cc)](()=>({'wpx':0x64})),XLSX[_0x3771ec(0x16f)][_0x3771ec(0x27a)](_0x4acecc,_0x63d45e,_0x3771ec(0x132));const _0x18df78=XLSX[_0x3771ec(0x25a)](_0x4acecc,{'bookType':_0x3771ec(0x204),'type':_0x3771ec(0x109)});_0xd17d3[_0x3771ec(0x11b)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0xd17d3[_0x3771ec(0x11b)](_0x3771ec(0x260),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0xd17d3[_0x3771ec(0x177)](_0x18df78);}else pdf[_0x3771ec(0x113)](_0x383048,_0x4a51cc)[_0x3771ec(0x26a)](function(_0x3b2fd8,_0x4a03eb){const _0x8ab8bc=_0x3771ec;if(_0x3b2fd8){_0xd17d3['status'](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0xd17d3['setHeader'](_0x8ab8bc(0x260),_0x8ab8bc(0x21f)),_0x4a03eb[_0x8ab8bc(0x18f)](_0xd17d3);});}catch(_0xd4fddc){}}),router[a0_0x12c55b(0x1f9)](a0_0x12c55b(0x1b7),auth,async(_0x1123e1,_0x36c1a5)=>{const _0x351a6d=a0_0x12c55b;try{const {username:_0x5314cd,email:_0x1a94ec,role:_0x5e813e}=_0x1123e1[_0x351a6d(0x242)],_0x18dc29=_0x1123e1[_0x351a6d(0x242)],_0x2789e7=await profile[_0x351a6d(0x249)]({'email':_0x18dc29[_0x351a6d(0x1d3)]}),_0x123110={'year':'numeric','month':_0x351a6d(0x229),'day':_0x351a6d(0x1fd)},_0x4a56f9=await master_shop[_0x351a6d(0x25d)](),_0x189770=await product[_0x351a6d(0x25d)](),_0x21869f=await warehouse[_0x351a6d(0x27d)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x351a6d(0x287),'localField':_0x351a6d(0x179),'foreignField':_0x351a6d(0x16a),'as':_0x351a6d(0x1f3)}},{'$unwind':_0x351a6d(0x1ab)},{'$project':{'product_name':_0x351a6d(0x1c7),'product_stock':_0x351a6d(0x129)}},{'$group':{'_id':_0x351a6d(0x262),'product_stock':{'$sum':_0x351a6d(0x15f)}}}]);if(_0x4a56f9[0x0][_0x351a6d(0x10a)]==_0x351a6d(0x257))var _0x8f091b=users[_0x351a6d(0x27b)];else{if(_0x4a56f9[0x0][_0x351a6d(0x10a)]==_0x351a6d(0x256))var _0x8f091b=users[_0x351a6d(0x256)];else{if(_0x4a56f9[0x0][_0x351a6d(0x10a)]==_0x351a6d(0x187))var _0x8f091b=users[_0x351a6d(0x187)];else{if(_0x4a56f9[0x0]['language']==_0x351a6d(0x126))var _0x8f091b=users[_0x351a6d(0x126)];else{if(_0x4a56f9[0x0]['language']==_0x351a6d(0x114))var _0x8f091b=users[_0x351a6d(0x114)];else{if(_0x4a56f9[0x0][_0x351a6d(0x10a)]==_0x351a6d(0x209))var _0x8f091b=users[_0x351a6d(0x143)];else{if(_0x4a56f9[0x0]['language']=='Chinese')var _0x8f091b=users[_0x351a6d(0x188)];else{if(_0x4a56f9[0x0][_0x351a6d(0x10a)]==_0x351a6d(0x15c))var _0x8f091b=users[_0x351a6d(0x22a)];}}}}}}}_0x36c1a5[_0x351a6d(0x237)](_0x351a6d(0x266),{'success':_0x1123e1[_0x351a6d(0x19a)](_0x351a6d(0x238)),'errors':_0x1123e1['flash']('errors'),'alldata':_0x189770,'profile':_0x2789e7,'master_shop':_0x4a56f9,'role':_0x18dc29,'product_stock':_0x21869f,'language':_0x8f091b});}catch(_0x4d9253){}});async function dataInventoryReports(_0x52e576,_0x395224,_0x761d03){const _0x111b7c=a0_0x12c55b,_0x15f6c4=await sales_sa[_0x111b7c(0x27d)]([{'$match':{'date':{'$gte':_0x52e576,'$lte':_0x395224},'sales_staff_id':_0x761d03}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x111b7c(0x103),'product_code':_0x111b7c(0x1ae)},'sumqty':{'$sum':_0x111b7c(0x1d5)}}},{'$sort':{'_id.product_name':0x1}}]),_0x35a4f7=mongoose[_0x111b7c(0x16b)][_0x111b7c(0x27c)],_0x51a465=await staff[_0x111b7c(0x27d)]([{'$match':{'_id':_0x35a4f7(_0x761d03)}},{'$unwind':_0x111b7c(0x213)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x111b7c(0x195),'product_code':_0x111b7c(0x221)},'sumqty':{'$sum':_0x111b7c(0x25b)}}},{'$sort':{'_id.product_name':0x1}}]),_0x48c3c4=await sales_inv_data[_0x111b7c(0x27d)]([{'$match':{'date':{'$gte':_0x52e576,'$lte':_0x395224},'sales_staff_id':_0x761d03}},{'$unwind':_0x111b7c(0x1f8)},{'$group':{'_id':{'product_name':_0x111b7c(0x103),'product_code':'$sale_product.product_code'},'totalQTYsum':{'$sum':_0x111b7c(0x170)}}}]);console[_0x111b7c(0x1bf)](_0x48c3c4);let _0x577352='';var _0x1551aa=0x0;for(let _0x12a290=0x0;_0x12a290<=_0x51a465[_0x111b7c(0x23f)]-0x1;_0x12a290++){const _0x38a75f=_0x51a465[_0x12a290];_0x577352+=_0x111b7c(0x214),_0x577352+=_0x111b7c(0x274)+_0x38a75f[_0x111b7c(0x14f)][_0x111b7c(0x1ea)]+_0x111b7c(0x108),_0x577352+=_0x111b7c(0x123)+_0x38a75f[_0x111b7c(0x14f)][_0x111b7c(0xfe)]+_0x111b7c(0x108);var _0x5755a7=_0x38a75f[_0x111b7c(0x158)],_0x4df40d=0x0;for(let _0x55b0a9=0x0;_0x55b0a9<=_0x15f6c4['length']-0x1;_0x55b0a9++){const _0x96dd80=_0x15f6c4[_0x55b0a9];_0x38a75f[_0x111b7c(0x14f)][_0x111b7c(0x1ea)]==_0x96dd80[_0x111b7c(0x14f)][_0x111b7c(0x1ea)]&&_0x38a75f[_0x111b7c(0x14f)][_0x111b7c(0xfe)]==_0x96dd80[_0x111b7c(0x14f)][_0x111b7c(0xfe)]&&(_0x4df40d=_0x96dd80[_0x111b7c(0x158)]);}var _0x28eadc=0x0;for(let _0x2d83bd=0x0;_0x2d83bd<=_0x48c3c4[_0x111b7c(0x23f)]-0x1;_0x2d83bd++){const _0x5ba7b2=_0x48c3c4[_0x2d83bd];_0x38a75f[_0x111b7c(0x14f)][_0x111b7c(0x1ea)]==_0x5ba7b2[_0x111b7c(0x14f)]['product_code']&&_0x38a75f[_0x111b7c(0x14f)][_0x111b7c(0xfe)]==_0x5ba7b2['_id'][_0x111b7c(0xfe)]&&(_0x28eadc=_0x5ba7b2['totalQTYsum']);}_0x1551aa=_0x5755a7-_0x28eadc+_0x4df40d,_0x577352+=_0x111b7c(0x1b6)+_0x1551aa+'</td>';let _0x434016=![];for(let _0x5358e7=0x0;_0x5358e7<=_0x48c3c4[_0x111b7c(0x23f)]-0x1;_0x5358e7++){const _0x20dcc8=_0x48c3c4[_0x5358e7];if(_0x38a75f[_0x111b7c(0x14f)]['product_code']==_0x20dcc8[_0x111b7c(0x14f)][_0x111b7c(0x1ea)]&&_0x38a75f[_0x111b7c(0x14f)][_0x111b7c(0xfe)]==_0x20dcc8[_0x111b7c(0x14f)][_0x111b7c(0xfe)]){_0x577352+=_0x111b7c(0x1b6)+_0x20dcc8['totalQTYsum']+'</td>',_0x434016=!![];break;}}!_0x434016&&(_0x577352+='<td\x20class=\x22row_data\x22>0</td>');let _0x4c89da=![];for(let _0x57e7cc=0x0;_0x57e7cc<=_0x15f6c4['length']-0x1;_0x57e7cc++){const _0x3991ff=_0x15f6c4[_0x57e7cc];if(_0x38a75f[_0x111b7c(0x14f)]['product_code']==_0x3991ff[_0x111b7c(0x14f)]['product_code']&&_0x38a75f[_0x111b7c(0x14f)][_0x111b7c(0xfe)]==_0x3991ff['_id'][_0x111b7c(0xfe)]){_0x577352+=_0x111b7c(0x1b6)+_0x3991ff['sumqty']+_0x111b7c(0x108),_0x4c89da=!![];break;}}!_0x4c89da&&(_0x577352+=_0x111b7c(0x110)),_0x577352+=_0x111b7c(0x1b6)+_0x38a75f[_0x111b7c(0x158)]+'</td>',_0x577352+=_0x111b7c(0x1c3);}return _0x577352;}router[a0_0x12c55b(0x131)](a0_0x12c55b(0x19f),auth,async(_0x3db641,_0x984233)=>{const _0x44da72=a0_0x12c55b;try{const {from_date:_0x2dae59,to_date:_0x1e72ed}=_0x3db641[_0x44da72(0x163)],_0xdec2=_0x3db641[_0x44da72(0x242)],_0xb411b2=await staff[_0x44da72(0x249)]({'email':_0xdec2['email']});let _0x4924a2=_0x44da72(0x236);var _0x21dacd=new Date(_0x2dae59),_0x58ec45=new Date(_0x1e72ed);const _0x161a6a={'year':_0x44da72(0x1fd),'month':_0x44da72(0x229),'day':_0x44da72(0x1fd)},_0x355586=new Intl[(_0x44da72(0x1b0))](_0x44da72(0x1d7),_0x161a6a)[_0x44da72(0x17a)](_0x21dacd),_0x2e3e1c=new Intl[(_0x44da72(0x1b0))](_0x44da72(0x1d7),_0x161a6a)[_0x44da72(0x17a)](_0x58ec45);var _0x4f0f20=await dataInventoryReports(_0x2dae59,_0x1e72ed,_0xb411b2['_id'][_0x44da72(0x278)]());_0x4924a2+=_0x44da72(0x26d),_0x4924a2+=_0x44da72(0x20f),_0x4924a2+=_0x44da72(0x1de)+_0x355586+_0x44da72(0x14b)+_0x2e3e1c+_0x44da72(0x264),_0x4924a2+=_0x44da72(0x201),_0x4924a2+=_0x44da72(0x225),_0x4924a2+=_0x44da72(0x1fb),_0x4924a2+=_0x44da72(0x214),_0x4924a2+=_0x44da72(0x107),_0x4924a2+=_0x44da72(0x1ca),_0x4924a2+=_0x44da72(0x24f),_0x4924a2+='<th>\x20INCOMING\x20</th>',_0x4924a2+=_0x44da72(0x22c),_0x4924a2+=_0x44da72(0x208),_0x4924a2+=_0x44da72(0x214),_0x4924a2+=_0x4f0f20,_0x4924a2+=_0x44da72(0x1c3),_0x4924a2+=_0x44da72(0x210),_0x4924a2+=_0x44da72(0x210);const _0x3c42ba={'format':'Letter','orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x44da72(0x10d)}}};pdf[_0x44da72(0x113)](_0x4924a2,_0x3c42ba)[_0x44da72(0x26a)](function(_0x59a43b,_0xc56c9f){const _0x59e84c=_0x44da72;if(_0x59a43b){_0x984233['status'](0x1f4)[_0x59e84c(0x177)](_0x59e84c(0x1d1));return;}_0x984233[_0x59e84c(0x11b)](_0x59e84c(0x260),_0x59e84c(0x21f)),_0xc56c9f[_0x59e84c(0x18f)](_0x984233);});}catch(_0x5d5879){}}),router[a0_0x12c55b(0x1f9)]('/dsrr/view',auth,async(_0x44cdf5,_0x489ea7)=>{const _0x4c846f=a0_0x12c55b;try{const {username:_0x3ad0f0,email:_0x4460d4,role:_0xb95ffc}=_0x44cdf5[_0x4c846f(0x242)],_0x4e3ca1=_0x44cdf5[_0x4c846f(0x242)],_0x487770=await profile[_0x4c846f(0x249)]({'email':_0x4e3ca1[_0x4c846f(0x1d3)]}),_0x2777a6={'year':_0x4c846f(0x1fd),'month':_0x4c846f(0x229),'day':'numeric'},_0x4d288e=await master_shop[_0x4c846f(0x25d)]();console[_0x4c846f(0x1bf)]('Products\x20master',_0x4d288e);const _0x122070=await product[_0x4c846f(0x25d)]();console['log']('Products\x20find_data',_0x122070);const _0x33229a=await warehouse['aggregate']([{'$unwind':_0x4c846f(0x128)},{'$lookup':{'from':_0x4c846f(0x287),'localField':'product_details.product_name','foreignField':_0x4c846f(0x16a),'as':_0x4c846f(0x1f3)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x4c846f(0x1c7),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x4c846f(0x262),'product_stock':{'$sum':_0x4c846f(0x15f)}}}]);console[_0x4c846f(0x1bf)](_0x4c846f(0x1ce),_0x33229a),_0x33229a['forEach'](_0x3d41c0=>{const _0x39b9fa=_0x4c846f,_0x1f465c=_0x122070[_0x39b9fa(0x1cc)](_0x2c9445=>{const _0x4d07be=_0x39b9fa;_0x2c9445[_0x4d07be(0x16a)]==_0x3d41c0['_id']&&(_0x2c9445[_0x4d07be(0x24c)]=parseInt(_0x2c9445[_0x4d07be(0x24c)])+parseInt(_0x3d41c0[_0x4d07be(0x120)]));});});const _0x417875=await staff[_0x4c846f(0x249)]({'email':_0x4e3ca1['email']});if(_0x4d288e[0x0][_0x4c846f(0x10a)]==_0x4c846f(0x257))var _0x4086f6=users[_0x4c846f(0x27b)];else{if(_0x4d288e[0x0][_0x4c846f(0x10a)]=='Hindi')var _0x4086f6=users[_0x4c846f(0x256)];else{if(_0x4d288e[0x0]['language']==_0x4c846f(0x187))var _0x4086f6=users['German'];else{if(_0x4d288e[0x0][_0x4c846f(0x10a)]==_0x4c846f(0x126))var _0x4086f6=users[_0x4c846f(0x126)];else{if(_0x4d288e[0x0]['language']==_0x4c846f(0x114))var _0x4086f6=users[_0x4c846f(0x114)];else{if(_0x4d288e[0x0][_0x4c846f(0x10a)]==_0x4c846f(0x209))var _0x4086f6=users[_0x4c846f(0x143)];else{if(_0x4d288e[0x0][_0x4c846f(0x10a)]==_0x4c846f(0x188))var _0x4086f6=users[_0x4c846f(0x188)];else{if(_0x4d288e[0x0][_0x4c846f(0x10a)]=='Arabic\x20(ae)')var _0x4086f6=users['Arabic'];}}}}}}}_0x489ea7[_0x4c846f(0x237)](_0x4c846f(0x21c),{'success':_0x44cdf5[_0x4c846f(0x19a)](_0x4c846f(0x238)),'errors':_0x44cdf5[_0x4c846f(0x19a)](_0x4c846f(0x281)),'alldata':_0x122070,'profile':_0x487770,'master_shop':_0x4d288e,'role':_0x4e3ca1,'product_stock':_0x33229a,'language':_0x4086f6,'staff_arr':_0x417875});}catch(_0x5cac46){}});async function agentsdataDSICheck_DSRR(_0x54bb2a,_0x4950f0,_0xbda12b,_0x5d1eee){const _0x4df497=a0_0x12c55b;let _0x5f4bcc=new Date(_0x54bb2a);_0x5f4bcc['setDate'](_0x5f4bcc[_0x4df497(0x28a)]()-0x1);let _0xfcc856=_0x5f4bcc[_0x4df497(0x1a8)]()[_0x4df497(0x10f)]('T')[0x0];const _0x770d0d=await product[_0x4df497(0x27d)]([{'$group':{'_id':{'brand':'$brand','category':_0x4df497(0x23d)},'products':{'$push':{'name':_0x4df497(0x24b),'product_code':_0x4df497(0x138)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x15dec9=[];_0x15dec9[_0x4df497(0x230)]=[];for(let _0x51f625=0x0;_0x51f625<=_0x770d0d[_0x4df497(0x23f)]-0x1;_0x51f625++){const _0x5b1c0c=_0x770d0d[_0x51f625];_0x15dec9[_0x4df497(0x230)][_0x4df497(0x24d)](_0x5b1c0c);}const _0x2fab48=await product[_0x4df497(0x27d)]([{'$group':{'_id':{'category':_0x4df497(0x23d)},'products':{'$push':{'brand':'$brand','product_code':_0x4df497(0x138),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0xdcdd87=await product[_0x4df497(0x27d)]([{'$group':{'_id':{'category':_0x4df497(0x23d),'brand':_0x4df497(0x1af)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x46cf06=await sales_sa[_0x4df497(0x27d)]([{'$match':{'date':_0x54bb2a,'sales_staff_id':_0x4950f0,'sale_product.isFG':'false'}},{'$unwind':_0x4df497(0x1f8)},{'$lookup':{'from':_0x4df497(0x287),'localField':_0x4df497(0x150),'foreignField':_0x4df497(0x1ea),'as':_0x4df497(0x22f)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':_0x4df497(0x1ac),'status_data':_0x4df497(0x1fe)},'totalQty':{'$sum':_0x4df497(0x231)},'cash':{'$first':_0x4df497(0x1ad)},'amount':{'$first':_0x4df497(0x1f2)},'bank':{'$first':_0x4df497(0x21a)},'check_no':{'$first':_0x4df497(0x161)},'due_date':{'$first':_0x4df497(0x10c)},'products':{'$push':{'qty':_0x4df497(0x231),'NetPrice':_0x4df497(0x219),'discount':_0x4df497(0x1c9),'adj_discount':_0x4df497(0x253),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x4df497(0x147),'gross_price':_0x4df497(0x142),'isFG':_0x4df497(0x121),'prod_cat':'$sale_product.prod_cat','prod_id':'$sale_product._id'}}}}},{'$unwind':_0x4df497(0x104)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x4df497(0x1c2),'customer':_0x4df497(0x119),'status_data':_0x4df497(0x1ec),'category':'$products.product_details.category','brand':'$products.product_details.brand','prod_id':_0x4df497(0x286)},'totalQty':{'$sum':_0x4df497(0x1e5)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x4df497(0x1db)]}},'NetPrice':{'$sum':_0x4df497(0x1f4)},'discount':{'$sum':_0x4df497(0x26c)},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':_0x4df497(0x1ad)},'amount':{'$first':_0x4df497(0x1f2)},'bank':{'$first':_0x4df497(0x21a)},'check_no':{'$first':_0x4df497(0x161)},'due_date':{'$first':_0x4df497(0x10c)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x4df497(0x18c),'date':_0x4df497(0x1c2),'customer':_0x4df497(0x119),'status_data':_0x4df497(0x1ec)},'totalQty':{'$sum':_0x4df497(0x1b4)},'totalGross':{'$sum':_0x4df497(0x239)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x4df497(0x136)},'adj_discount':{'$sum':_0x4df497(0x17c)},'cash':{'$first':_0x4df497(0x1ad)},'amount':{'$first':_0x4df497(0x1f2)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x4df497(0x10c)},'products':{'$push':{'qty':_0x4df497(0x1b4),'category':_0x4df497(0x134),'brand':_0x4df497(0x14e),'product_details':_0x4df497(0x128)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x4967cf=await sales_sa[_0x4df497(0x27d)]([{'$match':{'date':_0xfcc856,'sales_staff_id':_0x4950f0,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x4df497(0x287),'localField':_0x4df497(0x150),'foreignField':_0x4df497(0x1ea),'as':'product_info'}},{'$unwind':_0x4df497(0x1a1)},{'$group':{'_id':{'dsi':_0x4df497(0x106),'date':_0x4df497(0x133),'customer':'$customer'},'totalQty':{'$sum':_0x4df497(0x231)},'cash':{'$first':_0x4df497(0x1ad)},'amount':{'$first':_0x4df497(0x1f2)},'bank':{'$first':_0x4df497(0x21a)},'check_no':{'$first':_0x4df497(0x161)},'due_date':{'$first':_0x4df497(0x10c)},'products':{'$push':{'qty':_0x4df497(0x231),'NetPrice':_0x4df497(0x219),'discount':_0x4df497(0x1c9),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x4df497(0x171),'product_code':_0x4df497(0x20d),'category':_0x4df497(0x1a3),'brand':_0x4df497(0x147),'gross_price':_0x4df497(0x142),'isFG':_0x4df497(0x121),'prod_cat':_0x4df497(0x1aa),'prod_id':'$sale_product._id'}}}}},{'$unwind':_0x4df497(0x104)},{'$group':{'_id':{'dsi':_0x4df497(0x18c),'date':'$_id.date','customer':_0x4df497(0x119),'category':_0x4df497(0x268),'brand':_0x4df497(0x17b),'prod_id':_0x4df497(0x286)},'totalQty':{'$sum':_0x4df497(0x1e5)},'cash':{'$first':_0x4df497(0x1ad)},'amount':{'$first':'$amount'},'bank':{'$first':_0x4df497(0x21a)},'check_no':{'$first':_0x4df497(0x161)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':{'$multiply':[_0x4df497(0x1e5),_0x4df497(0x1db)]}},'NetPrice':{'$sum':_0x4df497(0x1f4)},'discount':{'$sum':_0x4df497(0x26c)},'adj_discount':{'$sum':_0x4df497(0x272)},'product_details':{'$first':_0x4df497(0x28d)}}},{'$group':{'_id':{'dsi':_0x4df497(0x18c),'date':_0x4df497(0x1c2),'customer':_0x4df497(0x119)},'totalQty':{'$sum':_0x4df497(0x1b4)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x4df497(0x21a)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x4df497(0x10c)},'totalGross':{'$sum':_0x4df497(0x239)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x4df497(0x1b4),'category':'$_id.category','brand':_0x4df497(0x14e),'product_details':_0x4df497(0x128)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x48a095=await sales_sa[_0x4df497(0x27d)]([{'$match':{'date':_0x54bb2a,'sales_staff_id':_0x4950f0,'status_data':_0x4df497(0x19e)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x2a2016=await staff['findById'](_0x4950f0);let _0x1a3d70=[],_0x16dd13={},_0x45104d={};var _0x13facf=0x0,_0x28ce09=0x0,_0x52f5c0=0x0,_0x3d7274=0x0,_0xfd6a68=0x0;const _0x19c976=0x6;var _0x2f3d92=0x0,_0x57d173=0x0;for(let _0xfae434=0x0;_0xfae434<=_0x46cf06['length']-0x1;_0xfae434++){const _0x51e3cd=_0x46cf06[_0xfae434];let _0x2a7297=_0x4df497(0x214);_0x2a7297+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x2a7297+=_0x4df497(0x185)+_0x51e3cd[_0x4df497(0x14f)][_0x4df497(0x1a7)]+_0x4df497(0x108),_0x2a7297+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x51e3cd[_0x4df497(0x14f)]['dsi']+'</td>';let _0x258039={},_0x3bd11e={},_0x578d58={};var _0x509f9e={},_0x5becaf={},_0x260709={},_0x3cab09=0x0;for(let _0x5430d0=0x0;_0x5430d0<=_0x51e3cd[_0x4df497(0x287)]['length']-0x1;_0x5430d0++){const _0x5051a7=_0x51e3cd[_0x4df497(0x287)][_0x5430d0];_0x258039[_0x5051a7[_0x4df497(0x1b2)]+'-'+_0x5051a7[_0x4df497(0x18e)]]=_0x5051a7[_0x4df497(0x186)],_0x3bd11e[[_0x5051a7['brand']+'-'+_0x5051a7[_0x4df497(0x18e)]]]=_0x5051a7[_0x4df497(0x1c5)]['isFG'],_0x578d58[[_0x5051a7[_0x4df497(0x1b2)]+'-'+_0x5051a7[_0x4df497(0x18e)]]]=_0x5051a7[_0x4df497(0x1c5)]['prod_cat'];const _0x4cfc7a=_0x5051a7[_0x4df497(0x1b2)]+'-'+_0x5051a7['category'];!Array[_0x4df497(0x127)](_0x45104d[_0x4cfc7a])&&(_0x45104d[_0x4cfc7a]=[]);!Array[_0x4df497(0x127)](_0x45104d[_0x4cfc7a])&&(_0x45104d[_0x4cfc7a]=[]);_0x45104d[_0x4cfc7a][_0x4df497(0x24d)](_0x5051a7[_0x4df497(0x186)]);if(_0x5051a7[_0x4df497(0x1c5)][_0x4df497(0x222)]=='P')_0x5051a7[_0x4df497(0x1c5)][_0x4df497(0x216)]==_0x4df497(0x19e)?(!_0x260709[_0x4cfc7a]&&(_0x260709[_0x4cfc7a]=0x0),_0x260709[_0x4cfc7a]=_0x5051a7[_0x4df497(0x186)]):(!_0x509f9e[_0x4cfc7a]&&(_0x509f9e[_0x4cfc7a]=0x0),_0x509f9e[_0x4cfc7a]=_0x5051a7[_0x4df497(0x186)]);else _0x5051a7[_0x4df497(0x1c5)][_0x4df497(0x222)]=='S'&&(_0x5051a7[_0x4df497(0x1c5)][_0x4df497(0x216)]==_0x4df497(0x19e)?(!_0x260709[_0x4cfc7a]&&(_0x260709[_0x4cfc7a]=0x0),_0x260709[_0x4cfc7a]=_0x5051a7['qty']):(!_0x5becaf[_0x4cfc7a]&&(_0x5becaf[_0x4cfc7a]=0x0),_0x5becaf[_0x4cfc7a]=_0x5051a7[_0x4df497(0x186)]));_0x3cab09++;}for(let _0x5ab785=0x0;_0x5ab785<=_0x15dec9['cat_brand'][_0x4df497(0x23f)]-0x1;_0x5ab785++){const _0x5066a4=_0x15dec9[_0x4df497(0x230)][_0x5ab785],_0x3b6daa=_0x5066a4[_0x4df497(0x14f)][_0x4df497(0x1b2)]+'-'+_0x5066a4['_id'][_0x4df497(0x18e)],_0x2444e9=_0x578d58[_0x3b6daa]!==undefined?_0x578d58[_0x3b6daa]:'NA';var _0x36e89b=_0x509f9e[_0x3b6daa]!==undefined?_0x509f9e[_0x3b6daa][_0x4df497(0x162)](0x2):'',_0x23594a=_0x5becaf[_0x3b6daa]!==undefined?_0x5becaf[_0x3b6daa][_0x4df497(0x162)](0x2):'',_0x595036=_0x260709[_0x3b6daa]!==undefined?_0x260709[_0x3b6daa]['toFixed'](0x2):'';_0x2a7297+=_0x4df497(0x211)+_0x36e89b+_0x4df497(0x108),_0x2a7297+=_0x4df497(0x211)+_0x23594a+_0x4df497(0x108),_0x2a7297+=_0x4df497(0x211)+_0x595036+_0x4df497(0x108);}var _0xac710a=formatNumber(parseFloat(_0x51e3cd[_0x4df497(0x159)])),_0x4a33ca=formatNumber(parseFloat(_0x51e3cd[_0x4df497(0x227)]));isNaN(_0x4a33ca)&&(_0x4a33ca=0x0),_0x2a7297+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0xac710a+_0x4df497(0x108),_0x2a7297+=_0x4df497(0x211)+_0x4a33ca+_0x4df497(0x108),_0x2a7297+=_0x4df497(0x185)+_0x51e3cd[_0x4df497(0x232)]+'</td>',_0x2a7297+=_0x4df497(0x185)+_0x51e3cd['check_no']+_0x4df497(0x108),_0x2a7297+=_0x4df497(0x185)+_0x51e3cd['due_date']+'</td>',_0x52f5c0=_0x51e3cd[_0x4df497(0xff)]+_0x51e3cd[_0x4df497(0x226)],_0x2f3d92+=parseFloat(_0x51e3cd[_0x4df497(0x159)]),_0x57d173+=parseFloat(_0x4a33ca),_0x1a3d70['push'](_0x2a7297);}function _0x3cd8ca(_0x2698cd,_0x49de51){const _0x45299e=_0x4df497,_0x28e87c=[];for(let _0x317aae=0x0;_0x317aae<=_0x2698cd['length']-0x1;_0x317aae+=_0x49de51){_0x28e87c[_0x45299e(0x24d)](_0x2698cd[_0x45299e(0x20c)](_0x317aae,_0x317aae+_0x49de51));}return _0x28e87c;}const _0x145713=_0x3cd8ca(_0x1a3d70,_0x19c976);let _0x48232b='';return _0x145713[_0x4df497(0x12b)]((_0xc120d7,_0x313d05)=>{const _0x5cc870=_0x4df497;_0x313d05>0x0&&(_0x48232b+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x48232b+=_0x5cc870(0x1fb),_0x48232b+='<thead>';const _0x3e2d71=new Date(_0x54bb2a),_0x410bbb={'year':_0x5cc870(0x1fd),'month':_0x5cc870(0x229),'day':'numeric','timeZone':_0x5cc870(0x122)},_0x571d41=_0x3e2d71[_0x5cc870(0x20e)]('en-US',_0x410bbb);_0x48232b+=_0x5cc870(0x214),_0x48232b+='<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20'+_0x5d1eee+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+='<tr>',_0x48232b+=_0x5cc870(0x1b5)+_0x2a2016[_0x5cc870(0x16a)]+_0x5cc870(0x108),_0x48232b+=_0x5cc870(0x246),_0x48232b+=_0x5cc870(0x14a),_0x48232b+=_0x5cc870(0x261),_0x48232b+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x48232b+=_0x5cc870(0x215),_0x48232b+=_0x5cc870(0x267),_0x48232b+='<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>',_0x48232b+=_0x5cc870(0x259),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x48232b+=_0x5cc870(0x1e6)+_0x571d41+_0x5cc870(0x108),_0x48232b+=_0x5cc870(0x182),_0x48232b+=_0x5cc870(0x28c),_0x48232b+=_0x5cc870(0x12c),_0x48232b+=_0x5cc870(0x12c),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+='<tr>',_0x48232b+=_0x5cc870(0x247),_0x48232b+=_0x5cc870(0x137),_0x48232b+=_0x5cc870(0x141),_0x48232b+=_0x5cc870(0x12c),_0x48232b+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x28b),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x167),_0x48232b+=_0x5cc870(0x183),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x1d0),_0x48232b+=_0x5cc870(0x25e),_0x48232b+=_0x5cc870(0x275);for(let _0x3cb12f=0x0;_0x3cb12f<=_0x2fab48[_0x5cc870(0x23f)]-0x1;_0x3cb12f++){const _0x1c8d2f=_0x2fab48[_0x3cb12f];for(let _0x1fae7c=0x0;_0x1fae7c<_0x15dec9['cat_brand'][_0x5cc870(0x23f)];_0x1fae7c++){const _0x5ca471=_0x15dec9[_0x5cc870(0x230)][_0x1fae7c];if(_0x5ca471[_0x5cc870(0x14f)]['category']===_0x1c8d2f[_0x5cc870(0x14f)][_0x5cc870(0x18e)]){var _0x4fe1e0='';switch(_0x1c8d2f[_0x5cc870(0x14f)]['category']){case'Standard':_0x4fe1e0=_0x5ca471['_id'][_0x5cc870(0x1b2)]+'\x20-\x20STD';break;case _0x5cc870(0x224):_0x4fe1e0=_0x5ca471[_0x5cc870(0x14f)][_0x5cc870(0x1b2)]+_0x5cc870(0x1c1);break;default:_0x4fe1e0=_0x5ca471[_0x5cc870(0x14f)][_0x5cc870(0x1b2)];break;}_0x48232b+=_0x5cc870(0x23c)+_0x4fe1e0+_0x5cc870(0x285);}}}_0x48232b+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x48232b+=_0x5cc870(0x17e),_0x48232b+='<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>',_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x5c542c=0x0;_0x5c542c<=_0x15dec9[_0x5cc870(0x230)]['length']-0x1;_0x5c542c++){const _0x2b2883=_0x15dec9[_0x5c542c];_0x48232b+=_0x5cc870(0x1e3),_0x48232b+=_0x5cc870(0x197),_0x48232b+=_0x5cc870(0x176);}_0x48232b+=_0x5cc870(0x20a),_0x48232b+=_0x5cc870(0x191),_0x48232b+=_0x5cc870(0x235),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+='</thead>',_0x48232b+=_0x5cc870(0x1ba),_0xc120d7['forEach'](_0x118210=>{_0x48232b+=_0x118210;});let _0x216749={},_0x33ce45={},_0x191c41={};for(let _0xe13654=0x0;_0xe13654<=_0x46cf06[_0x5cc870(0x23f)]-0x1;_0xe13654++){const _0x1e6202=_0x46cf06[_0xe13654];var _0x1a2b54=0x0;for(let _0x39f901=0x0;_0x39f901<=_0x1e6202[_0x5cc870(0x287)][_0x5cc870(0x23f)]-0x1;_0x39f901++){const _0xfd92e4=_0x1e6202[_0x5cc870(0x287)][_0x39f901],_0x1bf798=_0xfd92e4[_0x5cc870(0x1b2)]+'-'+_0xfd92e4['category'];if(_0xfd92e4[_0x5cc870(0x1c5)]['prod_cat']=='P')_0xfd92e4[_0x5cc870(0x1c5)]['isFG']==_0x5cc870(0x19e)?(!_0x191c41[_0x1bf798]&&(_0x191c41[_0x1bf798]=0x0),_0x191c41[_0x1bf798]+=_0xfd92e4[_0x5cc870(0x186)]):(!_0x216749[_0x1bf798]&&(_0x216749[_0x1bf798]=0x0),_0x216749[_0x1bf798]+=_0xfd92e4['qty']);else _0xfd92e4[_0x5cc870(0x1c5)][_0x5cc870(0x222)]=='S'&&(_0xfd92e4[_0x5cc870(0x1c5)]['isFG']==_0x5cc870(0x19e)?(!_0x191c41[_0x1bf798]&&(_0x191c41[_0x1bf798]=0x0),_0x191c41[_0x1bf798]+=_0xfd92e4['qty'],console[_0x5cc870(0x1bf)](_0xfd92e4[_0x5cc870(0x186)])):(!_0x33ce45[_0x1bf798]&&(_0x33ce45[_0x1bf798]=0x0),_0x33ce45[_0x1bf798]+=_0xfd92e4[_0x5cc870(0x186)]));_0x1a2b54++;}}let _0x360e1c={},_0x440d84={},_0x59da24={};var _0x511003=0x0,_0xec79ab=0x0;for(let _0x3171e8=0x0;_0x3171e8<=_0x4967cf[_0x5cc870(0x23f)]-0x1;_0x3171e8++){const _0x18248b=_0x4967cf[_0x3171e8];var _0x1a2b54=0x0;for(let _0x27c0ea=0x0;_0x27c0ea<=_0x18248b[_0x5cc870(0x287)][_0x5cc870(0x23f)]-0x1;_0x27c0ea++){const _0x5d3f5a=_0x18248b[_0x5cc870(0x287)][_0x27c0ea],_0x3b62e8=_0x5d3f5a[_0x5cc870(0x1b2)]+'-'+_0x5d3f5a['category'];if(_0x5d3f5a[_0x5cc870(0x1c5)][_0x5cc870(0x222)]=='P')_0x5d3f5a['product_details'][_0x5cc870(0x216)]=='true'?(!_0x59da24[_0x3b62e8]&&(_0x59da24[_0x3b62e8]=0x0),_0x59da24[_0x3b62e8]+=_0x5d3f5a['qty']):(!_0x360e1c[_0x3b62e8]&&(_0x360e1c[_0x3b62e8]=0x0),_0x360e1c[_0x3b62e8]+=_0x5d3f5a[_0x5cc870(0x186)]);else _0x5d3f5a[_0x5cc870(0x1c5)]['prod_cat']=='S'&&(_0x5d3f5a['product_details'][_0x5cc870(0x216)]=='true'?(!_0x59da24[_0x3b62e8]&&(_0x59da24[_0x3b62e8]=0x0),_0x59da24[_0x3b62e8]+=_0x5d3f5a['qty']):(!_0x440d84[_0x3b62e8]&&(_0x440d84[_0x3b62e8]=0x0),_0x440d84[_0x3b62e8]+=_0x5d3f5a['qty']));_0x1a2b54++;}var _0x434f35=parseFloat(_0x18248b[_0x5cc870(0x159)]),_0x4c29c6=parseFloat(_0x18248b[_0x5cc870(0x227)]);isNaN(_0x4c29c6)&&(_0x4c29c6=0x0),_0x511003+=_0x434f35,_0xec79ab+=_0x4c29c6;}if(_0x48a095['length']>0x0)for(let _0x2ee8d0=0x0;_0x2ee8d0<=_0x48a095[_0x5cc870(0x23f)]-0x1;_0x2ee8d0++){const _0x20ca62=_0x48a095[_0x2ee8d0];console[_0x5cc870(0x1bf)](_0x20ca62),_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x13c)+(0x8+0x7*0x3)+_0x5cc870(0x1b1)+_0x20ca62[_0x5cc870(0x101)]+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x1c3);}_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x12d),_0x48232b+=_0x5cc870(0x1f6),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x4eb711=0x0;_0x4eb711<=_0x15dec9[_0x5cc870(0x230)][_0x5cc870(0x23f)]-0x1;_0x4eb711++){const _0x40d597=_0x15dec9['cat_brand'][_0x4eb711],_0x254780=_0x40d597[_0x5cc870(0x14f)][_0x5cc870(0x1b2)]+'-'+_0x40d597['_id']['category'];var _0x59ce99=_0x216749[_0x254780]!==undefined?formatNumber(_0x216749[_0x254780][_0x5cc870(0x162)](0x2)):'',_0x4d7c0f=_0x191c41[_0x254780]!==undefined?formatNumber(_0x191c41[_0x254780][_0x5cc870(0x162)](0x2)):'',_0x396a53=_0x33ce45[_0x254780]!==undefined?formatNumber(_0x33ce45[_0x254780][_0x5cc870(0x162)](0x2)):'';_0x48232b+=_0x5cc870(0x284)+_0x59ce99+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x284)+_0x396a53+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x284)+_0x4d7c0f+_0x5cc870(0x285);}_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2f3d92)+_0x5cc870(0x285),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x57d173)+'</b></td>',_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x12d),_0x48232b+=_0x5cc870(0x148),_0x48232b+=_0x5cc870(0x258);for(let _0x53b906=0x0;_0x53b906<=_0x15dec9[_0x5cc870(0x230)][_0x5cc870(0x23f)]-0x1;_0x53b906++){const _0x2ac163=_0x15dec9[_0x5cc870(0x230)][_0x53b906],_0x30da97=_0x2ac163[_0x5cc870(0x14f)][_0x5cc870(0x1b2)]+'-'+_0x2ac163[_0x5cc870(0x14f)][_0x5cc870(0x18e)];var _0x59ce99=_0x360e1c[_0x30da97]!==undefined?formatNumber(_0x360e1c[_0x30da97][_0x5cc870(0x162)](0x2)):'',_0x4d7c0f=_0x59da24[_0x30da97]!==undefined?formatNumber(_0x59da24[_0x30da97]['toFixed'](0x2)):'',_0x396a53=_0x440d84[_0x30da97]!==undefined?formatNumber(_0x440d84[_0x30da97][_0x5cc870(0x162)](0x2)):'';_0x48232b+=_0x5cc870(0x284)+_0x59ce99+_0x5cc870(0x285),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x396a53+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x284)+_0x4d7c0f+'</b></td>';}_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x511003)+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x284)+formatNumber(_0xec79ab)+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+='</tr>',_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x12d),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x48232b+=_0x5cc870(0x258);let _0x533fc4=0x0,_0x48f45c=0x0,_0x1c4f6b=0x0;for(let _0x2342b6=0x0;_0x2342b6<=_0x15dec9[_0x5cc870(0x230)][_0x5cc870(0x23f)]-0x1;_0x2342b6++){const _0x5bb6fd=_0x15dec9[_0x5cc870(0x230)][_0x2342b6],_0x118cc8=_0x5bb6fd[_0x5cc870(0x14f)][_0x5cc870(0x1b2)]+'-'+_0x5bb6fd[_0x5cc870(0x14f)][_0x5cc870(0x18e)];var _0x1f2157=_0x216749[_0x118cc8]!==undefined?_0x216749[_0x118cc8]['toFixed'](0x2):'0',_0x440b13=_0x191c41[_0x118cc8]!==undefined?_0x191c41[_0x118cc8]['toFixed'](0x2):'0',_0x4b6568=_0x33ce45[_0x118cc8]!==undefined?_0x33ce45[_0x118cc8][_0x5cc870(0x162)](0x2):'0',_0xd65c13=_0x360e1c[_0x118cc8]!==undefined?_0x360e1c[_0x118cc8][_0x5cc870(0x162)](0x2):'0',_0xf67f27=_0x59da24[_0x118cc8]!==undefined?_0x59da24[_0x118cc8]['toFixed'](0x2):'0',_0x373a39=_0x440d84[_0x118cc8]!==undefined?_0x440d84[_0x118cc8][_0x5cc870(0x162)](0x2):'0';_0x533fc4=parseFloat(_0x1f2157)+parseFloat(_0xd65c13),_0x48f45c=parseFloat(_0x4b6568)+parseFloat(_0x373a39),_0x1c4f6b=parseFloat(_0x440b13)+parseFloat(_0xf67f27),_0x48232b+=_0x5cc870(0x284)+formatNumber(_0x533fc4['toFixed'](0x2))+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x284)+formatNumber(_0x48f45c['toFixed'](0x2))+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x284)+formatNumber(_0x1c4f6b['toFixed'](0x2))+_0x5cc870(0x285);}var _0x2fd8e9=formatNumber(_0x2f3d92+_0x511003),_0x26c76c=formatNumber(_0x57d173+_0xec79ab);_0x48232b+=_0x5cc870(0x284)+_0x2fd8e9+_0x5cc870(0x285),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x26c76c+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x189)+(_0x15dec9['cat_brand'][_0x5cc870(0x23f)]*0x3+0x9)+_0x5cc870(0x154),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x48232b+=_0x5cc870(0x139),_0x48232b+=_0x5cc870(0x258);for(let _0x2b8c91=0x0;_0x2b8c91<=_0x15dec9[_0x5cc870(0x230)][_0x5cc870(0x23f)]-0x1;_0x2b8c91++){const _0x44ce8d=_0x15dec9[_0x5cc870(0x230)][_0x2b8c91],_0x2ec120=_0x44ce8d[_0x5cc870(0x14f)][_0x5cc870(0x1b2)]+'-'+_0x44ce8d[_0x5cc870(0x14f)][_0x5cc870(0x18e)];var _0x1f2157=_0x216749[_0x2ec120]!==undefined?_0x216749[_0x2ec120][_0x5cc870(0x162)](0x2):'0',_0x440b13=_0x191c41[_0x2ec120]!==undefined?_0x191c41[_0x2ec120][_0x5cc870(0x162)](0x2):'0',_0x4b6568=_0x33ce45[_0x2ec120]!==undefined?_0x33ce45[_0x2ec120]['toFixed'](0x2):'0',_0xd65c13=_0x360e1c[_0x2ec120]!==undefined?_0x360e1c[_0x2ec120]['toFixed'](0x2):'0',_0xf67f27=_0x59da24[_0x2ec120]!==undefined?_0x59da24[_0x2ec120][_0x5cc870(0x162)](0x2):'0',_0x373a39=_0x440d84[_0x2ec120]!==undefined?_0x440d84[_0x2ec120][_0x5cc870(0x162)](0x2):'0';_0x533fc4=parseFloat(_0x1f2157)+parseFloat(_0xd65c13),_0x48f45c=parseFloat(_0x4b6568)+parseFloat(_0x373a39),_0x1c4f6b=parseFloat(_0x440b13)+parseFloat(_0xf67f27),_0x48232b+=_0x5cc870(0x160),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x48232b+=_0x5cc870(0x160);}_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+='</tr>',_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x12d),_0x48232b+=_0x5cc870(0x1d8),_0x48232b+=_0x5cc870(0x258);for(let _0x52904f=0x0;_0x52904f<=_0x15dec9['cat_brand'][_0x5cc870(0x23f)]-0x1;_0x52904f++){const _0x216edd=_0x15dec9['cat_brand'][_0x52904f],_0x3b95da=_0x216edd['_id'][_0x5cc870(0x1b2)]+'-'+_0x216edd[_0x5cc870(0x14f)][_0x5cc870(0x18e)];var _0x1f2157=_0x216749[_0x3b95da]!==undefined?_0x216749[_0x3b95da]['toFixed'](0x2):'0',_0x440b13=_0x191c41[_0x3b95da]!==undefined?_0x191c41[_0x3b95da][_0x5cc870(0x162)](0x2):'0',_0x4b6568=_0x33ce45[_0x3b95da]!==undefined?_0x33ce45[_0x3b95da]['toFixed'](0x2):'0',_0xd65c13=_0x360e1c[_0x3b95da]!==undefined?_0x360e1c[_0x3b95da][_0x5cc870(0x162)](0x2):'0',_0xf67f27=_0x59da24[_0x3b95da]!==undefined?_0x59da24[_0x3b95da][_0x5cc870(0x162)](0x2):'0',_0x373a39=_0x440d84[_0x3b95da]!==undefined?_0x440d84[_0x3b95da][_0x5cc870(0x162)](0x2):'0';_0x533fc4=parseFloat(_0x1f2157)+parseFloat(_0xd65c13),_0x48f45c=parseFloat(_0x4b6568)+parseFloat(_0x373a39),_0x1c4f6b=parseFloat(_0x440b13)+parseFloat(_0xf67f27),_0x48232b+=_0x5cc870(0x160),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x48232b+=_0x5cc870(0x258),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+=_0x5cc870(0x258),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x12d),_0x48232b+=_0x5cc870(0x25f),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x36451c=0x0;_0x36451c<=_0x15dec9[_0x5cc870(0x230)][_0x5cc870(0x23f)]-0x1;_0x36451c++){const _0x4763f3=_0x15dec9[_0x5cc870(0x230)][_0x36451c],_0xfcab47=_0x4763f3[_0x5cc870(0x14f)][_0x5cc870(0x1b2)]+'-'+_0x4763f3['_id'][_0x5cc870(0x18e)];var _0x1f2157=_0x216749[_0xfcab47]!==undefined?_0x216749[_0xfcab47]['toFixed'](0x2):'0',_0x440b13=_0x191c41[_0xfcab47]!==undefined?_0x191c41[_0xfcab47][_0x5cc870(0x162)](0x2):'0',_0x4b6568=_0x33ce45[_0xfcab47]!==undefined?_0x33ce45[_0xfcab47][_0x5cc870(0x162)](0x2):'0',_0xd65c13=_0x360e1c[_0xfcab47]!==undefined?_0x360e1c[_0xfcab47][_0x5cc870(0x162)](0x2):'0',_0xf67f27=_0x59da24[_0xfcab47]!==undefined?_0x59da24[_0xfcab47][_0x5cc870(0x162)](0x2):'0',_0x373a39=_0x440d84[_0xfcab47]!==undefined?_0x440d84[_0xfcab47][_0x5cc870(0x162)](0x2):'0';_0x533fc4=parseFloat(_0x1f2157)+parseFloat(_0xd65c13),_0x48f45c=parseFloat(_0x4b6568)+parseFloat(_0x373a39),_0x1c4f6b=parseFloat(_0x440b13)+parseFloat(_0xf67f27),_0x48232b+=_0x5cc870(0x160),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x48232b+=_0x5cc870(0x160);}_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+=_0x5cc870(0x258),_0x48232b+='</tr>',_0x48232b+=_0x5cc870(0x214),_0x48232b+=_0x5cc870(0x12d),_0x48232b+=_0x5cc870(0x1f6),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x3ed0b7=0x0;_0x3ed0b7<=_0x15dec9[_0x5cc870(0x230)][_0x5cc870(0x23f)]-0x1;_0x3ed0b7++){const _0x3538b8=_0x15dec9[_0x5cc870(0x230)][_0x3ed0b7],_0x430396=_0x3538b8[_0x5cc870(0x14f)]['brand']+'-'+_0x3538b8[_0x5cc870(0x14f)][_0x5cc870(0x18e)];var _0x1f2157=_0x216749[_0x430396]!==undefined?_0x216749[_0x430396][_0x5cc870(0x162)](0x2):'',_0x440b13=_0x191c41[_0x430396]!==undefined?_0x191c41[_0x430396]['toFixed'](0x2):'',_0x4b6568=_0x33ce45[_0x430396]!==undefined?_0x33ce45[_0x430396][_0x5cc870(0x162)](0x2):'',_0xd65c13=_0x360e1c[_0x430396]!==undefined?_0x360e1c[_0x430396][_0x5cc870(0x162)](0x2):'',_0xf67f27=_0x59da24[_0x430396]!==undefined?_0x59da24[_0x430396]['toFixed'](0x2):'',_0x373a39=_0x440d84[_0x430396]!==undefined?_0x440d84[_0x430396][_0x5cc870(0x162)](0x2):'';_0x533fc4=formatNumber(parseFloat(_0x1f2157)+parseFloat(_0xd65c13)),_0x48f45c=formatNumber(parseFloat(_0x4b6568)+parseFloat(_0x373a39)),_0x1c4f6b=formatNumber(parseFloat(_0x440b13)+parseFloat(_0xf67f27)),_0x48232b+=_0x5cc870(0x284)+_0x1f2157+_0x5cc870(0x285),_0x48232b+=_0x5cc870(0x284)+_0x4b6568+_0x5cc870(0x285),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x440b13+_0x5cc870(0x285);}_0x48232b+=_0x5cc870(0x258),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+='<tr>',_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x48232b+=_0x5cc870(0x12e),_0x48232b+=_0x5cc870(0x258);for(let _0x18b4dd=0x0;_0x18b4dd<=_0x15dec9[_0x5cc870(0x230)][_0x5cc870(0x23f)]-0x1;_0x18b4dd++){const _0x7b87d8=_0x15dec9['cat_brand'][_0x18b4dd],_0x12eb31=_0x7b87d8[_0x5cc870(0x14f)][_0x5cc870(0x1b2)]+'-'+_0x7b87d8[_0x5cc870(0x14f)][_0x5cc870(0x18e)];var _0x1f2157=_0x216749[_0x12eb31]!==undefined?_0x216749[_0x12eb31][_0x5cc870(0x162)](0x2):'0',_0x440b13=_0x191c41[_0x12eb31]!==undefined?_0x191c41[_0x12eb31][_0x5cc870(0x162)](0x2):'0',_0x4b6568=_0x33ce45[_0x12eb31]!==undefined?_0x33ce45[_0x12eb31][_0x5cc870(0x162)](0x2):'0',_0xd65c13=_0x360e1c[_0x12eb31]!==undefined?_0x360e1c[_0x12eb31][_0x5cc870(0x162)](0x2):'0',_0xf67f27=_0x59da24[_0x12eb31]!==undefined?_0x59da24[_0x12eb31][_0x5cc870(0x162)](0x2):'0',_0x373a39=_0x440d84[_0x12eb31]!==undefined?_0x440d84[_0x12eb31][_0x5cc870(0x162)](0x2):'0';_0x533fc4=parseFloat(_0x1f2157)+parseFloat(_0xd65c13),_0x48f45c=parseFloat(_0x4b6568)+parseFloat(_0x373a39),_0x1c4f6b=parseFloat(_0x440b13)+parseFloat(_0xf67f27),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x48232b+=_0x5cc870(0x160),_0x48232b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x258),_0x48232b+=_0x5cc870(0x1c3),_0x48232b+=_0x5cc870(0x13f),_0x48232b+=_0x5cc870(0x24a);}),_0x48232b;}async function generateReferenceNumber(_0x335ce1,_0x33023b,_0x25b818){const _0x406186=a0_0x12c55b,_0x88439c=new Date(_0x335ce1)['getFullYear'](),_0x420420=('0'+(new Date(_0x335ce1)['getMonth']()+0x1))['slice'](-0x2),_0x1be498=('0'+new Date(_0x335ce1)['getDate']())[_0x406186(0x20c)](-0x2),_0x362871=await staff[_0x406186(0x249)]({'email':_0x25b818['email']}),_0x344e87=_0x362871[_0x406186(0x181)],_0x5753d2=_0x344e87+'-'+_0x88439c+_0x420420+_0x1be498,_0x5a5b48=await Reference[_0x406186(0x249)]({'referenceNumber':new RegExp('^'+_0x5753d2),'salesman_code':_0x344e87})[_0x406186(0x22d)]({'createdAt':-0x1}),_0x645151=_0x5753d2;_0x5a5b48&&(_0x645151=_0x5a5b48[_0x406186(0x172)]);console['log'](_0x645151);const _0x10fb7a=new Reference({'referenceNumber':_0x645151,'staff_id':_0x33023b,'salesman_code':_0x344e87});return await _0x10fb7a[_0x406186(0x184)](),_0x645151;}router[a0_0x12c55b(0x131)](a0_0x12c55b(0x263),auth,async(_0x591cf7,_0x2ea515)=>{const _0x2bc577=a0_0x12c55b,{from_date:_0x2cd1b3,dataview:_0x58daf4}=_0x591cf7[_0x2bc577(0x163)],_0x4b738d=_0x591cf7[_0x2bc577(0x242)],_0x5c1d0c=await staff['findOne']({'email':_0x4b738d[_0x2bc577(0x1d3)]}),_0x33dbdf=await master_shop[_0x2bc577(0x25d)](),_0x33930b='';var _0x5458f2=new Date(_0x2cd1b3);const _0x1a22ce={'year':_0x2bc577(0x1fd),'month':_0x2bc577(0x229),'day':_0x2bc577(0x1fd)},_0x42fd95=new Intl[(_0x2bc577(0x1b0))](_0x2bc577(0x1d7),_0x1a22ce)[_0x2bc577(0x17a)](_0x5458f2),_0xa7ae6=await Reference['find']({'staff_id':_0x5c1d0c['_id'][_0x2bc577(0x278)](),'date_include':_0x2cd1b3});if(_0xa7ae6[_0x2bc577(0x23f)]>0x0){let _0x3b47df='';_0x3b47df+=_0xa7ae6[0x0][_0x2bc577(0x14d)];if(_0x58daf4==_0x2bc577(0x273)){const _0x19c9a7=cheerio[_0x2bc577(0x199)](_0x3b47df);let _0x5f024f=[],_0x23d515=[],_0x525daa=[];const _0x45dfb5=_0x4f9dd3=>{const _0x3ba085=_0x2bc577,_0x54aa56={'top':{'style':'thick','color':{'rgb':_0x3ba085(0x13b)}},'bottom':{'style':_0x3ba085(0x23b),'color':{'rgb':'000000'}},'left':{'style':_0x3ba085(0x23b),'color':{'rgb':_0x3ba085(0x13b)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x4f9dd3){const _0x38e333=_0x4f9dd3[_0x3ba085(0x10f)](';')[_0x3ba085(0x21b)]((_0x2c9251,_0x11e3ce)=>{const _0x48f90a=_0x3ba085,[_0x4a9f31,_0x5eb648]=_0x11e3ce[_0x48f90a(0x10f)](':')[_0x48f90a(0x1cc)](_0x23518a=>_0x23518a[_0x48f90a(0x1be)]());return _0x2c9251[_0x4a9f31]=_0x5eb648,_0x2c9251;},{});_0x38e333['border-top']&&(_0x54aa56['top'][_0x3ba085(0x276)]=_0x38e333[_0x3ba085(0xfd)][_0x3ba085(0x251)](_0x3ba085(0x1b8))?_0x3ba085(0x1b8):_0x3ba085(0x245)),_0x38e333['border-bottom']&&(_0x54aa56[_0x3ba085(0x21d)][_0x3ba085(0x276)]=_0x38e333[_0x3ba085(0x243)][_0x3ba085(0x251)](_0x3ba085(0x1b8))?_0x3ba085(0x1b8):'medium'),_0x38e333['border-left']&&(_0x54aa56[_0x3ba085(0x203)][_0x3ba085(0x276)]=_0x38e333['border-left'][_0x3ba085(0x251)](_0x3ba085(0x1b8))?_0x3ba085(0x1b8):_0x3ba085(0x245)),_0x38e333[_0x3ba085(0x205)]&&(_0x54aa56[_0x3ba085(0x265)][_0x3ba085(0x276)]=_0x38e333[_0x3ba085(0x205)][_0x3ba085(0x251)](_0x3ba085(0x1b8))?_0x3ba085(0x1b8):_0x3ba085(0x245));}return _0x54aa56;};_0x19c9a7(_0x2bc577(0x146))['each']((_0x3f028a,_0x49e0f0)=>{const _0x3eff10=_0x2bc577;let _0x3aff2b=[],_0x504ec7=0x0;while(_0x525daa[_0x504ec7]){_0x525daa[_0x504ec7]--,_0x504ec7++;}_0x19c9a7(_0x49e0f0)[_0x3eff10(0x25d)](_0x3eff10(0x1b3))[_0x3eff10(0x1c0)]((_0x4ec61c,_0x46db9a)=>{const _0x5803f5=_0x3eff10;let _0x29ea5c=_0x19c9a7(_0x46db9a)[_0x5803f5(0x218)]()[_0x5803f5(0x1be)](),_0x21189f=parseFloat(_0x29ea5c['replace'](/,/g,''));isNaN(_0x21189f)&&(_0x21189f=_0x29ea5c);let _0x22b0ff=parseInt(_0x19c9a7(_0x46db9a)['attr']('colspan'))||0x1,_0x2a2e31=parseInt(_0x19c9a7(_0x46db9a)[_0x5803f5(0x178)](_0x5803f5(0x1cf)))||0x1;const _0x3dee08=_0x19c9a7(_0x46db9a)[_0x5803f5(0x178)]('style'),_0x1c78da=_0x45dfb5(_0x3dee08);_0x3aff2b[_0x504ec7]={'v':_0x21189f,'s':{'border':_0x1c78da}};(_0x22b0ff>0x1||_0x2a2e31>0x1)&&_0x23d515[_0x5803f5(0x24d)]({'s':{'r':_0x3f028a,'c':_0x504ec7},'e':{'r':_0x3f028a+_0x2a2e31-0x1,'c':_0x504ec7+_0x22b0ff-0x1}});for(let _0x244bf0=0x0;_0x244bf0<_0x22b0ff;_0x244bf0++){_0x2a2e31>0x1&&(_0x525daa[_0x504ec7+_0x244bf0]=_0x2a2e31-0x1);}_0x504ec7+=_0x22b0ff;}),_0x5f024f['push'](_0x3aff2b);});const _0x52820f=XLSX[_0x2bc577(0x16f)]['book_new'](),_0x410a55=XLSX['utils'][_0x2bc577(0x198)](_0x5f024f);_0x23d515['length']>0x0&&(_0x410a55[_0x2bc577(0x15e)]=_0x23d515);_0x410a55[_0x2bc577(0x180)]=_0x5f024f[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x2bc577(0x16f)]['book_append_sheet'](_0x52820f,_0x410a55,'Sales\x20Report');const _0x59a80b=XLSX[_0x2bc577(0x25a)](_0x52820f,{'bookType':_0x2bc577(0x204),'type':_0x2bc577(0x109)});_0x2ea515[_0x2bc577(0x11b)](_0x2bc577(0x13a),_0x2bc577(0x269)),_0x2ea515['setHeader'](_0x2bc577(0x260),_0x2bc577(0x1a4)),_0x2ea515[_0x2bc577(0x177)](_0x59a80b);}else{let _0x18ab20='';_0x18ab20+=_0x3b47df,_0x18ab20+=_0x2bc577(0x1e8),_0x18ab20+=_0x2bc577(0x15a),_0x18ab20+=_0x2bc577(0x1e4),_0x18ab20+='};',_0x18ab20+=_0x2bc577(0x15b),_0x2ea515[_0x2bc577(0x177)](_0x18ab20);}}else generateReferenceNumber(_0x2cd1b3,_0x5c1d0c[_0x2bc577(0x14f)][_0x2bc577(0x278)](),_0x4b738d)[_0x2bc577(0x18a)](async _0x11521e=>{const _0x3fb21a=_0x2bc577,_0x51238f=await agentsdataDSICheck_DSRR(_0x2cd1b3,_0x5c1d0c[_0x3fb21a(0x14f)][_0x3fb21a(0x278)](),_0x33930b,_0x11521e);let _0x1b6a25=_0x3fb21a(0x1bb);_0x1b6a25+=_0x3fb21a(0x201),_0x1b6a25+='<div\x20\x20id=\x22table-conatainer\x22>',_0x1b6a25+=_0x3fb21a(0x1fb),_0x1b6a25+=_0x51238f,_0x1b6a25+=_0x3fb21a(0x24a),_0x1b6a25+=_0x3fb21a(0x210),_0x1b6a25+=_0x3fb21a(0x210);if(_0x51238f[_0x3fb21a(0x23f)]>0x0){const _0x4ddadd=await Reference[_0x3fb21a(0x249)]({'staff_id':_0x5c1d0c['_id'][_0x3fb21a(0x278)](),'referenceNumber':_0x11521e});_0x4ddadd['html']=_0x1b6a25,_0x4ddadd[_0x3fb21a(0x1d2)]=_0x2cd1b3,await _0x4ddadd[_0x3fb21a(0x184)]();if(_0x58daf4==_0x3fb21a(0x273)){const _0x3d8c8b=cheerio['load'](_0x1b6a25);let _0x52fe48=[],_0x42e044=[],_0x38867d=[];const _0xa7387a=_0x5d0559=>{const _0xb8d464=_0x3fb21a,_0x328cc1={'top':{'style':_0xb8d464(0x23b),'color':{'rgb':_0xb8d464(0x13b)}},'bottom':{'style':_0xb8d464(0x23b),'color':{'rgb':_0xb8d464(0x13b)}},'left':{'style':_0xb8d464(0x23b),'color':{'rgb':_0xb8d464(0x13b)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x5d0559){const _0x59a95d=_0x5d0559[_0xb8d464(0x10f)](';')[_0xb8d464(0x21b)]((_0xf5316c,_0x44693c)=>{const _0x22efb9=_0xb8d464,[_0x28c82f,_0x43bdbc]=_0x44693c[_0x22efb9(0x10f)](':')[_0x22efb9(0x1cc)](_0x2d8315=>_0x2d8315[_0x22efb9(0x1be)]());return _0xf5316c[_0x28c82f]=_0x43bdbc,_0xf5316c;},{});_0x59a95d['border-top']&&(_0x328cc1[_0xb8d464(0x11e)][_0xb8d464(0x276)]=_0x59a95d[_0xb8d464(0xfd)][_0xb8d464(0x251)](_0xb8d464(0x1b8))?_0xb8d464(0x1b8):_0xb8d464(0x245)),_0x59a95d[_0xb8d464(0x243)]&&(_0x328cc1[_0xb8d464(0x21d)][_0xb8d464(0x276)]=_0x59a95d[_0xb8d464(0x243)][_0xb8d464(0x251)](_0xb8d464(0x1b8))?_0xb8d464(0x1b8):'medium'),_0x59a95d['border-left']&&(_0x328cc1['left']['style']=_0x59a95d[_0xb8d464(0x234)][_0xb8d464(0x251)](_0xb8d464(0x1b8))?_0xb8d464(0x1b8):'medium'),_0x59a95d['border-right']&&(_0x328cc1[_0xb8d464(0x265)]['style']=_0x59a95d[_0xb8d464(0x205)][_0xb8d464(0x251)](_0xb8d464(0x1b8))?_0xb8d464(0x1b8):_0xb8d464(0x245));}return _0x328cc1;};_0x3d8c8b('table\x20tr')[_0x3fb21a(0x1c0)]((_0x1ca2a5,_0x34ca99)=>{const _0x1322f5=_0x3fb21a;let _0x9f2b33=[],_0x511824=0x0;while(_0x38867d[_0x511824]){_0x38867d[_0x511824]--,_0x511824++;}_0x3d8c8b(_0x34ca99)[_0x1322f5(0x25d)](_0x1322f5(0x1b3))[_0x1322f5(0x1c0)]((_0x63cdff,_0x442c91)=>{const _0x22ab5c=_0x1322f5;let _0x3f501d=_0x3d8c8b(_0x442c91)[_0x22ab5c(0x218)]()[_0x22ab5c(0x1be)](),_0x4f8dae=parseFloat(_0x3f501d[_0x22ab5c(0x283)](/,/g,''));isNaN(_0x4f8dae)&&(_0x4f8dae=_0x3f501d);let _0x5135b5=parseInt(_0x3d8c8b(_0x442c91)[_0x22ab5c(0x178)](_0x22ab5c(0x194)))||0x1,_0x2a9df3=parseInt(_0x3d8c8b(_0x442c91)['attr']('rowspan'))||0x1;const _0x41190f=_0x3d8c8b(_0x442c91)['attr'](_0x22ab5c(0x276)),_0x3f0940=_0xa7387a(_0x41190f);_0x9f2b33[_0x511824]={'v':_0x4f8dae,'s':{'border':_0x3f0940}};(_0x5135b5>0x1||_0x2a9df3>0x1)&&_0x42e044[_0x22ab5c(0x24d)]({'s':{'r':_0x1ca2a5,'c':_0x511824},'e':{'r':_0x1ca2a5+_0x2a9df3-0x1,'c':_0x511824+_0x5135b5-0x1}});for(let _0x4f16ad=0x0;_0x4f16ad<_0x5135b5;_0x4f16ad++){_0x2a9df3>0x1&&(_0x38867d[_0x511824+_0x4f16ad]=_0x2a9df3-0x1);}_0x511824+=_0x5135b5;}),_0x52fe48[_0x1322f5(0x24d)](_0x9f2b33);});const _0x5d0cb1=XLSX['utils'][_0x3fb21a(0x1bc)](),_0xc8fc4c=XLSX[_0x3fb21a(0x16f)][_0x3fb21a(0x198)](_0x52fe48);_0x42e044[_0x3fb21a(0x23f)]>0x0&&(_0xc8fc4c[_0x3fb21a(0x15e)]=_0x42e044);_0xc8fc4c[_0x3fb21a(0x180)]=_0x52fe48[0x0][_0x3fb21a(0x1cc)](()=>({'wpx':0x64})),XLSX[_0x3fb21a(0x16f)][_0x3fb21a(0x27a)](_0x5d0cb1,_0xc8fc4c,'Sales\x20Report');const _0x3448a8=XLSX[_0x3fb21a(0x25a)](_0x5d0cb1,{'bookType':_0x3fb21a(0x204),'type':_0x3fb21a(0x109)});_0x2ea515['setHeader']('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x2ea515[_0x3fb21a(0x11b)]('Content-Type',_0x3fb21a(0x1a4)),_0x2ea515[_0x3fb21a(0x177)](_0x3448a8);}else _0x1b6a25+=_0x3fb21a(0x1e8),_0x1b6a25+=_0x3fb21a(0x15a),_0x1b6a25+=_0x3fb21a(0x1e4),_0x1b6a25+='};',_0x1b6a25+=_0x3fb21a(0x15b),_0x2ea515[_0x3fb21a(0x177)](_0x1b6a25);}else await Reference[_0x3fb21a(0x22b)]({'referenceNumber':_0x11521e}),_0x591cf7[_0x3fb21a(0x19a)](_0x3fb21a(0x281),_0x3fb21a(0x14c)),_0x2ea515[_0x3fb21a(0x156)](_0x3fb21a(0x200));})[_0x2bc577(0x21e)](console[_0x2bc577(0x206)]);}),router[a0_0x12c55b(0x1f9)](a0_0x12c55b(0x202),auth,async(_0x3087ab,_0x472895)=>{const _0xbfedf8=a0_0x12c55b;try{const {username:_0x2b1d44,email:_0x445128,role:_0x29b127}=_0x3087ab['user'],_0xbac050=_0x3087ab[_0xbfedf8(0x242)],_0x15e926=await profile[_0xbfedf8(0x249)]({'email':_0xbac050[_0xbfedf8(0x1d3)]}),_0x27f3dc={'year':_0xbfedf8(0x1fd),'month':_0xbfedf8(0x229),'day':'numeric'},_0x2cb732=await master_shop[_0xbfedf8(0x25d)]();console[_0xbfedf8(0x1bf)](_0xbfedf8(0x25c),_0x2cb732);const _0x398cf5=await product[_0xbfedf8(0x25d)]();console[_0xbfedf8(0x1bf)](_0xbfedf8(0x1e2),_0x398cf5);const _0x21ac63=await warehouse[_0xbfedf8(0x27d)]([{'$unwind':_0xbfedf8(0x128)},{'$lookup':{'from':_0xbfedf8(0x287),'localField':_0xbfedf8(0x179),'foreignField':_0xbfedf8(0x16a),'as':_0xbfedf8(0x1f3)}},{'$unwind':_0xbfedf8(0x1ab)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0xbfedf8(0x129)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0xbfedf8(0x15f)}}}]);console[_0xbfedf8(0x1bf)]('Products\x20warehouse_data',_0x21ac63),_0x21ac63[_0xbfedf8(0x12b)](_0x478db9=>{const _0xaf32b9=_0xbfedf8,_0x2b9ede=_0x398cf5[_0xaf32b9(0x1cc)](_0x162d3b=>{const _0x451e10=_0xaf32b9;_0x162d3b['name']==_0x478db9[_0x451e10(0x14f)]&&(_0x162d3b[_0x451e10(0x24c)]=parseInt(_0x162d3b[_0x451e10(0x24c)])+parseInt(_0x478db9[_0x451e10(0x120)]));});});const _0x4db7ac=await staff[_0xbfedf8(0x25d)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x1f9e17=await staff[_0xbfedf8(0x249)]({'email':_0xbac050[_0xbfedf8(0x1d3)]});if(_0x2cb732[0x0][_0xbfedf8(0x10a)]==_0xbfedf8(0x257))var _0x5b98bd=users[_0xbfedf8(0x27b)];else{if(_0x2cb732[0x0]['language']==_0xbfedf8(0x256))var _0x5b98bd=users['Hindi'];else{if(_0x2cb732[0x0]['language']==_0xbfedf8(0x187))var _0x5b98bd=users['German'];else{if(_0x2cb732[0x0]['language']==_0xbfedf8(0x126))var _0x5b98bd=users[_0xbfedf8(0x126)];else{if(_0x2cb732[0x0][_0xbfedf8(0x10a)]==_0xbfedf8(0x114))var _0x5b98bd=users[_0xbfedf8(0x114)];else{if(_0x2cb732[0x0][_0xbfedf8(0x10a)]==_0xbfedf8(0x209))var _0x5b98bd=users[_0xbfedf8(0x143)];else{if(_0x2cb732[0x0][_0xbfedf8(0x10a)]=='Chinese')var _0x5b98bd=users['Chinese'];else{if(_0x2cb732[0x0]['language']=='Arabic\x20(ae)')var _0x5b98bd=users[_0xbfedf8(0x22a)];}}}}}}}_0x472895[_0xbfedf8(0x237)]('dssr_view_admin',{'success':_0x3087ab[_0xbfedf8(0x19a)](_0xbfedf8(0x238)),'errors':_0x3087ab[_0xbfedf8(0x19a)](_0xbfedf8(0x281)),'alldata':_0x398cf5,'profile':_0x15e926,'master_shop':_0x2cb732,'role':_0xbac050,'product_stock':_0x21ac63,'language':_0x5b98bd,'staff_arr':_0x1f9e17,'staff_data_all':_0x4db7ac});}catch(_0x1db488){}}),router[a0_0x12c55b(0x131)]('/getDSSR_no',auth,async(_0xacd4e9,_0x34792a)=>{const _0x373ad3=a0_0x12c55b;try{const {from:_0x7e1d0d,to:_0x4e62cf,staff_data:_0x483648}=_0xacd4e9[_0x373ad3(0x163)],_0x5ecb32=await Reference[_0x373ad3(0x27d)]([{'$match':{'date_include':{'$gte':_0x7e1d0d,'$lte':_0x4e62cf},'staff_id':_0x483648}},{'$sort':{'date_include':0x1}}]);_0x34792a['json'](_0x5ecb32);}catch(_0x11b76a){_0x34792a[_0x373ad3(0x1d9)](_0x11b76a);}}),router[a0_0x12c55b(0x1f9)]('/dsrr_admin/view_data/:id',auth,async(_0x457126,_0x2e706f)=>{const _0x484e8e=a0_0x12c55b;try{const _0x1fca14=_0x457126['params']['id'],_0x2e5374=await Reference[_0x484e8e(0x228)](_0x1fca14);let _0x24cdf3='';_0x24cdf3+=_0x2e5374[_0x484e8e(0x14d)],_0x24cdf3+=_0x484e8e(0x1e8),_0x24cdf3+='window.onload\x20=\x20function()\x20{',_0x24cdf3+=_0x484e8e(0x1e4),_0x24cdf3+='};',_0x24cdf3+=_0x484e8e(0x15b),_0x2e706f[_0x484e8e(0x177)](_0x24cdf3);}catch(_0x3961a4){_0x2e706f[_0x484e8e(0x1d9)](_0x3961a4);}}),router[a0_0x12c55b(0x131)](a0_0x12c55b(0x102),auth,async(_0x5b5a95,_0x159961)=>{const _0x3b0c97=a0_0x12c55b;try{const {ref_data:_0x3888e5}=_0x5b5a95[_0x3b0c97(0x163)],_0x438eff=_0x3888e5[_0x3b0c97(0x10f)]('~'),_0xa0b66d=_0x438eff['filter'](_0x49bb9f=>_0x49bb9f!==''),_0xe802e3=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0xa0b66d}}}]),_0x20cfd2=XLSX['utils'][_0x3b0c97(0x1bc)]();_0xe802e3[_0x3b0c97(0x12b)](_0x3d0a5c=>{const _0x51180c=_0x3b0c97,_0x4dad9b=cheerio[_0x51180c(0x199)](_0x3d0a5c[_0x51180c(0x14d)]);let _0x180469=[],_0x3e2bb1=[],_0x1769b7=[];_0x4dad9b(_0x51180c(0x146))['each']((_0x409b0b,_0x7078be)=>{const _0xb62f4d=_0x51180c;let _0x13e7d3=[],_0x16cc59=0x0;while(_0x1769b7[_0x16cc59]){_0x1769b7[_0x16cc59]--,_0x16cc59++;}_0x4dad9b(_0x7078be)['find'](_0xb62f4d(0x1b3))[_0xb62f4d(0x1c0)]((_0x4e7f3b,_0x3f1e24)=>{const _0x4bdd29=_0xb62f4d;let _0x3d851a=_0x4dad9b(_0x3f1e24)[_0x4bdd29(0x218)]()[_0x4bdd29(0x1be)](),_0x13c2e1=parseFloat(_0x3d851a[_0x4bdd29(0x283)](/,/g,''));isNaN(_0x13c2e1)&&(_0x13c2e1=_0x3d851a);let _0x3a35ef=parseInt(_0x4dad9b(_0x3f1e24)['attr'](_0x4bdd29(0x194)))||0x1,_0xfff923=parseInt(_0x4dad9b(_0x3f1e24)[_0x4bdd29(0x178)]('rowspan'))||0x1;_0x13e7d3[_0x16cc59]=_0x13c2e1;(_0x3a35ef>0x1||_0xfff923>0x1)&&_0x3e2bb1[_0x4bdd29(0x24d)]({'s':{'r':_0x409b0b,'c':_0x16cc59},'e':{'r':_0x409b0b+_0xfff923-0x1,'c':_0x16cc59+_0x3a35ef-0x1}});for(let _0x3939f9=0x0;_0x3939f9<_0x3a35ef;_0x3939f9++){_0xfff923>0x1&&(_0x1769b7[_0x16cc59+_0x3939f9]=_0xfff923-0x1);}_0x16cc59+=_0x3a35ef;}),_0x180469['push'](_0x13e7d3);});const _0x36724d=XLSX[_0x51180c(0x16f)][_0x51180c(0x198)](_0x180469);_0x3e2bb1[_0x51180c(0x23f)]>0x0&&(_0x36724d['!merges']=_0x3e2bb1),_0x36724d[_0x51180c(0x180)]=_0x180469[0x0][_0x51180c(0x1cc)](()=>({'wpx':0x64})),XLSX[_0x51180c(0x16f)][_0x51180c(0x27a)](_0x20cfd2,_0x36724d,_0x3d0a5c[_0x51180c(0x172)]);});const _0x1f75d4=XLSX[_0x3b0c97(0x25a)](_0x20cfd2,{'bookType':_0x3b0c97(0x204),'type':_0x3b0c97(0x109)});_0x159961[_0x3b0c97(0x11b)](_0x3b0c97(0x13a),'attachment;\x20filename=\x22reports.xlsx\x22'),_0x159961[_0x3b0c97(0x11b)]('Content-Type',_0x3b0c97(0x1a4)),_0x159961[_0x3b0c97(0x177)](_0x1f75d4);}catch(_0x3ef31d){_0x159961[_0x3b0c97(0x1d9)](_0x3ef31d);}}),router[a0_0x12c55b(0x131)](a0_0x12c55b(0x1e7),auth,async(_0x174ecb,_0x326bcc)=>{const _0x475de1=a0_0x12c55b,{from_date:_0x262ac9,agent_id:_0x1d6d73}=_0x174ecb[_0x475de1(0x163)],_0x3726d3=_0x174ecb[_0x475de1(0x242)],_0x2ec387=await staff[_0x475de1(0x249)]({'email':_0x3726d3[_0x475de1(0x1d3)]}),_0x5edba3=await master_shop['find'](),_0x4b37ee=await agentsdataDSICheck_DSRR(_0x262ac9,_0x1d6d73,_0x5300fe);let _0x298f24=_0x475de1(0x11f);var _0x12f72=new Date(_0x262ac9);const _0x10cbb5={'year':_0x475de1(0x1fd),'month':'long','day':_0x475de1(0x1fd)},_0x2a5fd7=new Intl[(_0x475de1(0x1b0))](_0x475de1(0x1d7),_0x10cbb5)[_0x475de1(0x17a)](_0x12f72);_0x298f24+='<div\x20class=\x22row\x22>',_0x298f24+=_0x475de1(0x13d),_0x298f24+=_0x475de1(0x1fb),_0x298f24+=_0x4b37ee,_0x298f24+=_0x475de1(0x24a),_0x298f24+='</div>',_0x298f24+=_0x475de1(0x210);let _0x443102='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x5df563={'width':'15in','height':_0x475de1(0x1e9),'orientation':_0x475de1(0x1f5),'border':{'top':_0x475de1(0x145),'right':'0.1in','bottom':_0x475de1(0x145),'left':'0.1in'},'header':{'height':_0x475de1(0x16c),'contents':_0x475de1(0x212)+_0x443102+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x2a5fd7+_0x475de1(0x196)},'footer':{'height':_0x475de1(0x17f),'contents':{'default':_0x475de1(0x23e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x475de1(0x10d)}}};var _0x5300fe='on';if(_0x5300fe=='on'){const _0x542782=cheerio['load'](_0x298f24);let _0x21a6ba=[],_0x21753b=[],_0x56d6ee=[];_0x542782(_0x475de1(0x146))[_0x475de1(0x1c0)]((_0xcd1a74,_0x464df6)=>{const _0x420a93=_0x475de1;let _0x295002=[],_0x39c99b=0x0;while(_0x56d6ee[_0x39c99b]){_0x56d6ee[_0x39c99b]--,_0x39c99b++;}_0x542782(_0x464df6)[_0x420a93(0x25d)](_0x420a93(0x1b3))[_0x420a93(0x1c0)]((_0x6392f1,_0x52f5c4)=>{const _0x329048=_0x420a93;let _0x3aff8f=_0x542782(_0x52f5c4)['text']()[_0x329048(0x1be)](),_0x3d4d4b=parseFloat(_0x3aff8f[_0x329048(0x283)](/,/g,''));isNaN(_0x3d4d4b)&&(_0x3d4d4b=_0x3aff8f);let _0x25744b=parseInt(_0x542782(_0x52f5c4)[_0x329048(0x178)](_0x329048(0x194)))||0x1,_0x1c1260=parseInt(_0x542782(_0x52f5c4)[_0x329048(0x178)](_0x329048(0x1cf)))||0x1;_0x295002[_0x39c99b]=_0x3d4d4b;(_0x25744b>0x1||_0x1c1260>0x1)&&_0x21753b[_0x329048(0x24d)]({'s':{'r':_0xcd1a74,'c':_0x39c99b},'e':{'r':_0xcd1a74+_0x1c1260-0x1,'c':_0x39c99b+_0x25744b-0x1}});for(let _0xff2e47=0x0;_0xff2e47<_0x25744b;_0xff2e47++){_0x1c1260>0x1&&(_0x56d6ee[_0x39c99b+_0xff2e47]=_0x1c1260-0x1);}_0x39c99b+=_0x25744b;}),_0x21a6ba[_0x420a93(0x24d)](_0x295002);});const _0x3abae0=XLSX[_0x475de1(0x16f)][_0x475de1(0x1bc)](),_0x14f8c5=XLSX['utils']['aoa_to_sheet'](_0x21a6ba);_0x21753b[_0x475de1(0x23f)]>0x0&&(_0x14f8c5[_0x475de1(0x15e)]=_0x21753b);_0x14f8c5[_0x475de1(0x180)]=_0x21a6ba[0x0][_0x475de1(0x1cc)](()=>({'wpx':0x64})),XLSX[_0x475de1(0x16f)][_0x475de1(0x27a)](_0x3abae0,_0x14f8c5,'Sales\x20Report');const _0x5a873a=XLSX['write'](_0x3abae0,{'bookType':_0x475de1(0x204),'type':_0x475de1(0x109)});_0x326bcc['setHeader'](_0x475de1(0x13a),_0x475de1(0x269)),_0x326bcc['setHeader'](_0x475de1(0x260),_0x475de1(0x1a4)),_0x326bcc[_0x475de1(0x177)](_0x5a873a);}else pdf[_0x475de1(0x113)](_0x298f24,_0x5df563)['toStream'](function(_0x578cfc,_0x492c44){const _0x417abc=_0x475de1;if(_0x578cfc){_0x326bcc[_0x417abc(0x252)](0x1f4)[_0x417abc(0x177)](_0x417abc(0x1d1));return;}_0x326bcc['setHeader']('Content-Type',_0x417abc(0x21f)),_0x492c44['pipe'](_0x326bcc);});}),module[a0_0x12c55b(0x1cd)]=router;