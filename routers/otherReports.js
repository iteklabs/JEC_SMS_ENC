function a0_0xc3df(){const _0x4d0bd4=['<tr>','amount','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','Letter','<td\x20colspan=\x223\x22><b>TOTAL<b>','json','window.onload\x20=\x20function()\x20{','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','totalQty','\x22\x20class=\x22cat_data\x22>','</tr>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','buffer','$products.product_details.prod_id','filter','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','/dsrr_admin/pdf_admin','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','colspan','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','/inventory_sum/pdf','getMonth','NetPrice','$sales_staff_id','$customer','dssr_view','due_date','language','Products\x20find_data','$amount','category','/dsrr/view','<th>\x20BEG\x20BALANCE\x20</th>','$product_info','user','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','thick','699909kFuBhA','<td\x20class=\x22cat_data\x22></td>','book_append_sheet','/reports/dsrr/view','balanced','<p>FINISHED\x20GOODS\x20INVENTORY</p>','replace','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','266tgdtMJ','60mm','Arabic','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','/dsrr_admin/view_data/:id','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','$_id.date','Arabic\x20(ae)','$name','/inventory_sum/view','length','<div\x20style=\x22page-break-before:\x20always;\x22></div>','/agent_reports/view','$sales_info','<td\x20class=\x22row_data\x22>0</td>','$dsi','save','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','name','jsbarcode','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','findById','$products.product_details','true','date_include','border-right','Products\x20warehouse_data','toISOString','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','$sale_product.real_qty_unit_val','redirect','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','Products\x20master','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','error','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','cheerio','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','$product.quantity','6HsIjzG','../models/all_models','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','utils','Router','send','0.1in','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','/getDSSR_no_sales','mongoose','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','each','$products.NetPrice','Portuguese\x20(BR)','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','8.5in','sales_ext','toFixed','2178916HHYAvc','<th>\x20ENDING\x20BALANCE\x20</th>','Error\x20generating\x20PDF','English\x20(US)','$products','write','dsi_sales_admin','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','$brand','<div\x20class=\x22col-sm-11\x22>','sales_man_code','<tbody>','body','product_stock','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','html-pdf','$sale_product.quantity','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','split','isFG','$sales_info._id','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','$_id.status_data','<script>','express/lib/response','/total_sales_reports/view','../public/language/languages.json','\x20-\x20HH','forEach','express','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','push','/agent/view','$products.product_details.gross_price','dataqty','td,\x20th','<th>Booking</th>','sales_info','No\x20data\x20was\x20Found!','20mm','\x20-\x20','xlsx','$totalGross','$product','$bank','log','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','3047AfHvTZ','long','note','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','top','PDF\x20Generation\x20Error:','$sale_product.product_name','totalQTY','attachment;\x20filename=\x22sales_report.xlsx\x22','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','totalGross','15in','dsi','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','bank','border-bottom','<th>X-Truck</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20colspan=\x22','border-top','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','errors','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','$product_details.product_name','$_id.category','<th\x20rowspan=\x272\x27>Category</th>','$product_details','$product_name','000000','toLocaleString','exports','en-US','includes','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','$product_info.name','valueOf','sales_reports','<th>\x20QTY\x20SOLD\x20</th>','book_new','$category','/agent/pdf','$discount','4476cHShdN','</thead>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','/dev/null','getDate','product_name','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','product_info','Portuguese','Standard','$_id.dsi','$product_info.brand','multer','cash','agent_sales','2306xnWlEB','$product_info.product_code','</th>','<th>\x20ITEM\x20CODE\x20</th>','$sales_info.name','44410rUNrSt','<th>\x20SALES\x20</th>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','slice','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','$sale_product._id','</div>','right','$check_no','$products.adj_discount','products','<th\x20rowspan=\x272\x27>Products</th>','$adj_discount','findOne','then','getFullYear','params','</script>','</tbody>','email','find','_id','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','staffs','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','product_details','window.print();','prod_cat','$products.product_details.category','$products.qty','render','<td\x20class=\x22row_data\x22>','Sales\x20Report','DateTimeFormat','aoa_to_sheet','$status_data','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','medium','<div\x20class=\x22row\x22>','excel','brandCount','path','totalQTYsum','/agent_reports/pdf','$product_docs','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','Asia/Manila','sales_staff_id','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','$sale_product','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','setHeader','post','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','application/pdf','beg_bal','$sale_product.stock','left','$product_list.product_name','canvas','customer','text','$sale_product.adj_discount','border-left','</table>','aggregate','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$_id.brand','/getDSSR_no','inventory_sum','get','sale_product.product_code','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','</td>','salesman_data','toStream','30468yiwoAs','<th>\x20INVOICE\x20AMOUNT\x20</th>','$product_info.gross_price','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','72nVOEkQ','Hindi','landscape','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','discount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','sumqty','$sale_product.prod_cat','!merges','NumberFormat','catch','German','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','$cash','<h1>JAKA\x20EQUITIES\x20CORP</h1>','setDate','$sale_product.product_code','pdfkit-table','/balance/view','$product_info.category','$product_details.product_stock','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','$due_date','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','$product_code','totalPrice','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$totalQty','test','!cols','<p>INVENTORY\x20SUMMARY</p>','html','Household','numeric','$products.discount','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','qty','$NetPrice','dssr_view_admin','status','ObjectId','$product_stock','French','9225KldQPr','cat_brand','sort','date','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','map','style','\x22><b>','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','<thead>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','sales_bkg','311VRtTSV','Chinese','success','$sale_product.totalprice','Content-Disposition','$date','</b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','create','format','check_no','table\x20tr','exceljs','$product_list.product_stock','$_id.customer','thin','toLocaleDateString','product_docs','<td\x20class=\x22row_data\x22><b>','</p>','$sale_product.discount','<div\x20\x20id=\x22table-conatainer\x22>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','false','<td\x20class=\x22row_data\x22></td>','Spanish','brand','$products.product_details.brand','2763ILvaFK','attachment;\x20filename=\x22reports.xlsx\x22','isArray','/balance/pdf','attr','flash','bottom','<td\x20class=\x22cat_data\x22>','pipe','<table>','/total_sales_reports/pdf','English','$product_list.product_code','reduce','<th\x20colspan=\x272\x27>SOLD</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','$product.product_code','load','Content-Type','rowspan','trim','referenceNumber','stock','2134457MzKTSe','product_code','\x20-\x20STD','Types','product_details.product_name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>'];a0_0xc3df=function(){return _0x4d0bd4;};return a0_0xc3df();}function a0_0x3c37(_0x4693c6,_0x2bf9be){const _0xc3dfe6=a0_0xc3df();return a0_0x3c37=function(_0x3c3780,_0x3cd0e6){_0x3c3780=_0x3c3780-0x1c4;let _0x22c702=_0xc3dfe6[_0x3c3780];return _0x22c702;},a0_0x3c37(_0x4693c6,_0x2bf9be);}const a0_0x8d7790=a0_0x3c37;(function(_0x2bfde4,_0x41bf17){const _0xd343a5=a0_0x3c37,_0x3dfb6c=_0x2bfde4();while(!![]){try{const _0x5bebd2=parseInt(_0xd343a5(0x30a))/0x1*(-parseInt(_0xd343a5(0x27a))/0x2)+-parseInt(_0xd343a5(0x1fb))/0x3*(-parseInt(_0xd343a5(0x20f))/0x4)+parseInt(_0xd343a5(0x2fe))/0x5*(-parseInt(_0xd343a5(0x26b))/0x6)+-parseInt(_0xd343a5(0x1cc))/0x7*(parseInt(_0xd343a5(0x2d0))/0x8)+-parseInt(_0xd343a5(0x327))/0x9*(parseInt(_0xd343a5(0x27f))/0xa)+parseInt(_0xd343a5(0x241))/0xb*(parseInt(_0xd343a5(0x2cc))/0xc)+parseInt(_0xd343a5(0x33f))/0xd*(parseInt(_0xd343a5(0x1d4))/0xe);if(_0x5bebd2===_0x41bf17)break;else _0x3dfb6c['push'](_0x3dfb6c['shift']());}catch(_0x5da41b){_0x3dfb6c['push'](_0x3dfb6c['shift']());}}}(a0_0xc3df,0xdf2d1));const express=require(a0_0x8d7790(0x22c)),res=require(a0_0x8d7790(0x227)),app=express(),router=express[a0_0x8d7790(0x1ff)](),multer=require(a0_0x8d7790(0x277)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x8d7790(0x1fc)),auth=require('../middleware/auth'),users=require(a0_0x8d7790(0x229)),excelJS=require(a0_0x8d7790(0x317)),XLSX=require('xlsx'),PDFDocument=require(a0_0x8d7790(0x2e1)),fs=require('fs'),blobStream=require('blob-stream'),JsBarcode=require(a0_0x8d7790(0x1e7)),{Canvas}=require(a0_0x8d7790(0x2bb)),pdf=require(a0_0x8d7790(0x21e)),path=require(a0_0x8d7790(0x2a8)),mongoose=require(a0_0x8d7790(0x204)),cheerio=require(a0_0x8d7790(0x1f8));router[a0_0x8d7790(0x2c6)](a0_0x8d7790(0x2e2),auth,async(_0x1be4be,_0x258a44)=>{const _0x562564=a0_0x8d7790;try{const {username:_0x23b044,email:_0x5cd128,role:_0x3760aa}=_0x1be4be['user'],_0x43bb52=_0x1be4be['user'],_0x4fd10e=await profile[_0x562564(0x28c)]({'email':_0x43bb52[_0x562564(0x292)]}),_0x585c26={'year':_0x562564(0x2f4),'month':'long','day':'numeric'},_0x232fdf=await master_shop[_0x562564(0x293)]();console[_0x562564(0x23e)](_0x562564(0x1f4),_0x232fdf);const _0x240a0e=await product[_0x562564(0x293)]();console[_0x562564(0x23e)](_0x562564(0x362),_0x240a0e);const _0xc03704=await warehouse['aggregate']([{'$unwind':_0x562564(0x25b)},{'$lookup':{'from':_0x562564(0x289),'localField':_0x562564(0x343),'foreignField':_0x562564(0x1e6),'as':_0x562564(0x31c)}},{'$unwind':_0x562564(0x2ab)},{'$project':{'product_name':_0x562564(0x258),'product_stock':_0x562564(0x2e4)}},{'$group':{'_id':_0x562564(0x25c),'product_stock':{'$sum':_0x562564(0x2fc)}}}]);console[_0x562564(0x23e)](_0x562564(0x1ee),_0xc03704),_0xc03704[_0x562564(0x22b)](_0x21c8c8=>{const _0x34d1ed=_0x240a0e['map'](_0xb008fb=>{const _0x19e906=a0_0x3c37;_0xb008fb['name']==_0x21c8c8[_0x19e906(0x294)]&&(_0xb008fb[_0x19e906(0x33e)]=parseInt(_0xb008fb['stock'])+parseInt(_0x21c8c8[_0x19e906(0x21c)]));});}),console[_0x562564(0x23e)]('Products\x20find_data',_0x240a0e);if(_0x232fdf[0x0][_0x562564(0x361)]==_0x562564(0x212))var _0x51a6f9=users['English'];else{if(_0x232fdf[0x0][_0x562564(0x361)]==_0x562564(0x2d1))var _0x51a6f9=users[_0x562564(0x2d1)];else{if(_0x232fdf[0x0]['language']==_0x562564(0x2db))var _0x51a6f9=users[_0x562564(0x2db)];else{if(_0x232fdf[0x0]['language']==_0x562564(0x324))var _0x51a6f9=users[_0x562564(0x324)];else{if(_0x232fdf[0x0][_0x562564(0x361)]==_0x562564(0x2fd))var _0x51a6f9=users[_0x562564(0x2fd)];else{if(_0x232fdf[0x0][_0x562564(0x361)]==_0x562564(0x209))var _0x51a6f9=users[_0x562564(0x273)];else{if(_0x232fdf[0x0][_0x562564(0x361)]=='Chinese')var _0x51a6f9=users[_0x562564(0x30b)];else{if(_0x232fdf[0x0]['language']==_0x562564(0x1db))var _0x51a6f9=users[_0x562564(0x1d6)];}}}}}}}_0x258a44[_0x562564(0x29d)](_0x562564(0x1d0),{'success':_0x1be4be[_0x562564(0x32c)](_0x562564(0x30c)),'errors':_0x1be4be[_0x562564(0x32c)]('errors'),'alldata':_0x240a0e,'profile':_0x4fd10e,'master_shop':_0x232fdf,'role':_0x43bb52,'product_stock':_0xc03704,'language':_0x51a6f9});}catch(_0x12038d){}});async function dataCheck(_0x1d1e53,_0x57e762){const _0x5bebe3=a0_0x8d7790,_0xa5889f=await product[_0x5bebe3(0x2c1)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x189a82=[];_0x189a82['cat_brand']=[];for(let _0x4050b3=0x0;_0x4050b3<=_0xa5889f['length']-0x1;_0x4050b3++){const _0x5bb58d=_0xa5889f[_0x4050b3];_0x189a82[_0x5bebe3(0x2ff)][_0x5bebe3(0x230)](_0x5bb58d);}const _0x2462ad=await product[_0x5bebe3(0x2c1)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x5bebe3(0x217),'product_code':_0x5bebe3(0x2e9),'product_name':_0x5bebe3(0x1dc)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4487cd=await purchases_finished[_0x5bebe3(0x2c1)]([{'$match':{'date':{'$gte':_0x1d1e53,'$lte':_0x57e762}}},{'$unwind':_0x5bebe3(0x23c)},{'$group':{'_id':{'product_name':'$product.product_name','product_code':_0x5bebe3(0x338)},'totalQTY':{'$sum':_0x5bebe3(0x1fa)}}}]);_0x189a82[_0x5bebe3(0x2b7)]=[];for(let _0x437cee=0x0;_0x437cee<=_0x4487cd[_0x5bebe3(0x1de)]-0x1;_0x437cee++){const _0x5b79c1=_0x4487cd[_0x437cee];_0x189a82[_0x5bebe3(0x2b7)]['push'](_0x5b79c1);}const _0x3db47b=await sales_sa[_0x5bebe3(0x2c1)]([{'$match':{'date':{'$gte':_0x1d1e53,'$lte':_0x57e762}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x5bebe3(0x296),'localField':'sales_staff_id','foreignField':_0x5bebe3(0x294),'as':_0x5bebe3(0x236)}},{'$unwind':_0x5bebe3(0x1e1)},{'$unwind':_0x5bebe3(0x2b1)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x5bebe3(0x247),'product_code':_0x5bebe3(0x2e0)},'totalQTY':{'$sum':_0x5bebe3(0x21f)}}}]);console['log'](_0x3db47b[0x0]),_0x189a82['sales_bkg']=[];for(let _0x2d7a51=0x0;_0x2d7a51<=_0x3db47b[_0x5bebe3(0x1de)]-0x1;_0x2d7a51++){const _0x14bfe4=_0x3db47b[_0x2d7a51];_0x189a82['sales_bkg']['push'](_0x14bfe4);}const _0x1d3098=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x1d1e53,'$lte':_0x57e762}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5bebe3(0x35d)}}},{'$lookup':{'from':_0x5bebe3(0x296),'localField':_0x5bebe3(0x2ae),'foreignField':_0x5bebe3(0x294),'as':_0x5bebe3(0x236)}},{'$unwind':_0x5bebe3(0x1e1)},{'$unwind':_0x5bebe3(0x2b1)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x5bebe3(0x322)}},{'$group':{'_id':{'product_name':_0x5bebe3(0x247),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x5bebe3(0x1f1)}}}]);_0x189a82['sales_ext']=[];for(let _0x2b2e7c=0x0;_0x2b2e7c<=_0x1d3098['length']-0x1;_0x2b2e7c++){const _0x213f5b=_0x1d3098[_0x2b2e7c];_0x189a82[_0x5bebe3(0x20d)][_0x5bebe3(0x230)](_0x213f5b);}let _0x3e520d='';for(let _0x4c2e2b=0x0;_0x4c2e2b<=_0x2462ad[_0x5bebe3(0x1de)]-0x1;_0x4c2e2b++){const _0x2e2eb5=_0x2462ad[_0x4c2e2b];_0x3e520d+=_0x5bebe3(0x345),_0x3e520d+=_0x5bebe3(0x359)+_0x2e2eb5[_0x5bebe3(0x294)][_0x5bebe3(0x1c5)]+_0x5bebe3(0x2c9),_0x3e520d+=_0x5bebe3(0x350);for(let _0x1fbab7=0x0;_0x1fbab7<_0x189a82['cat_brand']['length'];_0x1fbab7++){const _0x499901=_0x189a82['cat_brand'][_0x1fbab7];if(_0x499901['_id'][_0x5bebe3(0x1c5)]==_0x2e2eb5['_id']['category']){let _0x550816=[],_0x17f6e9=[],_0x28db5d=[];_0x550816[_0x499901['_id'][_0x5bebe3(0x325)]]=[],_0x17f6e9[_0x499901[_0x5bebe3(0x294)]['brand']]=[],_0x28db5d[_0x499901[_0x5bebe3(0x294)][_0x5bebe3(0x325)]]=[];var _0x4a49fd=0x0,_0x10bea4=0x0,_0x4d3925=0x0;for(let _0x4f4c8d=0x0;_0x4f4c8d<_0x499901[_0x5bebe3(0x289)][_0x5bebe3(0x1de)];_0x4f4c8d++){const _0x72afdc=_0x499901[_0x5bebe3(0x289)][_0x4f4c8d];for(let _0xcfed6f=0x0;_0xcfed6f<=_0x189a82[_0x5bebe3(0x2b7)][_0x5bebe3(0x1de)]-0x1;_0xcfed6f++){const _0x5bef02=_0x189a82['beg_bal'][_0xcfed6f];_0x5bef02[_0x5bebe3(0x294)][_0x5bebe3(0x270)]==_0x72afdc[_0x5bebe3(0x1e6)]&&_0x5bef02[_0x5bebe3(0x294)][_0x5bebe3(0x340)]==_0x72afdc[_0x5bebe3(0x340)]&&(_0x4a49fd+=parseInt(_0x5bef02[_0x5bebe3(0x248)],0xa));}for(let _0xfdccd2=0x0;_0xfdccd2<=_0x189a82['sales_ext'][_0x5bebe3(0x1de)]-0x1;_0xfdccd2++){const _0x312530=_0x189a82[_0x5bebe3(0x20d)][_0xfdccd2];_0x312530[_0x5bebe3(0x294)][_0x5bebe3(0x270)]==_0x72afdc[_0x5bebe3(0x1e6)]&&_0x312530[_0x5bebe3(0x294)][_0x5bebe3(0x340)]==_0x72afdc[_0x5bebe3(0x340)]&&(_0x10bea4+=parseFloat(_0x312530[_0x5bebe3(0x248)],0xa)['toFixed'](0x2));}for(let _0x58c19b=0x0;_0x58c19b<=_0x189a82[_0x5bebe3(0x309)][_0x5bebe3(0x1de)]-0x1;_0x58c19b++){const _0x146024=_0x189a82[_0x5bebe3(0x309)][_0x58c19b];_0x146024[_0x5bebe3(0x294)][_0x5bebe3(0x270)]==_0x72afdc[_0x5bebe3(0x1e6)]&&_0x146024['_id'][_0x5bebe3(0x340)]==_0x72afdc['product_code']&&(_0x4d3925+=parseInt(_0x146024[_0x5bebe3(0x248)],0xa));}}const _0x5c21b8=new Intl[(_0x5bebe3(0x2d9))]('en-US');var _0x1781d3=_0x5c21b8[_0x5bebe3(0x314)](_0x4a49fd);_0x550816[_0x499901['_id'][_0x5bebe3(0x325)]][_0x5bebe3(0x230)](_0x1781d3),_0x17f6e9[_0x499901[_0x5bebe3(0x294)][_0x5bebe3(0x325)]]['push'](_0x5c21b8[_0x5bebe3(0x314)](_0x10bea4)),_0x28db5d[_0x499901[_0x5bebe3(0x294)]['brand']][_0x5bebe3(0x230)](_0x5c21b8[_0x5bebe3(0x314)](_0x4d3925));var _0x5578cf=_0x5c21b8['format'](_0x4a49fd-(_0x4d3925+_0x10bea4));_0x3e520d+='<tr>',_0x3e520d+=_0x5bebe3(0x323),_0x3e520d+='<td\x20class=\x22row_data\x22>'+_0x499901['_id'][_0x5bebe3(0x325)]+_0x5bebe3(0x2c9),_0x3e520d+=_0x5bebe3(0x29e)+_0x550816[_0x499901[_0x5bebe3(0x294)][_0x5bebe3(0x325)]][0x0]+_0x5bebe3(0x2c9),_0x3e520d+=_0x5bebe3(0x1e2),_0x3e520d+='<td\x20class=\x22row_data\x22>'+_0x28db5d[_0x499901[_0x5bebe3(0x294)][_0x5bebe3(0x325)]][0x0]+'</td>',_0x3e520d+=_0x5bebe3(0x29e)+_0x17f6e9[_0x499901[_0x5bebe3(0x294)][_0x5bebe3(0x325)]][0x0]+_0x5bebe3(0x2c9),_0x3e520d+=_0x5bebe3(0x29e)+_0x5578cf+_0x5bebe3(0x2c9),_0x3e520d+='</tr>';}}}return console[_0x5bebe3(0x23e)](_0x189a82[_0x5bebe3(0x309)]),_0x3e520d;}router[a0_0x8d7790(0x2b4)](a0_0x8d7790(0x32a),auth,async(_0x24474f,_0x36797f)=>{const _0x228744=a0_0x8d7790,{from_date:_0x2adb4c,to_date:_0x480bfb}=_0x24474f['body'],_0x362b15=await dataCheck(_0x2adb4c,_0x480bfb);{}let _0x11918b=_0x228744(0x2c8);var _0x569d22=new Date(_0x2adb4c),_0x2b7e92=new Date(_0x480bfb);const _0x57713c={'year':_0x228744(0x2f4),'month':_0x228744(0x242),'day':_0x228744(0x2f4)},_0x2cd67a=new Intl[(_0x228744(0x2a0))](_0x228744(0x260),_0x57713c)[_0x228744(0x314)](_0x569d22),_0x1f2513=new Intl['DateTimeFormat'](_0x228744(0x260),_0x57713c)['format'](_0x2b7e92);_0x11918b+=_0x228744(0x2de),_0x11918b+=_0x228744(0x1d1),_0x11918b+='<p>'+_0x2cd67a+'\x20-\x20'+_0x1f2513+_0x228744(0x31e),_0x11918b+=_0x228744(0x2a5),_0x11918b+='<div\x20class=\x22col-sm-11\x22>',_0x11918b+=_0x228744(0x330),_0x11918b+=_0x228744(0x345),_0x11918b+=_0x228744(0x25a),_0x11918b+=_0x228744(0x28a),_0x11918b+=_0x228744(0x1f7)+_0x2cd67a+_0x228744(0x27c),_0x11918b+='<th\x20rowspan=\x272\x27>Production</th>',_0x11918b+=_0x228744(0x335),_0x11918b+=_0x228744(0x22f)+_0x1f2513+_0x228744(0x27c),_0x11918b+=_0x228744(0x350),_0x11918b+='<tr>',_0x11918b+=_0x228744(0x235),_0x11918b+=_0x228744(0x251),_0x11918b+='</tr>',_0x11918b+=_0x362b15,_0x11918b+=_0x228744(0x2c0),_0x11918b+=_0x228744(0x285),_0x11918b+=_0x228744(0x285);const _0x410f47={'format':'Letter','orientation':_0x228744(0x2d2),'childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf[_0x228744(0x313)](_0x11918b,_0x410f47)[_0x228744(0x2cb)](function(_0x2bfc99,_0x48c90d){const _0x5355e8=_0x228744;if(_0x2bfc99){_0x36797f[_0x5355e8(0x2fa)](0x1f4)[_0x5355e8(0x200)](_0x5355e8(0x211));return;}_0x36797f[_0x5355e8(0x2b3)]('Content-Type',_0x5355e8(0x2b6)),_0x48c90d[_0x5355e8(0x32f)](_0x36797f);});}),router[a0_0x8d7790(0x2c6)](a0_0x8d7790(0x231),auth,async(_0x5abdfb,_0x407ba3)=>{const _0x2a9130=a0_0x8d7790;try{const {username:_0x25808a,email:_0x101d4c,role:_0x1551a7}=_0x5abdfb['user'],_0x1e744f=_0x5abdfb['user'],_0x2fa4ce=await profile['findOne']({'email':_0x1e744f[_0x2a9130(0x292)]}),_0x48390d={'year':_0x2a9130(0x2f4),'month':_0x2a9130(0x242),'day':_0x2a9130(0x2f4)},_0x21e285=await master_shop[_0x2a9130(0x293)](),_0x3bc314=await product['find'](),_0x27ba96=await warehouse[_0x2a9130(0x2c1)]([{'$unwind':_0x2a9130(0x25b)},{'$lookup':{'from':_0x2a9130(0x289),'localField':_0x2a9130(0x343),'foreignField':_0x2a9130(0x1e6),'as':_0x2a9130(0x31c)}},{'$unwind':_0x2a9130(0x2ab)},{'$project':{'product_name':_0x2a9130(0x258),'product_stock':_0x2a9130(0x2e4)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2a9130(0x2fc)}}}]);if(_0x21e285[0x0][_0x2a9130(0x361)]==_0x2a9130(0x212))var _0x731061=users[_0x2a9130(0x332)];else{if(_0x21e285[0x0]['language']==_0x2a9130(0x2d1))var _0x731061=users[_0x2a9130(0x2d1)];else{if(_0x21e285[0x0][_0x2a9130(0x361)]==_0x2a9130(0x2db))var _0x731061=users['German'];else{if(_0x21e285[0x0][_0x2a9130(0x361)]==_0x2a9130(0x324))var _0x731061=users[_0x2a9130(0x324)];else{if(_0x21e285[0x0]['language']=='French')var _0x731061=users[_0x2a9130(0x2fd)];else{if(_0x21e285[0x0]['language']=='Portuguese\x20(BR)')var _0x731061=users[_0x2a9130(0x273)];else{if(_0x21e285[0x0]['language']==_0x2a9130(0x30b))var _0x731061=users['Chinese'];else{if(_0x21e285[0x0][_0x2a9130(0x361)]==_0x2a9130(0x1db))var _0x731061=users['Arabic'];}}}}}}}_0x407ba3['render'](_0x2a9130(0x279),{'success':_0x5abdfb[_0x2a9130(0x32c)](_0x2a9130(0x30c)),'errors':_0x5abdfb[_0x2a9130(0x32c)]('errors'),'alldata':_0x3bc314,'profile':_0x2fa4ce,'master_shop':_0x21e285,'role':_0x1e744f,'product_stock':_0x27ba96,'language':_0x731061});}catch(_0xf4ed8d){}});async function agentsdataCheck(_0x31bd36,_0x32f777){const _0x5460df=a0_0x8d7790,_0x36be6e=await product[_0x5460df(0x2c1)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':'$name','product_code':_0x5460df(0x2e9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2b8bc4=[];_0x2b8bc4[_0x5460df(0x2ff)]=[];for(let _0x27c19b=0x0;_0x27c19b<=_0x36be6e[_0x5460df(0x1de)]-0x1;_0x27c19b++){const _0x375851=_0x36be6e[_0x27c19b];_0x2b8bc4[_0x5460df(0x2ff)][_0x5460df(0x230)](_0x375851);}const _0xfd085b=await product[_0x5460df(0x2c1)]([{'$group':{'_id':{'category':_0x5460df(0x268)},'products':{'$push':{'brand':_0x5460df(0x217),'product_code':_0x5460df(0x2e9),'product_name':_0x5460df(0x1dc)}}}},{'$sort':{'_id.category':-0x1}}]),_0x22a490=await product[_0x5460df(0x2c1)]([{'$group':{'_id':{'category':_0x5460df(0x268),'brand':'$brand'}}},{'$group':{'_id':_0x5460df(0x259),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4c5acb=await sales_sa[_0x5460df(0x2c1)]([{'$match':{'date':{'$gte':_0x31bd36,'$lte':_0x32f777}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x5460df(0x296),'localField':'sales_staff_id','foreignField':_0x5460df(0x294),'as':'sales_info'}},{'$unwind':_0x5460df(0x1e1)},{'$unwind':_0x5460df(0x2b1)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':'false'}},{'$lookup':{'from':_0x5460df(0x289),'localField':_0x5460df(0x2c7),'foreignField':_0x5460df(0x340),'as':_0x5460df(0x272)}},{'$unwind':_0x5460df(0x1c8)},{'$group':{'_id':{'sales_id':_0x5460df(0x223),'category':_0x5460df(0x2e3),'brand':_0x5460df(0x276)},'salesman_data':{'$first':_0x5460df(0x27e)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','product_details':{'prod_name':_0x5460df(0x263),'product_code':_0x5460df(0x27b),'category':_0x5460df(0x2e3),'brand':'$product_info.brand'}}}}}]);let _0x4d93b4='';_0x4d93b4+=_0x5460df(0x345),_0x4d93b4+=_0x5460df(0x357),_0x4d93b4+='</tr>',_0x4d93b4+='<tr>',_0x4d93b4+='<td\x20class=\x22cat_data\x22></td>';for(let _0x61bfb3=0x0;_0x61bfb3<=_0xfd085b[_0x5460df(0x1de)]-0x1;_0x61bfb3++){const _0xf7a0df=_0xfd085b[_0x61bfb3];for(let _0x33163b=0x0;_0x33163b<_0x22a490[_0x5460df(0x1de)];_0x33163b++){const _0x3e2f70=_0x22a490[_0x33163b];_0x3e2f70[_0x5460df(0x294)]==_0xf7a0df[_0x5460df(0x294)][_0x5460df(0x1c5)]&&(_0x4d93b4+=_0x5460df(0x253)+_0x3e2f70[_0x5460df(0x2a7)]+_0x5460df(0x34f)+_0xf7a0df[_0x5460df(0x294)]['category']+_0x5460df(0x2c9));}}_0x4d93b4+=_0x5460df(0x1cd),_0x4d93b4+='</tr>',_0x4d93b4+=_0x5460df(0x345),_0x4d93b4+=_0x5460df(0x216);for(let _0x394000=0x0;_0x394000<=_0xfd085b[_0x5460df(0x1de)]-0x1;_0x394000++){const _0x1eafa5=_0xfd085b[_0x394000];for(let _0x26219a=0x0;_0x26219a<_0x2b8bc4[_0x5460df(0x2ff)][_0x5460df(0x1de)];_0x26219a++){const _0x4a0bdf=_0x2b8bc4[_0x5460df(0x2ff)][_0x26219a];_0x4a0bdf['_id']['category']==_0x1eafa5[_0x5460df(0x294)][_0x5460df(0x1c5)]&&(_0x4d93b4+=_0x5460df(0x32e)+_0x4a0bdf[_0x5460df(0x294)][_0x5460df(0x325)]+_0x5460df(0x2c9));}}_0x4d93b4+=_0x5460df(0x2b2),_0x4d93b4+='</tr>';let _0x71e548={'name':[],'dataqty':{}};for(let _0x2dc700=0x0;_0x2dc700<_0x2b8bc4[_0x5460df(0x2ff)][_0x5460df(0x1de)];_0x2dc700++){const _0x5bdd8f=_0x2b8bc4[_0x5460df(0x2ff)][_0x2dc700],_0x2724a2=_0x5bdd8f[_0x5460df(0x294)][_0x5460df(0x325)],_0x2532f0=_0x5bdd8f[_0x5460df(0x294)]['category'];!_0x71e548[_0x5460df(0x233)][_0x2724a2]&&(_0x71e548[_0x5460df(0x233)][_0x2724a2]={});!_0x71e548[_0x5460df(0x233)][_0x2724a2][_0x2532f0]&&(_0x71e548[_0x5460df(0x233)][_0x2724a2][_0x2532f0]=[]);for(let _0x1ffe34=0x0;_0x1ffe34<_0x4c5acb[_0x5460df(0x1de)];_0x1ffe34++){const _0x41720b=_0x4c5acb[_0x1ffe34];if(_0x2724a2===_0x41720b[_0x5460df(0x294)][_0x5460df(0x325)]&&_0x2532f0===_0x41720b[_0x5460df(0x294)][_0x5460df(0x1c5)]){const _0x4448b6=_0x41720b[_0x5460df(0x2ca)];!_0x71e548[_0x5460df(0x233)][_0x2724a2][_0x2532f0][_0x4448b6]&&(_0x71e548[_0x5460df(0x233)][_0x2724a2][_0x2532f0][_0x4448b6]=[]),_0x71e548[_0x5460df(0x233)][_0x2724a2][_0x2532f0][_0x4448b6]['push'](_0x41720b[_0x5460df(0x248)]),!_0x71e548[_0x5460df(0x1e6)]['includes'](_0x4448b6)&&_0x71e548['name']['push'](_0x4448b6);}}}_0x4d93b4+=_0x5460df(0x345);for(let _0x481096=0x0;_0x481096<=_0x71e548[_0x5460df(0x1e6)]['length']-0x1;_0x481096++){const _0x3f5827=_0x71e548[_0x5460df(0x1e6)][_0x481096];_0x4d93b4+=_0x5460df(0x29e)+_0x3f5827+'</td>';var _0x4dd6cf=0x0,_0xde1e1b=0x0;for(let _0x3eef77=0x0;_0x3eef77<=_0x2b8bc4[_0x5460df(0x2ff)][_0x5460df(0x1de)]-0x1;_0x3eef77++){const _0x2cedeb=_0x2b8bc4['cat_brand'][_0x3eef77];var _0x287ee0=0x0;_0x71e548[_0x5460df(0x233)][_0x2cedeb[_0x5460df(0x294)][_0x5460df(0x325)]][_0x2cedeb[_0x5460df(0x294)]['category']][_0x3f5827]?(_0x287ee0=_0x71e548[_0x5460df(0x233)][_0x2cedeb['_id'][_0x5460df(0x325)]][_0x2cedeb[_0x5460df(0x294)][_0x5460df(0x1c5)]][_0x3f5827][0x0],_0x4d93b4+=_0x5460df(0x29e)+formatNumber(_0x287ee0['toFixed'](0x2))+'</td>'):(_0x287ee0=0x0,_0x4d93b4+=_0x5460df(0x29e)+_0x287ee0+_0x5460df(0x2c9)),_0x4dd6cf+=_0x287ee0;}_0x4d93b4+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x4dd6cf[_0x5460df(0x20e)](0x2))+_0x5460df(0x2c9);}return _0x4d93b4+=_0x5460df(0x350),_0x4d93b4;}router[a0_0x8d7790(0x2b4)](a0_0x8d7790(0x269),auth,async(_0x207752,_0x38930c)=>{const _0x1c18e2=a0_0x8d7790,{from_date:_0x106b24,to_date:_0x402f7d}=_0x207752[_0x1c18e2(0x21b)],_0x2cc077=await agentsdataCheck(_0x106b24,_0x402f7d);{}let _0x3cf6a2='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x90a4f5=new Date(_0x106b24),_0x475c29=new Date(_0x402f7d);const _0x22e1f0={'year':_0x1c18e2(0x2f4),'month':_0x1c18e2(0x242),'day':_0x1c18e2(0x2f4)},_0x9d5af2=new Intl[(_0x1c18e2(0x2a0))](_0x1c18e2(0x260),_0x22e1f0)[_0x1c18e2(0x314)](_0x90a4f5),_0x42704a=new Intl[(_0x1c18e2(0x2a0))](_0x1c18e2(0x260),_0x22e1f0)[_0x1c18e2(0x314)](_0x475c29);_0x3cf6a2+=_0x1c18e2(0x2de),_0x3cf6a2+='<p>SALES\x20REPORTS</p>',_0x3cf6a2+='<p>'+_0x9d5af2+_0x1c18e2(0x239)+_0x42704a+_0x1c18e2(0x31e),_0x3cf6a2+='<div\x20class=\x22row\x22>',_0x3cf6a2+='<div\x20class=\x22col-sm-11\x22>',_0x3cf6a2+=_0x1c18e2(0x330),_0x3cf6a2+=_0x2cc077,_0x3cf6a2+=_0x1c18e2(0x2c0),_0x3cf6a2+='</div>',_0x3cf6a2+=_0x1c18e2(0x285);const _0x72d81a={'format':'Letter','orientation':_0x1c18e2(0x2d2),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x1c18e2(0x26e)}}};pdf[_0x1c18e2(0x313)](_0x3cf6a2,_0x72d81a)[_0x1c18e2(0x2cb)](function(_0x588f01,_0xbaebc7){const _0xf6d160=_0x1c18e2;if(_0x588f01){_0x38930c[_0xf6d160(0x2fa)](0x1f4)[_0xf6d160(0x200)](_0xf6d160(0x211));return;}_0x38930c[_0xf6d160(0x2b3)](_0xf6d160(0x33a),_0xf6d160(0x2b6)),_0xbaebc7[_0xf6d160(0x32f)](_0x38930c);});}),router[a0_0x8d7790(0x2c6)]('/agent_reports/sales_ad',auth,async(_0x3a6ccb,_0x219b36)=>{const _0x51994f=a0_0x8d7790;try{const {username:_0x570026,email:_0x30a07a,role:_0x464c12}=_0x3a6ccb['user'],_0x4d0e87=_0x3a6ccb['user'],_0x324252=await profile[_0x51994f(0x28c)]({'email':_0x4d0e87['email']}),_0x3d6e24={'year':'numeric','month':'long','day':_0x51994f(0x2f4)},_0x1753cd=await master_shop['find'](),_0x458a42=await staff[_0x51994f(0x28c)]({'email':_0x4d0e87[_0x51994f(0x292)]}),_0x371095=await product[_0x51994f(0x293)](),_0x44c458=await warehouse[_0x51994f(0x2c1)]([{'$unwind':_0x51994f(0x25b)},{'$lookup':{'from':_0x51994f(0x289),'localField':_0x51994f(0x343),'foreignField':_0x51994f(0x1e6),'as':'product_docs'}},{'$unwind':_0x51994f(0x2ab)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x51994f(0x25c),'product_stock':{'$sum':'$product_stock'}}}]),_0x259c04=await staff[_0x51994f(0x293)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x1753cd[0x0][_0x51994f(0x361)]=='English\x20(US)')var _0x505cde=users[_0x51994f(0x332)];else{if(_0x1753cd[0x0][_0x51994f(0x361)]==_0x51994f(0x2d1))var _0x505cde=users[_0x51994f(0x2d1)];else{if(_0x1753cd[0x0][_0x51994f(0x361)]==_0x51994f(0x2db))var _0x505cde=users[_0x51994f(0x2db)];else{if(_0x1753cd[0x0]['language']==_0x51994f(0x324))var _0x505cde=users[_0x51994f(0x324)];else{if(_0x1753cd[0x0][_0x51994f(0x361)]=='French')var _0x505cde=users[_0x51994f(0x2fd)];else{if(_0x1753cd[0x0][_0x51994f(0x361)]=='Portuguese\x20(BR)')var _0x505cde=users[_0x51994f(0x273)];else{if(_0x1753cd[0x0][_0x51994f(0x361)]==_0x51994f(0x30b))var _0x505cde=users[_0x51994f(0x30b)];else{if(_0x1753cd[0x0]['language']==_0x51994f(0x1db))var _0x505cde=users[_0x51994f(0x1d6)];}}}}}}}_0x219b36['render'](_0x51994f(0x215),{'success':_0x3a6ccb[_0x51994f(0x32c)]('success'),'errors':_0x3a6ccb[_0x51994f(0x32c)]('errors'),'alldata':_0x371095,'profile':_0x324252,'master_shop':_0x1753cd,'role':_0x4d0e87,'product_stock':_0x44c458,'language':_0x505cde,'staff_arr':_0x458a42,'staff_data_all':_0x259c04});}catch(_0x416854){_0x219b36[_0x51994f(0x34a)](_0x416854);}});async function agentsdataDSICheck_admin(_0x34c411,_0x5e75e9,_0x4ffd1a,_0x502b05){const _0x51ac5f=a0_0x8d7790,_0x59a075=await product['aggregate']([{'$group':{'_id':{'brand':_0x51ac5f(0x217),'category':_0x51ac5f(0x268)},'products':{'$push':{'name':_0x51ac5f(0x1dc),'product_code':_0x51ac5f(0x2e9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x6b23dd=[];_0x6b23dd[_0x51ac5f(0x2ff)]=[];for(let _0x285e02=0x0;_0x285e02<=_0x59a075[_0x51ac5f(0x1de)]-0x1;_0x285e02++){const _0x30df67=_0x59a075[_0x285e02];_0x6b23dd[_0x51ac5f(0x2ff)]['push'](_0x30df67);}const _0x5cc7b3=await product[_0x51ac5f(0x2c1)]([{'$group':{'_id':{'category':_0x51ac5f(0x268)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x51ac5f(0x1dc)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4ffe29=await product[_0x51ac5f(0x2c1)]([{'$group':{'_id':{'category':_0x51ac5f(0x268),'brand':_0x51ac5f(0x217)}}},{'$group':{'_id':_0x51ac5f(0x259),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xb03a87=await sales_sa[_0x51ac5f(0x2c1)]([{'$match':{'date':{'$gte':_0x34c411,'$lte':_0x5e75e9},'sales_staff_id':_0x4ffd1a,'sale_product.isFG':_0x51ac5f(0x322)}},{'$unwind':_0x51ac5f(0x2b1)},{'$match':{'sale_product.isFG':_0x51ac5f(0x322)}},{'$lookup':{'from':_0x51ac5f(0x289),'localField':'sale_product.product_code','foreignField':_0x51ac5f(0x340),'as':_0x51ac5f(0x272)}},{'$unwind':_0x51ac5f(0x1c8)},{'$group':{'_id':{'dsi':_0x51ac5f(0x1e3),'date':_0x51ac5f(0x30f),'customer':_0x51ac5f(0x35e)},'totalQty':{'$sum':_0x51ac5f(0x1f1)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x51ac5f(0x30d),'discount':_0x51ac5f(0x31f),'adj_discount':_0x51ac5f(0x2be),'product_details':{'prod_name':_0x51ac5f(0x263),'product_code':_0x51ac5f(0x27b),'category':_0x51ac5f(0x2e3),'brand':_0x51ac5f(0x276),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x51ac5f(0x275),'date':_0x51ac5f(0x1da),'customer':_0x51ac5f(0x319),'category':'$products.product_details.category','brand':_0x51ac5f(0x326)},'totalQty':{'$sum':_0x51ac5f(0x29c)},'totalGross':{'$sum':{'$multiply':[_0x51ac5f(0x29c),_0x51ac5f(0x232)]}},'NetPrice':{'$sum':_0x51ac5f(0x208)},'discount':{'$sum':_0x51ac5f(0x2f5)},'adj_discount':{'$sum':_0x51ac5f(0x288)},'product_details':{'$first':_0x51ac5f(0x1ea)}}},{'$group':{'_id':{'dsi':_0x51ac5f(0x275),'date':'$_id.date','customer':_0x51ac5f(0x319)},'totalQty':{'$sum':_0x51ac5f(0x2ee)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x51ac5f(0x2f8)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x51ac5f(0x28b)},'products':{'$push':{'qty':_0x51ac5f(0x2ee),'category':_0x51ac5f(0x259),'brand':_0x51ac5f(0x2c3),'product_details':_0x51ac5f(0x25b)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x37c6ee=[],_0x105040={},_0xec5dac={},_0x3f6cf7={};var _0x1f95b0=0x0,_0x396cce=0x0,_0x56d6aa=0x0,_0x2e89a4=0x0,_0xbabdac=0x0;const _0x22c5f6=0x6;for(let _0x2f851c=0x0;_0x2f851c<=_0xb03a87['length']-0x1;_0x2f851c++){const _0x2b9ba3=_0xb03a87[_0x2f851c];let _0x13405e='<tr>';_0x13405e+=_0x51ac5f(0x1d3)+_0x2b9ba3[_0x51ac5f(0x294)][_0x51ac5f(0x24d)]+'</td>',_0x13405e+=_0x51ac5f(0x1d3)+_0x2b9ba3[_0x51ac5f(0x294)][_0x51ac5f(0x301)]+_0x51ac5f(0x2c9),_0x13405e+=_0x51ac5f(0x1d3)+_0x2b9ba3[_0x51ac5f(0x294)]['customer']+_0x51ac5f(0x2c9);let _0x1b0b2b={};var _0x36c968=0x0;for(let _0x5741fc=0x0;_0x5741fc<=_0x2b9ba3[_0x51ac5f(0x289)][_0x51ac5f(0x1de)]-0x1;_0x5741fc++){const _0x10a719=_0x2b9ba3['products'][_0x5741fc];_0x1b0b2b[_0x10a719[_0x51ac5f(0x325)]+'-'+_0x10a719['category']]=_0x10a719[_0x51ac5f(0x2f7)];const _0x2045e9=_0x10a719[_0x51ac5f(0x325)]+'-'+_0x10a719['category'];!_0x105040[_0x2045e9]&&(_0x105040[_0x2045e9]=0x0),!Array['isArray'](_0x3f6cf7[_0x2045e9])&&(_0x3f6cf7[_0x2045e9]=[]),!Array['isArray'](_0x3f6cf7[_0x2045e9])&&(_0x3f6cf7[_0x2045e9]=[]),_0x105040[_0x2045e9]+=_0x10a719['qty'],_0x3f6cf7[_0x2045e9]['push'](_0x10a719[_0x51ac5f(0x2f7)]),_0x36c968++;}console[_0x51ac5f(0x23e)](_0x2b9ba3);for(let _0x409eb7=0x0;_0x409eb7<=_0x6b23dd[_0x51ac5f(0x2ff)][_0x51ac5f(0x1de)]-0x1;_0x409eb7++){const _0x122bfe=_0x6b23dd['cat_brand'][_0x409eb7],_0x1e49c8=_0x122bfe[_0x51ac5f(0x294)][_0x51ac5f(0x325)]+'-'+_0x122bfe[_0x51ac5f(0x294)][_0x51ac5f(0x1c5)];_0x13405e+=_0x51ac5f(0x252)+(_0x1b0b2b[_0x1e49c8]!==undefined?_0x1b0b2b[_0x1e49c8][_0x51ac5f(0x20e)](0x2):'')+'</td>';}_0x56d6aa=_0x2b9ba3[_0x51ac5f(0x2d4)]+_0x2b9ba3['adj_discount'],_0x13405e+=_0x51ac5f(0x22d)+formatNumber(parseFloat(_0x2b9ba3['totalQty'],0x2)[_0x51ac5f(0x20e)](0x2))+_0x51ac5f(0x2c9),_0x13405e+=_0x51ac5f(0x22d)+formatNumber(_0x2b9ba3[_0x51ac5f(0x24b)][_0x51ac5f(0x20e)](0x2))+_0x51ac5f(0x2c9),_0x13405e+=_0x51ac5f(0x22d)+formatNumber(_0x56d6aa)+_0x51ac5f(0x2c9),_0x13405e+=_0x51ac5f(0x22d)+formatNumber(_0x2b9ba3[_0x51ac5f(0x35c)][_0x51ac5f(0x20e)](0x2))+'</td>',_0x13405e+=_0x51ac5f(0x350),_0x1f95b0+=parseFloat(_0x2b9ba3[_0x51ac5f(0x34e)][_0x51ac5f(0x20e)](0x2)),_0x396cce+=parseFloat(_0x2b9ba3[_0x51ac5f(0x35c)]['toFixed'](0x2)),_0x2e89a4+=_0x56d6aa,_0xbabdac+=parseFloat(_0x2b9ba3[_0x51ac5f(0x24b)][_0x51ac5f(0x20e)](0x2));if(_0x2f851c==_0xb03a87[_0x51ac5f(0x1de)]-0x1){_0x13405e+=_0x51ac5f(0x345),_0x13405e+=_0x51ac5f(0x349),_0x13405e+=_0x51ac5f(0x2c9);for(let _0x31e674=0x0;_0x31e674<=_0x6b23dd['cat_brand'][_0x51ac5f(0x1de)]-0x1;_0x31e674++){const _0x3a7cb3=_0x6b23dd[_0x51ac5f(0x2ff)][_0x31e674],_0x1465b7=_0x3a7cb3[_0x51ac5f(0x294)][_0x51ac5f(0x325)]+'-'+_0x3a7cb3[_0x51ac5f(0x294)][_0x51ac5f(0x1c5)];!_0x3f6cf7[_0x1465b7]&&(_0x3f6cf7[_0x1465b7]=[]);const _0x17c3ee=_0x3f6cf7[_0x1465b7][_0x51ac5f(0x334)]((_0x508dc7,_0x2e4293)=>_0x508dc7+_0x2e4293,0x0);console[_0x51ac5f(0x23e)](_0x51ac5f(0x2ef),_0x1465b7),_0x13405e+=_0x51ac5f(0x206)+(_0x17c3ee!==undefined?formatNumber(_0x17c3ee[_0x51ac5f(0x20e)](0x2)):'')+'</b></td>',console['log'](_0x3f6cf7[_0x1465b7][_0x51ac5f(0x334)]((_0x89c08c,_0x9c5eb)=>_0x89c08c+_0x9c5eb,0x0));}_0x13405e+=_0x51ac5f(0x1fd)+formatNumber(_0x1f95b0[_0x51ac5f(0x20e)](0x2))+_0x51ac5f(0x310),_0x13405e+=_0x51ac5f(0x1fd)+formatNumber(_0xbabdac)+_0x51ac5f(0x310),_0x13405e+=_0x51ac5f(0x1fd)+formatNumber(_0x2e89a4)+_0x51ac5f(0x310),_0x13405e+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x396cce)+_0x51ac5f(0x310),_0x13405e+=_0x51ac5f(0x350);}_0x37c6ee[_0x51ac5f(0x230)](_0x13405e);}function _0x8ad27a(_0x265576,_0x585794){const _0x123de7=_0x51ac5f,_0x58753a=[];for(let _0x1d6aad=0x0;_0x1d6aad<=_0x265576[_0x123de7(0x1de)]-0x1;_0x1d6aad+=_0x585794){_0x58753a['push'](_0x265576[_0x123de7(0x282)](_0x1d6aad,_0x1d6aad+_0x585794));}return _0x58753a;}const _0x506b0c=_0x8ad27a(_0x37c6ee,_0x22c5f6);let _0x48b5af='';return _0x506b0c[_0x51ac5f(0x22b)]((_0x2c7c32,_0x1d3fc2)=>{const _0x4de34a=_0x51ac5f;_0x1d3fc2>0x0&&(_0x48b5af+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x48b5af+='<table>',_0x48b5af+=_0x4de34a(0x307),_0x48b5af+=_0x4de34a(0x345),_0x48b5af+=_0x4de34a(0x1e5),_0x48b5af+=_0x4de34a(0x350),_0x48b5af+=_0x4de34a(0x345),_0x48b5af+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x5cba55=0x0;_0x5cba55<=_0x5cc7b3['length']-0x1;_0x5cba55++){const _0x53b605=_0x5cc7b3[_0x5cba55];for(let _0x139dd8=0x0;_0x139dd8<_0x4ffe29[_0x4de34a(0x1de)];_0x139dd8++){const _0x430867=_0x4ffe29[_0x139dd8];_0x430867[_0x4de34a(0x294)]===_0x53b605[_0x4de34a(0x294)][_0x4de34a(0x1c5)]&&(_0x48b5af+='<td\x20colspan=\x22'+_0x430867[_0x4de34a(0x2a7)]+_0x4de34a(0x34f)+_0x53b605[_0x4de34a(0x294)][_0x4de34a(0x1c5)]+_0x4de34a(0x2c9));}}_0x48b5af+=_0x4de34a(0x1f3),_0x48b5af+=_0x4de34a(0x350),_0x48b5af+=_0x4de34a(0x345),_0x48b5af+=_0x4de34a(0x355),_0x48b5af+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x48b5af+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x2ace2f=0x0;_0x2ace2f<=_0x5cc7b3[_0x4de34a(0x1de)]-0x1;_0x2ace2f++){const _0x223042=_0x5cc7b3[_0x2ace2f];for(let _0x427e7d=0x0;_0x427e7d<_0x6b23dd['cat_brand'][_0x4de34a(0x1de)];_0x427e7d++){const _0x4f010e=_0x6b23dd['cat_brand'][_0x427e7d];_0x4f010e[_0x4de34a(0x294)][_0x4de34a(0x1c5)]===_0x223042[_0x4de34a(0x294)][_0x4de34a(0x1c5)]&&(_0x48b5af+=_0x4de34a(0x32e)+_0x4f010e[_0x4de34a(0x294)][_0x4de34a(0x325)]+'</td>');}}_0x48b5af+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x48b5af+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x48b5af+=_0x4de34a(0x220),_0x48b5af+=_0x4de34a(0x2e7),_0x48b5af+=_0x4de34a(0x350),_0x48b5af+=_0x4de34a(0x26c),_0x48b5af+='<tbody>',_0x2c7c32[_0x4de34a(0x22b)](_0xb3375=>{_0x48b5af+=_0xb3375;}),console['log'](_0x3f6cf7),_0x48b5af+=_0x4de34a(0x291),_0x48b5af+='</table>';}),_0x48b5af;}async function agentsdataDSICheck_admin_excel(_0x55966b,_0xac64ae,_0x1dbb49,_0x3d16d3){const _0x3623a9=a0_0x8d7790,_0x3a6573=await product[_0x3623a9(0x2c1)]([{'$group':{'_id':{'brand':_0x3623a9(0x217),'category':_0x3623a9(0x268)},'products':{'$push':{'name':_0x3623a9(0x1dc),'product_code':_0x3623a9(0x2e9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2c119d=[];_0x2c119d[_0x3623a9(0x2ff)]=[];for(let _0x355b69=0x0;_0x355b69<=_0x3a6573[_0x3623a9(0x1de)]-0x1;_0x355b69++){const _0x2d7b0a=_0x3a6573[_0x355b69];_0x2c119d[_0x3623a9(0x2ff)][_0x3623a9(0x230)](_0x2d7b0a);}const _0x49f72a=await product[_0x3623a9(0x2c1)]([{'$group':{'_id':{'category':_0x3623a9(0x268)},'products':{'$push':{'brand':'$brand','product_code':_0x3623a9(0x2e9),'product_name':_0x3623a9(0x1dc)}}}},{'$sort':{'_id.category':-0x1}}]),_0x238ef6=await product[_0x3623a9(0x2c1)]([{'$group':{'_id':{'category':'$category','brand':_0x3623a9(0x217)}}},{'$group':{'_id':_0x3623a9(0x259),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1ee34b=await sales_sa[_0x3623a9(0x2c1)]([{'$match':{'date':{'$gte':_0x55966b,'$lte':_0xac64ae},'sales_staff_id':_0x1dbb49,'sale_product.isFG':_0x3623a9(0x322)}},{'$unwind':_0x3623a9(0x2b1)},{'$match':{'sale_product.isFG':_0x3623a9(0x322)}},{'$lookup':{'from':_0x3623a9(0x289),'localField':_0x3623a9(0x2c7),'foreignField':_0x3623a9(0x340),'as':_0x3623a9(0x272)}},{'$unwind':_0x3623a9(0x1c8)},{'$group':{'_id':{'dsi':_0x3623a9(0x1e3),'date':'$date','customer':_0x3623a9(0x35e)},'totalQty':{'$sum':_0x3623a9(0x1f1)},'products':{'$push':{'qty':_0x3623a9(0x1f1),'NetPrice':_0x3623a9(0x30d),'discount':_0x3623a9(0x31f),'adj_discount':_0x3623a9(0x2be),'product_details':{'prod_name':_0x3623a9(0x263),'product_code':_0x3623a9(0x27b),'category':_0x3623a9(0x2e3),'brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x3623a9(0x213)},{'$group':{'_id':{'dsi':_0x3623a9(0x275),'date':_0x3623a9(0x1da),'customer':_0x3623a9(0x319),'category':_0x3623a9(0x29b),'brand':_0x3623a9(0x326)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x3623a9(0x29c),_0x3623a9(0x232)]}},'NetPrice':{'$sum':_0x3623a9(0x208)},'discount':{'$sum':_0x3623a9(0x2f5)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x3623a9(0x1ea)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3623a9(0x1da),'customer':_0x3623a9(0x319)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x3623a9(0x23b)},'NetPrice':{'$sum':_0x3623a9(0x2f8)},'discount':{'$sum':_0x3623a9(0x26a)},'adj_discount':{'$sum':_0x3623a9(0x28b)},'products':{'$push':{'qty':_0x3623a9(0x2ee),'category':'$_id.category','brand':_0x3623a9(0x2c3),'product_details':_0x3623a9(0x25b)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x1b23e8=[],_0x45c466={},_0x2b5f95={},_0x414eba={};var _0x31e984=0x0,_0x2f7a22=0x0,_0x2a9711=0x0,_0x26bd68=0x0,_0xce8461=0x0;const _0x4fd28d=0x16345785d8a0000;for(let _0x50e5b8=0x0;_0x50e5b8<=_0x1ee34b[_0x3623a9(0x1de)]-0x1;_0x50e5b8++){const _0x14f1d4=_0x1ee34b[_0x50e5b8];let _0x2cb3b3=_0x3623a9(0x345);_0x2cb3b3+=_0x3623a9(0x1d3)+_0x14f1d4['_id'][_0x3623a9(0x24d)]+_0x3623a9(0x2c9),_0x2cb3b3+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x14f1d4['_id']['date']+_0x3623a9(0x2c9),_0x2cb3b3+=_0x3623a9(0x1d3)+_0x14f1d4['_id']['customer']+'</td>';let _0x48c3d9={};var _0x3767d6=0x0;for(let _0x543200=0x0;_0x543200<=_0x14f1d4['products'][_0x3623a9(0x1de)]-0x1;_0x543200++){const _0x5f1bde=_0x14f1d4[_0x3623a9(0x289)][_0x543200];_0x48c3d9[_0x5f1bde[_0x3623a9(0x325)]+'-'+_0x5f1bde[_0x3623a9(0x1c5)]]=_0x5f1bde['qty'];const _0x3341eb=_0x5f1bde['brand']+'-'+_0x5f1bde['category'];!_0x45c466[_0x3341eb]&&(_0x45c466[_0x3341eb]=0x0),!Array[_0x3623a9(0x329)](_0x414eba[_0x3341eb])&&(_0x414eba[_0x3341eb]=[]),!Array[_0x3623a9(0x329)](_0x414eba[_0x3341eb])&&(_0x414eba[_0x3341eb]=[]),_0x45c466[_0x3341eb]+=_0x5f1bde[_0x3623a9(0x2f7)],_0x414eba[_0x3341eb][_0x3623a9(0x230)](_0x5f1bde[_0x3623a9(0x2f7)]),_0x3767d6++;}console['log'](_0x14f1d4);for(let _0x2073cf=0x0;_0x2073cf<=_0x2c119d['cat_brand'][_0x3623a9(0x1de)]-0x1;_0x2073cf++){const _0x234c6e=_0x2c119d[_0x3623a9(0x2ff)][_0x2073cf],_0xd412e9=_0x234c6e['_id'][_0x3623a9(0x325)]+'-'+_0x234c6e[_0x3623a9(0x294)]['category'];_0x2cb3b3+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x48c3d9[_0xd412e9]!==undefined?_0x48c3d9[_0xd412e9][_0x3623a9(0x20e)](0x2):'')+_0x3623a9(0x2c9);}_0x2a9711=_0x14f1d4[_0x3623a9(0x2d4)]+_0x14f1d4['adj_discount'],_0x2cb3b3+=_0x3623a9(0x22d)+formatNumber(parseFloat(_0x14f1d4[_0x3623a9(0x34e)],0x2)[_0x3623a9(0x20e)](0x2))+_0x3623a9(0x2c9),_0x2cb3b3+=_0x3623a9(0x22d)+formatNumber(_0x14f1d4[_0x3623a9(0x24b)]['toFixed'](0x2))+_0x3623a9(0x2c9),_0x2cb3b3+=_0x3623a9(0x22d)+formatNumber(_0x2a9711)+'</td>',_0x2cb3b3+=_0x3623a9(0x22d)+formatNumber(_0x14f1d4['NetPrice'][_0x3623a9(0x20e)](0x2))+_0x3623a9(0x2c9),_0x2cb3b3+='</tr>',_0x31e984+=parseFloat(_0x14f1d4[_0x3623a9(0x34e)][_0x3623a9(0x20e)](0x2)),_0x2f7a22+=parseFloat(_0x14f1d4[_0x3623a9(0x35c)][_0x3623a9(0x20e)](0x2)),_0x26bd68+=_0x2a9711,_0xce8461+=parseFloat(_0x14f1d4['totalGross'][_0x3623a9(0x20e)](0x2));if(_0x50e5b8==_0x1ee34b[_0x3623a9(0x1de)]-0x1){_0x2cb3b3+=_0x3623a9(0x345),_0x2cb3b3+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x2cb3b3+='</td>';for(let _0x4df391=0x0;_0x4df391<=_0x2c119d[_0x3623a9(0x2ff)][_0x3623a9(0x1de)]-0x1;_0x4df391++){const _0x1750e8=_0x2c119d['cat_brand'][_0x4df391],_0x18ee3c=_0x1750e8['_id'][_0x3623a9(0x325)]+'-'+_0x1750e8[_0x3623a9(0x294)][_0x3623a9(0x1c5)];!_0x414eba[_0x18ee3c]&&(_0x414eba[_0x18ee3c]=[]);const _0x40482f=_0x414eba[_0x18ee3c]['reduce']((_0x3fe024,_0x4646f4)=>_0x3fe024+_0x4646f4,0x0);console[_0x3623a9(0x23e)](_0x3623a9(0x2ef),_0x18ee3c),_0x2cb3b3+=_0x3623a9(0x206)+(_0x40482f!==undefined?formatNumber(_0x40482f['toFixed'](0x2)):'')+_0x3623a9(0x310),console[_0x3623a9(0x23e)](_0x414eba[_0x18ee3c]['reduce']((_0x2c185e,_0x33697d)=>_0x2c185e+_0x33697d,0x0));}_0x2cb3b3+=_0x3623a9(0x1fd)+formatNumber(_0x31e984[_0x3623a9(0x20e)](0x2))+_0x3623a9(0x310),_0x2cb3b3+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xce8461)+_0x3623a9(0x310),_0x2cb3b3+=_0x3623a9(0x1fd)+formatNumber(_0x26bd68)+_0x3623a9(0x310),_0x2cb3b3+=_0x3623a9(0x1fd)+formatNumber(_0x2f7a22)+'</b></td>',_0x2cb3b3+='</tr>';}_0x1b23e8['push'](_0x2cb3b3);}function _0x459a5b(_0x593f52,_0x119ea6){const _0x1dcabe=[];for(let _0x3daa50=0x0;_0x3daa50<=_0x593f52['length']-0x1;_0x3daa50+=_0x119ea6){_0x1dcabe['push'](_0x593f52['slice'](_0x3daa50,_0x3daa50+_0x119ea6));}return _0x1dcabe;}const _0x2b3d5f=_0x459a5b(_0x1b23e8,_0x4fd28d);let _0x1f504c='';return _0x2b3d5f['forEach']((_0x499c07,_0x435d13)=>{const _0x16581a=_0x3623a9;_0x435d13>0x0&&(_0x1f504c+=_0x16581a(0x1df));_0x1f504c+=_0x16581a(0x330),_0x1f504c+=_0x16581a(0x307),_0x1f504c+=_0x16581a(0x345),_0x1f504c+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x1f504c+=_0x16581a(0x350),_0x1f504c+=_0x16581a(0x345),_0x1f504c+=_0x16581a(0x23f);for(let _0x2fab77=0x0;_0x2fab77<=_0x49f72a[_0x16581a(0x1de)]-0x1;_0x2fab77++){const _0x55e46a=_0x49f72a[_0x2fab77];for(let _0x21d05b=0x0;_0x21d05b<_0x238ef6[_0x16581a(0x1de)];_0x21d05b++){const _0x4bf9cf=_0x238ef6[_0x21d05b];_0x4bf9cf[_0x16581a(0x294)]===_0x55e46a['_id'][_0x16581a(0x1c5)]&&(_0x1f504c+='<td\x20colspan=\x22'+_0x4bf9cf[_0x16581a(0x2a7)]+_0x16581a(0x34f)+_0x55e46a['_id'][_0x16581a(0x1c5)]+'</td>');}}_0x1f504c+=_0x16581a(0x1f3),_0x1f504c+=_0x16581a(0x350),_0x1f504c+=_0x16581a(0x345),_0x1f504c+=_0x16581a(0x355),_0x1f504c+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x1f504c+=_0x16581a(0x2e5);for(let _0x4dff1e=0x0;_0x4dff1e<=_0x49f72a[_0x16581a(0x1de)]-0x1;_0x4dff1e++){const _0x2578e4=_0x49f72a[_0x4dff1e];for(let _0x59a9d8=0x0;_0x59a9d8<_0x2c119d[_0x16581a(0x2ff)][_0x16581a(0x1de)];_0x59a9d8++){const _0x4a3242=_0x2c119d[_0x16581a(0x2ff)][_0x59a9d8];_0x4a3242[_0x16581a(0x294)]['category']===_0x2578e4[_0x16581a(0x294)][_0x16581a(0x1c5)]&&(_0x1f504c+=_0x16581a(0x32e)+_0x4a3242[_0x16581a(0x294)][_0x16581a(0x325)]+_0x16581a(0x2c9));}}_0x1f504c+=_0x16581a(0x2b2),_0x1f504c+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x1f504c+=_0x16581a(0x220),_0x1f504c+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x1f504c+=_0x16581a(0x350),_0x1f504c+='</thead>',_0x1f504c+=_0x16581a(0x21a),_0x499c07[_0x16581a(0x22b)](_0x3990d1=>{_0x1f504c+=_0x3990d1;}),console[_0x16581a(0x23e)](_0x414eba),_0x1f504c+=_0x16581a(0x291),_0x1f504c+='</table>';}),_0x1f504c;}router['post']('/agent_reports/pdf_admin',auth,async(_0x5b94a0,_0x535ae1)=>{const _0x2433fb=a0_0x8d7790,{from_date:_0x3b98ad,to_date:_0x778744,isExcel:_0x21c531,agent_id:_0x4630aa}=_0x5b94a0[_0x2433fb(0x21b)],_0x3a266a=_0x5b94a0[_0x2433fb(0x1c9)],_0x1ba1a7=await staff['findOne']({'email':_0x3a266a[_0x2433fb(0x292)]}),_0x4526d3=await master_shop[_0x2433fb(0x293)](),_0x146e9a=await agentsdataDSICheck_admin(_0x3b98ad,_0x778744,_0x4630aa,_0x21c531),_0x72806f=await agentsdataDSICheck_admin_excel(_0x3b98ad,_0x778744,_0x4630aa,_0x21c531);let _0x2a0c73='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x5c01b4=new Date(_0x3b98ad),_0x4e4381=new Date(_0x778744);const _0x16603c={'year':_0x2433fb(0x2f4),'month':_0x2433fb(0x242),'day':_0x2433fb(0x2f4)},_0x592c88=new Intl[(_0x2433fb(0x2a0))]('en-US',_0x16603c)[_0x2433fb(0x314)](_0x5c01b4),_0x1f4c32=new Intl['DateTimeFormat']('en-US',_0x16603c)['format'](_0x4e4381);_0x2a0c73+=_0x2433fb(0x2a5),_0x2a0c73+='<div\x20\x20id=\x22table-conatainer\x22>',_0x2a0c73+='<table>',_0x2a0c73+=_0x146e9a,_0x2a0c73+=_0x2433fb(0x2c0),_0x2a0c73+=_0x2433fb(0x285),_0x2a0c73+='</div>';let _0x52ea63='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x52ea63+=_0x2433fb(0x2a5),_0x52ea63+=_0x2433fb(0x320),_0x52ea63+='<table>',_0x52ea63+=_0x72806f,_0x52ea63+=_0x2433fb(0x2c0),_0x52ea63+='</div>',_0x52ea63+='</div>';let _0x1db2f9='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x5cbd7d={'width':_0x2433fb(0x24c),'height':_0x2433fb(0x20c),'orientation':_0x2433fb(0x2d2),'border':{'top':_0x2433fb(0x201),'right':_0x2433fb(0x201),'bottom':_0x2433fb(0x201),'left':_0x2433fb(0x201)},'header':{'height':_0x2433fb(0x1d5),'contents':_0x2433fb(0x351)+_0x1db2f9+_0x2433fb(0x2b0)+_0x592c88+_0x2433fb(0x239)+_0x1f4c32+_0x2433fb(0x2ec)},'footer':{'height':_0x2433fb(0x238),'contents':{'default':_0x2433fb(0x302)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x2433fb(0x26e)}}};if(_0x21c531=='on'){const _0x18b1b9=cheerio['load'](_0x52ea63);let _0x198f41=[],_0x196c51=[],_0x5a7d48=[];_0x18b1b9('table\x20tr')[_0x2433fb(0x207)]((_0x470076,_0x207aa5)=>{const _0x373391=_0x2433fb;let _0x24f3c5=[],_0x44be53=0x0;while(_0x5a7d48[_0x44be53]){_0x5a7d48[_0x44be53]--,_0x44be53++;}_0x18b1b9(_0x207aa5)[_0x373391(0x293)](_0x373391(0x234))['each']((_0x3a58ee,_0x2c2b0b)=>{const _0x13d1de=_0x373391;let _0x370bca=_0x18b1b9(_0x2c2b0b)[_0x13d1de(0x2bd)]()['trim'](),_0x3c29d1=parseFloat(_0x370bca['replace'](/,/g,''));isNaN(_0x3c29d1)&&(_0x3c29d1=_0x370bca);let _0x37c04a=parseInt(_0x18b1b9(_0x2c2b0b)[_0x13d1de(0x32b)](_0x13d1de(0x358)))||0x1,_0x582311=parseInt(_0x18b1b9(_0x2c2b0b)['attr'](_0x13d1de(0x33b)))||0x1;_0x24f3c5[_0x44be53]=_0x3c29d1;(_0x37c04a>0x1||_0x582311>0x1)&&_0x196c51[_0x13d1de(0x230)]({'s':{'r':_0x470076,'c':_0x44be53},'e':{'r':_0x470076+_0x582311-0x1,'c':_0x44be53+_0x37c04a-0x1}});for(let _0x103999=0x0;_0x103999<_0x37c04a;_0x103999++){_0x582311>0x1&&(_0x5a7d48[_0x44be53+_0x103999]=_0x582311-0x1);}_0x44be53+=_0x37c04a;}),_0x198f41[_0x373391(0x230)](_0x24f3c5);});const _0x2125f1=XLSX[_0x2433fb(0x1fe)][_0x2433fb(0x267)](),_0x5aeac7=XLSX[_0x2433fb(0x1fe)]['aoa_to_sheet'](_0x198f41);_0x196c51[_0x2433fb(0x1de)]>0x0&&(_0x5aeac7[_0x2433fb(0x2d8)]=_0x196c51);_0x5aeac7[_0x2433fb(0x2f0)]=_0x198f41[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x2433fb(0x1fe)][_0x2433fb(0x1ce)](_0x2125f1,_0x5aeac7,'Sales\x20Report');const _0x328757=XLSX[_0x2433fb(0x214)](_0x2125f1,{'bookType':_0x2433fb(0x23a),'type':_0x2433fb(0x352)});_0x535ae1[_0x2433fb(0x2b3)](_0x2433fb(0x30e),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x535ae1[_0x2433fb(0x2b3)]('Content-Type',_0x2433fb(0x271)),_0x535ae1[_0x2433fb(0x200)](_0x328757);}else pdf[_0x2433fb(0x313)](_0x2a0c73,_0x5cbd7d)[_0x2433fb(0x2cb)](function(_0x158fad,_0x3154be){const _0xdd54be=_0x2433fb;if(_0x158fad){_0x535ae1[_0xdd54be(0x2fa)](0x1f4)['send'](_0xdd54be(0x211));return;}_0x535ae1[_0xdd54be(0x2b3)](_0xdd54be(0x33a),_0xdd54be(0x2b6)),_0x3154be[_0xdd54be(0x32f)](_0x535ae1);});}),router[a0_0x8d7790(0x2c6)](a0_0x8d7790(0x1e0),auth,async(_0x5cb5d8,_0x27bc97)=>{const _0x318efd=a0_0x8d7790;try{const {username:_0x1d5aad,email:_0x2171a9,role:_0x367edb}=_0x5cb5d8[_0x318efd(0x1c9)],_0x16275a=_0x5cb5d8[_0x318efd(0x1c9)],_0x17a97=await profile[_0x318efd(0x28c)]({'email':_0x16275a['email']}),_0x383714={'year':_0x318efd(0x2f4),'month':_0x318efd(0x242),'day':_0x318efd(0x2f4)},_0x235adb=await master_shop[_0x318efd(0x293)](),_0x47c86c=await staff[_0x318efd(0x28c)]({'email':_0x16275a['email']}),_0x57d95d=await product[_0x318efd(0x293)](),_0x224a1c=await warehouse[_0x318efd(0x2c1)]([{'$unwind':_0x318efd(0x25b)},{'$lookup':{'from':'products','localField':_0x318efd(0x343),'foreignField':'name','as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x318efd(0x258),'product_stock':_0x318efd(0x2e4)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);if(_0x235adb[0x0][_0x318efd(0x361)]==_0x318efd(0x212))var _0x5a8ed8=users[_0x318efd(0x332)];else{if(_0x235adb[0x0][_0x318efd(0x361)]==_0x318efd(0x2d1))var _0x5a8ed8=users[_0x318efd(0x2d1)];else{if(_0x235adb[0x0][_0x318efd(0x361)]=='German')var _0x5a8ed8=users['German'];else{if(_0x235adb[0x0]['language']==_0x318efd(0x324))var _0x5a8ed8=users[_0x318efd(0x324)];else{if(_0x235adb[0x0][_0x318efd(0x361)]=='French')var _0x5a8ed8=users[_0x318efd(0x2fd)];else{if(_0x235adb[0x0]['language']==_0x318efd(0x209))var _0x5a8ed8=users[_0x318efd(0x273)];else{if(_0x235adb[0x0][_0x318efd(0x361)]==_0x318efd(0x30b))var _0x5a8ed8=users[_0x318efd(0x30b)];else{if(_0x235adb[0x0][_0x318efd(0x361)]==_0x318efd(0x1db))var _0x5a8ed8=users[_0x318efd(0x1d6)];}}}}}}}_0x27bc97[_0x318efd(0x29d)]('dsi_sales',{'success':_0x5cb5d8[_0x318efd(0x32c)]('success'),'errors':_0x5cb5d8[_0x318efd(0x32c)](_0x318efd(0x256)),'alldata':_0x57d95d,'profile':_0x17a97,'master_shop':_0x235adb,'role':_0x16275a,'product_stock':_0x224a1c,'language':_0x5a8ed8,'staff_arr':_0x47c86c});}catch(_0x35a08a){}});function formatNumber(_0x184847,_0x2b8e85=a0_0x8d7790(0x260),_0xd00d5f={'minimumFractionDigits':0x2}){const _0x32b0a5=a0_0x8d7790,_0x5cd22f=new Intl[(_0x32b0a5(0x2d9))](_0x2b8e85,_0xd00d5f);return _0x5cd22f[_0x32b0a5(0x314)](_0x184847);}async function agentsdataDSICheck(_0x35b600,_0xf1924b,_0x5529c5,_0x5ced14){const _0x15231f=a0_0x8d7790,_0x5c4b0b=await product[_0x15231f(0x2c1)]([{'$group':{'_id':{'brand':_0x15231f(0x217),'category':_0x15231f(0x268)},'products':{'$push':{'name':_0x15231f(0x1dc),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x49c9c1=[];_0x49c9c1[_0x15231f(0x2ff)]=[];for(let _0x44c075=0x0;_0x44c075<=_0x5c4b0b[_0x15231f(0x1de)]-0x1;_0x44c075++){const _0x579078=_0x5c4b0b[_0x44c075];_0x49c9c1[_0x15231f(0x2ff)][_0x15231f(0x230)](_0x579078);}const _0x3dd96e=await product[_0x15231f(0x2c1)]([{'$group':{'_id':{'category':_0x15231f(0x268)},'products':{'$push':{'brand':_0x15231f(0x217),'product_code':_0x15231f(0x2e9),'product_name':_0x15231f(0x1dc)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5bba6=await product['aggregate']([{'$group':{'_id':{'category':_0x15231f(0x268),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x44328c=await sales_sa[_0x15231f(0x2c1)]([{'$match':{'date':{'$gte':_0x35b600,'$lte':_0xf1924b},'sales_staff_id':_0x5529c5,'sale_product.isFG':_0x15231f(0x322),'status_data':_0x15231f(0x322)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x15231f(0x2c7),'foreignField':'product_code','as':_0x15231f(0x272)}},{'$unwind':_0x15231f(0x1c8)},{'$group':{'_id':{'dsi':_0x15231f(0x1e3),'date':_0x15231f(0x30f),'customer':'$customer'},'totalQty':{'$sum':_0x15231f(0x1f1)},'products':{'$push':{'qty':_0x15231f(0x1f1),'NetPrice':_0x15231f(0x30d),'discount':_0x15231f(0x31f),'adj_discount':_0x15231f(0x2be),'product_details':{'prod_name':'$product_info.name','product_code':_0x15231f(0x27b),'category':_0x15231f(0x2e3),'brand':_0x15231f(0x276),'gross_price':_0x15231f(0x2ce)}}}}},{'$unwind':_0x15231f(0x213)},{'$group':{'_id':{'dsi':_0x15231f(0x275),'date':_0x15231f(0x1da),'customer':_0x15231f(0x319),'category':_0x15231f(0x29b),'brand':_0x15231f(0x326)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x15231f(0x232)]}},'NetPrice':{'$sum':_0x15231f(0x208)},'discount':{'$sum':_0x15231f(0x2f5)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x15231f(0x1ea)}}},{'$group':{'_id':{'dsi':_0x15231f(0x275),'date':_0x15231f(0x1da),'customer':_0x15231f(0x319)},'totalQty':{'$sum':_0x15231f(0x2ee)},'totalGross':{'$sum':_0x15231f(0x23b)},'NetPrice':{'$sum':_0x15231f(0x2f8)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x15231f(0x28b)},'products':{'$push':{'qty':_0x15231f(0x2ee),'category':_0x15231f(0x259),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x398880=[],_0x48f4ba={},_0x1067f6={},_0xdbfd74={};var _0x2a2614=0x0,_0x5179a2=0x0,_0x112b24=0x0,_0xff2f41=0x0,_0x118651=0x0;const _0x4ab1d4=0x6;for(let _0x2aca96=0x0;_0x2aca96<=_0x44328c[_0x15231f(0x1de)]-0x1;_0x2aca96++){const _0xcb5016=_0x44328c[_0x2aca96];let _0x14f6ec='<tr>';_0x14f6ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xcb5016[_0x15231f(0x294)]['dsi']+_0x15231f(0x2c9),_0x14f6ec+=_0x15231f(0x1d3)+_0xcb5016[_0x15231f(0x294)][_0x15231f(0x301)]+_0x15231f(0x2c9),_0x14f6ec+=_0x15231f(0x1d3)+_0xcb5016[_0x15231f(0x294)]['customer']+_0x15231f(0x2c9);let _0x316822={};var _0x57138d=0x0;for(let _0x2aee60=0x0;_0x2aee60<=_0xcb5016[_0x15231f(0x289)][_0x15231f(0x1de)]-0x1;_0x2aee60++){const _0x5240e2=_0xcb5016[_0x15231f(0x289)][_0x2aee60];_0x316822[_0x5240e2[_0x15231f(0x325)]+'-'+_0x5240e2[_0x15231f(0x1c5)]]=_0x5240e2['qty'];const _0x47079a=_0x5240e2[_0x15231f(0x325)]+'-'+_0x5240e2[_0x15231f(0x1c5)];!_0x48f4ba[_0x47079a]&&(_0x48f4ba[_0x47079a]=0x0),!Array[_0x15231f(0x329)](_0xdbfd74[_0x47079a])&&(_0xdbfd74[_0x47079a]=[]),!Array[_0x15231f(0x329)](_0xdbfd74[_0x47079a])&&(_0xdbfd74[_0x47079a]=[]),_0x48f4ba[_0x47079a]+=_0x5240e2[_0x15231f(0x2f7)],_0xdbfd74[_0x47079a][_0x15231f(0x230)](_0x5240e2[_0x15231f(0x2f7)]),_0x57138d++;}console['log'](_0xcb5016);for(let _0x464cbe=0x0;_0x464cbe<=_0x49c9c1[_0x15231f(0x2ff)][_0x15231f(0x1de)]-0x1;_0x464cbe++){const _0x4e9103=_0x49c9c1[_0x15231f(0x2ff)][_0x464cbe],_0x2e336e=_0x4e9103[_0x15231f(0x294)]['brand']+'-'+_0x4e9103[_0x15231f(0x294)][_0x15231f(0x1c5)];_0x14f6ec+=_0x15231f(0x252)+(_0x316822[_0x2e336e]!==undefined?_0x316822[_0x2e336e]['toFixed'](0x2):'')+_0x15231f(0x2c9);}_0x112b24=_0xcb5016[_0x15231f(0x2d4)]+_0xcb5016['adj_discount'],_0x14f6ec+=_0x15231f(0x22d)+formatNumber(parseFloat(_0xcb5016[_0x15231f(0x34e)],0x2)[_0x15231f(0x20e)](0x2))+_0x15231f(0x2c9),_0x14f6ec+=_0x15231f(0x22d)+formatNumber(_0xcb5016[_0x15231f(0x24b)][_0x15231f(0x20e)](0x2))+'</td>',_0x14f6ec+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x112b24)+'</td>',_0x14f6ec+=_0x15231f(0x22d)+formatNumber(_0xcb5016[_0x15231f(0x35c)][_0x15231f(0x20e)](0x2))+_0x15231f(0x2c9),_0x14f6ec+=_0x15231f(0x350),_0x2a2614+=parseFloat(_0xcb5016[_0x15231f(0x34e)][_0x15231f(0x20e)](0x2)),_0x5179a2+=parseFloat(_0xcb5016['NetPrice'][_0x15231f(0x20e)](0x2)),_0xff2f41+=_0x112b24,_0x118651+=parseFloat(_0xcb5016[_0x15231f(0x24b)]['toFixed'](0x2));if(_0x2aca96==_0x44328c[_0x15231f(0x1de)]-0x1){_0x14f6ec+='<tr>',_0x14f6ec+=_0x15231f(0x349),_0x14f6ec+=_0x15231f(0x2c9);for(let _0x4dbb93=0x0;_0x4dbb93<=_0x49c9c1[_0x15231f(0x2ff)][_0x15231f(0x1de)]-0x1;_0x4dbb93++){const _0x3073c8=_0x49c9c1['cat_brand'][_0x4dbb93],_0x376310=_0x3073c8[_0x15231f(0x294)]['brand']+'-'+_0x3073c8[_0x15231f(0x294)][_0x15231f(0x1c5)];!_0xdbfd74[_0x376310]&&(_0xdbfd74[_0x376310]=[]);const _0x261599=_0xdbfd74[_0x376310][_0x15231f(0x334)]((_0x82d9cc,_0x125ea5)=>_0x82d9cc+_0x125ea5,0x0);_0x14f6ec+=_0x15231f(0x206)+(_0x261599!==undefined?formatNumber(_0x261599[_0x15231f(0x20e)](0x2)):'')+_0x15231f(0x310),console['log'](_0xdbfd74[_0x376310][_0x15231f(0x334)]((_0x575ba8,_0x183d03)=>_0x575ba8+_0x183d03,0x0));}_0x14f6ec+=_0x15231f(0x1fd)+formatNumber(_0x2a2614)+_0x15231f(0x310),_0x14f6ec+=_0x15231f(0x1fd)+formatNumber(_0x118651)+_0x15231f(0x310),_0x14f6ec+=_0x15231f(0x1fd)+formatNumber(_0xff2f41)+_0x15231f(0x310),_0x14f6ec+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5179a2)+_0x15231f(0x310),_0x14f6ec+=_0x15231f(0x350);}_0x398880[_0x15231f(0x230)](_0x14f6ec);}function _0x1b053f(_0x14ef6d,_0x1e2f7f){const _0x38e42a=_0x15231f,_0x3557c3=[];for(let _0x3ddb2d=0x0;_0x3ddb2d<=_0x14ef6d['length']-0x1;_0x3ddb2d+=_0x1e2f7f){_0x3557c3['push'](_0x14ef6d[_0x38e42a(0x282)](_0x3ddb2d,_0x3ddb2d+_0x1e2f7f));}return _0x3557c3;}const _0x4f33c8=_0x1b053f(_0x398880,_0x4ab1d4);let _0x2acb01='';return _0x4f33c8['forEach']((_0x3e8dc9,_0x381440)=>{const _0x33b7ba=_0x15231f;_0x381440>0x0&&(_0x2acb01+=_0x33b7ba(0x1df));_0x2acb01+='<table>',_0x2acb01+=_0x33b7ba(0x307),_0x2acb01+='<tr>',_0x2acb01+=_0x33b7ba(0x1e5),_0x2acb01+='</tr>',_0x2acb01+=_0x33b7ba(0x345),_0x2acb01+=_0x33b7ba(0x23f);for(let _0xbe1e50=0x0;_0xbe1e50<=_0x3dd96e[_0x33b7ba(0x1de)]-0x1;_0xbe1e50++){const _0x578d27=_0x3dd96e[_0xbe1e50];for(let _0x99a05f=0x0;_0x99a05f<_0x5bba6[_0x33b7ba(0x1de)];_0x99a05f++){const _0x35566=_0x5bba6[_0x99a05f];_0x35566[_0x33b7ba(0x294)]===_0x578d27[_0x33b7ba(0x294)]['category']&&(_0x2acb01+=_0x33b7ba(0x253)+_0x35566[_0x33b7ba(0x2a7)]+_0x33b7ba(0x34f)+_0x578d27['_id'][_0x33b7ba(0x1c5)]+_0x33b7ba(0x2c9));}}_0x2acb01+=_0x33b7ba(0x1f3),_0x2acb01+=_0x33b7ba(0x350),_0x2acb01+=_0x33b7ba(0x345),_0x2acb01+=_0x33b7ba(0x355),_0x2acb01+=_0x33b7ba(0x2ed),_0x2acb01+=_0x33b7ba(0x2e5);for(let _0x2c4b1c=0x0;_0x2c4b1c<=_0x3dd96e[_0x33b7ba(0x1de)]-0x1;_0x2c4b1c++){const _0xe862f=_0x3dd96e[_0x2c4b1c];for(let _0x303dc0=0x0;_0x303dc0<_0x49c9c1[_0x33b7ba(0x2ff)][_0x33b7ba(0x1de)];_0x303dc0++){const _0x489257=_0x49c9c1[_0x33b7ba(0x2ff)][_0x303dc0];_0x489257[_0x33b7ba(0x294)][_0x33b7ba(0x1c5)]===_0xe862f[_0x33b7ba(0x294)][_0x33b7ba(0x1c5)]&&(_0x2acb01+=_0x33b7ba(0x32e)+_0x489257[_0x33b7ba(0x294)]['brand']+_0x33b7ba(0x2c9));}}_0x2acb01+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x2acb01+=_0x33b7ba(0x262),_0x2acb01+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x2acb01+=_0x33b7ba(0x2e7),_0x2acb01+=_0x33b7ba(0x350),_0x2acb01+=_0x33b7ba(0x26c),_0x2acb01+='<tbody>',_0x3e8dc9[_0x33b7ba(0x22b)](_0x4e7580=>{_0x2acb01+=_0x4e7580;}),console[_0x33b7ba(0x23e)](_0xdbfd74),_0x2acb01+=_0x33b7ba(0x291),_0x2acb01+='</table>';}),_0x2acb01;}async function agentsdataDSICheck_excel(_0x2d0b44,_0x443029,_0xa4c77c,_0x56ca6b){const _0x57bb15=a0_0x8d7790,_0x3a91eb=await product[_0x57bb15(0x2c1)]([{'$group':{'_id':{'brand':_0x57bb15(0x217),'category':_0x57bb15(0x268)},'products':{'$push':{'name':_0x57bb15(0x1dc),'product_code':_0x57bb15(0x2e9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x45f678=[];_0x45f678[_0x57bb15(0x2ff)]=[];for(let _0x3c35b6=0x0;_0x3c35b6<=_0x3a91eb[_0x57bb15(0x1de)]-0x1;_0x3c35b6++){const _0x4630f4=_0x3a91eb[_0x3c35b6];_0x45f678[_0x57bb15(0x2ff)][_0x57bb15(0x230)](_0x4630f4);}const _0x5dcde0=await product[_0x57bb15(0x2c1)]([{'$group':{'_id':{'category':_0x57bb15(0x268)},'products':{'$push':{'brand':_0x57bb15(0x217),'product_code':'$product_code','product_name':_0x57bb15(0x1dc)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4d2431=await product['aggregate']([{'$group':{'_id':{'category':_0x57bb15(0x268),'brand':_0x57bb15(0x217)}}},{'$group':{'_id':_0x57bb15(0x259),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xb8b97f=await sales_sa[_0x57bb15(0x2c1)]([{'$match':{'date':{'$gte':_0x2d0b44,'$lte':_0x443029},'sales_staff_id':_0xa4c77c,'sale_product.isFG':_0x57bb15(0x322)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x57bb15(0x322)}},{'$lookup':{'from':_0x57bb15(0x289),'localField':'sale_product.product_code','foreignField':_0x57bb15(0x340),'as':_0x57bb15(0x272)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x57bb15(0x1e3),'date':'$date','customer':_0x57bb15(0x35e)},'totalQty':{'$sum':_0x57bb15(0x1f1)},'products':{'$push':{'qty':_0x57bb15(0x1f1),'NetPrice':_0x57bb15(0x30d),'discount':_0x57bb15(0x31f),'adj_discount':_0x57bb15(0x2be),'product_details':{'prod_name':_0x57bb15(0x263),'product_code':_0x57bb15(0x27b),'category':'$product_info.category','brand':_0x57bb15(0x276),'gross_price':_0x57bb15(0x2ce)}}}}},{'$unwind':_0x57bb15(0x213)},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x57bb15(0x319),'category':_0x57bb15(0x29b),'brand':_0x57bb15(0x326)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x57bb15(0x29c),_0x57bb15(0x232)]}},'NetPrice':{'$sum':_0x57bb15(0x208)},'discount':{'$sum':_0x57bb15(0x2f5)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x57bb15(0x1ea)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x57bb15(0x1da),'customer':_0x57bb15(0x319)},'totalQty':{'$sum':_0x57bb15(0x2ee)},'totalGross':{'$sum':_0x57bb15(0x23b)},'NetPrice':{'$sum':_0x57bb15(0x2f8)},'discount':{'$sum':_0x57bb15(0x26a)},'adj_discount':{'$sum':_0x57bb15(0x28b)},'products':{'$push':{'qty':'$totalQty','category':_0x57bb15(0x259),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x25d076=[],_0x521a8d={},_0x3d41f7={},_0x4280b0={};var _0x516661=0x0,_0xabeab6=0x0,_0x39eb10=0x0,_0x27f357=0x0,_0x5bf154=0x0;const _0x4634d9=0x9184e72a000;for(let _0x223463=0x0;_0x223463<=_0xb8b97f[_0x57bb15(0x1de)]-0x1;_0x223463++){const _0x3e5c27=_0xb8b97f[_0x223463];let _0x2de42b=_0x57bb15(0x345);_0x2de42b+=_0x57bb15(0x1d3)+_0x3e5c27[_0x57bb15(0x294)][_0x57bb15(0x24d)]+_0x57bb15(0x2c9),_0x2de42b+=_0x57bb15(0x1d3)+_0x3e5c27[_0x57bb15(0x294)][_0x57bb15(0x301)]+'</td>',_0x2de42b+=_0x57bb15(0x1d3)+_0x3e5c27[_0x57bb15(0x294)]['customer']+_0x57bb15(0x2c9);let _0x452e4e={};var _0x58cde4=0x0;for(let _0x410dc7=0x0;_0x410dc7<=_0x3e5c27[_0x57bb15(0x289)][_0x57bb15(0x1de)]-0x1;_0x410dc7++){const _0x109433=_0x3e5c27[_0x57bb15(0x289)][_0x410dc7];_0x452e4e[_0x109433['brand']+'-'+_0x109433[_0x57bb15(0x1c5)]]=_0x109433[_0x57bb15(0x2f7)];const _0x49fd1d=_0x109433['brand']+'-'+_0x109433[_0x57bb15(0x1c5)];!_0x521a8d[_0x49fd1d]&&(_0x521a8d[_0x49fd1d]=0x0),!Array['isArray'](_0x4280b0[_0x49fd1d])&&(_0x4280b0[_0x49fd1d]=[]),!Array[_0x57bb15(0x329)](_0x4280b0[_0x49fd1d])&&(_0x4280b0[_0x49fd1d]=[]),_0x521a8d[_0x49fd1d]+=_0x109433[_0x57bb15(0x2f7)],_0x4280b0[_0x49fd1d]['push'](_0x109433['qty']),_0x58cde4++;}console[_0x57bb15(0x23e)](_0x3e5c27);for(let _0x1eecd8=0x0;_0x1eecd8<=_0x45f678[_0x57bb15(0x2ff)][_0x57bb15(0x1de)]-0x1;_0x1eecd8++){const _0x257df7=_0x45f678[_0x57bb15(0x2ff)][_0x1eecd8],_0x59b204=_0x257df7[_0x57bb15(0x294)]['brand']+'-'+_0x257df7[_0x57bb15(0x294)][_0x57bb15(0x1c5)];_0x2de42b+=_0x57bb15(0x252)+(_0x452e4e[_0x59b204]!==undefined?_0x452e4e[_0x59b204]['toFixed'](0x2):'')+_0x57bb15(0x2c9);}_0x39eb10=_0x3e5c27[_0x57bb15(0x2d4)]+_0x3e5c27['adj_discount'],_0x2de42b+=_0x57bb15(0x22d)+formatNumber(parseFloat(_0x3e5c27[_0x57bb15(0x34e)],0x2)[_0x57bb15(0x20e)](0x2))+_0x57bb15(0x2c9),_0x2de42b+=_0x57bb15(0x22d)+formatNumber(_0x3e5c27[_0x57bb15(0x24b)][_0x57bb15(0x20e)](0x2))+_0x57bb15(0x2c9),_0x2de42b+=_0x57bb15(0x22d)+formatNumber(_0x39eb10)+_0x57bb15(0x2c9),_0x2de42b+=_0x57bb15(0x22d)+formatNumber(_0x3e5c27[_0x57bb15(0x35c)][_0x57bb15(0x20e)](0x2))+_0x57bb15(0x2c9),_0x2de42b+=_0x57bb15(0x350),_0x516661+=parseFloat(_0x3e5c27['totalQty'][_0x57bb15(0x20e)](0x2)),_0xabeab6+=parseFloat(_0x3e5c27[_0x57bb15(0x35c)][_0x57bb15(0x20e)](0x2)),_0x27f357+=_0x39eb10,_0x5bf154+=parseFloat(_0x3e5c27[_0x57bb15(0x24b)][_0x57bb15(0x20e)](0x2));if(_0x223463==_0xb8b97f[_0x57bb15(0x1de)]-0x1){_0x2de42b+=_0x57bb15(0x345),_0x2de42b+=_0x57bb15(0x349),_0x2de42b+='</td>';for(let _0x4a79cd=0x0;_0x4a79cd<=_0x45f678[_0x57bb15(0x2ff)][_0x57bb15(0x1de)]-0x1;_0x4a79cd++){const _0x34e177=_0x45f678[_0x57bb15(0x2ff)][_0x4a79cd],_0x5c2d9e=_0x34e177[_0x57bb15(0x294)][_0x57bb15(0x325)]+'-'+_0x34e177['_id'][_0x57bb15(0x1c5)];!_0x4280b0[_0x5c2d9e]&&(_0x4280b0[_0x5c2d9e]=[]);const _0x17a28d=_0x4280b0[_0x5c2d9e][_0x57bb15(0x334)]((_0x63531d,_0x24197c)=>_0x63531d+_0x24197c,0x0);_0x2de42b+=_0x57bb15(0x206)+(_0x17a28d!==undefined?formatNumber(_0x17a28d[_0x57bb15(0x20e)](0x2)):'')+_0x57bb15(0x310),console['log'](_0x4280b0[_0x5c2d9e][_0x57bb15(0x334)]((_0x54fb3d,_0x26b124)=>_0x54fb3d+_0x26b124,0x0));}_0x2de42b+=_0x57bb15(0x1fd)+formatNumber(_0x516661['toFixed'](0x2))+_0x57bb15(0x310),_0x2de42b+=_0x57bb15(0x1fd)+formatNumber(_0x5bf154)+_0x57bb15(0x310),_0x2de42b+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x27f357)+_0x57bb15(0x310),_0x2de42b+=_0x57bb15(0x1fd)+formatNumber(_0xabeab6)+_0x57bb15(0x310),_0x2de42b+=_0x57bb15(0x350);}_0x25d076[_0x57bb15(0x230)](_0x2de42b);}function _0xcaaf13(_0x38bfa1,_0x2049aa){const _0x54527a=_0x57bb15,_0x5e55ac=[];for(let _0x44f241=0x0;_0x44f241<=_0x38bfa1[_0x54527a(0x1de)]-0x1;_0x44f241+=_0x2049aa){_0x5e55ac['push'](_0x38bfa1['slice'](_0x44f241,_0x44f241+_0x2049aa));}return _0x5e55ac;}const _0xf1c6a7=_0xcaaf13(_0x25d076,_0x4634d9);let _0x4c484d='';return _0xf1c6a7[_0x57bb15(0x22b)]((_0x8f830,_0x16b52c)=>{const _0x292130=_0x57bb15;_0x16b52c>0x0&&(_0x4c484d+=_0x292130(0x1df));_0x4c484d+=_0x292130(0x330),_0x4c484d+='<thead>',_0x4c484d+=_0x292130(0x345),_0x4c484d+=_0x292130(0x1e5),_0x4c484d+=_0x292130(0x350),_0x4c484d+=_0x292130(0x345),_0x4c484d+=_0x292130(0x23f);for(let _0xde5aa3=0x0;_0xde5aa3<=_0x5dcde0['length']-0x1;_0xde5aa3++){const _0x1393e7=_0x5dcde0[_0xde5aa3];for(let _0x600ed4=0x0;_0x600ed4<_0x4d2431[_0x292130(0x1de)];_0x600ed4++){const _0x3ad513=_0x4d2431[_0x600ed4];_0x3ad513[_0x292130(0x294)]===_0x1393e7[_0x292130(0x294)][_0x292130(0x1c5)]&&(_0x4c484d+='<td\x20colspan=\x22'+_0x3ad513[_0x292130(0x2a7)]+_0x292130(0x34f)+_0x1393e7[_0x292130(0x294)][_0x292130(0x1c5)]+_0x292130(0x2c9));}}_0x4c484d+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x4c484d+='</tr>',_0x4c484d+=_0x292130(0x345),_0x4c484d+=_0x292130(0x355),_0x4c484d+=_0x292130(0x2ed),_0x4c484d+=_0x292130(0x2e5);for(let _0xaa5c8a=0x0;_0xaa5c8a<=_0x5dcde0[_0x292130(0x1de)]-0x1;_0xaa5c8a++){const _0x169ab3=_0x5dcde0[_0xaa5c8a];for(let _0x28e455=0x0;_0x28e455<_0x45f678[_0x292130(0x2ff)][_0x292130(0x1de)];_0x28e455++){const _0xf2780a=_0x45f678[_0x292130(0x2ff)][_0x28e455];_0xf2780a[_0x292130(0x294)][_0x292130(0x1c5)]===_0x169ab3[_0x292130(0x294)][_0x292130(0x1c5)]&&(_0x4c484d+='<td\x20class=\x22cat_data\x22>'+_0xf2780a[_0x292130(0x294)]['brand']+'</td>');}}_0x4c484d+=_0x292130(0x2b2),_0x4c484d+=_0x292130(0x262),_0x4c484d+=_0x292130(0x220),_0x4c484d+=_0x292130(0x2e7),_0x4c484d+=_0x292130(0x350),_0x4c484d+='</thead>',_0x4c484d+=_0x292130(0x21a),_0x8f830[_0x292130(0x22b)](_0x3f0bd3=>{_0x4c484d+=_0x3f0bd3;}),console['log'](_0x4280b0),_0x4c484d+=_0x292130(0x291),_0x4c484d+=_0x292130(0x2c0);}),_0x4c484d;}router[a0_0x8d7790(0x2b4)](a0_0x8d7790(0x2aa),auth,async(_0x37f163,_0x5974c4)=>{const _0x4c7994=a0_0x8d7790,{from_date:_0x4b8e33,to_date:_0x4455a7,isExcel:_0x44dd11}=_0x37f163[_0x4c7994(0x21b)],_0x22bc42=_0x37f163[_0x4c7994(0x1c9)],_0x375712=await staff[_0x4c7994(0x28c)]({'email':_0x22bc42[_0x4c7994(0x292)]}),_0x50e314=await master_shop[_0x4c7994(0x293)](),_0x47c532=await agentsdataDSICheck(_0x4b8e33,_0x4455a7,_0x375712[_0x4c7994(0x294)][_0x4c7994(0x264)](),_0x44dd11),_0x5f038a=await agentsdataDSICheck_excel(_0x4b8e33,_0x4455a7,_0x375712['_id'][_0x4c7994(0x264)](),_0x44dd11);let _0x1926ae='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x9be151=new Date(_0x4b8e33),_0x14812d=new Date(_0x4455a7);const _0x3e984b={'year':_0x4c7994(0x2f4),'month':_0x4c7994(0x242),'day':'numeric'},_0x42b108=new Intl[(_0x4c7994(0x2a0))]('en-US',_0x3e984b)[_0x4c7994(0x314)](_0x9be151),_0x53c737=new Intl[(_0x4c7994(0x2a0))](_0x4c7994(0x260),_0x3e984b)['format'](_0x14812d);_0x1926ae+=_0x4c7994(0x2a5),_0x1926ae+=_0x4c7994(0x320),_0x1926ae+=_0x4c7994(0x330),_0x1926ae+=_0x47c532,_0x1926ae+=_0x4c7994(0x2c0),_0x1926ae+=_0x4c7994(0x285),_0x1926ae+='</div>';let _0x1bf552=_0x4c7994(0x240);_0x1bf552+='<div\x20class=\x22row\x22>',_0x1bf552+=_0x4c7994(0x320),_0x1bf552+=_0x4c7994(0x330),_0x1bf552+=_0x5f038a,_0x1bf552+=_0x4c7994(0x2c0),_0x1bf552+='</div>',_0x1bf552+=_0x4c7994(0x285);let _0x38ac9f='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x4e1bc5={'width':_0x4c7994(0x24c),'height':_0x4c7994(0x20c),'orientation':'landscape','border':{'top':'0.1in','right':_0x4c7994(0x201),'bottom':_0x4c7994(0x201),'left':_0x4c7994(0x201)},'header':{'height':_0x4c7994(0x1d5),'contents':_0x4c7994(0x351)+_0x38ac9f+_0x4c7994(0x2b0)+_0x42b108+_0x4c7994(0x239)+_0x53c737+_0x4c7994(0x2ec)},'footer':{'height':'20mm','contents':{'default':_0x4c7994(0x302)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x4c7994(0x26e)}}};if(_0x44dd11=='on'){const _0x36866b=cheerio['load'](_0x1bf552);let _0x54b8fb=[],_0x8d8f05=[],_0x1aacdf=[];const _0x57e448=_0x332eb7=>{const _0x430725=_0x4c7994,_0x436987={'top':{'style':'thick','color':{'rgb':_0x430725(0x25d)}},'bottom':{'style':'thick','color':{'rgb':_0x430725(0x25d)}},'left':{'style':'thick','color':{'rgb':_0x430725(0x25d)}},'right':{'style':_0x430725(0x1cb),'color':{'rgb':_0x430725(0x25d)}}};if(_0x332eb7){const _0x460784=_0x332eb7[_0x430725(0x221)](';')[_0x430725(0x334)]((_0x4c9501,_0xf42fee)=>{const _0x2b4580=_0x430725,[_0x3142ef,_0x1d60c6]=_0xf42fee['split'](':')[_0x2b4580(0x303)](_0x95d3d7=>_0x95d3d7['trim']());return _0x4c9501[_0x3142ef]=_0x1d60c6,_0x4c9501;},{});_0x460784[_0x430725(0x254)]&&(_0x436987[_0x430725(0x245)]['style']=_0x460784[_0x430725(0x254)]['includes']('thin')?_0x430725(0x31a):_0x430725(0x2a4)),_0x460784['border-bottom']&&(_0x436987[_0x430725(0x32d)]['style']=_0x460784[_0x430725(0x250)][_0x430725(0x261)](_0x430725(0x31a))?_0x430725(0x31a):_0x430725(0x2a4)),_0x460784[_0x430725(0x2bf)]&&(_0x436987[_0x430725(0x2b9)][_0x430725(0x304)]=_0x460784[_0x430725(0x2bf)][_0x430725(0x261)]('thin')?_0x430725(0x31a):'medium'),_0x460784[_0x430725(0x1ed)]&&(_0x436987['right'][_0x430725(0x304)]=_0x460784['border-right'][_0x430725(0x261)](_0x430725(0x31a))?'thin':_0x430725(0x2a4));}return _0x436987;};_0x36866b(_0x4c7994(0x316))[_0x4c7994(0x207)]((_0x5d6059,_0x223210)=>{const _0x4d63f0=_0x4c7994;let _0x1d9e9f=[],_0x43fff5=0x0;while(_0x1aacdf[_0x43fff5]){_0x1aacdf[_0x43fff5]--,_0x43fff5++;}_0x36866b(_0x223210)[_0x4d63f0(0x293)](_0x4d63f0(0x234))['each']((_0xfabbb6,_0x4f0beb)=>{const _0x2d9cff=_0x4d63f0;let _0x46b1eb=_0x36866b(_0x4f0beb)['text']()[_0x2d9cff(0x33c)](),_0x2725da=parseFloat(_0x46b1eb[_0x2d9cff(0x1d2)](/,/g,'')),_0x160370={};!isNaN(_0x2725da)?(_0x160370['v']=_0x2725da,_0x160370['t']='n'):(_0x160370['v']=_0x46b1eb,_0x160370['t']='s');const _0xfd1c5d=_0x36866b(_0x4f0beb)[_0x2d9cff(0x32b)]('style'),_0x57c43a=_0x57e448(_0xfd1c5d);_0x160370['s']={'border':_0x57c43a},_0x1d9e9f[_0x43fff5]=_0x160370;let _0x353703=parseInt(_0x36866b(_0x4f0beb)[_0x2d9cff(0x32b)](_0x2d9cff(0x358)))||0x1,_0x12b237=parseInt(_0x36866b(_0x4f0beb)['attr'](_0x2d9cff(0x33b)))||0x1;(_0x353703>0x1||_0x12b237>0x1)&&_0x8d8f05['push']({'s':{'r':_0x5d6059,'c':_0x43fff5},'e':{'r':_0x5d6059+_0x12b237-0x1,'c':_0x43fff5+_0x353703-0x1}});for(let _0x19b984=0x0;_0x19b984<_0x353703;_0x19b984++){_0x12b237>0x1&&(_0x1aacdf[_0x43fff5+_0x19b984]=_0x12b237-0x1);}_0x43fff5+=_0x353703;}),_0x54b8fb[_0x4d63f0(0x230)](_0x1d9e9f);});const _0x3589c6=XLSX['utils']['book_new'](),_0x207bdd=XLSX[_0x4c7994(0x1fe)][_0x4c7994(0x2a1)](_0x54b8fb);_0x8d8f05[_0x4c7994(0x1de)]>0x0&&(_0x207bdd['!merges']=_0x8d8f05);_0x207bdd[_0x4c7994(0x2f0)]=_0x54b8fb[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x4c7994(0x1ce)](_0x3589c6,_0x207bdd,_0x4c7994(0x29f));const _0xd913c3=XLSX['write'](_0x3589c6,{'bookType':_0x4c7994(0x23a),'type':_0x4c7994(0x352)});_0x5974c4[_0x4c7994(0x2b3)](_0x4c7994(0x30e),_0x4c7994(0x249)),_0x5974c4[_0x4c7994(0x2b3)](_0x4c7994(0x33a),_0x4c7994(0x271)),_0x5974c4['send'](_0xd913c3);}else pdf[_0x4c7994(0x313)](_0x1926ae,_0x4e1bc5)[_0x4c7994(0x2cb)](function(_0x20a4a9,_0x177579){const _0xbbb024=_0x4c7994;if(_0x20a4a9){console[_0xbbb024(0x1f6)](_0xbbb024(0x246),_0x20a4a9),_0x5974c4['status'](0x1f4)[_0xbbb024(0x200)]('Error\x20generating\x20PDF'+_0x20a4a9);return;}_0x5974c4[_0xbbb024(0x2b3)]('Content-Type',_0xbbb024(0x2b6)),_0x177579[_0xbbb024(0x32f)](_0x5974c4);});}),router[a0_0x8d7790(0x2c6)](a0_0x8d7790(0x228),auth,async(_0x3fb2b8,_0x336ab9)=>{const _0x83ac8=a0_0x8d7790;try{const {username:_0x30a6c0,email:_0x381bae,role:_0x3a9670}=_0x3fb2b8[_0x83ac8(0x1c9)],_0x531c38=_0x3fb2b8[_0x83ac8(0x1c9)],_0x3e55e2=await profile[_0x83ac8(0x28c)]({'email':_0x531c38[_0x83ac8(0x292)]}),_0x3c1f32={'year':_0x83ac8(0x2f4),'month':_0x83ac8(0x242),'day':'numeric'},_0x20b8a7=await master_shop[_0x83ac8(0x293)](),_0x45d2f9=await product[_0x83ac8(0x293)](),_0x454183=await warehouse[_0x83ac8(0x2c1)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x83ac8(0x289),'localField':'product_details.product_name','foreignField':_0x83ac8(0x1e6),'as':_0x83ac8(0x31c)}},{'$unwind':_0x83ac8(0x2ab)},{'$project':{'product_name':_0x83ac8(0x258),'product_stock':_0x83ac8(0x2e4)}},{'$group':{'_id':_0x83ac8(0x25c),'product_stock':{'$sum':_0x83ac8(0x2fc)}}}]),_0x1d3f70=await staff[_0x83ac8(0x28c)]({'email':_0x531c38[_0x83ac8(0x292)]});if(_0x20b8a7[0x0]['language']=='English\x20(US)')var _0x4dc95c=users[_0x83ac8(0x332)];else{if(_0x20b8a7[0x0]['language']==_0x83ac8(0x2d1))var _0x4dc95c=users[_0x83ac8(0x2d1)];else{if(_0x20b8a7[0x0][_0x83ac8(0x361)]=='German')var _0x4dc95c=users['German'];else{if(_0x20b8a7[0x0][_0x83ac8(0x361)]=='Spanish')var _0x4dc95c=users[_0x83ac8(0x324)];else{if(_0x20b8a7[0x0]['language']=='French')var _0x4dc95c=users[_0x83ac8(0x2fd)];else{if(_0x20b8a7[0x0][_0x83ac8(0x361)]==_0x83ac8(0x209))var _0x4dc95c=users[_0x83ac8(0x273)];else{if(_0x20b8a7[0x0][_0x83ac8(0x361)]==_0x83ac8(0x30b))var _0x4dc95c=users[_0x83ac8(0x30b)];else{if(_0x20b8a7[0x0][_0x83ac8(0x361)]=='Arabic\x20(ae)')var _0x4dc95c=users[_0x83ac8(0x1d6)];}}}}}}}_0x336ab9[_0x83ac8(0x29d)](_0x83ac8(0x265),{'success':_0x3fb2b8[_0x83ac8(0x32c)](_0x83ac8(0x30c)),'errors':_0x3fb2b8[_0x83ac8(0x32c)](_0x83ac8(0x256)),'alldata':_0x45d2f9,'profile':_0x3e55e2,'master_shop':_0x20b8a7,'role':_0x531c38,'product_stock':_0x454183,'language':_0x4dc95c,'staff_arr':_0x1d3f70});}catch(_0x19dd74){}});async function dataSalesReports(_0x3726a2,_0x36e967,_0x123ab2){const _0x3caad7=a0_0x8d7790;let _0x2cf25b='';const _0x9725e0=await sales_sa[_0x3caad7(0x2c1)]([{'$match':{'date':{'$gte':_0x3726a2,'$lte':_0x36e967},'sales_staff_id':_0x123ab2}},{'$unwind':_0x3caad7(0x2b1)},{'$match':{'sale_product.isFG':_0x3caad7(0x322)}},{'$group':{'_id':{'product_name':_0x3caad7(0x247),'product_code':_0x3caad7(0x2e0)},'sumqty':{'$sum':_0x3caad7(0x1f1)},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x356068=0x0,_0x4fcf85=0x0;for(let _0x52f15e=0x0;_0x52f15e<=_0x9725e0['length']-0x1;_0x52f15e++){const _0x1ad3fc=_0x9725e0[_0x52f15e];var _0x14ab49=_0x1ad3fc[_0x3caad7(0x2ea)][_0x3caad7(0x25e)](undefined),_0x5952c2=_0x1ad3fc['sumqty']['toLocaleString'](undefined);_0x2cf25b+=_0x3caad7(0x345),_0x2cf25b+=_0x3caad7(0x29e)+_0x1ad3fc['_id'][_0x3caad7(0x340)]+_0x3caad7(0x2c9),_0x2cf25b+=_0x3caad7(0x29e)+_0x1ad3fc[_0x3caad7(0x294)][_0x3caad7(0x270)]+_0x3caad7(0x2c9),_0x2cf25b+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x1ad3fc['sumqty'][_0x3caad7(0x20e)](0x2))+_0x3caad7(0x2c9),_0x2cf25b+=_0x3caad7(0x29e)+formatNumber(_0x1ad3fc[_0x3caad7(0x2ea)][_0x3caad7(0x20e)](0x2))+_0x3caad7(0x2c9),_0x2cf25b+=_0x3caad7(0x350),_0x356068+=parseFloat(_0x1ad3fc[_0x3caad7(0x2d6)]),_0x4fcf85+=parseFloat(_0x1ad3fc[_0x3caad7(0x2ea)]);}var _0x31002c=_0x4fcf85[_0x3caad7(0x25e)](undefined),_0x36ef60=_0x356068[_0x3caad7(0x25e)](undefined);return _0x2cf25b+='<tr>',_0x2cf25b+=_0x3caad7(0x2ac),_0x2cf25b+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x356068[_0x3caad7(0x20e)](0x2))+_0x3caad7(0x310),_0x2cf25b+=_0x3caad7(0x31d)+formatNumber(_0x4fcf85[_0x3caad7(0x20e)](0x2))+_0x3caad7(0x310),_0x2cf25b+=_0x3caad7(0x350),_0x2cf25b;}router[a0_0x8d7790(0x2b4)](a0_0x8d7790(0x331),auth,async(_0x416490,_0x3b4164)=>{const _0x3fd10f=a0_0x8d7790;try{const {from_date:_0xe2d6e8,to_date:_0x328a75,isExcel:_0xe891b7}=_0x416490[_0x3fd10f(0x21b)],_0x2523d6=_0x416490[_0x3fd10f(0x1c9)],_0x5eb96c=await staff['findOne']({'email':_0x2523d6['email']});let _0x1b01ef=_0x3fd10f(0x2c2);var _0x58db00=new Date(_0xe2d6e8),_0x17cc47=new Date(_0x328a75);const _0x2d9e99={'year':_0x3fd10f(0x2f4),'month':'long','day':_0x3fd10f(0x2f4)},_0x4b3843=new Intl[(_0x3fd10f(0x2a0))](_0x3fd10f(0x260),_0x2d9e99)[_0x3fd10f(0x314)](_0x58db00),_0x5db36c=new Intl[(_0x3fd10f(0x2a0))](_0x3fd10f(0x260),_0x2d9e99)['format'](_0x17cc47);var _0x56dc4a=await dataSalesReports(_0xe2d6e8,_0x328a75,_0x5eb96c['_id'][_0x3fd10f(0x264)]());_0x1b01ef+=_0x3fd10f(0x2a5),_0x1b01ef+=_0x3fd10f(0x218),_0x1b01ef+=_0x3fd10f(0x330),_0x1b01ef+=_0x3fd10f(0x345),_0x1b01ef+=_0x3fd10f(0x27d),_0x1b01ef+=_0x3fd10f(0x308),_0x1b01ef+=_0x3fd10f(0x266),_0x1b01ef+=_0x3fd10f(0x2cd),_0x1b01ef+=_0x3fd10f(0x345),_0x1b01ef+=_0x56dc4a,_0x1b01ef+=_0x3fd10f(0x350),_0x1b01ef+=_0x3fd10f(0x285),_0x1b01ef+='</div>';let _0x4adce8=_0x3fd10f(0x347);const _0x3f0860={'width':_0x3fd10f(0x24c),'height':'8.5in','orientation':_0x3fd10f(0x2d2),'border':{'top':'0.1in','right':_0x3fd10f(0x201),'bottom':_0x3fd10f(0x201),'left':_0x3fd10f(0x201)},'header':{'height':_0x3fd10f(0x1d5),'contents':_0x3fd10f(0x351)+_0x4adce8+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x5eb96c[_0x3fd10f(0x1e6)]+_0x3fd10f(0x202)+_0x4b3843+_0x3fd10f(0x239)+_0x5db36c+_0x3fd10f(0x2ec)},'footer':{'height':_0x3fd10f(0x238),'contents':{'default':_0x3fd10f(0x302)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3fd10f(0x26e)}}};if(_0xe891b7=='on'){const _0x3545a0=cheerio[_0x3fd10f(0x339)](_0x1b01ef);let _0x138e75=[],_0x4ff21b=[],_0x576068=[];const _0x45b475=_0xd60328=>{const _0x53cff2=_0x3fd10f,_0x127abe={'top':{'style':_0x53cff2(0x1cb),'color':{'rgb':_0x53cff2(0x25d)}},'bottom':{'style':'thick','color':{'rgb':_0x53cff2(0x25d)}},'left':{'style':_0x53cff2(0x1cb),'color':{'rgb':_0x53cff2(0x25d)}},'right':{'style':_0x53cff2(0x1cb),'color':{'rgb':_0x53cff2(0x25d)}}};if(_0xd60328){const _0x58fafa=_0xd60328[_0x53cff2(0x221)](';')[_0x53cff2(0x334)]((_0x3a0491,_0x2133fe)=>{const _0x8c9395=_0x53cff2,[_0x642979,_0x56f3c8]=_0x2133fe[_0x8c9395(0x221)](':')[_0x8c9395(0x303)](_0x351940=>_0x351940[_0x8c9395(0x33c)]());return _0x3a0491[_0x642979]=_0x56f3c8,_0x3a0491;},{});_0x58fafa['border-top']&&(_0x127abe[_0x53cff2(0x245)][_0x53cff2(0x304)]=_0x58fafa[_0x53cff2(0x254)][_0x53cff2(0x261)](_0x53cff2(0x31a))?'thin':_0x53cff2(0x2a4)),_0x58fafa[_0x53cff2(0x250)]&&(_0x127abe[_0x53cff2(0x32d)]['style']=_0x58fafa['border-bottom']['includes'](_0x53cff2(0x31a))?_0x53cff2(0x31a):_0x53cff2(0x2a4)),_0x58fafa[_0x53cff2(0x2bf)]&&(_0x127abe[_0x53cff2(0x2b9)][_0x53cff2(0x304)]=_0x58fafa['border-left'][_0x53cff2(0x261)](_0x53cff2(0x31a))?_0x53cff2(0x31a):'medium'),_0x58fafa['border-right']&&(_0x127abe[_0x53cff2(0x286)][_0x53cff2(0x304)]=_0x58fafa[_0x53cff2(0x1ed)][_0x53cff2(0x261)]('thin')?_0x53cff2(0x31a):'medium');}return _0x127abe;};_0x3545a0(_0x3fd10f(0x316))[_0x3fd10f(0x207)]((_0xb6adc8,_0x388d27)=>{const _0x338941=_0x3fd10f;let _0x33a991=[],_0x2a165f=0x0;while(_0x576068[_0x2a165f]){_0x576068[_0x2a165f]--,_0x2a165f++;}_0x3545a0(_0x388d27)[_0x338941(0x293)](_0x338941(0x234))[_0x338941(0x207)]((_0x12b7c2,_0x2e4063)=>{const _0x2625d2=_0x338941;let _0x5709df=_0x3545a0(_0x2e4063)[_0x2625d2(0x2bd)]()[_0x2625d2(0x33c)](),_0x5ec785=parseFloat(_0x5709df[_0x2625d2(0x1d2)](/,/g,'')),_0x17a93a={};!isNaN(_0x5ec785)?(_0x17a93a['v']=_0x5ec785,_0x17a93a['t']='n'):(_0x17a93a['v']=_0x5709df,_0x17a93a['t']='s');const _0x434713=_0x3545a0(_0x2e4063)['attr']('style'),_0xf5fb3a=_0x45b475(_0x434713);_0x17a93a['s']={'border':_0xf5fb3a},_0x33a991[_0x2a165f]=_0x17a93a;let _0x41daaa=parseInt(_0x3545a0(_0x2e4063)['attr']('colspan'))||0x1,_0xf99ab6=parseInt(_0x3545a0(_0x2e4063)[_0x2625d2(0x32b)](_0x2625d2(0x33b)))||0x1;(_0x41daaa>0x1||_0xf99ab6>0x1)&&_0x4ff21b['push']({'s':{'r':_0xb6adc8,'c':_0x2a165f},'e':{'r':_0xb6adc8+_0xf99ab6-0x1,'c':_0x2a165f+_0x41daaa-0x1}});for(let _0x13328a=0x0;_0x13328a<_0x41daaa;_0x13328a++){_0xf99ab6>0x1&&(_0x576068[_0x2a165f+_0x13328a]=_0xf99ab6-0x1);}_0x2a165f+=_0x41daaa;}),_0x138e75[_0x338941(0x230)](_0x33a991);});const _0x2800cd=XLSX[_0x3fd10f(0x1fe)][_0x3fd10f(0x267)](),_0x1fc147=XLSX[_0x3fd10f(0x1fe)]['aoa_to_sheet'](_0x138e75);_0x4ff21b['length']>0x0&&(_0x1fc147[_0x3fd10f(0x2d8)]=_0x4ff21b);_0x1fc147['!cols']=_0x138e75[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x3fd10f(0x1fe)][_0x3fd10f(0x1ce)](_0x2800cd,_0x1fc147,'Sales\x20Report');const _0x5cd63f=XLSX[_0x3fd10f(0x214)](_0x2800cd,{'bookType':_0x3fd10f(0x23a),'type':'buffer'});_0x3b4164[_0x3fd10f(0x2b3)](_0x3fd10f(0x30e),_0x3fd10f(0x249)),_0x3b4164[_0x3fd10f(0x2b3)]('Content-Type',_0x3fd10f(0x271)),_0x3b4164[_0x3fd10f(0x200)](_0x5cd63f);}else pdf[_0x3fd10f(0x313)](_0x1b01ef,_0x3f0860)[_0x3fd10f(0x2cb)](function(_0x227040,_0x3d3ff5){const _0x5f3566=_0x3fd10f;if(_0x227040){_0x3b4164[_0x5f3566(0x2fa)](0x1f4)[_0x5f3566(0x200)]('Error\x20generating\x20PDF');return;}_0x3b4164[_0x5f3566(0x2b3)](_0x5f3566(0x33a),_0x5f3566(0x2b6)),_0x3d3ff5[_0x5f3566(0x32f)](_0x3b4164);});}catch(_0x5505eb){}}),router[a0_0x8d7790(0x2c6)](a0_0x8d7790(0x1dd),auth,async(_0x160f34,_0x2cafd5)=>{const _0x1dd4b3=a0_0x8d7790;try{const {username:_0x850cc6,email:_0x1f4300,role:_0x5f8471}=_0x160f34['user'],_0x596d92=_0x160f34[_0x1dd4b3(0x1c9)],_0x1a3dc1=await profile[_0x1dd4b3(0x28c)]({'email':_0x596d92[_0x1dd4b3(0x292)]}),_0x1ff283={'year':_0x1dd4b3(0x2f4),'month':'long','day':_0x1dd4b3(0x2f4)},_0x266bd6=await master_shop[_0x1dd4b3(0x293)](),_0x123486=await product[_0x1dd4b3(0x293)](),_0x33ea9b=await warehouse[_0x1dd4b3(0x2c1)]([{'$unwind':_0x1dd4b3(0x25b)},{'$lookup':{'from':'products','localField':_0x1dd4b3(0x343),'foreignField':_0x1dd4b3(0x1e6),'as':_0x1dd4b3(0x31c)}},{'$unwind':_0x1dd4b3(0x2ab)},{'$project':{'product_name':_0x1dd4b3(0x258),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x1dd4b3(0x25c),'product_stock':{'$sum':_0x1dd4b3(0x2fc)}}}]);if(_0x266bd6[0x0][_0x1dd4b3(0x361)]==_0x1dd4b3(0x212))var _0x4751b1=users[_0x1dd4b3(0x332)];else{if(_0x266bd6[0x0]['language']==_0x1dd4b3(0x2d1))var _0x4751b1=users[_0x1dd4b3(0x2d1)];else{if(_0x266bd6[0x0][_0x1dd4b3(0x361)]==_0x1dd4b3(0x2db))var _0x4751b1=users[_0x1dd4b3(0x2db)];else{if(_0x266bd6[0x0][_0x1dd4b3(0x361)]==_0x1dd4b3(0x324))var _0x4751b1=users['Spanish'];else{if(_0x266bd6[0x0]['language']==_0x1dd4b3(0x2fd))var _0x4751b1=users[_0x1dd4b3(0x2fd)];else{if(_0x266bd6[0x0]['language']==_0x1dd4b3(0x209))var _0x4751b1=users['Portuguese'];else{if(_0x266bd6[0x0][_0x1dd4b3(0x361)]=='Chinese')var _0x4751b1=users[_0x1dd4b3(0x30b)];else{if(_0x266bd6[0x0]['language']==_0x1dd4b3(0x1db))var _0x4751b1=users['Arabic'];}}}}}}}_0x2cafd5[_0x1dd4b3(0x29d)](_0x1dd4b3(0x2c5),{'success':_0x160f34[_0x1dd4b3(0x32c)](_0x1dd4b3(0x30c)),'errors':_0x160f34['flash']('errors'),'alldata':_0x123486,'profile':_0x1a3dc1,'master_shop':_0x266bd6,'role':_0x596d92,'product_stock':_0x33ea9b,'language':_0x4751b1});}catch(_0x1b026d){}});async function dataInventoryReports(_0x19e0ea,_0x27e4f9,_0x6533b5){const _0x2d0599=a0_0x8d7790,_0x46bc64=await sales_sa[_0x2d0599(0x2c1)]([{'$match':{'date':{'$gte':_0x19e0ea,'$lte':_0x27e4f9},'sales_staff_id':_0x6533b5}},{'$unwind':_0x2d0599(0x2b1)},{'$group':{'_id':{'product_name':_0x2d0599(0x247),'product_code':_0x2d0599(0x2e0)},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0xfaf4f5=mongoose[_0x2d0599(0x342)][_0x2d0599(0x2fb)],_0x236749=await staff['aggregate']([{'$match':{'_id':_0xfaf4f5(_0x6533b5)}},{'$unwind':'$product_list'},{'$match':{'product_list.isConfirm':_0x2d0599(0x1eb)}},{'$group':{'_id':{'product_name':_0x2d0599(0x2ba),'product_code':_0x2d0599(0x333)},'sumqty':{'$sum':_0x2d0599(0x318)}}},{'$sort':{'_id.product_name':0x1}}]),_0x263f70=await sales_inv_data[_0x2d0599(0x2c1)]([{'$match':{'date':{'$gte':_0x19e0ea,'$lte':_0x27e4f9},'sales_staff_id':_0x6533b5}},{'$unwind':_0x2d0599(0x2b1)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':'$sale_product.product_code'},'totalQTYsum':{'$sum':_0x2d0599(0x2b8)}}}]);console['log'](_0x263f70);let _0x28fe1d='';var _0x1af40a=0x0;for(let _0xe944c9=0x0;_0xe944c9<=_0x236749['length']-0x1;_0xe944c9++){const _0x3a88dd=_0x236749[_0xe944c9];_0x28fe1d+=_0x2d0599(0x345),_0x28fe1d+=_0x2d0599(0x224)+_0x3a88dd[_0x2d0599(0x294)][_0x2d0599(0x340)]+_0x2d0599(0x2c9),_0x28fe1d+=_0x2d0599(0x283)+_0x3a88dd[_0x2d0599(0x294)][_0x2d0599(0x270)]+_0x2d0599(0x2c9);var _0x580ee1=_0x3a88dd[_0x2d0599(0x2d6)],_0x132b86=0x0;for(let _0x2a37f8=0x0;_0x2a37f8<=_0x46bc64[_0x2d0599(0x1de)]-0x1;_0x2a37f8++){const _0x2064b0=_0x46bc64[_0x2a37f8];_0x3a88dd[_0x2d0599(0x294)]['product_code']==_0x2064b0[_0x2d0599(0x294)][_0x2d0599(0x340)]&&_0x3a88dd[_0x2d0599(0x294)][_0x2d0599(0x270)]==_0x2064b0['_id'][_0x2d0599(0x270)]&&(_0x132b86=_0x2064b0[_0x2d0599(0x2d6)]);}var _0x4eb411=0x0;for(let _0x7ae084=0x0;_0x7ae084<=_0x263f70[_0x2d0599(0x1de)]-0x1;_0x7ae084++){const _0x13aa77=_0x263f70[_0x7ae084];_0x3a88dd[_0x2d0599(0x294)][_0x2d0599(0x340)]==_0x13aa77[_0x2d0599(0x294)][_0x2d0599(0x340)]&&_0x3a88dd[_0x2d0599(0x294)][_0x2d0599(0x270)]==_0x13aa77[_0x2d0599(0x294)][_0x2d0599(0x270)]&&(_0x4eb411=_0x13aa77[_0x2d0599(0x2a9)]);}_0x1af40a=_0x580ee1-_0x4eb411+_0x132b86,_0x28fe1d+=_0x2d0599(0x29e)+_0x1af40a+_0x2d0599(0x2c9);let _0x4da43a=![];for(let _0x2f4a31=0x0;_0x2f4a31<=_0x263f70[_0x2d0599(0x1de)]-0x1;_0x2f4a31++){const _0x28a51d=_0x263f70[_0x2f4a31];if(_0x3a88dd[_0x2d0599(0x294)][_0x2d0599(0x340)]==_0x28a51d[_0x2d0599(0x294)][_0x2d0599(0x340)]&&_0x3a88dd[_0x2d0599(0x294)]['product_name']==_0x28a51d[_0x2d0599(0x294)][_0x2d0599(0x270)]){_0x28fe1d+='<td\x20class=\x22row_data\x22>'+_0x28a51d[_0x2d0599(0x2a9)]+_0x2d0599(0x2c9),_0x4da43a=!![];break;}}!_0x4da43a&&(_0x28fe1d+=_0x2d0599(0x1e2));let _0x29b7c9=![];for(let _0x4c2f78=0x0;_0x4c2f78<=_0x46bc64[_0x2d0599(0x1de)]-0x1;_0x4c2f78++){const _0x598d03=_0x46bc64[_0x4c2f78];if(_0x3a88dd[_0x2d0599(0x294)]['product_code']==_0x598d03['_id'][_0x2d0599(0x340)]&&_0x3a88dd[_0x2d0599(0x294)]['product_name']==_0x598d03['_id'][_0x2d0599(0x270)]){_0x28fe1d+=_0x2d0599(0x29e)+_0x598d03[_0x2d0599(0x2d6)]+_0x2d0599(0x2c9),_0x29b7c9=!![];break;}}!_0x29b7c9&&(_0x28fe1d+=_0x2d0599(0x1e2)),_0x28fe1d+=_0x2d0599(0x29e)+_0x3a88dd[_0x2d0599(0x2d6)]+_0x2d0599(0x2c9),_0x28fe1d+=_0x2d0599(0x350);}return _0x28fe1d;}router['post'](a0_0x8d7790(0x35a),auth,async(_0x536ebb,_0x4da17a)=>{const _0x4754d3=a0_0x8d7790;try{const {from_date:_0x13e38c,to_date:_0x261347}=_0x536ebb[_0x4754d3(0x21b)],_0x57269b=_0x536ebb[_0x4754d3(0x1c9)],_0x4b8cd9=await staff[_0x4754d3(0x28c)]({'email':_0x57269b[_0x4754d3(0x292)]});let _0x584506=_0x4754d3(0x2c2);var _0x26f3e3=new Date(_0x13e38c),_0x12dbb7=new Date(_0x261347);const _0x4cd142={'year':_0x4754d3(0x2f4),'month':_0x4754d3(0x242),'day':_0x4754d3(0x2f4)},_0x413531=new Intl['DateTimeFormat'](_0x4754d3(0x260),_0x4cd142)[_0x4754d3(0x314)](_0x26f3e3),_0x281d9d=new Intl[(_0x4754d3(0x2a0))](_0x4754d3(0x260),_0x4cd142)['format'](_0x12dbb7);var _0x502d88=await dataInventoryReports(_0x13e38c,_0x261347,_0x4b8cd9['_id']['valueOf']());_0x584506+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x584506+=_0x4754d3(0x2f1),_0x584506+='<p>'+_0x413531+_0x4754d3(0x239)+_0x281d9d+_0x4754d3(0x31e),_0x584506+=_0x4754d3(0x2a5),_0x584506+=_0x4754d3(0x218),_0x584506+=_0x4754d3(0x330),_0x584506+=_0x4754d3(0x345),_0x584506+=_0x4754d3(0x27d),_0x584506+=_0x4754d3(0x308),_0x584506+=_0x4754d3(0x1c7),_0x584506+='<th>\x20INCOMING\x20</th>',_0x584506+=_0x4754d3(0x280),_0x584506+=_0x4754d3(0x210),_0x584506+=_0x4754d3(0x345),_0x584506+=_0x502d88,_0x584506+=_0x4754d3(0x350),_0x584506+=_0x4754d3(0x285),_0x584506+=_0x4754d3(0x285);const _0x120d8b={'format':_0x4754d3(0x348),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x4754d3(0x26e)}}};pdf['create'](_0x584506,_0x120d8b)[_0x4754d3(0x2cb)](function(_0x190aec,_0x128ed5){const _0x2d906a=_0x4754d3;if(_0x190aec){_0x4da17a[_0x2d906a(0x2fa)](0x1f4)['send'](_0x2d906a(0x211));return;}_0x4da17a[_0x2d906a(0x2b3)](_0x2d906a(0x33a),'application/pdf'),_0x128ed5[_0x2d906a(0x32f)](_0x4da17a);});}catch(_0x2dd53f){}}),router[a0_0x8d7790(0x2c6)](a0_0x8d7790(0x1c6),auth,async(_0x5ae962,_0x114875)=>{const _0x437613=a0_0x8d7790;try{const {username:_0x3e6cf9,email:_0x59039e,role:_0x4db548}=_0x5ae962[_0x437613(0x1c9)],_0x23d699=_0x5ae962['user'],_0x205d85=await profile[_0x437613(0x28c)]({'email':_0x23d699[_0x437613(0x292)]}),_0x40a829={'year':'numeric','month':'long','day':_0x437613(0x2f4)},_0x1dd760=await master_shop['find']();console[_0x437613(0x23e)](_0x437613(0x1f4),_0x1dd760);const _0x5881da=await product['find']();console[_0x437613(0x23e)](_0x437613(0x362),_0x5881da);const _0x231b61=await warehouse[_0x437613(0x2c1)]([{'$unwind':_0x437613(0x25b)},{'$lookup':{'from':_0x437613(0x289),'localField':_0x437613(0x343),'foreignField':'name','as':_0x437613(0x31c)}},{'$unwind':_0x437613(0x2ab)},{'$project':{'product_name':_0x437613(0x258),'product_stock':_0x437613(0x2e4)}},{'$group':{'_id':_0x437613(0x25c),'product_stock':{'$sum':_0x437613(0x2fc)}}}]);console[_0x437613(0x23e)]('Products\x20warehouse_data',_0x231b61),_0x231b61[_0x437613(0x22b)](_0xbaa31a=>{const _0x57843a=_0x437613,_0x1fd2bf=_0x5881da[_0x57843a(0x303)](_0x12831c=>{const _0x90babf=_0x57843a;_0x12831c[_0x90babf(0x1e6)]==_0xbaa31a[_0x90babf(0x294)]&&(_0x12831c['stock']=parseInt(_0x12831c['stock'])+parseInt(_0xbaa31a['product_stock']));});});const _0x71736c=await staff['findOne']({'email':_0x23d699['email']});if(_0x1dd760[0x0][_0x437613(0x361)]==_0x437613(0x212))var _0x554f7e=users['English'];else{if(_0x1dd760[0x0][_0x437613(0x361)]==_0x437613(0x2d1))var _0x554f7e=users[_0x437613(0x2d1)];else{if(_0x1dd760[0x0]['language']==_0x437613(0x2db))var _0x554f7e=users[_0x437613(0x2db)];else{if(_0x1dd760[0x0]['language']=='Spanish')var _0x554f7e=users[_0x437613(0x324)];else{if(_0x1dd760[0x0][_0x437613(0x361)]==_0x437613(0x2fd))var _0x554f7e=users[_0x437613(0x2fd)];else{if(_0x1dd760[0x0][_0x437613(0x361)]=='Portuguese\x20(BR)')var _0x554f7e=users['Portuguese'];else{if(_0x1dd760[0x0][_0x437613(0x361)]==_0x437613(0x30b))var _0x554f7e=users[_0x437613(0x30b)];else{if(_0x1dd760[0x0]['language']==_0x437613(0x1db))var _0x554f7e=users[_0x437613(0x1d6)];}}}}}}}_0x114875[_0x437613(0x29d)](_0x437613(0x35f),{'success':_0x5ae962[_0x437613(0x32c)](_0x437613(0x30c)),'errors':_0x5ae962['flash'](_0x437613(0x256)),'alldata':_0x5881da,'profile':_0x205d85,'master_shop':_0x1dd760,'role':_0x23d699,'product_stock':_0x231b61,'language':_0x554f7e,'staff_arr':_0x71736c});}catch(_0x47ffa7){}});async function agentsdataDSICheck_DSRR(_0xcbec55,_0x280be2,_0x5cfdb6,_0x4c4031){const _0x3f643e=a0_0x8d7790;let _0x5cf2a5=new Date(_0xcbec55);_0x5cf2a5[_0x3f643e(0x2df)](_0x5cf2a5['getDate']()-0x1);let _0x163b60=_0x5cf2a5[_0x3f643e(0x1ef)]()[_0x3f643e(0x221)]('T')[0x0];const _0x4cb4b9=await product[_0x3f643e(0x2c1)]([{'$group':{'_id':{'brand':'$brand','category':_0x3f643e(0x268)},'products':{'$push':{'name':'$name','product_code':_0x3f643e(0x2e9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x89b169=[];_0x89b169[_0x3f643e(0x2ff)]=[];for(let _0x4b22b5=0x0;_0x4b22b5<=_0x4cb4b9[_0x3f643e(0x1de)]-0x1;_0x4b22b5++){const _0xf71c81=_0x4cb4b9[_0x4b22b5];_0x89b169[_0x3f643e(0x2ff)][_0x3f643e(0x230)](_0xf71c81);}const _0x497150=await product[_0x3f643e(0x2c1)]([{'$group':{'_id':{'category':_0x3f643e(0x268)},'products':{'$push':{'brand':_0x3f643e(0x217),'product_code':_0x3f643e(0x2e9),'product_name':_0x3f643e(0x1dc)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5c28af=await product['aggregate']([{'$group':{'_id':{'category':_0x3f643e(0x268),'brand':_0x3f643e(0x217)}}},{'$group':{'_id':_0x3f643e(0x259),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4f394a=await sales_sa[_0x3f643e(0x2c1)]([{'$match':{'date':_0xcbec55,'sales_staff_id':_0x280be2,'sale_product.isFG':'false'}},{'$unwind':_0x3f643e(0x2b1)},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':'product_code','as':_0x3f643e(0x272)}},{'$unwind':_0x3f643e(0x1c8)},{'$group':{'_id':{'dsi':_0x3f643e(0x1e3),'date':_0x3f643e(0x30f),'customer':_0x3f643e(0x35e),'status_data':_0x3f643e(0x2a2)},'totalQty':{'$sum':_0x3f643e(0x1f1)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x3f643e(0x23d)},'check_no':{'$first':_0x3f643e(0x287)},'due_date':{'$first':_0x3f643e(0x2e6)},'products':{'$push':{'qty':_0x3f643e(0x1f1),'NetPrice':_0x3f643e(0x30d),'discount':_0x3f643e(0x31f),'adj_discount':_0x3f643e(0x2be),'product_details':{'prod_name':_0x3f643e(0x263),'product_code':_0x3f643e(0x27b),'category':_0x3f643e(0x2e3),'brand':_0x3f643e(0x276),'gross_price':'$product_info.gross_price','isFG':'$sale_product.isFG','prod_cat':_0x3f643e(0x2d7),'prod_id':_0x3f643e(0x284)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x3f643e(0x275),'date':_0x3f643e(0x1da),'customer':_0x3f643e(0x319),'status_data':_0x3f643e(0x225),'category':_0x3f643e(0x29b),'brand':_0x3f643e(0x326),'prod_id':_0x3f643e(0x353)},'totalQty':{'$sum':_0x3f643e(0x29c)},'totalGross':{'$sum':{'$multiply':[_0x3f643e(0x29c),_0x3f643e(0x232)]}},'NetPrice':{'$sum':_0x3f643e(0x208)},'discount':{'$sum':_0x3f643e(0x2f5)},'adj_discount':{'$sum':_0x3f643e(0x288)},'cash':{'$first':_0x3f643e(0x2dd)},'amount':{'$first':_0x3f643e(0x1c4)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3f643e(0x2e6)},'product_details':{'$first':_0x3f643e(0x1ea)}}},{'$group':{'_id':{'dsi':_0x3f643e(0x275),'date':_0x3f643e(0x1da),'customer':_0x3f643e(0x319),'status_data':_0x3f643e(0x225)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x3f643e(0x23b)},'NetPrice':{'$sum':_0x3f643e(0x2f8)},'discount':{'$sum':_0x3f643e(0x26a)},'adj_discount':{'$sum':'$adj_discount'},'cash':{'$first':_0x3f643e(0x2dd)},'amount':{'$first':_0x3f643e(0x1c4)},'bank':{'$first':_0x3f643e(0x23d)},'check_no':{'$first':_0x3f643e(0x287)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x3f643e(0x2ee),'category':'$_id.category','brand':'$_id.brand','product_details':_0x3f643e(0x25b)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x469ea8=await sales_sa['aggregate']([{'$match':{'date':_0x163b60,'sales_staff_id':_0x280be2,'sale_product.isFG':'false'}},{'$unwind':_0x3f643e(0x2b1)},{'$lookup':{'from':_0x3f643e(0x289),'localField':'sale_product.product_code','foreignField':_0x3f643e(0x340),'as':_0x3f643e(0x272)}},{'$unwind':_0x3f643e(0x1c8)},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x3f643e(0x1f1)},'cash':{'$first':_0x3f643e(0x2dd)},'amount':{'$first':_0x3f643e(0x1c4)},'bank':{'$first':_0x3f643e(0x23d)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3f643e(0x2e6)},'products':{'$push':{'qty':_0x3f643e(0x1f1),'NetPrice':'$sale_product.totalprice','discount':_0x3f643e(0x31f),'adj_discount':_0x3f643e(0x2be),'product_details':{'prod_name':_0x3f643e(0x263),'product_code':_0x3f643e(0x27b),'category':'$product_info.category','brand':_0x3f643e(0x276),'gross_price':_0x3f643e(0x2ce),'isFG':'$sale_product.isFG','prod_cat':'$sale_product.prod_cat','prod_id':_0x3f643e(0x284)}}}}},{'$unwind':_0x3f643e(0x213)},{'$group':{'_id':{'dsi':_0x3f643e(0x275),'date':_0x3f643e(0x1da),'customer':_0x3f643e(0x319),'category':_0x3f643e(0x29b),'brand':_0x3f643e(0x326),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x3f643e(0x29c)},'cash':{'$first':_0x3f643e(0x2dd)},'amount':{'$first':_0x3f643e(0x1c4)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x3f643e(0x287)},'due_date':{'$first':_0x3f643e(0x2e6)},'totalGross':{'$sum':{'$multiply':[_0x3f643e(0x29c),_0x3f643e(0x232)]}},'NetPrice':{'$sum':_0x3f643e(0x208)},'discount':{'$sum':_0x3f643e(0x2f5)},'adj_discount':{'$sum':_0x3f643e(0x288)},'product_details':{'$first':_0x3f643e(0x1ea)}}},{'$group':{'_id':{'dsi':_0x3f643e(0x275),'date':_0x3f643e(0x1da),'customer':_0x3f643e(0x319)},'totalQty':{'$sum':'$totalQty'},'cash':{'$first':_0x3f643e(0x2dd)},'amount':{'$first':'$amount'},'bank':{'$first':_0x3f643e(0x23d)},'check_no':{'$first':_0x3f643e(0x287)},'due_date':{'$first':_0x3f643e(0x2e6)},'totalGross':{'$sum':_0x3f643e(0x23b)},'NetPrice':{'$sum':_0x3f643e(0x2f8)},'discount':{'$sum':_0x3f643e(0x26a)},'adj_discount':{'$sum':_0x3f643e(0x28b)},'products':{'$push':{'qty':'$totalQty','category':_0x3f643e(0x259),'brand':_0x3f643e(0x2c3),'product_details':_0x3f643e(0x25b)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x281397=await sales_sa[_0x3f643e(0x2c1)]([{'$match':{'date':_0xcbec55,'sales_staff_id':_0x280be2,'status_data':_0x3f643e(0x1eb)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5cfdb4=await staff[_0x3f643e(0x1e9)](_0x280be2);let _0x36dc7b=[],_0x593d4b={},_0x4f8240={};var _0x404395=0x0,_0x33404c=0x0,_0x2d3480=0x0,_0x4d8db3=0x0,_0x3da16b=0x0;const _0x81257d=0x6;var _0xcb7994=0x0,_0x56e9fa=0x0;for(let _0x1c550d=0x0;_0x1c550d<=_0x4f394a[_0x3f643e(0x1de)]-0x1;_0x1c550d++){const _0x3782bc=_0x4f394a[_0x1c550d];let _0x7c02d2='<tr>';_0x7c02d2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x7c02d2+=_0x3f643e(0x1d3)+_0x3782bc[_0x3f643e(0x294)][_0x3f643e(0x2bc)]+_0x3f643e(0x2c9),_0x7c02d2+=_0x3f643e(0x1d3)+_0x3782bc['_id']['dsi']+_0x3f643e(0x2c9);let _0x1d7014={},_0x4b370a={},_0x4b24d6={};var _0x4e7301={},_0x316209={},_0x2b61ee={},_0x37fde5=0x0;for(let _0xf9985e=0x0;_0xf9985e<=_0x3782bc[_0x3f643e(0x289)][_0x3f643e(0x1de)]-0x1;_0xf9985e++){const _0x2e1933=_0x3782bc[_0x3f643e(0x289)][_0xf9985e];_0x1d7014[_0x2e1933[_0x3f643e(0x325)]+'-'+_0x2e1933[_0x3f643e(0x1c5)]]=_0x2e1933[_0x3f643e(0x2f7)],_0x4b370a[[_0x2e1933[_0x3f643e(0x325)]+'-'+_0x2e1933[_0x3f643e(0x1c5)]]]=_0x2e1933[_0x3f643e(0x298)]['isFG'],_0x4b24d6[[_0x2e1933[_0x3f643e(0x325)]+'-'+_0x2e1933[_0x3f643e(0x1c5)]]]=_0x2e1933[_0x3f643e(0x298)][_0x3f643e(0x29a)];const _0x2e0156=_0x2e1933[_0x3f643e(0x325)]+'-'+_0x2e1933[_0x3f643e(0x1c5)];!Array[_0x3f643e(0x329)](_0x4f8240[_0x2e0156])&&(_0x4f8240[_0x2e0156]=[]);!Array[_0x3f643e(0x329)](_0x4f8240[_0x2e0156])&&(_0x4f8240[_0x2e0156]=[]);_0x4f8240[_0x2e0156][_0x3f643e(0x230)](_0x2e1933[_0x3f643e(0x2f7)]);if(_0x2e1933['product_details'][_0x3f643e(0x29a)]=='P')_0x2e1933['product_details'][_0x3f643e(0x222)]==_0x3f643e(0x1eb)?(!_0x2b61ee[_0x2e0156]&&(_0x2b61ee[_0x2e0156]=0x0),_0x2b61ee[_0x2e0156]=_0x2e1933[_0x3f643e(0x2f7)]):(!_0x4e7301[_0x2e0156]&&(_0x4e7301[_0x2e0156]=0x0),_0x4e7301[_0x2e0156]=_0x2e1933[_0x3f643e(0x2f7)]);else _0x2e1933[_0x3f643e(0x298)]['prod_cat']=='S'&&(_0x2e1933[_0x3f643e(0x298)]['isFG']=='true'?(!_0x2b61ee[_0x2e0156]&&(_0x2b61ee[_0x2e0156]=0x0),_0x2b61ee[_0x2e0156]=_0x2e1933[_0x3f643e(0x2f7)]):(!_0x316209[_0x2e0156]&&(_0x316209[_0x2e0156]=0x0),_0x316209[_0x2e0156]=_0x2e1933[_0x3f643e(0x2f7)]));_0x37fde5++;}for(let _0x3856d8=0x0;_0x3856d8<=_0x89b169[_0x3f643e(0x2ff)]['length']-0x1;_0x3856d8++){const _0x2bd532=_0x89b169['cat_brand'][_0x3856d8],_0xa66b9e=_0x2bd532['_id'][_0x3f643e(0x325)]+'-'+_0x2bd532[_0x3f643e(0x294)]['category'],_0x89269b=_0x4b24d6[_0xa66b9e]!==undefined?_0x4b24d6[_0xa66b9e]:'NA';var _0x156f51=_0x4e7301[_0xa66b9e]!==undefined?_0x4e7301[_0xa66b9e]['toFixed'](0x2):'',_0x23eda3=_0x316209[_0xa66b9e]!==undefined?_0x316209[_0xa66b9e]['toFixed'](0x2):'',_0x84d9c8=_0x2b61ee[_0xa66b9e]!==undefined?_0x2b61ee[_0xa66b9e][_0x3f643e(0x20e)](0x2):'';_0x7c02d2+=_0x3f643e(0x252)+_0x156f51+_0x3f643e(0x2c9),_0x7c02d2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x23eda3+_0x3f643e(0x2c9),_0x7c02d2+=_0x3f643e(0x252)+_0x84d9c8+_0x3f643e(0x2c9);}var _0x1a1852=formatNumber(parseFloat(_0x3782bc[_0x3f643e(0x278)])),_0x4ce388=formatNumber(parseFloat(_0x3782bc['amount']));isNaN(_0x4ce388)&&(_0x4ce388=0x0),_0x7c02d2+=_0x3f643e(0x252)+_0x1a1852+_0x3f643e(0x2c9),_0x7c02d2+=_0x3f643e(0x252)+_0x4ce388+'</td>',_0x7c02d2+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3782bc[_0x3f643e(0x24f)]+'</td>',_0x7c02d2+=_0x3f643e(0x1d3)+_0x3782bc[_0x3f643e(0x315)]+_0x3f643e(0x2c9),_0x7c02d2+=_0x3f643e(0x1d3)+_0x3782bc[_0x3f643e(0x360)]+_0x3f643e(0x2c9),_0x2d3480=_0x3782bc[_0x3f643e(0x2d4)]+_0x3782bc['adj_discount'],_0xcb7994+=parseFloat(_0x3782bc[_0x3f643e(0x278)]),_0x56e9fa+=parseFloat(_0x4ce388),_0x36dc7b[_0x3f643e(0x230)](_0x7c02d2);}if(_0x281397[_0x3f643e(0x1de)]>0x0)for(let _0x3441cb=0x0;_0x3441cb<=_0x281397['length']-0x1;_0x3441cb++){const _0x277a18=_0x281397[_0x3441cb];console[_0x3f643e(0x23e)](_0x277a18);let _0x33eeda=_0x3f643e(0x345);_0x33eeda+=_0x3f643e(0x336)+(0x8+0x7*0x3)+_0x3f643e(0x305)+_0x277a18[_0x3f643e(0x243)]+'</b></td>',_0x33eeda+='</tr>',_0x36dc7b['push'](_0x33eeda);}function _0x572172(_0x26bbad,_0x2cf2ec){const _0x105002=_0x3f643e,_0x5ca53c=[];for(let _0x21827c=0x0;_0x21827c<=_0x26bbad[_0x105002(0x1de)]-0x1;_0x21827c+=_0x2cf2ec){_0x5ca53c[_0x105002(0x230)](_0x26bbad[_0x105002(0x282)](_0x21827c,_0x21827c+_0x2cf2ec));}return _0x5ca53c;}const _0x4ed44b=_0x572172(_0x36dc7b,_0x81257d);let _0x6e0d89='';return _0x4ed44b['forEach']((_0x4f8176,_0x58a11c)=>{const _0x26d806=_0x3f643e;_0x58a11c>0x0&&(_0x6e0d89+=_0x26d806(0x1df));_0x6e0d89+='<table>',_0x6e0d89+=_0x26d806(0x307);const _0x31ced7=new Date(_0xcbec55),_0x4628fc={'year':_0x26d806(0x2f4),'month':_0x26d806(0x242),'day':'numeric','timeZone':_0x26d806(0x2ad)},_0xe8d27c=_0x31ced7[_0x26d806(0x31b)](_0x26d806(0x260),_0x4628fc);_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x1f0)+_0x4c4031+_0x26d806(0x310),_0x6e0d89+='</tr>',_0x6e0d89+='<tr>',_0x6e0d89+=_0x26d806(0x1f5)+_0x5cfdb4[_0x26d806(0x1e6)]+_0x26d806(0x2c9),_0x6e0d89+=_0x26d806(0x297),_0x6e0d89+=_0x26d806(0x21d),_0x6e0d89+=_0x26d806(0x24a),_0x6e0d89+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x6e0d89+=_0x26d806(0x20b),_0x6e0d89+=_0x26d806(0x337),_0x6e0d89+='<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>',_0x6e0d89+=_0x26d806(0x2af),_0x6e0d89+='</tr>',_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x6e0d89+=_0x26d806(0x26d)+_0xe8d27c+'</td>',_0x6e0d89+=_0x26d806(0x2eb),_0x6e0d89+=_0x26d806(0x2cf),_0x6e0d89+=_0x26d806(0x2d5),_0x6e0d89+=_0x26d806(0x2d5),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x312),_0x6e0d89+=_0x26d806(0x1d7),_0x6e0d89+=_0x26d806(0x344),_0x6e0d89+=_0x26d806(0x2d5),_0x6e0d89+=_0x26d806(0x2d5),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x6e0d89+='</tr>',_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x1e8),_0x6e0d89+='<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>',_0x6e0d89+='</tr>',_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x2f6),_0x6e0d89+=_0x26d806(0x1ca),_0x6e0d89+=_0x26d806(0x2e8);for(let _0x58b2a2=0x0;_0x58b2a2<=_0x497150[_0x26d806(0x1de)]-0x1;_0x58b2a2++){const _0x478627=_0x497150[_0x58b2a2];for(let _0x18a1ad=0x0;_0x18a1ad<_0x89b169['cat_brand']['length'];_0x18a1ad++){const _0x19de40=_0x89b169[_0x26d806(0x2ff)][_0x18a1ad];if(_0x19de40['_id']['category']===_0x478627[_0x26d806(0x294)][_0x26d806(0x1c5)]){var _0x4be45b='';switch(_0x478627[_0x26d806(0x294)]['category']){case _0x26d806(0x274):_0x4be45b=_0x19de40[_0x26d806(0x294)][_0x26d806(0x325)]+_0x26d806(0x341);break;case _0x26d806(0x2f3):_0x4be45b=_0x19de40[_0x26d806(0x294)][_0x26d806(0x325)]+_0x26d806(0x22a);break;default:_0x4be45b=_0x19de40['_id'][_0x26d806(0x325)];break;}_0x6e0d89+=_0x26d806(0x2a3)+_0x4be45b+'</b></td>';}}}_0x6e0d89+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x6e0d89+=_0x26d806(0x22e),_0x6e0d89+=_0x26d806(0x306),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x23f);for(let _0xd03531=0x0;_0xd03531<=_0x89b169['cat_brand']['length']-0x1;_0xd03531++){const _0x14265d=_0x89b169[_0xd03531];_0x6e0d89+=_0x26d806(0x20a),_0x6e0d89+=_0x26d806(0x34c),_0x6e0d89+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x6e0d89+=_0x26d806(0x2b5),_0x6e0d89+=_0x26d806(0x321),_0x6e0d89+=_0x26d806(0x311),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+='</thead>',_0x6e0d89+=_0x26d806(0x21a),_0x4f8176[_0x26d806(0x22b)](_0x462fea=>{_0x6e0d89+=_0x462fea;});let _0x273fd5={},_0x38b579={},_0x12df1f={};for(let _0x4361b2=0x0;_0x4361b2<=_0x4f394a[_0x26d806(0x1de)]-0x1;_0x4361b2++){const _0x3db6bf=_0x4f394a[_0x4361b2];var _0x5533cf=0x0;for(let _0x12dfa7=0x0;_0x12dfa7<=_0x3db6bf['products'][_0x26d806(0x1de)]-0x1;_0x12dfa7++){const _0x2f26f9=_0x3db6bf[_0x26d806(0x289)][_0x12dfa7],_0x5128b7=_0x2f26f9[_0x26d806(0x325)]+'-'+_0x2f26f9[_0x26d806(0x1c5)];if(_0x2f26f9[_0x26d806(0x298)][_0x26d806(0x29a)]=='P')_0x2f26f9[_0x26d806(0x298)][_0x26d806(0x222)]==_0x26d806(0x1eb)?(!_0x12df1f[_0x5128b7]&&(_0x12df1f[_0x5128b7]=0x0),_0x12df1f[_0x5128b7]+=_0x2f26f9[_0x26d806(0x2f7)]):(!_0x273fd5[_0x5128b7]&&(_0x273fd5[_0x5128b7]=0x0),_0x273fd5[_0x5128b7]+=_0x2f26f9['qty']);else _0x2f26f9[_0x26d806(0x298)][_0x26d806(0x29a)]=='S'&&(_0x2f26f9[_0x26d806(0x298)][_0x26d806(0x222)]==_0x26d806(0x1eb)?(!_0x12df1f[_0x5128b7]&&(_0x12df1f[_0x5128b7]=0x0),_0x12df1f[_0x5128b7]+=_0x2f26f9[_0x26d806(0x2f7)],console[_0x26d806(0x23e)](_0x2f26f9[_0x26d806(0x2f7)])):(!_0x38b579[_0x5128b7]&&(_0x38b579[_0x5128b7]=0x0),_0x38b579[_0x5128b7]+=_0x2f26f9[_0x26d806(0x2f7)]));_0x5533cf++;}}let _0x351ff4={},_0x2475e4={},_0x216013={};var _0x35272b=0x0,_0x1e492d=0x0;for(let _0x31e6cd=0x0;_0x31e6cd<=_0x469ea8[_0x26d806(0x1de)]-0x1;_0x31e6cd++){const _0x3f5d43=_0x469ea8[_0x31e6cd];var _0x5533cf=0x0;for(let _0x4e219d=0x0;_0x4e219d<=_0x3f5d43['products'][_0x26d806(0x1de)]-0x1;_0x4e219d++){const _0x5b9973=_0x3f5d43[_0x26d806(0x289)][_0x4e219d],_0x3a5217=_0x5b9973[_0x26d806(0x325)]+'-'+_0x5b9973['category'];if(_0x5b9973[_0x26d806(0x298)][_0x26d806(0x29a)]=='P')_0x5b9973[_0x26d806(0x298)]['isFG']==_0x26d806(0x1eb)?(!_0x216013[_0x3a5217]&&(_0x216013[_0x3a5217]=0x0),_0x216013[_0x3a5217]+=_0x5b9973['qty']):(!_0x351ff4[_0x3a5217]&&(_0x351ff4[_0x3a5217]=0x0),_0x351ff4[_0x3a5217]+=_0x5b9973['qty']);else _0x5b9973[_0x26d806(0x298)][_0x26d806(0x29a)]=='S'&&(_0x5b9973[_0x26d806(0x298)][_0x26d806(0x222)]==_0x26d806(0x1eb)?(!_0x216013[_0x3a5217]&&(_0x216013[_0x3a5217]=0x0),_0x216013[_0x3a5217]+=_0x5b9973[_0x26d806(0x2f7)]):(!_0x2475e4[_0x3a5217]&&(_0x2475e4[_0x3a5217]=0x0),_0x2475e4[_0x3a5217]+=_0x5b9973[_0x26d806(0x2f7)]));_0x5533cf++;}var _0x4bd2c2=parseFloat(_0x3f5d43[_0x26d806(0x278)]),_0x19c978=parseFloat(_0x3f5d43[_0x26d806(0x346)]);isNaN(_0x19c978)&&(_0x19c978=0x0),_0x35272b+=_0x4bd2c2,_0x1e492d+=_0x19c978;}_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x2d3),_0x6e0d89+=_0x26d806(0x295),_0x6e0d89+=_0x26d806(0x1d9);for(let _0x1ae9e1=0x0;_0x1ae9e1<=_0x89b169['cat_brand']['length']-0x1;_0x1ae9e1++){const _0x1656a7=_0x89b169[_0x26d806(0x2ff)][_0x1ae9e1],_0x54c1dc=_0x1656a7[_0x26d806(0x294)][_0x26d806(0x325)]+'-'+_0x1656a7[_0x26d806(0x294)]['category'];var _0x186384=_0x273fd5[_0x54c1dc]!==undefined?formatNumber(_0x273fd5[_0x54c1dc][_0x26d806(0x20e)](0x2)):'',_0xd061bb=_0x12df1f[_0x54c1dc]!==undefined?formatNumber(_0x12df1f[_0x54c1dc][_0x26d806(0x20e)](0x2)):'',_0x4556ea=_0x38b579[_0x54c1dc]!==undefined?formatNumber(_0x38b579[_0x54c1dc][_0x26d806(0x20e)](0x2)):'';_0x6e0d89+=_0x26d806(0x206)+_0x186384+_0x26d806(0x310),_0x6e0d89+=_0x26d806(0x206)+_0x4556ea+_0x26d806(0x310),_0x6e0d89+=_0x26d806(0x206)+_0xd061bb+_0x26d806(0x310);}_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xcb7994)+_0x26d806(0x310),_0x6e0d89+=_0x26d806(0x206)+formatNumber(_0x56e9fa)+_0x26d806(0x310),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+='</tr>',_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x2d3),_0x6e0d89+=_0x26d806(0x24e),_0x6e0d89+=_0x26d806(0x1d9);for(let _0x3d0108=0x0;_0x3d0108<=_0x89b169[_0x26d806(0x2ff)][_0x26d806(0x1de)]-0x1;_0x3d0108++){const _0x2c18a7=_0x89b169[_0x26d806(0x2ff)][_0x3d0108],_0x37f509=_0x2c18a7['_id']['brand']+'-'+_0x2c18a7['_id']['category'];var _0x186384=_0x351ff4[_0x37f509]!==undefined?formatNumber(_0x351ff4[_0x37f509]['toFixed'](0x2)):'',_0xd061bb=_0x216013[_0x37f509]!==undefined?formatNumber(_0x216013[_0x37f509][_0x26d806(0x20e)](0x2)):'',_0x4556ea=_0x2475e4[_0x37f509]!==undefined?formatNumber(_0x2475e4[_0x37f509][_0x26d806(0x20e)](0x2)):'';_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x186384+_0x26d806(0x310),_0x6e0d89+=_0x26d806(0x206)+_0x4556ea+'</b></td>',_0x6e0d89+=_0x26d806(0x206)+_0xd061bb+_0x26d806(0x310);}_0x6e0d89+=_0x26d806(0x206)+formatNumber(_0x35272b)+_0x26d806(0x310),_0x6e0d89+=_0x26d806(0x206)+formatNumber(_0x1e492d)+_0x26d806(0x310),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x2d3),_0x6e0d89+=_0x26d806(0x257),_0x6e0d89+=_0x26d806(0x1d9);let _0x8eb61d=0x0,_0x1a40ab=0x0,_0x4f2c4d=0x0;for(let _0x14a060=0x0;_0x14a060<=_0x89b169[_0x26d806(0x2ff)][_0x26d806(0x1de)]-0x1;_0x14a060++){const _0x561075=_0x89b169[_0x26d806(0x2ff)][_0x14a060],_0x527228=_0x561075[_0x26d806(0x294)][_0x26d806(0x325)]+'-'+_0x561075[_0x26d806(0x294)]['category'];var _0x55bdc5=_0x273fd5[_0x527228]!==undefined?_0x273fd5[_0x527228][_0x26d806(0x20e)](0x2):'0',_0x454bd7=_0x12df1f[_0x527228]!==undefined?_0x12df1f[_0x527228][_0x26d806(0x20e)](0x2):'0',_0x556be0=_0x38b579[_0x527228]!==undefined?_0x38b579[_0x527228]['toFixed'](0x2):'0',_0xd9bcda=_0x351ff4[_0x527228]!==undefined?_0x351ff4[_0x527228][_0x26d806(0x20e)](0x2):'0',_0x9e1785=_0x216013[_0x527228]!==undefined?_0x216013[_0x527228][_0x26d806(0x20e)](0x2):'0',_0x3e1e2b=_0x2475e4[_0x527228]!==undefined?_0x2475e4[_0x527228][_0x26d806(0x20e)](0x2):'0';_0x8eb61d=parseFloat(_0x55bdc5)+parseFloat(_0xd9bcda),_0x1a40ab=parseFloat(_0x556be0)+parseFloat(_0x3e1e2b),_0x4f2c4d=parseFloat(_0x454bd7)+parseFloat(_0x9e1785),_0x6e0d89+=_0x26d806(0x206)+formatNumber(_0x8eb61d[_0x26d806(0x20e)](0x2))+'</b></td>',_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1a40ab[_0x26d806(0x20e)](0x2))+_0x26d806(0x310),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4f2c4d[_0x26d806(0x20e)](0x2))+'</b></td>';}var _0x13fb84=formatNumber(_0xcb7994+_0x35272b),_0x4cc6e4=formatNumber(_0x56e9fa+_0x1e492d);_0x6e0d89+=_0x26d806(0x206)+_0x13fb84+_0x26d806(0x310),_0x6e0d89+=_0x26d806(0x206)+_0x4cc6e4+_0x26d806(0x310),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x89b169[_0x26d806(0x2ff)][_0x26d806(0x1de)]*0x3+0x9)+'\x22><b></b></td>',_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x6e0d89+=_0x26d806(0x34d),_0x6e0d89+=_0x26d806(0x1d9);for(let _0x348c57=0x0;_0x348c57<=_0x89b169[_0x26d806(0x2ff)][_0x26d806(0x1de)]-0x1;_0x348c57++){const _0x534b4b=_0x89b169[_0x26d806(0x2ff)][_0x348c57],_0x50b8bb=_0x534b4b['_id'][_0x26d806(0x325)]+'-'+_0x534b4b[_0x26d806(0x294)][_0x26d806(0x1c5)];var _0x55bdc5=_0x273fd5[_0x50b8bb]!==undefined?_0x273fd5[_0x50b8bb]['toFixed'](0x2):'0',_0x454bd7=_0x12df1f[_0x50b8bb]!==undefined?_0x12df1f[_0x50b8bb]['toFixed'](0x2):'0',_0x556be0=_0x38b579[_0x50b8bb]!==undefined?_0x38b579[_0x50b8bb][_0x26d806(0x20e)](0x2):'0',_0xd9bcda=_0x351ff4[_0x50b8bb]!==undefined?_0x351ff4[_0x50b8bb][_0x26d806(0x20e)](0x2):'0',_0x9e1785=_0x216013[_0x50b8bb]!==undefined?_0x216013[_0x50b8bb][_0x26d806(0x20e)](0x2):'0',_0x3e1e2b=_0x2475e4[_0x50b8bb]!==undefined?_0x2475e4[_0x50b8bb][_0x26d806(0x20e)](0x2):'0';_0x8eb61d=parseFloat(_0x55bdc5)+parseFloat(_0xd9bcda),_0x1a40ab=parseFloat(_0x556be0)+parseFloat(_0x3e1e2b),_0x4f2c4d=parseFloat(_0x454bd7)+parseFloat(_0x9e1785),_0x6e0d89+=_0x26d806(0x255),_0x6e0d89+=_0x26d806(0x255),_0x6e0d89+=_0x26d806(0x255);}_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x2d3),_0x6e0d89+=_0x26d806(0x1f9),_0x6e0d89+=_0x26d806(0x1d9);for(let _0x352ffe=0x0;_0x352ffe<=_0x89b169[_0x26d806(0x2ff)][_0x26d806(0x1de)]-0x1;_0x352ffe++){const _0x9ff652=_0x89b169[_0x26d806(0x2ff)][_0x352ffe],_0x45fa1d=_0x9ff652[_0x26d806(0x294)][_0x26d806(0x325)]+'-'+_0x9ff652['_id'][_0x26d806(0x1c5)];var _0x55bdc5=_0x273fd5[_0x45fa1d]!==undefined?_0x273fd5[_0x45fa1d][_0x26d806(0x20e)](0x2):'0',_0x454bd7=_0x12df1f[_0x45fa1d]!==undefined?_0x12df1f[_0x45fa1d][_0x26d806(0x20e)](0x2):'0',_0x556be0=_0x38b579[_0x45fa1d]!==undefined?_0x38b579[_0x45fa1d][_0x26d806(0x20e)](0x2):'0',_0xd9bcda=_0x351ff4[_0x45fa1d]!==undefined?_0x351ff4[_0x45fa1d][_0x26d806(0x20e)](0x2):'0',_0x9e1785=_0x216013[_0x45fa1d]!==undefined?_0x216013[_0x45fa1d][_0x26d806(0x20e)](0x2):'0',_0x3e1e2b=_0x2475e4[_0x45fa1d]!==undefined?_0x2475e4[_0x45fa1d][_0x26d806(0x20e)](0x2):'0';_0x8eb61d=parseFloat(_0x55bdc5)+parseFloat(_0xd9bcda),_0x1a40ab=parseFloat(_0x556be0)+parseFloat(_0x3e1e2b),_0x4f2c4d=parseFloat(_0x454bd7)+parseFloat(_0x9e1785),_0x6e0d89+=_0x26d806(0x255),_0x6e0d89+=_0x26d806(0x255),_0x6e0d89+=_0x26d806(0x255);}_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x2d3),_0x6e0d89+=_0x26d806(0x205),_0x6e0d89+=_0x26d806(0x1d9);for(let _0xe3901e=0x0;_0xe3901e<=_0x89b169[_0x26d806(0x2ff)]['length']-0x1;_0xe3901e++){const _0x19bd90=_0x89b169['cat_brand'][_0xe3901e],_0x5bb710=_0x19bd90[_0x26d806(0x294)]['brand']+'-'+_0x19bd90[_0x26d806(0x294)][_0x26d806(0x1c5)];var _0x55bdc5=_0x273fd5[_0x5bb710]!==undefined?_0x273fd5[_0x5bb710]['toFixed'](0x2):'0',_0x454bd7=_0x12df1f[_0x5bb710]!==undefined?_0x12df1f[_0x5bb710][_0x26d806(0x20e)](0x2):'0',_0x556be0=_0x38b579[_0x5bb710]!==undefined?_0x38b579[_0x5bb710]['toFixed'](0x2):'0',_0xd9bcda=_0x351ff4[_0x5bb710]!==undefined?_0x351ff4[_0x5bb710][_0x26d806(0x20e)](0x2):'0',_0x9e1785=_0x216013[_0x5bb710]!==undefined?_0x216013[_0x5bb710][_0x26d806(0x20e)](0x2):'0',_0x3e1e2b=_0x2475e4[_0x5bb710]!==undefined?_0x2475e4[_0x5bb710][_0x26d806(0x20e)](0x2):'0';_0x8eb61d=parseFloat(_0x55bdc5)+parseFloat(_0xd9bcda),_0x1a40ab=parseFloat(_0x556be0)+parseFloat(_0x3e1e2b),_0x4f2c4d=parseFloat(_0x454bd7)+parseFloat(_0x9e1785),_0x6e0d89+=_0x26d806(0x255),_0x6e0d89+=_0x26d806(0x255),_0x6e0d89+=_0x26d806(0x255);}_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+='</tr>',_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x2d3),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x6e0d89+=_0x26d806(0x1d9);for(let _0x4d2274=0x0;_0x4d2274<=_0x89b169[_0x26d806(0x2ff)]['length']-0x1;_0x4d2274++){const _0x294c58=_0x89b169[_0x26d806(0x2ff)][_0x4d2274],_0x5bc126=_0x294c58[_0x26d806(0x294)][_0x26d806(0x325)]+'-'+_0x294c58['_id'][_0x26d806(0x1c5)];var _0x55bdc5=_0x273fd5[_0x5bc126]!==undefined?_0x273fd5[_0x5bc126][_0x26d806(0x20e)](0x2):'',_0x454bd7=_0x12df1f[_0x5bc126]!==undefined?_0x12df1f[_0x5bc126][_0x26d806(0x20e)](0x2):'',_0x556be0=_0x38b579[_0x5bc126]!==undefined?_0x38b579[_0x5bc126][_0x26d806(0x20e)](0x2):'',_0xd9bcda=_0x351ff4[_0x5bc126]!==undefined?_0x351ff4[_0x5bc126][_0x26d806(0x20e)](0x2):'',_0x9e1785=_0x216013[_0x5bc126]!==undefined?_0x216013[_0x5bc126][_0x26d806(0x20e)](0x2):'',_0x3e1e2b=_0x2475e4[_0x5bc126]!==undefined?_0x2475e4[_0x5bc126][_0x26d806(0x20e)](0x2):'';_0x8eb61d=formatNumber(parseFloat(_0x55bdc5)+parseFloat(_0xd9bcda)),_0x1a40ab=formatNumber(parseFloat(_0x556be0)+parseFloat(_0x3e1e2b)),_0x4f2c4d=formatNumber(parseFloat(_0x454bd7)+parseFloat(_0x9e1785)),_0x6e0d89+=_0x26d806(0x206)+_0x55bdc5+_0x26d806(0x310),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x556be0+_0x26d806(0x310),_0x6e0d89+=_0x26d806(0x206)+_0x454bd7+_0x26d806(0x310);}_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x345),_0x6e0d89+=_0x26d806(0x2d3),_0x6e0d89+=_0x26d806(0x2dc),_0x6e0d89+=_0x26d806(0x1d9);for(let _0x256496=0x0;_0x256496<=_0x89b169[_0x26d806(0x2ff)][_0x26d806(0x1de)]-0x1;_0x256496++){const _0x368d47=_0x89b169[_0x26d806(0x2ff)][_0x256496],_0x2b6959=_0x368d47[_0x26d806(0x294)][_0x26d806(0x325)]+'-'+_0x368d47[_0x26d806(0x294)][_0x26d806(0x1c5)];var _0x55bdc5=_0x273fd5[_0x2b6959]!==undefined?_0x273fd5[_0x2b6959][_0x26d806(0x20e)](0x2):'0',_0x454bd7=_0x12df1f[_0x2b6959]!==undefined?_0x12df1f[_0x2b6959][_0x26d806(0x20e)](0x2):'0',_0x556be0=_0x38b579[_0x2b6959]!==undefined?_0x38b579[_0x2b6959]['toFixed'](0x2):'0',_0xd9bcda=_0x351ff4[_0x2b6959]!==undefined?_0x351ff4[_0x2b6959][_0x26d806(0x20e)](0x2):'0',_0x9e1785=_0x216013[_0x2b6959]!==undefined?_0x216013[_0x2b6959][_0x26d806(0x20e)](0x2):'0',_0x3e1e2b=_0x2475e4[_0x2b6959]!==undefined?_0x2475e4[_0x2b6959]['toFixed'](0x2):'0';_0x8eb61d=parseFloat(_0x55bdc5)+parseFloat(_0xd9bcda),_0x1a40ab=parseFloat(_0x556be0)+parseFloat(_0x3e1e2b),_0x4f2c4d=parseFloat(_0x454bd7)+parseFloat(_0x9e1785),_0x6e0d89+=_0x26d806(0x255),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x6e0d89+=_0x26d806(0x255);}_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x1d9),_0x6e0d89+=_0x26d806(0x350),_0x6e0d89+=_0x26d806(0x291),_0x6e0d89+='</table>';}),_0x6e0d89;}async function generateReferenceNumber(_0x340a23,_0x4eb5c2,_0x3a5676){const _0x48af0a=a0_0x8d7790,_0x201f60=new Date(_0x340a23)[_0x48af0a(0x28e)](),_0xf57da=('0'+(new Date(_0x340a23)[_0x48af0a(0x35b)]()+0x1))[_0x48af0a(0x282)](-0x2),_0x4da570=('0'+new Date(_0x340a23)[_0x48af0a(0x26f)]())[_0x48af0a(0x282)](-0x2),_0x4276e5=await staff['findOne']({'email':_0x3a5676[_0x48af0a(0x292)]}),_0xc25ce1=_0x4276e5[_0x48af0a(0x219)],_0x3f1313=_0xc25ce1+'-'+_0x201f60+_0xf57da+_0x4da570,_0x5efd7a=await Reference[_0x48af0a(0x28c)]({'referenceNumber':new RegExp('^'+_0x3f1313),'salesman_code':_0xc25ce1})[_0x48af0a(0x300)]({'createdAt':-0x1}),_0x401685=_0x3f1313;_0x5efd7a&&(_0x401685=_0x5efd7a[_0x48af0a(0x33d)]);console['log'](_0x401685);const _0x1c9178=new Reference({'referenceNumber':_0x401685,'staff_id':_0x4eb5c2,'salesman_code':_0xc25ce1});return await _0x1c9178['save'](),_0x401685;}router[a0_0x8d7790(0x2b4)]('/dsrr/pdf',auth,async(_0x3e8fbf,_0xbbb64f)=>{const _0x39014b=a0_0x8d7790,{from_date:_0x86c637,dataview:_0x589e35}=_0x3e8fbf[_0x39014b(0x21b)],_0xcdb5d3=_0x3e8fbf['user'],_0x191fbf=await staff['findOne']({'email':_0xcdb5d3[_0x39014b(0x292)]}),_0x45c530=await master_shop[_0x39014b(0x293)](),_0x201aa6='';var _0x4e40b2=new Date(_0x86c637);const _0x42ae8d={'year':_0x39014b(0x2f4),'month':'long','day':_0x39014b(0x2f4)},_0x4db634=new Intl[(_0x39014b(0x2a0))](_0x39014b(0x260),_0x42ae8d)['format'](_0x4e40b2),_0x3937b1=await Reference['find']({'staff_id':_0x191fbf[_0x39014b(0x294)][_0x39014b(0x264)](),'date_include':_0x86c637});if(_0x3937b1[_0x39014b(0x1de)]>0x0){let _0x444657='';_0x444657+=_0x3937b1[0x0]['html'];if(_0x589e35==_0x39014b(0x2a6)){const _0x17768a=cheerio['load'](_0x444657);let _0x4287fe=[],_0x219f19=[],_0x4b63d2=[];const _0x15f20b=_0x594aa8=>{const _0x3c16c2=_0x39014b,_0x1319a2={'top':{'style':'thick','color':{'rgb':_0x3c16c2(0x25d)}},'bottom':{'style':_0x3c16c2(0x1cb),'color':{'rgb':_0x3c16c2(0x25d)}},'left':{'style':_0x3c16c2(0x1cb),'color':{'rgb':'000000'}},'right':{'style':_0x3c16c2(0x1cb),'color':{'rgb':_0x3c16c2(0x25d)}}};if(_0x594aa8){const _0x3ed028=_0x594aa8[_0x3c16c2(0x221)](';')[_0x3c16c2(0x334)]((_0x26305f,_0x1f7c11)=>{const _0x508a46=_0x3c16c2,[_0x180a91,_0x39dc3a]=_0x1f7c11['split'](':')[_0x508a46(0x303)](_0x3054db=>_0x3054db[_0x508a46(0x33c)]());return _0x26305f[_0x180a91]=_0x39dc3a,_0x26305f;},{});_0x3ed028[_0x3c16c2(0x254)]&&(_0x1319a2[_0x3c16c2(0x245)][_0x3c16c2(0x304)]=_0x3ed028['border-top'][_0x3c16c2(0x261)](_0x3c16c2(0x31a))?_0x3c16c2(0x31a):_0x3c16c2(0x2a4)),_0x3ed028[_0x3c16c2(0x250)]&&(_0x1319a2[_0x3c16c2(0x32d)]['style']=_0x3ed028[_0x3c16c2(0x250)][_0x3c16c2(0x261)](_0x3c16c2(0x31a))?'thin':'medium'),_0x3ed028[_0x3c16c2(0x2bf)]&&(_0x1319a2[_0x3c16c2(0x2b9)][_0x3c16c2(0x304)]=_0x3ed028[_0x3c16c2(0x2bf)][_0x3c16c2(0x261)](_0x3c16c2(0x31a))?_0x3c16c2(0x31a):_0x3c16c2(0x2a4)),_0x3ed028[_0x3c16c2(0x1ed)]&&(_0x1319a2[_0x3c16c2(0x286)][_0x3c16c2(0x304)]=_0x3ed028['border-right'][_0x3c16c2(0x261)]('thin')?_0x3c16c2(0x31a):'medium');}return _0x1319a2;};_0x17768a(_0x39014b(0x316))[_0x39014b(0x207)]((_0x1a113f,_0xe87e0c)=>{const _0x58843a=_0x39014b;let _0x4e0a50=[],_0x45ea87=0x0;while(_0x4b63d2[_0x45ea87]){_0x4b63d2[_0x45ea87]--,_0x45ea87++;}_0x17768a(_0xe87e0c)[_0x58843a(0x293)]('td,\x20th')['each']((_0x349a54,_0x2663cb)=>{const _0x2989aa=_0x58843a;let _0x26a920=_0x17768a(_0x2663cb)[_0x2989aa(0x2bd)]()[_0x2989aa(0x33c)](),_0x56b57a=parseFloat(_0x26a920[_0x2989aa(0x1d2)](/,/g,''));isNaN(_0x56b57a)&&(_0x56b57a=_0x26a920);let _0x42684e=parseInt(_0x17768a(_0x2663cb)[_0x2989aa(0x32b)]('colspan'))||0x1,_0x248e2d=parseInt(_0x17768a(_0x2663cb)[_0x2989aa(0x32b)](_0x2989aa(0x33b)))||0x1;const _0x155f75=_0x17768a(_0x2663cb)[_0x2989aa(0x32b)](_0x2989aa(0x304)),_0xa3d06d=_0x15f20b(_0x155f75);_0x4e0a50[_0x45ea87]={'v':_0x56b57a,'s':{'border':_0xa3d06d}};(_0x42684e>0x1||_0x248e2d>0x1)&&_0x219f19[_0x2989aa(0x230)]({'s':{'r':_0x1a113f,'c':_0x45ea87},'e':{'r':_0x1a113f+_0x248e2d-0x1,'c':_0x45ea87+_0x42684e-0x1}});for(let _0x313dad=0x0;_0x313dad<_0x42684e;_0x313dad++){_0x248e2d>0x1&&(_0x4b63d2[_0x45ea87+_0x313dad]=_0x248e2d-0x1);}_0x45ea87+=_0x42684e;}),_0x4287fe[_0x58843a(0x230)](_0x4e0a50);});const _0x5a860e=XLSX['utils'][_0x39014b(0x267)](),_0x1befd3=XLSX[_0x39014b(0x1fe)][_0x39014b(0x2a1)](_0x4287fe);_0x219f19[_0x39014b(0x1de)]>0x0&&(_0x1befd3[_0x39014b(0x2d8)]=_0x219f19);_0x1befd3[_0x39014b(0x2f0)]=_0x4287fe[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x39014b(0x1fe)][_0x39014b(0x1ce)](_0x5a860e,_0x1befd3,_0x39014b(0x29f));const _0x5d8a5b=XLSX[_0x39014b(0x214)](_0x5a860e,{'bookType':_0x39014b(0x23a),'type':_0x39014b(0x352)});_0xbbb64f[_0x39014b(0x2b3)](_0x39014b(0x30e),_0x39014b(0x249)),_0xbbb64f[_0x39014b(0x2b3)](_0x39014b(0x33a),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0xbbb64f['send'](_0x5d8a5b);}else{let _0x2c57bf='';_0x2c57bf+=_0x444657,_0x2c57bf+=_0x39014b(0x226),_0x2c57bf+=_0x39014b(0x34b),_0x2c57bf+=_0x39014b(0x299),_0x2c57bf+='};',_0x2c57bf+=_0x39014b(0x290),_0xbbb64f[_0x39014b(0x200)](_0x2c57bf);}}else generateReferenceNumber(_0x86c637,_0x191fbf[_0x39014b(0x294)]['valueOf'](),_0xcdb5d3)[_0x39014b(0x28d)](async _0x37df8c=>{const _0x7432f8=_0x39014b,_0x45bd0d=await agentsdataDSICheck_DSRR(_0x86c637,_0x191fbf['_id'][_0x7432f8(0x264)](),_0x201aa6,_0x37df8c);console[_0x7432f8(0x23e)](_0x45bd0d);let _0x2ad26f=_0x7432f8(0x244);_0x2ad26f+=_0x7432f8(0x2a5),_0x2ad26f+=_0x7432f8(0x320),_0x2ad26f+='<table>',_0x2ad26f+=_0x45bd0d,_0x2ad26f+='</table>',_0x2ad26f+=_0x7432f8(0x285),_0x2ad26f+=_0x7432f8(0x285);if(_0x45bd0d[_0x7432f8(0x1de)]>0x0){const _0x30911e=await Reference['findOne']({'staff_id':_0x191fbf[_0x7432f8(0x294)][_0x7432f8(0x264)](),'referenceNumber':_0x37df8c});_0x30911e[_0x7432f8(0x2f2)]=_0x2ad26f,_0x30911e[_0x7432f8(0x1ec)]=_0x86c637,await _0x30911e[_0x7432f8(0x1e4)]();if(_0x589e35=='excel'){const _0x4f6a1f=cheerio[_0x7432f8(0x339)](_0x2ad26f);let _0x5391d2=[],_0x3341f3=[],_0x4a31fb=[];const _0x5c1076=_0x147602=>{const _0xadea1f=_0x7432f8,_0x527a29={'top':{'style':_0xadea1f(0x1cb),'color':{'rgb':_0xadea1f(0x25d)}},'bottom':{'style':_0xadea1f(0x1cb),'color':{'rgb':_0xadea1f(0x25d)}},'left':{'style':_0xadea1f(0x1cb),'color':{'rgb':_0xadea1f(0x25d)}},'right':{'style':'thick','color':{'rgb':_0xadea1f(0x25d)}}};if(_0x147602){const _0x124050=_0x147602[_0xadea1f(0x221)](';')[_0xadea1f(0x334)]((_0x20dfa2,_0x562f2f)=>{const _0x1a7e54=_0xadea1f,[_0x18e55e,_0x151f62]=_0x562f2f['split'](':')[_0x1a7e54(0x303)](_0x5289cb=>_0x5289cb[_0x1a7e54(0x33c)]());return _0x20dfa2[_0x18e55e]=_0x151f62,_0x20dfa2;},{});_0x124050[_0xadea1f(0x254)]&&(_0x527a29[_0xadea1f(0x245)][_0xadea1f(0x304)]=_0x124050[_0xadea1f(0x254)][_0xadea1f(0x261)]('thin')?_0xadea1f(0x31a):_0xadea1f(0x2a4)),_0x124050[_0xadea1f(0x250)]&&(_0x527a29[_0xadea1f(0x32d)][_0xadea1f(0x304)]=_0x124050[_0xadea1f(0x250)]['includes'](_0xadea1f(0x31a))?_0xadea1f(0x31a):_0xadea1f(0x2a4)),_0x124050[_0xadea1f(0x2bf)]&&(_0x527a29['left'][_0xadea1f(0x304)]=_0x124050[_0xadea1f(0x2bf)][_0xadea1f(0x261)]('thin')?_0xadea1f(0x31a):_0xadea1f(0x2a4)),_0x124050[_0xadea1f(0x1ed)]&&(_0x527a29[_0xadea1f(0x286)]['style']=_0x124050['border-right'][_0xadea1f(0x261)](_0xadea1f(0x31a))?_0xadea1f(0x31a):_0xadea1f(0x2a4));}return _0x527a29;};_0x4f6a1f(_0x7432f8(0x316))[_0x7432f8(0x207)]((_0x582b98,_0x4910a8)=>{const _0x55d694=_0x7432f8;let _0x325b7b=[],_0x56323c=0x0;while(_0x4a31fb[_0x56323c]){_0x4a31fb[_0x56323c]--,_0x56323c++;}_0x4f6a1f(_0x4910a8)[_0x55d694(0x293)](_0x55d694(0x234))[_0x55d694(0x207)]((_0xb65bb4,_0xe5534)=>{const _0x124d6a=_0x55d694;let _0x4fe4a1=_0x4f6a1f(_0xe5534)['text']()['trim'](),_0xb1d903=parseFloat(_0x4fe4a1[_0x124d6a(0x1d2)](/,/g,''));isNaN(_0xb1d903)&&(_0xb1d903=_0x4fe4a1);let _0x321728=parseInt(_0x4f6a1f(_0xe5534)[_0x124d6a(0x32b)](_0x124d6a(0x358)))||0x1,_0xb23bdf=parseInt(_0x4f6a1f(_0xe5534)[_0x124d6a(0x32b)](_0x124d6a(0x33b)))||0x1;const _0x24331f=_0x4f6a1f(_0xe5534)[_0x124d6a(0x32b)]('style'),_0x57d9d7=_0x5c1076(_0x24331f);_0x325b7b[_0x56323c]={'v':_0xb1d903,'s':{'border':_0x57d9d7}};(_0x321728>0x1||_0xb23bdf>0x1)&&_0x3341f3[_0x124d6a(0x230)]({'s':{'r':_0x582b98,'c':_0x56323c},'e':{'r':_0x582b98+_0xb23bdf-0x1,'c':_0x56323c+_0x321728-0x1}});for(let _0x23eb0e=0x0;_0x23eb0e<_0x321728;_0x23eb0e++){_0xb23bdf>0x1&&(_0x4a31fb[_0x56323c+_0x23eb0e]=_0xb23bdf-0x1);}_0x56323c+=_0x321728;}),_0x5391d2['push'](_0x325b7b);});const _0x36c526=XLSX['utils'][_0x7432f8(0x267)](),_0xdc3c25=XLSX[_0x7432f8(0x1fe)][_0x7432f8(0x2a1)](_0x5391d2);_0x3341f3[_0x7432f8(0x1de)]>0x0&&(_0xdc3c25[_0x7432f8(0x2d8)]=_0x3341f3);_0xdc3c25[_0x7432f8(0x2f0)]=_0x5391d2[0x0][_0x7432f8(0x303)](()=>({'wpx':0x64})),XLSX[_0x7432f8(0x1fe)][_0x7432f8(0x1ce)](_0x36c526,_0xdc3c25,_0x7432f8(0x29f));const _0x92fea9=XLSX[_0x7432f8(0x214)](_0x36c526,{'bookType':'xlsx','type':_0x7432f8(0x352)});_0xbbb64f[_0x7432f8(0x2b3)](_0x7432f8(0x30e),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0xbbb64f[_0x7432f8(0x2b3)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0xbbb64f[_0x7432f8(0x200)](_0x92fea9);}else _0x2ad26f+=_0x7432f8(0x226),_0x2ad26f+=_0x7432f8(0x34b),_0x2ad26f+=_0x7432f8(0x299),_0x2ad26f+='};',_0x2ad26f+=_0x7432f8(0x290),_0xbbb64f[_0x7432f8(0x200)](_0x2ad26f);}else await Reference['deleteOne']({'referenceNumber':_0x37df8c}),_0x3e8fbf[_0x7432f8(0x32c)](_0x7432f8(0x256),_0x7432f8(0x237)),_0xbbb64f[_0x7432f8(0x1f2)](_0x7432f8(0x1cf));})[_0x39014b(0x2da)](console['error']);}),router[a0_0x8d7790(0x2c6)]('/dsrr_admin/view',auth,async(_0x12e7f4,_0x3ade25)=>{const _0x1aa7f0=a0_0x8d7790;try{const {username:_0x4608d9,email:_0x169a79,role:_0xb6ad7c}=_0x12e7f4[_0x1aa7f0(0x1c9)],_0x21711d=_0x12e7f4[_0x1aa7f0(0x1c9)],_0x514e19=await profile[_0x1aa7f0(0x28c)]({'email':_0x21711d[_0x1aa7f0(0x292)]}),_0x4825a3={'year':_0x1aa7f0(0x2f4),'month':_0x1aa7f0(0x242),'day':_0x1aa7f0(0x2f4)},_0x55ed1f=await master_shop[_0x1aa7f0(0x293)]();console[_0x1aa7f0(0x23e)]('Products\x20master',_0x55ed1f);const _0x3d7cd0=await product[_0x1aa7f0(0x293)]();console['log']('Products\x20find_data',_0x3d7cd0);const _0x11041b=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':_0x1aa7f0(0x1e6),'as':_0x1aa7f0(0x31c)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x1aa7f0(0x258),'product_stock':_0x1aa7f0(0x2e4)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x1aa7f0(0x2fc)}}}]);console['log'](_0x1aa7f0(0x1ee),_0x11041b),_0x11041b['forEach'](_0x57371e=>{const _0x1a806a=_0x1aa7f0,_0x208f21=_0x3d7cd0[_0x1a806a(0x303)](_0x2db288=>{const _0x4ba0ae=_0x1a806a;_0x2db288[_0x4ba0ae(0x1e6)]==_0x57371e['_id']&&(_0x2db288['stock']=parseInt(_0x2db288[_0x4ba0ae(0x33e)])+parseInt(_0x57371e['product_stock']));});});const _0x12bedc=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x2bd54b=await staff[_0x1aa7f0(0x28c)]({'email':_0x21711d[_0x1aa7f0(0x292)]});if(_0x55ed1f[0x0][_0x1aa7f0(0x361)]=='English\x20(US)')var _0x2d54e9=users[_0x1aa7f0(0x332)];else{if(_0x55ed1f[0x0][_0x1aa7f0(0x361)]==_0x1aa7f0(0x2d1))var _0x2d54e9=users[_0x1aa7f0(0x2d1)];else{if(_0x55ed1f[0x0]['language']==_0x1aa7f0(0x2db))var _0x2d54e9=users[_0x1aa7f0(0x2db)];else{if(_0x55ed1f[0x0][_0x1aa7f0(0x361)]==_0x1aa7f0(0x324))var _0x2d54e9=users[_0x1aa7f0(0x324)];else{if(_0x55ed1f[0x0][_0x1aa7f0(0x361)]=='French')var _0x2d54e9=users['French'];else{if(_0x55ed1f[0x0][_0x1aa7f0(0x361)]==_0x1aa7f0(0x209))var _0x2d54e9=users['Portuguese'];else{if(_0x55ed1f[0x0]['language']=='Chinese')var _0x2d54e9=users[_0x1aa7f0(0x30b)];else{if(_0x55ed1f[0x0][_0x1aa7f0(0x361)]==_0x1aa7f0(0x1db))var _0x2d54e9=users[_0x1aa7f0(0x1d6)];}}}}}}}_0x3ade25[_0x1aa7f0(0x29d)](_0x1aa7f0(0x2f9),{'success':_0x12e7f4[_0x1aa7f0(0x32c)](_0x1aa7f0(0x30c)),'errors':_0x12e7f4[_0x1aa7f0(0x32c)](_0x1aa7f0(0x256)),'alldata':_0x3d7cd0,'profile':_0x514e19,'master_shop':_0x55ed1f,'role':_0x21711d,'product_stock':_0x11041b,'language':_0x2d54e9,'staff_arr':_0x2bd54b,'staff_data_all':_0x12bedc});}catch(_0x2cc5c5){}}),router[a0_0x8d7790(0x2b4)](a0_0x8d7790(0x2c4),auth,async(_0x363bab,_0x21f7ef)=>{const _0x5b901e=a0_0x8d7790;try{const {from:_0x387e0a,to:_0x1f6cf3,staff_data:_0x5dee0b}=_0x363bab['body'],_0x9c6c83=await Reference[_0x5b901e(0x2c1)]([{'$match':{'date_include':{'$gte':_0x387e0a,'$lte':_0x1f6cf3},'staff_id':_0x5dee0b}},{'$sort':{'date_include':0x1}}]);_0x21f7ef[_0x5b901e(0x34a)](_0x9c6c83);}catch(_0x54dc0a){_0x21f7ef[_0x5b901e(0x34a)](_0x54dc0a);}}),router[a0_0x8d7790(0x2b4)](a0_0x8d7790(0x203),auth,async(_0x2b0188,_0x35bc37)=>{const _0x1a20a6=a0_0x8d7790;try{const {from:_0x57bca7,to:_0x292d7a}=_0x2b0188[_0x1a20a6(0x21b)],{sttaff_id:_0x51b2c3}=_0x2b0188[_0x1a20a6(0x1c9)],_0x52da6b=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x57bca7,'$lte':_0x292d7a},'staff_id':_0x51b2c3}},{'$sort':{'date_include':0x1}}]);_0x35bc37[_0x1a20a6(0x34a)](_0x52da6b);}catch(_0x3755dc){_0x35bc37[_0x1a20a6(0x34a)](_0x3755dc);}}),router[a0_0x8d7790(0x2c6)](a0_0x8d7790(0x1d8),auth,async(_0xbcc578,_0x337db3)=>{const _0x5bd2e1=a0_0x8d7790;try{const _0x141c80=_0xbcc578[_0x5bd2e1(0x28f)]['id'],_0xfc2464=await Reference[_0x5bd2e1(0x1e9)](_0x141c80);let _0x5baf70='';_0x5baf70+=_0xfc2464[_0x5bd2e1(0x2f2)],_0x5baf70+='<script>',_0x5baf70+=_0x5bd2e1(0x34b),_0x5baf70+='window.print();',_0x5baf70+='};',_0x5baf70+=_0x5bd2e1(0x290),_0x337db3['send'](_0x5baf70);}catch(_0x47898a){_0x337db3[_0x5bd2e1(0x34a)](_0x47898a);}}),router[a0_0x8d7790(0x2b4)]('/dl_excel',auth,async(_0x59e127,_0x307b8d)=>{const _0x217a96=a0_0x8d7790;try{const {ref_data:_0x545b3d}=_0x59e127[_0x217a96(0x21b)],_0x3b5eee=_0x545b3d[_0x217a96(0x221)]('~'),_0x229f2a=_0x3b5eee[_0x217a96(0x354)](_0x4699f1=>_0x4699f1!==''),_0x5a353e=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x229f2a}}}]),_0x4cd08d=XLSX['utils'][_0x217a96(0x267)]();_0x5a353e[_0x217a96(0x22b)](_0x55bc77=>{const _0x3930b6=_0x217a96,_0x595caa=cheerio[_0x3930b6(0x339)](_0x55bc77['html']);let _0x41e15d=[],_0x4aab92=[],_0xe34ca7=[];_0x595caa(_0x3930b6(0x316))['each']((_0x43b3c8,_0x130709)=>{const _0x4fe0f5=_0x3930b6;let _0x3cf1fe=[],_0xc59a47=0x0;while(_0xe34ca7[_0xc59a47]){_0xe34ca7[_0xc59a47]--,_0xc59a47++;}_0x595caa(_0x130709)[_0x4fe0f5(0x293)](_0x4fe0f5(0x234))[_0x4fe0f5(0x207)]((_0x15bcbc,_0x3998f6)=>{const _0x5c143c=_0x4fe0f5;let _0x100190=_0x595caa(_0x3998f6)[_0x5c143c(0x2bd)]()[_0x5c143c(0x33c)](),_0x563a94=parseFloat(_0x100190[_0x5c143c(0x1d2)](/,/g,''));isNaN(_0x563a94)&&(_0x563a94=_0x100190);let _0x443e6d=parseInt(_0x595caa(_0x3998f6)[_0x5c143c(0x32b)]('colspan'))||0x1,_0x61b3b5=parseInt(_0x595caa(_0x3998f6)[_0x5c143c(0x32b)](_0x5c143c(0x33b)))||0x1;_0x3cf1fe[_0xc59a47]=_0x563a94;(_0x443e6d>0x1||_0x61b3b5>0x1)&&_0x4aab92[_0x5c143c(0x230)]({'s':{'r':_0x43b3c8,'c':_0xc59a47},'e':{'r':_0x43b3c8+_0x61b3b5-0x1,'c':_0xc59a47+_0x443e6d-0x1}});for(let _0xed68e0=0x0;_0xed68e0<_0x443e6d;_0xed68e0++){_0x61b3b5>0x1&&(_0xe34ca7[_0xc59a47+_0xed68e0]=_0x61b3b5-0x1);}_0xc59a47+=_0x443e6d;}),_0x41e15d['push'](_0x3cf1fe);});const _0x4df668=XLSX['utils'][_0x3930b6(0x2a1)](_0x41e15d);_0x4aab92[_0x3930b6(0x1de)]>0x0&&(_0x4df668[_0x3930b6(0x2d8)]=_0x4aab92),_0x4df668[_0x3930b6(0x2f0)]=_0x41e15d[0x0][_0x3930b6(0x303)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x4cd08d,_0x4df668,_0x55bc77[_0x3930b6(0x33d)]);});const _0x45e1b9=XLSX[_0x217a96(0x214)](_0x4cd08d,{'bookType':'xlsx','type':_0x217a96(0x352)});_0x307b8d[_0x217a96(0x2b3)]('Content-Disposition',_0x217a96(0x328)),_0x307b8d[_0x217a96(0x2b3)](_0x217a96(0x33a),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x307b8d['send'](_0x45e1b9);}catch(_0x3bbbf8){_0x307b8d[_0x217a96(0x34a)](_0x3bbbf8);}}),router[a0_0x8d7790(0x2b4)](a0_0x8d7790(0x356),auth,async(_0xeacc53,_0x948cd1)=>{const _0xa39f86=a0_0x8d7790,{from_date:_0xb3e95d,agent_id:_0x3e0a4b}=_0xeacc53[_0xa39f86(0x21b)],_0x5b8923=_0xeacc53[_0xa39f86(0x1c9)],_0x40d851=await staff[_0xa39f86(0x28c)]({'email':_0x5b8923[_0xa39f86(0x292)]}),_0x2576a5=await master_shop['find'](),_0x3054bf=await agentsdataDSICheck_DSRR(_0xb3e95d,_0x3e0a4b,_0x6d9c59);let _0x52e863=_0xa39f86(0x281);var _0x38e4bc=new Date(_0xb3e95d);const _0x1833d={'year':_0xa39f86(0x2f4),'month':'long','day':_0xa39f86(0x2f4)},_0x4f8550=new Intl[(_0xa39f86(0x2a0))]('en-US',_0x1833d)['format'](_0x38e4bc);_0x52e863+=_0xa39f86(0x2a5),_0x52e863+='<div\x20\x20id=\x22table-conatainer\x22>',_0x52e863+=_0xa39f86(0x330),_0x52e863+=_0x3054bf,_0x52e863+=_0xa39f86(0x2c0),_0x52e863+=_0xa39f86(0x285),_0x52e863+=_0xa39f86(0x285);let _0xcc1b44=_0xa39f86(0x347);const _0x101b86={'width':'15in','height':_0xa39f86(0x20c),'orientation':_0xa39f86(0x2d2),'border':{'top':'0.1in','right':_0xa39f86(0x201),'bottom':_0xa39f86(0x201),'left':'0.1in'},'header':{'height':_0xa39f86(0x1d5),'contents':_0xa39f86(0x351)+_0xcc1b44+_0xa39f86(0x2b0)+_0x4f8550+_0xa39f86(0x2ec)},'footer':{'height':_0xa39f86(0x238),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0xa39f86(0x26e)}}};var _0x6d9c59='on';if(_0x6d9c59=='on'){const _0x13428f=cheerio[_0xa39f86(0x339)](_0x52e863);let _0x169196=[],_0x5c4223=[],_0x523ad7=[];_0x13428f('table\x20tr')[_0xa39f86(0x207)]((_0x195456,_0x536ba6)=>{const _0x54c310=_0xa39f86;let _0x3ffa2d=[],_0x431b7d=0x0;while(_0x523ad7[_0x431b7d]){_0x523ad7[_0x431b7d]--,_0x431b7d++;}_0x13428f(_0x536ba6)['find'](_0x54c310(0x234))[_0x54c310(0x207)]((_0x24e18d,_0xf63a3b)=>{const _0x3c21aa=_0x54c310;let _0x1ea6d8=_0x13428f(_0xf63a3b)[_0x3c21aa(0x2bd)]()['trim'](),_0x312e48=parseFloat(_0x1ea6d8[_0x3c21aa(0x1d2)](/,/g,''));isNaN(_0x312e48)&&(_0x312e48=_0x1ea6d8);let _0x29dd92=parseInt(_0x13428f(_0xf63a3b)[_0x3c21aa(0x32b)](_0x3c21aa(0x358)))||0x1,_0x3b20db=parseInt(_0x13428f(_0xf63a3b)[_0x3c21aa(0x32b)](_0x3c21aa(0x33b)))||0x1;_0x3ffa2d[_0x431b7d]=_0x312e48;(_0x29dd92>0x1||_0x3b20db>0x1)&&_0x5c4223[_0x3c21aa(0x230)]({'s':{'r':_0x195456,'c':_0x431b7d},'e':{'r':_0x195456+_0x3b20db-0x1,'c':_0x431b7d+_0x29dd92-0x1}});for(let _0x28e516=0x0;_0x28e516<_0x29dd92;_0x28e516++){_0x3b20db>0x1&&(_0x523ad7[_0x431b7d+_0x28e516]=_0x3b20db-0x1);}_0x431b7d+=_0x29dd92;}),_0x169196[_0x54c310(0x230)](_0x3ffa2d);});const _0x51bd2a=XLSX[_0xa39f86(0x1fe)]['book_new'](),_0x523069=XLSX[_0xa39f86(0x1fe)]['aoa_to_sheet'](_0x169196);_0x5c4223['length']>0x0&&(_0x523069[_0xa39f86(0x2d8)]=_0x5c4223);_0x523069[_0xa39f86(0x2f0)]=_0x169196[0x0][_0xa39f86(0x303)](()=>({'wpx':0x64})),XLSX[_0xa39f86(0x1fe)][_0xa39f86(0x1ce)](_0x51bd2a,_0x523069,'Sales\x20Report');const _0x4d43b6=XLSX[_0xa39f86(0x214)](_0x51bd2a,{'bookType':_0xa39f86(0x23a),'type':_0xa39f86(0x352)});_0x948cd1[_0xa39f86(0x2b3)]('Content-Disposition',_0xa39f86(0x249)),_0x948cd1[_0xa39f86(0x2b3)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x948cd1[_0xa39f86(0x200)](_0x4d43b6);}else pdf[_0xa39f86(0x313)](_0x52e863,_0x101b86)['toStream'](function(_0x1b0ba1,_0x48fc09){const _0x3112bb=_0xa39f86;if(_0x1b0ba1){_0x948cd1[_0x3112bb(0x2fa)](0x1f4)['send'](_0x3112bb(0x211));return;}_0x948cd1['setHeader'](_0x3112bb(0x33a),_0x3112bb(0x2b6)),_0x48fc09['pipe'](_0x948cd1);});}),module[a0_0x8d7790(0x25f)]=router;