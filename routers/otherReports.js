const a0_0x44e325=a0_0x4377;(function(_0xf7c783,_0x2994a8){const _0x5eeb7e=a0_0x4377,_0x4f5d1d=_0xf7c783();while(!![]){try{const _0x329a35=-parseInt(_0x5eeb7e(0x1c5))/0x1+parseInt(_0x5eeb7e(0x301))/0x2+parseInt(_0x5eeb7e(0x1c2))/0x3*(parseInt(_0x5eeb7e(0x1ac))/0x4)+-parseInt(_0x5eeb7e(0x2fe))/0x5+-parseInt(_0x5eeb7e(0x237))/0x6+parseInt(_0x5eeb7e(0x23d))/0x7+-parseInt(_0x5eeb7e(0x22e))/0x8*(-parseInt(_0x5eeb7e(0x243))/0x9);if(_0x329a35===_0x2994a8)break;else _0x4f5d1d['push'](_0x4f5d1d['shift']());}catch(_0x5738e7){_0x4f5d1d['push'](_0x4f5d1d['shift']());}}}(a0_0xeddb,0x2cb5e));function a0_0xeddb(){const _0x3cae7f=['<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','$name','body','<td\x20colspan=\x223\x22><b>TOTAL<b>','<table>','cheerio','$bank','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','includes','$totalGross','Error\x20generating\x20PDF','thin','long','Products\x20master','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','left','<th\x20rowspan=\x272\x27>Products</th>','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','brandCount','539944CVPsTF','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$check_no','</tbody>','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','<th>X-Truck</th>','totalQTYsum','valueOf','$product','1546452ZfALtk','setHeader','/inventory_sum/pdf','book_append_sheet','$category','getDate','6363maRqpu','../middleware/auth','products','excel','mongoose','adj_discount','63HRRyVG','/agent_reports/view','render','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','\x20-\x20STD','<th>Booking</th>','NumberFormat','top','<p>FINISHED\x20GOODS\x20INVENTORY</p>','slice','true','length','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','$_id.status_data','cat_brand','/getDSSR_no','totalQty','thick','exceljs','product_details.product_name','trim','isFG','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','$product_info.name','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','sales_bkg','json','ObjectId','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','$sales_staff_id','$sale_product.product_code','Router','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','dsi','get','NetPrice','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','<div\x20class=\x22col-sm-11\x22>','$brand','html-pdf','/dsrr_admin/view_data/:id','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','$sale_product.quantity','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','../public/language/languages.json','$cash','xlsx','save','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','jsbarcode','Products\x20find_data','findById','$product.product_code','$products.product_details','$sales_info._id','brand','check_no','!cols','totalQTY','Portuguese\x20(BR)','$status_data','setDate','format','sumqty','$product_name','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','path','numeric','toStream','$sale_product.isFG','aoa_to_sheet','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','find','<td\x20class=\x22cat_data\x22></td>','/balance/view','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','$products.product_details.brand','<th>\x20BEG\x20BALANCE\x20</th>','due_date','$product.quantity','German','agent_sales','toISOString','/total_sales_reports/pdf','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','load','product_details','push','each','findOne','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','$_id.dsi','$products.product_details.category','post','errors','forEach','category','sales_info','<div\x20class=\x22row\x22>','$product_info.category','getFullYear','$_id.brand','$product_list.product_stock','<script>','error','border-left','</thead>','Sales\x20Report','amount','$adj_discount','reduce','Hindi','Letter','$products.qty','/dev/null','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','$product_stock','map','split','express/lib/response','redirect','attachment;\x20filename=\x22sales_report.xlsx\x22','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','/agent_reports/pdf','$product_details.product_stock','sales_reports','cash','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','beg_bal','/dsrr_admin/pdf_admin','\x22\x20class=\x22cat_data\x22>','toLocaleString','staffs','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','$products.product_details.prod_id','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','window.onload\x20=\x20function()\x20{','$totalQty','sales_ext','$products.discount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','filter','\x20-\x20HH','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','/inventory_sum/view','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','product_info','$product_details','$sale_product.prod_cat','write','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','\x22><b></b></td>','$amount','$sale_product.real_qty_unit_val','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','status','customer','border-top','salesman_data','<td\x20class=\x22row_data\x22>0</td>','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','Spanish','<tr>','utils','$product_list.product_code','$product_info.gross_price','<th>\x20ENDING\x20BALANCE\x20</th>','html','date','Arabic','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','<td\x20class=\x22row_data\x22>','$_id.category','Content-Disposition','pipe','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20class=\x22row_data\x22><b>','$product_info','1621085hkSfRJ','$discount','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','329786ZCdCza','$sale_product','table\x20tr','$sale_product.product_name','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','</div>','totalGross','$products.adj_discount','create','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','user','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','balanced','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','$sale_product.adj_discount','<th\x20rowspan=\x272\x27>Category</th>','<th>\x20ITEM\x20CODE\x20</th>','email','PDF\x20Generation\x20Error:','</tr>','$products.product_details.gross_price','!merges','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','product_stock','bank','<p>INVENTORY\x20SUMMARY</p>','bottom','Checking:\x20','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','Standard','$dsi','medium','toFixed','/agent/view','Content-Type','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','rowspan','</table>','totalPrice','$product_list','product_code','replace','</th>','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','/dsrr_admin/view','prod_cat','landscape','$product_docs','$product_code','dataqty','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<th\x20rowspan=\x272\x27>Production</th>','/dsrr/view','success','\x22><b>','name','Products\x20warehouse_data','<td\x20class=\x22cat_data\x22>','$product_info.product_code','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','146788hwfYgN','<h1>JAKA\x20EQUITIES\x20CORP</h1>','15in','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','dsi_sales_admin','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','$sale_product._id','$sale_product.totalprice','000000','discount','$products','/reports/dsrr/view','book_new','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','multer','$product_info.brand','$sales_info','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','colspan','buffer','20mm','27yVbhHu','border-right','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','203433FyIvqS','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','right','attr','Arabic\x20(ae)','8.5in','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','$date','text','<thead>','/getDSSR_no_sales','date_include','$products.NetPrice','$_id.customer','border-bottom','catch','$_id.date','dssr_view_admin','aggregate','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','$product_details.product_name','qty','Types','60mm','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','<div\x20\x20id=\x22table-conatainer\x22>','language','isArray','product_docs','_id','inventory_sum','send','flash','$NetPrice','$sale_product.discount','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','product_name','French','dssr_view','0.1in','style','<th>\x20INCOMING\x20</th>','</p>','td,\x20th','</script>','window.print();','getMonth','<div\x20style=\x22page-break-before:\x20always;\x22></div>','sort','<p>','sales_staff_id','</b></td>','<th>\x20SALES\x20</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','log','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','English\x20(US)','</td>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','<td\x20class=\x22row_data\x22></td>','English','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','application/pdf','DateTimeFormat','$customer','Asia/Manila','sale_product.product_code','Chinese','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','toLocaleDateString','referenceNumber','<tbody>','Portuguese','false','en-US','note','\x20-\x20','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','<td\x20colspan=\x22','blob-stream','/balance/pdf','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','/total_sales_reports/view','$due_date'];a0_0xeddb=function(){return _0x3cae7f;};return a0_0xeddb();}const express=require('express'),res=require(a0_0x44e325(0x2c1)),app=express(),router=express[a0_0x44e325(0x264)](),multer=require(a0_0x44e325(0x1bb)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require(a0_0x44e325(0x23e)),users=require(a0_0x44e325(0x274)),excelJS=require(a0_0x44e325(0x256)),XLSX=require(a0_0x44e325(0x276)),PDFDocument=require('pdfkit-table'),fs=require('fs'),blobStream=require(a0_0x44e325(0x216)),JsBarcode=require(a0_0x44e325(0x27a)),{Canvas}=require('canvas'),pdf=require(a0_0x44e325(0x26f)),path=require(a0_0x44e325(0x28c)),mongoose=require(a0_0x44e325(0x241)),cheerio=require(a0_0x44e325(0x220));router[a0_0x44e325(0x268)](a0_0x44e325(0x294),auth,async(_0xe4fec8,_0x24ce18)=>{const _0x535936=a0_0x44e325;try{const {username:_0xc05daf,email:_0x1ae7a6,role:_0x2e9287}=_0xe4fec8['user'],_0x561d06=_0xe4fec8[_0x535936(0x30b)],_0x3123d9=await profile[_0x535936(0x2a3)]({'email':_0x561d06['email']}),_0x4d2912={'year':'numeric','month':_0x535936(0x227),'day':_0x535936(0x28d)},_0x27aa3e=await master_shop[_0x535936(0x292)]();console[_0x535936(0x1fc)]('Products\x20master',_0x27aa3e);const _0xf40614=await product[_0x535936(0x292)]();console['log']('Products\x20find_data',_0xf40614);const _0x567049=await warehouse[_0x535936(0x1d7)]([{'$unwind':_0x535936(0x2df)},{'$lookup':{'from':_0x535936(0x23f),'localField':_0x535936(0x257),'foreignField':'name','as':_0x535936(0x1e2)}},{'$unwind':_0x535936(0x332)},{'$project':{'product_name':_0x535936(0x1d9),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x535936(0x289),'product_stock':{'$sum':_0x535936(0x2be)}}}]);console[_0x535936(0x1fc)]('Products\x20warehouse_data',_0x567049),_0x567049['forEach'](_0x100884=>{const _0x272f1e=_0x535936,_0x365b59=_0xf40614[_0x272f1e(0x2bf)](_0x3c9e8d=>{const _0x4e5907=_0x272f1e;_0x3c9e8d[_0x4e5907(0x1a7)]==_0x100884[_0x4e5907(0x1e3)]&&(_0x3c9e8d[_0x4e5907(0x26b)]=parseInt(_0x3c9e8d[_0x4e5907(0x26b)])+parseInt(_0x100884[_0x4e5907(0x319)]));});}),console[_0x535936(0x1fc)](_0x535936(0x27b),_0xf40614);if(_0x27aa3e[0x0]['language']==_0x535936(0x1ff))var _0x32dc23=users[_0x535936(0x203)];else{if(_0x27aa3e[0x0][_0x535936(0x1e0)]==_0x535936(0x2b9))var _0x32dc23=users[_0x535936(0x2b9)];else{if(_0x27aa3e[0x0][_0x535936(0x1e0)]==_0x535936(0x29a))var _0x32dc23=users[_0x535936(0x29a)];else{if(_0x27aa3e[0x0]['language']==_0x535936(0x2ed))var _0x32dc23=users[_0x535936(0x2ed)];else{if(_0x27aa3e[0x0][_0x535936(0x1e0)]==_0x535936(0x1eb))var _0x32dc23=users[_0x535936(0x1eb)];else{if(_0x27aa3e[0x0][_0x535936(0x1e0)]=='Portuguese\x20(BR)')var _0x32dc23=users['Portuguese'];else{if(_0x27aa3e[0x0]['language']==_0x535936(0x20a))var _0x32dc23=users['Chinese'];else{if(_0x27aa3e[0x0]['language']==_0x535936(0x1c9))var _0x32dc23=users['Arabic'];}}}}}}}_0x24ce18['render'](_0x535936(0x30d),{'success':_0xe4fec8[_0x535936(0x1e6)]('success'),'errors':_0xe4fec8['flash'](_0x535936(0x2a8)),'alldata':_0xf40614,'profile':_0x3123d9,'master_shop':_0x27aa3e,'role':_0x561d06,'product_stock':_0x567049,'language':_0x32dc23});}catch(_0x51484f){}});async function dataCheck(_0x5e669d,_0x41b10c){const _0x35d19d=a0_0x44e325,_0x1e95f8=await product['aggregate']([{'$group':{'_id':{'brand':_0x35d19d(0x26e),'category':_0x35d19d(0x23b)},'products':{'$push':{'name':_0x35d19d(0x21c),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x329f5d=[];_0x329f5d[_0x35d19d(0x252)]=[];for(let _0x56f7d7=0x0;_0x56f7d7<=_0x1e95f8['length']-0x1;_0x56f7d7++){const _0x5c96a8=_0x1e95f8[_0x56f7d7];_0x329f5d['cat_brand']['push'](_0x5c96a8);}const _0x54e6da=await product[_0x35d19d(0x1d7)]([{'$group':{'_id':{'category':_0x35d19d(0x23b)},'products':{'$push':{'brand':_0x35d19d(0x26e),'product_code':_0x35d19d(0x333),'product_name':_0x35d19d(0x21c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x924e8a=await purchases_finished[_0x35d19d(0x1d7)]([{'$match':{'date':{'$gte':_0x5e669d,'$lte':_0x41b10c}}},{'$unwind':_0x35d19d(0x236)},{'$group':{'_id':{'product_name':'$product.product_name','product_code':_0x35d19d(0x27d)},'totalQTY':{'$sum':_0x35d19d(0x299)}}}]);_0x329f5d[_0x35d19d(0x2cb)]=[];for(let _0x5e3570=0x0;_0x5e3570<=_0x924e8a[_0x35d19d(0x24f)]-0x1;_0x5e3570++){const _0x46a364=_0x924e8a[_0x5e3570];_0x329f5d[_0x35d19d(0x2cb)][_0x35d19d(0x2a1)](_0x46a364);}const _0x37ccfb=await sales_sa[_0x35d19d(0x1d7)]([{'$match':{'date':{'$gte':_0x5e669d,'$lte':_0x41b10c}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x35d19d(0x262)}}},{'$lookup':{'from':'staffs','localField':_0x35d19d(0x1f8),'foreignField':_0x35d19d(0x1e3),'as':_0x35d19d(0x2ab)}},{'$unwind':_0x35d19d(0x1bd)},{'$unwind':_0x35d19d(0x302)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x35d19d(0x304),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x35d19d(0x272)}}}]);console[_0x35d19d(0x1fc)](_0x37ccfb[0x0]),_0x329f5d[_0x35d19d(0x25e)]=[];for(let _0x1ee3e0=0x0;_0x1ee3e0<=_0x37ccfb[_0x35d19d(0x24f)]-0x1;_0x1ee3e0++){const _0x208526=_0x37ccfb[_0x1ee3e0];_0x329f5d[_0x35d19d(0x25e)][_0x35d19d(0x2a1)](_0x208526);}const _0x1e85e4=await sales_sa[_0x35d19d(0x1d7)]([{'$match':{'date':{'$gte':_0x5e669d,'$lte':_0x41b10c}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x35d19d(0x262)}}},{'$lookup':{'from':_0x35d19d(0x2cf),'localField':_0x35d19d(0x1f8),'foreignField':_0x35d19d(0x1e3),'as':'sales_info'}},{'$unwind':_0x35d19d(0x1bd)},{'$unwind':_0x35d19d(0x302)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x35d19d(0x210)}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x35d19d(0x263)},'totalQTY':{'$sum':_0x35d19d(0x2e5)}}}]);_0x329f5d['sales_ext']=[];for(let _0x153dc5=0x0;_0x153dc5<=_0x1e85e4['length']-0x1;_0x153dc5++){const _0x461390=_0x1e85e4[_0x153dc5];_0x329f5d[_0x35d19d(0x2d6)][_0x35d19d(0x2a1)](_0x461390);}let _0x1d7bf8='';for(let _0x573b26=0x0;_0x573b26<=_0x54e6da[_0x35d19d(0x24f)]-0x1;_0x573b26++){const _0x59f6df=_0x54e6da[_0x573b26];_0x1d7bf8+=_0x35d19d(0x2ee),_0x1d7bf8+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x59f6df[_0x35d19d(0x1e3)]['category']+'</td>',_0x1d7bf8+=_0x35d19d(0x314);for(let _0x872a73=0x0;_0x872a73<_0x329f5d['cat_brand'][_0x35d19d(0x24f)];_0x872a73++){const _0x122ec7=_0x329f5d[_0x35d19d(0x252)][_0x872a73];if(_0x122ec7[_0x35d19d(0x1e3)][_0x35d19d(0x2aa)]==_0x59f6df['_id'][_0x35d19d(0x2aa)]){let _0x161955=[],_0x3565ec=[],_0x1e3ab9=[];_0x161955[_0x122ec7[_0x35d19d(0x1e3)]['brand']]=[],_0x3565ec[_0x122ec7[_0x35d19d(0x1e3)][_0x35d19d(0x280)]]=[],_0x1e3ab9[_0x122ec7['_id']['brand']]=[];var _0x115228=0x0,_0x5f476c=0x0,_0x205920=0x0;for(let _0x1b291d=0x0;_0x1b291d<_0x122ec7[_0x35d19d(0x23f)]['length'];_0x1b291d++){const _0xee386b=_0x122ec7[_0x35d19d(0x23f)][_0x1b291d];for(let _0x422f03=0x0;_0x422f03<=_0x329f5d[_0x35d19d(0x2cb)][_0x35d19d(0x24f)]-0x1;_0x422f03++){const _0x41d02b=_0x329f5d[_0x35d19d(0x2cb)][_0x422f03];_0x41d02b[_0x35d19d(0x1e3)]['product_name']==_0xee386b[_0x35d19d(0x1a7)]&&_0x41d02b[_0x35d19d(0x1e3)]['product_code']==_0xee386b[_0x35d19d(0x32b)]&&(_0x115228+=parseInt(_0x41d02b['totalQTY'],0xa));}for(let _0x4597a0=0x0;_0x4597a0<=_0x329f5d[_0x35d19d(0x2d6)][_0x35d19d(0x24f)]-0x1;_0x4597a0++){const _0x356f26=_0x329f5d[_0x35d19d(0x2d6)][_0x4597a0];_0x356f26[_0x35d19d(0x1e3)][_0x35d19d(0x1ea)]==_0xee386b[_0x35d19d(0x1a7)]&&_0x356f26[_0x35d19d(0x1e3)]['product_code']==_0xee386b[_0x35d19d(0x32b)]&&(_0x5f476c+=parseFloat(_0x356f26['totalQTY'],0xa)['toFixed'](0x2));}for(let _0x147f87=0x0;_0x147f87<=_0x329f5d[_0x35d19d(0x25e)][_0x35d19d(0x24f)]-0x1;_0x147f87++){const _0x41ffd9=_0x329f5d[_0x35d19d(0x25e)][_0x147f87];_0x41ffd9['_id'][_0x35d19d(0x1ea)]==_0xee386b[_0x35d19d(0x1a7)]&&_0x41ffd9[_0x35d19d(0x1e3)][_0x35d19d(0x32b)]==_0xee386b[_0x35d19d(0x32b)]&&(_0x205920+=parseInt(_0x41ffd9['totalQTY'],0xa));}}const _0x22f58d=new Intl[(_0x35d19d(0x24a))](_0x35d19d(0x211));var _0x9b9202=_0x22f58d[_0x35d19d(0x287)](_0x115228);_0x161955[_0x122ec7['_id']['brand']][_0x35d19d(0x2a1)](_0x9b9202),_0x3565ec[_0x122ec7[_0x35d19d(0x1e3)]['brand']][_0x35d19d(0x2a1)](_0x22f58d[_0x35d19d(0x287)](_0x5f476c)),_0x1e3ab9[_0x122ec7[_0x35d19d(0x1e3)][_0x35d19d(0x280)]][_0x35d19d(0x2a1)](_0x22f58d[_0x35d19d(0x287)](_0x205920));var _0x2e9422=_0x22f58d[_0x35d19d(0x287)](_0x115228-(_0x205920+_0x5f476c));_0x1d7bf8+=_0x35d19d(0x2ee),_0x1d7bf8+=_0x35d19d(0x202),_0x1d7bf8+=_0x35d19d(0x2f7)+_0x122ec7[_0x35d19d(0x1e3)][_0x35d19d(0x280)]+'</td>',_0x1d7bf8+=_0x35d19d(0x2f7)+_0x161955[_0x122ec7['_id'][_0x35d19d(0x280)]][0x0]+'</td>',_0x1d7bf8+=_0x35d19d(0x2eb),_0x1d7bf8+=_0x35d19d(0x2f7)+_0x1e3ab9[_0x122ec7[_0x35d19d(0x1e3)][_0x35d19d(0x280)]][0x0]+'</td>',_0x1d7bf8+=_0x35d19d(0x2f7)+_0x3565ec[_0x122ec7[_0x35d19d(0x1e3)][_0x35d19d(0x280)]][0x0]+_0x35d19d(0x200),_0x1d7bf8+=_0x35d19d(0x2f7)+_0x2e9422+_0x35d19d(0x200),_0x1d7bf8+='</tr>';}}}return console[_0x35d19d(0x1fc)](_0x329f5d['sales_bkg']),_0x1d7bf8;}router[a0_0x44e325(0x2a7)](a0_0x44e325(0x217),auth,async(_0x2708d2,_0x441959)=>{const _0xa7d1c1=a0_0x44e325,{from_date:_0x29ff0f,to_date:_0x41a794}=_0x2708d2[_0xa7d1c1(0x21d)],_0xc9dff4=await dataCheck(_0x29ff0f,_0x41a794);{}let _0x2abb09=_0xa7d1c1(0x305);var _0x361557=new Date(_0x29ff0f),_0xff667c=new Date(_0x41a794);const _0x3888b3={'year':_0xa7d1c1(0x28d),'month':_0xa7d1c1(0x227),'day':_0xa7d1c1(0x28d)},_0x28028d=new Intl[(_0xa7d1c1(0x206))](_0xa7d1c1(0x211),_0x3888b3)[_0xa7d1c1(0x287)](_0x361557),_0x417407=new Intl[(_0xa7d1c1(0x206))](_0xa7d1c1(0x211),_0x3888b3)[_0xa7d1c1(0x287)](_0xff667c);_0x2abb09+=_0xa7d1c1(0x1ad),_0x2abb09+=_0xa7d1c1(0x24c),_0x2abb09+=_0xa7d1c1(0x1f7)+_0x28028d+_0xa7d1c1(0x213)+_0x417407+_0xa7d1c1(0x1f0),_0x2abb09+='<div\x20class=\x22row\x22>',_0x2abb09+=_0xa7d1c1(0x26d),_0x2abb09+=_0xa7d1c1(0x21f),_0x2abb09+=_0xa7d1c1(0x2ee),_0x2abb09+=_0xa7d1c1(0x310),_0x2abb09+=_0xa7d1c1(0x22b),_0x2abb09+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x28028d+_0xa7d1c1(0x32d),_0x2abb09+=_0xa7d1c1(0x1a3),_0x2abb09+='<th\x20colspan=\x272\x27>SOLD</th>',_0x2abb09+=_0xa7d1c1(0x30a)+_0x417407+_0xa7d1c1(0x32d),_0x2abb09+=_0xa7d1c1(0x314),_0x2abb09+=_0xa7d1c1(0x2ee),_0x2abb09+=_0xa7d1c1(0x249),_0x2abb09+=_0xa7d1c1(0x233),_0x2abb09+='</tr>',_0x2abb09+=_0xc9dff4,_0x2abb09+=_0xa7d1c1(0x328),_0x2abb09+='</div>',_0x2abb09+=_0xa7d1c1(0x306);const _0xf1f6b9={'format':'Letter','orientation':_0xa7d1c1(0x331),'childProcessOptions':{'env':{'OPENSSL_CONF':_0xa7d1c1(0x2bc)}}};pdf[_0xa7d1c1(0x309)](_0x2abb09,_0xf1f6b9)[_0xa7d1c1(0x28e)](function(_0x3bf5bb,_0x2b2520){const _0x35240a=_0xa7d1c1;if(_0x3bf5bb){_0x441959[_0x35240a(0x2e7)](0x1f4)[_0x35240a(0x1e5)](_0x35240a(0x225));return;}_0x441959['setHeader'](_0x35240a(0x324),_0x35240a(0x205)),_0x2b2520[_0x35240a(0x2fa)](_0x441959);});}),router[a0_0x44e325(0x268)](a0_0x44e325(0x323),auth,async(_0x1ca285,_0x2ee541)=>{const _0x228b1a=a0_0x44e325;try{const {username:_0x15dfd9,email:_0x35238c,role:_0x14fcd9}=_0x1ca285['user'],_0x5b30f4=_0x1ca285[_0x228b1a(0x30b)],_0x434303=await profile['findOne']({'email':_0x5b30f4[_0x228b1a(0x312)]}),_0x3b3947={'year':'numeric','month':_0x228b1a(0x227),'day':'numeric'},_0x3c1d62=await master_shop[_0x228b1a(0x292)](),_0x3c12a7=await product[_0x228b1a(0x292)](),_0x4379f9=await warehouse[_0x228b1a(0x1d7)]([{'$unwind':_0x228b1a(0x2df)},{'$lookup':{'from':_0x228b1a(0x23f),'localField':_0x228b1a(0x257),'foreignField':_0x228b1a(0x1a7),'as':_0x228b1a(0x1e2)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x228b1a(0x2c7)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x228b1a(0x2be)}}}]);if(_0x3c1d62[0x0][_0x228b1a(0x1e0)]==_0x228b1a(0x1ff))var _0x526918=users[_0x228b1a(0x203)];else{if(_0x3c1d62[0x0][_0x228b1a(0x1e0)]==_0x228b1a(0x2b9))var _0x526918=users['Hindi'];else{if(_0x3c1d62[0x0][_0x228b1a(0x1e0)]=='German')var _0x526918=users['German'];else{if(_0x3c1d62[0x0][_0x228b1a(0x1e0)]==_0x228b1a(0x2ed))var _0x526918=users['Spanish'];else{if(_0x3c1d62[0x0][_0x228b1a(0x1e0)]==_0x228b1a(0x1eb))var _0x526918=users[_0x228b1a(0x1eb)];else{if(_0x3c1d62[0x0][_0x228b1a(0x1e0)]==_0x228b1a(0x284))var _0x526918=users['Portuguese'];else{if(_0x3c1d62[0x0][_0x228b1a(0x1e0)]==_0x228b1a(0x20a))var _0x526918=users[_0x228b1a(0x20a)];else{if(_0x3c1d62[0x0][_0x228b1a(0x1e0)]==_0x228b1a(0x1c9))var _0x526918=users['Arabic'];}}}}}}}_0x2ee541[_0x228b1a(0x245)](_0x228b1a(0x29b),{'success':_0x1ca285[_0x228b1a(0x1e6)](_0x228b1a(0x1a5)),'errors':_0x1ca285['flash'](_0x228b1a(0x2a8)),'alldata':_0x3c12a7,'profile':_0x434303,'master_shop':_0x3c1d62,'role':_0x5b30f4,'product_stock':_0x4379f9,'language':_0x526918});}catch(_0x486822){}});async function agentsdataCheck(_0x1fd3b0,_0x40eb36){const _0x485296=a0_0x44e325,_0x184548=await product[_0x485296(0x1d7)]([{'$group':{'_id':{'brand':_0x485296(0x26e),'category':_0x485296(0x23b)},'products':{'$push':{'name':_0x485296(0x21c),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x58bcfd=[];_0x58bcfd[_0x485296(0x252)]=[];for(let _0x2f635f=0x0;_0x2f635f<=_0x184548[_0x485296(0x24f)]-0x1;_0x2f635f++){const _0x20da5c=_0x184548[_0x2f635f];_0x58bcfd[_0x485296(0x252)][_0x485296(0x2a1)](_0x20da5c);}const _0xa1a4c0=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x485296(0x26e),'product_code':_0x485296(0x333),'product_name':_0x485296(0x21c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x379c7c=await product[_0x485296(0x1d7)]([{'$group':{'_id':{'category':'$category','brand':_0x485296(0x26e)}}},{'$group':{'_id':_0x485296(0x2f8),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x56c4a9=await sales_sa[_0x485296(0x1d7)]([{'$match':{'date':{'$gte':_0x1fd3b0,'$lte':_0x40eb36}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x485296(0x262)}}},{'$lookup':{'from':_0x485296(0x2cf),'localField':_0x485296(0x1f8),'foreignField':'_id','as':_0x485296(0x2ab)}},{'$unwind':'$sales_info'},{'$unwind':_0x485296(0x302)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x485296(0x210)}},{'$lookup':{'from':'products','localField':_0x485296(0x209),'foreignField':_0x485296(0x32b),'as':'product_info'}},{'$unwind':_0x485296(0x2fd)},{'$group':{'_id':{'sales_id':_0x485296(0x27f),'category':_0x485296(0x2ad),'brand':'$product_info.brand'},'salesman_data':{'$first':'$sales_info.name'},'totalQTY':{'$sum':_0x485296(0x2e5)},'products':{'$push':{'qty':_0x485296(0x2e5),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':'$product_info.category','brand':'$product_info.brand'}}}}}]);let _0x301fe0='';_0x301fe0+=_0x485296(0x2ee),_0x301fe0+=_0x485296(0x2c5),_0x301fe0+='</tr>',_0x301fe0+=_0x485296(0x2ee),_0x301fe0+=_0x485296(0x293);for(let _0x3c3f9c=0x0;_0x3c3f9c<=_0xa1a4c0[_0x485296(0x24f)]-0x1;_0x3c3f9c++){const _0xf04eed=_0xa1a4c0[_0x3c3f9c];for(let _0x4640db=0x0;_0x4640db<_0x379c7c[_0x485296(0x24f)];_0x4640db++){const _0xc191e8=_0x379c7c[_0x4640db];_0xc191e8['_id']==_0xf04eed[_0x485296(0x1e3)][_0x485296(0x2aa)]&&(_0x301fe0+=_0x485296(0x215)+_0xc191e8[_0x485296(0x22d)]+_0x485296(0x2cd)+_0xf04eed[_0x485296(0x1e3)][_0x485296(0x2aa)]+'</td>');}}_0x301fe0+=_0x485296(0x293),_0x301fe0+='</tr>',_0x301fe0+=_0x485296(0x2ee),_0x301fe0+=_0x485296(0x30e);for(let _0x5ab50b=0x0;_0x5ab50b<=_0xa1a4c0['length']-0x1;_0x5ab50b++){const _0x3ad6c2=_0xa1a4c0[_0x5ab50b];for(let _0x34dd3c=0x0;_0x34dd3c<_0x58bcfd['cat_brand'][_0x485296(0x24f)];_0x34dd3c++){const _0x3aff63=_0x58bcfd[_0x485296(0x252)][_0x34dd3c];_0x3aff63[_0x485296(0x1e3)][_0x485296(0x2aa)]==_0x3ad6c2[_0x485296(0x1e3)][_0x485296(0x2aa)]&&(_0x301fe0+=_0x485296(0x1a9)+_0x3aff63[_0x485296(0x1e3)][_0x485296(0x280)]+'</td>');}}_0x301fe0+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x301fe0+=_0x485296(0x314);let _0x2963d0={'name':[],'dataqty':{}};for(let _0x287152=0x0;_0x287152<_0x58bcfd[_0x485296(0x252)][_0x485296(0x24f)];_0x287152++){const _0x447628=_0x58bcfd[_0x485296(0x252)][_0x287152],_0xa598bc=_0x447628['_id'][_0x485296(0x280)],_0x35d895=_0x447628[_0x485296(0x1e3)][_0x485296(0x2aa)];!_0x2963d0[_0x485296(0x334)][_0xa598bc]&&(_0x2963d0[_0x485296(0x334)][_0xa598bc]={});!_0x2963d0[_0x485296(0x334)][_0xa598bc][_0x35d895]&&(_0x2963d0['dataqty'][_0xa598bc][_0x35d895]=[]);for(let _0xd6c3e0=0x0;_0xd6c3e0<_0x56c4a9[_0x485296(0x24f)];_0xd6c3e0++){const _0x2bb7ff=_0x56c4a9[_0xd6c3e0];if(_0xa598bc===_0x2bb7ff['_id']['brand']&&_0x35d895===_0x2bb7ff[_0x485296(0x1e3)]['category']){const _0x2f855c=_0x2bb7ff[_0x485296(0x2ea)];!_0x2963d0[_0x485296(0x334)][_0xa598bc][_0x35d895][_0x2f855c]&&(_0x2963d0['dataqty'][_0xa598bc][_0x35d895][_0x2f855c]=[]),_0x2963d0[_0x485296(0x334)][_0xa598bc][_0x35d895][_0x2f855c][_0x485296(0x2a1)](_0x2bb7ff[_0x485296(0x283)]),!_0x2963d0[_0x485296(0x1a7)][_0x485296(0x223)](_0x2f855c)&&_0x2963d0[_0x485296(0x1a7)][_0x485296(0x2a1)](_0x2f855c);}}}_0x301fe0+=_0x485296(0x2ee);for(let _0x28b9ca=0x0;_0x28b9ca<=_0x2963d0[_0x485296(0x1a7)]['length']-0x1;_0x28b9ca++){const _0x597421=_0x2963d0[_0x485296(0x1a7)][_0x28b9ca];_0x301fe0+=_0x485296(0x2f7)+_0x597421+_0x485296(0x200);var _0x3a3a28=0x0,_0x4d4f9d=0x0;for(let _0x111c9b=0x0;_0x111c9b<=_0x58bcfd[_0x485296(0x252)]['length']-0x1;_0x111c9b++){const _0x43b8b1=_0x58bcfd[_0x485296(0x252)][_0x111c9b];var _0x3327ed=0x0;_0x2963d0['dataqty'][_0x43b8b1['_id']['brand']][_0x43b8b1[_0x485296(0x1e3)][_0x485296(0x2aa)]][_0x597421]?(_0x3327ed=_0x2963d0['dataqty'][_0x43b8b1[_0x485296(0x1e3)]['brand']][_0x43b8b1[_0x485296(0x1e3)][_0x485296(0x2aa)]][_0x597421][0x0],_0x301fe0+=_0x485296(0x2f7)+_0x3327ed['toFixed'](0x2)+_0x485296(0x200)):(_0x3327ed=0x0,_0x301fe0+=_0x485296(0x2f7)+_0x3327ed+_0x485296(0x200)),_0x3a3a28+=parseFloat(_0x3327ed[_0x485296(0x322)](0x2));}_0x301fe0+=_0x485296(0x2f7)+_0x3a3a28[_0x485296(0x322)](0x2)+_0x485296(0x200);}return _0x301fe0+=_0x485296(0x314),_0x301fe0;}router['post']('/agent/pdf',auth,async(_0x5a6e83,_0xad0d52)=>{const _0x287758=a0_0x44e325,{from_date:_0x49d89e,to_date:_0x15f83f}=_0x5a6e83[_0x287758(0x21d)],_0x3f17db=await agentsdataCheck(_0x49d89e,_0x15f83f);{}let _0x15ed3a=_0x287758(0x300);var _0x5602e8=new Date(_0x49d89e),_0xe58a5d=new Date(_0x15f83f);const _0x1a532e={'year':_0x287758(0x28d),'month':'long','day':_0x287758(0x28d)},_0x2ce1e6=new Intl[(_0x287758(0x206))](_0x287758(0x211),_0x1a532e)[_0x287758(0x287)](_0x5602e8),_0x372de3=new Intl[(_0x287758(0x206))]('en-US',_0x1a532e)[_0x287758(0x287)](_0xe58a5d);_0x15ed3a+=_0x287758(0x1ad),_0x15ed3a+='<p>SALES\x20REPORTS</p>',_0x15ed3a+=_0x287758(0x1f7)+_0x2ce1e6+_0x287758(0x213)+_0x372de3+_0x287758(0x1f0),_0x15ed3a+=_0x287758(0x2ac),_0x15ed3a+='<div\x20class=\x22col-sm-11\x22>',_0x15ed3a+=_0x287758(0x21f),_0x15ed3a+=_0x3f17db,_0x15ed3a+=_0x287758(0x328),_0x15ed3a+=_0x287758(0x306),_0x15ed3a+=_0x287758(0x306);const _0x5c7077={'format':_0x287758(0x2ba),'orientation':_0x287758(0x331),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x287758(0x2bc)}}};pdf['create'](_0x15ed3a,_0x5c7077)['toStream'](function(_0x3f1047,_0x3eb922){const _0x37372b=_0x287758;if(_0x3f1047){_0xad0d52[_0x37372b(0x2e7)](0x1f4)[_0x37372b(0x1e5)](_0x37372b(0x225));return;}_0xad0d52[_0x37372b(0x238)]('Content-Type','application/pdf'),_0x3eb922[_0x37372b(0x2fa)](_0xad0d52);});}),router[a0_0x44e325(0x268)]('/agent_reports/sales_ad',auth,async(_0x405928,_0x23019a)=>{const _0x830ad=a0_0x44e325;try{const {username:_0x5d83ce,email:_0x4e983a,role:_0x29a64e}=_0x405928[_0x830ad(0x30b)],_0x591bad=_0x405928[_0x830ad(0x30b)],_0x1df456=await profile[_0x830ad(0x2a3)]({'email':_0x591bad[_0x830ad(0x312)]}),_0x5015b1={'year':_0x830ad(0x28d),'month':'long','day':'numeric'},_0x48e591=await master_shop[_0x830ad(0x292)](),_0x20a0f1=await staff['findOne']({'email':_0x591bad[_0x830ad(0x312)]}),_0x4517bb=await product[_0x830ad(0x292)](),_0x5a095b=await warehouse[_0x830ad(0x1d7)]([{'$unwind':_0x830ad(0x2df)},{'$lookup':{'from':'products','localField':_0x830ad(0x257),'foreignField':_0x830ad(0x1a7),'as':_0x830ad(0x1e2)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x830ad(0x1d9),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x830ad(0x289),'product_stock':{'$sum':_0x830ad(0x2be)}}}]),_0x5e25f4=await staff[_0x830ad(0x292)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x48e591[0x0][_0x830ad(0x1e0)]==_0x830ad(0x1ff))var _0x239eb4=users[_0x830ad(0x203)];else{if(_0x48e591[0x0]['language']==_0x830ad(0x2b9))var _0x239eb4=users['Hindi'];else{if(_0x48e591[0x0][_0x830ad(0x1e0)]==_0x830ad(0x29a))var _0x239eb4=users[_0x830ad(0x29a)];else{if(_0x48e591[0x0][_0x830ad(0x1e0)]=='Spanish')var _0x239eb4=users['Spanish'];else{if(_0x48e591[0x0][_0x830ad(0x1e0)]==_0x830ad(0x1eb))var _0x239eb4=users['French'];else{if(_0x48e591[0x0]['language']==_0x830ad(0x284))var _0x239eb4=users['Portuguese'];else{if(_0x48e591[0x0][_0x830ad(0x1e0)]=='Chinese')var _0x239eb4=users['Chinese'];else{if(_0x48e591[0x0][_0x830ad(0x1e0)]==_0x830ad(0x1c9))var _0x239eb4=users['Arabic'];}}}}}}}_0x23019a[_0x830ad(0x245)](_0x830ad(0x1b0),{'success':_0x405928[_0x830ad(0x1e6)]('success'),'errors':_0x405928[_0x830ad(0x1e6)]('errors'),'alldata':_0x4517bb,'profile':_0x1df456,'master_shop':_0x48e591,'role':_0x591bad,'product_stock':_0x5a095b,'language':_0x239eb4,'staff_arr':_0x20a0f1,'staff_data_all':_0x5e25f4});}catch(_0x2f3765){_0x23019a['json'](_0x2f3765);}});async function agentsdataDSICheck_admin(_0x1d602d,_0x234a2b,_0x57cb0c,_0x412abd){const _0x47f8f5=a0_0x44e325,_0x2570bf=await product['aggregate']([{'$group':{'_id':{'brand':_0x47f8f5(0x26e),'category':_0x47f8f5(0x23b)},'products':{'$push':{'name':'$name','product_code':_0x47f8f5(0x333)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xfdf14a=[];_0xfdf14a[_0x47f8f5(0x252)]=[];for(let _0xd84f6e=0x0;_0xd84f6e<=_0x2570bf[_0x47f8f5(0x24f)]-0x1;_0xd84f6e++){const _0x2f824f=_0x2570bf[_0xd84f6e];_0xfdf14a[_0x47f8f5(0x252)][_0x47f8f5(0x2a1)](_0x2f824f);}const _0x3b9629=await product[_0x47f8f5(0x1d7)]([{'$group':{'_id':{'category':_0x47f8f5(0x23b)},'products':{'$push':{'brand':_0x47f8f5(0x26e),'product_code':'$product_code','product_name':_0x47f8f5(0x21c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x279304=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':'$brand'}}},{'$group':{'_id':_0x47f8f5(0x2f8),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x20871b=await sales_sa[_0x47f8f5(0x1d7)]([{'$match':{'date':{'$gte':_0x1d602d,'$lte':_0x234a2b},'sales_staff_id':_0x57cb0c,'sale_product.isFG':_0x47f8f5(0x210)}},{'$unwind':_0x47f8f5(0x302)},{'$match':{'sale_product.isFG':_0x47f8f5(0x210)}},{'$lookup':{'from':_0x47f8f5(0x23f),'localField':_0x47f8f5(0x209),'foreignField':_0x47f8f5(0x32b),'as':_0x47f8f5(0x2de)}},{'$unwind':_0x47f8f5(0x2fd)},{'$group':{'_id':{'dsi':_0x47f8f5(0x320),'date':_0x47f8f5(0x1cc),'customer':_0x47f8f5(0x207)},'totalQty':{'$sum':_0x47f8f5(0x2e5)},'products':{'$push':{'qty':_0x47f8f5(0x2e5),'NetPrice':_0x47f8f5(0x1b4),'discount':_0x47f8f5(0x1e8),'adj_discount':_0x47f8f5(0x30f),'product_details':{'prod_name':'$product_info.name','product_code':_0x47f8f5(0x1aa),'category':_0x47f8f5(0x2ad),'brand':'$product_info.brand','gross_price':_0x47f8f5(0x2f1)}}}}},{'$unwind':_0x47f8f5(0x1b7)},{'$group':{'_id':{'dsi':_0x47f8f5(0x2a5),'date':_0x47f8f5(0x1d5),'customer':_0x47f8f5(0x1d2),'category':_0x47f8f5(0x2a6),'brand':_0x47f8f5(0x296)},'totalQty':{'$sum':_0x47f8f5(0x2bb)},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x47f8f5(0x1d1)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x47f8f5(0x308)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x47f8f5(0x2a5),'date':_0x47f8f5(0x1d5),'customer':_0x47f8f5(0x1d2)},'totalQty':{'$sum':_0x47f8f5(0x2d5)},'totalGross':{'$sum':_0x47f8f5(0x224)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x47f8f5(0x2ff)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x47f8f5(0x2d5),'category':_0x47f8f5(0x2f8),'brand':_0x47f8f5(0x2af),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4c17b7=[],_0x29891f={},_0x4f5185={},_0x20e208={};var _0x401d3e=0x0,_0x59e503=0x0,_0x3b1825=0x0,_0x17637e=0x0,_0x3d8cad=0x0;const _0x2bcda0=0x6;for(let _0x4d036e=0x0;_0x4d036e<=_0x20871b[_0x47f8f5(0x24f)]-0x1;_0x4d036e++){const _0x18ed7e=_0x20871b[_0x4d036e];let _0x35f88e='<tr>';_0x35f88e+=_0x47f8f5(0x1ba)+_0x18ed7e['_id'][_0x47f8f5(0x267)]+_0x47f8f5(0x200),_0x35f88e+=_0x47f8f5(0x1ba)+_0x18ed7e[_0x47f8f5(0x1e3)][_0x47f8f5(0x2f4)]+'</td>',_0x35f88e+=_0x47f8f5(0x1ba)+_0x18ed7e[_0x47f8f5(0x1e3)]['customer']+_0x47f8f5(0x200);let _0xb82bed={};var _0x216104=0x0;for(let _0x2e919d=0x0;_0x2e919d<=_0x18ed7e[_0x47f8f5(0x23f)][_0x47f8f5(0x24f)]-0x1;_0x2e919d++){const _0x594d7b=_0x18ed7e[_0x47f8f5(0x23f)][_0x2e919d];_0xb82bed[_0x594d7b[_0x47f8f5(0x280)]+'-'+_0x594d7b[_0x47f8f5(0x2aa)]]=_0x594d7b[_0x47f8f5(0x1da)];const _0x54ebf5=_0x594d7b[_0x47f8f5(0x280)]+'-'+_0x594d7b[_0x47f8f5(0x2aa)];!_0x29891f[_0x54ebf5]&&(_0x29891f[_0x54ebf5]=0x0),!Array[_0x47f8f5(0x1e1)](_0x20e208[_0x54ebf5])&&(_0x20e208[_0x54ebf5]=[]),!Array[_0x47f8f5(0x1e1)](_0x20e208[_0x54ebf5])&&(_0x20e208[_0x54ebf5]=[]),_0x29891f[_0x54ebf5]+=_0x594d7b[_0x47f8f5(0x1da)],_0x20e208[_0x54ebf5][_0x47f8f5(0x2a1)](_0x594d7b[_0x47f8f5(0x1da)]),_0x216104++;}for(let _0x399cc3=0x0;_0x399cc3<=_0xfdf14a[_0x47f8f5(0x252)]['length']-0x1;_0x399cc3++){const _0x54b2f7=_0xfdf14a[_0x47f8f5(0x252)][_0x399cc3],_0x78414c=_0x54b2f7[_0x47f8f5(0x1e3)][_0x47f8f5(0x280)]+'-'+_0x54b2f7[_0x47f8f5(0x1e3)][_0x47f8f5(0x2aa)];_0x35f88e+=_0x47f8f5(0x2ca)+(_0xb82bed[_0x78414c]!==undefined?_0xb82bed[_0x78414c][_0x47f8f5(0x322)](0x2):'')+_0x47f8f5(0x200);}_0x3b1825=_0x18ed7e['discount']+_0x18ed7e[_0x47f8f5(0x242)],_0x35f88e+=_0x47f8f5(0x21b)+formatNumber(parseFloat(_0x18ed7e[_0x47f8f5(0x254)],0x2)['toFixed'](0x2))+_0x47f8f5(0x200),_0x35f88e+=_0x47f8f5(0x21b)+formatNumber(_0x18ed7e['totalGross'][_0x47f8f5(0x322)](0x2))+_0x47f8f5(0x200),_0x35f88e+=_0x47f8f5(0x21b)+formatNumber(_0x3b1825)+'</td>',_0x35f88e+=_0x47f8f5(0x21b)+formatNumber(_0x18ed7e['NetPrice'][_0x47f8f5(0x322)](0x2))+_0x47f8f5(0x200),_0x35f88e+=_0x47f8f5(0x314);var _0x560a02=parseFloat(_0x18ed7e['totalQty']['toFixed'](0x3));_0x401d3e+=_0x560a02,console[_0x47f8f5(0x1fc)]('total',_0x401d3e+'\x20<>\x20'+_0x560a02),_0x59e503+=parseFloat(_0x18ed7e[_0x47f8f5(0x269)][_0x47f8f5(0x322)](0x2)),_0x17637e+=_0x3b1825,_0x3d8cad+=parseFloat(_0x18ed7e[_0x47f8f5(0x307)][_0x47f8f5(0x322)](0x2));if(_0x4d036e==_0x20871b[_0x47f8f5(0x24f)]-0x1){_0x35f88e+='<tr>',_0x35f88e+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x35f88e+=_0x47f8f5(0x200);for(let _0x157ef5=0x0;_0x157ef5<=_0xfdf14a[_0x47f8f5(0x252)][_0x47f8f5(0x24f)]-0x1;_0x157ef5++){const _0x2b0231=_0xfdf14a['cat_brand'][_0x157ef5],_0x43e9d8=_0x2b0231['_id'][_0x47f8f5(0x280)]+'-'+_0x2b0231['_id'][_0x47f8f5(0x2aa)];!_0x20e208[_0x43e9d8]&&(_0x20e208[_0x43e9d8]=[]);const _0x542928=_0x20e208[_0x43e9d8]['reduce']((_0x10fa1f,_0x11437e)=>_0x10fa1f+_0x11437e,0x0);_0x35f88e+=_0x47f8f5(0x2d8)+(_0x542928!==undefined?formatNumber(_0x542928[_0x47f8f5(0x322)](0x2)):'')+_0x47f8f5(0x1f9);}_0x35f88e+=_0x47f8f5(0x2dd)+formatNumber(_0x401d3e[_0x47f8f5(0x322)](0x2),0x2)+_0x47f8f5(0x1f9),_0x35f88e+=_0x47f8f5(0x2dd)+formatNumber(_0x3d8cad)+'</b></td>',_0x35f88e+=_0x47f8f5(0x2dd)+formatNumber(_0x17637e)+_0x47f8f5(0x1f9),_0x35f88e+=_0x47f8f5(0x2dd)+formatNumber(_0x59e503)+'</b></td>',_0x35f88e+='</tr>';}_0x4c17b7[_0x47f8f5(0x2a1)](_0x35f88e);}function _0x2892f5(_0x1695b1,_0x5d2b03){const _0x1eb773=_0x47f8f5,_0x1fd213=[];for(let _0x4eb72e=0x0;_0x4eb72e<=_0x1695b1[_0x1eb773(0x24f)]-0x1;_0x4eb72e+=_0x5d2b03){_0x1fd213[_0x1eb773(0x2a1)](_0x1695b1[_0x1eb773(0x24d)](_0x4eb72e,_0x4eb72e+_0x5d2b03));}return _0x1fd213;}const _0x4f4ad1=_0x2892f5(_0x4c17b7,_0x2bcda0);let _0x4573ba='';return _0x4f4ad1['forEach']((_0x805cc1,_0x23ea31)=>{const _0x23a703=_0x47f8f5;_0x23ea31>0x0&&(_0x4573ba+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x4573ba+=_0x23a703(0x21f),_0x4573ba+=_0x23a703(0x1ce),_0x4573ba+=_0x23a703(0x2ee),_0x4573ba+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4573ba+=_0x23a703(0x314),_0x4573ba+=_0x23a703(0x2ee),_0x4573ba+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x3c5b0d=0x0;_0x3c5b0d<=_0x3b9629[_0x23a703(0x24f)]-0x1;_0x3c5b0d++){const _0xe9ae3d=_0x3b9629[_0x3c5b0d];for(let _0x17a099=0x0;_0x17a099<_0x279304[_0x23a703(0x24f)];_0x17a099++){const _0x30d8a0=_0x279304[_0x17a099];_0x30d8a0['_id']===_0xe9ae3d[_0x23a703(0x1e3)][_0x23a703(0x2aa)]&&(_0x4573ba+=_0x23a703(0x215)+_0x30d8a0['brandCount']+_0x23a703(0x2cd)+_0xe9ae3d[_0x23a703(0x1e3)]['category']+_0x23a703(0x200));}}_0x4573ba+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x4573ba+='</tr>',_0x4573ba+='<tr>',_0x4573ba+=_0x23a703(0x273),_0x4573ba+=_0x23a703(0x1c4),_0x4573ba+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x115703=0x0;_0x115703<=_0x3b9629['length']-0x1;_0x115703++){const _0x440e7b=_0x3b9629[_0x115703];for(let _0x1f8d03=0x0;_0x1f8d03<_0xfdf14a['cat_brand'][_0x23a703(0x24f)];_0x1f8d03++){const _0x1e8135=_0xfdf14a[_0x23a703(0x252)][_0x1f8d03];_0x1e8135[_0x23a703(0x1e3)][_0x23a703(0x2aa)]===_0x440e7b[_0x23a703(0x1e3)][_0x23a703(0x2aa)]&&(_0x4573ba+=_0x23a703(0x1a9)+_0x1e8135[_0x23a703(0x1e3)]['brand']+_0x23a703(0x200));}}_0x4573ba+=_0x23a703(0x2d2),_0x4573ba+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x4573ba+=_0x23a703(0x266),_0x4573ba+=_0x23a703(0x218),_0x4573ba+=_0x23a703(0x314),_0x4573ba+=_0x23a703(0x2b4),_0x4573ba+=_0x23a703(0x20e),_0x805cc1[_0x23a703(0x2a9)](_0x1858a9=>{_0x4573ba+=_0x1858a9;}),_0x4573ba+=_0x23a703(0x231),_0x4573ba+=_0x23a703(0x328);}),_0x4573ba;}async function agentsdataDSICheck_admin_excel(_0x2f5923,_0x351be4,_0x433b5,_0x5e0b4d){const _0x328373=a0_0x44e325,_0x36c82d=await product[_0x328373(0x1d7)]([{'$group':{'_id':{'brand':'$brand','category':_0x328373(0x23b)},'products':{'$push':{'name':_0x328373(0x21c),'product_code':_0x328373(0x333)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3fc7ff=[];_0x3fc7ff[_0x328373(0x252)]=[];for(let _0x2562e6=0x0;_0x2562e6<=_0x36c82d['length']-0x1;_0x2562e6++){const _0xf87b22=_0x36c82d[_0x2562e6];_0x3fc7ff[_0x328373(0x252)][_0x328373(0x2a1)](_0xf87b22);}const _0x388c14=await product[_0x328373(0x1d7)]([{'$group':{'_id':{'category':_0x328373(0x23b)},'products':{'$push':{'brand':_0x328373(0x26e),'product_code':'$product_code','product_name':_0x328373(0x21c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x2b432a=await product[_0x328373(0x1d7)]([{'$group':{'_id':{'category':_0x328373(0x23b),'brand':_0x328373(0x26e)}}},{'$group':{'_id':_0x328373(0x2f8),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x27e065=await sales_sa[_0x328373(0x1d7)]([{'$match':{'date':{'$gte':_0x2f5923,'$lte':_0x351be4},'sales_staff_id':_0x433b5,'sale_product.isFG':_0x328373(0x210)}},{'$unwind':_0x328373(0x302)},{'$match':{'sale_product.isFG':_0x328373(0x210)}},{'$lookup':{'from':_0x328373(0x23f),'localField':'sale_product.product_code','foreignField':_0x328373(0x32b),'as':_0x328373(0x2de)}},{'$unwind':_0x328373(0x2fd)},{'$group':{'_id':{'dsi':_0x328373(0x320),'date':_0x328373(0x1cc),'customer':_0x328373(0x207)},'totalQty':{'$sum':_0x328373(0x2e5)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x328373(0x1b4),'discount':'$sale_product.discount','adj_discount':_0x328373(0x30f),'product_details':{'prod_name':'$product_info.name','product_code':_0x328373(0x1aa),'category':_0x328373(0x2ad),'brand':'$product_info.brand','gross_price':_0x328373(0x2f1)}}}}},{'$unwind':_0x328373(0x1b7)},{'$group':{'_id':{'dsi':_0x328373(0x2a5),'date':_0x328373(0x1d5),'customer':_0x328373(0x1d2),'category':_0x328373(0x2a6),'brand':_0x328373(0x296)},'totalQty':{'$sum':_0x328373(0x2bb)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x328373(0x315)]}},'NetPrice':{'$sum':_0x328373(0x1d1)},'discount':{'$sum':_0x328373(0x2d7)},'adj_discount':{'$sum':_0x328373(0x308)},'product_details':{'$first':_0x328373(0x27e)}}},{'$group':{'_id':{'dsi':_0x328373(0x2a5),'date':'$_id.date','customer':_0x328373(0x1d2)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x328373(0x2ff)},'adj_discount':{'$sum':_0x328373(0x2b7)},'products':{'$push':{'qty':_0x328373(0x2d5),'category':_0x328373(0x2f8),'brand':_0x328373(0x2af),'product_details':_0x328373(0x2df)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x141ff1=[],_0x57b686={},_0x14ebf5={},_0x2302ac={};var _0x517706=0x0,_0xd046ce=0x0,_0x3cecaf=0x0,_0x3838ed=0x0,_0x9ee2c4=0x0;const _0x4b0e71=0x16345785d8a0000;for(let _0x20a11d=0x0;_0x20a11d<=_0x27e065[_0x328373(0x24f)]-0x1;_0x20a11d++){const _0x4be32f=_0x27e065[_0x20a11d];let _0x50e263=_0x328373(0x2ee);_0x50e263+=_0x328373(0x1ba)+_0x4be32f[_0x328373(0x1e3)][_0x328373(0x267)]+_0x328373(0x200),_0x50e263+=_0x328373(0x1ba)+_0x4be32f[_0x328373(0x1e3)][_0x328373(0x2f4)]+_0x328373(0x200),_0x50e263+=_0x328373(0x1ba)+_0x4be32f[_0x328373(0x1e3)]['customer']+_0x328373(0x200);let _0xdaacd7={};var _0x5f2ef5=0x0;for(let _0x58fbea=0x0;_0x58fbea<=_0x4be32f[_0x328373(0x23f)][_0x328373(0x24f)]-0x1;_0x58fbea++){const _0x50ac44=_0x4be32f[_0x328373(0x23f)][_0x58fbea];_0xdaacd7[_0x50ac44[_0x328373(0x280)]+'-'+_0x50ac44[_0x328373(0x2aa)]]=_0x50ac44[_0x328373(0x1da)];const _0x2dda58=_0x50ac44[_0x328373(0x280)]+'-'+_0x50ac44[_0x328373(0x2aa)];!_0x57b686[_0x2dda58]&&(_0x57b686[_0x2dda58]=0x0),!Array['isArray'](_0x2302ac[_0x2dda58])&&(_0x2302ac[_0x2dda58]=[]),!Array['isArray'](_0x2302ac[_0x2dda58])&&(_0x2302ac[_0x2dda58]=[]),_0x57b686[_0x2dda58]+=_0x50ac44['qty'],_0x2302ac[_0x2dda58][_0x328373(0x2a1)](_0x50ac44[_0x328373(0x1da)]),_0x5f2ef5++;}for(let _0x42c4aa=0x0;_0x42c4aa<=_0x3fc7ff[_0x328373(0x252)][_0x328373(0x24f)]-0x1;_0x42c4aa++){const _0x4548e7=_0x3fc7ff[_0x328373(0x252)][_0x42c4aa],_0xcff225=_0x4548e7[_0x328373(0x1e3)][_0x328373(0x280)]+'-'+_0x4548e7[_0x328373(0x1e3)][_0x328373(0x2aa)];_0x50e263+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0xdaacd7[_0xcff225]!==undefined?_0xdaacd7[_0xcff225][_0x328373(0x322)](0x2):'')+_0x328373(0x200);}_0x3cecaf=_0x4be32f[_0x328373(0x1b6)]+_0x4be32f[_0x328373(0x242)],_0x50e263+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x4be32f[_0x328373(0x254)],0x2)[_0x328373(0x322)](0x2))+_0x328373(0x200),_0x50e263+=_0x328373(0x21b)+formatNumber(_0x4be32f['totalGross']['toFixed'](0x2))+_0x328373(0x200),_0x50e263+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x3cecaf)+_0x328373(0x200),_0x50e263+=_0x328373(0x21b)+formatNumber(_0x4be32f[_0x328373(0x269)][_0x328373(0x322)](0x2))+_0x328373(0x200),_0x50e263+='</tr>',_0x517706+=parseFloat(_0x4be32f[_0x328373(0x254)]),_0xd046ce+=parseFloat(_0x4be32f[_0x328373(0x269)][_0x328373(0x322)](0x2)),_0x3838ed+=_0x3cecaf,_0x9ee2c4+=parseFloat(_0x4be32f['totalGross'][_0x328373(0x322)](0x2));if(_0x20a11d==_0x27e065['length']-0x1){_0x50e263+=_0x328373(0x2ee),_0x50e263+=_0x328373(0x21e),_0x50e263+=_0x328373(0x200);for(let _0x16f7fe=0x0;_0x16f7fe<=_0x3fc7ff[_0x328373(0x252)][_0x328373(0x24f)]-0x1;_0x16f7fe++){const _0x42f3f6=_0x3fc7ff[_0x328373(0x252)][_0x16f7fe],_0x184093=_0x42f3f6[_0x328373(0x1e3)][_0x328373(0x280)]+'-'+_0x42f3f6[_0x328373(0x1e3)][_0x328373(0x2aa)];!_0x2302ac[_0x184093]&&(_0x2302ac[_0x184093]=[]);const _0x523400=_0x2302ac[_0x184093][_0x328373(0x2b8)]((_0x47acec,_0x32eb81)=>_0x47acec+_0x32eb81,0x0);_0x50e263+=_0x328373(0x2d8)+(_0x523400!==undefined?formatNumber(_0x523400[_0x328373(0x322)](0x2)):'')+_0x328373(0x1f9);}_0x50e263+=_0x328373(0x2dd)+formatNumber(_0x517706)+'</b></td>',_0x50e263+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x9ee2c4)+'</b></td>',_0x50e263+=_0x328373(0x2dd)+formatNumber(_0x3838ed)+_0x328373(0x1f9),_0x50e263+=_0x328373(0x2dd)+formatNumber(_0xd046ce)+_0x328373(0x1f9),_0x50e263+=_0x328373(0x314);}_0x141ff1[_0x328373(0x2a1)](_0x50e263);}function _0x1612e2(_0x3a4003,_0x4e92d7){const _0x340fed=_0x328373,_0x41a8a3=[];for(let _0x4f9aab=0x0;_0x4f9aab<=_0x3a4003[_0x340fed(0x24f)]-0x1;_0x4f9aab+=_0x4e92d7){_0x41a8a3[_0x340fed(0x2a1)](_0x3a4003[_0x340fed(0x24d)](_0x4f9aab,_0x4f9aab+_0x4e92d7));}return _0x41a8a3;}const _0x5da624=_0x1612e2(_0x141ff1,_0x4b0e71);let _0x46dae3='';return _0x5da624[_0x328373(0x2a9)]((_0x4c0dbc,_0x2266df)=>{const _0x4dd237=_0x328373;_0x2266df>0x0&&(_0x46dae3+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x46dae3+=_0x4dd237(0x21f),_0x46dae3+='<thead>',_0x46dae3+=_0x4dd237(0x2ee),_0x46dae3+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x46dae3+='</tr>',_0x46dae3+=_0x4dd237(0x2ee),_0x46dae3+=_0x4dd237(0x1c6);for(let _0x445af1=0x0;_0x445af1<=_0x388c14[_0x4dd237(0x24f)]-0x1;_0x445af1++){const _0xe60af5=_0x388c14[_0x445af1];for(let _0x14b7f7=0x0;_0x14b7f7<_0x2b432a[_0x4dd237(0x24f)];_0x14b7f7++){const _0xf73c4e=_0x2b432a[_0x14b7f7];_0xf73c4e[_0x4dd237(0x1e3)]===_0xe60af5[_0x4dd237(0x1e3)][_0x4dd237(0x2aa)]&&(_0x46dae3+='<td\x20colspan=\x22'+_0xf73c4e[_0x4dd237(0x22d)]+_0x4dd237(0x2cd)+_0xe60af5[_0x4dd237(0x1e3)][_0x4dd237(0x2aa)]+'</td>');}}_0x46dae3+=_0x4dd237(0x1ab),_0x46dae3+=_0x4dd237(0x314),_0x46dae3+=_0x4dd237(0x2ee),_0x46dae3+=_0x4dd237(0x273),_0x46dae3+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x46dae3+=_0x4dd237(0x246);for(let _0x115ebf=0x0;_0x115ebf<=_0x388c14['length']-0x1;_0x115ebf++){const _0xc8426a=_0x388c14[_0x115ebf];for(let _0x553be9=0x0;_0x553be9<_0x3fc7ff['cat_brand']['length'];_0x553be9++){const _0xca5efc=_0x3fc7ff[_0x4dd237(0x252)][_0x553be9];_0xca5efc[_0x4dd237(0x1e3)][_0x4dd237(0x2aa)]===_0xc8426a[_0x4dd237(0x1e3)][_0x4dd237(0x2aa)]&&(_0x46dae3+=_0x4dd237(0x1a9)+_0xca5efc['_id'][_0x4dd237(0x280)]+_0x4dd237(0x200));}}_0x46dae3+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x46dae3+=_0x4dd237(0x25c),_0x46dae3+=_0x4dd237(0x266),_0x46dae3+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x46dae3+=_0x4dd237(0x314),_0x46dae3+='</thead>',_0x46dae3+=_0x4dd237(0x20e),_0x4c0dbc[_0x4dd237(0x2a9)](_0xe208e=>{_0x46dae3+=_0xe208e;}),_0x46dae3+=_0x4dd237(0x231),_0x46dae3+=_0x4dd237(0x328);}),_0x46dae3;}router[a0_0x44e325(0x2a7)]('/agent_reports/pdf_admin',auth,async(_0x3e9f99,_0xb8894a)=>{const _0x2d377a=a0_0x44e325,{from_date:_0x3169db,to_date:_0x333f3a,isExcel:_0x28c8d2,agent_id:_0x2454df}=_0x3e9f99['body'],_0x544750=_0x3e9f99['user'],_0x4e0784=await staff['findOne']({'email':_0x544750[_0x2d377a(0x312)]}),_0x4bb544=await master_shop[_0x2d377a(0x292)](),_0x1e204f=await agentsdataDSICheck_admin(_0x3169db,_0x333f3a,_0x2454df,_0x28c8d2),_0x477c9c=await agentsdataDSICheck_admin_excel(_0x3169db,_0x333f3a,_0x2454df,_0x28c8d2);let _0x3537d6=_0x2d377a(0x28a);var _0x17ea5d=new Date(_0x3169db),_0x3ca91a=new Date(_0x333f3a);const _0x211bf6={'year':_0x2d377a(0x28d),'month':_0x2d377a(0x227),'day':_0x2d377a(0x28d)},_0x485eef=new Intl[(_0x2d377a(0x206))](_0x2d377a(0x211),_0x211bf6)['format'](_0x17ea5d),_0x1d663e=new Intl[(_0x2d377a(0x206))]('en-US',_0x211bf6)['format'](_0x3ca91a);_0x3537d6+=_0x2d377a(0x2ac),_0x3537d6+=_0x2d377a(0x1df),_0x3537d6+='<table>',_0x3537d6+=_0x1e204f,_0x3537d6+='</table>',_0x3537d6+=_0x2d377a(0x306),_0x3537d6+=_0x2d377a(0x306);let _0x222b65=_0x2d377a(0x28a);_0x222b65+=_0x2d377a(0x2ac),_0x222b65+=_0x2d377a(0x1df),_0x222b65+=_0x2d377a(0x21f),_0x222b65+=_0x477c9c,_0x222b65+=_0x2d377a(0x328),_0x222b65+='</div>',_0x222b65+=_0x2d377a(0x306);let _0x43e74a=_0x2d377a(0x271);const _0x244dc4={'width':'15in','height':_0x2d377a(0x1ca),'orientation':'landscape','border':{'top':_0x2d377a(0x1ed),'right':_0x2d377a(0x1ed),'bottom':_0x2d377a(0x1ed),'left':_0x2d377a(0x1ed)},'header':{'height':'60mm','contents':_0x2d377a(0x279)+_0x43e74a+_0x2d377a(0x25a)+_0x485eef+'\x20-\x20'+_0x1d663e+_0x2d377a(0x2d0)},'footer':{'height':_0x2d377a(0x1c1),'contents':{'default':_0x2d377a(0x326)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x2d377a(0x2bc)}}};if(_0x28c8d2=='on'){const _0x8286bd=cheerio[_0x2d377a(0x29f)](_0x222b65);let _0x528e2c=[],_0x2d2013=[],_0x2c5d88=[];_0x8286bd('table\x20tr')['each']((_0x319cb9,_0x48ec48)=>{const _0xf1c20f=_0x2d377a;let _0x4df025=[],_0x26e018=0x0;while(_0x2c5d88[_0x26e018]){_0x2c5d88[_0x26e018]--,_0x26e018++;}_0x8286bd(_0x48ec48)[_0xf1c20f(0x292)](_0xf1c20f(0x1f1))[_0xf1c20f(0x2a2)]((_0x1a0425,_0xb64cb7)=>{const _0x17e488=_0xf1c20f;let _0x25b5a2=_0x8286bd(_0xb64cb7)[_0x17e488(0x1cd)]()[_0x17e488(0x258)](),_0x53a495=parseFloat(_0x25b5a2['replace'](/,/g,''));isNaN(_0x53a495)&&(_0x53a495=_0x25b5a2);let _0x12b550=parseInt(_0x8286bd(_0xb64cb7)[_0x17e488(0x1c8)]('colspan'))||0x1,_0xc22fb2=parseInt(_0x8286bd(_0xb64cb7)[_0x17e488(0x1c8)](_0x17e488(0x327)))||0x1;_0x4df025[_0x26e018]=_0x53a495;(_0x12b550>0x1||_0xc22fb2>0x1)&&_0x2d2013[_0x17e488(0x2a1)]({'s':{'r':_0x319cb9,'c':_0x26e018},'e':{'r':_0x319cb9+_0xc22fb2-0x1,'c':_0x26e018+_0x12b550-0x1}});for(let _0xb40908=0x0;_0xb40908<_0x12b550;_0xb40908++){_0xc22fb2>0x1&&(_0x2c5d88[_0x26e018+_0xb40908]=_0xc22fb2-0x1);}_0x26e018+=_0x12b550;}),_0x528e2c[_0xf1c20f(0x2a1)](_0x4df025);});const _0x1777fb=XLSX[_0x2d377a(0x2ef)][_0x2d377a(0x1b9)](),_0x21bd5e=XLSX[_0x2d377a(0x2ef)][_0x2d377a(0x290)](_0x528e2c);_0x2d2013[_0x2d377a(0x24f)]>0x0&&(_0x21bd5e[_0x2d377a(0x316)]=_0x2d2013);_0x21bd5e[_0x2d377a(0x282)]=_0x528e2c[0x0][_0x2d377a(0x2bf)](()=>({'wpx':0x64})),XLSX['utils'][_0x2d377a(0x23a)](_0x1777fb,_0x21bd5e,'Sales\x20Report');const _0x4f375a=XLSX[_0x2d377a(0x2e1)](_0x1777fb,{'bookType':_0x2d377a(0x276),'type':'buffer'});_0xb8894a['setHeader'](_0x2d377a(0x2f9),_0x2d377a(0x2c3)),_0xb8894a[_0x2d377a(0x238)]('Content-Type',_0x2d377a(0x1af)),_0xb8894a[_0x2d377a(0x1e5)](_0x4f375a);}else pdf['create'](_0x3537d6,_0x244dc4)[_0x2d377a(0x28e)](function(_0x273cd1,_0x4c6523){const _0xc6fd03=_0x2d377a;if(_0x273cd1){_0xb8894a[_0xc6fd03(0x2e7)](0x1f4)[_0xc6fd03(0x1e5)](_0xc6fd03(0x225));return;}_0xb8894a[_0xc6fd03(0x238)](_0xc6fd03(0x324),'application/pdf'),_0x4c6523[_0xc6fd03(0x2fa)](_0xb8894a);});}),router[a0_0x44e325(0x268)](a0_0x44e325(0x244),auth,async(_0x4d3b3f,_0x4ce503)=>{const _0x2a066a=a0_0x44e325;try{const {username:_0x41f4cc,email:_0xdb183e,role:_0x34d2a1}=_0x4d3b3f[_0x2a066a(0x30b)],_0x251c25=_0x4d3b3f[_0x2a066a(0x30b)],_0x53efd7=await profile[_0x2a066a(0x2a3)]({'email':_0x251c25[_0x2a066a(0x312)]}),_0x18f0b6={'year':_0x2a066a(0x28d),'month':_0x2a066a(0x227),'day':'numeric'},_0x48b66d=await master_shop[_0x2a066a(0x292)](),_0x34b88d=await staff[_0x2a066a(0x2a3)]({'email':_0x251c25[_0x2a066a(0x312)]}),_0x298daa=await product[_0x2a066a(0x292)](),_0xf300c2=await warehouse[_0x2a066a(0x1d7)]([{'$unwind':_0x2a066a(0x2df)},{'$lookup':{'from':_0x2a066a(0x23f),'localField':_0x2a066a(0x257),'foreignField':_0x2a066a(0x1a7),'as':_0x2a066a(0x1e2)}},{'$unwind':_0x2a066a(0x332)},{'$project':{'product_name':_0x2a066a(0x1d9),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2a066a(0x2be)}}}]);if(_0x48b66d[0x0][_0x2a066a(0x1e0)]==_0x2a066a(0x1ff))var _0x44b76e=users[_0x2a066a(0x203)];else{if(_0x48b66d[0x0][_0x2a066a(0x1e0)]=='Hindi')var _0x44b76e=users['Hindi'];else{if(_0x48b66d[0x0][_0x2a066a(0x1e0)]==_0x2a066a(0x29a))var _0x44b76e=users[_0x2a066a(0x29a)];else{if(_0x48b66d[0x0]['language']==_0x2a066a(0x2ed))var _0x44b76e=users['Spanish'];else{if(_0x48b66d[0x0][_0x2a066a(0x1e0)]==_0x2a066a(0x1eb))var _0x44b76e=users[_0x2a066a(0x1eb)];else{if(_0x48b66d[0x0][_0x2a066a(0x1e0)]==_0x2a066a(0x284))var _0x44b76e=users[_0x2a066a(0x20f)];else{if(_0x48b66d[0x0][_0x2a066a(0x1e0)]==_0x2a066a(0x20a))var _0x44b76e=users['Chinese'];else{if(_0x48b66d[0x0][_0x2a066a(0x1e0)]==_0x2a066a(0x1c9))var _0x44b76e=users['Arabic'];}}}}}}}_0x4ce503[_0x2a066a(0x245)]('dsi_sales',{'success':_0x4d3b3f[_0x2a066a(0x1e6)](_0x2a066a(0x1a5)),'errors':_0x4d3b3f[_0x2a066a(0x1e6)](_0x2a066a(0x2a8)),'alldata':_0x298daa,'profile':_0x53efd7,'master_shop':_0x48b66d,'role':_0x251c25,'product_stock':_0xf300c2,'language':_0x44b76e,'staff_arr':_0x34b88d});}catch(_0x195c88){}});function formatNumber(_0x56e944,_0x3f4889=a0_0x44e325(0x211),_0x5d3c9f={'minimumFractionDigits':0x2}){const _0xb91245=a0_0x44e325,_0x406e40=new Intl[(_0xb91245(0x24a))](_0x3f4889,_0x5d3c9f);return _0x406e40[_0xb91245(0x287)](_0x56e944);}async function agentsdataDSICheck(_0x26a0d5,_0xf0d89b,_0x34f313,_0x39ff36){const _0x3da1f0=a0_0x44e325,_0x4e7d82=await product['aggregate']([{'$group':{'_id':{'brand':_0x3da1f0(0x26e),'category':_0x3da1f0(0x23b)},'products':{'$push':{'name':_0x3da1f0(0x21c),'product_code':_0x3da1f0(0x333)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x47309a=[];_0x47309a[_0x3da1f0(0x252)]=[];for(let _0xe36a1c=0x0;_0xe36a1c<=_0x4e7d82['length']-0x1;_0xe36a1c++){const _0x582e3c=_0x4e7d82[_0xe36a1c];_0x47309a[_0x3da1f0(0x252)][_0x3da1f0(0x2a1)](_0x582e3c);}const _0x7d2498=await product[_0x3da1f0(0x1d7)]([{'$group':{'_id':{'category':_0x3da1f0(0x23b)},'products':{'$push':{'brand':_0x3da1f0(0x26e),'product_code':_0x3da1f0(0x333),'product_name':_0x3da1f0(0x21c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x896128=await product['aggregate']([{'$group':{'_id':{'category':_0x3da1f0(0x23b),'brand':_0x3da1f0(0x26e)}}},{'$group':{'_id':_0x3da1f0(0x2f8),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x6a066f=await sales_sa[_0x3da1f0(0x1d7)]([{'$match':{'date':{'$gte':_0x26a0d5,'$lte':_0xf0d89b},'sales_staff_id':_0x34f313,'sale_product.isFG':_0x3da1f0(0x210),'status_data':_0x3da1f0(0x210)}},{'$unwind':_0x3da1f0(0x302)},{'$match':{'sale_product.isFG':_0x3da1f0(0x210)}},{'$lookup':{'from':_0x3da1f0(0x23f),'localField':'sale_product.product_code','foreignField':_0x3da1f0(0x32b),'as':'product_info'}},{'$unwind':_0x3da1f0(0x2fd)},{'$group':{'_id':{'dsi':_0x3da1f0(0x320),'date':_0x3da1f0(0x1cc),'customer':_0x3da1f0(0x207)},'totalQty':{'$sum':_0x3da1f0(0x2e5)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x3da1f0(0x1e8),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x3da1f0(0x25b),'product_code':_0x3da1f0(0x1aa),'category':_0x3da1f0(0x2ad),'brand':_0x3da1f0(0x1bc),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x3da1f0(0x1b7)},{'$group':{'_id':{'dsi':_0x3da1f0(0x2a5),'date':_0x3da1f0(0x1d5),'customer':'$_id.customer','category':'$products.product_details.category','brand':_0x3da1f0(0x296)},'totalQty':{'$sum':_0x3da1f0(0x2bb)},'totalGross':{'$sum':{'$multiply':[_0x3da1f0(0x2bb),_0x3da1f0(0x315)]}},'NetPrice':{'$sum':_0x3da1f0(0x1d1)},'discount':{'$sum':_0x3da1f0(0x2d7)},'adj_discount':{'$sum':_0x3da1f0(0x308)},'product_details':{'$first':_0x3da1f0(0x27e)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3da1f0(0x1d5),'customer':_0x3da1f0(0x1d2)},'totalQty':{'$sum':_0x3da1f0(0x2d5)},'totalGross':{'$sum':_0x3da1f0(0x224)},'NetPrice':{'$sum':_0x3da1f0(0x1e7)},'discount':{'$sum':_0x3da1f0(0x2ff)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x3da1f0(0x2d5),'category':_0x3da1f0(0x2f8),'brand':_0x3da1f0(0x2af),'product_details':_0x3da1f0(0x2df)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x151579=[],_0x4e84c0={},_0x2c8c78={},_0x40a356={};var _0x47d36a=0x0,_0x216296=0x0,_0x534217=0x0,_0x9dd32c=0x0,_0x25e059=0x0;const _0x1955ed=0x6;for(let _0x1cc24f=0x0;_0x1cc24f<=_0x6a066f['length']-0x1;_0x1cc24f++){const _0x5609d3=_0x6a066f[_0x1cc24f];let _0x5ab428='<tr>';_0x5ab428+=_0x3da1f0(0x1ba)+_0x5609d3['_id'][_0x3da1f0(0x267)]+'</td>',_0x5ab428+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5609d3[_0x3da1f0(0x1e3)]['date']+_0x3da1f0(0x200),_0x5ab428+=_0x3da1f0(0x1ba)+_0x5609d3[_0x3da1f0(0x1e3)][_0x3da1f0(0x2e8)]+_0x3da1f0(0x200);let _0x351491={};var _0xcabed4=0x0;for(let _0x78f797=0x0;_0x78f797<=_0x5609d3[_0x3da1f0(0x23f)][_0x3da1f0(0x24f)]-0x1;_0x78f797++){const _0x172faf=_0x5609d3[_0x3da1f0(0x23f)][_0x78f797];_0x351491[_0x172faf[_0x3da1f0(0x280)]+'-'+_0x172faf[_0x3da1f0(0x2aa)]]=_0x172faf[_0x3da1f0(0x1da)];const _0x19b78a=_0x172faf[_0x3da1f0(0x280)]+'-'+_0x172faf[_0x3da1f0(0x2aa)];!_0x4e84c0[_0x19b78a]&&(_0x4e84c0[_0x19b78a]=0x0),!Array['isArray'](_0x40a356[_0x19b78a])&&(_0x40a356[_0x19b78a]=[]),!Array[_0x3da1f0(0x1e1)](_0x40a356[_0x19b78a])&&(_0x40a356[_0x19b78a]=[]),_0x4e84c0[_0x19b78a]+=_0x172faf[_0x3da1f0(0x1da)],_0x40a356[_0x19b78a][_0x3da1f0(0x2a1)](_0x172faf[_0x3da1f0(0x1da)]),_0xcabed4++;}for(let _0x443af9=0x0;_0x443af9<=_0x47309a[_0x3da1f0(0x252)][_0x3da1f0(0x24f)]-0x1;_0x443af9++){const _0x324e47=_0x47309a[_0x3da1f0(0x252)][_0x443af9],_0x1b1567=_0x324e47['_id'][_0x3da1f0(0x280)]+'-'+_0x324e47['_id']['category'];_0x5ab428+=_0x3da1f0(0x2ca)+(_0x351491[_0x1b1567]!==undefined?_0x351491[_0x1b1567]['toFixed'](0x2):'')+_0x3da1f0(0x200);}_0x534217=_0x5609d3[_0x3da1f0(0x1b6)]+_0x5609d3[_0x3da1f0(0x242)],_0x5ab428+=_0x3da1f0(0x21b)+formatNumber(parseFloat(_0x5609d3[_0x3da1f0(0x254)],0x2)['toFixed'](0x2))+'</td>',_0x5ab428+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5609d3['totalGross']['toFixed'](0x2))+'</td>',_0x5ab428+=_0x3da1f0(0x21b)+formatNumber(_0x534217)+_0x3da1f0(0x200),_0x5ab428+=_0x3da1f0(0x21b)+formatNumber(_0x5609d3[_0x3da1f0(0x269)][_0x3da1f0(0x322)](0x2))+_0x3da1f0(0x200),_0x5ab428+=_0x3da1f0(0x314),_0x47d36a+=parseFloat(_0x5609d3[_0x3da1f0(0x254)]),_0x216296+=parseFloat(_0x5609d3[_0x3da1f0(0x269)][_0x3da1f0(0x322)](0x2)),_0x9dd32c+=_0x534217,_0x25e059+=parseFloat(_0x5609d3['totalGross'][_0x3da1f0(0x322)](0x2));if(_0x1cc24f==_0x6a066f[_0x3da1f0(0x24f)]-0x1){_0x5ab428+=_0x3da1f0(0x2ee),_0x5ab428+=_0x3da1f0(0x21e),_0x5ab428+=_0x3da1f0(0x200);for(let _0x2c7413=0x0;_0x2c7413<=_0x47309a['cat_brand'][_0x3da1f0(0x24f)]-0x1;_0x2c7413++){const _0x4755f0=_0x47309a[_0x3da1f0(0x252)][_0x2c7413],_0x5b7e99=_0x4755f0[_0x3da1f0(0x1e3)][_0x3da1f0(0x280)]+'-'+_0x4755f0[_0x3da1f0(0x1e3)]['category'];!_0x40a356[_0x5b7e99]&&(_0x40a356[_0x5b7e99]=[]);const _0x1a7db1=_0x40a356[_0x5b7e99][_0x3da1f0(0x2b8)]((_0x2b767e,_0x461a04)=>_0x2b767e+_0x461a04,0x0);_0x5ab428+=_0x3da1f0(0x2d8)+(_0x1a7db1!==undefined?formatNumber(_0x1a7db1[_0x3da1f0(0x322)](0x2)):'')+'</b></td>';}_0x5ab428+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x47d36a[_0x3da1f0(0x322)](0x2))+_0x3da1f0(0x1f9),_0x5ab428+=_0x3da1f0(0x2dd)+formatNumber(_0x25e059)+_0x3da1f0(0x1f9),_0x5ab428+=_0x3da1f0(0x2dd)+formatNumber(_0x9dd32c)+_0x3da1f0(0x1f9),_0x5ab428+=_0x3da1f0(0x2dd)+formatNumber(_0x216296)+_0x3da1f0(0x1f9),_0x5ab428+=_0x3da1f0(0x314);}console[_0x3da1f0(0x1fc)](_0x3da1f0(0x31d),_0x47d36a+'+='+parseFloat(_0x5609d3[_0x3da1f0(0x254)])),_0x151579[_0x3da1f0(0x2a1)](_0x5ab428);}function _0x507625(_0x580477,_0x47d748){const _0x26b923=_0x3da1f0,_0x3bf291=[];for(let _0x2c8a7d=0x0;_0x2c8a7d<=_0x580477['length']-0x1;_0x2c8a7d+=_0x47d748){_0x3bf291[_0x26b923(0x2a1)](_0x580477[_0x26b923(0x24d)](_0x2c8a7d,_0x2c8a7d+_0x47d748));}return _0x3bf291;}const _0x4c0cde=_0x507625(_0x151579,_0x1955ed);let _0x3ef94a='';return _0x4c0cde[_0x3da1f0(0x2a9)]((_0x3e97d8,_0x4cbfd2)=>{const _0x54ef4d=_0x3da1f0;_0x4cbfd2>0x0&&(_0x3ef94a+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x3ef94a+=_0x54ef4d(0x21f),_0x3ef94a+=_0x54ef4d(0x1ce),_0x3ef94a+=_0x54ef4d(0x2ee),_0x3ef94a+=_0x54ef4d(0x22c),_0x3ef94a+=_0x54ef4d(0x314),_0x3ef94a+=_0x54ef4d(0x2ee),_0x3ef94a+=_0x54ef4d(0x1c6);for(let _0x114fc8=0x0;_0x114fc8<=_0x7d2498['length']-0x1;_0x114fc8++){const _0x18fb8d=_0x7d2498[_0x114fc8];for(let _0x5a498c=0x0;_0x5a498c<_0x896128[_0x54ef4d(0x24f)];_0x5a498c++){const _0x36ffaa=_0x896128[_0x5a498c];_0x36ffaa[_0x54ef4d(0x1e3)]===_0x18fb8d[_0x54ef4d(0x1e3)][_0x54ef4d(0x2aa)]&&(_0x3ef94a+='<td\x20colspan=\x22'+_0x36ffaa['brandCount']+_0x54ef4d(0x2cd)+_0x18fb8d[_0x54ef4d(0x1e3)][_0x54ef4d(0x2aa)]+_0x54ef4d(0x200));}}_0x3ef94a+=_0x54ef4d(0x1ab),_0x3ef94a+='</tr>',_0x3ef94a+=_0x54ef4d(0x2ee),_0x3ef94a+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x3ef94a+=_0x54ef4d(0x1c4),_0x3ef94a+=_0x54ef4d(0x246);for(let _0x1e7522=0x0;_0x1e7522<=_0x7d2498[_0x54ef4d(0x24f)]-0x1;_0x1e7522++){const _0x3e6adb=_0x7d2498[_0x1e7522];for(let _0x5830dc=0x0;_0x5830dc<_0x47309a[_0x54ef4d(0x252)][_0x54ef4d(0x24f)];_0x5830dc++){const _0x39b271=_0x47309a[_0x54ef4d(0x252)][_0x5830dc];_0x39b271[_0x54ef4d(0x1e3)][_0x54ef4d(0x2aa)]===_0x3e6adb[_0x54ef4d(0x1e3)][_0x54ef4d(0x2aa)]&&(_0x3ef94a+='<td\x20class=\x22cat_data\x22>'+_0x39b271[_0x54ef4d(0x1e3)][_0x54ef4d(0x280)]+_0x54ef4d(0x200));}}_0x3ef94a+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x3ef94a+=_0x54ef4d(0x25c),_0x3ef94a+=_0x54ef4d(0x266),_0x3ef94a+=_0x54ef4d(0x218),_0x3ef94a+=_0x54ef4d(0x314),_0x3ef94a+='</thead>',_0x3ef94a+=_0x54ef4d(0x20e),_0x3e97d8[_0x54ef4d(0x2a9)](_0x37fa94=>{_0x3ef94a+=_0x37fa94;}),_0x3ef94a+='</tbody>',_0x3ef94a+='</table>';}),_0x3ef94a;}function a0_0x4377(_0x33d594,_0x5c90fb){const _0xeddba8=a0_0xeddb();return a0_0x4377=function(_0x4377fe,_0x244dcf){_0x4377fe=_0x4377fe-0x1a2;let _0x425a4e=_0xeddba8[_0x4377fe];return _0x425a4e;},a0_0x4377(_0x33d594,_0x5c90fb);}async function agentsdataDSICheck_excel(_0x3611be,_0x4d1609,_0x15ebd6,_0x55b354){const _0x3924ed=a0_0x44e325,_0x314e1f=await product[_0x3924ed(0x1d7)]([{'$group':{'_id':{'brand':'$brand','category':_0x3924ed(0x23b)},'products':{'$push':{'name':_0x3924ed(0x21c),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x50e76d=[];_0x50e76d['cat_brand']=[];for(let _0x448264=0x0;_0x448264<=_0x314e1f[_0x3924ed(0x24f)]-0x1;_0x448264++){const _0x4de511=_0x314e1f[_0x448264];_0x50e76d['cat_brand'][_0x3924ed(0x2a1)](_0x4de511);}const _0x39fd0f=await product[_0x3924ed(0x1d7)]([{'$group':{'_id':{'category':_0x3924ed(0x23b)},'products':{'$push':{'brand':_0x3924ed(0x26e),'product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x4488fd=await product[_0x3924ed(0x1d7)]([{'$group':{'_id':{'category':_0x3924ed(0x23b),'brand':_0x3924ed(0x26e)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x198da7=await sales_sa[_0x3924ed(0x1d7)]([{'$match':{'date':{'$gte':_0x3611be,'$lte':_0x4d1609},'sales_staff_id':_0x15ebd6,'sale_product.isFG':_0x3924ed(0x210)}},{'$unwind':_0x3924ed(0x302)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x3924ed(0x23f),'localField':_0x3924ed(0x209),'foreignField':_0x3924ed(0x32b),'as':_0x3924ed(0x2de)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x3924ed(0x320),'date':_0x3924ed(0x1cc),'customer':_0x3924ed(0x207)},'totalQty':{'$sum':_0x3924ed(0x2e5)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x3924ed(0x1e8),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x3924ed(0x25b),'product_code':_0x3924ed(0x1aa),'category':'$product_info.category','brand':_0x3924ed(0x1bc),'gross_price':_0x3924ed(0x2f1)}}}}},{'$unwind':_0x3924ed(0x1b7)},{'$group':{'_id':{'dsi':_0x3924ed(0x2a5),'date':'$_id.date','customer':_0x3924ed(0x1d2),'category':_0x3924ed(0x2a6),'brand':_0x3924ed(0x296)},'totalQty':{'$sum':_0x3924ed(0x2bb)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x3924ed(0x315)]}},'NetPrice':{'$sum':_0x3924ed(0x1d1)},'discount':{'$sum':_0x3924ed(0x2d7)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x3924ed(0x27e)}}},{'$group':{'_id':{'dsi':_0x3924ed(0x2a5),'date':_0x3924ed(0x1d5),'customer':_0x3924ed(0x1d2)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x3924ed(0x224)},'NetPrice':{'$sum':_0x3924ed(0x1e7)},'discount':{'$sum':_0x3924ed(0x2ff)},'adj_discount':{'$sum':_0x3924ed(0x2b7)},'products':{'$push':{'qty':_0x3924ed(0x2d5),'category':_0x3924ed(0x2f8),'brand':_0x3924ed(0x2af),'product_details':_0x3924ed(0x2df)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x231440=[],_0x5dd0e5={},_0x5403a9={},_0x39bf3c={};var _0x2fa700=0x0,_0x5ecbf1=0x0,_0x482fdd=0x0,_0x58b76e=0x0,_0x4c3108=0x0;const _0x39117f=0x9184e72a000;for(let _0xce8e07=0x0;_0xce8e07<=_0x198da7[_0x3924ed(0x24f)]-0x1;_0xce8e07++){const _0x2ea51e=_0x198da7[_0xce8e07];let _0x9ac9eb='<tr>';_0x9ac9eb+=_0x3924ed(0x1ba)+_0x2ea51e[_0x3924ed(0x1e3)][_0x3924ed(0x267)]+'</td>',_0x9ac9eb+=_0x3924ed(0x1ba)+_0x2ea51e[_0x3924ed(0x1e3)][_0x3924ed(0x2f4)]+_0x3924ed(0x200),_0x9ac9eb+=_0x3924ed(0x1ba)+_0x2ea51e[_0x3924ed(0x1e3)][_0x3924ed(0x2e8)]+_0x3924ed(0x200);let _0x4795c3={};var _0x25c3c5=0x0;for(let _0x42aba2=0x0;_0x42aba2<=_0x2ea51e[_0x3924ed(0x23f)]['length']-0x1;_0x42aba2++){const _0x1022f2=_0x2ea51e[_0x3924ed(0x23f)][_0x42aba2];_0x4795c3[_0x1022f2[_0x3924ed(0x280)]+'-'+_0x1022f2[_0x3924ed(0x2aa)]]=_0x1022f2[_0x3924ed(0x1da)];const _0x489c58=_0x1022f2[_0x3924ed(0x280)]+'-'+_0x1022f2['category'];!_0x5dd0e5[_0x489c58]&&(_0x5dd0e5[_0x489c58]=0x0),!Array['isArray'](_0x39bf3c[_0x489c58])&&(_0x39bf3c[_0x489c58]=[]),!Array[_0x3924ed(0x1e1)](_0x39bf3c[_0x489c58])&&(_0x39bf3c[_0x489c58]=[]),_0x5dd0e5[_0x489c58]+=_0x1022f2[_0x3924ed(0x1da)],_0x39bf3c[_0x489c58][_0x3924ed(0x2a1)](_0x1022f2[_0x3924ed(0x1da)]),_0x25c3c5++;}for(let _0x3d636d=0x0;_0x3d636d<=_0x50e76d[_0x3924ed(0x252)][_0x3924ed(0x24f)]-0x1;_0x3d636d++){const _0x485f7c=_0x50e76d['cat_brand'][_0x3d636d],_0x594465=_0x485f7c['_id'][_0x3924ed(0x280)]+'-'+_0x485f7c[_0x3924ed(0x1e3)][_0x3924ed(0x2aa)];_0x9ac9eb+=_0x3924ed(0x2ca)+(_0x4795c3[_0x594465]!==undefined?_0x4795c3[_0x594465]['toFixed'](0x2):'')+'</td>';}_0x482fdd=_0x2ea51e[_0x3924ed(0x1b6)]+_0x2ea51e[_0x3924ed(0x242)],_0x9ac9eb+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x2ea51e['totalQty'],0x2)[_0x3924ed(0x322)](0x2))+_0x3924ed(0x200),_0x9ac9eb+=_0x3924ed(0x21b)+formatNumber(_0x2ea51e[_0x3924ed(0x307)]['toFixed'](0x2))+_0x3924ed(0x200),_0x9ac9eb+=_0x3924ed(0x21b)+formatNumber(_0x482fdd)+_0x3924ed(0x200),_0x9ac9eb+=_0x3924ed(0x21b)+formatNumber(_0x2ea51e[_0x3924ed(0x269)][_0x3924ed(0x322)](0x2))+_0x3924ed(0x200),_0x9ac9eb+=_0x3924ed(0x314),_0x2fa700+=parseFloat(_0x2ea51e[_0x3924ed(0x254)][_0x3924ed(0x322)](0x2)),_0x5ecbf1+=parseFloat(_0x2ea51e[_0x3924ed(0x269)][_0x3924ed(0x322)](0x2)),_0x58b76e+=_0x482fdd,_0x4c3108+=parseFloat(_0x2ea51e[_0x3924ed(0x307)][_0x3924ed(0x322)](0x2));if(_0xce8e07==_0x198da7[_0x3924ed(0x24f)]-0x1){_0x9ac9eb+=_0x3924ed(0x2ee),_0x9ac9eb+=_0x3924ed(0x21e),_0x9ac9eb+=_0x3924ed(0x200);for(let _0x5b4ab5=0x0;_0x5b4ab5<=_0x50e76d[_0x3924ed(0x252)][_0x3924ed(0x24f)]-0x1;_0x5b4ab5++){const _0x4847a4=_0x50e76d[_0x3924ed(0x252)][_0x5b4ab5],_0x2116e4=_0x4847a4['_id'][_0x3924ed(0x280)]+'-'+_0x4847a4[_0x3924ed(0x1e3)]['category'];!_0x39bf3c[_0x2116e4]&&(_0x39bf3c[_0x2116e4]=[]);const _0x36e139=_0x39bf3c[_0x2116e4][_0x3924ed(0x2b8)]((_0xaf5b31,_0x1c0fb9)=>_0xaf5b31+_0x1c0fb9,0x0);_0x9ac9eb+=_0x3924ed(0x2d8)+(_0x36e139!==undefined?formatNumber(_0x36e139[_0x3924ed(0x322)](0x2)):'')+'</b></td>';}_0x9ac9eb+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2fa700[_0x3924ed(0x322)](0x2))+_0x3924ed(0x1f9),_0x9ac9eb+=_0x3924ed(0x2dd)+formatNumber(_0x4c3108)+_0x3924ed(0x1f9),_0x9ac9eb+=_0x3924ed(0x2dd)+formatNumber(_0x58b76e)+'</b></td>',_0x9ac9eb+=_0x3924ed(0x2dd)+formatNumber(_0x5ecbf1)+_0x3924ed(0x1f9),_0x9ac9eb+='</tr>';}_0x231440[_0x3924ed(0x2a1)](_0x9ac9eb);}function _0x2f15e9(_0x2ce267,_0xf9e4ef){const _0x6579db=_0x3924ed,_0x17ff66=[];for(let _0x23d110=0x0;_0x23d110<=_0x2ce267[_0x6579db(0x24f)]-0x1;_0x23d110+=_0xf9e4ef){_0x17ff66[_0x6579db(0x2a1)](_0x2ce267['slice'](_0x23d110,_0x23d110+_0xf9e4ef));}return _0x17ff66;}const _0x408551=_0x2f15e9(_0x231440,_0x39117f);let _0x219e9c='';return _0x408551[_0x3924ed(0x2a9)]((_0x157370,_0x2dae3c)=>{const _0x8bdb35=_0x3924ed;_0x2dae3c>0x0&&(_0x219e9c+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x219e9c+=_0x8bdb35(0x21f),_0x219e9c+=_0x8bdb35(0x1ce),_0x219e9c+=_0x8bdb35(0x2ee),_0x219e9c+=_0x8bdb35(0x22c),_0x219e9c+=_0x8bdb35(0x314),_0x219e9c+='<tr>',_0x219e9c+=_0x8bdb35(0x1c6);for(let _0x415983=0x0;_0x415983<=_0x39fd0f['length']-0x1;_0x415983++){const _0x1b43f8=_0x39fd0f[_0x415983];for(let _0x1b91ba=0x0;_0x1b91ba<_0x4488fd['length'];_0x1b91ba++){const _0xb6096a=_0x4488fd[_0x1b91ba];_0xb6096a['_id']===_0x1b43f8[_0x8bdb35(0x1e3)]['category']&&(_0x219e9c+=_0x8bdb35(0x215)+_0xb6096a[_0x8bdb35(0x22d)]+_0x8bdb35(0x2cd)+_0x1b43f8[_0x8bdb35(0x1e3)]['category']+_0x8bdb35(0x200));}}_0x219e9c+=_0x8bdb35(0x1ab),_0x219e9c+=_0x8bdb35(0x314),_0x219e9c+=_0x8bdb35(0x2ee),_0x219e9c+=_0x8bdb35(0x273),_0x219e9c+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x219e9c+=_0x8bdb35(0x246);for(let _0xe5f1d2=0x0;_0xe5f1d2<=_0x39fd0f[_0x8bdb35(0x24f)]-0x1;_0xe5f1d2++){const _0x2ff579=_0x39fd0f[_0xe5f1d2];for(let _0x344eac=0x0;_0x344eac<_0x50e76d[_0x8bdb35(0x252)][_0x8bdb35(0x24f)];_0x344eac++){const _0xa3c5dc=_0x50e76d[_0x8bdb35(0x252)][_0x344eac];_0xa3c5dc['_id'][_0x8bdb35(0x2aa)]===_0x2ff579[_0x8bdb35(0x1e3)]['category']&&(_0x219e9c+=_0x8bdb35(0x1a9)+_0xa3c5dc[_0x8bdb35(0x1e3)][_0x8bdb35(0x280)]+'</td>');}}_0x219e9c+=_0x8bdb35(0x2d2),_0x219e9c+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x219e9c+=_0x8bdb35(0x266),_0x219e9c+=_0x8bdb35(0x218),_0x219e9c+=_0x8bdb35(0x314),_0x219e9c+=_0x8bdb35(0x2b4),_0x219e9c+=_0x8bdb35(0x20e),_0x157370[_0x8bdb35(0x2a9)](_0x1b1523=>{_0x219e9c+=_0x1b1523;}),console['log'](_0x39bf3c),_0x219e9c+=_0x8bdb35(0x231),_0x219e9c+=_0x8bdb35(0x328);}),_0x219e9c;}router[a0_0x44e325(0x2a7)](a0_0x44e325(0x2c6),auth,async(_0x45e15a,_0x145879)=>{const _0x13a200=a0_0x44e325,{from_date:_0x3d0a40,to_date:_0x1841c9,isExcel:_0x18166d}=_0x45e15a['body'],_0x5e7cb8=_0x45e15a[_0x13a200(0x30b)],_0x4c0bfb=await staff[_0x13a200(0x2a3)]({'email':_0x5e7cb8[_0x13a200(0x312)]}),_0x51a27f=await master_shop[_0x13a200(0x292)](),_0x521945=await agentsdataDSICheck(_0x3d0a40,_0x1841c9,_0x4c0bfb[_0x13a200(0x1e3)]['valueOf'](),_0x18166d),_0x5707d5=await agentsdataDSICheck_excel(_0x3d0a40,_0x1841c9,_0x4c0bfb[_0x13a200(0x1e3)]['valueOf'](),_0x18166d);let _0x45d922='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x24cee5=new Date(_0x3d0a40),_0x101e68=new Date(_0x1841c9);const _0x506d04={'year':'numeric','month':_0x13a200(0x227),'day':_0x13a200(0x28d)},_0x21930a=new Intl[(_0x13a200(0x206))](_0x13a200(0x211),_0x506d04)[_0x13a200(0x287)](_0x24cee5),_0x57391a=new Intl[(_0x13a200(0x206))](_0x13a200(0x211),_0x506d04)[_0x13a200(0x287)](_0x101e68);_0x45d922+=_0x13a200(0x2ac),_0x45d922+='<div\x20\x20id=\x22table-conatainer\x22>',_0x45d922+=_0x13a200(0x21f),_0x45d922+=_0x521945,_0x45d922+=_0x13a200(0x328),_0x45d922+='</div>',_0x45d922+=_0x13a200(0x306);let _0x1ed147=_0x13a200(0x1dd);_0x1ed147+='<div\x20class=\x22row\x22>',_0x1ed147+=_0x13a200(0x1df),_0x1ed147+=_0x13a200(0x21f),_0x1ed147+=_0x5707d5,_0x1ed147+=_0x13a200(0x328),_0x1ed147+=_0x13a200(0x306),_0x1ed147+=_0x13a200(0x306);let _0x14d60b=_0x13a200(0x271);const _0x2b10ce={'width':'15in','height':_0x13a200(0x1ca),'orientation':_0x13a200(0x331),'border':{'top':_0x13a200(0x1ed),'right':_0x13a200(0x1ed),'bottom':_0x13a200(0x1ed),'left':_0x13a200(0x1ed)},'header':{'height':_0x13a200(0x1dc),'contents':_0x13a200(0x279)+_0x14d60b+_0x13a200(0x25a)+_0x21930a+'\x20-\x20'+_0x57391a+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':'20mm','contents':{'default':_0x13a200(0x326)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x18166d=='on'){const _0x131f31=cheerio[_0x13a200(0x29f)](_0x1ed147);let _0x2756ad=[],_0x2449f9=[],_0x55a5a6=[];const _0x550bf7=_0x3fdedc=>{const _0xde293a=_0x13a200,_0x880e9b={'top':{'style':'thick','color':{'rgb':_0xde293a(0x1b5)}},'bottom':{'style':_0xde293a(0x255),'color':{'rgb':_0xde293a(0x1b5)}},'left':{'style':_0xde293a(0x255),'color':{'rgb':_0xde293a(0x1b5)}},'right':{'style':_0xde293a(0x255),'color':{'rgb':_0xde293a(0x1b5)}}};if(_0x3fdedc){const _0x24f951=_0x3fdedc[_0xde293a(0x2c0)](';')[_0xde293a(0x2b8)]((_0x456816,_0xf5946c)=>{const _0x1c5ae6=_0xde293a,[_0x594444,_0x3a9f0a]=_0xf5946c[_0x1c5ae6(0x2c0)](':')[_0x1c5ae6(0x2bf)](_0x73dc94=>_0x73dc94[_0x1c5ae6(0x258)]());return _0x456816[_0x594444]=_0x3a9f0a,_0x456816;},{});_0x24f951[_0xde293a(0x2e9)]&&(_0x880e9b[_0xde293a(0x24b)][_0xde293a(0x1ee)]=_0x24f951['border-top'][_0xde293a(0x223)](_0xde293a(0x226))?_0xde293a(0x226):_0xde293a(0x321)),_0x24f951['border-bottom']&&(_0x880e9b[_0xde293a(0x31c)][_0xde293a(0x1ee)]=_0x24f951[_0xde293a(0x1d3)][_0xde293a(0x223)](_0xde293a(0x226))?'thin':_0xde293a(0x321)),_0x24f951['border-left']&&(_0x880e9b[_0xde293a(0x22a)]['style']=_0x24f951['border-left'][_0xde293a(0x223)](_0xde293a(0x226))?_0xde293a(0x226):_0xde293a(0x321)),_0x24f951[_0xde293a(0x1c3)]&&(_0x880e9b[_0xde293a(0x1c7)][_0xde293a(0x1ee)]=_0x24f951['border-right'][_0xde293a(0x223)](_0xde293a(0x226))?_0xde293a(0x226):_0xde293a(0x321));}return _0x880e9b;};_0x131f31(_0x13a200(0x303))[_0x13a200(0x2a2)]((_0x123826,_0x30c0f8)=>{const _0x541f25=_0x13a200;let _0x4bb22e=[],_0x535405=0x0;while(_0x55a5a6[_0x535405]){_0x55a5a6[_0x535405]--,_0x535405++;}_0x131f31(_0x30c0f8)[_0x541f25(0x292)](_0x541f25(0x1f1))[_0x541f25(0x2a2)]((_0x1763c6,_0x16ef63)=>{const _0x4ad3e6=_0x541f25;let _0x2dc4bf=_0x131f31(_0x16ef63)[_0x4ad3e6(0x1cd)]()[_0x4ad3e6(0x258)](),_0x31aa8f=parseFloat(_0x2dc4bf[_0x4ad3e6(0x32c)](/,/g,'')),_0x587dae={};!isNaN(_0x31aa8f)?(_0x587dae['v']=_0x31aa8f,_0x587dae['t']='n'):(_0x587dae['v']=_0x2dc4bf,_0x587dae['t']='s');const _0x171e85=_0x131f31(_0x16ef63)[_0x4ad3e6(0x1c8)](_0x4ad3e6(0x1ee)),_0x4319e6=_0x550bf7(_0x171e85);_0x587dae['s']={'border':_0x4319e6},_0x4bb22e[_0x535405]=_0x587dae;let _0x268071=parseInt(_0x131f31(_0x16ef63)[_0x4ad3e6(0x1c8)](_0x4ad3e6(0x1bf)))||0x1,_0x2dc340=parseInt(_0x131f31(_0x16ef63)['attr']('rowspan'))||0x1;(_0x268071>0x1||_0x2dc340>0x1)&&_0x2449f9[_0x4ad3e6(0x2a1)]({'s':{'r':_0x123826,'c':_0x535405},'e':{'r':_0x123826+_0x2dc340-0x1,'c':_0x535405+_0x268071-0x1}});for(let _0x567926=0x0;_0x567926<_0x268071;_0x567926++){_0x2dc340>0x1&&(_0x55a5a6[_0x535405+_0x567926]=_0x2dc340-0x1);}_0x535405+=_0x268071;}),_0x2756ad[_0x541f25(0x2a1)](_0x4bb22e);});const _0x3c8289=XLSX[_0x13a200(0x2ef)][_0x13a200(0x1b9)](),_0x4b43af=XLSX[_0x13a200(0x2ef)][_0x13a200(0x290)](_0x2756ad);_0x2449f9[_0x13a200(0x24f)]>0x0&&(_0x4b43af[_0x13a200(0x316)]=_0x2449f9);_0x4b43af[_0x13a200(0x282)]=_0x2756ad[0x0][_0x13a200(0x2bf)](()=>({'wpx':0x64})),XLSX[_0x13a200(0x2ef)][_0x13a200(0x23a)](_0x3c8289,_0x4b43af,_0x13a200(0x2b5));const _0x138059=XLSX['write'](_0x3c8289,{'bookType':_0x13a200(0x276),'type':_0x13a200(0x1c0)});_0x145879['setHeader'](_0x13a200(0x2f9),_0x13a200(0x2c3)),_0x145879[_0x13a200(0x238)]('Content-Type',_0x13a200(0x1af)),_0x145879[_0x13a200(0x1e5)](_0x138059);}else pdf[_0x13a200(0x309)](_0x45d922,_0x2b10ce)['toStream'](function(_0x1d185c,_0x5a72e1){const _0x10e516=_0x13a200;if(_0x1d185c){console[_0x10e516(0x2b2)](_0x10e516(0x313),_0x1d185c),_0x145879[_0x10e516(0x2e7)](0x1f4)[_0x10e516(0x1e5)](_0x10e516(0x225)+_0x1d185c);return;}_0x145879[_0x10e516(0x238)]('Content-Type',_0x10e516(0x205)),_0x5a72e1[_0x10e516(0x2fa)](_0x145879);});}),router[a0_0x44e325(0x268)](a0_0x44e325(0x219),auth,async(_0x452428,_0x464d75)=>{const _0x469821=a0_0x44e325;try{const {username:_0xfcfe33,email:_0x3cc523,role:_0x4b33d7}=_0x452428[_0x469821(0x30b)],_0x26b1d9=_0x452428[_0x469821(0x30b)],_0x1cd7c2=await profile[_0x469821(0x2a3)]({'email':_0x26b1d9['email']}),_0x4308a0={'year':'numeric','month':_0x469821(0x227),'day':'numeric'},_0x1e0f0c=await master_shop[_0x469821(0x292)](),_0x2d87ee=await product[_0x469821(0x292)](),_0x20d918=await warehouse[_0x469821(0x1d7)]([{'$unwind':_0x469821(0x2df)},{'$lookup':{'from':'products','localField':_0x469821(0x257),'foreignField':'name','as':'product_docs'}},{'$unwind':_0x469821(0x332)},{'$project':{'product_name':_0x469821(0x1d9),'product_stock':_0x469821(0x2c7)}},{'$group':{'_id':_0x469821(0x289),'product_stock':{'$sum':_0x469821(0x2be)}}}]),_0xd4b826=await staff[_0x469821(0x2a3)]({'email':_0x26b1d9[_0x469821(0x312)]});if(_0x1e0f0c[0x0]['language']==_0x469821(0x1ff))var _0x3b18a9=users['English'];else{if(_0x1e0f0c[0x0][_0x469821(0x1e0)]==_0x469821(0x2b9))var _0x3b18a9=users['Hindi'];else{if(_0x1e0f0c[0x0][_0x469821(0x1e0)]==_0x469821(0x29a))var _0x3b18a9=users['German'];else{if(_0x1e0f0c[0x0][_0x469821(0x1e0)]=='Spanish')var _0x3b18a9=users[_0x469821(0x2ed)];else{if(_0x1e0f0c[0x0][_0x469821(0x1e0)]==_0x469821(0x1eb))var _0x3b18a9=users[_0x469821(0x1eb)];else{if(_0x1e0f0c[0x0]['language']==_0x469821(0x284))var _0x3b18a9=users['Portuguese'];else{if(_0x1e0f0c[0x0][_0x469821(0x1e0)]==_0x469821(0x20a))var _0x3b18a9=users[_0x469821(0x20a)];else{if(_0x1e0f0c[0x0][_0x469821(0x1e0)]==_0x469821(0x1c9))var _0x3b18a9=users[_0x469821(0x2f5)];}}}}}}}_0x464d75[_0x469821(0x245)](_0x469821(0x2c8),{'success':_0x452428[_0x469821(0x1e6)]('success'),'errors':_0x452428['flash'](_0x469821(0x2a8)),'alldata':_0x2d87ee,'profile':_0x1cd7c2,'master_shop':_0x1e0f0c,'role':_0x26b1d9,'product_stock':_0x20d918,'language':_0x3b18a9,'staff_arr':_0xd4b826});}catch(_0x37b0bd){}});async function dataSalesReports(_0x564f08,_0x45c210,_0x440040){const _0x342072=a0_0x44e325;let _0x2be648='';const _0x4a1bc2=await sales_sa[_0x342072(0x1d7)]([{'$match':{'date':{'$gte':_0x564f08,'$lte':_0x45c210},'sales_staff_id':_0x440040}},{'$unwind':_0x342072(0x302)},{'$match':{'sale_product.isFG':_0x342072(0x210)}},{'$group':{'_id':{'product_name':_0x342072(0x304),'product_code':_0x342072(0x263)},'sumqty':{'$sum':_0x342072(0x2e5)},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x5d498f=0x0,_0x3505ad=0x0;for(let _0x486181=0x0;_0x486181<=_0x4a1bc2[_0x342072(0x24f)]-0x1;_0x486181++){const _0xb50f2f=_0x4a1bc2[_0x486181];var _0x3c26ed=_0xb50f2f[_0x342072(0x329)][_0x342072(0x2ce)](undefined),_0x3c8f53=_0xb50f2f['sumqty'][_0x342072(0x2ce)](undefined);_0x2be648+='<tr>',_0x2be648+=_0x342072(0x2f7)+_0xb50f2f[_0x342072(0x1e3)][_0x342072(0x32b)]+_0x342072(0x200),_0x2be648+=_0x342072(0x2f7)+_0xb50f2f[_0x342072(0x1e3)][_0x342072(0x1ea)]+_0x342072(0x200),_0x2be648+=_0x342072(0x2f7)+formatNumber(_0xb50f2f['sumqty'][_0x342072(0x322)](0x2))+'</td>',_0x2be648+=_0x342072(0x2f7)+formatNumber(_0xb50f2f['totalPrice'][_0x342072(0x322)](0x2))+_0x342072(0x200),_0x2be648+=_0x342072(0x314),_0x5d498f+=parseFloat(_0xb50f2f['sumqty']),_0x3505ad+=parseFloat(_0xb50f2f['totalPrice']);}var _0x55ee89=_0x3505ad[_0x342072(0x2ce)](undefined),_0x37784d=_0x5d498f[_0x342072(0x2ce)](undefined);return _0x2be648+=_0x342072(0x2ee),_0x2be648+=_0x342072(0x318),_0x2be648+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x5d498f['toFixed'](0x2))+_0x342072(0x1f9),_0x2be648+=_0x342072(0x2fc)+formatNumber(_0x3505ad[_0x342072(0x322)](0x2))+'</b></td>',_0x2be648+='</tr>',_0x2be648;}router[a0_0x44e325(0x2a7)](a0_0x44e325(0x29d),auth,async(_0x11f118,_0x389f63)=>{const _0x28c83c=a0_0x44e325;try{const {from_date:_0x5e3ff1,to_date:_0x25f89d,isExcel:_0x3ea3fa}=_0x11f118[_0x28c83c(0x21d)],_0x8e25ab=_0x11f118[_0x28c83c(0x30b)],_0x8ccc75=await staff[_0x28c83c(0x2a3)]({'email':_0x8e25ab[_0x28c83c(0x312)]});let _0x3d94fe=_0x28c83c(0x278);var _0x3b9243=new Date(_0x5e3ff1),_0x3e212b=new Date(_0x25f89d);const _0x452d00={'year':'numeric','month':_0x28c83c(0x227),'day':_0x28c83c(0x28d)},_0x3827a5=new Intl['DateTimeFormat']('en-US',_0x452d00)[_0x28c83c(0x287)](_0x3b9243),_0x7c87e5=new Intl[(_0x28c83c(0x206))](_0x28c83c(0x211),_0x452d00)[_0x28c83c(0x287)](_0x3e212b);var _0x5bac19=await dataSalesReports(_0x5e3ff1,_0x25f89d,_0x8ccc75[_0x28c83c(0x1e3)][_0x28c83c(0x235)]());_0x3d94fe+=_0x28c83c(0x2ac),_0x3d94fe+=_0x28c83c(0x26d),_0x3d94fe+=_0x28c83c(0x21f),_0x3d94fe+='<tr>',_0x3d94fe+=_0x28c83c(0x311),_0x3d94fe+=_0x28c83c(0x22f),_0x3d94fe+='<th>\x20QTY\x20SOLD\x20</th>',_0x3d94fe+='<th>\x20INVOICE\x20AMOUNT\x20</th>',_0x3d94fe+=_0x28c83c(0x2ee),_0x3d94fe+=_0x5bac19,_0x3d94fe+=_0x28c83c(0x314),_0x3d94fe+=_0x28c83c(0x306),_0x3d94fe+=_0x28c83c(0x306);let _0x5d7dd6=_0x28c83c(0x271);const _0x16b944={'width':_0x28c83c(0x1ae),'height':_0x28c83c(0x1ca),'orientation':_0x28c83c(0x331),'border':{'top':'0.1in','right':_0x28c83c(0x1ed),'bottom':_0x28c83c(0x1ed),'left':_0x28c83c(0x1ed)},'header':{'height':_0x28c83c(0x1dc),'contents':_0x28c83c(0x279)+_0x5d7dd6+_0x28c83c(0x295)+_0x8ccc75[_0x28c83c(0x1a7)]+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x3827a5+'\x20-\x20'+_0x7c87e5+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x28c83c(0x1c1),'contents':{'default':_0x28c83c(0x326)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x28c83c(0x2bc)}}};if(_0x3ea3fa=='on'){const _0x1e8af5=cheerio[_0x28c83c(0x29f)](_0x3d94fe);let _0x1d4b81=[],_0x202da4=[],_0x39d03d=[];const _0x5f10eb=_0x1d0749=>{const _0x35d842=_0x28c83c,_0x3cb6b3={'top':{'style':_0x35d842(0x255),'color':{'rgb':'000000'}},'bottom':{'style':_0x35d842(0x255),'color':{'rgb':'000000'}},'left':{'style':_0x35d842(0x255),'color':{'rgb':_0x35d842(0x1b5)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x1d0749){const _0x2ced7b=_0x1d0749['split'](';')['reduce']((_0x592ff0,_0x538d6e)=>{const _0x11e635=_0x35d842,[_0x457744,_0x235e08]=_0x538d6e[_0x11e635(0x2c0)](':')[_0x11e635(0x2bf)](_0x590c43=>_0x590c43['trim']());return _0x592ff0[_0x457744]=_0x235e08,_0x592ff0;},{});_0x2ced7b[_0x35d842(0x2e9)]&&(_0x3cb6b3[_0x35d842(0x24b)][_0x35d842(0x1ee)]=_0x2ced7b[_0x35d842(0x2e9)][_0x35d842(0x223)](_0x35d842(0x226))?_0x35d842(0x226):_0x35d842(0x321)),_0x2ced7b['border-bottom']&&(_0x3cb6b3[_0x35d842(0x31c)]['style']=_0x2ced7b['border-bottom'][_0x35d842(0x223)](_0x35d842(0x226))?_0x35d842(0x226):_0x35d842(0x321)),_0x2ced7b[_0x35d842(0x2b3)]&&(_0x3cb6b3[_0x35d842(0x22a)][_0x35d842(0x1ee)]=_0x2ced7b[_0x35d842(0x2b3)][_0x35d842(0x223)](_0x35d842(0x226))?_0x35d842(0x226):_0x35d842(0x321)),_0x2ced7b[_0x35d842(0x1c3)]&&(_0x3cb6b3[_0x35d842(0x1c7)][_0x35d842(0x1ee)]=_0x2ced7b[_0x35d842(0x1c3)][_0x35d842(0x223)](_0x35d842(0x226))?_0x35d842(0x226):_0x35d842(0x321));}return _0x3cb6b3;};_0x1e8af5(_0x28c83c(0x303))[_0x28c83c(0x2a2)]((_0x34a751,_0x25d163)=>{const _0x2d2d66=_0x28c83c;let _0x3a3574=[],_0x373905=0x0;while(_0x39d03d[_0x373905]){_0x39d03d[_0x373905]--,_0x373905++;}_0x1e8af5(_0x25d163)[_0x2d2d66(0x292)](_0x2d2d66(0x1f1))[_0x2d2d66(0x2a2)]((_0x3b8f24,_0x4cd908)=>{const _0x20d975=_0x2d2d66;let _0x390fad=_0x1e8af5(_0x4cd908)[_0x20d975(0x1cd)]()[_0x20d975(0x258)](),_0x46d8be=parseFloat(_0x390fad[_0x20d975(0x32c)](/,/g,'')),_0x3724d9={};!isNaN(_0x46d8be)?(_0x3724d9['v']=_0x46d8be,_0x3724d9['t']='n'):(_0x3724d9['v']=_0x390fad,_0x3724d9['t']='s');const _0x3da962=_0x1e8af5(_0x4cd908)[_0x20d975(0x1c8)](_0x20d975(0x1ee)),_0x39d854=_0x5f10eb(_0x3da962);_0x3724d9['s']={'border':_0x39d854},_0x3a3574[_0x373905]=_0x3724d9;let _0x5b0465=parseInt(_0x1e8af5(_0x4cd908)[_0x20d975(0x1c8)](_0x20d975(0x1bf)))||0x1,_0x188f58=parseInt(_0x1e8af5(_0x4cd908)[_0x20d975(0x1c8)](_0x20d975(0x327)))||0x1;(_0x5b0465>0x1||_0x188f58>0x1)&&_0x202da4[_0x20d975(0x2a1)]({'s':{'r':_0x34a751,'c':_0x373905},'e':{'r':_0x34a751+_0x188f58-0x1,'c':_0x373905+_0x5b0465-0x1}});for(let _0x26b6fb=0x0;_0x26b6fb<_0x5b0465;_0x26b6fb++){_0x188f58>0x1&&(_0x39d03d[_0x373905+_0x26b6fb]=_0x188f58-0x1);}_0x373905+=_0x5b0465;}),_0x1d4b81[_0x2d2d66(0x2a1)](_0x3a3574);});const _0x240011=XLSX[_0x28c83c(0x2ef)][_0x28c83c(0x1b9)](),_0x3304e1=XLSX[_0x28c83c(0x2ef)]['aoa_to_sheet'](_0x1d4b81);_0x202da4[_0x28c83c(0x24f)]>0x0&&(_0x3304e1['!merges']=_0x202da4);_0x3304e1['!cols']=_0x1d4b81[0x0][_0x28c83c(0x2bf)](()=>({'wpx':0x64})),XLSX[_0x28c83c(0x2ef)]['book_append_sheet'](_0x240011,_0x3304e1,_0x28c83c(0x2b5));const _0x5f5bdb=XLSX['write'](_0x240011,{'bookType':_0x28c83c(0x276),'type':'buffer'});_0x389f63[_0x28c83c(0x238)]('Content-Disposition',_0x28c83c(0x2c3)),_0x389f63[_0x28c83c(0x238)](_0x28c83c(0x324),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x389f63['send'](_0x5f5bdb);}else pdf[_0x28c83c(0x309)](_0x3d94fe,_0x16b944)[_0x28c83c(0x28e)](function(_0x4c5051,_0x421ac2){const _0x289f6b=_0x28c83c;if(_0x4c5051){_0x389f63[_0x289f6b(0x2e7)](0x1f4)['send'](_0x289f6b(0x225));return;}_0x389f63[_0x289f6b(0x238)]('Content-Type',_0x289f6b(0x205)),_0x421ac2['pipe'](_0x389f63);});}catch(_0x1c2bdd){}}),router['get'](a0_0x44e325(0x2dc),auth,async(_0xd13906,_0x192952)=>{const _0x3b5656=a0_0x44e325;try{const {username:_0x49c3e9,email:_0x13a880,role:_0x46b720}=_0xd13906[_0x3b5656(0x30b)],_0x27a137=_0xd13906[_0x3b5656(0x30b)],_0x2952f4=await profile[_0x3b5656(0x2a3)]({'email':_0x27a137[_0x3b5656(0x312)]}),_0x848c23={'year':_0x3b5656(0x28d),'month':_0x3b5656(0x227),'day':_0x3b5656(0x28d)},_0x54d5c0=await master_shop[_0x3b5656(0x292)](),_0x5704e2=await product[_0x3b5656(0x292)](),_0x122dbf=await warehouse[_0x3b5656(0x1d7)]([{'$unwind':_0x3b5656(0x2df)},{'$lookup':{'from':_0x3b5656(0x23f),'localField':_0x3b5656(0x257),'foreignField':'name','as':'product_docs'}},{'$unwind':_0x3b5656(0x332)},{'$project':{'product_name':_0x3b5656(0x1d9),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x3b5656(0x289),'product_stock':{'$sum':_0x3b5656(0x2be)}}}]);if(_0x54d5c0[0x0][_0x3b5656(0x1e0)]==_0x3b5656(0x1ff))var _0x3aa888=users[_0x3b5656(0x203)];else{if(_0x54d5c0[0x0][_0x3b5656(0x1e0)]==_0x3b5656(0x2b9))var _0x3aa888=users['Hindi'];else{if(_0x54d5c0[0x0]['language']=='German')var _0x3aa888=users[_0x3b5656(0x29a)];else{if(_0x54d5c0[0x0][_0x3b5656(0x1e0)]==_0x3b5656(0x2ed))var _0x3aa888=users[_0x3b5656(0x2ed)];else{if(_0x54d5c0[0x0][_0x3b5656(0x1e0)]==_0x3b5656(0x1eb))var _0x3aa888=users[_0x3b5656(0x1eb)];else{if(_0x54d5c0[0x0][_0x3b5656(0x1e0)]==_0x3b5656(0x284))var _0x3aa888=users[_0x3b5656(0x20f)];else{if(_0x54d5c0[0x0][_0x3b5656(0x1e0)]==_0x3b5656(0x20a))var _0x3aa888=users[_0x3b5656(0x20a)];else{if(_0x54d5c0[0x0][_0x3b5656(0x1e0)]==_0x3b5656(0x1c9))var _0x3aa888=users[_0x3b5656(0x2f5)];}}}}}}}_0x192952['render'](_0x3b5656(0x1e4),{'success':_0xd13906[_0x3b5656(0x1e6)](_0x3b5656(0x1a5)),'errors':_0xd13906[_0x3b5656(0x1e6)](_0x3b5656(0x2a8)),'alldata':_0x5704e2,'profile':_0x2952f4,'master_shop':_0x54d5c0,'role':_0x27a137,'product_stock':_0x122dbf,'language':_0x3aa888});}catch(_0x5c0207){}});async function dataInventoryReports(_0x52c63e,_0x1c1031,_0x3b35c3){const _0x7d5f7e=a0_0x44e325,_0x39738d=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x52c63e,'$lte':_0x1c1031},'sales_staff_id':_0x3b35c3}},{'$unwind':_0x7d5f7e(0x302)},{'$group':{'_id':{'product_name':_0x7d5f7e(0x304),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x17dfde=mongoose[_0x7d5f7e(0x1db)][_0x7d5f7e(0x260)],_0x1ffcc0=await staff[_0x7d5f7e(0x1d7)]([{'$match':{'_id':_0x17dfde(_0x3b35c3)}},{'$unwind':_0x7d5f7e(0x32a)},{'$match':{'product_list.isConfirm':_0x7d5f7e(0x24e)}},{'$group':{'_id':{'product_name':'$product_list.product_name','product_code':_0x7d5f7e(0x2f0)},'sumqty':{'$sum':_0x7d5f7e(0x2b0)}}},{'$sort':{'_id.product_name':0x1}}]),_0x380aa5=await sales_inv_data[_0x7d5f7e(0x1d7)]([{'$match':{'date':{'$gte':_0x52c63e,'$lte':_0x1c1031},'sales_staff_id':_0x3b35c3}},{'$unwind':_0x7d5f7e(0x302)},{'$group':{'_id':{'product_name':_0x7d5f7e(0x304),'product_code':_0x7d5f7e(0x263)},'totalQTYsum':{'$sum':'$sale_product.stock'}}}]);console[_0x7d5f7e(0x1fc)](_0x380aa5);let _0x3770ef='';var _0x11a60e=0x0;for(let _0x4389e6=0x0;_0x4389e6<=_0x1ffcc0[_0x7d5f7e(0x24f)]-0x1;_0x4389e6++){const _0x1946ff=_0x1ffcc0[_0x4389e6];_0x3770ef+=_0x7d5f7e(0x2ee),_0x3770ef+=_0x7d5f7e(0x2a4)+_0x1946ff[_0x7d5f7e(0x1e3)][_0x7d5f7e(0x32b)]+_0x7d5f7e(0x200),_0x3770ef+=_0x7d5f7e(0x2c4)+_0x1946ff[_0x7d5f7e(0x1e3)][_0x7d5f7e(0x1ea)]+_0x7d5f7e(0x200);var _0x101a43=_0x1946ff[_0x7d5f7e(0x288)],_0x317ea9=0x0;for(let _0xa27faa=0x0;_0xa27faa<=_0x39738d[_0x7d5f7e(0x24f)]-0x1;_0xa27faa++){const _0x2d979a=_0x39738d[_0xa27faa];_0x1946ff[_0x7d5f7e(0x1e3)][_0x7d5f7e(0x32b)]==_0x2d979a[_0x7d5f7e(0x1e3)][_0x7d5f7e(0x32b)]&&_0x1946ff[_0x7d5f7e(0x1e3)]['product_name']==_0x2d979a[_0x7d5f7e(0x1e3)][_0x7d5f7e(0x1ea)]&&(_0x317ea9=_0x2d979a[_0x7d5f7e(0x288)]);}var _0x2d14bd=0x0;for(let _0x14bb84=0x0;_0x14bb84<=_0x380aa5[_0x7d5f7e(0x24f)]-0x1;_0x14bb84++){const _0x4dcc3e=_0x380aa5[_0x14bb84];_0x1946ff[_0x7d5f7e(0x1e3)]['product_code']==_0x4dcc3e[_0x7d5f7e(0x1e3)]['product_code']&&_0x1946ff[_0x7d5f7e(0x1e3)]['product_name']==_0x4dcc3e['_id']['product_name']&&(_0x2d14bd=_0x4dcc3e[_0x7d5f7e(0x234)]);}_0x11a60e=_0x101a43-_0x2d14bd+_0x317ea9,_0x3770ef+='<td\x20class=\x22row_data\x22>'+_0x11a60e+'</td>';let _0x21ab37=![];for(let _0x56e0e6=0x0;_0x56e0e6<=_0x380aa5[_0x7d5f7e(0x24f)]-0x1;_0x56e0e6++){const _0x4929b9=_0x380aa5[_0x56e0e6];if(_0x1946ff[_0x7d5f7e(0x1e3)][_0x7d5f7e(0x32b)]==_0x4929b9[_0x7d5f7e(0x1e3)][_0x7d5f7e(0x32b)]&&_0x1946ff['_id'][_0x7d5f7e(0x1ea)]==_0x4929b9[_0x7d5f7e(0x1e3)]['product_name']){_0x3770ef+=_0x7d5f7e(0x2f7)+_0x4929b9[_0x7d5f7e(0x234)]+_0x7d5f7e(0x200),_0x21ab37=!![];break;}}!_0x21ab37&&(_0x3770ef+=_0x7d5f7e(0x2eb));let _0x18ff7b=![];for(let _0x362dae=0x0;_0x362dae<=_0x39738d[_0x7d5f7e(0x24f)]-0x1;_0x362dae++){const _0x3c935a=_0x39738d[_0x362dae];if(_0x1946ff['_id']['product_code']==_0x3c935a['_id'][_0x7d5f7e(0x32b)]&&_0x1946ff['_id']['product_name']==_0x3c935a[_0x7d5f7e(0x1e3)][_0x7d5f7e(0x1ea)]){_0x3770ef+='<td\x20class=\x22row_data\x22>'+_0x3c935a[_0x7d5f7e(0x288)]+_0x7d5f7e(0x200),_0x18ff7b=!![];break;}}!_0x18ff7b&&(_0x3770ef+=_0x7d5f7e(0x2eb)),_0x3770ef+=_0x7d5f7e(0x2f7)+_0x1946ff[_0x7d5f7e(0x288)]+_0x7d5f7e(0x200),_0x3770ef+=_0x7d5f7e(0x314);}return _0x3770ef;}router['post'](a0_0x44e325(0x239),auth,async(_0x57734d,_0x4e0681)=>{const _0x4099d0=a0_0x44e325;try{const {from_date:_0x2e8e96,to_date:_0x162722}=_0x57734d[_0x4099d0(0x21d)],_0x55facb=_0x57734d[_0x4099d0(0x30b)],_0x26ce00=await staff['findOne']({'email':_0x55facb[_0x4099d0(0x312)]});let _0x26836a=_0x4099d0(0x278);var _0x546ec1=new Date(_0x2e8e96),_0x16180f=new Date(_0x162722);const _0x17ea7c={'year':_0x4099d0(0x28d),'month':_0x4099d0(0x227),'day':_0x4099d0(0x28d)},_0xdadcbc=new Intl['DateTimeFormat'](_0x4099d0(0x211),_0x17ea7c)[_0x4099d0(0x287)](_0x546ec1),_0x156df6=new Intl[(_0x4099d0(0x206))](_0x4099d0(0x211),_0x17ea7c)[_0x4099d0(0x287)](_0x16180f);var _0x2367cb=await dataInventoryReports(_0x2e8e96,_0x162722,_0x26ce00['_id'][_0x4099d0(0x235)]());_0x26836a+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x26836a+=_0x4099d0(0x31b),_0x26836a+='<p>'+_0xdadcbc+'\x20-\x20'+_0x156df6+_0x4099d0(0x1f0),_0x26836a+=_0x4099d0(0x2ac),_0x26836a+=_0x4099d0(0x26d),_0x26836a+=_0x4099d0(0x21f),_0x26836a+=_0x4099d0(0x2ee),_0x26836a+='<th>\x20ITEM\x20CODE\x20</th>',_0x26836a+=_0x4099d0(0x22f),_0x26836a+=_0x4099d0(0x297),_0x26836a+=_0x4099d0(0x1ef),_0x26836a+=_0x4099d0(0x1fa),_0x26836a+=_0x4099d0(0x2f2),_0x26836a+=_0x4099d0(0x2ee),_0x26836a+=_0x2367cb,_0x26836a+=_0x4099d0(0x314),_0x26836a+=_0x4099d0(0x306),_0x26836a+=_0x4099d0(0x306);const _0x3a3364={'format':'Letter','orientation':_0x4099d0(0x331),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x4099d0(0x2bc)}}};pdf[_0x4099d0(0x309)](_0x26836a,_0x3a3364)[_0x4099d0(0x28e)](function(_0x1d2457,_0x4b060b){const _0xd8c2d3=_0x4099d0;if(_0x1d2457){_0x4e0681[_0xd8c2d3(0x2e7)](0x1f4)[_0xd8c2d3(0x1e5)](_0xd8c2d3(0x225));return;}_0x4e0681[_0xd8c2d3(0x238)](_0xd8c2d3(0x324),_0xd8c2d3(0x205)),_0x4b060b[_0xd8c2d3(0x2fa)](_0x4e0681);});}catch(_0x258033){}}),router[a0_0x44e325(0x268)](a0_0x44e325(0x1a4),auth,async(_0x1e395f,_0x2575ae)=>{const _0x199146=a0_0x44e325;try{const {username:_0x18d931,email:_0x21436f,role:_0x2abb21}=_0x1e395f[_0x199146(0x30b)],_0xdea7aa=_0x1e395f[_0x199146(0x30b)],_0x4cc885=await profile[_0x199146(0x2a3)]({'email':_0xdea7aa[_0x199146(0x312)]}),_0x119c8d={'year':_0x199146(0x28d),'month':_0x199146(0x227),'day':_0x199146(0x28d)},_0x2615c1=await master_shop['find']();console[_0x199146(0x1fc)](_0x199146(0x228),_0x2615c1);const _0x2e6fc4=await product[_0x199146(0x292)]();console[_0x199146(0x1fc)]('Products\x20find_data',_0x2e6fc4);const _0x4c5ece=await warehouse['aggregate']([{'$unwind':_0x199146(0x2df)},{'$lookup':{'from':_0x199146(0x23f),'localField':_0x199146(0x257),'foreignField':'name','as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x199146(0x2c7)}},{'$group':{'_id':_0x199146(0x289),'product_stock':{'$sum':_0x199146(0x2be)}}}]);console[_0x199146(0x1fc)](_0x199146(0x1a8),_0x4c5ece),_0x4c5ece[_0x199146(0x2a9)](_0x3cd1e3=>{const _0x364c5a=_0x199146,_0x3260f9=_0x2e6fc4[_0x364c5a(0x2bf)](_0x149e3a=>{const _0x3b3a43=_0x364c5a;_0x149e3a[_0x3b3a43(0x1a7)]==_0x3cd1e3[_0x3b3a43(0x1e3)]&&(_0x149e3a[_0x3b3a43(0x26b)]=parseInt(_0x149e3a[_0x3b3a43(0x26b)])+parseInt(_0x3cd1e3['product_stock']));});});const _0x34fa23=await staff[_0x199146(0x2a3)]({'email':_0xdea7aa['email']});if(_0x2615c1[0x0]['language']=='English\x20(US)')var _0x50f005=users['English'];else{if(_0x2615c1[0x0][_0x199146(0x1e0)]=='Hindi')var _0x50f005=users[_0x199146(0x2b9)];else{if(_0x2615c1[0x0][_0x199146(0x1e0)]==_0x199146(0x29a))var _0x50f005=users['German'];else{if(_0x2615c1[0x0]['language']=='Spanish')var _0x50f005=users['Spanish'];else{if(_0x2615c1[0x0][_0x199146(0x1e0)]==_0x199146(0x1eb))var _0x50f005=users['French'];else{if(_0x2615c1[0x0][_0x199146(0x1e0)]==_0x199146(0x284))var _0x50f005=users[_0x199146(0x20f)];else{if(_0x2615c1[0x0][_0x199146(0x1e0)]==_0x199146(0x20a))var _0x50f005=users[_0x199146(0x20a)];else{if(_0x2615c1[0x0][_0x199146(0x1e0)]=='Arabic\x20(ae)')var _0x50f005=users[_0x199146(0x2f5)];}}}}}}}_0x2575ae[_0x199146(0x245)](_0x199146(0x1ec),{'success':_0x1e395f[_0x199146(0x1e6)](_0x199146(0x1a5)),'errors':_0x1e395f['flash'](_0x199146(0x2a8)),'alldata':_0x2e6fc4,'profile':_0x4cc885,'master_shop':_0x2615c1,'role':_0xdea7aa,'product_stock':_0x4c5ece,'language':_0x50f005,'staff_arr':_0x34fa23});}catch(_0x1e79a6){}});async function agentsdataDSICheck_DSRR(_0xa01a7,_0x37a64d,_0x235d8f,_0x118c2a){const _0x26522e=a0_0x44e325;let _0x43dc42=new Date(_0xa01a7);_0x43dc42[_0x26522e(0x286)](_0x43dc42[_0x26522e(0x23c)]()-0x1);let _0x491572=_0x43dc42[_0x26522e(0x29c)]()[_0x26522e(0x2c0)]('T')[0x0];const _0x21c15b=await product[_0x26522e(0x1d7)]([{'$group':{'_id':{'brand':_0x26522e(0x26e),'category':_0x26522e(0x23b)},'products':{'$push':{'name':_0x26522e(0x21c),'product_code':_0x26522e(0x333)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2c7855=[];_0x2c7855['cat_brand']=[];for(let _0x487e25=0x0;_0x487e25<=_0x21c15b[_0x26522e(0x24f)]-0x1;_0x487e25++){const _0x256cff=_0x21c15b[_0x487e25];_0x2c7855[_0x26522e(0x252)][_0x26522e(0x2a1)](_0x256cff);}const _0x1d04a4=await product[_0x26522e(0x1d7)]([{'$group':{'_id':{'category':_0x26522e(0x23b)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x26522e(0x21c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x42df42=await product[_0x26522e(0x1d7)]([{'$group':{'_id':{'category':_0x26522e(0x23b),'brand':_0x26522e(0x26e)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4a319f=await sales_sa[_0x26522e(0x1d7)]([{'$match':{'date':_0xa01a7,'sales_staff_id':_0x37a64d,'sale_product.isFG':_0x26522e(0x210)}},{'$unwind':_0x26522e(0x302)},{'$lookup':{'from':_0x26522e(0x23f),'localField':_0x26522e(0x209),'foreignField':_0x26522e(0x32b),'as':_0x26522e(0x2de)}},{'$unwind':_0x26522e(0x2fd)},{'$group':{'_id':{'dsi':_0x26522e(0x320),'date':_0x26522e(0x1cc),'customer':_0x26522e(0x207),'status_data':_0x26522e(0x285)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':_0x26522e(0x275)},'amount':{'$first':_0x26522e(0x2e4)},'bank':{'$first':_0x26522e(0x221)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x26522e(0x21a)},'products':{'$push':{'qty':_0x26522e(0x2e5),'NetPrice':_0x26522e(0x1b4),'discount':'$sale_product.discount','adj_discount':_0x26522e(0x30f),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x26522e(0x2ad),'brand':_0x26522e(0x1bc),'gross_price':_0x26522e(0x2f1),'isFG':_0x26522e(0x28f),'prod_cat':_0x26522e(0x2e0),'prod_id':_0x26522e(0x1b3)}}}}},{'$unwind':_0x26522e(0x1b7)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x26522e(0x1d5),'customer':_0x26522e(0x1d2),'status_data':'$_id.status_data','category':_0x26522e(0x2a6),'brand':_0x26522e(0x296),'prod_id':_0x26522e(0x2d1)},'totalQty':{'$sum':_0x26522e(0x2bb)},'totalGross':{'$sum':{'$multiply':[_0x26522e(0x2bb),_0x26522e(0x315)]}},'NetPrice':{'$sum':_0x26522e(0x1d1)},'discount':{'$sum':_0x26522e(0x2d7)},'adj_discount':{'$sum':_0x26522e(0x308)},'cash':{'$first':_0x26522e(0x275)},'amount':{'$first':_0x26522e(0x2e4)},'bank':{'$first':_0x26522e(0x221)},'check_no':{'$first':_0x26522e(0x230)},'due_date':{'$first':_0x26522e(0x21a)},'product_details':{'$first':_0x26522e(0x27e)}}},{'$group':{'_id':{'dsi':_0x26522e(0x2a5),'date':_0x26522e(0x1d5),'customer':_0x26522e(0x1d2),'status_data':_0x26522e(0x251)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x26522e(0x224)},'NetPrice':{'$sum':_0x26522e(0x1e7)},'discount':{'$sum':_0x26522e(0x2ff)},'adj_discount':{'$sum':_0x26522e(0x2b7)},'cash':{'$first':_0x26522e(0x275)},'amount':{'$first':_0x26522e(0x2e4)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x26522e(0x230)},'due_date':{'$first':_0x26522e(0x21a)},'products':{'$push':{'qty':_0x26522e(0x2d5),'category':_0x26522e(0x2f8),'brand':'$_id.brand','product_details':_0x26522e(0x2df)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x41c7fe=await sales_sa[_0x26522e(0x1d7)]([{'$match':{'date':_0x491572,'sales_staff_id':_0x37a64d,'sale_product.isFG':_0x26522e(0x210)}},{'$unwind':_0x26522e(0x302)},{'$lookup':{'from':_0x26522e(0x23f),'localField':_0x26522e(0x209),'foreignField':_0x26522e(0x32b),'as':'product_info'}},{'$unwind':_0x26522e(0x2fd)},{'$group':{'_id':{'dsi':_0x26522e(0x320),'date':_0x26522e(0x1cc),'customer':_0x26522e(0x207)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':_0x26522e(0x275)},'amount':{'$first':_0x26522e(0x2e4)},'bank':{'$first':_0x26522e(0x221)},'check_no':{'$first':_0x26522e(0x230)},'due_date':{'$first':_0x26522e(0x21a)},'products':{'$push':{'qty':_0x26522e(0x2e5),'NetPrice':_0x26522e(0x1b4),'discount':'$sale_product.discount','adj_discount':_0x26522e(0x30f),'product_details':{'prod_name':_0x26522e(0x25b),'product_code':'$product_info.product_code','category':_0x26522e(0x2ad),'brand':_0x26522e(0x1bc),'gross_price':'$product_info.gross_price','isFG':'$sale_product.isFG','prod_cat':'$sale_product.prod_cat','prod_id':'$sale_product._id'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x26522e(0x2a5),'date':_0x26522e(0x1d5),'customer':_0x26522e(0x1d2),'category':'$products.product_details.category','brand':_0x26522e(0x296),'prod_id':_0x26522e(0x2d1)},'totalQty':{'$sum':_0x26522e(0x2bb)},'cash':{'$first':_0x26522e(0x275)},'amount':{'$first':_0x26522e(0x2e4)},'bank':{'$first':_0x26522e(0x221)},'check_no':{'$first':_0x26522e(0x230)},'due_date':{'$first':_0x26522e(0x21a)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x26522e(0x315)]}},'NetPrice':{'$sum':_0x26522e(0x1d1)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x26522e(0x27e)}}},{'$group':{'_id':{'dsi':_0x26522e(0x2a5),'date':_0x26522e(0x1d5),'customer':'$_id.customer'},'totalQty':{'$sum':_0x26522e(0x2d5)},'cash':{'$first':'$cash'},'amount':{'$first':_0x26522e(0x2e4)},'bank':{'$first':_0x26522e(0x221)},'check_no':{'$first':_0x26522e(0x230)},'due_date':{'$first':_0x26522e(0x21a)},'totalGross':{'$sum':_0x26522e(0x224)},'NetPrice':{'$sum':_0x26522e(0x1e7)},'discount':{'$sum':_0x26522e(0x2ff)},'adj_discount':{'$sum':_0x26522e(0x2b7)},'products':{'$push':{'qty':_0x26522e(0x2d5),'category':'$_id.category','brand':_0x26522e(0x2af),'product_details':_0x26522e(0x2df)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x1e9cf8=await sales_sa[_0x26522e(0x1d7)]([{'$match':{'date':_0xa01a7,'sales_staff_id':_0x37a64d,'status_data':'true'}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x861b95=await staff[_0x26522e(0x27c)](_0x37a64d);let _0x1a5e86=[],_0x3f00e8={},_0x5f4f5d={};var _0x11bd9d=0x0,_0x2df1b4=0x0,_0x4d04c3=0x0,_0x11d670=0x0,_0x214221=0x0;const _0x24682f=0x6;var _0x110f74=0x0,_0x132119=0x0;for(let _0x2d219a=0x0;_0x2d219a<=_0x4a319f[_0x26522e(0x24f)]-0x1;_0x2d219a++){const _0x31ea1e=_0x4a319f[_0x2d219a];let _0x4f2dee=_0x26522e(0x2ee);_0x4f2dee+=_0x26522e(0x2db),_0x4f2dee+=_0x26522e(0x1ba)+_0x31ea1e[_0x26522e(0x1e3)][_0x26522e(0x2e8)]+_0x26522e(0x200),_0x4f2dee+=_0x26522e(0x1ba)+_0x31ea1e['_id'][_0x26522e(0x267)]+_0x26522e(0x200);let _0x382cd4={},_0x59b294={},_0x4d7aa3={};var _0x2d15d2={},_0x35eaed={},_0x1640fd={},_0x4ee518=0x0;for(let _0x145a0a=0x0;_0x145a0a<=_0x31ea1e[_0x26522e(0x23f)][_0x26522e(0x24f)]-0x1;_0x145a0a++){const _0x35568e=_0x31ea1e['products'][_0x145a0a];_0x382cd4[_0x35568e[_0x26522e(0x280)]+'-'+_0x35568e[_0x26522e(0x2aa)]]=_0x35568e[_0x26522e(0x1da)],_0x59b294[[_0x35568e[_0x26522e(0x280)]+'-'+_0x35568e[_0x26522e(0x2aa)]]]=_0x35568e[_0x26522e(0x2a0)]['isFG'],_0x4d7aa3[[_0x35568e[_0x26522e(0x280)]+'-'+_0x35568e[_0x26522e(0x2aa)]]]=_0x35568e[_0x26522e(0x2a0)][_0x26522e(0x330)];const _0x16bdd5=_0x35568e['brand']+'-'+_0x35568e['category'];!Array['isArray'](_0x5f4f5d[_0x16bdd5])&&(_0x5f4f5d[_0x16bdd5]=[]);!Array['isArray'](_0x5f4f5d[_0x16bdd5])&&(_0x5f4f5d[_0x16bdd5]=[]);_0x5f4f5d[_0x16bdd5]['push'](_0x35568e[_0x26522e(0x1da)]);if(_0x35568e[_0x26522e(0x2a0)][_0x26522e(0x330)]=='P')_0x35568e[_0x26522e(0x2a0)]['isFG']=='true'?(!_0x1640fd[_0x16bdd5]&&(_0x1640fd[_0x16bdd5]=0x0),_0x1640fd[_0x16bdd5]=_0x35568e[_0x26522e(0x1da)]):(!_0x2d15d2[_0x16bdd5]&&(_0x2d15d2[_0x16bdd5]=0x0),_0x2d15d2[_0x16bdd5]=_0x35568e[_0x26522e(0x1da)]);else _0x35568e['product_details'][_0x26522e(0x330)]=='S'&&(_0x35568e[_0x26522e(0x2a0)][_0x26522e(0x259)]==_0x26522e(0x24e)?(!_0x1640fd[_0x16bdd5]&&(_0x1640fd[_0x16bdd5]=0x0),_0x1640fd[_0x16bdd5]=_0x35568e['qty']):(!_0x35eaed[_0x16bdd5]&&(_0x35eaed[_0x16bdd5]=0x0),_0x35eaed[_0x16bdd5]=_0x35568e[_0x26522e(0x1da)]));_0x4ee518++;}for(let _0x13c603=0x0;_0x13c603<=_0x2c7855[_0x26522e(0x252)][_0x26522e(0x24f)]-0x1;_0x13c603++){const _0x1e9676=_0x2c7855['cat_brand'][_0x13c603],_0x2b41e4=_0x1e9676[_0x26522e(0x1e3)][_0x26522e(0x280)]+'-'+_0x1e9676['_id'][_0x26522e(0x2aa)],_0x1885ae=_0x4d7aa3[_0x2b41e4]!==undefined?_0x4d7aa3[_0x2b41e4]:'NA';var _0x3d928a=_0x2d15d2[_0x2b41e4]!==undefined?_0x2d15d2[_0x2b41e4]['toFixed'](0x2):'',_0x277f3b=_0x35eaed[_0x2b41e4]!==undefined?_0x35eaed[_0x2b41e4][_0x26522e(0x322)](0x2):'',_0xb218b0=_0x1640fd[_0x2b41e4]!==undefined?_0x1640fd[_0x2b41e4][_0x26522e(0x322)](0x2):'';_0x4f2dee+=_0x26522e(0x2ca)+_0x3d928a+_0x26522e(0x200),_0x4f2dee+=_0x26522e(0x2ca)+_0x277f3b+_0x26522e(0x200),_0x4f2dee+=_0x26522e(0x2ca)+_0xb218b0+_0x26522e(0x200);}var _0x18eb37=formatNumber(parseFloat(_0x31ea1e['cash'])),_0x443899=formatNumber(parseFloat(_0x31ea1e[_0x26522e(0x2b6)]));isNaN(_0x443899)&&(_0x443899=0x0),_0x4f2dee+=_0x26522e(0x2ca)+_0x18eb37+_0x26522e(0x200),_0x4f2dee+=_0x26522e(0x2ca)+_0x443899+_0x26522e(0x200),_0x4f2dee+=_0x26522e(0x1ba)+_0x31ea1e[_0x26522e(0x31a)]+_0x26522e(0x200),_0x4f2dee+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x31ea1e[_0x26522e(0x281)]+'</td>',_0x4f2dee+=_0x26522e(0x1ba)+_0x31ea1e[_0x26522e(0x298)]+_0x26522e(0x200),_0x4d04c3=_0x31ea1e['discount']+_0x31ea1e[_0x26522e(0x242)],_0x110f74+=parseFloat(_0x31ea1e[_0x26522e(0x2c9)]),_0x132119+=parseFloat(_0x443899),_0x1a5e86[_0x26522e(0x2a1)](_0x4f2dee);}if(_0x1e9cf8['length']>0x0)for(let _0x2c3834=0x0;_0x2c3834<=_0x1e9cf8['length']-0x1;_0x2c3834++){const _0x303d44=_0x1e9cf8[_0x2c3834];console[_0x26522e(0x1fc)](_0x303d44);let _0x1db9da=_0x26522e(0x2ee);_0x1db9da+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22'+(0x8+0x7*0x3)+_0x26522e(0x1a6)+_0x303d44[_0x26522e(0x212)]+_0x26522e(0x1f9),_0x1db9da+='</tr>',_0x1a5e86[_0x26522e(0x2a1)](_0x1db9da);}function _0x489b00(_0x3dcabd,_0x291840){const _0x227d05=_0x26522e,_0x26e163=[];for(let _0x9dd3e3=0x0;_0x9dd3e3<=_0x3dcabd[_0x227d05(0x24f)]-0x1;_0x9dd3e3+=_0x291840){_0x26e163['push'](_0x3dcabd['slice'](_0x9dd3e3,_0x9dd3e3+_0x291840));}return _0x26e163;}const _0x466a14=_0x489b00(_0x1a5e86,_0x24682f);let _0x35ae08='';return _0x466a14['forEach']((_0x3a7feb,_0x57256d)=>{const _0x28ef0c=_0x26522e;_0x57256d>0x0&&(_0x35ae08+=_0x28ef0c(0x1f5));_0x35ae08+=_0x28ef0c(0x21f),_0x35ae08+='<thead>';const _0x45c652=new Date(_0xa01a7),_0x5b1d6e={'year':_0x28ef0c(0x28d),'month':_0x28ef0c(0x227),'day':_0x28ef0c(0x28d),'timeZone':_0x28ef0c(0x208)},_0x3ff09a=_0x45c652[_0x28ef0c(0x20c)](_0x28ef0c(0x211),_0x5b1d6e);_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x2bd)+_0x118c2a+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x204)+_0x861b95[_0x28ef0c(0x1a7)]+_0x28ef0c(0x200),_0x35ae08+=_0x28ef0c(0x1fe),_0x35ae08+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x35ae08+=_0x28ef0c(0x2ec),_0x35ae08+=_0x28ef0c(0x1b1),_0x35ae08+=_0x28ef0c(0x31e),_0x35ae08+=_0x28ef0c(0x247),_0x35ae08+=_0x28ef0c(0x2d3),_0x35ae08+=_0x28ef0c(0x1be),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x2e6),_0x35ae08+=_0x28ef0c(0x229)+_0x3ff09a+_0x28ef0c(0x200),_0x35ae08+=_0x28ef0c(0x291),_0x35ae08+=_0x28ef0c(0x30c),_0x35ae08+=_0x28ef0c(0x214),_0x35ae08+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x232),_0x35ae08+=_0x28ef0c(0x20b),_0x35ae08+=_0x28ef0c(0x1a2),_0x35ae08+=_0x28ef0c(0x214),_0x35ae08+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x25d),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x35ae08+='<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>',_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+='<tr>',_0x35ae08+=_0x28ef0c(0x1e9),_0x35ae08+=_0x28ef0c(0x265),_0x35ae08+=_0x28ef0c(0x261);for(let _0x1e130f=0x0;_0x1e130f<=_0x1d04a4[_0x28ef0c(0x24f)]-0x1;_0x1e130f++){const _0x345880=_0x1d04a4[_0x1e130f];for(let _0x939cad=0x0;_0x939cad<_0x2c7855[_0x28ef0c(0x252)]['length'];_0x939cad++){const _0x3b6a46=_0x2c7855[_0x28ef0c(0x252)][_0x939cad];if(_0x3b6a46[_0x28ef0c(0x1e3)][_0x28ef0c(0x2aa)]===_0x345880[_0x28ef0c(0x1e3)]['category']){var _0x6695f2='';switch(_0x345880['_id'][_0x28ef0c(0x2aa)]){case _0x28ef0c(0x31f):_0x6695f2=_0x3b6a46[_0x28ef0c(0x1e3)][_0x28ef0c(0x280)]+_0x28ef0c(0x248);break;case'Household':_0x6695f2=_0x3b6a46[_0x28ef0c(0x1e3)][_0x28ef0c(0x280)]+_0x28ef0c(0x2da);break;default:_0x6695f2=_0x3b6a46[_0x28ef0c(0x1e3)][_0x28ef0c(0x280)];break;}_0x35ae08+=_0x28ef0c(0x2f6)+_0x6695f2+'</b></td>';}}}_0x35ae08+=_0x28ef0c(0x2e2),_0x35ae08+=_0x28ef0c(0x325),_0x35ae08+=_0x28ef0c(0x29e),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x1c6);for(let _0x5c1b0a=0x0;_0x5c1b0a<=_0x2c7855[_0x28ef0c(0x252)][_0x28ef0c(0x24f)]-0x1;_0x5c1b0a++){const _0x3745a5=_0x2c7855[_0x5c1b0a];_0x35ae08+=_0x28ef0c(0x317),_0x35ae08+=_0x28ef0c(0x1d8),_0x35ae08+=_0x28ef0c(0x201);}_0x35ae08+=_0x28ef0c(0x222),_0x35ae08+=_0x28ef0c(0x1b2),_0x35ae08+=_0x28ef0c(0x1fd),_0x35ae08+='</tr>',_0x35ae08+=_0x28ef0c(0x2b4),_0x35ae08+=_0x28ef0c(0x20e),_0x3a7feb[_0x28ef0c(0x2a9)](_0x28d697=>{_0x35ae08+=_0x28d697;});let _0x48b2c2={},_0x22d9df={},_0x52f8ce={};for(let _0x568475=0x0;_0x568475<=_0x4a319f['length']-0x1;_0x568475++){const _0x2154ba=_0x4a319f[_0x568475];var _0x1d9336=0x0;for(let _0x40a68a=0x0;_0x40a68a<=_0x2154ba['products'][_0x28ef0c(0x24f)]-0x1;_0x40a68a++){const _0x1f62b2=_0x2154ba[_0x28ef0c(0x23f)][_0x40a68a],_0x439435=_0x1f62b2[_0x28ef0c(0x280)]+'-'+_0x1f62b2['category'];if(_0x1f62b2[_0x28ef0c(0x2a0)][_0x28ef0c(0x330)]=='P')_0x1f62b2['product_details'][_0x28ef0c(0x259)]==_0x28ef0c(0x24e)?(!_0x52f8ce[_0x439435]&&(_0x52f8ce[_0x439435]=0x0),_0x52f8ce[_0x439435]+=_0x1f62b2[_0x28ef0c(0x1da)]):(!_0x48b2c2[_0x439435]&&(_0x48b2c2[_0x439435]=0x0),_0x48b2c2[_0x439435]+=_0x1f62b2['qty']);else _0x1f62b2[_0x28ef0c(0x2a0)][_0x28ef0c(0x330)]=='S'&&(_0x1f62b2[_0x28ef0c(0x2a0)][_0x28ef0c(0x259)]==_0x28ef0c(0x24e)?(!_0x52f8ce[_0x439435]&&(_0x52f8ce[_0x439435]=0x0),_0x52f8ce[_0x439435]+=_0x1f62b2['qty'],console[_0x28ef0c(0x1fc)](_0x1f62b2['qty'])):(!_0x22d9df[_0x439435]&&(_0x22d9df[_0x439435]=0x0),_0x22d9df[_0x439435]+=_0x1f62b2[_0x28ef0c(0x1da)]));_0x1d9336++;}}let _0x41e0ca={},_0x3739e6={},_0x594b6c={};var _0x39dc07=0x0,_0x30ac26=0x0;for(let _0x52c7d7=0x0;_0x52c7d7<=_0x41c7fe[_0x28ef0c(0x24f)]-0x1;_0x52c7d7++){const _0x4eb6f4=_0x41c7fe[_0x52c7d7];var _0x1d9336=0x0;for(let _0x19f985=0x0;_0x19f985<=_0x4eb6f4['products'][_0x28ef0c(0x24f)]-0x1;_0x19f985++){const _0x1c758b=_0x4eb6f4[_0x28ef0c(0x23f)][_0x19f985],_0x597f27=_0x1c758b['brand']+'-'+_0x1c758b[_0x28ef0c(0x2aa)];if(_0x1c758b[_0x28ef0c(0x2a0)]['prod_cat']=='P')_0x1c758b[_0x28ef0c(0x2a0)][_0x28ef0c(0x259)]==_0x28ef0c(0x24e)?(!_0x594b6c[_0x597f27]&&(_0x594b6c[_0x597f27]=0x0),_0x594b6c[_0x597f27]+=_0x1c758b[_0x28ef0c(0x1da)]):(!_0x41e0ca[_0x597f27]&&(_0x41e0ca[_0x597f27]=0x0),_0x41e0ca[_0x597f27]+=_0x1c758b['qty']);else _0x1c758b[_0x28ef0c(0x2a0)][_0x28ef0c(0x330)]=='S'&&(_0x1c758b[_0x28ef0c(0x2a0)][_0x28ef0c(0x259)]==_0x28ef0c(0x24e)?(!_0x594b6c[_0x597f27]&&(_0x594b6c[_0x597f27]=0x0),_0x594b6c[_0x597f27]+=_0x1c758b[_0x28ef0c(0x1da)]):(!_0x3739e6[_0x597f27]&&(_0x3739e6[_0x597f27]=0x0),_0x3739e6[_0x597f27]+=_0x1c758b[_0x28ef0c(0x1da)]));_0x1d9336++;}var _0x1dfffb=parseFloat(_0x4eb6f4[_0x28ef0c(0x2c9)]),_0x81138a=parseFloat(_0x4eb6f4[_0x28ef0c(0x2b6)]);isNaN(_0x81138a)&&(_0x81138a=0x0),_0x39dc07+=_0x1dfffb,_0x30ac26+=_0x81138a;}_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x35ae08+=_0x28ef0c(0x250),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x46e028=0x0;_0x46e028<=_0x2c7855[_0x28ef0c(0x252)][_0x28ef0c(0x24f)]-0x1;_0x46e028++){const _0x2c74bd=_0x2c7855[_0x28ef0c(0x252)][_0x46e028],_0xb662c4=_0x2c74bd[_0x28ef0c(0x1e3)][_0x28ef0c(0x280)]+'-'+_0x2c74bd[_0x28ef0c(0x1e3)][_0x28ef0c(0x2aa)];var _0x56768a=_0x48b2c2[_0xb662c4]!==undefined?formatNumber(_0x48b2c2[_0xb662c4][_0x28ef0c(0x322)](0x2)):'',_0x338716=_0x52f8ce[_0xb662c4]!==undefined?formatNumber(_0x52f8ce[_0xb662c4][_0x28ef0c(0x322)](0x2)):'',_0x3af44c=_0x22d9df[_0xb662c4]!==undefined?formatNumber(_0x22d9df[_0xb662c4][_0x28ef0c(0x322)](0x2)):'';_0x35ae08+=_0x28ef0c(0x2d8)+_0x56768a+'</b></td>',_0x35ae08+=_0x28ef0c(0x2d8)+_0x3af44c+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2d8)+_0x338716+_0x28ef0c(0x1f9);}_0x35ae08+=_0x28ef0c(0x2d8)+formatNumber(_0x110f74)+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2d8)+formatNumber(_0x132119)+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x35ae08+='</tr>',_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x35ae08+=_0x28ef0c(0x28b),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x59ee30=0x0;_0x59ee30<=_0x2c7855[_0x28ef0c(0x252)]['length']-0x1;_0x59ee30++){const _0x2fcef1=_0x2c7855[_0x28ef0c(0x252)][_0x59ee30],_0x35f877=_0x2fcef1[_0x28ef0c(0x1e3)][_0x28ef0c(0x280)]+'-'+_0x2fcef1[_0x28ef0c(0x1e3)][_0x28ef0c(0x2aa)];var _0x56768a=_0x41e0ca[_0x35f877]!==undefined?formatNumber(_0x41e0ca[_0x35f877][_0x28ef0c(0x322)](0x2)):'',_0x338716=_0x594b6c[_0x35f877]!==undefined?formatNumber(_0x594b6c[_0x35f877][_0x28ef0c(0x322)](0x2)):'',_0x3af44c=_0x3739e6[_0x35f877]!==undefined?formatNumber(_0x3739e6[_0x35f877][_0x28ef0c(0x322)](0x2)):'';_0x35ae08+=_0x28ef0c(0x2d8)+_0x56768a+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2d8)+_0x3af44c+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2d8)+_0x338716+_0x28ef0c(0x1f9);}_0x35ae08+=_0x28ef0c(0x2d8)+formatNumber(_0x39dc07)+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2d8)+formatNumber(_0x30ac26)+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x1de),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x35ae08+=_0x28ef0c(0x2db);let _0x53878f=0x0,_0x2ebd0c=0x0,_0x41dd1a=0x0;for(let _0x4dafdc=0x0;_0x4dafdc<=_0x2c7855[_0x28ef0c(0x252)][_0x28ef0c(0x24f)]-0x1;_0x4dafdc++){const _0x1b1121=_0x2c7855['cat_brand'][_0x4dafdc],_0x400d86=_0x1b1121[_0x28ef0c(0x1e3)][_0x28ef0c(0x280)]+'-'+_0x1b1121['_id'][_0x28ef0c(0x2aa)];var _0xaf84ff=_0x48b2c2[_0x400d86]!==undefined?_0x48b2c2[_0x400d86]['toFixed'](0x2):'0',_0x136eda=_0x52f8ce[_0x400d86]!==undefined?_0x52f8ce[_0x400d86][_0x28ef0c(0x322)](0x2):'0',_0xad80b4=_0x22d9df[_0x400d86]!==undefined?_0x22d9df[_0x400d86]['toFixed'](0x2):'0',_0x4577f2=_0x41e0ca[_0x400d86]!==undefined?_0x41e0ca[_0x400d86]['toFixed'](0x2):'0',_0x1db818=_0x594b6c[_0x400d86]!==undefined?_0x594b6c[_0x400d86][_0x28ef0c(0x322)](0x2):'0',_0x9fddfc=_0x3739e6[_0x400d86]!==undefined?_0x3739e6[_0x400d86][_0x28ef0c(0x322)](0x2):'0';_0x53878f=parseFloat(_0xaf84ff)+parseFloat(_0x4577f2),_0x2ebd0c=parseFloat(_0xad80b4)+parseFloat(_0x9fddfc),_0x41dd1a=parseFloat(_0x136eda)+parseFloat(_0x1db818),_0x35ae08+=_0x28ef0c(0x2d8)+formatNumber(_0x53878f['toFixed'](0x2))+_0x28ef0c(0x1f9),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2ebd0c['toFixed'](0x2))+_0x28ef0c(0x1f9),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x41dd1a['toFixed'](0x2))+_0x28ef0c(0x1f9);}var _0xfa5784=formatNumber(_0x110f74+_0x39dc07),_0x259e5d=formatNumber(_0x132119+_0x30ac26);_0x35ae08+=_0x28ef0c(0x2d8)+_0xfa5784+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2d8)+_0x259e5d+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+='<tr>',_0x35ae08+=_0x28ef0c(0x32e)+(_0x2c7855[_0x28ef0c(0x252)][_0x28ef0c(0x24f)]*0x3+0x9)+_0x28ef0c(0x2e3),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+='<tr>',_0x35ae08+=_0x28ef0c(0x1de),_0x35ae08+=_0x28ef0c(0x1fb),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x354a43=0x0;_0x354a43<=_0x2c7855[_0x28ef0c(0x252)][_0x28ef0c(0x24f)]-0x1;_0x354a43++){const _0x2e701b=_0x2c7855[_0x28ef0c(0x252)][_0x354a43],_0x382075=_0x2e701b['_id']['brand']+'-'+_0x2e701b[_0x28ef0c(0x1e3)]['category'];var _0xaf84ff=_0x48b2c2[_0x382075]!==undefined?_0x48b2c2[_0x382075]['toFixed'](0x2):'0',_0x136eda=_0x52f8ce[_0x382075]!==undefined?_0x52f8ce[_0x382075][_0x28ef0c(0x322)](0x2):'0',_0xad80b4=_0x22d9df[_0x382075]!==undefined?_0x22d9df[_0x382075]['toFixed'](0x2):'0',_0x4577f2=_0x41e0ca[_0x382075]!==undefined?_0x41e0ca[_0x382075][_0x28ef0c(0x322)](0x2):'0',_0x1db818=_0x594b6c[_0x382075]!==undefined?_0x594b6c[_0x382075][_0x28ef0c(0x322)](0x2):'0',_0x9fddfc=_0x3739e6[_0x382075]!==undefined?_0x3739e6[_0x382075][_0x28ef0c(0x322)](0x2):'0';_0x53878f=parseFloat(_0xaf84ff)+parseFloat(_0x4577f2),_0x2ebd0c=parseFloat(_0xad80b4)+parseFloat(_0x9fddfc),_0x41dd1a=parseFloat(_0x136eda)+parseFloat(_0x1db818),_0x35ae08+=_0x28ef0c(0x26a),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x35ae08+=_0x28ef0c(0x26a);}_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+='<tr>',_0x35ae08+=_0x28ef0c(0x1de),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>',_0x35ae08+=_0x28ef0c(0x2db);for(let _0x4cb36b=0x0;_0x4cb36b<=_0x2c7855[_0x28ef0c(0x252)]['length']-0x1;_0x4cb36b++){const _0x153c89=_0x2c7855[_0x28ef0c(0x252)][_0x4cb36b],_0x480487=_0x153c89[_0x28ef0c(0x1e3)][_0x28ef0c(0x280)]+'-'+_0x153c89[_0x28ef0c(0x1e3)][_0x28ef0c(0x2aa)];var _0xaf84ff=_0x48b2c2[_0x480487]!==undefined?_0x48b2c2[_0x480487][_0x28ef0c(0x322)](0x2):'0',_0x136eda=_0x52f8ce[_0x480487]!==undefined?_0x52f8ce[_0x480487]['toFixed'](0x2):'0',_0xad80b4=_0x22d9df[_0x480487]!==undefined?_0x22d9df[_0x480487][_0x28ef0c(0x322)](0x2):'0',_0x4577f2=_0x41e0ca[_0x480487]!==undefined?_0x41e0ca[_0x480487][_0x28ef0c(0x322)](0x2):'0',_0x1db818=_0x594b6c[_0x480487]!==undefined?_0x594b6c[_0x480487][_0x28ef0c(0x322)](0x2):'0',_0x9fddfc=_0x3739e6[_0x480487]!==undefined?_0x3739e6[_0x480487][_0x28ef0c(0x322)](0x2):'0';_0x53878f=parseFloat(_0xaf84ff)+parseFloat(_0x4577f2),_0x2ebd0c=parseFloat(_0xad80b4)+parseFloat(_0x9fddfc),_0x41dd1a=parseFloat(_0x136eda)+parseFloat(_0x1db818),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x35ae08+=_0x28ef0c(0x26a);}_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+='</tr>',_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x1de),_0x35ae08+=_0x28ef0c(0x26c),_0x35ae08+=_0x28ef0c(0x2db);for(let _0x196e9f=0x0;_0x196e9f<=_0x2c7855['cat_brand'][_0x28ef0c(0x24f)]-0x1;_0x196e9f++){const _0xf2116b=_0x2c7855[_0x28ef0c(0x252)][_0x196e9f],_0x7dc27a=_0xf2116b['_id'][_0x28ef0c(0x280)]+'-'+_0xf2116b['_id']['category'];var _0xaf84ff=_0x48b2c2[_0x7dc27a]!==undefined?_0x48b2c2[_0x7dc27a]['toFixed'](0x2):'0',_0x136eda=_0x52f8ce[_0x7dc27a]!==undefined?_0x52f8ce[_0x7dc27a]['toFixed'](0x2):'0',_0xad80b4=_0x22d9df[_0x7dc27a]!==undefined?_0x22d9df[_0x7dc27a][_0x28ef0c(0x322)](0x2):'0',_0x4577f2=_0x41e0ca[_0x7dc27a]!==undefined?_0x41e0ca[_0x7dc27a]['toFixed'](0x2):'0',_0x1db818=_0x594b6c[_0x7dc27a]!==undefined?_0x594b6c[_0x7dc27a][_0x28ef0c(0x322)](0x2):'0',_0x9fddfc=_0x3739e6[_0x7dc27a]!==undefined?_0x3739e6[_0x7dc27a][_0x28ef0c(0x322)](0x2):'0';_0x53878f=parseFloat(_0xaf84ff)+parseFloat(_0x4577f2),_0x2ebd0c=parseFloat(_0xad80b4)+parseFloat(_0x9fddfc),_0x41dd1a=parseFloat(_0x136eda)+parseFloat(_0x1db818),_0x35ae08+=_0x28ef0c(0x26a),_0x35ae08+=_0x28ef0c(0x26a),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+=_0x28ef0c(0x1de),_0x35ae08+=_0x28ef0c(0x250),_0x35ae08+=_0x28ef0c(0x2db);for(let _0x44d831=0x0;_0x44d831<=_0x2c7855['cat_brand'][_0x28ef0c(0x24f)]-0x1;_0x44d831++){const _0x1b3fd7=_0x2c7855[_0x28ef0c(0x252)][_0x44d831],_0x402beb=_0x1b3fd7[_0x28ef0c(0x1e3)][_0x28ef0c(0x280)]+'-'+_0x1b3fd7[_0x28ef0c(0x1e3)][_0x28ef0c(0x2aa)];var _0xaf84ff=_0x48b2c2[_0x402beb]!==undefined?_0x48b2c2[_0x402beb]['toFixed'](0x2):'',_0x136eda=_0x52f8ce[_0x402beb]!==undefined?_0x52f8ce[_0x402beb][_0x28ef0c(0x322)](0x2):'',_0xad80b4=_0x22d9df[_0x402beb]!==undefined?_0x22d9df[_0x402beb]['toFixed'](0x2):'',_0x4577f2=_0x41e0ca[_0x402beb]!==undefined?_0x41e0ca[_0x402beb][_0x28ef0c(0x322)](0x2):'',_0x1db818=_0x594b6c[_0x402beb]!==undefined?_0x594b6c[_0x402beb]['toFixed'](0x2):'',_0x9fddfc=_0x3739e6[_0x402beb]!==undefined?_0x3739e6[_0x402beb][_0x28ef0c(0x322)](0x2):'';_0x53878f=formatNumber(parseFloat(_0xaf84ff)+parseFloat(_0x4577f2)),_0x2ebd0c=formatNumber(parseFloat(_0xad80b4)+parseFloat(_0x9fddfc)),_0x41dd1a=formatNumber(parseFloat(_0x136eda)+parseFloat(_0x1db818)),_0x35ae08+=_0x28ef0c(0x2d8)+_0xaf84ff+'</b></td>',_0x35ae08+=_0x28ef0c(0x2d8)+_0xad80b4+_0x28ef0c(0x1f9),_0x35ae08+=_0x28ef0c(0x2d8)+_0x136eda+'</b></td>';}_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+='</tr>',_0x35ae08+=_0x28ef0c(0x2ee),_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>',_0x35ae08+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x4fce43=0x0;_0x4fce43<=_0x2c7855[_0x28ef0c(0x252)][_0x28ef0c(0x24f)]-0x1;_0x4fce43++){const _0x1042fd=_0x2c7855[_0x28ef0c(0x252)][_0x4fce43],_0x119e9c=_0x1042fd['_id'][_0x28ef0c(0x280)]+'-'+_0x1042fd[_0x28ef0c(0x1e3)][_0x28ef0c(0x2aa)];var _0xaf84ff=_0x48b2c2[_0x119e9c]!==undefined?_0x48b2c2[_0x119e9c][_0x28ef0c(0x322)](0x2):'0',_0x136eda=_0x52f8ce[_0x119e9c]!==undefined?_0x52f8ce[_0x119e9c][_0x28ef0c(0x322)](0x2):'0',_0xad80b4=_0x22d9df[_0x119e9c]!==undefined?_0x22d9df[_0x119e9c][_0x28ef0c(0x322)](0x2):'0',_0x4577f2=_0x41e0ca[_0x119e9c]!==undefined?_0x41e0ca[_0x119e9c][_0x28ef0c(0x322)](0x2):'0',_0x1db818=_0x594b6c[_0x119e9c]!==undefined?_0x594b6c[_0x119e9c][_0x28ef0c(0x322)](0x2):'0',_0x9fddfc=_0x3739e6[_0x119e9c]!==undefined?_0x3739e6[_0x119e9c][_0x28ef0c(0x322)](0x2):'0';_0x53878f=parseFloat(_0xaf84ff)+parseFloat(_0x4577f2),_0x2ebd0c=parseFloat(_0xad80b4)+parseFloat(_0x9fddfc),_0x41dd1a=parseFloat(_0x136eda)+parseFloat(_0x1db818),_0x35ae08+=_0x28ef0c(0x26a),_0x35ae08+=_0x28ef0c(0x26a),_0x35ae08+=_0x28ef0c(0x26a);}_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x2db),_0x35ae08+=_0x28ef0c(0x314),_0x35ae08+=_0x28ef0c(0x231),_0x35ae08+=_0x28ef0c(0x328);}),_0x35ae08;}async function generateReferenceNumber(_0x251bd5,_0x40a4c6,_0x36a7f7){const _0x3c512d=a0_0x44e325,_0xbebb34=new Date(_0x251bd5)[_0x3c512d(0x2ae)](),_0x458329=('0'+(new Date(_0x251bd5)[_0x3c512d(0x1f4)]()+0x1))[_0x3c512d(0x24d)](-0x2),_0x261a57=('0'+new Date(_0x251bd5)[_0x3c512d(0x23c)]())['slice'](-0x2),_0x5326d0=await staff[_0x3c512d(0x2a3)]({'email':_0x36a7f7[_0x3c512d(0x312)]}),_0x543628=_0x5326d0['sales_man_code'],_0x11131f=_0x543628+'-'+_0xbebb34+_0x458329+_0x261a57,_0x4f64a2=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x11131f),'salesman_code':_0x543628})[_0x3c512d(0x1f6)]({'createdAt':-0x1}),_0x2e46f3=_0x11131f;_0x4f64a2&&(_0x2e46f3=_0x4f64a2[_0x3c512d(0x20d)]);console[_0x3c512d(0x1fc)](_0x2e46f3);const _0x13ac4c=new Reference({'referenceNumber':_0x2e46f3,'staff_id':_0x40a4c6,'salesman_code':_0x543628});return await _0x13ac4c[_0x3c512d(0x277)](),_0x2e46f3;}router[a0_0x44e325(0x2a7)]('/dsrr/pdf',auth,async(_0x532bef,_0x275e9d)=>{const _0x577433=a0_0x44e325,{from_date:_0x16324a,dataview:_0x371add}=_0x532bef['body'],_0x536db4=_0x532bef[_0x577433(0x30b)],_0x334fd0=await staff[_0x577433(0x2a3)]({'email':_0x536db4['email']}),_0xd7105=await master_shop[_0x577433(0x292)](),_0x1a3bca='';var _0x367809=new Date(_0x16324a);const _0x440829={'year':'numeric','month':_0x577433(0x227),'day':_0x577433(0x28d)},_0x38ca51=new Intl[(_0x577433(0x206))](_0x577433(0x211),_0x440829)['format'](_0x367809),_0x4acc54=await Reference['find']({'staff_id':_0x334fd0['_id'][_0x577433(0x235)](),'date_include':_0x16324a});if(_0x4acc54[_0x577433(0x24f)]>0x0){let _0x1e5d86='';_0x1e5d86+=_0x4acc54[0x0][_0x577433(0x2f3)];if(_0x371add==_0x577433(0x240)){const _0x5af99d=cheerio['load'](_0x1e5d86);let _0x1211c2=[],_0x3211cc=[],_0x339f7c=[];const _0x2d0afc=_0x42df50=>{const _0x3e2f01=_0x577433,_0x35db1d={'top':{'style':_0x3e2f01(0x255),'color':{'rgb':'000000'}},'bottom':{'style':_0x3e2f01(0x255),'color':{'rgb':'000000'}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':_0x3e2f01(0x255),'color':{'rgb':_0x3e2f01(0x1b5)}}};if(_0x42df50){const _0x3348ca=_0x42df50[_0x3e2f01(0x2c0)](';')[_0x3e2f01(0x2b8)]((_0x1a9a96,_0x2b5623)=>{const _0x31a375=_0x3e2f01,[_0xead262,_0x4ac99c]=_0x2b5623['split'](':')['map'](_0x2c8792=>_0x2c8792[_0x31a375(0x258)]());return _0x1a9a96[_0xead262]=_0x4ac99c,_0x1a9a96;},{});_0x3348ca[_0x3e2f01(0x2e9)]&&(_0x35db1d[_0x3e2f01(0x24b)]['style']=_0x3348ca[_0x3e2f01(0x2e9)]['includes'](_0x3e2f01(0x226))?'thin':_0x3e2f01(0x321)),_0x3348ca[_0x3e2f01(0x1d3)]&&(_0x35db1d[_0x3e2f01(0x31c)][_0x3e2f01(0x1ee)]=_0x3348ca[_0x3e2f01(0x1d3)][_0x3e2f01(0x223)](_0x3e2f01(0x226))?'thin':_0x3e2f01(0x321)),_0x3348ca['border-left']&&(_0x35db1d[_0x3e2f01(0x22a)]['style']=_0x3348ca[_0x3e2f01(0x2b3)][_0x3e2f01(0x223)](_0x3e2f01(0x226))?_0x3e2f01(0x226):'medium'),_0x3348ca[_0x3e2f01(0x1c3)]&&(_0x35db1d[_0x3e2f01(0x1c7)][_0x3e2f01(0x1ee)]=_0x3348ca[_0x3e2f01(0x1c3)][_0x3e2f01(0x223)]('thin')?_0x3e2f01(0x226):_0x3e2f01(0x321));}return _0x35db1d;};_0x5af99d('table\x20tr')[_0x577433(0x2a2)]((_0x5b5d61,_0x1544b2)=>{const _0x3f4ae2=_0x577433;let _0x5d4d06=[],_0x35c1e9=0x0;while(_0x339f7c[_0x35c1e9]){_0x339f7c[_0x35c1e9]--,_0x35c1e9++;}_0x5af99d(_0x1544b2)['find'](_0x3f4ae2(0x1f1))[_0x3f4ae2(0x2a2)]((_0x3e1708,_0x2d33d9)=>{const _0x4e29ae=_0x3f4ae2;let _0x1430ae=_0x5af99d(_0x2d33d9)[_0x4e29ae(0x1cd)]()[_0x4e29ae(0x258)](),_0x15fa90=parseFloat(_0x1430ae[_0x4e29ae(0x32c)](/,/g,''));isNaN(_0x15fa90)&&(_0x15fa90=_0x1430ae);let _0xf0e68c=parseInt(_0x5af99d(_0x2d33d9)['attr']('colspan'))||0x1,_0x527cc5=parseInt(_0x5af99d(_0x2d33d9)[_0x4e29ae(0x1c8)](_0x4e29ae(0x327)))||0x1;const _0x5573ad=_0x5af99d(_0x2d33d9)[_0x4e29ae(0x1c8)]('style'),_0x55febd=_0x2d0afc(_0x5573ad);_0x5d4d06[_0x35c1e9]={'v':_0x15fa90,'s':{'border':_0x55febd}};(_0xf0e68c>0x1||_0x527cc5>0x1)&&_0x3211cc['push']({'s':{'r':_0x5b5d61,'c':_0x35c1e9},'e':{'r':_0x5b5d61+_0x527cc5-0x1,'c':_0x35c1e9+_0xf0e68c-0x1}});for(let _0x45a0fd=0x0;_0x45a0fd<_0xf0e68c;_0x45a0fd++){_0x527cc5>0x1&&(_0x339f7c[_0x35c1e9+_0x45a0fd]=_0x527cc5-0x1);}_0x35c1e9+=_0xf0e68c;}),_0x1211c2[_0x3f4ae2(0x2a1)](_0x5d4d06);});const _0x8bae34=XLSX[_0x577433(0x2ef)][_0x577433(0x1b9)](),_0x2e87cc=XLSX[_0x577433(0x2ef)]['aoa_to_sheet'](_0x1211c2);_0x3211cc['length']>0x0&&(_0x2e87cc[_0x577433(0x316)]=_0x3211cc);_0x2e87cc[_0x577433(0x282)]=_0x1211c2[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x577433(0x2ef)]['book_append_sheet'](_0x8bae34,_0x2e87cc,_0x577433(0x2b5));const _0x18c10c=XLSX['write'](_0x8bae34,{'bookType':'xlsx','type':_0x577433(0x1c0)});_0x275e9d[_0x577433(0x238)]('Content-Disposition',_0x577433(0x2c3)),_0x275e9d[_0x577433(0x238)](_0x577433(0x324),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x275e9d[_0x577433(0x1e5)](_0x18c10c);}else{let _0x2c380a='';_0x2c380a+=_0x1e5d86,_0x2c380a+=_0x577433(0x2b1),_0x2c380a+=_0x577433(0x2d4),_0x2c380a+=_0x577433(0x1f3),_0x2c380a+='};',_0x2c380a+=_0x577433(0x1f2),_0x275e9d[_0x577433(0x1e5)](_0x2c380a);}}else generateReferenceNumber(_0x16324a,_0x334fd0[_0x577433(0x1e3)][_0x577433(0x235)](),_0x536db4)['then'](async _0x4a28a1=>{const _0x431dcf=_0x577433,_0x2909a2=await agentsdataDSICheck_DSRR(_0x16324a,_0x334fd0['_id'][_0x431dcf(0x235)](),_0x1a3bca,_0x4a28a1);console[_0x431dcf(0x1fc)](_0x2909a2);let _0x14b152=_0x431dcf(0x1cb);_0x14b152+='<div\x20class=\x22row\x22>',_0x14b152+='<div\x20\x20id=\x22table-conatainer\x22>',_0x14b152+=_0x431dcf(0x21f),_0x14b152+=_0x2909a2,_0x14b152+=_0x431dcf(0x328),_0x14b152+='</div>',_0x14b152+=_0x431dcf(0x306);if(_0x2909a2[_0x431dcf(0x24f)]>0x0){const _0x4607f1=await Reference[_0x431dcf(0x2a3)]({'staff_id':_0x334fd0[_0x431dcf(0x1e3)][_0x431dcf(0x235)](),'referenceNumber':_0x4a28a1});_0x4607f1[_0x431dcf(0x2f3)]=_0x14b152,_0x4607f1[_0x431dcf(0x1d0)]=_0x16324a,await _0x4607f1[_0x431dcf(0x277)]();if(_0x371add=='excel'){const _0x425916=cheerio[_0x431dcf(0x29f)](_0x14b152);let _0x2f12db=[],_0x1b2464=[],_0x37675c=[];const _0x3d85dd=_0x246333=>{const _0x57cbc7=_0x431dcf,_0x298e05={'top':{'style':_0x57cbc7(0x255),'color':{'rgb':_0x57cbc7(0x1b5)}},'bottom':{'style':_0x57cbc7(0x255),'color':{'rgb':_0x57cbc7(0x1b5)}},'left':{'style':_0x57cbc7(0x255),'color':{'rgb':'000000'}},'right':{'style':_0x57cbc7(0x255),'color':{'rgb':'000000'}}};if(_0x246333){const _0x324d03=_0x246333[_0x57cbc7(0x2c0)](';')[_0x57cbc7(0x2b8)]((_0x3593d5,_0xce79e2)=>{const _0x2acef7=_0x57cbc7,[_0x2cd2bd,_0xa8d9ee]=_0xce79e2[_0x2acef7(0x2c0)](':')[_0x2acef7(0x2bf)](_0x1c4b9f=>_0x1c4b9f['trim']());return _0x3593d5[_0x2cd2bd]=_0xa8d9ee,_0x3593d5;},{});_0x324d03[_0x57cbc7(0x2e9)]&&(_0x298e05[_0x57cbc7(0x24b)]['style']=_0x324d03[_0x57cbc7(0x2e9)][_0x57cbc7(0x223)](_0x57cbc7(0x226))?_0x57cbc7(0x226):'medium'),_0x324d03[_0x57cbc7(0x1d3)]&&(_0x298e05[_0x57cbc7(0x31c)][_0x57cbc7(0x1ee)]=_0x324d03[_0x57cbc7(0x1d3)][_0x57cbc7(0x223)](_0x57cbc7(0x226))?_0x57cbc7(0x226):_0x57cbc7(0x321)),_0x324d03[_0x57cbc7(0x2b3)]&&(_0x298e05['left']['style']=_0x324d03[_0x57cbc7(0x2b3)]['includes']('thin')?'thin':_0x57cbc7(0x321)),_0x324d03[_0x57cbc7(0x1c3)]&&(_0x298e05[_0x57cbc7(0x1c7)][_0x57cbc7(0x1ee)]=_0x324d03[_0x57cbc7(0x1c3)][_0x57cbc7(0x223)](_0x57cbc7(0x226))?_0x57cbc7(0x226):_0x57cbc7(0x321));}return _0x298e05;};_0x425916('table\x20tr')[_0x431dcf(0x2a2)]((_0x1b37cd,_0x3526e8)=>{const _0x3743d6=_0x431dcf;let _0x4d6fd2=[],_0x4dc7b2=0x0;while(_0x37675c[_0x4dc7b2]){_0x37675c[_0x4dc7b2]--,_0x4dc7b2++;}_0x425916(_0x3526e8)[_0x3743d6(0x292)](_0x3743d6(0x1f1))['each']((_0xa37920,_0x6f899c)=>{const _0x5a18dc=_0x3743d6;let _0x23e140=_0x425916(_0x6f899c)[_0x5a18dc(0x1cd)]()[_0x5a18dc(0x258)](),_0x423961=parseFloat(_0x23e140[_0x5a18dc(0x32c)](/,/g,''));isNaN(_0x423961)&&(_0x423961=_0x23e140);let _0x211436=parseInt(_0x425916(_0x6f899c)[_0x5a18dc(0x1c8)]('colspan'))||0x1,_0x36438c=parseInt(_0x425916(_0x6f899c)[_0x5a18dc(0x1c8)](_0x5a18dc(0x327)))||0x1;const _0x8b20a0=_0x425916(_0x6f899c)['attr'](_0x5a18dc(0x1ee)),_0x4be2d6=_0x3d85dd(_0x8b20a0);_0x4d6fd2[_0x4dc7b2]={'v':_0x423961,'s':{'border':_0x4be2d6}};(_0x211436>0x1||_0x36438c>0x1)&&_0x1b2464[_0x5a18dc(0x2a1)]({'s':{'r':_0x1b37cd,'c':_0x4dc7b2},'e':{'r':_0x1b37cd+_0x36438c-0x1,'c':_0x4dc7b2+_0x211436-0x1}});for(let _0x3376a4=0x0;_0x3376a4<_0x211436;_0x3376a4++){_0x36438c>0x1&&(_0x37675c[_0x4dc7b2+_0x3376a4]=_0x36438c-0x1);}_0x4dc7b2+=_0x211436;}),_0x2f12db[_0x3743d6(0x2a1)](_0x4d6fd2);});const _0x38317b=XLSX[_0x431dcf(0x2ef)][_0x431dcf(0x1b9)](),_0xfc3f66=XLSX[_0x431dcf(0x2ef)]['aoa_to_sheet'](_0x2f12db);_0x1b2464['length']>0x0&&(_0xfc3f66[_0x431dcf(0x316)]=_0x1b2464);_0xfc3f66[_0x431dcf(0x282)]=_0x2f12db[0x0][_0x431dcf(0x2bf)](()=>({'wpx':0x64})),XLSX[_0x431dcf(0x2ef)]['book_append_sheet'](_0x38317b,_0xfc3f66,_0x431dcf(0x2b5));const _0x3e3906=XLSX['write'](_0x38317b,{'bookType':_0x431dcf(0x276),'type':_0x431dcf(0x1c0)});_0x275e9d['setHeader'](_0x431dcf(0x2f9),_0x431dcf(0x2c3)),_0x275e9d[_0x431dcf(0x238)](_0x431dcf(0x324),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x275e9d[_0x431dcf(0x1e5)](_0x3e3906);}else _0x14b152+=_0x431dcf(0x2b1),_0x14b152+='window.onload\x20=\x20function()\x20{',_0x14b152+='window.print();',_0x14b152+='};',_0x14b152+='</script>',_0x275e9d[_0x431dcf(0x1e5)](_0x14b152);}else await Reference['deleteOne']({'referenceNumber':_0x4a28a1}),_0x532bef[_0x431dcf(0x1e6)](_0x431dcf(0x2a8),'No\x20data\x20was\x20Found!'),_0x275e9d[_0x431dcf(0x2c2)](_0x431dcf(0x1b8));})[_0x577433(0x1d4)](console[_0x577433(0x2b2)]);}),router[a0_0x44e325(0x268)](a0_0x44e325(0x32f),auth,async(_0x1d769a,_0x480773)=>{const _0x13be5f=a0_0x44e325;try{const {username:_0x204497,email:_0x19c657,role:_0x3d7f8a}=_0x1d769a[_0x13be5f(0x30b)],_0x594e5a=_0x1d769a[_0x13be5f(0x30b)],_0x367f33=await profile[_0x13be5f(0x2a3)]({'email':_0x594e5a['email']}),_0x177322={'year':_0x13be5f(0x28d),'month':'long','day':_0x13be5f(0x28d)},_0x476340=await master_shop[_0x13be5f(0x292)]();console[_0x13be5f(0x1fc)](_0x13be5f(0x228),_0x476340);const _0x383927=await product['find']();console[_0x13be5f(0x1fc)](_0x13be5f(0x27b),_0x383927);const _0x179e3b=await warehouse[_0x13be5f(0x1d7)]([{'$unwind':_0x13be5f(0x2df)},{'$lookup':{'from':_0x13be5f(0x23f),'localField':_0x13be5f(0x257),'foreignField':_0x13be5f(0x1a7),'as':_0x13be5f(0x1e2)}},{'$unwind':_0x13be5f(0x332)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x13be5f(0x2c7)}},{'$group':{'_id':_0x13be5f(0x289),'product_stock':{'$sum':_0x13be5f(0x2be)}}}]);console[_0x13be5f(0x1fc)](_0x13be5f(0x1a8),_0x179e3b),_0x179e3b[_0x13be5f(0x2a9)](_0x3546bb=>{const _0x441e7e=_0x383927['map'](_0x4f9af5=>{const _0x46d298=a0_0x4377;_0x4f9af5['name']==_0x3546bb[_0x46d298(0x1e3)]&&(_0x4f9af5['stock']=parseInt(_0x4f9af5[_0x46d298(0x26b)])+parseInt(_0x3546bb[_0x46d298(0x319)]));});});const _0x5e07a3=await staff[_0x13be5f(0x292)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x583c57=await staff['findOne']({'email':_0x594e5a[_0x13be5f(0x312)]});if(_0x476340[0x0]['language']==_0x13be5f(0x1ff))var _0x3506e5=users[_0x13be5f(0x203)];else{if(_0x476340[0x0][_0x13be5f(0x1e0)]==_0x13be5f(0x2b9))var _0x3506e5=users[_0x13be5f(0x2b9)];else{if(_0x476340[0x0][_0x13be5f(0x1e0)]==_0x13be5f(0x29a))var _0x3506e5=users[_0x13be5f(0x29a)];else{if(_0x476340[0x0]['language']==_0x13be5f(0x2ed))var _0x3506e5=users['Spanish'];else{if(_0x476340[0x0][_0x13be5f(0x1e0)]==_0x13be5f(0x1eb))var _0x3506e5=users[_0x13be5f(0x1eb)];else{if(_0x476340[0x0][_0x13be5f(0x1e0)]==_0x13be5f(0x284))var _0x3506e5=users[_0x13be5f(0x20f)];else{if(_0x476340[0x0]['language']==_0x13be5f(0x20a))var _0x3506e5=users['Chinese'];else{if(_0x476340[0x0]['language']==_0x13be5f(0x1c9))var _0x3506e5=users['Arabic'];}}}}}}}_0x480773[_0x13be5f(0x245)](_0x13be5f(0x1d6),{'success':_0x1d769a['flash']('success'),'errors':_0x1d769a['flash'](_0x13be5f(0x2a8)),'alldata':_0x383927,'profile':_0x367f33,'master_shop':_0x476340,'role':_0x594e5a,'product_stock':_0x179e3b,'language':_0x3506e5,'staff_arr':_0x583c57,'staff_data_all':_0x5e07a3});}catch(_0x36bca0){}}),router[a0_0x44e325(0x2a7)](a0_0x44e325(0x253),auth,async(_0x48243e,_0x1d41d4)=>{const _0x2a3dda=a0_0x44e325;try{const {from:_0x1b5370,to:_0x37cc0d,staff_data:_0x3670bf}=_0x48243e[_0x2a3dda(0x21d)],_0x259393=await Reference[_0x2a3dda(0x1d7)]([{'$match':{'date_include':{'$gte':_0x1b5370,'$lte':_0x37cc0d},'staff_id':_0x3670bf}},{'$sort':{'date_include':0x1}}]);_0x1d41d4['json'](_0x259393);}catch(_0x2af623){_0x1d41d4[_0x2a3dda(0x25f)](_0x2af623);}}),router['post'](a0_0x44e325(0x1cf),auth,async(_0x54b626,_0x595ff9)=>{const _0x260482=a0_0x44e325;try{const {from:_0x287e00,to:_0x435686}=_0x54b626['body'],{sttaff_id:_0x3bfb85}=_0x54b626[_0x260482(0x30b)],_0xee189b=await Reference[_0x260482(0x1d7)]([{'$match':{'date_include':{'$gte':_0x287e00,'$lte':_0x435686},'staff_id':_0x3bfb85}},{'$sort':{'date_include':0x1}}]);_0x595ff9['json'](_0xee189b);}catch(_0x4b47b6){_0x595ff9[_0x260482(0x25f)](_0x4b47b6);}}),router['get'](a0_0x44e325(0x270),auth,async(_0x43f152,_0x3dd5c6)=>{const _0xc7383d=a0_0x44e325;try{const _0x27181e=_0x43f152['params']['id'],_0xe93d89=await Reference[_0xc7383d(0x27c)](_0x27181e);let _0x1ba0ee='';_0x1ba0ee+=_0xe93d89[_0xc7383d(0x2f3)],_0x1ba0ee+=_0xc7383d(0x2b1),_0x1ba0ee+=_0xc7383d(0x2d4),_0x1ba0ee+=_0xc7383d(0x1f3),_0x1ba0ee+='};',_0x1ba0ee+=_0xc7383d(0x1f2),_0x3dd5c6[_0xc7383d(0x1e5)](_0x1ba0ee);}catch(_0x56aa5d){_0x3dd5c6[_0xc7383d(0x25f)](_0x56aa5d);}}),router['post']('/dl_excel',auth,async(_0x22ab8b,_0x4eeab9)=>{const _0x995cf1=a0_0x44e325;try{const {ref_data:_0x273f1b}=_0x22ab8b[_0x995cf1(0x21d)],_0x1ff51a=_0x273f1b[_0x995cf1(0x2c0)]('~'),_0x342703=_0x1ff51a[_0x995cf1(0x2d9)](_0x52f5c7=>_0x52f5c7!==''),_0x375017=await Reference[_0x995cf1(0x1d7)]([{'$match':{'referenceNumber':{'$in':_0x342703}}}]),_0x3e9f3d=XLSX[_0x995cf1(0x2ef)][_0x995cf1(0x1b9)]();_0x375017[_0x995cf1(0x2a9)](_0x442582=>{const _0x3676e0=_0x995cf1,_0x4af27e=cheerio[_0x3676e0(0x29f)](_0x442582[_0x3676e0(0x2f3)]);let _0x356541=[],_0xecc4ba=[],_0x4539e2=[];_0x4af27e('table\x20tr')['each']((_0x5ce5ba,_0x35cdf1)=>{const _0x357ee4=_0x3676e0;let _0x569b10=[],_0x475a1a=0x0;while(_0x4539e2[_0x475a1a]){_0x4539e2[_0x475a1a]--,_0x475a1a++;}_0x4af27e(_0x35cdf1)[_0x357ee4(0x292)](_0x357ee4(0x1f1))[_0x357ee4(0x2a2)]((_0x5360af,_0x3f06aa)=>{const _0x3de401=_0x357ee4;let _0x4dc011=_0x4af27e(_0x3f06aa)[_0x3de401(0x1cd)]()[_0x3de401(0x258)](),_0x4dee19=parseFloat(_0x4dc011['replace'](/,/g,''));isNaN(_0x4dee19)&&(_0x4dee19=_0x4dc011);let _0x2d4fe2=parseInt(_0x4af27e(_0x3f06aa)[_0x3de401(0x1c8)](_0x3de401(0x1bf)))||0x1,_0x4641b1=parseInt(_0x4af27e(_0x3f06aa)[_0x3de401(0x1c8)](_0x3de401(0x327)))||0x1;_0x569b10[_0x475a1a]=_0x4dee19;(_0x2d4fe2>0x1||_0x4641b1>0x1)&&_0xecc4ba[_0x3de401(0x2a1)]({'s':{'r':_0x5ce5ba,'c':_0x475a1a},'e':{'r':_0x5ce5ba+_0x4641b1-0x1,'c':_0x475a1a+_0x2d4fe2-0x1}});for(let _0x4f7bfc=0x0;_0x4f7bfc<_0x2d4fe2;_0x4f7bfc++){_0x4641b1>0x1&&(_0x4539e2[_0x475a1a+_0x4f7bfc]=_0x4641b1-0x1);}_0x475a1a+=_0x2d4fe2;}),_0x356541[_0x357ee4(0x2a1)](_0x569b10);});const _0x358851=XLSX[_0x3676e0(0x2ef)][_0x3676e0(0x290)](_0x356541);_0xecc4ba[_0x3676e0(0x24f)]>0x0&&(_0x358851[_0x3676e0(0x316)]=_0xecc4ba),_0x358851[_0x3676e0(0x282)]=_0x356541[0x0][_0x3676e0(0x2bf)](()=>({'wpx':0x64})),XLSX['utils'][_0x3676e0(0x23a)](_0x3e9f3d,_0x358851,_0x442582[_0x3676e0(0x20d)]);});const _0x4b9cb9=XLSX[_0x995cf1(0x2e1)](_0x3e9f3d,{'bookType':_0x995cf1(0x276),'type':_0x995cf1(0x1c0)});_0x4eeab9[_0x995cf1(0x238)](_0x995cf1(0x2f9),'attachment;\x20filename=\x22reports.xlsx\x22'),_0x4eeab9[_0x995cf1(0x238)](_0x995cf1(0x324),_0x995cf1(0x1af)),_0x4eeab9[_0x995cf1(0x1e5)](_0x4b9cb9);}catch(_0x2ec406){_0x4eeab9['json'](_0x2ec406);}}),router[a0_0x44e325(0x2a7)](a0_0x44e325(0x2cc),auth,async(_0xfe3ebc,_0xd17832)=>{const _0x37d2ef=a0_0x44e325,{from_date:_0x222ceb,agent_id:_0x48e477}=_0xfe3ebc[_0x37d2ef(0x21d)],_0x5a2269=_0xfe3ebc[_0x37d2ef(0x30b)],_0x37730b=await staff['findOne']({'email':_0x5a2269['email']}),_0x3252d2=await master_shop['find'](),_0x551a43=await agentsdataDSICheck_DSRR(_0x222ceb,_0x48e477,_0x231afb);let _0x4efe9d=_0x37d2ef(0x2fb);var _0x468151=new Date(_0x222ceb);const _0x59ff93={'year':_0x37d2ef(0x28d),'month':_0x37d2ef(0x227),'day':_0x37d2ef(0x28d)},_0x122ca2=new Intl[(_0x37d2ef(0x206))]('en-US',_0x59ff93)['format'](_0x468151);_0x4efe9d+=_0x37d2ef(0x2ac),_0x4efe9d+='<div\x20\x20id=\x22table-conatainer\x22>',_0x4efe9d+=_0x37d2ef(0x21f),_0x4efe9d+=_0x551a43,_0x4efe9d+=_0x37d2ef(0x328),_0x4efe9d+=_0x37d2ef(0x306),_0x4efe9d+='</div>';let _0xd80e74=_0x37d2ef(0x271);const _0x55b296={'width':_0x37d2ef(0x1ae),'height':_0x37d2ef(0x1ca),'orientation':_0x37d2ef(0x331),'border':{'top':_0x37d2ef(0x1ed),'right':'0.1in','bottom':'0.1in','left':_0x37d2ef(0x1ed)},'header':{'height':_0x37d2ef(0x1dc),'contents':_0x37d2ef(0x279)+_0xd80e74+_0x37d2ef(0x25a)+_0x122ca2+_0x37d2ef(0x2d0)},'footer':{'height':'20mm','contents':{'default':_0x37d2ef(0x326)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x37d2ef(0x2bc)}}};var _0x231afb='on';if(_0x231afb=='on'){const _0x5691b9=cheerio[_0x37d2ef(0x29f)](_0x4efe9d);let _0x4e83ca=[],_0x28b603=[],_0xad2a44=[];_0x5691b9(_0x37d2ef(0x303))[_0x37d2ef(0x2a2)]((_0x2fd7a8,_0x371a16)=>{const _0x30e436=_0x37d2ef;let _0x453ee3=[],_0x29b472=0x0;while(_0xad2a44[_0x29b472]){_0xad2a44[_0x29b472]--,_0x29b472++;}_0x5691b9(_0x371a16)[_0x30e436(0x292)]('td,\x20th')[_0x30e436(0x2a2)]((_0x33e9ad,_0xafc93f)=>{const _0x36295a=_0x30e436;let _0x4f9899=_0x5691b9(_0xafc93f)[_0x36295a(0x1cd)]()[_0x36295a(0x258)](),_0x30bd3c=parseFloat(_0x4f9899[_0x36295a(0x32c)](/,/g,''));isNaN(_0x30bd3c)&&(_0x30bd3c=_0x4f9899);let _0x27af79=parseInt(_0x5691b9(_0xafc93f)[_0x36295a(0x1c8)](_0x36295a(0x1bf)))||0x1,_0x1e54df=parseInt(_0x5691b9(_0xafc93f)[_0x36295a(0x1c8)]('rowspan'))||0x1;_0x453ee3[_0x29b472]=_0x30bd3c;(_0x27af79>0x1||_0x1e54df>0x1)&&_0x28b603[_0x36295a(0x2a1)]({'s':{'r':_0x2fd7a8,'c':_0x29b472},'e':{'r':_0x2fd7a8+_0x1e54df-0x1,'c':_0x29b472+_0x27af79-0x1}});for(let _0xa4888e=0x0;_0xa4888e<_0x27af79;_0xa4888e++){_0x1e54df>0x1&&(_0xad2a44[_0x29b472+_0xa4888e]=_0x1e54df-0x1);}_0x29b472+=_0x27af79;}),_0x4e83ca[_0x30e436(0x2a1)](_0x453ee3);});const _0x502ef9=XLSX['utils']['book_new'](),_0x46912d=XLSX[_0x37d2ef(0x2ef)][_0x37d2ef(0x290)](_0x4e83ca);_0x28b603[_0x37d2ef(0x24f)]>0x0&&(_0x46912d[_0x37d2ef(0x316)]=_0x28b603);_0x46912d[_0x37d2ef(0x282)]=_0x4e83ca[0x0][_0x37d2ef(0x2bf)](()=>({'wpx':0x64})),XLSX['utils'][_0x37d2ef(0x23a)](_0x502ef9,_0x46912d,_0x37d2ef(0x2b5));const _0x23d25f=XLSX[_0x37d2ef(0x2e1)](_0x502ef9,{'bookType':'xlsx','type':_0x37d2ef(0x1c0)});_0xd17832[_0x37d2ef(0x238)]('Content-Disposition',_0x37d2ef(0x2c3)),_0xd17832[_0x37d2ef(0x238)](_0x37d2ef(0x324),_0x37d2ef(0x1af)),_0xd17832[_0x37d2ef(0x1e5)](_0x23d25f);}else pdf['create'](_0x4efe9d,_0x55b296)[_0x37d2ef(0x28e)](function(_0x10b7c0,_0x190c2f){const _0xf27261=_0x37d2ef;if(_0x10b7c0){_0xd17832[_0xf27261(0x2e7)](0x1f4)[_0xf27261(0x1e5)](_0xf27261(0x225));return;}_0xd17832[_0xf27261(0x238)](_0xf27261(0x324),_0xf27261(0x205)),_0x190c2f[_0xf27261(0x2fa)](_0xd17832);});}),module['exports']=router;