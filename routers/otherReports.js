const a0_0x4019cd=a0_0x3219;(function(_0x4759d6,_0x238ed6){const _0x4e207b=a0_0x3219,_0x1e653c=_0x4759d6();while(!![]){try{const _0x5b69da=-parseInt(_0x4e207b(0xf7))/0x1*(parseInt(_0x4e207b(0x1c4))/0x2)+parseInt(_0x4e207b(0xc9))/0x3*(parseInt(_0x4e207b(0x1a5))/0x4)+parseInt(_0x4e207b(0x23c))/0x5*(parseInt(_0x4e207b(0x111))/0x6)+-parseInt(_0x4e207b(0x22a))/0x7*(-parseInt(_0x4e207b(0xea))/0x8)+-parseInt(_0x4e207b(0x203))/0x9+parseInt(_0x4e207b(0x17b))/0xa+-parseInt(_0x4e207b(0x232))/0xb;if(_0x5b69da===_0x238ed6)break;else _0x1e653c['push'](_0x1e653c['shift']());}catch(_0x67c9f2){_0x1e653c['push'](_0x1e653c['shift']());}}}(a0_0x20b8,0x2bf13));const express=require(a0_0x4019cd(0x17c)),res=require(a0_0x4019cd(0x160)),app=express(),router=express[a0_0x4019cd(0x21b)](),multer=require(a0_0x4019cd(0xbf)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x4019cd(0x147)),auth=require(a0_0x4019cd(0x142)),users=require(a0_0x4019cd(0x11a)),excelJS=require('exceljs'),XLSX=require(a0_0x4019cd(0xc1)),PDFDocument=require(a0_0x4019cd(0x1e0)),fs=require('fs'),blobStream=require('blob-stream'),JsBarcode=require('jsbarcode'),{Canvas}=require('canvas'),pdf=require(a0_0x4019cd(0x148)),path=require(a0_0x4019cd(0x219)),mongoose=require(a0_0x4019cd(0x1cd)),cheerio=require('cheerio');router[a0_0x4019cd(0x107)](a0_0x4019cd(0x14c),auth,async(_0x42f239,_0x40611b)=>{const _0x366e36=a0_0x4019cd;try{const {username:_0x418fc2,email:_0x567a9e,role:_0x49a6eb}=_0x42f239[_0x366e36(0x10f)],_0x79ccfe=_0x42f239['user'],_0x5a4199=await profile[_0x366e36(0x163)]({'email':_0x79ccfe['email']}),_0x4be66d={'year':_0x366e36(0x182),'month':_0x366e36(0x1d4),'day':_0x366e36(0x182)},_0x2203e9=await master_shop[_0x366e36(0x15a)]();console[_0x366e36(0x22c)](_0x366e36(0xf0),_0x2203e9);const _0xaccc0b=await product[_0x366e36(0x15a)]();console[_0x366e36(0x22c)](_0x366e36(0x136),_0xaccc0b);const _0x5df2f2=await warehouse[_0x366e36(0xf9)]([{'$unwind':_0x366e36(0xde)},{'$lookup':{'from':_0x366e36(0x14f),'localField':'product_details.product_name','foreignField':_0x366e36(0x21c),'as':_0x366e36(0x1de)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x366e36(0x208),'product_stock':_0x366e36(0xe7)}},{'$group':{'_id':_0x366e36(0x234),'product_stock':{'$sum':_0x366e36(0x14e)}}}]);console['log'](_0x366e36(0xc2),_0x5df2f2),_0x5df2f2[_0x366e36(0x1a4)](_0x2cbfbc=>{const _0x6e6a03=_0x366e36,_0x23af7f=_0xaccc0b[_0x6e6a03(0x173)](_0x11e9bf=>{const _0x42530e=_0x6e6a03;_0x11e9bf[_0x42530e(0x21c)]==_0x2cbfbc[_0x42530e(0x1ff)]&&(_0x11e9bf[_0x42530e(0xe8)]=parseInt(_0x11e9bf[_0x42530e(0xe8)])+parseInt(_0x2cbfbc[_0x42530e(0x175)]));});}),console[_0x366e36(0x22c)](_0x366e36(0x136),_0xaccc0b);if(_0x2203e9[0x0]['language']==_0x366e36(0x1cc))var _0xc974c6=users[_0x366e36(0x196)];else{if(_0x2203e9[0x0][_0x366e36(0x139)]=='Hindi')var _0xc974c6=users['Hindi'];else{if(_0x2203e9[0x0]['language']==_0x366e36(0xc0))var _0xc974c6=users[_0x366e36(0xc0)];else{if(_0x2203e9[0x0][_0x366e36(0x139)]=='Spanish')var _0xc974c6=users[_0x366e36(0x20d)];else{if(_0x2203e9[0x0]['language']=='French')var _0xc974c6=users[_0x366e36(0x152)];else{if(_0x2203e9[0x0][_0x366e36(0x139)]==_0x366e36(0x1b8))var _0xc974c6=users['Portuguese'];else{if(_0x2203e9[0x0][_0x366e36(0x139)]==_0x366e36(0x23a))var _0xc974c6=users['Chinese'];else{if(_0x2203e9[0x0][_0x366e36(0x139)]==_0x366e36(0x133))var _0xc974c6=users[_0x366e36(0xf6)];}}}}}}}_0x40611b[_0x366e36(0x18b)](_0x366e36(0x1f6),{'success':_0x42f239[_0x366e36(0xce)]('success'),'errors':_0x42f239[_0x366e36(0xce)](_0x366e36(0x194)),'alldata':_0xaccc0b,'profile':_0x5a4199,'master_shop':_0x2203e9,'role':_0x79ccfe,'product_stock':_0x5df2f2,'language':_0xc974c6});}catch(_0x2bc2d8){}});async function dataCheck(_0x54dc6a,_0x11febe){const _0x591e83=a0_0x4019cd,_0x35a763=await product[_0x591e83(0xf9)]([{'$group':{'_id':{'brand':_0x591e83(0x23b),'category':_0x591e83(0x10e)},'products':{'$push':{'name':'$name','product_code':_0x591e83(0xdc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x44aed4=[];_0x44aed4['cat_brand']=[];for(let _0x27edca=0x0;_0x27edca<=_0x35a763[_0x591e83(0x1d7)]-0x1;_0x27edca++){const _0x304468=_0x35a763[_0x27edca];_0x44aed4[_0x591e83(0xb9)]['push'](_0x304468);}const _0x47688a=await product[_0x591e83(0xf9)]([{'$group':{'_id':{'category':_0x591e83(0x10e)},'products':{'$push':{'brand':_0x591e83(0x23b),'product_code':'$product_code','product_name':_0x591e83(0x1a8)}}}},{'$sort':{'_id.category':-0x1}}]),_0x316f02=await purchases_finished[_0x591e83(0xf9)]([{'$match':{'date':{'$gte':_0x54dc6a,'$lte':_0x11febe}}},{'$unwind':_0x591e83(0xfe)},{'$group':{'_id':{'product_name':_0x591e83(0x1a7),'product_code':_0x591e83(0xe3)},'totalQTY':{'$sum':_0x591e83(0x159)}}}]);_0x44aed4[_0x591e83(0x167)]=[];for(let _0xd88da4=0x0;_0xd88da4<=_0x316f02[_0x591e83(0x1d7)]-0x1;_0xd88da4++){const _0x27c418=_0x316f02[_0xd88da4];_0x44aed4[_0x591e83(0x167)][_0x591e83(0x1d8)](_0x27c418);}const _0x149dd4=await sales_sa[_0x591e83(0xf9)]([{'$match':{'date':{'$gte':_0x54dc6a,'$lte':_0x11febe}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x591e83(0x1be),'localField':_0x591e83(0x169),'foreignField':_0x591e83(0x1ff),'as':_0x591e83(0xfb)}},{'$unwind':_0x591e83(0x20a)},{'$unwind':_0x591e83(0xc4)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x591e83(0x16b),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x591e83(0x125)}}}]);console['log'](_0x149dd4[0x0]),_0x44aed4[_0x591e83(0x229)]=[];for(let _0x5c80e4=0x0;_0x5c80e4<=_0x149dd4[_0x591e83(0x1d7)]-0x1;_0x5c80e4++){const _0x5b2990=_0x149dd4[_0x5c80e4];_0x44aed4['sales_bkg'][_0x591e83(0x1d8)](_0x5b2990);}const _0x29fda2=await sales_sa[_0x591e83(0xf9)]([{'$match':{'date':{'$gte':_0x54dc6a,'$lte':_0x11febe}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x591e83(0x104)}}},{'$lookup':{'from':_0x591e83(0x1be),'localField':_0x591e83(0x169),'foreignField':_0x591e83(0x1ff),'as':_0x591e83(0xfb)}},{'$unwind':_0x591e83(0x20a)},{'$unwind':_0x591e83(0xc4)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x591e83(0x18f)}},{'$group':{'_id':{'product_name':_0x591e83(0x16b),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x591e83(0x11e)}}}]);_0x44aed4[_0x591e83(0x1db)]=[];for(let _0xf340c2=0x0;_0xf340c2<=_0x29fda2['length']-0x1;_0xf340c2++){const _0x2fc10f=_0x29fda2[_0xf340c2];_0x44aed4[_0x591e83(0x1db)][_0x591e83(0x1d8)](_0x2fc10f);}let _0x32fa5d='';for(let _0x1c21db=0x0;_0x1c21db<=_0x47688a[_0x591e83(0x1d7)]-0x1;_0x1c21db++){const _0x4d1db3=_0x47688a[_0x1c21db];_0x32fa5d+=_0x591e83(0x21a),_0x32fa5d+=_0x591e83(0x1e1)+_0x4d1db3[_0x591e83(0x1ff)]['category']+'</td>',_0x32fa5d+=_0x591e83(0x132);for(let _0x34f84e=0x0;_0x34f84e<_0x44aed4[_0x591e83(0xb9)]['length'];_0x34f84e++){const _0x2f77e3=_0x44aed4[_0x591e83(0xb9)][_0x34f84e];if(_0x2f77e3[_0x591e83(0x1ff)][_0x591e83(0x216)]==_0x4d1db3[_0x591e83(0x1ff)][_0x591e83(0x216)]){let _0x3a6e26=[],_0x39badb=[],_0x182632=[];_0x3a6e26[_0x2f77e3[_0x591e83(0x1ff)][_0x591e83(0x190)]]=[],_0x39badb[_0x2f77e3['_id'][_0x591e83(0x190)]]=[],_0x182632[_0x2f77e3[_0x591e83(0x1ff)][_0x591e83(0x190)]]=[];var _0x1d5026=0x0,_0x32e73c=0x0,_0x106967=0x0;for(let _0x149492=0x0;_0x149492<_0x2f77e3['products'][_0x591e83(0x1d7)];_0x149492++){const _0x536c0e=_0x2f77e3['products'][_0x149492];for(let _0x129078=0x0;_0x129078<=_0x44aed4['beg_bal']['length']-0x1;_0x129078++){const _0x4b99cf=_0x44aed4[_0x591e83(0x167)][_0x129078];_0x4b99cf[_0x591e83(0x1ff)][_0x591e83(0x184)]==_0x536c0e[_0x591e83(0x21c)]&&_0x4b99cf[_0x591e83(0x1ff)][_0x591e83(0x138)]==_0x536c0e[_0x591e83(0x138)]&&(_0x1d5026+=parseInt(_0x4b99cf[_0x591e83(0x13d)],0xa));}for(let _0x28c87a=0x0;_0x28c87a<=_0x44aed4['sales_ext'][_0x591e83(0x1d7)]-0x1;_0x28c87a++){const _0x5ec9a0=_0x44aed4[_0x591e83(0x1db)][_0x28c87a];_0x5ec9a0[_0x591e83(0x1ff)]['product_name']==_0x536c0e[_0x591e83(0x21c)]&&_0x5ec9a0[_0x591e83(0x1ff)][_0x591e83(0x138)]==_0x536c0e[_0x591e83(0x138)]&&(_0x32e73c+=parseFloat(_0x5ec9a0[_0x591e83(0x13d)],0xa)['toFixed'](0x2));}for(let _0x4f0144=0x0;_0x4f0144<=_0x44aed4['sales_bkg'][_0x591e83(0x1d7)]-0x1;_0x4f0144++){const _0x54be90=_0x44aed4[_0x591e83(0x229)][_0x4f0144];_0x54be90[_0x591e83(0x1ff)][_0x591e83(0x184)]==_0x536c0e[_0x591e83(0x21c)]&&_0x54be90[_0x591e83(0x1ff)][_0x591e83(0x138)]==_0x536c0e[_0x591e83(0x138)]&&(_0x106967+=parseInt(_0x54be90[_0x591e83(0x13d)],0xa));}}const _0x2cc613=new Intl[(_0x591e83(0x212))](_0x591e83(0x1cb));var _0x8f32b0=_0x2cc613['format'](_0x1d5026);_0x3a6e26[_0x2f77e3[_0x591e83(0x1ff)][_0x591e83(0x190)]][_0x591e83(0x1d8)](_0x8f32b0),_0x39badb[_0x2f77e3[_0x591e83(0x1ff)][_0x591e83(0x190)]][_0x591e83(0x1d8)](_0x2cc613['format'](_0x32e73c)),_0x182632[_0x2f77e3[_0x591e83(0x1ff)][_0x591e83(0x190)]][_0x591e83(0x1d8)](_0x2cc613['format'](_0x106967));var _0x504c11=_0x2cc613[_0x591e83(0x119)](_0x1d5026-(_0x106967+_0x32e73c));_0x32fa5d+=_0x591e83(0x21a),_0x32fa5d+='<td\x20class=\x22row_data\x22></td>',_0x32fa5d+=_0x591e83(0x16c)+_0x2f77e3['_id'][_0x591e83(0x190)]+_0x591e83(0x197),_0x32fa5d+=_0x591e83(0x16c)+_0x3a6e26[_0x2f77e3['_id'][_0x591e83(0x190)]][0x0]+_0x591e83(0x197),_0x32fa5d+='<td\x20class=\x22row_data\x22>0</td>',_0x32fa5d+='<td\x20class=\x22row_data\x22>'+_0x182632[_0x2f77e3[_0x591e83(0x1ff)][_0x591e83(0x190)]][0x0]+_0x591e83(0x197),_0x32fa5d+=_0x591e83(0x16c)+_0x39badb[_0x2f77e3[_0x591e83(0x1ff)][_0x591e83(0x190)]][0x0]+_0x591e83(0x197),_0x32fa5d+=_0x591e83(0x16c)+_0x504c11+_0x591e83(0x197),_0x32fa5d+=_0x591e83(0x132);}}}return console[_0x591e83(0x22c)](_0x44aed4[_0x591e83(0x229)]),_0x32fa5d;}router['post'](a0_0x4019cd(0x195),auth,async(_0x1a0c1f,_0x1104ea)=>{const _0x6c1976=a0_0x4019cd,{from_date:_0x4d4f22,to_date:_0x10ea28}=_0x1a0c1f[_0x6c1976(0x15b)],_0x8782b7=await dataCheck(_0x4d4f22,_0x10ea28);{}let _0x56bad7=_0x6c1976(0x1a2);var _0x568855=new Date(_0x4d4f22),_0x5b8dba=new Date(_0x10ea28);const _0x5ce6fb={'year':_0x6c1976(0x182),'month':_0x6c1976(0x1d4),'day':'numeric'},_0x515c9d=new Intl[(_0x6c1976(0x17d))](_0x6c1976(0x1cb),_0x5ce6fb)['format'](_0x568855),_0x10ac43=new Intl['DateTimeFormat'](_0x6c1976(0x1cb),_0x5ce6fb)[_0x6c1976(0x119)](_0x5b8dba);_0x56bad7+=_0x6c1976(0xd6),_0x56bad7+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x56bad7+=_0x6c1976(0x188)+_0x515c9d+_0x6c1976(0x1e7)+_0x10ac43+_0x6c1976(0x1ed),_0x56bad7+=_0x6c1976(0x166),_0x56bad7+=_0x6c1976(0xb8),_0x56bad7+=_0x6c1976(0x20c),_0x56bad7+=_0x6c1976(0x21a),_0x56bad7+=_0x6c1976(0xfd),_0x56bad7+=_0x6c1976(0x1a3),_0x56bad7+=_0x6c1976(0x165)+_0x515c9d+_0x6c1976(0xf2),_0x56bad7+=_0x6c1976(0x140),_0x56bad7+=_0x6c1976(0xeb),_0x56bad7+=_0x6c1976(0x19b)+_0x10ac43+_0x6c1976(0xf2),_0x56bad7+='</tr>',_0x56bad7+=_0x6c1976(0x21a),_0x56bad7+='<th>Booking</th>',_0x56bad7+='<th>X-Truck</th>',_0x56bad7+='</tr>',_0x56bad7+=_0x8782b7,_0x56bad7+=_0x6c1976(0x1b0),_0x56bad7+=_0x6c1976(0x1ec),_0x56bad7+=_0x6c1976(0x1ec);const _0x1f25cf={'format':_0x6c1976(0x1dd),'orientation':_0x6c1976(0x1e6)};pdf['create'](_0x56bad7,_0x1f25cf)[_0x6c1976(0x1e3)](function(_0x27698b,_0x3e5b9b){const _0x16cdeb=_0x6c1976;if(_0x27698b){_0x1104ea[_0x16cdeb(0x10a)](0x1f4)[_0x16cdeb(0xed)]('Error\x20generating\x20PDF');return;}_0x1104ea[_0x16cdeb(0x103)](_0x16cdeb(0x162),_0x16cdeb(0x1c0)),_0x3e5b9b[_0x16cdeb(0x10d)](_0x1104ea);});}),router[a0_0x4019cd(0x107)](a0_0x4019cd(0x1df),auth,async(_0x18ce1d,_0x7c500d)=>{const _0xab461e=a0_0x4019cd;try{const {username:_0x3dd8f2,email:_0x3f89f4,role:_0x3f6f15}=_0x18ce1d[_0xab461e(0x10f)],_0x47e7fe=_0x18ce1d['user'],_0xe65e88=await profile['findOne']({'email':_0x47e7fe[_0xab461e(0x1ee)]}),_0x2162c0={'year':_0xab461e(0x182),'month':_0xab461e(0x1d4),'day':'numeric'},_0x67656a=await master_shop[_0xab461e(0x15a)](),_0x497dbd=await product[_0xab461e(0x15a)](),_0x4b5276=await warehouse[_0xab461e(0xf9)]([{'$unwind':_0xab461e(0xde)},{'$lookup':{'from':'products','localField':_0xab461e(0x20e),'foreignField':_0xab461e(0x21c),'as':'product_docs'}},{'$unwind':_0xab461e(0x1c9)},{'$project':{'product_name':_0xab461e(0x208),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0xab461e(0x234),'product_stock':{'$sum':_0xab461e(0x14e)}}}]);if(_0x67656a[0x0][_0xab461e(0x139)]==_0xab461e(0x1cc))var _0xc53d6e=users[_0xab461e(0x196)];else{if(_0x67656a[0x0]['language']==_0xab461e(0xe1))var _0xc53d6e=users[_0xab461e(0xe1)];else{if(_0x67656a[0x0][_0xab461e(0x139)]==_0xab461e(0xc0))var _0xc53d6e=users[_0xab461e(0xc0)];else{if(_0x67656a[0x0][_0xab461e(0x139)]==_0xab461e(0x20d))var _0xc53d6e=users[_0xab461e(0x20d)];else{if(_0x67656a[0x0]['language']=='French')var _0xc53d6e=users[_0xab461e(0x152)];else{if(_0x67656a[0x0][_0xab461e(0x139)]==_0xab461e(0x1b8))var _0xc53d6e=users['Portuguese'];else{if(_0x67656a[0x0][_0xab461e(0x139)]==_0xab461e(0x23a))var _0xc53d6e=users['Chinese'];else{if(_0x67656a[0x0]['language']==_0xab461e(0x133))var _0xc53d6e=users[_0xab461e(0xf6)];}}}}}}}_0x7c500d[_0xab461e(0x18b)](_0xab461e(0x154),{'success':_0x18ce1d[_0xab461e(0xce)](_0xab461e(0xee)),'errors':_0x18ce1d[_0xab461e(0xce)](_0xab461e(0x194)),'alldata':_0x497dbd,'profile':_0xe65e88,'master_shop':_0x67656a,'role':_0x47e7fe,'product_stock':_0x4b5276,'language':_0xc53d6e});}catch(_0x29c37d){}});async function agentsdataCheck(_0x4e2581,_0x47a0ef){const _0x50542b=a0_0x4019cd,_0x578fae=await product[_0x50542b(0xf9)]([{'$group':{'_id':{'brand':_0x50542b(0x23b),'category':'$category'},'products':{'$push':{'name':_0x50542b(0x1a8),'product_code':_0x50542b(0xdc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1e1c3c=[];_0x1e1c3c[_0x50542b(0xb9)]=[];for(let _0x39bd48=0x0;_0x39bd48<=_0x578fae[_0x50542b(0x1d7)]-0x1;_0x39bd48++){const _0x3c8067=_0x578fae[_0x39bd48];_0x1e1c3c[_0x50542b(0xb9)][_0x50542b(0x1d8)](_0x3c8067);}const _0x7aa501=await product[_0x50542b(0xf9)]([{'$group':{'_id':{'category':_0x50542b(0x10e)},'products':{'$push':{'brand':_0x50542b(0x23b),'product_code':_0x50542b(0xdc),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x5bec66=await product[_0x50542b(0xf9)]([{'$group':{'_id':{'category':_0x50542b(0x10e),'brand':_0x50542b(0x23b)}}},{'$group':{'_id':_0x50542b(0x1ca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x42d7ba=await sales_sa[_0x50542b(0xf9)]([{'$match':{'date':{'$gte':_0x4e2581,'$lte':_0x47a0ef}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x50542b(0x104)}}},{'$lookup':{'from':_0x50542b(0x1be),'localField':_0x50542b(0x169),'foreignField':_0x50542b(0x1ff),'as':_0x50542b(0xfb)}},{'$unwind':_0x50542b(0x20a)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':'false'}},{'$lookup':{'from':_0x50542b(0x14f),'localField':_0x50542b(0x22d),'foreignField':_0x50542b(0x138),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'sales_id':'$sales_info._id','category':'$product_info.category','brand':_0x50542b(0xfc)},'salesman_data':{'$first':_0x50542b(0x1d6)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','product_details':{'prod_name':_0x50542b(0x127),'product_code':'$product_info.product_code','category':_0x50542b(0x217),'brand':_0x50542b(0xfc)}}}}}]);let _0x432113='';_0x432113+=_0x50542b(0x21a),_0x432113+=_0x50542b(0x122),_0x432113+='</tr>',_0x432113+=_0x50542b(0x21a),_0x432113+=_0x50542b(0x176);for(let _0x20254f=0x0;_0x20254f<=_0x7aa501[_0x50542b(0x1d7)]-0x1;_0x20254f++){const _0x387b82=_0x7aa501[_0x20254f];for(let _0x447269=0x0;_0x447269<_0x5bec66[_0x50542b(0x1d7)];_0x447269++){const _0x25d7f8=_0x5bec66[_0x447269];_0x25d7f8[_0x50542b(0x1ff)]==_0x387b82[_0x50542b(0x1ff)][_0x50542b(0x216)]&&(_0x432113+='<td\x20colspan=\x22'+_0x25d7f8[_0x50542b(0x245)]+_0x50542b(0x1a9)+_0x387b82[_0x50542b(0x1ff)][_0x50542b(0x216)]+_0x50542b(0x197));}}_0x432113+=_0x50542b(0x176),_0x432113+=_0x50542b(0x132),_0x432113+=_0x50542b(0x21a),_0x432113+=_0x50542b(0x235);for(let _0xddad1c=0x0;_0xddad1c<=_0x7aa501['length']-0x1;_0xddad1c++){const _0x3ab7f0=_0x7aa501[_0xddad1c];for(let _0x2518fc=0x0;_0x2518fc<_0x1e1c3c[_0x50542b(0xb9)][_0x50542b(0x1d7)];_0x2518fc++){const _0x20926c=_0x1e1c3c[_0x50542b(0xb9)][_0x2518fc];_0x20926c['_id'][_0x50542b(0x216)]==_0x3ab7f0[_0x50542b(0x1ff)]['category']&&(_0x432113+=_0x50542b(0x177)+_0x20926c[_0x50542b(0x1ff)][_0x50542b(0x190)]+_0x50542b(0x197));}}_0x432113+=_0x50542b(0x202),_0x432113+=_0x50542b(0x132);let _0x5e3108={'name':[],'dataqty':{}};for(let _0x5b95d7=0x0;_0x5b95d7<_0x1e1c3c[_0x50542b(0xb9)][_0x50542b(0x1d7)];_0x5b95d7++){const _0x4796c7=_0x1e1c3c['cat_brand'][_0x5b95d7],_0x14d8af=_0x4796c7[_0x50542b(0x1ff)]['brand'],_0x4d1ce6=_0x4796c7[_0x50542b(0x1ff)][_0x50542b(0x216)];!_0x5e3108[_0x50542b(0xc5)][_0x14d8af]&&(_0x5e3108[_0x50542b(0xc5)][_0x14d8af]={});!_0x5e3108[_0x50542b(0xc5)][_0x14d8af][_0x4d1ce6]&&(_0x5e3108[_0x50542b(0xc5)][_0x14d8af][_0x4d1ce6]=[]);for(let _0xdbe47f=0x0;_0xdbe47f<_0x42d7ba[_0x50542b(0x1d7)];_0xdbe47f++){const _0x3002a7=_0x42d7ba[_0xdbe47f];if(_0x14d8af===_0x3002a7['_id'][_0x50542b(0x190)]&&_0x4d1ce6===_0x3002a7[_0x50542b(0x1ff)][_0x50542b(0x216)]){const _0x46e4cb=_0x3002a7[_0x50542b(0x12a)];!_0x5e3108[_0x50542b(0xc5)][_0x14d8af][_0x4d1ce6][_0x46e4cb]&&(_0x5e3108['dataqty'][_0x14d8af][_0x4d1ce6][_0x46e4cb]=[]),_0x5e3108['dataqty'][_0x14d8af][_0x4d1ce6][_0x46e4cb][_0x50542b(0x1d8)](_0x3002a7[_0x50542b(0x13d)]),!_0x5e3108['name'][_0x50542b(0xd0)](_0x46e4cb)&&_0x5e3108[_0x50542b(0x21c)]['push'](_0x46e4cb);}}}_0x432113+=_0x50542b(0x21a);for(let _0x18d9a8=0x0;_0x18d9a8<=_0x5e3108[_0x50542b(0x21c)]['length']-0x1;_0x18d9a8++){const _0x35d45e=_0x5e3108[_0x50542b(0x21c)][_0x18d9a8];_0x432113+='<td\x20class=\x22row_data\x22>'+_0x35d45e+'</td>';var _0x36c6b2=0x0,_0x3e4337=0x0;for(let _0x28eea3=0x0;_0x28eea3<=_0x1e1c3c[_0x50542b(0xb9)][_0x50542b(0x1d7)]-0x1;_0x28eea3++){const _0x3d0840=_0x1e1c3c['cat_brand'][_0x28eea3];var _0xd7d367=0x0;_0x5e3108[_0x50542b(0xc5)][_0x3d0840['_id'][_0x50542b(0x190)]][_0x3d0840[_0x50542b(0x1ff)][_0x50542b(0x216)]][_0x35d45e]?(_0xd7d367=_0x5e3108['dataqty'][_0x3d0840[_0x50542b(0x1ff)][_0x50542b(0x190)]][_0x3d0840['_id'][_0x50542b(0x216)]][_0x35d45e][0x0],_0x432113+=_0x50542b(0x16c)+formatNumber(_0xd7d367[_0x50542b(0xc7)](0x2))+_0x50542b(0x197)):(_0xd7d367=0x0,_0x432113+='<td\x20class=\x22row_data\x22>'+_0xd7d367+_0x50542b(0x197)),_0x36c6b2+=_0xd7d367;}_0x432113+=_0x50542b(0x16c)+formatNumber(_0x36c6b2[_0x50542b(0xc7)](0x2))+_0x50542b(0x197);}return _0x432113+='</tr>',_0x432113;}router[a0_0x4019cd(0x228)](a0_0x4019cd(0x207),auth,async(_0x3399cf,_0x338ffc)=>{const _0xe5b02b=a0_0x4019cd,{from_date:_0x459c29,to_date:_0x1a1129}=_0x3399cf[_0xe5b02b(0x15b)],_0x17bdb6=await agentsdataCheck(_0x459c29,_0x1a1129);{}let _0x299b91='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x5487b0=new Date(_0x459c29),_0x408a0f=new Date(_0x1a1129);const _0x1c3a98={'year':'numeric','month':_0xe5b02b(0x1d4),'day':_0xe5b02b(0x182)},_0xf8e43b=new Intl[(_0xe5b02b(0x17d))](_0xe5b02b(0x1cb),_0x1c3a98)[_0xe5b02b(0x119)](_0x5487b0),_0x12249a=new Intl[(_0xe5b02b(0x17d))](_0xe5b02b(0x1cb),_0x1c3a98)[_0xe5b02b(0x119)](_0x408a0f);_0x299b91+=_0xe5b02b(0xd6),_0x299b91+=_0xe5b02b(0xd9),_0x299b91+=_0xe5b02b(0x188)+_0xf8e43b+_0xe5b02b(0x1e7)+_0x12249a+_0xe5b02b(0x1ed),_0x299b91+=_0xe5b02b(0x166),_0x299b91+='<div\x20class=\x22col-sm-11\x22>',_0x299b91+='<table>',_0x299b91+=_0x17bdb6,_0x299b91+=_0xe5b02b(0x1b0),_0x299b91+='</div>',_0x299b91+='</div>';const _0x3207b9={'format':_0xe5b02b(0x1dd),'orientation':_0xe5b02b(0x1e6)};pdf[_0xe5b02b(0x1eb)](_0x299b91,_0x3207b9)[_0xe5b02b(0x1e3)](function(_0x58725,_0x4e5b1c){const _0x56b0b3=_0xe5b02b;if(_0x58725){_0x338ffc[_0x56b0b3(0x10a)](0x1f4)[_0x56b0b3(0xed)](_0x56b0b3(0x1d3));return;}_0x338ffc['setHeader']('Content-Type',_0x56b0b3(0x1c0)),_0x4e5b1c['pipe'](_0x338ffc);});}),router['get']('/agent_reports/sales_ad',auth,async(_0x474998,_0x3e389e)=>{const _0x3ffe5f=a0_0x4019cd;try{const {username:_0x252c38,email:_0x23c043,role:_0x373404}=_0x474998[_0x3ffe5f(0x10f)],_0x3de01b=_0x474998[_0x3ffe5f(0x10f)],_0x499ecb=await profile[_0x3ffe5f(0x163)]({'email':_0x3de01b['email']}),_0x3e1b82={'year':'numeric','month':_0x3ffe5f(0x1d4),'day':_0x3ffe5f(0x182)},_0x44c32a=await master_shop[_0x3ffe5f(0x15a)](),_0x626bb9=await staff[_0x3ffe5f(0x163)]({'email':_0x3de01b[_0x3ffe5f(0x1ee)]}),_0x61995c=await product[_0x3ffe5f(0x15a)](),_0x5e9d3a=await warehouse['aggregate']([{'$unwind':_0x3ffe5f(0xde)},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':_0x3ffe5f(0x21c),'as':_0x3ffe5f(0x1de)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x3ffe5f(0x208),'product_stock':_0x3ffe5f(0xe7)}},{'$group':{'_id':_0x3ffe5f(0x234),'product_stock':{'$sum':_0x3ffe5f(0x14e)}}}]),_0x3eced8=await staff[_0x3ffe5f(0x15a)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x44c32a[0x0][_0x3ffe5f(0x139)]==_0x3ffe5f(0x1cc))var _0x20c7f2=users[_0x3ffe5f(0x196)];else{if(_0x44c32a[0x0][_0x3ffe5f(0x139)]=='Hindi')var _0x20c7f2=users[_0x3ffe5f(0xe1)];else{if(_0x44c32a[0x0][_0x3ffe5f(0x139)]==_0x3ffe5f(0xc0))var _0x20c7f2=users[_0x3ffe5f(0xc0)];else{if(_0x44c32a[0x0]['language']=='Spanish')var _0x20c7f2=users[_0x3ffe5f(0x20d)];else{if(_0x44c32a[0x0][_0x3ffe5f(0x139)]==_0x3ffe5f(0x152))var _0x20c7f2=users['French'];else{if(_0x44c32a[0x0]['language']==_0x3ffe5f(0x1b8))var _0x20c7f2=users[_0x3ffe5f(0x22b)];else{if(_0x44c32a[0x0]['language']==_0x3ffe5f(0x23a))var _0x20c7f2=users['Chinese'];else{if(_0x44c32a[0x0][_0x3ffe5f(0x139)]==_0x3ffe5f(0x133))var _0x20c7f2=users[_0x3ffe5f(0xf6)];}}}}}}}_0x3e389e[_0x3ffe5f(0x18b)](_0x3ffe5f(0x241),{'success':_0x474998[_0x3ffe5f(0xce)]('success'),'errors':_0x474998['flash'](_0x3ffe5f(0x194)),'alldata':_0x61995c,'profile':_0x499ecb,'master_shop':_0x44c32a,'role':_0x3de01b,'product_stock':_0x5e9d3a,'language':_0x20c7f2,'staff_arr':_0x626bb9,'staff_data_all':_0x3eced8});}catch(_0x26d9e9){_0x3e389e[_0x3ffe5f(0x117)](_0x26d9e9);}});async function agentsdataDSICheck_admin(_0x183deb,_0x3ccc6c,_0x1afc0b,_0x34174f){const _0x1820e5=a0_0x4019cd,_0x231d43=await product[_0x1820e5(0xf9)]([{'$group':{'_id':{'brand':'$brand','category':_0x1820e5(0x10e)},'products':{'$push':{'name':_0x1820e5(0x1a8),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x30dd0b=[];_0x30dd0b[_0x1820e5(0xb9)]=[];for(let _0x4ce7f6=0x0;_0x4ce7f6<=_0x231d43[_0x1820e5(0x1d7)]-0x1;_0x4ce7f6++){const _0x2134ad=_0x231d43[_0x4ce7f6];_0x30dd0b['cat_brand'][_0x1820e5(0x1d8)](_0x2134ad);}const _0x3b1374=await product[_0x1820e5(0xf9)]([{'$group':{'_id':{'category':_0x1820e5(0x10e)},'products':{'$push':{'brand':'$brand','product_code':_0x1820e5(0xdc),'product_name':_0x1820e5(0x1a8)}}}},{'$sort':{'_id.category':-0x1}}]),_0x124248=await product[_0x1820e5(0xf9)]([{'$group':{'_id':{'category':'$category','brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1f954b=await sales_sa[_0x1820e5(0xf9)]([{'$match':{'date':{'$gte':_0x183deb,'$lte':_0x3ccc6c},'sales_staff_id':_0x1afc0b,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x1820e5(0x18f)}},{'$lookup':{'from':'products','localField':_0x1820e5(0x22d),'foreignField':_0x1820e5(0x138),'as':'product_info'}},{'$unwind':_0x1820e5(0x206)},{'$group':{'_id':{'dsi':_0x1820e5(0x120),'date':_0x1820e5(0x15f),'customer':_0x1820e5(0x1e8)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x1820e5(0x11e),'NetPrice':_0x1820e5(0x18e),'discount':_0x1820e5(0x1fc),'adj_discount':_0x1820e5(0x1ad),'product_details':{'prod_name':_0x1820e5(0x127),'product_code':_0x1820e5(0x1b2),'category':_0x1820e5(0x217),'brand':_0x1820e5(0xfc),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x1820e5(0xf1)},{'$group':{'_id':{'dsi':_0x1820e5(0x209),'date':_0x1820e5(0x205),'customer':_0x1820e5(0x131),'category':_0x1820e5(0x19e),'brand':_0x1820e5(0x11d)},'totalQty':{'$sum':_0x1820e5(0x13e)},'totalGross':{'$sum':{'$multiply':[_0x1820e5(0x13e),_0x1820e5(0xd1)]}},'NetPrice':{'$sum':_0x1820e5(0x178)},'discount':{'$sum':_0x1820e5(0x1da)},'adj_discount':{'$sum':_0x1820e5(0x1fb)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x1820e5(0x131)},'totalQty':{'$sum':_0x1820e5(0x17e)},'totalGross':{'$sum':_0x1820e5(0x106)},'NetPrice':{'$sum':_0x1820e5(0x23f)},'discount':{'$sum':_0x1820e5(0xf3)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x1820e5(0x17e),'category':'$_id.category','brand':_0x1820e5(0x1a1),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x205b72=[],_0x32d7d4={},_0x567a19={},_0x5b2460={};var _0x433ba2=0x0,_0xca12e3=0x0,_0x1ebaf6=0x0,_0x43a2ba=0x0,_0x220e8e=0x0;const _0x137566=0x6;for(let _0x5b2273=0x0;_0x5b2273<=_0x1f954b[_0x1820e5(0x1d7)]-0x1;_0x5b2273++){const _0x58510c=_0x1f954b[_0x5b2273];let _0x397999='<tr>';_0x397999+=_0x1820e5(0x112)+_0x58510c[_0x1820e5(0x1ff)][_0x1820e5(0x13a)]+'</td>',_0x397999+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x58510c[_0x1820e5(0x1ff)][_0x1820e5(0x164)]+'</td>',_0x397999+=_0x1820e5(0x112)+_0x58510c[_0x1820e5(0x1ff)][_0x1820e5(0x1b4)]+'</td>';let _0x5d2105={};var _0x3e812b=0x0;for(let _0x2cde23=0x0;_0x2cde23<=_0x58510c[_0x1820e5(0x14f)]['length']-0x1;_0x2cde23++){const _0x3f4b39=_0x58510c[_0x1820e5(0x14f)][_0x2cde23];_0x5d2105[_0x3f4b39[_0x1820e5(0x190)]+'-'+_0x3f4b39[_0x1820e5(0x216)]]=_0x3f4b39[_0x1820e5(0x143)];const _0xe29ea7=_0x3f4b39[_0x1820e5(0x190)]+'-'+_0x3f4b39[_0x1820e5(0x216)];!_0x32d7d4[_0xe29ea7]&&(_0x32d7d4[_0xe29ea7]=0x0),!Array[_0x1820e5(0x1d5)](_0x5b2460[_0xe29ea7])&&(_0x5b2460[_0xe29ea7]=[]),!Array[_0x1820e5(0x1d5)](_0x5b2460[_0xe29ea7])&&(_0x5b2460[_0xe29ea7]=[]),_0x32d7d4[_0xe29ea7]+=_0x3f4b39[_0x1820e5(0x143)],_0x5b2460[_0xe29ea7][_0x1820e5(0x1d8)](_0x3f4b39[_0x1820e5(0x143)]),_0x3e812b++;}console[_0x1820e5(0x22c)](_0x58510c);for(let _0x8f52cb=0x0;_0x8f52cb<=_0x30dd0b[_0x1820e5(0xb9)][_0x1820e5(0x1d7)]-0x1;_0x8f52cb++){const _0x59d202=_0x30dd0b[_0x1820e5(0xb9)][_0x8f52cb],_0x11f037=_0x59d202['_id']['brand']+'-'+_0x59d202[_0x1820e5(0x1ff)][_0x1820e5(0x216)];_0x397999+=_0x1820e5(0x20f)+(_0x5d2105[_0x11f037]!==undefined?_0x5d2105[_0x11f037][_0x1820e5(0xc7)](0x2):'')+_0x1820e5(0x197);}_0x1ebaf6=_0x58510c[_0x1820e5(0x137)]+_0x58510c[_0x1820e5(0x18a)],_0x397999+=_0x1820e5(0x238)+formatNumber(parseFloat(_0x58510c[_0x1820e5(0xdd)],0x2)[_0x1820e5(0xc7)](0x2))+_0x1820e5(0x197),_0x397999+=_0x1820e5(0x238)+formatNumber(_0x58510c[_0x1820e5(0x123)][_0x1820e5(0xc7)](0x2))+_0x1820e5(0x197),_0x397999+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x1ebaf6)+'</td>',_0x397999+=_0x1820e5(0x238)+formatNumber(_0x58510c[_0x1820e5(0xdf)][_0x1820e5(0xc7)](0x2))+'</td>',_0x397999+=_0x1820e5(0x132),_0x433ba2+=parseFloat(_0x58510c[_0x1820e5(0xdd)][_0x1820e5(0xc7)](0x2)),_0xca12e3+=parseFloat(_0x58510c[_0x1820e5(0xdf)][_0x1820e5(0xc7)](0x2)),_0x43a2ba+=_0x1ebaf6,_0x220e8e+=parseFloat(_0x58510c[_0x1820e5(0x123)][_0x1820e5(0xc7)](0x2));if(_0x5b2273==_0x1f954b[_0x1820e5(0x1d7)]-0x1){_0x397999+=_0x1820e5(0x21a),_0x397999+=_0x1820e5(0x11c),_0x397999+=_0x1820e5(0x197);for(let _0x4e595b=0x0;_0x4e595b<=_0x30dd0b[_0x1820e5(0xb9)][_0x1820e5(0x1d7)]-0x1;_0x4e595b++){const _0x265745=_0x30dd0b[_0x1820e5(0xb9)][_0x4e595b],_0x28ab3f=_0x265745[_0x1820e5(0x1ff)][_0x1820e5(0x190)]+'-'+_0x265745[_0x1820e5(0x1ff)]['category'],_0x4282e7=_0x5b2460[_0x28ab3f]['reduce']((_0x1ba4c0,_0x54c79e)=>_0x1ba4c0+_0x54c79e,0x0);console[_0x1820e5(0x22c)]('test',_0x28ab3f),_0x397999+=_0x1820e5(0xdb)+(_0x4282e7!==undefined?formatNumber(_0x4282e7['toFixed'](0x2)):'')+_0x1820e5(0xf5),console[_0x1820e5(0x22c)](_0x5b2460[_0x28ab3f][_0x1820e5(0x21f)]((_0x54211d,_0x588934)=>_0x54211d+_0x588934,0x0));}_0x397999+=_0x1820e5(0x1f4)+formatNumber(_0x433ba2[_0x1820e5(0xc7)](0x2))+_0x1820e5(0xf5),_0x397999+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x220e8e)+_0x1820e5(0xf5),_0x397999+=_0x1820e5(0x1f4)+formatNumber(_0x43a2ba)+_0x1820e5(0xf5),_0x397999+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xca12e3)+_0x1820e5(0xf5),_0x397999+=_0x1820e5(0x132);}_0x205b72[_0x1820e5(0x1d8)](_0x397999);}function _0xd0a4da(_0x5190ed,_0xd97bc9){const _0x4b06c3=_0x1820e5,_0x20d2f0=[];for(let _0x1093ff=0x0;_0x1093ff<=_0x5190ed[_0x4b06c3(0x1d7)]-0x1;_0x1093ff+=_0xd97bc9){_0x20d2f0['push'](_0x5190ed[_0x4b06c3(0x17f)](_0x1093ff,_0x1093ff+_0xd97bc9));}return _0x20d2f0;}const _0x28004b=_0xd0a4da(_0x205b72,_0x137566);let _0x30d759='';return _0x28004b[_0x1820e5(0x1a4)]((_0x55a32e,_0x40076b)=>{const _0x5c74ee=_0x1820e5;_0x40076b>0x0&&(_0x30d759+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x30d759+=_0x5c74ee(0x20c),_0x30d759+=_0x5c74ee(0x16d),_0x30d759+=_0x5c74ee(0x21a),_0x30d759+=_0x5c74ee(0x171),_0x30d759+=_0x5c74ee(0x132),_0x30d759+=_0x5c74ee(0x21a),_0x30d759+=_0x5c74ee(0xb7);for(let _0x1ad83b=0x0;_0x1ad83b<=_0x3b1374[_0x5c74ee(0x1d7)]-0x1;_0x1ad83b++){const _0x4b47e1=_0x3b1374[_0x1ad83b];for(let _0x5dfecd=0x0;_0x5dfecd<_0x124248[_0x5c74ee(0x1d7)];_0x5dfecd++){const _0x386064=_0x124248[_0x5dfecd];_0x386064[_0x5c74ee(0x1ff)]===_0x4b47e1[_0x5c74ee(0x1ff)]['category']&&(_0x30d759+=_0x5c74ee(0x157)+_0x386064[_0x5c74ee(0x245)]+'\x22\x20class=\x22cat_data\x22>'+_0x4b47e1[_0x5c74ee(0x1ff)][_0x5c74ee(0x216)]+'</td>');}}_0x30d759+=_0x5c74ee(0xd7),_0x30d759+=_0x5c74ee(0x132),_0x30d759+='<tr>',_0x30d759+=_0x5c74ee(0xbd),_0x30d759+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x30d759+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x52a734=0x0;_0x52a734<=_0x3b1374[_0x5c74ee(0x1d7)]-0x1;_0x52a734++){const _0x18eacb=_0x3b1374[_0x52a734];for(let _0x37a765=0x0;_0x37a765<_0x30dd0b[_0x5c74ee(0xb9)][_0x5c74ee(0x1d7)];_0x37a765++){const _0xb21995=_0x30dd0b[_0x5c74ee(0xb9)][_0x37a765];_0xb21995['_id'][_0x5c74ee(0x216)]===_0x18eacb['_id'][_0x5c74ee(0x216)]&&(_0x30d759+='<td\x20class=\x22cat_data\x22>'+_0xb21995['_id'][_0x5c74ee(0x190)]+'</td>');}}_0x30d759+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x30d759+=_0x5c74ee(0x189),_0x30d759+=_0x5c74ee(0x223),_0x30d759+=_0x5c74ee(0x242),_0x30d759+=_0x5c74ee(0x132),_0x30d759+='</thead>',_0x30d759+=_0x5c74ee(0x14d),_0x55a32e['forEach'](_0x5b7f6a=>{_0x30d759+=_0x5b7f6a;}),console[_0x5c74ee(0x22c)](_0x5b2460),_0x30d759+=_0x5c74ee(0x146),_0x30d759+=_0x5c74ee(0x1b0);}),_0x30d759;}async function agentsdataDSICheck_admin_excel(_0x43a7c7,_0x4e1bd8,_0x2f8f9b,_0x1e0335){const _0x4d2485=a0_0x4019cd,_0x2cd65f=await product['aggregate']([{'$group':{'_id':{'brand':_0x4d2485(0x23b),'category':_0x4d2485(0x10e)},'products':{'$push':{'name':_0x4d2485(0x1a8),'product_code':_0x4d2485(0xdc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x105c7b=[];_0x105c7b[_0x4d2485(0xb9)]=[];for(let _0x11c8a9=0x0;_0x11c8a9<=_0x2cd65f[_0x4d2485(0x1d7)]-0x1;_0x11c8a9++){const _0x10f476=_0x2cd65f[_0x11c8a9];_0x105c7b['cat_brand']['push'](_0x10f476);}const _0x5dbfa9=await product['aggregate']([{'$group':{'_id':{'category':_0x4d2485(0x10e)},'products':{'$push':{'brand':_0x4d2485(0x23b),'product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x2c2efe=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0x4d2485(0x23b)}}},{'$group':{'_id':_0x4d2485(0x1ca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4b9720=await sales_sa[_0x4d2485(0xf9)]([{'$match':{'date':{'$gte':_0x43a7c7,'$lte':_0x4e1bd8},'sales_staff_id':_0x2f8f9b,'sale_product.isFG':_0x4d2485(0x18f)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x4d2485(0x14f),'localField':'sale_product.product_code','foreignField':'product_code','as':_0x4d2485(0xbb)}},{'$unwind':_0x4d2485(0x206)},{'$group':{'_id':{'dsi':_0x4d2485(0x120),'date':'$date','customer':_0x4d2485(0x1e8)},'totalQty':{'$sum':_0x4d2485(0x11e)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x4d2485(0x18e),'discount':'$sale_product.discount','adj_discount':_0x4d2485(0x1ad),'product_details':{'prod_name':'$product_info.name','product_code':_0x4d2485(0x1b2),'category':_0x4d2485(0x217),'brand':_0x4d2485(0xfc),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x4d2485(0xf1)},{'$group':{'_id':{'dsi':_0x4d2485(0x209),'date':_0x4d2485(0x205),'customer':_0x4d2485(0x131),'category':_0x4d2485(0x19e),'brand':_0x4d2485(0x11d)},'totalQty':{'$sum':_0x4d2485(0x13e)},'totalGross':{'$sum':{'$multiply':[_0x4d2485(0x13e),_0x4d2485(0xd1)]}},'NetPrice':{'$sum':_0x4d2485(0x178)},'discount':{'$sum':_0x4d2485(0x1da)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x4d2485(0x12d)}}},{'$group':{'_id':{'dsi':_0x4d2485(0x209),'date':'$_id.date','customer':_0x4d2485(0x131)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x4d2485(0xf3)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x4d2485(0x17e),'category':_0x4d2485(0x1ca),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x3b300a=[],_0x9ce599={},_0x5d6519={},_0x124241={};var _0x266b77=0x0,_0x391613=0x0,_0x566105=0x0,_0x12e69f=0x0,_0x582758=0x0;const _0x228d55=0x16345785d8a0000;for(let _0x1c3088=0x0;_0x1c3088<=_0x4b9720['length']-0x1;_0x1c3088++){const _0x210c9a=_0x4b9720[_0x1c3088];let _0xea671d='<tr>';_0xea671d+=_0x4d2485(0x112)+_0x210c9a['_id']['dsi']+_0x4d2485(0x197),_0xea671d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x210c9a[_0x4d2485(0x1ff)][_0x4d2485(0x164)]+_0x4d2485(0x197),_0xea671d+=_0x4d2485(0x112)+_0x210c9a['_id'][_0x4d2485(0x1b4)]+_0x4d2485(0x197);let _0x4c08c5={};var _0x1c1d7c=0x0;for(let _0xd73dc9=0x0;_0xd73dc9<=_0x210c9a[_0x4d2485(0x14f)][_0x4d2485(0x1d7)]-0x1;_0xd73dc9++){const _0xe266fd=_0x210c9a[_0x4d2485(0x14f)][_0xd73dc9];_0x4c08c5[_0xe266fd['brand']+'-'+_0xe266fd[_0x4d2485(0x216)]]=_0xe266fd[_0x4d2485(0x143)];const _0x20f93f=_0xe266fd['brand']+'-'+_0xe266fd[_0x4d2485(0x216)];!_0x9ce599[_0x20f93f]&&(_0x9ce599[_0x20f93f]=0x0),!Array[_0x4d2485(0x1d5)](_0x124241[_0x20f93f])&&(_0x124241[_0x20f93f]=[]),!Array[_0x4d2485(0x1d5)](_0x124241[_0x20f93f])&&(_0x124241[_0x20f93f]=[]),_0x9ce599[_0x20f93f]+=_0xe266fd[_0x4d2485(0x143)],_0x124241[_0x20f93f]['push'](_0xe266fd[_0x4d2485(0x143)]),_0x1c1d7c++;}console[_0x4d2485(0x22c)](_0x210c9a);for(let _0x3e0c63=0x0;_0x3e0c63<=_0x105c7b[_0x4d2485(0xb9)]['length']-0x1;_0x3e0c63++){const _0x36c664=_0x105c7b['cat_brand'][_0x3e0c63],_0x298c52=_0x36c664[_0x4d2485(0x1ff)][_0x4d2485(0x190)]+'-'+_0x36c664['_id'][_0x4d2485(0x216)];_0xea671d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x4c08c5[_0x298c52]!==undefined?_0x4c08c5[_0x298c52][_0x4d2485(0xc7)](0x2):'')+_0x4d2485(0x197);}_0x566105=_0x210c9a[_0x4d2485(0x137)]+_0x210c9a[_0x4d2485(0x18a)],_0xea671d+=_0x4d2485(0x238)+formatNumber(parseFloat(_0x210c9a[_0x4d2485(0xdd)],0x2)[_0x4d2485(0xc7)](0x2))+_0x4d2485(0x197),_0xea671d+=_0x4d2485(0x238)+formatNumber(_0x210c9a[_0x4d2485(0x123)][_0x4d2485(0xc7)](0x2))+_0x4d2485(0x197),_0xea671d+=_0x4d2485(0x238)+formatNumber(_0x566105)+'</td>',_0xea671d+=_0x4d2485(0x238)+formatNumber(_0x210c9a[_0x4d2485(0xdf)][_0x4d2485(0xc7)](0x2))+'</td>',_0xea671d+='</tr>',_0x266b77+=parseFloat(_0x210c9a[_0x4d2485(0xdd)]['toFixed'](0x2)),_0x391613+=parseFloat(_0x210c9a[_0x4d2485(0xdf)][_0x4d2485(0xc7)](0x2)),_0x12e69f+=_0x566105,_0x582758+=parseFloat(_0x210c9a['totalGross'][_0x4d2485(0xc7)](0x2));if(_0x1c3088==_0x4b9720['length']-0x1){_0xea671d+=_0x4d2485(0x21a),_0xea671d+=_0x4d2485(0x11c),_0xea671d+='</td>';for(let _0x1fc7ab=0x0;_0x1fc7ab<=_0x105c7b[_0x4d2485(0xb9)][_0x4d2485(0x1d7)]-0x1;_0x1fc7ab++){const _0xa4e826=_0x105c7b[_0x4d2485(0xb9)][_0x1fc7ab],_0x221fda=_0xa4e826[_0x4d2485(0x1ff)][_0x4d2485(0x190)]+'-'+_0xa4e826[_0x4d2485(0x1ff)]['category'],_0x571528=_0x124241[_0x221fda][_0x4d2485(0x21f)]((_0x14c995,_0x282497)=>_0x14c995+_0x282497,0x0);console['log']('test',_0x221fda),_0xea671d+=_0x4d2485(0xdb)+(_0x571528!==undefined?formatNumber(_0x571528[_0x4d2485(0xc7)](0x2)):'')+_0x4d2485(0xf5),console[_0x4d2485(0x22c)](_0x124241[_0x221fda][_0x4d2485(0x21f)]((_0x18dd21,_0x22411a)=>_0x18dd21+_0x22411a,0x0));}_0xea671d+=_0x4d2485(0x1f4)+formatNumber(_0x266b77[_0x4d2485(0xc7)](0x2))+_0x4d2485(0xf5),_0xea671d+=_0x4d2485(0x1f4)+formatNumber(_0x582758)+_0x4d2485(0xf5),_0xea671d+=_0x4d2485(0x1f4)+formatNumber(_0x12e69f)+_0x4d2485(0xf5),_0xea671d+=_0x4d2485(0x1f4)+formatNumber(_0x391613)+_0x4d2485(0xf5),_0xea671d+=_0x4d2485(0x132);}_0x3b300a[_0x4d2485(0x1d8)](_0xea671d);}function _0x356f47(_0x31e765,_0x6c4416){const _0x5378c1=_0x4d2485,_0x445f20=[];for(let _0x526000=0x0;_0x526000<=_0x31e765[_0x5378c1(0x1d7)]-0x1;_0x526000+=_0x6c4416){_0x445f20[_0x5378c1(0x1d8)](_0x31e765[_0x5378c1(0x17f)](_0x526000,_0x526000+_0x6c4416));}return _0x445f20;}const _0x29ee38=_0x356f47(_0x3b300a,_0x228d55);let _0x2db1eb='';return _0x29ee38['forEach']((_0x261d17,_0x2b3c97)=>{const _0x5c92f0=_0x4d2485;_0x2b3c97>0x0&&(_0x2db1eb+=_0x5c92f0(0x108));_0x2db1eb+=_0x5c92f0(0x20c),_0x2db1eb+=_0x5c92f0(0x16d),_0x2db1eb+='<tr>',_0x2db1eb+=_0x5c92f0(0x171),_0x2db1eb+=_0x5c92f0(0x132),_0x2db1eb+=_0x5c92f0(0x21a),_0x2db1eb+=_0x5c92f0(0xb7);for(let _0x4ba48f=0x0;_0x4ba48f<=_0x5dbfa9[_0x5c92f0(0x1d7)]-0x1;_0x4ba48f++){const _0x5bbad2=_0x5dbfa9[_0x4ba48f];for(let _0xd434f9=0x0;_0xd434f9<_0x2c2efe['length'];_0xd434f9++){const _0xda5c4e=_0x2c2efe[_0xd434f9];_0xda5c4e[_0x5c92f0(0x1ff)]===_0x5bbad2[_0x5c92f0(0x1ff)][_0x5c92f0(0x216)]&&(_0x2db1eb+=_0x5c92f0(0x157)+_0xda5c4e[_0x5c92f0(0x245)]+_0x5c92f0(0x1a9)+_0x5bbad2['_id'][_0x5c92f0(0x216)]+_0x5c92f0(0x197));}}_0x2db1eb+=_0x5c92f0(0xd7),_0x2db1eb+=_0x5c92f0(0x132),_0x2db1eb+='<tr>',_0x2db1eb+=_0x5c92f0(0xbd),_0x2db1eb+=_0x5c92f0(0x231),_0x2db1eb+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x246808=0x0;_0x246808<=_0x5dbfa9['length']-0x1;_0x246808++){const _0x34f40e=_0x5dbfa9[_0x246808];for(let _0x492bd1=0x0;_0x492bd1<_0x105c7b[_0x5c92f0(0xb9)][_0x5c92f0(0x1d7)];_0x492bd1++){const _0x34ae57=_0x105c7b[_0x5c92f0(0xb9)][_0x492bd1];_0x34ae57[_0x5c92f0(0x1ff)][_0x5c92f0(0x216)]===_0x34f40e[_0x5c92f0(0x1ff)]['category']&&(_0x2db1eb+=_0x5c92f0(0x177)+_0x34ae57[_0x5c92f0(0x1ff)][_0x5c92f0(0x190)]+_0x5c92f0(0x197));}}_0x2db1eb+=_0x5c92f0(0x202),_0x2db1eb+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x2db1eb+=_0x5c92f0(0x223),_0x2db1eb+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x2db1eb+=_0x5c92f0(0x132),_0x2db1eb+=_0x5c92f0(0x186),_0x2db1eb+=_0x5c92f0(0x14d),_0x261d17['forEach'](_0x23ed39=>{_0x2db1eb+=_0x23ed39;}),console['log'](_0x124241),_0x2db1eb+=_0x5c92f0(0x146),_0x2db1eb+=_0x5c92f0(0x1b0);}),_0x2db1eb;}router[a0_0x4019cd(0x228)]('/agent_reports/pdf_admin',auth,async(_0x4a7f01,_0x22610c)=>{const _0x2a0980=a0_0x4019cd,{from_date:_0x148b70,to_date:_0x1d68ad,isExcel:_0x2c0e1c,agent_id:_0x5c6c2e}=_0x4a7f01[_0x2a0980(0x15b)],_0x30447c=_0x4a7f01[_0x2a0980(0x10f)],_0x2effb0=await staff['findOne']({'email':_0x30447c['email']}),_0x26de03=await master_shop[_0x2a0980(0x15a)](),_0x4753f4=await agentsdataDSICheck_admin(_0x148b70,_0x1d68ad,_0x5c6c2e,_0x2c0e1c),_0x165b65=await agentsdataDSICheck_admin_excel(_0x148b70,_0x1d68ad,_0x5c6c2e,_0x2c0e1c);let _0x24126a='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x407a46=new Date(_0x148b70),_0x3a258d=new Date(_0x1d68ad);const _0x10e1f8={'year':_0x2a0980(0x182),'month':_0x2a0980(0x1d4),'day':'numeric'},_0x43c43e=new Intl[(_0x2a0980(0x17d))](_0x2a0980(0x1cb),_0x10e1f8)[_0x2a0980(0x119)](_0x407a46),_0x391520=new Intl[(_0x2a0980(0x17d))](_0x2a0980(0x1cb),_0x10e1f8)[_0x2a0980(0x119)](_0x3a258d);_0x24126a+=_0x2a0980(0x166),_0x24126a+=_0x2a0980(0x1f8),_0x24126a+=_0x2a0980(0x20c),_0x24126a+=_0x4753f4,_0x24126a+=_0x2a0980(0x1b0),_0x24126a+=_0x2a0980(0x1ec),_0x24126a+='</div>';let _0x5e03e9=_0x2a0980(0x1c8);_0x5e03e9+=_0x2a0980(0x166),_0x5e03e9+=_0x2a0980(0x1f8),_0x5e03e9+=_0x2a0980(0x20c),_0x5e03e9+=_0x165b65,_0x5e03e9+=_0x2a0980(0x1b0),_0x5e03e9+=_0x2a0980(0x1ec),_0x5e03e9+=_0x2a0980(0x1ec);let _0x27fe3f=_0x2a0980(0xe5);const _0x9f9bb3={'width':_0x2a0980(0x1bf),'height':_0x2a0980(0x19f),'orientation':_0x2a0980(0x1e6),'border':{'top':'0.1in','right':_0x2a0980(0x210),'bottom':_0x2a0980(0x210),'left':'0.1in'},'header':{'height':_0x2a0980(0x135),'contents':_0x2a0980(0x1fa)+_0x27fe3f+_0x2a0980(0x1c2)+_0x43c43e+_0x2a0980(0x1e7)+_0x391520+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x2a0980(0x1f5),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x2c0e1c=='on'){const _0x43689e=cheerio[_0x2a0980(0xd8)](_0x5e03e9);let _0x1ea1ea=[],_0x25f80b=[],_0x347bca=[];_0x43689e(_0x2a0980(0x109))[_0x2a0980(0xda)]((_0x220512,_0x33fca5)=>{const _0x23e980=_0x2a0980;let _0x2ceff6=[],_0x5d9109=0x0;while(_0x347bca[_0x5d9109]){_0x347bca[_0x5d9109]--,_0x5d9109++;}_0x43689e(_0x33fca5)[_0x23e980(0x15a)](_0x23e980(0x170))[_0x23e980(0xda)]((_0x585836,_0x1d50e0)=>{const _0x42e05d=_0x23e980;let _0x496913=_0x43689e(_0x1d50e0)[_0x42e05d(0x227)]()[_0x42e05d(0xca)](),_0x1e0fcd=parseFloat(_0x496913[_0x42e05d(0x101)](/,/g,''));isNaN(_0x1e0fcd)&&(_0x1e0fcd=_0x496913);let _0x136bed=parseInt(_0x43689e(_0x1d50e0)[_0x42e05d(0xbe)](_0x42e05d(0x22e)))||0x1,_0x5de13b=parseInt(_0x43689e(_0x1d50e0)[_0x42e05d(0xbe)](_0x42e05d(0x15e)))||0x1;_0x2ceff6[_0x5d9109]=_0x1e0fcd;(_0x136bed>0x1||_0x5de13b>0x1)&&_0x25f80b[_0x42e05d(0x1d8)]({'s':{'r':_0x220512,'c':_0x5d9109},'e':{'r':_0x220512+_0x5de13b-0x1,'c':_0x5d9109+_0x136bed-0x1}});for(let _0x56baf7=0x0;_0x56baf7<_0x136bed;_0x56baf7++){_0x5de13b>0x1&&(_0x347bca[_0x5d9109+_0x56baf7]=_0x5de13b-0x1);}_0x5d9109+=_0x136bed;}),_0x1ea1ea['push'](_0x2ceff6);});const _0x9370e6=XLSX[_0x2a0980(0x13b)]['book_new'](),_0x3fb324=XLSX[_0x2a0980(0x13b)][_0x2a0980(0x12f)](_0x1ea1ea);_0x25f80b[_0x2a0980(0x1d7)]>0x0&&(_0x3fb324[_0x2a0980(0xcf)]=_0x25f80b);_0x3fb324['!cols']=_0x1ea1ea[0x0][_0x2a0980(0x173)](()=>({'wpx':0x64})),XLSX[_0x2a0980(0x13b)]['book_append_sheet'](_0x9370e6,_0x3fb324,'Sales\x20Report');const _0x4b4f47=XLSX[_0x2a0980(0xd2)](_0x9370e6,{'bookType':'xlsx','type':_0x2a0980(0x174)});_0x22610c[_0x2a0980(0x103)](_0x2a0980(0x1b1),_0x2a0980(0x1b3)),_0x22610c[_0x2a0980(0x103)](_0x2a0980(0x162),_0x2a0980(0x102)),_0x22610c[_0x2a0980(0xed)](_0x4b4f47);}else pdf[_0x2a0980(0x1eb)](_0x24126a,_0x9f9bb3)['toStream'](function(_0x1a8b75,_0x5257a1){const _0x3c1c40=_0x2a0980;if(_0x1a8b75){_0x22610c['status'](0x1f4)[_0x3c1c40(0xed)]('Error\x20generating\x20PDF');return;}_0x22610c[_0x3c1c40(0x103)](_0x3c1c40(0x162),'application/pdf'),_0x5257a1['pipe'](_0x22610c);});}),router[a0_0x4019cd(0x107)](a0_0x4019cd(0x198),auth,async(_0x30874e,_0x2b0fd6)=>{const _0x949a14=a0_0x4019cd;try{const {username:_0x2124b8,email:_0x361c5a,role:_0x4674d3}=_0x30874e[_0x949a14(0x10f)],_0x20fb36=_0x30874e[_0x949a14(0x10f)],_0x185d4a=await profile[_0x949a14(0x163)]({'email':_0x20fb36['email']}),_0x355888={'year':_0x949a14(0x182),'month':_0x949a14(0x1d4),'day':_0x949a14(0x182)},_0x2dc5b5=await master_shop[_0x949a14(0x15a)](),_0x5d8c76=await staff[_0x949a14(0x163)]({'email':_0x20fb36[_0x949a14(0x1ee)]}),_0x114cf7=await product['find'](),_0x22bfbd=await warehouse['aggregate']([{'$unwind':_0x949a14(0xde)},{'$lookup':{'from':_0x949a14(0x14f),'localField':_0x949a14(0x20e),'foreignField':_0x949a14(0x21c),'as':_0x949a14(0x1de)}},{'$unwind':_0x949a14(0x1c9)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);if(_0x2dc5b5[0x0][_0x949a14(0x139)]=='English\x20(US)')var _0x5bf546=users[_0x949a14(0x196)];else{if(_0x2dc5b5[0x0][_0x949a14(0x139)]==_0x949a14(0xe1))var _0x5bf546=users[_0x949a14(0xe1)];else{if(_0x2dc5b5[0x0][_0x949a14(0x139)]=='German')var _0x5bf546=users[_0x949a14(0xc0)];else{if(_0x2dc5b5[0x0][_0x949a14(0x139)]==_0x949a14(0x20d))var _0x5bf546=users['Spanish'];else{if(_0x2dc5b5[0x0]['language']=='French')var _0x5bf546=users[_0x949a14(0x152)];else{if(_0x2dc5b5[0x0][_0x949a14(0x139)]=='Portuguese\x20(BR)')var _0x5bf546=users[_0x949a14(0x22b)];else{if(_0x2dc5b5[0x0][_0x949a14(0x139)]==_0x949a14(0x23a))var _0x5bf546=users['Chinese'];else{if(_0x2dc5b5[0x0][_0x949a14(0x139)]==_0x949a14(0x133))var _0x5bf546=users[_0x949a14(0xf6)];}}}}}}}_0x2b0fd6[_0x949a14(0x18b)](_0x949a14(0x213),{'success':_0x30874e[_0x949a14(0xce)]('success'),'errors':_0x30874e['flash']('errors'),'alldata':_0x114cf7,'profile':_0x185d4a,'master_shop':_0x2dc5b5,'role':_0x20fb36,'product_stock':_0x22bfbd,'language':_0x5bf546,'staff_arr':_0x5d8c76});}catch(_0x2645ed){}});function formatNumber(_0x2f5b39,_0x55d8d6=a0_0x4019cd(0x1cb),_0x1b685f={'minimumFractionDigits':0x2}){const _0x5831a3=new Intl['NumberFormat'](_0x55d8d6,_0x1b685f);return _0x5831a3['format'](_0x2f5b39);}async function agentsdataDSICheck(_0x23ed96,_0x339a23,_0x566909,_0x1da901){const _0xfefb67=a0_0x4019cd,_0x4046e4=await product[_0xfefb67(0xf9)]([{'$group':{'_id':{'brand':'$brand','category':_0xfefb67(0x10e)},'products':{'$push':{'name':_0xfefb67(0x1a8),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x76fd95=[];_0x76fd95[_0xfefb67(0xb9)]=[];for(let _0x2359c7=0x0;_0x2359c7<=_0x4046e4[_0xfefb67(0x1d7)]-0x1;_0x2359c7++){const _0x2e90e7=_0x4046e4[_0x2359c7];_0x76fd95[_0xfefb67(0xb9)][_0xfefb67(0x1d8)](_0x2e90e7);}const _0x4fa1cc=await product[_0xfefb67(0xf9)]([{'$group':{'_id':{'category':_0xfefb67(0x10e)},'products':{'$push':{'brand':_0xfefb67(0x23b),'product_code':_0xfefb67(0xdc),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x212fe6=await product[_0xfefb67(0xf9)]([{'$group':{'_id':{'category':_0xfefb67(0x10e),'brand':_0xfefb67(0x23b)}}},{'$group':{'_id':_0xfefb67(0x1ca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5aec43=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x23ed96,'$lte':_0x339a23},'sales_staff_id':_0x566909,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0xfefb67(0x18f)}},{'$lookup':{'from':_0xfefb67(0x14f),'localField':_0xfefb67(0x22d),'foreignField':_0xfefb67(0x138),'as':'product_info'}},{'$unwind':_0xfefb67(0x206)},{'$group':{'_id':{'dsi':'$dsi','date':_0xfefb67(0x15f),'customer':_0xfefb67(0x1e8)},'totalQty':{'$sum':_0xfefb67(0x11e)},'products':{'$push':{'qty':_0xfefb67(0x11e),'NetPrice':_0xfefb67(0x18e),'discount':_0xfefb67(0x1fc),'adj_discount':_0xfefb67(0x1ad),'product_details':{'prod_name':_0xfefb67(0x127),'product_code':'$product_info.product_code','category':'$product_info.category','brand':'$product_info.brand','gross_price':_0xfefb67(0x191)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0xfefb67(0x209),'date':_0xfefb67(0x205),'customer':_0xfefb67(0x131),'category':_0xfefb67(0x19e),'brand':_0xfefb67(0x11d)},'totalQty':{'$sum':_0xfefb67(0x13e)},'totalGross':{'$sum':{'$multiply':[_0xfefb67(0x13e),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0xfefb67(0x178)},'discount':{'$sum':_0xfefb67(0x1da)},'adj_discount':{'$sum':_0xfefb67(0x1fb)},'product_details':{'$first':_0xfefb67(0x12d)}}},{'$group':{'_id':{'dsi':_0xfefb67(0x209),'date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':_0xfefb67(0x17e)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0xfefb67(0x23f)},'discount':{'$sum':_0xfefb67(0xf3)},'adj_discount':{'$sum':_0xfefb67(0x1b7)},'products':{'$push':{'qty':'$totalQty','category':_0xfefb67(0x1ca),'brand':_0xfefb67(0x1a1),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2c0ec6=[],_0x355bf8={},_0x408593={},_0x30732c={};var _0x466d3c=0x0,_0x22fde8=0x0,_0x127ed0=0x0,_0x391331=0x0,_0x3a29b9=0x0;const _0x4e27cb=0x6;for(let _0x64cdb3=0x0;_0x64cdb3<=_0x5aec43[_0xfefb67(0x1d7)]-0x1;_0x64cdb3++){const _0x2f7f02=_0x5aec43[_0x64cdb3];let _0x2206fa=_0xfefb67(0x21a);_0x2206fa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2f7f02[_0xfefb67(0x1ff)][_0xfefb67(0x13a)]+_0xfefb67(0x197),_0x2206fa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2f7f02[_0xfefb67(0x1ff)]['date']+_0xfefb67(0x197),_0x2206fa+=_0xfefb67(0x112)+_0x2f7f02['_id']['customer']+'</td>';let _0xd0dc2c={};var _0x1536ce=0x0;for(let _0x5e0c8e=0x0;_0x5e0c8e<=_0x2f7f02['products'][_0xfefb67(0x1d7)]-0x1;_0x5e0c8e++){const _0x1bcaeb=_0x2f7f02['products'][_0x5e0c8e];_0xd0dc2c[_0x1bcaeb[_0xfefb67(0x190)]+'-'+_0x1bcaeb[_0xfefb67(0x216)]]=_0x1bcaeb[_0xfefb67(0x143)];const _0x4306b5=_0x1bcaeb['brand']+'-'+_0x1bcaeb[_0xfefb67(0x216)];!_0x355bf8[_0x4306b5]&&(_0x355bf8[_0x4306b5]=0x0),!Array['isArray'](_0x30732c[_0x4306b5])&&(_0x30732c[_0x4306b5]=[]),!Array[_0xfefb67(0x1d5)](_0x30732c[_0x4306b5])&&(_0x30732c[_0x4306b5]=[]),_0x355bf8[_0x4306b5]+=_0x1bcaeb[_0xfefb67(0x143)],_0x30732c[_0x4306b5][_0xfefb67(0x1d8)](_0x1bcaeb[_0xfefb67(0x143)]),_0x1536ce++;}console['log'](_0x2f7f02);for(let _0x4ede8a=0x0;_0x4ede8a<=_0x76fd95[_0xfefb67(0xb9)][_0xfefb67(0x1d7)]-0x1;_0x4ede8a++){const _0x4e275a=_0x76fd95[_0xfefb67(0xb9)][_0x4ede8a],_0x592836=_0x4e275a[_0xfefb67(0x1ff)][_0xfefb67(0x190)]+'-'+_0x4e275a[_0xfefb67(0x1ff)]['category'];_0x2206fa+=_0xfefb67(0x20f)+(_0xd0dc2c[_0x592836]!==undefined?_0xd0dc2c[_0x592836][_0xfefb67(0xc7)](0x2):'')+_0xfefb67(0x197);}_0x127ed0=_0x2f7f02[_0xfefb67(0x137)]+_0x2f7f02[_0xfefb67(0x18a)],_0x2206fa+=_0xfefb67(0x238)+formatNumber(parseFloat(_0x2f7f02[_0xfefb67(0xdd)],0x2)['toFixed'](0x2))+_0xfefb67(0x197),_0x2206fa+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x2f7f02[_0xfefb67(0x123)][_0xfefb67(0xc7)](0x2))+'</td>',_0x2206fa+=_0xfefb67(0x238)+formatNumber(_0x127ed0)+_0xfefb67(0x197),_0x2206fa+=_0xfefb67(0x238)+formatNumber(_0x2f7f02['NetPrice'][_0xfefb67(0xc7)](0x2))+_0xfefb67(0x197),_0x2206fa+=_0xfefb67(0x132),_0x466d3c+=parseFloat(_0x2f7f02['totalQty'][_0xfefb67(0xc7)](0x2)),_0x22fde8+=parseFloat(_0x2f7f02[_0xfefb67(0xdf)][_0xfefb67(0xc7)](0x2)),_0x391331+=_0x127ed0,_0x3a29b9+=parseFloat(_0x2f7f02[_0xfefb67(0x123)][_0xfefb67(0xc7)](0x2));if(_0x64cdb3==_0x5aec43[_0xfefb67(0x1d7)]-0x1){_0x2206fa+='<tr>',_0x2206fa+=_0xfefb67(0x11c),_0x2206fa+=_0xfefb67(0x197);for(let _0x4d8e5b=0x0;_0x4d8e5b<=_0x76fd95['cat_brand'][_0xfefb67(0x1d7)]-0x1;_0x4d8e5b++){const _0x2b66d9=_0x76fd95[_0xfefb67(0xb9)][_0x4d8e5b],_0xb308a2=_0x2b66d9[_0xfefb67(0x1ff)][_0xfefb67(0x190)]+'-'+_0x2b66d9['_id'][_0xfefb67(0x216)],_0x190570=_0x30732c[_0xb308a2]['reduce']((_0x273d0f,_0x32b733)=>_0x273d0f+_0x32b733,0x0);_0x2206fa+=_0xfefb67(0xdb)+(_0x190570!==undefined?formatNumber(_0x190570[_0xfefb67(0xc7)](0x2)):'')+_0xfefb67(0xf5),console[_0xfefb67(0x22c)](_0x30732c[_0xb308a2][_0xfefb67(0x21f)]((_0x29c995,_0x46fed0)=>_0x29c995+_0x46fed0,0x0));}_0x2206fa+=_0xfefb67(0x1f4)+formatNumber(_0x466d3c['toFixed'](0x2))+_0xfefb67(0xf5),_0x2206fa+=_0xfefb67(0x1f4)+formatNumber(_0x3a29b9)+_0xfefb67(0xf5),_0x2206fa+=_0xfefb67(0x1f4)+formatNumber(_0x391331)+'</b></td>',_0x2206fa+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x22fde8)+_0xfefb67(0xf5),_0x2206fa+=_0xfefb67(0x132);}_0x2c0ec6[_0xfefb67(0x1d8)](_0x2206fa);}function _0x4726b6(_0x2632b3,_0x1c34fd){const _0x6410a8=_0xfefb67,_0xd20bf4=[];for(let _0x11dcce=0x0;_0x11dcce<=_0x2632b3['length']-0x1;_0x11dcce+=_0x1c34fd){_0xd20bf4[_0x6410a8(0x1d8)](_0x2632b3[_0x6410a8(0x17f)](_0x11dcce,_0x11dcce+_0x1c34fd));}return _0xd20bf4;}const _0x50fef1=_0x4726b6(_0x2c0ec6,_0x4e27cb);let _0x10ee69='';return _0x50fef1['forEach']((_0x369a4d,_0x13e755)=>{const _0x1a06fa=_0xfefb67;_0x13e755>0x0&&(_0x10ee69+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x10ee69+=_0x1a06fa(0x20c),_0x10ee69+=_0x1a06fa(0x16d),_0x10ee69+=_0x1a06fa(0x21a),_0x10ee69+=_0x1a06fa(0x171),_0x10ee69+=_0x1a06fa(0x132),_0x10ee69+='<tr>',_0x10ee69+=_0x1a06fa(0xb7);for(let _0x5822c3=0x0;_0x5822c3<=_0x4fa1cc[_0x1a06fa(0x1d7)]-0x1;_0x5822c3++){const _0x530592=_0x4fa1cc[_0x5822c3];for(let _0x81eb87=0x0;_0x81eb87<_0x212fe6[_0x1a06fa(0x1d7)];_0x81eb87++){const _0x3615d9=_0x212fe6[_0x81eb87];_0x3615d9[_0x1a06fa(0x1ff)]===_0x530592[_0x1a06fa(0x1ff)]['category']&&(_0x10ee69+=_0x1a06fa(0x157)+_0x3615d9[_0x1a06fa(0x245)]+'\x22\x20class=\x22cat_data\x22>'+_0x530592[_0x1a06fa(0x1ff)]['category']+_0x1a06fa(0x197));}}_0x10ee69+=_0x1a06fa(0xd7),_0x10ee69+=_0x1a06fa(0x132),_0x10ee69+=_0x1a06fa(0x21a),_0x10ee69+=_0x1a06fa(0xbd),_0x10ee69+=_0x1a06fa(0x231),_0x10ee69+=_0x1a06fa(0xc8);for(let _0x17d8f2=0x0;_0x17d8f2<=_0x4fa1cc['length']-0x1;_0x17d8f2++){const _0x59e2ff=_0x4fa1cc[_0x17d8f2];for(let _0x52cc04=0x0;_0x52cc04<_0x76fd95[_0x1a06fa(0xb9)][_0x1a06fa(0x1d7)];_0x52cc04++){const _0x2b8bdc=_0x76fd95['cat_brand'][_0x52cc04];_0x2b8bdc['_id'][_0x1a06fa(0x216)]===_0x59e2ff[_0x1a06fa(0x1ff)][_0x1a06fa(0x216)]&&(_0x10ee69+='<td\x20class=\x22cat_data\x22>'+_0x2b8bdc[_0x1a06fa(0x1ff)][_0x1a06fa(0x190)]+'</td>');}}_0x10ee69+=_0x1a06fa(0x202),_0x10ee69+=_0x1a06fa(0x189),_0x10ee69+=_0x1a06fa(0x223),_0x10ee69+=_0x1a06fa(0x242),_0x10ee69+=_0x1a06fa(0x132),_0x10ee69+=_0x1a06fa(0x186),_0x10ee69+=_0x1a06fa(0x14d),_0x369a4d['forEach'](_0x1efa54=>{_0x10ee69+=_0x1efa54;}),console[_0x1a06fa(0x22c)](_0x30732c),_0x10ee69+='</tbody>',_0x10ee69+=_0x1a06fa(0x1b0);}),_0x10ee69;}async function agentsdataDSICheck_excel(_0x27c5e1,_0x35388c,_0x506a72,_0x4c6f27){const _0x5932f2=a0_0x4019cd,_0x1036a1=await product[_0x5932f2(0xf9)]([{'$group':{'_id':{'brand':_0x5932f2(0x23b),'category':'$category'},'products':{'$push':{'name':_0x5932f2(0x1a8),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x50e244=[];_0x50e244[_0x5932f2(0xb9)]=[];for(let _0x58f228=0x0;_0x58f228<=_0x1036a1[_0x5932f2(0x1d7)]-0x1;_0x58f228++){const _0x1c79b4=_0x1036a1[_0x58f228];_0x50e244[_0x5932f2(0xb9)][_0x5932f2(0x1d8)](_0x1c79b4);}const _0x33ee2d=await product[_0x5932f2(0xf9)]([{'$group':{'_id':{'category':_0x5932f2(0x10e)},'products':{'$push':{'brand':_0x5932f2(0x23b),'product_code':_0x5932f2(0xdc),'product_name':_0x5932f2(0x1a8)}}}},{'$sort':{'_id.category':-0x1}}]),_0x402340=await product[_0x5932f2(0xf9)]([{'$group':{'_id':{'category':_0x5932f2(0x10e),'brand':_0x5932f2(0x23b)}}},{'$group':{'_id':_0x5932f2(0x1ca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x55606b=await sales_sa[_0x5932f2(0xf9)]([{'$match':{'date':{'$gte':_0x27c5e1,'$lte':_0x35388c},'sales_staff_id':_0x506a72,'sale_product.isFG':_0x5932f2(0x18f)}},{'$unwind':_0x5932f2(0xc4)},{'$match':{'sale_product.isFG':_0x5932f2(0x18f)}},{'$lookup':{'from':'products','localField':_0x5932f2(0x22d),'foreignField':_0x5932f2(0x138),'as':'product_info'}},{'$unwind':_0x5932f2(0x206)},{'$group':{'_id':{'dsi':_0x5932f2(0x120),'date':_0x5932f2(0x15f),'customer':_0x5932f2(0x1e8)},'totalQty':{'$sum':_0x5932f2(0x11e)},'products':{'$push':{'qty':_0x5932f2(0x11e),'NetPrice':'$sale_product.totalprice','discount':_0x5932f2(0x1fc),'adj_discount':_0x5932f2(0x1ad),'product_details':{'prod_name':_0x5932f2(0x127),'product_code':_0x5932f2(0x1b2),'category':_0x5932f2(0x217),'brand':'$product_info.brand','gross_price':_0x5932f2(0x191)}}}}},{'$unwind':_0x5932f2(0xf1)},{'$group':{'_id':{'dsi':_0x5932f2(0x209),'date':_0x5932f2(0x205),'customer':_0x5932f2(0x131),'category':_0x5932f2(0x19e),'brand':_0x5932f2(0x11d)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x5932f2(0xd1)]}},'NetPrice':{'$sum':_0x5932f2(0x178)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x5932f2(0x12d)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x5932f2(0x131)},'totalQty':{'$sum':_0x5932f2(0x17e)},'totalGross':{'$sum':_0x5932f2(0x106)},'NetPrice':{'$sum':_0x5932f2(0x23f)},'discount':{'$sum':_0x5932f2(0xf3)},'adj_discount':{'$sum':_0x5932f2(0x1b7)},'products':{'$push':{'qty':'$totalQty','category':_0x5932f2(0x1ca),'brand':_0x5932f2(0x1a1),'product_details':_0x5932f2(0xde)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x20efe6=[],_0x399153={},_0x487104={},_0x1ee309={};var _0x226955=0x0,_0x5a448a=0x0,_0x4fadae=0x0,_0x46ac4d=0x0,_0x2f3a73=0x0;const _0x4c9c28=0x9184e72a000;for(let _0x6863a5=0x0;_0x6863a5<=_0x55606b[_0x5932f2(0x1d7)]-0x1;_0x6863a5++){const _0x28a108=_0x55606b[_0x6863a5];let _0x3bb8df='<tr>';_0x3bb8df+=_0x5932f2(0x112)+_0x28a108[_0x5932f2(0x1ff)][_0x5932f2(0x13a)]+'</td>',_0x3bb8df+=_0x5932f2(0x112)+_0x28a108[_0x5932f2(0x1ff)][_0x5932f2(0x164)]+_0x5932f2(0x197),_0x3bb8df+=_0x5932f2(0x112)+_0x28a108['_id'][_0x5932f2(0x1b4)]+_0x5932f2(0x197);let _0x34be41={};var _0x339776=0x0;for(let _0x4065e7=0x0;_0x4065e7<=_0x28a108[_0x5932f2(0x14f)][_0x5932f2(0x1d7)]-0x1;_0x4065e7++){const _0x50fcc0=_0x28a108['products'][_0x4065e7];_0x34be41[_0x50fcc0['brand']+'-'+_0x50fcc0[_0x5932f2(0x216)]]=_0x50fcc0[_0x5932f2(0x143)];const _0x28d8ab=_0x50fcc0[_0x5932f2(0x190)]+'-'+_0x50fcc0[_0x5932f2(0x216)];!_0x399153[_0x28d8ab]&&(_0x399153[_0x28d8ab]=0x0),!Array[_0x5932f2(0x1d5)](_0x1ee309[_0x28d8ab])&&(_0x1ee309[_0x28d8ab]=[]),!Array['isArray'](_0x1ee309[_0x28d8ab])&&(_0x1ee309[_0x28d8ab]=[]),_0x399153[_0x28d8ab]+=_0x50fcc0[_0x5932f2(0x143)],_0x1ee309[_0x28d8ab][_0x5932f2(0x1d8)](_0x50fcc0[_0x5932f2(0x143)]),_0x339776++;}console[_0x5932f2(0x22c)](_0x28a108);for(let _0x3fea09=0x0;_0x3fea09<=_0x50e244[_0x5932f2(0xb9)][_0x5932f2(0x1d7)]-0x1;_0x3fea09++){const _0x1b0d7d=_0x50e244[_0x5932f2(0xb9)][_0x3fea09],_0x510f75=_0x1b0d7d[_0x5932f2(0x1ff)][_0x5932f2(0x190)]+'-'+_0x1b0d7d[_0x5932f2(0x1ff)]['category'];_0x3bb8df+=_0x5932f2(0x20f)+(_0x34be41[_0x510f75]!==undefined?_0x34be41[_0x510f75][_0x5932f2(0xc7)](0x2):'')+_0x5932f2(0x197);}_0x4fadae=_0x28a108['discount']+_0x28a108[_0x5932f2(0x18a)],_0x3bb8df+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x28a108['totalQty'],0x2)[_0x5932f2(0xc7)](0x2))+_0x5932f2(0x197),_0x3bb8df+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x28a108['totalGross'][_0x5932f2(0xc7)](0x2))+_0x5932f2(0x197),_0x3bb8df+=_0x5932f2(0x238)+formatNumber(_0x4fadae)+_0x5932f2(0x197),_0x3bb8df+=_0x5932f2(0x238)+formatNumber(_0x28a108['NetPrice'][_0x5932f2(0xc7)](0x2))+_0x5932f2(0x197),_0x3bb8df+=_0x5932f2(0x132),_0x226955+=parseFloat(_0x28a108[_0x5932f2(0xdd)]['toFixed'](0x2)),_0x5a448a+=parseFloat(_0x28a108['NetPrice']['toFixed'](0x2)),_0x46ac4d+=_0x4fadae,_0x2f3a73+=parseFloat(_0x28a108[_0x5932f2(0x123)][_0x5932f2(0xc7)](0x2));if(_0x6863a5==_0x55606b['length']-0x1){_0x3bb8df+=_0x5932f2(0x21a),_0x3bb8df+=_0x5932f2(0x11c),_0x3bb8df+='</td>';for(let _0x2bfef5=0x0;_0x2bfef5<=_0x50e244['cat_brand']['length']-0x1;_0x2bfef5++){const _0x5723f7=_0x50e244[_0x5932f2(0xb9)][_0x2bfef5],_0x508530=_0x5723f7['_id']['brand']+'-'+_0x5723f7[_0x5932f2(0x1ff)][_0x5932f2(0x216)],_0x4a90ce=_0x1ee309[_0x508530][_0x5932f2(0x21f)]((_0x13190c,_0x44ed9b)=>_0x13190c+_0x44ed9b,0x0);_0x3bb8df+=_0x5932f2(0xdb)+(_0x4a90ce!==undefined?formatNumber(_0x4a90ce['toFixed'](0x2)):'')+'</b></td>',console[_0x5932f2(0x22c)](_0x1ee309[_0x508530][_0x5932f2(0x21f)]((_0x80fc64,_0x178188)=>_0x80fc64+_0x178188,0x0));}_0x3bb8df+=_0x5932f2(0x1f4)+formatNumber(_0x226955['toFixed'](0x2))+_0x5932f2(0xf5),_0x3bb8df+=_0x5932f2(0x1f4)+formatNumber(_0x2f3a73)+_0x5932f2(0xf5),_0x3bb8df+=_0x5932f2(0x1f4)+formatNumber(_0x46ac4d)+_0x5932f2(0xf5),_0x3bb8df+=_0x5932f2(0x1f4)+formatNumber(_0x5a448a)+'</b></td>',_0x3bb8df+=_0x5932f2(0x132);}_0x20efe6[_0x5932f2(0x1d8)](_0x3bb8df);}function _0x540412(_0x4eeb33,_0x108fe9){const _0x88f9e7=_0x5932f2,_0x37d85d=[];for(let _0x1814e7=0x0;_0x1814e7<=_0x4eeb33[_0x88f9e7(0x1d7)]-0x1;_0x1814e7+=_0x108fe9){_0x37d85d[_0x88f9e7(0x1d8)](_0x4eeb33[_0x88f9e7(0x17f)](_0x1814e7,_0x1814e7+_0x108fe9));}return _0x37d85d;}const _0x42ae39=_0x540412(_0x20efe6,_0x4c9c28);let _0x5a5bb7='';return _0x42ae39[_0x5932f2(0x1a4)]((_0x288576,_0x1eb432)=>{const _0x80f1d7=_0x5932f2;_0x1eb432>0x0&&(_0x5a5bb7+=_0x80f1d7(0x108));_0x5a5bb7+=_0x80f1d7(0x20c),_0x5a5bb7+=_0x80f1d7(0x16d),_0x5a5bb7+=_0x80f1d7(0x21a),_0x5a5bb7+=_0x80f1d7(0x171),_0x5a5bb7+=_0x80f1d7(0x132),_0x5a5bb7+='<tr>',_0x5a5bb7+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x57c268=0x0;_0x57c268<=_0x33ee2d[_0x80f1d7(0x1d7)]-0x1;_0x57c268++){const _0x5ff2ec=_0x33ee2d[_0x57c268];for(let _0x5b2f8d=0x0;_0x5b2f8d<_0x402340[_0x80f1d7(0x1d7)];_0x5b2f8d++){const _0x96ba8a=_0x402340[_0x5b2f8d];_0x96ba8a[_0x80f1d7(0x1ff)]===_0x5ff2ec[_0x80f1d7(0x1ff)][_0x80f1d7(0x216)]&&(_0x5a5bb7+=_0x80f1d7(0x157)+_0x96ba8a[_0x80f1d7(0x245)]+_0x80f1d7(0x1a9)+_0x5ff2ec['_id'][_0x80f1d7(0x216)]+_0x80f1d7(0x197));}}_0x5a5bb7+=_0x80f1d7(0xd7),_0x5a5bb7+=_0x80f1d7(0x132),_0x5a5bb7+='<tr>',_0x5a5bb7+=_0x80f1d7(0xbd),_0x5a5bb7+=_0x80f1d7(0x231),_0x5a5bb7+=_0x80f1d7(0xc8);for(let _0x222bc1=0x0;_0x222bc1<=_0x33ee2d[_0x80f1d7(0x1d7)]-0x1;_0x222bc1++){const _0xf8a088=_0x33ee2d[_0x222bc1];for(let _0x3ba070=0x0;_0x3ba070<_0x50e244[_0x80f1d7(0xb9)][_0x80f1d7(0x1d7)];_0x3ba070++){const _0x39ea6d=_0x50e244[_0x80f1d7(0xb9)][_0x3ba070];_0x39ea6d[_0x80f1d7(0x1ff)][_0x80f1d7(0x216)]===_0xf8a088[_0x80f1d7(0x1ff)][_0x80f1d7(0x216)]&&(_0x5a5bb7+='<td\x20class=\x22cat_data\x22>'+_0x39ea6d[_0x80f1d7(0x1ff)]['brand']+_0x80f1d7(0x197));}}_0x5a5bb7+=_0x80f1d7(0x202),_0x5a5bb7+=_0x80f1d7(0x189),_0x5a5bb7+=_0x80f1d7(0x223),_0x5a5bb7+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x5a5bb7+=_0x80f1d7(0x132),_0x5a5bb7+=_0x80f1d7(0x186),_0x5a5bb7+=_0x80f1d7(0x14d),_0x288576['forEach'](_0x186603=>{_0x5a5bb7+=_0x186603;}),console[_0x80f1d7(0x22c)](_0x1ee309),_0x5a5bb7+=_0x80f1d7(0x146),_0x5a5bb7+=_0x80f1d7(0x1b0);}),_0x5a5bb7;}router[a0_0x4019cd(0x228)](a0_0x4019cd(0x236),auth,async(_0x36449c,_0xb63e7a)=>{const _0x57f7f5=a0_0x4019cd,{from_date:_0x5173f,to_date:_0x2d040b,isExcel:_0x4d2ba5}=_0x36449c[_0x57f7f5(0x15b)],_0x4d1a0b=_0x36449c[_0x57f7f5(0x10f)],_0x4dcebb=await staff[_0x57f7f5(0x163)]({'email':_0x4d1a0b[_0x57f7f5(0x1ee)]}),_0x5d7468=await master_shop[_0x57f7f5(0x15a)]();console[_0x57f7f5(0x22c)](_0x5d7468[0x0][_0x57f7f5(0xfa)]);const _0x379a70=await agentsdataDSICheck(_0x5173f,_0x2d040b,_0x4dcebb[_0x57f7f5(0x1ff)][_0x57f7f5(0x15d)](),_0x4d2ba5),_0x1e4205=await agentsdataDSICheck_excel(_0x5173f,_0x2d040b,_0x4dcebb['_id'][_0x57f7f5(0x15d)](),_0x4d2ba5);let _0x39e707=_0x57f7f5(0x145);var _0x3d48b0=new Date(_0x5173f),_0x2d3e34=new Date(_0x2d040b);const _0x20a4c7={'year':'numeric','month':_0x57f7f5(0x1d4),'day':_0x57f7f5(0x182)},_0x2b1def=new Intl[(_0x57f7f5(0x17d))](_0x57f7f5(0x1cb),_0x20a4c7)[_0x57f7f5(0x119)](_0x3d48b0),_0x2e2da6=new Intl[(_0x57f7f5(0x17d))](_0x57f7f5(0x1cb),_0x20a4c7)[_0x57f7f5(0x119)](_0x2d3e34);_0x39e707+=_0x57f7f5(0x166),_0x39e707+=_0x57f7f5(0x1f8),_0x39e707+=_0x57f7f5(0x20c),_0x39e707+=_0x379a70,_0x39e707+=_0x57f7f5(0x1b0),_0x39e707+=_0x57f7f5(0x1ec),_0x39e707+=_0x57f7f5(0x1ec);let _0x4051b1=_0x57f7f5(0x145);_0x4051b1+=_0x57f7f5(0x166),_0x4051b1+=_0x57f7f5(0x1f8),_0x4051b1+=_0x57f7f5(0x20c),_0x4051b1+=_0x1e4205,_0x4051b1+=_0x57f7f5(0x1b0),_0x4051b1+='</div>',_0x4051b1+=_0x57f7f5(0x1ec);let _0x637053=_0x57f7f5(0xe5);const _0x20ea94={'width':_0x57f7f5(0x1bf),'height':_0x57f7f5(0x19f),'orientation':_0x57f7f5(0x1e6),'border':{'top':'0.1in','right':_0x57f7f5(0x210),'bottom':_0x57f7f5(0x210),'left':_0x57f7f5(0x210)},'header':{'height':_0x57f7f5(0x135),'contents':_0x57f7f5(0x1fa)+_0x637053+_0x57f7f5(0x1c2)+_0x2b1def+'\x20-\x20'+_0x2e2da6+_0x57f7f5(0x19a)},'footer':{'height':_0x57f7f5(0x1f5),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x4d2ba5=='on'){const _0x615f7=cheerio[_0x57f7f5(0xd8)](_0x4051b1);let _0x3a0d1c=[],_0x55f97b=[],_0x3accf7=[];const _0xeff000=_0x3cdf6b=>{const _0x2a7216=_0x57f7f5,_0x5d9def={'top':{'style':_0x2a7216(0x16f),'color':{'rgb':'000000'}},'bottom':{'style':'thick','color':{'rgb':_0x2a7216(0x113)}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':_0x2a7216(0x16f),'color':{'rgb':_0x2a7216(0x113)}}};if(_0x3cdf6b){const _0x2bcf9f=_0x3cdf6b['split'](';')[_0x2a7216(0x21f)]((_0x3a33d7,_0xc89b00)=>{const _0x22c2fa=_0x2a7216,[_0x59f0a5,_0x187a8c]=_0xc89b00[_0x22c2fa(0x144)](':')['map'](_0x223bc6=>_0x223bc6[_0x22c2fa(0xca)]());return _0x3a33d7[_0x59f0a5]=_0x187a8c,_0x3a33d7;},{});_0x2bcf9f[_0x2a7216(0xcb)]&&(_0x5d9def[_0x2a7216(0x18c)][_0x2a7216(0x1f9)]=_0x2bcf9f[_0x2a7216(0xcb)][_0x2a7216(0xd0)](_0x2a7216(0x224))?_0x2a7216(0x224):_0x2a7216(0x16a)),_0x2bcf9f[_0x2a7216(0x100)]&&(_0x5d9def[_0x2a7216(0x1f3)][_0x2a7216(0x1f9)]=_0x2bcf9f[_0x2a7216(0x100)]['includes'](_0x2a7216(0x224))?_0x2a7216(0x224):'medium'),_0x2bcf9f[_0x2a7216(0x244)]&&(_0x5d9def[_0x2a7216(0xe9)][_0x2a7216(0x1f9)]=_0x2bcf9f[_0x2a7216(0x244)][_0x2a7216(0xd0)]('thin')?_0x2a7216(0x224):_0x2a7216(0x16a)),_0x2bcf9f['border-right']&&(_0x5d9def[_0x2a7216(0x172)]['style']=_0x2bcf9f[_0x2a7216(0x1d2)][_0x2a7216(0xd0)]('thin')?'thin':_0x2a7216(0x16a));}return _0x5d9def;};_0x615f7(_0x57f7f5(0x109))[_0x57f7f5(0xda)]((_0x2fb2a1,_0x577707)=>{const _0x4eadf6=_0x57f7f5;let _0x24a3f8=[],_0x578130=0x0;while(_0x3accf7[_0x578130]){_0x3accf7[_0x578130]--,_0x578130++;}_0x615f7(_0x577707)['find']('td,\x20th')[_0x4eadf6(0xda)]((_0x1d533c,_0x17622c)=>{const _0x3d1349=_0x4eadf6;let _0x2ff32f=_0x615f7(_0x17622c)[_0x3d1349(0x227)]()['trim'](),_0xf47295=parseFloat(_0x2ff32f[_0x3d1349(0x101)](/,/g,'')),_0x10431d={};!isNaN(_0xf47295)?(_0x10431d['v']=_0xf47295,_0x10431d['t']='n'):(_0x10431d['v']=_0x2ff32f,_0x10431d['t']='s');const _0xebeb5=_0x615f7(_0x17622c)[_0x3d1349(0xbe)](_0x3d1349(0x1f9)),_0x35b7c6=_0xeff000(_0xebeb5);_0x10431d['s']={'border':_0x35b7c6},_0x24a3f8[_0x578130]=_0x10431d;let _0x2e668d=parseInt(_0x615f7(_0x17622c)[_0x3d1349(0xbe)](_0x3d1349(0x22e)))||0x1,_0xf82389=parseInt(_0x615f7(_0x17622c)[_0x3d1349(0xbe)](_0x3d1349(0x15e)))||0x1;(_0x2e668d>0x1||_0xf82389>0x1)&&_0x55f97b['push']({'s':{'r':_0x2fb2a1,'c':_0x578130},'e':{'r':_0x2fb2a1+_0xf82389-0x1,'c':_0x578130+_0x2e668d-0x1}});for(let _0x13127c=0x0;_0x13127c<_0x2e668d;_0x13127c++){_0xf82389>0x1&&(_0x3accf7[_0x578130+_0x13127c]=_0xf82389-0x1);}_0x578130+=_0x2e668d;}),_0x3a0d1c['push'](_0x24a3f8);});const _0x281d46=XLSX[_0x57f7f5(0x13b)]['book_new'](),_0x20659d=XLSX[_0x57f7f5(0x13b)][_0x57f7f5(0x12f)](_0x3a0d1c);_0x55f97b[_0x57f7f5(0x1d7)]>0x0&&(_0x20659d[_0x57f7f5(0xcf)]=_0x55f97b);_0x20659d[_0x57f7f5(0x200)]=_0x3a0d1c[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x57f7f5(0x13f)](_0x281d46,_0x20659d,'Sales\x20Report');const _0x101d45=XLSX[_0x57f7f5(0xd2)](_0x281d46,{'bookType':_0x57f7f5(0xc1),'type':'buffer'});_0xb63e7a[_0x57f7f5(0x103)]('Content-Disposition',_0x57f7f5(0x1b3)),_0xb63e7a[_0x57f7f5(0x103)](_0x57f7f5(0x162),_0x57f7f5(0x102)),_0xb63e7a[_0x57f7f5(0xed)](_0x101d45);}else pdf['create'](_0x39e707,_0x20ea94)[_0x57f7f5(0x1e3)](function(_0x2460b6,_0x54b9b2){const _0x281b4b=_0x57f7f5;if(_0x2460b6){_0xb63e7a[_0x281b4b(0x10a)](0x1f4)['send'](_0x281b4b(0x1d3));return;}_0xb63e7a[_0x281b4b(0x103)](_0x281b4b(0x162),_0x281b4b(0x1c0)),_0x54b9b2[_0x281b4b(0x10d)](_0xb63e7a);});}),router['get'](a0_0x4019cd(0x1ac),auth,async(_0x3b7d07,_0x1d1710)=>{const _0xafa9e0=a0_0x4019cd;try{const {username:_0xf622f2,email:_0xb3237c,role:_0x1ad196}=_0x3b7d07[_0xafa9e0(0x10f)],_0x406538=_0x3b7d07['user'],_0x108aff=await profile[_0xafa9e0(0x163)]({'email':_0x406538[_0xafa9e0(0x1ee)]}),_0x564037={'year':_0xafa9e0(0x182),'month':_0xafa9e0(0x1d4),'day':_0xafa9e0(0x182)},_0x5b426c=await master_shop[_0xafa9e0(0x15a)](),_0x55db58=await product[_0xafa9e0(0x15a)](),_0xa1c67d=await warehouse[_0xafa9e0(0xf9)]([{'$unwind':_0xafa9e0(0xde)},{'$lookup':{'from':_0xafa9e0(0x14f),'localField':_0xafa9e0(0x20e),'foreignField':_0xafa9e0(0x21c),'as':'product_docs'}},{'$unwind':_0xafa9e0(0x1c9)},{'$project':{'product_name':_0xafa9e0(0x208),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0xafa9e0(0x234),'product_stock':{'$sum':'$product_stock'}}}]),_0x55ff8d=await staff[_0xafa9e0(0x163)]({'email':_0x406538[_0xafa9e0(0x1ee)]});if(_0x5b426c[0x0][_0xafa9e0(0x139)]=='English\x20(US)')var _0x180fc1=users['English'];else{if(_0x5b426c[0x0][_0xafa9e0(0x139)]==_0xafa9e0(0xe1))var _0x180fc1=users[_0xafa9e0(0xe1)];else{if(_0x5b426c[0x0]['language']==_0xafa9e0(0xc0))var _0x180fc1=users[_0xafa9e0(0xc0)];else{if(_0x5b426c[0x0]['language']==_0xafa9e0(0x20d))var _0x180fc1=users['Spanish'];else{if(_0x5b426c[0x0]['language']=='French')var _0x180fc1=users[_0xafa9e0(0x152)];else{if(_0x5b426c[0x0]['language']=='Portuguese\x20(BR)')var _0x180fc1=users[_0xafa9e0(0x22b)];else{if(_0x5b426c[0x0][_0xafa9e0(0x139)]==_0xafa9e0(0x23a))var _0x180fc1=users[_0xafa9e0(0x23a)];else{if(_0x5b426c[0x0][_0xafa9e0(0x139)]==_0xafa9e0(0x133))var _0x180fc1=users[_0xafa9e0(0xf6)];}}}}}}}_0x1d1710[_0xafa9e0(0x18b)]('sales_reports',{'success':_0x3b7d07[_0xafa9e0(0xce)](_0xafa9e0(0xee)),'errors':_0x3b7d07[_0xafa9e0(0xce)](_0xafa9e0(0x194)),'alldata':_0x55db58,'profile':_0x108aff,'master_shop':_0x5b426c,'role':_0x406538,'product_stock':_0xa1c67d,'language':_0x180fc1,'staff_arr':_0x55ff8d});}catch(_0x1bcc31){}});async function dataSalesReports(_0x3c9849,_0x367621,_0x128c7d){const _0x5ba7b9=a0_0x4019cd;let _0x435504='';const _0x4eb7bc=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3c9849,'$lte':_0x367621},'sales_staff_id':_0x128c7d}},{'$unwind':_0x5ba7b9(0xc4)},{'$match':{'sale_product.isFG':_0x5ba7b9(0x18f)}},{'$group':{'_id':{'product_name':_0x5ba7b9(0x16b),'product_code':_0x5ba7b9(0x199)},'sumqty':{'$sum':_0x5ba7b9(0x11e)},'totalPrice':{'$sum':_0x5ba7b9(0x18e)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x479389=0x0,_0x31f5fd=0x0;for(let _0x147117=0x0;_0x147117<=_0x4eb7bc[_0x5ba7b9(0x1d7)]-0x1;_0x147117++){const _0x3ce08f=_0x4eb7bc[_0x147117];var _0x4b9c51=_0x3ce08f[_0x5ba7b9(0x16e)][_0x5ba7b9(0xe6)](undefined),_0x5daf56=_0x3ce08f[_0x5ba7b9(0x1cf)][_0x5ba7b9(0xe6)](undefined);_0x435504+=_0x5ba7b9(0x21a),_0x435504+=_0x5ba7b9(0x16c)+_0x3ce08f[_0x5ba7b9(0x1ff)]['product_code']+_0x5ba7b9(0x197),_0x435504+=_0x5ba7b9(0x16c)+_0x3ce08f['_id']['product_name']+_0x5ba7b9(0x197),_0x435504+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x3ce08f[_0x5ba7b9(0x1cf)]['toFixed'](0x2))+_0x5ba7b9(0x197),_0x435504+=_0x5ba7b9(0x16c)+formatNumber(_0x3ce08f[_0x5ba7b9(0x16e)][_0x5ba7b9(0xc7)](0x2))+'</td>',_0x435504+='</tr>',_0x479389+=parseFloat(_0x3ce08f[_0x5ba7b9(0x1cf)]),_0x31f5fd+=parseFloat(_0x3ce08f[_0x5ba7b9(0x16e)]);}var _0x1802e5=_0x31f5fd['toLocaleString'](undefined),_0xc712da=_0x479389[_0x5ba7b9(0xe6)](undefined);return _0x435504+=_0x5ba7b9(0x21a),_0x435504+=_0x5ba7b9(0x239),_0x435504+=_0x5ba7b9(0x1ab)+formatNumber(_0x479389[_0x5ba7b9(0xc7)](0x2))+_0x5ba7b9(0xf5),_0x435504+=_0x5ba7b9(0x1ab)+formatNumber(_0x31f5fd[_0x5ba7b9(0xc7)](0x2))+_0x5ba7b9(0xf5),_0x435504+=_0x5ba7b9(0x132),_0x435504;}router[a0_0x4019cd(0x228)]('/total_sales_reports/pdf',auth,async(_0x69fff3,_0x25b506)=>{const _0x383851=a0_0x4019cd;try{const {from_date:_0x4cf3c8,to_date:_0x9b6156,isExcel:_0x4d3be2}=_0x69fff3['body'],_0x4152ef=_0x69fff3[_0x383851(0x10f)],_0x38fba8=await staff[_0x383851(0x163)]({'email':_0x4152ef[_0x383851(0x1ee)]});let _0x543d06='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x354b9d=new Date(_0x4cf3c8),_0xb15fc5=new Date(_0x9b6156);const _0x4699fa={'year':_0x383851(0x182),'month':_0x383851(0x1d4),'day':_0x383851(0x182)},_0x3ce712=new Intl[(_0x383851(0x17d))]('en-US',_0x4699fa)[_0x383851(0x119)](_0x354b9d),_0x40466a=new Intl[(_0x383851(0x17d))]('en-US',_0x4699fa)[_0x383851(0x119)](_0xb15fc5);var _0x404c26=await dataSalesReports(_0x4cf3c8,_0x9b6156,_0x38fba8[_0x383851(0x1ff)][_0x383851(0x15d)]());_0x543d06+=_0x383851(0x166),_0x543d06+=_0x383851(0xb8),_0x543d06+=_0x383851(0x20c),_0x543d06+='<tr>',_0x543d06+=_0x383851(0x1f2),_0x543d06+=_0x383851(0x105),_0x543d06+=_0x383851(0x222),_0x543d06+=_0x383851(0x1f7),_0x543d06+=_0x383851(0x21a),_0x543d06+=_0x404c26,_0x543d06+=_0x383851(0x132),_0x543d06+=_0x383851(0x1ec),_0x543d06+=_0x383851(0x1ec);let _0x553921=_0x383851(0xe5);const _0x2b35ef={'width':_0x383851(0x1bf),'height':_0x383851(0x19f),'orientation':'landscape','border':{'top':_0x383851(0x210),'right':_0x383851(0x210),'bottom':'0.1in','left':_0x383851(0x210)},'header':{'height':_0x383851(0x135),'contents':_0x383851(0x1fa)+_0x553921+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x38fba8[_0x383851(0x21c)]+_0x383851(0x19c)+_0x3ce712+'\x20-\x20'+_0x40466a+_0x383851(0x19a)},'footer':{'height':_0x383851(0x1f5),'contents':{'default':_0x383851(0x121)}},'dpi':0x5,'zoomFactor':'1'};if(_0x4d3be2=='on'){const _0x2a5bdb=cheerio['load'](_0x543d06);let _0x56241e=[],_0x13e04e=[],_0x3462c3=[];const _0x3b2eea=_0x2b94dc=>{const _0x220e4c=_0x383851,_0xf35116={'top':{'style':_0x220e4c(0x16f),'color':{'rgb':_0x220e4c(0x113)}},'bottom':{'style':_0x220e4c(0x16f),'color':{'rgb':_0x220e4c(0x113)}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':_0x220e4c(0x16f),'color':{'rgb':_0x220e4c(0x113)}}};if(_0x2b94dc){const _0x15914f=_0x2b94dc[_0x220e4c(0x144)](';')['reduce']((_0x4a8df8,_0x1e26f7)=>{const _0x672b3c=_0x220e4c,[_0x25f34b,_0x474f18]=_0x1e26f7[_0x672b3c(0x144)](':')[_0x672b3c(0x173)](_0x5aace0=>_0x5aace0[_0x672b3c(0xca)]());return _0x4a8df8[_0x25f34b]=_0x474f18,_0x4a8df8;},{});_0x15914f[_0x220e4c(0xcb)]&&(_0xf35116[_0x220e4c(0x18c)][_0x220e4c(0x1f9)]=_0x15914f[_0x220e4c(0xcb)]['includes'](_0x220e4c(0x224))?_0x220e4c(0x224):_0x220e4c(0x16a)),_0x15914f[_0x220e4c(0x100)]&&(_0xf35116[_0x220e4c(0x1f3)][_0x220e4c(0x1f9)]=_0x15914f[_0x220e4c(0x100)][_0x220e4c(0xd0)](_0x220e4c(0x224))?'thin':'medium'),_0x15914f[_0x220e4c(0x244)]&&(_0xf35116[_0x220e4c(0xe9)][_0x220e4c(0x1f9)]=_0x15914f['border-left'][_0x220e4c(0xd0)](_0x220e4c(0x224))?_0x220e4c(0x224):'medium'),_0x15914f[_0x220e4c(0x1d2)]&&(_0xf35116[_0x220e4c(0x172)]['style']=_0x15914f[_0x220e4c(0x1d2)][_0x220e4c(0xd0)](_0x220e4c(0x224))?_0x220e4c(0x224):_0x220e4c(0x16a));}return _0xf35116;};_0x2a5bdb(_0x383851(0x109))[_0x383851(0xda)]((_0x445296,_0x57ef88)=>{const _0x44ab48=_0x383851;let _0x4824c8=[],_0x171b50=0x0;while(_0x3462c3[_0x171b50]){_0x3462c3[_0x171b50]--,_0x171b50++;}_0x2a5bdb(_0x57ef88)[_0x44ab48(0x15a)](_0x44ab48(0x170))[_0x44ab48(0xda)]((_0x1e3525,_0x16d45a)=>{const _0x58ef1e=_0x44ab48;let _0xa376e0=_0x2a5bdb(_0x16d45a)[_0x58ef1e(0x227)]()[_0x58ef1e(0xca)](),_0x4cb842=parseFloat(_0xa376e0[_0x58ef1e(0x101)](/,/g,'')),_0x2b31d0={};!isNaN(_0x4cb842)?(_0x2b31d0['v']=_0x4cb842,_0x2b31d0['t']='n'):(_0x2b31d0['v']=_0xa376e0,_0x2b31d0['t']='s');const _0x4524f9=_0x2a5bdb(_0x16d45a)[_0x58ef1e(0xbe)](_0x58ef1e(0x1f9)),_0x7660ff=_0x3b2eea(_0x4524f9);_0x2b31d0['s']={'border':_0x7660ff},_0x4824c8[_0x171b50]=_0x2b31d0;let _0x856fb0=parseInt(_0x2a5bdb(_0x16d45a)[_0x58ef1e(0xbe)](_0x58ef1e(0x22e)))||0x1,_0x56a757=parseInt(_0x2a5bdb(_0x16d45a)[_0x58ef1e(0xbe)](_0x58ef1e(0x15e)))||0x1;(_0x856fb0>0x1||_0x56a757>0x1)&&_0x13e04e[_0x58ef1e(0x1d8)]({'s':{'r':_0x445296,'c':_0x171b50},'e':{'r':_0x445296+_0x56a757-0x1,'c':_0x171b50+_0x856fb0-0x1}});for(let _0x28e1a2=0x0;_0x28e1a2<_0x856fb0;_0x28e1a2++){_0x56a757>0x1&&(_0x3462c3[_0x171b50+_0x28e1a2]=_0x56a757-0x1);}_0x171b50+=_0x856fb0;}),_0x56241e[_0x44ab48(0x1d8)](_0x4824c8);});const _0x1d9abe=XLSX[_0x383851(0x13b)][_0x383851(0xec)](),_0x5e2ba1=XLSX[_0x383851(0x13b)]['aoa_to_sheet'](_0x56241e);_0x13e04e[_0x383851(0x1d7)]>0x0&&(_0x5e2ba1['!merges']=_0x13e04e);_0x5e2ba1[_0x383851(0x200)]=_0x56241e[0x0][_0x383851(0x173)](()=>({'wpx':0x64})),XLSX['utils'][_0x383851(0x13f)](_0x1d9abe,_0x5e2ba1,_0x383851(0x1e9));const _0x59d1e9=XLSX[_0x383851(0xd2)](_0x1d9abe,{'bookType':'xlsx','type':_0x383851(0x174)});_0x25b506[_0x383851(0x103)](_0x383851(0x1b1),_0x383851(0x1b3)),_0x25b506[_0x383851(0x103)]('Content-Type',_0x383851(0x102)),_0x25b506[_0x383851(0xed)](_0x59d1e9);}else pdf['create'](_0x543d06,_0x2b35ef)['toStream'](function(_0x25729c,_0xc7bdbe){const _0x2610e4=_0x383851;if(_0x25729c){_0x25b506[_0x2610e4(0x10a)](0x1f4)['send'](_0x2610e4(0x1d3));return;}_0x25b506[_0x2610e4(0x103)](_0x2610e4(0x162),_0x2610e4(0x1c0)),_0xc7bdbe['pipe'](_0x25b506);});}catch(_0x56bca6){}}),router[a0_0x4019cd(0x107)]('/inventory_sum/view',auth,async(_0x3a7241,_0x2da1e9)=>{const _0x179bea=a0_0x4019cd;try{const {username:_0x3042e2,email:_0x2912b1,role:_0x51b12f}=_0x3a7241[_0x179bea(0x10f)],_0x2a1e7c=_0x3a7241[_0x179bea(0x10f)],_0x23042d=await profile[_0x179bea(0x163)]({'email':_0x2a1e7c[_0x179bea(0x1ee)]}),_0x404989={'year':_0x179bea(0x182),'month':'long','day':_0x179bea(0x182)},_0xa65c6c=await master_shop[_0x179bea(0x15a)](),_0xa9f747=await product[_0x179bea(0x15a)](),_0x1330ec=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x179bea(0x14f),'localField':_0x179bea(0x20e),'foreignField':'name','as':'product_docs'}},{'$unwind':_0x179bea(0x1c9)},{'$project':{'product_name':_0x179bea(0x208),'product_stock':_0x179bea(0xe7)}},{'$group':{'_id':_0x179bea(0x234),'product_stock':{'$sum':_0x179bea(0x14e)}}}]);if(_0xa65c6c[0x0][_0x179bea(0x139)]=='English\x20(US)')var _0x57fa80=users[_0x179bea(0x196)];else{if(_0xa65c6c[0x0][_0x179bea(0x139)]==_0x179bea(0xe1))var _0x57fa80=users['Hindi'];else{if(_0xa65c6c[0x0]['language']==_0x179bea(0xc0))var _0x57fa80=users[_0x179bea(0xc0)];else{if(_0xa65c6c[0x0][_0x179bea(0x139)]==_0x179bea(0x20d))var _0x57fa80=users[_0x179bea(0x20d)];else{if(_0xa65c6c[0x0]['language']=='French')var _0x57fa80=users[_0x179bea(0x152)];else{if(_0xa65c6c[0x0][_0x179bea(0x139)]==_0x179bea(0x1b8))var _0x57fa80=users[_0x179bea(0x22b)];else{if(_0xa65c6c[0x0][_0x179bea(0x139)]==_0x179bea(0x23a))var _0x57fa80=users['Chinese'];else{if(_0xa65c6c[0x0][_0x179bea(0x139)]==_0x179bea(0x133))var _0x57fa80=users[_0x179bea(0xf6)];}}}}}}}_0x2da1e9[_0x179bea(0x18b)](_0x179bea(0x168),{'success':_0x3a7241[_0x179bea(0xce)](_0x179bea(0xee)),'errors':_0x3a7241[_0x179bea(0xce)]('errors'),'alldata':_0xa9f747,'profile':_0x23042d,'master_shop':_0xa65c6c,'role':_0x2a1e7c,'product_stock':_0x1330ec,'language':_0x57fa80});}catch(_0x4b1c2e){}});async function dataInventoryReports(_0x57f781,_0x5df5b7,_0x3863b9){const _0x1bcd16=a0_0x4019cd,_0x64135c=await sales_sa[_0x1bcd16(0xf9)]([{'$match':{'date':{'$gte':_0x57f781,'$lte':_0x5df5b7},'sales_staff_id':_0x3863b9}},{'$unwind':_0x1bcd16(0xc4)},{'$group':{'_id':{'product_name':_0x1bcd16(0x16b),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x2d643b=mongoose[_0x1bcd16(0x1c3)][_0x1bcd16(0x1d9)],_0x5798f0=await staff[_0x1bcd16(0xf9)]([{'$match':{'_id':_0x2d643b(_0x3863b9)}},{'$unwind':_0x1bcd16(0x1b6)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x1bcd16(0x183),'product_code':_0x1bcd16(0x12c)},'sumqty':{'$sum':_0x1bcd16(0x19d)}}},{'$sort':{'_id.product_name':0x1}}]),_0x1b1e4f=await sales_inv_data['aggregate']([{'$match':{'date':{'$gte':_0x57f781,'$lte':_0x5df5b7},'sales_staff_id':_0x3863b9}},{'$unwind':_0x1bcd16(0xc4)},{'$group':{'_id':{'product_name':_0x1bcd16(0x16b),'product_code':_0x1bcd16(0x199)},'totalQTYsum':{'$sum':_0x1bcd16(0x18d)}}}]);console[_0x1bcd16(0x22c)](_0x1b1e4f);let _0x40635d='';var _0x589845=0x0;for(let _0x3f59a=0x0;_0x3f59a<=_0x5798f0[_0x1bcd16(0x1d7)]-0x1;_0x3f59a++){const _0x1dea3e=_0x5798f0[_0x3f59a];_0x40635d+=_0x1bcd16(0x21a),_0x40635d+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>'+_0x1dea3e[_0x1bcd16(0x1ff)]['product_code']+_0x1bcd16(0x197),_0x40635d+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>'+_0x1dea3e[_0x1bcd16(0x1ff)][_0x1bcd16(0x184)]+_0x1bcd16(0x197);var _0x3d4607=_0x1dea3e[_0x1bcd16(0x1cf)],_0x23aa1b=0x0;for(let _0x2f76e1=0x0;_0x2f76e1<=_0x64135c[_0x1bcd16(0x1d7)]-0x1;_0x2f76e1++){const _0x1a6caa=_0x64135c[_0x2f76e1];_0x1dea3e['_id']['product_code']==_0x1a6caa['_id']['product_code']&&_0x1dea3e[_0x1bcd16(0x1ff)][_0x1bcd16(0x184)]==_0x1a6caa[_0x1bcd16(0x1ff)][_0x1bcd16(0x184)]&&(_0x23aa1b=_0x1a6caa[_0x1bcd16(0x1cf)]);}var _0x18b5d4=0x0;for(let _0x3c1912=0x0;_0x3c1912<=_0x1b1e4f['length']-0x1;_0x3c1912++){const _0xbe5641=_0x1b1e4f[_0x3c1912];_0x1dea3e[_0x1bcd16(0x1ff)]['product_code']==_0xbe5641['_id'][_0x1bcd16(0x138)]&&_0x1dea3e['_id'][_0x1bcd16(0x184)]==_0xbe5641[_0x1bcd16(0x1ff)][_0x1bcd16(0x184)]&&(_0x18b5d4=_0xbe5641['totalQTYsum']);}_0x589845=_0x3d4607-_0x18b5d4+_0x23aa1b,_0x40635d+=_0x1bcd16(0x16c)+_0x589845+_0x1bcd16(0x197);let _0x1a80cc=![];for(let _0x1ac739=0x0;_0x1ac739<=_0x1b1e4f[_0x1bcd16(0x1d7)]-0x1;_0x1ac739++){const _0x3ce477=_0x1b1e4f[_0x1ac739];if(_0x1dea3e[_0x1bcd16(0x1ff)]['product_code']==_0x3ce477['_id'][_0x1bcd16(0x138)]&&_0x1dea3e[_0x1bcd16(0x1ff)][_0x1bcd16(0x184)]==_0x3ce477[_0x1bcd16(0x1ff)][_0x1bcd16(0x184)]){_0x40635d+=_0x1bcd16(0x16c)+_0x3ce477[_0x1bcd16(0x1e5)]+_0x1bcd16(0x197),_0x1a80cc=!![];break;}}!_0x1a80cc&&(_0x40635d+=_0x1bcd16(0x233));let _0x546106=![];for(let _0x3d88cd=0x0;_0x3d88cd<=_0x64135c[_0x1bcd16(0x1d7)]-0x1;_0x3d88cd++){const _0x2d8b8c=_0x64135c[_0x3d88cd];if(_0x1dea3e[_0x1bcd16(0x1ff)][_0x1bcd16(0x138)]==_0x2d8b8c[_0x1bcd16(0x1ff)][_0x1bcd16(0x138)]&&_0x1dea3e[_0x1bcd16(0x1ff)][_0x1bcd16(0x184)]==_0x2d8b8c[_0x1bcd16(0x1ff)]['product_name']){_0x40635d+=_0x1bcd16(0x16c)+_0x2d8b8c['sumqty']+_0x1bcd16(0x197),_0x546106=!![];break;}}!_0x546106&&(_0x40635d+=_0x1bcd16(0x233)),_0x40635d+=_0x1bcd16(0x16c)+_0x1dea3e[_0x1bcd16(0x1cf)]+_0x1bcd16(0x197),_0x40635d+='</tr>';}return _0x40635d;}router['post'](a0_0x4019cd(0x10c),auth,async(_0x1e3cc4,_0x876b4d)=>{const _0x359e63=a0_0x4019cd;try{const {from_date:_0x5c9a60,to_date:_0x31cbc1}=_0x1e3cc4[_0x359e63(0x15b)],_0x176f59=_0x1e3cc4[_0x359e63(0x10f)],_0x1b31b9=await staff[_0x359e63(0x163)]({'email':_0x176f59[_0x359e63(0x1ee)]});let _0x5cdf20='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x4bb1b9=new Date(_0x5c9a60),_0x18fb42=new Date(_0x31cbc1);const _0x3bc034={'year':_0x359e63(0x182),'month':'long','day':_0x359e63(0x182)},_0x51eb2d=new Intl['DateTimeFormat'](_0x359e63(0x1cb),_0x3bc034)['format'](_0x4bb1b9),_0x2e9839=new Intl[(_0x359e63(0x17d))](_0x359e63(0x1cb),_0x3bc034)[_0x359e63(0x119)](_0x18fb42);var _0x1c1537=await dataInventoryReports(_0x5c9a60,_0x31cbc1,_0x1b31b9['_id'][_0x359e63(0x15d)]());_0x5cdf20+=_0x359e63(0xd6),_0x5cdf20+=_0x359e63(0x1f0),_0x5cdf20+='<p>'+_0x51eb2d+_0x359e63(0x1e7)+_0x2e9839+_0x359e63(0x1ed),_0x5cdf20+=_0x359e63(0x166),_0x5cdf20+=_0x359e63(0xb8),_0x5cdf20+=_0x359e63(0x20c),_0x5cdf20+=_0x359e63(0x21a),_0x5cdf20+=_0x359e63(0x1f2),_0x5cdf20+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x5cdf20+='<th>\x20BEG\x20BALANCE\x20</th>',_0x5cdf20+=_0x359e63(0xcc),_0x5cdf20+=_0x359e63(0xe2),_0x5cdf20+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x5cdf20+=_0x359e63(0x21a),_0x5cdf20+=_0x1c1537,_0x5cdf20+=_0x359e63(0x132),_0x5cdf20+='</div>',_0x5cdf20+=_0x359e63(0x1ec);const _0x2ddb92={'format':_0x359e63(0x1dd),'orientation':_0x359e63(0x1e6)};pdf[_0x359e63(0x1eb)](_0x5cdf20,_0x2ddb92)[_0x359e63(0x1e3)](function(_0x35a842,_0xd194c3){const _0x32ae37=_0x359e63;if(_0x35a842){_0x876b4d[_0x32ae37(0x10a)](0x1f4)[_0x32ae37(0xed)](_0x32ae37(0x1d3));return;}_0x876b4d[_0x32ae37(0x103)](_0x32ae37(0x162),_0x32ae37(0x1c0)),_0xd194c3['pipe'](_0x876b4d);});}catch(_0x423484){}}),router['get'](a0_0x4019cd(0x1e2),auth,async(_0xcec314,_0x5333b5)=>{const _0x2636bf=a0_0x4019cd;try{const {username:_0x54b4be,email:_0x54d970,role:_0x365547}=_0xcec314[_0x2636bf(0x10f)],_0x117e88=_0xcec314[_0x2636bf(0x10f)],_0x4fe328=await profile[_0x2636bf(0x163)]({'email':_0x117e88[_0x2636bf(0x1ee)]}),_0x48e9ad={'year':_0x2636bf(0x182),'month':_0x2636bf(0x1d4),'day':_0x2636bf(0x182)},_0x4f28e9=await master_shop[_0x2636bf(0x15a)]();console[_0x2636bf(0x22c)](_0x2636bf(0xf0),_0x4f28e9);const _0x2a6549=await product[_0x2636bf(0x15a)]();console[_0x2636bf(0x22c)](_0x2636bf(0x136),_0x2a6549);const _0xa5c2be=await warehouse['aggregate']([{'$unwind':_0x2636bf(0xde)},{'$lookup':{'from':_0x2636bf(0x14f),'localField':'product_details.product_name','foreignField':_0x2636bf(0x21c),'as':_0x2636bf(0x1de)}},{'$unwind':_0x2636bf(0x1c9)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x2636bf(0xe7)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2636bf(0x14e)}}}]);console[_0x2636bf(0x22c)](_0x2636bf(0xc2),_0xa5c2be),_0xa5c2be[_0x2636bf(0x1a4)](_0x4e81e5=>{const _0xcaba22=_0x2a6549['map'](_0x1aaf55=>{const _0x3c287c=a0_0x3219;_0x1aaf55['name']==_0x4e81e5[_0x3c287c(0x1ff)]&&(_0x1aaf55[_0x3c287c(0xe8)]=parseInt(_0x1aaf55['stock'])+parseInt(_0x4e81e5[_0x3c287c(0x175)]));});});const _0x4ee26a=await staff[_0x2636bf(0x163)]({'email':_0x117e88[_0x2636bf(0x1ee)]});if(_0x4f28e9[0x0][_0x2636bf(0x139)]=='English\x20(US)')var _0x45392f=users[_0x2636bf(0x196)];else{if(_0x4f28e9[0x0][_0x2636bf(0x139)]==_0x2636bf(0xe1))var _0x45392f=users['Hindi'];else{if(_0x4f28e9[0x0]['language']==_0x2636bf(0xc0))var _0x45392f=users[_0x2636bf(0xc0)];else{if(_0x4f28e9[0x0]['language']=='Spanish')var _0x45392f=users[_0x2636bf(0x20d)];else{if(_0x4f28e9[0x0][_0x2636bf(0x139)]==_0x2636bf(0x152))var _0x45392f=users[_0x2636bf(0x152)];else{if(_0x4f28e9[0x0]['language']=='Portuguese\x20(BR)')var _0x45392f=users[_0x2636bf(0x22b)];else{if(_0x4f28e9[0x0][_0x2636bf(0x139)]==_0x2636bf(0x23a))var _0x45392f=users['Chinese'];else{if(_0x4f28e9[0x0][_0x2636bf(0x139)]=='Arabic\x20(ae)')var _0x45392f=users[_0x2636bf(0xf6)];}}}}}}}_0x5333b5['render']('dssr_view',{'success':_0xcec314[_0x2636bf(0xce)](_0x2636bf(0xee)),'errors':_0xcec314[_0x2636bf(0xce)]('errors'),'alldata':_0x2a6549,'profile':_0x4fe328,'master_shop':_0x4f28e9,'role':_0x117e88,'product_stock':_0xa5c2be,'language':_0x45392f,'staff_arr':_0x4ee26a});}catch(_0xd10f3d){}});function a0_0x20b8(){const _0x52a8ac=['toISOString','valueOf','rowspan','$date','express/lib/response','<script>','Content-Type','findOne','date','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','<div\x20class=\x22row\x22>','beg_bal','inventory_sum','sales_staff_id','medium','$sale_product.product_name','<td\x20class=\x22row_data\x22>','<thead>','totalPrice','thick','td,\x20th','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','right','map','buffer','product_stock','<td\x20class=\x22cat_data\x22></td>','<td\x20class=\x22cat_data\x22>','$products.NetPrice','No\x20data\x20was\x20Found!','toLocaleDateString','2180150rstLEY','express','DateTimeFormat','$totalQty','slice','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','numeric','$product_list.product_name','product_name','window.print();','</thead>','redirect','<p>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','adj_discount','render','top','$sale_product.stock','$sale_product.totalprice','false','brand','$product_info.gross_price','findById','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','errors','/balance/pdf','English','</td>','/agent_reports/view','$sale_product.product_code','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','$product_list.product_stock','$products.product_details.category','8.5in','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','$_id.brand','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<th\x20rowspan=\x272\x27>Products</th>','forEach','524eitxEm','sort','$product.product_name','$name','\x22\x20class=\x22cat_data\x22>','$sale_product.isFG','<td\x20class=\x22row_data\x22><b>','/total_sales_reports/view','$sale_product.adj_discount','$_id.status_data','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','</table>','Content-Disposition','$product_info.product_code','attachment;\x20filename=\x22sales_report.xlsx\x22','customer','dssr_view_admin','$product_list','$adj_discount','Portuguese\x20(BR)','/getDSSR_no','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','setDate','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','staffs','15in','application/pdf','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','Types','7516cLSXKq','$bank','</script>','/dsrr_admin/pdf_admin','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$product_docs','$_id.category','en-US','English\x20(US)','mongoose','params','sumqty','amount','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','border-right','Error\x20generating\x20PDF','long','isArray','$sales_info.name','length','push','ObjectId','$products.discount','sales_ext','date_include','Letter','product_docs','/agent/view','pdfkit-table','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','/dsrr/view','toStream','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','totalQTYsum','landscape','\x20-\x20','$customer','Sales\x20Report','$amount','create','</div>','</p>','email','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','<p>INVENTORY\x20SUMMARY</p>','\x20-\x20STD','<th>\x20ITEM\x20CODE\x20</th>','bottom','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','20mm','balanced','<th>\x20INVOICE\x20AMOUNT\x20</th>','<div\x20\x20id=\x22table-conatainer\x22>','style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','$products.adj_discount','$sale_product.discount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','_id','!cols','getMonth','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','995436PsVmUy','attachment;\x20filename=\x22reports.xlsx\x22','$_id.date','$product_info','/agent/pdf','$product_details.product_name','$_id.dsi','$sales_info','$status_data','<table>','Spanish','product_details.product_name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','0.1in','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','NumberFormat','dsi_sales','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','exports','category','$product_info.category','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','path','<tr>','Router','name','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','reduce','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<th>\x20QTY\x20SOLD\x20</th>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','thin','filter','catch','text','post','sales_bkg','98bsCUho','Portuguese','log','sale_product.product_code','colspan','/reports/dsrr/view','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','1913098miBllJ','<td\x20class=\x22row_data\x22>0</td>','$product_name','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','/agent_reports/pdf','due_date','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','Chinese','$brand','45oQkCor','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','cash','$NetPrice','bank','dsi_sales_admin','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','border-left','brandCount','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','<div\x20class=\x22col-sm-11\x22>','cat_brand','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','product_info','note','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','attr','multer','German','xlsx','Products\x20warehouse_data','error','$sale_product','dataqty','$products.product_details.prod_id','toFixed','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','639VztRRy','trim','border-top','<th>\x20INCOMING\x20</th>','$sale_product._id','flash','!merges','includes','$products.product_details.gross_price','write','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','getDate','\x20-\x20HH','<h1>JAKA\x20EQUITIES\x20CORP</h1>','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','load','<p>SALES\x20REPORTS</p>','each','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$product_code','totalQty','$product_details','NetPrice','window.onload\x20=\x20function()\x20{','Hindi','<th>\x20SALES\x20</th>','$product.product_code','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','toLocaleString','$product_details.product_stock','stock','left','83368yBOyHZ','<th\x20colspan=\x272\x27>SOLD</th>','book_new','send','success','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','Products\x20master','$products','</th>','$discount','/dsrr_admin/view_data/:id','</b></td>','Arabic','1RwxoEG','save','aggregate','image','sales_info','$product_info.brand','<th\x20rowspan=\x272\x27>Category</th>','$product','true','border-bottom','replace','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','setHeader','$sales_staff_id','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$totalGross','get','<div\x20style=\x22page-break-before:\x20always;\x22></div>','table\x20tr','status','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','/inventory_sum/pdf','pipe','$category','user','$sale_product.prod_cat','50970eqlFSq','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','000000','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','referenceNumber','$due_date','json','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','format','../public/language/languages.json','excel','<td\x20colspan=\x223\x22><b>TOTAL<b>','$products.product_details.brand','$sale_product.real_qty_unit_val','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','$dsi','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','totalGross','$cash','$sale_product.quantity','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','$product_info.name','/dl_excel','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','salesman_data','$check_no','$product_list.product_code','$products.product_details','check_no','aoa_to_sheet','product_details','$_id.customer','</tr>','Arabic\x20(ae)','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','60mm','Products\x20find_data','discount','product_code','language','dsi','utils','Asia/Manila','totalQTY','$products.qty','book_append_sheet','<th\x20rowspan=\x272\x27>Production</th>','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','../middleware/auth','qty','split','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','</tbody>','../models/all_models','html-pdf','/dsrr/pdf','prod_cat','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','/balance/view','<tbody>','$product_stock','products','isFG','html','French','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','agent_sales','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','<td\x20colspan=\x22','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','$product.quantity','find','body'];a0_0x20b8=function(){return _0x52a8ac;};return a0_0x20b8();}async function agentsdataDSICheck_DSRR(_0x4eb184,_0x3546a7,_0x179d25,_0x5bb2f2){const _0x3b2434=a0_0x4019cd;let _0xb86a3a=new Date(_0x4eb184);_0xb86a3a[_0x3b2434(0x1bc)](_0xb86a3a[_0x3b2434(0xd4)]()-0x1);let _0x118b2b=_0xb86a3a[_0x3b2434(0x15c)]()[_0x3b2434(0x144)]('T')[0x0];const _0xe06204=await product[_0x3b2434(0xf9)]([{'$group':{'_id':{'brand':_0x3b2434(0x23b),'category':_0x3b2434(0x10e)},'products':{'$push':{'name':'$name','product_code':_0x3b2434(0xdc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1999e0=[];_0x1999e0['cat_brand']=[];for(let _0x4a7cc9=0x0;_0x4a7cc9<=_0xe06204[_0x3b2434(0x1d7)]-0x1;_0x4a7cc9++){const _0x3599cc=_0xe06204[_0x4a7cc9];_0x1999e0[_0x3b2434(0xb9)]['push'](_0x3599cc);}const _0x1dfe4d=await product[_0x3b2434(0xf9)]([{'$group':{'_id':{'category':_0x3b2434(0x10e)},'products':{'$push':{'brand':_0x3b2434(0x23b),'product_code':_0x3b2434(0xdc),'product_name':_0x3b2434(0x1a8)}}}},{'$sort':{'_id.category':-0x1}}]),_0x256a2=await product[_0x3b2434(0xf9)]([{'$group':{'_id':{'category':_0x3b2434(0x10e),'brand':_0x3b2434(0x23b)}}},{'$group':{'_id':_0x3b2434(0x1ca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xfd2a28=await sales_sa[_0x3b2434(0xf9)]([{'$match':{'date':_0x4eb184,'sales_staff_id':_0x3546a7,'sale_product.isFG':'false'}},{'$unwind':_0x3b2434(0xc4)},{'$lookup':{'from':_0x3b2434(0x14f),'localField':_0x3b2434(0x22d),'foreignField':_0x3b2434(0x138),'as':'product_info'}},{'$unwind':_0x3b2434(0x206)},{'$group':{'_id':{'dsi':_0x3b2434(0x120),'date':_0x3b2434(0x15f),'customer':_0x3b2434(0x1e8),'status_data':_0x3b2434(0x20b)},'totalQty':{'$sum':_0x3b2434(0x11e)},'cash':{'$first':_0x3b2434(0x124)},'amount':{'$first':_0x3b2434(0x1ea)},'bank':{'$first':_0x3b2434(0x1c5)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3b2434(0x116)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x3b2434(0x1fc),'adj_discount':_0x3b2434(0x1ad),'product_details':{'prod_name':'$product_info.name','product_code':_0x3b2434(0x1b2),'category':_0x3b2434(0x217),'brand':_0x3b2434(0xfc),'gross_price':'$product_info.gross_price','isFG':_0x3b2434(0x1aa),'prod_cat':_0x3b2434(0x110),'prod_id':'$sale_product._id'}}}}},{'$unwind':_0x3b2434(0xf1)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3b2434(0x205),'customer':_0x3b2434(0x131),'status_data':'$_id.status_data','category':_0x3b2434(0x19e),'brand':'$products.product_details.brand','prod_id':_0x3b2434(0xc6)},'totalQty':{'$sum':_0x3b2434(0x13e)},'totalGross':{'$sum':{'$multiply':[_0x3b2434(0x13e),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x3b2434(0x1da)},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':_0x3b2434(0x124)},'amount':{'$first':_0x3b2434(0x1ea)},'bank':{'$first':_0x3b2434(0x1c5)},'check_no':{'$first':_0x3b2434(0x12b)},'due_date':{'$first':_0x3b2434(0x116)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3b2434(0x205),'customer':_0x3b2434(0x131),'status_data':_0x3b2434(0x1ae)},'totalQty':{'$sum':_0x3b2434(0x17e)},'totalGross':{'$sum':_0x3b2434(0x106)},'NetPrice':{'$sum':_0x3b2434(0x23f)},'discount':{'$sum':_0x3b2434(0xf3)},'adj_discount':{'$sum':_0x3b2434(0x1b7)},'cash':{'$first':_0x3b2434(0x124)},'amount':{'$first':'$amount'},'bank':{'$first':_0x3b2434(0x1c5)},'check_no':{'$first':_0x3b2434(0x12b)},'due_date':{'$first':_0x3b2434(0x116)},'products':{'$push':{'qty':_0x3b2434(0x17e),'category':_0x3b2434(0x1ca),'brand':'$_id.brand','product_details':_0x3b2434(0xde)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5a4db9=await sales_sa[_0x3b2434(0xf9)]([{'$match':{'date':_0x118b2b,'sales_staff_id':_0x3546a7,'sale_product.isFG':_0x3b2434(0x18f)}},{'$unwind':_0x3b2434(0xc4)},{'$lookup':{'from':'products','localField':_0x3b2434(0x22d),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x3b2434(0x206)},{'$group':{'_id':{'dsi':_0x3b2434(0x120),'date':'$date','customer':_0x3b2434(0x1e8)},'totalQty':{'$sum':_0x3b2434(0x11e)},'cash':{'$first':_0x3b2434(0x124)},'amount':{'$first':_0x3b2434(0x1ea)},'bank':{'$first':_0x3b2434(0x1c5)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3b2434(0x116)},'products':{'$push':{'qty':_0x3b2434(0x11e),'NetPrice':_0x3b2434(0x18e),'discount':'$sale_product.discount','adj_discount':_0x3b2434(0x1ad),'product_details':{'prod_name':_0x3b2434(0x127),'product_code':_0x3b2434(0x1b2),'category':_0x3b2434(0x217),'brand':_0x3b2434(0xfc),'gross_price':'$product_info.gross_price','isFG':_0x3b2434(0x1aa),'prod_cat':_0x3b2434(0x110),'prod_id':_0x3b2434(0xcd)}}}}},{'$unwind':_0x3b2434(0xf1)},{'$group':{'_id':{'dsi':_0x3b2434(0x209),'date':_0x3b2434(0x205),'customer':_0x3b2434(0x131),'category':_0x3b2434(0x19e),'brand':_0x3b2434(0x11d),'prod_id':_0x3b2434(0xc6)},'totalQty':{'$sum':_0x3b2434(0x13e)},'cash':{'$first':_0x3b2434(0x124)},'amount':{'$first':_0x3b2434(0x1ea)},'bank':{'$first':_0x3b2434(0x1c5)},'check_no':{'$first':_0x3b2434(0x12b)},'due_date':{'$first':_0x3b2434(0x116)},'totalGross':{'$sum':{'$multiply':[_0x3b2434(0x13e),_0x3b2434(0xd1)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x3b2434(0x1da)},'adj_discount':{'$sum':_0x3b2434(0x1fb)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x3b2434(0x209),'date':_0x3b2434(0x205),'customer':_0x3b2434(0x131)},'totalQty':{'$sum':_0x3b2434(0x17e)},'cash':{'$first':_0x3b2434(0x124)},'amount':{'$first':_0x3b2434(0x1ea)},'bank':{'$first':_0x3b2434(0x1c5)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3b2434(0x116)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x3b2434(0x23f)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x3b2434(0x1b7)},'products':{'$push':{'qty':'$totalQty','category':_0x3b2434(0x1ca),'brand':_0x3b2434(0x1a1),'product_details':_0x3b2434(0xde)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x3edbc5=await sales_sa[_0x3b2434(0xf9)]([{'$match':{'date':_0x4eb184,'sales_staff_id':_0x3546a7,'status_data':_0x3b2434(0xff)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x38e312=await staff[_0x3b2434(0x192)](_0x3546a7);let _0x36fa96=[],_0x4477bb={},_0x56d228={};var _0x3fa4ec=0x0,_0x190faa=0x0,_0xf301ea=0x0,_0x95b5=0x0,_0x5bd4fe=0x0;const _0x5335f2=0x6;var _0x202940=0x0,_0x5a3358=0x0;for(let _0x45b091=0x0;_0x45b091<=_0xfd2a28[_0x3b2434(0x1d7)]-0x1;_0x45b091++){const _0x518dee=_0xfd2a28[_0x45b091];let _0x39fe2d='<tr>';_0x39fe2d+=_0x3b2434(0x220),_0x39fe2d+=_0x3b2434(0x112)+_0x518dee[_0x3b2434(0x1ff)]['customer']+_0x3b2434(0x197),_0x39fe2d+=_0x3b2434(0x112)+_0x518dee['_id'][_0x3b2434(0x13a)]+_0x3b2434(0x197);let _0x143a0b={},_0xd79802={},_0x2d205c={};var _0x2658b4={},_0x2060a4={},_0x5dd278={},_0x1ac6ad=0x0;for(let _0x360953=0x0;_0x360953<=_0x518dee[_0x3b2434(0x14f)][_0x3b2434(0x1d7)]-0x1;_0x360953++){const _0xf9aba=_0x518dee['products'][_0x360953];_0x143a0b[_0xf9aba['brand']+'-'+_0xf9aba[_0x3b2434(0x216)]]=_0xf9aba[_0x3b2434(0x143)],_0xd79802[[_0xf9aba[_0x3b2434(0x190)]+'-'+_0xf9aba[_0x3b2434(0x216)]]]=_0xf9aba[_0x3b2434(0x130)][_0x3b2434(0x150)],_0x2d205c[[_0xf9aba[_0x3b2434(0x190)]+'-'+_0xf9aba[_0x3b2434(0x216)]]]=_0xf9aba[_0x3b2434(0x130)][_0x3b2434(0x14a)];const _0x47e2d5=_0xf9aba['brand']+'-'+_0xf9aba[_0x3b2434(0x216)];!Array['isArray'](_0x56d228[_0x47e2d5])&&(_0x56d228[_0x47e2d5]=[]);!Array['isArray'](_0x56d228[_0x47e2d5])&&(_0x56d228[_0x47e2d5]=[]);_0x56d228[_0x47e2d5][_0x3b2434(0x1d8)](_0xf9aba['qty']);if(_0xf9aba['product_details'][_0x3b2434(0x14a)]=='P')_0xf9aba['product_details'][_0x3b2434(0x150)]==_0x3b2434(0xff)?(!_0x5dd278[_0x47e2d5]&&(_0x5dd278[_0x47e2d5]=0x0),_0x5dd278[_0x47e2d5]=_0xf9aba[_0x3b2434(0x143)]):(!_0x2658b4[_0x47e2d5]&&(_0x2658b4[_0x47e2d5]=0x0),_0x2658b4[_0x47e2d5]=_0xf9aba[_0x3b2434(0x143)]);else _0xf9aba[_0x3b2434(0x130)][_0x3b2434(0x14a)]=='S'&&(_0xf9aba['product_details'][_0x3b2434(0x150)]==_0x3b2434(0xff)?(!_0x5dd278[_0x47e2d5]&&(_0x5dd278[_0x47e2d5]=0x0),_0x5dd278[_0x47e2d5]=_0xf9aba['qty']):(!_0x2060a4[_0x47e2d5]&&(_0x2060a4[_0x47e2d5]=0x0),_0x2060a4[_0x47e2d5]=_0xf9aba[_0x3b2434(0x143)]));_0x1ac6ad++;}for(let _0x411af2=0x0;_0x411af2<=_0x1999e0[_0x3b2434(0xb9)][_0x3b2434(0x1d7)]-0x1;_0x411af2++){const _0x374b66=_0x1999e0[_0x3b2434(0xb9)][_0x411af2],_0x40b42d=_0x374b66[_0x3b2434(0x1ff)][_0x3b2434(0x190)]+'-'+_0x374b66['_id'][_0x3b2434(0x216)],_0x491701=_0x2d205c[_0x40b42d]!==undefined?_0x2d205c[_0x40b42d]:'NA';var _0x58c099=_0x2658b4[_0x40b42d]!==undefined?_0x2658b4[_0x40b42d]['toFixed'](0x2):'',_0x2388bb=_0x2060a4[_0x40b42d]!==undefined?_0x2060a4[_0x40b42d][_0x3b2434(0xc7)](0x2):'',_0x1eb149=_0x5dd278[_0x40b42d]!==undefined?_0x5dd278[_0x40b42d][_0x3b2434(0xc7)](0x2):'';_0x39fe2d+=_0x3b2434(0x20f)+_0x58c099+_0x3b2434(0x197),_0x39fe2d+=_0x3b2434(0x20f)+_0x2388bb+_0x3b2434(0x197),_0x39fe2d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x1eb149+'</td>';}var _0x35a228=formatNumber(parseFloat(_0x518dee[_0x3b2434(0x23e)])),_0x2d4008=formatNumber(parseFloat(_0x518dee[_0x3b2434(0x1d0)]));isNaN(_0x2d4008)&&(_0x2d4008=0x0),_0x39fe2d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x35a228+_0x3b2434(0x197),_0x39fe2d+=_0x3b2434(0x20f)+_0x2d4008+_0x3b2434(0x197),_0x39fe2d+=_0x3b2434(0x112)+_0x518dee[_0x3b2434(0x240)]+_0x3b2434(0x197),_0x39fe2d+=_0x3b2434(0x112)+_0x518dee[_0x3b2434(0x12e)]+_0x3b2434(0x197),_0x39fe2d+=_0x3b2434(0x112)+_0x518dee[_0x3b2434(0x237)]+_0x3b2434(0x197),_0xf301ea=_0x518dee['discount']+_0x518dee[_0x3b2434(0x18a)],_0x202940+=parseFloat(_0x518dee['cash']),_0x5a3358+=parseFloat(_0x2d4008),_0x36fa96[_0x3b2434(0x1d8)](_0x39fe2d);}function _0x393b72(_0x58a125,_0x4c82af){const _0x391125=_0x3b2434,_0x3c2a7d=[];for(let _0xf734c9=0x0;_0xf734c9<=_0x58a125[_0x391125(0x1d7)]-0x1;_0xf734c9+=_0x4c82af){_0x3c2a7d[_0x391125(0x1d8)](_0x58a125[_0x391125(0x17f)](_0xf734c9,_0xf734c9+_0x4c82af));}return _0x3c2a7d;}const _0x334a3c=_0x393b72(_0x36fa96,_0x5335f2);let _0x1cd72c='';return _0x334a3c[_0x3b2434(0x1a4)]((_0x522f9f,_0xb442a6)=>{const _0x16fb75=_0x3b2434;_0xb442a6>0x0&&(_0x1cd72c+=_0x16fb75(0x108));_0x1cd72c+=_0x16fb75(0x20c),_0x1cd72c+=_0x16fb75(0x16d);const _0x18dc6f=new Date(_0x4eb184),_0x3dc2ca={'year':_0x16fb75(0x182),'month':'long','day':'numeric','timeZone':_0x16fb75(0x13c)},_0x102880=_0x18dc6f[_0x16fb75(0x17a)](_0x16fb75(0x1cb),_0x3dc2ca);_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+='<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20'+_0x5bb2f2+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+='<tr>',_0x1cd72c+=_0x16fb75(0x1bd)+_0x38e312['name']+'</td>',_0x1cd72c+=_0x16fb75(0x134),_0x1cd72c+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x1cd72c+=_0x16fb75(0x181),_0x1cd72c+=_0x16fb75(0xba),_0x1cd72c+=_0x16fb75(0x1e4),_0x1cd72c+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>',_0x1cd72c+=_0x16fb75(0x230),_0x1cd72c+=_0x16fb75(0x14b),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0x126),_0x1cd72c+=_0x16fb75(0x193)+_0x102880+'</td>',_0x1cd72c+=_0x16fb75(0x1ba),_0x1cd72c+=_0x16fb75(0x1c1),_0x1cd72c+=_0x16fb75(0x1fe),_0x1cd72c+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x1cd72c+='</tr>',_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0x1d1),_0x1cd72c+=_0x16fb75(0x153),_0x1cd72c+=_0x16fb75(0x221),_0x1cd72c+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x1cd72c+=_0x16fb75(0x1fe),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0x211),_0x1cd72c+='</tr>',_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0x10b),_0x1cd72c+=_0x16fb75(0x1af),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0xef),_0x1cd72c+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x1cd72c+=_0x16fb75(0x21e);for(let _0x529d86=0x0;_0x529d86<=_0x1dfe4d[_0x16fb75(0x1d7)]-0x1;_0x529d86++){const _0x271275=_0x1dfe4d[_0x529d86];for(let _0x5a81d3=0x0;_0x5a81d3<_0x1999e0['cat_brand'][_0x16fb75(0x1d7)];_0x5a81d3++){const _0x3f0398=_0x1999e0[_0x16fb75(0xb9)][_0x5a81d3];if(_0x3f0398[_0x16fb75(0x1ff)]['category']===_0x271275[_0x16fb75(0x1ff)]['category']){var _0xfac690='';switch(_0x271275['_id'][_0x16fb75(0x216)]){case'Standard':_0xfac690=_0x3f0398[_0x16fb75(0x1ff)][_0x16fb75(0x190)]+_0x16fb75(0x1f1);break;case'Household':_0xfac690=_0x3f0398[_0x16fb75(0x1ff)]['brand']+_0x16fb75(0xd5);break;default:_0xfac690=_0x3f0398[_0x16fb75(0x1ff)][_0x16fb75(0x190)];break;}_0x1cd72c+=_0x16fb75(0x243)+_0xfac690+_0x16fb75(0xf5);}}}_0x1cd72c+=_0x16fb75(0x155),_0x1cd72c+=_0x16fb75(0x21d),_0x1cd72c+=_0x16fb75(0x1ef),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0xb7);for(let _0x5cff46=0x0;_0x5cff46<=_0x1999e0['cat_brand'][_0x16fb75(0x1d7)]-0x1;_0x5cff46++){const _0x14bff4=_0x1999e0[_0x5cff46];_0x1cd72c+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x1cd72c+=_0x16fb75(0x23d),_0x1cd72c+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x1cd72c+=_0x16fb75(0x1a0),_0x1cd72c+=_0x16fb75(0x214),_0x1cd72c+=_0x16fb75(0x118),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+='</thead>',_0x1cd72c+=_0x16fb75(0x14d),_0x522f9f[_0x16fb75(0x1a4)](_0x3c19a4=>{_0x1cd72c+=_0x3c19a4;});let _0x4612d1={},_0x20473c={},_0x51dd6f={};for(let _0x44bc10=0x0;_0x44bc10<=_0xfd2a28[_0x16fb75(0x1d7)]-0x1;_0x44bc10++){const _0x35abbf=_0xfd2a28[_0x44bc10];var _0xd45a1=0x0;for(let _0x24d7ac=0x0;_0x24d7ac<=_0x35abbf[_0x16fb75(0x14f)][_0x16fb75(0x1d7)]-0x1;_0x24d7ac++){const _0x4ed080=_0x35abbf[_0x16fb75(0x14f)][_0x24d7ac],_0x77f237=_0x4ed080[_0x16fb75(0x190)]+'-'+_0x4ed080[_0x16fb75(0x216)];if(_0x4ed080[_0x16fb75(0x130)][_0x16fb75(0x14a)]=='P')_0x4ed080['product_details'][_0x16fb75(0x150)]=='true'?(!_0x51dd6f[_0x77f237]&&(_0x51dd6f[_0x77f237]=0x0),_0x51dd6f[_0x77f237]+=_0x4ed080[_0x16fb75(0x143)]):(!_0x4612d1[_0x77f237]&&(_0x4612d1[_0x77f237]=0x0),_0x4612d1[_0x77f237]+=_0x4ed080[_0x16fb75(0x143)]);else _0x4ed080[_0x16fb75(0x130)][_0x16fb75(0x14a)]=='S'&&(_0x4ed080['product_details']['isFG']=='true'?(!_0x51dd6f[_0x77f237]&&(_0x51dd6f[_0x77f237]=0x0),_0x51dd6f[_0x77f237]+=_0x4ed080[_0x16fb75(0x143)],console[_0x16fb75(0x22c)](_0x4ed080[_0x16fb75(0x143)])):(!_0x20473c[_0x77f237]&&(_0x20473c[_0x77f237]=0x0),_0x20473c[_0x77f237]+=_0x4ed080[_0x16fb75(0x143)]));_0xd45a1++;}}let _0x21d764={},_0x42dda0={},_0x28ca16={};var _0x141510=0x0,_0x39420d=0x0;for(let _0x38af50=0x0;_0x38af50<=_0x5a4db9['length']-0x1;_0x38af50++){const _0x347eba=_0x5a4db9[_0x38af50];var _0xd45a1=0x0;for(let _0x2a0f4f=0x0;_0x2a0f4f<=_0x347eba[_0x16fb75(0x14f)][_0x16fb75(0x1d7)]-0x1;_0x2a0f4f++){const _0x1613a2=_0x347eba[_0x16fb75(0x14f)][_0x2a0f4f],_0x2f63b5=_0x1613a2['brand']+'-'+_0x1613a2['category'];if(_0x1613a2['product_details'][_0x16fb75(0x14a)]=='P')_0x1613a2[_0x16fb75(0x130)][_0x16fb75(0x150)]==_0x16fb75(0xff)?(!_0x28ca16[_0x2f63b5]&&(_0x28ca16[_0x2f63b5]=0x0),_0x28ca16[_0x2f63b5]+=_0x1613a2[_0x16fb75(0x143)]):(!_0x21d764[_0x2f63b5]&&(_0x21d764[_0x2f63b5]=0x0),_0x21d764[_0x2f63b5]+=_0x1613a2[_0x16fb75(0x143)]);else _0x1613a2['product_details'][_0x16fb75(0x14a)]=='S'&&(_0x1613a2[_0x16fb75(0x130)][_0x16fb75(0x150)]=='true'?(!_0x28ca16[_0x2f63b5]&&(_0x28ca16[_0x2f63b5]=0x0),_0x28ca16[_0x2f63b5]+=_0x1613a2[_0x16fb75(0x143)]):(!_0x42dda0[_0x2f63b5]&&(_0x42dda0[_0x2f63b5]=0x0),_0x42dda0[_0x2f63b5]+=_0x1613a2[_0x16fb75(0x143)]));_0xd45a1++;}var _0x2916e0=parseFloat(_0x347eba['cash']),_0x24d4f6=parseFloat(_0x347eba['amount']);isNaN(_0x24d4f6)&&(_0x24d4f6=0x0),_0x141510+=_0x2916e0,_0x39420d+=_0x24d4f6;}if(_0x3edbc5[_0x16fb75(0x1d7)]>0x0)for(let _0xff5e35=0x0;_0xff5e35<=_0x3edbc5['length']-0x1;_0xff5e35++){const _0x3561c8=_0x3edbc5[_0xff5e35];console[_0x16fb75(0x22c)](_0x3561c8),_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0x180)+(0x8+0x7*0x3)+'\x22><b>'+_0x3561c8[_0x16fb75(0xbc)]+_0x16fb75(0xf5),_0x1cd72c+='</tr>';}_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0x1bb),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x1cd72c+=_0x16fb75(0x220);for(let _0x553c60=0x0;_0x553c60<=_0x1999e0[_0x16fb75(0xb9)][_0x16fb75(0x1d7)]-0x1;_0x553c60++){const _0x30c5d0=_0x1999e0[_0x16fb75(0xb9)][_0x553c60],_0x5c3be3=_0x30c5d0['_id']['brand']+'-'+_0x30c5d0['_id'][_0x16fb75(0x216)];var _0xc4105d=_0x4612d1[_0x5c3be3]!==undefined?formatNumber(_0x4612d1[_0x5c3be3][_0x16fb75(0xc7)](0x2)):'',_0x5eae6=_0x51dd6f[_0x5c3be3]!==undefined?formatNumber(_0x51dd6f[_0x5c3be3][_0x16fb75(0xc7)](0x2)):'',_0x54d1e7=_0x20473c[_0x5c3be3]!==undefined?formatNumber(_0x20473c[_0x5c3be3][_0x16fb75(0xc7)](0x2)):'';_0x1cd72c+=_0x16fb75(0xdb)+_0xc4105d+'</b></td>',_0x1cd72c+=_0x16fb75(0xdb)+_0x54d1e7+_0x16fb75(0xf5),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x5eae6+'</b></td>';}_0x1cd72c+=_0x16fb75(0xdb)+formatNumber(_0x202940)+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0xdb)+formatNumber(_0x5a3358)+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+='<tr>',_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x1cd72c+=_0x16fb75(0xd3),_0x1cd72c+=_0x16fb75(0x220);for(let _0x35f939=0x0;_0x35f939<=_0x1999e0[_0x16fb75(0xb9)]['length']-0x1;_0x35f939++){const _0x4ce8d9=_0x1999e0[_0x16fb75(0xb9)][_0x35f939],_0x3b4249=_0x4ce8d9[_0x16fb75(0x1ff)][_0x16fb75(0x190)]+'-'+_0x4ce8d9['_id']['category'];var _0xc4105d=_0x21d764[_0x3b4249]!==undefined?formatNumber(_0x21d764[_0x3b4249][_0x16fb75(0xc7)](0x2)):'',_0x5eae6=_0x28ca16[_0x3b4249]!==undefined?formatNumber(_0x28ca16[_0x3b4249]['toFixed'](0x2)):'',_0x54d1e7=_0x42dda0[_0x3b4249]!==undefined?formatNumber(_0x42dda0[_0x3b4249]['toFixed'](0x2)):'';_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0xc4105d+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0xdb)+_0x54d1e7+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0xdb)+_0x5eae6+_0x16fb75(0xf5);}_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x141510)+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0xdb)+formatNumber(_0x39420d)+_0x16fb75(0xf5),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x1cd72c+=_0x16fb75(0x129),_0x1cd72c+=_0x16fb75(0x220);let _0x2dcff8=0x0,_0x52d12f=0x0,_0x41d20b=0x0;for(let _0x33805d=0x0;_0x33805d<=_0x1999e0[_0x16fb75(0xb9)]['length']-0x1;_0x33805d++){const _0x263c6d=_0x1999e0[_0x16fb75(0xb9)][_0x33805d],_0x156eb6=_0x263c6d['_id']['brand']+'-'+_0x263c6d[_0x16fb75(0x1ff)]['category'];var _0x53ed2b=_0x4612d1[_0x156eb6]!==undefined?_0x4612d1[_0x156eb6][_0x16fb75(0xc7)](0x2):'0',_0x301906=_0x51dd6f[_0x156eb6]!==undefined?_0x51dd6f[_0x156eb6][_0x16fb75(0xc7)](0x2):'0',_0x266907=_0x20473c[_0x156eb6]!==undefined?_0x20473c[_0x156eb6][_0x16fb75(0xc7)](0x2):'0',_0x1de9e5=_0x21d764[_0x156eb6]!==undefined?_0x21d764[_0x156eb6]['toFixed'](0x2):'0',_0x36565d=_0x28ca16[_0x156eb6]!==undefined?_0x28ca16[_0x156eb6]['toFixed'](0x2):'0',_0x1957e8=_0x42dda0[_0x156eb6]!==undefined?_0x42dda0[_0x156eb6]['toFixed'](0x2):'0';_0x2dcff8=parseFloat(_0x53ed2b)+parseFloat(_0x1de9e5),_0x52d12f=parseFloat(_0x266907)+parseFloat(_0x1957e8),_0x41d20b=parseFloat(_0x301906)+parseFloat(_0x36565d),_0x1cd72c+=_0x16fb75(0xdb)+formatNumber(_0x2dcff8[_0x16fb75(0xc7)](0x2))+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0xdb)+formatNumber(_0x52d12f[_0x16fb75(0xc7)](0x2))+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0xdb)+formatNumber(_0x41d20b[_0x16fb75(0xc7)](0x2))+_0x16fb75(0xf5);}var _0x272349=formatNumber(_0x202940+_0x141510),_0x5280eb=formatNumber(_0x5a3358+_0x39420d);_0x1cd72c+=_0x16fb75(0xdb)+_0x272349+'</b></td>',_0x1cd72c+=_0x16fb75(0xdb)+_0x5280eb+_0x16fb75(0xf5),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1cd72c+='</tr>',_0x1cd72c+='<tr>',_0x1cd72c+=_0x16fb75(0x141)+(_0x1999e0[_0x16fb75(0xb9)][_0x16fb75(0x1d7)]*0x3+0x9)+'\x22><b></b></td>',_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+='<tr>',_0x1cd72c+=_0x16fb75(0x1bb),_0x1cd72c+=_0x16fb75(0x158),_0x1cd72c+=_0x16fb75(0x220);for(let _0x165d4c=0x0;_0x165d4c<=_0x1999e0[_0x16fb75(0xb9)][_0x16fb75(0x1d7)]-0x1;_0x165d4c++){const _0x48c000=_0x1999e0[_0x16fb75(0xb9)][_0x165d4c],_0x12a60d=_0x48c000[_0x16fb75(0x1ff)][_0x16fb75(0x190)]+'-'+_0x48c000[_0x16fb75(0x1ff)][_0x16fb75(0x216)];var _0x53ed2b=_0x4612d1[_0x12a60d]!==undefined?_0x4612d1[_0x12a60d][_0x16fb75(0xc7)](0x2):'0',_0x301906=_0x51dd6f[_0x12a60d]!==undefined?_0x51dd6f[_0x12a60d][_0x16fb75(0xc7)](0x2):'0',_0x266907=_0x20473c[_0x12a60d]!==undefined?_0x20473c[_0x12a60d][_0x16fb75(0xc7)](0x2):'0',_0x1de9e5=_0x21d764[_0x12a60d]!==undefined?_0x21d764[_0x12a60d]['toFixed'](0x2):'0',_0x36565d=_0x28ca16[_0x12a60d]!==undefined?_0x28ca16[_0x12a60d][_0x16fb75(0xc7)](0x2):'0',_0x1957e8=_0x42dda0[_0x12a60d]!==undefined?_0x42dda0[_0x12a60d][_0x16fb75(0xc7)](0x2):'0';_0x2dcff8=parseFloat(_0x53ed2b)+parseFloat(_0x1de9e5),_0x52d12f=parseFloat(_0x266907)+parseFloat(_0x1957e8),_0x41d20b=parseFloat(_0x301906)+parseFloat(_0x36565d),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1cd72c+=_0x16fb75(0x11f),_0x1cd72c+=_0x16fb75(0x11f);}_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+='<tr>',_0x1cd72c+=_0x16fb75(0x1bb),_0x1cd72c+=_0x16fb75(0xe4),_0x1cd72c+=_0x16fb75(0x220);for(let _0x353752=0x0;_0x353752<=_0x1999e0[_0x16fb75(0xb9)][_0x16fb75(0x1d7)]-0x1;_0x353752++){const _0x2e693a=_0x1999e0['cat_brand'][_0x353752],_0x2476db=_0x2e693a[_0x16fb75(0x1ff)][_0x16fb75(0x190)]+'-'+_0x2e693a[_0x16fb75(0x1ff)][_0x16fb75(0x216)];var _0x53ed2b=_0x4612d1[_0x2476db]!==undefined?_0x4612d1[_0x2476db][_0x16fb75(0xc7)](0x2):'0',_0x301906=_0x51dd6f[_0x2476db]!==undefined?_0x51dd6f[_0x2476db][_0x16fb75(0xc7)](0x2):'0',_0x266907=_0x20473c[_0x2476db]!==undefined?_0x20473c[_0x2476db][_0x16fb75(0xc7)](0x2):'0',_0x1de9e5=_0x21d764[_0x2476db]!==undefined?_0x21d764[_0x2476db][_0x16fb75(0xc7)](0x2):'0',_0x36565d=_0x28ca16[_0x2476db]!==undefined?_0x28ca16[_0x2476db][_0x16fb75(0xc7)](0x2):'0',_0x1957e8=_0x42dda0[_0x2476db]!==undefined?_0x42dda0[_0x2476db][_0x16fb75(0xc7)](0x2):'0';_0x2dcff8=parseFloat(_0x53ed2b)+parseFloat(_0x1de9e5),_0x52d12f=parseFloat(_0x266907)+parseFloat(_0x1957e8),_0x41d20b=parseFloat(_0x301906)+parseFloat(_0x36565d),_0x1cd72c+=_0x16fb75(0x11f),_0x1cd72c+=_0x16fb75(0x11f),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0x1bb),_0x1cd72c+=_0x16fb75(0x156),_0x1cd72c+=_0x16fb75(0x220);for(let _0x307372=0x0;_0x307372<=_0x1999e0[_0x16fb75(0xb9)][_0x16fb75(0x1d7)]-0x1;_0x307372++){const _0x17dd3a=_0x1999e0[_0x16fb75(0xb9)][_0x307372],_0x22ed18=_0x17dd3a['_id'][_0x16fb75(0x190)]+'-'+_0x17dd3a['_id']['category'];var _0x53ed2b=_0x4612d1[_0x22ed18]!==undefined?_0x4612d1[_0x22ed18]['toFixed'](0x2):'0',_0x301906=_0x51dd6f[_0x22ed18]!==undefined?_0x51dd6f[_0x22ed18][_0x16fb75(0xc7)](0x2):'0',_0x266907=_0x20473c[_0x22ed18]!==undefined?_0x20473c[_0x22ed18][_0x16fb75(0xc7)](0x2):'0',_0x1de9e5=_0x21d764[_0x22ed18]!==undefined?_0x21d764[_0x22ed18][_0x16fb75(0xc7)](0x2):'0',_0x36565d=_0x28ca16[_0x22ed18]!==undefined?_0x28ca16[_0x22ed18][_0x16fb75(0xc7)](0x2):'0',_0x1957e8=_0x42dda0[_0x22ed18]!==undefined?_0x42dda0[_0x22ed18][_0x16fb75(0xc7)](0x2):'0';_0x2dcff8=parseFloat(_0x53ed2b)+parseFloat(_0x1de9e5),_0x52d12f=parseFloat(_0x266907)+parseFloat(_0x1957e8),_0x41d20b=parseFloat(_0x301906)+parseFloat(_0x36565d),_0x1cd72c+=_0x16fb75(0x11f),_0x1cd72c+=_0x16fb75(0x11f),_0x1cd72c+=_0x16fb75(0x11f);}_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+=_0x16fb75(0x21a),_0x1cd72c+=_0x16fb75(0x1bb),_0x1cd72c+=_0x16fb75(0x1fd),_0x1cd72c+=_0x16fb75(0x220);for(let _0x37beec=0x0;_0x37beec<=_0x1999e0[_0x16fb75(0xb9)][_0x16fb75(0x1d7)]-0x1;_0x37beec++){const _0x3bef50=_0x1999e0['cat_brand'][_0x37beec],_0x444edf=_0x3bef50[_0x16fb75(0x1ff)][_0x16fb75(0x190)]+'-'+_0x3bef50[_0x16fb75(0x1ff)]['category'];var _0x53ed2b=_0x4612d1[_0x444edf]!==undefined?_0x4612d1[_0x444edf][_0x16fb75(0xc7)](0x2):'',_0x301906=_0x51dd6f[_0x444edf]!==undefined?_0x51dd6f[_0x444edf][_0x16fb75(0xc7)](0x2):'',_0x266907=_0x20473c[_0x444edf]!==undefined?_0x20473c[_0x444edf][_0x16fb75(0xc7)](0x2):'',_0x1de9e5=_0x21d764[_0x444edf]!==undefined?_0x21d764[_0x444edf][_0x16fb75(0xc7)](0x2):'',_0x36565d=_0x28ca16[_0x444edf]!==undefined?_0x28ca16[_0x444edf][_0x16fb75(0xc7)](0x2):'',_0x1957e8=_0x42dda0[_0x444edf]!==undefined?_0x42dda0[_0x444edf][_0x16fb75(0xc7)](0x2):'';_0x2dcff8=formatNumber(parseFloat(_0x53ed2b)+parseFloat(_0x1de9e5)),_0x52d12f=formatNumber(parseFloat(_0x266907)+parseFloat(_0x1957e8)),_0x41d20b=formatNumber(parseFloat(_0x301906)+parseFloat(_0x36565d)),_0x1cd72c+=_0x16fb75(0xdb)+_0x53ed2b+_0x16fb75(0xf5),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x266907+'</b></td>',_0x1cd72c+=_0x16fb75(0xdb)+_0x301906+_0x16fb75(0xf5);}_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+='<tr>',_0x1cd72c+=_0x16fb75(0x1bb),_0x1cd72c+=_0x16fb75(0x114),_0x1cd72c+=_0x16fb75(0x220);for(let _0x1e8caa=0x0;_0x1e8caa<=_0x1999e0[_0x16fb75(0xb9)][_0x16fb75(0x1d7)]-0x1;_0x1e8caa++){const _0x32be3d=_0x1999e0['cat_brand'][_0x1e8caa],_0x48703d=_0x32be3d[_0x16fb75(0x1ff)]['brand']+'-'+_0x32be3d['_id'][_0x16fb75(0x216)];var _0x53ed2b=_0x4612d1[_0x48703d]!==undefined?_0x4612d1[_0x48703d][_0x16fb75(0xc7)](0x2):'0',_0x301906=_0x51dd6f[_0x48703d]!==undefined?_0x51dd6f[_0x48703d][_0x16fb75(0xc7)](0x2):'0',_0x266907=_0x20473c[_0x48703d]!==undefined?_0x20473c[_0x48703d]['toFixed'](0x2):'0',_0x1de9e5=_0x21d764[_0x48703d]!==undefined?_0x21d764[_0x48703d][_0x16fb75(0xc7)](0x2):'0',_0x36565d=_0x28ca16[_0x48703d]!==undefined?_0x28ca16[_0x48703d]['toFixed'](0x2):'0',_0x1957e8=_0x42dda0[_0x48703d]!==undefined?_0x42dda0[_0x48703d]['toFixed'](0x2):'0';_0x2dcff8=parseFloat(_0x53ed2b)+parseFloat(_0x1de9e5),_0x52d12f=parseFloat(_0x266907)+parseFloat(_0x1957e8),_0x41d20b=parseFloat(_0x301906)+parseFloat(_0x36565d),_0x1cd72c+=_0x16fb75(0x11f),_0x1cd72c+=_0x16fb75(0x11f),_0x1cd72c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x220),_0x1cd72c+=_0x16fb75(0x132),_0x1cd72c+=_0x16fb75(0x146),_0x1cd72c+=_0x16fb75(0x1b0);}),_0x1cd72c;}async function generateReferenceNumber(_0xd973ba,_0x146ad5,_0x33ff8b){const _0x3ad50=a0_0x4019cd,_0x47c0b4=new Date(_0xd973ba)['getFullYear'](),_0x16c7c3=('0'+(new Date(_0xd973ba)[_0x3ad50(0x201)]()+0x1))[_0x3ad50(0x17f)](-0x2),_0x33fa92=('0'+new Date(_0xd973ba)[_0x3ad50(0xd4)]())['slice'](-0x2),_0x1e4531=await staff[_0x3ad50(0x163)]({'email':_0x33ff8b[_0x3ad50(0x1ee)]}),_0x5c6a8f=_0x1e4531['sales_man_code'],_0x3b27c6=_0x5c6a8f+'-'+_0x47c0b4+_0x16c7c3+_0x33fa92,_0x2b3a8d=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x3b27c6),'salesman_code':_0x5c6a8f})[_0x3ad50(0x1a6)]({'createdAt':-0x1}),_0x3def8f=_0x3b27c6;_0x2b3a8d&&(_0x3def8f=_0x2b3a8d[_0x3ad50(0x115)]);console['log'](_0x3def8f);const _0x8af9d1=new Reference({'referenceNumber':_0x3def8f,'staff_id':_0x146ad5,'salesman_code':_0x5c6a8f});return await _0x8af9d1['save'](),_0x3def8f;}function a0_0x3219(_0xbd6419,_0xa97620){const _0x20b820=a0_0x20b8();return a0_0x3219=function(_0x3219db,_0x2e1a2){_0x3219db=_0x3219db-0xb7;let _0x1b1fb4=_0x20b820[_0x3219db];return _0x1b1fb4;},a0_0x3219(_0xbd6419,_0xa97620);}router['post'](a0_0x4019cd(0x149),auth,async(_0x299599,_0x1fc66f)=>{const _0x4526d2=a0_0x4019cd,{from_date:_0x296cc4,dataview:_0xd2e836}=_0x299599[_0x4526d2(0x15b)],_0x1cfdee=_0x299599[_0x4526d2(0x10f)],_0x448962=await staff[_0x4526d2(0x163)]({'email':_0x1cfdee['email']}),_0x29826c=await master_shop[_0x4526d2(0x15a)](),_0x403e4f='';var _0x55a872=new Date(_0x296cc4);const _0x1d7f16={'year':_0x4526d2(0x182),'month':_0x4526d2(0x1d4),'day':_0x4526d2(0x182)},_0x12fdb6=new Intl[(_0x4526d2(0x17d))](_0x4526d2(0x1cb),_0x1d7f16)[_0x4526d2(0x119)](_0x55a872),_0x42fca1=await Reference[_0x4526d2(0x15a)]({'staff_id':_0x448962[_0x4526d2(0x1ff)][_0x4526d2(0x15d)](),'date_include':_0x296cc4});if(_0x42fca1[_0x4526d2(0x1d7)]>0x0){let _0x393f05='';_0x393f05+=_0x42fca1[0x0][_0x4526d2(0x151)];if(_0xd2e836==_0x4526d2(0x11b)){const _0x456063=cheerio[_0x4526d2(0xd8)](_0x393f05);let _0x14be00=[],_0x3220d1=[],_0x4c2451=[];const _0x4755c6=_0xaf7a8=>{const _0x2fd6b8=_0x4526d2,_0x4997be={'top':{'style':_0x2fd6b8(0x16f),'color':{'rgb':_0x2fd6b8(0x113)}},'bottom':{'style':_0x2fd6b8(0x16f),'color':{'rgb':'000000'}},'left':{'style':_0x2fd6b8(0x16f),'color':{'rgb':'000000'}},'right':{'style':_0x2fd6b8(0x16f),'color':{'rgb':_0x2fd6b8(0x113)}}};if(_0xaf7a8){const _0x4fc269=_0xaf7a8[_0x2fd6b8(0x144)](';')['reduce']((_0x471a07,_0x4699c3)=>{const _0xbd114f=_0x2fd6b8,[_0x5b818f,_0x2d27cd]=_0x4699c3[_0xbd114f(0x144)](':')[_0xbd114f(0x173)](_0x3dea58=>_0x3dea58['trim']());return _0x471a07[_0x5b818f]=_0x2d27cd,_0x471a07;},{});_0x4fc269[_0x2fd6b8(0xcb)]&&(_0x4997be[_0x2fd6b8(0x18c)]['style']=_0x4fc269[_0x2fd6b8(0xcb)][_0x2fd6b8(0xd0)](_0x2fd6b8(0x224))?_0x2fd6b8(0x224):_0x2fd6b8(0x16a)),_0x4fc269['border-bottom']&&(_0x4997be[_0x2fd6b8(0x1f3)][_0x2fd6b8(0x1f9)]=_0x4fc269[_0x2fd6b8(0x100)]['includes'](_0x2fd6b8(0x224))?'thin':_0x2fd6b8(0x16a)),_0x4fc269[_0x2fd6b8(0x244)]&&(_0x4997be[_0x2fd6b8(0xe9)][_0x2fd6b8(0x1f9)]=_0x4fc269[_0x2fd6b8(0x244)][_0x2fd6b8(0xd0)](_0x2fd6b8(0x224))?_0x2fd6b8(0x224):'medium'),_0x4fc269['border-right']&&(_0x4997be['right'][_0x2fd6b8(0x1f9)]=_0x4fc269[_0x2fd6b8(0x1d2)][_0x2fd6b8(0xd0)](_0x2fd6b8(0x224))?'thin':'medium');}return _0x4997be;};_0x456063(_0x4526d2(0x109))[_0x4526d2(0xda)]((_0x1bc9d4,_0x64b17e)=>{const _0x4ceb2c=_0x4526d2;let _0x2669e7=[],_0x2bcfa9=0x0;while(_0x4c2451[_0x2bcfa9]){_0x4c2451[_0x2bcfa9]--,_0x2bcfa9++;}_0x456063(_0x64b17e)[_0x4ceb2c(0x15a)](_0x4ceb2c(0x170))[_0x4ceb2c(0xda)]((_0x5ef9a2,_0x78cc41)=>{const _0x5dbe0f=_0x4ceb2c;let _0x298806=_0x456063(_0x78cc41)[_0x5dbe0f(0x227)]()['trim'](),_0x17446a=parseFloat(_0x298806[_0x5dbe0f(0x101)](/,/g,''));isNaN(_0x17446a)&&(_0x17446a=_0x298806);let _0x1b21d3=parseInt(_0x456063(_0x78cc41)['attr']('colspan'))||0x1,_0x34a659=parseInt(_0x456063(_0x78cc41)[_0x5dbe0f(0xbe)](_0x5dbe0f(0x15e)))||0x1;const _0x9672ef=_0x456063(_0x78cc41)[_0x5dbe0f(0xbe)]('style'),_0x5ddf56=_0x4755c6(_0x9672ef);_0x2669e7[_0x2bcfa9]={'v':_0x17446a,'s':{'border':_0x5ddf56}};(_0x1b21d3>0x1||_0x34a659>0x1)&&_0x3220d1[_0x5dbe0f(0x1d8)]({'s':{'r':_0x1bc9d4,'c':_0x2bcfa9},'e':{'r':_0x1bc9d4+_0x34a659-0x1,'c':_0x2bcfa9+_0x1b21d3-0x1}});for(let _0x55563a=0x0;_0x55563a<_0x1b21d3;_0x55563a++){_0x34a659>0x1&&(_0x4c2451[_0x2bcfa9+_0x55563a]=_0x34a659-0x1);}_0x2bcfa9+=_0x1b21d3;}),_0x14be00[_0x4ceb2c(0x1d8)](_0x2669e7);});const _0x1d6021=XLSX[_0x4526d2(0x13b)][_0x4526d2(0xec)](),_0x1146f2=XLSX[_0x4526d2(0x13b)]['aoa_to_sheet'](_0x14be00);_0x3220d1[_0x4526d2(0x1d7)]>0x0&&(_0x1146f2['!merges']=_0x3220d1);_0x1146f2[_0x4526d2(0x200)]=_0x14be00[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x4526d2(0x13b)][_0x4526d2(0x13f)](_0x1d6021,_0x1146f2,_0x4526d2(0x1e9));const _0x165705=XLSX['write'](_0x1d6021,{'bookType':'xlsx','type':_0x4526d2(0x174)});_0x1fc66f[_0x4526d2(0x103)]('Content-Disposition',_0x4526d2(0x1b3)),_0x1fc66f['setHeader'](_0x4526d2(0x162),_0x4526d2(0x102)),_0x1fc66f[_0x4526d2(0xed)](_0x165705);}else{let _0x4f9990='';_0x4f9990+=_0x393f05,_0x4f9990+=_0x4526d2(0x161),_0x4f9990+=_0x4526d2(0xe0),_0x4f9990+=_0x4526d2(0x185),_0x4f9990+='};',_0x4f9990+=_0x4526d2(0x1c6),_0x1fc66f[_0x4526d2(0xed)](_0x4f9990);}}else generateReferenceNumber(_0x296cc4,_0x448962[_0x4526d2(0x1ff)][_0x4526d2(0x15d)](),_0x1cfdee)['then'](async _0x3f6bd5=>{const _0x1bfc57=_0x4526d2,_0x2f0caf=await agentsdataDSICheck_DSRR(_0x296cc4,_0x448962[_0x1bfc57(0x1ff)][_0x1bfc57(0x15d)](),_0x403e4f,_0x3f6bd5);let _0x3551b2='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x3551b2+=_0x1bfc57(0x166),_0x3551b2+=_0x1bfc57(0x1f8),_0x3551b2+=_0x1bfc57(0x20c),_0x3551b2+=_0x2f0caf,_0x3551b2+=_0x1bfc57(0x1b0),_0x3551b2+=_0x1bfc57(0x1ec),_0x3551b2+=_0x1bfc57(0x1ec);if(_0x2f0caf[_0x1bfc57(0x1d7)]>0x0){const _0x326cc6=await Reference['findOne']({'staff_id':_0x448962[_0x1bfc57(0x1ff)][_0x1bfc57(0x15d)](),'referenceNumber':_0x3f6bd5});_0x326cc6[_0x1bfc57(0x151)]=_0x3551b2,_0x326cc6[_0x1bfc57(0x1dc)]=_0x296cc4,await _0x326cc6[_0x1bfc57(0xf8)]();if(_0xd2e836==_0x1bfc57(0x11b)){const _0x42ffdc=cheerio['load'](_0x3551b2);let _0x5d6ef2=[],_0xbdbef6=[],_0x951dd=[];const _0x2e47cd=_0x2033c9=>{const _0x241833=_0x1bfc57,_0x8232f2={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0x241833(0x16f),'color':{'rgb':_0x241833(0x113)}},'left':{'style':'thick','color':{'rgb':_0x241833(0x113)}},'right':{'style':_0x241833(0x16f),'color':{'rgb':_0x241833(0x113)}}};if(_0x2033c9){const _0x5e88f4=_0x2033c9[_0x241833(0x144)](';')['reduce']((_0xeb7117,_0x505a06)=>{const _0x35698a=_0x241833,[_0x19baad,_0x5e3cb1]=_0x505a06[_0x35698a(0x144)](':')[_0x35698a(0x173)](_0x14abbc=>_0x14abbc[_0x35698a(0xca)]());return _0xeb7117[_0x19baad]=_0x5e3cb1,_0xeb7117;},{});_0x5e88f4[_0x241833(0xcb)]&&(_0x8232f2[_0x241833(0x18c)][_0x241833(0x1f9)]=_0x5e88f4['border-top'][_0x241833(0xd0)]('thin')?_0x241833(0x224):'medium'),_0x5e88f4[_0x241833(0x100)]&&(_0x8232f2[_0x241833(0x1f3)]['style']=_0x5e88f4[_0x241833(0x100)][_0x241833(0xd0)]('thin')?'thin':_0x241833(0x16a)),_0x5e88f4['border-left']&&(_0x8232f2[_0x241833(0xe9)][_0x241833(0x1f9)]=_0x5e88f4['border-left'][_0x241833(0xd0)](_0x241833(0x224))?'thin':_0x241833(0x16a)),_0x5e88f4[_0x241833(0x1d2)]&&(_0x8232f2[_0x241833(0x172)][_0x241833(0x1f9)]=_0x5e88f4[_0x241833(0x1d2)][_0x241833(0xd0)](_0x241833(0x224))?'thin':_0x241833(0x16a));}return _0x8232f2;};_0x42ffdc(_0x1bfc57(0x109))[_0x1bfc57(0xda)]((_0x1222a2,_0x65c320)=>{const _0xb377a5=_0x1bfc57;let _0xdc252=[],_0x29f7c7=0x0;while(_0x951dd[_0x29f7c7]){_0x951dd[_0x29f7c7]--,_0x29f7c7++;}_0x42ffdc(_0x65c320)[_0xb377a5(0x15a)](_0xb377a5(0x170))[_0xb377a5(0xda)]((_0x3aafd1,_0x4c2cc0)=>{const _0xe959f5=_0xb377a5;let _0x4a4bf4=_0x42ffdc(_0x4c2cc0)[_0xe959f5(0x227)]()['trim'](),_0x53dcd4=parseFloat(_0x4a4bf4[_0xe959f5(0x101)](/,/g,''));isNaN(_0x53dcd4)&&(_0x53dcd4=_0x4a4bf4);let _0x3526a6=parseInt(_0x42ffdc(_0x4c2cc0)['attr'](_0xe959f5(0x22e)))||0x1,_0x1aa5b4=parseInt(_0x42ffdc(_0x4c2cc0)[_0xe959f5(0xbe)](_0xe959f5(0x15e)))||0x1;const _0x1d2151=_0x42ffdc(_0x4c2cc0)[_0xe959f5(0xbe)]('style'),_0x4d8b42=_0x2e47cd(_0x1d2151);_0xdc252[_0x29f7c7]={'v':_0x53dcd4,'s':{'border':_0x4d8b42}};(_0x3526a6>0x1||_0x1aa5b4>0x1)&&_0xbdbef6[_0xe959f5(0x1d8)]({'s':{'r':_0x1222a2,'c':_0x29f7c7},'e':{'r':_0x1222a2+_0x1aa5b4-0x1,'c':_0x29f7c7+_0x3526a6-0x1}});for(let _0x508ef1=0x0;_0x508ef1<_0x3526a6;_0x508ef1++){_0x1aa5b4>0x1&&(_0x951dd[_0x29f7c7+_0x508ef1]=_0x1aa5b4-0x1);}_0x29f7c7+=_0x3526a6;}),_0x5d6ef2[_0xb377a5(0x1d8)](_0xdc252);});const _0x2e310d=XLSX[_0x1bfc57(0x13b)]['book_new'](),_0x491e22=XLSX[_0x1bfc57(0x13b)][_0x1bfc57(0x12f)](_0x5d6ef2);_0xbdbef6['length']>0x0&&(_0x491e22[_0x1bfc57(0xcf)]=_0xbdbef6);_0x491e22['!cols']=_0x5d6ef2[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x1bfc57(0x13b)][_0x1bfc57(0x13f)](_0x2e310d,_0x491e22,'Sales\x20Report');const _0xe1927d=XLSX['write'](_0x2e310d,{'bookType':_0x1bfc57(0xc1),'type':_0x1bfc57(0x174)});_0x1fc66f[_0x1bfc57(0x103)](_0x1bfc57(0x1b1),_0x1bfc57(0x1b3)),_0x1fc66f[_0x1bfc57(0x103)](_0x1bfc57(0x162),_0x1bfc57(0x102)),_0x1fc66f[_0x1bfc57(0xed)](_0xe1927d);}else _0x3551b2+=_0x1bfc57(0x161),_0x3551b2+=_0x1bfc57(0xe0),_0x3551b2+=_0x1bfc57(0x185),_0x3551b2+='};',_0x3551b2+=_0x1bfc57(0x1c6),_0x1fc66f[_0x1bfc57(0xed)](_0x3551b2);}else await Reference['deleteOne']({'referenceNumber':_0x3f6bd5}),_0x299599[_0x1bfc57(0xce)](_0x1bfc57(0x194),_0x1bfc57(0x179)),_0x1fc66f[_0x1bfc57(0x187)](_0x1bfc57(0x22f));})[_0x4526d2(0x226)](console[_0x4526d2(0xc3)]);}),router[a0_0x4019cd(0x107)]('/dsrr_admin/view',auth,async(_0x20a3f6,_0x4de05f)=>{const _0x1b7bd1=a0_0x4019cd;try{const {username:_0x1e9dc6,email:_0x4d084e,role:_0x5d6543}=_0x20a3f6['user'],_0x4933de=_0x20a3f6['user'],_0x289a86=await profile[_0x1b7bd1(0x163)]({'email':_0x4933de[_0x1b7bd1(0x1ee)]}),_0x287d80={'year':_0x1b7bd1(0x182),'month':'long','day':_0x1b7bd1(0x182)},_0xc25b43=await master_shop['find']();console[_0x1b7bd1(0x22c)](_0x1b7bd1(0xf0),_0xc25b43);const _0x4ce975=await product[_0x1b7bd1(0x15a)]();console[_0x1b7bd1(0x22c)](_0x1b7bd1(0x136),_0x4ce975);const _0x35d6e2=await warehouse[_0x1b7bd1(0xf9)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':_0x1b7bd1(0x21c),'as':_0x1b7bd1(0x1de)}},{'$unwind':_0x1b7bd1(0x1c9)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x1b7bd1(0xe7)}},{'$group':{'_id':_0x1b7bd1(0x234),'product_stock':{'$sum':_0x1b7bd1(0x14e)}}}]);console[_0x1b7bd1(0x22c)](_0x1b7bd1(0xc2),_0x35d6e2),_0x35d6e2[_0x1b7bd1(0x1a4)](_0x1248b6=>{const _0x54c9c3=_0x1b7bd1,_0x2fb461=_0x4ce975[_0x54c9c3(0x173)](_0x1fa166=>{const _0x2d2f74=_0x54c9c3;_0x1fa166[_0x2d2f74(0x21c)]==_0x1248b6['_id']&&(_0x1fa166[_0x2d2f74(0xe8)]=parseInt(_0x1fa166[_0x2d2f74(0xe8)])+parseInt(_0x1248b6['product_stock']));});});const _0x24c990=await staff[_0x1b7bd1(0x15a)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x125972=await staff[_0x1b7bd1(0x163)]({'email':_0x4933de['email']});if(_0xc25b43[0x0][_0x1b7bd1(0x139)]=='English\x20(US)')var _0x100a6f=users[_0x1b7bd1(0x196)];else{if(_0xc25b43[0x0][_0x1b7bd1(0x139)]==_0x1b7bd1(0xe1))var _0x100a6f=users[_0x1b7bd1(0xe1)];else{if(_0xc25b43[0x0][_0x1b7bd1(0x139)]==_0x1b7bd1(0xc0))var _0x100a6f=users['German'];else{if(_0xc25b43[0x0][_0x1b7bd1(0x139)]=='Spanish')var _0x100a6f=users['Spanish'];else{if(_0xc25b43[0x0][_0x1b7bd1(0x139)]==_0x1b7bd1(0x152))var _0x100a6f=users['French'];else{if(_0xc25b43[0x0]['language']=='Portuguese\x20(BR)')var _0x100a6f=users[_0x1b7bd1(0x22b)];else{if(_0xc25b43[0x0]['language']==_0x1b7bd1(0x23a))var _0x100a6f=users['Chinese'];else{if(_0xc25b43[0x0][_0x1b7bd1(0x139)]==_0x1b7bd1(0x133))var _0x100a6f=users[_0x1b7bd1(0xf6)];}}}}}}}_0x4de05f[_0x1b7bd1(0x18b)](_0x1b7bd1(0x1b5),{'success':_0x20a3f6[_0x1b7bd1(0xce)](_0x1b7bd1(0xee)),'errors':_0x20a3f6[_0x1b7bd1(0xce)]('errors'),'alldata':_0x4ce975,'profile':_0x289a86,'master_shop':_0xc25b43,'role':_0x4933de,'product_stock':_0x35d6e2,'language':_0x100a6f,'staff_arr':_0x125972,'staff_data_all':_0x24c990});}catch(_0x57f044){}}),router[a0_0x4019cd(0x228)](a0_0x4019cd(0x1b9),auth,async(_0x1f4a92,_0x57d13f)=>{const _0x577cce=a0_0x4019cd;try{const {from:_0x5f0734,to:_0x1d085d,staff_data:_0x13cdd9}=_0x1f4a92[_0x577cce(0x15b)],_0x3dd0a7=await Reference[_0x577cce(0xf9)]([{'$match':{'date_include':{'$gte':_0x5f0734,'$lte':_0x1d085d},'staff_id':_0x13cdd9}},{'$sort':{'date_include':0x1}}]);_0x57d13f[_0x577cce(0x117)](_0x3dd0a7);}catch(_0x5f25c9){_0x57d13f[_0x577cce(0x117)](_0x5f25c9);}}),router[a0_0x4019cd(0x107)](a0_0x4019cd(0xf4),auth,async(_0x487f79,_0x32ab73)=>{const _0x2967ad=a0_0x4019cd;try{const _0x40df17=_0x487f79[_0x2967ad(0x1ce)]['id'],_0x3f668d=await Reference[_0x2967ad(0x192)](_0x40df17);let _0x3f603b='';_0x3f603b+=_0x3f668d[_0x2967ad(0x151)],_0x3f603b+=_0x2967ad(0x161),_0x3f603b+='window.onload\x20=\x20function()\x20{',_0x3f603b+='window.print();',_0x3f603b+='};',_0x3f603b+='</script>',_0x32ab73['send'](_0x3f603b);}catch(_0x54b4a7){_0x32ab73[_0x2967ad(0x117)](_0x54b4a7);}}),router[a0_0x4019cd(0x228)](a0_0x4019cd(0x128),auth,async(_0x36df1b,_0x1846b6)=>{const _0x21cd92=a0_0x4019cd;try{const {ref_data:_0x494b95}=_0x36df1b['body'],_0x4afd6f=_0x494b95[_0x21cd92(0x144)]('~'),_0x293542=_0x4afd6f[_0x21cd92(0x225)](_0x1f7cab=>_0x1f7cab!==''),_0x455c5a=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x293542}}}]),_0x2cad73=XLSX[_0x21cd92(0x13b)][_0x21cd92(0xec)]();_0x455c5a['forEach'](_0x18f6ca=>{const _0x4011e9=_0x21cd92,_0x458296=cheerio[_0x4011e9(0xd8)](_0x18f6ca['html']);let _0x5f514f=[],_0x5852a7=[],_0x52c31a=[];_0x458296('table\x20tr')[_0x4011e9(0xda)]((_0x56c2c1,_0x23b756)=>{const _0x25c7c3=_0x4011e9;let _0x26a732=[],_0x2dd745=0x0;while(_0x52c31a[_0x2dd745]){_0x52c31a[_0x2dd745]--,_0x2dd745++;}_0x458296(_0x23b756)[_0x25c7c3(0x15a)]('td,\x20th')[_0x25c7c3(0xda)]((_0x465568,_0x1f0862)=>{const _0x44dc69=_0x25c7c3;let _0x4b9776=_0x458296(_0x1f0862)['text']()[_0x44dc69(0xca)](),_0x1ab10e=parseFloat(_0x4b9776[_0x44dc69(0x101)](/,/g,''));isNaN(_0x1ab10e)&&(_0x1ab10e=_0x4b9776);let _0x5caea5=parseInt(_0x458296(_0x1f0862)[_0x44dc69(0xbe)](_0x44dc69(0x22e)))||0x1,_0x432daa=parseInt(_0x458296(_0x1f0862)[_0x44dc69(0xbe)](_0x44dc69(0x15e)))||0x1;_0x26a732[_0x2dd745]=_0x1ab10e;(_0x5caea5>0x1||_0x432daa>0x1)&&_0x5852a7['push']({'s':{'r':_0x56c2c1,'c':_0x2dd745},'e':{'r':_0x56c2c1+_0x432daa-0x1,'c':_0x2dd745+_0x5caea5-0x1}});for(let _0x84486e=0x0;_0x84486e<_0x5caea5;_0x84486e++){_0x432daa>0x1&&(_0x52c31a[_0x2dd745+_0x84486e]=_0x432daa-0x1);}_0x2dd745+=_0x5caea5;}),_0x5f514f[_0x25c7c3(0x1d8)](_0x26a732);});const _0x548331=XLSX[_0x4011e9(0x13b)][_0x4011e9(0x12f)](_0x5f514f);_0x5852a7[_0x4011e9(0x1d7)]>0x0&&(_0x548331[_0x4011e9(0xcf)]=_0x5852a7),_0x548331[_0x4011e9(0x200)]=_0x5f514f[0x0][_0x4011e9(0x173)](()=>({'wpx':0x64})),XLSX[_0x4011e9(0x13b)][_0x4011e9(0x13f)](_0x2cad73,_0x548331,_0x18f6ca[_0x4011e9(0x115)]);});const _0x55f607=XLSX['write'](_0x2cad73,{'bookType':_0x21cd92(0xc1),'type':'buffer'});_0x1846b6['setHeader'](_0x21cd92(0x1b1),_0x21cd92(0x204)),_0x1846b6['setHeader']('Content-Type',_0x21cd92(0x102)),_0x1846b6[_0x21cd92(0xed)](_0x55f607);}catch(_0x3c84cf){_0x1846b6[_0x21cd92(0x117)](_0x3c84cf);}}),router[a0_0x4019cd(0x228)](a0_0x4019cd(0x1c7),auth,async(_0x3fef0a,_0x438906)=>{const _0x4f1197=a0_0x4019cd,{from_date:_0x5d1ad2,agent_id:_0x5a12ae}=_0x3fef0a[_0x4f1197(0x15b)],_0x233925=_0x3fef0a[_0x4f1197(0x10f)],_0x5751d3=await staff[_0x4f1197(0x163)]({'email':_0x233925[_0x4f1197(0x1ee)]}),_0x122c55=await master_shop[_0x4f1197(0x15a)](),_0x1f8050=await agentsdataDSICheck_DSRR(_0x5d1ad2,_0x5a12ae,_0x19c643);let _0x1c2667=_0x4f1197(0x218);var _0x3d8283=new Date(_0x5d1ad2);const _0x56c7e5={'year':_0x4f1197(0x182),'month':'long','day':_0x4f1197(0x182)},_0x580a1a=new Intl[(_0x4f1197(0x17d))](_0x4f1197(0x1cb),_0x56c7e5)[_0x4f1197(0x119)](_0x3d8283);_0x1c2667+=_0x4f1197(0x166),_0x1c2667+=_0x4f1197(0x1f8),_0x1c2667+=_0x4f1197(0x20c),_0x1c2667+=_0x1f8050,_0x1c2667+=_0x4f1197(0x1b0),_0x1c2667+=_0x4f1197(0x1ec),_0x1c2667+=_0x4f1197(0x1ec);let _0x19c79e=_0x4f1197(0xe5);const _0x3fa289={'width':_0x4f1197(0x1bf),'height':_0x4f1197(0x19f),'orientation':'landscape','border':{'top':_0x4f1197(0x210),'right':_0x4f1197(0x210),'bottom':_0x4f1197(0x210),'left':_0x4f1197(0x210)},'header':{'height':'60mm','contents':_0x4f1197(0x1fa)+_0x19c79e+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x580a1a+_0x4f1197(0x19a)},'footer':{'height':_0x4f1197(0x1f5),'contents':{'default':_0x4f1197(0x121)}},'dpi':0x5,'zoomFactor':'1'};var _0x19c643='on';if(_0x19c643=='on'){const _0x2a9899=cheerio[_0x4f1197(0xd8)](_0x1c2667);let _0x5c7734=[],_0x24efc7=[],_0x21bd39=[];_0x2a9899(_0x4f1197(0x109))[_0x4f1197(0xda)]((_0x40d78a,_0x36ae41)=>{const _0x3efff1=_0x4f1197;let _0x3142c5=[],_0x395b5e=0x0;while(_0x21bd39[_0x395b5e]){_0x21bd39[_0x395b5e]--,_0x395b5e++;}_0x2a9899(_0x36ae41)[_0x3efff1(0x15a)](_0x3efff1(0x170))[_0x3efff1(0xda)]((_0x1ecc72,_0x5c1f52)=>{const _0x3cfaf1=_0x3efff1;let _0x354a17=_0x2a9899(_0x5c1f52)['text']()['trim'](),_0x3fd9a6=parseFloat(_0x354a17['replace'](/,/g,''));isNaN(_0x3fd9a6)&&(_0x3fd9a6=_0x354a17);let _0x5d5f97=parseInt(_0x2a9899(_0x5c1f52)['attr'](_0x3cfaf1(0x22e)))||0x1,_0x272aff=parseInt(_0x2a9899(_0x5c1f52)[_0x3cfaf1(0xbe)](_0x3cfaf1(0x15e)))||0x1;_0x3142c5[_0x395b5e]=_0x3fd9a6;(_0x5d5f97>0x1||_0x272aff>0x1)&&_0x24efc7[_0x3cfaf1(0x1d8)]({'s':{'r':_0x40d78a,'c':_0x395b5e},'e':{'r':_0x40d78a+_0x272aff-0x1,'c':_0x395b5e+_0x5d5f97-0x1}});for(let _0x1366a1=0x0;_0x1366a1<_0x5d5f97;_0x1366a1++){_0x272aff>0x1&&(_0x21bd39[_0x395b5e+_0x1366a1]=_0x272aff-0x1);}_0x395b5e+=_0x5d5f97;}),_0x5c7734[_0x3efff1(0x1d8)](_0x3142c5);});const _0x56e67b=XLSX[_0x4f1197(0x13b)][_0x4f1197(0xec)](),_0x105a24=XLSX[_0x4f1197(0x13b)][_0x4f1197(0x12f)](_0x5c7734);_0x24efc7[_0x4f1197(0x1d7)]>0x0&&(_0x105a24[_0x4f1197(0xcf)]=_0x24efc7);_0x105a24[_0x4f1197(0x200)]=_0x5c7734[0x0][_0x4f1197(0x173)](()=>({'wpx':0x64})),XLSX[_0x4f1197(0x13b)][_0x4f1197(0x13f)](_0x56e67b,_0x105a24,_0x4f1197(0x1e9));const _0x22764d=XLSX[_0x4f1197(0xd2)](_0x56e67b,{'bookType':'xlsx','type':_0x4f1197(0x174)});_0x438906[_0x4f1197(0x103)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x438906[_0x4f1197(0x103)](_0x4f1197(0x162),_0x4f1197(0x102)),_0x438906['send'](_0x22764d);}else pdf[_0x4f1197(0x1eb)](_0x1c2667,_0x3fa289)[_0x4f1197(0x1e3)](function(_0x206868,_0x55bb6d){const _0xd6e713=_0x4f1197;if(_0x206868){_0x438906[_0xd6e713(0x10a)](0x1f4)[_0xd6e713(0xed)](_0xd6e713(0x1d3));return;}_0x438906['setHeader'](_0xd6e713(0x162),_0xd6e713(0x1c0)),_0x55bb6d['pipe'](_0x438906);});}),module[a0_0x4019cd(0x215)]=router;