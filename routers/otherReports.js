const a0_0x400c41=a0_0x29cf;(function(_0x54ea36,_0x4ac001){const _0x2a64a4=a0_0x29cf,_0x1a321f=_0x54ea36();while(!![]){try{const _0x5f3fda=parseInt(_0x2a64a4(0x1d0))/0x1*(-parseInt(_0x2a64a4(0x1b3))/0x2)+-parseInt(_0x2a64a4(0x1bf))/0x3+parseInt(_0x2a64a4(0x1ee))/0x4*(-parseInt(_0x2a64a4(0xd4))/0x5)+parseInt(_0x2a64a4(0x194))/0x6*(-parseInt(_0x2a64a4(0x1b7))/0x7)+parseInt(_0x2a64a4(0x15f))/0x8*(parseInt(_0x2a64a4(0x21b))/0x9)+parseInt(_0x2a64a4(0x202))/0xa+parseInt(_0x2a64a4(0x19a))/0xb;if(_0x5f3fda===_0x4ac001)break;else _0x1a321f['push'](_0x1a321f['shift']());}catch(_0x3bd67b){_0x1a321f['push'](_0x1a321f['shift']());}}}(a0_0x5624,0xd1b6a));const express=require(a0_0x400c41(0x92)),res=require(a0_0x400c41(0x1d4)),app=express(),router=express[a0_0x400c41(0xf2)](),multer=require(a0_0x400c41(0x1cd)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x400c41(0x11c)),auth=require(a0_0x400c41(0x206)),users=require(a0_0x400c41(0x103)),excelJS=require(a0_0x400c41(0xbe)),XLSX=require(a0_0x400c41(0xd3)),PDFDocument=require(a0_0x400c41(0xa8)),fs=require('fs'),blobStream=require(a0_0x400c41(0x106)),JsBarcode=require(a0_0x400c41(0xed)),{Canvas}=require(a0_0x400c41(0x19e)),pdf=require(a0_0x400c41(0x1de)),path=require(a0_0x400c41(0xef)),mongoose=require(a0_0x400c41(0x126)),cheerio=require(a0_0x400c41(0x12a));router[a0_0x400c41(0x127)]('/balance/view',auth,async(_0x28fda5,_0x932e53)=>{const _0x328a7a=a0_0x400c41;try{const {username:_0x31f983,email:_0x5b61bd,role:_0x498604}=_0x28fda5[_0x328a7a(0xd7)],_0x21e2e7=_0x28fda5[_0x328a7a(0xd7)],_0x19bb0a=await profile[_0x328a7a(0x1da)]({'email':_0x21e2e7[_0x328a7a(0x182)]}),_0x3d401a={'year':_0x328a7a(0x1c1),'month':_0x328a7a(0x1a3),'day':_0x328a7a(0x1c1)},_0x41a94f=await master_shop[_0x328a7a(0xcd)]();console[_0x328a7a(0x18e)](_0x328a7a(0x118),_0x41a94f);const _0x3671b3=await product['find']();console['log'](_0x328a7a(0xe9),_0x3671b3);const _0x5131a3=await warehouse[_0x328a7a(0x186)]([{'$unwind':_0x328a7a(0xfe)},{'$lookup':{'from':_0x328a7a(0x142),'localField':_0x328a7a(0x18b),'foreignField':_0x328a7a(0x1bd),'as':_0x328a7a(0xd6)}},{'$unwind':_0x328a7a(0x199)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x328a7a(0x15b),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x328a7a(0x18e)](_0x328a7a(0x16d),_0x5131a3),_0x5131a3[_0x328a7a(0x8a)](_0x39110e=>{const _0x521aa2=_0x328a7a,_0x1891f5=_0x3671b3[_0x521aa2(0x124)](_0x54bcd3=>{const _0x3ff12c=_0x521aa2;_0x54bcd3['name']==_0x39110e[_0x3ff12c(0x192)]&&(_0x54bcd3[_0x3ff12c(0x96)]=parseInt(_0x54bcd3[_0x3ff12c(0x96)])+parseInt(_0x39110e[_0x3ff12c(0x16c)]));});}),console['log']('Products\x20find_data',_0x3671b3);if(_0x41a94f[0x0][_0x328a7a(0x1fc)]==_0x328a7a(0x145))var _0x563caf=users['English'];else{if(_0x41a94f[0x0][_0x328a7a(0x1fc)]==_0x328a7a(0xe4))var _0x563caf=users['Hindi'];else{if(_0x41a94f[0x0]['language']==_0x328a7a(0x90))var _0x563caf=users[_0x328a7a(0x90)];else{if(_0x41a94f[0x0][_0x328a7a(0x1fc)]==_0x328a7a(0x117))var _0x563caf=users[_0x328a7a(0x117)];else{if(_0x41a94f[0x0]['language']==_0x328a7a(0x177))var _0x563caf=users[_0x328a7a(0x177)];else{if(_0x41a94f[0x0]['language']=='Portuguese\x20(BR)')var _0x563caf=users[_0x328a7a(0x1a9)];else{if(_0x41a94f[0x0][_0x328a7a(0x1fc)]==_0x328a7a(0x18f))var _0x563caf=users[_0x328a7a(0x18f)];else{if(_0x41a94f[0x0][_0x328a7a(0x1fc)]==_0x328a7a(0x15a))var _0x563caf=users[_0x328a7a(0xb9)];}}}}}}}_0x932e53[_0x328a7a(0xc0)](_0x328a7a(0x196),{'success':_0x28fda5[_0x328a7a(0x211)](_0x328a7a(0xc2)),'errors':_0x28fda5[_0x328a7a(0x211)]('errors'),'alldata':_0x3671b3,'profile':_0x19bb0a,'master_shop':_0x41a94f,'role':_0x21e2e7,'product_stock':_0x5131a3,'language':_0x563caf});}catch(_0x357baa){}});async function dataCheck(_0x512a5b,_0x27b828){const _0x2ebd22=a0_0x400c41,_0x19224c=await product[_0x2ebd22(0x186)]([{'$group':{'_id':{'brand':_0x2ebd22(0x10f),'category':_0x2ebd22(0xcc)},'products':{'$push':{'name':'$name','product_code':_0x2ebd22(0x1a1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2fdc9a=[];_0x2fdc9a[_0x2ebd22(0xa0)]=[];for(let _0x2aa3ac=0x0;_0x2aa3ac<=_0x19224c[_0x2ebd22(0xd8)]-0x1;_0x2aa3ac++){const _0x579b32=_0x19224c[_0x2aa3ac];_0x2fdc9a['cat_brand'][_0x2ebd22(0x1b5)](_0x579b32);}const _0x16d379=await product[_0x2ebd22(0x186)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x4eb5a1=await purchases_finished[_0x2ebd22(0x186)]([{'$match':{'date':{'$gte':_0x512a5b,'$lte':_0x27b828}}},{'$unwind':_0x2ebd22(0x19d)},{'$group':{'_id':{'product_name':_0x2ebd22(0x151),'product_code':'$product.product_code'},'totalQTY':{'$sum':_0x2ebd22(0x98)}}}]);_0x2fdc9a[_0x2ebd22(0x15c)]=[];for(let _0x16c15c=0x0;_0x16c15c<=_0x4eb5a1[_0x2ebd22(0xd8)]-0x1;_0x16c15c++){const _0x6f85ef=_0x4eb5a1[_0x16c15c];_0x2fdc9a['beg_bal'][_0x2ebd22(0x1b5)](_0x6f85ef);}const _0x968c5e=await sales_sa[_0x2ebd22(0x186)]([{'$match':{'date':{'$gte':_0x512a5b,'$lte':_0x27b828}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x2ebd22(0x123)}}},{'$lookup':{'from':_0x2ebd22(0x215),'localField':'sales_staff_id','foreignField':'_id','as':_0x2ebd22(0xc5)}},{'$unwind':_0x2ebd22(0x170)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x2ebd22(0x203),'product_code':_0x2ebd22(0x1e8)},'totalQTY':{'$sum':_0x2ebd22(0x91)}}}]);console[_0x2ebd22(0x18e)](_0x968c5e[0x0]),_0x2fdc9a[_0x2ebd22(0x1a7)]=[];for(let _0x2c4f5b=0x0;_0x2c4f5b<=_0x968c5e[_0x2ebd22(0xd8)]-0x1;_0x2c4f5b++){const _0x5dc7d0=_0x968c5e[_0x2c4f5b];_0x2fdc9a[_0x2ebd22(0x1a7)]['push'](_0x5dc7d0);}const _0x1e2c25=await sales_sa[_0x2ebd22(0x186)]([{'$match':{'date':{'$gte':_0x512a5b,'$lte':_0x27b828}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x2ebd22(0x215),'localField':'sales_staff_id','foreignField':'_id','as':'sales_info'}},{'$unwind':_0x2ebd22(0x170)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x2ebd22(0xbf)}},{'$group':{'_id':{'product_name':_0x2ebd22(0x203),'product_code':_0x2ebd22(0x1e8)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'}}}]);_0x2fdc9a[_0x2ebd22(0x165)]=[];for(let _0x235fe3=0x0;_0x235fe3<=_0x1e2c25[_0x2ebd22(0xd8)]-0x1;_0x235fe3++){const _0x3b7a6f=_0x1e2c25[_0x235fe3];_0x2fdc9a[_0x2ebd22(0x165)][_0x2ebd22(0x1b5)](_0x3b7a6f);}let _0x20d76b='';for(let _0x4819e4=0x0;_0x4819e4<=_0x16d379[_0x2ebd22(0xd8)]-0x1;_0x4819e4++){const _0x9f08d3=_0x16d379[_0x4819e4];_0x20d76b+=_0x2ebd22(0xa6),_0x20d76b+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x9f08d3[_0x2ebd22(0x192)]['category']+_0x2ebd22(0x133),_0x20d76b+=_0x2ebd22(0x11f);for(let _0x5c7c0f=0x0;_0x5c7c0f<_0x2fdc9a[_0x2ebd22(0xa0)][_0x2ebd22(0xd8)];_0x5c7c0f++){const _0x31bc00=_0x2fdc9a[_0x2ebd22(0xa0)][_0x5c7c0f];if(_0x31bc00[_0x2ebd22(0x192)][_0x2ebd22(0x207)]==_0x9f08d3[_0x2ebd22(0x192)][_0x2ebd22(0x207)]){let _0x4412de=[],_0x5f1525=[],_0x29a877=[];_0x4412de[_0x31bc00['_id'][_0x2ebd22(0x191)]]=[],_0x5f1525[_0x31bc00[_0x2ebd22(0x192)]['brand']]=[],_0x29a877[_0x31bc00[_0x2ebd22(0x192)][_0x2ebd22(0x191)]]=[];var _0x1b02aa=0x0,_0x34933b=0x0,_0x425066=0x0;for(let _0x1b5cb6=0x0;_0x1b5cb6<_0x31bc00[_0x2ebd22(0x142)][_0x2ebd22(0xd8)];_0x1b5cb6++){const _0x3ced64=_0x31bc00[_0x2ebd22(0x142)][_0x1b5cb6];for(let _0x231ea3=0x0;_0x231ea3<=_0x2fdc9a[_0x2ebd22(0x15c)][_0x2ebd22(0xd8)]-0x1;_0x231ea3++){const _0x207507=_0x2fdc9a['beg_bal'][_0x231ea3];_0x207507[_0x2ebd22(0x192)][_0x2ebd22(0xb6)]==_0x3ced64[_0x2ebd22(0x1bd)]&&_0x207507[_0x2ebd22(0x192)][_0x2ebd22(0x11d)]==_0x3ced64[_0x2ebd22(0x11d)]&&(_0x1b02aa+=parseInt(_0x207507['totalQTY'],0xa));}for(let _0x3958ad=0x0;_0x3958ad<=_0x2fdc9a[_0x2ebd22(0x165)]['length']-0x1;_0x3958ad++){const _0x2c5819=_0x2fdc9a[_0x2ebd22(0x165)][_0x3958ad];_0x2c5819['_id'][_0x2ebd22(0xb6)]==_0x3ced64['name']&&_0x2c5819[_0x2ebd22(0x192)]['product_code']==_0x3ced64[_0x2ebd22(0x11d)]&&(_0x34933b+=parseFloat(_0x2c5819[_0x2ebd22(0xa9)],0xa)['toFixed'](0x2));}for(let _0x440318=0x0;_0x440318<=_0x2fdc9a[_0x2ebd22(0x1a7)][_0x2ebd22(0xd8)]-0x1;_0x440318++){const _0x6491dc=_0x2fdc9a[_0x2ebd22(0x1a7)][_0x440318];_0x6491dc[_0x2ebd22(0x192)]['product_name']==_0x3ced64[_0x2ebd22(0x1bd)]&&_0x6491dc[_0x2ebd22(0x192)][_0x2ebd22(0x11d)]==_0x3ced64['product_code']&&(_0x425066+=parseInt(_0x6491dc[_0x2ebd22(0xa9)],0xa));}}const _0x38d626=new Intl[(_0x2ebd22(0x13b))](_0x2ebd22(0x1cf));var _0xf89dfe=_0x38d626[_0x2ebd22(0x1d3)](_0x1b02aa);_0x4412de[_0x31bc00[_0x2ebd22(0x192)][_0x2ebd22(0x191)]][_0x2ebd22(0x1b5)](_0xf89dfe),_0x5f1525[_0x31bc00[_0x2ebd22(0x192)][_0x2ebd22(0x191)]][_0x2ebd22(0x1b5)](_0x38d626['format'](_0x34933b)),_0x29a877[_0x31bc00[_0x2ebd22(0x192)]['brand']][_0x2ebd22(0x1b5)](_0x38d626['format'](_0x425066));var _0x4c4ad1=_0x38d626[_0x2ebd22(0x1d3)](_0x1b02aa-(_0x425066+_0x34933b));_0x20d76b+='<tr>',_0x20d76b+=_0x2ebd22(0x136),_0x20d76b+=_0x2ebd22(0xf3)+_0x31bc00[_0x2ebd22(0x192)][_0x2ebd22(0x191)]+_0x2ebd22(0x133),_0x20d76b+='<td\x20class=\x22row_data\x22>'+_0x4412de[_0x31bc00[_0x2ebd22(0x192)][_0x2ebd22(0x191)]][0x0]+_0x2ebd22(0x133),_0x20d76b+='<td\x20class=\x22row_data\x22>0</td>',_0x20d76b+=_0x2ebd22(0xf3)+_0x29a877[_0x31bc00[_0x2ebd22(0x192)]['brand']][0x0]+_0x2ebd22(0x133),_0x20d76b+=_0x2ebd22(0xf3)+_0x5f1525[_0x31bc00[_0x2ebd22(0x192)][_0x2ebd22(0x191)]][0x0]+_0x2ebd22(0x133),_0x20d76b+=_0x2ebd22(0xf3)+_0x4c4ad1+_0x2ebd22(0x133),_0x20d76b+=_0x2ebd22(0x11f);}}}return console[_0x2ebd22(0x18e)](_0x2fdc9a['sales_bkg']),_0x20d76b;}router[a0_0x400c41(0x1cc)]('/balance/pdf',auth,async(_0x4c61f0,_0x1b50b9)=>{const _0x509144=a0_0x400c41,{from_date:_0x2884d5,to_date:_0x4acb4c}=_0x4c61f0[_0x509144(0x97)],_0x37db41=await dataCheck(_0x2884d5,_0x4acb4c);{}let _0x339bf6=_0x509144(0x154);var _0x3d992d=new Date(_0x2884d5),_0x4662d1=new Date(_0x4acb4c);const _0x2224ea={'year':_0x509144(0x1c1),'month':_0x509144(0x1a3),'day':_0x509144(0x1c1)},_0x32dd62=new Intl['DateTimeFormat'](_0x509144(0x1cf),_0x2224ea)[_0x509144(0x1d3)](_0x3d992d),_0x550754=new Intl[(_0x509144(0x212))]('en-US',_0x2224ea)[_0x509144(0x1d3)](_0x4662d1);_0x339bf6+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x339bf6+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x339bf6+=_0x509144(0x20d)+_0x32dd62+_0x509144(0x1ca)+_0x550754+_0x509144(0xe8),_0x339bf6+='<div\x20class=\x22row\x22>',_0x339bf6+=_0x509144(0x1b0),_0x339bf6+='<table>',_0x339bf6+=_0x509144(0xa6),_0x339bf6+=_0x509144(0x20c),_0x339bf6+=_0x509144(0xb4),_0x339bf6+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x32dd62+'</th>',_0x339bf6+='<th\x20rowspan=\x272\x27>Production</th>',_0x339bf6+=_0x509144(0x1cb),_0x339bf6+=_0x509144(0x9a)+_0x550754+_0x509144(0x95),_0x339bf6+=_0x509144(0x11f),_0x339bf6+=_0x509144(0xa6),_0x339bf6+=_0x509144(0x9f),_0x339bf6+=_0x509144(0x217),_0x339bf6+='</tr>',_0x339bf6+=_0x37db41,_0x339bf6+=_0x509144(0x99),_0x339bf6+=_0x509144(0xf0),_0x339bf6+=_0x509144(0xf0);const _0x3693a9={'format':_0x509144(0x10c),'orientation':_0x509144(0x16a),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x509144(0x143)}}};pdf[_0x509144(0x11b)](_0x339bf6,_0x3693a9)[_0x509144(0x137)](function(_0x899dbd,_0x124ab9){const _0x3a2aef=_0x509144;if(_0x899dbd){_0x1b50b9[_0x3a2aef(0x1e7)](0x1f4)['send'](_0x3a2aef(0x1e0));return;}_0x1b50b9[_0x3a2aef(0x12e)](_0x3a2aef(0x100),_0x3a2aef(0x1b6)),_0x124ab9[_0x3a2aef(0x14d)](_0x1b50b9);});}),router[a0_0x400c41(0x127)](a0_0x400c41(0xe0),auth,async(_0x1e5471,_0x304944)=>{const _0xfd098d=a0_0x400c41;try{const {username:_0x4e0cc6,email:_0x3ee236,role:_0x26cf91}=_0x1e5471['user'],_0x3e9ca2=_0x1e5471[_0xfd098d(0xd7)],_0x2a9925=await profile['findOne']({'email':_0x3e9ca2[_0xfd098d(0x182)]}),_0x1d5cfe={'year':_0xfd098d(0x1c1),'month':'long','day':_0xfd098d(0x1c1)},_0x17b614=await master_shop['find'](),_0xfbf337=await product[_0xfd098d(0xcd)](),_0x3421e8=await warehouse['aggregate']([{'$unwind':_0xfd098d(0xfe)},{'$lookup':{'from':_0xfd098d(0x142),'localField':'product_details.product_name','foreignField':_0xfd098d(0x1bd),'as':_0xfd098d(0xd6)}},{'$unwind':_0xfd098d(0x199)},{'$project':{'product_name':_0xfd098d(0x1f9),'product_stock':_0xfd098d(0x1ef)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0xfd098d(0x10b)}}}]);if(_0x17b614[0x0]['language']==_0xfd098d(0x145))var _0x4dce08=users[_0xfd098d(0x110)];else{if(_0x17b614[0x0]['language']==_0xfd098d(0xe4))var _0x4dce08=users[_0xfd098d(0xe4)];else{if(_0x17b614[0x0][_0xfd098d(0x1fc)]==_0xfd098d(0x90))var _0x4dce08=users[_0xfd098d(0x90)];else{if(_0x17b614[0x0][_0xfd098d(0x1fc)]=='Spanish')var _0x4dce08=users[_0xfd098d(0x117)];else{if(_0x17b614[0x0]['language']==_0xfd098d(0x177))var _0x4dce08=users[_0xfd098d(0x177)];else{if(_0x17b614[0x0]['language']==_0xfd098d(0x108))var _0x4dce08=users['Portuguese'];else{if(_0x17b614[0x0][_0xfd098d(0x1fc)]==_0xfd098d(0x18f))var _0x4dce08=users[_0xfd098d(0x18f)];else{if(_0x17b614[0x0]['language']==_0xfd098d(0x15a))var _0x4dce08=users['Arabic'];}}}}}}}_0x304944['render'](_0xfd098d(0x155),{'success':_0x1e5471[_0xfd098d(0x211)]('success'),'errors':_0x1e5471[_0xfd098d(0x211)](_0xfd098d(0x16b)),'alldata':_0xfbf337,'profile':_0x2a9925,'master_shop':_0x17b614,'role':_0x3e9ca2,'product_stock':_0x3421e8,'language':_0x4dce08});}catch(_0x135da4){}});async function agentsdataCheck(_0x244fec,_0x517d9f){const _0x6511f7=a0_0x400c41,_0x59940a=await product[_0x6511f7(0x186)]([{'$group':{'_id':{'brand':_0x6511f7(0x10f),'category':'$category'},'products':{'$push':{'name':_0x6511f7(0xda),'product_code':_0x6511f7(0x1a1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x32bbd5=[];_0x32bbd5['cat_brand']=[];for(let _0x22d9e0=0x0;_0x22d9e0<=_0x59940a[_0x6511f7(0xd8)]-0x1;_0x22d9e0++){const _0x27ac95=_0x59940a[_0x22d9e0];_0x32bbd5[_0x6511f7(0xa0)][_0x6511f7(0x1b5)](_0x27ac95);}const _0x3b9163=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x6511f7(0x10f),'product_code':_0x6511f7(0x1a1),'product_name':_0x6511f7(0xda)}}}},{'$sort':{'_id.category':-0x1}}]),_0x59188c=await product[_0x6511f7(0x186)]([{'$group':{'_id':{'category':_0x6511f7(0xcc),'brand':_0x6511f7(0x10f)}}},{'$group':{'_id':_0x6511f7(0x17a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x49c66c=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x244fec,'$lte':_0x517d9f}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x6511f7(0x123)}}},{'$lookup':{'from':_0x6511f7(0x215),'localField':'sales_staff_id','foreignField':_0x6511f7(0x192),'as':_0x6511f7(0xc5)}},{'$unwind':_0x6511f7(0x170)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x6511f7(0xbf)}},{'$lookup':{'from':'products','localField':_0x6511f7(0x121),'foreignField':_0x6511f7(0x11d),'as':_0x6511f7(0x19c)}},{'$unwind':_0x6511f7(0x1dd)},{'$group':{'_id':{'sales_id':_0x6511f7(0x9e),'category':_0x6511f7(0x14e),'brand':_0x6511f7(0x1d5)},'salesman_data':{'$first':_0x6511f7(0x1bb)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x6511f7(0x169),'product_details':{'prod_name':'$product_info.name','product_code':_0x6511f7(0x1a0),'category':_0x6511f7(0x14e),'brand':'$product_info.brand'}}}}}]);let _0x3229dc='';_0x3229dc+=_0x6511f7(0xa6),_0x3229dc+=_0x6511f7(0x195),_0x3229dc+=_0x6511f7(0x11f),_0x3229dc+=_0x6511f7(0xa6),_0x3229dc+=_0x6511f7(0x1e5);for(let _0x529543=0x0;_0x529543<=_0x3b9163[_0x6511f7(0xd8)]-0x1;_0x529543++){const _0x228234=_0x3b9163[_0x529543];for(let _0x2e9e15=0x0;_0x2e9e15<_0x59188c['length'];_0x2e9e15++){const _0x16254c=_0x59188c[_0x2e9e15];_0x16254c['_id']==_0x228234['_id']['category']&&(_0x3229dc+='<td\x20colspan=\x22'+_0x16254c[_0x6511f7(0x1c2)]+_0x6511f7(0xc9)+_0x228234[_0x6511f7(0x192)]['category']+_0x6511f7(0x133));}}_0x3229dc+=_0x6511f7(0x1e5),_0x3229dc+=_0x6511f7(0x11f),_0x3229dc+=_0x6511f7(0xa6),_0x3229dc+=_0x6511f7(0x1f2);for(let _0x2e2341=0x0;_0x2e2341<=_0x3b9163[_0x6511f7(0xd8)]-0x1;_0x2e2341++){const _0x55fd29=_0x3b9163[_0x2e2341];for(let _0x1bfdd1=0x0;_0x1bfdd1<_0x32bbd5['cat_brand'][_0x6511f7(0xd8)];_0x1bfdd1++){const _0x21f54f=_0x32bbd5[_0x6511f7(0xa0)][_0x1bfdd1];_0x21f54f[_0x6511f7(0x192)]['category']==_0x55fd29['_id'][_0x6511f7(0x207)]&&(_0x3229dc+=_0x6511f7(0xce)+_0x21f54f['_id'][_0x6511f7(0x191)]+_0x6511f7(0x133));}}_0x3229dc+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x3229dc+=_0x6511f7(0x11f);let _0x2dba13={'name':[],'dataqty':{}};for(let _0x289f32=0x0;_0x289f32<_0x32bbd5[_0x6511f7(0xa0)][_0x6511f7(0xd8)];_0x289f32++){const _0x48c8b0=_0x32bbd5[_0x6511f7(0xa0)][_0x289f32],_0x63d859=_0x48c8b0[_0x6511f7(0x192)][_0x6511f7(0x191)],_0x4542b0=_0x48c8b0['_id']['category'];!_0x2dba13['dataqty'][_0x63d859]&&(_0x2dba13[_0x6511f7(0x216)][_0x63d859]={});!_0x2dba13[_0x6511f7(0x216)][_0x63d859][_0x4542b0]&&(_0x2dba13['dataqty'][_0x63d859][_0x4542b0]=[]);for(let _0x34fb4c=0x0;_0x34fb4c<_0x49c66c[_0x6511f7(0xd8)];_0x34fb4c++){const _0x18395a=_0x49c66c[_0x34fb4c];if(_0x63d859===_0x18395a['_id'][_0x6511f7(0x191)]&&_0x4542b0===_0x18395a['_id'][_0x6511f7(0x207)]){const _0x337423=_0x18395a['salesman_data'];!_0x2dba13[_0x6511f7(0x216)][_0x63d859][_0x4542b0][_0x337423]&&(_0x2dba13[_0x6511f7(0x216)][_0x63d859][_0x4542b0][_0x337423]=[]),_0x2dba13[_0x6511f7(0x216)][_0x63d859][_0x4542b0][_0x337423][_0x6511f7(0x1b5)](_0x18395a[_0x6511f7(0xa9)]),!_0x2dba13[_0x6511f7(0x1bd)][_0x6511f7(0xea)](_0x337423)&&_0x2dba13[_0x6511f7(0x1bd)]['push'](_0x337423);}}}_0x3229dc+=_0x6511f7(0xa6);for(let _0x3b38e7=0x0;_0x3b38e7<=_0x2dba13['name']['length']-0x1;_0x3b38e7++){const _0x247522=_0x2dba13[_0x6511f7(0x1bd)][_0x3b38e7];_0x3229dc+='<td\x20class=\x22row_data\x22>'+_0x247522+_0x6511f7(0x133);var _0x49a15d=0x0,_0x46919c=0x0;for(let _0x4b657d=0x0;_0x4b657d<=_0x32bbd5[_0x6511f7(0xa0)]['length']-0x1;_0x4b657d++){const _0x44e47f=_0x32bbd5['cat_brand'][_0x4b657d];var _0x5f16ae=0x0;_0x2dba13[_0x6511f7(0x216)][_0x44e47f[_0x6511f7(0x192)]['brand']][_0x44e47f[_0x6511f7(0x192)][_0x6511f7(0x207)]][_0x247522]?(_0x5f16ae=_0x2dba13[_0x6511f7(0x216)][_0x44e47f[_0x6511f7(0x192)][_0x6511f7(0x191)]][_0x44e47f[_0x6511f7(0x192)]['category']][_0x247522][0x0],_0x3229dc+=_0x6511f7(0xf3)+formatNumber(_0x5f16ae['toFixed'](0x2))+_0x6511f7(0x133)):(_0x5f16ae=0x0,_0x3229dc+=_0x6511f7(0xf3)+_0x5f16ae+_0x6511f7(0x133)),_0x49a15d+=_0x5f16ae;}_0x3229dc+=_0x6511f7(0xf3)+formatNumber(_0x49a15d[_0x6511f7(0xa5)](0x2))+_0x6511f7(0x133);}return _0x3229dc+='</tr>',_0x3229dc;}router[a0_0x400c41(0x1cc)]('/agent/pdf',auth,async(_0x45556d,_0x217b71)=>{const _0x41cdab=a0_0x400c41,{from_date:_0x2fdda0,to_date:_0x4ef010}=_0x45556d['body'],_0x3f2f0a=await agentsdataCheck(_0x2fdda0,_0x4ef010);{}let _0xb9a5e5=_0x41cdab(0x181);var _0x1a4bf4=new Date(_0x2fdda0),_0x350caa=new Date(_0x4ef010);const _0x4fb055={'year':_0x41cdab(0x1c1),'month':'long','day':_0x41cdab(0x1c1)},_0x2735b1=new Intl[(_0x41cdab(0x212))](_0x41cdab(0x1cf),_0x4fb055)[_0x41cdab(0x1d3)](_0x1a4bf4),_0x423097=new Intl['DateTimeFormat'](_0x41cdab(0x1cf),_0x4fb055)[_0x41cdab(0x1d3)](_0x350caa);_0xb9a5e5+=_0x41cdab(0x1a5),_0xb9a5e5+='<p>SALES\x20REPORTS</p>',_0xb9a5e5+=_0x41cdab(0x20d)+_0x2735b1+_0x41cdab(0x1ca)+_0x423097+'</p>',_0xb9a5e5+=_0x41cdab(0x1f1),_0xb9a5e5+='<div\x20class=\x22col-sm-11\x22>',_0xb9a5e5+='<table>',_0xb9a5e5+=_0x3f2f0a,_0xb9a5e5+=_0x41cdab(0x99),_0xb9a5e5+=_0x41cdab(0xf0),_0xb9a5e5+=_0x41cdab(0xf0);const _0x4c4972={'format':_0x41cdab(0x10c),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x41cdab(0x143)}}};pdf[_0x41cdab(0x11b)](_0xb9a5e5,_0x4c4972)[_0x41cdab(0x137)](function(_0x3a9638,_0x33e113){const _0x3a968b=_0x41cdab;if(_0x3a9638){_0x217b71[_0x3a968b(0x1e7)](0x1f4)[_0x3a968b(0x1d7)](_0x3a968b(0x1e0));return;}_0x217b71[_0x3a968b(0x12e)](_0x3a968b(0x100),_0x3a968b(0x1b6)),_0x33e113[_0x3a968b(0x14d)](_0x217b71);});}),router[a0_0x400c41(0x127)](a0_0x400c41(0x1ea),auth,async(_0x1589fb,_0x55e38e)=>{const _0x5cea46=a0_0x400c41;try{const {username:_0x32188e,email:_0x3a8c79,role:_0x361348}=_0x1589fb[_0x5cea46(0xd7)],_0x5b29bb=_0x1589fb[_0x5cea46(0xd7)],_0x510a42=await profile[_0x5cea46(0x1da)]({'email':_0x5b29bb[_0x5cea46(0x182)]}),_0x4aaa9f={'year':_0x5cea46(0x1c1),'month':_0x5cea46(0x1a3),'day':'numeric'},_0x5d6a64=await master_shop[_0x5cea46(0xcd)](),_0x1391aa=await staff[_0x5cea46(0x1da)]({'email':_0x5b29bb[_0x5cea46(0x182)]}),_0x3fb8f7=await product[_0x5cea46(0xcd)](),_0x34e192=await warehouse[_0x5cea46(0x186)]([{'$unwind':_0x5cea46(0xfe)},{'$lookup':{'from':_0x5cea46(0x142),'localField':_0x5cea46(0x18b),'foreignField':_0x5cea46(0x1bd),'as':_0x5cea46(0xd6)}},{'$unwind':_0x5cea46(0x199)},{'$project':{'product_name':_0x5cea46(0x1f9),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x5cea46(0x15b),'product_stock':{'$sum':_0x5cea46(0x10b)}}}]),_0x4cb771=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x5d6a64[0x0][_0x5cea46(0x1fc)]==_0x5cea46(0x145))var _0x4ba287=users[_0x5cea46(0x110)];else{if(_0x5d6a64[0x0][_0x5cea46(0x1fc)]==_0x5cea46(0xe4))var _0x4ba287=users['Hindi'];else{if(_0x5d6a64[0x0][_0x5cea46(0x1fc)]==_0x5cea46(0x90))var _0x4ba287=users[_0x5cea46(0x90)];else{if(_0x5d6a64[0x0]['language']=='Spanish')var _0x4ba287=users[_0x5cea46(0x117)];else{if(_0x5d6a64[0x0][_0x5cea46(0x1fc)]==_0x5cea46(0x177))var _0x4ba287=users['French'];else{if(_0x5d6a64[0x0]['language']==_0x5cea46(0x108))var _0x4ba287=users[_0x5cea46(0x1a9)];else{if(_0x5d6a64[0x0][_0x5cea46(0x1fc)]==_0x5cea46(0x18f))var _0x4ba287=users[_0x5cea46(0x18f)];else{if(_0x5d6a64[0x0]['language']=='Arabic\x20(ae)')var _0x4ba287=users['Arabic'];}}}}}}}_0x55e38e['render'](_0x5cea46(0x200),{'success':_0x1589fb[_0x5cea46(0x211)](_0x5cea46(0xc2)),'errors':_0x1589fb[_0x5cea46(0x211)](_0x5cea46(0x16b)),'alldata':_0x3fb8f7,'profile':_0x510a42,'master_shop':_0x5d6a64,'role':_0x5b29bb,'product_stock':_0x34e192,'language':_0x4ba287,'staff_arr':_0x1391aa,'staff_data_all':_0x4cb771});}catch(_0x1f1dcb){_0x55e38e[_0x5cea46(0x114)](_0x1f1dcb);}});async function agentsdataDSICheck_admin(_0x20b011,_0x4f26b6,_0x495e8a,_0x5e8865){const _0x1a3dd2=a0_0x400c41,_0x234460=await product[_0x1a3dd2(0x186)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':_0x1a3dd2(0xda),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1beb3a=[];_0x1beb3a[_0x1a3dd2(0xa0)]=[];for(let _0x10ece2=0x0;_0x10ece2<=_0x234460[_0x1a3dd2(0xd8)]-0x1;_0x10ece2++){const _0x35fbe9=_0x234460[_0x10ece2];_0x1beb3a['cat_brand']['push'](_0x35fbe9);}const _0x1f3461=await product[_0x1a3dd2(0x186)]([{'$group':{'_id':{'category':_0x1a3dd2(0xcc)},'products':{'$push':{'brand':'$brand','product_code':_0x1a3dd2(0x1a1),'product_name':_0x1a3dd2(0xda)}}}},{'$sort':{'_id.category':-0x1}}]),_0x37a4ec=await product[_0x1a3dd2(0x186)]([{'$group':{'_id':{'category':_0x1a3dd2(0xcc),'brand':'$brand'}}},{'$group':{'_id':_0x1a3dd2(0x17a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x58199c=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x20b011,'$lte':_0x4f26b6},'sales_staff_id':_0x495e8a,'sale_product.isFG':_0x1a3dd2(0xbf)}},{'$unwind':_0x1a3dd2(0xde)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x1a3dd2(0x142),'localField':_0x1a3dd2(0x121),'foreignField':_0x1a3dd2(0x11d),'as':_0x1a3dd2(0x19c)}},{'$unwind':_0x1a3dd2(0x1dd)},{'$group':{'_id':{'dsi':_0x1a3dd2(0xf1),'date':'$date','customer':_0x1a3dd2(0x150)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x1a3dd2(0x169),'NetPrice':_0x1a3dd2(0x156),'discount':_0x1a3dd2(0x175),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x1a3dd2(0x164),'product_code':_0x1a3dd2(0x1a0),'category':'$product_info.category','brand':_0x1a3dd2(0x1d5),'gross_price':_0x1a3dd2(0x159)}}}}},{'$unwind':_0x1a3dd2(0x13f)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1a3dd2(0x172),'customer':_0x1a3dd2(0x17f),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x1a3dd2(0xa2)},'totalGross':{'$sum':{'$multiply':[_0x1a3dd2(0xa2),_0x1a3dd2(0x167)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x1a3dd2(0x210)},'adj_discount':{'$sum':_0x1a3dd2(0x188)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x1a3dd2(0xae),'date':_0x1a3dd2(0x172),'customer':_0x1a3dd2(0x17f)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x1a3dd2(0x109)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x1a3dd2(0x1f6)},'adj_discount':{'$sum':_0x1a3dd2(0x1ab)},'products':{'$push':{'qty':_0x1a3dd2(0x162),'category':_0x1a3dd2(0x17a),'brand':_0x1a3dd2(0xcb),'product_details':_0x1a3dd2(0xfe)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2396d1=[],_0x18893b={},_0x3347a7={},_0x19180b={};var _0x43da87=0x0,_0x455e1d=0x0,_0x5dd764=0x0,_0x5666b3=0x0,_0x3f2158=0x0;const _0x32018b=0x6;for(let _0x2da542=0x0;_0x2da542<=_0x58199c[_0x1a3dd2(0xd8)]-0x1;_0x2da542++){const _0x8b1e07=_0x58199c[_0x2da542];let _0x13c9bf=_0x1a3dd2(0xa6);_0x13c9bf+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x8b1e07[_0x1a3dd2(0x192)][_0x1a3dd2(0x139)]+_0x1a3dd2(0x133),_0x13c9bf+=_0x1a3dd2(0x1c5)+_0x8b1e07[_0x1a3dd2(0x192)][_0x1a3dd2(0x1be)]+'</td>',_0x13c9bf+=_0x1a3dd2(0x1c5)+_0x8b1e07[_0x1a3dd2(0x192)]['customer']+_0x1a3dd2(0x133);let _0x4ba250={};var _0x4022b5=0x0;for(let _0x3d19c2=0x0;_0x3d19c2<=_0x8b1e07[_0x1a3dd2(0x142)][_0x1a3dd2(0xd8)]-0x1;_0x3d19c2++){const _0x19c639=_0x8b1e07[_0x1a3dd2(0x142)][_0x3d19c2];_0x4ba250[_0x19c639[_0x1a3dd2(0x191)]+'-'+_0x19c639[_0x1a3dd2(0x207)]]=_0x19c639[_0x1a3dd2(0x115)];const _0x34e78b=_0x19c639[_0x1a3dd2(0x191)]+'-'+_0x19c639[_0x1a3dd2(0x207)];!_0x18893b[_0x34e78b]&&(_0x18893b[_0x34e78b]=0x0),!Array[_0x1a3dd2(0xb1)](_0x19180b[_0x34e78b])&&(_0x19180b[_0x34e78b]=[]),!Array[_0x1a3dd2(0xb1)](_0x19180b[_0x34e78b])&&(_0x19180b[_0x34e78b]=[]),_0x18893b[_0x34e78b]+=_0x19c639[_0x1a3dd2(0x115)],_0x19180b[_0x34e78b][_0x1a3dd2(0x1b5)](_0x19c639['qty']),_0x4022b5++;}console['log'](_0x8b1e07);for(let _0x561562=0x0;_0x561562<=_0x1beb3a[_0x1a3dd2(0xa0)]['length']-0x1;_0x561562++){const _0x4da10d=_0x1beb3a['cat_brand'][_0x561562],_0x2b5588=_0x4da10d[_0x1a3dd2(0x192)][_0x1a3dd2(0x191)]+'-'+_0x4da10d[_0x1a3dd2(0x192)][_0x1a3dd2(0x207)];_0x13c9bf+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x4ba250[_0x2b5588]!==undefined?_0x4ba250[_0x2b5588][_0x1a3dd2(0xa5)](0x2):'')+_0x1a3dd2(0x133);}_0x5dd764=_0x8b1e07[_0x1a3dd2(0xb3)]+_0x8b1e07['adj_discount'],_0x13c9bf+=_0x1a3dd2(0x1fe)+formatNumber(parseFloat(_0x8b1e07[_0x1a3dd2(0x1c7)],0x2)[_0x1a3dd2(0xa5)](0x2))+_0x1a3dd2(0x133),_0x13c9bf+=_0x1a3dd2(0x1fe)+formatNumber(_0x8b1e07[_0x1a3dd2(0xe6)][_0x1a3dd2(0xa5)](0x2))+_0x1a3dd2(0x133),_0x13c9bf+=_0x1a3dd2(0x1fe)+formatNumber(_0x5dd764)+'</td>',_0x13c9bf+=_0x1a3dd2(0x1fe)+formatNumber(_0x8b1e07[_0x1a3dd2(0xfb)]['toFixed'](0x2))+_0x1a3dd2(0x133),_0x13c9bf+='</tr>',_0x43da87+=parseFloat(_0x8b1e07[_0x1a3dd2(0x1c7)][_0x1a3dd2(0xa5)](0x2)),_0x455e1d+=parseFloat(_0x8b1e07[_0x1a3dd2(0xfb)][_0x1a3dd2(0xa5)](0x2)),_0x5666b3+=_0x5dd764,_0x3f2158+=parseFloat(_0x8b1e07[_0x1a3dd2(0xe6)][_0x1a3dd2(0xa5)](0x2));if(_0x2da542==_0x58199c[_0x1a3dd2(0xd8)]-0x1){_0x13c9bf+='<tr>',_0x13c9bf+=_0x1a3dd2(0xd5),_0x13c9bf+=_0x1a3dd2(0x133);for(let _0x2c472e=0x0;_0x2c472e<=_0x1beb3a[_0x1a3dd2(0xa0)][_0x1a3dd2(0xd8)]-0x1;_0x2c472e++){const _0x1b38f6=_0x1beb3a[_0x1a3dd2(0xa0)][_0x2c472e],_0x2a33b1=_0x1b38f6[_0x1a3dd2(0x192)]['brand']+'-'+_0x1b38f6['_id']['category'],_0xc4be75=_0x19180b[_0x2a33b1][_0x1a3dd2(0x122)]((_0x811724,_0x36d1e8)=>_0x811724+_0x36d1e8,0x0);console['log'](_0x1a3dd2(0x131),_0x2a33b1),_0x13c9bf+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0xc4be75!==undefined?formatNumber(_0xc4be75[_0x1a3dd2(0xa5)](0x2)):'')+_0x1a3dd2(0x1c8),console[_0x1a3dd2(0x18e)](_0x19180b[_0x2a33b1][_0x1a3dd2(0x122)]((_0x2cef36,_0x4e230d)=>_0x2cef36+_0x4e230d,0x0));}_0x13c9bf+=_0x1a3dd2(0xb2)+formatNumber(_0x43da87[_0x1a3dd2(0xa5)](0x2))+_0x1a3dd2(0x1c8),_0x13c9bf+=_0x1a3dd2(0xb2)+formatNumber(_0x3f2158)+_0x1a3dd2(0x1c8),_0x13c9bf+=_0x1a3dd2(0xb2)+formatNumber(_0x5666b3)+_0x1a3dd2(0x1c8),_0x13c9bf+=_0x1a3dd2(0xb2)+formatNumber(_0x455e1d)+'</b></td>',_0x13c9bf+=_0x1a3dd2(0x11f);}_0x2396d1[_0x1a3dd2(0x1b5)](_0x13c9bf);}function _0x1f9e3f(_0x40fa87,_0x1dbeb9){const _0x31462c=_0x1a3dd2,_0x3edf58=[];for(let _0x4398db=0x0;_0x4398db<=_0x40fa87[_0x31462c(0xd8)]-0x1;_0x4398db+=_0x1dbeb9){_0x3edf58['push'](_0x40fa87[_0x31462c(0x12f)](_0x4398db,_0x4398db+_0x1dbeb9));}return _0x3edf58;}const _0x12976c=_0x1f9e3f(_0x2396d1,_0x32018b);let _0x4e162b='';return _0x12976c[_0x1a3dd2(0x8a)]((_0x2ec091,_0x49211c)=>{const _0x552cc6=_0x1a3dd2;_0x49211c>0x0&&(_0x4e162b+=_0x552cc6(0xeb));_0x4e162b+=_0x552cc6(0x10a),_0x4e162b+=_0x552cc6(0x9d),_0x4e162b+=_0x552cc6(0xa6),_0x4e162b+=_0x552cc6(0x1ac),_0x4e162b+=_0x552cc6(0x11f),_0x4e162b+='<tr>',_0x4e162b+=_0x552cc6(0x1d6);for(let _0x5d4e94=0x0;_0x5d4e94<=_0x1f3461[_0x552cc6(0xd8)]-0x1;_0x5d4e94++){const _0x339f2c=_0x1f3461[_0x5d4e94];for(let _0x28ef04=0x0;_0x28ef04<_0x37a4ec['length'];_0x28ef04++){const _0x2a2cb0=_0x37a4ec[_0x28ef04];_0x2a2cb0['_id']===_0x339f2c[_0x552cc6(0x192)][_0x552cc6(0x207)]&&(_0x4e162b+=_0x552cc6(0x1fd)+_0x2a2cb0[_0x552cc6(0x1c2)]+_0x552cc6(0xc9)+_0x339f2c['_id'][_0x552cc6(0x207)]+_0x552cc6(0x133));}}_0x4e162b+=_0x552cc6(0xb7),_0x4e162b+=_0x552cc6(0x11f),_0x4e162b+=_0x552cc6(0xa6),_0x4e162b+=_0x552cc6(0x1b4),_0x4e162b+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x4e162b+=_0x552cc6(0x1af);for(let _0x4ae1a1=0x0;_0x4ae1a1<=_0x1f3461['length']-0x1;_0x4ae1a1++){const _0x2085d9=_0x1f3461[_0x4ae1a1];for(let _0x213c1e=0x0;_0x213c1e<_0x1beb3a[_0x552cc6(0xa0)][_0x552cc6(0xd8)];_0x213c1e++){const _0x75b98a=_0x1beb3a[_0x552cc6(0xa0)][_0x213c1e];_0x75b98a[_0x552cc6(0x192)][_0x552cc6(0x207)]===_0x2085d9[_0x552cc6(0x192)]['category']&&(_0x4e162b+=_0x552cc6(0xce)+_0x75b98a['_id'][_0x552cc6(0x191)]+_0x552cc6(0x133));}}_0x4e162b+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x4e162b+=_0x552cc6(0x15d),_0x4e162b+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x4e162b+=_0x552cc6(0x1f5),_0x4e162b+='</tr>',_0x4e162b+=_0x552cc6(0x1e6),_0x4e162b+=_0x552cc6(0x1aa),_0x2ec091['forEach'](_0x233dcf=>{_0x4e162b+=_0x233dcf;}),console[_0x552cc6(0x18e)](_0x19180b),_0x4e162b+=_0x552cc6(0x111),_0x4e162b+=_0x552cc6(0x99);}),_0x4e162b;}async function agentsdataDSICheck_admin_excel(_0x22a25e,_0x1e295b,_0x520586,_0xc4effb){const _0x308a43=a0_0x400c41,_0x39b368=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':_0x308a43(0xcc)},'products':{'$push':{'name':_0x308a43(0xda),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5c4060=[];_0x5c4060[_0x308a43(0xa0)]=[];for(let _0x3d8fc4=0x0;_0x3d8fc4<=_0x39b368[_0x308a43(0xd8)]-0x1;_0x3d8fc4++){const _0x18783a=_0x39b368[_0x3d8fc4];_0x5c4060[_0x308a43(0xa0)]['push'](_0x18783a);}const _0x23f786=await product[_0x308a43(0x186)]([{'$group':{'_id':{'category':_0x308a43(0xcc)},'products':{'$push':{'brand':'$brand','product_code':_0x308a43(0x1a1),'product_name':_0x308a43(0xda)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5766c9=await product['aggregate']([{'$group':{'_id':{'category':_0x308a43(0xcc),'brand':_0x308a43(0x10f)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4107b0=await sales_sa[_0x308a43(0x186)]([{'$match':{'date':{'$gte':_0x22a25e,'$lte':_0x1e295b},'sales_staff_id':_0x520586,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x308a43(0xbf)}},{'$lookup':{'from':'products','localField':_0x308a43(0x121),'foreignField':_0x308a43(0x11d),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x308a43(0xf1),'date':_0x308a43(0x140),'customer':'$customer'},'totalQty':{'$sum':_0x308a43(0x169)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x308a43(0x156),'discount':_0x308a43(0x175),'adj_discount':_0x308a43(0x214),'product_details':{'prod_name':_0x308a43(0x164),'product_code':_0x308a43(0x1a0),'category':_0x308a43(0x14e),'brand':'$product_info.brand','gross_price':_0x308a43(0x159)}}}}},{'$unwind':_0x308a43(0x13f)},{'$group':{'_id':{'dsi':_0x308a43(0xae),'date':_0x308a43(0x172),'customer':_0x308a43(0x17f),'category':_0x308a43(0x1b8),'brand':_0x308a43(0xe5)},'totalQty':{'$sum':_0x308a43(0xa2)},'totalGross':{'$sum':{'$multiply':[_0x308a43(0xa2),_0x308a43(0x167)]}},'NetPrice':{'$sum':_0x308a43(0x1c0)},'discount':{'$sum':_0x308a43(0x210)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x308a43(0x172),'customer':'$_id.customer'},'totalQty':{'$sum':_0x308a43(0x162)},'totalGross':{'$sum':_0x308a43(0x109)},'NetPrice':{'$sum':_0x308a43(0x213)},'discount':{'$sum':_0x308a43(0x1f6)},'adj_discount':{'$sum':_0x308a43(0x1ab)},'products':{'$push':{'qty':_0x308a43(0x162),'category':_0x308a43(0x17a),'brand':_0x308a43(0xcb),'product_details':_0x308a43(0xfe)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x49e84b=[],_0x4f09b6={},_0x2f1ade={},_0x5cbcc8={};var _0x1034ee=0x0,_0x319c20=0x0,_0x4bd3a8=0x0,_0x3b11aa=0x0,_0x1e5a3b=0x0;const _0x325587=0x16345785d8a0000;for(let _0x48abb3=0x0;_0x48abb3<=_0x4107b0['length']-0x1;_0x48abb3++){const _0x5e83a0=_0x4107b0[_0x48abb3];let _0xf8ca48=_0x308a43(0xa6);_0xf8ca48+=_0x308a43(0x1c5)+_0x5e83a0[_0x308a43(0x192)]['dsi']+'</td>',_0xf8ca48+=_0x308a43(0x1c5)+_0x5e83a0[_0x308a43(0x192)]['date']+'</td>',_0xf8ca48+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5e83a0[_0x308a43(0x192)][_0x308a43(0x12c)]+_0x308a43(0x133);let _0x30c2a6={};var _0x71349c=0x0;for(let _0x4d2c1e=0x0;_0x4d2c1e<=_0x5e83a0[_0x308a43(0x142)][_0x308a43(0xd8)]-0x1;_0x4d2c1e++){const _0x456669=_0x5e83a0['products'][_0x4d2c1e];_0x30c2a6[_0x456669[_0x308a43(0x191)]+'-'+_0x456669[_0x308a43(0x207)]]=_0x456669[_0x308a43(0x115)];const _0x1b480f=_0x456669[_0x308a43(0x191)]+'-'+_0x456669[_0x308a43(0x207)];!_0x4f09b6[_0x1b480f]&&(_0x4f09b6[_0x1b480f]=0x0),!Array[_0x308a43(0xb1)](_0x5cbcc8[_0x1b480f])&&(_0x5cbcc8[_0x1b480f]=[]),!Array[_0x308a43(0xb1)](_0x5cbcc8[_0x1b480f])&&(_0x5cbcc8[_0x1b480f]=[]),_0x4f09b6[_0x1b480f]+=_0x456669['qty'],_0x5cbcc8[_0x1b480f][_0x308a43(0x1b5)](_0x456669['qty']),_0x71349c++;}console[_0x308a43(0x18e)](_0x5e83a0);for(let _0x31951e=0x0;_0x31951e<=_0x5c4060[_0x308a43(0xa0)][_0x308a43(0xd8)]-0x1;_0x31951e++){const _0xd8093=_0x5c4060['cat_brand'][_0x31951e],_0x299ff5=_0xd8093[_0x308a43(0x192)][_0x308a43(0x191)]+'-'+_0xd8093[_0x308a43(0x192)][_0x308a43(0x207)];_0xf8ca48+=_0x308a43(0x112)+(_0x30c2a6[_0x299ff5]!==undefined?_0x30c2a6[_0x299ff5]['toFixed'](0x2):'')+'</td>';}_0x4bd3a8=_0x5e83a0[_0x308a43(0xb3)]+_0x5e83a0['adj_discount'],_0xf8ca48+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x5e83a0['totalQty'],0x2)[_0x308a43(0xa5)](0x2))+_0x308a43(0x133),_0xf8ca48+=_0x308a43(0x1fe)+formatNumber(_0x5e83a0[_0x308a43(0xe6)][_0x308a43(0xa5)](0x2))+_0x308a43(0x133),_0xf8ca48+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x4bd3a8)+'</td>',_0xf8ca48+=_0x308a43(0x1fe)+formatNumber(_0x5e83a0['NetPrice'][_0x308a43(0xa5)](0x2))+_0x308a43(0x133),_0xf8ca48+=_0x308a43(0x11f),_0x1034ee+=parseFloat(_0x5e83a0[_0x308a43(0x1c7)]['toFixed'](0x2)),_0x319c20+=parseFloat(_0x5e83a0['NetPrice'][_0x308a43(0xa5)](0x2)),_0x3b11aa+=_0x4bd3a8,_0x1e5a3b+=parseFloat(_0x5e83a0[_0x308a43(0xe6)][_0x308a43(0xa5)](0x2));if(_0x48abb3==_0x4107b0[_0x308a43(0xd8)]-0x1){_0xf8ca48+=_0x308a43(0xa6),_0xf8ca48+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0xf8ca48+=_0x308a43(0x133);for(let _0x194935=0x0;_0x194935<=_0x5c4060['cat_brand'][_0x308a43(0xd8)]-0x1;_0x194935++){const _0x3afdcf=_0x5c4060['cat_brand'][_0x194935],_0x2212c3=_0x3afdcf[_0x308a43(0x192)]['brand']+'-'+_0x3afdcf[_0x308a43(0x192)]['category'],_0x34cee9=_0x5cbcc8[_0x2212c3][_0x308a43(0x122)]((_0x5242dc,_0x36dce3)=>_0x5242dc+_0x36dce3,0x0);console[_0x308a43(0x18e)](_0x308a43(0x131),_0x2212c3),_0xf8ca48+=_0x308a43(0x21a)+(_0x34cee9!==undefined?formatNumber(_0x34cee9[_0x308a43(0xa5)](0x2)):'')+'</b></td>',console['log'](_0x5cbcc8[_0x2212c3][_0x308a43(0x122)]((_0x2550b7,_0x470b7d)=>_0x2550b7+_0x470b7d,0x0));}_0xf8ca48+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1034ee[_0x308a43(0xa5)](0x2))+_0x308a43(0x1c8),_0xf8ca48+=_0x308a43(0xb2)+formatNumber(_0x1e5a3b)+_0x308a43(0x1c8),_0xf8ca48+=_0x308a43(0xb2)+formatNumber(_0x3b11aa)+_0x308a43(0x1c8),_0xf8ca48+=_0x308a43(0xb2)+formatNumber(_0x319c20)+'</b></td>',_0xf8ca48+=_0x308a43(0x11f);}_0x49e84b[_0x308a43(0x1b5)](_0xf8ca48);}function _0x5c922a(_0x136014,_0x20555f){const _0x58a164=_0x308a43,_0x15030c=[];for(let _0x39b93c=0x0;_0x39b93c<=_0x136014['length']-0x1;_0x39b93c+=_0x20555f){_0x15030c[_0x58a164(0x1b5)](_0x136014[_0x58a164(0x12f)](_0x39b93c,_0x39b93c+_0x20555f));}return _0x15030c;}const _0x43d807=_0x5c922a(_0x49e84b,_0x325587);let _0xc0873e='';return _0x43d807[_0x308a43(0x8a)]((_0x2d8b40,_0x177fd2)=>{const _0x17413c=_0x308a43;_0x177fd2>0x0&&(_0xc0873e+=_0x17413c(0xeb));_0xc0873e+='<table>',_0xc0873e+=_0x17413c(0x9d),_0xc0873e+='<tr>',_0xc0873e+=_0x17413c(0x1ac),_0xc0873e+=_0x17413c(0x11f),_0xc0873e+='<tr>',_0xc0873e+=_0x17413c(0x1d6);for(let _0x83a234=0x0;_0x83a234<=_0x23f786[_0x17413c(0xd8)]-0x1;_0x83a234++){const _0xe56381=_0x23f786[_0x83a234];for(let _0x4106a8=0x0;_0x4106a8<_0x5766c9[_0x17413c(0xd8)];_0x4106a8++){const _0x4de3ab=_0x5766c9[_0x4106a8];_0x4de3ab[_0x17413c(0x192)]===_0xe56381['_id'][_0x17413c(0x207)]&&(_0xc0873e+='<td\x20colspan=\x22'+_0x4de3ab[_0x17413c(0x1c2)]+_0x17413c(0xc9)+_0xe56381['_id']['category']+_0x17413c(0x133));}}_0xc0873e+=_0x17413c(0xb7),_0xc0873e+=_0x17413c(0x11f),_0xc0873e+=_0x17413c(0xa6),_0xc0873e+=_0x17413c(0x1b4),_0xc0873e+=_0x17413c(0x17b),_0xc0873e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x1709e6=0x0;_0x1709e6<=_0x23f786[_0x17413c(0xd8)]-0x1;_0x1709e6++){const _0x4c3fd9=_0x23f786[_0x1709e6];for(let _0x53019f=0x0;_0x53019f<_0x5c4060[_0x17413c(0xa0)]['length'];_0x53019f++){const _0x44b81f=_0x5c4060[_0x17413c(0xa0)][_0x53019f];_0x44b81f[_0x17413c(0x192)][_0x17413c(0x207)]===_0x4c3fd9['_id'][_0x17413c(0x207)]&&(_0xc0873e+='<td\x20class=\x22cat_data\x22>'+_0x44b81f[_0x17413c(0x192)][_0x17413c(0x191)]+_0x17413c(0x133));}}_0xc0873e+=_0x17413c(0xa3),_0xc0873e+=_0x17413c(0x15d),_0xc0873e+=_0x17413c(0x1d2),_0xc0873e+=_0x17413c(0x1f5),_0xc0873e+=_0x17413c(0x11f),_0xc0873e+=_0x17413c(0x1e6),_0xc0873e+=_0x17413c(0x1aa),_0x2d8b40['forEach'](_0x3ded53=>{_0xc0873e+=_0x3ded53;}),console[_0x17413c(0x18e)](_0x5cbcc8),_0xc0873e+=_0x17413c(0x111),_0xc0873e+=_0x17413c(0x99);}),_0xc0873e;}router[a0_0x400c41(0x1cc)]('/agent_reports/pdf_admin',auth,async(_0x157de8,_0x1ceb6e)=>{const _0x27dfa7=a0_0x400c41,{from_date:_0x372ecd,to_date:_0x591a5f,isExcel:_0x52695e,agent_id:_0x921f34}=_0x157de8[_0x27dfa7(0x97)],_0x2118b6=_0x157de8[_0x27dfa7(0xd7)],_0x538c16=await staff[_0x27dfa7(0x1da)]({'email':_0x2118b6[_0x27dfa7(0x182)]}),_0x2f881e=await master_shop[_0x27dfa7(0xcd)](),_0x1b2370=await agentsdataDSICheck_admin(_0x372ecd,_0x591a5f,_0x921f34,_0x52695e),_0x4395cc=await agentsdataDSICheck_admin_excel(_0x372ecd,_0x591a5f,_0x921f34,_0x52695e);let _0x49ea1a=_0x27dfa7(0xbc);var _0x2a776e=new Date(_0x372ecd),_0x8c062=new Date(_0x591a5f);const _0x1005f1={'year':_0x27dfa7(0x1c1),'month':_0x27dfa7(0x1a3),'day':_0x27dfa7(0x1c1)},_0x45d554=new Intl[(_0x27dfa7(0x212))](_0x27dfa7(0x1cf),_0x1005f1)[_0x27dfa7(0x1d3)](_0x2a776e),_0x21f1ea=new Intl[(_0x27dfa7(0x212))](_0x27dfa7(0x1cf),_0x1005f1)[_0x27dfa7(0x1d3)](_0x8c062);_0x49ea1a+='<div\x20class=\x22row\x22>',_0x49ea1a+=_0x27dfa7(0x1bc),_0x49ea1a+='<table>',_0x49ea1a+=_0x1b2370,_0x49ea1a+=_0x27dfa7(0x99),_0x49ea1a+=_0x27dfa7(0xf0),_0x49ea1a+='</div>';let _0x30b098='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x30b098+=_0x27dfa7(0x1f1),_0x30b098+='<div\x20\x20id=\x22table-conatainer\x22>',_0x30b098+=_0x27dfa7(0x10a),_0x30b098+=_0x4395cc,_0x30b098+=_0x27dfa7(0x99),_0x30b098+=_0x27dfa7(0xf0),_0x30b098+=_0x27dfa7(0xf0);let _0x4afc4d='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x28a0c5={'width':_0x27dfa7(0xdd),'height':_0x27dfa7(0x1f3),'orientation':_0x27dfa7(0x16a),'border':{'top':_0x27dfa7(0x17e),'right':_0x27dfa7(0x17e),'bottom':'0.1in','left':_0x27dfa7(0x17e)},'header':{'height':'60mm','contents':_0x27dfa7(0xb5)+_0x4afc4d+_0x27dfa7(0xec)+_0x45d554+_0x27dfa7(0x1ca)+_0x21f1ea+_0x27dfa7(0x146)},'footer':{'height':_0x27dfa7(0x8d),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x27dfa7(0x143)}}};if(_0x52695e=='on'){const _0xe73393=cheerio[_0x27dfa7(0x1e3)](_0x30b098);let _0x34400e=[],_0x5c81e5=[],_0x41a8d4=[];_0xe73393(_0x27dfa7(0x10e))['each']((_0x49eaa7,_0x23680e)=>{const _0x1b0e9e=_0x27dfa7;let _0x3150d0=[],_0x4bd008=0x0;while(_0x41a8d4[_0x4bd008]){_0x41a8d4[_0x4bd008]--,_0x4bd008++;}_0xe73393(_0x23680e)[_0x1b0e9e(0xcd)](_0x1b0e9e(0x166))[_0x1b0e9e(0x14a)]((_0x2e6659,_0x48f21f)=>{const _0x1488bc=_0x1b0e9e;let _0x415ce8=_0xe73393(_0x48f21f)[_0x1488bc(0x187)]()[_0x1488bc(0x1db)](),_0x249c05=parseFloat(_0x415ce8[_0x1488bc(0x13a)](/,/g,''));isNaN(_0x249c05)&&(_0x249c05=_0x415ce8);let _0x158349=parseInt(_0xe73393(_0x48f21f)[_0x1488bc(0x105)](_0x1488bc(0xdf)))||0x1,_0x33beeb=parseInt(_0xe73393(_0x48f21f)[_0x1488bc(0x105)]('rowspan'))||0x1;_0x3150d0[_0x4bd008]=_0x249c05;(_0x158349>0x1||_0x33beeb>0x1)&&_0x5c81e5['push']({'s':{'r':_0x49eaa7,'c':_0x4bd008},'e':{'r':_0x49eaa7+_0x33beeb-0x1,'c':_0x4bd008+_0x158349-0x1}});for(let _0x206f44=0x0;_0x206f44<_0x158349;_0x206f44++){_0x33beeb>0x1&&(_0x41a8d4[_0x4bd008+_0x206f44]=_0x33beeb-0x1);}_0x4bd008+=_0x158349;}),_0x34400e[_0x1b0e9e(0x1b5)](_0x3150d0);});const _0x3e3ebd=XLSX['utils'][_0x27dfa7(0x161)](),_0x56582d=XLSX[_0x27dfa7(0xc3)]['aoa_to_sheet'](_0x34400e);_0x5c81e5[_0x27dfa7(0xd8)]>0x0&&(_0x56582d[_0x27dfa7(0xaf)]=_0x5c81e5);_0x56582d[_0x27dfa7(0xf7)]=_0x34400e[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x27dfa7(0xc3)]['book_append_sheet'](_0x3e3ebd,_0x56582d,_0x27dfa7(0x102));const _0x43b161=XLSX[_0x27dfa7(0xdc)](_0x3e3ebd,{'bookType':_0x27dfa7(0xd3),'type':_0x27dfa7(0x129)});_0x1ceb6e['setHeader'](_0x27dfa7(0x147),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x1ceb6e[_0x27dfa7(0x12e)]('Content-Type',_0x27dfa7(0x1a2)),_0x1ceb6e[_0x27dfa7(0x1d7)](_0x43b161);}else pdf[_0x27dfa7(0x11b)](_0x49ea1a,_0x28a0c5)[_0x27dfa7(0x137)](function(_0xf320e2,_0x39c8ed){const _0x373a8f=_0x27dfa7;if(_0xf320e2){_0x1ceb6e[_0x373a8f(0x1e7)](0x1f4)[_0x373a8f(0x1d7)](_0x373a8f(0x1e0));return;}_0x1ceb6e['setHeader']('Content-Type',_0x373a8f(0x1b6)),_0x39c8ed[_0x373a8f(0x14d)](_0x1ceb6e);});}),router[a0_0x400c41(0x127)](a0_0x400c41(0xd2),auth,async(_0x110da5,_0x2bc09b)=>{const _0x1ee730=a0_0x400c41;try{const {username:_0x430fce,email:_0x43795e,role:_0x1b3014}=_0x110da5[_0x1ee730(0xd7)],_0x26e89a=_0x110da5[_0x1ee730(0xd7)],_0x5938f5=await profile[_0x1ee730(0x1da)]({'email':_0x26e89a['email']}),_0x173094={'year':'numeric','month':_0x1ee730(0x1a3),'day':_0x1ee730(0x1c1)},_0x2c38d8=await master_shop[_0x1ee730(0xcd)](),_0x2697c7=await staff['findOne']({'email':_0x26e89a[_0x1ee730(0x182)]}),_0x473980=await product['find'](),_0x18b54e=await warehouse[_0x1ee730(0x186)]([{'$unwind':_0x1ee730(0xfe)},{'$lookup':{'from':_0x1ee730(0x142),'localField':_0x1ee730(0x18b),'foreignField':'name','as':_0x1ee730(0xd6)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x1ee730(0x1ef)}},{'$group':{'_id':_0x1ee730(0x15b),'product_stock':{'$sum':_0x1ee730(0x10b)}}}]);if(_0x2c38d8[0x0][_0x1ee730(0x1fc)]==_0x1ee730(0x145))var _0x4dd46e=users[_0x1ee730(0x110)];else{if(_0x2c38d8[0x0][_0x1ee730(0x1fc)]=='Hindi')var _0x4dd46e=users['Hindi'];else{if(_0x2c38d8[0x0]['language']==_0x1ee730(0x90))var _0x4dd46e=users[_0x1ee730(0x90)];else{if(_0x2c38d8[0x0][_0x1ee730(0x1fc)]==_0x1ee730(0x117))var _0x4dd46e=users[_0x1ee730(0x117)];else{if(_0x2c38d8[0x0][_0x1ee730(0x1fc)]==_0x1ee730(0x177))var _0x4dd46e=users[_0x1ee730(0x177)];else{if(_0x2c38d8[0x0][_0x1ee730(0x1fc)]=='Portuguese\x20(BR)')var _0x4dd46e=users[_0x1ee730(0x1a9)];else{if(_0x2c38d8[0x0]['language']==_0x1ee730(0x18f))var _0x4dd46e=users['Chinese'];else{if(_0x2c38d8[0x0][_0x1ee730(0x1fc)]==_0x1ee730(0x15a))var _0x4dd46e=users[_0x1ee730(0xb9)];}}}}}}}_0x2bc09b['render'](_0x1ee730(0x198),{'success':_0x110da5['flash'](_0x1ee730(0xc2)),'errors':_0x110da5['flash'](_0x1ee730(0x16b)),'alldata':_0x473980,'profile':_0x5938f5,'master_shop':_0x2c38d8,'role':_0x26e89a,'product_stock':_0x18b54e,'language':_0x4dd46e,'staff_arr':_0x2697c7});}catch(_0x27dd74){}});function a0_0x29cf(_0x201e75,_0x23f8ee){const _0x5624bf=a0_0x5624();return a0_0x29cf=function(_0x29cf2d,_0x566bfe){_0x29cf2d=_0x29cf2d-0x8a;let _0x102389=_0x5624bf[_0x29cf2d];return _0x102389;},a0_0x29cf(_0x201e75,_0x23f8ee);}function a0_0x5624(){const _0x2f29b6=['isFG','</td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','<td\x20class=\x22row_data\x22></td>','toStream','/dl_excel','dsi','replace','NumberFormat','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','$products','$date','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','products','/dev/null','then','English\x20(US)','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Content-Disposition','thick','$bank','each','attachment;\x20filename=\x22sales_report.xlsx\x22','<script>','pipe','$product_info.category','$sale_product.stock','$customer','$product.product_name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','$cash','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','agent_sales','$sale_product.totalprice','medium','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','$product_info.gross_price','Arabic\x20(ae)','$product_name','beg_bal','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','getDate','1056984tiHPTF','valueOf','book_new','$totalQty','$product_list.product_code','$product_info.name','sales_ext','td,\x20th','$products.product_details.gross_price','prod_cat','$sale_product.real_qty_unit_val','landscape','errors','product_stock','Products\x20warehouse_data','<td\x20class=\x22row_data\x22><b>','$_id.status_data','$sales_info','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','$_id.date','attachment;\x20filename=\x22reports.xlsx\x22','$check_no','$sale_product.discount','aoa_to_sheet','French','\x22><b>','split','$_id.category','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','000000','product_details','0.1in','$_id.customer','rowspan','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','email','true','<th>\x20ITEM\x20CODE\x20</th>','window.onload\x20=\x20function()\x20{','aggregate','text','$products.adj_discount','filter','thin','product_details.product_name','/inventory_sum/view','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','log','Chinese','top','brand','_id','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','2779464NkzhWk','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','balanced','toLocaleString','dsi_sales','$product_docs','38879203DJgrKU','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','product_info','$product','canvas','setDate','$product_info.product_code','$product_code','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','long','toLocaleDateString','<h1>JAKA\x20EQUITIES\x20CORP</h1>','referenceNumber','sales_bkg','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','Portuguese','<tbody>','$adj_discount','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','<th>\x20QTY\x20SOLD\x20</th>','window.print();','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','<div\x20class=\x22col-sm-11\x22>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','4798oRcjGL','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','push','application/pdf','7JuZATy','$products.product_details.category','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','excel','$sales_info.name','<div\x20\x20id=\x22table-conatainer\x22>','name','date','5025516IeiyJC','$products.NetPrice','numeric','brandCount','/agent_reports/pdf','html','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','totalQty','</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','\x20-\x20','<th\x20colspan=\x272\x27>SOLD</th>','post','multer','/dsrr/view','en-US','419xLWgTZ','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','format','express/lib/response','$product_info.brand','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','send','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','error','findOne','trim','border-left','$product_info','html-pdf','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','Error\x20generating\x20PDF','$products.product_details','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','load','save','<td\x20class=\x22cat_data\x22></td>','</thead>','status','$sale_product.product_code','$due_date','/agent_reports/sales_ad','$product_list.product_name','$sale_product.prod_cat','sales_reports','1500KzysSQ','$product_details.product_stock','sales_man_code','<div\x20class=\x22row\x22>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','8.5in','inventory_sum','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','$discount','findById','$product_list.product_stock','$product_details.product_name','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','$sale_product.isFG','language','<td\x20colspan=\x22','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','dssr_view','dsi_sales_admin','toISOString','3406220XsXZSH','$sale_product.product_name','$product_list','deleteOne','../middleware/auth','category','style','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','bottom','<th\x20rowspan=\x272\x27>Category</th>','<p>','/dsrr_admin/pdf_admin','dssr_view_admin','$products.discount','flash','DateTimeFormat','$NetPrice','$sale_product.adj_discount','staffs','dataqty','<th>X-Truck</th>','border-bottom','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','54CiQkqN','forEach','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','cash','20mm','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','German','$sale_product.quantity','express','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','60mm','</th>','stock','body','$product.quantity','</table>','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','book_append_sheet','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','<thead>','$sales_info._id','<th>Booking</th>','cat_brand','$amount','$products.qty','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','toFixed','<tr>','/getDSSR_no','pdfkit-table','totalQTY','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','/dsrr/pdf','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','$_id.dsi','!merges','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','isArray','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','discount','<th\x20rowspan=\x272\x27>Products</th>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','product_name','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','<th>\x20INVOICE\x20AMOUNT\x20</th>','Arabic','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','border-top','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','border-right','exceljs','false','render','$sale_product._id','success','utils','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','sales_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','note','<th>\x20SALES\x20</th>','\x22\x20class=\x22cat_data\x22>','totalPrice','$_id.brand','$category','find','<td\x20class=\x22cat_data\x22>','date_include','$products.product_details.prod_id','params','/agent_reports/view','xlsx','8870wiYjEz','<td\x20colspan=\x223\x22><b>TOTAL<b>','product_docs','user','length','ObjectId','$name','$status_data','write','15in','$sale_product','colspan','/agent/view','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','amount','Hindi','$products.product_details.brand','totalGross','<p>INVENTORY\x20SUMMARY</p>','</p>','Products\x20find_data','includes','<div\x20style=\x22page-break-before:\x20always;\x22></div>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','jsbarcode','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','path','</div>','$dsi','Router','<td\x20class=\x22row_data\x22>','<th>\x20BEG\x20BALANCE\x20</th>','Household','/getDSSR_no_sales','!cols','check_no','/reports/dsrr/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','NetPrice','/dsrr_admin/view','sumqty','$product_details','<td\x20class=\x22row_data\x22>0</td>','Content-Type','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','Sales\x20Report','../public/language/languages.json','/total_sales_reports/pdf','attr','blob-stream','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','Portuguese\x20(BR)','$totalGross','<table>','$product_stock','Letter','adj_discount','table\x20tr','$brand','English','</tbody>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','\x22><b></b></td>','json','qty','totalQTYsum','Spanish','Products\x20master','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','No\x20data\x20was\x20Found!','create','../models/all_models','product_code','right','</tr>','Standard','sale_product.product_code','reduce','$sales_staff_id','map','<th>\x20ITEM\x20DESCRIPTION\x20</th>','mongoose','get','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','buffer','cheerio','</script>','customer','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','setHeader','slice','left','test'];a0_0x5624=function(){return _0x2f29b6;};return a0_0x5624();}function formatNumber(_0x530aaa,_0x59095e=a0_0x400c41(0x1cf),_0x496ca4={'minimumFractionDigits':0x2}){const _0x2f932e=a0_0x400c41,_0x448f27=new Intl[(_0x2f932e(0x13b))](_0x59095e,_0x496ca4);return _0x448f27[_0x2f932e(0x1d3)](_0x530aaa);}async function agentsdataDSICheck(_0x4709da,_0x20f0e8,_0x5d29c0,_0x132f9f){const _0xfe273f=a0_0x400c41,_0x38ef5a=await product[_0xfe273f(0x186)]([{'$group':{'_id':{'brand':'$brand','category':_0xfe273f(0xcc)},'products':{'$push':{'name':_0xfe273f(0xda),'product_code':_0xfe273f(0x1a1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x42dfb4=[];_0x42dfb4[_0xfe273f(0xa0)]=[];for(let _0x21e2f2=0x0;_0x21e2f2<=_0x38ef5a[_0xfe273f(0xd8)]-0x1;_0x21e2f2++){const _0x8dd146=_0x38ef5a[_0x21e2f2];_0x42dfb4[_0xfe273f(0xa0)][_0xfe273f(0x1b5)](_0x8dd146);}const _0x4c2bde=await product[_0xfe273f(0x186)]([{'$group':{'_id':{'category':_0xfe273f(0xcc)},'products':{'$push':{'brand':_0xfe273f(0x10f),'product_code':'$product_code','product_name':_0xfe273f(0xda)}}}},{'$sort':{'_id.category':-0x1}}]),_0x185b77=await product[_0xfe273f(0x186)]([{'$group':{'_id':{'category':_0xfe273f(0xcc),'brand':_0xfe273f(0x10f)}}},{'$group':{'_id':_0xfe273f(0x17a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3852fd=await sales_sa[_0xfe273f(0x186)]([{'$match':{'date':{'$gte':_0x4709da,'$lte':_0x20f0e8},'sales_staff_id':_0x5d29c0,'sale_product.isFG':_0xfe273f(0xbf),'status_data':_0xfe273f(0xbf)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0xfe273f(0xbf)}},{'$lookup':{'from':'products','localField':_0xfe273f(0x121),'foreignField':_0xfe273f(0x11d),'as':_0xfe273f(0x19c)}},{'$unwind':_0xfe273f(0x1dd)},{'$group':{'_id':{'dsi':'$dsi','date':_0xfe273f(0x140),'customer':'$customer'},'totalQty':{'$sum':_0xfe273f(0x169)},'products':{'$push':{'qty':_0xfe273f(0x169),'NetPrice':'$sale_product.totalprice','discount':_0xfe273f(0x175),'adj_discount':_0xfe273f(0x214),'product_details':{'prod_name':_0xfe273f(0x164),'product_code':'$product_info.product_code','category':_0xfe273f(0x14e),'brand':_0xfe273f(0x1d5),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0xfe273f(0x13f)},{'$group':{'_id':{'dsi':_0xfe273f(0xae),'date':_0xfe273f(0x172),'customer':_0xfe273f(0x17f),'category':_0xfe273f(0x1b8),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0xfe273f(0xa2)},'totalGross':{'$sum':{'$multiply':[_0xfe273f(0xa2),_0xfe273f(0x167)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0xfe273f(0x210)},'adj_discount':{'$sum':_0xfe273f(0x188)},'product_details':{'$first':_0xfe273f(0x1e1)}}},{'$group':{'_id':{'dsi':_0xfe273f(0xae),'date':_0xfe273f(0x172),'customer':_0xfe273f(0x17f)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0xfe273f(0x109)},'NetPrice':{'$sum':_0xfe273f(0x213)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0xfe273f(0x1ab)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0xfe273f(0xcb),'product_details':_0xfe273f(0xfe)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x3ab214=[],_0x2ea544={},_0xe19509={},_0x1c333a={};var _0x47d9bb=0x0,_0x5e3973=0x0,_0x20db73=0x0,_0x3256b9=0x0,_0x43b77b=0x0;const _0x3daf5d=0x6;for(let _0x3ae4c6=0x0;_0x3ae4c6<=_0x3852fd['length']-0x1;_0x3ae4c6++){const _0x4ed7c5=_0x3852fd[_0x3ae4c6];let _0x2f1a94=_0xfe273f(0xa6);_0x2f1a94+=_0xfe273f(0x1c5)+_0x4ed7c5[_0xfe273f(0x192)]['dsi']+_0xfe273f(0x133),_0x2f1a94+=_0xfe273f(0x1c5)+_0x4ed7c5[_0xfe273f(0x192)][_0xfe273f(0x1be)]+_0xfe273f(0x133),_0x2f1a94+=_0xfe273f(0x1c5)+_0x4ed7c5[_0xfe273f(0x192)][_0xfe273f(0x12c)]+_0xfe273f(0x133);let _0x3ce0b7={};var _0x1ca036=0x0;for(let _0x9733a3=0x0;_0x9733a3<=_0x4ed7c5[_0xfe273f(0x142)][_0xfe273f(0xd8)]-0x1;_0x9733a3++){const _0x321f30=_0x4ed7c5[_0xfe273f(0x142)][_0x9733a3];_0x3ce0b7[_0x321f30['brand']+'-'+_0x321f30[_0xfe273f(0x207)]]=_0x321f30[_0xfe273f(0x115)];const _0x247b88=_0x321f30['brand']+'-'+_0x321f30[_0xfe273f(0x207)];!_0x2ea544[_0x247b88]&&(_0x2ea544[_0x247b88]=0x0),!Array['isArray'](_0x1c333a[_0x247b88])&&(_0x1c333a[_0x247b88]=[]),!Array[_0xfe273f(0xb1)](_0x1c333a[_0x247b88])&&(_0x1c333a[_0x247b88]=[]),_0x2ea544[_0x247b88]+=_0x321f30[_0xfe273f(0x115)],_0x1c333a[_0x247b88]['push'](_0x321f30[_0xfe273f(0x115)]),_0x1ca036++;}console[_0xfe273f(0x18e)](_0x4ed7c5);for(let _0x3089f4=0x0;_0x3089f4<=_0x42dfb4[_0xfe273f(0xa0)][_0xfe273f(0xd8)]-0x1;_0x3089f4++){const _0x3049b8=_0x42dfb4[_0xfe273f(0xa0)][_0x3089f4],_0x5b8889=_0x3049b8[_0xfe273f(0x192)][_0xfe273f(0x191)]+'-'+_0x3049b8[_0xfe273f(0x192)][_0xfe273f(0x207)];_0x2f1a94+=_0xfe273f(0x112)+(_0x3ce0b7[_0x5b8889]!==undefined?_0x3ce0b7[_0x5b8889]['toFixed'](0x2):'')+_0xfe273f(0x133);}_0x20db73=_0x4ed7c5['discount']+_0x4ed7c5['adj_discount'],_0x2f1a94+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x4ed7c5[_0xfe273f(0x1c7)],0x2)[_0xfe273f(0xa5)](0x2))+_0xfe273f(0x133),_0x2f1a94+=_0xfe273f(0x1fe)+formatNumber(_0x4ed7c5[_0xfe273f(0xe6)][_0xfe273f(0xa5)](0x2))+'</td>',_0x2f1a94+=_0xfe273f(0x1fe)+formatNumber(_0x20db73)+_0xfe273f(0x133),_0x2f1a94+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x4ed7c5[_0xfe273f(0xfb)][_0xfe273f(0xa5)](0x2))+_0xfe273f(0x133),_0x2f1a94+=_0xfe273f(0x11f),_0x47d9bb+=parseFloat(_0x4ed7c5[_0xfe273f(0x1c7)]['toFixed'](0x2)),_0x5e3973+=parseFloat(_0x4ed7c5[_0xfe273f(0xfb)][_0xfe273f(0xa5)](0x2)),_0x3256b9+=_0x20db73,_0x43b77b+=parseFloat(_0x4ed7c5[_0xfe273f(0xe6)]['toFixed'](0x2));if(_0x3ae4c6==_0x3852fd[_0xfe273f(0xd8)]-0x1){_0x2f1a94+='<tr>',_0x2f1a94+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x2f1a94+=_0xfe273f(0x133);for(let _0x418812=0x0;_0x418812<=_0x42dfb4['cat_brand'][_0xfe273f(0xd8)]-0x1;_0x418812++){const _0x30b4f4=_0x42dfb4[_0xfe273f(0xa0)][_0x418812],_0x318341=_0x30b4f4[_0xfe273f(0x192)][_0xfe273f(0x191)]+'-'+_0x30b4f4['_id']['category'];!_0x1c333a[_0x318341]&&(_0x1c333a[_0x318341]=[]);const _0x1ec2c4=_0x1c333a[_0x318341][_0xfe273f(0x122)]((_0x2cf7e0,_0x1c5a0d)=>_0x2cf7e0+_0x1c5a0d,0x0);_0x2f1a94+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x1ec2c4!==undefined?formatNumber(_0x1ec2c4[_0xfe273f(0xa5)](0x2)):'')+_0xfe273f(0x1c8),console[_0xfe273f(0x18e)](_0x1c333a[_0x318341]['reduce']((_0x472535,_0x1f1029)=>_0x472535+_0x1f1029,0x0));}_0x2f1a94+=_0xfe273f(0xb2)+formatNumber(_0x47d9bb[_0xfe273f(0xa5)](0x2))+_0xfe273f(0x1c8),_0x2f1a94+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x43b77b)+_0xfe273f(0x1c8),_0x2f1a94+=_0xfe273f(0xb2)+formatNumber(_0x3256b9)+_0xfe273f(0x1c8),_0x2f1a94+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5e3973)+_0xfe273f(0x1c8),_0x2f1a94+=_0xfe273f(0x11f);}_0x3ab214[_0xfe273f(0x1b5)](_0x2f1a94);}function _0xc9981a(_0xe10ccc,_0x1c1c3c){const _0x159226=_0xfe273f,_0x251f8b=[];for(let _0x392a4b=0x0;_0x392a4b<=_0xe10ccc[_0x159226(0xd8)]-0x1;_0x392a4b+=_0x1c1c3c){_0x251f8b['push'](_0xe10ccc['slice'](_0x392a4b,_0x392a4b+_0x1c1c3c));}return _0x251f8b;}const _0x250704=_0xc9981a(_0x3ab214,_0x3daf5d);let _0xadd6f5='';return _0x250704[_0xfe273f(0x8a)]((_0x5bfa85,_0x47a45d)=>{const _0x47b666=_0xfe273f;_0x47a45d>0x0&&(_0xadd6f5+=_0x47b666(0xeb));_0xadd6f5+=_0x47b666(0x10a),_0xadd6f5+='<thead>',_0xadd6f5+='<tr>',_0xadd6f5+=_0x47b666(0x1ac),_0xadd6f5+=_0x47b666(0x11f),_0xadd6f5+='<tr>',_0xadd6f5+=_0x47b666(0x1d6);for(let _0x47fe35=0x0;_0x47fe35<=_0x4c2bde[_0x47b666(0xd8)]-0x1;_0x47fe35++){const _0x2a6015=_0x4c2bde[_0x47fe35];for(let _0x5e99ad=0x0;_0x5e99ad<_0x185b77['length'];_0x5e99ad++){const _0x34de4b=_0x185b77[_0x5e99ad];_0x34de4b[_0x47b666(0x192)]===_0x2a6015['_id']['category']&&(_0xadd6f5+=_0x47b666(0x1fd)+_0x34de4b[_0x47b666(0x1c2)]+_0x47b666(0xc9)+_0x2a6015[_0x47b666(0x192)][_0x47b666(0x207)]+_0x47b666(0x133));}}_0xadd6f5+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0xadd6f5+=_0x47b666(0x11f),_0xadd6f5+=_0x47b666(0xa6),_0xadd6f5+=_0x47b666(0x1b4),_0xadd6f5+=_0x47b666(0x17b),_0xadd6f5+=_0x47b666(0x1af);for(let _0x5977bd=0x0;_0x5977bd<=_0x4c2bde[_0x47b666(0xd8)]-0x1;_0x5977bd++){const _0x3ef1c3=_0x4c2bde[_0x5977bd];for(let _0x5b5cf2=0x0;_0x5b5cf2<_0x42dfb4['cat_brand'][_0x47b666(0xd8)];_0x5b5cf2++){const _0x5a5612=_0x42dfb4['cat_brand'][_0x5b5cf2];_0x5a5612[_0x47b666(0x192)][_0x47b666(0x207)]===_0x3ef1c3[_0x47b666(0x192)][_0x47b666(0x207)]&&(_0xadd6f5+='<td\x20class=\x22cat_data\x22>'+_0x5a5612[_0x47b666(0x192)]['brand']+_0x47b666(0x133));}}_0xadd6f5+=_0x47b666(0xa3),_0xadd6f5+=_0x47b666(0x15d),_0xadd6f5+=_0x47b666(0x1d2),_0xadd6f5+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0xadd6f5+=_0x47b666(0x11f),_0xadd6f5+=_0x47b666(0x1e6),_0xadd6f5+=_0x47b666(0x1aa),_0x5bfa85['forEach'](_0x991845=>{_0xadd6f5+=_0x991845;}),console['log'](_0x1c333a),_0xadd6f5+='</tbody>',_0xadd6f5+='</table>';}),_0xadd6f5;}async function agentsdataDSICheck_excel(_0x489f54,_0x3afed4,_0x34887d,_0x1aff43){const _0x4981dc=a0_0x400c41,_0x4bf415=await product[_0x4981dc(0x186)]([{'$group':{'_id':{'brand':'$brand','category':_0x4981dc(0xcc)},'products':{'$push':{'name':_0x4981dc(0xda),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1866e2=[];_0x1866e2['cat_brand']=[];for(let _0x53f80a=0x0;_0x53f80a<=_0x4bf415[_0x4981dc(0xd8)]-0x1;_0x53f80a++){const _0xb3b535=_0x4bf415[_0x53f80a];_0x1866e2['cat_brand'][_0x4981dc(0x1b5)](_0xb3b535);}const _0x21ea9c=await product[_0x4981dc(0x186)]([{'$group':{'_id':{'category':_0x4981dc(0xcc)},'products':{'$push':{'brand':_0x4981dc(0x10f),'product_code':'$product_code','product_name':_0x4981dc(0xda)}}}},{'$sort':{'_id.category':-0x1}}]),_0x120c6b=await product[_0x4981dc(0x186)]([{'$group':{'_id':{'category':_0x4981dc(0xcc),'brand':_0x4981dc(0x10f)}}},{'$group':{'_id':_0x4981dc(0x17a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x54bcfb=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x489f54,'$lte':_0x3afed4},'sales_staff_id':_0x34887d,'sale_product.isFG':_0x4981dc(0xbf)}},{'$unwind':_0x4981dc(0xde)},{'$match':{'sale_product.isFG':_0x4981dc(0xbf)}},{'$lookup':{'from':_0x4981dc(0x142),'localField':_0x4981dc(0x121),'foreignField':_0x4981dc(0x11d),'as':_0x4981dc(0x19c)}},{'$unwind':_0x4981dc(0x1dd)},{'$group':{'_id':{'dsi':_0x4981dc(0xf1),'date':_0x4981dc(0x140),'customer':_0x4981dc(0x150)},'totalQty':{'$sum':_0x4981dc(0x169)},'products':{'$push':{'qty':_0x4981dc(0x169),'NetPrice':_0x4981dc(0x156),'discount':_0x4981dc(0x175),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':_0x4981dc(0x1a0),'category':_0x4981dc(0x14e),'brand':_0x4981dc(0x1d5),'gross_price':_0x4981dc(0x159)}}}}},{'$unwind':_0x4981dc(0x13f)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x4981dc(0x172),'customer':'$_id.customer','category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x4981dc(0xa2)},'totalGross':{'$sum':{'$multiply':[_0x4981dc(0xa2),_0x4981dc(0x167)]}},'NetPrice':{'$sum':_0x4981dc(0x1c0)},'discount':{'$sum':_0x4981dc(0x210)},'adj_discount':{'$sum':_0x4981dc(0x188)},'product_details':{'$first':_0x4981dc(0x1e1)}}},{'$group':{'_id':{'dsi':_0x4981dc(0xae),'date':_0x4981dc(0x172),'customer':_0x4981dc(0x17f)},'totalQty':{'$sum':_0x4981dc(0x162)},'totalGross':{'$sum':_0x4981dc(0x109)},'NetPrice':{'$sum':_0x4981dc(0x213)},'discount':{'$sum':_0x4981dc(0x1f6)},'adj_discount':{'$sum':_0x4981dc(0x1ab)},'products':{'$push':{'qty':_0x4981dc(0x162),'category':_0x4981dc(0x17a),'brand':_0x4981dc(0xcb),'product_details':_0x4981dc(0xfe)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x526608=[],_0x5d6498={},_0x20b1cf={},_0x2b7670={};var _0xe50601=0x0,_0x5cf007=0x0,_0x3d74b5=0x0,_0x30e08e=0x0,_0x2b4f9c=0x0;const _0x43d388=0x9184e72a000;for(let _0x14c3e5=0x0;_0x14c3e5<=_0x54bcfb[_0x4981dc(0xd8)]-0x1;_0x14c3e5++){const _0x7db955=_0x54bcfb[_0x14c3e5];let _0x184f69=_0x4981dc(0xa6);_0x184f69+=_0x4981dc(0x1c5)+_0x7db955[_0x4981dc(0x192)][_0x4981dc(0x139)]+_0x4981dc(0x133),_0x184f69+=_0x4981dc(0x1c5)+_0x7db955[_0x4981dc(0x192)]['date']+_0x4981dc(0x133),_0x184f69+=_0x4981dc(0x1c5)+_0x7db955[_0x4981dc(0x192)][_0x4981dc(0x12c)]+_0x4981dc(0x133);let _0x3e455d={};var _0x142047=0x0;for(let _0x50c650=0x0;_0x50c650<=_0x7db955[_0x4981dc(0x142)][_0x4981dc(0xd8)]-0x1;_0x50c650++){const _0x582a57=_0x7db955[_0x4981dc(0x142)][_0x50c650];_0x3e455d[_0x582a57[_0x4981dc(0x191)]+'-'+_0x582a57[_0x4981dc(0x207)]]=_0x582a57[_0x4981dc(0x115)];const _0xc95d56=_0x582a57['brand']+'-'+_0x582a57[_0x4981dc(0x207)];!_0x5d6498[_0xc95d56]&&(_0x5d6498[_0xc95d56]=0x0),!Array[_0x4981dc(0xb1)](_0x2b7670[_0xc95d56])&&(_0x2b7670[_0xc95d56]=[]),!Array[_0x4981dc(0xb1)](_0x2b7670[_0xc95d56])&&(_0x2b7670[_0xc95d56]=[]),_0x5d6498[_0xc95d56]+=_0x582a57[_0x4981dc(0x115)],_0x2b7670[_0xc95d56][_0x4981dc(0x1b5)](_0x582a57[_0x4981dc(0x115)]),_0x142047++;}console[_0x4981dc(0x18e)](_0x7db955);for(let _0x179377=0x0;_0x179377<=_0x1866e2[_0x4981dc(0xa0)][_0x4981dc(0xd8)]-0x1;_0x179377++){const _0x2fd1dd=_0x1866e2[_0x4981dc(0xa0)][_0x179377],_0x1ed1c0=_0x2fd1dd[_0x4981dc(0x192)][_0x4981dc(0x191)]+'-'+_0x2fd1dd[_0x4981dc(0x192)][_0x4981dc(0x207)];_0x184f69+=_0x4981dc(0x112)+(_0x3e455d[_0x1ed1c0]!==undefined?_0x3e455d[_0x1ed1c0]['toFixed'](0x2):'')+_0x4981dc(0x133);}_0x3d74b5=_0x7db955['discount']+_0x7db955[_0x4981dc(0x10d)],_0x184f69+=_0x4981dc(0x1fe)+formatNumber(parseFloat(_0x7db955[_0x4981dc(0x1c7)],0x2)[_0x4981dc(0xa5)](0x2))+_0x4981dc(0x133),_0x184f69+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x7db955['totalGross'][_0x4981dc(0xa5)](0x2))+_0x4981dc(0x133),_0x184f69+=_0x4981dc(0x1fe)+formatNumber(_0x3d74b5)+'</td>',_0x184f69+=_0x4981dc(0x1fe)+formatNumber(_0x7db955[_0x4981dc(0xfb)][_0x4981dc(0xa5)](0x2))+'</td>',_0x184f69+=_0x4981dc(0x11f),_0xe50601+=parseFloat(_0x7db955['totalQty'][_0x4981dc(0xa5)](0x2)),_0x5cf007+=parseFloat(_0x7db955[_0x4981dc(0xfb)][_0x4981dc(0xa5)](0x2)),_0x30e08e+=_0x3d74b5,_0x2b4f9c+=parseFloat(_0x7db955[_0x4981dc(0xe6)][_0x4981dc(0xa5)](0x2));if(_0x14c3e5==_0x54bcfb['length']-0x1){_0x184f69+='<tr>',_0x184f69+=_0x4981dc(0xd5),_0x184f69+=_0x4981dc(0x133);for(let _0x2f6ab1=0x0;_0x2f6ab1<=_0x1866e2[_0x4981dc(0xa0)][_0x4981dc(0xd8)]-0x1;_0x2f6ab1++){const _0xa69600=_0x1866e2[_0x4981dc(0xa0)][_0x2f6ab1],_0x1bb879=_0xa69600[_0x4981dc(0x192)][_0x4981dc(0x191)]+'-'+_0xa69600[_0x4981dc(0x192)][_0x4981dc(0x207)];!_0x2b7670[_0x1bb879]&&(_0x2b7670[_0x1bb879]=[]);const _0x58973f=_0x2b7670[_0x1bb879][_0x4981dc(0x122)]((_0x56c7d9,_0x4918af)=>_0x56c7d9+_0x4918af,0x0);_0x184f69+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x58973f!==undefined?formatNumber(_0x58973f[_0x4981dc(0xa5)](0x2)):'')+_0x4981dc(0x1c8),console[_0x4981dc(0x18e)](_0x2b7670[_0x1bb879][_0x4981dc(0x122)]((_0x55a9f1,_0xf8f3a)=>_0x55a9f1+_0xf8f3a,0x0));}_0x184f69+=_0x4981dc(0xb2)+formatNumber(_0xe50601[_0x4981dc(0xa5)](0x2))+_0x4981dc(0x1c8),_0x184f69+=_0x4981dc(0xb2)+formatNumber(_0x2b4f9c)+'</b></td>',_0x184f69+=_0x4981dc(0xb2)+formatNumber(_0x30e08e)+'</b></td>',_0x184f69+=_0x4981dc(0xb2)+formatNumber(_0x5cf007)+_0x4981dc(0x1c8),_0x184f69+=_0x4981dc(0x11f);}_0x526608[_0x4981dc(0x1b5)](_0x184f69);}function _0x3c2a00(_0x3e8a0c,_0x52e462){const _0x472d8d=_0x4981dc,_0x2b8539=[];for(let _0x54410d=0x0;_0x54410d<=_0x3e8a0c[_0x472d8d(0xd8)]-0x1;_0x54410d+=_0x52e462){_0x2b8539[_0x472d8d(0x1b5)](_0x3e8a0c[_0x472d8d(0x12f)](_0x54410d,_0x54410d+_0x52e462));}return _0x2b8539;}const _0x54ef08=_0x3c2a00(_0x526608,_0x43d388);let _0x897cf='';return _0x54ef08[_0x4981dc(0x8a)]((_0x146f57,_0xc3c17e)=>{const _0x24f0ac=_0x4981dc;_0xc3c17e>0x0&&(_0x897cf+=_0x24f0ac(0xeb));_0x897cf+='<table>',_0x897cf+=_0x24f0ac(0x9d),_0x897cf+='<tr>',_0x897cf+=_0x24f0ac(0x1ac),_0x897cf+=_0x24f0ac(0x11f),_0x897cf+='<tr>',_0x897cf+=_0x24f0ac(0x1d6);for(let _0x5ba27c=0x0;_0x5ba27c<=_0x21ea9c[_0x24f0ac(0xd8)]-0x1;_0x5ba27c++){const _0x5d3058=_0x21ea9c[_0x5ba27c];for(let _0x237b99=0x0;_0x237b99<_0x120c6b[_0x24f0ac(0xd8)];_0x237b99++){const _0x217038=_0x120c6b[_0x237b99];_0x217038[_0x24f0ac(0x192)]===_0x5d3058['_id'][_0x24f0ac(0x207)]&&(_0x897cf+=_0x24f0ac(0x1fd)+_0x217038['brandCount']+_0x24f0ac(0xc9)+_0x5d3058[_0x24f0ac(0x192)][_0x24f0ac(0x207)]+_0x24f0ac(0x133));}}_0x897cf+=_0x24f0ac(0xb7),_0x897cf+=_0x24f0ac(0x11f),_0x897cf+=_0x24f0ac(0xa6),_0x897cf+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x897cf+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x897cf+=_0x24f0ac(0x1af);for(let _0x12de14=0x0;_0x12de14<=_0x21ea9c[_0x24f0ac(0xd8)]-0x1;_0x12de14++){const _0x2b985f=_0x21ea9c[_0x12de14];for(let _0x31940d=0x0;_0x31940d<_0x1866e2[_0x24f0ac(0xa0)][_0x24f0ac(0xd8)];_0x31940d++){const _0x1f8301=_0x1866e2[_0x24f0ac(0xa0)][_0x31940d];_0x1f8301['_id'][_0x24f0ac(0x207)]===_0x2b985f[_0x24f0ac(0x192)][_0x24f0ac(0x207)]&&(_0x897cf+='<td\x20class=\x22cat_data\x22>'+_0x1f8301['_id'][_0x24f0ac(0x191)]+_0x24f0ac(0x133));}}_0x897cf+=_0x24f0ac(0xa3),_0x897cf+=_0x24f0ac(0x15d),_0x897cf+=_0x24f0ac(0x1d2),_0x897cf+=_0x24f0ac(0x1f5),_0x897cf+=_0x24f0ac(0x11f),_0x897cf+=_0x24f0ac(0x1e6),_0x897cf+=_0x24f0ac(0x1aa),_0x146f57[_0x24f0ac(0x8a)](_0x3d0dcb=>{_0x897cf+=_0x3d0dcb;}),console[_0x24f0ac(0x18e)](_0x2b7670),_0x897cf+='</tbody>',_0x897cf+=_0x24f0ac(0x99);}),_0x897cf;}router[a0_0x400c41(0x1cc)](a0_0x400c41(0x1c3),auth,async(_0x37e7f3,_0x3f9a96)=>{const _0x10862b=a0_0x400c41,{from_date:_0xf63b96,to_date:_0xe2b468,isExcel:_0x10eb4d}=_0x37e7f3['body'],_0x167814=_0x37e7f3[_0x10862b(0xd7)],_0x36f129=await staff[_0x10862b(0x1da)]({'email':_0x167814[_0x10862b(0x182)]}),_0x2a29ce=await master_shop[_0x10862b(0xcd)](),_0x583962=await agentsdataDSICheck(_0xf63b96,_0xe2b468,_0x36f129[_0x10862b(0x192)][_0x10862b(0x160)](),_0x10eb4d),_0x290101=await agentsdataDSICheck_excel(_0xf63b96,_0xe2b468,_0x36f129['_id'][_0x10862b(0x160)](),_0x10eb4d);let _0x15eea2=_0x10862b(0x134);var _0x58dbb5=new Date(_0xf63b96),_0x40fe84=new Date(_0xe2b468);const _0x4be786={'year':_0x10862b(0x1c1),'month':_0x10862b(0x1a3),'day':_0x10862b(0x1c1)},_0x54f83d=new Intl['DateTimeFormat']('en-US',_0x4be786)[_0x10862b(0x1d3)](_0x58dbb5),_0x370cc6=new Intl[(_0x10862b(0x212))](_0x10862b(0x1cf),_0x4be786)[_0x10862b(0x1d3)](_0x40fe84);_0x15eea2+=_0x10862b(0x1f1),_0x15eea2+=_0x10862b(0x1bc),_0x15eea2+=_0x10862b(0x10a),_0x15eea2+=_0x583962,_0x15eea2+=_0x10862b(0x99),_0x15eea2+=_0x10862b(0xf0),_0x15eea2+=_0x10862b(0xf0);let _0x204f26=_0x10862b(0x134);_0x204f26+=_0x10862b(0x1f1),_0x204f26+=_0x10862b(0x1bc),_0x204f26+=_0x10862b(0x10a),_0x204f26+=_0x290101,_0x204f26+=_0x10862b(0x99),_0x204f26+=_0x10862b(0xf0),_0x204f26+=_0x10862b(0xf0);let _0x46915f=_0x10862b(0x101);const _0x589347={'width':_0x10862b(0xdd),'height':_0x10862b(0x1f3),'orientation':'landscape','border':{'top':_0x10862b(0x17e),'right':'0.1in','bottom':_0x10862b(0x17e),'left':_0x10862b(0x17e)},'header':{'height':_0x10862b(0x94),'contents':_0x10862b(0xb5)+_0x46915f+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x54f83d+'\x20-\x20'+_0x370cc6+_0x10862b(0x146)},'footer':{'height':_0x10862b(0x8d),'contents':{'default':_0x10862b(0x8e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x10862b(0x143)}}};if(_0x10eb4d=='on'){const _0xc84f2b=cheerio[_0x10862b(0x1e3)](_0x204f26);let _0x458be2=[],_0x42c268=[],_0x573bac=[];const _0x284371=_0xa5dc3c=>{const _0x3e05fd=_0x10862b,_0x6a71cf={'top':{'style':_0x3e05fd(0x148),'color':{'rgb':'000000'}},'bottom':{'style':'thick','color':{'rgb':'000000'}},'left':{'style':_0x3e05fd(0x148),'color':{'rgb':_0x3e05fd(0x17c)}},'right':{'style':_0x3e05fd(0x148),'color':{'rgb':'000000'}}};if(_0xa5dc3c){const _0x451458=_0xa5dc3c[_0x3e05fd(0x179)](';')[_0x3e05fd(0x122)]((_0x2411e1,_0x72fa98)=>{const _0x3a9198=_0x3e05fd,[_0x5302ea,_0x50c1a4]=_0x72fa98[_0x3a9198(0x179)](':')[_0x3a9198(0x124)](_0x14c041=>_0x14c041['trim']());return _0x2411e1[_0x5302ea]=_0x50c1a4,_0x2411e1;},{});_0x451458[_0x3e05fd(0xbb)]&&(_0x6a71cf[_0x3e05fd(0x190)]['style']=_0x451458[_0x3e05fd(0xbb)][_0x3e05fd(0xea)](_0x3e05fd(0x18a))?_0x3e05fd(0x18a):'medium'),_0x451458['border-bottom']&&(_0x6a71cf[_0x3e05fd(0x20b)][_0x3e05fd(0x208)]=_0x451458['border-bottom']['includes'](_0x3e05fd(0x18a))?_0x3e05fd(0x18a):_0x3e05fd(0x157)),_0x451458[_0x3e05fd(0x1dc)]&&(_0x6a71cf[_0x3e05fd(0x130)][_0x3e05fd(0x208)]=_0x451458[_0x3e05fd(0x1dc)]['includes'](_0x3e05fd(0x18a))?_0x3e05fd(0x18a):'medium'),_0x451458[_0x3e05fd(0xbd)]&&(_0x6a71cf[_0x3e05fd(0x11e)][_0x3e05fd(0x208)]=_0x451458[_0x3e05fd(0xbd)][_0x3e05fd(0xea)](_0x3e05fd(0x18a))?_0x3e05fd(0x18a):_0x3e05fd(0x157));}return _0x6a71cf;};_0xc84f2b(_0x10862b(0x10e))['each']((_0x418e63,_0x323a4f)=>{const _0x36427d=_0x10862b;let _0x1ec8f2=[],_0x1153b5=0x0;while(_0x573bac[_0x1153b5]){_0x573bac[_0x1153b5]--,_0x1153b5++;}_0xc84f2b(_0x323a4f)[_0x36427d(0xcd)](_0x36427d(0x166))[_0x36427d(0x14a)]((_0x2cb472,_0x5ec8ed)=>{const _0x4ec2d6=_0x36427d;let _0x46509c=_0xc84f2b(_0x5ec8ed)['text']()[_0x4ec2d6(0x1db)](),_0x2b644d=parseFloat(_0x46509c[_0x4ec2d6(0x13a)](/,/g,'')),_0x24e87c={};!isNaN(_0x2b644d)?(_0x24e87c['v']=_0x2b644d,_0x24e87c['t']='n'):(_0x24e87c['v']=_0x46509c,_0x24e87c['t']='s');const _0xe20827=_0xc84f2b(_0x5ec8ed)[_0x4ec2d6(0x105)]('style'),_0x257e7f=_0x284371(_0xe20827);_0x24e87c['s']={'border':_0x257e7f},_0x1ec8f2[_0x1153b5]=_0x24e87c;let _0x18b1b6=parseInt(_0xc84f2b(_0x5ec8ed)['attr']('colspan'))||0x1,_0x11a1aa=parseInt(_0xc84f2b(_0x5ec8ed)[_0x4ec2d6(0x105)](_0x4ec2d6(0x180)))||0x1;(_0x18b1b6>0x1||_0x11a1aa>0x1)&&_0x42c268[_0x4ec2d6(0x1b5)]({'s':{'r':_0x418e63,'c':_0x1153b5},'e':{'r':_0x418e63+_0x11a1aa-0x1,'c':_0x1153b5+_0x18b1b6-0x1}});for(let _0x5d3bdb=0x0;_0x5d3bdb<_0x18b1b6;_0x5d3bdb++){_0x11a1aa>0x1&&(_0x573bac[_0x1153b5+_0x5d3bdb]=_0x11a1aa-0x1);}_0x1153b5+=_0x18b1b6;}),_0x458be2[_0x36427d(0x1b5)](_0x1ec8f2);});const _0x1a4dcb=XLSX[_0x10862b(0xc3)]['book_new'](),_0x125f7e=XLSX[_0x10862b(0xc3)]['aoa_to_sheet'](_0x458be2);_0x42c268[_0x10862b(0xd8)]>0x0&&(_0x125f7e[_0x10862b(0xaf)]=_0x42c268);_0x125f7e['!cols']=_0x458be2[0x0][_0x10862b(0x124)](()=>({'wpx':0x64})),XLSX[_0x10862b(0xc3)][_0x10862b(0x9b)](_0x1a4dcb,_0x125f7e,_0x10862b(0x102));const _0x53706a=XLSX['write'](_0x1a4dcb,{'bookType':_0x10862b(0xd3),'type':'buffer'});_0x3f9a96['setHeader'](_0x10862b(0x147),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x3f9a96[_0x10862b(0x12e)](_0x10862b(0x100),_0x10862b(0x1a2)),_0x3f9a96['send'](_0x53706a);}else pdf[_0x10862b(0x11b)](_0x15eea2,_0x589347)[_0x10862b(0x137)](function(_0x2e15ca,_0x575525){const _0x504abf=_0x10862b;if(_0x2e15ca){console[_0x504abf(0x1d9)]('PDF\x20Generation\x20Error:',_0x2e15ca),_0x3f9a96['status'](0x1f4)['send'](_0x504abf(0x1e0)+_0x2e15ca);return;}_0x3f9a96['setHeader'](_0x504abf(0x100),_0x504abf(0x1b6)),_0x575525[_0x504abf(0x14d)](_0x3f9a96);});}),router['get']('/total_sales_reports/view',auth,async(_0x377839,_0x4211ce)=>{const _0x4ecbc6=a0_0x400c41;try{const {username:_0xb6a6b5,email:_0x39d466,role:_0x234f0d}=_0x377839[_0x4ecbc6(0xd7)],_0x706f33=_0x377839[_0x4ecbc6(0xd7)],_0xfbc9de=await profile[_0x4ecbc6(0x1da)]({'email':_0x706f33[_0x4ecbc6(0x182)]}),_0x47ce16={'year':_0x4ecbc6(0x1c1),'month':_0x4ecbc6(0x1a3),'day':_0x4ecbc6(0x1c1)},_0x3c7e20=await master_shop['find'](),_0x1f3aa2=await product[_0x4ecbc6(0xcd)](),_0x1cca9a=await warehouse[_0x4ecbc6(0x186)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x4ecbc6(0x142),'localField':_0x4ecbc6(0x18b),'foreignField':_0x4ecbc6(0x1bd),'as':_0x4ecbc6(0xd6)}},{'$unwind':_0x4ecbc6(0x199)},{'$project':{'product_name':_0x4ecbc6(0x1f9),'product_stock':_0x4ecbc6(0x1ef)}},{'$group':{'_id':_0x4ecbc6(0x15b),'product_stock':{'$sum':_0x4ecbc6(0x10b)}}}]),_0x4a3a23=await staff[_0x4ecbc6(0x1da)]({'email':_0x706f33[_0x4ecbc6(0x182)]});if(_0x3c7e20[0x0][_0x4ecbc6(0x1fc)]==_0x4ecbc6(0x145))var _0x475a4b=users[_0x4ecbc6(0x110)];else{if(_0x3c7e20[0x0][_0x4ecbc6(0x1fc)]==_0x4ecbc6(0xe4))var _0x475a4b=users['Hindi'];else{if(_0x3c7e20[0x0][_0x4ecbc6(0x1fc)]=='German')var _0x475a4b=users[_0x4ecbc6(0x90)];else{if(_0x3c7e20[0x0][_0x4ecbc6(0x1fc)]==_0x4ecbc6(0x117))var _0x475a4b=users[_0x4ecbc6(0x117)];else{if(_0x3c7e20[0x0][_0x4ecbc6(0x1fc)]==_0x4ecbc6(0x177))var _0x475a4b=users[_0x4ecbc6(0x177)];else{if(_0x3c7e20[0x0][_0x4ecbc6(0x1fc)]==_0x4ecbc6(0x108))var _0x475a4b=users['Portuguese'];else{if(_0x3c7e20[0x0][_0x4ecbc6(0x1fc)]==_0x4ecbc6(0x18f))var _0x475a4b=users[_0x4ecbc6(0x18f)];else{if(_0x3c7e20[0x0]['language']==_0x4ecbc6(0x15a))var _0x475a4b=users[_0x4ecbc6(0xb9)];}}}}}}}_0x4211ce[_0x4ecbc6(0xc0)](_0x4ecbc6(0x1ed),{'success':_0x377839[_0x4ecbc6(0x211)](_0x4ecbc6(0xc2)),'errors':_0x377839[_0x4ecbc6(0x211)](_0x4ecbc6(0x16b)),'alldata':_0x1f3aa2,'profile':_0xfbc9de,'master_shop':_0x3c7e20,'role':_0x706f33,'product_stock':_0x1cca9a,'language':_0x475a4b,'staff_arr':_0x4a3a23});}catch(_0xdccf9f){}});async function dataSalesReports(_0x130aea,_0xfc74ce,_0x2f8d95){const _0x23dcb5=a0_0x400c41;let _0x583d41='';const _0x4fb795=await sales_sa[_0x23dcb5(0x186)]([{'$match':{'date':{'$gte':_0x130aea,'$lte':_0xfc74ce},'sales_staff_id':_0x2f8d95}},{'$unwind':_0x23dcb5(0xde)},{'$match':{'sale_product.isFG':_0x23dcb5(0xbf)}},{'$group':{'_id':{'product_name':_0x23dcb5(0x203),'product_code':_0x23dcb5(0x1e8)},'sumqty':{'$sum':_0x23dcb5(0x169)},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x3b143d=0x0,_0x117ac2=0x0;for(let _0x2f6287=0x0;_0x2f6287<=_0x4fb795['length']-0x1;_0x2f6287++){const _0x591fc5=_0x4fb795[_0x2f6287];var _0x131f6e=_0x591fc5[_0x23dcb5(0xca)]['toLocaleString'](undefined),_0x36c1fa=_0x591fc5['sumqty']['toLocaleString'](undefined);_0x583d41+=_0x23dcb5(0xa6),_0x583d41+=_0x23dcb5(0xf3)+_0x591fc5[_0x23dcb5(0x192)][_0x23dcb5(0x11d)]+'</td>',_0x583d41+=_0x23dcb5(0xf3)+_0x591fc5[_0x23dcb5(0x192)]['product_name']+_0x23dcb5(0x133),_0x583d41+=_0x23dcb5(0xf3)+formatNumber(_0x591fc5[_0x23dcb5(0xfd)]['toFixed'](0x2))+_0x23dcb5(0x133),_0x583d41+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x591fc5['totalPrice'][_0x23dcb5(0xa5)](0x2))+_0x23dcb5(0x133),_0x583d41+=_0x23dcb5(0x11f),_0x3b143d+=parseFloat(_0x591fc5[_0x23dcb5(0xfd)]),_0x117ac2+=parseFloat(_0x591fc5[_0x23dcb5(0xca)]);}var _0x14d872=_0x117ac2[_0x23dcb5(0x197)](undefined),_0x4881fd=_0x3b143d[_0x23dcb5(0x197)](undefined);return _0x583d41+='<tr>',_0x583d41+=_0x23dcb5(0xc4),_0x583d41+=_0x23dcb5(0x16e)+formatNumber(_0x3b143d[_0x23dcb5(0xa5)](0x2))+_0x23dcb5(0x1c8),_0x583d41+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x117ac2[_0x23dcb5(0xa5)](0x2))+'</b></td>',_0x583d41+=_0x23dcb5(0x11f),_0x583d41;}router[a0_0x400c41(0x1cc)](a0_0x400c41(0x104),auth,async(_0x464448,_0x1f90f6)=>{const _0x5b2b85=a0_0x400c41;try{const {from_date:_0x5cc6ba,to_date:_0x4fe44e,isExcel:_0x5c8b8a}=_0x464448[_0x5b2b85(0x97)],_0x463e88=_0x464448[_0x5b2b85(0xd7)],_0x35469f=await staff['findOne']({'email':_0x463e88[_0x5b2b85(0x182)]});let _0x1d7e38=_0x5b2b85(0x128);var _0x57def9=new Date(_0x5cc6ba),_0x4e58e8=new Date(_0x4fe44e);const _0x18a885={'year':_0x5b2b85(0x1c1),'month':_0x5b2b85(0x1a3),'day':_0x5b2b85(0x1c1)},_0x10e154=new Intl['DateTimeFormat'](_0x5b2b85(0x1cf),_0x18a885)[_0x5b2b85(0x1d3)](_0x57def9),_0x371df6=new Intl[(_0x5b2b85(0x212))](_0x5b2b85(0x1cf),_0x18a885)[_0x5b2b85(0x1d3)](_0x4e58e8);var _0x257565=await dataSalesReports(_0x5cc6ba,_0x4fe44e,_0x35469f[_0x5b2b85(0x192)][_0x5b2b85(0x160)]());_0x1d7e38+='<div\x20class=\x22row\x22>',_0x1d7e38+=_0x5b2b85(0x1b0),_0x1d7e38+=_0x5b2b85(0x10a),_0x1d7e38+=_0x5b2b85(0xa6),_0x1d7e38+=_0x5b2b85(0x184),_0x1d7e38+=_0x5b2b85(0x125),_0x1d7e38+=_0x5b2b85(0x1ad),_0x1d7e38+=_0x5b2b85(0xb8),_0x1d7e38+='<tr>',_0x1d7e38+=_0x257565,_0x1d7e38+='</tr>',_0x1d7e38+=_0x5b2b85(0xf0),_0x1d7e38+='</div>';let _0x1416e5=_0x5b2b85(0x101);const _0xb41011={'width':_0x5b2b85(0xdd),'height':_0x5b2b85(0x1f3),'orientation':'landscape','border':{'top':_0x5b2b85(0x17e),'right':'0.1in','bottom':_0x5b2b85(0x17e),'left':_0x5b2b85(0x17e)},'header':{'height':_0x5b2b85(0x94),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x1416e5+_0x5b2b85(0x1b1)+_0x35469f[_0x5b2b85(0x1bd)]+_0x5b2b85(0x1c6)+_0x10e154+'\x20-\x20'+_0x371df6+_0x5b2b85(0x146)},'footer':{'height':_0x5b2b85(0x8d),'contents':{'default':_0x5b2b85(0x8e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x5b2b85(0x143)}}};if(_0x5c8b8a=='on'){const _0x42a82c=cheerio[_0x5b2b85(0x1e3)](_0x1d7e38);let _0x14d93a=[],_0x93841=[],_0x4501c1=[];const _0x5e0e94=_0x5ec0c3=>{const _0x43cedf=_0x5b2b85,_0x26bf45={'top':{'style':'thick','color':{'rgb':_0x43cedf(0x17c)}},'bottom':{'style':_0x43cedf(0x148),'color':{'rgb':_0x43cedf(0x17c)}},'left':{'style':'thick','color':{'rgb':_0x43cedf(0x17c)}},'right':{'style':'thick','color':{'rgb':_0x43cedf(0x17c)}}};if(_0x5ec0c3){const _0x4cc418=_0x5ec0c3[_0x43cedf(0x179)](';')[_0x43cedf(0x122)]((_0x1a7a03,_0x202b42)=>{const _0x2e8577=_0x43cedf,[_0x333b5e,_0x85be5a]=_0x202b42[_0x2e8577(0x179)](':')['map'](_0x383327=>_0x383327[_0x2e8577(0x1db)]());return _0x1a7a03[_0x333b5e]=_0x85be5a,_0x1a7a03;},{});_0x4cc418['border-top']&&(_0x26bf45[_0x43cedf(0x190)][_0x43cedf(0x208)]=_0x4cc418['border-top'][_0x43cedf(0xea)](_0x43cedf(0x18a))?_0x43cedf(0x18a):_0x43cedf(0x157)),_0x4cc418[_0x43cedf(0x218)]&&(_0x26bf45['bottom'][_0x43cedf(0x208)]=_0x4cc418[_0x43cedf(0x218)][_0x43cedf(0xea)]('thin')?_0x43cedf(0x18a):_0x43cedf(0x157)),_0x4cc418[_0x43cedf(0x1dc)]&&(_0x26bf45[_0x43cedf(0x130)][_0x43cedf(0x208)]=_0x4cc418[_0x43cedf(0x1dc)][_0x43cedf(0xea)](_0x43cedf(0x18a))?'thin':_0x43cedf(0x157)),_0x4cc418['border-right']&&(_0x26bf45[_0x43cedf(0x11e)][_0x43cedf(0x208)]=_0x4cc418[_0x43cedf(0xbd)][_0x43cedf(0xea)](_0x43cedf(0x18a))?_0x43cedf(0x18a):'medium');}return _0x26bf45;};_0x42a82c(_0x5b2b85(0x10e))[_0x5b2b85(0x14a)]((_0x20cea0,_0x5c5ff1)=>{const _0x54f240=_0x5b2b85;let _0x4a7b7f=[],_0x489d12=0x0;while(_0x4501c1[_0x489d12]){_0x4501c1[_0x489d12]--,_0x489d12++;}_0x42a82c(_0x5c5ff1)[_0x54f240(0xcd)](_0x54f240(0x166))[_0x54f240(0x14a)]((_0x154ddb,_0x53edd9)=>{const _0x3f2424=_0x54f240;let _0x90d00d=_0x42a82c(_0x53edd9)[_0x3f2424(0x187)]()['trim'](),_0x4d8efb=parseFloat(_0x90d00d[_0x3f2424(0x13a)](/,/g,'')),_0xb11ba8={};!isNaN(_0x4d8efb)?(_0xb11ba8['v']=_0x4d8efb,_0xb11ba8['t']='n'):(_0xb11ba8['v']=_0x90d00d,_0xb11ba8['t']='s');const _0x3c60ea=_0x42a82c(_0x53edd9)[_0x3f2424(0x105)]('style'),_0x7cb07a=_0x5e0e94(_0x3c60ea);_0xb11ba8['s']={'border':_0x7cb07a},_0x4a7b7f[_0x489d12]=_0xb11ba8;let _0x56d68f=parseInt(_0x42a82c(_0x53edd9)[_0x3f2424(0x105)](_0x3f2424(0xdf)))||0x1,_0x42c37e=parseInt(_0x42a82c(_0x53edd9)[_0x3f2424(0x105)](_0x3f2424(0x180)))||0x1;(_0x56d68f>0x1||_0x42c37e>0x1)&&_0x93841[_0x3f2424(0x1b5)]({'s':{'r':_0x20cea0,'c':_0x489d12},'e':{'r':_0x20cea0+_0x42c37e-0x1,'c':_0x489d12+_0x56d68f-0x1}});for(let _0x4e7d00=0x0;_0x4e7d00<_0x56d68f;_0x4e7d00++){_0x42c37e>0x1&&(_0x4501c1[_0x489d12+_0x4e7d00]=_0x42c37e-0x1);}_0x489d12+=_0x56d68f;}),_0x14d93a['push'](_0x4a7b7f);});const _0x5c8182=XLSX[_0x5b2b85(0xc3)][_0x5b2b85(0x161)](),_0x2c8e78=XLSX['utils'][_0x5b2b85(0x176)](_0x14d93a);_0x93841['length']>0x0&&(_0x2c8e78[_0x5b2b85(0xaf)]=_0x93841);_0x2c8e78[_0x5b2b85(0xf7)]=_0x14d93a[0x0][_0x5b2b85(0x124)](()=>({'wpx':0x64})),XLSX[_0x5b2b85(0xc3)][_0x5b2b85(0x9b)](_0x5c8182,_0x2c8e78,_0x5b2b85(0x102));const _0x41d934=XLSX['write'](_0x5c8182,{'bookType':'xlsx','type':_0x5b2b85(0x129)});_0x1f90f6['setHeader'](_0x5b2b85(0x147),_0x5b2b85(0x14b)),_0x1f90f6[_0x5b2b85(0x12e)](_0x5b2b85(0x100),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x1f90f6[_0x5b2b85(0x1d7)](_0x41d934);}else pdf[_0x5b2b85(0x11b)](_0x1d7e38,_0xb41011)['toStream'](function(_0x231a0d,_0x8f8692){const _0xf00e7e=_0x5b2b85;if(_0x231a0d){_0x1f90f6[_0xf00e7e(0x1e7)](0x1f4)['send'](_0xf00e7e(0x1e0));return;}_0x1f90f6[_0xf00e7e(0x12e)](_0xf00e7e(0x100),_0xf00e7e(0x1b6)),_0x8f8692[_0xf00e7e(0x14d)](_0x1f90f6);});}catch(_0x1aad5c){}}),router[a0_0x400c41(0x127)](a0_0x400c41(0x18c),auth,async(_0x2efdb2,_0x10f279)=>{const _0x409abf=a0_0x400c41;try{const {username:_0x2f6493,email:_0x32e131,role:_0x33e439}=_0x2efdb2['user'],_0x395932=_0x2efdb2[_0x409abf(0xd7)],_0x33919a=await profile[_0x409abf(0x1da)]({'email':_0x395932['email']}),_0x152890={'year':'numeric','month':_0x409abf(0x1a3),'day':_0x409abf(0x1c1)},_0x6cb633=await master_shop[_0x409abf(0xcd)](),_0x4975ef=await product[_0x409abf(0xcd)](),_0x1af627=await warehouse[_0x409abf(0x186)]([{'$unwind':_0x409abf(0xfe)},{'$lookup':{'from':_0x409abf(0x142),'localField':_0x409abf(0x18b),'foreignField':_0x409abf(0x1bd),'as':'product_docs'}},{'$unwind':_0x409abf(0x199)},{'$project':{'product_name':_0x409abf(0x1f9),'product_stock':_0x409abf(0x1ef)}},{'$group':{'_id':_0x409abf(0x15b),'product_stock':{'$sum':_0x409abf(0x10b)}}}]);if(_0x6cb633[0x0][_0x409abf(0x1fc)]==_0x409abf(0x145))var _0x47367d=users[_0x409abf(0x110)];else{if(_0x6cb633[0x0][_0x409abf(0x1fc)]==_0x409abf(0xe4))var _0x47367d=users[_0x409abf(0xe4)];else{if(_0x6cb633[0x0][_0x409abf(0x1fc)]=='German')var _0x47367d=users['German'];else{if(_0x6cb633[0x0]['language']==_0x409abf(0x117))var _0x47367d=users[_0x409abf(0x117)];else{if(_0x6cb633[0x0][_0x409abf(0x1fc)]==_0x409abf(0x177))var _0x47367d=users[_0x409abf(0x177)];else{if(_0x6cb633[0x0][_0x409abf(0x1fc)]==_0x409abf(0x108))var _0x47367d=users[_0x409abf(0x1a9)];else{if(_0x6cb633[0x0][_0x409abf(0x1fc)]==_0x409abf(0x18f))var _0x47367d=users[_0x409abf(0x18f)];else{if(_0x6cb633[0x0][_0x409abf(0x1fc)]==_0x409abf(0x15a))var _0x47367d=users[_0x409abf(0xb9)];}}}}}}}_0x10f279['render'](_0x409abf(0x1f4),{'success':_0x2efdb2[_0x409abf(0x211)](_0x409abf(0xc2)),'errors':_0x2efdb2['flash'](_0x409abf(0x16b)),'alldata':_0x4975ef,'profile':_0x33919a,'master_shop':_0x6cb633,'role':_0x395932,'product_stock':_0x1af627,'language':_0x47367d});}catch(_0x237695){}});async function dataInventoryReports(_0x4483af,_0xc19113,_0x2ef1ba){const _0x264776=a0_0x400c41,_0xae5636=await sales_sa[_0x264776(0x186)]([{'$match':{'date':{'$gte':_0x4483af,'$lte':_0xc19113},'sales_staff_id':_0x2ef1ba}},{'$unwind':_0x264776(0xde)},{'$group':{'_id':{'product_name':_0x264776(0x203),'product_code':_0x264776(0x1e8)},'sumqty':{'$sum':_0x264776(0x91)}}},{'$sort':{'_id.product_name':0x1}}]),_0x5bba30=mongoose['Types'][_0x264776(0xd9)],_0x3f1e40=await staff[_0x264776(0x186)]([{'$match':{'_id':_0x5bba30(_0x2ef1ba)}},{'$unwind':_0x264776(0x204)},{'$match':{'product_list.isConfirm':_0x264776(0x183)}},{'$group':{'_id':{'product_name':_0x264776(0x1eb),'product_code':_0x264776(0x163)},'sumqty':{'$sum':_0x264776(0x1f8)}}},{'$sort':{'_id.product_name':0x1}}]),_0x599dbf=await sales_inv_data[_0x264776(0x186)]([{'$match':{'date':{'$gte':_0x4483af,'$lte':_0xc19113},'sales_staff_id':_0x2ef1ba}},{'$unwind':_0x264776(0xde)},{'$group':{'_id':{'product_name':_0x264776(0x203),'product_code':_0x264776(0x1e8)},'totalQTYsum':{'$sum':_0x264776(0x14f)}}}]);console[_0x264776(0x18e)](_0x599dbf);let _0x58e114='';var _0x39e4b9=0x0;for(let _0xd10647=0x0;_0xd10647<=_0x3f1e40[_0x264776(0xd8)]-0x1;_0xd10647++){const _0x42defa=_0x3f1e40[_0xd10647];_0x58e114+=_0x264776(0xa6),_0x58e114+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>'+_0x42defa[_0x264776(0x192)][_0x264776(0x11d)]+_0x264776(0x133),_0x58e114+=_0x264776(0x1fa)+_0x42defa['_id'][_0x264776(0xb6)]+_0x264776(0x133);var _0x304183=_0x42defa[_0x264776(0xfd)],_0x4fd2e5=0x0;for(let _0x3613db=0x0;_0x3613db<=_0xae5636[_0x264776(0xd8)]-0x1;_0x3613db++){const _0x13fa35=_0xae5636[_0x3613db];_0x42defa[_0x264776(0x192)][_0x264776(0x11d)]==_0x13fa35[_0x264776(0x192)][_0x264776(0x11d)]&&_0x42defa[_0x264776(0x192)]['product_name']==_0x13fa35['_id'][_0x264776(0xb6)]&&(_0x4fd2e5=_0x13fa35[_0x264776(0xfd)]);}var _0x214eca=0x0;for(let _0x2f3669=0x0;_0x2f3669<=_0x599dbf[_0x264776(0xd8)]-0x1;_0x2f3669++){const _0x49a33e=_0x599dbf[_0x2f3669];_0x42defa[_0x264776(0x192)]['product_code']==_0x49a33e['_id'][_0x264776(0x11d)]&&_0x42defa[_0x264776(0x192)][_0x264776(0xb6)]==_0x49a33e[_0x264776(0x192)][_0x264776(0xb6)]&&(_0x214eca=_0x49a33e[_0x264776(0x116)]);}_0x39e4b9=_0x304183-_0x214eca+_0x4fd2e5,_0x58e114+='<td\x20class=\x22row_data\x22>'+_0x39e4b9+'</td>';let _0x5612c2=![];for(let _0x23e970=0x0;_0x23e970<=_0x599dbf[_0x264776(0xd8)]-0x1;_0x23e970++){const _0x359396=_0x599dbf[_0x23e970];if(_0x42defa[_0x264776(0x192)][_0x264776(0x11d)]==_0x359396[_0x264776(0x192)]['product_code']&&_0x42defa['_id']['product_name']==_0x359396['_id'][_0x264776(0xb6)]){_0x58e114+=_0x264776(0xf3)+_0x359396['totalQTYsum']+_0x264776(0x133),_0x5612c2=!![];break;}}!_0x5612c2&&(_0x58e114+=_0x264776(0xff));let _0x19f2f2=![];for(let _0x1c7ae2=0x0;_0x1c7ae2<=_0xae5636[_0x264776(0xd8)]-0x1;_0x1c7ae2++){const _0x359d63=_0xae5636[_0x1c7ae2];if(_0x42defa[_0x264776(0x192)]['product_code']==_0x359d63['_id'][_0x264776(0x11d)]&&_0x42defa[_0x264776(0x192)][_0x264776(0xb6)]==_0x359d63[_0x264776(0x192)]['product_name']){_0x58e114+=_0x264776(0xf3)+_0x359d63[_0x264776(0xfd)]+_0x264776(0x133),_0x19f2f2=!![];break;}}!_0x19f2f2&&(_0x58e114+=_0x264776(0xff)),_0x58e114+=_0x264776(0xf3)+_0x42defa[_0x264776(0xfd)]+_0x264776(0x133),_0x58e114+=_0x264776(0x11f);}return _0x58e114;}router[a0_0x400c41(0x1cc)]('/inventory_sum/pdf',auth,async(_0x311662,_0x367b92)=>{const _0x2f3b7d=a0_0x400c41;try{const {from_date:_0x5daf28,to_date:_0x1b0e2a}=_0x311662[_0x2f3b7d(0x97)],_0x10f107=_0x311662['user'],_0x366888=await staff['findOne']({'email':_0x10f107[_0x2f3b7d(0x182)]});let _0x2b23e8=_0x2f3b7d(0x128);var _0x4be2bd=new Date(_0x5daf28),_0x3bd00c=new Date(_0x1b0e2a);const _0x2fc3cf={'year':_0x2f3b7d(0x1c1),'month':_0x2f3b7d(0x1a3),'day':'numeric'},_0x2079b6=new Intl[(_0x2f3b7d(0x212))]('en-US',_0x2fc3cf)['format'](_0x4be2bd),_0xd6747=new Intl[(_0x2f3b7d(0x212))](_0x2f3b7d(0x1cf),_0x2fc3cf)[_0x2f3b7d(0x1d3)](_0x3bd00c);var _0x219d5d=await dataInventoryReports(_0x5daf28,_0x1b0e2a,_0x366888[_0x2f3b7d(0x192)]['valueOf']());_0x2b23e8+=_0x2f3b7d(0x1a5),_0x2b23e8+=_0x2f3b7d(0xe7),_0x2b23e8+=_0x2f3b7d(0x20d)+_0x2079b6+_0x2f3b7d(0x1ca)+_0xd6747+'</p>',_0x2b23e8+=_0x2f3b7d(0x1f1),_0x2b23e8+=_0x2f3b7d(0x1b0),_0x2b23e8+=_0x2f3b7d(0x10a),_0x2b23e8+=_0x2f3b7d(0xa6),_0x2b23e8+=_0x2f3b7d(0x184),_0x2b23e8+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x2b23e8+=_0x2f3b7d(0xf4),_0x2b23e8+='<th>\x20INCOMING\x20</th>',_0x2b23e8+=_0x2f3b7d(0xc8),_0x2b23e8+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x2b23e8+=_0x2f3b7d(0xa6),_0x2b23e8+=_0x219d5d,_0x2b23e8+=_0x2f3b7d(0x11f),_0x2b23e8+=_0x2f3b7d(0xf0),_0x2b23e8+=_0x2f3b7d(0xf0);const _0x5e03e0={'format':_0x2f3b7d(0x10c),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x2f3b7d(0x143)}}};pdf[_0x2f3b7d(0x11b)](_0x2b23e8,_0x5e03e0)['toStream'](function(_0x3fc80a,_0x460586){const _0x14c8c7=_0x2f3b7d;if(_0x3fc80a){_0x367b92['status'](0x1f4)[_0x14c8c7(0x1d7)](_0x14c8c7(0x1e0));return;}_0x367b92['setHeader'](_0x14c8c7(0x100),_0x14c8c7(0x1b6)),_0x460586[_0x14c8c7(0x14d)](_0x367b92);});}catch(_0x2ff9b9){}}),router[a0_0x400c41(0x127)](a0_0x400c41(0x1ce),auth,async(_0x48b4a6,_0x52d1be)=>{const _0x2c240f=a0_0x400c41;try{const {username:_0x233f3e,email:_0x23119f,role:_0x3ae669}=_0x48b4a6[_0x2c240f(0xd7)],_0xac74b1=_0x48b4a6[_0x2c240f(0xd7)],_0x5f5851=await profile[_0x2c240f(0x1da)]({'email':_0xac74b1[_0x2c240f(0x182)]}),_0xffd8eb={'year':_0x2c240f(0x1c1),'month':_0x2c240f(0x1a3),'day':_0x2c240f(0x1c1)},_0x347140=await master_shop[_0x2c240f(0xcd)]();console['log'](_0x2c240f(0x118),_0x347140);const _0x1f4d15=await product[_0x2c240f(0xcd)]();console[_0x2c240f(0x18e)]('Products\x20find_data',_0x1f4d15);const _0xcd9d55=await warehouse[_0x2c240f(0x186)]([{'$unwind':_0x2c240f(0xfe)},{'$lookup':{'from':_0x2c240f(0x142),'localField':_0x2c240f(0x18b),'foreignField':_0x2c240f(0x1bd),'as':_0x2c240f(0xd6)}},{'$unwind':_0x2c240f(0x199)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x2c240f(0x1ef)}},{'$group':{'_id':_0x2c240f(0x15b),'product_stock':{'$sum':_0x2c240f(0x10b)}}}]);console[_0x2c240f(0x18e)](_0x2c240f(0x16d),_0xcd9d55),_0xcd9d55[_0x2c240f(0x8a)](_0x2fa575=>{const _0x6f080a=_0x1f4d15['map'](_0x1c28e3=>{const _0xd10abc=a0_0x29cf;_0x1c28e3[_0xd10abc(0x1bd)]==_0x2fa575[_0xd10abc(0x192)]&&(_0x1c28e3[_0xd10abc(0x96)]=parseInt(_0x1c28e3[_0xd10abc(0x96)])+parseInt(_0x2fa575[_0xd10abc(0x16c)]));});});const _0x2a140c=await staff[_0x2c240f(0x1da)]({'email':_0xac74b1[_0x2c240f(0x182)]});if(_0x347140[0x0][_0x2c240f(0x1fc)]==_0x2c240f(0x145))var _0x34bd63=users[_0x2c240f(0x110)];else{if(_0x347140[0x0][_0x2c240f(0x1fc)]=='Hindi')var _0x34bd63=users[_0x2c240f(0xe4)];else{if(_0x347140[0x0][_0x2c240f(0x1fc)]==_0x2c240f(0x90))var _0x34bd63=users[_0x2c240f(0x90)];else{if(_0x347140[0x0][_0x2c240f(0x1fc)]==_0x2c240f(0x117))var _0x34bd63=users[_0x2c240f(0x117)];else{if(_0x347140[0x0][_0x2c240f(0x1fc)]==_0x2c240f(0x177))var _0x34bd63=users[_0x2c240f(0x177)];else{if(_0x347140[0x0]['language']==_0x2c240f(0x108))var _0x34bd63=users['Portuguese'];else{if(_0x347140[0x0]['language']==_0x2c240f(0x18f))var _0x34bd63=users['Chinese'];else{if(_0x347140[0x0][_0x2c240f(0x1fc)]=='Arabic\x20(ae)')var _0x34bd63=users[_0x2c240f(0xb9)];}}}}}}}_0x52d1be[_0x2c240f(0xc0)](_0x2c240f(0x1ff),{'success':_0x48b4a6[_0x2c240f(0x211)](_0x2c240f(0xc2)),'errors':_0x48b4a6[_0x2c240f(0x211)](_0x2c240f(0x16b)),'alldata':_0x1f4d15,'profile':_0x5f5851,'master_shop':_0x347140,'role':_0xac74b1,'product_stock':_0xcd9d55,'language':_0x34bd63,'staff_arr':_0x2a140c});}catch(_0x16cdb4){}});async function agentsdataDSICheck_DSRR(_0x43bd1c,_0x418804,_0x1bd9d7,_0x38c18d){const _0x5f4de1=a0_0x400c41;let _0x532ac7=new Date(_0x43bd1c);_0x532ac7[_0x5f4de1(0x19f)](_0x532ac7[_0x5f4de1(0x15e)]()-0x1);let _0x16a64d=_0x532ac7[_0x5f4de1(0x201)]()[_0x5f4de1(0x179)]('T')[0x0];const _0x48d0e5=await product[_0x5f4de1(0x186)]([{'$group':{'_id':{'brand':_0x5f4de1(0x10f),'category':'$category'},'products':{'$push':{'name':_0x5f4de1(0xda),'product_code':_0x5f4de1(0x1a1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1aed42=[];_0x1aed42['cat_brand']=[];for(let _0x5c87b5=0x0;_0x5c87b5<=_0x48d0e5[_0x5f4de1(0xd8)]-0x1;_0x5c87b5++){const _0x55c1f4=_0x48d0e5[_0x5c87b5];_0x1aed42[_0x5f4de1(0xa0)][_0x5f4de1(0x1b5)](_0x55c1f4);}const _0x2080fd=await product[_0x5f4de1(0x186)]([{'$group':{'_id':{'category':_0x5f4de1(0xcc)},'products':{'$push':{'brand':_0x5f4de1(0x10f),'product_code':_0x5f4de1(0x1a1),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1159c7=await product[_0x5f4de1(0x186)]([{'$group':{'_id':{'category':_0x5f4de1(0xcc),'brand':_0x5f4de1(0x10f)}}},{'$group':{'_id':_0x5f4de1(0x17a),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3e8dbf=await sales_sa[_0x5f4de1(0x186)]([{'$match':{'date':_0x43bd1c,'sales_staff_id':_0x418804,'sale_product.isFG':_0x5f4de1(0xbf)}},{'$unwind':_0x5f4de1(0xde)},{'$lookup':{'from':'products','localField':_0x5f4de1(0x121),'foreignField':_0x5f4de1(0x11d),'as':'product_info'}},{'$unwind':_0x5f4de1(0x1dd)},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':'$customer','status_data':_0x5f4de1(0xdb)},'totalQty':{'$sum':_0x5f4de1(0x169)},'cash':{'$first':'$cash'},'amount':{'$first':_0x5f4de1(0xa1)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x5f4de1(0x1e9)},'products':{'$push':{'qty':_0x5f4de1(0x169),'NetPrice':_0x5f4de1(0x156),'discount':_0x5f4de1(0x175),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x5f4de1(0x164),'product_code':_0x5f4de1(0x1a0),'category':_0x5f4de1(0x14e),'brand':'$product_info.brand','gross_price':_0x5f4de1(0x159),'isFG':_0x5f4de1(0x1fb),'prod_cat':'$sale_product.prod_cat','prod_id':_0x5f4de1(0xc1)}}}}},{'$unwind':_0x5f4de1(0x13f)},{'$group':{'_id':{'dsi':_0x5f4de1(0xae),'date':_0x5f4de1(0x172),'customer':'$_id.customer','status_data':_0x5f4de1(0x16f),'category':_0x5f4de1(0x1b8),'brand':_0x5f4de1(0xe5),'prod_id':_0x5f4de1(0xd0)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x5f4de1(0x167)]}},'NetPrice':{'$sum':_0x5f4de1(0x1c0)},'discount':{'$sum':_0x5f4de1(0x210)},'adj_discount':{'$sum':_0x5f4de1(0x188)},'cash':{'$first':_0x5f4de1(0x153)},'amount':{'$first':_0x5f4de1(0xa1)},'bank':{'$first':_0x5f4de1(0x149)},'check_no':{'$first':_0x5f4de1(0x174)},'due_date':{'$first':_0x5f4de1(0x1e9)},'product_details':{'$first':_0x5f4de1(0x1e1)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x5f4de1(0x172),'customer':'$_id.customer','status_data':_0x5f4de1(0x16f)},'totalQty':{'$sum':_0x5f4de1(0x162)},'totalGross':{'$sum':_0x5f4de1(0x109)},'NetPrice':{'$sum':_0x5f4de1(0x213)},'discount':{'$sum':_0x5f4de1(0x1f6)},'adj_discount':{'$sum':_0x5f4de1(0x1ab)},'cash':{'$first':_0x5f4de1(0x153)},'amount':{'$first':'$amount'},'bank':{'$first':'$bank'},'check_no':{'$first':_0x5f4de1(0x174)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x5f4de1(0x162),'category':_0x5f4de1(0x17a),'brand':'$_id.brand','product_details':_0x5f4de1(0xfe)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x59972c=await sales_sa[_0x5f4de1(0x186)]([{'$match':{'date':_0x16a64d,'sales_staff_id':_0x418804,'sale_product.isFG':_0x5f4de1(0xbf)}},{'$unwind':_0x5f4de1(0xde)},{'$lookup':{'from':'products','localField':_0x5f4de1(0x121),'foreignField':_0x5f4de1(0x11d),'as':_0x5f4de1(0x19c)}},{'$unwind':_0x5f4de1(0x1dd)},{'$group':{'_id':{'dsi':_0x5f4de1(0xf1),'date':_0x5f4de1(0x140),'customer':_0x5f4de1(0x150)},'totalQty':{'$sum':_0x5f4de1(0x169)},'cash':{'$first':_0x5f4de1(0x153)},'amount':{'$first':_0x5f4de1(0xa1)},'bank':{'$first':_0x5f4de1(0x149)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x5f4de1(0x1e9)},'products':{'$push':{'qty':_0x5f4de1(0x169),'NetPrice':'$sale_product.totalprice','discount':_0x5f4de1(0x175),'adj_discount':_0x5f4de1(0x214),'product_details':{'prod_name':_0x5f4de1(0x164),'product_code':_0x5f4de1(0x1a0),'category':_0x5f4de1(0x14e),'brand':_0x5f4de1(0x1d5),'gross_price':'$product_info.gross_price','isFG':_0x5f4de1(0x1fb),'prod_cat':_0x5f4de1(0x1ec),'prod_id':_0x5f4de1(0xc1)}}}}},{'$unwind':_0x5f4de1(0x13f)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x5f4de1(0x172),'customer':_0x5f4de1(0x17f),'category':_0x5f4de1(0x1b8),'brand':_0x5f4de1(0xe5),'prod_id':_0x5f4de1(0xd0)},'totalQty':{'$sum':_0x5f4de1(0xa2)},'cash':{'$first':_0x5f4de1(0x153)},'amount':{'$first':'$amount'},'bank':{'$first':_0x5f4de1(0x149)},'check_no':{'$first':_0x5f4de1(0x174)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':{'$multiply':[_0x5f4de1(0xa2),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x5f4de1(0x1c0)},'discount':{'$sum':_0x5f4de1(0x210)},'adj_discount':{'$sum':_0x5f4de1(0x188)},'product_details':{'$first':_0x5f4de1(0x1e1)}}},{'$group':{'_id':{'dsi':_0x5f4de1(0xae),'date':'$_id.date','customer':_0x5f4de1(0x17f)},'totalQty':{'$sum':_0x5f4de1(0x162)},'cash':{'$first':'$cash'},'amount':{'$first':_0x5f4de1(0xa1)},'bank':{'$first':_0x5f4de1(0x149)},'check_no':{'$first':_0x5f4de1(0x174)},'due_date':{'$first':_0x5f4de1(0x1e9)},'totalGross':{'$sum':_0x5f4de1(0x109)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x5f4de1(0x1f6)},'adj_discount':{'$sum':_0x5f4de1(0x1ab)},'products':{'$push':{'qty':_0x5f4de1(0x162),'category':_0x5f4de1(0x17a),'brand':_0x5f4de1(0xcb),'product_details':_0x5f4de1(0xfe)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5f4c88=await sales_sa[_0x5f4de1(0x186)]([{'$match':{'date':_0x43bd1c,'sales_staff_id':_0x418804,'status_data':_0x5f4de1(0x183)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5bf380=await staff[_0x5f4de1(0x1f7)](_0x418804);let _0x509d10=[],_0x402e39={},_0x42aec1={};var _0xeea549=0x0,_0x5d44fd=0x0,_0x10fe6a=0x0,_0x3e97a5=0x0,_0xd011bd=0x0;const _0x396219=0x6;var _0x25ac02=0x0,_0x2e6ce9=0x0;for(let _0x3faa8d=0x0;_0x3faa8d<=_0x3e8dbf['length']-0x1;_0x3faa8d++){const _0x53a219=_0x3e8dbf[_0x3faa8d];let _0x5a5021=_0x5f4de1(0xa6);_0x5a5021+=_0x5f4de1(0x193),_0x5a5021+=_0x5f4de1(0x1c5)+_0x53a219[_0x5f4de1(0x192)][_0x5f4de1(0x12c)]+'</td>',_0x5a5021+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x53a219[_0x5f4de1(0x192)][_0x5f4de1(0x139)]+_0x5f4de1(0x133);let _0x4f7e60={},_0x41eb64={},_0x4d81b6={};var _0x6d8375={},_0x2a8fdc={},_0x327ac2={},_0x468de1=0x0;for(let _0x467c77=0x0;_0x467c77<=_0x53a219[_0x5f4de1(0x142)][_0x5f4de1(0xd8)]-0x1;_0x467c77++){const _0x58b28d=_0x53a219[_0x5f4de1(0x142)][_0x467c77];_0x4f7e60[_0x58b28d[_0x5f4de1(0x191)]+'-'+_0x58b28d[_0x5f4de1(0x207)]]=_0x58b28d[_0x5f4de1(0x115)],_0x41eb64[[_0x58b28d[_0x5f4de1(0x191)]+'-'+_0x58b28d[_0x5f4de1(0x207)]]]=_0x58b28d[_0x5f4de1(0x17d)][_0x5f4de1(0x132)],_0x4d81b6[[_0x58b28d[_0x5f4de1(0x191)]+'-'+_0x58b28d[_0x5f4de1(0x207)]]]=_0x58b28d[_0x5f4de1(0x17d)][_0x5f4de1(0x168)];const _0x238c62=_0x58b28d['brand']+'-'+_0x58b28d[_0x5f4de1(0x207)];!Array[_0x5f4de1(0xb1)](_0x42aec1[_0x238c62])&&(_0x42aec1[_0x238c62]=[]);!Array['isArray'](_0x42aec1[_0x238c62])&&(_0x42aec1[_0x238c62]=[]);_0x42aec1[_0x238c62][_0x5f4de1(0x1b5)](_0x58b28d['qty']);if(_0x58b28d[_0x5f4de1(0x17d)]['prod_cat']=='P')_0x58b28d['product_details'][_0x5f4de1(0x132)]==_0x5f4de1(0x183)?(!_0x327ac2[_0x238c62]&&(_0x327ac2[_0x238c62]=0x0),_0x327ac2[_0x238c62]=_0x58b28d['qty']):(!_0x6d8375[_0x238c62]&&(_0x6d8375[_0x238c62]=0x0),_0x6d8375[_0x238c62]=_0x58b28d[_0x5f4de1(0x115)]);else _0x58b28d['product_details'][_0x5f4de1(0x168)]=='S'&&(_0x58b28d['product_details'][_0x5f4de1(0x132)]==_0x5f4de1(0x183)?(!_0x327ac2[_0x238c62]&&(_0x327ac2[_0x238c62]=0x0),_0x327ac2[_0x238c62]=_0x58b28d[_0x5f4de1(0x115)]):(!_0x2a8fdc[_0x238c62]&&(_0x2a8fdc[_0x238c62]=0x0),_0x2a8fdc[_0x238c62]=_0x58b28d[_0x5f4de1(0x115)]));_0x468de1++;}for(let _0x317ca0=0x0;_0x317ca0<=_0x1aed42['cat_brand']['length']-0x1;_0x317ca0++){const _0x4afb06=_0x1aed42[_0x5f4de1(0xa0)][_0x317ca0],_0x5cd339=_0x4afb06[_0x5f4de1(0x192)][_0x5f4de1(0x191)]+'-'+_0x4afb06[_0x5f4de1(0x192)][_0x5f4de1(0x207)],_0x23da94=_0x4d81b6[_0x5cd339]!==undefined?_0x4d81b6[_0x5cd339]:'NA';var _0x541fd1=_0x6d8375[_0x5cd339]!==undefined?_0x6d8375[_0x5cd339][_0x5f4de1(0xa5)](0x2):'',_0x5cc246=_0x2a8fdc[_0x5cd339]!==undefined?_0x2a8fdc[_0x5cd339][_0x5f4de1(0xa5)](0x2):'',_0x15f4a4=_0x327ac2[_0x5cd339]!==undefined?_0x327ac2[_0x5cd339]['toFixed'](0x2):'';_0x5a5021+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x541fd1+'</td>',_0x5a5021+=_0x5f4de1(0x112)+_0x5cc246+_0x5f4de1(0x133),_0x5a5021+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x15f4a4+_0x5f4de1(0x133);}var _0x1e1352=formatNumber(parseFloat(_0x53a219[_0x5f4de1(0x8c)])),_0x393f08=formatNumber(parseFloat(_0x53a219[_0x5f4de1(0xe3)]));isNaN(_0x393f08)&&(_0x393f08=0x0),_0x5a5021+=_0x5f4de1(0x112)+_0x1e1352+_0x5f4de1(0x133),_0x5a5021+=_0x5f4de1(0x112)+_0x393f08+_0x5f4de1(0x133),_0x5a5021+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x53a219['bank']+_0x5f4de1(0x133),_0x5a5021+=_0x5f4de1(0x1c5)+_0x53a219[_0x5f4de1(0xf8)]+_0x5f4de1(0x133),_0x5a5021+=_0x5f4de1(0x1c5)+_0x53a219['due_date']+'</td>',_0x10fe6a=_0x53a219[_0x5f4de1(0xb3)]+_0x53a219[_0x5f4de1(0x10d)],_0x25ac02+=parseFloat(_0x53a219['cash']),_0x2e6ce9+=parseFloat(_0x393f08),_0x509d10[_0x5f4de1(0x1b5)](_0x5a5021);}if(_0x5f4c88[_0x5f4de1(0xd8)]>0x0)for(let _0x30ea73=0x0;_0x30ea73<=_0x5f4c88[_0x5f4de1(0xd8)]-0x1;_0x30ea73++){const _0x419939=_0x5f4c88[_0x30ea73];console[_0x5f4de1(0x18e)](_0x419939);let _0x5ab38a=_0x5f4de1(0xa6);_0x5ab38a+=_0x5f4de1(0xc6)+(0x8+0x7*0x3)+_0x5f4de1(0x178)+_0x419939[_0x5f4de1(0xc7)]+_0x5f4de1(0x1c8),_0x5ab38a+=_0x5f4de1(0x11f),_0x509d10[_0x5f4de1(0x1b5)](_0x5ab38a);}function _0x1400c1(_0x503e28,_0x3779a3){const _0xf22d5e=_0x5f4de1,_0x3d45cf=[];for(let _0x3d1469=0x0;_0x3d1469<=_0x503e28[_0xf22d5e(0xd8)]-0x1;_0x3d1469+=_0x3779a3){_0x3d45cf[_0xf22d5e(0x1b5)](_0x503e28[_0xf22d5e(0x12f)](_0x3d1469,_0x3d1469+_0x3779a3));}return _0x3d45cf;}const _0x49c3a8=_0x1400c1(_0x509d10,_0x396219);let _0x1e1856='';return _0x49c3a8['forEach']((_0xda3a37,_0x1c424b)=>{const _0x195567=_0x5f4de1;_0x1c424b>0x0&&(_0x1e1856+=_0x195567(0xeb));_0x1e1856+=_0x195567(0x10a),_0x1e1856+=_0x195567(0x9d);const _0x4ff113=new Date(_0x43bd1c),_0xa93f9f={'year':_0x195567(0x1c1),'month':_0x195567(0x1a3),'day':_0x195567(0x1c1),'timeZone':'Asia/Manila'},_0x3b9fd2=_0x4ff113[_0x195567(0x1a4)](_0x195567(0x1cf),_0xa93f9f);_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x1e2)+_0x38c18d+_0x195567(0x1c8),_0x1e1856+=_0x195567(0x11f),_0x1e1856+='<tr>',_0x1e1856+=_0x195567(0x12d)+_0x5bf380[_0x195567(0x1bd)]+_0x195567(0x133),_0x1e1856+=_0x195567(0x171),_0x1e1856+=_0x195567(0xad),_0x1e1856+=_0x195567(0xe2),_0x1e1856+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x1e1856+=_0x195567(0x1b2),_0x1e1856+=_0x195567(0x20a),_0x1e1856+=_0x195567(0x93),_0x1e1856+='<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>',_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x1e1856+=_0x195567(0x8f)+_0x3b9fd2+_0x195567(0x133),_0x1e1856+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>',_0x1e1856+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>',_0x1e1856+=_0x195567(0x19b),_0x1e1856+=_0x195567(0x19b),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x1df),_0x1e1856+=_0x195567(0x107),_0x1e1856+=_0x195567(0x119),_0x1e1856+=_0x195567(0x19b),_0x1e1856+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0xb0),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x1d1),_0x1e1856+=_0x195567(0x13c),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x1b9),_0x1e1856+=_0x195567(0xa4),_0x1e1856+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x45b579=0x0;_0x45b579<=_0x2080fd[_0x195567(0xd8)]-0x1;_0x45b579++){const _0x5b0969=_0x2080fd[_0x45b579];for(let _0x139a7e=0x0;_0x139a7e<_0x1aed42[_0x195567(0xa0)]['length'];_0x139a7e++){const _0x584191=_0x1aed42['cat_brand'][_0x139a7e];if(_0x584191[_0x195567(0x192)]['category']===_0x5b0969[_0x195567(0x192)][_0x195567(0x207)]){var _0x484c2='';switch(_0x5b0969[_0x195567(0x192)]['category']){case _0x195567(0x120):_0x484c2=_0x584191[_0x195567(0x192)][_0x195567(0x191)]+'\x20-\x20STD';break;case _0x195567(0xf5):_0x484c2=_0x584191[_0x195567(0x192)]['brand']+'\x20-\x20HH';break;default:_0x484c2=_0x584191[_0x195567(0x192)][_0x195567(0x191)];break;}_0x1e1856+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>'+_0x484c2+'</b></td>';}}}_0x1e1856+=_0x195567(0x158),_0x1e1856+=_0x195567(0x1a8),_0x1e1856+=_0x195567(0x8b),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x1d6);for(let _0x7e846=0x0;_0x7e846<=_0x1aed42[_0x195567(0xa0)][_0x195567(0xd8)]-0x1;_0x7e846++){const _0x2376dd=_0x1aed42[_0x7e846];_0x1e1856+=_0x195567(0x18d),_0x1e1856+=_0x195567(0x13d),_0x1e1856+=_0x195567(0x13e);}_0x1e1856+=_0x195567(0xaa),_0x1e1856+=_0x195567(0x141),_0x1e1856+=_0x195567(0xee),_0x1e1856+=_0x195567(0x11f),_0x1e1856+='</thead>',_0x1e1856+=_0x195567(0x1aa),_0xda3a37[_0x195567(0x8a)](_0x11af5f=>{_0x1e1856+=_0x11af5f;});let _0x4d78a7={},_0x356543={},_0x173b7e={};for(let _0x15d87c=0x0;_0x15d87c<=_0x3e8dbf[_0x195567(0xd8)]-0x1;_0x15d87c++){const _0x1cd09c=_0x3e8dbf[_0x15d87c];var _0x5785e1=0x0;for(let _0x28d860=0x0;_0x28d860<=_0x1cd09c['products'][_0x195567(0xd8)]-0x1;_0x28d860++){const _0x28a610=_0x1cd09c[_0x195567(0x142)][_0x28d860],_0x594021=_0x28a610[_0x195567(0x191)]+'-'+_0x28a610['category'];if(_0x28a610['product_details'][_0x195567(0x168)]=='P')_0x28a610[_0x195567(0x17d)][_0x195567(0x132)]=='true'?(!_0x173b7e[_0x594021]&&(_0x173b7e[_0x594021]=0x0),_0x173b7e[_0x594021]+=_0x28a610[_0x195567(0x115)]):(!_0x4d78a7[_0x594021]&&(_0x4d78a7[_0x594021]=0x0),_0x4d78a7[_0x594021]+=_0x28a610[_0x195567(0x115)]);else _0x28a610[_0x195567(0x17d)][_0x195567(0x168)]=='S'&&(_0x28a610[_0x195567(0x17d)][_0x195567(0x132)]=='true'?(!_0x173b7e[_0x594021]&&(_0x173b7e[_0x594021]=0x0),_0x173b7e[_0x594021]+=_0x28a610[_0x195567(0x115)],console[_0x195567(0x18e)](_0x28a610[_0x195567(0x115)])):(!_0x356543[_0x594021]&&(_0x356543[_0x594021]=0x0),_0x356543[_0x594021]+=_0x28a610['qty']));_0x5785e1++;}}let _0x3c12bd={},_0x244a3={},_0x317d97={};var _0x72ee74=0x0,_0x18298d=0x0;for(let _0x1f8f66=0x0;_0x1f8f66<=_0x59972c[_0x195567(0xd8)]-0x1;_0x1f8f66++){const _0x45bca7=_0x59972c[_0x1f8f66];var _0x5785e1=0x0;for(let _0x254d6d=0x0;_0x254d6d<=_0x45bca7[_0x195567(0x142)][_0x195567(0xd8)]-0x1;_0x254d6d++){const _0x53114f=_0x45bca7[_0x195567(0x142)][_0x254d6d],_0x1d80df=_0x53114f[_0x195567(0x191)]+'-'+_0x53114f[_0x195567(0x207)];if(_0x53114f[_0x195567(0x17d)]['prod_cat']=='P')_0x53114f[_0x195567(0x17d)][_0x195567(0x132)]=='true'?(!_0x317d97[_0x1d80df]&&(_0x317d97[_0x1d80df]=0x0),_0x317d97[_0x1d80df]+=_0x53114f['qty']):(!_0x3c12bd[_0x1d80df]&&(_0x3c12bd[_0x1d80df]=0x0),_0x3c12bd[_0x1d80df]+=_0x53114f[_0x195567(0x115)]);else _0x53114f['product_details'][_0x195567(0x168)]=='S'&&(_0x53114f[_0x195567(0x17d)][_0x195567(0x132)]==_0x195567(0x183)?(!_0x317d97[_0x1d80df]&&(_0x317d97[_0x1d80df]=0x0),_0x317d97[_0x1d80df]+=_0x53114f[_0x195567(0x115)]):(!_0x244a3[_0x1d80df]&&(_0x244a3[_0x1d80df]=0x0),_0x244a3[_0x1d80df]+=_0x53114f[_0x195567(0x115)]));_0x5785e1++;}var _0x2f0b4d=parseFloat(_0x45bca7['cash']),_0x5b547e=parseFloat(_0x45bca7[_0x195567(0xe3)]);isNaN(_0x5b547e)&&(_0x5b547e=0x0),_0x72ee74+=_0x2f0b4d,_0x18298d+=_0x5b547e;}_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x9c),_0x1e1856+=_0x195567(0xab),_0x1e1856+=_0x195567(0x193);for(let _0x574d0a=0x0;_0x574d0a<=_0x1aed42[_0x195567(0xa0)]['length']-0x1;_0x574d0a++){const _0x24353f=_0x1aed42[_0x195567(0xa0)][_0x574d0a],_0x582216=_0x24353f[_0x195567(0x192)]['brand']+'-'+_0x24353f[_0x195567(0x192)][_0x195567(0x207)];var _0x11f13b=_0x4d78a7[_0x582216]!==undefined?formatNumber(_0x4d78a7[_0x582216][_0x195567(0xa5)](0x2)):'',_0xd40c1f=_0x173b7e[_0x582216]!==undefined?formatNumber(_0x173b7e[_0x582216]['toFixed'](0x2)):'',_0x45a652=_0x356543[_0x582216]!==undefined?formatNumber(_0x356543[_0x582216]['toFixed'](0x2)):'';_0x1e1856+=_0x195567(0x21a)+_0x11f13b+_0x195567(0x1c8),_0x1e1856+=_0x195567(0x21a)+_0x45a652+_0x195567(0x1c8),_0x1e1856+=_0x195567(0x21a)+_0xd40c1f+'</b></td>';}_0x1e1856+=_0x195567(0x21a)+formatNumber(_0x25ac02)+'</b></td>',_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2e6ce9)+'</b></td>',_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x9c),_0x1e1856+=_0x195567(0x1d8),_0x1e1856+=_0x195567(0x193);for(let _0x1e9c31=0x0;_0x1e9c31<=_0x1aed42[_0x195567(0xa0)][_0x195567(0xd8)]-0x1;_0x1e9c31++){const _0x5e2326=_0x1aed42[_0x195567(0xa0)][_0x1e9c31],_0x37b4c5=_0x5e2326[_0x195567(0x192)]['brand']+'-'+_0x5e2326[_0x195567(0x192)][_0x195567(0x207)];var _0x11f13b=_0x3c12bd[_0x37b4c5]!==undefined?formatNumber(_0x3c12bd[_0x37b4c5][_0x195567(0xa5)](0x2)):'',_0xd40c1f=_0x317d97[_0x37b4c5]!==undefined?formatNumber(_0x317d97[_0x37b4c5]['toFixed'](0x2)):'',_0x45a652=_0x244a3[_0x37b4c5]!==undefined?formatNumber(_0x244a3[_0x37b4c5]['toFixed'](0x2)):'';_0x1e1856+=_0x195567(0x21a)+_0x11f13b+_0x195567(0x1c8),_0x1e1856+=_0x195567(0x21a)+_0x45a652+'</b></td>',_0x1e1856+=_0x195567(0x21a)+_0xd40c1f+_0x195567(0x1c8);}_0x1e1856+=_0x195567(0x21a)+formatNumber(_0x72ee74)+'</b></td>',_0x1e1856+=_0x195567(0x21a)+formatNumber(_0x18298d)+'</b></td>',_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x11f),_0x1e1856+='<tr>',_0x1e1856+=_0x195567(0x9c),_0x1e1856+=_0x195567(0xfa),_0x1e1856+=_0x195567(0x193);let _0x17f531=0x0,_0x38fd47=0x0,_0x2a38fd=0x0;for(let _0x3bd2d3=0x0;_0x3bd2d3<=_0x1aed42[_0x195567(0xa0)][_0x195567(0xd8)]-0x1;_0x3bd2d3++){const _0x5b176d=_0x1aed42[_0x195567(0xa0)][_0x3bd2d3],_0x5b6e6d=_0x5b176d['_id'][_0x195567(0x191)]+'-'+_0x5b176d[_0x195567(0x192)]['category'];var _0x249579=_0x4d78a7[_0x5b6e6d]!==undefined?_0x4d78a7[_0x5b6e6d][_0x195567(0xa5)](0x2):'0',_0x2720e2=_0x173b7e[_0x5b6e6d]!==undefined?_0x173b7e[_0x5b6e6d]['toFixed'](0x2):'0',_0x53c1da=_0x356543[_0x5b6e6d]!==undefined?_0x356543[_0x5b6e6d][_0x195567(0xa5)](0x2):'0',_0x2f08c5=_0x3c12bd[_0x5b6e6d]!==undefined?_0x3c12bd[_0x5b6e6d][_0x195567(0xa5)](0x2):'0',_0x5ce13b=_0x317d97[_0x5b6e6d]!==undefined?_0x317d97[_0x5b6e6d]['toFixed'](0x2):'0',_0x4cde14=_0x244a3[_0x5b6e6d]!==undefined?_0x244a3[_0x5b6e6d][_0x195567(0xa5)](0x2):'0';_0x17f531=parseFloat(_0x249579)+parseFloat(_0x2f08c5),_0x38fd47=parseFloat(_0x53c1da)+parseFloat(_0x4cde14),_0x2a38fd=parseFloat(_0x2720e2)+parseFloat(_0x5ce13b),_0x1e1856+=_0x195567(0x21a)+formatNumber(_0x17f531[_0x195567(0xa5)](0x2))+_0x195567(0x1c8),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x38fd47[_0x195567(0xa5)](0x2))+_0x195567(0x1c8),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2a38fd['toFixed'](0x2))+'</b></td>';}var _0x39e810=formatNumber(_0x25ac02+_0x72ee74),_0x39c604=formatNumber(_0x2e6ce9+_0x18298d);_0x1e1856+=_0x195567(0x21a)+_0x39e810+'</b></td>',_0x1e1856+=_0x195567(0x21a)+_0x39c604+_0x195567(0x1c8),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x209)+(_0x1aed42[_0x195567(0xa0)]['length']*0x3+0x9)+_0x195567(0x113),_0x1e1856+='</tr>',_0x1e1856+='<tr>',_0x1e1856+=_0x195567(0x9c),_0x1e1856+=_0x195567(0x135),_0x1e1856+=_0x195567(0x193);for(let _0x41c252=0x0;_0x41c252<=_0x1aed42[_0x195567(0xa0)]['length']-0x1;_0x41c252++){const _0x17005e=_0x1aed42[_0x195567(0xa0)][_0x41c252],_0x150713=_0x17005e[_0x195567(0x192)]['brand']+'-'+_0x17005e['_id'][_0x195567(0x207)];var _0x249579=_0x4d78a7[_0x150713]!==undefined?_0x4d78a7[_0x150713]['toFixed'](0x2):'0',_0x2720e2=_0x173b7e[_0x150713]!==undefined?_0x173b7e[_0x150713][_0x195567(0xa5)](0x2):'0',_0x53c1da=_0x356543[_0x150713]!==undefined?_0x356543[_0x150713][_0x195567(0xa5)](0x2):'0',_0x2f08c5=_0x3c12bd[_0x150713]!==undefined?_0x3c12bd[_0x150713][_0x195567(0xa5)](0x2):'0',_0x5ce13b=_0x317d97[_0x150713]!==undefined?_0x317d97[_0x150713][_0x195567(0xa5)](0x2):'0',_0x4cde14=_0x244a3[_0x150713]!==undefined?_0x244a3[_0x150713][_0x195567(0xa5)](0x2):'0';_0x17f531=parseFloat(_0x249579)+parseFloat(_0x2f08c5),_0x38fd47=parseFloat(_0x53c1da)+parseFloat(_0x4cde14),_0x2a38fd=parseFloat(_0x2720e2)+parseFloat(_0x5ce13b),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1e1856+=_0x195567(0x1c9),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x9c),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>',_0x1e1856+=_0x195567(0x193);for(let _0x3b5a50=0x0;_0x3b5a50<=_0x1aed42[_0x195567(0xa0)]['length']-0x1;_0x3b5a50++){const _0x4dcf33=_0x1aed42['cat_brand'][_0x3b5a50],_0x409908=_0x4dcf33[_0x195567(0x192)]['brand']+'-'+_0x4dcf33[_0x195567(0x192)][_0x195567(0x207)];var _0x249579=_0x4d78a7[_0x409908]!==undefined?_0x4d78a7[_0x409908]['toFixed'](0x2):'0',_0x2720e2=_0x173b7e[_0x409908]!==undefined?_0x173b7e[_0x409908][_0x195567(0xa5)](0x2):'0',_0x53c1da=_0x356543[_0x409908]!==undefined?_0x356543[_0x409908]['toFixed'](0x2):'0',_0x2f08c5=_0x3c12bd[_0x409908]!==undefined?_0x3c12bd[_0x409908][_0x195567(0xa5)](0x2):'0',_0x5ce13b=_0x317d97[_0x409908]!==undefined?_0x317d97[_0x409908][_0x195567(0xa5)](0x2):'0',_0x4cde14=_0x244a3[_0x409908]!==undefined?_0x244a3[_0x409908][_0x195567(0xa5)](0x2):'0';_0x17f531=parseFloat(_0x249579)+parseFloat(_0x2f08c5),_0x38fd47=parseFloat(_0x53c1da)+parseFloat(_0x4cde14),_0x2a38fd=parseFloat(_0x2720e2)+parseFloat(_0x5ce13b),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1e1856+=_0x195567(0x1c9),_0x1e1856+=_0x195567(0x1c9);}_0x1e1856+=_0x195567(0x193),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x1e1856+=_0x195567(0x152),_0x1e1856+=_0x195567(0x193);for(let _0x3a7b34=0x0;_0x3a7b34<=_0x1aed42[_0x195567(0xa0)][_0x195567(0xd8)]-0x1;_0x3a7b34++){const _0x30fa07=_0x1aed42[_0x195567(0xa0)][_0x3a7b34],_0x1595d0=_0x30fa07['_id'][_0x195567(0x191)]+'-'+_0x30fa07[_0x195567(0x192)]['category'];var _0x249579=_0x4d78a7[_0x1595d0]!==undefined?_0x4d78a7[_0x1595d0][_0x195567(0xa5)](0x2):'0',_0x2720e2=_0x173b7e[_0x1595d0]!==undefined?_0x173b7e[_0x1595d0][_0x195567(0xa5)](0x2):'0',_0x53c1da=_0x356543[_0x1595d0]!==undefined?_0x356543[_0x1595d0][_0x195567(0xa5)](0x2):'0',_0x2f08c5=_0x3c12bd[_0x1595d0]!==undefined?_0x3c12bd[_0x1595d0][_0x195567(0xa5)](0x2):'0',_0x5ce13b=_0x317d97[_0x1595d0]!==undefined?_0x317d97[_0x1595d0]['toFixed'](0x2):'0',_0x4cde14=_0x244a3[_0x1595d0]!==undefined?_0x244a3[_0x1595d0]['toFixed'](0x2):'0';_0x17f531=parseFloat(_0x249579)+parseFloat(_0x2f08c5),_0x38fd47=parseFloat(_0x53c1da)+parseFloat(_0x4cde14),_0x2a38fd=parseFloat(_0x2720e2)+parseFloat(_0x5ce13b),_0x1e1856+=_0x195567(0x1c9),_0x1e1856+=_0x195567(0x1c9),_0x1e1856+=_0x195567(0x1c9);}_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x1e1856+=_0x195567(0xab),_0x1e1856+=_0x195567(0x193);for(let _0x18c7ed=0x0;_0x18c7ed<=_0x1aed42[_0x195567(0xa0)][_0x195567(0xd8)]-0x1;_0x18c7ed++){const _0x3edd5c=_0x1aed42[_0x195567(0xa0)][_0x18c7ed],_0x36f6aa=_0x3edd5c[_0x195567(0x192)][_0x195567(0x191)]+'-'+_0x3edd5c['_id'][_0x195567(0x207)];var _0x249579=_0x4d78a7[_0x36f6aa]!==undefined?_0x4d78a7[_0x36f6aa]['toFixed'](0x2):'',_0x2720e2=_0x173b7e[_0x36f6aa]!==undefined?_0x173b7e[_0x36f6aa][_0x195567(0xa5)](0x2):'',_0x53c1da=_0x356543[_0x36f6aa]!==undefined?_0x356543[_0x36f6aa][_0x195567(0xa5)](0x2):'',_0x2f08c5=_0x3c12bd[_0x36f6aa]!==undefined?_0x3c12bd[_0x36f6aa][_0x195567(0xa5)](0x2):'',_0x5ce13b=_0x317d97[_0x36f6aa]!==undefined?_0x317d97[_0x36f6aa][_0x195567(0xa5)](0x2):'',_0x4cde14=_0x244a3[_0x36f6aa]!==undefined?_0x244a3[_0x36f6aa][_0x195567(0xa5)](0x2):'';_0x17f531=formatNumber(parseFloat(_0x249579)+parseFloat(_0x2f08c5)),_0x38fd47=formatNumber(parseFloat(_0x53c1da)+parseFloat(_0x4cde14)),_0x2a38fd=formatNumber(parseFloat(_0x2720e2)+parseFloat(_0x5ce13b)),_0x1e1856+=_0x195567(0x21a)+_0x249579+_0x195567(0x1c8),_0x1e1856+=_0x195567(0x21a)+_0x53c1da+_0x195567(0x1c8),_0x1e1856+=_0x195567(0x21a)+_0x2720e2+'</b></td>';}_0x1e1856+=_0x195567(0x193),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0xa6),_0x1e1856+=_0x195567(0x9c),_0x1e1856+=_0x195567(0xba),_0x1e1856+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x3ce4e0=0x0;_0x3ce4e0<=_0x1aed42[_0x195567(0xa0)][_0x195567(0xd8)]-0x1;_0x3ce4e0++){const _0x1990b2=_0x1aed42[_0x195567(0xa0)][_0x3ce4e0],_0x1870ca=_0x1990b2[_0x195567(0x192)][_0x195567(0x191)]+'-'+_0x1990b2[_0x195567(0x192)][_0x195567(0x207)];var _0x249579=_0x4d78a7[_0x1870ca]!==undefined?_0x4d78a7[_0x1870ca]['toFixed'](0x2):'0',_0x2720e2=_0x173b7e[_0x1870ca]!==undefined?_0x173b7e[_0x1870ca]['toFixed'](0x2):'0',_0x53c1da=_0x356543[_0x1870ca]!==undefined?_0x356543[_0x1870ca][_0x195567(0xa5)](0x2):'0',_0x2f08c5=_0x3c12bd[_0x1870ca]!==undefined?_0x3c12bd[_0x1870ca][_0x195567(0xa5)](0x2):'0',_0x5ce13b=_0x317d97[_0x1870ca]!==undefined?_0x317d97[_0x1870ca][_0x195567(0xa5)](0x2):'0',_0x4cde14=_0x244a3[_0x1870ca]!==undefined?_0x244a3[_0x1870ca][_0x195567(0xa5)](0x2):'0';_0x17f531=parseFloat(_0x249579)+parseFloat(_0x2f08c5),_0x38fd47=parseFloat(_0x53c1da)+parseFloat(_0x4cde14),_0x2a38fd=parseFloat(_0x2720e2)+parseFloat(_0x5ce13b),_0x1e1856+=_0x195567(0x1c9),_0x1e1856+=_0x195567(0x1c9),_0x1e1856+=_0x195567(0x1c9);}_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x193),_0x1e1856+=_0x195567(0x11f),_0x1e1856+=_0x195567(0x111),_0x1e1856+=_0x195567(0x99);}),_0x1e1856;}async function generateReferenceNumber(_0x48ba28,_0x1f721f,_0x152016){const _0xc8ce0d=a0_0x400c41,_0x493a61=new Date(_0x48ba28)['getFullYear'](),_0x1a1be7=('0'+(new Date(_0x48ba28)['getMonth']()+0x1))['slice'](-0x2),_0x3df47d=('0'+new Date(_0x48ba28)[_0xc8ce0d(0x15e)]())[_0xc8ce0d(0x12f)](-0x2),_0x40f9c3=await staff[_0xc8ce0d(0x1da)]({'email':_0x152016[_0xc8ce0d(0x182)]}),_0x62dc1c=_0x40f9c3[_0xc8ce0d(0x1f0)],_0x5747fd=_0x62dc1c+'-'+_0x493a61+_0x1a1be7+_0x3df47d,_0x533e68=await Reference[_0xc8ce0d(0x1da)]({'referenceNumber':new RegExp('^'+_0x5747fd),'salesman_code':_0x62dc1c})['sort']({'createdAt':-0x1}),_0x52655f=_0x5747fd;_0x533e68&&(_0x52655f=_0x533e68[_0xc8ce0d(0x1a6)]);console['log'](_0x52655f);const _0x376ae9=new Reference({'referenceNumber':_0x52655f,'staff_id':_0x1f721f,'salesman_code':_0x62dc1c});return await _0x376ae9[_0xc8ce0d(0x1e4)](),_0x52655f;}router[a0_0x400c41(0x1cc)](a0_0x400c41(0xac),auth,async(_0x1dabba,_0x133b60)=>{const _0x2690ed=a0_0x400c41,{from_date:_0x4d76d7,dataview:_0x1897eb}=_0x1dabba[_0x2690ed(0x97)],_0x16c777=_0x1dabba[_0x2690ed(0xd7)],_0xa1f422=await staff[_0x2690ed(0x1da)]({'email':_0x16c777[_0x2690ed(0x182)]}),_0x2915c3=await master_shop[_0x2690ed(0xcd)](),_0x4445cf='';var _0x1036d3=new Date(_0x4d76d7);const _0x496007={'year':'numeric','month':_0x2690ed(0x1a3),'day':'numeric'},_0x1e457e=new Intl[(_0x2690ed(0x212))](_0x2690ed(0x1cf),_0x496007)['format'](_0x1036d3),_0x4e00de=await Reference[_0x2690ed(0xcd)]({'staff_id':_0xa1f422[_0x2690ed(0x192)][_0x2690ed(0x160)](),'date_include':_0x4d76d7});if(_0x4e00de[_0x2690ed(0xd8)]>0x0){let _0x2518b8='';_0x2518b8+=_0x4e00de[0x0][_0x2690ed(0x1c4)];if(_0x1897eb=='excel'){const _0xece0fe=cheerio[_0x2690ed(0x1e3)](_0x2518b8);let _0x2aeadb=[],_0x2865b2=[],_0x266031=[];const _0x173e52=_0x47895b=>{const _0x466ebc=_0x2690ed,_0x373362={'top':{'style':_0x466ebc(0x148),'color':{'rgb':_0x466ebc(0x17c)}},'bottom':{'style':_0x466ebc(0x148),'color':{'rgb':_0x466ebc(0x17c)}},'left':{'style':_0x466ebc(0x148),'color':{'rgb':'000000'}},'right':{'style':_0x466ebc(0x148),'color':{'rgb':_0x466ebc(0x17c)}}};if(_0x47895b){const _0x5cbb0e=_0x47895b[_0x466ebc(0x179)](';')[_0x466ebc(0x122)]((_0x55b099,_0x4b4021)=>{const _0x4203cb=_0x466ebc,[_0x542f53,_0x2d4e85]=_0x4b4021[_0x4203cb(0x179)](':')[_0x4203cb(0x124)](_0x20550c=>_0x20550c[_0x4203cb(0x1db)]());return _0x55b099[_0x542f53]=_0x2d4e85,_0x55b099;},{});_0x5cbb0e[_0x466ebc(0xbb)]&&(_0x373362['top']['style']=_0x5cbb0e[_0x466ebc(0xbb)][_0x466ebc(0xea)](_0x466ebc(0x18a))?_0x466ebc(0x18a):_0x466ebc(0x157)),_0x5cbb0e[_0x466ebc(0x218)]&&(_0x373362[_0x466ebc(0x20b)][_0x466ebc(0x208)]=_0x5cbb0e[_0x466ebc(0x218)][_0x466ebc(0xea)](_0x466ebc(0x18a))?_0x466ebc(0x18a):_0x466ebc(0x157)),_0x5cbb0e['border-left']&&(_0x373362[_0x466ebc(0x130)][_0x466ebc(0x208)]=_0x5cbb0e[_0x466ebc(0x1dc)][_0x466ebc(0xea)](_0x466ebc(0x18a))?_0x466ebc(0x18a):_0x466ebc(0x157)),_0x5cbb0e[_0x466ebc(0xbd)]&&(_0x373362[_0x466ebc(0x11e)][_0x466ebc(0x208)]=_0x5cbb0e[_0x466ebc(0xbd)][_0x466ebc(0xea)](_0x466ebc(0x18a))?'thin':_0x466ebc(0x157));}return _0x373362;};_0xece0fe(_0x2690ed(0x10e))['each']((_0x10dab8,_0x1a7d6e)=>{const _0x337f32=_0x2690ed;let _0x502462=[],_0x4f1d3c=0x0;while(_0x266031[_0x4f1d3c]){_0x266031[_0x4f1d3c]--,_0x4f1d3c++;}_0xece0fe(_0x1a7d6e)['find'](_0x337f32(0x166))[_0x337f32(0x14a)]((_0xe640be,_0x1069c4)=>{const _0x2c9f92=_0x337f32;let _0x5b7c53=_0xece0fe(_0x1069c4)[_0x2c9f92(0x187)]()['trim'](),_0x36f5a9=parseFloat(_0x5b7c53[_0x2c9f92(0x13a)](/,/g,''));isNaN(_0x36f5a9)&&(_0x36f5a9=_0x5b7c53);let _0x51b8a7=parseInt(_0xece0fe(_0x1069c4)[_0x2c9f92(0x105)](_0x2c9f92(0xdf)))||0x1,_0x57eb43=parseInt(_0xece0fe(_0x1069c4)['attr'](_0x2c9f92(0x180)))||0x1;const _0x488001=_0xece0fe(_0x1069c4)[_0x2c9f92(0x105)](_0x2c9f92(0x208)),_0x29de15=_0x173e52(_0x488001);_0x502462[_0x4f1d3c]={'v':_0x36f5a9,'s':{'border':_0x29de15}};(_0x51b8a7>0x1||_0x57eb43>0x1)&&_0x2865b2[_0x2c9f92(0x1b5)]({'s':{'r':_0x10dab8,'c':_0x4f1d3c},'e':{'r':_0x10dab8+_0x57eb43-0x1,'c':_0x4f1d3c+_0x51b8a7-0x1}});for(let _0x37b89e=0x0;_0x37b89e<_0x51b8a7;_0x37b89e++){_0x57eb43>0x1&&(_0x266031[_0x4f1d3c+_0x37b89e]=_0x57eb43-0x1);}_0x4f1d3c+=_0x51b8a7;}),_0x2aeadb['push'](_0x502462);});const _0x75c4dd=XLSX[_0x2690ed(0xc3)]['book_new'](),_0x5639b8=XLSX[_0x2690ed(0xc3)][_0x2690ed(0x176)](_0x2aeadb);_0x2865b2[_0x2690ed(0xd8)]>0x0&&(_0x5639b8[_0x2690ed(0xaf)]=_0x2865b2);_0x5639b8[_0x2690ed(0xf7)]=_0x2aeadb[0x0][_0x2690ed(0x124)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x75c4dd,_0x5639b8,_0x2690ed(0x102));const _0xb5a577=XLSX[_0x2690ed(0xdc)](_0x75c4dd,{'bookType':'xlsx','type':_0x2690ed(0x129)});_0x133b60['setHeader'](_0x2690ed(0x147),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x133b60[_0x2690ed(0x12e)](_0x2690ed(0x100),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x133b60[_0x2690ed(0x1d7)](_0xb5a577);}else{let _0x8993f5='';_0x8993f5+=_0x2518b8,_0x8993f5+=_0x2690ed(0x14c),_0x8993f5+='window.onload\x20=\x20function()\x20{',_0x8993f5+=_0x2690ed(0x1ae),_0x8993f5+='};',_0x8993f5+=_0x2690ed(0x12b),_0x133b60['send'](_0x8993f5);}}else generateReferenceNumber(_0x4d76d7,_0xa1f422[_0x2690ed(0x192)][_0x2690ed(0x160)](),_0x16c777)[_0x2690ed(0x144)](async _0x11ff02=>{const _0x188063=_0x2690ed,_0x46635c=await agentsdataDSICheck_DSRR(_0x4d76d7,_0xa1f422[_0x188063(0x192)][_0x188063(0x160)](),_0x4445cf,_0x11ff02);console[_0x188063(0x18e)](_0x46635c);let _0x329076=_0x188063(0xe1);_0x329076+=_0x188063(0x1f1),_0x329076+='<div\x20\x20id=\x22table-conatainer\x22>',_0x329076+=_0x188063(0x10a),_0x329076+=_0x46635c,_0x329076+=_0x188063(0x99),_0x329076+='</div>',_0x329076+=_0x188063(0xf0);if(_0x46635c[_0x188063(0xd8)]>0x0){const _0x1ccb7e=await Reference[_0x188063(0x1da)]({'staff_id':_0xa1f422[_0x188063(0x192)][_0x188063(0x160)](),'referenceNumber':_0x11ff02});_0x1ccb7e[_0x188063(0x1c4)]=_0x329076,_0x1ccb7e[_0x188063(0xcf)]=_0x4d76d7,await _0x1ccb7e[_0x188063(0x1e4)]();if(_0x1897eb==_0x188063(0x1ba)){const _0x23b030=cheerio[_0x188063(0x1e3)](_0x329076);let _0x598c06=[],_0x2fc05e=[],_0x10e16e=[];const _0x5dcbf4=_0x59bba4=>{const _0x5169ae=_0x188063,_0x12cda1={'top':{'style':_0x5169ae(0x148),'color':{'rgb':_0x5169ae(0x17c)}},'bottom':{'style':'thick','color':{'rgb':_0x5169ae(0x17c)}},'left':{'style':_0x5169ae(0x148),'color':{'rgb':'000000'}},'right':{'style':_0x5169ae(0x148),'color':{'rgb':'000000'}}};if(_0x59bba4){const _0x999bf0=_0x59bba4[_0x5169ae(0x179)](';')[_0x5169ae(0x122)]((_0x665485,_0x162515)=>{const _0x8344a1=_0x5169ae,[_0x170060,_0x3675d6]=_0x162515[_0x8344a1(0x179)](':')[_0x8344a1(0x124)](_0x1c7770=>_0x1c7770['trim']());return _0x665485[_0x170060]=_0x3675d6,_0x665485;},{});_0x999bf0[_0x5169ae(0xbb)]&&(_0x12cda1[_0x5169ae(0x190)][_0x5169ae(0x208)]=_0x999bf0[_0x5169ae(0xbb)]['includes'](_0x5169ae(0x18a))?_0x5169ae(0x18a):'medium'),_0x999bf0[_0x5169ae(0x218)]&&(_0x12cda1[_0x5169ae(0x20b)][_0x5169ae(0x208)]=_0x999bf0['border-bottom'][_0x5169ae(0xea)](_0x5169ae(0x18a))?'thin':_0x5169ae(0x157)),_0x999bf0[_0x5169ae(0x1dc)]&&(_0x12cda1[_0x5169ae(0x130)][_0x5169ae(0x208)]=_0x999bf0[_0x5169ae(0x1dc)][_0x5169ae(0xea)](_0x5169ae(0x18a))?'thin':_0x5169ae(0x157)),_0x999bf0[_0x5169ae(0xbd)]&&(_0x12cda1[_0x5169ae(0x11e)][_0x5169ae(0x208)]=_0x999bf0[_0x5169ae(0xbd)]['includes']('thin')?_0x5169ae(0x18a):_0x5169ae(0x157));}return _0x12cda1;};_0x23b030(_0x188063(0x10e))[_0x188063(0x14a)]((_0x31ea65,_0x56f327)=>{const _0x50d725=_0x188063;let _0x1f3d71=[],_0x4c19e8=0x0;while(_0x10e16e[_0x4c19e8]){_0x10e16e[_0x4c19e8]--,_0x4c19e8++;}_0x23b030(_0x56f327)[_0x50d725(0xcd)](_0x50d725(0x166))[_0x50d725(0x14a)]((_0x5204f7,_0x113517)=>{const _0x56956b=_0x50d725;let _0x1bc80b=_0x23b030(_0x113517)['text']()[_0x56956b(0x1db)](),_0x2cd9aa=parseFloat(_0x1bc80b[_0x56956b(0x13a)](/,/g,''));isNaN(_0x2cd9aa)&&(_0x2cd9aa=_0x1bc80b);let _0x60dba3=parseInt(_0x23b030(_0x113517)[_0x56956b(0x105)](_0x56956b(0xdf)))||0x1,_0x36b33c=parseInt(_0x23b030(_0x113517)[_0x56956b(0x105)](_0x56956b(0x180)))||0x1;const _0x1d34b1=_0x23b030(_0x113517)[_0x56956b(0x105)]('style'),_0x59b9cb=_0x5dcbf4(_0x1d34b1);_0x1f3d71[_0x4c19e8]={'v':_0x2cd9aa,'s':{'border':_0x59b9cb}};(_0x60dba3>0x1||_0x36b33c>0x1)&&_0x2fc05e['push']({'s':{'r':_0x31ea65,'c':_0x4c19e8},'e':{'r':_0x31ea65+_0x36b33c-0x1,'c':_0x4c19e8+_0x60dba3-0x1}});for(let _0x1081b2=0x0;_0x1081b2<_0x60dba3;_0x1081b2++){_0x36b33c>0x1&&(_0x10e16e[_0x4c19e8+_0x1081b2]=_0x36b33c-0x1);}_0x4c19e8+=_0x60dba3;}),_0x598c06[_0x50d725(0x1b5)](_0x1f3d71);});const _0x30fd17=XLSX[_0x188063(0xc3)]['book_new'](),_0xc0c5e2=XLSX[_0x188063(0xc3)]['aoa_to_sheet'](_0x598c06);_0x2fc05e[_0x188063(0xd8)]>0x0&&(_0xc0c5e2[_0x188063(0xaf)]=_0x2fc05e);_0xc0c5e2['!cols']=_0x598c06[0x0][_0x188063(0x124)](()=>({'wpx':0x64})),XLSX[_0x188063(0xc3)][_0x188063(0x9b)](_0x30fd17,_0xc0c5e2,_0x188063(0x102));const _0x2a4aa8=XLSX['write'](_0x30fd17,{'bookType':_0x188063(0xd3),'type':_0x188063(0x129)});_0x133b60[_0x188063(0x12e)]('Content-Disposition',_0x188063(0x14b)),_0x133b60[_0x188063(0x12e)]('Content-Type',_0x188063(0x1a2)),_0x133b60[_0x188063(0x1d7)](_0x2a4aa8);}else _0x329076+='<script>',_0x329076+=_0x188063(0x185),_0x329076+='window.print();',_0x329076+='};',_0x329076+=_0x188063(0x12b),_0x133b60[_0x188063(0x1d7)](_0x329076);}else await Reference[_0x188063(0x205)]({'referenceNumber':_0x11ff02}),_0x1dabba[_0x188063(0x211)](_0x188063(0x16b),_0x188063(0x11a)),_0x133b60['redirect'](_0x188063(0xf9));})['catch'](console['error']);}),router['get'](a0_0x400c41(0xfc),auth,async(_0x328c40,_0x19b769)=>{const _0x5742e6=a0_0x400c41;try{const {username:_0xad826d,email:_0x403b97,role:_0x22cd63}=_0x328c40[_0x5742e6(0xd7)],_0x526d3e=_0x328c40['user'],_0x1c1abf=await profile['findOne']({'email':_0x526d3e[_0x5742e6(0x182)]}),_0x387f01={'year':'numeric','month':_0x5742e6(0x1a3),'day':_0x5742e6(0x1c1)},_0x3942ff=await master_shop['find']();console[_0x5742e6(0x18e)](_0x5742e6(0x118),_0x3942ff);const _0x4cbb53=await product['find']();console[_0x5742e6(0x18e)](_0x5742e6(0xe9),_0x4cbb53);const _0x1a489f=await warehouse[_0x5742e6(0x186)]([{'$unwind':_0x5742e6(0xfe)},{'$lookup':{'from':_0x5742e6(0x142),'localField':_0x5742e6(0x18b),'foreignField':_0x5742e6(0x1bd),'as':_0x5742e6(0xd6)}},{'$unwind':_0x5742e6(0x199)},{'$project':{'product_name':_0x5742e6(0x1f9),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x5742e6(0x15b),'product_stock':{'$sum':_0x5742e6(0x10b)}}}]);console[_0x5742e6(0x18e)](_0x5742e6(0x16d),_0x1a489f),_0x1a489f['forEach'](_0x3c01d6=>{const _0x3125d5=_0x5742e6,_0x3f51a4=_0x4cbb53[_0x3125d5(0x124)](_0x64ac85=>{const _0x56ab27=_0x3125d5;_0x64ac85[_0x56ab27(0x1bd)]==_0x3c01d6['_id']&&(_0x64ac85[_0x56ab27(0x96)]=parseInt(_0x64ac85[_0x56ab27(0x96)])+parseInt(_0x3c01d6[_0x56ab27(0x16c)]));});});const _0x128a29=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x35798f=await staff['findOne']({'email':_0x526d3e[_0x5742e6(0x182)]});if(_0x3942ff[0x0][_0x5742e6(0x1fc)]==_0x5742e6(0x145))var _0x5e5002=users['English'];else{if(_0x3942ff[0x0][_0x5742e6(0x1fc)]==_0x5742e6(0xe4))var _0x5e5002=users[_0x5742e6(0xe4)];else{if(_0x3942ff[0x0][_0x5742e6(0x1fc)]==_0x5742e6(0x90))var _0x5e5002=users[_0x5742e6(0x90)];else{if(_0x3942ff[0x0][_0x5742e6(0x1fc)]==_0x5742e6(0x117))var _0x5e5002=users[_0x5742e6(0x117)];else{if(_0x3942ff[0x0][_0x5742e6(0x1fc)]==_0x5742e6(0x177))var _0x5e5002=users['French'];else{if(_0x3942ff[0x0][_0x5742e6(0x1fc)]==_0x5742e6(0x108))var _0x5e5002=users[_0x5742e6(0x1a9)];else{if(_0x3942ff[0x0][_0x5742e6(0x1fc)]==_0x5742e6(0x18f))var _0x5e5002=users[_0x5742e6(0x18f)];else{if(_0x3942ff[0x0]['language']==_0x5742e6(0x15a))var _0x5e5002=users['Arabic'];}}}}}}}_0x19b769[_0x5742e6(0xc0)](_0x5742e6(0x20f),{'success':_0x328c40['flash'](_0x5742e6(0xc2)),'errors':_0x328c40[_0x5742e6(0x211)](_0x5742e6(0x16b)),'alldata':_0x4cbb53,'profile':_0x1c1abf,'master_shop':_0x3942ff,'role':_0x526d3e,'product_stock':_0x1a489f,'language':_0x5e5002,'staff_arr':_0x35798f,'staff_data_all':_0x128a29});}catch(_0x2a645b){}}),router['post'](a0_0x400c41(0xa7),auth,async(_0x598314,_0x480832)=>{const _0x3e761=a0_0x400c41;try{const {from:_0x595e27,to:_0x4e1131,staff_data:_0x13b3bf}=_0x598314[_0x3e761(0x97)],_0x53395b=await Reference[_0x3e761(0x186)]([{'$match':{'date_include':{'$gte':_0x595e27,'$lte':_0x4e1131},'staff_id':_0x13b3bf}},{'$sort':{'date_include':0x1}}]);_0x480832[_0x3e761(0x114)](_0x53395b);}catch(_0x4a7db4){_0x480832[_0x3e761(0x114)](_0x4a7db4);}}),router[a0_0x400c41(0x1cc)](a0_0x400c41(0xf6),auth,async(_0x54c44e,_0x2f69bd)=>{const _0x16c882=a0_0x400c41;try{const {from:_0x4f8422,to:_0x1fb865}=_0x54c44e[_0x16c882(0x97)],{sttaff_id:_0x182410}=_0x54c44e[_0x16c882(0xd7)],_0x46567b=await Reference[_0x16c882(0x186)]([{'$match':{'date_include':{'$gte':_0x4f8422,'$lte':_0x1fb865},'staff_id':_0x182410}},{'$sort':{'date_include':0x1}}]);_0x2f69bd[_0x16c882(0x114)](_0x46567b);}catch(_0x395038){_0x2f69bd['json'](_0x395038);}}),router[a0_0x400c41(0x127)]('/dsrr_admin/view_data/:id',auth,async(_0x1786da,_0x375198)=>{const _0x45aabd=a0_0x400c41;try{const _0x5f38c1=_0x1786da[_0x45aabd(0xd1)]['id'],_0x3967a4=await Reference[_0x45aabd(0x1f7)](_0x5f38c1);let _0x29d09b='';_0x29d09b+=_0x3967a4['html'],_0x29d09b+=_0x45aabd(0x14c),_0x29d09b+='window.onload\x20=\x20function()\x20{',_0x29d09b+='window.print();',_0x29d09b+='};',_0x29d09b+=_0x45aabd(0x12b),_0x375198[_0x45aabd(0x1d7)](_0x29d09b);}catch(_0x25c5f8){_0x375198[_0x45aabd(0x114)](_0x25c5f8);}}),router[a0_0x400c41(0x1cc)](a0_0x400c41(0x138),auth,async(_0x438b32,_0x59cdb8)=>{const _0x400256=a0_0x400c41;try{const {ref_data:_0x1f3e43}=_0x438b32[_0x400256(0x97)],_0x132be2=_0x1f3e43[_0x400256(0x179)]('~'),_0x262528=_0x132be2[_0x400256(0x189)](_0x1ee9ac=>_0x1ee9ac!==''),_0x17f81a=await Reference[_0x400256(0x186)]([{'$match':{'referenceNumber':{'$in':_0x262528}}}]),_0x12fe09=XLSX[_0x400256(0xc3)][_0x400256(0x161)]();_0x17f81a[_0x400256(0x8a)](_0x1ac354=>{const _0x418b31=_0x400256,_0x44d83e=cheerio[_0x418b31(0x1e3)](_0x1ac354[_0x418b31(0x1c4)]);let _0x61c57b=[],_0x1cf608=[],_0x1ef42c=[];_0x44d83e(_0x418b31(0x10e))[_0x418b31(0x14a)]((_0x3bb334,_0x26eccc)=>{const _0x2e7eb6=_0x418b31;let _0x27fcbb=[],_0x27680a=0x0;while(_0x1ef42c[_0x27680a]){_0x1ef42c[_0x27680a]--,_0x27680a++;}_0x44d83e(_0x26eccc)[_0x2e7eb6(0xcd)]('td,\x20th')[_0x2e7eb6(0x14a)]((_0x7f7e7b,_0xff4ddd)=>{const _0x2826c4=_0x2e7eb6;let _0x58b406=_0x44d83e(_0xff4ddd)[_0x2826c4(0x187)]()['trim'](),_0x16cc15=parseFloat(_0x58b406[_0x2826c4(0x13a)](/,/g,''));isNaN(_0x16cc15)&&(_0x16cc15=_0x58b406);let _0x5a03fb=parseInt(_0x44d83e(_0xff4ddd)[_0x2826c4(0x105)](_0x2826c4(0xdf)))||0x1,_0x291f74=parseInt(_0x44d83e(_0xff4ddd)[_0x2826c4(0x105)]('rowspan'))||0x1;_0x27fcbb[_0x27680a]=_0x16cc15;(_0x5a03fb>0x1||_0x291f74>0x1)&&_0x1cf608['push']({'s':{'r':_0x3bb334,'c':_0x27680a},'e':{'r':_0x3bb334+_0x291f74-0x1,'c':_0x27680a+_0x5a03fb-0x1}});for(let _0x3f2863=0x0;_0x3f2863<_0x5a03fb;_0x3f2863++){_0x291f74>0x1&&(_0x1ef42c[_0x27680a+_0x3f2863]=_0x291f74-0x1);}_0x27680a+=_0x5a03fb;}),_0x61c57b[_0x2e7eb6(0x1b5)](_0x27fcbb);});const _0x6c2046=XLSX[_0x418b31(0xc3)][_0x418b31(0x176)](_0x61c57b);_0x1cf608[_0x418b31(0xd8)]>0x0&&(_0x6c2046[_0x418b31(0xaf)]=_0x1cf608),_0x6c2046['!cols']=_0x61c57b[0x0][_0x418b31(0x124)](()=>({'wpx':0x64})),XLSX['utils'][_0x418b31(0x9b)](_0x12fe09,_0x6c2046,_0x1ac354[_0x418b31(0x1a6)]);});const _0x543691=XLSX['write'](_0x12fe09,{'bookType':'xlsx','type':'buffer'});_0x59cdb8[_0x400256(0x12e)](_0x400256(0x147),_0x400256(0x173)),_0x59cdb8['setHeader'](_0x400256(0x100),_0x400256(0x1a2)),_0x59cdb8[_0x400256(0x1d7)](_0x543691);}catch(_0x35b87d){_0x59cdb8['json'](_0x35b87d);}}),router['post'](a0_0x400c41(0x20e),auth,async(_0x784e99,_0x32c005)=>{const _0x2d965f=a0_0x400c41,{from_date:_0x5acd3c,agent_id:_0x5b6bc4}=_0x784e99['body'],_0x1a2e99=_0x784e99[_0x2d965f(0xd7)],_0x3fb8dd=await staff[_0x2d965f(0x1da)]({'email':_0x1a2e99[_0x2d965f(0x182)]}),_0x1bef93=await master_shop[_0x2d965f(0xcd)](),_0x11e769=await agentsdataDSICheck_DSRR(_0x5acd3c,_0x5b6bc4,_0xd0bae8);let _0x2ff929=_0x2d965f(0x219);var _0x425936=new Date(_0x5acd3c);const _0x3d5f49={'year':_0x2d965f(0x1c1),'month':_0x2d965f(0x1a3),'day':_0x2d965f(0x1c1)},_0x3ec3e5=new Intl[(_0x2d965f(0x212))]('en-US',_0x3d5f49)[_0x2d965f(0x1d3)](_0x425936);_0x2ff929+=_0x2d965f(0x1f1),_0x2ff929+='<div\x20\x20id=\x22table-conatainer\x22>',_0x2ff929+=_0x2d965f(0x10a),_0x2ff929+=_0x11e769,_0x2ff929+=_0x2d965f(0x99),_0x2ff929+=_0x2d965f(0xf0),_0x2ff929+=_0x2d965f(0xf0);let _0x3a9ca4=_0x2d965f(0x101);const _0x28e537={'width':_0x2d965f(0xdd),'height':'8.5in','orientation':_0x2d965f(0x16a),'border':{'top':_0x2d965f(0x17e),'right':_0x2d965f(0x17e),'bottom':_0x2d965f(0x17e),'left':'0.1in'},'header':{'height':'60mm','contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3a9ca4+_0x2d965f(0xec)+_0x3ec3e5+_0x2d965f(0x146)},'footer':{'height':_0x2d965f(0x8d),'contents':{'default':_0x2d965f(0x8e)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x2d965f(0x143)}}};var _0xd0bae8='on';if(_0xd0bae8=='on'){const _0xd3cc54=cheerio['load'](_0x2ff929);let _0x3d6bad=[],_0x304921=[],_0x49a1e8=[];_0xd3cc54(_0x2d965f(0x10e))['each']((_0x1f8167,_0x58c056)=>{const _0x8400e4=_0x2d965f;let _0xc316c3=[],_0x445f86=0x0;while(_0x49a1e8[_0x445f86]){_0x49a1e8[_0x445f86]--,_0x445f86++;}_0xd3cc54(_0x58c056)['find'](_0x8400e4(0x166))[_0x8400e4(0x14a)]((_0x4a6d1f,_0x285d1f)=>{const _0x1e4b28=_0x8400e4;let _0x10e349=_0xd3cc54(_0x285d1f)['text']()[_0x1e4b28(0x1db)](),_0x2961b1=parseFloat(_0x10e349[_0x1e4b28(0x13a)](/,/g,''));isNaN(_0x2961b1)&&(_0x2961b1=_0x10e349);let _0x3e0659=parseInt(_0xd3cc54(_0x285d1f)[_0x1e4b28(0x105)](_0x1e4b28(0xdf)))||0x1,_0x8fc0ba=parseInt(_0xd3cc54(_0x285d1f)[_0x1e4b28(0x105)](_0x1e4b28(0x180)))||0x1;_0xc316c3[_0x445f86]=_0x2961b1;(_0x3e0659>0x1||_0x8fc0ba>0x1)&&_0x304921[_0x1e4b28(0x1b5)]({'s':{'r':_0x1f8167,'c':_0x445f86},'e':{'r':_0x1f8167+_0x8fc0ba-0x1,'c':_0x445f86+_0x3e0659-0x1}});for(let _0x153824=0x0;_0x153824<_0x3e0659;_0x153824++){_0x8fc0ba>0x1&&(_0x49a1e8[_0x445f86+_0x153824]=_0x8fc0ba-0x1);}_0x445f86+=_0x3e0659;}),_0x3d6bad['push'](_0xc316c3);});const _0x5c2f21=XLSX[_0x2d965f(0xc3)][_0x2d965f(0x161)](),_0x217084=XLSX[_0x2d965f(0xc3)][_0x2d965f(0x176)](_0x3d6bad);_0x304921[_0x2d965f(0xd8)]>0x0&&(_0x217084[_0x2d965f(0xaf)]=_0x304921);_0x217084[_0x2d965f(0xf7)]=_0x3d6bad[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x2d965f(0x9b)](_0x5c2f21,_0x217084,_0x2d965f(0x102));const _0x4046bf=XLSX[_0x2d965f(0xdc)](_0x5c2f21,{'bookType':_0x2d965f(0xd3),'type':_0x2d965f(0x129)});_0x32c005[_0x2d965f(0x12e)](_0x2d965f(0x147),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x32c005[_0x2d965f(0x12e)](_0x2d965f(0x100),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x32c005[_0x2d965f(0x1d7)](_0x4046bf);}else pdf[_0x2d965f(0x11b)](_0x2ff929,_0x28e537)['toStream'](function(_0x4ab29c,_0x3b77d2){const _0x43ef32=_0x2d965f;if(_0x4ab29c){_0x32c005[_0x43ef32(0x1e7)](0x1f4)[_0x43ef32(0x1d7)]('Error\x20generating\x20PDF');return;}_0x32c005['setHeader']('Content-Type',_0x43ef32(0x1b6)),_0x3b77d2[_0x43ef32(0x14d)](_0x32c005);});}),module['exports']=router;