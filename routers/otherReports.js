const a0_0x412553=a0_0x1073;(function(_0x2f394e,_0x55fd55){const _0x5b63f4=a0_0x1073,_0x265d75=_0x2f394e();while(!![]){try{const _0x18e541=-parseInt(_0x5b63f4(0x15c))/0x1*(-parseInt(_0x5b63f4(0x1f2))/0x2)+parseInt(_0x5b63f4(0x174))/0x3+-parseInt(_0x5b63f4(0x2b7))/0x4*(-parseInt(_0x5b63f4(0x28d))/0x5)+parseInt(_0x5b63f4(0x239))/0x6+parseInt(_0x5b63f4(0x290))/0x7+parseInt(_0x5b63f4(0x1d6))/0x8*(parseInt(_0x5b63f4(0x24e))/0x9)+-parseInt(_0x5b63f4(0x246))/0xa*(parseInt(_0x5b63f4(0x27f))/0xb);if(_0x18e541===_0x55fd55)break;else _0x265d75['push'](_0x265d75['shift']());}catch(_0x5de4a7){_0x265d75['push'](_0x265d75['shift']());}}}(a0_0x4444,0xf0cb3));const express=require(a0_0x412553(0x14c)),res=require('express/lib/response'),app=express(),router=express[a0_0x412553(0x1ca)](),multer=require(a0_0x412553(0x1b1)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x412553(0x250)),auth=require(a0_0x412553(0x296)),users=require(a0_0x412553(0x1a1)),excelJS=require(a0_0x412553(0x26e)),XLSX=require(a0_0x412553(0x17a)),PDFDocument=require('pdfkit-table'),fs=require('fs'),blobStream=require(a0_0x412553(0x21f)),JsBarcode=require(a0_0x412553(0x1e9)),{Canvas}=require(a0_0x412553(0x258)),pdf=require(a0_0x412553(0x2cd)),path=require('path'),mongoose=require(a0_0x412553(0x16f)),cheerio=require('cheerio');router[a0_0x412553(0x21e)]('/balance/view',auth,async(_0xb3035b,_0x448fa9)=>{const _0x1ec1d0=a0_0x412553;try{const {username:_0x17257f,email:_0x205814,role:_0x38d869}=_0xb3035b[_0x1ec1d0(0x203)],_0x4923e5=_0xb3035b[_0x1ec1d0(0x203)],_0x403106=await profile[_0x1ec1d0(0x1b0)]({'email':_0x4923e5[_0x1ec1d0(0x29a)]}),_0x1897dc={'year':_0x1ec1d0(0x278),'month':_0x1ec1d0(0x213),'day':_0x1ec1d0(0x278)},_0x1d0221=await master_shop[_0x1ec1d0(0x1c2)]();console[_0x1ec1d0(0x196)](_0x1ec1d0(0x191),_0x1d0221);const _0x1a69db=await product[_0x1ec1d0(0x1c2)]();console[_0x1ec1d0(0x196)](_0x1ec1d0(0x15d),_0x1a69db);const _0x5c75fe=await warehouse[_0x1ec1d0(0x22c)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':'name','as':_0x1ec1d0(0x145)}},{'$unwind':_0x1ec1d0(0x13f)},{'$project':{'product_name':_0x1ec1d0(0x24b),'product_stock':_0x1ec1d0(0x179)}},{'$group':{'_id':_0x1ec1d0(0x279),'product_stock':{'$sum':_0x1ec1d0(0x2aa)}}}]);console['log']('Products\x20warehouse_data',_0x5c75fe),_0x5c75fe['forEach'](_0x47be54=>{const _0x1c2dbe=_0x1a69db['map'](_0x1783f5=>{const _0x1dd04e=a0_0x1073;_0x1783f5[_0x1dd04e(0x2c4)]==_0x47be54['_id']&&(_0x1783f5[_0x1dd04e(0x152)]=parseInt(_0x1783f5['stock'])+parseInt(_0x47be54['product_stock']));});}),console[_0x1ec1d0(0x196)]('Products\x20find_data',_0x1a69db);if(_0x1d0221[0x0]['language']==_0x1ec1d0(0x1fc))var _0x301b2e=users[_0x1ec1d0(0x2a3)];else{if(_0x1d0221[0x0][_0x1ec1d0(0x1b7)]=='Hindi')var _0x301b2e=users[_0x1ec1d0(0x195)];else{if(_0x1d0221[0x0][_0x1ec1d0(0x1b7)]==_0x1ec1d0(0x1ed))var _0x301b2e=users['German'];else{if(_0x1d0221[0x0][_0x1ec1d0(0x1b7)]==_0x1ec1d0(0x1dd))var _0x301b2e=users[_0x1ec1d0(0x1dd)];else{if(_0x1d0221[0x0][_0x1ec1d0(0x1b7)]=='French')var _0x301b2e=users[_0x1ec1d0(0x2b0)];else{if(_0x1d0221[0x0][_0x1ec1d0(0x1b7)]==_0x1ec1d0(0x28c))var _0x301b2e=users['Portuguese'];else{if(_0x1d0221[0x0][_0x1ec1d0(0x1b7)]=='Chinese')var _0x301b2e=users[_0x1ec1d0(0x2ba)];else{if(_0x1d0221[0x0][_0x1ec1d0(0x1b7)]==_0x1ec1d0(0x247))var _0x301b2e=users['Arabic'];}}}}}}}_0x448fa9[_0x1ec1d0(0x1ee)](_0x1ec1d0(0x27b),{'success':_0xb3035b[_0x1ec1d0(0x180)](_0x1ec1d0(0x19c)),'errors':_0xb3035b[_0x1ec1d0(0x180)]('errors'),'alldata':_0x1a69db,'profile':_0x403106,'master_shop':_0x1d0221,'role':_0x4923e5,'product_stock':_0x5c75fe,'language':_0x301b2e});}catch(_0x25171d){}});async function dataCheck(_0x37b066,_0x128152){const _0x33c274=a0_0x412553,_0x2181f5=await product[_0x33c274(0x22c)]([{'$group':{'_id':{'brand':_0x33c274(0x227),'category':_0x33c274(0x22e)},'products':{'$push':{'name':'$name','product_code':_0x33c274(0x1c1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x15e95d=[];_0x15e95d[_0x33c274(0x205)]=[];for(let _0x570f26=0x0;_0x570f26<=_0x2181f5['length']-0x1;_0x570f26++){const _0x1ebfad=_0x2181f5[_0x570f26];_0x15e95d['cat_brand'][_0x33c274(0x190)](_0x1ebfad);}const _0x3e155e=await product[_0x33c274(0x22c)]([{'$group':{'_id':{'category':_0x33c274(0x22e)},'products':{'$push':{'brand':_0x33c274(0x227),'product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x39cce2=await purchases_finished[_0x33c274(0x22c)]([{'$match':{'date':{'$gte':_0x37b066,'$lte':_0x128152}}},{'$unwind':_0x33c274(0x27e)},{'$group':{'_id':{'product_name':_0x33c274(0x1d0),'product_code':_0x33c274(0x202)},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x15e95d[_0x33c274(0x1b2)]=[];for(let _0x123bb5=0x0;_0x123bb5<=_0x39cce2[_0x33c274(0x2bf)]-0x1;_0x123bb5++){const _0x53e72a=_0x39cce2[_0x123bb5];_0x15e95d[_0x33c274(0x1b2)][_0x33c274(0x190)](_0x53e72a);}const _0x2d489d=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x37b066,'$lte':_0x128152}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x33c274(0x226)}}},{'$lookup':{'from':_0x33c274(0x217),'localField':_0x33c274(0x163),'foreignField':_0x33c274(0x275),'as':_0x33c274(0x16a)}},{'$unwind':_0x33c274(0x156)},{'$unwind':_0x33c274(0x29b)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x33c274(0x285),'product_code':_0x33c274(0x2ca)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console[_0x33c274(0x196)](_0x2d489d[0x0]),_0x15e95d[_0x33c274(0x284)]=[];for(let _0xea1d1d=0x0;_0xea1d1d<=_0x2d489d[_0x33c274(0x2bf)]-0x1;_0xea1d1d++){const _0x51c7c1=_0x2d489d[_0xea1d1d];_0x15e95d['sales_bkg'][_0x33c274(0x190)](_0x51c7c1);}const _0x4c002b=await sales_sa[_0x33c274(0x22c)]([{'$match':{'date':{'$gte':_0x37b066,'$lte':_0x128152}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x33c274(0x226)}}},{'$lookup':{'from':'staffs','localField':_0x33c274(0x163),'foreignField':_0x33c274(0x275),'as':_0x33c274(0x16a)}},{'$unwind':_0x33c274(0x156)},{'$unwind':_0x33c274(0x29b)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x33c274(0x269)}},{'$group':{'_id':{'product_name':_0x33c274(0x285),'product_code':_0x33c274(0x2ca)},'totalQTY':{'$sum':_0x33c274(0x25b)}}}]);_0x15e95d[_0x33c274(0x189)]=[];for(let _0x271dcd=0x0;_0x271dcd<=_0x4c002b[_0x33c274(0x2bf)]-0x1;_0x271dcd++){const _0x5ebe8d=_0x4c002b[_0x271dcd];_0x15e95d[_0x33c274(0x189)][_0x33c274(0x190)](_0x5ebe8d);}let _0x11e86e='';for(let _0x47bd3f=0x0;_0x47bd3f<=_0x3e155e[_0x33c274(0x2bf)]-0x1;_0x47bd3f++){const _0x56ccae=_0x3e155e[_0x47bd3f];_0x11e86e+='<tr>',_0x11e86e+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x56ccae['_id'][_0x33c274(0x297)]+_0x33c274(0x204),_0x11e86e+=_0x33c274(0x1b9);for(let _0x23ae92=0x0;_0x23ae92<_0x15e95d[_0x33c274(0x205)][_0x33c274(0x2bf)];_0x23ae92++){const _0x506cd8=_0x15e95d[_0x33c274(0x205)][_0x23ae92];if(_0x506cd8[_0x33c274(0x275)]['category']==_0x56ccae[_0x33c274(0x275)][_0x33c274(0x297)]){let _0x101b52=[],_0x24154d=[],_0x51027d=[];_0x101b52[_0x506cd8[_0x33c274(0x275)][_0x33c274(0x1e2)]]=[],_0x24154d[_0x506cd8[_0x33c274(0x275)][_0x33c274(0x1e2)]]=[],_0x51027d[_0x506cd8[_0x33c274(0x275)]['brand']]=[];var _0x5857f5=0x0,_0x17e36f=0x0,_0x111a2e=0x0;for(let _0x2ace5e=0x0;_0x2ace5e<_0x506cd8[_0x33c274(0x2b6)][_0x33c274(0x2bf)];_0x2ace5e++){const _0x2895ae=_0x506cd8['products'][_0x2ace5e];for(let _0x19d581=0x0;_0x19d581<=_0x15e95d[_0x33c274(0x1b2)][_0x33c274(0x2bf)]-0x1;_0x19d581++){const _0x257f9b=_0x15e95d[_0x33c274(0x1b2)][_0x19d581];_0x257f9b[_0x33c274(0x275)][_0x33c274(0x1ac)]==_0x2895ae[_0x33c274(0x2c4)]&&_0x257f9b[_0x33c274(0x275)]['product_code']==_0x2895ae[_0x33c274(0x14f)]&&(_0x5857f5+=parseInt(_0x257f9b[_0x33c274(0x28a)],0xa));}for(let _0x44a908=0x0;_0x44a908<=_0x15e95d[_0x33c274(0x189)]['length']-0x1;_0x44a908++){const _0x66df0c=_0x15e95d['sales_ext'][_0x44a908];_0x66df0c['_id'][_0x33c274(0x1ac)]==_0x2895ae[_0x33c274(0x2c4)]&&_0x66df0c['_id'][_0x33c274(0x14f)]==_0x2895ae[_0x33c274(0x14f)]&&(_0x17e36f+=parseFloat(_0x66df0c[_0x33c274(0x28a)],0xa)[_0x33c274(0x273)](0x2));}for(let _0x12ddb1=0x0;_0x12ddb1<=_0x15e95d['sales_bkg'][_0x33c274(0x2bf)]-0x1;_0x12ddb1++){const _0x3da9b1=_0x15e95d['sales_bkg'][_0x12ddb1];_0x3da9b1[_0x33c274(0x275)][_0x33c274(0x1ac)]==_0x2895ae[_0x33c274(0x2c4)]&&_0x3da9b1['_id'][_0x33c274(0x14f)]==_0x2895ae[_0x33c274(0x14f)]&&(_0x111a2e+=parseInt(_0x3da9b1[_0x33c274(0x28a)],0xa));}}const _0x1db38e=new Intl[(_0x33c274(0x27a))](_0x33c274(0x1de));var _0x1c81ce=_0x1db38e['format'](_0x5857f5);_0x101b52[_0x506cd8[_0x33c274(0x275)][_0x33c274(0x1e2)]][_0x33c274(0x190)](_0x1c81ce),_0x24154d[_0x506cd8['_id'][_0x33c274(0x1e2)]][_0x33c274(0x190)](_0x1db38e[_0x33c274(0x19b)](_0x17e36f)),_0x51027d[_0x506cd8[_0x33c274(0x275)]['brand']]['push'](_0x1db38e[_0x33c274(0x19b)](_0x111a2e));var _0x291d75=_0x1db38e['format'](_0x5857f5-(_0x111a2e+_0x17e36f));_0x11e86e+=_0x33c274(0x2c6),_0x11e86e+=_0x33c274(0x187),_0x11e86e+=_0x33c274(0x280)+_0x506cd8[_0x33c274(0x275)]['brand']+_0x33c274(0x204),_0x11e86e+=_0x33c274(0x280)+_0x101b52[_0x506cd8['_id'][_0x33c274(0x1e2)]][0x0]+_0x33c274(0x204),_0x11e86e+=_0x33c274(0x28b),_0x11e86e+=_0x33c274(0x280)+_0x51027d[_0x506cd8[_0x33c274(0x275)][_0x33c274(0x1e2)]][0x0]+_0x33c274(0x204),_0x11e86e+=_0x33c274(0x280)+_0x24154d[_0x506cd8[_0x33c274(0x275)][_0x33c274(0x1e2)]][0x0]+_0x33c274(0x204),_0x11e86e+=_0x33c274(0x280)+_0x291d75+_0x33c274(0x204),_0x11e86e+=_0x33c274(0x1b9);}}}return console[_0x33c274(0x196)](_0x15e95d['sales_bkg']),_0x11e86e;}router[a0_0x412553(0x233)](a0_0x412553(0x291),auth,async(_0x143a93,_0x17021e)=>{const _0x580dc9=a0_0x412553,{from_date:_0x4f0a5b,to_date:_0x391c7b}=_0x143a93[_0x580dc9(0x19d)],_0x1c12fe=await dataCheck(_0x4f0a5b,_0x391c7b);{}let _0x1883ee=_0x580dc9(0x26c);var _0x3028e7=new Date(_0x4f0a5b),_0x3035c7=new Date(_0x391c7b);const _0x1aec0e={'year':_0x580dc9(0x278),'month':_0x580dc9(0x213),'day':'numeric'},_0x3d7ed6=new Intl['DateTimeFormat'](_0x580dc9(0x1de),_0x1aec0e)[_0x580dc9(0x19b)](_0x3028e7),_0x2dfec5=new Intl[(_0x580dc9(0x1d7))](_0x580dc9(0x1de),_0x1aec0e)['format'](_0x3035c7);_0x1883ee+=_0x580dc9(0x2a5),_0x1883ee+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x1883ee+='<p>'+_0x3d7ed6+_0x580dc9(0x218)+_0x2dfec5+'</p>',_0x1883ee+=_0x580dc9(0x21b),_0x1883ee+=_0x580dc9(0x1fa),_0x1883ee+=_0x580dc9(0x184),_0x1883ee+=_0x580dc9(0x2c6),_0x1883ee+=_0x580dc9(0x25c),_0x1883ee+=_0x580dc9(0x1ad),_0x1883ee+=_0x580dc9(0x186)+_0x3d7ed6+_0x580dc9(0x1c6),_0x1883ee+=_0x580dc9(0x17c),_0x1883ee+=_0x580dc9(0x2a2),_0x1883ee+=_0x580dc9(0x148)+_0x2dfec5+_0x580dc9(0x1c6),_0x1883ee+=_0x580dc9(0x1b9),_0x1883ee+=_0x580dc9(0x2c6),_0x1883ee+='<th>Booking</th>',_0x1883ee+=_0x580dc9(0x1df),_0x1883ee+=_0x580dc9(0x1b9),_0x1883ee+=_0x1c12fe,_0x1883ee+=_0x580dc9(0x28f),_0x1883ee+=_0x580dc9(0x2b8),_0x1883ee+='</div>';const _0x4f0c87={'format':_0x580dc9(0x259),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x580dc9(0x17b)}}};pdf[_0x580dc9(0x2c9)](_0x1883ee,_0x4f0c87)[_0x580dc9(0x257)](function(_0x151193,_0x43eb9c){const _0xb5a427=_0x580dc9;if(_0x151193){_0x17021e[_0xb5a427(0x254)](0x1f4)['send'](_0xb5a427(0x29e));return;}_0x17021e[_0xb5a427(0x1cf)](_0xb5a427(0x2b1),_0xb5a427(0x295)),_0x43eb9c[_0xb5a427(0x274)](_0x17021e);});}),router['get']('/agent/view',auth,async(_0x2830d0,_0x9dbc65)=>{const _0x4262b1=a0_0x412553;try{const {username:_0xd77315,email:_0x27582f,role:_0x14f671}=_0x2830d0[_0x4262b1(0x203)],_0x4a3705=_0x2830d0[_0x4262b1(0x203)],_0x28a142=await profile[_0x4262b1(0x1b0)]({'email':_0x4a3705[_0x4262b1(0x29a)]}),_0x460da4={'year':_0x4262b1(0x278),'month':_0x4262b1(0x213),'day':_0x4262b1(0x278)},_0x1e10ac=await master_shop[_0x4262b1(0x1c2)](),_0x5ed0d6=await product[_0x4262b1(0x1c2)](),_0x1e3415=await warehouse[_0x4262b1(0x22c)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x4262b1(0x2b6),'localField':_0x4262b1(0x2a6),'foreignField':'name','as':_0x4262b1(0x145)}},{'$unwind':_0x4262b1(0x13f)},{'$project':{'product_name':_0x4262b1(0x24b),'product_stock':_0x4262b1(0x179)}},{'$group':{'_id':_0x4262b1(0x279),'product_stock':{'$sum':_0x4262b1(0x2aa)}}}]);if(_0x1e10ac[0x0][_0x4262b1(0x1b7)]==_0x4262b1(0x1fc))var _0x512919=users['English'];else{if(_0x1e10ac[0x0]['language']==_0x4262b1(0x195))var _0x512919=users[_0x4262b1(0x195)];else{if(_0x1e10ac[0x0][_0x4262b1(0x1b7)]=='German')var _0x512919=users[_0x4262b1(0x1ed)];else{if(_0x1e10ac[0x0][_0x4262b1(0x1b7)]==_0x4262b1(0x1dd))var _0x512919=users['Spanish'];else{if(_0x1e10ac[0x0][_0x4262b1(0x1b7)]==_0x4262b1(0x2b0))var _0x512919=users[_0x4262b1(0x2b0)];else{if(_0x1e10ac[0x0][_0x4262b1(0x1b7)]=='Portuguese\x20(BR)')var _0x512919=users[_0x4262b1(0x241)];else{if(_0x1e10ac[0x0][_0x4262b1(0x1b7)]==_0x4262b1(0x2ba))var _0x512919=users[_0x4262b1(0x2ba)];else{if(_0x1e10ac[0x0][_0x4262b1(0x1b7)]=='Arabic\x20(ae)')var _0x512919=users['Arabic'];}}}}}}}_0x9dbc65[_0x4262b1(0x1ee)](_0x4262b1(0x201),{'success':_0x2830d0[_0x4262b1(0x180)](_0x4262b1(0x19c)),'errors':_0x2830d0['flash'](_0x4262b1(0x20f)),'alldata':_0x5ed0d6,'profile':_0x28a142,'master_shop':_0x1e10ac,'role':_0x4a3705,'product_stock':_0x1e3415,'language':_0x512919});}catch(_0x5a0354){}});async function agentsdataCheck(_0x5f20ba,_0x245631){const _0x53d66e=a0_0x412553,_0x3665cc=await product['aggregate']([{'$group':{'_id':{'brand':_0x53d66e(0x227),'category':_0x53d66e(0x22e)},'products':{'$push':{'name':_0x53d66e(0x1ce),'product_code':_0x53d66e(0x1c1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x8f306=[];_0x8f306[_0x53d66e(0x205)]=[];for(let _0x51e38b=0x0;_0x51e38b<=_0x3665cc[_0x53d66e(0x2bf)]-0x1;_0x51e38b++){const _0x2ef84b=_0x3665cc[_0x51e38b];_0x8f306[_0x53d66e(0x205)][_0x53d66e(0x190)](_0x2ef84b);}const _0xf2c788=await product[_0x53d66e(0x22c)]([{'$group':{'_id':{'category':_0x53d66e(0x22e)},'products':{'$push':{'brand':_0x53d66e(0x227),'product_code':_0x53d66e(0x1c1),'product_name':_0x53d66e(0x1ce)}}}},{'$sort':{'_id.category':-0x1}}]),_0x53bff9=await product[_0x53d66e(0x22c)]([{'$group':{'_id':{'category':_0x53d66e(0x22e),'brand':_0x53d66e(0x227)}}},{'$group':{'_id':_0x53d66e(0x161),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4d3cb5=await sales_sa[_0x53d66e(0x22c)]([{'$match':{'date':{'$gte':_0x5f20ba,'$lte':_0x245631}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x53d66e(0x226)}}},{'$lookup':{'from':_0x53d66e(0x217),'localField':'sales_staff_id','foreignField':_0x53d66e(0x275),'as':_0x53d66e(0x16a)}},{'$unwind':'$sales_info'},{'$unwind':_0x53d66e(0x29b)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x53d66e(0x269)}},{'$lookup':{'from':'products','localField':_0x53d66e(0x240),'foreignField':_0x53d66e(0x14f),'as':_0x53d66e(0x1e6)}},{'$unwind':_0x53d66e(0x16c)},{'$group':{'_id':{'sales_id':_0x53d66e(0x1cd),'category':'$product_info.category','brand':'$product_info.brand'},'salesman_data':{'$first':_0x53d66e(0x223)},'totalQTY':{'$sum':_0x53d66e(0x25b)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','product_details':{'prod_name':_0x53d66e(0x1a8),'product_code':_0x53d66e(0x262),'category':_0x53d66e(0x1bc),'brand':'$product_info.brand'}}}}}]);let _0x2aaee6='';_0x2aaee6+='<tr>',_0x2aaee6+=_0x53d66e(0x272),_0x2aaee6+=_0x53d66e(0x1b9),_0x2aaee6+=_0x53d66e(0x2c6),_0x2aaee6+=_0x53d66e(0x29c);for(let _0x5474e5=0x0;_0x5474e5<=_0xf2c788['length']-0x1;_0x5474e5++){const _0x5ca243=_0xf2c788[_0x5474e5];for(let _0x22791d=0x0;_0x22791d<_0x53bff9[_0x53d66e(0x2bf)];_0x22791d++){const _0x157bde=_0x53bff9[_0x22791d];_0x157bde[_0x53d66e(0x275)]==_0x5ca243[_0x53d66e(0x275)]['category']&&(_0x2aaee6+='<td\x20colspan=\x22'+_0x157bde[_0x53d66e(0x1bf)]+_0x53d66e(0x232)+_0x5ca243[_0x53d66e(0x275)][_0x53d66e(0x297)]+'</td>');}}_0x2aaee6+=_0x53d66e(0x29c),_0x2aaee6+=_0x53d66e(0x1b9),_0x2aaee6+='<tr>',_0x2aaee6+=_0x53d66e(0x282);for(let _0x3d8d04=0x0;_0x3d8d04<=_0xf2c788[_0x53d66e(0x2bf)]-0x1;_0x3d8d04++){const _0x2a6a4d=_0xf2c788[_0x3d8d04];for(let _0x5177bd=0x0;_0x5177bd<_0x8f306[_0x53d66e(0x205)][_0x53d66e(0x2bf)];_0x5177bd++){const _0x51cc61=_0x8f306[_0x53d66e(0x205)][_0x5177bd];_0x51cc61['_id'][_0x53d66e(0x297)]==_0x2a6a4d[_0x53d66e(0x275)]['category']&&(_0x2aaee6+=_0x53d66e(0x24c)+_0x51cc61['_id']['brand']+_0x53d66e(0x204));}}_0x2aaee6+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x2aaee6+='</tr>';let _0x1d91d0={'name':[],'dataqty':{}};for(let _0x51d0ec=0x0;_0x51d0ec<_0x8f306['cat_brand'][_0x53d66e(0x2bf)];_0x51d0ec++){const _0xf4c4fc=_0x8f306[_0x53d66e(0x205)][_0x51d0ec],_0xb4be9f=_0xf4c4fc[_0x53d66e(0x275)][_0x53d66e(0x1e2)],_0x1cda92=_0xf4c4fc['_id'][_0x53d66e(0x297)];!_0x1d91d0[_0x53d66e(0x261)][_0xb4be9f]&&(_0x1d91d0[_0x53d66e(0x261)][_0xb4be9f]={});!_0x1d91d0[_0x53d66e(0x261)][_0xb4be9f][_0x1cda92]&&(_0x1d91d0[_0x53d66e(0x261)][_0xb4be9f][_0x1cda92]=[]);for(let _0x4bc41e=0x0;_0x4bc41e<_0x4d3cb5[_0x53d66e(0x2bf)];_0x4bc41e++){const _0x1722db=_0x4d3cb5[_0x4bc41e];if(_0xb4be9f===_0x1722db['_id'][_0x53d66e(0x1e2)]&&_0x1cda92===_0x1722db[_0x53d66e(0x275)]['category']){const _0x481e57=_0x1722db[_0x53d66e(0x149)];!_0x1d91d0[_0x53d66e(0x261)][_0xb4be9f][_0x1cda92][_0x481e57]&&(_0x1d91d0[_0x53d66e(0x261)][_0xb4be9f][_0x1cda92][_0x481e57]=[]),_0x1d91d0[_0x53d66e(0x261)][_0xb4be9f][_0x1cda92][_0x481e57][_0x53d66e(0x190)](_0x1722db[_0x53d66e(0x28a)]),!_0x1d91d0['name'][_0x53d66e(0x283)](_0x481e57)&&_0x1d91d0[_0x53d66e(0x2c4)][_0x53d66e(0x190)](_0x481e57);}}}_0x2aaee6+=_0x53d66e(0x2c6);for(let _0x1029a8=0x0;_0x1029a8<=_0x1d91d0[_0x53d66e(0x2c4)][_0x53d66e(0x2bf)]-0x1;_0x1029a8++){const _0x20c8f6=_0x1d91d0[_0x53d66e(0x2c4)][_0x1029a8];_0x2aaee6+=_0x53d66e(0x280)+_0x20c8f6+_0x53d66e(0x204);var _0x58ebf2=0x0,_0x10820c=0x0;for(let _0xab3147=0x0;_0xab3147<=_0x8f306['cat_brand'][_0x53d66e(0x2bf)]-0x1;_0xab3147++){const _0x331b14=_0x8f306['cat_brand'][_0xab3147];var _0x4c3e6f=0x0;_0x1d91d0[_0x53d66e(0x261)][_0x331b14['_id'][_0x53d66e(0x1e2)]][_0x331b14[_0x53d66e(0x275)][_0x53d66e(0x297)]][_0x20c8f6]?(_0x4c3e6f=_0x1d91d0[_0x53d66e(0x261)][_0x331b14[_0x53d66e(0x275)]['brand']][_0x331b14[_0x53d66e(0x275)][_0x53d66e(0x297)]][_0x20c8f6][0x0],_0x2aaee6+=_0x53d66e(0x280)+formatNumber(_0x4c3e6f[_0x53d66e(0x273)](0x2))+_0x53d66e(0x204)):(_0x4c3e6f=0x0,_0x2aaee6+=_0x53d66e(0x280)+_0x4c3e6f+_0x53d66e(0x204)),_0x58ebf2+=_0x4c3e6f;}_0x2aaee6+=_0x53d66e(0x280)+formatNumber(_0x58ebf2['toFixed'](0x2))+_0x53d66e(0x204);}return _0x2aaee6+=_0x53d66e(0x1b9),_0x2aaee6;}router[a0_0x412553(0x233)](a0_0x412553(0x29f),auth,async(_0x1d8251,_0x5a558a)=>{const _0x4448ff=a0_0x412553,{from_date:_0x135d9c,to_date:_0x41b708}=_0x1d8251[_0x4448ff(0x19d)],_0x57bc64=await agentsdataCheck(_0x135d9c,_0x41b708);{}let _0x31dc55=_0x4448ff(0x2b5);var _0x24fb35=new Date(_0x135d9c),_0x5ab714=new Date(_0x41b708);const _0x418a70={'year':_0x4448ff(0x278),'month':_0x4448ff(0x213),'day':_0x4448ff(0x278)},_0x9da5f7=new Intl['DateTimeFormat']('en-US',_0x418a70)[_0x4448ff(0x19b)](_0x24fb35),_0x39cdd1=new Intl[(_0x4448ff(0x1d7))](_0x4448ff(0x1de),_0x418a70)[_0x4448ff(0x19b)](_0x5ab714);_0x31dc55+=_0x4448ff(0x2a5),_0x31dc55+=_0x4448ff(0x2a9),_0x31dc55+=_0x4448ff(0x231)+_0x9da5f7+_0x4448ff(0x218)+_0x39cdd1+_0x4448ff(0x228),_0x31dc55+='<div\x20class=\x22row\x22>',_0x31dc55+=_0x4448ff(0x1fa),_0x31dc55+='<table>',_0x31dc55+=_0x57bc64,_0x31dc55+=_0x4448ff(0x28f),_0x31dc55+=_0x4448ff(0x2b8),_0x31dc55+=_0x4448ff(0x2b8);const _0x7aecb3={'format':'Letter','orientation':_0x4448ff(0x207),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x4448ff(0x17b)}}};pdf[_0x4448ff(0x2c9)](_0x31dc55,_0x7aecb3)[_0x4448ff(0x257)](function(_0x75492f,_0x507b20){const _0x373eb0=_0x4448ff;if(_0x75492f){_0x5a558a['status'](0x1f4)[_0x373eb0(0x2a1)](_0x373eb0(0x29e));return;}_0x5a558a[_0x373eb0(0x1cf)](_0x373eb0(0x2b1),_0x373eb0(0x295)),_0x507b20[_0x373eb0(0x274)](_0x5a558a);});}),router[a0_0x412553(0x21e)]('/agent_reports/sales_ad',auth,async(_0x3308a0,_0x977040)=>{const _0x1d572c=a0_0x412553;try{const {username:_0x14c070,email:_0x4b8e8e,role:_0x10af90}=_0x3308a0[_0x1d572c(0x203)],_0x2b9076=_0x3308a0[_0x1d572c(0x203)],_0x4132f5=await profile['findOne']({'email':_0x2b9076['email']}),_0x5270f2={'year':_0x1d572c(0x278),'month':_0x1d572c(0x213),'day':_0x1d572c(0x278)},_0x633fd6=await master_shop[_0x1d572c(0x1c2)](),_0x4d5e9a=await staff['findOne']({'email':_0x2b9076[_0x1d572c(0x29a)]}),_0x223944=await product[_0x1d572c(0x1c2)](),_0x21f0cf=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x1d572c(0x2b6),'localField':_0x1d572c(0x2a6),'foreignField':_0x1d572c(0x2c4),'as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x1d572c(0x24b),'product_stock':_0x1d572c(0x179)}},{'$group':{'_id':_0x1d572c(0x279),'product_stock':{'$sum':_0x1d572c(0x2aa)}}}]),_0xcb0961=await staff[_0x1d572c(0x1c2)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x633fd6[0x0][_0x1d572c(0x1b7)]==_0x1d572c(0x1fc))var _0x20f2eb=users[_0x1d572c(0x2a3)];else{if(_0x633fd6[0x0]['language']==_0x1d572c(0x195))var _0x20f2eb=users[_0x1d572c(0x195)];else{if(_0x633fd6[0x0][_0x1d572c(0x1b7)]=='German')var _0x20f2eb=users[_0x1d572c(0x1ed)];else{if(_0x633fd6[0x0][_0x1d572c(0x1b7)]=='Spanish')var _0x20f2eb=users[_0x1d572c(0x1dd)];else{if(_0x633fd6[0x0]['language']=='French')var _0x20f2eb=users['French'];else{if(_0x633fd6[0x0][_0x1d572c(0x1b7)]==_0x1d572c(0x28c))var _0x20f2eb=users[_0x1d572c(0x241)];else{if(_0x633fd6[0x0][_0x1d572c(0x1b7)]==_0x1d572c(0x2ba))var _0x20f2eb=users['Chinese'];else{if(_0x633fd6[0x0][_0x1d572c(0x1b7)]=='Arabic\x20(ae)')var _0x20f2eb=users[_0x1d572c(0x276)];}}}}}}}_0x977040[_0x1d572c(0x1ee)](_0x1d572c(0x157),{'success':_0x3308a0[_0x1d572c(0x180)](_0x1d572c(0x19c)),'errors':_0x3308a0[_0x1d572c(0x180)]('errors'),'alldata':_0x223944,'profile':_0x4132f5,'master_shop':_0x633fd6,'role':_0x2b9076,'product_stock':_0x21f0cf,'language':_0x20f2eb,'staff_arr':_0x4d5e9a,'staff_data_all':_0xcb0961});}catch(_0x4652d3){_0x977040[_0x1d572c(0x1f6)](_0x4652d3);}});async function agentsdataDSICheck_admin(_0x3fc428,_0x5c7196,_0x5bff9c,_0x45a77b){const _0x5399d2=a0_0x412553,_0x3d469c=await product['aggregate']([{'$group':{'_id':{'brand':_0x5399d2(0x227),'category':_0x5399d2(0x22e)},'products':{'$push':{'name':_0x5399d2(0x1ce),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x25da9d=[];_0x25da9d['cat_brand']=[];for(let _0x4f6ed1=0x0;_0x4f6ed1<=_0x3d469c['length']-0x1;_0x4f6ed1++){const _0x506bde=_0x3d469c[_0x4f6ed1];_0x25da9d['cat_brand'][_0x5399d2(0x190)](_0x506bde);}const _0xda0db1=await product[_0x5399d2(0x22c)]([{'$group':{'_id':{'category':_0x5399d2(0x22e)},'products':{'$push':{'brand':'$brand','product_code':_0x5399d2(0x1c1),'product_name':_0x5399d2(0x1ce)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1eb5ea=await product[_0x5399d2(0x22c)]([{'$group':{'_id':{'category':_0x5399d2(0x22e),'brand':_0x5399d2(0x227)}}},{'$group':{'_id':_0x5399d2(0x161),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x522b10=await sales_sa[_0x5399d2(0x22c)]([{'$match':{'date':{'$gte':_0x3fc428,'$lte':_0x5c7196},'sales_staff_id':_0x5bff9c,'sale_product.isFG':_0x5399d2(0x269)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x5399d2(0x269)}},{'$lookup':{'from':_0x5399d2(0x2b6),'localField':_0x5399d2(0x240),'foreignField':_0x5399d2(0x14f),'as':'product_info'}},{'$unwind':_0x5399d2(0x16c)},{'$group':{'_id':{'dsi':_0x5399d2(0x23b),'date':_0x5399d2(0x1f9),'customer':_0x5399d2(0x1a0)},'totalQty':{'$sum':_0x5399d2(0x25b)},'products':{'$push':{'qty':_0x5399d2(0x25b),'NetPrice':_0x5399d2(0x1be),'discount':_0x5399d2(0x19e),'adj_discount':_0x5399d2(0x24a),'product_details':{'prod_name':_0x5399d2(0x1a8),'product_code':_0x5399d2(0x262),'category':_0x5399d2(0x1bc),'brand':_0x5399d2(0x286),'gross_price':_0x5399d2(0x23e)}}}}},{'$unwind':_0x5399d2(0x25e)},{'$group':{'_id':{'dsi':_0x5399d2(0x20e),'date':_0x5399d2(0x251),'customer':_0x5399d2(0x1b3),'category':'$products.product_details.category','brand':_0x5399d2(0x1a4)},'totalQty':{'$sum':_0x5399d2(0x146)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x5399d2(0x1e5)]}},'NetPrice':{'$sum':_0x5399d2(0x2a8)},'discount':{'$sum':_0x5399d2(0x292)},'adj_discount':{'$sum':_0x5399d2(0x2ac)},'product_details':{'$first':_0x5399d2(0x265)}}},{'$group':{'_id':{'dsi':_0x5399d2(0x20e),'date':_0x5399d2(0x251),'customer':_0x5399d2(0x1b3)},'totalQty':{'$sum':_0x5399d2(0x1b5)},'totalGross':{'$sum':_0x5399d2(0x23d)},'NetPrice':{'$sum':_0x5399d2(0x21c)},'discount':{'$sum':_0x5399d2(0x216)},'adj_discount':{'$sum':_0x5399d2(0x248)},'products':{'$push':{'qty':_0x5399d2(0x1b5),'category':'$_id.category','brand':'$_id.brand','product_details':_0x5399d2(0x2c2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x15b48a=[],_0x4a544d={},_0x4850bd={},_0x140de9={};var _0x358723=0x0,_0x509507=0x0,_0x485947=0x0,_0x474635=0x0,_0x3ff91d=0x0;const _0x179cad=0x6;for(let _0x52dd78=0x0;_0x52dd78<=_0x522b10[_0x5399d2(0x2bf)]-0x1;_0x52dd78++){const _0x46b2b6=_0x522b10[_0x52dd78];let _0x129583=_0x5399d2(0x2c6);_0x129583+=_0x5399d2(0x1f3)+_0x46b2b6[_0x5399d2(0x275)]['dsi']+_0x5399d2(0x204),_0x129583+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x46b2b6[_0x5399d2(0x275)][_0x5399d2(0x252)]+_0x5399d2(0x204),_0x129583+=_0x5399d2(0x1f3)+_0x46b2b6['_id']['customer']+_0x5399d2(0x204);let _0x17cc10={};var _0x2e18ac=0x0;for(let _0x40cec5=0x0;_0x40cec5<=_0x46b2b6[_0x5399d2(0x2b6)][_0x5399d2(0x2bf)]-0x1;_0x40cec5++){const _0x264704=_0x46b2b6['products'][_0x40cec5];_0x17cc10[_0x264704[_0x5399d2(0x1e2)]+'-'+_0x264704[_0x5399d2(0x297)]]=_0x264704[_0x5399d2(0x178)];const _0xeb2576=_0x264704[_0x5399d2(0x1e2)]+'-'+_0x264704['category'];!_0x4a544d[_0xeb2576]&&(_0x4a544d[_0xeb2576]=0x0),!Array['isArray'](_0x140de9[_0xeb2576])&&(_0x140de9[_0xeb2576]=[]),!Array[_0x5399d2(0x277)](_0x140de9[_0xeb2576])&&(_0x140de9[_0xeb2576]=[]),_0x4a544d[_0xeb2576]+=_0x264704[_0x5399d2(0x178)],_0x140de9[_0xeb2576][_0x5399d2(0x190)](_0x264704[_0x5399d2(0x178)]),_0x2e18ac++;}console['log'](_0x46b2b6);for(let _0x5acfff=0x0;_0x5acfff<=_0x25da9d['cat_brand'][_0x5399d2(0x2bf)]-0x1;_0x5acfff++){const _0x1036a5=_0x25da9d[_0x5399d2(0x205)][_0x5acfff],_0x4ed8f7=_0x1036a5[_0x5399d2(0x275)][_0x5399d2(0x1e2)]+'-'+_0x1036a5[_0x5399d2(0x275)][_0x5399d2(0x297)];_0x129583+=_0x5399d2(0x194)+(_0x17cc10[_0x4ed8f7]!==undefined?_0x17cc10[_0x4ed8f7][_0x5399d2(0x273)](0x2):'')+_0x5399d2(0x204);}_0x485947=_0x46b2b6[_0x5399d2(0x220)]+_0x46b2b6['adj_discount'],_0x129583+=_0x5399d2(0x22f)+formatNumber(parseFloat(_0x46b2b6[_0x5399d2(0x13d)],0x2)[_0x5399d2(0x273)](0x2))+_0x5399d2(0x204),_0x129583+=_0x5399d2(0x22f)+formatNumber(_0x46b2b6[_0x5399d2(0x1c5)][_0x5399d2(0x273)](0x2))+_0x5399d2(0x204),_0x129583+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x485947)+_0x5399d2(0x204),_0x129583+=_0x5399d2(0x22f)+formatNumber(_0x46b2b6[_0x5399d2(0x22b)][_0x5399d2(0x273)](0x2))+_0x5399d2(0x204),_0x129583+='</tr>',_0x358723+=parseFloat(_0x46b2b6[_0x5399d2(0x13d)][_0x5399d2(0x273)](0x2)),_0x509507+=parseFloat(_0x46b2b6[_0x5399d2(0x22b)][_0x5399d2(0x273)](0x2)),_0x474635+=_0x485947,_0x3ff91d+=parseFloat(_0x46b2b6[_0x5399d2(0x1c5)][_0x5399d2(0x273)](0x2));if(_0x52dd78==_0x522b10[_0x5399d2(0x2bf)]-0x1){_0x129583+=_0x5399d2(0x2c6),_0x129583+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x129583+=_0x5399d2(0x204);for(let _0x34fb94=0x0;_0x34fb94<=_0x25da9d[_0x5399d2(0x205)]['length']-0x1;_0x34fb94++){const _0x16b828=_0x25da9d['cat_brand'][_0x34fb94],_0x55747f=_0x16b828[_0x5399d2(0x275)][_0x5399d2(0x1e2)]+'-'+_0x16b828[_0x5399d2(0x275)]['category'],_0xcf6e4b=_0x140de9[_0x55747f][_0x5399d2(0x1bb)]((_0x4c6378,_0x7a9dae)=>_0x4c6378+_0x7a9dae,0x0);console[_0x5399d2(0x196)](_0x5399d2(0x18f),_0x55747f),_0x129583+=_0x5399d2(0x144)+(_0xcf6e4b!==undefined?formatNumber(_0xcf6e4b[_0x5399d2(0x273)](0x2)):'')+_0x5399d2(0x2b3),console[_0x5399d2(0x196)](_0x140de9[_0x55747f][_0x5399d2(0x1bb)]((_0x56d65c,_0x4bc2f5)=>_0x56d65c+_0x4bc2f5,0x0));}_0x129583+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x358723[_0x5399d2(0x273)](0x2))+_0x5399d2(0x2b3),_0x129583+=_0x5399d2(0x18a)+formatNumber(_0x3ff91d)+'</b></td>',_0x129583+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x474635)+_0x5399d2(0x2b3),_0x129583+=_0x5399d2(0x18a)+formatNumber(_0x509507)+_0x5399d2(0x2b3),_0x129583+=_0x5399d2(0x1b9);}_0x15b48a[_0x5399d2(0x190)](_0x129583);}function _0x3c2915(_0x5f1017,_0x54a78f){const _0x2165aa=[];for(let _0x43ae78=0x0;_0x43ae78<=_0x5f1017['length']-0x1;_0x43ae78+=_0x54a78f){_0x2165aa['push'](_0x5f1017['slice'](_0x43ae78,_0x43ae78+_0x54a78f));}return _0x2165aa;}const _0x3903ea=_0x3c2915(_0x15b48a,_0x179cad);let _0x1a8571='';return _0x3903ea[_0x5399d2(0x1cb)]((_0x47940f,_0x355cc3)=>{const _0x175d44=_0x5399d2;_0x355cc3>0x0&&(_0x1a8571+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x1a8571+='<table>',_0x1a8571+='<thead>',_0x1a8571+=_0x175d44(0x2c6),_0x1a8571+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x1a8571+=_0x175d44(0x1b9),_0x1a8571+=_0x175d44(0x2c6),_0x1a8571+=_0x175d44(0x2cb);for(let _0x3c404a=0x0;_0x3c404a<=_0xda0db1[_0x175d44(0x2bf)]-0x1;_0x3c404a++){const _0x5b8388=_0xda0db1[_0x3c404a];for(let _0x1386d8=0x0;_0x1386d8<_0x1eb5ea[_0x175d44(0x2bf)];_0x1386d8++){const _0x1ab37c=_0x1eb5ea[_0x1386d8];_0x1ab37c[_0x175d44(0x275)]===_0x5b8388[_0x175d44(0x275)][_0x175d44(0x297)]&&(_0x1a8571+='<td\x20colspan=\x22'+_0x1ab37c[_0x175d44(0x1bf)]+_0x175d44(0x232)+_0x5b8388[_0x175d44(0x275)][_0x175d44(0x297)]+_0x175d44(0x204));}}_0x1a8571+=_0x175d44(0x1ba),_0x1a8571+=_0x175d44(0x1b9),_0x1a8571+='<tr>',_0x1a8571+=_0x175d44(0x17d),_0x1a8571+=_0x175d44(0x1eb),_0x1a8571+=_0x175d44(0x268);for(let _0xf40f35=0x0;_0xf40f35<=_0xda0db1[_0x175d44(0x2bf)]-0x1;_0xf40f35++){const _0x23ff97=_0xda0db1[_0xf40f35];for(let _0x24e661=0x0;_0x24e661<_0x25da9d[_0x175d44(0x205)][_0x175d44(0x2bf)];_0x24e661++){const _0x465594=_0x25da9d['cat_brand'][_0x24e661];_0x465594[_0x175d44(0x275)][_0x175d44(0x297)]===_0x23ff97[_0x175d44(0x275)][_0x175d44(0x297)]&&(_0x1a8571+='<td\x20class=\x22cat_data\x22>'+_0x465594[_0x175d44(0x275)]['brand']+_0x175d44(0x204));}}_0x1a8571+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x1a8571+=_0x175d44(0x26d),_0x1a8571+=_0x175d44(0x27d),_0x1a8571+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x1a8571+=_0x175d44(0x1b9),_0x1a8571+=_0x175d44(0x142),_0x1a8571+=_0x175d44(0x1d2),_0x47940f[_0x175d44(0x1cb)](_0x338744=>{_0x1a8571+=_0x338744;}),console[_0x175d44(0x196)](_0x140de9),_0x1a8571+=_0x175d44(0x1ab),_0x1a8571+=_0x175d44(0x28f);}),_0x1a8571;}async function agentsdataDSICheck_admin_excel(_0x1ccb2d,_0x1a9462,_0x2650c3,_0x337f8b){const _0x51dbdb=a0_0x412553,_0x28ed27=await product[_0x51dbdb(0x22c)]([{'$group':{'_id':{'brand':_0x51dbdb(0x227),'category':_0x51dbdb(0x22e)},'products':{'$push':{'name':_0x51dbdb(0x1ce),'product_code':_0x51dbdb(0x1c1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x49b056=[];_0x49b056[_0x51dbdb(0x205)]=[];for(let _0x173a95=0x0;_0x173a95<=_0x28ed27[_0x51dbdb(0x2bf)]-0x1;_0x173a95++){const _0x57a336=_0x28ed27[_0x173a95];_0x49b056[_0x51dbdb(0x205)][_0x51dbdb(0x190)](_0x57a336);}const _0x501d02=await product[_0x51dbdb(0x22c)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x51dbdb(0x227),'product_code':_0x51dbdb(0x1c1),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1cdaff=await product[_0x51dbdb(0x22c)]([{'$group':{'_id':{'category':_0x51dbdb(0x22e),'brand':_0x51dbdb(0x227)}}},{'$group':{'_id':_0x51dbdb(0x161),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4bdd75=await sales_sa[_0x51dbdb(0x22c)]([{'$match':{'date':{'$gte':_0x1ccb2d,'$lte':_0x1a9462},'sales_staff_id':_0x2650c3,'sale_product.isFG':_0x51dbdb(0x269)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x51dbdb(0x269)}},{'$lookup':{'from':_0x51dbdb(0x2b6),'localField':_0x51dbdb(0x240),'foreignField':_0x51dbdb(0x14f),'as':_0x51dbdb(0x1e6)}},{'$unwind':_0x51dbdb(0x16c)},{'$group':{'_id':{'dsi':'$dsi','date':_0x51dbdb(0x1f9),'customer':_0x51dbdb(0x1a0)},'totalQty':{'$sum':_0x51dbdb(0x25b)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x51dbdb(0x19e),'adj_discount':_0x51dbdb(0x24a),'product_details':{'prod_name':_0x51dbdb(0x1a8),'product_code':_0x51dbdb(0x262),'category':'$product_info.category','brand':_0x51dbdb(0x286),'gross_price':_0x51dbdb(0x23e)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x51dbdb(0x20e),'date':_0x51dbdb(0x251),'customer':'$_id.customer','category':_0x51dbdb(0x25f),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x51dbdb(0x146)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x51dbdb(0x1e5)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x51dbdb(0x292)},'adj_discount':{'$sum':_0x51dbdb(0x2ac)},'product_details':{'$first':_0x51dbdb(0x265)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x51dbdb(0x251),'customer':_0x51dbdb(0x1b3)},'totalQty':{'$sum':_0x51dbdb(0x1b5)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x51dbdb(0x21c)},'discount':{'$sum':_0x51dbdb(0x216)},'adj_discount':{'$sum':_0x51dbdb(0x248)},'products':{'$push':{'qty':'$totalQty','category':_0x51dbdb(0x161),'brand':_0x51dbdb(0x1b8),'product_details':_0x51dbdb(0x2c2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4c64f4=[],_0x5a6bc7={},_0x234574={},_0x2314a6={};var _0x23776e=0x0,_0x44c61d=0x0,_0x297663=0x0,_0x24a568=0x0,_0x30cfb8=0x0;const _0x42b21c=0x16345785d8a0000;for(let _0x2a7c48=0x0;_0x2a7c48<=_0x4bdd75[_0x51dbdb(0x2bf)]-0x1;_0x2a7c48++){const _0x47e840=_0x4bdd75[_0x2a7c48];let _0x169992=_0x51dbdb(0x2c6);_0x169992+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x47e840[_0x51dbdb(0x275)][_0x51dbdb(0x212)]+_0x51dbdb(0x204),_0x169992+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x47e840['_id'][_0x51dbdb(0x252)]+'</td>',_0x169992+=_0x51dbdb(0x1f3)+_0x47e840[_0x51dbdb(0x275)][_0x51dbdb(0x1ec)]+'</td>';let _0x15fc9b={};var _0x19e6f4=0x0;for(let _0x40e11b=0x0;_0x40e11b<=_0x47e840[_0x51dbdb(0x2b6)][_0x51dbdb(0x2bf)]-0x1;_0x40e11b++){const _0x4e5e99=_0x47e840[_0x51dbdb(0x2b6)][_0x40e11b];_0x15fc9b[_0x4e5e99['brand']+'-'+_0x4e5e99['category']]=_0x4e5e99[_0x51dbdb(0x178)];const _0x43b338=_0x4e5e99[_0x51dbdb(0x1e2)]+'-'+_0x4e5e99['category'];!_0x5a6bc7[_0x43b338]&&(_0x5a6bc7[_0x43b338]=0x0),!Array[_0x51dbdb(0x277)](_0x2314a6[_0x43b338])&&(_0x2314a6[_0x43b338]=[]),!Array['isArray'](_0x2314a6[_0x43b338])&&(_0x2314a6[_0x43b338]=[]),_0x5a6bc7[_0x43b338]+=_0x4e5e99[_0x51dbdb(0x178)],_0x2314a6[_0x43b338][_0x51dbdb(0x190)](_0x4e5e99[_0x51dbdb(0x178)]),_0x19e6f4++;}console[_0x51dbdb(0x196)](_0x47e840);for(let _0x3510e6=0x0;_0x3510e6<=_0x49b056[_0x51dbdb(0x205)]['length']-0x1;_0x3510e6++){const _0x557e7b=_0x49b056[_0x51dbdb(0x205)][_0x3510e6],_0x452524=_0x557e7b[_0x51dbdb(0x275)]['brand']+'-'+_0x557e7b['_id'][_0x51dbdb(0x297)];_0x169992+=_0x51dbdb(0x194)+(_0x15fc9b[_0x452524]!==undefined?_0x15fc9b[_0x452524][_0x51dbdb(0x273)](0x2):'')+'</td>';}_0x297663=_0x47e840[_0x51dbdb(0x220)]+_0x47e840[_0x51dbdb(0x160)],_0x169992+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x47e840[_0x51dbdb(0x13d)],0x2)['toFixed'](0x2))+_0x51dbdb(0x204),_0x169992+=_0x51dbdb(0x22f)+formatNumber(_0x47e840[_0x51dbdb(0x1c5)]['toFixed'](0x2))+_0x51dbdb(0x204),_0x169992+=_0x51dbdb(0x22f)+formatNumber(_0x297663)+_0x51dbdb(0x204),_0x169992+=_0x51dbdb(0x22f)+formatNumber(_0x47e840['NetPrice'][_0x51dbdb(0x273)](0x2))+_0x51dbdb(0x204),_0x169992+='</tr>',_0x23776e+=parseFloat(_0x47e840[_0x51dbdb(0x13d)]['toFixed'](0x2)),_0x44c61d+=parseFloat(_0x47e840['NetPrice'][_0x51dbdb(0x273)](0x2)),_0x24a568+=_0x297663,_0x30cfb8+=parseFloat(_0x47e840[_0x51dbdb(0x1c5)]['toFixed'](0x2));if(_0x2a7c48==_0x4bdd75[_0x51dbdb(0x2bf)]-0x1){_0x169992+=_0x51dbdb(0x2c6),_0x169992+=_0x51dbdb(0x1a5),_0x169992+=_0x51dbdb(0x204);for(let _0x1b7a97=0x0;_0x1b7a97<=_0x49b056['cat_brand'][_0x51dbdb(0x2bf)]-0x1;_0x1b7a97++){const _0x1d2a24=_0x49b056[_0x51dbdb(0x205)][_0x1b7a97],_0x1a3d26=_0x1d2a24[_0x51dbdb(0x275)]['brand']+'-'+_0x1d2a24[_0x51dbdb(0x275)]['category'],_0x8169be=_0x2314a6[_0x1a3d26][_0x51dbdb(0x1bb)]((_0x1119ea,_0x358729)=>_0x1119ea+_0x358729,0x0);console[_0x51dbdb(0x196)](_0x51dbdb(0x18f),_0x1a3d26),_0x169992+=_0x51dbdb(0x144)+(_0x8169be!==undefined?formatNumber(_0x8169be[_0x51dbdb(0x273)](0x2)):'')+'</b></td>',console[_0x51dbdb(0x196)](_0x2314a6[_0x1a3d26][_0x51dbdb(0x1bb)]((_0x45e7b5,_0x130c9f)=>_0x45e7b5+_0x130c9f,0x0));}_0x169992+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x23776e[_0x51dbdb(0x273)](0x2))+_0x51dbdb(0x2b3),_0x169992+=_0x51dbdb(0x18a)+formatNumber(_0x30cfb8)+'</b></td>',_0x169992+=_0x51dbdb(0x18a)+formatNumber(_0x24a568)+_0x51dbdb(0x2b3),_0x169992+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x44c61d)+_0x51dbdb(0x2b3),_0x169992+=_0x51dbdb(0x1b9);}_0x4c64f4[_0x51dbdb(0x190)](_0x169992);}function _0x3e8e65(_0x2c66fe,_0x44353b){const _0x1af18f=_0x51dbdb,_0x3dd2ac=[];for(let _0x2d60ac=0x0;_0x2d60ac<=_0x2c66fe['length']-0x1;_0x2d60ac+=_0x44353b){_0x3dd2ac[_0x1af18f(0x190)](_0x2c66fe['slice'](_0x2d60ac,_0x2d60ac+_0x44353b));}return _0x3dd2ac;}const _0x2a43d7=_0x3e8e65(_0x4c64f4,_0x42b21c);let _0xbcfd1e='';return _0x2a43d7[_0x51dbdb(0x1cb)]((_0x48bac6,_0x312417)=>{const _0x177d12=_0x51dbdb;_0x312417>0x0&&(_0xbcfd1e+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0xbcfd1e+=_0x177d12(0x184),_0xbcfd1e+=_0x177d12(0x1f0),_0xbcfd1e+=_0x177d12(0x2c6),_0xbcfd1e+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0xbcfd1e+='</tr>',_0xbcfd1e+=_0x177d12(0x2c6),_0xbcfd1e+=_0x177d12(0x2cb);for(let _0x353925=0x0;_0x353925<=_0x501d02[_0x177d12(0x2bf)]-0x1;_0x353925++){const _0xec4b3c=_0x501d02[_0x353925];for(let _0x5a4393=0x0;_0x5a4393<_0x1cdaff['length'];_0x5a4393++){const _0x1fbe67=_0x1cdaff[_0x5a4393];_0x1fbe67['_id']===_0xec4b3c[_0x177d12(0x275)]['category']&&(_0xbcfd1e+=_0x177d12(0x1f5)+_0x1fbe67[_0x177d12(0x1bf)]+_0x177d12(0x232)+_0xec4b3c[_0x177d12(0x275)][_0x177d12(0x297)]+'</td>');}}_0xbcfd1e+=_0x177d12(0x1ba),_0xbcfd1e+=_0x177d12(0x1b9),_0xbcfd1e+=_0x177d12(0x2c6),_0xbcfd1e+=_0x177d12(0x17d),_0xbcfd1e+=_0x177d12(0x1eb),_0xbcfd1e+=_0x177d12(0x268);for(let _0x56ae4e=0x0;_0x56ae4e<=_0x501d02[_0x177d12(0x2bf)]-0x1;_0x56ae4e++){const _0x2ef809=_0x501d02[_0x56ae4e];for(let _0x484f43=0x0;_0x484f43<_0x49b056[_0x177d12(0x205)]['length'];_0x484f43++){const _0x118534=_0x49b056[_0x177d12(0x205)][_0x484f43];_0x118534[_0x177d12(0x275)][_0x177d12(0x297)]===_0x2ef809[_0x177d12(0x275)][_0x177d12(0x297)]&&(_0xbcfd1e+=_0x177d12(0x24c)+_0x118534[_0x177d12(0x275)][_0x177d12(0x1e2)]+_0x177d12(0x204));}}_0xbcfd1e+=_0x177d12(0x14a),_0xbcfd1e+=_0x177d12(0x26d),_0xbcfd1e+=_0x177d12(0x27d),_0xbcfd1e+=_0x177d12(0x162),_0xbcfd1e+='</tr>',_0xbcfd1e+=_0x177d12(0x142),_0xbcfd1e+='<tbody>',_0x48bac6[_0x177d12(0x1cb)](_0x2c574c=>{_0xbcfd1e+=_0x2c574c;}),console[_0x177d12(0x196)](_0x2314a6),_0xbcfd1e+='</tbody>',_0xbcfd1e+=_0x177d12(0x28f);}),_0xbcfd1e;}router[a0_0x412553(0x233)](a0_0x412553(0x176),auth,async(_0x17ebf4,_0x192bab)=>{const _0x22affc=a0_0x412553,{from_date:_0x2b63ef,to_date:_0xfed0c6,isExcel:_0x365993,agent_id:_0x571d9a}=_0x17ebf4[_0x22affc(0x19d)],_0xa013d1=_0x17ebf4[_0x22affc(0x203)],_0x325cf8=await staff[_0x22affc(0x1b0)]({'email':_0xa013d1[_0x22affc(0x29a)]}),_0x5645ae=await master_shop[_0x22affc(0x1c2)](),_0x14a3e8=await agentsdataDSICheck_admin(_0x2b63ef,_0xfed0c6,_0x571d9a,_0x365993),_0x5445fa=await agentsdataDSICheck_admin_excel(_0x2b63ef,_0xfed0c6,_0x571d9a,_0x365993);let _0x2bed7d='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x559585=new Date(_0x2b63ef),_0x23949b=new Date(_0xfed0c6);const _0x3d2859={'year':_0x22affc(0x278),'month':'long','day':'numeric'},_0x39db53=new Intl[(_0x22affc(0x1d7))](_0x22affc(0x1de),_0x3d2859)[_0x22affc(0x19b)](_0x559585),_0x41aa37=new Intl[(_0x22affc(0x1d7))]('en-US',_0x3d2859)[_0x22affc(0x19b)](_0x23949b);_0x2bed7d+='<div\x20class=\x22row\x22>',_0x2bed7d+=_0x22affc(0x192),_0x2bed7d+=_0x22affc(0x184),_0x2bed7d+=_0x14a3e8,_0x2bed7d+=_0x22affc(0x28f),_0x2bed7d+=_0x22affc(0x2b8),_0x2bed7d+=_0x22affc(0x2b8);let _0x5c5f96=_0x22affc(0x219);_0x5c5f96+=_0x22affc(0x21b),_0x5c5f96+='<div\x20\x20id=\x22table-conatainer\x22>',_0x5c5f96+='<table>',_0x5c5f96+=_0x5445fa,_0x5c5f96+=_0x22affc(0x28f),_0x5c5f96+=_0x22affc(0x2b8),_0x5c5f96+=_0x22affc(0x2b8);let _0x4d019e=_0x22affc(0x236);const _0x4bdce7={'width':_0x22affc(0x2ad),'height':_0x22affc(0x2c3),'orientation':_0x22affc(0x207),'border':{'top':_0x22affc(0x210),'right':'0.1in','bottom':_0x22affc(0x210),'left':_0x22affc(0x210)},'header':{'height':'60mm','contents':_0x22affc(0x230)+_0x4d019e+_0x22affc(0x19f)+_0x39db53+'\x20-\x20'+_0x41aa37+_0x22affc(0x1c9)},'footer':{'height':_0x22affc(0x2bc),'contents':{'default':_0x22affc(0x153)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x22affc(0x17b)}}};if(_0x365993=='on'){const _0x2d7656=cheerio[_0x22affc(0x25a)](_0x5c5f96);let _0x1c9b0e=[],_0x1259c6=[],_0x1640bc=[];_0x2d7656(_0x22affc(0x193))[_0x22affc(0x214)]((_0x315d0c,_0x237b40)=>{const _0x7247d8=_0x22affc;let _0x1f872f=[],_0x3b503e=0x0;while(_0x1640bc[_0x3b503e]){_0x1640bc[_0x3b503e]--,_0x3b503e++;}_0x2d7656(_0x237b40)['find'](_0x7247d8(0x23f))[_0x7247d8(0x214)]((_0x41d3cd,_0x39a140)=>{const _0x50122d=_0x7247d8;let _0x1cf331=_0x2d7656(_0x39a140)['text']()[_0x50122d(0x221)](),_0x2f1e21=parseFloat(_0x1cf331[_0x50122d(0x289)](/,/g,''));isNaN(_0x2f1e21)&&(_0x2f1e21=_0x1cf331);let _0x5f2017=parseInt(_0x2d7656(_0x39a140)[_0x50122d(0x2a0)](_0x50122d(0x20b)))||0x1,_0x577923=parseInt(_0x2d7656(_0x39a140)[_0x50122d(0x2a0)](_0x50122d(0x165)))||0x1;_0x1f872f[_0x3b503e]=_0x2f1e21;(_0x5f2017>0x1||_0x577923>0x1)&&_0x1259c6[_0x50122d(0x190)]({'s':{'r':_0x315d0c,'c':_0x3b503e},'e':{'r':_0x315d0c+_0x577923-0x1,'c':_0x3b503e+_0x5f2017-0x1}});for(let _0x48af6f=0x0;_0x48af6f<_0x5f2017;_0x48af6f++){_0x577923>0x1&&(_0x1640bc[_0x3b503e+_0x48af6f]=_0x577923-0x1);}_0x3b503e+=_0x5f2017;}),_0x1c9b0e['push'](_0x1f872f);});const _0x531daa=XLSX[_0x22affc(0x238)][_0x22affc(0x1e1)](),_0x2be540=XLSX['utils'][_0x22affc(0x256)](_0x1c9b0e);_0x1259c6[_0x22affc(0x2bf)]>0x0&&(_0x2be540[_0x22affc(0x21d)]=_0x1259c6);_0x2be540[_0x22affc(0x28e)]=_0x1c9b0e[0x0][_0x22affc(0x2bd)](()=>({'wpx':0x64})),XLSX[_0x22affc(0x238)][_0x22affc(0x18d)](_0x531daa,_0x2be540,_0x22affc(0x1d4));const _0x4e0266=XLSX[_0x22affc(0x1f7)](_0x531daa,{'bookType':'xlsx','type':_0x22affc(0x1bd)});_0x192bab[_0x22affc(0x1cf)]('Content-Disposition',_0x22affc(0x14b)),_0x192bab['setHeader'](_0x22affc(0x2b1),_0x22affc(0x1e0)),_0x192bab['send'](_0x4e0266);}else pdf['create'](_0x2bed7d,_0x4bdce7)[_0x22affc(0x257)](function(_0x2071a7,_0xafa291){const _0x3f6633=_0x22affc;if(_0x2071a7){_0x192bab[_0x3f6633(0x254)](0x1f4)[_0x3f6633(0x2a1)](_0x3f6633(0x29e));return;}_0x192bab[_0x3f6633(0x1cf)](_0x3f6633(0x2b1),_0x3f6633(0x295)),_0xafa291[_0x3f6633(0x274)](_0x192bab);});}),router['get'](a0_0x412553(0x1a9),auth,async(_0x34a3c9,_0x35c2c0)=>{const _0x212466=a0_0x412553;try{const {username:_0x55cfbc,email:_0x5e53bf,role:_0x5a11ac}=_0x34a3c9[_0x212466(0x203)],_0x13d2b3=_0x34a3c9['user'],_0x25d71f=await profile[_0x212466(0x1b0)]({'email':_0x13d2b3[_0x212466(0x29a)]}),_0xf22a57={'year':_0x212466(0x278),'month':_0x212466(0x213),'day':_0x212466(0x278)},_0x2c992b=await master_shop[_0x212466(0x1c2)](),_0x5d05b9=await staff[_0x212466(0x1b0)]({'email':_0x13d2b3['email']}),_0x57d95b=await product['find'](),_0x1a3563=await warehouse['aggregate']([{'$unwind':_0x212466(0x2c2)},{'$lookup':{'from':_0x212466(0x2b6),'localField':_0x212466(0x2a6),'foreignField':_0x212466(0x2c4),'as':_0x212466(0x145)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x212466(0x24b),'product_stock':_0x212466(0x179)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x212466(0x2aa)}}}]);if(_0x2c992b[0x0]['language']==_0x212466(0x1fc))var _0x1234d8=users[_0x212466(0x2a3)];else{if(_0x2c992b[0x0][_0x212466(0x1b7)]==_0x212466(0x195))var _0x1234d8=users[_0x212466(0x195)];else{if(_0x2c992b[0x0][_0x212466(0x1b7)]=='German')var _0x1234d8=users[_0x212466(0x1ed)];else{if(_0x2c992b[0x0][_0x212466(0x1b7)]==_0x212466(0x1dd))var _0x1234d8=users[_0x212466(0x1dd)];else{if(_0x2c992b[0x0][_0x212466(0x1b7)]=='French')var _0x1234d8=users['French'];else{if(_0x2c992b[0x0]['language']==_0x212466(0x28c))var _0x1234d8=users[_0x212466(0x241)];else{if(_0x2c992b[0x0][_0x212466(0x1b7)]==_0x212466(0x2ba))var _0x1234d8=users[_0x212466(0x2ba)];else{if(_0x2c992b[0x0][_0x212466(0x1b7)]==_0x212466(0x247))var _0x1234d8=users[_0x212466(0x276)];}}}}}}}_0x35c2c0[_0x212466(0x1ee)](_0x212466(0x1e4),{'success':_0x34a3c9['flash'](_0x212466(0x19c)),'errors':_0x34a3c9['flash'](_0x212466(0x20f)),'alldata':_0x57d95b,'profile':_0x25d71f,'master_shop':_0x2c992b,'role':_0x13d2b3,'product_stock':_0x1a3563,'language':_0x1234d8,'staff_arr':_0x5d05b9});}catch(_0x598229){}});function formatNumber(_0x5a0210,_0x464318=a0_0x412553(0x1de),_0x11d85a={'minimumFractionDigits':0x2}){const _0x1dccc5=a0_0x412553,_0x26860c=new Intl['NumberFormat'](_0x464318,_0x11d85a);return _0x26860c[_0x1dccc5(0x19b)](_0x5a0210);}async function agentsdataDSICheck(_0x2069e7,_0x200956,_0x529e8d,_0x5431c0){const _0x4be8bb=a0_0x412553,_0x2596d6=await product[_0x4be8bb(0x22c)]([{'$group':{'_id':{'brand':'$brand','category':_0x4be8bb(0x22e)},'products':{'$push':{'name':_0x4be8bb(0x1ce),'product_code':_0x4be8bb(0x1c1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xd071b0=[];_0xd071b0['cat_brand']=[];for(let _0x11fe0f=0x0;_0x11fe0f<=_0x2596d6[_0x4be8bb(0x2bf)]-0x1;_0x11fe0f++){const _0x1dc681=_0x2596d6[_0x11fe0f];_0xd071b0['cat_brand']['push'](_0x1dc681);}const _0x78341a=await product[_0x4be8bb(0x22c)]([{'$group':{'_id':{'category':_0x4be8bb(0x22e)},'products':{'$push':{'brand':_0x4be8bb(0x227),'product_code':_0x4be8bb(0x1c1),'product_name':_0x4be8bb(0x1ce)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4c96f0=await product[_0x4be8bb(0x22c)]([{'$group':{'_id':{'category':_0x4be8bb(0x22e),'brand':_0x4be8bb(0x227)}}},{'$group':{'_id':_0x4be8bb(0x161),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2c1b75=await sales_sa[_0x4be8bb(0x22c)]([{'$match':{'date':{'$gte':_0x2069e7,'$lte':_0x200956},'sales_staff_id':_0x529e8d,'sale_product.isFG':'false'}},{'$unwind':_0x4be8bb(0x29b)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x4be8bb(0x2b6),'localField':'sale_product.product_code','foreignField':_0x4be8bb(0x14f),'as':_0x4be8bb(0x1e6)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x4be8bb(0x23b),'date':'$date','customer':_0x4be8bb(0x1a0)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x4be8bb(0x1be),'discount':'$sale_product.discount','adj_discount':_0x4be8bb(0x24a),'product_details':{'prod_name':_0x4be8bb(0x1a8),'product_code':_0x4be8bb(0x262),'category':_0x4be8bb(0x1bc),'brand':'$product_info.brand','gross_price':_0x4be8bb(0x23e)}}}}},{'$unwind':_0x4be8bb(0x25e)},{'$group':{'_id':{'dsi':_0x4be8bb(0x20e),'date':_0x4be8bb(0x251),'customer':_0x4be8bb(0x1b3),'category':_0x4be8bb(0x25f),'brand':_0x4be8bb(0x1a4)},'totalQty':{'$sum':_0x4be8bb(0x146)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x4be8bb(0x1e5)]}},'NetPrice':{'$sum':_0x4be8bb(0x2a8)},'discount':{'$sum':_0x4be8bb(0x292)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x4be8bb(0x265)}}},{'$group':{'_id':{'dsi':_0x4be8bb(0x20e),'date':_0x4be8bb(0x251),'customer':'$_id.customer'},'totalQty':{'$sum':_0x4be8bb(0x1b5)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x4be8bb(0x21c)},'discount':{'$sum':_0x4be8bb(0x216)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':_0x4be8bb(0x161),'brand':_0x4be8bb(0x1b8),'product_details':_0x4be8bb(0x2c2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x534815=[],_0x379f0f={},_0x42aefd={},_0x47434d={};var _0x199e78=0x0,_0x476496=0x0,_0x10e89e=0x0,_0x44577f=0x0,_0x277cbb=0x0;const _0x4ff434=0x6;for(let _0x405d48=0x0;_0x405d48<=_0x2c1b75[_0x4be8bb(0x2bf)]-0x1;_0x405d48++){const _0x2aff6a=_0x2c1b75[_0x405d48];let _0x136b20='<tr>';_0x136b20+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2aff6a[_0x4be8bb(0x275)][_0x4be8bb(0x212)]+_0x4be8bb(0x204),_0x136b20+=_0x4be8bb(0x1f3)+_0x2aff6a['_id']['date']+'</td>',_0x136b20+=_0x4be8bb(0x1f3)+_0x2aff6a[_0x4be8bb(0x275)][_0x4be8bb(0x1ec)]+_0x4be8bb(0x204);let _0x3b8ecf={};var _0x9c1bf9=0x0;for(let _0x165c06=0x0;_0x165c06<=_0x2aff6a[_0x4be8bb(0x2b6)][_0x4be8bb(0x2bf)]-0x1;_0x165c06++){const _0x48ca7c=_0x2aff6a[_0x4be8bb(0x2b6)][_0x165c06];_0x3b8ecf[_0x48ca7c['brand']+'-'+_0x48ca7c[_0x4be8bb(0x297)]]=_0x48ca7c[_0x4be8bb(0x178)];const _0x31e711=_0x48ca7c[_0x4be8bb(0x1e2)]+'-'+_0x48ca7c[_0x4be8bb(0x297)];!_0x379f0f[_0x31e711]&&(_0x379f0f[_0x31e711]=0x0),!Array[_0x4be8bb(0x277)](_0x47434d[_0x31e711])&&(_0x47434d[_0x31e711]=[]),!Array[_0x4be8bb(0x277)](_0x47434d[_0x31e711])&&(_0x47434d[_0x31e711]=[]),_0x379f0f[_0x31e711]+=_0x48ca7c[_0x4be8bb(0x178)],_0x47434d[_0x31e711][_0x4be8bb(0x190)](_0x48ca7c['qty']),_0x9c1bf9++;}console[_0x4be8bb(0x196)](_0x2aff6a);for(let _0x106bed=0x0;_0x106bed<=_0xd071b0[_0x4be8bb(0x205)]['length']-0x1;_0x106bed++){const _0x18dce8=_0xd071b0[_0x4be8bb(0x205)][_0x106bed],_0x22f50e=_0x18dce8['_id'][_0x4be8bb(0x1e2)]+'-'+_0x18dce8[_0x4be8bb(0x275)][_0x4be8bb(0x297)];_0x136b20+=_0x4be8bb(0x194)+(_0x3b8ecf[_0x22f50e]!==undefined?_0x3b8ecf[_0x22f50e][_0x4be8bb(0x273)](0x2):'')+_0x4be8bb(0x204);}_0x10e89e=_0x2aff6a['discount']+_0x2aff6a[_0x4be8bb(0x160)],_0x136b20+=_0x4be8bb(0x22f)+formatNumber(parseFloat(_0x2aff6a[_0x4be8bb(0x13d)],0x2)[_0x4be8bb(0x273)](0x2))+'</td>',_0x136b20+=_0x4be8bb(0x22f)+formatNumber(_0x2aff6a[_0x4be8bb(0x1c5)][_0x4be8bb(0x273)](0x2))+_0x4be8bb(0x204),_0x136b20+=_0x4be8bb(0x22f)+formatNumber(_0x10e89e)+'</td>',_0x136b20+=_0x4be8bb(0x22f)+formatNumber(_0x2aff6a[_0x4be8bb(0x22b)][_0x4be8bb(0x273)](0x2))+_0x4be8bb(0x204),_0x136b20+=_0x4be8bb(0x1b9),_0x199e78+=parseFloat(_0x2aff6a[_0x4be8bb(0x13d)][_0x4be8bb(0x273)](0x2)),_0x476496+=parseFloat(_0x2aff6a[_0x4be8bb(0x22b)][_0x4be8bb(0x273)](0x2)),_0x44577f+=_0x10e89e,_0x277cbb+=parseFloat(_0x2aff6a['totalGross']['toFixed'](0x2));if(_0x405d48==_0x2c1b75[_0x4be8bb(0x2bf)]-0x1){_0x136b20+='<tr>',_0x136b20+=_0x4be8bb(0x1a5),_0x136b20+='</td>';for(let _0x3cb1cb=0x0;_0x3cb1cb<=_0xd071b0[_0x4be8bb(0x205)][_0x4be8bb(0x2bf)]-0x1;_0x3cb1cb++){const _0x2862d3=_0xd071b0[_0x4be8bb(0x205)][_0x3cb1cb],_0x34d626=_0x2862d3[_0x4be8bb(0x275)][_0x4be8bb(0x1e2)]+'-'+_0x2862d3[_0x4be8bb(0x275)][_0x4be8bb(0x297)],_0x842be5=_0x47434d[_0x34d626][_0x4be8bb(0x1bb)]((_0x1d7db1,_0x592b54)=>_0x1d7db1+_0x592b54,0x0);_0x136b20+=_0x4be8bb(0x144)+(_0x842be5!==undefined?formatNumber(_0x842be5[_0x4be8bb(0x273)](0x2)):'')+_0x4be8bb(0x2b3),console['log'](_0x47434d[_0x34d626][_0x4be8bb(0x1bb)]((_0x1267e6,_0x5f36fd)=>_0x1267e6+_0x5f36fd,0x0));}_0x136b20+=_0x4be8bb(0x18a)+formatNumber(_0x199e78[_0x4be8bb(0x273)](0x2))+_0x4be8bb(0x2b3),_0x136b20+=_0x4be8bb(0x18a)+formatNumber(_0x277cbb)+_0x4be8bb(0x2b3),_0x136b20+=_0x4be8bb(0x18a)+formatNumber(_0x44577f)+_0x4be8bb(0x2b3),_0x136b20+=_0x4be8bb(0x18a)+formatNumber(_0x476496)+_0x4be8bb(0x2b3),_0x136b20+=_0x4be8bb(0x1b9);}_0x534815[_0x4be8bb(0x190)](_0x136b20);}function _0x1ff05a(_0x106f75,_0x478caa){const _0xb1ac31=_0x4be8bb,_0x1cfa23=[];for(let _0x1fe5ed=0x0;_0x1fe5ed<=_0x106f75['length']-0x1;_0x1fe5ed+=_0x478caa){_0x1cfa23[_0xb1ac31(0x190)](_0x106f75['slice'](_0x1fe5ed,_0x1fe5ed+_0x478caa));}return _0x1cfa23;}const _0x1696fd=_0x1ff05a(_0x534815,_0x4ff434);let _0xbc168f='';return _0x1696fd[_0x4be8bb(0x1cb)]((_0x5783c9,_0x1b1421)=>{const _0x52f75f=_0x4be8bb;_0x1b1421>0x0&&(_0xbc168f+=_0x52f75f(0x19a));_0xbc168f+=_0x52f75f(0x184),_0xbc168f+=_0x52f75f(0x1f0),_0xbc168f+='<tr>',_0xbc168f+=_0x52f75f(0x177),_0xbc168f+=_0x52f75f(0x1b9),_0xbc168f+=_0x52f75f(0x2c6),_0xbc168f+=_0x52f75f(0x2cb);for(let _0x41c2f2=0x0;_0x41c2f2<=_0x78341a['length']-0x1;_0x41c2f2++){const _0x55b583=_0x78341a[_0x41c2f2];for(let _0xde1ea6=0x0;_0xde1ea6<_0x4c96f0['length'];_0xde1ea6++){const _0x41764a=_0x4c96f0[_0xde1ea6];_0x41764a[_0x52f75f(0x275)]===_0x55b583[_0x52f75f(0x275)]['category']&&(_0xbc168f+='<td\x20colspan=\x22'+_0x41764a[_0x52f75f(0x1bf)]+_0x52f75f(0x232)+_0x55b583[_0x52f75f(0x275)][_0x52f75f(0x297)]+_0x52f75f(0x204));}}_0xbc168f+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0xbc168f+=_0x52f75f(0x1b9),_0xbc168f+='<tr>',_0xbc168f+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0xbc168f+=_0x52f75f(0x1eb),_0xbc168f+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x3ddb9a=0x0;_0x3ddb9a<=_0x78341a[_0x52f75f(0x2bf)]-0x1;_0x3ddb9a++){const _0x3e74d3=_0x78341a[_0x3ddb9a];for(let _0x204685=0x0;_0x204685<_0xd071b0[_0x52f75f(0x205)]['length'];_0x204685++){const _0x1645b9=_0xd071b0[_0x52f75f(0x205)][_0x204685];_0x1645b9['_id'][_0x52f75f(0x297)]===_0x3e74d3[_0x52f75f(0x275)]['category']&&(_0xbc168f+=_0x52f75f(0x24c)+_0x1645b9[_0x52f75f(0x275)][_0x52f75f(0x1e2)]+_0x52f75f(0x204));}}_0xbc168f+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0xbc168f+=_0x52f75f(0x26d),_0xbc168f+=_0x52f75f(0x27d),_0xbc168f+=_0x52f75f(0x162),_0xbc168f+=_0x52f75f(0x1b9),_0xbc168f+=_0x52f75f(0x142),_0xbc168f+=_0x52f75f(0x1d2),_0x5783c9[_0x52f75f(0x1cb)](_0x2ebdd3=>{_0xbc168f+=_0x2ebdd3;}),console[_0x52f75f(0x196)](_0x47434d),_0xbc168f+=_0x52f75f(0x1ab),_0xbc168f+=_0x52f75f(0x28f);}),_0xbc168f;}function a0_0x4444(){const _0x5f2808=['168282UsxvOC','top','../models/all_models','$_id.date','date','setDate','status','html','aoa_to_sheet','toStream','canvas','Letter','load','$sale_product.real_qty_unit_val','<th\x20rowspan=\x272\x27>Category</th>','referenceNumber','$products','$products.product_details.category','<th>\x20ITEM\x20DESCRIPTION\x20</th>','dataqty','$product_info.product_code','/getDSSR_no','check_no','$products.product_details','$_id.status_data','/dsrr_admin/view_data/:id','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','false','/dsrr/view','<th>\x20ENDING\x20BALANCE\x20</th>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','exceljs','border-bottom','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','toFixed','pipe','_id','Arabic','isArray','numeric','$product_name','NumberFormat','balanced','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','$product','4697DXBctk','<td\x20class=\x22row_data\x22>','/dsrr_admin/pdf_admin','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','includes','sales_bkg','$sale_product.product_name','$product_info.brand','getDate','$due_date','replace','totalQTY','<td\x20class=\x22row_data\x22>0</td>','Portuguese\x20(BR)','2993495HtocXU','!cols','</table>','9005437ofHOBE','/balance/pdf','$products.discount','border-left','catch','application/pdf','../middleware/auth','category','bottom','PDF\x20Generation\x20Error:','email','$sale_product','<td\x20class=\x22cat_data\x22></td>','$product_list.product_stock','Error\x20generating\x20PDF','/agent/pdf','attr','send','<th\x20colspan=\x272\x27>SOLD</th>','English','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','<h1>JAKA\x20EQUITIES\x20CORP</h1>','product_details.product_name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','$products.NetPrice','<p>SALES\x20REPORTS</p>','$product_stock','toLocaleString','$products.adj_discount','15in','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','note','French','Content-Type','<td\x20class=\x22row_data\x22><b>','</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','products','8asXlha','</div>','<p>INVENTORY\x20SUMMARY</p>','Chinese','$product_list','20mm','map','$status_data','length','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','totalPrice','$product_details','8.5in','name','window.print();','<tr>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','create','$sale_product.product_code','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','html-pdf','totalQty','window.onload\x20=\x20function()\x20{','$product_docs','Household','$sale_product.isFG','</thead>','valueOf','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','product_docs','$products.qty','Standard','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','salesman_data','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','attachment;\x20filename=\x22sales_report.xlsx\x22','express','right','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','product_code','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','stock','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','getFullYear','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$sales_info','dsi_sales_admin','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','<th>\x20ITEM\x20CODE\x20</th>','prod_cat','border-right','1cANtlA','Products\x20find_data','$cash','split','adj_discount','$_id.category','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','sales_staff_id','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','rowspan','excel','thick','/dsrr/pdf','ObjectId','sales_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','$product_info','redirect','Content-Disposition','mongoose','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','/getDSSR_no_sales','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','000000','1208490mkWnZt','isFG','/agent_reports/pdf_admin','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','qty','$product_details.product_stock','xlsx','/dev/null','<th\x20rowspan=\x272\x27>Production</th>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','flash','product_details','getMonth','$amount','<table>','/inventory_sum/view','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','<td\x20class=\x22row_data\x22></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','sales_ext','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<script>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','book_append_sheet','product_stock','test','push','Products\x20master','<div\x20\x20id=\x22table-conatainer\x22>','table\x20tr','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','Hindi','log','<th>\x20SALES\x20</th>','toISOString','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','<div\x20style=\x22page-break-before:\x20always;\x22></div>','format','success','body','$sale_product.discount','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','$customer','../public/language/languages.json','exports','left','$products.product_details.brand','<td\x20colspan=\x223\x22><b>TOTAL<b>','findById','No\x20data\x20was\x20Found!','$product_info.name','/agent_reports/view','/dl_excel','</tbody>','product_name','<th\x20rowspan=\x272\x27>Products</th>','Types','slice','findOne','multer','beg_bal','$_id.customer','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','$totalQty','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','language','$_id.brand','</tr>','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','reduce','$product_info.category','buffer','$sale_product.totalprice','brandCount','/reports/dsrr/view','$product_code','find','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','totalGross','</th>','totalQTYsum','dssr_view_admin','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Router','forEach','$bank','$sales_info._id','$name','setHeader','$product.product_name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<tbody>','save','Sales\x20Report','medium','24fvVcqX','DateTimeFormat','/dsrr_admin/view','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','text','bank','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','Spanish','en-US','<th>X-Truck</th>','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','book_new','brand','amount','dsi_sales','$products.product_details.gross_price','product_info','/total_sales_reports/view','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','jsbarcode','thin','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','customer','German','render','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','<thead>','<th>\x20INCOMING\x20</th>','2972422ptSRMe','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','true','<td\x20colspan=\x22','json','write','then','$date','<div\x20class=\x22col-sm-11\x22>','$product_list.product_name','English\x20(US)','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','cash','dssr_view','attachment;\x20filename=\x22reports.xlsx\x22','agent_sales','$product.product_code','user','</td>','cat_brand','Products\x20warehouse_data','landscape','$check_no','filter','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','colspan','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22><b></b></td>','$_id.dsi','errors','0.1in','params','dsi','long','each','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','$discount','staffs','\x20-\x20','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$products.product_details.prod_id','<div\x20class=\x22row\x22>','$NetPrice','!merges','get','blob-stream','discount','trim','sumqty','$sales_info.name','<th>\x20INVOICE\x20AMOUNT\x20</th>','sales_reports','$sales_staff_id','$brand','</p>','error','Asia/Manila','NetPrice','aggregate','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','$category','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<p>','\x22\x20class=\x22cat_data\x22>','post','$sale_product._id','border-top','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','inventory_sum','utils','4212936VgAdZL','\x22><b>','$dsi','/agent_reports/pdf','$totalGross','$product_info.gross_price','td,\x20th','sale_product.product_code','Portuguese','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','<th>\x20BEG\x20BALANCE\x20</th>','</script>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','97070oilNWb','Arabic\x20(ae)','$adj_discount','style','$sale_product.adj_discount','$product_details.product_name','<td\x20class=\x22cat_data\x22>','60mm'];a0_0x4444=function(){return _0x5f2808;};return a0_0x4444();}async function agentsdataDSICheck_excel(_0x52fb69,_0x4df747,_0x54810d,_0x16518d){const _0x4c0050=a0_0x412553,_0x2a3e8b=await product[_0x4c0050(0x22c)]([{'$group':{'_id':{'brand':_0x4c0050(0x227),'category':_0x4c0050(0x22e)},'products':{'$push':{'name':_0x4c0050(0x1ce),'product_code':_0x4c0050(0x1c1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1336be=[];_0x1336be[_0x4c0050(0x205)]=[];for(let _0x20c4f9=0x0;_0x20c4f9<=_0x2a3e8b[_0x4c0050(0x2bf)]-0x1;_0x20c4f9++){const _0x12d906=_0x2a3e8b[_0x20c4f9];_0x1336be[_0x4c0050(0x205)][_0x4c0050(0x190)](_0x12d906);}const _0x390a94=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x4c0050(0x1c1),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1c948e=await product[_0x4c0050(0x22c)]([{'$group':{'_id':{'category':'$category','brand':_0x4c0050(0x227)}}},{'$group':{'_id':_0x4c0050(0x161),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x29c597=await sales_sa[_0x4c0050(0x22c)]([{'$match':{'date':{'$gte':_0x52fb69,'$lte':_0x4df747},'sales_staff_id':_0x54810d,'sale_product.isFG':_0x4c0050(0x269)}},{'$unwind':_0x4c0050(0x29b)},{'$match':{'sale_product.isFG':_0x4c0050(0x269)}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0x4c0050(0x14f),'as':_0x4c0050(0x1e6)}},{'$unwind':_0x4c0050(0x16c)},{'$group':{'_id':{'dsi':_0x4c0050(0x23b),'date':_0x4c0050(0x1f9),'customer':'$customer'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x4c0050(0x1be),'discount':'$sale_product.discount','adj_discount':_0x4c0050(0x24a),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x4c0050(0x1bc),'brand':_0x4c0050(0x286),'gross_price':_0x4c0050(0x23e)}}}}},{'$unwind':_0x4c0050(0x25e)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x4c0050(0x251),'customer':_0x4c0050(0x1b3),'category':_0x4c0050(0x25f),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x4c0050(0x146)},'totalGross':{'$sum':{'$multiply':[_0x4c0050(0x146),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x4c0050(0x2a8)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x4c0050(0x2ac)},'product_details':{'$first':_0x4c0050(0x265)}}},{'$group':{'_id':{'dsi':_0x4c0050(0x20e),'date':_0x4c0050(0x251),'customer':_0x4c0050(0x1b3)},'totalQty':{'$sum':_0x4c0050(0x1b5)},'totalGross':{'$sum':_0x4c0050(0x23d)},'NetPrice':{'$sum':_0x4c0050(0x21c)},'discount':{'$sum':_0x4c0050(0x216)},'adj_discount':{'$sum':_0x4c0050(0x248)},'products':{'$push':{'qty':_0x4c0050(0x1b5),'category':_0x4c0050(0x161),'brand':'$_id.brand','product_details':_0x4c0050(0x2c2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x577089=[],_0x381cdf={},_0xb121eb={},_0x35e20f={};var _0x2bff2e=0x0,_0x323f53=0x0,_0x141703=0x0,_0x4681a6=0x0,_0x2aab4d=0x0;const _0x4fb57e=0x9184e72a000;for(let _0x4a2c8f=0x0;_0x4a2c8f<=_0x29c597[_0x4c0050(0x2bf)]-0x1;_0x4a2c8f++){const _0x29d060=_0x29c597[_0x4a2c8f];let _0x9f221f='<tr>';_0x9f221f+=_0x4c0050(0x1f3)+_0x29d060[_0x4c0050(0x275)]['dsi']+_0x4c0050(0x204),_0x9f221f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x29d060['_id']['date']+_0x4c0050(0x204),_0x9f221f+=_0x4c0050(0x1f3)+_0x29d060[_0x4c0050(0x275)][_0x4c0050(0x1ec)]+_0x4c0050(0x204);let _0x16ba63={};var _0x30b1eb=0x0;for(let _0x391118=0x0;_0x391118<=_0x29d060['products']['length']-0x1;_0x391118++){const _0x4f1981=_0x29d060['products'][_0x391118];_0x16ba63[_0x4f1981['brand']+'-'+_0x4f1981[_0x4c0050(0x297)]]=_0x4f1981['qty'];const _0x2cdc44=_0x4f1981[_0x4c0050(0x1e2)]+'-'+_0x4f1981['category'];!_0x381cdf[_0x2cdc44]&&(_0x381cdf[_0x2cdc44]=0x0),!Array[_0x4c0050(0x277)](_0x35e20f[_0x2cdc44])&&(_0x35e20f[_0x2cdc44]=[]),!Array[_0x4c0050(0x277)](_0x35e20f[_0x2cdc44])&&(_0x35e20f[_0x2cdc44]=[]),_0x381cdf[_0x2cdc44]+=_0x4f1981['qty'],_0x35e20f[_0x2cdc44][_0x4c0050(0x190)](_0x4f1981[_0x4c0050(0x178)]),_0x30b1eb++;}console[_0x4c0050(0x196)](_0x29d060);for(let _0x4fb2c0=0x0;_0x4fb2c0<=_0x1336be[_0x4c0050(0x205)][_0x4c0050(0x2bf)]-0x1;_0x4fb2c0++){const _0x58a961=_0x1336be[_0x4c0050(0x205)][_0x4fb2c0],_0x36cbe5=_0x58a961['_id'][_0x4c0050(0x1e2)]+'-'+_0x58a961[_0x4c0050(0x275)]['category'];_0x9f221f+=_0x4c0050(0x194)+(_0x16ba63[_0x36cbe5]!==undefined?_0x16ba63[_0x36cbe5]['toFixed'](0x2):'')+'</td>';}_0x141703=_0x29d060[_0x4c0050(0x220)]+_0x29d060[_0x4c0050(0x160)],_0x9f221f+=_0x4c0050(0x22f)+formatNumber(parseFloat(_0x29d060['totalQty'],0x2)[_0x4c0050(0x273)](0x2))+_0x4c0050(0x204),_0x9f221f+=_0x4c0050(0x22f)+formatNumber(_0x29d060[_0x4c0050(0x1c5)][_0x4c0050(0x273)](0x2))+_0x4c0050(0x204),_0x9f221f+=_0x4c0050(0x22f)+formatNumber(_0x141703)+_0x4c0050(0x204),_0x9f221f+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x29d060[_0x4c0050(0x22b)][_0x4c0050(0x273)](0x2))+_0x4c0050(0x204),_0x9f221f+='</tr>',_0x2bff2e+=parseFloat(_0x29d060[_0x4c0050(0x13d)][_0x4c0050(0x273)](0x2)),_0x323f53+=parseFloat(_0x29d060[_0x4c0050(0x22b)][_0x4c0050(0x273)](0x2)),_0x4681a6+=_0x141703,_0x2aab4d+=parseFloat(_0x29d060[_0x4c0050(0x1c5)][_0x4c0050(0x273)](0x2));if(_0x4a2c8f==_0x29c597['length']-0x1){_0x9f221f+=_0x4c0050(0x2c6),_0x9f221f+=_0x4c0050(0x1a5),_0x9f221f+='</td>';for(let _0x251514=0x0;_0x251514<=_0x1336be['cat_brand'][_0x4c0050(0x2bf)]-0x1;_0x251514++){const _0x38fcef=_0x1336be[_0x4c0050(0x205)][_0x251514],_0x3647c0=_0x38fcef['_id'][_0x4c0050(0x1e2)]+'-'+_0x38fcef['_id'][_0x4c0050(0x297)],_0x1e03dc=_0x35e20f[_0x3647c0][_0x4c0050(0x1bb)]((_0x3520a1,_0x4608f3)=>_0x3520a1+_0x4608f3,0x0);_0x9f221f+=_0x4c0050(0x144)+(_0x1e03dc!==undefined?formatNumber(_0x1e03dc[_0x4c0050(0x273)](0x2)):'')+'</b></td>',console[_0x4c0050(0x196)](_0x35e20f[_0x3647c0][_0x4c0050(0x1bb)]((_0x1214a0,_0x565bb7)=>_0x1214a0+_0x565bb7,0x0));}_0x9f221f+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2bff2e[_0x4c0050(0x273)](0x2))+_0x4c0050(0x2b3),_0x9f221f+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2aab4d)+_0x4c0050(0x2b3),_0x9f221f+=_0x4c0050(0x18a)+formatNumber(_0x4681a6)+_0x4c0050(0x2b3),_0x9f221f+=_0x4c0050(0x18a)+formatNumber(_0x323f53)+_0x4c0050(0x2b3),_0x9f221f+=_0x4c0050(0x1b9);}_0x577089[_0x4c0050(0x190)](_0x9f221f);}function _0x58b378(_0x276264,_0x3729f4){const _0x56ab0e=_0x4c0050,_0x21a1ea=[];for(let _0x34f7c4=0x0;_0x34f7c4<=_0x276264[_0x56ab0e(0x2bf)]-0x1;_0x34f7c4+=_0x3729f4){_0x21a1ea[_0x56ab0e(0x190)](_0x276264[_0x56ab0e(0x1af)](_0x34f7c4,_0x34f7c4+_0x3729f4));}return _0x21a1ea;}const _0x36ffad=_0x58b378(_0x577089,_0x4fb57e);let _0x18a595='';return _0x36ffad[_0x4c0050(0x1cb)]((_0x29c14d,_0x1d2af1)=>{const _0x2b7af8=_0x4c0050;_0x1d2af1>0x0&&(_0x18a595+=_0x2b7af8(0x19a));_0x18a595+=_0x2b7af8(0x184),_0x18a595+=_0x2b7af8(0x1f0),_0x18a595+=_0x2b7af8(0x2c6),_0x18a595+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x18a595+=_0x2b7af8(0x1b9),_0x18a595+=_0x2b7af8(0x2c6),_0x18a595+=_0x2b7af8(0x2cb);for(let _0x41d6b1=0x0;_0x41d6b1<=_0x390a94[_0x2b7af8(0x2bf)]-0x1;_0x41d6b1++){const _0x5cdf49=_0x390a94[_0x41d6b1];for(let _0x16cbbf=0x0;_0x16cbbf<_0x1c948e[_0x2b7af8(0x2bf)];_0x16cbbf++){const _0x1ff69d=_0x1c948e[_0x16cbbf];_0x1ff69d[_0x2b7af8(0x275)]===_0x5cdf49[_0x2b7af8(0x275)][_0x2b7af8(0x297)]&&(_0x18a595+=_0x2b7af8(0x1f5)+_0x1ff69d[_0x2b7af8(0x1bf)]+_0x2b7af8(0x232)+_0x5cdf49[_0x2b7af8(0x275)][_0x2b7af8(0x297)]+_0x2b7af8(0x204));}}_0x18a595+=_0x2b7af8(0x1ba),_0x18a595+='</tr>',_0x18a595+=_0x2b7af8(0x2c6),_0x18a595+=_0x2b7af8(0x17d),_0x18a595+=_0x2b7af8(0x1eb),_0x18a595+=_0x2b7af8(0x268);for(let _0x15c3d4=0x0;_0x15c3d4<=_0x390a94[_0x2b7af8(0x2bf)]-0x1;_0x15c3d4++){const _0x1d1cc8=_0x390a94[_0x15c3d4];for(let _0xc90fca=0x0;_0xc90fca<_0x1336be[_0x2b7af8(0x205)][_0x2b7af8(0x2bf)];_0xc90fca++){const _0x401875=_0x1336be['cat_brand'][_0xc90fca];_0x401875[_0x2b7af8(0x275)][_0x2b7af8(0x297)]===_0x1d1cc8[_0x2b7af8(0x275)][_0x2b7af8(0x297)]&&(_0x18a595+='<td\x20class=\x22cat_data\x22>'+_0x401875[_0x2b7af8(0x275)]['brand']+_0x2b7af8(0x204));}}_0x18a595+=_0x2b7af8(0x14a),_0x18a595+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x18a595+=_0x2b7af8(0x27d),_0x18a595+=_0x2b7af8(0x162),_0x18a595+=_0x2b7af8(0x1b9),_0x18a595+='</thead>',_0x18a595+=_0x2b7af8(0x1d2),_0x29c14d[_0x2b7af8(0x1cb)](_0x2e2e0e=>{_0x18a595+=_0x2e2e0e;}),console[_0x2b7af8(0x196)](_0x35e20f),_0x18a595+=_0x2b7af8(0x1ab),_0x18a595+='</table>';}),_0x18a595;}router['post'](a0_0x412553(0x23c),auth,async(_0x386c6b,_0x5ea499)=>{const _0x5d8ccc=a0_0x412553,{from_date:_0x43a011,to_date:_0x58a3df,isExcel:_0x2ce534}=_0x386c6b['body'],_0x241737=_0x386c6b[_0x5d8ccc(0x203)],_0x1de725=await staff[_0x5d8ccc(0x1b0)]({'email':_0x241737['email']}),_0x186eb3=await master_shop['find']();console['log'](_0x186eb3[0x0]['image']);const _0x5f2f15=await agentsdataDSICheck(_0x43a011,_0x58a3df,_0x1de725['_id'][_0x5d8ccc(0x143)](),_0x2ce534),_0x31be7a=await agentsdataDSICheck_excel(_0x43a011,_0x58a3df,_0x1de725[_0x5d8ccc(0x275)][_0x5d8ccc(0x143)](),_0x2ce534);let _0x21f8c0=_0x5d8ccc(0x164);var _0x572336=new Date(_0x43a011),_0x1a7a5f=new Date(_0x58a3df);const _0x4e3523={'year':'numeric','month':_0x5d8ccc(0x213),'day':_0x5d8ccc(0x278)},_0x29d2cc=new Intl[(_0x5d8ccc(0x1d7))](_0x5d8ccc(0x1de),_0x4e3523)[_0x5d8ccc(0x19b)](_0x572336),_0x147179=new Intl[(_0x5d8ccc(0x1d7))](_0x5d8ccc(0x1de),_0x4e3523)['format'](_0x1a7a5f);_0x21f8c0+=_0x5d8ccc(0x21b),_0x21f8c0+='<div\x20\x20id=\x22table-conatainer\x22>',_0x21f8c0+='<table>',_0x21f8c0+=_0x5f2f15,_0x21f8c0+=_0x5d8ccc(0x28f),_0x21f8c0+=_0x5d8ccc(0x2b8),_0x21f8c0+=_0x5d8ccc(0x2b8);let _0x38b99f=_0x5d8ccc(0x164);_0x38b99f+=_0x5d8ccc(0x21b),_0x38b99f+=_0x5d8ccc(0x192),_0x38b99f+=_0x5d8ccc(0x184),_0x38b99f+=_0x31be7a,_0x38b99f+=_0x5d8ccc(0x28f),_0x38b99f+=_0x5d8ccc(0x2b8),_0x38b99f+='</div>';let _0x5ad919=_0x5d8ccc(0x236);const _0x2100b3={'width':_0x5d8ccc(0x2ad),'height':_0x5d8ccc(0x2c3),'orientation':'landscape','border':{'top':'0.1in','right':_0x5d8ccc(0x210),'bottom':'0.1in','left':_0x5d8ccc(0x210)},'header':{'height':_0x5d8ccc(0x24d),'contents':_0x5d8ccc(0x230)+_0x5ad919+_0x5d8ccc(0x19f)+_0x29d2cc+_0x5d8ccc(0x218)+_0x147179+_0x5d8ccc(0x1c9)},'footer':{'height':_0x5d8ccc(0x2bc),'contents':{'default':_0x5d8ccc(0x153)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x5d8ccc(0x17b)}}};if(_0x2ce534=='on'){const _0x355b2a=cheerio[_0x5d8ccc(0x25a)](_0x38b99f);let _0x519c76=[],_0xc397b7=[],_0x5c42b6=[];const _0x294901=_0x48b12d=>{const _0x172c74=_0x5d8ccc,_0x3cd9cb={'top':{'style':_0x172c74(0x167),'color':{'rgb':_0x172c74(0x173)}},'bottom':{'style':_0x172c74(0x167),'color':{'rgb':'000000'}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':_0x172c74(0x167),'color':{'rgb':_0x172c74(0x173)}}};if(_0x48b12d){const _0x75076d=_0x48b12d[_0x172c74(0x15f)](';')['reduce']((_0x11cd26,_0x2bd682)=>{const _0x1cb8fc=_0x172c74,[_0x274f68,_0x56937e]=_0x2bd682[_0x1cb8fc(0x15f)](':')[_0x1cb8fc(0x2bd)](_0x322cd1=>_0x322cd1['trim']());return _0x11cd26[_0x274f68]=_0x56937e,_0x11cd26;},{});_0x75076d[_0x172c74(0x235)]&&(_0x3cd9cb[_0x172c74(0x24f)][_0x172c74(0x249)]=_0x75076d['border-top'][_0x172c74(0x283)](_0x172c74(0x1ea))?_0x172c74(0x1ea):_0x172c74(0x1d5)),_0x75076d[_0x172c74(0x26f)]&&(_0x3cd9cb[_0x172c74(0x298)][_0x172c74(0x249)]=_0x75076d[_0x172c74(0x26f)][_0x172c74(0x283)](_0x172c74(0x1ea))?_0x172c74(0x1ea):_0x172c74(0x1d5)),_0x75076d['border-left']&&(_0x3cd9cb[_0x172c74(0x1a3)][_0x172c74(0x249)]=_0x75076d[_0x172c74(0x293)][_0x172c74(0x283)](_0x172c74(0x1ea))?_0x172c74(0x1ea):_0x172c74(0x1d5)),_0x75076d[_0x172c74(0x15b)]&&(_0x3cd9cb['right'][_0x172c74(0x249)]=_0x75076d[_0x172c74(0x15b)][_0x172c74(0x283)]('thin')?_0x172c74(0x1ea):_0x172c74(0x1d5));}return _0x3cd9cb;};_0x355b2a(_0x5d8ccc(0x193))[_0x5d8ccc(0x214)]((_0x100200,_0x933dd2)=>{const _0x391dc5=_0x5d8ccc;let _0x57bab1=[],_0x20eeed=0x0;while(_0x5c42b6[_0x20eeed]){_0x5c42b6[_0x20eeed]--,_0x20eeed++;}_0x355b2a(_0x933dd2)[_0x391dc5(0x1c2)](_0x391dc5(0x23f))['each']((_0x31c5bf,_0x4ac786)=>{const _0x1c528f=_0x391dc5;let _0x30f948=_0x355b2a(_0x4ac786)['text']()['trim'](),_0x352a4d=parseFloat(_0x30f948[_0x1c528f(0x289)](/,/g,'')),_0x560557={};!isNaN(_0x352a4d)?(_0x560557['v']=_0x352a4d,_0x560557['t']='n'):(_0x560557['v']=_0x30f948,_0x560557['t']='s');const _0xe9525c=_0x355b2a(_0x4ac786)[_0x1c528f(0x2a0)](_0x1c528f(0x249)),_0x3840ff=_0x294901(_0xe9525c);_0x560557['s']={'border':_0x3840ff},_0x57bab1[_0x20eeed]=_0x560557;let _0x561b78=parseInt(_0x355b2a(_0x4ac786)[_0x1c528f(0x2a0)](_0x1c528f(0x20b)))||0x1,_0x4e3dc5=parseInt(_0x355b2a(_0x4ac786)[_0x1c528f(0x2a0)]('rowspan'))||0x1;(_0x561b78>0x1||_0x4e3dc5>0x1)&&_0xc397b7[_0x1c528f(0x190)]({'s':{'r':_0x100200,'c':_0x20eeed},'e':{'r':_0x100200+_0x4e3dc5-0x1,'c':_0x20eeed+_0x561b78-0x1}});for(let _0x48bbb9=0x0;_0x48bbb9<_0x561b78;_0x48bbb9++){_0x4e3dc5>0x1&&(_0x5c42b6[_0x20eeed+_0x48bbb9]=_0x4e3dc5-0x1);}_0x20eeed+=_0x561b78;}),_0x519c76[_0x391dc5(0x190)](_0x57bab1);});const _0x59a49f=XLSX[_0x5d8ccc(0x238)]['book_new'](),_0x4b4bfc=XLSX[_0x5d8ccc(0x238)][_0x5d8ccc(0x256)](_0x519c76);_0xc397b7[_0x5d8ccc(0x2bf)]>0x0&&(_0x4b4bfc['!merges']=_0xc397b7);_0x4b4bfc['!cols']=_0x519c76[0x0][_0x5d8ccc(0x2bd)](()=>({'wpx':0x64})),XLSX[_0x5d8ccc(0x238)][_0x5d8ccc(0x18d)](_0x59a49f,_0x4b4bfc,_0x5d8ccc(0x1d4));const _0x22ae06=XLSX[_0x5d8ccc(0x1f7)](_0x59a49f,{'bookType':_0x5d8ccc(0x17a),'type':'buffer'});_0x5ea499['setHeader']('Content-Disposition',_0x5d8ccc(0x14b)),_0x5ea499[_0x5d8ccc(0x1cf)]('Content-Type',_0x5d8ccc(0x1e0)),_0x5ea499[_0x5d8ccc(0x2a1)](_0x22ae06);}else pdf[_0x5d8ccc(0x2c9)](_0x21f8c0,_0x2100b3)[_0x5d8ccc(0x257)](function(_0x2a205c,_0x1eb4c6){const _0x179d6e=_0x5d8ccc;if(_0x2a205c){console[_0x179d6e(0x229)](_0x179d6e(0x299),_0x2a205c),_0x5ea499['status'](0x1f4)[_0x179d6e(0x2a1)](_0x179d6e(0x29e)+_0x2a205c);return;}_0x5ea499[_0x179d6e(0x1cf)](_0x179d6e(0x2b1),_0x179d6e(0x295)),_0x1eb4c6[_0x179d6e(0x274)](_0x5ea499);});}),router[a0_0x412553(0x21e)](a0_0x412553(0x1e7),auth,async(_0x259b49,_0x29d4e4)=>{const _0x177f8f=a0_0x412553;try{const {username:_0x342222,email:_0x326af6,role:_0xbfcb06}=_0x259b49[_0x177f8f(0x203)],_0x2671d2=_0x259b49[_0x177f8f(0x203)],_0x885c89=await profile[_0x177f8f(0x1b0)]({'email':_0x2671d2['email']}),_0x5cf1e5={'year':'numeric','month':_0x177f8f(0x213),'day':_0x177f8f(0x278)},_0x20c2f2=await master_shop[_0x177f8f(0x1c2)](),_0x3e88c7=await product[_0x177f8f(0x1c2)](),_0x5a2af4=await warehouse['aggregate']([{'$unwind':_0x177f8f(0x2c2)},{'$lookup':{'from':_0x177f8f(0x2b6),'localField':'product_details.product_name','foreignField':_0x177f8f(0x2c4),'as':_0x177f8f(0x145)}},{'$unwind':_0x177f8f(0x13f)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x177f8f(0x179)}},{'$group':{'_id':_0x177f8f(0x279),'product_stock':{'$sum':_0x177f8f(0x2aa)}}}]),_0x30d301=await staff[_0x177f8f(0x1b0)]({'email':_0x2671d2['email']});if(_0x20c2f2[0x0][_0x177f8f(0x1b7)]==_0x177f8f(0x1fc))var _0x6295ba=users[_0x177f8f(0x2a3)];else{if(_0x20c2f2[0x0][_0x177f8f(0x1b7)]==_0x177f8f(0x195))var _0x6295ba=users[_0x177f8f(0x195)];else{if(_0x20c2f2[0x0][_0x177f8f(0x1b7)]==_0x177f8f(0x1ed))var _0x6295ba=users[_0x177f8f(0x1ed)];else{if(_0x20c2f2[0x0][_0x177f8f(0x1b7)]=='Spanish')var _0x6295ba=users[_0x177f8f(0x1dd)];else{if(_0x20c2f2[0x0][_0x177f8f(0x1b7)]==_0x177f8f(0x2b0))var _0x6295ba=users[_0x177f8f(0x2b0)];else{if(_0x20c2f2[0x0]['language']==_0x177f8f(0x28c))var _0x6295ba=users[_0x177f8f(0x241)];else{if(_0x20c2f2[0x0][_0x177f8f(0x1b7)]=='Chinese')var _0x6295ba=users[_0x177f8f(0x2ba)];else{if(_0x20c2f2[0x0][_0x177f8f(0x1b7)]==_0x177f8f(0x247))var _0x6295ba=users[_0x177f8f(0x276)];}}}}}}}_0x29d4e4['render'](_0x177f8f(0x225),{'success':_0x259b49[_0x177f8f(0x180)](_0x177f8f(0x19c)),'errors':_0x259b49[_0x177f8f(0x180)](_0x177f8f(0x20f)),'alldata':_0x3e88c7,'profile':_0x885c89,'master_shop':_0x20c2f2,'role':_0x2671d2,'product_stock':_0x5a2af4,'language':_0x6295ba,'staff_arr':_0x30d301});}catch(_0x48d14c){}});async function dataSalesReports(_0x3d0c96,_0x1dfac5,_0x1353a8){const _0x108a27=a0_0x412553;let _0x47b396='';const _0xb3d7d=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3d0c96,'$lte':_0x1dfac5},'sales_staff_id':_0x1353a8}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x108a27(0x269)}},{'$group':{'_id':{'product_name':_0x108a27(0x285),'product_code':_0x108a27(0x2ca)},'sumqty':{'$sum':_0x108a27(0x25b)},'totalPrice':{'$sum':_0x108a27(0x1be)}}},{'$sort':{'_id.product_name':0x1}}]);var _0xb7a566=0x0,_0x4cea14=0x0;for(let _0x3a69f6=0x0;_0x3a69f6<=_0xb3d7d[_0x108a27(0x2bf)]-0x1;_0x3a69f6++){const _0x2de542=_0xb3d7d[_0x3a69f6];var _0x4f2618=_0x2de542['totalPrice'][_0x108a27(0x2ab)](undefined),_0x4fb38c=_0x2de542['sumqty'][_0x108a27(0x2ab)](undefined);_0x47b396+=_0x108a27(0x2c6),_0x47b396+=_0x108a27(0x280)+_0x2de542[_0x108a27(0x275)]['product_code']+_0x108a27(0x204),_0x47b396+='<td\x20class=\x22row_data\x22>'+_0x2de542[_0x108a27(0x275)]['product_name']+_0x108a27(0x204),_0x47b396+=_0x108a27(0x280)+formatNumber(_0x2de542[_0x108a27(0x222)][_0x108a27(0x273)](0x2))+_0x108a27(0x204),_0x47b396+=_0x108a27(0x280)+formatNumber(_0x2de542[_0x108a27(0x2c1)][_0x108a27(0x273)](0x2))+_0x108a27(0x204),_0x47b396+='</tr>',_0xb7a566+=parseFloat(_0x2de542[_0x108a27(0x222)]),_0x4cea14+=parseFloat(_0x2de542[_0x108a27(0x2c1)]);}var _0x274b88=_0x4cea14[_0x108a27(0x2ab)](undefined),_0x218386=_0xb7a566[_0x108a27(0x2ab)](undefined);return _0x47b396+='<tr>',_0x47b396+=_0x108a27(0x1b6),_0x47b396+=_0x108a27(0x2b2)+formatNumber(_0xb7a566[_0x108a27(0x273)](0x2))+_0x108a27(0x2b3),_0x47b396+=_0x108a27(0x2b2)+formatNumber(_0x4cea14['toFixed'](0x2))+_0x108a27(0x2b3),_0x47b396+=_0x108a27(0x1b9),_0x47b396;}function a0_0x1073(_0x1024b4,_0x5bc417){const _0x444454=a0_0x4444();return a0_0x1073=function(_0x107304,_0x31464b){_0x107304=_0x107304-0x13d;let _0x5ddd7a=_0x444454[_0x107304];return _0x5ddd7a;},a0_0x1073(_0x1024b4,_0x5bc417);}router[a0_0x412553(0x233)]('/total_sales_reports/pdf',auth,async(_0x137bab,_0x299304)=>{const _0x433f9c=a0_0x412553;try{const {from_date:_0x18275e,to_date:_0x497456,isExcel:_0x370a73}=_0x137bab[_0x433f9c(0x19d)],_0x6f17cd=_0x137bab[_0x433f9c(0x203)],_0x5a40bf=await staff[_0x433f9c(0x1b0)]({'email':_0x6f17cd[_0x433f9c(0x29a)]});let _0x38bfb4='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x405206=new Date(_0x18275e),_0x40033a=new Date(_0x497456);const _0x1788cf={'year':'numeric','month':_0x433f9c(0x213),'day':_0x433f9c(0x278)},_0x524028=new Intl[(_0x433f9c(0x1d7))]('en-US',_0x1788cf)[_0x433f9c(0x19b)](_0x405206),_0x13b5c7=new Intl[(_0x433f9c(0x1d7))]('en-US',_0x1788cf)['format'](_0x40033a);var _0x29eade=await dataSalesReports(_0x18275e,_0x497456,_0x5a40bf[_0x433f9c(0x275)][_0x433f9c(0x143)]());_0x38bfb4+=_0x433f9c(0x21b),_0x38bfb4+=_0x433f9c(0x1fa),_0x38bfb4+=_0x433f9c(0x184),_0x38bfb4+=_0x433f9c(0x2c6),_0x38bfb4+=_0x433f9c(0x159),_0x38bfb4+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x38bfb4+='<th>\x20QTY\x20SOLD\x20</th>',_0x38bfb4+=_0x433f9c(0x224),_0x38bfb4+=_0x433f9c(0x2c6),_0x38bfb4+=_0x29eade,_0x38bfb4+=_0x433f9c(0x1b9),_0x38bfb4+=_0x433f9c(0x2b8),_0x38bfb4+=_0x433f9c(0x2b8);let _0x30ac03=_0x433f9c(0x236);const _0x10357d={'width':_0x433f9c(0x2ad),'height':_0x433f9c(0x2c3),'orientation':_0x433f9c(0x207),'border':{'top':_0x433f9c(0x210),'right':_0x433f9c(0x210),'bottom':'0.1in','left':'0.1in'},'header':{'height':_0x433f9c(0x24d),'contents':_0x433f9c(0x230)+_0x30ac03+_0x433f9c(0x245)+_0x5a40bf[_0x433f9c(0x2c4)]+_0x433f9c(0x1d9)+_0x524028+_0x433f9c(0x218)+_0x13b5c7+_0x433f9c(0x1c9)},'footer':{'height':_0x433f9c(0x2bc),'contents':{'default':_0x433f9c(0x153)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x433f9c(0x17b)}}};if(_0x370a73=='on'){const _0x2346fe=cheerio[_0x433f9c(0x25a)](_0x38bfb4);let _0x2f9464=[],_0x5e298e=[],_0xd341e8=[];const _0x121519=_0x4c6b16=>{const _0x2d25ba=_0x433f9c,_0x43b6eb={'top':{'style':_0x2d25ba(0x167),'color':{'rgb':_0x2d25ba(0x173)}},'bottom':{'style':'thick','color':{'rgb':_0x2d25ba(0x173)}},'left':{'style':_0x2d25ba(0x167),'color':{'rgb':_0x2d25ba(0x173)}},'right':{'style':_0x2d25ba(0x167),'color':{'rgb':_0x2d25ba(0x173)}}};if(_0x4c6b16){const _0x35fe08=_0x4c6b16[_0x2d25ba(0x15f)](';')[_0x2d25ba(0x1bb)]((_0x540c51,_0x46f710)=>{const _0x123f1d=_0x2d25ba,[_0x574ca5,_0x384d91]=_0x46f710[_0x123f1d(0x15f)](':')['map'](_0x507c26=>_0x507c26[_0x123f1d(0x221)]());return _0x540c51[_0x574ca5]=_0x384d91,_0x540c51;},{});_0x35fe08[_0x2d25ba(0x235)]&&(_0x43b6eb[_0x2d25ba(0x24f)][_0x2d25ba(0x249)]=_0x35fe08[_0x2d25ba(0x235)][_0x2d25ba(0x283)](_0x2d25ba(0x1ea))?_0x2d25ba(0x1ea):_0x2d25ba(0x1d5)),_0x35fe08[_0x2d25ba(0x26f)]&&(_0x43b6eb[_0x2d25ba(0x298)]['style']=_0x35fe08[_0x2d25ba(0x26f)][_0x2d25ba(0x283)](_0x2d25ba(0x1ea))?_0x2d25ba(0x1ea):'medium'),_0x35fe08[_0x2d25ba(0x293)]&&(_0x43b6eb[_0x2d25ba(0x1a3)]['style']=_0x35fe08[_0x2d25ba(0x293)]['includes'](_0x2d25ba(0x1ea))?'thin':'medium'),_0x35fe08[_0x2d25ba(0x15b)]&&(_0x43b6eb[_0x2d25ba(0x14d)][_0x2d25ba(0x249)]=_0x35fe08[_0x2d25ba(0x15b)]['includes'](_0x2d25ba(0x1ea))?_0x2d25ba(0x1ea):_0x2d25ba(0x1d5));}return _0x43b6eb;};_0x2346fe(_0x433f9c(0x193))['each']((_0x1a9df7,_0x28fe48)=>{const _0x36792a=_0x433f9c;let _0xd9ab49=[],_0x2a6fc6=0x0;while(_0xd341e8[_0x2a6fc6]){_0xd341e8[_0x2a6fc6]--,_0x2a6fc6++;}_0x2346fe(_0x28fe48)['find'](_0x36792a(0x23f))[_0x36792a(0x214)]((_0x18200c,_0xe8f27e)=>{const _0x24bfc5=_0x36792a;let _0x20ff52=_0x2346fe(_0xe8f27e)[_0x24bfc5(0x1da)]()[_0x24bfc5(0x221)](),_0x4125ae=parseFloat(_0x20ff52[_0x24bfc5(0x289)](/,/g,'')),_0xed8b76={};!isNaN(_0x4125ae)?(_0xed8b76['v']=_0x4125ae,_0xed8b76['t']='n'):(_0xed8b76['v']=_0x20ff52,_0xed8b76['t']='s');const _0x409b07=_0x2346fe(_0xe8f27e)['attr']('style'),_0x4813c4=_0x121519(_0x409b07);_0xed8b76['s']={'border':_0x4813c4},_0xd9ab49[_0x2a6fc6]=_0xed8b76;let _0x562217=parseInt(_0x2346fe(_0xe8f27e)[_0x24bfc5(0x2a0)](_0x24bfc5(0x20b)))||0x1,_0x582ef6=parseInt(_0x2346fe(_0xe8f27e)[_0x24bfc5(0x2a0)](_0x24bfc5(0x165)))||0x1;(_0x562217>0x1||_0x582ef6>0x1)&&_0x5e298e[_0x24bfc5(0x190)]({'s':{'r':_0x1a9df7,'c':_0x2a6fc6},'e':{'r':_0x1a9df7+_0x582ef6-0x1,'c':_0x2a6fc6+_0x562217-0x1}});for(let _0x1878db=0x0;_0x1878db<_0x562217;_0x1878db++){_0x582ef6>0x1&&(_0xd341e8[_0x2a6fc6+_0x1878db]=_0x582ef6-0x1);}_0x2a6fc6+=_0x562217;}),_0x2f9464[_0x36792a(0x190)](_0xd9ab49);});const _0x54e20a=XLSX[_0x433f9c(0x238)][_0x433f9c(0x1e1)](),_0x3e91d9=XLSX[_0x433f9c(0x238)][_0x433f9c(0x256)](_0x2f9464);_0x5e298e[_0x433f9c(0x2bf)]>0x0&&(_0x3e91d9[_0x433f9c(0x21d)]=_0x5e298e);_0x3e91d9['!cols']=_0x2f9464[0x0][_0x433f9c(0x2bd)](()=>({'wpx':0x64})),XLSX[_0x433f9c(0x238)][_0x433f9c(0x18d)](_0x54e20a,_0x3e91d9,'Sales\x20Report');const _0x299b31=XLSX[_0x433f9c(0x1f7)](_0x54e20a,{'bookType':_0x433f9c(0x17a),'type':_0x433f9c(0x1bd)});_0x299304[_0x433f9c(0x1cf)](_0x433f9c(0x16e),_0x433f9c(0x14b)),_0x299304[_0x433f9c(0x1cf)]('Content-Type',_0x433f9c(0x1e0)),_0x299304['send'](_0x299b31);}else pdf[_0x433f9c(0x2c9)](_0x38bfb4,_0x10357d)[_0x433f9c(0x257)](function(_0x619b1c,_0x24d15c){const _0x383996=_0x433f9c;if(_0x619b1c){_0x299304[_0x383996(0x254)](0x1f4)[_0x383996(0x2a1)](_0x383996(0x29e));return;}_0x299304[_0x383996(0x1cf)](_0x383996(0x2b1),_0x383996(0x295)),_0x24d15c[_0x383996(0x274)](_0x299304);});}catch(_0x1671f4){}}),router[a0_0x412553(0x21e)](a0_0x412553(0x185),auth,async(_0x353544,_0x4fab2a)=>{const _0x254451=a0_0x412553;try{const {username:_0x38fc70,email:_0x1df9a5,role:_0x3716ae}=_0x353544['user'],_0x3f7e83=_0x353544[_0x254451(0x203)],_0x4bb0b9=await profile[_0x254451(0x1b0)]({'email':_0x3f7e83[_0x254451(0x29a)]}),_0x515b1e={'year':_0x254451(0x278),'month':'long','day':_0x254451(0x278)},_0x49e020=await master_shop[_0x254451(0x1c2)](),_0xde879f=await product['find'](),_0x2f1ed3=await warehouse['aggregate']([{'$unwind':_0x254451(0x2c2)},{'$lookup':{'from':_0x254451(0x2b6),'localField':'product_details.product_name','foreignField':_0x254451(0x2c4),'as':_0x254451(0x145)}},{'$unwind':_0x254451(0x13f)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x254451(0x179)}},{'$group':{'_id':_0x254451(0x279),'product_stock':{'$sum':_0x254451(0x2aa)}}}]);if(_0x49e020[0x0][_0x254451(0x1b7)]==_0x254451(0x1fc))var _0x59fe29=users['English'];else{if(_0x49e020[0x0][_0x254451(0x1b7)]==_0x254451(0x195))var _0x59fe29=users[_0x254451(0x195)];else{if(_0x49e020[0x0][_0x254451(0x1b7)]==_0x254451(0x1ed))var _0x59fe29=users[_0x254451(0x1ed)];else{if(_0x49e020[0x0]['language']==_0x254451(0x1dd))var _0x59fe29=users[_0x254451(0x1dd)];else{if(_0x49e020[0x0][_0x254451(0x1b7)]=='French')var _0x59fe29=users['French'];else{if(_0x49e020[0x0][_0x254451(0x1b7)]==_0x254451(0x28c))var _0x59fe29=users[_0x254451(0x241)];else{if(_0x49e020[0x0]['language']==_0x254451(0x2ba))var _0x59fe29=users[_0x254451(0x2ba)];else{if(_0x49e020[0x0][_0x254451(0x1b7)]=='Arabic\x20(ae)')var _0x59fe29=users[_0x254451(0x276)];}}}}}}}_0x4fab2a[_0x254451(0x1ee)](_0x254451(0x237),{'success':_0x353544[_0x254451(0x180)]('success'),'errors':_0x353544[_0x254451(0x180)](_0x254451(0x20f)),'alldata':_0xde879f,'profile':_0x4bb0b9,'master_shop':_0x49e020,'role':_0x3f7e83,'product_stock':_0x2f1ed3,'language':_0x59fe29});}catch(_0x1ee172){}});async function dataInventoryReports(_0x257dd7,_0x1e2ca8,_0x4ea533){const _0xbbd068=a0_0x412553,_0x4bcee3=await sales_sa[_0xbbd068(0x22c)]([{'$match':{'date':{'$gte':_0x257dd7,'$lte':_0x1e2ca8},'sales_staff_id':_0x4ea533}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0xbbd068(0x285),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x11aaa5=mongoose[_0xbbd068(0x1ae)][_0xbbd068(0x169)],_0x315f00=await staff['aggregate']([{'$match':{'_id':_0x11aaa5(_0x4ea533)}},{'$unwind':_0xbbd068(0x2bb)},{'$match':{'product_list.isConfirm':_0xbbd068(0x1f4)}},{'$group':{'_id':{'product_name':_0xbbd068(0x1fb),'product_code':'$product_list.product_code'},'sumqty':{'$sum':_0xbbd068(0x29d)}}},{'$sort':{'_id.product_name':0x1}}]),_0x3013e2=await sales_inv_data[_0xbbd068(0x22c)]([{'$match':{'date':{'$gte':_0x257dd7,'$lte':_0x1e2ca8},'sales_staff_id':_0x4ea533}},{'$unwind':_0xbbd068(0x29b)},{'$group':{'_id':{'product_name':_0xbbd068(0x285),'product_code':_0xbbd068(0x2ca)},'totalQTYsum':{'$sum':'$sale_product.stock'}}}]);console[_0xbbd068(0x196)](_0x3013e2);let _0x3bd84f='';var _0x276031=0x0;for(let _0x2ab965=0x0;_0x2ab965<=_0x315f00[_0xbbd068(0x2bf)]-0x1;_0x2ab965++){const _0x507ae2=_0x315f00[_0x2ab965];_0x3bd84f+=_0xbbd068(0x2c6),_0x3bd84f+=_0xbbd068(0x188)+_0x507ae2['_id'][_0xbbd068(0x14f)]+'</td>',_0x3bd84f+=_0xbbd068(0x2b4)+_0x507ae2[_0xbbd068(0x275)][_0xbbd068(0x1ac)]+_0xbbd068(0x204);var _0x1733c1=_0x507ae2[_0xbbd068(0x222)],_0x2ad1be=0x0;for(let _0x5e0993=0x0;_0x5e0993<=_0x4bcee3[_0xbbd068(0x2bf)]-0x1;_0x5e0993++){const _0x32d697=_0x4bcee3[_0x5e0993];_0x507ae2['_id'][_0xbbd068(0x14f)]==_0x32d697[_0xbbd068(0x275)][_0xbbd068(0x14f)]&&_0x507ae2[_0xbbd068(0x275)][_0xbbd068(0x1ac)]==_0x32d697[_0xbbd068(0x275)]['product_name']&&(_0x2ad1be=_0x32d697[_0xbbd068(0x222)]);}var _0x370480=0x0;for(let _0x399cab=0x0;_0x399cab<=_0x3013e2[_0xbbd068(0x2bf)]-0x1;_0x399cab++){const _0x7e181a=_0x3013e2[_0x399cab];_0x507ae2[_0xbbd068(0x275)][_0xbbd068(0x14f)]==_0x7e181a[_0xbbd068(0x275)]['product_code']&&_0x507ae2['_id']['product_name']==_0x7e181a[_0xbbd068(0x275)][_0xbbd068(0x1ac)]&&(_0x370480=_0x7e181a[_0xbbd068(0x1c7)]);}_0x276031=_0x1733c1-_0x370480+_0x2ad1be,_0x3bd84f+=_0xbbd068(0x280)+_0x276031+_0xbbd068(0x204);let _0x151ff4=![];for(let _0xa3e67a=0x0;_0xa3e67a<=_0x3013e2[_0xbbd068(0x2bf)]-0x1;_0xa3e67a++){const _0x58eb5f=_0x3013e2[_0xa3e67a];if(_0x507ae2['_id'][_0xbbd068(0x14f)]==_0x58eb5f['_id'][_0xbbd068(0x14f)]&&_0x507ae2[_0xbbd068(0x275)][_0xbbd068(0x1ac)]==_0x58eb5f['_id']['product_name']){_0x3bd84f+='<td\x20class=\x22row_data\x22>'+_0x58eb5f['totalQTYsum']+'</td>',_0x151ff4=!![];break;}}!_0x151ff4&&(_0x3bd84f+=_0xbbd068(0x28b));let _0x9acd49=![];for(let _0x2698c4=0x0;_0x2698c4<=_0x4bcee3[_0xbbd068(0x2bf)]-0x1;_0x2698c4++){const _0x1d6894=_0x4bcee3[_0x2698c4];if(_0x507ae2[_0xbbd068(0x275)][_0xbbd068(0x14f)]==_0x1d6894[_0xbbd068(0x275)][_0xbbd068(0x14f)]&&_0x507ae2[_0xbbd068(0x275)]['product_name']==_0x1d6894[_0xbbd068(0x275)][_0xbbd068(0x1ac)]){_0x3bd84f+='<td\x20class=\x22row_data\x22>'+_0x1d6894['sumqty']+'</td>',_0x9acd49=!![];break;}}!_0x9acd49&&(_0x3bd84f+=_0xbbd068(0x28b)),_0x3bd84f+=_0xbbd068(0x280)+_0x507ae2[_0xbbd068(0x222)]+_0xbbd068(0x204),_0x3bd84f+=_0xbbd068(0x1b9);}return _0x3bd84f;}router[a0_0x412553(0x233)]('/inventory_sum/pdf',auth,async(_0x2b7f65,_0x2c28d7)=>{const _0x1c5099=a0_0x412553;try{const {from_date:_0x38c63a,to_date:_0x2802dc}=_0x2b7f65[_0x1c5099(0x19d)],_0x4dc332=_0x2b7f65[_0x1c5099(0x203)],_0x360840=await staff[_0x1c5099(0x1b0)]({'email':_0x4dc332[_0x1c5099(0x29a)]});let _0x2ada20='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x4649f9=new Date(_0x38c63a),_0x14ac79=new Date(_0x2802dc);const _0xf84471={'year':'numeric','month':'long','day':_0x1c5099(0x278)},_0x35bf00=new Intl[(_0x1c5099(0x1d7))](_0x1c5099(0x1de),_0xf84471)['format'](_0x4649f9),_0x400c04=new Intl['DateTimeFormat']('en-US',_0xf84471)[_0x1c5099(0x19b)](_0x14ac79);var _0x4dae43=await dataInventoryReports(_0x38c63a,_0x2802dc,_0x360840[_0x1c5099(0x275)][_0x1c5099(0x143)]());_0x2ada20+=_0x1c5099(0x2a5),_0x2ada20+=_0x1c5099(0x2b9),_0x2ada20+=_0x1c5099(0x231)+_0x35bf00+_0x1c5099(0x218)+_0x400c04+_0x1c5099(0x228),_0x2ada20+=_0x1c5099(0x21b),_0x2ada20+=_0x1c5099(0x1fa),_0x2ada20+='<table>',_0x2ada20+='<tr>',_0x2ada20+=_0x1c5099(0x159),_0x2ada20+=_0x1c5099(0x260),_0x2ada20+=_0x1c5099(0x243),_0x2ada20+=_0x1c5099(0x1f1),_0x2ada20+=_0x1c5099(0x197),_0x2ada20+=_0x1c5099(0x26b),_0x2ada20+='<tr>',_0x2ada20+=_0x4dae43,_0x2ada20+='</tr>',_0x2ada20+=_0x1c5099(0x2b8),_0x2ada20+=_0x1c5099(0x2b8);const _0x57b4ca={'format':_0x1c5099(0x259),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x1c5099(0x17b)}}};pdf[_0x1c5099(0x2c9)](_0x2ada20,_0x57b4ca)['toStream'](function(_0x3bc1e4,_0x2a2842){const _0x2d6c1a=_0x1c5099;if(_0x3bc1e4){_0x2c28d7[_0x2d6c1a(0x254)](0x1f4)[_0x2d6c1a(0x2a1)]('Error\x20generating\x20PDF');return;}_0x2c28d7[_0x2d6c1a(0x1cf)](_0x2d6c1a(0x2b1),_0x2d6c1a(0x295)),_0x2a2842[_0x2d6c1a(0x274)](_0x2c28d7);});}catch(_0x190ee1){}}),router[a0_0x412553(0x21e)](a0_0x412553(0x26a),auth,async(_0xdac35d,_0x4f3552)=>{const _0x1f48bb=a0_0x412553;try{const {username:_0x41bd34,email:_0x2cb946,role:_0x38d944}=_0xdac35d['user'],_0x309b87=_0xdac35d[_0x1f48bb(0x203)],_0x1bd2dd=await profile[_0x1f48bb(0x1b0)]({'email':_0x309b87[_0x1f48bb(0x29a)]}),_0x53e4f7={'year':_0x1f48bb(0x278),'month':'long','day':_0x1f48bb(0x278)},_0x518854=await master_shop[_0x1f48bb(0x1c2)]();console[_0x1f48bb(0x196)](_0x1f48bb(0x191),_0x518854);const _0x574742=await product[_0x1f48bb(0x1c2)]();console[_0x1f48bb(0x196)](_0x1f48bb(0x15d),_0x574742);const _0x498654=await warehouse['aggregate']([{'$unwind':_0x1f48bb(0x2c2)},{'$lookup':{'from':_0x1f48bb(0x2b6),'localField':_0x1f48bb(0x2a6),'foreignField':_0x1f48bb(0x2c4),'as':_0x1f48bb(0x145)}},{'$unwind':_0x1f48bb(0x13f)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x1f48bb(0x179)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x1f48bb(0x2aa)}}}]);console[_0x1f48bb(0x196)]('Products\x20warehouse_data',_0x498654),_0x498654['forEach'](_0x1f249c=>{const _0x4999cd=_0x1f48bb,_0x388e1f=_0x574742[_0x4999cd(0x2bd)](_0x475d56=>{const _0x1240a0=_0x4999cd;_0x475d56[_0x1240a0(0x2c4)]==_0x1f249c['_id']&&(_0x475d56[_0x1240a0(0x152)]=parseInt(_0x475d56[_0x1240a0(0x152)])+parseInt(_0x1f249c[_0x1240a0(0x18e)]));});});const _0x57041f=await staff[_0x1f48bb(0x1b0)]({'email':_0x309b87[_0x1f48bb(0x29a)]});if(_0x518854[0x0]['language']=='English\x20(US)')var _0x5c35df=users[_0x1f48bb(0x2a3)];else{if(_0x518854[0x0]['language']=='Hindi')var _0x5c35df=users['Hindi'];else{if(_0x518854[0x0][_0x1f48bb(0x1b7)]==_0x1f48bb(0x1ed))var _0x5c35df=users[_0x1f48bb(0x1ed)];else{if(_0x518854[0x0][_0x1f48bb(0x1b7)]==_0x1f48bb(0x1dd))var _0x5c35df=users[_0x1f48bb(0x1dd)];else{if(_0x518854[0x0][_0x1f48bb(0x1b7)]==_0x1f48bb(0x2b0))var _0x5c35df=users[_0x1f48bb(0x2b0)];else{if(_0x518854[0x0]['language']==_0x1f48bb(0x28c))var _0x5c35df=users[_0x1f48bb(0x241)];else{if(_0x518854[0x0]['language']=='Chinese')var _0x5c35df=users[_0x1f48bb(0x2ba)];else{if(_0x518854[0x0]['language']==_0x1f48bb(0x247))var _0x5c35df=users[_0x1f48bb(0x276)];}}}}}}}_0x4f3552[_0x1f48bb(0x1ee)](_0x1f48bb(0x1ff),{'success':_0xdac35d['flash'](_0x1f48bb(0x19c)),'errors':_0xdac35d[_0x1f48bb(0x180)](_0x1f48bb(0x20f)),'alldata':_0x574742,'profile':_0x1bd2dd,'master_shop':_0x518854,'role':_0x309b87,'product_stock':_0x498654,'language':_0x5c35df,'staff_arr':_0x57041f});}catch(_0x2d894b){}});async function agentsdataDSICheck_DSRR(_0x228dc8,_0x588a6d,_0x2596b3,_0x4c64eb){const _0x3a4f2e=a0_0x412553;let _0x79d128=new Date(_0x228dc8);_0x79d128[_0x3a4f2e(0x253)](_0x79d128[_0x3a4f2e(0x287)]()-0x1);let _0x3ff17e=_0x79d128[_0x3a4f2e(0x198)]()[_0x3a4f2e(0x15f)]('T')[0x0];const _0x439e21=await product[_0x3a4f2e(0x22c)]([{'$group':{'_id':{'brand':_0x3a4f2e(0x227),'category':_0x3a4f2e(0x22e)},'products':{'$push':{'name':_0x3a4f2e(0x1ce),'product_code':_0x3a4f2e(0x1c1)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2c464a=[];_0x2c464a[_0x3a4f2e(0x205)]=[];for(let _0x27e59a=0x0;_0x27e59a<=_0x439e21[_0x3a4f2e(0x2bf)]-0x1;_0x27e59a++){const _0x2224f8=_0x439e21[_0x27e59a];_0x2c464a[_0x3a4f2e(0x205)][_0x3a4f2e(0x190)](_0x2224f8);}const _0x5e6be1=await product[_0x3a4f2e(0x22c)]([{'$group':{'_id':{'category':_0x3a4f2e(0x22e)},'products':{'$push':{'brand':_0x3a4f2e(0x227),'product_code':_0x3a4f2e(0x1c1),'product_name':_0x3a4f2e(0x1ce)}}}},{'$sort':{'_id.category':-0x1}}]),_0x176b43=await product[_0x3a4f2e(0x22c)]([{'$group':{'_id':{'category':_0x3a4f2e(0x22e),'brand':'$brand'}}},{'$group':{'_id':_0x3a4f2e(0x161),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3d4cc3=await sales_sa[_0x3a4f2e(0x22c)]([{'$match':{'date':_0x228dc8,'sales_staff_id':_0x588a6d,'sale_product.isFG':_0x3a4f2e(0x269)}},{'$unwind':_0x3a4f2e(0x29b)},{'$lookup':{'from':_0x3a4f2e(0x2b6),'localField':'sale_product.product_code','foreignField':_0x3a4f2e(0x14f),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x3a4f2e(0x23b),'date':'$date','customer':'$customer','status_data':_0x3a4f2e(0x2be)},'totalQty':{'$sum':_0x3a4f2e(0x25b)},'cash':{'$first':_0x3a4f2e(0x15e)},'amount':{'$first':_0x3a4f2e(0x183)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x3a4f2e(0x208)},'due_date':{'$first':_0x3a4f2e(0x288)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x3a4f2e(0x19e),'adj_discount':_0x3a4f2e(0x24a),'product_details':{'prod_name':_0x3a4f2e(0x1a8),'product_code':_0x3a4f2e(0x262),'category':_0x3a4f2e(0x1bc),'brand':_0x3a4f2e(0x286),'gross_price':'$product_info.gross_price','isFG':_0x3a4f2e(0x141),'prod_cat':'$sale_product.prod_cat','prod_id':_0x3a4f2e(0x234)}}}}},{'$unwind':_0x3a4f2e(0x25e)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3a4f2e(0x251),'customer':'$_id.customer','status_data':_0x3a4f2e(0x266),'category':_0x3a4f2e(0x25f),'brand':_0x3a4f2e(0x1a4),'prod_id':_0x3a4f2e(0x21a)},'totalQty':{'$sum':_0x3a4f2e(0x146)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x3a4f2e(0x1e5)]}},'NetPrice':{'$sum':_0x3a4f2e(0x2a8)},'discount':{'$sum':_0x3a4f2e(0x292)},'adj_discount':{'$sum':_0x3a4f2e(0x2ac)},'cash':{'$first':_0x3a4f2e(0x15e)},'amount':{'$first':_0x3a4f2e(0x183)},'bank':{'$first':_0x3a4f2e(0x1cc)},'check_no':{'$first':_0x3a4f2e(0x208)},'due_date':{'$first':_0x3a4f2e(0x288)},'product_details':{'$first':_0x3a4f2e(0x265)}}},{'$group':{'_id':{'dsi':_0x3a4f2e(0x20e),'date':_0x3a4f2e(0x251),'customer':'$_id.customer','status_data':_0x3a4f2e(0x266)},'totalQty':{'$sum':_0x3a4f2e(0x1b5)},'totalGross':{'$sum':_0x3a4f2e(0x23d)},'NetPrice':{'$sum':_0x3a4f2e(0x21c)},'discount':{'$sum':_0x3a4f2e(0x216)},'adj_discount':{'$sum':_0x3a4f2e(0x248)},'cash':{'$first':'$cash'},'amount':{'$first':_0x3a4f2e(0x183)},'bank':{'$first':_0x3a4f2e(0x1cc)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3a4f2e(0x288)},'products':{'$push':{'qty':_0x3a4f2e(0x1b5),'category':'$_id.category','brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x182c44=await sales_sa[_0x3a4f2e(0x22c)]([{'$match':{'date':_0x3ff17e,'sales_staff_id':_0x588a6d,'sale_product.isFG':_0x3a4f2e(0x269)}},{'$unwind':_0x3a4f2e(0x29b)},{'$lookup':{'from':_0x3a4f2e(0x2b6),'localField':_0x3a4f2e(0x240),'foreignField':_0x3a4f2e(0x14f),'as':_0x3a4f2e(0x1e6)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':_0x3a4f2e(0x1f9),'customer':_0x3a4f2e(0x1a0)},'totalQty':{'$sum':_0x3a4f2e(0x25b)},'cash':{'$first':_0x3a4f2e(0x15e)},'amount':{'$first':_0x3a4f2e(0x183)},'bank':{'$first':_0x3a4f2e(0x1cc)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3a4f2e(0x288)},'products':{'$push':{'qty':_0x3a4f2e(0x25b),'NetPrice':_0x3a4f2e(0x1be),'discount':_0x3a4f2e(0x19e),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':_0x3a4f2e(0x262),'category':_0x3a4f2e(0x1bc),'brand':'$product_info.brand','gross_price':_0x3a4f2e(0x23e),'isFG':_0x3a4f2e(0x141),'prod_cat':'$sale_product.prod_cat','prod_id':_0x3a4f2e(0x234)}}}}},{'$unwind':_0x3a4f2e(0x25e)},{'$group':{'_id':{'dsi':_0x3a4f2e(0x20e),'date':_0x3a4f2e(0x251),'customer':_0x3a4f2e(0x1b3),'category':_0x3a4f2e(0x25f),'brand':_0x3a4f2e(0x1a4),'prod_id':_0x3a4f2e(0x21a)},'totalQty':{'$sum':_0x3a4f2e(0x146)},'cash':{'$first':_0x3a4f2e(0x15e)},'amount':{'$first':'$amount'},'bank':{'$first':_0x3a4f2e(0x1cc)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3a4f2e(0x288)},'totalGross':{'$sum':{'$multiply':[_0x3a4f2e(0x146),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x3a4f2e(0x2a8)},'discount':{'$sum':_0x3a4f2e(0x292)},'adj_discount':{'$sum':_0x3a4f2e(0x2ac)},'product_details':{'$first':_0x3a4f2e(0x265)}}},{'$group':{'_id':{'dsi':_0x3a4f2e(0x20e),'date':_0x3a4f2e(0x251),'customer':_0x3a4f2e(0x1b3)},'totalQty':{'$sum':_0x3a4f2e(0x1b5)},'cash':{'$first':'$cash'},'amount':{'$first':_0x3a4f2e(0x183)},'bank':{'$first':_0x3a4f2e(0x1cc)},'check_no':{'$first':_0x3a4f2e(0x208)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':_0x3a4f2e(0x23d)},'NetPrice':{'$sum':_0x3a4f2e(0x21c)},'discount':{'$sum':_0x3a4f2e(0x216)},'adj_discount':{'$sum':_0x3a4f2e(0x248)},'products':{'$push':{'qty':_0x3a4f2e(0x1b5),'category':_0x3a4f2e(0x161),'brand':_0x3a4f2e(0x1b8),'product_details':_0x3a4f2e(0x2c2)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5f3c8c=await sales_sa[_0x3a4f2e(0x22c)]([{'$match':{'date':_0x228dc8,'sales_staff_id':_0x588a6d,'status_data':'true'}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x1a48a4=await staff[_0x3a4f2e(0x1a6)](_0x588a6d);let _0xb2dd09=[],_0x201259={},_0x38165f={};var _0x5b4288=0x0,_0x318c7d=0x0,_0x3921ad=0x0,_0x553cc9=0x0,_0x709a31=0x0;const _0x4495bb=0x6;var _0xc2e816=0x0,_0xfa53dd=0x0;for(let _0x1c7a5d=0x0;_0x1c7a5d<=_0x3d4cc3['length']-0x1;_0x1c7a5d++){const _0x3a3ddd=_0x3d4cc3[_0x1c7a5d];let _0x4433e4='<tr>';_0x4433e4+=_0x3a4f2e(0x2c7),_0x4433e4+=_0x3a4f2e(0x1f3)+_0x3a3ddd['_id'][_0x3a4f2e(0x1ec)]+_0x3a4f2e(0x204),_0x4433e4+=_0x3a4f2e(0x1f3)+_0x3a3ddd['_id']['dsi']+'</td>';let _0x59d3ec={},_0x22d06b={},_0xeba4d7={};var _0x2ffc60={},_0x48d5fb={},_0x57f1d6={},_0x1172c4=0x0;for(let _0x1b4585=0x0;_0x1b4585<=_0x3a3ddd[_0x3a4f2e(0x2b6)]['length']-0x1;_0x1b4585++){const _0x35444c=_0x3a3ddd[_0x3a4f2e(0x2b6)][_0x1b4585];_0x59d3ec[_0x35444c[_0x3a4f2e(0x1e2)]+'-'+_0x35444c[_0x3a4f2e(0x297)]]=_0x35444c[_0x3a4f2e(0x178)],_0x22d06b[[_0x35444c[_0x3a4f2e(0x1e2)]+'-'+_0x35444c[_0x3a4f2e(0x297)]]]=_0x35444c[_0x3a4f2e(0x181)][_0x3a4f2e(0x175)],_0xeba4d7[[_0x35444c['brand']+'-'+_0x35444c[_0x3a4f2e(0x297)]]]=_0x35444c[_0x3a4f2e(0x181)][_0x3a4f2e(0x15a)];const _0x24c705=_0x35444c[_0x3a4f2e(0x1e2)]+'-'+_0x35444c[_0x3a4f2e(0x297)];!Array['isArray'](_0x38165f[_0x24c705])&&(_0x38165f[_0x24c705]=[]);!Array[_0x3a4f2e(0x277)](_0x38165f[_0x24c705])&&(_0x38165f[_0x24c705]=[]);_0x38165f[_0x24c705][_0x3a4f2e(0x190)](_0x35444c['qty']);if(_0x35444c[_0x3a4f2e(0x181)][_0x3a4f2e(0x15a)]=='P')_0x35444c[_0x3a4f2e(0x181)][_0x3a4f2e(0x175)]==_0x3a4f2e(0x1f4)?(!_0x57f1d6[_0x24c705]&&(_0x57f1d6[_0x24c705]=0x0),_0x57f1d6[_0x24c705]=_0x35444c['qty']):(!_0x2ffc60[_0x24c705]&&(_0x2ffc60[_0x24c705]=0x0),_0x2ffc60[_0x24c705]=_0x35444c[_0x3a4f2e(0x178)]);else _0x35444c[_0x3a4f2e(0x181)][_0x3a4f2e(0x15a)]=='S'&&(_0x35444c['product_details'][_0x3a4f2e(0x175)]==_0x3a4f2e(0x1f4)?(!_0x57f1d6[_0x24c705]&&(_0x57f1d6[_0x24c705]=0x0),_0x57f1d6[_0x24c705]=_0x35444c[_0x3a4f2e(0x178)]):(!_0x48d5fb[_0x24c705]&&(_0x48d5fb[_0x24c705]=0x0),_0x48d5fb[_0x24c705]=_0x35444c[_0x3a4f2e(0x178)]));_0x1172c4++;}for(let _0x3cbcc7=0x0;_0x3cbcc7<=_0x2c464a[_0x3a4f2e(0x205)][_0x3a4f2e(0x2bf)]-0x1;_0x3cbcc7++){const _0x670217=_0x2c464a[_0x3a4f2e(0x205)][_0x3cbcc7],_0x37894b=_0x670217[_0x3a4f2e(0x275)][_0x3a4f2e(0x1e2)]+'-'+_0x670217[_0x3a4f2e(0x275)][_0x3a4f2e(0x297)],_0x2bcc81=_0xeba4d7[_0x37894b]!==undefined?_0xeba4d7[_0x37894b]:'NA';var _0x47ebd5=_0x2ffc60[_0x37894b]!==undefined?_0x2ffc60[_0x37894b][_0x3a4f2e(0x273)](0x2):'',_0x1bdbf7=_0x48d5fb[_0x37894b]!==undefined?_0x48d5fb[_0x37894b][_0x3a4f2e(0x273)](0x2):'',_0x593101=_0x57f1d6[_0x37894b]!==undefined?_0x57f1d6[_0x37894b][_0x3a4f2e(0x273)](0x2):'';_0x4433e4+=_0x3a4f2e(0x194)+_0x47ebd5+_0x3a4f2e(0x204),_0x4433e4+=_0x3a4f2e(0x194)+_0x1bdbf7+'</td>',_0x4433e4+=_0x3a4f2e(0x194)+_0x593101+_0x3a4f2e(0x204);}var _0x482d01=formatNumber(parseFloat(_0x3a3ddd[_0x3a4f2e(0x1fe)])),_0x52f820=formatNumber(parseFloat(_0x3a3ddd[_0x3a4f2e(0x1e3)]));isNaN(_0x52f820)&&(_0x52f820=0x0),_0x4433e4+=_0x3a4f2e(0x194)+_0x482d01+_0x3a4f2e(0x204),_0x4433e4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x52f820+_0x3a4f2e(0x204),_0x4433e4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3a3ddd[_0x3a4f2e(0x1db)]+_0x3a4f2e(0x204),_0x4433e4+=_0x3a4f2e(0x1f3)+_0x3a3ddd[_0x3a4f2e(0x264)]+'</td>',_0x4433e4+=_0x3a4f2e(0x1f3)+_0x3a3ddd['due_date']+_0x3a4f2e(0x204),_0x3921ad=_0x3a3ddd[_0x3a4f2e(0x220)]+_0x3a3ddd['adj_discount'],_0xc2e816+=parseFloat(_0x3a3ddd[_0x3a4f2e(0x1fe)]),_0xfa53dd+=parseFloat(_0x52f820),_0xb2dd09[_0x3a4f2e(0x190)](_0x4433e4);}if(_0x5f3c8c[_0x3a4f2e(0x2bf)]>0x0)for(let _0xa77963=0x0;_0xa77963<=_0x5f3c8c[_0x3a4f2e(0x2bf)]-0x1;_0xa77963++){const _0x13de76=_0x5f3c8c[_0xa77963];console[_0x3a4f2e(0x196)](_0x13de76);let _0x2a9ddb=_0x3a4f2e(0x2c6);_0x2a9ddb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22'+(0x8+0x7*0x3)+_0x3a4f2e(0x23a)+_0x13de76[_0x3a4f2e(0x2af)]+'</b></td>',_0x2a9ddb+=_0x3a4f2e(0x1b9),_0xb2dd09[_0x3a4f2e(0x190)](_0x2a9ddb);}function _0x2728d5(_0x44a2c8,_0x299b42){const _0x5611a5=_0x3a4f2e,_0x33798b=[];for(let _0x454845=0x0;_0x454845<=_0x44a2c8[_0x5611a5(0x2bf)]-0x1;_0x454845+=_0x299b42){_0x33798b['push'](_0x44a2c8[_0x5611a5(0x1af)](_0x454845,_0x454845+_0x299b42));}return _0x33798b;}const _0x126abb=_0x2728d5(_0xb2dd09,_0x4495bb);let _0x51fce5='';return _0x126abb[_0x3a4f2e(0x1cb)]((_0x4c2e08,_0x32b61b)=>{const _0x2be2a6=_0x3a4f2e;_0x32b61b>0x0&&(_0x51fce5+=_0x2be2a6(0x19a));_0x51fce5+=_0x2be2a6(0x184),_0x51fce5+=_0x2be2a6(0x1f0);const _0x81545d=new Date(_0x228dc8),_0xcc921={'year':_0x2be2a6(0x278),'month':_0x2be2a6(0x213),'day':_0x2be2a6(0x278),'timeZone':_0x2be2a6(0x22a)},_0x221766=_0x81545d['toLocaleDateString']('en-US',_0xcc921);_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x271)+_0x4c64eb+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0x1a48a4[_0x2be2a6(0x2c4)]+_0x2be2a6(0x204),_0x51fce5+=_0x2be2a6(0x158),_0x51fce5+=_0x2be2a6(0x242),_0x51fce5+=_0x2be2a6(0x1c3),_0x51fce5+=_0x2be2a6(0x22d),_0x51fce5+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x51fce5+=_0x2be2a6(0x20a),_0x51fce5+=_0x2be2a6(0x270),_0x51fce5+='<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>',_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x14e),_0x51fce5+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20'+_0x221766+'</td>',_0x51fce5+=_0x2be2a6(0x2cc),_0x51fce5+=_0x2be2a6(0x27c),_0x51fce5+=_0x2be2a6(0x155),_0x51fce5+=_0x2be2a6(0x155),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x1ef),_0x51fce5+=_0x2be2a6(0x17f),_0x51fce5+=_0x2be2a6(0x2a7),_0x51fce5+=_0x2be2a6(0x155),_0x51fce5+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x1e8),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x51fce5+=_0x2be2a6(0x1fd),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x170),_0x51fce5+=_0x2be2a6(0x17e),_0x51fce5+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x40e7a9=0x0;_0x40e7a9<=_0x5e6be1['length']-0x1;_0x40e7a9++){const _0x9a40a3=_0x5e6be1[_0x40e7a9];for(let _0x5f44a5=0x0;_0x5f44a5<_0x2c464a[_0x2be2a6(0x205)][_0x2be2a6(0x2bf)];_0x5f44a5++){const _0x12cdb0=_0x2c464a['cat_brand'][_0x5f44a5];if(_0x12cdb0[_0x2be2a6(0x275)][_0x2be2a6(0x297)]===_0x9a40a3[_0x2be2a6(0x275)][_0x2be2a6(0x297)]){var _0x536f4b='';switch(_0x9a40a3['_id']['category']){case _0x2be2a6(0x147):_0x536f4b=_0x12cdb0['_id'][_0x2be2a6(0x1e2)]+'\x20-\x20STD';break;case _0x2be2a6(0x140):_0x536f4b=_0x12cdb0[_0x2be2a6(0x275)][_0x2be2a6(0x1e2)]+'\x20-\x20HH';break;default:_0x536f4b=_0x12cdb0[_0x2be2a6(0x275)][_0x2be2a6(0x1e2)];break;}_0x51fce5+=_0x2be2a6(0x2c8)+_0x536f4b+_0x2be2a6(0x2b3);}}}_0x51fce5+=_0x2be2a6(0x150),_0x51fce5+=_0x2be2a6(0x2a4),_0x51fce5+=_0x2be2a6(0x2c0),_0x51fce5+='</tr>',_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x2cb);for(let _0x4c4123=0x0;_0x4c4123<=_0x2c464a[_0x2be2a6(0x205)]['length']-0x1;_0x4c4123++){const _0x262ac7=_0x2c464a[_0x4c4123];_0x51fce5+=_0x2be2a6(0x215),_0x51fce5+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x51fce5+=_0x2be2a6(0x151);}_0x51fce5+=_0x2be2a6(0x1b4),_0x51fce5+=_0x2be2a6(0x1c4),_0x51fce5+=_0x2be2a6(0x199),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x142),_0x51fce5+=_0x2be2a6(0x1d2),_0x4c2e08[_0x2be2a6(0x1cb)](_0x319795=>{_0x51fce5+=_0x319795;});let _0x2abcd6={},_0x3ed9fe={},_0x522c6c={};for(let _0x15b89a=0x0;_0x15b89a<=_0x3d4cc3[_0x2be2a6(0x2bf)]-0x1;_0x15b89a++){const _0x3bcf31=_0x3d4cc3[_0x15b89a];var _0x8dff3c=0x0;for(let _0x5da83d=0x0;_0x5da83d<=_0x3bcf31['products'][_0x2be2a6(0x2bf)]-0x1;_0x5da83d++){const _0x22aaf6=_0x3bcf31['products'][_0x5da83d],_0x1ed2c3=_0x22aaf6[_0x2be2a6(0x1e2)]+'-'+_0x22aaf6['category'];if(_0x22aaf6['product_details'][_0x2be2a6(0x15a)]=='P')_0x22aaf6['product_details']['isFG']==_0x2be2a6(0x1f4)?(!_0x522c6c[_0x1ed2c3]&&(_0x522c6c[_0x1ed2c3]=0x0),_0x522c6c[_0x1ed2c3]+=_0x22aaf6[_0x2be2a6(0x178)]):(!_0x2abcd6[_0x1ed2c3]&&(_0x2abcd6[_0x1ed2c3]=0x0),_0x2abcd6[_0x1ed2c3]+=_0x22aaf6[_0x2be2a6(0x178)]);else _0x22aaf6[_0x2be2a6(0x181)][_0x2be2a6(0x15a)]=='S'&&(_0x22aaf6['product_details'][_0x2be2a6(0x175)]==_0x2be2a6(0x1f4)?(!_0x522c6c[_0x1ed2c3]&&(_0x522c6c[_0x1ed2c3]=0x0),_0x522c6c[_0x1ed2c3]+=_0x22aaf6[_0x2be2a6(0x178)],console[_0x2be2a6(0x196)](_0x22aaf6[_0x2be2a6(0x178)])):(!_0x3ed9fe[_0x1ed2c3]&&(_0x3ed9fe[_0x1ed2c3]=0x0),_0x3ed9fe[_0x1ed2c3]+=_0x22aaf6['qty']));_0x8dff3c++;}}let _0x788be5={},_0x5289b8={},_0x28f3cb={};var _0x1af221=0x0,_0x598c90=0x0;for(let _0x4a09d8=0x0;_0x4a09d8<=_0x182c44[_0x2be2a6(0x2bf)]-0x1;_0x4a09d8++){const _0x33d78c=_0x182c44[_0x4a09d8];var _0x8dff3c=0x0;for(let _0x39d512=0x0;_0x39d512<=_0x33d78c[_0x2be2a6(0x2b6)][_0x2be2a6(0x2bf)]-0x1;_0x39d512++){const _0x3a7882=_0x33d78c[_0x2be2a6(0x2b6)][_0x39d512],_0x1a2618=_0x3a7882[_0x2be2a6(0x1e2)]+'-'+_0x3a7882[_0x2be2a6(0x297)];if(_0x3a7882[_0x2be2a6(0x181)][_0x2be2a6(0x15a)]=='P')_0x3a7882[_0x2be2a6(0x181)][_0x2be2a6(0x175)]==_0x2be2a6(0x1f4)?(!_0x28f3cb[_0x1a2618]&&(_0x28f3cb[_0x1a2618]=0x0),_0x28f3cb[_0x1a2618]+=_0x3a7882[_0x2be2a6(0x178)]):(!_0x788be5[_0x1a2618]&&(_0x788be5[_0x1a2618]=0x0),_0x788be5[_0x1a2618]+=_0x3a7882[_0x2be2a6(0x178)]);else _0x3a7882['product_details'][_0x2be2a6(0x15a)]=='S'&&(_0x3a7882[_0x2be2a6(0x181)][_0x2be2a6(0x175)]==_0x2be2a6(0x1f4)?(!_0x28f3cb[_0x1a2618]&&(_0x28f3cb[_0x1a2618]=0x0),_0x28f3cb[_0x1a2618]+=_0x3a7882[_0x2be2a6(0x178)]):(!_0x5289b8[_0x1a2618]&&(_0x5289b8[_0x1a2618]=0x0),_0x5289b8[_0x1a2618]+=_0x3a7882['qty']));_0x8dff3c++;}var _0x24180d=parseFloat(_0x33d78c['cash']),_0x3d2eb3=parseFloat(_0x33d78c[_0x2be2a6(0x1e3)]);isNaN(_0x3d2eb3)&&(_0x3d2eb3=0x0),_0x1af221+=_0x24180d,_0x598c90+=_0x3d2eb3;}_0x51fce5+='<tr>',_0x51fce5+=_0x2be2a6(0x18c),_0x51fce5+=_0x2be2a6(0x1dc),_0x51fce5+=_0x2be2a6(0x2c7);for(let _0x7eb5e1=0x0;_0x7eb5e1<=_0x2c464a['cat_brand'][_0x2be2a6(0x2bf)]-0x1;_0x7eb5e1++){const _0x92952c=_0x2c464a['cat_brand'][_0x7eb5e1],_0x5b5ef3=_0x92952c[_0x2be2a6(0x275)][_0x2be2a6(0x1e2)]+'-'+_0x92952c[_0x2be2a6(0x275)][_0x2be2a6(0x297)];var _0x1a51e0=_0x2abcd6[_0x5b5ef3]!==undefined?formatNumber(_0x2abcd6[_0x5b5ef3]['toFixed'](0x2)):'',_0x2117d0=_0x522c6c[_0x5b5ef3]!==undefined?formatNumber(_0x522c6c[_0x5b5ef3][_0x2be2a6(0x273)](0x2)):'',_0x5796e5=_0x3ed9fe[_0x5b5ef3]!==undefined?formatNumber(_0x3ed9fe[_0x5b5ef3][_0x2be2a6(0x273)](0x2)):'';_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1a51e0+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+_0x5796e5+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+_0x2117d0+'</b></td>';}_0x51fce5+=_0x2be2a6(0x144)+formatNumber(_0xc2e816)+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+formatNumber(_0xfa53dd)+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x18c),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>',_0x51fce5+=_0x2be2a6(0x2c7);for(let _0x443eaf=0x0;_0x443eaf<=_0x2c464a[_0x2be2a6(0x205)]['length']-0x1;_0x443eaf++){const _0x1c8827=_0x2c464a[_0x2be2a6(0x205)][_0x443eaf],_0x26c113=_0x1c8827[_0x2be2a6(0x275)][_0x2be2a6(0x1e2)]+'-'+_0x1c8827[_0x2be2a6(0x275)][_0x2be2a6(0x297)];var _0x1a51e0=_0x788be5[_0x26c113]!==undefined?formatNumber(_0x788be5[_0x26c113][_0x2be2a6(0x273)](0x2)):'',_0x2117d0=_0x28f3cb[_0x26c113]!==undefined?formatNumber(_0x28f3cb[_0x26c113]['toFixed'](0x2)):'',_0x5796e5=_0x5289b8[_0x26c113]!==undefined?formatNumber(_0x5289b8[_0x26c113][_0x2be2a6(0x273)](0x2)):'';_0x51fce5+=_0x2be2a6(0x144)+_0x1a51e0+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+_0x5796e5+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+_0x2117d0+'</b></td>';}_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1af221)+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+formatNumber(_0x598c90)+_0x2be2a6(0x2b3),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+='<tr>',_0x51fce5+=_0x2be2a6(0x18c),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x51fce5+=_0x2be2a6(0x2c7);let _0x2bb535=0x0,_0x82da56=0x0,_0x3733e2=0x0;for(let _0x4d09a6=0x0;_0x4d09a6<=_0x2c464a['cat_brand']['length']-0x1;_0x4d09a6++){const _0x3f0890=_0x2c464a[_0x2be2a6(0x205)][_0x4d09a6],_0x18df91=_0x3f0890[_0x2be2a6(0x275)][_0x2be2a6(0x1e2)]+'-'+_0x3f0890[_0x2be2a6(0x275)]['category'];var _0x13d1fa=_0x2abcd6[_0x18df91]!==undefined?_0x2abcd6[_0x18df91][_0x2be2a6(0x273)](0x2):'0',_0x16ece9=_0x522c6c[_0x18df91]!==undefined?_0x522c6c[_0x18df91][_0x2be2a6(0x273)](0x2):'0',_0xf84675=_0x3ed9fe[_0x18df91]!==undefined?_0x3ed9fe[_0x18df91][_0x2be2a6(0x273)](0x2):'0',_0xef753d=_0x788be5[_0x18df91]!==undefined?_0x788be5[_0x18df91][_0x2be2a6(0x273)](0x2):'0',_0x1eebbc=_0x28f3cb[_0x18df91]!==undefined?_0x28f3cb[_0x18df91][_0x2be2a6(0x273)](0x2):'0',_0x45d22f=_0x5289b8[_0x18df91]!==undefined?_0x5289b8[_0x18df91]['toFixed'](0x2):'0';_0x2bb535=parseFloat(_0x13d1fa)+parseFloat(_0xef753d),_0x82da56=parseFloat(_0xf84675)+parseFloat(_0x45d22f),_0x3733e2=parseFloat(_0x16ece9)+parseFloat(_0x1eebbc),_0x51fce5+=_0x2be2a6(0x144)+formatNumber(_0x2bb535[_0x2be2a6(0x273)](0x2))+_0x2be2a6(0x2b3),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x82da56[_0x2be2a6(0x273)](0x2))+_0x2be2a6(0x2b3),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3733e2[_0x2be2a6(0x273)](0x2))+'</b></td>';}var _0x5d353e=formatNumber(_0xc2e816+_0x1af221),_0x3d9a25=formatNumber(_0xfa53dd+_0x598c90);_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x5d353e+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+_0x3d9a25+_0x2be2a6(0x2b3),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x2c464a['cat_brand']['length']*0x3+0x9)+_0x2be2a6(0x20d),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+='<tr>',_0x51fce5+=_0x2be2a6(0x18c),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x45015e=0x0;_0x45015e<=_0x2c464a['cat_brand']['length']-0x1;_0x45015e++){const _0x1d8c0e=_0x2c464a[_0x2be2a6(0x205)][_0x45015e],_0xbe5ed4=_0x1d8c0e[_0x2be2a6(0x275)]['brand']+'-'+_0x1d8c0e[_0x2be2a6(0x275)][_0x2be2a6(0x297)];var _0x13d1fa=_0x2abcd6[_0xbe5ed4]!==undefined?_0x2abcd6[_0xbe5ed4][_0x2be2a6(0x273)](0x2):'0',_0x16ece9=_0x522c6c[_0xbe5ed4]!==undefined?_0x522c6c[_0xbe5ed4][_0x2be2a6(0x273)](0x2):'0',_0xf84675=_0x3ed9fe[_0xbe5ed4]!==undefined?_0x3ed9fe[_0xbe5ed4][_0x2be2a6(0x273)](0x2):'0',_0xef753d=_0x788be5[_0xbe5ed4]!==undefined?_0x788be5[_0xbe5ed4][_0x2be2a6(0x273)](0x2):'0',_0x1eebbc=_0x28f3cb[_0xbe5ed4]!==undefined?_0x28f3cb[_0xbe5ed4]['toFixed'](0x2):'0',_0x45d22f=_0x5289b8[_0xbe5ed4]!==undefined?_0x5289b8[_0xbe5ed4][_0x2be2a6(0x273)](0x2):'0';_0x2bb535=parseFloat(_0x13d1fa)+parseFloat(_0xef753d),_0x82da56=parseFloat(_0xf84675)+parseFloat(_0x45d22f),_0x3733e2=parseFloat(_0x16ece9)+parseFloat(_0x1eebbc),_0x51fce5+=_0x2be2a6(0x1d1),_0x51fce5+=_0x2be2a6(0x1d1),_0x51fce5+=_0x2be2a6(0x1d1);}_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+='</tr>',_0x51fce5+='<tr>',_0x51fce5+=_0x2be2a6(0x18c),_0x51fce5+=_0x2be2a6(0x2ae),_0x51fce5+=_0x2be2a6(0x2c7);for(let _0x38b08d=0x0;_0x38b08d<=_0x2c464a['cat_brand'][_0x2be2a6(0x2bf)]-0x1;_0x38b08d++){const _0x429e8e=_0x2c464a[_0x2be2a6(0x205)][_0x38b08d],_0x4cdb84=_0x429e8e[_0x2be2a6(0x275)][_0x2be2a6(0x1e2)]+'-'+_0x429e8e[_0x2be2a6(0x275)][_0x2be2a6(0x297)];var _0x13d1fa=_0x2abcd6[_0x4cdb84]!==undefined?_0x2abcd6[_0x4cdb84][_0x2be2a6(0x273)](0x2):'0',_0x16ece9=_0x522c6c[_0x4cdb84]!==undefined?_0x522c6c[_0x4cdb84][_0x2be2a6(0x273)](0x2):'0',_0xf84675=_0x3ed9fe[_0x4cdb84]!==undefined?_0x3ed9fe[_0x4cdb84][_0x2be2a6(0x273)](0x2):'0',_0xef753d=_0x788be5[_0x4cdb84]!==undefined?_0x788be5[_0x4cdb84][_0x2be2a6(0x273)](0x2):'0',_0x1eebbc=_0x28f3cb[_0x4cdb84]!==undefined?_0x28f3cb[_0x4cdb84][_0x2be2a6(0x273)](0x2):'0',_0x45d22f=_0x5289b8[_0x4cdb84]!==undefined?_0x5289b8[_0x4cdb84]['toFixed'](0x2):'0';_0x2bb535=parseFloat(_0x13d1fa)+parseFloat(_0xef753d),_0x82da56=parseFloat(_0xf84675)+parseFloat(_0x45d22f),_0x3733e2=parseFloat(_0x16ece9)+parseFloat(_0x1eebbc),_0x51fce5+=_0x2be2a6(0x1d1),_0x51fce5+=_0x2be2a6(0x1d1),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x18c),_0x51fce5+=_0x2be2a6(0x16b),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x53b671=0x0;_0x53b671<=_0x2c464a[_0x2be2a6(0x205)][_0x2be2a6(0x2bf)]-0x1;_0x53b671++){const _0x4b4c4a=_0x2c464a[_0x2be2a6(0x205)][_0x53b671],_0x3fc598=_0x4b4c4a[_0x2be2a6(0x275)][_0x2be2a6(0x1e2)]+'-'+_0x4b4c4a[_0x2be2a6(0x275)][_0x2be2a6(0x297)];var _0x13d1fa=_0x2abcd6[_0x3fc598]!==undefined?_0x2abcd6[_0x3fc598][_0x2be2a6(0x273)](0x2):'0',_0x16ece9=_0x522c6c[_0x3fc598]!==undefined?_0x522c6c[_0x3fc598]['toFixed'](0x2):'0',_0xf84675=_0x3ed9fe[_0x3fc598]!==undefined?_0x3ed9fe[_0x3fc598][_0x2be2a6(0x273)](0x2):'0',_0xef753d=_0x788be5[_0x3fc598]!==undefined?_0x788be5[_0x3fc598][_0x2be2a6(0x273)](0x2):'0',_0x1eebbc=_0x28f3cb[_0x3fc598]!==undefined?_0x28f3cb[_0x3fc598]['toFixed'](0x2):'0',_0x45d22f=_0x5289b8[_0x3fc598]!==undefined?_0x5289b8[_0x3fc598]['toFixed'](0x2):'0';_0x2bb535=parseFloat(_0x13d1fa)+parseFloat(_0xef753d),_0x82da56=parseFloat(_0xf84675)+parseFloat(_0x45d22f),_0x3733e2=parseFloat(_0x16ece9)+parseFloat(_0x1eebbc),_0x51fce5+=_0x2be2a6(0x1d1),_0x51fce5+=_0x2be2a6(0x1d1),_0x51fce5+=_0x2be2a6(0x1d1);}_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x18c),_0x51fce5+=_0x2be2a6(0x1dc),_0x51fce5+=_0x2be2a6(0x2c7);for(let _0x33905e=0x0;_0x33905e<=_0x2c464a[_0x2be2a6(0x205)]['length']-0x1;_0x33905e++){const _0x595672=_0x2c464a['cat_brand'][_0x33905e],_0x4571dd=_0x595672[_0x2be2a6(0x275)]['brand']+'-'+_0x595672[_0x2be2a6(0x275)][_0x2be2a6(0x297)];var _0x13d1fa=_0x2abcd6[_0x4571dd]!==undefined?_0x2abcd6[_0x4571dd]['toFixed'](0x2):'',_0x16ece9=_0x522c6c[_0x4571dd]!==undefined?_0x522c6c[_0x4571dd][_0x2be2a6(0x273)](0x2):'',_0xf84675=_0x3ed9fe[_0x4571dd]!==undefined?_0x3ed9fe[_0x4571dd][_0x2be2a6(0x273)](0x2):'',_0xef753d=_0x788be5[_0x4571dd]!==undefined?_0x788be5[_0x4571dd][_0x2be2a6(0x273)](0x2):'',_0x1eebbc=_0x28f3cb[_0x4571dd]!==undefined?_0x28f3cb[_0x4571dd]['toFixed'](0x2):'',_0x45d22f=_0x5289b8[_0x4571dd]!==undefined?_0x5289b8[_0x4571dd][_0x2be2a6(0x273)](0x2):'';_0x2bb535=formatNumber(parseFloat(_0x13d1fa)+parseFloat(_0xef753d)),_0x82da56=formatNumber(parseFloat(_0xf84675)+parseFloat(_0x45d22f)),_0x3733e2=formatNumber(parseFloat(_0x16ece9)+parseFloat(_0x1eebbc)),_0x51fce5+=_0x2be2a6(0x144)+_0x13d1fa+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+_0xf84675+_0x2be2a6(0x2b3),_0x51fce5+=_0x2be2a6(0x144)+_0x16ece9+_0x2be2a6(0x2b3);}_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x2c6),_0x51fce5+=_0x2be2a6(0x18c),_0x51fce5+=_0x2be2a6(0x172),_0x51fce5+=_0x2be2a6(0x2c7);for(let _0xb239d=0x0;_0xb239d<=_0x2c464a[_0x2be2a6(0x205)]['length']-0x1;_0xb239d++){const _0x54bcdd=_0x2c464a[_0x2be2a6(0x205)][_0xb239d],_0x256128=_0x54bcdd[_0x2be2a6(0x275)][_0x2be2a6(0x1e2)]+'-'+_0x54bcdd[_0x2be2a6(0x275)][_0x2be2a6(0x297)];var _0x13d1fa=_0x2abcd6[_0x256128]!==undefined?_0x2abcd6[_0x256128][_0x2be2a6(0x273)](0x2):'0',_0x16ece9=_0x522c6c[_0x256128]!==undefined?_0x522c6c[_0x256128]['toFixed'](0x2):'0',_0xf84675=_0x3ed9fe[_0x256128]!==undefined?_0x3ed9fe[_0x256128][_0x2be2a6(0x273)](0x2):'0',_0xef753d=_0x788be5[_0x256128]!==undefined?_0x788be5[_0x256128][_0x2be2a6(0x273)](0x2):'0',_0x1eebbc=_0x28f3cb[_0x256128]!==undefined?_0x28f3cb[_0x256128]['toFixed'](0x2):'0',_0x45d22f=_0x5289b8[_0x256128]!==undefined?_0x5289b8[_0x256128]['toFixed'](0x2):'0';_0x2bb535=parseFloat(_0x13d1fa)+parseFloat(_0xef753d),_0x82da56=parseFloat(_0xf84675)+parseFloat(_0x45d22f),_0x3733e2=parseFloat(_0x16ece9)+parseFloat(_0x1eebbc),_0x51fce5+=_0x2be2a6(0x1d1),_0x51fce5+=_0x2be2a6(0x1d1),_0x51fce5+=_0x2be2a6(0x1d1);}_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x2c7),_0x51fce5+=_0x2be2a6(0x1b9),_0x51fce5+=_0x2be2a6(0x1ab),_0x51fce5+=_0x2be2a6(0x28f);}),_0x51fce5;}async function generateReferenceNumber(_0x4b2a7f,_0x4a0e84,_0x48c1a1){const _0x5deb8f=a0_0x412553,_0xa7e5cc=new Date(_0x4b2a7f)[_0x5deb8f(0x154)](),_0x5cc912=('0'+(new Date(_0x4b2a7f)[_0x5deb8f(0x182)]()+0x1))['slice'](-0x2),_0x12c531=('0'+new Date(_0x4b2a7f)[_0x5deb8f(0x287)]())[_0x5deb8f(0x1af)](-0x2),_0x33afcd=await staff['findOne']({'email':_0x48c1a1[_0x5deb8f(0x29a)]}),_0x107551=_0x33afcd['sales_man_code'],_0x3d0a48=_0x107551+'-'+_0xa7e5cc+_0x5cc912+_0x12c531,_0x263ef5=await Reference[_0x5deb8f(0x1b0)]({'referenceNumber':new RegExp('^'+_0x3d0a48),'salesman_code':_0x107551})['sort']({'createdAt':-0x1}),_0x2aab71=_0x3d0a48;_0x263ef5&&(_0x2aab71=_0x263ef5[_0x5deb8f(0x25d)]);console['log'](_0x2aab71);const _0x679ee2=new Reference({'referenceNumber':_0x2aab71,'staff_id':_0x4a0e84,'salesman_code':_0x107551});return await _0x679ee2[_0x5deb8f(0x1d3)](),_0x2aab71;}router[a0_0x412553(0x233)](a0_0x412553(0x168),auth,async(_0x3bc162,_0x2763ec)=>{const _0x413cee=a0_0x412553,{from_date:_0x144292,dataview:_0x4f126a}=_0x3bc162[_0x413cee(0x19d)],_0x364218=_0x3bc162[_0x413cee(0x203)],_0x5029f3=await staff[_0x413cee(0x1b0)]({'email':_0x364218[_0x413cee(0x29a)]}),_0x1b0380=await master_shop[_0x413cee(0x1c2)](),_0x36c1e4='';var _0x44cee7=new Date(_0x144292);const _0x1b8d1d={'year':_0x413cee(0x278),'month':_0x413cee(0x213),'day':_0x413cee(0x278)},_0x2289e4=new Intl['DateTimeFormat']('en-US',_0x1b8d1d)['format'](_0x44cee7),_0x3a60c8=await Reference[_0x413cee(0x1c2)]({'staff_id':_0x5029f3[_0x413cee(0x275)][_0x413cee(0x143)](),'date_include':_0x144292});if(_0x3a60c8[_0x413cee(0x2bf)]>0x0){let _0xc311d6='';_0xc311d6+=_0x3a60c8[0x0]['html'];if(_0x4f126a==_0x413cee(0x166)){const _0x162aaf=cheerio[_0x413cee(0x25a)](_0xc311d6);let _0x13f621=[],_0x50d2fd=[],_0x5eaf54=[];const _0x1c33c0=_0x43d745=>{const _0x1b019c=_0x413cee,_0x1bcd39={'top':{'style':_0x1b019c(0x167),'color':{'rgb':_0x1b019c(0x173)}},'bottom':{'style':_0x1b019c(0x167),'color':{'rgb':'000000'}},'left':{'style':_0x1b019c(0x167),'color':{'rgb':'000000'}},'right':{'style':_0x1b019c(0x167),'color':{'rgb':'000000'}}};if(_0x43d745){const _0x1749c3=_0x43d745[_0x1b019c(0x15f)](';')[_0x1b019c(0x1bb)]((_0x143c47,_0x4059d2)=>{const _0x1e737e=_0x1b019c,[_0x54479d,_0x341a57]=_0x4059d2[_0x1e737e(0x15f)](':')['map'](_0x497c82=>_0x497c82[_0x1e737e(0x221)]());return _0x143c47[_0x54479d]=_0x341a57,_0x143c47;},{});_0x1749c3['border-top']&&(_0x1bcd39[_0x1b019c(0x24f)][_0x1b019c(0x249)]=_0x1749c3[_0x1b019c(0x235)][_0x1b019c(0x283)](_0x1b019c(0x1ea))?_0x1b019c(0x1ea):_0x1b019c(0x1d5)),_0x1749c3[_0x1b019c(0x26f)]&&(_0x1bcd39[_0x1b019c(0x298)][_0x1b019c(0x249)]=_0x1749c3[_0x1b019c(0x26f)][_0x1b019c(0x283)]('thin')?_0x1b019c(0x1ea):_0x1b019c(0x1d5)),_0x1749c3['border-left']&&(_0x1bcd39[_0x1b019c(0x1a3)][_0x1b019c(0x249)]=_0x1749c3['border-left']['includes'](_0x1b019c(0x1ea))?_0x1b019c(0x1ea):'medium'),_0x1749c3['border-right']&&(_0x1bcd39[_0x1b019c(0x14d)]['style']=_0x1749c3[_0x1b019c(0x15b)]['includes'](_0x1b019c(0x1ea))?_0x1b019c(0x1ea):_0x1b019c(0x1d5));}return _0x1bcd39;};_0x162aaf('table\x20tr')[_0x413cee(0x214)]((_0x244c21,_0x727ec5)=>{const _0x4bbced=_0x413cee;let _0x1fecac=[],_0x338ffe=0x0;while(_0x5eaf54[_0x338ffe]){_0x5eaf54[_0x338ffe]--,_0x338ffe++;}_0x162aaf(_0x727ec5)[_0x4bbced(0x1c2)](_0x4bbced(0x23f))[_0x4bbced(0x214)]((_0x57dbe3,_0xb5f6ff)=>{const _0x480d2e=_0x4bbced;let _0x23fff3=_0x162aaf(_0xb5f6ff)[_0x480d2e(0x1da)]()[_0x480d2e(0x221)](),_0x59d658=parseFloat(_0x23fff3[_0x480d2e(0x289)](/,/g,''));isNaN(_0x59d658)&&(_0x59d658=_0x23fff3);let _0x44f595=parseInt(_0x162aaf(_0xb5f6ff)['attr'](_0x480d2e(0x20b)))||0x1,_0x2ec767=parseInt(_0x162aaf(_0xb5f6ff)['attr'](_0x480d2e(0x165)))||0x1;const _0x1aaafb=_0x162aaf(_0xb5f6ff)[_0x480d2e(0x2a0)]('style'),_0x62d228=_0x1c33c0(_0x1aaafb);_0x1fecac[_0x338ffe]={'v':_0x59d658,'s':{'border':_0x62d228}};(_0x44f595>0x1||_0x2ec767>0x1)&&_0x50d2fd['push']({'s':{'r':_0x244c21,'c':_0x338ffe},'e':{'r':_0x244c21+_0x2ec767-0x1,'c':_0x338ffe+_0x44f595-0x1}});for(let _0x34781e=0x0;_0x34781e<_0x44f595;_0x34781e++){_0x2ec767>0x1&&(_0x5eaf54[_0x338ffe+_0x34781e]=_0x2ec767-0x1);}_0x338ffe+=_0x44f595;}),_0x13f621[_0x4bbced(0x190)](_0x1fecac);});const _0x55dec0=XLSX[_0x413cee(0x238)][_0x413cee(0x1e1)](),_0x57808e=XLSX[_0x413cee(0x238)][_0x413cee(0x256)](_0x13f621);_0x50d2fd[_0x413cee(0x2bf)]>0x0&&(_0x57808e[_0x413cee(0x21d)]=_0x50d2fd);_0x57808e[_0x413cee(0x28e)]=_0x13f621[0x0][_0x413cee(0x2bd)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x55dec0,_0x57808e,_0x413cee(0x1d4));const _0x3b53df=XLSX[_0x413cee(0x1f7)](_0x55dec0,{'bookType':_0x413cee(0x17a),'type':'buffer'});_0x2763ec[_0x413cee(0x1cf)](_0x413cee(0x16e),_0x413cee(0x14b)),_0x2763ec[_0x413cee(0x1cf)]('Content-Type',_0x413cee(0x1e0)),_0x2763ec[_0x413cee(0x2a1)](_0x3b53df);}else{let _0x6cb65d='';_0x6cb65d+=_0xc311d6,_0x6cb65d+=_0x413cee(0x18b),_0x6cb65d+=_0x413cee(0x13e),_0x6cb65d+=_0x413cee(0x2c5),_0x6cb65d+='};',_0x6cb65d+=_0x413cee(0x244),_0x2763ec[_0x413cee(0x2a1)](_0x6cb65d);}}else generateReferenceNumber(_0x144292,_0x5029f3[_0x413cee(0x275)][_0x413cee(0x143)](),_0x364218)[_0x413cee(0x1f8)](async _0x5cd438=>{const _0x4b05d8=_0x413cee,_0x2b89bd=await agentsdataDSICheck_DSRR(_0x144292,_0x5029f3[_0x4b05d8(0x275)][_0x4b05d8(0x143)](),_0x36c1e4,_0x5cd438);console[_0x4b05d8(0x196)](_0x2b89bd);let _0xeacb=_0x4b05d8(0x20c);_0xeacb+=_0x4b05d8(0x21b),_0xeacb+=_0x4b05d8(0x192),_0xeacb+='<table>',_0xeacb+=_0x2b89bd,_0xeacb+='</table>',_0xeacb+=_0x4b05d8(0x2b8),_0xeacb+=_0x4b05d8(0x2b8);if(_0x2b89bd[_0x4b05d8(0x2bf)]>0x0){const _0x3ad9dc=await Reference[_0x4b05d8(0x1b0)]({'staff_id':_0x5029f3['_id'][_0x4b05d8(0x143)](),'referenceNumber':_0x5cd438});_0x3ad9dc[_0x4b05d8(0x255)]=_0xeacb,_0x3ad9dc['date_include']=_0x144292,await _0x3ad9dc[_0x4b05d8(0x1d3)]();if(_0x4f126a=='excel'){const _0x47b9ac=cheerio[_0x4b05d8(0x25a)](_0xeacb);let _0x5e0f5a=[],_0x46d3fe=[],_0x53f261=[];const _0x6928ca=_0x1381fb=>{const _0x12509a=_0x4b05d8,_0x448e3a={'top':{'style':_0x12509a(0x167),'color':{'rgb':_0x12509a(0x173)}},'bottom':{'style':'thick','color':{'rgb':_0x12509a(0x173)}},'left':{'style':_0x12509a(0x167),'color':{'rgb':_0x12509a(0x173)}},'right':{'style':'thick','color':{'rgb':_0x12509a(0x173)}}};if(_0x1381fb){const _0x2c2a73=_0x1381fb['split'](';')[_0x12509a(0x1bb)]((_0x1f4caa,_0x4e9a48)=>{const _0x1dd9a3=_0x12509a,[_0x24e643,_0x1c3632]=_0x4e9a48[_0x1dd9a3(0x15f)](':')[_0x1dd9a3(0x2bd)](_0x5f1776=>_0x5f1776['trim']());return _0x1f4caa[_0x24e643]=_0x1c3632,_0x1f4caa;},{});_0x2c2a73['border-top']&&(_0x448e3a[_0x12509a(0x24f)][_0x12509a(0x249)]=_0x2c2a73[_0x12509a(0x235)]['includes'](_0x12509a(0x1ea))?_0x12509a(0x1ea):_0x12509a(0x1d5)),_0x2c2a73[_0x12509a(0x26f)]&&(_0x448e3a['bottom']['style']=_0x2c2a73[_0x12509a(0x26f)]['includes'](_0x12509a(0x1ea))?'thin':_0x12509a(0x1d5)),_0x2c2a73[_0x12509a(0x293)]&&(_0x448e3a[_0x12509a(0x1a3)][_0x12509a(0x249)]=_0x2c2a73[_0x12509a(0x293)]['includes'](_0x12509a(0x1ea))?_0x12509a(0x1ea):_0x12509a(0x1d5)),_0x2c2a73['border-right']&&(_0x448e3a[_0x12509a(0x14d)][_0x12509a(0x249)]=_0x2c2a73[_0x12509a(0x15b)][_0x12509a(0x283)](_0x12509a(0x1ea))?'thin':'medium');}return _0x448e3a;};_0x47b9ac('table\x20tr')[_0x4b05d8(0x214)]((_0x3d6750,_0x21a545)=>{const _0x59648c=_0x4b05d8;let _0x283149=[],_0x45925e=0x0;while(_0x53f261[_0x45925e]){_0x53f261[_0x45925e]--,_0x45925e++;}_0x47b9ac(_0x21a545)['find'](_0x59648c(0x23f))['each']((_0x1284dc,_0x40393d)=>{const _0x1245f5=_0x59648c;let _0x4eeda2=_0x47b9ac(_0x40393d)[_0x1245f5(0x1da)]()[_0x1245f5(0x221)](),_0xd99b93=parseFloat(_0x4eeda2[_0x1245f5(0x289)](/,/g,''));isNaN(_0xd99b93)&&(_0xd99b93=_0x4eeda2);let _0x2ab089=parseInt(_0x47b9ac(_0x40393d)[_0x1245f5(0x2a0)](_0x1245f5(0x20b)))||0x1,_0x55c1d0=parseInt(_0x47b9ac(_0x40393d)[_0x1245f5(0x2a0)]('rowspan'))||0x1;const _0x33ca07=_0x47b9ac(_0x40393d)[_0x1245f5(0x2a0)](_0x1245f5(0x249)),_0x5851ab=_0x6928ca(_0x33ca07);_0x283149[_0x45925e]={'v':_0xd99b93,'s':{'border':_0x5851ab}};(_0x2ab089>0x1||_0x55c1d0>0x1)&&_0x46d3fe['push']({'s':{'r':_0x3d6750,'c':_0x45925e},'e':{'r':_0x3d6750+_0x55c1d0-0x1,'c':_0x45925e+_0x2ab089-0x1}});for(let _0x4db4a6=0x0;_0x4db4a6<_0x2ab089;_0x4db4a6++){_0x55c1d0>0x1&&(_0x53f261[_0x45925e+_0x4db4a6]=_0x55c1d0-0x1);}_0x45925e+=_0x2ab089;}),_0x5e0f5a[_0x59648c(0x190)](_0x283149);});const _0x3656de=XLSX[_0x4b05d8(0x238)][_0x4b05d8(0x1e1)](),_0x4f0ad9=XLSX['utils'][_0x4b05d8(0x256)](_0x5e0f5a);_0x46d3fe[_0x4b05d8(0x2bf)]>0x0&&(_0x4f0ad9[_0x4b05d8(0x21d)]=_0x46d3fe);_0x4f0ad9[_0x4b05d8(0x28e)]=_0x5e0f5a[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x4b05d8(0x238)]['book_append_sheet'](_0x3656de,_0x4f0ad9,_0x4b05d8(0x1d4));const _0x573b04=XLSX['write'](_0x3656de,{'bookType':_0x4b05d8(0x17a),'type':'buffer'});_0x2763ec[_0x4b05d8(0x1cf)](_0x4b05d8(0x16e),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x2763ec[_0x4b05d8(0x1cf)](_0x4b05d8(0x2b1),_0x4b05d8(0x1e0)),_0x2763ec[_0x4b05d8(0x2a1)](_0x573b04);}else _0xeacb+=_0x4b05d8(0x18b),_0xeacb+='window.onload\x20=\x20function()\x20{',_0xeacb+=_0x4b05d8(0x2c5),_0xeacb+='};',_0xeacb+=_0x4b05d8(0x244),_0x2763ec[_0x4b05d8(0x2a1)](_0xeacb);}else await Reference['deleteOne']({'referenceNumber':_0x5cd438}),_0x3bc162['flash'](_0x4b05d8(0x20f),_0x4b05d8(0x1a7)),_0x2763ec[_0x4b05d8(0x16d)](_0x4b05d8(0x1c0));})[_0x413cee(0x294)](console[_0x413cee(0x229)]);}),router[a0_0x412553(0x21e)](a0_0x412553(0x1d8),auth,async(_0x55b31d,_0x123f41)=>{const _0x3ee5d4=a0_0x412553;try{const {username:_0x3eb7c4,email:_0x46c185,role:_0x40dc0c}=_0x55b31d['user'],_0xd9d2a7=_0x55b31d[_0x3ee5d4(0x203)],_0x1b3bae=await profile[_0x3ee5d4(0x1b0)]({'email':_0xd9d2a7[_0x3ee5d4(0x29a)]}),_0x3d2986={'year':'numeric','month':_0x3ee5d4(0x213),'day':_0x3ee5d4(0x278)},_0x223fed=await master_shop[_0x3ee5d4(0x1c2)]();console['log'](_0x3ee5d4(0x191),_0x223fed);const _0x4479c0=await product[_0x3ee5d4(0x1c2)]();console[_0x3ee5d4(0x196)]('Products\x20find_data',_0x4479c0);const _0x172805=await warehouse['aggregate']([{'$unwind':_0x3ee5d4(0x2c2)},{'$lookup':{'from':_0x3ee5d4(0x2b6),'localField':_0x3ee5d4(0x2a6),'foreignField':'name','as':_0x3ee5d4(0x145)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x3ee5d4(0x24b),'product_stock':_0x3ee5d4(0x179)}},{'$group':{'_id':_0x3ee5d4(0x279),'product_stock':{'$sum':'$product_stock'}}}]);console['log'](_0x3ee5d4(0x206),_0x172805),_0x172805[_0x3ee5d4(0x1cb)](_0x431d05=>{const _0xaf3b6d=_0x3ee5d4,_0x404435=_0x4479c0[_0xaf3b6d(0x2bd)](_0x5c0c67=>{const _0x293453=_0xaf3b6d;_0x5c0c67['name']==_0x431d05[_0x293453(0x275)]&&(_0x5c0c67[_0x293453(0x152)]=parseInt(_0x5c0c67[_0x293453(0x152)])+parseInt(_0x431d05[_0x293453(0x18e)]));});});const _0x26b870=await staff[_0x3ee5d4(0x1c2)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x5ec964=await staff[_0x3ee5d4(0x1b0)]({'email':_0xd9d2a7[_0x3ee5d4(0x29a)]});if(_0x223fed[0x0]['language']=='English\x20(US)')var _0x2a4db2=users[_0x3ee5d4(0x2a3)];else{if(_0x223fed[0x0][_0x3ee5d4(0x1b7)]=='Hindi')var _0x2a4db2=users['Hindi'];else{if(_0x223fed[0x0][_0x3ee5d4(0x1b7)]==_0x3ee5d4(0x1ed))var _0x2a4db2=users[_0x3ee5d4(0x1ed)];else{if(_0x223fed[0x0][_0x3ee5d4(0x1b7)]=='Spanish')var _0x2a4db2=users[_0x3ee5d4(0x1dd)];else{if(_0x223fed[0x0][_0x3ee5d4(0x1b7)]=='French')var _0x2a4db2=users[_0x3ee5d4(0x2b0)];else{if(_0x223fed[0x0][_0x3ee5d4(0x1b7)]==_0x3ee5d4(0x28c))var _0x2a4db2=users[_0x3ee5d4(0x241)];else{if(_0x223fed[0x0][_0x3ee5d4(0x1b7)]==_0x3ee5d4(0x2ba))var _0x2a4db2=users[_0x3ee5d4(0x2ba)];else{if(_0x223fed[0x0]['language']==_0x3ee5d4(0x247))var _0x2a4db2=users[_0x3ee5d4(0x276)];}}}}}}}_0x123f41[_0x3ee5d4(0x1ee)](_0x3ee5d4(0x1c8),{'success':_0x55b31d[_0x3ee5d4(0x180)](_0x3ee5d4(0x19c)),'errors':_0x55b31d[_0x3ee5d4(0x180)]('errors'),'alldata':_0x4479c0,'profile':_0x1b3bae,'master_shop':_0x223fed,'role':_0xd9d2a7,'product_stock':_0x172805,'language':_0x2a4db2,'staff_arr':_0x5ec964,'staff_data_all':_0x26b870});}catch(_0x23462e){}}),router[a0_0x412553(0x233)](a0_0x412553(0x263),auth,async(_0x20614d,_0x452733)=>{const _0xb79528=a0_0x412553;try{const {from:_0x6e65f7,to:_0x106b45,staff_data:_0x110546}=_0x20614d['body'],_0x53b819=await Reference[_0xb79528(0x22c)]([{'$match':{'date_include':{'$gte':_0x6e65f7,'$lte':_0x106b45},'staff_id':_0x110546}},{'$sort':{'date_include':0x1}}]);_0x452733['json'](_0x53b819);}catch(_0x3afd27){_0x452733[_0xb79528(0x1f6)](_0x3afd27);}}),router[a0_0x412553(0x233)](a0_0x412553(0x171),auth,async(_0x395cb2,_0xffa238)=>{const _0x5d20e3=a0_0x412553;try{const {from:_0x5474a6,to:_0x361e5a}=_0x395cb2[_0x5d20e3(0x19d)],{sttaff_id:_0x156a90}=_0x395cb2[_0x5d20e3(0x203)],_0x5578d1=await Reference[_0x5d20e3(0x22c)]([{'$match':{'date_include':{'$gte':_0x5474a6,'$lte':_0x361e5a},'staff_id':_0x156a90}},{'$sort':{'date_include':0x1}}]);_0xffa238[_0x5d20e3(0x1f6)](_0x5578d1);}catch(_0x400e4f){_0xffa238[_0x5d20e3(0x1f6)](_0x400e4f);}}),router[a0_0x412553(0x21e)](a0_0x412553(0x267),auth,async(_0xf4503e,_0x13801f)=>{const _0x19dc0b=a0_0x412553;try{const _0x4ab8fa=_0xf4503e[_0x19dc0b(0x211)]['id'],_0x418e6c=await Reference[_0x19dc0b(0x1a6)](_0x4ab8fa);let _0x476962='';_0x476962+=_0x418e6c['html'],_0x476962+=_0x19dc0b(0x18b),_0x476962+=_0x19dc0b(0x13e),_0x476962+='window.print();',_0x476962+='};',_0x476962+=_0x19dc0b(0x244),_0x13801f[_0x19dc0b(0x2a1)](_0x476962);}catch(_0xf012bd){_0x13801f[_0x19dc0b(0x1f6)](_0xf012bd);}}),router[a0_0x412553(0x233)](a0_0x412553(0x1aa),auth,async(_0x97698a,_0x17917a)=>{const _0x28fc63=a0_0x412553;try{const {ref_data:_0x4e11dd}=_0x97698a['body'],_0xddd2a8=_0x4e11dd['split']('~'),_0x10e9be=_0xddd2a8[_0x28fc63(0x209)](_0x4a21db=>_0x4a21db!==''),_0x40d8cf=await Reference[_0x28fc63(0x22c)]([{'$match':{'referenceNumber':{'$in':_0x10e9be}}}]),_0x553703=XLSX[_0x28fc63(0x238)][_0x28fc63(0x1e1)]();_0x40d8cf[_0x28fc63(0x1cb)](_0x3e1a18=>{const _0x392169=_0x28fc63,_0x44be2d=cheerio[_0x392169(0x25a)](_0x3e1a18[_0x392169(0x255)]);let _0x54ffa6=[],_0x2bd203=[],_0x5318e5=[];_0x44be2d(_0x392169(0x193))[_0x392169(0x214)]((_0x515672,_0x4d7aef)=>{const _0x114101=_0x392169;let _0xc2eb80=[],_0x5ad7fe=0x0;while(_0x5318e5[_0x5ad7fe]){_0x5318e5[_0x5ad7fe]--,_0x5ad7fe++;}_0x44be2d(_0x4d7aef)[_0x114101(0x1c2)](_0x114101(0x23f))[_0x114101(0x214)]((_0x420ead,_0x15c251)=>{const _0x32115e=_0x114101;let _0x95a990=_0x44be2d(_0x15c251)[_0x32115e(0x1da)]()[_0x32115e(0x221)](),_0x325520=parseFloat(_0x95a990[_0x32115e(0x289)](/,/g,''));isNaN(_0x325520)&&(_0x325520=_0x95a990);let _0x572f40=parseInt(_0x44be2d(_0x15c251)['attr'](_0x32115e(0x20b)))||0x1,_0x3fce3d=parseInt(_0x44be2d(_0x15c251)[_0x32115e(0x2a0)](_0x32115e(0x165)))||0x1;_0xc2eb80[_0x5ad7fe]=_0x325520;(_0x572f40>0x1||_0x3fce3d>0x1)&&_0x2bd203[_0x32115e(0x190)]({'s':{'r':_0x515672,'c':_0x5ad7fe},'e':{'r':_0x515672+_0x3fce3d-0x1,'c':_0x5ad7fe+_0x572f40-0x1}});for(let _0x49d188=0x0;_0x49d188<_0x572f40;_0x49d188++){_0x3fce3d>0x1&&(_0x5318e5[_0x5ad7fe+_0x49d188]=_0x3fce3d-0x1);}_0x5ad7fe+=_0x572f40;}),_0x54ffa6[_0x114101(0x190)](_0xc2eb80);});const _0x35ba89=XLSX[_0x392169(0x238)][_0x392169(0x256)](_0x54ffa6);_0x2bd203[_0x392169(0x2bf)]>0x0&&(_0x35ba89['!merges']=_0x2bd203),_0x35ba89['!cols']=_0x54ffa6[0x0][_0x392169(0x2bd)](()=>({'wpx':0x64})),XLSX[_0x392169(0x238)][_0x392169(0x18d)](_0x553703,_0x35ba89,_0x3e1a18[_0x392169(0x25d)]);});const _0x376375=XLSX['write'](_0x553703,{'bookType':_0x28fc63(0x17a),'type':_0x28fc63(0x1bd)});_0x17917a[_0x28fc63(0x1cf)]('Content-Disposition',_0x28fc63(0x200)),_0x17917a[_0x28fc63(0x1cf)](_0x28fc63(0x2b1),_0x28fc63(0x1e0)),_0x17917a[_0x28fc63(0x2a1)](_0x376375);}catch(_0x396a4d){_0x17917a[_0x28fc63(0x1f6)](_0x396a4d);}}),router[a0_0x412553(0x233)](a0_0x412553(0x281),auth,async(_0x2bf39e,_0x14f48c)=>{const _0xf80fa7=a0_0x412553,{from_date:_0x112af8,agent_id:_0x582435}=_0x2bf39e['body'],_0x1e1fa7=_0x2bf39e['user'],_0x346f5f=await staff[_0xf80fa7(0x1b0)]({'email':_0x1e1fa7['email']}),_0x19a0e7=await master_shop[_0xf80fa7(0x1c2)](),_0x4edb8b=await agentsdataDSICheck_DSRR(_0x112af8,_0x582435,_0x51485f);let _0x4bcd9f='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x415063=new Date(_0x112af8);const _0x232dee={'year':'numeric','month':_0xf80fa7(0x213),'day':'numeric'},_0x434829=new Intl['DateTimeFormat'](_0xf80fa7(0x1de),_0x232dee)['format'](_0x415063);_0x4bcd9f+='<div\x20class=\x22row\x22>',_0x4bcd9f+=_0xf80fa7(0x192),_0x4bcd9f+=_0xf80fa7(0x184),_0x4bcd9f+=_0x4edb8b,_0x4bcd9f+=_0xf80fa7(0x28f),_0x4bcd9f+=_0xf80fa7(0x2b8),_0x4bcd9f+=_0xf80fa7(0x2b8);let _0x227825=_0xf80fa7(0x236);const _0xa6a71={'width':_0xf80fa7(0x2ad),'height':_0xf80fa7(0x2c3),'orientation':_0xf80fa7(0x207),'border':{'top':_0xf80fa7(0x210),'right':_0xf80fa7(0x210),'bottom':_0xf80fa7(0x210),'left':_0xf80fa7(0x210)},'header':{'height':'60mm','contents':_0xf80fa7(0x230)+_0x227825+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x434829+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0xf80fa7(0x2bc),'contents':{'default':_0xf80fa7(0x153)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0xf80fa7(0x17b)}}};var _0x51485f='on';if(_0x51485f=='on'){const _0x21ebde=cheerio['load'](_0x4bcd9f);let _0x272a02=[],_0x21c632=[],_0x30dd48=[];_0x21ebde(_0xf80fa7(0x193))['each']((_0x47baf6,_0x1ffeb6)=>{const _0x3891d7=_0xf80fa7;let _0x4588aa=[],_0x191c8c=0x0;while(_0x30dd48[_0x191c8c]){_0x30dd48[_0x191c8c]--,_0x191c8c++;}_0x21ebde(_0x1ffeb6)['find'](_0x3891d7(0x23f))[_0x3891d7(0x214)]((_0x850cf,_0x2d9209)=>{const _0x5c1747=_0x3891d7;let _0x231892=_0x21ebde(_0x2d9209)['text']()[_0x5c1747(0x221)](),_0x1ecdfd=parseFloat(_0x231892[_0x5c1747(0x289)](/,/g,''));isNaN(_0x1ecdfd)&&(_0x1ecdfd=_0x231892);let _0x2dc05e=parseInt(_0x21ebde(_0x2d9209)['attr'](_0x5c1747(0x20b)))||0x1,_0x5600c1=parseInt(_0x21ebde(_0x2d9209)[_0x5c1747(0x2a0)]('rowspan'))||0x1;_0x4588aa[_0x191c8c]=_0x1ecdfd;(_0x2dc05e>0x1||_0x5600c1>0x1)&&_0x21c632[_0x5c1747(0x190)]({'s':{'r':_0x47baf6,'c':_0x191c8c},'e':{'r':_0x47baf6+_0x5600c1-0x1,'c':_0x191c8c+_0x2dc05e-0x1}});for(let _0x434fa0=0x0;_0x434fa0<_0x2dc05e;_0x434fa0++){_0x5600c1>0x1&&(_0x30dd48[_0x191c8c+_0x434fa0]=_0x5600c1-0x1);}_0x191c8c+=_0x2dc05e;}),_0x272a02[_0x3891d7(0x190)](_0x4588aa);});const _0x3d639b=XLSX[_0xf80fa7(0x238)][_0xf80fa7(0x1e1)](),_0x6c7044=XLSX[_0xf80fa7(0x238)][_0xf80fa7(0x256)](_0x272a02);_0x21c632[_0xf80fa7(0x2bf)]>0x0&&(_0x6c7044['!merges']=_0x21c632);_0x6c7044['!cols']=_0x272a02[0x0][_0xf80fa7(0x2bd)](()=>({'wpx':0x64})),XLSX['utils'][_0xf80fa7(0x18d)](_0x3d639b,_0x6c7044,'Sales\x20Report');const _0x364627=XLSX[_0xf80fa7(0x1f7)](_0x3d639b,{'bookType':'xlsx','type':'buffer'});_0x14f48c[_0xf80fa7(0x1cf)](_0xf80fa7(0x16e),_0xf80fa7(0x14b)),_0x14f48c['setHeader'](_0xf80fa7(0x2b1),_0xf80fa7(0x1e0)),_0x14f48c['send'](_0x364627);}else pdf[_0xf80fa7(0x2c9)](_0x4bcd9f,_0xa6a71)['toStream'](function(_0x2e9bb8,_0x47ab88){const _0x3b13e3=_0xf80fa7;if(_0x2e9bb8){_0x14f48c[_0x3b13e3(0x254)](0x1f4)[_0x3b13e3(0x2a1)]('Error\x20generating\x20PDF');return;}_0x14f48c[_0x3b13e3(0x1cf)](_0x3b13e3(0x2b1),_0x3b13e3(0x295)),_0x47ab88[_0x3b13e3(0x274)](_0x14f48c);});}),module[a0_0x412553(0x1a2)]=router;