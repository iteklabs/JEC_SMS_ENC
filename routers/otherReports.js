const a0_0x3a763f=a0_0x27e8;(function(_0x104405,_0x4954e2){const _0x36a814=a0_0x27e8,_0x117cad=_0x104405();while(!![]){try{const _0x18be2c=-parseInt(_0x36a814(0x1f7))/0x1*(-parseInt(_0x36a814(0x21b))/0x2)+parseInt(_0x36a814(0x1c8))/0x3*(-parseInt(_0x36a814(0x166))/0x4)+parseInt(_0x36a814(0x1a3))/0x5*(parseInt(_0x36a814(0x199))/0x6)+-parseInt(_0x36a814(0x172))/0x7*(-parseInt(_0x36a814(0x208))/0x8)+parseInt(_0x36a814(0x1b1))/0x9+-parseInt(_0x36a814(0xed))/0xa+parseInt(_0x36a814(0xd7))/0xb;if(_0x18be2c===_0x4954e2)break;else _0x117cad['push'](_0x117cad['shift']());}catch(_0x14872a){_0x117cad['push'](_0x117cad['shift']());}}}(a0_0x1ec7,0x6bd42));const express=require(a0_0x3a763f(0x191)),res=require(a0_0x3a763f(0x133)),app=express(),router=express[a0_0x3a763f(0x188)](),multer=require('multer'),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require(a0_0x3a763f(0x15a)),users=require(a0_0x3a763f(0x1d5)),excelJS=require('exceljs'),XLSX=require(a0_0x3a763f(0xb6)),PDFDocument=require(a0_0x3a763f(0x18a)),fs=require('fs'),blobStream=require(a0_0x3a763f(0x10a)),JsBarcode=require(a0_0x3a763f(0x1ed)),{Canvas}=require('canvas'),pdf=require(a0_0x3a763f(0x20e)),path=require(a0_0x3a763f(0x211)),mongoose=require(a0_0x3a763f(0x122)),cheerio=require('cheerio');router[a0_0x3a763f(0x11d)](a0_0x3a763f(0xe7),auth,async(_0x22ec01,_0x2f323d)=>{const _0x537b6b=a0_0x3a763f;try{const {username:_0x48c410,email:_0x214793,role:_0x2e97f9}=_0x22ec01[_0x537b6b(0x231)],_0x1dbbdd=_0x22ec01[_0x537b6b(0x231)],_0x46d7ff=await profile[_0x537b6b(0x1d9)]({'email':_0x1dbbdd[_0x537b6b(0xcd)]}),_0x18cf25={'year':_0x537b6b(0xc0),'month':_0x537b6b(0x22e),'day':_0x537b6b(0xc0)},_0x35e2f4=await master_shop[_0x537b6b(0xc5)]();console[_0x537b6b(0x13f)](_0x537b6b(0x1b9),_0x35e2f4);const _0x10cba1=await product[_0x537b6b(0xc5)]();console[_0x537b6b(0x13f)](_0x537b6b(0x229),_0x10cba1);const _0x1c3566=await warehouse[_0x537b6b(0x1ad)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x537b6b(0x118),'localField':_0x537b6b(0x152),'foreignField':_0x537b6b(0x213),'as':_0x537b6b(0x236)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x537b6b(0x21d),'product_stock':_0x537b6b(0x1e6)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);console[_0x537b6b(0x13f)](_0x537b6b(0x21e),_0x1c3566),_0x1c3566[_0x537b6b(0x234)](_0x5f1667=>{const _0x5654c8=_0x537b6b,_0x309a8b=_0x10cba1[_0x5654c8(0x155)](_0x4b7566=>{const _0x306103=_0x5654c8;_0x4b7566[_0x306103(0x213)]==_0x5f1667[_0x306103(0x126)]&&(_0x4b7566[_0x306103(0x212)]=parseInt(_0x4b7566[_0x306103(0x212)])+parseInt(_0x5f1667[_0x306103(0x12c)]));});}),console[_0x537b6b(0x13f)](_0x537b6b(0x229),_0x10cba1);if(_0x35e2f4[0x0][_0x537b6b(0x23d)]=='English\x20(US)')var _0x21fc4c=users['English'];else{if(_0x35e2f4[0x0][_0x537b6b(0x23d)]==_0x537b6b(0x14a))var _0x21fc4c=users[_0x537b6b(0x14a)];else{if(_0x35e2f4[0x0]['language']==_0x537b6b(0x149))var _0x21fc4c=users[_0x537b6b(0x149)];else{if(_0x35e2f4[0x0][_0x537b6b(0x23d)]==_0x537b6b(0x21a))var _0x21fc4c=users[_0x537b6b(0x21a)];else{if(_0x35e2f4[0x0][_0x537b6b(0x23d)]==_0x537b6b(0xe2))var _0x21fc4c=users[_0x537b6b(0xe2)];else{if(_0x35e2f4[0x0][_0x537b6b(0x23d)]=='Portuguese\x20(BR)')var _0x21fc4c=users[_0x537b6b(0x216)];else{if(_0x35e2f4[0x0][_0x537b6b(0x23d)]==_0x537b6b(0x11a))var _0x21fc4c=users[_0x537b6b(0x11a)];else{if(_0x35e2f4[0x0]['language']==_0x537b6b(0x18e))var _0x21fc4c=users[_0x537b6b(0x217)];}}}}}}}_0x2f323d[_0x537b6b(0x134)](_0x537b6b(0x200),{'success':_0x22ec01['flash'](_0x537b6b(0xdd)),'errors':_0x22ec01[_0x537b6b(0xf6)](_0x537b6b(0x1f3)),'alldata':_0x10cba1,'profile':_0x46d7ff,'master_shop':_0x35e2f4,'role':_0x1dbbdd,'product_stock':_0x1c3566,'language':_0x21fc4c});}catch(_0x130407){}});async function dataCheck(_0x21b76d,_0x2e389f){const _0x2a0640=a0_0x3a763f,_0x3f14d5=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':_0x2a0640(0x1f2)},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x8e75bd=[];_0x8e75bd['cat_brand']=[];for(let _0x39d86a=0x0;_0x39d86a<=_0x3f14d5['length']-0x1;_0x39d86a++){const _0x951a16=_0x3f14d5[_0x39d86a];_0x8e75bd[_0x2a0640(0x102)]['push'](_0x951a16);}const _0xbcb7c9=await product['aggregate']([{'$group':{'_id':{'category':_0x2a0640(0x1f2)},'products':{'$push':{'brand':_0x2a0640(0xf2),'product_code':_0x2a0640(0x1f9),'product_name':_0x2a0640(0x195)}}}},{'$sort':{'_id.category':-0x1}}]),_0x510ab6=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x21b76d,'$lte':_0x2e389f}}},{'$unwind':'$product'},{'$group':{'_id':{'product_name':'$product.product_name','product_code':'$product.product_code'},'totalQTY':{'$sum':_0x2a0640(0x1b3)}}}]);_0x8e75bd[_0x2a0640(0x16b)]=[];for(let _0x5553e1=0x0;_0x5553e1<=_0x510ab6[_0x2a0640(0xd3)]-0x1;_0x5553e1++){const _0x40cd2b=_0x510ab6[_0x5553e1];_0x8e75bd['beg_bal'][_0x2a0640(0x1ab)](_0x40cd2b);}const _0x51e519=await sales_sa[_0x2a0640(0x1ad)]([{'$match':{'date':{'$gte':_0x21b76d,'$lte':_0x2e389f}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x2a0640(0x1d7)}}},{'$lookup':{'from':'staffs','localField':_0x2a0640(0xce),'foreignField':'_id','as':_0x2a0640(0x238)}},{'$unwind':'$sales_info'},{'$unwind':_0x2a0640(0x10c)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x2a0640(0x23e),'product_code':_0x2a0640(0x1a2)},'totalQTY':{'$sum':_0x2a0640(0x103)}}}]);console[_0x2a0640(0x13f)](_0x51e519[0x0]),_0x8e75bd[_0x2a0640(0x1ee)]=[];for(let _0x258683=0x0;_0x258683<=_0x51e519['length']-0x1;_0x258683++){const _0x16382d=_0x51e519[_0x258683];_0x8e75bd[_0x2a0640(0x1ee)][_0x2a0640(0x1ab)](_0x16382d);}const _0x2f6000=await sales_sa[_0x2a0640(0x1ad)]([{'$match':{'date':{'$gte':_0x21b76d,'$lte':_0x2e389f}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x2a0640(0x1d7)}}},{'$lookup':{'from':_0x2a0640(0x105),'localField':'sales_staff_id','foreignField':'_id','as':_0x2a0640(0x238)}},{'$unwind':_0x2a0640(0x196)},{'$unwind':_0x2a0640(0x10c)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x2a0640(0x109)}},{'$group':{'_id':{'product_name':_0x2a0640(0x23e),'product_code':_0x2a0640(0x1a2)},'totalQTY':{'$sum':_0x2a0640(0x125)}}}]);_0x8e75bd[_0x2a0640(0x189)]=[];for(let _0x4ec5ff=0x0;_0x4ec5ff<=_0x2f6000['length']-0x1;_0x4ec5ff++){const _0x5a2733=_0x2f6000[_0x4ec5ff];_0x8e75bd[_0x2a0640(0x189)][_0x2a0640(0x1ab)](_0x5a2733);}let _0x44efc0='';for(let _0x58c70c=0x0;_0x58c70c<=_0xbcb7c9[_0x2a0640(0xd3)]-0x1;_0x58c70c++){const _0x429883=_0xbcb7c9[_0x58c70c];_0x44efc0+=_0x2a0640(0x19e),_0x44efc0+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x429883[_0x2a0640(0x126)][_0x2a0640(0x1ac)]+_0x2a0640(0x158),_0x44efc0+=_0x2a0640(0x142);for(let _0x35ab7d=0x0;_0x35ab7d<_0x8e75bd[_0x2a0640(0x102)][_0x2a0640(0xd3)];_0x35ab7d++){const _0x474069=_0x8e75bd[_0x2a0640(0x102)][_0x35ab7d];if(_0x474069[_0x2a0640(0x126)][_0x2a0640(0x1ac)]==_0x429883[_0x2a0640(0x126)][_0x2a0640(0x1ac)]){let _0x51c5c8=[],_0x47d6cd=[],_0x4aff8c=[];_0x51c5c8[_0x474069[_0x2a0640(0x126)]['brand']]=[],_0x47d6cd[_0x474069['_id'][_0x2a0640(0x139)]]=[],_0x4aff8c[_0x474069[_0x2a0640(0x126)][_0x2a0640(0x139)]]=[];var _0x53853a=0x0,_0x3472ff=0x0,_0x5d1280=0x0;for(let _0x1e8b90=0x0;_0x1e8b90<_0x474069[_0x2a0640(0x118)][_0x2a0640(0xd3)];_0x1e8b90++){const _0xc46944=_0x474069['products'][_0x1e8b90];for(let _0x5db8a6=0x0;_0x5db8a6<=_0x8e75bd[_0x2a0640(0x16b)][_0x2a0640(0xd3)]-0x1;_0x5db8a6++){const _0x3b6128=_0x8e75bd['beg_bal'][_0x5db8a6];_0x3b6128[_0x2a0640(0x126)][_0x2a0640(0x1b8)]==_0xc46944['name']&&_0x3b6128[_0x2a0640(0x126)][_0x2a0640(0x1e1)]==_0xc46944[_0x2a0640(0x1e1)]&&(_0x53853a+=parseInt(_0x3b6128[_0x2a0640(0x1ca)],0xa));}for(let _0x2d36b0=0x0;_0x2d36b0<=_0x8e75bd['sales_ext'][_0x2a0640(0xd3)]-0x1;_0x2d36b0++){const _0x359cfb=_0x8e75bd[_0x2a0640(0x189)][_0x2d36b0];_0x359cfb[_0x2a0640(0x126)][_0x2a0640(0x1b8)]==_0xc46944[_0x2a0640(0x213)]&&_0x359cfb[_0x2a0640(0x126)]['product_code']==_0xc46944['product_code']&&(_0x3472ff+=parseFloat(_0x359cfb[_0x2a0640(0x1ca)],0xa)[_0x2a0640(0x16a)](0x2));}for(let _0x3e8ab9=0x0;_0x3e8ab9<=_0x8e75bd[_0x2a0640(0x1ee)][_0x2a0640(0xd3)]-0x1;_0x3e8ab9++){const _0x33356a=_0x8e75bd['sales_bkg'][_0x3e8ab9];_0x33356a['_id'][_0x2a0640(0x1b8)]==_0xc46944[_0x2a0640(0x213)]&&_0x33356a[_0x2a0640(0x126)][_0x2a0640(0x1e1)]==_0xc46944[_0x2a0640(0x1e1)]&&(_0x5d1280+=parseInt(_0x33356a['totalQTY'],0xa));}}const _0x305584=new Intl['NumberFormat'](_0x2a0640(0x233));var _0x3fe923=_0x305584[_0x2a0640(0x10d)](_0x53853a);_0x51c5c8[_0x474069[_0x2a0640(0x126)][_0x2a0640(0x139)]][_0x2a0640(0x1ab)](_0x3fe923),_0x47d6cd[_0x474069[_0x2a0640(0x126)][_0x2a0640(0x139)]]['push'](_0x305584[_0x2a0640(0x10d)](_0x3472ff)),_0x4aff8c[_0x474069[_0x2a0640(0x126)]['brand']][_0x2a0640(0x1ab)](_0x305584[_0x2a0640(0x10d)](_0x5d1280));var _0x3e4a5c=_0x305584[_0x2a0640(0x10d)](_0x53853a-(_0x5d1280+_0x3472ff));_0x44efc0+=_0x2a0640(0x19e),_0x44efc0+=_0x2a0640(0x1f4),_0x44efc0+='<td\x20class=\x22row_data\x22>'+_0x474069['_id'][_0x2a0640(0x139)]+_0x2a0640(0x158),_0x44efc0+=_0x2a0640(0x17f)+_0x51c5c8[_0x474069[_0x2a0640(0x126)][_0x2a0640(0x139)]][0x0]+_0x2a0640(0x158),_0x44efc0+='<td\x20class=\x22row_data\x22>0</td>',_0x44efc0+=_0x2a0640(0x17f)+_0x4aff8c[_0x474069['_id'][_0x2a0640(0x139)]][0x0]+_0x2a0640(0x158),_0x44efc0+='<td\x20class=\x22row_data\x22>'+_0x47d6cd[_0x474069[_0x2a0640(0x126)][_0x2a0640(0x139)]][0x0]+'</td>',_0x44efc0+=_0x2a0640(0x17f)+_0x3e4a5c+_0x2a0640(0x158),_0x44efc0+=_0x2a0640(0x142);}}}return console[_0x2a0640(0x13f)](_0x8e75bd[_0x2a0640(0x1ee)]),_0x44efc0;}router[a0_0x3a763f(0x182)](a0_0x3a763f(0x18f),auth,async(_0x209b20,_0x164814)=>{const _0x29b8ef=a0_0x3a763f,{from_date:_0x792bb,to_date:_0x12cb77}=_0x209b20[_0x29b8ef(0x1a6)],_0x5d04dd=await dataCheck(_0x792bb,_0x12cb77);{}let _0x35fee8='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x4d3cfc=new Date(_0x792bb),_0x26c777=new Date(_0x12cb77);const _0x1b49fd={'year':_0x29b8ef(0xc0),'month':_0x29b8ef(0x22e),'day':_0x29b8ef(0xc0)},_0x5d6ed0=new Intl['DateTimeFormat'](_0x29b8ef(0x233),_0x1b49fd)[_0x29b8ef(0x10d)](_0x4d3cfc),_0x1cfb8d=new Intl[(_0x29b8ef(0x138))](_0x29b8ef(0x233),_0x1b49fd)['format'](_0x26c777);_0x35fee8+=_0x29b8ef(0x148),_0x35fee8+=_0x29b8ef(0xd1),_0x35fee8+='<p>'+_0x5d6ed0+'\x20-\x20'+_0x1cfb8d+'</p>',_0x35fee8+=_0x29b8ef(0xc9),_0x35fee8+=_0x29b8ef(0x209),_0x35fee8+=_0x29b8ef(0x230),_0x35fee8+='<tr>',_0x35fee8+='<th\x20rowspan=\x272\x27>Category</th>',_0x35fee8+=_0x29b8ef(0x178),_0x35fee8+=_0x29b8ef(0x15e)+_0x5d6ed0+_0x29b8ef(0x145),_0x35fee8+=_0x29b8ef(0xd9),_0x35fee8+=_0x29b8ef(0x23f),_0x35fee8+=_0x29b8ef(0xb9)+_0x1cfb8d+_0x29b8ef(0x145),_0x35fee8+=_0x29b8ef(0x142),_0x35fee8+=_0x29b8ef(0x19e),_0x35fee8+=_0x29b8ef(0x162),_0x35fee8+=_0x29b8ef(0xbe),_0x35fee8+='</tr>',_0x35fee8+=_0x5d04dd,_0x35fee8+=_0x29b8ef(0x100),_0x35fee8+=_0x29b8ef(0x1aa),_0x35fee8+=_0x29b8ef(0x1aa);const _0x685b67={'format':_0x29b8ef(0xee),'orientation':_0x29b8ef(0x17c),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x29b8ef(0x194)}}};pdf[_0x29b8ef(0xbb)](_0x35fee8,_0x685b67)[_0x29b8ef(0x1ef)](function(_0x4bd509,_0x4f8cc7){const _0x5a6ad7=_0x29b8ef;if(_0x4bd509){_0x164814[_0x5a6ad7(0xf0)](0x1f4)[_0x5a6ad7(0x20a)](_0x5a6ad7(0x1e4));return;}_0x164814[_0x5a6ad7(0x223)](_0x5a6ad7(0x101),_0x5a6ad7(0x1a9)),_0x4f8cc7[_0x5a6ad7(0x1b2)](_0x164814);});}),router[a0_0x3a763f(0x11d)](a0_0x3a763f(0x10f),auth,async(_0x2d1727,_0x1784bd)=>{const _0x3b2fae=a0_0x3a763f;try{const {username:_0x212562,email:_0x434898,role:_0x195afa}=_0x2d1727[_0x3b2fae(0x231)],_0x1289b5=_0x2d1727[_0x3b2fae(0x231)],_0x46f036=await profile[_0x3b2fae(0x1d9)]({'email':_0x1289b5[_0x3b2fae(0xcd)]}),_0x3f3ffc={'year':'numeric','month':'long','day':_0x3b2fae(0xc0)},_0x55b3de=await master_shop[_0x3b2fae(0xc5)](),_0x2715f6=await product['find'](),_0x5c896c=await warehouse[_0x3b2fae(0x1ad)]([{'$unwind':_0x3b2fae(0xf9)},{'$lookup':{'from':_0x3b2fae(0x118),'localField':_0x3b2fae(0x152),'foreignField':'name','as':_0x3b2fae(0x236)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x3b2fae(0x1e6)}},{'$group':{'_id':_0x3b2fae(0x146),'product_stock':{'$sum':_0x3b2fae(0xf3)}}}]);if(_0x55b3de[0x0][_0x3b2fae(0x23d)]=='English\x20(US)')var _0x9498c4=users[_0x3b2fae(0xd2)];else{if(_0x55b3de[0x0][_0x3b2fae(0x23d)]==_0x3b2fae(0x14a))var _0x9498c4=users[_0x3b2fae(0x14a)];else{if(_0x55b3de[0x0][_0x3b2fae(0x23d)]==_0x3b2fae(0x149))var _0x9498c4=users[_0x3b2fae(0x149)];else{if(_0x55b3de[0x0]['language']==_0x3b2fae(0x21a))var _0x9498c4=users[_0x3b2fae(0x21a)];else{if(_0x55b3de[0x0][_0x3b2fae(0x23d)]==_0x3b2fae(0xe2))var _0x9498c4=users['French'];else{if(_0x55b3de[0x0][_0x3b2fae(0x23d)]==_0x3b2fae(0x1dc))var _0x9498c4=users['Portuguese'];else{if(_0x55b3de[0x0][_0x3b2fae(0x23d)]==_0x3b2fae(0x11a))var _0x9498c4=users[_0x3b2fae(0x11a)];else{if(_0x55b3de[0x0]['language']==_0x3b2fae(0x18e))var _0x9498c4=users[_0x3b2fae(0x217)];}}}}}}}_0x1784bd[_0x3b2fae(0x134)](_0x3b2fae(0x14e),{'success':_0x2d1727[_0x3b2fae(0xf6)](_0x3b2fae(0xdd)),'errors':_0x2d1727[_0x3b2fae(0xf6)](_0x3b2fae(0x1f3)),'alldata':_0x2715f6,'profile':_0x46f036,'master_shop':_0x55b3de,'role':_0x1289b5,'product_stock':_0x5c896c,'language':_0x9498c4});}catch(_0x2221b2){}});async function agentsdataCheck(_0x2804d2,_0x3b31d1){const _0x44fbf2=a0_0x3a763f,_0xe6315a=await product[_0x44fbf2(0x1ad)]([{'$group':{'_id':{'brand':_0x44fbf2(0xf2),'category':'$category'},'products':{'$push':{'name':_0x44fbf2(0x195),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3fb1ae=[];_0x3fb1ae['cat_brand']=[];for(let _0x274cd4=0x0;_0x274cd4<=_0xe6315a[_0x44fbf2(0xd3)]-0x1;_0x274cd4++){const _0x1be955=_0xe6315a[_0x274cd4];_0x3fb1ae['cat_brand']['push'](_0x1be955);}const _0x376c15=await product['aggregate']([{'$group':{'_id':{'category':_0x44fbf2(0x1f2)},'products':{'$push':{'brand':_0x44fbf2(0xf2),'product_code':'$product_code','product_name':_0x44fbf2(0x195)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1f1d5d=await product[_0x44fbf2(0x1ad)]([{'$group':{'_id':{'category':_0x44fbf2(0x1f2),'brand':_0x44fbf2(0xf2)}}},{'$group':{'_id':_0x44fbf2(0x104),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3e7818=await sales_sa[_0x44fbf2(0x1ad)]([{'$match':{'date':{'$gte':_0x2804d2,'$lte':_0x3b31d1}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x44fbf2(0x1d7)}}},{'$lookup':{'from':'staffs','localField':_0x44fbf2(0xce),'foreignField':_0x44fbf2(0x126),'as':_0x44fbf2(0x238)}},{'$unwind':_0x44fbf2(0x196)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x44fbf2(0x109)}},{'$lookup':{'from':_0x44fbf2(0x118),'localField':_0x44fbf2(0x23b),'foreignField':'product_code','as':_0x44fbf2(0x1eb)}},{'$unwind':_0x44fbf2(0x21f)},{'$group':{'_id':{'sales_id':'$sales_info._id','category':'$product_info.category','brand':_0x44fbf2(0x18c)},'salesman_data':{'$first':_0x44fbf2(0x179)},'totalQTY':{'$sum':_0x44fbf2(0x125)},'products':{'$push':{'qty':_0x44fbf2(0x125),'product_details':{'prod_name':_0x44fbf2(0x1ce),'product_code':'$product_info.product_code','category':_0x44fbf2(0x121),'brand':_0x44fbf2(0x18c)}}}}}]);let _0x1d4f42='';_0x1d4f42+='<tr>',_0x1d4f42+=_0x44fbf2(0x1cc),_0x1d4f42+=_0x44fbf2(0x142),_0x1d4f42+=_0x44fbf2(0x19e),_0x1d4f42+='<td\x20class=\x22cat_data\x22></td>';for(let _0x57807e=0x0;_0x57807e<=_0x376c15[_0x44fbf2(0xd3)]-0x1;_0x57807e++){const _0x172dcc=_0x376c15[_0x57807e];for(let _0x1e80da=0x0;_0x1e80da<_0x1f1d5d[_0x44fbf2(0xd3)];_0x1e80da++){const _0x1576e3=_0x1f1d5d[_0x1e80da];_0x1576e3[_0x44fbf2(0x126)]==_0x172dcc[_0x44fbf2(0x126)][_0x44fbf2(0x1ac)]&&(_0x1d4f42+=_0x44fbf2(0x192)+_0x1576e3[_0x44fbf2(0xe1)]+_0x44fbf2(0x22d)+_0x172dcc[_0x44fbf2(0x126)][_0x44fbf2(0x1ac)]+'</td>');}}_0x1d4f42+=_0x44fbf2(0x1b0),_0x1d4f42+=_0x44fbf2(0x142),_0x1d4f42+=_0x44fbf2(0x19e),_0x1d4f42+=_0x44fbf2(0x1c3);for(let _0x7f1a5b=0x0;_0x7f1a5b<=_0x376c15['length']-0x1;_0x7f1a5b++){const _0x2a5076=_0x376c15[_0x7f1a5b];for(let _0x161b99=0x0;_0x161b99<_0x3fb1ae[_0x44fbf2(0x102)][_0x44fbf2(0xd3)];_0x161b99++){const _0xadde0a=_0x3fb1ae['cat_brand'][_0x161b99];_0xadde0a[_0x44fbf2(0x126)]['category']==_0x2a5076[_0x44fbf2(0x126)]['category']&&(_0x1d4f42+='<td\x20class=\x22cat_data\x22>'+_0xadde0a[_0x44fbf2(0x126)][_0x44fbf2(0x139)]+_0x44fbf2(0x158));}}_0x1d4f42+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x1d4f42+='</tr>';let _0x1be25c={'name':[],'dataqty':{}};for(let _0x3e3c3a=0x0;_0x3e3c3a<_0x3fb1ae[_0x44fbf2(0x102)][_0x44fbf2(0xd3)];_0x3e3c3a++){const _0x47e1ab=_0x3fb1ae[_0x44fbf2(0x102)][_0x3e3c3a],_0x350d1c=_0x47e1ab[_0x44fbf2(0x126)][_0x44fbf2(0x139)],_0x3929e5=_0x47e1ab[_0x44fbf2(0x126)][_0x44fbf2(0x1ac)];!_0x1be25c['dataqty'][_0x350d1c]&&(_0x1be25c['dataqty'][_0x350d1c]={});!_0x1be25c[_0x44fbf2(0x1bf)][_0x350d1c][_0x3929e5]&&(_0x1be25c[_0x44fbf2(0x1bf)][_0x350d1c][_0x3929e5]=[]);for(let _0x1e4912=0x0;_0x1e4912<_0x3e7818[_0x44fbf2(0xd3)];_0x1e4912++){const _0x33c888=_0x3e7818[_0x1e4912];if(_0x350d1c===_0x33c888['_id'][_0x44fbf2(0x139)]&&_0x3929e5===_0x33c888[_0x44fbf2(0x126)]['category']){const _0x40b9d7=_0x33c888[_0x44fbf2(0x1c9)];!_0x1be25c[_0x44fbf2(0x1bf)][_0x350d1c][_0x3929e5][_0x40b9d7]&&(_0x1be25c[_0x44fbf2(0x1bf)][_0x350d1c][_0x3929e5][_0x40b9d7]=[]),_0x1be25c[_0x44fbf2(0x1bf)][_0x350d1c][_0x3929e5][_0x40b9d7]['push'](_0x33c888[_0x44fbf2(0x1ca)]),!_0x1be25c['name'][_0x44fbf2(0x220)](_0x40b9d7)&&_0x1be25c[_0x44fbf2(0x213)][_0x44fbf2(0x1ab)](_0x40b9d7);}}}_0x1d4f42+=_0x44fbf2(0x19e);for(let _0x4180fe=0x0;_0x4180fe<=_0x1be25c[_0x44fbf2(0x213)][_0x44fbf2(0xd3)]-0x1;_0x4180fe++){const _0x213809=_0x1be25c[_0x44fbf2(0x213)][_0x4180fe];_0x1d4f42+=_0x44fbf2(0x17f)+_0x213809+_0x44fbf2(0x158);var _0x202537=0x0,_0x15b3ee=0x0;for(let _0x2898d8=0x0;_0x2898d8<=_0x3fb1ae['cat_brand']['length']-0x1;_0x2898d8++){const _0x4b08c3=_0x3fb1ae['cat_brand'][_0x2898d8];var _0x3ae170=0x0;_0x1be25c[_0x44fbf2(0x1bf)][_0x4b08c3[_0x44fbf2(0x126)][_0x44fbf2(0x139)]][_0x4b08c3[_0x44fbf2(0x126)][_0x44fbf2(0x1ac)]][_0x213809]?(_0x3ae170=_0x1be25c[_0x44fbf2(0x1bf)][_0x4b08c3[_0x44fbf2(0x126)][_0x44fbf2(0x139)]][_0x4b08c3['_id'][_0x44fbf2(0x1ac)]][_0x213809][0x0],_0x1d4f42+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x3ae170[_0x44fbf2(0x16a)](0x2))+_0x44fbf2(0x158)):(_0x3ae170=0x0,_0x1d4f42+=_0x44fbf2(0x17f)+_0x3ae170+_0x44fbf2(0x158)),_0x202537+=_0x3ae170;}_0x1d4f42+=_0x44fbf2(0x17f)+formatNumber(_0x202537[_0x44fbf2(0x16a)](0x2))+_0x44fbf2(0x158);}return _0x1d4f42+='</tr>',_0x1d4f42;}router['post'](a0_0x3a763f(0x1f6),auth,async(_0x928a36,_0x14e127)=>{const _0x172651=a0_0x3a763f,{from_date:_0x1a5093,to_date:_0x3bf0c0}=_0x928a36[_0x172651(0x1a6)],_0x22b721=await agentsdataCheck(_0x1a5093,_0x3bf0c0);{}let _0xeea81f=_0x172651(0x10b);var _0x2523e8=new Date(_0x1a5093),_0xbf7f09=new Date(_0x3bf0c0);const _0x2938b4={'year':_0x172651(0xc0),'month':'long','day':_0x172651(0xc0)},_0x248ec8=new Intl[(_0x172651(0x138))]('en-US',_0x2938b4)[_0x172651(0x10d)](_0x2523e8),_0x2b2840=new Intl[(_0x172651(0x138))](_0x172651(0x233),_0x2938b4)[_0x172651(0x10d)](_0xbf7f09);_0xeea81f+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0xeea81f+=_0x172651(0x1fe),_0xeea81f+='<p>'+_0x248ec8+_0x172651(0x115)+_0x2b2840+'</p>',_0xeea81f+=_0x172651(0xc9),_0xeea81f+=_0x172651(0x209),_0xeea81f+=_0x172651(0x230),_0xeea81f+=_0x22b721,_0xeea81f+=_0x172651(0x100),_0xeea81f+=_0x172651(0x1aa),_0xeea81f+=_0x172651(0x1aa);const _0x5d7b6f={'format':_0x172651(0xee),'orientation':_0x172651(0x17c),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x172651(0x194)}}};pdf[_0x172651(0xbb)](_0xeea81f,_0x5d7b6f)[_0x172651(0x1ef)](function(_0xbf4999,_0x53cce7){const _0x38b3f4=_0x172651;if(_0xbf4999){_0x14e127[_0x38b3f4(0xf0)](0x1f4)['send'](_0x38b3f4(0x1e4));return;}_0x14e127['setHeader'](_0x38b3f4(0x101),'application/pdf'),_0x53cce7[_0x38b3f4(0x1b2)](_0x14e127);});}),router[a0_0x3a763f(0x11d)]('/agent_reports/sales_ad',auth,async(_0x41fde3,_0x4581ef)=>{const _0x224804=a0_0x3a763f;try{const {username:_0x5f1a90,email:_0x123504,role:_0x2fc34d}=_0x41fde3[_0x224804(0x231)],_0x1c0fca=_0x41fde3['user'],_0x37f11f=await profile[_0x224804(0x1d9)]({'email':_0x1c0fca[_0x224804(0xcd)]}),_0x2cf2ff={'year':'numeric','month':_0x224804(0x22e),'day':_0x224804(0xc0)},_0x13ed96=await master_shop[_0x224804(0xc5)](),_0x574720=await staff[_0x224804(0x1d9)]({'email':_0x1c0fca[_0x224804(0xcd)]}),_0x1828d4=await product[_0x224804(0xc5)](),_0x12e57b=await warehouse[_0x224804(0x1ad)]([{'$unwind':_0x224804(0xf9)},{'$lookup':{'from':_0x224804(0x118),'localField':_0x224804(0x152),'foreignField':'name','as':_0x224804(0x236)}},{'$unwind':_0x224804(0x224)},{'$project':{'product_name':_0x224804(0x21d),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x224804(0x146),'product_stock':{'$sum':_0x224804(0xf3)}}}]),_0x202170=await staff[_0x224804(0xc5)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x13ed96[0x0][_0x224804(0x23d)]==_0x224804(0x1a0))var _0x4e09df=users[_0x224804(0xd2)];else{if(_0x13ed96[0x0][_0x224804(0x23d)]==_0x224804(0x14a))var _0x4e09df=users[_0x224804(0x14a)];else{if(_0x13ed96[0x0][_0x224804(0x23d)]=='German')var _0x4e09df=users[_0x224804(0x149)];else{if(_0x13ed96[0x0][_0x224804(0x23d)]==_0x224804(0x21a))var _0x4e09df=users[_0x224804(0x21a)];else{if(_0x13ed96[0x0][_0x224804(0x23d)]=='French')var _0x4e09df=users[_0x224804(0xe2)];else{if(_0x13ed96[0x0][_0x224804(0x23d)]==_0x224804(0x1dc))var _0x4e09df=users[_0x224804(0x216)];else{if(_0x13ed96[0x0][_0x224804(0x23d)]==_0x224804(0x11a))var _0x4e09df=users[_0x224804(0x11a)];else{if(_0x13ed96[0x0][_0x224804(0x23d)]==_0x224804(0x18e))var _0x4e09df=users['Arabic'];}}}}}}}_0x4581ef['render'](_0x224804(0x14d),{'success':_0x41fde3['flash']('success'),'errors':_0x41fde3[_0x224804(0xf6)](_0x224804(0x1f3)),'alldata':_0x1828d4,'profile':_0x37f11f,'master_shop':_0x13ed96,'role':_0x1c0fca,'product_stock':_0x12e57b,'language':_0x4e09df,'staff_arr':_0x574720,'staff_data_all':_0x202170});}catch(_0x39b458){_0x4581ef[_0x224804(0xde)](_0x39b458);}});async function agentsdataDSICheck_admin(_0x64f7d,_0x1d5056,_0x38c49e,_0x5d6c01){const _0xa268d0=a0_0x3a763f,_0x134c9f=await product[_0xa268d0(0x1ad)]([{'$group':{'_id':{'brand':_0xa268d0(0xf2),'category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5cdcec=[];_0x5cdcec['cat_brand']=[];for(let _0x38798a=0x0;_0x38798a<=_0x134c9f['length']-0x1;_0x38798a++){const _0x224fda=_0x134c9f[_0x38798a];_0x5cdcec[_0xa268d0(0x102)][_0xa268d0(0x1ab)](_0x224fda);}const _0x433e3f=await product[_0xa268d0(0x1ad)]([{'$group':{'_id':{'category':_0xa268d0(0x1f2)},'products':{'$push':{'brand':_0xa268d0(0xf2),'product_code':_0xa268d0(0x1f9),'product_name':_0xa268d0(0x195)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4b5e17=await product[_0xa268d0(0x1ad)]([{'$group':{'_id':{'category':'$category','brand':_0xa268d0(0xf2)}}},{'$group':{'_id':_0xa268d0(0x104),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1c4e1d=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x64f7d,'$lte':_0x1d5056},'sales_staff_id':_0x38c49e,'sale_product.isFG':_0xa268d0(0x109)}},{'$unwind':_0xa268d0(0x10c)},{'$match':{'sale_product.isFG':_0xa268d0(0x109)}},{'$lookup':{'from':_0xa268d0(0x118),'localField':_0xa268d0(0x23b),'foreignField':_0xa268d0(0x1e1),'as':_0xa268d0(0x1eb)}},{'$unwind':_0xa268d0(0x21f)},{'$group':{'_id':{'dsi':_0xa268d0(0x19f),'date':_0xa268d0(0x1fa),'customer':_0xa268d0(0xb7)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0xa268d0(0x125),'NetPrice':_0xa268d0(0x1d0),'discount':_0xa268d0(0x1e3),'adj_discount':_0xa268d0(0x164),'product_details':{'prod_name':_0xa268d0(0x1ce),'product_code':_0xa268d0(0x123),'category':'$product_info.category','brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0xa268d0(0x176),'customer':_0xa268d0(0x240),'category':_0xa268d0(0x170),'brand':_0xa268d0(0x1bd)},'totalQty':{'$sum':_0xa268d0(0x19a)},'totalGross':{'$sum':{'$multiply':[_0xa268d0(0x19a),_0xa268d0(0x114)]}},'NetPrice':{'$sum':_0xa268d0(0x1e9)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0xa268d0(0x1fd)},'product_details':{'$first':_0xa268d0(0x225)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0xa268d0(0x176),'customer':'$_id.customer'},'totalQty':{'$sum':_0xa268d0(0xbf)},'totalGross':{'$sum':_0xa268d0(0xfe)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0xa268d0(0x226)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':_0xa268d0(0x104),'brand':_0xa268d0(0x136),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x326978=[],_0x22ccaf={},_0x4f7593={},_0x526af6={};var _0x370621=0x0,_0xea290e=0x0,_0x34c5fb=0x0,_0x36611a=0x0,_0xcac48f=0x0;const _0x4ba2ed=0x6;for(let _0xf43aa9=0x0;_0xf43aa9<=_0x1c4e1d[_0xa268d0(0xd3)]-0x1;_0xf43aa9++){const _0x221220=_0x1c4e1d[_0xf43aa9];let _0x210bdf=_0xa268d0(0x19e);_0x210bdf+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x221220['_id'][_0xa268d0(0xe6)]+'</td>',_0x210bdf+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x221220[_0xa268d0(0x126)]['date']+_0xa268d0(0x158),_0x210bdf+=_0xa268d0(0x1ae)+_0x221220['_id'][_0xa268d0(0x221)]+_0xa268d0(0x158);let _0x73a5f3={};var _0x18dbf1=0x0;for(let _0x23455b=0x0;_0x23455b<=_0x221220[_0xa268d0(0x118)][_0xa268d0(0xd3)]-0x1;_0x23455b++){const _0x3e9278=_0x221220[_0xa268d0(0x118)][_0x23455b];_0x73a5f3[_0x3e9278['brand']+'-'+_0x3e9278[_0xa268d0(0x1ac)]]=_0x3e9278[_0xa268d0(0xc7)];const _0x4442f2=_0x3e9278['brand']+'-'+_0x3e9278[_0xa268d0(0x1ac)];!_0x22ccaf[_0x4442f2]&&(_0x22ccaf[_0x4442f2]=0x0),!Array['isArray'](_0x526af6[_0x4442f2])&&(_0x526af6[_0x4442f2]=[]),!Array[_0xa268d0(0x177)](_0x526af6[_0x4442f2])&&(_0x526af6[_0x4442f2]=[]),_0x22ccaf[_0x4442f2]+=_0x3e9278[_0xa268d0(0xc7)],_0x526af6[_0x4442f2][_0xa268d0(0x1ab)](_0x3e9278['qty']),_0x18dbf1++;}console[_0xa268d0(0x13f)](_0x221220);for(let _0x8d17a7=0x0;_0x8d17a7<=_0x5cdcec[_0xa268d0(0x102)]['length']-0x1;_0x8d17a7++){const _0x896499=_0x5cdcec[_0xa268d0(0x102)][_0x8d17a7],_0x11ab83=_0x896499[_0xa268d0(0x126)]['brand']+'-'+_0x896499[_0xa268d0(0x126)][_0xa268d0(0x1ac)];_0x210bdf+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x73a5f3[_0x11ab83]!==undefined?_0x73a5f3[_0x11ab83]['toFixed'](0x2):'')+_0xa268d0(0x158);}_0x34c5fb=_0x221220[_0xa268d0(0x12a)]+_0x221220[_0xa268d0(0xdf)],_0x210bdf+=_0xa268d0(0xe0)+formatNumber(parseFloat(_0x221220[_0xa268d0(0x227)],0x2)[_0xa268d0(0x16a)](0x2))+_0xa268d0(0x158),_0x210bdf+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x221220[_0xa268d0(0xf7)][_0xa268d0(0x16a)](0x2))+_0xa268d0(0x158),_0x210bdf+=_0xa268d0(0xe0)+formatNumber(_0x34c5fb)+_0xa268d0(0x158),_0x210bdf+=_0xa268d0(0xe0)+formatNumber(_0x221220['NetPrice']['toFixed'](0x2))+'</td>',_0x210bdf+=_0xa268d0(0x142),_0x370621+=parseFloat(_0x221220[_0xa268d0(0x227)][_0xa268d0(0x16a)](0x2)),_0xea290e+=parseFloat(_0x221220[_0xa268d0(0xdc)]['toFixed'](0x2)),_0x36611a+=_0x34c5fb,_0xcac48f+=parseFloat(_0x221220['totalGross'][_0xa268d0(0x16a)](0x2));if(_0xf43aa9==_0x1c4e1d[_0xa268d0(0xd3)]-0x1){_0x210bdf+='<tr>',_0x210bdf+=_0xa268d0(0x1d4),_0x210bdf+=_0xa268d0(0x158);for(let _0x5e7411=0x0;_0x5e7411<=_0x5cdcec[_0xa268d0(0x102)][_0xa268d0(0xd3)]-0x1;_0x5e7411++){const _0x490996=_0x5cdcec[_0xa268d0(0x102)][_0x5e7411],_0x6286f1=_0x490996['_id'][_0xa268d0(0x139)]+'-'+_0x490996[_0xa268d0(0x126)][_0xa268d0(0x1ac)],_0x9b1763=_0x526af6[_0x6286f1][_0xa268d0(0x131)]((_0x3e7373,_0x18896a)=>_0x3e7373+_0x18896a,0x0);console['log'](_0xa268d0(0x1fc),_0x6286f1),_0x210bdf+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x9b1763!==undefined?formatNumber(_0x9b1763['toFixed'](0x2)):'')+_0xa268d0(0x175),console[_0xa268d0(0x13f)](_0x526af6[_0x6286f1][_0xa268d0(0x131)]((_0x20d222,_0x306c7b)=>_0x20d222+_0x306c7b,0x0));}_0x210bdf+=_0xa268d0(0xcf)+formatNumber(_0x370621[_0xa268d0(0x16a)](0x2))+'</b></td>',_0x210bdf+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xcac48f)+'</b></td>',_0x210bdf+=_0xa268d0(0xcf)+formatNumber(_0x36611a)+_0xa268d0(0x175),_0x210bdf+=_0xa268d0(0xcf)+formatNumber(_0xea290e)+_0xa268d0(0x175),_0x210bdf+='</tr>';}_0x326978[_0xa268d0(0x1ab)](_0x210bdf);}function _0x5e1071(_0x4c5c61,_0x217e35){const _0xba0e94=_0xa268d0,_0x57d16a=[];for(let _0x2aad2c=0x0;_0x2aad2c<=_0x4c5c61[_0xba0e94(0xd3)]-0x1;_0x2aad2c+=_0x217e35){_0x57d16a[_0xba0e94(0x1ab)](_0x4c5c61[_0xba0e94(0x203)](_0x2aad2c,_0x2aad2c+_0x217e35));}return _0x57d16a;}const _0x563bd0=_0x5e1071(_0x326978,_0x4ba2ed);let _0xf3611b='';return _0x563bd0[_0xa268d0(0x234)]((_0x32e0e1,_0xe9eeda)=>{const _0x38d54f=_0xa268d0;_0xe9eeda>0x0&&(_0xf3611b+=_0x38d54f(0x11e));_0xf3611b+=_0x38d54f(0x230),_0xf3611b+=_0x38d54f(0xbc),_0xf3611b+=_0x38d54f(0x19e),_0xf3611b+=_0x38d54f(0x22b),_0xf3611b+='</tr>',_0xf3611b+=_0x38d54f(0x19e),_0xf3611b+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x321c14=0x0;_0x321c14<=_0x433e3f[_0x38d54f(0xd3)]-0x1;_0x321c14++){const _0x177b17=_0x433e3f[_0x321c14];for(let _0x5e81b2=0x0;_0x5e81b2<_0x4b5e17[_0x38d54f(0xd3)];_0x5e81b2++){const _0x4890ae=_0x4b5e17[_0x5e81b2];_0x4890ae[_0x38d54f(0x126)]===_0x177b17[_0x38d54f(0x126)][_0x38d54f(0x1ac)]&&(_0xf3611b+='<td\x20colspan=\x22'+_0x4890ae[_0x38d54f(0xe1)]+_0x38d54f(0x22d)+_0x177b17['_id'][_0x38d54f(0x1ac)]+_0x38d54f(0x158));}}_0xf3611b+=_0x38d54f(0x130),_0xf3611b+=_0x38d54f(0x142),_0xf3611b+='<tr>',_0xf3611b+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0xf3611b+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0xf3611b+=_0x38d54f(0x19c);for(let _0x202fb2=0x0;_0x202fb2<=_0x433e3f['length']-0x1;_0x202fb2++){const _0x2af2ea=_0x433e3f[_0x202fb2];for(let _0xcd580a=0x0;_0xcd580a<_0x5cdcec[_0x38d54f(0x102)][_0x38d54f(0xd3)];_0xcd580a++){const _0x5c57a4=_0x5cdcec['cat_brand'][_0xcd580a];_0x5c57a4[_0x38d54f(0x126)][_0x38d54f(0x1ac)]===_0x2af2ea[_0x38d54f(0x126)][_0x38d54f(0x1ac)]&&(_0xf3611b+=_0x38d54f(0x222)+_0x5c57a4[_0x38d54f(0x126)][_0x38d54f(0x139)]+_0x38d54f(0x158));}}_0xf3611b+=_0x38d54f(0x119),_0xf3611b+=_0x38d54f(0xd8),_0xf3611b+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0xf3611b+=_0x38d54f(0xf1),_0xf3611b+=_0x38d54f(0x142),_0xf3611b+=_0x38d54f(0x129),_0xf3611b+=_0x38d54f(0x207),_0x32e0e1[_0x38d54f(0x234)](_0x131d4d=>{_0xf3611b+=_0x131d4d;}),console['log'](_0x526af6),_0xf3611b+=_0x38d54f(0x1f1),_0xf3611b+='</table>';}),_0xf3611b;}async function agentsdataDSICheck_admin_excel(_0x20d9ae,_0x52c139,_0x4b1b37,_0x37f79b){const _0x2e4bb2=a0_0x3a763f,_0x402430=await product[_0x2e4bb2(0x1ad)]([{'$group':{'_id':{'brand':'$brand','category':_0x2e4bb2(0x1f2)},'products':{'$push':{'name':'$name','product_code':_0x2e4bb2(0x1f9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5bc3cc=[];_0x5bc3cc[_0x2e4bb2(0x102)]=[];for(let _0x20eff3=0x0;_0x20eff3<=_0x402430[_0x2e4bb2(0xd3)]-0x1;_0x20eff3++){const _0x46634c=_0x402430[_0x20eff3];_0x5bc3cc[_0x2e4bb2(0x102)][_0x2e4bb2(0x1ab)](_0x46634c);}const _0x148a57=await product['aggregate']([{'$group':{'_id':{'category':_0x2e4bb2(0x1f2)},'products':{'$push':{'brand':_0x2e4bb2(0xf2),'product_code':_0x2e4bb2(0x1f9),'product_name':_0x2e4bb2(0x195)}}}},{'$sort':{'_id.category':-0x1}}]),_0xe8c3f5=await product['aggregate']([{'$group':{'_id':{'category':_0x2e4bb2(0x1f2),'brand':_0x2e4bb2(0xf2)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3c48c0=await sales_sa[_0x2e4bb2(0x1ad)]([{'$match':{'date':{'$gte':_0x20d9ae,'$lte':_0x52c139},'sales_staff_id':_0x4b1b37,'sale_product.isFG':_0x2e4bb2(0x109)}},{'$unwind':_0x2e4bb2(0x10c)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x2e4bb2(0x118),'localField':_0x2e4bb2(0x23b),'foreignField':_0x2e4bb2(0x1e1),'as':_0x2e4bb2(0x1eb)}},{'$unwind':_0x2e4bb2(0x21f)},{'$group':{'_id':{'dsi':_0x2e4bb2(0x19f),'date':_0x2e4bb2(0x1fa),'customer':'$customer'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x2e4bb2(0x125),'NetPrice':_0x2e4bb2(0x1d0),'discount':_0x2e4bb2(0x1e3),'adj_discount':_0x2e4bb2(0x164),'product_details':{'prod_name':'$product_info.name','product_code':_0x2e4bb2(0x123),'category':_0x2e4bb2(0x121),'brand':_0x2e4bb2(0x18c),'gross_price':_0x2e4bb2(0x140)}}}}},{'$unwind':_0x2e4bb2(0x106)},{'$group':{'_id':{'dsi':_0x2e4bb2(0x1af),'date':_0x2e4bb2(0x176),'customer':_0x2e4bb2(0x240),'category':'$products.product_details.category','brand':_0x2e4bb2(0x1bd)},'totalQty':{'$sum':_0x2e4bb2(0x19a)},'totalGross':{'$sum':{'$multiply':[_0x2e4bb2(0x19a),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x2e4bb2(0x120)},'adj_discount':{'$sum':_0x2e4bb2(0x1fd)},'product_details':{'$first':_0x2e4bb2(0x225)}}},{'$group':{'_id':{'dsi':_0x2e4bb2(0x1af),'date':_0x2e4bb2(0x176),'customer':_0x2e4bb2(0x240)},'totalQty':{'$sum':_0x2e4bb2(0xbf)},'totalGross':{'$sum':_0x2e4bb2(0xfe)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x2e4bb2(0xba)},'products':{'$push':{'qty':'$totalQty','category':_0x2e4bb2(0x104),'brand':_0x2e4bb2(0x136),'product_details':_0x2e4bb2(0xf9)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x1640ca=[],_0x29c053={},_0x843cfb={},_0x13ea0a={};var _0x558383=0x0,_0x4344d1=0x0,_0x416c83=0x0,_0x33d8e5=0x0,_0x48feac=0x0;const _0xa30ada=0x16345785d8a0000;for(let _0x1b7a23=0x0;_0x1b7a23<=_0x3c48c0[_0x2e4bb2(0xd3)]-0x1;_0x1b7a23++){const _0x3b1b73=_0x3c48c0[_0x1b7a23];let _0x4c8afd=_0x2e4bb2(0x19e);_0x4c8afd+=_0x2e4bb2(0x1ae)+_0x3b1b73[_0x2e4bb2(0x126)]['dsi']+_0x2e4bb2(0x158),_0x4c8afd+=_0x2e4bb2(0x1ae)+_0x3b1b73[_0x2e4bb2(0x126)][_0x2e4bb2(0x205)]+_0x2e4bb2(0x158),_0x4c8afd+=_0x2e4bb2(0x1ae)+_0x3b1b73[_0x2e4bb2(0x126)]['customer']+_0x2e4bb2(0x158);let _0x42dc5e={};var _0x569181=0x0;for(let _0xed5131=0x0;_0xed5131<=_0x3b1b73[_0x2e4bb2(0x118)][_0x2e4bb2(0xd3)]-0x1;_0xed5131++){const _0x1aa868=_0x3b1b73[_0x2e4bb2(0x118)][_0xed5131];_0x42dc5e[_0x1aa868['brand']+'-'+_0x1aa868[_0x2e4bb2(0x1ac)]]=_0x1aa868['qty'];const _0x49b1f7=_0x1aa868[_0x2e4bb2(0x139)]+'-'+_0x1aa868[_0x2e4bb2(0x1ac)];!_0x29c053[_0x49b1f7]&&(_0x29c053[_0x49b1f7]=0x0),!Array['isArray'](_0x13ea0a[_0x49b1f7])&&(_0x13ea0a[_0x49b1f7]=[]),!Array['isArray'](_0x13ea0a[_0x49b1f7])&&(_0x13ea0a[_0x49b1f7]=[]),_0x29c053[_0x49b1f7]+=_0x1aa868[_0x2e4bb2(0xc7)],_0x13ea0a[_0x49b1f7][_0x2e4bb2(0x1ab)](_0x1aa868[_0x2e4bb2(0xc7)]),_0x569181++;}console[_0x2e4bb2(0x13f)](_0x3b1b73);for(let _0x4372fb=0x0;_0x4372fb<=_0x5bc3cc[_0x2e4bb2(0x102)][_0x2e4bb2(0xd3)]-0x1;_0x4372fb++){const _0x4398d2=_0x5bc3cc['cat_brand'][_0x4372fb],_0x16dbb6=_0x4398d2['_id']['brand']+'-'+_0x4398d2['_id'][_0x2e4bb2(0x1ac)];_0x4c8afd+=_0x2e4bb2(0x197)+(_0x42dc5e[_0x16dbb6]!==undefined?_0x42dc5e[_0x16dbb6][_0x2e4bb2(0x16a)](0x2):'')+'</td>';}_0x416c83=_0x3b1b73[_0x2e4bb2(0x12a)]+_0x3b1b73[_0x2e4bb2(0xdf)],_0x4c8afd+=_0x2e4bb2(0xe0)+formatNumber(parseFloat(_0x3b1b73[_0x2e4bb2(0x227)],0x2)[_0x2e4bb2(0x16a)](0x2))+_0x2e4bb2(0x158),_0x4c8afd+=_0x2e4bb2(0xe0)+formatNumber(_0x3b1b73[_0x2e4bb2(0xf7)][_0x2e4bb2(0x16a)](0x2))+'</td>',_0x4c8afd+=_0x2e4bb2(0xe0)+formatNumber(_0x416c83)+_0x2e4bb2(0x158),_0x4c8afd+=_0x2e4bb2(0xe0)+formatNumber(_0x3b1b73[_0x2e4bb2(0xdc)][_0x2e4bb2(0x16a)](0x2))+_0x2e4bb2(0x158),_0x4c8afd+='</tr>',_0x558383+=parseFloat(_0x3b1b73[_0x2e4bb2(0x227)][_0x2e4bb2(0x16a)](0x2)),_0x4344d1+=parseFloat(_0x3b1b73['NetPrice']['toFixed'](0x2)),_0x33d8e5+=_0x416c83,_0x48feac+=parseFloat(_0x3b1b73[_0x2e4bb2(0xf7)][_0x2e4bb2(0x16a)](0x2));if(_0x1b7a23==_0x3c48c0['length']-0x1){_0x4c8afd+='<tr>',_0x4c8afd+=_0x2e4bb2(0x1d4),_0x4c8afd+=_0x2e4bb2(0x158);for(let _0x3fe07b=0x0;_0x3fe07b<=_0x5bc3cc[_0x2e4bb2(0x102)][_0x2e4bb2(0xd3)]-0x1;_0x3fe07b++){const _0x20527d=_0x5bc3cc[_0x2e4bb2(0x102)][_0x3fe07b],_0x3e787a=_0x20527d['_id']['brand']+'-'+_0x20527d[_0x2e4bb2(0x126)]['category'],_0x281cd6=_0x13ea0a[_0x3e787a]['reduce']((_0x688f10,_0x4b3f4e)=>_0x688f10+_0x4b3f4e,0x0);console[_0x2e4bb2(0x13f)](_0x2e4bb2(0x1fc),_0x3e787a),_0x4c8afd+=_0x2e4bb2(0x141)+(_0x281cd6!==undefined?formatNumber(_0x281cd6['toFixed'](0x2)):'')+'</b></td>',console[_0x2e4bb2(0x13f)](_0x13ea0a[_0x3e787a][_0x2e4bb2(0x131)]((_0x321f2f,_0x4befce)=>_0x321f2f+_0x4befce,0x0));}_0x4c8afd+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x558383[_0x2e4bb2(0x16a)](0x2))+_0x2e4bb2(0x175),_0x4c8afd+=_0x2e4bb2(0xcf)+formatNumber(_0x48feac)+'</b></td>',_0x4c8afd+=_0x2e4bb2(0xcf)+formatNumber(_0x33d8e5)+_0x2e4bb2(0x175),_0x4c8afd+=_0x2e4bb2(0xcf)+formatNumber(_0x4344d1)+'</b></td>',_0x4c8afd+=_0x2e4bb2(0x142);}_0x1640ca['push'](_0x4c8afd);}function _0x298437(_0x347b8d,_0x53232f){const _0xb8fe03=_0x2e4bb2,_0x137990=[];for(let _0x26f281=0x0;_0x26f281<=_0x347b8d[_0xb8fe03(0xd3)]-0x1;_0x26f281+=_0x53232f){_0x137990[_0xb8fe03(0x1ab)](_0x347b8d[_0xb8fe03(0x203)](_0x26f281,_0x26f281+_0x53232f));}return _0x137990;}const _0x464733=_0x298437(_0x1640ca,_0xa30ada);let _0x1a0e16='';return _0x464733[_0x2e4bb2(0x234)]((_0x324352,_0x50ed06)=>{const _0x264b51=_0x2e4bb2;_0x50ed06>0x0&&(_0x1a0e16+=_0x264b51(0x11e));_0x1a0e16+=_0x264b51(0x230),_0x1a0e16+=_0x264b51(0xbc),_0x1a0e16+=_0x264b51(0x19e),_0x1a0e16+=_0x264b51(0x22b),_0x1a0e16+=_0x264b51(0x142),_0x1a0e16+=_0x264b51(0x19e),_0x1a0e16+=_0x264b51(0x132);for(let _0xceb4f=0x0;_0xceb4f<=_0x148a57[_0x264b51(0xd3)]-0x1;_0xceb4f++){const _0x325dcf=_0x148a57[_0xceb4f];for(let _0x2dc033=0x0;_0x2dc033<_0xe8c3f5[_0x264b51(0xd3)];_0x2dc033++){const _0x20f1e8=_0xe8c3f5[_0x2dc033];_0x20f1e8[_0x264b51(0x126)]===_0x325dcf[_0x264b51(0x126)][_0x264b51(0x1ac)]&&(_0x1a0e16+=_0x264b51(0x192)+_0x20f1e8['brandCount']+_0x264b51(0x22d)+_0x325dcf[_0x264b51(0x126)][_0x264b51(0x1ac)]+_0x264b51(0x158));}}_0x1a0e16+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x1a0e16+=_0x264b51(0x142),_0x1a0e16+=_0x264b51(0x19e),_0x1a0e16+=_0x264b51(0x173),_0x1a0e16+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x1a0e16+=_0x264b51(0x19c);for(let _0x5c6ab2=0x0;_0x5c6ab2<=_0x148a57['length']-0x1;_0x5c6ab2++){const _0x23051e=_0x148a57[_0x5c6ab2];for(let _0x48bfe8=0x0;_0x48bfe8<_0x5bc3cc[_0x264b51(0x102)]['length'];_0x48bfe8++){const _0x3864fa=_0x5bc3cc[_0x264b51(0x102)][_0x48bfe8];_0x3864fa[_0x264b51(0x126)][_0x264b51(0x1ac)]===_0x23051e['_id'][_0x264b51(0x1ac)]&&(_0x1a0e16+='<td\x20class=\x22cat_data\x22>'+_0x3864fa[_0x264b51(0x126)][_0x264b51(0x139)]+_0x264b51(0x158));}}_0x1a0e16+=_0x264b51(0x119),_0x1a0e16+=_0x264b51(0xd8),_0x1a0e16+=_0x264b51(0x17d),_0x1a0e16+=_0x264b51(0xf1),_0x1a0e16+='</tr>',_0x1a0e16+=_0x264b51(0x129),_0x1a0e16+=_0x264b51(0x207),_0x324352[_0x264b51(0x234)](_0x2faffb=>{_0x1a0e16+=_0x2faffb;}),console[_0x264b51(0x13f)](_0x13ea0a),_0x1a0e16+=_0x264b51(0x1f1),_0x1a0e16+=_0x264b51(0x100);}),_0x1a0e16;}function a0_0x1ec7(){const _0x32b3da=['attr','</td>','thin','../middleware/auth','</p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','dsi_sales','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','<p>','dssr_view_admin','<th>Booking</th>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','$sale_product.adj_discount','setDate','12CesGHI','isFG','!merges','Sales\x20Report','toFixed','beg_bal','border-right','true','/agent_reports/view','prod_cat','$products.product_details.category','left','308oHWQDX','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','</b></td>','$_id.date','isArray','<th\x20rowspan=\x272\x27>Products</th>','$sales_info.name','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','landscape','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20class=\x22row_data\x22>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','60mm','post','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','totalPrice','/dsrr_admin/view_data/:id','<th>\x20INVOICE\x20AMOUNT\x20</th>','check_no','Router','sales_ext','pdfkit-table','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$product_info.brand','<td\x20class=\x22row_data\x22>0</td>','Arabic\x20(ae)','/balance/pdf','bottom','express','<td\x20colspan=\x22','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','/dev/null','$name','$sales_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','border-bottom','6KoaTcb','$products.qty','/agent_reports/pdf_admin','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','<tr>','$dsi','English\x20(US)','thick','$sale_product.product_code','636860GnXqCx','$check_no','$cash','body','/dsrr/view','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','application/pdf','</div>','push','category','aggregate','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','$_id.dsi','<td\x20class=\x22cat_data\x22></td>','607275OORoSj','pipe','$product.quantity','20mm','$product_list.product_name','table\x20tr','0.1in','product_name','Products\x20master','<th>\x20ENDING\x20BALANCE\x20</th>','window.onload\x20=\x20function()\x20{','getMonth','$products.product_details.brand','totalQTYsum','dataqty','bank','$status_data','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','$NetPrice','/inventory_sum/pdf','medium','15in','195717ZukDOj','salesman_data','totalQTY','getFullYear','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','$product_info.name','$product_list','$sale_product.totalprice','sumqty','toLocaleString','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','<td\x20colspan=\x223\x22><b>TOTAL<b>','../public/language/languages.json','Household','$sales_staff_id','html','findOne','window.print();','/getDSSR_no','Portuguese\x20(BR)','colspan','style','000000','$amount','product_code','exports','$sale_product.discount','Error\x20generating\x20PDF','\x22><b>','$product_details.product_stock','sales_man_code','date_include','$products.NetPrice','/dsrr_admin/view','product_info','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','jsbarcode','sales_bkg','toStream','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','</tbody>','$category','errors','<td\x20class=\x22row_data\x22></td>','$product_list.product_code','/agent/pdf','19797XCXixi','8.5in','$product_code','$date','deleteOne','test','$products.adj_discount','<p>SALES\x20REPORTS</p>','<td\x20class=\x22row_data\x22><b>','balanced','rowspan','buffer','slice','$sale_product._id','date','write','<tbody>','23176KDxAic','<div\x20class=\x22col-sm-11\x22>','send','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','Content-Disposition','<th>\x20SALES\x20</th>','html-pdf','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$sale_product.isFG','path','stock','name','catch','attachment;\x20filename=\x22sales_report.xlsx\x22','Portuguese','Arabic','/agent_reports/pdf','td,\x20th','Spanish','8XWmWAv','valueOf','$product_details.product_name','Products\x20warehouse_data','$product_info','includes','customer','<td\x20class=\x22cat_data\x22>','setHeader','$product_docs','$products.product_details','$discount','totalQty','<th>\x20ITEM\x20DESCRIPTION\x20</th>','Products\x20find_data','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','toLocaleDateString','\x22\x20class=\x22cat_data\x22>','long','NumberFormat','<table>','user','utils','en-US','forEach','/reports/dsrr/view','product_docs','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','sales_info','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','sale_product.product_code','border-left','language','$sale_product.product_name','<th\x20colspan=\x272\x27>SOLD</th>','$_id.customer','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','$sale_product.prod_cat','xlsx','$customer','trim','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','$adj_discount','create','<thead>','cash','<th>X-Truck</th>','$totalQty','numeric','border-top','referenceNumber','Types','findById','find','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','qty','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','<div\x20class=\x22row\x22>','book_new','$bank','save','email','sales_staff_id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','<p>FINISHED\x20GOODS\x20INVENTORY</p>','English','length','amount','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','image','7731779aSvlWx','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','<th\x20rowspan=\x272\x27>Production</th>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','inventory_sum','NetPrice','success','json','adj_discount','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','brandCount','French','toISOString','replace','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','dsi','/balance/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','<th>\x20ITEM\x20CODE\x20</th>','getDate','Asia/Manila','4670090bgPGWq','Letter','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','status','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','$brand','$product_stock','then','$_id.status_data','flash','totalGross','params','$product_details','text','<script>','/inventory_sum/view','attachment;\x20filename=\x22reports.xlsx\x22','$totalGross','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','</table>','Content-Type','cat_brand','$sale_product.quantity','$_id.category','staffs','$products','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','$product_list.product_stock','false','blob-stream','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$sale_product','format','split','/agent/view','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','redirect','!cols','/dl_excel','$products.product_details.gross_price','\x20-\x20','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','sales_reports','products','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','Chinese','\x22><b></b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','get','<div\x20style=\x22page-break-before:\x20always;\x22></div>','<th>\x20INCOMING\x20</th>','$products.discount','$product_info.category','mongoose','$product_info.product_code','filter','$sale_product.real_qty_unit_val','_id','<td\x20class=\x22cat_data\x22><b>FG</b></td>','note','</thead>','discount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','product_stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','</script>','top','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','reduce','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','express/lib/response','render','each','$_id.brand','load','DateTimeFormat','brand','book_append_sheet','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','<div\x20\x20id=\x22table-conatainer\x22>','$products.product_details.prod_id','aoa_to_sheet','log','$product_info.gross_price','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','</tr>','right','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','</th>','$product_name','/dsrr_admin/pdf_admin','<h1>JAKA\x20EQUITIES\x20CORP</h1>','German','Hindi','\x20-\x20STD','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','dsi_sales_admin','agent_sales','Standard','ObjectId','product_details','product_details.product_name','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$due_date','map','due_date'];a0_0x1ec7=function(){return _0x32b3da;};return a0_0x1ec7();}router[a0_0x3a763f(0x182)](a0_0x3a763f(0x19b),auth,async(_0x407a65,_0x5b17b1)=>{const _0x532dd1=a0_0x3a763f,{from_date:_0x3759b8,to_date:_0x22649a,isExcel:_0x1dca64,agent_id:_0x3e1750}=_0x407a65[_0x532dd1(0x1a6)],_0x2456a5=_0x407a65[_0x532dd1(0x231)],_0x19f8d1=await staff[_0x532dd1(0x1d9)]({'email':_0x2456a5[_0x532dd1(0xcd)]}),_0x2d2eeb=await master_shop[_0x532dd1(0xc5)](),_0x79ece5=await agentsdataDSICheck_admin(_0x3759b8,_0x22649a,_0x3e1750,_0x1dca64),_0x5895b8=await agentsdataDSICheck_admin_excel(_0x3759b8,_0x22649a,_0x3e1750,_0x1dca64);let _0x7b4184=_0x532dd1(0x153);var _0x3253e2=new Date(_0x3759b8),_0x20b86d=new Date(_0x22649a);const _0x34152f={'year':_0x532dd1(0xc0),'month':_0x532dd1(0x22e),'day':'numeric'},_0x391bae=new Intl[(_0x532dd1(0x138))](_0x532dd1(0x233),_0x34152f)['format'](_0x3253e2),_0x33ab7c=new Intl['DateTimeFormat']('en-US',_0x34152f)[_0x532dd1(0x10d)](_0x20b86d);_0x7b4184+=_0x532dd1(0xc9),_0x7b4184+='<div\x20\x20id=\x22table-conatainer\x22>',_0x7b4184+=_0x532dd1(0x230),_0x7b4184+=_0x79ece5,_0x7b4184+=_0x532dd1(0x100),_0x7b4184+='</div>',_0x7b4184+=_0x532dd1(0x1aa);let _0x431e4c=_0x532dd1(0x153);_0x431e4c+=_0x532dd1(0xc9),_0x431e4c+='<div\x20\x20id=\x22table-conatainer\x22>',_0x431e4c+=_0x532dd1(0x230),_0x431e4c+=_0x5895b8,_0x431e4c+='</table>',_0x431e4c+=_0x532dd1(0x1aa),_0x431e4c+=_0x532dd1(0x1aa);let _0x10ee65=_0x532dd1(0xe9);const _0x586704={'width':_0x532dd1(0x1c7),'height':_0x532dd1(0x1f8),'orientation':_0x532dd1(0x17c),'border':{'top':'0.1in','right':'0.1in','bottom':_0x532dd1(0x1b7),'left':_0x532dd1(0x1b7)},'header':{'height':_0x532dd1(0x181),'contents':_0x532dd1(0x110)+_0x10ee65+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x391bae+'\x20-\x20'+_0x33ab7c+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x532dd1(0x1b4),'contents':{'default':_0x532dd1(0x237)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x532dd1(0x194)}}};if(_0x1dca64=='on'){const _0x51f904=cheerio[_0x532dd1(0x137)](_0x431e4c);let _0x8c1769=[],_0x502b75=[],_0x529b8d=[];_0x51f904(_0x532dd1(0x1b6))[_0x532dd1(0x135)]((_0x59929f,_0x32ce77)=>{const _0x2b0eda=_0x532dd1;let _0x144a31=[],_0x1f7cdd=0x0;while(_0x529b8d[_0x1f7cdd]){_0x529b8d[_0x1f7cdd]--,_0x1f7cdd++;}_0x51f904(_0x32ce77)[_0x2b0eda(0xc5)](_0x2b0eda(0x219))[_0x2b0eda(0x135)]((_0x27f594,_0x123ed7)=>{const _0x5e116d=_0x2b0eda;let _0x51a130=_0x51f904(_0x123ed7)[_0x5e116d(0xfa)]()[_0x5e116d(0xb8)](),_0x117c3f=parseFloat(_0x51a130['replace'](/,/g,''));isNaN(_0x117c3f)&&(_0x117c3f=_0x51a130);let _0x2a498=parseInt(_0x51f904(_0x123ed7)[_0x5e116d(0x157)](_0x5e116d(0x1dd)))||0x1,_0x12373c=parseInt(_0x51f904(_0x123ed7)[_0x5e116d(0x157)](_0x5e116d(0x201)))||0x1;_0x144a31[_0x1f7cdd]=_0x117c3f;(_0x2a498>0x1||_0x12373c>0x1)&&_0x502b75[_0x5e116d(0x1ab)]({'s':{'r':_0x59929f,'c':_0x1f7cdd},'e':{'r':_0x59929f+_0x12373c-0x1,'c':_0x1f7cdd+_0x2a498-0x1}});for(let _0xc92154=0x0;_0xc92154<_0x2a498;_0xc92154++){_0x12373c>0x1&&(_0x529b8d[_0x1f7cdd+_0xc92154]=_0x12373c-0x1);}_0x1f7cdd+=_0x2a498;}),_0x8c1769[_0x2b0eda(0x1ab)](_0x144a31);});const _0x1be4e6=XLSX[_0x532dd1(0x232)]['book_new'](),_0x9d4352=XLSX[_0x532dd1(0x232)]['aoa_to_sheet'](_0x8c1769);_0x502b75[_0x532dd1(0xd3)]>0x0&&(_0x9d4352['!merges']=_0x502b75);_0x9d4352[_0x532dd1(0x112)]=_0x8c1769[0x0][_0x532dd1(0x155)](()=>({'wpx':0x64})),XLSX['utils'][_0x532dd1(0x13a)](_0x1be4e6,_0x9d4352,_0x532dd1(0x169));const _0xfac8bb=XLSX[_0x532dd1(0x206)](_0x1be4e6,{'bookType':_0x532dd1(0xb6),'type':_0x532dd1(0x202)});_0x5b17b1[_0x532dd1(0x223)]('Content-Disposition',_0x532dd1(0x215)),_0x5b17b1['setHeader'](_0x532dd1(0x101),_0x532dd1(0x193)),_0x5b17b1[_0x532dd1(0x20a)](_0xfac8bb);}else pdf[_0x532dd1(0xbb)](_0x7b4184,_0x586704)[_0x532dd1(0x1ef)](function(_0xf25145,_0x9a2e69){const _0x3dc337=_0x532dd1;if(_0xf25145){_0x5b17b1[_0x3dc337(0xf0)](0x1f4)[_0x3dc337(0x20a)]('Error\x20generating\x20PDF');return;}_0x5b17b1[_0x3dc337(0x223)](_0x3dc337(0x101),_0x3dc337(0x1a9)),_0x9a2e69[_0x3dc337(0x1b2)](_0x5b17b1);});}),router[a0_0x3a763f(0x11d)](a0_0x3a763f(0x16e),auth,async(_0x19b79f,_0x42f30c)=>{const _0x2537ec=a0_0x3a763f;try{const {username:_0x1face7,email:_0x63fd04,role:_0x8041c7}=_0x19b79f[_0x2537ec(0x231)],_0x29ec8b=_0x19b79f['user'],_0x9a0d3d=await profile[_0x2537ec(0x1d9)]({'email':_0x29ec8b[_0x2537ec(0xcd)]}),_0x19d1fe={'year':_0x2537ec(0xc0),'month':'long','day':'numeric'},_0x1fbe6d=await master_shop[_0x2537ec(0xc5)](),_0x133c3c=await staff[_0x2537ec(0x1d9)]({'email':_0x29ec8b[_0x2537ec(0xcd)]}),_0x23020e=await product[_0x2537ec(0xc5)](),_0x544838=await warehouse['aggregate']([{'$unwind':_0x2537ec(0xf9)},{'$lookup':{'from':_0x2537ec(0x118),'localField':_0x2537ec(0x152),'foreignField':_0x2537ec(0x213),'as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x2537ec(0x21d),'product_stock':_0x2537ec(0x1e6)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2537ec(0xf3)}}}]);if(_0x1fbe6d[0x0]['language']==_0x2537ec(0x1a0))var _0x3e9586=users[_0x2537ec(0xd2)];else{if(_0x1fbe6d[0x0][_0x2537ec(0x23d)]==_0x2537ec(0x14a))var _0x3e9586=users[_0x2537ec(0x14a)];else{if(_0x1fbe6d[0x0][_0x2537ec(0x23d)]==_0x2537ec(0x149))var _0x3e9586=users[_0x2537ec(0x149)];else{if(_0x1fbe6d[0x0][_0x2537ec(0x23d)]==_0x2537ec(0x21a))var _0x3e9586=users[_0x2537ec(0x21a)];else{if(_0x1fbe6d[0x0]['language']==_0x2537ec(0xe2))var _0x3e9586=users[_0x2537ec(0xe2)];else{if(_0x1fbe6d[0x0][_0x2537ec(0x23d)]==_0x2537ec(0x1dc))var _0x3e9586=users['Portuguese'];else{if(_0x1fbe6d[0x0][_0x2537ec(0x23d)]==_0x2537ec(0x11a))var _0x3e9586=users['Chinese'];else{if(_0x1fbe6d[0x0][_0x2537ec(0x23d)]==_0x2537ec(0x18e))var _0x3e9586=users[_0x2537ec(0x217)];}}}}}}}_0x42f30c[_0x2537ec(0x134)](_0x2537ec(0x15d),{'success':_0x19b79f['flash'](_0x2537ec(0xdd)),'errors':_0x19b79f[_0x2537ec(0xf6)](_0x2537ec(0x1f3)),'alldata':_0x23020e,'profile':_0x9a0d3d,'master_shop':_0x1fbe6d,'role':_0x29ec8b,'product_stock':_0x544838,'language':_0x3e9586,'staff_arr':_0x133c3c});}catch(_0x33a260){}});function formatNumber(_0x24b2af,_0x2ac3dc='en-US',_0x4665c6={'minimumFractionDigits':0x2}){const _0x4438bd=a0_0x3a763f,_0x2fad61=new Intl[(_0x4438bd(0x22f))](_0x2ac3dc,_0x4665c6);return _0x2fad61['format'](_0x24b2af);}function a0_0x27e8(_0x58a8a7,_0xd44606){const _0x1ec7e5=a0_0x1ec7();return a0_0x27e8=function(_0x27e894,_0x1e8180){_0x27e894=_0x27e894-0xb3;let _0x24f09c=_0x1ec7e5[_0x27e894];return _0x24f09c;},a0_0x27e8(_0x58a8a7,_0xd44606);}async function agentsdataDSICheck(_0x46c927,_0x19a748,_0x1ee80e,_0x25b0ce){const _0x52c2ed=a0_0x3a763f,_0x3630d1=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':'$name','product_code':_0x52c2ed(0x1f9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1bd1b7=[];_0x1bd1b7[_0x52c2ed(0x102)]=[];for(let _0x13263e=0x0;_0x13263e<=_0x3630d1[_0x52c2ed(0xd3)]-0x1;_0x13263e++){const _0x162a47=_0x3630d1[_0x13263e];_0x1bd1b7['cat_brand'][_0x52c2ed(0x1ab)](_0x162a47);}const _0x225e18=await product[_0x52c2ed(0x1ad)]([{'$group':{'_id':{'category':_0x52c2ed(0x1f2)},'products':{'$push':{'brand':_0x52c2ed(0xf2),'product_code':'$product_code','product_name':_0x52c2ed(0x195)}}}},{'$sort':{'_id.category':-0x1}}]),_0x2bfe95=await product['aggregate']([{'$group':{'_id':{'category':_0x52c2ed(0x1f2),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x43e72d=await sales_sa[_0x52c2ed(0x1ad)]([{'$match':{'date':{'$gte':_0x46c927,'$lte':_0x19a748},'sales_staff_id':_0x1ee80e,'sale_product.isFG':_0x52c2ed(0x109)}},{'$unwind':_0x52c2ed(0x10c)},{'$match':{'sale_product.isFG':_0x52c2ed(0x109)}},{'$lookup':{'from':'products','localField':_0x52c2ed(0x23b),'foreignField':_0x52c2ed(0x1e1),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x52c2ed(0x19f),'date':_0x52c2ed(0x1fa),'customer':_0x52c2ed(0xb7)},'totalQty':{'$sum':_0x52c2ed(0x125)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0x52c2ed(0x164),'product_details':{'prod_name':_0x52c2ed(0x1ce),'product_code':_0x52c2ed(0x123),'category':_0x52c2ed(0x121),'brand':_0x52c2ed(0x18c),'gross_price':_0x52c2ed(0x140)}}}}},{'$unwind':_0x52c2ed(0x106)},{'$group':{'_id':{'dsi':_0x52c2ed(0x1af),'date':'$_id.date','customer':'$_id.customer','category':_0x52c2ed(0x170),'brand':_0x52c2ed(0x1bd)},'totalQty':{'$sum':_0x52c2ed(0x19a)},'totalGross':{'$sum':{'$multiply':[_0x52c2ed(0x19a),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x52c2ed(0x1e9)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x52c2ed(0x1fd)},'product_details':{'$first':_0x52c2ed(0x225)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x52c2ed(0x176),'customer':_0x52c2ed(0x240)},'totalQty':{'$sum':_0x52c2ed(0xbf)},'totalGross':{'$sum':_0x52c2ed(0xfe)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x52c2ed(0xba)},'products':{'$push':{'qty':_0x52c2ed(0xbf),'category':'$_id.category','brand':_0x52c2ed(0x136),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x59d52e=[],_0x4c4762={},_0x2bb5fc={},_0x121ca9={};var _0x48572e=0x0,_0x1b0c18=0x0,_0x5528a8=0x0,_0x564527=0x0,_0x1e5439=0x0;const _0x5c626a=0x6;for(let _0x12f6a9=0x0;_0x12f6a9<=_0x43e72d[_0x52c2ed(0xd3)]-0x1;_0x12f6a9++){const _0x5bd560=_0x43e72d[_0x12f6a9];let _0x25bce3=_0x52c2ed(0x19e);_0x25bce3+=_0x52c2ed(0x1ae)+_0x5bd560['_id']['dsi']+'</td>',_0x25bce3+=_0x52c2ed(0x1ae)+_0x5bd560[_0x52c2ed(0x126)][_0x52c2ed(0x205)]+_0x52c2ed(0x158),_0x25bce3+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5bd560[_0x52c2ed(0x126)][_0x52c2ed(0x221)]+_0x52c2ed(0x158);let _0x34af68={};var _0x256569=0x0;for(let _0x391ab1=0x0;_0x391ab1<=_0x5bd560[_0x52c2ed(0x118)]['length']-0x1;_0x391ab1++){const _0x5d482d=_0x5bd560[_0x52c2ed(0x118)][_0x391ab1];_0x34af68[_0x5d482d[_0x52c2ed(0x139)]+'-'+_0x5d482d[_0x52c2ed(0x1ac)]]=_0x5d482d['qty'];const _0x3e657a=_0x5d482d[_0x52c2ed(0x139)]+'-'+_0x5d482d[_0x52c2ed(0x1ac)];!_0x4c4762[_0x3e657a]&&(_0x4c4762[_0x3e657a]=0x0),!Array['isArray'](_0x121ca9[_0x3e657a])&&(_0x121ca9[_0x3e657a]=[]),!Array[_0x52c2ed(0x177)](_0x121ca9[_0x3e657a])&&(_0x121ca9[_0x3e657a]=[]),_0x4c4762[_0x3e657a]+=_0x5d482d[_0x52c2ed(0xc7)],_0x121ca9[_0x3e657a][_0x52c2ed(0x1ab)](_0x5d482d[_0x52c2ed(0xc7)]),_0x256569++;}console[_0x52c2ed(0x13f)](_0x5bd560);for(let _0x4c39ac=0x0;_0x4c39ac<=_0x1bd1b7[_0x52c2ed(0x102)][_0x52c2ed(0xd3)]-0x1;_0x4c39ac++){const _0x435755=_0x1bd1b7[_0x52c2ed(0x102)][_0x4c39ac],_0x4a5168=_0x435755[_0x52c2ed(0x126)]['brand']+'-'+_0x435755[_0x52c2ed(0x126)][_0x52c2ed(0x1ac)];_0x25bce3+=_0x52c2ed(0x197)+(_0x34af68[_0x4a5168]!==undefined?_0x34af68[_0x4a5168]['toFixed'](0x2):'')+_0x52c2ed(0x158);}_0x5528a8=_0x5bd560[_0x52c2ed(0x12a)]+_0x5bd560[_0x52c2ed(0xdf)],_0x25bce3+=_0x52c2ed(0xe0)+formatNumber(parseFloat(_0x5bd560[_0x52c2ed(0x227)],0x2)[_0x52c2ed(0x16a)](0x2))+'</td>',_0x25bce3+=_0x52c2ed(0xe0)+formatNumber(_0x5bd560[_0x52c2ed(0xf7)]['toFixed'](0x2))+_0x52c2ed(0x158),_0x25bce3+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5528a8)+_0x52c2ed(0x158),_0x25bce3+=_0x52c2ed(0xe0)+formatNumber(_0x5bd560[_0x52c2ed(0xdc)][_0x52c2ed(0x16a)](0x2))+'</td>',_0x25bce3+=_0x52c2ed(0x142),_0x48572e+=parseFloat(_0x5bd560[_0x52c2ed(0x227)][_0x52c2ed(0x16a)](0x2)),_0x1b0c18+=parseFloat(_0x5bd560[_0x52c2ed(0xdc)][_0x52c2ed(0x16a)](0x2)),_0x564527+=_0x5528a8,_0x1e5439+=parseFloat(_0x5bd560[_0x52c2ed(0xf7)]['toFixed'](0x2));if(_0x12f6a9==_0x43e72d['length']-0x1){_0x25bce3+=_0x52c2ed(0x19e),_0x25bce3+=_0x52c2ed(0x1d4),_0x25bce3+=_0x52c2ed(0x158);for(let _0x449d86=0x0;_0x449d86<=_0x1bd1b7[_0x52c2ed(0x102)]['length']-0x1;_0x449d86++){const _0x1220c0=_0x1bd1b7['cat_brand'][_0x449d86],_0xe7e3=_0x1220c0[_0x52c2ed(0x126)]['brand']+'-'+_0x1220c0[_0x52c2ed(0x126)][_0x52c2ed(0x1ac)],_0x29b77f=_0x121ca9[_0xe7e3]['reduce']((_0x355e33,_0xe6a79)=>_0x355e33+_0xe6a79,0x0);_0x25bce3+=_0x52c2ed(0x141)+(_0x29b77f!==undefined?formatNumber(_0x29b77f[_0x52c2ed(0x16a)](0x2)):'')+'</b></td>',console[_0x52c2ed(0x13f)](_0x121ca9[_0xe7e3][_0x52c2ed(0x131)]((_0x5e5228,_0x1f12e2)=>_0x5e5228+_0x1f12e2,0x0));}_0x25bce3+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x48572e[_0x52c2ed(0x16a)](0x2))+_0x52c2ed(0x175),_0x25bce3+=_0x52c2ed(0xcf)+formatNumber(_0x1e5439)+'</b></td>',_0x25bce3+=_0x52c2ed(0xcf)+formatNumber(_0x564527)+_0x52c2ed(0x175),_0x25bce3+=_0x52c2ed(0xcf)+formatNumber(_0x1b0c18)+_0x52c2ed(0x175),_0x25bce3+=_0x52c2ed(0x142);}_0x59d52e[_0x52c2ed(0x1ab)](_0x25bce3);}function _0x2ee795(_0x3b8c51,_0x230d54){const _0x3be3ed=_0x52c2ed,_0x3c1ad5=[];for(let _0x2cbe5c=0x0;_0x2cbe5c<=_0x3b8c51[_0x3be3ed(0xd3)]-0x1;_0x2cbe5c+=_0x230d54){_0x3c1ad5[_0x3be3ed(0x1ab)](_0x3b8c51['slice'](_0x2cbe5c,_0x2cbe5c+_0x230d54));}return _0x3c1ad5;}const _0x278dbc=_0x2ee795(_0x59d52e,_0x5c626a);let _0x5474f3='';return _0x278dbc[_0x52c2ed(0x234)]((_0x3fe4a0,_0x43304d)=>{const _0x187bf0=_0x52c2ed;_0x43304d>0x0&&(_0x5474f3+=_0x187bf0(0x11e));_0x5474f3+=_0x187bf0(0x230),_0x5474f3+=_0x187bf0(0xbc),_0x5474f3+=_0x187bf0(0x19e),_0x5474f3+=_0x187bf0(0x22b),_0x5474f3+=_0x187bf0(0x142),_0x5474f3+='<tr>',_0x5474f3+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x3d73aa=0x0;_0x3d73aa<=_0x225e18[_0x187bf0(0xd3)]-0x1;_0x3d73aa++){const _0x200ce5=_0x225e18[_0x3d73aa];for(let _0x123757=0x0;_0x123757<_0x2bfe95[_0x187bf0(0xd3)];_0x123757++){const _0x4bcbe9=_0x2bfe95[_0x123757];_0x4bcbe9[_0x187bf0(0x126)]===_0x200ce5[_0x187bf0(0x126)][_0x187bf0(0x1ac)]&&(_0x5474f3+=_0x187bf0(0x192)+_0x4bcbe9[_0x187bf0(0xe1)]+_0x187bf0(0x22d)+_0x200ce5[_0x187bf0(0x126)][_0x187bf0(0x1ac)]+'</td>');}}_0x5474f3+=_0x187bf0(0x130),_0x5474f3+=_0x187bf0(0x142),_0x5474f3+=_0x187bf0(0x19e),_0x5474f3+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x5474f3+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x5474f3+=_0x187bf0(0x19c);for(let _0x444f82=0x0;_0x444f82<=_0x225e18['length']-0x1;_0x444f82++){const _0x2b7a1a=_0x225e18[_0x444f82];for(let _0x302efa=0x0;_0x302efa<_0x1bd1b7[_0x187bf0(0x102)]['length'];_0x302efa++){const _0x2b9797=_0x1bd1b7[_0x187bf0(0x102)][_0x302efa];_0x2b9797[_0x187bf0(0x126)][_0x187bf0(0x1ac)]===_0x2b7a1a[_0x187bf0(0x126)]['category']&&(_0x5474f3+=_0x187bf0(0x222)+_0x2b9797[_0x187bf0(0x126)]['brand']+_0x187bf0(0x158));}}_0x5474f3+=_0x187bf0(0x119),_0x5474f3+=_0x187bf0(0xd8),_0x5474f3+=_0x187bf0(0x17d),_0x5474f3+=_0x187bf0(0xf1),_0x5474f3+=_0x187bf0(0x142),_0x5474f3+=_0x187bf0(0x129),_0x5474f3+=_0x187bf0(0x207),_0x3fe4a0['forEach'](_0x3427db=>{_0x5474f3+=_0x3427db;}),console['log'](_0x121ca9),_0x5474f3+=_0x187bf0(0x1f1),_0x5474f3+=_0x187bf0(0x100);}),_0x5474f3;}async function agentsdataDSICheck_excel(_0x55b778,_0x4401d1,_0x56a44b,_0x9889ba){const _0xeb1151=a0_0x3a763f,_0x8ffaf1=await product[_0xeb1151(0x1ad)]([{'$group':{'_id':{'brand':_0xeb1151(0xf2),'category':'$category'},'products':{'$push':{'name':'$name','product_code':_0xeb1151(0x1f9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3f9e4c=[];_0x3f9e4c[_0xeb1151(0x102)]=[];for(let _0x28932f=0x0;_0x28932f<=_0x8ffaf1[_0xeb1151(0xd3)]-0x1;_0x28932f++){const _0x292e8f=_0x8ffaf1[_0x28932f];_0x3f9e4c[_0xeb1151(0x102)][_0xeb1151(0x1ab)](_0x292e8f);}const _0x4f1fb8=await product[_0xeb1151(0x1ad)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0xeb1151(0xf2),'product_code':_0xeb1151(0x1f9),'product_name':_0xeb1151(0x195)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4e6017=await product[_0xeb1151(0x1ad)]([{'$group':{'_id':{'category':'$category','brand':_0xeb1151(0xf2)}}},{'$group':{'_id':_0xeb1151(0x104),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x442973=await sales_sa[_0xeb1151(0x1ad)]([{'$match':{'date':{'$gte':_0x55b778,'$lte':_0x4401d1},'sales_staff_id':_0x56a44b,'sale_product.isFG':_0xeb1151(0x109)}},{'$unwind':_0xeb1151(0x10c)},{'$match':{'sale_product.isFG':_0xeb1151(0x109)}},{'$lookup':{'from':_0xeb1151(0x118),'localField':_0xeb1151(0x23b),'foreignField':_0xeb1151(0x1e1),'as':_0xeb1151(0x1eb)}},{'$unwind':_0xeb1151(0x21f)},{'$group':{'_id':{'dsi':_0xeb1151(0x19f),'date':_0xeb1151(0x1fa),'customer':'$customer'},'totalQty':{'$sum':_0xeb1151(0x125)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0xeb1151(0x1d0),'discount':'$sale_product.discount','adj_discount':_0xeb1151(0x164),'product_details':{'prod_name':_0xeb1151(0x1ce),'product_code':'$product_info.product_code','category':_0xeb1151(0x121),'brand':_0xeb1151(0x18c),'gross_price':_0xeb1151(0x140)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0xeb1151(0x176),'customer':_0xeb1151(0x240),'category':_0xeb1151(0x170),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0xeb1151(0x19a)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0xeb1151(0x114)]}},'NetPrice':{'$sum':_0xeb1151(0x1e9)},'discount':{'$sum':_0xeb1151(0x120)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0xeb1151(0x225)}}},{'$group':{'_id':{'dsi':_0xeb1151(0x1af),'date':_0xeb1151(0x176),'customer':'$_id.customer'},'totalQty':{'$sum':_0xeb1151(0xbf)},'totalGross':{'$sum':_0xeb1151(0xfe)},'NetPrice':{'$sum':_0xeb1151(0x1c4)},'discount':{'$sum':_0xeb1151(0x226)},'adj_discount':{'$sum':_0xeb1151(0xba)},'products':{'$push':{'qty':_0xeb1151(0xbf),'category':_0xeb1151(0x104),'brand':_0xeb1151(0x136),'product_details':_0xeb1151(0xf9)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4119de=[],_0x56af10={},_0x4145e6={},_0x1bce55={};var _0x574b0b=0x0,_0x2afc57=0x0,_0x58cb53=0x0,_0x57bc74=0x0,_0x56ce9a=0x0;const _0x3103df=0x9184e72a000;for(let _0x5ad32f=0x0;_0x5ad32f<=_0x442973[_0xeb1151(0xd3)]-0x1;_0x5ad32f++){const _0x5a45d2=_0x442973[_0x5ad32f];let _0x149b5c='<tr>';_0x149b5c+=_0xeb1151(0x1ae)+_0x5a45d2[_0xeb1151(0x126)][_0xeb1151(0xe6)]+_0xeb1151(0x158),_0x149b5c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5a45d2[_0xeb1151(0x126)][_0xeb1151(0x205)]+'</td>',_0x149b5c+=_0xeb1151(0x1ae)+_0x5a45d2[_0xeb1151(0x126)][_0xeb1151(0x221)]+_0xeb1151(0x158);let _0x153a64={};var _0x38f5af=0x0;for(let _0x445ea7=0x0;_0x445ea7<=_0x5a45d2['products'][_0xeb1151(0xd3)]-0x1;_0x445ea7++){const _0x16c58d=_0x5a45d2['products'][_0x445ea7];_0x153a64[_0x16c58d['brand']+'-'+_0x16c58d[_0xeb1151(0x1ac)]]=_0x16c58d['qty'];const _0x939eff=_0x16c58d['brand']+'-'+_0x16c58d[_0xeb1151(0x1ac)];!_0x56af10[_0x939eff]&&(_0x56af10[_0x939eff]=0x0),!Array[_0xeb1151(0x177)](_0x1bce55[_0x939eff])&&(_0x1bce55[_0x939eff]=[]),!Array[_0xeb1151(0x177)](_0x1bce55[_0x939eff])&&(_0x1bce55[_0x939eff]=[]),_0x56af10[_0x939eff]+=_0x16c58d['qty'],_0x1bce55[_0x939eff][_0xeb1151(0x1ab)](_0x16c58d[_0xeb1151(0xc7)]),_0x38f5af++;}console[_0xeb1151(0x13f)](_0x5a45d2);for(let _0x5f4c82=0x0;_0x5f4c82<=_0x3f9e4c[_0xeb1151(0x102)][_0xeb1151(0xd3)]-0x1;_0x5f4c82++){const _0xac734d=_0x3f9e4c['cat_brand'][_0x5f4c82],_0x19828b=_0xac734d['_id'][_0xeb1151(0x139)]+'-'+_0xac734d['_id'][_0xeb1151(0x1ac)];_0x149b5c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x153a64[_0x19828b]!==undefined?_0x153a64[_0x19828b][_0xeb1151(0x16a)](0x2):'')+_0xeb1151(0x158);}_0x58cb53=_0x5a45d2[_0xeb1151(0x12a)]+_0x5a45d2[_0xeb1151(0xdf)],_0x149b5c+=_0xeb1151(0xe0)+formatNumber(parseFloat(_0x5a45d2[_0xeb1151(0x227)],0x2)[_0xeb1151(0x16a)](0x2))+_0xeb1151(0x158),_0x149b5c+=_0xeb1151(0xe0)+formatNumber(_0x5a45d2['totalGross'][_0xeb1151(0x16a)](0x2))+'</td>',_0x149b5c+=_0xeb1151(0xe0)+formatNumber(_0x58cb53)+_0xeb1151(0x158),_0x149b5c+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5a45d2['NetPrice'][_0xeb1151(0x16a)](0x2))+_0xeb1151(0x158),_0x149b5c+='</tr>',_0x574b0b+=parseFloat(_0x5a45d2[_0xeb1151(0x227)]['toFixed'](0x2)),_0x2afc57+=parseFloat(_0x5a45d2['NetPrice'][_0xeb1151(0x16a)](0x2)),_0x57bc74+=_0x58cb53,_0x56ce9a+=parseFloat(_0x5a45d2[_0xeb1151(0xf7)][_0xeb1151(0x16a)](0x2));if(_0x5ad32f==_0x442973[_0xeb1151(0xd3)]-0x1){_0x149b5c+=_0xeb1151(0x19e),_0x149b5c+=_0xeb1151(0x1d4),_0x149b5c+=_0xeb1151(0x158);for(let _0x52b4b3=0x0;_0x52b4b3<=_0x3f9e4c[_0xeb1151(0x102)][_0xeb1151(0xd3)]-0x1;_0x52b4b3++){const _0x2e73eb=_0x3f9e4c[_0xeb1151(0x102)][_0x52b4b3],_0x3e8022=_0x2e73eb['_id'][_0xeb1151(0x139)]+'-'+_0x2e73eb[_0xeb1151(0x126)][_0xeb1151(0x1ac)],_0x56e0de=_0x1bce55[_0x3e8022]['reduce']((_0x481d40,_0x52e24e)=>_0x481d40+_0x52e24e,0x0);_0x149b5c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x56e0de!==undefined?formatNumber(_0x56e0de[_0xeb1151(0x16a)](0x2)):'')+_0xeb1151(0x175),console[_0xeb1151(0x13f)](_0x1bce55[_0x3e8022][_0xeb1151(0x131)]((_0x5b1731,_0x1afd03)=>_0x5b1731+_0x1afd03,0x0));}_0x149b5c+=_0xeb1151(0xcf)+formatNumber(_0x574b0b['toFixed'](0x2))+_0xeb1151(0x175),_0x149b5c+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x56ce9a)+_0xeb1151(0x175),_0x149b5c+=_0xeb1151(0xcf)+formatNumber(_0x57bc74)+'</b></td>',_0x149b5c+=_0xeb1151(0xcf)+formatNumber(_0x2afc57)+_0xeb1151(0x175),_0x149b5c+=_0xeb1151(0x142);}_0x4119de[_0xeb1151(0x1ab)](_0x149b5c);}function _0x4d9eaa(_0x31ee88,_0xcb1c36){const _0x48fec5=_0xeb1151,_0x43355f=[];for(let _0x50c314=0x0;_0x50c314<=_0x31ee88[_0x48fec5(0xd3)]-0x1;_0x50c314+=_0xcb1c36){_0x43355f[_0x48fec5(0x1ab)](_0x31ee88[_0x48fec5(0x203)](_0x50c314,_0x50c314+_0xcb1c36));}return _0x43355f;}const _0x3aabfe=_0x4d9eaa(_0x4119de,_0x3103df);let _0x24db23='';return _0x3aabfe['forEach']((_0x4d0d25,_0x43a67b)=>{const _0x7c8794=_0xeb1151;_0x43a67b>0x0&&(_0x24db23+=_0x7c8794(0x11e));_0x24db23+=_0x7c8794(0x230),_0x24db23+='<thead>',_0x24db23+='<tr>',_0x24db23+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x24db23+=_0x7c8794(0x142),_0x24db23+=_0x7c8794(0x19e),_0x24db23+=_0x7c8794(0x132);for(let _0xd775f5=0x0;_0xd775f5<=_0x4f1fb8[_0x7c8794(0xd3)]-0x1;_0xd775f5++){const _0x5baa65=_0x4f1fb8[_0xd775f5];for(let _0x48dccf=0x0;_0x48dccf<_0x4e6017[_0x7c8794(0xd3)];_0x48dccf++){const _0x52fe71=_0x4e6017[_0x48dccf];_0x52fe71['_id']===_0x5baa65[_0x7c8794(0x126)][_0x7c8794(0x1ac)]&&(_0x24db23+=_0x7c8794(0x192)+_0x52fe71['brandCount']+_0x7c8794(0x22d)+_0x5baa65[_0x7c8794(0x126)][_0x7c8794(0x1ac)]+'</td>');}}_0x24db23+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x24db23+='</tr>',_0x24db23+=_0x7c8794(0x19e),_0x24db23+=_0x7c8794(0x173),_0x24db23+=_0x7c8794(0x18b),_0x24db23+=_0x7c8794(0x19c);for(let _0x3a9b72=0x0;_0x3a9b72<=_0x4f1fb8['length']-0x1;_0x3a9b72++){const _0x1698eb=_0x4f1fb8[_0x3a9b72];for(let _0x13160a=0x0;_0x13160a<_0x3f9e4c[_0x7c8794(0x102)]['length'];_0x13160a++){const _0x57e848=_0x3f9e4c[_0x7c8794(0x102)][_0x13160a];_0x57e848['_id'][_0x7c8794(0x1ac)]===_0x1698eb[_0x7c8794(0x126)]['category']&&(_0x24db23+=_0x7c8794(0x222)+_0x57e848[_0x7c8794(0x126)][_0x7c8794(0x139)]+_0x7c8794(0x158));}}_0x24db23+=_0x7c8794(0x119),_0x24db23+=_0x7c8794(0xd8),_0x24db23+=_0x7c8794(0x17d),_0x24db23+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x24db23+=_0x7c8794(0x142),_0x24db23+=_0x7c8794(0x129),_0x24db23+=_0x7c8794(0x207),_0x4d0d25[_0x7c8794(0x234)](_0x5ab8a7=>{_0x24db23+=_0x5ab8a7;}),console[_0x7c8794(0x13f)](_0x1bce55),_0x24db23+=_0x7c8794(0x1f1),_0x24db23+=_0x7c8794(0x100);}),_0x24db23;}router[a0_0x3a763f(0x182)](a0_0x3a763f(0x218),auth,async(_0x1f8b0d,_0xe7f7c6)=>{const _0x3fbeb9=a0_0x3a763f,{from_date:_0x58bac3,to_date:_0x5bd3c6,isExcel:_0xc8ab7e}=_0x1f8b0d[_0x3fbeb9(0x1a6)],_0x3809a2=_0x1f8b0d[_0x3fbeb9(0x231)],_0x2de6dd=await staff[_0x3fbeb9(0x1d9)]({'email':_0x3809a2['email']}),_0x56e497=await master_shop[_0x3fbeb9(0xc5)]();console[_0x3fbeb9(0x13f)](_0x56e497[0x0][_0x3fbeb9(0xd6)]);const _0x121c45=await agentsdataDSICheck(_0x58bac3,_0x5bd3c6,_0x2de6dd[_0x3fbeb9(0x126)][_0x3fbeb9(0x21c)](),_0xc8ab7e),_0x20fc5d=await agentsdataDSICheck_excel(_0x58bac3,_0x5bd3c6,_0x2de6dd['_id'][_0x3fbeb9(0x21c)](),_0xc8ab7e);let _0x3f7e31=_0x3fbeb9(0x1a8);var _0x26c1b5=new Date(_0x58bac3),_0x2e9083=new Date(_0x5bd3c6);const _0x4d628c={'year':_0x3fbeb9(0xc0),'month':_0x3fbeb9(0x22e),'day':_0x3fbeb9(0xc0)},_0x2a6bd6=new Intl['DateTimeFormat'](_0x3fbeb9(0x233),_0x4d628c)[_0x3fbeb9(0x10d)](_0x26c1b5),_0x547d76=new Intl[(_0x3fbeb9(0x138))]('en-US',_0x4d628c)['format'](_0x2e9083);_0x3f7e31+=_0x3fbeb9(0xc9),_0x3f7e31+=_0x3fbeb9(0x13c),_0x3f7e31+=_0x3fbeb9(0x230),_0x3f7e31+=_0x121c45,_0x3f7e31+='</table>',_0x3f7e31+=_0x3fbeb9(0x1aa),_0x3f7e31+='</div>';let _0x3d3617='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x3d3617+=_0x3fbeb9(0xc9),_0x3d3617+=_0x3fbeb9(0x13c),_0x3d3617+='<table>',_0x3d3617+=_0x20fc5d,_0x3d3617+=_0x3fbeb9(0x100),_0x3d3617+=_0x3fbeb9(0x1aa),_0x3d3617+=_0x3fbeb9(0x1aa);let _0x5c335=_0x3fbeb9(0xe9);const _0x44d634={'width':_0x3fbeb9(0x1c7),'height':_0x3fbeb9(0x1f8),'orientation':_0x3fbeb9(0x17c),'border':{'top':_0x3fbeb9(0x1b7),'right':_0x3fbeb9(0x1b7),'bottom':_0x3fbeb9(0x1b7),'left':_0x3fbeb9(0x1b7)},'header':{'height':_0x3fbeb9(0x181),'contents':_0x3fbeb9(0x110)+_0x5c335+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x2a6bd6+_0x3fbeb9(0x115)+_0x547d76+_0x3fbeb9(0x180)},'footer':{'height':'20mm','contents':{'default':_0x3fbeb9(0x237)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3fbeb9(0x194)}}};if(_0xc8ab7e=='on'){const _0x5a4788=cheerio[_0x3fbeb9(0x137)](_0x3d3617);let _0xdb0f7d=[],_0x14a2ea=[],_0x10d726=[];const _0x4005e7=_0x54c1ea=>{const _0x52f796=_0x3fbeb9,_0x62f1ed={'top':{'style':_0x52f796(0x1a1),'color':{'rgb':_0x52f796(0x1df)}},'bottom':{'style':_0x52f796(0x1a1),'color':{'rgb':_0x52f796(0x1df)}},'left':{'style':_0x52f796(0x1a1),'color':{'rgb':_0x52f796(0x1df)}},'right':{'style':'thick','color':{'rgb':_0x52f796(0x1df)}}};if(_0x54c1ea){const _0x45cc91=_0x54c1ea[_0x52f796(0x10e)](';')[_0x52f796(0x131)]((_0x4113ee,_0x33a1ca)=>{const _0x4f9c49=_0x52f796,[_0x3696bc,_0x2a3056]=_0x33a1ca['split'](':')[_0x4f9c49(0x155)](_0x10003b=>_0x10003b[_0x4f9c49(0xb8)]());return _0x4113ee[_0x3696bc]=_0x2a3056,_0x4113ee;},{});_0x45cc91[_0x52f796(0xc1)]&&(_0x62f1ed[_0x52f796(0x12f)][_0x52f796(0x1de)]=_0x45cc91[_0x52f796(0xc1)]['includes'](_0x52f796(0x159))?'thin':_0x52f796(0x1c6)),_0x45cc91['border-bottom']&&(_0x62f1ed[_0x52f796(0x190)][_0x52f796(0x1de)]=_0x45cc91['border-bottom'][_0x52f796(0x220)](_0x52f796(0x159))?_0x52f796(0x159):_0x52f796(0x1c6)),_0x45cc91[_0x52f796(0x23c)]&&(_0x62f1ed['left'][_0x52f796(0x1de)]=_0x45cc91[_0x52f796(0x23c)][_0x52f796(0x220)](_0x52f796(0x159))?_0x52f796(0x159):_0x52f796(0x1c6)),_0x45cc91['border-right']&&(_0x62f1ed[_0x52f796(0x143)][_0x52f796(0x1de)]=_0x45cc91[_0x52f796(0x16c)][_0x52f796(0x220)](_0x52f796(0x159))?_0x52f796(0x159):_0x52f796(0x1c6));}return _0x62f1ed;};_0x5a4788(_0x3fbeb9(0x1b6))['each']((_0x63ba8d,_0x17afff)=>{const _0x2ae287=_0x3fbeb9;let _0x3e3daa=[],_0x498b7=0x0;while(_0x10d726[_0x498b7]){_0x10d726[_0x498b7]--,_0x498b7++;}_0x5a4788(_0x17afff)[_0x2ae287(0xc5)](_0x2ae287(0x219))[_0x2ae287(0x135)]((_0x45a9f6,_0x477939)=>{const _0x49326f=_0x2ae287;let _0x59e875=_0x5a4788(_0x477939)[_0x49326f(0xfa)]()[_0x49326f(0xb8)](),_0x5b1f08=parseFloat(_0x59e875[_0x49326f(0xe4)](/,/g,'')),_0x266e80={};!isNaN(_0x5b1f08)?(_0x266e80['v']=_0x5b1f08,_0x266e80['t']='n'):(_0x266e80['v']=_0x59e875,_0x266e80['t']='s');const _0x4b8c79=_0x5a4788(_0x477939)['attr'](_0x49326f(0x1de)),_0xcfb29b=_0x4005e7(_0x4b8c79);_0x266e80['s']={'border':_0xcfb29b},_0x3e3daa[_0x498b7]=_0x266e80;let _0x274b8b=parseInt(_0x5a4788(_0x477939)[_0x49326f(0x157)](_0x49326f(0x1dd)))||0x1,_0x4c2c84=parseInt(_0x5a4788(_0x477939)[_0x49326f(0x157)](_0x49326f(0x201)))||0x1;(_0x274b8b>0x1||_0x4c2c84>0x1)&&_0x14a2ea['push']({'s':{'r':_0x63ba8d,'c':_0x498b7},'e':{'r':_0x63ba8d+_0x4c2c84-0x1,'c':_0x498b7+_0x274b8b-0x1}});for(let _0x4b07c2=0x0;_0x4b07c2<_0x274b8b;_0x4b07c2++){_0x4c2c84>0x1&&(_0x10d726[_0x498b7+_0x4b07c2]=_0x4c2c84-0x1);}_0x498b7+=_0x274b8b;}),_0xdb0f7d[_0x2ae287(0x1ab)](_0x3e3daa);});const _0x457f1f=XLSX[_0x3fbeb9(0x232)][_0x3fbeb9(0xca)](),_0x13fef3=XLSX[_0x3fbeb9(0x232)][_0x3fbeb9(0x13e)](_0xdb0f7d);_0x14a2ea[_0x3fbeb9(0xd3)]>0x0&&(_0x13fef3[_0x3fbeb9(0x168)]=_0x14a2ea);_0x13fef3['!cols']=_0xdb0f7d[0x0][_0x3fbeb9(0x155)](()=>({'wpx':0x64})),XLSX[_0x3fbeb9(0x232)]['book_append_sheet'](_0x457f1f,_0x13fef3,_0x3fbeb9(0x169));const _0x15ca4b=XLSX[_0x3fbeb9(0x206)](_0x457f1f,{'bookType':_0x3fbeb9(0xb6),'type':'buffer'});_0xe7f7c6[_0x3fbeb9(0x223)](_0x3fbeb9(0x20c),_0x3fbeb9(0x215)),_0xe7f7c6[_0x3fbeb9(0x223)]('Content-Type',_0x3fbeb9(0x193)),_0xe7f7c6['send'](_0x15ca4b);}else pdf[_0x3fbeb9(0xbb)](_0x3f7e31,_0x44d634)[_0x3fbeb9(0x1ef)](function(_0x2cadf0,_0x6a6433){const _0x749c48=_0x3fbeb9;if(_0x2cadf0){console['error']('PDF\x20Generation\x20Error:',_0x2cadf0),_0xe7f7c6['status'](0x1f4)[_0x749c48(0x20a)](_0x749c48(0x1e4)+_0x2cadf0);return;}_0xe7f7c6[_0x749c48(0x223)](_0x749c48(0x101),_0x749c48(0x1a9)),_0x6a6433[_0x749c48(0x1b2)](_0xe7f7c6);});}),router[a0_0x3a763f(0x11d)]('/total_sales_reports/view',auth,async(_0xcdfec6,_0x52ed5a)=>{const _0xf7b039=a0_0x3a763f;try{const {username:_0x401403,email:_0x462d2d,role:_0x58df8d}=_0xcdfec6['user'],_0x1af762=_0xcdfec6[_0xf7b039(0x231)],_0x2836ff=await profile[_0xf7b039(0x1d9)]({'email':_0x1af762[_0xf7b039(0xcd)]}),_0x52fd14={'year':_0xf7b039(0xc0),'month':_0xf7b039(0x22e),'day':_0xf7b039(0xc0)},_0x110ac3=await master_shop['find'](),_0x56901e=await product[_0xf7b039(0xc5)](),_0x31d4d0=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0xf7b039(0x118),'localField':_0xf7b039(0x152),'foreignField':'name','as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0xf7b039(0x21d),'product_stock':_0xf7b039(0x1e6)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]),_0x15b513=await staff['findOne']({'email':_0x1af762['email']});if(_0x110ac3[0x0][_0xf7b039(0x23d)]==_0xf7b039(0x1a0))var _0x5111f6=users['English'];else{if(_0x110ac3[0x0][_0xf7b039(0x23d)]==_0xf7b039(0x14a))var _0x5111f6=users[_0xf7b039(0x14a)];else{if(_0x110ac3[0x0][_0xf7b039(0x23d)]==_0xf7b039(0x149))var _0x5111f6=users[_0xf7b039(0x149)];else{if(_0x110ac3[0x0][_0xf7b039(0x23d)]=='Spanish')var _0x5111f6=users[_0xf7b039(0x21a)];else{if(_0x110ac3[0x0][_0xf7b039(0x23d)]==_0xf7b039(0xe2))var _0x5111f6=users[_0xf7b039(0xe2)];else{if(_0x110ac3[0x0][_0xf7b039(0x23d)]==_0xf7b039(0x1dc))var _0x5111f6=users[_0xf7b039(0x216)];else{if(_0x110ac3[0x0][_0xf7b039(0x23d)]=='Chinese')var _0x5111f6=users[_0xf7b039(0x11a)];else{if(_0x110ac3[0x0]['language']==_0xf7b039(0x18e))var _0x5111f6=users[_0xf7b039(0x217)];}}}}}}}_0x52ed5a['render'](_0xf7b039(0x117),{'success':_0xcdfec6[_0xf7b039(0xf6)](_0xf7b039(0xdd)),'errors':_0xcdfec6[_0xf7b039(0xf6)]('errors'),'alldata':_0x56901e,'profile':_0x2836ff,'master_shop':_0x110ac3,'role':_0x1af762,'product_stock':_0x31d4d0,'language':_0x5111f6,'staff_arr':_0x15b513});}catch(_0x475d36){}});async function dataSalesReports(_0x430764,_0x21a0bf,_0x519fdd){const _0x15be3e=a0_0x3a763f;let _0x5a9f53='';const _0x3aad46=await sales_sa[_0x15be3e(0x1ad)]([{'$match':{'date':{'$gte':_0x430764,'$lte':_0x21a0bf},'sales_staff_id':_0x519fdd}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x15be3e(0x109)}},{'$group':{'_id':{'product_name':_0x15be3e(0x23e),'product_code':_0x15be3e(0x1a2)},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':_0x15be3e(0x1d0)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x3bdd62=0x0,_0x4dce92=0x0;for(let _0x16dd80=0x0;_0x16dd80<=_0x3aad46[_0x15be3e(0xd3)]-0x1;_0x16dd80++){const _0xf389e2=_0x3aad46[_0x16dd80];var _0x3413da=_0xf389e2[_0x15be3e(0x184)][_0x15be3e(0x1d2)](undefined),_0x1e6916=_0xf389e2[_0x15be3e(0x1d1)][_0x15be3e(0x1d2)](undefined);_0x5a9f53+='<tr>',_0x5a9f53+=_0x15be3e(0x17f)+_0xf389e2['_id'][_0x15be3e(0x1e1)]+_0x15be3e(0x158),_0x5a9f53+=_0x15be3e(0x17f)+_0xf389e2['_id'][_0x15be3e(0x1b8)]+_0x15be3e(0x158),_0x5a9f53+='<td\x20class=\x22row_data\x22>'+formatNumber(_0xf389e2[_0x15be3e(0x1d1)][_0x15be3e(0x16a)](0x2))+'</td>',_0x5a9f53+=_0x15be3e(0x17f)+formatNumber(_0xf389e2[_0x15be3e(0x184)][_0x15be3e(0x16a)](0x2))+'</td>',_0x5a9f53+=_0x15be3e(0x142),_0x3bdd62+=parseFloat(_0xf389e2['sumqty']),_0x4dce92+=parseFloat(_0xf389e2[_0x15be3e(0x184)]);}var _0x53c682=_0x4dce92[_0x15be3e(0x1d2)](undefined),_0x32aea3=_0x3bdd62[_0x15be3e(0x1d2)](undefined);return _0x5a9f53+='<tr>',_0x5a9f53+='<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>',_0x5a9f53+=_0x15be3e(0x1ff)+formatNumber(_0x3bdd62['toFixed'](0x2))+_0x15be3e(0x175),_0x5a9f53+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x4dce92['toFixed'](0x2))+_0x15be3e(0x175),_0x5a9f53+=_0x15be3e(0x142),_0x5a9f53;}router['post']('/total_sales_reports/pdf',auth,async(_0x2ee266,_0x51a49a)=>{const _0x414113=a0_0x3a763f;try{const {from_date:_0x63b9f2,to_date:_0x2f7a11,isExcel:_0x66eefc}=_0x2ee266[_0x414113(0x1a6)],_0x275d83=_0x2ee266[_0x414113(0x231)],_0x57812a=await staff[_0x414113(0x1d9)]({'email':_0x275d83[_0x414113(0xcd)]});let _0x3c8d97='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x426e72=new Date(_0x63b9f2),_0x2ccebe=new Date(_0x2f7a11);const _0x56e38c={'year':_0x414113(0xc0),'month':_0x414113(0x22e),'day':_0x414113(0xc0)},_0x4d8610=new Intl[(_0x414113(0x138))](_0x414113(0x233),_0x56e38c)[_0x414113(0x10d)](_0x426e72),_0x516a66=new Intl[(_0x414113(0x138))](_0x414113(0x233),_0x56e38c)[_0x414113(0x10d)](_0x2ccebe);var _0x340d3e=await dataSalesReports(_0x63b9f2,_0x2f7a11,_0x57812a[_0x414113(0x126)][_0x414113(0x21c)]());_0x3c8d97+=_0x414113(0xc9),_0x3c8d97+='<div\x20class=\x22col-sm-11\x22>',_0x3c8d97+='<table>',_0x3c8d97+=_0x414113(0x19e),_0x3c8d97+=_0x414113(0xea),_0x3c8d97+=_0x414113(0x228),_0x3c8d97+='<th>\x20QTY\x20SOLD\x20</th>',_0x3c8d97+=_0x414113(0x186),_0x3c8d97+=_0x414113(0x19e),_0x3c8d97+=_0x340d3e,_0x3c8d97+=_0x414113(0x142),_0x3c8d97+='</div>',_0x3c8d97+='</div>';let _0x1cb8d8='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x21e46a={'width':'15in','height':'8.5in','orientation':_0x414113(0x17c),'border':{'top':_0x414113(0x1b7),'right':_0x414113(0x1b7),'bottom':_0x414113(0x1b7),'left':_0x414113(0x1b7)},'header':{'height':_0x414113(0x181),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x1cb8d8+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x57812a['name']+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x4d8610+_0x414113(0x115)+_0x516a66+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x414113(0x1b4),'contents':{'default':_0x414113(0x237)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x414113(0x194)}}};if(_0x66eefc=='on'){const _0x4f8ab7=cheerio[_0x414113(0x137)](_0x3c8d97);let _0x86efc1=[],_0x4eba1a=[],_0x1dab2a=[];const _0x5f0179=_0x518f68=>{const _0x30076b=_0x414113,_0x2de843={'top':{'style':_0x30076b(0x1a1),'color':{'rgb':_0x30076b(0x1df)}},'bottom':{'style':_0x30076b(0x1a1),'color':{'rgb':_0x30076b(0x1df)}},'left':{'style':_0x30076b(0x1a1),'color':{'rgb':_0x30076b(0x1df)}},'right':{'style':_0x30076b(0x1a1),'color':{'rgb':_0x30076b(0x1df)}}};if(_0x518f68){const _0x33be7d=_0x518f68[_0x30076b(0x10e)](';')[_0x30076b(0x131)]((_0x2a2c49,_0x51bb76)=>{const _0x552c86=_0x30076b,[_0x233471,_0x40f366]=_0x51bb76[_0x552c86(0x10e)](':')['map'](_0x279ef8=>_0x279ef8[_0x552c86(0xb8)]());return _0x2a2c49[_0x233471]=_0x40f366,_0x2a2c49;},{});_0x33be7d[_0x30076b(0xc1)]&&(_0x2de843[_0x30076b(0x12f)][_0x30076b(0x1de)]=_0x33be7d['border-top'][_0x30076b(0x220)](_0x30076b(0x159))?_0x30076b(0x159):_0x30076b(0x1c6)),_0x33be7d[_0x30076b(0x198)]&&(_0x2de843['bottom'][_0x30076b(0x1de)]=_0x33be7d['border-bottom'][_0x30076b(0x220)](_0x30076b(0x159))?_0x30076b(0x159):_0x30076b(0x1c6)),_0x33be7d[_0x30076b(0x23c)]&&(_0x2de843[_0x30076b(0x171)]['style']=_0x33be7d['border-left'][_0x30076b(0x220)](_0x30076b(0x159))?'thin':'medium'),_0x33be7d[_0x30076b(0x16c)]&&(_0x2de843[_0x30076b(0x143)][_0x30076b(0x1de)]=_0x33be7d[_0x30076b(0x16c)][_0x30076b(0x220)](_0x30076b(0x159))?_0x30076b(0x159):_0x30076b(0x1c6));}return _0x2de843;};_0x4f8ab7(_0x414113(0x1b6))[_0x414113(0x135)]((_0x180eaa,_0x4cac95)=>{const _0xaca41=_0x414113;let _0x5a9d2c=[],_0x50c29d=0x0;while(_0x1dab2a[_0x50c29d]){_0x1dab2a[_0x50c29d]--,_0x50c29d++;}_0x4f8ab7(_0x4cac95)[_0xaca41(0xc5)](_0xaca41(0x219))['each']((_0xe1a4c5,_0x159b91)=>{const _0x2d46ea=_0xaca41;let _0x21ac6a=_0x4f8ab7(_0x159b91)[_0x2d46ea(0xfa)]()[_0x2d46ea(0xb8)](),_0x3fc387=parseFloat(_0x21ac6a[_0x2d46ea(0xe4)](/,/g,'')),_0x39f9f6={};!isNaN(_0x3fc387)?(_0x39f9f6['v']=_0x3fc387,_0x39f9f6['t']='n'):(_0x39f9f6['v']=_0x21ac6a,_0x39f9f6['t']='s');const _0x46336a=_0x4f8ab7(_0x159b91)[_0x2d46ea(0x157)]('style'),_0x3ddf61=_0x5f0179(_0x46336a);_0x39f9f6['s']={'border':_0x3ddf61},_0x5a9d2c[_0x50c29d]=_0x39f9f6;let _0x52adb5=parseInt(_0x4f8ab7(_0x159b91)[_0x2d46ea(0x157)]('colspan'))||0x1,_0x989d17=parseInt(_0x4f8ab7(_0x159b91)[_0x2d46ea(0x157)](_0x2d46ea(0x201)))||0x1;(_0x52adb5>0x1||_0x989d17>0x1)&&_0x4eba1a[_0x2d46ea(0x1ab)]({'s':{'r':_0x180eaa,'c':_0x50c29d},'e':{'r':_0x180eaa+_0x989d17-0x1,'c':_0x50c29d+_0x52adb5-0x1}});for(let _0x48624d=0x0;_0x48624d<_0x52adb5;_0x48624d++){_0x989d17>0x1&&(_0x1dab2a[_0x50c29d+_0x48624d]=_0x989d17-0x1);}_0x50c29d+=_0x52adb5;}),_0x86efc1['push'](_0x5a9d2c);});const _0x56f56f=XLSX['utils'][_0x414113(0xca)](),_0x2d3c94=XLSX[_0x414113(0x232)]['aoa_to_sheet'](_0x86efc1);_0x4eba1a[_0x414113(0xd3)]>0x0&&(_0x2d3c94[_0x414113(0x168)]=_0x4eba1a);_0x2d3c94[_0x414113(0x112)]=_0x86efc1[0x0][_0x414113(0x155)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x56f56f,_0x2d3c94,'Sales\x20Report');const _0x3659f0=XLSX[_0x414113(0x206)](_0x56f56f,{'bookType':_0x414113(0xb6),'type':_0x414113(0x202)});_0x51a49a[_0x414113(0x223)](_0x414113(0x20c),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x51a49a[_0x414113(0x223)](_0x414113(0x101),_0x414113(0x193)),_0x51a49a['send'](_0x3659f0);}else pdf['create'](_0x3c8d97,_0x21e46a)[_0x414113(0x1ef)](function(_0x47be17,_0x5a1d75){const _0x4d74a1=_0x414113;if(_0x47be17){_0x51a49a[_0x4d74a1(0xf0)](0x1f4)[_0x4d74a1(0x20a)](_0x4d74a1(0x1e4));return;}_0x51a49a[_0x4d74a1(0x223)](_0x4d74a1(0x101),_0x4d74a1(0x1a9)),_0x5a1d75[_0x4d74a1(0x1b2)](_0x51a49a);});}catch(_0x1302ff){}}),router[a0_0x3a763f(0x11d)](a0_0x3a763f(0xfc),auth,async(_0x3478ce,_0x4ea7f4)=>{const _0x14cbd6=a0_0x3a763f;try{const {username:_0x50a4dc,email:_0x15b6aa,role:_0x253c18}=_0x3478ce[_0x14cbd6(0x231)],_0x31f419=_0x3478ce[_0x14cbd6(0x231)],_0x6d5245=await profile['findOne']({'email':_0x31f419[_0x14cbd6(0xcd)]}),_0x26789e={'year':_0x14cbd6(0xc0),'month':'long','day':_0x14cbd6(0xc0)},_0x1b22cd=await master_shop['find'](),_0x3ab04b=await product['find'](),_0x183239=await warehouse[_0x14cbd6(0x1ad)]([{'$unwind':_0x14cbd6(0xf9)},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':_0x14cbd6(0x213),'as':_0x14cbd6(0x236)}},{'$unwind':_0x14cbd6(0x224)},{'$project':{'product_name':_0x14cbd6(0x21d),'product_stock':_0x14cbd6(0x1e6)}},{'$group':{'_id':_0x14cbd6(0x146),'product_stock':{'$sum':_0x14cbd6(0xf3)}}}]);if(_0x1b22cd[0x0][_0x14cbd6(0x23d)]==_0x14cbd6(0x1a0))var _0x1aa96e=users['English'];else{if(_0x1b22cd[0x0][_0x14cbd6(0x23d)]==_0x14cbd6(0x14a))var _0x1aa96e=users[_0x14cbd6(0x14a)];else{if(_0x1b22cd[0x0][_0x14cbd6(0x23d)]==_0x14cbd6(0x149))var _0x1aa96e=users[_0x14cbd6(0x149)];else{if(_0x1b22cd[0x0][_0x14cbd6(0x23d)]==_0x14cbd6(0x21a))var _0x1aa96e=users[_0x14cbd6(0x21a)];else{if(_0x1b22cd[0x0][_0x14cbd6(0x23d)]==_0x14cbd6(0xe2))var _0x1aa96e=users[_0x14cbd6(0xe2)];else{if(_0x1b22cd[0x0]['language']==_0x14cbd6(0x1dc))var _0x1aa96e=users['Portuguese'];else{if(_0x1b22cd[0x0][_0x14cbd6(0x23d)]==_0x14cbd6(0x11a))var _0x1aa96e=users['Chinese'];else{if(_0x1b22cd[0x0]['language']=='Arabic\x20(ae)')var _0x1aa96e=users[_0x14cbd6(0x217)];}}}}}}}_0x4ea7f4[_0x14cbd6(0x134)](_0x14cbd6(0xdb),{'success':_0x3478ce[_0x14cbd6(0xf6)](_0x14cbd6(0xdd)),'errors':_0x3478ce[_0x14cbd6(0xf6)](_0x14cbd6(0x1f3)),'alldata':_0x3ab04b,'profile':_0x6d5245,'master_shop':_0x1b22cd,'role':_0x31f419,'product_stock':_0x183239,'language':_0x1aa96e});}catch(_0x4f7e88){}});async function dataInventoryReports(_0x42fbfc,_0x1d8a36,_0xca0a4f){const _0x21bc6c=a0_0x3a763f,_0x2c409a=await sales_sa[_0x21bc6c(0x1ad)]([{'$match':{'date':{'$gte':_0x42fbfc,'$lte':_0x1d8a36},'sales_staff_id':_0xca0a4f}},{'$unwind':_0x21bc6c(0x10c)},{'$group':{'_id':{'product_name':_0x21bc6c(0x23e),'product_code':_0x21bc6c(0x1a2)},'sumqty':{'$sum':_0x21bc6c(0x103)}}},{'$sort':{'_id.product_name':0x1}}]),_0x21bf16=mongoose[_0x21bc6c(0xc3)][_0x21bc6c(0x150)],_0x4e2b6d=await staff[_0x21bc6c(0x1ad)]([{'$match':{'_id':_0x21bf16(_0xca0a4f)}},{'$unwind':_0x21bc6c(0x1cf)},{'$match':{'product_list.isConfirm':_0x21bc6c(0x16d)}},{'$group':{'_id':{'product_name':_0x21bc6c(0x1b5),'product_code':_0x21bc6c(0x1f5)},'sumqty':{'$sum':_0x21bc6c(0x108)}}},{'$sort':{'_id.product_name':0x1}}]),_0x26acc0=await sales_inv_data[_0x21bc6c(0x1ad)]([{'$match':{'date':{'$gte':_0x42fbfc,'$lte':_0x1d8a36},'sales_staff_id':_0xca0a4f}},{'$unwind':_0x21bc6c(0x10c)},{'$group':{'_id':{'product_name':_0x21bc6c(0x23e),'product_code':_0x21bc6c(0x1a2)},'totalQTYsum':{'$sum':'$sale_product.stock'}}}]);console[_0x21bc6c(0x13f)](_0x26acc0);let _0xddd088='';var _0x531383=0x0;for(let _0x17c4f3=0x0;_0x17c4f3<=_0x4e2b6d['length']-0x1;_0x17c4f3++){const _0x5e2f7e=_0x4e2b6d[_0x17c4f3];_0xddd088+=_0x21bc6c(0x19e),_0xddd088+=_0x21bc6c(0x116)+_0x5e2f7e[_0x21bc6c(0x126)][_0x21bc6c(0x1e1)]+_0x21bc6c(0x158),_0xddd088+=_0x21bc6c(0x183)+_0x5e2f7e['_id'][_0x21bc6c(0x1b8)]+'</td>';var _0x58aebe=_0x5e2f7e['sumqty'],_0x32d2e0=0x0;for(let _0x196ba5=0x0;_0x196ba5<=_0x2c409a['length']-0x1;_0x196ba5++){const _0x32615b=_0x2c409a[_0x196ba5];_0x5e2f7e['_id'][_0x21bc6c(0x1e1)]==_0x32615b[_0x21bc6c(0x126)][_0x21bc6c(0x1e1)]&&_0x5e2f7e[_0x21bc6c(0x126)]['product_name']==_0x32615b['_id'][_0x21bc6c(0x1b8)]&&(_0x32d2e0=_0x32615b['sumqty']);}var _0x58bbfe=0x0;for(let _0x503e42=0x0;_0x503e42<=_0x26acc0[_0x21bc6c(0xd3)]-0x1;_0x503e42++){const _0x418a27=_0x26acc0[_0x503e42];_0x5e2f7e[_0x21bc6c(0x126)]['product_code']==_0x418a27[_0x21bc6c(0x126)][_0x21bc6c(0x1e1)]&&_0x5e2f7e[_0x21bc6c(0x126)]['product_name']==_0x418a27['_id'][_0x21bc6c(0x1b8)]&&(_0x58bbfe=_0x418a27[_0x21bc6c(0x1be)]);}_0x531383=_0x58aebe-_0x58bbfe+_0x32d2e0,_0xddd088+=_0x21bc6c(0x17f)+_0x531383+_0x21bc6c(0x158);let _0x7923fb=![];for(let _0xeef4b9=0x0;_0xeef4b9<=_0x26acc0[_0x21bc6c(0xd3)]-0x1;_0xeef4b9++){const _0x46a254=_0x26acc0[_0xeef4b9];if(_0x5e2f7e[_0x21bc6c(0x126)]['product_code']==_0x46a254[_0x21bc6c(0x126)][_0x21bc6c(0x1e1)]&&_0x5e2f7e[_0x21bc6c(0x126)][_0x21bc6c(0x1b8)]==_0x46a254[_0x21bc6c(0x126)][_0x21bc6c(0x1b8)]){_0xddd088+=_0x21bc6c(0x17f)+_0x46a254[_0x21bc6c(0x1be)]+_0x21bc6c(0x158),_0x7923fb=!![];break;}}!_0x7923fb&&(_0xddd088+=_0x21bc6c(0x18d));let _0x1cc22d=![];for(let _0x5ba3ca=0x0;_0x5ba3ca<=_0x2c409a['length']-0x1;_0x5ba3ca++){const _0x8bc1cc=_0x2c409a[_0x5ba3ca];if(_0x5e2f7e[_0x21bc6c(0x126)]['product_code']==_0x8bc1cc[_0x21bc6c(0x126)]['product_code']&&_0x5e2f7e[_0x21bc6c(0x126)][_0x21bc6c(0x1b8)]==_0x8bc1cc[_0x21bc6c(0x126)]['product_name']){_0xddd088+=_0x21bc6c(0x17f)+_0x8bc1cc[_0x21bc6c(0x1d1)]+_0x21bc6c(0x158),_0x1cc22d=!![];break;}}!_0x1cc22d&&(_0xddd088+=_0x21bc6c(0x18d)),_0xddd088+=_0x21bc6c(0x17f)+_0x5e2f7e['sumqty']+_0x21bc6c(0x158),_0xddd088+=_0x21bc6c(0x142);}return _0xddd088;}router[a0_0x3a763f(0x182)](a0_0x3a763f(0x1c5),auth,async(_0x23e32a,_0x3a40ba)=>{const _0x15577c=a0_0x3a763f;try{const {from_date:_0x199d32,to_date:_0x3b34aa}=_0x23e32a[_0x15577c(0x1a6)],_0x4ef5f8=_0x23e32a[_0x15577c(0x231)],_0x5425ac=await staff['findOne']({'email':_0x4ef5f8[_0x15577c(0xcd)]});let _0x4d755f=_0x15577c(0x239);var _0x2ea4ac=new Date(_0x199d32),_0x42bcc5=new Date(_0x3b34aa);const _0x1ab7e7={'year':_0x15577c(0xc0),'month':_0x15577c(0x22e),'day':_0x15577c(0xc0)},_0x29138e=new Intl['DateTimeFormat'](_0x15577c(0x233),_0x1ab7e7)[_0x15577c(0x10d)](_0x2ea4ac),_0x1b33d3=new Intl[(_0x15577c(0x138))](_0x15577c(0x233),_0x1ab7e7)['format'](_0x42bcc5);var _0x53eef8=await dataInventoryReports(_0x199d32,_0x3b34aa,_0x5425ac['_id'][_0x15577c(0x21c)]());_0x4d755f+=_0x15577c(0x148),_0x4d755f+='<p>INVENTORY\x20SUMMARY</p>',_0x4d755f+=_0x15577c(0x160)+_0x29138e+'\x20-\x20'+_0x1b33d3+_0x15577c(0x15b),_0x4d755f+=_0x15577c(0xc9),_0x4d755f+=_0x15577c(0x209),_0x4d755f+=_0x15577c(0x230),_0x4d755f+=_0x15577c(0x19e),_0x4d755f+=_0x15577c(0xea),_0x4d755f+=_0x15577c(0x228),_0x4d755f+='<th>\x20BEG\x20BALANCE\x20</th>',_0x4d755f+=_0x15577c(0x11f),_0x4d755f+=_0x15577c(0x20d),_0x4d755f+=_0x15577c(0x1ba),_0x4d755f+=_0x15577c(0x19e),_0x4d755f+=_0x53eef8,_0x4d755f+=_0x15577c(0x142),_0x4d755f+=_0x15577c(0x1aa),_0x4d755f+=_0x15577c(0x1aa);const _0x165e8f={'format':_0x15577c(0xee),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf[_0x15577c(0xbb)](_0x4d755f,_0x165e8f)[_0x15577c(0x1ef)](function(_0x49b4b6,_0x2028a1){const _0x34558e=_0x15577c;if(_0x49b4b6){_0x3a40ba[_0x34558e(0xf0)](0x1f4)['send'](_0x34558e(0x1e4));return;}_0x3a40ba[_0x34558e(0x223)](_0x34558e(0x101),_0x34558e(0x1a9)),_0x2028a1['pipe'](_0x3a40ba);});}catch(_0x2fb0a4){}}),router[a0_0x3a763f(0x11d)](a0_0x3a763f(0x1a7),auth,async(_0x38a627,_0x2e19a7)=>{const _0x259f43=a0_0x3a763f;try{const {username:_0x2a02d1,email:_0x152533,role:_0x391eec}=_0x38a627[_0x259f43(0x231)],_0x1c6762=_0x38a627[_0x259f43(0x231)],_0x21e384=await profile['findOne']({'email':_0x1c6762[_0x259f43(0xcd)]}),_0x505dcb={'year':_0x259f43(0xc0),'month':'long','day':_0x259f43(0xc0)},_0x22aa3e=await master_shop[_0x259f43(0xc5)]();console[_0x259f43(0x13f)]('Products\x20master',_0x22aa3e);const _0x401580=await product['find']();console['log']('Products\x20find_data',_0x401580);const _0x51b6c9=await warehouse[_0x259f43(0x1ad)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x259f43(0x118),'localField':'product_details.product_name','foreignField':_0x259f43(0x213),'as':_0x259f43(0x236)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x259f43(0x21d),'product_stock':_0x259f43(0x1e6)}},{'$group':{'_id':_0x259f43(0x146),'product_stock':{'$sum':_0x259f43(0xf3)}}}]);console[_0x259f43(0x13f)](_0x259f43(0x21e),_0x51b6c9),_0x51b6c9[_0x259f43(0x234)](_0x34ceb2=>{const _0x5ea7be=_0x259f43,_0x349b62=_0x401580[_0x5ea7be(0x155)](_0x509a2b=>{const _0x5bf717=_0x5ea7be;_0x509a2b[_0x5bf717(0x213)]==_0x34ceb2[_0x5bf717(0x126)]&&(_0x509a2b[_0x5bf717(0x212)]=parseInt(_0x509a2b[_0x5bf717(0x212)])+parseInt(_0x34ceb2[_0x5bf717(0x12c)]));});});const _0x5714c0=await staff[_0x259f43(0x1d9)]({'email':_0x1c6762[_0x259f43(0xcd)]});if(_0x22aa3e[0x0][_0x259f43(0x23d)]==_0x259f43(0x1a0))var _0x339f98=users[_0x259f43(0xd2)];else{if(_0x22aa3e[0x0][_0x259f43(0x23d)]==_0x259f43(0x14a))var _0x339f98=users[_0x259f43(0x14a)];else{if(_0x22aa3e[0x0][_0x259f43(0x23d)]==_0x259f43(0x149))var _0x339f98=users[_0x259f43(0x149)];else{if(_0x22aa3e[0x0][_0x259f43(0x23d)]==_0x259f43(0x21a))var _0x339f98=users[_0x259f43(0x21a)];else{if(_0x22aa3e[0x0][_0x259f43(0x23d)]==_0x259f43(0xe2))var _0x339f98=users['French'];else{if(_0x22aa3e[0x0][_0x259f43(0x23d)]==_0x259f43(0x1dc))var _0x339f98=users[_0x259f43(0x216)];else{if(_0x22aa3e[0x0][_0x259f43(0x23d)]==_0x259f43(0x11a))var _0x339f98=users['Chinese'];else{if(_0x22aa3e[0x0][_0x259f43(0x23d)]==_0x259f43(0x18e))var _0x339f98=users[_0x259f43(0x217)];}}}}}}}_0x2e19a7[_0x259f43(0x134)]('dssr_view',{'success':_0x38a627[_0x259f43(0xf6)](_0x259f43(0xdd)),'errors':_0x38a627[_0x259f43(0xf6)](_0x259f43(0x1f3)),'alldata':_0x401580,'profile':_0x21e384,'master_shop':_0x22aa3e,'role':_0x1c6762,'product_stock':_0x51b6c9,'language':_0x339f98,'staff_arr':_0x5714c0});}catch(_0x2e5c7b){}});async function agentsdataDSICheck_DSRR(_0x2afce9,_0x393ff5,_0x573531,_0x42449d){const _0x48c803=a0_0x3a763f;let _0x307c4a=new Date(_0x2afce9);_0x307c4a[_0x48c803(0x165)](_0x307c4a[_0x48c803(0xeb)]()-0x1);let _0x1d8251=_0x307c4a[_0x48c803(0xe3)]()[_0x48c803(0x10e)]('T')[0x0];const _0x22150e=await product[_0x48c803(0x1ad)]([{'$group':{'_id':{'brand':_0x48c803(0xf2),'category':_0x48c803(0x1f2)},'products':{'$push':{'name':_0x48c803(0x195),'product_code':_0x48c803(0x1f9)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x4aa6a6=[];_0x4aa6a6[_0x48c803(0x102)]=[];for(let _0x130034=0x0;_0x130034<=_0x22150e[_0x48c803(0xd3)]-0x1;_0x130034++){const _0x5e8b4c=_0x22150e[_0x130034];_0x4aa6a6[_0x48c803(0x102)]['push'](_0x5e8b4c);}const _0x27d4eb=await product[_0x48c803(0x1ad)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x48c803(0xf2),'product_code':_0x48c803(0x1f9),'product_name':_0x48c803(0x195)}}}},{'$sort':{'_id.category':-0x1}}]),_0x24fda9=await product[_0x48c803(0x1ad)]([{'$group':{'_id':{'category':_0x48c803(0x1f2),'brand':_0x48c803(0xf2)}}},{'$group':{'_id':_0x48c803(0x104),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4c467b=await sales_sa[_0x48c803(0x1ad)]([{'$match':{'date':_0x2afce9,'sales_staff_id':_0x393ff5,'sale_product.isFG':_0x48c803(0x109)}},{'$unwind':_0x48c803(0x10c)},{'$lookup':{'from':_0x48c803(0x118),'localField':'sale_product.product_code','foreignField':'product_code','as':'product_info'}},{'$unwind':_0x48c803(0x21f)},{'$group':{'_id':{'dsi':_0x48c803(0x19f),'date':'$date','customer':'$customer','status_data':_0x48c803(0x1c1)},'totalQty':{'$sum':_0x48c803(0x125)},'cash':{'$first':'$cash'},'amount':{'$first':_0x48c803(0x1e0)},'bank':{'$first':_0x48c803(0xcb)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x48c803(0x154)},'products':{'$push':{'qty':_0x48c803(0x125),'NetPrice':_0x48c803(0x1d0),'discount':_0x48c803(0x1e3),'adj_discount':_0x48c803(0x164),'product_details':{'prod_name':'$product_info.name','product_code':_0x48c803(0x123),'category':_0x48c803(0x121),'brand':'$product_info.brand','gross_price':_0x48c803(0x140),'isFG':_0x48c803(0x210),'prod_cat':_0x48c803(0xb5),'prod_id':'$sale_product._id'}}}}},{'$unwind':_0x48c803(0x106)},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x48c803(0x240),'status_data':_0x48c803(0xf5),'category':_0x48c803(0x170),'brand':_0x48c803(0x1bd),'prod_id':_0x48c803(0x13d)},'totalQty':{'$sum':_0x48c803(0x19a)},'totalGross':{'$sum':{'$multiply':[_0x48c803(0x19a),_0x48c803(0x114)]}},'NetPrice':{'$sum':_0x48c803(0x1e9)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x48c803(0x1fd)},'cash':{'$first':_0x48c803(0x1a5)},'amount':{'$first':_0x48c803(0x1e0)},'bank':{'$first':_0x48c803(0xcb)},'check_no':{'$first':_0x48c803(0x1a4)},'due_date':{'$first':_0x48c803(0x154)},'product_details':{'$first':_0x48c803(0x225)}}},{'$group':{'_id':{'dsi':_0x48c803(0x1af),'date':_0x48c803(0x176),'customer':_0x48c803(0x240),'status_data':_0x48c803(0xf5)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x48c803(0xfe)},'NetPrice':{'$sum':_0x48c803(0x1c4)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'cash':{'$first':_0x48c803(0x1a5)},'amount':{'$first':_0x48c803(0x1e0)},'bank':{'$first':_0x48c803(0xcb)},'check_no':{'$first':_0x48c803(0x1a4)},'due_date':{'$first':_0x48c803(0x154)},'products':{'$push':{'qty':_0x48c803(0xbf),'category':_0x48c803(0x104),'brand':_0x48c803(0x136),'product_details':_0x48c803(0xf9)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x2a4f6a=await sales_sa[_0x48c803(0x1ad)]([{'$match':{'date':_0x1d8251,'sales_staff_id':_0x393ff5,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$lookup':{'from':'products','localField':_0x48c803(0x23b),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x48c803(0x21f)},{'$group':{'_id':{'dsi':_0x48c803(0x19f),'date':_0x48c803(0x1fa),'customer':'$customer'},'totalQty':{'$sum':_0x48c803(0x125)},'cash':{'$first':'$cash'},'amount':{'$first':_0x48c803(0x1e0)},'bank':{'$first':_0x48c803(0xcb)},'check_no':{'$first':_0x48c803(0x1a4)},'due_date':{'$first':_0x48c803(0x154)},'products':{'$push':{'qty':_0x48c803(0x125),'NetPrice':'$sale_product.totalprice','discount':_0x48c803(0x1e3),'adj_discount':_0x48c803(0x164),'product_details':{'prod_name':_0x48c803(0x1ce),'product_code':_0x48c803(0x123),'category':_0x48c803(0x121),'brand':_0x48c803(0x18c),'gross_price':'$product_info.gross_price','isFG':'$sale_product.isFG','prod_cat':_0x48c803(0xb5),'prod_id':_0x48c803(0x204)}}}}},{'$unwind':_0x48c803(0x106)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x48c803(0x176),'customer':'$_id.customer','category':_0x48c803(0x170),'brand':_0x48c803(0x1bd),'prod_id':_0x48c803(0x13d)},'totalQty':{'$sum':'$products.qty'},'cash':{'$first':'$cash'},'amount':{'$first':_0x48c803(0x1e0)},'bank':{'$first':_0x48c803(0xcb)},'check_no':{'$first':_0x48c803(0x1a4)},'due_date':{'$first':_0x48c803(0x154)},'totalGross':{'$sum':{'$multiply':[_0x48c803(0x19a),_0x48c803(0x114)]}},'NetPrice':{'$sum':_0x48c803(0x1e9)},'discount':{'$sum':_0x48c803(0x120)},'adj_discount':{'$sum':_0x48c803(0x1fd)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x48c803(0x1af),'date':'$_id.date','customer':_0x48c803(0x240)},'totalQty':{'$sum':_0x48c803(0xbf)},'cash':{'$first':'$cash'},'amount':{'$first':_0x48c803(0x1e0)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x48c803(0x1a4)},'due_date':{'$first':_0x48c803(0x154)},'totalGross':{'$sum':_0x48c803(0xfe)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x48c803(0x226)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x48c803(0xbf),'category':_0x48c803(0x104),'brand':_0x48c803(0x136),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x577e4e=await sales_sa[_0x48c803(0x1ad)]([{'$match':{'date':_0x2afce9,'sales_staff_id':_0x393ff5,'status_data':_0x48c803(0x16d)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x482820=await staff['findById'](_0x393ff5);let _0x209b35=[],_0x2b9327={},_0x25cd80={};var _0x18cc13=0x0,_0x59c193=0x0,_0x16a7ea=0x0,_0x200925=0x0,_0x23bafe=0x0;const _0x4f6369=0x6;var _0x4843fa=0x0,_0x1c623a=0x0;for(let _0x36e720=0x0;_0x36e720<=_0x4c467b[_0x48c803(0xd3)]-0x1;_0x36e720++){const _0xdb59cd=_0x4c467b[_0x36e720];let _0x3ac604='<tr>';_0x3ac604+=_0x48c803(0x107),_0x3ac604+=_0x48c803(0x1ae)+_0xdb59cd[_0x48c803(0x126)][_0x48c803(0x221)]+_0x48c803(0x158),_0x3ac604+=_0x48c803(0x1ae)+_0xdb59cd[_0x48c803(0x126)][_0x48c803(0xe6)]+_0x48c803(0x158);let _0x4d9abd={},_0x3d7f5c={},_0xc03a1f={};var _0x3296e6={},_0x175b8a={},_0x7fd63f={},_0x2a7546=0x0;for(let _0x3a4b6b=0x0;_0x3a4b6b<=_0xdb59cd['products'][_0x48c803(0xd3)]-0x1;_0x3a4b6b++){const _0x5bf293=_0xdb59cd[_0x48c803(0x118)][_0x3a4b6b];_0x4d9abd[_0x5bf293[_0x48c803(0x139)]+'-'+_0x5bf293[_0x48c803(0x1ac)]]=_0x5bf293[_0x48c803(0xc7)],_0x3d7f5c[[_0x5bf293['brand']+'-'+_0x5bf293[_0x48c803(0x1ac)]]]=_0x5bf293['product_details'][_0x48c803(0x167)],_0xc03a1f[[_0x5bf293[_0x48c803(0x139)]+'-'+_0x5bf293[_0x48c803(0x1ac)]]]=_0x5bf293[_0x48c803(0x151)][_0x48c803(0x16f)];const _0xcee511=_0x5bf293[_0x48c803(0x139)]+'-'+_0x5bf293[_0x48c803(0x1ac)];!Array[_0x48c803(0x177)](_0x25cd80[_0xcee511])&&(_0x25cd80[_0xcee511]=[]);!Array[_0x48c803(0x177)](_0x25cd80[_0xcee511])&&(_0x25cd80[_0xcee511]=[]);_0x25cd80[_0xcee511]['push'](_0x5bf293['qty']);if(_0x5bf293[_0x48c803(0x151)][_0x48c803(0x16f)]=='P')_0x5bf293[_0x48c803(0x151)][_0x48c803(0x167)]==_0x48c803(0x16d)?(!_0x7fd63f[_0xcee511]&&(_0x7fd63f[_0xcee511]=0x0),_0x7fd63f[_0xcee511]=_0x5bf293[_0x48c803(0xc7)]):(!_0x3296e6[_0xcee511]&&(_0x3296e6[_0xcee511]=0x0),_0x3296e6[_0xcee511]=_0x5bf293['qty']);else _0x5bf293[_0x48c803(0x151)][_0x48c803(0x16f)]=='S'&&(_0x5bf293[_0x48c803(0x151)]['isFG']==_0x48c803(0x16d)?(!_0x7fd63f[_0xcee511]&&(_0x7fd63f[_0xcee511]=0x0),_0x7fd63f[_0xcee511]=_0x5bf293[_0x48c803(0xc7)]):(!_0x175b8a[_0xcee511]&&(_0x175b8a[_0xcee511]=0x0),_0x175b8a[_0xcee511]=_0x5bf293[_0x48c803(0xc7)]));_0x2a7546++;}for(let _0x29d08e=0x0;_0x29d08e<=_0x4aa6a6['cat_brand'][_0x48c803(0xd3)]-0x1;_0x29d08e++){const _0x2f6a8d=_0x4aa6a6[_0x48c803(0x102)][_0x29d08e],_0xd40c8d=_0x2f6a8d['_id']['brand']+'-'+_0x2f6a8d['_id'][_0x48c803(0x1ac)],_0x94dab1=_0xc03a1f[_0xd40c8d]!==undefined?_0xc03a1f[_0xd40c8d]:'NA';var _0x87324a=_0x3296e6[_0xd40c8d]!==undefined?_0x3296e6[_0xd40c8d][_0x48c803(0x16a)](0x2):'',_0x1248f4=_0x175b8a[_0xd40c8d]!==undefined?_0x175b8a[_0xd40c8d][_0x48c803(0x16a)](0x2):'',_0x17e065=_0x7fd63f[_0xd40c8d]!==undefined?_0x7fd63f[_0xd40c8d][_0x48c803(0x16a)](0x2):'';_0x3ac604+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x87324a+_0x48c803(0x158),_0x3ac604+=_0x48c803(0x197)+_0x1248f4+'</td>',_0x3ac604+=_0x48c803(0x197)+_0x17e065+_0x48c803(0x158);}var _0x3a01eb=formatNumber(parseFloat(_0xdb59cd[_0x48c803(0xbd)])),_0xdda36a=formatNumber(parseFloat(_0xdb59cd[_0x48c803(0xd4)]));isNaN(_0xdda36a)&&(_0xdda36a=0x0),_0x3ac604+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x3a01eb+_0x48c803(0x158),_0x3ac604+=_0x48c803(0x197)+_0xdda36a+_0x48c803(0x158),_0x3ac604+=_0x48c803(0x1ae)+_0xdb59cd[_0x48c803(0x1c0)]+_0x48c803(0x158),_0x3ac604+=_0x48c803(0x1ae)+_0xdb59cd[_0x48c803(0x187)]+_0x48c803(0x158),_0x3ac604+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xdb59cd[_0x48c803(0x156)]+'</td>',_0x16a7ea=_0xdb59cd['discount']+_0xdb59cd[_0x48c803(0xdf)],_0x4843fa+=parseFloat(_0xdb59cd['cash']),_0x1c623a+=parseFloat(_0xdda36a),_0x209b35[_0x48c803(0x1ab)](_0x3ac604);}function _0x5424d6(_0x819644,_0x24b8b3){const _0x1687c8=_0x48c803,_0x2e5d2a=[];for(let _0x4175d7=0x0;_0x4175d7<=_0x819644[_0x1687c8(0xd3)]-0x1;_0x4175d7+=_0x24b8b3){_0x2e5d2a[_0x1687c8(0x1ab)](_0x819644['slice'](_0x4175d7,_0x4175d7+_0x24b8b3));}return _0x2e5d2a;}const _0x205bd2=_0x5424d6(_0x209b35,_0x4f6369);let _0x1eb2be='';return _0x205bd2['forEach']((_0x405b7c,_0x132e3e)=>{const _0x1d6848=_0x48c803;_0x132e3e>0x0&&(_0x1eb2be+=_0x1d6848(0x11e));_0x1eb2be+='<table>',_0x1eb2be+=_0x1d6848(0xbc);const _0x616acf=new Date(_0x2afce9),_0x3e5e18={'year':_0x1d6848(0xc0),'month':_0x1d6848(0x22e),'day':'numeric','timeZone':_0x1d6848(0xec)},_0x291150=_0x616acf[_0x1d6848(0x22c)](_0x1d6848(0x233),_0x3e5e18);_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+='<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20'+_0x42449d+_0x1d6848(0x175),_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+=_0x1d6848(0x22a)+_0x482820[_0x1d6848(0x213)]+_0x1d6848(0x158),_0x1eb2be+=_0x1d6848(0xd5),_0x1eb2be+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x1eb2be+=_0x1d6848(0xb4),_0x1eb2be+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x1eb2be+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x1eb2be+=_0x1d6848(0x12b),_0x1eb2be+=_0x1d6848(0x19d),_0x1eb2be+=_0x1d6848(0xef),_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x1eb2be+=_0x1d6848(0xd0)+_0x291150+_0x1d6848(0x158),_0x1eb2be+=_0x1d6848(0x163),_0x1eb2be+=_0x1d6848(0xe5),_0x1eb2be+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x1eb2be+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+='<tr>',_0x1eb2be+='<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>',_0x1eb2be+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0x1eb2be+=_0x1d6848(0x1f0),_0x1eb2be+=_0x1d6848(0x20f),_0x1eb2be+=_0x1d6848(0x20f),_0x1eb2be+='</tr>',_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+=_0x1d6848(0x1ec),_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+=_0x1d6848(0x17e),_0x1eb2be+=_0x1d6848(0x17a),_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+=_0x1d6848(0x13b),_0x1eb2be+=_0x1d6848(0x1cd),_0x1eb2be+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x507afa=0x0;_0x507afa<=_0x27d4eb[_0x1d6848(0xd3)]-0x1;_0x507afa++){const _0x499d62=_0x27d4eb[_0x507afa];for(let _0x19196b=0x0;_0x19196b<_0x4aa6a6[_0x1d6848(0x102)][_0x1d6848(0xd3)];_0x19196b++){const _0x1818bf=_0x4aa6a6['cat_brand'][_0x19196b];if(_0x1818bf['_id']['category']===_0x499d62[_0x1d6848(0x126)][_0x1d6848(0x1ac)]){var _0x50b1b0='';switch(_0x499d62[_0x1d6848(0x126)]['category']){case _0x1d6848(0x14f):_0x50b1b0=_0x1818bf['_id'][_0x1d6848(0x139)]+_0x1d6848(0x14b);break;case _0x1d6848(0x1d6):_0x50b1b0=_0x1818bf[_0x1d6848(0x126)]['brand']+'\x20-\x20HH';break;default:_0x50b1b0=_0x1818bf[_0x1d6848(0x126)][_0x1d6848(0x139)];break;}_0x1eb2be+=_0x1d6848(0x17b)+_0x50b1b0+'</b></td>';}}}_0x1eb2be+=_0x1d6848(0x1c2),_0x1eb2be+=_0x1d6848(0xc6),_0x1eb2be+=_0x1d6848(0x1d3),_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+='<tr>',_0x1eb2be+=_0x1d6848(0x132);for(let _0x149a8d=0x0;_0x149a8d<=_0x4aa6a6[_0x1d6848(0x102)][_0x1d6848(0xd3)]-0x1;_0x149a8d++){const _0x3a6387=_0x4aa6a6[_0x149a8d];_0x1eb2be+=_0x1d6848(0x15f),_0x1eb2be+=_0x1d6848(0x14c),_0x1eb2be+=_0x1d6848(0x127);}_0x1eb2be+=_0x1d6848(0xb3),_0x1eb2be+=_0x1d6848(0x20b),_0x1eb2be+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>',_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x129),_0x1eb2be+=_0x1d6848(0x207),_0x405b7c['forEach'](_0x407236=>{_0x1eb2be+=_0x407236;});let _0x157f61={},_0x379fdf={},_0x503067={};for(let _0x5dd9c9=0x0;_0x5dd9c9<=_0x4c467b[_0x1d6848(0xd3)]-0x1;_0x5dd9c9++){const _0x470390=_0x4c467b[_0x5dd9c9];var _0x4591ca=0x0;for(let _0x10285b=0x0;_0x10285b<=_0x470390[_0x1d6848(0x118)][_0x1d6848(0xd3)]-0x1;_0x10285b++){const _0x12be40=_0x470390[_0x1d6848(0x118)][_0x10285b],_0xe48bee=_0x12be40['brand']+'-'+_0x12be40['category'];if(_0x12be40[_0x1d6848(0x151)][_0x1d6848(0x16f)]=='P')_0x12be40[_0x1d6848(0x151)][_0x1d6848(0x167)]==_0x1d6848(0x16d)?(!_0x503067[_0xe48bee]&&(_0x503067[_0xe48bee]=0x0),_0x503067[_0xe48bee]+=_0x12be40[_0x1d6848(0xc7)]):(!_0x157f61[_0xe48bee]&&(_0x157f61[_0xe48bee]=0x0),_0x157f61[_0xe48bee]+=_0x12be40[_0x1d6848(0xc7)]);else _0x12be40[_0x1d6848(0x151)]['prod_cat']=='S'&&(_0x12be40['product_details']['isFG']==_0x1d6848(0x16d)?(!_0x503067[_0xe48bee]&&(_0x503067[_0xe48bee]=0x0),_0x503067[_0xe48bee]+=_0x12be40[_0x1d6848(0xc7)],console[_0x1d6848(0x13f)](_0x12be40[_0x1d6848(0xc7)])):(!_0x379fdf[_0xe48bee]&&(_0x379fdf[_0xe48bee]=0x0),_0x379fdf[_0xe48bee]+=_0x12be40[_0x1d6848(0xc7)]));_0x4591ca++;}}let _0x1083a6={},_0x48afe5={},_0x289cdd={};var _0x90775e=0x0,_0x18dd10=0x0;for(let _0x4be899=0x0;_0x4be899<=_0x2a4f6a[_0x1d6848(0xd3)]-0x1;_0x4be899++){const _0xdff101=_0x2a4f6a[_0x4be899];var _0x4591ca=0x0;for(let _0x3575e8=0x0;_0x3575e8<=_0xdff101[_0x1d6848(0x118)][_0x1d6848(0xd3)]-0x1;_0x3575e8++){const _0x51066e=_0xdff101['products'][_0x3575e8],_0x4f613c=_0x51066e[_0x1d6848(0x139)]+'-'+_0x51066e['category'];if(_0x51066e[_0x1d6848(0x151)]['prod_cat']=='P')_0x51066e['product_details']['isFG']==_0x1d6848(0x16d)?(!_0x289cdd[_0x4f613c]&&(_0x289cdd[_0x4f613c]=0x0),_0x289cdd[_0x4f613c]+=_0x51066e[_0x1d6848(0xc7)]):(!_0x1083a6[_0x4f613c]&&(_0x1083a6[_0x4f613c]=0x0),_0x1083a6[_0x4f613c]+=_0x51066e[_0x1d6848(0xc7)]);else _0x51066e['product_details'][_0x1d6848(0x16f)]=='S'&&(_0x51066e[_0x1d6848(0x151)]['isFG']==_0x1d6848(0x16d)?(!_0x289cdd[_0x4f613c]&&(_0x289cdd[_0x4f613c]=0x0),_0x289cdd[_0x4f613c]+=_0x51066e[_0x1d6848(0xc7)]):(!_0x48afe5[_0x4f613c]&&(_0x48afe5[_0x4f613c]=0x0),_0x48afe5[_0x4f613c]+=_0x51066e['qty']));_0x4591ca++;}var _0x2eeb9e=parseFloat(_0xdff101[_0x1d6848(0xbd)]),_0x287124=parseFloat(_0xdff101['amount']);isNaN(_0x287124)&&(_0x287124=0x0),_0x90775e+=_0x2eeb9e,_0x18dd10+=_0x287124;}if(_0x577e4e[_0x1d6848(0xd3)]>0x0)for(let _0x24efda=0x0;_0x24efda<=_0x577e4e[_0x1d6848(0xd3)]-0x1;_0x24efda++){const _0xcbc93e=_0x577e4e[_0x24efda];console[_0x1d6848(0x13f)](_0xcbc93e),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+=_0x1d6848(0x144)+(0x8+0x7*0x3)+_0x1d6848(0x1e5)+_0xcbc93e[_0x1d6848(0x128)]+_0x1d6848(0x175),_0x1eb2be+=_0x1d6848(0x142);}_0x1eb2be+='<tr>',_0x1eb2be+=_0x1d6848(0xc8),_0x1eb2be+=_0x1d6848(0x174),_0x1eb2be+=_0x1d6848(0x107);for(let _0x5935a8=0x0;_0x5935a8<=_0x4aa6a6['cat_brand']['length']-0x1;_0x5935a8++){const _0x26de1f=_0x4aa6a6[_0x1d6848(0x102)][_0x5935a8],_0x2fb826=_0x26de1f['_id']['brand']+'-'+_0x26de1f[_0x1d6848(0x126)][_0x1d6848(0x1ac)];var _0x14298a=_0x157f61[_0x2fb826]!==undefined?formatNumber(_0x157f61[_0x2fb826]['toFixed'](0x2)):'',_0x3abab0=_0x503067[_0x2fb826]!==undefined?formatNumber(_0x503067[_0x2fb826][_0x1d6848(0x16a)](0x2)):'',_0x1dc5b0=_0x379fdf[_0x2fb826]!==undefined?formatNumber(_0x379fdf[_0x2fb826][_0x1d6848(0x16a)](0x2)):'';_0x1eb2be+=_0x1d6848(0x141)+_0x14298a+'</b></td>',_0x1eb2be+=_0x1d6848(0x141)+_0x1dc5b0+_0x1d6848(0x175),_0x1eb2be+=_0x1d6848(0x141)+_0x3abab0+_0x1d6848(0x175);}_0x1eb2be+=_0x1d6848(0x141)+formatNumber(_0x4843fa)+_0x1d6848(0x175),_0x1eb2be+=_0x1d6848(0x141)+formatNumber(_0x1c623a)+_0x1d6848(0x175),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+=_0x1d6848(0xc8),_0x1eb2be+=_0x1d6848(0x15c),_0x1eb2be+=_0x1d6848(0x107);for(let _0x335dbc=0x0;_0x335dbc<=_0x4aa6a6['cat_brand'][_0x1d6848(0xd3)]-0x1;_0x335dbc++){const _0x3bef3d=_0x4aa6a6[_0x1d6848(0x102)][_0x335dbc],_0x3560f1=_0x3bef3d[_0x1d6848(0x126)]['brand']+'-'+_0x3bef3d[_0x1d6848(0x126)]['category'];var _0x14298a=_0x1083a6[_0x3560f1]!==undefined?formatNumber(_0x1083a6[_0x3560f1][_0x1d6848(0x16a)](0x2)):'',_0x3abab0=_0x289cdd[_0x3560f1]!==undefined?formatNumber(_0x289cdd[_0x3560f1][_0x1d6848(0x16a)](0x2)):'',_0x1dc5b0=_0x48afe5[_0x3560f1]!==undefined?formatNumber(_0x48afe5[_0x3560f1][_0x1d6848(0x16a)](0x2)):'';_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x14298a+_0x1d6848(0x175),_0x1eb2be+=_0x1d6848(0x141)+_0x1dc5b0+_0x1d6848(0x175),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3abab0+_0x1d6848(0x175);}_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x90775e)+_0x1d6848(0x175),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x18dd10)+_0x1d6848(0x175),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x1eb2be+=_0x1d6848(0x107);let _0x231bac=0x0,_0x48558d=0x0,_0x3db0e6=0x0;for(let _0x770151=0x0;_0x770151<=_0x4aa6a6[_0x1d6848(0x102)][_0x1d6848(0xd3)]-0x1;_0x770151++){const _0x422da9=_0x4aa6a6[_0x1d6848(0x102)][_0x770151],_0x3e0fd9=_0x422da9[_0x1d6848(0x126)][_0x1d6848(0x139)]+'-'+_0x422da9[_0x1d6848(0x126)][_0x1d6848(0x1ac)];var _0x263bd3=_0x157f61[_0x3e0fd9]!==undefined?_0x157f61[_0x3e0fd9][_0x1d6848(0x16a)](0x2):'0',_0x46c514=_0x503067[_0x3e0fd9]!==undefined?_0x503067[_0x3e0fd9][_0x1d6848(0x16a)](0x2):'0',_0x431a91=_0x379fdf[_0x3e0fd9]!==undefined?_0x379fdf[_0x3e0fd9][_0x1d6848(0x16a)](0x2):'0',_0x3d1f02=_0x1083a6[_0x3e0fd9]!==undefined?_0x1083a6[_0x3e0fd9][_0x1d6848(0x16a)](0x2):'0',_0x57baae=_0x289cdd[_0x3e0fd9]!==undefined?_0x289cdd[_0x3e0fd9][_0x1d6848(0x16a)](0x2):'0',_0x1f7f11=_0x48afe5[_0x3e0fd9]!==undefined?_0x48afe5[_0x3e0fd9][_0x1d6848(0x16a)](0x2):'0';_0x231bac=parseFloat(_0x263bd3)+parseFloat(_0x3d1f02),_0x48558d=parseFloat(_0x431a91)+parseFloat(_0x1f7f11),_0x3db0e6=parseFloat(_0x46c514)+parseFloat(_0x57baae),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x231bac[_0x1d6848(0x16a)](0x2))+_0x1d6848(0x175),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x48558d[_0x1d6848(0x16a)](0x2))+_0x1d6848(0x175),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3db0e6[_0x1d6848(0x16a)](0x2))+_0x1d6848(0x175);}var _0x3fa90b=formatNumber(_0x4843fa+_0x90775e),_0x540d15=formatNumber(_0x1c623a+_0x18dd10);_0x1eb2be+=_0x1d6848(0x141)+_0x3fa90b+_0x1d6848(0x175),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x540d15+'</b></td>',_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x4aa6a6[_0x1d6848(0x102)]['length']*0x3+0x9)+_0x1d6848(0x11b),_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+='<tr>',_0x1eb2be+=_0x1d6848(0xc8),_0x1eb2be+=_0x1d6848(0x12d),_0x1eb2be+=_0x1d6848(0x107);for(let _0x286e51=0x0;_0x286e51<=_0x4aa6a6[_0x1d6848(0x102)][_0x1d6848(0xd3)]-0x1;_0x286e51++){const _0x9c3f69=_0x4aa6a6[_0x1d6848(0x102)][_0x286e51],_0x3e31ce=_0x9c3f69[_0x1d6848(0x126)]['brand']+'-'+_0x9c3f69[_0x1d6848(0x126)]['category'];var _0x263bd3=_0x157f61[_0x3e31ce]!==undefined?_0x157f61[_0x3e31ce][_0x1d6848(0x16a)](0x2):'0',_0x46c514=_0x503067[_0x3e31ce]!==undefined?_0x503067[_0x3e31ce][_0x1d6848(0x16a)](0x2):'0',_0x431a91=_0x379fdf[_0x3e31ce]!==undefined?_0x379fdf[_0x3e31ce][_0x1d6848(0x16a)](0x2):'0',_0x3d1f02=_0x1083a6[_0x3e31ce]!==undefined?_0x1083a6[_0x3e31ce]['toFixed'](0x2):'0',_0x57baae=_0x289cdd[_0x3e31ce]!==undefined?_0x289cdd[_0x3e31ce][_0x1d6848(0x16a)](0x2):'0',_0x1f7f11=_0x48afe5[_0x3e31ce]!==undefined?_0x48afe5[_0x3e31ce]['toFixed'](0x2):'0';_0x231bac=parseFloat(_0x263bd3)+parseFloat(_0x3d1f02),_0x48558d=parseFloat(_0x431a91)+parseFloat(_0x1f7f11),_0x3db0e6=parseFloat(_0x46c514)+parseFloat(_0x57baae),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1eb2be+=_0x1d6848(0xff),_0x1eb2be+=_0x1d6848(0xff);}_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+='<tr>',_0x1eb2be+=_0x1d6848(0xc8),_0x1eb2be+=_0x1d6848(0xe8),_0x1eb2be+=_0x1d6848(0x107);for(let _0x424ec9=0x0;_0x424ec9<=_0x4aa6a6[_0x1d6848(0x102)][_0x1d6848(0xd3)]-0x1;_0x424ec9++){const _0x154f65=_0x4aa6a6[_0x1d6848(0x102)][_0x424ec9],_0x50f999=_0x154f65[_0x1d6848(0x126)][_0x1d6848(0x139)]+'-'+_0x154f65[_0x1d6848(0x126)][_0x1d6848(0x1ac)];var _0x263bd3=_0x157f61[_0x50f999]!==undefined?_0x157f61[_0x50f999][_0x1d6848(0x16a)](0x2):'0',_0x46c514=_0x503067[_0x50f999]!==undefined?_0x503067[_0x50f999][_0x1d6848(0x16a)](0x2):'0',_0x431a91=_0x379fdf[_0x50f999]!==undefined?_0x379fdf[_0x50f999]['toFixed'](0x2):'0',_0x3d1f02=_0x1083a6[_0x50f999]!==undefined?_0x1083a6[_0x50f999][_0x1d6848(0x16a)](0x2):'0',_0x57baae=_0x289cdd[_0x50f999]!==undefined?_0x289cdd[_0x50f999][_0x1d6848(0x16a)](0x2):'0',_0x1f7f11=_0x48afe5[_0x50f999]!==undefined?_0x48afe5[_0x50f999][_0x1d6848(0x16a)](0x2):'0';_0x231bac=parseFloat(_0x263bd3)+parseFloat(_0x3d1f02),_0x48558d=parseFloat(_0x431a91)+parseFloat(_0x1f7f11),_0x3db0e6=parseFloat(_0x46c514)+parseFloat(_0x57baae),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1eb2be+=_0x1d6848(0xff),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+=_0x1d6848(0xc8),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x1eb2be+=_0x1d6848(0x107);for(let _0x44d074=0x0;_0x44d074<=_0x4aa6a6['cat_brand'][_0x1d6848(0xd3)]-0x1;_0x44d074++){const _0x5f2e56=_0x4aa6a6['cat_brand'][_0x44d074],_0x395684=_0x5f2e56['_id'][_0x1d6848(0x139)]+'-'+_0x5f2e56[_0x1d6848(0x126)]['category'];var _0x263bd3=_0x157f61[_0x395684]!==undefined?_0x157f61[_0x395684][_0x1d6848(0x16a)](0x2):'0',_0x46c514=_0x503067[_0x395684]!==undefined?_0x503067[_0x395684][_0x1d6848(0x16a)](0x2):'0',_0x431a91=_0x379fdf[_0x395684]!==undefined?_0x379fdf[_0x395684][_0x1d6848(0x16a)](0x2):'0',_0x3d1f02=_0x1083a6[_0x395684]!==undefined?_0x1083a6[_0x395684]['toFixed'](0x2):'0',_0x57baae=_0x289cdd[_0x395684]!==undefined?_0x289cdd[_0x395684][_0x1d6848(0x16a)](0x2):'0',_0x1f7f11=_0x48afe5[_0x395684]!==undefined?_0x48afe5[_0x395684][_0x1d6848(0x16a)](0x2):'0';_0x231bac=parseFloat(_0x263bd3)+parseFloat(_0x3d1f02),_0x48558d=parseFloat(_0x431a91)+parseFloat(_0x1f7f11),_0x3db0e6=parseFloat(_0x46c514)+parseFloat(_0x57baae),_0x1eb2be+=_0x1d6848(0xff),_0x1eb2be+=_0x1d6848(0xff),_0x1eb2be+=_0x1d6848(0xff);}_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x142),_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x1eb2be+=_0x1d6848(0x107);for(let _0x4cadea=0x0;_0x4cadea<=_0x4aa6a6[_0x1d6848(0x102)][_0x1d6848(0xd3)]-0x1;_0x4cadea++){const _0x4d630f=_0x4aa6a6[_0x1d6848(0x102)][_0x4cadea],_0x4e2fcb=_0x4d630f['_id'][_0x1d6848(0x139)]+'-'+_0x4d630f['_id']['category'];var _0x263bd3=_0x157f61[_0x4e2fcb]!==undefined?_0x157f61[_0x4e2fcb][_0x1d6848(0x16a)](0x2):'',_0x46c514=_0x503067[_0x4e2fcb]!==undefined?_0x503067[_0x4e2fcb][_0x1d6848(0x16a)](0x2):'',_0x431a91=_0x379fdf[_0x4e2fcb]!==undefined?_0x379fdf[_0x4e2fcb][_0x1d6848(0x16a)](0x2):'',_0x3d1f02=_0x1083a6[_0x4e2fcb]!==undefined?_0x1083a6[_0x4e2fcb]['toFixed'](0x2):'',_0x57baae=_0x289cdd[_0x4e2fcb]!==undefined?_0x289cdd[_0x4e2fcb][_0x1d6848(0x16a)](0x2):'',_0x1f7f11=_0x48afe5[_0x4e2fcb]!==undefined?_0x48afe5[_0x4e2fcb][_0x1d6848(0x16a)](0x2):'';_0x231bac=formatNumber(parseFloat(_0x263bd3)+parseFloat(_0x3d1f02)),_0x48558d=formatNumber(parseFloat(_0x431a91)+parseFloat(_0x1f7f11)),_0x3db0e6=formatNumber(parseFloat(_0x46c514)+parseFloat(_0x57baae)),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x263bd3+'</b></td>',_0x1eb2be+=_0x1d6848(0x141)+_0x431a91+_0x1d6848(0x175),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x46c514+_0x1d6848(0x175);}_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='</tr>',_0x1eb2be+=_0x1d6848(0x19e),_0x1eb2be+=_0x1d6848(0xc8),_0x1eb2be+=_0x1d6848(0x11c),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x258f02=0x0;_0x258f02<=_0x4aa6a6[_0x1d6848(0x102)][_0x1d6848(0xd3)]-0x1;_0x258f02++){const _0x2d737a=_0x4aa6a6[_0x1d6848(0x102)][_0x258f02],_0x29ed29=_0x2d737a[_0x1d6848(0x126)]['brand']+'-'+_0x2d737a[_0x1d6848(0x126)][_0x1d6848(0x1ac)];var _0x263bd3=_0x157f61[_0x29ed29]!==undefined?_0x157f61[_0x29ed29][_0x1d6848(0x16a)](0x2):'0',_0x46c514=_0x503067[_0x29ed29]!==undefined?_0x503067[_0x29ed29][_0x1d6848(0x16a)](0x2):'0',_0x431a91=_0x379fdf[_0x29ed29]!==undefined?_0x379fdf[_0x29ed29][_0x1d6848(0x16a)](0x2):'0',_0x3d1f02=_0x1083a6[_0x29ed29]!==undefined?_0x1083a6[_0x29ed29][_0x1d6848(0x16a)](0x2):'0',_0x57baae=_0x289cdd[_0x29ed29]!==undefined?_0x289cdd[_0x29ed29][_0x1d6848(0x16a)](0x2):'0',_0x1f7f11=_0x48afe5[_0x29ed29]!==undefined?_0x48afe5[_0x29ed29][_0x1d6848(0x16a)](0x2):'0';_0x231bac=parseFloat(_0x263bd3)+parseFloat(_0x3d1f02),_0x48558d=parseFloat(_0x431a91)+parseFloat(_0x1f7f11),_0x3db0e6=parseFloat(_0x46c514)+parseFloat(_0x57baae),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1eb2be+=_0x1d6848(0xff),_0x1eb2be+=_0x1d6848(0xff);}_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+=_0x1d6848(0x107),_0x1eb2be+='</tr>',_0x1eb2be+=_0x1d6848(0x1f1),_0x1eb2be+=_0x1d6848(0x100);}),_0x1eb2be;}async function generateReferenceNumber(_0x5aa99d,_0x28a256,_0x1bf396){const _0x401a54=a0_0x3a763f,_0x4adb8f=new Date(_0x5aa99d)[_0x401a54(0x1cb)](),_0x431e33=('0'+(new Date(_0x5aa99d)[_0x401a54(0x1bc)]()+0x1))['slice'](-0x2),_0x4f835e=('0'+new Date(_0x5aa99d)['getDate']())[_0x401a54(0x203)](-0x2),_0x277e23=await staff['findOne']({'email':_0x1bf396[_0x401a54(0xcd)]}),_0x5c9409=_0x277e23[_0x401a54(0x1e7)],_0x1d29d2=_0x5c9409+'-'+_0x4adb8f+_0x431e33+_0x4f835e,_0x2a95e9=await Reference[_0x401a54(0x1d9)]({'referenceNumber':new RegExp('^'+_0x1d29d2),'salesman_code':_0x5c9409})['sort']({'createdAt':-0x1}),_0x449a76=_0x1d29d2;_0x2a95e9&&(_0x449a76=_0x2a95e9[_0x401a54(0xc2)]);console[_0x401a54(0x13f)](_0x449a76);const _0x252032=new Reference({'referenceNumber':_0x449a76,'staff_id':_0x28a256,'salesman_code':_0x5c9409});return await _0x252032[_0x401a54(0xcc)](),_0x449a76;}router[a0_0x3a763f(0x182)]('/dsrr/pdf',auth,async(_0x184208,_0x275ddd)=>{const _0x302458=a0_0x3a763f,{from_date:_0x3ee732,dataview:_0x504654}=_0x184208[_0x302458(0x1a6)],_0x560a67=_0x184208['user'],_0x45082e=await staff[_0x302458(0x1d9)]({'email':_0x560a67[_0x302458(0xcd)]}),_0x1103ed=await master_shop[_0x302458(0xc5)](),_0xa87c36='';var _0x3eb9e3=new Date(_0x3ee732);const _0x3f32e3={'year':_0x302458(0xc0),'month':_0x302458(0x22e),'day':_0x302458(0xc0)},_0xdbb699=new Intl['DateTimeFormat'](_0x302458(0x233),_0x3f32e3)[_0x302458(0x10d)](_0x3eb9e3),_0x48bd9d=await Reference[_0x302458(0xc5)]({'staff_id':_0x45082e[_0x302458(0x126)][_0x302458(0x21c)](),'date_include':_0x3ee732});if(_0x48bd9d[_0x302458(0xd3)]>0x0){let _0x324f7b='';_0x324f7b+=_0x48bd9d[0x0][_0x302458(0x1d8)];if(_0x504654=='excel'){const _0x2184e4=cheerio['load'](_0x324f7b);let _0x22424e=[],_0x3c35ac=[],_0x5006b7=[];const _0x4a8e7f=_0x8bdbd3=>{const _0x8d008b=_0x302458,_0x4444bd={'top':{'style':_0x8d008b(0x1a1),'color':{'rgb':_0x8d008b(0x1df)}},'bottom':{'style':_0x8d008b(0x1a1),'color':{'rgb':'000000'}},'left':{'style':_0x8d008b(0x1a1),'color':{'rgb':_0x8d008b(0x1df)}},'right':{'style':_0x8d008b(0x1a1),'color':{'rgb':_0x8d008b(0x1df)}}};if(_0x8bdbd3){const _0x3c4750=_0x8bdbd3[_0x8d008b(0x10e)](';')[_0x8d008b(0x131)]((_0x27bce,_0x310445)=>{const _0x309864=_0x8d008b,[_0x2d9ae3,_0x40bf72]=_0x310445['split'](':')[_0x309864(0x155)](_0x54444a=>_0x54444a[_0x309864(0xb8)]());return _0x27bce[_0x2d9ae3]=_0x40bf72,_0x27bce;},{});_0x3c4750[_0x8d008b(0xc1)]&&(_0x4444bd[_0x8d008b(0x12f)]['style']=_0x3c4750['border-top'][_0x8d008b(0x220)]('thin')?_0x8d008b(0x159):_0x8d008b(0x1c6)),_0x3c4750[_0x8d008b(0x198)]&&(_0x4444bd[_0x8d008b(0x190)][_0x8d008b(0x1de)]=_0x3c4750[_0x8d008b(0x198)][_0x8d008b(0x220)]('thin')?_0x8d008b(0x159):'medium'),_0x3c4750[_0x8d008b(0x23c)]&&(_0x4444bd['left']['style']=_0x3c4750[_0x8d008b(0x23c)][_0x8d008b(0x220)](_0x8d008b(0x159))?'thin':'medium'),_0x3c4750[_0x8d008b(0x16c)]&&(_0x4444bd[_0x8d008b(0x143)][_0x8d008b(0x1de)]=_0x3c4750[_0x8d008b(0x16c)][_0x8d008b(0x220)](_0x8d008b(0x159))?_0x8d008b(0x159):_0x8d008b(0x1c6));}return _0x4444bd;};_0x2184e4(_0x302458(0x1b6))[_0x302458(0x135)]((_0x26a2b2,_0x4b7474)=>{const _0x158e17=_0x302458;let _0x2bbcac=[],_0x4fb016=0x0;while(_0x5006b7[_0x4fb016]){_0x5006b7[_0x4fb016]--,_0x4fb016++;}_0x2184e4(_0x4b7474)[_0x158e17(0xc5)]('td,\x20th')[_0x158e17(0x135)]((_0x10518c,_0x4ec556)=>{const _0x2ecdfc=_0x158e17;let _0x35ace8=_0x2184e4(_0x4ec556)[_0x2ecdfc(0xfa)]()['trim'](),_0x196391=parseFloat(_0x35ace8[_0x2ecdfc(0xe4)](/,/g,''));isNaN(_0x196391)&&(_0x196391=_0x35ace8);let _0x294e7b=parseInt(_0x2184e4(_0x4ec556)[_0x2ecdfc(0x157)](_0x2ecdfc(0x1dd)))||0x1,_0x275535=parseInt(_0x2184e4(_0x4ec556)[_0x2ecdfc(0x157)](_0x2ecdfc(0x201)))||0x1;const _0x44e6e7=_0x2184e4(_0x4ec556)[_0x2ecdfc(0x157)]('style'),_0x40731b=_0x4a8e7f(_0x44e6e7);_0x2bbcac[_0x4fb016]={'v':_0x196391,'s':{'border':_0x40731b}};(_0x294e7b>0x1||_0x275535>0x1)&&_0x3c35ac[_0x2ecdfc(0x1ab)]({'s':{'r':_0x26a2b2,'c':_0x4fb016},'e':{'r':_0x26a2b2+_0x275535-0x1,'c':_0x4fb016+_0x294e7b-0x1}});for(let _0x116f8a=0x0;_0x116f8a<_0x294e7b;_0x116f8a++){_0x275535>0x1&&(_0x5006b7[_0x4fb016+_0x116f8a]=_0x275535-0x1);}_0x4fb016+=_0x294e7b;}),_0x22424e[_0x158e17(0x1ab)](_0x2bbcac);});const _0x4093b2=XLSX[_0x302458(0x232)][_0x302458(0xca)](),_0x501c24=XLSX[_0x302458(0x232)][_0x302458(0x13e)](_0x22424e);_0x3c35ac[_0x302458(0xd3)]>0x0&&(_0x501c24['!merges']=_0x3c35ac);_0x501c24['!cols']=_0x22424e[0x0][_0x302458(0x155)](()=>({'wpx':0x64})),XLSX[_0x302458(0x232)]['book_append_sheet'](_0x4093b2,_0x501c24,_0x302458(0x169));const _0x29c672=XLSX[_0x302458(0x206)](_0x4093b2,{'bookType':_0x302458(0xb6),'type':_0x302458(0x202)});_0x275ddd[_0x302458(0x223)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x275ddd[_0x302458(0x223)](_0x302458(0x101),_0x302458(0x193)),_0x275ddd['send'](_0x29c672);}else{let _0x5f18f1='';_0x5f18f1+=_0x324f7b,_0x5f18f1+=_0x302458(0xfb),_0x5f18f1+=_0x302458(0x1bb),_0x5f18f1+=_0x302458(0x1da),_0x5f18f1+='};',_0x5f18f1+=_0x302458(0x12e),_0x275ddd[_0x302458(0x20a)](_0x5f18f1);}}else generateReferenceNumber(_0x3ee732,_0x45082e[_0x302458(0x126)][_0x302458(0x21c)](),_0x560a67)[_0x302458(0xf4)](async _0x4f27f1=>{const _0x23d787=_0x302458,_0x29b11f=await agentsdataDSICheck_DSRR(_0x3ee732,_0x45082e[_0x23d787(0x126)][_0x23d787(0x21c)](),_0xa87c36,_0x4f27f1);let _0x585e1b=_0x23d787(0x23a);_0x585e1b+='<div\x20class=\x22row\x22>',_0x585e1b+=_0x23d787(0x13c),_0x585e1b+=_0x23d787(0x230),_0x585e1b+=_0x29b11f,_0x585e1b+=_0x23d787(0x100),_0x585e1b+=_0x23d787(0x1aa),_0x585e1b+=_0x23d787(0x1aa);if(_0x29b11f[_0x23d787(0xd3)]>0x0){const _0x1acc44=await Reference[_0x23d787(0x1d9)]({'staff_id':_0x45082e[_0x23d787(0x126)][_0x23d787(0x21c)](),'referenceNumber':_0x4f27f1});_0x1acc44['html']=_0x585e1b,_0x1acc44[_0x23d787(0x1e8)]=_0x3ee732,await _0x1acc44['save']();if(_0x504654=='excel'){const _0x50a22c=cheerio[_0x23d787(0x137)](_0x585e1b);let _0x31992d=[],_0x530a97=[],_0x2790f7=[];const _0x3fbffc=_0x2bda2d=>{const _0x3c7af2=_0x23d787,_0xd94340={'top':{'style':_0x3c7af2(0x1a1),'color':{'rgb':_0x3c7af2(0x1df)}},'bottom':{'style':'thick','color':{'rgb':'000000'}},'left':{'style':_0x3c7af2(0x1a1),'color':{'rgb':_0x3c7af2(0x1df)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x2bda2d){const _0x6c8b77=_0x2bda2d['split'](';')[_0x3c7af2(0x131)]((_0x9a66e3,_0x102c05)=>{const _0x50c40b=_0x3c7af2,[_0x5c49e7,_0x50f0a4]=_0x102c05[_0x50c40b(0x10e)](':')['map'](_0x406e65=>_0x406e65[_0x50c40b(0xb8)]());return _0x9a66e3[_0x5c49e7]=_0x50f0a4,_0x9a66e3;},{});_0x6c8b77[_0x3c7af2(0xc1)]&&(_0xd94340['top'][_0x3c7af2(0x1de)]=_0x6c8b77[_0x3c7af2(0xc1)]['includes'](_0x3c7af2(0x159))?_0x3c7af2(0x159):_0x3c7af2(0x1c6)),_0x6c8b77[_0x3c7af2(0x198)]&&(_0xd94340[_0x3c7af2(0x190)][_0x3c7af2(0x1de)]=_0x6c8b77['border-bottom'][_0x3c7af2(0x220)]('thin')?_0x3c7af2(0x159):'medium'),_0x6c8b77[_0x3c7af2(0x23c)]&&(_0xd94340[_0x3c7af2(0x171)][_0x3c7af2(0x1de)]=_0x6c8b77[_0x3c7af2(0x23c)][_0x3c7af2(0x220)](_0x3c7af2(0x159))?_0x3c7af2(0x159):_0x3c7af2(0x1c6)),_0x6c8b77[_0x3c7af2(0x16c)]&&(_0xd94340['right'][_0x3c7af2(0x1de)]=_0x6c8b77[_0x3c7af2(0x16c)][_0x3c7af2(0x220)](_0x3c7af2(0x159))?_0x3c7af2(0x159):'medium');}return _0xd94340;};_0x50a22c(_0x23d787(0x1b6))[_0x23d787(0x135)]((_0x474314,_0x1cdbfe)=>{const _0x223ff7=_0x23d787;let _0x56c1a4=[],_0x305b0e=0x0;while(_0x2790f7[_0x305b0e]){_0x2790f7[_0x305b0e]--,_0x305b0e++;}_0x50a22c(_0x1cdbfe)[_0x223ff7(0xc5)]('td,\x20th')[_0x223ff7(0x135)]((_0x584081,_0x5bb8ef)=>{const _0x3fc47e=_0x223ff7;let _0x26a688=_0x50a22c(_0x5bb8ef)[_0x3fc47e(0xfa)]()['trim'](),_0x29120a=parseFloat(_0x26a688[_0x3fc47e(0xe4)](/,/g,''));isNaN(_0x29120a)&&(_0x29120a=_0x26a688);let _0x207544=parseInt(_0x50a22c(_0x5bb8ef)['attr']('colspan'))||0x1,_0x35f02f=parseInt(_0x50a22c(_0x5bb8ef)[_0x3fc47e(0x157)](_0x3fc47e(0x201)))||0x1;const _0x3fb84d=_0x50a22c(_0x5bb8ef)[_0x3fc47e(0x157)](_0x3fc47e(0x1de)),_0x8367e4=_0x3fbffc(_0x3fb84d);_0x56c1a4[_0x305b0e]={'v':_0x29120a,'s':{'border':_0x8367e4}};(_0x207544>0x1||_0x35f02f>0x1)&&_0x530a97[_0x3fc47e(0x1ab)]({'s':{'r':_0x474314,'c':_0x305b0e},'e':{'r':_0x474314+_0x35f02f-0x1,'c':_0x305b0e+_0x207544-0x1}});for(let _0x28b0fe=0x0;_0x28b0fe<_0x207544;_0x28b0fe++){_0x35f02f>0x1&&(_0x2790f7[_0x305b0e+_0x28b0fe]=_0x35f02f-0x1);}_0x305b0e+=_0x207544;}),_0x31992d[_0x223ff7(0x1ab)](_0x56c1a4);});const _0x2545e7=XLSX[_0x23d787(0x232)][_0x23d787(0xca)](),_0x59bd33=XLSX['utils']['aoa_to_sheet'](_0x31992d);_0x530a97[_0x23d787(0xd3)]>0x0&&(_0x59bd33['!merges']=_0x530a97);_0x59bd33[_0x23d787(0x112)]=_0x31992d[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x23d787(0x232)][_0x23d787(0x13a)](_0x2545e7,_0x59bd33,_0x23d787(0x169));const _0xec98=XLSX[_0x23d787(0x206)](_0x2545e7,{'bookType':_0x23d787(0xb6),'type':_0x23d787(0x202)});_0x275ddd[_0x23d787(0x223)](_0x23d787(0x20c),_0x23d787(0x215)),_0x275ddd[_0x23d787(0x223)](_0x23d787(0x101),_0x23d787(0x193)),_0x275ddd[_0x23d787(0x20a)](_0xec98);}else _0x585e1b+=_0x23d787(0xfb),_0x585e1b+=_0x23d787(0x1bb),_0x585e1b+='window.print();',_0x585e1b+='};',_0x585e1b+='</script>',_0x275ddd[_0x23d787(0x20a)](_0x585e1b);}else await Reference[_0x23d787(0x1fb)]({'referenceNumber':_0x4f27f1}),_0x184208[_0x23d787(0xf6)]('errors','No\x20data\x20was\x20Found!'),_0x275ddd[_0x23d787(0x111)](_0x23d787(0x235));})[_0x302458(0x214)](console['error']);}),router[a0_0x3a763f(0x11d)](a0_0x3a763f(0x1ea),auth,async(_0x380503,_0x513dfa)=>{const _0x5b3a07=a0_0x3a763f;try{const {username:_0xa927f,email:_0x2ce1c9,role:_0x53c4f3}=_0x380503['user'],_0x45c972=_0x380503[_0x5b3a07(0x231)],_0x573d4e=await profile['findOne']({'email':_0x45c972[_0x5b3a07(0xcd)]}),_0x6920f7={'year':_0x5b3a07(0xc0),'month':_0x5b3a07(0x22e),'day':'numeric'},_0x1e6fa2=await master_shop[_0x5b3a07(0xc5)]();console['log']('Products\x20master',_0x1e6fa2);const _0x2c6db2=await product[_0x5b3a07(0xc5)]();console[_0x5b3a07(0x13f)](_0x5b3a07(0x229),_0x2c6db2);const _0x3cc047=await warehouse['aggregate']([{'$unwind':_0x5b3a07(0xf9)},{'$lookup':{'from':'products','localField':_0x5b3a07(0x152),'foreignField':_0x5b3a07(0x213),'as':'product_docs'}},{'$unwind':_0x5b3a07(0x224)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x5b3a07(0x1e6)}},{'$group':{'_id':_0x5b3a07(0x146),'product_stock':{'$sum':_0x5b3a07(0xf3)}}}]);console[_0x5b3a07(0x13f)](_0x5b3a07(0x21e),_0x3cc047),_0x3cc047[_0x5b3a07(0x234)](_0x5e1cee=>{const _0x23e562=_0x5b3a07,_0x40a3ba=_0x2c6db2[_0x23e562(0x155)](_0xba49da=>{const _0x13ddd3=_0x23e562;_0xba49da['name']==_0x5e1cee[_0x13ddd3(0x126)]&&(_0xba49da['stock']=parseInt(_0xba49da[_0x13ddd3(0x212)])+parseInt(_0x5e1cee[_0x13ddd3(0x12c)]));});});const _0xbdd7d5=await staff[_0x5b3a07(0xc5)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x46b88f=await staff[_0x5b3a07(0x1d9)]({'email':_0x45c972[_0x5b3a07(0xcd)]});if(_0x1e6fa2[0x0][_0x5b3a07(0x23d)]==_0x5b3a07(0x1a0))var _0x38bc54=users[_0x5b3a07(0xd2)];else{if(_0x1e6fa2[0x0][_0x5b3a07(0x23d)]==_0x5b3a07(0x14a))var _0x38bc54=users[_0x5b3a07(0x14a)];else{if(_0x1e6fa2[0x0]['language']==_0x5b3a07(0x149))var _0x38bc54=users[_0x5b3a07(0x149)];else{if(_0x1e6fa2[0x0][_0x5b3a07(0x23d)]==_0x5b3a07(0x21a))var _0x38bc54=users[_0x5b3a07(0x21a)];else{if(_0x1e6fa2[0x0]['language']==_0x5b3a07(0xe2))var _0x38bc54=users[_0x5b3a07(0xe2)];else{if(_0x1e6fa2[0x0][_0x5b3a07(0x23d)]==_0x5b3a07(0x1dc))var _0x38bc54=users[_0x5b3a07(0x216)];else{if(_0x1e6fa2[0x0][_0x5b3a07(0x23d)]==_0x5b3a07(0x11a))var _0x38bc54=users[_0x5b3a07(0x11a)];else{if(_0x1e6fa2[0x0]['language']==_0x5b3a07(0x18e))var _0x38bc54=users[_0x5b3a07(0x217)];}}}}}}}_0x513dfa[_0x5b3a07(0x134)](_0x5b3a07(0x161),{'success':_0x380503[_0x5b3a07(0xf6)]('success'),'errors':_0x380503[_0x5b3a07(0xf6)]('errors'),'alldata':_0x2c6db2,'profile':_0x573d4e,'master_shop':_0x1e6fa2,'role':_0x45c972,'product_stock':_0x3cc047,'language':_0x38bc54,'staff_arr':_0x46b88f,'staff_data_all':_0xbdd7d5});}catch(_0x51feb3){}}),router['post'](a0_0x3a763f(0x1db),auth,async(_0x3af618,_0x1e1f06)=>{const _0x5dec67=a0_0x3a763f;try{const {from:_0x3470d3,to:_0x268931,staff_data:_0x355d67}=_0x3af618[_0x5dec67(0x1a6)],_0x5222a1=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x3470d3,'$lte':_0x268931},'staff_id':_0x355d67}},{'$sort':{'date_include':0x1}}]);_0x1e1f06[_0x5dec67(0xde)](_0x5222a1);}catch(_0x2fce1a){_0x1e1f06[_0x5dec67(0xde)](_0x2fce1a);}}),router[a0_0x3a763f(0x182)]('/getDSSR_no_sales',auth,async(_0x268b4c,_0x1b20e6)=>{const _0x3c7e63=a0_0x3a763f;try{const {from:_0x84a8e3,to:_0x404b42}=_0x268b4c[_0x3c7e63(0x1a6)],{sttaff_id:_0x3cf3dc}=_0x268b4c[_0x3c7e63(0x231)],_0x49861c=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x84a8e3,'$lte':_0x404b42},'staff_id':_0x3cf3dc}},{'$sort':{'date_include':0x1}}]);_0x1b20e6['json'](_0x49861c);}catch(_0x292674){_0x1b20e6[_0x3c7e63(0xde)](_0x292674);}}),router[a0_0x3a763f(0x11d)](a0_0x3a763f(0x185),auth,async(_0x4177d9,_0x4b3669)=>{const _0x179cfe=a0_0x3a763f;try{const _0x12faaa=_0x4177d9[_0x179cfe(0xf8)]['id'],_0xc76472=await Reference[_0x179cfe(0xc4)](_0x12faaa);let _0x1ea0e2='';_0x1ea0e2+=_0xc76472[_0x179cfe(0x1d8)],_0x1ea0e2+='<script>',_0x1ea0e2+=_0x179cfe(0x1bb),_0x1ea0e2+='window.print();',_0x1ea0e2+='};',_0x1ea0e2+=_0x179cfe(0x12e),_0x4b3669[_0x179cfe(0x20a)](_0x1ea0e2);}catch(_0x80d8c9){_0x4b3669[_0x179cfe(0xde)](_0x80d8c9);}}),router['post'](a0_0x3a763f(0x113),auth,async(_0x1becb3,_0x294dd1)=>{const _0x16533a=a0_0x3a763f;try{const {ref_data:_0x1f8448}=_0x1becb3[_0x16533a(0x1a6)],_0x3d9de7=_0x1f8448[_0x16533a(0x10e)]('~'),_0x25daf1=_0x3d9de7[_0x16533a(0x124)](_0x4f828d=>_0x4f828d!==''),_0x574098=await Reference[_0x16533a(0x1ad)]([{'$match':{'referenceNumber':{'$in':_0x25daf1}}}]),_0x5c2798=XLSX[_0x16533a(0x232)][_0x16533a(0xca)]();_0x574098[_0x16533a(0x234)](_0x2a5e45=>{const _0x130e98=_0x16533a,_0x34c42b=cheerio[_0x130e98(0x137)](_0x2a5e45[_0x130e98(0x1d8)]);let _0x3fd026=[],_0xa26d01=[],_0x4bfa8c=[];_0x34c42b('table\x20tr')[_0x130e98(0x135)]((_0x45cafe,_0xd67703)=>{const _0x314866=_0x130e98;let _0x2cc3e1=[],_0x3a3836=0x0;while(_0x4bfa8c[_0x3a3836]){_0x4bfa8c[_0x3a3836]--,_0x3a3836++;}_0x34c42b(_0xd67703)[_0x314866(0xc5)](_0x314866(0x219))[_0x314866(0x135)]((_0x3b2a6b,_0x5ad5c2)=>{const _0x1fd106=_0x314866;let _0x372531=_0x34c42b(_0x5ad5c2)[_0x1fd106(0xfa)]()[_0x1fd106(0xb8)](),_0x37d690=parseFloat(_0x372531[_0x1fd106(0xe4)](/,/g,''));isNaN(_0x37d690)&&(_0x37d690=_0x372531);let _0x17f77b=parseInt(_0x34c42b(_0x5ad5c2)[_0x1fd106(0x157)](_0x1fd106(0x1dd)))||0x1,_0x470dcd=parseInt(_0x34c42b(_0x5ad5c2)['attr'](_0x1fd106(0x201)))||0x1;_0x2cc3e1[_0x3a3836]=_0x37d690;(_0x17f77b>0x1||_0x470dcd>0x1)&&_0xa26d01['push']({'s':{'r':_0x45cafe,'c':_0x3a3836},'e':{'r':_0x45cafe+_0x470dcd-0x1,'c':_0x3a3836+_0x17f77b-0x1}});for(let _0x1ddb7a=0x0;_0x1ddb7a<_0x17f77b;_0x1ddb7a++){_0x470dcd>0x1&&(_0x4bfa8c[_0x3a3836+_0x1ddb7a]=_0x470dcd-0x1);}_0x3a3836+=_0x17f77b;}),_0x3fd026[_0x314866(0x1ab)](_0x2cc3e1);});const _0x3c1d5c=XLSX[_0x130e98(0x232)]['aoa_to_sheet'](_0x3fd026);_0xa26d01[_0x130e98(0xd3)]>0x0&&(_0x3c1d5c[_0x130e98(0x168)]=_0xa26d01),_0x3c1d5c[_0x130e98(0x112)]=_0x3fd026[0x0][_0x130e98(0x155)](()=>({'wpx':0x64})),XLSX[_0x130e98(0x232)][_0x130e98(0x13a)](_0x5c2798,_0x3c1d5c,_0x2a5e45[_0x130e98(0xc2)]);});const _0x3b4390=XLSX['write'](_0x5c2798,{'bookType':_0x16533a(0xb6),'type':_0x16533a(0x202)});_0x294dd1[_0x16533a(0x223)](_0x16533a(0x20c),_0x16533a(0xfd)),_0x294dd1['setHeader'](_0x16533a(0x101),_0x16533a(0x193)),_0x294dd1[_0x16533a(0x20a)](_0x3b4390);}catch(_0xd68cb8){_0x294dd1[_0x16533a(0xde)](_0xd68cb8);}}),router[a0_0x3a763f(0x182)](a0_0x3a763f(0x147),auth,async(_0x485b45,_0x5d2010)=>{const _0x34f87e=a0_0x3a763f,{from_date:_0x35625b,agent_id:_0x3070c8}=_0x485b45[_0x34f87e(0x1a6)],_0x331a0f=_0x485b45[_0x34f87e(0x231)],_0x4c0edf=await staff['findOne']({'email':_0x331a0f[_0x34f87e(0xcd)]}),_0x266799=await master_shop[_0x34f87e(0xc5)](),_0x50669d=await agentsdataDSICheck_DSRR(_0x35625b,_0x3070c8,_0x2db87d);let _0x48933b=_0x34f87e(0xda);var _0x33f348=new Date(_0x35625b);const _0x5bcfb8={'year':_0x34f87e(0xc0),'month':_0x34f87e(0x22e),'day':_0x34f87e(0xc0)},_0x5c3644=new Intl[(_0x34f87e(0x138))](_0x34f87e(0x233),_0x5bcfb8)[_0x34f87e(0x10d)](_0x33f348);_0x48933b+=_0x34f87e(0xc9),_0x48933b+=_0x34f87e(0x13c),_0x48933b+=_0x34f87e(0x230),_0x48933b+=_0x50669d,_0x48933b+=_0x34f87e(0x100),_0x48933b+='</div>',_0x48933b+='</div>';let _0x11cea8=_0x34f87e(0xe9);const _0x2e2dbc={'width':_0x34f87e(0x1c7),'height':_0x34f87e(0x1f8),'orientation':_0x34f87e(0x17c),'border':{'top':_0x34f87e(0x1b7),'right':_0x34f87e(0x1b7),'bottom':_0x34f87e(0x1b7),'left':_0x34f87e(0x1b7)},'header':{'height':_0x34f87e(0x181),'contents':_0x34f87e(0x110)+_0x11cea8+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x5c3644+_0x34f87e(0x180)},'footer':{'height':_0x34f87e(0x1b4),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};var _0x2db87d='on';if(_0x2db87d=='on'){const _0x275f3d=cheerio[_0x34f87e(0x137)](_0x48933b);let _0x333687=[],_0x532011=[],_0x2f91f0=[];_0x275f3d(_0x34f87e(0x1b6))[_0x34f87e(0x135)]((_0x1261fb,_0x12833a)=>{const _0x2b6da6=_0x34f87e;let _0x1fa8b5=[],_0x12b003=0x0;while(_0x2f91f0[_0x12b003]){_0x2f91f0[_0x12b003]--,_0x12b003++;}_0x275f3d(_0x12833a)[_0x2b6da6(0xc5)](_0x2b6da6(0x219))[_0x2b6da6(0x135)]((_0x372aab,_0x278bb6)=>{const _0x53a334=_0x2b6da6;let _0x516fa2=_0x275f3d(_0x278bb6)['text']()[_0x53a334(0xb8)](),_0x5d3125=parseFloat(_0x516fa2['replace'](/,/g,''));isNaN(_0x5d3125)&&(_0x5d3125=_0x516fa2);let _0x206ffb=parseInt(_0x275f3d(_0x278bb6)['attr']('colspan'))||0x1,_0x427c10=parseInt(_0x275f3d(_0x278bb6)[_0x53a334(0x157)](_0x53a334(0x201)))||0x1;_0x1fa8b5[_0x12b003]=_0x5d3125;(_0x206ffb>0x1||_0x427c10>0x1)&&_0x532011['push']({'s':{'r':_0x1261fb,'c':_0x12b003},'e':{'r':_0x1261fb+_0x427c10-0x1,'c':_0x12b003+_0x206ffb-0x1}});for(let _0xb87c2a=0x0;_0xb87c2a<_0x206ffb;_0xb87c2a++){_0x427c10>0x1&&(_0x2f91f0[_0x12b003+_0xb87c2a]=_0x427c10-0x1);}_0x12b003+=_0x206ffb;}),_0x333687[_0x2b6da6(0x1ab)](_0x1fa8b5);});const _0x72e8bd=XLSX['utils']['book_new'](),_0x4eed7b=XLSX[_0x34f87e(0x232)][_0x34f87e(0x13e)](_0x333687);_0x532011[_0x34f87e(0xd3)]>0x0&&(_0x4eed7b[_0x34f87e(0x168)]=_0x532011);_0x4eed7b[_0x34f87e(0x112)]=_0x333687[0x0][_0x34f87e(0x155)](()=>({'wpx':0x64})),XLSX[_0x34f87e(0x232)][_0x34f87e(0x13a)](_0x72e8bd,_0x4eed7b,_0x34f87e(0x169));const _0x4daf1f=XLSX['write'](_0x72e8bd,{'bookType':_0x34f87e(0xb6),'type':_0x34f87e(0x202)});_0x5d2010[_0x34f87e(0x223)]('Content-Disposition',_0x34f87e(0x215)),_0x5d2010[_0x34f87e(0x223)](_0x34f87e(0x101),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x5d2010[_0x34f87e(0x20a)](_0x4daf1f);}else pdf[_0x34f87e(0xbb)](_0x48933b,_0x2e2dbc)[_0x34f87e(0x1ef)](function(_0x350749,_0x4fd094){const _0xe357c6=_0x34f87e;if(_0x350749){_0x5d2010[_0xe357c6(0xf0)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x5d2010['setHeader'](_0xe357c6(0x101),_0xe357c6(0x1a9)),_0x4fd094['pipe'](_0x5d2010);});}),module[a0_0x3a763f(0x1e2)]=router;