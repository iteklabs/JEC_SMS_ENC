const a0_0x485df5=a0_0x3c97;(function(_0x2b9a23,_0x12aaa2){const _0x326a67=a0_0x3c97,_0x1dcc0d=_0x2b9a23();while(!![]){try{const _0x338966=parseInt(_0x326a67(0x246))/0x1+-parseInt(_0x326a67(0x17f))/0x2+-parseInt(_0x326a67(0xec))/0x3*(parseInt(_0x326a67(0x12f))/0x4)+parseInt(_0x326a67(0x13f))/0x5*(parseInt(_0x326a67(0x17a))/0x6)+parseInt(_0x326a67(0x212))/0x7*(parseInt(_0x326a67(0x1eb))/0x8)+-parseInt(_0x326a67(0x126))/0x9+-parseInt(_0x326a67(0x179))/0xa*(parseInt(_0x326a67(0x153))/0xb);if(_0x338966===_0x12aaa2)break;else _0x1dcc0d['push'](_0x1dcc0d['shift']());}catch(_0x37f770){_0x1dcc0d['push'](_0x1dcc0d['shift']());}}}(a0_0x3052,0x462c3));const express=require(a0_0x485df5(0x173)),res=require(a0_0x485df5(0x1aa)),app=express(),router=express['Router'](),multer=require(a0_0x485df5(0x19e)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x485df5(0x1a3)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require('exceljs'),XLSX=require('xlsx'),PDFDocument=require(a0_0x485df5(0xe3)),fs=require('fs'),blobStream=require(a0_0x485df5(0x21c)),JsBarcode=require(a0_0x485df5(0x12e)),{Canvas}=require(a0_0x485df5(0x160)),pdf=require(a0_0x485df5(0x190)),path=require(a0_0x485df5(0x1c5)),mongoose=require(a0_0x485df5(0x15f)),cheerio=require(a0_0x485df5(0x221));router[a0_0x485df5(0x145)](a0_0x485df5(0x118),auth,async(_0x4628da,_0x576717)=>{const _0x5f23e4=a0_0x485df5;try{const {username:_0x478072,email:_0x433aa1,role:_0x329cb7}=_0x4628da[_0x5f23e4(0x128)],_0x5ee198=_0x4628da[_0x5f23e4(0x128)],_0x3bfc2d=await profile[_0x5f23e4(0x18b)]({'email':_0x5ee198[_0x5f23e4(0xd5)]}),_0xcbfb05={'year':_0x5f23e4(0x1f2),'month':'long','day':_0x5f23e4(0x1f2)},_0x62528e=await master_shop[_0x5f23e4(0x164)]();console[_0x5f23e4(0xeb)](_0x5f23e4(0x1f5),_0x62528e);const _0x1bbd5d=await product[_0x5f23e4(0x164)]();console[_0x5f23e4(0xeb)](_0x5f23e4(0x214),_0x1bbd5d);const _0x3236eb=await warehouse['aggregate']([{'$unwind':_0x5f23e4(0x156)},{'$lookup':{'from':'products','localField':_0x5f23e4(0x14f),'foreignField':_0x5f23e4(0x248),'as':'product_docs'}},{'$unwind':_0x5f23e4(0x162)},{'$project':{'product_name':_0x5f23e4(0x134),'product_stock':_0x5f23e4(0x204)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);console['log'](_0x5f23e4(0x155),_0x3236eb),_0x3236eb[_0x5f23e4(0x181)](_0x25571b=>{const _0x12ae69=_0x5f23e4,_0x5c819e=_0x1bbd5d[_0x12ae69(0x110)](_0x289780=>{const _0x14e93d=_0x12ae69;_0x289780[_0x14e93d(0x248)]==_0x25571b[_0x14e93d(0x17c)]&&(_0x289780[_0x14e93d(0x1ba)]=parseInt(_0x289780[_0x14e93d(0x1ba)])+parseInt(_0x25571b[_0x14e93d(0x19a)]));});}),console[_0x5f23e4(0xeb)](_0x5f23e4(0x214),_0x1bbd5d);if(_0x62528e[0x0][_0x5f23e4(0x1b1)]==_0x5f23e4(0x133))var _0x378eff=users[_0x5f23e4(0x165)];else{if(_0x62528e[0x0][_0x5f23e4(0x1b1)]==_0x5f23e4(0xfd))var _0x378eff=users['Hindi'];else{if(_0x62528e[0x0][_0x5f23e4(0x1b1)]=='German')var _0x378eff=users['German'];else{if(_0x62528e[0x0]['language']==_0x5f23e4(0x1fb))var _0x378eff=users['Spanish'];else{if(_0x62528e[0x0][_0x5f23e4(0x1b1)]==_0x5f23e4(0x130))var _0x378eff=users[_0x5f23e4(0x130)];else{if(_0x62528e[0x0][_0x5f23e4(0x1b1)]==_0x5f23e4(0x15c))var _0x378eff=users[_0x5f23e4(0x1b0)];else{if(_0x62528e[0x0][_0x5f23e4(0x1b1)]==_0x5f23e4(0x19d))var _0x378eff=users['Chinese'];else{if(_0x62528e[0x0][_0x5f23e4(0x1b1)]==_0x5f23e4(0x1bc))var _0x378eff=users[_0x5f23e4(0x1a0)];}}}}}}}_0x576717[_0x5f23e4(0x1cc)](_0x5f23e4(0x1e2),{'success':_0x4628da[_0x5f23e4(0x183)](_0x5f23e4(0x185)),'errors':_0x4628da[_0x5f23e4(0x183)]('errors'),'alldata':_0x1bbd5d,'profile':_0x3bfc2d,'master_shop':_0x62528e,'role':_0x5ee198,'product_stock':_0x3236eb,'language':_0x378eff});}catch(_0x522d1e){}});async function dataCheck(_0x2038b2,_0x9190b8){const _0xf529fc=a0_0x485df5,_0x5ecb8c=await product['aggregate']([{'$group':{'_id':{'brand':_0xf529fc(0x16a),'category':'$category'},'products':{'$push':{'name':'$name','product_code':_0xf529fc(0x13d)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3e27f3=[];_0x3e27f3[_0xf529fc(0x22f)]=[];for(let _0x19a29a=0x0;_0x19a29a<=_0x5ecb8c['length']-0x1;_0x19a29a++){const _0x2270b9=_0x5ecb8c[_0x19a29a];_0x3e27f3[_0xf529fc(0x22f)][_0xf529fc(0x124)](_0x2270b9);}const _0x25e908=await product[_0xf529fc(0xfe)]([{'$group':{'_id':{'category':_0xf529fc(0x1dd)},'products':{'$push':{'brand':_0xf529fc(0x16a),'product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x323ea8=await purchases_finished[_0xf529fc(0xfe)]([{'$match':{'date':{'$gte':_0x2038b2,'$lte':_0x9190b8}}},{'$unwind':'$product'},{'$group':{'_id':{'product_name':'$product.product_name','product_code':_0xf529fc(0x194)},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x3e27f3[_0xf529fc(0xed)]=[];for(let _0x5deb14=0x0;_0x5deb14<=_0x323ea8[_0xf529fc(0x13c)]-0x1;_0x5deb14++){const _0x619f5=_0x323ea8[_0x5deb14];_0x3e27f3[_0xf529fc(0xed)][_0xf529fc(0x124)](_0x619f5);}const _0x35eb12=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x2038b2,'$lte':_0x9190b8}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0xf529fc(0x239)}}},{'$lookup':{'from':_0xf529fc(0x219),'localField':_0xf529fc(0x193),'foreignField':_0xf529fc(0x17c),'as':_0xf529fc(0x1b7)}},{'$unwind':'$sales_info'},{'$unwind':_0xf529fc(0x1b5)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0xf529fc(0x15b)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console[_0xf529fc(0xeb)](_0x35eb12[0x0]),_0x3e27f3[_0xf529fc(0x17e)]=[];for(let _0x456a07=0x0;_0x456a07<=_0x35eb12['length']-0x1;_0x456a07++){const _0x4aad67=_0x35eb12[_0x456a07];_0x3e27f3['sales_bkg'][_0xf529fc(0x124)](_0x4aad67);}const _0x304917=await sales_sa[_0xf529fc(0xfe)]([{'$match':{'date':{'$gte':_0x2038b2,'$lte':_0x9190b8}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0xf529fc(0x239)}}},{'$lookup':{'from':_0xf529fc(0x219),'localField':_0xf529fc(0x193),'foreignField':_0xf529fc(0x17c),'as':_0xf529fc(0x1b7)}},{'$unwind':'$sales_info'},{'$unwind':_0xf529fc(0x1b5)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0xf529fc(0x1ac)}},{'$group':{'_id':{'product_name':_0xf529fc(0x20f),'product_code':_0xf529fc(0x15b)},'totalQTY':{'$sum':_0xf529fc(0x11b)}}}]);_0x3e27f3[_0xf529fc(0x1e6)]=[];for(let _0x4a7620=0x0;_0x4a7620<=_0x304917[_0xf529fc(0x13c)]-0x1;_0x4a7620++){const _0x546d10=_0x304917[_0x4a7620];_0x3e27f3[_0xf529fc(0x1e6)][_0xf529fc(0x124)](_0x546d10);}let _0x575015='';for(let _0x3dc8b4=0x0;_0x3dc8b4<=_0x25e908[_0xf529fc(0x13c)]-0x1;_0x3dc8b4++){const _0x4060c7=_0x25e908[_0x3dc8b4];_0x575015+=_0xf529fc(0x1c9),_0x575015+=_0xf529fc(0x152)+_0x4060c7[_0xf529fc(0x17c)][_0xf529fc(0x195)]+'</td>',_0x575015+=_0xf529fc(0x1dc);for(let _0x37fc20=0x0;_0x37fc20<_0x3e27f3['cat_brand'][_0xf529fc(0x13c)];_0x37fc20++){const _0x2917db=_0x3e27f3[_0xf529fc(0x22f)][_0x37fc20];if(_0x2917db[_0xf529fc(0x17c)][_0xf529fc(0x195)]==_0x4060c7['_id']['category']){let _0x4c6d5f=[],_0x561766=[],_0x221e8f=[];_0x4c6d5f[_0x2917db[_0xf529fc(0x17c)][_0xf529fc(0x169)]]=[],_0x561766[_0x2917db[_0xf529fc(0x17c)]['brand']]=[],_0x221e8f[_0x2917db['_id'][_0xf529fc(0x169)]]=[];var _0x784110=0x0,_0x91df37=0x0,_0x270e47=0x0;for(let _0x5c11cd=0x0;_0x5c11cd<_0x2917db[_0xf529fc(0x111)][_0xf529fc(0x13c)];_0x5c11cd++){const _0xf1081c=_0x2917db[_0xf529fc(0x111)][_0x5c11cd];for(let _0x595ea5=0x0;_0x595ea5<=_0x3e27f3[_0xf529fc(0xed)][_0xf529fc(0x13c)]-0x1;_0x595ea5++){const _0x5a8755=_0x3e27f3[_0xf529fc(0xed)][_0x595ea5];_0x5a8755[_0xf529fc(0x17c)][_0xf529fc(0x143)]==_0xf1081c['name']&&_0x5a8755['_id'][_0xf529fc(0x1af)]==_0xf1081c[_0xf529fc(0x1af)]&&(_0x784110+=parseInt(_0x5a8755[_0xf529fc(0x1d8)],0xa));}for(let _0x2c2a77=0x0;_0x2c2a77<=_0x3e27f3[_0xf529fc(0x1e6)][_0xf529fc(0x13c)]-0x1;_0x2c2a77++){const _0x173bda=_0x3e27f3[_0xf529fc(0x1e6)][_0x2c2a77];_0x173bda['_id'][_0xf529fc(0x143)]==_0xf1081c[_0xf529fc(0x248)]&&_0x173bda['_id'][_0xf529fc(0x1af)]==_0xf1081c[_0xf529fc(0x1af)]&&(_0x91df37+=parseFloat(_0x173bda['totalQTY'],0xa)[_0xf529fc(0xcf)](0x2));}for(let _0x309bb8=0x0;_0x309bb8<=_0x3e27f3[_0xf529fc(0x17e)][_0xf529fc(0x13c)]-0x1;_0x309bb8++){const _0x16c5c9=_0x3e27f3[_0xf529fc(0x17e)][_0x309bb8];_0x16c5c9[_0xf529fc(0x17c)]['product_name']==_0xf1081c[_0xf529fc(0x248)]&&_0x16c5c9['_id'][_0xf529fc(0x1af)]==_0xf1081c[_0xf529fc(0x1af)]&&(_0x270e47+=parseInt(_0x16c5c9[_0xf529fc(0x1d8)],0xa));}}const _0x109084=new Intl[(_0xf529fc(0x167))](_0xf529fc(0x24b));var _0x193192=_0x109084[_0xf529fc(0x1c3)](_0x784110);_0x4c6d5f[_0x2917db[_0xf529fc(0x17c)][_0xf529fc(0x169)]][_0xf529fc(0x124)](_0x193192),_0x561766[_0x2917db[_0xf529fc(0x17c)][_0xf529fc(0x169)]][_0xf529fc(0x124)](_0x109084[_0xf529fc(0x1c3)](_0x91df37)),_0x221e8f[_0x2917db[_0xf529fc(0x17c)][_0xf529fc(0x169)]][_0xf529fc(0x124)](_0x109084[_0xf529fc(0x1c3)](_0x270e47));var _0xa3d924=_0x109084['format'](_0x784110-(_0x270e47+_0x91df37));_0x575015+=_0xf529fc(0x1c9),_0x575015+='<td\x20class=\x22row_data\x22></td>',_0x575015+='<td\x20class=\x22row_data\x22>'+_0x2917db[_0xf529fc(0x17c)][_0xf529fc(0x169)]+_0xf529fc(0x1d4),_0x575015+=_0xf529fc(0x23d)+_0x4c6d5f[_0x2917db['_id'][_0xf529fc(0x169)]][0x0]+_0xf529fc(0x1d4),_0x575015+='<td\x20class=\x22row_data\x22>0</td>',_0x575015+=_0xf529fc(0x23d)+_0x221e8f[_0x2917db[_0xf529fc(0x17c)]['brand']][0x0]+_0xf529fc(0x1d4),_0x575015+=_0xf529fc(0x23d)+_0x561766[_0x2917db[_0xf529fc(0x17c)][_0xf529fc(0x169)]][0x0]+'</td>',_0x575015+=_0xf529fc(0x23d)+_0xa3d924+_0xf529fc(0x1d4),_0x575015+=_0xf529fc(0x1dc);}}}return console[_0xf529fc(0xeb)](_0x3e27f3[_0xf529fc(0x17e)]),_0x575015;}function a0_0x3052(){const _0x483e59=['<p>','product_stock','<td\x20class=\x22cat_data\x22>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','Chinese','multer','border-right','Arabic','\x20-\x20','Letter','../models/all_models','discount','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','$sale_product.quantity','toLocaleDateString','$products.product_details.brand','<td\x20class=\x22cat_data\x22></td>','express/lib/response','!merges','false','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$products.product_details.prod_id','product_code','Portuguese','language','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','/agent/view','$sale_product','$_id.category','sales_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','totalGross','stock','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','Arabic\x20(ae)','$_id.brand','$name','$products.adj_discount','$sale_product.discount','$products.product_details.category','$sale_product.adj_discount','format','json','path','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','test','getMonth','<tr>','agent_sales','<div\x20class=\x22row\x22>','render','<td\x20colspan=\x22','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','NetPrice','isFG','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','date','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','</td>','errors','utils','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','totalQTY','/agent_reports/sales_ad','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','</tr>','$category','000000','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','split','Household','balanced','product_docs','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','border-top','sales_ext','$_id.dsi','$sale_product.prod_cat','dssr_view','landscape','51024BANTrN','</script>','</b></td>','/agent_reports/pdf_admin','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','Sales\x20Report','referenceNumber','numeric','$discount','/dl_excel','Products\x20master','<th>X-Truck</th>','/inventory_sum/view','totalQty','then','<th>\x20SALES\x20</th>','Spanish','<th\x20colspan=\x272\x27>SOLD</th>','$product_info.product_code','salesman_data','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','deleteOne','PDF\x20Generation\x20Error:','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','$bank','$product_details.product_stock','date_include','$NetPrice','bottom','prod_cat','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','sales_man_code','German','Error\x20generating\x20PDF','$_id.status_data','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','$sale_product.product_name','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','8.5in','49iYfmEU','$dsi','Products\x20find_data','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','<td\x20colspan=\x223\x22><b>TOTAL<b>','$_id.customer','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','staffs','top','</table>','blob-stream','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','medium','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','error','cheerio','true','left','<th>\x20INCOMING\x20</th>','filter','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','valueOf','$product_info','$sale_product.isFG','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','60mm','/dsrr_admin/pdf_admin','$due_date','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','cat_brand','exports','!cols','<div\x20style=\x22page-break-before:\x20always;\x22></div>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$customer','getDate','thin','/total_sales_reports/pdf','$sales_staff_id','totalQTYsum','sort','replace','<td\x20class=\x22row_data\x22>','product_details','$sale_product.stock','totalPrice','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','due_date','dsi_sales','post','$products.NetPrice','191492WzWLTV','getFullYear','name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','$totalGross','en-US','<script>','</thead>','right','$sales_info','/inventory_sum/pdf','book_new','<td\x20class=\x22row_data\x22>0</td>','toFixed','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','colspan','thick','email','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','status','<tbody>','/dsrr/view','</p>','$adj_discount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','<th\x20rowspan=\x272\x27>Production</th>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','toLocaleString','$product_info.name','product_info','$amount','pdfkit-table','style','td,\x20th','</th>','sumqty','No\x20data\x20was\x20Found!','brandCount','cash','log','335679MRGlEe','beg_bal','<div\x20\x20id=\x22table-conatainer\x22>','attachment;\x20filename=\x22reports.xlsx\x22','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','rowspan','application/pdf','Content-Disposition','<th\x20rowspan=\x272\x27>Category</th>','/total_sales_reports/view','<th>Booking</th>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','setHeader','$product_info.category','$products.qty','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','Hindi','aggregate','$product_info.gross_price','$check_no','$totalQty','border-left','$product_list.product_stock','<th>\x20BEG\x20BALANCE\x20</th>','isArray','<th>\x20ENDING\x20BALANCE\x20</th>','/balance/pdf','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','dataqty','$cash','15in','pipe','window.onload\x20=\x20function()\x20{','</tbody>','\x22><b>','map','products','$sales_info._id','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','$product_list.product_code','includes','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','0.1in','/balance/view','/dsrr_admin/view_data/:id','DateTimeFormat','$sale_product.real_qty_unit_val','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','</div>','<h1>JAKA\x20EQUITIES\x20CORP</h1>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','<div\x20class=\x22col-sm-11\x22>','xlsx','<p>SALES\x20REPORTS</p>','catch','push','book_append_sheet','548640awhMVe','/dev/null','user','dsi','text','check_no','excel','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','jsbarcode','4EEDeVN','French','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','sale_product.product_code','English\x20(US)','$product_details.product_name','qty','write','long','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','/reports/dsrr/view','$products','<td\x20class=\x22row_data\x22><b>','length','$product_code','Content-Type','2668315GdcXfu','attachment;\x20filename=\x22sales_report.xlsx\x22','$products.product_details','each','product_name','adj_discount','get','load','/dsrr_admin/view','aoa_to_sheet','<th>\x20QTY\x20SOLD\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','border-bottom','$products.product_details.gross_price','ObjectId','product_details.product_name','$products.discount','/getDSSR_no_sales','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','1756183nJdYEG','$product_name','Products\x20warehouse_data','$product_details','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$sale_product.totalprice','create','$sale_product.product_code','Portuguese\x20(BR)','amount','<th>\x20ITEM\x20CODE\x20</th>','mongoose','canvas','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','$product_docs','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','find','English','attr','NumberFormat','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','brand','$brand','save','$product_list','send','html','table\x20tr','$product_info.brand','customer','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','express','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','trim','$date','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','10PMfIMG','6ZiykBS','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','_id','reduce','sales_bkg','299736WQaOcR','/agent_reports/pdf','forEach','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','flash','slice','success','$_id.date','20mm','$sales_info.name','toStream','body','findOne','$product_stock','buffer','\x22\x20class=\x22cat_data\x22>','<table>','html-pdf','<thead>','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','sales_staff_id','$product.product_code','category','window.print();','sales_reports','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>'];a0_0x3052=function(){return _0x483e59;};return a0_0x3052();}router[a0_0x485df5(0x244)](a0_0x485df5(0x107),auth,async(_0x3b5934,_0x202b87)=>{const _0x239aeb=a0_0x485df5,{from_date:_0x381247,to_date:_0x3c8a27}=_0x3b5934[_0x239aeb(0x18a)],_0x205284=await dataCheck(_0x381247,_0x3c8a27);{}let _0x52676c='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x565750=new Date(_0x381247),_0x25253a=new Date(_0x3c8a27);const _0xcc5291={'year':_0x239aeb(0x1f2),'month':_0x239aeb(0x137),'day':_0x239aeb(0x1f2)},_0x22f087=new Intl[(_0x239aeb(0x11a))](_0x239aeb(0x24b),_0xcc5291)[_0x239aeb(0x1c3)](_0x565750),_0x3d29cb=new Intl[(_0x239aeb(0x11a))](_0x239aeb(0x24b),_0xcc5291)[_0x239aeb(0x1c3)](_0x25253a);_0x52676c+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x52676c+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x52676c+=_0x239aeb(0x199)+_0x22f087+_0x239aeb(0x1a1)+_0x3d29cb+'</p>',_0x52676c+='<div\x20class=\x22row\x22>',_0x52676c+=_0x239aeb(0x120),_0x52676c+=_0x239aeb(0x18f),_0x52676c+=_0x239aeb(0x1c9),_0x52676c+=_0x239aeb(0xf4),_0x52676c+='<th\x20rowspan=\x272\x27>Products</th>',_0x52676c+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x22f087+'</th>',_0x52676c+=_0x239aeb(0xdd),_0x52676c+=_0x239aeb(0x1fc),_0x52676c+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x3d29cb+_0x239aeb(0xe6),_0x52676c+='</tr>',_0x52676c+=_0x239aeb(0x1c9),_0x52676c+=_0x239aeb(0xf6),_0x52676c+=_0x239aeb(0x1f6),_0x52676c+=_0x239aeb(0x1dc),_0x52676c+=_0x205284,_0x52676c+=_0x239aeb(0x21b),_0x52676c+='</div>',_0x52676c+=_0x239aeb(0x11d);const _0x35cae1={'format':'Letter','orientation':_0x239aeb(0x1ea),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x239aeb(0x127)}}};pdf[_0x239aeb(0x15a)](_0x52676c,_0x35cae1)['toStream'](function(_0x5663be,_0x1399cc){const _0x5401f9=_0x239aeb;if(_0x5663be){_0x202b87[_0x5401f9(0xd7)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x202b87[_0x5401f9(0xf9)](_0x5401f9(0x13e),'application/pdf'),_0x1399cc[_0x5401f9(0x10c)](_0x202b87);});}),router[a0_0x485df5(0x145)](a0_0x485df5(0x1b4),auth,async(_0x27213e,_0x137881)=>{const _0x1383ad=a0_0x485df5;try{const {username:_0x207398,email:_0x2031cd,role:_0x293795}=_0x27213e[_0x1383ad(0x128)],_0x4119ca=_0x27213e[_0x1383ad(0x128)],_0x5e22dd=await profile[_0x1383ad(0x18b)]({'email':_0x4119ca[_0x1383ad(0xd5)]}),_0x47acfc={'year':_0x1383ad(0x1f2),'month':_0x1383ad(0x137),'day':_0x1383ad(0x1f2)},_0x2762d0=await master_shop[_0x1383ad(0x164)](),_0x250fd7=await product[_0x1383ad(0x164)](),_0x13aba9=await warehouse[_0x1383ad(0xfe)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x1383ad(0x111),'localField':_0x1383ad(0x14f),'foreignField':_0x1383ad(0x248),'as':'product_docs'}},{'$unwind':_0x1383ad(0x162)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x1383ad(0x204)}},{'$group':{'_id':_0x1383ad(0x154),'product_stock':{'$sum':_0x1383ad(0x18c)}}}]);if(_0x2762d0[0x0][_0x1383ad(0x1b1)]=='English\x20(US)')var _0x227a05=users[_0x1383ad(0x165)];else{if(_0x2762d0[0x0][_0x1383ad(0x1b1)]=='Hindi')var _0x227a05=users['Hindi'];else{if(_0x2762d0[0x0][_0x1383ad(0x1b1)]=='German')var _0x227a05=users[_0x1383ad(0x20b)];else{if(_0x2762d0[0x0][_0x1383ad(0x1b1)]==_0x1383ad(0x1fb))var _0x227a05=users['Spanish'];else{if(_0x2762d0[0x0][_0x1383ad(0x1b1)]=='French')var _0x227a05=users[_0x1383ad(0x130)];else{if(_0x2762d0[0x0]['language']=='Portuguese\x20(BR)')var _0x227a05=users[_0x1383ad(0x1b0)];else{if(_0x2762d0[0x0]['language']==_0x1383ad(0x19d))var _0x227a05=users[_0x1383ad(0x19d)];else{if(_0x2762d0[0x0][_0x1383ad(0x1b1)]=='Arabic\x20(ae)')var _0x227a05=users[_0x1383ad(0x1a0)];}}}}}}}_0x137881[_0x1383ad(0x1cc)](_0x1383ad(0x1ca),{'success':_0x27213e[_0x1383ad(0x183)](_0x1383ad(0x185)),'errors':_0x27213e[_0x1383ad(0x183)](_0x1383ad(0x1d5)),'alldata':_0x250fd7,'profile':_0x5e22dd,'master_shop':_0x2762d0,'role':_0x4119ca,'product_stock':_0x13aba9,'language':_0x227a05});}catch(_0x58f475){}});async function agentsdataCheck(_0x33a0d8,_0x2d2620){const _0x22d3ee=a0_0x485df5,_0x47e846=await product['aggregate']([{'$group':{'_id':{'brand':_0x22d3ee(0x16a),'category':_0x22d3ee(0x1dd)},'products':{'$push':{'name':'$name','product_code':_0x22d3ee(0x13d)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x29c376=[];_0x29c376[_0x22d3ee(0x22f)]=[];for(let _0x3d5c9d=0x0;_0x3d5c9d<=_0x47e846[_0x22d3ee(0x13c)]-0x1;_0x3d5c9d++){const _0x59d2f2=_0x47e846[_0x3d5c9d];_0x29c376[_0x22d3ee(0x22f)][_0x22d3ee(0x124)](_0x59d2f2);}const _0x45cd41=await product[_0x22d3ee(0xfe)]([{'$group':{'_id':{'category':_0x22d3ee(0x1dd)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x22d3ee(0x1be)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4fe901=await product[_0x22d3ee(0xfe)]([{'$group':{'_id':{'category':'$category','brand':_0x22d3ee(0x16a)}}},{'$group':{'_id':_0x22d3ee(0x1b6),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x176585=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x33a0d8,'$lte':_0x2d2620}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x22d3ee(0x239)}}},{'$lookup':{'from':_0x22d3ee(0x219),'localField':'sales_staff_id','foreignField':_0x22d3ee(0x17c),'as':_0x22d3ee(0x1b7)}},{'$unwind':_0x22d3ee(0xcb)},{'$unwind':_0x22d3ee(0x1b5)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x22d3ee(0x1ac)}},{'$lookup':{'from':_0x22d3ee(0x111),'localField':_0x22d3ee(0x132),'foreignField':_0x22d3ee(0x1af),'as':_0x22d3ee(0xe1)}},{'$unwind':_0x22d3ee(0x228)},{'$group':{'_id':{'sales_id':_0x22d3ee(0x112),'category':_0x22d3ee(0xfa),'brand':_0x22d3ee(0x170)},'salesman_data':{'$first':_0x22d3ee(0x188)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x22d3ee(0x11b),'product_details':{'prod_name':_0x22d3ee(0xe0),'product_code':'$product_info.product_code','category':_0x22d3ee(0xfa),'brand':'$product_info.brand'}}}}}]);let _0x1e6a15='';_0x1e6a15+=_0x22d3ee(0x1c9),_0x1e6a15+=_0x22d3ee(0x1db),_0x1e6a15+=_0x22d3ee(0x1dc),_0x1e6a15+='<tr>',_0x1e6a15+=_0x22d3ee(0x1a9);for(let _0x2284a1=0x0;_0x2284a1<=_0x45cd41['length']-0x1;_0x2284a1++){const _0x27fa93=_0x45cd41[_0x2284a1];for(let _0x287641=0x0;_0x287641<_0x4fe901[_0x22d3ee(0x13c)];_0x287641++){const _0x5672ff=_0x4fe901[_0x287641];_0x5672ff[_0x22d3ee(0x17c)]==_0x27fa93['_id'][_0x22d3ee(0x195)]&&(_0x1e6a15+=_0x22d3ee(0x1cd)+_0x5672ff[_0x22d3ee(0xe9)]+_0x22d3ee(0x18e)+_0x27fa93[_0x22d3ee(0x17c)][_0x22d3ee(0x195)]+_0x22d3ee(0x1d4));}}_0x1e6a15+=_0x22d3ee(0x1a9),_0x1e6a15+=_0x22d3ee(0x1dc),_0x1e6a15+='<tr>',_0x1e6a15+=_0x22d3ee(0x11c);for(let _0x2d1609=0x0;_0x2d1609<=_0x45cd41[_0x22d3ee(0x13c)]-0x1;_0x2d1609++){const _0x27b255=_0x45cd41[_0x2d1609];for(let _0x7d6101=0x0;_0x7d6101<_0x29c376['cat_brand'][_0x22d3ee(0x13c)];_0x7d6101++){const _0x53f8c5=_0x29c376[_0x22d3ee(0x22f)][_0x7d6101];_0x53f8c5['_id'][_0x22d3ee(0x195)]==_0x27b255['_id'][_0x22d3ee(0x195)]&&(_0x1e6a15+='<td\x20class=\x22cat_data\x22>'+_0x53f8c5[_0x22d3ee(0x17c)]['brand']+_0x22d3ee(0x1d4));}}_0x1e6a15+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x1e6a15+=_0x22d3ee(0x1dc);let _0xa3a28e={'name':[],'dataqty':{}};for(let _0x268f7c=0x0;_0x268f7c<_0x29c376[_0x22d3ee(0x22f)][_0x22d3ee(0x13c)];_0x268f7c++){const _0x2a161f=_0x29c376[_0x22d3ee(0x22f)][_0x268f7c],_0x33cb74=_0x2a161f[_0x22d3ee(0x17c)][_0x22d3ee(0x169)],_0x465126=_0x2a161f['_id'][_0x22d3ee(0x195)];!_0xa3a28e[_0x22d3ee(0x109)][_0x33cb74]&&(_0xa3a28e[_0x22d3ee(0x109)][_0x33cb74]={});!_0xa3a28e['dataqty'][_0x33cb74][_0x465126]&&(_0xa3a28e[_0x22d3ee(0x109)][_0x33cb74][_0x465126]=[]);for(let _0x52efa2=0x0;_0x52efa2<_0x176585[_0x22d3ee(0x13c)];_0x52efa2++){const _0x5bfae9=_0x176585[_0x52efa2];if(_0x33cb74===_0x5bfae9[_0x22d3ee(0x17c)]['brand']&&_0x465126===_0x5bfae9[_0x22d3ee(0x17c)][_0x22d3ee(0x195)]){const _0x52bb1e=_0x5bfae9[_0x22d3ee(0x1fe)];!_0xa3a28e[_0x22d3ee(0x109)][_0x33cb74][_0x465126][_0x52bb1e]&&(_0xa3a28e[_0x22d3ee(0x109)][_0x33cb74][_0x465126][_0x52bb1e]=[]),_0xa3a28e[_0x22d3ee(0x109)][_0x33cb74][_0x465126][_0x52bb1e][_0x22d3ee(0x124)](_0x5bfae9[_0x22d3ee(0x1d8)]),!_0xa3a28e[_0x22d3ee(0x248)][_0x22d3ee(0x115)](_0x52bb1e)&&_0xa3a28e['name'][_0x22d3ee(0x124)](_0x52bb1e);}}}_0x1e6a15+=_0x22d3ee(0x1c9);for(let _0x51c197=0x0;_0x51c197<=_0xa3a28e[_0x22d3ee(0x248)][_0x22d3ee(0x13c)]-0x1;_0x51c197++){const _0x2a5779=_0xa3a28e['name'][_0x51c197];_0x1e6a15+=_0x22d3ee(0x23d)+_0x2a5779+_0x22d3ee(0x1d4);var _0x523679=0x0,_0x1b8fd4=0x0;for(let _0x11181a=0x0;_0x11181a<=_0x29c376[_0x22d3ee(0x22f)]['length']-0x1;_0x11181a++){const _0x23d6aa=_0x29c376[_0x22d3ee(0x22f)][_0x11181a];var _0x20a2d7=0x0;_0xa3a28e[_0x22d3ee(0x109)][_0x23d6aa[_0x22d3ee(0x17c)][_0x22d3ee(0x169)]][_0x23d6aa['_id'][_0x22d3ee(0x195)]][_0x2a5779]?(_0x20a2d7=_0xa3a28e[_0x22d3ee(0x109)][_0x23d6aa['_id'][_0x22d3ee(0x169)]][_0x23d6aa[_0x22d3ee(0x17c)][_0x22d3ee(0x195)]][_0x2a5779][0x0],_0x1e6a15+=_0x22d3ee(0x23d)+formatNumber(_0x20a2d7[_0x22d3ee(0xcf)](0x2))+'</td>'):(_0x20a2d7=0x0,_0x1e6a15+=_0x22d3ee(0x23d)+_0x20a2d7+_0x22d3ee(0x1d4)),_0x523679+=_0x20a2d7;}_0x1e6a15+=_0x22d3ee(0x23d)+formatNumber(_0x523679['toFixed'](0x2))+'</td>';}return _0x1e6a15+=_0x22d3ee(0x1dc),_0x1e6a15;}router[a0_0x485df5(0x244)]('/agent/pdf',auth,async(_0x88fc32,_0x186868)=>{const _0x3ba1a2=a0_0x485df5,{from_date:_0x1534dc,to_date:_0x569840}=_0x88fc32[_0x3ba1a2(0x18a)],_0x370f1c=await agentsdataCheck(_0x1534dc,_0x569840);{}let _0x20e3ee='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x462cb3=new Date(_0x1534dc),_0x3943d0=new Date(_0x569840);const _0x29fa2a={'year':_0x3ba1a2(0x1f2),'month':_0x3ba1a2(0x137),'day':_0x3ba1a2(0x1f2)},_0x8ef3db=new Intl[(_0x3ba1a2(0x11a))](_0x3ba1a2(0x24b),_0x29fa2a)[_0x3ba1a2(0x1c3)](_0x462cb3),_0x1ea4db=new Intl[(_0x3ba1a2(0x11a))](_0x3ba1a2(0x24b),_0x29fa2a)[_0x3ba1a2(0x1c3)](_0x3943d0);_0x20e3ee+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x20e3ee+=_0x3ba1a2(0x122),_0x20e3ee+='<p>'+_0x8ef3db+_0x3ba1a2(0x1a1)+_0x1ea4db+_0x3ba1a2(0xda),_0x20e3ee+='<div\x20class=\x22row\x22>',_0x20e3ee+='<div\x20class=\x22col-sm-11\x22>',_0x20e3ee+=_0x3ba1a2(0x18f),_0x20e3ee+=_0x370f1c,_0x20e3ee+=_0x3ba1a2(0x21b),_0x20e3ee+=_0x3ba1a2(0x11d),_0x20e3ee+='</div>';const _0x2b7c56={'format':_0x3ba1a2(0x1a2),'orientation':_0x3ba1a2(0x1ea),'childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf['create'](_0x20e3ee,_0x2b7c56)[_0x3ba1a2(0x189)](function(_0xeaa19f,_0x493a93){const _0x3ed270=_0x3ba1a2;if(_0xeaa19f){_0x186868[_0x3ed270(0xd7)](0x1f4)[_0x3ed270(0x16d)](_0x3ed270(0x20c));return;}_0x186868[_0x3ed270(0xf9)](_0x3ed270(0x13e),_0x3ed270(0xf2)),_0x493a93[_0x3ed270(0x10c)](_0x186868);});}),router['get'](a0_0x485df5(0x1d9),auth,async(_0x283937,_0x46c36a)=>{const _0x490bd3=a0_0x485df5;try{const {username:_0x47e7d9,email:_0x4fd463,role:_0x3e7032}=_0x283937['user'],_0x64794d=_0x283937['user'],_0x53d540=await profile[_0x490bd3(0x18b)]({'email':_0x64794d['email']}),_0x30b329={'year':_0x490bd3(0x1f2),'month':'long','day':_0x490bd3(0x1f2)},_0x258a5c=await master_shop[_0x490bd3(0x164)](),_0x201238=await staff[_0x490bd3(0x18b)]({'email':_0x64794d[_0x490bd3(0xd5)]}),_0x5a8ba4=await product[_0x490bd3(0x164)](),_0x29f384=await warehouse[_0x490bd3(0xfe)]([{'$unwind':_0x490bd3(0x156)},{'$lookup':{'from':_0x490bd3(0x111),'localField':_0x490bd3(0x14f),'foreignField':_0x490bd3(0x248),'as':_0x490bd3(0x1e3)}},{'$unwind':_0x490bd3(0x162)},{'$project':{'product_name':_0x490bd3(0x134),'product_stock':_0x490bd3(0x204)}},{'$group':{'_id':_0x490bd3(0x154),'product_stock':{'$sum':_0x490bd3(0x18c)}}}]),_0x2a4b30=await staff[_0x490bd3(0x164)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x258a5c[0x0][_0x490bd3(0x1b1)]==_0x490bd3(0x133))var _0x5acbd1=users['English'];else{if(_0x258a5c[0x0]['language']==_0x490bd3(0xfd))var _0x5acbd1=users['Hindi'];else{if(_0x258a5c[0x0][_0x490bd3(0x1b1)]=='German')var _0x5acbd1=users[_0x490bd3(0x20b)];else{if(_0x258a5c[0x0]['language']=='Spanish')var _0x5acbd1=users[_0x490bd3(0x1fb)];else{if(_0x258a5c[0x0]['language']==_0x490bd3(0x130))var _0x5acbd1=users['French'];else{if(_0x258a5c[0x0][_0x490bd3(0x1b1)]=='Portuguese\x20(BR)')var _0x5acbd1=users[_0x490bd3(0x1b0)];else{if(_0x258a5c[0x0]['language']==_0x490bd3(0x19d))var _0x5acbd1=users[_0x490bd3(0x19d)];else{if(_0x258a5c[0x0][_0x490bd3(0x1b1)]==_0x490bd3(0x1bc))var _0x5acbd1=users[_0x490bd3(0x1a0)];}}}}}}}_0x46c36a[_0x490bd3(0x1cc)]('dsi_sales_admin',{'success':_0x283937[_0x490bd3(0x183)]('success'),'errors':_0x283937[_0x490bd3(0x183)](_0x490bd3(0x1d5)),'alldata':_0x5a8ba4,'profile':_0x53d540,'master_shop':_0x258a5c,'role':_0x64794d,'product_stock':_0x29f384,'language':_0x5acbd1,'staff_arr':_0x201238,'staff_data_all':_0x2a4b30});}catch(_0x536bfc){_0x46c36a[_0x490bd3(0x1c4)](_0x536bfc);}});async function agentsdataDSICheck_admin(_0x31706b,_0x229a01,_0x410c5e,_0x4f0426){const _0x4b30eb=a0_0x485df5,_0x52951c=await product[_0x4b30eb(0xfe)]([{'$group':{'_id':{'brand':_0x4b30eb(0x16a),'category':_0x4b30eb(0x1dd)},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2989e2=[];_0x2989e2[_0x4b30eb(0x22f)]=[];for(let _0x1027e6=0x0;_0x1027e6<=_0x52951c[_0x4b30eb(0x13c)]-0x1;_0x1027e6++){const _0x3f62c7=_0x52951c[_0x1027e6];_0x2989e2[_0x4b30eb(0x22f)][_0x4b30eb(0x124)](_0x3f62c7);}const _0xf35971=await product[_0x4b30eb(0xfe)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x4b30eb(0x16a),'product_code':'$product_code','product_name':_0x4b30eb(0x1be)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1b9774=await product[_0x4b30eb(0xfe)]([{'$group':{'_id':{'category':_0x4b30eb(0x1dd),'brand':'$brand'}}},{'$group':{'_id':_0x4b30eb(0x1b6),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3df95e=await sales_sa[_0x4b30eb(0xfe)]([{'$match':{'date':{'$gte':_0x31706b,'$lte':_0x229a01},'sales_staff_id':_0x410c5e,'sale_product.isFG':_0x4b30eb(0x1ac)}},{'$unwind':_0x4b30eb(0x1b5)},{'$match':{'sale_product.isFG':_0x4b30eb(0x1ac)}},{'$lookup':{'from':_0x4b30eb(0x111),'localField':_0x4b30eb(0x132),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x4b30eb(0x228)},{'$group':{'_id':{'dsi':_0x4b30eb(0x213),'date':_0x4b30eb(0x176),'customer':_0x4b30eb(0x235)},'totalQty':{'$sum':_0x4b30eb(0x11b)},'products':{'$push':{'qty':_0x4b30eb(0x11b),'NetPrice':_0x4b30eb(0x159),'discount':_0x4b30eb(0x1c0),'adj_discount':_0x4b30eb(0x1c2),'product_details':{'prod_name':'$product_info.name','product_code':_0x4b30eb(0x1fd),'category':_0x4b30eb(0xfa),'brand':_0x4b30eb(0x170),'gross_price':_0x4b30eb(0xff)}}}}},{'$unwind':_0x4b30eb(0x13a)},{'$group':{'_id':{'dsi':_0x4b30eb(0x1e7),'date':'$_id.date','customer':_0x4b30eb(0x217),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x4b30eb(0xfb)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x4b30eb(0x14d)]}},'NetPrice':{'$sum':_0x4b30eb(0x245)},'discount':{'$sum':_0x4b30eb(0x150)},'adj_discount':{'$sum':_0x4b30eb(0x1bf)},'product_details':{'$first':_0x4b30eb(0x141)}}},{'$group':{'_id':{'dsi':_0x4b30eb(0x1e7),'date':_0x4b30eb(0x186),'customer':_0x4b30eb(0x217)},'totalQty':{'$sum':_0x4b30eb(0x101)},'totalGross':{'$sum':_0x4b30eb(0x24a)},'NetPrice':{'$sum':_0x4b30eb(0x206)},'discount':{'$sum':_0x4b30eb(0x1f3)},'adj_discount':{'$sum':_0x4b30eb(0xdb)},'products':{'$push':{'qty':_0x4b30eb(0x101),'category':_0x4b30eb(0x1b6),'brand':'$_id.brand','product_details':_0x4b30eb(0x156)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x529270=[],_0x24b62f={},_0x21f0f1={},_0x3400c8={};var _0x3a4e2c=0x0,_0x463e4b=0x0,_0x1ace9c=0x0,_0x4f939d=0x0,_0x47e5fd=0x0;const _0x308ccb=0x6;for(let _0x3c1be2=0x0;_0x3c1be2<=_0x3df95e[_0x4b30eb(0x13c)]-0x1;_0x3c1be2++){const _0x1728ec=_0x3df95e[_0x3c1be2];let _0x3957a6=_0x4b30eb(0x1c9);_0x3957a6+=_0x4b30eb(0x1d1)+_0x1728ec[_0x4b30eb(0x17c)][_0x4b30eb(0x129)]+_0x4b30eb(0x1d4),_0x3957a6+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1728ec['_id'][_0x4b30eb(0x1d2)]+'</td>',_0x3957a6+=_0x4b30eb(0x1d1)+_0x1728ec[_0x4b30eb(0x17c)][_0x4b30eb(0x171)]+_0x4b30eb(0x1d4);let _0x5a4df8={};var _0x5ebfa4=0x0;for(let _0x1c7ad3=0x0;_0x1c7ad3<=_0x1728ec['products']['length']-0x1;_0x1c7ad3++){const _0x479b66=_0x1728ec[_0x4b30eb(0x111)][_0x1c7ad3];_0x5a4df8[_0x479b66[_0x4b30eb(0x169)]+'-'+_0x479b66[_0x4b30eb(0x195)]]=_0x479b66[_0x4b30eb(0x135)];const _0x48657d=_0x479b66['brand']+'-'+_0x479b66[_0x4b30eb(0x195)];!_0x24b62f[_0x48657d]&&(_0x24b62f[_0x48657d]=0x0),!Array[_0x4b30eb(0x105)](_0x3400c8[_0x48657d])&&(_0x3400c8[_0x48657d]=[]),!Array[_0x4b30eb(0x105)](_0x3400c8[_0x48657d])&&(_0x3400c8[_0x48657d]=[]),_0x24b62f[_0x48657d]+=_0x479b66[_0x4b30eb(0x135)],_0x3400c8[_0x48657d][_0x4b30eb(0x124)](_0x479b66[_0x4b30eb(0x135)]),_0x5ebfa4++;}console[_0x4b30eb(0xeb)](_0x1728ec);for(let _0x506f33=0x0;_0x506f33<=_0x2989e2['cat_brand'][_0x4b30eb(0x13c)]-0x1;_0x506f33++){const _0x41b80a=_0x2989e2['cat_brand'][_0x506f33],_0x72e7f6=_0x41b80a[_0x4b30eb(0x17c)][_0x4b30eb(0x169)]+'-'+_0x41b80a[_0x4b30eb(0x17c)][_0x4b30eb(0x195)];_0x3957a6+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x5a4df8[_0x72e7f6]!==undefined?_0x5a4df8[_0x72e7f6][_0x4b30eb(0xcf)](0x2):'')+_0x4b30eb(0x1d4);}_0x1ace9c=_0x1728ec[_0x4b30eb(0x1a4)]+_0x1728ec[_0x4b30eb(0x144)],_0x3957a6+=_0x4b30eb(0xd2)+formatNumber(parseFloat(_0x1728ec[_0x4b30eb(0x1f8)],0x2)['toFixed'](0x2))+_0x4b30eb(0x1d4),_0x3957a6+=_0x4b30eb(0xd2)+formatNumber(_0x1728ec[_0x4b30eb(0x1b9)][_0x4b30eb(0xcf)](0x2))+_0x4b30eb(0x1d4),_0x3957a6+=_0x4b30eb(0xd2)+formatNumber(_0x1ace9c)+_0x4b30eb(0x1d4),_0x3957a6+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x1728ec[_0x4b30eb(0x1cf)][_0x4b30eb(0xcf)](0x2))+'</td>',_0x3957a6+=_0x4b30eb(0x1dc),_0x3a4e2c+=parseFloat(_0x1728ec[_0x4b30eb(0x1f8)]['toFixed'](0x2)),_0x463e4b+=parseFloat(_0x1728ec[_0x4b30eb(0x1cf)][_0x4b30eb(0xcf)](0x2)),_0x4f939d+=_0x1ace9c,_0x47e5fd+=parseFloat(_0x1728ec[_0x4b30eb(0x1b9)]['toFixed'](0x2));if(_0x3c1be2==_0x3df95e[_0x4b30eb(0x13c)]-0x1){_0x3957a6+=_0x4b30eb(0x1c9),_0x3957a6+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x3957a6+=_0x4b30eb(0x1d4);for(let _0x4406f4=0x0;_0x4406f4<=_0x2989e2[_0x4b30eb(0x22f)][_0x4b30eb(0x13c)]-0x1;_0x4406f4++){const _0x5b7e16=_0x2989e2['cat_brand'][_0x4406f4],_0x43abf6=_0x5b7e16[_0x4b30eb(0x17c)]['brand']+'-'+_0x5b7e16[_0x4b30eb(0x17c)][_0x4b30eb(0x195)];!_0x3400c8[_0x43abf6]&&(_0x3400c8[_0x43abf6]=[]);const _0x2ea080=_0x3400c8[_0x43abf6][_0x4b30eb(0x17d)]((_0x230027,_0x5ea3b6)=>_0x230027+_0x5ea3b6,0x0);console[_0x4b30eb(0xeb)](_0x4b30eb(0x1c7),_0x43abf6),_0x3957a6+=_0x4b30eb(0x1ad)+(_0x2ea080!==undefined?formatNumber(_0x2ea080['toFixed'](0x2)):'')+_0x4b30eb(0x1ed),console[_0x4b30eb(0xeb)](_0x3400c8[_0x43abf6][_0x4b30eb(0x17d)]((_0x4f4dff,_0x2a9f6a)=>_0x4f4dff+_0x2a9f6a,0x0));}_0x3957a6+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3a4e2c['toFixed'](0x2))+_0x4b30eb(0x1ed),_0x3957a6+=_0x4b30eb(0x178)+formatNumber(_0x47e5fd)+_0x4b30eb(0x1ed),_0x3957a6+=_0x4b30eb(0x178)+formatNumber(_0x4f939d)+'</b></td>',_0x3957a6+=_0x4b30eb(0x178)+formatNumber(_0x463e4b)+_0x4b30eb(0x1ed),_0x3957a6+=_0x4b30eb(0x1dc);}_0x529270[_0x4b30eb(0x124)](_0x3957a6);}function _0x29ef24(_0x5e1517,_0x41a2f9){const _0x1380a6=_0x4b30eb,_0x1de44e=[];for(let _0x2e8d24=0x0;_0x2e8d24<=_0x5e1517['length']-0x1;_0x2e8d24+=_0x41a2f9){_0x1de44e[_0x1380a6(0x124)](_0x5e1517[_0x1380a6(0x184)](_0x2e8d24,_0x2e8d24+_0x41a2f9));}return _0x1de44e;}const _0x251e46=_0x29ef24(_0x529270,_0x308ccb);let _0x2dfe2b='';return _0x251e46['forEach']((_0x58acbf,_0x5e9451)=>{const _0x41e5af=_0x4b30eb;_0x5e9451>0x0&&(_0x2dfe2b+=_0x41e5af(0x232));_0x2dfe2b+=_0x41e5af(0x18f),_0x2dfe2b+=_0x41e5af(0x191),_0x2dfe2b+=_0x41e5af(0x1c9),_0x2dfe2b+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x2dfe2b+='</tr>',_0x2dfe2b+=_0x41e5af(0x1c9),_0x2dfe2b+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x2a04f0=0x0;_0x2a04f0<=_0xf35971[_0x41e5af(0x13c)]-0x1;_0x2a04f0++){const _0x3ffec4=_0xf35971[_0x2a04f0];for(let _0xac7ad=0x0;_0xac7ad<_0x1b9774[_0x41e5af(0x13c)];_0xac7ad++){const _0xa953c8=_0x1b9774[_0xac7ad];_0xa953c8['_id']===_0x3ffec4[_0x41e5af(0x17c)][_0x41e5af(0x195)]&&(_0x2dfe2b+=_0x41e5af(0x1cd)+_0xa953c8['brandCount']+_0x41e5af(0x18e)+_0x3ffec4[_0x41e5af(0x17c)]['category']+_0x41e5af(0x1d4));}}_0x2dfe2b+=_0x41e5af(0x131),_0x2dfe2b+=_0x41e5af(0x1dc),_0x2dfe2b+=_0x41e5af(0x1c9),_0x2dfe2b+=_0x41e5af(0x210),_0x2dfe2b+=_0x41e5af(0x158),_0x2dfe2b+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x5a561f=0x0;_0x5a561f<=_0xf35971[_0x41e5af(0x13c)]-0x1;_0x5a561f++){const _0xaf70bf=_0xf35971[_0x5a561f];for(let _0xa61d00=0x0;_0xa61d00<_0x2989e2[_0x41e5af(0x22f)][_0x41e5af(0x13c)];_0xa61d00++){const _0x36bfc1=_0x2989e2[_0x41e5af(0x22f)][_0xa61d00];_0x36bfc1[_0x41e5af(0x17c)][_0x41e5af(0x195)]===_0xaf70bf['_id']['category']&&(_0x2dfe2b+=_0x41e5af(0x19b)+_0x36bfc1[_0x41e5af(0x17c)][_0x41e5af(0x169)]+'</td>');}}_0x2dfe2b+=_0x41e5af(0x22e),_0x2dfe2b+=_0x41e5af(0x157),_0x2dfe2b+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x2dfe2b+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x2dfe2b+='</tr>',_0x2dfe2b+=_0x41e5af(0x24d),_0x2dfe2b+=_0x41e5af(0xd8),_0x58acbf[_0x41e5af(0x181)](_0x39bc4b=>{_0x2dfe2b+=_0x39bc4b;}),console[_0x41e5af(0xeb)](_0x3400c8),_0x2dfe2b+='</tbody>',_0x2dfe2b+='</table>';}),_0x2dfe2b;}async function agentsdataDSICheck_admin_excel(_0x5e3456,_0x5ac10d,_0x381bd9,_0x27de4){const _0xba71f=a0_0x485df5,_0x2aff2f=await product[_0xba71f(0xfe)]([{'$group':{'_id':{'brand':'$brand','category':_0xba71f(0x1dd)},'products':{'$push':{'name':_0xba71f(0x1be),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x529c02=[];_0x529c02[_0xba71f(0x22f)]=[];for(let _0x1b2228=0x0;_0x1b2228<=_0x2aff2f[_0xba71f(0x13c)]-0x1;_0x1b2228++){const _0x51dc70=_0x2aff2f[_0x1b2228];_0x529c02[_0xba71f(0x22f)][_0xba71f(0x124)](_0x51dc70);}const _0x318cea=await product[_0xba71f(0xfe)]([{'$group':{'_id':{'category':_0xba71f(0x1dd)},'products':{'$push':{'brand':_0xba71f(0x16a),'product_code':_0xba71f(0x13d),'product_name':_0xba71f(0x1be)}}}},{'$sort':{'_id.category':-0x1}}]),_0x457d33=await product['aggregate']([{'$group':{'_id':{'category':_0xba71f(0x1dd),'brand':_0xba71f(0x16a)}}},{'$group':{'_id':_0xba71f(0x1b6),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x401718=await sales_sa[_0xba71f(0xfe)]([{'$match':{'date':{'$gte':_0x5e3456,'$lte':_0x5ac10d},'sales_staff_id':_0x381bd9,'sale_product.isFG':'false'}},{'$unwind':_0xba71f(0x1b5)},{'$match':{'sale_product.isFG':_0xba71f(0x1ac)}},{'$lookup':{'from':_0xba71f(0x111),'localField':'sale_product.product_code','foreignField':'product_code','as':_0xba71f(0xe1)}},{'$unwind':_0xba71f(0x228)},{'$group':{'_id':{'dsi':_0xba71f(0x213),'date':'$date','customer':_0xba71f(0x235)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0xba71f(0x11b),'NetPrice':'$sale_product.totalprice','discount':_0xba71f(0x1c0),'adj_discount':_0xba71f(0x1c2),'product_details':{'prod_name':_0xba71f(0xe0),'product_code':'$product_info.product_code','category':_0xba71f(0xfa),'brand':_0xba71f(0x170),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0xba71f(0x1e7),'date':_0xba71f(0x186),'customer':_0xba71f(0x217),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0xba71f(0xfb),_0xba71f(0x14d)]}},'NetPrice':{'$sum':_0xba71f(0x245)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0xba71f(0x1bf)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0xba71f(0x186),'customer':_0xba71f(0x217)},'totalQty':{'$sum':_0xba71f(0x101)},'totalGross':{'$sum':_0xba71f(0x24a)},'NetPrice':{'$sum':_0xba71f(0x206)},'discount':{'$sum':_0xba71f(0x1f3)},'adj_discount':{'$sum':_0xba71f(0xdb)},'products':{'$push':{'qty':_0xba71f(0x101),'category':'$_id.category','brand':_0xba71f(0x1bd),'product_details':_0xba71f(0x156)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x56ba5a=[],_0x16d4f1={},_0x2e7022={},_0x294735={};var _0x36e1b4=0x0,_0xbb1461=0x0,_0x4fd79c=0x0,_0x157072=0x0,_0x582ea3=0x0;const _0x558147=0x16345785d8a0000;for(let _0x32fdf9=0x0;_0x32fdf9<=_0x401718[_0xba71f(0x13c)]-0x1;_0x32fdf9++){const _0x2ce5be=_0x401718[_0x32fdf9];let _0x384361=_0xba71f(0x1c9);_0x384361+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2ce5be['_id'][_0xba71f(0x129)]+_0xba71f(0x1d4),_0x384361+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2ce5be['_id'][_0xba71f(0x1d2)]+_0xba71f(0x1d4),_0x384361+=_0xba71f(0x1d1)+_0x2ce5be[_0xba71f(0x17c)][_0xba71f(0x171)]+_0xba71f(0x1d4);let _0x47bbeb={};var _0x2f73b9=0x0;for(let _0x237c97=0x0;_0x237c97<=_0x2ce5be[_0xba71f(0x111)][_0xba71f(0x13c)]-0x1;_0x237c97++){const _0x2aa268=_0x2ce5be['products'][_0x237c97];_0x47bbeb[_0x2aa268['brand']+'-'+_0x2aa268[_0xba71f(0x195)]]=_0x2aa268[_0xba71f(0x135)];const _0x316869=_0x2aa268[_0xba71f(0x169)]+'-'+_0x2aa268[_0xba71f(0x195)];!_0x16d4f1[_0x316869]&&(_0x16d4f1[_0x316869]=0x0),!Array[_0xba71f(0x105)](_0x294735[_0x316869])&&(_0x294735[_0x316869]=[]),!Array[_0xba71f(0x105)](_0x294735[_0x316869])&&(_0x294735[_0x316869]=[]),_0x16d4f1[_0x316869]+=_0x2aa268[_0xba71f(0x135)],_0x294735[_0x316869][_0xba71f(0x124)](_0x2aa268['qty']),_0x2f73b9++;}console[_0xba71f(0xeb)](_0x2ce5be);for(let _0x40abda=0x0;_0x40abda<=_0x529c02[_0xba71f(0x22f)][_0xba71f(0x13c)]-0x1;_0x40abda++){const _0xc2557f=_0x529c02[_0xba71f(0x22f)][_0x40abda],_0x2fb96a=_0xc2557f[_0xba71f(0x17c)][_0xba71f(0x169)]+'-'+_0xc2557f[_0xba71f(0x17c)][_0xba71f(0x195)];_0x384361+=_0xba71f(0x182)+(_0x47bbeb[_0x2fb96a]!==undefined?_0x47bbeb[_0x2fb96a][_0xba71f(0xcf)](0x2):'')+'</td>';}_0x4fd79c=_0x2ce5be[_0xba71f(0x1a4)]+_0x2ce5be[_0xba71f(0x144)],_0x384361+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x2ce5be[_0xba71f(0x1f8)],0x2)[_0xba71f(0xcf)](0x2))+'</td>',_0x384361+=_0xba71f(0xd2)+formatNumber(_0x2ce5be['totalGross'][_0xba71f(0xcf)](0x2))+_0xba71f(0x1d4),_0x384361+=_0xba71f(0xd2)+formatNumber(_0x4fd79c)+_0xba71f(0x1d4),_0x384361+=_0xba71f(0xd2)+formatNumber(_0x2ce5be[_0xba71f(0x1cf)][_0xba71f(0xcf)](0x2))+_0xba71f(0x1d4),_0x384361+=_0xba71f(0x1dc),_0x36e1b4+=parseFloat(_0x2ce5be[_0xba71f(0x1f8)][_0xba71f(0xcf)](0x2)),_0xbb1461+=parseFloat(_0x2ce5be[_0xba71f(0x1cf)][_0xba71f(0xcf)](0x2)),_0x157072+=_0x4fd79c,_0x582ea3+=parseFloat(_0x2ce5be[_0xba71f(0x1b9)][_0xba71f(0xcf)](0x2));if(_0x32fdf9==_0x401718[_0xba71f(0x13c)]-0x1){_0x384361+=_0xba71f(0x1c9),_0x384361+=_0xba71f(0x216),_0x384361+='</td>';for(let _0x5b468f=0x0;_0x5b468f<=_0x529c02[_0xba71f(0x22f)][_0xba71f(0x13c)]-0x1;_0x5b468f++){const _0x204484=_0x529c02[_0xba71f(0x22f)][_0x5b468f],_0x36556b=_0x204484['_id'][_0xba71f(0x169)]+'-'+_0x204484['_id']['category'];!_0x294735[_0x36556b]&&(_0x294735[_0x36556b]=[]);const _0x1dc10a=_0x294735[_0x36556b]['reduce']((_0x4aff6b,_0x299e7a)=>_0x4aff6b+_0x299e7a,0x0);console[_0xba71f(0xeb)](_0xba71f(0x1c7),_0x36556b),_0x384361+=_0xba71f(0x1ad)+(_0x1dc10a!==undefined?formatNumber(_0x1dc10a[_0xba71f(0xcf)](0x2)):'')+_0xba71f(0x1ed),console[_0xba71f(0xeb)](_0x294735[_0x36556b]['reduce']((_0x3f2dbe,_0x51425b)=>_0x3f2dbe+_0x51425b,0x0));}_0x384361+=_0xba71f(0x178)+formatNumber(_0x36e1b4[_0xba71f(0xcf)](0x2))+_0xba71f(0x1ed),_0x384361+=_0xba71f(0x178)+formatNumber(_0x582ea3)+_0xba71f(0x1ed),_0x384361+=_0xba71f(0x178)+formatNumber(_0x157072)+_0xba71f(0x1ed),_0x384361+=_0xba71f(0x178)+formatNumber(_0xbb1461)+_0xba71f(0x1ed),_0x384361+='</tr>';}_0x56ba5a[_0xba71f(0x124)](_0x384361);}function _0x4a0be2(_0x3794c8,_0x45e664){const _0x3daaee=_0xba71f,_0x2ffcd4=[];for(let _0x361fbc=0x0;_0x361fbc<=_0x3794c8[_0x3daaee(0x13c)]-0x1;_0x361fbc+=_0x45e664){_0x2ffcd4[_0x3daaee(0x124)](_0x3794c8[_0x3daaee(0x184)](_0x361fbc,_0x361fbc+_0x45e664));}return _0x2ffcd4;}const _0x25ec3e=_0x4a0be2(_0x56ba5a,_0x558147);let _0x34fc7c='';return _0x25ec3e[_0xba71f(0x181)]((_0x53ce7b,_0x15e45a)=>{const _0x104201=_0xba71f;_0x15e45a>0x0&&(_0x34fc7c+=_0x104201(0x232));_0x34fc7c+=_0x104201(0x18f),_0x34fc7c+='<thead>',_0x34fc7c+=_0x104201(0x1c9),_0x34fc7c+=_0x104201(0x108),_0x34fc7c+=_0x104201(0x1dc),_0x34fc7c+=_0x104201(0x1c9),_0x34fc7c+=_0x104201(0x1bb);for(let _0x2f24ea=0x0;_0x2f24ea<=_0x318cea[_0x104201(0x13c)]-0x1;_0x2f24ea++){const _0x26d363=_0x318cea[_0x2f24ea];for(let _0x60de2d=0x0;_0x60de2d<_0x457d33['length'];_0x60de2d++){const _0x34c960=_0x457d33[_0x60de2d];_0x34c960[_0x104201(0x17c)]===_0x26d363[_0x104201(0x17c)][_0x104201(0x195)]&&(_0x34fc7c+=_0x104201(0x1cd)+_0x34c960['brandCount']+_0x104201(0x18e)+_0x26d363[_0x104201(0x17c)][_0x104201(0x195)]+_0x104201(0x1d4));}}_0x34fc7c+=_0x104201(0x131),_0x34fc7c+=_0x104201(0x1dc),_0x34fc7c+=_0x104201(0x1c9),_0x34fc7c+=_0x104201(0x210),_0x34fc7c+=_0x104201(0x158),_0x34fc7c+=_0x104201(0x1df);for(let _0x496c5a=0x0;_0x496c5a<=_0x318cea['length']-0x1;_0x496c5a++){const _0x2a568e=_0x318cea[_0x496c5a];for(let _0x51d8f9=0x0;_0x51d8f9<_0x529c02[_0x104201(0x22f)][_0x104201(0x13c)];_0x51d8f9++){const _0x36d853=_0x529c02['cat_brand'][_0x51d8f9];_0x36d853[_0x104201(0x17c)][_0x104201(0x195)]===_0x2a568e['_id'][_0x104201(0x195)]&&(_0x34fc7c+=_0x104201(0x19b)+_0x36d853[_0x104201(0x17c)][_0x104201(0x169)]+_0x104201(0x1d4));}}_0x34fc7c+=_0x104201(0x22e),_0x34fc7c+=_0x104201(0x157),_0x34fc7c+=_0x104201(0x1d7),_0x34fc7c+=_0x104201(0x161),_0x34fc7c+='</tr>',_0x34fc7c+=_0x104201(0x24d),_0x34fc7c+=_0x104201(0xd8),_0x53ce7b['forEach'](_0x5532e2=>{_0x34fc7c+=_0x5532e2;}),console[_0x104201(0xeb)](_0x294735),_0x34fc7c+=_0x104201(0x10e),_0x34fc7c+='</table>';}),_0x34fc7c;}router[a0_0x485df5(0x244)](a0_0x485df5(0x1ee),auth,async(_0x317288,_0x14f3f8)=>{const _0x5806cc=a0_0x485df5,{from_date:_0x45762d,to_date:_0xe40b39,isExcel:_0x79ff31,agent_id:_0xad4ec2}=_0x317288[_0x5806cc(0x18a)],_0x4a4424=_0x317288[_0x5806cc(0x128)],_0x1ae08d=await staff[_0x5806cc(0x18b)]({'email':_0x4a4424[_0x5806cc(0xd5)]}),_0x6d22f5=await master_shop[_0x5806cc(0x164)](),_0x402d0f=await agentsdataDSICheck_admin(_0x45762d,_0xe40b39,_0xad4ec2,_0x79ff31),_0x359a14=await agentsdataDSICheck_admin_excel(_0x45762d,_0xe40b39,_0xad4ec2,_0x79ff31);let _0x2b8821='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x34d1d5=new Date(_0x45762d),_0x1a6d6a=new Date(_0xe40b39);const _0xd9d8={'year':_0x5806cc(0x1f2),'month':'long','day':_0x5806cc(0x1f2)},_0x526af2=new Intl['DateTimeFormat'](_0x5806cc(0x24b),_0xd9d8)[_0x5806cc(0x1c3)](_0x34d1d5),_0x44b05e=new Intl['DateTimeFormat'](_0x5806cc(0x24b),_0xd9d8)['format'](_0x1a6d6a);_0x2b8821+=_0x5806cc(0x1cb),_0x2b8821+=_0x5806cc(0xee),_0x2b8821+=_0x5806cc(0x18f),_0x2b8821+=_0x402d0f,_0x2b8821+=_0x5806cc(0x21b),_0x2b8821+=_0x5806cc(0x11d),_0x2b8821+=_0x5806cc(0x11d);let _0x317991=_0x5806cc(0x1b3);_0x317991+=_0x5806cc(0x1cb),_0x317991+=_0x5806cc(0xee),_0x317991+=_0x5806cc(0x18f),_0x317991+=_0x359a14,_0x317991+='</table>',_0x317991+=_0x5806cc(0x11d),_0x317991+=_0x5806cc(0x11d);let _0x3c30a2=_0x5806cc(0x215);const _0x3c00d4={'width':_0x5806cc(0x10b),'height':'8.5in','orientation':_0x5806cc(0x1ea),'border':{'top':_0x5806cc(0x117),'right':_0x5806cc(0x117),'bottom':_0x5806cc(0x117),'left':_0x5806cc(0x117)},'header':{'height':'60mm','contents':_0x5806cc(0x1ef)+_0x3c30a2+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x526af2+_0x5806cc(0x1a1)+_0x44b05e+_0x5806cc(0x113)},'footer':{'height':'20mm','contents':{'default':_0x5806cc(0x163)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x79ff31=='on'){const _0x94426e=cheerio[_0x5806cc(0x146)](_0x317991);let _0x587f27=[],_0x562283=[],_0x2f1deb=[];_0x94426e(_0x5806cc(0x16f))[_0x5806cc(0x142)]((_0x4c03bf,_0x160dfa)=>{const _0x19d710=_0x5806cc;let _0x378a7f=[],_0x78ce40=0x0;while(_0x2f1deb[_0x78ce40]){_0x2f1deb[_0x78ce40]--,_0x78ce40++;}_0x94426e(_0x160dfa)['find']('td,\x20th')['each']((_0x5be46e,_0xc35667)=>{const _0x504563=a0_0x3c97;let _0x4a4d51=_0x94426e(_0xc35667)[_0x504563(0x12a)]()['trim'](),_0x342fd1=parseFloat(_0x4a4d51['replace'](/,/g,''));isNaN(_0x342fd1)&&(_0x342fd1=_0x4a4d51);let _0x5d4793=parseInt(_0x94426e(_0xc35667)[_0x504563(0x166)]('colspan'))||0x1,_0x37d01d=parseInt(_0x94426e(_0xc35667)[_0x504563(0x166)](_0x504563(0xf1)))||0x1;_0x378a7f[_0x78ce40]=_0x342fd1;(_0x5d4793>0x1||_0x37d01d>0x1)&&_0x562283['push']({'s':{'r':_0x4c03bf,'c':_0x78ce40},'e':{'r':_0x4c03bf+_0x37d01d-0x1,'c':_0x78ce40+_0x5d4793-0x1}});for(let _0x169b7a=0x0;_0x169b7a<_0x5d4793;_0x169b7a++){_0x37d01d>0x1&&(_0x2f1deb[_0x78ce40+_0x169b7a]=_0x37d01d-0x1);}_0x78ce40+=_0x5d4793;}),_0x587f27[_0x19d710(0x124)](_0x378a7f);});const _0x2d4c35=XLSX[_0x5806cc(0x1d6)]['book_new'](),_0x1090e8=XLSX['utils'][_0x5806cc(0x148)](_0x587f27);_0x562283['length']>0x0&&(_0x1090e8[_0x5806cc(0x1ab)]=_0x562283);_0x1090e8['!cols']=_0x587f27[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x5806cc(0x1d6)][_0x5806cc(0x125)](_0x2d4c35,_0x1090e8,_0x5806cc(0x1f0));const _0x359832=XLSX[_0x5806cc(0x136)](_0x2d4c35,{'bookType':'xlsx','type':'buffer'});_0x14f3f8['setHeader'](_0x5806cc(0xf3),_0x5806cc(0x140)),_0x14f3f8[_0x5806cc(0xf9)]('Content-Type',_0x5806cc(0x21d)),_0x14f3f8[_0x5806cc(0x16d)](_0x359832);}else pdf[_0x5806cc(0x15a)](_0x2b8821,_0x3c00d4)[_0x5806cc(0x189)](function(_0x582925,_0x31318b){const _0x256e42=_0x5806cc;if(_0x582925){_0x14f3f8[_0x256e42(0xd7)](0x1f4)[_0x256e42(0x16d)]('Error\x20generating\x20PDF');return;}_0x14f3f8[_0x256e42(0xf9)](_0x256e42(0x13e),_0x256e42(0xf2)),_0x31318b[_0x256e42(0x10c)](_0x14f3f8);});}),router['get']('/agent_reports/view',auth,async(_0x5b753a,_0x2ed46f)=>{const _0xc3a1ed=a0_0x485df5;try{const {username:_0x210462,email:_0x562bbc,role:_0x330ca3}=_0x5b753a['user'],_0x2b4118=_0x5b753a[_0xc3a1ed(0x128)],_0x393137=await profile['findOne']({'email':_0x2b4118[_0xc3a1ed(0xd5)]}),_0x3ad379={'year':_0xc3a1ed(0x1f2),'month':_0xc3a1ed(0x137),'day':_0xc3a1ed(0x1f2)},_0x56fdc0=await master_shop[_0xc3a1ed(0x164)](),_0x1bb783=await staff[_0xc3a1ed(0x18b)]({'email':_0x2b4118[_0xc3a1ed(0xd5)]}),_0x3665df=await product['find'](),_0x3c23fe=await warehouse[_0xc3a1ed(0xfe)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0xc3a1ed(0x14f),'foreignField':'name','as':_0xc3a1ed(0x1e3)}},{'$unwind':_0xc3a1ed(0x162)},{'$project':{'product_name':_0xc3a1ed(0x134),'product_stock':_0xc3a1ed(0x204)}},{'$group':{'_id':_0xc3a1ed(0x154),'product_stock':{'$sum':_0xc3a1ed(0x18c)}}}]);if(_0x56fdc0[0x0][_0xc3a1ed(0x1b1)]==_0xc3a1ed(0x133))var _0x3e017b=users['English'];else{if(_0x56fdc0[0x0][_0xc3a1ed(0x1b1)]==_0xc3a1ed(0xfd))var _0x3e017b=users[_0xc3a1ed(0xfd)];else{if(_0x56fdc0[0x0][_0xc3a1ed(0x1b1)]=='German')var _0x3e017b=users[_0xc3a1ed(0x20b)];else{if(_0x56fdc0[0x0][_0xc3a1ed(0x1b1)]==_0xc3a1ed(0x1fb))var _0x3e017b=users[_0xc3a1ed(0x1fb)];else{if(_0x56fdc0[0x0][_0xc3a1ed(0x1b1)]=='French')var _0x3e017b=users[_0xc3a1ed(0x130)];else{if(_0x56fdc0[0x0][_0xc3a1ed(0x1b1)]==_0xc3a1ed(0x15c))var _0x3e017b=users[_0xc3a1ed(0x1b0)];else{if(_0x56fdc0[0x0]['language']==_0xc3a1ed(0x19d))var _0x3e017b=users['Chinese'];else{if(_0x56fdc0[0x0][_0xc3a1ed(0x1b1)]==_0xc3a1ed(0x1bc))var _0x3e017b=users['Arabic'];}}}}}}}_0x2ed46f['render'](_0xc3a1ed(0x243),{'success':_0x5b753a[_0xc3a1ed(0x183)](_0xc3a1ed(0x185)),'errors':_0x5b753a[_0xc3a1ed(0x183)]('errors'),'alldata':_0x3665df,'profile':_0x393137,'master_shop':_0x56fdc0,'role':_0x2b4118,'product_stock':_0x3c23fe,'language':_0x3e017b,'staff_arr':_0x1bb783});}catch(_0x1239d5){}});function formatNumber(_0x6f2bd3,_0x2e6a5d=a0_0x485df5(0x24b),_0x4a11e5={'minimumFractionDigits':0x2}){const _0x25e316=a0_0x485df5,_0x5d9a1e=new Intl['NumberFormat'](_0x2e6a5d,_0x4a11e5);return _0x5d9a1e[_0x25e316(0x1c3)](_0x6f2bd3);}async function agentsdataDSICheck(_0x29170d,_0x448fea,_0x17dd7f,_0x5ebe95){const _0x241558=a0_0x485df5,_0x4004f2=await product[_0x241558(0xfe)]([{'$group':{'_id':{'brand':_0x241558(0x16a),'category':_0x241558(0x1dd)},'products':{'$push':{'name':'$name','product_code':_0x241558(0x13d)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x521d8c=[];_0x521d8c[_0x241558(0x22f)]=[];for(let _0x2eab4a=0x0;_0x2eab4a<=_0x4004f2[_0x241558(0x13c)]-0x1;_0x2eab4a++){const _0x306cef=_0x4004f2[_0x2eab4a];_0x521d8c['cat_brand'][_0x241558(0x124)](_0x306cef);}const _0x4f8175=await product[_0x241558(0xfe)]([{'$group':{'_id':{'category':_0x241558(0x1dd)},'products':{'$push':{'brand':_0x241558(0x16a),'product_code':_0x241558(0x13d),'product_name':_0x241558(0x1be)}}}},{'$sort':{'_id.category':-0x1}}]),_0x48dab4=await product[_0x241558(0xfe)]([{'$group':{'_id':{'category':_0x241558(0x1dd),'brand':_0x241558(0x16a)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x55efca=await sales_sa[_0x241558(0xfe)]([{'$match':{'date':{'$gte':_0x29170d,'$lte':_0x448fea},'sales_staff_id':_0x17dd7f,'sale_product.isFG':'false','status_data':_0x241558(0x1ac)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x241558(0x1ac)}},{'$lookup':{'from':_0x241558(0x111),'localField':_0x241558(0x132),'foreignField':_0x241558(0x1af),'as':_0x241558(0xe1)}},{'$unwind':_0x241558(0x228)},{'$group':{'_id':{'dsi':_0x241558(0x213),'date':_0x241558(0x176),'customer':'$customer'},'totalQty':{'$sum':_0x241558(0x11b)},'products':{'$push':{'qty':_0x241558(0x11b),'NetPrice':_0x241558(0x159),'discount':_0x241558(0x1c0),'adj_discount':_0x241558(0x1c2),'product_details':{'prod_name':_0x241558(0xe0),'product_code':_0x241558(0x1fd),'category':_0x241558(0xfa),'brand':_0x241558(0x170),'gross_price':_0x241558(0xff)}}}}},{'$unwind':_0x241558(0x13a)},{'$group':{'_id':{'dsi':_0x241558(0x1e7),'date':_0x241558(0x186),'customer':_0x241558(0x217),'category':_0x241558(0x1c1),'brand':_0x241558(0x1a8)},'totalQty':{'$sum':_0x241558(0xfb)},'totalGross':{'$sum':{'$multiply':[_0x241558(0xfb),_0x241558(0x14d)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x241558(0x150)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x241558(0x141)}}},{'$group':{'_id':{'dsi':_0x241558(0x1e7),'date':_0x241558(0x186),'customer':_0x241558(0x217)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x241558(0x206)},'discount':{'$sum':_0x241558(0x1f3)},'adj_discount':{'$sum':_0x241558(0xdb)},'products':{'$push':{'qty':_0x241558(0x101),'category':_0x241558(0x1b6),'brand':_0x241558(0x1bd),'product_details':_0x241558(0x156)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0xf9105b=[],_0x42381f={},_0x4b0487={},_0x1b7f65={};var _0x48cba5=0x0,_0x287fae=0x0,_0x445ad9=0x0,_0x5408e9=0x0,_0x4edef0=0x0;const _0x371674=0x6;for(let _0x3565b7=0x0;_0x3565b7<=_0x55efca[_0x241558(0x13c)]-0x1;_0x3565b7++){const _0x267e12=_0x55efca[_0x3565b7];let _0x1c101f=_0x241558(0x1c9);_0x1c101f+=_0x241558(0x1d1)+_0x267e12[_0x241558(0x17c)][_0x241558(0x129)]+_0x241558(0x1d4),_0x1c101f+=_0x241558(0x1d1)+_0x267e12[_0x241558(0x17c)][_0x241558(0x1d2)]+_0x241558(0x1d4),_0x1c101f+=_0x241558(0x1d1)+_0x267e12[_0x241558(0x17c)][_0x241558(0x171)]+_0x241558(0x1d4);let _0x44f35e={};var _0xb18304=0x0;for(let _0x5da775=0x0;_0x5da775<=_0x267e12[_0x241558(0x111)]['length']-0x1;_0x5da775++){const _0x5f2db8=_0x267e12[_0x241558(0x111)][_0x5da775];_0x44f35e[_0x5f2db8[_0x241558(0x169)]+'-'+_0x5f2db8[_0x241558(0x195)]]=_0x5f2db8[_0x241558(0x135)];const _0x147e43=_0x5f2db8[_0x241558(0x169)]+'-'+_0x5f2db8['category'];!_0x42381f[_0x147e43]&&(_0x42381f[_0x147e43]=0x0),!Array[_0x241558(0x105)](_0x1b7f65[_0x147e43])&&(_0x1b7f65[_0x147e43]=[]),!Array['isArray'](_0x1b7f65[_0x147e43])&&(_0x1b7f65[_0x147e43]=[]),_0x42381f[_0x147e43]+=_0x5f2db8[_0x241558(0x135)],_0x1b7f65[_0x147e43][_0x241558(0x124)](_0x5f2db8['qty']),_0xb18304++;}console[_0x241558(0xeb)](_0x267e12);for(let _0x44df9f=0x0;_0x44df9f<=_0x521d8c['cat_brand'][_0x241558(0x13c)]-0x1;_0x44df9f++){const _0x3e5550=_0x521d8c[_0x241558(0x22f)][_0x44df9f],_0x97327=_0x3e5550[_0x241558(0x17c)]['brand']+'-'+_0x3e5550[_0x241558(0x17c)][_0x241558(0x195)];_0x1c101f+=_0x241558(0x182)+(_0x44f35e[_0x97327]!==undefined?_0x44f35e[_0x97327][_0x241558(0xcf)](0x2):'')+_0x241558(0x1d4);}_0x445ad9=_0x267e12['discount']+_0x267e12[_0x241558(0x144)],_0x1c101f+=_0x241558(0xd2)+formatNumber(parseFloat(_0x267e12[_0x241558(0x1f8)],0x2)['toFixed'](0x2))+'</td>',_0x1c101f+=_0x241558(0xd2)+formatNumber(_0x267e12['totalGross'][_0x241558(0xcf)](0x2))+'</td>',_0x1c101f+=_0x241558(0xd2)+formatNumber(_0x445ad9)+_0x241558(0x1d4),_0x1c101f+=_0x241558(0xd2)+formatNumber(_0x267e12[_0x241558(0x1cf)][_0x241558(0xcf)](0x2))+_0x241558(0x1d4),_0x1c101f+=_0x241558(0x1dc),_0x48cba5+=parseFloat(_0x267e12['totalQty'][_0x241558(0xcf)](0x2)),_0x287fae+=parseFloat(_0x267e12[_0x241558(0x1cf)][_0x241558(0xcf)](0x2)),_0x5408e9+=_0x445ad9,_0x4edef0+=parseFloat(_0x267e12[_0x241558(0x1b9)][_0x241558(0xcf)](0x2));if(_0x3565b7==_0x55efca[_0x241558(0x13c)]-0x1){_0x1c101f+='<tr>',_0x1c101f+=_0x241558(0x216),_0x1c101f+='</td>';for(let _0x45c2da=0x0;_0x45c2da<=_0x521d8c[_0x241558(0x22f)][_0x241558(0x13c)]-0x1;_0x45c2da++){const _0x59085c=_0x521d8c[_0x241558(0x22f)][_0x45c2da],_0x2c35d4=_0x59085c['_id'][_0x241558(0x169)]+'-'+_0x59085c['_id']['category'];!_0x1b7f65[_0x2c35d4]&&(_0x1b7f65[_0x2c35d4]=[]);const _0xa7d514=_0x1b7f65[_0x2c35d4][_0x241558(0x17d)]((_0x1badc8,_0x522cc1)=>_0x1badc8+_0x522cc1,0x0);_0x1c101f+=_0x241558(0x1ad)+(_0xa7d514!==undefined?formatNumber(_0xa7d514['toFixed'](0x2)):'')+_0x241558(0x1ed),console[_0x241558(0xeb)](_0x1b7f65[_0x2c35d4][_0x241558(0x17d)]((_0x45509e,_0x46ed6e)=>_0x45509e+_0x46ed6e,0x0));}_0x1c101f+=_0x241558(0x178)+formatNumber(_0x48cba5[_0x241558(0xcf)](0x2))+_0x241558(0x1ed),_0x1c101f+=_0x241558(0x178)+formatNumber(_0x4edef0)+_0x241558(0x1ed),_0x1c101f+=_0x241558(0x178)+formatNumber(_0x5408e9)+'</b></td>',_0x1c101f+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x287fae)+_0x241558(0x1ed),_0x1c101f+=_0x241558(0x1dc);}_0xf9105b[_0x241558(0x124)](_0x1c101f);}function _0x3961ec(_0x5f316d,_0x14e707){const _0x2a318c=_0x241558,_0x4c1935=[];for(let _0x53efed=0x0;_0x53efed<=_0x5f316d[_0x2a318c(0x13c)]-0x1;_0x53efed+=_0x14e707){_0x4c1935[_0x2a318c(0x124)](_0x5f316d[_0x2a318c(0x184)](_0x53efed,_0x53efed+_0x14e707));}return _0x4c1935;}const _0x53f391=_0x3961ec(_0xf9105b,_0x371674);let _0x2e508d='';return _0x53f391[_0x241558(0x181)]((_0x1947e3,_0x584248)=>{const _0x4c3f6d=_0x241558;_0x584248>0x0&&(_0x2e508d+=_0x4c3f6d(0x232));_0x2e508d+=_0x4c3f6d(0x18f),_0x2e508d+=_0x4c3f6d(0x191),_0x2e508d+=_0x4c3f6d(0x1c9),_0x2e508d+=_0x4c3f6d(0x108),_0x2e508d+=_0x4c3f6d(0x1dc),_0x2e508d+=_0x4c3f6d(0x1c9),_0x2e508d+=_0x4c3f6d(0x1bb);for(let _0x5cfa3b=0x0;_0x5cfa3b<=_0x4f8175[_0x4c3f6d(0x13c)]-0x1;_0x5cfa3b++){const _0xdfe5e4=_0x4f8175[_0x5cfa3b];for(let _0x7bd74c=0x0;_0x7bd74c<_0x48dab4[_0x4c3f6d(0x13c)];_0x7bd74c++){const _0x1ab943=_0x48dab4[_0x7bd74c];_0x1ab943[_0x4c3f6d(0x17c)]===_0xdfe5e4['_id'][_0x4c3f6d(0x195)]&&(_0x2e508d+=_0x4c3f6d(0x1cd)+_0x1ab943[_0x4c3f6d(0xe9)]+'\x22\x20class=\x22cat_data\x22>'+_0xdfe5e4[_0x4c3f6d(0x17c)][_0x4c3f6d(0x195)]+_0x4c3f6d(0x1d4));}}_0x2e508d+=_0x4c3f6d(0x131),_0x2e508d+=_0x4c3f6d(0x1dc),_0x2e508d+=_0x4c3f6d(0x1c9),_0x2e508d+=_0x4c3f6d(0x210),_0x2e508d+=_0x4c3f6d(0x158),_0x2e508d+=_0x4c3f6d(0x1df);for(let _0x26b41d=0x0;_0x26b41d<=_0x4f8175['length']-0x1;_0x26b41d++){const _0x2f2240=_0x4f8175[_0x26b41d];for(let _0x4d8144=0x0;_0x4d8144<_0x521d8c['cat_brand']['length'];_0x4d8144++){const _0x39d92d=_0x521d8c[_0x4c3f6d(0x22f)][_0x4d8144];_0x39d92d[_0x4c3f6d(0x17c)][_0x4c3f6d(0x195)]===_0x2f2240[_0x4c3f6d(0x17c)][_0x4c3f6d(0x195)]&&(_0x2e508d+=_0x4c3f6d(0x19b)+_0x39d92d[_0x4c3f6d(0x17c)][_0x4c3f6d(0x169)]+_0x4c3f6d(0x1d4));}}_0x2e508d+=_0x4c3f6d(0x22e),_0x2e508d+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x2e508d+=_0x4c3f6d(0x1d7),_0x2e508d+=_0x4c3f6d(0x161),_0x2e508d+=_0x4c3f6d(0x1dc),_0x2e508d+=_0x4c3f6d(0x24d),_0x2e508d+='<tbody>',_0x1947e3[_0x4c3f6d(0x181)](_0x2eeb7a=>{_0x2e508d+=_0x2eeb7a;}),console['log'](_0x1b7f65),_0x2e508d+=_0x4c3f6d(0x10e),_0x2e508d+=_0x4c3f6d(0x21b);}),_0x2e508d;}function a0_0x3c97(_0xa8640d,_0x357de1){const _0x3052a0=a0_0x3052();return a0_0x3c97=function(_0x3c9781,_0x475b05){_0x3c9781=_0x3c9781-0xcb;let _0x5e9d8b=_0x3052a0[_0x3c9781];return _0x5e9d8b;},a0_0x3c97(_0xa8640d,_0x357de1);}async function agentsdataDSICheck_excel(_0x168056,_0x3896c4,_0x4c537d,_0x31b6b3){const _0x546047=a0_0x485df5,_0x3eb771=await product[_0x546047(0xfe)]([{'$group':{'_id':{'brand':_0x546047(0x16a),'category':_0x546047(0x1dd)},'products':{'$push':{'name':'$name','product_code':_0x546047(0x13d)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2de735=[];_0x2de735[_0x546047(0x22f)]=[];for(let _0x1112f5=0x0;_0x1112f5<=_0x3eb771[_0x546047(0x13c)]-0x1;_0x1112f5++){const _0x6e23c=_0x3eb771[_0x1112f5];_0x2de735[_0x546047(0x22f)][_0x546047(0x124)](_0x6e23c);}const _0x483837=await product[_0x546047(0xfe)]([{'$group':{'_id':{'category':_0x546047(0x1dd)},'products':{'$push':{'brand':_0x546047(0x16a),'product_code':_0x546047(0x13d),'product_name':_0x546047(0x1be)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4279ac=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0x546047(0x16a)}}},{'$group':{'_id':_0x546047(0x1b6),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x575382=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x168056,'$lte':_0x3896c4},'sales_staff_id':_0x4c537d,'sale_product.isFG':_0x546047(0x1ac)}},{'$unwind':_0x546047(0x1b5)},{'$match':{'sale_product.isFG':_0x546047(0x1ac)}},{'$lookup':{'from':'products','localField':_0x546047(0x132),'foreignField':_0x546047(0x1af),'as':_0x546047(0xe1)}},{'$unwind':_0x546047(0x228)},{'$group':{'_id':{'dsi':'$dsi','date':_0x546047(0x176),'customer':_0x546047(0x235)},'totalQty':{'$sum':_0x546047(0x11b)},'products':{'$push':{'qty':_0x546047(0x11b),'NetPrice':_0x546047(0x159),'discount':_0x546047(0x1c0),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x546047(0xe0),'product_code':_0x546047(0x1fd),'category':_0x546047(0xfa),'brand':_0x546047(0x170),'gross_price':_0x546047(0xff)}}}}},{'$unwind':_0x546047(0x13a)},{'$group':{'_id':{'dsi':_0x546047(0x1e7),'date':_0x546047(0x186),'customer':_0x546047(0x217),'category':_0x546047(0x1c1),'brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x546047(0x245)},'discount':{'$sum':_0x546047(0x150)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x546047(0x141)}}},{'$group':{'_id':{'dsi':_0x546047(0x1e7),'date':_0x546047(0x186),'customer':_0x546047(0x217)},'totalQty':{'$sum':_0x546047(0x101)},'totalGross':{'$sum':_0x546047(0x24a)},'NetPrice':{'$sum':_0x546047(0x206)},'discount':{'$sum':_0x546047(0x1f3)},'adj_discount':{'$sum':_0x546047(0xdb)},'products':{'$push':{'qty':_0x546047(0x101),'category':'$_id.category','brand':_0x546047(0x1bd),'product_details':_0x546047(0x156)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x14d0c1=[],_0x2e5957={},_0x43835e={},_0xbc4e43={};var _0x43c1ee=0x0,_0x5e0679=0x0,_0x17f32c=0x0,_0x45bccd=0x0,_0x154313=0x0;const _0x4ad822=0x9184e72a000;for(let _0x1f2542=0x0;_0x1f2542<=_0x575382[_0x546047(0x13c)]-0x1;_0x1f2542++){const _0x4e5bfe=_0x575382[_0x1f2542];let _0x43d009='<tr>';_0x43d009+=_0x546047(0x1d1)+_0x4e5bfe[_0x546047(0x17c)][_0x546047(0x129)]+_0x546047(0x1d4),_0x43d009+=_0x546047(0x1d1)+_0x4e5bfe['_id'][_0x546047(0x1d2)]+_0x546047(0x1d4),_0x43d009+=_0x546047(0x1d1)+_0x4e5bfe[_0x546047(0x17c)][_0x546047(0x171)]+_0x546047(0x1d4);let _0x4409a8={};var _0x1ea9aa=0x0;for(let _0x23e12a=0x0;_0x23e12a<=_0x4e5bfe[_0x546047(0x111)][_0x546047(0x13c)]-0x1;_0x23e12a++){const _0x50743f=_0x4e5bfe[_0x546047(0x111)][_0x23e12a];_0x4409a8[_0x50743f[_0x546047(0x169)]+'-'+_0x50743f[_0x546047(0x195)]]=_0x50743f['qty'];const _0x5b8b48=_0x50743f[_0x546047(0x169)]+'-'+_0x50743f[_0x546047(0x195)];!_0x2e5957[_0x5b8b48]&&(_0x2e5957[_0x5b8b48]=0x0),!Array[_0x546047(0x105)](_0xbc4e43[_0x5b8b48])&&(_0xbc4e43[_0x5b8b48]=[]),!Array[_0x546047(0x105)](_0xbc4e43[_0x5b8b48])&&(_0xbc4e43[_0x5b8b48]=[]),_0x2e5957[_0x5b8b48]+=_0x50743f[_0x546047(0x135)],_0xbc4e43[_0x5b8b48]['push'](_0x50743f[_0x546047(0x135)]),_0x1ea9aa++;}console['log'](_0x4e5bfe);for(let _0x1b4a5c=0x0;_0x1b4a5c<=_0x2de735['cat_brand'][_0x546047(0x13c)]-0x1;_0x1b4a5c++){const _0x40898d=_0x2de735[_0x546047(0x22f)][_0x1b4a5c],_0x23ab03=_0x40898d[_0x546047(0x17c)][_0x546047(0x169)]+'-'+_0x40898d[_0x546047(0x17c)][_0x546047(0x195)];_0x43d009+=_0x546047(0x182)+(_0x4409a8[_0x23ab03]!==undefined?_0x4409a8[_0x23ab03]['toFixed'](0x2):'')+_0x546047(0x1d4);}_0x17f32c=_0x4e5bfe[_0x546047(0x1a4)]+_0x4e5bfe[_0x546047(0x144)],_0x43d009+=_0x546047(0xd2)+formatNumber(parseFloat(_0x4e5bfe[_0x546047(0x1f8)],0x2)[_0x546047(0xcf)](0x2))+_0x546047(0x1d4),_0x43d009+=_0x546047(0xd2)+formatNumber(_0x4e5bfe[_0x546047(0x1b9)][_0x546047(0xcf)](0x2))+'</td>',_0x43d009+=_0x546047(0xd2)+formatNumber(_0x17f32c)+_0x546047(0x1d4),_0x43d009+=_0x546047(0xd2)+formatNumber(_0x4e5bfe[_0x546047(0x1cf)]['toFixed'](0x2))+_0x546047(0x1d4),_0x43d009+=_0x546047(0x1dc),_0x43c1ee+=parseFloat(_0x4e5bfe[_0x546047(0x1f8)]['toFixed'](0x2)),_0x5e0679+=parseFloat(_0x4e5bfe['NetPrice'][_0x546047(0xcf)](0x2)),_0x45bccd+=_0x17f32c,_0x154313+=parseFloat(_0x4e5bfe['totalGross'][_0x546047(0xcf)](0x2));if(_0x1f2542==_0x575382['length']-0x1){_0x43d009+=_0x546047(0x1c9),_0x43d009+=_0x546047(0x216),_0x43d009+=_0x546047(0x1d4);for(let _0x25e130=0x0;_0x25e130<=_0x2de735[_0x546047(0x22f)][_0x546047(0x13c)]-0x1;_0x25e130++){const _0x6fc0dc=_0x2de735[_0x546047(0x22f)][_0x25e130],_0x6a9795=_0x6fc0dc[_0x546047(0x17c)][_0x546047(0x169)]+'-'+_0x6fc0dc[_0x546047(0x17c)][_0x546047(0x195)];!_0xbc4e43[_0x6a9795]&&(_0xbc4e43[_0x6a9795]=[]);const _0x53d875=_0xbc4e43[_0x6a9795][_0x546047(0x17d)]((_0x2177cb,_0x35f984)=>_0x2177cb+_0x35f984,0x0);_0x43d009+=_0x546047(0x1ad)+(_0x53d875!==undefined?formatNumber(_0x53d875['toFixed'](0x2)):'')+_0x546047(0x1ed),console[_0x546047(0xeb)](_0xbc4e43[_0x6a9795][_0x546047(0x17d)]((_0x4f99f3,_0x2752f1)=>_0x4f99f3+_0x2752f1,0x0));}_0x43d009+=_0x546047(0x178)+formatNumber(_0x43c1ee[_0x546047(0xcf)](0x2))+'</b></td>',_0x43d009+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x154313)+_0x546047(0x1ed),_0x43d009+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x45bccd)+_0x546047(0x1ed),_0x43d009+=_0x546047(0x178)+formatNumber(_0x5e0679)+_0x546047(0x1ed),_0x43d009+=_0x546047(0x1dc);}_0x14d0c1['push'](_0x43d009);}function _0x1d1b71(_0x54ba30,_0x5796b3){const _0x2aa034=_0x546047,_0x51a769=[];for(let _0x3bf3db=0x0;_0x3bf3db<=_0x54ba30['length']-0x1;_0x3bf3db+=_0x5796b3){_0x51a769['push'](_0x54ba30[_0x2aa034(0x184)](_0x3bf3db,_0x3bf3db+_0x5796b3));}return _0x51a769;}const _0x91b160=_0x1d1b71(_0x14d0c1,_0x4ad822);let _0x58b93d='';return _0x91b160[_0x546047(0x181)]((_0x1679d2,_0x266ad8)=>{const _0x93d9f=_0x546047;_0x266ad8>0x0&&(_0x58b93d+=_0x93d9f(0x232));_0x58b93d+=_0x93d9f(0x18f),_0x58b93d+=_0x93d9f(0x191),_0x58b93d+=_0x93d9f(0x1c9),_0x58b93d+=_0x93d9f(0x108),_0x58b93d+=_0x93d9f(0x1dc),_0x58b93d+=_0x93d9f(0x1c9),_0x58b93d+=_0x93d9f(0x1bb);for(let _0x2a2384=0x0;_0x2a2384<=_0x483837[_0x93d9f(0x13c)]-0x1;_0x2a2384++){const _0x3dc47e=_0x483837[_0x2a2384];for(let _0x14b616=0x0;_0x14b616<_0x4279ac[_0x93d9f(0x13c)];_0x14b616++){const _0x219f53=_0x4279ac[_0x14b616];_0x219f53[_0x93d9f(0x17c)]===_0x3dc47e[_0x93d9f(0x17c)][_0x93d9f(0x195)]&&(_0x58b93d+=_0x93d9f(0x1cd)+_0x219f53[_0x93d9f(0xe9)]+_0x93d9f(0x18e)+_0x3dc47e['_id'][_0x93d9f(0x195)]+_0x93d9f(0x1d4));}}_0x58b93d+=_0x93d9f(0x131),_0x58b93d+=_0x93d9f(0x1dc),_0x58b93d+='<tr>',_0x58b93d+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x58b93d+=_0x93d9f(0x158),_0x58b93d+=_0x93d9f(0x1df);for(let _0x21baa8=0x0;_0x21baa8<=_0x483837[_0x93d9f(0x13c)]-0x1;_0x21baa8++){const _0x3909c9=_0x483837[_0x21baa8];for(let _0x5d0419=0x0;_0x5d0419<_0x2de735[_0x93d9f(0x22f)][_0x93d9f(0x13c)];_0x5d0419++){const _0x107b64=_0x2de735[_0x93d9f(0x22f)][_0x5d0419];_0x107b64['_id'][_0x93d9f(0x195)]===_0x3909c9[_0x93d9f(0x17c)][_0x93d9f(0x195)]&&(_0x58b93d+=_0x93d9f(0x19b)+_0x107b64[_0x93d9f(0x17c)][_0x93d9f(0x169)]+_0x93d9f(0x1d4));}}_0x58b93d+=_0x93d9f(0x22e),_0x58b93d+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x58b93d+=_0x93d9f(0x1d7),_0x58b93d+=_0x93d9f(0x161),_0x58b93d+='</tr>',_0x58b93d+=_0x93d9f(0x24d),_0x58b93d+=_0x93d9f(0xd8),_0x1679d2[_0x93d9f(0x181)](_0x2f844d=>{_0x58b93d+=_0x2f844d;}),console[_0x93d9f(0xeb)](_0xbc4e43),_0x58b93d+=_0x93d9f(0x10e),_0x58b93d+=_0x93d9f(0x21b);}),_0x58b93d;}router[a0_0x485df5(0x244)](a0_0x485df5(0x180),auth,async(_0xb6a8c8,_0x111f36)=>{const _0x34e466=a0_0x485df5,{from_date:_0x2fefb9,to_date:_0x65e00b,isExcel:_0x25ede0}=_0xb6a8c8[_0x34e466(0x18a)],_0x4bb5be=_0xb6a8c8['user'],_0x3dac8c=await staff[_0x34e466(0x18b)]({'email':_0x4bb5be['email']}),_0x47de7f=await master_shop['find'](),_0x1a8d55=await agentsdataDSICheck(_0x2fefb9,_0x65e00b,_0x3dac8c[_0x34e466(0x17c)]['valueOf'](),_0x25ede0),_0x4ccf97=await agentsdataDSICheck_excel(_0x2fefb9,_0x65e00b,_0x3dac8c[_0x34e466(0x17c)][_0x34e466(0x227)](),_0x25ede0);let _0x3406c7=_0x34e466(0xde);var _0x5ea7cd=new Date(_0x2fefb9),_0x2aacb5=new Date(_0x65e00b);const _0x15dd7d={'year':_0x34e466(0x1f2),'month':_0x34e466(0x137),'day':_0x34e466(0x1f2)},_0x260fa5=new Intl['DateTimeFormat'](_0x34e466(0x24b),_0x15dd7d)['format'](_0x5ea7cd),_0x5c7e63=new Intl[(_0x34e466(0x11a))]('en-US',_0x15dd7d)[_0x34e466(0x1c3)](_0x2aacb5);_0x3406c7+=_0x34e466(0x1cb),_0x3406c7+=_0x34e466(0xee),_0x3406c7+=_0x34e466(0x18f),_0x3406c7+=_0x1a8d55,_0x3406c7+=_0x34e466(0x21b),_0x3406c7+=_0x34e466(0x11d),_0x3406c7+=_0x34e466(0x11d);let _0x1be25a='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x1be25a+=_0x34e466(0x1cb),_0x1be25a+='<div\x20\x20id=\x22table-conatainer\x22>',_0x1be25a+='<table>',_0x1be25a+=_0x4ccf97,_0x1be25a+=_0x34e466(0x21b),_0x1be25a+=_0x34e466(0x11d),_0x1be25a+=_0x34e466(0x11d);let _0x3d8220=_0x34e466(0x215);const _0x2b982b={'width':'15in','height':_0x34e466(0x211),'orientation':_0x34e466(0x1ea),'border':{'top':_0x34e466(0x117),'right':'0.1in','bottom':'0.1in','left':_0x34e466(0x117)},'header':{'height':'60mm','contents':_0x34e466(0x1ef)+_0x3d8220+_0x34e466(0x233)+_0x260fa5+_0x34e466(0x1a1)+_0x5c7e63+_0x34e466(0x113)},'footer':{'height':_0x34e466(0x187),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x34e466(0x127)}}};if(_0x25ede0=='on'){const _0x1ac99b=cheerio[_0x34e466(0x146)](_0x1be25a);let _0x22a76d=[],_0x332e6f=[],_0x1e711a=[];const _0xa263d8=_0x2c0198=>{const _0x439773=_0x34e466,_0x501187={'top':{'style':_0x439773(0xd4),'color':{'rgb':_0x439773(0x1de)}},'bottom':{'style':_0x439773(0xd4),'color':{'rgb':'000000'}},'left':{'style':_0x439773(0xd4),'color':{'rgb':_0x439773(0x1de)}},'right':{'style':_0x439773(0xd4),'color':{'rgb':'000000'}}};if(_0x2c0198){const _0x1ee751=_0x2c0198['split'](';')['reduce']((_0x156c81,_0x3323fc)=>{const _0x5716fb=_0x439773,[_0x210324,_0x332c05]=_0x3323fc[_0x5716fb(0x1e0)](':')[_0x5716fb(0x110)](_0x5c73c3=>_0x5c73c3[_0x5716fb(0x175)]());return _0x156c81[_0x210324]=_0x332c05,_0x156c81;},{});_0x1ee751['border-top']&&(_0x501187['top']['style']=_0x1ee751[_0x439773(0x1e5)]['includes'](_0x439773(0x237))?'thin':_0x439773(0x21e)),_0x1ee751[_0x439773(0x14c)]&&(_0x501187[_0x439773(0x207)][_0x439773(0xe4)]=_0x1ee751[_0x439773(0x14c)][_0x439773(0x115)]('thin')?_0x439773(0x237):'medium'),_0x1ee751['border-left']&&(_0x501187[_0x439773(0x223)]['style']=_0x1ee751[_0x439773(0x102)][_0x439773(0x115)](_0x439773(0x237))?'thin':_0x439773(0x21e)),_0x1ee751[_0x439773(0x19f)]&&(_0x501187['right']['style']=_0x1ee751[_0x439773(0x19f)]['includes'](_0x439773(0x237))?_0x439773(0x237):_0x439773(0x21e));}return _0x501187;};_0x1ac99b(_0x34e466(0x16f))[_0x34e466(0x142)]((_0x4c59c7,_0x44e18d)=>{const _0x50d2e1=_0x34e466;let _0x5e3e62=[],_0x16b4e9=0x0;while(_0x1e711a[_0x16b4e9]){_0x1e711a[_0x16b4e9]--,_0x16b4e9++;}_0x1ac99b(_0x44e18d)[_0x50d2e1(0x164)](_0x50d2e1(0xe5))[_0x50d2e1(0x142)]((_0x4a4cb4,_0x5ab204)=>{const _0x1aac35=_0x50d2e1;let _0x211c60=_0x1ac99b(_0x5ab204)['text']()[_0x1aac35(0x175)](),_0x1eea0b=parseFloat(_0x211c60[_0x1aac35(0x23c)](/,/g,'')),_0x5a5621={};!isNaN(_0x1eea0b)?(_0x5a5621['v']=_0x1eea0b,_0x5a5621['t']='n'):(_0x5a5621['v']=_0x211c60,_0x5a5621['t']='s');const _0x1f7582=_0x1ac99b(_0x5ab204)['attr'](_0x1aac35(0xe4)),_0x2dae49=_0xa263d8(_0x1f7582);_0x5a5621['s']={'border':_0x2dae49},_0x5e3e62[_0x16b4e9]=_0x5a5621;let _0x111f81=parseInt(_0x1ac99b(_0x5ab204)['attr'](_0x1aac35(0xd3)))||0x1,_0x4ca1fe=parseInt(_0x1ac99b(_0x5ab204)['attr'](_0x1aac35(0xf1)))||0x1;(_0x111f81>0x1||_0x4ca1fe>0x1)&&_0x332e6f[_0x1aac35(0x124)]({'s':{'r':_0x4c59c7,'c':_0x16b4e9},'e':{'r':_0x4c59c7+_0x4ca1fe-0x1,'c':_0x16b4e9+_0x111f81-0x1}});for(let _0x1322be=0x0;_0x1322be<_0x111f81;_0x1322be++){_0x4ca1fe>0x1&&(_0x1e711a[_0x16b4e9+_0x1322be]=_0x4ca1fe-0x1);}_0x16b4e9+=_0x111f81;}),_0x22a76d[_0x50d2e1(0x124)](_0x5e3e62);});const _0x37e6e3=XLSX[_0x34e466(0x1d6)]['book_new'](),_0x5639d8=XLSX[_0x34e466(0x1d6)]['aoa_to_sheet'](_0x22a76d);_0x332e6f['length']>0x0&&(_0x5639d8[_0x34e466(0x1ab)]=_0x332e6f);_0x5639d8[_0x34e466(0x231)]=_0x22a76d[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x34e466(0x1d6)][_0x34e466(0x125)](_0x37e6e3,_0x5639d8,'Sales\x20Report');const _0xddae6d=XLSX['write'](_0x37e6e3,{'bookType':_0x34e466(0x121),'type':_0x34e466(0x18d)});_0x111f36[_0x34e466(0xf9)](_0x34e466(0xf3),_0x34e466(0x140)),_0x111f36[_0x34e466(0xf9)]('Content-Type',_0x34e466(0x21d)),_0x111f36[_0x34e466(0x16d)](_0xddae6d);}else pdf[_0x34e466(0x15a)](_0x3406c7,_0x2b982b)[_0x34e466(0x189)](function(_0x593532,_0x269aa7){const _0x3eb7e2=_0x34e466;if(_0x593532){console[_0x3eb7e2(0x220)](_0x3eb7e2(0x201),_0x593532),_0x111f36[_0x3eb7e2(0xd7)](0x1f4)[_0x3eb7e2(0x16d)](_0x3eb7e2(0x20c)+_0x593532);return;}_0x111f36[_0x3eb7e2(0xf9)](_0x3eb7e2(0x13e),_0x3eb7e2(0xf2)),_0x269aa7[_0x3eb7e2(0x10c)](_0x111f36);});}),router[a0_0x485df5(0x145)](a0_0x485df5(0xf5),auth,async(_0x12f74c,_0x17d902)=>{const _0x13ad3a=a0_0x485df5;try{const {username:_0x173ec0,email:_0x440cc6,role:_0x4637c9}=_0x12f74c[_0x13ad3a(0x128)],_0x379c70=_0x12f74c['user'],_0x3e5def=await profile['findOne']({'email':_0x379c70[_0x13ad3a(0xd5)]}),_0x299a25={'year':_0x13ad3a(0x1f2),'month':_0x13ad3a(0x137),'day':_0x13ad3a(0x1f2)},_0x576c8f=await master_shop['find'](),_0xe81ee3=await product['find'](),_0xb965ac=await warehouse[_0x13ad3a(0xfe)]([{'$unwind':_0x13ad3a(0x156)},{'$lookup':{'from':'products','localField':_0x13ad3a(0x14f),'foreignField':_0x13ad3a(0x248),'as':_0x13ad3a(0x1e3)}},{'$unwind':_0x13ad3a(0x162)},{'$project':{'product_name':_0x13ad3a(0x134),'product_stock':_0x13ad3a(0x204)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x13ad3a(0x18c)}}}]),_0x228f02=await staff[_0x13ad3a(0x18b)]({'email':_0x379c70[_0x13ad3a(0xd5)]});if(_0x576c8f[0x0][_0x13ad3a(0x1b1)]==_0x13ad3a(0x133))var _0x20422a=users[_0x13ad3a(0x165)];else{if(_0x576c8f[0x0][_0x13ad3a(0x1b1)]==_0x13ad3a(0xfd))var _0x20422a=users[_0x13ad3a(0xfd)];else{if(_0x576c8f[0x0][_0x13ad3a(0x1b1)]==_0x13ad3a(0x20b))var _0x20422a=users[_0x13ad3a(0x20b)];else{if(_0x576c8f[0x0][_0x13ad3a(0x1b1)]==_0x13ad3a(0x1fb))var _0x20422a=users[_0x13ad3a(0x1fb)];else{if(_0x576c8f[0x0][_0x13ad3a(0x1b1)]=='French')var _0x20422a=users['French'];else{if(_0x576c8f[0x0][_0x13ad3a(0x1b1)]==_0x13ad3a(0x15c))var _0x20422a=users[_0x13ad3a(0x1b0)];else{if(_0x576c8f[0x0][_0x13ad3a(0x1b1)]==_0x13ad3a(0x19d))var _0x20422a=users[_0x13ad3a(0x19d)];else{if(_0x576c8f[0x0][_0x13ad3a(0x1b1)]==_0x13ad3a(0x1bc))var _0x20422a=users['Arabic'];}}}}}}}_0x17d902[_0x13ad3a(0x1cc)](_0x13ad3a(0x197),{'success':_0x12f74c[_0x13ad3a(0x183)]('success'),'errors':_0x12f74c[_0x13ad3a(0x183)](_0x13ad3a(0x1d5)),'alldata':_0xe81ee3,'profile':_0x3e5def,'master_shop':_0x576c8f,'role':_0x379c70,'product_stock':_0xb965ac,'language':_0x20422a,'staff_arr':_0x228f02});}catch(_0x157d52){}});async function dataSalesReports(_0x1d6c77,_0x44b617,_0x59a5d3){const _0x43b689=a0_0x485df5;let _0x1de3e1='';const _0xd3ba05=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x1d6c77,'$lte':_0x44b617},'sales_staff_id':_0x59a5d3}},{'$unwind':_0x43b689(0x1b5)},{'$match':{'sale_product.isFG':_0x43b689(0x1ac)}},{'$group':{'_id':{'product_name':_0x43b689(0x20f),'product_code':_0x43b689(0x15b)},'sumqty':{'$sum':_0x43b689(0x11b)},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x338cea=0x0,_0x2601da=0x0;for(let _0x374154=0x0;_0x374154<=_0xd3ba05['length']-0x1;_0x374154++){const _0x45b042=_0xd3ba05[_0x374154];var _0x4da8de=_0x45b042[_0x43b689(0x240)][_0x43b689(0xdf)](undefined),_0x168454=_0x45b042[_0x43b689(0xe7)][_0x43b689(0xdf)](undefined);_0x1de3e1+='<tr>',_0x1de3e1+=_0x43b689(0x23d)+_0x45b042['_id'][_0x43b689(0x1af)]+_0x43b689(0x1d4),_0x1de3e1+='<td\x20class=\x22row_data\x22>'+_0x45b042[_0x43b689(0x17c)][_0x43b689(0x143)]+_0x43b689(0x1d4),_0x1de3e1+=_0x43b689(0x23d)+formatNumber(_0x45b042[_0x43b689(0xe7)][_0x43b689(0xcf)](0x2))+'</td>',_0x1de3e1+=_0x43b689(0x23d)+formatNumber(_0x45b042[_0x43b689(0x240)][_0x43b689(0xcf)](0x2))+'</td>',_0x1de3e1+=_0x43b689(0x1dc),_0x338cea+=parseFloat(_0x45b042['sumqty']),_0x2601da+=parseFloat(_0x45b042['totalPrice']);}var _0xb30130=_0x2601da[_0x43b689(0xdf)](undefined),_0x551d2f=_0x338cea['toLocaleString'](undefined);return _0x1de3e1+='<tr>',_0x1de3e1+=_0x43b689(0x198),_0x1de3e1+=_0x43b689(0x13b)+formatNumber(_0x338cea['toFixed'](0x2))+_0x43b689(0x1ed),_0x1de3e1+=_0x43b689(0x13b)+formatNumber(_0x2601da[_0x43b689(0xcf)](0x2))+_0x43b689(0x1ed),_0x1de3e1+=_0x43b689(0x1dc),_0x1de3e1;}router['post'](a0_0x485df5(0x238),auth,async(_0x8f94fa,_0x592d60)=>{const _0x378ee4=a0_0x485df5;try{const {from_date:_0x4d254f,to_date:_0x318568,isExcel:_0x3b0f40}=_0x8f94fa[_0x378ee4(0x18a)],_0x4ce226=_0x8f94fa[_0x378ee4(0x128)],_0x180dcc=await staff['findOne']({'email':_0x4ce226[_0x378ee4(0xd5)]});let _0x22d2ef=_0x378ee4(0x172);var _0x3ff8d1=new Date(_0x4d254f),_0x39dca2=new Date(_0x318568);const _0x50fcb7={'year':_0x378ee4(0x1f2),'month':_0x378ee4(0x137),'day':_0x378ee4(0x1f2)},_0x3b2780=new Intl[(_0x378ee4(0x11a))]('en-US',_0x50fcb7)[_0x378ee4(0x1c3)](_0x3ff8d1),_0x5864b7=new Intl['DateTimeFormat'](_0x378ee4(0x24b),_0x50fcb7)['format'](_0x39dca2);var _0x3f31e3=await dataSalesReports(_0x4d254f,_0x318568,_0x180dcc[_0x378ee4(0x17c)][_0x378ee4(0x227)]());_0x22d2ef+=_0x378ee4(0x1cb),_0x22d2ef+='<div\x20class=\x22col-sm-11\x22>',_0x22d2ef+=_0x378ee4(0x18f),_0x22d2ef+=_0x378ee4(0x1c9),_0x22d2ef+=_0x378ee4(0x15e),_0x22d2ef+=_0x378ee4(0x234),_0x22d2ef+=_0x378ee4(0x149),_0x22d2ef+='<th>\x20INVOICE\x20AMOUNT\x20</th>',_0x22d2ef+=_0x378ee4(0x1c9),_0x22d2ef+=_0x3f31e3,_0x22d2ef+=_0x378ee4(0x1dc),_0x22d2ef+=_0x378ee4(0x11d),_0x22d2ef+=_0x378ee4(0x11d);let _0x2b1193='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x4e740c={'width':_0x378ee4(0x10b),'height':'8.5in','orientation':_0x378ee4(0x1ea),'border':{'top':_0x378ee4(0x117),'right':_0x378ee4(0x117),'bottom':'0.1in','left':_0x378ee4(0x117)},'header':{'height':_0x378ee4(0x22b),'contents':_0x378ee4(0x1ef)+_0x2b1193+_0x378ee4(0x11f)+_0x180dcc['name']+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x3b2780+_0x378ee4(0x1a1)+_0x5864b7+_0x378ee4(0x113)},'footer':{'height':_0x378ee4(0x187),'contents':{'default':_0x378ee4(0x163)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x378ee4(0x127)}}};if(_0x3b0f40=='on'){const _0x5a2c14=cheerio['load'](_0x22d2ef);let _0x32e9b6=[],_0x298479=[],_0x1a18c9=[];const _0x382ed2=_0x10fe56=>{const _0x111ed1=_0x378ee4,_0x1bd886={'top':{'style':_0x111ed1(0xd4),'color':{'rgb':_0x111ed1(0x1de)}},'bottom':{'style':_0x111ed1(0xd4),'color':{'rgb':_0x111ed1(0x1de)}},'left':{'style':_0x111ed1(0xd4),'color':{'rgb':'000000'}},'right':{'style':_0x111ed1(0xd4),'color':{'rgb':_0x111ed1(0x1de)}}};if(_0x10fe56){const _0x497fa0=_0x10fe56['split'](';')['reduce']((_0x35c702,_0x4bc4e2)=>{const _0x27820d=_0x111ed1,[_0x5cd553,_0x33734c]=_0x4bc4e2['split'](':')['map'](_0x68f91d=>_0x68f91d[_0x27820d(0x175)]());return _0x35c702[_0x5cd553]=_0x33734c,_0x35c702;},{});_0x497fa0[_0x111ed1(0x1e5)]&&(_0x1bd886[_0x111ed1(0x21a)][_0x111ed1(0xe4)]=_0x497fa0[_0x111ed1(0x1e5)][_0x111ed1(0x115)](_0x111ed1(0x237))?_0x111ed1(0x237):_0x111ed1(0x21e)),_0x497fa0[_0x111ed1(0x14c)]&&(_0x1bd886['bottom'][_0x111ed1(0xe4)]=_0x497fa0['border-bottom']['includes']('thin')?_0x111ed1(0x237):'medium'),_0x497fa0[_0x111ed1(0x102)]&&(_0x1bd886[_0x111ed1(0x223)][_0x111ed1(0xe4)]=_0x497fa0[_0x111ed1(0x102)]['includes'](_0x111ed1(0x237))?'thin':_0x111ed1(0x21e)),_0x497fa0[_0x111ed1(0x19f)]&&(_0x1bd886[_0x111ed1(0x24e)][_0x111ed1(0xe4)]=_0x497fa0[_0x111ed1(0x19f)][_0x111ed1(0x115)](_0x111ed1(0x237))?_0x111ed1(0x237):'medium');}return _0x1bd886;};_0x5a2c14(_0x378ee4(0x16f))[_0x378ee4(0x142)]((_0x9ca556,_0x18fd06)=>{const _0x344b38=_0x378ee4;let _0x3cde95=[],_0x221906=0x0;while(_0x1a18c9[_0x221906]){_0x1a18c9[_0x221906]--,_0x221906++;}_0x5a2c14(_0x18fd06)['find'](_0x344b38(0xe5))[_0x344b38(0x142)]((_0x1d52ae,_0x54384c)=>{const _0x2ad41d=_0x344b38;let _0x59d3df=_0x5a2c14(_0x54384c)[_0x2ad41d(0x12a)]()[_0x2ad41d(0x175)](),_0x4c9cb6=parseFloat(_0x59d3df[_0x2ad41d(0x23c)](/,/g,'')),_0x1729d8={};!isNaN(_0x4c9cb6)?(_0x1729d8['v']=_0x4c9cb6,_0x1729d8['t']='n'):(_0x1729d8['v']=_0x59d3df,_0x1729d8['t']='s');const _0x1f1ad4=_0x5a2c14(_0x54384c)[_0x2ad41d(0x166)](_0x2ad41d(0xe4)),_0x131841=_0x382ed2(_0x1f1ad4);_0x1729d8['s']={'border':_0x131841},_0x3cde95[_0x221906]=_0x1729d8;let _0x44e982=parseInt(_0x5a2c14(_0x54384c)[_0x2ad41d(0x166)](_0x2ad41d(0xd3)))||0x1,_0x49287d=parseInt(_0x5a2c14(_0x54384c)[_0x2ad41d(0x166)](_0x2ad41d(0xf1)))||0x1;(_0x44e982>0x1||_0x49287d>0x1)&&_0x298479[_0x2ad41d(0x124)]({'s':{'r':_0x9ca556,'c':_0x221906},'e':{'r':_0x9ca556+_0x49287d-0x1,'c':_0x221906+_0x44e982-0x1}});for(let _0x273ef6=0x0;_0x273ef6<_0x44e982;_0x273ef6++){_0x49287d>0x1&&(_0x1a18c9[_0x221906+_0x273ef6]=_0x49287d-0x1);}_0x221906+=_0x44e982;}),_0x32e9b6[_0x344b38(0x124)](_0x3cde95);});const _0x43057d=XLSX[_0x378ee4(0x1d6)][_0x378ee4(0xcd)](),_0x2932cc=XLSX[_0x378ee4(0x1d6)][_0x378ee4(0x148)](_0x32e9b6);_0x298479[_0x378ee4(0x13c)]>0x0&&(_0x2932cc['!merges']=_0x298479);_0x2932cc[_0x378ee4(0x231)]=_0x32e9b6[0x0][_0x378ee4(0x110)](()=>({'wpx':0x64})),XLSX[_0x378ee4(0x1d6)][_0x378ee4(0x125)](_0x43057d,_0x2932cc,'Sales\x20Report');const _0x309969=XLSX['write'](_0x43057d,{'bookType':_0x378ee4(0x121),'type':_0x378ee4(0x18d)});_0x592d60['setHeader'](_0x378ee4(0xf3),_0x378ee4(0x140)),_0x592d60[_0x378ee4(0xf9)]('Content-Type',_0x378ee4(0x21d)),_0x592d60['send'](_0x309969);}else pdf['create'](_0x22d2ef,_0x4e740c)[_0x378ee4(0x189)](function(_0x4f4124,_0xbf14b2){const _0x378034=_0x378ee4;if(_0x4f4124){_0x592d60[_0x378034(0xd7)](0x1f4)[_0x378034(0x16d)](_0x378034(0x20c));return;}_0x592d60['setHeader'](_0x378034(0x13e),_0x378034(0xf2)),_0xbf14b2[_0x378034(0x10c)](_0x592d60);});}catch(_0x156620){}}),router['get'](a0_0x485df5(0x1f7),auth,async(_0x44d666,_0x2dd3a2)=>{const _0x164ffa=a0_0x485df5;try{const {username:_0x3d4312,email:_0xb5ae5d,role:_0x4e90f8}=_0x44d666['user'],_0x2d7808=_0x44d666[_0x164ffa(0x128)],_0x314cec=await profile['findOne']({'email':_0x2d7808[_0x164ffa(0xd5)]}),_0x4b748a={'year':_0x164ffa(0x1f2),'month':_0x164ffa(0x137),'day':'numeric'},_0x57f0b9=await master_shop[_0x164ffa(0x164)](),_0x36d5ac=await product['find'](),_0x5233f4=await warehouse[_0x164ffa(0xfe)]([{'$unwind':_0x164ffa(0x156)},{'$lookup':{'from':_0x164ffa(0x111),'localField':_0x164ffa(0x14f),'foreignField':'name','as':_0x164ffa(0x1e3)}},{'$unwind':_0x164ffa(0x162)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x164ffa(0x204)}},{'$group':{'_id':_0x164ffa(0x154),'product_stock':{'$sum':_0x164ffa(0x18c)}}}]);if(_0x57f0b9[0x0][_0x164ffa(0x1b1)]=='English\x20(US)')var _0x1ee7dd=users['English'];else{if(_0x57f0b9[0x0][_0x164ffa(0x1b1)]==_0x164ffa(0xfd))var _0x1ee7dd=users['Hindi'];else{if(_0x57f0b9[0x0][_0x164ffa(0x1b1)]==_0x164ffa(0x20b))var _0x1ee7dd=users[_0x164ffa(0x20b)];else{if(_0x57f0b9[0x0][_0x164ffa(0x1b1)]==_0x164ffa(0x1fb))var _0x1ee7dd=users[_0x164ffa(0x1fb)];else{if(_0x57f0b9[0x0][_0x164ffa(0x1b1)]==_0x164ffa(0x130))var _0x1ee7dd=users['French'];else{if(_0x57f0b9[0x0]['language']=='Portuguese\x20(BR)')var _0x1ee7dd=users[_0x164ffa(0x1b0)];else{if(_0x57f0b9[0x0][_0x164ffa(0x1b1)]==_0x164ffa(0x19d))var _0x1ee7dd=users[_0x164ffa(0x19d)];else{if(_0x57f0b9[0x0][_0x164ffa(0x1b1)]==_0x164ffa(0x1bc))var _0x1ee7dd=users[_0x164ffa(0x1a0)];}}}}}}}_0x2dd3a2['render']('inventory_sum',{'success':_0x44d666[_0x164ffa(0x183)](_0x164ffa(0x185)),'errors':_0x44d666[_0x164ffa(0x183)]('errors'),'alldata':_0x36d5ac,'profile':_0x314cec,'master_shop':_0x57f0b9,'role':_0x2d7808,'product_stock':_0x5233f4,'language':_0x1ee7dd});}catch(_0x359e9a){}});async function dataInventoryReports(_0x19d89f,_0x356506,_0x38274d){const _0x2f8626=a0_0x485df5,_0x3e626c=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x19d89f,'$lte':_0x356506},'sales_staff_id':_0x38274d}},{'$unwind':_0x2f8626(0x1b5)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x2f8626(0x15b)},'sumqty':{'$sum':_0x2f8626(0x1a6)}}},{'$sort':{'_id.product_name':0x1}}]),_0x4756c1=mongoose['Types'][_0x2f8626(0x14e)],_0x2eb0db=await staff[_0x2f8626(0xfe)]([{'$match':{'_id':_0x4756c1(_0x38274d)}},{'$unwind':_0x2f8626(0x16c)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':'$product_list.product_name','product_code':_0x2f8626(0x114)},'sumqty':{'$sum':_0x2f8626(0x103)}}},{'$sort':{'_id.product_name':0x1}}]),_0x89f42=await sales_inv_data[_0x2f8626(0xfe)]([{'$match':{'date':{'$gte':_0x19d89f,'$lte':_0x356506},'sales_staff_id':_0x38274d}},{'$unwind':_0x2f8626(0x1b5)},{'$group':{'_id':{'product_name':_0x2f8626(0x20f),'product_code':_0x2f8626(0x15b)},'totalQTYsum':{'$sum':_0x2f8626(0x23f)}}}]);console[_0x2f8626(0xeb)](_0x89f42);let _0x3bd629='';var _0x415c92=0x0;for(let _0x3a2666=0x0;_0x3a2666<=_0x2eb0db[_0x2f8626(0x13c)]-0x1;_0x3a2666++){const _0x240a8c=_0x2eb0db[_0x3a2666];_0x3bd629+=_0x2f8626(0x1c9),_0x3bd629+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>'+_0x240a8c['_id']['product_code']+_0x2f8626(0x1d4),_0x3bd629+=_0x2f8626(0x1e4)+_0x240a8c[_0x2f8626(0x17c)][_0x2f8626(0x143)]+_0x2f8626(0x1d4);var _0x29eb9b=_0x240a8c['sumqty'],_0x34b019=0x0;for(let _0x2635ea=0x0;_0x2635ea<=_0x3e626c[_0x2f8626(0x13c)]-0x1;_0x2635ea++){const _0x2c5402=_0x3e626c[_0x2635ea];_0x240a8c[_0x2f8626(0x17c)]['product_code']==_0x2c5402[_0x2f8626(0x17c)][_0x2f8626(0x1af)]&&_0x240a8c[_0x2f8626(0x17c)][_0x2f8626(0x143)]==_0x2c5402[_0x2f8626(0x17c)][_0x2f8626(0x143)]&&(_0x34b019=_0x2c5402[_0x2f8626(0xe7)]);}var _0x355ffe=0x0;for(let _0x486fa8=0x0;_0x486fa8<=_0x89f42['length']-0x1;_0x486fa8++){const _0x2ed64c=_0x89f42[_0x486fa8];_0x240a8c[_0x2f8626(0x17c)][_0x2f8626(0x1af)]==_0x2ed64c[_0x2f8626(0x17c)][_0x2f8626(0x1af)]&&_0x240a8c['_id']['product_name']==_0x2ed64c[_0x2f8626(0x17c)][_0x2f8626(0x143)]&&(_0x355ffe=_0x2ed64c['totalQTYsum']);}_0x415c92=_0x29eb9b-_0x355ffe+_0x34b019,_0x3bd629+=_0x2f8626(0x23d)+_0x415c92+_0x2f8626(0x1d4);let _0x298c37=![];for(let _0x332a73=0x0;_0x332a73<=_0x89f42[_0x2f8626(0x13c)]-0x1;_0x332a73++){const _0x13297d=_0x89f42[_0x332a73];if(_0x240a8c[_0x2f8626(0x17c)]['product_code']==_0x13297d[_0x2f8626(0x17c)]['product_code']&&_0x240a8c['_id'][_0x2f8626(0x143)]==_0x13297d[_0x2f8626(0x17c)][_0x2f8626(0x143)]){_0x3bd629+=_0x2f8626(0x23d)+_0x13297d[_0x2f8626(0x23a)]+'</td>',_0x298c37=!![];break;}}!_0x298c37&&(_0x3bd629+=_0x2f8626(0xce));let _0x553889=![];for(let _0x3d7db4=0x0;_0x3d7db4<=_0x3e626c[_0x2f8626(0x13c)]-0x1;_0x3d7db4++){const _0x165b08=_0x3e626c[_0x3d7db4];if(_0x240a8c[_0x2f8626(0x17c)][_0x2f8626(0x1af)]==_0x165b08[_0x2f8626(0x17c)][_0x2f8626(0x1af)]&&_0x240a8c[_0x2f8626(0x17c)][_0x2f8626(0x143)]==_0x165b08[_0x2f8626(0x17c)]['product_name']){_0x3bd629+=_0x2f8626(0x23d)+_0x165b08['sumqty']+_0x2f8626(0x1d4),_0x553889=!![];break;}}!_0x553889&&(_0x3bd629+='<td\x20class=\x22row_data\x22>0</td>'),_0x3bd629+=_0x2f8626(0x23d)+_0x240a8c[_0x2f8626(0xe7)]+_0x2f8626(0x1d4),_0x3bd629+=_0x2f8626(0x1dc);}return _0x3bd629;}router['post'](a0_0x485df5(0xcc),auth,async(_0x514d39,_0x3564ab)=>{const _0x5db859=a0_0x485df5;try{const {from_date:_0x382576,to_date:_0x1172dc}=_0x514d39[_0x5db859(0x18a)],_0x3d14a3=_0x514d39[_0x5db859(0x128)],_0x28f733=await staff[_0x5db859(0x18b)]({'email':_0x3d14a3[_0x5db859(0xd5)]});let _0x3f8b81='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x229568=new Date(_0x382576),_0x4cae5e=new Date(_0x1172dc);const _0x1afa4d={'year':_0x5db859(0x1f2),'month':'long','day':_0x5db859(0x1f2)},_0x1fbe9f=new Intl['DateTimeFormat'](_0x5db859(0x24b),_0x1afa4d)[_0x5db859(0x1c3)](_0x229568),_0x54a892=new Intl['DateTimeFormat'](_0x5db859(0x24b),_0x1afa4d)[_0x5db859(0x1c3)](_0x4cae5e);var _0x394bfb=await dataInventoryReports(_0x382576,_0x1172dc,_0x28f733['_id']['valueOf']());_0x3f8b81+=_0x5db859(0x11e),_0x3f8b81+='<p>INVENTORY\x20SUMMARY</p>',_0x3f8b81+=_0x5db859(0x199)+_0x1fbe9f+_0x5db859(0x1a1)+_0x54a892+_0x5db859(0xda),_0x3f8b81+=_0x5db859(0x1cb),_0x3f8b81+='<div\x20class=\x22col-sm-11\x22>',_0x3f8b81+=_0x5db859(0x18f),_0x3f8b81+=_0x5db859(0x1c9),_0x3f8b81+=_0x5db859(0x15e),_0x3f8b81+=_0x5db859(0x234),_0x3f8b81+=_0x5db859(0x104),_0x3f8b81+=_0x5db859(0x224),_0x3f8b81+=_0x5db859(0x1fa),_0x3f8b81+=_0x5db859(0x106),_0x3f8b81+=_0x5db859(0x1c9),_0x3f8b81+=_0x394bfb,_0x3f8b81+='</tr>',_0x3f8b81+='</div>',_0x3f8b81+=_0x5db859(0x11d);const _0x59da82={'format':_0x5db859(0x1a2),'orientation':_0x5db859(0x1ea),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x5db859(0x127)}}};pdf[_0x5db859(0x15a)](_0x3f8b81,_0x59da82)[_0x5db859(0x189)](function(_0x52223b,_0x1094dc){const _0x4b976f=_0x5db859;if(_0x52223b){_0x3564ab[_0x4b976f(0xd7)](0x1f4)[_0x4b976f(0x16d)]('Error\x20generating\x20PDF');return;}_0x3564ab['setHeader'](_0x4b976f(0x13e),'application/pdf'),_0x1094dc[_0x4b976f(0x10c)](_0x3564ab);});}catch(_0x162db0){}}),router[a0_0x485df5(0x145)](a0_0x485df5(0xd9),auth,async(_0x5d38da,_0x595bd9)=>{const _0x2dd410=a0_0x485df5;try{const {username:_0x2c3e29,email:_0x1be4a2,role:_0x1aa0f5}=_0x5d38da[_0x2dd410(0x128)],_0x51701b=_0x5d38da[_0x2dd410(0x128)],_0x56a64d=await profile[_0x2dd410(0x18b)]({'email':_0x51701b[_0x2dd410(0xd5)]}),_0xf49ce6={'year':_0x2dd410(0x1f2),'month':_0x2dd410(0x137),'day':_0x2dd410(0x1f2)},_0x26947e=await master_shop[_0x2dd410(0x164)]();console[_0x2dd410(0xeb)](_0x2dd410(0x1f5),_0x26947e);const _0x443012=await product['find']();console[_0x2dd410(0xeb)]('Products\x20find_data',_0x443012);const _0x49c455=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x2dd410(0x14f),'foreignField':_0x2dd410(0x248),'as':_0x2dd410(0x1e3)}},{'$unwind':_0x2dd410(0x162)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x2dd410(0x204)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2dd410(0x18c)}}}]);console[_0x2dd410(0xeb)](_0x2dd410(0x155),_0x49c455),_0x49c455[_0x2dd410(0x181)](_0x3392db=>{const _0x5ae06e=_0x2dd410,_0x4c114e=_0x443012[_0x5ae06e(0x110)](_0x61ea0c=>{const _0x4ce49d=_0x5ae06e;_0x61ea0c['name']==_0x3392db[_0x4ce49d(0x17c)]&&(_0x61ea0c[_0x4ce49d(0x1ba)]=parseInt(_0x61ea0c[_0x4ce49d(0x1ba)])+parseInt(_0x3392db['product_stock']));});});const _0x250ff7=await staff[_0x2dd410(0x18b)]({'email':_0x51701b['email']});if(_0x26947e[0x0]['language']==_0x2dd410(0x133))var _0x5613fd=users[_0x2dd410(0x165)];else{if(_0x26947e[0x0][_0x2dd410(0x1b1)]==_0x2dd410(0xfd))var _0x5613fd=users[_0x2dd410(0xfd)];else{if(_0x26947e[0x0][_0x2dd410(0x1b1)]==_0x2dd410(0x20b))var _0x5613fd=users[_0x2dd410(0x20b)];else{if(_0x26947e[0x0][_0x2dd410(0x1b1)]==_0x2dd410(0x1fb))var _0x5613fd=users['Spanish'];else{if(_0x26947e[0x0][_0x2dd410(0x1b1)]=='French')var _0x5613fd=users[_0x2dd410(0x130)];else{if(_0x26947e[0x0]['language']=='Portuguese\x20(BR)')var _0x5613fd=users[_0x2dd410(0x1b0)];else{if(_0x26947e[0x0][_0x2dd410(0x1b1)]==_0x2dd410(0x19d))var _0x5613fd=users['Chinese'];else{if(_0x26947e[0x0][_0x2dd410(0x1b1)]==_0x2dd410(0x1bc))var _0x5613fd=users[_0x2dd410(0x1a0)];}}}}}}}_0x595bd9[_0x2dd410(0x1cc)](_0x2dd410(0x1e9),{'success':_0x5d38da['flash'](_0x2dd410(0x185)),'errors':_0x5d38da[_0x2dd410(0x183)](_0x2dd410(0x1d5)),'alldata':_0x443012,'profile':_0x56a64d,'master_shop':_0x26947e,'role':_0x51701b,'product_stock':_0x49c455,'language':_0x5613fd,'staff_arr':_0x250ff7});}catch(_0x553627){}});async function agentsdataDSICheck_DSRR(_0x3dd21e,_0x1c68e6,_0x50d51d,_0xef7c39){const _0x3c01c5=a0_0x485df5;let _0x258e80=new Date(_0x3dd21e);_0x258e80['setDate'](_0x258e80[_0x3c01c5(0x236)]()-0x1);let _0x2e37e2=_0x258e80['toISOString']()[_0x3c01c5(0x1e0)]('T')[0x0];const _0x37447c=await product[_0x3c01c5(0xfe)]([{'$group':{'_id':{'brand':_0x3c01c5(0x16a),'category':_0x3c01c5(0x1dd)},'products':{'$push':{'name':_0x3c01c5(0x1be),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x262c73=[];_0x262c73[_0x3c01c5(0x22f)]=[];for(let _0x5de08c=0x0;_0x5de08c<=_0x37447c[_0x3c01c5(0x13c)]-0x1;_0x5de08c++){const _0x412949=_0x37447c[_0x5de08c];_0x262c73['cat_brand'][_0x3c01c5(0x124)](_0x412949);}const _0x3cf4e6=await product[_0x3c01c5(0xfe)]([{'$group':{'_id':{'category':_0x3c01c5(0x1dd)},'products':{'$push':{'brand':_0x3c01c5(0x16a),'product_code':_0x3c01c5(0x13d),'product_name':_0x3c01c5(0x1be)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4cf142=await product[_0x3c01c5(0xfe)]([{'$group':{'_id':{'category':_0x3c01c5(0x1dd),'brand':_0x3c01c5(0x16a)}}},{'$group':{'_id':_0x3c01c5(0x1b6),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3ce5b4=await sales_sa['aggregate']([{'$match':{'date':_0x3dd21e,'sales_staff_id':_0x1c68e6,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x3c01c5(0x111),'localField':_0x3c01c5(0x132),'foreignField':_0x3c01c5(0x1af),'as':'product_info'}},{'$unwind':_0x3c01c5(0x228)},{'$group':{'_id':{'dsi':'$dsi','date':_0x3c01c5(0x176),'customer':_0x3c01c5(0x235),'status_data':'$status_data'},'totalQty':{'$sum':_0x3c01c5(0x11b)},'cash':{'$first':_0x3c01c5(0x10a)},'amount':{'$first':_0x3c01c5(0xe2)},'bank':{'$first':_0x3c01c5(0x203)},'check_no':{'$first':_0x3c01c5(0x100)},'due_date':{'$first':_0x3c01c5(0x22d)},'products':{'$push':{'qty':_0x3c01c5(0x11b),'NetPrice':_0x3c01c5(0x159),'discount':_0x3c01c5(0x1c0),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x3c01c5(0xe0),'product_code':_0x3c01c5(0x1fd),'category':_0x3c01c5(0xfa),'brand':'$product_info.brand','gross_price':_0x3c01c5(0xff),'isFG':_0x3c01c5(0x229),'prod_cat':'$sale_product.prod_cat','prod_id':'$sale_product._id'}}}}},{'$unwind':_0x3c01c5(0x13a)},{'$group':{'_id':{'dsi':_0x3c01c5(0x1e7),'date':'$_id.date','customer':_0x3c01c5(0x217),'status_data':_0x3c01c5(0x20d),'category':'$products.product_details.category','brand':_0x3c01c5(0x1a8),'prod_id':_0x3c01c5(0x1ae)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x3c01c5(0xfb),_0x3c01c5(0x14d)]}},'NetPrice':{'$sum':_0x3c01c5(0x245)},'discount':{'$sum':_0x3c01c5(0x150)},'adj_discount':{'$sum':_0x3c01c5(0x1bf)},'cash':{'$first':_0x3c01c5(0x10a)},'amount':{'$first':'$amount'},'bank':{'$first':_0x3c01c5(0x203)},'check_no':{'$first':_0x3c01c5(0x100)},'due_date':{'$first':'$due_date'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3c01c5(0x186),'customer':_0x3c01c5(0x217),'status_data':_0x3c01c5(0x20d)},'totalQty':{'$sum':_0x3c01c5(0x101)},'totalGross':{'$sum':_0x3c01c5(0x24a)},'NetPrice':{'$sum':_0x3c01c5(0x206)},'discount':{'$sum':_0x3c01c5(0x1f3)},'adj_discount':{'$sum':'$adj_discount'},'cash':{'$first':_0x3c01c5(0x10a)},'amount':{'$first':_0x3c01c5(0xe2)},'bank':{'$first':_0x3c01c5(0x203)},'check_no':{'$first':_0x3c01c5(0x100)},'due_date':{'$first':_0x3c01c5(0x22d)},'products':{'$push':{'qty':_0x3c01c5(0x101),'category':_0x3c01c5(0x1b6),'brand':_0x3c01c5(0x1bd),'product_details':_0x3c01c5(0x156)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x19c913=await sales_sa[_0x3c01c5(0xfe)]([{'$match':{'date':_0x2e37e2,'sales_staff_id':_0x1c68e6,'sale_product.isFG':'false'}},{'$unwind':_0x3c01c5(0x1b5)},{'$lookup':{'from':_0x3c01c5(0x111),'localField':_0x3c01c5(0x132),'foreignField':_0x3c01c5(0x1af),'as':_0x3c01c5(0xe1)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x3c01c5(0x213),'date':_0x3c01c5(0x176),'customer':_0x3c01c5(0x235)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':_0x3c01c5(0x10a)},'amount':{'$first':_0x3c01c5(0xe2)},'bank':{'$first':_0x3c01c5(0x203)},'check_no':{'$first':_0x3c01c5(0x100)},'due_date':{'$first':_0x3c01c5(0x22d)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x3c01c5(0x159),'discount':_0x3c01c5(0x1c0),'adj_discount':_0x3c01c5(0x1c2),'product_details':{'prod_name':_0x3c01c5(0xe0),'product_code':_0x3c01c5(0x1fd),'category':_0x3c01c5(0xfa),'brand':_0x3c01c5(0x170),'gross_price':'$product_info.gross_price','isFG':_0x3c01c5(0x229),'prod_cat':_0x3c01c5(0x1e8),'prod_id':'$sale_product._id'}}}}},{'$unwind':_0x3c01c5(0x13a)},{'$group':{'_id':{'dsi':_0x3c01c5(0x1e7),'date':_0x3c01c5(0x186),'customer':_0x3c01c5(0x217),'category':_0x3c01c5(0x1c1),'brand':'$products.product_details.brand','prod_id':_0x3c01c5(0x1ae)},'totalQty':{'$sum':_0x3c01c5(0xfb)},'cash':{'$first':_0x3c01c5(0x10a)},'amount':{'$first':_0x3c01c5(0xe2)},'bank':{'$first':_0x3c01c5(0x203)},'check_no':{'$first':_0x3c01c5(0x100)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':{'$multiply':[_0x3c01c5(0xfb),_0x3c01c5(0x14d)]}},'NetPrice':{'$sum':_0x3c01c5(0x245)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x3c01c5(0x1bf)},'product_details':{'$first':_0x3c01c5(0x141)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3c01c5(0x186),'customer':'$_id.customer'},'totalQty':{'$sum':_0x3c01c5(0x101)},'cash':{'$first':_0x3c01c5(0x10a)},'amount':{'$first':'$amount'},'bank':{'$first':_0x3c01c5(0x203)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x3c01c5(0x22d)},'totalGross':{'$sum':_0x3c01c5(0x24a)},'NetPrice':{'$sum':_0x3c01c5(0x206)},'discount':{'$sum':_0x3c01c5(0x1f3)},'adj_discount':{'$sum':_0x3c01c5(0xdb)},'products':{'$push':{'qty':_0x3c01c5(0x101),'category':'$_id.category','brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x33638e=await sales_sa['aggregate']([{'$match':{'date':_0x3dd21e,'sales_staff_id':_0x1c68e6,'status_data':_0x3c01c5(0x222)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x3a7650=await staff['findById'](_0x1c68e6);let _0x394ed3=[],_0x4b2d13={},_0x2dad00={};var _0x5e38b7=0x0,_0x5cdd6d=0x0,_0x44bda8=0x0,_0x19adeb=0x0,_0x4d2526=0x0;const _0x4d2402=0x6;var _0x38ffdd=0x0,_0x57c016=0x0;for(let _0x360d89=0x0;_0x360d89<=_0x3ce5b4[_0x3c01c5(0x13c)]-0x1;_0x360d89++){const _0x3de51c=_0x3ce5b4[_0x360d89];let _0x516539=_0x3c01c5(0x1c9);_0x516539+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x516539+=_0x3c01c5(0x1d1)+_0x3de51c['_id']['customer']+_0x3c01c5(0x1d4),_0x516539+=_0x3c01c5(0x1d1)+_0x3de51c[_0x3c01c5(0x17c)]['dsi']+'</td>';let _0xf647ba={},_0x44557b={},_0x48ed90={};var _0x5a4f3a={},_0x4cdef7={},_0x4c07a4={},_0x235a15=0x0;for(let _0x48de7f=0x0;_0x48de7f<=_0x3de51c[_0x3c01c5(0x111)][_0x3c01c5(0x13c)]-0x1;_0x48de7f++){const _0xe3e628=_0x3de51c['products'][_0x48de7f];_0xf647ba[_0xe3e628[_0x3c01c5(0x169)]+'-'+_0xe3e628[_0x3c01c5(0x195)]]=_0xe3e628[_0x3c01c5(0x135)],_0x44557b[[_0xe3e628[_0x3c01c5(0x169)]+'-'+_0xe3e628[_0x3c01c5(0x195)]]]=_0xe3e628['product_details'][_0x3c01c5(0x1d0)],_0x48ed90[[_0xe3e628[_0x3c01c5(0x169)]+'-'+_0xe3e628[_0x3c01c5(0x195)]]]=_0xe3e628[_0x3c01c5(0x23e)][_0x3c01c5(0x208)];const _0xdeec74=_0xe3e628[_0x3c01c5(0x169)]+'-'+_0xe3e628[_0x3c01c5(0x195)];!Array[_0x3c01c5(0x105)](_0x2dad00[_0xdeec74])&&(_0x2dad00[_0xdeec74]=[]);!Array['isArray'](_0x2dad00[_0xdeec74])&&(_0x2dad00[_0xdeec74]=[]);_0x2dad00[_0xdeec74][_0x3c01c5(0x124)](_0xe3e628[_0x3c01c5(0x135)]);if(_0xe3e628[_0x3c01c5(0x23e)][_0x3c01c5(0x208)]=='P')_0xe3e628[_0x3c01c5(0x23e)][_0x3c01c5(0x1d0)]==_0x3c01c5(0x222)?(!_0x4c07a4[_0xdeec74]&&(_0x4c07a4[_0xdeec74]=0x0),_0x4c07a4[_0xdeec74]=_0xe3e628[_0x3c01c5(0x135)]):(!_0x5a4f3a[_0xdeec74]&&(_0x5a4f3a[_0xdeec74]=0x0),_0x5a4f3a[_0xdeec74]=_0xe3e628[_0x3c01c5(0x135)]);else _0xe3e628[_0x3c01c5(0x23e)][_0x3c01c5(0x208)]=='S'&&(_0xe3e628[_0x3c01c5(0x23e)][_0x3c01c5(0x1d0)]=='true'?(!_0x4c07a4[_0xdeec74]&&(_0x4c07a4[_0xdeec74]=0x0),_0x4c07a4[_0xdeec74]=_0xe3e628['qty']):(!_0x4cdef7[_0xdeec74]&&(_0x4cdef7[_0xdeec74]=0x0),_0x4cdef7[_0xdeec74]=_0xe3e628[_0x3c01c5(0x135)]));_0x235a15++;}for(let _0x2cd9da=0x0;_0x2cd9da<=_0x262c73[_0x3c01c5(0x22f)][_0x3c01c5(0x13c)]-0x1;_0x2cd9da++){const _0x43a55a=_0x262c73['cat_brand'][_0x2cd9da],_0xa15eca=_0x43a55a[_0x3c01c5(0x17c)]['brand']+'-'+_0x43a55a[_0x3c01c5(0x17c)]['category'],_0x48b5af=_0x48ed90[_0xa15eca]!==undefined?_0x48ed90[_0xa15eca]:'NA';var _0xe48910=_0x5a4f3a[_0xa15eca]!==undefined?_0x5a4f3a[_0xa15eca][_0x3c01c5(0xcf)](0x2):'',_0x1b5156=_0x4cdef7[_0xa15eca]!==undefined?_0x4cdef7[_0xa15eca][_0x3c01c5(0xcf)](0x2):'',_0x4fc896=_0x4c07a4[_0xa15eca]!==undefined?_0x4c07a4[_0xa15eca][_0x3c01c5(0xcf)](0x2):'';_0x516539+=_0x3c01c5(0x182)+_0xe48910+'</td>',_0x516539+=_0x3c01c5(0x182)+_0x1b5156+_0x3c01c5(0x1d4),_0x516539+=_0x3c01c5(0x182)+_0x4fc896+'</td>';}var _0x4f370d=formatNumber(parseFloat(_0x3de51c[_0x3c01c5(0xea)])),_0x257f33=formatNumber(parseFloat(_0x3de51c[_0x3c01c5(0x15d)]));isNaN(_0x257f33)&&(_0x257f33=0x0),_0x516539+=_0x3c01c5(0x182)+_0x4f370d+_0x3c01c5(0x1d4),_0x516539+=_0x3c01c5(0x182)+_0x257f33+_0x3c01c5(0x1d4),_0x516539+=_0x3c01c5(0x1d1)+_0x3de51c['bank']+'</td>',_0x516539+=_0x3c01c5(0x1d1)+_0x3de51c[_0x3c01c5(0x12b)]+_0x3c01c5(0x1d4),_0x516539+=_0x3c01c5(0x1d1)+_0x3de51c[_0x3c01c5(0x242)]+_0x3c01c5(0x1d4),_0x44bda8=_0x3de51c[_0x3c01c5(0x1a4)]+_0x3de51c[_0x3c01c5(0x144)],_0x38ffdd+=parseFloat(_0x3de51c[_0x3c01c5(0xea)]),_0x57c016+=parseFloat(_0x257f33),_0x394ed3[_0x3c01c5(0x124)](_0x516539);}if(_0x33638e[_0x3c01c5(0x13c)]>0x0)for(let _0x103346=0x0;_0x103346<=_0x33638e[_0x3c01c5(0x13c)]-0x1;_0x103346++){const _0x5e0a52=_0x33638e[_0x103346];console[_0x3c01c5(0xeb)](_0x5e0a52);let _0x59d9d0=_0x3c01c5(0x1c9);_0x59d9d0+=_0x3c01c5(0x20e)+(0x8+0x7*0x3)+_0x3c01c5(0x10f)+_0x5e0a52['note']+_0x3c01c5(0x1ed),_0x59d9d0+='</tr>',_0x394ed3[_0x3c01c5(0x124)](_0x59d9d0);}function _0x23f163(_0x10d943,_0x3e0938){const _0x5ae6f3=_0x3c01c5,_0x3066fd=[];for(let _0x1262e3=0x0;_0x1262e3<=_0x10d943['length']-0x1;_0x1262e3+=_0x3e0938){_0x3066fd[_0x5ae6f3(0x124)](_0x10d943[_0x5ae6f3(0x184)](_0x1262e3,_0x1262e3+_0x3e0938));}return _0x3066fd;}const _0xf9e4b=_0x23f163(_0x394ed3,_0x4d2402);let _0x21e4bd='';return _0xf9e4b['forEach']((_0x23b387,_0x4b9b2c)=>{const _0x149556=_0x3c01c5;_0x4b9b2c>0x0&&(_0x21e4bd+=_0x149556(0x232));_0x21e4bd+=_0x149556(0x18f),_0x21e4bd+='<thead>';const _0x289334=new Date(_0x3dd21e),_0x4457a7={'year':_0x149556(0x1f2),'month':_0x149556(0x137),'day':_0x149556(0x1f2),'timeZone':'Asia/Manila'},_0x45c50a=_0x289334[_0x149556(0x1a7)](_0x149556(0x24b),_0x4457a7);_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x14b)+_0xef7c39+'</b></td>',_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+='<tr>',_0x21e4bd+=_0x149556(0x17b)+_0x3a7650['name']+'</td>',_0x21e4bd+=_0x149556(0x209),_0x21e4bd+=_0x149556(0x138),_0x21e4bd+='<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>',_0x21e4bd+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x21e4bd+=_0x149556(0x1b2),_0x21e4bd+=_0x149556(0x116),_0x21e4bd+='<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>',_0x21e4bd+='<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>',_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0xf0),_0x21e4bd+=_0x149556(0x19c)+_0x45c50a+_0x149556(0x1d4),_0x21e4bd+=_0x149556(0x1da),_0x21e4bd+=_0x149556(0x249),_0x21e4bd+=_0x149556(0xf7),_0x21e4bd+=_0x149556(0xf7),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0xd6),_0x21e4bd+=_0x149556(0x177),_0x21e4bd+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>',_0x21e4bd+=_0x149556(0xf7),_0x21e4bd+=_0x149556(0xf7),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x192),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x168),_0x21e4bd+=_0x149556(0xd1),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x202),_0x21e4bd+=_0x149556(0x1ff),_0x21e4bd+=_0x149556(0x1ce);for(let _0x443bc7=0x0;_0x443bc7<=_0x3cf4e6[_0x149556(0x13c)]-0x1;_0x443bc7++){const _0x1864b7=_0x3cf4e6[_0x443bc7];for(let _0x558ba=0x0;_0x558ba<_0x262c73[_0x149556(0x22f)][_0x149556(0x13c)];_0x558ba++){const _0x2e8ff3=_0x262c73[_0x149556(0x22f)][_0x558ba];if(_0x2e8ff3[_0x149556(0x17c)][_0x149556(0x195)]===_0x1864b7[_0x149556(0x17c)][_0x149556(0x195)]){var _0x24423c='';switch(_0x1864b7['_id']['category']){case'Standard':_0x24423c=_0x2e8ff3[_0x149556(0x17c)][_0x149556(0x169)]+'\x20-\x20STD';break;case _0x149556(0x1e1):_0x24423c=_0x2e8ff3[_0x149556(0x17c)][_0x149556(0x169)]+'\x20-\x20HH';break;default:_0x24423c=_0x2e8ff3[_0x149556(0x17c)]['brand'];break;}_0x21e4bd+=_0x149556(0x218)+_0x24423c+_0x149556(0x1ed);}}}_0x21e4bd+=_0x149556(0xd0),_0x21e4bd+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>',_0x21e4bd+=_0x149556(0x1a5),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x1bb);for(let _0x4a413f=0x0;_0x4a413f<=_0x262c73[_0x149556(0x22f)][_0x149556(0x13c)]-0x1;_0x4a413f++){const _0x25e360=_0x262c73[_0x4a413f];_0x21e4bd+=_0x149556(0xf8),_0x21e4bd+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x21e4bd+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x21e4bd+=_0x149556(0x1c6),_0x21e4bd+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>',_0x21e4bd+=_0x149556(0x14a),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+='</thead>',_0x21e4bd+=_0x149556(0xd8),_0x23b387['forEach'](_0x3582ef=>{_0x21e4bd+=_0x3582ef;});let _0x27c926={},_0x23aac5={},_0x16eb01={};for(let _0x56d77e=0x0;_0x56d77e<=_0x3ce5b4['length']-0x1;_0x56d77e++){const _0x26a548=_0x3ce5b4[_0x56d77e];var _0x36d1ee=0x0;for(let _0x540adc=0x0;_0x540adc<=_0x26a548[_0x149556(0x111)]['length']-0x1;_0x540adc++){const _0x5a8c14=_0x26a548[_0x149556(0x111)][_0x540adc],_0x567258=_0x5a8c14[_0x149556(0x169)]+'-'+_0x5a8c14['category'];if(_0x5a8c14[_0x149556(0x23e)]['prod_cat']=='P')_0x5a8c14[_0x149556(0x23e)][_0x149556(0x1d0)]==_0x149556(0x222)?(!_0x16eb01[_0x567258]&&(_0x16eb01[_0x567258]=0x0),_0x16eb01[_0x567258]+=_0x5a8c14[_0x149556(0x135)]):(!_0x27c926[_0x567258]&&(_0x27c926[_0x567258]=0x0),_0x27c926[_0x567258]+=_0x5a8c14[_0x149556(0x135)]);else _0x5a8c14['product_details'][_0x149556(0x208)]=='S'&&(_0x5a8c14['product_details']['isFG']==_0x149556(0x222)?(!_0x16eb01[_0x567258]&&(_0x16eb01[_0x567258]=0x0),_0x16eb01[_0x567258]+=_0x5a8c14[_0x149556(0x135)],console[_0x149556(0xeb)](_0x5a8c14['qty'])):(!_0x23aac5[_0x567258]&&(_0x23aac5[_0x567258]=0x0),_0x23aac5[_0x567258]+=_0x5a8c14['qty']));_0x36d1ee++;}}let _0x35512f={},_0x3adcf3={},_0x43eb86={};var _0xb8bcd2=0x0,_0x1103fa=0x0;for(let _0x5afede=0x0;_0x5afede<=_0x19c913[_0x149556(0x13c)]-0x1;_0x5afede++){const _0x457dad=_0x19c913[_0x5afede];var _0x36d1ee=0x0;for(let _0x211c16=0x0;_0x211c16<=_0x457dad[_0x149556(0x111)][_0x149556(0x13c)]-0x1;_0x211c16++){const _0x482110=_0x457dad[_0x149556(0x111)][_0x211c16],_0xc8e547=_0x482110['brand']+'-'+_0x482110[_0x149556(0x195)];if(_0x482110[_0x149556(0x23e)][_0x149556(0x208)]=='P')_0x482110[_0x149556(0x23e)][_0x149556(0x1d0)]==_0x149556(0x222)?(!_0x43eb86[_0xc8e547]&&(_0x43eb86[_0xc8e547]=0x0),_0x43eb86[_0xc8e547]+=_0x482110[_0x149556(0x135)]):(!_0x35512f[_0xc8e547]&&(_0x35512f[_0xc8e547]=0x0),_0x35512f[_0xc8e547]+=_0x482110[_0x149556(0x135)]);else _0x482110[_0x149556(0x23e)][_0x149556(0x208)]=='S'&&(_0x482110['product_details'][_0x149556(0x1d0)]=='true'?(!_0x43eb86[_0xc8e547]&&(_0x43eb86[_0xc8e547]=0x0),_0x43eb86[_0xc8e547]+=_0x482110[_0x149556(0x135)]):(!_0x3adcf3[_0xc8e547]&&(_0x3adcf3[_0xc8e547]=0x0),_0x3adcf3[_0xc8e547]+=_0x482110[_0x149556(0x135)]));_0x36d1ee++;}var _0x2a4f3c=parseFloat(_0x457dad[_0x149556(0xea)]),_0x4299fa=parseFloat(_0x457dad['amount']);isNaN(_0x4299fa)&&(_0x4299fa=0x0),_0xb8bcd2+=_0x2a4f3c,_0x1103fa+=_0x4299fa;}_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x21e4bd+=_0x149556(0x1d3);for(let _0x543094=0x0;_0x543094<=_0x262c73[_0x149556(0x22f)][_0x149556(0x13c)]-0x1;_0x543094++){const _0x46cce9=_0x262c73[_0x149556(0x22f)][_0x543094],_0x105d73=_0x46cce9[_0x149556(0x17c)][_0x149556(0x169)]+'-'+_0x46cce9['_id'][_0x149556(0x195)];var _0x47e79c=_0x27c926[_0x105d73]!==undefined?formatNumber(_0x27c926[_0x105d73]['toFixed'](0x2)):'',_0x5e0986=_0x16eb01[_0x105d73]!==undefined?formatNumber(_0x16eb01[_0x105d73]['toFixed'](0x2)):'',_0x14079c=_0x23aac5[_0x105d73]!==undefined?formatNumber(_0x23aac5[_0x105d73][_0x149556(0xcf)](0x2)):'';_0x21e4bd+=_0x149556(0x1ad)+_0x47e79c+_0x149556(0x1ed),_0x21e4bd+=_0x149556(0x1ad)+_0x14079c+_0x149556(0x1ed),_0x21e4bd+=_0x149556(0x1ad)+_0x5e0986+_0x149556(0x1ed);}_0x21e4bd+=_0x149556(0x1ad)+formatNumber(_0x38ffdd)+_0x149556(0x1ed),_0x21e4bd+=_0x149556(0x1ad)+formatNumber(_0x57c016)+_0x149556(0x1ed),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x1b8),_0x21e4bd+=_0x149556(0x226),_0x21e4bd+=_0x149556(0x1d3);for(let _0x5cef04=0x0;_0x5cef04<=_0x262c73[_0x149556(0x22f)][_0x149556(0x13c)]-0x1;_0x5cef04++){const _0x5e98da=_0x262c73[_0x149556(0x22f)][_0x5cef04],_0x3b9244=_0x5e98da[_0x149556(0x17c)][_0x149556(0x169)]+'-'+_0x5e98da[_0x149556(0x17c)][_0x149556(0x195)];var _0x47e79c=_0x35512f[_0x3b9244]!==undefined?formatNumber(_0x35512f[_0x3b9244]['toFixed'](0x2)):'',_0x5e0986=_0x43eb86[_0x3b9244]!==undefined?formatNumber(_0x43eb86[_0x3b9244]['toFixed'](0x2)):'',_0x14079c=_0x3adcf3[_0x3b9244]!==undefined?formatNumber(_0x3adcf3[_0x3b9244][_0x149556(0xcf)](0x2)):'';_0x21e4bd+=_0x149556(0x1ad)+_0x47e79c+_0x149556(0x1ed),_0x21e4bd+=_0x149556(0x1ad)+_0x14079c+_0x149556(0x1ed),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x5e0986+'</b></td>';}_0x21e4bd+=_0x149556(0x1ad)+formatNumber(_0xb8bcd2)+'</b></td>',_0x21e4bd+=_0x149556(0x1ad)+formatNumber(_0x1103fa)+'</b></td>',_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+='</tr>',_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x21e4bd+=_0x149556(0xfc),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';let _0x417239=0x0,_0x3bbe80=0x0,_0x146fc0=0x0;for(let _0x490f81=0x0;_0x490f81<=_0x262c73[_0x149556(0x22f)][_0x149556(0x13c)]-0x1;_0x490f81++){const _0x4d5e1f=_0x262c73[_0x149556(0x22f)][_0x490f81],_0x4f354a=_0x4d5e1f[_0x149556(0x17c)][_0x149556(0x169)]+'-'+_0x4d5e1f[_0x149556(0x17c)][_0x149556(0x195)];var _0x28dcc1=_0x27c926[_0x4f354a]!==undefined?_0x27c926[_0x4f354a][_0x149556(0xcf)](0x2):'0',_0x2fb8bb=_0x16eb01[_0x4f354a]!==undefined?_0x16eb01[_0x4f354a][_0x149556(0xcf)](0x2):'0',_0x5da506=_0x23aac5[_0x4f354a]!==undefined?_0x23aac5[_0x4f354a]['toFixed'](0x2):'0',_0x3d6b58=_0x35512f[_0x4f354a]!==undefined?_0x35512f[_0x4f354a][_0x149556(0xcf)](0x2):'0',_0x4981ef=_0x43eb86[_0x4f354a]!==undefined?_0x43eb86[_0x4f354a][_0x149556(0xcf)](0x2):'0',_0x5ed1b1=_0x3adcf3[_0x4f354a]!==undefined?_0x3adcf3[_0x4f354a]['toFixed'](0x2):'0';_0x417239=parseFloat(_0x28dcc1)+parseFloat(_0x3d6b58),_0x3bbe80=parseFloat(_0x5da506)+parseFloat(_0x5ed1b1),_0x146fc0=parseFloat(_0x2fb8bb)+parseFloat(_0x4981ef),_0x21e4bd+=_0x149556(0x1ad)+formatNumber(_0x417239[_0x149556(0xcf)](0x2))+_0x149556(0x1ed),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3bbe80[_0x149556(0xcf)](0x2))+'</b></td>',_0x21e4bd+=_0x149556(0x1ad)+formatNumber(_0x146fc0[_0x149556(0xcf)](0x2))+_0x149556(0x1ed);}var _0x237e9e=formatNumber(_0x38ffdd+_0xb8bcd2),_0x27bacd=formatNumber(_0x57c016+_0x1103fa);_0x21e4bd+=_0x149556(0x1ad)+_0x237e9e+_0x149556(0x1ed),_0x21e4bd+=_0x149556(0x1ad)+_0x27bacd+'</b></td>',_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x262c73[_0x149556(0x22f)][_0x149556(0x13c)]*0x3+0x9)+'\x22><b></b></td>',_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+='<tr>',_0x21e4bd+=_0x149556(0x1b8),_0x21e4bd+=_0x149556(0x241),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x5d7b66=0x0;_0x5d7b66<=_0x262c73[_0x149556(0x22f)][_0x149556(0x13c)]-0x1;_0x5d7b66++){const _0x1aa232=_0x262c73[_0x149556(0x22f)][_0x5d7b66],_0x1ee473=_0x1aa232[_0x149556(0x17c)][_0x149556(0x169)]+'-'+_0x1aa232[_0x149556(0x17c)][_0x149556(0x195)];var _0x28dcc1=_0x27c926[_0x1ee473]!==undefined?_0x27c926[_0x1ee473][_0x149556(0xcf)](0x2):'0',_0x2fb8bb=_0x16eb01[_0x1ee473]!==undefined?_0x16eb01[_0x1ee473]['toFixed'](0x2):'0',_0x5da506=_0x23aac5[_0x1ee473]!==undefined?_0x23aac5[_0x1ee473]['toFixed'](0x2):'0',_0x3d6b58=_0x35512f[_0x1ee473]!==undefined?_0x35512f[_0x1ee473]['toFixed'](0x2):'0',_0x4981ef=_0x43eb86[_0x1ee473]!==undefined?_0x43eb86[_0x1ee473][_0x149556(0xcf)](0x2):'0',_0x5ed1b1=_0x3adcf3[_0x1ee473]!==undefined?_0x3adcf3[_0x1ee473][_0x149556(0xcf)](0x2):'0';_0x417239=parseFloat(_0x28dcc1)+parseFloat(_0x3d6b58),_0x3bbe80=parseFloat(_0x5da506)+parseFloat(_0x5ed1b1),_0x146fc0=parseFloat(_0x2fb8bb)+parseFloat(_0x4981ef),_0x21e4bd+=_0x149556(0x12d),_0x21e4bd+=_0x149556(0x12d),_0x21e4bd+=_0x149556(0x12d);}_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+='</tr>',_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x1b8),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>',_0x21e4bd+=_0x149556(0x1d3);for(let _0x27fa5b=0x0;_0x27fa5b<=_0x262c73['cat_brand'][_0x149556(0x13c)]-0x1;_0x27fa5b++){const _0x474906=_0x262c73[_0x149556(0x22f)][_0x27fa5b],_0x42e1a2=_0x474906[_0x149556(0x17c)]['brand']+'-'+_0x474906[_0x149556(0x17c)][_0x149556(0x195)];var _0x28dcc1=_0x27c926[_0x42e1a2]!==undefined?_0x27c926[_0x42e1a2][_0x149556(0xcf)](0x2):'0',_0x2fb8bb=_0x16eb01[_0x42e1a2]!==undefined?_0x16eb01[_0x42e1a2]['toFixed'](0x2):'0',_0x5da506=_0x23aac5[_0x42e1a2]!==undefined?_0x23aac5[_0x42e1a2]['toFixed'](0x2):'0',_0x3d6b58=_0x35512f[_0x42e1a2]!==undefined?_0x35512f[_0x42e1a2][_0x149556(0xcf)](0x2):'0',_0x4981ef=_0x43eb86[_0x42e1a2]!==undefined?_0x43eb86[_0x42e1a2][_0x149556(0xcf)](0x2):'0',_0x5ed1b1=_0x3adcf3[_0x42e1a2]!==undefined?_0x3adcf3[_0x42e1a2][_0x149556(0xcf)](0x2):'0';_0x417239=parseFloat(_0x28dcc1)+parseFloat(_0x3d6b58),_0x3bbe80=parseFloat(_0x5da506)+parseFloat(_0x5ed1b1),_0x146fc0=parseFloat(_0x2fb8bb)+parseFloat(_0x4981ef),_0x21e4bd+=_0x149556(0x12d),_0x21e4bd+=_0x149556(0x12d),_0x21e4bd+=_0x149556(0x12d);}_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x1b8),_0x21e4bd+=_0x149556(0xdc),_0x21e4bd+=_0x149556(0x1d3);for(let _0x2f85a6=0x0;_0x2f85a6<=_0x262c73[_0x149556(0x22f)]['length']-0x1;_0x2f85a6++){const _0x136b42=_0x262c73[_0x149556(0x22f)][_0x2f85a6],_0x416297=_0x136b42[_0x149556(0x17c)][_0x149556(0x169)]+'-'+_0x136b42['_id'][_0x149556(0x195)];var _0x28dcc1=_0x27c926[_0x416297]!==undefined?_0x27c926[_0x416297][_0x149556(0xcf)](0x2):'0',_0x2fb8bb=_0x16eb01[_0x416297]!==undefined?_0x16eb01[_0x416297][_0x149556(0xcf)](0x2):'0',_0x5da506=_0x23aac5[_0x416297]!==undefined?_0x23aac5[_0x416297][_0x149556(0xcf)](0x2):'0',_0x3d6b58=_0x35512f[_0x416297]!==undefined?_0x35512f[_0x416297][_0x149556(0xcf)](0x2):'0',_0x4981ef=_0x43eb86[_0x416297]!==undefined?_0x43eb86[_0x416297][_0x149556(0xcf)](0x2):'0',_0x5ed1b1=_0x3adcf3[_0x416297]!==undefined?_0x3adcf3[_0x416297][_0x149556(0xcf)](0x2):'0';_0x417239=parseFloat(_0x28dcc1)+parseFloat(_0x3d6b58),_0x3bbe80=parseFloat(_0x5da506)+parseFloat(_0x5ed1b1),_0x146fc0=parseFloat(_0x2fb8bb)+parseFloat(_0x4981ef),_0x21e4bd+=_0x149556(0x12d),_0x21e4bd+=_0x149556(0x12d),_0x21e4bd+=_0x149556(0x12d);}_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x1b8),_0x21e4bd+=_0x149556(0x21f),_0x21e4bd+=_0x149556(0x1d3);for(let _0x9f45f4=0x0;_0x9f45f4<=_0x262c73['cat_brand'][_0x149556(0x13c)]-0x1;_0x9f45f4++){const _0x10c028=_0x262c73[_0x149556(0x22f)][_0x9f45f4],_0x2f809e=_0x10c028[_0x149556(0x17c)]['brand']+'-'+_0x10c028['_id']['category'];var _0x28dcc1=_0x27c926[_0x2f809e]!==undefined?_0x27c926[_0x2f809e][_0x149556(0xcf)](0x2):'',_0x2fb8bb=_0x16eb01[_0x2f809e]!==undefined?_0x16eb01[_0x2f809e][_0x149556(0xcf)](0x2):'',_0x5da506=_0x23aac5[_0x2f809e]!==undefined?_0x23aac5[_0x2f809e][_0x149556(0xcf)](0x2):'',_0x3d6b58=_0x35512f[_0x2f809e]!==undefined?_0x35512f[_0x2f809e][_0x149556(0xcf)](0x2):'',_0x4981ef=_0x43eb86[_0x2f809e]!==undefined?_0x43eb86[_0x2f809e][_0x149556(0xcf)](0x2):'',_0x5ed1b1=_0x3adcf3[_0x2f809e]!==undefined?_0x3adcf3[_0x2f809e][_0x149556(0xcf)](0x2):'';_0x417239=formatNumber(parseFloat(_0x28dcc1)+parseFloat(_0x3d6b58)),_0x3bbe80=formatNumber(parseFloat(_0x5da506)+parseFloat(_0x5ed1b1)),_0x146fc0=formatNumber(parseFloat(_0x2fb8bb)+parseFloat(_0x4981ef)),_0x21e4bd+=_0x149556(0x1ad)+_0x28dcc1+_0x149556(0x1ed),_0x21e4bd+=_0x149556(0x1ad)+_0x5da506+_0x149556(0x1ed),_0x21e4bd+=_0x149556(0x1ad)+_0x2fb8bb+'</b></td>';}_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1dc),_0x21e4bd+=_0x149556(0x1c9),_0x21e4bd+=_0x149556(0x1b8),_0x21e4bd+=_0x149556(0x22a),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x3b7031=0x0;_0x3b7031<=_0x262c73[_0x149556(0x22f)][_0x149556(0x13c)]-0x1;_0x3b7031++){const _0x4958a2=_0x262c73[_0x149556(0x22f)][_0x3b7031],_0x45bc46=_0x4958a2[_0x149556(0x17c)][_0x149556(0x169)]+'-'+_0x4958a2[_0x149556(0x17c)][_0x149556(0x195)];var _0x28dcc1=_0x27c926[_0x45bc46]!==undefined?_0x27c926[_0x45bc46][_0x149556(0xcf)](0x2):'0',_0x2fb8bb=_0x16eb01[_0x45bc46]!==undefined?_0x16eb01[_0x45bc46]['toFixed'](0x2):'0',_0x5da506=_0x23aac5[_0x45bc46]!==undefined?_0x23aac5[_0x45bc46][_0x149556(0xcf)](0x2):'0',_0x3d6b58=_0x35512f[_0x45bc46]!==undefined?_0x35512f[_0x45bc46][_0x149556(0xcf)](0x2):'0',_0x4981ef=_0x43eb86[_0x45bc46]!==undefined?_0x43eb86[_0x45bc46][_0x149556(0xcf)](0x2):'0',_0x5ed1b1=_0x3adcf3[_0x45bc46]!==undefined?_0x3adcf3[_0x45bc46][_0x149556(0xcf)](0x2):'0';_0x417239=parseFloat(_0x28dcc1)+parseFloat(_0x3d6b58),_0x3bbe80=parseFloat(_0x5da506)+parseFloat(_0x5ed1b1),_0x146fc0=parseFloat(_0x2fb8bb)+parseFloat(_0x4981ef),_0x21e4bd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x21e4bd+=_0x149556(0x12d),_0x21e4bd+=_0x149556(0x12d);}_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+=_0x149556(0x1d3),_0x21e4bd+='</tr>',_0x21e4bd+=_0x149556(0x10e),_0x21e4bd+=_0x149556(0x21b);}),_0x21e4bd;}async function generateReferenceNumber(_0x51c4bf,_0x212247,_0x1d01db){const _0x4e8a9e=a0_0x485df5,_0x2e2996=new Date(_0x51c4bf)[_0x4e8a9e(0x247)](),_0x4cb263=('0'+(new Date(_0x51c4bf)[_0x4e8a9e(0x1c8)]()+0x1))[_0x4e8a9e(0x184)](-0x2),_0x247c29=('0'+new Date(_0x51c4bf)[_0x4e8a9e(0x236)]())[_0x4e8a9e(0x184)](-0x2),_0x26df52=await staff[_0x4e8a9e(0x18b)]({'email':_0x1d01db[_0x4e8a9e(0xd5)]}),_0x3e74f8=_0x26df52[_0x4e8a9e(0x20a)],_0x218834=_0x3e74f8+'-'+_0x2e2996+_0x4cb263+_0x247c29,_0x1ef877=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x218834),'salesman_code':_0x3e74f8})[_0x4e8a9e(0x23b)]({'createdAt':-0x1}),_0x3c55e9=_0x218834;_0x1ef877&&(_0x3c55e9=_0x1ef877[_0x4e8a9e(0x1f1)]);console['log'](_0x3c55e9);const _0x473d19=new Reference({'referenceNumber':_0x3c55e9,'staff_id':_0x212247,'salesman_code':_0x3e74f8});return await _0x473d19[_0x4e8a9e(0x16b)](),_0x3c55e9;}router[a0_0x485df5(0x244)]('/dsrr/pdf',auth,async(_0x2fcd81,_0x43f50d)=>{const _0x5ae18a=a0_0x485df5,{from_date:_0x255596,dataview:_0x176687}=_0x2fcd81[_0x5ae18a(0x18a)],_0x291bc6=_0x2fcd81[_0x5ae18a(0x128)],_0x43082d=await staff['findOne']({'email':_0x291bc6['email']}),_0x32729a=await master_shop[_0x5ae18a(0x164)](),_0x52b0ef='';var _0x526bea=new Date(_0x255596);const _0x3d229a={'year':_0x5ae18a(0x1f2),'month':_0x5ae18a(0x137),'day':_0x5ae18a(0x1f2)},_0x23317b=new Intl[(_0x5ae18a(0x11a))](_0x5ae18a(0x24b),_0x3d229a)[_0x5ae18a(0x1c3)](_0x526bea),_0x577717=await Reference[_0x5ae18a(0x164)]({'staff_id':_0x43082d[_0x5ae18a(0x17c)][_0x5ae18a(0x227)](),'date_include':_0x255596});if(_0x577717[_0x5ae18a(0x13c)]>0x0){let _0x51856e='';_0x51856e+=_0x577717[0x0][_0x5ae18a(0x16e)];if(_0x176687==_0x5ae18a(0x12c)){const _0x47968d=cheerio[_0x5ae18a(0x146)](_0x51856e);let _0x3af356=[],_0x48c80b=[],_0x4f1927=[];const _0x3e9aec=_0x362203=>{const _0x544f34=_0x5ae18a,_0x37a88b={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0x544f34(0xd4),'color':{'rgb':_0x544f34(0x1de)}},'left':{'style':_0x544f34(0xd4),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x544f34(0x1de)}}};if(_0x362203){const _0x44e2bc=_0x362203[_0x544f34(0x1e0)](';')['reduce']((_0x37a9af,_0x5dd52a)=>{const _0x12db47=_0x544f34,[_0x5badb6,_0x2c7815]=_0x5dd52a[_0x12db47(0x1e0)](':')['map'](_0x530b1e=>_0x530b1e['trim']());return _0x37a9af[_0x5badb6]=_0x2c7815,_0x37a9af;},{});_0x44e2bc['border-top']&&(_0x37a88b['top'][_0x544f34(0xe4)]=_0x44e2bc['border-top'][_0x544f34(0x115)]('thin')?'thin':'medium'),_0x44e2bc[_0x544f34(0x14c)]&&(_0x37a88b['bottom'][_0x544f34(0xe4)]=_0x44e2bc[_0x544f34(0x14c)][_0x544f34(0x115)](_0x544f34(0x237))?_0x544f34(0x237):_0x544f34(0x21e)),_0x44e2bc[_0x544f34(0x102)]&&(_0x37a88b[_0x544f34(0x223)][_0x544f34(0xe4)]=_0x44e2bc[_0x544f34(0x102)][_0x544f34(0x115)](_0x544f34(0x237))?_0x544f34(0x237):_0x544f34(0x21e)),_0x44e2bc[_0x544f34(0x19f)]&&(_0x37a88b['right'][_0x544f34(0xe4)]=_0x44e2bc['border-right']['includes']('thin')?'thin':_0x544f34(0x21e));}return _0x37a88b;};_0x47968d(_0x5ae18a(0x16f))[_0x5ae18a(0x142)]((_0x5f17d5,_0x1e7683)=>{const _0xaf2b45=_0x5ae18a;let _0x21bbd9=[],_0x9c15d0=0x0;while(_0x4f1927[_0x9c15d0]){_0x4f1927[_0x9c15d0]--,_0x9c15d0++;}_0x47968d(_0x1e7683)['find']('td,\x20th')[_0xaf2b45(0x142)]((_0x244629,_0x526475)=>{const _0xa7e882=_0xaf2b45;let _0x4f975d=_0x47968d(_0x526475)[_0xa7e882(0x12a)]()[_0xa7e882(0x175)](),_0x7b9215=parseFloat(_0x4f975d[_0xa7e882(0x23c)](/,/g,''));isNaN(_0x7b9215)&&(_0x7b9215=_0x4f975d);let _0x2cb9f7=parseInt(_0x47968d(_0x526475)[_0xa7e882(0x166)](_0xa7e882(0xd3)))||0x1,_0x5708bf=parseInt(_0x47968d(_0x526475)[_0xa7e882(0x166)](_0xa7e882(0xf1)))||0x1;const _0x2af05f=_0x47968d(_0x526475)['attr'](_0xa7e882(0xe4)),_0x551623=_0x3e9aec(_0x2af05f);_0x21bbd9[_0x9c15d0]={'v':_0x7b9215,'s':{'border':_0x551623}};(_0x2cb9f7>0x1||_0x5708bf>0x1)&&_0x48c80b[_0xa7e882(0x124)]({'s':{'r':_0x5f17d5,'c':_0x9c15d0},'e':{'r':_0x5f17d5+_0x5708bf-0x1,'c':_0x9c15d0+_0x2cb9f7-0x1}});for(let _0x4603f5=0x0;_0x4603f5<_0x2cb9f7;_0x4603f5++){_0x5708bf>0x1&&(_0x4f1927[_0x9c15d0+_0x4603f5]=_0x5708bf-0x1);}_0x9c15d0+=_0x2cb9f7;}),_0x3af356[_0xaf2b45(0x124)](_0x21bbd9);});const _0x139464=XLSX[_0x5ae18a(0x1d6)]['book_new'](),_0x6d723b=XLSX['utils'][_0x5ae18a(0x148)](_0x3af356);_0x48c80b[_0x5ae18a(0x13c)]>0x0&&(_0x6d723b[_0x5ae18a(0x1ab)]=_0x48c80b);_0x6d723b[_0x5ae18a(0x231)]=_0x3af356[0x0][_0x5ae18a(0x110)](()=>({'wpx':0x64})),XLSX[_0x5ae18a(0x1d6)][_0x5ae18a(0x125)](_0x139464,_0x6d723b,_0x5ae18a(0x1f0));const _0x51482c=XLSX['write'](_0x139464,{'bookType':'xlsx','type':_0x5ae18a(0x18d)});_0x43f50d['setHeader'](_0x5ae18a(0xf3),_0x5ae18a(0x140)),_0x43f50d['setHeader'](_0x5ae18a(0x13e),_0x5ae18a(0x21d)),_0x43f50d['send'](_0x51482c);}else{let _0x5f33cb='';_0x5f33cb+=_0x51856e,_0x5f33cb+=_0x5ae18a(0x24c),_0x5f33cb+=_0x5ae18a(0x10d),_0x5f33cb+=_0x5ae18a(0x196),_0x5f33cb+='};',_0x5f33cb+=_0x5ae18a(0x1ec),_0x43f50d[_0x5ae18a(0x16d)](_0x5f33cb);}}else generateReferenceNumber(_0x255596,_0x43082d[_0x5ae18a(0x17c)][_0x5ae18a(0x227)](),_0x291bc6)[_0x5ae18a(0x1f9)](async _0x21e8b9=>{const _0x3038a9=_0x5ae18a,_0xdd9d14=await agentsdataDSICheck_DSRR(_0x255596,_0x43082d['_id']['valueOf'](),_0x52b0ef,_0x21e8b9);console[_0x3038a9(0xeb)](_0xdd9d14);let _0x2e5a20='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x2e5a20+=_0x3038a9(0x1cb),_0x2e5a20+=_0x3038a9(0xee),_0x2e5a20+=_0x3038a9(0x18f),_0x2e5a20+=_0xdd9d14,_0x2e5a20+='</table>',_0x2e5a20+=_0x3038a9(0x11d),_0x2e5a20+=_0x3038a9(0x11d);if(_0xdd9d14[_0x3038a9(0x13c)]>0x0){const _0x428b74=await Reference[_0x3038a9(0x18b)]({'staff_id':_0x43082d['_id'][_0x3038a9(0x227)](),'referenceNumber':_0x21e8b9});_0x428b74[_0x3038a9(0x16e)]=_0x2e5a20,_0x428b74[_0x3038a9(0x205)]=_0x255596,await _0x428b74['save']();if(_0x176687==_0x3038a9(0x12c)){const _0x2a88f7=cheerio[_0x3038a9(0x146)](_0x2e5a20);let _0x1139b4=[],_0x3ee33f=[],_0x2e6ce6=[];const _0x5a27b0=_0x5319e5=>{const _0x400649=_0x3038a9,_0x532fe9={'top':{'style':'thick','color':{'rgb':_0x400649(0x1de)}},'bottom':{'style':_0x400649(0xd4),'color':{'rgb':_0x400649(0x1de)}},'left':{'style':'thick','color':{'rgb':_0x400649(0x1de)}},'right':{'style':_0x400649(0xd4),'color':{'rgb':_0x400649(0x1de)}}};if(_0x5319e5){const _0x28d4c8=_0x5319e5['split'](';')[_0x400649(0x17d)]((_0x1bd9a5,_0x403ed0)=>{const _0x369812=_0x400649,[_0x257560,_0x3d58af]=_0x403ed0[_0x369812(0x1e0)](':')[_0x369812(0x110)](_0x406084=>_0x406084['trim']());return _0x1bd9a5[_0x257560]=_0x3d58af,_0x1bd9a5;},{});_0x28d4c8[_0x400649(0x1e5)]&&(_0x532fe9['top'][_0x400649(0xe4)]=_0x28d4c8['border-top'][_0x400649(0x115)](_0x400649(0x237))?_0x400649(0x237):_0x400649(0x21e)),_0x28d4c8[_0x400649(0x14c)]&&(_0x532fe9[_0x400649(0x207)]['style']=_0x28d4c8[_0x400649(0x14c)][_0x400649(0x115)](_0x400649(0x237))?_0x400649(0x237):_0x400649(0x21e)),_0x28d4c8[_0x400649(0x102)]&&(_0x532fe9[_0x400649(0x223)][_0x400649(0xe4)]=_0x28d4c8['border-left']['includes'](_0x400649(0x237))?'thin':'medium'),_0x28d4c8[_0x400649(0x19f)]&&(_0x532fe9['right'][_0x400649(0xe4)]=_0x28d4c8[_0x400649(0x19f)][_0x400649(0x115)](_0x400649(0x237))?'thin':_0x400649(0x21e));}return _0x532fe9;};_0x2a88f7(_0x3038a9(0x16f))[_0x3038a9(0x142)]((_0x31803d,_0x5008ed)=>{const _0x53468e=_0x3038a9;let _0x5066ca=[],_0x310a7a=0x0;while(_0x2e6ce6[_0x310a7a]){_0x2e6ce6[_0x310a7a]--,_0x310a7a++;}_0x2a88f7(_0x5008ed)[_0x53468e(0x164)](_0x53468e(0xe5))[_0x53468e(0x142)]((_0x3ade93,_0x1bbf1b)=>{const _0x2635f5=_0x53468e;let _0x4796b0=_0x2a88f7(_0x1bbf1b)[_0x2635f5(0x12a)]()[_0x2635f5(0x175)](),_0x5b7a81=parseFloat(_0x4796b0[_0x2635f5(0x23c)](/,/g,''));isNaN(_0x5b7a81)&&(_0x5b7a81=_0x4796b0);let _0xcab7cf=parseInt(_0x2a88f7(_0x1bbf1b)[_0x2635f5(0x166)](_0x2635f5(0xd3)))||0x1,_0x30f220=parseInt(_0x2a88f7(_0x1bbf1b)[_0x2635f5(0x166)](_0x2635f5(0xf1)))||0x1;const _0x5ea5a6=_0x2a88f7(_0x1bbf1b)[_0x2635f5(0x166)]('style'),_0x161834=_0x5a27b0(_0x5ea5a6);_0x5066ca[_0x310a7a]={'v':_0x5b7a81,'s':{'border':_0x161834}};(_0xcab7cf>0x1||_0x30f220>0x1)&&_0x3ee33f['push']({'s':{'r':_0x31803d,'c':_0x310a7a},'e':{'r':_0x31803d+_0x30f220-0x1,'c':_0x310a7a+_0xcab7cf-0x1}});for(let _0x3cb239=0x0;_0x3cb239<_0xcab7cf;_0x3cb239++){_0x30f220>0x1&&(_0x2e6ce6[_0x310a7a+_0x3cb239]=_0x30f220-0x1);}_0x310a7a+=_0xcab7cf;}),_0x1139b4[_0x53468e(0x124)](_0x5066ca);});const _0x244826=XLSX[_0x3038a9(0x1d6)]['book_new'](),_0x323311=XLSX[_0x3038a9(0x1d6)][_0x3038a9(0x148)](_0x1139b4);_0x3ee33f['length']>0x0&&(_0x323311['!merges']=_0x3ee33f);_0x323311[_0x3038a9(0x231)]=_0x1139b4[0x0][_0x3038a9(0x110)](()=>({'wpx':0x64})),XLSX[_0x3038a9(0x1d6)][_0x3038a9(0x125)](_0x244826,_0x323311,_0x3038a9(0x1f0));const _0x38930e=XLSX['write'](_0x244826,{'bookType':'xlsx','type':_0x3038a9(0x18d)});_0x43f50d[_0x3038a9(0xf9)]('Content-Disposition',_0x3038a9(0x140)),_0x43f50d['setHeader'](_0x3038a9(0x13e),_0x3038a9(0x21d)),_0x43f50d[_0x3038a9(0x16d)](_0x38930e);}else _0x2e5a20+=_0x3038a9(0x24c),_0x2e5a20+='window.onload\x20=\x20function()\x20{',_0x2e5a20+=_0x3038a9(0x196),_0x2e5a20+='};',_0x2e5a20+='</script>',_0x43f50d['send'](_0x2e5a20);}else await Reference[_0x3038a9(0x200)]({'referenceNumber':_0x21e8b9}),_0x2fcd81[_0x3038a9(0x183)]('errors',_0x3038a9(0xe8)),_0x43f50d['redirect'](_0x3038a9(0x139));})[_0x5ae18a(0x123)](console['error']);}),router[a0_0x485df5(0x145)](a0_0x485df5(0x147),auth,async(_0x452652,_0x58a6f5)=>{const _0x135b78=a0_0x485df5;try{const {username:_0x514f7b,email:_0x112e34,role:_0x381cda}=_0x452652['user'],_0x3a0797=_0x452652[_0x135b78(0x128)],_0x4f15c6=await profile['findOne']({'email':_0x3a0797[_0x135b78(0xd5)]}),_0x14006e={'year':_0x135b78(0x1f2),'month':_0x135b78(0x137),'day':_0x135b78(0x1f2)},_0x11699a=await master_shop[_0x135b78(0x164)]();console[_0x135b78(0xeb)]('Products\x20master',_0x11699a);const _0x2cf544=await product[_0x135b78(0x164)]();console[_0x135b78(0xeb)]('Products\x20find_data',_0x2cf544);const _0x3afcc6=await warehouse[_0x135b78(0xfe)]([{'$unwind':_0x135b78(0x156)},{'$lookup':{'from':_0x135b78(0x111),'localField':_0x135b78(0x14f),'foreignField':_0x135b78(0x248),'as':_0x135b78(0x1e3)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x135b78(0x134),'product_stock':_0x135b78(0x204)}},{'$group':{'_id':_0x135b78(0x154),'product_stock':{'$sum':'$product_stock'}}}]);console['log'](_0x135b78(0x155),_0x3afcc6),_0x3afcc6[_0x135b78(0x181)](_0xb5b4e4=>{const _0x39d932=_0x135b78,_0x3b34a3=_0x2cf544[_0x39d932(0x110)](_0x4b2693=>{const _0x2ebae5=_0x39d932;_0x4b2693['name']==_0xb5b4e4[_0x2ebae5(0x17c)]&&(_0x4b2693['stock']=parseInt(_0x4b2693[_0x2ebae5(0x1ba)])+parseInt(_0xb5b4e4[_0x2ebae5(0x19a)]));});});const _0x211f56=await staff[_0x135b78(0x164)]({'account_category':'sa','type_of_acc_cat':'1'}),_0xa6c555=await staff[_0x135b78(0x18b)]({'email':_0x3a0797[_0x135b78(0xd5)]});if(_0x11699a[0x0]['language']==_0x135b78(0x133))var _0x2fed30=users['English'];else{if(_0x11699a[0x0][_0x135b78(0x1b1)]==_0x135b78(0xfd))var _0x2fed30=users['Hindi'];else{if(_0x11699a[0x0][_0x135b78(0x1b1)]==_0x135b78(0x20b))var _0x2fed30=users[_0x135b78(0x20b)];else{if(_0x11699a[0x0][_0x135b78(0x1b1)]==_0x135b78(0x1fb))var _0x2fed30=users[_0x135b78(0x1fb)];else{if(_0x11699a[0x0][_0x135b78(0x1b1)]==_0x135b78(0x130))var _0x2fed30=users[_0x135b78(0x130)];else{if(_0x11699a[0x0][_0x135b78(0x1b1)]==_0x135b78(0x15c))var _0x2fed30=users[_0x135b78(0x1b0)];else{if(_0x11699a[0x0][_0x135b78(0x1b1)]==_0x135b78(0x19d))var _0x2fed30=users['Chinese'];else{if(_0x11699a[0x0]['language']=='Arabic\x20(ae)')var _0x2fed30=users[_0x135b78(0x1a0)];}}}}}}}_0x58a6f5[_0x135b78(0x1cc)]('dssr_view_admin',{'success':_0x452652[_0x135b78(0x183)]('success'),'errors':_0x452652['flash'](_0x135b78(0x1d5)),'alldata':_0x2cf544,'profile':_0x4f15c6,'master_shop':_0x11699a,'role':_0x3a0797,'product_stock':_0x3afcc6,'language':_0x2fed30,'staff_arr':_0xa6c555,'staff_data_all':_0x211f56});}catch(_0x423306){}}),router[a0_0x485df5(0x244)]('/getDSSR_no',auth,async(_0x196ab8,_0x3f9377)=>{const _0x25881e=a0_0x485df5;try{const {from:_0x4d90fb,to:_0x38b4b7,staff_data:_0x4bedb}=_0x196ab8[_0x25881e(0x18a)],_0xecf648=await Reference[_0x25881e(0xfe)]([{'$match':{'date_include':{'$gte':_0x4d90fb,'$lte':_0x38b4b7},'staff_id':_0x4bedb}},{'$sort':{'date_include':0x1}}]);_0x3f9377[_0x25881e(0x1c4)](_0xecf648);}catch(_0x3f28c7){_0x3f9377[_0x25881e(0x1c4)](_0x3f28c7);}}),router[a0_0x485df5(0x244)](a0_0x485df5(0x151),auth,async(_0x5133af,_0x231eab)=>{const _0xd32475=a0_0x485df5;try{const {from:_0x4aeef4,to:_0x71c55c}=_0x5133af['body'],{sttaff_id:_0x35cab0}=_0x5133af[_0xd32475(0x128)],_0xd57d98=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x4aeef4,'$lte':_0x71c55c},'staff_id':_0x35cab0}},{'$sort':{'date_include':0x1}}]);_0x231eab[_0xd32475(0x1c4)](_0xd57d98);}catch(_0x3c38f4){_0x231eab[_0xd32475(0x1c4)](_0x3c38f4);}}),router[a0_0x485df5(0x145)](a0_0x485df5(0x119),auth,async(_0x349645,_0x38aa4b)=>{const _0x281994=a0_0x485df5;try{const _0x551135=_0x349645['params']['id'],_0x26f040=await Reference['findById'](_0x551135);let _0x28ffc0='';_0x28ffc0+=_0x26f040['html'],_0x28ffc0+=_0x281994(0x24c),_0x28ffc0+=_0x281994(0x10d),_0x28ffc0+=_0x281994(0x196),_0x28ffc0+='};',_0x28ffc0+=_0x281994(0x1ec),_0x38aa4b[_0x281994(0x16d)](_0x28ffc0);}catch(_0x3b8b0f){_0x38aa4b[_0x281994(0x1c4)](_0x3b8b0f);}}),router[a0_0x485df5(0x244)](a0_0x485df5(0x1f4),auth,async(_0x1d2109,_0x40efb5)=>{const _0x3a0995=a0_0x485df5;try{const {ref_data:_0x2035c3}=_0x1d2109[_0x3a0995(0x18a)],_0x2b3112=_0x2035c3[_0x3a0995(0x1e0)]('~'),_0x1a6e24=_0x2b3112[_0x3a0995(0x225)](_0x52fc24=>_0x52fc24!==''),_0x16531a=await Reference[_0x3a0995(0xfe)]([{'$match':{'referenceNumber':{'$in':_0x1a6e24}}}]),_0x5768b4=XLSX[_0x3a0995(0x1d6)][_0x3a0995(0xcd)]();_0x16531a[_0x3a0995(0x181)](_0x3a91ab=>{const _0x3a0676=_0x3a0995,_0x326bfa=cheerio[_0x3a0676(0x146)](_0x3a91ab[_0x3a0676(0x16e)]);let _0x10690e=[],_0x429181=[],_0x348eaa=[];_0x326bfa(_0x3a0676(0x16f))[_0x3a0676(0x142)]((_0x2cb6a6,_0x4f7ce1)=>{const _0x3caacb=_0x3a0676;let _0x4ce59a=[],_0x7e67f1=0x0;while(_0x348eaa[_0x7e67f1]){_0x348eaa[_0x7e67f1]--,_0x7e67f1++;}_0x326bfa(_0x4f7ce1)['find'](_0x3caacb(0xe5))[_0x3caacb(0x142)]((_0x3aca42,_0x418307)=>{const _0xe8758b=_0x3caacb;let _0xfde8ff=_0x326bfa(_0x418307)['text']()[_0xe8758b(0x175)](),_0x2fb2a7=parseFloat(_0xfde8ff[_0xe8758b(0x23c)](/,/g,''));isNaN(_0x2fb2a7)&&(_0x2fb2a7=_0xfde8ff);let _0x3971f8=parseInt(_0x326bfa(_0x418307)[_0xe8758b(0x166)](_0xe8758b(0xd3)))||0x1,_0x330d7c=parseInt(_0x326bfa(_0x418307)[_0xe8758b(0x166)](_0xe8758b(0xf1)))||0x1;_0x4ce59a[_0x7e67f1]=_0x2fb2a7;(_0x3971f8>0x1||_0x330d7c>0x1)&&_0x429181[_0xe8758b(0x124)]({'s':{'r':_0x2cb6a6,'c':_0x7e67f1},'e':{'r':_0x2cb6a6+_0x330d7c-0x1,'c':_0x7e67f1+_0x3971f8-0x1}});for(let _0x18c4ea=0x0;_0x18c4ea<_0x3971f8;_0x18c4ea++){_0x330d7c>0x1&&(_0x348eaa[_0x7e67f1+_0x18c4ea]=_0x330d7c-0x1);}_0x7e67f1+=_0x3971f8;}),_0x10690e[_0x3caacb(0x124)](_0x4ce59a);});const _0x18a604=XLSX[_0x3a0676(0x1d6)]['aoa_to_sheet'](_0x10690e);_0x429181[_0x3a0676(0x13c)]>0x0&&(_0x18a604[_0x3a0676(0x1ab)]=_0x429181),_0x18a604[_0x3a0676(0x231)]=_0x10690e[0x0][_0x3a0676(0x110)](()=>({'wpx':0x64})),XLSX[_0x3a0676(0x1d6)][_0x3a0676(0x125)](_0x5768b4,_0x18a604,_0x3a91ab['referenceNumber']);});const _0x28b82d=XLSX[_0x3a0995(0x136)](_0x5768b4,{'bookType':_0x3a0995(0x121),'type':_0x3a0995(0x18d)});_0x40efb5[_0x3a0995(0xf9)](_0x3a0995(0xf3),_0x3a0995(0xef)),_0x40efb5['setHeader'](_0x3a0995(0x13e),_0x3a0995(0x21d)),_0x40efb5[_0x3a0995(0x16d)](_0x28b82d);}catch(_0x95ce88){_0x40efb5[_0x3a0995(0x1c4)](_0x95ce88);}}),router[a0_0x485df5(0x244)](a0_0x485df5(0x22c),auth,async(_0x3479ef,_0x5a47d1)=>{const _0x27317c=a0_0x485df5,{from_date:_0x29fd34,agent_id:_0x1f65b5}=_0x3479ef['body'],_0x55bdcc=_0x3479ef['user'],_0x31b0ed=await staff[_0x27317c(0x18b)]({'email':_0x55bdcc[_0x27317c(0xd5)]}),_0x120110=await master_shop['find'](),_0x5d03e6=await agentsdataDSICheck_DSRR(_0x29fd34,_0x1f65b5,_0x521a5b);let _0x5715ab=_0x27317c(0x174);var _0x50d154=new Date(_0x29fd34);const _0x294d53={'year':_0x27317c(0x1f2),'month':_0x27317c(0x137),'day':'numeric'},_0x190f9b=new Intl[(_0x27317c(0x11a))](_0x27317c(0x24b),_0x294d53)[_0x27317c(0x1c3)](_0x50d154);_0x5715ab+=_0x27317c(0x1cb),_0x5715ab+='<div\x20\x20id=\x22table-conatainer\x22>',_0x5715ab+=_0x27317c(0x18f),_0x5715ab+=_0x5d03e6,_0x5715ab+=_0x27317c(0x21b),_0x5715ab+='</div>',_0x5715ab+=_0x27317c(0x11d);let _0x188473=_0x27317c(0x215);const _0x4a3628={'width':_0x27317c(0x10b),'height':_0x27317c(0x211),'orientation':'landscape','border':{'top':'0.1in','right':_0x27317c(0x117),'bottom':'0.1in','left':_0x27317c(0x117)},'header':{'height':_0x27317c(0x22b),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x188473+_0x27317c(0x233)+_0x190f9b+_0x27317c(0x113)},'footer':{'height':_0x27317c(0x187),'contents':{'default':_0x27317c(0x163)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x27317c(0x127)}}};var _0x521a5b='on';if(_0x521a5b=='on'){const _0x2ec5e8=cheerio['load'](_0x5715ab);let _0x27e348=[],_0x4ffef3=[],_0x10b4d0=[];_0x2ec5e8(_0x27317c(0x16f))[_0x27317c(0x142)]((_0x1f6642,_0x5e9621)=>{const _0x3acd57=_0x27317c;let _0x4fef5c=[],_0x420d71=0x0;while(_0x10b4d0[_0x420d71]){_0x10b4d0[_0x420d71]--,_0x420d71++;}_0x2ec5e8(_0x5e9621)[_0x3acd57(0x164)](_0x3acd57(0xe5))[_0x3acd57(0x142)]((_0x1effd3,_0x242abe)=>{const _0x37f55e=_0x3acd57;let _0x503954=_0x2ec5e8(_0x242abe)[_0x37f55e(0x12a)]()['trim'](),_0x53c69f=parseFloat(_0x503954['replace'](/,/g,''));isNaN(_0x53c69f)&&(_0x53c69f=_0x503954);let _0x1b0a43=parseInt(_0x2ec5e8(_0x242abe)['attr'](_0x37f55e(0xd3)))||0x1,_0x4aa8f6=parseInt(_0x2ec5e8(_0x242abe)[_0x37f55e(0x166)](_0x37f55e(0xf1)))||0x1;_0x4fef5c[_0x420d71]=_0x53c69f;(_0x1b0a43>0x1||_0x4aa8f6>0x1)&&_0x4ffef3[_0x37f55e(0x124)]({'s':{'r':_0x1f6642,'c':_0x420d71},'e':{'r':_0x1f6642+_0x4aa8f6-0x1,'c':_0x420d71+_0x1b0a43-0x1}});for(let _0x4dfa82=0x0;_0x4dfa82<_0x1b0a43;_0x4dfa82++){_0x4aa8f6>0x1&&(_0x10b4d0[_0x420d71+_0x4dfa82]=_0x4aa8f6-0x1);}_0x420d71+=_0x1b0a43;}),_0x27e348[_0x3acd57(0x124)](_0x4fef5c);});const _0x2ae533=XLSX[_0x27317c(0x1d6)][_0x27317c(0xcd)](),_0x4a475c=XLSX['utils']['aoa_to_sheet'](_0x27e348);_0x4ffef3[_0x27317c(0x13c)]>0x0&&(_0x4a475c[_0x27317c(0x1ab)]=_0x4ffef3);_0x4a475c['!cols']=_0x27e348[0x0][_0x27317c(0x110)](()=>({'wpx':0x64})),XLSX[_0x27317c(0x1d6)]['book_append_sheet'](_0x2ae533,_0x4a475c,_0x27317c(0x1f0));const _0x42fc60=XLSX[_0x27317c(0x136)](_0x2ae533,{'bookType':_0x27317c(0x121),'type':_0x27317c(0x18d)});_0x5a47d1['setHeader'](_0x27317c(0xf3),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x5a47d1[_0x27317c(0xf9)](_0x27317c(0x13e),_0x27317c(0x21d)),_0x5a47d1[_0x27317c(0x16d)](_0x42fc60);}else pdf[_0x27317c(0x15a)](_0x5715ab,_0x4a3628)[_0x27317c(0x189)](function(_0x1824ca,_0x3ec820){const _0x36e551=_0x27317c;if(_0x1824ca){_0x5a47d1[_0x36e551(0xd7)](0x1f4)[_0x36e551(0x16d)](_0x36e551(0x20c));return;}_0x5a47d1[_0x36e551(0xf9)](_0x36e551(0x13e),_0x36e551(0xf2)),_0x3ec820['pipe'](_0x5a47d1);});}),module[a0_0x485df5(0x230)]=router;