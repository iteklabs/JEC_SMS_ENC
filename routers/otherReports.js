const a0_0x2db209=a0_0x40c3;(function(_0x59aa34,_0x3ac9ce){const _0x42f911=a0_0x40c3,_0x227b6c=_0x59aa34();while(!![]){try{const _0x31c992=parseInt(_0x42f911(0x34d))/0x1+parseInt(_0x42f911(0x2d3))/0x2*(-parseInt(_0x42f911(0x2b2))/0x3)+parseInt(_0x42f911(0x36f))/0x4*(parseInt(_0x42f911(0x246))/0x5)+parseInt(_0x42f911(0x36d))/0x6*(-parseInt(_0x42f911(0x2d2))/0x7)+parseInt(_0x42f911(0x243))/0x8*(parseInt(_0x42f911(0x35d))/0x9)+parseInt(_0x42f911(0x33e))/0xa+-parseInt(_0x42f911(0x331))/0xb;if(_0x31c992===_0x3ac9ce)break;else _0x227b6c['push'](_0x227b6c['shift']());}catch(_0x17523c){_0x227b6c['push'](_0x227b6c['shift']());}}}(a0_0xec29,0x34c5c));const express=require(a0_0x2db209(0x373)),res=require('express/lib/response'),app=express(),router=express[a0_0x2db209(0x25e)](),multer=require(a0_0x2db209(0x37d)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x2db209(0x229)),auth=require(a0_0x2db209(0x2e2)),users=require(a0_0x2db209(0x20e)),excelJS=require('exceljs'),XLSX=require(a0_0x2db209(0x335)),PDFDocument=require(a0_0x2db209(0x356)),fs=require('fs'),blobStream=require(a0_0x2db209(0x34f)),JsBarcode=require('jsbarcode'),{Canvas}=require(a0_0x2db209(0x2c5)),pdf=require(a0_0x2db209(0x2ad)),path=require(a0_0x2db209(0x2f3)),mongoose=require(a0_0x2db209(0x23f)),cheerio=require(a0_0x2db209(0x27b));router['get'](a0_0x2db209(0x2c4),auth,async(_0x1c7297,_0x2800d0)=>{const _0x20eddb=a0_0x2db209;try{const {username:_0x5e759b,email:_0x10aa96,role:_0x1016ac}=_0x1c7297[_0x20eddb(0x334)],_0x46ba81=_0x1c7297[_0x20eddb(0x334)],_0x2c3752=await profile[_0x20eddb(0x2d1)]({'email':_0x46ba81[_0x20eddb(0x26a)]}),_0x3901be={'year':_0x20eddb(0x303),'month':_0x20eddb(0x369),'day':_0x20eddb(0x303)},_0x3ea553=await master_shop[_0x20eddb(0x214)]();console[_0x20eddb(0x365)](_0x20eddb(0x333),_0x3ea553);const _0x315792=await product[_0x20eddb(0x214)]();console[_0x20eddb(0x365)](_0x20eddb(0x247),_0x315792);const _0x180919=await warehouse[_0x20eddb(0x217)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x20eddb(0x352),'localField':_0x20eddb(0x337),'foreignField':_0x20eddb(0x2d9),'as':_0x20eddb(0x2e9)}},{'$unwind':_0x20eddb(0x34e)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x20eddb(0x226)}},{'$group':{'_id':_0x20eddb(0x290),'product_stock':{'$sum':_0x20eddb(0x2b4)}}}]);console[_0x20eddb(0x365)](_0x20eddb(0x2e0),_0x180919),_0x180919['forEach'](_0x56d5b2=>{const _0xcce995=_0x20eddb,_0x5b5525=_0x315792[_0xcce995(0x35b)](_0x12e9eb=>{const _0x16d784=_0xcce995;_0x12e9eb[_0x16d784(0x2d9)]==_0x56d5b2[_0x16d784(0x239)]&&(_0x12e9eb['stock']=parseInt(_0x12e9eb[_0x16d784(0x26b)])+parseInt(_0x56d5b2['product_stock']));});}),console[_0x20eddb(0x365)]('Products\x20find_data',_0x315792);if(_0x3ea553[0x0]['language']=='English\x20(US)')var _0x2040ac=users[_0x20eddb(0x2b3)];else{if(_0x3ea553[0x0][_0x20eddb(0x252)]==_0x20eddb(0x231))var _0x2040ac=users[_0x20eddb(0x231)];else{if(_0x3ea553[0x0]['language']==_0x20eddb(0x265))var _0x2040ac=users[_0x20eddb(0x265)];else{if(_0x3ea553[0x0]['language']==_0x20eddb(0x320))var _0x2040ac=users[_0x20eddb(0x320)];else{if(_0x3ea553[0x0][_0x20eddb(0x252)]==_0x20eddb(0x32e))var _0x2040ac=users[_0x20eddb(0x32e)];else{if(_0x3ea553[0x0][_0x20eddb(0x252)]==_0x20eddb(0x2bc))var _0x2040ac=users[_0x20eddb(0x253)];else{if(_0x3ea553[0x0]['language']=='Chinese')var _0x2040ac=users[_0x20eddb(0x258)];else{if(_0x3ea553[0x0][_0x20eddb(0x252)]==_0x20eddb(0x2cf))var _0x2040ac=users[_0x20eddb(0x260)];}}}}}}}_0x2800d0[_0x20eddb(0x2cc)]('balanced',{'success':_0x1c7297[_0x20eddb(0x341)]('success'),'errors':_0x1c7297[_0x20eddb(0x341)]('errors'),'alldata':_0x315792,'profile':_0x2c3752,'master_shop':_0x3ea553,'role':_0x46ba81,'product_stock':_0x180919,'language':_0x2040ac});}catch(_0x474f73){}});async function dataCheck(_0x53384e,_0x4fe70e){const _0x2ecd81=a0_0x2db209,_0x1b6b66=await product[_0x2ecd81(0x217)]([{'$group':{'_id':{'brand':_0x2ecd81(0x286),'category':_0x2ecd81(0x363)},'products':{'$push':{'name':_0x2ecd81(0x34c),'product_code':_0x2ecd81(0x23e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x229780=[];_0x229780[_0x2ecd81(0x366)]=[];for(let _0x13edac=0x0;_0x13edac<=_0x1b6b66[_0x2ecd81(0x205)]-0x1;_0x13edac++){const _0x7210f9=_0x1b6b66[_0x13edac];_0x229780[_0x2ecd81(0x366)][_0x2ecd81(0x28d)](_0x7210f9);}const _0x14da54=await product[_0x2ecd81(0x217)]([{'$group':{'_id':{'category':_0x2ecd81(0x363)},'products':{'$push':{'brand':_0x2ecd81(0x286),'product_code':_0x2ecd81(0x23e),'product_name':_0x2ecd81(0x34c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5231f2=await purchases_finished[_0x2ecd81(0x217)]([{'$match':{'date':{'$gte':_0x53384e,'$lte':_0x4fe70e}}},{'$unwind':'$product'},{'$group':{'_id':{'product_name':_0x2ecd81(0x2ab),'product_code':_0x2ecd81(0x279)},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x229780[_0x2ecd81(0x375)]=[];for(let _0xba7b95=0x0;_0xba7b95<=_0x5231f2[_0x2ecd81(0x205)]-0x1;_0xba7b95++){const _0x5ab257=_0x5231f2[_0xba7b95];_0x229780[_0x2ecd81(0x375)][_0x2ecd81(0x28d)](_0x5ab257);}const _0x3301df=await sales_sa[_0x2ecd81(0x217)]([{'$match':{'date':{'$gte':_0x53384e,'$lte':_0x4fe70e}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x2ecd81(0x232)}}},{'$lookup':{'from':_0x2ecd81(0x2d7),'localField':_0x2ecd81(0x29e),'foreignField':'_id','as':'sales_info'}},{'$unwind':_0x2ecd81(0x22c)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x2ecd81(0x220),'product_code':_0x2ecd81(0x271)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console[_0x2ecd81(0x365)](_0x3301df[0x0]),_0x229780[_0x2ecd81(0x370)]=[];for(let _0x1d1eb6=0x0;_0x1d1eb6<=_0x3301df[_0x2ecd81(0x205)]-0x1;_0x1d1eb6++){const _0x2a6d9e=_0x3301df[_0x1d1eb6];_0x229780[_0x2ecd81(0x370)][_0x2ecd81(0x28d)](_0x2a6d9e);}const _0x2161b9=await sales_sa[_0x2ecd81(0x217)]([{'$match':{'date':{'$gte':_0x53384e,'$lte':_0x4fe70e}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x2ecd81(0x232)}}},{'$lookup':{'from':'staffs','localField':_0x2ecd81(0x29e),'foreignField':_0x2ecd81(0x239),'as':_0x2ecd81(0x31b)}},{'$unwind':'$sales_info'},{'$unwind':_0x2ecd81(0x332)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x2ecd81(0x26d)}},{'$group':{'_id':{'product_name':_0x2ecd81(0x220),'product_code':_0x2ecd81(0x271)},'totalQTY':{'$sum':_0x2ecd81(0x33b)}}}]);_0x229780[_0x2ecd81(0x301)]=[];for(let _0x305752=0x0;_0x305752<=_0x2161b9['length']-0x1;_0x305752++){const _0x4995bf=_0x2161b9[_0x305752];_0x229780[_0x2ecd81(0x301)]['push'](_0x4995bf);}let _0x2edd2b='';for(let _0x583d76=0x0;_0x583d76<=_0x14da54['length']-0x1;_0x583d76++){const _0x4d8ae3=_0x14da54[_0x583d76];_0x2edd2b+=_0x2ecd81(0x354),_0x2edd2b+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x4d8ae3[_0x2ecd81(0x239)][_0x2ecd81(0x248)]+_0x2ecd81(0x206),_0x2edd2b+='</tr>';for(let _0x2003dd=0x0;_0x2003dd<_0x229780['cat_brand'][_0x2ecd81(0x205)];_0x2003dd++){const _0x329f78=_0x229780[_0x2ecd81(0x366)][_0x2003dd];if(_0x329f78[_0x2ecd81(0x239)][_0x2ecd81(0x248)]==_0x4d8ae3['_id'][_0x2ecd81(0x248)]){let _0x16232b=[],_0x109894=[],_0x97cc9d=[];_0x16232b[_0x329f78[_0x2ecd81(0x239)][_0x2ecd81(0x327)]]=[],_0x109894[_0x329f78[_0x2ecd81(0x239)]['brand']]=[],_0x97cc9d[_0x329f78[_0x2ecd81(0x239)][_0x2ecd81(0x327)]]=[];var _0x1f09f6=0x0,_0x470c56=0x0,_0x4786b0=0x0;for(let _0x45cefd=0x0;_0x45cefd<_0x329f78['products'][_0x2ecd81(0x205)];_0x45cefd++){const _0x240c12=_0x329f78[_0x2ecd81(0x352)][_0x45cefd];for(let _0x228f0f=0x0;_0x228f0f<=_0x229780[_0x2ecd81(0x375)][_0x2ecd81(0x205)]-0x1;_0x228f0f++){const _0x23dc9e=_0x229780[_0x2ecd81(0x375)][_0x228f0f];_0x23dc9e[_0x2ecd81(0x239)][_0x2ecd81(0x22e)]==_0x240c12['name']&&_0x23dc9e[_0x2ecd81(0x239)]['product_code']==_0x240c12['product_code']&&(_0x1f09f6+=parseInt(_0x23dc9e[_0x2ecd81(0x216)],0xa));}for(let _0x3d7acb=0x0;_0x3d7acb<=_0x229780[_0x2ecd81(0x301)][_0x2ecd81(0x205)]-0x1;_0x3d7acb++){const _0x98c936=_0x229780['sales_ext'][_0x3d7acb];_0x98c936[_0x2ecd81(0x239)][_0x2ecd81(0x22e)]==_0x240c12[_0x2ecd81(0x2d9)]&&_0x98c936[_0x2ecd81(0x239)]['product_code']==_0x240c12[_0x2ecd81(0x32f)]&&(_0x470c56+=parseFloat(_0x98c936['totalQTY'],0xa)['toFixed'](0x2));}for(let _0x21aefb=0x0;_0x21aefb<=_0x229780[_0x2ecd81(0x370)]['length']-0x1;_0x21aefb++){const _0x4889bf=_0x229780[_0x2ecd81(0x370)][_0x21aefb];_0x4889bf[_0x2ecd81(0x239)][_0x2ecd81(0x22e)]==_0x240c12[_0x2ecd81(0x2d9)]&&_0x4889bf[_0x2ecd81(0x239)][_0x2ecd81(0x32f)]==_0x240c12[_0x2ecd81(0x32f)]&&(_0x4786b0+=parseInt(_0x4889bf['totalQTY'],0xa));}}const _0x40667a=new Intl[(_0x2ecd81(0x33f))](_0x2ecd81(0x234));var _0x4e6870=_0x40667a['format'](_0x1f09f6);_0x16232b[_0x329f78[_0x2ecd81(0x239)][_0x2ecd81(0x327)]][_0x2ecd81(0x28d)](_0x4e6870),_0x109894[_0x329f78[_0x2ecd81(0x239)][_0x2ecd81(0x327)]][_0x2ecd81(0x28d)](_0x40667a[_0x2ecd81(0x203)](_0x470c56)),_0x97cc9d[_0x329f78[_0x2ecd81(0x239)]['brand']]['push'](_0x40667a[_0x2ecd81(0x203)](_0x4786b0));var _0x1086ba=_0x40667a[_0x2ecd81(0x203)](_0x1f09f6-(_0x4786b0+_0x470c56));_0x2edd2b+=_0x2ecd81(0x354),_0x2edd2b+=_0x2ecd81(0x2a7),_0x2edd2b+='<td\x20class=\x22row_data\x22>'+_0x329f78[_0x2ecd81(0x239)][_0x2ecd81(0x327)]+'</td>',_0x2edd2b+=_0x2ecd81(0x2ee)+_0x16232b[_0x329f78[_0x2ecd81(0x239)]['brand']][0x0]+_0x2ecd81(0x206),_0x2edd2b+=_0x2ecd81(0x30f),_0x2edd2b+=_0x2ecd81(0x2ee)+_0x97cc9d[_0x329f78[_0x2ecd81(0x239)]['brand']][0x0]+_0x2ecd81(0x206),_0x2edd2b+=_0x2ecd81(0x2ee)+_0x109894[_0x329f78['_id'][_0x2ecd81(0x327)]][0x0]+_0x2ecd81(0x206),_0x2edd2b+=_0x2ecd81(0x2ee)+_0x1086ba+_0x2ecd81(0x206),_0x2edd2b+=_0x2ecd81(0x2a5);}}}return console[_0x2ecd81(0x365)](_0x229780[_0x2ecd81(0x370)]),_0x2edd2b;}router['post'](a0_0x2db209(0x211),auth,async(_0x1f49d7,_0x3599cb)=>{const _0x81ab96=a0_0x2db209,{from_date:_0x2762e4,to_date:_0x2bcd68}=_0x1f49d7[_0x81ab96(0x300)],_0x5de896=await dataCheck(_0x2762e4,_0x2bcd68);{}let _0x45dd98=_0x81ab96(0x36b);var _0x50a027=new Date(_0x2762e4),_0x5f5978=new Date(_0x2bcd68);const _0x1d5ce9={'year':'numeric','month':_0x81ab96(0x369),'day':_0x81ab96(0x303)},_0x2484bf=new Intl[(_0x81ab96(0x208))](_0x81ab96(0x234),_0x1d5ce9)[_0x81ab96(0x203)](_0x50a027),_0xef0530=new Intl['DateTimeFormat']('en-US',_0x1d5ce9)[_0x81ab96(0x203)](_0x5f5978);_0x45dd98+=_0x81ab96(0x2b5),_0x45dd98+=_0x81ab96(0x371),_0x45dd98+=_0x81ab96(0x372)+_0x2484bf+_0x81ab96(0x2ff)+_0xef0530+_0x81ab96(0x2dd),_0x45dd98+=_0x81ab96(0x359),_0x45dd98+=_0x81ab96(0x291),_0x45dd98+='<table>',_0x45dd98+='<tr>',_0x45dd98+=_0x81ab96(0x329),_0x45dd98+=_0x81ab96(0x2af),_0x45dd98+=_0x81ab96(0x21b)+_0x2484bf+'</th>',_0x45dd98+=_0x81ab96(0x21a),_0x45dd98+='<th\x20colspan=\x272\x27>SOLD</th>',_0x45dd98+=_0x81ab96(0x21d)+_0xef0530+'</th>',_0x45dd98+=_0x81ab96(0x2a5),_0x45dd98+='<tr>',_0x45dd98+=_0x81ab96(0x259),_0x45dd98+=_0x81ab96(0x36a),_0x45dd98+=_0x81ab96(0x2a5),_0x45dd98+=_0x5de896,_0x45dd98+=_0x81ab96(0x32d),_0x45dd98+=_0x81ab96(0x20a),_0x45dd98+=_0x81ab96(0x20a);const _0x47c8b7={'format':_0x81ab96(0x1fc),'orientation':_0x81ab96(0x23c),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x81ab96(0x322)}}};pdf[_0x81ab96(0x2e8)](_0x45dd98,_0x47c8b7)[_0x81ab96(0x202)](function(_0x1609ea,_0x435cd6){const _0x4e83e5=_0x81ab96;if(_0x1609ea){_0x3599cb['status'](0x1f4)[_0x4e83e5(0x270)](_0x4e83e5(0x23d));return;}_0x3599cb[_0x4e83e5(0x221)](_0x4e83e5(0x340),_0x4e83e5(0x245)),_0x435cd6[_0x4e83e5(0x207)](_0x3599cb);});}),router[a0_0x2db209(0x29c)](a0_0x2db209(0x302),auth,async(_0x204866,_0x18d0cf)=>{const _0x330b2c=a0_0x2db209;try{const {username:_0x35aa48,email:_0x62409d,role:_0x4d04bd}=_0x204866[_0x330b2c(0x334)],_0x5e5e5b=_0x204866[_0x330b2c(0x334)],_0x177fd2=await profile[_0x330b2c(0x2d1)]({'email':_0x5e5e5b[_0x330b2c(0x26a)]}),_0x3f4d1f={'year':'numeric','month':_0x330b2c(0x369),'day':_0x330b2c(0x303)},_0x537b1b=await master_shop[_0x330b2c(0x214)](),_0x475b9a=await product['find'](),_0x15307e=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x330b2c(0x352),'localField':_0x330b2c(0x337),'foreignField':_0x330b2c(0x2d9),'as':_0x330b2c(0x2e9)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x330b2c(0x2ec),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x330b2c(0x290),'product_stock':{'$sum':_0x330b2c(0x2b4)}}}]);if(_0x537b1b[0x0]['language']==_0x330b2c(0x2e1))var _0x443629=users[_0x330b2c(0x2b3)];else{if(_0x537b1b[0x0][_0x330b2c(0x252)]=='Hindi')var _0x443629=users[_0x330b2c(0x231)];else{if(_0x537b1b[0x0]['language']==_0x330b2c(0x265))var _0x443629=users[_0x330b2c(0x265)];else{if(_0x537b1b[0x0][_0x330b2c(0x252)]==_0x330b2c(0x320))var _0x443629=users[_0x330b2c(0x320)];else{if(_0x537b1b[0x0][_0x330b2c(0x252)]==_0x330b2c(0x32e))var _0x443629=users[_0x330b2c(0x32e)];else{if(_0x537b1b[0x0]['language']=='Portuguese\x20(BR)')var _0x443629=users[_0x330b2c(0x253)];else{if(_0x537b1b[0x0]['language']==_0x330b2c(0x258))var _0x443629=users['Chinese'];else{if(_0x537b1b[0x0][_0x330b2c(0x252)]==_0x330b2c(0x2cf))var _0x443629=users[_0x330b2c(0x260)];}}}}}}}_0x18d0cf['render'](_0x330b2c(0x2ea),{'success':_0x204866[_0x330b2c(0x341)](_0x330b2c(0x31e)),'errors':_0x204866[_0x330b2c(0x341)](_0x330b2c(0x238)),'alldata':_0x475b9a,'profile':_0x177fd2,'master_shop':_0x537b1b,'role':_0x5e5e5b,'product_stock':_0x15307e,'language':_0x443629});}catch(_0x43be15){}});async function agentsdataCheck(_0xaf6ed0,_0x7f4878){const _0x21ef3b=a0_0x2db209,_0x132cb2=await product['aggregate']([{'$group':{'_id':{'brand':_0x21ef3b(0x286),'category':_0x21ef3b(0x363)},'products':{'$push':{'name':_0x21ef3b(0x34c),'product_code':_0x21ef3b(0x23e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5d7214=[];_0x5d7214[_0x21ef3b(0x366)]=[];for(let _0xf7ccb0=0x0;_0xf7ccb0<=_0x132cb2[_0x21ef3b(0x205)]-0x1;_0xf7ccb0++){const _0x4fe0fd=_0x132cb2[_0xf7ccb0];_0x5d7214[_0x21ef3b(0x366)][_0x21ef3b(0x28d)](_0x4fe0fd);}const _0x4f1ea7=await product[_0x21ef3b(0x217)]([{'$group':{'_id':{'category':_0x21ef3b(0x363)},'products':{'$push':{'brand':_0x21ef3b(0x286),'product_code':_0x21ef3b(0x23e),'product_name':_0x21ef3b(0x34c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x490c1d=await product[_0x21ef3b(0x217)]([{'$group':{'_id':{'category':_0x21ef3b(0x363),'brand':_0x21ef3b(0x286)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x364778=await sales_sa[_0x21ef3b(0x217)]([{'$match':{'date':{'$gte':_0xaf6ed0,'$lte':_0x7f4878}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x21ef3b(0x232)}}},{'$lookup':{'from':_0x21ef3b(0x2d7),'localField':'sales_staff_id','foreignField':_0x21ef3b(0x239),'as':'sales_info'}},{'$unwind':_0x21ef3b(0x22c)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x21ef3b(0x26d)}},{'$lookup':{'from':_0x21ef3b(0x352),'localField':_0x21ef3b(0x30a),'foreignField':_0x21ef3b(0x32f),'as':_0x21ef3b(0x20d)}},{'$unwind':'$product_info'},{'$group':{'_id':{'sales_id':_0x21ef3b(0x355),'category':'$product_info.category','brand':_0x21ef3b(0x2eb)},'salesman_data':{'$first':_0x21ef3b(0x309)},'totalQTY':{'$sum':_0x21ef3b(0x33b)},'products':{'$push':{'qty':_0x21ef3b(0x33b),'product_details':{'prod_name':'$product_info.name','product_code':_0x21ef3b(0x254),'category':'$product_info.category','brand':_0x21ef3b(0x2eb)}}}}}]);let _0x13c792='';_0x13c792+='<tr>',_0x13c792+='<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x13c792+=_0x21ef3b(0x2a5),_0x13c792+=_0x21ef3b(0x354),_0x13c792+='<td\x20class=\x22cat_data\x22></td>';for(let _0x19c416=0x0;_0x19c416<=_0x4f1ea7[_0x21ef3b(0x205)]-0x1;_0x19c416++){const _0x43763e=_0x4f1ea7[_0x19c416];for(let _0x4a3be0=0x0;_0x4a3be0<_0x490c1d[_0x21ef3b(0x205)];_0x4a3be0++){const _0x3ab24f=_0x490c1d[_0x4a3be0];_0x3ab24f[_0x21ef3b(0x239)]==_0x43763e[_0x21ef3b(0x239)][_0x21ef3b(0x248)]&&(_0x13c792+=_0x21ef3b(0x227)+_0x3ab24f[_0x21ef3b(0x283)]+'\x22\x20class=\x22cat_data\x22>'+_0x43763e[_0x21ef3b(0x239)][_0x21ef3b(0x248)]+_0x21ef3b(0x206));}}_0x13c792+=_0x21ef3b(0x228),_0x13c792+=_0x21ef3b(0x2a5),_0x13c792+=_0x21ef3b(0x354),_0x13c792+=_0x21ef3b(0x274);for(let _0x24937f=0x0;_0x24937f<=_0x4f1ea7[_0x21ef3b(0x205)]-0x1;_0x24937f++){const _0x368c6a=_0x4f1ea7[_0x24937f];for(let _0x551128=0x0;_0x551128<_0x5d7214['cat_brand'][_0x21ef3b(0x205)];_0x551128++){const _0x3f5de1=_0x5d7214[_0x21ef3b(0x366)][_0x551128];_0x3f5de1[_0x21ef3b(0x239)][_0x21ef3b(0x248)]==_0x368c6a[_0x21ef3b(0x239)]['category']&&(_0x13c792+=_0x21ef3b(0x318)+_0x3f5de1[_0x21ef3b(0x239)]['brand']+'</td>');}}_0x13c792+=_0x21ef3b(0x2e7),_0x13c792+=_0x21ef3b(0x2a5);let _0x528b3f={'name':[],'dataqty':{}};for(let _0x13a9e3=0x0;_0x13a9e3<_0x5d7214['cat_brand'][_0x21ef3b(0x205)];_0x13a9e3++){const _0xf4332=_0x5d7214[_0x21ef3b(0x366)][_0x13a9e3],_0x4e9d07=_0xf4332['_id'][_0x21ef3b(0x327)],_0x28cb9b=_0xf4332[_0x21ef3b(0x239)]['category'];!_0x528b3f['dataqty'][_0x4e9d07]&&(_0x528b3f[_0x21ef3b(0x2ce)][_0x4e9d07]={});!_0x528b3f[_0x21ef3b(0x2ce)][_0x4e9d07][_0x28cb9b]&&(_0x528b3f[_0x21ef3b(0x2ce)][_0x4e9d07][_0x28cb9b]=[]);for(let _0xde09bd=0x0;_0xde09bd<_0x364778[_0x21ef3b(0x205)];_0xde09bd++){const _0x3af73f=_0x364778[_0xde09bd];if(_0x4e9d07===_0x3af73f[_0x21ef3b(0x239)][_0x21ef3b(0x327)]&&_0x28cb9b===_0x3af73f['_id'][_0x21ef3b(0x248)]){const _0x386583=_0x3af73f[_0x21ef3b(0x312)];!_0x528b3f['dataqty'][_0x4e9d07][_0x28cb9b][_0x386583]&&(_0x528b3f[_0x21ef3b(0x2ce)][_0x4e9d07][_0x28cb9b][_0x386583]=[]),_0x528b3f['dataqty'][_0x4e9d07][_0x28cb9b][_0x386583][_0x21ef3b(0x28d)](_0x3af73f[_0x21ef3b(0x216)]),!_0x528b3f[_0x21ef3b(0x2d9)]['includes'](_0x386583)&&_0x528b3f[_0x21ef3b(0x2d9)][_0x21ef3b(0x28d)](_0x386583);}}}_0x13c792+=_0x21ef3b(0x354);for(let _0x321b02=0x0;_0x321b02<=_0x528b3f['name'][_0x21ef3b(0x205)]-0x1;_0x321b02++){const _0x5d99a8=_0x528b3f[_0x21ef3b(0x2d9)][_0x321b02];_0x13c792+=_0x21ef3b(0x2ee)+_0x5d99a8+_0x21ef3b(0x206);var _0x24d28d=0x0,_0x567847=0x0;for(let _0x105bda=0x0;_0x105bda<=_0x5d7214[_0x21ef3b(0x366)][_0x21ef3b(0x205)]-0x1;_0x105bda++){const _0x10a0db=_0x5d7214['cat_brand'][_0x105bda];var _0x5c0ea1=0x0;_0x528b3f[_0x21ef3b(0x2ce)][_0x10a0db[_0x21ef3b(0x239)][_0x21ef3b(0x327)]][_0x10a0db['_id'][_0x21ef3b(0x248)]][_0x5d99a8]?(_0x5c0ea1=_0x528b3f[_0x21ef3b(0x2ce)][_0x10a0db['_id']['brand']][_0x10a0db[_0x21ef3b(0x239)][_0x21ef3b(0x248)]][_0x5d99a8][0x0],_0x13c792+=_0x21ef3b(0x2ee)+_0x5c0ea1[_0x21ef3b(0x2da)](0x2)+_0x21ef3b(0x206)):(_0x5c0ea1=0x0,_0x13c792+=_0x21ef3b(0x2ee)+_0x5c0ea1+_0x21ef3b(0x206)),_0x24d28d+=parseFloat(_0x5c0ea1['toFixed'](0x2));}_0x13c792+='<td\x20class=\x22row_data\x22>'+_0x24d28d[_0x21ef3b(0x2da)](0x2)+_0x21ef3b(0x206);}return _0x13c792+=_0x21ef3b(0x2a5),_0x13c792;}router[a0_0x2db209(0x31c)](a0_0x2db209(0x338),auth,async(_0x3e56ee,_0x1ae3cd)=>{const _0x437cd3=a0_0x2db209,{from_date:_0x1fc42d,to_date:_0x17401e}=_0x3e56ee[_0x437cd3(0x300)],_0x586121=await agentsdataCheck(_0x1fc42d,_0x17401e);{}let _0x10e8fe=_0x437cd3(0x298);var _0x3e326c=new Date(_0x1fc42d),_0xd31b10=new Date(_0x17401e);const _0x56a963={'year':_0x437cd3(0x303),'month':_0x437cd3(0x369),'day':_0x437cd3(0x303)},_0x135022=new Intl[(_0x437cd3(0x208))](_0x437cd3(0x234),_0x56a963)['format'](_0x3e326c),_0x30301b=new Intl[(_0x437cd3(0x208))](_0x437cd3(0x234),_0x56a963)['format'](_0xd31b10);_0x10e8fe+=_0x437cd3(0x2b5),_0x10e8fe+=_0x437cd3(0x31d),_0x10e8fe+=_0x437cd3(0x372)+_0x135022+_0x437cd3(0x2ff)+_0x30301b+_0x437cd3(0x2dd),_0x10e8fe+=_0x437cd3(0x359),_0x10e8fe+=_0x437cd3(0x291),_0x10e8fe+='<table>',_0x10e8fe+=_0x586121,_0x10e8fe+=_0x437cd3(0x32d),_0x10e8fe+=_0x437cd3(0x20a),_0x10e8fe+='</div>';const _0x2e8832={'format':_0x437cd3(0x1fc),'orientation':_0x437cd3(0x23c),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x437cd3(0x322)}}};pdf['create'](_0x10e8fe,_0x2e8832)[_0x437cd3(0x202)](function(_0x483999,_0xd19340){const _0x57e9be=_0x437cd3;if(_0x483999){_0x1ae3cd['status'](0x1f4)[_0x57e9be(0x270)](_0x57e9be(0x23d));return;}_0x1ae3cd[_0x57e9be(0x221)](_0x57e9be(0x340),_0x57e9be(0x245)),_0xd19340[_0x57e9be(0x207)](_0x1ae3cd);});}),router[a0_0x2db209(0x29c)]('/agent_reports/sales_ad',auth,async(_0x9274ac,_0xee2ee3)=>{const _0x330261=a0_0x2db209;try{const {username:_0x2333ff,email:_0x4f63a4,role:_0x496ae3}=_0x9274ac[_0x330261(0x334)],_0x5347a9=_0x9274ac[_0x330261(0x334)],_0x2a6007=await profile[_0x330261(0x2d1)]({'email':_0x5347a9['email']}),_0x1118de={'year':_0x330261(0x303),'month':_0x330261(0x369),'day':_0x330261(0x303)},_0x319bb0=await master_shop[_0x330261(0x214)](),_0x5d9e7e=await staff[_0x330261(0x2d1)]({'email':_0x5347a9[_0x330261(0x26a)]}),_0x4e2c1c=await product[_0x330261(0x214)](),_0x8a7ec1=await warehouse['aggregate']([{'$unwind':_0x330261(0x364)},{'$lookup':{'from':_0x330261(0x352),'localField':'product_details.product_name','foreignField':_0x330261(0x2d9),'as':_0x330261(0x2e9)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x330261(0x226)}},{'$group':{'_id':_0x330261(0x290),'product_stock':{'$sum':_0x330261(0x2b4)}}}]),_0x47655e=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x319bb0[0x0]['language']=='English\x20(US)')var _0xad4ed8=users[_0x330261(0x2b3)];else{if(_0x319bb0[0x0][_0x330261(0x252)]==_0x330261(0x231))var _0xad4ed8=users[_0x330261(0x231)];else{if(_0x319bb0[0x0]['language']==_0x330261(0x265))var _0xad4ed8=users[_0x330261(0x265)];else{if(_0x319bb0[0x0][_0x330261(0x252)]==_0x330261(0x320))var _0xad4ed8=users['Spanish'];else{if(_0x319bb0[0x0][_0x330261(0x252)]==_0x330261(0x32e))var _0xad4ed8=users[_0x330261(0x32e)];else{if(_0x319bb0[0x0]['language']==_0x330261(0x2bc))var _0xad4ed8=users[_0x330261(0x253)];else{if(_0x319bb0[0x0]['language']==_0x330261(0x258))var _0xad4ed8=users[_0x330261(0x258)];else{if(_0x319bb0[0x0][_0x330261(0x252)]=='Arabic\x20(ae)')var _0xad4ed8=users[_0x330261(0x260)];}}}}}}}_0xee2ee3[_0x330261(0x2cc)](_0x330261(0x2d4),{'success':_0x9274ac[_0x330261(0x341)]('success'),'errors':_0x9274ac[_0x330261(0x341)](_0x330261(0x238)),'alldata':_0x4e2c1c,'profile':_0x2a6007,'master_shop':_0x319bb0,'role':_0x5347a9,'product_stock':_0x8a7ec1,'language':_0xad4ed8,'staff_arr':_0x5d9e7e,'staff_data_all':_0x47655e});}catch(_0x16e850){_0xee2ee3['json'](_0x16e850);}});async function agentsdataDSICheck_admin(_0x3ce6a0,_0x427730,_0x526061,_0x1efc67){const _0xa3cbd1=a0_0x2db209,_0x507516=await product[_0xa3cbd1(0x217)]([{'$group':{'_id':{'brand':_0xa3cbd1(0x286),'category':'$category'},'products':{'$push':{'name':_0xa3cbd1(0x34c),'product_code':_0xa3cbd1(0x23e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x183f79=[];_0x183f79[_0xa3cbd1(0x366)]=[];for(let _0x49903a=0x0;_0x49903a<=_0x507516[_0xa3cbd1(0x205)]-0x1;_0x49903a++){const _0x558a3e=_0x507516[_0x49903a];_0x183f79[_0xa3cbd1(0x366)][_0xa3cbd1(0x28d)](_0x558a3e);}const _0x39ec8f=await product[_0xa3cbd1(0x217)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0xa3cbd1(0x286),'product_code':_0xa3cbd1(0x23e),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x46ab80=await product[_0xa3cbd1(0x217)]([{'$group':{'_id':{'category':'$category','brand':_0xa3cbd1(0x286)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x17d016=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3ce6a0,'$lte':_0x427730},'sales_staff_id':_0x526061,'sale_product.isFG':'false'}},{'$unwind':_0xa3cbd1(0x332)},{'$match':{'sale_product.isFG':_0xa3cbd1(0x26d)}},{'$lookup':{'from':_0xa3cbd1(0x352),'localField':_0xa3cbd1(0x30a),'foreignField':_0xa3cbd1(0x32f),'as':_0xa3cbd1(0x20d)}},{'$unwind':_0xa3cbd1(0x357)},{'$group':{'_id':{'dsi':'$dsi','date':_0xa3cbd1(0x35c),'customer':'$customer'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0xa3cbd1(0x33b),'NetPrice':_0xa3cbd1(0x2bd),'discount':_0xa3cbd1(0x24d),'adj_discount':_0xa3cbd1(0x37b),'product_details':{'prod_name':_0xa3cbd1(0x289),'product_code':_0xa3cbd1(0x254),'category':_0xa3cbd1(0x22d),'brand':_0xa3cbd1(0x2eb),'gross_price':_0xa3cbd1(0x349)}}}}},{'$unwind':_0xa3cbd1(0x251)},{'$group':{'_id':{'dsi':_0xa3cbd1(0x285),'date':_0xa3cbd1(0x350),'customer':_0xa3cbd1(0x24b),'category':_0xa3cbd1(0x277),'brand':_0xa3cbd1(0x368)},'totalQty':{'$sum':_0xa3cbd1(0x330)},'totalGross':{'$sum':{'$multiply':[_0xa3cbd1(0x330),_0xa3cbd1(0x37f)]}},'NetPrice':{'$sum':_0xa3cbd1(0x326)},'discount':{'$sum':_0xa3cbd1(0x353)},'adj_discount':{'$sum':_0xa3cbd1(0x348)},'product_details':{'$first':_0xa3cbd1(0x2a9)}}},{'$group':{'_id':{'dsi':_0xa3cbd1(0x285),'date':'$_id.date','customer':_0xa3cbd1(0x24b)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0xa3cbd1(0x317)},'NetPrice':{'$sum':_0xa3cbd1(0x376)},'discount':{'$sum':_0xa3cbd1(0x36e)},'adj_discount':{'$sum':_0xa3cbd1(0x319)},'products':{'$push':{'qty':_0xa3cbd1(0x215),'category':_0xa3cbd1(0x2ba),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x162012=[],_0x2fb4eb={},_0x545ad9={},_0x26423e={};var _0x186acc=0x0,_0xed1f77=0x0,_0x2ae13b=0x0,_0x24a1cf=0x0,_0x217ec7=0x0;const _0x11d8de=0x6;for(let _0x2204d3=0x0;_0x2204d3<=_0x17d016[_0xa3cbd1(0x205)]-0x1;_0x2204d3++){const _0x8c613=_0x17d016[_0x2204d3];let _0x5ddd2e=_0xa3cbd1(0x354);_0x5ddd2e+=_0xa3cbd1(0x2f1)+_0x8c613[_0xa3cbd1(0x239)][_0xa3cbd1(0x281)]+'</td>',_0x5ddd2e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x8c613['_id']['date']+_0xa3cbd1(0x206),_0x5ddd2e+=_0xa3cbd1(0x2f1)+_0x8c613[_0xa3cbd1(0x239)][_0xa3cbd1(0x24e)]+_0xa3cbd1(0x206);let _0x7f8df1={};var _0x1752bd=0x0;for(let _0x2ca75c=0x0;_0x2ca75c<=_0x8c613[_0xa3cbd1(0x352)][_0xa3cbd1(0x205)]-0x1;_0x2ca75c++){const _0x27a144=_0x8c613['products'][_0x2ca75c];_0x7f8df1[_0x27a144[_0xa3cbd1(0x327)]+'-'+_0x27a144[_0xa3cbd1(0x248)]]=_0x27a144[_0xa3cbd1(0x24c)];const _0x598f1e=_0x27a144[_0xa3cbd1(0x327)]+'-'+_0x27a144[_0xa3cbd1(0x248)];!_0x2fb4eb[_0x598f1e]&&(_0x2fb4eb[_0x598f1e]=0x0),!Array['isArray'](_0x26423e[_0x598f1e])&&(_0x26423e[_0x598f1e]=[]),!Array['isArray'](_0x26423e[_0x598f1e])&&(_0x26423e[_0x598f1e]=[]),_0x2fb4eb[_0x598f1e]+=_0x27a144[_0xa3cbd1(0x24c)],_0x26423e[_0x598f1e][_0xa3cbd1(0x28d)](_0x27a144[_0xa3cbd1(0x24c)]),_0x1752bd++;}for(let _0x336c89=0x0;_0x336c89<=_0x183f79[_0xa3cbd1(0x366)][_0xa3cbd1(0x205)]-0x1;_0x336c89++){const _0x457acb=_0x183f79[_0xa3cbd1(0x366)][_0x336c89],_0x6ed804=_0x457acb[_0xa3cbd1(0x239)][_0xa3cbd1(0x327)]+'-'+_0x457acb[_0xa3cbd1(0x239)][_0xa3cbd1(0x248)];_0x5ddd2e+=_0xa3cbd1(0x2d8)+(_0x7f8df1[_0x6ed804]!==undefined?_0x7f8df1[_0x6ed804][_0xa3cbd1(0x2da)](0x2):'')+_0xa3cbd1(0x206);}_0x2ae13b=_0x8c613[_0xa3cbd1(0x295)]+_0x8c613[_0xa3cbd1(0x2d5)],_0x5ddd2e+=_0xa3cbd1(0x2d0)+formatNumber(parseFloat(_0x8c613[_0xa3cbd1(0x304)],0x2)[_0xa3cbd1(0x2da)](0x2))+_0xa3cbd1(0x206),_0x5ddd2e+=_0xa3cbd1(0x2d0)+formatNumber(_0x8c613['totalGross'][_0xa3cbd1(0x2da)](0x2))+_0xa3cbd1(0x206),_0x5ddd2e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x2ae13b)+_0xa3cbd1(0x206),_0x5ddd2e+=_0xa3cbd1(0x2d0)+formatNumber(_0x8c613[_0xa3cbd1(0x219)]['toFixed'](0x2))+_0xa3cbd1(0x206),_0x5ddd2e+=_0xa3cbd1(0x2a5);var _0x407aa3=parseFloat(_0x8c613[_0xa3cbd1(0x304)]['toFixed'](0x3));_0x186acc+=_0x407aa3,console[_0xa3cbd1(0x365)](_0xa3cbd1(0x2b9),_0x186acc+_0xa3cbd1(0x323)+_0x407aa3),_0xed1f77+=parseFloat(_0x8c613[_0xa3cbd1(0x219)][_0xa3cbd1(0x2da)](0x2)),_0x24a1cf+=_0x2ae13b,_0x217ec7+=parseFloat(_0x8c613[_0xa3cbd1(0x30b)]['toFixed'](0x2));if(_0x2204d3==_0x17d016[_0xa3cbd1(0x205)]-0x1){_0x5ddd2e+='<tr>',_0x5ddd2e+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x5ddd2e+=_0xa3cbd1(0x206);for(let _0x5a6217=0x0;_0x5a6217<=_0x183f79['cat_brand']['length']-0x1;_0x5a6217++){const _0x20d6b1=_0x183f79['cat_brand'][_0x5a6217],_0x6babad=_0x20d6b1[_0xa3cbd1(0x239)][_0xa3cbd1(0x327)]+'-'+_0x20d6b1[_0xa3cbd1(0x239)][_0xa3cbd1(0x248)];!_0x26423e[_0x6babad]&&(_0x26423e[_0x6babad]=[]);const _0x2d846f=_0x26423e[_0x6babad][_0xa3cbd1(0x2b6)]((_0x1b8d41,_0x4774ce)=>_0x1b8d41+_0x4774ce,0x0);_0x5ddd2e+=_0xa3cbd1(0x2c2)+(_0x2d846f!==undefined?formatNumber(_0x2d846f[_0xa3cbd1(0x2da)](0x2)):'')+_0xa3cbd1(0x2a8);}_0x5ddd2e+=_0xa3cbd1(0x235)+formatNumber(_0x186acc[_0xa3cbd1(0x2da)](0x2),0x2)+_0xa3cbd1(0x2a8),_0x5ddd2e+=_0xa3cbd1(0x235)+formatNumber(_0x217ec7)+_0xa3cbd1(0x2a8),_0x5ddd2e+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x24a1cf)+_0xa3cbd1(0x2a8),_0x5ddd2e+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xed1f77)+_0xa3cbd1(0x2a8),_0x5ddd2e+=_0xa3cbd1(0x2a5);}_0x162012[_0xa3cbd1(0x28d)](_0x5ddd2e);}function _0x93fdb(_0x3d42b3,_0x345839){const _0x476236=_0xa3cbd1,_0x4e0fdb=[];for(let _0x5bb80c=0x0;_0x5bb80c<=_0x3d42b3[_0x476236(0x205)]-0x1;_0x5bb80c+=_0x345839){_0x4e0fdb['push'](_0x3d42b3['slice'](_0x5bb80c,_0x5bb80c+_0x345839));}return _0x4e0fdb;}const _0x439b15=_0x93fdb(_0x162012,_0x11d8de);let _0x20e57d='';return _0x439b15[_0xa3cbd1(0x2a2)]((_0x19951b,_0xc5fe6b)=>{const _0x5714c6=_0xa3cbd1;_0xc5fe6b>0x0&&(_0x20e57d+=_0x5714c6(0x222));_0x20e57d+='<table>',_0x20e57d+=_0x5714c6(0x351),_0x20e57d+=_0x5714c6(0x354),_0x20e57d+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x20e57d+='</tr>',_0x20e57d+=_0x5714c6(0x354),_0x20e57d+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x5a3799=0x0;_0x5a3799<=_0x39ec8f[_0x5714c6(0x205)]-0x1;_0x5a3799++){const _0x47b82a=_0x39ec8f[_0x5a3799];for(let _0x3fbc3f=0x0;_0x3fbc3f<_0x46ab80[_0x5714c6(0x205)];_0x3fbc3f++){const _0x2fe1e4=_0x46ab80[_0x3fbc3f];_0x2fe1e4['_id']===_0x47b82a[_0x5714c6(0x239)]['category']&&(_0x20e57d+='<td\x20colspan=\x22'+_0x2fe1e4[_0x5714c6(0x283)]+_0x5714c6(0x2f4)+_0x47b82a[_0x5714c6(0x239)][_0x5714c6(0x248)]+_0x5714c6(0x206));}}_0x20e57d+=_0x5714c6(0x2fa),_0x20e57d+=_0x5714c6(0x2a5),_0x20e57d+=_0x5714c6(0x354),_0x20e57d+=_0x5714c6(0x26e),_0x20e57d+=_0x5714c6(0x32b),_0x20e57d+=_0x5714c6(0x358);for(let _0x222e63=0x0;_0x222e63<=_0x39ec8f[_0x5714c6(0x205)]-0x1;_0x222e63++){const _0x281ec0=_0x39ec8f[_0x222e63];for(let _0x72b136=0x0;_0x72b136<_0x183f79['cat_brand'][_0x5714c6(0x205)];_0x72b136++){const _0x162f00=_0x183f79[_0x5714c6(0x366)][_0x72b136];_0x162f00[_0x5714c6(0x239)][_0x5714c6(0x248)]===_0x281ec0[_0x5714c6(0x239)][_0x5714c6(0x248)]&&(_0x20e57d+='<td\x20class=\x22cat_data\x22>'+_0x162f00[_0x5714c6(0x239)][_0x5714c6(0x327)]+_0x5714c6(0x206));}}_0x20e57d+=_0x5714c6(0x2e7),_0x20e57d+=_0x5714c6(0x284),_0x20e57d+=_0x5714c6(0x382),_0x20e57d+=_0x5714c6(0x32c),_0x20e57d+=_0x5714c6(0x2a5),_0x20e57d+=_0x5714c6(0x381),_0x20e57d+=_0x5714c6(0x27f),_0x19951b[_0x5714c6(0x2a2)](_0x69db61=>{_0x20e57d+=_0x69db61;}),_0x20e57d+=_0x5714c6(0x292),_0x20e57d+='</table>';}),_0x20e57d;}async function agentsdataDSICheck_admin_excel(_0x2d5117,_0x3209c1,_0x44ad6f,_0x1f6c02){const _0x10e9d8=a0_0x2db209,_0x34bd2b=await product['aggregate']([{'$group':{'_id':{'brand':_0x10e9d8(0x286),'category':_0x10e9d8(0x363)},'products':{'$push':{'name':'$name','product_code':_0x10e9d8(0x23e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x179c23=[];_0x179c23[_0x10e9d8(0x366)]=[];for(let _0x5ea1e3=0x0;_0x5ea1e3<=_0x34bd2b[_0x10e9d8(0x205)]-0x1;_0x5ea1e3++){const _0x4769a0=_0x34bd2b[_0x5ea1e3];_0x179c23[_0x10e9d8(0x366)]['push'](_0x4769a0);}const _0x3984d0=await product[_0x10e9d8(0x217)]([{'$group':{'_id':{'category':_0x10e9d8(0x363)},'products':{'$push':{'brand':_0x10e9d8(0x286),'product_code':'$product_code','product_name':_0x10e9d8(0x34c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5d8159=await product[_0x10e9d8(0x217)]([{'$group':{'_id':{'category':_0x10e9d8(0x363),'brand':_0x10e9d8(0x286)}}},{'$group':{'_id':_0x10e9d8(0x2ba),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xc7972c=await sales_sa[_0x10e9d8(0x217)]([{'$match':{'date':{'$gte':_0x2d5117,'$lte':_0x3209c1},'sales_staff_id':_0x44ad6f,'sale_product.isFG':'false'}},{'$unwind':_0x10e9d8(0x332)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x10e9d8(0x30a),'foreignField':_0x10e9d8(0x32f),'as':'product_info'}},{'$unwind':_0x10e9d8(0x357)},{'$group':{'_id':{'dsi':_0x10e9d8(0x347),'date':'$date','customer':_0x10e9d8(0x27c)},'totalQty':{'$sum':_0x10e9d8(0x33b)},'products':{'$push':{'qty':_0x10e9d8(0x33b),'NetPrice':'$sale_product.totalprice','discount':_0x10e9d8(0x24d),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x10e9d8(0x289),'product_code':_0x10e9d8(0x254),'category':_0x10e9d8(0x22d),'brand':_0x10e9d8(0x2eb),'gross_price':_0x10e9d8(0x349)}}}}},{'$unwind':_0x10e9d8(0x251)},{'$group':{'_id':{'dsi':_0x10e9d8(0x285),'date':'$_id.date','customer':_0x10e9d8(0x24b),'category':_0x10e9d8(0x277),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x10e9d8(0x330)},'totalGross':{'$sum':{'$multiply':[_0x10e9d8(0x330),_0x10e9d8(0x37f)]}},'NetPrice':{'$sum':_0x10e9d8(0x326)},'discount':{'$sum':_0x10e9d8(0x353)},'adj_discount':{'$sum':_0x10e9d8(0x348)},'product_details':{'$first':_0x10e9d8(0x2a9)}}},{'$group':{'_id':{'dsi':_0x10e9d8(0x285),'date':_0x10e9d8(0x350),'customer':_0x10e9d8(0x24b)},'totalQty':{'$sum':_0x10e9d8(0x215)},'totalGross':{'$sum':_0x10e9d8(0x317)},'NetPrice':{'$sum':_0x10e9d8(0x376)},'discount':{'$sum':_0x10e9d8(0x36e)},'adj_discount':{'$sum':_0x10e9d8(0x319)},'products':{'$push':{'qty':_0x10e9d8(0x215),'category':_0x10e9d8(0x2ba),'brand':'$_id.brand','product_details':_0x10e9d8(0x364)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x105f6d=[],_0x3a9f8a={},_0x3cf04f={},_0x5000e7={};var _0x4ebd41=0x0,_0x140a40=0x0,_0x134cec=0x0,_0x230931=0x0,_0x429b37=0x0;const _0x5d9cd0=0x16345785d8a0000;for(let _0x2b6074=0x0;_0x2b6074<=_0xc7972c[_0x10e9d8(0x205)]-0x1;_0x2b6074++){const _0x1ddb76=_0xc7972c[_0x2b6074];let _0x4f9e75=_0x10e9d8(0x354);_0x4f9e75+=_0x10e9d8(0x2f1)+_0x1ddb76[_0x10e9d8(0x239)][_0x10e9d8(0x281)]+_0x10e9d8(0x206),_0x4f9e75+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1ddb76[_0x10e9d8(0x239)][_0x10e9d8(0x360)]+_0x10e9d8(0x206),_0x4f9e75+=_0x10e9d8(0x2f1)+_0x1ddb76['_id'][_0x10e9d8(0x24e)]+'</td>';let _0x8129a3={};var _0x28d986=0x0;for(let _0x43773d=0x0;_0x43773d<=_0x1ddb76['products'][_0x10e9d8(0x205)]-0x1;_0x43773d++){const _0x3bc2c4=_0x1ddb76[_0x10e9d8(0x352)][_0x43773d];_0x8129a3[_0x3bc2c4[_0x10e9d8(0x327)]+'-'+_0x3bc2c4[_0x10e9d8(0x248)]]=_0x3bc2c4[_0x10e9d8(0x24c)];const _0x3889b8=_0x3bc2c4[_0x10e9d8(0x327)]+'-'+_0x3bc2c4[_0x10e9d8(0x248)];!_0x3a9f8a[_0x3889b8]&&(_0x3a9f8a[_0x3889b8]=0x0),!Array[_0x10e9d8(0x2fe)](_0x5000e7[_0x3889b8])&&(_0x5000e7[_0x3889b8]=[]),!Array[_0x10e9d8(0x2fe)](_0x5000e7[_0x3889b8])&&(_0x5000e7[_0x3889b8]=[]),_0x3a9f8a[_0x3889b8]+=_0x3bc2c4['qty'],_0x5000e7[_0x3889b8][_0x10e9d8(0x28d)](_0x3bc2c4['qty']),_0x28d986++;}for(let _0x7698f8=0x0;_0x7698f8<=_0x179c23['cat_brand']['length']-0x1;_0x7698f8++){const _0x3ead01=_0x179c23[_0x10e9d8(0x366)][_0x7698f8],_0x5b13eb=_0x3ead01[_0x10e9d8(0x239)][_0x10e9d8(0x327)]+'-'+_0x3ead01[_0x10e9d8(0x239)][_0x10e9d8(0x248)];_0x4f9e75+=_0x10e9d8(0x2d8)+(_0x8129a3[_0x5b13eb]!==undefined?_0x8129a3[_0x5b13eb]['toFixed'](0x2):'')+_0x10e9d8(0x206);}_0x134cec=_0x1ddb76[_0x10e9d8(0x295)]+_0x1ddb76[_0x10e9d8(0x2d5)],_0x4f9e75+=_0x10e9d8(0x2d0)+formatNumber(parseFloat(_0x1ddb76[_0x10e9d8(0x304)],0x2)[_0x10e9d8(0x2da)](0x2))+_0x10e9d8(0x206),_0x4f9e75+=_0x10e9d8(0x2d0)+formatNumber(_0x1ddb76[_0x10e9d8(0x30b)]['toFixed'](0x2))+'</td>',_0x4f9e75+=_0x10e9d8(0x2d0)+formatNumber(_0x134cec)+_0x10e9d8(0x206),_0x4f9e75+=_0x10e9d8(0x2d0)+formatNumber(_0x1ddb76[_0x10e9d8(0x219)]['toFixed'](0x2))+_0x10e9d8(0x206),_0x4f9e75+=_0x10e9d8(0x2a5),_0x4ebd41+=parseFloat(_0x1ddb76[_0x10e9d8(0x304)]),_0x140a40+=parseFloat(_0x1ddb76[_0x10e9d8(0x219)]['toFixed'](0x2)),_0x230931+=_0x134cec,_0x429b37+=parseFloat(_0x1ddb76[_0x10e9d8(0x30b)][_0x10e9d8(0x2da)](0x2));if(_0x2b6074==_0xc7972c[_0x10e9d8(0x205)]-0x1){_0x4f9e75+=_0x10e9d8(0x354),_0x4f9e75+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x4f9e75+=_0x10e9d8(0x206);for(let _0x10c083=0x0;_0x10c083<=_0x179c23['cat_brand'][_0x10e9d8(0x205)]-0x1;_0x10c083++){const _0x30c780=_0x179c23['cat_brand'][_0x10c083],_0x30c1b0=_0x30c780[_0x10e9d8(0x239)][_0x10e9d8(0x327)]+'-'+_0x30c780[_0x10e9d8(0x239)][_0x10e9d8(0x248)];!_0x5000e7[_0x30c1b0]&&(_0x5000e7[_0x30c1b0]=[]);const _0x2b4715=_0x5000e7[_0x30c1b0][_0x10e9d8(0x2b6)]((_0x1dbfd1,_0x398a1d)=>_0x1dbfd1+_0x398a1d,0x0);_0x4f9e75+=_0x10e9d8(0x2c2)+(_0x2b4715!==undefined?formatNumber(_0x2b4715[_0x10e9d8(0x2da)](0x2)):'')+'</b></td>';}_0x4f9e75+=_0x10e9d8(0x235)+formatNumber(_0x4ebd41)+_0x10e9d8(0x2a8),_0x4f9e75+=_0x10e9d8(0x235)+formatNumber(_0x429b37)+'</b></td>',_0x4f9e75+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x230931)+_0x10e9d8(0x2a8),_0x4f9e75+=_0x10e9d8(0x235)+formatNumber(_0x140a40)+_0x10e9d8(0x2a8),_0x4f9e75+=_0x10e9d8(0x2a5);}_0x105f6d[_0x10e9d8(0x28d)](_0x4f9e75);}function _0x1a4021(_0x53acf6,_0x5c6f00){const _0x298970=_0x10e9d8,_0x3989e4=[];for(let _0x82c8d9=0x0;_0x82c8d9<=_0x53acf6['length']-0x1;_0x82c8d9+=_0x5c6f00){_0x3989e4[_0x298970(0x28d)](_0x53acf6[_0x298970(0x2fd)](_0x82c8d9,_0x82c8d9+_0x5c6f00));}return _0x3989e4;}const _0x35ab19=_0x1a4021(_0x105f6d,_0x5d9cd0);let _0x533011='';return _0x35ab19[_0x10e9d8(0x2a2)]((_0xefce09,_0x5c9a8b)=>{const _0xf25eb9=_0x10e9d8;_0x5c9a8b>0x0&&(_0x533011+=_0xf25eb9(0x222));_0x533011+='<table>',_0x533011+=_0xf25eb9(0x351),_0x533011+=_0xf25eb9(0x354),_0x533011+=_0xf25eb9(0x201),_0x533011+='</tr>',_0x533011+=_0xf25eb9(0x354),_0x533011+=_0xf25eb9(0x294);for(let _0x352f33=0x0;_0x352f33<=_0x3984d0[_0xf25eb9(0x205)]-0x1;_0x352f33++){const _0x4bc92c=_0x3984d0[_0x352f33];for(let _0x1e7493=0x0;_0x1e7493<_0x5d8159[_0xf25eb9(0x205)];_0x1e7493++){const _0x491df4=_0x5d8159[_0x1e7493];_0x491df4['_id']===_0x4bc92c['_id'][_0xf25eb9(0x248)]&&(_0x533011+=_0xf25eb9(0x227)+_0x491df4[_0xf25eb9(0x283)]+_0xf25eb9(0x2f4)+_0x4bc92c[_0xf25eb9(0x239)][_0xf25eb9(0x248)]+_0xf25eb9(0x206));}}_0x533011+=_0xf25eb9(0x2fa),_0x533011+=_0xf25eb9(0x2a5),_0x533011+=_0xf25eb9(0x354),_0x533011+=_0xf25eb9(0x26e),_0x533011+=_0xf25eb9(0x32b),_0x533011+=_0xf25eb9(0x358);for(let _0x134e0b=0x0;_0x134e0b<=_0x3984d0[_0xf25eb9(0x205)]-0x1;_0x134e0b++){const _0x3cd119=_0x3984d0[_0x134e0b];for(let _0x3d9df5=0x0;_0x3d9df5<_0x179c23[_0xf25eb9(0x366)][_0xf25eb9(0x205)];_0x3d9df5++){const _0xf19d2d=_0x179c23[_0xf25eb9(0x366)][_0x3d9df5];_0xf19d2d['_id'][_0xf25eb9(0x248)]===_0x3cd119[_0xf25eb9(0x239)][_0xf25eb9(0x248)]&&(_0x533011+='<td\x20class=\x22cat_data\x22>'+_0xf19d2d[_0xf25eb9(0x239)]['brand']+'</td>');}}_0x533011+=_0xf25eb9(0x2e7),_0x533011+=_0xf25eb9(0x284),_0x533011+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x533011+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x533011+=_0xf25eb9(0x2a5),_0x533011+=_0xf25eb9(0x381),_0x533011+=_0xf25eb9(0x27f),_0xefce09[_0xf25eb9(0x2a2)](_0x514368=>{_0x533011+=_0x514368;}),_0x533011+='</tbody>',_0x533011+='</table>';}),_0x533011;}router['post'](a0_0x2db209(0x35e),auth,async(_0x119550,_0x3de11d)=>{const _0x468c35=a0_0x2db209,{from_date:_0x49b82b,to_date:_0xd2e99b,isExcel:_0x136b9c,agent_id:_0x324942}=_0x119550[_0x468c35(0x300)],_0x49032c=_0x119550[_0x468c35(0x334)],_0x2c90d0=await staff['findOne']({'email':_0x49032c[_0x468c35(0x26a)]}),_0x26231b=await master_shop['find'](),_0x66ebb5=await agentsdataDSICheck_admin(_0x49b82b,_0xd2e99b,_0x324942,_0x136b9c),_0x2acd5f=await agentsdataDSICheck_admin_excel(_0x49b82b,_0xd2e99b,_0x324942,_0x136b9c);let _0x398fa5=_0x468c35(0x307);var _0x33f5ba=new Date(_0x49b82b),_0x535996=new Date(_0xd2e99b);const _0x3ae4f8={'year':_0x468c35(0x303),'month':_0x468c35(0x369),'day':_0x468c35(0x303)},_0x55a5f1=new Intl[(_0x468c35(0x208))](_0x468c35(0x234),_0x3ae4f8)[_0x468c35(0x203)](_0x33f5ba),_0x2b6161=new Intl[(_0x468c35(0x208))](_0x468c35(0x234),_0x3ae4f8)[_0x468c35(0x203)](_0x535996);_0x398fa5+=_0x468c35(0x359),_0x398fa5+=_0x468c35(0x27e),_0x398fa5+=_0x468c35(0x275),_0x398fa5+=_0x66ebb5,_0x398fa5+='</table>',_0x398fa5+='</div>',_0x398fa5+=_0x468c35(0x20a);let _0x20d9e2=_0x468c35(0x307);_0x20d9e2+='<div\x20class=\x22row\x22>',_0x20d9e2+=_0x468c35(0x27e),_0x20d9e2+=_0x468c35(0x275),_0x20d9e2+=_0x2acd5f,_0x20d9e2+='</table>',_0x20d9e2+='</div>',_0x20d9e2+=_0x468c35(0x20a);let _0x19a61e=_0x468c35(0x1f9);const _0xfaf6bf={'width':_0x468c35(0x2ef),'height':_0x468c35(0x22b),'orientation':_0x468c35(0x23c),'border':{'top':_0x468c35(0x1fe),'right':'0.1in','bottom':_0x468c35(0x1fe),'left':_0x468c35(0x1fe)},'header':{'height':'60mm','contents':_0x468c35(0x37a)+_0x19a61e+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x55a5f1+_0x468c35(0x2ff)+_0x2b6161+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':'20mm','contents':{'default':_0x468c35(0x36c)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x468c35(0x322)}}};if(_0x136b9c=='on'){const _0x454c99=cheerio[_0x468c35(0x22f)](_0x20d9e2);let _0x21732d=[],_0x9f82d6=[],_0xfe868f=[];_0x454c99('table\x20tr')[_0x468c35(0x242)]((_0x1052fe,_0x58a6a4)=>{const _0x35da18=_0x468c35;let _0xb9e12d=[],_0x3f26db=0x0;while(_0xfe868f[_0x3f26db]){_0xfe868f[_0x3f26db]--,_0x3f26db++;}_0x454c99(_0x58a6a4)['find'](_0x35da18(0x2be))[_0x35da18(0x242)]((_0x5bf1b7,_0x4cf171)=>{const _0x2eaa93=_0x35da18;let _0x511342=_0x454c99(_0x4cf171)[_0x2eaa93(0x362)]()[_0x2eaa93(0x2b7)](),_0x1c1a59=parseFloat(_0x511342['replace'](/,/g,''));isNaN(_0x1c1a59)&&(_0x1c1a59=_0x511342);let _0x44a3af=parseInt(_0x454c99(_0x4cf171)[_0x2eaa93(0x374)]('colspan'))||0x1,_0x4211c7=parseInt(_0x454c99(_0x4cf171)[_0x2eaa93(0x374)](_0x2eaa93(0x2b0)))||0x1;_0xb9e12d[_0x3f26db]=_0x1c1a59;(_0x44a3af>0x1||_0x4211c7>0x1)&&_0x9f82d6[_0x2eaa93(0x28d)]({'s':{'r':_0x1052fe,'c':_0x3f26db},'e':{'r':_0x1052fe+_0x4211c7-0x1,'c':_0x3f26db+_0x44a3af-0x1}});for(let _0xc892bd=0x0;_0xc892bd<_0x44a3af;_0xc892bd++){_0x4211c7>0x1&&(_0xfe868f[_0x3f26db+_0xc892bd]=_0x4211c7-0x1);}_0x3f26db+=_0x44a3af;}),_0x21732d[_0x35da18(0x28d)](_0xb9e12d);});const _0x4594f2=XLSX[_0x468c35(0x384)][_0x468c35(0x2de)](),_0x290583=XLSX[_0x468c35(0x384)][_0x468c35(0x2f6)](_0x21732d);_0x9f82d6[_0x468c35(0x205)]>0x0&&(_0x290583[_0x468c35(0x20f)]=_0x9f82d6);_0x290583[_0x468c35(0x209)]=_0x21732d[0x0][_0x468c35(0x35b)](()=>({'wpx':0x64})),XLSX[_0x468c35(0x384)]['book_append_sheet'](_0x4594f2,_0x290583,_0x468c35(0x224));const _0x51da65=XLSX[_0x468c35(0x313)](_0x4594f2,{'bookType':_0x468c35(0x335),'type':'buffer'});_0x3de11d[_0x468c35(0x221)](_0x468c35(0x293),_0x468c35(0x20c)),_0x3de11d[_0x468c35(0x221)]('Content-Type',_0x468c35(0x23a)),_0x3de11d[_0x468c35(0x270)](_0x51da65);}else pdf[_0x468c35(0x2e8)](_0x398fa5,_0xfaf6bf)[_0x468c35(0x202)](function(_0x4115a2,_0x3c6b7d){const _0x3f3060=_0x468c35;if(_0x4115a2){_0x3de11d[_0x3f3060(0x21e)](0x1f4)[_0x3f3060(0x270)](_0x3f3060(0x23d));return;}_0x3de11d['setHeader']('Content-Type',_0x3f3060(0x245)),_0x3c6b7d[_0x3f3060(0x207)](_0x3de11d);});}),router[a0_0x2db209(0x29c)](a0_0x2db209(0x2c6),auth,async(_0x1e98db,_0x163460)=>{const _0x25b932=a0_0x2db209;try{const {username:_0x342933,email:_0x44cdd2,role:_0x4d666a}=_0x1e98db[_0x25b932(0x334)],_0x35144e=_0x1e98db[_0x25b932(0x334)],_0xdaf47f=await profile['findOne']({'email':_0x35144e['email']}),_0x3871c5={'year':'numeric','month':_0x25b932(0x369),'day':_0x25b932(0x303)},_0x535e00=await master_shop[_0x25b932(0x214)](),_0x2be91e=await staff[_0x25b932(0x2d1)]({'email':_0x35144e['email']}),_0x3bff2b=await product[_0x25b932(0x214)](),_0x5a00c4=await warehouse[_0x25b932(0x217)]([{'$unwind':_0x25b932(0x364)},{'$lookup':{'from':_0x25b932(0x352),'localField':'product_details.product_name','foreignField':_0x25b932(0x2d9),'as':'product_docs'}},{'$unwind':_0x25b932(0x34e)},{'$project':{'product_name':_0x25b932(0x2ec),'product_stock':_0x25b932(0x226)}},{'$group':{'_id':_0x25b932(0x290),'product_stock':{'$sum':_0x25b932(0x2b4)}}}]);if(_0x535e00[0x0][_0x25b932(0x252)]==_0x25b932(0x2e1))var _0x15b530=users[_0x25b932(0x2b3)];else{if(_0x535e00[0x0]['language']==_0x25b932(0x231))var _0x15b530=users[_0x25b932(0x231)];else{if(_0x535e00[0x0][_0x25b932(0x252)]==_0x25b932(0x265))var _0x15b530=users['German'];else{if(_0x535e00[0x0][_0x25b932(0x252)]==_0x25b932(0x320))var _0x15b530=users['Spanish'];else{if(_0x535e00[0x0][_0x25b932(0x252)]==_0x25b932(0x32e))var _0x15b530=users[_0x25b932(0x32e)];else{if(_0x535e00[0x0]['language']=='Portuguese\x20(BR)')var _0x15b530=users['Portuguese'];else{if(_0x535e00[0x0][_0x25b932(0x252)]==_0x25b932(0x258))var _0x15b530=users[_0x25b932(0x258)];else{if(_0x535e00[0x0][_0x25b932(0x252)]==_0x25b932(0x2cf))var _0x15b530=users['Arabic'];}}}}}}}_0x163460['render']('dsi_sales',{'success':_0x1e98db[_0x25b932(0x341)](_0x25b932(0x31e)),'errors':_0x1e98db[_0x25b932(0x341)](_0x25b932(0x238)),'alldata':_0x3bff2b,'profile':_0xdaf47f,'master_shop':_0x535e00,'role':_0x35144e,'product_stock':_0x5a00c4,'language':_0x15b530,'staff_arr':_0x2be91e});}catch(_0x16cb8c){}});function formatNumber(_0x39ac97,_0x2376ac=a0_0x2db209(0x234),_0x21f96c={'minimumFractionDigits':0x2}){const _0x583445=a0_0x2db209,_0x4c03ce=new Intl['NumberFormat'](_0x2376ac,_0x21f96c);return _0x4c03ce[_0x583445(0x203)](_0x39ac97);}async function agentsdataDSICheck(_0x129056,_0x360393,_0x5d237e,_0x44d81b){const _0x511696=a0_0x2db209,_0xe35819=await product['aggregate']([{'$group':{'_id':{'brand':_0x511696(0x286),'category':_0x511696(0x363)},'products':{'$push':{'name':_0x511696(0x34c),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5ce57f=[];_0x5ce57f[_0x511696(0x366)]=[];for(let _0x2105da=0x0;_0x2105da<=_0xe35819['length']-0x1;_0x2105da++){const _0x5e2453=_0xe35819[_0x2105da];_0x5ce57f[_0x511696(0x366)][_0x511696(0x28d)](_0x5e2453);}const _0xf2b12d=await product[_0x511696(0x217)]([{'$group':{'_id':{'category':_0x511696(0x363)},'products':{'$push':{'brand':_0x511696(0x286),'product_code':_0x511696(0x23e),'product_name':_0x511696(0x34c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x512949=await product[_0x511696(0x217)]([{'$group':{'_id':{'category':_0x511696(0x363),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x122261=await sales_sa[_0x511696(0x217)]([{'$match':{'date':{'$gte':_0x129056,'$lte':_0x360393},'sales_staff_id':_0x5d237e,'sale_product.isFG':_0x511696(0x26d),'status_data':_0x511696(0x26d)}},{'$unwind':_0x511696(0x332)},{'$match':{'sale_product.isFG':_0x511696(0x26d)}},{'$lookup':{'from':'products','localField':_0x511696(0x30a),'foreignField':_0x511696(0x32f),'as':_0x511696(0x20d)}},{'$unwind':_0x511696(0x357)},{'$group':{'_id':{'dsi':_0x511696(0x347),'date':'$date','customer':_0x511696(0x27c)},'totalQty':{'$sum':_0x511696(0x33b)},'products':{'$push':{'qty':_0x511696(0x33b),'NetPrice':'$sale_product.totalprice','discount':_0x511696(0x24d),'adj_discount':_0x511696(0x37b),'product_details':{'prod_name':_0x511696(0x289),'product_code':_0x511696(0x254),'category':_0x511696(0x22d),'brand':'$product_info.brand','gross_price':_0x511696(0x349)}}}}},{'$unwind':_0x511696(0x251)},{'$group':{'_id':{'dsi':_0x511696(0x285),'date':_0x511696(0x350),'customer':_0x511696(0x24b),'category':_0x511696(0x277),'brand':_0x511696(0x368)},'totalQty':{'$sum':_0x511696(0x330)},'totalGross':{'$sum':{'$multiply':[_0x511696(0x330),_0x511696(0x37f)]}},'NetPrice':{'$sum':_0x511696(0x326)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x511696(0x348)},'product_details':{'$first':_0x511696(0x2a9)}}},{'$group':{'_id':{'dsi':_0x511696(0x285),'date':_0x511696(0x350),'customer':_0x511696(0x24b)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x511696(0x317)},'NetPrice':{'$sum':_0x511696(0x376)},'discount':{'$sum':_0x511696(0x36e)},'adj_discount':{'$sum':_0x511696(0x319)},'products':{'$push':{'qty':_0x511696(0x215),'category':_0x511696(0x2ba),'brand':_0x511696(0x35a),'product_details':_0x511696(0x364)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x54b2e8=[],_0x3f765d={},_0x1fed78={},_0x8c0a1f={};var _0x2d492e=0x0,_0x2da793=0x0,_0x7588cf=0x0,_0x64ec15=0x0,_0x483cd3=0x0;const _0x110087=0x6;for(let _0x5275c2=0x0;_0x5275c2<=_0x122261[_0x511696(0x205)]-0x1;_0x5275c2++){const _0x5d2fb1=_0x122261[_0x5275c2];let _0x441143=_0x511696(0x354);_0x441143+=_0x511696(0x2f1)+_0x5d2fb1[_0x511696(0x239)][_0x511696(0x281)]+_0x511696(0x206),_0x441143+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5d2fb1['_id'][_0x511696(0x360)]+_0x511696(0x206),_0x441143+=_0x511696(0x2f1)+_0x5d2fb1['_id'][_0x511696(0x24e)]+_0x511696(0x206);let _0x496c58={};var _0x200668=0x0;for(let _0x361995=0x0;_0x361995<=_0x5d2fb1[_0x511696(0x352)]['length']-0x1;_0x361995++){const _0x339e12=_0x5d2fb1[_0x511696(0x352)][_0x361995];_0x496c58[_0x339e12[_0x511696(0x327)]+'-'+_0x339e12[_0x511696(0x248)]]=_0x339e12[_0x511696(0x24c)];const _0x2edcee=_0x339e12[_0x511696(0x327)]+'-'+_0x339e12[_0x511696(0x248)];!_0x3f765d[_0x2edcee]&&(_0x3f765d[_0x2edcee]=0x0),!Array['isArray'](_0x8c0a1f[_0x2edcee])&&(_0x8c0a1f[_0x2edcee]=[]),!Array[_0x511696(0x2fe)](_0x8c0a1f[_0x2edcee])&&(_0x8c0a1f[_0x2edcee]=[]),_0x3f765d[_0x2edcee]+=_0x339e12['qty'],_0x8c0a1f[_0x2edcee][_0x511696(0x28d)](_0x339e12[_0x511696(0x24c)]),_0x200668++;}for(let _0x3af1ee=0x0;_0x3af1ee<=_0x5ce57f['cat_brand'][_0x511696(0x205)]-0x1;_0x3af1ee++){const _0x133536=_0x5ce57f[_0x511696(0x366)][_0x3af1ee],_0x1112c3=_0x133536[_0x511696(0x239)][_0x511696(0x327)]+'-'+_0x133536[_0x511696(0x239)][_0x511696(0x248)];_0x441143+=_0x511696(0x2d8)+(_0x496c58[_0x1112c3]!==undefined?_0x496c58[_0x1112c3][_0x511696(0x2da)](0x2):'')+_0x511696(0x206);}_0x7588cf=_0x5d2fb1['discount']+_0x5d2fb1[_0x511696(0x2d5)],_0x441143+=_0x511696(0x2d0)+formatNumber(parseFloat(_0x5d2fb1[_0x511696(0x304)],0x2)[_0x511696(0x2da)](0x2))+_0x511696(0x206),_0x441143+=_0x511696(0x2d0)+formatNumber(_0x5d2fb1['totalGross']['toFixed'](0x2))+'</td>',_0x441143+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x7588cf)+_0x511696(0x206),_0x441143+=_0x511696(0x2d0)+formatNumber(_0x5d2fb1['NetPrice']['toFixed'](0x2))+_0x511696(0x206),_0x441143+='</tr>',_0x2d492e+=parseFloat(_0x5d2fb1[_0x511696(0x304)]),_0x2da793+=parseFloat(_0x5d2fb1['NetPrice'][_0x511696(0x2da)](0x2)),_0x64ec15+=_0x7588cf,_0x483cd3+=parseFloat(_0x5d2fb1['totalGross'][_0x511696(0x2da)](0x2));if(_0x5275c2==_0x122261['length']-0x1){_0x441143+=_0x511696(0x354),_0x441143+=_0x511696(0x273),_0x441143+=_0x511696(0x206);for(let _0x59d782=0x0;_0x59d782<=_0x5ce57f[_0x511696(0x366)][_0x511696(0x205)]-0x1;_0x59d782++){const _0xc7990d=_0x5ce57f['cat_brand'][_0x59d782],_0x307365=_0xc7990d['_id'][_0x511696(0x327)]+'-'+_0xc7990d['_id']['category'];!_0x8c0a1f[_0x307365]&&(_0x8c0a1f[_0x307365]=[]);const _0x1c45cb=_0x8c0a1f[_0x307365][_0x511696(0x2b6)]((_0x5e178a,_0x1fe128)=>_0x5e178a+_0x1fe128,0x0);_0x441143+=_0x511696(0x2c2)+(_0x1c45cb!==undefined?formatNumber(_0x1c45cb['toFixed'](0x2)):'')+_0x511696(0x2a8);}_0x441143+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x2d492e[_0x511696(0x2da)](0x2))+'</b></td>',_0x441143+=_0x511696(0x235)+formatNumber(_0x483cd3)+_0x511696(0x2a8),_0x441143+=_0x511696(0x235)+formatNumber(_0x64ec15)+'</b></td>',_0x441143+=_0x511696(0x235)+formatNumber(_0x2da793)+'</b></td>',_0x441143+='</tr>';}console[_0x511696(0x365)](_0x511696(0x316),_0x2d492e+'+='+parseFloat(_0x5d2fb1[_0x511696(0x304)])),_0x54b2e8['push'](_0x441143);}function _0x967315(_0x2cdfe7,_0x82d90e){const _0x2ca81a=_0x511696,_0x213379=[];for(let _0x128246=0x0;_0x128246<=_0x2cdfe7[_0x2ca81a(0x205)]-0x1;_0x128246+=_0x82d90e){_0x213379[_0x2ca81a(0x28d)](_0x2cdfe7[_0x2ca81a(0x2fd)](_0x128246,_0x128246+_0x82d90e));}return _0x213379;}const _0xa5d69b=_0x967315(_0x54b2e8,_0x110087);let _0xd7311d='';return _0xa5d69b['forEach']((_0xbecc,_0x3b760e)=>{const _0x1da5bd=_0x511696;_0x3b760e>0x0&&(_0xd7311d+=_0x1da5bd(0x222));_0xd7311d+='<table>',_0xd7311d+='<thead>',_0xd7311d+='<tr>',_0xd7311d+=_0x1da5bd(0x201),_0xd7311d+=_0x1da5bd(0x2a5),_0xd7311d+='<tr>',_0xd7311d+=_0x1da5bd(0x294);for(let _0x5186cb=0x0;_0x5186cb<=_0xf2b12d[_0x1da5bd(0x205)]-0x1;_0x5186cb++){const _0x17840b=_0xf2b12d[_0x5186cb];for(let _0x162a6b=0x0;_0x162a6b<_0x512949['length'];_0x162a6b++){const _0x325d0a=_0x512949[_0x162a6b];_0x325d0a[_0x1da5bd(0x239)]===_0x17840b[_0x1da5bd(0x239)][_0x1da5bd(0x248)]&&(_0xd7311d+=_0x1da5bd(0x227)+_0x325d0a[_0x1da5bd(0x283)]+_0x1da5bd(0x2f4)+_0x17840b[_0x1da5bd(0x239)][_0x1da5bd(0x248)]+_0x1da5bd(0x206));}}_0xd7311d+=_0x1da5bd(0x2fa),_0xd7311d+=_0x1da5bd(0x2a5),_0xd7311d+=_0x1da5bd(0x354),_0xd7311d+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0xd7311d+=_0x1da5bd(0x32b),_0xd7311d+=_0x1da5bd(0x358);for(let _0x4dd040=0x0;_0x4dd040<=_0xf2b12d['length']-0x1;_0x4dd040++){const _0x4630ab=_0xf2b12d[_0x4dd040];for(let _0x305346=0x0;_0x305346<_0x5ce57f[_0x1da5bd(0x366)]['length'];_0x305346++){const _0xf82bf1=_0x5ce57f[_0x1da5bd(0x366)][_0x305346];_0xf82bf1[_0x1da5bd(0x239)][_0x1da5bd(0x248)]===_0x4630ab[_0x1da5bd(0x239)][_0x1da5bd(0x248)]&&(_0xd7311d+=_0x1da5bd(0x318)+_0xf82bf1[_0x1da5bd(0x239)]['brand']+'</td>');}}_0xd7311d+=_0x1da5bd(0x2e7),_0xd7311d+=_0x1da5bd(0x284),_0xd7311d+=_0x1da5bd(0x382),_0xd7311d+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0xd7311d+=_0x1da5bd(0x2a5),_0xd7311d+=_0x1da5bd(0x381),_0xd7311d+=_0x1da5bd(0x27f),_0xbecc[_0x1da5bd(0x2a2)](_0x89131=>{_0xd7311d+=_0x89131;}),_0xd7311d+=_0x1da5bd(0x292),_0xd7311d+=_0x1da5bd(0x32d);}),_0xd7311d;}async function agentsdataDSICheck_excel(_0x5c643c,_0x4fa9ba,_0x46cb9d,_0x315caa){const _0x447c82=a0_0x2db209,_0x1dbf70=await product['aggregate']([{'$group':{'_id':{'brand':_0x447c82(0x286),'category':_0x447c82(0x363)},'products':{'$push':{'name':'$name','product_code':_0x447c82(0x23e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x174cae=[];_0x174cae['cat_brand']=[];for(let _0x298425=0x0;_0x298425<=_0x1dbf70['length']-0x1;_0x298425++){const _0x14a20c=_0x1dbf70[_0x298425];_0x174cae[_0x447c82(0x366)][_0x447c82(0x28d)](_0x14a20c);}const _0x1e6774=await product[_0x447c82(0x217)]([{'$group':{'_id':{'category':_0x447c82(0x363)},'products':{'$push':{'brand':_0x447c82(0x286),'product_code':_0x447c82(0x23e),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x5af564=await product[_0x447c82(0x217)]([{'$group':{'_id':{'category':'$category','brand':'$brand'}}},{'$group':{'_id':_0x447c82(0x2ba),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4805da=await sales_sa[_0x447c82(0x217)]([{'$match':{'date':{'$gte':_0x5c643c,'$lte':_0x4fa9ba},'sales_staff_id':_0x46cb9d,'sale_product.isFG':_0x447c82(0x26d)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x447c82(0x26d)}},{'$lookup':{'from':_0x447c82(0x352),'localField':'sale_product.product_code','foreignField':_0x447c82(0x32f),'as':_0x447c82(0x20d)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':_0x447c82(0x35c),'customer':_0x447c82(0x27c)},'totalQty':{'$sum':_0x447c82(0x33b)},'products':{'$push':{'qty':_0x447c82(0x33b),'NetPrice':'$sale_product.totalprice','discount':_0x447c82(0x24d),'adj_discount':_0x447c82(0x37b),'product_details':{'prod_name':_0x447c82(0x289),'product_code':_0x447c82(0x254),'category':_0x447c82(0x22d),'brand':_0x447c82(0x2eb),'gross_price':_0x447c82(0x349)}}}}},{'$unwind':_0x447c82(0x251)},{'$group':{'_id':{'dsi':_0x447c82(0x285),'date':'$_id.date','customer':_0x447c82(0x24b),'category':_0x447c82(0x277),'brand':_0x447c82(0x368)},'totalQty':{'$sum':_0x447c82(0x330)},'totalGross':{'$sum':{'$multiply':[_0x447c82(0x330),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x447c82(0x326)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x447c82(0x348)},'product_details':{'$first':_0x447c82(0x2a9)}}},{'$group':{'_id':{'dsi':_0x447c82(0x285),'date':_0x447c82(0x350),'customer':_0x447c82(0x24b)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x447c82(0x376)},'discount':{'$sum':_0x447c82(0x36e)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':_0x447c82(0x2ba),'brand':_0x447c82(0x35a),'product_details':_0x447c82(0x364)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4e6857=[],_0x472223={},_0xf285da={},_0x1bea84={};var _0x55df59=0x0,_0x88670f=0x0,_0x5ac423=0x0,_0x3309d3=0x0,_0x4e0a7a=0x0;const _0x4c2b66=0x9184e72a000;for(let _0x5f466c=0x0;_0x5f466c<=_0x4805da['length']-0x1;_0x5f466c++){const _0x234932=_0x4805da[_0x5f466c];let _0x1f94af=_0x447c82(0x354);_0x1f94af+=_0x447c82(0x2f1)+_0x234932['_id']['dsi']+_0x447c82(0x206),_0x1f94af+=_0x447c82(0x2f1)+_0x234932[_0x447c82(0x239)][_0x447c82(0x360)]+_0x447c82(0x206),_0x1f94af+=_0x447c82(0x2f1)+_0x234932[_0x447c82(0x239)]['customer']+_0x447c82(0x206);let _0x198d75={};var _0x1a3b24=0x0;for(let _0x19adf9=0x0;_0x19adf9<=_0x234932[_0x447c82(0x352)][_0x447c82(0x205)]-0x1;_0x19adf9++){const _0x4fbe5b=_0x234932[_0x447c82(0x352)][_0x19adf9];_0x198d75[_0x4fbe5b[_0x447c82(0x327)]+'-'+_0x4fbe5b[_0x447c82(0x248)]]=_0x4fbe5b[_0x447c82(0x24c)];const _0xe328b8=_0x4fbe5b[_0x447c82(0x327)]+'-'+_0x4fbe5b['category'];!_0x472223[_0xe328b8]&&(_0x472223[_0xe328b8]=0x0),!Array[_0x447c82(0x2fe)](_0x1bea84[_0xe328b8])&&(_0x1bea84[_0xe328b8]=[]),!Array[_0x447c82(0x2fe)](_0x1bea84[_0xe328b8])&&(_0x1bea84[_0xe328b8]=[]),_0x472223[_0xe328b8]+=_0x4fbe5b[_0x447c82(0x24c)],_0x1bea84[_0xe328b8][_0x447c82(0x28d)](_0x4fbe5b[_0x447c82(0x24c)]),_0x1a3b24++;}for(let _0x242353=0x0;_0x242353<=_0x174cae[_0x447c82(0x366)][_0x447c82(0x205)]-0x1;_0x242353++){const _0x57bc09=_0x174cae[_0x447c82(0x366)][_0x242353],_0x33c2ba=_0x57bc09[_0x447c82(0x239)][_0x447c82(0x327)]+'-'+_0x57bc09[_0x447c82(0x239)]['category'];_0x1f94af+=_0x447c82(0x2d8)+(_0x198d75[_0x33c2ba]!==undefined?_0x198d75[_0x33c2ba]['toFixed'](0x2):'')+'</td>';}_0x5ac423=_0x234932['discount']+_0x234932['adj_discount'],_0x1f94af+=_0x447c82(0x2d0)+formatNumber(parseFloat(_0x234932[_0x447c82(0x304)],0x2)['toFixed'](0x2))+_0x447c82(0x206),_0x1f94af+=_0x447c82(0x2d0)+formatNumber(_0x234932[_0x447c82(0x30b)][_0x447c82(0x2da)](0x2))+_0x447c82(0x206),_0x1f94af+=_0x447c82(0x2d0)+formatNumber(_0x5ac423)+_0x447c82(0x206),_0x1f94af+=_0x447c82(0x2d0)+formatNumber(_0x234932[_0x447c82(0x219)][_0x447c82(0x2da)](0x2))+'</td>',_0x1f94af+='</tr>',_0x55df59+=parseFloat(_0x234932[_0x447c82(0x304)]['toFixed'](0x2)),_0x88670f+=parseFloat(_0x234932['NetPrice'][_0x447c82(0x2da)](0x2)),_0x3309d3+=_0x5ac423,_0x4e0a7a+=parseFloat(_0x234932[_0x447c82(0x30b)]['toFixed'](0x2));if(_0x5f466c==_0x4805da[_0x447c82(0x205)]-0x1){_0x1f94af+=_0x447c82(0x354),_0x1f94af+=_0x447c82(0x273),_0x1f94af+=_0x447c82(0x206);for(let _0x3ae5da=0x0;_0x3ae5da<=_0x174cae['cat_brand'][_0x447c82(0x205)]-0x1;_0x3ae5da++){const _0x5cff6b=_0x174cae[_0x447c82(0x366)][_0x3ae5da],_0x387b9c=_0x5cff6b['_id'][_0x447c82(0x327)]+'-'+_0x5cff6b[_0x447c82(0x239)][_0x447c82(0x248)];!_0x1bea84[_0x387b9c]&&(_0x1bea84[_0x387b9c]=[]);const _0x29a632=_0x1bea84[_0x387b9c][_0x447c82(0x2b6)]((_0x1fab49,_0x1d65d3)=>_0x1fab49+_0x1d65d3,0x0);_0x1f94af+=_0x447c82(0x2c2)+(_0x29a632!==undefined?formatNumber(_0x29a632[_0x447c82(0x2da)](0x2)):'')+'</b></td>';}_0x1f94af+=_0x447c82(0x235)+formatNumber(_0x55df59['toFixed'](0x2))+_0x447c82(0x2a8),_0x1f94af+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4e0a7a)+_0x447c82(0x2a8),_0x1f94af+=_0x447c82(0x235)+formatNumber(_0x3309d3)+_0x447c82(0x2a8),_0x1f94af+=_0x447c82(0x235)+formatNumber(_0x88670f)+_0x447c82(0x2a8),_0x1f94af+=_0x447c82(0x2a5);}_0x4e6857['push'](_0x1f94af);}function _0x5dcbb5(_0x571be2,_0x4e33a2){const _0x392984=_0x447c82,_0x1b4239=[];for(let _0x3e1dae=0x0;_0x3e1dae<=_0x571be2[_0x392984(0x205)]-0x1;_0x3e1dae+=_0x4e33a2){_0x1b4239[_0x392984(0x28d)](_0x571be2[_0x392984(0x2fd)](_0x3e1dae,_0x3e1dae+_0x4e33a2));}return _0x1b4239;}const _0x2c429b=_0x5dcbb5(_0x4e6857,_0x4c2b66);let _0x4a8d9e='';return _0x2c429b[_0x447c82(0x2a2)]((_0x202f4c,_0x3653d7)=>{const _0x3fc6f2=_0x447c82;_0x3653d7>0x0&&(_0x4a8d9e+=_0x3fc6f2(0x222));_0x4a8d9e+='<table>',_0x4a8d9e+='<thead>',_0x4a8d9e+='<tr>',_0x4a8d9e+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4a8d9e+='</tr>',_0x4a8d9e+='<tr>',_0x4a8d9e+=_0x3fc6f2(0x294);for(let _0xd69f96=0x0;_0xd69f96<=_0x1e6774[_0x3fc6f2(0x205)]-0x1;_0xd69f96++){const _0x549ed6=_0x1e6774[_0xd69f96];for(let _0x1b1cd5=0x0;_0x1b1cd5<_0x5af564[_0x3fc6f2(0x205)];_0x1b1cd5++){const _0x14c4a8=_0x5af564[_0x1b1cd5];_0x14c4a8[_0x3fc6f2(0x239)]===_0x549ed6[_0x3fc6f2(0x239)][_0x3fc6f2(0x248)]&&(_0x4a8d9e+=_0x3fc6f2(0x227)+_0x14c4a8[_0x3fc6f2(0x283)]+'\x22\x20class=\x22cat_data\x22>'+_0x549ed6['_id'][_0x3fc6f2(0x248)]+'</td>');}}_0x4a8d9e+=_0x3fc6f2(0x2fa),_0x4a8d9e+=_0x3fc6f2(0x2a5),_0x4a8d9e+=_0x3fc6f2(0x354),_0x4a8d9e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x4a8d9e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x4a8d9e+=_0x3fc6f2(0x358);for(let _0x1ae0ad=0x0;_0x1ae0ad<=_0x1e6774[_0x3fc6f2(0x205)]-0x1;_0x1ae0ad++){const _0x36c50e=_0x1e6774[_0x1ae0ad];for(let _0x42623d=0x0;_0x42623d<_0x174cae[_0x3fc6f2(0x366)][_0x3fc6f2(0x205)];_0x42623d++){const _0x4e5385=_0x174cae[_0x3fc6f2(0x366)][_0x42623d];_0x4e5385[_0x3fc6f2(0x239)][_0x3fc6f2(0x248)]===_0x36c50e[_0x3fc6f2(0x239)][_0x3fc6f2(0x248)]&&(_0x4a8d9e+='<td\x20class=\x22cat_data\x22>'+_0x4e5385[_0x3fc6f2(0x239)][_0x3fc6f2(0x327)]+'</td>');}}_0x4a8d9e+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x4a8d9e+=_0x3fc6f2(0x284),_0x4a8d9e+=_0x3fc6f2(0x382),_0x4a8d9e+=_0x3fc6f2(0x32c),_0x4a8d9e+=_0x3fc6f2(0x2a5),_0x4a8d9e+=_0x3fc6f2(0x381),_0x4a8d9e+='<tbody>',_0x202f4c['forEach'](_0x373a95=>{_0x4a8d9e+=_0x373a95;}),console[_0x3fc6f2(0x365)](_0x1bea84),_0x4a8d9e+='</tbody>',_0x4a8d9e+=_0x3fc6f2(0x32d);}),_0x4a8d9e;}router[a0_0x2db209(0x31c)](a0_0x2db209(0x2f0),auth,async(_0x317cca,_0xa2adb3)=>{const _0x3977e4=a0_0x2db209,{from_date:_0x1582c2,to_date:_0x13bee1,isExcel:_0x4806fc}=_0x317cca[_0x3977e4(0x300)],_0x52c46b=_0x317cca[_0x3977e4(0x334)],_0x3599fe=await staff['findOne']({'email':_0x52c46b[_0x3977e4(0x26a)]}),_0x58d1cb=await master_shop['find'](),_0x59ebaa=await agentsdataDSICheck(_0x1582c2,_0x13bee1,_0x3599fe[_0x3977e4(0x239)]['valueOf'](),_0x4806fc),_0x492a5a=await agentsdataDSICheck_excel(_0x1582c2,_0x13bee1,_0x3599fe[_0x3977e4(0x239)][_0x3977e4(0x230)](),_0x4806fc);let _0x1a6113='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x2e447d=new Date(_0x1582c2),_0x3599da=new Date(_0x13bee1);const _0x274cae={'year':'numeric','month':_0x3977e4(0x369),'day':_0x3977e4(0x303)},_0x2fe4ca=new Intl['DateTimeFormat'](_0x3977e4(0x234),_0x274cae)[_0x3977e4(0x203)](_0x2e447d),_0x459c12=new Intl[(_0x3977e4(0x208))](_0x3977e4(0x234),_0x274cae)[_0x3977e4(0x203)](_0x3599da);_0x1a6113+=_0x3977e4(0x359),_0x1a6113+=_0x3977e4(0x27e),_0x1a6113+=_0x3977e4(0x275),_0x1a6113+=_0x59ebaa,_0x1a6113+=_0x3977e4(0x32d),_0x1a6113+='</div>',_0x1a6113+=_0x3977e4(0x20a);let _0x5a9da1=_0x3977e4(0x200);_0x5a9da1+=_0x3977e4(0x359),_0x5a9da1+=_0x3977e4(0x27e),_0x5a9da1+=_0x3977e4(0x275),_0x5a9da1+=_0x492a5a,_0x5a9da1+=_0x3977e4(0x32d),_0x5a9da1+=_0x3977e4(0x20a),_0x5a9da1+='</div>';let _0x55233a=_0x3977e4(0x1f9);const _0x14ec8d={'width':_0x3977e4(0x2ef),'height':_0x3977e4(0x22b),'orientation':_0x3977e4(0x23c),'border':{'top':_0x3977e4(0x1fe),'right':_0x3977e4(0x1fe),'bottom':_0x3977e4(0x1fe),'left':_0x3977e4(0x1fe)},'header':{'height':_0x3977e4(0x383),'contents':_0x3977e4(0x37a)+_0x55233a+_0x3977e4(0x30c)+_0x2fe4ca+_0x3977e4(0x2ff)+_0x459c12+_0x3977e4(0x2c9)},'footer':{'height':_0x3977e4(0x1ff),'contents':{'default':_0x3977e4(0x36c)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x3977e4(0x322)}}};if(_0x4806fc=='on'){const _0x5e6ba6=cheerio[_0x3977e4(0x22f)](_0x5a9da1);let _0x228aa4=[],_0x540337=[],_0x2f8e00=[];const _0x26971e=_0x18f322=>{const _0x322d13=_0x3977e4,_0x2506b4={'top':{'style':_0x322d13(0x21c),'color':{'rgb':'000000'}},'bottom':{'style':'thick','color':{'rgb':_0x322d13(0x27d)}},'left':{'style':_0x322d13(0x21c),'color':{'rgb':_0x322d13(0x27d)}},'right':{'style':'thick','color':{'rgb':_0x322d13(0x27d)}}};if(_0x18f322){const _0x5331a7=_0x18f322[_0x322d13(0x24f)](';')[_0x322d13(0x2b6)]((_0x298809,_0x3f7da3)=>{const _0x222730=_0x322d13,[_0x57c6af,_0x2d02f8]=_0x3f7da3[_0x222730(0x24f)](':')[_0x222730(0x35b)](_0x4ae56c=>_0x4ae56c[_0x222730(0x2b7)]());return _0x298809[_0x57c6af]=_0x2d02f8,_0x298809;},{});_0x5331a7[_0x322d13(0x2aa)]&&(_0x2506b4[_0x322d13(0x1f6)][_0x322d13(0x2c1)]=_0x5331a7[_0x322d13(0x2aa)]['includes'](_0x322d13(0x213))?_0x322d13(0x213):_0x322d13(0x2f7)),_0x5331a7[_0x322d13(0x21f)]&&(_0x2506b4[_0x322d13(0x262)][_0x322d13(0x2c1)]=_0x5331a7['border-bottom']['includes'](_0x322d13(0x213))?_0x322d13(0x213):_0x322d13(0x2f7)),_0x5331a7['border-left']&&(_0x2506b4[_0x322d13(0x22a)][_0x322d13(0x2c1)]=_0x5331a7[_0x322d13(0x310)]['includes']('thin')?_0x322d13(0x213):_0x322d13(0x2f7)),_0x5331a7[_0x322d13(0x2ca)]&&(_0x2506b4[_0x322d13(0x2cb)][_0x322d13(0x2c1)]=_0x5331a7[_0x322d13(0x2ca)]['includes'](_0x322d13(0x213))?_0x322d13(0x213):_0x322d13(0x2f7));}return _0x2506b4;};_0x5e6ba6('table\x20tr')[_0x3977e4(0x242)]((_0x1da994,_0x4989ad)=>{const _0x29ff6a=_0x3977e4;let _0x6d1503=[],_0x262f0d=0x0;while(_0x2f8e00[_0x262f0d]){_0x2f8e00[_0x262f0d]--,_0x262f0d++;}_0x5e6ba6(_0x4989ad)[_0x29ff6a(0x214)]('td,\x20th')[_0x29ff6a(0x242)]((_0x2588d1,_0x14dc8f)=>{const _0x504970=_0x29ff6a;let _0x4197e6=_0x5e6ba6(_0x14dc8f)[_0x504970(0x362)]()[_0x504970(0x2b7)](),_0xeb793b=parseFloat(_0x4197e6[_0x504970(0x2ae)](/,/g,'')),_0x15d2eb={};!isNaN(_0xeb793b)?(_0x15d2eb['v']=_0xeb793b,_0x15d2eb['t']='n'):(_0x15d2eb['v']=_0x4197e6,_0x15d2eb['t']='s');const _0x343a37=_0x5e6ba6(_0x14dc8f)[_0x504970(0x374)](_0x504970(0x2c1)),_0x191c20=_0x26971e(_0x343a37);_0x15d2eb['s']={'border':_0x191c20},_0x6d1503[_0x262f0d]=_0x15d2eb;let _0x4dc5eb=parseInt(_0x5e6ba6(_0x14dc8f)[_0x504970(0x374)]('colspan'))||0x1,_0x221b69=parseInt(_0x5e6ba6(_0x14dc8f)['attr'](_0x504970(0x2b0)))||0x1;(_0x4dc5eb>0x1||_0x221b69>0x1)&&_0x540337['push']({'s':{'r':_0x1da994,'c':_0x262f0d},'e':{'r':_0x1da994+_0x221b69-0x1,'c':_0x262f0d+_0x4dc5eb-0x1}});for(let _0x58833c=0x0;_0x58833c<_0x4dc5eb;_0x58833c++){_0x221b69>0x1&&(_0x2f8e00[_0x262f0d+_0x58833c]=_0x221b69-0x1);}_0x262f0d+=_0x4dc5eb;}),_0x228aa4[_0x29ff6a(0x28d)](_0x6d1503);});const _0x9c54e3=XLSX['utils']['book_new'](),_0x46559f=XLSX['utils'][_0x3977e4(0x2f6)](_0x228aa4);_0x540337[_0x3977e4(0x205)]>0x0&&(_0x46559f[_0x3977e4(0x20f)]=_0x540337);_0x46559f['!cols']=_0x228aa4[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x3977e4(0x384)]['book_append_sheet'](_0x9c54e3,_0x46559f,_0x3977e4(0x224));const _0x3ceed1=XLSX[_0x3977e4(0x313)](_0x9c54e3,{'bookType':_0x3977e4(0x335),'type':_0x3977e4(0x272)});_0xa2adb3[_0x3977e4(0x221)](_0x3977e4(0x293),_0x3977e4(0x20c)),_0xa2adb3[_0x3977e4(0x221)](_0x3977e4(0x340),_0x3977e4(0x23a)),_0xa2adb3['send'](_0x3ceed1);}else pdf[_0x3977e4(0x2e8)](_0x1a6113,_0x14ec8d)['toStream'](function(_0x39b0bd,_0x10a9df){const _0x336558=_0x3977e4;if(_0x39b0bd){console[_0x336558(0x288)](_0x336558(0x299),_0x39b0bd),_0xa2adb3[_0x336558(0x21e)](0x1f4)['send'](_0x336558(0x23d)+_0x39b0bd);return;}_0xa2adb3[_0x336558(0x221)](_0x336558(0x340),_0x336558(0x245)),_0x10a9df[_0x336558(0x207)](_0xa2adb3);});}),router['get'](a0_0x2db209(0x2f9),auth,async(_0x18e3b5,_0x1f4b68)=>{const _0x35ac62=a0_0x2db209;try{const {username:_0x58cf70,email:_0x5e3c76,role:_0xf9b070}=_0x18e3b5[_0x35ac62(0x334)],_0x3a14ea=_0x18e3b5[_0x35ac62(0x334)],_0x2095a0=await profile[_0x35ac62(0x2d1)]({'email':_0x3a14ea[_0x35ac62(0x26a)]}),_0x182b9f={'year':_0x35ac62(0x303),'month':_0x35ac62(0x369),'day':_0x35ac62(0x303)},_0x46fd1f=await master_shop[_0x35ac62(0x214)](),_0x1dea7e=await product['find'](),_0x201612=await warehouse['aggregate']([{'$unwind':_0x35ac62(0x364)},{'$lookup':{'from':'products','localField':_0x35ac62(0x337),'foreignField':_0x35ac62(0x2d9),'as':_0x35ac62(0x2e9)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x35ac62(0x290),'product_stock':{'$sum':'$product_stock'}}}]),_0x237f15=await staff[_0x35ac62(0x2d1)]({'email':_0x3a14ea[_0x35ac62(0x26a)]});if(_0x46fd1f[0x0][_0x35ac62(0x252)]==_0x35ac62(0x2e1))var _0x2d933f=users[_0x35ac62(0x2b3)];else{if(_0x46fd1f[0x0]['language']==_0x35ac62(0x231))var _0x2d933f=users[_0x35ac62(0x231)];else{if(_0x46fd1f[0x0]['language']==_0x35ac62(0x265))var _0x2d933f=users[_0x35ac62(0x265)];else{if(_0x46fd1f[0x0][_0x35ac62(0x252)]==_0x35ac62(0x320))var _0x2d933f=users[_0x35ac62(0x320)];else{if(_0x46fd1f[0x0][_0x35ac62(0x252)]==_0x35ac62(0x32e))var _0x2d933f=users[_0x35ac62(0x32e)];else{if(_0x46fd1f[0x0]['language']==_0x35ac62(0x2bc))var _0x2d933f=users[_0x35ac62(0x253)];else{if(_0x46fd1f[0x0][_0x35ac62(0x252)]==_0x35ac62(0x258))var _0x2d933f=users[_0x35ac62(0x258)];else{if(_0x46fd1f[0x0]['language']==_0x35ac62(0x2cf))var _0x2d933f=users[_0x35ac62(0x260)];}}}}}}}_0x1f4b68[_0x35ac62(0x2cc)]('sales_reports',{'success':_0x18e3b5[_0x35ac62(0x341)](_0x35ac62(0x31e)),'errors':_0x18e3b5[_0x35ac62(0x341)](_0x35ac62(0x238)),'alldata':_0x1dea7e,'profile':_0x2095a0,'master_shop':_0x46fd1f,'role':_0x3a14ea,'product_stock':_0x201612,'language':_0x2d933f,'staff_arr':_0x237f15});}catch(_0x27b45d){}});async function dataSalesReports(_0x5c3182,_0x141704,_0x1ffc81){const _0xe1389b=a0_0x2db209;let _0x305535='';const _0x2431fd=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x5c3182,'$lte':_0x141704},'sales_staff_id':_0x1ffc81}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0xe1389b(0x26d)}},{'$group':{'_id':{'product_name':_0xe1389b(0x220),'product_code':_0xe1389b(0x271)},'sumqty':{'$sum':_0xe1389b(0x33b)},'totalPrice':{'$sum':_0xe1389b(0x2bd)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x298c18=0x0,_0x407442=0x0;for(let _0x533e70=0x0;_0x533e70<=_0x2431fd[_0xe1389b(0x205)]-0x1;_0x533e70++){const _0x44dfc4=_0x2431fd[_0x533e70];var _0x39b81b=_0x44dfc4[_0xe1389b(0x31a)][_0xe1389b(0x30d)](undefined),_0x2ebf6e=_0x44dfc4['sumqty'][_0xe1389b(0x30d)](undefined);_0x305535+=_0xe1389b(0x354),_0x305535+=_0xe1389b(0x2ee)+_0x44dfc4[_0xe1389b(0x239)]['product_code']+_0xe1389b(0x206),_0x305535+=_0xe1389b(0x2ee)+_0x44dfc4[_0xe1389b(0x239)]['product_name']+_0xe1389b(0x206),_0x305535+=_0xe1389b(0x2ee)+formatNumber(_0x44dfc4[_0xe1389b(0x2a6)][_0xe1389b(0x2da)](0x2))+_0xe1389b(0x206),_0x305535+=_0xe1389b(0x2ee)+formatNumber(_0x44dfc4[_0xe1389b(0x31a)][_0xe1389b(0x2da)](0x2))+_0xe1389b(0x206),_0x305535+='</tr>',_0x298c18+=parseFloat(_0x44dfc4[_0xe1389b(0x2a6)]),_0x407442+=parseFloat(_0x44dfc4[_0xe1389b(0x31a)]);}var _0x2ae9ea=_0x407442['toLocaleString'](undefined),_0x898b0=_0x298c18[_0xe1389b(0x30d)](undefined);return _0x305535+=_0xe1389b(0x354),_0x305535+=_0xe1389b(0x241),_0x305535+=_0xe1389b(0x256)+formatNumber(_0x298c18['toFixed'](0x2))+_0xe1389b(0x2a8),_0x305535+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x407442[_0xe1389b(0x2da)](0x2))+_0xe1389b(0x2a8),_0x305535+=_0xe1389b(0x2a5),_0x305535;}router[a0_0x2db209(0x31c)](a0_0x2db209(0x2a3),auth,async(_0x20536c,_0x31ea06)=>{const _0x543a0d=a0_0x2db209;try{const {from_date:_0x3635e4,to_date:_0x336718,isExcel:_0x681852}=_0x20536c['body'],_0x31a2f8=_0x20536c[_0x543a0d(0x334)],_0x3c1f0f=await staff[_0x543a0d(0x2d1)]({'email':_0x31a2f8[_0x543a0d(0x26a)]});let _0x374591=_0x543a0d(0x1fb);var _0x299434=new Date(_0x3635e4),_0xc9f753=new Date(_0x336718);const _0x2dfedc={'year':'numeric','month':_0x543a0d(0x369),'day':_0x543a0d(0x303)},_0x33936f=new Intl[(_0x543a0d(0x208))]('en-US',_0x2dfedc)[_0x543a0d(0x203)](_0x299434),_0x4428b5=new Intl['DateTimeFormat'](_0x543a0d(0x234),_0x2dfedc)[_0x543a0d(0x203)](_0xc9f753);var _0x35ea97=await dataSalesReports(_0x3635e4,_0x336718,_0x3c1f0f[_0x543a0d(0x239)][_0x543a0d(0x230)]());_0x374591+=_0x543a0d(0x359),_0x374591+='<div\x20class=\x22col-sm-11\x22>',_0x374591+=_0x543a0d(0x275),_0x374591+='<tr>',_0x374591+=_0x543a0d(0x236),_0x374591+=_0x543a0d(0x2fb),_0x374591+=_0x543a0d(0x314),_0x374591+=_0x543a0d(0x2bf),_0x374591+=_0x543a0d(0x354),_0x374591+=_0x35ea97,_0x374591+=_0x543a0d(0x2a5),_0x374591+=_0x543a0d(0x20a),_0x374591+=_0x543a0d(0x20a);let _0xf9f99c=_0x543a0d(0x1f9);const _0x1f0e84={'width':_0x543a0d(0x2ef),'height':_0x543a0d(0x22b),'orientation':_0x543a0d(0x23c),'border':{'top':_0x543a0d(0x1fe),'right':'0.1in','bottom':'0.1in','left':_0x543a0d(0x1fe)},'header':{'height':_0x543a0d(0x383),'contents':_0x543a0d(0x37a)+_0xf9f99c+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x3c1f0f['name']+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x33936f+'\x20-\x20'+_0x4428b5+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':'20mm','contents':{'default':_0x543a0d(0x36c)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x543a0d(0x322)}}};if(_0x681852=='on'){const _0x24560c=cheerio[_0x543a0d(0x22f)](_0x374591);let _0x42be06=[],_0x279e5d=[],_0x140df3=[];const _0x4ff58d=_0x4d78f2=>{const _0x293950=_0x543a0d,_0x27aea9={'top':{'style':_0x293950(0x21c),'color':{'rgb':_0x293950(0x27d)}},'bottom':{'style':_0x293950(0x21c),'color':{'rgb':_0x293950(0x27d)}},'left':{'style':_0x293950(0x21c),'color':{'rgb':_0x293950(0x27d)}},'right':{'style':_0x293950(0x21c),'color':{'rgb':'000000'}}};if(_0x4d78f2){const _0x3500ed=_0x4d78f2[_0x293950(0x24f)](';')[_0x293950(0x2b6)]((_0x57e665,_0x49eba3)=>{const _0x240e40=_0x293950,[_0x491975,_0xb01e4f]=_0x49eba3[_0x240e40(0x24f)](':')[_0x240e40(0x35b)](_0x141ee3=>_0x141ee3[_0x240e40(0x2b7)]());return _0x57e665[_0x491975]=_0xb01e4f,_0x57e665;},{});_0x3500ed[_0x293950(0x2aa)]&&(_0x27aea9[_0x293950(0x1f6)][_0x293950(0x2c1)]=_0x3500ed[_0x293950(0x2aa)][_0x293950(0x2e3)](_0x293950(0x213))?_0x293950(0x213):'medium'),_0x3500ed['border-bottom']&&(_0x27aea9[_0x293950(0x262)][_0x293950(0x2c1)]=_0x3500ed[_0x293950(0x21f)][_0x293950(0x2e3)](_0x293950(0x213))?_0x293950(0x213):_0x293950(0x2f7)),_0x3500ed[_0x293950(0x310)]&&(_0x27aea9[_0x293950(0x22a)][_0x293950(0x2c1)]=_0x3500ed[_0x293950(0x310)][_0x293950(0x2e3)](_0x293950(0x213))?_0x293950(0x213):'medium'),_0x3500ed[_0x293950(0x2ca)]&&(_0x27aea9[_0x293950(0x2cb)][_0x293950(0x2c1)]=_0x3500ed[_0x293950(0x2ca)][_0x293950(0x2e3)]('thin')?_0x293950(0x213):_0x293950(0x2f7));}return _0x27aea9;};_0x24560c('table\x20tr')[_0x543a0d(0x242)]((_0xe1cc8e,_0x5bda8b)=>{const _0x4e19f0=_0x543a0d;let _0x2a24df=[],_0xcf7ed5=0x0;while(_0x140df3[_0xcf7ed5]){_0x140df3[_0xcf7ed5]--,_0xcf7ed5++;}_0x24560c(_0x5bda8b)['find'](_0x4e19f0(0x2be))['each']((_0x88c48f,_0x123b29)=>{const _0x487165=_0x4e19f0;let _0xd8836d=_0x24560c(_0x123b29)[_0x487165(0x362)]()[_0x487165(0x2b7)](),_0x500b81=parseFloat(_0xd8836d[_0x487165(0x2ae)](/,/g,'')),_0x1668fd={};!isNaN(_0x500b81)?(_0x1668fd['v']=_0x500b81,_0x1668fd['t']='n'):(_0x1668fd['v']=_0xd8836d,_0x1668fd['t']='s');const _0x380d65=_0x24560c(_0x123b29)[_0x487165(0x374)]('style'),_0x175978=_0x4ff58d(_0x380d65);_0x1668fd['s']={'border':_0x175978},_0x2a24df[_0xcf7ed5]=_0x1668fd;let _0x56eca0=parseInt(_0x24560c(_0x123b29)[_0x487165(0x374)](_0x487165(0x32a)))||0x1,_0x35380d=parseInt(_0x24560c(_0x123b29)['attr'](_0x487165(0x2b0)))||0x1;(_0x56eca0>0x1||_0x35380d>0x1)&&_0x279e5d['push']({'s':{'r':_0xe1cc8e,'c':_0xcf7ed5},'e':{'r':_0xe1cc8e+_0x35380d-0x1,'c':_0xcf7ed5+_0x56eca0-0x1}});for(let _0x3194ed=0x0;_0x3194ed<_0x56eca0;_0x3194ed++){_0x35380d>0x1&&(_0x140df3[_0xcf7ed5+_0x3194ed]=_0x35380d-0x1);}_0xcf7ed5+=_0x56eca0;}),_0x42be06[_0x4e19f0(0x28d)](_0x2a24df);});const _0x5bd355=XLSX[_0x543a0d(0x384)][_0x543a0d(0x2de)](),_0x4fbbed=XLSX[_0x543a0d(0x384)][_0x543a0d(0x2f6)](_0x42be06);_0x279e5d[_0x543a0d(0x205)]>0x0&&(_0x4fbbed['!merges']=_0x279e5d);_0x4fbbed[_0x543a0d(0x209)]=_0x42be06[0x0][_0x543a0d(0x35b)](()=>({'wpx':0x64})),XLSX[_0x543a0d(0x384)][_0x543a0d(0x2e4)](_0x5bd355,_0x4fbbed,_0x543a0d(0x224));const _0x27a7e6=XLSX[_0x543a0d(0x313)](_0x5bd355,{'bookType':_0x543a0d(0x335),'type':_0x543a0d(0x272)});_0x31ea06['setHeader'](_0x543a0d(0x293),_0x543a0d(0x20c)),_0x31ea06[_0x543a0d(0x221)](_0x543a0d(0x340),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x31ea06[_0x543a0d(0x270)](_0x27a7e6);}else pdf['create'](_0x374591,_0x1f0e84)[_0x543a0d(0x202)](function(_0x2e3f1a,_0x41a44a){const _0x1c1467=_0x543a0d;if(_0x2e3f1a){_0x31ea06['status'](0x1f4)['send'](_0x1c1467(0x23d));return;}_0x31ea06[_0x1c1467(0x221)](_0x1c1467(0x340),_0x1c1467(0x245)),_0x41a44a[_0x1c1467(0x207)](_0x31ea06);});}catch(_0x40b104){}}),router['get'](a0_0x2db209(0x233),auth,async(_0x4b6a5b,_0x172a00)=>{const _0x28fcec=a0_0x2db209;try{const {username:_0x27b7d1,email:_0x4b0cb2,role:_0x21f103}=_0x4b6a5b[_0x28fcec(0x334)],_0x5d1ee3=_0x4b6a5b[_0x28fcec(0x334)],_0x3c1899=await profile[_0x28fcec(0x2d1)]({'email':_0x5d1ee3[_0x28fcec(0x26a)]}),_0x3e906f={'year':'numeric','month':_0x28fcec(0x369),'day':'numeric'},_0x317232=await master_shop[_0x28fcec(0x214)](),_0x1e1283=await product[_0x28fcec(0x214)](),_0x3d4c92=await warehouse[_0x28fcec(0x217)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x28fcec(0x352),'localField':_0x28fcec(0x337),'foreignField':_0x28fcec(0x2d9),'as':_0x28fcec(0x2e9)}},{'$unwind':_0x28fcec(0x34e)},{'$project':{'product_name':_0x28fcec(0x2ec),'product_stock':_0x28fcec(0x226)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);if(_0x317232[0x0][_0x28fcec(0x252)]=='English\x20(US)')var _0x12ee3a=users[_0x28fcec(0x2b3)];else{if(_0x317232[0x0]['language']=='Hindi')var _0x12ee3a=users['Hindi'];else{if(_0x317232[0x0][_0x28fcec(0x252)]==_0x28fcec(0x265))var _0x12ee3a=users['German'];else{if(_0x317232[0x0][_0x28fcec(0x252)]==_0x28fcec(0x320))var _0x12ee3a=users[_0x28fcec(0x320)];else{if(_0x317232[0x0]['language']==_0x28fcec(0x32e))var _0x12ee3a=users[_0x28fcec(0x32e)];else{if(_0x317232[0x0][_0x28fcec(0x252)]==_0x28fcec(0x2bc))var _0x12ee3a=users[_0x28fcec(0x253)];else{if(_0x317232[0x0]['language']=='Chinese')var _0x12ee3a=users[_0x28fcec(0x258)];else{if(_0x317232[0x0][_0x28fcec(0x252)]==_0x28fcec(0x2cf))var _0x12ee3a=users[_0x28fcec(0x260)];}}}}}}}_0x172a00[_0x28fcec(0x2cc)](_0x28fcec(0x28c),{'success':_0x4b6a5b[_0x28fcec(0x341)]('success'),'errors':_0x4b6a5b[_0x28fcec(0x341)]('errors'),'alldata':_0x1e1283,'profile':_0x3c1899,'master_shop':_0x317232,'role':_0x5d1ee3,'product_stock':_0x3d4c92,'language':_0x12ee3a});}catch(_0x2f1684){}});function a0_0x40c3(_0x25b2f2,_0x3cae4e){const _0xec29fc=a0_0xec29();return a0_0x40c3=function(_0x40c3b5,_0x530bcc){_0x40c3b5=_0x40c3b5-0x1f4;let _0x4dedc=_0xec29fc[_0x40c3b5];return _0x4dedc;},a0_0x40c3(_0x25b2f2,_0x3cae4e);}async function dataInventoryReports(_0xa1e6af,_0x45a202,_0x130143){const _0x36c7af=a0_0x2db209,_0x3cb8bb=await sales_sa[_0x36c7af(0x217)]([{'$match':{'date':{'$gte':_0xa1e6af,'$lte':_0x45a202},'sales_staff_id':_0x130143}},{'$unwind':_0x36c7af(0x332)},{'$group':{'_id':{'product_name':_0x36c7af(0x220),'product_code':_0x36c7af(0x271)},'sumqty':{'$sum':_0x36c7af(0x287)}}},{'$sort':{'_id.product_name':0x1}}]),_0x5756a1=mongoose['Types']['ObjectId'],_0x48945c=await staff['aggregate']([{'$match':{'_id':_0x5756a1(_0x130143)}},{'$unwind':_0x36c7af(0x324)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x36c7af(0x346),'product_code':'$product_list.product_code'},'sumqty':{'$sum':_0x36c7af(0x25a)}}},{'$sort':{'_id.product_name':0x1}}]),_0x3d4256=await sales_inv_data[_0x36c7af(0x217)]([{'$match':{'date':{'$gte':_0xa1e6af,'$lte':_0x45a202},'sales_staff_id':_0x130143}},{'$unwind':_0x36c7af(0x332)},{'$group':{'_id':{'product_name':_0x36c7af(0x220),'product_code':_0x36c7af(0x271)},'totalQTYsum':{'$sum':'$sale_product.stock'}}}]);console[_0x36c7af(0x365)](_0x3d4256);let _0x406274='';var _0x403a09=0x0;for(let _0x4fe4d1=0x0;_0x4fe4d1<=_0x48945c[_0x36c7af(0x205)]-0x1;_0x4fe4d1++){const _0x1afe86=_0x48945c[_0x4fe4d1];_0x406274+='<tr>',_0x406274+=_0x36c7af(0x25d)+_0x1afe86[_0x36c7af(0x239)]['product_code']+_0x36c7af(0x206),_0x406274+=_0x36c7af(0x2df)+_0x1afe86[_0x36c7af(0x239)][_0x36c7af(0x22e)]+_0x36c7af(0x206);var _0x1e4881=_0x1afe86['sumqty'],_0x548142=0x0;for(let _0x28c43d=0x0;_0x28c43d<=_0x3cb8bb[_0x36c7af(0x205)]-0x1;_0x28c43d++){const _0x3499f8=_0x3cb8bb[_0x28c43d];_0x1afe86['_id'][_0x36c7af(0x32f)]==_0x3499f8[_0x36c7af(0x239)][_0x36c7af(0x32f)]&&_0x1afe86[_0x36c7af(0x239)][_0x36c7af(0x22e)]==_0x3499f8['_id'][_0x36c7af(0x22e)]&&(_0x548142=_0x3499f8[_0x36c7af(0x2a6)]);}var _0x5738e9=0x0;for(let _0x559baa=0x0;_0x559baa<=_0x3d4256[_0x36c7af(0x205)]-0x1;_0x559baa++){const _0x9d155e=_0x3d4256[_0x559baa];_0x1afe86[_0x36c7af(0x239)][_0x36c7af(0x32f)]==_0x9d155e['_id'][_0x36c7af(0x32f)]&&_0x1afe86[_0x36c7af(0x239)][_0x36c7af(0x22e)]==_0x9d155e['_id']['product_name']&&(_0x5738e9=_0x9d155e[_0x36c7af(0x26c)]);}_0x403a09=_0x1e4881-_0x5738e9+_0x548142,_0x406274+=_0x36c7af(0x2ee)+_0x403a09+'</td>';let _0x278c97=![];for(let _0x1d4521=0x0;_0x1d4521<=_0x3d4256['length']-0x1;_0x1d4521++){const _0x49e2e6=_0x3d4256[_0x1d4521];if(_0x1afe86[_0x36c7af(0x239)]['product_code']==_0x49e2e6[_0x36c7af(0x239)][_0x36c7af(0x32f)]&&_0x1afe86[_0x36c7af(0x239)]['product_name']==_0x49e2e6[_0x36c7af(0x239)][_0x36c7af(0x22e)]){_0x406274+=_0x36c7af(0x2ee)+_0x49e2e6[_0x36c7af(0x26c)]+_0x36c7af(0x206),_0x278c97=!![];break;}}!_0x278c97&&(_0x406274+=_0x36c7af(0x30f));let _0x464dff=![];for(let _0x4c9396=0x0;_0x4c9396<=_0x3cb8bb[_0x36c7af(0x205)]-0x1;_0x4c9396++){const _0x1bcd12=_0x3cb8bb[_0x4c9396];if(_0x1afe86[_0x36c7af(0x239)][_0x36c7af(0x32f)]==_0x1bcd12['_id'][_0x36c7af(0x32f)]&&_0x1afe86[_0x36c7af(0x239)][_0x36c7af(0x22e)]==_0x1bcd12[_0x36c7af(0x239)][_0x36c7af(0x22e)]){_0x406274+='<td\x20class=\x22row_data\x22>'+_0x1bcd12[_0x36c7af(0x2a6)]+'</td>',_0x464dff=!![];break;}}!_0x464dff&&(_0x406274+=_0x36c7af(0x30f)),_0x406274+='<td\x20class=\x22row_data\x22>'+_0x1afe86[_0x36c7af(0x2a6)]+_0x36c7af(0x206),_0x406274+='</tr>';}return _0x406274;}router['post'](a0_0x2db209(0x1f7),auth,async(_0xfae1bb,_0x1b33bb)=>{const _0x17a962=a0_0x2db209;try{const {from_date:_0xd1be4f,to_date:_0x109efb}=_0xfae1bb[_0x17a962(0x300)],_0x50dae5=_0xfae1bb[_0x17a962(0x334)],_0x5ccc49=await staff['findOne']({'email':_0x50dae5[_0x17a962(0x26a)]});let _0x3f0f6e=_0x17a962(0x1fb);var _0x720aea=new Date(_0xd1be4f),_0x1d0a67=new Date(_0x109efb);const _0x2f6c64={'year':_0x17a962(0x303),'month':_0x17a962(0x369),'day':'numeric'},_0x3e09ff=new Intl['DateTimeFormat'](_0x17a962(0x234),_0x2f6c64)[_0x17a962(0x203)](_0x720aea),_0x287f3d=new Intl['DateTimeFormat'](_0x17a962(0x234),_0x2f6c64)[_0x17a962(0x203)](_0x1d0a67);var _0x3f4b97=await dataInventoryReports(_0xd1be4f,_0x109efb,_0x5ccc49[_0x17a962(0x239)][_0x17a962(0x230)]());_0x3f0f6e+=_0x17a962(0x2b5),_0x3f0f6e+=_0x17a962(0x33c),_0x3f0f6e+='<p>'+_0x3e09ff+_0x17a962(0x2ff)+_0x287f3d+_0x17a962(0x2dd),_0x3f0f6e+=_0x17a962(0x359),_0x3f0f6e+=_0x17a962(0x291),_0x3f0f6e+=_0x17a962(0x275),_0x3f0f6e+=_0x17a962(0x354),_0x3f0f6e+=_0x17a962(0x236),_0x3f0f6e+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x3f0f6e+=_0x17a962(0x1fa),_0x3f0f6e+=_0x17a962(0x264),_0x3f0f6e+=_0x17a962(0x2a4),_0x3f0f6e+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x3f0f6e+=_0x17a962(0x354),_0x3f0f6e+=_0x3f4b97,_0x3f0f6e+=_0x17a962(0x2a5),_0x3f0f6e+=_0x17a962(0x20a),_0x3f0f6e+=_0x17a962(0x20a);const _0x186d93={'format':'Letter','orientation':_0x17a962(0x23c),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x17a962(0x322)}}};pdf[_0x17a962(0x2e8)](_0x3f0f6e,_0x186d93)[_0x17a962(0x202)](function(_0x3c4283,_0x181955){const _0x39b399=_0x17a962;if(_0x3c4283){_0x1b33bb[_0x39b399(0x21e)](0x1f4)[_0x39b399(0x270)](_0x39b399(0x23d));return;}_0x1b33bb[_0x39b399(0x221)]('Content-Type','application/pdf'),_0x181955[_0x39b399(0x207)](_0x1b33bb);});}catch(_0x29530b){}}),router[a0_0x2db209(0x29c)]('/dsrr/view',auth,async(_0x1b9301,_0x3b7b28)=>{const _0x2b6aa6=a0_0x2db209;try{const {username:_0x574e5e,email:_0x246d0a,role:_0x4a0cb2}=_0x1b9301[_0x2b6aa6(0x334)],_0x414f5f=_0x1b9301['user'],_0xed179a=await profile[_0x2b6aa6(0x2d1)]({'email':_0x414f5f[_0x2b6aa6(0x26a)]}),_0x477327={'year':_0x2b6aa6(0x303),'month':_0x2b6aa6(0x369),'day':_0x2b6aa6(0x303)},_0x54a1b5=await master_shop['find']();console[_0x2b6aa6(0x365)]('Products\x20master',_0x54a1b5);const _0x2e4e1e=await product[_0x2b6aa6(0x214)]();console[_0x2b6aa6(0x365)]('Products\x20find_data',_0x2e4e1e);const _0x406dd8=await warehouse[_0x2b6aa6(0x217)]([{'$unwind':_0x2b6aa6(0x364)},{'$lookup':{'from':'products','localField':_0x2b6aa6(0x337),'foreignField':_0x2b6aa6(0x2d9),'as':_0x2b6aa6(0x2e9)}},{'$unwind':_0x2b6aa6(0x34e)},{'$project':{'product_name':_0x2b6aa6(0x2ec),'product_stock':_0x2b6aa6(0x226)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2b6aa6(0x2b4)}}}]);console[_0x2b6aa6(0x365)](_0x2b6aa6(0x2e0),_0x406dd8),_0x406dd8[_0x2b6aa6(0x2a2)](_0x528491=>{const _0x4550ad=_0x2b6aa6,_0x2a08ef=_0x2e4e1e[_0x4550ad(0x35b)](_0xe6bcfb=>{const _0x17b50f=_0x4550ad;_0xe6bcfb[_0x17b50f(0x2d9)]==_0x528491['_id']&&(_0xe6bcfb[_0x17b50f(0x26b)]=parseInt(_0xe6bcfb[_0x17b50f(0x26b)])+parseInt(_0x528491[_0x17b50f(0x2d6)]));});});const _0x23d8f6=await staff['findOne']({'email':_0x414f5f[_0x2b6aa6(0x26a)]});if(_0x54a1b5[0x0][_0x2b6aa6(0x252)]=='English\x20(US)')var _0x16be01=users['English'];else{if(_0x54a1b5[0x0][_0x2b6aa6(0x252)]=='Hindi')var _0x16be01=users['Hindi'];else{if(_0x54a1b5[0x0][_0x2b6aa6(0x252)]==_0x2b6aa6(0x265))var _0x16be01=users['German'];else{if(_0x54a1b5[0x0][_0x2b6aa6(0x252)]==_0x2b6aa6(0x320))var _0x16be01=users[_0x2b6aa6(0x320)];else{if(_0x54a1b5[0x0][_0x2b6aa6(0x252)]==_0x2b6aa6(0x32e))var _0x16be01=users[_0x2b6aa6(0x32e)];else{if(_0x54a1b5[0x0][_0x2b6aa6(0x252)]==_0x2b6aa6(0x2bc))var _0x16be01=users['Portuguese'];else{if(_0x54a1b5[0x0]['language']=='Chinese')var _0x16be01=users[_0x2b6aa6(0x258)];else{if(_0x54a1b5[0x0][_0x2b6aa6(0x252)]==_0x2b6aa6(0x2cf))var _0x16be01=users[_0x2b6aa6(0x260)];}}}}}}}_0x3b7b28[_0x2b6aa6(0x2cc)]('dssr_view',{'success':_0x1b9301[_0x2b6aa6(0x341)](_0x2b6aa6(0x31e)),'errors':_0x1b9301[_0x2b6aa6(0x341)](_0x2b6aa6(0x238)),'alldata':_0x2e4e1e,'profile':_0xed179a,'master_shop':_0x54a1b5,'role':_0x414f5f,'product_stock':_0x406dd8,'language':_0x16be01,'staff_arr':_0x23d8f6});}catch(_0x162997){}});function a0_0xec29(){const _0x277079=['</tbody>','Content-Disposition','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','discount','$status_data','/dsrr_admin/view_data/:id','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','PDF\x20Generation\x20Error:','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','html','get','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','sales_staff_id','isFG','$cash','then','forEach','/total_sales_reports/pdf','<th>\x20SALES\x20</th>','</tr>','sumqty','<td\x20class=\x22row_data\x22></td>','</b></td>','$products.product_details','border-top','$product.product_name','json','html-pdf','replace','<th\x20rowspan=\x272\x27>Products</th>','rowspan','params','3mPVnTw','English','$product_stock','<h1>JAKA\x20EQUITIES\x20CORP</h1>','reduce','trim','deleteOne','total','$_id.category','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','Portuguese\x20(BR)','$sale_product.totalprice','td,\x20th','<th>\x20INVOICE\x20AMOUNT\x20</th>','/getDSSR_no_sales','style','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','/balance/view','canvas','/agent_reports/view','note','</script>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','border-right','right','render','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','dataqty','Arabic\x20(ae)','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','findOne','12509YlxvXa','435046zOLCfl','dsi_sales_admin','adj_discount','product_stock','staffs','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','name','toFixed','\x22><b></b></td>','findById','</p>','book_new','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','Products\x20warehouse_data','English\x20(US)','../middleware/auth','includes','book_append_sheet','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','$_id.status_data','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','create','product_docs','agent_sales','$product_info.brand','$product_details.product_name','amount','<td\x20class=\x22row_data\x22>','15in','/agent_reports/pdf','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','path','\x22\x20class=\x22cat_data\x22>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','aoa_to_sheet','medium','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','/total_sales_reports/view','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','slice','isArray','\x20-\x20','body','sales_ext','/agent/view','numeric','totalQty','/reports/dsrr/view','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','$sales_info.name','sale_product.product_code','totalGross','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','toLocaleString','/dl_excel','<td\x20class=\x22row_data\x22>0</td>','border-left','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','salesman_data','write','<th>\x20QTY\x20SOLD\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','Checking:\x20','$totalGross','<td\x20class=\x22cat_data\x22>','$adj_discount','totalPrice','sales_info','post','<p>SALES\x20REPORTS</p>','success','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','Spanish','due_date','/dev/null','\x20<>\x20','$product_list','Household','$products.NetPrice','brand','catch','<th\x20rowspan=\x272\x27>Category</th>','colspan','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','</table>','French','product_code','$products.qty','765369rsYplZ','$sale_product','Products\x20master','user','xlsx','table\x20tr','product_details.product_name','/agent/pdf','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','\x20-\x20STD','$sale_product.real_qty_unit_val','<p>INVENTORY\x20SUMMARY</p>','$sale_product.prod_cat','4084580ZzhBoK','NumberFormat','Content-Type','flash','getFullYear','save','$sale_product._id','$amount','$product_list.product_name','$dsi','$products.adj_discount','$product_info.gross_price','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','cash','$name','57455IXSCNZ','$product_docs','blob-stream','$_id.date','<thead>','products','$products.discount','<tr>','$sales_info._id','pdfkit-table','$product_info','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','<div\x20class=\x22row\x22>','$_id.brand','map','$date','9fsyzox','/agent_reports/pdf_admin','window.onload\x20=\x20function()\x20{','date','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','text','$category','$product_details','log','cat_brand','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','$products.product_details.brand','long','<th>X-Truck</th>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','1254UtNCIt','$discount','4dbbbfR','sales_bkg','<p>FINISHED\x20GOODS\x20INVENTORY</p>','<p>','express','attr','beg_bal','$NetPrice','/dsrr_admin/view','excel','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','$sale_product.adj_discount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','multer','No\x20data\x20was\x20Found!','$products.product_details.gross_price','product_details','</thead>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','60mm','utils','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','getDate','filter','top','/inventory_sum/pdf','toISOString','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','<th>\x20BEG\x20BALANCE\x20</th>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','Letter','referenceNumber','0.1in','20mm','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','toStream','format','sales_man_code','length','</td>','pipe','DateTimeFormat','!cols','</div>','setDate','attachment;\x20filename=\x22sales_report.xlsx\x22','product_info','../public/language/languages.json','!merges','prod_cat','/balance/pdf','$due_date','thin','find','$totalQty','totalQTY','aggregate','/getDSSR_no','NetPrice','<th\x20rowspan=\x272\x27>Production</th>','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','thick','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','status','border-bottom','$sale_product.product_name','setHeader','<div\x20style=\x22page-break-before:\x20always;\x22></div>','exports','Sales\x20Report','$check_no','$product_details.product_stock','<td\x20colspan=\x22','<td\x20class=\x22cat_data\x22></td>','../models/all_models','left','8.5in','$sales_info','$product_info.category','product_name','load','valueOf','Hindi','$sales_staff_id','/inventory_sum/view','en-US','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<th>\x20ITEM\x20CODE\x20</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','errors','_id','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','landscape','Error\x20generating\x20PDF','$product_code','mongoose','redirect','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','each','2030872eDhMYI','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','application/pdf','784845MbWYKN','Products\x20find_data','category','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','$_id.customer','qty','$sale_product.discount','customer','split','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$products','language','Portuguese','$product_info.product_code','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20class=\x22row_data\x22><b>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','Chinese','<th>Booking</th>','$product_list.product_stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','\x22><b>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','Router','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','Arabic','\x20-\x20HH','bottom','toLocaleDateString','<th>\x20INCOMING\x20</th>','German','dssr_view_admin','Standard','getMonth','bank','email','stock','totalQTYsum','false','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','window.print();','send','$sale_product.product_code','buffer','<td\x20colspan=\x223\x22><b>TOTAL<b>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','<table>','true','$products.product_details.category','<td\x20class=\x22cat_data\x22><b>FG</b></td>','$product.product_code','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','cheerio','$customer','000000','<div\x20\x20id=\x22table-conatainer\x22>','<tbody>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','dsi','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','brandCount','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','$_id.dsi','$brand','$sale_product.quantity','error','$product_info.name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<script>','inventory_sum','push','date_include','$bank','$product_name','<div\x20class=\x22col-sm-11\x22>'];a0_0xec29=function(){return _0x277079;};return a0_0xec29();}async function agentsdataDSICheck_DSRR(_0x2d93e2,_0x1fb1f0,_0x9ca05e,_0x55b8f6){const _0x2828d5=a0_0x2db209;let _0x47ec0e=new Date(_0x2d93e2);_0x47ec0e[_0x2828d5(0x20b)](_0x47ec0e['getDate']()-0x1);let _0x138cb1=_0x47ec0e[_0x2828d5(0x1f8)]()['split']('T')[0x0];const _0x4371ae=await product[_0x2828d5(0x217)]([{'$group':{'_id':{'brand':_0x2828d5(0x286),'category':_0x2828d5(0x363)},'products':{'$push':{'name':_0x2828d5(0x34c),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x931f8=[];_0x931f8[_0x2828d5(0x366)]=[];for(let _0x2da993=0x0;_0x2da993<=_0x4371ae[_0x2828d5(0x205)]-0x1;_0x2da993++){const _0x25f7ad=_0x4371ae[_0x2da993];_0x931f8[_0x2828d5(0x366)][_0x2828d5(0x28d)](_0x25f7ad);}const _0x58e559=await product[_0x2828d5(0x217)]([{'$group':{'_id':{'category':_0x2828d5(0x363)},'products':{'$push':{'brand':_0x2828d5(0x286),'product_code':_0x2828d5(0x23e),'product_name':_0x2828d5(0x34c)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1c59b7=await product[_0x2828d5(0x217)]([{'$group':{'_id':{'category':_0x2828d5(0x363),'brand':_0x2828d5(0x286)}}},{'$group':{'_id':_0x2828d5(0x2ba),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x586a8b=await sales_sa[_0x2828d5(0x217)]([{'$match':{'date':_0x2d93e2,'sales_staff_id':_0x1fb1f0,'sale_product.isFG':_0x2828d5(0x26d)}},{'$unwind':_0x2828d5(0x332)},{'$lookup':{'from':'products','localField':_0x2828d5(0x30a),'foreignField':_0x2828d5(0x32f),'as':_0x2828d5(0x20d)}},{'$unwind':_0x2828d5(0x357)},{'$group':{'_id':{'dsi':_0x2828d5(0x347),'date':_0x2828d5(0x35c),'customer':_0x2828d5(0x27c),'status_data':_0x2828d5(0x296)},'totalQty':{'$sum':_0x2828d5(0x33b)},'cash':{'$first':'$cash'},'amount':{'$first':_0x2828d5(0x345)},'bank':{'$first':_0x2828d5(0x28f)},'check_no':{'$first':_0x2828d5(0x225)},'due_date':{'$first':_0x2828d5(0x212)},'products':{'$push':{'qty':_0x2828d5(0x33b),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0x2828d5(0x37b),'product_details':{'prod_name':_0x2828d5(0x289),'product_code':'$product_info.product_code','category':_0x2828d5(0x22d),'brand':_0x2828d5(0x2eb),'gross_price':_0x2828d5(0x349),'isFG':'$sale_product.isFG','prod_cat':_0x2828d5(0x33d),'prod_id':_0x2828d5(0x344)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x2828d5(0x285),'date':_0x2828d5(0x350),'customer':'$_id.customer','status_data':_0x2828d5(0x2e6),'category':'$products.product_details.category','brand':'$products.product_details.brand','prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x2828d5(0x37f)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x2828d5(0x353)},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':_0x2828d5(0x2a0)},'amount':{'$first':_0x2828d5(0x345)},'bank':{'$first':_0x2828d5(0x28f)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x2828d5(0x212)},'product_details':{'$first':_0x2828d5(0x2a9)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':'$_id.customer','status_data':'$_id.status_data'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x2828d5(0x376)},'discount':{'$sum':_0x2828d5(0x36e)},'adj_discount':{'$sum':_0x2828d5(0x319)},'cash':{'$first':'$cash'},'amount':{'$first':_0x2828d5(0x345)},'bank':{'$first':_0x2828d5(0x28f)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x2828d5(0x215),'category':_0x2828d5(0x2ba),'brand':_0x2828d5(0x35a),'product_details':_0x2828d5(0x364)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x57ab4e=await sales_sa[_0x2828d5(0x217)]([{'$match':{'date':_0x138cb1,'sales_staff_id':_0x1fb1f0,'sale_product.isFG':_0x2828d5(0x26d)}},{'$unwind':_0x2828d5(0x332)},{'$lookup':{'from':_0x2828d5(0x352),'localField':_0x2828d5(0x30a),'foreignField':'product_code','as':_0x2828d5(0x20d)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x2828d5(0x347),'date':_0x2828d5(0x35c),'customer':_0x2828d5(0x27c)},'totalQty':{'$sum':_0x2828d5(0x33b)},'cash':{'$first':_0x2828d5(0x2a0)},'amount':{'$first':_0x2828d5(0x345)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x2828d5(0x212)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x2828d5(0x2bd),'discount':'$sale_product.discount','adj_discount':_0x2828d5(0x37b),'product_details':{'prod_name':_0x2828d5(0x289),'product_code':'$product_info.product_code','category':_0x2828d5(0x22d),'brand':_0x2828d5(0x2eb),'gross_price':_0x2828d5(0x349),'isFG':'$sale_product.isFG','prod_cat':'$sale_product.prod_cat','prod_id':_0x2828d5(0x344)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x2828d5(0x350),'customer':_0x2828d5(0x24b),'category':_0x2828d5(0x277),'brand':_0x2828d5(0x368),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x2828d5(0x330)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':'$bank'},'check_no':{'$first':_0x2828d5(0x225)},'due_date':{'$first':_0x2828d5(0x212)},'totalGross':{'$sum':{'$multiply':[_0x2828d5(0x330),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x2828d5(0x326)},'discount':{'$sum':_0x2828d5(0x353)},'adj_discount':{'$sum':_0x2828d5(0x348)},'product_details':{'$first':_0x2828d5(0x2a9)}}},{'$group':{'_id':{'dsi':_0x2828d5(0x285),'date':_0x2828d5(0x350),'customer':_0x2828d5(0x24b)},'totalQty':{'$sum':_0x2828d5(0x215)},'cash':{'$first':_0x2828d5(0x2a0)},'amount':{'$first':'$amount'},'bank':{'$first':_0x2828d5(0x28f)},'check_no':{'$first':_0x2828d5(0x225)},'due_date':{'$first':_0x2828d5(0x212)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x2828d5(0x376)},'discount':{'$sum':_0x2828d5(0x36e)},'adj_discount':{'$sum':_0x2828d5(0x319)},'products':{'$push':{'qty':_0x2828d5(0x215),'category':_0x2828d5(0x2ba),'brand':_0x2828d5(0x35a),'product_details':_0x2828d5(0x364)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x1d061f=await sales_sa['aggregate']([{'$match':{'date':_0x2d93e2,'sales_staff_id':_0x1fb1f0,'status_data':_0x2828d5(0x276)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xd3b27b=await staff[_0x2828d5(0x2dc)](_0x1fb1f0);let _0x1aa410=[],_0x51a5c8={},_0x5ebfa2={};var _0x108ebe=0x0,_0x444b1b=0x0,_0x2c7bfc=0x0,_0x5139c6=0x0,_0x36a3ce=0x0;const _0x5b8de2=0x6;var _0x22d948=0x0,_0x8da458=0x0;for(let _0x3f22f1=0x0;_0x3f22f1<=_0x586a8b[_0x2828d5(0x205)]-0x1;_0x3f22f1++){const _0x19c080=_0x586a8b[_0x3f22f1];let _0x1a299d=_0x2828d5(0x354);_0x1a299d+=_0x2828d5(0x2e5),_0x1a299d+=_0x2828d5(0x2f1)+_0x19c080[_0x2828d5(0x239)]['customer']+_0x2828d5(0x206),_0x1a299d+=_0x2828d5(0x2f1)+_0x19c080[_0x2828d5(0x239)][_0x2828d5(0x281)]+_0x2828d5(0x206);let _0x621778={},_0x1d5329={},_0x5220bb={};var _0x10ceaa={},_0x22370b={},_0x160245={},_0x5b59c4=0x0;for(let _0x5f3864=0x0;_0x5f3864<=_0x19c080['products']['length']-0x1;_0x5f3864++){const _0x174669=_0x19c080[_0x2828d5(0x352)][_0x5f3864];_0x621778[_0x174669['brand']+'-'+_0x174669[_0x2828d5(0x248)]]=_0x174669['qty'],_0x1d5329[[_0x174669[_0x2828d5(0x327)]+'-'+_0x174669['category']]]=_0x174669[_0x2828d5(0x380)][_0x2828d5(0x29f)],_0x5220bb[[_0x174669[_0x2828d5(0x327)]+'-'+_0x174669['category']]]=_0x174669[_0x2828d5(0x380)][_0x2828d5(0x210)];const _0x28cd4d=_0x174669['brand']+'-'+_0x174669[_0x2828d5(0x248)];!Array[_0x2828d5(0x2fe)](_0x5ebfa2[_0x28cd4d])&&(_0x5ebfa2[_0x28cd4d]=[]);!Array[_0x2828d5(0x2fe)](_0x5ebfa2[_0x28cd4d])&&(_0x5ebfa2[_0x28cd4d]=[]);_0x5ebfa2[_0x28cd4d][_0x2828d5(0x28d)](_0x174669['qty']);if(_0x174669[_0x2828d5(0x380)]['prod_cat']=='P')_0x174669['product_details'][_0x2828d5(0x29f)]==_0x2828d5(0x276)?(!_0x160245[_0x28cd4d]&&(_0x160245[_0x28cd4d]=0x0),_0x160245[_0x28cd4d]=_0x174669[_0x2828d5(0x24c)]):(!_0x10ceaa[_0x28cd4d]&&(_0x10ceaa[_0x28cd4d]=0x0),_0x10ceaa[_0x28cd4d]=_0x174669['qty']);else _0x174669[_0x2828d5(0x380)]['prod_cat']=='S'&&(_0x174669['product_details'][_0x2828d5(0x29f)]==_0x2828d5(0x276)?(!_0x160245[_0x28cd4d]&&(_0x160245[_0x28cd4d]=0x0),_0x160245[_0x28cd4d]=_0x174669[_0x2828d5(0x24c)]):(!_0x22370b[_0x28cd4d]&&(_0x22370b[_0x28cd4d]=0x0),_0x22370b[_0x28cd4d]=_0x174669[_0x2828d5(0x24c)]));_0x5b59c4++;}for(let _0x1fc763=0x0;_0x1fc763<=_0x931f8[_0x2828d5(0x366)]['length']-0x1;_0x1fc763++){const _0x59b864=_0x931f8[_0x2828d5(0x366)][_0x1fc763],_0x1df706=_0x59b864[_0x2828d5(0x239)]['brand']+'-'+_0x59b864[_0x2828d5(0x239)]['category'],_0x314785=_0x5220bb[_0x1df706]!==undefined?_0x5220bb[_0x1df706]:'NA';var _0x4e6fc1=_0x10ceaa[_0x1df706]!==undefined?_0x10ceaa[_0x1df706]['toFixed'](0x2):'',_0x127c45=_0x22370b[_0x1df706]!==undefined?_0x22370b[_0x1df706][_0x2828d5(0x2da)](0x2):'',_0x29e5e8=_0x160245[_0x1df706]!==undefined?_0x160245[_0x1df706]['toFixed'](0x2):'';_0x1a299d+=_0x2828d5(0x2d8)+_0x4e6fc1+_0x2828d5(0x206),_0x1a299d+=_0x2828d5(0x2d8)+_0x127c45+_0x2828d5(0x206),_0x1a299d+=_0x2828d5(0x2d8)+_0x29e5e8+'</td>';}var _0xa6c9e3=formatNumber(parseFloat(_0x19c080[_0x2828d5(0x34b)])),_0x35d2f2=formatNumber(parseFloat(_0x19c080[_0x2828d5(0x2ed)]));isNaN(_0x35d2f2)&&(_0x35d2f2=0x0),_0x1a299d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0xa6c9e3+_0x2828d5(0x206),_0x1a299d+=_0x2828d5(0x2d8)+_0x35d2f2+'</td>',_0x1a299d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x19c080[_0x2828d5(0x269)]+'</td>',_0x1a299d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x19c080['check_no']+_0x2828d5(0x206),_0x1a299d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x19c080[_0x2828d5(0x321)]+_0x2828d5(0x206),_0x2c7bfc=_0x19c080[_0x2828d5(0x295)]+_0x19c080[_0x2828d5(0x2d5)],_0x22d948+=parseFloat(_0x19c080[_0x2828d5(0x34b)]),_0x8da458+=parseFloat(_0x35d2f2),_0x1aa410[_0x2828d5(0x28d)](_0x1a299d);}if(_0x1d061f[_0x2828d5(0x205)]>0x0)for(let _0x3b717b=0x0;_0x3b717b<=_0x1d061f[_0x2828d5(0x205)]-0x1;_0x3b717b++){const _0x298978=_0x1d061f[_0x3b717b];console['log'](_0x298978);let _0x2a01c5=_0x2828d5(0x354);_0x2a01c5+=_0x2828d5(0x2cd)+(0x8+0x7*0x3)+_0x2828d5(0x25c)+_0x298978[_0x2828d5(0x2c7)]+_0x2828d5(0x2a8),_0x2a01c5+=_0x2828d5(0x2a5),_0x1aa410[_0x2828d5(0x28d)](_0x2a01c5);}function _0x4601d(_0x399304,_0x203709){const _0x275950=_0x2828d5,_0xff815a=[];for(let _0x4da3ee=0x0;_0x4da3ee<=_0x399304[_0x275950(0x205)]-0x1;_0x4da3ee+=_0x203709){_0xff815a['push'](_0x399304[_0x275950(0x2fd)](_0x4da3ee,_0x4da3ee+_0x203709));}return _0xff815a;}const _0x3156e7=_0x4601d(_0x1aa410,_0x5b8de2);let _0x1e81ec='';return _0x3156e7['forEach']((_0x354333,_0x397805)=>{const _0x9e66f5=_0x2828d5;_0x397805>0x0&&(_0x1e81ec+=_0x9e66f5(0x222));_0x1e81ec+='<table>',_0x1e81ec+=_0x9e66f5(0x351);const _0x9bf0f6=new Date(_0x2d93e2),_0x5420f8={'year':_0x9e66f5(0x303),'month':_0x9e66f5(0x369),'day':_0x9e66f5(0x303),'timeZone':'Asia/Manila'},_0xdc3a6b=_0x9bf0f6[_0x9e66f5(0x263)](_0x9e66f5(0x234),_0x5420f8);_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+=_0x9e66f5(0x282)+_0x55b8f6+'</b></td>',_0x1e81ec+='</tr>',_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0xd3b27b[_0x9e66f5(0x2d9)]+_0x9e66f5(0x206),_0x1e81ec+=_0x9e66f5(0x280),_0x1e81ec+=_0x9e66f5(0x308),_0x1e81ec+='<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>',_0x1e81ec+=_0x9e66f5(0x37c),_0x1e81ec+=_0x9e66f5(0x339),_0x1e81ec+=_0x9e66f5(0x361),_0x1e81ec+=_0x9e66f5(0x249),_0x1e81ec+=_0x9e66f5(0x2c3),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x1e81ec+=_0x9e66f5(0x311)+_0xdc3a6b+_0x9e66f5(0x206),_0x1e81ec+=_0x9e66f5(0x2f8),_0x1e81ec+=_0x9e66f5(0x2f2),_0x1e81ec+=_0x9e66f5(0x250),_0x1e81ec+=_0x9e66f5(0x250),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+='<tr>',_0x1e81ec+=_0x9e66f5(0x24a),_0x1e81ec+=_0x9e66f5(0x257),_0x1e81ec+=_0x9e66f5(0x28a),_0x1e81ec+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x1e81ec+=_0x9e66f5(0x250),_0x1e81ec+='</tr>',_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+=_0x9e66f5(0x367),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+='<tr>',_0x1e81ec+=_0x9e66f5(0x255),_0x1e81ec+=_0x9e66f5(0x385),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+=_0x9e66f5(0x25f),_0x1e81ec+=_0x9e66f5(0x386),_0x1e81ec+=_0x9e66f5(0x23b);for(let _0x3aa77b=0x0;_0x3aa77b<=_0x58e559[_0x9e66f5(0x205)]-0x1;_0x3aa77b++){const _0x46aca2=_0x58e559[_0x3aa77b];for(let _0x56caff=0x0;_0x56caff<_0x931f8[_0x9e66f5(0x366)]['length'];_0x56caff++){const _0x364388=_0x931f8['cat_brand'][_0x56caff];if(_0x364388[_0x9e66f5(0x239)][_0x9e66f5(0x248)]===_0x46aca2[_0x9e66f5(0x239)][_0x9e66f5(0x248)]){var _0x5459d6='';switch(_0x46aca2[_0x9e66f5(0x239)]['category']){case _0x9e66f5(0x267):_0x5459d6=_0x364388[_0x9e66f5(0x239)][_0x9e66f5(0x327)]+_0x9e66f5(0x33a);break;case _0x9e66f5(0x325):_0x5459d6=_0x364388[_0x9e66f5(0x239)][_0x9e66f5(0x327)]+_0x9e66f5(0x261);break;default:_0x5459d6=_0x364388[_0x9e66f5(0x239)][_0x9e66f5(0x327)];break;}_0x1e81ec+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>'+_0x5459d6+_0x9e66f5(0x2a8);}}}_0x1e81ec+=_0x9e66f5(0x31f),_0x1e81ec+=_0x9e66f5(0x306),_0x1e81ec+=_0x9e66f5(0x34a),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+=_0x9e66f5(0x294);for(let _0x1769bc=0x0;_0x1769bc<=_0x931f8[_0x9e66f5(0x366)][_0x9e66f5(0x205)]-0x1;_0x1769bc++){const _0x353f5c=_0x931f8[_0x1769bc];_0x1e81ec+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x1e81ec+=_0x9e66f5(0x27a),_0x1e81ec+=_0x9e66f5(0x278);}_0x1e81ec+=_0x9e66f5(0x315),_0x1e81ec+=_0x9e66f5(0x2bb),_0x1e81ec+=_0x9e66f5(0x2f5),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+=_0x9e66f5(0x381),_0x1e81ec+='<tbody>',_0x354333[_0x9e66f5(0x2a2)](_0x3956f9=>{_0x1e81ec+=_0x3956f9;});let _0x6a2d14={},_0xec3024={},_0x5beaf5={};for(let _0x3ed863=0x0;_0x3ed863<=_0x586a8b['length']-0x1;_0x3ed863++){const _0x5bc21c=_0x586a8b[_0x3ed863];var _0x1f4a71=0x0;for(let _0x574c98=0x0;_0x574c98<=_0x5bc21c[_0x9e66f5(0x352)][_0x9e66f5(0x205)]-0x1;_0x574c98++){const _0x5d852e=_0x5bc21c[_0x9e66f5(0x352)][_0x574c98],_0x3b45af=_0x5d852e[_0x9e66f5(0x327)]+'-'+_0x5d852e[_0x9e66f5(0x248)];if(_0x5d852e['product_details'][_0x9e66f5(0x210)]=='P')_0x5d852e[_0x9e66f5(0x380)][_0x9e66f5(0x29f)]==_0x9e66f5(0x276)?(!_0x5beaf5[_0x3b45af]&&(_0x5beaf5[_0x3b45af]=0x0),_0x5beaf5[_0x3b45af]+=_0x5d852e[_0x9e66f5(0x24c)]):(!_0x6a2d14[_0x3b45af]&&(_0x6a2d14[_0x3b45af]=0x0),_0x6a2d14[_0x3b45af]+=_0x5d852e[_0x9e66f5(0x24c)]);else _0x5d852e[_0x9e66f5(0x380)][_0x9e66f5(0x210)]=='S'&&(_0x5d852e[_0x9e66f5(0x380)]['isFG']==_0x9e66f5(0x276)?(!_0x5beaf5[_0x3b45af]&&(_0x5beaf5[_0x3b45af]=0x0),_0x5beaf5[_0x3b45af]+=_0x5d852e['qty'],console[_0x9e66f5(0x365)](_0x5d852e[_0x9e66f5(0x24c)])):(!_0xec3024[_0x3b45af]&&(_0xec3024[_0x3b45af]=0x0),_0xec3024[_0x3b45af]+=_0x5d852e[_0x9e66f5(0x24c)]));_0x1f4a71++;}}let _0x424deb={},_0x206f36={},_0x171f8c={};var _0x136b9f=0x0,_0x1f7fbe=0x0;for(let _0x24cb41=0x0;_0x24cb41<=_0x57ab4e['length']-0x1;_0x24cb41++){const _0x396cd2=_0x57ab4e[_0x24cb41];var _0x1f4a71=0x0;for(let _0x48532d=0x0;_0x48532d<=_0x396cd2[_0x9e66f5(0x352)]['length']-0x1;_0x48532d++){const _0x222000=_0x396cd2[_0x9e66f5(0x352)][_0x48532d],_0x38d3f6=_0x222000[_0x9e66f5(0x327)]+'-'+_0x222000[_0x9e66f5(0x248)];if(_0x222000['product_details'][_0x9e66f5(0x210)]=='P')_0x222000[_0x9e66f5(0x380)][_0x9e66f5(0x29f)]=='true'?(!_0x171f8c[_0x38d3f6]&&(_0x171f8c[_0x38d3f6]=0x0),_0x171f8c[_0x38d3f6]+=_0x222000[_0x9e66f5(0x24c)]):(!_0x424deb[_0x38d3f6]&&(_0x424deb[_0x38d3f6]=0x0),_0x424deb[_0x38d3f6]+=_0x222000[_0x9e66f5(0x24c)]);else _0x222000[_0x9e66f5(0x380)][_0x9e66f5(0x210)]=='S'&&(_0x222000[_0x9e66f5(0x380)][_0x9e66f5(0x29f)]=='true'?(!_0x171f8c[_0x38d3f6]&&(_0x171f8c[_0x38d3f6]=0x0),_0x171f8c[_0x38d3f6]+=_0x222000[_0x9e66f5(0x24c)]):(!_0x206f36[_0x38d3f6]&&(_0x206f36[_0x38d3f6]=0x0),_0x206f36[_0x38d3f6]+=_0x222000[_0x9e66f5(0x24c)]));_0x1f4a71++;}var _0x115714=parseFloat(_0x396cd2['cash']),_0x1873a2=parseFloat(_0x396cd2[_0x9e66f5(0x2ed)]);isNaN(_0x1873a2)&&(_0x1873a2=0x0),_0x136b9f+=_0x115714,_0x1f7fbe+=_0x1873a2;}_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x1e81ec+=_0x9e66f5(0x379),_0x1e81ec+=_0x9e66f5(0x2e5);for(let _0x1e439e=0x0;_0x1e439e<=_0x931f8[_0x9e66f5(0x366)]['length']-0x1;_0x1e439e++){const _0x162c4b=_0x931f8[_0x9e66f5(0x366)][_0x1e439e],_0x30aa89=_0x162c4b[_0x9e66f5(0x239)][_0x9e66f5(0x327)]+'-'+_0x162c4b[_0x9e66f5(0x239)][_0x9e66f5(0x248)];var _0x40afc4=_0x6a2d14[_0x30aa89]!==undefined?formatNumber(_0x6a2d14[_0x30aa89][_0x9e66f5(0x2da)](0x2)):'',_0x2e1dbd=_0x5beaf5[_0x30aa89]!==undefined?formatNumber(_0x5beaf5[_0x30aa89][_0x9e66f5(0x2da)](0x2)):'',_0x5014fb=_0xec3024[_0x30aa89]!==undefined?formatNumber(_0xec3024[_0x30aa89]['toFixed'](0x2)):'';_0x1e81ec+=_0x9e66f5(0x2c2)+_0x40afc4+_0x9e66f5(0x2a8),_0x1e81ec+=_0x9e66f5(0x2c2)+_0x5014fb+_0x9e66f5(0x2a8),_0x1e81ec+=_0x9e66f5(0x2c2)+_0x2e1dbd+_0x9e66f5(0x2a8);}_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x22d948)+_0x9e66f5(0x2a8),_0x1e81ec+=_0x9e66f5(0x2c2)+formatNumber(_0x8da458)+_0x9e66f5(0x2a8),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+=_0x9e66f5(0x29d),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>',_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x529dbf=0x0;_0x529dbf<=_0x931f8[_0x9e66f5(0x366)][_0x9e66f5(0x205)]-0x1;_0x529dbf++){const _0xe62791=_0x931f8[_0x9e66f5(0x366)][_0x529dbf],_0x461d32=_0xe62791['_id'][_0x9e66f5(0x327)]+'-'+_0xe62791[_0x9e66f5(0x239)]['category'];var _0x40afc4=_0x424deb[_0x461d32]!==undefined?formatNumber(_0x424deb[_0x461d32]['toFixed'](0x2)):'',_0x2e1dbd=_0x171f8c[_0x461d32]!==undefined?formatNumber(_0x171f8c[_0x461d32][_0x9e66f5(0x2da)](0x2)):'',_0x5014fb=_0x206f36[_0x461d32]!==undefined?formatNumber(_0x206f36[_0x461d32][_0x9e66f5(0x2da)](0x2)):'';_0x1e81ec+=_0x9e66f5(0x2c2)+_0x40afc4+_0x9e66f5(0x2a8),_0x1e81ec+=_0x9e66f5(0x2c2)+_0x5014fb+_0x9e66f5(0x2a8),_0x1e81ec+=_0x9e66f5(0x2c2)+_0x2e1dbd+_0x9e66f5(0x2a8);}_0x1e81ec+=_0x9e66f5(0x2c2)+formatNumber(_0x136b9f)+'</b></td>',_0x1e81ec+=_0x9e66f5(0x2c2)+formatNumber(_0x1f7fbe)+_0x9e66f5(0x2a8),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+='</tr>',_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+=_0x9e66f5(0x29d),_0x1e81ec+=_0x9e66f5(0x25b),_0x1e81ec+=_0x9e66f5(0x2e5);let _0x342ddb=0x0,_0x58a38b=0x0,_0x2d8b38=0x0;for(let _0x27000c=0x0;_0x27000c<=_0x931f8[_0x9e66f5(0x366)]['length']-0x1;_0x27000c++){const _0x4dea66=_0x931f8[_0x9e66f5(0x366)][_0x27000c],_0x462c5a=_0x4dea66['_id'][_0x9e66f5(0x327)]+'-'+_0x4dea66[_0x9e66f5(0x239)][_0x9e66f5(0x248)];var _0x40c1d6=_0x6a2d14[_0x462c5a]!==undefined?_0x6a2d14[_0x462c5a][_0x9e66f5(0x2da)](0x2):'0',_0x5edc8f=_0x5beaf5[_0x462c5a]!==undefined?_0x5beaf5[_0x462c5a][_0x9e66f5(0x2da)](0x2):'0',_0x1fd287=_0xec3024[_0x462c5a]!==undefined?_0xec3024[_0x462c5a]['toFixed'](0x2):'0',_0x12c16a=_0x424deb[_0x462c5a]!==undefined?_0x424deb[_0x462c5a][_0x9e66f5(0x2da)](0x2):'0',_0x4ab5aa=_0x171f8c[_0x462c5a]!==undefined?_0x171f8c[_0x462c5a][_0x9e66f5(0x2da)](0x2):'0',_0x29aa80=_0x206f36[_0x462c5a]!==undefined?_0x206f36[_0x462c5a][_0x9e66f5(0x2da)](0x2):'0';_0x342ddb=parseFloat(_0x40c1d6)+parseFloat(_0x12c16a),_0x58a38b=parseFloat(_0x1fd287)+parseFloat(_0x29aa80),_0x2d8b38=parseFloat(_0x5edc8f)+parseFloat(_0x4ab5aa),_0x1e81ec+=_0x9e66f5(0x2c2)+formatNumber(_0x342ddb['toFixed'](0x2))+_0x9e66f5(0x2a8),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x58a38b['toFixed'](0x2))+_0x9e66f5(0x2a8),_0x1e81ec+=_0x9e66f5(0x2c2)+formatNumber(_0x2d8b38[_0x9e66f5(0x2da)](0x2))+_0x9e66f5(0x2a8);}var _0x45af9f=formatNumber(_0x22d948+_0x136b9f),_0x30e26b=formatNumber(_0x8da458+_0x1f7fbe);_0x1e81ec+=_0x9e66f5(0x2c2)+_0x45af9f+_0x9e66f5(0x2a8),_0x1e81ec+=_0x9e66f5(0x2c2)+_0x30e26b+'</b></td>',_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x931f8[_0x9e66f5(0x366)]['length']*0x3+0x9)+_0x9e66f5(0x2db),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+='<tr>',_0x1e81ec+=_0x9e66f5(0x29d),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x1e81ec+=_0x9e66f5(0x2e5);for(let _0x4cf4f7=0x0;_0x4cf4f7<=_0x931f8[_0x9e66f5(0x366)][_0x9e66f5(0x205)]-0x1;_0x4cf4f7++){const _0x2b447e=_0x931f8[_0x9e66f5(0x366)][_0x4cf4f7],_0x1474e6=_0x2b447e[_0x9e66f5(0x239)][_0x9e66f5(0x327)]+'-'+_0x2b447e['_id'][_0x9e66f5(0x248)];var _0x40c1d6=_0x6a2d14[_0x1474e6]!==undefined?_0x6a2d14[_0x1474e6][_0x9e66f5(0x2da)](0x2):'0',_0x5edc8f=_0x5beaf5[_0x1474e6]!==undefined?_0x5beaf5[_0x1474e6][_0x9e66f5(0x2da)](0x2):'0',_0x1fd287=_0xec3024[_0x1474e6]!==undefined?_0xec3024[_0x1474e6][_0x9e66f5(0x2da)](0x2):'0',_0x12c16a=_0x424deb[_0x1474e6]!==undefined?_0x424deb[_0x1474e6][_0x9e66f5(0x2da)](0x2):'0',_0x4ab5aa=_0x171f8c[_0x1474e6]!==undefined?_0x171f8c[_0x1474e6][_0x9e66f5(0x2da)](0x2):'0',_0x29aa80=_0x206f36[_0x1474e6]!==undefined?_0x206f36[_0x1474e6]['toFixed'](0x2):'0';_0x342ddb=parseFloat(_0x40c1d6)+parseFloat(_0x12c16a),_0x58a38b=parseFloat(_0x1fd287)+parseFloat(_0x29aa80),_0x2d8b38=parseFloat(_0x5edc8f)+parseFloat(_0x4ab5aa),_0x1e81ec+=_0x9e66f5(0x29a),_0x1e81ec+=_0x9e66f5(0x29a),_0x1e81ec+=_0x9e66f5(0x29a);}_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+='<tr>',_0x1e81ec+=_0x9e66f5(0x29d),_0x1e81ec+=_0x9e66f5(0x2fc),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x1f6ccb=0x0;_0x1f6ccb<=_0x931f8['cat_brand']['length']-0x1;_0x1f6ccb++){const _0x1a7051=_0x931f8[_0x9e66f5(0x366)][_0x1f6ccb],_0x5eddd9=_0x1a7051[_0x9e66f5(0x239)]['brand']+'-'+_0x1a7051[_0x9e66f5(0x239)]['category'];var _0x40c1d6=_0x6a2d14[_0x5eddd9]!==undefined?_0x6a2d14[_0x5eddd9][_0x9e66f5(0x2da)](0x2):'0',_0x5edc8f=_0x5beaf5[_0x5eddd9]!==undefined?_0x5beaf5[_0x5eddd9][_0x9e66f5(0x2da)](0x2):'0',_0x1fd287=_0xec3024[_0x5eddd9]!==undefined?_0xec3024[_0x5eddd9][_0x9e66f5(0x2da)](0x2):'0',_0x12c16a=_0x424deb[_0x5eddd9]!==undefined?_0x424deb[_0x5eddd9][_0x9e66f5(0x2da)](0x2):'0',_0x4ab5aa=_0x171f8c[_0x5eddd9]!==undefined?_0x171f8c[_0x5eddd9][_0x9e66f5(0x2da)](0x2):'0',_0x29aa80=_0x206f36[_0x5eddd9]!==undefined?_0x206f36[_0x5eddd9][_0x9e66f5(0x2da)](0x2):'0';_0x342ddb=parseFloat(_0x40c1d6)+parseFloat(_0x12c16a),_0x58a38b=parseFloat(_0x1fd287)+parseFloat(_0x29aa80),_0x2d8b38=parseFloat(_0x5edc8f)+parseFloat(_0x4ab5aa),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1e81ec+=_0x9e66f5(0x29a),_0x1e81ec+=_0x9e66f5(0x29a);}_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+='<tr>',_0x1e81ec+=_0x9e66f5(0x29d),_0x1e81ec+=_0x9e66f5(0x244),_0x1e81ec+=_0x9e66f5(0x2e5);for(let _0x315bdf=0x0;_0x315bdf<=_0x931f8[_0x9e66f5(0x366)]['length']-0x1;_0x315bdf++){const _0x6ae006=_0x931f8[_0x9e66f5(0x366)][_0x315bdf],_0x3dc808=_0x6ae006[_0x9e66f5(0x239)]['brand']+'-'+_0x6ae006[_0x9e66f5(0x239)]['category'];var _0x40c1d6=_0x6a2d14[_0x3dc808]!==undefined?_0x6a2d14[_0x3dc808]['toFixed'](0x2):'0',_0x5edc8f=_0x5beaf5[_0x3dc808]!==undefined?_0x5beaf5[_0x3dc808][_0x9e66f5(0x2da)](0x2):'0',_0x1fd287=_0xec3024[_0x3dc808]!==undefined?_0xec3024[_0x3dc808]['toFixed'](0x2):'0',_0x12c16a=_0x424deb[_0x3dc808]!==undefined?_0x424deb[_0x3dc808][_0x9e66f5(0x2da)](0x2):'0',_0x4ab5aa=_0x171f8c[_0x3dc808]!==undefined?_0x171f8c[_0x3dc808][_0x9e66f5(0x2da)](0x2):'0',_0x29aa80=_0x206f36[_0x3dc808]!==undefined?_0x206f36[_0x3dc808][_0x9e66f5(0x2da)](0x2):'0';_0x342ddb=parseFloat(_0x40c1d6)+parseFloat(_0x12c16a),_0x58a38b=parseFloat(_0x1fd287)+parseFloat(_0x29aa80),_0x2d8b38=parseFloat(_0x5edc8f)+parseFloat(_0x4ab5aa),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1e81ec+=_0x9e66f5(0x29a),_0x1e81ec+=_0x9e66f5(0x29a);}_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+=_0x9e66f5(0x354),_0x1e81ec+=_0x9e66f5(0x29d),_0x1e81ec+=_0x9e66f5(0x379),_0x1e81ec+=_0x9e66f5(0x2e5);for(let _0x30cccb=0x0;_0x30cccb<=_0x931f8[_0x9e66f5(0x366)][_0x9e66f5(0x205)]-0x1;_0x30cccb++){const _0x5d0bdb=_0x931f8[_0x9e66f5(0x366)][_0x30cccb],_0x588b25=_0x5d0bdb['_id'][_0x9e66f5(0x327)]+'-'+_0x5d0bdb[_0x9e66f5(0x239)]['category'];var _0x40c1d6=_0x6a2d14[_0x588b25]!==undefined?_0x6a2d14[_0x588b25][_0x9e66f5(0x2da)](0x2):'',_0x5edc8f=_0x5beaf5[_0x588b25]!==undefined?_0x5beaf5[_0x588b25]['toFixed'](0x2):'',_0x1fd287=_0xec3024[_0x588b25]!==undefined?_0xec3024[_0x588b25][_0x9e66f5(0x2da)](0x2):'',_0x12c16a=_0x424deb[_0x588b25]!==undefined?_0x424deb[_0x588b25]['toFixed'](0x2):'',_0x4ab5aa=_0x171f8c[_0x588b25]!==undefined?_0x171f8c[_0x588b25][_0x9e66f5(0x2da)](0x2):'',_0x29aa80=_0x206f36[_0x588b25]!==undefined?_0x206f36[_0x588b25][_0x9e66f5(0x2da)](0x2):'';_0x342ddb=formatNumber(parseFloat(_0x40c1d6)+parseFloat(_0x12c16a)),_0x58a38b=formatNumber(parseFloat(_0x1fd287)+parseFloat(_0x29aa80)),_0x2d8b38=formatNumber(parseFloat(_0x5edc8f)+parseFloat(_0x4ab5aa)),_0x1e81ec+=_0x9e66f5(0x2c2)+_0x40c1d6+'</b></td>',_0x1e81ec+=_0x9e66f5(0x2c2)+_0x1fd287+'</b></td>',_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x5edc8f+_0x9e66f5(0x2a8);}_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+='<tr>',_0x1e81ec+=_0x9e66f5(0x29d),_0x1e81ec+=_0x9e66f5(0x237),_0x1e81ec+=_0x9e66f5(0x2e5);for(let _0x3f8540=0x0;_0x3f8540<=_0x931f8[_0x9e66f5(0x366)][_0x9e66f5(0x205)]-0x1;_0x3f8540++){const _0x5cb89b=_0x931f8[_0x9e66f5(0x366)][_0x3f8540],_0x296d6d=_0x5cb89b['_id'][_0x9e66f5(0x327)]+'-'+_0x5cb89b[_0x9e66f5(0x239)]['category'];var _0x40c1d6=_0x6a2d14[_0x296d6d]!==undefined?_0x6a2d14[_0x296d6d]['toFixed'](0x2):'0',_0x5edc8f=_0x5beaf5[_0x296d6d]!==undefined?_0x5beaf5[_0x296d6d]['toFixed'](0x2):'0',_0x1fd287=_0xec3024[_0x296d6d]!==undefined?_0xec3024[_0x296d6d][_0x9e66f5(0x2da)](0x2):'0',_0x12c16a=_0x424deb[_0x296d6d]!==undefined?_0x424deb[_0x296d6d]['toFixed'](0x2):'0',_0x4ab5aa=_0x171f8c[_0x296d6d]!==undefined?_0x171f8c[_0x296d6d][_0x9e66f5(0x2da)](0x2):'0',_0x29aa80=_0x206f36[_0x296d6d]!==undefined?_0x206f36[_0x296d6d][_0x9e66f5(0x2da)](0x2):'0';_0x342ddb=parseFloat(_0x40c1d6)+parseFloat(_0x12c16a),_0x58a38b=parseFloat(_0x1fd287)+parseFloat(_0x29aa80),_0x2d8b38=parseFloat(_0x5edc8f)+parseFloat(_0x4ab5aa),_0x1e81ec+=_0x9e66f5(0x29a),_0x1e81ec+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1e81ec+=_0x9e66f5(0x29a);}_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2e5),_0x1e81ec+=_0x9e66f5(0x2a5),_0x1e81ec+=_0x9e66f5(0x292),_0x1e81ec+=_0x9e66f5(0x32d);}),_0x1e81ec;}async function generateReferenceNumber(_0x50a96d,_0x4274ad,_0x33834a){const _0x111543=a0_0x2db209,_0x4bec33=new Date(_0x50a96d)[_0x111543(0x342)](),_0x17d31b=('0'+(new Date(_0x50a96d)[_0x111543(0x268)]()+0x1))[_0x111543(0x2fd)](-0x2),_0x2727e6=('0'+new Date(_0x50a96d)[_0x111543(0x1f4)]())[_0x111543(0x2fd)](-0x2),_0x5b3828=await staff[_0x111543(0x2d1)]({'email':_0x33834a[_0x111543(0x26a)]}),_0x354c36=_0x5b3828[_0x111543(0x204)],_0x36af3c=_0x354c36+'-'+_0x4bec33+_0x17d31b+_0x2727e6,_0x5a32d0=await Reference[_0x111543(0x2d1)]({'referenceNumber':new RegExp('^'+_0x36af3c),'salesman_code':_0x354c36})['sort']({'createdAt':-0x1}),_0x43dfe0=_0x36af3c;_0x5a32d0&&(_0x43dfe0=_0x5a32d0[_0x111543(0x1fd)]);console[_0x111543(0x365)](_0x43dfe0);const _0x3f0fae=new Reference({'referenceNumber':_0x43dfe0,'staff_id':_0x4274ad,'salesman_code':_0x354c36});return await _0x3f0fae[_0x111543(0x343)](),_0x43dfe0;}router[a0_0x2db209(0x31c)]('/dsrr/pdf',auth,async(_0x3d0fe6,_0xd8f2c4)=>{const _0x166b83=a0_0x2db209,{from_date:_0x50d055,dataview:_0x1b74ca}=_0x3d0fe6[_0x166b83(0x300)],_0x4eceda=_0x3d0fe6[_0x166b83(0x334)],_0x3ad15d=await staff[_0x166b83(0x2d1)]({'email':_0x4eceda['email']}),_0x28cc59=await master_shop[_0x166b83(0x214)](),_0x52496b='';var _0xd5d90d=new Date(_0x50d055);const _0x240d48={'year':_0x166b83(0x303),'month':_0x166b83(0x369),'day':_0x166b83(0x303)},_0x5014c2=new Intl['DateTimeFormat']('en-US',_0x240d48)[_0x166b83(0x203)](_0xd5d90d),_0x53acc7=await Reference[_0x166b83(0x214)]({'staff_id':_0x3ad15d[_0x166b83(0x239)]['valueOf'](),'date_include':_0x50d055});if(_0x53acc7[_0x166b83(0x205)]>0x0){let _0x3096e9='';_0x3096e9+=_0x53acc7[0x0]['html'];if(_0x1b74ca==_0x166b83(0x378)){const _0x48a328=cheerio['load'](_0x3096e9);let _0x4099fb=[],_0x4d864a=[],_0x1d60e2=[];const _0x1e6c35=_0x24f3d2=>{const _0x2c89a3=_0x166b83,_0x2aac53={'top':{'style':'thick','color':{'rgb':_0x2c89a3(0x27d)}},'bottom':{'style':_0x2c89a3(0x21c),'color':{'rgb':_0x2c89a3(0x27d)}},'left':{'style':_0x2c89a3(0x21c),'color':{'rgb':_0x2c89a3(0x27d)}},'right':{'style':_0x2c89a3(0x21c),'color':{'rgb':_0x2c89a3(0x27d)}}};if(_0x24f3d2){const _0x1072d1=_0x24f3d2[_0x2c89a3(0x24f)](';')[_0x2c89a3(0x2b6)]((_0x5047d3,_0x846af5)=>{const [_0x1e9998,_0x3ce203]=_0x846af5['split'](':')['map'](_0x2ad560=>_0x2ad560['trim']());return _0x5047d3[_0x1e9998]=_0x3ce203,_0x5047d3;},{});_0x1072d1[_0x2c89a3(0x2aa)]&&(_0x2aac53['top'][_0x2c89a3(0x2c1)]=_0x1072d1['border-top'][_0x2c89a3(0x2e3)]('thin')?'thin':_0x2c89a3(0x2f7)),_0x1072d1[_0x2c89a3(0x21f)]&&(_0x2aac53[_0x2c89a3(0x262)][_0x2c89a3(0x2c1)]=_0x1072d1['border-bottom'][_0x2c89a3(0x2e3)](_0x2c89a3(0x213))?_0x2c89a3(0x213):_0x2c89a3(0x2f7)),_0x1072d1['border-left']&&(_0x2aac53[_0x2c89a3(0x22a)]['style']=_0x1072d1[_0x2c89a3(0x310)]['includes'](_0x2c89a3(0x213))?'thin':_0x2c89a3(0x2f7)),_0x1072d1[_0x2c89a3(0x2ca)]&&(_0x2aac53['right'][_0x2c89a3(0x2c1)]=_0x1072d1[_0x2c89a3(0x2ca)][_0x2c89a3(0x2e3)](_0x2c89a3(0x213))?_0x2c89a3(0x213):_0x2c89a3(0x2f7));}return _0x2aac53;};_0x48a328('table\x20tr')[_0x166b83(0x242)]((_0x4cbe6b,_0x32d11f)=>{const _0x3ed499=_0x166b83;let _0x59ce06=[],_0x32be08=0x0;while(_0x1d60e2[_0x32be08]){_0x1d60e2[_0x32be08]--,_0x32be08++;}_0x48a328(_0x32d11f)[_0x3ed499(0x214)](_0x3ed499(0x2be))[_0x3ed499(0x242)]((_0x527e4b,_0x7f1da8)=>{const _0x319baf=_0x3ed499;let _0x4d7b80=_0x48a328(_0x7f1da8)[_0x319baf(0x362)]()['trim'](),_0x51fe01=parseFloat(_0x4d7b80[_0x319baf(0x2ae)](/,/g,''));isNaN(_0x51fe01)&&(_0x51fe01=_0x4d7b80);let _0xf5d8b9=parseInt(_0x48a328(_0x7f1da8)['attr'](_0x319baf(0x32a)))||0x1,_0x2e0aaf=parseInt(_0x48a328(_0x7f1da8)[_0x319baf(0x374)](_0x319baf(0x2b0)))||0x1;const _0xd47e1a=_0x48a328(_0x7f1da8)[_0x319baf(0x374)](_0x319baf(0x2c1)),_0x2b9dc1=_0x1e6c35(_0xd47e1a);_0x59ce06[_0x32be08]={'v':_0x51fe01,'s':{'border':_0x2b9dc1}};(_0xf5d8b9>0x1||_0x2e0aaf>0x1)&&_0x4d864a[_0x319baf(0x28d)]({'s':{'r':_0x4cbe6b,'c':_0x32be08},'e':{'r':_0x4cbe6b+_0x2e0aaf-0x1,'c':_0x32be08+_0xf5d8b9-0x1}});for(let _0x2a8685=0x0;_0x2a8685<_0xf5d8b9;_0x2a8685++){_0x2e0aaf>0x1&&(_0x1d60e2[_0x32be08+_0x2a8685]=_0x2e0aaf-0x1);}_0x32be08+=_0xf5d8b9;}),_0x4099fb[_0x3ed499(0x28d)](_0x59ce06);});const _0x275f20=XLSX['utils']['book_new'](),_0x654445=XLSX[_0x166b83(0x384)][_0x166b83(0x2f6)](_0x4099fb);_0x4d864a[_0x166b83(0x205)]>0x0&&(_0x654445['!merges']=_0x4d864a);_0x654445['!cols']=_0x4099fb[0x0][_0x166b83(0x35b)](()=>({'wpx':0x64})),XLSX[_0x166b83(0x384)][_0x166b83(0x2e4)](_0x275f20,_0x654445,_0x166b83(0x224));const _0x2ed8d4=XLSX['write'](_0x275f20,{'bookType':'xlsx','type':_0x166b83(0x272)});_0xd8f2c4[_0x166b83(0x221)](_0x166b83(0x293),_0x166b83(0x20c)),_0xd8f2c4[_0x166b83(0x221)](_0x166b83(0x340),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0xd8f2c4[_0x166b83(0x270)](_0x2ed8d4);}else{let _0x356d3a='';_0x356d3a+=_0x3096e9,_0x356d3a+=_0x166b83(0x28b),_0x356d3a+=_0x166b83(0x35f),_0x356d3a+=_0x166b83(0x26f),_0x356d3a+='};',_0x356d3a+=_0x166b83(0x2c8),_0xd8f2c4[_0x166b83(0x270)](_0x356d3a);}}else generateReferenceNumber(_0x50d055,_0x3ad15d[_0x166b83(0x239)]['valueOf'](),_0x4eceda)[_0x166b83(0x2a1)](async _0x31ec16=>{const _0xe43907=_0x166b83,_0x133d8d=await agentsdataDSICheck_DSRR(_0x50d055,_0x3ad15d[_0xe43907(0x239)]['valueOf'](),_0x52496b,_0x31ec16);console[_0xe43907(0x365)](_0x133d8d);let _0x47c087='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x47c087+='<div\x20class=\x22row\x22>',_0x47c087+=_0xe43907(0x27e),_0x47c087+=_0xe43907(0x275),_0x47c087+=_0x133d8d,_0x47c087+=_0xe43907(0x32d),_0x47c087+=_0xe43907(0x20a),_0x47c087+='</div>';if(_0x133d8d[_0xe43907(0x205)]>0x0){const _0x34df58=await Reference[_0xe43907(0x2d1)]({'staff_id':_0x3ad15d['_id'][_0xe43907(0x230)](),'referenceNumber':_0x31ec16});_0x34df58[_0xe43907(0x29b)]=_0x47c087,_0x34df58[_0xe43907(0x28e)]=_0x50d055,await _0x34df58[_0xe43907(0x343)]();if(_0x1b74ca==_0xe43907(0x378)){const _0x2aee7e=cheerio[_0xe43907(0x22f)](_0x47c087);let _0x1cd645=[],_0x44548d=[],_0x480f88=[];const _0x1ceea4=_0x466791=>{const _0xbff295=_0xe43907,_0x34bea9={'top':{'style':'thick','color':{'rgb':_0xbff295(0x27d)}},'bottom':{'style':_0xbff295(0x21c),'color':{'rgb':_0xbff295(0x27d)}},'left':{'style':_0xbff295(0x21c),'color':{'rgb':'000000'}},'right':{'style':_0xbff295(0x21c),'color':{'rgb':'000000'}}};if(_0x466791){const _0x3aed52=_0x466791[_0xbff295(0x24f)](';')[_0xbff295(0x2b6)]((_0x5e3348,_0x1d62e3)=>{const _0x29ddd1=_0xbff295,[_0xe17806,_0x4b93dc]=_0x1d62e3['split'](':')[_0x29ddd1(0x35b)](_0x213b49=>_0x213b49[_0x29ddd1(0x2b7)]());return _0x5e3348[_0xe17806]=_0x4b93dc,_0x5e3348;},{});_0x3aed52[_0xbff295(0x2aa)]&&(_0x34bea9[_0xbff295(0x1f6)][_0xbff295(0x2c1)]=_0x3aed52[_0xbff295(0x2aa)][_0xbff295(0x2e3)](_0xbff295(0x213))?_0xbff295(0x213):_0xbff295(0x2f7)),_0x3aed52[_0xbff295(0x21f)]&&(_0x34bea9[_0xbff295(0x262)][_0xbff295(0x2c1)]=_0x3aed52[_0xbff295(0x21f)][_0xbff295(0x2e3)](_0xbff295(0x213))?_0xbff295(0x213):_0xbff295(0x2f7)),_0x3aed52[_0xbff295(0x310)]&&(_0x34bea9['left'][_0xbff295(0x2c1)]=_0x3aed52[_0xbff295(0x310)]['includes'](_0xbff295(0x213))?_0xbff295(0x213):'medium'),_0x3aed52[_0xbff295(0x2ca)]&&(_0x34bea9[_0xbff295(0x2cb)][_0xbff295(0x2c1)]=_0x3aed52[_0xbff295(0x2ca)][_0xbff295(0x2e3)]('thin')?_0xbff295(0x213):_0xbff295(0x2f7));}return _0x34bea9;};_0x2aee7e(_0xe43907(0x336))[_0xe43907(0x242)]((_0x3cf287,_0x1bf2c8)=>{const _0x2a6b28=_0xe43907;let _0x508d0e=[],_0x4dae5c=0x0;while(_0x480f88[_0x4dae5c]){_0x480f88[_0x4dae5c]--,_0x4dae5c++;}_0x2aee7e(_0x1bf2c8)['find'](_0x2a6b28(0x2be))[_0x2a6b28(0x242)]((_0x3d6c1a,_0x3ae124)=>{const _0x59a759=_0x2a6b28;let _0x17ca62=_0x2aee7e(_0x3ae124)['text']()['trim'](),_0x19da18=parseFloat(_0x17ca62[_0x59a759(0x2ae)](/,/g,''));isNaN(_0x19da18)&&(_0x19da18=_0x17ca62);let _0x559e50=parseInt(_0x2aee7e(_0x3ae124)['attr'](_0x59a759(0x32a)))||0x1,_0x5cd38f=parseInt(_0x2aee7e(_0x3ae124)[_0x59a759(0x374)]('rowspan'))||0x1;const _0xecb9c4=_0x2aee7e(_0x3ae124)['attr']('style'),_0x1f53cd=_0x1ceea4(_0xecb9c4);_0x508d0e[_0x4dae5c]={'v':_0x19da18,'s':{'border':_0x1f53cd}};(_0x559e50>0x1||_0x5cd38f>0x1)&&_0x44548d[_0x59a759(0x28d)]({'s':{'r':_0x3cf287,'c':_0x4dae5c},'e':{'r':_0x3cf287+_0x5cd38f-0x1,'c':_0x4dae5c+_0x559e50-0x1}});for(let _0x14e6c8=0x0;_0x14e6c8<_0x559e50;_0x14e6c8++){_0x5cd38f>0x1&&(_0x480f88[_0x4dae5c+_0x14e6c8]=_0x5cd38f-0x1);}_0x4dae5c+=_0x559e50;}),_0x1cd645[_0x2a6b28(0x28d)](_0x508d0e);});const _0x159205=XLSX[_0xe43907(0x384)]['book_new'](),_0xd31317=XLSX['utils']['aoa_to_sheet'](_0x1cd645);_0x44548d['length']>0x0&&(_0xd31317[_0xe43907(0x20f)]=_0x44548d);_0xd31317['!cols']=_0x1cd645[0x0][_0xe43907(0x35b)](()=>({'wpx':0x64})),XLSX[_0xe43907(0x384)][_0xe43907(0x2e4)](_0x159205,_0xd31317,_0xe43907(0x224));const _0x2d3ec4=XLSX['write'](_0x159205,{'bookType':_0xe43907(0x335),'type':_0xe43907(0x272)});_0xd8f2c4[_0xe43907(0x221)](_0xe43907(0x293),_0xe43907(0x20c)),_0xd8f2c4['setHeader'](_0xe43907(0x340),_0xe43907(0x23a)),_0xd8f2c4['send'](_0x2d3ec4);}else _0x47c087+=_0xe43907(0x28b),_0x47c087+=_0xe43907(0x35f),_0x47c087+=_0xe43907(0x26f),_0x47c087+='};',_0x47c087+=_0xe43907(0x2c8),_0xd8f2c4[_0xe43907(0x270)](_0x47c087);}else await Reference[_0xe43907(0x2b8)]({'referenceNumber':_0x31ec16}),_0x3d0fe6[_0xe43907(0x341)](_0xe43907(0x238),_0xe43907(0x37e)),_0xd8f2c4[_0xe43907(0x240)](_0xe43907(0x305));})[_0x166b83(0x328)](console['error']);}),router[a0_0x2db209(0x29c)](a0_0x2db209(0x377),auth,async(_0x3cd15c,_0x487f04)=>{const _0x1a5852=a0_0x2db209;try{const {username:_0x601686,email:_0x48531f,role:_0x52c9b6}=_0x3cd15c[_0x1a5852(0x334)],_0x5ebe39=_0x3cd15c[_0x1a5852(0x334)],_0x12dcb4=await profile[_0x1a5852(0x2d1)]({'email':_0x5ebe39[_0x1a5852(0x26a)]}),_0x1b7ea1={'year':_0x1a5852(0x303),'month':_0x1a5852(0x369),'day':_0x1a5852(0x303)},_0x8ec81f=await master_shop[_0x1a5852(0x214)]();console[_0x1a5852(0x365)]('Products\x20master',_0x8ec81f);const _0x5791e9=await product[_0x1a5852(0x214)]();console[_0x1a5852(0x365)](_0x1a5852(0x247),_0x5791e9);const _0x109801=await warehouse[_0x1a5852(0x217)]([{'$unwind':_0x1a5852(0x364)},{'$lookup':{'from':_0x1a5852(0x352),'localField':_0x1a5852(0x337),'foreignField':_0x1a5852(0x2d9),'as':_0x1a5852(0x2e9)}},{'$unwind':_0x1a5852(0x34e)},{'$project':{'product_name':_0x1a5852(0x2ec),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);console[_0x1a5852(0x365)](_0x1a5852(0x2e0),_0x109801),_0x109801[_0x1a5852(0x2a2)](_0x1cbee1=>{const _0x3b6aac=_0x5791e9['map'](_0x972e45=>{const _0x42acb0=a0_0x40c3;_0x972e45[_0x42acb0(0x2d9)]==_0x1cbee1[_0x42acb0(0x239)]&&(_0x972e45[_0x42acb0(0x26b)]=parseInt(_0x972e45[_0x42acb0(0x26b)])+parseInt(_0x1cbee1[_0x42acb0(0x2d6)]));});});const _0x196677=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x1c0391=await staff['findOne']({'email':_0x5ebe39[_0x1a5852(0x26a)]});if(_0x8ec81f[0x0][_0x1a5852(0x252)]==_0x1a5852(0x2e1))var _0x5ab75b=users[_0x1a5852(0x2b3)];else{if(_0x8ec81f[0x0][_0x1a5852(0x252)]=='Hindi')var _0x5ab75b=users[_0x1a5852(0x231)];else{if(_0x8ec81f[0x0][_0x1a5852(0x252)]==_0x1a5852(0x265))var _0x5ab75b=users[_0x1a5852(0x265)];else{if(_0x8ec81f[0x0][_0x1a5852(0x252)]==_0x1a5852(0x320))var _0x5ab75b=users[_0x1a5852(0x320)];else{if(_0x8ec81f[0x0][_0x1a5852(0x252)]=='French')var _0x5ab75b=users['French'];else{if(_0x8ec81f[0x0][_0x1a5852(0x252)]=='Portuguese\x20(BR)')var _0x5ab75b=users[_0x1a5852(0x253)];else{if(_0x8ec81f[0x0][_0x1a5852(0x252)]=='Chinese')var _0x5ab75b=users[_0x1a5852(0x258)];else{if(_0x8ec81f[0x0][_0x1a5852(0x252)]=='Arabic\x20(ae)')var _0x5ab75b=users[_0x1a5852(0x260)];}}}}}}}_0x487f04[_0x1a5852(0x2cc)](_0x1a5852(0x266),{'success':_0x3cd15c[_0x1a5852(0x341)]('success'),'errors':_0x3cd15c['flash']('errors'),'alldata':_0x5791e9,'profile':_0x12dcb4,'master_shop':_0x8ec81f,'role':_0x5ebe39,'product_stock':_0x109801,'language':_0x5ab75b,'staff_arr':_0x1c0391,'staff_data_all':_0x196677});}catch(_0xd9c0c9){}}),router[a0_0x2db209(0x31c)](a0_0x2db209(0x218),auth,async(_0x156465,_0x4b0451)=>{const _0x4aa8df=a0_0x2db209;try{const {from:_0x1f2514,to:_0x57fc47,staff_data:_0x5a571a}=_0x156465[_0x4aa8df(0x300)],_0x4650d9=await Reference[_0x4aa8df(0x217)]([{'$match':{'date_include':{'$gte':_0x1f2514,'$lte':_0x57fc47},'staff_id':_0x5a571a}},{'$sort':{'date_include':0x1}}]);_0x4b0451[_0x4aa8df(0x2ac)](_0x4650d9);}catch(_0x20a740){_0x4b0451[_0x4aa8df(0x2ac)](_0x20a740);}}),router[a0_0x2db209(0x31c)](a0_0x2db209(0x2c0),auth,async(_0x483026,_0x5d270b)=>{const _0xaee3ff=a0_0x2db209;try{const {from:_0x5475c8,to:_0x24a02e}=_0x483026[_0xaee3ff(0x300)],{sttaff_id:_0x3b30ac}=_0x483026[_0xaee3ff(0x334)],_0x2cf1b3=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x5475c8,'$lte':_0x24a02e},'staff_id':_0x3b30ac}},{'$sort':{'date_include':0x1}}]);_0x5d270b[_0xaee3ff(0x2ac)](_0x2cf1b3);}catch(_0x8222cd){_0x5d270b['json'](_0x8222cd);}}),router['get'](a0_0x2db209(0x297),auth,async(_0x53fa3a,_0xbcda6b)=>{const _0x12f953=a0_0x2db209;try{const _0x32e20e=_0x53fa3a[_0x12f953(0x2b1)]['id'],_0x4d382a=await Reference[_0x12f953(0x2dc)](_0x32e20e);let _0x328da3='';_0x328da3+=_0x4d382a[_0x12f953(0x29b)],_0x328da3+=_0x12f953(0x28b),_0x328da3+=_0x12f953(0x35f),_0x328da3+='window.print();',_0x328da3+='};',_0x328da3+=_0x12f953(0x2c8),_0xbcda6b[_0x12f953(0x270)](_0x328da3);}catch(_0x501412){_0xbcda6b[_0x12f953(0x2ac)](_0x501412);}}),router['post'](a0_0x2db209(0x30e),auth,async(_0x24c076,_0x5a3dac)=>{const _0x442ed7=a0_0x2db209;try{const {ref_data:_0x151232}=_0x24c076[_0x442ed7(0x300)],_0x29fddc=_0x151232[_0x442ed7(0x24f)]('~'),_0x409f7f=_0x29fddc[_0x442ed7(0x1f5)](_0x22e1c9=>_0x22e1c9!==''),_0x29d78d=await Reference[_0x442ed7(0x217)]([{'$match':{'referenceNumber':{'$in':_0x409f7f}}}]),_0x229066=XLSX[_0x442ed7(0x384)]['book_new']();_0x29d78d['forEach'](_0x25ee47=>{const _0x42cc6a=_0x442ed7,_0x3f6aa2=cheerio[_0x42cc6a(0x22f)](_0x25ee47['html']);let _0x191cd4=[],_0x260f81=[],_0x758c34=[];_0x3f6aa2(_0x42cc6a(0x336))[_0x42cc6a(0x242)]((_0x52b2c8,_0x479fab)=>{const _0x2efa35=_0x42cc6a;let _0x38a401=[],_0x4a85d8=0x0;while(_0x758c34[_0x4a85d8]){_0x758c34[_0x4a85d8]--,_0x4a85d8++;}_0x3f6aa2(_0x479fab)[_0x2efa35(0x214)](_0x2efa35(0x2be))[_0x2efa35(0x242)]((_0x3d84d7,_0x2ced4f)=>{const _0x5b1350=_0x2efa35;let _0x2afbd1=_0x3f6aa2(_0x2ced4f)[_0x5b1350(0x362)]()[_0x5b1350(0x2b7)](),_0x9a9a06=parseFloat(_0x2afbd1['replace'](/,/g,''));isNaN(_0x9a9a06)&&(_0x9a9a06=_0x2afbd1);let _0x5d4108=parseInt(_0x3f6aa2(_0x2ced4f)[_0x5b1350(0x374)]('colspan'))||0x1,_0x22429=parseInt(_0x3f6aa2(_0x2ced4f)['attr']('rowspan'))||0x1;_0x38a401[_0x4a85d8]=_0x9a9a06;(_0x5d4108>0x1||_0x22429>0x1)&&_0x260f81[_0x5b1350(0x28d)]({'s':{'r':_0x52b2c8,'c':_0x4a85d8},'e':{'r':_0x52b2c8+_0x22429-0x1,'c':_0x4a85d8+_0x5d4108-0x1}});for(let _0x431a79=0x0;_0x431a79<_0x5d4108;_0x431a79++){_0x22429>0x1&&(_0x758c34[_0x4a85d8+_0x431a79]=_0x22429-0x1);}_0x4a85d8+=_0x5d4108;}),_0x191cd4[_0x2efa35(0x28d)](_0x38a401);});const _0x84497e=XLSX[_0x42cc6a(0x384)][_0x42cc6a(0x2f6)](_0x191cd4);_0x260f81['length']>0x0&&(_0x84497e[_0x42cc6a(0x20f)]=_0x260f81),_0x84497e['!cols']=_0x191cd4[0x0][_0x42cc6a(0x35b)](()=>({'wpx':0x64})),XLSX[_0x42cc6a(0x384)][_0x42cc6a(0x2e4)](_0x229066,_0x84497e,_0x25ee47[_0x42cc6a(0x1fd)]);});const _0x2d1498=XLSX[_0x442ed7(0x313)](_0x229066,{'bookType':_0x442ed7(0x335),'type':'buffer'});_0x5a3dac[_0x442ed7(0x221)](_0x442ed7(0x293),'attachment;\x20filename=\x22reports.xlsx\x22'),_0x5a3dac[_0x442ed7(0x221)]('Content-Type',_0x442ed7(0x23a)),_0x5a3dac[_0x442ed7(0x270)](_0x2d1498);}catch(_0x4c3d99){_0x5a3dac[_0x442ed7(0x2ac)](_0x4c3d99);}}),router['post']('/dsrr_admin/pdf_admin',auth,async(_0x1fc768,_0x2729d5)=>{const _0x44f418=a0_0x2db209,{from_date:_0xc22680,agent_id:_0x52c041}=_0x1fc768[_0x44f418(0x300)],_0x1cad14=_0x1fc768[_0x44f418(0x334)],_0x285bb0=await staff[_0x44f418(0x2d1)]({'email':_0x1cad14[_0x44f418(0x26a)]}),_0x302895=await master_shop[_0x44f418(0x214)](),_0x5aaaa0=await agentsdataDSICheck_DSRR(_0xc22680,_0x52c041,_0x394702);let _0x56ac41='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x261edf=new Date(_0xc22680);const _0x1f11ba={'year':_0x44f418(0x303),'month':_0x44f418(0x369),'day':_0x44f418(0x303)},_0x3e1e18=new Intl[(_0x44f418(0x208))](_0x44f418(0x234),_0x1f11ba)[_0x44f418(0x203)](_0x261edf);_0x56ac41+=_0x44f418(0x359),_0x56ac41+=_0x44f418(0x27e),_0x56ac41+=_0x44f418(0x275),_0x56ac41+=_0x5aaaa0,_0x56ac41+=_0x44f418(0x32d),_0x56ac41+=_0x44f418(0x20a),_0x56ac41+='</div>';let _0x416595=_0x44f418(0x1f9);const _0x450eb8={'width':_0x44f418(0x2ef),'height':_0x44f418(0x22b),'orientation':'landscape','border':{'top':_0x44f418(0x1fe),'right':_0x44f418(0x1fe),'bottom':'0.1in','left':_0x44f418(0x1fe)},'header':{'height':_0x44f418(0x383),'contents':_0x44f418(0x37a)+_0x416595+_0x44f418(0x30c)+_0x3e1e18+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x44f418(0x1ff),'contents':{'default':_0x44f418(0x36c)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x44f418(0x322)}}};var _0x394702='on';if(_0x394702=='on'){const _0x357d59=cheerio['load'](_0x56ac41);let _0x5810c0=[],_0x19dab8=[],_0x30d8cd=[];_0x357d59(_0x44f418(0x336))[_0x44f418(0x242)]((_0x22079f,_0xeee789)=>{const _0x49da38=_0x44f418;let _0x4c0a18=[],_0x4a071c=0x0;while(_0x30d8cd[_0x4a071c]){_0x30d8cd[_0x4a071c]--,_0x4a071c++;}_0x357d59(_0xeee789)[_0x49da38(0x214)](_0x49da38(0x2be))[_0x49da38(0x242)]((_0x1bab1b,_0x437bd1)=>{const _0x1752b8=_0x49da38;let _0x2494d5=_0x357d59(_0x437bd1)['text']()[_0x1752b8(0x2b7)](),_0x42ab12=parseFloat(_0x2494d5['replace'](/,/g,''));isNaN(_0x42ab12)&&(_0x42ab12=_0x2494d5);let _0x481c0e=parseInt(_0x357d59(_0x437bd1)[_0x1752b8(0x374)](_0x1752b8(0x32a)))||0x1,_0x59d88f=parseInt(_0x357d59(_0x437bd1)['attr']('rowspan'))||0x1;_0x4c0a18[_0x4a071c]=_0x42ab12;(_0x481c0e>0x1||_0x59d88f>0x1)&&_0x19dab8[_0x1752b8(0x28d)]({'s':{'r':_0x22079f,'c':_0x4a071c},'e':{'r':_0x22079f+_0x59d88f-0x1,'c':_0x4a071c+_0x481c0e-0x1}});for(let _0x2c0583=0x0;_0x2c0583<_0x481c0e;_0x2c0583++){_0x59d88f>0x1&&(_0x30d8cd[_0x4a071c+_0x2c0583]=_0x59d88f-0x1);}_0x4a071c+=_0x481c0e;}),_0x5810c0[_0x49da38(0x28d)](_0x4c0a18);});const _0x11f56d=XLSX[_0x44f418(0x384)][_0x44f418(0x2de)](),_0x1d71ab=XLSX[_0x44f418(0x384)]['aoa_to_sheet'](_0x5810c0);_0x19dab8[_0x44f418(0x205)]>0x0&&(_0x1d71ab[_0x44f418(0x20f)]=_0x19dab8);_0x1d71ab[_0x44f418(0x209)]=_0x5810c0[0x0][_0x44f418(0x35b)](()=>({'wpx':0x64})),XLSX[_0x44f418(0x384)][_0x44f418(0x2e4)](_0x11f56d,_0x1d71ab,_0x44f418(0x224));const _0x2f6eee=XLSX[_0x44f418(0x313)](_0x11f56d,{'bookType':'xlsx','type':_0x44f418(0x272)});_0x2729d5[_0x44f418(0x221)](_0x44f418(0x293),_0x44f418(0x20c)),_0x2729d5[_0x44f418(0x221)](_0x44f418(0x340),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x2729d5[_0x44f418(0x270)](_0x2f6eee);}else pdf['create'](_0x56ac41,_0x450eb8)[_0x44f418(0x202)](function(_0x2e2eaf,_0x34da45){const _0x8ec6e5=_0x44f418;if(_0x2e2eaf){_0x2729d5[_0x8ec6e5(0x21e)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x2729d5[_0x8ec6e5(0x221)](_0x8ec6e5(0x340),'application/pdf'),_0x34da45[_0x8ec6e5(0x207)](_0x2729d5);});}),module[a0_0x2db209(0x223)]=router;