const a0_0x441f86=a0_0x5cb3;(function(_0x9dac47,_0xf089b9){const _0x399c4e=a0_0x5cb3,_0x2c3d1b=_0x9dac47();while(!![]){try{const _0x31ad2c=-parseInt(_0x399c4e(0x15b))/0x1*(parseInt(_0x399c4e(0x14c))/0x2)+-parseInt(_0x399c4e(0x185))/0x3+parseInt(_0x399c4e(0x228))/0x4+parseInt(_0x399c4e(0x237))/0x5*(-parseInt(_0x399c4e(0x1bb))/0x6)+parseInt(_0x399c4e(0x141))/0x7*(parseInt(_0x399c4e(0x27b))/0x8)+-parseInt(_0x399c4e(0x1c7))/0x9+-parseInt(_0x399c4e(0x195))/0xa*(-parseInt(_0x399c4e(0x108))/0xb);if(_0x31ad2c===_0xf089b9)break;else _0x2c3d1b['push'](_0x2c3d1b['shift']());}catch(_0x2d39bc){_0x2c3d1b['push'](_0x2c3d1b['shift']());}}}(a0_0x29ec,0x5ae1c));const express=require(a0_0x441f86(0x164)),res=require(a0_0x441f86(0x11c)),app=express(),router=express[a0_0x441f86(0x21f)](),multer=require(a0_0x441f86(0xf9)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x441f86(0x207)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x441f86(0x25c)),XLSX=require(a0_0x441f86(0x18f)),PDFDocument=require(a0_0x441f86(0x1d5)),fs=require('fs'),blobStream=require(a0_0x441f86(0x20f)),JsBarcode=require(a0_0x441f86(0x1cd)),{Canvas}=require(a0_0x441f86(0x1c8)),pdf=require(a0_0x441f86(0x116)),path=require(a0_0x441f86(0x26c)),mongoose=require('mongoose'),cheerio=require(a0_0x441f86(0x142));router[a0_0x441f86(0x167)](a0_0x441f86(0x102),auth,async(_0x6d1229,_0x209e7d)=>{const _0x4d3ead=a0_0x441f86;try{const {username:_0x480e95,email:_0x5c1226,role:_0x533369}=_0x6d1229[_0x4d3ead(0x275)],_0x4c9746=_0x6d1229[_0x4d3ead(0x275)],_0x38b0cc=await profile['findOne']({'email':_0x4c9746[_0x4d3ead(0x1d0)]}),_0x5746a4={'year':_0x4d3ead(0x232),'month':_0x4d3ead(0x1e5),'day':_0x4d3ead(0x232)},_0x38bab5=await master_shop[_0x4d3ead(0x234)]();console[_0x4d3ead(0x1e4)](_0x4d3ead(0x1d7),_0x38bab5);const _0x46c884=await product[_0x4d3ead(0x234)]();console[_0x4d3ead(0x1e4)]('Products\x20find_data',_0x46c884);const _0x50e700=await warehouse[_0x4d3ead(0x27c)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x4d3ead(0x156),'localField':'product_details.product_name','foreignField':_0x4d3ead(0x152),'as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x4d3ead(0x215),'product_stock':{'$sum':_0x4d3ead(0x1fe)}}}]);console['log'](_0x4d3ead(0x251),_0x50e700),_0x50e700[_0x4d3ead(0x268)](_0x3a68e8=>{const _0x36b323=_0x4d3ead,_0x9a0003=_0x46c884[_0x36b323(0x1a1)](_0x186766=>{const _0x425bab=_0x36b323;_0x186766[_0x425bab(0x152)]==_0x3a68e8[_0x425bab(0x11a)]&&(_0x186766['stock']=parseInt(_0x186766['stock'])+parseInt(_0x3a68e8['product_stock']));});}),console['log'](_0x4d3ead(0x1d4),_0x46c884);if(_0x38bab5[0x0]['language']==_0x4d3ead(0x208))var _0x4bd5d9=users[_0x4d3ead(0x11e)];else{if(_0x38bab5[0x0][_0x4d3ead(0x227)]=='Hindi')var _0x4bd5d9=users[_0x4d3ead(0x168)];else{if(_0x38bab5[0x0][_0x4d3ead(0x227)]==_0x4d3ead(0x177))var _0x4bd5d9=users[_0x4d3ead(0x177)];else{if(_0x38bab5[0x0][_0x4d3ead(0x227)]=='Spanish')var _0x4bd5d9=users[_0x4d3ead(0x1ca)];else{if(_0x38bab5[0x0][_0x4d3ead(0x227)]==_0x4d3ead(0x1d3))var _0x4bd5d9=users['French'];else{if(_0x38bab5[0x0][_0x4d3ead(0x227)]==_0x4d3ead(0x183))var _0x4bd5d9=users[_0x4d3ead(0x201)];else{if(_0x38bab5[0x0][_0x4d3ead(0x227)]==_0x4d3ead(0x16d))var _0x4bd5d9=users[_0x4d3ead(0x16d)];else{if(_0x38bab5[0x0][_0x4d3ead(0x227)]==_0x4d3ead(0x15e))var _0x4bd5d9=users['Arabic'];}}}}}}}_0x209e7d[_0x4d3ead(0x11d)](_0x4d3ead(0x131),{'success':_0x6d1229[_0x4d3ead(0x1a7)](_0x4d3ead(0x133)),'errors':_0x6d1229[_0x4d3ead(0x1a7)]('errors'),'alldata':_0x46c884,'profile':_0x38b0cc,'master_shop':_0x38bab5,'role':_0x4c9746,'product_stock':_0x50e700,'language':_0x4bd5d9});}catch(_0x177336){}});async function dataCheck(_0x4f291e,_0x145dd4){const _0x5e4aae=a0_0x441f86,_0x21dee7=await product[_0x5e4aae(0x27c)]([{'$group':{'_id':{'brand':'$brand','category':_0x5e4aae(0x216)},'products':{'$push':{'name':_0x5e4aae(0x1e6),'product_code':_0x5e4aae(0x243)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x38bfc4=[];_0x38bfc4[_0x5e4aae(0x261)]=[];for(let _0xbb6f7f=0x0;_0xbb6f7f<=_0x21dee7['length']-0x1;_0xbb6f7f++){const _0x2d3b78=_0x21dee7[_0xbb6f7f];_0x38bfc4[_0x5e4aae(0x261)][_0x5e4aae(0x206)](_0x2d3b78);}const _0x1ad4e9=await product[_0x5e4aae(0x27c)]([{'$group':{'_id':{'category':_0x5e4aae(0x216)},'products':{'$push':{'brand':'$brand','product_code':_0x5e4aae(0x243),'product_name':_0x5e4aae(0x1e6)}}}},{'$sort':{'_id.category':-0x1}}]),_0x46a8f7=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x4f291e,'$lte':_0x145dd4}}},{'$unwind':_0x5e4aae(0x118)},{'$group':{'_id':{'product_name':'$product.product_name','product_code':'$product.product_code'},'totalQTY':{'$sum':_0x5e4aae(0x25f)}}}]);_0x38bfc4['beg_bal']=[];for(let _0x1573bc=0x0;_0x1573bc<=_0x46a8f7[_0x5e4aae(0xfc)]-0x1;_0x1573bc++){const _0x3cc68f=_0x46a8f7[_0x1573bc];_0x38bfc4[_0x5e4aae(0x157)][_0x5e4aae(0x206)](_0x3cc68f);}const _0x140f65=await sales_sa[_0x5e4aae(0x27c)]([{'$match':{'date':{'$gte':_0x4f291e,'$lte':_0x145dd4}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x5e4aae(0x1bf),'localField':_0x5e4aae(0xfb),'foreignField':_0x5e4aae(0x11a),'as':'sales_info'}},{'$unwind':_0x5e4aae(0x1a4)},{'$unwind':_0x5e4aae(0x22c)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x5e4aae(0x1b4),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x5e4aae(0x1b9)}}}]);console[_0x5e4aae(0x1e4)](_0x140f65[0x0]),_0x38bfc4[_0x5e4aae(0x252)]=[];for(let _0x47f451=0x0;_0x47f451<=_0x140f65[_0x5e4aae(0xfc)]-0x1;_0x47f451++){const _0x590bdd=_0x140f65[_0x47f451];_0x38bfc4[_0x5e4aae(0x252)][_0x5e4aae(0x206)](_0x590bdd);}const _0x3df701=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x4f291e,'$lte':_0x145dd4}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5e4aae(0x20b)}}},{'$lookup':{'from':_0x5e4aae(0x1bf),'localField':_0x5e4aae(0xfb),'foreignField':_0x5e4aae(0x11a),'as':_0x5e4aae(0x233)}},{'$unwind':_0x5e4aae(0x1a4)},{'$unwind':_0x5e4aae(0x22c)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x5e4aae(0x1ee)}},{'$group':{'_id':{'product_name':_0x5e4aae(0x1b4),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x5e4aae(0x1c2)}}}]);_0x38bfc4['sales_ext']=[];for(let _0x3adfe4=0x0;_0x3adfe4<=_0x3df701['length']-0x1;_0x3adfe4++){const _0x5add64=_0x3df701[_0x3adfe4];_0x38bfc4[_0x5e4aae(0x212)]['push'](_0x5add64);}let _0xe5d110='';for(let _0x145461=0x0;_0x145461<=_0x1ad4e9[_0x5e4aae(0xfc)]-0x1;_0x145461++){const _0x12b31b=_0x1ad4e9[_0x145461];_0xe5d110+='<tr>',_0xe5d110+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x12b31b['_id']['category']+_0x5e4aae(0x199),_0xe5d110+=_0x5e4aae(0x1be);for(let _0x5728c2=0x0;_0x5728c2<_0x38bfc4[_0x5e4aae(0x261)][_0x5e4aae(0xfc)];_0x5728c2++){const _0x2a9774=_0x38bfc4[_0x5e4aae(0x261)][_0x5728c2];if(_0x2a9774[_0x5e4aae(0x11a)][_0x5e4aae(0x11f)]==_0x12b31b[_0x5e4aae(0x11a)][_0x5e4aae(0x11f)]){let _0x1239b5=[],_0x14abc1=[],_0x2bf7e1=[];_0x1239b5[_0x2a9774[_0x5e4aae(0x11a)][_0x5e4aae(0x20a)]]=[],_0x14abc1[_0x2a9774[_0x5e4aae(0x11a)][_0x5e4aae(0x20a)]]=[],_0x2bf7e1[_0x2a9774[_0x5e4aae(0x11a)]['brand']]=[];var _0x2d2286=0x0,_0x4a8de5=0x0,_0x69c0ed=0x0;for(let _0x5f5b9a=0x0;_0x5f5b9a<_0x2a9774[_0x5e4aae(0x156)][_0x5e4aae(0xfc)];_0x5f5b9a++){const _0x40729e=_0x2a9774[_0x5e4aae(0x156)][_0x5f5b9a];for(let _0x484586=0x0;_0x484586<=_0x38bfc4[_0x5e4aae(0x157)][_0x5e4aae(0xfc)]-0x1;_0x484586++){const _0x16938c=_0x38bfc4[_0x5e4aae(0x157)][_0x484586];_0x16938c['_id'][_0x5e4aae(0x20d)]==_0x40729e[_0x5e4aae(0x152)]&&_0x16938c[_0x5e4aae(0x11a)][_0x5e4aae(0x213)]==_0x40729e[_0x5e4aae(0x213)]&&(_0x2d2286+=parseInt(_0x16938c['totalQTY'],0xa));}for(let _0x3e874a=0x0;_0x3e874a<=_0x38bfc4[_0x5e4aae(0x212)][_0x5e4aae(0xfc)]-0x1;_0x3e874a++){const _0x4ea34b=_0x38bfc4[_0x5e4aae(0x212)][_0x3e874a];_0x4ea34b[_0x5e4aae(0x11a)][_0x5e4aae(0x20d)]==_0x40729e[_0x5e4aae(0x152)]&&_0x4ea34b[_0x5e4aae(0x11a)][_0x5e4aae(0x213)]==_0x40729e[_0x5e4aae(0x213)]&&(_0x4a8de5+=parseFloat(_0x4ea34b[_0x5e4aae(0x169)],0xa)['toFixed'](0x2));}for(let _0xb7d04c=0x0;_0xb7d04c<=_0x38bfc4[_0x5e4aae(0x252)][_0x5e4aae(0xfc)]-0x1;_0xb7d04c++){const _0x34d872=_0x38bfc4['sales_bkg'][_0xb7d04c];_0x34d872[_0x5e4aae(0x11a)]['product_name']==_0x40729e['name']&&_0x34d872[_0x5e4aae(0x11a)][_0x5e4aae(0x213)]==_0x40729e[_0x5e4aae(0x213)]&&(_0x69c0ed+=parseInt(_0x34d872[_0x5e4aae(0x169)],0xa));}}const _0x1321f7=new Intl[(_0x5e4aae(0x265))]('en-US');var _0x38a940=_0x1321f7[_0x5e4aae(0x245)](_0x2d2286);_0x1239b5[_0x2a9774['_id']['brand']][_0x5e4aae(0x206)](_0x38a940),_0x14abc1[_0x2a9774['_id'][_0x5e4aae(0x20a)]][_0x5e4aae(0x206)](_0x1321f7[_0x5e4aae(0x245)](_0x4a8de5)),_0x2bf7e1[_0x2a9774['_id']['brand']]['push'](_0x1321f7[_0x5e4aae(0x245)](_0x69c0ed));var _0x42b1c4=_0x1321f7[_0x5e4aae(0x245)](_0x2d2286-(_0x69c0ed+_0x4a8de5));_0xe5d110+=_0x5e4aae(0x17a),_0xe5d110+=_0x5e4aae(0x22d),_0xe5d110+='<td\x20class=\x22row_data\x22>'+_0x2a9774[_0x5e4aae(0x11a)][_0x5e4aae(0x20a)]+_0x5e4aae(0x199),_0xe5d110+=_0x5e4aae(0xf4)+_0x1239b5[_0x2a9774[_0x5e4aae(0x11a)]['brand']][0x0]+_0x5e4aae(0x199),_0xe5d110+=_0x5e4aae(0x178),_0xe5d110+=_0x5e4aae(0xf4)+_0x2bf7e1[_0x2a9774['_id'][_0x5e4aae(0x20a)]][0x0]+_0x5e4aae(0x199),_0xe5d110+=_0x5e4aae(0xf4)+_0x14abc1[_0x2a9774[_0x5e4aae(0x11a)][_0x5e4aae(0x20a)]][0x0]+_0x5e4aae(0x199),_0xe5d110+='<td\x20class=\x22row_data\x22>'+_0x42b1c4+_0x5e4aae(0x199),_0xe5d110+='</tr>';}}}return console[_0x5e4aae(0x1e4)](_0x38bfc4[_0x5e4aae(0x252)]),_0xe5d110;}router['post'](a0_0x441f86(0x114),auth,async(_0x51927b,_0x51998a)=>{const _0x42e2cf=a0_0x441f86,{from_date:_0x4ab541,to_date:_0x763c54}=_0x51927b['body'],_0x6acbae=await dataCheck(_0x4ab541,_0x763c54);{}let _0x3f7d79='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x459a08=new Date(_0x4ab541),_0x4c98fe=new Date(_0x763c54);const _0x33115a={'year':_0x42e2cf(0x232),'month':_0x42e2cf(0x1e5),'day':_0x42e2cf(0x232)},_0x2d7719=new Intl['DateTimeFormat'](_0x42e2cf(0x130),_0x33115a)[_0x42e2cf(0x245)](_0x459a08),_0x92be45=new Intl[(_0x42e2cf(0x113))]('en-US',_0x33115a)[_0x42e2cf(0x245)](_0x4c98fe);_0x3f7d79+=_0x42e2cf(0x1b7),_0x3f7d79+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x3f7d79+=_0x42e2cf(0x12b)+_0x2d7719+'\x20-\x20'+_0x92be45+_0x42e2cf(0x1b3),_0x3f7d79+=_0x42e2cf(0x247),_0x3f7d79+=_0x42e2cf(0x242),_0x3f7d79+=_0x42e2cf(0x138),_0x3f7d79+=_0x42e2cf(0x17a),_0x3f7d79+=_0x42e2cf(0x19d),_0x3f7d79+='<th\x20rowspan=\x272\x27>Products</th>',_0x3f7d79+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x2d7719+'</th>',_0x3f7d79+=_0x42e2cf(0x1cf),_0x3f7d79+=_0x42e2cf(0x1f6),_0x3f7d79+=_0x42e2cf(0x180)+_0x92be45+_0x42e2cf(0x135),_0x3f7d79+=_0x42e2cf(0x1be),_0x3f7d79+=_0x42e2cf(0x17a),_0x3f7d79+=_0x42e2cf(0x17d),_0x3f7d79+='<th>X-Truck</th>',_0x3f7d79+=_0x42e2cf(0x1be),_0x3f7d79+=_0x6acbae,_0x3f7d79+=_0x42e2cf(0x23d),_0x3f7d79+=_0x42e2cf(0x112),_0x3f7d79+=_0x42e2cf(0x112);const _0x2cefdd={'format':_0x42e2cf(0x16a),'orientation':_0x42e2cf(0x211)};pdf[_0x42e2cf(0x100)](_0x3f7d79,_0x2cefdd)[_0x42e2cf(0x25d)](function(_0x5800d2,_0x296b4e){const _0x130efa=_0x42e2cf;if(_0x5800d2){_0x51998a['status'](0x1f4)[_0x130efa(0x179)](_0x130efa(0xff));return;}_0x51998a['setHeader']('Content-Type',_0x130efa(0x144)),_0x296b4e['pipe'](_0x51998a);});}),router[a0_0x441f86(0x167)]('/agent/view',auth,async(_0x5cd6fb,_0x49c8b4)=>{const _0x36e5b9=a0_0x441f86;try{const {username:_0x427d18,email:_0x26b044,role:_0x223c02}=_0x5cd6fb[_0x36e5b9(0x275)],_0x26dbfb=_0x5cd6fb[_0x36e5b9(0x275)],_0x1242c3=await profile[_0x36e5b9(0x14f)]({'email':_0x26dbfb[_0x36e5b9(0x1d0)]}),_0x4b1ddf={'year':_0x36e5b9(0x232),'month':_0x36e5b9(0x1e5),'day':_0x36e5b9(0x232)},_0x442142=await master_shop[_0x36e5b9(0x234)](),_0x1d5eef=await product[_0x36e5b9(0x234)](),_0x196364=await warehouse[_0x36e5b9(0x27c)]([{'$unwind':_0x36e5b9(0x124)},{'$lookup':{'from':_0x36e5b9(0x156),'localField':'product_details.product_name','foreignField':_0x36e5b9(0x152),'as':_0x36e5b9(0x209)}},{'$unwind':_0x36e5b9(0x1ae)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x36e5b9(0x215),'product_stock':{'$sum':_0x36e5b9(0x1fe)}}}]);if(_0x442142[0x0]['language']==_0x36e5b9(0x208))var _0xdeb292=users[_0x36e5b9(0x11e)];else{if(_0x442142[0x0][_0x36e5b9(0x227)]==_0x36e5b9(0x168))var _0xdeb292=users[_0x36e5b9(0x168)];else{if(_0x442142[0x0]['language']==_0x36e5b9(0x177))var _0xdeb292=users[_0x36e5b9(0x177)];else{if(_0x442142[0x0]['language']=='Spanish')var _0xdeb292=users[_0x36e5b9(0x1ca)];else{if(_0x442142[0x0][_0x36e5b9(0x227)]==_0x36e5b9(0x1d3))var _0xdeb292=users[_0x36e5b9(0x1d3)];else{if(_0x442142[0x0][_0x36e5b9(0x227)]==_0x36e5b9(0x183))var _0xdeb292=users['Portuguese'];else{if(_0x442142[0x0][_0x36e5b9(0x227)]==_0x36e5b9(0x16d))var _0xdeb292=users[_0x36e5b9(0x16d)];else{if(_0x442142[0x0][_0x36e5b9(0x227)]==_0x36e5b9(0x15e))var _0xdeb292=users[_0x36e5b9(0x21c)];}}}}}}}_0x49c8b4[_0x36e5b9(0x11d)](_0x36e5b9(0x153),{'success':_0x5cd6fb[_0x36e5b9(0x1a7)]('success'),'errors':_0x5cd6fb[_0x36e5b9(0x1a7)](_0x36e5b9(0x1e7)),'alldata':_0x1d5eef,'profile':_0x1242c3,'master_shop':_0x442142,'role':_0x26dbfb,'product_stock':_0x196364,'language':_0xdeb292});}catch(_0x2a656b){}});async function agentsdataCheck(_0x57fcd2,_0x51e650){const _0x250a77=a0_0x441f86,_0x2b73a7=await product[_0x250a77(0x27c)]([{'$group':{'_id':{'brand':_0x250a77(0x221),'category':_0x250a77(0x216)},'products':{'$push':{'name':_0x250a77(0x1e6),'product_code':_0x250a77(0x243)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x300b7c=[];_0x300b7c[_0x250a77(0x261)]=[];for(let _0x549074=0x0;_0x549074<=_0x2b73a7[_0x250a77(0xfc)]-0x1;_0x549074++){const _0x4eb728=_0x2b73a7[_0x549074];_0x300b7c[_0x250a77(0x261)]['push'](_0x4eb728);}const _0x17de83=await product[_0x250a77(0x27c)]([{'$group':{'_id':{'category':_0x250a77(0x216)},'products':{'$push':{'brand':_0x250a77(0x221),'product_code':'$product_code','product_name':_0x250a77(0x1e6)}}}},{'$sort':{'_id.category':-0x1}}]),_0xf7519e=await product[_0x250a77(0x27c)]([{'$group':{'_id':{'category':_0x250a77(0x216),'brand':_0x250a77(0x221)}}},{'$group':{'_id':_0x250a77(0xf8),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x64dc94=await sales_sa[_0x250a77(0x27c)]([{'$match':{'date':{'$gte':_0x57fcd2,'$lte':_0x51e650}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x250a77(0x20b)}}},{'$lookup':{'from':_0x250a77(0x1bf),'localField':_0x250a77(0xfb),'foreignField':_0x250a77(0x11a),'as':_0x250a77(0x233)}},{'$unwind':_0x250a77(0x1a4)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x250a77(0x1ee)}},{'$lookup':{'from':_0x250a77(0x156),'localField':_0x250a77(0x25b),'foreignField':'product_code','as':_0x250a77(0x17f)}},{'$unwind':_0x250a77(0xf2)},{'$group':{'_id':{'sales_id':'$sales_info._id','category':_0x250a77(0x264),'brand':_0x250a77(0x19e)},'salesman_data':{'$first':_0x250a77(0x13b)},'totalQTY':{'$sum':_0x250a77(0x1c2)},'products':{'$push':{'qty':_0x250a77(0x1c2),'product_details':{'prod_name':_0x250a77(0x1ce),'product_code':_0x250a77(0x269),'category':'$product_info.category','brand':_0x250a77(0x19e)}}}}}]);let _0x39a398='';_0x39a398+='<tr>',_0x39a398+=_0x250a77(0x24e),_0x39a398+=_0x250a77(0x1be),_0x39a398+=_0x250a77(0x17a),_0x39a398+='<td\x20class=\x22cat_data\x22></td>';for(let _0x49011a=0x0;_0x49011a<=_0x17de83['length']-0x1;_0x49011a++){const _0x6b7527=_0x17de83[_0x49011a];for(let _0x297404=0x0;_0x297404<_0xf7519e[_0x250a77(0xfc)];_0x297404++){const _0x5de764=_0xf7519e[_0x297404];_0x5de764['_id']==_0x6b7527[_0x250a77(0x11a)][_0x250a77(0x11f)]&&(_0x39a398+='<td\x20colspan=\x22'+_0x5de764[_0x250a77(0x1eb)]+_0x250a77(0x1a9)+_0x6b7527[_0x250a77(0x11a)][_0x250a77(0x11f)]+_0x250a77(0x199));}}_0x39a398+=_0x250a77(0x238),_0x39a398+=_0x250a77(0x1be),_0x39a398+=_0x250a77(0x17a),_0x39a398+=_0x250a77(0x276);for(let _0x41765d=0x0;_0x41765d<=_0x17de83[_0x250a77(0xfc)]-0x1;_0x41765d++){const _0x112fca=_0x17de83[_0x41765d];for(let _0x5322de=0x0;_0x5322de<_0x300b7c[_0x250a77(0x261)][_0x250a77(0xfc)];_0x5322de++){const _0x13788d=_0x300b7c[_0x250a77(0x261)][_0x5322de];_0x13788d[_0x250a77(0x11a)][_0x250a77(0x11f)]==_0x112fca[_0x250a77(0x11a)][_0x250a77(0x11f)]&&(_0x39a398+=_0x250a77(0x16e)+_0x13788d[_0x250a77(0x11a)][_0x250a77(0x20a)]+'</td>');}}_0x39a398+=_0x250a77(0x19a),_0x39a398+=_0x250a77(0x1be);let _0x3a8bb5={'name':[],'dataqty':{}};for(let _0x4bd071=0x0;_0x4bd071<_0x300b7c['cat_brand']['length'];_0x4bd071++){const _0x59a586=_0x300b7c[_0x250a77(0x261)][_0x4bd071],_0x4a1841=_0x59a586['_id'][_0x250a77(0x20a)],_0x4341a8=_0x59a586[_0x250a77(0x11a)][_0x250a77(0x11f)];!_0x3a8bb5[_0x250a77(0xf3)][_0x4a1841]&&(_0x3a8bb5[_0x250a77(0xf3)][_0x4a1841]={});!_0x3a8bb5[_0x250a77(0xf3)][_0x4a1841][_0x4341a8]&&(_0x3a8bb5[_0x250a77(0xf3)][_0x4a1841][_0x4341a8]=[]);for(let _0x331f3d=0x0;_0x331f3d<_0x64dc94[_0x250a77(0xfc)];_0x331f3d++){const _0x4bb7e9=_0x64dc94[_0x331f3d];if(_0x4a1841===_0x4bb7e9[_0x250a77(0x11a)]['brand']&&_0x4341a8===_0x4bb7e9[_0x250a77(0x11a)][_0x250a77(0x11f)]){const _0x30baeb=_0x4bb7e9[_0x250a77(0x277)];!_0x3a8bb5[_0x250a77(0xf3)][_0x4a1841][_0x4341a8][_0x30baeb]&&(_0x3a8bb5[_0x250a77(0xf3)][_0x4a1841][_0x4341a8][_0x30baeb]=[]),_0x3a8bb5['dataqty'][_0x4a1841][_0x4341a8][_0x30baeb]['push'](_0x4bb7e9['totalQTY']),!_0x3a8bb5['name']['includes'](_0x30baeb)&&_0x3a8bb5['name'][_0x250a77(0x206)](_0x30baeb);}}}_0x39a398+=_0x250a77(0x17a);for(let _0x43bd42=0x0;_0x43bd42<=_0x3a8bb5['name'][_0x250a77(0xfc)]-0x1;_0x43bd42++){const _0xbbc2ba=_0x3a8bb5[_0x250a77(0x152)][_0x43bd42];_0x39a398+='<td\x20class=\x22row_data\x22>'+_0xbbc2ba+_0x250a77(0x199);var _0x4ad226=0x0,_0x3c6eef=0x0;for(let _0x3cb93e=0x0;_0x3cb93e<=_0x300b7c[_0x250a77(0x261)][_0x250a77(0xfc)]-0x1;_0x3cb93e++){const _0x5c37b7=_0x300b7c[_0x250a77(0x261)][_0x3cb93e];var _0x1507fb=0x0;_0x3a8bb5[_0x250a77(0xf3)][_0x5c37b7[_0x250a77(0x11a)][_0x250a77(0x20a)]][_0x5c37b7[_0x250a77(0x11a)][_0x250a77(0x11f)]][_0xbbc2ba]?(_0x1507fb=_0x3a8bb5[_0x250a77(0xf3)][_0x5c37b7[_0x250a77(0x11a)][_0x250a77(0x20a)]][_0x5c37b7[_0x250a77(0x11a)]['category']][_0xbbc2ba][0x0],_0x39a398+=_0x250a77(0xf4)+formatNumber(_0x1507fb[_0x250a77(0x18e)](0x2))+_0x250a77(0x199)):(_0x1507fb=0x0,_0x39a398+=_0x250a77(0xf4)+_0x1507fb+_0x250a77(0x199)),_0x4ad226+=_0x1507fb;}_0x39a398+=_0x250a77(0xf4)+formatNumber(_0x4ad226[_0x250a77(0x18e)](0x2))+_0x250a77(0x199);}return _0x39a398+=_0x250a77(0x1be),_0x39a398;}router[a0_0x441f86(0x1ea)](a0_0x441f86(0x22b),auth,async(_0x5aca6a,_0x213bbf)=>{const _0x1d3cc8=a0_0x441f86,{from_date:_0x349dec,to_date:_0xe05db6}=_0x5aca6a[_0x1d3cc8(0x184)],_0x4d05b1=await agentsdataCheck(_0x349dec,_0xe05db6);{}let _0x13b87a=_0x1d3cc8(0x274);var _0x1e34ab=new Date(_0x349dec),_0x1e0fd9=new Date(_0xe05db6);const _0xdbbad6={'year':_0x1d3cc8(0x232),'month':_0x1d3cc8(0x1e5),'day':_0x1d3cc8(0x232)},_0x5dafd0=new Intl[(_0x1d3cc8(0x113))](_0x1d3cc8(0x130),_0xdbbad6)[_0x1d3cc8(0x245)](_0x1e34ab),_0x264ad7=new Intl['DateTimeFormat'](_0x1d3cc8(0x130),_0xdbbad6)[_0x1d3cc8(0x245)](_0x1e0fd9);_0x13b87a+=_0x1d3cc8(0x1b7),_0x13b87a+='<p>SALES\x20REPORTS</p>',_0x13b87a+=_0x1d3cc8(0x12b)+_0x5dafd0+_0x1d3cc8(0x267)+_0x264ad7+_0x1d3cc8(0x1b3),_0x13b87a+=_0x1d3cc8(0x247),_0x13b87a+=_0x1d3cc8(0x242),_0x13b87a+=_0x1d3cc8(0x138),_0x13b87a+=_0x4d05b1,_0x13b87a+='</table>',_0x13b87a+=_0x1d3cc8(0x112),_0x13b87a+='</div>';const _0x54ea76={'format':_0x1d3cc8(0x16a),'orientation':_0x1d3cc8(0x211)};pdf[_0x1d3cc8(0x100)](_0x13b87a,_0x54ea76)[_0x1d3cc8(0x25d)](function(_0x29ad97,_0x41baf3){const _0x104e32=_0x1d3cc8;if(_0x29ad97){_0x213bbf['status'](0x1f4)[_0x104e32(0x179)](_0x104e32(0xff));return;}_0x213bbf[_0x104e32(0x163)](_0x104e32(0x115),_0x104e32(0x144)),_0x41baf3['pipe'](_0x213bbf);});}),router['get'](a0_0x441f86(0x23c),auth,async(_0x2c26aa,_0x2d2905)=>{const _0x311632=a0_0x441f86;try{const {username:_0x475905,email:_0x25212b,role:_0x1fb0b8}=_0x2c26aa[_0x311632(0x275)],_0x46721e=_0x2c26aa[_0x311632(0x275)],_0x338416=await profile[_0x311632(0x14f)]({'email':_0x46721e[_0x311632(0x1d0)]}),_0x5e4e82={'year':_0x311632(0x232),'month':'long','day':_0x311632(0x232)},_0x73e6c1=await master_shop['find'](),_0x5467cd=await staff[_0x311632(0x14f)]({'email':_0x46721e[_0x311632(0x1d0)]}),_0xe148d7=await product[_0x311632(0x234)](),_0xa38be1=await warehouse[_0x311632(0x27c)]([{'$unwind':_0x311632(0x124)},{'$lookup':{'from':_0x311632(0x156),'localField':'product_details.product_name','foreignField':'name','as':_0x311632(0x209)}},{'$unwind':_0x311632(0x1ae)},{'$project':{'product_name':_0x311632(0x120),'product_stock':_0x311632(0x1dc)}},{'$group':{'_id':_0x311632(0x215),'product_stock':{'$sum':'$product_stock'}}}]),_0xda44bf=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x73e6c1[0x0][_0x311632(0x227)]==_0x311632(0x208))var _0x55bfaa=users['English'];else{if(_0x73e6c1[0x0]['language']==_0x311632(0x168))var _0x55bfaa=users[_0x311632(0x168)];else{if(_0x73e6c1[0x0][_0x311632(0x227)]==_0x311632(0x177))var _0x55bfaa=users['German'];else{if(_0x73e6c1[0x0][_0x311632(0x227)]=='Spanish')var _0x55bfaa=users[_0x311632(0x1ca)];else{if(_0x73e6c1[0x0][_0x311632(0x227)]==_0x311632(0x1d3))var _0x55bfaa=users[_0x311632(0x1d3)];else{if(_0x73e6c1[0x0]['language']==_0x311632(0x183))var _0x55bfaa=users['Portuguese'];else{if(_0x73e6c1[0x0][_0x311632(0x227)]==_0x311632(0x16d))var _0x55bfaa=users[_0x311632(0x16d)];else{if(_0x73e6c1[0x0][_0x311632(0x227)]=='Arabic\x20(ae)')var _0x55bfaa=users[_0x311632(0x21c)];}}}}}}}_0x2d2905[_0x311632(0x11d)](_0x311632(0x109),{'success':_0x2c26aa[_0x311632(0x1a7)](_0x311632(0x133)),'errors':_0x2c26aa[_0x311632(0x1a7)](_0x311632(0x1e7)),'alldata':_0xe148d7,'profile':_0x338416,'master_shop':_0x73e6c1,'role':_0x46721e,'product_stock':_0xa38be1,'language':_0x55bfaa,'staff_arr':_0x5467cd,'staff_data_all':_0xda44bf});}catch(_0x4a1e4f){_0x2d2905[_0x311632(0x21e)](_0x4a1e4f);}});async function agentsdataDSICheck_admin(_0x1f871a,_0xccd2a8,_0x1192c5,_0x81dad6){const _0xdc3a75=a0_0x441f86,_0x31b8d7=await product[_0xdc3a75(0x27c)]([{'$group':{'_id':{'brand':_0xdc3a75(0x221),'category':_0xdc3a75(0x216)},'products':{'$push':{'name':_0xdc3a75(0x1e6),'product_code':_0xdc3a75(0x243)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x379485=[];_0x379485[_0xdc3a75(0x261)]=[];for(let _0x462cdf=0x0;_0x462cdf<=_0x31b8d7[_0xdc3a75(0xfc)]-0x1;_0x462cdf++){const _0x58e3cf=_0x31b8d7[_0x462cdf];_0x379485[_0xdc3a75(0x261)][_0xdc3a75(0x206)](_0x58e3cf);}const _0xf466bf=await product[_0xdc3a75(0x27c)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0xdc3a75(0x221),'product_code':_0xdc3a75(0x243),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x5924d1=await product[_0xdc3a75(0x27c)]([{'$group':{'_id':{'category':'$category','brand':_0xdc3a75(0x221)}}},{'$group':{'_id':_0xdc3a75(0xf8),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2756d3=await sales_sa[_0xdc3a75(0x27c)]([{'$match':{'date':{'$gte':_0x1f871a,'$lte':_0xccd2a8},'sales_staff_id':_0x1192c5,'sale_product.isFG':'false'}},{'$unwind':_0xdc3a75(0x22c)},{'$match':{'sale_product.isFG':_0xdc3a75(0x1ee)}},{'$lookup':{'from':_0xdc3a75(0x156),'localField':_0xdc3a75(0x25b),'foreignField':_0xdc3a75(0x213),'as':_0xdc3a75(0x17f)}},{'$unwind':_0xdc3a75(0xf2)},{'$group':{'_id':{'dsi':_0xdc3a75(0x121),'date':_0xdc3a75(0x143),'customer':'$customer'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0xdc3a75(0x15f),'discount':_0xdc3a75(0x194),'adj_discount':_0xdc3a75(0x132),'product_details':{'prod_name':_0xdc3a75(0x1ce),'product_code':_0xdc3a75(0x269),'category':_0xdc3a75(0x264),'brand':'$product_info.brand','gross_price':_0xdc3a75(0x24b)}}}}},{'$unwind':_0xdc3a75(0x10d)},{'$group':{'_id':{'dsi':_0xdc3a75(0x205),'date':_0xdc3a75(0x1d8),'customer':_0xdc3a75(0x154),'category':_0xdc3a75(0x12c),'brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0xdc3a75(0x272),_0xdc3a75(0x21a)]}},'NetPrice':{'$sum':_0xdc3a75(0x19c)},'discount':{'$sum':_0xdc3a75(0x253)},'adj_discount':{'$sum':_0xdc3a75(0xf5)},'product_details':{'$first':_0xdc3a75(0x149)}}},{'$group':{'_id':{'dsi':_0xdc3a75(0x205),'date':_0xdc3a75(0x1d8),'customer':_0xdc3a75(0x154)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0xdc3a75(0x1f9)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0xdc3a75(0x196)},'adj_discount':{'$sum':_0xdc3a75(0x181)},'products':{'$push':{'qty':_0xdc3a75(0x235),'category':_0xdc3a75(0xf8),'brand':_0xdc3a75(0x186),'product_details':_0xdc3a75(0x124)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x3a10da=[],_0xe34528={},_0x20b0da={},_0x5cb83c={};var _0x4750c4=0x0,_0x1ca168=0x0,_0x1db0ec=0x0,_0x16dc1c=0x0,_0x4d9918=0x0;const _0x32e3db=0x6;for(let _0x59a0f4=0x0;_0x59a0f4<=_0x2756d3[_0xdc3a75(0xfc)]-0x1;_0x59a0f4++){const _0x516455=_0x2756d3[_0x59a0f4];let _0x391284=_0xdc3a75(0x17a);_0x391284+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x516455[_0xdc3a75(0x11a)]['dsi']+_0xdc3a75(0x199),_0x391284+=_0xdc3a75(0x10c)+_0x516455[_0xdc3a75(0x11a)][_0xdc3a75(0x214)]+'</td>',_0x391284+=_0xdc3a75(0x10c)+_0x516455['_id'][_0xdc3a75(0x106)]+'</td>';let _0x2fd8dc={};var _0x239027=0x0;for(let _0x178a49=0x0;_0x178a49<=_0x516455[_0xdc3a75(0x156)][_0xdc3a75(0xfc)]-0x1;_0x178a49++){const _0xed3054=_0x516455[_0xdc3a75(0x156)][_0x178a49];_0x2fd8dc[_0xed3054[_0xdc3a75(0x20a)]+'-'+_0xed3054[_0xdc3a75(0x11f)]]=_0xed3054[_0xdc3a75(0x110)];const _0x6332d1=_0xed3054[_0xdc3a75(0x20a)]+'-'+_0xed3054['category'];!_0xe34528[_0x6332d1]&&(_0xe34528[_0x6332d1]=0x0),!Array[_0xdc3a75(0x166)](_0x5cb83c[_0x6332d1])&&(_0x5cb83c[_0x6332d1]=[]),!Array[_0xdc3a75(0x166)](_0x5cb83c[_0x6332d1])&&(_0x5cb83c[_0x6332d1]=[]),_0xe34528[_0x6332d1]+=_0xed3054[_0xdc3a75(0x110)],_0x5cb83c[_0x6332d1][_0xdc3a75(0x206)](_0xed3054[_0xdc3a75(0x110)]),_0x239027++;}console[_0xdc3a75(0x1e4)](_0x516455);for(let _0x1a7384=0x0;_0x1a7384<=_0x379485['cat_brand']['length']-0x1;_0x1a7384++){const _0x5f50d9=_0x379485[_0xdc3a75(0x261)][_0x1a7384],_0x64d76d=_0x5f50d9['_id'][_0xdc3a75(0x20a)]+'-'+_0x5f50d9[_0xdc3a75(0x11a)][_0xdc3a75(0x11f)];_0x391284+=_0xdc3a75(0x27e)+(_0x2fd8dc[_0x64d76d]!==undefined?_0x2fd8dc[_0x64d76d]['toFixed'](0x2):'')+_0xdc3a75(0x199);}_0x1db0ec=_0x516455[_0xdc3a75(0x15a)]+_0x516455[_0xdc3a75(0x1b0)],_0x391284+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x516455[_0xdc3a75(0x259)],0x2)[_0xdc3a75(0x18e)](0x2))+_0xdc3a75(0x199),_0x391284+=_0xdc3a75(0x129)+formatNumber(_0x516455[_0xdc3a75(0x15c)][_0xdc3a75(0x18e)](0x2))+_0xdc3a75(0x199),_0x391284+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x1db0ec)+_0xdc3a75(0x199),_0x391284+=_0xdc3a75(0x129)+formatNumber(_0x516455[_0xdc3a75(0x241)][_0xdc3a75(0x18e)](0x2))+_0xdc3a75(0x199),_0x391284+=_0xdc3a75(0x1be),_0x4750c4+=parseFloat(_0x516455[_0xdc3a75(0x259)][_0xdc3a75(0x18e)](0x2)),_0x1ca168+=parseFloat(_0x516455[_0xdc3a75(0x241)][_0xdc3a75(0x18e)](0x2)),_0x16dc1c+=_0x1db0ec,_0x4d9918+=parseFloat(_0x516455[_0xdc3a75(0x15c)][_0xdc3a75(0x18e)](0x2));if(_0x59a0f4==_0x2756d3[_0xdc3a75(0xfc)]-0x1){_0x391284+=_0xdc3a75(0x17a),_0x391284+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x391284+=_0xdc3a75(0x199);for(let _0x183485=0x0;_0x183485<=_0x379485[_0xdc3a75(0x261)][_0xdc3a75(0xfc)]-0x1;_0x183485++){const _0x6dbadf=_0x379485['cat_brand'][_0x183485],_0x5e6fb9=_0x6dbadf[_0xdc3a75(0x11a)][_0xdc3a75(0x20a)]+'-'+_0x6dbadf[_0xdc3a75(0x11a)][_0xdc3a75(0x11f)],_0x20fbde=_0x5cb83c[_0x5e6fb9][_0xdc3a75(0x105)]((_0x50b85b,_0x325fea)=>_0x50b85b+_0x325fea,0x0);console[_0xdc3a75(0x1e4)]('test',_0x5e6fb9),_0x391284+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x20fbde!==undefined?formatNumber(_0x20fbde[_0xdc3a75(0x18e)](0x2)):'')+'</b></td>',console[_0xdc3a75(0x1e4)](_0x5cb83c[_0x5e6fb9][_0xdc3a75(0x105)]((_0xd166de,_0x4faec0)=>_0xd166de+_0x4faec0,0x0));}_0x391284+=_0xdc3a75(0x10b)+formatNumber(_0x4750c4[_0xdc3a75(0x18e)](0x2))+_0xdc3a75(0x223),_0x391284+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4d9918)+_0xdc3a75(0x223),_0x391284+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x16dc1c)+'</b></td>',_0x391284+=_0xdc3a75(0x10b)+formatNumber(_0x1ca168)+_0xdc3a75(0x223),_0x391284+=_0xdc3a75(0x1be);}_0x3a10da[_0xdc3a75(0x206)](_0x391284);}function _0x27dfca(_0x13fa9e,_0x4d3fee){const _0x337607=_0xdc3a75,_0x437afe=[];for(let _0x50af6f=0x0;_0x50af6f<=_0x13fa9e[_0x337607(0xfc)]-0x1;_0x50af6f+=_0x4d3fee){_0x437afe[_0x337607(0x206)](_0x13fa9e['slice'](_0x50af6f,_0x50af6f+_0x4d3fee));}return _0x437afe;}const _0x1853df=_0x27dfca(_0x3a10da,_0x32e3db);let _0x3c6669='';return _0x1853df[_0xdc3a75(0x268)]((_0xe67aba,_0x36da7d)=>{const _0x20733a=_0xdc3a75;_0x36da7d>0x0&&(_0x3c6669+=_0x20733a(0x1ed));_0x3c6669+=_0x20733a(0x138),_0x3c6669+=_0x20733a(0x23b),_0x3c6669+=_0x20733a(0x17a),_0x3c6669+=_0x20733a(0x17b),_0x3c6669+=_0x20733a(0x1be),_0x3c6669+=_0x20733a(0x17a),_0x3c6669+=_0x20733a(0x1cb);for(let _0x14e2a7=0x0;_0x14e2a7<=_0xf466bf[_0x20733a(0xfc)]-0x1;_0x14e2a7++){const _0x46b61a=_0xf466bf[_0x14e2a7];for(let _0x5d8a95=0x0;_0x5d8a95<_0x5924d1[_0x20733a(0xfc)];_0x5d8a95++){const _0x22fc78=_0x5924d1[_0x5d8a95];_0x22fc78[_0x20733a(0x11a)]===_0x46b61a[_0x20733a(0x11a)][_0x20733a(0x11f)]&&(_0x3c6669+=_0x20733a(0x257)+_0x22fc78[_0x20733a(0x1eb)]+'\x22\x20class=\x22cat_data\x22>'+_0x46b61a[_0x20733a(0x11a)][_0x20733a(0x11f)]+_0x20733a(0x199));}}_0x3c6669+=_0x20733a(0x101),_0x3c6669+=_0x20733a(0x1be),_0x3c6669+='<tr>',_0x3c6669+=_0x20733a(0x192),_0x3c6669+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x3c6669+=_0x20733a(0x19b);for(let _0x1ad9f6=0x0;_0x1ad9f6<=_0xf466bf[_0x20733a(0xfc)]-0x1;_0x1ad9f6++){const _0x3383c2=_0xf466bf[_0x1ad9f6];for(let _0x17feaa=0x0;_0x17feaa<_0x379485[_0x20733a(0x261)][_0x20733a(0xfc)];_0x17feaa++){const _0x4bd5e3=_0x379485[_0x20733a(0x261)][_0x17feaa];_0x4bd5e3['_id'][_0x20733a(0x11f)]===_0x3383c2[_0x20733a(0x11a)][_0x20733a(0x11f)]&&(_0x3c6669+='<td\x20class=\x22cat_data\x22>'+_0x4bd5e3[_0x20733a(0x11a)]['brand']+_0x20733a(0x199));}}_0x3c6669+=_0x20733a(0x19a),_0x3c6669+=_0x20733a(0x191),_0x3c6669+=_0x20733a(0x1ad),_0x3c6669+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x3c6669+=_0x20733a(0x1be),_0x3c6669+=_0x20733a(0x244),_0x3c6669+=_0x20733a(0x278),_0xe67aba[_0x20733a(0x268)](_0x5ac821=>{_0x3c6669+=_0x5ac821;}),console['log'](_0x5cb83c),_0x3c6669+=_0x20733a(0x236),_0x3c6669+=_0x20733a(0x23d);}),_0x3c6669;}async function agentsdataDSICheck_admin_excel(_0x446e56,_0x3b1667,_0x4c02b5,_0x271e7f){const _0x1db4b0=a0_0x441f86,_0x2915e9=await product[_0x1db4b0(0x27c)]([{'$group':{'_id':{'brand':'$brand','category':_0x1db4b0(0x216)},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3064e2=[];_0x3064e2['cat_brand']=[];for(let _0x185faf=0x0;_0x185faf<=_0x2915e9[_0x1db4b0(0xfc)]-0x1;_0x185faf++){const _0x336d43=_0x2915e9[_0x185faf];_0x3064e2[_0x1db4b0(0x261)][_0x1db4b0(0x206)](_0x336d43);}const _0x26bcfd=await product[_0x1db4b0(0x27c)]([{'$group':{'_id':{'category':_0x1db4b0(0x216)},'products':{'$push':{'brand':_0x1db4b0(0x221),'product_code':_0x1db4b0(0x243),'product_name':_0x1db4b0(0x1e6)}}}},{'$sort':{'_id.category':-0x1}}]),_0x16e869=await product[_0x1db4b0(0x27c)]([{'$group':{'_id':{'category':_0x1db4b0(0x216),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3ef7df=await sales_sa[_0x1db4b0(0x27c)]([{'$match':{'date':{'$gte':_0x446e56,'$lte':_0x3b1667},'sales_staff_id':_0x4c02b5,'sale_product.isFG':_0x1db4b0(0x1ee)}},{'$unwind':_0x1db4b0(0x22c)},{'$match':{'sale_product.isFG':_0x1db4b0(0x1ee)}},{'$lookup':{'from':_0x1db4b0(0x156),'localField':'sale_product.product_code','foreignField':_0x1db4b0(0x213),'as':_0x1db4b0(0x17f)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x1db4b0(0x121),'date':_0x1db4b0(0x143),'customer':_0x1db4b0(0x173)},'totalQty':{'$sum':_0x1db4b0(0x1c2)},'products':{'$push':{'qty':_0x1db4b0(0x1c2),'NetPrice':_0x1db4b0(0x15f),'discount':_0x1db4b0(0x194),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x1db4b0(0x1ce),'product_code':_0x1db4b0(0x269),'category':_0x1db4b0(0x264),'brand':_0x1db4b0(0x19e),'gross_price':_0x1db4b0(0x24b)}}}}},{'$unwind':_0x1db4b0(0x10d)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1db4b0(0x1d8),'customer':'$_id.customer','category':_0x1db4b0(0x12c),'brand':_0x1db4b0(0x26e)},'totalQty':{'$sum':_0x1db4b0(0x272)},'totalGross':{'$sum':{'$multiply':[_0x1db4b0(0x272),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x1db4b0(0x253)},'adj_discount':{'$sum':_0x1db4b0(0xf5)},'product_details':{'$first':_0x1db4b0(0x149)}}},{'$group':{'_id':{'dsi':_0x1db4b0(0x205),'date':_0x1db4b0(0x1d8),'customer':'$_id.customer'},'totalQty':{'$sum':_0x1db4b0(0x235)},'totalGross':{'$sum':_0x1db4b0(0x1f9)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x1db4b0(0x196)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x1db4b0(0x235),'category':'$_id.category','brand':_0x1db4b0(0x186),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x15888e=[],_0x49f7cc={},_0x470b9d={},_0x491475={};var _0x38617c=0x0,_0x195214=0x0,_0x5fd81f=0x0,_0x1382bc=0x0,_0x411653=0x0;const _0x4a7a0a=0x16345785d8a0000;for(let _0x5935b2=0x0;_0x5935b2<=_0x3ef7df[_0x1db4b0(0xfc)]-0x1;_0x5935b2++){const _0x1745fc=_0x3ef7df[_0x5935b2];let _0x460ac1=_0x1db4b0(0x17a);_0x460ac1+=_0x1db4b0(0x10c)+_0x1745fc[_0x1db4b0(0x11a)]['dsi']+_0x1db4b0(0x199),_0x460ac1+=_0x1db4b0(0x10c)+_0x1745fc[_0x1db4b0(0x11a)][_0x1db4b0(0x214)]+_0x1db4b0(0x199),_0x460ac1+=_0x1db4b0(0x10c)+_0x1745fc['_id'][_0x1db4b0(0x106)]+_0x1db4b0(0x199);let _0x208e8a={};var _0x572bce=0x0;for(let _0x157cc9=0x0;_0x157cc9<=_0x1745fc[_0x1db4b0(0x156)]['length']-0x1;_0x157cc9++){const _0x32a389=_0x1745fc[_0x1db4b0(0x156)][_0x157cc9];_0x208e8a[_0x32a389[_0x1db4b0(0x20a)]+'-'+_0x32a389[_0x1db4b0(0x11f)]]=_0x32a389['qty'];const _0x2ed2b9=_0x32a389[_0x1db4b0(0x20a)]+'-'+_0x32a389['category'];!_0x49f7cc[_0x2ed2b9]&&(_0x49f7cc[_0x2ed2b9]=0x0),!Array['isArray'](_0x491475[_0x2ed2b9])&&(_0x491475[_0x2ed2b9]=[]),!Array[_0x1db4b0(0x166)](_0x491475[_0x2ed2b9])&&(_0x491475[_0x2ed2b9]=[]),_0x49f7cc[_0x2ed2b9]+=_0x32a389[_0x1db4b0(0x110)],_0x491475[_0x2ed2b9]['push'](_0x32a389[_0x1db4b0(0x110)]),_0x572bce++;}console['log'](_0x1745fc);for(let _0x139dc6=0x0;_0x139dc6<=_0x3064e2[_0x1db4b0(0x261)]['length']-0x1;_0x139dc6++){const _0x3d54be=_0x3064e2['cat_brand'][_0x139dc6],_0xc4c076=_0x3d54be[_0x1db4b0(0x11a)][_0x1db4b0(0x20a)]+'-'+_0x3d54be[_0x1db4b0(0x11a)][_0x1db4b0(0x11f)];_0x460ac1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x208e8a[_0xc4c076]!==undefined?_0x208e8a[_0xc4c076][_0x1db4b0(0x18e)](0x2):'')+_0x1db4b0(0x199);}_0x5fd81f=_0x1745fc[_0x1db4b0(0x15a)]+_0x1745fc['adj_discount'],_0x460ac1+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x1745fc[_0x1db4b0(0x259)],0x2)[_0x1db4b0(0x18e)](0x2))+_0x1db4b0(0x199),_0x460ac1+=_0x1db4b0(0x129)+formatNumber(_0x1745fc[_0x1db4b0(0x15c)][_0x1db4b0(0x18e)](0x2))+_0x1db4b0(0x199),_0x460ac1+=_0x1db4b0(0x129)+formatNumber(_0x5fd81f)+_0x1db4b0(0x199),_0x460ac1+=_0x1db4b0(0x129)+formatNumber(_0x1745fc['NetPrice']['toFixed'](0x2))+'</td>',_0x460ac1+='</tr>',_0x38617c+=parseFloat(_0x1745fc[_0x1db4b0(0x259)]['toFixed'](0x2)),_0x195214+=parseFloat(_0x1745fc['NetPrice'][_0x1db4b0(0x18e)](0x2)),_0x1382bc+=_0x5fd81f,_0x411653+=parseFloat(_0x1745fc[_0x1db4b0(0x15c)][_0x1db4b0(0x18e)](0x2));if(_0x5935b2==_0x3ef7df[_0x1db4b0(0xfc)]-0x1){_0x460ac1+=_0x1db4b0(0x17a),_0x460ac1+=_0x1db4b0(0x17e),_0x460ac1+=_0x1db4b0(0x199);for(let _0x4343d3=0x0;_0x4343d3<=_0x3064e2[_0x1db4b0(0x261)][_0x1db4b0(0xfc)]-0x1;_0x4343d3++){const _0x4f04e9=_0x3064e2[_0x1db4b0(0x261)][_0x4343d3],_0x4db280=_0x4f04e9[_0x1db4b0(0x11a)]['brand']+'-'+_0x4f04e9[_0x1db4b0(0x11a)][_0x1db4b0(0x11f)],_0x52fbaa=_0x491475[_0x4db280]['reduce']((_0xf886fb,_0x398227)=>_0xf886fb+_0x398227,0x0);console[_0x1db4b0(0x1e4)](_0x1db4b0(0x161),_0x4db280),_0x460ac1+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x52fbaa!==undefined?formatNumber(_0x52fbaa[_0x1db4b0(0x18e)](0x2)):'')+_0x1db4b0(0x223),console[_0x1db4b0(0x1e4)](_0x491475[_0x4db280][_0x1db4b0(0x105)]((_0x3ec546,_0x3ff1a5)=>_0x3ec546+_0x3ff1a5,0x0));}_0x460ac1+=_0x1db4b0(0x10b)+formatNumber(_0x38617c[_0x1db4b0(0x18e)](0x2))+_0x1db4b0(0x223),_0x460ac1+=_0x1db4b0(0x10b)+formatNumber(_0x411653)+_0x1db4b0(0x223),_0x460ac1+=_0x1db4b0(0x10b)+formatNumber(_0x1382bc)+_0x1db4b0(0x223),_0x460ac1+=_0x1db4b0(0x10b)+formatNumber(_0x195214)+_0x1db4b0(0x223),_0x460ac1+=_0x1db4b0(0x1be);}_0x15888e['push'](_0x460ac1);}function _0x21d5a5(_0xf6cc37,_0x51ba75){const _0x209fbe=_0x1db4b0,_0x519324=[];for(let _0xbf1355=0x0;_0xbf1355<=_0xf6cc37[_0x209fbe(0xfc)]-0x1;_0xbf1355+=_0x51ba75){_0x519324[_0x209fbe(0x206)](_0xf6cc37[_0x209fbe(0x1c5)](_0xbf1355,_0xbf1355+_0x51ba75));}return _0x519324;}const _0x1a7f48=_0x21d5a5(_0x15888e,_0x4a7a0a);let _0x12ba8a='';return _0x1a7f48[_0x1db4b0(0x268)]((_0x2a1e90,_0x4fef78)=>{const _0x400d9a=_0x1db4b0;_0x4fef78>0x0&&(_0x12ba8a+=_0x400d9a(0x1ed));_0x12ba8a+=_0x400d9a(0x138),_0x12ba8a+=_0x400d9a(0x23b),_0x12ba8a+='<tr>',_0x12ba8a+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x12ba8a+='</tr>',_0x12ba8a+=_0x400d9a(0x17a),_0x12ba8a+=_0x400d9a(0x1cb);for(let _0x2e305e=0x0;_0x2e305e<=_0x26bcfd[_0x400d9a(0xfc)]-0x1;_0x2e305e++){const _0x3afaa1=_0x26bcfd[_0x2e305e];for(let _0x2a8944=0x0;_0x2a8944<_0x16e869['length'];_0x2a8944++){const _0x3b1327=_0x16e869[_0x2a8944];_0x3b1327[_0x400d9a(0x11a)]===_0x3afaa1[_0x400d9a(0x11a)][_0x400d9a(0x11f)]&&(_0x12ba8a+='<td\x20colspan=\x22'+_0x3b1327[_0x400d9a(0x1eb)]+_0x400d9a(0x1a9)+_0x3afaa1['_id']['category']+_0x400d9a(0x199));}}_0x12ba8a+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x12ba8a+=_0x400d9a(0x1be),_0x12ba8a+=_0x400d9a(0x17a),_0x12ba8a+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x12ba8a+=_0x400d9a(0x246),_0x12ba8a+=_0x400d9a(0x19b);for(let _0x20eba8=0x0;_0x20eba8<=_0x26bcfd['length']-0x1;_0x20eba8++){const _0x2df529=_0x26bcfd[_0x20eba8];for(let _0x390660=0x0;_0x390660<_0x3064e2['cat_brand'][_0x400d9a(0xfc)];_0x390660++){const _0x2587cb=_0x3064e2[_0x400d9a(0x261)][_0x390660];_0x2587cb['_id'][_0x400d9a(0x11f)]===_0x2df529['_id'][_0x400d9a(0x11f)]&&(_0x12ba8a+='<td\x20class=\x22cat_data\x22>'+_0x2587cb[_0x400d9a(0x11a)][_0x400d9a(0x20a)]+_0x400d9a(0x199));}}_0x12ba8a+=_0x400d9a(0x19a),_0x12ba8a+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x12ba8a+=_0x400d9a(0x1ad),_0x12ba8a+=_0x400d9a(0x11b),_0x12ba8a+=_0x400d9a(0x1be),_0x12ba8a+=_0x400d9a(0x244),_0x12ba8a+=_0x400d9a(0x278),_0x2a1e90['forEach'](_0x483d4b=>{_0x12ba8a+=_0x483d4b;}),console[_0x400d9a(0x1e4)](_0x491475),_0x12ba8a+=_0x400d9a(0x236),_0x12ba8a+=_0x400d9a(0x23d);}),_0x12ba8a;}router[a0_0x441f86(0x1ea)]('/agent_reports/pdf_admin',auth,async(_0xe98c67,_0x55a00b)=>{const _0x2e9e0e=a0_0x441f86,{from_date:_0x5e40f1,to_date:_0x56fef5,isExcel:_0x38e48c,agent_id:_0x2fda7b}=_0xe98c67['body'],_0x4be111=_0xe98c67[_0x2e9e0e(0x275)],_0x418aab=await staff[_0x2e9e0e(0x14f)]({'email':_0x4be111['email']}),_0x344b1b=await master_shop[_0x2e9e0e(0x234)](),_0xd1f490=await agentsdataDSICheck_admin(_0x5e40f1,_0x56fef5,_0x2fda7b,_0x38e48c),_0x3237c0=await agentsdataDSICheck_admin_excel(_0x5e40f1,_0x56fef5,_0x2fda7b,_0x38e48c);let _0x4d25fb=_0x2e9e0e(0x26a);var _0x2df011=new Date(_0x5e40f1),_0x165975=new Date(_0x56fef5);const _0x2952f2={'year':_0x2e9e0e(0x232),'month':_0x2e9e0e(0x1e5),'day':_0x2e9e0e(0x232)},_0x1618d8=new Intl[(_0x2e9e0e(0x113))](_0x2e9e0e(0x130),_0x2952f2)['format'](_0x2df011),_0x588162=new Intl['DateTimeFormat'](_0x2e9e0e(0x130),_0x2952f2)[_0x2e9e0e(0x245)](_0x165975);_0x4d25fb+='<div\x20class=\x22row\x22>',_0x4d25fb+=_0x2e9e0e(0x1a6),_0x4d25fb+=_0x2e9e0e(0x138),_0x4d25fb+=_0xd1f490,_0x4d25fb+=_0x2e9e0e(0x23d),_0x4d25fb+='</div>',_0x4d25fb+=_0x2e9e0e(0x112);let _0x53c0ab='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x53c0ab+=_0x2e9e0e(0x247),_0x53c0ab+='<div\x20\x20id=\x22table-conatainer\x22>',_0x53c0ab+=_0x2e9e0e(0x138),_0x53c0ab+=_0x3237c0,_0x53c0ab+=_0x2e9e0e(0x23d),_0x53c0ab+=_0x2e9e0e(0x112),_0x53c0ab+=_0x2e9e0e(0x112);let _0x30bca2=_0x2e9e0e(0x18c);const _0x3b24ef={'width':'15in','height':_0x2e9e0e(0x22e),'orientation':_0x2e9e0e(0x211),'border':{'top':_0x2e9e0e(0x147),'right':_0x2e9e0e(0x147),'bottom':_0x2e9e0e(0x147),'left':_0x2e9e0e(0x147)},'header':{'height':_0x2e9e0e(0x1fc),'contents':_0x2e9e0e(0x203)+_0x30bca2+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x1618d8+'\x20-\x20'+_0x588162+_0x2e9e0e(0x21b)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x38e48c=='on'){const _0x6af51c=cheerio[_0x2e9e0e(0x17c)](_0x53c0ab);let _0x400178=[],_0x23fcc4=[],_0x1c7497=[];_0x6af51c('table\x20tr')['each']((_0x8ddc6b,_0x5393ce)=>{const _0x551b07=_0x2e9e0e;let _0x21c8fe=[],_0x518e83=0x0;while(_0x1c7497[_0x518e83]){_0x1c7497[_0x518e83]--,_0x518e83++;}_0x6af51c(_0x5393ce)[_0x551b07(0x234)]('td,\x20th')[_0x551b07(0x1b8)]((_0x4dec9f,_0x19ebc9)=>{const _0x233b2a=_0x551b07;let _0x444bb5=_0x6af51c(_0x19ebc9)[_0x233b2a(0x225)]()['trim'](),_0x1f86ab=parseFloat(_0x444bb5[_0x233b2a(0x1e8)](/,/g,''));isNaN(_0x1f86ab)&&(_0x1f86ab=_0x444bb5);let _0x48d085=parseInt(_0x6af51c(_0x19ebc9)['attr'](_0x233b2a(0x150)))||0x1,_0x4b2684=parseInt(_0x6af51c(_0x19ebc9)['attr'](_0x233b2a(0x189)))||0x1;_0x21c8fe[_0x518e83]=_0x1f86ab;(_0x48d085>0x1||_0x4b2684>0x1)&&_0x23fcc4[_0x233b2a(0x206)]({'s':{'r':_0x8ddc6b,'c':_0x518e83},'e':{'r':_0x8ddc6b+_0x4b2684-0x1,'c':_0x518e83+_0x48d085-0x1}});for(let _0x2ce079=0x0;_0x2ce079<_0x48d085;_0x2ce079++){_0x4b2684>0x1&&(_0x1c7497[_0x518e83+_0x2ce079]=_0x4b2684-0x1);}_0x518e83+=_0x48d085;}),_0x400178[_0x551b07(0x206)](_0x21c8fe);});const _0x58a179=XLSX[_0x2e9e0e(0x260)][_0x2e9e0e(0x119)](),_0x4a880a=XLSX[_0x2e9e0e(0x260)][_0x2e9e0e(0x151)](_0x400178);_0x23fcc4[_0x2e9e0e(0xfc)]>0x0&&(_0x4a880a[_0x2e9e0e(0x14b)]=_0x23fcc4);_0x4a880a[_0x2e9e0e(0x103)]=_0x400178[0x0][_0x2e9e0e(0x1a1)](()=>({'wpx':0x64})),XLSX[_0x2e9e0e(0x260)][_0x2e9e0e(0x198)](_0x58a179,_0x4a880a,_0x2e9e0e(0x126));const _0x3f06eb=XLSX[_0x2e9e0e(0x1ff)](_0x58a179,{'bookType':_0x2e9e0e(0x18f),'type':_0x2e9e0e(0x240)});_0x55a00b[_0x2e9e0e(0x163)](_0x2e9e0e(0x1b6),_0x2e9e0e(0x210)),_0x55a00b['setHeader']('Content-Type',_0x2e9e0e(0x1c4)),_0x55a00b[_0x2e9e0e(0x179)](_0x3f06eb);}else pdf[_0x2e9e0e(0x100)](_0x4d25fb,_0x3b24ef)[_0x2e9e0e(0x25d)](function(_0x228a67,_0x33c92d){const _0x490248=_0x2e9e0e;if(_0x228a67){_0x55a00b[_0x490248(0x1f8)](0x1f4)[_0x490248(0x179)](_0x490248(0xff));return;}_0x55a00b['setHeader']('Content-Type',_0x490248(0x144)),_0x33c92d[_0x490248(0x1fb)](_0x55a00b);});}),router[a0_0x441f86(0x167)]('/agent_reports/view',auth,async(_0x27f9b1,_0x511589)=>{const _0x50c848=a0_0x441f86;try{const {username:_0x1ec70f,email:_0x55fbf4,role:_0x200c03}=_0x27f9b1[_0x50c848(0x275)],_0x2ee9ea=_0x27f9b1[_0x50c848(0x275)],_0x44b1e1=await profile[_0x50c848(0x14f)]({'email':_0x2ee9ea[_0x50c848(0x1d0)]}),_0x110942={'year':_0x50c848(0x232),'month':_0x50c848(0x1e5),'day':_0x50c848(0x232)},_0x2cbf34=await master_shop[_0x50c848(0x234)](),_0x33b801=await staff[_0x50c848(0x14f)]({'email':_0x2ee9ea['email']}),_0x157dad=await product[_0x50c848(0x234)](),_0x4968fe=await warehouse['aggregate']([{'$unwind':_0x50c848(0x124)},{'$lookup':{'from':'products','localField':_0x50c848(0x1f3),'foreignField':_0x50c848(0x152),'as':_0x50c848(0x209)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x50c848(0x120),'product_stock':_0x50c848(0x1dc)}},{'$group':{'_id':_0x50c848(0x215),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x2cbf34[0x0][_0x50c848(0x227)]==_0x50c848(0x208))var _0x3a870d=users[_0x50c848(0x11e)];else{if(_0x2cbf34[0x0]['language']==_0x50c848(0x168))var _0x3a870d=users[_0x50c848(0x168)];else{if(_0x2cbf34[0x0][_0x50c848(0x227)]==_0x50c848(0x177))var _0x3a870d=users[_0x50c848(0x177)];else{if(_0x2cbf34[0x0][_0x50c848(0x227)]==_0x50c848(0x1ca))var _0x3a870d=users[_0x50c848(0x1ca)];else{if(_0x2cbf34[0x0][_0x50c848(0x227)]=='French')var _0x3a870d=users['French'];else{if(_0x2cbf34[0x0][_0x50c848(0x227)]=='Portuguese\x20(BR)')var _0x3a870d=users[_0x50c848(0x201)];else{if(_0x2cbf34[0x0][_0x50c848(0x227)]==_0x50c848(0x16d))var _0x3a870d=users[_0x50c848(0x16d)];else{if(_0x2cbf34[0x0]['language']=='Arabic\x20(ae)')var _0x3a870d=users[_0x50c848(0x21c)];}}}}}}}_0x511589[_0x50c848(0x11d)](_0x50c848(0x1f5),{'success':_0x27f9b1[_0x50c848(0x1a7)](_0x50c848(0x133)),'errors':_0x27f9b1[_0x50c848(0x1a7)]('errors'),'alldata':_0x157dad,'profile':_0x44b1e1,'master_shop':_0x2cbf34,'role':_0x2ee9ea,'product_stock':_0x4968fe,'language':_0x3a870d,'staff_arr':_0x33b801});}catch(_0x7e497e){}});function a0_0x5cb3(_0xf36396,_0x502c27){const _0x29ecf6=a0_0x29ec();return a0_0x5cb3=function(_0x5cb3b9,_0x3ca80c){_0x5cb3b9=_0x5cb3b9-0xf2;let _0x4b4147=_0x29ecf6[_0x5cb3b9];return _0x4b4147;},a0_0x5cb3(_0xf36396,_0x502c27);}function formatNumber(_0xdeb989,_0x377040=a0_0x441f86(0x130),_0x2c9644={'minimumFractionDigits':0x2}){const _0x3cda5c=a0_0x441f86,_0x25d283=new Intl[(_0x3cda5c(0x265))](_0x377040,_0x2c9644);return _0x25d283[_0x3cda5c(0x245)](_0xdeb989);}async function agentsdataDSICheck(_0x260e21,_0x45229f,_0xd3efcf,_0x4a9fb5){const _0x3b291c=a0_0x441f86,_0x517721=await product[_0x3b291c(0x27c)]([{'$group':{'_id':{'brand':_0x3b291c(0x221),'category':_0x3b291c(0x216)},'products':{'$push':{'name':_0x3b291c(0x1e6),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x386e17=[];_0x386e17[_0x3b291c(0x261)]=[];for(let _0x43fdd5=0x0;_0x43fdd5<=_0x517721[_0x3b291c(0xfc)]-0x1;_0x43fdd5++){const _0x5fb279=_0x517721[_0x43fdd5];_0x386e17['cat_brand']['push'](_0x5fb279);}const _0xb50737=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x3b291c(0x221),'product_code':_0x3b291c(0x243),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x6a06a0=await product[_0x3b291c(0x27c)]([{'$group':{'_id':{'category':_0x3b291c(0x216),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x12ade5=await sales_sa[_0x3b291c(0x27c)]([{'$match':{'date':{'$gte':_0x260e21,'$lte':_0x45229f},'sales_staff_id':_0xd3efcf,'sale_product.isFG':'false'}},{'$unwind':_0x3b291c(0x22c)},{'$match':{'sale_product.isFG':_0x3b291c(0x1ee)}},{'$lookup':{'from':_0x3b291c(0x156),'localField':_0x3b291c(0x25b),'foreignField':'product_code','as':_0x3b291c(0x17f)}},{'$unwind':_0x3b291c(0xf2)},{'$group':{'_id':{'dsi':'$dsi','date':_0x3b291c(0x143),'customer':_0x3b291c(0x173)},'totalQty':{'$sum':_0x3b291c(0x1c2)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x3b291c(0x1ce),'product_code':_0x3b291c(0x269),'category':'$product_info.category','brand':_0x3b291c(0x19e),'gross_price':_0x3b291c(0x24b)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x3b291c(0x1d8),'customer':_0x3b291c(0x154),'category':'$products.product_details.category','brand':_0x3b291c(0x26e)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x3b291c(0x272),_0x3b291c(0x21a)]}},'NetPrice':{'$sum':_0x3b291c(0x19c)},'discount':{'$sum':_0x3b291c(0x253)},'adj_discount':{'$sum':_0x3b291c(0xf5)},'product_details':{'$first':_0x3b291c(0x149)}}},{'$group':{'_id':{'dsi':_0x3b291c(0x205),'date':_0x3b291c(0x1d8),'customer':_0x3b291c(0x154)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x3b291c(0x1f9)},'NetPrice':{'$sum':_0x3b291c(0x20e)},'discount':{'$sum':_0x3b291c(0x196)},'adj_discount':{'$sum':_0x3b291c(0x181)},'products':{'$push':{'qty':'$totalQty','category':_0x3b291c(0xf8),'brand':_0x3b291c(0x186),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2f84ee=[],_0x209aaa={},_0xee71f0={},_0x47cd10={};var _0x538a09=0x0,_0x17624a=0x0,_0xf8ec31=0x0,_0x161eca=0x0,_0x38c78e=0x0;const _0x583eec=0x6;for(let _0x4aaec6=0x0;_0x4aaec6<=_0x12ade5['length']-0x1;_0x4aaec6++){const _0x4ceb3e=_0x12ade5[_0x4aaec6];let _0x3c78e7=_0x3b291c(0x17a);_0x3c78e7+=_0x3b291c(0x10c)+_0x4ceb3e['_id'][_0x3b291c(0x1ab)]+'</td>',_0x3c78e7+=_0x3b291c(0x10c)+_0x4ceb3e[_0x3b291c(0x11a)][_0x3b291c(0x214)]+_0x3b291c(0x199),_0x3c78e7+=_0x3b291c(0x10c)+_0x4ceb3e['_id'][_0x3b291c(0x106)]+'</td>';let _0x446315={};var _0xda2fac=0x0;for(let _0x41d740=0x0;_0x41d740<=_0x4ceb3e[_0x3b291c(0x156)][_0x3b291c(0xfc)]-0x1;_0x41d740++){const _0xf40e25=_0x4ceb3e['products'][_0x41d740];_0x446315[_0xf40e25['brand']+'-'+_0xf40e25[_0x3b291c(0x11f)]]=_0xf40e25[_0x3b291c(0x110)];const _0x49bb25=_0xf40e25[_0x3b291c(0x20a)]+'-'+_0xf40e25['category'];!_0x209aaa[_0x49bb25]&&(_0x209aaa[_0x49bb25]=0x0),!Array[_0x3b291c(0x166)](_0x47cd10[_0x49bb25])&&(_0x47cd10[_0x49bb25]=[]),!Array[_0x3b291c(0x166)](_0x47cd10[_0x49bb25])&&(_0x47cd10[_0x49bb25]=[]),_0x209aaa[_0x49bb25]+=_0xf40e25['qty'],_0x47cd10[_0x49bb25][_0x3b291c(0x206)](_0xf40e25[_0x3b291c(0x110)]),_0xda2fac++;}console['log'](_0x4ceb3e);for(let _0x7b97e1=0x0;_0x7b97e1<=_0x386e17[_0x3b291c(0x261)][_0x3b291c(0xfc)]-0x1;_0x7b97e1++){const _0x403708=_0x386e17[_0x3b291c(0x261)][_0x7b97e1],_0x24dc13=_0x403708[_0x3b291c(0x11a)][_0x3b291c(0x20a)]+'-'+_0x403708[_0x3b291c(0x11a)]['category'];_0x3c78e7+=_0x3b291c(0x27e)+(_0x446315[_0x24dc13]!==undefined?_0x446315[_0x24dc13][_0x3b291c(0x18e)](0x2):'')+_0x3b291c(0x199);}_0xf8ec31=_0x4ceb3e[_0x3b291c(0x15a)]+_0x4ceb3e[_0x3b291c(0x1b0)],_0x3c78e7+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x4ceb3e[_0x3b291c(0x259)],0x2)[_0x3b291c(0x18e)](0x2))+_0x3b291c(0x199),_0x3c78e7+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x4ceb3e[_0x3b291c(0x15c)][_0x3b291c(0x18e)](0x2))+_0x3b291c(0x199),_0x3c78e7+=_0x3b291c(0x129)+formatNumber(_0xf8ec31)+_0x3b291c(0x199),_0x3c78e7+=_0x3b291c(0x129)+formatNumber(_0x4ceb3e['NetPrice'][_0x3b291c(0x18e)](0x2))+'</td>',_0x3c78e7+=_0x3b291c(0x1be),_0x538a09+=parseFloat(_0x4ceb3e[_0x3b291c(0x259)][_0x3b291c(0x18e)](0x2)),_0x17624a+=parseFloat(_0x4ceb3e[_0x3b291c(0x241)][_0x3b291c(0x18e)](0x2)),_0x161eca+=_0xf8ec31,_0x38c78e+=parseFloat(_0x4ceb3e[_0x3b291c(0x15c)][_0x3b291c(0x18e)](0x2));if(_0x4aaec6==_0x12ade5['length']-0x1){_0x3c78e7+=_0x3b291c(0x17a),_0x3c78e7+=_0x3b291c(0x17e),_0x3c78e7+=_0x3b291c(0x199);for(let _0x2d7542=0x0;_0x2d7542<=_0x386e17[_0x3b291c(0x261)][_0x3b291c(0xfc)]-0x1;_0x2d7542++){const _0x553635=_0x386e17[_0x3b291c(0x261)][_0x2d7542],_0x5d8b41=_0x553635[_0x3b291c(0x11a)][_0x3b291c(0x20a)]+'-'+_0x553635[_0x3b291c(0x11a)]['category'],_0x293093=_0x47cd10[_0x5d8b41][_0x3b291c(0x105)]((_0x456636,_0x278489)=>_0x456636+_0x278489,0x0);_0x3c78e7+=_0x3b291c(0x15d)+(_0x293093!==undefined?formatNumber(_0x293093['toFixed'](0x2)):'')+_0x3b291c(0x223),console[_0x3b291c(0x1e4)](_0x47cd10[_0x5d8b41]['reduce']((_0x5370ef,_0x1a4812)=>_0x5370ef+_0x1a4812,0x0));}_0x3c78e7+=_0x3b291c(0x10b)+formatNumber(_0x538a09['toFixed'](0x2))+_0x3b291c(0x223),_0x3c78e7+=_0x3b291c(0x10b)+formatNumber(_0x38c78e)+_0x3b291c(0x223),_0x3c78e7+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x161eca)+_0x3b291c(0x223),_0x3c78e7+=_0x3b291c(0x10b)+formatNumber(_0x17624a)+_0x3b291c(0x223),_0x3c78e7+=_0x3b291c(0x1be);}_0x2f84ee['push'](_0x3c78e7);}function _0x137e93(_0x568af3,_0x47f132){const _0x122062=_0x3b291c,_0x3784a4=[];for(let _0x101088=0x0;_0x101088<=_0x568af3[_0x122062(0xfc)]-0x1;_0x101088+=_0x47f132){_0x3784a4[_0x122062(0x206)](_0x568af3[_0x122062(0x1c5)](_0x101088,_0x101088+_0x47f132));}return _0x3784a4;}const _0x2e26b6=_0x137e93(_0x2f84ee,_0x583eec);let _0x1609df='';return _0x2e26b6[_0x3b291c(0x268)]((_0x5e1b68,_0xecdec)=>{const _0x430018=_0x3b291c;_0xecdec>0x0&&(_0x1609df+=_0x430018(0x1ed));_0x1609df+='<table>',_0x1609df+=_0x430018(0x23b),_0x1609df+=_0x430018(0x17a),_0x1609df+=_0x430018(0x17b),_0x1609df+=_0x430018(0x1be),_0x1609df+=_0x430018(0x17a),_0x1609df+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x27fc37=0x0;_0x27fc37<=_0xb50737['length']-0x1;_0x27fc37++){const _0x2e79db=_0xb50737[_0x27fc37];for(let _0x4dbb6b=0x0;_0x4dbb6b<_0x6a06a0['length'];_0x4dbb6b++){const _0x5ce2da=_0x6a06a0[_0x4dbb6b];_0x5ce2da['_id']===_0x2e79db[_0x430018(0x11a)][_0x430018(0x11f)]&&(_0x1609df+=_0x430018(0x257)+_0x5ce2da['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x2e79db['_id'][_0x430018(0x11f)]+_0x430018(0x199));}}_0x1609df+=_0x430018(0x101),_0x1609df+=_0x430018(0x1be),_0x1609df+=_0x430018(0x17a),_0x1609df+=_0x430018(0x192),_0x1609df+=_0x430018(0x246),_0x1609df+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x7ae1d3=0x0;_0x7ae1d3<=_0xb50737[_0x430018(0xfc)]-0x1;_0x7ae1d3++){const _0x5e4ff6=_0xb50737[_0x7ae1d3];for(let _0x107a3a=0x0;_0x107a3a<_0x386e17[_0x430018(0x261)][_0x430018(0xfc)];_0x107a3a++){const _0x15e9d9=_0x386e17[_0x430018(0x261)][_0x107a3a];_0x15e9d9['_id']['category']===_0x5e4ff6['_id'][_0x430018(0x11f)]&&(_0x1609df+='<td\x20class=\x22cat_data\x22>'+_0x15e9d9[_0x430018(0x11a)]['brand']+_0x430018(0x199));}}_0x1609df+=_0x430018(0x19a),_0x1609df+=_0x430018(0x191),_0x1609df+=_0x430018(0x1ad),_0x1609df+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x1609df+=_0x430018(0x1be),_0x1609df+=_0x430018(0x244),_0x1609df+=_0x430018(0x278),_0x5e1b68[_0x430018(0x268)](_0x3972b0=>{_0x1609df+=_0x3972b0;}),console['log'](_0x47cd10),_0x1609df+=_0x430018(0x236),_0x1609df+=_0x430018(0x23d);}),_0x1609df;}async function agentsdataDSICheck_excel(_0x3b5c37,_0x2b5a61,_0x13da1e,_0x43a376){const _0x2a01c8=a0_0x441f86,_0x10dc92=await product[_0x2a01c8(0x27c)]([{'$group':{'_id':{'brand':_0x2a01c8(0x221),'category':_0x2a01c8(0x216)},'products':{'$push':{'name':_0x2a01c8(0x1e6),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x239bf0=[];_0x239bf0[_0x2a01c8(0x261)]=[];for(let _0xac3d7b=0x0;_0xac3d7b<=_0x10dc92[_0x2a01c8(0xfc)]-0x1;_0xac3d7b++){const _0x21242b=_0x10dc92[_0xac3d7b];_0x239bf0['cat_brand'][_0x2a01c8(0x206)](_0x21242b);}const _0xa3b314=await product[_0x2a01c8(0x27c)]([{'$group':{'_id':{'category':_0x2a01c8(0x216)},'products':{'$push':{'brand':_0x2a01c8(0x221),'product_code':_0x2a01c8(0x243),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x273077=await product[_0x2a01c8(0x27c)]([{'$group':{'_id':{'category':_0x2a01c8(0x216),'brand':_0x2a01c8(0x221)}}},{'$group':{'_id':_0x2a01c8(0xf8),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xe9e02a=await sales_sa[_0x2a01c8(0x27c)]([{'$match':{'date':{'$gte':_0x3b5c37,'$lte':_0x2b5a61},'sales_staff_id':_0x13da1e,'sale_product.isFG':_0x2a01c8(0x1ee)}},{'$unwind':_0x2a01c8(0x22c)},{'$match':{'sale_product.isFG':_0x2a01c8(0x1ee)}},{'$lookup':{'from':'products','localField':_0x2a01c8(0x25b),'foreignField':_0x2a01c8(0x213),'as':_0x2a01c8(0x17f)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x2a01c8(0x121),'date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x2a01c8(0x1c2)},'products':{'$push':{'qty':_0x2a01c8(0x1c2),'NetPrice':_0x2a01c8(0x15f),'discount':_0x2a01c8(0x194),'adj_discount':_0x2a01c8(0x132),'product_details':{'prod_name':_0x2a01c8(0x1ce),'product_code':_0x2a01c8(0x269),'category':_0x2a01c8(0x264),'brand':'$product_info.brand','gross_price':_0x2a01c8(0x24b)}}}}},{'$unwind':_0x2a01c8(0x10d)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x2a01c8(0x1d8),'customer':_0x2a01c8(0x154),'category':_0x2a01c8(0x12c),'brand':_0x2a01c8(0x26e)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x2a01c8(0x21a)]}},'NetPrice':{'$sum':_0x2a01c8(0x19c)},'discount':{'$sum':_0x2a01c8(0x253)},'adj_discount':{'$sum':_0x2a01c8(0xf5)},'product_details':{'$first':_0x2a01c8(0x149)}}},{'$group':{'_id':{'dsi':_0x2a01c8(0x205),'date':'$_id.date','customer':_0x2a01c8(0x154)},'totalQty':{'$sum':_0x2a01c8(0x235)},'totalGross':{'$sum':_0x2a01c8(0x1f9)},'NetPrice':{'$sum':_0x2a01c8(0x20e)},'discount':{'$sum':_0x2a01c8(0x196)},'adj_discount':{'$sum':_0x2a01c8(0x181)},'products':{'$push':{'qty':_0x2a01c8(0x235),'category':'$_id.category','brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x192f35=[],_0x506b01={},_0x36e330={},_0x3e9bcf={};var _0x329df9=0x0,_0xa5cd4b=0x0,_0x407195=0x0,_0x291fde=0x0,_0x3946ab=0x0;const _0x30fb85=0x9184e72a000;for(let _0x23a907=0x0;_0x23a907<=_0xe9e02a[_0x2a01c8(0xfc)]-0x1;_0x23a907++){const _0x33dbab=_0xe9e02a[_0x23a907];let _0x1068fb=_0x2a01c8(0x17a);_0x1068fb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x33dbab['_id'][_0x2a01c8(0x1ab)]+'</td>',_0x1068fb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x33dbab[_0x2a01c8(0x11a)][_0x2a01c8(0x214)]+_0x2a01c8(0x199),_0x1068fb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x33dbab['_id'][_0x2a01c8(0x106)]+'</td>';let _0xb7c3d1={};var _0x528c74=0x0;for(let _0x47be76=0x0;_0x47be76<=_0x33dbab['products'][_0x2a01c8(0xfc)]-0x1;_0x47be76++){const _0x4ab7c0=_0x33dbab[_0x2a01c8(0x156)][_0x47be76];_0xb7c3d1[_0x4ab7c0[_0x2a01c8(0x20a)]+'-'+_0x4ab7c0['category']]=_0x4ab7c0['qty'];const _0x5d5ea4=_0x4ab7c0['brand']+'-'+_0x4ab7c0[_0x2a01c8(0x11f)];!_0x506b01[_0x5d5ea4]&&(_0x506b01[_0x5d5ea4]=0x0),!Array[_0x2a01c8(0x166)](_0x3e9bcf[_0x5d5ea4])&&(_0x3e9bcf[_0x5d5ea4]=[]),!Array['isArray'](_0x3e9bcf[_0x5d5ea4])&&(_0x3e9bcf[_0x5d5ea4]=[]),_0x506b01[_0x5d5ea4]+=_0x4ab7c0[_0x2a01c8(0x110)],_0x3e9bcf[_0x5d5ea4]['push'](_0x4ab7c0[_0x2a01c8(0x110)]),_0x528c74++;}console[_0x2a01c8(0x1e4)](_0x33dbab);for(let _0x5a6778=0x0;_0x5a6778<=_0x239bf0[_0x2a01c8(0x261)]['length']-0x1;_0x5a6778++){const _0x5afccc=_0x239bf0[_0x2a01c8(0x261)][_0x5a6778],_0x6952a0=_0x5afccc[_0x2a01c8(0x11a)][_0x2a01c8(0x20a)]+'-'+_0x5afccc[_0x2a01c8(0x11a)][_0x2a01c8(0x11f)];_0x1068fb+=_0x2a01c8(0x27e)+(_0xb7c3d1[_0x6952a0]!==undefined?_0xb7c3d1[_0x6952a0][_0x2a01c8(0x18e)](0x2):'')+'</td>';}_0x407195=_0x33dbab['discount']+_0x33dbab[_0x2a01c8(0x1b0)],_0x1068fb+=_0x2a01c8(0x129)+formatNumber(parseFloat(_0x33dbab[_0x2a01c8(0x259)],0x2)[_0x2a01c8(0x18e)](0x2))+'</td>',_0x1068fb+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x33dbab[_0x2a01c8(0x15c)]['toFixed'](0x2))+_0x2a01c8(0x199),_0x1068fb+=_0x2a01c8(0x129)+formatNumber(_0x407195)+_0x2a01c8(0x199),_0x1068fb+=_0x2a01c8(0x129)+formatNumber(_0x33dbab['NetPrice'][_0x2a01c8(0x18e)](0x2))+_0x2a01c8(0x199),_0x1068fb+=_0x2a01c8(0x1be),_0x329df9+=parseFloat(_0x33dbab['totalQty']['toFixed'](0x2)),_0xa5cd4b+=parseFloat(_0x33dbab[_0x2a01c8(0x241)][_0x2a01c8(0x18e)](0x2)),_0x291fde+=_0x407195,_0x3946ab+=parseFloat(_0x33dbab[_0x2a01c8(0x15c)][_0x2a01c8(0x18e)](0x2));if(_0x23a907==_0xe9e02a[_0x2a01c8(0xfc)]-0x1){_0x1068fb+=_0x2a01c8(0x17a),_0x1068fb+=_0x2a01c8(0x17e),_0x1068fb+=_0x2a01c8(0x199);for(let _0x59ac50=0x0;_0x59ac50<=_0x239bf0[_0x2a01c8(0x261)][_0x2a01c8(0xfc)]-0x1;_0x59ac50++){const _0x4816a0=_0x239bf0[_0x2a01c8(0x261)][_0x59ac50],_0x21475a=_0x4816a0[_0x2a01c8(0x11a)][_0x2a01c8(0x20a)]+'-'+_0x4816a0[_0x2a01c8(0x11a)][_0x2a01c8(0x11f)],_0xf5aa47=_0x3e9bcf[_0x21475a]['reduce']((_0x122084,_0x59a890)=>_0x122084+_0x59a890,0x0);_0x1068fb+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0xf5aa47!==undefined?formatNumber(_0xf5aa47[_0x2a01c8(0x18e)](0x2)):'')+'</b></td>',console[_0x2a01c8(0x1e4)](_0x3e9bcf[_0x21475a][_0x2a01c8(0x105)]((_0x2f8fd7,_0x4c61e9)=>_0x2f8fd7+_0x4c61e9,0x0));}_0x1068fb+=_0x2a01c8(0x10b)+formatNumber(_0x329df9[_0x2a01c8(0x18e)](0x2))+'</b></td>',_0x1068fb+=_0x2a01c8(0x10b)+formatNumber(_0x3946ab)+'</b></td>',_0x1068fb+=_0x2a01c8(0x10b)+formatNumber(_0x291fde)+_0x2a01c8(0x223),_0x1068fb+=_0x2a01c8(0x10b)+formatNumber(_0xa5cd4b)+'</b></td>',_0x1068fb+='</tr>';}_0x192f35['push'](_0x1068fb);}function _0x3690b8(_0x4989ce,_0x56ae1d){const _0x51f939=_0x2a01c8,_0x2b82f0=[];for(let _0x49559c=0x0;_0x49559c<=_0x4989ce[_0x51f939(0xfc)]-0x1;_0x49559c+=_0x56ae1d){_0x2b82f0[_0x51f939(0x206)](_0x4989ce[_0x51f939(0x1c5)](_0x49559c,_0x49559c+_0x56ae1d));}return _0x2b82f0;}const _0x5c6d57=_0x3690b8(_0x192f35,_0x30fb85);let _0x7eafa6='';return _0x5c6d57[_0x2a01c8(0x268)]((_0x24e8b7,_0x56cd54)=>{const _0x2c06f5=_0x2a01c8;_0x56cd54>0x0&&(_0x7eafa6+=_0x2c06f5(0x1ed));_0x7eafa6+=_0x2c06f5(0x138),_0x7eafa6+=_0x2c06f5(0x23b),_0x7eafa6+=_0x2c06f5(0x17a),_0x7eafa6+=_0x2c06f5(0x17b),_0x7eafa6+='</tr>',_0x7eafa6+=_0x2c06f5(0x17a),_0x7eafa6+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x581a23=0x0;_0x581a23<=_0xa3b314['length']-0x1;_0x581a23++){const _0x2518f3=_0xa3b314[_0x581a23];for(let _0x195bb7=0x0;_0x195bb7<_0x273077['length'];_0x195bb7++){const _0x9b2fba=_0x273077[_0x195bb7];_0x9b2fba['_id']===_0x2518f3[_0x2c06f5(0x11a)][_0x2c06f5(0x11f)]&&(_0x7eafa6+='<td\x20colspan=\x22'+_0x9b2fba[_0x2c06f5(0x1eb)]+_0x2c06f5(0x1a9)+_0x2518f3[_0x2c06f5(0x11a)]['category']+_0x2c06f5(0x199));}}_0x7eafa6+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x7eafa6+=_0x2c06f5(0x1be),_0x7eafa6+='<tr>',_0x7eafa6+=_0x2c06f5(0x192),_0x7eafa6+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x7eafa6+=_0x2c06f5(0x19b);for(let _0x16607d=0x0;_0x16607d<=_0xa3b314[_0x2c06f5(0xfc)]-0x1;_0x16607d++){const _0x1e6280=_0xa3b314[_0x16607d];for(let _0xff3d=0x0;_0xff3d<_0x239bf0[_0x2c06f5(0x261)][_0x2c06f5(0xfc)];_0xff3d++){const _0x34c584=_0x239bf0[_0x2c06f5(0x261)][_0xff3d];_0x34c584[_0x2c06f5(0x11a)][_0x2c06f5(0x11f)]===_0x1e6280[_0x2c06f5(0x11a)][_0x2c06f5(0x11f)]&&(_0x7eafa6+='<td\x20class=\x22cat_data\x22>'+_0x34c584['_id']['brand']+_0x2c06f5(0x199));}}_0x7eafa6+=_0x2c06f5(0x19a),_0x7eafa6+=_0x2c06f5(0x191),_0x7eafa6+=_0x2c06f5(0x1ad),_0x7eafa6+=_0x2c06f5(0x11b),_0x7eafa6+=_0x2c06f5(0x1be),_0x7eafa6+='</thead>',_0x7eafa6+=_0x2c06f5(0x278),_0x24e8b7['forEach'](_0x249464=>{_0x7eafa6+=_0x249464;}),console[_0x2c06f5(0x1e4)](_0x3e9bcf),_0x7eafa6+='</tbody>',_0x7eafa6+=_0x2c06f5(0x23d);}),_0x7eafa6;}router[a0_0x441f86(0x1ea)](a0_0x441f86(0x12a),auth,async(_0x1eecf1,_0x37ff92)=>{const _0x3c3876=a0_0x441f86,{from_date:_0x215f64,to_date:_0x1be867,isExcel:_0xe030d2}=_0x1eecf1[_0x3c3876(0x184)],_0xea6895=_0x1eecf1['user'],_0x58c013=await staff[_0x3c3876(0x14f)]({'email':_0xea6895[_0x3c3876(0x1d0)]}),_0xf6fd50=await master_shop['find']();console['log'](_0xf6fd50[0x0]['image']);const _0x10afa8=await agentsdataDSICheck(_0x215f64,_0x1be867,_0x58c013[_0x3c3876(0x11a)]['valueOf'](),_0xe030d2),_0x1e2216=await agentsdataDSICheck_excel(_0x215f64,_0x1be867,_0x58c013[_0x3c3876(0x11a)][_0x3c3876(0x204)](),_0xe030d2);let _0x5b794b='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x3ddec=new Date(_0x215f64),_0x1f9211=new Date(_0x1be867);const _0x3eafad={'year':_0x3c3876(0x232),'month':_0x3c3876(0x1e5),'day':_0x3c3876(0x232)},_0x52728a=new Intl[(_0x3c3876(0x113))]('en-US',_0x3eafad)[_0x3c3876(0x245)](_0x3ddec),_0x59bfff=new Intl[(_0x3c3876(0x113))](_0x3c3876(0x130),_0x3eafad)['format'](_0x1f9211);_0x5b794b+=_0x3c3876(0x247),_0x5b794b+=_0x3c3876(0x1a6),_0x5b794b+=_0x3c3876(0x138),_0x5b794b+=_0x10afa8,_0x5b794b+=_0x3c3876(0x23d),_0x5b794b+=_0x3c3876(0x112),_0x5b794b+='</div>';let _0x9d74e1=_0x3c3876(0x1b5);_0x9d74e1+=_0x3c3876(0x247),_0x9d74e1+='<div\x20\x20id=\x22table-conatainer\x22>',_0x9d74e1+=_0x3c3876(0x138),_0x9d74e1+=_0x1e2216,_0x9d74e1+=_0x3c3876(0x23d),_0x9d74e1+=_0x3c3876(0x112),_0x9d74e1+='</div>';let _0x52871e=_0x3c3876(0x18c);const _0x1ec2f3={'width':'15in','height':_0x3c3876(0x22e),'orientation':_0x3c3876(0x211),'border':{'top':_0x3c3876(0x147),'right':'0.1in','bottom':_0x3c3876(0x147),'left':_0x3c3876(0x147)},'header':{'height':_0x3c3876(0x1fc),'contents':_0x3c3876(0x203)+_0x52871e+_0x3c3876(0x230)+_0x52728a+_0x3c3876(0x267)+_0x59bfff+_0x3c3876(0x21b)},'footer':{'height':'20mm','contents':{'default':_0x3c3876(0x193)}},'dpi':0x5,'zoomFactor':'1'};if(_0xe030d2=='on'){const _0x4e6ac1=cheerio[_0x3c3876(0x17c)](_0x9d74e1);let _0x356210=[],_0x502849=[],_0x3037ce=[];const _0x31387e=_0x55bb93=>{const _0x490d5d=_0x3c3876,_0x21114a={'top':{'style':'thick','color':{'rgb':_0x490d5d(0x226)}},'bottom':{'style':_0x490d5d(0xf6),'color':{'rgb':_0x490d5d(0x226)}},'left':{'style':_0x490d5d(0xf6),'color':{'rgb':_0x490d5d(0x226)}},'right':{'style':_0x490d5d(0xf6),'color':{'rgb':_0x490d5d(0x226)}}};if(_0x55bb93){const _0x156251=_0x55bb93[_0x490d5d(0x1a3)](';')[_0x490d5d(0x105)]((_0x3cae01,_0x965d1f)=>{const _0x4fbc12=_0x490d5d,[_0x11858e,_0x5d20b2]=_0x965d1f[_0x4fbc12(0x1a3)](':')[_0x4fbc12(0x1a1)](_0x41715d=>_0x41715d[_0x4fbc12(0x1ba)]());return _0x3cae01[_0x11858e]=_0x5d20b2,_0x3cae01;},{});_0x156251[_0x490d5d(0x137)]&&(_0x21114a[_0x490d5d(0x1e9)][_0x490d5d(0x1a8)]=_0x156251['border-top']['includes'](_0x490d5d(0x176))?_0x490d5d(0x176):_0x490d5d(0x1e3)),_0x156251[_0x490d5d(0x188)]&&(_0x21114a[_0x490d5d(0x10f)]['style']=_0x156251['border-bottom'][_0x490d5d(0x160)]('thin')?_0x490d5d(0x176):_0x490d5d(0x1e3)),_0x156251[_0x490d5d(0x122)]&&(_0x21114a['left'][_0x490d5d(0x1a8)]=_0x156251[_0x490d5d(0x122)][_0x490d5d(0x160)]('thin')?_0x490d5d(0x176):_0x490d5d(0x1e3)),_0x156251[_0x490d5d(0x27d)]&&(_0x21114a[_0x490d5d(0x1cc)][_0x490d5d(0x1a8)]=_0x156251[_0x490d5d(0x27d)]['includes']('thin')?_0x490d5d(0x176):_0x490d5d(0x1e3));}return _0x21114a;};_0x4e6ac1(_0x3c3876(0x148))[_0x3c3876(0x1b8)]((_0xcb4ca9,_0x6ce004)=>{const _0x27f2a7=_0x3c3876;let _0x4a8edc=[],_0x3c3622=0x0;while(_0x3037ce[_0x3c3622]){_0x3037ce[_0x3c3622]--,_0x3c3622++;}_0x4e6ac1(_0x6ce004)[_0x27f2a7(0x234)](_0x27f2a7(0x10a))['each']((_0x4cbe53,_0x3086fd)=>{const _0xeb84fb=_0x27f2a7;let _0x48cf22=_0x4e6ac1(_0x3086fd)[_0xeb84fb(0x225)]()[_0xeb84fb(0x1ba)](),_0x3766be=parseFloat(_0x48cf22[_0xeb84fb(0x1e8)](/,/g,'')),_0x564d9e={};!isNaN(_0x3766be)?(_0x564d9e['v']=_0x3766be,_0x564d9e['t']='n'):(_0x564d9e['v']=_0x48cf22,_0x564d9e['t']='s');const _0x29a6bb=_0x4e6ac1(_0x3086fd)[_0xeb84fb(0x187)](_0xeb84fb(0x1a8)),_0x41d7d6=_0x31387e(_0x29a6bb);_0x564d9e['s']={'border':_0x41d7d6},_0x4a8edc[_0x3c3622]=_0x564d9e;let _0x1f6b03=parseInt(_0x4e6ac1(_0x3086fd)[_0xeb84fb(0x187)](_0xeb84fb(0x150)))||0x1,_0x1568c1=parseInt(_0x4e6ac1(_0x3086fd)[_0xeb84fb(0x187)](_0xeb84fb(0x189)))||0x1;(_0x1f6b03>0x1||_0x1568c1>0x1)&&_0x502849['push']({'s':{'r':_0xcb4ca9,'c':_0x3c3622},'e':{'r':_0xcb4ca9+_0x1568c1-0x1,'c':_0x3c3622+_0x1f6b03-0x1}});for(let _0x44f317=0x0;_0x44f317<_0x1f6b03;_0x44f317++){_0x1568c1>0x1&&(_0x3037ce[_0x3c3622+_0x44f317]=_0x1568c1-0x1);}_0x3c3622+=_0x1f6b03;}),_0x356210[_0x27f2a7(0x206)](_0x4a8edc);});const _0x57c456=XLSX['utils'][_0x3c3876(0x119)](),_0x2b4912=XLSX['utils'][_0x3c3876(0x151)](_0x356210);_0x502849[_0x3c3876(0xfc)]>0x0&&(_0x2b4912[_0x3c3876(0x14b)]=_0x502849);_0x2b4912['!cols']=_0x356210[0x0][_0x3c3876(0x1a1)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x57c456,_0x2b4912,_0x3c3876(0x126));const _0x566c0b=XLSX['write'](_0x57c456,{'bookType':_0x3c3876(0x18f),'type':'buffer'});_0x37ff92[_0x3c3876(0x163)](_0x3c3876(0x1b6),_0x3c3876(0x210)),_0x37ff92['setHeader'](_0x3c3876(0x115),_0x3c3876(0x1c4)),_0x37ff92[_0x3c3876(0x179)](_0x566c0b);}else pdf['create'](_0x5b794b,_0x1ec2f3)[_0x3c3876(0x25d)](function(_0x5f0320,_0x39e037){const _0x3718ca=_0x3c3876;if(_0x5f0320){_0x37ff92[_0x3718ca(0x1f8)](0x1f4)[_0x3718ca(0x179)](_0x3718ca(0xff));return;}_0x37ff92[_0x3718ca(0x163)]('Content-Type',_0x3718ca(0x144)),_0x39e037[_0x3718ca(0x1fb)](_0x37ff92);});}),router['get'](a0_0x441f86(0x220),auth,async(_0x4f5d64,_0x588d0f)=>{const _0x3a1816=a0_0x441f86;try{const {username:_0x26f90b,email:_0x1a5275,role:_0x28e99f}=_0x4f5d64[_0x3a1816(0x275)],_0x182144=_0x4f5d64[_0x3a1816(0x275)],_0x2873ef=await profile[_0x3a1816(0x14f)]({'email':_0x182144[_0x3a1816(0x1d0)]}),_0x1012eb={'year':_0x3a1816(0x232),'month':_0x3a1816(0x1e5),'day':'numeric'},_0x12aa3d=await master_shop[_0x3a1816(0x234)](),_0x5f2040=await product[_0x3a1816(0x234)](),_0x5d11df=await warehouse[_0x3a1816(0x27c)]([{'$unwind':_0x3a1816(0x124)},{'$lookup':{'from':'products','localField':_0x3a1816(0x1f3),'foreignField':'name','as':_0x3a1816(0x209)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x3a1816(0x120),'product_stock':_0x3a1816(0x1dc)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x3a1816(0x1fe)}}}]),_0x2fd407=await staff[_0x3a1816(0x14f)]({'email':_0x182144[_0x3a1816(0x1d0)]});if(_0x12aa3d[0x0][_0x3a1816(0x227)]=='English\x20(US)')var _0x391e87=users[_0x3a1816(0x11e)];else{if(_0x12aa3d[0x0][_0x3a1816(0x227)]==_0x3a1816(0x168))var _0x391e87=users[_0x3a1816(0x168)];else{if(_0x12aa3d[0x0][_0x3a1816(0x227)]=='German')var _0x391e87=users[_0x3a1816(0x177)];else{if(_0x12aa3d[0x0][_0x3a1816(0x227)]==_0x3a1816(0x1ca))var _0x391e87=users[_0x3a1816(0x1ca)];else{if(_0x12aa3d[0x0]['language']==_0x3a1816(0x1d3))var _0x391e87=users['French'];else{if(_0x12aa3d[0x0][_0x3a1816(0x227)]==_0x3a1816(0x183))var _0x391e87=users[_0x3a1816(0x201)];else{if(_0x12aa3d[0x0][_0x3a1816(0x227)]==_0x3a1816(0x16d))var _0x391e87=users[_0x3a1816(0x16d)];else{if(_0x12aa3d[0x0]['language']==_0x3a1816(0x15e))var _0x391e87=users['Arabic'];}}}}}}}_0x588d0f[_0x3a1816(0x11d)](_0x3a1816(0x273),{'success':_0x4f5d64[_0x3a1816(0x1a7)](_0x3a1816(0x133)),'errors':_0x4f5d64['flash'](_0x3a1816(0x1e7)),'alldata':_0x5f2040,'profile':_0x2873ef,'master_shop':_0x12aa3d,'role':_0x182144,'product_stock':_0x5d11df,'language':_0x391e87,'staff_arr':_0x2fd407});}catch(_0x439ce4){}});async function dataSalesReports(_0x57305b,_0x4b7638,_0x4f1d74){const _0x4a2666=a0_0x441f86;let _0x142ef8='';const _0x15f217=await sales_sa[_0x4a2666(0x27c)]([{'$match':{'date':{'$gte':_0x57305b,'$lte':_0x4b7638},'sales_staff_id':_0x4f1d74}},{'$unwind':_0x4a2666(0x22c)},{'$match':{'sale_product.isFG':'false'}},{'$group':{'_id':{'product_name':_0x4a2666(0x1b4),'product_code':_0x4a2666(0x1f2)},'sumqty':{'$sum':_0x4a2666(0x1c2)},'totalPrice':{'$sum':_0x4a2666(0x15f)}}},{'$sort':{'_id.product_name':0x1}}]);var _0xfc30d3=0x0,_0x4e0261=0x0;for(let _0x14ec24=0x0;_0x14ec24<=_0x15f217[_0x4a2666(0xfc)]-0x1;_0x14ec24++){const _0x476c92=_0x15f217[_0x14ec24];var _0x2bd826=_0x476c92[_0x4a2666(0x24f)][_0x4a2666(0x1f7)](undefined),_0x2f780d=_0x476c92[_0x4a2666(0x1ec)][_0x4a2666(0x1f7)](undefined);_0x142ef8+='<tr>',_0x142ef8+=_0x4a2666(0xf4)+_0x476c92['_id'][_0x4a2666(0x213)]+'</td>',_0x142ef8+='<td\x20class=\x22row_data\x22>'+_0x476c92['_id'][_0x4a2666(0x20d)]+_0x4a2666(0x199),_0x142ef8+=_0x4a2666(0xf4)+formatNumber(_0x476c92[_0x4a2666(0x1ec)][_0x4a2666(0x18e)](0x2))+'</td>',_0x142ef8+=_0x4a2666(0xf4)+formatNumber(_0x476c92[_0x4a2666(0x24f)][_0x4a2666(0x18e)](0x2))+_0x4a2666(0x199),_0x142ef8+=_0x4a2666(0x1be),_0xfc30d3+=parseFloat(_0x476c92[_0x4a2666(0x1ec)]),_0x4e0261+=parseFloat(_0x476c92[_0x4a2666(0x24f)]);}var _0x4b59a5=_0x4e0261[_0x4a2666(0x1f7)](undefined),_0xe9b7e8=_0xfc30d3[_0x4a2666(0x1f7)](undefined);return _0x142ef8+=_0x4a2666(0x17a),_0x142ef8+=_0x4a2666(0x13d),_0x142ef8+=_0x4a2666(0x1d9)+formatNumber(_0xfc30d3[_0x4a2666(0x18e)](0x2))+_0x4a2666(0x223),_0x142ef8+=_0x4a2666(0x1d9)+formatNumber(_0x4e0261['toFixed'](0x2))+_0x4a2666(0x223),_0x142ef8+=_0x4a2666(0x1be),_0x142ef8;}router[a0_0x441f86(0x1ea)](a0_0x441f86(0x270),auth,async(_0x1ba7ee,_0x4eb259)=>{const _0x331211=a0_0x441f86;try{const {from_date:_0x28d151,to_date:_0x3c5cb9,isExcel:_0x4ce1ea}=_0x1ba7ee[_0x331211(0x184)],_0x50b975=_0x1ba7ee[_0x331211(0x275)],_0x55d693=await staff[_0x331211(0x14f)]({'email':_0x50b975[_0x331211(0x1d0)]});let _0x2f75fe=_0x331211(0x111);var _0x44cb51=new Date(_0x28d151),_0x4b0c85=new Date(_0x3c5cb9);const _0x3c50c0={'year':_0x331211(0x232),'month':_0x331211(0x1e5),'day':_0x331211(0x232)},_0x52b0fa=new Intl['DateTimeFormat']('en-US',_0x3c50c0)[_0x331211(0x245)](_0x44cb51),_0x53cb5f=new Intl[(_0x331211(0x113))](_0x331211(0x130),_0x3c50c0)['format'](_0x4b0c85);var _0x322808=await dataSalesReports(_0x28d151,_0x3c5cb9,_0x55d693[_0x331211(0x11a)]['valueOf']());_0x2f75fe+=_0x331211(0x247),_0x2f75fe+='<div\x20class=\x22col-sm-11\x22>',_0x2f75fe+=_0x331211(0x138),_0x2f75fe+=_0x331211(0x17a),_0x2f75fe+=_0x331211(0x170),_0x2f75fe+=_0x331211(0x26f),_0x2f75fe+=_0x331211(0x20c),_0x2f75fe+=_0x331211(0x26b),_0x2f75fe+=_0x331211(0x17a),_0x2f75fe+=_0x322808,_0x2f75fe+=_0x331211(0x1be),_0x2f75fe+=_0x331211(0x112),_0x2f75fe+=_0x331211(0x112);let _0x4efdbc='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x3e1ee9={'width':'15in','height':_0x331211(0x22e),'orientation':_0x331211(0x211),'border':{'top':_0x331211(0x147),'right':_0x331211(0x147),'bottom':_0x331211(0x147),'left':'0.1in'},'header':{'height':'60mm','contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4efdbc+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x55d693[_0x331211(0x152)]+_0x331211(0x263)+_0x52b0fa+_0x331211(0x267)+_0x53cb5f+_0x331211(0x21b)},'footer':{'height':'20mm','contents':{'default':_0x331211(0x193)}},'dpi':0x5,'zoomFactor':'1'};if(_0x4ce1ea=='on'){const _0x5a5785=cheerio[_0x331211(0x17c)](_0x2f75fe);let _0x3b5926=[],_0x4687d7=[],_0x29c59e=[];const _0x2858dc=_0xcb98e6=>{const _0x113dec=_0x331211,_0x216188={'top':{'style':_0x113dec(0xf6),'color':{'rgb':_0x113dec(0x226)}},'bottom':{'style':_0x113dec(0xf6),'color':{'rgb':_0x113dec(0x226)}},'left':{'style':_0x113dec(0xf6),'color':{'rgb':'000000'}},'right':{'style':_0x113dec(0xf6),'color':{'rgb':_0x113dec(0x226)}}};if(_0xcb98e6){const _0x561639=_0xcb98e6[_0x113dec(0x1a3)](';')[_0x113dec(0x105)]((_0x3d5a82,_0x5743f4)=>{const _0x4eb859=_0x113dec,[_0x3ef11f,_0x508491]=_0x5743f4[_0x4eb859(0x1a3)](':')[_0x4eb859(0x1a1)](_0x45c3f3=>_0x45c3f3[_0x4eb859(0x1ba)]());return _0x3d5a82[_0x3ef11f]=_0x508491,_0x3d5a82;},{});_0x561639[_0x113dec(0x137)]&&(_0x216188[_0x113dec(0x1e9)]['style']=_0x561639[_0x113dec(0x137)]['includes'](_0x113dec(0x176))?'thin':_0x113dec(0x1e3)),_0x561639[_0x113dec(0x188)]&&(_0x216188[_0x113dec(0x10f)][_0x113dec(0x1a8)]=_0x561639[_0x113dec(0x188)][_0x113dec(0x160)]('thin')?'thin':'medium'),_0x561639['border-left']&&(_0x216188[_0x113dec(0x1a2)][_0x113dec(0x1a8)]=_0x561639['border-left']['includes']('thin')?'thin':_0x113dec(0x1e3)),_0x561639[_0x113dec(0x27d)]&&(_0x216188[_0x113dec(0x1cc)][_0x113dec(0x1a8)]=_0x561639['border-right'][_0x113dec(0x160)]('thin')?_0x113dec(0x176):_0x113dec(0x1e3));}return _0x216188;};_0x5a5785(_0x331211(0x148))[_0x331211(0x1b8)]((_0x32e637,_0x488b7f)=>{const _0x2fa475=_0x331211;let _0x1d8eef=[],_0xdec113=0x0;while(_0x29c59e[_0xdec113]){_0x29c59e[_0xdec113]--,_0xdec113++;}_0x5a5785(_0x488b7f)['find'](_0x2fa475(0x10a))['each']((_0x10b3e7,_0x531e58)=>{const _0x2594cc=_0x2fa475;let _0x2404da=_0x5a5785(_0x531e58)[_0x2594cc(0x225)]()[_0x2594cc(0x1ba)](),_0x59d929=parseFloat(_0x2404da[_0x2594cc(0x1e8)](/,/g,'')),_0x306174={};!isNaN(_0x59d929)?(_0x306174['v']=_0x59d929,_0x306174['t']='n'):(_0x306174['v']=_0x2404da,_0x306174['t']='s');const _0x4ab3ea=_0x5a5785(_0x531e58)[_0x2594cc(0x187)](_0x2594cc(0x1a8)),_0x3d9fc6=_0x2858dc(_0x4ab3ea);_0x306174['s']={'border':_0x3d9fc6},_0x1d8eef[_0xdec113]=_0x306174;let _0x562753=parseInt(_0x5a5785(_0x531e58)['attr'](_0x2594cc(0x150)))||0x1,_0x1cbbdd=parseInt(_0x5a5785(_0x531e58)['attr'](_0x2594cc(0x189)))||0x1;(_0x562753>0x1||_0x1cbbdd>0x1)&&_0x4687d7[_0x2594cc(0x206)]({'s':{'r':_0x32e637,'c':_0xdec113},'e':{'r':_0x32e637+_0x1cbbdd-0x1,'c':_0xdec113+_0x562753-0x1}});for(let _0x5a3b9e=0x0;_0x5a3b9e<_0x562753;_0x5a3b9e++){_0x1cbbdd>0x1&&(_0x29c59e[_0xdec113+_0x5a3b9e]=_0x1cbbdd-0x1);}_0xdec113+=_0x562753;}),_0x3b5926[_0x2fa475(0x206)](_0x1d8eef);});const _0x52b9bc=XLSX[_0x331211(0x260)]['book_new'](),_0x1c70ad=XLSX[_0x331211(0x260)]['aoa_to_sheet'](_0x3b5926);_0x4687d7[_0x331211(0xfc)]>0x0&&(_0x1c70ad[_0x331211(0x14b)]=_0x4687d7);_0x1c70ad[_0x331211(0x103)]=_0x3b5926[0x0][_0x331211(0x1a1)](()=>({'wpx':0x64})),XLSX[_0x331211(0x260)][_0x331211(0x198)](_0x52b9bc,_0x1c70ad,_0x331211(0x126));const _0x54e4bb=XLSX[_0x331211(0x1ff)](_0x52b9bc,{'bookType':_0x331211(0x18f),'type':_0x331211(0x240)});_0x4eb259[_0x331211(0x163)]('Content-Disposition',_0x331211(0x210)),_0x4eb259['setHeader'](_0x331211(0x115),_0x331211(0x1c4)),_0x4eb259[_0x331211(0x179)](_0x54e4bb);}else pdf[_0x331211(0x100)](_0x2f75fe,_0x3e1ee9)[_0x331211(0x25d)](function(_0x13d145,_0x4fe676){const _0x54459a=_0x331211;if(_0x13d145){_0x4eb259['status'](0x1f4)[_0x54459a(0x179)]('Error\x20generating\x20PDF');return;}_0x4eb259[_0x54459a(0x163)](_0x54459a(0x115),_0x54459a(0x144)),_0x4fe676[_0x54459a(0x1fb)](_0x4eb259);});}catch(_0x2f6f5e){}}),router[a0_0x441f86(0x167)](a0_0x441f86(0x1af),auth,async(_0x4636d2,_0x2e31fb)=>{const _0x263bd9=a0_0x441f86;try{const {username:_0x49006a,email:_0x4711eb,role:_0x22c9e3}=_0x4636d2['user'],_0x49b628=_0x4636d2[_0x263bd9(0x275)],_0x3496b5=await profile[_0x263bd9(0x14f)]({'email':_0x49b628[_0x263bd9(0x1d0)]}),_0x2dec59={'year':_0x263bd9(0x232),'month':_0x263bd9(0x1e5),'day':_0x263bd9(0x232)},_0x3f678c=await master_shop['find'](),_0x682f0d=await product[_0x263bd9(0x234)](),_0x343bf7=await warehouse[_0x263bd9(0x27c)]([{'$unwind':_0x263bd9(0x124)},{'$lookup':{'from':_0x263bd9(0x156),'localField':_0x263bd9(0x1f3),'foreignField':_0x263bd9(0x152),'as':'product_docs'}},{'$unwind':_0x263bd9(0x1ae)},{'$project':{'product_name':_0x263bd9(0x120),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x263bd9(0x215),'product_stock':{'$sum':_0x263bd9(0x1fe)}}}]);if(_0x3f678c[0x0][_0x263bd9(0x227)]==_0x263bd9(0x208))var _0x193713=users[_0x263bd9(0x11e)];else{if(_0x3f678c[0x0][_0x263bd9(0x227)]=='Hindi')var _0x193713=users[_0x263bd9(0x168)];else{if(_0x3f678c[0x0][_0x263bd9(0x227)]==_0x263bd9(0x177))var _0x193713=users['German'];else{if(_0x3f678c[0x0][_0x263bd9(0x227)]==_0x263bd9(0x1ca))var _0x193713=users[_0x263bd9(0x1ca)];else{if(_0x3f678c[0x0][_0x263bd9(0x227)]=='French')var _0x193713=users[_0x263bd9(0x1d3)];else{if(_0x3f678c[0x0][_0x263bd9(0x227)]==_0x263bd9(0x183))var _0x193713=users[_0x263bd9(0x201)];else{if(_0x3f678c[0x0][_0x263bd9(0x227)]==_0x263bd9(0x16d))var _0x193713=users[_0x263bd9(0x16d)];else{if(_0x3f678c[0x0][_0x263bd9(0x227)]==_0x263bd9(0x15e))var _0x193713=users[_0x263bd9(0x21c)];}}}}}}}_0x2e31fb[_0x263bd9(0x11d)](_0x263bd9(0xf7),{'success':_0x4636d2[_0x263bd9(0x1a7)]('success'),'errors':_0x4636d2[_0x263bd9(0x1a7)](_0x263bd9(0x1e7)),'alldata':_0x682f0d,'profile':_0x3496b5,'master_shop':_0x3f678c,'role':_0x49b628,'product_stock':_0x343bf7,'language':_0x193713});}catch(_0x3aa16a){}});async function dataInventoryReports(_0xc04dab,_0x5f12c8,_0x582277){const _0x311789=a0_0x441f86,_0x48df22=await sales_sa[_0x311789(0x27c)]([{'$match':{'date':{'$gte':_0xc04dab,'$lte':_0x5f12c8},'sales_staff_id':_0x582277}},{'$unwind':_0x311789(0x22c)},{'$group':{'_id':{'product_name':_0x311789(0x1b4),'product_code':_0x311789(0x1f2)},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x563c4=mongoose[_0x311789(0x14d)][_0x311789(0x117)],_0xd21859=await staff[_0x311789(0x27c)]([{'$match':{'_id':_0x563c4(_0x582277)}},{'$unwind':_0x311789(0x1f4)},{'$match':{'product_list.isConfirm':_0x311789(0x1b1)}},{'$group':{'_id':{'product_name':_0x311789(0x1d1),'product_code':_0x311789(0x128)},'sumqty':{'$sum':_0x311789(0x19f)}}},{'$sort':{'_id.product_name':0x1}}]),_0x49fff5=await sales_inv_data['aggregate']([{'$match':{'date':{'$gte':_0xc04dab,'$lte':_0x5f12c8},'sales_staff_id':_0x582277}},{'$unwind':_0x311789(0x22c)},{'$group':{'_id':{'product_name':_0x311789(0x1b4),'product_code':_0x311789(0x1f2)},'totalQTYsum':{'$sum':_0x311789(0x255)}}}]);console[_0x311789(0x1e4)](_0x49fff5);let _0x2e2643='';var _0x4f3b64=0x0;for(let _0x352f1d=0x0;_0x352f1d<=_0xd21859['length']-0x1;_0x352f1d++){const _0x21ac23=_0xd21859[_0x352f1d];_0x2e2643+=_0x311789(0x17a),_0x2e2643+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>'+_0x21ac23[_0x311789(0x11a)][_0x311789(0x213)]+'</td>',_0x2e2643+=_0x311789(0xfe)+_0x21ac23['_id'][_0x311789(0x20d)]+_0x311789(0x199);var _0x29ff2a=_0x21ac23[_0x311789(0x1ec)],_0x223320=0x0;for(let _0x554d93=0x0;_0x554d93<=_0x48df22[_0x311789(0xfc)]-0x1;_0x554d93++){const _0x14295c=_0x48df22[_0x554d93];_0x21ac23['_id'][_0x311789(0x213)]==_0x14295c[_0x311789(0x11a)][_0x311789(0x213)]&&_0x21ac23[_0x311789(0x11a)][_0x311789(0x20d)]==_0x14295c[_0x311789(0x11a)][_0x311789(0x20d)]&&(_0x223320=_0x14295c['sumqty']);}var _0x47c3e8=0x0;for(let _0xff49da=0x0;_0xff49da<=_0x49fff5[_0x311789(0xfc)]-0x1;_0xff49da++){const _0x2ef408=_0x49fff5[_0xff49da];_0x21ac23[_0x311789(0x11a)][_0x311789(0x213)]==_0x2ef408['_id'][_0x311789(0x213)]&&_0x21ac23[_0x311789(0x11a)][_0x311789(0x20d)]==_0x2ef408[_0x311789(0x11a)]['product_name']&&(_0x47c3e8=_0x2ef408[_0x311789(0x13e)]);}_0x4f3b64=_0x29ff2a-_0x47c3e8+_0x223320,_0x2e2643+='<td\x20class=\x22row_data\x22>'+_0x4f3b64+_0x311789(0x199);let _0x5501a6=![];for(let _0x4d2091=0x0;_0x4d2091<=_0x49fff5[_0x311789(0xfc)]-0x1;_0x4d2091++){const _0x45221c=_0x49fff5[_0x4d2091];if(_0x21ac23[_0x311789(0x11a)][_0x311789(0x213)]==_0x45221c[_0x311789(0x11a)][_0x311789(0x213)]&&_0x21ac23[_0x311789(0x11a)]['product_name']==_0x45221c[_0x311789(0x11a)][_0x311789(0x20d)]){_0x2e2643+=_0x311789(0xf4)+_0x45221c[_0x311789(0x13e)]+_0x311789(0x199),_0x5501a6=!![];break;}}!_0x5501a6&&(_0x2e2643+=_0x311789(0x178));let _0x12965c=![];for(let _0x4bfdc9=0x0;_0x4bfdc9<=_0x48df22[_0x311789(0xfc)]-0x1;_0x4bfdc9++){const _0x462f6e=_0x48df22[_0x4bfdc9];if(_0x21ac23[_0x311789(0x11a)][_0x311789(0x213)]==_0x462f6e[_0x311789(0x11a)][_0x311789(0x213)]&&_0x21ac23['_id'][_0x311789(0x20d)]==_0x462f6e[_0x311789(0x11a)][_0x311789(0x20d)]){_0x2e2643+=_0x311789(0xf4)+_0x462f6e['sumqty']+_0x311789(0x199),_0x12965c=!![];break;}}!_0x12965c&&(_0x2e2643+='<td\x20class=\x22row_data\x22>0</td>'),_0x2e2643+=_0x311789(0xf4)+_0x21ac23['sumqty']+_0x311789(0x199),_0x2e2643+=_0x311789(0x1be);}return _0x2e2643;}router[a0_0x441f86(0x1ea)](a0_0x441f86(0x174),auth,async(_0x5ea4f6,_0x4cb8ad)=>{const _0x32609f=a0_0x441f86;try{const {from_date:_0x20907d,to_date:_0x2d8869}=_0x5ea4f6[_0x32609f(0x184)],_0x52a5e4=_0x5ea4f6[_0x32609f(0x275)],_0x33fa5b=await staff[_0x32609f(0x14f)]({'email':_0x52a5e4['email']});let _0x34ecd1=_0x32609f(0x111);var _0x3a701d=new Date(_0x20907d),_0x2ce7cf=new Date(_0x2d8869);const _0x4f137b={'year':_0x32609f(0x232),'month':_0x32609f(0x1e5),'day':_0x32609f(0x232)},_0x4dfdb6=new Intl[(_0x32609f(0x113))](_0x32609f(0x130),_0x4f137b)[_0x32609f(0x245)](_0x3a701d),_0x27c91b=new Intl[(_0x32609f(0x113))](_0x32609f(0x130),_0x4f137b)['format'](_0x2ce7cf);var _0x2e8d59=await dataInventoryReports(_0x20907d,_0x2d8869,_0x33fa5b['_id'][_0x32609f(0x204)]());_0x34ecd1+=_0x32609f(0x1b7),_0x34ecd1+=_0x32609f(0x248),_0x34ecd1+=_0x32609f(0x12b)+_0x4dfdb6+'\x20-\x20'+_0x27c91b+_0x32609f(0x1b3),_0x34ecd1+=_0x32609f(0x247),_0x34ecd1+=_0x32609f(0x242),_0x34ecd1+=_0x32609f(0x138),_0x34ecd1+=_0x32609f(0x17a),_0x34ecd1+=_0x32609f(0x170),_0x34ecd1+=_0x32609f(0x26f),_0x34ecd1+=_0x32609f(0x231),_0x34ecd1+=_0x32609f(0x158),_0x34ecd1+=_0x32609f(0x145),_0x34ecd1+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x34ecd1+=_0x32609f(0x17a),_0x34ecd1+=_0x2e8d59,_0x34ecd1+=_0x32609f(0x1be),_0x34ecd1+='</div>',_0x34ecd1+=_0x32609f(0x112);const _0x993587={'format':'Letter','orientation':_0x32609f(0x211)};pdf[_0x32609f(0x100)](_0x34ecd1,_0x993587)[_0x32609f(0x25d)](function(_0x5f26de,_0x340377){const _0x5eb6df=_0x32609f;if(_0x5f26de){_0x4cb8ad[_0x5eb6df(0x1f8)](0x1f4)[_0x5eb6df(0x179)]('Error\x20generating\x20PDF');return;}_0x4cb8ad[_0x5eb6df(0x163)]('Content-Type',_0x5eb6df(0x144)),_0x340377[_0x5eb6df(0x1fb)](_0x4cb8ad);});}catch(_0x198e0d){}}),router['get'](a0_0x441f86(0x182),auth,async(_0x389e13,_0x1020fa)=>{const _0x899377=a0_0x441f86;try{const {username:_0xaa4ca2,email:_0x5cd7ca,role:_0x5a17c7}=_0x389e13[_0x899377(0x275)],_0x199a3b=_0x389e13[_0x899377(0x275)],_0x82af9e=await profile['findOne']({'email':_0x199a3b['email']}),_0x1e6228={'year':_0x899377(0x232),'month':_0x899377(0x1e5),'day':_0x899377(0x232)},_0x27a54e=await master_shop['find']();console[_0x899377(0x1e4)](_0x899377(0x1d7),_0x27a54e);const _0x3fee67=await product[_0x899377(0x234)]();console[_0x899377(0x1e4)]('Products\x20find_data',_0x3fee67);const _0x22d669=await warehouse['aggregate']([{'$unwind':_0x899377(0x124)},{'$lookup':{'from':'products','localField':_0x899377(0x1f3),'foreignField':'name','as':_0x899377(0x209)}},{'$unwind':_0x899377(0x1ae)},{'$project':{'product_name':_0x899377(0x120),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x899377(0x215),'product_stock':{'$sum':_0x899377(0x1fe)}}}]);console['log'](_0x899377(0x251),_0x22d669),_0x22d669['forEach'](_0x5a85d5=>{const _0x4da920=_0x3fee67['map'](_0x316c0d=>{const _0x579f46=a0_0x5cb3;_0x316c0d['name']==_0x5a85d5[_0x579f46(0x11a)]&&(_0x316c0d['stock']=parseInt(_0x316c0d[_0x579f46(0x1e1)])+parseInt(_0x5a85d5[_0x579f46(0x10e)]));});});const _0x2fa0ea=await staff[_0x899377(0x14f)]({'email':_0x199a3b['email']});if(_0x27a54e[0x0][_0x899377(0x227)]==_0x899377(0x208))var _0x2186d6=users['English'];else{if(_0x27a54e[0x0][_0x899377(0x227)]==_0x899377(0x168))var _0x2186d6=users[_0x899377(0x168)];else{if(_0x27a54e[0x0][_0x899377(0x227)]==_0x899377(0x177))var _0x2186d6=users[_0x899377(0x177)];else{if(_0x27a54e[0x0][_0x899377(0x227)]=='Spanish')var _0x2186d6=users[_0x899377(0x1ca)];else{if(_0x27a54e[0x0][_0x899377(0x227)]==_0x899377(0x1d3))var _0x2186d6=users[_0x899377(0x1d3)];else{if(_0x27a54e[0x0]['language']==_0x899377(0x183))var _0x2186d6=users[_0x899377(0x201)];else{if(_0x27a54e[0x0][_0x899377(0x227)]==_0x899377(0x16d))var _0x2186d6=users[_0x899377(0x16d)];else{if(_0x27a54e[0x0][_0x899377(0x227)]=='Arabic\x20(ae)')var _0x2186d6=users['Arabic'];}}}}}}}_0x1020fa[_0x899377(0x11d)]('dssr_view',{'success':_0x389e13[_0x899377(0x1a7)]('success'),'errors':_0x389e13[_0x899377(0x1a7)](_0x899377(0x1e7)),'alldata':_0x3fee67,'profile':_0x82af9e,'master_shop':_0x27a54e,'role':_0x199a3b,'product_stock':_0x22d669,'language':_0x2186d6,'staff_arr':_0x2fa0ea});}catch(_0x31c151){}});async function agentsdataDSICheck_DSRR(_0x529b52,_0x1bf860,_0x5e19b1,_0x41dcf8){const _0x12b794=a0_0x441f86;let _0xb4aeec=new Date(_0x529b52);_0xb4aeec[_0x12b794(0x1c3)](_0xb4aeec[_0x12b794(0x1bd)]()-0x1);let _0x10f309=_0xb4aeec[_0x12b794(0x1c0)]()['split']('T')[0x0];const _0x10f3a0=await product[_0x12b794(0x27c)]([{'$group':{'_id':{'brand':_0x12b794(0x221),'category':_0x12b794(0x216)},'products':{'$push':{'name':_0x12b794(0x1e6),'product_code':_0x12b794(0x243)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1b996b=[];_0x1b996b['cat_brand']=[];for(let _0x5196d3=0x0;_0x5196d3<=_0x10f3a0['length']-0x1;_0x5196d3++){const _0x51dcdf=_0x10f3a0[_0x5196d3];_0x1b996b[_0x12b794(0x261)][_0x12b794(0x206)](_0x51dcdf);}const _0x7e799f=await product[_0x12b794(0x27c)]([{'$group':{'_id':{'category':_0x12b794(0x216)},'products':{'$push':{'brand':'$brand','product_code':_0x12b794(0x243),'product_name':_0x12b794(0x1e6)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3004e0=await product[_0x12b794(0x27c)]([{'$group':{'_id':{'category':_0x12b794(0x216),'brand':_0x12b794(0x221)}}},{'$group':{'_id':_0x12b794(0xf8),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2b4201=await sales_sa[_0x12b794(0x27c)]([{'$match':{'date':_0x529b52,'sales_staff_id':_0x1bf860,'sale_product.isFG':_0x12b794(0x1ee)}},{'$unwind':_0x12b794(0x22c)},{'$lookup':{'from':_0x12b794(0x156),'localField':_0x12b794(0x25b),'foreignField':_0x12b794(0x213),'as':_0x12b794(0x17f)}},{'$unwind':_0x12b794(0xf2)},{'$group':{'_id':{'dsi':_0x12b794(0x121),'date':_0x12b794(0x143),'customer':'$customer','status_data':_0x12b794(0x190)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':_0x12b794(0x279)},'amount':{'$first':_0x12b794(0x12f)},'bank':{'$first':_0x12b794(0x16b)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x12b794(0x127)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x12b794(0x15f),'discount':_0x12b794(0x194),'adj_discount':_0x12b794(0x132),'product_details':{'prod_name':_0x12b794(0x1ce),'product_code':_0x12b794(0x269),'category':_0x12b794(0x264),'brand':_0x12b794(0x19e),'gross_price':_0x12b794(0x24b),'isFG':_0x12b794(0x258),'prod_cat':_0x12b794(0x1c6),'prod_id':'$sale_product._id'}}}}},{'$unwind':_0x12b794(0x10d)},{'$group':{'_id':{'dsi':_0x12b794(0x205),'date':_0x12b794(0x1d8),'customer':_0x12b794(0x154),'status_data':_0x12b794(0x134),'category':_0x12b794(0x12c),'brand':'$products.product_details.brand','prod_id':_0x12b794(0x24a)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x12b794(0x272),_0x12b794(0x21a)]}},'NetPrice':{'$sum':_0x12b794(0x19c)},'discount':{'$sum':_0x12b794(0x253)},'adj_discount':{'$sum':_0x12b794(0xf5)},'cash':{'$first':_0x12b794(0x279)},'amount':{'$first':_0x12b794(0x12f)},'bank':{'$first':_0x12b794(0x16b)},'check_no':{'$first':_0x12b794(0x123)},'due_date':{'$first':_0x12b794(0x127)},'product_details':{'$first':_0x12b794(0x149)}}},{'$group':{'_id':{'dsi':_0x12b794(0x205),'date':_0x12b794(0x1d8),'customer':'$_id.customer','status_data':_0x12b794(0x134)},'totalQty':{'$sum':_0x12b794(0x235)},'totalGross':{'$sum':_0x12b794(0x1f9)},'NetPrice':{'$sum':_0x12b794(0x20e)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x12b794(0x181)},'cash':{'$first':_0x12b794(0x279)},'amount':{'$first':_0x12b794(0x12f)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x12b794(0x123)},'due_date':{'$first':_0x12b794(0x127)},'products':{'$push':{'qty':_0x12b794(0x235),'category':_0x12b794(0xf8),'brand':'$_id.brand','product_details':_0x12b794(0x124)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x1d31c0=await sales_sa['aggregate']([{'$match':{'date':_0x10f309,'sales_staff_id':_0x1bf860,'sale_product.isFG':_0x12b794(0x1ee)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x12b794(0x156),'localField':'sale_product.product_code','foreignField':_0x12b794(0x213),'as':_0x12b794(0x17f)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x12b794(0x121),'date':_0x12b794(0x143),'customer':_0x12b794(0x173)},'totalQty':{'$sum':_0x12b794(0x1c2)},'cash':{'$first':'$cash'},'amount':{'$first':_0x12b794(0x12f)},'bank':{'$first':_0x12b794(0x16b)},'check_no':{'$first':_0x12b794(0x123)},'due_date':{'$first':_0x12b794(0x127)},'products':{'$push':{'qty':_0x12b794(0x1c2),'NetPrice':_0x12b794(0x15f),'discount':_0x12b794(0x194),'adj_discount':_0x12b794(0x132),'product_details':{'prod_name':_0x12b794(0x1ce),'product_code':'$product_info.product_code','category':_0x12b794(0x264),'brand':'$product_info.brand','gross_price':_0x12b794(0x24b),'isFG':_0x12b794(0x258),'prod_cat':_0x12b794(0x1c6),'prod_id':_0x12b794(0x1a5)}}}}},{'$unwind':_0x12b794(0x10d)},{'$group':{'_id':{'dsi':_0x12b794(0x205),'date':_0x12b794(0x1d8),'customer':'$_id.customer','category':_0x12b794(0x12c),'brand':'$products.product_details.brand','prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':'$products.qty'},'cash':{'$first':'$cash'},'amount':{'$first':_0x12b794(0x12f)},'bank':{'$first':_0x12b794(0x16b)},'check_no':{'$first':_0x12b794(0x123)},'due_date':{'$first':_0x12b794(0x127)},'totalGross':{'$sum':{'$multiply':[_0x12b794(0x272),_0x12b794(0x21a)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x12b794(0x253)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x12b794(0x149)}}},{'$group':{'_id':{'dsi':_0x12b794(0x205),'date':_0x12b794(0x1d8),'customer':_0x12b794(0x154)},'totalQty':{'$sum':_0x12b794(0x235)},'cash':{'$first':_0x12b794(0x279)},'amount':{'$first':'$amount'},'bank':{'$first':_0x12b794(0x16b)},'check_no':{'$first':_0x12b794(0x123)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x12b794(0x196)},'adj_discount':{'$sum':_0x12b794(0x181)},'products':{'$push':{'qty':_0x12b794(0x235),'category':_0x12b794(0xf8),'brand':_0x12b794(0x186),'product_details':_0x12b794(0x124)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x807e91=await sales_sa[_0x12b794(0x27c)]([{'$match':{'date':_0x529b52,'sales_staff_id':_0x1bf860,'status_data':'true'}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x338fe7=await staff['findById'](_0x1bf860);let _0x13ce30=[],_0x211f70={},_0x2f34a9={};var _0x3b3845=0x0,_0x158448=0x0,_0x1840e3=0x0,_0x28b09c=0x0,_0x293947=0x0;const _0x9ec432=0x6;var _0x41ff2b=0x0,_0x34c707=0x0;for(let _0x42c5e6=0x0;_0x42c5e6<=_0x2b4201[_0x12b794(0xfc)]-0x1;_0x42c5e6++){const _0x122a12=_0x2b4201[_0x42c5e6];let _0x21c7be=_0x12b794(0x17a);_0x21c7be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x21c7be+=_0x12b794(0x10c)+_0x122a12[_0x12b794(0x11a)]['customer']+_0x12b794(0x199),_0x21c7be+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x122a12['_id']['dsi']+_0x12b794(0x199);let _0x3dfe0c={},_0x552d26={},_0x3d30d0={};var _0x18de63={},_0x28b87d={},_0x5e100d={},_0xedd6a4=0x0;for(let _0x29bd94=0x0;_0x29bd94<=_0x122a12[_0x12b794(0x156)][_0x12b794(0xfc)]-0x1;_0x29bd94++){const _0x36f571=_0x122a12[_0x12b794(0x156)][_0x29bd94];_0x3dfe0c[_0x36f571['brand']+'-'+_0x36f571['category']]=_0x36f571[_0x12b794(0x110)],_0x552d26[[_0x36f571['brand']+'-'+_0x36f571[_0x12b794(0x11f)]]]=_0x36f571[_0x12b794(0x22a)][_0x12b794(0x217)],_0x3d30d0[[_0x36f571[_0x12b794(0x20a)]+'-'+_0x36f571[_0x12b794(0x11f)]]]=_0x36f571['product_details'][_0x12b794(0x1dd)];const _0x4acc0a=_0x36f571[_0x12b794(0x20a)]+'-'+_0x36f571[_0x12b794(0x11f)];!Array[_0x12b794(0x166)](_0x2f34a9[_0x4acc0a])&&(_0x2f34a9[_0x4acc0a]=[]);!Array['isArray'](_0x2f34a9[_0x4acc0a])&&(_0x2f34a9[_0x4acc0a]=[]);_0x2f34a9[_0x4acc0a][_0x12b794(0x206)](_0x36f571[_0x12b794(0x110)]);if(_0x36f571['product_details'][_0x12b794(0x1dd)]=='P')_0x36f571[_0x12b794(0x22a)]['isFG']=='true'?(!_0x5e100d[_0x4acc0a]&&(_0x5e100d[_0x4acc0a]=0x0),_0x5e100d[_0x4acc0a]=_0x36f571['qty']):(!_0x18de63[_0x4acc0a]&&(_0x18de63[_0x4acc0a]=0x0),_0x18de63[_0x4acc0a]=_0x36f571[_0x12b794(0x110)]);else _0x36f571[_0x12b794(0x22a)]['prod_cat']=='S'&&(_0x36f571[_0x12b794(0x22a)][_0x12b794(0x217)]==_0x12b794(0x1b1)?(!_0x5e100d[_0x4acc0a]&&(_0x5e100d[_0x4acc0a]=0x0),_0x5e100d[_0x4acc0a]=_0x36f571[_0x12b794(0x110)]):(!_0x28b87d[_0x4acc0a]&&(_0x28b87d[_0x4acc0a]=0x0),_0x28b87d[_0x4acc0a]=_0x36f571[_0x12b794(0x110)]));_0xedd6a4++;}for(let _0x230678=0x0;_0x230678<=_0x1b996b[_0x12b794(0x261)]['length']-0x1;_0x230678++){const _0x552660=_0x1b996b[_0x12b794(0x261)][_0x230678],_0x2b86c7=_0x552660[_0x12b794(0x11a)][_0x12b794(0x20a)]+'-'+_0x552660['_id'][_0x12b794(0x11f)],_0x3c6c42=_0x3d30d0[_0x2b86c7]!==undefined?_0x3d30d0[_0x2b86c7]:'NA';var _0x4f33d9=_0x18de63[_0x2b86c7]!==undefined?_0x18de63[_0x2b86c7][_0x12b794(0x18e)](0x2):'',_0x317427=_0x28b87d[_0x2b86c7]!==undefined?_0x28b87d[_0x2b86c7][_0x12b794(0x18e)](0x2):'',_0x378e52=_0x5e100d[_0x2b86c7]!==undefined?_0x5e100d[_0x2b86c7][_0x12b794(0x18e)](0x2):'';_0x21c7be+=_0x12b794(0x27e)+_0x4f33d9+_0x12b794(0x199),_0x21c7be+=_0x12b794(0x27e)+_0x317427+_0x12b794(0x199),_0x21c7be+=_0x12b794(0x27e)+_0x378e52+_0x12b794(0x199);}var _0x1488a9=formatNumber(parseFloat(_0x122a12[_0x12b794(0x16f)])),_0x3127a2=formatNumber(parseFloat(_0x122a12[_0x12b794(0x18d)]));isNaN(_0x3127a2)&&(_0x3127a2=0x0),_0x21c7be+=_0x12b794(0x27e)+_0x1488a9+'</td>',_0x21c7be+=_0x12b794(0x27e)+_0x3127a2+_0x12b794(0x199),_0x21c7be+=_0x12b794(0x10c)+_0x122a12['bank']+_0x12b794(0x199),_0x21c7be+=_0x12b794(0x10c)+_0x122a12[_0x12b794(0x1f0)]+'</td>',_0x21c7be+=_0x12b794(0x10c)+_0x122a12[_0x12b794(0x1d6)]+'</td>',_0x1840e3=_0x122a12[_0x12b794(0x15a)]+_0x122a12[_0x12b794(0x1b0)],_0x41ff2b+=parseFloat(_0x122a12[_0x12b794(0x16f)]),_0x34c707+=parseFloat(_0x3127a2),_0x13ce30[_0x12b794(0x206)](_0x21c7be);}function _0x478865(_0x481d26,_0x2af011){const _0x17de56=_0x12b794,_0x56fe25=[];for(let _0x58d758=0x0;_0x58d758<=_0x481d26[_0x17de56(0xfc)]-0x1;_0x58d758+=_0x2af011){_0x56fe25['push'](_0x481d26[_0x17de56(0x1c5)](_0x58d758,_0x58d758+_0x2af011));}return _0x56fe25;}const _0x326b6a=_0x478865(_0x13ce30,_0x9ec432);let _0x3dfbf0='';return _0x326b6a['forEach']((_0x452e8e,_0x6c6f12)=>{const _0x26042c=_0x12b794;_0x6c6f12>0x0&&(_0x3dfbf0+=_0x26042c(0x1ed));_0x3dfbf0+=_0x26042c(0x138),_0x3dfbf0+='<thead>';const _0x145685=new Date(_0x529b52),_0x15b225={'year':_0x26042c(0x232),'month':_0x26042c(0x1e5),'day':_0x26042c(0x232),'timeZone':_0x26042c(0x222)},_0x486d06=_0x145685[_0x26042c(0x1ac)](_0x26042c(0x130),_0x15b225);_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x21d)+_0x41dcf8+'</b></td>',_0x3dfbf0+='</tr>',_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0x338fe7['name']+_0x26042c(0x199),_0x3dfbf0+=_0x26042c(0x250),_0x3dfbf0+=_0x26042c(0x22f),_0x3dfbf0+=_0x26042c(0x1aa),_0x3dfbf0+=_0x26042c(0x146),_0x3dfbf0+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x3dfbf0+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>',_0x3dfbf0+=_0x26042c(0xfd),_0x3dfbf0+=_0x26042c(0x162),_0x3dfbf0+=_0x26042c(0x1be),_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x3dfbf0+=_0x26042c(0x1f1)+_0x486d06+_0x26042c(0x199),_0x3dfbf0+=_0x26042c(0x1e0),_0x3dfbf0+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>',_0x3dfbf0+=_0x26042c(0x197),_0x3dfbf0+=_0x26042c(0x197),_0x3dfbf0+=_0x26042c(0x1be),_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x12d),_0x3dfbf0+=_0x26042c(0x165),_0x3dfbf0+=_0x26042c(0x254),_0x3dfbf0+=_0x26042c(0x197),_0x3dfbf0+=_0x26042c(0x197),_0x3dfbf0+=_0x26042c(0x1be),_0x3dfbf0+='<tr>',_0x3dfbf0+=_0x26042c(0x23a),_0x3dfbf0+='</tr>',_0x3dfbf0+='<tr>',_0x3dfbf0+=_0x26042c(0x24d),_0x3dfbf0+=_0x26042c(0x1fa),_0x3dfbf0+=_0x26042c(0x1be),_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x12e),_0x3dfbf0+=_0x26042c(0x159),_0x3dfbf0+=_0x26042c(0x200);for(let _0x1708c4=0x0;_0x1708c4<=_0x7e799f[_0x26042c(0xfc)]-0x1;_0x1708c4++){const _0x3ee722=_0x7e799f[_0x1708c4];for(let _0xaabc9b=0x0;_0xaabc9b<_0x1b996b[_0x26042c(0x261)]['length'];_0xaabc9b++){const _0x11e8a4=_0x1b996b[_0x26042c(0x261)][_0xaabc9b];if(_0x11e8a4[_0x26042c(0x11a)][_0x26042c(0x11f)]===_0x3ee722['_id']['category']){var _0x248713='';switch(_0x3ee722['_id'][_0x26042c(0x11f)]){case _0x26042c(0x23f):_0x248713=_0x11e8a4[_0x26042c(0x11a)][_0x26042c(0x20a)]+_0x26042c(0x13a);break;case'Household':_0x248713=_0x11e8a4[_0x26042c(0x11a)][_0x26042c(0x20a)]+_0x26042c(0x16c);break;default:_0x248713=_0x11e8a4[_0x26042c(0x11a)][_0x26042c(0x20a)];break;}_0x3dfbf0+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>'+_0x248713+_0x26042c(0x223);}}}_0x3dfbf0+=_0x26042c(0x1df),_0x3dfbf0+=_0x26042c(0x23e),_0x3dfbf0+='<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>',_0x3dfbf0+='</tr>',_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x1cb);for(let _0x2fcc0b=0x0;_0x2fcc0b<=_0x1b996b['cat_brand'][_0x26042c(0xfc)]-0x1;_0x2fcc0b++){const _0x2d98f3=_0x1b996b[_0x2fcc0b];_0x3dfbf0+=_0x26042c(0x249),_0x3dfbf0+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x3dfbf0+=_0x26042c(0x224);}_0x3dfbf0+=_0x26042c(0x1fd),_0x3dfbf0+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>',_0x3dfbf0+=_0x26042c(0x1c1),_0x3dfbf0+=_0x26042c(0x1be),_0x3dfbf0+=_0x26042c(0x244),_0x3dfbf0+='<tbody>',_0x452e8e[_0x26042c(0x268)](_0x5f3b5b=>{_0x3dfbf0+=_0x5f3b5b;});let _0x106d84={},_0x53edfb={},_0x354259={};for(let _0x4cfe25=0x0;_0x4cfe25<=_0x2b4201[_0x26042c(0xfc)]-0x1;_0x4cfe25++){const _0x58a3a4=_0x2b4201[_0x4cfe25];var _0xd2b601=0x0;for(let _0x1b8024=0x0;_0x1b8024<=_0x58a3a4[_0x26042c(0x156)]['length']-0x1;_0x1b8024++){const _0x18eef4=_0x58a3a4[_0x26042c(0x156)][_0x1b8024],_0x5017eb=_0x18eef4['brand']+'-'+_0x18eef4[_0x26042c(0x11f)];if(_0x18eef4[_0x26042c(0x22a)][_0x26042c(0x1dd)]=='P')_0x18eef4['product_details'][_0x26042c(0x217)]==_0x26042c(0x1b1)?(!_0x354259[_0x5017eb]&&(_0x354259[_0x5017eb]=0x0),_0x354259[_0x5017eb]+=_0x18eef4[_0x26042c(0x110)]):(!_0x106d84[_0x5017eb]&&(_0x106d84[_0x5017eb]=0x0),_0x106d84[_0x5017eb]+=_0x18eef4[_0x26042c(0x110)]);else _0x18eef4[_0x26042c(0x22a)][_0x26042c(0x1dd)]=='S'&&(_0x18eef4[_0x26042c(0x22a)][_0x26042c(0x217)]=='true'?(!_0x354259[_0x5017eb]&&(_0x354259[_0x5017eb]=0x0),_0x354259[_0x5017eb]+=_0x18eef4[_0x26042c(0x110)],console[_0x26042c(0x1e4)](_0x18eef4[_0x26042c(0x110)])):(!_0x53edfb[_0x5017eb]&&(_0x53edfb[_0x5017eb]=0x0),_0x53edfb[_0x5017eb]+=_0x18eef4['qty']));_0xd2b601++;}}let _0xa20c24={},_0x5d7520={},_0xe59768={};var _0x401e38=0x0,_0x170d43=0x0;for(let _0x59c066=0x0;_0x59c066<=_0x1d31c0[_0x26042c(0xfc)]-0x1;_0x59c066++){const _0xa9905a=_0x1d31c0[_0x59c066];var _0xd2b601=0x0;for(let _0x1e0332=0x0;_0x1e0332<=_0xa9905a[_0x26042c(0x156)]['length']-0x1;_0x1e0332++){const _0x215826=_0xa9905a['products'][_0x1e0332],_0x335501=_0x215826['brand']+'-'+_0x215826[_0x26042c(0x11f)];if(_0x215826[_0x26042c(0x22a)][_0x26042c(0x1dd)]=='P')_0x215826['product_details'][_0x26042c(0x217)]=='true'?(!_0xe59768[_0x335501]&&(_0xe59768[_0x335501]=0x0),_0xe59768[_0x335501]+=_0x215826['qty']):(!_0xa20c24[_0x335501]&&(_0xa20c24[_0x335501]=0x0),_0xa20c24[_0x335501]+=_0x215826['qty']);else _0x215826[_0x26042c(0x22a)]['prod_cat']=='S'&&(_0x215826[_0x26042c(0x22a)][_0x26042c(0x217)]=='true'?(!_0xe59768[_0x335501]&&(_0xe59768[_0x335501]=0x0),_0xe59768[_0x335501]+=_0x215826['qty']):(!_0x5d7520[_0x335501]&&(_0x5d7520[_0x335501]=0x0),_0x5d7520[_0x335501]+=_0x215826[_0x26042c(0x110)]));_0xd2b601++;}var _0x20610f=parseFloat(_0xa9905a[_0x26042c(0x16f)]),_0x301d9c=parseFloat(_0xa9905a['amount']);isNaN(_0x301d9c)&&(_0x301d9c=0x0),_0x401e38+=_0x20610f,_0x170d43+=_0x301d9c;}if(_0x807e91[_0x26042c(0xfc)]>0x0)for(let _0x17abd4=0x0;_0x17abd4<=_0x807e91[_0x26042c(0xfc)]-0x1;_0x17abd4++){const _0x1af154=_0x807e91[_0x17abd4];console[_0x26042c(0x1e4)](_0x1af154),_0x3dfbf0+='<tr>',_0x3dfbf0+=_0x26042c(0x1de)+(0x8+0x7*0x3)+'\x22><b>'+_0x1af154[_0x26042c(0x107)]+_0x26042c(0x223),_0x3dfbf0+='</tr>';}_0x3dfbf0+='<tr>',_0x3dfbf0+=_0x26042c(0x155),_0x3dfbf0+=_0x26042c(0x139),_0x3dfbf0+=_0x26042c(0x1a0);for(let _0x24f767=0x0;_0x24f767<=_0x1b996b[_0x26042c(0x261)]['length']-0x1;_0x24f767++){const _0x9d30c9=_0x1b996b[_0x26042c(0x261)][_0x24f767],_0x5ed8ec=_0x9d30c9['_id'][_0x26042c(0x20a)]+'-'+_0x9d30c9[_0x26042c(0x11a)][_0x26042c(0x11f)];var _0x3acc8d=_0x106d84[_0x5ed8ec]!==undefined?formatNumber(_0x106d84[_0x5ed8ec]['toFixed'](0x2)):'',_0x108958=_0x354259[_0x5ed8ec]!==undefined?formatNumber(_0x354259[_0x5ed8ec][_0x26042c(0x18e)](0x2)):'',_0x1c7666=_0x53edfb[_0x5ed8ec]!==undefined?formatNumber(_0x53edfb[_0x5ed8ec][_0x26042c(0x18e)](0x2)):'';_0x3dfbf0+=_0x26042c(0x15d)+_0x3acc8d+_0x26042c(0x223),_0x3dfbf0+=_0x26042c(0x15d)+_0x1c7666+'</b></td>',_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x108958+_0x26042c(0x223);}_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x41ff2b)+_0x26042c(0x223),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x34c707)+'</b></td>',_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+='</tr>',_0x3dfbf0+='<tr>',_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x3dfbf0+=_0x26042c(0x14a),_0x3dfbf0+=_0x26042c(0x1a0);for(let _0x4fce8a=0x0;_0x4fce8a<=_0x1b996b[_0x26042c(0x261)][_0x26042c(0xfc)]-0x1;_0x4fce8a++){const _0x2e13b2=_0x1b996b[_0x26042c(0x261)][_0x4fce8a],_0xc3b93f=_0x2e13b2[_0x26042c(0x11a)][_0x26042c(0x20a)]+'-'+_0x2e13b2[_0x26042c(0x11a)]['category'];var _0x3acc8d=_0xa20c24[_0xc3b93f]!==undefined?formatNumber(_0xa20c24[_0xc3b93f]['toFixed'](0x2)):'',_0x108958=_0xe59768[_0xc3b93f]!==undefined?formatNumber(_0xe59768[_0xc3b93f][_0x26042c(0x18e)](0x2)):'',_0x1c7666=_0x5d7520[_0xc3b93f]!==undefined?formatNumber(_0x5d7520[_0xc3b93f][_0x26042c(0x18e)](0x2)):'';_0x3dfbf0+=_0x26042c(0x15d)+_0x3acc8d+_0x26042c(0x223),_0x3dfbf0+=_0x26042c(0x15d)+_0x1c7666+_0x26042c(0x223),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x108958+'</b></td>';}_0x3dfbf0+=_0x26042c(0x15d)+formatNumber(_0x401e38)+_0x26042c(0x223),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x170d43)+'</b></td>',_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3dfbf0+='</tr>',_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x3dfbf0+=_0x26042c(0x175),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';let _0x4ca26b=0x0,_0x56a664=0x0,_0x442dba=0x0;for(let _0x41157f=0x0;_0x41157f<=_0x1b996b['cat_brand'][_0x26042c(0xfc)]-0x1;_0x41157f++){const _0x15ea52=_0x1b996b[_0x26042c(0x261)][_0x41157f],_0x184cb3=_0x15ea52[_0x26042c(0x11a)][_0x26042c(0x20a)]+'-'+_0x15ea52[_0x26042c(0x11a)]['category'];var _0xc9bf2a=_0x106d84[_0x184cb3]!==undefined?_0x106d84[_0x184cb3][_0x26042c(0x18e)](0x2):'0',_0x404db2=_0x354259[_0x184cb3]!==undefined?_0x354259[_0x184cb3][_0x26042c(0x18e)](0x2):'0',_0x37276b=_0x53edfb[_0x184cb3]!==undefined?_0x53edfb[_0x184cb3]['toFixed'](0x2):'0',_0x4be1eb=_0xa20c24[_0x184cb3]!==undefined?_0xa20c24[_0x184cb3][_0x26042c(0x18e)](0x2):'0',_0x2e9325=_0xe59768[_0x184cb3]!==undefined?_0xe59768[_0x184cb3][_0x26042c(0x18e)](0x2):'0',_0x4ed6c9=_0x5d7520[_0x184cb3]!==undefined?_0x5d7520[_0x184cb3][_0x26042c(0x18e)](0x2):'0';_0x4ca26b=parseFloat(_0xc9bf2a)+parseFloat(_0x4be1eb),_0x56a664=parseFloat(_0x37276b)+parseFloat(_0x4ed6c9),_0x442dba=parseFloat(_0x404db2)+parseFloat(_0x2e9325),_0x3dfbf0+=_0x26042c(0x15d)+formatNumber(_0x4ca26b[_0x26042c(0x18e)](0x2))+_0x26042c(0x223),_0x3dfbf0+=_0x26042c(0x15d)+formatNumber(_0x56a664[_0x26042c(0x18e)](0x2))+_0x26042c(0x223),_0x3dfbf0+=_0x26042c(0x15d)+formatNumber(_0x442dba['toFixed'](0x2))+'</b></td>';}var _0x40b26d=formatNumber(_0x41ff2b+_0x401e38),_0x542f89=formatNumber(_0x34c707+_0x170d43);_0x3dfbf0+=_0x26042c(0x15d)+_0x40b26d+_0x26042c(0x223),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x542f89+_0x26042c(0x223),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1be),_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x136)+(_0x1b996b[_0x26042c(0x261)][_0x26042c(0xfc)]*0x3+0x9)+_0x26042c(0x1d2),_0x3dfbf0+='</tr>',_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x3dfbf0+=_0x26042c(0x1ef),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x56bef1=0x0;_0x56bef1<=_0x1b996b[_0x26042c(0x261)]['length']-0x1;_0x56bef1++){const _0x52eb58=_0x1b996b[_0x26042c(0x261)][_0x56bef1],_0x4fe3b0=_0x52eb58[_0x26042c(0x11a)][_0x26042c(0x20a)]+'-'+_0x52eb58[_0x26042c(0x11a)][_0x26042c(0x11f)];var _0xc9bf2a=_0x106d84[_0x4fe3b0]!==undefined?_0x106d84[_0x4fe3b0][_0x26042c(0x18e)](0x2):'0',_0x404db2=_0x354259[_0x4fe3b0]!==undefined?_0x354259[_0x4fe3b0][_0x26042c(0x18e)](0x2):'0',_0x37276b=_0x53edfb[_0x4fe3b0]!==undefined?_0x53edfb[_0x4fe3b0][_0x26042c(0x18e)](0x2):'0',_0x4be1eb=_0xa20c24[_0x4fe3b0]!==undefined?_0xa20c24[_0x4fe3b0]['toFixed'](0x2):'0',_0x2e9325=_0xe59768[_0x4fe3b0]!==undefined?_0xe59768[_0x4fe3b0]['toFixed'](0x2):'0',_0x4ed6c9=_0x5d7520[_0x4fe3b0]!==undefined?_0x5d7520[_0x4fe3b0]['toFixed'](0x2):'0';_0x4ca26b=parseFloat(_0xc9bf2a)+parseFloat(_0x4be1eb),_0x56a664=parseFloat(_0x37276b)+parseFloat(_0x4ed6c9),_0x442dba=parseFloat(_0x404db2)+parseFloat(_0x2e9325),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x3dfbf0+=_0x26042c(0x26d),_0x3dfbf0+=_0x26042c(0x26d);}_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1be),_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x155),_0x3dfbf0+=_0x26042c(0xfa),_0x3dfbf0+=_0x26042c(0x1a0);for(let _0x5ea95c=0x0;_0x5ea95c<=_0x1b996b['cat_brand'][_0x26042c(0xfc)]-0x1;_0x5ea95c++){const _0x27c2ab=_0x1b996b[_0x26042c(0x261)][_0x5ea95c],_0xe16d22=_0x27c2ab[_0x26042c(0x11a)][_0x26042c(0x20a)]+'-'+_0x27c2ab['_id'][_0x26042c(0x11f)];var _0xc9bf2a=_0x106d84[_0xe16d22]!==undefined?_0x106d84[_0xe16d22]['toFixed'](0x2):'0',_0x404db2=_0x354259[_0xe16d22]!==undefined?_0x354259[_0xe16d22]['toFixed'](0x2):'0',_0x37276b=_0x53edfb[_0xe16d22]!==undefined?_0x53edfb[_0xe16d22][_0x26042c(0x18e)](0x2):'0',_0x4be1eb=_0xa20c24[_0xe16d22]!==undefined?_0xa20c24[_0xe16d22][_0x26042c(0x18e)](0x2):'0',_0x2e9325=_0xe59768[_0xe16d22]!==undefined?_0xe59768[_0xe16d22][_0x26042c(0x18e)](0x2):'0',_0x4ed6c9=_0x5d7520[_0xe16d22]!==undefined?_0x5d7520[_0xe16d22][_0x26042c(0x18e)](0x2):'0';_0x4ca26b=parseFloat(_0xc9bf2a)+parseFloat(_0x4be1eb),_0x56a664=parseFloat(_0x37276b)+parseFloat(_0x4ed6c9),_0x442dba=parseFloat(_0x404db2)+parseFloat(_0x2e9325),_0x3dfbf0+=_0x26042c(0x26d),_0x3dfbf0+=_0x26042c(0x26d),_0x3dfbf0+=_0x26042c(0x26d);}_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3dfbf0+='</tr>',_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x155),_0x3dfbf0+=_0x26042c(0x18b),_0x3dfbf0+=_0x26042c(0x1a0);for(let _0x55e20f=0x0;_0x55e20f<=_0x1b996b[_0x26042c(0x261)][_0x26042c(0xfc)]-0x1;_0x55e20f++){const _0x5a9712=_0x1b996b[_0x26042c(0x261)][_0x55e20f],_0x5dd0d7=_0x5a9712['_id'][_0x26042c(0x20a)]+'-'+_0x5a9712[_0x26042c(0x11a)][_0x26042c(0x11f)];var _0xc9bf2a=_0x106d84[_0x5dd0d7]!==undefined?_0x106d84[_0x5dd0d7][_0x26042c(0x18e)](0x2):'0',_0x404db2=_0x354259[_0x5dd0d7]!==undefined?_0x354259[_0x5dd0d7][_0x26042c(0x18e)](0x2):'0',_0x37276b=_0x53edfb[_0x5dd0d7]!==undefined?_0x53edfb[_0x5dd0d7]['toFixed'](0x2):'0',_0x4be1eb=_0xa20c24[_0x5dd0d7]!==undefined?_0xa20c24[_0x5dd0d7][_0x26042c(0x18e)](0x2):'0',_0x2e9325=_0xe59768[_0x5dd0d7]!==undefined?_0xe59768[_0x5dd0d7]['toFixed'](0x2):'0',_0x4ed6c9=_0x5d7520[_0x5dd0d7]!==undefined?_0x5d7520[_0x5dd0d7][_0x26042c(0x18e)](0x2):'0';_0x4ca26b=parseFloat(_0xc9bf2a)+parseFloat(_0x4be1eb),_0x56a664=parseFloat(_0x37276b)+parseFloat(_0x4ed6c9),_0x442dba=parseFloat(_0x404db2)+parseFloat(_0x2e9325),_0x3dfbf0+=_0x26042c(0x26d),_0x3dfbf0+=_0x26042c(0x26d),_0x3dfbf0+=_0x26042c(0x26d);}_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3dfbf0+='</tr>',_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x155),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x3dfbf0+=_0x26042c(0x1a0);for(let _0x2422cb=0x0;_0x2422cb<=_0x1b996b[_0x26042c(0x261)][_0x26042c(0xfc)]-0x1;_0x2422cb++){const _0x31a874=_0x1b996b[_0x26042c(0x261)][_0x2422cb],_0x5cee41=_0x31a874[_0x26042c(0x11a)][_0x26042c(0x20a)]+'-'+_0x31a874[_0x26042c(0x11a)][_0x26042c(0x11f)];var _0xc9bf2a=_0x106d84[_0x5cee41]!==undefined?_0x106d84[_0x5cee41][_0x26042c(0x18e)](0x2):'',_0x404db2=_0x354259[_0x5cee41]!==undefined?_0x354259[_0x5cee41][_0x26042c(0x18e)](0x2):'',_0x37276b=_0x53edfb[_0x5cee41]!==undefined?_0x53edfb[_0x5cee41]['toFixed'](0x2):'',_0x4be1eb=_0xa20c24[_0x5cee41]!==undefined?_0xa20c24[_0x5cee41][_0x26042c(0x18e)](0x2):'',_0x2e9325=_0xe59768[_0x5cee41]!==undefined?_0xe59768[_0x5cee41][_0x26042c(0x18e)](0x2):'',_0x4ed6c9=_0x5d7520[_0x5cee41]!==undefined?_0x5d7520[_0x5cee41][_0x26042c(0x18e)](0x2):'';_0x4ca26b=formatNumber(parseFloat(_0xc9bf2a)+parseFloat(_0x4be1eb)),_0x56a664=formatNumber(parseFloat(_0x37276b)+parseFloat(_0x4ed6c9)),_0x442dba=formatNumber(parseFloat(_0x404db2)+parseFloat(_0x2e9325)),_0x3dfbf0+=_0x26042c(0x15d)+_0xc9bf2a+_0x26042c(0x223),_0x3dfbf0+=_0x26042c(0x15d)+_0x37276b+_0x26042c(0x223),_0x3dfbf0+=_0x26042c(0x15d)+_0x404db2+_0x26042c(0x223);}_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3dfbf0+='</tr>',_0x3dfbf0+=_0x26042c(0x17a),_0x3dfbf0+=_0x26042c(0x155),_0x3dfbf0+=_0x26042c(0x171),_0x3dfbf0+=_0x26042c(0x1a0);for(let _0x5c9a27=0x0;_0x5c9a27<=_0x1b996b[_0x26042c(0x261)][_0x26042c(0xfc)]-0x1;_0x5c9a27++){const _0x19389b=_0x1b996b[_0x26042c(0x261)][_0x5c9a27],_0x1900a0=_0x19389b[_0x26042c(0x11a)]['brand']+'-'+_0x19389b[_0x26042c(0x11a)]['category'];var _0xc9bf2a=_0x106d84[_0x1900a0]!==undefined?_0x106d84[_0x1900a0][_0x26042c(0x18e)](0x2):'0',_0x404db2=_0x354259[_0x1900a0]!==undefined?_0x354259[_0x1900a0][_0x26042c(0x18e)](0x2):'0',_0x37276b=_0x53edfb[_0x1900a0]!==undefined?_0x53edfb[_0x1900a0]['toFixed'](0x2):'0',_0x4be1eb=_0xa20c24[_0x1900a0]!==undefined?_0xa20c24[_0x1900a0][_0x26042c(0x18e)](0x2):'0',_0x2e9325=_0xe59768[_0x1900a0]!==undefined?_0xe59768[_0x1900a0][_0x26042c(0x18e)](0x2):'0',_0x4ed6c9=_0x5d7520[_0x1900a0]!==undefined?_0x5d7520[_0x1900a0][_0x26042c(0x18e)](0x2):'0';_0x4ca26b=parseFloat(_0xc9bf2a)+parseFloat(_0x4be1eb),_0x56a664=parseFloat(_0x37276b)+parseFloat(_0x4ed6c9),_0x442dba=parseFloat(_0x404db2)+parseFloat(_0x2e9325),_0x3dfbf0+=_0x26042c(0x26d),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x3dfbf0+=_0x26042c(0x26d);}_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1a0),_0x3dfbf0+=_0x26042c(0x1be),_0x3dfbf0+='</tbody>',_0x3dfbf0+=_0x26042c(0x23d);}),_0x3dfbf0;}async function generateReferenceNumber(_0xdfae8f,_0x1d42b5,_0x5b9f2c){const _0x56a9bf=a0_0x441f86,_0x5ca9ab=new Date(_0xdfae8f)['getFullYear'](),_0x3b3b16=('0'+(new Date(_0xdfae8f)['getMonth']()+0x1))[_0x56a9bf(0x1c5)](-0x2),_0x23ae6d=('0'+new Date(_0xdfae8f)[_0x56a9bf(0x1bd)]())[_0x56a9bf(0x1c5)](-0x2),_0x2f5650=await staff[_0x56a9bf(0x14f)]({'email':_0x5b9f2c[_0x56a9bf(0x1d0)]}),_0x1f2efb=_0x2f5650['sales_man_code'],_0x10a827=_0x1f2efb+'-'+_0x5ca9ab+_0x3b3b16+_0x23ae6d,_0x408898=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x10a827),'salesman_code':_0x1f2efb})[_0x56a9bf(0x1e2)]({'createdAt':-0x1}),_0xc000de=_0x10a827;_0x408898&&(_0xc000de=_0x408898['referenceNumber']);console['log'](_0xc000de);const _0x5507c2=new Reference({'referenceNumber':_0xc000de,'staff_id':_0x1d42b5,'salesman_code':_0x1f2efb});return await _0x5507c2[_0x56a9bf(0x104)](),_0xc000de;}router[a0_0x441f86(0x1ea)](a0_0x441f86(0x13f),auth,async(_0x92569f,_0x43534d)=>{const _0xcab57f=a0_0x441f86,{from_date:_0x2f5343,dataview:_0x2af43e}=_0x92569f['body'],_0x33cdbe=_0x92569f[_0xcab57f(0x275)],_0x4f1781=await staff[_0xcab57f(0x14f)]({'email':_0x33cdbe[_0xcab57f(0x1d0)]}),_0x569818=await master_shop[_0xcab57f(0x234)](),_0x4e89ee='';var _0xc51288=new Date(_0x2f5343);const _0x26793b={'year':'numeric','month':'long','day':_0xcab57f(0x232)},_0x5bd250=new Intl[(_0xcab57f(0x113))](_0xcab57f(0x130),_0x26793b)[_0xcab57f(0x245)](_0xc51288),_0x5a2d82=await Reference[_0xcab57f(0x234)]({'staff_id':_0x4f1781[_0xcab57f(0x11a)][_0xcab57f(0x204)](),'date_include':_0x2f5343});if(_0x5a2d82[_0xcab57f(0xfc)]>0x0){let _0xb85c0d='';_0xb85c0d+=_0x5a2d82[0x0][_0xcab57f(0x256)];if(_0x2af43e==_0xcab57f(0x202)){const _0x145470=cheerio[_0xcab57f(0x17c)](_0xb85c0d);let _0x5dc338=[],_0xd67ee1=[],_0x5803cc=[];const _0xad74a9=_0x30a2a0=>{const _0x8c17e5=_0xcab57f,_0x18cf7d={'top':{'style':_0x8c17e5(0xf6),'color':{'rgb':_0x8c17e5(0x226)}},'bottom':{'style':_0x8c17e5(0xf6),'color':{'rgb':_0x8c17e5(0x226)}},'left':{'style':'thick','color':{'rgb':_0x8c17e5(0x226)}},'right':{'style':_0x8c17e5(0xf6),'color':{'rgb':'000000'}}};if(_0x30a2a0){const _0x422899=_0x30a2a0[_0x8c17e5(0x1a3)](';')[_0x8c17e5(0x105)]((_0x5f4426,_0x4e2cab)=>{const _0x5ab0c3=_0x8c17e5,[_0x41cd67,_0x5a236c]=_0x4e2cab[_0x5ab0c3(0x1a3)](':')[_0x5ab0c3(0x1a1)](_0x27fb71=>_0x27fb71[_0x5ab0c3(0x1ba)]());return _0x5f4426[_0x41cd67]=_0x5a236c,_0x5f4426;},{});_0x422899['border-top']&&(_0x18cf7d[_0x8c17e5(0x1e9)][_0x8c17e5(0x1a8)]=_0x422899[_0x8c17e5(0x137)][_0x8c17e5(0x160)](_0x8c17e5(0x176))?_0x8c17e5(0x176):_0x8c17e5(0x1e3)),_0x422899[_0x8c17e5(0x188)]&&(_0x18cf7d[_0x8c17e5(0x10f)]['style']=_0x422899[_0x8c17e5(0x188)][_0x8c17e5(0x160)](_0x8c17e5(0x176))?_0x8c17e5(0x176):_0x8c17e5(0x1e3)),_0x422899['border-left']&&(_0x18cf7d['left'][_0x8c17e5(0x1a8)]=_0x422899['border-left'][_0x8c17e5(0x160)](_0x8c17e5(0x176))?_0x8c17e5(0x176):'medium'),_0x422899['border-right']&&(_0x18cf7d[_0x8c17e5(0x1cc)][_0x8c17e5(0x1a8)]=_0x422899[_0x8c17e5(0x27d)][_0x8c17e5(0x160)](_0x8c17e5(0x176))?_0x8c17e5(0x176):_0x8c17e5(0x1e3));}return _0x18cf7d;};_0x145470(_0xcab57f(0x148))[_0xcab57f(0x1b8)]((_0x556fec,_0x580f2c)=>{const _0x761639=_0xcab57f;let _0x33b877=[],_0x43e211=0x0;while(_0x5803cc[_0x43e211]){_0x5803cc[_0x43e211]--,_0x43e211++;}_0x145470(_0x580f2c)[_0x761639(0x234)](_0x761639(0x10a))[_0x761639(0x1b8)]((_0x3bfe0f,_0x348d88)=>{const _0x50f152=_0x761639;let _0x1ba46a=_0x145470(_0x348d88)[_0x50f152(0x225)]()[_0x50f152(0x1ba)](),_0x27a0c3=parseFloat(_0x1ba46a[_0x50f152(0x1e8)](/,/g,''));isNaN(_0x27a0c3)&&(_0x27a0c3=_0x1ba46a);let _0xbf46be=parseInt(_0x145470(_0x348d88)['attr'](_0x50f152(0x150)))||0x1,_0x5300b8=parseInt(_0x145470(_0x348d88)['attr'](_0x50f152(0x189)))||0x1;const _0x6c3216=_0x145470(_0x348d88)[_0x50f152(0x187)](_0x50f152(0x1a8)),_0x5a06ad=_0xad74a9(_0x6c3216);_0x33b877[_0x43e211]={'v':_0x27a0c3,'s':{'border':_0x5a06ad}};(_0xbf46be>0x1||_0x5300b8>0x1)&&_0xd67ee1[_0x50f152(0x206)]({'s':{'r':_0x556fec,'c':_0x43e211},'e':{'r':_0x556fec+_0x5300b8-0x1,'c':_0x43e211+_0xbf46be-0x1}});for(let _0x4c7858=0x0;_0x4c7858<_0xbf46be;_0x4c7858++){_0x5300b8>0x1&&(_0x5803cc[_0x43e211+_0x4c7858]=_0x5300b8-0x1);}_0x43e211+=_0xbf46be;}),_0x5dc338[_0x761639(0x206)](_0x33b877);});const _0xd9a21c=XLSX[_0xcab57f(0x260)][_0xcab57f(0x119)](),_0x231b64=XLSX['utils'][_0xcab57f(0x151)](_0x5dc338);_0xd67ee1[_0xcab57f(0xfc)]>0x0&&(_0x231b64[_0xcab57f(0x14b)]=_0xd67ee1);_0x231b64['!cols']=_0x5dc338[0x0][_0xcab57f(0x1a1)](()=>({'wpx':0x64})),XLSX[_0xcab57f(0x260)][_0xcab57f(0x198)](_0xd9a21c,_0x231b64,_0xcab57f(0x126));const _0x58b371=XLSX['write'](_0xd9a21c,{'bookType':_0xcab57f(0x18f),'type':_0xcab57f(0x240)});_0x43534d['setHeader'](_0xcab57f(0x1b6),_0xcab57f(0x210)),_0x43534d[_0xcab57f(0x163)](_0xcab57f(0x115),_0xcab57f(0x1c4)),_0x43534d[_0xcab57f(0x179)](_0x58b371);}else{let _0x492a92='';_0x492a92+=_0xb85c0d,_0x492a92+='<script>',_0x492a92+='window.onload\x20=\x20function()\x20{',_0x492a92+=_0xcab57f(0x1bc),_0x492a92+='};',_0x492a92+='</script>',_0x43534d[_0xcab57f(0x179)](_0x492a92);}}else generateReferenceNumber(_0x2f5343,_0x4f1781[_0xcab57f(0x11a)][_0xcab57f(0x204)](),_0x33cdbe)[_0xcab57f(0x229)](async _0x27e4b9=>{const _0x4acc18=_0xcab57f,_0x137cc1=await agentsdataDSICheck_DSRR(_0x2f5343,_0x4f1781[_0x4acc18(0x11a)][_0x4acc18(0x204)](),_0x4e89ee,_0x27e4b9);let _0x55a5ab=_0x4acc18(0x266);_0x55a5ab+=_0x4acc18(0x247),_0x55a5ab+='<div\x20\x20id=\x22table-conatainer\x22>',_0x55a5ab+='<table>',_0x55a5ab+=_0x137cc1,_0x55a5ab+=_0x4acc18(0x23d),_0x55a5ab+=_0x4acc18(0x112),_0x55a5ab+=_0x4acc18(0x112);if(_0x137cc1[_0x4acc18(0xfc)]>0x0){const _0x507caf=await Reference[_0x4acc18(0x14f)]({'staff_id':_0x4f1781[_0x4acc18(0x11a)][_0x4acc18(0x204)](),'referenceNumber':_0x27e4b9});_0x507caf[_0x4acc18(0x256)]=_0x55a5ab,_0x507caf[_0x4acc18(0x172)]=_0x2f5343,await _0x507caf['save']();if(_0x2af43e==_0x4acc18(0x202)){const _0x262510=cheerio[_0x4acc18(0x17c)](_0x55a5ab);let _0x503e3d=[],_0x4bfd60=[],_0x30b97d=[];const _0xe51cf2=_0x3b467b=>{const _0x286211=_0x4acc18,_0x4311a2={'top':{'style':_0x286211(0xf6),'color':{'rgb':'000000'}},'bottom':{'style':_0x286211(0xf6),'color':{'rgb':_0x286211(0x226)}},'left':{'style':_0x286211(0xf6),'color':{'rgb':'000000'}},'right':{'style':_0x286211(0xf6),'color':{'rgb':_0x286211(0x226)}}};if(_0x3b467b){const _0x55942b=_0x3b467b['split'](';')[_0x286211(0x105)]((_0x774ac1,_0x40e424)=>{const _0x274cab=_0x286211,[_0xf191e1,_0x581e15]=_0x40e424[_0x274cab(0x1a3)](':')['map'](_0x92ce55=>_0x92ce55[_0x274cab(0x1ba)]());return _0x774ac1[_0xf191e1]=_0x581e15,_0x774ac1;},{});_0x55942b[_0x286211(0x137)]&&(_0x4311a2[_0x286211(0x1e9)][_0x286211(0x1a8)]=_0x55942b[_0x286211(0x137)][_0x286211(0x160)]('thin')?_0x286211(0x176):'medium'),_0x55942b[_0x286211(0x188)]&&(_0x4311a2[_0x286211(0x10f)][_0x286211(0x1a8)]=_0x55942b[_0x286211(0x188)][_0x286211(0x160)](_0x286211(0x176))?_0x286211(0x176):_0x286211(0x1e3)),_0x55942b[_0x286211(0x122)]&&(_0x4311a2[_0x286211(0x1a2)]['style']=_0x55942b[_0x286211(0x122)][_0x286211(0x160)](_0x286211(0x176))?_0x286211(0x176):_0x286211(0x1e3)),_0x55942b[_0x286211(0x27d)]&&(_0x4311a2[_0x286211(0x1cc)][_0x286211(0x1a8)]=_0x55942b[_0x286211(0x27d)]['includes'](_0x286211(0x176))?_0x286211(0x176):'medium');}return _0x4311a2;};_0x262510(_0x4acc18(0x148))[_0x4acc18(0x1b8)]((_0x23434c,_0x1e91c6)=>{const _0x3948d6=_0x4acc18;let _0x1ac5fa=[],_0x27689c=0x0;while(_0x30b97d[_0x27689c]){_0x30b97d[_0x27689c]--,_0x27689c++;}_0x262510(_0x1e91c6)['find']('td,\x20th')[_0x3948d6(0x1b8)]((_0x4e75b4,_0x59abce)=>{const _0x59836c=_0x3948d6;let _0x292051=_0x262510(_0x59abce)['text']()[_0x59836c(0x1ba)](),_0x396df8=parseFloat(_0x292051[_0x59836c(0x1e8)](/,/g,''));isNaN(_0x396df8)&&(_0x396df8=_0x292051);let _0x59b663=parseInt(_0x262510(_0x59abce)['attr']('colspan'))||0x1,_0x5d65d0=parseInt(_0x262510(_0x59abce)[_0x59836c(0x187)](_0x59836c(0x189)))||0x1;const _0x25957f=_0x262510(_0x59abce)['attr'](_0x59836c(0x1a8)),_0x201d2c=_0xe51cf2(_0x25957f);_0x1ac5fa[_0x27689c]={'v':_0x396df8,'s':{'border':_0x201d2c}};(_0x59b663>0x1||_0x5d65d0>0x1)&&_0x4bfd60[_0x59836c(0x206)]({'s':{'r':_0x23434c,'c':_0x27689c},'e':{'r':_0x23434c+_0x5d65d0-0x1,'c':_0x27689c+_0x59b663-0x1}});for(let _0x30a15b=0x0;_0x30a15b<_0x59b663;_0x30a15b++){_0x5d65d0>0x1&&(_0x30b97d[_0x27689c+_0x30a15b]=_0x5d65d0-0x1);}_0x27689c+=_0x59b663;}),_0x503e3d[_0x3948d6(0x206)](_0x1ac5fa);});const _0x349d3f=XLSX[_0x4acc18(0x260)][_0x4acc18(0x119)](),_0x173532=XLSX[_0x4acc18(0x260)][_0x4acc18(0x151)](_0x503e3d);_0x4bfd60['length']>0x0&&(_0x173532[_0x4acc18(0x14b)]=_0x4bfd60);_0x173532[_0x4acc18(0x103)]=_0x503e3d[0x0][_0x4acc18(0x1a1)](()=>({'wpx':0x64})),XLSX['utils'][_0x4acc18(0x198)](_0x349d3f,_0x173532,_0x4acc18(0x126));const _0x1785f8=XLSX[_0x4acc18(0x1ff)](_0x349d3f,{'bookType':_0x4acc18(0x18f),'type':_0x4acc18(0x240)});_0x43534d[_0x4acc18(0x163)](_0x4acc18(0x1b6),_0x4acc18(0x210)),_0x43534d[_0x4acc18(0x163)](_0x4acc18(0x115),_0x4acc18(0x1c4)),_0x43534d[_0x4acc18(0x179)](_0x1785f8);}else _0x55a5ab+=_0x4acc18(0x1b2),_0x55a5ab+='window.onload\x20=\x20function()\x20{',_0x55a5ab+=_0x4acc18(0x1bc),_0x55a5ab+='};',_0x55a5ab+=_0x4acc18(0x13c),_0x43534d[_0x4acc18(0x179)](_0x55a5ab);}else await Reference[_0x4acc18(0x1da)]({'referenceNumber':_0x27e4b9}),_0x92569f[_0x4acc18(0x1a7)](_0x4acc18(0x1e7),'No\x20data\x20was\x20Found!'),_0x43534d[_0x4acc18(0x262)](_0x4acc18(0x218));})[_0xcab57f(0x14e)](console[_0xcab57f(0x271)]);}),router[a0_0x441f86(0x167)](a0_0x441f86(0x1c9),auth,async(_0x3eafd9,_0x14d533)=>{const _0x4d980f=a0_0x441f86;try{const {username:_0x34a683,email:_0xea8316,role:_0x41141c}=_0x3eafd9['user'],_0x8fcfb0=_0x3eafd9[_0x4d980f(0x275)],_0x3b0df8=await profile['findOne']({'email':_0x8fcfb0[_0x4d980f(0x1d0)]}),_0xa90525={'year':_0x4d980f(0x232),'month':_0x4d980f(0x1e5),'day':_0x4d980f(0x232)},_0x454040=await master_shop[_0x4d980f(0x234)]();console['log'](_0x4d980f(0x1d7),_0x454040);const _0x5bc38b=await product[_0x4d980f(0x234)]();console['log'](_0x4d980f(0x1d4),_0x5bc38b);const _0x36ba5e=await warehouse[_0x4d980f(0x27c)]([{'$unwind':_0x4d980f(0x124)},{'$lookup':{'from':_0x4d980f(0x156),'localField':_0x4d980f(0x1f3),'foreignField':'name','as':_0x4d980f(0x209)}},{'$unwind':_0x4d980f(0x1ae)},{'$project':{'product_name':_0x4d980f(0x120),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x4d980f(0x215),'product_stock':{'$sum':'$product_stock'}}}]);console['log'](_0x4d980f(0x251),_0x36ba5e),_0x36ba5e[_0x4d980f(0x268)](_0x2df8ac=>{const _0x2a7c33=_0x4d980f,_0x10d9a3=_0x5bc38b[_0x2a7c33(0x1a1)](_0x33e7ba=>{const _0x3d29b2=_0x2a7c33;_0x33e7ba[_0x3d29b2(0x152)]==_0x2df8ac[_0x3d29b2(0x11a)]&&(_0x33e7ba[_0x3d29b2(0x1e1)]=parseInt(_0x33e7ba[_0x3d29b2(0x1e1)])+parseInt(_0x2df8ac[_0x3d29b2(0x10e)]));});});const _0x362514=await staff[_0x4d980f(0x234)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x21d5cf=await staff[_0x4d980f(0x14f)]({'email':_0x8fcfb0[_0x4d980f(0x1d0)]});if(_0x454040[0x0][_0x4d980f(0x227)]==_0x4d980f(0x208))var _0x351de3=users[_0x4d980f(0x11e)];else{if(_0x454040[0x0]['language']=='Hindi')var _0x351de3=users[_0x4d980f(0x168)];else{if(_0x454040[0x0][_0x4d980f(0x227)]=='German')var _0x351de3=users[_0x4d980f(0x177)];else{if(_0x454040[0x0][_0x4d980f(0x227)]==_0x4d980f(0x1ca))var _0x351de3=users[_0x4d980f(0x1ca)];else{if(_0x454040[0x0][_0x4d980f(0x227)]==_0x4d980f(0x1d3))var _0x351de3=users[_0x4d980f(0x1d3)];else{if(_0x454040[0x0][_0x4d980f(0x227)]=='Portuguese\x20(BR)')var _0x351de3=users['Portuguese'];else{if(_0x454040[0x0]['language']=='Chinese')var _0x351de3=users[_0x4d980f(0x16d)];else{if(_0x454040[0x0]['language']=='Arabic\x20(ae)')var _0x351de3=users[_0x4d980f(0x21c)];}}}}}}}_0x14d533[_0x4d980f(0x11d)](_0x4d980f(0x1db),{'success':_0x3eafd9['flash']('success'),'errors':_0x3eafd9[_0x4d980f(0x1a7)](_0x4d980f(0x1e7)),'alldata':_0x5bc38b,'profile':_0x3b0df8,'master_shop':_0x454040,'role':_0x8fcfb0,'product_stock':_0x36ba5e,'language':_0x351de3,'staff_arr':_0x21d5cf,'staff_data_all':_0x362514});}catch(_0x114a5d){}}),router[a0_0x441f86(0x1ea)](a0_0x441f86(0x125),auth,async(_0x462eb3,_0x1adad9)=>{const _0x169ef0=a0_0x441f86;try{const {from:_0x3c9f77,to:_0x532f95,staff_data:_0x573fb8}=_0x462eb3['body'],_0x5e93a0=await Reference[_0x169ef0(0x27c)]([{'$match':{'date_include':{'$gte':_0x3c9f77,'$lte':_0x532f95},'staff_id':_0x573fb8}},{'$sort':{'date_include':0x1}}]);_0x1adad9[_0x169ef0(0x21e)](_0x5e93a0);}catch(_0x1626a6){_0x1adad9[_0x169ef0(0x21e)](_0x1626a6);}}),router[a0_0x441f86(0x167)](a0_0x441f86(0x140),auth,async(_0x4622ae,_0x1b594a)=>{const _0x24f9c1=a0_0x441f86;try{const _0x500a93=_0x4622ae[_0x24f9c1(0x219)]['id'],_0x4fccec=await Reference[_0x24f9c1(0x25e)](_0x500a93);let _0x3cf190='';_0x3cf190+=_0x4fccec[_0x24f9c1(0x256)],_0x3cf190+=_0x24f9c1(0x1b2),_0x3cf190+=_0x24f9c1(0x239),_0x3cf190+=_0x24f9c1(0x1bc),_0x3cf190+='};',_0x3cf190+=_0x24f9c1(0x13c),_0x1b594a[_0x24f9c1(0x179)](_0x3cf190);}catch(_0x2738dc){_0x1b594a[_0x24f9c1(0x21e)](_0x2738dc);}}),router[a0_0x441f86(0x1ea)](a0_0x441f86(0x24c),auth,async(_0x2a05bf,_0x345446)=>{const _0x10226f=a0_0x441f86;try{const {ref_data:_0x565c02}=_0x2a05bf[_0x10226f(0x184)],_0xa56d24=_0x565c02['split']('~'),_0x40eb72=_0xa56d24[_0x10226f(0x27a)](_0x5dfea9=>_0x5dfea9!==''),_0x40860b=await Reference[_0x10226f(0x27c)]([{'$match':{'referenceNumber':{'$in':_0x40eb72}}}]),_0x2a4dcd=XLSX['utils'][_0x10226f(0x119)]();_0x40860b['forEach'](_0x1280ac=>{const _0x5380b6=_0x10226f,_0x579c41=cheerio['load'](_0x1280ac[_0x5380b6(0x256)]);let _0x6ad378=[],_0x28a83f=[],_0x2809eb=[];_0x579c41('table\x20tr')[_0x5380b6(0x1b8)]((_0x11d7e2,_0x3bbc46)=>{const _0x401fd9=_0x5380b6;let _0x57f964=[],_0x47f25e=0x0;while(_0x2809eb[_0x47f25e]){_0x2809eb[_0x47f25e]--,_0x47f25e++;}_0x579c41(_0x3bbc46)[_0x401fd9(0x234)](_0x401fd9(0x10a))[_0x401fd9(0x1b8)]((_0xa16138,_0x41155c)=>{const _0x388e95=_0x401fd9;let _0xea9800=_0x579c41(_0x41155c)[_0x388e95(0x225)]()[_0x388e95(0x1ba)](),_0x6e6319=parseFloat(_0xea9800[_0x388e95(0x1e8)](/,/g,''));isNaN(_0x6e6319)&&(_0x6e6319=_0xea9800);let _0x35e893=parseInt(_0x579c41(_0x41155c)[_0x388e95(0x187)](_0x388e95(0x150)))||0x1,_0x5a45d4=parseInt(_0x579c41(_0x41155c)['attr'](_0x388e95(0x189)))||0x1;_0x57f964[_0x47f25e]=_0x6e6319;(_0x35e893>0x1||_0x5a45d4>0x1)&&_0x28a83f[_0x388e95(0x206)]({'s':{'r':_0x11d7e2,'c':_0x47f25e},'e':{'r':_0x11d7e2+_0x5a45d4-0x1,'c':_0x47f25e+_0x35e893-0x1}});for(let _0x352f38=0x0;_0x352f38<_0x35e893;_0x352f38++){_0x5a45d4>0x1&&(_0x2809eb[_0x47f25e+_0x352f38]=_0x5a45d4-0x1);}_0x47f25e+=_0x35e893;}),_0x6ad378[_0x401fd9(0x206)](_0x57f964);});const _0xa079ce=XLSX[_0x5380b6(0x260)][_0x5380b6(0x151)](_0x6ad378);_0x28a83f[_0x5380b6(0xfc)]>0x0&&(_0xa079ce[_0x5380b6(0x14b)]=_0x28a83f),_0xa079ce[_0x5380b6(0x103)]=_0x6ad378[0x0][_0x5380b6(0x1a1)](()=>({'wpx':0x64})),XLSX[_0x5380b6(0x260)][_0x5380b6(0x198)](_0x2a4dcd,_0xa079ce,_0x1280ac[_0x5380b6(0x25a)]);});const _0x1fe8e3=XLSX[_0x10226f(0x1ff)](_0x2a4dcd,{'bookType':'xlsx','type':_0x10226f(0x240)});_0x345446[_0x10226f(0x163)](_0x10226f(0x1b6),'attachment;\x20filename=\x22reports.xlsx\x22'),_0x345446['setHeader'](_0x10226f(0x115),_0x10226f(0x1c4)),_0x345446[_0x10226f(0x179)](_0x1fe8e3);}catch(_0xde99c9){_0x345446[_0x10226f(0x21e)](_0xde99c9);}}),router[a0_0x441f86(0x1ea)]('/dsrr_admin/pdf_admin',auth,async(_0xb0df7f,_0x5edf55)=>{const _0x347f21=a0_0x441f86,{from_date:_0x66fadb,agent_id:_0x490fa3}=_0xb0df7f['body'],_0x18cfe3=_0xb0df7f[_0x347f21(0x275)],_0x44dc0e=await staff[_0x347f21(0x14f)]({'email':_0x18cfe3['email']}),_0x64c91b=await master_shop['find'](),_0x2f3f80=await agentsdataDSICheck_DSRR(_0x66fadb,_0x490fa3,_0x211ebd);let _0x57abf6=_0x347f21(0x18a);var _0x35b89e=new Date(_0x66fadb);const _0x1aa67b={'year':_0x347f21(0x232),'month':'long','day':_0x347f21(0x232)},_0x32102e=new Intl[(_0x347f21(0x113))](_0x347f21(0x130),_0x1aa67b)[_0x347f21(0x245)](_0x35b89e);_0x57abf6+=_0x347f21(0x247),_0x57abf6+='<div\x20\x20id=\x22table-conatainer\x22>',_0x57abf6+=_0x347f21(0x138),_0x57abf6+=_0x2f3f80,_0x57abf6+=_0x347f21(0x23d),_0x57abf6+=_0x347f21(0x112),_0x57abf6+=_0x347f21(0x112);let _0x17d1f4=_0x347f21(0x18c);const _0x45542c={'width':'15in','height':_0x347f21(0x22e),'orientation':'landscape','border':{'top':_0x347f21(0x147),'right':'0.1in','bottom':_0x347f21(0x147),'left':_0x347f21(0x147)},'header':{'height':'60mm','contents':_0x347f21(0x203)+_0x17d1f4+_0x347f21(0x230)+_0x32102e+_0x347f21(0x21b)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};var _0x211ebd='on';if(_0x211ebd=='on'){const _0x2749f2=cheerio[_0x347f21(0x17c)](_0x57abf6);let _0x262fdd=[],_0x6db743=[],_0x5cf101=[];_0x2749f2('table\x20tr')[_0x347f21(0x1b8)]((_0x2b23f0,_0x24f384)=>{const _0x1dfe74=_0x347f21;let _0x42a6b6=[],_0x49a243=0x0;while(_0x5cf101[_0x49a243]){_0x5cf101[_0x49a243]--,_0x49a243++;}_0x2749f2(_0x24f384)['find'](_0x1dfe74(0x10a))[_0x1dfe74(0x1b8)]((_0x14e0d4,_0x120957)=>{const _0x486c28=_0x1dfe74;let _0x4f69cc=_0x2749f2(_0x120957)[_0x486c28(0x225)]()['trim'](),_0x46568b=parseFloat(_0x4f69cc[_0x486c28(0x1e8)](/,/g,''));isNaN(_0x46568b)&&(_0x46568b=_0x4f69cc);let _0x2f8fc6=parseInt(_0x2749f2(_0x120957)[_0x486c28(0x187)](_0x486c28(0x150)))||0x1,_0x11a1ea=parseInt(_0x2749f2(_0x120957)[_0x486c28(0x187)](_0x486c28(0x189)))||0x1;_0x42a6b6[_0x49a243]=_0x46568b;(_0x2f8fc6>0x1||_0x11a1ea>0x1)&&_0x6db743['push']({'s':{'r':_0x2b23f0,'c':_0x49a243},'e':{'r':_0x2b23f0+_0x11a1ea-0x1,'c':_0x49a243+_0x2f8fc6-0x1}});for(let _0x4569ba=0x0;_0x4569ba<_0x2f8fc6;_0x4569ba++){_0x11a1ea>0x1&&(_0x5cf101[_0x49a243+_0x4569ba]=_0x11a1ea-0x1);}_0x49a243+=_0x2f8fc6;}),_0x262fdd['push'](_0x42a6b6);});const _0x4e498f=XLSX[_0x347f21(0x260)][_0x347f21(0x119)](),_0x2fdf22=XLSX[_0x347f21(0x260)][_0x347f21(0x151)](_0x262fdd);_0x6db743[_0x347f21(0xfc)]>0x0&&(_0x2fdf22[_0x347f21(0x14b)]=_0x6db743);_0x2fdf22[_0x347f21(0x103)]=_0x262fdd[0x0][_0x347f21(0x1a1)](()=>({'wpx':0x64})),XLSX[_0x347f21(0x260)]['book_append_sheet'](_0x4e498f,_0x2fdf22,_0x347f21(0x126));const _0x433dde=XLSX[_0x347f21(0x1ff)](_0x4e498f,{'bookType':_0x347f21(0x18f),'type':_0x347f21(0x240)});_0x5edf55[_0x347f21(0x163)](_0x347f21(0x1b6),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x5edf55[_0x347f21(0x163)](_0x347f21(0x115),_0x347f21(0x1c4)),_0x5edf55[_0x347f21(0x179)](_0x433dde);}else pdf['create'](_0x57abf6,_0x45542c)[_0x347f21(0x25d)](function(_0x37852e,_0x286bce){const _0x59164e=_0x347f21;if(_0x37852e){_0x5edf55[_0x59164e(0x1f8)](0x1f4)[_0x59164e(0x179)](_0x59164e(0xff));return;}_0x5edf55[_0x59164e(0x163)](_0x59164e(0x115),_0x59164e(0x144)),_0x286bce['pipe'](_0x5edf55);});}),module['exports']=router;function a0_0x29ec(){const _0x106acd=['3457255IKThAw','<td\x20class=\x22cat_data\x22></td>','window.onload\x20=\x20function()\x20{','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<thead>','/agent_reports/sales_ad','</table>','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','Standard','buffer','NetPrice','<div\x20class=\x22col-sm-11\x22>','$product_code','</thead>','format','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','<div\x20class=\x22row\x22>','<p>INVENTORY\x20SUMMARY</p>','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','$products.product_details.prod_id','$product_info.gross_price','/dl_excel','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','totalPrice','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','Products\x20warehouse_data','sales_bkg','$products.discount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','$sale_product.stock','html','<td\x20colspan=\x22','$sale_product.isFG','totalQty','referenceNumber','sale_product.product_code','exceljs','toStream','findById','$product.quantity','utils','cat_brand','redirect','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','$product_info.category','NumberFormat','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20-\x20','forEach','$product_info.product_code','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<th>\x20INVOICE\x20AMOUNT\x20</th>','path','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','$products.product_details.brand','<th>\x20ITEM\x20DESCRIPTION\x20</th>','/total_sales_reports/pdf','error','$products.qty','sales_reports','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','user','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','salesman_data','<tbody>','$cash','filter','117896SbeeWq','aggregate','border-right','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','$product_info','dataqty','<td\x20class=\x22row_data\x22>','$products.adj_discount','thick','inventory_sum','$_id.category','multer','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','sales_staff_id','length','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','Error\x20generating\x20PDF','create','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','/balance/view','!cols','save','reduce','customer','note','11bVFGqb','dsi_sales_admin','td,\x20th','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','$products','product_stock','bottom','qty','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','</div>','DateTimeFormat','/balance/pdf','Content-Type','html-pdf','ObjectId','$product','book_new','_id','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','express/lib/response','render','English','category','$product_details.product_name','$dsi','border-left','$check_no','$product_details','/getDSSR_no','Sales\x20Report','$due_date','$product_list.product_code','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','/agent_reports/pdf','<p>','$products.product_details.category','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','$amount','en-US','balanced','$sale_product.adj_discount','success','$_id.status_data','</th>','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','border-top','<table>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','\x20-\x20STD','$sales_info.name','</script>','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','totalQTYsum','/dsrr/pdf','/dsrr_admin/view_data/:id','203VZhuAC','cheerio','$date','application/pdf','<th>\x20SALES\x20</th>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','0.1in','table\x20tr','$products.product_details','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','!merges','52giegvG','Types','catch','findOne','colspan','aoa_to_sheet','name','agent_sales','$_id.customer','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','products','beg_bal','<th>\x20INCOMING\x20</th>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','discount','18485ALUbxD','totalGross','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','Arabic\x20(ae)','$sale_product.totalprice','includes','test','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','setHeader','express','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','isArray','get','Hindi','totalQTY','Letter','$bank','\x20-\x20HH','Chinese','<td\x20class=\x22cat_data\x22>','cash','<th>\x20ITEM\x20CODE\x20</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','date_include','$customer','/inventory_sum/pdf','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','thin','German','<td\x20class=\x22row_data\x22>0</td>','send','<tr>','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','load','<th>Booking</th>','<td\x20colspan=\x223\x22><b>TOTAL<b>','product_info','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','$adj_discount','/dsrr/view','Portuguese\x20(BR)','body','2020218qQmeMA','$_id.brand','attr','border-bottom','rowspan','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','amount','toFixed','xlsx','$status_data','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','$sale_product.discount','22416110FuYIVs','$discount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','book_append_sheet','</td>','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','$products.NetPrice','<th\x20rowspan=\x272\x27>Category</th>','$product_info.brand','$product_list.product_stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','map','left','split','$sales_info','$sale_product._id','<div\x20\x20id=\x22table-conatainer\x22>','flash','style','\x22\x20class=\x22cat_data\x22>','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','dsi','toLocaleDateString','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','$product_docs','/inventory_sum/view','adj_discount','true','<script>','</p>','$sale_product.product_name','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','Content-Disposition','<h1>JAKA\x20EQUITIES\x20CORP</h1>','each','$sale_product.quantity','trim','6YvsEdR','window.print();','getDate','</tr>','staffs','toISOString','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','$sale_product.real_qty_unit_val','setDate','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','slice','$sale_product.prod_cat','6483573EBrypQ','canvas','/dsrr_admin/view','Spanish','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','right','jsbarcode','$product_info.name','<th\x20rowspan=\x272\x27>Production</th>','email','$product_list.product_name','\x22><b></b></td>','French','Products\x20find_data','pdfkit-table','due_date','Products\x20master','$_id.date','<td\x20class=\x22row_data\x22><b>','deleteOne','dssr_view_admin','$product_details.product_stock','prod_cat','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','stock','sort','medium','log','long','$name','errors','replace','top','post','brandCount','sumqty','<div\x20style=\x22page-break-before:\x20always;\x22></div>','false','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','check_no','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','$sale_product.product_code','product_details.product_name','$product_list','dsi_sales','<th\x20colspan=\x272\x27>SOLD</th>','toLocaleString','status','$totalGross','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','pipe','60mm','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','$product_stock','write','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','Portuguese','excel','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','valueOf','$_id.dsi','push','../models/all_models','English\x20(US)','product_docs','brand','$sales_staff_id','<th>\x20QTY\x20SOLD\x20</th>','product_name','$NetPrice','blob-stream','attachment;\x20filename=\x22sales_report.xlsx\x22','landscape','sales_ext','product_code','date','$product_name','$category','isFG','/reports/dsrr/view','params','$products.product_details.gross_price','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Arabic','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','json','Router','/total_sales_reports/view','$brand','Asia/Manila','</b></td>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','text','000000','language','1076528PQyCxd','then','product_details','/agent/pdf','$sale_product','<td\x20class=\x22row_data\x22></td>','8.5in','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<th>\x20BEG\x20BALANCE\x20</th>','numeric','sales_info','find','$totalQty','</tbody>'];a0_0x29ec=function(){return _0x106acd;};return a0_0x29ec();}