const a0_0x5de9ce=a0_0x28b6;(function(_0x112753,_0xc1503c){const _0x1ceddf=a0_0x28b6,_0x1ef599=_0x112753();while(!![]){try{const _0x37bdfa=-parseInt(_0x1ceddf(0x17c))/0x1*(-parseInt(_0x1ceddf(0x219))/0x2)+parseInt(_0x1ceddf(0x226))/0x3*(parseInt(_0x1ceddf(0x1b0))/0x4)+-parseInt(_0x1ceddf(0x19c))/0x5+-parseInt(_0x1ceddf(0x1ab))/0x6*(-parseInt(_0x1ceddf(0x176))/0x7)+parseInt(_0x1ceddf(0x1a3))/0x8+parseInt(_0x1ceddf(0x232))/0x9*(parseInt(_0x1ceddf(0x151))/0xa)+-parseInt(_0x1ceddf(0x23b))/0xb;if(_0x37bdfa===_0xc1503c)break;else _0x1ef599['push'](_0x1ef599['shift']());}catch(_0x3999d2){_0x1ef599['push'](_0x1ef599['shift']());}}}(a0_0x3686,0x73706));const express=require(a0_0x5de9ce(0x1c8)),res=require(a0_0x5de9ce(0x1fb)),app=express(),router=express['Router'](),multer=require(a0_0x5de9ce(0x183)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require(a0_0x5de9ce(0x125)),users=require(a0_0x5de9ce(0x16b)),excelJS=require(a0_0x5de9ce(0x19b)),XLSX=require(a0_0x5de9ce(0xe7)),PDFDocument=require(a0_0x5de9ce(0x222)),fs=require('fs'),blobStream=require('blob-stream'),JsBarcode=require(a0_0x5de9ce(0x12e)),{Canvas}=require(a0_0x5de9ce(0x21c)),pdf=require('html-pdf'),path=require('path'),mongoose=require(a0_0x5de9ce(0x203)),cheerio=require(a0_0x5de9ce(0x26f));router[a0_0x5de9ce(0x15e)](a0_0x5de9ce(0x193),auth,async(_0x4515be,_0x180784)=>{const _0x517bc5=a0_0x5de9ce;try{const {username:_0x408668,email:_0x2416ff,role:_0xa0c608}=_0x4515be['user'],_0x325be9=_0x4515be[_0x517bc5(0x1f3)],_0x3ddeb9=await profile['findOne']({'email':_0x325be9['email']}),_0x23a1da={'year':'numeric','month':_0x517bc5(0x223),'day':_0x517bc5(0x1dc)},_0x414ff1=await master_shop[_0x517bc5(0xe9)]();console[_0x517bc5(0x1be)]('Products\x20master',_0x414ff1);const _0x24838d=await product[_0x517bc5(0xe9)]();console[_0x517bc5(0x1be)](_0x517bc5(0xef),_0x24838d);const _0xf8acf3=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x517bc5(0x26d),'localField':'product_details.product_name','foreignField':_0x517bc5(0x158),'as':_0x517bc5(0x140)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x517bc5(0x1c5),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x517bc5(0x1cd),'product_stock':{'$sum':_0x517bc5(0x267)}}}]);console[_0x517bc5(0x1be)](_0x517bc5(0x13c),_0xf8acf3),_0xf8acf3['forEach'](_0x19c839=>{const _0x569520=_0x517bc5,_0x4b505a=_0x24838d[_0x569520(0x13d)](_0x571cf2=>{const _0x55f364=_0x569520;_0x571cf2[_0x55f364(0x158)]==_0x19c839[_0x55f364(0x261)]&&(_0x571cf2[_0x55f364(0x22d)]=parseInt(_0x571cf2[_0x55f364(0x22d)])+parseInt(_0x19c839['product_stock']));});}),console[_0x517bc5(0x1be)]('Products\x20find_data',_0x24838d);if(_0x414ff1[0x0]['language']==_0x517bc5(0x22c))var _0x3946a5=users[_0x517bc5(0x1bd)];else{if(_0x414ff1[0x0]['language']==_0x517bc5(0xf7))var _0x3946a5=users[_0x517bc5(0xf7)];else{if(_0x414ff1[0x0][_0x517bc5(0x174)]==_0x517bc5(0x172))var _0x3946a5=users[_0x517bc5(0x172)];else{if(_0x414ff1[0x0]['language']=='Spanish')var _0x3946a5=users['Spanish'];else{if(_0x414ff1[0x0][_0x517bc5(0x174)]=='French')var _0x3946a5=users[_0x517bc5(0x1b5)];else{if(_0x414ff1[0x0][_0x517bc5(0x174)]==_0x517bc5(0x1f6))var _0x3946a5=users[_0x517bc5(0x100)];else{if(_0x414ff1[0x0][_0x517bc5(0x174)]==_0x517bc5(0x14c))var _0x3946a5=users[_0x517bc5(0x14c)];else{if(_0x414ff1[0x0][_0x517bc5(0x174)]==_0x517bc5(0x242))var _0x3946a5=users[_0x517bc5(0x1d8)];}}}}}}}_0x180784[_0x517bc5(0x1ef)](_0x517bc5(0xfc),{'success':_0x4515be[_0x517bc5(0x159)](_0x517bc5(0xe4)),'errors':_0x4515be[_0x517bc5(0x159)](_0x517bc5(0x201)),'alldata':_0x24838d,'profile':_0x3ddeb9,'master_shop':_0x414ff1,'role':_0x325be9,'product_stock':_0xf8acf3,'language':_0x3946a5});}catch(_0xf91bdf){}});async function dataCheck(_0x248c41,_0x528fe2){const _0x214cbc=a0_0x5de9ce,_0x44aeb9=await product[_0x214cbc(0xfb)]([{'$group':{'_id':{'brand':_0x214cbc(0x177),'category':_0x214cbc(0x1f0)},'products':{'$push':{'name':_0x214cbc(0x260),'product_code':_0x214cbc(0x1d5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3712ce=[];_0x3712ce[_0x214cbc(0x19e)]=[];for(let _0x373886=0x0;_0x373886<=_0x44aeb9[_0x214cbc(0x17a)]-0x1;_0x373886++){const _0x3e896b=_0x44aeb9[_0x373886];_0x3712ce[_0x214cbc(0x19e)][_0x214cbc(0x1ba)](_0x3e896b);}const _0x2b8d03=await product[_0x214cbc(0xfb)]([{'$group':{'_id':{'category':_0x214cbc(0x1f0)},'products':{'$push':{'brand':_0x214cbc(0x177),'product_code':_0x214cbc(0x1d5),'product_name':_0x214cbc(0x260)}}}},{'$sort':{'_id.category':-0x1}}]),_0xb6924d=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x248c41,'$lte':_0x528fe2}}},{'$unwind':_0x214cbc(0x1c0)},{'$group':{'_id':{'product_name':_0x214cbc(0x18f),'product_code':'$product.product_code'},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x3712ce['beg_bal']=[];for(let _0x51f2d4=0x0;_0x51f2d4<=_0xb6924d['length']-0x1;_0x51f2d4++){const _0x408b50=_0xb6924d[_0x51f2d4];_0x3712ce[_0x214cbc(0x1b3)][_0x214cbc(0x1ba)](_0x408b50);}const _0x3bd58c=await sales_sa[_0x214cbc(0xfb)]([{'$match':{'date':{'$gte':_0x248c41,'$lte':_0x528fe2}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x214cbc(0x11e)}}},{'$lookup':{'from':_0x214cbc(0x256),'localField':'sales_staff_id','foreignField':_0x214cbc(0x261),'as':_0x214cbc(0x153)}},{'$unwind':_0x214cbc(0x1de)},{'$unwind':_0x214cbc(0x17e)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x214cbc(0x19d)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console[_0x214cbc(0x1be)](_0x3bd58c[0x0]),_0x3712ce[_0x214cbc(0x122)]=[];for(let _0x72335b=0x0;_0x72335b<=_0x3bd58c[_0x214cbc(0x17a)]-0x1;_0x72335b++){const _0x271cb1=_0x3bd58c[_0x72335b];_0x3712ce[_0x214cbc(0x122)][_0x214cbc(0x1ba)](_0x271cb1);}const _0x145dad=await sales_sa[_0x214cbc(0xfb)]([{'$match':{'date':{'$gte':_0x248c41,'$lte':_0x528fe2}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x214cbc(0x11e)}}},{'$lookup':{'from':_0x214cbc(0x256),'localField':_0x214cbc(0x104),'foreignField':_0x214cbc(0x261),'as':_0x214cbc(0x153)}},{'$unwind':'$sales_info'},{'$unwind':_0x214cbc(0x17e)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x214cbc(0x253)}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':'$sale_product.product_code'},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'}}}]);_0x3712ce[_0x214cbc(0x17b)]=[];for(let _0x5d0ed6=0x0;_0x5d0ed6<=_0x145dad[_0x214cbc(0x17a)]-0x1;_0x5d0ed6++){const _0x32b0a5=_0x145dad[_0x5d0ed6];_0x3712ce[_0x214cbc(0x17b)][_0x214cbc(0x1ba)](_0x32b0a5);}let _0x4c0b19='';for(let _0x50fd81=0x0;_0x50fd81<=_0x2b8d03[_0x214cbc(0x17a)]-0x1;_0x50fd81++){const _0x19c4a2=_0x2b8d03[_0x50fd81];_0x4c0b19+='<tr>',_0x4c0b19+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x19c4a2[_0x214cbc(0x261)][_0x214cbc(0x25f)]+_0x214cbc(0x143),_0x4c0b19+=_0x214cbc(0xe8);for(let _0x9117d6=0x0;_0x9117d6<_0x3712ce['cat_brand'][_0x214cbc(0x17a)];_0x9117d6++){const _0x18fd7f=_0x3712ce[_0x214cbc(0x19e)][_0x9117d6];if(_0x18fd7f[_0x214cbc(0x261)]['category']==_0x19c4a2[_0x214cbc(0x261)][_0x214cbc(0x25f)]){let _0x30008a=[],_0x10dd66=[],_0x174da3=[];_0x30008a[_0x18fd7f[_0x214cbc(0x261)][_0x214cbc(0x1c7)]]=[],_0x10dd66[_0x18fd7f['_id'][_0x214cbc(0x1c7)]]=[],_0x174da3[_0x18fd7f[_0x214cbc(0x261)][_0x214cbc(0x1c7)]]=[];var _0x5eb57f=0x0,_0x78a220=0x0,_0xd72b68=0x0;for(let _0x413be5=0x0;_0x413be5<_0x18fd7f[_0x214cbc(0x26d)][_0x214cbc(0x17a)];_0x413be5++){const _0x162b9a=_0x18fd7f[_0x214cbc(0x26d)][_0x413be5];for(let _0x37d43e=0x0;_0x37d43e<=_0x3712ce[_0x214cbc(0x1b3)]['length']-0x1;_0x37d43e++){const _0x4d1704=_0x3712ce[_0x214cbc(0x1b3)][_0x37d43e];_0x4d1704[_0x214cbc(0x261)][_0x214cbc(0x1ea)]==_0x162b9a['name']&&_0x4d1704[_0x214cbc(0x261)][_0x214cbc(0x1f7)]==_0x162b9a[_0x214cbc(0x1f7)]&&(_0x5eb57f+=parseInt(_0x4d1704[_0x214cbc(0x1da)],0xa));}for(let _0x4c00b1=0x0;_0x4c00b1<=_0x3712ce[_0x214cbc(0x17b)][_0x214cbc(0x17a)]-0x1;_0x4c00b1++){const _0x10c9ef=_0x3712ce[_0x214cbc(0x17b)][_0x4c00b1];_0x10c9ef[_0x214cbc(0x261)][_0x214cbc(0x1ea)]==_0x162b9a[_0x214cbc(0x158)]&&_0x10c9ef[_0x214cbc(0x261)][_0x214cbc(0x1f7)]==_0x162b9a['product_code']&&(_0x78a220+=parseFloat(_0x10c9ef[_0x214cbc(0x1da)],0xa)[_0x214cbc(0x1a6)](0x2));}for(let _0x272b93=0x0;_0x272b93<=_0x3712ce[_0x214cbc(0x122)][_0x214cbc(0x17a)]-0x1;_0x272b93++){const _0x525d89=_0x3712ce['sales_bkg'][_0x272b93];_0x525d89[_0x214cbc(0x261)][_0x214cbc(0x1ea)]==_0x162b9a[_0x214cbc(0x158)]&&_0x525d89[_0x214cbc(0x261)]['product_code']==_0x162b9a['product_code']&&(_0xd72b68+=parseInt(_0x525d89[_0x214cbc(0x1da)],0xa));}}const _0x5c766b=new Intl[(_0x214cbc(0x165))](_0x214cbc(0x1ae));var _0x2ac025=_0x5c766b[_0x214cbc(0x20c)](_0x5eb57f);_0x30008a[_0x18fd7f[_0x214cbc(0x261)][_0x214cbc(0x1c7)]][_0x214cbc(0x1ba)](_0x2ac025),_0x10dd66[_0x18fd7f[_0x214cbc(0x261)]['brand']][_0x214cbc(0x1ba)](_0x5c766b[_0x214cbc(0x20c)](_0x78a220)),_0x174da3[_0x18fd7f['_id'][_0x214cbc(0x1c7)]][_0x214cbc(0x1ba)](_0x5c766b[_0x214cbc(0x20c)](_0xd72b68));var _0x5af3e8=_0x5c766b['format'](_0x5eb57f-(_0xd72b68+_0x78a220));_0x4c0b19+=_0x214cbc(0x134),_0x4c0b19+=_0x214cbc(0x1ff),_0x4c0b19+=_0x214cbc(0x26b)+_0x18fd7f['_id'][_0x214cbc(0x1c7)]+_0x214cbc(0x143),_0x4c0b19+=_0x214cbc(0x26b)+_0x30008a[_0x18fd7f[_0x214cbc(0x261)][_0x214cbc(0x1c7)]][0x0]+_0x214cbc(0x143),_0x4c0b19+=_0x214cbc(0x129),_0x4c0b19+=_0x214cbc(0x26b)+_0x174da3[_0x18fd7f[_0x214cbc(0x261)][_0x214cbc(0x1c7)]][0x0]+'</td>',_0x4c0b19+=_0x214cbc(0x26b)+_0x10dd66[_0x18fd7f['_id'][_0x214cbc(0x1c7)]][0x0]+_0x214cbc(0x143),_0x4c0b19+='<td\x20class=\x22row_data\x22>'+_0x5af3e8+_0x214cbc(0x143),_0x4c0b19+=_0x214cbc(0xe8);}}}return console[_0x214cbc(0x1be)](_0x3712ce[_0x214cbc(0x122)]),_0x4c0b19;}router[a0_0x5de9ce(0x20e)]('/balance/pdf',auth,async(_0x2979fe,_0x4c1678)=>{const _0x4586fa=a0_0x5de9ce,{from_date:_0x2743f2,to_date:_0x23d7e9}=_0x2979fe['body'],_0x30aed1=await dataCheck(_0x2743f2,_0x23d7e9);{}let _0x534a3e='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x4eac59=new Date(_0x2743f2),_0x13e24a=new Date(_0x23d7e9);const _0xcb78a6={'year':_0x4586fa(0x1dc),'month':'long','day':'numeric'},_0x229a5c=new Intl[(_0x4586fa(0x10e))]('en-US',_0xcb78a6)[_0x4586fa(0x20c)](_0x4eac59),_0x193cef=new Intl[(_0x4586fa(0x10e))](_0x4586fa(0x1ae),_0xcb78a6)['format'](_0x13e24a);_0x534a3e+=_0x4586fa(0x257),_0x534a3e+=_0x4586fa(0x245),_0x534a3e+=_0x4586fa(0x166)+_0x229a5c+_0x4586fa(0x17d)+_0x193cef+_0x4586fa(0x1eb),_0x534a3e+=_0x4586fa(0x241),_0x534a3e+='<div\x20class=\x22col-sm-11\x22>',_0x534a3e+=_0x4586fa(0xff),_0x534a3e+=_0x4586fa(0x134),_0x534a3e+=_0x4586fa(0x1e5),_0x534a3e+=_0x4586fa(0x212),_0x534a3e+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x229a5c+_0x4586fa(0x1a8),_0x534a3e+=_0x4586fa(0x1b1),_0x534a3e+='<th\x20colspan=\x272\x27>SOLD</th>',_0x534a3e+=_0x4586fa(0x11b)+_0x193cef+'</th>',_0x534a3e+=_0x4586fa(0xe8),_0x534a3e+=_0x4586fa(0x134),_0x534a3e+=_0x4586fa(0x146),_0x534a3e+=_0x4586fa(0x114),_0x534a3e+=_0x4586fa(0xe8),_0x534a3e+=_0x30aed1,_0x534a3e+='</table>',_0x534a3e+=_0x4586fa(0x1d9),_0x534a3e+=_0x4586fa(0x1d9);const _0x4b5c87={'format':_0x4586fa(0x12b),'orientation':_0x4586fa(0x173),'childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf[_0x4586fa(0x218)](_0x534a3e,_0x4b5c87)[_0x4586fa(0x171)](function(_0x8d8fc0,_0x55d037){const _0x1b48e6=_0x4586fa;if(_0x8d8fc0){_0x4c1678[_0x1b48e6(0x1e8)](0x1f4)[_0x1b48e6(0x194)](_0x1b48e6(0x228));return;}_0x4c1678[_0x1b48e6(0x160)]('Content-Type',_0x1b48e6(0x259)),_0x55d037[_0x1b48e6(0x255)](_0x4c1678);});}),router[a0_0x5de9ce(0x15e)](a0_0x5de9ce(0x1af),auth,async(_0x4bc9c0,_0x56f5a7)=>{const _0x1ed67e=a0_0x5de9ce;try{const {username:_0x4a6c95,email:_0x42ac64,role:_0xb945cd}=_0x4bc9c0[_0x1ed67e(0x1f3)],_0x5b6c1b=_0x4bc9c0['user'],_0x3fdd43=await profile['findOne']({'email':_0x5b6c1b[_0x1ed67e(0x10d)]}),_0x25d99a={'year':_0x1ed67e(0x1dc),'month':_0x1ed67e(0x223),'day':_0x1ed67e(0x1dc)},_0x170289=await master_shop[_0x1ed67e(0xe9)](),_0x84d7b1=await product['find'](),_0x2e4c33=await warehouse[_0x1ed67e(0xfb)]([{'$unwind':_0x1ed67e(0x119)},{'$lookup':{'from':_0x1ed67e(0x26d),'localField':_0x1ed67e(0x1b7),'foreignField':_0x1ed67e(0x158),'as':_0x1ed67e(0x140)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x1ed67e(0x137)}},{'$group':{'_id':_0x1ed67e(0x1cd),'product_stock':{'$sum':_0x1ed67e(0x267)}}}]);if(_0x170289[0x0][_0x1ed67e(0x174)]==_0x1ed67e(0x22c))var _0x4494ac=users['English'];else{if(_0x170289[0x0][_0x1ed67e(0x174)]==_0x1ed67e(0xf7))var _0x4494ac=users['Hindi'];else{if(_0x170289[0x0][_0x1ed67e(0x174)]==_0x1ed67e(0x172))var _0x4494ac=users[_0x1ed67e(0x172)];else{if(_0x170289[0x0][_0x1ed67e(0x174)]==_0x1ed67e(0x221))var _0x4494ac=users[_0x1ed67e(0x221)];else{if(_0x170289[0x0][_0x1ed67e(0x174)]==_0x1ed67e(0x1b5))var _0x4494ac=users[_0x1ed67e(0x1b5)];else{if(_0x170289[0x0][_0x1ed67e(0x174)]==_0x1ed67e(0x1f6))var _0x4494ac=users[_0x1ed67e(0x100)];else{if(_0x170289[0x0][_0x1ed67e(0x174)]==_0x1ed67e(0x14c))var _0x4494ac=users[_0x1ed67e(0x14c)];else{if(_0x170289[0x0][_0x1ed67e(0x174)]=='Arabic\x20(ae)')var _0x4494ac=users[_0x1ed67e(0x1d8)];}}}}}}}_0x56f5a7[_0x1ed67e(0x1ef)](_0x1ed67e(0x11f),{'success':_0x4bc9c0[_0x1ed67e(0x159)](_0x1ed67e(0xe4)),'errors':_0x4bc9c0['flash'](_0x1ed67e(0x201)),'alldata':_0x84d7b1,'profile':_0x3fdd43,'master_shop':_0x170289,'role':_0x5b6c1b,'product_stock':_0x2e4c33,'language':_0x4494ac});}catch(_0x54b02c){}});async function agentsdataCheck(_0x2c74f2,_0x4a7db3){const _0x22dbe5=a0_0x5de9ce,_0x24c6c2=await product[_0x22dbe5(0xfb)]([{'$group':{'_id':{'brand':_0x22dbe5(0x177),'category':_0x22dbe5(0x1f0)},'products':{'$push':{'name':_0x22dbe5(0x260),'product_code':_0x22dbe5(0x1d5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x27493c=[];_0x27493c[_0x22dbe5(0x19e)]=[];for(let _0x39695f=0x0;_0x39695f<=_0x24c6c2[_0x22dbe5(0x17a)]-0x1;_0x39695f++){const _0x38d487=_0x24c6c2[_0x39695f];_0x27493c[_0x22dbe5(0x19e)][_0x22dbe5(0x1ba)](_0x38d487);}const _0x599183=await product['aggregate']([{'$group':{'_id':{'category':_0x22dbe5(0x1f0)},'products':{'$push':{'brand':_0x22dbe5(0x177),'product_code':_0x22dbe5(0x1d5),'product_name':_0x22dbe5(0x260)}}}},{'$sort':{'_id.category':-0x1}}]),_0x40132c=await product[_0x22dbe5(0xfb)]([{'$group':{'_id':{'category':_0x22dbe5(0x1f0),'brand':_0x22dbe5(0x177)}}},{'$group':{'_id':_0x22dbe5(0x1aa),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4497b4=await sales_sa[_0x22dbe5(0xfb)]([{'$match':{'date':{'$gte':_0x2c74f2,'$lte':_0x4a7db3}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x22dbe5(0x11e)}}},{'$lookup':{'from':'staffs','localField':_0x22dbe5(0x104),'foreignField':_0x22dbe5(0x261),'as':_0x22dbe5(0x153)}},{'$unwind':'$sales_info'},{'$unwind':_0x22dbe5(0x17e)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x22dbe5(0x253)}},{'$lookup':{'from':'products','localField':_0x22dbe5(0x142),'foreignField':'product_code','as':_0x22dbe5(0x263)}},{'$unwind':_0x22dbe5(0x264)},{'$group':{'_id':{'sales_id':_0x22dbe5(0x148),'category':_0x22dbe5(0x150),'brand':'$product_info.brand'},'salesman_data':{'$first':'$sales_info.name'},'totalQTY':{'$sum':_0x22dbe5(0x240)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','product_details':{'prod_name':_0x22dbe5(0x1d6),'product_code':_0x22dbe5(0x11a),'category':_0x22dbe5(0x150),'brand':_0x22dbe5(0x111)}}}}}]);let _0x334ac6='';_0x334ac6+=_0x22dbe5(0x134),_0x334ac6+='<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x334ac6+=_0x22dbe5(0xe8),_0x334ac6+='<tr>',_0x334ac6+=_0x22dbe5(0x214);for(let _0x5e06d8=0x0;_0x5e06d8<=_0x599183['length']-0x1;_0x5e06d8++){const _0x4c6dd8=_0x599183[_0x5e06d8];for(let _0x1ca560=0x0;_0x1ca560<_0x40132c[_0x22dbe5(0x17a)];_0x1ca560++){const _0x54b85c=_0x40132c[_0x1ca560];_0x54b85c[_0x22dbe5(0x261)]==_0x4c6dd8[_0x22dbe5(0x261)][_0x22dbe5(0x25f)]&&(_0x334ac6+=_0x22dbe5(0x229)+_0x54b85c[_0x22dbe5(0x1fa)]+_0x22dbe5(0x13a)+_0x4c6dd8[_0x22dbe5(0x261)]['category']+_0x22dbe5(0x143));}}_0x334ac6+=_0x22dbe5(0x214),_0x334ac6+='</tr>',_0x334ac6+='<tr>',_0x334ac6+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>';for(let _0x378795=0x0;_0x378795<=_0x599183['length']-0x1;_0x378795++){const _0x5998ae=_0x599183[_0x378795];for(let _0x3f462b=0x0;_0x3f462b<_0x27493c[_0x22dbe5(0x19e)][_0x22dbe5(0x17a)];_0x3f462b++){const _0xdce70a=_0x27493c[_0x22dbe5(0x19e)][_0x3f462b];_0xdce70a['_id'][_0x22dbe5(0x25f)]==_0x5998ae['_id'][_0x22dbe5(0x25f)]&&(_0x334ac6+='<td\x20class=\x22cat_data\x22>'+_0xdce70a[_0x22dbe5(0x261)][_0x22dbe5(0x1c7)]+_0x22dbe5(0x143));}}_0x334ac6+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x334ac6+=_0x22dbe5(0xe8);let _0x1718f2={'name':[],'dataqty':{}};for(let _0x128c28=0x0;_0x128c28<_0x27493c['cat_brand'][_0x22dbe5(0x17a)];_0x128c28++){const _0x3f1453=_0x27493c[_0x22dbe5(0x19e)][_0x128c28],_0x187d30=_0x3f1453[_0x22dbe5(0x261)]['brand'],_0x123dcf=_0x3f1453['_id'][_0x22dbe5(0x25f)];!_0x1718f2['dataqty'][_0x187d30]&&(_0x1718f2[_0x22dbe5(0x1b4)][_0x187d30]={});!_0x1718f2[_0x22dbe5(0x1b4)][_0x187d30][_0x123dcf]&&(_0x1718f2[_0x22dbe5(0x1b4)][_0x187d30][_0x123dcf]=[]);for(let _0x2408f0=0x0;_0x2408f0<_0x4497b4['length'];_0x2408f0++){const _0x3631ae=_0x4497b4[_0x2408f0];if(_0x187d30===_0x3631ae[_0x22dbe5(0x261)][_0x22dbe5(0x1c7)]&&_0x123dcf===_0x3631ae['_id'][_0x22dbe5(0x25f)]){const _0xf1182d=_0x3631ae[_0x22dbe5(0x26a)];!_0x1718f2[_0x22dbe5(0x1b4)][_0x187d30][_0x123dcf][_0xf1182d]&&(_0x1718f2[_0x22dbe5(0x1b4)][_0x187d30][_0x123dcf][_0xf1182d]=[]),_0x1718f2[_0x22dbe5(0x1b4)][_0x187d30][_0x123dcf][_0xf1182d][_0x22dbe5(0x1ba)](_0x3631ae[_0x22dbe5(0x1da)]),!_0x1718f2[_0x22dbe5(0x158)][_0x22dbe5(0x252)](_0xf1182d)&&_0x1718f2['name'][_0x22dbe5(0x1ba)](_0xf1182d);}}}_0x334ac6+=_0x22dbe5(0x134);for(let _0x5674be=0x0;_0x5674be<=_0x1718f2['name']['length']-0x1;_0x5674be++){const _0x2083c6=_0x1718f2[_0x22dbe5(0x158)][_0x5674be];_0x334ac6+=_0x22dbe5(0x26b)+_0x2083c6+_0x22dbe5(0x143);var _0x50c7fd=0x0,_0x5c6277=0x0;for(let _0x5e0e85=0x0;_0x5e0e85<=_0x27493c[_0x22dbe5(0x19e)][_0x22dbe5(0x17a)]-0x1;_0x5e0e85++){const _0x46498c=_0x27493c[_0x22dbe5(0x19e)][_0x5e0e85];var _0x366cff=0x0;_0x1718f2[_0x22dbe5(0x1b4)][_0x46498c[_0x22dbe5(0x261)]['brand']][_0x46498c[_0x22dbe5(0x261)][_0x22dbe5(0x25f)]][_0x2083c6]?(_0x366cff=_0x1718f2[_0x22dbe5(0x1b4)][_0x46498c[_0x22dbe5(0x261)][_0x22dbe5(0x1c7)]][_0x46498c[_0x22dbe5(0x261)]['category']][_0x2083c6][0x0],_0x334ac6+=_0x22dbe5(0x26b)+formatNumber(_0x366cff[_0x22dbe5(0x1a6)](0x2))+_0x22dbe5(0x143)):(_0x366cff=0x0,_0x334ac6+=_0x22dbe5(0x26b)+_0x366cff+_0x22dbe5(0x143)),_0x50c7fd+=_0x366cff;}_0x334ac6+=_0x22dbe5(0x26b)+formatNumber(_0x50c7fd[_0x22dbe5(0x1a6)](0x2))+_0x22dbe5(0x143);}return _0x334ac6+='</tr>',_0x334ac6;}router['post']('/agent/pdf',auth,async(_0x4afce7,_0x2583ef)=>{const _0x39a1e4=a0_0x5de9ce,{from_date:_0x1ca8c2,to_date:_0x1aaafe}=_0x4afce7[_0x39a1e4(0x18d)],_0x3d2de5=await agentsdataCheck(_0x1ca8c2,_0x1aaafe);{}let _0x5dfba3=_0x39a1e4(0x220);var _0x30e163=new Date(_0x1ca8c2),_0x505ff5=new Date(_0x1aaafe);const _0x300bff={'year':'numeric','month':'long','day':_0x39a1e4(0x1dc)},_0x272ccb=new Intl[(_0x39a1e4(0x10e))]('en-US',_0x300bff)[_0x39a1e4(0x20c)](_0x30e163),_0x21195b=new Intl[(_0x39a1e4(0x10e))](_0x39a1e4(0x1ae),_0x300bff)[_0x39a1e4(0x20c)](_0x505ff5);_0x5dfba3+=_0x39a1e4(0x257),_0x5dfba3+=_0x39a1e4(0x10c),_0x5dfba3+='<p>'+_0x272ccb+_0x39a1e4(0x17d)+_0x21195b+_0x39a1e4(0x1eb),_0x5dfba3+=_0x39a1e4(0x241),_0x5dfba3+=_0x39a1e4(0x248),_0x5dfba3+='<table>',_0x5dfba3+=_0x3d2de5,_0x5dfba3+='</table>',_0x5dfba3+=_0x39a1e4(0x1d9),_0x5dfba3+='</div>';const _0x112d51={'format':_0x39a1e4(0x12b),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf[_0x39a1e4(0x218)](_0x5dfba3,_0x112d51)[_0x39a1e4(0x171)](function(_0x460dbf,_0x52ea69){const _0x3df6d1=_0x39a1e4;if(_0x460dbf){_0x2583ef[_0x3df6d1(0x1e8)](0x1f4)[_0x3df6d1(0x194)]('Error\x20generating\x20PDF');return;}_0x2583ef['setHeader'](_0x3df6d1(0x25a),_0x3df6d1(0x259)),_0x52ea69['pipe'](_0x2583ef);});}),router['get']('/agent_reports/sales_ad',auth,async(_0x41b13d,_0x290985)=>{const _0x320404=a0_0x5de9ce;try{const {username:_0x4e43c2,email:_0x864c50,role:_0x5bcafb}=_0x41b13d[_0x320404(0x1f3)],_0x24cb6f=_0x41b13d['user'],_0x20073d=await profile['findOne']({'email':_0x24cb6f[_0x320404(0x10d)]}),_0x2dddb5={'year':'numeric','month':_0x320404(0x223),'day':'numeric'},_0x1604ba=await master_shop[_0x320404(0xe9)](),_0x5ae6bb=await staff[_0x320404(0x24c)]({'email':_0x24cb6f['email']}),_0x5e12da=await product['find'](),_0x4ae64b=await warehouse['aggregate']([{'$unwind':_0x320404(0x119)},{'$lookup':{'from':_0x320404(0x26d),'localField':_0x320404(0x1b7),'foreignField':'name','as':_0x320404(0x140)}},{'$unwind':_0x320404(0x139)},{'$project':{'product_name':_0x320404(0x1c5),'product_stock':_0x320404(0x137)}},{'$group':{'_id':_0x320404(0x1cd),'product_stock':{'$sum':_0x320404(0x267)}}}]),_0x5a801b=await staff[_0x320404(0xe9)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x1604ba[0x0][_0x320404(0x174)]=='English\x20(US)')var _0x7663c9=users['English'];else{if(_0x1604ba[0x0][_0x320404(0x174)]==_0x320404(0xf7))var _0x7663c9=users[_0x320404(0xf7)];else{if(_0x1604ba[0x0]['language']==_0x320404(0x172))var _0x7663c9=users[_0x320404(0x172)];else{if(_0x1604ba[0x0][_0x320404(0x174)]=='Spanish')var _0x7663c9=users['Spanish'];else{if(_0x1604ba[0x0][_0x320404(0x174)]==_0x320404(0x1b5))var _0x7663c9=users[_0x320404(0x1b5)];else{if(_0x1604ba[0x0][_0x320404(0x174)]==_0x320404(0x1f6))var _0x7663c9=users[_0x320404(0x100)];else{if(_0x1604ba[0x0]['language']==_0x320404(0x14c))var _0x7663c9=users[_0x320404(0x14c)];else{if(_0x1604ba[0x0][_0x320404(0x174)]=='Arabic\x20(ae)')var _0x7663c9=users[_0x320404(0x1d8)];}}}}}}}_0x290985['render'](_0x320404(0x1db),{'success':_0x41b13d[_0x320404(0x159)](_0x320404(0xe4)),'errors':_0x41b13d[_0x320404(0x159)](_0x320404(0x201)),'alldata':_0x5e12da,'profile':_0x20073d,'master_shop':_0x1604ba,'role':_0x24cb6f,'product_stock':_0x4ae64b,'language':_0x7663c9,'staff_arr':_0x5ae6bb,'staff_data_all':_0x5a801b});}catch(_0x1df768){_0x290985[_0x320404(0x118)](_0x1df768);}});async function agentsdataDSICheck_admin(_0x5f3a0c,_0x3354d8,_0x296d63,_0x29ae18){const _0x52f178=a0_0x5de9ce,_0x2d8209=await product[_0x52f178(0xfb)]([{'$group':{'_id':{'brand':'$brand','category':_0x52f178(0x1f0)},'products':{'$push':{'name':_0x52f178(0x260),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x33388d=[];_0x33388d[_0x52f178(0x19e)]=[];for(let _0x15fe7b=0x0;_0x15fe7b<=_0x2d8209[_0x52f178(0x17a)]-0x1;_0x15fe7b++){const _0x32c455=_0x2d8209[_0x15fe7b];_0x33388d[_0x52f178(0x19e)][_0x52f178(0x1ba)](_0x32c455);}const _0x1b00c1=await product[_0x52f178(0xfb)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x52f178(0x1d5),'product_name':_0x52f178(0x260)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1f8f5f=await product['aggregate']([{'$group':{'_id':{'category':_0x52f178(0x1f0),'brand':'$brand'}}},{'$group':{'_id':_0x52f178(0x1aa),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x43c807=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x5f3a0c,'$lte':_0x3354d8},'sales_staff_id':_0x296d63,'sale_product.isFG':_0x52f178(0x253)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x52f178(0x253)}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0x52f178(0x1f7),'as':_0x52f178(0x263)}},{'$unwind':_0x52f178(0x264)},{'$group':{'_id':{'dsi':_0x52f178(0xfe),'date':_0x52f178(0x106),'customer':'$customer'},'totalQty':{'$sum':_0x52f178(0x240)},'products':{'$push':{'qty':_0x52f178(0x240),'NetPrice':'$sale_product.totalprice','discount':_0x52f178(0x164),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x52f178(0x1d6),'product_code':_0x52f178(0x11a),'category':_0x52f178(0x150),'brand':'$product_info.brand','gross_price':_0x52f178(0x162)}}}}},{'$unwind':_0x52f178(0x179)},{'$group':{'_id':{'dsi':_0x52f178(0x1df),'date':_0x52f178(0x155),'customer':_0x52f178(0xfa),'category':_0x52f178(0x102),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x52f178(0x1ec)},'totalGross':{'$sum':{'$multiply':[_0x52f178(0x1ec),_0x52f178(0x1e7)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x52f178(0x15f)},'product_details':{'$first':_0x52f178(0xeb)}}},{'$group':{'_id':{'dsi':_0x52f178(0x1df),'date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':_0x52f178(0x12f)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x52f178(0x266)},'products':{'$push':{'qty':_0x52f178(0x12f),'category':'$_id.category','brand':_0x52f178(0x1ed),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x16f17e=[],_0x5c56cd={},_0x5236d5={},_0x3fac1c={};var _0xaa0646=0x0,_0x3feb98=0x0,_0x5e0afc=0x0,_0x398c7f=0x0,_0x4a8f70=0x0;const _0x1a234c=0x6;for(let _0x17d0af=0x0;_0x17d0af<=_0x43c807[_0x52f178(0x17a)]-0x1;_0x17d0af++){const _0x1df0e8=_0x43c807[_0x17d0af];let _0x28e28f=_0x52f178(0x134);_0x28e28f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1df0e8[_0x52f178(0x261)][_0x52f178(0x25b)]+_0x52f178(0x143),_0x28e28f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1df0e8[_0x52f178(0x261)][_0x52f178(0x1bc)]+_0x52f178(0x143),_0x28e28f+=_0x52f178(0x210)+_0x1df0e8['_id'][_0x52f178(0x186)]+_0x52f178(0x143);let _0x39b1fe={};var _0x508262=0x0;for(let _0x259953=0x0;_0x259953<=_0x1df0e8[_0x52f178(0x26d)][_0x52f178(0x17a)]-0x1;_0x259953++){const _0x19363f=_0x1df0e8[_0x52f178(0x26d)][_0x259953];_0x39b1fe[_0x19363f[_0x52f178(0x1c7)]+'-'+_0x19363f['category']]=_0x19363f[_0x52f178(0x269)];const _0x46f145=_0x19363f[_0x52f178(0x1c7)]+'-'+_0x19363f['category'];!_0x5c56cd[_0x46f145]&&(_0x5c56cd[_0x46f145]=0x0),!Array[_0x52f178(0x11d)](_0x3fac1c[_0x46f145])&&(_0x3fac1c[_0x46f145]=[]),!Array['isArray'](_0x3fac1c[_0x46f145])&&(_0x3fac1c[_0x46f145]=[]),_0x5c56cd[_0x46f145]+=_0x19363f[_0x52f178(0x269)],_0x3fac1c[_0x46f145][_0x52f178(0x1ba)](_0x19363f[_0x52f178(0x269)]),_0x508262++;}console[_0x52f178(0x1be)](_0x1df0e8);for(let _0x3bb53d=0x0;_0x3bb53d<=_0x33388d['cat_brand'][_0x52f178(0x17a)]-0x1;_0x3bb53d++){const _0x15151a=_0x33388d[_0x52f178(0x19e)][_0x3bb53d],_0x2162a4=_0x15151a[_0x52f178(0x261)][_0x52f178(0x1c7)]+'-'+_0x15151a[_0x52f178(0x261)][_0x52f178(0x25f)];_0x28e28f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x39b1fe[_0x2162a4]!==undefined?_0x39b1fe[_0x2162a4][_0x52f178(0x1a6)](0x2):'')+_0x52f178(0x143);}_0x5e0afc=_0x1df0e8[_0x52f178(0x198)]+_0x1df0e8['adj_discount'],_0x28e28f+=_0x52f178(0x13e)+formatNumber(parseFloat(_0x1df0e8[_0x52f178(0x16f)],0x2)[_0x52f178(0x1a6)](0x2))+_0x52f178(0x143),_0x28e28f+=_0x52f178(0x13e)+formatNumber(_0x1df0e8[_0x52f178(0x230)][_0x52f178(0x1a6)](0x2))+_0x52f178(0x143),_0x28e28f+=_0x52f178(0x13e)+formatNumber(_0x5e0afc)+_0x52f178(0x143),_0x28e28f+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x1df0e8[_0x52f178(0x1ce)]['toFixed'](0x2))+_0x52f178(0x143),_0x28e28f+=_0x52f178(0xe8),_0xaa0646+=parseFloat(_0x1df0e8[_0x52f178(0x16f)]['toFixed'](0x2)),_0x3feb98+=parseFloat(_0x1df0e8[_0x52f178(0x1ce)][_0x52f178(0x1a6)](0x2)),_0x398c7f+=_0x5e0afc,_0x4a8f70+=parseFloat(_0x1df0e8[_0x52f178(0x230)]['toFixed'](0x2));if(_0x17d0af==_0x43c807[_0x52f178(0x17a)]-0x1){_0x28e28f+=_0x52f178(0x134),_0x28e28f+=_0x52f178(0x15d),_0x28e28f+=_0x52f178(0x143);for(let _0x1cde20=0x0;_0x1cde20<=_0x33388d[_0x52f178(0x19e)][_0x52f178(0x17a)]-0x1;_0x1cde20++){const _0x18d86f=_0x33388d[_0x52f178(0x19e)][_0x1cde20],_0x427730=_0x18d86f[_0x52f178(0x261)]['brand']+'-'+_0x18d86f[_0x52f178(0x261)]['category'],_0x39ba12=_0x3fac1c[_0x427730][_0x52f178(0x190)]((_0x5d292e,_0x1743a1)=>_0x5d292e+_0x1743a1,0x0);console[_0x52f178(0x1be)](_0x52f178(0x168),_0x427730),_0x28e28f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x39ba12!==undefined?formatNumber(_0x39ba12[_0x52f178(0x1a6)](0x2)):'')+_0x52f178(0x101),console[_0x52f178(0x1be)](_0x3fac1c[_0x427730][_0x52f178(0x190)]((_0xfdda08,_0x1ea39a)=>_0xfdda08+_0x1ea39a,0x0));}_0x28e28f+=_0x52f178(0xed)+formatNumber(_0xaa0646['toFixed'](0x2))+_0x52f178(0x101),_0x28e28f+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4a8f70)+'</b></td>',_0x28e28f+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x398c7f)+_0x52f178(0x101),_0x28e28f+=_0x52f178(0xed)+formatNumber(_0x3feb98)+_0x52f178(0x101),_0x28e28f+='</tr>';}_0x16f17e[_0x52f178(0x1ba)](_0x28e28f);}function _0x165d76(_0x359a36,_0x50a89d){const _0x443ea5=_0x52f178,_0x5116ce=[];for(let _0x4ae5ab=0x0;_0x4ae5ab<=_0x359a36[_0x443ea5(0x17a)]-0x1;_0x4ae5ab+=_0x50a89d){_0x5116ce[_0x443ea5(0x1ba)](_0x359a36[_0x443ea5(0x1e6)](_0x4ae5ab,_0x4ae5ab+_0x50a89d));}return _0x5116ce;}const _0x59ad81=_0x165d76(_0x16f17e,_0x1a234c);let _0x26a33a='';return _0x59ad81[_0x52f178(0x187)]((_0x272422,_0x382bf8)=>{const _0x324639=_0x52f178;_0x382bf8>0x0&&(_0x26a33a+=_0x324639(0x12a));_0x26a33a+='<table>',_0x26a33a+='<thead>',_0x26a33a+=_0x324639(0x134),_0x26a33a+=_0x324639(0x18b),_0x26a33a+=_0x324639(0xe8),_0x26a33a+=_0x324639(0x134),_0x26a33a+=_0x324639(0x209);for(let _0x4ef2f8=0x0;_0x4ef2f8<=_0x1b00c1[_0x324639(0x17a)]-0x1;_0x4ef2f8++){const _0x1229b2=_0x1b00c1[_0x4ef2f8];for(let _0x16b333=0x0;_0x16b333<_0x1f8f5f[_0x324639(0x17a)];_0x16b333++){const _0xc2f565=_0x1f8f5f[_0x16b333];_0xc2f565[_0x324639(0x261)]===_0x1229b2['_id'][_0x324639(0x25f)]&&(_0x26a33a+=_0x324639(0x229)+_0xc2f565[_0x324639(0x1fa)]+'\x22\x20class=\x22cat_data\x22>'+_0x1229b2[_0x324639(0x261)]['category']+_0x324639(0x143));}}_0x26a33a+=_0x324639(0x208),_0x26a33a+='</tr>',_0x26a33a+=_0x324639(0x134),_0x26a33a+=_0x324639(0x1d1),_0x26a33a+=_0x324639(0x1c1),_0x26a33a+=_0x324639(0x154);for(let _0x4ac977=0x0;_0x4ac977<=_0x1b00c1[_0x324639(0x17a)]-0x1;_0x4ac977++){const _0xf6fb47=_0x1b00c1[_0x4ac977];for(let _0x11b267=0x0;_0x11b267<_0x33388d[_0x324639(0x19e)][_0x324639(0x17a)];_0x11b267++){const _0x44a8e9=_0x33388d[_0x324639(0x19e)][_0x11b267];_0x44a8e9[_0x324639(0x261)][_0x324639(0x25f)]===_0xf6fb47[_0x324639(0x261)][_0x324639(0x25f)]&&(_0x26a33a+=_0x324639(0x16e)+_0x44a8e9['_id'][_0x324639(0x1c7)]+'</td>');}}_0x26a33a+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x26a33a+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x26a33a+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x26a33a+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x26a33a+='</tr>',_0x26a33a+=_0x324639(0x144),_0x26a33a+='<tbody>',_0x272422[_0x324639(0x187)](_0x8a3a19=>{_0x26a33a+=_0x8a3a19;}),console[_0x324639(0x1be)](_0x3fac1c),_0x26a33a+=_0x324639(0x103),_0x26a33a+=_0x324639(0x196);}),_0x26a33a;}async function agentsdataDSICheck_admin_excel(_0x533f65,_0x153e70,_0x12426d,_0x4281fe){const _0x45d802=a0_0x5de9ce,_0x518410=await product[_0x45d802(0xfb)]([{'$group':{'_id':{'brand':'$brand','category':_0x45d802(0x1f0)},'products':{'$push':{'name':_0x45d802(0x260),'product_code':_0x45d802(0x1d5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xe43e11=[];_0xe43e11['cat_brand']=[];for(let _0x54b94b=0x0;_0x54b94b<=_0x518410[_0x45d802(0x17a)]-0x1;_0x54b94b++){const _0x22c920=_0x518410[_0x54b94b];_0xe43e11[_0x45d802(0x19e)][_0x45d802(0x1ba)](_0x22c920);}const _0x268a2c=await product[_0x45d802(0xfb)]([{'$group':{'_id':{'category':_0x45d802(0x1f0)},'products':{'$push':{'brand':_0x45d802(0x177),'product_code':_0x45d802(0x1d5),'product_name':_0x45d802(0x260)}}}},{'$sort':{'_id.category':-0x1}}]),_0xaa6362=await product[_0x45d802(0xfb)]([{'$group':{'_id':{'category':_0x45d802(0x1f0),'brand':_0x45d802(0x177)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1d55df=await sales_sa[_0x45d802(0xfb)]([{'$match':{'date':{'$gte':_0x533f65,'$lte':_0x153e70},'sales_staff_id':_0x12426d,'sale_product.isFG':'false'}},{'$unwind':_0x45d802(0x17e)},{'$match':{'sale_product.isFG':_0x45d802(0x253)}},{'$lookup':{'from':_0x45d802(0x26d),'localField':_0x45d802(0x142),'foreignField':_0x45d802(0x1f7),'as':_0x45d802(0x263)}},{'$unwind':_0x45d802(0x264)},{'$group':{'_id':{'dsi':_0x45d802(0xfe),'date':_0x45d802(0x106),'customer':'$customer'},'totalQty':{'$sum':_0x45d802(0x240)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x45d802(0x164),'adj_discount':_0x45d802(0x182),'product_details':{'prod_name':'$product_info.name','product_code':_0x45d802(0x11a),'category':_0x45d802(0x150),'brand':_0x45d802(0x111),'gross_price':_0x45d802(0x162)}}}}},{'$unwind':_0x45d802(0x179)},{'$group':{'_id':{'dsi':_0x45d802(0x1df),'date':'$_id.date','customer':_0x45d802(0xfa),'category':_0x45d802(0x102),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x45d802(0x1ec)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x45d802(0x1e7)]}},'NetPrice':{'$sum':_0x45d802(0x1e2)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x45d802(0xeb)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x45d802(0x155),'customer':'$_id.customer'},'totalQty':{'$sum':_0x45d802(0x12f)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x45d802(0x266)},'products':{'$push':{'qty':_0x45d802(0x12f),'category':_0x45d802(0x1aa),'brand':_0x45d802(0x1ed),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4c93a2=[],_0x1d985b={},_0x1eeb9={},_0x513e84={};var _0x81fcf5=0x0,_0x372dc5=0x0,_0xab1e6f=0x0,_0x53486f=0x0,_0x46979b=0x0;const _0x20368e=0x16345785d8a0000;for(let _0x482899=0x0;_0x482899<=_0x1d55df[_0x45d802(0x17a)]-0x1;_0x482899++){const _0x17e8b3=_0x1d55df[_0x482899];let _0x35624e='<tr>';_0x35624e+=_0x45d802(0x210)+_0x17e8b3[_0x45d802(0x261)][_0x45d802(0x25b)]+'</td>',_0x35624e+=_0x45d802(0x210)+_0x17e8b3['_id'][_0x45d802(0x1bc)]+'</td>',_0x35624e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x17e8b3['_id'][_0x45d802(0x186)]+_0x45d802(0x143);let _0x314cf7={};var _0x2462e0=0x0;for(let _0x546179=0x0;_0x546179<=_0x17e8b3[_0x45d802(0x26d)][_0x45d802(0x17a)]-0x1;_0x546179++){const _0x322d9c=_0x17e8b3['products'][_0x546179];_0x314cf7[_0x322d9c[_0x45d802(0x1c7)]+'-'+_0x322d9c['category']]=_0x322d9c[_0x45d802(0x269)];const _0x40c63b=_0x322d9c[_0x45d802(0x1c7)]+'-'+_0x322d9c[_0x45d802(0x25f)];!_0x1d985b[_0x40c63b]&&(_0x1d985b[_0x40c63b]=0x0),!Array['isArray'](_0x513e84[_0x40c63b])&&(_0x513e84[_0x40c63b]=[]),!Array[_0x45d802(0x11d)](_0x513e84[_0x40c63b])&&(_0x513e84[_0x40c63b]=[]),_0x1d985b[_0x40c63b]+=_0x322d9c[_0x45d802(0x269)],_0x513e84[_0x40c63b][_0x45d802(0x1ba)](_0x322d9c[_0x45d802(0x269)]),_0x2462e0++;}console['log'](_0x17e8b3);for(let _0x3de33e=0x0;_0x3de33e<=_0xe43e11[_0x45d802(0x19e)][_0x45d802(0x17a)]-0x1;_0x3de33e++){const _0x23e511=_0xe43e11['cat_brand'][_0x3de33e],_0x28f63b=_0x23e511[_0x45d802(0x261)][_0x45d802(0x1c7)]+'-'+_0x23e511[_0x45d802(0x261)][_0x45d802(0x25f)];_0x35624e+=_0x45d802(0x131)+(_0x314cf7[_0x28f63b]!==undefined?_0x314cf7[_0x28f63b][_0x45d802(0x1a6)](0x2):'')+_0x45d802(0x143);}_0xab1e6f=_0x17e8b3['discount']+_0x17e8b3[_0x45d802(0x1a7)],_0x35624e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x17e8b3[_0x45d802(0x16f)],0x2)['toFixed'](0x2))+_0x45d802(0x143),_0x35624e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x17e8b3[_0x45d802(0x230)]['toFixed'](0x2))+_0x45d802(0x143),_0x35624e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xab1e6f)+_0x45d802(0x143),_0x35624e+=_0x45d802(0x13e)+formatNumber(_0x17e8b3['NetPrice'][_0x45d802(0x1a6)](0x2))+_0x45d802(0x143),_0x35624e+=_0x45d802(0xe8),_0x81fcf5+=parseFloat(_0x17e8b3[_0x45d802(0x16f)][_0x45d802(0x1a6)](0x2)),_0x372dc5+=parseFloat(_0x17e8b3[_0x45d802(0x1ce)][_0x45d802(0x1a6)](0x2)),_0x53486f+=_0xab1e6f,_0x46979b+=parseFloat(_0x17e8b3['totalGross'][_0x45d802(0x1a6)](0x2));if(_0x482899==_0x1d55df[_0x45d802(0x17a)]-0x1){_0x35624e+=_0x45d802(0x134),_0x35624e+=_0x45d802(0x15d),_0x35624e+='</td>';for(let _0x3278a3=0x0;_0x3278a3<=_0xe43e11[_0x45d802(0x19e)]['length']-0x1;_0x3278a3++){const _0x3d4aae=_0xe43e11[_0x45d802(0x19e)][_0x3278a3],_0x26af3e=_0x3d4aae['_id'][_0x45d802(0x1c7)]+'-'+_0x3d4aae['_id'][_0x45d802(0x25f)],_0x11e363=_0x513e84[_0x26af3e][_0x45d802(0x190)]((_0x1ca0d9,_0x4c4d88)=>_0x1ca0d9+_0x4c4d88,0x0);console['log']('test',_0x26af3e),_0x35624e+=_0x45d802(0x1a2)+(_0x11e363!==undefined?formatNumber(_0x11e363[_0x45d802(0x1a6)](0x2)):'')+_0x45d802(0x101),console[_0x45d802(0x1be)](_0x513e84[_0x26af3e][_0x45d802(0x190)]((_0x3c0f2a,_0x59fc6a)=>_0x3c0f2a+_0x59fc6a,0x0));}_0x35624e+=_0x45d802(0xed)+formatNumber(_0x81fcf5[_0x45d802(0x1a6)](0x2))+'</b></td>',_0x35624e+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x46979b)+_0x45d802(0x101),_0x35624e+=_0x45d802(0xed)+formatNumber(_0x53486f)+_0x45d802(0x101),_0x35624e+=_0x45d802(0xed)+formatNumber(_0x372dc5)+_0x45d802(0x101),_0x35624e+=_0x45d802(0xe8);}_0x4c93a2[_0x45d802(0x1ba)](_0x35624e);}function _0x26aaff(_0x5783c3,_0x2b83d1){const _0x57c147=_0x45d802,_0x436914=[];for(let _0x48a110=0x0;_0x48a110<=_0x5783c3['length']-0x1;_0x48a110+=_0x2b83d1){_0x436914[_0x57c147(0x1ba)](_0x5783c3['slice'](_0x48a110,_0x48a110+_0x2b83d1));}return _0x436914;}const _0x5c197b=_0x26aaff(_0x4c93a2,_0x20368e);let _0x1d7e67='';return _0x5c197b[_0x45d802(0x187)]((_0x36c599,_0x422956)=>{const _0x533f95=_0x45d802;_0x422956>0x0&&(_0x1d7e67+=_0x533f95(0x12a));_0x1d7e67+=_0x533f95(0xff),_0x1d7e67+=_0x533f95(0x23c),_0x1d7e67+='<tr>',_0x1d7e67+=_0x533f95(0x18b),_0x1d7e67+='</tr>',_0x1d7e67+=_0x533f95(0x134),_0x1d7e67+=_0x533f95(0x209);for(let _0x534e2f=0x0;_0x534e2f<=_0x268a2c[_0x533f95(0x17a)]-0x1;_0x534e2f++){const _0x3f1251=_0x268a2c[_0x534e2f];for(let _0x4e7844=0x0;_0x4e7844<_0xaa6362['length'];_0x4e7844++){const _0x21ad63=_0xaa6362[_0x4e7844];_0x21ad63[_0x533f95(0x261)]===_0x3f1251[_0x533f95(0x261)][_0x533f95(0x25f)]&&(_0x1d7e67+=_0x533f95(0x229)+_0x21ad63[_0x533f95(0x1fa)]+_0x533f95(0x13a)+_0x3f1251[_0x533f95(0x261)]['category']+_0x533f95(0x143));}}_0x1d7e67+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x1d7e67+=_0x533f95(0xe8),_0x1d7e67+=_0x533f95(0x134),_0x1d7e67+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x1d7e67+=_0x533f95(0x1c1),_0x1d7e67+=_0x533f95(0x154);for(let _0x53e32a=0x0;_0x53e32a<=_0x268a2c[_0x533f95(0x17a)]-0x1;_0x53e32a++){const _0x1111c8=_0x268a2c[_0x53e32a];for(let _0x201126=0x0;_0x201126<_0xe43e11[_0x533f95(0x19e)][_0x533f95(0x17a)];_0x201126++){const _0x5c8ee2=_0xe43e11[_0x533f95(0x19e)][_0x201126];_0x5c8ee2['_id']['category']===_0x1111c8['_id'][_0x533f95(0x25f)]&&(_0x1d7e67+=_0x533f95(0x16e)+_0x5c8ee2[_0x533f95(0x261)][_0x533f95(0x1c7)]+_0x533f95(0x143));}}_0x1d7e67+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x1d7e67+=_0x533f95(0xfd),_0x1d7e67+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x1d7e67+=_0x533f95(0x18c),_0x1d7e67+=_0x533f95(0xe8),_0x1d7e67+=_0x533f95(0x144),_0x1d7e67+=_0x533f95(0x20d),_0x36c599[_0x533f95(0x187)](_0x67dfe5=>{_0x1d7e67+=_0x67dfe5;}),console[_0x533f95(0x1be)](_0x513e84),_0x1d7e67+=_0x533f95(0x103),_0x1d7e67+=_0x533f95(0x196);}),_0x1d7e67;}router[a0_0x5de9ce(0x20e)](a0_0x5de9ce(0x1b8),auth,async(_0x257235,_0x1ab14e)=>{const _0x25f552=a0_0x5de9ce,{from_date:_0x17671a,to_date:_0x4a5cde,isExcel:_0x2bef10,agent_id:_0x2166bd}=_0x257235[_0x25f552(0x18d)],_0x2069ed=_0x257235[_0x25f552(0x1f3)],_0x396709=await staff[_0x25f552(0x24c)]({'email':_0x2069ed[_0x25f552(0x10d)]}),_0x2273e4=await master_shop['find'](),_0x3c0ecb=await agentsdataDSICheck_admin(_0x17671a,_0x4a5cde,_0x2166bd,_0x2bef10),_0x3ad175=await agentsdataDSICheck_admin_excel(_0x17671a,_0x4a5cde,_0x2166bd,_0x2bef10);let _0x4bf22b='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x3d6211=new Date(_0x17671a),_0x5211d8=new Date(_0x4a5cde);const _0x542909={'year':_0x25f552(0x1dc),'month':_0x25f552(0x223),'day':'numeric'},_0x10bdbd=new Intl[(_0x25f552(0x10e))](_0x25f552(0x1ae),_0x542909)[_0x25f552(0x20c)](_0x3d6211),_0x214da4=new Intl[(_0x25f552(0x10e))](_0x25f552(0x1ae),_0x542909)[_0x25f552(0x20c)](_0x5211d8);_0x4bf22b+=_0x25f552(0x241),_0x4bf22b+='<div\x20\x20id=\x22table-conatainer\x22>',_0x4bf22b+=_0x25f552(0xff),_0x4bf22b+=_0x3c0ecb,_0x4bf22b+=_0x25f552(0x196),_0x4bf22b+=_0x25f552(0x1d9),_0x4bf22b+=_0x25f552(0x1d9);let _0x2b235b=_0x25f552(0x1a4);_0x2b235b+=_0x25f552(0x241),_0x2b235b+=_0x25f552(0x21e),_0x2b235b+='<table>',_0x2b235b+=_0x3ad175,_0x2b235b+=_0x25f552(0x196),_0x2b235b+=_0x25f552(0x1d9),_0x2b235b+=_0x25f552(0x1d9);let _0x44a364=_0x25f552(0x128);const _0x252499={'width':_0x25f552(0x24d),'height':_0x25f552(0x147),'orientation':'landscape','border':{'top':_0x25f552(0xe2),'right':_0x25f552(0xe2),'bottom':_0x25f552(0xe2),'left':_0x25f552(0xe2)},'header':{'height':_0x25f552(0x206),'contents':_0x25f552(0x1a9)+_0x44a364+_0x25f552(0x244)+_0x10bdbd+_0x25f552(0x17d)+_0x214da4+_0x25f552(0x25d)},'footer':{'height':'20mm','contents':{'default':_0x25f552(0x1d7)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x25f552(0x185)}}};if(_0x2bef10=='on'){const _0x4a39cd=cheerio[_0x25f552(0x1d4)](_0x2b235b);let _0x253636=[],_0x49744b=[],_0x123645=[];_0x4a39cd(_0x25f552(0xec))[_0x25f552(0x18e)]((_0x646ca6,_0x4061e3)=>{const _0x33875b=_0x25f552;let _0x4ccef3=[],_0x5566a0=0x0;while(_0x123645[_0x5566a0]){_0x123645[_0x5566a0]--,_0x5566a0++;}_0x4a39cd(_0x4061e3)['find']('td,\x20th')[_0x33875b(0x18e)]((_0x370d4e,_0x252569)=>{const _0x159207=_0x33875b;let _0x5b08a8=_0x4a39cd(_0x252569)[_0x159207(0x1c6)]()[_0x159207(0x20b)](),_0x4b229e=parseFloat(_0x5b08a8[_0x159207(0x216)](/,/g,''));isNaN(_0x4b229e)&&(_0x4b229e=_0x5b08a8);let _0x289cd4=parseInt(_0x4a39cd(_0x252569)['attr'](_0x159207(0x265)))||0x1,_0x225a36=parseInt(_0x4a39cd(_0x252569)[_0x159207(0x170)]('rowspan'))||0x1;_0x4ccef3[_0x5566a0]=_0x4b229e;(_0x289cd4>0x1||_0x225a36>0x1)&&_0x49744b[_0x159207(0x1ba)]({'s':{'r':_0x646ca6,'c':_0x5566a0},'e':{'r':_0x646ca6+_0x225a36-0x1,'c':_0x5566a0+_0x289cd4-0x1}});for(let _0x148194=0x0;_0x148194<_0x289cd4;_0x148194++){_0x225a36>0x1&&(_0x123645[_0x5566a0+_0x148194]=_0x225a36-0x1);}_0x5566a0+=_0x289cd4;}),_0x253636[_0x33875b(0x1ba)](_0x4ccef3);});const _0x242499=XLSX['utils'][_0x25f552(0x1f2)](),_0x59b099=XLSX[_0x25f552(0x15c)][_0x25f552(0x217)](_0x253636);_0x49744b[_0x25f552(0x17a)]>0x0&&(_0x59b099['!merges']=_0x49744b);_0x59b099[_0x25f552(0x1bf)]=_0x253636[0x0][_0x25f552(0x13d)](()=>({'wpx':0x64})),XLSX[_0x25f552(0x15c)][_0x25f552(0x1b6)](_0x242499,_0x59b099,'Sales\x20Report');const _0x3fba7f=XLSX['write'](_0x242499,{'bookType':_0x25f552(0xe7),'type':_0x25f552(0x238)});_0x1ab14e[_0x25f552(0x160)](_0x25f552(0x178),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x1ab14e['setHeader'](_0x25f552(0x25a),_0x25f552(0x1a5)),_0x1ab14e[_0x25f552(0x194)](_0x3fba7f);}else pdf[_0x25f552(0x218)](_0x4bf22b,_0x252499)[_0x25f552(0x171)](function(_0x5e7b0e,_0x2e859e){const _0x2bdc04=_0x25f552;if(_0x5e7b0e){_0x1ab14e['status'](0x1f4)[_0x2bdc04(0x194)]('Error\x20generating\x20PDF');return;}_0x1ab14e[_0x2bdc04(0x160)](_0x2bdc04(0x25a),_0x2bdc04(0x259)),_0x2e859e['pipe'](_0x1ab14e);});}),router[a0_0x5de9ce(0x15e)](a0_0x5de9ce(0xf2),auth,async(_0x5b7733,_0x4b1388)=>{const _0x1284df=a0_0x5de9ce;try{const {username:_0x2bb72c,email:_0xf7d8e7,role:_0x5bb39b}=_0x5b7733[_0x1284df(0x1f3)],_0x183f51=_0x5b7733['user'],_0x5b8912=await profile['findOne']({'email':_0x183f51[_0x1284df(0x10d)]}),_0x434321={'year':_0x1284df(0x1dc),'month':'long','day':'numeric'},_0x5e8d3f=await master_shop[_0x1284df(0xe9)](),_0x4e9793=await staff[_0x1284df(0x24c)]({'email':_0x183f51['email']}),_0x30a8d2=await product[_0x1284df(0xe9)](),_0x2c04e8=await warehouse[_0x1284df(0xfb)]([{'$unwind':_0x1284df(0x119)},{'$lookup':{'from':_0x1284df(0x26d),'localField':_0x1284df(0x1b7),'foreignField':_0x1284df(0x158),'as':'product_docs'}},{'$unwind':_0x1284df(0x139)},{'$project':{'product_name':_0x1284df(0x1c5),'product_stock':_0x1284df(0x137)}},{'$group':{'_id':_0x1284df(0x1cd),'product_stock':{'$sum':_0x1284df(0x267)}}}]);if(_0x5e8d3f[0x0][_0x1284df(0x174)]==_0x1284df(0x22c))var _0x47eca3=users[_0x1284df(0x1bd)];else{if(_0x5e8d3f[0x0][_0x1284df(0x174)]==_0x1284df(0xf7))var _0x47eca3=users['Hindi'];else{if(_0x5e8d3f[0x0]['language']==_0x1284df(0x172))var _0x47eca3=users[_0x1284df(0x172)];else{if(_0x5e8d3f[0x0][_0x1284df(0x174)]==_0x1284df(0x221))var _0x47eca3=users['Spanish'];else{if(_0x5e8d3f[0x0]['language']==_0x1284df(0x1b5))var _0x47eca3=users[_0x1284df(0x1b5)];else{if(_0x5e8d3f[0x0][_0x1284df(0x174)]=='Portuguese\x20(BR)')var _0x47eca3=users[_0x1284df(0x100)];else{if(_0x5e8d3f[0x0][_0x1284df(0x174)]=='Chinese')var _0x47eca3=users[_0x1284df(0x14c)];else{if(_0x5e8d3f[0x0][_0x1284df(0x174)]==_0x1284df(0x242))var _0x47eca3=users[_0x1284df(0x1d8)];}}}}}}}_0x4b1388[_0x1284df(0x1ef)](_0x1284df(0x169),{'success':_0x5b7733[_0x1284df(0x159)](_0x1284df(0xe4)),'errors':_0x5b7733[_0x1284df(0x159)](_0x1284df(0x201)),'alldata':_0x30a8d2,'profile':_0x5b8912,'master_shop':_0x5e8d3f,'role':_0x183f51,'product_stock':_0x2c04e8,'language':_0x47eca3,'staff_arr':_0x4e9793});}catch(_0x45fd7c){}});function formatNumber(_0x4e1d19,_0x8e8d3=a0_0x5de9ce(0x1ae),_0x53f181={'minimumFractionDigits':0x2}){const _0x11ba1d=a0_0x5de9ce,_0x6c4cf6=new Intl[(_0x11ba1d(0x165))](_0x8e8d3,_0x53f181);return _0x6c4cf6[_0x11ba1d(0x20c)](_0x4e1d19);}async function agentsdataDSICheck(_0x366a1e,_0x261c1a,_0x3ae4fd,_0x2c4b7c){const _0x35a69b=a0_0x5de9ce,_0x4b903d=await product[_0x35a69b(0xfb)]([{'$group':{'_id':{'brand':_0x35a69b(0x177),'category':'$category'},'products':{'$push':{'name':_0x35a69b(0x260),'product_code':_0x35a69b(0x1d5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2c7cad=[];_0x2c7cad[_0x35a69b(0x19e)]=[];for(let _0x3af61c=0x0;_0x3af61c<=_0x4b903d[_0x35a69b(0x17a)]-0x1;_0x3af61c++){const _0x331198=_0x4b903d[_0x3af61c];_0x2c7cad[_0x35a69b(0x19e)][_0x35a69b(0x1ba)](_0x331198);}const _0x5e695f=await product['aggregate']([{'$group':{'_id':{'category':_0x35a69b(0x1f0)},'products':{'$push':{'brand':_0x35a69b(0x177),'product_code':_0x35a69b(0x1d5),'product_name':_0x35a69b(0x260)}}}},{'$sort':{'_id.category':-0x1}}]),_0x21137a=await product[_0x35a69b(0xfb)]([{'$group':{'_id':{'category':_0x35a69b(0x1f0),'brand':_0x35a69b(0x177)}}},{'$group':{'_id':_0x35a69b(0x1aa),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3f4ee9=await sales_sa[_0x35a69b(0xfb)]([{'$match':{'date':{'$gte':_0x366a1e,'$lte':_0x261c1a},'sales_staff_id':_0x3ae4fd,'sale_product.isFG':_0x35a69b(0x253)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0x35a69b(0x1f7),'as':_0x35a69b(0x263)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':_0x35a69b(0x106),'customer':_0x35a69b(0x258)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x35a69b(0x240),'NetPrice':'$sale_product.totalprice','discount':_0x35a69b(0x164),'adj_discount':_0x35a69b(0x182),'product_details':{'prod_name':'$product_info.name','product_code':_0x35a69b(0x11a),'category':_0x35a69b(0x150),'brand':_0x35a69b(0x111),'gross_price':_0x35a69b(0x162)}}}}},{'$unwind':_0x35a69b(0x179)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x35a69b(0x155),'customer':'$_id.customer','category':_0x35a69b(0x102),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x35a69b(0x1ec)},'totalGross':{'$sum':{'$multiply':[_0x35a69b(0x1ec),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x35a69b(0x1e2)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x35a69b(0x15f)},'product_details':{'$first':_0x35a69b(0xeb)}}},{'$group':{'_id':{'dsi':_0x35a69b(0x1df),'date':_0x35a69b(0x155),'customer':_0x35a69b(0xfa)},'totalQty':{'$sum':_0x35a69b(0x12f)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x35a69b(0x15a)},'discount':{'$sum':_0x35a69b(0xf1)},'adj_discount':{'$sum':_0x35a69b(0x266)},'products':{'$push':{'qty':_0x35a69b(0x12f),'category':_0x35a69b(0x1aa),'brand':_0x35a69b(0x1ed),'product_details':_0x35a69b(0x119)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x305ba2=[],_0x3f1c2c={},_0xc26d6f={},_0x326772={};var _0x19fb9f=0x0,_0xb6bc5f=0x0,_0x57510e=0x0,_0x2f93f7=0x0,_0x4a33cb=0x0;const _0x165b36=0x6;for(let _0x2d4fc0=0x0;_0x2d4fc0<=_0x3f4ee9['length']-0x1;_0x2d4fc0++){const _0x10bd36=_0x3f4ee9[_0x2d4fc0];let _0x32c47b=_0x35a69b(0x134);_0x32c47b+=_0x35a69b(0x210)+_0x10bd36[_0x35a69b(0x261)][_0x35a69b(0x25b)]+_0x35a69b(0x143),_0x32c47b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x10bd36[_0x35a69b(0x261)][_0x35a69b(0x1bc)]+_0x35a69b(0x143),_0x32c47b+=_0x35a69b(0x210)+_0x10bd36[_0x35a69b(0x261)][_0x35a69b(0x186)]+_0x35a69b(0x143);let _0x377c32={};var _0x4e51c5=0x0;for(let _0x49faf0=0x0;_0x49faf0<=_0x10bd36[_0x35a69b(0x26d)][_0x35a69b(0x17a)]-0x1;_0x49faf0++){const _0x2b75e8=_0x10bd36[_0x35a69b(0x26d)][_0x49faf0];_0x377c32[_0x2b75e8[_0x35a69b(0x1c7)]+'-'+_0x2b75e8[_0x35a69b(0x25f)]]=_0x2b75e8[_0x35a69b(0x269)];const _0x13d286=_0x2b75e8[_0x35a69b(0x1c7)]+'-'+_0x2b75e8[_0x35a69b(0x25f)];!_0x3f1c2c[_0x13d286]&&(_0x3f1c2c[_0x13d286]=0x0),!Array[_0x35a69b(0x11d)](_0x326772[_0x13d286])&&(_0x326772[_0x13d286]=[]),!Array[_0x35a69b(0x11d)](_0x326772[_0x13d286])&&(_0x326772[_0x13d286]=[]),_0x3f1c2c[_0x13d286]+=_0x2b75e8[_0x35a69b(0x269)],_0x326772[_0x13d286]['push'](_0x2b75e8[_0x35a69b(0x269)]),_0x4e51c5++;}console[_0x35a69b(0x1be)](_0x10bd36);for(let _0x4270f8=0x0;_0x4270f8<=_0x2c7cad[_0x35a69b(0x19e)]['length']-0x1;_0x4270f8++){const _0x19c758=_0x2c7cad[_0x35a69b(0x19e)][_0x4270f8],_0x5794b3=_0x19c758[_0x35a69b(0x261)][_0x35a69b(0x1c7)]+'-'+_0x19c758[_0x35a69b(0x261)][_0x35a69b(0x25f)];_0x32c47b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x377c32[_0x5794b3]!==undefined?_0x377c32[_0x5794b3][_0x35a69b(0x1a6)](0x2):'')+_0x35a69b(0x143);}_0x57510e=_0x10bd36[_0x35a69b(0x198)]+_0x10bd36['adj_discount'],_0x32c47b+=_0x35a69b(0x13e)+formatNumber(parseFloat(_0x10bd36[_0x35a69b(0x16f)],0x2)[_0x35a69b(0x1a6)](0x2))+'</td>',_0x32c47b+=_0x35a69b(0x13e)+formatNumber(_0x10bd36[_0x35a69b(0x230)][_0x35a69b(0x1a6)](0x2))+'</td>',_0x32c47b+=_0x35a69b(0x13e)+formatNumber(_0x57510e)+_0x35a69b(0x143),_0x32c47b+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x10bd36[_0x35a69b(0x1ce)][_0x35a69b(0x1a6)](0x2))+_0x35a69b(0x143),_0x32c47b+=_0x35a69b(0xe8),_0x19fb9f+=parseFloat(_0x10bd36[_0x35a69b(0x16f)][_0x35a69b(0x1a6)](0x2)),_0xb6bc5f+=parseFloat(_0x10bd36[_0x35a69b(0x1ce)][_0x35a69b(0x1a6)](0x2)),_0x2f93f7+=_0x57510e,_0x4a33cb+=parseFloat(_0x10bd36[_0x35a69b(0x230)][_0x35a69b(0x1a6)](0x2));if(_0x2d4fc0==_0x3f4ee9[_0x35a69b(0x17a)]-0x1){_0x32c47b+=_0x35a69b(0x134),_0x32c47b+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x32c47b+=_0x35a69b(0x143);for(let _0x1d8990=0x0;_0x1d8990<=_0x2c7cad[_0x35a69b(0x19e)]['length']-0x1;_0x1d8990++){const _0x4dba26=_0x2c7cad['cat_brand'][_0x1d8990],_0x8a41eb=_0x4dba26['_id'][_0x35a69b(0x1c7)]+'-'+_0x4dba26['_id']['category'],_0x28f12a=_0x326772[_0x8a41eb][_0x35a69b(0x190)]((_0x197cf3,_0x3eed40)=>_0x197cf3+_0x3eed40,0x0);_0x32c47b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x28f12a!==undefined?formatNumber(_0x28f12a['toFixed'](0x2)):'')+'</b></td>',console[_0x35a69b(0x1be)](_0x326772[_0x8a41eb][_0x35a69b(0x190)]((_0x4af427,_0x4e2eb5)=>_0x4af427+_0x4e2eb5,0x0));}_0x32c47b+=_0x35a69b(0xed)+formatNumber(_0x19fb9f[_0x35a69b(0x1a6)](0x2))+_0x35a69b(0x101),_0x32c47b+=_0x35a69b(0xed)+formatNumber(_0x4a33cb)+_0x35a69b(0x101),_0x32c47b+=_0x35a69b(0xed)+formatNumber(_0x2f93f7)+_0x35a69b(0x101),_0x32c47b+=_0x35a69b(0xed)+formatNumber(_0xb6bc5f)+'</b></td>',_0x32c47b+='</tr>';}_0x305ba2[_0x35a69b(0x1ba)](_0x32c47b);}function _0x47cc71(_0x49ae32,_0x4579a0){const _0x39be1e=_0x35a69b,_0x684d92=[];for(let _0x5c7e1e=0x0;_0x5c7e1e<=_0x49ae32[_0x39be1e(0x17a)]-0x1;_0x5c7e1e+=_0x4579a0){_0x684d92[_0x39be1e(0x1ba)](_0x49ae32[_0x39be1e(0x1e6)](_0x5c7e1e,_0x5c7e1e+_0x4579a0));}return _0x684d92;}const _0x2027e6=_0x47cc71(_0x305ba2,_0x165b36);let _0x41d660='';return _0x2027e6['forEach']((_0x2f924a,_0x55a840)=>{const _0x12edf1=_0x35a69b;_0x55a840>0x0&&(_0x41d660+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x41d660+='<table>',_0x41d660+='<thead>',_0x41d660+='<tr>',_0x41d660+=_0x12edf1(0x18b),_0x41d660+=_0x12edf1(0xe8),_0x41d660+=_0x12edf1(0x134),_0x41d660+=_0x12edf1(0x209);for(let _0x4d298b=0x0;_0x4d298b<=_0x5e695f[_0x12edf1(0x17a)]-0x1;_0x4d298b++){const _0x20bba1=_0x5e695f[_0x4d298b];for(let _0x5e7cd3=0x0;_0x5e7cd3<_0x21137a[_0x12edf1(0x17a)];_0x5e7cd3++){const _0x45d65a=_0x21137a[_0x5e7cd3];_0x45d65a[_0x12edf1(0x261)]===_0x20bba1[_0x12edf1(0x261)]['category']&&(_0x41d660+=_0x12edf1(0x229)+_0x45d65a[_0x12edf1(0x1fa)]+_0x12edf1(0x13a)+_0x20bba1[_0x12edf1(0x261)][_0x12edf1(0x25f)]+_0x12edf1(0x143));}}_0x41d660+=_0x12edf1(0x208),_0x41d660+=_0x12edf1(0xe8),_0x41d660+=_0x12edf1(0x134),_0x41d660+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x41d660+=_0x12edf1(0x1c1),_0x41d660+=_0x12edf1(0x154);for(let _0x15ff5f=0x0;_0x15ff5f<=_0x5e695f[_0x12edf1(0x17a)]-0x1;_0x15ff5f++){const _0xafb4c4=_0x5e695f[_0x15ff5f];for(let _0x5309ae=0x0;_0x5309ae<_0x2c7cad[_0x12edf1(0x19e)][_0x12edf1(0x17a)];_0x5309ae++){const _0x269df5=_0x2c7cad[_0x12edf1(0x19e)][_0x5309ae];_0x269df5[_0x12edf1(0x261)][_0x12edf1(0x25f)]===_0xafb4c4['_id']['category']&&(_0x41d660+='<td\x20class=\x22cat_data\x22>'+_0x269df5[_0x12edf1(0x261)][_0x12edf1(0x1c7)]+_0x12edf1(0x143));}}_0x41d660+=_0x12edf1(0x1fd),_0x41d660+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x41d660+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x41d660+=_0x12edf1(0x18c),_0x41d660+=_0x12edf1(0xe8),_0x41d660+='</thead>',_0x41d660+=_0x12edf1(0x20d),_0x2f924a[_0x12edf1(0x187)](_0x119745=>{_0x41d660+=_0x119745;}),console['log'](_0x326772),_0x41d660+=_0x12edf1(0x103),_0x41d660+='</table>';}),_0x41d660;}function a0_0x3686(){const _0xf7f857=['<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<th>Booking</th>','8.5in','$sales_info._id','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','Chinese','top','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','excel','$product_info.category','5268930fONUwZ','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','sales_info','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','$_id.date','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','note','name','flash','$NetPrice','write','utils','<td\x20colspan=\x223\x22><b>TOTAL<b>','get','$products.adj_discount','setHeader','$products.product_details.brand','$product_info.gross_price','/dsrr/view','$sale_product.discount','NumberFormat','<p>','rowspan','test','dsi_sales','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','../public/language/languages.json','style','product_stock','<td\x20class=\x22cat_data\x22>','totalQty','attr','toStream','German','landscape','language','save','7fDZuaq','$brand','Content-Disposition','$products','length','sales_ext','697NptzDK','\x20-\x20','$sale_product','sort','image','/inventory_sum/pdf','$sale_product.adj_discount','multer','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','/dev/null','customer','forEach','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','/total_sales_reports/pdf','window.onload\x20=\x20function()\x20{','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','body','each','$product.product_name','reduce','border-right','Standard','/balance/view','send','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','</table>','border-top','discount','$sale_product.isFG','deleteOne','exceljs','1974760eoLJAp','$sale_product.product_code','cat_brand','$due_date','<th>\x20ENDING\x20BALANCE\x20</th>','isFG','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','6847256zyyyzH','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','toFixed','adj_discount','</th>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','$_id.category','1047150gnTIlM','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<p>INVENTORY\x20SUMMARY</p>','en-US','/agent/view','3544540WHxkBP','<th\x20rowspan=\x272\x27>Production</th>','$sale_product.product_name','beg_bal','dataqty','French','book_append_sheet','product_details.product_name','/agent_reports/pdf_admin','setDate','push','$sale_product.totalprice','date','English','log','!cols','$product','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','/inventory_sum/view','exports','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','$product_details.product_name','text','brand','express','split','$product_list.product_code','border-left','Products\x20master','$product_name','NetPrice','/dsrr_admin/view_data/:id','ObjectId','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','!merges','load','$product_code','$product_info.name','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','Arabic','</div>','totalQTY','dsi_sales_admin','numeric','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','$sales_info','$_id.dsi','/dsrr_admin/pdf_admin','prod_cat','$products.NetPrice','$status_data','medium','<th\x20rowspan=\x272\x27>Category</th>','slice','$products.product_details.gross_price','status','Sales\x20Report','product_name','</p>','$products.qty','$_id.brand','</script>','render','$category','window.print();','book_new','user','dssr_view_admin','$totalGross','Portuguese\x20(BR)','product_code','$amount','/dl_excel','brandCount','express/lib/response','bottom','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','right','<td\x20class=\x22row_data\x22></td>','html','errors','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','mongoose','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','$_id.status_data','60mm','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','trim','format','<tbody>','post','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','<th\x20rowspan=\x272\x27>Products</th>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','<td\x20class=\x22cat_data\x22></td>','amount','replace','aoa_to_sheet','create','302PhuiWf','true','then','canvas','params','<div\x20\x20id=\x22table-conatainer\x22>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','Spanish','pdfkit-table','long','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','getMonth','3ClIbMJ','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','Error\x20generating\x20PDF','<td\x20colspan=\x22','td,\x20th','$products.product_details.prod_id','English\x20(US)','stock','toLocaleString','toISOString','totalGross','20mm','9bFiXne','/reports/dsrr/view','Household','valueOf','<th>\x20QTY\x20SOLD\x20</th>','$cash','buffer','thick','/dsrr_admin/view','18490087uNTnuZ','<thead>','filter','<th>\x20INCOMING\x20</th>','<th>\x20ITEM\x20CODE\x20</th>','$sale_product.real_qty_unit_val','<div\x20class=\x22row\x22>','Arabic\x20(ae)','<td\x20class=\x22row_data\x22><b>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<p>FINISHED\x20GOODS\x20INVENTORY</p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','<div\x20class=\x22col-sm-11\x22>','cash','000000','\x20-\x20STD','findOne','15in','/agent_reports/pdf','$product_list.product_name','referenceNumber','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','includes','false','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','pipe','staffs','<h1>JAKA\x20EQUITIES\x20CORP</h1>','$customer','application/pdf','Content-Type','dsi','$sale_product.quantity','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','$sale_product.stock','category','$name','_id','<th>\x20INVOICE\x20AMOUNT\x20</th>','product_info','$product_info','colspan','$adj_discount','$product_stock','bank','qty','salesman_data','<td\x20class=\x22row_data\x22>','redirect','products','/total_sales_reports/view','cheerio','0.1in','<td\x20class=\x22cat_data\x22><b>FG</b></td>','success','$sale_product._id','thin','xlsx','</tr>','find','check_no','$products.product_details','table\x20tr','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$bank','Products\x20find_data','$product_list','$discount','/agent_reports/view','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','border-bottom','$product_list.product_stock','catch','Hindi','$check_no','$products.discount','$_id.customer','aggregate','balanced','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','$dsi','<table>','Portuguese','</b></td>','$products.product_details.category','</tbody>','sales_staff_id','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','$date','<script>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','\x22><b>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','sumqty','<p>SALES\x20REPORTS</p>','email','DateTimeFormat','<th>\x20SALES\x20</th>','totalQTYsum','$product_info.brand','product_details','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','<th>X-Truck</th>','getDate','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','json','$product_details','$product_info.product_code','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','Asia/Manila','isArray','$sales_staff_id','agent_sales','attachment;\x20filename=\x22sales_report.xlsx\x22','toLocaleDateString','sales_bkg','totalPrice','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','../middleware/auth','/getDSSR_no_sales','dssr_view','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','<td\x20class=\x22row_data\x22>0</td>','<div\x20style=\x22page-break-before:\x20always;\x22></div>','Letter','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','findById','jsbarcode','$totalQty','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','error','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','<tr>','getFullYear','left','$product_details.product_stock','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','$product_docs','\x22\x20class=\x22cat_data\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','Products\x20warehouse_data','map','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','product_docs','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','sale_product.product_code','</td>','</thead>'];a0_0x3686=function(){return _0xf7f857;};return a0_0x3686();}async function agentsdataDSICheck_excel(_0x7b81d8,_0x471c2a,_0x9b9a3b,_0x306ffb){const _0x5cc36a=a0_0x5de9ce,_0x27ca13=await product[_0x5cc36a(0xfb)]([{'$group':{'_id':{'brand':'$brand','category':_0x5cc36a(0x1f0)},'products':{'$push':{'name':_0x5cc36a(0x260),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x35a445=[];_0x35a445[_0x5cc36a(0x19e)]=[];for(let _0x21f041=0x0;_0x21f041<=_0x27ca13[_0x5cc36a(0x17a)]-0x1;_0x21f041++){const _0x3d2f5f=_0x27ca13[_0x21f041];_0x35a445[_0x5cc36a(0x19e)][_0x5cc36a(0x1ba)](_0x3d2f5f);}const _0x51db70=await product[_0x5cc36a(0xfb)]([{'$group':{'_id':{'category':_0x5cc36a(0x1f0)},'products':{'$push':{'brand':_0x5cc36a(0x177),'product_code':_0x5cc36a(0x1d5),'product_name':_0x5cc36a(0x260)}}}},{'$sort':{'_id.category':-0x1}}]),_0x6a1590=await product[_0x5cc36a(0xfb)]([{'$group':{'_id':{'category':_0x5cc36a(0x1f0),'brand':'$brand'}}},{'$group':{'_id':_0x5cc36a(0x1aa),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x308145=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x7b81d8,'$lte':_0x471c2a},'sales_staff_id':_0x9b9a3b,'sale_product.isFG':'false'}},{'$unwind':_0x5cc36a(0x17e)},{'$match':{'sale_product.isFG':_0x5cc36a(0x253)}},{'$lookup':{'from':_0x5cc36a(0x26d),'localField':_0x5cc36a(0x142),'foreignField':_0x5cc36a(0x1f7),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':_0x5cc36a(0x258)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x5cc36a(0x240),'NetPrice':_0x5cc36a(0x1bb),'discount':_0x5cc36a(0x164),'adj_discount':_0x5cc36a(0x182),'product_details':{'prod_name':_0x5cc36a(0x1d6),'product_code':_0x5cc36a(0x11a),'category':'$product_info.category','brand':_0x5cc36a(0x111),'gross_price':_0x5cc36a(0x162)}}}}},{'$unwind':_0x5cc36a(0x179)},{'$group':{'_id':{'dsi':_0x5cc36a(0x1df),'date':_0x5cc36a(0x155),'customer':_0x5cc36a(0xfa),'category':_0x5cc36a(0x102),'brand':_0x5cc36a(0x161)},'totalQty':{'$sum':_0x5cc36a(0x1ec)},'totalGross':{'$sum':{'$multiply':[_0x5cc36a(0x1ec),_0x5cc36a(0x1e7)]}},'NetPrice':{'$sum':_0x5cc36a(0x1e2)},'discount':{'$sum':_0x5cc36a(0xf9)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x5cc36a(0xeb)}}},{'$group':{'_id':{'dsi':_0x5cc36a(0x1df),'date':_0x5cc36a(0x155),'customer':_0x5cc36a(0xfa)},'totalQty':{'$sum':_0x5cc36a(0x12f)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x5cc36a(0x15a)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x5cc36a(0x266)},'products':{'$push':{'qty':'$totalQty','category':_0x5cc36a(0x1aa),'brand':_0x5cc36a(0x1ed),'product_details':_0x5cc36a(0x119)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2a2ddb=[],_0x4bc462={},_0x2e0690={},_0x22ffd6={};var _0x5be443=0x0,_0x489a02=0x0,_0x3e0033=0x0,_0x18462a=0x0,_0x86c9c6=0x0;const _0xeae768=0x9184e72a000;for(let _0x1c8b5c=0x0;_0x1c8b5c<=_0x308145['length']-0x1;_0x1c8b5c++){const _0x21925b=_0x308145[_0x1c8b5c];let _0x4e62fa=_0x5cc36a(0x134);_0x4e62fa+=_0x5cc36a(0x210)+_0x21925b[_0x5cc36a(0x261)]['dsi']+_0x5cc36a(0x143),_0x4e62fa+=_0x5cc36a(0x210)+_0x21925b['_id'][_0x5cc36a(0x1bc)]+_0x5cc36a(0x143),_0x4e62fa+=_0x5cc36a(0x210)+_0x21925b['_id'][_0x5cc36a(0x186)]+_0x5cc36a(0x143);let _0x3a0838={};var _0x2007cf=0x0;for(let _0x5627c9=0x0;_0x5627c9<=_0x21925b[_0x5cc36a(0x26d)][_0x5cc36a(0x17a)]-0x1;_0x5627c9++){const _0x3c1817=_0x21925b[_0x5cc36a(0x26d)][_0x5627c9];_0x3a0838[_0x3c1817[_0x5cc36a(0x1c7)]+'-'+_0x3c1817['category']]=_0x3c1817[_0x5cc36a(0x269)];const _0x16adfb=_0x3c1817[_0x5cc36a(0x1c7)]+'-'+_0x3c1817[_0x5cc36a(0x25f)];!_0x4bc462[_0x16adfb]&&(_0x4bc462[_0x16adfb]=0x0),!Array[_0x5cc36a(0x11d)](_0x22ffd6[_0x16adfb])&&(_0x22ffd6[_0x16adfb]=[]),!Array['isArray'](_0x22ffd6[_0x16adfb])&&(_0x22ffd6[_0x16adfb]=[]),_0x4bc462[_0x16adfb]+=_0x3c1817['qty'],_0x22ffd6[_0x16adfb][_0x5cc36a(0x1ba)](_0x3c1817[_0x5cc36a(0x269)]),_0x2007cf++;}console[_0x5cc36a(0x1be)](_0x21925b);for(let _0x60fbd3=0x0;_0x60fbd3<=_0x35a445['cat_brand']['length']-0x1;_0x60fbd3++){const _0x5a9778=_0x35a445[_0x5cc36a(0x19e)][_0x60fbd3],_0x36cf77=_0x5a9778['_id']['brand']+'-'+_0x5a9778[_0x5cc36a(0x261)]['category'];_0x4e62fa+=_0x5cc36a(0x131)+(_0x3a0838[_0x36cf77]!==undefined?_0x3a0838[_0x36cf77][_0x5cc36a(0x1a6)](0x2):'')+_0x5cc36a(0x143);}_0x3e0033=_0x21925b[_0x5cc36a(0x198)]+_0x21925b[_0x5cc36a(0x1a7)],_0x4e62fa+=_0x5cc36a(0x13e)+formatNumber(parseFloat(_0x21925b[_0x5cc36a(0x16f)],0x2)[_0x5cc36a(0x1a6)](0x2))+_0x5cc36a(0x143),_0x4e62fa+=_0x5cc36a(0x13e)+formatNumber(_0x21925b[_0x5cc36a(0x230)][_0x5cc36a(0x1a6)](0x2))+_0x5cc36a(0x143),_0x4e62fa+=_0x5cc36a(0x13e)+formatNumber(_0x3e0033)+_0x5cc36a(0x143),_0x4e62fa+=_0x5cc36a(0x13e)+formatNumber(_0x21925b['NetPrice'][_0x5cc36a(0x1a6)](0x2))+_0x5cc36a(0x143),_0x4e62fa+=_0x5cc36a(0xe8),_0x5be443+=parseFloat(_0x21925b['totalQty'][_0x5cc36a(0x1a6)](0x2)),_0x489a02+=parseFloat(_0x21925b[_0x5cc36a(0x1ce)][_0x5cc36a(0x1a6)](0x2)),_0x18462a+=_0x3e0033,_0x86c9c6+=parseFloat(_0x21925b[_0x5cc36a(0x230)][_0x5cc36a(0x1a6)](0x2));if(_0x1c8b5c==_0x308145['length']-0x1){_0x4e62fa+=_0x5cc36a(0x134),_0x4e62fa+=_0x5cc36a(0x15d),_0x4e62fa+=_0x5cc36a(0x143);for(let _0x4ec027=0x0;_0x4ec027<=_0x35a445[_0x5cc36a(0x19e)][_0x5cc36a(0x17a)]-0x1;_0x4ec027++){const _0x5631b6=_0x35a445[_0x5cc36a(0x19e)][_0x4ec027],_0x2a7b99=_0x5631b6[_0x5cc36a(0x261)][_0x5cc36a(0x1c7)]+'-'+_0x5631b6[_0x5cc36a(0x261)]['category'],_0x120bda=_0x22ffd6[_0x2a7b99][_0x5cc36a(0x190)]((_0x37a9fb,_0x24a7d2)=>_0x37a9fb+_0x24a7d2,0x0);_0x4e62fa+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x120bda!==undefined?formatNumber(_0x120bda[_0x5cc36a(0x1a6)](0x2)):'')+_0x5cc36a(0x101),console['log'](_0x22ffd6[_0x2a7b99][_0x5cc36a(0x190)]((_0x1599ef,_0x1fcbe9)=>_0x1599ef+_0x1fcbe9,0x0));}_0x4e62fa+=_0x5cc36a(0xed)+formatNumber(_0x5be443['toFixed'](0x2))+_0x5cc36a(0x101),_0x4e62fa+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x86c9c6)+_0x5cc36a(0x101),_0x4e62fa+=_0x5cc36a(0xed)+formatNumber(_0x18462a)+_0x5cc36a(0x101),_0x4e62fa+=_0x5cc36a(0xed)+formatNumber(_0x489a02)+_0x5cc36a(0x101),_0x4e62fa+=_0x5cc36a(0xe8);}_0x2a2ddb[_0x5cc36a(0x1ba)](_0x4e62fa);}function _0x868491(_0x22a749,_0x5783ad){const _0x48dc38=_0x5cc36a,_0x28ba79=[];for(let _0x36dcee=0x0;_0x36dcee<=_0x22a749[_0x48dc38(0x17a)]-0x1;_0x36dcee+=_0x5783ad){_0x28ba79[_0x48dc38(0x1ba)](_0x22a749[_0x48dc38(0x1e6)](_0x36dcee,_0x36dcee+_0x5783ad));}return _0x28ba79;}const _0x4cf211=_0x868491(_0x2a2ddb,_0xeae768);let _0x5b4b74='';return _0x4cf211[_0x5cc36a(0x187)]((_0x4a42b7,_0x7d819c)=>{const _0x37c980=_0x5cc36a;_0x7d819c>0x0&&(_0x5b4b74+=_0x37c980(0x12a));_0x5b4b74+='<table>',_0x5b4b74+=_0x37c980(0x23c),_0x5b4b74+=_0x37c980(0x134),_0x5b4b74+=_0x37c980(0x18b),_0x5b4b74+=_0x37c980(0xe8),_0x5b4b74+=_0x37c980(0x134),_0x5b4b74+=_0x37c980(0x209);for(let _0xbe3ea5=0x0;_0xbe3ea5<=_0x51db70[_0x37c980(0x17a)]-0x1;_0xbe3ea5++){const _0x27efdd=_0x51db70[_0xbe3ea5];for(let _0x57c290=0x0;_0x57c290<_0x6a1590[_0x37c980(0x17a)];_0x57c290++){const _0x1f1fb4=_0x6a1590[_0x57c290];_0x1f1fb4[_0x37c980(0x261)]===_0x27efdd[_0x37c980(0x261)]['category']&&(_0x5b4b74+='<td\x20colspan=\x22'+_0x1f1fb4['brandCount']+_0x37c980(0x13a)+_0x27efdd[_0x37c980(0x261)]['category']+'</td>');}}_0x5b4b74+=_0x37c980(0x208),_0x5b4b74+=_0x37c980(0xe8),_0x5b4b74+=_0x37c980(0x134),_0x5b4b74+=_0x37c980(0x1d1),_0x5b4b74+=_0x37c980(0x1c1),_0x5b4b74+=_0x37c980(0x154);for(let _0x4eb24a=0x0;_0x4eb24a<=_0x51db70[_0x37c980(0x17a)]-0x1;_0x4eb24a++){const _0x32933c=_0x51db70[_0x4eb24a];for(let _0x8231b5=0x0;_0x8231b5<_0x35a445[_0x37c980(0x19e)][_0x37c980(0x17a)];_0x8231b5++){const _0x49a37f=_0x35a445['cat_brand'][_0x8231b5];_0x49a37f[_0x37c980(0x261)]['category']===_0x32933c[_0x37c980(0x261)][_0x37c980(0x25f)]&&(_0x5b4b74+='<td\x20class=\x22cat_data\x22>'+_0x49a37f[_0x37c980(0x261)]['brand']+_0x37c980(0x143));}}_0x5b4b74+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x5b4b74+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x5b4b74+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x5b4b74+=_0x37c980(0x18c),_0x5b4b74+=_0x37c980(0xe8),_0x5b4b74+=_0x37c980(0x144),_0x5b4b74+=_0x37c980(0x20d),_0x4a42b7[_0x37c980(0x187)](_0x4d197e=>{_0x5b4b74+=_0x4d197e;}),console[_0x37c980(0x1be)](_0x22ffd6),_0x5b4b74+=_0x37c980(0x103),_0x5b4b74+=_0x37c980(0x196);}),_0x5b4b74;}router[a0_0x5de9ce(0x20e)](a0_0x5de9ce(0x24e),auth,async(_0x56faaa,_0x59a542)=>{const _0x4f173c=a0_0x5de9ce,{from_date:_0x52d5de,to_date:_0x2b61c9,isExcel:_0x550d32}=_0x56faaa['body'],_0x5ef5e2=_0x56faaa[_0x4f173c(0x1f3)],_0x465473=await staff[_0x4f173c(0x24c)]({'email':_0x5ef5e2['email']}),_0x4fef75=await master_shop[_0x4f173c(0xe9)]();console[_0x4f173c(0x1be)](_0x4fef75[0x0][_0x4f173c(0x180)]);const _0x1b19a3=await agentsdataDSICheck(_0x52d5de,_0x2b61c9,_0x465473[_0x4f173c(0x261)][_0x4f173c(0x235)](),_0x550d32),_0x316e5f=await agentsdataDSICheck_excel(_0x52d5de,_0x2b61c9,_0x465473[_0x4f173c(0x261)][_0x4f173c(0x235)](),_0x550d32);let _0x3e53ae=_0x4f173c(0x14b);var _0x4d918d=new Date(_0x52d5de),_0x5d3916=new Date(_0x2b61c9);const _0x38339e={'year':_0x4f173c(0x1dc),'month':_0x4f173c(0x223),'day':'numeric'},_0xc6b4f2=new Intl[(_0x4f173c(0x10e))]('en-US',_0x38339e)['format'](_0x4d918d),_0x4f96ea=new Intl['DateTimeFormat'](_0x4f173c(0x1ae),_0x38339e)['format'](_0x5d3916);_0x3e53ae+='<div\x20class=\x22row\x22>',_0x3e53ae+=_0x4f173c(0x21e),_0x3e53ae+=_0x4f173c(0xff),_0x3e53ae+=_0x1b19a3,_0x3e53ae+='</table>',_0x3e53ae+='</div>',_0x3e53ae+='</div>';let _0x5df467=_0x4f173c(0x14b);_0x5df467+=_0x4f173c(0x241),_0x5df467+='<div\x20\x20id=\x22table-conatainer\x22>',_0x5df467+='<table>',_0x5df467+=_0x316e5f,_0x5df467+='</table>',_0x5df467+='</div>',_0x5df467+=_0x4f173c(0x1d9);let _0x5a7b4a=_0x4f173c(0x128);const _0x424c97={'width':_0x4f173c(0x24d),'height':_0x4f173c(0x147),'orientation':_0x4f173c(0x173),'border':{'top':_0x4f173c(0xe2),'right':'0.1in','bottom':_0x4f173c(0xe2),'left':'0.1in'},'header':{'height':_0x4f173c(0x206),'contents':_0x4f173c(0x1a9)+_0x5a7b4a+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0xc6b4f2+_0x4f173c(0x17d)+_0x4f96ea+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x4f173c(0x185)}}};if(_0x550d32=='on'){const _0x44f2f0=cheerio[_0x4f173c(0x1d4)](_0x5df467);let _0x4ccefa=[],_0x243509=[],_0x166640=[];const _0x45fbdd=_0x3e0fcb=>{const _0x132a63=_0x4f173c,_0x1af4c5={'top':{'style':_0x132a63(0x239),'color':{'rgb':_0x132a63(0x24a)}},'bottom':{'style':'thick','color':{'rgb':_0x132a63(0x24a)}},'left':{'style':_0x132a63(0x239),'color':{'rgb':_0x132a63(0x24a)}},'right':{'style':_0x132a63(0x239),'color':{'rgb':_0x132a63(0x24a)}}};if(_0x3e0fcb){const _0xb054d6=_0x3e0fcb[_0x132a63(0x1c9)](';')[_0x132a63(0x190)]((_0x5d9f97,_0x552fd0)=>{const _0x1bd0b8=_0x132a63,[_0xd0790b,_0x574177]=_0x552fd0[_0x1bd0b8(0x1c9)](':')[_0x1bd0b8(0x13d)](_0x52cda5=>_0x52cda5[_0x1bd0b8(0x20b)]());return _0x5d9f97[_0xd0790b]=_0x574177,_0x5d9f97;},{});_0xb054d6[_0x132a63(0x197)]&&(_0x1af4c5['top']['style']=_0xb054d6['border-top'][_0x132a63(0x252)]('thin')?_0x132a63(0xe6):_0x132a63(0x1e4)),_0xb054d6[_0x132a63(0xf4)]&&(_0x1af4c5['bottom'][_0x132a63(0x16c)]=_0xb054d6[_0x132a63(0xf4)][_0x132a63(0x252)](_0x132a63(0xe6))?'thin':_0x132a63(0x1e4)),_0xb054d6[_0x132a63(0x1cb)]&&(_0x1af4c5[_0x132a63(0x136)][_0x132a63(0x16c)]=_0xb054d6['border-left']['includes'](_0x132a63(0xe6))?'thin':'medium'),_0xb054d6['border-right']&&(_0x1af4c5[_0x132a63(0x1fe)][_0x132a63(0x16c)]=_0xb054d6[_0x132a63(0x191)]['includes'](_0x132a63(0xe6))?_0x132a63(0xe6):'medium');}return _0x1af4c5;};_0x44f2f0(_0x4f173c(0xec))[_0x4f173c(0x18e)]((_0x50e5ff,_0x4c9ef9)=>{const _0x4f4ea4=_0x4f173c;let _0x3c4215=[],_0x3eaafd=0x0;while(_0x166640[_0x3eaafd]){_0x166640[_0x3eaafd]--,_0x3eaafd++;}_0x44f2f0(_0x4c9ef9)[_0x4f4ea4(0xe9)](_0x4f4ea4(0x22a))[_0x4f4ea4(0x18e)]((_0x35718c,_0x29a769)=>{const _0x2f79c8=_0x4f4ea4;let _0xbe1be8=_0x44f2f0(_0x29a769)[_0x2f79c8(0x1c6)]()['trim'](),_0x41c448=parseFloat(_0xbe1be8[_0x2f79c8(0x216)](/,/g,'')),_0x5dd240={};!isNaN(_0x41c448)?(_0x5dd240['v']=_0x41c448,_0x5dd240['t']='n'):(_0x5dd240['v']=_0xbe1be8,_0x5dd240['t']='s');const _0x12c408=_0x44f2f0(_0x29a769)['attr']('style'),_0x5e3eb7=_0x45fbdd(_0x12c408);_0x5dd240['s']={'border':_0x5e3eb7},_0x3c4215[_0x3eaafd]=_0x5dd240;let _0x6694c8=parseInt(_0x44f2f0(_0x29a769)[_0x2f79c8(0x170)](_0x2f79c8(0x265)))||0x1,_0x5c188c=parseInt(_0x44f2f0(_0x29a769)[_0x2f79c8(0x170)](_0x2f79c8(0x167)))||0x1;(_0x6694c8>0x1||_0x5c188c>0x1)&&_0x243509['push']({'s':{'r':_0x50e5ff,'c':_0x3eaafd},'e':{'r':_0x50e5ff+_0x5c188c-0x1,'c':_0x3eaafd+_0x6694c8-0x1}});for(let _0x73b12b=0x0;_0x73b12b<_0x6694c8;_0x73b12b++){_0x5c188c>0x1&&(_0x166640[_0x3eaafd+_0x73b12b]=_0x5c188c-0x1);}_0x3eaafd+=_0x6694c8;}),_0x4ccefa[_0x4f4ea4(0x1ba)](_0x3c4215);});const _0x574fd1=XLSX[_0x4f173c(0x15c)]['book_new'](),_0xa5546f=XLSX[_0x4f173c(0x15c)][_0x4f173c(0x217)](_0x4ccefa);_0x243509[_0x4f173c(0x17a)]>0x0&&(_0xa5546f[_0x4f173c(0x1d3)]=_0x243509);_0xa5546f[_0x4f173c(0x1bf)]=_0x4ccefa[0x0][_0x4f173c(0x13d)](()=>({'wpx':0x64})),XLSX[_0x4f173c(0x15c)][_0x4f173c(0x1b6)](_0x574fd1,_0xa5546f,_0x4f173c(0x1e9));const _0x5cd9f1=XLSX[_0x4f173c(0x15b)](_0x574fd1,{'bookType':_0x4f173c(0xe7),'type':_0x4f173c(0x238)});_0x59a542[_0x4f173c(0x160)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x59a542['setHeader'](_0x4f173c(0x25a),_0x4f173c(0x1a5)),_0x59a542[_0x4f173c(0x194)](_0x5cd9f1);}else pdf[_0x4f173c(0x218)](_0x3e53ae,_0x424c97)['toStream'](function(_0x25ec7b,_0x1b448e){const _0x1dec13=_0x4f173c;if(_0x25ec7b){console['error']('PDF\x20Generation\x20Error:',_0x25ec7b),_0x59a542[_0x1dec13(0x1e8)](0x1f4)[_0x1dec13(0x194)](_0x1dec13(0x228)+_0x25ec7b);return;}_0x59a542['setHeader'](_0x1dec13(0x25a),'application/pdf'),_0x1b448e[_0x1dec13(0x255)](_0x59a542);});}),router[a0_0x5de9ce(0x15e)](a0_0x5de9ce(0x26e),auth,async(_0x24ef12,_0x59621c)=>{const _0x42ebf7=a0_0x5de9ce;try{const {username:_0x4d3539,email:_0xcdce84,role:_0x1077d9}=_0x24ef12[_0x42ebf7(0x1f3)],_0x4e0da3=_0x24ef12[_0x42ebf7(0x1f3)],_0x24416a=await profile[_0x42ebf7(0x24c)]({'email':_0x4e0da3[_0x42ebf7(0x10d)]}),_0x425d81={'year':_0x42ebf7(0x1dc),'month':_0x42ebf7(0x223),'day':'numeric'},_0x4fef25=await master_shop[_0x42ebf7(0xe9)](),_0x4f44f8=await product[_0x42ebf7(0xe9)](),_0x535d41=await warehouse[_0x42ebf7(0xfb)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x42ebf7(0x26d),'localField':_0x42ebf7(0x1b7),'foreignField':_0x42ebf7(0x158),'as':_0x42ebf7(0x140)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x42ebf7(0x1c5),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x42ebf7(0x267)}}}]),_0x2b0caa=await staff['findOne']({'email':_0x4e0da3['email']});if(_0x4fef25[0x0]['language']==_0x42ebf7(0x22c))var _0x48106d=users['English'];else{if(_0x4fef25[0x0][_0x42ebf7(0x174)]==_0x42ebf7(0xf7))var _0x48106d=users['Hindi'];else{if(_0x4fef25[0x0][_0x42ebf7(0x174)]==_0x42ebf7(0x172))var _0x48106d=users[_0x42ebf7(0x172)];else{if(_0x4fef25[0x0]['language']=='Spanish')var _0x48106d=users[_0x42ebf7(0x221)];else{if(_0x4fef25[0x0]['language']==_0x42ebf7(0x1b5))var _0x48106d=users[_0x42ebf7(0x1b5)];else{if(_0x4fef25[0x0]['language']=='Portuguese\x20(BR)')var _0x48106d=users[_0x42ebf7(0x100)];else{if(_0x4fef25[0x0]['language']==_0x42ebf7(0x14c))var _0x48106d=users[_0x42ebf7(0x14c)];else{if(_0x4fef25[0x0]['language']==_0x42ebf7(0x242))var _0x48106d=users[_0x42ebf7(0x1d8)];}}}}}}}_0x59621c[_0x42ebf7(0x1ef)]('sales_reports',{'success':_0x24ef12[_0x42ebf7(0x159)]('success'),'errors':_0x24ef12[_0x42ebf7(0x159)](_0x42ebf7(0x201)),'alldata':_0x4f44f8,'profile':_0x24416a,'master_shop':_0x4fef25,'role':_0x4e0da3,'product_stock':_0x535d41,'language':_0x48106d,'staff_arr':_0x2b0caa});}catch(_0x555b39){}});async function dataSalesReports(_0x5a22cc,_0x46ee1b,_0x5adb4d){const _0x17ac3b=a0_0x5de9ce;let _0x5d72b2='';const _0x516abb=await sales_sa[_0x17ac3b(0xfb)]([{'$match':{'date':{'$gte':_0x5a22cc,'$lte':_0x46ee1b},'sales_staff_id':_0x5adb4d}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x17ac3b(0x253)}},{'$group':{'_id':{'product_name':_0x17ac3b(0x1b2),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':_0x17ac3b(0x240)},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0xa6fb92=0x0,_0x23344d=0x0;for(let _0x3f6aa2=0x0;_0x3f6aa2<=_0x516abb[_0x17ac3b(0x17a)]-0x1;_0x3f6aa2++){const _0x10b695=_0x516abb[_0x3f6aa2];var _0x5e482c=_0x10b695[_0x17ac3b(0x123)][_0x17ac3b(0x22e)](undefined),_0x163940=_0x10b695[_0x17ac3b(0x10b)][_0x17ac3b(0x22e)](undefined);_0x5d72b2+=_0x17ac3b(0x134),_0x5d72b2+='<td\x20class=\x22row_data\x22>'+_0x10b695['_id']['product_code']+'</td>',_0x5d72b2+=_0x17ac3b(0x26b)+_0x10b695[_0x17ac3b(0x261)][_0x17ac3b(0x1ea)]+_0x17ac3b(0x143),_0x5d72b2+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x10b695[_0x17ac3b(0x10b)][_0x17ac3b(0x1a6)](0x2))+_0x17ac3b(0x143),_0x5d72b2+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x10b695[_0x17ac3b(0x123)]['toFixed'](0x2))+_0x17ac3b(0x143),_0x5d72b2+=_0x17ac3b(0xe8),_0xa6fb92+=parseFloat(_0x10b695[_0x17ac3b(0x10b)]),_0x23344d+=parseFloat(_0x10b695[_0x17ac3b(0x123)]);}var _0x5e2394=_0x23344d[_0x17ac3b(0x22e)](undefined),_0x573af4=_0xa6fb92[_0x17ac3b(0x22e)](undefined);return _0x5d72b2+=_0x17ac3b(0x134),_0x5d72b2+=_0x17ac3b(0x202),_0x5d72b2+=_0x17ac3b(0x243)+formatNumber(_0xa6fb92[_0x17ac3b(0x1a6)](0x2))+_0x17ac3b(0x101),_0x5d72b2+=_0x17ac3b(0x243)+formatNumber(_0x23344d[_0x17ac3b(0x1a6)](0x2))+_0x17ac3b(0x101),_0x5d72b2+=_0x17ac3b(0xe8),_0x5d72b2;}router['post'](a0_0x5de9ce(0x189),auth,async(_0x2ae1f0,_0x105237)=>{const _0x411257=a0_0x5de9ce;try{const {from_date:_0x16dbc8,to_date:_0x56ba99,isExcel:_0x4ac31e}=_0x2ae1f0[_0x411257(0x18d)],_0x561a75=_0x2ae1f0[_0x411257(0x1f3)],_0x216ccf=await staff[_0x411257(0x24c)]({'email':_0x561a75[_0x411257(0x10d)]});let _0x171b43='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x2bc9a8=new Date(_0x16dbc8),_0x2ed341=new Date(_0x56ba99);const _0x4db6da={'year':_0x411257(0x1dc),'month':'long','day':_0x411257(0x1dc)},_0x3265be=new Intl[(_0x411257(0x10e))](_0x411257(0x1ae),_0x4db6da)['format'](_0x2bc9a8),_0x5ac521=new Intl[(_0x411257(0x10e))]('en-US',_0x4db6da)['format'](_0x2ed341);var _0x156432=await dataSalesReports(_0x16dbc8,_0x56ba99,_0x216ccf[_0x411257(0x261)]['valueOf']());_0x171b43+='<div\x20class=\x22row\x22>',_0x171b43+=_0x411257(0x248),_0x171b43+='<table>',_0x171b43+=_0x411257(0x134),_0x171b43+='<th>\x20ITEM\x20CODE\x20</th>',_0x171b43+=_0x411257(0x108),_0x171b43+=_0x411257(0x236),_0x171b43+=_0x411257(0x262),_0x171b43+=_0x411257(0x134),_0x171b43+=_0x156432,_0x171b43+='</tr>',_0x171b43+=_0x411257(0x1d9),_0x171b43+='</div>';let _0x341794=_0x411257(0x128);const _0x5ca04d={'width':_0x411257(0x24d),'height':'8.5in','orientation':'landscape','border':{'top':'0.1in','right':_0x411257(0xe2),'bottom':_0x411257(0xe2),'left':_0x411257(0xe2)},'header':{'height':'60mm','contents':_0x411257(0x1a9)+_0x341794+_0x411257(0x213)+_0x216ccf[_0x411257(0x158)]+_0x411257(0x149)+_0x3265be+_0x411257(0x17d)+_0x5ac521+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x411257(0x231),'contents':{'default':_0x411257(0x1d7)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x411257(0x185)}}};if(_0x4ac31e=='on'){const _0x55c1f0=cheerio[_0x411257(0x1d4)](_0x171b43);let _0x424283=[],_0x4dfcd1=[],_0x1f9b06=[];const _0x105f5a=_0x3a689c=>{const _0x1c640e=_0x411257,_0x7607ea={'top':{'style':_0x1c640e(0x239),'color':{'rgb':_0x1c640e(0x24a)}},'bottom':{'style':'thick','color':{'rgb':_0x1c640e(0x24a)}},'left':{'style':_0x1c640e(0x239),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x1c640e(0x24a)}}};if(_0x3a689c){const _0x128e55=_0x3a689c['split'](';')[_0x1c640e(0x190)]((_0x4e8857,_0x71c596)=>{const _0x31fe92=_0x1c640e,[_0x329a40,_0x3deebf]=_0x71c596[_0x31fe92(0x1c9)](':')[_0x31fe92(0x13d)](_0x4bbf17=>_0x4bbf17[_0x31fe92(0x20b)]());return _0x4e8857[_0x329a40]=_0x3deebf,_0x4e8857;},{});_0x128e55[_0x1c640e(0x197)]&&(_0x7607ea[_0x1c640e(0x14d)][_0x1c640e(0x16c)]=_0x128e55[_0x1c640e(0x197)][_0x1c640e(0x252)](_0x1c640e(0xe6))?_0x1c640e(0xe6):_0x1c640e(0x1e4)),_0x128e55['border-bottom']&&(_0x7607ea[_0x1c640e(0x1fc)]['style']=_0x128e55[_0x1c640e(0xf4)]['includes'](_0x1c640e(0xe6))?'thin':_0x1c640e(0x1e4)),_0x128e55[_0x1c640e(0x1cb)]&&(_0x7607ea[_0x1c640e(0x136)]['style']=_0x128e55['border-left'][_0x1c640e(0x252)](_0x1c640e(0xe6))?_0x1c640e(0xe6):_0x1c640e(0x1e4)),_0x128e55[_0x1c640e(0x191)]&&(_0x7607ea['right'][_0x1c640e(0x16c)]=_0x128e55[_0x1c640e(0x191)][_0x1c640e(0x252)](_0x1c640e(0xe6))?_0x1c640e(0xe6):'medium');}return _0x7607ea;};_0x55c1f0(_0x411257(0xec))['each']((_0x153ba6,_0xc5f85f)=>{const _0xbd4a17=_0x411257;let _0x412ae9=[],_0x15d693=0x0;while(_0x1f9b06[_0x15d693]){_0x1f9b06[_0x15d693]--,_0x15d693++;}_0x55c1f0(_0xc5f85f)['find'](_0xbd4a17(0x22a))[_0xbd4a17(0x18e)]((_0x49dd25,_0x326db)=>{const _0xa9930b=_0xbd4a17;let _0x1030fe=_0x55c1f0(_0x326db)[_0xa9930b(0x1c6)]()[_0xa9930b(0x20b)](),_0x2a7db8=parseFloat(_0x1030fe[_0xa9930b(0x216)](/,/g,'')),_0xdf0c0a={};!isNaN(_0x2a7db8)?(_0xdf0c0a['v']=_0x2a7db8,_0xdf0c0a['t']='n'):(_0xdf0c0a['v']=_0x1030fe,_0xdf0c0a['t']='s');const _0x5c646c=_0x55c1f0(_0x326db)['attr'](_0xa9930b(0x16c)),_0x4e8d8e=_0x105f5a(_0x5c646c);_0xdf0c0a['s']={'border':_0x4e8d8e},_0x412ae9[_0x15d693]=_0xdf0c0a;let _0x361a54=parseInt(_0x55c1f0(_0x326db)['attr'](_0xa9930b(0x265)))||0x1,_0x233268=parseInt(_0x55c1f0(_0x326db)[_0xa9930b(0x170)](_0xa9930b(0x167)))||0x1;(_0x361a54>0x1||_0x233268>0x1)&&_0x4dfcd1[_0xa9930b(0x1ba)]({'s':{'r':_0x153ba6,'c':_0x15d693},'e':{'r':_0x153ba6+_0x233268-0x1,'c':_0x15d693+_0x361a54-0x1}});for(let _0x196e2b=0x0;_0x196e2b<_0x361a54;_0x196e2b++){_0x233268>0x1&&(_0x1f9b06[_0x15d693+_0x196e2b]=_0x233268-0x1);}_0x15d693+=_0x361a54;}),_0x424283[_0xbd4a17(0x1ba)](_0x412ae9);});const _0x5b4a90=XLSX[_0x411257(0x15c)]['book_new'](),_0x3009c2=XLSX[_0x411257(0x15c)][_0x411257(0x217)](_0x424283);_0x4dfcd1[_0x411257(0x17a)]>0x0&&(_0x3009c2[_0x411257(0x1d3)]=_0x4dfcd1);_0x3009c2[_0x411257(0x1bf)]=_0x424283[0x0][_0x411257(0x13d)](()=>({'wpx':0x64})),XLSX['utils'][_0x411257(0x1b6)](_0x5b4a90,_0x3009c2,_0x411257(0x1e9));const _0x4de0c2=XLSX[_0x411257(0x15b)](_0x5b4a90,{'bookType':_0x411257(0xe7),'type':_0x411257(0x238)});_0x105237['setHeader'](_0x411257(0x178),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x105237[_0x411257(0x160)](_0x411257(0x25a),_0x411257(0x1a5)),_0x105237[_0x411257(0x194)](_0x4de0c2);}else pdf[_0x411257(0x218)](_0x171b43,_0x5ca04d)[_0x411257(0x171)](function(_0x343270,_0x18b37c){const _0x32fc10=_0x411257;if(_0x343270){_0x105237[_0x32fc10(0x1e8)](0x1f4)[_0x32fc10(0x194)](_0x32fc10(0x228));return;}_0x105237[_0x32fc10(0x160)](_0x32fc10(0x25a),_0x32fc10(0x259)),_0x18b37c[_0x32fc10(0x255)](_0x105237);});}catch(_0x47b336){}}),router['get'](a0_0x5de9ce(0x1c2),auth,async(_0x3a3a2e,_0xd40d7f)=>{const _0x2d3a79=a0_0x5de9ce;try{const {username:_0x892673,email:_0x148ad3,role:_0x20b6f5}=_0x3a3a2e[_0x2d3a79(0x1f3)],_0x1fc5ad=_0x3a3a2e[_0x2d3a79(0x1f3)],_0x5617df=await profile['findOne']({'email':_0x1fc5ad[_0x2d3a79(0x10d)]}),_0x5b103c={'year':'numeric','month':_0x2d3a79(0x223),'day':_0x2d3a79(0x1dc)},_0x570d8b=await master_shop[_0x2d3a79(0xe9)](),_0x545099=await product[_0x2d3a79(0xe9)](),_0x5b01d4=await warehouse['aggregate']([{'$unwind':_0x2d3a79(0x119)},{'$lookup':{'from':_0x2d3a79(0x26d),'localField':_0x2d3a79(0x1b7),'foreignField':_0x2d3a79(0x158),'as':_0x2d3a79(0x140)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x2d3a79(0x1c5),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);if(_0x570d8b[0x0][_0x2d3a79(0x174)]==_0x2d3a79(0x22c))var _0x3072f7=users[_0x2d3a79(0x1bd)];else{if(_0x570d8b[0x0]['language']==_0x2d3a79(0xf7))var _0x3072f7=users[_0x2d3a79(0xf7)];else{if(_0x570d8b[0x0][_0x2d3a79(0x174)]=='German')var _0x3072f7=users['German'];else{if(_0x570d8b[0x0]['language']==_0x2d3a79(0x221))var _0x3072f7=users[_0x2d3a79(0x221)];else{if(_0x570d8b[0x0]['language']==_0x2d3a79(0x1b5))var _0x3072f7=users['French'];else{if(_0x570d8b[0x0]['language']==_0x2d3a79(0x1f6))var _0x3072f7=users[_0x2d3a79(0x100)];else{if(_0x570d8b[0x0]['language']==_0x2d3a79(0x14c))var _0x3072f7=users[_0x2d3a79(0x14c)];else{if(_0x570d8b[0x0][_0x2d3a79(0x174)]==_0x2d3a79(0x242))var _0x3072f7=users[_0x2d3a79(0x1d8)];}}}}}}}_0xd40d7f['render']('inventory_sum',{'success':_0x3a3a2e[_0x2d3a79(0x159)](_0x2d3a79(0xe4)),'errors':_0x3a3a2e['flash'](_0x2d3a79(0x201)),'alldata':_0x545099,'profile':_0x5617df,'master_shop':_0x570d8b,'role':_0x1fc5ad,'product_stock':_0x5b01d4,'language':_0x3072f7});}catch(_0x5ccbfb){}});async function dataInventoryReports(_0x468a67,_0x3ed955,_0x44c457){const _0x546be6=a0_0x5de9ce,_0x3ebd11=await sales_sa[_0x546be6(0xfb)]([{'$match':{'date':{'$gte':_0x468a67,'$lte':_0x3ed955},'sales_staff_id':_0x44c457}},{'$unwind':_0x546be6(0x17e)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x546be6(0x19d)},'sumqty':{'$sum':_0x546be6(0x25c)}}},{'$sort':{'_id.product_name':0x1}}]),_0x454bcd=mongoose['Types'][_0x546be6(0x1d0)],_0x56d63d=await staff[_0x546be6(0xfb)]([{'$match':{'_id':_0x454bcd(_0x44c457)}},{'$unwind':_0x546be6(0xf0)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x546be6(0x24f),'product_code':_0x546be6(0x1ca)},'sumqty':{'$sum':_0x546be6(0xf5)}}},{'$sort':{'_id.product_name':0x1}}]),_0x3bdec8=await sales_inv_data[_0x546be6(0xfb)]([{'$match':{'date':{'$gte':_0x468a67,'$lte':_0x3ed955},'sales_staff_id':_0x44c457}},{'$unwind':_0x546be6(0x17e)},{'$group':{'_id':{'product_name':_0x546be6(0x1b2),'product_code':'$sale_product.product_code'},'totalQTYsum':{'$sum':_0x546be6(0x25e)}}}]);console[_0x546be6(0x1be)](_0x3bdec8);let _0x5ef774='';var _0x370d33=0x0;for(let _0x3bf9b0=0x0;_0x3bf9b0<=_0x56d63d[_0x546be6(0x17a)]-0x1;_0x3bf9b0++){const _0x3d4a14=_0x56d63d[_0x3bf9b0];_0x5ef774+=_0x546be6(0x134),_0x5ef774+=_0x546be6(0x20a)+_0x3d4a14['_id'][_0x546be6(0x1f7)]+_0x546be6(0x143),_0x5ef774+=_0x546be6(0x152)+_0x3d4a14['_id'][_0x546be6(0x1ea)]+_0x546be6(0x143);var _0x471cb3=_0x3d4a14[_0x546be6(0x10b)],_0x4af020=0x0;for(let _0x310752=0x0;_0x310752<=_0x3ebd11[_0x546be6(0x17a)]-0x1;_0x310752++){const _0x31e9a1=_0x3ebd11[_0x310752];_0x3d4a14[_0x546be6(0x261)]['product_code']==_0x31e9a1[_0x546be6(0x261)][_0x546be6(0x1f7)]&&_0x3d4a14[_0x546be6(0x261)][_0x546be6(0x1ea)]==_0x31e9a1['_id']['product_name']&&(_0x4af020=_0x31e9a1[_0x546be6(0x10b)]);}var _0xdb742d=0x0;for(let _0x16e990=0x0;_0x16e990<=_0x3bdec8[_0x546be6(0x17a)]-0x1;_0x16e990++){const _0x4ae781=_0x3bdec8[_0x16e990];_0x3d4a14[_0x546be6(0x261)][_0x546be6(0x1f7)]==_0x4ae781['_id'][_0x546be6(0x1f7)]&&_0x3d4a14[_0x546be6(0x261)][_0x546be6(0x1ea)]==_0x4ae781['_id'][_0x546be6(0x1ea)]&&(_0xdb742d=_0x4ae781[_0x546be6(0x110)]);}_0x370d33=_0x471cb3-_0xdb742d+_0x4af020,_0x5ef774+=_0x546be6(0x26b)+_0x370d33+_0x546be6(0x143);let _0x33f01f=![];for(let _0x286431=0x0;_0x286431<=_0x3bdec8['length']-0x1;_0x286431++){const _0x57d49d=_0x3bdec8[_0x286431];if(_0x3d4a14[_0x546be6(0x261)][_0x546be6(0x1f7)]==_0x57d49d[_0x546be6(0x261)][_0x546be6(0x1f7)]&&_0x3d4a14[_0x546be6(0x261)][_0x546be6(0x1ea)]==_0x57d49d[_0x546be6(0x261)][_0x546be6(0x1ea)]){_0x5ef774+=_0x546be6(0x26b)+_0x57d49d[_0x546be6(0x110)]+'</td>',_0x33f01f=!![];break;}}!_0x33f01f&&(_0x5ef774+=_0x546be6(0x129));let _0x236bf8=![];for(let _0x3ac00a=0x0;_0x3ac00a<=_0x3ebd11[_0x546be6(0x17a)]-0x1;_0x3ac00a++){const _0x35b51a=_0x3ebd11[_0x3ac00a];if(_0x3d4a14[_0x546be6(0x261)][_0x546be6(0x1f7)]==_0x35b51a['_id'][_0x546be6(0x1f7)]&&_0x3d4a14[_0x546be6(0x261)][_0x546be6(0x1ea)]==_0x35b51a[_0x546be6(0x261)][_0x546be6(0x1ea)]){_0x5ef774+='<td\x20class=\x22row_data\x22>'+_0x35b51a[_0x546be6(0x10b)]+_0x546be6(0x143),_0x236bf8=!![];break;}}!_0x236bf8&&(_0x5ef774+=_0x546be6(0x129)),_0x5ef774+='<td\x20class=\x22row_data\x22>'+_0x3d4a14[_0x546be6(0x10b)]+_0x546be6(0x143),_0x5ef774+=_0x546be6(0xe8);}return _0x5ef774;}function a0_0x28b6(_0x2a0f4b,_0x330a7c){const _0x3686db=a0_0x3686();return a0_0x28b6=function(_0x28b60a,_0x3981bb){_0x28b60a=_0x28b60a-0xe2;let _0x423803=_0x3686db[_0x28b60a];return _0x423803;},a0_0x28b6(_0x2a0f4b,_0x330a7c);}router['post'](a0_0x5de9ce(0x181),auth,async(_0x43c54a,_0x4f9541)=>{const _0x552b83=a0_0x5de9ce;try{const {from_date:_0x1c9311,to_date:_0x2201b2}=_0x43c54a[_0x552b83(0x18d)],_0x3d4b4a=_0x43c54a['user'],_0x301b3f=await staff[_0x552b83(0x24c)]({'email':_0x3d4b4a[_0x552b83(0x10d)]});let _0x56eda9=_0x552b83(0x12c);var _0x3aa077=new Date(_0x1c9311),_0x316835=new Date(_0x2201b2);const _0x5d3549={'year':'numeric','month':_0x552b83(0x223),'day':'numeric'},_0x314e71=new Intl[(_0x552b83(0x10e))]('en-US',_0x5d3549)[_0x552b83(0x20c)](_0x3aa077),_0x375d22=new Intl[(_0x552b83(0x10e))](_0x552b83(0x1ae),_0x5d3549)[_0x552b83(0x20c)](_0x316835);var _0x5df275=await dataInventoryReports(_0x1c9311,_0x2201b2,_0x301b3f[_0x552b83(0x261)][_0x552b83(0x235)]());_0x56eda9+=_0x552b83(0x257),_0x56eda9+=_0x552b83(0x1ad),_0x56eda9+=_0x552b83(0x166)+_0x314e71+'\x20-\x20'+_0x375d22+_0x552b83(0x1eb),_0x56eda9+=_0x552b83(0x241),_0x56eda9+='<div\x20class=\x22col-sm-11\x22>',_0x56eda9+=_0x552b83(0xff),_0x56eda9+='<tr>',_0x56eda9+=_0x552b83(0x23f),_0x56eda9+=_0x552b83(0x108),_0x56eda9+='<th>\x20BEG\x20BALANCE\x20</th>',_0x56eda9+=_0x552b83(0x23e),_0x56eda9+=_0x552b83(0x10f),_0x56eda9+=_0x552b83(0x1a0),_0x56eda9+=_0x552b83(0x134),_0x56eda9+=_0x5df275,_0x56eda9+=_0x552b83(0xe8),_0x56eda9+=_0x552b83(0x1d9),_0x56eda9+='</div>';const _0x5429af={'format':_0x552b83(0x12b),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf['create'](_0x56eda9,_0x5429af)[_0x552b83(0x171)](function(_0x48436d,_0xbc9489){const _0x200f48=_0x552b83;if(_0x48436d){_0x4f9541[_0x200f48(0x1e8)](0x1f4)[_0x200f48(0x194)](_0x200f48(0x228));return;}_0x4f9541['setHeader'](_0x200f48(0x25a),_0x200f48(0x259)),_0xbc9489[_0x200f48(0x255)](_0x4f9541);});}catch(_0x523bbc){}}),router[a0_0x5de9ce(0x15e)](a0_0x5de9ce(0x163),auth,async(_0x4243ca,_0x2e331f)=>{const _0x598a12=a0_0x5de9ce;try{const {username:_0x5b488c,email:_0x3f5a7b,role:_0x4401db}=_0x4243ca[_0x598a12(0x1f3)],_0x2841e5=_0x4243ca[_0x598a12(0x1f3)],_0x5ef574=await profile[_0x598a12(0x24c)]({'email':_0x2841e5[_0x598a12(0x10d)]}),_0x44db66={'year':'numeric','month':_0x598a12(0x223),'day':_0x598a12(0x1dc)},_0x2ddd4c=await master_shop[_0x598a12(0xe9)]();console[_0x598a12(0x1be)](_0x598a12(0x1cc),_0x2ddd4c);const _0x12b2af=await product[_0x598a12(0xe9)]();console[_0x598a12(0x1be)](_0x598a12(0xef),_0x12b2af);const _0x34cc53=await warehouse[_0x598a12(0xfb)]([{'$unwind':_0x598a12(0x119)},{'$lookup':{'from':_0x598a12(0x26d),'localField':_0x598a12(0x1b7),'foreignField':'name','as':_0x598a12(0x140)}},{'$unwind':_0x598a12(0x139)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x598a12(0x137)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x598a12(0x267)}}}]);console[_0x598a12(0x1be)](_0x598a12(0x13c),_0x34cc53),_0x34cc53[_0x598a12(0x187)](_0x5a42ff=>{const _0x5a04b6=_0x598a12,_0x3da797=_0x12b2af[_0x5a04b6(0x13d)](_0x48ae1d=>{const _0x4a0a72=_0x5a04b6;_0x48ae1d[_0x4a0a72(0x158)]==_0x5a42ff[_0x4a0a72(0x261)]&&(_0x48ae1d[_0x4a0a72(0x22d)]=parseInt(_0x48ae1d[_0x4a0a72(0x22d)])+parseInt(_0x5a42ff['product_stock']));});});const _0x11233f=await staff[_0x598a12(0x24c)]({'email':_0x2841e5['email']});if(_0x2ddd4c[0x0]['language']==_0x598a12(0x22c))var _0x4f5382=users[_0x598a12(0x1bd)];else{if(_0x2ddd4c[0x0][_0x598a12(0x174)]=='Hindi')var _0x4f5382=users[_0x598a12(0xf7)];else{if(_0x2ddd4c[0x0][_0x598a12(0x174)]==_0x598a12(0x172))var _0x4f5382=users['German'];else{if(_0x2ddd4c[0x0]['language']==_0x598a12(0x221))var _0x4f5382=users[_0x598a12(0x221)];else{if(_0x2ddd4c[0x0]['language']=='French')var _0x4f5382=users[_0x598a12(0x1b5)];else{if(_0x2ddd4c[0x0][_0x598a12(0x174)]==_0x598a12(0x1f6))var _0x4f5382=users['Portuguese'];else{if(_0x2ddd4c[0x0][_0x598a12(0x174)]==_0x598a12(0x14c))var _0x4f5382=users[_0x598a12(0x14c)];else{if(_0x2ddd4c[0x0][_0x598a12(0x174)]==_0x598a12(0x242))var _0x4f5382=users[_0x598a12(0x1d8)];}}}}}}}_0x2e331f[_0x598a12(0x1ef)](_0x598a12(0x127),{'success':_0x4243ca[_0x598a12(0x159)](_0x598a12(0xe4)),'errors':_0x4243ca['flash']('errors'),'alldata':_0x12b2af,'profile':_0x5ef574,'master_shop':_0x2ddd4c,'role':_0x2841e5,'product_stock':_0x34cc53,'language':_0x4f5382,'staff_arr':_0x11233f});}catch(_0x813a9d){}});async function agentsdataDSICheck_DSRR(_0x449e6e,_0x51abdd,_0x54092d,_0x2261bb){const _0x2c07cc=a0_0x5de9ce;let _0x5d5cb5=new Date(_0x449e6e);_0x5d5cb5[_0x2c07cc(0x1b9)](_0x5d5cb5[_0x2c07cc(0x115)]()-0x1);let _0x32d24e=_0x5d5cb5[_0x2c07cc(0x22f)]()[_0x2c07cc(0x1c9)]('T')[0x0];const _0x35798d=await product[_0x2c07cc(0xfb)]([{'$group':{'_id':{'brand':'$brand','category':_0x2c07cc(0x1f0)},'products':{'$push':{'name':_0x2c07cc(0x260),'product_code':_0x2c07cc(0x1d5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2d917e=[];_0x2d917e[_0x2c07cc(0x19e)]=[];for(let _0xdb7b83=0x0;_0xdb7b83<=_0x35798d[_0x2c07cc(0x17a)]-0x1;_0xdb7b83++){const _0x1f3dde=_0x35798d[_0xdb7b83];_0x2d917e['cat_brand'][_0x2c07cc(0x1ba)](_0x1f3dde);}const _0x4cb530=await product['aggregate']([{'$group':{'_id':{'category':_0x2c07cc(0x1f0)},'products':{'$push':{'brand':_0x2c07cc(0x177),'product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x357620=await product[_0x2c07cc(0xfb)]([{'$group':{'_id':{'category':_0x2c07cc(0x1f0),'brand':_0x2c07cc(0x177)}}},{'$group':{'_id':_0x2c07cc(0x1aa),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x983dc2=await sales_sa[_0x2c07cc(0xfb)]([{'$match':{'date':_0x449e6e,'sales_staff_id':_0x51abdd,'sale_product.isFG':_0x2c07cc(0x253)}},{'$unwind':_0x2c07cc(0x17e)},{'$lookup':{'from':'products','localField':_0x2c07cc(0x142),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x2c07cc(0x264)},{'$group':{'_id':{'dsi':_0x2c07cc(0xfe),'date':'$date','customer':_0x2c07cc(0x258),'status_data':_0x2c07cc(0x1e3)},'totalQty':{'$sum':_0x2c07cc(0x240)},'cash':{'$first':_0x2c07cc(0x237)},'amount':{'$first':_0x2c07cc(0x1f8)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x2c07cc(0xf8)},'due_date':{'$first':_0x2c07cc(0x19f)},'products':{'$push':{'qty':_0x2c07cc(0x240),'NetPrice':_0x2c07cc(0x1bb),'discount':_0x2c07cc(0x164),'adj_discount':_0x2c07cc(0x182),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':_0x2c07cc(0x150),'brand':_0x2c07cc(0x111),'gross_price':_0x2c07cc(0x162),'isFG':_0x2c07cc(0x199),'prod_cat':'$sale_product.prod_cat','prod_id':_0x2c07cc(0xe5)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x2c07cc(0x1df),'date':_0x2c07cc(0x155),'customer':_0x2c07cc(0xfa),'status_data':_0x2c07cc(0x205),'category':_0x2c07cc(0x102),'brand':'$products.product_details.brand','prod_id':_0x2c07cc(0x22b)},'totalQty':{'$sum':_0x2c07cc(0x1ec)},'totalGross':{'$sum':{'$multiply':[_0x2c07cc(0x1ec),_0x2c07cc(0x1e7)]}},'NetPrice':{'$sum':_0x2c07cc(0x1e2)},'discount':{'$sum':_0x2c07cc(0xf9)},'adj_discount':{'$sum':_0x2c07cc(0x15f)},'cash':{'$first':_0x2c07cc(0x237)},'amount':{'$first':_0x2c07cc(0x1f8)},'bank':{'$first':_0x2c07cc(0xee)},'check_no':{'$first':_0x2c07cc(0xf8)},'due_date':{'$first':_0x2c07cc(0x19f)},'product_details':{'$first':_0x2c07cc(0xeb)}}},{'$group':{'_id':{'dsi':_0x2c07cc(0x1df),'date':_0x2c07cc(0x155),'customer':_0x2c07cc(0xfa),'status_data':_0x2c07cc(0x205)},'totalQty':{'$sum':_0x2c07cc(0x12f)},'totalGross':{'$sum':_0x2c07cc(0x1f5)},'NetPrice':{'$sum':_0x2c07cc(0x15a)},'discount':{'$sum':_0x2c07cc(0xf1)},'adj_discount':{'$sum':_0x2c07cc(0x266)},'cash':{'$first':_0x2c07cc(0x237)},'amount':{'$first':_0x2c07cc(0x1f8)},'bank':{'$first':_0x2c07cc(0xee)},'check_no':{'$first':_0x2c07cc(0xf8)},'due_date':{'$first':_0x2c07cc(0x19f)},'products':{'$push':{'qty':_0x2c07cc(0x12f),'category':_0x2c07cc(0x1aa),'brand':_0x2c07cc(0x1ed),'product_details':_0x2c07cc(0x119)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x7afc8e=await sales_sa[_0x2c07cc(0xfb)]([{'$match':{'date':_0x32d24e,'sales_staff_id':_0x51abdd,'sale_product.isFG':'false'}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x2c07cc(0x26d),'localField':'sale_product.product_code','foreignField':_0x2c07cc(0x1f7),'as':_0x2c07cc(0x263)}},{'$unwind':_0x2c07cc(0x264)},{'$group':{'_id':{'dsi':'$dsi','date':_0x2c07cc(0x106),'customer':_0x2c07cc(0x258)},'totalQty':{'$sum':_0x2c07cc(0x240)},'cash':{'$first':_0x2c07cc(0x237)},'amount':{'$first':_0x2c07cc(0x1f8)},'bank':{'$first':_0x2c07cc(0xee)},'check_no':{'$first':_0x2c07cc(0xf8)},'due_date':{'$first':_0x2c07cc(0x19f)},'products':{'$push':{'qty':_0x2c07cc(0x240),'NetPrice':_0x2c07cc(0x1bb),'discount':_0x2c07cc(0x164),'adj_discount':_0x2c07cc(0x182),'product_details':{'prod_name':_0x2c07cc(0x1d6),'product_code':_0x2c07cc(0x11a),'category':_0x2c07cc(0x150),'brand':'$product_info.brand','gross_price':_0x2c07cc(0x162),'isFG':_0x2c07cc(0x199),'prod_cat':'$sale_product.prod_cat','prod_id':_0x2c07cc(0xe5)}}}}},{'$unwind':_0x2c07cc(0x179)},{'$group':{'_id':{'dsi':_0x2c07cc(0x1df),'date':_0x2c07cc(0x155),'customer':_0x2c07cc(0xfa),'category':_0x2c07cc(0x102),'brand':_0x2c07cc(0x161),'prod_id':_0x2c07cc(0x22b)},'totalQty':{'$sum':_0x2c07cc(0x1ec)},'cash':{'$first':_0x2c07cc(0x237)},'amount':{'$first':_0x2c07cc(0x1f8)},'bank':{'$first':_0x2c07cc(0xee)},'check_no':{'$first':_0x2c07cc(0xf8)},'due_date':{'$first':_0x2c07cc(0x19f)},'totalGross':{'$sum':{'$multiply':[_0x2c07cc(0x1ec),_0x2c07cc(0x1e7)]}},'NetPrice':{'$sum':_0x2c07cc(0x1e2)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x2c07cc(0x15f)},'product_details':{'$first':_0x2c07cc(0xeb)}}},{'$group':{'_id':{'dsi':_0x2c07cc(0x1df),'date':_0x2c07cc(0x155),'customer':_0x2c07cc(0xfa)},'totalQty':{'$sum':_0x2c07cc(0x12f)},'cash':{'$first':'$cash'},'amount':{'$first':_0x2c07cc(0x1f8)},'bank':{'$first':_0x2c07cc(0xee)},'check_no':{'$first':_0x2c07cc(0xf8)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':_0x2c07cc(0x1f5)},'NetPrice':{'$sum':_0x2c07cc(0x15a)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x2c07cc(0x12f),'category':_0x2c07cc(0x1aa),'brand':_0x2c07cc(0x1ed),'product_details':_0x2c07cc(0x119)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x29a2dc=await sales_sa['aggregate']([{'$match':{'date':_0x449e6e,'sales_staff_id':_0x51abdd,'status_data':_0x2c07cc(0x21a)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x52efc8=await staff['findById'](_0x51abdd);let _0x18a258=[],_0x51e0c2={},_0x5bca10={};var _0x21d44c=0x0,_0x81953c=0x0,_0x284b02=0x0,_0x21d4cd=0x0,_0x4f50de=0x0;const _0x516453=0x6;var _0x30c338=0x0,_0x219e16=0x0;for(let _0x30b592=0x0;_0x30b592<=_0x983dc2['length']-0x1;_0x30b592++){const _0x2b57bb=_0x983dc2[_0x30b592];let _0xac2f05=_0x2c07cc(0x134);_0xac2f05+=_0x2c07cc(0x138),_0xac2f05+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2b57bb['_id'][_0x2c07cc(0x186)]+_0x2c07cc(0x143),_0xac2f05+=_0x2c07cc(0x210)+_0x2b57bb[_0x2c07cc(0x261)][_0x2c07cc(0x25b)]+_0x2c07cc(0x143);let _0x41db17={},_0x58b616={},_0x188f38={};var _0x50ef9d={},_0x187ae2={},_0x2d6a27={},_0x8535c=0x0;for(let _0x4e6a9b=0x0;_0x4e6a9b<=_0x2b57bb[_0x2c07cc(0x26d)]['length']-0x1;_0x4e6a9b++){const _0x27e7a6=_0x2b57bb[_0x2c07cc(0x26d)][_0x4e6a9b];_0x41db17[_0x27e7a6[_0x2c07cc(0x1c7)]+'-'+_0x27e7a6[_0x2c07cc(0x25f)]]=_0x27e7a6[_0x2c07cc(0x269)],_0x58b616[[_0x27e7a6[_0x2c07cc(0x1c7)]+'-'+_0x27e7a6['category']]]=_0x27e7a6['product_details'][_0x2c07cc(0x1a1)],_0x188f38[[_0x27e7a6['brand']+'-'+_0x27e7a6[_0x2c07cc(0x25f)]]]=_0x27e7a6[_0x2c07cc(0x112)][_0x2c07cc(0x1e1)];const _0x22c31c=_0x27e7a6['brand']+'-'+_0x27e7a6[_0x2c07cc(0x25f)];!Array[_0x2c07cc(0x11d)](_0x5bca10[_0x22c31c])&&(_0x5bca10[_0x22c31c]=[]);!Array['isArray'](_0x5bca10[_0x22c31c])&&(_0x5bca10[_0x22c31c]=[]);_0x5bca10[_0x22c31c][_0x2c07cc(0x1ba)](_0x27e7a6[_0x2c07cc(0x269)]);if(_0x27e7a6[_0x2c07cc(0x112)][_0x2c07cc(0x1e1)]=='P')_0x27e7a6[_0x2c07cc(0x112)][_0x2c07cc(0x1a1)]=='true'?(!_0x2d6a27[_0x22c31c]&&(_0x2d6a27[_0x22c31c]=0x0),_0x2d6a27[_0x22c31c]=_0x27e7a6['qty']):(!_0x50ef9d[_0x22c31c]&&(_0x50ef9d[_0x22c31c]=0x0),_0x50ef9d[_0x22c31c]=_0x27e7a6[_0x2c07cc(0x269)]);else _0x27e7a6[_0x2c07cc(0x112)]['prod_cat']=='S'&&(_0x27e7a6[_0x2c07cc(0x112)][_0x2c07cc(0x1a1)]==_0x2c07cc(0x21a)?(!_0x2d6a27[_0x22c31c]&&(_0x2d6a27[_0x22c31c]=0x0),_0x2d6a27[_0x22c31c]=_0x27e7a6['qty']):(!_0x187ae2[_0x22c31c]&&(_0x187ae2[_0x22c31c]=0x0),_0x187ae2[_0x22c31c]=_0x27e7a6[_0x2c07cc(0x269)]));_0x8535c++;}for(let _0x52db0b=0x0;_0x52db0b<=_0x2d917e['cat_brand'][_0x2c07cc(0x17a)]-0x1;_0x52db0b++){const _0x2b497e=_0x2d917e[_0x2c07cc(0x19e)][_0x52db0b],_0x41476e=_0x2b497e[_0x2c07cc(0x261)][_0x2c07cc(0x1c7)]+'-'+_0x2b497e['_id'][_0x2c07cc(0x25f)],_0x22e8a1=_0x188f38[_0x41476e]!==undefined?_0x188f38[_0x41476e]:'NA';var _0x1f6316=_0x50ef9d[_0x41476e]!==undefined?_0x50ef9d[_0x41476e][_0x2c07cc(0x1a6)](0x2):'',_0x7cc061=_0x187ae2[_0x41476e]!==undefined?_0x187ae2[_0x41476e][_0x2c07cc(0x1a6)](0x2):'',_0x1cc10c=_0x2d6a27[_0x41476e]!==undefined?_0x2d6a27[_0x41476e][_0x2c07cc(0x1a6)](0x2):'';_0xac2f05+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x1f6316+'</td>',_0xac2f05+=_0x2c07cc(0x131)+_0x7cc061+'</td>',_0xac2f05+=_0x2c07cc(0x131)+_0x1cc10c+_0x2c07cc(0x143);}var _0x1f5eb2=formatNumber(parseFloat(_0x2b57bb['cash'])),_0x5b35e6=formatNumber(parseFloat(_0x2b57bb[_0x2c07cc(0x215)]));isNaN(_0x5b35e6)&&(_0x5b35e6=0x0),_0xac2f05+=_0x2c07cc(0x131)+_0x1f5eb2+_0x2c07cc(0x143),_0xac2f05+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x5b35e6+_0x2c07cc(0x143),_0xac2f05+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2b57bb[_0x2c07cc(0x268)]+_0x2c07cc(0x143),_0xac2f05+=_0x2c07cc(0x210)+_0x2b57bb[_0x2c07cc(0xea)]+'</td>',_0xac2f05+=_0x2c07cc(0x210)+_0x2b57bb['due_date']+_0x2c07cc(0x143),_0x284b02=_0x2b57bb['discount']+_0x2b57bb['adj_discount'],_0x30c338+=parseFloat(_0x2b57bb[_0x2c07cc(0x249)]),_0x219e16+=parseFloat(_0x5b35e6),_0x18a258[_0x2c07cc(0x1ba)](_0xac2f05);}function _0x33ed3e(_0x26952f,_0x3c8307){const _0x250e3a=_0x2c07cc,_0x18e2cf=[];for(let _0x541a92=0x0;_0x541a92<=_0x26952f[_0x250e3a(0x17a)]-0x1;_0x541a92+=_0x3c8307){_0x18e2cf[_0x250e3a(0x1ba)](_0x26952f[_0x250e3a(0x1e6)](_0x541a92,_0x541a92+_0x3c8307));}return _0x18e2cf;}const _0x549866=_0x33ed3e(_0x18a258,_0x516453);let _0x5a7bab='';return _0x549866[_0x2c07cc(0x187)]((_0x273895,_0x220a41)=>{const _0x5bc696=_0x2c07cc;_0x220a41>0x0&&(_0x5a7bab+=_0x5bc696(0x12a));_0x5a7bab+=_0x5bc696(0xff),_0x5a7bab+='<thead>';const _0x17a5b9=new Date(_0x449e6e),_0x3dcc13={'year':_0x5bc696(0x1dc),'month':'long','day':'numeric','timeZone':_0x5bc696(0x11c)},_0x4ae098=_0x17a5b9[_0x5bc696(0x121)](_0x5bc696(0x1ae),_0x3dcc13);_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x224)+_0x2261bb+_0x5bc696(0x101),_0x5a7bab+='</tr>',_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x195)+_0x52efc8[_0x5bc696(0x158)]+_0x5bc696(0x143),_0x5a7bab+=_0x5bc696(0x124),_0x5a7bab+=_0x5bc696(0x133),_0x5a7bab+=_0x5bc696(0x113),_0x5a7bab+=_0x5bc696(0x211),_0x5a7bab+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x5a7bab+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>',_0x5a7bab+=_0x5bc696(0x1c4),_0x5a7bab+=_0x5bc696(0x254),_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x14e),_0x5a7bab+=_0x5bc696(0x117)+_0x4ae098+_0x5bc696(0x143),_0x5a7bab+=_0x5bc696(0x1d2),_0x5a7bab+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>',_0x5a7bab+=_0x5bc696(0x141),_0x5a7bab+=_0x5bc696(0x141),_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x247),_0x5a7bab+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0x5a7bab+=_0x5bc696(0x1ac),_0x5a7bab+=_0x5bc696(0x141),_0x5a7bab+=_0x5bc696(0x141),_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x184),_0x5a7bab+=_0x5bc696(0x130),_0x5a7bab+='</tr>',_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x1dd),_0x5a7bab+=_0x5bc696(0x16a),_0x5a7bab+=_0x5bc696(0x105);for(let _0x109179=0x0;_0x109179<=_0x4cb530['length']-0x1;_0x109179++){const _0x5e21fd=_0x4cb530[_0x109179];for(let _0x536324=0x0;_0x536324<_0x2d917e[_0x5bc696(0x19e)][_0x5bc696(0x17a)];_0x536324++){const _0x1a13be=_0x2d917e[_0x5bc696(0x19e)][_0x536324];if(_0x1a13be[_0x5bc696(0x261)]['category']===_0x5e21fd[_0x5bc696(0x261)][_0x5bc696(0x25f)]){var _0x429691='';switch(_0x5e21fd['_id']['category']){case _0x5bc696(0x192):_0x429691=_0x1a13be[_0x5bc696(0x261)][_0x5bc696(0x1c7)]+_0x5bc696(0x24b);break;case _0x5bc696(0x234):_0x429691=_0x1a13be[_0x5bc696(0x261)]['brand']+'\x20-\x20HH';break;default:_0x429691=_0x1a13be[_0x5bc696(0x261)][_0x5bc696(0x1c7)];break;}_0x5a7bab+=_0x5bc696(0x21f)+_0x429691+_0x5bc696(0x101);}}}_0x5a7bab+=_0x5bc696(0x145),_0x5a7bab+=_0x5bc696(0x204),_0x5a7bab+='<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>',_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+='<tr>',_0x5a7bab+=_0x5bc696(0x209);for(let _0x4dbb8e=0x0;_0x4dbb8e<=_0x2d917e[_0x5bc696(0x19e)][_0x5bc696(0x17a)]-0x1;_0x4dbb8e++){const _0x1a2914=_0x2d917e[_0x4dbb8e];_0x5a7bab+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x5a7bab+=_0x5bc696(0x13f),_0x5a7bab+=_0x5bc696(0xe3);}_0x5a7bab+=_0x5bc696(0x116),_0x5a7bab+=_0x5bc696(0x188),_0x5a7bab+=_0x5bc696(0x156),_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x144),_0x5a7bab+=_0x5bc696(0x20d),_0x273895[_0x5bc696(0x187)](_0x58ec20=>{_0x5a7bab+=_0x58ec20;});let _0x59b172={},_0x3bec43={},_0x154784={};for(let _0x3148fd=0x0;_0x3148fd<=_0x983dc2['length']-0x1;_0x3148fd++){const _0x1be089=_0x983dc2[_0x3148fd];var _0x2fbe20=0x0;for(let _0x3b0a8c=0x0;_0x3b0a8c<=_0x1be089['products']['length']-0x1;_0x3b0a8c++){const _0x31ed68=_0x1be089[_0x5bc696(0x26d)][_0x3b0a8c],_0x468ced=_0x31ed68[_0x5bc696(0x1c7)]+'-'+_0x31ed68['category'];if(_0x31ed68[_0x5bc696(0x112)]['prod_cat']=='P')_0x31ed68[_0x5bc696(0x112)][_0x5bc696(0x1a1)]==_0x5bc696(0x21a)?(!_0x154784[_0x468ced]&&(_0x154784[_0x468ced]=0x0),_0x154784[_0x468ced]+=_0x31ed68['qty']):(!_0x59b172[_0x468ced]&&(_0x59b172[_0x468ced]=0x0),_0x59b172[_0x468ced]+=_0x31ed68[_0x5bc696(0x269)]);else _0x31ed68[_0x5bc696(0x112)][_0x5bc696(0x1e1)]=='S'&&(_0x31ed68['product_details'][_0x5bc696(0x1a1)]==_0x5bc696(0x21a)?(!_0x154784[_0x468ced]&&(_0x154784[_0x468ced]=0x0),_0x154784[_0x468ced]+=_0x31ed68[_0x5bc696(0x269)],console[_0x5bc696(0x1be)](_0x31ed68[_0x5bc696(0x269)])):(!_0x3bec43[_0x468ced]&&(_0x3bec43[_0x468ced]=0x0),_0x3bec43[_0x468ced]+=_0x31ed68[_0x5bc696(0x269)]));_0x2fbe20++;}}let _0x42ebdf={},_0x4e38b2={},_0xc0345e={};var _0x1bba06=0x0,_0xa27bac=0x0;for(let _0x37c556=0x0;_0x37c556<=_0x7afc8e[_0x5bc696(0x17a)]-0x1;_0x37c556++){const _0x178698=_0x7afc8e[_0x37c556];var _0x2fbe20=0x0;for(let _0x2b539e=0x0;_0x2b539e<=_0x178698[_0x5bc696(0x26d)][_0x5bc696(0x17a)]-0x1;_0x2b539e++){const _0x36edd6=_0x178698[_0x5bc696(0x26d)][_0x2b539e],_0x2aab9a=_0x36edd6['brand']+'-'+_0x36edd6[_0x5bc696(0x25f)];if(_0x36edd6[_0x5bc696(0x112)][_0x5bc696(0x1e1)]=='P')_0x36edd6[_0x5bc696(0x112)][_0x5bc696(0x1a1)]==_0x5bc696(0x21a)?(!_0xc0345e[_0x2aab9a]&&(_0xc0345e[_0x2aab9a]=0x0),_0xc0345e[_0x2aab9a]+=_0x36edd6[_0x5bc696(0x269)]):(!_0x42ebdf[_0x2aab9a]&&(_0x42ebdf[_0x2aab9a]=0x0),_0x42ebdf[_0x2aab9a]+=_0x36edd6['qty']);else _0x36edd6[_0x5bc696(0x112)]['prod_cat']=='S'&&(_0x36edd6['product_details'][_0x5bc696(0x1a1)]==_0x5bc696(0x21a)?(!_0xc0345e[_0x2aab9a]&&(_0xc0345e[_0x2aab9a]=0x0),_0xc0345e[_0x2aab9a]+=_0x36edd6[_0x5bc696(0x269)]):(!_0x4e38b2[_0x2aab9a]&&(_0x4e38b2[_0x2aab9a]=0x0),_0x4e38b2[_0x2aab9a]+=_0x36edd6['qty']));_0x2fbe20++;}var _0x452c13=parseFloat(_0x178698[_0x5bc696(0x249)]),_0x1a4a3b=parseFloat(_0x178698[_0x5bc696(0x215)]);isNaN(_0x1a4a3b)&&(_0x1a4a3b=0x0),_0x1bba06+=_0x452c13,_0xa27bac+=_0x1a4a3b;}if(_0x29a2dc['length']>0x0)for(let _0x25588c=0x0;_0x25588c<=_0x29a2dc['length']-0x1;_0x25588c++){const _0x47c8f8=_0x29a2dc[_0x25588c];console['log'](_0x47c8f8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22'+(0x8+0x7*0x3)+_0x5bc696(0x109)+_0x47c8f8[_0x5bc696(0x157)]+'</b></td>',_0x5a7bab+=_0x5bc696(0xe8);}_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x251),_0x5a7bab+=_0x5bc696(0x246),_0x5a7bab+=_0x5bc696(0x138);for(let _0x3ad02f=0x0;_0x3ad02f<=_0x2d917e[_0x5bc696(0x19e)][_0x5bc696(0x17a)]-0x1;_0x3ad02f++){const _0x1ce0ee=_0x2d917e[_0x5bc696(0x19e)][_0x3ad02f],_0x4f5803=_0x1ce0ee[_0x5bc696(0x261)]['brand']+'-'+_0x1ce0ee[_0x5bc696(0x261)][_0x5bc696(0x25f)];var _0x3c1aec=_0x59b172[_0x4f5803]!==undefined?formatNumber(_0x59b172[_0x4f5803][_0x5bc696(0x1a6)](0x2)):'',_0x3e49d3=_0x154784[_0x4f5803]!==undefined?formatNumber(_0x154784[_0x4f5803][_0x5bc696(0x1a6)](0x2)):'',_0x2f16bc=_0x3bec43[_0x4f5803]!==undefined?formatNumber(_0x3bec43[_0x4f5803][_0x5bc696(0x1a6)](0x2)):'';_0x5a7bab+=_0x5bc696(0x1a2)+_0x3c1aec+'</b></td>',_0x5a7bab+=_0x5bc696(0x1a2)+_0x2f16bc+'</b></td>',_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3e49d3+_0x5bc696(0x101);}_0x5a7bab+=_0x5bc696(0x1a2)+formatNumber(_0x30c338)+_0x5bc696(0x101),_0x5a7bab+=_0x5bc696(0x1a2)+formatNumber(_0x219e16)+_0x5bc696(0x101),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x5a7bab+='</tr>',_0x5a7bab+='<tr>',_0x5a7bab+=_0x5bc696(0x251),_0x5a7bab+=_0x5bc696(0x227),_0x5a7bab+=_0x5bc696(0x138);for(let _0x58c225=0x0;_0x58c225<=_0x2d917e[_0x5bc696(0x19e)][_0x5bc696(0x17a)]-0x1;_0x58c225++){const _0x374ea7=_0x2d917e['cat_brand'][_0x58c225],_0x336e7f=_0x374ea7[_0x5bc696(0x261)]['brand']+'-'+_0x374ea7[_0x5bc696(0x261)]['category'];var _0x3c1aec=_0x42ebdf[_0x336e7f]!==undefined?formatNumber(_0x42ebdf[_0x336e7f][_0x5bc696(0x1a6)](0x2)):'',_0x3e49d3=_0xc0345e[_0x336e7f]!==undefined?formatNumber(_0xc0345e[_0x336e7f][_0x5bc696(0x1a6)](0x2)):'',_0x2f16bc=_0x4e38b2[_0x336e7f]!==undefined?formatNumber(_0x4e38b2[_0x336e7f][_0x5bc696(0x1a6)](0x2)):'';_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3c1aec+_0x5bc696(0x101),_0x5a7bab+=_0x5bc696(0x1a2)+_0x2f16bc+_0x5bc696(0x101),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3e49d3+_0x5bc696(0x101);}_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1bba06)+'</b></td>',_0x5a7bab+=_0x5bc696(0x1a2)+formatNumber(_0xa27bac)+_0x5bc696(0x101),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+='</tr>',_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x251),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';let _0x7ddc1e=0x0,_0x53147e=0x0,_0x5e5f3c=0x0;for(let _0x27a8d2=0x0;_0x27a8d2<=_0x2d917e['cat_brand'][_0x5bc696(0x17a)]-0x1;_0x27a8d2++){const _0x301b3e=_0x2d917e[_0x5bc696(0x19e)][_0x27a8d2],_0x4c2683=_0x301b3e[_0x5bc696(0x261)][_0x5bc696(0x1c7)]+'-'+_0x301b3e['_id'][_0x5bc696(0x25f)];var _0x3c618b=_0x59b172[_0x4c2683]!==undefined?_0x59b172[_0x4c2683][_0x5bc696(0x1a6)](0x2):'0',_0x1a9c30=_0x154784[_0x4c2683]!==undefined?_0x154784[_0x4c2683][_0x5bc696(0x1a6)](0x2):'0',_0x57ace0=_0x3bec43[_0x4c2683]!==undefined?_0x3bec43[_0x4c2683]['toFixed'](0x2):'0',_0x5ecf57=_0x42ebdf[_0x4c2683]!==undefined?_0x42ebdf[_0x4c2683][_0x5bc696(0x1a6)](0x2):'0',_0x45f8fc=_0xc0345e[_0x4c2683]!==undefined?_0xc0345e[_0x4c2683][_0x5bc696(0x1a6)](0x2):'0',_0x58bc12=_0x4e38b2[_0x4c2683]!==undefined?_0x4e38b2[_0x4c2683][_0x5bc696(0x1a6)](0x2):'0';_0x7ddc1e=parseFloat(_0x3c618b)+parseFloat(_0x5ecf57),_0x53147e=parseFloat(_0x57ace0)+parseFloat(_0x58bc12),_0x5e5f3c=parseFloat(_0x1a9c30)+parseFloat(_0x45f8fc),_0x5a7bab+=_0x5bc696(0x1a2)+formatNumber(_0x7ddc1e[_0x5bc696(0x1a6)](0x2))+_0x5bc696(0x101),_0x5a7bab+=_0x5bc696(0x1a2)+formatNumber(_0x53147e[_0x5bc696(0x1a6)](0x2))+_0x5bc696(0x101),_0x5a7bab+=_0x5bc696(0x1a2)+formatNumber(_0x5e5f3c[_0x5bc696(0x1a6)](0x2))+_0x5bc696(0x101);}var _0x419281=formatNumber(_0x30c338+_0x1bba06),_0x164244=formatNumber(_0x219e16+_0xa27bac);_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x419281+_0x5bc696(0x101),_0x5a7bab+=_0x5bc696(0x1a2)+_0x164244+_0x5bc696(0x101),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+=_0x5bc696(0x20f)+(_0x2d917e[_0x5bc696(0x19e)]['length']*0x3+0x9)+'\x22><b></b></td>',_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x5a7bab+=_0x5bc696(0x138);for(let _0x10d1aa=0x0;_0x10d1aa<=_0x2d917e[_0x5bc696(0x19e)][_0x5bc696(0x17a)]-0x1;_0x10d1aa++){const _0x56434c=_0x2d917e['cat_brand'][_0x10d1aa],_0x12911d=_0x56434c['_id']['brand']+'-'+_0x56434c[_0x5bc696(0x261)][_0x5bc696(0x25f)];var _0x3c618b=_0x59b172[_0x12911d]!==undefined?_0x59b172[_0x12911d][_0x5bc696(0x1a6)](0x2):'0',_0x1a9c30=_0x154784[_0x12911d]!==undefined?_0x154784[_0x12911d]['toFixed'](0x2):'0',_0x57ace0=_0x3bec43[_0x12911d]!==undefined?_0x3bec43[_0x12911d][_0x5bc696(0x1a6)](0x2):'0',_0x5ecf57=_0x42ebdf[_0x12911d]!==undefined?_0x42ebdf[_0x12911d][_0x5bc696(0x1a6)](0x2):'0',_0x45f8fc=_0xc0345e[_0x12911d]!==undefined?_0xc0345e[_0x12911d][_0x5bc696(0x1a6)](0x2):'0',_0x58bc12=_0x4e38b2[_0x12911d]!==undefined?_0x4e38b2[_0x12911d]['toFixed'](0x2):'0';_0x7ddc1e=parseFloat(_0x3c618b)+parseFloat(_0x5ecf57),_0x53147e=parseFloat(_0x57ace0)+parseFloat(_0x58bc12),_0x5e5f3c=parseFloat(_0x1a9c30)+parseFloat(_0x45f8fc),_0x5a7bab+=_0x5bc696(0x10a),_0x5a7bab+=_0x5bc696(0x10a),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+='<tr>',_0x5a7bab+=_0x5bc696(0x251),_0x5a7bab+=_0x5bc696(0x14a),_0x5a7bab+=_0x5bc696(0x138);for(let _0x100954=0x0;_0x100954<=_0x2d917e[_0x5bc696(0x19e)][_0x5bc696(0x17a)]-0x1;_0x100954++){const _0x12ddf9=_0x2d917e[_0x5bc696(0x19e)][_0x100954],_0x2714b7=_0x12ddf9[_0x5bc696(0x261)][_0x5bc696(0x1c7)]+'-'+_0x12ddf9[_0x5bc696(0x261)][_0x5bc696(0x25f)];var _0x3c618b=_0x59b172[_0x2714b7]!==undefined?_0x59b172[_0x2714b7][_0x5bc696(0x1a6)](0x2):'0',_0x1a9c30=_0x154784[_0x2714b7]!==undefined?_0x154784[_0x2714b7][_0x5bc696(0x1a6)](0x2):'0',_0x57ace0=_0x3bec43[_0x2714b7]!==undefined?_0x3bec43[_0x2714b7][_0x5bc696(0x1a6)](0x2):'0',_0x5ecf57=_0x42ebdf[_0x2714b7]!==undefined?_0x42ebdf[_0x2714b7][_0x5bc696(0x1a6)](0x2):'0',_0x45f8fc=_0xc0345e[_0x2714b7]!==undefined?_0xc0345e[_0x2714b7][_0x5bc696(0x1a6)](0x2):'0',_0x58bc12=_0x4e38b2[_0x2714b7]!==undefined?_0x4e38b2[_0x2714b7]['toFixed'](0x2):'0';_0x7ddc1e=parseFloat(_0x3c618b)+parseFloat(_0x5ecf57),_0x53147e=parseFloat(_0x57ace0)+parseFloat(_0x58bc12),_0x5e5f3c=parseFloat(_0x1a9c30)+parseFloat(_0x45f8fc),_0x5a7bab+=_0x5bc696(0x10a),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x5a7bab+='</tr>',_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x5a7bab+=_0x5bc696(0x138);for(let _0x78d5c6=0x0;_0x78d5c6<=_0x2d917e[_0x5bc696(0x19e)]['length']-0x1;_0x78d5c6++){const _0xf0ead0=_0x2d917e[_0x5bc696(0x19e)][_0x78d5c6],_0x4c5e1b=_0xf0ead0[_0x5bc696(0x261)]['brand']+'-'+_0xf0ead0[_0x5bc696(0x261)][_0x5bc696(0x25f)];var _0x3c618b=_0x59b172[_0x4c5e1b]!==undefined?_0x59b172[_0x4c5e1b]['toFixed'](0x2):'0',_0x1a9c30=_0x154784[_0x4c5e1b]!==undefined?_0x154784[_0x4c5e1b]['toFixed'](0x2):'0',_0x57ace0=_0x3bec43[_0x4c5e1b]!==undefined?_0x3bec43[_0x4c5e1b][_0x5bc696(0x1a6)](0x2):'0',_0x5ecf57=_0x42ebdf[_0x4c5e1b]!==undefined?_0x42ebdf[_0x4c5e1b]['toFixed'](0x2):'0',_0x45f8fc=_0xc0345e[_0x4c5e1b]!==undefined?_0xc0345e[_0x4c5e1b][_0x5bc696(0x1a6)](0x2):'0',_0x58bc12=_0x4e38b2[_0x4c5e1b]!==undefined?_0x4e38b2[_0x4c5e1b]['toFixed'](0x2):'0';_0x7ddc1e=parseFloat(_0x3c618b)+parseFloat(_0x5ecf57),_0x53147e=parseFloat(_0x57ace0)+parseFloat(_0x58bc12),_0x5e5f3c=parseFloat(_0x1a9c30)+parseFloat(_0x45f8fc),_0x5a7bab+=_0x5bc696(0x10a),_0x5a7bab+=_0x5bc696(0x10a),_0x5a7bab+=_0x5bc696(0x10a);}_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x5a7bab+=_0x5bc696(0x246),_0x5a7bab+=_0x5bc696(0x138);for(let _0x1ee949=0x0;_0x1ee949<=_0x2d917e[_0x5bc696(0x19e)][_0x5bc696(0x17a)]-0x1;_0x1ee949++){const _0x414b21=_0x2d917e[_0x5bc696(0x19e)][_0x1ee949],_0x291aec=_0x414b21[_0x5bc696(0x261)][_0x5bc696(0x1c7)]+'-'+_0x414b21[_0x5bc696(0x261)][_0x5bc696(0x25f)];var _0x3c618b=_0x59b172[_0x291aec]!==undefined?_0x59b172[_0x291aec][_0x5bc696(0x1a6)](0x2):'',_0x1a9c30=_0x154784[_0x291aec]!==undefined?_0x154784[_0x291aec][_0x5bc696(0x1a6)](0x2):'',_0x57ace0=_0x3bec43[_0x291aec]!==undefined?_0x3bec43[_0x291aec][_0x5bc696(0x1a6)](0x2):'',_0x5ecf57=_0x42ebdf[_0x291aec]!==undefined?_0x42ebdf[_0x291aec]['toFixed'](0x2):'',_0x45f8fc=_0xc0345e[_0x291aec]!==undefined?_0xc0345e[_0x291aec][_0x5bc696(0x1a6)](0x2):'',_0x58bc12=_0x4e38b2[_0x291aec]!==undefined?_0x4e38b2[_0x291aec][_0x5bc696(0x1a6)](0x2):'';_0x7ddc1e=formatNumber(parseFloat(_0x3c618b)+parseFloat(_0x5ecf57)),_0x53147e=formatNumber(parseFloat(_0x57ace0)+parseFloat(_0x58bc12)),_0x5e5f3c=formatNumber(parseFloat(_0x1a9c30)+parseFloat(_0x45f8fc)),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3c618b+'</b></td>',_0x5a7bab+=_0x5bc696(0x1a2)+_0x57ace0+'</b></td>',_0x5a7bab+=_0x5bc696(0x1a2)+_0x1a9c30+'</b></td>';}_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0xe8),_0x5a7bab+=_0x5bc696(0x134),_0x5a7bab+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x5a7bab+=_0x5bc696(0x13b),_0x5a7bab+=_0x5bc696(0x138);for(let _0x3b4ccf=0x0;_0x3b4ccf<=_0x2d917e[_0x5bc696(0x19e)][_0x5bc696(0x17a)]-0x1;_0x3b4ccf++){const _0x563a3b=_0x2d917e[_0x5bc696(0x19e)][_0x3b4ccf],_0x2bbc19=_0x563a3b['_id'][_0x5bc696(0x1c7)]+'-'+_0x563a3b['_id'][_0x5bc696(0x25f)];var _0x3c618b=_0x59b172[_0x2bbc19]!==undefined?_0x59b172[_0x2bbc19]['toFixed'](0x2):'0',_0x1a9c30=_0x154784[_0x2bbc19]!==undefined?_0x154784[_0x2bbc19][_0x5bc696(0x1a6)](0x2):'0',_0x57ace0=_0x3bec43[_0x2bbc19]!==undefined?_0x3bec43[_0x2bbc19][_0x5bc696(0x1a6)](0x2):'0',_0x5ecf57=_0x42ebdf[_0x2bbc19]!==undefined?_0x42ebdf[_0x2bbc19][_0x5bc696(0x1a6)](0x2):'0',_0x45f8fc=_0xc0345e[_0x2bbc19]!==undefined?_0xc0345e[_0x2bbc19]['toFixed'](0x2):'0',_0x58bc12=_0x4e38b2[_0x2bbc19]!==undefined?_0x4e38b2[_0x2bbc19][_0x5bc696(0x1a6)](0x2):'0';_0x7ddc1e=parseFloat(_0x3c618b)+parseFloat(_0x5ecf57),_0x53147e=parseFloat(_0x57ace0)+parseFloat(_0x58bc12),_0x5e5f3c=parseFloat(_0x1a9c30)+parseFloat(_0x45f8fc),_0x5a7bab+=_0x5bc696(0x10a),_0x5a7bab+=_0x5bc696(0x10a),_0x5a7bab+=_0x5bc696(0x10a);}_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+=_0x5bc696(0x138),_0x5a7bab+='</tr>',_0x5a7bab+=_0x5bc696(0x103),_0x5a7bab+=_0x5bc696(0x196);}),_0x5a7bab;}async function generateReferenceNumber(_0x49bf9d,_0x253963,_0x3e24b9){const _0x5e63d8=a0_0x5de9ce,_0x13d4bc=new Date(_0x49bf9d)[_0x5e63d8(0x135)](),_0x2e9dea=('0'+(new Date(_0x49bf9d)[_0x5e63d8(0x225)]()+0x1))[_0x5e63d8(0x1e6)](-0x2),_0x2a7424=('0'+new Date(_0x49bf9d)[_0x5e63d8(0x115)]())['slice'](-0x2),_0x459dc5=await staff[_0x5e63d8(0x24c)]({'email':_0x3e24b9[_0x5e63d8(0x10d)]}),_0x1343cd=_0x459dc5['sales_man_code'],_0x5b3800=_0x1343cd+'-'+_0x13d4bc+_0x2e9dea+_0x2a7424,_0x252d4b=await Reference[_0x5e63d8(0x24c)]({'referenceNumber':new RegExp('^'+_0x5b3800),'salesman_code':_0x1343cd})[_0x5e63d8(0x17f)]({'createdAt':-0x1}),_0x5868c7=_0x5b3800;_0x252d4b&&(_0x5868c7=_0x252d4b[_0x5e63d8(0x250)]);console[_0x5e63d8(0x1be)](_0x5868c7);const _0x5b7577=new Reference({'referenceNumber':_0x5868c7,'staff_id':_0x253963,'salesman_code':_0x1343cd});return await _0x5b7577['save'](),_0x5868c7;}router['post']('/dsrr/pdf',auth,async(_0x540dfa,_0x188e4e)=>{const _0x1310bc=a0_0x5de9ce,{from_date:_0x445bf8,dataview:_0xf94b9c}=_0x540dfa[_0x1310bc(0x18d)],_0x5d0ca5=_0x540dfa['user'],_0x1d2c9c=await staff[_0x1310bc(0x24c)]({'email':_0x5d0ca5[_0x1310bc(0x10d)]}),_0x10c213=await master_shop[_0x1310bc(0xe9)](),_0x4bf79f='';var _0xa80d5c=new Date(_0x445bf8);const _0xd6afab={'year':_0x1310bc(0x1dc),'month':_0x1310bc(0x223),'day':_0x1310bc(0x1dc)},_0x5cdf37=new Intl[(_0x1310bc(0x10e))](_0x1310bc(0x1ae),_0xd6afab)['format'](_0xa80d5c),_0x14d195=await Reference['find']({'staff_id':_0x1d2c9c[_0x1310bc(0x261)]['valueOf'](),'date_include':_0x445bf8});if(_0x14d195['length']>0x0){let _0x6d83a5='';_0x6d83a5+=_0x14d195[0x0][_0x1310bc(0x200)];if(_0xf94b9c==_0x1310bc(0x14f)){const _0x2e03c0=cheerio[_0x1310bc(0x1d4)](_0x6d83a5);let _0x54fc5b=[],_0x138166=[],_0x2b6148=[];const _0x27a532=_0x373e2b=>{const _0x25a9e6=_0x1310bc,_0x1c1fac={'top':{'style':'thick','color':{'rgb':_0x25a9e6(0x24a)}},'bottom':{'style':_0x25a9e6(0x239),'color':{'rgb':_0x25a9e6(0x24a)}},'left':{'style':_0x25a9e6(0x239),'color':{'rgb':_0x25a9e6(0x24a)}},'right':{'style':'thick','color':{'rgb':_0x25a9e6(0x24a)}}};if(_0x373e2b){const _0x9cb8b7=_0x373e2b[_0x25a9e6(0x1c9)](';')['reduce']((_0x296430,_0x1be35c)=>{const _0xa2a1cf=_0x25a9e6,[_0x36a01c,_0x59d95c]=_0x1be35c[_0xa2a1cf(0x1c9)](':')[_0xa2a1cf(0x13d)](_0x55e909=>_0x55e909['trim']());return _0x296430[_0x36a01c]=_0x59d95c,_0x296430;},{});_0x9cb8b7[_0x25a9e6(0x197)]&&(_0x1c1fac[_0x25a9e6(0x14d)][_0x25a9e6(0x16c)]=_0x9cb8b7['border-top'][_0x25a9e6(0x252)](_0x25a9e6(0xe6))?_0x25a9e6(0xe6):'medium'),_0x9cb8b7['border-bottom']&&(_0x1c1fac[_0x25a9e6(0x1fc)][_0x25a9e6(0x16c)]=_0x9cb8b7[_0x25a9e6(0xf4)]['includes'](_0x25a9e6(0xe6))?_0x25a9e6(0xe6):_0x25a9e6(0x1e4)),_0x9cb8b7[_0x25a9e6(0x1cb)]&&(_0x1c1fac[_0x25a9e6(0x136)][_0x25a9e6(0x16c)]=_0x9cb8b7[_0x25a9e6(0x1cb)]['includes']('thin')?_0x25a9e6(0xe6):'medium'),_0x9cb8b7['border-right']&&(_0x1c1fac[_0x25a9e6(0x1fe)]['style']=_0x9cb8b7[_0x25a9e6(0x191)][_0x25a9e6(0x252)](_0x25a9e6(0xe6))?_0x25a9e6(0xe6):_0x25a9e6(0x1e4));}return _0x1c1fac;};_0x2e03c0(_0x1310bc(0xec))[_0x1310bc(0x18e)]((_0x297e7b,_0x259b0a)=>{const _0xa2086f=_0x1310bc;let _0x33e6e1=[],_0x3bbff6=0x0;while(_0x2b6148[_0x3bbff6]){_0x2b6148[_0x3bbff6]--,_0x3bbff6++;}_0x2e03c0(_0x259b0a)[_0xa2086f(0xe9)](_0xa2086f(0x22a))[_0xa2086f(0x18e)]((_0x30e93e,_0x38a60d)=>{const _0x38efc9=_0xa2086f;let _0x36fdbb=_0x2e03c0(_0x38a60d)[_0x38efc9(0x1c6)]()[_0x38efc9(0x20b)](),_0x19067e=parseFloat(_0x36fdbb[_0x38efc9(0x216)](/,/g,''));isNaN(_0x19067e)&&(_0x19067e=_0x36fdbb);let _0x1898c1=parseInt(_0x2e03c0(_0x38a60d)[_0x38efc9(0x170)](_0x38efc9(0x265)))||0x1,_0x83f143=parseInt(_0x2e03c0(_0x38a60d)[_0x38efc9(0x170)](_0x38efc9(0x167)))||0x1;const _0x2199de=_0x2e03c0(_0x38a60d)['attr']('style'),_0x1f117f=_0x27a532(_0x2199de);_0x33e6e1[_0x3bbff6]={'v':_0x19067e,'s':{'border':_0x1f117f}};(_0x1898c1>0x1||_0x83f143>0x1)&&_0x138166[_0x38efc9(0x1ba)]({'s':{'r':_0x297e7b,'c':_0x3bbff6},'e':{'r':_0x297e7b+_0x83f143-0x1,'c':_0x3bbff6+_0x1898c1-0x1}});for(let _0x18aa2e=0x0;_0x18aa2e<_0x1898c1;_0x18aa2e++){_0x83f143>0x1&&(_0x2b6148[_0x3bbff6+_0x18aa2e]=_0x83f143-0x1);}_0x3bbff6+=_0x1898c1;}),_0x54fc5b['push'](_0x33e6e1);});const _0xb65a8c=XLSX[_0x1310bc(0x15c)][_0x1310bc(0x1f2)](),_0x3f8781=XLSX[_0x1310bc(0x15c)]['aoa_to_sheet'](_0x54fc5b);_0x138166[_0x1310bc(0x17a)]>0x0&&(_0x3f8781[_0x1310bc(0x1d3)]=_0x138166);_0x3f8781[_0x1310bc(0x1bf)]=_0x54fc5b[0x0][_0x1310bc(0x13d)](()=>({'wpx':0x64})),XLSX[_0x1310bc(0x15c)][_0x1310bc(0x1b6)](_0xb65a8c,_0x3f8781,'Sales\x20Report');const _0x444c88=XLSX[_0x1310bc(0x15b)](_0xb65a8c,{'bookType':'xlsx','type':_0x1310bc(0x238)});_0x188e4e[_0x1310bc(0x160)](_0x1310bc(0x178),_0x1310bc(0x120)),_0x188e4e[_0x1310bc(0x160)](_0x1310bc(0x25a),_0x1310bc(0x1a5)),_0x188e4e[_0x1310bc(0x194)](_0x444c88);}else{let _0x51fc10='';_0x51fc10+=_0x6d83a5,_0x51fc10+=_0x1310bc(0x107),_0x51fc10+=_0x1310bc(0x18a),_0x51fc10+=_0x1310bc(0x1f1),_0x51fc10+='};',_0x51fc10+=_0x1310bc(0x1ee),_0x188e4e[_0x1310bc(0x194)](_0x51fc10);}}else generateReferenceNumber(_0x445bf8,_0x1d2c9c[_0x1310bc(0x261)][_0x1310bc(0x235)](),_0x5d0ca5)[_0x1310bc(0x21b)](async _0x207f4f=>{const _0x38064b=_0x1310bc,_0x1d9be0=await agentsdataDSICheck_DSRR(_0x445bf8,_0x1d2c9c['_id'][_0x38064b(0x235)](),_0x4bf79f,_0x207f4f);let _0x2f4e2b=_0x38064b(0xf3);_0x2f4e2b+='<div\x20class=\x22row\x22>',_0x2f4e2b+=_0x38064b(0x21e),_0x2f4e2b+=_0x38064b(0xff),_0x2f4e2b+=_0x1d9be0,_0x2f4e2b+=_0x38064b(0x196),_0x2f4e2b+=_0x38064b(0x1d9),_0x2f4e2b+=_0x38064b(0x1d9);if(_0x1d9be0[_0x38064b(0x17a)]>0x0){const _0x50b88d=await Reference[_0x38064b(0x24c)]({'staff_id':_0x1d2c9c['_id'][_0x38064b(0x235)](),'referenceNumber':_0x207f4f});_0x50b88d[_0x38064b(0x200)]=_0x2f4e2b,_0x50b88d['date_include']=_0x445bf8,await _0x50b88d[_0x38064b(0x175)]();if(_0xf94b9c==_0x38064b(0x14f)){const _0x3a1c77=cheerio['load'](_0x2f4e2b);let _0x399213=[],_0x29e0a8=[],_0x451969=[];const _0x2ac63b=_0x471ef1=>{const _0xab2cc0=_0x38064b,_0x3006ac={'top':{'style':_0xab2cc0(0x239),'color':{'rgb':_0xab2cc0(0x24a)}},'bottom':{'style':'thick','color':{'rgb':_0xab2cc0(0x24a)}},'left':{'style':_0xab2cc0(0x239),'color':{'rgb':_0xab2cc0(0x24a)}},'right':{'style':_0xab2cc0(0x239),'color':{'rgb':'000000'}}};if(_0x471ef1){const _0x4e6f9d=_0x471ef1[_0xab2cc0(0x1c9)](';')[_0xab2cc0(0x190)]((_0x91c26e,_0x2e68a1)=>{const _0x34046b=_0xab2cc0,[_0x3d3724,_0x57bd04]=_0x2e68a1[_0x34046b(0x1c9)](':')[_0x34046b(0x13d)](_0x48ba6b=>_0x48ba6b[_0x34046b(0x20b)]());return _0x91c26e[_0x3d3724]=_0x57bd04,_0x91c26e;},{});_0x4e6f9d[_0xab2cc0(0x197)]&&(_0x3006ac[_0xab2cc0(0x14d)][_0xab2cc0(0x16c)]=_0x4e6f9d[_0xab2cc0(0x197)][_0xab2cc0(0x252)](_0xab2cc0(0xe6))?'thin':'medium'),_0x4e6f9d[_0xab2cc0(0xf4)]&&(_0x3006ac[_0xab2cc0(0x1fc)][_0xab2cc0(0x16c)]=_0x4e6f9d['border-bottom'][_0xab2cc0(0x252)](_0xab2cc0(0xe6))?_0xab2cc0(0xe6):'medium'),_0x4e6f9d[_0xab2cc0(0x1cb)]&&(_0x3006ac[_0xab2cc0(0x136)][_0xab2cc0(0x16c)]=_0x4e6f9d[_0xab2cc0(0x1cb)][_0xab2cc0(0x252)](_0xab2cc0(0xe6))?'thin':_0xab2cc0(0x1e4)),_0x4e6f9d[_0xab2cc0(0x191)]&&(_0x3006ac[_0xab2cc0(0x1fe)][_0xab2cc0(0x16c)]=_0x4e6f9d[_0xab2cc0(0x191)][_0xab2cc0(0x252)](_0xab2cc0(0xe6))?_0xab2cc0(0xe6):_0xab2cc0(0x1e4));}return _0x3006ac;};_0x3a1c77('table\x20tr')[_0x38064b(0x18e)]((_0x4bb5fc,_0x55d7ca)=>{const _0x5e06a5=_0x38064b;let _0x27ea65=[],_0x2a8ff8=0x0;while(_0x451969[_0x2a8ff8]){_0x451969[_0x2a8ff8]--,_0x2a8ff8++;}_0x3a1c77(_0x55d7ca)[_0x5e06a5(0xe9)](_0x5e06a5(0x22a))['each']((_0xa07153,_0x58c9e4)=>{const _0x31386a=_0x5e06a5;let _0x1ca8e7=_0x3a1c77(_0x58c9e4)['text']()[_0x31386a(0x20b)](),_0x23cf14=parseFloat(_0x1ca8e7[_0x31386a(0x216)](/,/g,''));isNaN(_0x23cf14)&&(_0x23cf14=_0x1ca8e7);let _0x4d3782=parseInt(_0x3a1c77(_0x58c9e4)['attr']('colspan'))||0x1,_0x25f455=parseInt(_0x3a1c77(_0x58c9e4)[_0x31386a(0x170)](_0x31386a(0x167)))||0x1;const _0x1a5050=_0x3a1c77(_0x58c9e4)[_0x31386a(0x170)](_0x31386a(0x16c)),_0x55f238=_0x2ac63b(_0x1a5050);_0x27ea65[_0x2a8ff8]={'v':_0x23cf14,'s':{'border':_0x55f238}};(_0x4d3782>0x1||_0x25f455>0x1)&&_0x29e0a8[_0x31386a(0x1ba)]({'s':{'r':_0x4bb5fc,'c':_0x2a8ff8},'e':{'r':_0x4bb5fc+_0x25f455-0x1,'c':_0x2a8ff8+_0x4d3782-0x1}});for(let _0xfd573c=0x0;_0xfd573c<_0x4d3782;_0xfd573c++){_0x25f455>0x1&&(_0x451969[_0x2a8ff8+_0xfd573c]=_0x25f455-0x1);}_0x2a8ff8+=_0x4d3782;}),_0x399213[_0x5e06a5(0x1ba)](_0x27ea65);});const _0x3fa488=XLSX['utils'][_0x38064b(0x1f2)](),_0x1cc9b2=XLSX[_0x38064b(0x15c)][_0x38064b(0x217)](_0x399213);_0x29e0a8[_0x38064b(0x17a)]>0x0&&(_0x1cc9b2['!merges']=_0x29e0a8);_0x1cc9b2[_0x38064b(0x1bf)]=_0x399213[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x38064b(0x15c)][_0x38064b(0x1b6)](_0x3fa488,_0x1cc9b2,_0x38064b(0x1e9));const _0x2d0498=XLSX[_0x38064b(0x15b)](_0x3fa488,{'bookType':_0x38064b(0xe7),'type':'buffer'});_0x188e4e['setHeader'](_0x38064b(0x178),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x188e4e[_0x38064b(0x160)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x188e4e[_0x38064b(0x194)](_0x2d0498);}else _0x2f4e2b+=_0x38064b(0x107),_0x2f4e2b+=_0x38064b(0x18a),_0x2f4e2b+=_0x38064b(0x1f1),_0x2f4e2b+='};',_0x2f4e2b+=_0x38064b(0x1ee),_0x188e4e['send'](_0x2f4e2b);}else await Reference[_0x38064b(0x19a)]({'referenceNumber':_0x207f4f}),_0x540dfa[_0x38064b(0x159)](_0x38064b(0x201),'No\x20data\x20was\x20Found!'),_0x188e4e[_0x38064b(0x26c)](_0x38064b(0x233));})[_0x1310bc(0xf6)](console[_0x1310bc(0x132)]);}),router['get'](a0_0x5de9ce(0x23a),auth,async(_0x5c380f,_0x55c444)=>{const _0xb4f9d8=a0_0x5de9ce;try{const {username:_0x23d420,email:_0x4bfced,role:_0x420b09}=_0x5c380f[_0xb4f9d8(0x1f3)],_0x72a86e=_0x5c380f[_0xb4f9d8(0x1f3)],_0x5071ad=await profile[_0xb4f9d8(0x24c)]({'email':_0x72a86e['email']}),_0x35d714={'year':'numeric','month':_0xb4f9d8(0x223),'day':'numeric'},_0x39e7ba=await master_shop[_0xb4f9d8(0xe9)]();console[_0xb4f9d8(0x1be)](_0xb4f9d8(0x1cc),_0x39e7ba);const _0x457931=await product['find']();console['log']('Products\x20find_data',_0x457931);const _0x305a10=await warehouse[_0xb4f9d8(0xfb)]([{'$unwind':_0xb4f9d8(0x119)},{'$lookup':{'from':_0xb4f9d8(0x26d),'localField':_0xb4f9d8(0x1b7),'foreignField':'name','as':'product_docs'}},{'$unwind':_0xb4f9d8(0x139)},{'$project':{'product_name':_0xb4f9d8(0x1c5),'product_stock':_0xb4f9d8(0x137)}},{'$group':{'_id':_0xb4f9d8(0x1cd),'product_stock':{'$sum':_0xb4f9d8(0x267)}}}]);console[_0xb4f9d8(0x1be)](_0xb4f9d8(0x13c),_0x305a10),_0x305a10[_0xb4f9d8(0x187)](_0x565184=>{const _0x17de14=_0x457931['map'](_0x4f3aed=>{const _0x1fda42=a0_0x28b6;_0x4f3aed[_0x1fda42(0x158)]==_0x565184[_0x1fda42(0x261)]&&(_0x4f3aed[_0x1fda42(0x22d)]=parseInt(_0x4f3aed[_0x1fda42(0x22d)])+parseInt(_0x565184[_0x1fda42(0x16d)]));});});const _0x148bcb=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x28a6e1=await staff[_0xb4f9d8(0x24c)]({'email':_0x72a86e[_0xb4f9d8(0x10d)]});if(_0x39e7ba[0x0][_0xb4f9d8(0x174)]==_0xb4f9d8(0x22c))var _0x217e99=users[_0xb4f9d8(0x1bd)];else{if(_0x39e7ba[0x0]['language']==_0xb4f9d8(0xf7))var _0x217e99=users[_0xb4f9d8(0xf7)];else{if(_0x39e7ba[0x0][_0xb4f9d8(0x174)]==_0xb4f9d8(0x172))var _0x217e99=users[_0xb4f9d8(0x172)];else{if(_0x39e7ba[0x0][_0xb4f9d8(0x174)]==_0xb4f9d8(0x221))var _0x217e99=users[_0xb4f9d8(0x221)];else{if(_0x39e7ba[0x0][_0xb4f9d8(0x174)]==_0xb4f9d8(0x1b5))var _0x217e99=users[_0xb4f9d8(0x1b5)];else{if(_0x39e7ba[0x0][_0xb4f9d8(0x174)]==_0xb4f9d8(0x1f6))var _0x217e99=users[_0xb4f9d8(0x100)];else{if(_0x39e7ba[0x0][_0xb4f9d8(0x174)]==_0xb4f9d8(0x14c))var _0x217e99=users[_0xb4f9d8(0x14c)];else{if(_0x39e7ba[0x0][_0xb4f9d8(0x174)]==_0xb4f9d8(0x242))var _0x217e99=users[_0xb4f9d8(0x1d8)];}}}}}}}_0x55c444[_0xb4f9d8(0x1ef)](_0xb4f9d8(0x1f4),{'success':_0x5c380f['flash'](_0xb4f9d8(0xe4)),'errors':_0x5c380f['flash'](_0xb4f9d8(0x201)),'alldata':_0x457931,'profile':_0x5071ad,'master_shop':_0x39e7ba,'role':_0x72a86e,'product_stock':_0x305a10,'language':_0x217e99,'staff_arr':_0x28a6e1,'staff_data_all':_0x148bcb});}catch(_0x27c74a){}}),router[a0_0x5de9ce(0x20e)]('/getDSSR_no',auth,async(_0x36004e,_0x345560)=>{const _0x3df186=a0_0x5de9ce;try{const {from:_0x19d0ad,to:_0x470ad7,staff_data:_0x15dcc0}=_0x36004e['body'],_0x1ee902=await Reference[_0x3df186(0xfb)]([{'$match':{'date_include':{'$gte':_0x19d0ad,'$lte':_0x470ad7},'staff_id':_0x15dcc0}},{'$sort':{'date_include':0x1}}]);_0x345560[_0x3df186(0x118)](_0x1ee902);}catch(_0x46fa70){_0x345560[_0x3df186(0x118)](_0x46fa70);}}),router[a0_0x5de9ce(0x20e)](a0_0x5de9ce(0x126),auth,async(_0x4036b6,_0x38297a)=>{const _0x29dae8=a0_0x5de9ce;try{const {from:_0x411b73,to:_0x3314b0}=_0x4036b6[_0x29dae8(0x18d)],{sttaff_id:_0x16b5af}=_0x4036b6[_0x29dae8(0x1f3)],_0x3d27ba=await Reference[_0x29dae8(0xfb)]([{'$match':{'date_include':{'$gte':_0x411b73,'$lte':_0x3314b0},'staff_id':_0x16b5af}},{'$sort':{'date_include':0x1}}]);_0x38297a[_0x29dae8(0x118)](_0x3d27ba);}catch(_0xbb9556){_0x38297a[_0x29dae8(0x118)](_0xbb9556);}}),router['get'](a0_0x5de9ce(0x1cf),auth,async(_0x4692d2,_0x22d3e9)=>{const _0x411cc7=a0_0x5de9ce;try{const _0x2f2846=_0x4692d2[_0x411cc7(0x21d)]['id'],_0x49e4bc=await Reference[_0x411cc7(0x12d)](_0x2f2846);let _0x35c680='';_0x35c680+=_0x49e4bc['html'],_0x35c680+=_0x411cc7(0x107),_0x35c680+=_0x411cc7(0x18a),_0x35c680+=_0x411cc7(0x1f1),_0x35c680+='};',_0x35c680+=_0x411cc7(0x1ee),_0x22d3e9[_0x411cc7(0x194)](_0x35c680);}catch(_0x47dbbe){_0x22d3e9['json'](_0x47dbbe);}}),router[a0_0x5de9ce(0x20e)](a0_0x5de9ce(0x1f9),auth,async(_0xeff33e,_0x1284cc)=>{const _0x1d83d8=a0_0x5de9ce;try{const {ref_data:_0x2fd46f}=_0xeff33e[_0x1d83d8(0x18d)],_0x369907=_0x2fd46f[_0x1d83d8(0x1c9)]('~'),_0x4520bc=_0x369907[_0x1d83d8(0x23d)](_0x344e19=>_0x344e19!==''),_0xbbbe9f=await Reference[_0x1d83d8(0xfb)]([{'$match':{'referenceNumber':{'$in':_0x4520bc}}}]),_0x1744e6=XLSX[_0x1d83d8(0x15c)][_0x1d83d8(0x1f2)]();_0xbbbe9f[_0x1d83d8(0x187)](_0x1c2dc1=>{const _0x32c2f4=_0x1d83d8,_0x3e7a2c=cheerio[_0x32c2f4(0x1d4)](_0x1c2dc1[_0x32c2f4(0x200)]);let _0x48db16=[],_0x16b5ea=[],_0x3c9b5f=[];_0x3e7a2c(_0x32c2f4(0xec))[_0x32c2f4(0x18e)]((_0x164735,_0x576579)=>{const _0x49a15a=_0x32c2f4;let _0x1dcae9=[],_0x49821d=0x0;while(_0x3c9b5f[_0x49821d]){_0x3c9b5f[_0x49821d]--,_0x49821d++;}_0x3e7a2c(_0x576579)['find'](_0x49a15a(0x22a))[_0x49a15a(0x18e)]((_0x5eff19,_0x28fce7)=>{const _0x39d5d6=_0x49a15a;let _0x5ada82=_0x3e7a2c(_0x28fce7)['text']()['trim'](),_0x5828f8=parseFloat(_0x5ada82[_0x39d5d6(0x216)](/,/g,''));isNaN(_0x5828f8)&&(_0x5828f8=_0x5ada82);let _0x2b728e=parseInt(_0x3e7a2c(_0x28fce7)[_0x39d5d6(0x170)](_0x39d5d6(0x265)))||0x1,_0x49f462=parseInt(_0x3e7a2c(_0x28fce7)[_0x39d5d6(0x170)]('rowspan'))||0x1;_0x1dcae9[_0x49821d]=_0x5828f8;(_0x2b728e>0x1||_0x49f462>0x1)&&_0x16b5ea[_0x39d5d6(0x1ba)]({'s':{'r':_0x164735,'c':_0x49821d},'e':{'r':_0x164735+_0x49f462-0x1,'c':_0x49821d+_0x2b728e-0x1}});for(let _0x1a6cc0=0x0;_0x1a6cc0<_0x2b728e;_0x1a6cc0++){_0x49f462>0x1&&(_0x3c9b5f[_0x49821d+_0x1a6cc0]=_0x49f462-0x1);}_0x49821d+=_0x2b728e;}),_0x48db16[_0x49a15a(0x1ba)](_0x1dcae9);});const _0x4ae0d1=XLSX[_0x32c2f4(0x15c)]['aoa_to_sheet'](_0x48db16);_0x16b5ea[_0x32c2f4(0x17a)]>0x0&&(_0x4ae0d1['!merges']=_0x16b5ea),_0x4ae0d1['!cols']=_0x48db16[0x0][_0x32c2f4(0x13d)](()=>({'wpx':0x64})),XLSX[_0x32c2f4(0x15c)][_0x32c2f4(0x1b6)](_0x1744e6,_0x4ae0d1,_0x1c2dc1[_0x32c2f4(0x250)]);});const _0x25eabd=XLSX['write'](_0x1744e6,{'bookType':_0x1d83d8(0xe7),'type':_0x1d83d8(0x238)});_0x1284cc[_0x1d83d8(0x160)](_0x1d83d8(0x178),'attachment;\x20filename=\x22reports.xlsx\x22'),_0x1284cc[_0x1d83d8(0x160)](_0x1d83d8(0x25a),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x1284cc[_0x1d83d8(0x194)](_0x25eabd);}catch(_0x236b51){_0x1284cc[_0x1d83d8(0x118)](_0x236b51);}}),router[a0_0x5de9ce(0x20e)](a0_0x5de9ce(0x1e0),auth,async(_0x15080a,_0x21e029)=>{const _0x1aeb3a=a0_0x5de9ce,{from_date:_0x2b9e18,agent_id:_0x23355a}=_0x15080a[_0x1aeb3a(0x18d)],_0x13850a=_0x15080a[_0x1aeb3a(0x1f3)],_0x5ade76=await staff[_0x1aeb3a(0x24c)]({'email':_0x13850a[_0x1aeb3a(0x10d)]}),_0x51abfc=await master_shop[_0x1aeb3a(0xe9)](),_0x321c8a=await agentsdataDSICheck_DSRR(_0x2b9e18,_0x23355a,_0x5c6915);let _0x5ea5e8=_0x1aeb3a(0x207);var _0x194cf6=new Date(_0x2b9e18);const _0x5838b5={'year':_0x1aeb3a(0x1dc),'month':_0x1aeb3a(0x223),'day':_0x1aeb3a(0x1dc)},_0x33679d=new Intl['DateTimeFormat']('en-US',_0x5838b5)['format'](_0x194cf6);_0x5ea5e8+=_0x1aeb3a(0x241),_0x5ea5e8+=_0x1aeb3a(0x21e),_0x5ea5e8+=_0x1aeb3a(0xff),_0x5ea5e8+=_0x321c8a,_0x5ea5e8+=_0x1aeb3a(0x196),_0x5ea5e8+=_0x1aeb3a(0x1d9),_0x5ea5e8+=_0x1aeb3a(0x1d9);let _0x567a77=_0x1aeb3a(0x128);const _0x37ca11={'width':'15in','height':_0x1aeb3a(0x147),'orientation':_0x1aeb3a(0x173),'border':{'top':_0x1aeb3a(0xe2),'right':_0x1aeb3a(0xe2),'bottom':_0x1aeb3a(0xe2),'left':_0x1aeb3a(0xe2)},'header':{'height':_0x1aeb3a(0x206),'contents':_0x1aeb3a(0x1a9)+_0x567a77+_0x1aeb3a(0x244)+_0x33679d+_0x1aeb3a(0x25d)},'footer':{'height':_0x1aeb3a(0x231),'contents':{'default':_0x1aeb3a(0x1d7)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};var _0x5c6915='on';if(_0x5c6915=='on'){const _0x5197de=cheerio['load'](_0x5ea5e8);let _0x5e80ca=[],_0x5912f3=[],_0x1caea4=[];_0x5197de(_0x1aeb3a(0xec))[_0x1aeb3a(0x18e)]((_0x128611,_0x558a48)=>{const _0x971e8d=_0x1aeb3a;let _0x4be494=[],_0x4bb7c4=0x0;while(_0x1caea4[_0x4bb7c4]){_0x1caea4[_0x4bb7c4]--,_0x4bb7c4++;}_0x5197de(_0x558a48)['find'](_0x971e8d(0x22a))[_0x971e8d(0x18e)]((_0xc48177,_0x3978d2)=>{const _0x555f8f=_0x971e8d;let _0x6ca6c6=_0x5197de(_0x3978d2)[_0x555f8f(0x1c6)]()[_0x555f8f(0x20b)](),_0x55696e=parseFloat(_0x6ca6c6[_0x555f8f(0x216)](/,/g,''));isNaN(_0x55696e)&&(_0x55696e=_0x6ca6c6);let _0x217709=parseInt(_0x5197de(_0x3978d2)[_0x555f8f(0x170)](_0x555f8f(0x265)))||0x1,_0x479249=parseInt(_0x5197de(_0x3978d2)[_0x555f8f(0x170)]('rowspan'))||0x1;_0x4be494[_0x4bb7c4]=_0x55696e;(_0x217709>0x1||_0x479249>0x1)&&_0x5912f3[_0x555f8f(0x1ba)]({'s':{'r':_0x128611,'c':_0x4bb7c4},'e':{'r':_0x128611+_0x479249-0x1,'c':_0x4bb7c4+_0x217709-0x1}});for(let _0x1cf049=0x0;_0x1cf049<_0x217709;_0x1cf049++){_0x479249>0x1&&(_0x1caea4[_0x4bb7c4+_0x1cf049]=_0x479249-0x1);}_0x4bb7c4+=_0x217709;}),_0x5e80ca[_0x971e8d(0x1ba)](_0x4be494);});const _0x5b8077=XLSX[_0x1aeb3a(0x15c)][_0x1aeb3a(0x1f2)](),_0x1b5ef4=XLSX[_0x1aeb3a(0x15c)][_0x1aeb3a(0x217)](_0x5e80ca);_0x5912f3[_0x1aeb3a(0x17a)]>0x0&&(_0x1b5ef4[_0x1aeb3a(0x1d3)]=_0x5912f3);_0x1b5ef4[_0x1aeb3a(0x1bf)]=_0x5e80ca[0x0][_0x1aeb3a(0x13d)](()=>({'wpx':0x64})),XLSX['utils'][_0x1aeb3a(0x1b6)](_0x5b8077,_0x1b5ef4,_0x1aeb3a(0x1e9));const _0x381372=XLSX[_0x1aeb3a(0x15b)](_0x5b8077,{'bookType':_0x1aeb3a(0xe7),'type':'buffer'});_0x21e029[_0x1aeb3a(0x160)](_0x1aeb3a(0x178),_0x1aeb3a(0x120)),_0x21e029['setHeader']('Content-Type',_0x1aeb3a(0x1a5)),_0x21e029['send'](_0x381372);}else pdf[_0x1aeb3a(0x218)](_0x5ea5e8,_0x37ca11)[_0x1aeb3a(0x171)](function(_0x190b9f,_0x296d5e){const _0x1754d=_0x1aeb3a;if(_0x190b9f){_0x21e029[_0x1754d(0x1e8)](0x1f4)[_0x1754d(0x194)]('Error\x20generating\x20PDF');return;}_0x21e029[_0x1754d(0x160)](_0x1754d(0x25a),_0x1754d(0x259)),_0x296d5e[_0x1754d(0x255)](_0x21e029);});}),module[a0_0x5de9ce(0x1c3)]=router;