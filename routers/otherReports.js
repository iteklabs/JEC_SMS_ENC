const a0_0x5e81ee=a0_0x5735;(function(_0x451852,_0x212c6b){const _0x552b5c=a0_0x5735,_0x3529a9=_0x451852();while(!![]){try{const _0x1085e3=-parseInt(_0x552b5c(0xfa))/0x1*(parseInt(_0x552b5c(0x179))/0x2)+parseInt(_0x552b5c(0x166))/0x3+parseInt(_0x552b5c(0xf6))/0x4*(-parseInt(_0x552b5c(0xfb))/0x5)+parseInt(_0x552b5c(0x1a7))/0x6*(-parseInt(_0x552b5c(0x101))/0x7)+-parseInt(_0x552b5c(0x1c3))/0x8+parseInt(_0x552b5c(0x264))/0x9*(-parseInt(_0x552b5c(0x1f5))/0xa)+-parseInt(_0x552b5c(0x184))/0xb*(-parseInt(_0x552b5c(0x161))/0xc);if(_0x1085e3===_0x212c6b)break;else _0x3529a9['push'](_0x3529a9['shift']());}catch(_0x39e4b2){_0x3529a9['push'](_0x3529a9['shift']());}}}(a0_0x3494,0xcf5de));const express=require(a0_0x5e81ee(0x26b)),res=require(a0_0x5e81ee(0x17d)),app=express(),router=express[a0_0x5e81ee(0x234)](),multer=require(a0_0x5e81ee(0x117)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x5e81ee(0x12f)),auth=require(a0_0x5e81ee(0x242)),users=require(a0_0x5e81ee(0x10b)),excelJS=require(a0_0x5e81ee(0x104)),XLSX=require(a0_0x5e81ee(0x1f0)),PDFDocument=require(a0_0x5e81ee(0xf3)),fs=require('fs'),blobStream=require(a0_0x5e81ee(0x25c)),JsBarcode=require(a0_0x5e81ee(0x169)),{Canvas}=require(a0_0x5e81ee(0x168)),pdf=require(a0_0x5e81ee(0x1d6)),path=require(a0_0x5e81ee(0x22b)),mongoose=require(a0_0x5e81ee(0x14f)),cheerio=require(a0_0x5e81ee(0x208));router[a0_0x5e81ee(0x100)](a0_0x5e81ee(0x198),auth,async(_0x427512,_0x4089c5)=>{const _0x4fa956=a0_0x5e81ee;try{const {username:_0x36b70f,email:_0x5b54ac,role:_0x572c3b}=_0x427512['user'],_0x2de3d6=_0x427512[_0x4fa956(0x26f)],_0x5d7267=await profile[_0x4fa956(0x189)]({'email':_0x2de3d6[_0x4fa956(0x102)]}),_0x4077be={'year':_0x4fa956(0x174),'month':'long','day':_0x4fa956(0x174)},_0x134eac=await master_shop[_0x4fa956(0x183)]();console['log']('Products\x20master',_0x134eac);const _0x2373bd=await product['find']();console[_0x4fa956(0x127)](_0x4fa956(0x107),_0x2373bd);const _0x5399d8=await warehouse['aggregate']([{'$unwind':_0x4fa956(0x213)},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':_0x4fa956(0x27b),'as':_0x4fa956(0x16a)}},{'$unwind':_0x4fa956(0x21f)},{'$project':{'product_name':_0x4fa956(0x1f4),'product_stock':_0x4fa956(0x17b)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x4fa956(0xec)}}}]);console[_0x4fa956(0x127)]('Products\x20warehouse_data',_0x5399d8),_0x5399d8['forEach'](_0x4b889f=>{const _0x4a7a85=_0x4fa956,_0x1cd18d=_0x2373bd[_0x4a7a85(0x10a)](_0x2a21ad=>{const _0x553b0f=_0x4a7a85;_0x2a21ad[_0x553b0f(0x27b)]==_0x4b889f['_id']&&(_0x2a21ad[_0x553b0f(0x178)]=parseInt(_0x2a21ad['stock'])+parseInt(_0x4b889f['product_stock']));});}),console['log'](_0x4fa956(0x107),_0x2373bd);if(_0x134eac[0x0][_0x4fa956(0x1d7)]==_0x4fa956(0x14a))var _0xd1c2d3=users['English'];else{if(_0x134eac[0x0][_0x4fa956(0x1d7)]==_0x4fa956(0x12e))var _0xd1c2d3=users[_0x4fa956(0x12e)];else{if(_0x134eac[0x0][_0x4fa956(0x1d7)]==_0x4fa956(0x1c7))var _0xd1c2d3=users[_0x4fa956(0x1c7)];else{if(_0x134eac[0x0]['language']==_0x4fa956(0x1d9))var _0xd1c2d3=users[_0x4fa956(0x1d9)];else{if(_0x134eac[0x0][_0x4fa956(0x1d7)]==_0x4fa956(0x22f))var _0xd1c2d3=users['French'];else{if(_0x134eac[0x0][_0x4fa956(0x1d7)]==_0x4fa956(0x139))var _0xd1c2d3=users[_0x4fa956(0x149)];else{if(_0x134eac[0x0]['language']=='Chinese')var _0xd1c2d3=users[_0x4fa956(0x148)];else{if(_0x134eac[0x0][_0x4fa956(0x1d7)]==_0x4fa956(0xef))var _0xd1c2d3=users[_0x4fa956(0x1ed)];}}}}}}}_0x4089c5[_0x4fa956(0x18e)]('balanced',{'success':_0x427512[_0x4fa956(0x187)]('success'),'errors':_0x427512[_0x4fa956(0x187)]('errors'),'alldata':_0x2373bd,'profile':_0x5d7267,'master_shop':_0x134eac,'role':_0x2de3d6,'product_stock':_0x5399d8,'language':_0xd1c2d3});}catch(_0x22d8a6){}});async function dataCheck(_0x575a11,_0x205333){const _0xa43e99=a0_0x5e81ee,_0x1739d0=await product[_0xa43e99(0x133)]([{'$group':{'_id':{'brand':_0xa43e99(0x1e1),'category':_0xa43e99(0x170)},'products':{'$push':{'name':_0xa43e99(0x223),'product_code':_0xa43e99(0x1fc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x453de6=[];_0x453de6[_0xa43e99(0x258)]=[];for(let _0x5b4a87=0x0;_0x5b4a87<=_0x1739d0[_0xa43e99(0x175)]-0x1;_0x5b4a87++){const _0x3ea40a=_0x1739d0[_0x5b4a87];_0x453de6[_0xa43e99(0x258)][_0xa43e99(0x136)](_0x3ea40a);}const _0x173e3a=await product[_0xa43e99(0x133)]([{'$group':{'_id':{'category':_0xa43e99(0x170)},'products':{'$push':{'brand':_0xa43e99(0x1e1),'product_code':_0xa43e99(0x1fc),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x12a238=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x575a11,'$lte':_0x205333}}},{'$unwind':_0xa43e99(0xf0)},{'$group':{'_id':{'product_name':_0xa43e99(0x10c),'product_code':_0xa43e99(0x201)},'totalQTY':{'$sum':_0xa43e99(0x205)}}}]);_0x453de6[_0xa43e99(0x20c)]=[];for(let _0x58d727=0x0;_0x58d727<=_0x12a238[_0xa43e99(0x175)]-0x1;_0x58d727++){const _0x5b56ab=_0x12a238[_0x58d727];_0x453de6[_0xa43e99(0x20c)][_0xa43e99(0x136)](_0x5b56ab);}const _0x56d0dd=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x575a11,'$lte':_0x205333}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0xa43e99(0xf7)}}},{'$lookup':{'from':_0xa43e99(0x1d3),'localField':'sales_staff_id','foreignField':_0xa43e99(0x130),'as':_0xa43e99(0x1fb)}},{'$unwind':_0xa43e99(0x137)},{'$unwind':_0xa43e99(0x21b)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0xa43e99(0x1e3),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0xa43e99(0xf9)}}}]);console[_0xa43e99(0x127)](_0x56d0dd[0x0]),_0x453de6['sales_bkg']=[];for(let _0x201c04=0x0;_0x201c04<=_0x56d0dd['length']-0x1;_0x201c04++){const _0x7789b1=_0x56d0dd[_0x201c04];_0x453de6[_0xa43e99(0x145)]['push'](_0x7789b1);}const _0xe392b4=await sales_sa[_0xa43e99(0x133)]([{'$match':{'date':{'$gte':_0x575a11,'$lte':_0x205333}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0xa43e99(0xf7)}}},{'$lookup':{'from':_0xa43e99(0x1d3),'localField':'sales_staff_id','foreignField':_0xa43e99(0x130),'as':'sales_info'}},{'$unwind':_0xa43e99(0x137)},{'$unwind':_0xa43e99(0x21b)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0xa43e99(0x1d0)}},{'$group':{'_id':{'product_name':_0xa43e99(0x1e3),'product_code':_0xa43e99(0x1dc)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'}}}]);_0x453de6[_0xa43e99(0x195)]=[];for(let _0x376130=0x0;_0x376130<=_0xe392b4['length']-0x1;_0x376130++){const _0x1c70ab=_0xe392b4[_0x376130];_0x453de6[_0xa43e99(0x195)][_0xa43e99(0x136)](_0x1c70ab);}let _0x462214='';for(let _0x2b78ad=0x0;_0x2b78ad<=_0x173e3a[_0xa43e99(0x175)]-0x1;_0x2b78ad++){const _0x3bf124=_0x173e3a[_0x2b78ad];_0x462214+='<tr>',_0x462214+=_0xa43e99(0x272)+_0x3bf124[_0xa43e99(0x130)][_0xa43e99(0x25e)]+_0xa43e99(0x15e),_0x462214+=_0xa43e99(0x19e);for(let _0x1066ed=0x0;_0x1066ed<_0x453de6[_0xa43e99(0x258)][_0xa43e99(0x175)];_0x1066ed++){const _0x3261bc=_0x453de6[_0xa43e99(0x258)][_0x1066ed];if(_0x3261bc['_id'][_0xa43e99(0x25e)]==_0x3bf124[_0xa43e99(0x130)][_0xa43e99(0x25e)]){let _0x14c810=[],_0x55bee7=[],_0x51fb71=[];_0x14c810[_0x3261bc[_0xa43e99(0x130)][_0xa43e99(0x20a)]]=[],_0x55bee7[_0x3261bc[_0xa43e99(0x130)]['brand']]=[],_0x51fb71[_0x3261bc[_0xa43e99(0x130)]['brand']]=[];var _0x2a2bff=0x0,_0x38650b=0x0,_0x21db9b=0x0;for(let _0x20c6b9=0x0;_0x20c6b9<_0x3261bc['products'][_0xa43e99(0x175)];_0x20c6b9++){const _0xa69578=_0x3261bc[_0xa43e99(0x1bd)][_0x20c6b9];for(let _0x103a38=0x0;_0x103a38<=_0x453de6[_0xa43e99(0x20c)][_0xa43e99(0x175)]-0x1;_0x103a38++){const _0x585586=_0x453de6[_0xa43e99(0x20c)][_0x103a38];_0x585586[_0xa43e99(0x130)][_0xa43e99(0x1b1)]==_0xa69578[_0xa43e99(0x27b)]&&_0x585586[_0xa43e99(0x130)]['product_code']==_0xa69578['product_code']&&(_0x2a2bff+=parseInt(_0x585586['totalQTY'],0xa));}for(let _0x5f543b=0x0;_0x5f543b<=_0x453de6['sales_ext']['length']-0x1;_0x5f543b++){const _0x53000a=_0x453de6[_0xa43e99(0x195)][_0x5f543b];_0x53000a[_0xa43e99(0x130)][_0xa43e99(0x1b1)]==_0xa69578[_0xa43e99(0x27b)]&&_0x53000a['_id'][_0xa43e99(0x17c)]==_0xa69578[_0xa43e99(0x17c)]&&(_0x38650b+=parseFloat(_0x53000a['totalQTY'],0xa)['toFixed'](0x2));}for(let _0x3fc127=0x0;_0x3fc127<=_0x453de6['sales_bkg'][_0xa43e99(0x175)]-0x1;_0x3fc127++){const _0x4d9edc=_0x453de6[_0xa43e99(0x145)][_0x3fc127];_0x4d9edc[_0xa43e99(0x130)]['product_name']==_0xa69578[_0xa43e99(0x27b)]&&_0x4d9edc[_0xa43e99(0x130)][_0xa43e99(0x17c)]==_0xa69578['product_code']&&(_0x21db9b+=parseInt(_0x4d9edc['totalQTY'],0xa));}}const _0x2f6978=new Intl[(_0xa43e99(0x236))]('en-US');var _0x46249b=_0x2f6978[_0xa43e99(0xee)](_0x2a2bff);_0x14c810[_0x3261bc['_id'][_0xa43e99(0x20a)]][_0xa43e99(0x136)](_0x46249b),_0x55bee7[_0x3261bc[_0xa43e99(0x130)]['brand']][_0xa43e99(0x136)](_0x2f6978['format'](_0x38650b)),_0x51fb71[_0x3261bc[_0xa43e99(0x130)][_0xa43e99(0x20a)]][_0xa43e99(0x136)](_0x2f6978[_0xa43e99(0xee)](_0x21db9b));var _0x242ca8=_0x2f6978[_0xa43e99(0xee)](_0x2a2bff-(_0x21db9b+_0x38650b));_0x462214+=_0xa43e99(0x1b9),_0x462214+='<td\x20class=\x22row_data\x22></td>',_0x462214+=_0xa43e99(0x25b)+_0x3261bc[_0xa43e99(0x130)][_0xa43e99(0x20a)]+_0xa43e99(0x15e),_0x462214+=_0xa43e99(0x25b)+_0x14c810[_0x3261bc[_0xa43e99(0x130)][_0xa43e99(0x20a)]][0x0]+'</td>',_0x462214+=_0xa43e99(0x257),_0x462214+=_0xa43e99(0x25b)+_0x51fb71[_0x3261bc['_id'][_0xa43e99(0x20a)]][0x0]+_0xa43e99(0x15e),_0x462214+=_0xa43e99(0x25b)+_0x55bee7[_0x3261bc[_0xa43e99(0x130)]['brand']][0x0]+_0xa43e99(0x15e),_0x462214+=_0xa43e99(0x25b)+_0x242ca8+'</td>',_0x462214+=_0xa43e99(0x19e);}}}return console['log'](_0x453de6[_0xa43e99(0x145)]),_0x462214;}function a0_0x5735(_0x1c8500,_0x488983){const _0x349473=a0_0x3494();return a0_0x5735=function(_0x57356f,_0x1429cd){_0x57356f=_0x57356f-0xec;let _0x283b8e=_0x349473[_0x57356f];return _0x283b8e;},a0_0x5735(_0x1c8500,_0x488983);}router[a0_0x5e81ee(0x1cc)](a0_0x5e81ee(0x196),auth,async(_0x50701c,_0x4cbca6)=>{const _0x2f4e71=a0_0x5e81ee,{from_date:_0x36044e,to_date:_0x2c20ab}=_0x50701c[_0x2f4e71(0x24f)],_0xd3840f=await dataCheck(_0x36044e,_0x2c20ab);{}let _0x17ff51=_0x2f4e71(0x1f2);var _0x5069a9=new Date(_0x36044e),_0x313fe2=new Date(_0x2c20ab);const _0x4c1f1c={'year':_0x2f4e71(0x174),'month':_0x2f4e71(0x11c),'day':'numeric'},_0x291371=new Intl[(_0x2f4e71(0x251))](_0x2f4e71(0x164),_0x4c1f1c)[_0x2f4e71(0xee)](_0x5069a9),_0x2a51a1=new Intl[(_0x2f4e71(0x251))](_0x2f4e71(0x164),_0x4c1f1c)[_0x2f4e71(0xee)](_0x313fe2);_0x17ff51+=_0x2f4e71(0x19b),_0x17ff51+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x17ff51+='<p>'+_0x291371+_0x2f4e71(0x204)+_0x2a51a1+'</p>',_0x17ff51+=_0x2f4e71(0x1ef),_0x17ff51+='<div\x20class=\x22col-sm-11\x22>',_0x17ff51+='<table>',_0x17ff51+=_0x2f4e71(0x1b9),_0x17ff51+=_0x2f4e71(0x122),_0x17ff51+=_0x2f4e71(0x16f),_0x17ff51+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x291371+_0x2f4e71(0xfd),_0x17ff51+='<th\x20rowspan=\x272\x27>Production</th>',_0x17ff51+=_0x2f4e71(0x212),_0x17ff51+=_0x2f4e71(0x17f)+_0x2a51a1+_0x2f4e71(0xfd),_0x17ff51+='</tr>',_0x17ff51+=_0x2f4e71(0x1b9),_0x17ff51+='<th>Booking</th>',_0x17ff51+=_0x2f4e71(0x237),_0x17ff51+=_0x2f4e71(0x19e),_0x17ff51+=_0xd3840f,_0x17ff51+=_0x2f4e71(0x1ab),_0x17ff51+='</div>',_0x17ff51+=_0x2f4e71(0x1db);const _0x2824f0={'format':'Letter','orientation':'landscape'};pdf[_0x2f4e71(0x1cf)](_0x17ff51,_0x2824f0)[_0x2f4e71(0x1ce)](function(_0x2a9c53,_0x1ba195){const _0x41a666=_0x2f4e71;if(_0x2a9c53){_0x4cbca6[_0x41a666(0x19d)](0x1f4)['send'](_0x41a666(0x275));return;}_0x4cbca6[_0x41a666(0x226)]('Content-Type','application/pdf'),_0x1ba195[_0x41a666(0x13b)](_0x4cbca6);});}),router[a0_0x5e81ee(0x100)](a0_0x5e81ee(0x1e0),auth,async(_0x244fff,_0x2fd50b)=>{const _0x44eae6=a0_0x5e81ee;try{const {username:_0xa36491,email:_0xbae240,role:_0xa22206}=_0x244fff[_0x44eae6(0x26f)],_0x32aebc=_0x244fff[_0x44eae6(0x26f)],_0x47acde=await profile['findOne']({'email':_0x32aebc['email']}),_0x1831d2={'year':_0x44eae6(0x174),'month':'long','day':_0x44eae6(0x174)},_0x158c69=await master_shop[_0x44eae6(0x183)](),_0x1b554a=await product[_0x44eae6(0x183)](),_0x1aa1ae=await warehouse['aggregate']([{'$unwind':_0x44eae6(0x213)},{'$lookup':{'from':_0x44eae6(0x1bd),'localField':_0x44eae6(0x20e),'foreignField':_0x44eae6(0x27b),'as':_0x44eae6(0x16a)}},{'$unwind':_0x44eae6(0x21f)},{'$project':{'product_name':_0x44eae6(0x1f4),'product_stock':_0x44eae6(0x17b)}},{'$group':{'_id':_0x44eae6(0x1fd),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x158c69[0x0][_0x44eae6(0x1d7)]==_0x44eae6(0x14a))var _0x28eaa0=users['English'];else{if(_0x158c69[0x0][_0x44eae6(0x1d7)]=='Hindi')var _0x28eaa0=users[_0x44eae6(0x12e)];else{if(_0x158c69[0x0]['language']==_0x44eae6(0x1c7))var _0x28eaa0=users[_0x44eae6(0x1c7)];else{if(_0x158c69[0x0][_0x44eae6(0x1d7)]==_0x44eae6(0x1d9))var _0x28eaa0=users['Spanish'];else{if(_0x158c69[0x0][_0x44eae6(0x1d7)]==_0x44eae6(0x22f))var _0x28eaa0=users[_0x44eae6(0x22f)];else{if(_0x158c69[0x0]['language']==_0x44eae6(0x139))var _0x28eaa0=users['Portuguese'];else{if(_0x158c69[0x0][_0x44eae6(0x1d7)]==_0x44eae6(0x148))var _0x28eaa0=users[_0x44eae6(0x148)];else{if(_0x158c69[0x0][_0x44eae6(0x1d7)]=='Arabic\x20(ae)')var _0x28eaa0=users['Arabic'];}}}}}}}_0x2fd50b[_0x44eae6(0x18e)]('agent_sales',{'success':_0x244fff[_0x44eae6(0x187)](_0x44eae6(0x1b0)),'errors':_0x244fff[_0x44eae6(0x187)](_0x44eae6(0x14c)),'alldata':_0x1b554a,'profile':_0x47acde,'master_shop':_0x158c69,'role':_0x32aebc,'product_stock':_0x1aa1ae,'language':_0x28eaa0});}catch(_0x4abd5f){}});async function agentsdataCheck(_0x2a94a8,_0x164c77){const _0x1151ee=a0_0x5e81ee,_0x34cdee=await product[_0x1151ee(0x133)]([{'$group':{'_id':{'brand':_0x1151ee(0x1e1),'category':_0x1151ee(0x170)},'products':{'$push':{'name':_0x1151ee(0x223),'product_code':_0x1151ee(0x1fc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xb64020=[];_0xb64020[_0x1151ee(0x258)]=[];for(let _0x7ac2eb=0x0;_0x7ac2eb<=_0x34cdee[_0x1151ee(0x175)]-0x1;_0x7ac2eb++){const _0x56c325=_0x34cdee[_0x7ac2eb];_0xb64020[_0x1151ee(0x258)][_0x1151ee(0x136)](_0x56c325);}const _0x2dc1eb=await product[_0x1151ee(0x133)]([{'$group':{'_id':{'category':_0x1151ee(0x170)},'products':{'$push':{'brand':_0x1151ee(0x1e1),'product_code':_0x1151ee(0x1fc),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x31f457=await product[_0x1151ee(0x133)]([{'$group':{'_id':{'category':_0x1151ee(0x170),'brand':_0x1151ee(0x1e1)}}},{'$group':{'_id':_0x1151ee(0x11d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2b50da=await sales_sa[_0x1151ee(0x133)]([{'$match':{'date':{'$gte':_0x2a94a8,'$lte':_0x164c77}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':'staffs','localField':'sales_staff_id','foreignField':'_id','as':_0x1151ee(0x1fb)}},{'$unwind':_0x1151ee(0x137)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x1151ee(0x1d0)}},{'$lookup':{'from':_0x1151ee(0x1bd),'localField':_0x1151ee(0x247),'foreignField':_0x1151ee(0x17c),'as':_0x1151ee(0x221)}},{'$unwind':_0x1151ee(0x19a)},{'$group':{'_id':{'sales_id':_0x1151ee(0x1df),'category':_0x1151ee(0x24d),'brand':_0x1151ee(0x222)},'salesman_data':{'$first':_0x1151ee(0x246)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x1151ee(0x1b5),'product_details':{'prod_name':_0x1151ee(0x1ff),'product_code':_0x1151ee(0x228),'category':_0x1151ee(0x24d),'brand':'$product_info.brand'}}}}}]);let _0x2d98d5='';_0x2d98d5+=_0x1151ee(0x1b9),_0x2d98d5+=_0x1151ee(0x1c2),_0x2d98d5+=_0x1151ee(0x19e),_0x2d98d5+=_0x1151ee(0x1b9),_0x2d98d5+=_0x1151ee(0x118);for(let _0x5776d7=0x0;_0x5776d7<=_0x2dc1eb[_0x1151ee(0x175)]-0x1;_0x5776d7++){const _0xae1ace=_0x2dc1eb[_0x5776d7];for(let _0x51f0ce=0x0;_0x51f0ce<_0x31f457[_0x1151ee(0x175)];_0x51f0ce++){const _0x272697=_0x31f457[_0x51f0ce];_0x272697[_0x1151ee(0x130)]==_0xae1ace[_0x1151ee(0x130)][_0x1151ee(0x25e)]&&(_0x2d98d5+=_0x1151ee(0x12d)+_0x272697[_0x1151ee(0x210)]+_0x1151ee(0x203)+_0xae1ace[_0x1151ee(0x130)][_0x1151ee(0x25e)]+'</td>');}}_0x2d98d5+='<td\x20class=\x22cat_data\x22></td>',_0x2d98d5+='</tr>',_0x2d98d5+=_0x1151ee(0x1b9),_0x2d98d5+=_0x1151ee(0x14e);for(let _0x36d8fd=0x0;_0x36d8fd<=_0x2dc1eb[_0x1151ee(0x175)]-0x1;_0x36d8fd++){const _0x81675c=_0x2dc1eb[_0x36d8fd];for(let _0x217d10=0x0;_0x217d10<_0xb64020[_0x1151ee(0x258)][_0x1151ee(0x175)];_0x217d10++){const _0x55b4fc=_0xb64020['cat_brand'][_0x217d10];_0x55b4fc[_0x1151ee(0x130)][_0x1151ee(0x25e)]==_0x81675c[_0x1151ee(0x130)][_0x1151ee(0x25e)]&&(_0x2d98d5+=_0x1151ee(0x262)+_0x55b4fc[_0x1151ee(0x130)][_0x1151ee(0x20a)]+'</td>');}}_0x2d98d5+=_0x1151ee(0x1aa),_0x2d98d5+=_0x1151ee(0x19e);let _0x5bc37e={'name':[],'dataqty':{}};for(let _0x537d90=0x0;_0x537d90<_0xb64020['cat_brand'][_0x1151ee(0x175)];_0x537d90++){const _0x38e0d5=_0xb64020[_0x1151ee(0x258)][_0x537d90],_0x29c5e6=_0x38e0d5['_id'][_0x1151ee(0x20a)],_0x113acc=_0x38e0d5[_0x1151ee(0x130)][_0x1151ee(0x25e)];!_0x5bc37e[_0x1151ee(0x225)][_0x29c5e6]&&(_0x5bc37e['dataqty'][_0x29c5e6]={});!_0x5bc37e[_0x1151ee(0x225)][_0x29c5e6][_0x113acc]&&(_0x5bc37e[_0x1151ee(0x225)][_0x29c5e6][_0x113acc]=[]);for(let _0x2ecb7b=0x0;_0x2ecb7b<_0x2b50da[_0x1151ee(0x175)];_0x2ecb7b++){const _0x41b7cb=_0x2b50da[_0x2ecb7b];if(_0x29c5e6===_0x41b7cb[_0x1151ee(0x130)][_0x1151ee(0x20a)]&&_0x113acc===_0x41b7cb['_id'][_0x1151ee(0x25e)]){const _0x2d4706=_0x41b7cb[_0x1151ee(0x269)];!_0x5bc37e[_0x1151ee(0x225)][_0x29c5e6][_0x113acc][_0x2d4706]&&(_0x5bc37e[_0x1151ee(0x225)][_0x29c5e6][_0x113acc][_0x2d4706]=[]),_0x5bc37e[_0x1151ee(0x225)][_0x29c5e6][_0x113acc][_0x2d4706][_0x1151ee(0x136)](_0x41b7cb[_0x1151ee(0x159)]),!_0x5bc37e[_0x1151ee(0x27b)][_0x1151ee(0x199)](_0x2d4706)&&_0x5bc37e[_0x1151ee(0x27b)][_0x1151ee(0x136)](_0x2d4706);}}}_0x2d98d5+=_0x1151ee(0x1b9);for(let _0x5cb308=0x0;_0x5cb308<=_0x5bc37e[_0x1151ee(0x27b)][_0x1151ee(0x175)]-0x1;_0x5cb308++){const _0x4fa39=_0x5bc37e[_0x1151ee(0x27b)][_0x5cb308];_0x2d98d5+=_0x1151ee(0x25b)+_0x4fa39+_0x1151ee(0x15e);var _0x59da38=0x0,_0x5294ad=0x0;for(let _0x5b3fe1=0x0;_0x5b3fe1<=_0xb64020[_0x1151ee(0x258)][_0x1151ee(0x175)]-0x1;_0x5b3fe1++){const _0x4af04f=_0xb64020[_0x1151ee(0x258)][_0x5b3fe1];var _0x12191f=0x0;_0x5bc37e['dataqty'][_0x4af04f['_id']['brand']][_0x4af04f[_0x1151ee(0x130)]['category']][_0x4fa39]?(_0x12191f=_0x5bc37e[_0x1151ee(0x225)][_0x4af04f[_0x1151ee(0x130)]['brand']][_0x4af04f[_0x1151ee(0x130)]['category']][_0x4fa39][0x0],_0x2d98d5+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x12191f[_0x1151ee(0xf2)](0x2))+_0x1151ee(0x15e)):(_0x12191f=0x0,_0x2d98d5+='<td\x20class=\x22row_data\x22>'+_0x12191f+_0x1151ee(0x15e)),_0x59da38+=_0x12191f;}_0x2d98d5+=_0x1151ee(0x25b)+formatNumber(_0x59da38[_0x1151ee(0xf2)](0x2))+'</td>';}return _0x2d98d5+=_0x1151ee(0x19e),_0x2d98d5;}router[a0_0x5e81ee(0x1cc)](a0_0x5e81ee(0x1f8),auth,async(_0x1ede29,_0x540643)=>{const _0x158cb7=a0_0x5e81ee,{from_date:_0xd1bc2a,to_date:_0x22335e}=_0x1ede29[_0x158cb7(0x24f)],_0x4dfd61=await agentsdataCheck(_0xd1bc2a,_0x22335e);{}let _0x3ad91d=_0x158cb7(0x268);var _0x51bdfa=new Date(_0xd1bc2a),_0x4fde9e=new Date(_0x22335e);const _0x160c67={'year':'numeric','month':_0x158cb7(0x11c),'day':_0x158cb7(0x174)},_0x34b0e2=new Intl[(_0x158cb7(0x251))]('en-US',_0x160c67)['format'](_0x51bdfa),_0x4cbc3a=new Intl['DateTimeFormat'](_0x158cb7(0x164),_0x160c67)[_0x158cb7(0xee)](_0x4fde9e);_0x3ad91d+=_0x158cb7(0x19b),_0x3ad91d+=_0x158cb7(0x173),_0x3ad91d+=_0x158cb7(0x13a)+_0x34b0e2+_0x158cb7(0x204)+_0x4cbc3a+'</p>',_0x3ad91d+=_0x158cb7(0x1ef),_0x3ad91d+=_0x158cb7(0x271),_0x3ad91d+=_0x158cb7(0x150),_0x3ad91d+=_0x4dfd61,_0x3ad91d+=_0x158cb7(0x1ab),_0x3ad91d+=_0x158cb7(0x1db),_0x3ad91d+=_0x158cb7(0x1db);const _0x1f5ed7={'format':_0x158cb7(0x252),'orientation':'landscape'};pdf[_0x158cb7(0x1cf)](_0x3ad91d,_0x1f5ed7)[_0x158cb7(0x1ce)](function(_0x53c539,_0x19aaf4){const _0x2f7a41=_0x158cb7;if(_0x53c539){_0x540643[_0x2f7a41(0x19d)](0x1f4)[_0x2f7a41(0x156)]('Error\x20generating\x20PDF');return;}_0x540643[_0x2f7a41(0x226)](_0x2f7a41(0x22d),_0x2f7a41(0x167)),_0x19aaf4[_0x2f7a41(0x13b)](_0x540643);});}),router['get'](a0_0x5e81ee(0x114),auth,async(_0x4d3758,_0x4eaf4b)=>{const _0xa034f2=a0_0x5e81ee;try{const {username:_0x173afc,email:_0x4c3246,role:_0x57977f}=_0x4d3758[_0xa034f2(0x26f)],_0x4da283=_0x4d3758[_0xa034f2(0x26f)],_0x442e8a=await profile[_0xa034f2(0x189)]({'email':_0x4da283[_0xa034f2(0x102)]}),_0x40afd2={'year':_0xa034f2(0x174),'month':'long','day':_0xa034f2(0x174)},_0x10e4bc=await master_shop[_0xa034f2(0x183)](),_0x435e49=await staff[_0xa034f2(0x189)]({'email':_0x4da283['email']}),_0x5e07cc=await product[_0xa034f2(0x183)](),_0x311b61=await warehouse['aggregate']([{'$unwind':_0xa034f2(0x213)},{'$lookup':{'from':_0xa034f2(0x1bd),'localField':_0xa034f2(0x20e),'foreignField':'name','as':_0xa034f2(0x16a)}},{'$unwind':_0xa034f2(0x21f)},{'$project':{'product_name':_0xa034f2(0x1f4),'product_stock':_0xa034f2(0x17b)}},{'$group':{'_id':_0xa034f2(0x1fd),'product_stock':{'$sum':_0xa034f2(0xec)}}}]),_0x4fbf62=await staff[_0xa034f2(0x183)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x10e4bc[0x0][_0xa034f2(0x1d7)]==_0xa034f2(0x14a))var _0x1e86b0=users[_0xa034f2(0x1cd)];else{if(_0x10e4bc[0x0][_0xa034f2(0x1d7)]==_0xa034f2(0x12e))var _0x1e86b0=users[_0xa034f2(0x12e)];else{if(_0x10e4bc[0x0][_0xa034f2(0x1d7)]=='German')var _0x1e86b0=users[_0xa034f2(0x1c7)];else{if(_0x10e4bc[0x0][_0xa034f2(0x1d7)]==_0xa034f2(0x1d9))var _0x1e86b0=users[_0xa034f2(0x1d9)];else{if(_0x10e4bc[0x0]['language']==_0xa034f2(0x22f))var _0x1e86b0=users[_0xa034f2(0x22f)];else{if(_0x10e4bc[0x0][_0xa034f2(0x1d7)]==_0xa034f2(0x139))var _0x1e86b0=users[_0xa034f2(0x149)];else{if(_0x10e4bc[0x0]['language']=='Chinese')var _0x1e86b0=users[_0xa034f2(0x148)];else{if(_0x10e4bc[0x0][_0xa034f2(0x1d7)]==_0xa034f2(0xef))var _0x1e86b0=users[_0xa034f2(0x1ed)];}}}}}}}_0x4eaf4b[_0xa034f2(0x18e)](_0xa034f2(0x232),{'success':_0x4d3758[_0xa034f2(0x187)](_0xa034f2(0x1b0)),'errors':_0x4d3758[_0xa034f2(0x187)](_0xa034f2(0x14c)),'alldata':_0x5e07cc,'profile':_0x442e8a,'master_shop':_0x10e4bc,'role':_0x4da283,'product_stock':_0x311b61,'language':_0x1e86b0,'staff_arr':_0x435e49,'staff_data_all':_0x4fbf62});}catch(_0x368fd8){_0x4eaf4b[_0xa034f2(0x241)](_0x368fd8);}});async function agentsdataDSICheck_admin(_0x4cc9f0,_0x48500e,_0x2dda3b,_0x3b753c){const _0xc4e939=a0_0x5e81ee,_0x3f8a7d=await product['aggregate']([{'$group':{'_id':{'brand':_0xc4e939(0x1e1),'category':_0xc4e939(0x170)},'products':{'$push':{'name':_0xc4e939(0x223),'product_code':_0xc4e939(0x1fc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x35227a=[];_0x35227a[_0xc4e939(0x258)]=[];for(let _0x30bc1e=0x0;_0x30bc1e<=_0x3f8a7d[_0xc4e939(0x175)]-0x1;_0x30bc1e++){const _0x2a29c4=_0x3f8a7d[_0x30bc1e];_0x35227a[_0xc4e939(0x258)][_0xc4e939(0x136)](_0x2a29c4);}const _0xcaa1f5=await product[_0xc4e939(0x133)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0xc4e939(0x1e1),'product_code':'$product_code','product_name':_0xc4e939(0x223)}}}},{'$sort':{'_id.category':-0x1}}]),_0x29c342=await product[_0xc4e939(0x133)]([{'$group':{'_id':{'category':'$category','brand':_0xc4e939(0x1e1)}}},{'$group':{'_id':_0xc4e939(0x11d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4b9612=await sales_sa[_0xc4e939(0x133)]([{'$match':{'date':{'$gte':_0x4cc9f0,'$lte':_0x48500e},'sales_staff_id':_0x2dda3b,'sale_product.isFG':_0xc4e939(0x1d0)}},{'$unwind':_0xc4e939(0x21b)},{'$match':{'sale_product.isFG':_0xc4e939(0x1d0)}},{'$lookup':{'from':_0xc4e939(0x1bd),'localField':_0xc4e939(0x247),'foreignField':_0xc4e939(0x17c),'as':_0xc4e939(0x221)}},{'$unwind':_0xc4e939(0x19a)},{'$group':{'_id':{'dsi':_0xc4e939(0x209),'date':_0xc4e939(0x26e),'customer':_0xc4e939(0x116)},'totalQty':{'$sum':_0xc4e939(0x1b5)},'products':{'$push':{'qty':_0xc4e939(0x1b5),'NetPrice':'$sale_product.totalprice','discount':_0xc4e939(0x24a),'adj_discount':_0xc4e939(0x23a),'product_details':{'prod_name':_0xc4e939(0x1ff),'product_code':'$product_info.product_code','category':_0xc4e939(0x24d),'brand':'$product_info.brand','gross_price':_0xc4e939(0x19f)}}}}},{'$unwind':_0xc4e939(0x239)},{'$group':{'_id':{'dsi':_0xc4e939(0x1a8),'date':_0xc4e939(0x1ea),'customer':_0xc4e939(0x121),'category':_0xc4e939(0x13f),'brand':_0xc4e939(0x1d1)},'totalQty':{'$sum':_0xc4e939(0x1dd)},'totalGross':{'$sum':{'$multiply':[_0xc4e939(0x1dd),_0xc4e939(0x1eb)]}},'NetPrice':{'$sum':_0xc4e939(0x23e)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0xc4e939(0x1a8),'date':_0xc4e939(0x1ea),'customer':'$_id.customer'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0xc4e939(0x1c8)},'NetPrice':{'$sum':_0xc4e939(0x1c1)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0xc4e939(0x191)},'products':{'$push':{'qty':_0xc4e939(0x1ae),'category':_0xc4e939(0x11d),'brand':_0xc4e939(0xfe),'product_details':_0xc4e939(0x213)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x8ef934=[],_0x22c697={},_0x16fc95={},_0x7e5111={};var _0xd4fdf4=0x0,_0x15de5f=0x0,_0x4a7750=0x0,_0xc0c13b=0x0,_0x2ea19e=0x0;const _0x22b10c=0x6;for(let _0x529aab=0x0;_0x529aab<=_0x4b9612[_0xc4e939(0x175)]-0x1;_0x529aab++){const _0xb84584=_0x4b9612[_0x529aab];let _0x5e553b=_0xc4e939(0x1b9);_0x5e553b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xb84584[_0xc4e939(0x130)]['dsi']+'</td>',_0x5e553b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xb84584[_0xc4e939(0x130)][_0xc4e939(0x250)]+_0xc4e939(0x15e),_0x5e553b+=_0xc4e939(0x18f)+_0xb84584[_0xc4e939(0x130)]['customer']+'</td>';let _0x208629={};var _0x3b9d06=0x0;for(let _0x501cd7=0x0;_0x501cd7<=_0xb84584[_0xc4e939(0x1bd)][_0xc4e939(0x175)]-0x1;_0x501cd7++){const _0x4c07e9=_0xb84584[_0xc4e939(0x1bd)][_0x501cd7];_0x208629[_0x4c07e9[_0xc4e939(0x20a)]+'-'+_0x4c07e9[_0xc4e939(0x25e)]]=_0x4c07e9['qty'];const _0x59d072=_0x4c07e9[_0xc4e939(0x20a)]+'-'+_0x4c07e9[_0xc4e939(0x25e)];!_0x22c697[_0x59d072]&&(_0x22c697[_0x59d072]=0x0),!Array[_0xc4e939(0x1ac)](_0x7e5111[_0x59d072])&&(_0x7e5111[_0x59d072]=[]),!Array[_0xc4e939(0x1ac)](_0x7e5111[_0x59d072])&&(_0x7e5111[_0x59d072]=[]),_0x22c697[_0x59d072]+=_0x4c07e9[_0xc4e939(0x23c)],_0x7e5111[_0x59d072][_0xc4e939(0x136)](_0x4c07e9[_0xc4e939(0x23c)]),_0x3b9d06++;}console[_0xc4e939(0x127)](_0xb84584);for(let _0x10f489=0x0;_0x10f489<=_0x35227a[_0xc4e939(0x258)]['length']-0x1;_0x10f489++){const _0x2262aa=_0x35227a[_0xc4e939(0x258)][_0x10f489],_0xb038bf=_0x2262aa[_0xc4e939(0x130)]['brand']+'-'+_0x2262aa['_id'][_0xc4e939(0x25e)];_0x5e553b+=_0xc4e939(0x11a)+(_0x208629[_0xb038bf]!==undefined?_0x208629[_0xb038bf][_0xc4e939(0xf2)](0x2):'')+'</td>';}_0x4a7750=_0xb84584['discount']+_0xb84584['adj_discount'],_0x5e553b+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0xb84584[_0xc4e939(0x185)],0x2)[_0xc4e939(0xf2)](0x2))+_0xc4e939(0x15e),_0x5e553b+=_0xc4e939(0x1b8)+formatNumber(_0xb84584[_0xc4e939(0x20f)][_0xc4e939(0xf2)](0x2))+_0xc4e939(0x15e),_0x5e553b+=_0xc4e939(0x1b8)+formatNumber(_0x4a7750)+'</td>',_0x5e553b+=_0xc4e939(0x1b8)+formatNumber(_0xb84584['NetPrice']['toFixed'](0x2))+'</td>',_0x5e553b+=_0xc4e939(0x19e),_0xd4fdf4+=parseFloat(_0xb84584[_0xc4e939(0x185)]['toFixed'](0x2)),_0x15de5f+=parseFloat(_0xb84584[_0xc4e939(0x153)][_0xc4e939(0xf2)](0x2)),_0xc0c13b+=_0x4a7750,_0x2ea19e+=parseFloat(_0xb84584['totalGross'][_0xc4e939(0xf2)](0x2));if(_0x529aab==_0x4b9612[_0xc4e939(0x175)]-0x1){_0x5e553b+='<tr>',_0x5e553b+=_0xc4e939(0x11e),_0x5e553b+=_0xc4e939(0x15e);for(let _0x11d73e=0x0;_0x11d73e<=_0x35227a[_0xc4e939(0x258)][_0xc4e939(0x175)]-0x1;_0x11d73e++){const _0x14fb4a=_0x35227a[_0xc4e939(0x258)][_0x11d73e],_0x31d660=_0x14fb4a[_0xc4e939(0x130)][_0xc4e939(0x20a)]+'-'+_0x14fb4a['_id']['category'],_0x1c0c48=_0x7e5111[_0x31d660][_0xc4e939(0x14d)]((_0x5ce7b1,_0x5042b0)=>_0x5ce7b1+_0x5042b0,0x0);console[_0xc4e939(0x127)](_0xc4e939(0x152),_0x31d660),_0x5e553b+=_0xc4e939(0x12c)+(_0x1c0c48!==undefined?formatNumber(_0x1c0c48[_0xc4e939(0xf2)](0x2)):'')+_0xc4e939(0x21e),console['log'](_0x7e5111[_0x31d660][_0xc4e939(0x14d)]((_0x32234c,_0x1bd1ea)=>_0x32234c+_0x1bd1ea,0x0));}_0x5e553b+=_0xc4e939(0x15f)+formatNumber(_0xd4fdf4[_0xc4e939(0xf2)](0x2))+_0xc4e939(0x21e),_0x5e553b+=_0xc4e939(0x15f)+formatNumber(_0x2ea19e)+'</b></td>',_0x5e553b+=_0xc4e939(0x15f)+formatNumber(_0xc0c13b)+_0xc4e939(0x21e),_0x5e553b+=_0xc4e939(0x15f)+formatNumber(_0x15de5f)+_0xc4e939(0x21e),_0x5e553b+=_0xc4e939(0x19e);}_0x8ef934['push'](_0x5e553b);}function _0x312575(_0x37360f,_0x1b0116){const _0x59cb66=_0xc4e939,_0x2bc584=[];for(let _0xda70af=0x0;_0xda70af<=_0x37360f[_0x59cb66(0x175)]-0x1;_0xda70af+=_0x1b0116){_0x2bc584[_0x59cb66(0x136)](_0x37360f[_0x59cb66(0x163)](_0xda70af,_0xda70af+_0x1b0116));}return _0x2bc584;}const _0x49fed0=_0x312575(_0x8ef934,_0x22b10c);let _0x3cf234='';return _0x49fed0[_0xc4e939(0x1f1)]((_0x2e1253,_0x1897d3)=>{const _0x34828c=_0xc4e939;_0x1897d3>0x0&&(_0x3cf234+=_0x34828c(0x160));_0x3cf234+='<table>',_0x3cf234+=_0x34828c(0x227),_0x3cf234+='<tr>',_0x3cf234+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x3cf234+=_0x34828c(0x19e),_0x3cf234+=_0x34828c(0x1b9),_0x3cf234+=_0x34828c(0x23f);for(let _0x273d92=0x0;_0x273d92<=_0xcaa1f5[_0x34828c(0x175)]-0x1;_0x273d92++){const _0x590343=_0xcaa1f5[_0x273d92];for(let _0x4f5c4b=0x0;_0x4f5c4b<_0x29c342['length'];_0x4f5c4b++){const _0x4075cf=_0x29c342[_0x4f5c4b];_0x4075cf[_0x34828c(0x130)]===_0x590343[_0x34828c(0x130)][_0x34828c(0x25e)]&&(_0x3cf234+='<td\x20colspan=\x22'+_0x4075cf[_0x34828c(0x210)]+_0x34828c(0x203)+_0x590343[_0x34828c(0x130)]['category']+_0x34828c(0x15e));}}_0x3cf234+=_0x34828c(0x207),_0x3cf234+=_0x34828c(0x19e),_0x3cf234+=_0x34828c(0x1b9),_0x3cf234+=_0x34828c(0x158),_0x3cf234+=_0x34828c(0x16c),_0x3cf234+=_0x34828c(0x16e);for(let _0x3d3a56=0x0;_0x3d3a56<=_0xcaa1f5[_0x34828c(0x175)]-0x1;_0x3d3a56++){const _0x4b35bf=_0xcaa1f5[_0x3d3a56];for(let _0x18dfda=0x0;_0x18dfda<_0x35227a[_0x34828c(0x258)][_0x34828c(0x175)];_0x18dfda++){const _0x46b67f=_0x35227a[_0x34828c(0x258)][_0x18dfda];_0x46b67f['_id'][_0x34828c(0x25e)]===_0x4b35bf[_0x34828c(0x130)][_0x34828c(0x25e)]&&(_0x3cf234+=_0x34828c(0x262)+_0x46b67f['_id']['brand']+'</td>');}}_0x3cf234+=_0x34828c(0x1aa),_0x3cf234+=_0x34828c(0x21d),_0x3cf234+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x3cf234+=_0x34828c(0x106),_0x3cf234+=_0x34828c(0x19e),_0x3cf234+='</thead>',_0x3cf234+=_0x34828c(0x253),_0x2e1253['forEach'](_0x1ff61e=>{_0x3cf234+=_0x1ff61e;}),console[_0x34828c(0x127)](_0x7e5111),_0x3cf234+=_0x34828c(0x1b2),_0x3cf234+=_0x34828c(0x1ab);}),_0x3cf234;}async function agentsdataDSICheck_admin_excel(_0x1c28ca,_0x5abbdf,_0x2bfe8c,_0x5717ac){const _0x2c5aee=a0_0x5e81ee,_0x4abeb7=await product[_0x2c5aee(0x133)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x331ce8=[];_0x331ce8[_0x2c5aee(0x258)]=[];for(let _0x2c7e60=0x0;_0x2c7e60<=_0x4abeb7['length']-0x1;_0x2c7e60++){const _0x24a969=_0x4abeb7[_0x2c7e60];_0x331ce8[_0x2c5aee(0x258)]['push'](_0x24a969);}const _0x1c55b2=await product[_0x2c5aee(0x133)]([{'$group':{'_id':{'category':_0x2c5aee(0x170)},'products':{'$push':{'brand':_0x2c5aee(0x1e1),'product_code':_0x2c5aee(0x1fc),'product_name':_0x2c5aee(0x223)}}}},{'$sort':{'_id.category':-0x1}}]),_0x23caae=await product[_0x2c5aee(0x133)]([{'$group':{'_id':{'category':_0x2c5aee(0x170),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2bdb81=await sales_sa[_0x2c5aee(0x133)]([{'$match':{'date':{'$gte':_0x1c28ca,'$lte':_0x5abbdf},'sales_staff_id':_0x2bfe8c,'sale_product.isFG':_0x2c5aee(0x1d0)}},{'$unwind':_0x2c5aee(0x21b)},{'$match':{'sale_product.isFG':_0x2c5aee(0x1d0)}},{'$lookup':{'from':_0x2c5aee(0x1bd),'localField':_0x2c5aee(0x247),'foreignField':_0x2c5aee(0x17c),'as':_0x2c5aee(0x221)}},{'$unwind':_0x2c5aee(0x19a)},{'$group':{'_id':{'dsi':_0x2c5aee(0x209),'date':'$date','customer':_0x2c5aee(0x116)},'totalQty':{'$sum':_0x2c5aee(0x1b5)},'products':{'$push':{'qty':_0x2c5aee(0x1b5),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0x2c5aee(0x23a),'product_details':{'prod_name':'$product_info.name','product_code':_0x2c5aee(0x228),'category':_0x2c5aee(0x24d),'brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x2c5aee(0x239)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x2c5aee(0x1ea),'customer':_0x2c5aee(0x121),'category':_0x2c5aee(0x13f),'brand':_0x2c5aee(0x1d1)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x2c5aee(0x1dd),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x2c5aee(0x194)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x2c5aee(0x125)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x2c5aee(0x1c8)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x2c5aee(0xf1)},'adj_discount':{'$sum':_0x2c5aee(0x191)},'products':{'$push':{'qty':_0x2c5aee(0x1ae),'category':'$_id.category','brand':_0x2c5aee(0xfe),'product_details':_0x2c5aee(0x213)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x238ea5=[],_0x3e465e={},_0x2693bd={},_0x55e329={};var _0x540cf7=0x0,_0x3ce77a=0x0,_0x2ffd53=0x0,_0x545dc7=0x0,_0x51fb94=0x0;const _0x4bb802=0x16345785d8a0000;for(let _0x221474=0x0;_0x221474<=_0x2bdb81[_0x2c5aee(0x175)]-0x1;_0x221474++){const _0x1e6764=_0x2bdb81[_0x221474];let _0x5c7e0b=_0x2c5aee(0x1b9);_0x5c7e0b+=_0x2c5aee(0x18f)+_0x1e6764[_0x2c5aee(0x130)][_0x2c5aee(0x25d)]+_0x2c5aee(0x15e),_0x5c7e0b+=_0x2c5aee(0x18f)+_0x1e6764[_0x2c5aee(0x130)][_0x2c5aee(0x250)]+_0x2c5aee(0x15e),_0x5c7e0b+=_0x2c5aee(0x18f)+_0x1e6764[_0x2c5aee(0x130)][_0x2c5aee(0x1ec)]+'</td>';let _0x53e2c2={};var _0x480abd=0x0;for(let _0x54d83e=0x0;_0x54d83e<=_0x1e6764[_0x2c5aee(0x1bd)][_0x2c5aee(0x175)]-0x1;_0x54d83e++){const _0x1b9fd4=_0x1e6764[_0x2c5aee(0x1bd)][_0x54d83e];_0x53e2c2[_0x1b9fd4[_0x2c5aee(0x20a)]+'-'+_0x1b9fd4[_0x2c5aee(0x25e)]]=_0x1b9fd4[_0x2c5aee(0x23c)];const _0x3e6144=_0x1b9fd4[_0x2c5aee(0x20a)]+'-'+_0x1b9fd4[_0x2c5aee(0x25e)];!_0x3e465e[_0x3e6144]&&(_0x3e465e[_0x3e6144]=0x0),!Array[_0x2c5aee(0x1ac)](_0x55e329[_0x3e6144])&&(_0x55e329[_0x3e6144]=[]),!Array[_0x2c5aee(0x1ac)](_0x55e329[_0x3e6144])&&(_0x55e329[_0x3e6144]=[]),_0x3e465e[_0x3e6144]+=_0x1b9fd4[_0x2c5aee(0x23c)],_0x55e329[_0x3e6144][_0x2c5aee(0x136)](_0x1b9fd4[_0x2c5aee(0x23c)]),_0x480abd++;}console[_0x2c5aee(0x127)](_0x1e6764);for(let _0x4d68fa=0x0;_0x4d68fa<=_0x331ce8[_0x2c5aee(0x258)][_0x2c5aee(0x175)]-0x1;_0x4d68fa++){const _0x1d956f=_0x331ce8['cat_brand'][_0x4d68fa],_0x1e4366=_0x1d956f['_id']['brand']+'-'+_0x1d956f[_0x2c5aee(0x130)][_0x2c5aee(0x25e)];_0x5c7e0b+=_0x2c5aee(0x11a)+(_0x53e2c2[_0x1e4366]!==undefined?_0x53e2c2[_0x1e4366]['toFixed'](0x2):'')+'</td>';}_0x2ffd53=_0x1e6764['discount']+_0x1e6764[_0x2c5aee(0x23d)],_0x5c7e0b+=_0x2c5aee(0x1b8)+formatNumber(parseFloat(_0x1e6764[_0x2c5aee(0x185)],0x2)[_0x2c5aee(0xf2)](0x2))+_0x2c5aee(0x15e),_0x5c7e0b+=_0x2c5aee(0x1b8)+formatNumber(_0x1e6764[_0x2c5aee(0x20f)][_0x2c5aee(0xf2)](0x2))+_0x2c5aee(0x15e),_0x5c7e0b+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x2ffd53)+_0x2c5aee(0x15e),_0x5c7e0b+=_0x2c5aee(0x1b8)+formatNumber(_0x1e6764[_0x2c5aee(0x153)][_0x2c5aee(0xf2)](0x2))+_0x2c5aee(0x15e),_0x5c7e0b+=_0x2c5aee(0x19e),_0x540cf7+=parseFloat(_0x1e6764['totalQty']['toFixed'](0x2)),_0x3ce77a+=parseFloat(_0x1e6764['NetPrice'][_0x2c5aee(0xf2)](0x2)),_0x545dc7+=_0x2ffd53,_0x51fb94+=parseFloat(_0x1e6764[_0x2c5aee(0x20f)][_0x2c5aee(0xf2)](0x2));if(_0x221474==_0x2bdb81[_0x2c5aee(0x175)]-0x1){_0x5c7e0b+=_0x2c5aee(0x1b9),_0x5c7e0b+=_0x2c5aee(0x11e),_0x5c7e0b+='</td>';for(let _0x48f498=0x0;_0x48f498<=_0x331ce8['cat_brand'][_0x2c5aee(0x175)]-0x1;_0x48f498++){const _0x2008a6=_0x331ce8[_0x2c5aee(0x258)][_0x48f498],_0x2351db=_0x2008a6[_0x2c5aee(0x130)][_0x2c5aee(0x20a)]+'-'+_0x2008a6['_id'][_0x2c5aee(0x25e)],_0x35d7a7=_0x55e329[_0x2351db][_0x2c5aee(0x14d)]((_0x4ca7b1,_0x441f3a)=>_0x4ca7b1+_0x441f3a,0x0);console[_0x2c5aee(0x127)](_0x2c5aee(0x152),_0x2351db),_0x5c7e0b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x35d7a7!==undefined?formatNumber(_0x35d7a7[_0x2c5aee(0xf2)](0x2)):'')+'</b></td>',console[_0x2c5aee(0x127)](_0x55e329[_0x2351db][_0x2c5aee(0x14d)]((_0x23008c,_0x3b7343)=>_0x23008c+_0x3b7343,0x0));}_0x5c7e0b+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x540cf7[_0x2c5aee(0xf2)](0x2))+_0x2c5aee(0x21e),_0x5c7e0b+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x51fb94)+_0x2c5aee(0x21e),_0x5c7e0b+=_0x2c5aee(0x15f)+formatNumber(_0x545dc7)+_0x2c5aee(0x21e),_0x5c7e0b+=_0x2c5aee(0x15f)+formatNumber(_0x3ce77a)+_0x2c5aee(0x21e),_0x5c7e0b+='</tr>';}_0x238ea5[_0x2c5aee(0x136)](_0x5c7e0b);}function _0x373759(_0x2649f1,_0x26c890){const _0x4ac640=_0x2c5aee,_0x22db62=[];for(let _0x18559a=0x0;_0x18559a<=_0x2649f1[_0x4ac640(0x175)]-0x1;_0x18559a+=_0x26c890){_0x22db62[_0x4ac640(0x136)](_0x2649f1[_0x4ac640(0x163)](_0x18559a,_0x18559a+_0x26c890));}return _0x22db62;}const _0x4d2093=_0x373759(_0x238ea5,_0x4bb802);let _0x7a6bd4='';return _0x4d2093[_0x2c5aee(0x1f1)]((_0x30b8a4,_0x506bbd)=>{const _0x26f64b=_0x2c5aee;_0x506bbd>0x0&&(_0x7a6bd4+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x7a6bd4+=_0x26f64b(0x150),_0x7a6bd4+=_0x26f64b(0x227),_0x7a6bd4+=_0x26f64b(0x1b9),_0x7a6bd4+=_0x26f64b(0xf5),_0x7a6bd4+=_0x26f64b(0x19e),_0x7a6bd4+=_0x26f64b(0x1b9),_0x7a6bd4+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x4a253a=0x0;_0x4a253a<=_0x1c55b2[_0x26f64b(0x175)]-0x1;_0x4a253a++){const _0x1a57fd=_0x1c55b2[_0x4a253a];for(let _0x4cca3e=0x0;_0x4cca3e<_0x23caae['length'];_0x4cca3e++){const _0x5d0a31=_0x23caae[_0x4cca3e];_0x5d0a31['_id']===_0x1a57fd[_0x26f64b(0x130)][_0x26f64b(0x25e)]&&(_0x7a6bd4+=_0x26f64b(0x12d)+_0x5d0a31[_0x26f64b(0x210)]+_0x26f64b(0x203)+_0x1a57fd[_0x26f64b(0x130)]['category']+_0x26f64b(0x15e));}}_0x7a6bd4+=_0x26f64b(0x207),_0x7a6bd4+=_0x26f64b(0x19e),_0x7a6bd4+=_0x26f64b(0x1b9),_0x7a6bd4+=_0x26f64b(0x158),_0x7a6bd4+=_0x26f64b(0x16c),_0x7a6bd4+=_0x26f64b(0x16e);for(let _0x4a4e1a=0x0;_0x4a4e1a<=_0x1c55b2[_0x26f64b(0x175)]-0x1;_0x4a4e1a++){const _0x10f2b7=_0x1c55b2[_0x4a4e1a];for(let _0x559479=0x0;_0x559479<_0x331ce8[_0x26f64b(0x258)]['length'];_0x559479++){const _0x1cbe62=_0x331ce8[_0x26f64b(0x258)][_0x559479];_0x1cbe62['_id'][_0x26f64b(0x25e)]===_0x10f2b7[_0x26f64b(0x130)]['category']&&(_0x7a6bd4+=_0x26f64b(0x262)+_0x1cbe62[_0x26f64b(0x130)][_0x26f64b(0x20a)]+_0x26f64b(0x15e));}}_0x7a6bd4+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x7a6bd4+=_0x26f64b(0x21d),_0x7a6bd4+=_0x26f64b(0x238),_0x7a6bd4+=_0x26f64b(0x106),_0x7a6bd4+=_0x26f64b(0x19e),_0x7a6bd4+=_0x26f64b(0x181),_0x7a6bd4+=_0x26f64b(0x253),_0x30b8a4[_0x26f64b(0x1f1)](_0x52d519=>{_0x7a6bd4+=_0x52d519;}),console[_0x26f64b(0x127)](_0x55e329),_0x7a6bd4+=_0x26f64b(0x1b2),_0x7a6bd4+=_0x26f64b(0x1ab);}),_0x7a6bd4;}router[a0_0x5e81ee(0x1cc)](a0_0x5e81ee(0x165),auth,async(_0x4cde51,_0x1b76bb)=>{const _0xdce82b=a0_0x5e81ee,{from_date:_0xa8485c,to_date:_0x5f4a27,isExcel:_0x4b02da,agent_id:_0x4fada5}=_0x4cde51[_0xdce82b(0x24f)],_0x11eefd=_0x4cde51[_0xdce82b(0x26f)],_0x25401f=await staff['findOne']({'email':_0x11eefd[_0xdce82b(0x102)]}),_0x49e574=await master_shop[_0xdce82b(0x183)](),_0x1d23a2=await agentsdataDSICheck_admin(_0xa8485c,_0x5f4a27,_0x4fada5,_0x4b02da),_0x2e5580=await agentsdataDSICheck_admin_excel(_0xa8485c,_0x5f4a27,_0x4fada5,_0x4b02da);let _0x46537f=_0xdce82b(0x233);var _0x384dbb=new Date(_0xa8485c),_0x3fded0=new Date(_0x5f4a27);const _0x5af7d2={'year':_0xdce82b(0x174),'month':_0xdce82b(0x11c),'day':'numeric'},_0x203880=new Intl['DateTimeFormat'](_0xdce82b(0x164),_0x5af7d2)[_0xdce82b(0xee)](_0x384dbb),_0xbe5d26=new Intl[(_0xdce82b(0x251))]('en-US',_0x5af7d2)[_0xdce82b(0xee)](_0x3fded0);_0x46537f+='<div\x20class=\x22row\x22>',_0x46537f+=_0xdce82b(0x12b),_0x46537f+='<table>',_0x46537f+=_0x1d23a2,_0x46537f+=_0xdce82b(0x1ab),_0x46537f+=_0xdce82b(0x1db),_0x46537f+=_0xdce82b(0x1db);let _0x335212=_0xdce82b(0x233);_0x335212+=_0xdce82b(0x1ef),_0x335212+='<div\x20\x20id=\x22table-conatainer\x22>',_0x335212+=_0xdce82b(0x150),_0x335212+=_0x2e5580,_0x335212+=_0xdce82b(0x1ab),_0x335212+='</div>',_0x335212+=_0xdce82b(0x1db);let _0x46edea=_0xdce82b(0x13c);const _0x3264d5={'width':_0xdce82b(0x278),'height':'8.5in','orientation':_0xdce82b(0x279),'border':{'top':_0xdce82b(0x1e5),'right':'0.1in','bottom':_0xdce82b(0x1e5),'left':'0.1in'},'header':{'height':_0xdce82b(0x22a),'contents':_0xdce82b(0x19c)+_0x46edea+_0xdce82b(0x217)+_0x203880+'\x20-\x20'+_0xbe5d26+_0xdce82b(0xfc)},'footer':{'height':_0xdce82b(0x1c0),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x4b02da=='on'){const _0xb6c0a3=cheerio[_0xdce82b(0x26c)](_0x335212);let _0x5f3edf=[],_0x5f3651=[],_0x55ed94=[];_0xb6c0a3(_0xdce82b(0x17a))[_0xdce82b(0x219)]((_0x55bf75,_0x4fd978)=>{const _0x5ae638=_0xdce82b;let _0x911392=[],_0x2bfa2d=0x0;while(_0x55ed94[_0x2bfa2d]){_0x55ed94[_0x2bfa2d]--,_0x2bfa2d++;}_0xb6c0a3(_0x4fd978)['find']('td,\x20th')[_0x5ae638(0x219)]((_0x25a38a,_0x3f6863)=>{const _0xa4d268=_0x5ae638;let _0xf43f14=_0xb6c0a3(_0x3f6863)[_0xa4d268(0x21a)]()[_0xa4d268(0x1a1)](),_0x83aba7=parseFloat(_0xf43f14[_0xa4d268(0x108)](/,/g,''));isNaN(_0x83aba7)&&(_0x83aba7=_0xf43f14);let _0x155f3f=parseInt(_0xb6c0a3(_0x3f6863)[_0xa4d268(0x1b4)](_0xa4d268(0x211)))||0x1,_0x25d970=parseInt(_0xb6c0a3(_0x3f6863)[_0xa4d268(0x1b4)](_0xa4d268(0x15d)))||0x1;_0x911392[_0x2bfa2d]=_0x83aba7;(_0x155f3f>0x1||_0x25d970>0x1)&&_0x5f3651[_0xa4d268(0x136)]({'s':{'r':_0x55bf75,'c':_0x2bfa2d},'e':{'r':_0x55bf75+_0x25d970-0x1,'c':_0x2bfa2d+_0x155f3f-0x1}});for(let _0x2b2431=0x0;_0x2b2431<_0x155f3f;_0x2b2431++){_0x25d970>0x1&&(_0x55ed94[_0x2bfa2d+_0x2b2431]=_0x25d970-0x1);}_0x2bfa2d+=_0x155f3f;}),_0x5f3edf['push'](_0x911392);});const _0x4a3f1=XLSX['utils'][_0xdce82b(0x1c4)](),_0x2f5fa5=XLSX['utils'][_0xdce82b(0x20d)](_0x5f3edf);_0x5f3651[_0xdce82b(0x175)]>0x0&&(_0x2f5fa5[_0xdce82b(0x1e7)]=_0x5f3651);_0x2f5fa5[_0xdce82b(0x123)]=_0x5f3edf[0x0][_0xdce82b(0x10a)](()=>({'wpx':0x64})),XLSX[_0xdce82b(0x1ad)][_0xdce82b(0x1af)](_0x4a3f1,_0x2f5fa5,'Sales\x20Report');const _0x4a965d=XLSX[_0xdce82b(0xed)](_0x4a3f1,{'bookType':'xlsx','type':_0xdce82b(0x24c)});_0x1b76bb[_0xdce82b(0x226)]('Content-Disposition',_0xdce82b(0x182)),_0x1b76bb['setHeader'](_0xdce82b(0x22d),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x1b76bb['send'](_0x4a965d);}else pdf[_0xdce82b(0x1cf)](_0x46537f,_0x3264d5)[_0xdce82b(0x1ce)](function(_0x35b644,_0xdd8c65){const _0x167a53=_0xdce82b;if(_0x35b644){_0x1b76bb[_0x167a53(0x19d)](0x1f4)[_0x167a53(0x156)]('Error\x20generating\x20PDF');return;}_0x1b76bb['setHeader'](_0x167a53(0x22d),'application/pdf'),_0xdd8c65[_0x167a53(0x13b)](_0x1b76bb);});}),router['get']('/agent_reports/view',auth,async(_0x5e0d99,_0x56ee81)=>{const _0x245599=a0_0x5e81ee;try{const {username:_0x16e9b8,email:_0x1f38d9,role:_0x5525f5}=_0x5e0d99[_0x245599(0x26f)],_0x1b2104=_0x5e0d99[_0x245599(0x26f)],_0x1bb8d1=await profile[_0x245599(0x189)]({'email':_0x1b2104[_0x245599(0x102)]}),_0x33c601={'year':_0x245599(0x174),'month':_0x245599(0x11c),'day':_0x245599(0x174)},_0x4c194=await master_shop[_0x245599(0x183)](),_0x3596f0=await staff['findOne']({'email':_0x1b2104[_0x245599(0x102)]}),_0x4843f0=await product[_0x245599(0x183)](),_0x36bdb7=await warehouse[_0x245599(0x133)]([{'$unwind':_0x245599(0x213)},{'$lookup':{'from':_0x245599(0x1bd),'localField':_0x245599(0x20e),'foreignField':_0x245599(0x27b),'as':'product_docs'}},{'$unwind':_0x245599(0x21f)},{'$project':{'product_name':_0x245599(0x1f4),'product_stock':_0x245599(0x17b)}},{'$group':{'_id':_0x245599(0x1fd),'product_stock':{'$sum':_0x245599(0xec)}}}]);if(_0x4c194[0x0][_0x245599(0x1d7)]=='English\x20(US)')var _0x1d86d9=users[_0x245599(0x1cd)];else{if(_0x4c194[0x0][_0x245599(0x1d7)]=='Hindi')var _0x1d86d9=users['Hindi'];else{if(_0x4c194[0x0]['language']==_0x245599(0x1c7))var _0x1d86d9=users[_0x245599(0x1c7)];else{if(_0x4c194[0x0][_0x245599(0x1d7)]==_0x245599(0x1d9))var _0x1d86d9=users[_0x245599(0x1d9)];else{if(_0x4c194[0x0][_0x245599(0x1d7)]=='French')var _0x1d86d9=users[_0x245599(0x22f)];else{if(_0x4c194[0x0][_0x245599(0x1d7)]==_0x245599(0x139))var _0x1d86d9=users['Portuguese'];else{if(_0x4c194[0x0]['language']=='Chinese')var _0x1d86d9=users[_0x245599(0x148)];else{if(_0x4c194[0x0][_0x245599(0x1d7)]==_0x245599(0xef))var _0x1d86d9=users[_0x245599(0x1ed)];}}}}}}}_0x56ee81[_0x245599(0x18e)](_0x245599(0x126),{'success':_0x5e0d99[_0x245599(0x187)]('success'),'errors':_0x5e0d99[_0x245599(0x187)](_0x245599(0x14c)),'alldata':_0x4843f0,'profile':_0x1bb8d1,'master_shop':_0x4c194,'role':_0x1b2104,'product_stock':_0x36bdb7,'language':_0x1d86d9,'staff_arr':_0x3596f0});}catch(_0x24643e){}});function formatNumber(_0x459297,_0x3d482c=a0_0x5e81ee(0x164),_0xfb1e99={'minimumFractionDigits':0x2}){const _0x27c0dc=a0_0x5e81ee,_0x2ba656=new Intl[(_0x27c0dc(0x236))](_0x3d482c,_0xfb1e99);return _0x2ba656[_0x27c0dc(0xee)](_0x459297);}async function agentsdataDSICheck(_0x716454,_0x29557b,_0x5cd0f0,_0x10f0eb){const _0x1edbc8=a0_0x5e81ee,_0x1d1eab=await product['aggregate']([{'$group':{'_id':{'brand':_0x1edbc8(0x1e1),'category':'$category'},'products':{'$push':{'name':_0x1edbc8(0x223),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x42c790=[];_0x42c790[_0x1edbc8(0x258)]=[];for(let _0x3ef9b5=0x0;_0x3ef9b5<=_0x1d1eab[_0x1edbc8(0x175)]-0x1;_0x3ef9b5++){const _0x56b0c8=_0x1d1eab[_0x3ef9b5];_0x42c790['cat_brand'][_0x1edbc8(0x136)](_0x56b0c8);}const _0x237d26=await product[_0x1edbc8(0x133)]([{'$group':{'_id':{'category':_0x1edbc8(0x170)},'products':{'$push':{'brand':_0x1edbc8(0x1e1),'product_code':_0x1edbc8(0x1fc),'product_name':_0x1edbc8(0x223)}}}},{'$sort':{'_id.category':-0x1}}]),_0x10be06=await product[_0x1edbc8(0x133)]([{'$group':{'_id':{'category':_0x1edbc8(0x170),'brand':_0x1edbc8(0x1e1)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x46c77c=await sales_sa[_0x1edbc8(0x133)]([{'$match':{'date':{'$gte':_0x716454,'$lte':_0x29557b},'sales_staff_id':_0x5cd0f0,'sale_product.isFG':_0x1edbc8(0x1d0)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x1edbc8(0x1d0)}},{'$lookup':{'from':'products','localField':_0x1edbc8(0x247),'foreignField':_0x1edbc8(0x17c),'as':'product_info'}},{'$unwind':_0x1edbc8(0x19a)},{'$group':{'_id':{'dsi':'$dsi','date':_0x1edbc8(0x26e),'customer':'$customer'},'totalQty':{'$sum':_0x1edbc8(0x1b5)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x1edbc8(0x10f),'discount':_0x1edbc8(0x24a),'adj_discount':_0x1edbc8(0x23a),'product_details':{'prod_name':_0x1edbc8(0x1ff),'product_code':'$product_info.product_code','category':_0x1edbc8(0x24d),'brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x1edbc8(0x239)},{'$group':{'_id':{'dsi':_0x1edbc8(0x1a8),'date':_0x1edbc8(0x1ea),'customer':_0x1edbc8(0x121),'category':_0x1edbc8(0x13f),'brand':_0x1edbc8(0x1d1)},'totalQty':{'$sum':_0x1edbc8(0x1dd)},'totalGross':{'$sum':{'$multiply':[_0x1edbc8(0x1dd),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x1edbc8(0x23e)},'discount':{'$sum':_0x1edbc8(0x194)},'adj_discount':{'$sum':_0x1edbc8(0x16d)},'product_details':{'$first':_0x1edbc8(0x125)}}},{'$group':{'_id':{'dsi':_0x1edbc8(0x1a8),'date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':_0x1edbc8(0x1ae)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x1edbc8(0x1c1)},'discount':{'$sum':_0x1edbc8(0xf1)},'adj_discount':{'$sum':_0x1edbc8(0x191)},'products':{'$push':{'qty':_0x1edbc8(0x1ae),'category':_0x1edbc8(0x11d),'brand':_0x1edbc8(0xfe),'product_details':_0x1edbc8(0x213)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x290fd0=[],_0x5a0671={},_0x55a365={},_0x3970eb={};var _0x494430=0x0,_0x55078b=0x0,_0x3e645c=0x0,_0x470dfc=0x0,_0x4bf2f5=0x0;const _0x3ad150=0x6;for(let _0x3705df=0x0;_0x3705df<=_0x46c77c[_0x1edbc8(0x175)]-0x1;_0x3705df++){const _0x51353c=_0x46c77c[_0x3705df];let _0x2e08fc=_0x1edbc8(0x1b9);_0x2e08fc+=_0x1edbc8(0x18f)+_0x51353c[_0x1edbc8(0x130)]['dsi']+'</td>',_0x2e08fc+=_0x1edbc8(0x18f)+_0x51353c[_0x1edbc8(0x130)][_0x1edbc8(0x250)]+_0x1edbc8(0x15e),_0x2e08fc+=_0x1edbc8(0x18f)+_0x51353c['_id'][_0x1edbc8(0x1ec)]+_0x1edbc8(0x15e);let _0x2336d1={};var _0x37033d=0x0;for(let _0x90bd73=0x0;_0x90bd73<=_0x51353c[_0x1edbc8(0x1bd)][_0x1edbc8(0x175)]-0x1;_0x90bd73++){const _0x5ec1fa=_0x51353c[_0x1edbc8(0x1bd)][_0x90bd73];_0x2336d1[_0x5ec1fa[_0x1edbc8(0x20a)]+'-'+_0x5ec1fa[_0x1edbc8(0x25e)]]=_0x5ec1fa[_0x1edbc8(0x23c)];const _0x2eb09b=_0x5ec1fa['brand']+'-'+_0x5ec1fa['category'];!_0x5a0671[_0x2eb09b]&&(_0x5a0671[_0x2eb09b]=0x0),!Array['isArray'](_0x3970eb[_0x2eb09b])&&(_0x3970eb[_0x2eb09b]=[]),!Array['isArray'](_0x3970eb[_0x2eb09b])&&(_0x3970eb[_0x2eb09b]=[]),_0x5a0671[_0x2eb09b]+=_0x5ec1fa[_0x1edbc8(0x23c)],_0x3970eb[_0x2eb09b][_0x1edbc8(0x136)](_0x5ec1fa[_0x1edbc8(0x23c)]),_0x37033d++;}console[_0x1edbc8(0x127)](_0x51353c);for(let _0x371086=0x0;_0x371086<=_0x42c790[_0x1edbc8(0x258)][_0x1edbc8(0x175)]-0x1;_0x371086++){const _0x17cfd2=_0x42c790[_0x1edbc8(0x258)][_0x371086],_0x362b79=_0x17cfd2[_0x1edbc8(0x130)][_0x1edbc8(0x20a)]+'-'+_0x17cfd2[_0x1edbc8(0x130)][_0x1edbc8(0x25e)];_0x2e08fc+=_0x1edbc8(0x11a)+(_0x2336d1[_0x362b79]!==undefined?_0x2336d1[_0x362b79][_0x1edbc8(0xf2)](0x2):'')+'</td>';}_0x3e645c=_0x51353c['discount']+_0x51353c[_0x1edbc8(0x23d)],_0x2e08fc+=_0x1edbc8(0x1b8)+formatNumber(parseFloat(_0x51353c['totalQty'],0x2)['toFixed'](0x2))+_0x1edbc8(0x15e),_0x2e08fc+=_0x1edbc8(0x1b8)+formatNumber(_0x51353c['totalGross'][_0x1edbc8(0xf2)](0x2))+_0x1edbc8(0x15e),_0x2e08fc+=_0x1edbc8(0x1b8)+formatNumber(_0x3e645c)+_0x1edbc8(0x15e),_0x2e08fc+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x51353c['NetPrice']['toFixed'](0x2))+_0x1edbc8(0x15e),_0x2e08fc+=_0x1edbc8(0x19e),_0x494430+=parseFloat(_0x51353c[_0x1edbc8(0x185)][_0x1edbc8(0xf2)](0x2)),_0x55078b+=parseFloat(_0x51353c[_0x1edbc8(0x153)]['toFixed'](0x2)),_0x470dfc+=_0x3e645c,_0x4bf2f5+=parseFloat(_0x51353c[_0x1edbc8(0x20f)]['toFixed'](0x2));if(_0x3705df==_0x46c77c[_0x1edbc8(0x175)]-0x1){_0x2e08fc+='<tr>',_0x2e08fc+=_0x1edbc8(0x11e),_0x2e08fc+='</td>';for(let _0x2b5c3e=0x0;_0x2b5c3e<=_0x42c790['cat_brand'][_0x1edbc8(0x175)]-0x1;_0x2b5c3e++){const _0x2c34ff=_0x42c790[_0x1edbc8(0x258)][_0x2b5c3e],_0x4109cc=_0x2c34ff['_id'][_0x1edbc8(0x20a)]+'-'+_0x2c34ff['_id'][_0x1edbc8(0x25e)],_0x4cee3a=_0x3970eb[_0x4109cc][_0x1edbc8(0x14d)]((_0x41b054,_0x95e354)=>_0x41b054+_0x95e354,0x0);_0x2e08fc+=_0x1edbc8(0x12c)+(_0x4cee3a!==undefined?formatNumber(_0x4cee3a[_0x1edbc8(0xf2)](0x2)):'')+_0x1edbc8(0x21e),console['log'](_0x3970eb[_0x4109cc][_0x1edbc8(0x14d)]((_0x2fd583,_0xd58779)=>_0x2fd583+_0xd58779,0x0));}_0x2e08fc+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x494430[_0x1edbc8(0xf2)](0x2))+_0x1edbc8(0x21e),_0x2e08fc+=_0x1edbc8(0x15f)+formatNumber(_0x4bf2f5)+'</b></td>',_0x2e08fc+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x470dfc)+_0x1edbc8(0x21e),_0x2e08fc+=_0x1edbc8(0x15f)+formatNumber(_0x55078b)+_0x1edbc8(0x21e),_0x2e08fc+=_0x1edbc8(0x19e);}_0x290fd0[_0x1edbc8(0x136)](_0x2e08fc);}function _0x37450c(_0x1d6e83,_0x1ac40c){const _0x23d0b9=_0x1edbc8,_0x37a93e=[];for(let _0x3db471=0x0;_0x3db471<=_0x1d6e83[_0x23d0b9(0x175)]-0x1;_0x3db471+=_0x1ac40c){_0x37a93e['push'](_0x1d6e83[_0x23d0b9(0x163)](_0x3db471,_0x3db471+_0x1ac40c));}return _0x37a93e;}const _0x2adc64=_0x37450c(_0x290fd0,_0x3ad150);let _0x13efb5='';return _0x2adc64[_0x1edbc8(0x1f1)]((_0x52c4c0,_0x5dff74)=>{const _0x27fda4=_0x1edbc8;_0x5dff74>0x0&&(_0x13efb5+=_0x27fda4(0x160));_0x13efb5+=_0x27fda4(0x150),_0x13efb5+=_0x27fda4(0x227),_0x13efb5+=_0x27fda4(0x1b9),_0x13efb5+=_0x27fda4(0xf5),_0x13efb5+=_0x27fda4(0x19e),_0x13efb5+=_0x27fda4(0x1b9),_0x13efb5+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x496f17=0x0;_0x496f17<=_0x237d26['length']-0x1;_0x496f17++){const _0x4cf620=_0x237d26[_0x496f17];for(let _0x2ca04e=0x0;_0x2ca04e<_0x10be06[_0x27fda4(0x175)];_0x2ca04e++){const _0x4bfbf9=_0x10be06[_0x2ca04e];_0x4bfbf9[_0x27fda4(0x130)]===_0x4cf620[_0x27fda4(0x130)]['category']&&(_0x13efb5+=_0x27fda4(0x12d)+_0x4bfbf9[_0x27fda4(0x210)]+'\x22\x20class=\x22cat_data\x22>'+_0x4cf620[_0x27fda4(0x130)][_0x27fda4(0x25e)]+'</td>');}}_0x13efb5+=_0x27fda4(0x207),_0x13efb5+=_0x27fda4(0x19e),_0x13efb5+=_0x27fda4(0x1b9),_0x13efb5+=_0x27fda4(0x158),_0x13efb5+=_0x27fda4(0x16c),_0x13efb5+=_0x27fda4(0x16e);for(let _0x482fd9=0x0;_0x482fd9<=_0x237d26[_0x27fda4(0x175)]-0x1;_0x482fd9++){const _0x4418fd=_0x237d26[_0x482fd9];for(let _0x411035=0x0;_0x411035<_0x42c790[_0x27fda4(0x258)]['length'];_0x411035++){const _0x561c1d=_0x42c790[_0x27fda4(0x258)][_0x411035];_0x561c1d[_0x27fda4(0x130)][_0x27fda4(0x25e)]===_0x4418fd[_0x27fda4(0x130)][_0x27fda4(0x25e)]&&(_0x13efb5+=_0x27fda4(0x262)+_0x561c1d[_0x27fda4(0x130)]['brand']+_0x27fda4(0x15e));}}_0x13efb5+=_0x27fda4(0x1aa),_0x13efb5+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x13efb5+=_0x27fda4(0x238),_0x13efb5+=_0x27fda4(0x106),_0x13efb5+=_0x27fda4(0x19e),_0x13efb5+=_0x27fda4(0x181),_0x13efb5+=_0x27fda4(0x253),_0x52c4c0['forEach'](_0x2a1949=>{_0x13efb5+=_0x2a1949;}),console['log'](_0x3970eb),_0x13efb5+=_0x27fda4(0x1b2),_0x13efb5+=_0x27fda4(0x1ab);}),_0x13efb5;}async function agentsdataDSICheck_excel(_0x181f30,_0x218038,_0x202edf,_0x1b0199){const _0x9b4310=a0_0x5e81ee,_0x10f8bb=await product['aggregate']([{'$group':{'_id':{'brand':_0x9b4310(0x1e1),'category':'$category'},'products':{'$push':{'name':_0x9b4310(0x223),'product_code':_0x9b4310(0x1fc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x48651c=[];_0x48651c['cat_brand']=[];for(let _0x50d9a4=0x0;_0x50d9a4<=_0x10f8bb[_0x9b4310(0x175)]-0x1;_0x50d9a4++){const _0x3d198e=_0x10f8bb[_0x50d9a4];_0x48651c[_0x9b4310(0x258)][_0x9b4310(0x136)](_0x3d198e);}const _0x1c83d5=await product[_0x9b4310(0x133)]([{'$group':{'_id':{'category':_0x9b4310(0x170)},'products':{'$push':{'brand':_0x9b4310(0x1e1),'product_code':_0x9b4310(0x1fc),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x1c6c50=await product[_0x9b4310(0x133)]([{'$group':{'_id':{'category':_0x9b4310(0x170),'brand':_0x9b4310(0x1e1)}}},{'$group':{'_id':_0x9b4310(0x11d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x204e5f=await sales_sa[_0x9b4310(0x133)]([{'$match':{'date':{'$gte':_0x181f30,'$lte':_0x218038},'sales_staff_id':_0x202edf,'sale_product.isFG':_0x9b4310(0x1d0)}},{'$unwind':_0x9b4310(0x21b)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x9b4310(0x1bd),'localField':_0x9b4310(0x247),'foreignField':_0x9b4310(0x17c),'as':_0x9b4310(0x221)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x9b4310(0x209),'date':_0x9b4310(0x26e),'customer':_0x9b4310(0x116)},'totalQty':{'$sum':_0x9b4310(0x1b5)},'products':{'$push':{'qty':_0x9b4310(0x1b5),'NetPrice':_0x9b4310(0x10f),'discount':_0x9b4310(0x24a),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x9b4310(0x1ff),'product_code':_0x9b4310(0x228),'category':'$product_info.category','brand':'$product_info.brand','gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x9b4310(0x239)},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x9b4310(0x121),'category':'$products.product_details.category','brand':_0x9b4310(0x1d1)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x9b4310(0x1eb)]}},'NetPrice':{'$sum':_0x9b4310(0x23e)},'discount':{'$sum':_0x9b4310(0x194)},'adj_discount':{'$sum':_0x9b4310(0x16d)},'product_details':{'$first':_0x9b4310(0x125)}}},{'$group':{'_id':{'dsi':_0x9b4310(0x1a8),'date':_0x9b4310(0x1ea),'customer':_0x9b4310(0x121)},'totalQty':{'$sum':_0x9b4310(0x1ae)},'totalGross':{'$sum':_0x9b4310(0x1c8)},'NetPrice':{'$sum':_0x9b4310(0x1c1)},'discount':{'$sum':_0x9b4310(0xf1)},'adj_discount':{'$sum':_0x9b4310(0x191)},'products':{'$push':{'qty':_0x9b4310(0x1ae),'category':'$_id.category','brand':_0x9b4310(0xfe),'product_details':_0x9b4310(0x213)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x708107=[],_0x3e61e6={},_0x3788bb={},_0x54d173={};var _0x2bbbaa=0x0,_0x32fa1b=0x0,_0x142c6e=0x0,_0x5c0ede=0x0,_0x1ec1c8=0x0;const _0x3097f6=0x9184e72a000;for(let _0x579d06=0x0;_0x579d06<=_0x204e5f[_0x9b4310(0x175)]-0x1;_0x579d06++){const _0xd3a050=_0x204e5f[_0x579d06];let _0x2a4114=_0x9b4310(0x1b9);_0x2a4114+=_0x9b4310(0x18f)+_0xd3a050[_0x9b4310(0x130)][_0x9b4310(0x25d)]+'</td>',_0x2a4114+=_0x9b4310(0x18f)+_0xd3a050[_0x9b4310(0x130)][_0x9b4310(0x250)]+_0x9b4310(0x15e),_0x2a4114+=_0x9b4310(0x18f)+_0xd3a050[_0x9b4310(0x130)]['customer']+'</td>';let _0x30561c={};var _0x4fa09a=0x0;for(let _0x38f87f=0x0;_0x38f87f<=_0xd3a050[_0x9b4310(0x1bd)][_0x9b4310(0x175)]-0x1;_0x38f87f++){const _0x126b02=_0xd3a050[_0x9b4310(0x1bd)][_0x38f87f];_0x30561c[_0x126b02['brand']+'-'+_0x126b02['category']]=_0x126b02[_0x9b4310(0x23c)];const _0x24c299=_0x126b02['brand']+'-'+_0x126b02[_0x9b4310(0x25e)];!_0x3e61e6[_0x24c299]&&(_0x3e61e6[_0x24c299]=0x0),!Array[_0x9b4310(0x1ac)](_0x54d173[_0x24c299])&&(_0x54d173[_0x24c299]=[]),!Array[_0x9b4310(0x1ac)](_0x54d173[_0x24c299])&&(_0x54d173[_0x24c299]=[]),_0x3e61e6[_0x24c299]+=_0x126b02[_0x9b4310(0x23c)],_0x54d173[_0x24c299][_0x9b4310(0x136)](_0x126b02[_0x9b4310(0x23c)]),_0x4fa09a++;}console[_0x9b4310(0x127)](_0xd3a050);for(let _0x5a913f=0x0;_0x5a913f<=_0x48651c[_0x9b4310(0x258)][_0x9b4310(0x175)]-0x1;_0x5a913f++){const _0x55ba3b=_0x48651c[_0x9b4310(0x258)][_0x5a913f],_0x12bfee=_0x55ba3b[_0x9b4310(0x130)][_0x9b4310(0x20a)]+'-'+_0x55ba3b['_id'][_0x9b4310(0x25e)];_0x2a4114+=_0x9b4310(0x11a)+(_0x30561c[_0x12bfee]!==undefined?_0x30561c[_0x12bfee][_0x9b4310(0xf2)](0x2):'')+_0x9b4310(0x15e);}_0x142c6e=_0xd3a050[_0x9b4310(0x141)]+_0xd3a050[_0x9b4310(0x23d)],_0x2a4114+=_0x9b4310(0x1b8)+formatNumber(parseFloat(_0xd3a050[_0x9b4310(0x185)],0x2)[_0x9b4310(0xf2)](0x2))+'</td>',_0x2a4114+=_0x9b4310(0x1b8)+formatNumber(_0xd3a050[_0x9b4310(0x20f)][_0x9b4310(0xf2)](0x2))+_0x9b4310(0x15e),_0x2a4114+=_0x9b4310(0x1b8)+formatNumber(_0x142c6e)+_0x9b4310(0x15e),_0x2a4114+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xd3a050['NetPrice'][_0x9b4310(0xf2)](0x2))+'</td>',_0x2a4114+=_0x9b4310(0x19e),_0x2bbbaa+=parseFloat(_0xd3a050[_0x9b4310(0x185)]['toFixed'](0x2)),_0x32fa1b+=parseFloat(_0xd3a050[_0x9b4310(0x153)][_0x9b4310(0xf2)](0x2)),_0x5c0ede+=_0x142c6e,_0x1ec1c8+=parseFloat(_0xd3a050[_0x9b4310(0x20f)]['toFixed'](0x2));if(_0x579d06==_0x204e5f['length']-0x1){_0x2a4114+=_0x9b4310(0x1b9),_0x2a4114+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x2a4114+='</td>';for(let _0x2bbb3b=0x0;_0x2bbb3b<=_0x48651c[_0x9b4310(0x258)][_0x9b4310(0x175)]-0x1;_0x2bbb3b++){const _0x588ec2=_0x48651c[_0x9b4310(0x258)][_0x2bbb3b],_0x15ff00=_0x588ec2[_0x9b4310(0x130)]['brand']+'-'+_0x588ec2['_id'][_0x9b4310(0x25e)],_0x4fccf4=_0x54d173[_0x15ff00][_0x9b4310(0x14d)]((_0x3918f6,_0x2c2285)=>_0x3918f6+_0x2c2285,0x0);_0x2a4114+=_0x9b4310(0x12c)+(_0x4fccf4!==undefined?formatNumber(_0x4fccf4[_0x9b4310(0xf2)](0x2)):'')+_0x9b4310(0x21e),console['log'](_0x54d173[_0x15ff00][_0x9b4310(0x14d)]((_0x3dadbd,_0x428f51)=>_0x3dadbd+_0x428f51,0x0));}_0x2a4114+=_0x9b4310(0x15f)+formatNumber(_0x2bbbaa[_0x9b4310(0xf2)](0x2))+'</b></td>',_0x2a4114+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1ec1c8)+_0x9b4310(0x21e),_0x2a4114+=_0x9b4310(0x15f)+formatNumber(_0x5c0ede)+_0x9b4310(0x21e),_0x2a4114+=_0x9b4310(0x15f)+formatNumber(_0x32fa1b)+_0x9b4310(0x21e),_0x2a4114+=_0x9b4310(0x19e);}_0x708107[_0x9b4310(0x136)](_0x2a4114);}function _0x5dfc0b(_0x1f4873,_0x39fdcc){const _0x4dbb31=_0x9b4310,_0x391554=[];for(let _0x5ed9c5=0x0;_0x5ed9c5<=_0x1f4873['length']-0x1;_0x5ed9c5+=_0x39fdcc){_0x391554['push'](_0x1f4873[_0x4dbb31(0x163)](_0x5ed9c5,_0x5ed9c5+_0x39fdcc));}return _0x391554;}const _0x4572d2=_0x5dfc0b(_0x708107,_0x3097f6);let _0x5959a3='';return _0x4572d2[_0x9b4310(0x1f1)]((_0x302188,_0x4a8e03)=>{const _0x32f09e=_0x9b4310;_0x4a8e03>0x0&&(_0x5959a3+=_0x32f09e(0x160));_0x5959a3+=_0x32f09e(0x150),_0x5959a3+=_0x32f09e(0x227),_0x5959a3+='<tr>',_0x5959a3+=_0x32f09e(0xf5),_0x5959a3+=_0x32f09e(0x19e),_0x5959a3+='<tr>',_0x5959a3+=_0x32f09e(0x23f);for(let _0x115df5=0x0;_0x115df5<=_0x1c83d5[_0x32f09e(0x175)]-0x1;_0x115df5++){const _0x42f869=_0x1c83d5[_0x115df5];for(let _0x111e5b=0x0;_0x111e5b<_0x1c6c50[_0x32f09e(0x175)];_0x111e5b++){const _0x4e09b0=_0x1c6c50[_0x111e5b];_0x4e09b0['_id']===_0x42f869['_id']['category']&&(_0x5959a3+=_0x32f09e(0x12d)+_0x4e09b0['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x42f869[_0x32f09e(0x130)][_0x32f09e(0x25e)]+_0x32f09e(0x15e));}}_0x5959a3+=_0x32f09e(0x207),_0x5959a3+=_0x32f09e(0x19e),_0x5959a3+=_0x32f09e(0x1b9),_0x5959a3+=_0x32f09e(0x158),_0x5959a3+=_0x32f09e(0x16c),_0x5959a3+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x1ad4b7=0x0;_0x1ad4b7<=_0x1c83d5['length']-0x1;_0x1ad4b7++){const _0x5c2fd3=_0x1c83d5[_0x1ad4b7];for(let _0x3d38af=0x0;_0x3d38af<_0x48651c[_0x32f09e(0x258)][_0x32f09e(0x175)];_0x3d38af++){const _0x154cf5=_0x48651c[_0x32f09e(0x258)][_0x3d38af];_0x154cf5['_id'][_0x32f09e(0x25e)]===_0x5c2fd3[_0x32f09e(0x130)][_0x32f09e(0x25e)]&&(_0x5959a3+='<td\x20class=\x22cat_data\x22>'+_0x154cf5[_0x32f09e(0x130)]['brand']+_0x32f09e(0x15e));}}_0x5959a3+=_0x32f09e(0x1aa),_0x5959a3+=_0x32f09e(0x21d),_0x5959a3+=_0x32f09e(0x238),_0x5959a3+=_0x32f09e(0x106),_0x5959a3+=_0x32f09e(0x19e),_0x5959a3+=_0x32f09e(0x181),_0x5959a3+='<tbody>',_0x302188[_0x32f09e(0x1f1)](_0x529dab=>{_0x5959a3+=_0x529dab;}),console['log'](_0x54d173),_0x5959a3+='</tbody>',_0x5959a3+=_0x32f09e(0x1ab);}),_0x5959a3;}router[a0_0x5e81ee(0x1cc)](a0_0x5e81ee(0x1e2),auth,async(_0x31165a,_0x499e62)=>{const _0x45ce0c=a0_0x5e81ee,{from_date:_0x2efca6,to_date:_0x1ea2cd,isExcel:_0x16ecec}=_0x31165a[_0x45ce0c(0x24f)],_0xefd105=_0x31165a['user'],_0x36d4a9=await staff[_0x45ce0c(0x189)]({'email':_0xefd105[_0x45ce0c(0x102)]}),_0x2702c9=await master_shop[_0x45ce0c(0x183)]();console['log'](_0x2702c9[0x0][_0x45ce0c(0x24b)]);const _0x4a8368=await agentsdataDSICheck(_0x2efca6,_0x1ea2cd,_0x36d4a9[_0x45ce0c(0x130)][_0x45ce0c(0x265)](),_0x16ecec),_0x22ca5a=await agentsdataDSICheck_excel(_0x2efca6,_0x1ea2cd,_0x36d4a9[_0x45ce0c(0x130)][_0x45ce0c(0x265)](),_0x16ecec);let _0xbd9737=_0x45ce0c(0x266);var _0x496dfa=new Date(_0x2efca6),_0x167fc1=new Date(_0x1ea2cd);const _0x1a242d={'year':_0x45ce0c(0x174),'month':'long','day':_0x45ce0c(0x174)},_0x47a228=new Intl[(_0x45ce0c(0x251))](_0x45ce0c(0x164),_0x1a242d)[_0x45ce0c(0xee)](_0x496dfa),_0x5f5c5b=new Intl[(_0x45ce0c(0x251))]('en-US',_0x1a242d)[_0x45ce0c(0xee)](_0x167fc1);_0xbd9737+='<div\x20class=\x22row\x22>',_0xbd9737+='<div\x20\x20id=\x22table-conatainer\x22>',_0xbd9737+=_0x45ce0c(0x150),_0xbd9737+=_0x4a8368,_0xbd9737+=_0x45ce0c(0x1ab),_0xbd9737+='</div>',_0xbd9737+=_0x45ce0c(0x1db);let _0x9b94b1=_0x45ce0c(0x266);_0x9b94b1+=_0x45ce0c(0x1ef),_0x9b94b1+=_0x45ce0c(0x12b),_0x9b94b1+=_0x45ce0c(0x150),_0x9b94b1+=_0x22ca5a,_0x9b94b1+='</table>',_0x9b94b1+=_0x45ce0c(0x1db),_0x9b94b1+='</div>';let _0x43295a=_0x45ce0c(0x13c);const _0x55f1e3={'width':_0x45ce0c(0x278),'height':_0x45ce0c(0x218),'orientation':'landscape','border':{'top':_0x45ce0c(0x1e5),'right':_0x45ce0c(0x1e5),'bottom':_0x45ce0c(0x1e5),'left':_0x45ce0c(0x1e5)},'header':{'height':_0x45ce0c(0x22a),'contents':_0x45ce0c(0x19c)+_0x43295a+_0x45ce0c(0x217)+_0x47a228+'\x20-\x20'+_0x5f5c5b+_0x45ce0c(0xfc)},'footer':{'height':_0x45ce0c(0x1c0),'contents':{'default':_0x45ce0c(0x180)}},'dpi':0x5,'zoomFactor':'1'};if(_0x16ecec=='on'){const _0x337208=cheerio[_0x45ce0c(0x26c)](_0x9b94b1);let _0x2cb9cb=[],_0x3bb62c=[],_0x245cce=[];const _0x5f1f9b=_0x47ff02=>{const _0x4f773a=_0x45ce0c,_0x25d503={'top':{'style':_0x4f773a(0x14b),'color':{'rgb':'000000'}},'bottom':{'style':_0x4f773a(0x14b),'color':{'rgb':_0x4f773a(0x274)}},'left':{'style':'thick','color':{'rgb':_0x4f773a(0x274)}},'right':{'style':'thick','color':{'rgb':_0x4f773a(0x274)}}};if(_0x47ff02){const _0x2efa32=_0x47ff02['split'](';')[_0x4f773a(0x14d)]((_0xb475ff,_0x1b88a7)=>{const _0x456319=_0x4f773a,[_0x439f2d,_0x55b814]=_0x1b88a7[_0x456319(0x1d5)](':')['map'](_0x23199c=>_0x23199c[_0x456319(0x1a1)]());return _0xb475ff[_0x439f2d]=_0x55b814,_0xb475ff;},{});_0x2efa32[_0x4f773a(0x231)]&&(_0x25d503['top']['style']=_0x2efa32['border-top'][_0x4f773a(0x199)](_0x4f773a(0x26d))?'thin':'medium'),_0x2efa32[_0x4f773a(0x200)]&&(_0x25d503[_0x4f773a(0x18c)]['style']=_0x2efa32['border-bottom'][_0x4f773a(0x199)](_0x4f773a(0x26d))?_0x4f773a(0x26d):_0x4f773a(0x273)),_0x2efa32['border-left']&&(_0x25d503['left'][_0x4f773a(0x128)]=_0x2efa32['border-left'][_0x4f773a(0x199)](_0x4f773a(0x26d))?_0x4f773a(0x26d):'medium'),_0x2efa32[_0x4f773a(0x202)]&&(_0x25d503['right']['style']=_0x2efa32[_0x4f773a(0x202)]['includes'](_0x4f773a(0x26d))?_0x4f773a(0x26d):_0x4f773a(0x273));}return _0x25d503;};_0x337208('table\x20tr')[_0x45ce0c(0x219)]((_0x3b45b8,_0x1c35d7)=>{const _0x4ef17a=_0x45ce0c;let _0x4b4b73=[],_0x32c380=0x0;while(_0x245cce[_0x32c380]){_0x245cce[_0x32c380]--,_0x32c380++;}_0x337208(_0x1c35d7)[_0x4ef17a(0x183)](_0x4ef17a(0x140))['each']((_0x1d6af6,_0xbb95ed)=>{const _0x42b096=_0x4ef17a;let _0x489e07=_0x337208(_0xbb95ed)[_0x42b096(0x21a)]()[_0x42b096(0x1a1)](),_0x37dd0b=parseFloat(_0x489e07[_0x42b096(0x108)](/,/g,'')),_0x5eaf20={};!isNaN(_0x37dd0b)?(_0x5eaf20['v']=_0x37dd0b,_0x5eaf20['t']='n'):(_0x5eaf20['v']=_0x489e07,_0x5eaf20['t']='s');const _0xe60869=_0x337208(_0xbb95ed)[_0x42b096(0x1b4)](_0x42b096(0x128)),_0x5ae19c=_0x5f1f9b(_0xe60869);_0x5eaf20['s']={'border':_0x5ae19c},_0x4b4b73[_0x32c380]=_0x5eaf20;let _0x389287=parseInt(_0x337208(_0xbb95ed)[_0x42b096(0x1b4)](_0x42b096(0x211)))||0x1,_0x3ec641=parseInt(_0x337208(_0xbb95ed)[_0x42b096(0x1b4)]('rowspan'))||0x1;(_0x389287>0x1||_0x3ec641>0x1)&&_0x3bb62c[_0x42b096(0x136)]({'s':{'r':_0x3b45b8,'c':_0x32c380},'e':{'r':_0x3b45b8+_0x3ec641-0x1,'c':_0x32c380+_0x389287-0x1}});for(let _0x4d35a1=0x0;_0x4d35a1<_0x389287;_0x4d35a1++){_0x3ec641>0x1&&(_0x245cce[_0x32c380+_0x4d35a1]=_0x3ec641-0x1);}_0x32c380+=_0x389287;}),_0x2cb9cb[_0x4ef17a(0x136)](_0x4b4b73);});const _0x2a1d07=XLSX[_0x45ce0c(0x1ad)][_0x45ce0c(0x1c4)](),_0x4beb0a=XLSX[_0x45ce0c(0x1ad)]['aoa_to_sheet'](_0x2cb9cb);_0x3bb62c[_0x45ce0c(0x175)]>0x0&&(_0x4beb0a[_0x45ce0c(0x1e7)]=_0x3bb62c);_0x4beb0a[_0x45ce0c(0x123)]=_0x2cb9cb[0x0][_0x45ce0c(0x10a)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x2a1d07,_0x4beb0a,_0x45ce0c(0xf8));const _0x3de42d=XLSX['write'](_0x2a1d07,{'bookType':_0x45ce0c(0x1f0),'type':_0x45ce0c(0x24c)});_0x499e62[_0x45ce0c(0x226)](_0x45ce0c(0x1cb),_0x45ce0c(0x182)),_0x499e62[_0x45ce0c(0x226)](_0x45ce0c(0x22d),_0x45ce0c(0x1f9)),_0x499e62[_0x45ce0c(0x156)](_0x3de42d);}else pdf[_0x45ce0c(0x1cf)](_0xbd9737,_0x55f1e3)['toStream'](function(_0x3fe07b,_0x26d6cf){const _0x125ecf=_0x45ce0c;if(_0x3fe07b){_0x499e62[_0x125ecf(0x19d)](0x1f4)[_0x125ecf(0x156)](_0x125ecf(0x275));return;}_0x499e62[_0x125ecf(0x226)](_0x125ecf(0x22d),_0x125ecf(0x167)),_0x26d6cf[_0x125ecf(0x13b)](_0x499e62);});}),router[a0_0x5e81ee(0x100)](a0_0x5e81ee(0x134),auth,async(_0x208e65,_0x1af9e3)=>{const _0xbce3e=a0_0x5e81ee;try{const {username:_0x4b923a,email:_0x286b39,role:_0x5a7036}=_0x208e65[_0xbce3e(0x26f)],_0x512be6=_0x208e65[_0xbce3e(0x26f)],_0x50f28a=await profile['findOne']({'email':_0x512be6[_0xbce3e(0x102)]}),_0x2fee60={'year':_0xbce3e(0x174),'month':'long','day':_0xbce3e(0x174)},_0x12c2cd=await master_shop[_0xbce3e(0x183)](),_0x236109=await product['find'](),_0x4c3f59=await warehouse[_0xbce3e(0x133)]([{'$unwind':_0xbce3e(0x213)},{'$lookup':{'from':_0xbce3e(0x1bd),'localField':_0xbce3e(0x20e),'foreignField':_0xbce3e(0x27b),'as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0xbce3e(0x17b)}},{'$group':{'_id':_0xbce3e(0x1fd),'product_stock':{'$sum':_0xbce3e(0xec)}}}]),_0x55439f=await staff[_0xbce3e(0x189)]({'email':_0x512be6['email']});if(_0x12c2cd[0x0][_0xbce3e(0x1d7)]==_0xbce3e(0x14a))var _0x86f2da=users[_0xbce3e(0x1cd)];else{if(_0x12c2cd[0x0]['language']==_0xbce3e(0x12e))var _0x86f2da=users[_0xbce3e(0x12e)];else{if(_0x12c2cd[0x0][_0xbce3e(0x1d7)]==_0xbce3e(0x1c7))var _0x86f2da=users[_0xbce3e(0x1c7)];else{if(_0x12c2cd[0x0][_0xbce3e(0x1d7)]==_0xbce3e(0x1d9))var _0x86f2da=users['Spanish'];else{if(_0x12c2cd[0x0][_0xbce3e(0x1d7)]==_0xbce3e(0x22f))var _0x86f2da=users['French'];else{if(_0x12c2cd[0x0]['language']=='Portuguese\x20(BR)')var _0x86f2da=users[_0xbce3e(0x149)];else{if(_0x12c2cd[0x0][_0xbce3e(0x1d7)]=='Chinese')var _0x86f2da=users['Chinese'];else{if(_0x12c2cd[0x0]['language']==_0xbce3e(0xef))var _0x86f2da=users['Arabic'];}}}}}}}_0x1af9e3['render'](_0xbce3e(0x224),{'success':_0x208e65[_0xbce3e(0x187)](_0xbce3e(0x1b0)),'errors':_0x208e65[_0xbce3e(0x187)]('errors'),'alldata':_0x236109,'profile':_0x50f28a,'master_shop':_0x12c2cd,'role':_0x512be6,'product_stock':_0x4c3f59,'language':_0x86f2da,'staff_arr':_0x55439f});}catch(_0x204065){}});async function dataSalesReports(_0x158cf4,_0x1c8b31,_0x4005a5){const _0x39f9bd=a0_0x5e81ee;let _0x32583a='';const _0x13eaea=await sales_sa[_0x39f9bd(0x133)]([{'$match':{'date':{'$gte':_0x158cf4,'$lte':_0x1c8b31},'sales_staff_id':_0x4005a5}},{'$unwind':_0x39f9bd(0x21b)},{'$match':{'sale_product.isFG':_0x39f9bd(0x1d0)}},{'$group':{'_id':{'product_name':_0x39f9bd(0x1e3),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':_0x39f9bd(0x10f)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x3007f2=0x0,_0x43f575=0x0;for(let _0x285d82=0x0;_0x285d82<=_0x13eaea[_0x39f9bd(0x175)]-0x1;_0x285d82++){const _0x182fa4=_0x13eaea[_0x285d82];var _0x540c94=_0x182fa4[_0x39f9bd(0x240)][_0x39f9bd(0x138)](undefined),_0xfc097=_0x182fa4[_0x39f9bd(0x256)]['toLocaleString'](undefined);_0x32583a+='<tr>',_0x32583a+='<td\x20class=\x22row_data\x22>'+_0x182fa4[_0x39f9bd(0x130)]['product_code']+_0x39f9bd(0x15e),_0x32583a+=_0x39f9bd(0x25b)+_0x182fa4[_0x39f9bd(0x130)][_0x39f9bd(0x1b1)]+_0x39f9bd(0x15e),_0x32583a+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x182fa4[_0x39f9bd(0x256)][_0x39f9bd(0xf2)](0x2))+_0x39f9bd(0x15e),_0x32583a+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x182fa4[_0x39f9bd(0x240)][_0x39f9bd(0xf2)](0x2))+'</td>',_0x32583a+=_0x39f9bd(0x19e),_0x3007f2+=parseFloat(_0x182fa4['sumqty']),_0x43f575+=parseFloat(_0x182fa4[_0x39f9bd(0x240)]);}var _0x3ff939=_0x43f575['toLocaleString'](undefined),_0x4856fa=_0x3007f2[_0x39f9bd(0x138)](undefined);return _0x32583a+=_0x39f9bd(0x1b9),_0x32583a+=_0x39f9bd(0x190),_0x32583a+=_0x39f9bd(0x177)+formatNumber(_0x3007f2['toFixed'](0x2))+_0x39f9bd(0x21e),_0x32583a+=_0x39f9bd(0x177)+formatNumber(_0x43f575[_0x39f9bd(0xf2)](0x2))+_0x39f9bd(0x21e),_0x32583a+=_0x39f9bd(0x19e),_0x32583a;}router[a0_0x5e81ee(0x1cc)](a0_0x5e81ee(0x1d4),auth,async(_0x3b7b8e,_0x56b5fa)=>{const _0x2c056b=a0_0x5e81ee;try{const {from_date:_0x9b459,to_date:_0x594197,isExcel:_0x4b7434}=_0x3b7b8e[_0x2c056b(0x24f)],_0x31374b=_0x3b7b8e[_0x2c056b(0x26f)],_0x4f1bc8=await staff[_0x2c056b(0x189)]({'email':_0x31374b[_0x2c056b(0x102)]});let _0x1d39f7='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x34da8c=new Date(_0x9b459),_0x38e367=new Date(_0x594197);const _0x27af53={'year':_0x2c056b(0x174),'month':_0x2c056b(0x11c),'day':_0x2c056b(0x174)},_0x25d670=new Intl[(_0x2c056b(0x251))](_0x2c056b(0x164),_0x27af53)[_0x2c056b(0xee)](_0x34da8c),_0x4d4443=new Intl['DateTimeFormat'](_0x2c056b(0x164),_0x27af53)[_0x2c056b(0xee)](_0x38e367);var _0xb78830=await dataSalesReports(_0x9b459,_0x594197,_0x4f1bc8[_0x2c056b(0x130)][_0x2c056b(0x265)]());_0x1d39f7+=_0x2c056b(0x1ef),_0x1d39f7+=_0x2c056b(0x271),_0x1d39f7+='<table>',_0x1d39f7+=_0x2c056b(0x1b9),_0x1d39f7+=_0x2c056b(0x267),_0x1d39f7+=_0x2c056b(0x1ba),_0x1d39f7+='<th>\x20QTY\x20SOLD\x20</th>',_0x1d39f7+=_0x2c056b(0x1a6),_0x1d39f7+=_0x2c056b(0x1b9),_0x1d39f7+=_0xb78830,_0x1d39f7+=_0x2c056b(0x19e),_0x1d39f7+=_0x2c056b(0x1db),_0x1d39f7+=_0x2c056b(0x1db);let _0x5d1a9a=_0x2c056b(0x13c);const _0x21bbfe={'width':_0x2c056b(0x278),'height':'8.5in','orientation':_0x2c056b(0x279),'border':{'top':_0x2c056b(0x1e5),'right':_0x2c056b(0x1e5),'bottom':'0.1in','left':_0x2c056b(0x1e5)},'header':{'height':'60mm','contents':_0x2c056b(0x19c)+_0x5d1a9a+_0x2c056b(0x192)+_0x4f1bc8[_0x2c056b(0x27b)]+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x25d670+_0x2c056b(0x204)+_0x4d4443+_0x2c056b(0xfc)},'footer':{'height':_0x2c056b(0x1c0),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x4b7434=='on'){const _0x2d060d=cheerio[_0x2c056b(0x26c)](_0x1d39f7);let _0x3a01e5=[],_0x52c5e1=[],_0x21986a=[];const _0x53a7de=_0x69a952=>{const _0x3a1411=_0x2c056b,_0x1af0ef={'top':{'style':_0x3a1411(0x14b),'color':{'rgb':_0x3a1411(0x274)}},'bottom':{'style':_0x3a1411(0x14b),'color':{'rgb':_0x3a1411(0x274)}},'left':{'style':_0x3a1411(0x14b),'color':{'rgb':_0x3a1411(0x274)}},'right':{'style':_0x3a1411(0x14b),'color':{'rgb':'000000'}}};if(_0x69a952){const _0x2b0c70=_0x69a952[_0x3a1411(0x1d5)](';')[_0x3a1411(0x14d)]((_0x423c37,_0x5d36a7)=>{const _0x53a3d8=_0x3a1411,[_0x1c30bf,_0xe5f923]=_0x5d36a7[_0x53a3d8(0x1d5)](':')[_0x53a3d8(0x10a)](_0x5959d4=>_0x5959d4['trim']());return _0x423c37[_0x1c30bf]=_0xe5f923,_0x423c37;},{});_0x2b0c70[_0x3a1411(0x231)]&&(_0x1af0ef['top'][_0x3a1411(0x128)]=_0x2b0c70['border-top'][_0x3a1411(0x199)](_0x3a1411(0x26d))?_0x3a1411(0x26d):_0x3a1411(0x273)),_0x2b0c70[_0x3a1411(0x200)]&&(_0x1af0ef['bottom'][_0x3a1411(0x128)]=_0x2b0c70[_0x3a1411(0x200)][_0x3a1411(0x199)](_0x3a1411(0x26d))?_0x3a1411(0x26d):_0x3a1411(0x273)),_0x2b0c70[_0x3a1411(0x270)]&&(_0x1af0ef[_0x3a1411(0x103)][_0x3a1411(0x128)]=_0x2b0c70[_0x3a1411(0x270)][_0x3a1411(0x199)](_0x3a1411(0x26d))?_0x3a1411(0x26d):_0x3a1411(0x273)),_0x2b0c70['border-right']&&(_0x1af0ef['right'][_0x3a1411(0x128)]=_0x2b0c70['border-right'][_0x3a1411(0x199)](_0x3a1411(0x26d))?_0x3a1411(0x26d):_0x3a1411(0x273));}return _0x1af0ef;};_0x2d060d(_0x2c056b(0x17a))[_0x2c056b(0x219)]((_0x24067c,_0x3ac915)=>{const _0xe2778=_0x2c056b;let _0x302349=[],_0x471c08=0x0;while(_0x21986a[_0x471c08]){_0x21986a[_0x471c08]--,_0x471c08++;}_0x2d060d(_0x3ac915)['find'](_0xe2778(0x140))[_0xe2778(0x219)]((_0x2eaba5,_0x184fc4)=>{const _0x307a64=_0xe2778;let _0x4186c2=_0x2d060d(_0x184fc4)['text']()[_0x307a64(0x1a1)](),_0x361354=parseFloat(_0x4186c2['replace'](/,/g,'')),_0x10d6aa={};!isNaN(_0x361354)?(_0x10d6aa['v']=_0x361354,_0x10d6aa['t']='n'):(_0x10d6aa['v']=_0x4186c2,_0x10d6aa['t']='s');const _0x43bcec=_0x2d060d(_0x184fc4)['attr'](_0x307a64(0x128)),_0x3a85f1=_0x53a7de(_0x43bcec);_0x10d6aa['s']={'border':_0x3a85f1},_0x302349[_0x471c08]=_0x10d6aa;let _0x376861=parseInt(_0x2d060d(_0x184fc4)['attr'](_0x307a64(0x211)))||0x1,_0x37e38f=parseInt(_0x2d060d(_0x184fc4)[_0x307a64(0x1b4)]('rowspan'))||0x1;(_0x376861>0x1||_0x37e38f>0x1)&&_0x52c5e1[_0x307a64(0x136)]({'s':{'r':_0x24067c,'c':_0x471c08},'e':{'r':_0x24067c+_0x37e38f-0x1,'c':_0x471c08+_0x376861-0x1}});for(let _0x4d70b5=0x0;_0x4d70b5<_0x376861;_0x4d70b5++){_0x37e38f>0x1&&(_0x21986a[_0x471c08+_0x4d70b5]=_0x37e38f-0x1);}_0x471c08+=_0x376861;}),_0x3a01e5[_0xe2778(0x136)](_0x302349);});const _0x4a7f9c=XLSX[_0x2c056b(0x1ad)][_0x2c056b(0x1c4)](),_0x471156=XLSX[_0x2c056b(0x1ad)][_0x2c056b(0x20d)](_0x3a01e5);_0x52c5e1['length']>0x0&&(_0x471156[_0x2c056b(0x1e7)]=_0x52c5e1);_0x471156['!cols']=_0x3a01e5[0x0][_0x2c056b(0x10a)](()=>({'wpx':0x64})),XLSX[_0x2c056b(0x1ad)][_0x2c056b(0x1af)](_0x4a7f9c,_0x471156,_0x2c056b(0xf8));const _0x223b70=XLSX['write'](_0x4a7f9c,{'bookType':_0x2c056b(0x1f0),'type':'buffer'});_0x56b5fa[_0x2c056b(0x226)](_0x2c056b(0x1cb),_0x2c056b(0x182)),_0x56b5fa['setHeader']('Content-Type',_0x2c056b(0x1f9)),_0x56b5fa[_0x2c056b(0x156)](_0x223b70);}else pdf[_0x2c056b(0x1cf)](_0x1d39f7,_0x21bbfe)[_0x2c056b(0x1ce)](function(_0x3248eb,_0x30520b){const _0x1f267c=_0x2c056b;if(_0x3248eb){_0x56b5fa[_0x1f267c(0x19d)](0x1f4)[_0x1f267c(0x156)](_0x1f267c(0x275));return;}_0x56b5fa[_0x1f267c(0x226)]('Content-Type','application/pdf'),_0x30520b[_0x1f267c(0x13b)](_0x56b5fa);});}catch(_0x4c374a){}}),router[a0_0x5e81ee(0x100)](a0_0x5e81ee(0x13d),auth,async(_0x742adf,_0x31e3b1)=>{const _0x568d61=a0_0x5e81ee;try{const {username:_0x82a64a,email:_0x10dcda,role:_0x68af10}=_0x742adf[_0x568d61(0x26f)],_0x3d63c3=_0x742adf[_0x568d61(0x26f)],_0x24a842=await profile[_0x568d61(0x189)]({'email':_0x3d63c3[_0x568d61(0x102)]}),_0x5f240a={'year':_0x568d61(0x174),'month':_0x568d61(0x11c),'day':'numeric'},_0x588d55=await master_shop[_0x568d61(0x183)](),_0x270fad=await product[_0x568d61(0x183)](),_0x509435=await warehouse[_0x568d61(0x133)]([{'$unwind':_0x568d61(0x213)},{'$lookup':{'from':_0x568d61(0x1bd),'localField':_0x568d61(0x20e),'foreignField':'name','as':_0x568d61(0x16a)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x568d61(0x1fd),'product_stock':{'$sum':_0x568d61(0xec)}}}]);if(_0x588d55[0x0][_0x568d61(0x1d7)]==_0x568d61(0x14a))var _0x4628b3=users[_0x568d61(0x1cd)];else{if(_0x588d55[0x0][_0x568d61(0x1d7)]==_0x568d61(0x12e))var _0x4628b3=users['Hindi'];else{if(_0x588d55[0x0][_0x568d61(0x1d7)]==_0x568d61(0x1c7))var _0x4628b3=users[_0x568d61(0x1c7)];else{if(_0x588d55[0x0][_0x568d61(0x1d7)]==_0x568d61(0x1d9))var _0x4628b3=users[_0x568d61(0x1d9)];else{if(_0x588d55[0x0]['language']==_0x568d61(0x22f))var _0x4628b3=users['French'];else{if(_0x588d55[0x0]['language']==_0x568d61(0x139))var _0x4628b3=users[_0x568d61(0x149)];else{if(_0x588d55[0x0][_0x568d61(0x1d7)]==_0x568d61(0x148))var _0x4628b3=users[_0x568d61(0x148)];else{if(_0x588d55[0x0][_0x568d61(0x1d7)]==_0x568d61(0xef))var _0x4628b3=users['Arabic'];}}}}}}}_0x31e3b1[_0x568d61(0x18e)](_0x568d61(0x1f3),{'success':_0x742adf[_0x568d61(0x187)](_0x568d61(0x1b0)),'errors':_0x742adf[_0x568d61(0x187)](_0x568d61(0x14c)),'alldata':_0x270fad,'profile':_0x24a842,'master_shop':_0x588d55,'role':_0x3d63c3,'product_stock':_0x509435,'language':_0x4628b3});}catch(_0x3e52a5){}});async function dataInventoryReports(_0x4f2c59,_0x24f53b,_0x1a9a9d){const _0x746fc8=a0_0x5e81ee,_0x3404d5=await sales_sa[_0x746fc8(0x133)]([{'$match':{'date':{'$gte':_0x4f2c59,'$lte':_0x24f53b},'sales_staff_id':_0x1a9a9d}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x746fc8(0x1e3),'product_code':_0x746fc8(0x1dc)},'sumqty':{'$sum':_0x746fc8(0xf9)}}},{'$sort':{'_id.product_name':0x1}}]),_0x599069=mongoose[_0x746fc8(0x1fe)]['ObjectId'],_0x65782c=await staff[_0x746fc8(0x133)]([{'$match':{'_id':_0x599069(_0x1a9a9d)}},{'$unwind':_0x746fc8(0x25f)},{'$match':{'product_list.isConfirm':_0x746fc8(0x1f7)}},{'$group':{'_id':{'product_name':_0x746fc8(0x142),'product_code':_0x746fc8(0x1b6)},'sumqty':{'$sum':_0x746fc8(0x1b3)}}},{'$sort':{'_id.product_name':0x1}}]),_0x378e8d=await sales_inv_data[_0x746fc8(0x133)]([{'$match':{'date':{'$gte':_0x4f2c59,'$lte':_0x24f53b},'sales_staff_id':_0x1a9a9d}},{'$unwind':_0x746fc8(0x21b)},{'$group':{'_id':{'product_name':_0x746fc8(0x1e3),'product_code':_0x746fc8(0x1dc)},'totalQTYsum':{'$sum':_0x746fc8(0x13e)}}}]);console[_0x746fc8(0x127)](_0x378e8d);let _0x89f98='';var _0x11abd7=0x0;for(let _0x1d1c1d=0x0;_0x1d1c1d<=_0x65782c[_0x746fc8(0x175)]-0x1;_0x1d1c1d++){const _0x1ca217=_0x65782c[_0x1d1c1d];_0x89f98+=_0x746fc8(0x1b9),_0x89f98+=_0x746fc8(0x261)+_0x1ca217[_0x746fc8(0x130)][_0x746fc8(0x17c)]+_0x746fc8(0x15e),_0x89f98+=_0x746fc8(0x1e6)+_0x1ca217[_0x746fc8(0x130)][_0x746fc8(0x1b1)]+'</td>';var _0x1aed70=_0x1ca217[_0x746fc8(0x256)],_0x3c27d2=0x0;for(let _0x2aff17=0x0;_0x2aff17<=_0x3404d5['length']-0x1;_0x2aff17++){const _0x3298b9=_0x3404d5[_0x2aff17];_0x1ca217[_0x746fc8(0x130)][_0x746fc8(0x17c)]==_0x3298b9[_0x746fc8(0x130)][_0x746fc8(0x17c)]&&_0x1ca217['_id'][_0x746fc8(0x1b1)]==_0x3298b9['_id'][_0x746fc8(0x1b1)]&&(_0x3c27d2=_0x3298b9[_0x746fc8(0x256)]);}var _0x1057b0=0x0;for(let _0x4b28d0=0x0;_0x4b28d0<=_0x378e8d[_0x746fc8(0x175)]-0x1;_0x4b28d0++){const _0x302858=_0x378e8d[_0x4b28d0];_0x1ca217[_0x746fc8(0x130)][_0x746fc8(0x17c)]==_0x302858['_id'][_0x746fc8(0x17c)]&&_0x1ca217[_0x746fc8(0x130)][_0x746fc8(0x1b1)]==_0x302858[_0x746fc8(0x130)][_0x746fc8(0x1b1)]&&(_0x1057b0=_0x302858[_0x746fc8(0x206)]);}_0x11abd7=_0x1aed70-_0x1057b0+_0x3c27d2,_0x89f98+=_0x746fc8(0x25b)+_0x11abd7+'</td>';let _0x2e80b4=![];for(let _0x23e57f=0x0;_0x23e57f<=_0x378e8d['length']-0x1;_0x23e57f++){const _0x5e8641=_0x378e8d[_0x23e57f];if(_0x1ca217[_0x746fc8(0x130)][_0x746fc8(0x17c)]==_0x5e8641[_0x746fc8(0x130)][_0x746fc8(0x17c)]&&_0x1ca217[_0x746fc8(0x130)][_0x746fc8(0x1b1)]==_0x5e8641['_id'][_0x746fc8(0x1b1)]){_0x89f98+=_0x746fc8(0x25b)+_0x5e8641[_0x746fc8(0x206)]+_0x746fc8(0x15e),_0x2e80b4=!![];break;}}!_0x2e80b4&&(_0x89f98+=_0x746fc8(0x257));let _0x5d9288=![];for(let _0x2bae56=0x0;_0x2bae56<=_0x3404d5[_0x746fc8(0x175)]-0x1;_0x2bae56++){const _0x577ba7=_0x3404d5[_0x2bae56];if(_0x1ca217[_0x746fc8(0x130)][_0x746fc8(0x17c)]==_0x577ba7['_id'][_0x746fc8(0x17c)]&&_0x1ca217[_0x746fc8(0x130)]['product_name']==_0x577ba7[_0x746fc8(0x130)]['product_name']){_0x89f98+=_0x746fc8(0x25b)+_0x577ba7[_0x746fc8(0x256)]+_0x746fc8(0x15e),_0x5d9288=!![];break;}}!_0x5d9288&&(_0x89f98+='<td\x20class=\x22row_data\x22>0</td>'),_0x89f98+='<td\x20class=\x22row_data\x22>'+_0x1ca217['sumqty']+_0x746fc8(0x15e),_0x89f98+='</tr>';}return _0x89f98;}router[a0_0x5e81ee(0x1cc)]('/inventory_sum/pdf',auth,async(_0x173d95,_0x117352)=>{const _0x2cab0e=a0_0x5e81ee;try{const {from_date:_0x3385e7,to_date:_0x485991}=_0x173d95[_0x2cab0e(0x24f)],_0x104d0a=_0x173d95[_0x2cab0e(0x26f)],_0x1152d0=await staff[_0x2cab0e(0x189)]({'email':_0x104d0a['email']});let _0x58b0b2='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x8efc4d=new Date(_0x3385e7),_0x59adb4=new Date(_0x485991);const _0x3840b1={'year':_0x2cab0e(0x174),'month':_0x2cab0e(0x11c),'day':_0x2cab0e(0x174)},_0x48b3d6=new Intl[(_0x2cab0e(0x251))](_0x2cab0e(0x164),_0x3840b1)[_0x2cab0e(0xee)](_0x8efc4d),_0x598488=new Intl[(_0x2cab0e(0x251))]('en-US',_0x3840b1)[_0x2cab0e(0xee)](_0x59adb4);var _0x34731d=await dataInventoryReports(_0x3385e7,_0x485991,_0x1152d0[_0x2cab0e(0x130)][_0x2cab0e(0x265)]());_0x58b0b2+=_0x2cab0e(0x19b),_0x58b0b2+=_0x2cab0e(0x11f),_0x58b0b2+=_0x2cab0e(0x13a)+_0x48b3d6+_0x2cab0e(0x204)+_0x598488+_0x2cab0e(0x248),_0x58b0b2+=_0x2cab0e(0x1ef),_0x58b0b2+='<div\x20class=\x22col-sm-11\x22>',_0x58b0b2+=_0x2cab0e(0x150),_0x58b0b2+=_0x2cab0e(0x1b9),_0x58b0b2+=_0x2cab0e(0x267),_0x58b0b2+=_0x2cab0e(0x1ba),_0x58b0b2+=_0x2cab0e(0x18b),_0x58b0b2+=_0x2cab0e(0x26a),_0x58b0b2+=_0x2cab0e(0x155),_0x58b0b2+=_0x2cab0e(0x162),_0x58b0b2+=_0x2cab0e(0x1b9),_0x58b0b2+=_0x34731d,_0x58b0b2+='</tr>',_0x58b0b2+=_0x2cab0e(0x1db),_0x58b0b2+='</div>';const _0xe50b36={'format':'Letter','orientation':_0x2cab0e(0x279)};pdf[_0x2cab0e(0x1cf)](_0x58b0b2,_0xe50b36)[_0x2cab0e(0x1ce)](function(_0x26d8f1,_0x17c231){const _0x3e7a03=_0x2cab0e;if(_0x26d8f1){_0x117352[_0x3e7a03(0x19d)](0x1f4)[_0x3e7a03(0x156)](_0x3e7a03(0x275));return;}_0x117352['setHeader'](_0x3e7a03(0x22d),'application/pdf'),_0x17c231[_0x3e7a03(0x13b)](_0x117352);});}catch(_0x524ada){}}),router['get'](a0_0x5e81ee(0x109),auth,async(_0x323c91,_0x2ec738)=>{const _0xd00e9f=a0_0x5e81ee;try{const {username:_0x3432ba,email:_0x30516a,role:_0x53729a}=_0x323c91[_0xd00e9f(0x26f)],_0x1417c2=_0x323c91[_0xd00e9f(0x26f)],_0x446e79=await profile['findOne']({'email':_0x1417c2[_0xd00e9f(0x102)]}),_0x23c9bf={'year':_0xd00e9f(0x174),'month':_0xd00e9f(0x11c),'day':_0xd00e9f(0x174)},_0x293dd6=await master_shop[_0xd00e9f(0x183)]();console[_0xd00e9f(0x127)](_0xd00e9f(0x1de),_0x293dd6);const _0x2f301e=await product['find']();console['log'](_0xd00e9f(0x107),_0x2f301e);const _0x2f91b4=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0xd00e9f(0x1bd),'localField':_0xd00e9f(0x20e),'foreignField':_0xd00e9f(0x27b),'as':_0xd00e9f(0x16a)}},{'$unwind':_0xd00e9f(0x21f)},{'$project':{'product_name':_0xd00e9f(0x1f4),'product_stock':_0xd00e9f(0x17b)}},{'$group':{'_id':_0xd00e9f(0x1fd),'product_stock':{'$sum':_0xd00e9f(0xec)}}}]);console['log']('Products\x20warehouse_data',_0x2f91b4),_0x2f91b4[_0xd00e9f(0x1f1)](_0x1f76d9=>{const _0x193556=_0xd00e9f,_0x74c464=_0x2f301e[_0x193556(0x10a)](_0x27f09f=>{const _0x329827=_0x193556;_0x27f09f[_0x329827(0x27b)]==_0x1f76d9[_0x329827(0x130)]&&(_0x27f09f[_0x329827(0x178)]=parseInt(_0x27f09f[_0x329827(0x178)])+parseInt(_0x1f76d9['product_stock']));});});const _0x5d2f95=await staff['findOne']({'email':_0x1417c2['email']});if(_0x293dd6[0x0]['language']==_0xd00e9f(0x14a))var _0x22495a=users['English'];else{if(_0x293dd6[0x0][_0xd00e9f(0x1d7)]==_0xd00e9f(0x12e))var _0x22495a=users[_0xd00e9f(0x12e)];else{if(_0x293dd6[0x0][_0xd00e9f(0x1d7)]==_0xd00e9f(0x1c7))var _0x22495a=users[_0xd00e9f(0x1c7)];else{if(_0x293dd6[0x0]['language']==_0xd00e9f(0x1d9))var _0x22495a=users[_0xd00e9f(0x1d9)];else{if(_0x293dd6[0x0][_0xd00e9f(0x1d7)]=='French')var _0x22495a=users['French'];else{if(_0x293dd6[0x0][_0xd00e9f(0x1d7)]==_0xd00e9f(0x139))var _0x22495a=users['Portuguese'];else{if(_0x293dd6[0x0]['language']==_0xd00e9f(0x148))var _0x22495a=users[_0xd00e9f(0x148)];else{if(_0x293dd6[0x0][_0xd00e9f(0x1d7)]==_0xd00e9f(0xef))var _0x22495a=users['Arabic'];}}}}}}}_0x2ec738['render'](_0xd00e9f(0x254),{'success':_0x323c91[_0xd00e9f(0x187)](_0xd00e9f(0x1b0)),'errors':_0x323c91[_0xd00e9f(0x187)](_0xd00e9f(0x14c)),'alldata':_0x2f301e,'profile':_0x446e79,'master_shop':_0x293dd6,'role':_0x1417c2,'product_stock':_0x2f91b4,'language':_0x22495a,'staff_arr':_0x5d2f95});}catch(_0x30fb48){}});function a0_0x3494(){const _0x47d930=['name','$product_stock','write','format','Arabic\x20(ae)','$product','$discount','toFixed','pdfkit-table','\x22><b>','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','2816776ugAVxd','$sales_staff_id','Sales\x20Report','$sale_product.quantity','797345xMsmsN','5QMKnsv','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</th>','$_id.brand','exports','get','880761ocoJLL','email','left','exceljs','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','Products\x20find_data','replace','/dsrr/view','map','../public/language/languages.json','$product.product_name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','$sale_product.totalprice','$sale_product.isFG','due_date','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','/agent_reports/sales_ad','No\x20data\x20was\x20Found!','$customer','multer','<td\x20class=\x22cat_data\x22></td>','$_id.status_data','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','long','$_id.category','<td\x20colspan=\x223\x22><b>TOTAL<b>','<p>INVENTORY\x20SUMMARY</p>','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','$_id.customer','<th\x20rowspan=\x272\x27>Category</th>','!cols','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','$products.product_details','dsi_sales','log','style','$sale_product.prod_cat','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','<div\x20\x20id=\x22table-conatainer\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<td\x20colspan=\x22','Hindi','../models/all_models','_id','referenceNumber','$cash','aggregate','/total_sales_reports/view','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','push','$sales_info','toLocaleString','Portuguese\x20(BR)','<p>','pipe','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','/inventory_sum/view','$sale_product.stock','$products.product_details.category','td,\x20th','discount','$product_list.product_name','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','sales_bkg','$status_data','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','Chinese','Portuguese','English\x20(US)','thick','errors','reduce','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','mongoose','<table>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','test','NetPrice','getFullYear','<th>\x20SALES\x20</th>','send','redirect','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','totalQTY','save','$sale_product._id','setDate','rowspan','</td>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<div\x20style=\x22page-break-before:\x20always;\x22></div>','72pYSpgw','<th>\x20ENDING\x20BALANCE\x20</th>','slice','en-US','/agent_reports/pdf_admin','3959913MhRarl','application/pdf','canvas','jsbarcode','product_docs','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$products.adj_discount','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','<th\x20rowspan=\x272\x27>Products</th>','$category','getDate','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<p>SALES\x20REPORTS</p>','numeric','length','product_stock','<td\x20class=\x22row_data\x22><b>','stock','2OGJSuT','table\x20tr','$product_details.product_stock','product_code','express/lib/response','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','</thead>','attachment;\x20filename=\x22sales_report.xlsx\x22','find','7616554QCZERg','totalQty','/dsrr_admin/view','flash','right','findOne','isFG','<th>\x20BEG\x20BALANCE\x20</th>','bottom','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','render','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','$adj_discount','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','/reports/dsrr/view','$products.discount','sales_ext','/balance/pdf','toLocaleDateString','/balance/view','includes','$product_info','<h1>JAKA\x20EQUITIES\x20CORP</h1>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','status','</tr>','$product_info.gross_price','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','trim','findById','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','/dsrr_admin/view_data/:id','check_no','<th>\x20INVOICE\x20AMOUNT\x20</th>','48NGyKiP','$_id.dsi','$due_date','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','</table>','isArray','utils','$totalQty','book_append_sheet','success','product_name','</tbody>','$product_list.product_stock','attr','$sale_product.real_qty_unit_val','$product_list.product_code','/getDSSR_no','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<tr>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','bank','products','amount','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','20mm','$NetPrice','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','13344152CbmaLf','book_new','product_details','/dsrr/pdf','German','$totalGross','date_include','html','Content-Disposition','post','English','toStream','create','false','$products.product_details.brand','attachment;\x20filename=\x22reports.xlsx\x22','staffs','/total_sales_reports/pdf','split','html-pdf','language','dssr_view_admin','Spanish','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','</div>','$sale_product.product_code','$products.qty','Products\x20master','$sales_info._id','/agent/view','$brand','/agent_reports/pdf','$sale_product.product_name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','0.1in','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','!merges','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','$check_no','$_id.date','$products.product_details.gross_price','customer','Arabic','deleteOne','<div\x20class=\x22row\x22>','xlsx','forEach','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','inventory_sum','$product_details.product_name','10JYzhff','prod_cat','true','/agent/pdf','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','$bank','sales_info','$product_code','$product_name','Types','$product_info.name','border-bottom','$product.product_code','border-right','\x22\x20class=\x22cat_data\x22>','\x20-\x20','$product.quantity','totalQTYsum','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','cheerio','$dsi','brand','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','beg_bal','aoa_to_sheet','product_details.product_name','totalGross','brandCount','colspan','<th\x20colspan=\x272\x27>SOLD</th>','$product_details','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','\x22><b></b></td>','toISOString','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','8.5in','each','text','$sale_product','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','</b></td>','$product_docs','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','product_info','$product_info.brand','$name','sales_reports','dataqty','setHeader','<thead>','$product_info.product_code','top','60mm','path','error','Content-Type','note','French','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','border-top','dsi_sales_admin','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','Router','Products\x20warehouse_data','NumberFormat','<th>X-Truck</th>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','$products','$sale_product.adj_discount','cash','qty','adj_discount','$products.NetPrice','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','totalPrice','json','../middleware/auth','Household','$amount','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','$sales_info.name','sale_product.product_code','</p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','$sale_product.discount','image','buffer','$product_info.category','then','body','date','DateTimeFormat','Letter','<tbody>','dssr_view','\x20-\x20STD','sumqty','<td\x20class=\x22row_data\x22>0</td>','cat_brand','$products.product_details.prod_id','Standard','<td\x20class=\x22row_data\x22>','blob-stream','dsi','category','$product_list','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','<td\x20class=\x22cat_data\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','4040451LOELgQ','valueOf','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<th>\x20ITEM\x20CODE\x20</th>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','salesman_data','<th>\x20INCOMING\x20</th>','express','load','thin','$date','user','border-left','<div\x20class=\x22col-sm-11\x22>','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','medium','000000','Error\x20generating\x20PDF','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','15in','landscape','getMonth'];a0_0x3494=function(){return _0x47d930;};return a0_0x3494();}async function agentsdataDSICheck_DSRR(_0x33a8a0,_0x168785,_0x5c5808,_0x2147c4){const _0x18d796=a0_0x5e81ee;let _0x414bbd=new Date(_0x33a8a0);_0x414bbd[_0x18d796(0x15c)](_0x414bbd[_0x18d796(0x171)]()-0x1);let _0xa41a2c=_0x414bbd[_0x18d796(0x216)]()[_0x18d796(0x1d5)]('T')[0x0];const _0x222ba4=await product['aggregate']([{'$group':{'_id':{'brand':_0x18d796(0x1e1),'category':_0x18d796(0x170)},'products':{'$push':{'name':_0x18d796(0x223),'product_code':_0x18d796(0x1fc)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xa97afc=[];_0xa97afc[_0x18d796(0x258)]=[];for(let _0x28798b=0x0;_0x28798b<=_0x222ba4[_0x18d796(0x175)]-0x1;_0x28798b++){const _0x4b8477=_0x222ba4[_0x28798b];_0xa97afc[_0x18d796(0x258)]['push'](_0x4b8477);}const _0x1fadf1=await product[_0x18d796(0x133)]([{'$group':{'_id':{'category':_0x18d796(0x170)},'products':{'$push':{'brand':_0x18d796(0x1e1),'product_code':_0x18d796(0x1fc),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x3075f1=await product[_0x18d796(0x133)]([{'$group':{'_id':{'category':_0x18d796(0x170),'brand':'$brand'}}},{'$group':{'_id':_0x18d796(0x11d),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xfea7af=await sales_sa[_0x18d796(0x133)]([{'$match':{'date':_0x33a8a0,'sales_staff_id':_0x168785,'sale_product.isFG':'false'}},{'$unwind':_0x18d796(0x21b)},{'$lookup':{'from':'products','localField':_0x18d796(0x247),'foreignField':_0x18d796(0x17c),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x18d796(0x209),'date':'$date','customer':'$customer','status_data':_0x18d796(0x146)},'totalQty':{'$sum':_0x18d796(0x1b5)},'cash':{'$first':_0x18d796(0x132)},'amount':{'$first':_0x18d796(0x244)},'bank':{'$first':_0x18d796(0x1fa)},'check_no':{'$first':_0x18d796(0x1e9)},'due_date':{'$first':_0x18d796(0x1a9)},'products':{'$push':{'qty':_0x18d796(0x1b5),'NetPrice':_0x18d796(0x10f),'discount':_0x18d796(0x24a),'adj_discount':_0x18d796(0x23a),'product_details':{'prod_name':_0x18d796(0x1ff),'product_code':_0x18d796(0x228),'category':_0x18d796(0x24d),'brand':_0x18d796(0x222),'gross_price':_0x18d796(0x19f),'isFG':_0x18d796(0x110),'prod_cat':_0x18d796(0x129),'prod_id':_0x18d796(0x15b)}}}}},{'$unwind':_0x18d796(0x239)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x18d796(0x1ea),'customer':_0x18d796(0x121),'status_data':_0x18d796(0x119),'category':'$products.product_details.category','brand':_0x18d796(0x1d1),'prod_id':_0x18d796(0x259)},'totalQty':{'$sum':_0x18d796(0x1dd)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x18d796(0x1eb)]}},'NetPrice':{'$sum':_0x18d796(0x23e)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x18d796(0x16d)},'cash':{'$first':_0x18d796(0x132)},'amount':{'$first':_0x18d796(0x244)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x18d796(0x1e9)},'due_date':{'$first':_0x18d796(0x1a9)},'product_details':{'$first':_0x18d796(0x125)}}},{'$group':{'_id':{'dsi':_0x18d796(0x1a8),'date':_0x18d796(0x1ea),'customer':_0x18d796(0x121),'status_data':'$_id.status_data'},'totalQty':{'$sum':_0x18d796(0x1ae)},'totalGross':{'$sum':_0x18d796(0x1c8)},'NetPrice':{'$sum':_0x18d796(0x1c1)},'discount':{'$sum':_0x18d796(0xf1)},'adj_discount':{'$sum':_0x18d796(0x191)},'cash':{'$first':_0x18d796(0x132)},'amount':{'$first':_0x18d796(0x244)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x18d796(0x1a9)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x18d796(0xfe),'product_details':_0x18d796(0x213)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5c8e95=await sales_sa[_0x18d796(0x133)]([{'$match':{'date':_0xa41a2c,'sales_staff_id':_0x168785,'sale_product.isFG':_0x18d796(0x1d0)}},{'$unwind':_0x18d796(0x21b)},{'$lookup':{'from':_0x18d796(0x1bd),'localField':_0x18d796(0x247),'foreignField':'product_code','as':_0x18d796(0x221)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x18d796(0x209),'date':'$date','customer':_0x18d796(0x116)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':_0x18d796(0x132)},'amount':{'$first':_0x18d796(0x244)},'bank':{'$first':_0x18d796(0x1fa)},'check_no':{'$first':_0x18d796(0x1e9)},'due_date':{'$first':_0x18d796(0x1a9)},'products':{'$push':{'qty':_0x18d796(0x1b5),'NetPrice':_0x18d796(0x10f),'discount':_0x18d796(0x24a),'adj_discount':_0x18d796(0x23a),'product_details':{'prod_name':'$product_info.name','product_code':'$product_info.product_code','category':'$product_info.category','brand':'$product_info.brand','gross_price':_0x18d796(0x19f),'isFG':_0x18d796(0x110),'prod_cat':_0x18d796(0x129),'prod_id':_0x18d796(0x15b)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x18d796(0x1a8),'date':_0x18d796(0x1ea),'customer':_0x18d796(0x121),'category':_0x18d796(0x13f),'brand':_0x18d796(0x1d1),'prod_id':_0x18d796(0x259)},'totalQty':{'$sum':_0x18d796(0x1dd)},'cash':{'$first':_0x18d796(0x132)},'amount':{'$first':_0x18d796(0x244)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x18d796(0x1e9)},'due_date':{'$first':_0x18d796(0x1a9)},'totalGross':{'$sum':{'$multiply':[_0x18d796(0x1dd),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x18d796(0x23e)},'discount':{'$sum':_0x18d796(0x194)},'adj_discount':{'$sum':_0x18d796(0x16d)},'product_details':{'$first':_0x18d796(0x125)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x18d796(0x1ea),'customer':_0x18d796(0x121)},'totalQty':{'$sum':_0x18d796(0x1ae)},'cash':{'$first':'$cash'},'amount':{'$first':_0x18d796(0x244)},'bank':{'$first':_0x18d796(0x1fa)},'check_no':{'$first':_0x18d796(0x1e9)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':_0x18d796(0x1c8)},'NetPrice':{'$sum':_0x18d796(0x1c1)},'discount':{'$sum':_0x18d796(0xf1)},'adj_discount':{'$sum':_0x18d796(0x191)},'products':{'$push':{'qty':_0x18d796(0x1ae),'category':_0x18d796(0x11d),'brand':_0x18d796(0xfe),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x547022=await sales_sa[_0x18d796(0x133)]([{'$match':{'date':_0x33a8a0,'sales_staff_id':_0x168785,'status_data':_0x18d796(0x1f7)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x155d15=await staff[_0x18d796(0x1a2)](_0x168785);let _0x2e615a=[],_0x294e7a={},_0x35493c={};var _0x11fd3c=0x0,_0x52b4f3=0x0,_0x2dbb0a=0x0,_0x62df3=0x0,_0x4ccc15=0x0;const _0x506b29=0x6;var _0x34d4e2=0x0,_0x16ca15=0x0;for(let _0x2f9314=0x0;_0x2f9314<=_0xfea7af[_0x18d796(0x175)]-0x1;_0x2f9314++){const _0x4a2e0a=_0xfea7af[_0x2f9314];let _0x4ccf4e=_0x18d796(0x1b9);_0x4ccf4e+=_0x18d796(0x220),_0x4ccf4e+=_0x18d796(0x18f)+_0x4a2e0a[_0x18d796(0x130)][_0x18d796(0x1ec)]+'</td>',_0x4ccf4e+=_0x18d796(0x18f)+_0x4a2e0a['_id']['dsi']+'</td>';let _0x2ec50b={},_0xaef2dd={},_0xc53736={};var _0x5c1dd5={},_0xb09c86={},_0x3c4f4a={},_0x883844=0x0;for(let _0xfc329a=0x0;_0xfc329a<=_0x4a2e0a['products'][_0x18d796(0x175)]-0x1;_0xfc329a++){const _0x353fab=_0x4a2e0a[_0x18d796(0x1bd)][_0xfc329a];_0x2ec50b[_0x353fab[_0x18d796(0x20a)]+'-'+_0x353fab['category']]=_0x353fab[_0x18d796(0x23c)],_0xaef2dd[[_0x353fab['brand']+'-'+_0x353fab[_0x18d796(0x25e)]]]=_0x353fab[_0x18d796(0x1c5)][_0x18d796(0x18a)],_0xc53736[[_0x353fab[_0x18d796(0x20a)]+'-'+_0x353fab[_0x18d796(0x25e)]]]=_0x353fab[_0x18d796(0x1c5)]['prod_cat'];const _0x502ad2=_0x353fab[_0x18d796(0x20a)]+'-'+_0x353fab[_0x18d796(0x25e)];!Array[_0x18d796(0x1ac)](_0x35493c[_0x502ad2])&&(_0x35493c[_0x502ad2]=[]);!Array[_0x18d796(0x1ac)](_0x35493c[_0x502ad2])&&(_0x35493c[_0x502ad2]=[]);_0x35493c[_0x502ad2][_0x18d796(0x136)](_0x353fab[_0x18d796(0x23c)]);if(_0x353fab[_0x18d796(0x1c5)][_0x18d796(0x1f6)]=='P')_0x353fab[_0x18d796(0x1c5)][_0x18d796(0x18a)]==_0x18d796(0x1f7)?(!_0x3c4f4a[_0x502ad2]&&(_0x3c4f4a[_0x502ad2]=0x0),_0x3c4f4a[_0x502ad2]=_0x353fab['qty']):(!_0x5c1dd5[_0x502ad2]&&(_0x5c1dd5[_0x502ad2]=0x0),_0x5c1dd5[_0x502ad2]=_0x353fab[_0x18d796(0x23c)]);else _0x353fab[_0x18d796(0x1c5)][_0x18d796(0x1f6)]=='S'&&(_0x353fab['product_details'][_0x18d796(0x18a)]==_0x18d796(0x1f7)?(!_0x3c4f4a[_0x502ad2]&&(_0x3c4f4a[_0x502ad2]=0x0),_0x3c4f4a[_0x502ad2]=_0x353fab['qty']):(!_0xb09c86[_0x502ad2]&&(_0xb09c86[_0x502ad2]=0x0),_0xb09c86[_0x502ad2]=_0x353fab[_0x18d796(0x23c)]));_0x883844++;}for(let _0x182eb0=0x0;_0x182eb0<=_0xa97afc['cat_brand'][_0x18d796(0x175)]-0x1;_0x182eb0++){const _0x58b6f0=_0xa97afc['cat_brand'][_0x182eb0],_0x23d491=_0x58b6f0[_0x18d796(0x130)]['brand']+'-'+_0x58b6f0[_0x18d796(0x130)]['category'],_0x5a20be=_0xc53736[_0x23d491]!==undefined?_0xc53736[_0x23d491]:'NA';var _0x4cf3d4=_0x5c1dd5[_0x23d491]!==undefined?_0x5c1dd5[_0x23d491][_0x18d796(0xf2)](0x2):'',_0x359d98=_0xb09c86[_0x23d491]!==undefined?_0xb09c86[_0x23d491][_0x18d796(0xf2)](0x2):'',_0x7d76af=_0x3c4f4a[_0x23d491]!==undefined?_0x3c4f4a[_0x23d491]['toFixed'](0x2):'';_0x4ccf4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x4cf3d4+_0x18d796(0x15e),_0x4ccf4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x359d98+_0x18d796(0x15e),_0x4ccf4e+=_0x18d796(0x11a)+_0x7d76af+'</td>';}var _0x16d6be=formatNumber(parseFloat(_0x4a2e0a[_0x18d796(0x23b)])),_0x46b746=formatNumber(parseFloat(_0x4a2e0a[_0x18d796(0x1be)]));isNaN(_0x46b746)&&(_0x46b746=0x0),_0x4ccf4e+=_0x18d796(0x11a)+_0x16d6be+_0x18d796(0x15e),_0x4ccf4e+=_0x18d796(0x11a)+_0x46b746+'</td>',_0x4ccf4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4a2e0a[_0x18d796(0x1bc)]+_0x18d796(0x15e),_0x4ccf4e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4a2e0a[_0x18d796(0x1a5)]+'</td>',_0x4ccf4e+=_0x18d796(0x18f)+_0x4a2e0a[_0x18d796(0x111)]+_0x18d796(0x15e),_0x2dbb0a=_0x4a2e0a[_0x18d796(0x141)]+_0x4a2e0a['adj_discount'],_0x34d4e2+=parseFloat(_0x4a2e0a['cash']),_0x16ca15+=parseFloat(_0x46b746),_0x2e615a['push'](_0x4ccf4e);}function _0x3e9890(_0x23c21b,_0x40c416){const _0x30f7ee=_0x18d796,_0x1e8b3c=[];for(let _0x54f6e6=0x0;_0x54f6e6<=_0x23c21b[_0x30f7ee(0x175)]-0x1;_0x54f6e6+=_0x40c416){_0x1e8b3c['push'](_0x23c21b[_0x30f7ee(0x163)](_0x54f6e6,_0x54f6e6+_0x40c416));}return _0x1e8b3c;}const _0x3896f6=_0x3e9890(_0x2e615a,_0x506b29);let _0x586489='';return _0x3896f6[_0x18d796(0x1f1)]((_0x33f04a,_0x416f13)=>{const _0xf7b4fe=_0x18d796;_0x416f13>0x0&&(_0x586489+=_0xf7b4fe(0x160));_0x586489+='<table>',_0x586489+=_0xf7b4fe(0x227);const _0x3ee665=new Date(_0x33a8a0),_0x56211c={'year':_0xf7b4fe(0x174),'month':'long','day':_0xf7b4fe(0x174),'timeZone':'Asia/Manila'},_0x52b6c1=_0x3ee665[_0xf7b4fe(0x197)](_0xf7b4fe(0x164),_0x56211c);_0x586489+='<tr>',_0x586489+=_0xf7b4fe(0x151)+_0x2147c4+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x19e),_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x276)+_0x155d15[_0xf7b4fe(0x27b)]+_0xf7b4fe(0x15e),_0x586489+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>',_0x586489+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x586489+='<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>',_0x586489+=_0xf7b4fe(0x1e4),_0x586489+=_0xf7b4fe(0x277),_0x586489+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>',_0x586489+=_0xf7b4fe(0x124),_0x586489+='<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>',_0x586489+='</tr>',_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x120),_0x586489+=_0xf7b4fe(0x144)+_0x52b6c1+_0xf7b4fe(0x15e),_0x586489+=_0xf7b4fe(0x260),_0x586489+=_0xf7b4fe(0x17e),_0x586489+=_0xf7b4fe(0x214),_0x586489+=_0xf7b4fe(0x214),_0x586489+='</tr>',_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x18d),_0x586489+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0x586489+=_0xf7b4fe(0x172),_0x586489+=_0xf7b4fe(0x214),_0x586489+=_0xf7b4fe(0x214),_0x586489+=_0xf7b4fe(0x19e),_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x20b),_0x586489+='</tr>',_0x586489+=_0xf7b4fe(0x1b9),_0x586489+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x586489+=_0xf7b4fe(0x143),_0x586489+=_0xf7b4fe(0x19e),_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x12a),_0x586489+=_0xf7b4fe(0x245),_0x586489+=_0xf7b4fe(0x1da);for(let _0x20bf4f=0x0;_0x20bf4f<=_0x1fadf1[_0xf7b4fe(0x175)]-0x1;_0x20bf4f++){const _0x5187b5=_0x1fadf1[_0x20bf4f];for(let _0x1f0ac3=0x0;_0x1f0ac3<_0xa97afc[_0xf7b4fe(0x258)][_0xf7b4fe(0x175)];_0x1f0ac3++){const _0x3ba38c=_0xa97afc[_0xf7b4fe(0x258)][_0x1f0ac3];if(_0x3ba38c[_0xf7b4fe(0x130)][_0xf7b4fe(0x25e)]===_0x5187b5[_0xf7b4fe(0x130)]['category']){var _0x5b2c02='';switch(_0x5187b5[_0xf7b4fe(0x130)][_0xf7b4fe(0x25e)]){case _0xf7b4fe(0x25a):_0x5b2c02=_0x3ba38c[_0xf7b4fe(0x130)]['brand']+_0xf7b4fe(0x255);break;case _0xf7b4fe(0x243):_0x5b2c02=_0x3ba38c[_0xf7b4fe(0x130)][_0xf7b4fe(0x20a)]+'\x20-\x20HH';break;default:_0x5b2c02=_0x3ba38c[_0xf7b4fe(0x130)][_0xf7b4fe(0x20a)];break;}_0x586489+=_0xf7b4fe(0x1bb)+_0x5b2c02+'</b></td>';}}}_0x586489+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x586489+=_0xf7b4fe(0x16b),_0x586489+=_0xf7b4fe(0x230),_0x586489+=_0xf7b4fe(0x19e),_0x586489+='<tr>',_0x586489+=_0xf7b4fe(0x23f);for(let _0x25ce41=0x0;_0x25ce41<=_0xa97afc[_0xf7b4fe(0x258)][_0xf7b4fe(0x175)]-0x1;_0x25ce41++){const _0x1ea393=_0xa97afc[_0x25ce41];_0x586489+=_0xf7b4fe(0x1a3),_0x586489+=_0xf7b4fe(0x112),_0x586489+=_0xf7b4fe(0x11b);}_0x586489+=_0xf7b4fe(0x1bf),_0x586489+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>',_0x586489+=_0xf7b4fe(0x135),_0x586489+='</tr>',_0x586489+=_0xf7b4fe(0x181),_0x586489+=_0xf7b4fe(0x253),_0x33f04a[_0xf7b4fe(0x1f1)](_0x1a054a=>{_0x586489+=_0x1a054a;});let _0xb07a8e={},_0x1082d6={},_0x5f31c1={};for(let _0x4e75ba=0x0;_0x4e75ba<=_0xfea7af['length']-0x1;_0x4e75ba++){const _0x2c4eac=_0xfea7af[_0x4e75ba];var _0x318e09=0x0;for(let _0x21af53=0x0;_0x21af53<=_0x2c4eac[_0xf7b4fe(0x1bd)]['length']-0x1;_0x21af53++){const _0xf9cb66=_0x2c4eac[_0xf7b4fe(0x1bd)][_0x21af53],_0x4d5e0e=_0xf9cb66[_0xf7b4fe(0x20a)]+'-'+_0xf9cb66[_0xf7b4fe(0x25e)];if(_0xf9cb66[_0xf7b4fe(0x1c5)]['prod_cat']=='P')_0xf9cb66[_0xf7b4fe(0x1c5)][_0xf7b4fe(0x18a)]=='true'?(!_0x5f31c1[_0x4d5e0e]&&(_0x5f31c1[_0x4d5e0e]=0x0),_0x5f31c1[_0x4d5e0e]+=_0xf9cb66['qty']):(!_0xb07a8e[_0x4d5e0e]&&(_0xb07a8e[_0x4d5e0e]=0x0),_0xb07a8e[_0x4d5e0e]+=_0xf9cb66['qty']);else _0xf9cb66['product_details'][_0xf7b4fe(0x1f6)]=='S'&&(_0xf9cb66[_0xf7b4fe(0x1c5)][_0xf7b4fe(0x18a)]=='true'?(!_0x5f31c1[_0x4d5e0e]&&(_0x5f31c1[_0x4d5e0e]=0x0),_0x5f31c1[_0x4d5e0e]+=_0xf9cb66['qty'],console[_0xf7b4fe(0x127)](_0xf9cb66[_0xf7b4fe(0x23c)])):(!_0x1082d6[_0x4d5e0e]&&(_0x1082d6[_0x4d5e0e]=0x0),_0x1082d6[_0x4d5e0e]+=_0xf9cb66['qty']));_0x318e09++;}}let _0x4068fa={},_0x5bb6b8={},_0x4c3072={};var _0x5f0797=0x0,_0x5e1a48=0x0;for(let _0x13ce09=0x0;_0x13ce09<=_0x5c8e95[_0xf7b4fe(0x175)]-0x1;_0x13ce09++){const _0x51119c=_0x5c8e95[_0x13ce09];var _0x318e09=0x0;for(let _0x59229c=0x0;_0x59229c<=_0x51119c[_0xf7b4fe(0x1bd)][_0xf7b4fe(0x175)]-0x1;_0x59229c++){const _0x1765b7=_0x51119c[_0xf7b4fe(0x1bd)][_0x59229c],_0x380094=_0x1765b7[_0xf7b4fe(0x20a)]+'-'+_0x1765b7[_0xf7b4fe(0x25e)];if(_0x1765b7['product_details'][_0xf7b4fe(0x1f6)]=='P')_0x1765b7[_0xf7b4fe(0x1c5)][_0xf7b4fe(0x18a)]==_0xf7b4fe(0x1f7)?(!_0x4c3072[_0x380094]&&(_0x4c3072[_0x380094]=0x0),_0x4c3072[_0x380094]+=_0x1765b7[_0xf7b4fe(0x23c)]):(!_0x4068fa[_0x380094]&&(_0x4068fa[_0x380094]=0x0),_0x4068fa[_0x380094]+=_0x1765b7[_0xf7b4fe(0x23c)]);else _0x1765b7[_0xf7b4fe(0x1c5)][_0xf7b4fe(0x1f6)]=='S'&&(_0x1765b7[_0xf7b4fe(0x1c5)]['isFG']==_0xf7b4fe(0x1f7)?(!_0x4c3072[_0x380094]&&(_0x4c3072[_0x380094]=0x0),_0x4c3072[_0x380094]+=_0x1765b7[_0xf7b4fe(0x23c)]):(!_0x5bb6b8[_0x380094]&&(_0x5bb6b8[_0x380094]=0x0),_0x5bb6b8[_0x380094]+=_0x1765b7['qty']));_0x318e09++;}var _0xc291aa=parseFloat(_0x51119c['cash']),_0x143b47=parseFloat(_0x51119c[_0xf7b4fe(0x1be)]);isNaN(_0x143b47)&&(_0x143b47=0x0),_0x5f0797+=_0xc291aa,_0x5e1a48+=_0x143b47;}if(_0x547022[_0xf7b4fe(0x175)]>0x0)for(let _0x15d8b2=0x0;_0x15d8b2<=_0x547022[_0xf7b4fe(0x175)]-0x1;_0x15d8b2++){const _0x155906=_0x547022[_0x15d8b2];console[_0xf7b4fe(0x127)](_0x155906),_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x113)+(0x8+0x7*0x3)+_0xf7b4fe(0xf4)+_0x155906[_0xf7b4fe(0x22e)]+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x19e);}_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x1e8),_0x586489+=_0xf7b4fe(0x1a0),_0x586489+=_0xf7b4fe(0x220);for(let _0x3c66ce=0x0;_0x3c66ce<=_0xa97afc[_0xf7b4fe(0x258)][_0xf7b4fe(0x175)]-0x1;_0x3c66ce++){const _0x4b7a1f=_0xa97afc[_0xf7b4fe(0x258)][_0x3c66ce],_0x1369af=_0x4b7a1f['_id'][_0xf7b4fe(0x20a)]+'-'+_0x4b7a1f[_0xf7b4fe(0x130)][_0xf7b4fe(0x25e)];var _0x1712c7=_0xb07a8e[_0x1369af]!==undefined?formatNumber(_0xb07a8e[_0x1369af]['toFixed'](0x2)):'',_0x1f3087=_0x5f31c1[_0x1369af]!==undefined?formatNumber(_0x5f31c1[_0x1369af][_0xf7b4fe(0xf2)](0x2)):'',_0x297396=_0x1082d6[_0x1369af]!==undefined?formatNumber(_0x1082d6[_0x1369af][_0xf7b4fe(0xf2)](0x2)):'';_0x586489+=_0xf7b4fe(0x12c)+_0x1712c7+'</b></td>',_0x586489+=_0xf7b4fe(0x12c)+_0x297396+'</b></td>',_0x586489+=_0xf7b4fe(0x12c)+_0x1f3087+_0xf7b4fe(0x21e);}_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x34d4e2)+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x12c)+formatNumber(_0x16ca15)+_0xf7b4fe(0x21e),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x586489+=_0xf7b4fe(0x220),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x586489+=_0xf7b4fe(0x19e),_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x1e8),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>',_0x586489+=_0xf7b4fe(0x220);for(let _0x5a76b1=0x0;_0x5a76b1<=_0xa97afc[_0xf7b4fe(0x258)][_0xf7b4fe(0x175)]-0x1;_0x5a76b1++){const _0x259cde=_0xa97afc[_0xf7b4fe(0x258)][_0x5a76b1],_0x90549f=_0x259cde[_0xf7b4fe(0x130)][_0xf7b4fe(0x20a)]+'-'+_0x259cde['_id'][_0xf7b4fe(0x25e)];var _0x1712c7=_0x4068fa[_0x90549f]!==undefined?formatNumber(_0x4068fa[_0x90549f][_0xf7b4fe(0xf2)](0x2)):'',_0x1f3087=_0x4c3072[_0x90549f]!==undefined?formatNumber(_0x4c3072[_0x90549f][_0xf7b4fe(0xf2)](0x2)):'',_0x297396=_0x5bb6b8[_0x90549f]!==undefined?formatNumber(_0x5bb6b8[_0x90549f][_0xf7b4fe(0xf2)](0x2)):'';_0x586489+=_0xf7b4fe(0x12c)+_0x1712c7+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x12c)+_0x297396+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x12c)+_0x1f3087+_0xf7b4fe(0x21e);}_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5f0797)+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x12c)+formatNumber(_0x5e1a48)+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x19e),_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x1e8),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x586489+=_0xf7b4fe(0x220);let _0x153c4c=0x0,_0x238f7c=0x0,_0x3a45e0=0x0;for(let _0x4f7cd4=0x0;_0x4f7cd4<=_0xa97afc['cat_brand'][_0xf7b4fe(0x175)]-0x1;_0x4f7cd4++){const _0x58caac=_0xa97afc[_0xf7b4fe(0x258)][_0x4f7cd4],_0x557acc=_0x58caac[_0xf7b4fe(0x130)][_0xf7b4fe(0x20a)]+'-'+_0x58caac['_id'][_0xf7b4fe(0x25e)];var _0xe96573=_0xb07a8e[_0x557acc]!==undefined?_0xb07a8e[_0x557acc][_0xf7b4fe(0xf2)](0x2):'0',_0x2cb679=_0x5f31c1[_0x557acc]!==undefined?_0x5f31c1[_0x557acc][_0xf7b4fe(0xf2)](0x2):'0',_0x26501a=_0x1082d6[_0x557acc]!==undefined?_0x1082d6[_0x557acc][_0xf7b4fe(0xf2)](0x2):'0',_0x3ecb2e=_0x4068fa[_0x557acc]!==undefined?_0x4068fa[_0x557acc][_0xf7b4fe(0xf2)](0x2):'0',_0x4b1047=_0x4c3072[_0x557acc]!==undefined?_0x4c3072[_0x557acc][_0xf7b4fe(0xf2)](0x2):'0',_0x5865b1=_0x5bb6b8[_0x557acc]!==undefined?_0x5bb6b8[_0x557acc]['toFixed'](0x2):'0';_0x153c4c=parseFloat(_0xe96573)+parseFloat(_0x3ecb2e),_0x238f7c=parseFloat(_0x26501a)+parseFloat(_0x5865b1),_0x3a45e0=parseFloat(_0x2cb679)+parseFloat(_0x4b1047),_0x586489+=_0xf7b4fe(0x12c)+formatNumber(_0x153c4c[_0xf7b4fe(0xf2)](0x2))+_0xf7b4fe(0x21e),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x238f7c[_0xf7b4fe(0xf2)](0x2))+'</b></td>',_0x586489+=_0xf7b4fe(0x12c)+formatNumber(_0x3a45e0[_0xf7b4fe(0xf2)](0x2))+_0xf7b4fe(0x21e);}var _0x4a6670=formatNumber(_0x34d4e2+_0x5f0797),_0x3ecc9e=formatNumber(_0x16ca15+_0x5e1a48);_0x586489+=_0xf7b4fe(0x12c)+_0x4a6670+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x12c)+_0x3ecc9e+'</b></td>',_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x19e),_0x586489+='<tr>',_0x586489+=_0xf7b4fe(0x10e)+(_0xa97afc[_0xf7b4fe(0x258)][_0xf7b4fe(0x175)]*0x3+0x9)+_0xf7b4fe(0x215),_0x586489+=_0xf7b4fe(0x19e),_0x586489+='<tr>',_0x586489+=_0xf7b4fe(0x1e8),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x586489+=_0xf7b4fe(0x220);for(let _0x25855b=0x0;_0x25855b<=_0xa97afc[_0xf7b4fe(0x258)][_0xf7b4fe(0x175)]-0x1;_0x25855b++){const _0xff8615=_0xa97afc['cat_brand'][_0x25855b],_0x4a53c5=_0xff8615[_0xf7b4fe(0x130)][_0xf7b4fe(0x20a)]+'-'+_0xff8615[_0xf7b4fe(0x130)][_0xf7b4fe(0x25e)];var _0xe96573=_0xb07a8e[_0x4a53c5]!==undefined?_0xb07a8e[_0x4a53c5][_0xf7b4fe(0xf2)](0x2):'0',_0x2cb679=_0x5f31c1[_0x4a53c5]!==undefined?_0x5f31c1[_0x4a53c5][_0xf7b4fe(0xf2)](0x2):'0',_0x26501a=_0x1082d6[_0x4a53c5]!==undefined?_0x1082d6[_0x4a53c5][_0xf7b4fe(0xf2)](0x2):'0',_0x3ecb2e=_0x4068fa[_0x4a53c5]!==undefined?_0x4068fa[_0x4a53c5][_0xf7b4fe(0xf2)](0x2):'0',_0x4b1047=_0x4c3072[_0x4a53c5]!==undefined?_0x4c3072[_0x4a53c5]['toFixed'](0x2):'0',_0x5865b1=_0x5bb6b8[_0x4a53c5]!==undefined?_0x5bb6b8[_0x4a53c5][_0xf7b4fe(0xf2)](0x2):'0';_0x153c4c=parseFloat(_0xe96573)+parseFloat(_0x3ecb2e),_0x238f7c=parseFloat(_0x26501a)+parseFloat(_0x5865b1),_0x3a45e0=parseFloat(_0x2cb679)+parseFloat(_0x4b1047),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x586489+=_0xf7b4fe(0x10d),_0x586489+=_0xf7b4fe(0x10d);}_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x19e),_0x586489+='<tr>',_0x586489+=_0xf7b4fe(0x1e8),_0x586489+=_0xf7b4fe(0x21c),_0x586489+=_0xf7b4fe(0x220);for(let _0x2d0218=0x0;_0x2d0218<=_0xa97afc['cat_brand']['length']-0x1;_0x2d0218++){const _0x20e681=_0xa97afc[_0xf7b4fe(0x258)][_0x2d0218],_0x46229c=_0x20e681['_id'][_0xf7b4fe(0x20a)]+'-'+_0x20e681[_0xf7b4fe(0x130)][_0xf7b4fe(0x25e)];var _0xe96573=_0xb07a8e[_0x46229c]!==undefined?_0xb07a8e[_0x46229c][_0xf7b4fe(0xf2)](0x2):'0',_0x2cb679=_0x5f31c1[_0x46229c]!==undefined?_0x5f31c1[_0x46229c][_0xf7b4fe(0xf2)](0x2):'0',_0x26501a=_0x1082d6[_0x46229c]!==undefined?_0x1082d6[_0x46229c][_0xf7b4fe(0xf2)](0x2):'0',_0x3ecb2e=_0x4068fa[_0x46229c]!==undefined?_0x4068fa[_0x46229c]['toFixed'](0x2):'0',_0x4b1047=_0x4c3072[_0x46229c]!==undefined?_0x4c3072[_0x46229c][_0xf7b4fe(0xf2)](0x2):'0',_0x5865b1=_0x5bb6b8[_0x46229c]!==undefined?_0x5bb6b8[_0x46229c]['toFixed'](0x2):'0';_0x153c4c=parseFloat(_0xe96573)+parseFloat(_0x3ecb2e),_0x238f7c=parseFloat(_0x26501a)+parseFloat(_0x5865b1),_0x3a45e0=parseFloat(_0x2cb679)+parseFloat(_0x4b1047),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x19e),_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x1e8),_0x586489+=_0xf7b4fe(0x249),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x408c3e=0x0;_0x408c3e<=_0xa97afc['cat_brand'][_0xf7b4fe(0x175)]-0x1;_0x408c3e++){const _0x51f2aa=_0xa97afc[_0xf7b4fe(0x258)][_0x408c3e],_0x24447e=_0x51f2aa[_0xf7b4fe(0x130)]['brand']+'-'+_0x51f2aa[_0xf7b4fe(0x130)][_0xf7b4fe(0x25e)];var _0xe96573=_0xb07a8e[_0x24447e]!==undefined?_0xb07a8e[_0x24447e][_0xf7b4fe(0xf2)](0x2):'0',_0x2cb679=_0x5f31c1[_0x24447e]!==undefined?_0x5f31c1[_0x24447e][_0xf7b4fe(0xf2)](0x2):'0',_0x26501a=_0x1082d6[_0x24447e]!==undefined?_0x1082d6[_0x24447e][_0xf7b4fe(0xf2)](0x2):'0',_0x3ecb2e=_0x4068fa[_0x24447e]!==undefined?_0x4068fa[_0x24447e][_0xf7b4fe(0xf2)](0x2):'0',_0x4b1047=_0x4c3072[_0x24447e]!==undefined?_0x4c3072[_0x24447e][_0xf7b4fe(0xf2)](0x2):'0',_0x5865b1=_0x5bb6b8[_0x24447e]!==undefined?_0x5bb6b8[_0x24447e][_0xf7b4fe(0xf2)](0x2):'0';_0x153c4c=parseFloat(_0xe96573)+parseFloat(_0x3ecb2e),_0x238f7c=parseFloat(_0x26501a)+parseFloat(_0x5865b1),_0x3a45e0=parseFloat(_0x2cb679)+parseFloat(_0x4b1047),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x586489+=_0xf7b4fe(0x10d);}_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+='</tr>',_0x586489+=_0xf7b4fe(0x1b9),_0x586489+=_0xf7b4fe(0x1e8),_0x586489+=_0xf7b4fe(0x1a0),_0x586489+=_0xf7b4fe(0x220);for(let _0x2ae7ab=0x0;_0x2ae7ab<=_0xa97afc[_0xf7b4fe(0x258)]['length']-0x1;_0x2ae7ab++){const _0x2c241a=_0xa97afc[_0xf7b4fe(0x258)][_0x2ae7ab],_0x14b1e2=_0x2c241a[_0xf7b4fe(0x130)]['brand']+'-'+_0x2c241a['_id'][_0xf7b4fe(0x25e)];var _0xe96573=_0xb07a8e[_0x14b1e2]!==undefined?_0xb07a8e[_0x14b1e2][_0xf7b4fe(0xf2)](0x2):'',_0x2cb679=_0x5f31c1[_0x14b1e2]!==undefined?_0x5f31c1[_0x14b1e2][_0xf7b4fe(0xf2)](0x2):'',_0x26501a=_0x1082d6[_0x14b1e2]!==undefined?_0x1082d6[_0x14b1e2][_0xf7b4fe(0xf2)](0x2):'',_0x3ecb2e=_0x4068fa[_0x14b1e2]!==undefined?_0x4068fa[_0x14b1e2][_0xf7b4fe(0xf2)](0x2):'',_0x4b1047=_0x4c3072[_0x14b1e2]!==undefined?_0x4c3072[_0x14b1e2][_0xf7b4fe(0xf2)](0x2):'',_0x5865b1=_0x5bb6b8[_0x14b1e2]!==undefined?_0x5bb6b8[_0x14b1e2]['toFixed'](0x2):'';_0x153c4c=formatNumber(parseFloat(_0xe96573)+parseFloat(_0x3ecb2e)),_0x238f7c=formatNumber(parseFloat(_0x26501a)+parseFloat(_0x5865b1)),_0x3a45e0=formatNumber(parseFloat(_0x2cb679)+parseFloat(_0x4b1047)),_0x586489+=_0xf7b4fe(0x12c)+_0xe96573+_0xf7b4fe(0x21e),_0x586489+=_0xf7b4fe(0x12c)+_0x26501a+'</b></td>',_0x586489+=_0xf7b4fe(0x12c)+_0x2cb679+_0xf7b4fe(0x21e);}_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+='</tr>',_0x586489+=_0xf7b4fe(0x1b9),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x586489+=_0xf7b4fe(0x105),_0x586489+=_0xf7b4fe(0x220);for(let _0x3e2fe5=0x0;_0x3e2fe5<=_0xa97afc[_0xf7b4fe(0x258)][_0xf7b4fe(0x175)]-0x1;_0x3e2fe5++){const _0x446107=_0xa97afc[_0xf7b4fe(0x258)][_0x3e2fe5],_0x1ee0f2=_0x446107[_0xf7b4fe(0x130)][_0xf7b4fe(0x20a)]+'-'+_0x446107['_id']['category'];var _0xe96573=_0xb07a8e[_0x1ee0f2]!==undefined?_0xb07a8e[_0x1ee0f2]['toFixed'](0x2):'0',_0x2cb679=_0x5f31c1[_0x1ee0f2]!==undefined?_0x5f31c1[_0x1ee0f2][_0xf7b4fe(0xf2)](0x2):'0',_0x26501a=_0x1082d6[_0x1ee0f2]!==undefined?_0x1082d6[_0x1ee0f2][_0xf7b4fe(0xf2)](0x2):'0',_0x3ecb2e=_0x4068fa[_0x1ee0f2]!==undefined?_0x4068fa[_0x1ee0f2][_0xf7b4fe(0xf2)](0x2):'0',_0x4b1047=_0x4c3072[_0x1ee0f2]!==undefined?_0x4c3072[_0x1ee0f2][_0xf7b4fe(0xf2)](0x2):'0',_0x5865b1=_0x5bb6b8[_0x1ee0f2]!==undefined?_0x5bb6b8[_0x1ee0f2][_0xf7b4fe(0xf2)](0x2):'0';_0x153c4c=parseFloat(_0xe96573)+parseFloat(_0x3ecb2e),_0x238f7c=parseFloat(_0x26501a)+parseFloat(_0x5865b1),_0x3a45e0=parseFloat(_0x2cb679)+parseFloat(_0x4b1047),_0x586489+=_0xf7b4fe(0x10d),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x586489+=_0xf7b4fe(0x10d);}_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+=_0xf7b4fe(0x220),_0x586489+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x586489+=_0xf7b4fe(0x19e),_0x586489+=_0xf7b4fe(0x1b2),_0x586489+=_0xf7b4fe(0x1ab);}),_0x586489;}async function generateReferenceNumber(_0xea77a,_0x5945f5,_0x348304){const _0xa2eb41=a0_0x5e81ee,_0x441bc3=new Date(_0xea77a)[_0xa2eb41(0x154)](),_0x258fca=('0'+(new Date(_0xea77a)[_0xa2eb41(0x27a)]()+0x1))['slice'](-0x2),_0x3303e2=('0'+new Date(_0xea77a)['getDate']())['slice'](-0x2),_0x35a1cb=await staff['findOne']({'email':_0x348304[_0xa2eb41(0x102)]}),_0x5e12d6=_0x35a1cb['sales_man_code'],_0xbced81=_0x5e12d6+'-'+_0x441bc3+_0x258fca+_0x3303e2,_0x5b9b74=await Reference[_0xa2eb41(0x189)]({'referenceNumber':new RegExp('^'+_0xbced81),'salesman_code':_0x5e12d6})['sort']({'createdAt':-0x1}),_0x5031a7=_0xbced81;_0x5b9b74&&(_0x5031a7=_0x5b9b74[_0xa2eb41(0x131)]);console[_0xa2eb41(0x127)](_0x5031a7);const _0x2aee14=new Reference({'referenceNumber':_0x5031a7,'staff_id':_0x5945f5,'salesman_code':_0x5e12d6});return await _0x2aee14[_0xa2eb41(0x15a)](),_0x5031a7;}router[a0_0x5e81ee(0x1cc)](a0_0x5e81ee(0x1c6),auth,async(_0x2ad683,_0x262c91)=>{const _0x1e451e=a0_0x5e81ee,{from_date:_0x59fb44}=_0x2ad683[_0x1e451e(0x24f)],_0x5c352c=_0x2ad683[_0x1e451e(0x26f)],_0x2f080a=await staff['findOne']({'email':_0x5c352c[_0x1e451e(0x102)]}),_0x1d43a5=await master_shop[_0x1e451e(0x183)](),_0xd68725='';var _0x1bb85d=new Date(_0x59fb44);const _0x39f36c={'year':_0x1e451e(0x174),'month':_0x1e451e(0x11c),'day':'numeric'},_0x3abc5=new Intl[(_0x1e451e(0x251))](_0x1e451e(0x164),_0x39f36c)[_0x1e451e(0xee)](_0x1bb85d),_0x2522b4=await Reference[_0x1e451e(0x183)]({'staff_id':_0x2f080a['_id'][_0x1e451e(0x265)](),'date_include':_0x59fb44});if(_0x2522b4[_0x1e451e(0x175)]>0x0){let _0x243739='';_0x243739+=_0x2522b4[0x0]['html'];const _0x557a24=cheerio['load'](_0x243739);let _0x504343=[],_0x1d95cf=[],_0xbe19ff=[];const _0xbf3edb=_0x4106e6=>{const _0x19cf2f=_0x1e451e,_0x4f5e5c={'top':{'style':_0x19cf2f(0x14b),'color':{'rgb':_0x19cf2f(0x274)}},'bottom':{'style':_0x19cf2f(0x14b),'color':{'rgb':_0x19cf2f(0x274)}},'left':{'style':_0x19cf2f(0x14b),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x19cf2f(0x274)}}};if(_0x4106e6){const _0x4ec7f6=_0x4106e6[_0x19cf2f(0x1d5)](';')['reduce']((_0x17c7ab,_0xec485f)=>{const _0x17350a=_0x19cf2f,[_0x4cc921,_0x4de2f5]=_0xec485f[_0x17350a(0x1d5)](':')['map'](_0x4af9a6=>_0x4af9a6[_0x17350a(0x1a1)]());return _0x17c7ab[_0x4cc921]=_0x4de2f5,_0x17c7ab;},{});_0x4ec7f6[_0x19cf2f(0x231)]&&(_0x4f5e5c[_0x19cf2f(0x229)][_0x19cf2f(0x128)]=_0x4ec7f6[_0x19cf2f(0x231)][_0x19cf2f(0x199)](_0x19cf2f(0x26d))?_0x19cf2f(0x26d):_0x19cf2f(0x273)),_0x4ec7f6[_0x19cf2f(0x200)]&&(_0x4f5e5c[_0x19cf2f(0x18c)][_0x19cf2f(0x128)]=_0x4ec7f6[_0x19cf2f(0x200)][_0x19cf2f(0x199)](_0x19cf2f(0x26d))?_0x19cf2f(0x26d):'medium'),_0x4ec7f6[_0x19cf2f(0x270)]&&(_0x4f5e5c[_0x19cf2f(0x103)][_0x19cf2f(0x128)]=_0x4ec7f6[_0x19cf2f(0x270)][_0x19cf2f(0x199)](_0x19cf2f(0x26d))?'thin':'medium'),_0x4ec7f6[_0x19cf2f(0x202)]&&(_0x4f5e5c[_0x19cf2f(0x188)]['style']=_0x4ec7f6['border-right']['includes'](_0x19cf2f(0x26d))?_0x19cf2f(0x26d):'medium');}return _0x4f5e5c;};_0x557a24(_0x1e451e(0x17a))['each']((_0xf64dae,_0x5badae)=>{const _0x494d80=_0x1e451e;let _0x3a9ee1=[],_0x1cc4b2=0x0;while(_0xbe19ff[_0x1cc4b2]){_0xbe19ff[_0x1cc4b2]--,_0x1cc4b2++;}_0x557a24(_0x5badae)['find']('td,\x20th')[_0x494d80(0x219)]((_0x4f5e23,_0x1fb032)=>{const _0x103ab9=_0x494d80;let _0x585e44=_0x557a24(_0x1fb032)['text']()['trim'](),_0x6e70f=parseFloat(_0x585e44[_0x103ab9(0x108)](/,/g,''));isNaN(_0x6e70f)&&(_0x6e70f=_0x585e44);let _0xf5d1a9=parseInt(_0x557a24(_0x1fb032)[_0x103ab9(0x1b4)]('colspan'))||0x1,_0x358cb5=parseInt(_0x557a24(_0x1fb032)[_0x103ab9(0x1b4)]('rowspan'))||0x1;const _0x235fb1=_0x557a24(_0x1fb032)[_0x103ab9(0x1b4)]('style'),_0x5202d7=_0xbf3edb(_0x235fb1);_0x3a9ee1[_0x1cc4b2]={'v':_0x6e70f,'s':{'border':_0x5202d7}};(_0xf5d1a9>0x1||_0x358cb5>0x1)&&_0x1d95cf[_0x103ab9(0x136)]({'s':{'r':_0xf64dae,'c':_0x1cc4b2},'e':{'r':_0xf64dae+_0x358cb5-0x1,'c':_0x1cc4b2+_0xf5d1a9-0x1}});for(let _0x5b42e4=0x0;_0x5b42e4<_0xf5d1a9;_0x5b42e4++){_0x358cb5>0x1&&(_0xbe19ff[_0x1cc4b2+_0x5b42e4]=_0x358cb5-0x1);}_0x1cc4b2+=_0xf5d1a9;}),_0x504343[_0x494d80(0x136)](_0x3a9ee1);});const _0x5e7dd4=XLSX[_0x1e451e(0x1ad)][_0x1e451e(0x1c4)](),_0x197af9=XLSX['utils'][_0x1e451e(0x20d)](_0x504343);_0x1d95cf[_0x1e451e(0x175)]>0x0&&(_0x197af9[_0x1e451e(0x1e7)]=_0x1d95cf);_0x197af9['!cols']=_0x504343[0x0][_0x1e451e(0x10a)](()=>({'wpx':0x64})),XLSX[_0x1e451e(0x1ad)][_0x1e451e(0x1af)](_0x5e7dd4,_0x197af9,_0x1e451e(0xf8));const _0x43d1ef=XLSX['write'](_0x5e7dd4,{'bookType':_0x1e451e(0x1f0),'type':_0x1e451e(0x24c)});_0x262c91[_0x1e451e(0x226)](_0x1e451e(0x1cb),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x262c91['setHeader']('Content-Type',_0x1e451e(0x1f9)),_0x262c91[_0x1e451e(0x156)](_0x43d1ef);}else generateReferenceNumber(_0x59fb44,_0x2f080a[_0x1e451e(0x130)]['valueOf'](),_0x5c352c)[_0x1e451e(0x24e)](async _0x2451b3=>{const _0x386fe1=_0x1e451e,_0x28026=await agentsdataDSICheck_DSRR(_0x59fb44,_0x2f080a[_0x386fe1(0x130)][_0x386fe1(0x265)](),_0xd68725,_0x2451b3);let _0x4d231e=_0x386fe1(0x263);_0x4d231e+=_0x386fe1(0x1ef),_0x4d231e+=_0x386fe1(0x12b),_0x4d231e+='<table>',_0x4d231e+=_0x28026,_0x4d231e+='</table>',_0x4d231e+=_0x386fe1(0x1db),_0x4d231e+='</div>';if(_0x28026[_0x386fe1(0x175)]>0x0){const _0x332188=await Reference['findOne']({'staff_id':_0x2f080a[_0x386fe1(0x130)]['valueOf'](),'referenceNumber':_0x2451b3});_0x332188[_0x386fe1(0x1ca)]=_0x4d231e,_0x332188[_0x386fe1(0x1c9)]=_0x59fb44,await _0x332188[_0x386fe1(0x15a)]();const _0x22fd61=cheerio['load'](_0x4d231e);let _0x4a54b5=[],_0xacab3f=[],_0x16cd9d=[];const _0x10d1ed=_0x2a86bc=>{const _0x3bb327=_0x386fe1,_0x1fa7c1={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0x3bb327(0x14b),'color':{'rgb':'000000'}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':_0x3bb327(0x14b),'color':{'rgb':_0x3bb327(0x274)}}};if(_0x2a86bc){const _0xb54de6=_0x2a86bc[_0x3bb327(0x1d5)](';')['reduce']((_0x4465c0,_0x15aecb)=>{const _0x43dabc=_0x3bb327,[_0x394b18,_0x1dfcb6]=_0x15aecb['split'](':')[_0x43dabc(0x10a)](_0x3b195d=>_0x3b195d[_0x43dabc(0x1a1)]());return _0x4465c0[_0x394b18]=_0x1dfcb6,_0x4465c0;},{});_0xb54de6['border-top']&&(_0x1fa7c1[_0x3bb327(0x229)]['style']=_0xb54de6[_0x3bb327(0x231)][_0x3bb327(0x199)]('thin')?_0x3bb327(0x26d):_0x3bb327(0x273)),_0xb54de6[_0x3bb327(0x200)]&&(_0x1fa7c1[_0x3bb327(0x18c)][_0x3bb327(0x128)]=_0xb54de6[_0x3bb327(0x200)][_0x3bb327(0x199)](_0x3bb327(0x26d))?_0x3bb327(0x26d):_0x3bb327(0x273)),_0xb54de6[_0x3bb327(0x270)]&&(_0x1fa7c1[_0x3bb327(0x103)][_0x3bb327(0x128)]=_0xb54de6[_0x3bb327(0x270)][_0x3bb327(0x199)]('thin')?_0x3bb327(0x26d):_0x3bb327(0x273)),_0xb54de6[_0x3bb327(0x202)]&&(_0x1fa7c1[_0x3bb327(0x188)]['style']=_0xb54de6[_0x3bb327(0x202)][_0x3bb327(0x199)](_0x3bb327(0x26d))?'thin':'medium');}return _0x1fa7c1;};_0x22fd61(_0x386fe1(0x17a))[_0x386fe1(0x219)]((_0x43c107,_0x2b4db6)=>{const _0x414369=_0x386fe1;let _0x7387a9=[],_0xf8fb88=0x0;while(_0x16cd9d[_0xf8fb88]){_0x16cd9d[_0xf8fb88]--,_0xf8fb88++;}_0x22fd61(_0x2b4db6)['find'](_0x414369(0x140))[_0x414369(0x219)]((_0x410e5c,_0x36aba0)=>{const _0x5d9db2=_0x414369;let _0x4cb97a=_0x22fd61(_0x36aba0)[_0x5d9db2(0x21a)]()[_0x5d9db2(0x1a1)](),_0x3e626e=parseFloat(_0x4cb97a[_0x5d9db2(0x108)](/,/g,''));isNaN(_0x3e626e)&&(_0x3e626e=_0x4cb97a);let _0x1be0bf=parseInt(_0x22fd61(_0x36aba0)[_0x5d9db2(0x1b4)](_0x5d9db2(0x211)))||0x1,_0x2f2ff4=parseInt(_0x22fd61(_0x36aba0)[_0x5d9db2(0x1b4)](_0x5d9db2(0x15d)))||0x1;const _0x1847db=_0x22fd61(_0x36aba0)[_0x5d9db2(0x1b4)](_0x5d9db2(0x128)),_0x4fb043=_0x10d1ed(_0x1847db);_0x7387a9[_0xf8fb88]={'v':_0x3e626e,'s':{'border':_0x4fb043}};(_0x1be0bf>0x1||_0x2f2ff4>0x1)&&_0xacab3f[_0x5d9db2(0x136)]({'s':{'r':_0x43c107,'c':_0xf8fb88},'e':{'r':_0x43c107+_0x2f2ff4-0x1,'c':_0xf8fb88+_0x1be0bf-0x1}});for(let _0x27fe9e=0x0;_0x27fe9e<_0x1be0bf;_0x27fe9e++){_0x2f2ff4>0x1&&(_0x16cd9d[_0xf8fb88+_0x27fe9e]=_0x2f2ff4-0x1);}_0xf8fb88+=_0x1be0bf;}),_0x4a54b5['push'](_0x7387a9);});const _0x1690a6=XLSX[_0x386fe1(0x1ad)][_0x386fe1(0x1c4)](),_0x2cde3e=XLSX[_0x386fe1(0x1ad)]['aoa_to_sheet'](_0x4a54b5);_0xacab3f[_0x386fe1(0x175)]>0x0&&(_0x2cde3e['!merges']=_0xacab3f);_0x2cde3e[_0x386fe1(0x123)]=_0x4a54b5[0x0][_0x386fe1(0x10a)](()=>({'wpx':0x64})),XLSX[_0x386fe1(0x1ad)][_0x386fe1(0x1af)](_0x1690a6,_0x2cde3e,_0x386fe1(0xf8));const _0x4151e3=XLSX['write'](_0x1690a6,{'bookType':'xlsx','type':'buffer'});_0x262c91[_0x386fe1(0x226)](_0x386fe1(0x1cb),_0x386fe1(0x182)),_0x262c91[_0x386fe1(0x226)](_0x386fe1(0x22d),_0x386fe1(0x1f9)),_0x262c91[_0x386fe1(0x156)](_0x4151e3);}else await Reference[_0x386fe1(0x1ee)]({'referenceNumber':_0x2451b3}),_0x2ad683['flash'](_0x386fe1(0x14c),_0x386fe1(0x115)),_0x262c91[_0x386fe1(0x157)](_0x386fe1(0x193));})['catch'](console[_0x1e451e(0x22c)]);}),router[a0_0x5e81ee(0x100)](a0_0x5e81ee(0x186),auth,async(_0x205738,_0x31c661)=>{const _0x6025dc=a0_0x5e81ee;try{const {username:_0x179a21,email:_0x4ba1cb,role:_0x56a98b}=_0x205738[_0x6025dc(0x26f)],_0x1d7672=_0x205738['user'],_0xd11ae2=await profile[_0x6025dc(0x189)]({'email':_0x1d7672[_0x6025dc(0x102)]}),_0x287ca6={'year':_0x6025dc(0x174),'month':_0x6025dc(0x11c),'day':_0x6025dc(0x174)},_0x4a2ac7=await master_shop[_0x6025dc(0x183)]();console[_0x6025dc(0x127)](_0x6025dc(0x1de),_0x4a2ac7);const _0x49cfe3=await product[_0x6025dc(0x183)]();console[_0x6025dc(0x127)](_0x6025dc(0x107),_0x49cfe3);const _0x4712f0=await warehouse[_0x6025dc(0x133)]([{'$unwind':_0x6025dc(0x213)},{'$lookup':{'from':_0x6025dc(0x1bd),'localField':'product_details.product_name','foreignField':'name','as':_0x6025dc(0x16a)}},{'$unwind':_0x6025dc(0x21f)},{'$project':{'product_name':_0x6025dc(0x1f4),'product_stock':_0x6025dc(0x17b)}},{'$group':{'_id':_0x6025dc(0x1fd),'product_stock':{'$sum':'$product_stock'}}}]);console['log'](_0x6025dc(0x235),_0x4712f0),_0x4712f0[_0x6025dc(0x1f1)](_0x274c31=>{const _0x46a573=_0x6025dc,_0x3cc717=_0x49cfe3[_0x46a573(0x10a)](_0x5e09c0=>{const _0x5255b3=_0x46a573;_0x5e09c0['name']==_0x274c31['_id']&&(_0x5e09c0[_0x5255b3(0x178)]=parseInt(_0x5e09c0[_0x5255b3(0x178)])+parseInt(_0x274c31[_0x5255b3(0x176)]));});});const _0x1a22ef=await staff[_0x6025dc(0x183)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x346b4e=await staff[_0x6025dc(0x189)]({'email':_0x1d7672[_0x6025dc(0x102)]});if(_0x4a2ac7[0x0][_0x6025dc(0x1d7)]==_0x6025dc(0x14a))var _0x431aa8=users[_0x6025dc(0x1cd)];else{if(_0x4a2ac7[0x0]['language']=='Hindi')var _0x431aa8=users[_0x6025dc(0x12e)];else{if(_0x4a2ac7[0x0][_0x6025dc(0x1d7)]==_0x6025dc(0x1c7))var _0x431aa8=users['German'];else{if(_0x4a2ac7[0x0][_0x6025dc(0x1d7)]==_0x6025dc(0x1d9))var _0x431aa8=users['Spanish'];else{if(_0x4a2ac7[0x0][_0x6025dc(0x1d7)]==_0x6025dc(0x22f))var _0x431aa8=users[_0x6025dc(0x22f)];else{if(_0x4a2ac7[0x0][_0x6025dc(0x1d7)]==_0x6025dc(0x139))var _0x431aa8=users[_0x6025dc(0x149)];else{if(_0x4a2ac7[0x0][_0x6025dc(0x1d7)]==_0x6025dc(0x148))var _0x431aa8=users['Chinese'];else{if(_0x4a2ac7[0x0][_0x6025dc(0x1d7)]==_0x6025dc(0xef))var _0x431aa8=users[_0x6025dc(0x1ed)];}}}}}}}_0x31c661[_0x6025dc(0x18e)](_0x6025dc(0x1d8),{'success':_0x205738[_0x6025dc(0x187)](_0x6025dc(0x1b0)),'errors':_0x205738[_0x6025dc(0x187)](_0x6025dc(0x14c)),'alldata':_0x49cfe3,'profile':_0xd11ae2,'master_shop':_0x4a2ac7,'role':_0x1d7672,'product_stock':_0x4712f0,'language':_0x431aa8,'staff_arr':_0x346b4e,'staff_data_all':_0x1a22ef});}catch(_0x8c1be5){}}),router[a0_0x5e81ee(0x1cc)](a0_0x5e81ee(0x1b7),auth,async(_0x1fc659,_0x2fb2f3)=>{const _0x24dc43=a0_0x5e81ee;try{const {from:_0x10ad14,to:_0x3134cb,staff_data:_0x28cef4}=_0x1fc659[_0x24dc43(0x24f)],_0x1af2dd=await Reference[_0x24dc43(0x133)]([{'$match':{'date_include':{'$gte':_0x10ad14,'$lte':_0x3134cb},'staff_id':_0x28cef4}},{'$sort':{'date_include':0x1}}]);_0x2fb2f3['json'](_0x1af2dd);}catch(_0x44c889){_0x2fb2f3[_0x24dc43(0x241)](_0x44c889);}}),router[a0_0x5e81ee(0x100)](a0_0x5e81ee(0x1a4),auth,async(_0x56d6a5,_0x4249c8)=>{const _0x49ba71=a0_0x5e81ee;try{const _0x55f12b=_0x56d6a5['params']['id'],_0x326f1d=await Reference['findById'](_0x55f12b);_0x4249c8[_0x49ba71(0x156)](_0x326f1d[_0x49ba71(0x1ca)]);}catch(_0x4ce012){_0x4249c8[_0x49ba71(0x241)](_0x4ce012);}}),router['post']('/dl_excel',auth,async(_0x444602,_0x5d28ad)=>{const _0x5ce34a=a0_0x5e81ee;try{const {ref_data:_0x57eada}=_0x444602['body'],_0x1dcd73=_0x57eada[_0x5ce34a(0x1d5)]('~'),_0x2710ea=_0x1dcd73['filter'](_0x706b4f=>_0x706b4f!==''),_0x3e9c95=await Reference[_0x5ce34a(0x133)]([{'$match':{'referenceNumber':{'$in':_0x2710ea}}}]),_0x55172a=XLSX[_0x5ce34a(0x1ad)]['book_new']();_0x3e9c95['forEach'](_0x1b655c=>{const _0x211e5e=_0x5ce34a,_0x382546=cheerio['load'](_0x1b655c['html']);let _0x2c73f8=[],_0x157ea8=[],_0x5d9c66=[];_0x382546(_0x211e5e(0x17a))[_0x211e5e(0x219)]((_0xc05929,_0x43ccb2)=>{const _0x305f65=_0x211e5e;let _0x3f17a0=[],_0x1e617e=0x0;while(_0x5d9c66[_0x1e617e]){_0x5d9c66[_0x1e617e]--,_0x1e617e++;}_0x382546(_0x43ccb2)[_0x305f65(0x183)](_0x305f65(0x140))['each']((_0x2f224c,_0x1dc706)=>{const _0x400c5e=_0x305f65;let _0x46ccd9=_0x382546(_0x1dc706)[_0x400c5e(0x21a)]()['trim'](),_0x2ea3f7=parseFloat(_0x46ccd9[_0x400c5e(0x108)](/,/g,''));isNaN(_0x2ea3f7)&&(_0x2ea3f7=_0x46ccd9);let _0x34c76e=parseInt(_0x382546(_0x1dc706)[_0x400c5e(0x1b4)]('colspan'))||0x1,_0x47904d=parseInt(_0x382546(_0x1dc706)[_0x400c5e(0x1b4)](_0x400c5e(0x15d)))||0x1;_0x3f17a0[_0x1e617e]=_0x2ea3f7;(_0x34c76e>0x1||_0x47904d>0x1)&&_0x157ea8[_0x400c5e(0x136)]({'s':{'r':_0xc05929,'c':_0x1e617e},'e':{'r':_0xc05929+_0x47904d-0x1,'c':_0x1e617e+_0x34c76e-0x1}});for(let _0xe30db=0x0;_0xe30db<_0x34c76e;_0xe30db++){_0x47904d>0x1&&(_0x5d9c66[_0x1e617e+_0xe30db]=_0x47904d-0x1);}_0x1e617e+=_0x34c76e;}),_0x2c73f8[_0x305f65(0x136)](_0x3f17a0);});const _0x1066d7=XLSX[_0x211e5e(0x1ad)][_0x211e5e(0x20d)](_0x2c73f8);_0x157ea8[_0x211e5e(0x175)]>0x0&&(_0x1066d7[_0x211e5e(0x1e7)]=_0x157ea8),_0x1066d7[_0x211e5e(0x123)]=_0x2c73f8[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x211e5e(0x1af)](_0x55172a,_0x1066d7,_0x1b655c[_0x211e5e(0x131)]);});const _0x4b5dba=XLSX[_0x5ce34a(0xed)](_0x55172a,{'bookType':_0x5ce34a(0x1f0),'type':_0x5ce34a(0x24c)});_0x5d28ad['setHeader'](_0x5ce34a(0x1cb),_0x5ce34a(0x1d2)),_0x5d28ad['setHeader'](_0x5ce34a(0x22d),_0x5ce34a(0x1f9)),_0x5d28ad[_0x5ce34a(0x156)](_0x4b5dba);}catch(_0x1dd8b9){_0x5d28ad[_0x5ce34a(0x241)](_0x1dd8b9);}}),router['post']('/dsrr_admin/pdf_admin',auth,async(_0x182bb8,_0x144a4d)=>{const _0x50134b=a0_0x5e81ee,{from_date:_0x24feb2,agent_id:_0x54e414}=_0x182bb8[_0x50134b(0x24f)],_0x5e4052=_0x182bb8[_0x50134b(0x26f)],_0x4e86df=await staff[_0x50134b(0x189)]({'email':_0x5e4052[_0x50134b(0x102)]}),_0x28f094=await master_shop[_0x50134b(0x183)](),_0x140619=await agentsdataDSICheck_DSRR(_0x24feb2,_0x54e414,_0x5ba4b4);let _0x46c550=_0x50134b(0x147);var _0x40131f=new Date(_0x24feb2);const _0x445687={'year':_0x50134b(0x174),'month':_0x50134b(0x11c),'day':_0x50134b(0x174)},_0x4bcabe=new Intl[(_0x50134b(0x251))](_0x50134b(0x164),_0x445687)[_0x50134b(0xee)](_0x40131f);_0x46c550+=_0x50134b(0x1ef),_0x46c550+='<div\x20\x20id=\x22table-conatainer\x22>',_0x46c550+=_0x50134b(0x150),_0x46c550+=_0x140619,_0x46c550+=_0x50134b(0x1ab),_0x46c550+=_0x50134b(0x1db),_0x46c550+=_0x50134b(0x1db);let _0x10a161=_0x50134b(0x13c);const _0x64275e={'width':_0x50134b(0x278),'height':_0x50134b(0x218),'orientation':_0x50134b(0x279),'border':{'top':_0x50134b(0x1e5),'right':_0x50134b(0x1e5),'bottom':_0x50134b(0x1e5),'left':_0x50134b(0x1e5)},'header':{'height':_0x50134b(0x22a),'contents':_0x50134b(0x19c)+_0x10a161+_0x50134b(0x217)+_0x4bcabe+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x50134b(0x1c0),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};var _0x5ba4b4='on';if(_0x5ba4b4=='on'){const _0x1b937a=cheerio['load'](_0x46c550);let _0x528db9=[],_0x11fb4c=[],_0x3a2b37=[];_0x1b937a(_0x50134b(0x17a))[_0x50134b(0x219)]((_0xbe698f,_0x4ca153)=>{const _0x2fb23f=_0x50134b;let _0x4c6692=[],_0x330db2=0x0;while(_0x3a2b37[_0x330db2]){_0x3a2b37[_0x330db2]--,_0x330db2++;}_0x1b937a(_0x4ca153)[_0x2fb23f(0x183)](_0x2fb23f(0x140))[_0x2fb23f(0x219)]((_0x2de4a0,_0x3c5aaf)=>{const _0x13819e=_0x2fb23f;let _0x1bf5e6=_0x1b937a(_0x3c5aaf)['text']()[_0x13819e(0x1a1)](),_0x1c59c7=parseFloat(_0x1bf5e6[_0x13819e(0x108)](/,/g,''));isNaN(_0x1c59c7)&&(_0x1c59c7=_0x1bf5e6);let _0x2e6880=parseInt(_0x1b937a(_0x3c5aaf)[_0x13819e(0x1b4)](_0x13819e(0x211)))||0x1,_0x243c27=parseInt(_0x1b937a(_0x3c5aaf)[_0x13819e(0x1b4)](_0x13819e(0x15d)))||0x1;_0x4c6692[_0x330db2]=_0x1c59c7;(_0x2e6880>0x1||_0x243c27>0x1)&&_0x11fb4c[_0x13819e(0x136)]({'s':{'r':_0xbe698f,'c':_0x330db2},'e':{'r':_0xbe698f+_0x243c27-0x1,'c':_0x330db2+_0x2e6880-0x1}});for(let _0x22ad8c=0x0;_0x22ad8c<_0x2e6880;_0x22ad8c++){_0x243c27>0x1&&(_0x3a2b37[_0x330db2+_0x22ad8c]=_0x243c27-0x1);}_0x330db2+=_0x2e6880;}),_0x528db9['push'](_0x4c6692);});const _0x13d581=XLSX['utils'][_0x50134b(0x1c4)](),_0x55c80f=XLSX[_0x50134b(0x1ad)][_0x50134b(0x20d)](_0x528db9);_0x11fb4c[_0x50134b(0x175)]>0x0&&(_0x55c80f['!merges']=_0x11fb4c);_0x55c80f['!cols']=_0x528db9[0x0][_0x50134b(0x10a)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x13d581,_0x55c80f,_0x50134b(0xf8));const _0x10f9e7=XLSX[_0x50134b(0xed)](_0x13d581,{'bookType':_0x50134b(0x1f0),'type':'buffer'});_0x144a4d[_0x50134b(0x226)](_0x50134b(0x1cb),_0x50134b(0x182)),_0x144a4d[_0x50134b(0x226)](_0x50134b(0x22d),_0x50134b(0x1f9)),_0x144a4d['send'](_0x10f9e7);}else pdf[_0x50134b(0x1cf)](_0x46c550,_0x64275e)[_0x50134b(0x1ce)](function(_0x533724,_0x375de9){const _0x3bdc63=_0x50134b;if(_0x533724){_0x144a4d[_0x3bdc63(0x19d)](0x1f4)[_0x3bdc63(0x156)](_0x3bdc63(0x275));return;}_0x144a4d[_0x3bdc63(0x226)](_0x3bdc63(0x22d),_0x3bdc63(0x167)),_0x375de9[_0x3bdc63(0x13b)](_0x144a4d);});}),module[a0_0x5e81ee(0xff)]=router;