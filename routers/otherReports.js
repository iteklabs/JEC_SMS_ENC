const a0_0x3b11a9=a0_0x2e8b;(function(_0x5798d7,_0x452514){const _0x52a9aa=a0_0x2e8b,_0x25b7c5=_0x5798d7();while(!![]){try{const _0x38f854=-parseInt(_0x52a9aa(0x9e))/0x1+-parseInt(_0x52a9aa(0xc2))/0x2*(-parseInt(_0x52a9aa(0x1f8))/0x3)+-parseInt(_0x52a9aa(0xfc))/0x4+-parseInt(_0x52a9aa(0x143))/0x5*(parseInt(_0x52a9aa(0x1e7))/0x6)+-parseInt(_0x52a9aa(0xbb))/0x7*(parseInt(_0x52a9aa(0x153))/0x8)+parseInt(_0x52a9aa(0x122))/0x9*(parseInt(_0x52a9aa(0x97))/0xa)+parseInt(_0x52a9aa(0x13a))/0xb;if(_0x38f854===_0x452514)break;else _0x25b7c5['push'](_0x25b7c5['shift']());}catch(_0x3222cd){_0x25b7c5['push'](_0x25b7c5['shift']());}}}(a0_0xf40b,0x4ddab));function a0_0xf40b(){const _0x3d33fc=['Content-Disposition','$sale_product','length','<p>INVENTORY\x20SUMMARY</p>','/agent_reports/view','landscape','totalQTYsum','<td\x20class=\x22row_data\x22><b>','/dsrr/view','border-top','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','\x22><b>','000000','$amount','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','Arabic','staffs','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','table\x20tr','redirect','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','en-US','false','slice','/agent/view','2028qtvWYE','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','sales_staff_id','product_info','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','pipe','Products\x20find_data','<td\x20class=\x22row_data\x22>','\x22\x20class=\x22cat_data\x22>','success','dsi_sales_admin','sales_man_code','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$product_details.product_stock','<th>X-Truck</th>','$sale_product.isFG','60mm','1053777DQRCIe','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','rowspan','find','$dsi','thick','getDate','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','$_id.date','medium','$products.discount','<th\x20rowspan=\x272\x27>Production</th>','product_details.product_name','$product_details.product_name','deleteOne','then','buffer','params','pdfkit-table','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','$product_info.category','colspan','</tbody>','$product_docs','_id','!merges','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','cash','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','/dl_excel','toFixed','toLocaleString','/reports/dsrr/view','product_stock','window.onload\x20=\x20function()\x20{','147470qKqYaL','$product_info.brand','html','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','$sales_staff_id','express/lib/response','144169EAMdIZ','<th>\x20QTY\x20SOLD\x20</th>','findById','sale_product.product_code','<tr>','body','language','inventory_sum','$NetPrice','<th>\x20INVOICE\x20AMOUNT\x20</th>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','replace','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','products','$product_info.gross_price','<td\x20class=\x22cat_data\x22></td>','log','ObjectId','render','Content-Type','create','German','Portuguese\x20(BR)','save','!cols','window.print();','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','write','$sale_product._id','4452014WoBDsz','$customer','$products.NetPrice','$name','cat_brand','Error\x20generating\x20PDF','status','2zpxeib','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','border-right','$_id.category','stock','blob-stream','category','aggregate','application/pdf','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','forEach','attr','$product_details','/dsrr_admin/pdf_admin','left','<div\x20\x20id=\x22table-conatainer\x22>','$product_list.product_stock','\x20-\x20HH','adj_discount','$product_list.product_name','Products\x20master','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','<th>\x20SALES\x20</th>','</table>','</th>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$sale_product.real_qty_unit_val','$due_date','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','sales_ext','$date','<div\x20class=\x22col-sm-11\x22>','valueOf','$product_list','$product','$sale_product.stock','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','dssr_view_admin','NumberFormat','get','format','Standard','reduce','$check_no','$products.product_details.prod_id','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','exceljs','<th>\x20ENDING\x20BALANCE\x20</th>','$product_info.name','<thead>','send','$products','filter','$_id.dsi','aoa_to_sheet','English\x20(US)','<td\x20colspan=\x22','express','136624RZXbgQ','$products.adj_discount','border-bottom','$product_info','beg_bal','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','border-left','/total_sales_reports/pdf','sales_bkg','<div\x20style=\x22page-break-before:\x20always;\x22></div>','$products.product_details.gross_price','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','post','<p>FINISHED\x20GOODS\x20INVENTORY</p>','$discount','<div\x20class=\x22row\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','English','\x20-\x20STD','$product.product_code','name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<th>\x20ITEM\x20DESCRIPTION\x20</th>','Products\x20warehouse_data','brandCount','<h1>JAKA\x20EQUITIES\x20CORP</h1>','$bank','$sales_info.name','Chinese','split','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','discount','prod_cat','$products.qty','dataqty','<script>','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','<p>SALES\x20REPORTS</p>','45fWhtla','mongoose','$category','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','<th\x20colspan=\x272\x27>SOLD</th>','</p>','map','style','$products.product_details','$product_stock','brand','product_name','$_id.customer','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<table>','/inventory_sum/pdf','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','Types','</tr>','Letter','<td\x20class=\x22cat_data\x22>','Portuguese','jsbarcode','product_code','11530772eMgBMy','isFG','dsi_sales','$sale_product.prod_cat','<p>','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','$brand','setHeader','xlsx','5030flKnxn','findOne','true','$sales_info._id','$_id.brand','/dsrr_admin/view','dssr_view','<td\x20class=\x22row_data\x22>0</td>','totalPrice','$product_code','sales_info','balanced','each','</b></td>','$product.quantity','bottom','8FMrNwx','Spanish','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','toISOString','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','Hindi','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','/dsrr/pdf','date','email','$product_name','includes','sumqty','$sale_product.product_name','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','user','../public/language/languages.json','<td\x20colspan=\x223\x22><b>TOTAL<b>','exports','top','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','test','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','html-pdf','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','dsi','canvas','push','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','json','book_new','$product_info.product_code','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getMonth','</div>','check_no','utils','Sales\x20Report','French','$sale_product.discount','product_docs','isArray','/agent_reports/pdf','referenceNumber','image','$sales_info','book_append_sheet','0.1in','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','long','20mm','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','text','amount','product_details','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','$sale_product.totalprice','\x22><b></b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','Household','toLocaleDateString','8.5in','<td\x20class=\x22row_data\x22></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','qty','<tbody>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','totalQty','customer','$adj_discount','$sale_product.quantity','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','../models/all_models','errors','right','DateTimeFormat','due_date','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','note','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$_id.status_data','totalGross','\x20-\x20','excel','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','$products.product_details.brand','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','toStream','td,\x20th','attachment;\x20filename=\x22sales_report.xlsx\x22','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','totalQTY','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','error','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','15in','Arabic\x20(ae)','thin','$cash','$sale_product.product_code','</td>','$totalQty','trim','date_include','$products.product_details.category','$sale_product.adj_discount','</thead>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','flash','load','/getDSSR_no','NetPrice','attachment;\x20filename=\x22reports.xlsx\x22','numeric','$totalGross','<th>\x20ITEM\x20CODE\x20</th>'];a0_0xf40b=function(){return _0x3d33fc;};return a0_0xf40b();}const express=require(a0_0x3b11a9(0xfb)),res=require(a0_0x3b11a9(0x9d)),app=express(),router=express['Router'](),multer=require('multer'),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x3b11a9(0x1a1)),auth=require('../middleware/auth'),users=require(a0_0x3b11a9(0x164)),excelJS=require(a0_0x3b11a9(0xf0)),XLSX=require(a0_0x3b11a9(0x142)),PDFDocument=require(a0_0x3b11a9(0x20d)),fs=require('fs'),blobStream=require(a0_0x3b11a9(0xc7)),JsBarcode=require(a0_0x3b11a9(0x138)),{Canvas}=require(a0_0x3b11a9(0x16f)),pdf=require(a0_0x3b11a9(0x16b)),path=require('path'),mongoose=require(a0_0x3b11a9(0x123)),cheerio=require('cheerio');router[a0_0x3b11a9(0xe9)]('/balance/view',auth,async(_0x33f2b0,_0x93ce9f)=>{const _0x4d33b3=a0_0x3b11a9;try{const {username:_0x21f953,email:_0x5be3c6,role:_0x21d671}=_0x33f2b0[_0x4d33b3(0x163)],_0x3a3f53=_0x33f2b0['user'],_0x1a30be=await profile['findOne']({'email':_0x3a3f53[_0x4d33b3(0x15d)]}),_0xee09dc={'year':_0x4d33b3(0x1cb),'month':_0x4d33b3(0x188),'day':'numeric'},_0x1b5061=await master_shop['find']();console[_0x4d33b3(0xae)](_0x4d33b3(0xd6),_0x1b5061);const _0x3f7171=await product[_0x4d33b3(0x1fb)]();console['log'](_0x4d33b3(0x1ed),_0x3f7171);const _0xacfc89=await warehouse[_0x4d33b3(0xc9)]([{'$unwind':_0x4d33b3(0xce)},{'$lookup':{'from':_0x4d33b3(0xab),'localField':_0x4d33b3(0x207),'foreignField':_0x4d33b3(0x110),'as':_0x4d33b3(0x17e)}},{'$unwind':_0x4d33b3(0x8a)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x4d33b3(0x1f4)}},{'$group':{'_id':_0x4d33b3(0x15e),'product_stock':{'$sum':_0x4d33b3(0x12b)}}}]);console[_0x4d33b3(0xae)](_0x4d33b3(0x113),_0xacfc89),_0xacfc89[_0x4d33b3(0xcc)](_0x5b2dfc=>{const _0x313013=_0x3f7171['map'](_0x36942b=>{const _0x436c41=a0_0x2e8b;_0x36942b[_0x436c41(0x110)]==_0x5b2dfc[_0x436c41(0x8b)]&&(_0x36942b['stock']=parseInt(_0x36942b[_0x436c41(0xc6)])+parseInt(_0x5b2dfc[_0x436c41(0x95)]));});}),console[_0x4d33b3(0xae)](_0x4d33b3(0x1ed),_0x3f7171);if(_0x1b5061[0x0]['language']==_0x4d33b3(0xf9))var _0x5df7ef=users[_0x4d33b3(0x10d)];else{if(_0x1b5061[0x0][_0x4d33b3(0xa4)]=='Hindi')var _0x5df7ef=users['Hindi'];else{if(_0x1b5061[0x0][_0x4d33b3(0xa4)]==_0x4d33b3(0xb3))var _0x5df7ef=users['German'];else{if(_0x1b5061[0x0]['language']==_0x4d33b3(0x154))var _0x5df7ef=users['Spanish'];else{if(_0x1b5061[0x0][_0x4d33b3(0xa4)]=='French')var _0x5df7ef=users[_0x4d33b3(0x17c)];else{if(_0x1b5061[0x0][_0x4d33b3(0xa4)]=='Portuguese\x20(BR)')var _0x5df7ef=users[_0x4d33b3(0x137)];else{if(_0x1b5061[0x0][_0x4d33b3(0xa4)]=='Chinese')var _0x5df7ef=users[_0x4d33b3(0x118)];else{if(_0x1b5061[0x0][_0x4d33b3(0xa4)]==_0x4d33b3(0x1ba))var _0x5df7ef=users[_0x4d33b3(0x1dd)];}}}}}}}_0x93ce9f[_0x4d33b3(0xb0)](_0x4d33b3(0x14e),{'success':_0x33f2b0[_0x4d33b3(0x1c6)](_0x4d33b3(0x1f0)),'errors':_0x33f2b0['flash']('errors'),'alldata':_0x3f7171,'profile':_0x1a30be,'master_shop':_0x1b5061,'role':_0x3a3f53,'product_stock':_0xacfc89,'language':_0x5df7ef});}catch(_0x400681){}});async function dataCheck(_0x532dc7,_0x50f0ba){const _0x2e08c5=a0_0x3b11a9,_0x56c77e=await product[_0x2e08c5(0xc9)]([{'$group':{'_id':{'brand':_0x2e08c5(0x140),'category':_0x2e08c5(0x124)},'products':{'$push':{'name':_0x2e08c5(0xbe),'product_code':_0x2e08c5(0x14c)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3c99b4=[];_0x3c99b4[_0x2e08c5(0xbf)]=[];for(let _0x12ae93=0x0;_0x12ae93<=_0x56c77e[_0x2e08c5(0x1d0)]-0x1;_0x12ae93++){const _0x3f1bbd=_0x56c77e[_0x12ae93];_0x3c99b4['cat_brand'][_0x2e08c5(0x170)](_0x3f1bbd);}const _0x1b967d=await product[_0x2e08c5(0xc9)]([{'$group':{'_id':{'category':_0x2e08c5(0x124)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x2e08c5(0xbe)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5cb315=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x532dc7,'$lte':_0x50f0ba}}},{'$unwind':_0x2e08c5(0xe4)},{'$group':{'_id':{'product_name':'$product.product_name','product_code':_0x2e08c5(0x10f)},'totalQTY':{'$sum':_0x2e08c5(0x151)}}}]);_0x3c99b4[_0x2e08c5(0x100)]=[];for(let _0x5247c6=0x0;_0x5247c6<=_0x5cb315[_0x2e08c5(0x1d0)]-0x1;_0x5247c6++){const _0xf796a4=_0x5cb315[_0x5247c6];_0x3c99b4['beg_bal']['push'](_0xf796a4);}const _0x5e2b05=await sales_sa[_0x2e08c5(0xc9)]([{'$match':{'date':{'$gte':_0x532dc7,'$lte':_0x50f0ba}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x2e08c5(0x9c)}}},{'$lookup':{'from':_0x2e08c5(0x1de),'localField':_0x2e08c5(0x1e9),'foreignField':_0x2e08c5(0x8b),'as':_0x2e08c5(0x14d)}},{'$unwind':_0x2e08c5(0x183)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x2e08c5(0x161),'product_code':_0x2e08c5(0x1bd)},'totalQTY':{'$sum':_0x2e08c5(0x19f)}}}]);console[_0x2e08c5(0xae)](_0x5e2b05[0x0]),_0x3c99b4[_0x2e08c5(0x104)]=[];for(let _0x1db06c=0x0;_0x1db06c<=_0x5e2b05[_0x2e08c5(0x1d0)]-0x1;_0x1db06c++){const _0x18717d=_0x5e2b05[_0x1db06c];_0x3c99b4[_0x2e08c5(0x104)][_0x2e08c5(0x170)](_0x18717d);}const _0x3c3a18=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x532dc7,'$lte':_0x50f0ba}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':'staffs','localField':_0x2e08c5(0x1e9),'foreignField':'_id','as':'sales_info'}},{'$unwind':_0x2e08c5(0x183)},{'$unwind':_0x2e08c5(0x1cf)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x2e08c5(0x1e4)}},{'$group':{'_id':{'product_name':_0x2e08c5(0x161),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x2e08c5(0xdc)}}}]);_0x3c99b4['sales_ext']=[];for(let _0x2bd5d3=0x0;_0x2bd5d3<=_0x3c3a18[_0x2e08c5(0x1d0)]-0x1;_0x2bd5d3++){const _0x21a544=_0x3c3a18[_0x2bd5d3];_0x3c99b4[_0x2e08c5(0xdf)][_0x2e08c5(0x170)](_0x21a544);}let _0xbbcd73='';for(let _0x2a9785=0x0;_0x2a9785<=_0x1b967d[_0x2e08c5(0x1d0)]-0x1;_0x2a9785++){const _0x2baef4=_0x1b967d[_0x2a9785];_0xbbcd73+=_0x2e08c5(0xa2),_0xbbcd73+=_0x2e08c5(0x1f9)+_0x2baef4[_0x2e08c5(0x8b)][_0x2e08c5(0xc8)]+_0x2e08c5(0x1be),_0xbbcd73+=_0x2e08c5(0x134);for(let _0x2b7fce=0x0;_0x2b7fce<_0x3c99b4[_0x2e08c5(0xbf)]['length'];_0x2b7fce++){const _0x2b54f5=_0x3c99b4['cat_brand'][_0x2b7fce];if(_0x2b54f5[_0x2e08c5(0x8b)][_0x2e08c5(0xc8)]==_0x2baef4[_0x2e08c5(0x8b)]['category']){let _0x55e8a5=[],_0x32e38=[],_0x4f01f9=[];_0x55e8a5[_0x2b54f5[_0x2e08c5(0x8b)][_0x2e08c5(0x12c)]]=[],_0x32e38[_0x2b54f5[_0x2e08c5(0x8b)][_0x2e08c5(0x12c)]]=[],_0x4f01f9[_0x2b54f5[_0x2e08c5(0x8b)][_0x2e08c5(0x12c)]]=[];var _0x2e42a5=0x0,_0x460172=0x0,_0x13fad4=0x0;for(let _0x32f226=0x0;_0x32f226<_0x2b54f5[_0x2e08c5(0xab)]['length'];_0x32f226++){const _0xae846=_0x2b54f5['products'][_0x32f226];for(let _0x9a9df8=0x0;_0x9a9df8<=_0x3c99b4[_0x2e08c5(0x100)][_0x2e08c5(0x1d0)]-0x1;_0x9a9df8++){const _0x4644f8=_0x3c99b4[_0x2e08c5(0x100)][_0x9a9df8];_0x4644f8['_id'][_0x2e08c5(0x12d)]==_0xae846[_0x2e08c5(0x110)]&&_0x4644f8[_0x2e08c5(0x8b)][_0x2e08c5(0x139)]==_0xae846[_0x2e08c5(0x139)]&&(_0x2e42a5+=parseInt(_0x4644f8['totalQTY'],0xa));}for(let _0x5ef5d0=0x0;_0x5ef5d0<=_0x3c99b4[_0x2e08c5(0xdf)][_0x2e08c5(0x1d0)]-0x1;_0x5ef5d0++){const _0x14a35e=_0x3c99b4['sales_ext'][_0x5ef5d0];_0x14a35e[_0x2e08c5(0x8b)]['product_name']==_0xae846[_0x2e08c5(0x110)]&&_0x14a35e[_0x2e08c5(0x8b)][_0x2e08c5(0x139)]==_0xae846[_0x2e08c5(0x139)]&&(_0x460172+=parseFloat(_0x14a35e[_0x2e08c5(0x1b5)],0xa)[_0x2e08c5(0x92)](0x2));}for(let _0x4324ff=0x0;_0x4324ff<=_0x3c99b4[_0x2e08c5(0x104)]['length']-0x1;_0x4324ff++){const _0x10b350=_0x3c99b4[_0x2e08c5(0x104)][_0x4324ff];_0x10b350[_0x2e08c5(0x8b)][_0x2e08c5(0x12d)]==_0xae846[_0x2e08c5(0x110)]&&_0x10b350[_0x2e08c5(0x8b)][_0x2e08c5(0x139)]==_0xae846[_0x2e08c5(0x139)]&&(_0x13fad4+=parseInt(_0x10b350[_0x2e08c5(0x1b5)],0xa));}}const _0x218bae=new Intl[(_0x2e08c5(0xe8))](_0x2e08c5(0x1e3));var _0x1ac2b8=_0x218bae[_0x2e08c5(0xea)](_0x2e42a5);_0x55e8a5[_0x2b54f5[_0x2e08c5(0x8b)][_0x2e08c5(0x12c)]][_0x2e08c5(0x170)](_0x1ac2b8),_0x32e38[_0x2b54f5['_id']['brand']]['push'](_0x218bae[_0x2e08c5(0xea)](_0x460172)),_0x4f01f9[_0x2b54f5[_0x2e08c5(0x8b)][_0x2e08c5(0x12c)]]['push'](_0x218bae[_0x2e08c5(0xea)](_0x13fad4));var _0x188970=_0x218bae['format'](_0x2e42a5-(_0x13fad4+_0x460172));_0xbbcd73+=_0x2e08c5(0xa2),_0xbbcd73+=_0x2e08c5(0x197),_0xbbcd73+=_0x2e08c5(0x1ee)+_0x2b54f5[_0x2e08c5(0x8b)][_0x2e08c5(0x12c)]+'</td>',_0xbbcd73+='<td\x20class=\x22row_data\x22>'+_0x55e8a5[_0x2b54f5[_0x2e08c5(0x8b)][_0x2e08c5(0x12c)]][0x0]+_0x2e08c5(0x1be),_0xbbcd73+=_0x2e08c5(0x14a),_0xbbcd73+=_0x2e08c5(0x1ee)+_0x4f01f9[_0x2b54f5[_0x2e08c5(0x8b)]['brand']][0x0]+'</td>',_0xbbcd73+=_0x2e08c5(0x1ee)+_0x32e38[_0x2b54f5[_0x2e08c5(0x8b)]['brand']][0x0]+_0x2e08c5(0x1be),_0xbbcd73+=_0x2e08c5(0x1ee)+_0x188970+_0x2e08c5(0x1be),_0xbbcd73+=_0x2e08c5(0x134);}}}return console[_0x2e08c5(0xae)](_0x3c99b4[_0x2e08c5(0x104)]),_0xbbcd73;}router[a0_0x3b11a9(0x108)]('/balance/pdf',auth,async(_0x21b561,_0x577b33)=>{const _0x26be2a=a0_0x3b11a9,{from_date:_0x3dddc5,to_date:_0x717c27}=_0x21b561[_0x26be2a(0xa3)],_0x588787=await dataCheck(_0x3dddc5,_0x717c27);{}let _0x54bf27=_0x26be2a(0x1d8);var _0x24beb8=new Date(_0x3dddc5),_0x1a9339=new Date(_0x717c27);const _0xce7f5c={'year':'numeric','month':_0x26be2a(0x188),'day':_0x26be2a(0x1cb)},_0x682802=new Intl[(_0x26be2a(0x1a4))](_0x26be2a(0x1e3),_0xce7f5c)[_0x26be2a(0xea)](_0x24beb8),_0x268d2f=new Intl[(_0x26be2a(0x1a4))](_0x26be2a(0x1e3),_0xce7f5c)[_0x26be2a(0xea)](_0x1a9339);_0x54bf27+=_0x26be2a(0x115),_0x54bf27+=_0x26be2a(0x109),_0x54bf27+='<p>'+_0x682802+_0x26be2a(0x1ab)+_0x268d2f+'</p>',_0x54bf27+='<div\x20class=\x22row\x22>',_0x54bf27+=_0x26be2a(0xe1),_0x54bf27+='<table>',_0x54bf27+=_0x26be2a(0xa2),_0x54bf27+='<th\x20rowspan=\x272\x27>Category</th>',_0x54bf27+='<th\x20rowspan=\x272\x27>Products</th>',_0x54bf27+=_0x26be2a(0x162)+_0x682802+_0x26be2a(0xda),_0x54bf27+=_0x26be2a(0x206),_0x54bf27+=_0x26be2a(0x126),_0x54bf27+=_0x26be2a(0x1e8)+_0x268d2f+_0x26be2a(0xda),_0x54bf27+=_0x26be2a(0x134),_0x54bf27+=_0x26be2a(0xa2),_0x54bf27+='<th>Booking</th>',_0x54bf27+=_0x26be2a(0x1f5),_0x54bf27+=_0x26be2a(0x134),_0x54bf27+=_0x588787,_0x54bf27+=_0x26be2a(0xd9),_0x54bf27+=_0x26be2a(0x178),_0x54bf27+=_0x26be2a(0x178);const _0x18f37c={'format':_0x26be2a(0x135),'orientation':_0x26be2a(0x1d3)};pdf[_0x26be2a(0xb2)](_0x54bf27,_0x18f37c)['toStream'](function(_0xe3767,_0x36b4d2){const _0x5bd183=_0x26be2a;if(_0xe3767){_0x577b33[_0x5bd183(0xc1)](0x1f4)[_0x5bd183(0xf4)](_0x5bd183(0xc0));return;}_0x577b33[_0x5bd183(0x141)](_0x5bd183(0xb1),_0x5bd183(0xca)),_0x36b4d2[_0x5bd183(0x1ec)](_0x577b33);});}),router[a0_0x3b11a9(0xe9)](a0_0x3b11a9(0x1e6),auth,async(_0x5f2923,_0x5c229e)=>{const _0x5cae94=a0_0x3b11a9;try{const {username:_0x20da80,email:_0x1aeb2e,role:_0x477cda}=_0x5f2923[_0x5cae94(0x163)],_0x3c048e=_0x5f2923[_0x5cae94(0x163)],_0x1b4ed3=await profile['findOne']({'email':_0x3c048e[_0x5cae94(0x15d)]}),_0x4b48fe={'year':_0x5cae94(0x1cb),'month':'long','day':_0x5cae94(0x1cb)},_0x15b050=await master_shop[_0x5cae94(0x1fb)](),_0x48e7bc=await product['find'](),_0xc287ba=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x5cae94(0xab),'localField':_0x5cae94(0x207),'foreignField':_0x5cae94(0x110),'as':_0x5cae94(0x17e)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x5cae94(0x208),'product_stock':_0x5cae94(0x1f4)}},{'$group':{'_id':_0x5cae94(0x15e),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x15b050[0x0][_0x5cae94(0xa4)]==_0x5cae94(0xf9))var _0x15be8c=users[_0x5cae94(0x10d)];else{if(_0x15b050[0x0][_0x5cae94(0xa4)]=='Hindi')var _0x15be8c=users['Hindi'];else{if(_0x15b050[0x0][_0x5cae94(0xa4)]==_0x5cae94(0xb3))var _0x15be8c=users[_0x5cae94(0xb3)];else{if(_0x15b050[0x0][_0x5cae94(0xa4)]==_0x5cae94(0x154))var _0x15be8c=users[_0x5cae94(0x154)];else{if(_0x15b050[0x0][_0x5cae94(0xa4)]==_0x5cae94(0x17c))var _0x15be8c=users[_0x5cae94(0x17c)];else{if(_0x15b050[0x0][_0x5cae94(0xa4)]=='Portuguese\x20(BR)')var _0x15be8c=users['Portuguese'];else{if(_0x15b050[0x0][_0x5cae94(0xa4)]==_0x5cae94(0x118))var _0x15be8c=users['Chinese'];else{if(_0x15b050[0x0]['language']==_0x5cae94(0x1ba))var _0x15be8c=users['Arabic'];}}}}}}}_0x5c229e[_0x5cae94(0xb0)]('agent_sales',{'success':_0x5f2923['flash'](_0x5cae94(0x1f0)),'errors':_0x5f2923[_0x5cae94(0x1c6)](_0x5cae94(0x1a2)),'alldata':_0x48e7bc,'profile':_0x1b4ed3,'master_shop':_0x15b050,'role':_0x3c048e,'product_stock':_0xc287ba,'language':_0x15be8c});}catch(_0x4d191d){}});function a0_0x2e8b(_0x4a47eb,_0x42a116){const _0xf40ba=a0_0xf40b();return a0_0x2e8b=function(_0x2e8b47,_0x2ffecb){_0x2e8b47=_0x2e8b47-0x87;let _0x2cd836=_0xf40ba[_0x2e8b47];return _0x2cd836;},a0_0x2e8b(_0x4a47eb,_0x42a116);}async function agentsdataCheck(_0x27ad8d,_0xe59d4c){const _0x3064cb=a0_0x3b11a9,_0x450838=await product[_0x3064cb(0xc9)]([{'$group':{'_id':{'brand':_0x3064cb(0x140),'category':_0x3064cb(0x124)},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x272ff9=[];_0x272ff9[_0x3064cb(0xbf)]=[];for(let _0xf9270a=0x0;_0xf9270a<=_0x450838[_0x3064cb(0x1d0)]-0x1;_0xf9270a++){const _0x318630=_0x450838[_0xf9270a];_0x272ff9['cat_brand']['push'](_0x318630);}const _0x4991d8=await product['aggregate']([{'$group':{'_id':{'category':_0x3064cb(0x124)},'products':{'$push':{'brand':'$brand','product_code':_0x3064cb(0x14c),'product_name':_0x3064cb(0xbe)}}}},{'$sort':{'_id.category':-0x1}}]),_0x58bcab=await product['aggregate']([{'$group':{'_id':{'category':_0x3064cb(0x124),'brand':_0x3064cb(0x140)}}},{'$group':{'_id':_0x3064cb(0xc5),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x25c9f4=await sales_sa[_0x3064cb(0xc9)]([{'$match':{'date':{'$gte':_0x27ad8d,'$lte':_0xe59d4c}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x3064cb(0x9c)}}},{'$lookup':{'from':_0x3064cb(0x1de),'localField':'sales_staff_id','foreignField':'_id','as':_0x3064cb(0x14d)}},{'$unwind':_0x3064cb(0x183)},{'$unwind':_0x3064cb(0x1cf)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x3064cb(0x1e4)}},{'$lookup':{'from':_0x3064cb(0xab),'localField':'sale_product.product_code','foreignField':'product_code','as':_0x3064cb(0x1ea)}},{'$unwind':_0x3064cb(0xff)},{'$group':{'_id':{'sales_id':_0x3064cb(0x146),'category':_0x3064cb(0x87),'brand':'$product_info.brand'},'salesman_data':{'$first':_0x3064cb(0x117)},'totalQTY':{'$sum':_0x3064cb(0xdc)},'products':{'$push':{'qty':_0x3064cb(0xdc),'product_details':{'prod_name':'$product_info.name','product_code':_0x3064cb(0x174),'category':_0x3064cb(0x87),'brand':_0x3064cb(0x98)}}}}}]);let _0x6281a5='';_0x6281a5+=_0x3064cb(0xa2),_0x6281a5+=_0x3064cb(0x187),_0x6281a5+=_0x3064cb(0x134),_0x6281a5+='<tr>',_0x6281a5+='<td\x20class=\x22cat_data\x22></td>';for(let _0x161cc6=0x0;_0x161cc6<=_0x4991d8[_0x3064cb(0x1d0)]-0x1;_0x161cc6++){const _0x41fe4e=_0x4991d8[_0x161cc6];for(let _0x3d996d=0x0;_0x3d996d<_0x58bcab['length'];_0x3d996d++){const _0x4a78d5=_0x58bcab[_0x3d996d];_0x4a78d5['_id']==_0x41fe4e['_id'][_0x3064cb(0xc8)]&&(_0x6281a5+=_0x3064cb(0xfa)+_0x4a78d5[_0x3064cb(0x114)]+'\x22\x20class=\x22cat_data\x22>'+_0x41fe4e['_id']['category']+_0x3064cb(0x1be));}}_0x6281a5+=_0x3064cb(0xad),_0x6281a5+=_0x3064cb(0x134),_0x6281a5+=_0x3064cb(0xa2),_0x6281a5+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>';for(let _0x48e5ca=0x0;_0x48e5ca<=_0x4991d8[_0x3064cb(0x1d0)]-0x1;_0x48e5ca++){const _0x354c1e=_0x4991d8[_0x48e5ca];for(let _0x4e45a4=0x0;_0x4e45a4<_0x272ff9[_0x3064cb(0xbf)][_0x3064cb(0x1d0)];_0x4e45a4++){const _0x35da68=_0x272ff9[_0x3064cb(0xbf)][_0x4e45a4];_0x35da68[_0x3064cb(0x8b)][_0x3064cb(0xc8)]==_0x354c1e[_0x3064cb(0x8b)]['category']&&(_0x6281a5+=_0x3064cb(0x136)+_0x35da68[_0x3064cb(0x8b)]['brand']+_0x3064cb(0x1be));}}_0x6281a5+=_0x3064cb(0x20e),_0x6281a5+='</tr>';let _0x10eff1={'name':[],'dataqty':{}};for(let _0x20ae8f=0x0;_0x20ae8f<_0x272ff9[_0x3064cb(0xbf)]['length'];_0x20ae8f++){const _0x4cbe3f=_0x272ff9[_0x3064cb(0xbf)][_0x20ae8f],_0xd458b0=_0x4cbe3f[_0x3064cb(0x8b)][_0x3064cb(0x12c)],_0xcbe4da=_0x4cbe3f[_0x3064cb(0x8b)]['category'];!_0x10eff1['dataqty'][_0xd458b0]&&(_0x10eff1['dataqty'][_0xd458b0]={});!_0x10eff1[_0x3064cb(0x11e)][_0xd458b0][_0xcbe4da]&&(_0x10eff1['dataqty'][_0xd458b0][_0xcbe4da]=[]);for(let _0x3e42d7=0x0;_0x3e42d7<_0x25c9f4[_0x3064cb(0x1d0)];_0x3e42d7++){const _0x5aeaa9=_0x25c9f4[_0x3e42d7];if(_0xd458b0===_0x5aeaa9[_0x3064cb(0x8b)][_0x3064cb(0x12c)]&&_0xcbe4da===_0x5aeaa9[_0x3064cb(0x8b)][_0x3064cb(0xc8)]){const _0x1952cf=_0x5aeaa9['salesman_data'];!_0x10eff1[_0x3064cb(0x11e)][_0xd458b0][_0xcbe4da][_0x1952cf]&&(_0x10eff1['dataqty'][_0xd458b0][_0xcbe4da][_0x1952cf]=[]),_0x10eff1[_0x3064cb(0x11e)][_0xd458b0][_0xcbe4da][_0x1952cf][_0x3064cb(0x170)](_0x5aeaa9[_0x3064cb(0x1b5)]),!_0x10eff1[_0x3064cb(0x110)][_0x3064cb(0x15f)](_0x1952cf)&&_0x10eff1[_0x3064cb(0x110)][_0x3064cb(0x170)](_0x1952cf);}}}_0x6281a5+=_0x3064cb(0xa2);for(let _0x329a51=0x0;_0x329a51<=_0x10eff1[_0x3064cb(0x110)][_0x3064cb(0x1d0)]-0x1;_0x329a51++){const _0x7eca8=_0x10eff1['name'][_0x329a51];_0x6281a5+=_0x3064cb(0x1ee)+_0x7eca8+_0x3064cb(0x1be);var _0xb9ec67=0x0,_0x14baf9=0x0;for(let _0x378912=0x0;_0x378912<=_0x272ff9[_0x3064cb(0xbf)]['length']-0x1;_0x378912++){const _0x10500b=_0x272ff9[_0x3064cb(0xbf)][_0x378912];var _0x5f4ece=0x0;_0x10eff1['dataqty'][_0x10500b['_id'][_0x3064cb(0x12c)]][_0x10500b[_0x3064cb(0x8b)][_0x3064cb(0xc8)]][_0x7eca8]?(_0x5f4ece=_0x10eff1[_0x3064cb(0x11e)][_0x10500b[_0x3064cb(0x8b)]['brand']][_0x10500b[_0x3064cb(0x8b)]['category']][_0x7eca8][0x0],_0x6281a5+=_0x3064cb(0x1ee)+formatNumber(_0x5f4ece[_0x3064cb(0x92)](0x2))+'</td>'):(_0x5f4ece=0x0,_0x6281a5+=_0x3064cb(0x1ee)+_0x5f4ece+_0x3064cb(0x1be)),_0xb9ec67+=_0x5f4ece;}_0x6281a5+=_0x3064cb(0x1ee)+formatNumber(_0xb9ec67[_0x3064cb(0x92)](0x2))+'</td>';}return _0x6281a5+=_0x3064cb(0x134),_0x6281a5;}router[a0_0x3b11a9(0x108)]('/agent/pdf',auth,async(_0x23479a,_0x3fd3ef)=>{const _0x44bf93=a0_0x3b11a9,{from_date:_0xcbd2fe,to_date:_0x2d76da}=_0x23479a['body'],_0x2b11bb=await agentsdataCheck(_0xcbd2fe,_0x2d76da);{}let _0x2d0451=_0x44bf93(0xef);var _0x51150=new Date(_0xcbd2fe),_0x4da068=new Date(_0x2d76da);const _0x41136d={'year':_0x44bf93(0x1cb),'month':'long','day':'numeric'},_0x4b199c=new Intl[(_0x44bf93(0x1a4))]('en-US',_0x41136d)['format'](_0x51150),_0x155b78=new Intl[(_0x44bf93(0x1a4))](_0x44bf93(0x1e3),_0x41136d)[_0x44bf93(0xea)](_0x4da068);_0x2d0451+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x2d0451+=_0x44bf93(0x121),_0x2d0451+=_0x44bf93(0x13e)+_0x4b199c+'\x20-\x20'+_0x155b78+_0x44bf93(0x127),_0x2d0451+='<div\x20class=\x22row\x22>',_0x2d0451+=_0x44bf93(0xe1),_0x2d0451+=_0x44bf93(0x130),_0x2d0451+=_0x2b11bb,_0x2d0451+=_0x44bf93(0xd9),_0x2d0451+=_0x44bf93(0x178),_0x2d0451+=_0x44bf93(0x178);const _0x4280bc={'format':_0x44bf93(0x135),'orientation':'landscape'};pdf[_0x44bf93(0xb2)](_0x2d0451,_0x4280bc)['toStream'](function(_0x170212,_0x59b77d){const _0x53312b=_0x44bf93;if(_0x170212){_0x3fd3ef['status'](0x1f4)[_0x53312b(0xf4)](_0x53312b(0xc0));return;}_0x3fd3ef[_0x53312b(0x141)](_0x53312b(0xb1),_0x53312b(0xca)),_0x59b77d['pipe'](_0x3fd3ef);});}),router[a0_0x3b11a9(0xe9)]('/agent_reports/sales_ad',auth,async(_0x19b791,_0x446cfc)=>{const _0x379f8a=a0_0x3b11a9;try{const {username:_0x1b5f14,email:_0x266d1c,role:_0x34490b}=_0x19b791[_0x379f8a(0x163)],_0x56134d=_0x19b791[_0x379f8a(0x163)],_0x462f0f=await profile['findOne']({'email':_0x56134d['email']}),_0x408f16={'year':_0x379f8a(0x1cb),'month':'long','day':_0x379f8a(0x1cb)},_0x16e9c1=await master_shop[_0x379f8a(0x1fb)](),_0x3aa648=await staff[_0x379f8a(0x144)]({'email':_0x56134d[_0x379f8a(0x15d)]}),_0xf94730=await product[_0x379f8a(0x1fb)](),_0x32c4f8=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x379f8a(0xab),'localField':_0x379f8a(0x207),'foreignField':'name','as':_0x379f8a(0x17e)}},{'$unwind':_0x379f8a(0x8a)},{'$project':{'product_name':_0x379f8a(0x208),'product_stock':_0x379f8a(0x1f4)}},{'$group':{'_id':_0x379f8a(0x15e),'product_stock':{'$sum':_0x379f8a(0x12b)}}}]),_0x5f26ea=await staff[_0x379f8a(0x1fb)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x16e9c1[0x0][_0x379f8a(0xa4)]==_0x379f8a(0xf9))var _0x2d51c7=users[_0x379f8a(0x10d)];else{if(_0x16e9c1[0x0][_0x379f8a(0xa4)]==_0x379f8a(0x159))var _0x2d51c7=users[_0x379f8a(0x159)];else{if(_0x16e9c1[0x0]['language']==_0x379f8a(0xb3))var _0x2d51c7=users[_0x379f8a(0xb3)];else{if(_0x16e9c1[0x0][_0x379f8a(0xa4)]==_0x379f8a(0x154))var _0x2d51c7=users[_0x379f8a(0x154)];else{if(_0x16e9c1[0x0][_0x379f8a(0xa4)]=='French')var _0x2d51c7=users['French'];else{if(_0x16e9c1[0x0]['language']==_0x379f8a(0xb4))var _0x2d51c7=users['Portuguese'];else{if(_0x16e9c1[0x0]['language']==_0x379f8a(0x118))var _0x2d51c7=users[_0x379f8a(0x118)];else{if(_0x16e9c1[0x0][_0x379f8a(0xa4)]==_0x379f8a(0x1ba))var _0x2d51c7=users['Arabic'];}}}}}}}_0x446cfc[_0x379f8a(0xb0)](_0x379f8a(0x1f1),{'success':_0x19b791['flash']('success'),'errors':_0x19b791[_0x379f8a(0x1c6)](_0x379f8a(0x1a2)),'alldata':_0xf94730,'profile':_0x462f0f,'master_shop':_0x16e9c1,'role':_0x56134d,'product_stock':_0x32c4f8,'language':_0x2d51c7,'staff_arr':_0x3aa648,'staff_data_all':_0x5f26ea});}catch(_0x7abb74){_0x446cfc[_0x379f8a(0x172)](_0x7abb74);}});async function agentsdataDSICheck_admin(_0x5828c1,_0x32dd8d,_0x204f4d,_0x3fa1dc){const _0x4aeaea=a0_0x3b11a9,_0x474ff8=await product['aggregate']([{'$group':{'_id':{'brand':_0x4aeaea(0x140),'category':_0x4aeaea(0x124)},'products':{'$push':{'name':_0x4aeaea(0xbe),'product_code':_0x4aeaea(0x14c)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xff259e=[];_0xff259e[_0x4aeaea(0xbf)]=[];for(let _0x1bb38d=0x0;_0x1bb38d<=_0x474ff8[_0x4aeaea(0x1d0)]-0x1;_0x1bb38d++){const _0x1ec311=_0x474ff8[_0x1bb38d];_0xff259e[_0x4aeaea(0xbf)][_0x4aeaea(0x170)](_0x1ec311);}const _0x21b4d6=await product[_0x4aeaea(0xc9)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x4aeaea(0x14c),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x8ab4b7=await product[_0x4aeaea(0xc9)]([{'$group':{'_id':{'category':_0x4aeaea(0x124),'brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1a9cd5=await sales_sa[_0x4aeaea(0xc9)]([{'$match':{'date':{'$gte':_0x5828c1,'$lte':_0x32dd8d},'sales_staff_id':_0x204f4d,'sale_product.isFG':_0x4aeaea(0x1e4)}},{'$unwind':_0x4aeaea(0x1cf)},{'$match':{'sale_product.isFG':_0x4aeaea(0x1e4)}},{'$lookup':{'from':_0x4aeaea(0xab),'localField':'sale_product.product_code','foreignField':_0x4aeaea(0x139),'as':_0x4aeaea(0x1ea)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x4aeaea(0x1fc),'date':'$date','customer':_0x4aeaea(0xbc)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x4aeaea(0xdc),'NetPrice':_0x4aeaea(0x18f),'discount':_0x4aeaea(0x17d),'adj_discount':_0x4aeaea(0x1c3),'product_details':{'prod_name':_0x4aeaea(0xf2),'product_code':'$product_info.product_code','category':_0x4aeaea(0x87),'brand':_0x4aeaea(0x98),'gross_price':_0x4aeaea(0xac)}}}}},{'$unwind':_0x4aeaea(0xf5)},{'$group':{'_id':{'dsi':_0x4aeaea(0xf7),'date':_0x4aeaea(0x203),'customer':_0x4aeaea(0x12e),'category':_0x4aeaea(0x1c2),'brand':_0x4aeaea(0x1af)},'totalQty':{'$sum':_0x4aeaea(0x11d)},'totalGross':{'$sum':{'$multiply':[_0x4aeaea(0x11d),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x4aeaea(0x205)},'adj_discount':{'$sum':_0x4aeaea(0xfd)},'product_details':{'$first':_0x4aeaea(0x12a)}}},{'$group':{'_id':{'dsi':_0x4aeaea(0xf7),'date':_0x4aeaea(0x203),'customer':'$_id.customer'},'totalQty':{'$sum':_0x4aeaea(0x1bf)},'totalGross':{'$sum':_0x4aeaea(0x1cc)},'NetPrice':{'$sum':_0x4aeaea(0xa6)},'discount':{'$sum':_0x4aeaea(0x10a)},'adj_discount':{'$sum':_0x4aeaea(0x19e)},'products':{'$push':{'qty':_0x4aeaea(0x1bf),'category':'$_id.category','brand':_0x4aeaea(0x147),'product_details':_0x4aeaea(0xce)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x46443f=[],_0x18ac2d={},_0x31f6a5={},_0x21d613={};var _0xe0826e=0x0,_0x569837=0x0,_0x1c6b4c=0x0,_0x4317b5=0x0,_0x25b078=0x0;const _0x521a38=0x6;for(let _0x279e58=0x0;_0x279e58<=_0x1a9cd5[_0x4aeaea(0x1d0)]-0x1;_0x279e58++){const _0x208e71=_0x1a9cd5[_0x279e58];let _0x5176df=_0x4aeaea(0xa2);_0x5176df+=_0x4aeaea(0xcb)+_0x208e71[_0x4aeaea(0x8b)][_0x4aeaea(0x16e)]+'</td>',_0x5176df+=_0x4aeaea(0xcb)+_0x208e71[_0x4aeaea(0x8b)]['date']+_0x4aeaea(0x1be),_0x5176df+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x208e71[_0x4aeaea(0x8b)][_0x4aeaea(0x19d)]+_0x4aeaea(0x1be);let _0x50e77d={};var _0x5e1e26=0x0;for(let _0x53aa5e=0x0;_0x53aa5e<=_0x208e71[_0x4aeaea(0xab)][_0x4aeaea(0x1d0)]-0x1;_0x53aa5e++){const _0x1b15f9=_0x208e71['products'][_0x53aa5e];_0x50e77d[_0x1b15f9[_0x4aeaea(0x12c)]+'-'+_0x1b15f9[_0x4aeaea(0xc8)]]=_0x1b15f9[_0x4aeaea(0x199)];const _0x966463=_0x1b15f9[_0x4aeaea(0x12c)]+'-'+_0x1b15f9[_0x4aeaea(0xc8)];!_0x18ac2d[_0x966463]&&(_0x18ac2d[_0x966463]=0x0),!Array[_0x4aeaea(0x17f)](_0x21d613[_0x966463])&&(_0x21d613[_0x966463]=[]),!Array[_0x4aeaea(0x17f)](_0x21d613[_0x966463])&&(_0x21d613[_0x966463]=[]),_0x18ac2d[_0x966463]+=_0x1b15f9['qty'],_0x21d613[_0x966463][_0x4aeaea(0x170)](_0x1b15f9[_0x4aeaea(0x199)]),_0x5e1e26++;}console[_0x4aeaea(0xae)](_0x208e71);for(let _0x297919=0x0;_0x297919<=_0xff259e[_0x4aeaea(0xbf)][_0x4aeaea(0x1d0)]-0x1;_0x297919++){const _0x58a43e=_0xff259e['cat_brand'][_0x297919],_0x5e34eb=_0x58a43e[_0x4aeaea(0x8b)][_0x4aeaea(0x12c)]+'-'+_0x58a43e[_0x4aeaea(0x8b)]['category'];_0x5176df+=_0x4aeaea(0x8d)+(_0x50e77d[_0x5e34eb]!==undefined?_0x50e77d[_0x5e34eb][_0x4aeaea(0x92)](0x2):'')+_0x4aeaea(0x1be);}_0x1c6b4c=_0x208e71[_0x4aeaea(0x11b)]+_0x208e71[_0x4aeaea(0xd4)],_0x5176df+=_0x4aeaea(0x192)+formatNumber(parseFloat(_0x208e71['totalQty'],0x2)['toFixed'](0x2))+'</td>',_0x5176df+=_0x4aeaea(0x192)+formatNumber(_0x208e71[_0x4aeaea(0x1aa)][_0x4aeaea(0x92)](0x2))+_0x4aeaea(0x1be),_0x5176df+=_0x4aeaea(0x192)+formatNumber(_0x1c6b4c)+_0x4aeaea(0x1be),_0x5176df+=_0x4aeaea(0x192)+formatNumber(_0x208e71[_0x4aeaea(0x1c9)][_0x4aeaea(0x92)](0x2))+_0x4aeaea(0x1be),_0x5176df+='</tr>',_0xe0826e+=parseFloat(_0x208e71[_0x4aeaea(0x19c)][_0x4aeaea(0x92)](0x2)),_0x569837+=parseFloat(_0x208e71[_0x4aeaea(0x1c9)][_0x4aeaea(0x92)](0x2)),_0x4317b5+=_0x1c6b4c,_0x25b078+=parseFloat(_0x208e71[_0x4aeaea(0x1aa)][_0x4aeaea(0x92)](0x2));if(_0x279e58==_0x1a9cd5[_0x4aeaea(0x1d0)]-0x1){_0x5176df+=_0x4aeaea(0xa2),_0x5176df+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x5176df+=_0x4aeaea(0x1be);for(let _0x5c8304=0x0;_0x5c8304<=_0xff259e[_0x4aeaea(0xbf)]['length']-0x1;_0x5c8304++){const _0x5c6f38=_0xff259e['cat_brand'][_0x5c8304],_0x438e3b=_0x5c6f38['_id'][_0x4aeaea(0x12c)]+'-'+_0x5c6f38[_0x4aeaea(0x8b)][_0x4aeaea(0xc8)],_0x429141=_0x21d613[_0x438e3b]['reduce']((_0x5c932e,_0x258de0)=>_0x5c932e+_0x258de0,0x0);console['log'](_0x4aeaea(0x169),_0x438e3b),_0x5176df+=_0x4aeaea(0x10c)+(_0x429141!==undefined?formatNumber(_0x429141[_0x4aeaea(0x92)](0x2)):'')+_0x4aeaea(0x150),console[_0x4aeaea(0xae)](_0x21d613[_0x438e3b][_0x4aeaea(0xec)]((_0x79d849,_0x13aef0)=>_0x79d849+_0x13aef0,0x0));}_0x5176df+=_0x4aeaea(0x18a)+formatNumber(_0xe0826e[_0x4aeaea(0x92)](0x2))+_0x4aeaea(0x150),_0x5176df+=_0x4aeaea(0x18a)+formatNumber(_0x25b078)+'</b></td>',_0x5176df+=_0x4aeaea(0x18a)+formatNumber(_0x4317b5)+'</b></td>',_0x5176df+=_0x4aeaea(0x18a)+formatNumber(_0x569837)+'</b></td>',_0x5176df+=_0x4aeaea(0x134);}_0x46443f['push'](_0x5176df);}function _0x248723(_0x163d6d,_0x136fe9){const _0x18765b=_0x4aeaea,_0x292e09=[];for(let _0xbbc5dc=0x0;_0xbbc5dc<=_0x163d6d[_0x18765b(0x1d0)]-0x1;_0xbbc5dc+=_0x136fe9){_0x292e09[_0x18765b(0x170)](_0x163d6d[_0x18765b(0x1e5)](_0xbbc5dc,_0xbbc5dc+_0x136fe9));}return _0x292e09;}const _0x181fc8=_0x248723(_0x46443f,_0x521a38);let _0x485dd3='';return _0x181fc8['forEach']((_0x3212fe,_0x11f5cf)=>{const _0x5dfa8b=_0x4aeaea;_0x11f5cf>0x0&&(_0x485dd3+=_0x5dfa8b(0x105));_0x485dd3+='<table>',_0x485dd3+=_0x5dfa8b(0xf3),_0x485dd3+=_0x5dfa8b(0xa2),_0x485dd3+=_0x5dfa8b(0x175),_0x485dd3+=_0x5dfa8b(0x134),_0x485dd3+='<tr>',_0x485dd3+=_0x5dfa8b(0x1df);for(let _0x4bb82d=0x0;_0x4bb82d<=_0x21b4d6[_0x5dfa8b(0x1d0)]-0x1;_0x4bb82d++){const _0x58898e=_0x21b4d6[_0x4bb82d];for(let _0x44d6c4=0x0;_0x44d6c4<_0x8ab4b7[_0x5dfa8b(0x1d0)];_0x44d6c4++){const _0x16c55e=_0x8ab4b7[_0x44d6c4];_0x16c55e[_0x5dfa8b(0x8b)]===_0x58898e[_0x5dfa8b(0x8b)][_0x5dfa8b(0xc8)]&&(_0x485dd3+=_0x5dfa8b(0xfa)+_0x16c55e['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x58898e['_id'][_0x5dfa8b(0xc8)]+_0x5dfa8b(0x1be));}}_0x485dd3+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x485dd3+=_0x5dfa8b(0x134),_0x485dd3+='<tr>',_0x485dd3+=_0x5dfa8b(0xc3),_0x485dd3+=_0x5dfa8b(0x1a8),_0x485dd3+=_0x5dfa8b(0x191);for(let _0x2c2c33=0x0;_0x2c2c33<=_0x21b4d6[_0x5dfa8b(0x1d0)]-0x1;_0x2c2c33++){const _0x123c37=_0x21b4d6[_0x2c2c33];for(let _0x2be1e0=0x0;_0x2be1e0<_0xff259e[_0x5dfa8b(0xbf)][_0x5dfa8b(0x1d0)];_0x2be1e0++){const _0x4e5142=_0xff259e[_0x5dfa8b(0xbf)][_0x2be1e0];_0x4e5142[_0x5dfa8b(0x8b)][_0x5dfa8b(0xc8)]===_0x123c37[_0x5dfa8b(0x8b)][_0x5dfa8b(0xc8)]&&(_0x485dd3+='<td\x20class=\x22cat_data\x22>'+_0x4e5142[_0x5dfa8b(0x8b)][_0x5dfa8b(0x12c)]+_0x5dfa8b(0x1be));}}_0x485dd3+=_0x5dfa8b(0x20e),_0x485dd3+=_0x5dfa8b(0xb8),_0x485dd3+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x485dd3+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x485dd3+=_0x5dfa8b(0x134),_0x485dd3+=_0x5dfa8b(0x1c4),_0x485dd3+='<tbody>',_0x3212fe['forEach'](_0x5f1b32=>{_0x485dd3+=_0x5f1b32;}),console['log'](_0x21d613),_0x485dd3+=_0x5dfa8b(0x89),_0x485dd3+='</table>';}),_0x485dd3;}async function agentsdataDSICheck_admin_excel(_0x3fcd18,_0x537476,_0x19eccc,_0x865678){const _0x330dde=a0_0x3b11a9,_0x1cc37e=await product[_0x330dde(0xc9)]([{'$group':{'_id':{'brand':_0x330dde(0x140),'category':_0x330dde(0x124)},'products':{'$push':{'name':_0x330dde(0xbe),'product_code':_0x330dde(0x14c)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xc9e6b7=[];_0xc9e6b7[_0x330dde(0xbf)]=[];for(let _0x4ac5f1=0x0;_0x4ac5f1<=_0x1cc37e['length']-0x1;_0x4ac5f1++){const _0x1cf253=_0x1cc37e[_0x4ac5f1];_0xc9e6b7['cat_brand'][_0x330dde(0x170)](_0x1cf253);}const _0x52453b=await product[_0x330dde(0xc9)]([{'$group':{'_id':{'category':_0x330dde(0x124)},'products':{'$push':{'brand':_0x330dde(0x140),'product_code':_0x330dde(0x14c),'product_name':_0x330dde(0xbe)}}}},{'$sort':{'_id.category':-0x1}}]),_0x20f59c=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0x330dde(0x140)}}},{'$group':{'_id':_0x330dde(0xc5),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x12af6a=await sales_sa[_0x330dde(0xc9)]([{'$match':{'date':{'$gte':_0x3fcd18,'$lte':_0x537476},'sales_staff_id':_0x19eccc,'sale_product.isFG':'false'}},{'$unwind':_0x330dde(0x1cf)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x330dde(0xa1),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x330dde(0xff)},{'$group':{'_id':{'dsi':_0x330dde(0x1fc),'date':_0x330dde(0xe0),'customer':_0x330dde(0xbc)},'totalQty':{'$sum':_0x330dde(0xdc)},'products':{'$push':{'qty':_0x330dde(0xdc),'NetPrice':_0x330dde(0x18f),'discount':_0x330dde(0x17d),'adj_discount':_0x330dde(0x1c3),'product_details':{'prod_name':'$product_info.name','product_code':_0x330dde(0x174),'category':_0x330dde(0x87),'brand':'$product_info.brand','gross_price':_0x330dde(0xac)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x330dde(0xf7),'date':_0x330dde(0x203),'customer':_0x330dde(0x12e),'category':_0x330dde(0x1c2),'brand':_0x330dde(0x1af)},'totalQty':{'$sum':_0x330dde(0x11d)},'totalGross':{'$sum':{'$multiply':[_0x330dde(0x11d),_0x330dde(0x106)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x330dde(0x205)},'adj_discount':{'$sum':_0x330dde(0xfd)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x330dde(0x203),'customer':'$_id.customer'},'totalQty':{'$sum':_0x330dde(0x1bf)},'totalGross':{'$sum':_0x330dde(0x1cc)},'NetPrice':{'$sum':_0x330dde(0xa6)},'discount':{'$sum':_0x330dde(0x10a)},'adj_discount':{'$sum':_0x330dde(0x19e)},'products':{'$push':{'qty':_0x330dde(0x1bf),'category':_0x330dde(0xc5),'brand':_0x330dde(0x147),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4d960d=[],_0x188afd={},_0x231fd0={},_0x16616d={};var _0x5b80ff=0x0,_0x5d5c6d=0x0,_0x4c6884=0x0,_0x5e25b5=0x0,_0x16cf6a=0x0;const _0x11c82e=0x16345785d8a0000;for(let _0x26fff0=0x0;_0x26fff0<=_0x12af6a['length']-0x1;_0x26fff0++){const _0x1b4eee=_0x12af6a[_0x26fff0];let _0x1bd0bd='<tr>';_0x1bd0bd+=_0x330dde(0xcb)+_0x1b4eee[_0x330dde(0x8b)][_0x330dde(0x16e)]+_0x330dde(0x1be),_0x1bd0bd+=_0x330dde(0xcb)+_0x1b4eee[_0x330dde(0x8b)][_0x330dde(0x15c)]+_0x330dde(0x1be),_0x1bd0bd+=_0x330dde(0xcb)+_0x1b4eee[_0x330dde(0x8b)]['customer']+'</td>';let _0x31eb01={};var _0xbe492c=0x0;for(let _0x5f2eba=0x0;_0x5f2eba<=_0x1b4eee[_0x330dde(0xab)][_0x330dde(0x1d0)]-0x1;_0x5f2eba++){const _0x3e69a=_0x1b4eee[_0x330dde(0xab)][_0x5f2eba];_0x31eb01[_0x3e69a['brand']+'-'+_0x3e69a[_0x330dde(0xc8)]]=_0x3e69a['qty'];const _0xeac036=_0x3e69a[_0x330dde(0x12c)]+'-'+_0x3e69a[_0x330dde(0xc8)];!_0x188afd[_0xeac036]&&(_0x188afd[_0xeac036]=0x0),!Array['isArray'](_0x16616d[_0xeac036])&&(_0x16616d[_0xeac036]=[]),!Array[_0x330dde(0x17f)](_0x16616d[_0xeac036])&&(_0x16616d[_0xeac036]=[]),_0x188afd[_0xeac036]+=_0x3e69a[_0x330dde(0x199)],_0x16616d[_0xeac036][_0x330dde(0x170)](_0x3e69a['qty']),_0xbe492c++;}console[_0x330dde(0xae)](_0x1b4eee);for(let _0x26f87a=0x0;_0x26f87a<=_0xc9e6b7[_0x330dde(0xbf)][_0x330dde(0x1d0)]-0x1;_0x26f87a++){const _0x3b5a9b=_0xc9e6b7['cat_brand'][_0x26f87a],_0x13f984=_0x3b5a9b[_0x330dde(0x8b)][_0x330dde(0x12c)]+'-'+_0x3b5a9b[_0x330dde(0x8b)]['category'];_0x1bd0bd+=_0x330dde(0x8d)+(_0x31eb01[_0x13f984]!==undefined?_0x31eb01[_0x13f984][_0x330dde(0x92)](0x2):'')+_0x330dde(0x1be);}_0x4c6884=_0x1b4eee[_0x330dde(0x11b)]+_0x1b4eee[_0x330dde(0xd4)],_0x1bd0bd+=_0x330dde(0x192)+formatNumber(parseFloat(_0x1b4eee[_0x330dde(0x19c)],0x2)['toFixed'](0x2))+_0x330dde(0x1be),_0x1bd0bd+=_0x330dde(0x192)+formatNumber(_0x1b4eee['totalGross']['toFixed'](0x2))+'</td>',_0x1bd0bd+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x4c6884)+'</td>',_0x1bd0bd+=_0x330dde(0x192)+formatNumber(_0x1b4eee[_0x330dde(0x1c9)][_0x330dde(0x92)](0x2))+'</td>',_0x1bd0bd+=_0x330dde(0x134),_0x5b80ff+=parseFloat(_0x1b4eee[_0x330dde(0x19c)][_0x330dde(0x92)](0x2)),_0x5d5c6d+=parseFloat(_0x1b4eee[_0x330dde(0x1c9)][_0x330dde(0x92)](0x2)),_0x5e25b5+=_0x4c6884,_0x16cf6a+=parseFloat(_0x1b4eee[_0x330dde(0x1aa)]['toFixed'](0x2));if(_0x26fff0==_0x12af6a[_0x330dde(0x1d0)]-0x1){_0x1bd0bd+='<tr>',_0x1bd0bd+=_0x330dde(0x165),_0x1bd0bd+=_0x330dde(0x1be);for(let _0x1126f3=0x0;_0x1126f3<=_0xc9e6b7[_0x330dde(0xbf)]['length']-0x1;_0x1126f3++){const _0x4d8829=_0xc9e6b7[_0x330dde(0xbf)][_0x1126f3],_0x1d0657=_0x4d8829[_0x330dde(0x8b)]['brand']+'-'+_0x4d8829[_0x330dde(0x8b)][_0x330dde(0xc8)],_0x451ae4=_0x16616d[_0x1d0657]['reduce']((_0x4ff8ac,_0x46b02d)=>_0x4ff8ac+_0x46b02d,0x0);console[_0x330dde(0xae)](_0x330dde(0x169),_0x1d0657),_0x1bd0bd+=_0x330dde(0x10c)+(_0x451ae4!==undefined?formatNumber(_0x451ae4[_0x330dde(0x92)](0x2)):'')+_0x330dde(0x150),console[_0x330dde(0xae)](_0x16616d[_0x1d0657][_0x330dde(0xec)]((_0x4e2d44,_0x1edff2)=>_0x4e2d44+_0x1edff2,0x0));}_0x1bd0bd+=_0x330dde(0x18a)+formatNumber(_0x5b80ff[_0x330dde(0x92)](0x2))+'</b></td>',_0x1bd0bd+=_0x330dde(0x18a)+formatNumber(_0x16cf6a)+_0x330dde(0x150),_0x1bd0bd+=_0x330dde(0x18a)+formatNumber(_0x5e25b5)+'</b></td>',_0x1bd0bd+=_0x330dde(0x18a)+formatNumber(_0x5d5c6d)+_0x330dde(0x150),_0x1bd0bd+=_0x330dde(0x134);}_0x4d960d[_0x330dde(0x170)](_0x1bd0bd);}function _0x233d07(_0x22b69f,_0x217f55){const _0xc8287b=_0x330dde,_0x5584b6=[];for(let _0x279951=0x0;_0x279951<=_0x22b69f[_0xc8287b(0x1d0)]-0x1;_0x279951+=_0x217f55){_0x5584b6[_0xc8287b(0x170)](_0x22b69f[_0xc8287b(0x1e5)](_0x279951,_0x279951+_0x217f55));}return _0x5584b6;}const _0xd77310=_0x233d07(_0x4d960d,_0x11c82e);let _0x1ec28c='';return _0xd77310[_0x330dde(0xcc)]((_0x26a891,_0x16c75a)=>{const _0x311aaa=_0x330dde;_0x16c75a>0x0&&(_0x1ec28c+=_0x311aaa(0x105));_0x1ec28c+='<table>',_0x1ec28c+=_0x311aaa(0xf3),_0x1ec28c+=_0x311aaa(0xa2),_0x1ec28c+=_0x311aaa(0x175),_0x1ec28c+=_0x311aaa(0x134),_0x1ec28c+='<tr>',_0x1ec28c+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x56dc22=0x0;_0x56dc22<=_0x52453b['length']-0x1;_0x56dc22++){const _0x132ba2=_0x52453b[_0x56dc22];for(let _0xbd249f=0x0;_0xbd249f<_0x20f59c[_0x311aaa(0x1d0)];_0xbd249f++){const _0xa1be97=_0x20f59c[_0xbd249f];_0xa1be97[_0x311aaa(0x8b)]===_0x132ba2[_0x311aaa(0x8b)][_0x311aaa(0xc8)]&&(_0x1ec28c+=_0x311aaa(0xfa)+_0xa1be97['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x132ba2['_id']['category']+_0x311aaa(0x1be));}}_0x1ec28c+=_0x311aaa(0x156),_0x1ec28c+='</tr>',_0x1ec28c+=_0x311aaa(0xa2),_0x1ec28c+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x1ec28c+=_0x311aaa(0x1a8),_0x1ec28c+=_0x311aaa(0x191);for(let _0x5ef0df=0x0;_0x5ef0df<=_0x52453b[_0x311aaa(0x1d0)]-0x1;_0x5ef0df++){const _0x919cbd=_0x52453b[_0x5ef0df];for(let _0x46a714=0x0;_0x46a714<_0xc9e6b7[_0x311aaa(0xbf)][_0x311aaa(0x1d0)];_0x46a714++){const _0x11e513=_0xc9e6b7[_0x311aaa(0xbf)][_0x46a714];_0x11e513['_id']['category']===_0x919cbd[_0x311aaa(0x8b)][_0x311aaa(0xc8)]&&(_0x1ec28c+=_0x311aaa(0x136)+_0x11e513['_id']['brand']+'</td>');}}_0x1ec28c+=_0x311aaa(0x20e),_0x1ec28c+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x1ec28c+=_0x311aaa(0x1b4),_0x1ec28c+=_0x311aaa(0x12f),_0x1ec28c+=_0x311aaa(0x134),_0x1ec28c+='</thead>',_0x1ec28c+=_0x311aaa(0x19a),_0x26a891[_0x311aaa(0xcc)](_0x264e6e=>{_0x1ec28c+=_0x264e6e;}),console[_0x311aaa(0xae)](_0x16616d),_0x1ec28c+='</tbody>',_0x1ec28c+=_0x311aaa(0xd9);}),_0x1ec28c;}router[a0_0x3b11a9(0x108)]('/agent_reports/pdf_admin',auth,async(_0x2c9e2b,_0x9cdfdf)=>{const _0xa6beb7=a0_0x3b11a9,{from_date:_0xe1a225,to_date:_0x2ea3fa,isExcel:_0x3bf495,agent_id:_0x12cad4}=_0x2c9e2b[_0xa6beb7(0xa3)],_0x3652e5=_0x2c9e2b[_0xa6beb7(0x163)],_0x19758c=await staff[_0xa6beb7(0x144)]({'email':_0x3652e5['email']}),_0x55de1c=await master_shop[_0xa6beb7(0x1fb)](),_0x3ebe39=await agentsdataDSICheck_admin(_0xe1a225,_0x2ea3fa,_0x12cad4,_0x3bf495),_0x6b8d28=await agentsdataDSICheck_admin_excel(_0xe1a225,_0x2ea3fa,_0x12cad4,_0x3bf495);let _0x31a8f0=_0xa6beb7(0x200);var _0x49a3d8=new Date(_0xe1a225),_0x4762d2=new Date(_0x2ea3fa);const _0x406b17={'year':'numeric','month':_0xa6beb7(0x188),'day':'numeric'},_0x52f17e=new Intl[(_0xa6beb7(0x1a4))]('en-US',_0x406b17)[_0xa6beb7(0xea)](_0x49a3d8),_0xbe517d=new Intl[(_0xa6beb7(0x1a4))](_0xa6beb7(0x1e3),_0x406b17)[_0xa6beb7(0xea)](_0x4762d2);_0x31a8f0+=_0xa6beb7(0x10b),_0x31a8f0+='<div\x20\x20id=\x22table-conatainer\x22>',_0x31a8f0+=_0xa6beb7(0x130),_0x31a8f0+=_0x3ebe39,_0x31a8f0+='</table>',_0x31a8f0+='</div>',_0x31a8f0+=_0xa6beb7(0x178);let _0x47e668=_0xa6beb7(0x200);_0x47e668+=_0xa6beb7(0x10b),_0x47e668+=_0xa6beb7(0xd1),_0x47e668+='<table>',_0x47e668+=_0x6b8d28,_0x47e668+='</table>',_0x47e668+=_0xa6beb7(0x178),_0x47e668+=_0xa6beb7(0x178);let _0xf5a616='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x4c9924={'width':_0xa6beb7(0x1b9),'height':_0xa6beb7(0x196),'orientation':_0xa6beb7(0x1d3),'border':{'top':_0xa6beb7(0x185),'right':_0xa6beb7(0x185),'bottom':_0xa6beb7(0x185),'left':_0xa6beb7(0x185)},'header':{'height':_0xa6beb7(0x1f7),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xf5a616+_0xa6beb7(0x107)+_0x52f17e+_0xa6beb7(0x1ab)+_0xbe517d+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0xa6beb7(0x189),'contents':{'default':_0xa6beb7(0x202)}},'dpi':0x5,'zoomFactor':'1'};if(_0x3bf495=='on'){const _0x581251=cheerio[_0xa6beb7(0x1c7)](_0x47e668);let _0x2edd5b=[],_0x37bbae=[],_0x3e5e46=[];_0x581251('table\x20tr')[_0xa6beb7(0x14f)]((_0x1a85cb,_0x42257e)=>{const _0x1744c1=_0xa6beb7;let _0x128fd2=[],_0xd165ce=0x0;while(_0x3e5e46[_0xd165ce]){_0x3e5e46[_0xd165ce]--,_0xd165ce++;}_0x581251(_0x42257e)['find'](_0x1744c1(0x1b2))['each']((_0xacd581,_0x5244a5)=>{const _0x586cdf=_0x1744c1;let _0x42d6c1=_0x581251(_0x5244a5)[_0x586cdf(0x18b)]()[_0x586cdf(0x1c0)](),_0x33e363=parseFloat(_0x42d6c1[_0x586cdf(0xa9)](/,/g,''));isNaN(_0x33e363)&&(_0x33e363=_0x42d6c1);let _0x3dacc0=parseInt(_0x581251(_0x5244a5)[_0x586cdf(0xcd)](_0x586cdf(0x88)))||0x1,_0x10b853=parseInt(_0x581251(_0x5244a5)[_0x586cdf(0xcd)](_0x586cdf(0x1fa)))||0x1;_0x128fd2[_0xd165ce]=_0x33e363;(_0x3dacc0>0x1||_0x10b853>0x1)&&_0x37bbae['push']({'s':{'r':_0x1a85cb,'c':_0xd165ce},'e':{'r':_0x1a85cb+_0x10b853-0x1,'c':_0xd165ce+_0x3dacc0-0x1}});for(let _0x2d89c4=0x0;_0x2d89c4<_0x3dacc0;_0x2d89c4++){_0x10b853>0x1&&(_0x3e5e46[_0xd165ce+_0x2d89c4]=_0x10b853-0x1);}_0xd165ce+=_0x3dacc0;}),_0x2edd5b[_0x1744c1(0x170)](_0x128fd2);});const _0x20f7d6=XLSX[_0xa6beb7(0x17a)][_0xa6beb7(0x173)](),_0x9f71fd=XLSX[_0xa6beb7(0x17a)][_0xa6beb7(0xf8)](_0x2edd5b);_0x37bbae[_0xa6beb7(0x1d0)]>0x0&&(_0x9f71fd[_0xa6beb7(0x8c)]=_0x37bbae);_0x9f71fd[_0xa6beb7(0xb6)]=_0x2edd5b[0x0][_0xa6beb7(0x128)](()=>({'wpx':0x64})),XLSX[_0xa6beb7(0x17a)]['book_append_sheet'](_0x20f7d6,_0x9f71fd,_0xa6beb7(0x17b));const _0xeabeb1=XLSX[_0xa6beb7(0xb9)](_0x20f7d6,{'bookType':_0xa6beb7(0x142),'type':_0xa6beb7(0x20b)});_0x9cdfdf[_0xa6beb7(0x141)](_0xa6beb7(0x1ce),_0xa6beb7(0x1b3)),_0x9cdfdf[_0xa6beb7(0x141)](_0xa6beb7(0xb1),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x9cdfdf[_0xa6beb7(0xf4)](_0xeabeb1);}else pdf[_0xa6beb7(0xb2)](_0x31a8f0,_0x4c9924)[_0xa6beb7(0x1b1)](function(_0x5e9f41,_0x499660){const _0x425bd1=_0xa6beb7;if(_0x5e9f41){_0x9cdfdf[_0x425bd1(0xc1)](0x1f4)[_0x425bd1(0xf4)](_0x425bd1(0xc0));return;}_0x9cdfdf[_0x425bd1(0x141)]('Content-Type',_0x425bd1(0xca)),_0x499660['pipe'](_0x9cdfdf);});}),router[a0_0x3b11a9(0xe9)](a0_0x3b11a9(0x1d2),auth,async(_0x114ad1,_0x6f12df)=>{const _0x44eddb=a0_0x3b11a9;try{const {username:_0x56b423,email:_0x380aba,role:_0x4b946e}=_0x114ad1[_0x44eddb(0x163)],_0x63174a=_0x114ad1['user'],_0x1bc538=await profile[_0x44eddb(0x144)]({'email':_0x63174a[_0x44eddb(0x15d)]}),_0x10dc8c={'year':_0x44eddb(0x1cb),'month':_0x44eddb(0x188),'day':_0x44eddb(0x1cb)},_0x1c91eb=await master_shop[_0x44eddb(0x1fb)](),_0x48ed3f=await staff['findOne']({'email':_0x63174a[_0x44eddb(0x15d)]}),_0x3e3de5=await product[_0x44eddb(0x1fb)](),_0x48fcd6=await warehouse[_0x44eddb(0xc9)]([{'$unwind':_0x44eddb(0xce)},{'$lookup':{'from':_0x44eddb(0xab),'localField':_0x44eddb(0x207),'foreignField':_0x44eddb(0x110),'as':_0x44eddb(0x17e)}},{'$unwind':_0x44eddb(0x8a)},{'$project':{'product_name':_0x44eddb(0x208),'product_stock':_0x44eddb(0x1f4)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);if(_0x1c91eb[0x0][_0x44eddb(0xa4)]==_0x44eddb(0xf9))var _0x151527=users['English'];else{if(_0x1c91eb[0x0][_0x44eddb(0xa4)]=='Hindi')var _0x151527=users[_0x44eddb(0x159)];else{if(_0x1c91eb[0x0]['language']==_0x44eddb(0xb3))var _0x151527=users[_0x44eddb(0xb3)];else{if(_0x1c91eb[0x0][_0x44eddb(0xa4)]==_0x44eddb(0x154))var _0x151527=users[_0x44eddb(0x154)];else{if(_0x1c91eb[0x0]['language']==_0x44eddb(0x17c))var _0x151527=users[_0x44eddb(0x17c)];else{if(_0x1c91eb[0x0]['language']==_0x44eddb(0xb4))var _0x151527=users[_0x44eddb(0x137)];else{if(_0x1c91eb[0x0][_0x44eddb(0xa4)]==_0x44eddb(0x118))var _0x151527=users[_0x44eddb(0x118)];else{if(_0x1c91eb[0x0]['language']==_0x44eddb(0x1ba))var _0x151527=users['Arabic'];}}}}}}}_0x6f12df[_0x44eddb(0xb0)](_0x44eddb(0x13c),{'success':_0x114ad1['flash'](_0x44eddb(0x1f0)),'errors':_0x114ad1[_0x44eddb(0x1c6)]('errors'),'alldata':_0x3e3de5,'profile':_0x1bc538,'master_shop':_0x1c91eb,'role':_0x63174a,'product_stock':_0x48fcd6,'language':_0x151527,'staff_arr':_0x48ed3f});}catch(_0x261af9){}});function formatNumber(_0x29192c,_0x4cf8e4=a0_0x3b11a9(0x1e3),_0x4499e8={'minimumFractionDigits':0x2}){const _0x234bef=a0_0x3b11a9,_0x1701dc=new Intl[(_0x234bef(0xe8))](_0x4cf8e4,_0x4499e8);return _0x1701dc[_0x234bef(0xea)](_0x29192c);}async function agentsdataDSICheck(_0x130cf6,_0x4813fc,_0xc8d1f6,_0x23118a){const _0x11cba7=a0_0x3b11a9,_0x317033=await product['aggregate']([{'$group':{'_id':{'brand':_0x11cba7(0x140),'category':_0x11cba7(0x124)},'products':{'$push':{'name':_0x11cba7(0xbe),'product_code':_0x11cba7(0x14c)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x208941=[];_0x208941['cat_brand']=[];for(let _0x4b82e5=0x0;_0x4b82e5<=_0x317033['length']-0x1;_0x4b82e5++){const _0x50bb9d=_0x317033[_0x4b82e5];_0x208941[_0x11cba7(0xbf)][_0x11cba7(0x170)](_0x50bb9d);}const _0x48d0b1=await product['aggregate']([{'$group':{'_id':{'category':_0x11cba7(0x124)},'products':{'$push':{'brand':_0x11cba7(0x140),'product_code':_0x11cba7(0x14c),'product_name':_0x11cba7(0xbe)}}}},{'$sort':{'_id.category':-0x1}}]),_0x56dc4f=await product[_0x11cba7(0xc9)]([{'$group':{'_id':{'category':'$category','brand':_0x11cba7(0x140)}}},{'$group':{'_id':_0x11cba7(0xc5),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x362bf2=await sales_sa[_0x11cba7(0xc9)]([{'$match':{'date':{'$gte':_0x130cf6,'$lte':_0x4813fc},'sales_staff_id':_0xc8d1f6,'sale_product.isFG':'false'}},{'$unwind':_0x11cba7(0x1cf)},{'$match':{'sale_product.isFG':_0x11cba7(0x1e4)}},{'$lookup':{'from':_0x11cba7(0xab),'localField':_0x11cba7(0xa1),'foreignField':_0x11cba7(0x139),'as':_0x11cba7(0x1ea)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':_0x11cba7(0xe0),'customer':_0x11cba7(0xbc)},'totalQty':{'$sum':_0x11cba7(0xdc)},'products':{'$push':{'qty':_0x11cba7(0xdc),'NetPrice':_0x11cba7(0x18f),'discount':_0x11cba7(0x17d),'adj_discount':_0x11cba7(0x1c3),'product_details':{'prod_name':_0x11cba7(0xf2),'product_code':_0x11cba7(0x174),'category':_0x11cba7(0x87),'brand':_0x11cba7(0x98),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x11cba7(0xf5)},{'$group':{'_id':{'dsi':_0x11cba7(0xf7),'date':'$_id.date','customer':_0x11cba7(0x12e),'category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x11cba7(0x11d)},'totalGross':{'$sum':{'$multiply':[_0x11cba7(0x11d),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x11cba7(0x205)},'adj_discount':{'$sum':_0x11cba7(0xfd)},'product_details':{'$first':_0x11cba7(0x12a)}}},{'$group':{'_id':{'dsi':_0x11cba7(0xf7),'date':_0x11cba7(0x203),'customer':_0x11cba7(0x12e)},'totalQty':{'$sum':_0x11cba7(0x1bf)},'totalGross':{'$sum':_0x11cba7(0x1cc)},'NetPrice':{'$sum':_0x11cba7(0xa6)},'discount':{'$sum':_0x11cba7(0x10a)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x11cba7(0x1bf),'category':'$_id.category','brand':_0x11cba7(0x147),'product_details':_0x11cba7(0xce)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x37a407=[],_0x5eb590={},_0x1d0755={},_0x1b1b51={};var _0x2e7f9b=0x0,_0x5a410e=0x0,_0x689e2a=0x0,_0x3b9df1=0x0,_0x390f77=0x0;const _0x49a956=0x6;for(let _0x4290ff=0x0;_0x4290ff<=_0x362bf2['length']-0x1;_0x4290ff++){const _0x1f7795=_0x362bf2[_0x4290ff];let _0x4ef25a='<tr>';_0x4ef25a+=_0x11cba7(0xcb)+_0x1f7795[_0x11cba7(0x8b)][_0x11cba7(0x16e)]+_0x11cba7(0x1be),_0x4ef25a+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x1f7795[_0x11cba7(0x8b)][_0x11cba7(0x15c)]+_0x11cba7(0x1be),_0x4ef25a+=_0x11cba7(0xcb)+_0x1f7795['_id'][_0x11cba7(0x19d)]+'</td>';let _0x111d99={};var _0x13565a=0x0;for(let _0x1313b6=0x0;_0x1313b6<=_0x1f7795['products'][_0x11cba7(0x1d0)]-0x1;_0x1313b6++){const _0x255fcb=_0x1f7795['products'][_0x1313b6];_0x111d99[_0x255fcb['brand']+'-'+_0x255fcb[_0x11cba7(0xc8)]]=_0x255fcb[_0x11cba7(0x199)];const _0x1a98ad=_0x255fcb[_0x11cba7(0x12c)]+'-'+_0x255fcb[_0x11cba7(0xc8)];!_0x5eb590[_0x1a98ad]&&(_0x5eb590[_0x1a98ad]=0x0),!Array[_0x11cba7(0x17f)](_0x1b1b51[_0x1a98ad])&&(_0x1b1b51[_0x1a98ad]=[]),!Array['isArray'](_0x1b1b51[_0x1a98ad])&&(_0x1b1b51[_0x1a98ad]=[]),_0x5eb590[_0x1a98ad]+=_0x255fcb[_0x11cba7(0x199)],_0x1b1b51[_0x1a98ad][_0x11cba7(0x170)](_0x255fcb['qty']),_0x13565a++;}console['log'](_0x1f7795);for(let _0x47ddf8=0x0;_0x47ddf8<=_0x208941[_0x11cba7(0xbf)][_0x11cba7(0x1d0)]-0x1;_0x47ddf8++){const _0x429c22=_0x208941[_0x11cba7(0xbf)][_0x47ddf8],_0x52134f=_0x429c22['_id'][_0x11cba7(0x12c)]+'-'+_0x429c22[_0x11cba7(0x8b)][_0x11cba7(0xc8)];_0x4ef25a+=_0x11cba7(0x8d)+(_0x111d99[_0x52134f]!==undefined?_0x111d99[_0x52134f][_0x11cba7(0x92)](0x2):'')+_0x11cba7(0x1be);}_0x689e2a=_0x1f7795[_0x11cba7(0x11b)]+_0x1f7795['adj_discount'],_0x4ef25a+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x1f7795[_0x11cba7(0x19c)],0x2)[_0x11cba7(0x92)](0x2))+'</td>',_0x4ef25a+=_0x11cba7(0x192)+formatNumber(_0x1f7795['totalGross'][_0x11cba7(0x92)](0x2))+_0x11cba7(0x1be),_0x4ef25a+=_0x11cba7(0x192)+formatNumber(_0x689e2a)+'</td>',_0x4ef25a+=_0x11cba7(0x192)+formatNumber(_0x1f7795[_0x11cba7(0x1c9)]['toFixed'](0x2))+_0x11cba7(0x1be),_0x4ef25a+=_0x11cba7(0x134),_0x2e7f9b+=parseFloat(_0x1f7795[_0x11cba7(0x19c)][_0x11cba7(0x92)](0x2)),_0x5a410e+=parseFloat(_0x1f7795[_0x11cba7(0x1c9)][_0x11cba7(0x92)](0x2)),_0x3b9df1+=_0x689e2a,_0x390f77+=parseFloat(_0x1f7795[_0x11cba7(0x1aa)][_0x11cba7(0x92)](0x2));if(_0x4290ff==_0x362bf2[_0x11cba7(0x1d0)]-0x1){_0x4ef25a+=_0x11cba7(0xa2),_0x4ef25a+=_0x11cba7(0x165),_0x4ef25a+=_0x11cba7(0x1be);for(let _0x30f3a7=0x0;_0x30f3a7<=_0x208941[_0x11cba7(0xbf)][_0x11cba7(0x1d0)]-0x1;_0x30f3a7++){const _0x5d75b2=_0x208941[_0x11cba7(0xbf)][_0x30f3a7],_0x3243b9=_0x5d75b2['_id'][_0x11cba7(0x12c)]+'-'+_0x5d75b2[_0x11cba7(0x8b)][_0x11cba7(0xc8)],_0x370796=_0x1b1b51[_0x3243b9][_0x11cba7(0xec)]((_0x26065d,_0x2915c6)=>_0x26065d+_0x2915c6,0x0);_0x4ef25a+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x370796!==undefined?formatNumber(_0x370796[_0x11cba7(0x92)](0x2)):'')+_0x11cba7(0x150),console[_0x11cba7(0xae)](_0x1b1b51[_0x3243b9][_0x11cba7(0xec)]((_0x117d68,_0x5d7df1)=>_0x117d68+_0x5d7df1,0x0));}_0x4ef25a+=_0x11cba7(0x18a)+formatNumber(_0x2e7f9b[_0x11cba7(0x92)](0x2))+_0x11cba7(0x150),_0x4ef25a+=_0x11cba7(0x18a)+formatNumber(_0x390f77)+_0x11cba7(0x150),_0x4ef25a+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3b9df1)+_0x11cba7(0x150),_0x4ef25a+=_0x11cba7(0x18a)+formatNumber(_0x5a410e)+_0x11cba7(0x150),_0x4ef25a+=_0x11cba7(0x134);}_0x37a407['push'](_0x4ef25a);}function _0x22bef8(_0x5ee8a1,_0x1aff33){const _0x15d3dd=_0x11cba7,_0x2e2002=[];for(let _0x4dedd2=0x0;_0x4dedd2<=_0x5ee8a1[_0x15d3dd(0x1d0)]-0x1;_0x4dedd2+=_0x1aff33){_0x2e2002['push'](_0x5ee8a1[_0x15d3dd(0x1e5)](_0x4dedd2,_0x4dedd2+_0x1aff33));}return _0x2e2002;}const _0x28daf9=_0x22bef8(_0x37a407,_0x49a956);let _0xe1d0e0='';return _0x28daf9[_0x11cba7(0xcc)]((_0x57df24,_0x2146fe)=>{const _0x4c7de4=_0x11cba7;_0x2146fe>0x0&&(_0xe1d0e0+=_0x4c7de4(0x105));_0xe1d0e0+=_0x4c7de4(0x130),_0xe1d0e0+=_0x4c7de4(0xf3),_0xe1d0e0+=_0x4c7de4(0xa2),_0xe1d0e0+=_0x4c7de4(0x175),_0xe1d0e0+=_0x4c7de4(0x134),_0xe1d0e0+=_0x4c7de4(0xa2),_0xe1d0e0+=_0x4c7de4(0x1df);for(let _0x38135a=0x0;_0x38135a<=_0x48d0b1[_0x4c7de4(0x1d0)]-0x1;_0x38135a++){const _0x386b27=_0x48d0b1[_0x38135a];for(let _0x46b71e=0x0;_0x46b71e<_0x56dc4f[_0x4c7de4(0x1d0)];_0x46b71e++){const _0x1d8fa2=_0x56dc4f[_0x46b71e];_0x1d8fa2[_0x4c7de4(0x8b)]===_0x386b27[_0x4c7de4(0x8b)][_0x4c7de4(0xc8)]&&(_0xe1d0e0+='<td\x20colspan=\x22'+_0x1d8fa2['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x386b27['_id'][_0x4c7de4(0xc8)]+_0x4c7de4(0x1be));}}_0xe1d0e0+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0xe1d0e0+='</tr>',_0xe1d0e0+='<tr>',_0xe1d0e0+=_0x4c7de4(0xc3),_0xe1d0e0+=_0x4c7de4(0x1a8),_0xe1d0e0+=_0x4c7de4(0x191);for(let _0x1bed5d=0x0;_0x1bed5d<=_0x48d0b1[_0x4c7de4(0x1d0)]-0x1;_0x1bed5d++){const _0x4ef126=_0x48d0b1[_0x1bed5d];for(let _0x25a59a=0x0;_0x25a59a<_0x208941[_0x4c7de4(0xbf)][_0x4c7de4(0x1d0)];_0x25a59a++){const _0x289342=_0x208941['cat_brand'][_0x25a59a];_0x289342[_0x4c7de4(0x8b)][_0x4c7de4(0xc8)]===_0x4ef126['_id'][_0x4c7de4(0xc8)]&&(_0xe1d0e0+='<td\x20class=\x22cat_data\x22>'+_0x289342[_0x4c7de4(0x8b)][_0x4c7de4(0x12c)]+_0x4c7de4(0x1be));}}_0xe1d0e0+=_0x4c7de4(0x20e),_0xe1d0e0+=_0x4c7de4(0xb8),_0xe1d0e0+=_0x4c7de4(0x1b4),_0xe1d0e0+=_0x4c7de4(0x12f),_0xe1d0e0+=_0x4c7de4(0x134),_0xe1d0e0+=_0x4c7de4(0x1c4),_0xe1d0e0+='<tbody>',_0x57df24[_0x4c7de4(0xcc)](_0x1e548b=>{_0xe1d0e0+=_0x1e548b;}),console[_0x4c7de4(0xae)](_0x1b1b51),_0xe1d0e0+=_0x4c7de4(0x89),_0xe1d0e0+=_0x4c7de4(0xd9);}),_0xe1d0e0;}async function agentsdataDSICheck_excel(_0x574415,_0xb66793,_0x347327,_0x145aa2){const _0x4dd380=a0_0x3b11a9,_0x498a0d=await product[_0x4dd380(0xc9)]([{'$group':{'_id':{'brand':_0x4dd380(0x140),'category':'$category'},'products':{'$push':{'name':_0x4dd380(0xbe),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xf531dd=[];_0xf531dd[_0x4dd380(0xbf)]=[];for(let _0x6fa963=0x0;_0x6fa963<=_0x498a0d['length']-0x1;_0x6fa963++){const _0x4d4c45=_0x498a0d[_0x6fa963];_0xf531dd['cat_brand'][_0x4dd380(0x170)](_0x4d4c45);}const _0x8ae66a=await product[_0x4dd380(0xc9)]([{'$group':{'_id':{'category':_0x4dd380(0x124)},'products':{'$push':{'brand':_0x4dd380(0x140),'product_code':_0x4dd380(0x14c),'product_name':_0x4dd380(0xbe)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5bd7cb=await product['aggregate']([{'$group':{'_id':{'category':_0x4dd380(0x124),'brand':_0x4dd380(0x140)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1a363b=await sales_sa[_0x4dd380(0xc9)]([{'$match':{'date':{'$gte':_0x574415,'$lte':_0xb66793},'sales_staff_id':_0x347327,'sale_product.isFG':_0x4dd380(0x1e4)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x4dd380(0x1e4)}},{'$lookup':{'from':'products','localField':_0x4dd380(0xa1),'foreignField':_0x4dd380(0x139),'as':_0x4dd380(0x1ea)}},{'$unwind':_0x4dd380(0xff)},{'$group':{'_id':{'dsi':_0x4dd380(0x1fc),'date':'$date','customer':_0x4dd380(0xbc)},'totalQty':{'$sum':_0x4dd380(0xdc)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x4dd380(0x17d),'adj_discount':_0x4dd380(0x1c3),'product_details':{'prod_name':_0x4dd380(0xf2),'product_code':_0x4dd380(0x174),'category':'$product_info.category','brand':_0x4dd380(0x98),'gross_price':_0x4dd380(0xac)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x4dd380(0xf7),'date':'$_id.date','customer':'$_id.customer','category':_0x4dd380(0x1c2),'brand':_0x4dd380(0x1af)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x4dd380(0x106)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x4dd380(0xfd)},'product_details':{'$first':_0x4dd380(0x12a)}}},{'$group':{'_id':{'dsi':_0x4dd380(0xf7),'date':'$_id.date','customer':_0x4dd380(0x12e)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x4dd380(0x1cc)},'NetPrice':{'$sum':_0x4dd380(0xa6)},'discount':{'$sum':_0x4dd380(0x10a)},'adj_discount':{'$sum':_0x4dd380(0x19e)},'products':{'$push':{'qty':_0x4dd380(0x1bf),'category':_0x4dd380(0xc5),'brand':_0x4dd380(0x147),'product_details':_0x4dd380(0xce)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x17feb6=[],_0x84508b={},_0x28c18d={},_0x1c5f96={};var _0x15c8e9=0x0,_0x25e465=0x0,_0x233863=0x0,_0x333270=0x0,_0x1b259a=0x0;const _0x40c00b=0x9184e72a000;for(let _0x322da4=0x0;_0x322da4<=_0x1a363b[_0x4dd380(0x1d0)]-0x1;_0x322da4++){const _0x4f6558=_0x1a363b[_0x322da4];let _0x203ec4=_0x4dd380(0xa2);_0x203ec4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x4f6558[_0x4dd380(0x8b)][_0x4dd380(0x16e)]+_0x4dd380(0x1be),_0x203ec4+=_0x4dd380(0xcb)+_0x4f6558[_0x4dd380(0x8b)][_0x4dd380(0x15c)]+_0x4dd380(0x1be),_0x203ec4+=_0x4dd380(0xcb)+_0x4f6558[_0x4dd380(0x8b)]['customer']+'</td>';let _0x51d1f0={};var _0x3a8c9d=0x0;for(let _0x520398=0x0;_0x520398<=_0x4f6558[_0x4dd380(0xab)][_0x4dd380(0x1d0)]-0x1;_0x520398++){const _0x2e39be=_0x4f6558[_0x4dd380(0xab)][_0x520398];_0x51d1f0[_0x2e39be[_0x4dd380(0x12c)]+'-'+_0x2e39be[_0x4dd380(0xc8)]]=_0x2e39be[_0x4dd380(0x199)];const _0xe9ad51=_0x2e39be[_0x4dd380(0x12c)]+'-'+_0x2e39be['category'];!_0x84508b[_0xe9ad51]&&(_0x84508b[_0xe9ad51]=0x0),!Array[_0x4dd380(0x17f)](_0x1c5f96[_0xe9ad51])&&(_0x1c5f96[_0xe9ad51]=[]),!Array['isArray'](_0x1c5f96[_0xe9ad51])&&(_0x1c5f96[_0xe9ad51]=[]),_0x84508b[_0xe9ad51]+=_0x2e39be['qty'],_0x1c5f96[_0xe9ad51][_0x4dd380(0x170)](_0x2e39be[_0x4dd380(0x199)]),_0x3a8c9d++;}console['log'](_0x4f6558);for(let _0x1fda2c=0x0;_0x1fda2c<=_0xf531dd['cat_brand'][_0x4dd380(0x1d0)]-0x1;_0x1fda2c++){const _0x1bd1f0=_0xf531dd[_0x4dd380(0xbf)][_0x1fda2c],_0x271b26=_0x1bd1f0[_0x4dd380(0x8b)][_0x4dd380(0x12c)]+'-'+_0x1bd1f0['_id'][_0x4dd380(0xc8)];_0x203ec4+=_0x4dd380(0x8d)+(_0x51d1f0[_0x271b26]!==undefined?_0x51d1f0[_0x271b26]['toFixed'](0x2):'')+_0x4dd380(0x1be);}_0x233863=_0x4f6558[_0x4dd380(0x11b)]+_0x4f6558[_0x4dd380(0xd4)],_0x203ec4+=_0x4dd380(0x192)+formatNumber(parseFloat(_0x4f6558[_0x4dd380(0x19c)],0x2)[_0x4dd380(0x92)](0x2))+_0x4dd380(0x1be),_0x203ec4+=_0x4dd380(0x192)+formatNumber(_0x4f6558['totalGross']['toFixed'](0x2))+_0x4dd380(0x1be),_0x203ec4+=_0x4dd380(0x192)+formatNumber(_0x233863)+_0x4dd380(0x1be),_0x203ec4+=_0x4dd380(0x192)+formatNumber(_0x4f6558[_0x4dd380(0x1c9)][_0x4dd380(0x92)](0x2))+_0x4dd380(0x1be),_0x203ec4+='</tr>',_0x15c8e9+=parseFloat(_0x4f6558[_0x4dd380(0x19c)][_0x4dd380(0x92)](0x2)),_0x25e465+=parseFloat(_0x4f6558[_0x4dd380(0x1c9)][_0x4dd380(0x92)](0x2)),_0x333270+=_0x233863,_0x1b259a+=parseFloat(_0x4f6558[_0x4dd380(0x1aa)][_0x4dd380(0x92)](0x2));if(_0x322da4==_0x1a363b['length']-0x1){_0x203ec4+=_0x4dd380(0xa2),_0x203ec4+=_0x4dd380(0x165),_0x203ec4+=_0x4dd380(0x1be);for(let _0x12acf8=0x0;_0x12acf8<=_0xf531dd[_0x4dd380(0xbf)]['length']-0x1;_0x12acf8++){const _0x15ce4b=_0xf531dd[_0x4dd380(0xbf)][_0x12acf8],_0x577e39=_0x15ce4b[_0x4dd380(0x8b)][_0x4dd380(0x12c)]+'-'+_0x15ce4b['_id']['category'],_0x4732aa=_0x1c5f96[_0x577e39][_0x4dd380(0xec)]((_0x5dd8e7,_0x4e1c2c)=>_0x5dd8e7+_0x4e1c2c,0x0);_0x203ec4+=_0x4dd380(0x10c)+(_0x4732aa!==undefined?formatNumber(_0x4732aa['toFixed'](0x2)):'')+_0x4dd380(0x150),console[_0x4dd380(0xae)](_0x1c5f96[_0x577e39]['reduce']((_0x5404bd,_0x3e7921)=>_0x5404bd+_0x3e7921,0x0));}_0x203ec4+=_0x4dd380(0x18a)+formatNumber(_0x15c8e9[_0x4dd380(0x92)](0x2))+'</b></td>',_0x203ec4+=_0x4dd380(0x18a)+formatNumber(_0x1b259a)+_0x4dd380(0x150),_0x203ec4+=_0x4dd380(0x18a)+formatNumber(_0x333270)+_0x4dd380(0x150),_0x203ec4+=_0x4dd380(0x18a)+formatNumber(_0x25e465)+'</b></td>',_0x203ec4+=_0x4dd380(0x134);}_0x17feb6[_0x4dd380(0x170)](_0x203ec4);}function _0x688842(_0x3783bc,_0x25311c){const _0x2fc0d9=_0x4dd380,_0x512871=[];for(let _0x40d818=0x0;_0x40d818<=_0x3783bc[_0x2fc0d9(0x1d0)]-0x1;_0x40d818+=_0x25311c){_0x512871[_0x2fc0d9(0x170)](_0x3783bc[_0x2fc0d9(0x1e5)](_0x40d818,_0x40d818+_0x25311c));}return _0x512871;}const _0x30691b=_0x688842(_0x17feb6,_0x40c00b);let _0x44f4e3='';return _0x30691b[_0x4dd380(0xcc)]((_0x560b64,_0x5ee476)=>{const _0x1190bd=_0x4dd380;_0x5ee476>0x0&&(_0x44f4e3+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x44f4e3+=_0x1190bd(0x130),_0x44f4e3+='<thead>',_0x44f4e3+=_0x1190bd(0xa2),_0x44f4e3+=_0x1190bd(0x175),_0x44f4e3+=_0x1190bd(0x134),_0x44f4e3+=_0x1190bd(0xa2),_0x44f4e3+=_0x1190bd(0x1df);for(let _0x3d27c0=0x0;_0x3d27c0<=_0x8ae66a[_0x1190bd(0x1d0)]-0x1;_0x3d27c0++){const _0xda2361=_0x8ae66a[_0x3d27c0];for(let _0x4c35b5=0x0;_0x4c35b5<_0x5bd7cb[_0x1190bd(0x1d0)];_0x4c35b5++){const _0x465b52=_0x5bd7cb[_0x4c35b5];_0x465b52[_0x1190bd(0x8b)]===_0xda2361[_0x1190bd(0x8b)][_0x1190bd(0xc8)]&&(_0x44f4e3+='<td\x20colspan=\x22'+_0x465b52['brandCount']+_0x1190bd(0x1ef)+_0xda2361[_0x1190bd(0x8b)][_0x1190bd(0xc8)]+'</td>');}}_0x44f4e3+=_0x1190bd(0x156),_0x44f4e3+=_0x1190bd(0x134),_0x44f4e3+=_0x1190bd(0xa2),_0x44f4e3+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x44f4e3+=_0x1190bd(0x1a8),_0x44f4e3+=_0x1190bd(0x191);for(let _0x513e1c=0x0;_0x513e1c<=_0x8ae66a[_0x1190bd(0x1d0)]-0x1;_0x513e1c++){const _0xf8e4ec=_0x8ae66a[_0x513e1c];for(let _0x1262c5=0x0;_0x1262c5<_0xf531dd[_0x1190bd(0xbf)][_0x1190bd(0x1d0)];_0x1262c5++){const _0x3f9571=_0xf531dd[_0x1190bd(0xbf)][_0x1262c5];_0x3f9571[_0x1190bd(0x8b)][_0x1190bd(0xc8)]===_0xf8e4ec[_0x1190bd(0x8b)]['category']&&(_0x44f4e3+=_0x1190bd(0x136)+_0x3f9571[_0x1190bd(0x8b)][_0x1190bd(0x12c)]+_0x1190bd(0x1be));}}_0x44f4e3+=_0x1190bd(0x20e),_0x44f4e3+=_0x1190bd(0xb8),_0x44f4e3+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x44f4e3+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x44f4e3+=_0x1190bd(0x134),_0x44f4e3+=_0x1190bd(0x1c4),_0x44f4e3+=_0x1190bd(0x19a),_0x560b64[_0x1190bd(0xcc)](_0x546dfd=>{_0x44f4e3+=_0x546dfd;}),console[_0x1190bd(0xae)](_0x1c5f96),_0x44f4e3+=_0x1190bd(0x89),_0x44f4e3+=_0x1190bd(0xd9);}),_0x44f4e3;}router['post'](a0_0x3b11a9(0x180),auth,async(_0xcfcef6,_0x5ba505)=>{const _0x431145=a0_0x3b11a9,{from_date:_0x156665,to_date:_0x43da50,isExcel:_0x2b3865}=_0xcfcef6[_0x431145(0xa3)],_0xf01380=_0xcfcef6[_0x431145(0x163)],_0x45ea7d=await staff['findOne']({'email':_0xf01380[_0x431145(0x15d)]}),_0x5767fd=await master_shop[_0x431145(0x1fb)]();console[_0x431145(0xae)](_0x5767fd[0x0][_0x431145(0x182)]);const _0x105be8=await agentsdataDSICheck(_0x156665,_0x43da50,_0x45ea7d[_0x431145(0x8b)][_0x431145(0xe2)](),_0x2b3865),_0x13278a=await agentsdataDSICheck_excel(_0x156665,_0x43da50,_0x45ea7d[_0x431145(0x8b)][_0x431145(0xe2)](),_0x2b3865);let _0x57aee2=_0x431145(0x1f3);var _0x163a08=new Date(_0x156665),_0x43db10=new Date(_0x43da50);const _0xe17af9={'year':_0x431145(0x1cb),'month':_0x431145(0x188),'day':_0x431145(0x1cb)},_0x166e70=new Intl['DateTimeFormat'](_0x431145(0x1e3),_0xe17af9)['format'](_0x163a08),_0x1cbee6=new Intl['DateTimeFormat'](_0x431145(0x1e3),_0xe17af9)[_0x431145(0xea)](_0x43db10);_0x57aee2+=_0x431145(0x10b),_0x57aee2+=_0x431145(0xd1),_0x57aee2+=_0x431145(0x130),_0x57aee2+=_0x105be8,_0x57aee2+='</table>',_0x57aee2+=_0x431145(0x178),_0x57aee2+=_0x431145(0x178);let _0x20ee3b=_0x431145(0x1f3);_0x20ee3b+='<div\x20class=\x22row\x22>',_0x20ee3b+=_0x431145(0xd1),_0x20ee3b+=_0x431145(0x130),_0x20ee3b+=_0x13278a,_0x20ee3b+=_0x431145(0xd9),_0x20ee3b+=_0x431145(0x178),_0x20ee3b+=_0x431145(0x178);let _0x54d5d1=_0x431145(0x9b);const _0x137472={'width':'15in','height':_0x431145(0x196),'orientation':_0x431145(0x1d3),'border':{'top':_0x431145(0x185),'right':_0x431145(0x185),'bottom':_0x431145(0x185),'left':_0x431145(0x185)},'header':{'height':_0x431145(0x1f7),'contents':_0x431145(0x19b)+_0x54d5d1+_0x431145(0x107)+_0x166e70+'\x20-\x20'+_0x1cbee6+_0x431145(0x176)},'footer':{'height':_0x431145(0x189),'contents':{'default':_0x431145(0x202)}},'dpi':0x5,'zoomFactor':'1'};if(_0x2b3865=='on'){const _0x60e152=cheerio[_0x431145(0x1c7)](_0x20ee3b);let _0x32298d=[],_0x365a71=[],_0x197a8e=[];const _0x1914f1=_0x1b5801=>{const _0x2ee8cb=_0x431145,_0xb2b751={'top':{'style':_0x2ee8cb(0x1fd),'color':{'rgb':_0x2ee8cb(0x1da)}},'bottom':{'style':'thick','color':{'rgb':_0x2ee8cb(0x1da)}},'left':{'style':_0x2ee8cb(0x1fd),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x2ee8cb(0x1da)}}};if(_0x1b5801){const _0x4ae0a5=_0x1b5801['split'](';')['reduce']((_0x540ddc,_0x53f54f)=>{const _0x49d97a=_0x2ee8cb,[_0x6f2580,_0x2c6d43]=_0x53f54f[_0x49d97a(0x119)](':')[_0x49d97a(0x128)](_0xdcc2b=>_0xdcc2b[_0x49d97a(0x1c0)]());return _0x540ddc[_0x6f2580]=_0x2c6d43,_0x540ddc;},{});_0x4ae0a5[_0x2ee8cb(0x1d7)]&&(_0xb2b751['top'][_0x2ee8cb(0x129)]=_0x4ae0a5[_0x2ee8cb(0x1d7)][_0x2ee8cb(0x15f)](_0x2ee8cb(0x1bb))?_0x2ee8cb(0x1bb):_0x2ee8cb(0x204)),_0x4ae0a5[_0x2ee8cb(0xfe)]&&(_0xb2b751[_0x2ee8cb(0x152)][_0x2ee8cb(0x129)]=_0x4ae0a5[_0x2ee8cb(0xfe)][_0x2ee8cb(0x15f)]('thin')?_0x2ee8cb(0x1bb):_0x2ee8cb(0x204)),_0x4ae0a5['border-left']&&(_0xb2b751[_0x2ee8cb(0xd0)][_0x2ee8cb(0x129)]=_0x4ae0a5[_0x2ee8cb(0x102)]['includes'](_0x2ee8cb(0x1bb))?_0x2ee8cb(0x1bb):'medium'),_0x4ae0a5[_0x2ee8cb(0xc4)]&&(_0xb2b751[_0x2ee8cb(0x1a3)][_0x2ee8cb(0x129)]=_0x4ae0a5[_0x2ee8cb(0xc4)]['includes']('thin')?_0x2ee8cb(0x1bb):'medium');}return _0xb2b751;};_0x60e152('table\x20tr')['each']((_0x34fba7,_0x3b7e68)=>{const _0x5633d7=_0x431145;let _0x1b3a1a=[],_0x2e4862=0x0;while(_0x197a8e[_0x2e4862]){_0x197a8e[_0x2e4862]--,_0x2e4862++;}_0x60e152(_0x3b7e68)[_0x5633d7(0x1fb)](_0x5633d7(0x1b2))[_0x5633d7(0x14f)]((_0x2bb5cf,_0x2ab3a7)=>{const _0x54da8d=_0x5633d7;let _0x332de3=_0x60e152(_0x2ab3a7)[_0x54da8d(0x18b)]()['trim'](),_0x132f45=parseFloat(_0x332de3[_0x54da8d(0xa9)](/,/g,'')),_0x3e5ee4={};!isNaN(_0x132f45)?(_0x3e5ee4['v']=_0x132f45,_0x3e5ee4['t']='n'):(_0x3e5ee4['v']=_0x332de3,_0x3e5ee4['t']='s');const _0x503fde=_0x60e152(_0x2ab3a7)['attr'](_0x54da8d(0x129)),_0x39770f=_0x1914f1(_0x503fde);_0x3e5ee4['s']={'border':_0x39770f},_0x1b3a1a[_0x2e4862]=_0x3e5ee4;let _0x20f110=parseInt(_0x60e152(_0x2ab3a7)['attr']('colspan'))||0x1,_0x1d89d6=parseInt(_0x60e152(_0x2ab3a7)[_0x54da8d(0xcd)](_0x54da8d(0x1fa)))||0x1;(_0x20f110>0x1||_0x1d89d6>0x1)&&_0x365a71[_0x54da8d(0x170)]({'s':{'r':_0x34fba7,'c':_0x2e4862},'e':{'r':_0x34fba7+_0x1d89d6-0x1,'c':_0x2e4862+_0x20f110-0x1}});for(let _0x4b4e7e=0x0;_0x4b4e7e<_0x20f110;_0x4b4e7e++){_0x1d89d6>0x1&&(_0x197a8e[_0x2e4862+_0x4b4e7e]=_0x1d89d6-0x1);}_0x2e4862+=_0x20f110;}),_0x32298d['push'](_0x1b3a1a);});const _0x104399=XLSX[_0x431145(0x17a)]['book_new'](),_0x2fcbed=XLSX[_0x431145(0x17a)][_0x431145(0xf8)](_0x32298d);_0x365a71[_0x431145(0x1d0)]>0x0&&(_0x2fcbed[_0x431145(0x8c)]=_0x365a71);_0x2fcbed[_0x431145(0xb6)]=_0x32298d[0x0][_0x431145(0x128)](()=>({'wpx':0x64})),XLSX[_0x431145(0x17a)][_0x431145(0x184)](_0x104399,_0x2fcbed,_0x431145(0x17b));const _0x625730=XLSX[_0x431145(0xb9)](_0x104399,{'bookType':_0x431145(0x142),'type':_0x431145(0x20b)});_0x5ba505[_0x431145(0x141)]('Content-Disposition',_0x431145(0x1b3)),_0x5ba505[_0x431145(0x141)](_0x431145(0xb1),_0x431145(0x11a)),_0x5ba505[_0x431145(0xf4)](_0x625730);}else pdf['create'](_0x57aee2,_0x137472)[_0x431145(0x1b1)](function(_0x31a4e2,_0x1b2725){const _0x204c92=_0x431145;if(_0x31a4e2){_0x5ba505[_0x204c92(0xc1)](0x1f4)[_0x204c92(0xf4)]('Error\x20generating\x20PDF');return;}_0x5ba505[_0x204c92(0x141)](_0x204c92(0xb1),_0x204c92(0xca)),_0x1b2725[_0x204c92(0x1ec)](_0x5ba505);});}),router[a0_0x3b11a9(0xe9)]('/total_sales_reports/view',auth,async(_0x1cbcad,_0x540c20)=>{const _0x49d392=a0_0x3b11a9;try{const {username:_0x59a794,email:_0x526c39,role:_0x16619d}=_0x1cbcad['user'],_0x4b5082=_0x1cbcad['user'],_0x32839f=await profile['findOne']({'email':_0x4b5082['email']}),_0xbde69f={'year':'numeric','month':_0x49d392(0x188),'day':_0x49d392(0x1cb)},_0x2055d3=await master_shop['find'](),_0xf3d649=await product[_0x49d392(0x1fb)](),_0x32879a=await warehouse[_0x49d392(0xc9)]([{'$unwind':_0x49d392(0xce)},{'$lookup':{'from':_0x49d392(0xab),'localField':'product_details.product_name','foreignField':_0x49d392(0x110),'as':_0x49d392(0x17e)}},{'$unwind':_0x49d392(0x8a)},{'$project':{'product_name':_0x49d392(0x208),'product_stock':_0x49d392(0x1f4)}},{'$group':{'_id':_0x49d392(0x15e),'product_stock':{'$sum':_0x49d392(0x12b)}}}]),_0x381d5e=await staff['findOne']({'email':_0x4b5082[_0x49d392(0x15d)]});if(_0x2055d3[0x0]['language']==_0x49d392(0xf9))var _0x15b90e=users[_0x49d392(0x10d)];else{if(_0x2055d3[0x0]['language']==_0x49d392(0x159))var _0x15b90e=users[_0x49d392(0x159)];else{if(_0x2055d3[0x0][_0x49d392(0xa4)]==_0x49d392(0xb3))var _0x15b90e=users['German'];else{if(_0x2055d3[0x0][_0x49d392(0xa4)]=='Spanish')var _0x15b90e=users[_0x49d392(0x154)];else{if(_0x2055d3[0x0][_0x49d392(0xa4)]==_0x49d392(0x17c))var _0x15b90e=users[_0x49d392(0x17c)];else{if(_0x2055d3[0x0][_0x49d392(0xa4)]==_0x49d392(0xb4))var _0x15b90e=users[_0x49d392(0x137)];else{if(_0x2055d3[0x0][_0x49d392(0xa4)]==_0x49d392(0x118))var _0x15b90e=users[_0x49d392(0x118)];else{if(_0x2055d3[0x0]['language']=='Arabic\x20(ae)')var _0x15b90e=users[_0x49d392(0x1dd)];}}}}}}}_0x540c20[_0x49d392(0xb0)]('sales_reports',{'success':_0x1cbcad['flash'](_0x49d392(0x1f0)),'errors':_0x1cbcad['flash'](_0x49d392(0x1a2)),'alldata':_0xf3d649,'profile':_0x32839f,'master_shop':_0x2055d3,'role':_0x4b5082,'product_stock':_0x32879a,'language':_0x15b90e,'staff_arr':_0x381d5e});}catch(_0x3a2d2a){}});async function dataSalesReports(_0x4a9397,_0x265b2c,_0x3c0599){const _0x40349d=a0_0x3b11a9;let _0x1bca0f='';const _0x195e2b=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x4a9397,'$lte':_0x265b2c},'sales_staff_id':_0x3c0599}},{'$unwind':_0x40349d(0x1cf)},{'$match':{'sale_product.isFG':_0x40349d(0x1e4)}},{'$group':{'_id':{'product_name':_0x40349d(0x161),'product_code':_0x40349d(0x1bd)},'sumqty':{'$sum':_0x40349d(0xdc)},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x4a0880=0x0,_0x3d27eb=0x0;for(let _0x5440ef=0x0;_0x5440ef<=_0x195e2b['length']-0x1;_0x5440ef++){const _0x2c205c=_0x195e2b[_0x5440ef];var _0x323a85=_0x2c205c[_0x40349d(0x14b)][_0x40349d(0x93)](undefined),_0x14ac32=_0x2c205c[_0x40349d(0x160)]['toLocaleString'](undefined);_0x1bca0f+=_0x40349d(0xa2),_0x1bca0f+='<td\x20class=\x22row_data\x22>'+_0x2c205c[_0x40349d(0x8b)][_0x40349d(0x139)]+_0x40349d(0x1be),_0x1bca0f+=_0x40349d(0x1ee)+_0x2c205c[_0x40349d(0x8b)]['product_name']+'</td>',_0x1bca0f+=_0x40349d(0x1ee)+formatNumber(_0x2c205c[_0x40349d(0x160)][_0x40349d(0x92)](0x2))+'</td>',_0x1bca0f+=_0x40349d(0x1ee)+formatNumber(_0x2c205c[_0x40349d(0x14b)][_0x40349d(0x92)](0x2))+_0x40349d(0x1be),_0x1bca0f+=_0x40349d(0x134),_0x4a0880+=parseFloat(_0x2c205c[_0x40349d(0x160)]),_0x3d27eb+=parseFloat(_0x2c205c[_0x40349d(0x14b)]);}var _0xf18107=_0x3d27eb['toLocaleString'](undefined),_0x4cb9c4=_0x4a0880[_0x40349d(0x93)](undefined);return _0x1bca0f+='<tr>',_0x1bca0f+=_0x40349d(0x1b6),_0x1bca0f+=_0x40349d(0x1d5)+formatNumber(_0x4a0880[_0x40349d(0x92)](0x2))+_0x40349d(0x150),_0x1bca0f+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x3d27eb['toFixed'](0x2))+_0x40349d(0x150),_0x1bca0f+=_0x40349d(0x134),_0x1bca0f;}router[a0_0x3b11a9(0x108)](a0_0x3b11a9(0x103),auth,async(_0xa4d908,_0xe3d45a)=>{const _0xc76810=a0_0x3b11a9;try{const {from_date:_0x5303ea,to_date:_0x443bed,isExcel:_0x87cc42}=_0xa4d908[_0xc76810(0xa3)],_0x372c0b=_0xa4d908[_0xc76810(0x163)],_0x3d8be0=await staff[_0xc76810(0x144)]({'email':_0x372c0b[_0xc76810(0x15d)]});let _0x371079=_0xc76810(0xdb);var _0x4d7f71=new Date(_0x5303ea),_0x58ccb0=new Date(_0x443bed);const _0x28a27e={'year':_0xc76810(0x1cb),'month':_0xc76810(0x188),'day':_0xc76810(0x1cb)},_0x51f330=new Intl[(_0xc76810(0x1a4))](_0xc76810(0x1e3),_0x28a27e)['format'](_0x4d7f71),_0x583b52=new Intl['DateTimeFormat'](_0xc76810(0x1e3),_0x28a27e)[_0xc76810(0xea)](_0x58ccb0);var _0x37b06d=await dataSalesReports(_0x5303ea,_0x443bed,_0x3d8be0[_0xc76810(0x8b)][_0xc76810(0xe2)]());_0x371079+=_0xc76810(0x10b),_0x371079+=_0xc76810(0xe1),_0x371079+='<table>',_0x371079+=_0xc76810(0xa2),_0x371079+=_0xc76810(0x1cd),_0x371079+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x371079+=_0xc76810(0x9f),_0x371079+=_0xc76810(0xa7),_0x371079+=_0xc76810(0xa2),_0x371079+=_0x37b06d,_0x371079+=_0xc76810(0x134),_0x371079+='</div>',_0x371079+=_0xc76810(0x178);let _0x141855=_0xc76810(0x9b);const _0x155520={'width':_0xc76810(0x1b9),'height':_0xc76810(0x196),'orientation':_0xc76810(0x1d3),'border':{'top':_0xc76810(0x185),'right':'0.1in','bottom':'0.1in','left':_0xc76810(0x185)},'header':{'height':_0xc76810(0x1f7),'contents':_0xc76810(0x19b)+_0x141855+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x3d8be0[_0xc76810(0x110)]+_0xc76810(0x8e)+_0x51f330+_0xc76810(0x1ab)+_0x583b52+_0xc76810(0x176)},'footer':{'height':_0xc76810(0x189),'contents':{'default':_0xc76810(0x202)}},'dpi':0x5,'zoomFactor':'1'};if(_0x87cc42=='on'){const _0x5cc414=cheerio[_0xc76810(0x1c7)](_0x371079);let _0x366d0a=[],_0x1ee9ac=[],_0x56c425=[];const _0x4dd6e9=_0x386feb=>{const _0x1e0090=_0xc76810,_0x1b8ab7={'top':{'style':'thick','color':{'rgb':_0x1e0090(0x1da)}},'bottom':{'style':_0x1e0090(0x1fd),'color':{'rgb':_0x1e0090(0x1da)}},'left':{'style':_0x1e0090(0x1fd),'color':{'rgb':_0x1e0090(0x1da)}},'right':{'style':_0x1e0090(0x1fd),'color':{'rgb':'000000'}}};if(_0x386feb){const _0x30b931=_0x386feb[_0x1e0090(0x119)](';')[_0x1e0090(0xec)]((_0x8077d8,_0x429952)=>{const _0x57b64d=_0x1e0090,[_0x1cca56,_0x33ca49]=_0x429952[_0x57b64d(0x119)](':')[_0x57b64d(0x128)](_0x376ba5=>_0x376ba5['trim']());return _0x8077d8[_0x1cca56]=_0x33ca49,_0x8077d8;},{});_0x30b931[_0x1e0090(0x1d7)]&&(_0x1b8ab7[_0x1e0090(0x167)][_0x1e0090(0x129)]=_0x30b931['border-top'][_0x1e0090(0x15f)](_0x1e0090(0x1bb))?_0x1e0090(0x1bb):_0x1e0090(0x204)),_0x30b931[_0x1e0090(0xfe)]&&(_0x1b8ab7[_0x1e0090(0x152)][_0x1e0090(0x129)]=_0x30b931['border-bottom'][_0x1e0090(0x15f)](_0x1e0090(0x1bb))?'thin':_0x1e0090(0x204)),_0x30b931[_0x1e0090(0x102)]&&(_0x1b8ab7[_0x1e0090(0xd0)][_0x1e0090(0x129)]=_0x30b931[_0x1e0090(0x102)][_0x1e0090(0x15f)]('thin')?_0x1e0090(0x1bb):_0x1e0090(0x204)),_0x30b931[_0x1e0090(0xc4)]&&(_0x1b8ab7[_0x1e0090(0x1a3)][_0x1e0090(0x129)]=_0x30b931['border-right'][_0x1e0090(0x15f)](_0x1e0090(0x1bb))?_0x1e0090(0x1bb):'medium');}return _0x1b8ab7;};_0x5cc414('table\x20tr')['each']((_0x4347c8,_0x28b7a4)=>{const _0x8115fc=_0xc76810;let _0x3a2bdc=[],_0x215d97=0x0;while(_0x56c425[_0x215d97]){_0x56c425[_0x215d97]--,_0x215d97++;}_0x5cc414(_0x28b7a4)[_0x8115fc(0x1fb)](_0x8115fc(0x1b2))['each']((_0xf1f3f5,_0x163c60)=>{const _0xb3c4e=_0x8115fc;let _0x5264eb=_0x5cc414(_0x163c60)[_0xb3c4e(0x18b)]()['trim'](),_0x4e149b=parseFloat(_0x5264eb['replace'](/,/g,'')),_0x5c4a6d={};!isNaN(_0x4e149b)?(_0x5c4a6d['v']=_0x4e149b,_0x5c4a6d['t']='n'):(_0x5c4a6d['v']=_0x5264eb,_0x5c4a6d['t']='s');const _0x317ef7=_0x5cc414(_0x163c60)['attr'](_0xb3c4e(0x129)),_0x181b1a=_0x4dd6e9(_0x317ef7);_0x5c4a6d['s']={'border':_0x181b1a},_0x3a2bdc[_0x215d97]=_0x5c4a6d;let _0x3ff3d9=parseInt(_0x5cc414(_0x163c60)['attr'](_0xb3c4e(0x88)))||0x1,_0x5dbd8d=parseInt(_0x5cc414(_0x163c60)[_0xb3c4e(0xcd)](_0xb3c4e(0x1fa)))||0x1;(_0x3ff3d9>0x1||_0x5dbd8d>0x1)&&_0x1ee9ac[_0xb3c4e(0x170)]({'s':{'r':_0x4347c8,'c':_0x215d97},'e':{'r':_0x4347c8+_0x5dbd8d-0x1,'c':_0x215d97+_0x3ff3d9-0x1}});for(let _0x57e617=0x0;_0x57e617<_0x3ff3d9;_0x57e617++){_0x5dbd8d>0x1&&(_0x56c425[_0x215d97+_0x57e617]=_0x5dbd8d-0x1);}_0x215d97+=_0x3ff3d9;}),_0x366d0a[_0x8115fc(0x170)](_0x3a2bdc);});const _0x2ca0c0=XLSX['utils']['book_new'](),_0x4da2f6=XLSX[_0xc76810(0x17a)][_0xc76810(0xf8)](_0x366d0a);_0x1ee9ac['length']>0x0&&(_0x4da2f6[_0xc76810(0x8c)]=_0x1ee9ac);_0x4da2f6['!cols']=_0x366d0a[0x0][_0xc76810(0x128)](()=>({'wpx':0x64})),XLSX[_0xc76810(0x17a)][_0xc76810(0x184)](_0x2ca0c0,_0x4da2f6,_0xc76810(0x17b));const _0x59913a=XLSX['write'](_0x2ca0c0,{'bookType':_0xc76810(0x142),'type':_0xc76810(0x20b)});_0xe3d45a[_0xc76810(0x141)](_0xc76810(0x1ce),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0xe3d45a['setHeader'](_0xc76810(0xb1),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0xe3d45a['send'](_0x59913a);}else pdf[_0xc76810(0xb2)](_0x371079,_0x155520)[_0xc76810(0x1b1)](function(_0x11a6bc,_0x3c2755){const _0x17d96f=_0xc76810;if(_0x11a6bc){_0xe3d45a[_0x17d96f(0xc1)](0x1f4)['send'](_0x17d96f(0xc0));return;}_0xe3d45a['setHeader']('Content-Type',_0x17d96f(0xca)),_0x3c2755[_0x17d96f(0x1ec)](_0xe3d45a);});}catch(_0x18353b){}}),router[a0_0x3b11a9(0xe9)]('/inventory_sum/view',auth,async(_0x401043,_0x38b63c)=>{const _0x5ecf26=a0_0x3b11a9;try{const {username:_0x2e4d5b,email:_0x5a9d26,role:_0x3f9272}=_0x401043[_0x5ecf26(0x163)],_0x4f1a77=_0x401043[_0x5ecf26(0x163)],_0x2d2efa=await profile[_0x5ecf26(0x144)]({'email':_0x4f1a77[_0x5ecf26(0x15d)]}),_0x2a873a={'year':'numeric','month':_0x5ecf26(0x188),'day':'numeric'},_0x428d86=await master_shop[_0x5ecf26(0x1fb)](),_0x4f8662=await product[_0x5ecf26(0x1fb)](),_0x48d4e4=await warehouse[_0x5ecf26(0xc9)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x5ecf26(0xab),'localField':_0x5ecf26(0x207),'foreignField':'name','as':_0x5ecf26(0x17e)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x5ecf26(0x208),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x5ecf26(0x15e),'product_stock':{'$sum':_0x5ecf26(0x12b)}}}]);if(_0x428d86[0x0][_0x5ecf26(0xa4)]==_0x5ecf26(0xf9))var _0x52e54f=users[_0x5ecf26(0x10d)];else{if(_0x428d86[0x0][_0x5ecf26(0xa4)]=='Hindi')var _0x52e54f=users[_0x5ecf26(0x159)];else{if(_0x428d86[0x0][_0x5ecf26(0xa4)]==_0x5ecf26(0xb3))var _0x52e54f=users['German'];else{if(_0x428d86[0x0][_0x5ecf26(0xa4)]==_0x5ecf26(0x154))var _0x52e54f=users[_0x5ecf26(0x154)];else{if(_0x428d86[0x0][_0x5ecf26(0xa4)]==_0x5ecf26(0x17c))var _0x52e54f=users['French'];else{if(_0x428d86[0x0][_0x5ecf26(0xa4)]==_0x5ecf26(0xb4))var _0x52e54f=users[_0x5ecf26(0x137)];else{if(_0x428d86[0x0][_0x5ecf26(0xa4)]==_0x5ecf26(0x118))var _0x52e54f=users[_0x5ecf26(0x118)];else{if(_0x428d86[0x0][_0x5ecf26(0xa4)]==_0x5ecf26(0x1ba))var _0x52e54f=users[_0x5ecf26(0x1dd)];}}}}}}}_0x38b63c[_0x5ecf26(0xb0)](_0x5ecf26(0xa5),{'success':_0x401043['flash'](_0x5ecf26(0x1f0)),'errors':_0x401043[_0x5ecf26(0x1c6)](_0x5ecf26(0x1a2)),'alldata':_0x4f8662,'profile':_0x2d2efa,'master_shop':_0x428d86,'role':_0x4f1a77,'product_stock':_0x48d4e4,'language':_0x52e54f});}catch(_0x423e5d){}});async function dataInventoryReports(_0x21c3c3,_0x16af69,_0x598186){const _0x126ab1=a0_0x3b11a9,_0x464640=await sales_sa[_0x126ab1(0xc9)]([{'$match':{'date':{'$gte':_0x21c3c3,'$lte':_0x16af69},'sales_staff_id':_0x598186}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x126ab1(0x161),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':_0x126ab1(0x19f)}}},{'$sort':{'_id.product_name':0x1}}]),_0x4d8cf=mongoose[_0x126ab1(0x133)][_0x126ab1(0xaf)],_0x5b89e2=await staff[_0x126ab1(0xc9)]([{'$match':{'_id':_0x4d8cf(_0x598186)}},{'$unwind':_0x126ab1(0xe3)},{'$match':{'product_list.isConfirm':'true'}},{'$group':{'_id':{'product_name':_0x126ab1(0xd5),'product_code':'$product_list.product_code'},'sumqty':{'$sum':_0x126ab1(0xd2)}}},{'$sort':{'_id.product_name':0x1}}]),_0x1d63b1=await sales_inv_data[_0x126ab1(0xc9)]([{'$match':{'date':{'$gte':_0x21c3c3,'$lte':_0x16af69},'sales_staff_id':_0x598186}},{'$unwind':_0x126ab1(0x1cf)},{'$group':{'_id':{'product_name':_0x126ab1(0x161),'product_code':_0x126ab1(0x1bd)},'totalQTYsum':{'$sum':_0x126ab1(0xe5)}}}]);console[_0x126ab1(0xae)](_0x1d63b1);let _0x2e6afe='';var _0x38d75a=0x0;for(let _0x48e224=0x0;_0x48e224<=_0x5b89e2[_0x126ab1(0x1d0)]-0x1;_0x48e224++){const _0x152788=_0x5b89e2[_0x48e224];_0x2e6afe+=_0x126ab1(0xa2),_0x2e6afe+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>'+_0x152788[_0x126ab1(0x8b)][_0x126ab1(0x139)]+_0x126ab1(0x1be),_0x2e6afe+=_0x126ab1(0x155)+_0x152788[_0x126ab1(0x8b)][_0x126ab1(0x12d)]+_0x126ab1(0x1be);var _0x464008=_0x152788[_0x126ab1(0x160)],_0x20af10=0x0;for(let _0x1d896f=0x0;_0x1d896f<=_0x464640[_0x126ab1(0x1d0)]-0x1;_0x1d896f++){const _0x34f59=_0x464640[_0x1d896f];_0x152788[_0x126ab1(0x8b)][_0x126ab1(0x139)]==_0x34f59['_id'][_0x126ab1(0x139)]&&_0x152788[_0x126ab1(0x8b)][_0x126ab1(0x12d)]==_0x34f59['_id'][_0x126ab1(0x12d)]&&(_0x20af10=_0x34f59[_0x126ab1(0x160)]);}var _0x3bee56=0x0;for(let _0x36658f=0x0;_0x36658f<=_0x1d63b1[_0x126ab1(0x1d0)]-0x1;_0x36658f++){const _0x5a295c=_0x1d63b1[_0x36658f];_0x152788[_0x126ab1(0x8b)][_0x126ab1(0x139)]==_0x5a295c[_0x126ab1(0x8b)][_0x126ab1(0x139)]&&_0x152788[_0x126ab1(0x8b)][_0x126ab1(0x12d)]==_0x5a295c['_id'][_0x126ab1(0x12d)]&&(_0x3bee56=_0x5a295c[_0x126ab1(0x1d4)]);}_0x38d75a=_0x464008-_0x3bee56+_0x20af10,_0x2e6afe+=_0x126ab1(0x1ee)+_0x38d75a+'</td>';let _0x51adf5=![];for(let _0x5ea16a=0x0;_0x5ea16a<=_0x1d63b1[_0x126ab1(0x1d0)]-0x1;_0x5ea16a++){const _0x179219=_0x1d63b1[_0x5ea16a];if(_0x152788[_0x126ab1(0x8b)][_0x126ab1(0x139)]==_0x179219[_0x126ab1(0x8b)][_0x126ab1(0x139)]&&_0x152788[_0x126ab1(0x8b)]['product_name']==_0x179219[_0x126ab1(0x8b)][_0x126ab1(0x12d)]){_0x2e6afe+=_0x126ab1(0x1ee)+_0x179219[_0x126ab1(0x1d4)]+_0x126ab1(0x1be),_0x51adf5=!![];break;}}!_0x51adf5&&(_0x2e6afe+=_0x126ab1(0x14a));let _0x4473cf=![];for(let _0x493164=0x0;_0x493164<=_0x464640[_0x126ab1(0x1d0)]-0x1;_0x493164++){const _0x5d7f7b=_0x464640[_0x493164];if(_0x152788[_0x126ab1(0x8b)][_0x126ab1(0x139)]==_0x5d7f7b[_0x126ab1(0x8b)][_0x126ab1(0x139)]&&_0x152788['_id']['product_name']==_0x5d7f7b[_0x126ab1(0x8b)][_0x126ab1(0x12d)]){_0x2e6afe+=_0x126ab1(0x1ee)+_0x5d7f7b[_0x126ab1(0x160)]+_0x126ab1(0x1be),_0x4473cf=!![];break;}}!_0x4473cf&&(_0x2e6afe+='<td\x20class=\x22row_data\x22>0</td>'),_0x2e6afe+=_0x126ab1(0x1ee)+_0x152788[_0x126ab1(0x160)]+_0x126ab1(0x1be),_0x2e6afe+='</tr>';}return _0x2e6afe;}router[a0_0x3b11a9(0x108)](a0_0x3b11a9(0x131),auth,async(_0x41f208,_0x541004)=>{const _0x4d4629=a0_0x3b11a9;try{const {from_date:_0x4e171f,to_date:_0x596856}=_0x41f208[_0x4d4629(0xa3)],_0x48f74d=_0x41f208[_0x4d4629(0x163)],_0x38a2b5=await staff[_0x4d4629(0x144)]({'email':_0x48f74d[_0x4d4629(0x15d)]});let _0x34fe73=_0x4d4629(0xdb);var _0x5a503d=new Date(_0x4e171f),_0x2a7e71=new Date(_0x596856);const _0x152446={'year':_0x4d4629(0x1cb),'month':_0x4d4629(0x188),'day':_0x4d4629(0x1cb)},_0x48d23d=new Intl[(_0x4d4629(0x1a4))](_0x4d4629(0x1e3),_0x152446)['format'](_0x5a503d),_0xe83ed7=new Intl[(_0x4d4629(0x1a4))](_0x4d4629(0x1e3),_0x152446)['format'](_0x2a7e71);var _0x14847b=await dataInventoryReports(_0x4e171f,_0x596856,_0x38a2b5['_id'][_0x4d4629(0xe2)]());_0x34fe73+=_0x4d4629(0x115),_0x34fe73+=_0x4d4629(0x1d1),_0x34fe73+='<p>'+_0x48d23d+_0x4d4629(0x1ab)+_0xe83ed7+_0x4d4629(0x127),_0x34fe73+=_0x4d4629(0x10b),_0x34fe73+='<div\x20class=\x22col-sm-11\x22>',_0x34fe73+=_0x4d4629(0x130),_0x34fe73+=_0x4d4629(0xa2),_0x34fe73+='<th>\x20ITEM\x20CODE\x20</th>',_0x34fe73+=_0x4d4629(0x112),_0x34fe73+='<th>\x20BEG\x20BALANCE\x20</th>',_0x34fe73+='<th>\x20INCOMING\x20</th>',_0x34fe73+=_0x4d4629(0xd8),_0x34fe73+=_0x4d4629(0xf1),_0x34fe73+=_0x4d4629(0xa2),_0x34fe73+=_0x14847b,_0x34fe73+=_0x4d4629(0x134),_0x34fe73+=_0x4d4629(0x178),_0x34fe73+='</div>';const _0x44d4e9={'format':'Letter','orientation':_0x4d4629(0x1d3)};pdf[_0x4d4629(0xb2)](_0x34fe73,_0x44d4e9)[_0x4d4629(0x1b1)](function(_0x5a75c8,_0x1c6c73){const _0x1b84c4=_0x4d4629;if(_0x5a75c8){_0x541004[_0x1b84c4(0xc1)](0x1f4)[_0x1b84c4(0xf4)]('Error\x20generating\x20PDF');return;}_0x541004[_0x1b84c4(0x141)](_0x1b84c4(0xb1),_0x1b84c4(0xca)),_0x1c6c73[_0x1b84c4(0x1ec)](_0x541004);});}catch(_0x5b4b51){}}),router[a0_0x3b11a9(0xe9)](a0_0x3b11a9(0x1d6),auth,async(_0x1b53d1,_0x3a82f9)=>{const _0x14db5d=a0_0x3b11a9;try{const {username:_0x16dc80,email:_0x2b9aa5,role:_0x36f7a1}=_0x1b53d1[_0x14db5d(0x163)],_0x4a4817=_0x1b53d1[_0x14db5d(0x163)],_0x5d3446=await profile[_0x14db5d(0x144)]({'email':_0x4a4817[_0x14db5d(0x15d)]}),_0x15706e={'year':_0x14db5d(0x1cb),'month':_0x14db5d(0x188),'day':_0x14db5d(0x1cb)},_0x326236=await master_shop['find']();console[_0x14db5d(0xae)](_0x14db5d(0xd6),_0x326236);const _0x1fec29=await product[_0x14db5d(0x1fb)]();console['log'](_0x14db5d(0x1ed),_0x1fec29);const _0x4b0455=await warehouse[_0x14db5d(0xc9)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x14db5d(0xab),'localField':_0x14db5d(0x207),'foreignField':_0x14db5d(0x110),'as':_0x14db5d(0x17e)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x14db5d(0x1f4)}},{'$group':{'_id':_0x14db5d(0x15e),'product_stock':{'$sum':_0x14db5d(0x12b)}}}]);console[_0x14db5d(0xae)](_0x14db5d(0x113),_0x4b0455),_0x4b0455[_0x14db5d(0xcc)](_0x57781c=>{const _0x557811=_0x1fec29['map'](_0x1013ed=>{const _0x255fd4=a0_0x2e8b;_0x1013ed['name']==_0x57781c[_0x255fd4(0x8b)]&&(_0x1013ed[_0x255fd4(0xc6)]=parseInt(_0x1013ed[_0x255fd4(0xc6)])+parseInt(_0x57781c[_0x255fd4(0x95)]));});});const _0x35d814=await staff[_0x14db5d(0x144)]({'email':_0x4a4817['email']});if(_0x326236[0x0][_0x14db5d(0xa4)]==_0x14db5d(0xf9))var _0x5d5537=users[_0x14db5d(0x10d)];else{if(_0x326236[0x0][_0x14db5d(0xa4)]==_0x14db5d(0x159))var _0x5d5537=users[_0x14db5d(0x159)];else{if(_0x326236[0x0][_0x14db5d(0xa4)]==_0x14db5d(0xb3))var _0x5d5537=users[_0x14db5d(0xb3)];else{if(_0x326236[0x0][_0x14db5d(0xa4)]=='Spanish')var _0x5d5537=users[_0x14db5d(0x154)];else{if(_0x326236[0x0][_0x14db5d(0xa4)]==_0x14db5d(0x17c))var _0x5d5537=users[_0x14db5d(0x17c)];else{if(_0x326236[0x0][_0x14db5d(0xa4)]=='Portuguese\x20(BR)')var _0x5d5537=users[_0x14db5d(0x137)];else{if(_0x326236[0x0]['language']=='Chinese')var _0x5d5537=users['Chinese'];else{if(_0x326236[0x0][_0x14db5d(0xa4)]==_0x14db5d(0x1ba))var _0x5d5537=users[_0x14db5d(0x1dd)];}}}}}}}_0x3a82f9[_0x14db5d(0xb0)](_0x14db5d(0x149),{'success':_0x1b53d1[_0x14db5d(0x1c6)](_0x14db5d(0x1f0)),'errors':_0x1b53d1[_0x14db5d(0x1c6)](_0x14db5d(0x1a2)),'alldata':_0x1fec29,'profile':_0x5d3446,'master_shop':_0x326236,'role':_0x4a4817,'product_stock':_0x4b0455,'language':_0x5d5537,'staff_arr':_0x35d814});}catch(_0x8e86fa){}});async function agentsdataDSICheck_DSRR(_0x32d98e,_0x552c45,_0xc9425,_0x3be7ae){const _0x1188a0=a0_0x3b11a9;let _0x26ec88=new Date(_0x32d98e);_0x26ec88['setDate'](_0x26ec88[_0x1188a0(0x1fe)]()-0x1);let _0x446538=_0x26ec88[_0x1188a0(0x157)]()[_0x1188a0(0x119)]('T')[0x0];const _0x179211=await product[_0x1188a0(0xc9)]([{'$group':{'_id':{'brand':_0x1188a0(0x140),'category':'$category'},'products':{'$push':{'name':_0x1188a0(0xbe),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x17cbd0=[];_0x17cbd0[_0x1188a0(0xbf)]=[];for(let _0x52377d=0x0;_0x52377d<=_0x179211[_0x1188a0(0x1d0)]-0x1;_0x52377d++){const _0x1cf85e=_0x179211[_0x52377d];_0x17cbd0[_0x1188a0(0xbf)]['push'](_0x1cf85e);}const _0x4a8e61=await product[_0x1188a0(0xc9)]([{'$group':{'_id':{'category':_0x1188a0(0x124)},'products':{'$push':{'brand':_0x1188a0(0x140),'product_code':'$product_code','product_name':_0x1188a0(0xbe)}}}},{'$sort':{'_id.category':-0x1}}]),_0xbb3bcb=await product[_0x1188a0(0xc9)]([{'$group':{'_id':{'category':_0x1188a0(0x124),'brand':_0x1188a0(0x140)}}},{'$group':{'_id':_0x1188a0(0xc5),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5a683b=await sales_sa[_0x1188a0(0xc9)]([{'$match':{'date':_0x32d98e,'sales_staff_id':_0x552c45,'sale_product.isFG':_0x1188a0(0x1e4)}},{'$unwind':'$sale_product'},{'$lookup':{'from':'products','localField':_0x1188a0(0xa1),'foreignField':'product_code','as':_0x1188a0(0x1ea)}},{'$unwind':_0x1188a0(0xff)},{'$group':{'_id':{'dsi':_0x1188a0(0x1fc),'date':_0x1188a0(0xe0),'customer':_0x1188a0(0xbc),'status_data':'$status_data'},'totalQty':{'$sum':_0x1188a0(0xdc)},'cash':{'$first':_0x1188a0(0x1bc)},'amount':{'$first':_0x1188a0(0x1db)},'bank':{'$first':_0x1188a0(0x116)},'check_no':{'$first':_0x1188a0(0xed)},'due_date':{'$first':_0x1188a0(0xdd)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x1188a0(0x18f),'discount':_0x1188a0(0x17d),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x1188a0(0xf2),'product_code':_0x1188a0(0x174),'category':_0x1188a0(0x87),'brand':_0x1188a0(0x98),'gross_price':'$product_info.gross_price','isFG':_0x1188a0(0x1f6),'prod_cat':_0x1188a0(0x13d),'prod_id':_0x1188a0(0xba)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1188a0(0x203),'customer':_0x1188a0(0x12e),'status_data':'$_id.status_data','category':'$products.product_details.category','brand':'$products.product_details.brand','prod_id':_0x1188a0(0xee)},'totalQty':{'$sum':_0x1188a0(0x11d)},'totalGross':{'$sum':{'$multiply':[_0x1188a0(0x11d),_0x1188a0(0x106)]}},'NetPrice':{'$sum':_0x1188a0(0xbd)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x1188a0(0xfd)},'cash':{'$first':_0x1188a0(0x1bc)},'amount':{'$first':'$amount'},'bank':{'$first':_0x1188a0(0x116)},'check_no':{'$first':_0x1188a0(0xed)},'due_date':{'$first':_0x1188a0(0xdd)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1188a0(0x203),'customer':_0x1188a0(0x12e),'status_data':_0x1188a0(0x1a9)},'totalQty':{'$sum':_0x1188a0(0x1bf)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x1188a0(0xa6)},'discount':{'$sum':_0x1188a0(0x10a)},'adj_discount':{'$sum':_0x1188a0(0x19e)},'cash':{'$first':'$cash'},'amount':{'$first':_0x1188a0(0x1db)},'bank':{'$first':_0x1188a0(0x116)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x1188a0(0xdd)},'products':{'$push':{'qty':_0x1188a0(0x1bf),'category':_0x1188a0(0xc5),'brand':_0x1188a0(0x147),'product_details':_0x1188a0(0xce)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xa0a04c=await sales_sa['aggregate']([{'$match':{'date':_0x446538,'sales_staff_id':_0x552c45,'sale_product.isFG':_0x1188a0(0x1e4)}},{'$unwind':'$sale_product'},{'$lookup':{'from':'products','localField':_0x1188a0(0xa1),'foreignField':_0x1188a0(0x139),'as':'product_info'}},{'$unwind':_0x1188a0(0xff)},{'$group':{'_id':{'dsi':_0x1188a0(0x1fc),'date':_0x1188a0(0xe0),'customer':_0x1188a0(0xbc)},'totalQty':{'$sum':_0x1188a0(0xdc)},'cash':{'$first':_0x1188a0(0x1bc)},'amount':{'$first':_0x1188a0(0x1db)},'bank':{'$first':_0x1188a0(0x116)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x1188a0(0xdd)},'products':{'$push':{'qty':_0x1188a0(0xdc),'NetPrice':_0x1188a0(0x18f),'discount':_0x1188a0(0x17d),'adj_discount':_0x1188a0(0x1c3),'product_details':{'prod_name':'$product_info.name','product_code':_0x1188a0(0x174),'category':_0x1188a0(0x87),'brand':_0x1188a0(0x98),'gross_price':'$product_info.gross_price','isFG':_0x1188a0(0x1f6),'prod_cat':_0x1188a0(0x13d),'prod_id':_0x1188a0(0xba)}}}}},{'$unwind':_0x1188a0(0xf5)},{'$group':{'_id':{'dsi':_0x1188a0(0xf7),'date':_0x1188a0(0x203),'customer':_0x1188a0(0x12e),'category':_0x1188a0(0x1c2),'brand':_0x1188a0(0x1af),'prod_id':_0x1188a0(0xee)},'totalQty':{'$sum':_0x1188a0(0x11d)},'cash':{'$first':'$cash'},'amount':{'$first':_0x1188a0(0x1db)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x1188a0(0xed)},'due_date':{'$first':_0x1188a0(0xdd)},'totalGross':{'$sum':{'$multiply':[_0x1188a0(0x11d),_0x1188a0(0x106)]}},'NetPrice':{'$sum':_0x1188a0(0xbd)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x1188a0(0xfd)},'product_details':{'$first':_0x1188a0(0x12a)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':'$totalQty'},'cash':{'$first':_0x1188a0(0x1bc)},'amount':{'$first':_0x1188a0(0x1db)},'bank':{'$first':_0x1188a0(0x116)},'check_no':{'$first':_0x1188a0(0xed)},'due_date':{'$first':_0x1188a0(0xdd)},'totalGross':{'$sum':_0x1188a0(0x1cc)},'NetPrice':{'$sum':_0x1188a0(0xa6)},'discount':{'$sum':_0x1188a0(0x10a)},'adj_discount':{'$sum':_0x1188a0(0x19e)},'products':{'$push':{'qty':_0x1188a0(0x1bf),'category':_0x1188a0(0xc5),'brand':_0x1188a0(0x147),'product_details':_0x1188a0(0xce)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x44fbd4=await sales_sa[_0x1188a0(0xc9)]([{'$match':{'date':_0x32d98e,'sales_staff_id':_0x552c45,'status_data':_0x1188a0(0x145)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x96c7e=await staff[_0x1188a0(0xa0)](_0x552c45);let _0x90403a=[],_0x1e2f78={},_0x1a005f={};var _0x234596=0x0,_0x485f99=0x0,_0x275883=0x0,_0x408d87=0x0,_0x12ffd1=0x0;const _0x486037=0x6;var _0x5404c9=0x0,_0x3c6083=0x0;for(let _0x19f066=0x0;_0x19f066<=_0x5a683b[_0x1188a0(0x1d0)]-0x1;_0x19f066++){const _0xcf6e4b=_0x5a683b[_0x19f066];let _0x488296=_0x1188a0(0xa2);_0x488296+=_0x1188a0(0x168),_0x488296+=_0x1188a0(0xcb)+_0xcf6e4b[_0x1188a0(0x8b)][_0x1188a0(0x19d)]+_0x1188a0(0x1be),_0x488296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xcf6e4b[_0x1188a0(0x8b)]['dsi']+_0x1188a0(0x1be);let _0x20f5e8={},_0x4efbc5={},_0x3c5b37={};var _0x55bbf7={},_0x462622={},_0xded786={},_0x5cf411=0x0;for(let _0x3ace0c=0x0;_0x3ace0c<=_0xcf6e4b[_0x1188a0(0xab)][_0x1188a0(0x1d0)]-0x1;_0x3ace0c++){const _0x4e8ad1=_0xcf6e4b[_0x1188a0(0xab)][_0x3ace0c];_0x20f5e8[_0x4e8ad1[_0x1188a0(0x12c)]+'-'+_0x4e8ad1[_0x1188a0(0xc8)]]=_0x4e8ad1['qty'],_0x4efbc5[[_0x4e8ad1['brand']+'-'+_0x4e8ad1[_0x1188a0(0xc8)]]]=_0x4e8ad1[_0x1188a0(0x18d)][_0x1188a0(0x13b)],_0x3c5b37[[_0x4e8ad1[_0x1188a0(0x12c)]+'-'+_0x4e8ad1[_0x1188a0(0xc8)]]]=_0x4e8ad1[_0x1188a0(0x18d)][_0x1188a0(0x11c)];const _0x52f497=_0x4e8ad1[_0x1188a0(0x12c)]+'-'+_0x4e8ad1['category'];!Array[_0x1188a0(0x17f)](_0x1a005f[_0x52f497])&&(_0x1a005f[_0x52f497]=[]);!Array[_0x1188a0(0x17f)](_0x1a005f[_0x52f497])&&(_0x1a005f[_0x52f497]=[]);_0x1a005f[_0x52f497][_0x1188a0(0x170)](_0x4e8ad1[_0x1188a0(0x199)]);if(_0x4e8ad1[_0x1188a0(0x18d)][_0x1188a0(0x11c)]=='P')_0x4e8ad1['product_details']['isFG']==_0x1188a0(0x145)?(!_0xded786[_0x52f497]&&(_0xded786[_0x52f497]=0x0),_0xded786[_0x52f497]=_0x4e8ad1[_0x1188a0(0x199)]):(!_0x55bbf7[_0x52f497]&&(_0x55bbf7[_0x52f497]=0x0),_0x55bbf7[_0x52f497]=_0x4e8ad1[_0x1188a0(0x199)]);else _0x4e8ad1[_0x1188a0(0x18d)][_0x1188a0(0x11c)]=='S'&&(_0x4e8ad1[_0x1188a0(0x18d)][_0x1188a0(0x13b)]==_0x1188a0(0x145)?(!_0xded786[_0x52f497]&&(_0xded786[_0x52f497]=0x0),_0xded786[_0x52f497]=_0x4e8ad1[_0x1188a0(0x199)]):(!_0x462622[_0x52f497]&&(_0x462622[_0x52f497]=0x0),_0x462622[_0x52f497]=_0x4e8ad1[_0x1188a0(0x199)]));_0x5cf411++;}for(let _0x1dfc06=0x0;_0x1dfc06<=_0x17cbd0[_0x1188a0(0xbf)]['length']-0x1;_0x1dfc06++){const _0x3040fd=_0x17cbd0[_0x1188a0(0xbf)][_0x1dfc06],_0x459458=_0x3040fd[_0x1188a0(0x8b)][_0x1188a0(0x12c)]+'-'+_0x3040fd[_0x1188a0(0x8b)][_0x1188a0(0xc8)],_0x4a328c=_0x3c5b37[_0x459458]!==undefined?_0x3c5b37[_0x459458]:'NA';var _0x4af8a2=_0x55bbf7[_0x459458]!==undefined?_0x55bbf7[_0x459458][_0x1188a0(0x92)](0x2):'',_0xc7f3d2=_0x462622[_0x459458]!==undefined?_0x462622[_0x459458][_0x1188a0(0x92)](0x2):'',_0x42a075=_0xded786[_0x459458]!==undefined?_0xded786[_0x459458][_0x1188a0(0x92)](0x2):'';_0x488296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x4af8a2+_0x1188a0(0x1be),_0x488296+=_0x1188a0(0x8d)+_0xc7f3d2+_0x1188a0(0x1be),_0x488296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x42a075+_0x1188a0(0x1be);}var _0x5680dd=formatNumber(parseFloat(_0xcf6e4b['cash'])),_0x79d6c1=formatNumber(parseFloat(_0xcf6e4b['amount']));isNaN(_0x79d6c1)&&(_0x79d6c1=0x0),_0x488296+=_0x1188a0(0x8d)+_0x5680dd+_0x1188a0(0x1be),_0x488296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x79d6c1+_0x1188a0(0x1be),_0x488296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xcf6e4b['bank']+_0x1188a0(0x1be),_0x488296+=_0x1188a0(0xcb)+_0xcf6e4b[_0x1188a0(0x179)]+'</td>',_0x488296+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xcf6e4b[_0x1188a0(0x1a5)]+'</td>',_0x275883=_0xcf6e4b[_0x1188a0(0x11b)]+_0xcf6e4b[_0x1188a0(0xd4)],_0x5404c9+=parseFloat(_0xcf6e4b[_0x1188a0(0x8f)]),_0x3c6083+=parseFloat(_0x79d6c1),_0x90403a[_0x1188a0(0x170)](_0x488296);}function _0x34d5d2(_0x2aae27,_0x31826b){const _0x42e41c=_0x1188a0,_0x4765d9=[];for(let _0x4ab7e5=0x0;_0x4ab7e5<=_0x2aae27[_0x42e41c(0x1d0)]-0x1;_0x4ab7e5+=_0x31826b){_0x4765d9[_0x42e41c(0x170)](_0x2aae27[_0x42e41c(0x1e5)](_0x4ab7e5,_0x4ab7e5+_0x31826b));}return _0x4765d9;}const _0x16e0e9=_0x34d5d2(_0x90403a,_0x486037);let _0x58913e='';return _0x16e0e9[_0x1188a0(0xcc)]((_0x169206,_0x28da25)=>{const _0x107718=_0x1188a0;_0x28da25>0x0&&(_0x58913e+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x58913e+=_0x107718(0x130),_0x58913e+=_0x107718(0xf3);const _0x2821ae=new Date(_0x32d98e),_0x4c3378={'year':_0x107718(0x1cb),'month':_0x107718(0x188),'day':'numeric','timeZone':'Asia/Manila'},_0x3b03f0=_0x2821ae[_0x107718(0x195)](_0x107718(0x1e3),_0x4c3378);_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x1c5)+_0x3be7ae+_0x107718(0x150),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x125)+_0x96c7e[_0x107718(0x110)]+_0x107718(0x1be),_0x58913e+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>',_0x58913e+=_0x107718(0x1ae),_0x58913e+=_0x107718(0x120),_0x58913e+=_0x107718(0xde),_0x58913e+=_0x107718(0x158),_0x58913e+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>',_0x58913e+=_0x107718(0x13f),_0x58913e+=_0x107718(0x90),_0x58913e+=_0x107718(0x134),_0x58913e+='<tr>',_0x58913e+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x58913e+=_0x107718(0x16d)+_0x3b03f0+_0x107718(0x1be),_0x58913e+=_0x107718(0x15a),_0x58913e+=_0x107718(0x1e2),_0x58913e+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x58913e+=_0x107718(0xe6),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0xd7),_0x58913e+=_0x107718(0x198),_0x58913e+=_0x107718(0x101),_0x58913e+=_0x107718(0xe6),_0x58913e+=_0x107718(0xe6),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x58913e+='</tr>',_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x1ad),_0x58913e+='<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>',_0x58913e+='</tr>',_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x9a),_0x58913e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x58913e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x3656ac=0x0;_0x3656ac<=_0x4a8e61[_0x107718(0x1d0)]-0x1;_0x3656ac++){const _0x2993b1=_0x4a8e61[_0x3656ac];for(let _0x4b2a54=0x0;_0x4b2a54<_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)];_0x4b2a54++){const _0x32fd49=_0x17cbd0[_0x107718(0xbf)][_0x4b2a54];if(_0x32fd49['_id'][_0x107718(0xc8)]===_0x2993b1[_0x107718(0x8b)][_0x107718(0xc8)]){var _0x209865='';switch(_0x2993b1[_0x107718(0x8b)][_0x107718(0xc8)]){case _0x107718(0xeb):_0x209865=_0x32fd49[_0x107718(0x8b)]['brand']+_0x107718(0x10e);break;case _0x107718(0x194):_0x209865=_0x32fd49['_id'][_0x107718(0x12c)]+_0x107718(0xd3);break;default:_0x209865=_0x32fd49[_0x107718(0x8b)][_0x107718(0x12c)];break;}_0x58913e+=_0x107718(0x186)+_0x209865+'</b></td>';}}}_0x58913e+=_0x107718(0x1a0),_0x58913e+=_0x107718(0x16a),_0x58913e+=_0x107718(0x193),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x1df);for(let _0x529e43=0x0;_0x529e43<=_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)]-0x1;_0x529e43++){const _0x14b0b0=_0x17cbd0[_0x529e43];_0x58913e+=_0x107718(0x1b0),_0x58913e+=_0x107718(0x1eb),_0x58913e+=_0x107718(0xa8);}_0x58913e+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>',_0x58913e+=_0x107718(0x1a6),_0x58913e+=_0x107718(0x1ff),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0x1c4),_0x58913e+='<tbody>',_0x169206[_0x107718(0xcc)](_0x55dd01=>{_0x58913e+=_0x55dd01;});let _0x310eef={},_0x15bda5={},_0x15907b={};for(let _0x4b52be=0x0;_0x4b52be<=_0x5a683b[_0x107718(0x1d0)]-0x1;_0x4b52be++){const _0x587ed1=_0x5a683b[_0x4b52be];var _0x17dfca=0x0;for(let _0x4677ae=0x0;_0x4677ae<=_0x587ed1['products']['length']-0x1;_0x4677ae++){const _0x11b523=_0x587ed1[_0x107718(0xab)][_0x4677ae],_0x3180c3=_0x11b523[_0x107718(0x12c)]+'-'+_0x11b523['category'];if(_0x11b523['product_details'][_0x107718(0x11c)]=='P')_0x11b523[_0x107718(0x18d)]['isFG']=='true'?(!_0x15907b[_0x3180c3]&&(_0x15907b[_0x3180c3]=0x0),_0x15907b[_0x3180c3]+=_0x11b523[_0x107718(0x199)]):(!_0x310eef[_0x3180c3]&&(_0x310eef[_0x3180c3]=0x0),_0x310eef[_0x3180c3]+=_0x11b523[_0x107718(0x199)]);else _0x11b523[_0x107718(0x18d)]['prod_cat']=='S'&&(_0x11b523[_0x107718(0x18d)]['isFG']=='true'?(!_0x15907b[_0x3180c3]&&(_0x15907b[_0x3180c3]=0x0),_0x15907b[_0x3180c3]+=_0x11b523[_0x107718(0x199)],console[_0x107718(0xae)](_0x11b523['qty'])):(!_0x15bda5[_0x3180c3]&&(_0x15bda5[_0x3180c3]=0x0),_0x15bda5[_0x3180c3]+=_0x11b523['qty']));_0x17dfca++;}}let _0x1d2f69={},_0x5400cd={},_0x1bb013={};var _0x21a43d=0x0,_0xd7e4d=0x0;for(let _0x487dd9=0x0;_0x487dd9<=_0xa0a04c[_0x107718(0x1d0)]-0x1;_0x487dd9++){const _0x29f3d2=_0xa0a04c[_0x487dd9];var _0x17dfca=0x0;for(let _0x4414a1=0x0;_0x4414a1<=_0x29f3d2[_0x107718(0xab)][_0x107718(0x1d0)]-0x1;_0x4414a1++){const _0xde8533=_0x29f3d2[_0x107718(0xab)][_0x4414a1],_0xa68ca=_0xde8533[_0x107718(0x12c)]+'-'+_0xde8533[_0x107718(0xc8)];if(_0xde8533[_0x107718(0x18d)]['prod_cat']=='P')_0xde8533[_0x107718(0x18d)][_0x107718(0x13b)]==_0x107718(0x145)?(!_0x1bb013[_0xa68ca]&&(_0x1bb013[_0xa68ca]=0x0),_0x1bb013[_0xa68ca]+=_0xde8533['qty']):(!_0x1d2f69[_0xa68ca]&&(_0x1d2f69[_0xa68ca]=0x0),_0x1d2f69[_0xa68ca]+=_0xde8533['qty']);else _0xde8533[_0x107718(0x18d)][_0x107718(0x11c)]=='S'&&(_0xde8533[_0x107718(0x18d)][_0x107718(0x13b)]==_0x107718(0x145)?(!_0x1bb013[_0xa68ca]&&(_0x1bb013[_0xa68ca]=0x0),_0x1bb013[_0xa68ca]+=_0xde8533[_0x107718(0x199)]):(!_0x5400cd[_0xa68ca]&&(_0x5400cd[_0xa68ca]=0x0),_0x5400cd[_0xa68ca]+=_0xde8533[_0x107718(0x199)]));_0x17dfca++;}var _0x4132f4=parseFloat(_0x29f3d2[_0x107718(0x8f)]),_0x2df6d2=parseFloat(_0x29f3d2[_0x107718(0x18c)]);isNaN(_0x2df6d2)&&(_0x2df6d2=0x0),_0x21a43d+=_0x4132f4,_0xd7e4d+=_0x2df6d2;}if(_0x44fbd4[_0x107718(0x1d0)]>0x0)for(let _0x531091=0x0;_0x531091<=_0x44fbd4[_0x107718(0x1d0)]-0x1;_0x531091++){const _0x4d287e=_0x44fbd4[_0x531091];console[_0x107718(0xae)](_0x4d287e),_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x111)+(0x8+0x7*0x3)+_0x107718(0x1d9)+_0x4d287e[_0x107718(0x1a7)]+'</b></td>',_0x58913e+='</tr>';}_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x132),_0x58913e+=_0x107718(0x1b8),_0x58913e+=_0x107718(0x168);for(let _0x1a4a1b=0x0;_0x1a4a1b<=_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)]-0x1;_0x1a4a1b++){const _0x407451=_0x17cbd0[_0x107718(0xbf)][_0x1a4a1b],_0x5deb09=_0x407451[_0x107718(0x8b)][_0x107718(0x12c)]+'-'+_0x407451[_0x107718(0x8b)][_0x107718(0xc8)];var _0x7f6a19=_0x310eef[_0x5deb09]!==undefined?formatNumber(_0x310eef[_0x5deb09][_0x107718(0x92)](0x2)):'',_0x3e9c53=_0x15907b[_0x5deb09]!==undefined?formatNumber(_0x15907b[_0x5deb09][_0x107718(0x92)](0x2)):'',_0x199e69=_0x15bda5[_0x5deb09]!==undefined?formatNumber(_0x15bda5[_0x5deb09][_0x107718(0x92)](0x2)):'';_0x58913e+=_0x107718(0x10c)+_0x7f6a19+_0x107718(0x150),_0x58913e+=_0x107718(0x10c)+_0x199e69+'</b></td>',_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3e9c53+_0x107718(0x150);}_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5404c9)+'</b></td>',_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3c6083)+_0x107718(0x150),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x132),_0x58913e+=_0x107718(0x201),_0x58913e+=_0x107718(0x168);for(let _0x50278a=0x0;_0x50278a<=_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)]-0x1;_0x50278a++){const _0x3a28f=_0x17cbd0[_0x107718(0xbf)][_0x50278a],_0x3f928d=_0x3a28f['_id'][_0x107718(0x12c)]+'-'+_0x3a28f[_0x107718(0x8b)][_0x107718(0xc8)];var _0x7f6a19=_0x1d2f69[_0x3f928d]!==undefined?formatNumber(_0x1d2f69[_0x3f928d][_0x107718(0x92)](0x2)):'',_0x3e9c53=_0x1bb013[_0x3f928d]!==undefined?formatNumber(_0x1bb013[_0x3f928d][_0x107718(0x92)](0x2)):'',_0x199e69=_0x5400cd[_0x3f928d]!==undefined?formatNumber(_0x5400cd[_0x3f928d][_0x107718(0x92)](0x2)):'';_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x7f6a19+_0x107718(0x150),_0x58913e+=_0x107718(0x10c)+_0x199e69+_0x107718(0x150),_0x58913e+=_0x107718(0x10c)+_0x3e9c53+_0x107718(0x150);}_0x58913e+=_0x107718(0x10c)+formatNumber(_0x21a43d)+'</b></td>',_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xd7e4d)+_0x107718(0x150),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x132),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x58913e+=_0x107718(0x168);let _0x1ee708=0x0,_0x349756=0x0,_0x75f28d=0x0;for(let _0x29a99a=0x0;_0x29a99a<=_0x17cbd0['cat_brand'][_0x107718(0x1d0)]-0x1;_0x29a99a++){const _0x5d13e3=_0x17cbd0[_0x107718(0xbf)][_0x29a99a],_0x118036=_0x5d13e3[_0x107718(0x8b)][_0x107718(0x12c)]+'-'+_0x5d13e3[_0x107718(0x8b)][_0x107718(0xc8)];var _0x2253fc=_0x310eef[_0x118036]!==undefined?_0x310eef[_0x118036][_0x107718(0x92)](0x2):'0',_0x5c4ca2=_0x15907b[_0x118036]!==undefined?_0x15907b[_0x118036]['toFixed'](0x2):'0',_0x5ebe36=_0x15bda5[_0x118036]!==undefined?_0x15bda5[_0x118036]['toFixed'](0x2):'0',_0x54136a=_0x1d2f69[_0x118036]!==undefined?_0x1d2f69[_0x118036]['toFixed'](0x2):'0',_0x4f32bc=_0x1bb013[_0x118036]!==undefined?_0x1bb013[_0x118036][_0x107718(0x92)](0x2):'0',_0x30b7e2=_0x5400cd[_0x118036]!==undefined?_0x5400cd[_0x118036]['toFixed'](0x2):'0';_0x1ee708=parseFloat(_0x2253fc)+parseFloat(_0x54136a),_0x349756=parseFloat(_0x5ebe36)+parseFloat(_0x30b7e2),_0x75f28d=parseFloat(_0x5c4ca2)+parseFloat(_0x4f32bc),_0x58913e+=_0x107718(0x10c)+formatNumber(_0x1ee708[_0x107718(0x92)](0x2))+_0x107718(0x150),_0x58913e+=_0x107718(0x10c)+formatNumber(_0x349756['toFixed'](0x2))+'</b></td>',_0x58913e+=_0x107718(0x10c)+formatNumber(_0x75f28d[_0x107718(0x92)](0x2))+_0x107718(0x150);}var _0x585f56=formatNumber(_0x5404c9+_0x21a43d),_0x453e42=formatNumber(_0x3c6083+_0xd7e4d);_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x585f56+_0x107718(0x150),_0x58913e+=_0x107718(0x10c)+_0x453e42+_0x107718(0x150),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)]*0x3+0x9)+_0x107718(0x190),_0x58913e+='</tr>',_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x132),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x58913e+=_0x107718(0x168);for(let _0x20e233=0x0;_0x20e233<=_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)]-0x1;_0x20e233++){const _0x94afcb=_0x17cbd0[_0x107718(0xbf)][_0x20e233],_0x52d169=_0x94afcb[_0x107718(0x8b)][_0x107718(0x12c)]+'-'+_0x94afcb[_0x107718(0x8b)][_0x107718(0xc8)];var _0x2253fc=_0x310eef[_0x52d169]!==undefined?_0x310eef[_0x52d169][_0x107718(0x92)](0x2):'0',_0x5c4ca2=_0x15907b[_0x52d169]!==undefined?_0x15907b[_0x52d169][_0x107718(0x92)](0x2):'0',_0x5ebe36=_0x15bda5[_0x52d169]!==undefined?_0x15bda5[_0x52d169][_0x107718(0x92)](0x2):'0',_0x54136a=_0x1d2f69[_0x52d169]!==undefined?_0x1d2f69[_0x52d169][_0x107718(0x92)](0x2):'0',_0x4f32bc=_0x1bb013[_0x52d169]!==undefined?_0x1bb013[_0x52d169][_0x107718(0x92)](0x2):'0',_0x30b7e2=_0x5400cd[_0x52d169]!==undefined?_0x5400cd[_0x52d169]['toFixed'](0x2):'0';_0x1ee708=parseFloat(_0x2253fc)+parseFloat(_0x54136a),_0x349756=parseFloat(_0x5ebe36)+parseFloat(_0x30b7e2),_0x75f28d=parseFloat(_0x5c4ca2)+parseFloat(_0x4f32bc),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x58913e+=_0x107718(0x18e),_0x58913e+=_0x107718(0x18e);}_0x58913e+=_0x107718(0x168),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x58913e+=_0x107718(0x168),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x58913e+=_0x107718(0x16c),_0x58913e+=_0x107718(0x168);for(let _0x24004d=0x0;_0x24004d<=_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)]-0x1;_0x24004d++){const _0x12aadd=_0x17cbd0[_0x107718(0xbf)][_0x24004d],_0x3e5b50=_0x12aadd[_0x107718(0x8b)][_0x107718(0x12c)]+'-'+_0x12aadd['_id'][_0x107718(0xc8)];var _0x2253fc=_0x310eef[_0x3e5b50]!==undefined?_0x310eef[_0x3e5b50]['toFixed'](0x2):'0',_0x5c4ca2=_0x15907b[_0x3e5b50]!==undefined?_0x15907b[_0x3e5b50][_0x107718(0x92)](0x2):'0',_0x5ebe36=_0x15bda5[_0x3e5b50]!==undefined?_0x15bda5[_0x3e5b50][_0x107718(0x92)](0x2):'0',_0x54136a=_0x1d2f69[_0x3e5b50]!==undefined?_0x1d2f69[_0x3e5b50][_0x107718(0x92)](0x2):'0',_0x4f32bc=_0x1bb013[_0x3e5b50]!==undefined?_0x1bb013[_0x3e5b50]['toFixed'](0x2):'0',_0x30b7e2=_0x5400cd[_0x3e5b50]!==undefined?_0x5400cd[_0x3e5b50][_0x107718(0x92)](0x2):'0';_0x1ee708=parseFloat(_0x2253fc)+parseFloat(_0x54136a),_0x349756=parseFloat(_0x5ebe36)+parseFloat(_0x30b7e2),_0x75f28d=parseFloat(_0x5c4ca2)+parseFloat(_0x4f32bc),_0x58913e+=_0x107718(0x18e),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x58913e+=_0x107718(0x18e);}_0x58913e+=_0x107718(0x168),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+='</tr>',_0x58913e+=_0x107718(0xa2),_0x58913e+=_0x107718(0x132),_0x58913e+=_0x107718(0xaa),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x297dfc=0x0;_0x297dfc<=_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)]-0x1;_0x297dfc++){const _0x308627=_0x17cbd0[_0x107718(0xbf)][_0x297dfc],_0x2aa507=_0x308627[_0x107718(0x8b)]['brand']+'-'+_0x308627[_0x107718(0x8b)][_0x107718(0xc8)];var _0x2253fc=_0x310eef[_0x2aa507]!==undefined?_0x310eef[_0x2aa507][_0x107718(0x92)](0x2):'0',_0x5c4ca2=_0x15907b[_0x2aa507]!==undefined?_0x15907b[_0x2aa507]['toFixed'](0x2):'0',_0x5ebe36=_0x15bda5[_0x2aa507]!==undefined?_0x15bda5[_0x2aa507][_0x107718(0x92)](0x2):'0',_0x54136a=_0x1d2f69[_0x2aa507]!==undefined?_0x1d2f69[_0x2aa507][_0x107718(0x92)](0x2):'0',_0x4f32bc=_0x1bb013[_0x2aa507]!==undefined?_0x1bb013[_0x2aa507][_0x107718(0x92)](0x2):'0',_0x30b7e2=_0x5400cd[_0x2aa507]!==undefined?_0x5400cd[_0x2aa507]['toFixed'](0x2):'0';_0x1ee708=parseFloat(_0x2253fc)+parseFloat(_0x54136a),_0x349756=parseFloat(_0x5ebe36)+parseFloat(_0x30b7e2),_0x75f28d=parseFloat(_0x5c4ca2)+parseFloat(_0x4f32bc),_0x58913e+=_0x107718(0x18e),_0x58913e+=_0x107718(0x18e),_0x58913e+=_0x107718(0x18e);}_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0xa2),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x58913e+=_0x107718(0x1b8),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x46e3cc=0x0;_0x46e3cc<=_0x17cbd0[_0x107718(0xbf)][_0x107718(0x1d0)]-0x1;_0x46e3cc++){const _0x5a74dd=_0x17cbd0[_0x107718(0xbf)][_0x46e3cc],_0x19d53b=_0x5a74dd[_0x107718(0x8b)]['brand']+'-'+_0x5a74dd['_id'][_0x107718(0xc8)];var _0x2253fc=_0x310eef[_0x19d53b]!==undefined?_0x310eef[_0x19d53b][_0x107718(0x92)](0x2):'',_0x5c4ca2=_0x15907b[_0x19d53b]!==undefined?_0x15907b[_0x19d53b][_0x107718(0x92)](0x2):'',_0x5ebe36=_0x15bda5[_0x19d53b]!==undefined?_0x15bda5[_0x19d53b][_0x107718(0x92)](0x2):'',_0x54136a=_0x1d2f69[_0x19d53b]!==undefined?_0x1d2f69[_0x19d53b][_0x107718(0x92)](0x2):'',_0x4f32bc=_0x1bb013[_0x19d53b]!==undefined?_0x1bb013[_0x19d53b][_0x107718(0x92)](0x2):'',_0x30b7e2=_0x5400cd[_0x19d53b]!==undefined?_0x5400cd[_0x19d53b]['toFixed'](0x2):'';_0x1ee708=formatNumber(parseFloat(_0x2253fc)+parseFloat(_0x54136a)),_0x349756=formatNumber(parseFloat(_0x5ebe36)+parseFloat(_0x30b7e2)),_0x75f28d=formatNumber(parseFloat(_0x5c4ca2)+parseFloat(_0x4f32bc)),_0x58913e+=_0x107718(0x10c)+_0x2253fc+_0x107718(0x150),_0x58913e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x5ebe36+_0x107718(0x150),_0x58913e+=_0x107718(0x10c)+_0x5c4ca2+_0x107718(0x150);}_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+='</tr>',_0x58913e+='<tr>',_0x58913e+=_0x107718(0x132),_0x58913e+=_0x107718(0x171),_0x58913e+=_0x107718(0x168);for(let _0x42dae2=0x0;_0x42dae2<=_0x17cbd0['cat_brand']['length']-0x1;_0x42dae2++){const _0x528d15=_0x17cbd0[_0x107718(0xbf)][_0x42dae2],_0x3368db=_0x528d15[_0x107718(0x8b)][_0x107718(0x12c)]+'-'+_0x528d15[_0x107718(0x8b)][_0x107718(0xc8)];var _0x2253fc=_0x310eef[_0x3368db]!==undefined?_0x310eef[_0x3368db]['toFixed'](0x2):'0',_0x5c4ca2=_0x15907b[_0x3368db]!==undefined?_0x15907b[_0x3368db][_0x107718(0x92)](0x2):'0',_0x5ebe36=_0x15bda5[_0x3368db]!==undefined?_0x15bda5[_0x3368db][_0x107718(0x92)](0x2):'0',_0x54136a=_0x1d2f69[_0x3368db]!==undefined?_0x1d2f69[_0x3368db]['toFixed'](0x2):'0',_0x4f32bc=_0x1bb013[_0x3368db]!==undefined?_0x1bb013[_0x3368db][_0x107718(0x92)](0x2):'0',_0x30b7e2=_0x5400cd[_0x3368db]!==undefined?_0x5400cd[_0x3368db][_0x107718(0x92)](0x2):'0';_0x1ee708=parseFloat(_0x2253fc)+parseFloat(_0x54136a),_0x349756=parseFloat(_0x5ebe36)+parseFloat(_0x30b7e2),_0x75f28d=parseFloat(_0x5c4ca2)+parseFloat(_0x4f32bc),_0x58913e+=_0x107718(0x18e),_0x58913e+=_0x107718(0x18e),_0x58913e+=_0x107718(0x18e);}_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x168),_0x58913e+=_0x107718(0x134),_0x58913e+=_0x107718(0x89),_0x58913e+=_0x107718(0xd9);}),_0x58913e;}async function generateReferenceNumber(_0x1ce4c8,_0x35c74c,_0x5f4056){const _0x1e2430=a0_0x3b11a9,_0x2597bc=new Date(_0x1ce4c8)['getFullYear'](),_0x264d14=('0'+(new Date(_0x1ce4c8)[_0x1e2430(0x177)]()+0x1))['slice'](-0x2),_0x2a513e=('0'+new Date(_0x1ce4c8)[_0x1e2430(0x1fe)]())['slice'](-0x2),_0x488ce0=await staff[_0x1e2430(0x144)]({'email':_0x5f4056['email']}),_0x316104=_0x488ce0[_0x1e2430(0x1f2)],_0x2ca223=_0x316104+'-'+_0x2597bc+_0x264d14+_0x2a513e,_0xbfc9de=await Reference[_0x1e2430(0x144)]({'referenceNumber':new RegExp('^'+_0x2ca223),'salesman_code':_0x316104})['sort']({'createdAt':-0x1}),_0x211d95=_0x2ca223;_0xbfc9de&&(_0x211d95=_0xbfc9de[_0x1e2430(0x181)]);console[_0x1e2430(0xae)](_0x211d95);const _0x361a25=new Reference({'referenceNumber':_0x211d95,'staff_id':_0x35c74c,'salesman_code':_0x316104});return await _0x361a25['save'](),_0x211d95;}router['post'](a0_0x3b11a9(0x15b),auth,async(_0x39cfec,_0x4460fb)=>{const _0x2a5c27=a0_0x3b11a9,{from_date:_0x2461e9,dataview:_0x176150}=_0x39cfec['body'],_0x2ec84c=_0x39cfec[_0x2a5c27(0x163)],_0x599d61=await staff[_0x2a5c27(0x144)]({'email':_0x2ec84c[_0x2a5c27(0x15d)]}),_0x2559ab=await master_shop[_0x2a5c27(0x1fb)](),_0x41e0f4='';var _0x3363da=new Date(_0x2461e9);const _0x310391={'year':'numeric','month':_0x2a5c27(0x188),'day':_0x2a5c27(0x1cb)},_0x29d260=new Intl[(_0x2a5c27(0x1a4))](_0x2a5c27(0x1e3),_0x310391)[_0x2a5c27(0xea)](_0x3363da),_0x363988=await Reference[_0x2a5c27(0x1fb)]({'staff_id':_0x599d61[_0x2a5c27(0x8b)]['valueOf'](),'date_include':_0x2461e9});if(_0x363988['length']>0x0){let _0x1e8a77='';_0x1e8a77+=_0x363988[0x0]['html'];if(_0x176150=='excel'){const _0x29ba54=cheerio[_0x2a5c27(0x1c7)](_0x1e8a77);let _0x281c83=[],_0x2e28af=[],_0x571335=[];const _0x31cf99=_0x4b19b4=>{const _0x4bc0ee=_0x2a5c27,_0x53664c={'top':{'style':_0x4bc0ee(0x1fd),'color':{'rgb':_0x4bc0ee(0x1da)}},'bottom':{'style':_0x4bc0ee(0x1fd),'color':{'rgb':_0x4bc0ee(0x1da)}},'left':{'style':_0x4bc0ee(0x1fd),'color':{'rgb':_0x4bc0ee(0x1da)}},'right':{'style':'thick','color':{'rgb':_0x4bc0ee(0x1da)}}};if(_0x4b19b4){const _0x3c3b16=_0x4b19b4[_0x4bc0ee(0x119)](';')[_0x4bc0ee(0xec)]((_0x3a554c,_0x1f5b1b)=>{const _0x7239e4=_0x4bc0ee,[_0x5bff1d,_0x4b183f]=_0x1f5b1b[_0x7239e4(0x119)](':')[_0x7239e4(0x128)](_0x1d35ff=>_0x1d35ff[_0x7239e4(0x1c0)]());return _0x3a554c[_0x5bff1d]=_0x4b183f,_0x3a554c;},{});_0x3c3b16[_0x4bc0ee(0x1d7)]&&(_0x53664c[_0x4bc0ee(0x167)][_0x4bc0ee(0x129)]=_0x3c3b16[_0x4bc0ee(0x1d7)][_0x4bc0ee(0x15f)](_0x4bc0ee(0x1bb))?_0x4bc0ee(0x1bb):'medium'),_0x3c3b16['border-bottom']&&(_0x53664c[_0x4bc0ee(0x152)][_0x4bc0ee(0x129)]=_0x3c3b16['border-bottom']['includes'](_0x4bc0ee(0x1bb))?'thin':_0x4bc0ee(0x204)),_0x3c3b16[_0x4bc0ee(0x102)]&&(_0x53664c['left']['style']=_0x3c3b16[_0x4bc0ee(0x102)][_0x4bc0ee(0x15f)](_0x4bc0ee(0x1bb))?_0x4bc0ee(0x1bb):_0x4bc0ee(0x204)),_0x3c3b16[_0x4bc0ee(0xc4)]&&(_0x53664c[_0x4bc0ee(0x1a3)][_0x4bc0ee(0x129)]=_0x3c3b16[_0x4bc0ee(0xc4)][_0x4bc0ee(0x15f)]('thin')?'thin':_0x4bc0ee(0x204));}return _0x53664c;};_0x29ba54(_0x2a5c27(0x1e0))[_0x2a5c27(0x14f)]((_0x4992c5,_0x5e4a42)=>{const _0x13d334=_0x2a5c27;let _0x263407=[],_0x24897e=0x0;while(_0x571335[_0x24897e]){_0x571335[_0x24897e]--,_0x24897e++;}_0x29ba54(_0x5e4a42)[_0x13d334(0x1fb)](_0x13d334(0x1b2))[_0x13d334(0x14f)]((_0x340164,_0x3a987f)=>{const _0x1015ca=_0x13d334;let _0x350ff9=_0x29ba54(_0x3a987f)['text']()[_0x1015ca(0x1c0)](),_0x4f1a63=parseFloat(_0x350ff9[_0x1015ca(0xa9)](/,/g,''));isNaN(_0x4f1a63)&&(_0x4f1a63=_0x350ff9);let _0x5514b2=parseInt(_0x29ba54(_0x3a987f)[_0x1015ca(0xcd)](_0x1015ca(0x88)))||0x1,_0x46eb5f=parseInt(_0x29ba54(_0x3a987f)['attr'](_0x1015ca(0x1fa)))||0x1;const _0x5f6c00=_0x29ba54(_0x3a987f)[_0x1015ca(0xcd)](_0x1015ca(0x129)),_0x389314=_0x31cf99(_0x5f6c00);_0x263407[_0x24897e]={'v':_0x4f1a63,'s':{'border':_0x389314}};(_0x5514b2>0x1||_0x46eb5f>0x1)&&_0x2e28af['push']({'s':{'r':_0x4992c5,'c':_0x24897e},'e':{'r':_0x4992c5+_0x46eb5f-0x1,'c':_0x24897e+_0x5514b2-0x1}});for(let _0x4525e8=0x0;_0x4525e8<_0x5514b2;_0x4525e8++){_0x46eb5f>0x1&&(_0x571335[_0x24897e+_0x4525e8]=_0x46eb5f-0x1);}_0x24897e+=_0x5514b2;}),_0x281c83[_0x13d334(0x170)](_0x263407);});const _0x2f462c=XLSX[_0x2a5c27(0x17a)][_0x2a5c27(0x173)](),_0x5ad01d=XLSX[_0x2a5c27(0x17a)][_0x2a5c27(0xf8)](_0x281c83);_0x2e28af[_0x2a5c27(0x1d0)]>0x0&&(_0x5ad01d[_0x2a5c27(0x8c)]=_0x2e28af);_0x5ad01d['!cols']=_0x281c83[0x0][_0x2a5c27(0x128)](()=>({'wpx':0x64})),XLSX[_0x2a5c27(0x17a)][_0x2a5c27(0x184)](_0x2f462c,_0x5ad01d,_0x2a5c27(0x17b));const _0x25c806=XLSX[_0x2a5c27(0xb9)](_0x2f462c,{'bookType':'xlsx','type':_0x2a5c27(0x20b)});_0x4460fb[_0x2a5c27(0x141)](_0x2a5c27(0x1ce),_0x2a5c27(0x1b3)),_0x4460fb['setHeader']('Content-Type',_0x2a5c27(0x11a)),_0x4460fb[_0x2a5c27(0xf4)](_0x25c806);}else htmlContent+=_0x2a5c27(0x11f),htmlContent+='window.onload\x20=\x20function()\x20{',htmlContent+=_0x2a5c27(0xb7),htmlContent+='};',htmlContent+='</script>',_0x4460fb[_0x2a5c27(0xf4)](htmlContent);}else generateReferenceNumber(_0x2461e9,_0x599d61[_0x2a5c27(0x8b)]['valueOf'](),_0x2ec84c)[_0x2a5c27(0x20a)](async _0x47d781=>{const _0x3efb89=_0x2a5c27,_0x2b81b0=await agentsdataDSICheck_DSRR(_0x2461e9,_0x599d61['_id'][_0x3efb89(0xe2)](),_0x41e0f4,_0x47d781);let _0x5352df='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x5352df+=_0x3efb89(0x10b),_0x5352df+=_0x3efb89(0xd1),_0x5352df+=_0x3efb89(0x130),_0x5352df+=_0x2b81b0,_0x5352df+=_0x3efb89(0xd9),_0x5352df+=_0x3efb89(0x178),_0x5352df+=_0x3efb89(0x178);if(_0x2b81b0[_0x3efb89(0x1d0)]>0x0){const _0x266449=await Reference[_0x3efb89(0x144)]({'staff_id':_0x599d61['_id'][_0x3efb89(0xe2)](),'referenceNumber':_0x47d781});_0x266449[_0x3efb89(0x99)]=_0x5352df,_0x266449[_0x3efb89(0x1c1)]=_0x2461e9,await _0x266449[_0x3efb89(0xb5)]();if(_0x176150==_0x3efb89(0x1ac)){const _0x5043bf=cheerio[_0x3efb89(0x1c7)](_0x5352df);let _0x429dfa=[],_0x16dbd2=[],_0x356154=[];const _0x4c204a=_0x1d2bde=>{const _0x1db83b=_0x3efb89,_0x187139={'top':{'style':_0x1db83b(0x1fd),'color':{'rgb':'000000'}},'bottom':{'style':_0x1db83b(0x1fd),'color':{'rgb':'000000'}},'left':{'style':_0x1db83b(0x1fd),'color':{'rgb':_0x1db83b(0x1da)}},'right':{'style':_0x1db83b(0x1fd),'color':{'rgb':_0x1db83b(0x1da)}}};if(_0x1d2bde){const _0x5d2fee=_0x1d2bde[_0x1db83b(0x119)](';')[_0x1db83b(0xec)]((_0x4b3fc7,_0x381df2)=>{const _0x4295d8=_0x1db83b,[_0x5d2d3b,_0x378637]=_0x381df2[_0x4295d8(0x119)](':')[_0x4295d8(0x128)](_0x3eed58=>_0x3eed58[_0x4295d8(0x1c0)]());return _0x4b3fc7[_0x5d2d3b]=_0x378637,_0x4b3fc7;},{});_0x5d2fee[_0x1db83b(0x1d7)]&&(_0x187139['top']['style']=_0x5d2fee['border-top'][_0x1db83b(0x15f)](_0x1db83b(0x1bb))?_0x1db83b(0x1bb):_0x1db83b(0x204)),_0x5d2fee[_0x1db83b(0xfe)]&&(_0x187139['bottom'][_0x1db83b(0x129)]=_0x5d2fee[_0x1db83b(0xfe)][_0x1db83b(0x15f)](_0x1db83b(0x1bb))?_0x1db83b(0x1bb):_0x1db83b(0x204)),_0x5d2fee[_0x1db83b(0x102)]&&(_0x187139[_0x1db83b(0xd0)]['style']=_0x5d2fee[_0x1db83b(0x102)][_0x1db83b(0x15f)](_0x1db83b(0x1bb))?_0x1db83b(0x1bb):_0x1db83b(0x204)),_0x5d2fee[_0x1db83b(0xc4)]&&(_0x187139[_0x1db83b(0x1a3)]['style']=_0x5d2fee[_0x1db83b(0xc4)][_0x1db83b(0x15f)]('thin')?_0x1db83b(0x1bb):_0x1db83b(0x204));}return _0x187139;};_0x5043bf(_0x3efb89(0x1e0))['each']((_0x3642a8,_0xea6eb4)=>{const _0x27df67=_0x3efb89;let _0x16a09d=[],_0x31d8a5=0x0;while(_0x356154[_0x31d8a5]){_0x356154[_0x31d8a5]--,_0x31d8a5++;}_0x5043bf(_0xea6eb4)[_0x27df67(0x1fb)](_0x27df67(0x1b2))[_0x27df67(0x14f)]((_0x53c7b2,_0x40a3bb)=>{const _0x1839b6=_0x27df67;let _0x5e0684=_0x5043bf(_0x40a3bb)[_0x1839b6(0x18b)]()['trim'](),_0x2b2960=parseFloat(_0x5e0684['replace'](/,/g,''));isNaN(_0x2b2960)&&(_0x2b2960=_0x5e0684);let _0x4cfecd=parseInt(_0x5043bf(_0x40a3bb)[_0x1839b6(0xcd)](_0x1839b6(0x88)))||0x1,_0x5a2dcf=parseInt(_0x5043bf(_0x40a3bb)[_0x1839b6(0xcd)](_0x1839b6(0x1fa)))||0x1;const _0x4b8f7c=_0x5043bf(_0x40a3bb)[_0x1839b6(0xcd)](_0x1839b6(0x129)),_0x15dae1=_0x4c204a(_0x4b8f7c);_0x16a09d[_0x31d8a5]={'v':_0x2b2960,'s':{'border':_0x15dae1}};(_0x4cfecd>0x1||_0x5a2dcf>0x1)&&_0x16dbd2[_0x1839b6(0x170)]({'s':{'r':_0x3642a8,'c':_0x31d8a5},'e':{'r':_0x3642a8+_0x5a2dcf-0x1,'c':_0x31d8a5+_0x4cfecd-0x1}});for(let _0x3a62e5=0x0;_0x3a62e5<_0x4cfecd;_0x3a62e5++){_0x5a2dcf>0x1&&(_0x356154[_0x31d8a5+_0x3a62e5]=_0x5a2dcf-0x1);}_0x31d8a5+=_0x4cfecd;}),_0x429dfa[_0x27df67(0x170)](_0x16a09d);});const _0x594829=XLSX['utils'][_0x3efb89(0x173)](),_0x430923=XLSX[_0x3efb89(0x17a)]['aoa_to_sheet'](_0x429dfa);_0x16dbd2[_0x3efb89(0x1d0)]>0x0&&(_0x430923[_0x3efb89(0x8c)]=_0x16dbd2);_0x430923[_0x3efb89(0xb6)]=_0x429dfa[0x0][_0x3efb89(0x128)](()=>({'wpx':0x64})),XLSX[_0x3efb89(0x17a)][_0x3efb89(0x184)](_0x594829,_0x430923,_0x3efb89(0x17b));const _0x11a7e0=XLSX[_0x3efb89(0xb9)](_0x594829,{'bookType':_0x3efb89(0x142),'type':_0x3efb89(0x20b)});_0x4460fb[_0x3efb89(0x141)](_0x3efb89(0x1ce),_0x3efb89(0x1b3)),_0x4460fb[_0x3efb89(0x141)](_0x3efb89(0xb1),_0x3efb89(0x11a)),_0x4460fb[_0x3efb89(0xf4)](_0x11a7e0);}else _0x5352df+=_0x3efb89(0x11f),_0x5352df+=_0x3efb89(0x96),_0x5352df+=_0x3efb89(0xb7),_0x5352df+='};',_0x5352df+='</script>',_0x4460fb[_0x3efb89(0xf4)](_0x5352df);}else await Reference[_0x3efb89(0x209)]({'referenceNumber':_0x47d781}),_0x39cfec[_0x3efb89(0x1c6)](_0x3efb89(0x1a2),'No\x20data\x20was\x20Found!'),_0x4460fb[_0x3efb89(0x1e1)](_0x3efb89(0x94));})['catch'](console[_0x2a5c27(0x1b7)]);}),router[a0_0x3b11a9(0xe9)](a0_0x3b11a9(0x148),auth,async(_0x54822e,_0x5b60e4)=>{const _0x524e9d=a0_0x3b11a9;try{const {username:_0x35aab3,email:_0x517f6a,role:_0x14b7ea}=_0x54822e[_0x524e9d(0x163)],_0x1e4dec=_0x54822e[_0x524e9d(0x163)],_0x39b726=await profile[_0x524e9d(0x144)]({'email':_0x1e4dec['email']}),_0x3f47b0={'year':_0x524e9d(0x1cb),'month':_0x524e9d(0x188),'day':_0x524e9d(0x1cb)},_0x43957f=await master_shop[_0x524e9d(0x1fb)]();console[_0x524e9d(0xae)](_0x524e9d(0xd6),_0x43957f);const _0x45dba8=await product[_0x524e9d(0x1fb)]();console[_0x524e9d(0xae)](_0x524e9d(0x1ed),_0x45dba8);const _0x302d8f=await warehouse[_0x524e9d(0xc9)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x524e9d(0xab),'localField':'product_details.product_name','foreignField':'name','as':_0x524e9d(0x17e)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x524e9d(0x208),'product_stock':_0x524e9d(0x1f4)}},{'$group':{'_id':_0x524e9d(0x15e),'product_stock':{'$sum':_0x524e9d(0x12b)}}}]);console['log'](_0x524e9d(0x113),_0x302d8f),_0x302d8f['forEach'](_0x26c77f=>{const _0x2db506=_0x524e9d,_0x525506=_0x45dba8[_0x2db506(0x128)](_0x45703f=>{const _0x1d5a8e=_0x2db506;_0x45703f[_0x1d5a8e(0x110)]==_0x26c77f[_0x1d5a8e(0x8b)]&&(_0x45703f[_0x1d5a8e(0xc6)]=parseInt(_0x45703f[_0x1d5a8e(0xc6)])+parseInt(_0x26c77f[_0x1d5a8e(0x95)]));});});const _0x196085=await staff[_0x524e9d(0x1fb)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x2237b8=await staff['findOne']({'email':_0x1e4dec[_0x524e9d(0x15d)]});if(_0x43957f[0x0][_0x524e9d(0xa4)]==_0x524e9d(0xf9))var _0x3be9d7=users['English'];else{if(_0x43957f[0x0][_0x524e9d(0xa4)]=='Hindi')var _0x3be9d7=users[_0x524e9d(0x159)];else{if(_0x43957f[0x0]['language']=='German')var _0x3be9d7=users[_0x524e9d(0xb3)];else{if(_0x43957f[0x0][_0x524e9d(0xa4)]==_0x524e9d(0x154))var _0x3be9d7=users[_0x524e9d(0x154)];else{if(_0x43957f[0x0][_0x524e9d(0xa4)]==_0x524e9d(0x17c))var _0x3be9d7=users[_0x524e9d(0x17c)];else{if(_0x43957f[0x0]['language']=='Portuguese\x20(BR)')var _0x3be9d7=users[_0x524e9d(0x137)];else{if(_0x43957f[0x0][_0x524e9d(0xa4)]==_0x524e9d(0x118))var _0x3be9d7=users[_0x524e9d(0x118)];else{if(_0x43957f[0x0][_0x524e9d(0xa4)]=='Arabic\x20(ae)')var _0x3be9d7=users['Arabic'];}}}}}}}_0x5b60e4['render'](_0x524e9d(0xe7),{'success':_0x54822e['flash'](_0x524e9d(0x1f0)),'errors':_0x54822e[_0x524e9d(0x1c6)]('errors'),'alldata':_0x45dba8,'profile':_0x39b726,'master_shop':_0x43957f,'role':_0x1e4dec,'product_stock':_0x302d8f,'language':_0x3be9d7,'staff_arr':_0x2237b8,'staff_data_all':_0x196085});}catch(_0x39650d){}}),router[a0_0x3b11a9(0x108)](a0_0x3b11a9(0x1c8),auth,async(_0xdace01,_0x21201a)=>{const _0x525cc3=a0_0x3b11a9;try{const {from:_0x954787,to:_0x147053,staff_data:_0x197699}=_0xdace01['body'],_0x15fa2d=await Reference[_0x525cc3(0xc9)]([{'$match':{'date_include':{'$gte':_0x954787,'$lte':_0x147053},'staff_id':_0x197699}},{'$sort':{'date_include':0x1}}]);_0x21201a['json'](_0x15fa2d);}catch(_0x128249){_0x21201a[_0x525cc3(0x172)](_0x128249);}}),router[a0_0x3b11a9(0xe9)]('/dsrr_admin/view_data/:id',auth,async(_0x2181a7,_0x34fcbd)=>{const _0x1e90c0=a0_0x3b11a9;try{const _0x5bcb98=_0x2181a7[_0x1e90c0(0x20c)]['id'],_0x1b4634=await Reference['findById'](_0x5bcb98);_0x34fcbd[_0x1e90c0(0xf4)](_0x1b4634['html']);}catch(_0x589b01){_0x34fcbd[_0x1e90c0(0x172)](_0x589b01);}}),router[a0_0x3b11a9(0x108)](a0_0x3b11a9(0x91),auth,async(_0x4bbc17,_0xf6ab3)=>{const _0x5752d9=a0_0x3b11a9;try{const {ref_data:_0x554ab0}=_0x4bbc17['body'],_0x4da269=_0x554ab0[_0x5752d9(0x119)]('~'),_0x341274=_0x4da269[_0x5752d9(0xf6)](_0x1f605c=>_0x1f605c!==''),_0x18fc69=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x341274}}}]),_0x140de3=XLSX[_0x5752d9(0x17a)][_0x5752d9(0x173)]();_0x18fc69[_0x5752d9(0xcc)](_0x41d0aa=>{const _0x8b558e=_0x5752d9,_0x1278dd=cheerio[_0x8b558e(0x1c7)](_0x41d0aa['html']);let _0xd3a5=[],_0x3d4af7=[],_0x1e828f=[];_0x1278dd('table\x20tr')[_0x8b558e(0x14f)]((_0x2a8543,_0x50a350)=>{const _0x3e1d50=_0x8b558e;let _0x420f52=[],_0x2565ff=0x0;while(_0x1e828f[_0x2565ff]){_0x1e828f[_0x2565ff]--,_0x2565ff++;}_0x1278dd(_0x50a350)[_0x3e1d50(0x1fb)](_0x3e1d50(0x1b2))['each']((_0x40b0c4,_0x47cffd)=>{const _0x2182d5=_0x3e1d50;let _0x8ff1fc=_0x1278dd(_0x47cffd)[_0x2182d5(0x18b)]()[_0x2182d5(0x1c0)](),_0x24dc7c=parseFloat(_0x8ff1fc[_0x2182d5(0xa9)](/,/g,''));isNaN(_0x24dc7c)&&(_0x24dc7c=_0x8ff1fc);let _0x448aa4=parseInt(_0x1278dd(_0x47cffd)['attr']('colspan'))||0x1,_0x47fb5a=parseInt(_0x1278dd(_0x47cffd)[_0x2182d5(0xcd)](_0x2182d5(0x1fa)))||0x1;_0x420f52[_0x2565ff]=_0x24dc7c;(_0x448aa4>0x1||_0x47fb5a>0x1)&&_0x3d4af7[_0x2182d5(0x170)]({'s':{'r':_0x2a8543,'c':_0x2565ff},'e':{'r':_0x2a8543+_0x47fb5a-0x1,'c':_0x2565ff+_0x448aa4-0x1}});for(let _0x5c37e1=0x0;_0x5c37e1<_0x448aa4;_0x5c37e1++){_0x47fb5a>0x1&&(_0x1e828f[_0x2565ff+_0x5c37e1]=_0x47fb5a-0x1);}_0x2565ff+=_0x448aa4;}),_0xd3a5[_0x3e1d50(0x170)](_0x420f52);});const _0x1bc9e0=XLSX[_0x8b558e(0x17a)][_0x8b558e(0xf8)](_0xd3a5);_0x3d4af7[_0x8b558e(0x1d0)]>0x0&&(_0x1bc9e0[_0x8b558e(0x8c)]=_0x3d4af7),_0x1bc9e0[_0x8b558e(0xb6)]=_0xd3a5[0x0][_0x8b558e(0x128)](()=>({'wpx':0x64})),XLSX[_0x8b558e(0x17a)][_0x8b558e(0x184)](_0x140de3,_0x1bc9e0,_0x41d0aa[_0x8b558e(0x181)]);});const _0x4ebb9b=XLSX[_0x5752d9(0xb9)](_0x140de3,{'bookType':_0x5752d9(0x142),'type':_0x5752d9(0x20b)});_0xf6ab3[_0x5752d9(0x141)](_0x5752d9(0x1ce),_0x5752d9(0x1ca)),_0xf6ab3[_0x5752d9(0x141)](_0x5752d9(0xb1),_0x5752d9(0x11a)),_0xf6ab3[_0x5752d9(0xf4)](_0x4ebb9b);}catch(_0x3a634d){_0xf6ab3['json'](_0x3a634d);}}),router[a0_0x3b11a9(0x108)](a0_0x3b11a9(0xcf),auth,async(_0x51d315,_0x40b13d)=>{const _0x3066b5=a0_0x3b11a9,{from_date:_0x3e0862,agent_id:_0x1a6789}=_0x51d315[_0x3066b5(0xa3)],_0x50d508=_0x51d315[_0x3066b5(0x163)],_0x35c470=await staff['findOne']({'email':_0x50d508[_0x3066b5(0x15d)]}),_0x179ec3=await master_shop[_0x3066b5(0x1fb)](),_0x3f9822=await agentsdataDSICheck_DSRR(_0x3e0862,_0x1a6789,_0x46dbb5);let _0xbb9f17=_0x3066b5(0x1dc);var _0x730a7=new Date(_0x3e0862);const _0x42af53={'year':'numeric','month':_0x3066b5(0x188),'day':_0x3066b5(0x1cb)},_0x485a9d=new Intl[(_0x3066b5(0x1a4))](_0x3066b5(0x1e3),_0x42af53)[_0x3066b5(0xea)](_0x730a7);_0xbb9f17+='<div\x20class=\x22row\x22>',_0xbb9f17+=_0x3066b5(0xd1),_0xbb9f17+=_0x3066b5(0x130),_0xbb9f17+=_0x3f9822,_0xbb9f17+='</table>',_0xbb9f17+=_0x3066b5(0x178),_0xbb9f17+=_0x3066b5(0x178);let _0x1f1a1c='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x3e7697={'width':_0x3066b5(0x1b9),'height':_0x3066b5(0x196),'orientation':_0x3066b5(0x1d3),'border':{'top':'0.1in','right':_0x3066b5(0x185),'bottom':'0.1in','left':_0x3066b5(0x185)},'header':{'height':_0x3066b5(0x1f7),'contents':_0x3066b5(0x19b)+_0x1f1a1c+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x485a9d+_0x3066b5(0x176)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};var _0x46dbb5='on';if(_0x46dbb5=='on'){const _0x29818a=cheerio[_0x3066b5(0x1c7)](_0xbb9f17);let _0x50fb12=[],_0x2886db=[],_0x2e18b7=[];_0x29818a(_0x3066b5(0x1e0))['each']((_0x33dfa2,_0xbe9962)=>{const _0x3002e3=_0x3066b5;let _0x13b550=[],_0x529457=0x0;while(_0x2e18b7[_0x529457]){_0x2e18b7[_0x529457]--,_0x529457++;}_0x29818a(_0xbe9962)[_0x3002e3(0x1fb)](_0x3002e3(0x1b2))[_0x3002e3(0x14f)]((_0xe91f93,_0xf284db)=>{const _0x5caf43=_0x3002e3;let _0xc5a9b7=_0x29818a(_0xf284db)[_0x5caf43(0x18b)]()[_0x5caf43(0x1c0)](),_0x54c5fd=parseFloat(_0xc5a9b7[_0x5caf43(0xa9)](/,/g,''));isNaN(_0x54c5fd)&&(_0x54c5fd=_0xc5a9b7);let _0x44b2e7=parseInt(_0x29818a(_0xf284db)[_0x5caf43(0xcd)](_0x5caf43(0x88)))||0x1,_0x50ca3a=parseInt(_0x29818a(_0xf284db)['attr'](_0x5caf43(0x1fa)))||0x1;_0x13b550[_0x529457]=_0x54c5fd;(_0x44b2e7>0x1||_0x50ca3a>0x1)&&_0x2886db[_0x5caf43(0x170)]({'s':{'r':_0x33dfa2,'c':_0x529457},'e':{'r':_0x33dfa2+_0x50ca3a-0x1,'c':_0x529457+_0x44b2e7-0x1}});for(let _0x43ca6f=0x0;_0x43ca6f<_0x44b2e7;_0x43ca6f++){_0x50ca3a>0x1&&(_0x2e18b7[_0x529457+_0x43ca6f]=_0x50ca3a-0x1);}_0x529457+=_0x44b2e7;}),_0x50fb12['push'](_0x13b550);});const _0x599619=XLSX['utils'][_0x3066b5(0x173)](),_0x1d99f2=XLSX['utils'][_0x3066b5(0xf8)](_0x50fb12);_0x2886db[_0x3066b5(0x1d0)]>0x0&&(_0x1d99f2[_0x3066b5(0x8c)]=_0x2886db);_0x1d99f2[_0x3066b5(0xb6)]=_0x50fb12[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x599619,_0x1d99f2,_0x3066b5(0x17b));const _0x232d2e=XLSX[_0x3066b5(0xb9)](_0x599619,{'bookType':_0x3066b5(0x142),'type':'buffer'});_0x40b13d[_0x3066b5(0x141)](_0x3066b5(0x1ce),_0x3066b5(0x1b3)),_0x40b13d[_0x3066b5(0x141)]('Content-Type',_0x3066b5(0x11a)),_0x40b13d['send'](_0x232d2e);}else pdf[_0x3066b5(0xb2)](_0xbb9f17,_0x3e7697)[_0x3066b5(0x1b1)](function(_0x547d23,_0x2c847d){const _0x5cbed0=_0x3066b5;if(_0x547d23){_0x40b13d[_0x5cbed0(0xc1)](0x1f4)[_0x5cbed0(0xf4)](_0x5cbed0(0xc0));return;}_0x40b13d['setHeader'](_0x5cbed0(0xb1),_0x5cbed0(0xca)),_0x2c847d[_0x5cbed0(0x1ec)](_0x40b13d);});}),module[a0_0x3b11a9(0x166)]=router;