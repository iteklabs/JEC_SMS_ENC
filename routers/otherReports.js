const a0_0x209eb3=a0_0x1463;(function(_0x461a0d,_0x3bc29f){const _0x3a8204=a0_0x1463,_0x52793e=_0x461a0d();while(!![]){try{const _0x38a202=parseInt(_0x3a8204(0x156))/0x1+-parseInt(_0x3a8204(0xe2))/0x2*(parseInt(_0x3a8204(0x1b5))/0x3)+-parseInt(_0x3a8204(0xe4))/0x4+parseInt(_0x3a8204(0xf1))/0x5+-parseInt(_0x3a8204(0x12d))/0x6*(-parseInt(_0x3a8204(0xb1))/0x7)+parseInt(_0x3a8204(0x19f))/0x8+-parseInt(_0x3a8204(0x12c))/0x9;if(_0x38a202===_0x3bc29f)break;else _0x52793e['push'](_0x52793e['shift']());}catch(_0x412d9c){_0x52793e['push'](_0x52793e['shift']());}}}(a0_0x1b46,0x721ba));const express=require(a0_0x209eb3(0x173)),res=require(a0_0x209eb3(0x1b7)),app=express(),router=express[a0_0x209eb3(0x14c)](),multer=require('multer'),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x209eb3(0xc3)),excelJS=require(a0_0x209eb3(0x12e)),XLSX=require(a0_0x209eb3(0x185)),PDFDocument=require('pdfkit-table'),fs=require('fs'),blobStream=require(a0_0x209eb3(0x208)),JsBarcode=require(a0_0x209eb3(0x1fd)),{Canvas}=require(a0_0x209eb3(0x139)),pdf=require(a0_0x209eb3(0x10a)),path=require(a0_0x209eb3(0x88)),mongoose=require(a0_0x209eb3(0xf0)),cheerio=require(a0_0x209eb3(0xf5));router[a0_0x209eb3(0xbd)](a0_0x209eb3(0x8c),auth,async(_0x47778c,_0x1788bc)=>{const _0x414883=a0_0x209eb3;try{const {username:_0x3c1bad,email:_0x2fad15,role:_0x27e9cc}=_0x47778c[_0x414883(0x1d8)],_0x1112ab=_0x47778c[_0x414883(0x1d8)],_0x16fba2=await profile[_0x414883(0x1ef)]({'email':_0x1112ab[_0x414883(0x15f)]}),_0x40adb3={'year':_0x414883(0x79),'month':_0x414883(0xaa),'day':_0x414883(0x79)},_0x15045e=await master_shop[_0x414883(0x1a9)]();console[_0x414883(0x200)](_0x414883(0xd8),_0x15045e);const _0x391a11=await product[_0x414883(0x1a9)]();console[_0x414883(0x200)](_0x414883(0xc5),_0x391a11);const _0x3c8c9b=await warehouse['aggregate']([{'$unwind':_0x414883(0xb3)},{'$lookup':{'from':_0x414883(0x143),'localField':_0x414883(0x1ab),'foreignField':_0x414883(0x202),'as':_0x414883(0x103)}},{'$unwind':_0x414883(0x17f)},{'$project':{'product_name':_0x414883(0x9e),'product_stock':_0x414883(0xe6)}},{'$group':{'_id':_0x414883(0xd7),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x414883(0x200)]('Products\x20warehouse_data',_0x3c8c9b),_0x3c8c9b[_0x414883(0x115)](_0x193de4=>{const _0x3511b7=_0x391a11['map'](_0x259f83=>{const _0x356dd3=a0_0x1463;_0x259f83['name']==_0x193de4[_0x356dd3(0x152)]&&(_0x259f83[_0x356dd3(0xe9)]=parseInt(_0x259f83[_0x356dd3(0xe9)])+parseInt(_0x193de4['product_stock']));});}),console[_0x414883(0x200)]('Products\x20find_data',_0x391a11);if(_0x15045e[0x0]['language']==_0x414883(0xe3))var _0x4641b2=users[_0x414883(0xe5)];else{if(_0x15045e[0x0][_0x414883(0xfd)]==_0x414883(0x81))var _0x4641b2=users[_0x414883(0x81)];else{if(_0x15045e[0x0][_0x414883(0xfd)]==_0x414883(0x205))var _0x4641b2=users[_0x414883(0x205)];else{if(_0x15045e[0x0][_0x414883(0xfd)]=='Spanish')var _0x4641b2=users[_0x414883(0x169)];else{if(_0x15045e[0x0][_0x414883(0xfd)]=='French')var _0x4641b2=users['French'];else{if(_0x15045e[0x0]['language']==_0x414883(0x10e))var _0x4641b2=users['Portuguese'];else{if(_0x15045e[0x0][_0x414883(0xfd)]==_0x414883(0xc0))var _0x4641b2=users[_0x414883(0xc0)];else{if(_0x15045e[0x0][_0x414883(0xfd)]=='Arabic\x20(ae)')var _0x4641b2=users[_0x414883(0x15c)];}}}}}}}_0x1788bc[_0x414883(0x84)](_0x414883(0x97),{'success':_0x47778c[_0x414883(0x124)](_0x414883(0x18e)),'errors':_0x47778c[_0x414883(0x124)](_0x414883(0x1d2)),'alldata':_0x391a11,'profile':_0x16fba2,'master_shop':_0x15045e,'role':_0x1112ab,'product_stock':_0x3c8c9b,'language':_0x4641b2});}catch(_0x4248e4){}});async function dataCheck(_0x349904,_0x2db3b3){const _0x5eef2e=a0_0x209eb3,_0x11d853=await product[_0x5eef2e(0x147)]([{'$group':{'_id':{'brand':_0x5eef2e(0x80),'category':_0x5eef2e(0x16a)},'products':{'$push':{'name':_0x5eef2e(0x99),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xf438c8=[];_0xf438c8[_0x5eef2e(0x189)]=[];for(let _0x5ea29e=0x0;_0x5ea29e<=_0x11d853[_0x5eef2e(0x102)]-0x1;_0x5ea29e++){const _0xbca2cc=_0x11d853[_0x5ea29e];_0xf438c8['cat_brand'][_0x5eef2e(0xff)](_0xbca2cc);}const _0x4436ee=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x5eef2e(0x80),'product_code':_0x5eef2e(0x8e),'product_name':_0x5eef2e(0x99)}}}},{'$sort':{'_id.category':-0x1}}]),_0x54c007=await purchases_finished[_0x5eef2e(0x147)]([{'$match':{'date':{'$gte':_0x349904,'$lte':_0x2db3b3}}},{'$unwind':_0x5eef2e(0x1fa)},{'$group':{'_id':{'product_name':_0x5eef2e(0x1e8),'product_code':'$product.product_code'},'totalQTY':{'$sum':_0x5eef2e(0x207)}}}]);_0xf438c8['beg_bal']=[];for(let _0x1a375f=0x0;_0x1a375f<=_0x54c007['length']-0x1;_0x1a375f++){const _0x14cca0=_0x54c007[_0x1a375f];_0xf438c8[_0x5eef2e(0x180)][_0x5eef2e(0xff)](_0x14cca0);}const _0x47bbf8=await sales_sa[_0x5eef2e(0x147)]([{'$match':{'date':{'$gte':_0x349904,'$lte':_0x2db3b3}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x5eef2e(0x19c),'localField':_0x5eef2e(0x16f),'foreignField':_0x5eef2e(0x152),'as':_0x5eef2e(0xa0)}},{'$unwind':_0x5eef2e(0x1e2)},{'$unwind':_0x5eef2e(0x1cc)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x5eef2e(0x1e5),'product_code':_0x5eef2e(0x1ff)},'totalQTY':{'$sum':_0x5eef2e(0x17b)}}}]);console[_0x5eef2e(0x200)](_0x47bbf8[0x0]),_0xf438c8[_0x5eef2e(0x153)]=[];for(let _0x6078cd=0x0;_0x6078cd<=_0x47bbf8[_0x5eef2e(0x102)]-0x1;_0x6078cd++){const _0x473cef=_0x47bbf8[_0x6078cd];_0xf438c8[_0x5eef2e(0x153)][_0x5eef2e(0xff)](_0x473cef);}const _0x46b23f=await sales_sa[_0x5eef2e(0x147)]([{'$match':{'date':{'$gte':_0x349904,'$lte':_0x2db3b3}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5eef2e(0x16b)}}},{'$lookup':{'from':'staffs','localField':_0x5eef2e(0x16f),'foreignField':'_id','as':_0x5eef2e(0xa0)}},{'$unwind':_0x5eef2e(0x1e2)},{'$unwind':_0x5eef2e(0x1cc)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':'false'}},{'$group':{'_id':{'product_name':_0x5eef2e(0x1e5),'product_code':_0x5eef2e(0x1ff)},'totalQTY':{'$sum':_0x5eef2e(0x1ca)}}}]);_0xf438c8[_0x5eef2e(0x15a)]=[];for(let _0x5aeb5d=0x0;_0x5aeb5d<=_0x46b23f['length']-0x1;_0x5aeb5d++){const _0x5367f7=_0x46b23f[_0x5aeb5d];_0xf438c8[_0x5eef2e(0x15a)][_0x5eef2e(0xff)](_0x5367f7);}let _0x1fa931='';for(let _0x1918fd=0x0;_0x1918fd<=_0x4436ee[_0x5eef2e(0x102)]-0x1;_0x1918fd++){const _0x3c610a=_0x4436ee[_0x1918fd];_0x1fa931+='<tr>',_0x1fa931+=_0x5eef2e(0x165)+_0x3c610a[_0x5eef2e(0x152)][_0x5eef2e(0x1aa)]+_0x5eef2e(0xf3),_0x1fa931+='</tr>';for(let _0x3fe8d9=0x0;_0x3fe8d9<_0xf438c8[_0x5eef2e(0x189)][_0x5eef2e(0x102)];_0x3fe8d9++){const _0x1ce203=_0xf438c8[_0x5eef2e(0x189)][_0x3fe8d9];if(_0x1ce203[_0x5eef2e(0x152)][_0x5eef2e(0x1aa)]==_0x3c610a[_0x5eef2e(0x152)][_0x5eef2e(0x1aa)]){let _0x43aca5=[],_0x178239=[],_0x3cbc33=[];_0x43aca5[_0x1ce203[_0x5eef2e(0x152)][_0x5eef2e(0xcb)]]=[],_0x178239[_0x1ce203[_0x5eef2e(0x152)]['brand']]=[],_0x3cbc33[_0x1ce203[_0x5eef2e(0x152)][_0x5eef2e(0xcb)]]=[];var _0x3cfd62=0x0,_0x323be8=0x0,_0x894867=0x0;for(let _0x3f75d6=0x0;_0x3f75d6<_0x1ce203[_0x5eef2e(0x143)][_0x5eef2e(0x102)];_0x3f75d6++){const _0x5afa35=_0x1ce203[_0x5eef2e(0x143)][_0x3f75d6];for(let _0x1d05f6=0x0;_0x1d05f6<=_0xf438c8[_0x5eef2e(0x180)][_0x5eef2e(0x102)]-0x1;_0x1d05f6++){const _0x15482e=_0xf438c8[_0x5eef2e(0x180)][_0x1d05f6];_0x15482e[_0x5eef2e(0x152)][_0x5eef2e(0x127)]==_0x5afa35[_0x5eef2e(0x202)]&&_0x15482e[_0x5eef2e(0x152)][_0x5eef2e(0x160)]==_0x5afa35[_0x5eef2e(0x160)]&&(_0x3cfd62+=parseInt(_0x15482e['totalQTY'],0xa));}for(let _0x37a484=0x0;_0x37a484<=_0xf438c8[_0x5eef2e(0x15a)][_0x5eef2e(0x102)]-0x1;_0x37a484++){const _0x36a922=_0xf438c8[_0x5eef2e(0x15a)][_0x37a484];_0x36a922[_0x5eef2e(0x152)][_0x5eef2e(0x127)]==_0x5afa35['name']&&_0x36a922['_id']['product_code']==_0x5afa35['product_code']&&(_0x323be8+=parseFloat(_0x36a922[_0x5eef2e(0xa8)],0xa)[_0x5eef2e(0x188)](0x2));}for(let _0x41e438=0x0;_0x41e438<=_0xf438c8[_0x5eef2e(0x153)]['length']-0x1;_0x41e438++){const _0x4062d1=_0xf438c8['sales_bkg'][_0x41e438];_0x4062d1[_0x5eef2e(0x152)][_0x5eef2e(0x127)]==_0x5afa35[_0x5eef2e(0x202)]&&_0x4062d1[_0x5eef2e(0x152)][_0x5eef2e(0x160)]==_0x5afa35['product_code']&&(_0x894867+=parseInt(_0x4062d1[_0x5eef2e(0xa8)],0xa));}}const _0x1d1fe7=new Intl[(_0x5eef2e(0x142))](_0x5eef2e(0x131));var _0x53b25f=_0x1d1fe7['format'](_0x3cfd62);_0x43aca5[_0x1ce203['_id'][_0x5eef2e(0xcb)]]['push'](_0x53b25f),_0x178239[_0x1ce203[_0x5eef2e(0x152)][_0x5eef2e(0xcb)]][_0x5eef2e(0xff)](_0x1d1fe7[_0x5eef2e(0x129)](_0x323be8)),_0x3cbc33[_0x1ce203[_0x5eef2e(0x152)][_0x5eef2e(0xcb)]][_0x5eef2e(0xff)](_0x1d1fe7[_0x5eef2e(0x129)](_0x894867));var _0x330f5a=_0x1d1fe7[_0x5eef2e(0x129)](_0x3cfd62-(_0x894867+_0x323be8));_0x1fa931+='<tr>',_0x1fa931+=_0x5eef2e(0xd1),_0x1fa931+=_0x5eef2e(0x106)+_0x1ce203[_0x5eef2e(0x152)][_0x5eef2e(0xcb)]+_0x5eef2e(0xf3),_0x1fa931+=_0x5eef2e(0x106)+_0x43aca5[_0x1ce203[_0x5eef2e(0x152)][_0x5eef2e(0xcb)]][0x0]+'</td>',_0x1fa931+='<td\x20class=\x22row_data\x22>0</td>',_0x1fa931+=_0x5eef2e(0x106)+_0x3cbc33[_0x1ce203[_0x5eef2e(0x152)]['brand']][0x0]+'</td>',_0x1fa931+='<td\x20class=\x22row_data\x22>'+_0x178239[_0x1ce203['_id'][_0x5eef2e(0xcb)]][0x0]+_0x5eef2e(0xf3),_0x1fa931+='<td\x20class=\x22row_data\x22>'+_0x330f5a+_0x5eef2e(0xf3),_0x1fa931+=_0x5eef2e(0x1f8);}}}return console[_0x5eef2e(0x200)](_0xf438c8['sales_bkg']),_0x1fa931;}router['post']('/balance/pdf',auth,async(_0x1024e8,_0x4fd7c1)=>{const _0xeb3814=a0_0x209eb3,{from_date:_0x36b69e,to_date:_0x19600a}=_0x1024e8[_0xeb3814(0xad)],_0x31f466=await dataCheck(_0x36b69e,_0x19600a);{}let _0x12235f=_0xeb3814(0x125);var _0x780f06=new Date(_0x36b69e),_0x17bdd2=new Date(_0x19600a);const _0x1500b0={'year':_0xeb3814(0x79),'month':_0xeb3814(0xaa),'day':_0xeb3814(0x79)},_0x1e2e61=new Intl[(_0xeb3814(0x1c6))](_0xeb3814(0x131),_0x1500b0)[_0xeb3814(0x129)](_0x780f06),_0x3e2fcd=new Intl[(_0xeb3814(0x1c6))](_0xeb3814(0x131),_0x1500b0)['format'](_0x17bdd2);_0x12235f+=_0xeb3814(0xd0),_0x12235f+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x12235f+=_0xeb3814(0x137)+_0x1e2e61+_0xeb3814(0x82)+_0x3e2fcd+_0xeb3814(0xdb),_0x12235f+=_0xeb3814(0x1f6),_0x12235f+=_0xeb3814(0xce),_0x12235f+=_0xeb3814(0x14d),_0x12235f+=_0xeb3814(0x130),_0x12235f+=_0xeb3814(0x1bf),_0x12235f+=_0xeb3814(0x7d),_0x12235f+=_0xeb3814(0x1a3)+_0x1e2e61+_0xeb3814(0x1f1),_0x12235f+=_0xeb3814(0x1de),_0x12235f+=_0xeb3814(0x1ed),_0x12235f+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x3e2fcd+_0xeb3814(0x1f1),_0x12235f+=_0xeb3814(0x1f8),_0x12235f+=_0xeb3814(0x130),_0x12235f+=_0xeb3814(0x1b8),_0x12235f+=_0xeb3814(0xb4),_0x12235f+=_0xeb3814(0x1f8),_0x12235f+=_0x31f466,_0x12235f+=_0xeb3814(0xcf),_0x12235f+=_0xeb3814(0x155),_0x12235f+=_0xeb3814(0x155);const _0x18b18c={'format':_0xeb3814(0xc9),'orientation':_0xeb3814(0x1fc)};pdf[_0xeb3814(0xcd)](_0x12235f,_0x18b18c)[_0xeb3814(0x100)](function(_0x1346cf,_0x3ab2d3){const _0x41b365=_0xeb3814;if(_0x1346cf){_0x4fd7c1[_0x41b365(0x19b)](0x1f4)[_0x41b365(0x8a)](_0x41b365(0xb8));return;}_0x4fd7c1[_0x41b365(0x92)](_0x41b365(0xd2),'application/pdf'),_0x3ab2d3[_0x41b365(0x13d)](_0x4fd7c1);});}),router[a0_0x209eb3(0xbd)](a0_0x209eb3(0x199),auth,async(_0x4a772a,_0x5c9205)=>{const _0x23d8c2=a0_0x209eb3;try{const {username:_0x16bcbf,email:_0x5b1214,role:_0x59be87}=_0x4a772a['user'],_0x44e171=_0x4a772a[_0x23d8c2(0x1d8)],_0x5c8346=await profile[_0x23d8c2(0x1ef)]({'email':_0x44e171[_0x23d8c2(0x15f)]}),_0x5248fa={'year':_0x23d8c2(0x79),'month':'long','day':_0x23d8c2(0x79)},_0x3b2841=await master_shop[_0x23d8c2(0x1a9)](),_0x33b95e=await product['find'](),_0x234690=await warehouse[_0x23d8c2(0x147)]([{'$unwind':_0x23d8c2(0xb3)},{'$lookup':{'from':_0x23d8c2(0x143),'localField':_0x23d8c2(0x1ab),'foreignField':_0x23d8c2(0x202),'as':'product_docs'}},{'$unwind':_0x23d8c2(0x17f)},{'$project':{'product_name':_0x23d8c2(0x9e),'product_stock':_0x23d8c2(0xe6)}},{'$group':{'_id':_0x23d8c2(0xd7),'product_stock':{'$sum':_0x23d8c2(0x1c0)}}}]);if(_0x3b2841[0x0][_0x23d8c2(0xfd)]=='English\x20(US)')var _0x4b01e5=users['English'];else{if(_0x3b2841[0x0][_0x23d8c2(0xfd)]=='Hindi')var _0x4b01e5=users['Hindi'];else{if(_0x3b2841[0x0][_0x23d8c2(0xfd)]==_0x23d8c2(0x205))var _0x4b01e5=users[_0x23d8c2(0x205)];else{if(_0x3b2841[0x0][_0x23d8c2(0xfd)]==_0x23d8c2(0x169))var _0x4b01e5=users[_0x23d8c2(0x169)];else{if(_0x3b2841[0x0][_0x23d8c2(0xfd)]==_0x23d8c2(0x136))var _0x4b01e5=users[_0x23d8c2(0x136)];else{if(_0x3b2841[0x0][_0x23d8c2(0xfd)]==_0x23d8c2(0x10e))var _0x4b01e5=users[_0x23d8c2(0x1b0)];else{if(_0x3b2841[0x0][_0x23d8c2(0xfd)]==_0x23d8c2(0xc0))var _0x4b01e5=users['Chinese'];else{if(_0x3b2841[0x0][_0x23d8c2(0xfd)]=='Arabic\x20(ae)')var _0x4b01e5=users['Arabic'];}}}}}}}_0x5c9205[_0x23d8c2(0x84)](_0x23d8c2(0xac),{'success':_0x4a772a[_0x23d8c2(0x124)](_0x23d8c2(0x18e)),'errors':_0x4a772a[_0x23d8c2(0x124)](_0x23d8c2(0x1d2)),'alldata':_0x33b95e,'profile':_0x5c8346,'master_shop':_0x3b2841,'role':_0x44e171,'product_stock':_0x234690,'language':_0x4b01e5});}catch(_0x588e80){}});async function agentsdataCheck(_0x4fb68d,_0x525191){const _0x23a70d=a0_0x209eb3,_0x28ff76=await product[_0x23a70d(0x147)]([{'$group':{'_id':{'brand':_0x23a70d(0x80),'category':_0x23a70d(0x16a)},'products':{'$push':{'name':_0x23a70d(0x99),'product_code':_0x23a70d(0x8e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x44ed76=[];_0x44ed76['cat_brand']=[];for(let _0x2abe1=0x0;_0x2abe1<=_0x28ff76[_0x23a70d(0x102)]-0x1;_0x2abe1++){const _0xd3dbdc=_0x28ff76[_0x2abe1];_0x44ed76['cat_brand'][_0x23a70d(0xff)](_0xd3dbdc);}const _0x565d88=await product[_0x23a70d(0x147)]([{'$group':{'_id':{'category':_0x23a70d(0x16a)},'products':{'$push':{'brand':_0x23a70d(0x80),'product_code':'$product_code','product_name':_0x23a70d(0x99)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5eb8a9=await product[_0x23a70d(0x147)]([{'$group':{'_id':{'category':_0x23a70d(0x16a),'brand':'$brand'}}},{'$group':{'_id':_0x23a70d(0xca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2f842a=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x4fb68d,'$lte':_0x525191}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x23a70d(0x16b)}}},{'$lookup':{'from':_0x23a70d(0x19c),'localField':_0x23a70d(0x16f),'foreignField':_0x23a70d(0x152),'as':_0x23a70d(0xa0)}},{'$unwind':_0x23a70d(0x1e2)},{'$unwind':_0x23a70d(0x1cc)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x23a70d(0x1d9)}},{'$lookup':{'from':_0x23a70d(0x143),'localField':'sale_product.product_code','foreignField':'product_code','as':_0x23a70d(0xf8)}},{'$unwind':_0x23a70d(0xda)},{'$group':{'_id':{'sales_id':_0x23a70d(0x110),'category':'$product_info.category','brand':_0x23a70d(0x18d)},'salesman_data':{'$first':'$sales_info.name'},'totalQTY':{'$sum':_0x23a70d(0x1ca)},'products':{'$push':{'qty':_0x23a70d(0x1ca),'product_details':{'prod_name':_0x23a70d(0xbe),'product_code':_0x23a70d(0x1b6),'category':'$product_info.category','brand':_0x23a70d(0x18d)}}}}}]);let _0x918bda='';_0x918bda+=_0x23a70d(0x130),_0x918bda+=_0x23a70d(0x89),_0x918bda+=_0x23a70d(0x1f8),_0x918bda+=_0x23a70d(0x130),_0x918bda+=_0x23a70d(0x1b1);for(let _0x4f8ddf=0x0;_0x4f8ddf<=_0x565d88['length']-0x1;_0x4f8ddf++){const _0x3ca5fc=_0x565d88[_0x4f8ddf];for(let _0x4a3e8c=0x0;_0x4a3e8c<_0x5eb8a9[_0x23a70d(0x102)];_0x4a3e8c++){const _0x3ebfe6=_0x5eb8a9[_0x4a3e8c];_0x3ebfe6[_0x23a70d(0x152)]==_0x3ca5fc[_0x23a70d(0x152)][_0x23a70d(0x1aa)]&&(_0x918bda+='<td\x20colspan=\x22'+_0x3ebfe6[_0x23a70d(0x1a4)]+_0x23a70d(0x13b)+_0x3ca5fc[_0x23a70d(0x152)][_0x23a70d(0x1aa)]+_0x23a70d(0xf3));}}_0x918bda+='<td\x20class=\x22cat_data\x22></td>',_0x918bda+='</tr>',_0x918bda+=_0x23a70d(0x130),_0x918bda+=_0x23a70d(0x145);for(let _0x1f405a=0x0;_0x1f405a<=_0x565d88[_0x23a70d(0x102)]-0x1;_0x1f405a++){const _0x444b8d=_0x565d88[_0x1f405a];for(let _0x172322=0x0;_0x172322<_0x44ed76[_0x23a70d(0x189)][_0x23a70d(0x102)];_0x172322++){const _0x4c58a0=_0x44ed76['cat_brand'][_0x172322];_0x4c58a0[_0x23a70d(0x152)][_0x23a70d(0x1aa)]==_0x444b8d[_0x23a70d(0x152)][_0x23a70d(0x1aa)]&&(_0x918bda+=_0x23a70d(0x16e)+_0x4c58a0[_0x23a70d(0x152)][_0x23a70d(0xcb)]+_0x23a70d(0xf3));}}_0x918bda+=_0x23a70d(0x11f),_0x918bda+=_0x23a70d(0x1f8);let _0x12c06f={'name':[],'dataqty':{}};for(let _0x5a1f4c=0x0;_0x5a1f4c<_0x44ed76[_0x23a70d(0x189)][_0x23a70d(0x102)];_0x5a1f4c++){const _0x21945f=_0x44ed76['cat_brand'][_0x5a1f4c],_0x57faf9=_0x21945f[_0x23a70d(0x152)]['brand'],_0x308cba=_0x21945f[_0x23a70d(0x152)][_0x23a70d(0x1aa)];!_0x12c06f[_0x23a70d(0x1e1)][_0x57faf9]&&(_0x12c06f[_0x23a70d(0x1e1)][_0x57faf9]={});!_0x12c06f[_0x23a70d(0x1e1)][_0x57faf9][_0x308cba]&&(_0x12c06f[_0x23a70d(0x1e1)][_0x57faf9][_0x308cba]=[]);for(let _0x14d631=0x0;_0x14d631<_0x2f842a[_0x23a70d(0x102)];_0x14d631++){const _0x4873d3=_0x2f842a[_0x14d631];if(_0x57faf9===_0x4873d3[_0x23a70d(0x152)][_0x23a70d(0xcb)]&&_0x308cba===_0x4873d3[_0x23a70d(0x152)][_0x23a70d(0x1aa)]){const _0x66a5d5=_0x4873d3[_0x23a70d(0x1a1)];!_0x12c06f[_0x23a70d(0x1e1)][_0x57faf9][_0x308cba][_0x66a5d5]&&(_0x12c06f[_0x23a70d(0x1e1)][_0x57faf9][_0x308cba][_0x66a5d5]=[]),_0x12c06f[_0x23a70d(0x1e1)][_0x57faf9][_0x308cba][_0x66a5d5][_0x23a70d(0xff)](_0x4873d3[_0x23a70d(0xa8)]),!_0x12c06f['name'][_0x23a70d(0x15d)](_0x66a5d5)&&_0x12c06f['name'][_0x23a70d(0xff)](_0x66a5d5);}}}_0x918bda+='<tr>';for(let _0x17ec4=0x0;_0x17ec4<=_0x12c06f['name'][_0x23a70d(0x102)]-0x1;_0x17ec4++){const _0x9051c5=_0x12c06f[_0x23a70d(0x202)][_0x17ec4];_0x918bda+='<td\x20class=\x22row_data\x22>'+_0x9051c5+'</td>';var _0x5ceeb1=0x0,_0xdcec80=0x0;for(let _0x390d25=0x0;_0x390d25<=_0x44ed76[_0x23a70d(0x189)][_0x23a70d(0x102)]-0x1;_0x390d25++){const _0x442ed6=_0x44ed76[_0x23a70d(0x189)][_0x390d25];var _0x392cb6=0x0;_0x12c06f['dataqty'][_0x442ed6['_id'][_0x23a70d(0xcb)]][_0x442ed6[_0x23a70d(0x152)][_0x23a70d(0x1aa)]][_0x9051c5]?(_0x392cb6=_0x12c06f[_0x23a70d(0x1e1)][_0x442ed6['_id'][_0x23a70d(0xcb)]][_0x442ed6[_0x23a70d(0x152)][_0x23a70d(0x1aa)]][_0x9051c5][0x0],_0x918bda+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x392cb6[_0x23a70d(0x188)](0x2))+_0x23a70d(0xf3)):(_0x392cb6=0x0,_0x918bda+=_0x23a70d(0x106)+_0x392cb6+_0x23a70d(0xf3)),_0x5ceeb1+=_0x392cb6;}_0x918bda+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x5ceeb1[_0x23a70d(0x188)](0x2))+_0x23a70d(0xf3);}return _0x918bda+='</tr>',_0x918bda;}router[a0_0x209eb3(0x85)](a0_0x209eb3(0xd9),auth,async(_0x1c9607,_0x3ea061)=>{const _0x3a1021=a0_0x209eb3,{from_date:_0x22df8c,to_date:_0x13bdae}=_0x1c9607[_0x3a1021(0xad)],_0x3caacc=await agentsdataCheck(_0x22df8c,_0x13bdae);{}let _0x49de70=_0x3a1021(0xde);var _0x4ca45f=new Date(_0x22df8c),_0x1b7448=new Date(_0x13bdae);const _0x574e99={'year':'numeric','month':_0x3a1021(0xaa),'day':_0x3a1021(0x79)},_0xfd11a=new Intl[(_0x3a1021(0x1c6))]('en-US',_0x574e99)[_0x3a1021(0x129)](_0x4ca45f),_0x481e32=new Intl[(_0x3a1021(0x1c6))](_0x3a1021(0x131),_0x574e99)[_0x3a1021(0x129)](_0x1b7448);_0x49de70+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x49de70+=_0x3a1021(0x1d5),_0x49de70+=_0x3a1021(0x137)+_0xfd11a+_0x3a1021(0x82)+_0x481e32+'</p>',_0x49de70+=_0x3a1021(0x1f6),_0x49de70+='<div\x20class=\x22col-sm-11\x22>',_0x49de70+=_0x3a1021(0x14d),_0x49de70+=_0x3caacc,_0x49de70+='</table>',_0x49de70+=_0x3a1021(0x155),_0x49de70+=_0x3a1021(0x155);const _0x3ad17e={'format':'Letter','orientation':_0x3a1021(0x1fc)};pdf['create'](_0x49de70,_0x3ad17e)[_0x3a1021(0x100)](function(_0x4beaf8,_0x35fc54){const _0x3179eb=_0x3a1021;if(_0x4beaf8){_0x3ea061[_0x3179eb(0x19b)](0x1f4)[_0x3179eb(0x8a)](_0x3179eb(0xb8));return;}_0x3ea061[_0x3179eb(0x92)](_0x3179eb(0xd2),_0x3179eb(0x1a5)),_0x35fc54[_0x3179eb(0x13d)](_0x3ea061);});}),router[a0_0x209eb3(0xbd)](a0_0x209eb3(0xeb),auth,async(_0x4df129,_0x3e877c)=>{const _0x5404a6=a0_0x209eb3;try{const {username:_0x575f65,email:_0x19b788,role:_0x399156}=_0x4df129[_0x5404a6(0x1d8)],_0x219bef=_0x4df129[_0x5404a6(0x1d8)],_0x213e95=await profile['findOne']({'email':_0x219bef['email']}),_0x3247db={'year':'numeric','month':_0x5404a6(0xaa),'day':'numeric'},_0x51efe0=await master_shop[_0x5404a6(0x1a9)](),_0x21f674=await staff[_0x5404a6(0x1ef)]({'email':_0x219bef[_0x5404a6(0x15f)]}),_0xdbc467=await product[_0x5404a6(0x1a9)](),_0x42a1f5=await warehouse[_0x5404a6(0x147)]([{'$unwind':_0x5404a6(0xb3)},{'$lookup':{'from':_0x5404a6(0x143),'localField':_0x5404a6(0x1ab),'foreignField':_0x5404a6(0x202),'as':_0x5404a6(0x103)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x5404a6(0xe6)}},{'$group':{'_id':_0x5404a6(0xd7),'product_stock':{'$sum':_0x5404a6(0x1c0)}}}]),_0x27304b=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x51efe0[0x0][_0x5404a6(0xfd)]==_0x5404a6(0xe3))var _0x204f84=users[_0x5404a6(0xe5)];else{if(_0x51efe0[0x0][_0x5404a6(0xfd)]==_0x5404a6(0x81))var _0x204f84=users[_0x5404a6(0x81)];else{if(_0x51efe0[0x0][_0x5404a6(0xfd)]=='German')var _0x204f84=users[_0x5404a6(0x205)];else{if(_0x51efe0[0x0][_0x5404a6(0xfd)]==_0x5404a6(0x169))var _0x204f84=users['Spanish'];else{if(_0x51efe0[0x0][_0x5404a6(0xfd)]==_0x5404a6(0x136))var _0x204f84=users[_0x5404a6(0x136)];else{if(_0x51efe0[0x0][_0x5404a6(0xfd)]==_0x5404a6(0x10e))var _0x204f84=users[_0x5404a6(0x1b0)];else{if(_0x51efe0[0x0][_0x5404a6(0xfd)]==_0x5404a6(0xc0))var _0x204f84=users[_0x5404a6(0xc0)];else{if(_0x51efe0[0x0]['language']==_0x5404a6(0x86))var _0x204f84=users['Arabic'];}}}}}}}_0x3e877c['render'](_0x5404a6(0x148),{'success':_0x4df129[_0x5404a6(0x124)](_0x5404a6(0x18e)),'errors':_0x4df129[_0x5404a6(0x124)](_0x5404a6(0x1d2)),'alldata':_0xdbc467,'profile':_0x213e95,'master_shop':_0x51efe0,'role':_0x219bef,'product_stock':_0x42a1f5,'language':_0x204f84,'staff_arr':_0x21f674,'staff_data_all':_0x27304b});}catch(_0x561b26){_0x3e877c[_0x5404a6(0x1b4)](_0x561b26);}});async function agentsdataDSICheck_admin(_0x522b5,_0x111acc,_0x429df7,_0x1add22){const _0x33b6e6=a0_0x209eb3,_0x49e962=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1da1d3=[];_0x1da1d3[_0x33b6e6(0x189)]=[];for(let _0x4c9007=0x0;_0x4c9007<=_0x49e962['length']-0x1;_0x4c9007++){const _0xf6e17e=_0x49e962[_0x4c9007];_0x1da1d3[_0x33b6e6(0x189)][_0x33b6e6(0xff)](_0xf6e17e);}const _0xfdbc13=await product['aggregate']([{'$group':{'_id':{'category':_0x33b6e6(0x16a)},'products':{'$push':{'brand':_0x33b6e6(0x80),'product_code':_0x33b6e6(0x8e),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x2cc987=await product['aggregate']([{'$group':{'_id':{'category':_0x33b6e6(0x16a),'brand':'$brand'}}},{'$group':{'_id':_0x33b6e6(0xca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3c5c33=await sales_sa[_0x33b6e6(0x147)]([{'$match':{'date':{'$gte':_0x522b5,'$lte':_0x111acc},'sales_staff_id':_0x429df7,'sale_product.isFG':_0x33b6e6(0x1d9)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x33b6e6(0x1d9)}},{'$lookup':{'from':_0x33b6e6(0x143),'localField':_0x33b6e6(0x10f),'foreignField':_0x33b6e6(0x160),'as':_0x33b6e6(0xf8)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x33b6e6(0x184),'date':_0x33b6e6(0x1cd),'customer':_0x33b6e6(0x93)},'totalQty':{'$sum':_0x33b6e6(0x1ca)},'products':{'$push':{'qty':_0x33b6e6(0x1ca),'NetPrice':_0x33b6e6(0x1bd),'discount':'$sale_product.discount','adj_discount':_0x33b6e6(0x1bc),'product_details':{'prod_name':_0x33b6e6(0xbe),'product_code':_0x33b6e6(0x1b6),'category':_0x33b6e6(0x1f5),'brand':_0x33b6e6(0x18d),'gross_price':_0x33b6e6(0x18b)}}}}},{'$unwind':_0x33b6e6(0x176)},{'$group':{'_id':{'dsi':_0x33b6e6(0x101),'date':_0x33b6e6(0x141),'customer':_0x33b6e6(0x1c9),'category':_0x33b6e6(0x1c3),'brand':_0x33b6e6(0x128)},'totalQty':{'$sum':_0x33b6e6(0xb2)},'totalGross':{'$sum':{'$multiply':[_0x33b6e6(0xb2),_0x33b6e6(0x11b)]}},'NetPrice':{'$sum':_0x33b6e6(0x1df)},'discount':{'$sum':_0x33b6e6(0xee)},'adj_discount':{'$sum':_0x33b6e6(0x203)},'product_details':{'$first':_0x33b6e6(0x8b)}}},{'$group':{'_id':{'dsi':_0x33b6e6(0x101),'date':_0x33b6e6(0x141),'customer':'$_id.customer'},'totalQty':{'$sum':_0x33b6e6(0x1ad)},'totalGross':{'$sum':_0x33b6e6(0x13e)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x33b6e6(0x1e6)},'adj_discount':{'$sum':_0x33b6e6(0xc8)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':'$_id.brand','product_details':_0x33b6e6(0xb3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x1bf592=[],_0x2591f8={},_0x2fbd34={},_0x46ea9c={};var _0x18abaf=0x0,_0x52e844=0x0,_0x360fbe=0x0,_0x89f25a=0x0,_0x4ea624=0x0;const _0x2c512f=0x6;for(let _0xf12d1f=0x0;_0xf12d1f<=_0x3c5c33[_0x33b6e6(0x102)]-0x1;_0xf12d1f++){const _0xe704d5=_0x3c5c33[_0xf12d1f];let _0x5bd48d=_0x33b6e6(0x130);_0x5bd48d+=_0x33b6e6(0x1f4)+_0xe704d5['_id'][_0x33b6e6(0xb0)]+'</td>',_0x5bd48d+=_0x33b6e6(0x1f4)+_0xe704d5['_id'][_0x33b6e6(0x177)]+_0x33b6e6(0xf3),_0x5bd48d+=_0x33b6e6(0x1f4)+_0xe704d5[_0x33b6e6(0x152)][_0x33b6e6(0x1ac)]+_0x33b6e6(0xf3);let _0xa00844={};var _0x26a064=0x0;for(let _0x7feaa5=0x0;_0x7feaa5<=_0xe704d5[_0x33b6e6(0x143)][_0x33b6e6(0x102)]-0x1;_0x7feaa5++){const _0x4ca131=_0xe704d5['products'][_0x7feaa5];_0xa00844[_0x4ca131['brand']+'-'+_0x4ca131[_0x33b6e6(0x1aa)]]=_0x4ca131[_0x33b6e6(0xa3)];const _0x1c7939=_0x4ca131['brand']+'-'+_0x4ca131[_0x33b6e6(0x1aa)];!_0x2591f8[_0x1c7939]&&(_0x2591f8[_0x1c7939]=0x0),!Array['isArray'](_0x46ea9c[_0x1c7939])&&(_0x46ea9c[_0x1c7939]=[]),!Array[_0x33b6e6(0xe0)](_0x46ea9c[_0x1c7939])&&(_0x46ea9c[_0x1c7939]=[]),_0x2591f8[_0x1c7939]+=_0x4ca131[_0x33b6e6(0xa3)],_0x46ea9c[_0x1c7939][_0x33b6e6(0xff)](_0x4ca131[_0x33b6e6(0xa3)]),_0x26a064++;}console['log'](_0xe704d5);for(let _0x5e4e91=0x0;_0x5e4e91<=_0x1da1d3[_0x33b6e6(0x189)]['length']-0x1;_0x5e4e91++){const _0x27038f=_0x1da1d3[_0x33b6e6(0x189)][_0x5e4e91],_0x104668=_0x27038f[_0x33b6e6(0x152)][_0x33b6e6(0xcb)]+'-'+_0x27038f[_0x33b6e6(0x152)][_0x33b6e6(0x1aa)];_0x5bd48d+=_0x33b6e6(0x9f)+(_0xa00844[_0x104668]!==undefined?_0xa00844[_0x104668]['toFixed'](0x2):'')+_0x33b6e6(0xf3);}_0x360fbe=_0xe704d5[_0x33b6e6(0xc4)]+_0xe704d5[_0x33b6e6(0x138)],_0x5bd48d+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0xe704d5[_0x33b6e6(0x116)],0x2)[_0x33b6e6(0x188)](0x2))+_0x33b6e6(0xf3),_0x5bd48d+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xe704d5['totalGross']['toFixed'](0x2))+_0x33b6e6(0xf3),_0x5bd48d+=_0x33b6e6(0x1f0)+formatNumber(_0x360fbe)+_0x33b6e6(0xf3),_0x5bd48d+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xe704d5[_0x33b6e6(0x13a)][_0x33b6e6(0x188)](0x2))+'</td>',_0x5bd48d+=_0x33b6e6(0x1f8),_0x18abaf+=parseFloat(_0xe704d5[_0x33b6e6(0x116)][_0x33b6e6(0x188)](0x2)),_0x52e844+=parseFloat(_0xe704d5[_0x33b6e6(0x13a)][_0x33b6e6(0x188)](0x2)),_0x89f25a+=_0x360fbe,_0x4ea624+=parseFloat(_0xe704d5['totalGross'][_0x33b6e6(0x188)](0x2));if(_0xf12d1f==_0x3c5c33[_0x33b6e6(0x102)]-0x1){_0x5bd48d+=_0x33b6e6(0x130),_0x5bd48d+=_0x33b6e6(0xa2),_0x5bd48d+=_0x33b6e6(0xf3);for(let _0x44c39b=0x0;_0x44c39b<=_0x1da1d3['cat_brand']['length']-0x1;_0x44c39b++){const _0x188bd2=_0x1da1d3[_0x33b6e6(0x189)][_0x44c39b],_0x75a251=_0x188bd2[_0x33b6e6(0x152)]['brand']+'-'+_0x188bd2[_0x33b6e6(0x152)][_0x33b6e6(0x1aa)],_0x320dc6=_0x46ea9c[_0x75a251][_0x33b6e6(0x1d7)]((_0x2f5134,_0x8442c3)=>_0x2f5134+_0x8442c3,0x0);console[_0x33b6e6(0x200)](_0x33b6e6(0x191),_0x75a251),_0x5bd48d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x320dc6!==undefined?formatNumber(_0x320dc6[_0x33b6e6(0x188)](0x2)):'')+_0x33b6e6(0x183),console['log'](_0x46ea9c[_0x75a251][_0x33b6e6(0x1d7)]((_0x138250,_0x431442)=>_0x138250+_0x431442,0x0));}_0x5bd48d+=_0x33b6e6(0x1f9)+formatNumber(_0x18abaf['toFixed'](0x2))+'</b></td>',_0x5bd48d+=_0x33b6e6(0x1f9)+formatNumber(_0x4ea624)+_0x33b6e6(0x183),_0x5bd48d+=_0x33b6e6(0x1f9)+formatNumber(_0x89f25a)+'</b></td>',_0x5bd48d+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x52e844)+_0x33b6e6(0x183),_0x5bd48d+=_0x33b6e6(0x1f8);}_0x1bf592['push'](_0x5bd48d);}function _0x66ce0a(_0x2e03b8,_0x3dd20b){const _0x17153f=_0x33b6e6,_0x470938=[];for(let _0x4371e7=0x0;_0x4371e7<=_0x2e03b8['length']-0x1;_0x4371e7+=_0x3dd20b){_0x470938[_0x17153f(0xff)](_0x2e03b8[_0x17153f(0x1da)](_0x4371e7,_0x4371e7+_0x3dd20b));}return _0x470938;}const _0xca8ce2=_0x66ce0a(_0x1bf592,_0x2c512f);let _0x3ddbed='';return _0xca8ce2[_0x33b6e6(0x115)]((_0x2a5bd4,_0x59175f)=>{const _0x5d1582=_0x33b6e6;_0x59175f>0x0&&(_0x3ddbed+=_0x5d1582(0xc7));_0x3ddbed+=_0x5d1582(0x14d),_0x3ddbed+='<thead>',_0x3ddbed+=_0x5d1582(0x130),_0x3ddbed+=_0x5d1582(0x172),_0x3ddbed+=_0x5d1582(0x1f8),_0x3ddbed+=_0x5d1582(0x130),_0x3ddbed+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x294809=0x0;_0x294809<=_0xfdbc13[_0x5d1582(0x102)]-0x1;_0x294809++){const _0x14d2fd=_0xfdbc13[_0x294809];for(let _0x18d889=0x0;_0x18d889<_0x2cc987[_0x5d1582(0x102)];_0x18d889++){const _0x84ba05=_0x2cc987[_0x18d889];_0x84ba05[_0x5d1582(0x152)]===_0x14d2fd[_0x5d1582(0x152)]['category']&&(_0x3ddbed+='<td\x20colspan=\x22'+_0x84ba05[_0x5d1582(0x1a4)]+_0x5d1582(0x13b)+_0x14d2fd[_0x5d1582(0x152)][_0x5d1582(0x1aa)]+_0x5d1582(0xf3));}}_0x3ddbed+=_0x5d1582(0x178),_0x3ddbed+=_0x5d1582(0x1f8),_0x3ddbed+=_0x5d1582(0x130),_0x3ddbed+=_0x5d1582(0x1ae),_0x3ddbed+=_0x5d1582(0x17a),_0x3ddbed+=_0x5d1582(0x197);for(let _0x5a2e58=0x0;_0x5a2e58<=_0xfdbc13[_0x5d1582(0x102)]-0x1;_0x5a2e58++){const _0x4cba6f=_0xfdbc13[_0x5a2e58];for(let _0x21e384=0x0;_0x21e384<_0x1da1d3[_0x5d1582(0x189)][_0x5d1582(0x102)];_0x21e384++){const _0x246a90=_0x1da1d3[_0x5d1582(0x189)][_0x21e384];_0x246a90[_0x5d1582(0x152)][_0x5d1582(0x1aa)]===_0x4cba6f[_0x5d1582(0x152)][_0x5d1582(0x1aa)]&&(_0x3ddbed+=_0x5d1582(0x16e)+_0x246a90['_id'][_0x5d1582(0xcb)]+_0x5d1582(0xf3));}}_0x3ddbed+=_0x5d1582(0x11f),_0x3ddbed+=_0x5d1582(0xea),_0x3ddbed+=_0x5d1582(0x1a8),_0x3ddbed+=_0x5d1582(0x96),_0x3ddbed+=_0x5d1582(0x1f8),_0x3ddbed+='</thead>',_0x3ddbed+=_0x5d1582(0x163),_0x2a5bd4[_0x5d1582(0x115)](_0x481fe1=>{_0x3ddbed+=_0x481fe1;}),console['log'](_0x46ea9c),_0x3ddbed+=_0x5d1582(0xdd),_0x3ddbed+='</table>';}),_0x3ddbed;}async function agentsdataDSICheck_admin_excel(_0xcd3a5a,_0x25889f,_0x22ae78,_0x1c3c17){const _0x545950=a0_0x209eb3,_0x298590=await product['aggregate']([{'$group':{'_id':{'brand':_0x545950(0x80),'category':'$category'},'products':{'$push':{'name':_0x545950(0x99),'product_code':_0x545950(0x8e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x176c34=[];_0x176c34[_0x545950(0x189)]=[];for(let _0x53ef94=0x0;_0x53ef94<=_0x298590['length']-0x1;_0x53ef94++){const _0xd9c8ab=_0x298590[_0x53ef94];_0x176c34[_0x545950(0x189)]['push'](_0xd9c8ab);}const _0x22e968=await product['aggregate']([{'$group':{'_id':{'category':_0x545950(0x16a)},'products':{'$push':{'brand':_0x545950(0x80),'product_code':'$product_code','product_name':_0x545950(0x99)}}}},{'$sort':{'_id.category':-0x1}}]),_0x42d4eb=await product[_0x545950(0x147)]([{'$group':{'_id':{'category':_0x545950(0x16a),'brand':_0x545950(0x80)}}},{'$group':{'_id':_0x545950(0xca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2b0df9=await sales_sa[_0x545950(0x147)]([{'$match':{'date':{'$gte':_0xcd3a5a,'$lte':_0x25889f},'sales_staff_id':_0x22ae78,'sale_product.isFG':_0x545950(0x1d9)}},{'$unwind':_0x545950(0x1cc)},{'$match':{'sale_product.isFG':_0x545950(0x1d9)}},{'$lookup':{'from':_0x545950(0x143),'localField':_0x545950(0x10f),'foreignField':_0x545950(0x160),'as':_0x545950(0xf8)}},{'$unwind':_0x545950(0xda)},{'$group':{'_id':{'dsi':_0x545950(0x184),'date':'$date','customer':_0x545950(0x93)},'totalQty':{'$sum':_0x545950(0x1ca)},'products':{'$push':{'qty':_0x545950(0x1ca),'NetPrice':_0x545950(0x1bd),'discount':'$sale_product.discount','adj_discount':_0x545950(0x1bc),'product_details':{'prod_name':_0x545950(0xbe),'product_code':_0x545950(0x1b6),'category':'$product_info.category','brand':_0x545950(0x18d),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x545950(0x141),'customer':_0x545950(0x1c9),'category':_0x545950(0x1c3),'brand':_0x545950(0x128)},'totalQty':{'$sum':_0x545950(0xb2)},'totalGross':{'$sum':{'$multiply':[_0x545950(0xb2),_0x545950(0x11b)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x545950(0xee)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x545950(0x8b)}}},{'$group':{'_id':{'dsi':_0x545950(0x101),'date':_0x545950(0x141),'customer':'$_id.customer'},'totalQty':{'$sum':_0x545950(0x1ad)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x545950(0xd6)},'discount':{'$sum':_0x545950(0x1e6)},'adj_discount':{'$sum':_0x545950(0xc8)},'products':{'$push':{'qty':_0x545950(0x1ad),'category':'$_id.category','brand':_0x545950(0x7e),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4cf63b=[],_0x348fa3={},_0x5337d1={},_0x5d45e3={};var _0x419709=0x0,_0x105ff3=0x0,_0x13a018=0x0,_0x334a2f=0x0,_0x87cb54=0x0;const _0x3d6f79=0x16345785d8a0000;for(let _0x8ba9d4=0x0;_0x8ba9d4<=_0x2b0df9[_0x545950(0x102)]-0x1;_0x8ba9d4++){const _0x15b1fe=_0x2b0df9[_0x8ba9d4];let _0x1c2dde='<tr>';_0x1c2dde+=_0x545950(0x1f4)+_0x15b1fe[_0x545950(0x152)][_0x545950(0xb0)]+_0x545950(0xf3),_0x1c2dde+=_0x545950(0x1f4)+_0x15b1fe[_0x545950(0x152)][_0x545950(0x177)]+_0x545950(0xf3),_0x1c2dde+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x15b1fe[_0x545950(0x152)][_0x545950(0x1ac)]+_0x545950(0xf3);let _0xb59efd={};var _0x3d7dcf=0x0;for(let _0x193980=0x0;_0x193980<=_0x15b1fe['products'][_0x545950(0x102)]-0x1;_0x193980++){const _0x51cf37=_0x15b1fe['products'][_0x193980];_0xb59efd[_0x51cf37['brand']+'-'+_0x51cf37[_0x545950(0x1aa)]]=_0x51cf37[_0x545950(0xa3)];const _0x3b17cf=_0x51cf37[_0x545950(0xcb)]+'-'+_0x51cf37[_0x545950(0x1aa)];!_0x348fa3[_0x3b17cf]&&(_0x348fa3[_0x3b17cf]=0x0),!Array['isArray'](_0x5d45e3[_0x3b17cf])&&(_0x5d45e3[_0x3b17cf]=[]),!Array[_0x545950(0xe0)](_0x5d45e3[_0x3b17cf])&&(_0x5d45e3[_0x3b17cf]=[]),_0x348fa3[_0x3b17cf]+=_0x51cf37['qty'],_0x5d45e3[_0x3b17cf][_0x545950(0xff)](_0x51cf37[_0x545950(0xa3)]),_0x3d7dcf++;}console[_0x545950(0x200)](_0x15b1fe);for(let _0x52cfab=0x0;_0x52cfab<=_0x176c34[_0x545950(0x189)][_0x545950(0x102)]-0x1;_0x52cfab++){const _0x4525ed=_0x176c34[_0x545950(0x189)][_0x52cfab],_0x237ab9=_0x4525ed[_0x545950(0x152)][_0x545950(0xcb)]+'-'+_0x4525ed[_0x545950(0x152)][_0x545950(0x1aa)];_0x1c2dde+=_0x545950(0x9f)+(_0xb59efd[_0x237ab9]!==undefined?_0xb59efd[_0x237ab9][_0x545950(0x188)](0x2):'')+_0x545950(0xf3);}_0x13a018=_0x15b1fe[_0x545950(0xc4)]+_0x15b1fe[_0x545950(0x138)],_0x1c2dde+=_0x545950(0x1f0)+formatNumber(parseFloat(_0x15b1fe[_0x545950(0x116)],0x2)[_0x545950(0x188)](0x2))+_0x545950(0xf3),_0x1c2dde+=_0x545950(0x1f0)+formatNumber(_0x15b1fe[_0x545950(0x1af)]['toFixed'](0x2))+_0x545950(0xf3),_0x1c2dde+=_0x545950(0x1f0)+formatNumber(_0x13a018)+_0x545950(0xf3),_0x1c2dde+=_0x545950(0x1f0)+formatNumber(_0x15b1fe[_0x545950(0x13a)][_0x545950(0x188)](0x2))+'</td>',_0x1c2dde+=_0x545950(0x1f8),_0x419709+=parseFloat(_0x15b1fe[_0x545950(0x116)][_0x545950(0x188)](0x2)),_0x105ff3+=parseFloat(_0x15b1fe[_0x545950(0x13a)][_0x545950(0x188)](0x2)),_0x334a2f+=_0x13a018,_0x87cb54+=parseFloat(_0x15b1fe[_0x545950(0x1af)]['toFixed'](0x2));if(_0x8ba9d4==_0x2b0df9[_0x545950(0x102)]-0x1){_0x1c2dde+=_0x545950(0x130),_0x1c2dde+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x1c2dde+=_0x545950(0xf3);for(let _0x58e8bc=0x0;_0x58e8bc<=_0x176c34[_0x545950(0x189)][_0x545950(0x102)]-0x1;_0x58e8bc++){const _0x494542=_0x176c34[_0x545950(0x189)][_0x58e8bc],_0x55573e=_0x494542[_0x545950(0x152)][_0x545950(0xcb)]+'-'+_0x494542[_0x545950(0x152)]['category'],_0x5cc70b=_0x5d45e3[_0x55573e][_0x545950(0x1d7)]((_0x3be646,_0xff9240)=>_0x3be646+_0xff9240,0x0);console['log'](_0x545950(0x191),_0x55573e),_0x1c2dde+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x5cc70b!==undefined?formatNumber(_0x5cc70b[_0x545950(0x188)](0x2)):'')+'</b></td>',console[_0x545950(0x200)](_0x5d45e3[_0x55573e][_0x545950(0x1d7)]((_0x831700,_0x226054)=>_0x831700+_0x226054,0x0));}_0x1c2dde+=_0x545950(0x1f9)+formatNumber(_0x419709[_0x545950(0x188)](0x2))+_0x545950(0x183),_0x1c2dde+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x87cb54)+'</b></td>',_0x1c2dde+=_0x545950(0x1f9)+formatNumber(_0x334a2f)+_0x545950(0x183),_0x1c2dde+=_0x545950(0x1f9)+formatNumber(_0x105ff3)+_0x545950(0x183),_0x1c2dde+=_0x545950(0x1f8);}_0x4cf63b[_0x545950(0xff)](_0x1c2dde);}function _0x35cfdc(_0x300146,_0xe68694){const _0x173bc5=_0x545950,_0x4e8099=[];for(let _0x599519=0x0;_0x599519<=_0x300146['length']-0x1;_0x599519+=_0xe68694){_0x4e8099[_0x173bc5(0xff)](_0x300146[_0x173bc5(0x1da)](_0x599519,_0x599519+_0xe68694));}return _0x4e8099;}const _0x4fa38d=_0x35cfdc(_0x4cf63b,_0x3d6f79);let _0x1a4d17='';return _0x4fa38d[_0x545950(0x115)]((_0x2c477c,_0x15c617)=>{const _0x29e7da=_0x545950;_0x15c617>0x0&&(_0x1a4d17+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x1a4d17+=_0x29e7da(0x14d),_0x1a4d17+='<thead>',_0x1a4d17+=_0x29e7da(0x130),_0x1a4d17+=_0x29e7da(0x172),_0x1a4d17+='</tr>',_0x1a4d17+=_0x29e7da(0x130),_0x1a4d17+=_0x29e7da(0xed);for(let _0x46d2f0=0x0;_0x46d2f0<=_0x22e968[_0x29e7da(0x102)]-0x1;_0x46d2f0++){const _0x9967ab=_0x22e968[_0x46d2f0];for(let _0x5b5994=0x0;_0x5b5994<_0x42d4eb['length'];_0x5b5994++){const _0x2aa851=_0x42d4eb[_0x5b5994];_0x2aa851[_0x29e7da(0x152)]===_0x9967ab[_0x29e7da(0x152)]['category']&&(_0x1a4d17+=_0x29e7da(0x1a6)+_0x2aa851[_0x29e7da(0x1a4)]+'\x22\x20class=\x22cat_data\x22>'+_0x9967ab[_0x29e7da(0x152)]['category']+_0x29e7da(0xf3));}}_0x1a4d17+=_0x29e7da(0x178),_0x1a4d17+=_0x29e7da(0x1f8),_0x1a4d17+=_0x29e7da(0x130),_0x1a4d17+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x1a4d17+=_0x29e7da(0x17a),_0x1a4d17+=_0x29e7da(0x197);for(let _0x5052dc=0x0;_0x5052dc<=_0x22e968[_0x29e7da(0x102)]-0x1;_0x5052dc++){const _0x46e1b6=_0x22e968[_0x5052dc];for(let _0x4bf2a0=0x0;_0x4bf2a0<_0x176c34['cat_brand'][_0x29e7da(0x102)];_0x4bf2a0++){const _0x11041c=_0x176c34['cat_brand'][_0x4bf2a0];_0x11041c[_0x29e7da(0x152)][_0x29e7da(0x1aa)]===_0x46e1b6[_0x29e7da(0x152)][_0x29e7da(0x1aa)]&&(_0x1a4d17+=_0x29e7da(0x16e)+_0x11041c[_0x29e7da(0x152)][_0x29e7da(0xcb)]+_0x29e7da(0xf3));}}_0x1a4d17+=_0x29e7da(0x11f),_0x1a4d17+=_0x29e7da(0xea),_0x1a4d17+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x1a4d17+=_0x29e7da(0x96),_0x1a4d17+=_0x29e7da(0x1f8),_0x1a4d17+=_0x29e7da(0x105),_0x1a4d17+='<tbody>',_0x2c477c[_0x29e7da(0x115)](_0x580915=>{_0x1a4d17+=_0x580915;}),console[_0x29e7da(0x200)](_0x5d45e3),_0x1a4d17+=_0x29e7da(0xdd),_0x1a4d17+='</table>';}),_0x1a4d17;}function a0_0x1b46(){const _0x1e93a6=['$product_docs','beg_bal','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','\x22><b>','</b></td>','$dsi','xlsx','<div\x20\x20id=\x22table-conatainer\x22>','$due_date','toFixed','cat_brand','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','$product_info.gross_price','split','$product_info.brand','success','valueOf','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','test','$check_no','<th>\x20SALES\x20</th>','findById','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','/inventory_sum/view','/agent/view','Sales\x20Report','status','staffs','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','5164000AXGygn','medium','salesman_data','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','brandCount','application/pdf','<td\x20colspan=\x22','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','find','category','product_details.product_name','customer','$totalQty','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','totalGross','Portuguese','<td\x20class=\x22cat_data\x22></td>','$cash','book_append_sheet','json','134133ZqNxSG','$product_info.product_code','express/lib/response','<th>Booking</th>','$sale_product._id','<th>\x20INCOMING\x20</th>','thick','$sale_product.adj_discount','$sale_product.totalprice','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','<th\x20rowspan=\x272\x27>Category</th>','$product_stock','prod_cat','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$products.product_details.category','totalPrice','Content-Disposition','DateTimeFormat','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','\x20-\x20HH','$_id.customer','$sale_product.real_qty_unit_val','right','$sale_product','$date','No\x20data\x20was\x20Found!','text','$_id.status_data','!cols','errors','$sale_product.stock','20mm','<p>SALES\x20REPORTS</p>','attachment;\x20filename=\x22reports.xlsx\x22','reduce','user','false','slice','dssr_view','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','<th\x20rowspan=\x272\x27>Production</th>','$products.NetPrice','utils','dataqty','$sales_info','<th>\x20ITEM\x20CODE\x20</th>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$sale_product.product_name','$discount','Household','$product.product_name','/dsrr_admin/pdf_admin','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','toLocaleString','$sale_product.isFG','<th\x20colspan=\x272\x27>SOLD</th>','$sale_product.prod_cat','findOne','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','</th>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','$product_info.category','<div\x20class=\x22row\x22>','0.1in','</tr>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$product','params','landscape','jsbarcode','000000','$sale_product.product_code','log','60mm','name','$products.adj_discount','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','German','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','$product.quantity','blob-stream','numeric','border-top','ObjectId','15in','<th\x20rowspan=\x272\x27>Products</th>','$_id.brand','buffer','$brand','Hindi','\x20-\x20','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','render','post','Arabic\x20(ae)','product_details','path','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','send','$products.product_details','/balance/view','getFullYear','$product_code','<thead>','save','Products\x20warehouse_data','setHeader','$customer','/inventory_sum/pdf','due_date','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','balanced','book_new','$name','<th>\x20BEG\x20BALANCE\x20</th>','border-right','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','cash','$product_details.product_name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','sales_info','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','<td\x20colspan=\x223\x22><b>TOTAL<b>','qty','then','$product_list.product_name','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','totalQTY','top','long','totalQTYsum','agent_sales','body','write','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','dsi','49OHMhJm','$products.qty','$product_details','<th>X-Truck</th>','$product_list','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','exports','Error\x20generating\x20PDF','/dsrr_admin/view_data/:id','getMonth','replace','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','get','$product_info.name','Asia/Manila','Chinese','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','/total_sales_reports/pdf','../public/language/languages.json','discount','Products\x20find_data','/reports/dsrr/view','<div\x20style=\x22page-break-before:\x20always;\x22></div>','$adj_discount','Letter','$_id.category','brand','/dl_excel','create','<div\x20class=\x22col-sm-11\x22>','</table>','<h1>JAKA\x20EQUITIES\x20CORP</h1>','<td\x20class=\x22row_data\x22></td>','Content-Type','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','dssr_view_admin','$NetPrice','$product_name','Products\x20master','/agent/pdf','$product_info','</p>','<td\x20class=\x22cat_data\x22><b>FG</b></td>','</tbody>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','isArray','colspan','4gNEJqG','English\x20(US)','2651608gZyYkM','English','$product_details.product_stock','style','thin','stock','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','/agent_reports/sales_ad','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','$products.discount','amount','mongoose','3680530iRpFrc','left','</td>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','cheerio','/agent_reports/pdf_admin','Types','product_info','<td\x20class=\x22row_data\x22><b>','referenceNumber','border-left','8.5in','language','td,\x20th','push','toStream','$_id.dsi','length','product_docs','true','</thead>','<td\x20class=\x22row_data\x22>','error','html','bank','html-pdf','<th>\x20INVOICE\x20AMOUNT\x20</th>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','Portuguese\x20(BR)','sale_product.product_code','$sales_info._id','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','filter','\x22><b></b></td>','Standard','forEach','totalQty','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','check_no','getDate','catch','$products.product_details.gross_price','\x20-\x20STD','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','$sale_product.discount','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','flash','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','sumqty','product_name','$products.product_details.brand','format','each','aoa_to_sheet','15850179QdbJFc','733548WuBxZy','exceljs','/agent_reports/pdf','<tr>','en-US','isFG','redirect','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','$product_list.product_stock','French','<p>','adj_discount','canvas','NetPrice','\x22\x20class=\x22cat_data\x22>','product_stock','pipe','$totalGross','/total_sales_reports/view','map','$_id.date','NumberFormat','products','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','trim','aggregate','dsi_sales_admin','border-bottom','/getDSSR_no','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','Router','<table>','sort','bottom','<p>INVENTORY\x20SUMMARY</p>','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','_id','sales_bkg','date_include','</div>','743429CjWPrN','note','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','!merges','sales_ext','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','Arabic','includes','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','email','product_code','dsi_sales','load','<tbody>','$bank','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','toISOString','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','attr','Spanish','$category','$sales_staff_id','rowspan','/dsrr_admin/view','<td\x20class=\x22cat_data\x22>','sales_staff_id','$amount','attachment;\x20filename=\x22sales_report.xlsx\x22','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','express','table\x20tr','<th>\x20ENDING\x20BALANCE\x20</th>','$products','date','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','image','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$sale_product.quantity','$status_data','<td\x20class=\x22row_data\x22>0</td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>'];a0_0x1b46=function(){return _0x1e93a6;};return a0_0x1b46();}function a0_0x1463(_0x1a9aa6,_0xffa888){const _0x1b4600=a0_0x1b46();return a0_0x1463=function(_0x146347,_0x5379d4){_0x146347=_0x146347-0x79;let _0x394f2e=_0x1b4600[_0x146347];return _0x394f2e;},a0_0x1463(_0x1a9aa6,_0xffa888);}router[a0_0x209eb3(0x85)](a0_0x209eb3(0xf6),auth,async(_0x9462a1,_0x172ce4)=>{const _0x57a7b2=a0_0x209eb3,{from_date:_0xbe9331,to_date:_0x15f250,isExcel:_0xc902d,agent_id:_0x790062}=_0x9462a1['body'],_0x30ec95=_0x9462a1[_0x57a7b2(0x1d8)],_0x521f33=await staff[_0x57a7b2(0x1ef)]({'email':_0x30ec95[_0x57a7b2(0x15f)]}),_0x5bbdc0=await master_shop[_0x57a7b2(0x1a9)](),_0x134d87=await agentsdataDSICheck_admin(_0xbe9331,_0x15f250,_0x790062,_0xc902d),_0x2d5947=await agentsdataDSICheck_admin_excel(_0xbe9331,_0x15f250,_0x790062,_0xc902d);let _0x184398='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x1ae17d=new Date(_0xbe9331),_0x5dd628=new Date(_0x15f250);const _0x410d90={'year':'numeric','month':_0x57a7b2(0xaa),'day':'numeric'},_0x424bbd=new Intl[(_0x57a7b2(0x1c6))](_0x57a7b2(0x131),_0x410d90)['format'](_0x1ae17d),_0x11c52b=new Intl[(_0x57a7b2(0x1c6))](_0x57a7b2(0x131),_0x410d90)['format'](_0x5dd628);_0x184398+=_0x57a7b2(0x1f6),_0x184398+=_0x57a7b2(0x186),_0x184398+='<table>',_0x184398+=_0x134d87,_0x184398+=_0x57a7b2(0xcf),_0x184398+='</div>',_0x184398+='</div>';let _0x2b9679=_0x57a7b2(0xbc);_0x2b9679+='<div\x20class=\x22row\x22>',_0x2b9679+=_0x57a7b2(0x186),_0x2b9679+=_0x57a7b2(0x14d),_0x2b9679+=_0x2d5947,_0x2b9679+='</table>',_0x2b9679+=_0x57a7b2(0x155),_0x2b9679+=_0x57a7b2(0x155);let _0xb5adc6=_0x57a7b2(0xc1);const _0x1f62b8={'width':_0x57a7b2(0x7c),'height':_0x57a7b2(0xfc),'orientation':'landscape','border':{'top':_0x57a7b2(0x1f7),'right':'0.1in','bottom':_0x57a7b2(0x1f7),'left':'0.1in'},'header':{'height':'60mm','contents':_0x57a7b2(0x10d)+_0xb5adc6+_0x57a7b2(0x167)+_0x424bbd+_0x57a7b2(0x82)+_0x11c52b+_0x57a7b2(0xa7)},'footer':{'height':'20mm','contents':{'default':_0x57a7b2(0x1c7)}},'dpi':0x5,'zoomFactor':'1'};if(_0xc902d=='on'){const _0x283e3b=cheerio[_0x57a7b2(0x162)](_0x2b9679);let _0x3883c1=[],_0x31d1f5=[],_0x32673a=[];_0x283e3b('table\x20tr')[_0x57a7b2(0x12a)]((_0x344764,_0x5ee153)=>{const _0x2076c8=_0x57a7b2;let _0x269947=[],_0x34aaac=0x0;while(_0x32673a[_0x34aaac]){_0x32673a[_0x34aaac]--,_0x34aaac++;}_0x283e3b(_0x5ee153)['find']('td,\x20th')['each']((_0x1d29fb,_0x3876ec)=>{const _0x40b0c8=a0_0x1463;let _0x3393a2=_0x283e3b(_0x3876ec)[_0x40b0c8(0x1cf)]()[_0x40b0c8(0x146)](),_0x2c80be=parseFloat(_0x3393a2[_0x40b0c8(0xbb)](/,/g,''));isNaN(_0x2c80be)&&(_0x2c80be=_0x3393a2);let _0x309ce7=parseInt(_0x283e3b(_0x3876ec)[_0x40b0c8(0x168)](_0x40b0c8(0xe1)))||0x1,_0x38f349=parseInt(_0x283e3b(_0x3876ec)[_0x40b0c8(0x168)](_0x40b0c8(0x16c)))||0x1;_0x269947[_0x34aaac]=_0x2c80be;(_0x309ce7>0x1||_0x38f349>0x1)&&_0x31d1f5['push']({'s':{'r':_0x344764,'c':_0x34aaac},'e':{'r':_0x344764+_0x38f349-0x1,'c':_0x34aaac+_0x309ce7-0x1}});for(let _0x5db20f=0x0;_0x5db20f<_0x309ce7;_0x5db20f++){_0x38f349>0x1&&(_0x32673a[_0x34aaac+_0x5db20f]=_0x38f349-0x1);}_0x34aaac+=_0x309ce7;}),_0x3883c1[_0x2076c8(0xff)](_0x269947);});const _0xae7ffa=XLSX[_0x57a7b2(0x1e0)][_0x57a7b2(0x98)](),_0x5a457d=XLSX[_0x57a7b2(0x1e0)][_0x57a7b2(0x12b)](_0x3883c1);_0x31d1f5['length']>0x0&&(_0x5a457d['!merges']=_0x31d1f5);_0x5a457d[_0x57a7b2(0x1d1)]=_0x3883c1[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x57a7b2(0x1e0)][_0x57a7b2(0x1b3)](_0xae7ffa,_0x5a457d,_0x57a7b2(0x19a));const _0x21e315=XLSX['write'](_0xae7ffa,{'bookType':_0x57a7b2(0x185),'type':_0x57a7b2(0x7f)});_0x172ce4[_0x57a7b2(0x92)]('Content-Disposition',_0x57a7b2(0x171)),_0x172ce4['setHeader']('Content-Type',_0x57a7b2(0x111)),_0x172ce4[_0x57a7b2(0x8a)](_0x21e315);}else pdf[_0x57a7b2(0xcd)](_0x184398,_0x1f62b8)['toStream'](function(_0xfe30d,_0x434713){const _0x4aa625=_0x57a7b2;if(_0xfe30d){_0x172ce4[_0x4aa625(0x19b)](0x1f4)[_0x4aa625(0x8a)]('Error\x20generating\x20PDF');return;}_0x172ce4[_0x4aa625(0x92)](_0x4aa625(0xd2),_0x4aa625(0x1a5)),_0x434713['pipe'](_0x172ce4);});}),router[a0_0x209eb3(0xbd)]('/agent_reports/view',auth,async(_0x44a439,_0x2dac6c)=>{const _0x2d8ff4=a0_0x209eb3;try{const {username:_0x1168d1,email:_0x526f75,role:_0x58859e}=_0x44a439[_0x2d8ff4(0x1d8)],_0x4add41=_0x44a439[_0x2d8ff4(0x1d8)],_0x5e688b=await profile[_0x2d8ff4(0x1ef)]({'email':_0x4add41[_0x2d8ff4(0x15f)]}),_0x4dcdeb={'year':_0x2d8ff4(0x79),'month':_0x2d8ff4(0xaa),'day':_0x2d8ff4(0x79)},_0x1bf775=await master_shop[_0x2d8ff4(0x1a9)](),_0x33b8ee=await staff[_0x2d8ff4(0x1ef)]({'email':_0x4add41['email']}),_0x1ae5e0=await product[_0x2d8ff4(0x1a9)](),_0x210202=await warehouse[_0x2d8ff4(0x147)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x2d8ff4(0x1ab),'foreignField':_0x2d8ff4(0x202),'as':_0x2d8ff4(0x103)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x2d8ff4(0x9e),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x2d8ff4(0x1c0)}}}]);if(_0x1bf775[0x0]['language']=='English\x20(US)')var _0x25f9e2=users[_0x2d8ff4(0xe5)];else{if(_0x1bf775[0x0][_0x2d8ff4(0xfd)]=='Hindi')var _0x25f9e2=users['Hindi'];else{if(_0x1bf775[0x0]['language']==_0x2d8ff4(0x205))var _0x25f9e2=users[_0x2d8ff4(0x205)];else{if(_0x1bf775[0x0]['language']==_0x2d8ff4(0x169))var _0x25f9e2=users[_0x2d8ff4(0x169)];else{if(_0x1bf775[0x0][_0x2d8ff4(0xfd)]==_0x2d8ff4(0x136))var _0x25f9e2=users[_0x2d8ff4(0x136)];else{if(_0x1bf775[0x0][_0x2d8ff4(0xfd)]==_0x2d8ff4(0x10e))var _0x25f9e2=users['Portuguese'];else{if(_0x1bf775[0x0][_0x2d8ff4(0xfd)]==_0x2d8ff4(0xc0))var _0x25f9e2=users[_0x2d8ff4(0xc0)];else{if(_0x1bf775[0x0][_0x2d8ff4(0xfd)]==_0x2d8ff4(0x86))var _0x25f9e2=users[_0x2d8ff4(0x15c)];}}}}}}}_0x2dac6c[_0x2d8ff4(0x84)](_0x2d8ff4(0x161),{'success':_0x44a439[_0x2d8ff4(0x124)]('success'),'errors':_0x44a439[_0x2d8ff4(0x124)]('errors'),'alldata':_0x1ae5e0,'profile':_0x5e688b,'master_shop':_0x1bf775,'role':_0x4add41,'product_stock':_0x210202,'language':_0x25f9e2,'staff_arr':_0x33b8ee});}catch(_0x13cb74){}});function formatNumber(_0x4f113a,_0x4463db='en-US',_0x1afea6={'minimumFractionDigits':0x2}){const _0x34f09f=a0_0x209eb3,_0x4ce2b4=new Intl['NumberFormat'](_0x4463db,_0x1afea6);return _0x4ce2b4[_0x34f09f(0x129)](_0x4f113a);}async function agentsdataDSICheck(_0xb8a98,_0x2763b4,_0x350de5,_0x3a9965){const _0x59276b=a0_0x209eb3,_0x1570a6=await product['aggregate']([{'$group':{'_id':{'brand':_0x59276b(0x80),'category':'$category'},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x153987=[];_0x153987['cat_brand']=[];for(let _0x1a80f8=0x0;_0x1a80f8<=_0x1570a6[_0x59276b(0x102)]-0x1;_0x1a80f8++){const _0x10b76c=_0x1570a6[_0x1a80f8];_0x153987[_0x59276b(0x189)]['push'](_0x10b76c);}const _0x43360c=await product[_0x59276b(0x147)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x59276b(0x80),'product_code':'$product_code','product_name':_0x59276b(0x99)}}}},{'$sort':{'_id.category':-0x1}}]),_0x102e85=await product[_0x59276b(0x147)]([{'$group':{'_id':{'category':'$category','brand':_0x59276b(0x80)}}},{'$group':{'_id':_0x59276b(0xca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3c2282=await sales_sa[_0x59276b(0x147)]([{'$match':{'date':{'$gte':_0xb8a98,'$lte':_0x2763b4},'sales_staff_id':_0x350de5,'sale_product.isFG':_0x59276b(0x1d9)}},{'$unwind':_0x59276b(0x1cc)},{'$match':{'sale_product.isFG':_0x59276b(0x1d9)}},{'$lookup':{'from':_0x59276b(0x143),'localField':_0x59276b(0x10f),'foreignField':_0x59276b(0x160),'as':_0x59276b(0xf8)}},{'$unwind':_0x59276b(0xda)},{'$group':{'_id':{'dsi':_0x59276b(0x184),'date':_0x59276b(0x1cd),'customer':_0x59276b(0x93)},'totalQty':{'$sum':_0x59276b(0x1ca)},'products':{'$push':{'qty':_0x59276b(0x1ca),'NetPrice':_0x59276b(0x1bd),'discount':_0x59276b(0x121),'adj_discount':_0x59276b(0x1bc),'product_details':{'prod_name':_0x59276b(0xbe),'product_code':_0x59276b(0x1b6),'category':_0x59276b(0x1f5),'brand':_0x59276b(0x18d),'gross_price':_0x59276b(0x18b)}}}}},{'$unwind':_0x59276b(0x176)},{'$group':{'_id':{'dsi':_0x59276b(0x101),'date':_0x59276b(0x141),'customer':'$_id.customer','category':_0x59276b(0x1c3),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x59276b(0xb2)},'totalGross':{'$sum':{'$multiply':[_0x59276b(0xb2),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x59276b(0x1df)},'discount':{'$sum':_0x59276b(0xee)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x59276b(0x8b)}}},{'$group':{'_id':{'dsi':_0x59276b(0x101),'date':_0x59276b(0x141),'customer':_0x59276b(0x1c9)},'totalQty':{'$sum':_0x59276b(0x1ad)},'totalGross':{'$sum':_0x59276b(0x13e)},'NetPrice':{'$sum':_0x59276b(0xd6)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x59276b(0xc8)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':'$_id.brand','product_details':_0x59276b(0xb3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x28630d=[],_0x622ba6={},_0x5e79cd={},_0x406c2d={};var _0x2dd3e8=0x0,_0x3c0c01=0x0,_0x24c3a4=0x0,_0x4963aa=0x0,_0x536d9e=0x0;const _0xe68d09=0x6;for(let _0xad522a=0x0;_0xad522a<=_0x3c2282[_0x59276b(0x102)]-0x1;_0xad522a++){const _0x476c0b=_0x3c2282[_0xad522a];let _0x1cf2f4=_0x59276b(0x130);_0x1cf2f4+=_0x59276b(0x1f4)+_0x476c0b[_0x59276b(0x152)]['dsi']+_0x59276b(0xf3),_0x1cf2f4+=_0x59276b(0x1f4)+_0x476c0b[_0x59276b(0x152)][_0x59276b(0x177)]+_0x59276b(0xf3),_0x1cf2f4+=_0x59276b(0x1f4)+_0x476c0b['_id'][_0x59276b(0x1ac)]+'</td>';let _0x48a906={};var _0x1f2386=0x0;for(let _0x5c91aa=0x0;_0x5c91aa<=_0x476c0b[_0x59276b(0x143)][_0x59276b(0x102)]-0x1;_0x5c91aa++){const _0x44f334=_0x476c0b[_0x59276b(0x143)][_0x5c91aa];_0x48a906[_0x44f334['brand']+'-'+_0x44f334[_0x59276b(0x1aa)]]=_0x44f334[_0x59276b(0xa3)];const _0x1e2fd8=_0x44f334[_0x59276b(0xcb)]+'-'+_0x44f334[_0x59276b(0x1aa)];!_0x622ba6[_0x1e2fd8]&&(_0x622ba6[_0x1e2fd8]=0x0),!Array['isArray'](_0x406c2d[_0x1e2fd8])&&(_0x406c2d[_0x1e2fd8]=[]),!Array[_0x59276b(0xe0)](_0x406c2d[_0x1e2fd8])&&(_0x406c2d[_0x1e2fd8]=[]),_0x622ba6[_0x1e2fd8]+=_0x44f334['qty'],_0x406c2d[_0x1e2fd8][_0x59276b(0xff)](_0x44f334[_0x59276b(0xa3)]),_0x1f2386++;}console['log'](_0x476c0b);for(let _0x279528=0x0;_0x279528<=_0x153987[_0x59276b(0x189)][_0x59276b(0x102)]-0x1;_0x279528++){const _0x32f88d=_0x153987['cat_brand'][_0x279528],_0x1b7cf3=_0x32f88d[_0x59276b(0x152)][_0x59276b(0xcb)]+'-'+_0x32f88d[_0x59276b(0x152)]['category'];_0x1cf2f4+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x48a906[_0x1b7cf3]!==undefined?_0x48a906[_0x1b7cf3]['toFixed'](0x2):'')+_0x59276b(0xf3);}_0x24c3a4=_0x476c0b[_0x59276b(0xc4)]+_0x476c0b[_0x59276b(0x138)],_0x1cf2f4+=_0x59276b(0x1f0)+formatNumber(parseFloat(_0x476c0b[_0x59276b(0x116)],0x2)[_0x59276b(0x188)](0x2))+_0x59276b(0xf3),_0x1cf2f4+=_0x59276b(0x1f0)+formatNumber(_0x476c0b[_0x59276b(0x1af)][_0x59276b(0x188)](0x2))+_0x59276b(0xf3),_0x1cf2f4+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x24c3a4)+_0x59276b(0xf3),_0x1cf2f4+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x476c0b['NetPrice'][_0x59276b(0x188)](0x2))+'</td>',_0x1cf2f4+=_0x59276b(0x1f8),_0x2dd3e8+=parseFloat(_0x476c0b[_0x59276b(0x116)][_0x59276b(0x188)](0x2)),_0x3c0c01+=parseFloat(_0x476c0b[_0x59276b(0x13a)]['toFixed'](0x2)),_0x4963aa+=_0x24c3a4,_0x536d9e+=parseFloat(_0x476c0b[_0x59276b(0x1af)][_0x59276b(0x188)](0x2));if(_0xad522a==_0x3c2282[_0x59276b(0x102)]-0x1){_0x1cf2f4+=_0x59276b(0x130),_0x1cf2f4+=_0x59276b(0xa2),_0x1cf2f4+=_0x59276b(0xf3);for(let _0x2f3e97=0x0;_0x2f3e97<=_0x153987[_0x59276b(0x189)][_0x59276b(0x102)]-0x1;_0x2f3e97++){const _0x50478d=_0x153987['cat_brand'][_0x2f3e97],_0x3e3fee=_0x50478d[_0x59276b(0x152)][_0x59276b(0xcb)]+'-'+_0x50478d[_0x59276b(0x152)][_0x59276b(0x1aa)],_0x189175=_0x406c2d[_0x3e3fee][_0x59276b(0x1d7)]((_0x1cffb4,_0x493616)=>_0x1cffb4+_0x493616,0x0);_0x1cf2f4+=_0x59276b(0x195)+(_0x189175!==undefined?formatNumber(_0x189175[_0x59276b(0x188)](0x2)):'')+'</b></td>',console[_0x59276b(0x200)](_0x406c2d[_0x3e3fee]['reduce']((_0x255a88,_0x330d21)=>_0x255a88+_0x330d21,0x0));}_0x1cf2f4+=_0x59276b(0x1f9)+formatNumber(_0x2dd3e8[_0x59276b(0x188)](0x2))+_0x59276b(0x183),_0x1cf2f4+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x536d9e)+_0x59276b(0x183),_0x1cf2f4+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4963aa)+_0x59276b(0x183),_0x1cf2f4+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3c0c01)+_0x59276b(0x183),_0x1cf2f4+=_0x59276b(0x1f8);}_0x28630d['push'](_0x1cf2f4);}function _0x58c21f(_0x11d58e,_0x394d1a){const _0xd64809=_0x59276b,_0x380ee0=[];for(let _0x52edb6=0x0;_0x52edb6<=_0x11d58e[_0xd64809(0x102)]-0x1;_0x52edb6+=_0x394d1a){_0x380ee0[_0xd64809(0xff)](_0x11d58e[_0xd64809(0x1da)](_0x52edb6,_0x52edb6+_0x394d1a));}return _0x380ee0;}const _0x4e4599=_0x58c21f(_0x28630d,_0xe68d09);let _0x52ee1a='';return _0x4e4599[_0x59276b(0x115)]((_0x5a784c,_0x2ca4a0)=>{const _0xca3626=_0x59276b;_0x2ca4a0>0x0&&(_0x52ee1a+=_0xca3626(0xc7));_0x52ee1a+='<table>',_0x52ee1a+=_0xca3626(0x8f),_0x52ee1a+=_0xca3626(0x130),_0x52ee1a+=_0xca3626(0x172),_0x52ee1a+='</tr>',_0x52ee1a+=_0xca3626(0x130),_0x52ee1a+=_0xca3626(0xed);for(let _0x2c4e56=0x0;_0x2c4e56<=_0x43360c[_0xca3626(0x102)]-0x1;_0x2c4e56++){const _0x2bf74=_0x43360c[_0x2c4e56];for(let _0x7e2a0c=0x0;_0x7e2a0c<_0x102e85[_0xca3626(0x102)];_0x7e2a0c++){const _0x1a6f78=_0x102e85[_0x7e2a0c];_0x1a6f78[_0xca3626(0x152)]===_0x2bf74[_0xca3626(0x152)]['category']&&(_0x52ee1a+=_0xca3626(0x1a6)+_0x1a6f78[_0xca3626(0x1a4)]+_0xca3626(0x13b)+_0x2bf74[_0xca3626(0x152)][_0xca3626(0x1aa)]+_0xca3626(0xf3));}}_0x52ee1a+=_0xca3626(0x178),_0x52ee1a+=_0xca3626(0x1f8),_0x52ee1a+=_0xca3626(0x130),_0x52ee1a+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x52ee1a+=_0xca3626(0x17a),_0x52ee1a+=_0xca3626(0x197);for(let _0x6801f9=0x0;_0x6801f9<=_0x43360c[_0xca3626(0x102)]-0x1;_0x6801f9++){const _0x388a37=_0x43360c[_0x6801f9];for(let _0x14b4c8=0x0;_0x14b4c8<_0x153987['cat_brand'][_0xca3626(0x102)];_0x14b4c8++){const _0x238445=_0x153987[_0xca3626(0x189)][_0x14b4c8];_0x238445[_0xca3626(0x152)][_0xca3626(0x1aa)]===_0x388a37[_0xca3626(0x152)][_0xca3626(0x1aa)]&&(_0x52ee1a+=_0xca3626(0x16e)+_0x238445[_0xca3626(0x152)]['brand']+_0xca3626(0xf3));}}_0x52ee1a+=_0xca3626(0x11f),_0x52ee1a+=_0xca3626(0xea),_0x52ee1a+=_0xca3626(0x1a8),_0x52ee1a+=_0xca3626(0x96),_0x52ee1a+=_0xca3626(0x1f8),_0x52ee1a+='</thead>',_0x52ee1a+='<tbody>',_0x5a784c[_0xca3626(0x115)](_0x3e8018=>{_0x52ee1a+=_0x3e8018;}),console[_0xca3626(0x200)](_0x406c2d),_0x52ee1a+=_0xca3626(0xdd),_0x52ee1a+=_0xca3626(0xcf);}),_0x52ee1a;}async function agentsdataDSICheck_excel(_0x47dbd1,_0x4b11fe,_0x36e875,_0x443f03){const _0x228699=a0_0x209eb3,_0x1066f8=await product[_0x228699(0x147)]([{'$group':{'_id':{'brand':'$brand','category':_0x228699(0x16a)},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3d1d67=[];_0x3d1d67[_0x228699(0x189)]=[];for(let _0x377687=0x0;_0x377687<=_0x1066f8['length']-0x1;_0x377687++){const _0x1ab84d=_0x1066f8[_0x377687];_0x3d1d67['cat_brand'][_0x228699(0xff)](_0x1ab84d);}const _0xd71b2a=await product['aggregate']([{'$group':{'_id':{'category':_0x228699(0x16a)},'products':{'$push':{'brand':_0x228699(0x80),'product_code':_0x228699(0x8e),'product_name':_0x228699(0x99)}}}},{'$sort':{'_id.category':-0x1}}]),_0x39753d=await product[_0x228699(0x147)]([{'$group':{'_id':{'category':_0x228699(0x16a),'brand':_0x228699(0x80)}}},{'$group':{'_id':_0x228699(0xca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1e4646=await sales_sa[_0x228699(0x147)]([{'$match':{'date':{'$gte':_0x47dbd1,'$lte':_0x4b11fe},'sales_staff_id':_0x36e875,'sale_product.isFG':_0x228699(0x1d9)}},{'$unwind':_0x228699(0x1cc)},{'$match':{'sale_product.isFG':_0x228699(0x1d9)}},{'$lookup':{'from':_0x228699(0x143),'localField':_0x228699(0x10f),'foreignField':_0x228699(0x160),'as':_0x228699(0xf8)}},{'$unwind':_0x228699(0xda)},{'$group':{'_id':{'dsi':_0x228699(0x184),'date':_0x228699(0x1cd),'customer':'$customer'},'totalQty':{'$sum':_0x228699(0x1ca)},'products':{'$push':{'qty':_0x228699(0x1ca),'NetPrice':'$sale_product.totalprice','discount':_0x228699(0x121),'adj_discount':_0x228699(0x1bc),'product_details':{'prod_name':_0x228699(0xbe),'product_code':_0x228699(0x1b6),'category':_0x228699(0x1f5),'brand':_0x228699(0x18d),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x228699(0x176)},{'$group':{'_id':{'dsi':_0x228699(0x101),'date':_0x228699(0x141),'customer':_0x228699(0x1c9),'category':_0x228699(0x1c3),'brand':_0x228699(0x128)},'totalQty':{'$sum':_0x228699(0xb2)},'totalGross':{'$sum':{'$multiply':[_0x228699(0xb2),_0x228699(0x11b)]}},'NetPrice':{'$sum':_0x228699(0x1df)},'discount':{'$sum':_0x228699(0xee)},'adj_discount':{'$sum':_0x228699(0x203)},'product_details':{'$first':_0x228699(0x8b)}}},{'$group':{'_id':{'dsi':_0x228699(0x101),'date':'$_id.date','customer':_0x228699(0x1c9)},'totalQty':{'$sum':_0x228699(0x1ad)},'totalGross':{'$sum':_0x228699(0x13e)},'NetPrice':{'$sum':_0x228699(0xd6)},'discount':{'$sum':_0x228699(0x1e6)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':'$_id.brand','product_details':_0x228699(0xb3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4ddd09=[],_0x1cdb14={},_0x158ab0={},_0x22d83a={};var _0x162e07=0x0,_0x14b8a8=0x0,_0x2db710=0x0,_0x404ce9=0x0,_0x37cd58=0x0;const _0x523a86=0x9184e72a000;for(let _0x3b7720=0x0;_0x3b7720<=_0x1e4646[_0x228699(0x102)]-0x1;_0x3b7720++){const _0x35f193=_0x1e4646[_0x3b7720];let _0x22cd74='<tr>';_0x22cd74+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x35f193['_id'][_0x228699(0xb0)]+_0x228699(0xf3),_0x22cd74+=_0x228699(0x1f4)+_0x35f193['_id'][_0x228699(0x177)]+_0x228699(0xf3),_0x22cd74+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x35f193[_0x228699(0x152)]['customer']+_0x228699(0xf3);let _0x1bc97e={};var _0x262406=0x0;for(let _0x531cbe=0x0;_0x531cbe<=_0x35f193[_0x228699(0x143)][_0x228699(0x102)]-0x1;_0x531cbe++){const _0x567579=_0x35f193[_0x228699(0x143)][_0x531cbe];_0x1bc97e[_0x567579[_0x228699(0xcb)]+'-'+_0x567579[_0x228699(0x1aa)]]=_0x567579[_0x228699(0xa3)];const _0x4876dc=_0x567579['brand']+'-'+_0x567579[_0x228699(0x1aa)];!_0x1cdb14[_0x4876dc]&&(_0x1cdb14[_0x4876dc]=0x0),!Array[_0x228699(0xe0)](_0x22d83a[_0x4876dc])&&(_0x22d83a[_0x4876dc]=[]),!Array['isArray'](_0x22d83a[_0x4876dc])&&(_0x22d83a[_0x4876dc]=[]),_0x1cdb14[_0x4876dc]+=_0x567579[_0x228699(0xa3)],_0x22d83a[_0x4876dc][_0x228699(0xff)](_0x567579['qty']),_0x262406++;}console[_0x228699(0x200)](_0x35f193);for(let _0x340a5b=0x0;_0x340a5b<=_0x3d1d67['cat_brand'][_0x228699(0x102)]-0x1;_0x340a5b++){const _0x5dd9b1=_0x3d1d67['cat_brand'][_0x340a5b],_0x49eb73=_0x5dd9b1['_id'][_0x228699(0xcb)]+'-'+_0x5dd9b1[_0x228699(0x152)][_0x228699(0x1aa)];_0x22cd74+=_0x228699(0x9f)+(_0x1bc97e[_0x49eb73]!==undefined?_0x1bc97e[_0x49eb73][_0x228699(0x188)](0x2):'')+_0x228699(0xf3);}_0x2db710=_0x35f193['discount']+_0x35f193[_0x228699(0x138)],_0x22cd74+=_0x228699(0x1f0)+formatNumber(parseFloat(_0x35f193[_0x228699(0x116)],0x2)[_0x228699(0x188)](0x2))+_0x228699(0xf3),_0x22cd74+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x35f193['totalGross'][_0x228699(0x188)](0x2))+'</td>',_0x22cd74+=_0x228699(0x1f0)+formatNumber(_0x2db710)+_0x228699(0xf3),_0x22cd74+=_0x228699(0x1f0)+formatNumber(_0x35f193['NetPrice'][_0x228699(0x188)](0x2))+_0x228699(0xf3),_0x22cd74+=_0x228699(0x1f8),_0x162e07+=parseFloat(_0x35f193['totalQty']['toFixed'](0x2)),_0x14b8a8+=parseFloat(_0x35f193[_0x228699(0x13a)][_0x228699(0x188)](0x2)),_0x404ce9+=_0x2db710,_0x37cd58+=parseFloat(_0x35f193[_0x228699(0x1af)][_0x228699(0x188)](0x2));if(_0x3b7720==_0x1e4646[_0x228699(0x102)]-0x1){_0x22cd74+=_0x228699(0x130),_0x22cd74+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x22cd74+=_0x228699(0xf3);for(let _0xf395a2=0x0;_0xf395a2<=_0x3d1d67[_0x228699(0x189)][_0x228699(0x102)]-0x1;_0xf395a2++){const _0x2bff31=_0x3d1d67[_0x228699(0x189)][_0xf395a2],_0x2e6d6a=_0x2bff31[_0x228699(0x152)][_0x228699(0xcb)]+'-'+_0x2bff31[_0x228699(0x152)][_0x228699(0x1aa)],_0x378687=_0x22d83a[_0x2e6d6a][_0x228699(0x1d7)]((_0x1e7add,_0x373614)=>_0x1e7add+_0x373614,0x0);_0x22cd74+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x378687!==undefined?formatNumber(_0x378687[_0x228699(0x188)](0x2)):'')+_0x228699(0x183),console[_0x228699(0x200)](_0x22d83a[_0x2e6d6a]['reduce']((_0x49000d,_0x19d058)=>_0x49000d+_0x19d058,0x0));}_0x22cd74+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x162e07[_0x228699(0x188)](0x2))+_0x228699(0x183),_0x22cd74+=_0x228699(0x1f9)+formatNumber(_0x37cd58)+_0x228699(0x183),_0x22cd74+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x404ce9)+_0x228699(0x183),_0x22cd74+=_0x228699(0x1f9)+formatNumber(_0x14b8a8)+'</b></td>',_0x22cd74+=_0x228699(0x1f8);}_0x4ddd09[_0x228699(0xff)](_0x22cd74);}function _0x458935(_0x677462,_0x41070c){const _0x34eaa9=_0x228699,_0x461ca0=[];for(let _0x5eb91c=0x0;_0x5eb91c<=_0x677462[_0x34eaa9(0x102)]-0x1;_0x5eb91c+=_0x41070c){_0x461ca0[_0x34eaa9(0xff)](_0x677462[_0x34eaa9(0x1da)](_0x5eb91c,_0x5eb91c+_0x41070c));}return _0x461ca0;}const _0x18ff30=_0x458935(_0x4ddd09,_0x523a86);let _0x3273fc='';return _0x18ff30[_0x228699(0x115)]((_0x26b2b0,_0x5c1ee3)=>{const _0x112174=_0x228699;_0x5c1ee3>0x0&&(_0x3273fc+=_0x112174(0xc7));_0x3273fc+=_0x112174(0x14d),_0x3273fc+=_0x112174(0x8f),_0x3273fc+=_0x112174(0x130),_0x3273fc+=_0x112174(0x172),_0x3273fc+=_0x112174(0x1f8),_0x3273fc+='<tr>',_0x3273fc+=_0x112174(0xed);for(let _0x247a80=0x0;_0x247a80<=_0xd71b2a['length']-0x1;_0x247a80++){const _0x5d89a8=_0xd71b2a[_0x247a80];for(let _0x4f7b10=0x0;_0x4f7b10<_0x39753d['length'];_0x4f7b10++){const _0x5462f7=_0x39753d[_0x4f7b10];_0x5462f7['_id']===_0x5d89a8['_id'][_0x112174(0x1aa)]&&(_0x3273fc+=_0x112174(0x1a6)+_0x5462f7['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x5d89a8[_0x112174(0x152)]['category']+_0x112174(0xf3));}}_0x3273fc+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x3273fc+=_0x112174(0x1f8),_0x3273fc+=_0x112174(0x130),_0x3273fc+=_0x112174(0x1ae),_0x3273fc+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x3273fc+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x1c68f3=0x0;_0x1c68f3<=_0xd71b2a['length']-0x1;_0x1c68f3++){const _0x3b0f85=_0xd71b2a[_0x1c68f3];for(let _0x44b2e9=0x0;_0x44b2e9<_0x3d1d67[_0x112174(0x189)][_0x112174(0x102)];_0x44b2e9++){const _0x52eefd=_0x3d1d67[_0x112174(0x189)][_0x44b2e9];_0x52eefd['_id'][_0x112174(0x1aa)]===_0x3b0f85[_0x112174(0x152)][_0x112174(0x1aa)]&&(_0x3273fc+=_0x112174(0x16e)+_0x52eefd[_0x112174(0x152)][_0x112174(0xcb)]+_0x112174(0xf3));}}_0x3273fc+=_0x112174(0x11f),_0x3273fc+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x3273fc+=_0x112174(0x1a8),_0x3273fc+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x3273fc+='</tr>',_0x3273fc+=_0x112174(0x105),_0x3273fc+='<tbody>',_0x26b2b0['forEach'](_0x1e097e=>{_0x3273fc+=_0x1e097e;}),console[_0x112174(0x200)](_0x22d83a),_0x3273fc+=_0x112174(0xdd),_0x3273fc+='</table>';}),_0x3273fc;}router['post'](a0_0x209eb3(0x12f),auth,async(_0x372717,_0x4ecc58)=>{const _0x37129e=a0_0x209eb3,{from_date:_0x1d4e32,to_date:_0x424294,isExcel:_0x1746c1}=_0x372717['body'],_0x441503=_0x372717[_0x37129e(0x1d8)],_0x315835=await staff[_0x37129e(0x1ef)]({'email':_0x441503[_0x37129e(0x15f)]}),_0x233e5f=await master_shop[_0x37129e(0x1a9)]();console[_0x37129e(0x200)](_0x233e5f[0x0][_0x37129e(0x179)]);const _0x505a14=await agentsdataDSICheck(_0x1d4e32,_0x424294,_0x315835[_0x37129e(0x152)][_0x37129e(0x18f)](),_0x1746c1),_0x4a4adc=await agentsdataDSICheck_excel(_0x1d4e32,_0x424294,_0x315835['_id']['valueOf'](),_0x1746c1);let _0x474cab='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x440a7f=new Date(_0x1d4e32),_0x42c002=new Date(_0x424294);const _0x4c20ff={'year':'numeric','month':_0x37129e(0xaa),'day':'numeric'},_0x133b74=new Intl['DateTimeFormat'](_0x37129e(0x131),_0x4c20ff)[_0x37129e(0x129)](_0x440a7f),_0x7b9d63=new Intl['DateTimeFormat'](_0x37129e(0x131),_0x4c20ff)[_0x37129e(0x129)](_0x42c002);_0x474cab+=_0x37129e(0x1f6),_0x474cab+='<div\x20\x20id=\x22table-conatainer\x22>',_0x474cab+=_0x37129e(0x14d),_0x474cab+=_0x505a14,_0x474cab+='</table>',_0x474cab+=_0x37129e(0x155),_0x474cab+=_0x37129e(0x155);let _0x59adbc=_0x37129e(0xa6);_0x59adbc+=_0x37129e(0x1f6),_0x59adbc+=_0x37129e(0x186),_0x59adbc+=_0x37129e(0x14d),_0x59adbc+=_0x4a4adc,_0x59adbc+=_0x37129e(0xcf),_0x59adbc+=_0x37129e(0x155),_0x59adbc+=_0x37129e(0x155);let _0x47fbd3=_0x37129e(0xc1);const _0x39f1ed={'width':'15in','height':_0x37129e(0xfc),'orientation':'landscape','border':{'top':'0.1in','right':_0x37129e(0x1f7),'bottom':_0x37129e(0x1f7),'left':_0x37129e(0x1f7)},'header':{'height':_0x37129e(0x201),'contents':_0x37129e(0x10d)+_0x47fbd3+_0x37129e(0x167)+_0x133b74+_0x37129e(0x82)+_0x7b9d63+_0x37129e(0xa7)},'footer':{'height':_0x37129e(0x1d4),'contents':{'default':_0x37129e(0x1c7)}},'dpi':0x5,'zoomFactor':'1'};if(_0x1746c1=='on'){const _0x46a0cd=cheerio[_0x37129e(0x162)](_0x59adbc);let _0xefc199=[],_0x146cca=[],_0x12ad0a=[];const _0x3efa21=_0x374da2=>{const _0x3a712d=_0x37129e,_0x1f54f2={'top':{'style':_0x3a712d(0x1bb),'color':{'rgb':_0x3a712d(0x1fe)}},'bottom':{'style':_0x3a712d(0x1bb),'color':{'rgb':_0x3a712d(0x1fe)}},'left':{'style':'thick','color':{'rgb':_0x3a712d(0x1fe)}},'right':{'style':_0x3a712d(0x1bb),'color':{'rgb':'000000'}}};if(_0x374da2){const _0x586468=_0x374da2[_0x3a712d(0x18c)](';')[_0x3a712d(0x1d7)]((_0x5af84c,_0x1719ef)=>{const _0x12620c=_0x3a712d,[_0x59149f,_0x3c16de]=_0x1719ef[_0x12620c(0x18c)](':')['map'](_0x5375eb=>_0x5375eb[_0x12620c(0x146)]());return _0x5af84c[_0x59149f]=_0x3c16de,_0x5af84c;},{});_0x586468[_0x3a712d(0x7a)]&&(_0x1f54f2[_0x3a712d(0xa9)][_0x3a712d(0xe7)]=_0x586468['border-top'][_0x3a712d(0x15d)]('thin')?_0x3a712d(0xe8):_0x3a712d(0x1a0)),_0x586468['border-bottom']&&(_0x1f54f2['bottom']['style']=_0x586468['border-bottom'][_0x3a712d(0x15d)](_0x3a712d(0xe8))?_0x3a712d(0xe8):'medium'),_0x586468[_0x3a712d(0xfb)]&&(_0x1f54f2[_0x3a712d(0xf2)]['style']=_0x586468['border-left'][_0x3a712d(0x15d)](_0x3a712d(0xe8))?_0x3a712d(0xe8):_0x3a712d(0x1a0)),_0x586468['border-right']&&(_0x1f54f2[_0x3a712d(0x1cb)][_0x3a712d(0xe7)]=_0x586468['border-right'][_0x3a712d(0x15d)](_0x3a712d(0xe8))?_0x3a712d(0xe8):_0x3a712d(0x1a0));}return _0x1f54f2;};_0x46a0cd(_0x37129e(0x174))['each']((_0x194923,_0x28431b)=>{const _0x85249a=_0x37129e;let _0x2505c3=[],_0x66f7d9=0x0;while(_0x12ad0a[_0x66f7d9]){_0x12ad0a[_0x66f7d9]--,_0x66f7d9++;}_0x46a0cd(_0x28431b)[_0x85249a(0x1a9)](_0x85249a(0xfe))[_0x85249a(0x12a)]((_0x45ea07,_0x56e39d)=>{const _0x46f481=_0x85249a;let _0x46469d=_0x46a0cd(_0x56e39d)[_0x46f481(0x1cf)]()[_0x46f481(0x146)](),_0x26cb7e=parseFloat(_0x46469d[_0x46f481(0xbb)](/,/g,'')),_0x1632c8={};!isNaN(_0x26cb7e)?(_0x1632c8['v']=_0x26cb7e,_0x1632c8['t']='n'):(_0x1632c8['v']=_0x46469d,_0x1632c8['t']='s');const _0x2ce6d9=_0x46a0cd(_0x56e39d)['attr']('style'),_0x3b7e90=_0x3efa21(_0x2ce6d9);_0x1632c8['s']={'border':_0x3b7e90},_0x2505c3[_0x66f7d9]=_0x1632c8;let _0x350f2a=parseInt(_0x46a0cd(_0x56e39d)['attr'](_0x46f481(0xe1)))||0x1,_0x8afc85=parseInt(_0x46a0cd(_0x56e39d)['attr'](_0x46f481(0x16c)))||0x1;(_0x350f2a>0x1||_0x8afc85>0x1)&&_0x146cca[_0x46f481(0xff)]({'s':{'r':_0x194923,'c':_0x66f7d9},'e':{'r':_0x194923+_0x8afc85-0x1,'c':_0x66f7d9+_0x350f2a-0x1}});for(let _0x1cdc00=0x0;_0x1cdc00<_0x350f2a;_0x1cdc00++){_0x8afc85>0x1&&(_0x12ad0a[_0x66f7d9+_0x1cdc00]=_0x8afc85-0x1);}_0x66f7d9+=_0x350f2a;}),_0xefc199[_0x85249a(0xff)](_0x2505c3);});const _0x42da3d=XLSX[_0x37129e(0x1e0)][_0x37129e(0x98)](),_0x5b0866=XLSX[_0x37129e(0x1e0)][_0x37129e(0x12b)](_0xefc199);_0x146cca[_0x37129e(0x102)]>0x0&&(_0x5b0866[_0x37129e(0x159)]=_0x146cca);_0x5b0866[_0x37129e(0x1d1)]=_0xefc199[0x0][_0x37129e(0x140)](()=>({'wpx':0x64})),XLSX[_0x37129e(0x1e0)][_0x37129e(0x1b3)](_0x42da3d,_0x5b0866,'Sales\x20Report');const _0x4099cb=XLSX[_0x37129e(0xae)](_0x42da3d,{'bookType':_0x37129e(0x185),'type':_0x37129e(0x7f)});_0x4ecc58[_0x37129e(0x92)](_0x37129e(0x1c5),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x4ecc58[_0x37129e(0x92)](_0x37129e(0xd2),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x4ecc58[_0x37129e(0x8a)](_0x4099cb);}else pdf[_0x37129e(0xcd)](_0x474cab,_0x39f1ed)[_0x37129e(0x100)](function(_0x2df0b9,_0x250310){const _0x13aaa9=_0x37129e;if(_0x2df0b9){_0x4ecc58[_0x13aaa9(0x19b)](0x1f4)['send'](_0x13aaa9(0xb8));return;}_0x4ecc58[_0x13aaa9(0x92)](_0x13aaa9(0xd2),'application/pdf'),_0x250310['pipe'](_0x4ecc58);});}),router[a0_0x209eb3(0xbd)](a0_0x209eb3(0x13f),auth,async(_0x2082bb,_0x1dba0f)=>{const _0x53a57d=a0_0x209eb3;try{const {username:_0x10a707,email:_0x133a14,role:_0x4f1faa}=_0x2082bb[_0x53a57d(0x1d8)],_0x2f41e2=_0x2082bb[_0x53a57d(0x1d8)],_0x28d36b=await profile['findOne']({'email':_0x2f41e2[_0x53a57d(0x15f)]}),_0x1dad35={'year':'numeric','month':_0x53a57d(0xaa),'day':_0x53a57d(0x79)},_0x1e7cb9=await master_shop['find'](),_0x351202=await product[_0x53a57d(0x1a9)](),_0x4b215e=await warehouse[_0x53a57d(0x147)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x53a57d(0x143),'localField':_0x53a57d(0x1ab),'foreignField':_0x53a57d(0x202),'as':_0x53a57d(0x103)}},{'$unwind':_0x53a57d(0x17f)},{'$project':{'product_name':_0x53a57d(0x9e),'product_stock':_0x53a57d(0xe6)}},{'$group':{'_id':_0x53a57d(0xd7),'product_stock':{'$sum':'$product_stock'}}}]),_0x103517=await staff[_0x53a57d(0x1ef)]({'email':_0x2f41e2[_0x53a57d(0x15f)]});if(_0x1e7cb9[0x0][_0x53a57d(0xfd)]=='English\x20(US)')var _0x17cca8=users[_0x53a57d(0xe5)];else{if(_0x1e7cb9[0x0][_0x53a57d(0xfd)]==_0x53a57d(0x81))var _0x17cca8=users[_0x53a57d(0x81)];else{if(_0x1e7cb9[0x0][_0x53a57d(0xfd)]==_0x53a57d(0x205))var _0x17cca8=users['German'];else{if(_0x1e7cb9[0x0][_0x53a57d(0xfd)]==_0x53a57d(0x169))var _0x17cca8=users[_0x53a57d(0x169)];else{if(_0x1e7cb9[0x0][_0x53a57d(0xfd)]==_0x53a57d(0x136))var _0x17cca8=users[_0x53a57d(0x136)];else{if(_0x1e7cb9[0x0]['language']==_0x53a57d(0x10e))var _0x17cca8=users[_0x53a57d(0x1b0)];else{if(_0x1e7cb9[0x0][_0x53a57d(0xfd)]=='Chinese')var _0x17cca8=users['Chinese'];else{if(_0x1e7cb9[0x0]['language']==_0x53a57d(0x86))var _0x17cca8=users[_0x53a57d(0x15c)];}}}}}}}_0x1dba0f[_0x53a57d(0x84)]('sales_reports',{'success':_0x2082bb['flash'](_0x53a57d(0x18e)),'errors':_0x2082bb[_0x53a57d(0x124)]('errors'),'alldata':_0x351202,'profile':_0x28d36b,'master_shop':_0x1e7cb9,'role':_0x2f41e2,'product_stock':_0x4b215e,'language':_0x17cca8,'staff_arr':_0x103517});}catch(_0x62b9dc){}});async function dataSalesReports(_0x40458b,_0x2cf578,_0x466671){const _0x534964=a0_0x209eb3;let _0x252549='';const _0x1e184b=await sales_sa[_0x534964(0x147)]([{'$match':{'date':{'$gte':_0x40458b,'$lte':_0x2cf578},'sales_staff_id':_0x466671}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x534964(0x1d9)}},{'$group':{'_id':{'product_name':_0x534964(0x1e5),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':_0x534964(0x1bd)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x1ef7b5=0x0,_0x5c818e=0x0;for(let _0x24e125=0x0;_0x24e125<=_0x1e184b[_0x534964(0x102)]-0x1;_0x24e125++){const _0xff1920=_0x1e184b[_0x24e125];var _0x3c1e77=_0xff1920[_0x534964(0x1c4)][_0x534964(0x1eb)](undefined),_0x1fb516=_0xff1920['sumqty'][_0x534964(0x1eb)](undefined);_0x252549+=_0x534964(0x130),_0x252549+=_0x534964(0x106)+_0xff1920[_0x534964(0x152)][_0x534964(0x160)]+'</td>',_0x252549+='<td\x20class=\x22row_data\x22>'+_0xff1920['_id']['product_name']+'</td>',_0x252549+=_0x534964(0x106)+formatNumber(_0xff1920['sumqty'][_0x534964(0x188)](0x2))+_0x534964(0xf3),_0x252549+=_0x534964(0x106)+formatNumber(_0xff1920['totalPrice'][_0x534964(0x188)](0x2))+'</td>',_0x252549+='</tr>',_0x1ef7b5+=parseFloat(_0xff1920[_0x534964(0x126)]),_0x5c818e+=parseFloat(_0xff1920[_0x534964(0x1c4)]);}var _0x37359=_0x5c818e[_0x534964(0x1eb)](undefined),_0x56e623=_0x1ef7b5[_0x534964(0x1eb)](undefined);return _0x252549+=_0x534964(0x130),_0x252549+=_0x534964(0x204),_0x252549+=_0x534964(0xf9)+formatNumber(_0x1ef7b5[_0x534964(0x188)](0x2))+_0x534964(0x183),_0x252549+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x5c818e[_0x534964(0x188)](0x2))+_0x534964(0x183),_0x252549+=_0x534964(0x1f8),_0x252549;}router[a0_0x209eb3(0x85)](a0_0x209eb3(0xc2),auth,async(_0x202769,_0x395a7b)=>{const _0x3a0b81=a0_0x209eb3;try{const {from_date:_0x14e069,to_date:_0x24ea24,isExcel:_0x574a7b}=_0x202769[_0x3a0b81(0xad)],_0x5267f8=_0x202769[_0x3a0b81(0x1d8)],_0x24a186=await staff['findOne']({'email':_0x5267f8['email']});let _0x1f2d49=_0x3a0b81(0x1dc);var _0x187611=new Date(_0x14e069),_0x351886=new Date(_0x24ea24);const _0x55a287={'year':_0x3a0b81(0x79),'month':_0x3a0b81(0xaa),'day':_0x3a0b81(0x79)},_0x3e1efe=new Intl[(_0x3a0b81(0x1c6))](_0x3a0b81(0x131),_0x55a287)[_0x3a0b81(0x129)](_0x187611),_0x321075=new Intl[(_0x3a0b81(0x1c6))](_0x3a0b81(0x131),_0x55a287)[_0x3a0b81(0x129)](_0x351886);var _0x51cb45=await dataSalesReports(_0x14e069,_0x24ea24,_0x24a186['_id']['valueOf']());_0x1f2d49+='<div\x20class=\x22row\x22>',_0x1f2d49+='<div\x20class=\x22col-sm-11\x22>',_0x1f2d49+=_0x3a0b81(0x14d),_0x1f2d49+=_0x3a0b81(0x130),_0x1f2d49+=_0x3a0b81(0x1e3),_0x1f2d49+=_0x3a0b81(0x1c2),_0x1f2d49+='<th>\x20QTY\x20SOLD\x20</th>',_0x1f2d49+=_0x3a0b81(0x10b),_0x1f2d49+='<tr>',_0x1f2d49+=_0x51cb45,_0x1f2d49+=_0x3a0b81(0x1f8),_0x1f2d49+=_0x3a0b81(0x155),_0x1f2d49+=_0x3a0b81(0x155);let _0x32dcb5=_0x3a0b81(0xc1);const _0x1049e9={'width':_0x3a0b81(0x7c),'height':_0x3a0b81(0xfc),'orientation':_0x3a0b81(0x1fc),'border':{'top':'0.1in','right':_0x3a0b81(0x1f7),'bottom':_0x3a0b81(0x1f7),'left':_0x3a0b81(0x1f7)},'header':{'height':_0x3a0b81(0x201),'contents':_0x3a0b81(0x10d)+_0x32dcb5+_0x3a0b81(0xf4)+_0x24a186[_0x3a0b81(0x202)]+_0x3a0b81(0x15b)+_0x3e1efe+_0x3a0b81(0x82)+_0x321075+_0x3a0b81(0xa7)},'footer':{'height':_0x3a0b81(0x1d4),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x574a7b=='on'){const _0x230b1e=cheerio[_0x3a0b81(0x162)](_0x1f2d49);let _0x1d8bb3=[],_0x4ced40=[],_0x4d2bc2=[];const _0xefed17=_0x5d5af=>{const _0x162658=_0x3a0b81,_0x209175={'top':{'style':_0x162658(0x1bb),'color':{'rgb':_0x162658(0x1fe)}},'bottom':{'style':_0x162658(0x1bb),'color':{'rgb':_0x162658(0x1fe)}},'left':{'style':_0x162658(0x1bb),'color':{'rgb':_0x162658(0x1fe)}},'right':{'style':_0x162658(0x1bb),'color':{'rgb':_0x162658(0x1fe)}}};if(_0x5d5af){const _0x173802=_0x5d5af[_0x162658(0x18c)](';')['reduce']((_0x176bae,_0x4ca5b8)=>{const _0x4531b0=_0x162658,[_0x476201,_0x3a0538]=_0x4ca5b8[_0x4531b0(0x18c)](':')[_0x4531b0(0x140)](_0x42b981=>_0x42b981[_0x4531b0(0x146)]());return _0x176bae[_0x476201]=_0x3a0538,_0x176bae;},{});_0x173802[_0x162658(0x7a)]&&(_0x209175[_0x162658(0xa9)][_0x162658(0xe7)]=_0x173802['border-top'][_0x162658(0x15d)](_0x162658(0xe8))?_0x162658(0xe8):_0x162658(0x1a0)),_0x173802[_0x162658(0x149)]&&(_0x209175['bottom'][_0x162658(0xe7)]=_0x173802[_0x162658(0x149)][_0x162658(0x15d)](_0x162658(0xe8))?'thin':_0x162658(0x1a0)),_0x173802[_0x162658(0xfb)]&&(_0x209175[_0x162658(0xf2)][_0x162658(0xe7)]=_0x173802[_0x162658(0xfb)][_0x162658(0x15d)](_0x162658(0xe8))?_0x162658(0xe8):_0x162658(0x1a0)),_0x173802['border-right']&&(_0x209175['right'][_0x162658(0xe7)]=_0x173802['border-right'][_0x162658(0x15d)](_0x162658(0xe8))?'thin':_0x162658(0x1a0));}return _0x209175;};_0x230b1e(_0x3a0b81(0x174))['each']((_0x243c03,_0x5429b8)=>{const _0x20aad6=_0x3a0b81;let _0x295899=[],_0xfd9936=0x0;while(_0x4d2bc2[_0xfd9936]){_0x4d2bc2[_0xfd9936]--,_0xfd9936++;}_0x230b1e(_0x5429b8)[_0x20aad6(0x1a9)](_0x20aad6(0xfe))[_0x20aad6(0x12a)]((_0x52c6d4,_0x31e6b4)=>{const _0x3dac09=_0x20aad6;let _0x545390=_0x230b1e(_0x31e6b4)[_0x3dac09(0x1cf)]()[_0x3dac09(0x146)](),_0x46cf59=parseFloat(_0x545390['replace'](/,/g,'')),_0x389e6c={};!isNaN(_0x46cf59)?(_0x389e6c['v']=_0x46cf59,_0x389e6c['t']='n'):(_0x389e6c['v']=_0x545390,_0x389e6c['t']='s');const _0x552c7a=_0x230b1e(_0x31e6b4)[_0x3dac09(0x168)](_0x3dac09(0xe7)),_0x50eef7=_0xefed17(_0x552c7a);_0x389e6c['s']={'border':_0x50eef7},_0x295899[_0xfd9936]=_0x389e6c;let _0x5bc4b4=parseInt(_0x230b1e(_0x31e6b4)[_0x3dac09(0x168)](_0x3dac09(0xe1)))||0x1,_0x3d705d=parseInt(_0x230b1e(_0x31e6b4)[_0x3dac09(0x168)]('rowspan'))||0x1;(_0x5bc4b4>0x1||_0x3d705d>0x1)&&_0x4ced40[_0x3dac09(0xff)]({'s':{'r':_0x243c03,'c':_0xfd9936},'e':{'r':_0x243c03+_0x3d705d-0x1,'c':_0xfd9936+_0x5bc4b4-0x1}});for(let _0x3588a6=0x0;_0x3588a6<_0x5bc4b4;_0x3588a6++){_0x3d705d>0x1&&(_0x4d2bc2[_0xfd9936+_0x3588a6]=_0x3d705d-0x1);}_0xfd9936+=_0x5bc4b4;}),_0x1d8bb3[_0x20aad6(0xff)](_0x295899);});const _0x37f0fd=XLSX[_0x3a0b81(0x1e0)][_0x3a0b81(0x98)](),_0x1b6d04=XLSX[_0x3a0b81(0x1e0)][_0x3a0b81(0x12b)](_0x1d8bb3);_0x4ced40[_0x3a0b81(0x102)]>0x0&&(_0x1b6d04['!merges']=_0x4ced40);_0x1b6d04['!cols']=_0x1d8bb3[0x0][_0x3a0b81(0x140)](()=>({'wpx':0x64})),XLSX['utils'][_0x3a0b81(0x1b3)](_0x37f0fd,_0x1b6d04,_0x3a0b81(0x19a));const _0x5def5b=XLSX[_0x3a0b81(0xae)](_0x37f0fd,{'bookType':'xlsx','type':'buffer'});_0x395a7b[_0x3a0b81(0x92)](_0x3a0b81(0x1c5),_0x3a0b81(0x171)),_0x395a7b[_0x3a0b81(0x92)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x395a7b[_0x3a0b81(0x8a)](_0x5def5b);}else pdf[_0x3a0b81(0xcd)](_0x1f2d49,_0x1049e9)[_0x3a0b81(0x100)](function(_0x5209f7,_0x3522a9){const _0x5e9ff9=_0x3a0b81;if(_0x5209f7){_0x395a7b[_0x5e9ff9(0x19b)](0x1f4)[_0x5e9ff9(0x8a)](_0x5e9ff9(0xb8));return;}_0x395a7b[_0x5e9ff9(0x92)]('Content-Type',_0x5e9ff9(0x1a5)),_0x3522a9[_0x5e9ff9(0x13d)](_0x395a7b);});}catch(_0x5a14dc){}}),router[a0_0x209eb3(0xbd)](a0_0x209eb3(0x198),auth,async(_0x2bb681,_0x164d4f)=>{const _0x24df31=a0_0x209eb3;try{const {username:_0x143a24,email:_0x752ca3,role:_0x294743}=_0x2bb681[_0x24df31(0x1d8)],_0x12f1bb=_0x2bb681['user'],_0x1aeeee=await profile[_0x24df31(0x1ef)]({'email':_0x12f1bb[_0x24df31(0x15f)]}),_0x3bee95={'year':_0x24df31(0x79),'month':_0x24df31(0xaa),'day':_0x24df31(0x79)},_0x2a99c1=await master_shop[_0x24df31(0x1a9)](),_0x682292=await product[_0x24df31(0x1a9)](),_0x3737ef=await warehouse[_0x24df31(0x147)]([{'$unwind':_0x24df31(0xb3)},{'$lookup':{'from':_0x24df31(0x143),'localField':_0x24df31(0x1ab),'foreignField':_0x24df31(0x202),'as':_0x24df31(0x103)}},{'$unwind':_0x24df31(0x17f)},{'$project':{'product_name':_0x24df31(0x9e),'product_stock':_0x24df31(0xe6)}},{'$group':{'_id':_0x24df31(0xd7),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x2a99c1[0x0][_0x24df31(0xfd)]==_0x24df31(0xe3))var _0x4335c0=users['English'];else{if(_0x2a99c1[0x0]['language']=='Hindi')var _0x4335c0=users[_0x24df31(0x81)];else{if(_0x2a99c1[0x0][_0x24df31(0xfd)]==_0x24df31(0x205))var _0x4335c0=users['German'];else{if(_0x2a99c1[0x0]['language']=='Spanish')var _0x4335c0=users['Spanish'];else{if(_0x2a99c1[0x0][_0x24df31(0xfd)]==_0x24df31(0x136))var _0x4335c0=users[_0x24df31(0x136)];else{if(_0x2a99c1[0x0]['language']==_0x24df31(0x10e))var _0x4335c0=users[_0x24df31(0x1b0)];else{if(_0x2a99c1[0x0][_0x24df31(0xfd)]=='Chinese')var _0x4335c0=users[_0x24df31(0xc0)];else{if(_0x2a99c1[0x0][_0x24df31(0xfd)]=='Arabic\x20(ae)')var _0x4335c0=users[_0x24df31(0x15c)];}}}}}}}_0x164d4f[_0x24df31(0x84)]('inventory_sum',{'success':_0x2bb681[_0x24df31(0x124)](_0x24df31(0x18e)),'errors':_0x2bb681[_0x24df31(0x124)](_0x24df31(0x1d2)),'alldata':_0x682292,'profile':_0x1aeeee,'master_shop':_0x2a99c1,'role':_0x12f1bb,'product_stock':_0x3737ef,'language':_0x4335c0});}catch(_0xebc489){}});async function dataInventoryReports(_0x46c2d3,_0x319c53,_0x571c1b){const _0xbe7fb9=a0_0x209eb3,_0x382c00=await sales_sa[_0xbe7fb9(0x147)]([{'$match':{'date':{'$gte':_0x46c2d3,'$lte':_0x319c53},'sales_staff_id':_0x571c1b}},{'$unwind':_0xbe7fb9(0x1cc)},{'$group':{'_id':{'product_name':_0xbe7fb9(0x1e5),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x500864=mongoose[_0xbe7fb9(0xf7)][_0xbe7fb9(0x7b)],_0x560549=await staff['aggregate']([{'$match':{'_id':_0x500864(_0x571c1b)}},{'$unwind':_0xbe7fb9(0xb5)},{'$match':{'product_list.isConfirm':_0xbe7fb9(0x104)}},{'$group':{'_id':{'product_name':_0xbe7fb9(0xa5),'product_code':'$product_list.product_code'},'sumqty':{'$sum':_0xbe7fb9(0x135)}}},{'$sort':{'_id.product_name':0x1}}]),_0x1a2bbb=await sales_inv_data[_0xbe7fb9(0x147)]([{'$match':{'date':{'$gte':_0x46c2d3,'$lte':_0x319c53},'sales_staff_id':_0x571c1b}},{'$unwind':_0xbe7fb9(0x1cc)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0xbe7fb9(0x1ff)},'totalQTYsum':{'$sum':_0xbe7fb9(0x1d3)}}}]);console[_0xbe7fb9(0x200)](_0x1a2bbb);let _0x34c2e2='';var _0xd45d61=0x0;for(let _0x2b5c84=0x0;_0x2b5c84<=_0x560549[_0xbe7fb9(0x102)]-0x1;_0x2b5c84++){const _0x48a11b=_0x560549[_0x2b5c84];_0x34c2e2+=_0xbe7fb9(0x130),_0x34c2e2+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>'+_0x48a11b['_id'][_0xbe7fb9(0x160)]+_0xbe7fb9(0xf3),_0x34c2e2+=_0xbe7fb9(0x196)+_0x48a11b[_0xbe7fb9(0x152)][_0xbe7fb9(0x127)]+'</td>';var _0x186fca=_0x48a11b[_0xbe7fb9(0x126)],_0x4e293f=0x0;for(let _0x59ddfd=0x0;_0x59ddfd<=_0x382c00['length']-0x1;_0x59ddfd++){const _0x19c2fc=_0x382c00[_0x59ddfd];_0x48a11b[_0xbe7fb9(0x152)][_0xbe7fb9(0x160)]==_0x19c2fc[_0xbe7fb9(0x152)][_0xbe7fb9(0x160)]&&_0x48a11b[_0xbe7fb9(0x152)][_0xbe7fb9(0x127)]==_0x19c2fc[_0xbe7fb9(0x152)]['product_name']&&(_0x4e293f=_0x19c2fc[_0xbe7fb9(0x126)]);}var _0x2ee9ff=0x0;for(let _0x55d913=0x0;_0x55d913<=_0x1a2bbb['length']-0x1;_0x55d913++){const _0x34d428=_0x1a2bbb[_0x55d913];_0x48a11b[_0xbe7fb9(0x152)]['product_code']==_0x34d428[_0xbe7fb9(0x152)][_0xbe7fb9(0x160)]&&_0x48a11b[_0xbe7fb9(0x152)][_0xbe7fb9(0x127)]==_0x34d428[_0xbe7fb9(0x152)][_0xbe7fb9(0x127)]&&(_0x2ee9ff=_0x34d428[_0xbe7fb9(0xab)]);}_0xd45d61=_0x186fca-_0x2ee9ff+_0x4e293f,_0x34c2e2+=_0xbe7fb9(0x106)+_0xd45d61+'</td>';let _0x44cb17=![];for(let _0x256b3f=0x0;_0x256b3f<=_0x1a2bbb[_0xbe7fb9(0x102)]-0x1;_0x256b3f++){const _0x6dbf8e=_0x1a2bbb[_0x256b3f];if(_0x48a11b[_0xbe7fb9(0x152)]['product_code']==_0x6dbf8e[_0xbe7fb9(0x152)][_0xbe7fb9(0x160)]&&_0x48a11b[_0xbe7fb9(0x152)]['product_name']==_0x6dbf8e[_0xbe7fb9(0x152)][_0xbe7fb9(0x127)]){_0x34c2e2+='<td\x20class=\x22row_data\x22>'+_0x6dbf8e[_0xbe7fb9(0xab)]+_0xbe7fb9(0xf3),_0x44cb17=!![];break;}}!_0x44cb17&&(_0x34c2e2+=_0xbe7fb9(0x17d));let _0x5599f6=![];for(let _0x4b918b=0x0;_0x4b918b<=_0x382c00[_0xbe7fb9(0x102)]-0x1;_0x4b918b++){const _0x5d5d09=_0x382c00[_0x4b918b];if(_0x48a11b[_0xbe7fb9(0x152)][_0xbe7fb9(0x160)]==_0x5d5d09[_0xbe7fb9(0x152)][_0xbe7fb9(0x160)]&&_0x48a11b[_0xbe7fb9(0x152)][_0xbe7fb9(0x127)]==_0x5d5d09['_id'][_0xbe7fb9(0x127)]){_0x34c2e2+=_0xbe7fb9(0x106)+_0x5d5d09[_0xbe7fb9(0x126)]+'</td>',_0x5599f6=!![];break;}}!_0x5599f6&&(_0x34c2e2+=_0xbe7fb9(0x17d)),_0x34c2e2+='<td\x20class=\x22row_data\x22>'+_0x48a11b['sumqty']+_0xbe7fb9(0xf3),_0x34c2e2+=_0xbe7fb9(0x1f8);}return _0x34c2e2;}router[a0_0x209eb3(0x85)](a0_0x209eb3(0x94),auth,async(_0x2cb80e,_0x49e8e7)=>{const _0x577324=a0_0x209eb3;try{const {from_date:_0x451155,to_date:_0x36aee6}=_0x2cb80e[_0x577324(0xad)],_0x5cdb7a=_0x2cb80e['user'],_0x3eeeea=await staff[_0x577324(0x1ef)]({'email':_0x5cdb7a['email']});let _0x380094=_0x577324(0x1dc);var _0x1a9a8d=new Date(_0x451155),_0x3f818d=new Date(_0x36aee6);const _0xbf7c96={'year':'numeric','month':'long','day':_0x577324(0x79)},_0x9c0cfa=new Intl[(_0x577324(0x1c6))](_0x577324(0x131),_0xbf7c96)['format'](_0x1a9a8d),_0x151cd5=new Intl['DateTimeFormat'](_0x577324(0x131),_0xbf7c96)[_0x577324(0x129)](_0x3f818d);var _0x547bec=await dataInventoryReports(_0x451155,_0x36aee6,_0x3eeeea[_0x577324(0x152)][_0x577324(0x18f)]());_0x380094+=_0x577324(0xd0),_0x380094+=_0x577324(0x150),_0x380094+=_0x577324(0x137)+_0x9c0cfa+_0x577324(0x82)+_0x151cd5+_0x577324(0xdb),_0x380094+=_0x577324(0x1f6),_0x380094+=_0x577324(0xce),_0x380094+=_0x577324(0x14d),_0x380094+=_0x577324(0x130),_0x380094+=_0x577324(0x1e3),_0x380094+=_0x577324(0x1c2),_0x380094+=_0x577324(0x9a),_0x380094+=_0x577324(0x1ba),_0x380094+=_0x577324(0x193),_0x380094+=_0x577324(0x175),_0x380094+=_0x577324(0x130),_0x380094+=_0x547bec,_0x380094+=_0x577324(0x1f8),_0x380094+=_0x577324(0x155),_0x380094+='</div>';const _0x320808={'format':_0x577324(0xc9),'orientation':_0x577324(0x1fc)};pdf[_0x577324(0xcd)](_0x380094,_0x320808)[_0x577324(0x100)](function(_0x5caf91,_0x2651d2){const _0x134bda=_0x577324;if(_0x5caf91){_0x49e8e7[_0x134bda(0x19b)](0x1f4)[_0x134bda(0x8a)](_0x134bda(0xb8));return;}_0x49e8e7[_0x134bda(0x92)](_0x134bda(0xd2),_0x134bda(0x1a5)),_0x2651d2[_0x134bda(0x13d)](_0x49e8e7);});}catch(_0x2b7444){}}),router['get']('/dsrr/view',auth,async(_0xa96b74,_0x2103a0)=>{const _0x481630=a0_0x209eb3;try{const {username:_0x44405e,email:_0x38353f,role:_0x14b434}=_0xa96b74[_0x481630(0x1d8)],_0x351fab=_0xa96b74['user'],_0xbdbeb9=await profile['findOne']({'email':_0x351fab['email']}),_0x413ebf={'year':'numeric','month':'long','day':_0x481630(0x79)},_0x85ca8c=await master_shop['find']();console[_0x481630(0x200)](_0x481630(0xd8),_0x85ca8c);const _0x2c3843=await product[_0x481630(0x1a9)]();console['log']('Products\x20find_data',_0x2c3843);const _0x408a99=await warehouse[_0x481630(0x147)]([{'$unwind':_0x481630(0xb3)},{'$lookup':{'from':_0x481630(0x143),'localField':_0x481630(0x1ab),'foreignField':_0x481630(0x202),'as':_0x481630(0x103)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x481630(0xe6)}},{'$group':{'_id':_0x481630(0xd7),'product_stock':{'$sum':_0x481630(0x1c0)}}}]);console['log']('Products\x20warehouse_data',_0x408a99),_0x408a99[_0x481630(0x115)](_0x174b97=>{const _0x23e792=_0x481630,_0x2d5a35=_0x2c3843[_0x23e792(0x140)](_0x2eb2fc=>{const _0x34ed26=_0x23e792;_0x2eb2fc['name']==_0x174b97[_0x34ed26(0x152)]&&(_0x2eb2fc[_0x34ed26(0xe9)]=parseInt(_0x2eb2fc['stock'])+parseInt(_0x174b97[_0x34ed26(0x13c)]));});});const _0x48a8c3=await staff[_0x481630(0x1ef)]({'email':_0x351fab[_0x481630(0x15f)]});if(_0x85ca8c[0x0]['language']==_0x481630(0xe3))var _0x191dd3=users[_0x481630(0xe5)];else{if(_0x85ca8c[0x0]['language']==_0x481630(0x81))var _0x191dd3=users[_0x481630(0x81)];else{if(_0x85ca8c[0x0][_0x481630(0xfd)]==_0x481630(0x205))var _0x191dd3=users[_0x481630(0x205)];else{if(_0x85ca8c[0x0][_0x481630(0xfd)]==_0x481630(0x169))var _0x191dd3=users[_0x481630(0x169)];else{if(_0x85ca8c[0x0][_0x481630(0xfd)]=='French')var _0x191dd3=users[_0x481630(0x136)];else{if(_0x85ca8c[0x0]['language']=='Portuguese\x20(BR)')var _0x191dd3=users[_0x481630(0x1b0)];else{if(_0x85ca8c[0x0]['language']==_0x481630(0xc0))var _0x191dd3=users[_0x481630(0xc0)];else{if(_0x85ca8c[0x0]['language']==_0x481630(0x86))var _0x191dd3=users[_0x481630(0x15c)];}}}}}}}_0x2103a0[_0x481630(0x84)](_0x481630(0x1db),{'success':_0xa96b74[_0x481630(0x124)](_0x481630(0x18e)),'errors':_0xa96b74[_0x481630(0x124)]('errors'),'alldata':_0x2c3843,'profile':_0xbdbeb9,'master_shop':_0x85ca8c,'role':_0x351fab,'product_stock':_0x408a99,'language':_0x191dd3,'staff_arr':_0x48a8c3});}catch(_0x5f07cd){}});async function agentsdataDSICheck_DSRR(_0x5e51dc,_0x570b0d,_0x147915,_0x1e8431){const _0x1487fb=a0_0x209eb3;let _0x5cd864=new Date(_0x5e51dc);_0x5cd864['setDate'](_0x5cd864[_0x1487fb(0x119)]()-0x1);let _0x5520ef=_0x5cd864[_0x1487fb(0x166)]()['split']('T')[0x0];const _0x3fab2c=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':'$name','product_code':_0x1487fb(0x8e)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x59fd33=[];_0x59fd33[_0x1487fb(0x189)]=[];for(let _0x9dd815=0x0;_0x9dd815<=_0x3fab2c[_0x1487fb(0x102)]-0x1;_0x9dd815++){const _0x458641=_0x3fab2c[_0x9dd815];_0x59fd33[_0x1487fb(0x189)]['push'](_0x458641);}const _0x2df79d=await product[_0x1487fb(0x147)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x1487fb(0x8e),'product_name':_0x1487fb(0x99)}}}},{'$sort':{'_id.category':-0x1}}]),_0x47172c=await product['aggregate']([{'$group':{'_id':{'category':_0x1487fb(0x16a),'brand':'$brand'}}},{'$group':{'_id':_0x1487fb(0xca),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xdef03b=await sales_sa[_0x1487fb(0x147)]([{'$match':{'date':_0x5e51dc,'sales_staff_id':_0x570b0d,'sale_product.isFG':'false'}},{'$unwind':_0x1487fb(0x1cc)},{'$lookup':{'from':_0x1487fb(0x143),'localField':_0x1487fb(0x10f),'foreignField':_0x1487fb(0x160),'as':_0x1487fb(0xf8)}},{'$unwind':_0x1487fb(0xda)},{'$group':{'_id':{'dsi':_0x1487fb(0x184),'date':_0x1487fb(0x1cd),'customer':_0x1487fb(0x93),'status_data':_0x1487fb(0x17c)},'totalQty':{'$sum':_0x1487fb(0x1ca)},'cash':{'$first':_0x1487fb(0x1b2)},'amount':{'$first':_0x1487fb(0x170)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x1487fb(0x192)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x1487fb(0x1ca),'NetPrice':_0x1487fb(0x1bd),'discount':_0x1487fb(0x121),'adj_discount':_0x1487fb(0x1bc),'product_details':{'prod_name':_0x1487fb(0xbe),'product_code':_0x1487fb(0x1b6),'category':_0x1487fb(0x1f5),'brand':'$product_info.brand','gross_price':_0x1487fb(0x18b),'isFG':'$sale_product.isFG','prod_cat':_0x1487fb(0x1ee),'prod_id':_0x1487fb(0x1b9)}}}}},{'$unwind':_0x1487fb(0x176)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1487fb(0x141),'customer':_0x1487fb(0x1c9),'status_data':_0x1487fb(0x1d0),'category':_0x1487fb(0x1c3),'brand':_0x1487fb(0x128),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x1487fb(0xb2)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x1487fb(0x11b)]}},'NetPrice':{'$sum':_0x1487fb(0x1df)},'discount':{'$sum':_0x1487fb(0xee)},'adj_discount':{'$sum':_0x1487fb(0x203)},'cash':{'$first':_0x1487fb(0x1b2)},'amount':{'$first':_0x1487fb(0x170)},'bank':{'$first':_0x1487fb(0x164)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x1487fb(0x187)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x1487fb(0x101),'date':'$_id.date','customer':_0x1487fb(0x1c9),'status_data':_0x1487fb(0x1d0)},'totalQty':{'$sum':_0x1487fb(0x1ad)},'totalGross':{'$sum':_0x1487fb(0x13e)},'NetPrice':{'$sum':_0x1487fb(0xd6)},'discount':{'$sum':_0x1487fb(0x1e6)},'adj_discount':{'$sum':_0x1487fb(0xc8)},'cash':{'$first':_0x1487fb(0x1b2)},'amount':{'$first':_0x1487fb(0x170)},'bank':{'$first':_0x1487fb(0x164)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x1487fb(0x187)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x1487fb(0x7e),'product_details':_0x1487fb(0xb3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xb519a9=await sales_sa[_0x1487fb(0x147)]([{'$match':{'date':_0x5520ef,'sales_staff_id':_0x570b0d,'sale_product.isFG':_0x1487fb(0x1d9)}},{'$unwind':_0x1487fb(0x1cc)},{'$lookup':{'from':_0x1487fb(0x143),'localField':_0x1487fb(0x10f),'foreignField':'product_code','as':_0x1487fb(0xf8)}},{'$unwind':_0x1487fb(0xda)},{'$group':{'_id':{'dsi':_0x1487fb(0x184),'date':_0x1487fb(0x1cd),'customer':'$customer'},'totalQty':{'$sum':_0x1487fb(0x1ca)},'cash':{'$first':_0x1487fb(0x1b2)},'amount':{'$first':_0x1487fb(0x170)},'bank':{'$first':_0x1487fb(0x164)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x1487fb(0x187)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x1487fb(0x1bd),'discount':_0x1487fb(0x121),'adj_discount':_0x1487fb(0x1bc),'product_details':{'prod_name':_0x1487fb(0xbe),'product_code':_0x1487fb(0x1b6),'category':'$product_info.category','brand':'$product_info.brand','gross_price':_0x1487fb(0x18b),'isFG':_0x1487fb(0x1ec),'prod_cat':_0x1487fb(0x1ee),'prod_id':_0x1487fb(0x1b9)}}}}},{'$unwind':_0x1487fb(0x176)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x1487fb(0x141),'customer':_0x1487fb(0x1c9),'category':_0x1487fb(0x1c3),'brand':_0x1487fb(0x128),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x1487fb(0xb2)},'cash':{'$first':_0x1487fb(0x1b2)},'amount':{'$first':_0x1487fb(0x170)},'bank':{'$first':_0x1487fb(0x164)},'check_no':{'$first':_0x1487fb(0x192)},'due_date':{'$first':_0x1487fb(0x187)},'totalGross':{'$sum':{'$multiply':[_0x1487fb(0xb2),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x1487fb(0x1df)},'discount':{'$sum':_0x1487fb(0xee)},'adj_discount':{'$sum':_0x1487fb(0x203)},'product_details':{'$first':_0x1487fb(0x8b)}}},{'$group':{'_id':{'dsi':_0x1487fb(0x101),'date':_0x1487fb(0x141),'customer':'$_id.customer'},'totalQty':{'$sum':'$totalQty'},'cash':{'$first':_0x1487fb(0x1b2)},'amount':{'$first':_0x1487fb(0x170)},'bank':{'$first':_0x1487fb(0x164)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x1487fb(0x187)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x1487fb(0xc8)},'products':{'$push':{'qty':_0x1487fb(0x1ad),'category':'$_id.category','brand':'$_id.brand','product_details':_0x1487fb(0xb3)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xdbe00d=await sales_sa['aggregate']([{'$match':{'date':_0x5e51dc,'sales_staff_id':_0x570b0d,'status_data':_0x1487fb(0x104)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x415625=await staff['findById'](_0x570b0d);let _0x4a316c=[],_0x3b0eba={},_0x1f8823={};var _0x37a20a=0x0,_0x21579b=0x0,_0x23989a=0x0,_0x1cbad1=0x0,_0x1d8841=0x0;const _0x31a6ef=0x6;var _0x5169b3=0x0,_0x5f4d49=0x0;for(let _0x1ebe16=0x0;_0x1ebe16<=_0xdef03b[_0x1487fb(0x102)]-0x1;_0x1ebe16++){const _0x24a3e9=_0xdef03b[_0x1ebe16];let _0x3d3e3d='<tr>';_0x3d3e3d+=_0x1487fb(0x17e),_0x3d3e3d+=_0x1487fb(0x1f4)+_0x24a3e9[_0x1487fb(0x152)]['customer']+_0x1487fb(0xf3),_0x3d3e3d+=_0x1487fb(0x1f4)+_0x24a3e9[_0x1487fb(0x152)][_0x1487fb(0xb0)]+'</td>';let _0x45ca0e={},_0xfe9273={},_0x4daea3={};var _0x5f2c70={},_0xb389bb={},_0x7cdaba={},_0x32a097=0x0;for(let _0x572345=0x0;_0x572345<=_0x24a3e9[_0x1487fb(0x143)][_0x1487fb(0x102)]-0x1;_0x572345++){const _0x1622c7=_0x24a3e9[_0x1487fb(0x143)][_0x572345];_0x45ca0e[_0x1622c7['brand']+'-'+_0x1622c7['category']]=_0x1622c7[_0x1487fb(0xa3)],_0xfe9273[[_0x1622c7[_0x1487fb(0xcb)]+'-'+_0x1622c7['category']]]=_0x1622c7['product_details'][_0x1487fb(0x132)],_0x4daea3[[_0x1622c7[_0x1487fb(0xcb)]+'-'+_0x1622c7['category']]]=_0x1622c7['product_details'][_0x1487fb(0x1c1)];const _0xd0afd0=_0x1622c7['brand']+'-'+_0x1622c7[_0x1487fb(0x1aa)];!Array['isArray'](_0x1f8823[_0xd0afd0])&&(_0x1f8823[_0xd0afd0]=[]);!Array['isArray'](_0x1f8823[_0xd0afd0])&&(_0x1f8823[_0xd0afd0]=[]);_0x1f8823[_0xd0afd0]['push'](_0x1622c7[_0x1487fb(0xa3)]);if(_0x1622c7[_0x1487fb(0x87)][_0x1487fb(0x1c1)]=='P')_0x1622c7['product_details'][_0x1487fb(0x132)]==_0x1487fb(0x104)?(!_0x7cdaba[_0xd0afd0]&&(_0x7cdaba[_0xd0afd0]=0x0),_0x7cdaba[_0xd0afd0]=_0x1622c7[_0x1487fb(0xa3)]):(!_0x5f2c70[_0xd0afd0]&&(_0x5f2c70[_0xd0afd0]=0x0),_0x5f2c70[_0xd0afd0]=_0x1622c7[_0x1487fb(0xa3)]);else _0x1622c7[_0x1487fb(0x87)][_0x1487fb(0x1c1)]=='S'&&(_0x1622c7[_0x1487fb(0x87)][_0x1487fb(0x132)]==_0x1487fb(0x104)?(!_0x7cdaba[_0xd0afd0]&&(_0x7cdaba[_0xd0afd0]=0x0),_0x7cdaba[_0xd0afd0]=_0x1622c7[_0x1487fb(0xa3)]):(!_0xb389bb[_0xd0afd0]&&(_0xb389bb[_0xd0afd0]=0x0),_0xb389bb[_0xd0afd0]=_0x1622c7[_0x1487fb(0xa3)]));_0x32a097++;}for(let _0x23eeab=0x0;_0x23eeab<=_0x59fd33[_0x1487fb(0x189)]['length']-0x1;_0x23eeab++){const _0x4b6c8b=_0x59fd33['cat_brand'][_0x23eeab],_0x4bece1=_0x4b6c8b[_0x1487fb(0x152)][_0x1487fb(0xcb)]+'-'+_0x4b6c8b[_0x1487fb(0x152)][_0x1487fb(0x1aa)],_0x33a23d=_0x4daea3[_0x4bece1]!==undefined?_0x4daea3[_0x4bece1]:'NA';var _0x5b4cc0=_0x5f2c70[_0x4bece1]!==undefined?_0x5f2c70[_0x4bece1][_0x1487fb(0x188)](0x2):'',_0x17c92e=_0xb389bb[_0x4bece1]!==undefined?_0xb389bb[_0x4bece1]['toFixed'](0x2):'',_0x40f79f=_0x7cdaba[_0x4bece1]!==undefined?_0x7cdaba[_0x4bece1]['toFixed'](0x2):'';_0x3d3e3d+=_0x1487fb(0x9f)+_0x5b4cc0+_0x1487fb(0xf3),_0x3d3e3d+=_0x1487fb(0x9f)+_0x17c92e+_0x1487fb(0xf3),_0x3d3e3d+=_0x1487fb(0x9f)+_0x40f79f+_0x1487fb(0xf3);}var _0x4ba7dd=formatNumber(parseFloat(_0x24a3e9[_0x1487fb(0x9d)])),_0x53888a=formatNumber(parseFloat(_0x24a3e9[_0x1487fb(0xef)]));isNaN(_0x53888a)&&(_0x53888a=0x0),_0x3d3e3d+=_0x1487fb(0x9f)+_0x4ba7dd+_0x1487fb(0xf3),_0x3d3e3d+=_0x1487fb(0x9f)+_0x53888a+_0x1487fb(0xf3),_0x3d3e3d+=_0x1487fb(0x1f4)+_0x24a3e9[_0x1487fb(0x109)]+_0x1487fb(0xf3),_0x3d3e3d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x24a3e9[_0x1487fb(0x118)]+_0x1487fb(0xf3),_0x3d3e3d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x24a3e9[_0x1487fb(0x95)]+_0x1487fb(0xf3),_0x23989a=_0x24a3e9[_0x1487fb(0xc4)]+_0x24a3e9[_0x1487fb(0x138)],_0x5169b3+=parseFloat(_0x24a3e9['cash']),_0x5f4d49+=parseFloat(_0x53888a),_0x4a316c[_0x1487fb(0xff)](_0x3d3e3d);}function _0x1eaeea(_0x356561,_0x4b7440){const _0x43769e=_0x1487fb,_0x260eeb=[];for(let _0x3b9c2b=0x0;_0x3b9c2b<=_0x356561[_0x43769e(0x102)]-0x1;_0x3b9c2b+=_0x4b7440){_0x260eeb[_0x43769e(0xff)](_0x356561[_0x43769e(0x1da)](_0x3b9c2b,_0x3b9c2b+_0x4b7440));}return _0x260eeb;}const _0x908454=_0x1eaeea(_0x4a316c,_0x31a6ef);let _0x516b53='';return _0x908454[_0x1487fb(0x115)]((_0x44cfe8,_0x5d6696)=>{const _0x34986c=_0x1487fb;_0x5d6696>0x0&&(_0x516b53+=_0x34986c(0xc7));_0x516b53+='<table>',_0x516b53+=_0x34986c(0x8f);const _0x2e2de4=new Date(_0x5e51dc),_0x2c3916={'year':_0x34986c(0x79),'month':_0x34986c(0xaa),'day':_0x34986c(0x79),'timeZone':_0x34986c(0xbf)},_0x23eb00=_0x2e2de4['toLocaleDateString'](_0x34986c(0x131),_0x2c3916);_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0x83)+_0x1e8431+'</b></td>',_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0x120)+_0x415625[_0x34986c(0x202)]+_0x34986c(0xf3),_0x516b53+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>',_0x516b53+=_0x34986c(0x190),_0x516b53+=_0x34986c(0x1ea),_0x516b53+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x516b53+=_0x34986c(0x1f3),_0x516b53+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>',_0x516b53+=_0x34986c(0x151),_0x516b53+='<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>',_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0xd3),_0x516b53+=_0x34986c(0x117)+_0x23eb00+_0x34986c(0xf3),_0x516b53+=_0x34986c(0xb6),_0x516b53+=_0x34986c(0x144),_0x516b53+=_0x34986c(0x1be),_0x516b53+=_0x34986c(0x1be),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0x123),_0x516b53+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0x516b53+=_0x34986c(0x18a),_0x516b53+=_0x34986c(0x1be),_0x516b53+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x516b53+='</tr>',_0x516b53+=_0x34986c(0x130),_0x516b53+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0x158),_0x516b53+=_0x34986c(0x1a2),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0x11e),_0x516b53+=_0x34986c(0x122),_0x516b53+=_0x34986c(0xdf);for(let _0x549b7a=0x0;_0x549b7a<=_0x2df79d[_0x34986c(0x102)]-0x1;_0x549b7a++){const _0x5840ca=_0x2df79d[_0x549b7a];for(let _0x2cde6e=0x0;_0x2cde6e<_0x59fd33[_0x34986c(0x189)][_0x34986c(0x102)];_0x2cde6e++){const _0x3ae64e=_0x59fd33[_0x34986c(0x189)][_0x2cde6e];if(_0x3ae64e[_0x34986c(0x152)][_0x34986c(0x1aa)]===_0x5840ca[_0x34986c(0x152)][_0x34986c(0x1aa)]){var _0xa7f3ae='';switch(_0x5840ca[_0x34986c(0x152)][_0x34986c(0x1aa)]){case _0x34986c(0x114):_0xa7f3ae=_0x3ae64e[_0x34986c(0x152)][_0x34986c(0xcb)]+_0x34986c(0x11c);break;case _0x34986c(0x1e7):_0xa7f3ae=_0x3ae64e['_id'][_0x34986c(0xcb)]+_0x34986c(0x1c8);break;default:_0xa7f3ae=_0x3ae64e[_0x34986c(0x152)][_0x34986c(0xcb)];break;}_0x516b53+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>'+_0xa7f3ae+_0x34986c(0x183);}}}_0x516b53+=_0x34986c(0x1dd),_0x516b53+=_0x34986c(0xa1),_0x516b53+=_0x34986c(0x14b),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0xed);for(let _0x349002=0x0;_0x349002<=_0x59fd33[_0x34986c(0x189)]['length']-0x1;_0x349002++){const _0x2bd19c=_0x59fd33[_0x349002];_0x516b53+=_0x34986c(0xd4),_0x516b53+=_0x34986c(0x15e),_0x516b53+=_0x34986c(0xdc);}_0x516b53+=_0x34986c(0x19d),_0x516b53+=_0x34986c(0x11d),_0x516b53+=_0x34986c(0x9c),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x105),_0x516b53+=_0x34986c(0x163),_0x44cfe8[_0x34986c(0x115)](_0x4f7eb6=>{_0x516b53+=_0x4f7eb6;});let _0xe021c5={},_0xe5a560={},_0x44954c={};for(let _0x4b1b90=0x0;_0x4b1b90<=_0xdef03b['length']-0x1;_0x4b1b90++){const _0x39f708=_0xdef03b[_0x4b1b90];var _0x123d54=0x0;for(let _0x3d2630=0x0;_0x3d2630<=_0x39f708['products'][_0x34986c(0x102)]-0x1;_0x3d2630++){const _0x5b4347=_0x39f708[_0x34986c(0x143)][_0x3d2630],_0x349994=_0x5b4347[_0x34986c(0xcb)]+'-'+_0x5b4347['category'];if(_0x5b4347[_0x34986c(0x87)]['prod_cat']=='P')_0x5b4347['product_details'][_0x34986c(0x132)]==_0x34986c(0x104)?(!_0x44954c[_0x349994]&&(_0x44954c[_0x349994]=0x0),_0x44954c[_0x349994]+=_0x5b4347[_0x34986c(0xa3)]):(!_0xe021c5[_0x349994]&&(_0xe021c5[_0x349994]=0x0),_0xe021c5[_0x349994]+=_0x5b4347['qty']);else _0x5b4347['product_details'][_0x34986c(0x1c1)]=='S'&&(_0x5b4347[_0x34986c(0x87)][_0x34986c(0x132)]==_0x34986c(0x104)?(!_0x44954c[_0x349994]&&(_0x44954c[_0x349994]=0x0),_0x44954c[_0x349994]+=_0x5b4347[_0x34986c(0xa3)],console[_0x34986c(0x200)](_0x5b4347[_0x34986c(0xa3)])):(!_0xe5a560[_0x349994]&&(_0xe5a560[_0x349994]=0x0),_0xe5a560[_0x349994]+=_0x5b4347[_0x34986c(0xa3)]));_0x123d54++;}}let _0x1c553a={},_0x1be60c={},_0x1a8309={};var _0x496547=0x0,_0x30cc00=0x0;for(let _0x163176=0x0;_0x163176<=_0xb519a9[_0x34986c(0x102)]-0x1;_0x163176++){const _0x58198b=_0xb519a9[_0x163176];var _0x123d54=0x0;for(let _0x139d53=0x0;_0x139d53<=_0x58198b[_0x34986c(0x143)]['length']-0x1;_0x139d53++){const _0x6a8338=_0x58198b[_0x34986c(0x143)][_0x139d53],_0x120b1c=_0x6a8338[_0x34986c(0xcb)]+'-'+_0x6a8338[_0x34986c(0x1aa)];if(_0x6a8338['product_details'][_0x34986c(0x1c1)]=='P')_0x6a8338[_0x34986c(0x87)][_0x34986c(0x132)]=='true'?(!_0x1a8309[_0x120b1c]&&(_0x1a8309[_0x120b1c]=0x0),_0x1a8309[_0x120b1c]+=_0x6a8338['qty']):(!_0x1c553a[_0x120b1c]&&(_0x1c553a[_0x120b1c]=0x0),_0x1c553a[_0x120b1c]+=_0x6a8338[_0x34986c(0xa3)]);else _0x6a8338[_0x34986c(0x87)][_0x34986c(0x1c1)]=='S'&&(_0x6a8338[_0x34986c(0x87)][_0x34986c(0x132)]==_0x34986c(0x104)?(!_0x1a8309[_0x120b1c]&&(_0x1a8309[_0x120b1c]=0x0),_0x1a8309[_0x120b1c]+=_0x6a8338[_0x34986c(0xa3)]):(!_0x1be60c[_0x120b1c]&&(_0x1be60c[_0x120b1c]=0x0),_0x1be60c[_0x120b1c]+=_0x6a8338['qty']));_0x123d54++;}var _0x418047=parseFloat(_0x58198b['cash']),_0x3b230e=parseFloat(_0x58198b['amount']);isNaN(_0x3b230e)&&(_0x3b230e=0x0),_0x496547+=_0x418047,_0x30cc00+=_0x3b230e;}if(_0xdbe00d[_0x34986c(0x102)]>0x0)for(let _0x209c3f=0x0;_0x209c3f<=_0xdbe00d[_0x34986c(0x102)]-0x1;_0x209c3f++){const _0x15afbb=_0xdbe00d[_0x209c3f];console[_0x34986c(0x200)](_0x15afbb),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0xec)+(0x8+0x7*0x3)+_0x34986c(0x182)+_0x15afbb[_0x34986c(0x157)]+'</b></td>',_0x516b53+=_0x34986c(0x1f8);}_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0xaf),_0x516b53+=_0x34986c(0x181),_0x516b53+=_0x34986c(0x17e);for(let _0x580ff3=0x0;_0x580ff3<=_0x59fd33['cat_brand'][_0x34986c(0x102)]-0x1;_0x580ff3++){const _0x49f73e=_0x59fd33[_0x34986c(0x189)][_0x580ff3],_0x488cf5=_0x49f73e[_0x34986c(0x152)][_0x34986c(0xcb)]+'-'+_0x49f73e['_id']['category'];var _0x261e70=_0xe021c5[_0x488cf5]!==undefined?formatNumber(_0xe021c5[_0x488cf5]['toFixed'](0x2)):'',_0x3821a7=_0x44954c[_0x488cf5]!==undefined?formatNumber(_0x44954c[_0x488cf5]['toFixed'](0x2)):'',_0x6cb42f=_0xe5a560[_0x488cf5]!==undefined?formatNumber(_0xe5a560[_0x488cf5]['toFixed'](0x2)):'';_0x516b53+=_0x34986c(0x195)+_0x261e70+_0x34986c(0x183),_0x516b53+=_0x34986c(0x195)+_0x6cb42f+'</b></td>',_0x516b53+=_0x34986c(0x195)+_0x3821a7+_0x34986c(0x183);}_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5169b3)+'</b></td>',_0x516b53+=_0x34986c(0x195)+formatNumber(_0x5f4d49)+_0x34986c(0x183),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0xaf),_0x516b53+=_0x34986c(0x134),_0x516b53+=_0x34986c(0x17e);for(let _0x162f6a=0x0;_0x162f6a<=_0x59fd33[_0x34986c(0x189)][_0x34986c(0x102)]-0x1;_0x162f6a++){const _0x1a23e2=_0x59fd33[_0x34986c(0x189)][_0x162f6a],_0x1bf15e=_0x1a23e2[_0x34986c(0x152)][_0x34986c(0xcb)]+'-'+_0x1a23e2['_id'][_0x34986c(0x1aa)];var _0x261e70=_0x1c553a[_0x1bf15e]!==undefined?formatNumber(_0x1c553a[_0x1bf15e][_0x34986c(0x188)](0x2)):'',_0x3821a7=_0x1a8309[_0x1bf15e]!==undefined?formatNumber(_0x1a8309[_0x1bf15e][_0x34986c(0x188)](0x2)):'',_0x6cb42f=_0x1be60c[_0x1bf15e]!==undefined?formatNumber(_0x1be60c[_0x1bf15e]['toFixed'](0x2)):'';_0x516b53+=_0x34986c(0x195)+_0x261e70+_0x34986c(0x183),_0x516b53+=_0x34986c(0x195)+_0x6cb42f+_0x34986c(0x183),_0x516b53+=_0x34986c(0x195)+_0x3821a7+_0x34986c(0x183);}_0x516b53+=_0x34986c(0x195)+formatNumber(_0x496547)+_0x34986c(0x183),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x30cc00)+_0x34986c(0x183),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+='</tr>',_0x516b53+=_0x34986c(0x130),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';let _0x1b00c6=0x0,_0x50f4fc=0x0,_0x4ef475=0x0;for(let _0x189be6=0x0;_0x189be6<=_0x59fd33['cat_brand'][_0x34986c(0x102)]-0x1;_0x189be6++){const _0x3ba250=_0x59fd33[_0x34986c(0x189)][_0x189be6],_0x14701d=_0x3ba250[_0x34986c(0x152)]['brand']+'-'+_0x3ba250[_0x34986c(0x152)]['category'];var _0x44e491=_0xe021c5[_0x14701d]!==undefined?_0xe021c5[_0x14701d][_0x34986c(0x188)](0x2):'0',_0x57201e=_0x44954c[_0x14701d]!==undefined?_0x44954c[_0x14701d][_0x34986c(0x188)](0x2):'0',_0x27d442=_0xe5a560[_0x14701d]!==undefined?_0xe5a560[_0x14701d]['toFixed'](0x2):'0',_0x2d45ce=_0x1c553a[_0x14701d]!==undefined?_0x1c553a[_0x14701d][_0x34986c(0x188)](0x2):'0',_0x23da6f=_0x1a8309[_0x14701d]!==undefined?_0x1a8309[_0x14701d][_0x34986c(0x188)](0x2):'0',_0x562130=_0x1be60c[_0x14701d]!==undefined?_0x1be60c[_0x14701d]['toFixed'](0x2):'0';_0x1b00c6=parseFloat(_0x44e491)+parseFloat(_0x2d45ce),_0x50f4fc=parseFloat(_0x27d442)+parseFloat(_0x562130),_0x4ef475=parseFloat(_0x57201e)+parseFloat(_0x23da6f),_0x516b53+=_0x34986c(0x195)+formatNumber(_0x1b00c6[_0x34986c(0x188)](0x2))+'</b></td>',_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x50f4fc[_0x34986c(0x188)](0x2))+'</b></td>',_0x516b53+=_0x34986c(0x195)+formatNumber(_0x4ef475[_0x34986c(0x188)](0x2))+_0x34986c(0x183);}var _0x47ddde=formatNumber(_0x5169b3+_0x496547),_0x479d82=formatNumber(_0x5f4d49+_0x30cc00);_0x516b53+=_0x34986c(0x195)+_0x47ddde+'</b></td>',_0x516b53+=_0x34986c(0x195)+_0x479d82+_0x34986c(0x183),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x516b53+='</tr>',_0x516b53+=_0x34986c(0x130),_0x516b53+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x59fd33['cat_brand']['length']*0x3+0x9)+_0x34986c(0x113),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x516b53+=_0x34986c(0x17e);for(let _0x3171d1=0x0;_0x3171d1<=_0x59fd33[_0x34986c(0x189)]['length']-0x1;_0x3171d1++){const _0x86ed55=_0x59fd33['cat_brand'][_0x3171d1],_0x1e3eb0=_0x86ed55['_id']['brand']+'-'+_0x86ed55[_0x34986c(0x152)][_0x34986c(0x1aa)];var _0x44e491=_0xe021c5[_0x1e3eb0]!==undefined?_0xe021c5[_0x1e3eb0][_0x34986c(0x188)](0x2):'0',_0x57201e=_0x44954c[_0x1e3eb0]!==undefined?_0x44954c[_0x1e3eb0][_0x34986c(0x188)](0x2):'0',_0x27d442=_0xe5a560[_0x1e3eb0]!==undefined?_0xe5a560[_0x1e3eb0][_0x34986c(0x188)](0x2):'0',_0x2d45ce=_0x1c553a[_0x1e3eb0]!==undefined?_0x1c553a[_0x1e3eb0][_0x34986c(0x188)](0x2):'0',_0x23da6f=_0x1a8309[_0x1e3eb0]!==undefined?_0x1a8309[_0x1e3eb0][_0x34986c(0x188)](0x2):'0',_0x562130=_0x1be60c[_0x1e3eb0]!==undefined?_0x1be60c[_0x1e3eb0][_0x34986c(0x188)](0x2):'0';_0x1b00c6=parseFloat(_0x44e491)+parseFloat(_0x2d45ce),_0x50f4fc=parseFloat(_0x27d442)+parseFloat(_0x562130),_0x4ef475=parseFloat(_0x57201e)+parseFloat(_0x23da6f),_0x516b53+=_0x34986c(0x1a7),_0x516b53+=_0x34986c(0x1a7),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0xaf),_0x516b53+=_0x34986c(0x1f2),_0x516b53+=_0x34986c(0x17e);for(let _0x275c3c=0x0;_0x275c3c<=_0x59fd33[_0x34986c(0x189)][_0x34986c(0x102)]-0x1;_0x275c3c++){const _0x54fde6=_0x59fd33[_0x34986c(0x189)][_0x275c3c],_0x598f8e=_0x54fde6[_0x34986c(0x152)][_0x34986c(0xcb)]+'-'+_0x54fde6['_id'][_0x34986c(0x1aa)];var _0x44e491=_0xe021c5[_0x598f8e]!==undefined?_0xe021c5[_0x598f8e][_0x34986c(0x188)](0x2):'0',_0x57201e=_0x44954c[_0x598f8e]!==undefined?_0x44954c[_0x598f8e][_0x34986c(0x188)](0x2):'0',_0x27d442=_0xe5a560[_0x598f8e]!==undefined?_0xe5a560[_0x598f8e]['toFixed'](0x2):'0',_0x2d45ce=_0x1c553a[_0x598f8e]!==undefined?_0x1c553a[_0x598f8e][_0x34986c(0x188)](0x2):'0',_0x23da6f=_0x1a8309[_0x598f8e]!==undefined?_0x1a8309[_0x598f8e][_0x34986c(0x188)](0x2):'0',_0x562130=_0x1be60c[_0x598f8e]!==undefined?_0x1be60c[_0x598f8e]['toFixed'](0x2):'0';_0x1b00c6=parseFloat(_0x44e491)+parseFloat(_0x2d45ce),_0x50f4fc=parseFloat(_0x27d442)+parseFloat(_0x562130),_0x4ef475=parseFloat(_0x57201e)+parseFloat(_0x23da6f),_0x516b53+=_0x34986c(0x1a7),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x516b53+=_0x34986c(0x1a7);}_0x516b53+=_0x34986c(0x17e),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x516b53+=_0x34986c(0x206),_0x516b53+=_0x34986c(0x17e);for(let _0x2a55ae=0x0;_0x2a55ae<=_0x59fd33[_0x34986c(0x189)][_0x34986c(0x102)]-0x1;_0x2a55ae++){const _0x3243fa=_0x59fd33['cat_brand'][_0x2a55ae],_0x508767=_0x3243fa['_id'][_0x34986c(0xcb)]+'-'+_0x3243fa['_id']['category'];var _0x44e491=_0xe021c5[_0x508767]!==undefined?_0xe021c5[_0x508767][_0x34986c(0x188)](0x2):'0',_0x57201e=_0x44954c[_0x508767]!==undefined?_0x44954c[_0x508767][_0x34986c(0x188)](0x2):'0',_0x27d442=_0xe5a560[_0x508767]!==undefined?_0xe5a560[_0x508767]['toFixed'](0x2):'0',_0x2d45ce=_0x1c553a[_0x508767]!==undefined?_0x1c553a[_0x508767][_0x34986c(0x188)](0x2):'0',_0x23da6f=_0x1a8309[_0x508767]!==undefined?_0x1a8309[_0x508767]['toFixed'](0x2):'0',_0x562130=_0x1be60c[_0x508767]!==undefined?_0x1be60c[_0x508767]['toFixed'](0x2):'0';_0x1b00c6=parseFloat(_0x44e491)+parseFloat(_0x2d45ce),_0x50f4fc=parseFloat(_0x27d442)+parseFloat(_0x562130),_0x4ef475=parseFloat(_0x57201e)+parseFloat(_0x23da6f),_0x516b53+=_0x34986c(0x1a7),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x516b53+=_0x34986c(0x1a7);}_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+='</tr>',_0x516b53+='<tr>',_0x516b53+=_0x34986c(0xaf),_0x516b53+=_0x34986c(0x181),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x29b515=0x0;_0x29b515<=_0x59fd33['cat_brand']['length']-0x1;_0x29b515++){const _0x5e523c=_0x59fd33[_0x34986c(0x189)][_0x29b515],_0x5d9230=_0x5e523c[_0x34986c(0x152)][_0x34986c(0xcb)]+'-'+_0x5e523c['_id'][_0x34986c(0x1aa)];var _0x44e491=_0xe021c5[_0x5d9230]!==undefined?_0xe021c5[_0x5d9230][_0x34986c(0x188)](0x2):'',_0x57201e=_0x44954c[_0x5d9230]!==undefined?_0x44954c[_0x5d9230][_0x34986c(0x188)](0x2):'',_0x27d442=_0xe5a560[_0x5d9230]!==undefined?_0xe5a560[_0x5d9230][_0x34986c(0x188)](0x2):'',_0x2d45ce=_0x1c553a[_0x5d9230]!==undefined?_0x1c553a[_0x5d9230][_0x34986c(0x188)](0x2):'',_0x23da6f=_0x1a8309[_0x5d9230]!==undefined?_0x1a8309[_0x5d9230]['toFixed'](0x2):'',_0x562130=_0x1be60c[_0x5d9230]!==undefined?_0x1be60c[_0x5d9230][_0x34986c(0x188)](0x2):'';_0x1b00c6=formatNumber(parseFloat(_0x44e491)+parseFloat(_0x2d45ce)),_0x50f4fc=formatNumber(parseFloat(_0x27d442)+parseFloat(_0x562130)),_0x4ef475=formatNumber(parseFloat(_0x57201e)+parseFloat(_0x23da6f)),_0x516b53+=_0x34986c(0x195)+_0x44e491+_0x34986c(0x183),_0x516b53+=_0x34986c(0x195)+_0x27d442+_0x34986c(0x183),_0x516b53+=_0x34986c(0x195)+_0x57201e+_0x34986c(0x183);}_0x516b53+=_0x34986c(0x17e),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x1f8),_0x516b53+=_0x34986c(0x130),_0x516b53+=_0x34986c(0xaf),_0x516b53+=_0x34986c(0x19e),_0x516b53+=_0x34986c(0x17e);for(let _0x209e9a=0x0;_0x209e9a<=_0x59fd33['cat_brand'][_0x34986c(0x102)]-0x1;_0x209e9a++){const _0x9b0a0=_0x59fd33[_0x34986c(0x189)][_0x209e9a],_0x452059=_0x9b0a0[_0x34986c(0x152)][_0x34986c(0xcb)]+'-'+_0x9b0a0['_id'][_0x34986c(0x1aa)];var _0x44e491=_0xe021c5[_0x452059]!==undefined?_0xe021c5[_0x452059][_0x34986c(0x188)](0x2):'0',_0x57201e=_0x44954c[_0x452059]!==undefined?_0x44954c[_0x452059][_0x34986c(0x188)](0x2):'0',_0x27d442=_0xe5a560[_0x452059]!==undefined?_0xe5a560[_0x452059][_0x34986c(0x188)](0x2):'0',_0x2d45ce=_0x1c553a[_0x452059]!==undefined?_0x1c553a[_0x452059][_0x34986c(0x188)](0x2):'0',_0x23da6f=_0x1a8309[_0x452059]!==undefined?_0x1a8309[_0x452059][_0x34986c(0x188)](0x2):'0',_0x562130=_0x1be60c[_0x452059]!==undefined?_0x1be60c[_0x452059][_0x34986c(0x188)](0x2):'0';_0x1b00c6=parseFloat(_0x44e491)+parseFloat(_0x2d45ce),_0x50f4fc=parseFloat(_0x27d442)+parseFloat(_0x562130),_0x4ef475=parseFloat(_0x57201e)+parseFloat(_0x23da6f),_0x516b53+=_0x34986c(0x1a7),_0x516b53+=_0x34986c(0x1a7),_0x516b53+=_0x34986c(0x1a7);}_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x17e),_0x516b53+=_0x34986c(0x1f8),_0x516b53+='</tbody>',_0x516b53+=_0x34986c(0xcf);}),_0x516b53;}async function generateReferenceNumber(_0x2e8002,_0x4885c5,_0x423246){const _0x40838f=a0_0x209eb3,_0x2a84a4=new Date(_0x2e8002)[_0x40838f(0x8d)](),_0x40ac30=('0'+(new Date(_0x2e8002)[_0x40838f(0xba)]()+0x1))[_0x40838f(0x1da)](-0x2),_0x21308a=('0'+new Date(_0x2e8002)[_0x40838f(0x119)]())[_0x40838f(0x1da)](-0x2),_0x42d8e3=await staff[_0x40838f(0x1ef)]({'email':_0x423246[_0x40838f(0x15f)]}),_0x4d7c8e=_0x42d8e3['sales_man_code'],_0x5a375d=_0x4d7c8e+'-'+_0x2a84a4+_0x40ac30+_0x21308a,_0x3fef44=await Reference[_0x40838f(0x1ef)]({'referenceNumber':new RegExp('^'+_0x5a375d),'salesman_code':_0x4d7c8e})[_0x40838f(0x14e)]({'createdAt':-0x1}),_0x294f15=_0x5a375d;_0x3fef44&&(_0x294f15=_0x3fef44[_0x40838f(0xfa)]);console[_0x40838f(0x200)](_0x294f15);const _0x4e88d0=new Reference({'referenceNumber':_0x294f15,'staff_id':_0x4885c5,'salesman_code':_0x4d7c8e});return await _0x4e88d0['save'](),_0x294f15;}router[a0_0x209eb3(0x85)]('/dsrr/pdf',auth,async(_0x460c47,_0x5b9cc2)=>{const _0x3fe9c0=a0_0x209eb3,{from_date:_0x64fbbe}=_0x460c47[_0x3fe9c0(0xad)],_0x1fe582=_0x460c47[_0x3fe9c0(0x1d8)],_0x5bf667=await staff[_0x3fe9c0(0x1ef)]({'email':_0x1fe582[_0x3fe9c0(0x15f)]}),_0x489c34=await master_shop[_0x3fe9c0(0x1a9)](),_0x29bcbc='';var _0xf50096=new Date(_0x64fbbe);const _0x517599={'year':'numeric','month':_0x3fe9c0(0xaa),'day':_0x3fe9c0(0x79)},_0x4b5da4=new Intl[(_0x3fe9c0(0x1c6))](_0x3fe9c0(0x131),_0x517599)[_0x3fe9c0(0x129)](_0xf50096),_0x2fce4d=await Reference['find']({'staff_id':_0x5bf667[_0x3fe9c0(0x152)][_0x3fe9c0(0x18f)](),'date_include':_0x64fbbe});if(_0x2fce4d[_0x3fe9c0(0x102)]>0x0){let _0x5ef324='';_0x5ef324+=_0x2fce4d[0x0][_0x3fe9c0(0x108)];const _0x3ceae0=cheerio[_0x3fe9c0(0x162)](_0x5ef324);let _0x402e4c=[],_0x5f1a98=[],_0x2ec846=[];const _0x5dd582=_0x83319b=>{const _0x4f10c3=_0x3fe9c0,_0x58e7f0={'top':{'style':_0x4f10c3(0x1bb),'color':{'rgb':_0x4f10c3(0x1fe)}},'bottom':{'style':'thick','color':{'rgb':'000000'}},'left':{'style':_0x4f10c3(0x1bb),'color':{'rgb':_0x4f10c3(0x1fe)}},'right':{'style':'thick','color':{'rgb':_0x4f10c3(0x1fe)}}};if(_0x83319b){const _0xb2e706=_0x83319b[_0x4f10c3(0x18c)](';')[_0x4f10c3(0x1d7)]((_0x42ed2d,_0x12b06e)=>{const _0x555e41=_0x4f10c3,[_0x48dc7d,_0x3542e9]=_0x12b06e[_0x555e41(0x18c)](':')[_0x555e41(0x140)](_0x3c689c=>_0x3c689c[_0x555e41(0x146)]());return _0x42ed2d[_0x48dc7d]=_0x3542e9,_0x42ed2d;},{});_0xb2e706['border-top']&&(_0x58e7f0[_0x4f10c3(0xa9)][_0x4f10c3(0xe7)]=_0xb2e706[_0x4f10c3(0x7a)][_0x4f10c3(0x15d)](_0x4f10c3(0xe8))?_0x4f10c3(0xe8):_0x4f10c3(0x1a0)),_0xb2e706[_0x4f10c3(0x149)]&&(_0x58e7f0[_0x4f10c3(0x14f)]['style']=_0xb2e706[_0x4f10c3(0x149)][_0x4f10c3(0x15d)](_0x4f10c3(0xe8))?_0x4f10c3(0xe8):'medium'),_0xb2e706[_0x4f10c3(0xfb)]&&(_0x58e7f0[_0x4f10c3(0xf2)]['style']=_0xb2e706['border-left'][_0x4f10c3(0x15d)](_0x4f10c3(0xe8))?'thin':_0x4f10c3(0x1a0)),_0xb2e706['border-right']&&(_0x58e7f0['right'][_0x4f10c3(0xe7)]=_0xb2e706[_0x4f10c3(0x9b)][_0x4f10c3(0x15d)]('thin')?_0x4f10c3(0xe8):_0x4f10c3(0x1a0));}return _0x58e7f0;};_0x3ceae0(_0x3fe9c0(0x174))['each']((_0x2eeeea,_0x4bd28d)=>{const _0x22976a=_0x3fe9c0;let _0xaee4d1=[],_0x32e4c3=0x0;while(_0x2ec846[_0x32e4c3]){_0x2ec846[_0x32e4c3]--,_0x32e4c3++;}_0x3ceae0(_0x4bd28d)[_0x22976a(0x1a9)](_0x22976a(0xfe))['each']((_0x59b200,_0x332e62)=>{const _0x7a5fc3=_0x22976a;let _0x306002=_0x3ceae0(_0x332e62)['text']()[_0x7a5fc3(0x146)](),_0x412a3c=parseFloat(_0x306002['replace'](/,/g,''));isNaN(_0x412a3c)&&(_0x412a3c=_0x306002);let _0x3c4038=parseInt(_0x3ceae0(_0x332e62)['attr'](_0x7a5fc3(0xe1)))||0x1,_0x579ffd=parseInt(_0x3ceae0(_0x332e62)[_0x7a5fc3(0x168)](_0x7a5fc3(0x16c)))||0x1;const _0x10627a=_0x3ceae0(_0x332e62)['attr'](_0x7a5fc3(0xe7)),_0x1c2ffc=_0x5dd582(_0x10627a);_0xaee4d1[_0x32e4c3]={'v':_0x412a3c,'s':{'border':_0x1c2ffc}};(_0x3c4038>0x1||_0x579ffd>0x1)&&_0x5f1a98['push']({'s':{'r':_0x2eeeea,'c':_0x32e4c3},'e':{'r':_0x2eeeea+_0x579ffd-0x1,'c':_0x32e4c3+_0x3c4038-0x1}});for(let _0x62a510=0x0;_0x62a510<_0x3c4038;_0x62a510++){_0x579ffd>0x1&&(_0x2ec846[_0x32e4c3+_0x62a510]=_0x579ffd-0x1);}_0x32e4c3+=_0x3c4038;}),_0x402e4c[_0x22976a(0xff)](_0xaee4d1);});const _0x177c13=XLSX[_0x3fe9c0(0x1e0)][_0x3fe9c0(0x98)](),_0x18f5e0=XLSX[_0x3fe9c0(0x1e0)]['aoa_to_sheet'](_0x402e4c);_0x5f1a98[_0x3fe9c0(0x102)]>0x0&&(_0x18f5e0['!merges']=_0x5f1a98);_0x18f5e0[_0x3fe9c0(0x1d1)]=_0x402e4c[0x0][_0x3fe9c0(0x140)](()=>({'wpx':0x64})),XLSX[_0x3fe9c0(0x1e0)][_0x3fe9c0(0x1b3)](_0x177c13,_0x18f5e0,'Sales\x20Report');const _0x308678=XLSX[_0x3fe9c0(0xae)](_0x177c13,{'bookType':_0x3fe9c0(0x185),'type':_0x3fe9c0(0x7f)});_0x5b9cc2['setHeader'](_0x3fe9c0(0x1c5),_0x3fe9c0(0x171)),_0x5b9cc2[_0x3fe9c0(0x92)](_0x3fe9c0(0xd2),_0x3fe9c0(0x111)),_0x5b9cc2[_0x3fe9c0(0x8a)](_0x308678);}else generateReferenceNumber(_0x64fbbe,_0x5bf667['_id']['valueOf'](),_0x1fe582)[_0x3fe9c0(0xa4)](async _0x2a1c92=>{const _0x3b6111=_0x3fe9c0,_0xdfd5fb=await agentsdataDSICheck_DSRR(_0x64fbbe,_0x5bf667[_0x3b6111(0x152)][_0x3b6111(0x18f)](),_0x29bcbc,_0x2a1c92);let _0x5bc955=_0x3b6111(0x10c);_0x5bc955+=_0x3b6111(0x1f6),_0x5bc955+=_0x3b6111(0x186),_0x5bc955+=_0x3b6111(0x14d),_0x5bc955+=_0xdfd5fb,_0x5bc955+=_0x3b6111(0xcf),_0x5bc955+=_0x3b6111(0x155),_0x5bc955+='</div>';if(_0xdfd5fb[_0x3b6111(0x102)]>0x0){const _0x4255b2=await Reference[_0x3b6111(0x1ef)]({'staff_id':_0x5bf667[_0x3b6111(0x152)][_0x3b6111(0x18f)](),'referenceNumber':_0x2a1c92});_0x4255b2['html']=_0x5bc955,_0x4255b2[_0x3b6111(0x154)]=_0x64fbbe,await _0x4255b2[_0x3b6111(0x90)]();const _0x2f55de=cheerio[_0x3b6111(0x162)](_0x5bc955);let _0x91f0a3=[],_0x1b3529=[],_0xb981b1=[];const _0x3c1463=_0x284180=>{const _0x487d79=_0x3b6111,_0x4d2cc6={'top':{'style':_0x487d79(0x1bb),'color':{'rgb':_0x487d79(0x1fe)}},'bottom':{'style':_0x487d79(0x1bb),'color':{'rgb':_0x487d79(0x1fe)}},'left':{'style':_0x487d79(0x1bb),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x487d79(0x1fe)}}};if(_0x284180){const _0x23d33f=_0x284180[_0x487d79(0x18c)](';')[_0x487d79(0x1d7)]((_0x1e03a3,_0x22f838)=>{const _0x17fa48=_0x487d79,[_0x3d1ace,_0x5b1cd3]=_0x22f838[_0x17fa48(0x18c)](':')[_0x17fa48(0x140)](_0x5f5c03=>_0x5f5c03[_0x17fa48(0x146)]());return _0x1e03a3[_0x3d1ace]=_0x5b1cd3,_0x1e03a3;},{});_0x23d33f[_0x487d79(0x7a)]&&(_0x4d2cc6[_0x487d79(0xa9)][_0x487d79(0xe7)]=_0x23d33f[_0x487d79(0x7a)][_0x487d79(0x15d)](_0x487d79(0xe8))?_0x487d79(0xe8):'medium'),_0x23d33f['border-bottom']&&(_0x4d2cc6[_0x487d79(0x14f)][_0x487d79(0xe7)]=_0x23d33f[_0x487d79(0x149)][_0x487d79(0x15d)](_0x487d79(0xe8))?_0x487d79(0xe8):'medium'),_0x23d33f['border-left']&&(_0x4d2cc6[_0x487d79(0xf2)][_0x487d79(0xe7)]=_0x23d33f['border-left']['includes'](_0x487d79(0xe8))?'thin':_0x487d79(0x1a0)),_0x23d33f['border-right']&&(_0x4d2cc6[_0x487d79(0x1cb)][_0x487d79(0xe7)]=_0x23d33f[_0x487d79(0x9b)][_0x487d79(0x15d)](_0x487d79(0xe8))?_0x487d79(0xe8):_0x487d79(0x1a0));}return _0x4d2cc6;};_0x2f55de(_0x3b6111(0x174))['each']((_0x10d64b,_0x391453)=>{const _0x5983c3=_0x3b6111;let _0x517869=[],_0x842e84=0x0;while(_0xb981b1[_0x842e84]){_0xb981b1[_0x842e84]--,_0x842e84++;}_0x2f55de(_0x391453)['find'](_0x5983c3(0xfe))['each']((_0x2fef2a,_0x2f0af4)=>{const _0x3768d9=_0x5983c3;let _0x2dbca1=_0x2f55de(_0x2f0af4)['text']()[_0x3768d9(0x146)](),_0x5f2b2a=parseFloat(_0x2dbca1[_0x3768d9(0xbb)](/,/g,''));isNaN(_0x5f2b2a)&&(_0x5f2b2a=_0x2dbca1);let _0x3bfe84=parseInt(_0x2f55de(_0x2f0af4)[_0x3768d9(0x168)](_0x3768d9(0xe1)))||0x1,_0x32b83b=parseInt(_0x2f55de(_0x2f0af4)['attr']('rowspan'))||0x1;const _0x36287d=_0x2f55de(_0x2f0af4)['attr'](_0x3768d9(0xe7)),_0x5c6bff=_0x3c1463(_0x36287d);_0x517869[_0x842e84]={'v':_0x5f2b2a,'s':{'border':_0x5c6bff}};(_0x3bfe84>0x1||_0x32b83b>0x1)&&_0x1b3529[_0x3768d9(0xff)]({'s':{'r':_0x10d64b,'c':_0x842e84},'e':{'r':_0x10d64b+_0x32b83b-0x1,'c':_0x842e84+_0x3bfe84-0x1}});for(let _0x248590=0x0;_0x248590<_0x3bfe84;_0x248590++){_0x32b83b>0x1&&(_0xb981b1[_0x842e84+_0x248590]=_0x32b83b-0x1);}_0x842e84+=_0x3bfe84;}),_0x91f0a3[_0x5983c3(0xff)](_0x517869);});const _0x44ff1f=XLSX['utils']['book_new'](),_0x52a53d=XLSX[_0x3b6111(0x1e0)][_0x3b6111(0x12b)](_0x91f0a3);_0x1b3529[_0x3b6111(0x102)]>0x0&&(_0x52a53d[_0x3b6111(0x159)]=_0x1b3529);_0x52a53d[_0x3b6111(0x1d1)]=_0x91f0a3[0x0][_0x3b6111(0x140)](()=>({'wpx':0x64})),XLSX['utils'][_0x3b6111(0x1b3)](_0x44ff1f,_0x52a53d,_0x3b6111(0x19a));const _0x62b4fc=XLSX[_0x3b6111(0xae)](_0x44ff1f,{'bookType':_0x3b6111(0x185),'type':_0x3b6111(0x7f)});_0x5b9cc2[_0x3b6111(0x92)](_0x3b6111(0x1c5),_0x3b6111(0x171)),_0x5b9cc2[_0x3b6111(0x92)](_0x3b6111(0xd2),_0x3b6111(0x111)),_0x5b9cc2[_0x3b6111(0x8a)](_0x62b4fc);}else await Reference['deleteOne']({'referenceNumber':_0x2a1c92}),_0x460c47[_0x3b6111(0x124)](_0x3b6111(0x1d2),_0x3b6111(0x1ce)),_0x5b9cc2[_0x3b6111(0x133)](_0x3b6111(0xc6));})[_0x3fe9c0(0x11a)](console[_0x3fe9c0(0x107)]);}),router[a0_0x209eb3(0xbd)](a0_0x209eb3(0x16d),auth,async(_0x3cefc9,_0x6000c7)=>{const _0x536850=a0_0x209eb3;try{const {username:_0x5c8dc9,email:_0x28139a,role:_0x3c7937}=_0x3cefc9['user'],_0x3d33bb=_0x3cefc9[_0x536850(0x1d8)],_0x435bfe=await profile['findOne']({'email':_0x3d33bb[_0x536850(0x15f)]}),_0x155d2b={'year':_0x536850(0x79),'month':_0x536850(0xaa),'day':_0x536850(0x79)},_0x103695=await master_shop[_0x536850(0x1a9)]();console[_0x536850(0x200)]('Products\x20master',_0x103695);const _0x34cce0=await product[_0x536850(0x1a9)]();console['log'](_0x536850(0xc5),_0x34cce0);const _0x485872=await warehouse['aggregate']([{'$unwind':_0x536850(0xb3)},{'$lookup':{'from':_0x536850(0x143),'localField':_0x536850(0x1ab),'foreignField':_0x536850(0x202),'as':_0x536850(0x103)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x536850(0xe6)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x536850(0x1c0)}}}]);console[_0x536850(0x200)](_0x536850(0x91),_0x485872),_0x485872[_0x536850(0x115)](_0x524c7e=>{const _0xc90ceb=_0x536850,_0x39360d=_0x34cce0[_0xc90ceb(0x140)](_0x5f0d95=>{const _0x2f0c16=_0xc90ceb;_0x5f0d95[_0x2f0c16(0x202)]==_0x524c7e[_0x2f0c16(0x152)]&&(_0x5f0d95[_0x2f0c16(0xe9)]=parseInt(_0x5f0d95['stock'])+parseInt(_0x524c7e['product_stock']));});});const _0x326ed2=await staff[_0x536850(0x1a9)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x37f025=await staff[_0x536850(0x1ef)]({'email':_0x3d33bb[_0x536850(0x15f)]});if(_0x103695[0x0]['language']==_0x536850(0xe3))var _0x287340=users[_0x536850(0xe5)];else{if(_0x103695[0x0][_0x536850(0xfd)]==_0x536850(0x81))var _0x287340=users[_0x536850(0x81)];else{if(_0x103695[0x0][_0x536850(0xfd)]==_0x536850(0x205))var _0x287340=users[_0x536850(0x205)];else{if(_0x103695[0x0][_0x536850(0xfd)]=='Spanish')var _0x287340=users[_0x536850(0x169)];else{if(_0x103695[0x0][_0x536850(0xfd)]==_0x536850(0x136))var _0x287340=users[_0x536850(0x136)];else{if(_0x103695[0x0][_0x536850(0xfd)]=='Portuguese\x20(BR)')var _0x287340=users['Portuguese'];else{if(_0x103695[0x0][_0x536850(0xfd)]=='Chinese')var _0x287340=users[_0x536850(0xc0)];else{if(_0x103695[0x0]['language']==_0x536850(0x86))var _0x287340=users[_0x536850(0x15c)];}}}}}}}_0x6000c7[_0x536850(0x84)](_0x536850(0xd5),{'success':_0x3cefc9['flash']('success'),'errors':_0x3cefc9[_0x536850(0x124)]('errors'),'alldata':_0x34cce0,'profile':_0x435bfe,'master_shop':_0x103695,'role':_0x3d33bb,'product_stock':_0x485872,'language':_0x287340,'staff_arr':_0x37f025,'staff_data_all':_0x326ed2});}catch(_0x54d6ec){}}),router['post'](a0_0x209eb3(0x14a),auth,async(_0xe6d25d,_0x49d779)=>{const _0x4a45a6=a0_0x209eb3;try{const {from:_0x4609c0,to:_0x4d003f,staff_data:_0x43d79b}=_0xe6d25d[_0x4a45a6(0xad)],_0x40cd08=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x4609c0,'$lte':_0x4d003f},'staff_id':_0x43d79b}},{'$sort':{'date_include':0x1}}]);_0x49d779[_0x4a45a6(0x1b4)](_0x40cd08);}catch(_0x11a494){_0x49d779[_0x4a45a6(0x1b4)](_0x11a494);}}),router['get'](a0_0x209eb3(0xb9),auth,async(_0x7853a,_0x57af73)=>{const _0x43e736=a0_0x209eb3;try{const _0x4f88dd=_0x7853a[_0x43e736(0x1fb)]['id'],_0x333b85=await Reference[_0x43e736(0x194)](_0x4f88dd);_0x57af73[_0x43e736(0x8a)](_0x333b85[_0x43e736(0x108)]);}catch(_0x115db5){_0x57af73['json'](_0x115db5);}}),router[a0_0x209eb3(0x85)](a0_0x209eb3(0xcc),auth,async(_0x45aa74,_0x420ff3)=>{const _0x2b85e0=a0_0x209eb3;try{const {ref_data:_0x5df60c}=_0x45aa74['body'],_0x37444a=_0x5df60c['split']('~'),_0x50cf04=_0x37444a[_0x2b85e0(0x112)](_0x2a23df=>_0x2a23df!==''),_0x5ebf89=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x50cf04}}}]),_0x30a5f0=XLSX[_0x2b85e0(0x1e0)][_0x2b85e0(0x98)]();_0x5ebf89['forEach'](_0x24c231=>{const _0x505858=_0x2b85e0,_0x1b9fe2=cheerio['load'](_0x24c231[_0x505858(0x108)]);let _0x46c34d=[],_0x40299c=[],_0x401d82=[];_0x1b9fe2(_0x505858(0x174))[_0x505858(0x12a)]((_0x5156dd,_0x362e1a)=>{const _0x20ffe3=_0x505858;let _0x33be00=[],_0x437829=0x0;while(_0x401d82[_0x437829]){_0x401d82[_0x437829]--,_0x437829++;}_0x1b9fe2(_0x362e1a)[_0x20ffe3(0x1a9)](_0x20ffe3(0xfe))[_0x20ffe3(0x12a)]((_0xc170d7,_0x4cfba1)=>{const _0x6d25c7=_0x20ffe3;let _0x30ff2c=_0x1b9fe2(_0x4cfba1)[_0x6d25c7(0x1cf)]()['trim'](),_0x4c8fe6=parseFloat(_0x30ff2c['replace'](/,/g,''));isNaN(_0x4c8fe6)&&(_0x4c8fe6=_0x30ff2c);let _0x43380c=parseInt(_0x1b9fe2(_0x4cfba1)[_0x6d25c7(0x168)](_0x6d25c7(0xe1)))||0x1,_0x48e373=parseInt(_0x1b9fe2(_0x4cfba1)[_0x6d25c7(0x168)](_0x6d25c7(0x16c)))||0x1;_0x33be00[_0x437829]=_0x4c8fe6;(_0x43380c>0x1||_0x48e373>0x1)&&_0x40299c[_0x6d25c7(0xff)]({'s':{'r':_0x5156dd,'c':_0x437829},'e':{'r':_0x5156dd+_0x48e373-0x1,'c':_0x437829+_0x43380c-0x1}});for(let _0x5c0fcb=0x0;_0x5c0fcb<_0x43380c;_0x5c0fcb++){_0x48e373>0x1&&(_0x401d82[_0x437829+_0x5c0fcb]=_0x48e373-0x1);}_0x437829+=_0x43380c;}),_0x46c34d[_0x20ffe3(0xff)](_0x33be00);});const _0x12fcb1=XLSX[_0x505858(0x1e0)][_0x505858(0x12b)](_0x46c34d);_0x40299c['length']>0x0&&(_0x12fcb1[_0x505858(0x159)]=_0x40299c),_0x12fcb1['!cols']=_0x46c34d[0x0][_0x505858(0x140)](()=>({'wpx':0x64})),XLSX[_0x505858(0x1e0)]['book_append_sheet'](_0x30a5f0,_0x12fcb1,_0x24c231[_0x505858(0xfa)]);});const _0x859e0b=XLSX[_0x2b85e0(0xae)](_0x30a5f0,{'bookType':'xlsx','type':'buffer'});_0x420ff3[_0x2b85e0(0x92)](_0x2b85e0(0x1c5),_0x2b85e0(0x1d6)),_0x420ff3[_0x2b85e0(0x92)](_0x2b85e0(0xd2),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x420ff3[_0x2b85e0(0x8a)](_0x859e0b);}catch(_0x1a4214){_0x420ff3['json'](_0x1a4214);}}),router[a0_0x209eb3(0x85)](a0_0x209eb3(0x1e9),auth,async(_0xcff504,_0x15fa61)=>{const _0x56444f=a0_0x209eb3,{from_date:_0x37cb2f,agent_id:_0x32b354}=_0xcff504['body'],_0x42a2c9=_0xcff504[_0x56444f(0x1d8)],_0x52c44c=await staff[_0x56444f(0x1ef)]({'email':_0x42a2c9[_0x56444f(0x15f)]}),_0x5155eb=await master_shop[_0x56444f(0x1a9)](),_0x3e052d=await agentsdataDSICheck_DSRR(_0x37cb2f,_0x32b354,_0x30e6b0);let _0x29715c=_0x56444f(0x1e4);var _0x2f7e0d=new Date(_0x37cb2f);const _0x50c8b0={'year':_0x56444f(0x79),'month':'long','day':_0x56444f(0x79)},_0x118d64=new Intl[(_0x56444f(0x1c6))](_0x56444f(0x131),_0x50c8b0)[_0x56444f(0x129)](_0x2f7e0d);_0x29715c+=_0x56444f(0x1f6),_0x29715c+=_0x56444f(0x186),_0x29715c+='<table>',_0x29715c+=_0x3e052d,_0x29715c+=_0x56444f(0xcf),_0x29715c+=_0x56444f(0x155),_0x29715c+=_0x56444f(0x155);let _0x214723='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x47f669={'width':'15in','height':_0x56444f(0xfc),'orientation':_0x56444f(0x1fc),'border':{'top':'0.1in','right':_0x56444f(0x1f7),'bottom':_0x56444f(0x1f7),'left':'0.1in'},'header':{'height':'60mm','contents':_0x56444f(0x10d)+_0x214723+_0x56444f(0x167)+_0x118d64+_0x56444f(0xa7)},'footer':{'height':'20mm','contents':{'default':_0x56444f(0x1c7)}},'dpi':0x5,'zoomFactor':'1'};var _0x30e6b0='on';if(_0x30e6b0=='on'){const _0x136868=cheerio[_0x56444f(0x162)](_0x29715c);let _0x982ce8=[],_0x425912=[],_0x364eb7=[];_0x136868(_0x56444f(0x174))[_0x56444f(0x12a)]((_0x4b8e54,_0x42440f)=>{const _0x50516e=_0x56444f;let _0x24a580=[],_0x4ce4ce=0x0;while(_0x364eb7[_0x4ce4ce]){_0x364eb7[_0x4ce4ce]--,_0x4ce4ce++;}_0x136868(_0x42440f)[_0x50516e(0x1a9)](_0x50516e(0xfe))['each']((_0x2d66ac,_0x545ec7)=>{const _0xdb678a=_0x50516e;let _0x84640e=_0x136868(_0x545ec7)['text']()['trim'](),_0x604c4b=parseFloat(_0x84640e['replace'](/,/g,''));isNaN(_0x604c4b)&&(_0x604c4b=_0x84640e);let _0x634bbe=parseInt(_0x136868(_0x545ec7)['attr'](_0xdb678a(0xe1)))||0x1,_0x2544dd=parseInt(_0x136868(_0x545ec7)[_0xdb678a(0x168)](_0xdb678a(0x16c)))||0x1;_0x24a580[_0x4ce4ce]=_0x604c4b;(_0x634bbe>0x1||_0x2544dd>0x1)&&_0x425912[_0xdb678a(0xff)]({'s':{'r':_0x4b8e54,'c':_0x4ce4ce},'e':{'r':_0x4b8e54+_0x2544dd-0x1,'c':_0x4ce4ce+_0x634bbe-0x1}});for(let _0x562a82=0x0;_0x562a82<_0x634bbe;_0x562a82++){_0x2544dd>0x1&&(_0x364eb7[_0x4ce4ce+_0x562a82]=_0x2544dd-0x1);}_0x4ce4ce+=_0x634bbe;}),_0x982ce8[_0x50516e(0xff)](_0x24a580);});const _0x2f6a47=XLSX['utils'][_0x56444f(0x98)](),_0x347fe4=XLSX[_0x56444f(0x1e0)][_0x56444f(0x12b)](_0x982ce8);_0x425912['length']>0x0&&(_0x347fe4[_0x56444f(0x159)]=_0x425912);_0x347fe4[_0x56444f(0x1d1)]=_0x982ce8[0x0][_0x56444f(0x140)](()=>({'wpx':0x64})),XLSX['utils'][_0x56444f(0x1b3)](_0x2f6a47,_0x347fe4,_0x56444f(0x19a));const _0x925f51=XLSX[_0x56444f(0xae)](_0x2f6a47,{'bookType':_0x56444f(0x185),'type':_0x56444f(0x7f)});_0x15fa61[_0x56444f(0x92)]('Content-Disposition',_0x56444f(0x171)),_0x15fa61[_0x56444f(0x92)]('Content-Type',_0x56444f(0x111)),_0x15fa61[_0x56444f(0x8a)](_0x925f51);}else pdf[_0x56444f(0xcd)](_0x29715c,_0x47f669)['toStream'](function(_0x6f81a4,_0x15e09f){const _0x418f74=_0x56444f;if(_0x6f81a4){_0x15fa61[_0x418f74(0x19b)](0x1f4)[_0x418f74(0x8a)](_0x418f74(0xb8));return;}_0x15fa61[_0x418f74(0x92)](_0x418f74(0xd2),'application/pdf'),_0x15e09f[_0x418f74(0x13d)](_0x15fa61);});}),module[a0_0x209eb3(0xb7)]=router;