const a0_0x279c9d=a0_0x1029;(function(_0x556ac5,_0x2a041a){const _0x343d5d=a0_0x1029,_0x49b887=_0x556ac5();while(!![]){try{const _0x5dd677=-parseInt(_0x343d5d(0x19b))/0x1*(parseInt(_0x343d5d(0x1fb))/0x2)+-parseInt(_0x343d5d(0x1e9))/0x3*(-parseInt(_0x343d5d(0x152))/0x4)+-parseInt(_0x343d5d(0x18d))/0x5*(parseInt(_0x343d5d(0x1b0))/0x6)+-parseInt(_0x343d5d(0x1ac))/0x7*(-parseInt(_0x343d5d(0x235))/0x8)+parseInt(_0x343d5d(0x101))/0x9+-parseInt(_0x343d5d(0x1ef))/0xa*(-parseInt(_0x343d5d(0x1c1))/0xb)+-parseInt(_0x343d5d(0x19d))/0xc*(parseInt(_0x343d5d(0x1cb))/0xd);if(_0x5dd677===_0x2a041a)break;else _0x49b887['push'](_0x49b887['shift']());}catch(_0x5abca3){_0x49b887['push'](_0x49b887['shift']());}}}(a0_0x1186,0xec9c8));const express=require(a0_0x279c9d(0x15d)),res=require('express/lib/response'),app=express(),router=express[a0_0x279c9d(0x234)](),multer=require(a0_0x279c9d(0xed)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x279c9d(0x15f)),auth=require('../middleware/auth'),users=require(a0_0x279c9d(0x128)),excelJS=require(a0_0x279c9d(0xfc)),XLSX=require('xlsx'),PDFDocument=require('pdfkit-table'),fs=require('fs'),blobStream=require('blob-stream'),JsBarcode=require(a0_0x279c9d(0xe9)),{Canvas}=require(a0_0x279c9d(0x142)),pdf=require(a0_0x279c9d(0x1e5)),path=require('path'),mongoose=require('mongoose'),cheerio=require(a0_0x279c9d(0x114));router[a0_0x279c9d(0x20f)](a0_0x279c9d(0x1be),auth,async(_0x38647b,_0x847069)=>{const _0x19dfde=a0_0x279c9d;try{const {username:_0x458e1c,email:_0x54e10e,role:_0x2b37e8}=_0x38647b[_0x19dfde(0x18e)],_0x48cc27=_0x38647b[_0x19dfde(0x18e)],_0x2adaba=await profile[_0x19dfde(0x1b4)]({'email':_0x48cc27['email']}),_0x13cc2c={'year':'numeric','month':_0x19dfde(0x224),'day':_0x19dfde(0x19f)},_0x52bf83=await master_shop[_0x19dfde(0x220)]();console[_0x19dfde(0x218)](_0x19dfde(0x231),_0x52bf83);const _0x3895b8=await product[_0x19dfde(0x220)]();console[_0x19dfde(0x218)](_0x19dfde(0x1b7),_0x3895b8);const _0x264dad=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x19dfde(0x1a0),'foreignField':_0x19dfde(0x136),'as':_0x19dfde(0x151)}},{'$unwind':_0x19dfde(0x1f5)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x19dfde(0x211),'product_stock':{'$sum':'$product_stock'}}}]);console['log'](_0x19dfde(0x1eb),_0x264dad),_0x264dad['forEach'](_0x475fb4=>{const _0x4c147c=_0x19dfde,_0x16c002=_0x3895b8[_0x4c147c(0x25b)](_0x47e629=>{const _0x2e228b=_0x4c147c;_0x47e629[_0x2e228b(0x136)]==_0x475fb4['_id']&&(_0x47e629[_0x2e228b(0xf1)]=parseInt(_0x47e629['stock'])+parseInt(_0x475fb4[_0x2e228b(0x177)]));});}),console['log'](_0x19dfde(0x1b7),_0x3895b8);if(_0x52bf83[0x0][_0x19dfde(0x209)]==_0x19dfde(0x154))var _0x69359a=users[_0x19dfde(0x1d7)];else{if(_0x52bf83[0x0]['language']==_0x19dfde(0x185))var _0x69359a=users[_0x19dfde(0x185)];else{if(_0x52bf83[0x0][_0x19dfde(0x209)]=='German')var _0x69359a=users[_0x19dfde(0x24a)];else{if(_0x52bf83[0x0][_0x19dfde(0x209)]==_0x19dfde(0x237))var _0x69359a=users[_0x19dfde(0x237)];else{if(_0x52bf83[0x0]['language']=='French')var _0x69359a=users[_0x19dfde(0x216)];else{if(_0x52bf83[0x0][_0x19dfde(0x209)]==_0x19dfde(0x21b))var _0x69359a=users[_0x19dfde(0x217)];else{if(_0x52bf83[0x0][_0x19dfde(0x209)]==_0x19dfde(0x1f1))var _0x69359a=users[_0x19dfde(0x1f1)];else{if(_0x52bf83[0x0][_0x19dfde(0x209)]==_0x19dfde(0x1ec))var _0x69359a=users[_0x19dfde(0x140)];}}}}}}}_0x847069[_0x19dfde(0x11d)]('balanced',{'success':_0x38647b['flash'](_0x19dfde(0x13c)),'errors':_0x38647b[_0x19dfde(0x215)]('errors'),'alldata':_0x3895b8,'profile':_0x2adaba,'master_shop':_0x52bf83,'role':_0x48cc27,'product_stock':_0x264dad,'language':_0x69359a});}catch(_0x3d0156){}});async function dataCheck(_0x2e5faa,_0x181e04){const _0x5db1c0=a0_0x279c9d,_0x1026bb=await product[_0x5db1c0(0x226)]([{'$group':{'_id':{'brand':_0x5db1c0(0x125),'category':_0x5db1c0(0x15a)},'products':{'$push':{'name':_0x5db1c0(0x253),'product_code':_0x5db1c0(0x1cd)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x420229=[];_0x420229[_0x5db1c0(0x26c)]=[];for(let _0x948c2d=0x0;_0x948c2d<=_0x1026bb[_0x5db1c0(0x10b)]-0x1;_0x948c2d++){const _0x3971c9=_0x1026bb[_0x948c2d];_0x420229[_0x5db1c0(0x26c)][_0x5db1c0(0x19e)](_0x3971c9);}const _0x450a27=await product[_0x5db1c0(0x226)]([{'$group':{'_id':{'category':_0x5db1c0(0x15a)},'products':{'$push':{'brand':_0x5db1c0(0x125),'product_code':_0x5db1c0(0x1cd),'product_name':_0x5db1c0(0x253)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3a443e=await purchases_finished['aggregate']([{'$match':{'date':{'$gte':_0x2e5faa,'$lte':_0x181e04}}},{'$unwind':_0x5db1c0(0x11e)},{'$group':{'_id':{'product_name':'$product.product_name','product_code':'$product.product_code'},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x420229[_0x5db1c0(0x221)]=[];for(let _0x24fe60=0x0;_0x24fe60<=_0x3a443e[_0x5db1c0(0x10b)]-0x1;_0x24fe60++){const _0x2acd91=_0x3a443e[_0x24fe60];_0x420229[_0x5db1c0(0x221)][_0x5db1c0(0x19e)](_0x2acd91);}const _0x7b1ba6=await sales_sa[_0x5db1c0(0x226)]([{'$match':{'date':{'$gte':_0x2e5faa,'$lte':_0x181e04}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5db1c0(0x1de)}}},{'$lookup':{'from':_0x5db1c0(0x1d5),'localField':_0x5db1c0(0x268),'foreignField':'_id','as':_0x5db1c0(0x196)}},{'$unwind':_0x5db1c0(0x1d2)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x5db1c0(0x219),'product_code':_0x5db1c0(0x19c)},'totalQTY':{'$sum':_0x5db1c0(0x17b)}}}]);console['log'](_0x7b1ba6[0x0]),_0x420229[_0x5db1c0(0xfe)]=[];for(let _0x3ed6b6=0x0;_0x3ed6b6<=_0x7b1ba6['length']-0x1;_0x3ed6b6++){const _0x3f438f=_0x7b1ba6[_0x3ed6b6];_0x420229['sales_bkg']['push'](_0x3f438f);}const _0x2bbad8=await sales_sa[_0x5db1c0(0x226)]([{'$match':{'date':{'$gte':_0x2e5faa,'$lte':_0x181e04}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5db1c0(0x1de)}}},{'$lookup':{'from':_0x5db1c0(0x1d5),'localField':'sales_staff_id','foreignField':_0x5db1c0(0x176),'as':_0x5db1c0(0x196)}},{'$unwind':_0x5db1c0(0x1d2)},{'$unwind':_0x5db1c0(0x1ee)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x5db1c0(0x26f)}},{'$group':{'_id':{'product_name':_0x5db1c0(0x219),'product_code':_0x5db1c0(0x19c)},'totalQTY':{'$sum':_0x5db1c0(0x188)}}}]);_0x420229[_0x5db1c0(0x24f)]=[];for(let _0x3ef464=0x0;_0x3ef464<=_0x2bbad8[_0x5db1c0(0x10b)]-0x1;_0x3ef464++){const _0x531f70=_0x2bbad8[_0x3ef464];_0x420229['sales_ext'][_0x5db1c0(0x19e)](_0x531f70);}let _0x37ef7d='';for(let _0x16c589=0x0;_0x16c589<=_0x450a27[_0x5db1c0(0x10b)]-0x1;_0x16c589++){const _0x19f163=_0x450a27[_0x16c589];_0x37ef7d+=_0x5db1c0(0x1c0),_0x37ef7d+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x19f163[_0x5db1c0(0x176)]['category']+'</td>',_0x37ef7d+=_0x5db1c0(0x1b6);for(let _0x1474bb=0x0;_0x1474bb<_0x420229['cat_brand']['length'];_0x1474bb++){const _0x40dbf2=_0x420229[_0x5db1c0(0x26c)][_0x1474bb];if(_0x40dbf2[_0x5db1c0(0x176)][_0x5db1c0(0x21e)]==_0x19f163[_0x5db1c0(0x176)][_0x5db1c0(0x21e)]){let _0x30fe45=[],_0x36ec89=[],_0x17f6b5=[];_0x30fe45[_0x40dbf2[_0x5db1c0(0x176)][_0x5db1c0(0x148)]]=[],_0x36ec89[_0x40dbf2[_0x5db1c0(0x176)][_0x5db1c0(0x148)]]=[],_0x17f6b5[_0x40dbf2[_0x5db1c0(0x176)][_0x5db1c0(0x148)]]=[];var _0x28e8e3=0x0,_0x3c2545=0x0,_0x14a8b1=0x0;for(let _0x31dfb9=0x0;_0x31dfb9<_0x40dbf2[_0x5db1c0(0x14d)][_0x5db1c0(0x10b)];_0x31dfb9++){const _0xf6f08f=_0x40dbf2[_0x5db1c0(0x14d)][_0x31dfb9];for(let _0x3b47df=0x0;_0x3b47df<=_0x420229[_0x5db1c0(0x221)][_0x5db1c0(0x10b)]-0x1;_0x3b47df++){const _0x19792d=_0x420229['beg_bal'][_0x3b47df];_0x19792d['_id'][_0x5db1c0(0x200)]==_0xf6f08f['name']&&_0x19792d['_id'][_0x5db1c0(0x164)]==_0xf6f08f[_0x5db1c0(0x164)]&&(_0x28e8e3+=parseInt(_0x19792d[_0x5db1c0(0x14b)],0xa));}for(let _0x4ff888=0x0;_0x4ff888<=_0x420229[_0x5db1c0(0x24f)]['length']-0x1;_0x4ff888++){const _0xb67fae=_0x420229['sales_ext'][_0x4ff888];_0xb67fae['_id'][_0x5db1c0(0x200)]==_0xf6f08f[_0x5db1c0(0x136)]&&_0xb67fae[_0x5db1c0(0x176)][_0x5db1c0(0x164)]==_0xf6f08f['product_code']&&(_0x3c2545+=parseFloat(_0xb67fae[_0x5db1c0(0x14b)],0xa)[_0x5db1c0(0x141)](0x2));}for(let _0x1cbe7d=0x0;_0x1cbe7d<=_0x420229['sales_bkg'][_0x5db1c0(0x10b)]-0x1;_0x1cbe7d++){const _0x2ae9f6=_0x420229[_0x5db1c0(0xfe)][_0x1cbe7d];_0x2ae9f6[_0x5db1c0(0x176)][_0x5db1c0(0x200)]==_0xf6f08f[_0x5db1c0(0x136)]&&_0x2ae9f6[_0x5db1c0(0x176)]['product_code']==_0xf6f08f[_0x5db1c0(0x164)]&&(_0x14a8b1+=parseInt(_0x2ae9f6[_0x5db1c0(0x14b)],0xa));}}const _0x2fcb40=new Intl['NumberFormat'](_0x5db1c0(0x158));var _0x4ca06e=_0x2fcb40[_0x5db1c0(0x20c)](_0x28e8e3);_0x30fe45[_0x40dbf2['_id'][_0x5db1c0(0x148)]][_0x5db1c0(0x19e)](_0x4ca06e),_0x36ec89[_0x40dbf2[_0x5db1c0(0x176)][_0x5db1c0(0x148)]]['push'](_0x2fcb40['format'](_0x3c2545)),_0x17f6b5[_0x40dbf2['_id']['brand']][_0x5db1c0(0x19e)](_0x2fcb40['format'](_0x14a8b1));var _0x3e8573=_0x2fcb40['format'](_0x28e8e3-(_0x14a8b1+_0x3c2545));_0x37ef7d+=_0x5db1c0(0x1c0),_0x37ef7d+=_0x5db1c0(0x206),_0x37ef7d+='<td\x20class=\x22row_data\x22>'+_0x40dbf2[_0x5db1c0(0x176)]['brand']+_0x5db1c0(0x146),_0x37ef7d+=_0x5db1c0(0xeb)+_0x30fe45[_0x40dbf2['_id'][_0x5db1c0(0x148)]][0x0]+'</td>',_0x37ef7d+=_0x5db1c0(0x102),_0x37ef7d+=_0x5db1c0(0xeb)+_0x17f6b5[_0x40dbf2[_0x5db1c0(0x176)][_0x5db1c0(0x148)]][0x0]+_0x5db1c0(0x146),_0x37ef7d+='<td\x20class=\x22row_data\x22>'+_0x36ec89[_0x40dbf2[_0x5db1c0(0x176)][_0x5db1c0(0x148)]][0x0]+_0x5db1c0(0x146),_0x37ef7d+=_0x5db1c0(0xeb)+_0x3e8573+_0x5db1c0(0x146),_0x37ef7d+=_0x5db1c0(0x1b6);}}}return console[_0x5db1c0(0x218)](_0x420229[_0x5db1c0(0xfe)]),_0x37ef7d;}router[a0_0x279c9d(0x205)]('/balance/pdf',auth,async(_0xa6bb75,_0x18f363)=>{const _0x297849=a0_0x279c9d,{from_date:_0x778112,to_date:_0x39853a}=_0xa6bb75[_0x297849(0x171)],_0x18492e=await dataCheck(_0x778112,_0x39853a);{}let _0x3afe6f='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0xb2a525=new Date(_0x778112),_0x208ab9=new Date(_0x39853a);const _0x453acf={'year':_0x297849(0x19f),'month':_0x297849(0x224),'day':_0x297849(0x19f)},_0x7ff104=new Intl[(_0x297849(0x223))](_0x297849(0x158),_0x453acf)[_0x297849(0x20c)](_0xb2a525),_0x3920bf=new Intl[(_0x297849(0x223))](_0x297849(0x158),_0x453acf)['format'](_0x208ab9);_0x3afe6f+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x3afe6f+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x3afe6f+=_0x297849(0x1db)+_0x7ff104+_0x297849(0x182)+_0x3920bf+'</p>',_0x3afe6f+=_0x297849(0x1dd),_0x3afe6f+=_0x297849(0x225),_0x3afe6f+='<table>',_0x3afe6f+=_0x297849(0x1c0),_0x3afe6f+=_0x297849(0x1c8),_0x3afe6f+=_0x297849(0x240),_0x3afe6f+=_0x297849(0x257)+_0x7ff104+'</th>',_0x3afe6f+=_0x297849(0x168),_0x3afe6f+=_0x297849(0x1bd),_0x3afe6f+=_0x297849(0x109)+_0x3920bf+_0x297849(0xf5),_0x3afe6f+=_0x297849(0x1b6),_0x3afe6f+=_0x297849(0x1c0),_0x3afe6f+=_0x297849(0x144),_0x3afe6f+=_0x297849(0x120),_0x3afe6f+='</tr>',_0x3afe6f+=_0x18492e,_0x3afe6f+=_0x297849(0x1da),_0x3afe6f+='</div>',_0x3afe6f+=_0x297849(0x250);const _0x501a2c={'format':_0x297849(0x19a),'orientation':_0x297849(0x22c)};pdf['create'](_0x3afe6f,_0x501a2c)[_0x297849(0x227)](function(_0x5771a0,_0x4e9336){const _0x454782=_0x297849;if(_0x5771a0){_0x18f363[_0x454782(0x172)](0x1f4)[_0x454782(0x1cc)](_0x454782(0x1ba));return;}_0x18f363[_0x454782(0x1df)](_0x454782(0x10c),'application/pdf'),_0x4e9336['pipe'](_0x18f363);});}),router['get'](a0_0x279c9d(0x248),auth,async(_0x1ed36f,_0x487cd6)=>{const _0x9dd836=a0_0x279c9d;try{const {username:_0x2c2008,email:_0x16e4a1,role:_0x2187b3}=_0x1ed36f[_0x9dd836(0x18e)],_0x39c6c7=_0x1ed36f[_0x9dd836(0x18e)],_0x35157a=await profile[_0x9dd836(0x1b4)]({'email':_0x39c6c7[_0x9dd836(0x1ce)]}),_0x4d036d={'year':_0x9dd836(0x19f),'month':'long','day':'numeric'},_0x51d29e=await master_shop[_0x9dd836(0x220)](),_0x32f141=await product[_0x9dd836(0x220)](),_0x1e4014=await warehouse[_0x9dd836(0x226)]([{'$unwind':_0x9dd836(0x251)},{'$lookup':{'from':_0x9dd836(0x14d),'localField':_0x9dd836(0x1a0),'foreignField':'name','as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x9dd836(0x256),'product_stock':_0x9dd836(0x135)}},{'$group':{'_id':_0x9dd836(0x211),'product_stock':{'$sum':_0x9dd836(0x156)}}}]);if(_0x51d29e[0x0][_0x9dd836(0x209)]==_0x9dd836(0x154))var _0x236959=users['English'];else{if(_0x51d29e[0x0][_0x9dd836(0x209)]==_0x9dd836(0x185))var _0x236959=users[_0x9dd836(0x185)];else{if(_0x51d29e[0x0][_0x9dd836(0x209)]==_0x9dd836(0x24a))var _0x236959=users[_0x9dd836(0x24a)];else{if(_0x51d29e[0x0]['language']==_0x9dd836(0x237))var _0x236959=users[_0x9dd836(0x237)];else{if(_0x51d29e[0x0][_0x9dd836(0x209)]==_0x9dd836(0x216))var _0x236959=users[_0x9dd836(0x216)];else{if(_0x51d29e[0x0][_0x9dd836(0x209)]==_0x9dd836(0x21b))var _0x236959=users[_0x9dd836(0x217)];else{if(_0x51d29e[0x0]['language']=='Chinese')var _0x236959=users[_0x9dd836(0x1f1)];else{if(_0x51d29e[0x0][_0x9dd836(0x209)]=='Arabic\x20(ae)')var _0x236959=users[_0x9dd836(0x140)];}}}}}}}_0x487cd6[_0x9dd836(0x11d)](_0x9dd836(0x1a5),{'success':_0x1ed36f[_0x9dd836(0x215)]('success'),'errors':_0x1ed36f[_0x9dd836(0x215)]('errors'),'alldata':_0x32f141,'profile':_0x35157a,'master_shop':_0x51d29e,'role':_0x39c6c7,'product_stock':_0x1e4014,'language':_0x236959});}catch(_0x1eab2b){}});async function agentsdataCheck(_0x4343cd,_0x2ede9b){const _0x3baab5=a0_0x279c9d,_0x5ebac2=await product[_0x3baab5(0x226)]([{'$group':{'_id':{'brand':_0x3baab5(0x125),'category':'$category'},'products':{'$push':{'name':_0x3baab5(0x253),'product_code':_0x3baab5(0x1cd)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x11d8f2=[];_0x11d8f2[_0x3baab5(0x26c)]=[];for(let _0x73fd0=0x0;_0x73fd0<=_0x5ebac2[_0x3baab5(0x10b)]-0x1;_0x73fd0++){const _0x1c1c58=_0x5ebac2[_0x73fd0];_0x11d8f2['cat_brand'][_0x3baab5(0x19e)](_0x1c1c58);}const _0x487790=await product[_0x3baab5(0x226)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x3baab5(0x1cd),'product_name':_0x3baab5(0x253)}}}},{'$sort':{'_id.category':-0x1}}]),_0x45109a=await product[_0x3baab5(0x226)]([{'$group':{'_id':{'category':_0x3baab5(0x15a),'brand':_0x3baab5(0x125)}}},{'$group':{'_id':_0x3baab5(0x1f3),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1ca3f9=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x4343cd,'$lte':_0x2ede9b}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x3baab5(0x1de)}}},{'$lookup':{'from':'staffs','localField':'sales_staff_id','foreignField':_0x3baab5(0x176),'as':'sales_info'}},{'$unwind':_0x3baab5(0x1d2)},{'$unwind':_0x3baab5(0x1ee)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':'false'}},{'$lookup':{'from':_0x3baab5(0x14d),'localField':_0x3baab5(0x1ab),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x3baab5(0x214)},{'$group':{'_id':{'sales_id':_0x3baab5(0x1a2),'category':_0x3baab5(0xf2),'brand':'$product_info.brand'},'salesman_data':{'$first':_0x3baab5(0x124)},'totalQTY':{'$sum':_0x3baab5(0x188)},'products':{'$push':{'qty':_0x3baab5(0x188),'product_details':{'prod_name':_0x3baab5(0x199),'product_code':_0x3baab5(0xee),'category':_0x3baab5(0xf2),'brand':'$product_info.brand'}}}}}]);let _0xe064af='';_0xe064af+=_0x3baab5(0x1c0),_0xe064af+=_0x3baab5(0xff),_0xe064af+=_0x3baab5(0x1b6),_0xe064af+=_0x3baab5(0x1c0),_0xe064af+=_0x3baab5(0x15b);for(let _0x165710=0x0;_0x165710<=_0x487790['length']-0x1;_0x165710++){const _0x4128c7=_0x487790[_0x165710];for(let _0x39e31b=0x0;_0x39e31b<_0x45109a[_0x3baab5(0x10b)];_0x39e31b++){const _0x317e4a=_0x45109a[_0x39e31b];_0x317e4a[_0x3baab5(0x176)]==_0x4128c7['_id']['category']&&(_0xe064af+=_0x3baab5(0x1fe)+_0x317e4a[_0x3baab5(0x243)]+'\x22\x20class=\x22cat_data\x22>'+_0x4128c7[_0x3baab5(0x176)]['category']+_0x3baab5(0x146));}}_0xe064af+=_0x3baab5(0x15b),_0xe064af+='</tr>',_0xe064af+=_0x3baab5(0x1c0),_0xe064af+=_0x3baab5(0x232);for(let _0x145d2b=0x0;_0x145d2b<=_0x487790['length']-0x1;_0x145d2b++){const _0x542ce3=_0x487790[_0x145d2b];for(let _0x131ee8=0x0;_0x131ee8<_0x11d8f2[_0x3baab5(0x26c)]['length'];_0x131ee8++){const _0x5ebff9=_0x11d8f2['cat_brand'][_0x131ee8];_0x5ebff9[_0x3baab5(0x176)][_0x3baab5(0x21e)]==_0x542ce3[_0x3baab5(0x176)][_0x3baab5(0x21e)]&&(_0xe064af+=_0x3baab5(0x267)+_0x5ebff9[_0x3baab5(0x176)][_0x3baab5(0x148)]+'</td>');}}_0xe064af+=_0x3baab5(0x1a6),_0xe064af+=_0x3baab5(0x1b6);let _0x428700={'name':[],'dataqty':{}};for(let _0x407672=0x0;_0x407672<_0x11d8f2[_0x3baab5(0x26c)][_0x3baab5(0x10b)];_0x407672++){const _0x3c0569=_0x11d8f2[_0x3baab5(0x26c)][_0x407672],_0x3aa951=_0x3c0569['_id'][_0x3baab5(0x148)],_0x5a8425=_0x3c0569[_0x3baab5(0x176)][_0x3baab5(0x21e)];!_0x428700['dataqty'][_0x3aa951]&&(_0x428700[_0x3baab5(0x159)][_0x3aa951]={});!_0x428700['dataqty'][_0x3aa951][_0x5a8425]&&(_0x428700[_0x3baab5(0x159)][_0x3aa951][_0x5a8425]=[]);for(let _0x46bff2=0x0;_0x46bff2<_0x1ca3f9[_0x3baab5(0x10b)];_0x46bff2++){const _0x413649=_0x1ca3f9[_0x46bff2];if(_0x3aa951===_0x413649[_0x3baab5(0x176)][_0x3baab5(0x148)]&&_0x5a8425===_0x413649[_0x3baab5(0x176)][_0x3baab5(0x21e)]){const _0x59215e=_0x413649['salesman_data'];!_0x428700[_0x3baab5(0x159)][_0x3aa951][_0x5a8425][_0x59215e]&&(_0x428700[_0x3baab5(0x159)][_0x3aa951][_0x5a8425][_0x59215e]=[]),_0x428700[_0x3baab5(0x159)][_0x3aa951][_0x5a8425][_0x59215e][_0x3baab5(0x19e)](_0x413649[_0x3baab5(0x14b)]),!_0x428700[_0x3baab5(0x136)][_0x3baab5(0x12c)](_0x59215e)&&_0x428700[_0x3baab5(0x136)][_0x3baab5(0x19e)](_0x59215e);}}}_0xe064af+='<tr>';for(let _0x5e6f54=0x0;_0x5e6f54<=_0x428700[_0x3baab5(0x136)]['length']-0x1;_0x5e6f54++){const _0x1fc6b3=_0x428700[_0x3baab5(0x136)][_0x5e6f54];_0xe064af+='<td\x20class=\x22row_data\x22>'+_0x1fc6b3+'</td>';var _0x13f489=0x0,_0x5336ad=0x0;for(let _0x3b3cad=0x0;_0x3b3cad<=_0x11d8f2[_0x3baab5(0x26c)][_0x3baab5(0x10b)]-0x1;_0x3b3cad++){const _0x34b153=_0x11d8f2['cat_brand'][_0x3b3cad];var _0x540bf0=0x0;_0x428700[_0x3baab5(0x159)][_0x34b153[_0x3baab5(0x176)]['brand']][_0x34b153[_0x3baab5(0x176)][_0x3baab5(0x21e)]][_0x1fc6b3]?(_0x540bf0=_0x428700[_0x3baab5(0x159)][_0x34b153[_0x3baab5(0x176)][_0x3baab5(0x148)]][_0x34b153[_0x3baab5(0x176)][_0x3baab5(0x21e)]][_0x1fc6b3][0x0],_0xe064af+=_0x3baab5(0xeb)+formatNumber(_0x540bf0[_0x3baab5(0x141)](0x2))+'</td>'):(_0x540bf0=0x0,_0xe064af+=_0x3baab5(0xeb)+_0x540bf0+_0x3baab5(0x146)),_0x13f489+=_0x540bf0;}_0xe064af+=_0x3baab5(0xeb)+formatNumber(_0x13f489[_0x3baab5(0x141)](0x2))+_0x3baab5(0x146);}return _0xe064af+=_0x3baab5(0x1b6),_0xe064af;}function a0_0x1186(){const _0x39fe58=['$sale_product.adj_discount','product_details','000000','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','html-pdf','No\x20data\x20was\x20Found!','<td\x20colspan=\x223\x22><b>TOTAL<b>','border-top','831erNbho','$adj_discount','Products\x20warehouse_data','Arabic\x20(ae)','$products.adj_discount','$sale_product','24370mgtQAH','getDate','Chinese','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','$_id.category','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$product_docs','$NetPrice','$customer','attr','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','$discount','232CqzuVe','totalGross','$product_list.product_stock','<td\x20colspan=\x22','text','product_name','check_no','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','$check_no','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','post','<td\x20class=\x22row_data\x22></td>','$dsi','<th>\x20BEG\x20BALANCE\x20</th>','language','then','/dsrr/pdf','format','td,\x20th','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','get','$due_date','$product_name','adj_discount','$products.qty','$product_info','flash','French','Portuguese','log','$sale_product.product_name','$products','Portuguese\x20(BR)','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','xlsx','category','customer','find','beg_bal','/agent_reports/pdf_admin','DateTimeFormat','long','<div\x20class=\x22col-sm-11\x22>','aggregate','toStream','buffer','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','!cols','$amount','landscape','replace','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<div\x20\x20id=\x22table-conatainer\x22>','Products\x20master','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','thin','Router','4912kenZGK','NumberFormat','Spanish','totalQTYsum','$product_list','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','isFG','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','Types','book_new','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','<th\x20rowspan=\x272\x27>Products</th>','border-left','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','brandCount','$products.product_details.category','isArray','true','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','/agent/view','0.1in','German','html','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','exports','sales_ext','</div>','$product_details','$product_info.brand','$name','$_id.status_data','$product_list.product_name','$product_details.product_name','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','date','top','product_info','map','</thead>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','$products.product_details.brand','$bank','20mm','!merges','NetPrice','medium','<th>\x20INCOMING\x20</th>','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','toISOString','<td\x20class=\x22cat_data\x22>','sales_staff_id','params','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','cat_brand','<table>','aoa_to_sheet','false','$products.NetPrice','jsbarcode','$_id.date','<td\x20class=\x22row_data\x22>','<thead>','multer','$product_info.product_code','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','dsi','stock','$product_info.category','</script>','split','</th>','$sale_product.stock','ObjectId','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','/reports/dsrr/view','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','utils','exceljs','/agent_reports/view','sales_bkg','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','sumqty','11107764djpykC','<td\x20class=\x22row_data\x22>0</td>','test','60mm','\x20-\x20HH','$sale_product.discount','totalPrice','referenceNumber','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','border-right','length','Content-Type','redirect','<td\x20class=\x22cat_data\x22><b>FG</b></td>','style','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','bottom','error','$products.product_details','cheerio','</tbody>','rowspan','$sale_product._id','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','catch','<th>\x20QTY\x20SOLD\x20</th>','/total_sales_reports/pdf','$sale_product.totalprice','render','$product','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','<th>X-Truck</th>','\x22\x20class=\x22cat_data\x22>','/getDSSR_no','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','$sales_info.name','$brand','<script>','</p>','../public/language/languages.json','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$_id.customer','sales_reports','includes','$date','bank','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','PDF\x20Generation\x20Error:','qty','$cash','dssr_view_admin','due_date','$product_details.product_stock','name','/dl_excel','book_append_sheet','Content-Disposition','errors','reduce','success','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','Household','15in','Arabic','toFixed','canvas','<td\x20class=\x22row_data\x22><b>','<th>Booking</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','</td>','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','brand','forEach','\x22><b></b></td>','totalQTY','$totalQty','products','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','/agent_reports/sales_ad','product_docs','20340FRVuRL','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','English\x20(US)','getMonth','$product_stock','$products.product_details.prod_id','en-US','dataqty','$category','<td\x20class=\x22cat_data\x22></td>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','express','valueOf','../models/all_models','/dsrr_admin/view','<th>\x20ITEM\x20DESCRIPTION\x20</th>','excel','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','product_code','write','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','dsi_sales_admin','<th\x20rowspan=\x272\x27>Production</th>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','window.print();','create','$product_list.product_code','<th>\x20INVOICE\x20AMOUNT\x20</th>','/inventory_sum/view','$products.product_details.gross_price','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','body','status','date_include','toLocaleDateString','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','_id','product_stock','totalQty','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','$product_info.gross_price','$sale_product.quantity','$products.discount','sort','attachment;\x20filename=\x22sales_report.xlsx\x22','pipe','save','$_id.dsi','\x20-\x20','filter','</b></td>','Hindi','$sale_product.prod_cat','window.onload\x20=\x20function()\x20{','$sale_product.real_qty_unit_val','each','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$status_data','/total_sales_reports/view','115nxEvMJ','user','8.5in','slice','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','$_id.brand','thick','trim','/agent/pdf','sales_info','table\x20tr','sales_man_code','$product_info.name','Letter','9293JZJfKk','$sale_product.product_code','36492IaVrhF','push','numeric','product_details.product_name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','$sales_info._id','findById','application/pdf','agent_sales','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','Sales\x20Report','Asia/Manila','border-bottom','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','sale_product.product_code','16723tUmEyw','load','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','amount','359934efyZaI','$totalGross','<tbody>','attachment;\x20filename=\x22reports.xlsx\x22','findOne','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','</tr>','Products\x20find_data','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','left','Error\x20generating\x20PDF','json','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','<th\x20colspan=\x272\x27>SOLD</th>','/balance/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<tr>','4015FSZHPb','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$sale_product.isFG','discount','<p>INVENTORY\x20SUMMARY</p>','colspan','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','<th\x20rowspan=\x272\x27>Category</th>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','6721hfxpua','send','$product_code','email','<div\x20style=\x22page-break-before:\x20always;\x22></div>','prod_cat','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','$sales_info','<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','staffs','cash','English','right','<h1>JAKA\x20EQUITIES\x20CORP</h1>','</table>','<p>','toLocaleString','<div\x20class=\x22row\x22>','$sales_staff_id','setHeader','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>'];a0_0x1186=function(){return _0x39fe58;};return a0_0x1186();}router[a0_0x279c9d(0x205)](a0_0x279c9d(0x195),auth,async(_0x27ca98,_0x58f7a3)=>{const _0x369977=a0_0x279c9d,{from_date:_0x536f62,to_date:_0x2ac710}=_0x27ca98['body'],_0xb1b440=await agentsdataCheck(_0x536f62,_0x2ac710);{}let _0x7296b8='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x29e89d=new Date(_0x536f62),_0x3fbcf3=new Date(_0x2ac710);const _0x53208a={'year':'numeric','month':_0x369977(0x224),'day':_0x369977(0x19f)},_0xeb1f3a=new Intl['DateTimeFormat'](_0x369977(0x158),_0x53208a)[_0x369977(0x20c)](_0x29e89d),_0x50de83=new Intl[(_0x369977(0x223))]('en-US',_0x53208a)[_0x369977(0x20c)](_0x3fbcf3);_0x7296b8+=_0x369977(0x1d9),_0x7296b8+='<p>SALES\x20REPORTS</p>',_0x7296b8+=_0x369977(0x1db)+_0xeb1f3a+'\x20-\x20'+_0x50de83+_0x369977(0x127),_0x7296b8+=_0x369977(0x1dd),_0x7296b8+=_0x369977(0x225),_0x7296b8+='<table>',_0x7296b8+=_0xb1b440,_0x7296b8+=_0x369977(0x1da),_0x7296b8+='</div>',_0x7296b8+=_0x369977(0x250);const _0x5b1b8f={'format':_0x369977(0x19a),'orientation':_0x369977(0x22c)};pdf[_0x369977(0x16b)](_0x7296b8,_0x5b1b8f)[_0x369977(0x227)](function(_0x406f41,_0xa037db){const _0x48cba3=_0x369977;if(_0x406f41){_0x58f7a3[_0x48cba3(0x172)](0x1f4)[_0x48cba3(0x1cc)](_0x48cba3(0x1ba));return;}_0x58f7a3['setHeader']('Content-Type','application/pdf'),_0xa037db['pipe'](_0x58f7a3);});}),router[a0_0x279c9d(0x20f)](a0_0x279c9d(0x150),auth,async(_0x24f6fc,_0x18c11c)=>{const _0x5c7cba=a0_0x279c9d;try{const {username:_0x1a6818,email:_0x206a87,role:_0x218fc2}=_0x24f6fc[_0x5c7cba(0x18e)],_0x32679e=_0x24f6fc[_0x5c7cba(0x18e)],_0xf89b29=await profile[_0x5c7cba(0x1b4)]({'email':_0x32679e[_0x5c7cba(0x1ce)]}),_0x5f02c5={'year':_0x5c7cba(0x19f),'month':_0x5c7cba(0x224),'day':_0x5c7cba(0x19f)},_0x4756e7=await master_shop['find'](),_0x1aeb40=await staff[_0x5c7cba(0x1b4)]({'email':_0x32679e['email']}),_0x3d4af5=await product[_0x5c7cba(0x220)](),_0x112e09=await warehouse[_0x5c7cba(0x226)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x5c7cba(0x14d),'localField':'product_details.product_name','foreignField':_0x5c7cba(0x136),'as':_0x5c7cba(0x151)}},{'$unwind':_0x5c7cba(0x1f5)},{'$project':{'product_name':_0x5c7cba(0x256),'product_stock':_0x5c7cba(0x135)}},{'$group':{'_id':_0x5c7cba(0x211),'product_stock':{'$sum':_0x5c7cba(0x156)}}}]),_0x1dc302=await staff[_0x5c7cba(0x220)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x4756e7[0x0]['language']==_0x5c7cba(0x154))var _0x46d92f=users['English'];else{if(_0x4756e7[0x0][_0x5c7cba(0x209)]==_0x5c7cba(0x185))var _0x46d92f=users[_0x5c7cba(0x185)];else{if(_0x4756e7[0x0][_0x5c7cba(0x209)]=='German')var _0x46d92f=users[_0x5c7cba(0x24a)];else{if(_0x4756e7[0x0][_0x5c7cba(0x209)]==_0x5c7cba(0x237))var _0x46d92f=users['Spanish'];else{if(_0x4756e7[0x0]['language']=='French')var _0x46d92f=users[_0x5c7cba(0x216)];else{if(_0x4756e7[0x0][_0x5c7cba(0x209)]==_0x5c7cba(0x21b))var _0x46d92f=users['Portuguese'];else{if(_0x4756e7[0x0][_0x5c7cba(0x209)]==_0x5c7cba(0x1f1))var _0x46d92f=users[_0x5c7cba(0x1f1)];else{if(_0x4756e7[0x0][_0x5c7cba(0x209)]==_0x5c7cba(0x1ec))var _0x46d92f=users[_0x5c7cba(0x140)];}}}}}}}_0x18c11c[_0x5c7cba(0x11d)](_0x5c7cba(0x167),{'success':_0x24f6fc[_0x5c7cba(0x215)](_0x5c7cba(0x13c)),'errors':_0x24f6fc[_0x5c7cba(0x215)](_0x5c7cba(0x13a)),'alldata':_0x3d4af5,'profile':_0xf89b29,'master_shop':_0x4756e7,'role':_0x32679e,'product_stock':_0x112e09,'language':_0x46d92f,'staff_arr':_0x1aeb40,'staff_data_all':_0x1dc302});}catch(_0x412732){_0x18c11c[_0x5c7cba(0x1bb)](_0x412732);}});function a0_0x1029(_0x3d398f,_0x326f3d){const _0x1186dd=a0_0x1186();return a0_0x1029=function(_0x1029c0,_0x180f46){_0x1029c0=_0x1029c0-0xe9;let _0x35daae=_0x1186dd[_0x1029c0];return _0x35daae;},a0_0x1029(_0x3d398f,_0x326f3d);}async function agentsdataDSICheck_admin(_0x44771a,_0x33e20a,_0x3d47fa,_0x36d754){const _0x2f6c66=a0_0x279c9d,_0x44c1ec=await product[_0x2f6c66(0x226)]([{'$group':{'_id':{'brand':'$brand','category':_0x2f6c66(0x15a)},'products':{'$push':{'name':'$name','product_code':_0x2f6c66(0x1cd)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1fd36f=[];_0x1fd36f[_0x2f6c66(0x26c)]=[];for(let _0x5d9e26=0x0;_0x5d9e26<=_0x44c1ec['length']-0x1;_0x5d9e26++){const _0x116bce=_0x44c1ec[_0x5d9e26];_0x1fd36f[_0x2f6c66(0x26c)][_0x2f6c66(0x19e)](_0x116bce);}const _0x2bb5d7=await product[_0x2f6c66(0x226)]([{'$group':{'_id':{'category':_0x2f6c66(0x15a)},'products':{'$push':{'brand':_0x2f6c66(0x125),'product_code':'$product_code','product_name':_0x2f6c66(0x253)}}}},{'$sort':{'_id.category':-0x1}}]),_0x589fb0=await product[_0x2f6c66(0x226)]([{'$group':{'_id':{'category':_0x2f6c66(0x15a),'brand':'$brand'}}},{'$group':{'_id':_0x2f6c66(0x1f3),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xd2f4d9=await sales_sa[_0x2f6c66(0x226)]([{'$match':{'date':{'$gte':_0x44771a,'$lte':_0x33e20a},'sales_staff_id':_0x3d47fa,'sale_product.isFG':_0x2f6c66(0x26f)}},{'$unwind':_0x2f6c66(0x1ee)},{'$match':{'sale_product.isFG':_0x2f6c66(0x26f)}},{'$lookup':{'from':_0x2f6c66(0x14d),'localField':_0x2f6c66(0x1ab),'foreignField':'product_code','as':_0x2f6c66(0x25a)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x2f6c66(0x188)},'products':{'$push':{'qty':_0x2f6c66(0x188),'NetPrice':_0x2f6c66(0x11c),'discount':'$sale_product.discount','adj_discount':_0x2f6c66(0x1e1),'product_details':{'prod_name':_0x2f6c66(0x199),'product_code':'$product_info.product_code','category':'$product_info.category','brand':_0x2f6c66(0x252),'gross_price':_0x2f6c66(0x17a)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x2f6c66(0x181),'date':_0x2f6c66(0xea),'customer':_0x2f6c66(0x12a),'category':'$products.product_details.category','brand':_0x2f6c66(0x25e)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x2f6c66(0x213),_0x2f6c66(0x16f)]}},'NetPrice':{'$sum':_0x2f6c66(0x270)},'discount':{'$sum':_0x2f6c66(0x17c)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x2f6c66(0x181),'date':'$_id.date','customer':_0x2f6c66(0x12a)},'totalQty':{'$sum':_0x2f6c66(0x14c)},'totalGross':{'$sum':_0x2f6c66(0x1b1)},'NetPrice':{'$sum':_0x2f6c66(0x1f6)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x2f6c66(0x1ea)},'products':{'$push':{'qty':_0x2f6c66(0x14c),'category':_0x2f6c66(0x1f3),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x425ff9=[],_0x1f93c7={},_0x13ade2={},_0x2c4120={};var _0x2f7d2a=0x0,_0x2bf322=0x0,_0x4bd111=0x0,_0x2fa628=0x0,_0x524645=0x0;const _0x2f9d43=0x6;for(let _0x372b3d=0x0;_0x372b3d<=_0xd2f4d9['length']-0x1;_0x372b3d++){const _0x25241e=_0xd2f4d9[_0x372b3d];let _0x1de77d=_0x2f6c66(0x1c0);_0x1de77d+=_0x2f6c66(0x242)+_0x25241e[_0x2f6c66(0x176)][_0x2f6c66(0xf0)]+'</td>',_0x1de77d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x25241e[_0x2f6c66(0x176)]['date']+_0x2f6c66(0x146),_0x1de77d+=_0x2f6c66(0x242)+_0x25241e[_0x2f6c66(0x176)][_0x2f6c66(0x21f)]+_0x2f6c66(0x146);let _0x17013b={};var _0x5dc4b9=0x0;for(let _0xc7b572=0x0;_0xc7b572<=_0x25241e[_0x2f6c66(0x14d)]['length']-0x1;_0xc7b572++){const _0x5697ab=_0x25241e[_0x2f6c66(0x14d)][_0xc7b572];_0x17013b[_0x5697ab['brand']+'-'+_0x5697ab[_0x2f6c66(0x21e)]]=_0x5697ab[_0x2f6c66(0x131)];const _0x1b0c68=_0x5697ab[_0x2f6c66(0x148)]+'-'+_0x5697ab[_0x2f6c66(0x21e)];!_0x1f93c7[_0x1b0c68]&&(_0x1f93c7[_0x1b0c68]=0x0),!Array[_0x2f6c66(0x245)](_0x2c4120[_0x1b0c68])&&(_0x2c4120[_0x1b0c68]=[]),!Array[_0x2f6c66(0x245)](_0x2c4120[_0x1b0c68])&&(_0x2c4120[_0x1b0c68]=[]),_0x1f93c7[_0x1b0c68]+=_0x5697ab[_0x2f6c66(0x131)],_0x2c4120[_0x1b0c68][_0x2f6c66(0x19e)](_0x5697ab['qty']),_0x5dc4b9++;}console[_0x2f6c66(0x218)](_0x25241e);for(let _0x3992ee=0x0;_0x3992ee<=_0x1fd36f[_0x2f6c66(0x26c)][_0x2f6c66(0x10b)]-0x1;_0x3992ee++){const _0x5cba63=_0x1fd36f[_0x2f6c66(0x26c)][_0x3992ee],_0x201b8d=_0x5cba63['_id'][_0x2f6c66(0x148)]+'-'+_0x5cba63[_0x2f6c66(0x176)][_0x2f6c66(0x21e)];_0x1de77d+=_0x2f6c66(0x22f)+(_0x17013b[_0x201b8d]!==undefined?_0x17013b[_0x201b8d]['toFixed'](0x2):'')+_0x2f6c66(0x146);}_0x4bd111=_0x25241e[_0x2f6c66(0x1c4)]+_0x25241e['adj_discount'],_0x1de77d+=_0x2f6c66(0x23c)+formatNumber(parseFloat(_0x25241e[_0x2f6c66(0x178)],0x2)['toFixed'](0x2))+'</td>',_0x1de77d+=_0x2f6c66(0x23c)+formatNumber(_0x25241e[_0x2f6c66(0x1fc)][_0x2f6c66(0x141)](0x2))+'</td>',_0x1de77d+=_0x2f6c66(0x23c)+formatNumber(_0x4bd111)+_0x2f6c66(0x146),_0x1de77d+=_0x2f6c66(0x23c)+formatNumber(_0x25241e[_0x2f6c66(0x262)]['toFixed'](0x2))+_0x2f6c66(0x146),_0x1de77d+='</tr>',_0x2f7d2a+=parseFloat(_0x25241e[_0x2f6c66(0x178)][_0x2f6c66(0x141)](0x2)),_0x2bf322+=parseFloat(_0x25241e[_0x2f6c66(0x262)][_0x2f6c66(0x141)](0x2)),_0x2fa628+=_0x4bd111,_0x524645+=parseFloat(_0x25241e['totalGross'][_0x2f6c66(0x141)](0x2));if(_0x372b3d==_0xd2f4d9['length']-0x1){_0x1de77d+=_0x2f6c66(0x1c0),_0x1de77d+=_0x2f6c66(0x1e7),_0x1de77d+=_0x2f6c66(0x146);for(let _0x34c6c5=0x0;_0x34c6c5<=_0x1fd36f[_0x2f6c66(0x26c)]['length']-0x1;_0x34c6c5++){const _0x397387=_0x1fd36f[_0x2f6c66(0x26c)][_0x34c6c5],_0x564ef5=_0x397387[_0x2f6c66(0x176)][_0x2f6c66(0x148)]+'-'+_0x397387[_0x2f6c66(0x176)][_0x2f6c66(0x21e)],_0x4dea7c=_0x2c4120[_0x564ef5][_0x2f6c66(0x13b)]((_0x43df2b,_0xa71a42)=>_0x43df2b+_0xa71a42,0x0);console[_0x2f6c66(0x218)](_0x2f6c66(0x103),_0x564ef5),_0x1de77d+=_0x2f6c66(0x1bf)+(_0x4dea7c!==undefined?formatNumber(_0x4dea7c[_0x2f6c66(0x141)](0x2)):'')+_0x2f6c66(0x184),console[_0x2f6c66(0x218)](_0x2c4120[_0x564ef5][_0x2f6c66(0x13b)]((_0x1287d9,_0x29b55f)=>_0x1287d9+_0x29b55f,0x0));}_0x1de77d+=_0x2f6c66(0x18a)+formatNumber(_0x2f7d2a[_0x2f6c66(0x141)](0x2))+_0x2f6c66(0x184),_0x1de77d+=_0x2f6c66(0x18a)+formatNumber(_0x524645)+_0x2f6c66(0x184),_0x1de77d+=_0x2f6c66(0x18a)+formatNumber(_0x2fa628)+'</b></td>',_0x1de77d+=_0x2f6c66(0x18a)+formatNumber(_0x2bf322)+_0x2f6c66(0x184),_0x1de77d+=_0x2f6c66(0x1b6);}_0x425ff9[_0x2f6c66(0x19e)](_0x1de77d);}function _0x2ab80b(_0x2528b0,_0x48b1db){const _0x1f682d=_0x2f6c66,_0x100663=[];for(let _0x22968a=0x0;_0x22968a<=_0x2528b0['length']-0x1;_0x22968a+=_0x48b1db){_0x100663[_0x1f682d(0x19e)](_0x2528b0['slice'](_0x22968a,_0x22968a+_0x48b1db));}return _0x100663;}const _0x3193e1=_0x2ab80b(_0x425ff9,_0x2f9d43);let _0x3e08d4='';return _0x3193e1[_0x2f6c66(0x149)]((_0x5f3765,_0x143082)=>{const _0x30ceb8=_0x2f6c66;_0x143082>0x0&&(_0x3e08d4+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x3e08d4+=_0x30ceb8(0x26d),_0x3e08d4+=_0x30ceb8(0xec),_0x3e08d4+='<tr>',_0x3e08d4+=_0x30ceb8(0x1b8),_0x3e08d4+=_0x30ceb8(0x1b6),_0x3e08d4+=_0x30ceb8(0x1c0),_0x3e08d4+=_0x30ceb8(0x247);for(let _0x5bf197=0x0;_0x5bf197<=_0x2bb5d7['length']-0x1;_0x5bf197++){const _0x272cba=_0x2bb5d7[_0x5bf197];for(let _0x56a5ae=0x0;_0x56a5ae<_0x589fb0[_0x30ceb8(0x10b)];_0x56a5ae++){const _0x2bb4cf=_0x589fb0[_0x56a5ae];_0x2bb4cf[_0x30ceb8(0x176)]===_0x272cba[_0x30ceb8(0x176)][_0x30ceb8(0x21e)]&&(_0x3e08d4+=_0x30ceb8(0x1fe)+_0x2bb4cf[_0x30ceb8(0x243)]+_0x30ceb8(0x121)+_0x272cba[_0x30ceb8(0x176)]['category']+_0x30ceb8(0x146));}}_0x3e08d4+=_0x30ceb8(0x23a),_0x3e08d4+=_0x30ceb8(0x1b6),_0x3e08d4+='<tr>',_0x3e08d4+=_0x30ceb8(0x14e),_0x3e08d4+=_0x30ceb8(0x1f4),_0x3e08d4+=_0x30ceb8(0x1ca);for(let _0x33a9b1=0x0;_0x33a9b1<=_0x2bb5d7['length']-0x1;_0x33a9b1++){const _0x2f4ce3=_0x2bb5d7[_0x33a9b1];for(let _0x204706=0x0;_0x204706<_0x1fd36f[_0x30ceb8(0x26c)]['length'];_0x204706++){const _0x509e89=_0x1fd36f[_0x30ceb8(0x26c)][_0x204706];_0x509e89[_0x30ceb8(0x176)][_0x30ceb8(0x21e)]===_0x2f4ce3['_id']['category']&&(_0x3e08d4+='<td\x20class=\x22cat_data\x22>'+_0x509e89[_0x30ceb8(0x176)][_0x30ceb8(0x148)]+_0x30ceb8(0x146));}}_0x3e08d4+=_0x30ceb8(0x1a6),_0x3e08d4+=_0x30ceb8(0x15c),_0x3e08d4+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x3e08d4+=_0x30ceb8(0x1d4),_0x3e08d4+=_0x30ceb8(0x1b6),_0x3e08d4+=_0x30ceb8(0x25c),_0x3e08d4+=_0x30ceb8(0x1b2),_0x5f3765['forEach'](_0x51d590=>{_0x3e08d4+=_0x51d590;}),console['log'](_0x2c4120),_0x3e08d4+=_0x30ceb8(0x115),_0x3e08d4+='</table>';}),_0x3e08d4;}async function agentsdataDSICheck_admin_excel(_0x51793a,_0x1f1ed1,_0x326305,_0x37df9d){const _0x287bfd=a0_0x279c9d,_0x31cf59=await product[_0x287bfd(0x226)]([{'$group':{'_id':{'brand':'$brand','category':_0x287bfd(0x15a)},'products':{'$push':{'name':_0x287bfd(0x253),'product_code':_0x287bfd(0x1cd)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x26bc4a=[];_0x26bc4a[_0x287bfd(0x26c)]=[];for(let _0x445508=0x0;_0x445508<=_0x31cf59[_0x287bfd(0x10b)]-0x1;_0x445508++){const _0x2ba829=_0x31cf59[_0x445508];_0x26bc4a[_0x287bfd(0x26c)][_0x287bfd(0x19e)](_0x2ba829);}const _0x43f7e9=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0x287bfd(0x1cd),'product_name':_0x287bfd(0x253)}}}},{'$sort':{'_id.category':-0x1}}]),_0x161a4b=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0x287bfd(0x125)}}},{'$group':{'_id':_0x287bfd(0x1f3),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x35d53a=await sales_sa[_0x287bfd(0x226)]([{'$match':{'date':{'$gte':_0x51793a,'$lte':_0x1f1ed1},'sales_staff_id':_0x326305,'sale_product.isFG':'false'}},{'$unwind':_0x287bfd(0x1ee)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x287bfd(0x14d),'localField':_0x287bfd(0x1ab),'foreignField':_0x287bfd(0x164),'as':_0x287bfd(0x25a)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x287bfd(0x207),'date':_0x287bfd(0x12d),'customer':_0x287bfd(0x1f7)},'totalQty':{'$sum':_0x287bfd(0x188)},'products':{'$push':{'qty':_0x287bfd(0x188),'NetPrice':_0x287bfd(0x11c),'discount':_0x287bfd(0x106),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x287bfd(0x199),'product_code':_0x287bfd(0xee),'category':_0x287bfd(0xf2),'brand':_0x287bfd(0x252),'gross_price':_0x287bfd(0x17a)}}}}},{'$unwind':_0x287bfd(0x21a)},{'$group':{'_id':{'dsi':_0x287bfd(0x181),'date':_0x287bfd(0xea),'customer':'$_id.customer','category':_0x287bfd(0x244),'brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x287bfd(0x16f)]}},'NetPrice':{'$sum':_0x287bfd(0x270)},'discount':{'$sum':_0x287bfd(0x17c)},'adj_discount':{'$sum':_0x287bfd(0x1ed)},'product_details':{'$first':_0x287bfd(0x113)}}},{'$group':{'_id':{'dsi':_0x287bfd(0x181),'date':_0x287bfd(0xea),'customer':'$_id.customer'},'totalQty':{'$sum':_0x287bfd(0x14c)},'totalGross':{'$sum':_0x287bfd(0x1b1)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x287bfd(0x1fa)},'adj_discount':{'$sum':_0x287bfd(0x1ea)},'products':{'$push':{'qty':'$totalQty','category':_0x287bfd(0x1f3),'brand':'$_id.brand','product_details':_0x287bfd(0x251)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4dbbdf=[],_0x291a3d={},_0x2c8ebd={},_0x4a44ff={};var _0x2c4d87=0x0,_0x2673c3=0x0,_0x55e5af=0x0,_0x2b240a=0x0,_0x538efe=0x0;const _0x183864=0x16345785d8a0000;for(let _0xe42ef2=0x0;_0xe42ef2<=_0x35d53a[_0x287bfd(0x10b)]-0x1;_0xe42ef2++){const _0x496dbc=_0x35d53a[_0xe42ef2];let _0x23e5ae=_0x287bfd(0x1c0);_0x23e5ae+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x496dbc[_0x287bfd(0x176)][_0x287bfd(0xf0)]+_0x287bfd(0x146),_0x23e5ae+=_0x287bfd(0x242)+_0x496dbc[_0x287bfd(0x176)][_0x287bfd(0x258)]+_0x287bfd(0x146),_0x23e5ae+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x496dbc[_0x287bfd(0x176)][_0x287bfd(0x21f)]+_0x287bfd(0x146);let _0x12c3b0={};var _0x2be794=0x0;for(let _0x452abb=0x0;_0x452abb<=_0x496dbc[_0x287bfd(0x14d)][_0x287bfd(0x10b)]-0x1;_0x452abb++){const _0x11e0a6=_0x496dbc['products'][_0x452abb];_0x12c3b0[_0x11e0a6[_0x287bfd(0x148)]+'-'+_0x11e0a6[_0x287bfd(0x21e)]]=_0x11e0a6[_0x287bfd(0x131)];const _0x55002e=_0x11e0a6[_0x287bfd(0x148)]+'-'+_0x11e0a6[_0x287bfd(0x21e)];!_0x291a3d[_0x55002e]&&(_0x291a3d[_0x55002e]=0x0),!Array['isArray'](_0x4a44ff[_0x55002e])&&(_0x4a44ff[_0x55002e]=[]),!Array['isArray'](_0x4a44ff[_0x55002e])&&(_0x4a44ff[_0x55002e]=[]),_0x291a3d[_0x55002e]+=_0x11e0a6['qty'],_0x4a44ff[_0x55002e][_0x287bfd(0x19e)](_0x11e0a6[_0x287bfd(0x131)]),_0x2be794++;}console[_0x287bfd(0x218)](_0x496dbc);for(let _0xe9a1b4=0x0;_0xe9a1b4<=_0x26bc4a[_0x287bfd(0x26c)]['length']-0x1;_0xe9a1b4++){const _0x26dfac=_0x26bc4a[_0x287bfd(0x26c)][_0xe9a1b4],_0x642387=_0x26dfac[_0x287bfd(0x176)]['brand']+'-'+_0x26dfac[_0x287bfd(0x176)][_0x287bfd(0x21e)];_0x23e5ae+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x12c3b0[_0x642387]!==undefined?_0x12c3b0[_0x642387]['toFixed'](0x2):'')+_0x287bfd(0x146);}_0x55e5af=_0x496dbc[_0x287bfd(0x1c4)]+_0x496dbc[_0x287bfd(0x212)],_0x23e5ae+=_0x287bfd(0x23c)+formatNumber(parseFloat(_0x496dbc[_0x287bfd(0x178)],0x2)[_0x287bfd(0x141)](0x2))+_0x287bfd(0x146),_0x23e5ae+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x496dbc[_0x287bfd(0x1fc)][_0x287bfd(0x141)](0x2))+_0x287bfd(0x146),_0x23e5ae+=_0x287bfd(0x23c)+formatNumber(_0x55e5af)+_0x287bfd(0x146),_0x23e5ae+=_0x287bfd(0x23c)+formatNumber(_0x496dbc[_0x287bfd(0x262)][_0x287bfd(0x141)](0x2))+_0x287bfd(0x146),_0x23e5ae+=_0x287bfd(0x1b6),_0x2c4d87+=parseFloat(_0x496dbc['totalQty'][_0x287bfd(0x141)](0x2)),_0x2673c3+=parseFloat(_0x496dbc[_0x287bfd(0x262)][_0x287bfd(0x141)](0x2)),_0x2b240a+=_0x55e5af,_0x538efe+=parseFloat(_0x496dbc[_0x287bfd(0x1fc)]['toFixed'](0x2));if(_0xe42ef2==_0x35d53a['length']-0x1){_0x23e5ae+=_0x287bfd(0x1c0),_0x23e5ae+=_0x287bfd(0x1e7),_0x23e5ae+=_0x287bfd(0x146);for(let _0x51b790=0x0;_0x51b790<=_0x26bc4a[_0x287bfd(0x26c)][_0x287bfd(0x10b)]-0x1;_0x51b790++){const _0x548ce1=_0x26bc4a['cat_brand'][_0x51b790],_0x45e4f5=_0x548ce1[_0x287bfd(0x176)]['brand']+'-'+_0x548ce1[_0x287bfd(0x176)][_0x287bfd(0x21e)],_0xbae64c=_0x4a44ff[_0x45e4f5][_0x287bfd(0x13b)]((_0x9ae9aa,_0x2f81ee)=>_0x9ae9aa+_0x2f81ee,0x0);console[_0x287bfd(0x218)](_0x287bfd(0x103),_0x45e4f5),_0x23e5ae+=_0x287bfd(0x1bf)+(_0xbae64c!==undefined?formatNumber(_0xbae64c['toFixed'](0x2)):'')+_0x287bfd(0x184),console[_0x287bfd(0x218)](_0x4a44ff[_0x45e4f5][_0x287bfd(0x13b)]((_0x33d857,_0xa75f71)=>_0x33d857+_0xa75f71,0x0));}_0x23e5ae+=_0x287bfd(0x18a)+formatNumber(_0x2c4d87[_0x287bfd(0x141)](0x2))+_0x287bfd(0x184),_0x23e5ae+=_0x287bfd(0x18a)+formatNumber(_0x538efe)+_0x287bfd(0x184),_0x23e5ae+=_0x287bfd(0x18a)+formatNumber(_0x2b240a)+_0x287bfd(0x184),_0x23e5ae+=_0x287bfd(0x18a)+formatNumber(_0x2673c3)+_0x287bfd(0x184),_0x23e5ae+=_0x287bfd(0x1b6);}_0x4dbbdf[_0x287bfd(0x19e)](_0x23e5ae);}function _0x2ba86c(_0x5e0238,_0x7e3802){const _0x20afee=_0x287bfd,_0x32e7b5=[];for(let _0x54de99=0x0;_0x54de99<=_0x5e0238[_0x20afee(0x10b)]-0x1;_0x54de99+=_0x7e3802){_0x32e7b5[_0x20afee(0x19e)](_0x5e0238['slice'](_0x54de99,_0x54de99+_0x7e3802));}return _0x32e7b5;}const _0x2c7b45=_0x2ba86c(_0x4dbbdf,_0x183864);let _0x1c942a='';return _0x2c7b45[_0x287bfd(0x149)]((_0x1691fe,_0x26c2ff)=>{const _0x47dd75=_0x287bfd;_0x26c2ff>0x0&&(_0x1c942a+=_0x47dd75(0x1cf));_0x1c942a+=_0x47dd75(0x26d),_0x1c942a+=_0x47dd75(0xec),_0x1c942a+=_0x47dd75(0x1c0),_0x1c942a+=_0x47dd75(0x1b8),_0x1c942a+=_0x47dd75(0x1b6),_0x1c942a+=_0x47dd75(0x1c0),_0x1c942a+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x129768=0x0;_0x129768<=_0x43f7e9[_0x47dd75(0x10b)]-0x1;_0x129768++){const _0x134027=_0x43f7e9[_0x129768];for(let _0x7021f0=0x0;_0x7021f0<_0x161a4b['length'];_0x7021f0++){const _0x2c44a6=_0x161a4b[_0x7021f0];_0x2c44a6[_0x47dd75(0x176)]===_0x134027['_id'][_0x47dd75(0x21e)]&&(_0x1c942a+=_0x47dd75(0x1fe)+_0x2c44a6[_0x47dd75(0x243)]+'\x22\x20class=\x22cat_data\x22>'+_0x134027[_0x47dd75(0x176)]['category']+_0x47dd75(0x146));}}_0x1c942a+=_0x47dd75(0x23a),_0x1c942a+='</tr>',_0x1c942a+='<tr>',_0x1c942a+=_0x47dd75(0x14e),_0x1c942a+=_0x47dd75(0x1f4),_0x1c942a+=_0x47dd75(0x1ca);for(let _0x55dd14=0x0;_0x55dd14<=_0x43f7e9['length']-0x1;_0x55dd14++){const _0x117fdc=_0x43f7e9[_0x55dd14];for(let _0x56e301=0x0;_0x56e301<_0x26bc4a[_0x47dd75(0x26c)]['length'];_0x56e301++){const _0x211efa=_0x26bc4a[_0x47dd75(0x26c)][_0x56e301];_0x211efa[_0x47dd75(0x176)][_0x47dd75(0x21e)]===_0x117fdc[_0x47dd75(0x176)][_0x47dd75(0x21e)]&&(_0x1c942a+=_0x47dd75(0x267)+_0x211efa[_0x47dd75(0x176)][_0x47dd75(0x148)]+'</td>');}}_0x1c942a+=_0x47dd75(0x1a6),_0x1c942a+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x1c942a+=_0x47dd75(0x25d),_0x1c942a+=_0x47dd75(0x1d4),_0x1c942a+=_0x47dd75(0x1b6),_0x1c942a+=_0x47dd75(0x25c),_0x1c942a+='<tbody>',_0x1691fe['forEach'](_0x195cf0=>{_0x1c942a+=_0x195cf0;}),console['log'](_0x4a44ff),_0x1c942a+='</tbody>',_0x1c942a+='</table>';}),_0x1c942a;}router[a0_0x279c9d(0x205)](a0_0x279c9d(0x222),auth,async(_0x3381c9,_0x4b4556)=>{const _0x31f29f=a0_0x279c9d,{from_date:_0x1495c3,to_date:_0x396c94,isExcel:_0x5d590d,agent_id:_0x7df2e4}=_0x3381c9['body'],_0x291ef5=_0x3381c9['user'],_0x3e9fb7=await staff[_0x31f29f(0x1b4)]({'email':_0x291ef5[_0x31f29f(0x1ce)]}),_0x4b6137=await master_shop[_0x31f29f(0x220)](),_0x44a2a9=await agentsdataDSICheck_admin(_0x1495c3,_0x396c94,_0x7df2e4,_0x5d590d),_0x3a9d80=await agentsdataDSICheck_admin_excel(_0x1495c3,_0x396c94,_0x7df2e4,_0x5d590d);let _0x2ba8e1=_0x31f29f(0x1c2);var _0x5479b7=new Date(_0x1495c3),_0x37ac88=new Date(_0x396c94);const _0x41a354={'year':'numeric','month':_0x31f29f(0x224),'day':_0x31f29f(0x19f)},_0x48e33d=new Intl[(_0x31f29f(0x223))](_0x31f29f(0x158),_0x41a354)[_0x31f29f(0x20c)](_0x5479b7),_0x593466=new Intl[(_0x31f29f(0x223))]('en-US',_0x41a354)['format'](_0x37ac88);_0x2ba8e1+=_0x31f29f(0x1dd),_0x2ba8e1+='<div\x20\x20id=\x22table-conatainer\x22>',_0x2ba8e1+=_0x31f29f(0x26d),_0x2ba8e1+=_0x44a2a9,_0x2ba8e1+=_0x31f29f(0x1da),_0x2ba8e1+=_0x31f29f(0x250),_0x2ba8e1+=_0x31f29f(0x250);let _0xfb947a=_0x31f29f(0x1c2);_0xfb947a+=_0x31f29f(0x1dd),_0xfb947a+='<div\x20\x20id=\x22table-conatainer\x22>',_0xfb947a+=_0x31f29f(0x26d),_0xfb947a+=_0x3a9d80,_0xfb947a+=_0x31f29f(0x1da),_0xfb947a+=_0x31f29f(0x250),_0xfb947a+='</div>';let _0x2e7d03='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x17b6ad={'width':'15in','height':_0x31f29f(0x18f),'orientation':_0x31f29f(0x22c),'border':{'top':_0x31f29f(0x249),'right':'0.1in','bottom':_0x31f29f(0x249),'left':_0x31f29f(0x249)},'header':{'height':_0x31f29f(0x104),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x2e7d03+_0x31f29f(0x20e)+_0x48e33d+_0x31f29f(0x182)+_0x593466+_0x31f29f(0x163)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x5d590d=='on'){const _0x5929c2=cheerio[_0x31f29f(0x1ad)](_0xfb947a);let _0xc98cca=[],_0x131436=[],_0x132f66=[];_0x5929c2('table\x20tr')[_0x31f29f(0x189)]((_0x32bee4,_0x3bd80a)=>{const _0x4fec3e=_0x31f29f;let _0x190225=[],_0x350499=0x0;while(_0x132f66[_0x350499]){_0x132f66[_0x350499]--,_0x350499++;}_0x5929c2(_0x3bd80a)[_0x4fec3e(0x220)](_0x4fec3e(0x20d))[_0x4fec3e(0x189)]((_0x1fe2da,_0x2ff21a)=>{const _0x2f9033=_0x4fec3e;let _0x76a10d=_0x5929c2(_0x2ff21a)[_0x2f9033(0x1ff)]()['trim'](),_0x23c82b=parseFloat(_0x76a10d[_0x2f9033(0x22d)](/,/g,''));isNaN(_0x23c82b)&&(_0x23c82b=_0x76a10d);let _0x1eaf84=parseInt(_0x5929c2(_0x2ff21a)['attr']('colspan'))||0x1,_0x4a2e66=parseInt(_0x5929c2(_0x2ff21a)['attr']('rowspan'))||0x1;_0x190225[_0x350499]=_0x23c82b;(_0x1eaf84>0x1||_0x4a2e66>0x1)&&_0x131436[_0x2f9033(0x19e)]({'s':{'r':_0x32bee4,'c':_0x350499},'e':{'r':_0x32bee4+_0x4a2e66-0x1,'c':_0x350499+_0x1eaf84-0x1}});for(let _0xb7050=0x0;_0xb7050<_0x1eaf84;_0xb7050++){_0x4a2e66>0x1&&(_0x132f66[_0x350499+_0xb7050]=_0x4a2e66-0x1);}_0x350499+=_0x1eaf84;}),_0xc98cca['push'](_0x190225);});const _0x1a59a4=XLSX[_0x31f29f(0xfb)]['book_new'](),_0x41d701=XLSX['utils'][_0x31f29f(0x26e)](_0xc98cca);_0x131436[_0x31f29f(0x10b)]>0x0&&(_0x41d701['!merges']=_0x131436);_0x41d701[_0x31f29f(0x22a)]=_0xc98cca[0x0][_0x31f29f(0x25b)](()=>({'wpx':0x64})),XLSX[_0x31f29f(0xfb)]['book_append_sheet'](_0x1a59a4,_0x41d701,_0x31f29f(0x1a7));const _0x58b51d=XLSX[_0x31f29f(0x165)](_0x1a59a4,{'bookType':'xlsx','type':_0x31f29f(0x228)});_0x4b4556[_0x31f29f(0x1df)](_0x31f29f(0x139),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x4b4556[_0x31f29f(0x1df)](_0x31f29f(0x10c),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x4b4556[_0x31f29f(0x1cc)](_0x58b51d);}else pdf[_0x31f29f(0x16b)](_0x2ba8e1,_0x17b6ad)[_0x31f29f(0x227)](function(_0x34676f,_0x33a4d7){const _0x37fe62=_0x31f29f;if(_0x34676f){_0x4b4556[_0x37fe62(0x172)](0x1f4)[_0x37fe62(0x1cc)](_0x37fe62(0x1ba));return;}_0x4b4556['setHeader']('Content-Type',_0x37fe62(0x1a4)),_0x33a4d7[_0x37fe62(0x17f)](_0x4b4556);});}),router[a0_0x279c9d(0x20f)](a0_0x279c9d(0xfd),auth,async(_0x1a7aaa,_0x30ed5c)=>{const _0x35a499=a0_0x279c9d;try{const {username:_0x222d08,email:_0x2716ce,role:_0x58fbde}=_0x1a7aaa[_0x35a499(0x18e)],_0x1dc921=_0x1a7aaa[_0x35a499(0x18e)],_0x20fd08=await profile[_0x35a499(0x1b4)]({'email':_0x1dc921[_0x35a499(0x1ce)]}),_0x11b825={'year':'numeric','month':'long','day':_0x35a499(0x19f)},_0x519fb0=await master_shop[_0x35a499(0x220)](),_0x4e060a=await staff[_0x35a499(0x1b4)]({'email':_0x1dc921[_0x35a499(0x1ce)]}),_0x18899c=await product[_0x35a499(0x220)](),_0x3c0680=await warehouse[_0x35a499(0x226)]([{'$unwind':_0x35a499(0x251)},{'$lookup':{'from':_0x35a499(0x14d),'localField':_0x35a499(0x1a0),'foreignField':_0x35a499(0x136),'as':_0x35a499(0x151)}},{'$unwind':_0x35a499(0x1f5)},{'$project':{'product_name':_0x35a499(0x256),'product_stock':_0x35a499(0x135)}},{'$group':{'_id':_0x35a499(0x211),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x519fb0[0x0]['language']==_0x35a499(0x154))var _0xbd2f72=users[_0x35a499(0x1d7)];else{if(_0x519fb0[0x0][_0x35a499(0x209)]==_0x35a499(0x185))var _0xbd2f72=users[_0x35a499(0x185)];else{if(_0x519fb0[0x0][_0x35a499(0x209)]==_0x35a499(0x24a))var _0xbd2f72=users[_0x35a499(0x24a)];else{if(_0x519fb0[0x0][_0x35a499(0x209)]=='Spanish')var _0xbd2f72=users[_0x35a499(0x237)];else{if(_0x519fb0[0x0][_0x35a499(0x209)]==_0x35a499(0x216))var _0xbd2f72=users[_0x35a499(0x216)];else{if(_0x519fb0[0x0][_0x35a499(0x209)]==_0x35a499(0x21b))var _0xbd2f72=users['Portuguese'];else{if(_0x519fb0[0x0]['language']=='Chinese')var _0xbd2f72=users[_0x35a499(0x1f1)];else{if(_0x519fb0[0x0]['language']==_0x35a499(0x1ec))var _0xbd2f72=users[_0x35a499(0x140)];}}}}}}}_0x30ed5c[_0x35a499(0x11d)]('dsi_sales',{'success':_0x1a7aaa[_0x35a499(0x215)](_0x35a499(0x13c)),'errors':_0x1a7aaa['flash'](_0x35a499(0x13a)),'alldata':_0x18899c,'profile':_0x20fd08,'master_shop':_0x519fb0,'role':_0x1dc921,'product_stock':_0x3c0680,'language':_0xbd2f72,'staff_arr':_0x4e060a});}catch(_0x14423a){}});function formatNumber(_0x48129c,_0x235055='en-US',_0x1da9b1={'minimumFractionDigits':0x2}){const _0xa0bfb3=a0_0x279c9d,_0x4c9b89=new Intl[(_0xa0bfb3(0x236))](_0x235055,_0x1da9b1);return _0x4c9b89[_0xa0bfb3(0x20c)](_0x48129c);}async function agentsdataDSICheck(_0x38ddf9,_0xd558e7,_0x7e6da2,_0x43be7b){const _0x3d98fd=a0_0x279c9d,_0x2f23d1=await product[_0x3d98fd(0x226)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':_0x3d98fd(0x253),'product_code':_0x3d98fd(0x1cd)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5914ec=[];_0x5914ec[_0x3d98fd(0x26c)]=[];for(let _0x2a07a0=0x0;_0x2a07a0<=_0x2f23d1[_0x3d98fd(0x10b)]-0x1;_0x2a07a0++){const _0x5dd0c0=_0x2f23d1[_0x2a07a0];_0x5914ec[_0x3d98fd(0x26c)][_0x3d98fd(0x19e)](_0x5dd0c0);}const _0x1d2126=await product[_0x3d98fd(0x226)]([{'$group':{'_id':{'category':_0x3d98fd(0x15a)},'products':{'$push':{'brand':_0x3d98fd(0x125),'product_code':_0x3d98fd(0x1cd),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0xd2c9a4=await product['aggregate']([{'$group':{'_id':{'category':_0x3d98fd(0x15a),'brand':_0x3d98fd(0x125)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1cdf4e=await sales_sa[_0x3d98fd(0x226)]([{'$match':{'date':{'$gte':_0x38ddf9,'$lte':_0xd558e7},'sales_staff_id':_0x7e6da2,'sale_product.isFG':_0x3d98fd(0x26f)}},{'$unwind':_0x3d98fd(0x1ee)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x3d98fd(0x14d),'localField':_0x3d98fd(0x1ab),'foreignField':_0x3d98fd(0x164),'as':_0x3d98fd(0x25a)}},{'$unwind':_0x3d98fd(0x214)},{'$group':{'_id':{'dsi':_0x3d98fd(0x207),'date':_0x3d98fd(0x12d),'customer':_0x3d98fd(0x1f7)},'totalQty':{'$sum':_0x3d98fd(0x188)},'products':{'$push':{'qty':_0x3d98fd(0x188),'NetPrice':_0x3d98fd(0x11c),'discount':_0x3d98fd(0x106),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x3d98fd(0x199),'product_code':'$product_info.product_code','category':_0x3d98fd(0xf2),'brand':'$product_info.brand','gross_price':_0x3d98fd(0x17a)}}}}},{'$unwind':_0x3d98fd(0x21a)},{'$group':{'_id':{'dsi':_0x3d98fd(0x181),'date':_0x3d98fd(0xea),'customer':'$_id.customer','category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x3d98fd(0x213)},'totalGross':{'$sum':{'$multiply':[_0x3d98fd(0x213),_0x3d98fd(0x16f)]}},'NetPrice':{'$sum':_0x3d98fd(0x270)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x3d98fd(0x1ed)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x3d98fd(0x181),'date':'$_id.date','customer':_0x3d98fd(0x12a)},'totalQty':{'$sum':_0x3d98fd(0x14c)},'totalGross':{'$sum':_0x3d98fd(0x1b1)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x3d98fd(0x1fa)},'adj_discount':{'$sum':_0x3d98fd(0x1ea)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':'$_id.brand','product_details':_0x3d98fd(0x251)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x5e94b3=[],_0xb69858={},_0x3fdd07={},_0x177bb4={};var _0x12888b=0x0,_0x5cbddc=0x0,_0x564d28=0x0,_0x57a6a2=0x0,_0x4f1c32=0x0;const _0x29d552=0x6;for(let _0x1b01f7=0x0;_0x1b01f7<=_0x1cdf4e['length']-0x1;_0x1b01f7++){const _0x30930b=_0x1cdf4e[_0x1b01f7];let _0x46c904=_0x3d98fd(0x1c0);_0x46c904+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x30930b[_0x3d98fd(0x176)][_0x3d98fd(0xf0)]+_0x3d98fd(0x146),_0x46c904+=_0x3d98fd(0x242)+_0x30930b[_0x3d98fd(0x176)][_0x3d98fd(0x258)]+_0x3d98fd(0x146),_0x46c904+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x30930b['_id'][_0x3d98fd(0x21f)]+_0x3d98fd(0x146);let _0x474382={};var _0xcad5ff=0x0;for(let _0x3cb0c6=0x0;_0x3cb0c6<=_0x30930b['products'][_0x3d98fd(0x10b)]-0x1;_0x3cb0c6++){const _0x57ac28=_0x30930b[_0x3d98fd(0x14d)][_0x3cb0c6];_0x474382[_0x57ac28[_0x3d98fd(0x148)]+'-'+_0x57ac28[_0x3d98fd(0x21e)]]=_0x57ac28['qty'];const _0x43ddef=_0x57ac28['brand']+'-'+_0x57ac28[_0x3d98fd(0x21e)];!_0xb69858[_0x43ddef]&&(_0xb69858[_0x43ddef]=0x0),!Array[_0x3d98fd(0x245)](_0x177bb4[_0x43ddef])&&(_0x177bb4[_0x43ddef]=[]),!Array['isArray'](_0x177bb4[_0x43ddef])&&(_0x177bb4[_0x43ddef]=[]),_0xb69858[_0x43ddef]+=_0x57ac28[_0x3d98fd(0x131)],_0x177bb4[_0x43ddef][_0x3d98fd(0x19e)](_0x57ac28[_0x3d98fd(0x131)]),_0xcad5ff++;}console[_0x3d98fd(0x218)](_0x30930b);for(let _0x1465ab=0x0;_0x1465ab<=_0x5914ec[_0x3d98fd(0x26c)][_0x3d98fd(0x10b)]-0x1;_0x1465ab++){const _0x55448a=_0x5914ec['cat_brand'][_0x1465ab],_0x5b42d2=_0x55448a[_0x3d98fd(0x176)][_0x3d98fd(0x148)]+'-'+_0x55448a[_0x3d98fd(0x176)]['category'];_0x46c904+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x474382[_0x5b42d2]!==undefined?_0x474382[_0x5b42d2][_0x3d98fd(0x141)](0x2):'')+'</td>';}_0x564d28=_0x30930b[_0x3d98fd(0x1c4)]+_0x30930b['adj_discount'],_0x46c904+=_0x3d98fd(0x23c)+formatNumber(parseFloat(_0x30930b['totalQty'],0x2)['toFixed'](0x2))+_0x3d98fd(0x146),_0x46c904+=_0x3d98fd(0x23c)+formatNumber(_0x30930b[_0x3d98fd(0x1fc)][_0x3d98fd(0x141)](0x2))+'</td>',_0x46c904+=_0x3d98fd(0x23c)+formatNumber(_0x564d28)+_0x3d98fd(0x146),_0x46c904+=_0x3d98fd(0x23c)+formatNumber(_0x30930b[_0x3d98fd(0x262)][_0x3d98fd(0x141)](0x2))+_0x3d98fd(0x146),_0x46c904+=_0x3d98fd(0x1b6),_0x12888b+=parseFloat(_0x30930b['totalQty']['toFixed'](0x2)),_0x5cbddc+=parseFloat(_0x30930b['NetPrice'][_0x3d98fd(0x141)](0x2)),_0x57a6a2+=_0x564d28,_0x4f1c32+=parseFloat(_0x30930b[_0x3d98fd(0x1fc)][_0x3d98fd(0x141)](0x2));if(_0x1b01f7==_0x1cdf4e[_0x3d98fd(0x10b)]-0x1){_0x46c904+=_0x3d98fd(0x1c0),_0x46c904+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x46c904+=_0x3d98fd(0x146);for(let _0xf2ae99=0x0;_0xf2ae99<=_0x5914ec[_0x3d98fd(0x26c)][_0x3d98fd(0x10b)]-0x1;_0xf2ae99++){const _0x44db73=_0x5914ec[_0x3d98fd(0x26c)][_0xf2ae99],_0x5a554f=_0x44db73[_0x3d98fd(0x176)][_0x3d98fd(0x148)]+'-'+_0x44db73[_0x3d98fd(0x176)][_0x3d98fd(0x21e)],_0x385745=_0x177bb4[_0x5a554f][_0x3d98fd(0x13b)]((_0x18fba8,_0x2c7ee9)=>_0x18fba8+_0x2c7ee9,0x0);_0x46c904+=_0x3d98fd(0x1bf)+(_0x385745!==undefined?formatNumber(_0x385745[_0x3d98fd(0x141)](0x2)):'')+'</b></td>',console[_0x3d98fd(0x218)](_0x177bb4[_0x5a554f][_0x3d98fd(0x13b)]((_0x288f63,_0x6afcc)=>_0x288f63+_0x6afcc,0x0));}_0x46c904+=_0x3d98fd(0x18a)+formatNumber(_0x12888b[_0x3d98fd(0x141)](0x2))+'</b></td>',_0x46c904+=_0x3d98fd(0x18a)+formatNumber(_0x4f1c32)+_0x3d98fd(0x184),_0x46c904+=_0x3d98fd(0x18a)+formatNumber(_0x57a6a2)+'</b></td>',_0x46c904+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5cbddc)+'</b></td>',_0x46c904+=_0x3d98fd(0x1b6);}_0x5e94b3['push'](_0x46c904);}function _0xa2c614(_0x59eec9,_0xa65f2f){const _0x72ceea=_0x3d98fd,_0x5561e=[];for(let _0xf93882=0x0;_0xf93882<=_0x59eec9[_0x72ceea(0x10b)]-0x1;_0xf93882+=_0xa65f2f){_0x5561e[_0x72ceea(0x19e)](_0x59eec9[_0x72ceea(0x190)](_0xf93882,_0xf93882+_0xa65f2f));}return _0x5561e;}const _0x748d07=_0xa2c614(_0x5e94b3,_0x29d552);let _0x5a6565='';return _0x748d07[_0x3d98fd(0x149)]((_0x585e5d,_0x1f37c0)=>{const _0x2e6b6d=_0x3d98fd;_0x1f37c0>0x0&&(_0x5a6565+=_0x2e6b6d(0x1cf));_0x5a6565+='<table>',_0x5a6565+=_0x2e6b6d(0xec),_0x5a6565+=_0x2e6b6d(0x1c0),_0x5a6565+=_0x2e6b6d(0x1b8),_0x5a6565+='</tr>',_0x5a6565+='<tr>',_0x5a6565+=_0x2e6b6d(0x247);for(let _0x35187c=0x0;_0x35187c<=_0x1d2126[_0x2e6b6d(0x10b)]-0x1;_0x35187c++){const _0xa86daa=_0x1d2126[_0x35187c];for(let _0x1b3f49=0x0;_0x1b3f49<_0xd2c9a4['length'];_0x1b3f49++){const _0x5d6348=_0xd2c9a4[_0x1b3f49];_0x5d6348[_0x2e6b6d(0x176)]===_0xa86daa['_id'][_0x2e6b6d(0x21e)]&&(_0x5a6565+='<td\x20colspan=\x22'+_0x5d6348['brandCount']+_0x2e6b6d(0x121)+_0xa86daa[_0x2e6b6d(0x176)][_0x2e6b6d(0x21e)]+_0x2e6b6d(0x146));}}_0x5a6565+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x5a6565+='</tr>',_0x5a6565+=_0x2e6b6d(0x1c0),_0x5a6565+=_0x2e6b6d(0x14e),_0x5a6565+=_0x2e6b6d(0x1f4),_0x5a6565+=_0x2e6b6d(0x1ca);for(let _0x5502f8=0x0;_0x5502f8<=_0x1d2126[_0x2e6b6d(0x10b)]-0x1;_0x5502f8++){const _0x50c043=_0x1d2126[_0x5502f8];for(let _0x3623fa=0x0;_0x3623fa<_0x5914ec[_0x2e6b6d(0x26c)]['length'];_0x3623fa++){const _0x5a9681=_0x5914ec[_0x2e6b6d(0x26c)][_0x3623fa];_0x5a9681[_0x2e6b6d(0x176)]['category']===_0x50c043[_0x2e6b6d(0x176)][_0x2e6b6d(0x21e)]&&(_0x5a6565+='<td\x20class=\x22cat_data\x22>'+_0x5a9681[_0x2e6b6d(0x176)][_0x2e6b6d(0x148)]+_0x2e6b6d(0x146));}}_0x5a6565+=_0x2e6b6d(0x1a6),_0x5a6565+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x5a6565+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x5a6565+=_0x2e6b6d(0x1d4),_0x5a6565+=_0x2e6b6d(0x1b6),_0x5a6565+=_0x2e6b6d(0x25c),_0x5a6565+=_0x2e6b6d(0x1b2),_0x585e5d[_0x2e6b6d(0x149)](_0xe529b3=>{_0x5a6565+=_0xe529b3;}),console[_0x2e6b6d(0x218)](_0x177bb4),_0x5a6565+=_0x2e6b6d(0x115),_0x5a6565+=_0x2e6b6d(0x1da);}),_0x5a6565;}async function agentsdataDSICheck_excel(_0x3341df,_0x4a75ae,_0x360d23,_0x523016){const _0x403e54=a0_0x279c9d,_0x3a3fd4=await product[_0x403e54(0x226)]([{'$group':{'_id':{'brand':_0x403e54(0x125),'category':'$category'},'products':{'$push':{'name':_0x403e54(0x253),'product_code':_0x403e54(0x1cd)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x48d91b=[];_0x48d91b[_0x403e54(0x26c)]=[];for(let _0x4263f2=0x0;_0x4263f2<=_0x3a3fd4[_0x403e54(0x10b)]-0x1;_0x4263f2++){const _0x471f89=_0x3a3fd4[_0x4263f2];_0x48d91b[_0x403e54(0x26c)]['push'](_0x471f89);}const _0x1266a5=await product[_0x403e54(0x226)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0x403e54(0x253)}}}},{'$sort':{'_id.category':-0x1}}]),_0x34f4f8=await product[_0x403e54(0x226)]([{'$group':{'_id':{'category':_0x403e54(0x15a),'brand':_0x403e54(0x125)}}},{'$group':{'_id':_0x403e54(0x1f3),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x45cfc2=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3341df,'$lte':_0x4a75ae},'sales_staff_id':_0x360d23,'sale_product.isFG':_0x403e54(0x26f)}},{'$unwind':_0x403e54(0x1ee)},{'$match':{'sale_product.isFG':_0x403e54(0x26f)}},{'$lookup':{'from':_0x403e54(0x14d),'localField':_0x403e54(0x1ab),'foreignField':_0x403e54(0x164),'as':_0x403e54(0x25a)}},{'$unwind':_0x403e54(0x214)},{'$group':{'_id':{'dsi':_0x403e54(0x207),'date':_0x403e54(0x12d),'customer':_0x403e54(0x1f7)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x403e54(0x188),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':'$product_info.name','product_code':_0x403e54(0xee),'category':_0x403e54(0xf2),'brand':_0x403e54(0x252),'gross_price':_0x403e54(0x17a)}}}}},{'$unwind':_0x403e54(0x21a)},{'$group':{'_id':{'dsi':_0x403e54(0x181),'date':_0x403e54(0xea),'customer':'$_id.customer','category':_0x403e54(0x244),'brand':_0x403e54(0x25e)},'totalQty':{'$sum':_0x403e54(0x213)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x403e54(0x16f)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x403e54(0x17c)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x403e54(0x113)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x403e54(0xea),'customer':_0x403e54(0x12a)},'totalQty':{'$sum':_0x403e54(0x14c)},'totalGross':{'$sum':_0x403e54(0x1b1)},'NetPrice':{'$sum':_0x403e54(0x1f6)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x403e54(0x1ea)},'products':{'$push':{'qty':_0x403e54(0x14c),'category':_0x403e54(0x1f3),'brand':'$_id.brand','product_details':_0x403e54(0x251)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x50e38d=[],_0x5ddbf0={},_0x3c44f8={},_0x5f018f={};var _0xda322a=0x0,_0x648186=0x0,_0x47ef8c=0x0,_0x46684e=0x0,_0x4c23a2=0x0;const _0x74f26c=0x9184e72a000;for(let _0x1d115c=0x0;_0x1d115c<=_0x45cfc2[_0x403e54(0x10b)]-0x1;_0x1d115c++){const _0x16effd=_0x45cfc2[_0x1d115c];let _0x430807=_0x403e54(0x1c0);_0x430807+=_0x403e54(0x242)+_0x16effd['_id'][_0x403e54(0xf0)]+_0x403e54(0x146),_0x430807+=_0x403e54(0x242)+_0x16effd[_0x403e54(0x176)]['date']+_0x403e54(0x146),_0x430807+=_0x403e54(0x242)+_0x16effd['_id'][_0x403e54(0x21f)]+_0x403e54(0x146);let _0x50c02f={};var _0x3d6ebd=0x0;for(let _0x53686b=0x0;_0x53686b<=_0x16effd[_0x403e54(0x14d)]['length']-0x1;_0x53686b++){const _0x3a3da5=_0x16effd['products'][_0x53686b];_0x50c02f[_0x3a3da5[_0x403e54(0x148)]+'-'+_0x3a3da5[_0x403e54(0x21e)]]=_0x3a3da5[_0x403e54(0x131)];const _0x4c0d9a=_0x3a3da5['brand']+'-'+_0x3a3da5['category'];!_0x5ddbf0[_0x4c0d9a]&&(_0x5ddbf0[_0x4c0d9a]=0x0),!Array['isArray'](_0x5f018f[_0x4c0d9a])&&(_0x5f018f[_0x4c0d9a]=[]),!Array[_0x403e54(0x245)](_0x5f018f[_0x4c0d9a])&&(_0x5f018f[_0x4c0d9a]=[]),_0x5ddbf0[_0x4c0d9a]+=_0x3a3da5[_0x403e54(0x131)],_0x5f018f[_0x4c0d9a][_0x403e54(0x19e)](_0x3a3da5[_0x403e54(0x131)]),_0x3d6ebd++;}console[_0x403e54(0x218)](_0x16effd);for(let _0x1a5d32=0x0;_0x1a5d32<=_0x48d91b[_0x403e54(0x26c)][_0x403e54(0x10b)]-0x1;_0x1a5d32++){const _0xccd1f7=_0x48d91b['cat_brand'][_0x1a5d32],_0x3dc319=_0xccd1f7[_0x403e54(0x176)][_0x403e54(0x148)]+'-'+_0xccd1f7[_0x403e54(0x176)][_0x403e54(0x21e)];_0x430807+=_0x403e54(0x22f)+(_0x50c02f[_0x3dc319]!==undefined?_0x50c02f[_0x3dc319][_0x403e54(0x141)](0x2):'')+_0x403e54(0x146);}_0x47ef8c=_0x16effd[_0x403e54(0x1c4)]+_0x16effd[_0x403e54(0x212)],_0x430807+=_0x403e54(0x23c)+formatNumber(parseFloat(_0x16effd[_0x403e54(0x178)],0x2)['toFixed'](0x2))+_0x403e54(0x146),_0x430807+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x16effd[_0x403e54(0x1fc)]['toFixed'](0x2))+_0x403e54(0x146),_0x430807+=_0x403e54(0x23c)+formatNumber(_0x47ef8c)+_0x403e54(0x146),_0x430807+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x16effd[_0x403e54(0x262)][_0x403e54(0x141)](0x2))+_0x403e54(0x146),_0x430807+=_0x403e54(0x1b6),_0xda322a+=parseFloat(_0x16effd[_0x403e54(0x178)]['toFixed'](0x2)),_0x648186+=parseFloat(_0x16effd[_0x403e54(0x262)][_0x403e54(0x141)](0x2)),_0x46684e+=_0x47ef8c,_0x4c23a2+=parseFloat(_0x16effd[_0x403e54(0x1fc)][_0x403e54(0x141)](0x2));if(_0x1d115c==_0x45cfc2[_0x403e54(0x10b)]-0x1){_0x430807+=_0x403e54(0x1c0),_0x430807+=_0x403e54(0x1e7),_0x430807+=_0x403e54(0x146);for(let _0x2b59ea=0x0;_0x2b59ea<=_0x48d91b['cat_brand'][_0x403e54(0x10b)]-0x1;_0x2b59ea++){const _0x3f22b3=_0x48d91b[_0x403e54(0x26c)][_0x2b59ea],_0x4a3506=_0x3f22b3[_0x403e54(0x176)][_0x403e54(0x148)]+'-'+_0x3f22b3[_0x403e54(0x176)][_0x403e54(0x21e)],_0x128e6f=_0x5f018f[_0x4a3506][_0x403e54(0x13b)]((_0x447ef1,_0x41326c)=>_0x447ef1+_0x41326c,0x0);_0x430807+=_0x403e54(0x1bf)+(_0x128e6f!==undefined?formatNumber(_0x128e6f[_0x403e54(0x141)](0x2)):'')+'</b></td>',console[_0x403e54(0x218)](_0x5f018f[_0x4a3506][_0x403e54(0x13b)]((_0x497ef2,_0x4d8d9d)=>_0x497ef2+_0x4d8d9d,0x0));}_0x430807+=_0x403e54(0x18a)+formatNumber(_0xda322a[_0x403e54(0x141)](0x2))+'</b></td>',_0x430807+=_0x403e54(0x18a)+formatNumber(_0x4c23a2)+_0x403e54(0x184),_0x430807+=_0x403e54(0x18a)+formatNumber(_0x46684e)+'</b></td>',_0x430807+=_0x403e54(0x18a)+formatNumber(_0x648186)+'</b></td>',_0x430807+=_0x403e54(0x1b6);}_0x50e38d[_0x403e54(0x19e)](_0x430807);}function _0x383b69(_0x5ee170,_0x3b3dcf){const _0x41893b=_0x403e54,_0x3b180b=[];for(let _0x420f38=0x0;_0x420f38<=_0x5ee170[_0x41893b(0x10b)]-0x1;_0x420f38+=_0x3b3dcf){_0x3b180b[_0x41893b(0x19e)](_0x5ee170['slice'](_0x420f38,_0x420f38+_0x3b3dcf));}return _0x3b180b;}const _0x57d705=_0x383b69(_0x50e38d,_0x74f26c);let _0x56d37a='';return _0x57d705[_0x403e54(0x149)]((_0x2488a0,_0x3e5cea)=>{const _0x4a6a01=_0x403e54;_0x3e5cea>0x0&&(_0x56d37a+=_0x4a6a01(0x1cf));_0x56d37a+=_0x4a6a01(0x26d),_0x56d37a+=_0x4a6a01(0xec),_0x56d37a+=_0x4a6a01(0x1c0),_0x56d37a+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x56d37a+=_0x4a6a01(0x1b6),_0x56d37a+='<tr>',_0x56d37a+=_0x4a6a01(0x247);for(let _0x32bfd8=0x0;_0x32bfd8<=_0x1266a5[_0x4a6a01(0x10b)]-0x1;_0x32bfd8++){const _0x2b9358=_0x1266a5[_0x32bfd8];for(let _0x5f077b=0x0;_0x5f077b<_0x34f4f8[_0x4a6a01(0x10b)];_0x5f077b++){const _0x12e3de=_0x34f4f8[_0x5f077b];_0x12e3de[_0x4a6a01(0x176)]===_0x2b9358[_0x4a6a01(0x176)][_0x4a6a01(0x21e)]&&(_0x56d37a+=_0x4a6a01(0x1fe)+_0x12e3de['brandCount']+_0x4a6a01(0x121)+_0x2b9358[_0x4a6a01(0x176)][_0x4a6a01(0x21e)]+'</td>');}}_0x56d37a+=_0x4a6a01(0x23a),_0x56d37a+=_0x4a6a01(0x1b6),_0x56d37a+='<tr>',_0x56d37a+=_0x4a6a01(0x14e),_0x56d37a+=_0x4a6a01(0x1f4),_0x56d37a+=_0x4a6a01(0x1ca);for(let _0x339b62=0x0;_0x339b62<=_0x1266a5[_0x4a6a01(0x10b)]-0x1;_0x339b62++){const _0x5f5591=_0x1266a5[_0x339b62];for(let _0x53ce10=0x0;_0x53ce10<_0x48d91b[_0x4a6a01(0x26c)][_0x4a6a01(0x10b)];_0x53ce10++){const _0x1fe07a=_0x48d91b[_0x4a6a01(0x26c)][_0x53ce10];_0x1fe07a[_0x4a6a01(0x176)][_0x4a6a01(0x21e)]===_0x5f5591[_0x4a6a01(0x176)]['category']&&(_0x56d37a+=_0x4a6a01(0x267)+_0x1fe07a[_0x4a6a01(0x176)][_0x4a6a01(0x148)]+'</td>');}}_0x56d37a+=_0x4a6a01(0x1a6),_0x56d37a+=_0x4a6a01(0x15c),_0x56d37a+=_0x4a6a01(0x25d),_0x56d37a+=_0x4a6a01(0x1d4),_0x56d37a+='</tr>',_0x56d37a+=_0x4a6a01(0x25c),_0x56d37a+=_0x4a6a01(0x1b2),_0x2488a0[_0x4a6a01(0x149)](_0x1aa9d8=>{_0x56d37a+=_0x1aa9d8;}),console[_0x4a6a01(0x218)](_0x5f018f),_0x56d37a+=_0x4a6a01(0x115),_0x56d37a+='</table>';}),_0x56d37a;}router[a0_0x279c9d(0x205)]('/agent_reports/pdf',auth,async(_0x1d7716,_0x3b936a)=>{const _0x3d7c48=a0_0x279c9d,{from_date:_0x22712f,to_date:_0x36a924,isExcel:_0x581427}=_0x1d7716[_0x3d7c48(0x171)],_0x4c7087=_0x1d7716['user'],_0x3a1688=await staff['findOne']({'email':_0x4c7087[_0x3d7c48(0x1ce)]}),_0x29b301=await master_shop['find']();console[_0x3d7c48(0x218)](_0x29b301[0x0]['image']);const _0x2583ed=await agentsdataDSICheck(_0x22712f,_0x36a924,_0x3a1688['_id']['valueOf'](),_0x581427),_0x415223=await agentsdataDSICheck_excel(_0x22712f,_0x36a924,_0x3a1688[_0x3d7c48(0x176)][_0x3d7c48(0x15e)](),_0x581427);let _0x25d8ff=_0x3d7c48(0x1e4);var _0x5003a0=new Date(_0x22712f),_0x24327a=new Date(_0x36a924);const _0x2da6ce={'year':_0x3d7c48(0x19f),'month':_0x3d7c48(0x224),'day':'numeric'},_0x51f6ae=new Intl[(_0x3d7c48(0x223))]('en-US',_0x2da6ce)[_0x3d7c48(0x20c)](_0x5003a0),_0x190ea1=new Intl[(_0x3d7c48(0x223))]('en-US',_0x2da6ce)[_0x3d7c48(0x20c)](_0x24327a);_0x25d8ff+=_0x3d7c48(0x1dd),_0x25d8ff+=_0x3d7c48(0x230),_0x25d8ff+=_0x3d7c48(0x26d),_0x25d8ff+=_0x2583ed,_0x25d8ff+=_0x3d7c48(0x1da),_0x25d8ff+=_0x3d7c48(0x250),_0x25d8ff+=_0x3d7c48(0x250);let _0x5ef062=_0x3d7c48(0x1e4);_0x5ef062+=_0x3d7c48(0x1dd),_0x5ef062+=_0x3d7c48(0x230),_0x5ef062+=_0x3d7c48(0x26d),_0x5ef062+=_0x415223,_0x5ef062+=_0x3d7c48(0x1da),_0x5ef062+=_0x3d7c48(0x250),_0x5ef062+='</div>';let _0x2a7c07=_0x3d7c48(0xfa);const _0x14368f={'width':_0x3d7c48(0x13f),'height':_0x3d7c48(0x18f),'orientation':_0x3d7c48(0x22c),'border':{'top':_0x3d7c48(0x249),'right':_0x3d7c48(0x249),'bottom':_0x3d7c48(0x249),'left':'0.1in'},'header':{'height':_0x3d7c48(0x104),'contents':_0x3d7c48(0x169)+_0x2a7c07+_0x3d7c48(0x20e)+_0x51f6ae+_0x3d7c48(0x182)+_0x190ea1+_0x3d7c48(0x163)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x581427=='on'){const _0x11119b=cheerio['load'](_0x5ef062);let _0x429ff1=[],_0x13bfd5=[],_0x122626=[];const _0x141f8f=_0x2d29f7=>{const _0x59f107=_0x3d7c48,_0x5e01d0={'top':{'style':_0x59f107(0x193),'color':{'rgb':_0x59f107(0x1e3)}},'bottom':{'style':_0x59f107(0x193),'color':{'rgb':_0x59f107(0x1e3)}},'left':{'style':'thick','color':{'rgb':_0x59f107(0x1e3)}},'right':{'style':_0x59f107(0x193),'color':{'rgb':_0x59f107(0x1e3)}}};if(_0x2d29f7){const _0xae85d9=_0x2d29f7[_0x59f107(0xf4)](';')[_0x59f107(0x13b)]((_0x11ed8c,_0x195ab9)=>{const _0x542399=_0x59f107,[_0x15550d,_0x519c9f]=_0x195ab9[_0x542399(0xf4)](':')[_0x542399(0x25b)](_0x389bc5=>_0x389bc5[_0x542399(0x194)]());return _0x11ed8c[_0x15550d]=_0x519c9f,_0x11ed8c;},{});_0xae85d9[_0x59f107(0x1e8)]&&(_0x5e01d0['top'][_0x59f107(0x10f)]=_0xae85d9[_0x59f107(0x1e8)][_0x59f107(0x12c)](_0x59f107(0x233))?_0x59f107(0x233):_0x59f107(0x263)),_0xae85d9['border-bottom']&&(_0x5e01d0[_0x59f107(0x111)][_0x59f107(0x10f)]=_0xae85d9['border-bottom'][_0x59f107(0x12c)](_0x59f107(0x233))?_0x59f107(0x233):_0x59f107(0x263)),_0xae85d9[_0x59f107(0x241)]&&(_0x5e01d0[_0x59f107(0x1b9)][_0x59f107(0x10f)]=_0xae85d9['border-left']['includes'](_0x59f107(0x233))?_0x59f107(0x233):_0x59f107(0x263)),_0xae85d9[_0x59f107(0x10a)]&&(_0x5e01d0[_0x59f107(0x1d8)][_0x59f107(0x10f)]=_0xae85d9[_0x59f107(0x10a)][_0x59f107(0x12c)](_0x59f107(0x233))?_0x59f107(0x233):_0x59f107(0x263));}return _0x5e01d0;};_0x11119b(_0x3d7c48(0x197))[_0x3d7c48(0x189)]((_0x25526d,_0x4b019b)=>{const _0x129f48=_0x3d7c48;let _0x4c6da2=[],_0x35e5ea=0x0;while(_0x122626[_0x35e5ea]){_0x122626[_0x35e5ea]--,_0x35e5ea++;}_0x11119b(_0x4b019b)[_0x129f48(0x220)](_0x129f48(0x20d))['each']((_0x3ae4c4,_0x5018e8)=>{const _0x1bbc08=_0x129f48;let _0xe12cb2=_0x11119b(_0x5018e8)[_0x1bbc08(0x1ff)]()['trim'](),_0x27543c=parseFloat(_0xe12cb2[_0x1bbc08(0x22d)](/,/g,'')),_0xf888e7={};!isNaN(_0x27543c)?(_0xf888e7['v']=_0x27543c,_0xf888e7['t']='n'):(_0xf888e7['v']=_0xe12cb2,_0xf888e7['t']='s');const _0x5e7088=_0x11119b(_0x5018e8)[_0x1bbc08(0x1f8)](_0x1bbc08(0x10f)),_0x231e4d=_0x141f8f(_0x5e7088);_0xf888e7['s']={'border':_0x231e4d},_0x4c6da2[_0x35e5ea]=_0xf888e7;let _0x2f70f0=parseInt(_0x11119b(_0x5018e8)[_0x1bbc08(0x1f8)](_0x1bbc08(0x1c6)))||0x1,_0x38d1aa=parseInt(_0x11119b(_0x5018e8)['attr']('rowspan'))||0x1;(_0x2f70f0>0x1||_0x38d1aa>0x1)&&_0x13bfd5['push']({'s':{'r':_0x25526d,'c':_0x35e5ea},'e':{'r':_0x25526d+_0x38d1aa-0x1,'c':_0x35e5ea+_0x2f70f0-0x1}});for(let _0xa23499=0x0;_0xa23499<_0x2f70f0;_0xa23499++){_0x38d1aa>0x1&&(_0x122626[_0x35e5ea+_0xa23499]=_0x38d1aa-0x1);}_0x35e5ea+=_0x2f70f0;}),_0x429ff1['push'](_0x4c6da2);});const _0x4013b8=XLSX[_0x3d7c48(0xfb)][_0x3d7c48(0x23e)](),_0x571621=XLSX[_0x3d7c48(0xfb)][_0x3d7c48(0x26e)](_0x429ff1);_0x13bfd5[_0x3d7c48(0x10b)]>0x0&&(_0x571621['!merges']=_0x13bfd5);_0x571621[_0x3d7c48(0x22a)]=_0x429ff1[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x3d7c48(0x138)](_0x4013b8,_0x571621,_0x3d7c48(0x1a7));const _0x2ebfad=XLSX[_0x3d7c48(0x165)](_0x4013b8,{'bookType':_0x3d7c48(0x21d),'type':'buffer'});_0x3b936a[_0x3d7c48(0x1df)](_0x3d7c48(0x139),_0x3d7c48(0x17e)),_0x3b936a[_0x3d7c48(0x1df)](_0x3d7c48(0x10c),_0x3d7c48(0x265)),_0x3b936a[_0x3d7c48(0x1cc)](_0x2ebfad);}else pdf[_0x3d7c48(0x16b)](_0x25d8ff,_0x14368f)[_0x3d7c48(0x227)](function(_0xc85c04,_0x637f14){const _0x382812=_0x3d7c48;if(_0xc85c04){console[_0x382812(0x112)](_0x382812(0x130),_0xc85c04),_0x3b936a['status'](0x1f4)[_0x382812(0x1cc)](_0x382812(0x1ba)+_0xc85c04);return;}_0x3b936a[_0x382812(0x1df)]('Content-Type',_0x382812(0x1a4)),_0x637f14['pipe'](_0x3b936a);});}),router[a0_0x279c9d(0x20f)](a0_0x279c9d(0x18c),auth,async(_0x5db481,_0x3cf675)=>{const _0x4b809c=a0_0x279c9d;try{const {username:_0x513b99,email:_0x27c6fd,role:_0x5d949a}=_0x5db481[_0x4b809c(0x18e)],_0x16371d=_0x5db481[_0x4b809c(0x18e)],_0x2a0056=await profile[_0x4b809c(0x1b4)]({'email':_0x16371d[_0x4b809c(0x1ce)]}),_0x4c66b8={'year':_0x4b809c(0x19f),'month':_0x4b809c(0x224),'day':_0x4b809c(0x19f)},_0x14234f=await master_shop[_0x4b809c(0x220)](),_0x3f3336=await product['find'](),_0x57b55e=await warehouse['aggregate']([{'$unwind':_0x4b809c(0x251)},{'$lookup':{'from':_0x4b809c(0x14d),'localField':'product_details.product_name','foreignField':'name','as':_0x4b809c(0x151)}},{'$unwind':_0x4b809c(0x1f5)},{'$project':{'product_name':_0x4b809c(0x256),'product_stock':_0x4b809c(0x135)}},{'$group':{'_id':_0x4b809c(0x211),'product_stock':{'$sum':_0x4b809c(0x156)}}}]),_0x43a9a0=await staff[_0x4b809c(0x1b4)]({'email':_0x16371d[_0x4b809c(0x1ce)]});if(_0x14234f[0x0][_0x4b809c(0x209)]=='English\x20(US)')var _0x50ae8e=users[_0x4b809c(0x1d7)];else{if(_0x14234f[0x0][_0x4b809c(0x209)]=='Hindi')var _0x50ae8e=users[_0x4b809c(0x185)];else{if(_0x14234f[0x0][_0x4b809c(0x209)]=='German')var _0x50ae8e=users[_0x4b809c(0x24a)];else{if(_0x14234f[0x0][_0x4b809c(0x209)]==_0x4b809c(0x237))var _0x50ae8e=users[_0x4b809c(0x237)];else{if(_0x14234f[0x0]['language']=='French')var _0x50ae8e=users['French'];else{if(_0x14234f[0x0]['language']==_0x4b809c(0x21b))var _0x50ae8e=users[_0x4b809c(0x217)];else{if(_0x14234f[0x0][_0x4b809c(0x209)]==_0x4b809c(0x1f1))var _0x50ae8e=users[_0x4b809c(0x1f1)];else{if(_0x14234f[0x0][_0x4b809c(0x209)]==_0x4b809c(0x1ec))var _0x50ae8e=users[_0x4b809c(0x140)];}}}}}}}_0x3cf675[_0x4b809c(0x11d)](_0x4b809c(0x12b),{'success':_0x5db481[_0x4b809c(0x215)]('success'),'errors':_0x5db481['flash'](_0x4b809c(0x13a)),'alldata':_0x3f3336,'profile':_0x2a0056,'master_shop':_0x14234f,'role':_0x16371d,'product_stock':_0x57b55e,'language':_0x50ae8e,'staff_arr':_0x43a9a0});}catch(_0x19a5ee){}});async function dataSalesReports(_0x4c62a7,_0x23a624,_0x40adc7){const _0x49802f=a0_0x279c9d;let _0x2e20d9='';const _0x7f2ae=await sales_sa[_0x49802f(0x226)]([{'$match':{'date':{'$gte':_0x4c62a7,'$lte':_0x23a624},'sales_staff_id':_0x40adc7}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x49802f(0x26f)}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':'$sale_product.product_code'},'sumqty':{'$sum':_0x49802f(0x188)},'totalPrice':{'$sum':_0x49802f(0x11c)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x1fa508=0x0,_0x1b6875=0x0;for(let _0x2f6df8=0x0;_0x2f6df8<=_0x7f2ae[_0x49802f(0x10b)]-0x1;_0x2f6df8++){const _0x18b232=_0x7f2ae[_0x2f6df8];var _0x113af6=_0x18b232[_0x49802f(0x107)]['toLocaleString'](undefined),_0x549c3a=_0x18b232[_0x49802f(0x100)]['toLocaleString'](undefined);_0x2e20d9+=_0x49802f(0x1c0),_0x2e20d9+='<td\x20class=\x22row_data\x22>'+_0x18b232[_0x49802f(0x176)][_0x49802f(0x164)]+_0x49802f(0x146),_0x2e20d9+=_0x49802f(0xeb)+_0x18b232['_id']['product_name']+_0x49802f(0x146),_0x2e20d9+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x18b232[_0x49802f(0x100)][_0x49802f(0x141)](0x2))+_0x49802f(0x146),_0x2e20d9+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x18b232[_0x49802f(0x107)][_0x49802f(0x141)](0x2))+_0x49802f(0x146),_0x2e20d9+=_0x49802f(0x1b6),_0x1fa508+=parseFloat(_0x18b232[_0x49802f(0x100)]),_0x1b6875+=parseFloat(_0x18b232['totalPrice']);}var _0x1680c7=_0x1b6875[_0x49802f(0x1dc)](undefined),_0x384aa0=_0x1fa508[_0x49802f(0x1dc)](undefined);return _0x2e20d9+=_0x49802f(0x1c0),_0x2e20d9+=_0x49802f(0x1f2),_0x2e20d9+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x1fa508[_0x49802f(0x141)](0x2))+'</b></td>',_0x2e20d9+=_0x49802f(0x143)+formatNumber(_0x1b6875['toFixed'](0x2))+_0x49802f(0x184),_0x2e20d9+=_0x49802f(0x1b6),_0x2e20d9;}router[a0_0x279c9d(0x205)](a0_0x279c9d(0x11b),auth,async(_0x30559e,_0x1a4c52)=>{const _0x2c97e1=a0_0x279c9d;try{const {from_date:_0x279532,to_date:_0x39af6f,isExcel:_0x2e8bc2}=_0x30559e[_0x2c97e1(0x171)],_0x14ae3b=_0x30559e[_0x2c97e1(0x18e)],_0x305f80=await staff['findOne']({'email':_0x14ae3b[_0x2c97e1(0x1ce)]});let _0x3eb526=_0x2c97e1(0x129);var _0x1b499b=new Date(_0x279532),_0x17167e=new Date(_0x39af6f);const _0x1cafdd={'year':'numeric','month':_0x2c97e1(0x224),'day':'numeric'},_0x2caf1e=new Intl[(_0x2c97e1(0x223))](_0x2c97e1(0x158),_0x1cafdd)[_0x2c97e1(0x20c)](_0x1b499b),_0x1d82e4=new Intl[(_0x2c97e1(0x223))](_0x2c97e1(0x158),_0x1cafdd)[_0x2c97e1(0x20c)](_0x17167e);var _0x436140=await dataSalesReports(_0x279532,_0x39af6f,_0x305f80[_0x2c97e1(0x176)][_0x2c97e1(0x15e)]());_0x3eb526+=_0x2c97e1(0x1dd),_0x3eb526+=_0x2c97e1(0x225),_0x3eb526+='<table>',_0x3eb526+='<tr>',_0x3eb526+='<th>\x20ITEM\x20CODE\x20</th>',_0x3eb526+=_0x2c97e1(0x161),_0x3eb526+=_0x2c97e1(0x11a),_0x3eb526+=_0x2c97e1(0x16d),_0x3eb526+='<tr>',_0x3eb526+=_0x436140,_0x3eb526+=_0x2c97e1(0x1b6),_0x3eb526+=_0x2c97e1(0x250),_0x3eb526+='</div>';let _0x26b40e='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x4de0e4={'width':_0x2c97e1(0x13f),'height':'8.5in','orientation':_0x2c97e1(0x22c),'border':{'top':_0x2c97e1(0x249),'right':_0x2c97e1(0x249),'bottom':'0.1in','left':_0x2c97e1(0x249)},'header':{'height':_0x2c97e1(0x104),'contents':_0x2c97e1(0x169)+_0x26b40e+_0x2c97e1(0x229)+_0x305f80[_0x2c97e1(0x136)]+_0x2c97e1(0x26b)+_0x2caf1e+_0x2c97e1(0x182)+_0x1d82e4+_0x2c97e1(0x163)},'footer':{'height':'20mm','contents':{'default':_0x2c97e1(0x13d)}},'dpi':0x5,'zoomFactor':'1'};if(_0x2e8bc2=='on'){const _0x6a407d=cheerio[_0x2c97e1(0x1ad)](_0x3eb526);let _0x33b365=[],_0x27ea8a=[],_0x61d607=[];const _0x22f1a5=_0x3b8c7b=>{const _0x276d90=_0x2c97e1,_0x39d808={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0x276d90(0x193),'color':{'rgb':'000000'}},'left':{'style':_0x276d90(0x193),'color':{'rgb':_0x276d90(0x1e3)}},'right':{'style':'thick','color':{'rgb':_0x276d90(0x1e3)}}};if(_0x3b8c7b){const _0x5fb69c=_0x3b8c7b[_0x276d90(0xf4)](';')['reduce']((_0x26c29c,_0x57279d)=>{const _0x21213a=_0x276d90,[_0x31956b,_0x25b8cc]=_0x57279d['split'](':')[_0x21213a(0x25b)](_0x116525=>_0x116525[_0x21213a(0x194)]());return _0x26c29c[_0x31956b]=_0x25b8cc,_0x26c29c;},{});_0x5fb69c[_0x276d90(0x1e8)]&&(_0x39d808[_0x276d90(0x259)]['style']=_0x5fb69c[_0x276d90(0x1e8)]['includes'](_0x276d90(0x233))?_0x276d90(0x233):_0x276d90(0x263)),_0x5fb69c[_0x276d90(0x1a9)]&&(_0x39d808[_0x276d90(0x111)][_0x276d90(0x10f)]=_0x5fb69c[_0x276d90(0x1a9)][_0x276d90(0x12c)](_0x276d90(0x233))?'thin':_0x276d90(0x263)),_0x5fb69c['border-left']&&(_0x39d808[_0x276d90(0x1b9)][_0x276d90(0x10f)]=_0x5fb69c['border-left'][_0x276d90(0x12c)](_0x276d90(0x233))?_0x276d90(0x233):_0x276d90(0x263)),_0x5fb69c[_0x276d90(0x10a)]&&(_0x39d808[_0x276d90(0x1d8)][_0x276d90(0x10f)]=_0x5fb69c[_0x276d90(0x10a)]['includes'](_0x276d90(0x233))?'thin':_0x276d90(0x263));}return _0x39d808;};_0x6a407d('table\x20tr')[_0x2c97e1(0x189)]((_0x5b3266,_0x5dae4b)=>{const _0x4d999c=_0x2c97e1;let _0x2c509d=[],_0x23c127=0x0;while(_0x61d607[_0x23c127]){_0x61d607[_0x23c127]--,_0x23c127++;}_0x6a407d(_0x5dae4b)[_0x4d999c(0x220)](_0x4d999c(0x20d))[_0x4d999c(0x189)]((_0x13d9a9,_0x333ca9)=>{const _0x36c180=_0x4d999c;let _0x840a5f=_0x6a407d(_0x333ca9)[_0x36c180(0x1ff)]()['trim'](),_0x5c7658=parseFloat(_0x840a5f[_0x36c180(0x22d)](/,/g,'')),_0x484af3={};!isNaN(_0x5c7658)?(_0x484af3['v']=_0x5c7658,_0x484af3['t']='n'):(_0x484af3['v']=_0x840a5f,_0x484af3['t']='s');const _0x9ebc33=_0x6a407d(_0x333ca9)[_0x36c180(0x1f8)](_0x36c180(0x10f)),_0x5b2b4d=_0x22f1a5(_0x9ebc33);_0x484af3['s']={'border':_0x5b2b4d},_0x2c509d[_0x23c127]=_0x484af3;let _0x191db5=parseInt(_0x6a407d(_0x333ca9)[_0x36c180(0x1f8)](_0x36c180(0x1c6)))||0x1,_0x33281f=parseInt(_0x6a407d(_0x333ca9)[_0x36c180(0x1f8)](_0x36c180(0x116)))||0x1;(_0x191db5>0x1||_0x33281f>0x1)&&_0x27ea8a['push']({'s':{'r':_0x5b3266,'c':_0x23c127},'e':{'r':_0x5b3266+_0x33281f-0x1,'c':_0x23c127+_0x191db5-0x1}});for(let _0x152654=0x0;_0x152654<_0x191db5;_0x152654++){_0x33281f>0x1&&(_0x61d607[_0x23c127+_0x152654]=_0x33281f-0x1);}_0x23c127+=_0x191db5;}),_0x33b365[_0x4d999c(0x19e)](_0x2c509d);});const _0x1f8bb8=XLSX[_0x2c97e1(0xfb)][_0x2c97e1(0x23e)](),_0x38920=XLSX[_0x2c97e1(0xfb)][_0x2c97e1(0x26e)](_0x33b365);_0x27ea8a[_0x2c97e1(0x10b)]>0x0&&(_0x38920[_0x2c97e1(0x261)]=_0x27ea8a);_0x38920[_0x2c97e1(0x22a)]=_0x33b365[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x2c97e1(0xfb)]['book_append_sheet'](_0x1f8bb8,_0x38920,_0x2c97e1(0x1a7));const _0x5b57f0=XLSX[_0x2c97e1(0x165)](_0x1f8bb8,{'bookType':_0x2c97e1(0x21d),'type':_0x2c97e1(0x228)});_0x1a4c52[_0x2c97e1(0x1df)](_0x2c97e1(0x139),_0x2c97e1(0x17e)),_0x1a4c52[_0x2c97e1(0x1df)](_0x2c97e1(0x10c),_0x2c97e1(0x265)),_0x1a4c52[_0x2c97e1(0x1cc)](_0x5b57f0);}else pdf[_0x2c97e1(0x16b)](_0x3eb526,_0x4de0e4)[_0x2c97e1(0x227)](function(_0x23e70c,_0x47efe9){const _0x5b1d1d=_0x2c97e1;if(_0x23e70c){_0x1a4c52[_0x5b1d1d(0x172)](0x1f4)[_0x5b1d1d(0x1cc)](_0x5b1d1d(0x1ba));return;}_0x1a4c52[_0x5b1d1d(0x1df)](_0x5b1d1d(0x10c),_0x5b1d1d(0x1a4)),_0x47efe9[_0x5b1d1d(0x17f)](_0x1a4c52);});}catch(_0x28ff64){}}),router['get'](a0_0x279c9d(0x16e),auth,async(_0x2aedcd,_0x4da616)=>{const _0x1d9a05=a0_0x279c9d;try{const {username:_0x57b22f,email:_0x1d89d1,role:_0x3c1c4b}=_0x2aedcd[_0x1d9a05(0x18e)],_0x4d2448=_0x2aedcd[_0x1d9a05(0x18e)],_0x3df4c1=await profile[_0x1d9a05(0x1b4)]({'email':_0x4d2448[_0x1d9a05(0x1ce)]}),_0x4c5189={'year':_0x1d9a05(0x19f),'month':'long','day':_0x1d9a05(0x19f)},_0x1d9c71=await master_shop[_0x1d9a05(0x220)](),_0x540d24=await product[_0x1d9a05(0x220)](),_0x25d5ea=await warehouse[_0x1d9a05(0x226)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x1d9a05(0x14d),'localField':_0x1d9a05(0x1a0),'foreignField':'name','as':_0x1d9a05(0x151)}},{'$unwind':_0x1d9a05(0x1f5)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x1d9a05(0x135)}},{'$group':{'_id':_0x1d9a05(0x211),'product_stock':{'$sum':_0x1d9a05(0x156)}}}]);if(_0x1d9c71[0x0]['language']==_0x1d9a05(0x154))var _0x3199ce=users[_0x1d9a05(0x1d7)];else{if(_0x1d9c71[0x0][_0x1d9a05(0x209)]==_0x1d9a05(0x185))var _0x3199ce=users[_0x1d9a05(0x185)];else{if(_0x1d9c71[0x0]['language']==_0x1d9a05(0x24a))var _0x3199ce=users[_0x1d9a05(0x24a)];else{if(_0x1d9c71[0x0]['language']==_0x1d9a05(0x237))var _0x3199ce=users[_0x1d9a05(0x237)];else{if(_0x1d9c71[0x0][_0x1d9a05(0x209)]==_0x1d9a05(0x216))var _0x3199ce=users[_0x1d9a05(0x216)];else{if(_0x1d9c71[0x0][_0x1d9a05(0x209)]=='Portuguese\x20(BR)')var _0x3199ce=users[_0x1d9a05(0x217)];else{if(_0x1d9c71[0x0][_0x1d9a05(0x209)]==_0x1d9a05(0x1f1))var _0x3199ce=users[_0x1d9a05(0x1f1)];else{if(_0x1d9c71[0x0][_0x1d9a05(0x209)]=='Arabic\x20(ae)')var _0x3199ce=users[_0x1d9a05(0x140)];}}}}}}}_0x4da616[_0x1d9a05(0x11d)]('inventory_sum',{'success':_0x2aedcd[_0x1d9a05(0x215)](_0x1d9a05(0x13c)),'errors':_0x2aedcd[_0x1d9a05(0x215)](_0x1d9a05(0x13a)),'alldata':_0x540d24,'profile':_0x3df4c1,'master_shop':_0x1d9c71,'role':_0x4d2448,'product_stock':_0x25d5ea,'language':_0x3199ce});}catch(_0xbc0418){}});async function dataInventoryReports(_0x58a7c3,_0x50c330,_0x11dc9f){const _0x29b9ac=a0_0x279c9d,_0x333f8b=await sales_sa[_0x29b9ac(0x226)]([{'$match':{'date':{'$gte':_0x58a7c3,'$lte':_0x50c330},'sales_staff_id':_0x11dc9f}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x29b9ac(0x19c)},'sumqty':{'$sum':_0x29b9ac(0x17b)}}},{'$sort':{'_id.product_name':0x1}}]),_0x5b7bbd=mongoose[_0x29b9ac(0x23d)][_0x29b9ac(0xf7)],_0x3a8b6a=await staff['aggregate']([{'$match':{'_id':_0x5b7bbd(_0x11dc9f)}},{'$unwind':_0x29b9ac(0x239)},{'$match':{'product_list.isConfirm':_0x29b9ac(0x246)}},{'$group':{'_id':{'product_name':_0x29b9ac(0x255),'product_code':_0x29b9ac(0x16c)},'sumqty':{'$sum':_0x29b9ac(0x1fd)}}},{'$sort':{'_id.product_name':0x1}}]),_0x5b1a1a=await sales_inv_data['aggregate']([{'$match':{'date':{'$gte':_0x58a7c3,'$lte':_0x50c330},'sales_staff_id':_0x11dc9f}},{'$unwind':_0x29b9ac(0x1ee)},{'$group':{'_id':{'product_name':_0x29b9ac(0x219),'product_code':_0x29b9ac(0x19c)},'totalQTYsum':{'$sum':_0x29b9ac(0xf6)}}}]);console[_0x29b9ac(0x218)](_0x5b1a1a);let _0xc45e67='';var _0x2cb8a4=0x0;for(let _0x15ce6f=0x0;_0x15ce6f<=_0x3a8b6a[_0x29b9ac(0x10b)]-0x1;_0x15ce6f++){const _0x5a4f8a=_0x3a8b6a[_0x15ce6f];_0xc45e67+=_0x29b9ac(0x1c0),_0xc45e67+=_0x29b9ac(0x24d)+_0x5a4f8a['_id'][_0x29b9ac(0x164)]+'</td>',_0xc45e67+=_0x29b9ac(0x123)+_0x5a4f8a[_0x29b9ac(0x176)][_0x29b9ac(0x200)]+_0x29b9ac(0x146);var _0x2f0df0=_0x5a4f8a[_0x29b9ac(0x100)],_0x5ec018=0x0;for(let _0x13a6a1=0x0;_0x13a6a1<=_0x333f8b[_0x29b9ac(0x10b)]-0x1;_0x13a6a1++){const _0x935641=_0x333f8b[_0x13a6a1];_0x5a4f8a['_id'][_0x29b9ac(0x164)]==_0x935641['_id']['product_code']&&_0x5a4f8a[_0x29b9ac(0x176)][_0x29b9ac(0x200)]==_0x935641['_id'][_0x29b9ac(0x200)]&&(_0x5ec018=_0x935641[_0x29b9ac(0x100)]);}var _0x1dfffb=0x0;for(let _0x1e5f1e=0x0;_0x1e5f1e<=_0x5b1a1a[_0x29b9ac(0x10b)]-0x1;_0x1e5f1e++){const _0x5cf32c=_0x5b1a1a[_0x1e5f1e];_0x5a4f8a[_0x29b9ac(0x176)]['product_code']==_0x5cf32c[_0x29b9ac(0x176)][_0x29b9ac(0x164)]&&_0x5a4f8a['_id'][_0x29b9ac(0x200)]==_0x5cf32c[_0x29b9ac(0x176)][_0x29b9ac(0x200)]&&(_0x1dfffb=_0x5cf32c[_0x29b9ac(0x238)]);}_0x2cb8a4=_0x2f0df0-_0x1dfffb+_0x5ec018,_0xc45e67+=_0x29b9ac(0xeb)+_0x2cb8a4+_0x29b9ac(0x146);let _0x20caaa=![];for(let _0x4e32b8=0x0;_0x4e32b8<=_0x5b1a1a[_0x29b9ac(0x10b)]-0x1;_0x4e32b8++){const _0x42adef=_0x5b1a1a[_0x4e32b8];if(_0x5a4f8a['_id'][_0x29b9ac(0x164)]==_0x42adef[_0x29b9ac(0x176)][_0x29b9ac(0x164)]&&_0x5a4f8a['_id'][_0x29b9ac(0x200)]==_0x42adef['_id'][_0x29b9ac(0x200)]){_0xc45e67+=_0x29b9ac(0xeb)+_0x42adef[_0x29b9ac(0x238)]+_0x29b9ac(0x146),_0x20caaa=!![];break;}}!_0x20caaa&&(_0xc45e67+=_0x29b9ac(0x102));let _0x1c5390=![];for(let _0x2ae85e=0x0;_0x2ae85e<=_0x333f8b[_0x29b9ac(0x10b)]-0x1;_0x2ae85e++){const _0x45561e=_0x333f8b[_0x2ae85e];if(_0x5a4f8a[_0x29b9ac(0x176)][_0x29b9ac(0x164)]==_0x45561e[_0x29b9ac(0x176)]['product_code']&&_0x5a4f8a[_0x29b9ac(0x176)][_0x29b9ac(0x200)]==_0x45561e['_id'][_0x29b9ac(0x200)]){_0xc45e67+=_0x29b9ac(0xeb)+_0x45561e['sumqty']+_0x29b9ac(0x146),_0x1c5390=!![];break;}}!_0x1c5390&&(_0xc45e67+=_0x29b9ac(0x102)),_0xc45e67+='<td\x20class=\x22row_data\x22>'+_0x5a4f8a[_0x29b9ac(0x100)]+_0x29b9ac(0x146),_0xc45e67+=_0x29b9ac(0x1b6);}return _0xc45e67;}router[a0_0x279c9d(0x205)]('/inventory_sum/pdf',auth,async(_0x462906,_0x277469)=>{const _0x4c5cb9=a0_0x279c9d;try{const {from_date:_0x340157,to_date:_0x4bd753}=_0x462906['body'],_0xbc0d38=_0x462906[_0x4c5cb9(0x18e)],_0x250016=await staff[_0x4c5cb9(0x1b4)]({'email':_0xbc0d38[_0x4c5cb9(0x1ce)]});let _0x3f9b9d=_0x4c5cb9(0x129);var _0x1a4d73=new Date(_0x340157),_0x5beb10=new Date(_0x4bd753);const _0x15b2be={'year':'numeric','month':_0x4c5cb9(0x224),'day':_0x4c5cb9(0x19f)},_0x599304=new Intl['DateTimeFormat'](_0x4c5cb9(0x158),_0x15b2be)[_0x4c5cb9(0x20c)](_0x1a4d73),_0x114748=new Intl[(_0x4c5cb9(0x223))]('en-US',_0x15b2be)[_0x4c5cb9(0x20c)](_0x5beb10);var _0x2cab5f=await dataInventoryReports(_0x340157,_0x4bd753,_0x250016[_0x4c5cb9(0x176)][_0x4c5cb9(0x15e)]());_0x3f9b9d+=_0x4c5cb9(0x1d9),_0x3f9b9d+=_0x4c5cb9(0x1c5),_0x3f9b9d+=_0x4c5cb9(0x1db)+_0x599304+_0x4c5cb9(0x182)+_0x114748+_0x4c5cb9(0x127),_0x3f9b9d+=_0x4c5cb9(0x1dd),_0x3f9b9d+=_0x4c5cb9(0x225),_0x3f9b9d+=_0x4c5cb9(0x26d),_0x3f9b9d+='<tr>',_0x3f9b9d+='<th>\x20ITEM\x20CODE\x20</th>',_0x3f9b9d+=_0x4c5cb9(0x161),_0x3f9b9d+=_0x4c5cb9(0x208),_0x3f9b9d+=_0x4c5cb9(0x264),_0x3f9b9d+='<th>\x20SALES\x20</th>',_0x3f9b9d+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x3f9b9d+=_0x4c5cb9(0x1c0),_0x3f9b9d+=_0x2cab5f,_0x3f9b9d+=_0x4c5cb9(0x1b6),_0x3f9b9d+=_0x4c5cb9(0x250),_0x3f9b9d+=_0x4c5cb9(0x250);const _0x496a22={'format':'Letter','orientation':_0x4c5cb9(0x22c)};pdf[_0x4c5cb9(0x16b)](_0x3f9b9d,_0x496a22)['toStream'](function(_0x20e111,_0x4db7e3){const _0xf6a778=_0x4c5cb9;if(_0x20e111){_0x277469['status'](0x1f4)[_0xf6a778(0x1cc)](_0xf6a778(0x1ba));return;}_0x277469[_0xf6a778(0x1df)](_0xf6a778(0x10c),_0xf6a778(0x1a4)),_0x4db7e3[_0xf6a778(0x17f)](_0x277469);});}catch(_0x2fda89){}}),router[a0_0x279c9d(0x20f)]('/dsrr/view',auth,async(_0x35f004,_0x3d9068)=>{const _0x24be53=a0_0x279c9d;try{const {username:_0x1ec18a,email:_0x178ff6,role:_0x5f0359}=_0x35f004[_0x24be53(0x18e)],_0x4a9642=_0x35f004[_0x24be53(0x18e)],_0x366d32=await profile['findOne']({'email':_0x4a9642[_0x24be53(0x1ce)]}),_0x1c2694={'year':'numeric','month':_0x24be53(0x224),'day':_0x24be53(0x19f)},_0x41c707=await master_shop[_0x24be53(0x220)]();console[_0x24be53(0x218)](_0x24be53(0x231),_0x41c707);const _0x2db82f=await product[_0x24be53(0x220)]();console[_0x24be53(0x218)]('Products\x20find_data',_0x2db82f);const _0x53d841=await warehouse['aggregate']([{'$unwind':_0x24be53(0x251)},{'$lookup':{'from':_0x24be53(0x14d),'localField':_0x24be53(0x1a0),'foreignField':'name','as':_0x24be53(0x151)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x24be53(0x256),'product_stock':_0x24be53(0x135)}},{'$group':{'_id':_0x24be53(0x211),'product_stock':{'$sum':_0x24be53(0x156)}}}]);console[_0x24be53(0x218)](_0x24be53(0x1eb),_0x53d841),_0x53d841[_0x24be53(0x149)](_0x228aae=>{const _0x5b2a00=_0x2db82f['map'](_0x173511=>{const _0x2a858d=a0_0x1029;_0x173511[_0x2a858d(0x136)]==_0x228aae[_0x2a858d(0x176)]&&(_0x173511[_0x2a858d(0xf1)]=parseInt(_0x173511['stock'])+parseInt(_0x228aae[_0x2a858d(0x177)]));});});const _0x5af464=await staff[_0x24be53(0x1b4)]({'email':_0x4a9642[_0x24be53(0x1ce)]});if(_0x41c707[0x0][_0x24be53(0x209)]==_0x24be53(0x154))var _0x88d49d=users[_0x24be53(0x1d7)];else{if(_0x41c707[0x0][_0x24be53(0x209)]==_0x24be53(0x185))var _0x88d49d=users[_0x24be53(0x185)];else{if(_0x41c707[0x0][_0x24be53(0x209)]==_0x24be53(0x24a))var _0x88d49d=users['German'];else{if(_0x41c707[0x0]['language']=='Spanish')var _0x88d49d=users[_0x24be53(0x237)];else{if(_0x41c707[0x0][_0x24be53(0x209)]==_0x24be53(0x216))var _0x88d49d=users[_0x24be53(0x216)];else{if(_0x41c707[0x0][_0x24be53(0x209)]=='Portuguese\x20(BR)')var _0x88d49d=users[_0x24be53(0x217)];else{if(_0x41c707[0x0][_0x24be53(0x209)]==_0x24be53(0x1f1))var _0x88d49d=users[_0x24be53(0x1f1)];else{if(_0x41c707[0x0][_0x24be53(0x209)]==_0x24be53(0x1ec))var _0x88d49d=users[_0x24be53(0x140)];}}}}}}}_0x3d9068[_0x24be53(0x11d)]('dssr_view',{'success':_0x35f004['flash']('success'),'errors':_0x35f004['flash'](_0x24be53(0x13a)),'alldata':_0x2db82f,'profile':_0x366d32,'master_shop':_0x41c707,'role':_0x4a9642,'product_stock':_0x53d841,'language':_0x88d49d,'staff_arr':_0x5af464});}catch(_0xf7dc71){}});async function agentsdataDSICheck_DSRR(_0x38401f,_0x20a499,_0x49ea59,_0x5f2fb5){const _0xb45e62=a0_0x279c9d;let _0xdef5a2=new Date(_0x38401f);_0xdef5a2['setDate'](_0xdef5a2['getDate']()-0x1);let _0x50c7c4=_0xdef5a2[_0xb45e62(0x266)]()['split']('T')[0x0];const _0x44197f=await product[_0xb45e62(0x226)]([{'$group':{'_id':{'brand':_0xb45e62(0x125),'category':_0xb45e62(0x15a)},'products':{'$push':{'name':_0xb45e62(0x253),'product_code':_0xb45e62(0x1cd)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2cb652=[];_0x2cb652[_0xb45e62(0x26c)]=[];for(let _0x2f5497=0x0;_0x2f5497<=_0x44197f[_0xb45e62(0x10b)]-0x1;_0x2f5497++){const _0x160193=_0x44197f[_0x2f5497];_0x2cb652[_0xb45e62(0x26c)][_0xb45e62(0x19e)](_0x160193);}const _0x29dab2=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':'$brand','product_code':_0xb45e62(0x1cd),'product_name':_0xb45e62(0x253)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4c127c=await product[_0xb45e62(0x226)]([{'$group':{'_id':{'category':_0xb45e62(0x15a),'brand':_0xb45e62(0x125)}}},{'$group':{'_id':_0xb45e62(0x1f3),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3b3ba4=await sales_sa[_0xb45e62(0x226)]([{'$match':{'date':_0x38401f,'sales_staff_id':_0x20a499,'sale_product.isFG':_0xb45e62(0x26f)}},{'$unwind':_0xb45e62(0x1ee)},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0xb45e62(0x164),'as':_0xb45e62(0x25a)}},{'$unwind':_0xb45e62(0x214)},{'$group':{'_id':{'dsi':_0xb45e62(0x207),'date':'$date','customer':'$customer','status_data':_0xb45e62(0x18b)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'cash':{'$first':_0xb45e62(0x132)},'amount':{'$first':_0xb45e62(0x22b)},'bank':{'$first':'$bank'},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0xb45e62(0x210)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0xb45e62(0x11c),'discount':'$sale_product.discount','adj_discount':_0xb45e62(0x1e1),'product_details':{'prod_name':_0xb45e62(0x199),'product_code':_0xb45e62(0xee),'category':_0xb45e62(0xf2),'brand':_0xb45e62(0x252),'gross_price':_0xb45e62(0x17a),'isFG':_0xb45e62(0x1c3),'prod_cat':_0xb45e62(0x186),'prod_id':'$sale_product._id'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0xb45e62(0x181),'date':_0xb45e62(0xea),'customer':'$_id.customer','status_data':_0xb45e62(0x254),'category':'$products.product_details.category','brand':_0xb45e62(0x25e),'prod_id':_0xb45e62(0x157)},'totalQty':{'$sum':_0xb45e62(0x213)},'totalGross':{'$sum':{'$multiply':[_0xb45e62(0x213),_0xb45e62(0x16f)]}},'NetPrice':{'$sum':_0xb45e62(0x270)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0xb45e62(0x1ed)},'cash':{'$first':'$cash'},'amount':{'$first':_0xb45e62(0x22b)},'bank':{'$first':'$bank'},'check_no':{'$first':_0xb45e62(0x203)},'due_date':{'$first':_0xb45e62(0x210)},'product_details':{'$first':_0xb45e62(0x113)}}},{'$group':{'_id':{'dsi':_0xb45e62(0x181),'date':_0xb45e62(0xea),'customer':_0xb45e62(0x12a),'status_data':_0xb45e62(0x254)},'totalQty':{'$sum':_0xb45e62(0x14c)},'totalGross':{'$sum':_0xb45e62(0x1b1)},'NetPrice':{'$sum':_0xb45e62(0x1f6)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0xb45e62(0x1ea)},'cash':{'$first':_0xb45e62(0x132)},'amount':{'$first':_0xb45e62(0x22b)},'bank':{'$first':'$bank'},'check_no':{'$first':_0xb45e62(0x203)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0xb45e62(0x14c),'category':'$_id.category','brand':_0xb45e62(0x192),'product_details':_0xb45e62(0x251)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x535f0d=await sales_sa['aggregate']([{'$match':{'date':_0x50c7c4,'sales_staff_id':_0x20a499,'sale_product.isFG':_0xb45e62(0x26f)}},{'$unwind':'$sale_product'},{'$lookup':{'from':'products','localField':_0xb45e62(0x1ab),'foreignField':_0xb45e62(0x164),'as':'product_info'}},{'$unwind':_0xb45e62(0x214)},{'$group':{'_id':{'dsi':_0xb45e62(0x207),'date':'$date','customer':_0xb45e62(0x1f7)},'totalQty':{'$sum':_0xb45e62(0x188)},'cash':{'$first':_0xb45e62(0x132)},'amount':{'$first':_0xb45e62(0x22b)},'bank':{'$first':'$bank'},'check_no':{'$first':_0xb45e62(0x203)},'due_date':{'$first':_0xb45e62(0x210)},'products':{'$push':{'qty':_0xb45e62(0x188),'NetPrice':_0xb45e62(0x11c),'discount':_0xb45e62(0x106),'adj_discount':_0xb45e62(0x1e1),'product_details':{'prod_name':_0xb45e62(0x199),'product_code':_0xb45e62(0xee),'category':_0xb45e62(0xf2),'brand':'$product_info.brand','gross_price':_0xb45e62(0x17a),'isFG':_0xb45e62(0x1c3),'prod_cat':_0xb45e62(0x186),'prod_id':_0xb45e62(0x117)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0xb45e62(0xea),'customer':_0xb45e62(0x12a),'category':_0xb45e62(0x244),'brand':_0xb45e62(0x25e),'prod_id':_0xb45e62(0x157)},'totalQty':{'$sum':_0xb45e62(0x213)},'cash':{'$first':_0xb45e62(0x132)},'amount':{'$first':_0xb45e62(0x22b)},'bank':{'$first':_0xb45e62(0x25f)},'check_no':{'$first':_0xb45e62(0x203)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':{'$multiply':['$products.qty','$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0xb45e62(0x1ed)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0xb45e62(0x181),'date':'$_id.date','customer':_0xb45e62(0x12a)},'totalQty':{'$sum':_0xb45e62(0x14c)},'cash':{'$first':_0xb45e62(0x132)},'amount':{'$first':'$amount'},'bank':{'$first':_0xb45e62(0x25f)},'check_no':{'$first':_0xb45e62(0x203)},'due_date':{'$first':_0xb45e62(0x210)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0xb45e62(0x1f6)},'discount':{'$sum':_0xb45e62(0x1fa)},'adj_discount':{'$sum':_0xb45e62(0x1ea)},'products':{'$push':{'qty':_0xb45e62(0x14c),'category':_0xb45e62(0x1f3),'brand':'$_id.brand','product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5f5213=await sales_sa[_0xb45e62(0x226)]([{'$match':{'date':_0x38401f,'sales_staff_id':_0x20a499,'status_data':'true'}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5c361d=await staff['findById'](_0x20a499);let _0x1a0c07=[],_0x5ce5ad={},_0x487ece={};var _0x1e9698=0x0,_0x3fe81e=0x0,_0x5d400d=0x0,_0x6ece20=0x0,_0x17da4d=0x0;const _0x3542e4=0x6;var _0x496ff8=0x0,_0x5c0fb9=0x0;for(let _0x21efff=0x0;_0x21efff<=_0x3b3ba4['length']-0x1;_0x21efff++){const _0x5abcf6=_0x3b3ba4[_0x21efff];let _0x40119e='<tr>';_0x40119e+=_0xb45e62(0x1bc),_0x40119e+=_0xb45e62(0x242)+_0x5abcf6['_id']['customer']+'</td>',_0x40119e+=_0xb45e62(0x242)+_0x5abcf6['_id']['dsi']+'</td>';let _0x123171={},_0x5cf2f6={},_0x273e9c={};var _0x4dc509={},_0x2bb765={},_0x23f575={},_0x583376=0x0;for(let _0x1bacc2=0x0;_0x1bacc2<=_0x5abcf6[_0xb45e62(0x14d)]['length']-0x1;_0x1bacc2++){const _0xc11a2d=_0x5abcf6[_0xb45e62(0x14d)][_0x1bacc2];_0x123171[_0xc11a2d['brand']+'-'+_0xc11a2d['category']]=_0xc11a2d[_0xb45e62(0x131)],_0x5cf2f6[[_0xc11a2d['brand']+'-'+_0xc11a2d[_0xb45e62(0x21e)]]]=_0xc11a2d[_0xb45e62(0x1e2)]['isFG'],_0x273e9c[[_0xc11a2d['brand']+'-'+_0xc11a2d[_0xb45e62(0x21e)]]]=_0xc11a2d[_0xb45e62(0x1e2)][_0xb45e62(0x1d0)];const _0x232d73=_0xc11a2d['brand']+'-'+_0xc11a2d[_0xb45e62(0x21e)];!Array['isArray'](_0x487ece[_0x232d73])&&(_0x487ece[_0x232d73]=[]);!Array[_0xb45e62(0x245)](_0x487ece[_0x232d73])&&(_0x487ece[_0x232d73]=[]);_0x487ece[_0x232d73][_0xb45e62(0x19e)](_0xc11a2d[_0xb45e62(0x131)]);if(_0xc11a2d[_0xb45e62(0x1e2)][_0xb45e62(0x1d0)]=='P')_0xc11a2d[_0xb45e62(0x1e2)][_0xb45e62(0x23b)]==_0xb45e62(0x246)?(!_0x23f575[_0x232d73]&&(_0x23f575[_0x232d73]=0x0),_0x23f575[_0x232d73]=_0xc11a2d[_0xb45e62(0x131)]):(!_0x4dc509[_0x232d73]&&(_0x4dc509[_0x232d73]=0x0),_0x4dc509[_0x232d73]=_0xc11a2d[_0xb45e62(0x131)]);else _0xc11a2d['product_details'][_0xb45e62(0x1d0)]=='S'&&(_0xc11a2d['product_details'][_0xb45e62(0x23b)]==_0xb45e62(0x246)?(!_0x23f575[_0x232d73]&&(_0x23f575[_0x232d73]=0x0),_0x23f575[_0x232d73]=_0xc11a2d[_0xb45e62(0x131)]):(!_0x2bb765[_0x232d73]&&(_0x2bb765[_0x232d73]=0x0),_0x2bb765[_0x232d73]=_0xc11a2d[_0xb45e62(0x131)]));_0x583376++;}for(let _0x17222d=0x0;_0x17222d<=_0x2cb652[_0xb45e62(0x26c)][_0xb45e62(0x10b)]-0x1;_0x17222d++){const _0x4d9fa4=_0x2cb652['cat_brand'][_0x17222d],_0x1a0acc=_0x4d9fa4['_id']['brand']+'-'+_0x4d9fa4[_0xb45e62(0x176)][_0xb45e62(0x21e)],_0x450177=_0x273e9c[_0x1a0acc]!==undefined?_0x273e9c[_0x1a0acc]:'NA';var _0x1231bb=_0x4dc509[_0x1a0acc]!==undefined?_0x4dc509[_0x1a0acc][_0xb45e62(0x141)](0x2):'',_0x387d79=_0x2bb765[_0x1a0acc]!==undefined?_0x2bb765[_0x1a0acc][_0xb45e62(0x141)](0x2):'',_0x6a9877=_0x23f575[_0x1a0acc]!==undefined?_0x23f575[_0x1a0acc]['toFixed'](0x2):'';_0x40119e+=_0xb45e62(0x22f)+_0x1231bb+_0xb45e62(0x146),_0x40119e+=_0xb45e62(0x22f)+_0x387d79+_0xb45e62(0x146),_0x40119e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x6a9877+_0xb45e62(0x146);}var _0x3f5c60=formatNumber(parseFloat(_0x5abcf6[_0xb45e62(0x1d6)])),_0x3c5f42=formatNumber(parseFloat(_0x5abcf6[_0xb45e62(0x1af)]));isNaN(_0x3c5f42)&&(_0x3c5f42=0x0),_0x40119e+=_0xb45e62(0x22f)+_0x3f5c60+_0xb45e62(0x146),_0x40119e+=_0xb45e62(0x22f)+_0x3c5f42+_0xb45e62(0x146),_0x40119e+=_0xb45e62(0x242)+_0x5abcf6[_0xb45e62(0x12e)]+_0xb45e62(0x146),_0x40119e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5abcf6[_0xb45e62(0x201)]+'</td>',_0x40119e+=_0xb45e62(0x242)+_0x5abcf6[_0xb45e62(0x134)]+_0xb45e62(0x146),_0x5d400d=_0x5abcf6[_0xb45e62(0x1c4)]+_0x5abcf6[_0xb45e62(0x212)],_0x496ff8+=parseFloat(_0x5abcf6[_0xb45e62(0x1d6)]),_0x5c0fb9+=parseFloat(_0x3c5f42),_0x1a0c07[_0xb45e62(0x19e)](_0x40119e);}function _0xe18a37(_0x218277,_0x37fbbd){const _0x3df4c9=_0xb45e62,_0x3aee0b=[];for(let _0x353388=0x0;_0x353388<=_0x218277[_0x3df4c9(0x10b)]-0x1;_0x353388+=_0x37fbbd){_0x3aee0b[_0x3df4c9(0x19e)](_0x218277[_0x3df4c9(0x190)](_0x353388,_0x353388+_0x37fbbd));}return _0x3aee0b;}const _0x38a44c=_0xe18a37(_0x1a0c07,_0x3542e4);let _0x154654='';return _0x38a44c[_0xb45e62(0x149)]((_0x43b19c,_0x34ce6f)=>{const _0xcbc735=_0xb45e62;_0x34ce6f>0x0&&(_0x154654+=_0xcbc735(0x1cf));_0x154654+=_0xcbc735(0x26d),_0x154654+=_0xcbc735(0xec);const _0x3cf79a=new Date(_0x38401f),_0x4fe76d={'year':_0xcbc735(0x19f),'month':'long','day':_0xcbc735(0x19f),'timeZone':_0xcbc735(0x1a8)},_0x16fb71=_0x3cf79a[_0xcbc735(0x174)]('en-US',_0x4fe76d);_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x1c7)+_0x5f2fb5+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x12f)+_0x5c361d[_0xcbc735(0x136)]+_0xcbc735(0x146),_0x154654+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>',_0x154654+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>',_0x154654+=_0xcbc735(0x14f),_0x154654+=_0xcbc735(0x1b5),_0x154654+=_0xcbc735(0x1a1),_0x154654+=_0xcbc735(0x204),_0x154654+=_0xcbc735(0x202),_0x154654+='<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>',_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x154654+=_0xcbc735(0x24c)+_0x16fb71+_0xcbc735(0x146),_0x154654+=_0xcbc735(0x1ae),_0x154654+=_0xcbc735(0xf8),_0x154654+=_0xcbc735(0x21c),_0x154654+=_0xcbc735(0x21c),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x179),_0x154654+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0x154654+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>',_0x154654+=_0xcbc735(0x21c),_0x154654+=_0xcbc735(0x21c),_0x154654+='</tr>',_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x1d3),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x1f9),_0x154654+=_0xcbc735(0x147),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x191),_0x154654+=_0xcbc735(0x175),_0x154654+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x199824=0x0;_0x199824<=_0x29dab2[_0xcbc735(0x10b)]-0x1;_0x199824++){const _0x4a9012=_0x29dab2[_0x199824];for(let _0xf6804c=0x0;_0xf6804c<_0x2cb652[_0xcbc735(0x26c)]['length'];_0xf6804c++){const _0x36c6d8=_0x2cb652[_0xcbc735(0x26c)][_0xf6804c];if(_0x36c6d8[_0xcbc735(0x176)][_0xcbc735(0x21e)]===_0x4a9012[_0xcbc735(0x176)][_0xcbc735(0x21e)]){var _0x54de20='';switch(_0x4a9012[_0xcbc735(0x176)]['category']){case'Standard':_0x54de20=_0x36c6d8[_0xcbc735(0x176)][_0xcbc735(0x148)]+'\x20-\x20STD';break;case _0xcbc735(0x13e):_0x54de20=_0x36c6d8[_0xcbc735(0x176)][_0xcbc735(0x148)]+_0xcbc735(0x105);break;default:_0x54de20=_0x36c6d8['_id'][_0xcbc735(0x148)];break;}_0x154654+=_0xcbc735(0x22e)+_0x54de20+_0xcbc735(0x184);}}}_0x154654+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x154654+=_0xcbc735(0x1aa),_0x154654+=_0xcbc735(0x153),_0x154654+='</tr>',_0x154654+='<tr>',_0x154654+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x15d4f0=0x0;_0x15d4f0<=_0x2cb652[_0xcbc735(0x26c)][_0xcbc735(0x10b)]-0x1;_0x15d4f0++){const _0x919800=_0x2cb652[_0x15d4f0];_0x154654+=_0xcbc735(0x26a),_0x154654+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x154654+=_0xcbc735(0x10e);}_0x154654+=_0xcbc735(0x145),_0x154654+=_0xcbc735(0x11f),_0x154654+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>',_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x25c),_0x154654+='<tbody>',_0x43b19c[_0xcbc735(0x149)](_0x1924cb=>{_0x154654+=_0x1924cb;});let _0x29e8dc={},_0x2e9a5a={},_0x50088b={};for(let _0x2e7b09=0x0;_0x2e7b09<=_0x3b3ba4[_0xcbc735(0x10b)]-0x1;_0x2e7b09++){const _0x64aefd=_0x3b3ba4[_0x2e7b09];var _0x46b3f5=0x0;for(let _0xb60d8b=0x0;_0xb60d8b<=_0x64aefd['products'][_0xcbc735(0x10b)]-0x1;_0xb60d8b++){const _0x17c810=_0x64aefd[_0xcbc735(0x14d)][_0xb60d8b],_0x1eaf6e=_0x17c810['brand']+'-'+_0x17c810[_0xcbc735(0x21e)];if(_0x17c810[_0xcbc735(0x1e2)][_0xcbc735(0x1d0)]=='P')_0x17c810[_0xcbc735(0x1e2)][_0xcbc735(0x23b)]==_0xcbc735(0x246)?(!_0x50088b[_0x1eaf6e]&&(_0x50088b[_0x1eaf6e]=0x0),_0x50088b[_0x1eaf6e]+=_0x17c810[_0xcbc735(0x131)]):(!_0x29e8dc[_0x1eaf6e]&&(_0x29e8dc[_0x1eaf6e]=0x0),_0x29e8dc[_0x1eaf6e]+=_0x17c810[_0xcbc735(0x131)]);else _0x17c810[_0xcbc735(0x1e2)][_0xcbc735(0x1d0)]=='S'&&(_0x17c810[_0xcbc735(0x1e2)]['isFG']==_0xcbc735(0x246)?(!_0x50088b[_0x1eaf6e]&&(_0x50088b[_0x1eaf6e]=0x0),_0x50088b[_0x1eaf6e]+=_0x17c810[_0xcbc735(0x131)],console['log'](_0x17c810['qty'])):(!_0x2e9a5a[_0x1eaf6e]&&(_0x2e9a5a[_0x1eaf6e]=0x0),_0x2e9a5a[_0x1eaf6e]+=_0x17c810[_0xcbc735(0x131)]));_0x46b3f5++;}}let _0x367b5a={},_0x116d29={},_0x29f6bd={};var _0x5e7f17=0x0,_0x463431=0x0;for(let _0x20ed00=0x0;_0x20ed00<=_0x535f0d[_0xcbc735(0x10b)]-0x1;_0x20ed00++){const _0x4a5b6e=_0x535f0d[_0x20ed00];var _0x46b3f5=0x0;for(let _0x1d55e2=0x0;_0x1d55e2<=_0x4a5b6e['products'][_0xcbc735(0x10b)]-0x1;_0x1d55e2++){const _0x350d6b=_0x4a5b6e[_0xcbc735(0x14d)][_0x1d55e2],_0x3b4213=_0x350d6b[_0xcbc735(0x148)]+'-'+_0x350d6b[_0xcbc735(0x21e)];if(_0x350d6b[_0xcbc735(0x1e2)][_0xcbc735(0x1d0)]=='P')_0x350d6b[_0xcbc735(0x1e2)]['isFG']==_0xcbc735(0x246)?(!_0x29f6bd[_0x3b4213]&&(_0x29f6bd[_0x3b4213]=0x0),_0x29f6bd[_0x3b4213]+=_0x350d6b[_0xcbc735(0x131)]):(!_0x367b5a[_0x3b4213]&&(_0x367b5a[_0x3b4213]=0x0),_0x367b5a[_0x3b4213]+=_0x350d6b[_0xcbc735(0x131)]);else _0x350d6b[_0xcbc735(0x1e2)][_0xcbc735(0x1d0)]=='S'&&(_0x350d6b['product_details']['isFG']==_0xcbc735(0x246)?(!_0x29f6bd[_0x3b4213]&&(_0x29f6bd[_0x3b4213]=0x0),_0x29f6bd[_0x3b4213]+=_0x350d6b[_0xcbc735(0x131)]):(!_0x116d29[_0x3b4213]&&(_0x116d29[_0x3b4213]=0x0),_0x116d29[_0x3b4213]+=_0x350d6b[_0xcbc735(0x131)]));_0x46b3f5++;}var _0x53ddcf=parseFloat(_0x4a5b6e[_0xcbc735(0x1d6)]),_0x3f80e6=parseFloat(_0x4a5b6e[_0xcbc735(0x1af)]);isNaN(_0x3f80e6)&&(_0x3f80e6=0x0),_0x5e7f17+=_0x53ddcf,_0x463431+=_0x3f80e6;}if(_0x5f5213[_0xcbc735(0x10b)]>0x0)for(let _0x5b97e5=0x0;_0x5b97e5<=_0x5f5213[_0xcbc735(0x10b)]-0x1;_0x5b97e5++){const _0x24e574=_0x5f5213[_0x5b97e5];console[_0xcbc735(0x218)](_0x24e574),_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x118)+(0x8+0x7*0x3)+'\x22><b>'+_0x24e574['note']+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1b6);}_0x154654+='<tr>',_0x154654+=_0xcbc735(0x1d1),_0x154654+=_0xcbc735(0x110),_0x154654+=_0xcbc735(0x1bc);for(let _0x3d5f19=0x0;_0x3d5f19<=_0x2cb652['cat_brand']['length']-0x1;_0x3d5f19++){const _0x4a3cfc=_0x2cb652[_0xcbc735(0x26c)][_0x3d5f19],_0x15a9df=_0x4a3cfc['_id'][_0xcbc735(0x148)]+'-'+_0x4a3cfc[_0xcbc735(0x176)][_0xcbc735(0x21e)];var _0x15c47b=_0x29e8dc[_0x15a9df]!==undefined?formatNumber(_0x29e8dc[_0x15a9df][_0xcbc735(0x141)](0x2)):'',_0x46cff5=_0x50088b[_0x15a9df]!==undefined?formatNumber(_0x50088b[_0x15a9df][_0xcbc735(0x141)](0x2)):'',_0x3bad6e=_0x2e9a5a[_0x15a9df]!==undefined?formatNumber(_0x2e9a5a[_0x15a9df][_0xcbc735(0x141)](0x2)):'';_0x154654+=_0xcbc735(0x1bf)+_0x15c47b+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1bf)+_0x3bad6e+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1bf)+_0x46cff5+_0xcbc735(0x184);}_0x154654+=_0xcbc735(0x1bf)+formatNumber(_0x496ff8)+'</b></td>',_0x154654+=_0xcbc735(0x1bf)+formatNumber(_0x5c0fb9)+_0xcbc735(0x184),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x154654+=_0xcbc735(0x170),_0x154654+=_0xcbc735(0x1bc);for(let _0x78b4bd=0x0;_0x78b4bd<=_0x2cb652['cat_brand'][_0xcbc735(0x10b)]-0x1;_0x78b4bd++){const _0x108464=_0x2cb652['cat_brand'][_0x78b4bd],_0xcf6ef4=_0x108464[_0xcbc735(0x176)][_0xcbc735(0x148)]+'-'+_0x108464['_id'][_0xcbc735(0x21e)];var _0x15c47b=_0x367b5a[_0xcf6ef4]!==undefined?formatNumber(_0x367b5a[_0xcf6ef4][_0xcbc735(0x141)](0x2)):'',_0x46cff5=_0x29f6bd[_0xcf6ef4]!==undefined?formatNumber(_0x29f6bd[_0xcf6ef4]['toFixed'](0x2)):'',_0x3bad6e=_0x116d29[_0xcf6ef4]!==undefined?formatNumber(_0x116d29[_0xcf6ef4][_0xcbc735(0x141)](0x2)):'';_0x154654+=_0xcbc735(0x1bf)+_0x15c47b+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1bf)+_0x3bad6e+_0xcbc735(0x184),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x46cff5+_0xcbc735(0x184);}_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5e7f17)+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1bf)+formatNumber(_0x463431)+_0xcbc735(0x184),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x1d1),_0x154654+=_0xcbc735(0x23f),_0x154654+=_0xcbc735(0x1bc);let _0xa24e42=0x0,_0x30bb92=0x0,_0x21f6dc=0x0;for(let _0x5e00ac=0x0;_0x5e00ac<=_0x2cb652[_0xcbc735(0x26c)][_0xcbc735(0x10b)]-0x1;_0x5e00ac++){const _0x669530=_0x2cb652[_0xcbc735(0x26c)][_0x5e00ac],_0xe827dc=_0x669530[_0xcbc735(0x176)][_0xcbc735(0x148)]+'-'+_0x669530['_id']['category'];var _0x411ca9=_0x29e8dc[_0xe827dc]!==undefined?_0x29e8dc[_0xe827dc]['toFixed'](0x2):'0',_0x1e03c5=_0x50088b[_0xe827dc]!==undefined?_0x50088b[_0xe827dc][_0xcbc735(0x141)](0x2):'0',_0xba9c04=_0x2e9a5a[_0xe827dc]!==undefined?_0x2e9a5a[_0xe827dc][_0xcbc735(0x141)](0x2):'0',_0x6fd996=_0x367b5a[_0xe827dc]!==undefined?_0x367b5a[_0xe827dc][_0xcbc735(0x141)](0x2):'0',_0x26568f=_0x29f6bd[_0xe827dc]!==undefined?_0x29f6bd[_0xe827dc][_0xcbc735(0x141)](0x2):'0',_0x2d1bc7=_0x116d29[_0xe827dc]!==undefined?_0x116d29[_0xe827dc][_0xcbc735(0x141)](0x2):'0';_0xa24e42=parseFloat(_0x411ca9)+parseFloat(_0x6fd996),_0x30bb92=parseFloat(_0xba9c04)+parseFloat(_0x2d1bc7),_0x21f6dc=parseFloat(_0x1e03c5)+parseFloat(_0x26568f),_0x154654+=_0xcbc735(0x1bf)+formatNumber(_0xa24e42['toFixed'](0x2))+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1bf)+formatNumber(_0x30bb92[_0xcbc735(0x141)](0x2))+_0xcbc735(0x184),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x21f6dc[_0xcbc735(0x141)](0x2))+'</b></td>';}var _0x1407cb=formatNumber(_0x496ff8+_0x5e7f17),_0x1fb313=formatNumber(_0x5c0fb9+_0x463431);_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1407cb+_0xcbc735(0x184),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1fb313+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x2cb652['cat_brand'][_0xcbc735(0x10b)]*0x3+0x9)+_0xcbc735(0x14a),_0x154654+=_0xcbc735(0x1b6),_0x154654+='<tr>',_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x154654+=_0xcbc735(0x1e0),_0x154654+=_0xcbc735(0x1bc);for(let _0x36ae31=0x0;_0x36ae31<=_0x2cb652[_0xcbc735(0x26c)][_0xcbc735(0x10b)]-0x1;_0x36ae31++){const _0xaedf9=_0x2cb652[_0xcbc735(0x26c)][_0x36ae31],_0x5e4d33=_0xaedf9['_id'][_0xcbc735(0x148)]+'-'+_0xaedf9['_id'][_0xcbc735(0x21e)];var _0x411ca9=_0x29e8dc[_0x5e4d33]!==undefined?_0x29e8dc[_0x5e4d33][_0xcbc735(0x141)](0x2):'0',_0x1e03c5=_0x50088b[_0x5e4d33]!==undefined?_0x50088b[_0x5e4d33]['toFixed'](0x2):'0',_0xba9c04=_0x2e9a5a[_0x5e4d33]!==undefined?_0x2e9a5a[_0x5e4d33]['toFixed'](0x2):'0',_0x6fd996=_0x367b5a[_0x5e4d33]!==undefined?_0x367b5a[_0x5e4d33][_0xcbc735(0x141)](0x2):'0',_0x26568f=_0x29f6bd[_0x5e4d33]!==undefined?_0x29f6bd[_0x5e4d33][_0xcbc735(0x141)](0x2):'0',_0x2d1bc7=_0x116d29[_0x5e4d33]!==undefined?_0x116d29[_0x5e4d33][_0xcbc735(0x141)](0x2):'0';_0xa24e42=parseFloat(_0x411ca9)+parseFloat(_0x6fd996),_0x30bb92=parseFloat(_0xba9c04)+parseFloat(_0x2d1bc7),_0x21f6dc=parseFloat(_0x1e03c5)+parseFloat(_0x26568f),_0x154654+=_0xcbc735(0x166),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x154654+=_0xcbc735(0x166);}_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+='</tr>',_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x1d1),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>',_0x154654+=_0xcbc735(0x1bc);for(let _0x343606=0x0;_0x343606<=_0x2cb652[_0xcbc735(0x26c)][_0xcbc735(0x10b)]-0x1;_0x343606++){const _0x396399=_0x2cb652['cat_brand'][_0x343606],_0x17c098=_0x396399[_0xcbc735(0x176)][_0xcbc735(0x148)]+'-'+_0x396399[_0xcbc735(0x176)][_0xcbc735(0x21e)];var _0x411ca9=_0x29e8dc[_0x17c098]!==undefined?_0x29e8dc[_0x17c098]['toFixed'](0x2):'0',_0x1e03c5=_0x50088b[_0x17c098]!==undefined?_0x50088b[_0x17c098]['toFixed'](0x2):'0',_0xba9c04=_0x2e9a5a[_0x17c098]!==undefined?_0x2e9a5a[_0x17c098]['toFixed'](0x2):'0',_0x6fd996=_0x367b5a[_0x17c098]!==undefined?_0x367b5a[_0x17c098][_0xcbc735(0x141)](0x2):'0',_0x26568f=_0x29f6bd[_0x17c098]!==undefined?_0x29f6bd[_0x17c098]['toFixed'](0x2):'0',_0x2d1bc7=_0x116d29[_0x17c098]!==undefined?_0x116d29[_0x17c098][_0xcbc735(0x141)](0x2):'0';_0xa24e42=parseFloat(_0x411ca9)+parseFloat(_0x6fd996),_0x30bb92=parseFloat(_0xba9c04)+parseFloat(_0x2d1bc7),_0x21f6dc=parseFloat(_0x1e03c5)+parseFloat(_0x26568f),_0x154654+=_0xcbc735(0x166),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x154654+=_0xcbc735(0x166);}_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+='</tr>',_0x154654+=_0xcbc735(0x1c0),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x154654+=_0xcbc735(0xef),_0x154654+=_0xcbc735(0x1bc);for(let _0x1e6efe=0x0;_0x1e6efe<=_0x2cb652[_0xcbc735(0x26c)]['length']-0x1;_0x1e6efe++){const _0x456181=_0x2cb652[_0xcbc735(0x26c)][_0x1e6efe],_0x18f907=_0x456181[_0xcbc735(0x176)][_0xcbc735(0x148)]+'-'+_0x456181[_0xcbc735(0x176)][_0xcbc735(0x21e)];var _0x411ca9=_0x29e8dc[_0x18f907]!==undefined?_0x29e8dc[_0x18f907]['toFixed'](0x2):'0',_0x1e03c5=_0x50088b[_0x18f907]!==undefined?_0x50088b[_0x18f907][_0xcbc735(0x141)](0x2):'0',_0xba9c04=_0x2e9a5a[_0x18f907]!==undefined?_0x2e9a5a[_0x18f907][_0xcbc735(0x141)](0x2):'0',_0x6fd996=_0x367b5a[_0x18f907]!==undefined?_0x367b5a[_0x18f907]['toFixed'](0x2):'0',_0x26568f=_0x29f6bd[_0x18f907]!==undefined?_0x29f6bd[_0x18f907][_0xcbc735(0x141)](0x2):'0',_0x2d1bc7=_0x116d29[_0x18f907]!==undefined?_0x116d29[_0x18f907][_0xcbc735(0x141)](0x2):'0';_0xa24e42=parseFloat(_0x411ca9)+parseFloat(_0x6fd996),_0x30bb92=parseFloat(_0xba9c04)+parseFloat(_0x2d1bc7),_0x21f6dc=parseFloat(_0x1e03c5)+parseFloat(_0x26568f),_0x154654+=_0xcbc735(0x166),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x154654+=_0xcbc735(0x1bc),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x154654+=_0xcbc735(0x1bc),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x1d1),_0x154654+=_0xcbc735(0x110),_0x154654+=_0xcbc735(0x1bc);for(let _0x31a82a=0x0;_0x31a82a<=_0x2cb652[_0xcbc735(0x26c)]['length']-0x1;_0x31a82a++){const _0x1502b0=_0x2cb652['cat_brand'][_0x31a82a],_0x3505b2=_0x1502b0[_0xcbc735(0x176)][_0xcbc735(0x148)]+'-'+_0x1502b0['_id'][_0xcbc735(0x21e)];var _0x411ca9=_0x29e8dc[_0x3505b2]!==undefined?_0x29e8dc[_0x3505b2][_0xcbc735(0x141)](0x2):'',_0x1e03c5=_0x50088b[_0x3505b2]!==undefined?_0x50088b[_0x3505b2]['toFixed'](0x2):'',_0xba9c04=_0x2e9a5a[_0x3505b2]!==undefined?_0x2e9a5a[_0x3505b2][_0xcbc735(0x141)](0x2):'',_0x6fd996=_0x367b5a[_0x3505b2]!==undefined?_0x367b5a[_0x3505b2]['toFixed'](0x2):'',_0x26568f=_0x29f6bd[_0x3505b2]!==undefined?_0x29f6bd[_0x3505b2][_0xcbc735(0x141)](0x2):'',_0x2d1bc7=_0x116d29[_0x3505b2]!==undefined?_0x116d29[_0x3505b2]['toFixed'](0x2):'';_0xa24e42=formatNumber(parseFloat(_0x411ca9)+parseFloat(_0x6fd996)),_0x30bb92=formatNumber(parseFloat(_0xba9c04)+parseFloat(_0x2d1bc7)),_0x21f6dc=formatNumber(parseFloat(_0x1e03c5)+parseFloat(_0x26568f)),_0x154654+=_0xcbc735(0x1bf)+_0x411ca9+_0xcbc735(0x184),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0xba9c04+_0xcbc735(0x184),_0x154654+=_0xcbc735(0x1bf)+_0x1e03c5+_0xcbc735(0x184);}_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x1c0),_0x154654+=_0xcbc735(0x1d1),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>',_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x283362=0x0;_0x283362<=_0x2cb652[_0xcbc735(0x26c)][_0xcbc735(0x10b)]-0x1;_0x283362++){const _0x597da6=_0x2cb652['cat_brand'][_0x283362],_0x28ecf6=_0x597da6[_0xcbc735(0x176)][_0xcbc735(0x148)]+'-'+_0x597da6[_0xcbc735(0x176)][_0xcbc735(0x21e)];var _0x411ca9=_0x29e8dc[_0x28ecf6]!==undefined?_0x29e8dc[_0x28ecf6]['toFixed'](0x2):'0',_0x1e03c5=_0x50088b[_0x28ecf6]!==undefined?_0x50088b[_0x28ecf6][_0xcbc735(0x141)](0x2):'0',_0xba9c04=_0x2e9a5a[_0x28ecf6]!==undefined?_0x2e9a5a[_0x28ecf6]['toFixed'](0x2):'0',_0x6fd996=_0x367b5a[_0x28ecf6]!==undefined?_0x367b5a[_0x28ecf6][_0xcbc735(0x141)](0x2):'0',_0x26568f=_0x29f6bd[_0x28ecf6]!==undefined?_0x29f6bd[_0x28ecf6][_0xcbc735(0x141)](0x2):'0',_0x2d1bc7=_0x116d29[_0x28ecf6]!==undefined?_0x116d29[_0x28ecf6][_0xcbc735(0x141)](0x2):'0';_0xa24e42=parseFloat(_0x411ca9)+parseFloat(_0x6fd996),_0x30bb92=parseFloat(_0xba9c04)+parseFloat(_0x2d1bc7),_0x21f6dc=parseFloat(_0x1e03c5)+parseFloat(_0x26568f),_0x154654+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x154654+=_0xcbc735(0x166),_0x154654+=_0xcbc735(0x166);}_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1bc),_0x154654+=_0xcbc735(0x1b6),_0x154654+=_0xcbc735(0x115),_0x154654+=_0xcbc735(0x1da);}),_0x154654;}async function generateReferenceNumber(_0x38d13b,_0x30cc3,_0x43d40c){const _0x3194e7=a0_0x279c9d,_0x241c3d=new Date(_0x38d13b)['getFullYear'](),_0x1e658a=('0'+(new Date(_0x38d13b)[_0x3194e7(0x155)]()+0x1))[_0x3194e7(0x190)](-0x2),_0xf662=('0'+new Date(_0x38d13b)[_0x3194e7(0x1f0)]())['slice'](-0x2),_0x57c717=await staff[_0x3194e7(0x1b4)]({'email':_0x43d40c[_0x3194e7(0x1ce)]}),_0x441707=_0x57c717[_0x3194e7(0x198)],_0x49df5a=_0x441707+'-'+_0x241c3d+_0x1e658a+_0xf662,_0xdaf0fc=await Reference[_0x3194e7(0x1b4)]({'referenceNumber':new RegExp('^'+_0x49df5a),'salesman_code':_0x441707})[_0x3194e7(0x17d)]({'createdAt':-0x1}),_0x11c33c=_0x49df5a;_0xdaf0fc&&(_0x11c33c=_0xdaf0fc['referenceNumber']);console[_0x3194e7(0x218)](_0x11c33c);const _0x9a6425=new Reference({'referenceNumber':_0x11c33c,'staff_id':_0x30cc3,'salesman_code':_0x441707});return await _0x9a6425[_0x3194e7(0x180)](),_0x11c33c;}router[a0_0x279c9d(0x205)](a0_0x279c9d(0x20b),auth,async(_0x17b30c,_0x388e50)=>{const _0x474269=a0_0x279c9d,{from_date:_0x1d8d06,dataview:_0x4bfbb2}=_0x17b30c[_0x474269(0x171)],_0x2b5313=_0x17b30c[_0x474269(0x18e)],_0x4a78c6=await staff[_0x474269(0x1b4)]({'email':_0x2b5313[_0x474269(0x1ce)]}),_0x20e309=await master_shop[_0x474269(0x220)](),_0x1cf917='';var _0x1f70a7=new Date(_0x1d8d06);const _0x2b0cad={'year':_0x474269(0x19f),'month':_0x474269(0x224),'day':_0x474269(0x19f)},_0x421000=new Intl[(_0x474269(0x223))]('en-US',_0x2b0cad)[_0x474269(0x20c)](_0x1f70a7),_0x33ec2a=await Reference[_0x474269(0x220)]({'staff_id':_0x4a78c6[_0x474269(0x176)][_0x474269(0x15e)](),'date_include':_0x1d8d06});if(_0x33ec2a[_0x474269(0x10b)]>0x0){let _0x31abc4='';_0x31abc4+=_0x33ec2a[0x0]['html'];if(_0x4bfbb2==_0x474269(0x162)){const _0x28481a=cheerio['load'](_0x31abc4);let _0x293a93=[],_0x3780f7=[],_0x3440e8=[];const _0x19cf32=_0x2a259d=>{const _0x34de01=_0x474269,_0x594374={'top':{'style':_0x34de01(0x193),'color':{'rgb':_0x34de01(0x1e3)}},'bottom':{'style':_0x34de01(0x193),'color':{'rgb':'000000'}},'left':{'style':'thick','color':{'rgb':_0x34de01(0x1e3)}},'right':{'style':_0x34de01(0x193),'color':{'rgb':'000000'}}};if(_0x2a259d){const _0x492f5a=_0x2a259d[_0x34de01(0xf4)](';')[_0x34de01(0x13b)]((_0x27425f,_0x22fcc2)=>{const _0x5b9124=_0x34de01,[_0x5a1123,_0x4d44f4]=_0x22fcc2[_0x5b9124(0xf4)](':')[_0x5b9124(0x25b)](_0x4cefcf=>_0x4cefcf[_0x5b9124(0x194)]());return _0x27425f[_0x5a1123]=_0x4d44f4,_0x27425f;},{});_0x492f5a[_0x34de01(0x1e8)]&&(_0x594374[_0x34de01(0x259)]['style']=_0x492f5a['border-top'][_0x34de01(0x12c)](_0x34de01(0x233))?_0x34de01(0x233):_0x34de01(0x263)),_0x492f5a['border-bottom']&&(_0x594374['bottom'][_0x34de01(0x10f)]=_0x492f5a['border-bottom']['includes']('thin')?_0x34de01(0x233):'medium'),_0x492f5a[_0x34de01(0x241)]&&(_0x594374[_0x34de01(0x1b9)][_0x34de01(0x10f)]=_0x492f5a[_0x34de01(0x241)][_0x34de01(0x12c)](_0x34de01(0x233))?_0x34de01(0x233):_0x34de01(0x263)),_0x492f5a[_0x34de01(0x10a)]&&(_0x594374[_0x34de01(0x1d8)][_0x34de01(0x10f)]=_0x492f5a[_0x34de01(0x10a)][_0x34de01(0x12c)](_0x34de01(0x233))?_0x34de01(0x233):'medium');}return _0x594374;};_0x28481a(_0x474269(0x197))['each']((_0x2e9793,_0x4adaac)=>{const _0x175386=_0x474269;let _0x14918a=[],_0x39e916=0x0;while(_0x3440e8[_0x39e916]){_0x3440e8[_0x39e916]--,_0x39e916++;}_0x28481a(_0x4adaac)[_0x175386(0x220)](_0x175386(0x20d))['each']((_0x56a6a8,_0x704ba7)=>{const _0x24b46d=_0x175386;let _0x4b4280=_0x28481a(_0x704ba7)[_0x24b46d(0x1ff)]()[_0x24b46d(0x194)](),_0x5b6223=parseFloat(_0x4b4280[_0x24b46d(0x22d)](/,/g,''));isNaN(_0x5b6223)&&(_0x5b6223=_0x4b4280);let _0x138b11=parseInt(_0x28481a(_0x704ba7)[_0x24b46d(0x1f8)](_0x24b46d(0x1c6)))||0x1,_0x96097b=parseInt(_0x28481a(_0x704ba7)[_0x24b46d(0x1f8)]('rowspan'))||0x1;const _0x1ef0c3=_0x28481a(_0x704ba7)[_0x24b46d(0x1f8)](_0x24b46d(0x10f)),_0x22f891=_0x19cf32(_0x1ef0c3);_0x14918a[_0x39e916]={'v':_0x5b6223,'s':{'border':_0x22f891}};(_0x138b11>0x1||_0x96097b>0x1)&&_0x3780f7['push']({'s':{'r':_0x2e9793,'c':_0x39e916},'e':{'r':_0x2e9793+_0x96097b-0x1,'c':_0x39e916+_0x138b11-0x1}});for(let _0x246b70=0x0;_0x246b70<_0x138b11;_0x246b70++){_0x96097b>0x1&&(_0x3440e8[_0x39e916+_0x246b70]=_0x96097b-0x1);}_0x39e916+=_0x138b11;}),_0x293a93['push'](_0x14918a);});const _0x5ed1bc=XLSX[_0x474269(0xfb)][_0x474269(0x23e)](),_0x23801c=XLSX[_0x474269(0xfb)][_0x474269(0x26e)](_0x293a93);_0x3780f7[_0x474269(0x10b)]>0x0&&(_0x23801c[_0x474269(0x261)]=_0x3780f7);_0x23801c['!cols']=_0x293a93[0x0][_0x474269(0x25b)](()=>({'wpx':0x64})),XLSX[_0x474269(0xfb)][_0x474269(0x138)](_0x5ed1bc,_0x23801c,_0x474269(0x1a7));const _0x1a4c4d=XLSX[_0x474269(0x165)](_0x5ed1bc,{'bookType':_0x474269(0x21d),'type':'buffer'});_0x388e50[_0x474269(0x1df)](_0x474269(0x139),_0x474269(0x17e)),_0x388e50[_0x474269(0x1df)](_0x474269(0x10c),_0x474269(0x265)),_0x388e50[_0x474269(0x1cc)](_0x1a4c4d);}else{let _0x28912b='';_0x28912b+=_0x31abc4,_0x28912b+='<script>',_0x28912b+='window.onload\x20=\x20function()\x20{',_0x28912b+=_0x474269(0x16a),_0x28912b+='};',_0x28912b+=_0x474269(0xf3),_0x388e50[_0x474269(0x1cc)](_0x28912b);}}else generateReferenceNumber(_0x1d8d06,_0x4a78c6[_0x474269(0x176)][_0x474269(0x15e)](),_0x2b5313)[_0x474269(0x20a)](async _0x4b1950=>{const _0x4f43c4=_0x474269,_0x50f8a7=await agentsdataDSICheck_DSRR(_0x1d8d06,_0x4a78c6[_0x4f43c4(0x176)]['valueOf'](),_0x1cf917,_0x4b1950);let _0x3f1ce7='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x3f1ce7+=_0x4f43c4(0x1dd),_0x3f1ce7+=_0x4f43c4(0x230),_0x3f1ce7+='<table>',_0x3f1ce7+=_0x50f8a7,_0x3f1ce7+=_0x4f43c4(0x1da),_0x3f1ce7+=_0x4f43c4(0x250),_0x3f1ce7+=_0x4f43c4(0x250);if(_0x50f8a7[_0x4f43c4(0x10b)]>0x0){const _0x2312d9=await Reference[_0x4f43c4(0x1b4)]({'staff_id':_0x4a78c6[_0x4f43c4(0x176)][_0x4f43c4(0x15e)](),'referenceNumber':_0x4b1950});_0x2312d9[_0x4f43c4(0x24b)]=_0x3f1ce7,_0x2312d9[_0x4f43c4(0x173)]=_0x1d8d06,await _0x2312d9['save']();if(_0x4bfbb2==_0x4f43c4(0x162)){const _0x57aa72=cheerio[_0x4f43c4(0x1ad)](_0x3f1ce7);let _0x4e2e6f=[],_0x4678bd=[],_0x57d76e=[];const _0xecbfbf=_0x8d5b2a=>{const _0x6ece38=_0x4f43c4,_0x5f38b7={'top':{'style':_0x6ece38(0x193),'color':{'rgb':_0x6ece38(0x1e3)}},'bottom':{'style':_0x6ece38(0x193),'color':{'rgb':_0x6ece38(0x1e3)}},'left':{'style':_0x6ece38(0x193),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x6ece38(0x1e3)}}};if(_0x8d5b2a){const _0x2a1b7c=_0x8d5b2a[_0x6ece38(0xf4)](';')[_0x6ece38(0x13b)]((_0x22395a,_0x9561a0)=>{const _0x59b59b=_0x6ece38,[_0x22f810,_0x66ea07]=_0x9561a0['split'](':')['map'](_0x379197=>_0x379197[_0x59b59b(0x194)]());return _0x22395a[_0x22f810]=_0x66ea07,_0x22395a;},{});_0x2a1b7c[_0x6ece38(0x1e8)]&&(_0x5f38b7[_0x6ece38(0x259)][_0x6ece38(0x10f)]=_0x2a1b7c[_0x6ece38(0x1e8)][_0x6ece38(0x12c)](_0x6ece38(0x233))?_0x6ece38(0x233):_0x6ece38(0x263)),_0x2a1b7c['border-bottom']&&(_0x5f38b7[_0x6ece38(0x111)][_0x6ece38(0x10f)]=_0x2a1b7c[_0x6ece38(0x1a9)]['includes'](_0x6ece38(0x233))?'thin':_0x6ece38(0x263)),_0x2a1b7c[_0x6ece38(0x241)]&&(_0x5f38b7['left']['style']=_0x2a1b7c['border-left'][_0x6ece38(0x12c)](_0x6ece38(0x233))?_0x6ece38(0x233):'medium'),_0x2a1b7c[_0x6ece38(0x10a)]&&(_0x5f38b7[_0x6ece38(0x1d8)][_0x6ece38(0x10f)]=_0x2a1b7c[_0x6ece38(0x10a)]['includes']('thin')?_0x6ece38(0x233):_0x6ece38(0x263));}return _0x5f38b7;};_0x57aa72('table\x20tr')[_0x4f43c4(0x189)]((_0x3ec613,_0x2f4eeb)=>{const _0x54d31d=_0x4f43c4;let _0xcc6f26=[],_0x274583=0x0;while(_0x57d76e[_0x274583]){_0x57d76e[_0x274583]--,_0x274583++;}_0x57aa72(_0x2f4eeb)[_0x54d31d(0x220)](_0x54d31d(0x20d))[_0x54d31d(0x189)]((_0x379fb8,_0x57055b)=>{const _0x5daaa0=_0x54d31d;let _0x13c7a7=_0x57aa72(_0x57055b)[_0x5daaa0(0x1ff)]()[_0x5daaa0(0x194)](),_0x19436e=parseFloat(_0x13c7a7[_0x5daaa0(0x22d)](/,/g,''));isNaN(_0x19436e)&&(_0x19436e=_0x13c7a7);let _0x10c594=parseInt(_0x57aa72(_0x57055b)[_0x5daaa0(0x1f8)](_0x5daaa0(0x1c6)))||0x1,_0x50d9bf=parseInt(_0x57aa72(_0x57055b)[_0x5daaa0(0x1f8)](_0x5daaa0(0x116)))||0x1;const _0x558464=_0x57aa72(_0x57055b)[_0x5daaa0(0x1f8)]('style'),_0xab92e=_0xecbfbf(_0x558464);_0xcc6f26[_0x274583]={'v':_0x19436e,'s':{'border':_0xab92e}};(_0x10c594>0x1||_0x50d9bf>0x1)&&_0x4678bd[_0x5daaa0(0x19e)]({'s':{'r':_0x3ec613,'c':_0x274583},'e':{'r':_0x3ec613+_0x50d9bf-0x1,'c':_0x274583+_0x10c594-0x1}});for(let _0x5b62eb=0x0;_0x5b62eb<_0x10c594;_0x5b62eb++){_0x50d9bf>0x1&&(_0x57d76e[_0x274583+_0x5b62eb]=_0x50d9bf-0x1);}_0x274583+=_0x10c594;}),_0x4e2e6f[_0x54d31d(0x19e)](_0xcc6f26);});const _0x39a55f=XLSX[_0x4f43c4(0xfb)][_0x4f43c4(0x23e)](),_0x20bc8d=XLSX[_0x4f43c4(0xfb)]['aoa_to_sheet'](_0x4e2e6f);_0x4678bd[_0x4f43c4(0x10b)]>0x0&&(_0x20bc8d[_0x4f43c4(0x261)]=_0x4678bd);_0x20bc8d[_0x4f43c4(0x22a)]=_0x4e2e6f[0x0][_0x4f43c4(0x25b)](()=>({'wpx':0x64})),XLSX['utils'][_0x4f43c4(0x138)](_0x39a55f,_0x20bc8d,_0x4f43c4(0x1a7));const _0x332ff5=XLSX['write'](_0x39a55f,{'bookType':'xlsx','type':_0x4f43c4(0x228)});_0x388e50['setHeader'](_0x4f43c4(0x139),_0x4f43c4(0x17e)),_0x388e50[_0x4f43c4(0x1df)](_0x4f43c4(0x10c),_0x4f43c4(0x265)),_0x388e50[_0x4f43c4(0x1cc)](_0x332ff5);}else _0x3f1ce7+=_0x4f43c4(0x126),_0x3f1ce7+=_0x4f43c4(0x187),_0x3f1ce7+=_0x4f43c4(0x16a),_0x3f1ce7+='};',_0x3f1ce7+=_0x4f43c4(0xf3),_0x388e50[_0x4f43c4(0x1cc)](_0x3f1ce7);}else await Reference['deleteOne']({'referenceNumber':_0x4b1950}),_0x17b30c[_0x4f43c4(0x215)](_0x4f43c4(0x13a),_0x4f43c4(0x1e6)),_0x388e50[_0x4f43c4(0x10d)](_0x4f43c4(0xf9));})[_0x474269(0x119)](console['error']);}),router['get'](a0_0x279c9d(0x160),auth,async(_0x28ed9d,_0x3ea122)=>{const _0x2d3b94=a0_0x279c9d;try{const {username:_0x348013,email:_0x5a683c,role:_0x2b7525}=_0x28ed9d[_0x2d3b94(0x18e)],_0x8bc1a0=_0x28ed9d[_0x2d3b94(0x18e)],_0x5c20ee=await profile[_0x2d3b94(0x1b4)]({'email':_0x8bc1a0[_0x2d3b94(0x1ce)]}),_0x5e0479={'year':_0x2d3b94(0x19f),'month':_0x2d3b94(0x224),'day':'numeric'},_0xd6d4b4=await master_shop[_0x2d3b94(0x220)]();console['log']('Products\x20master',_0xd6d4b4);const _0x2b8b82=await product[_0x2d3b94(0x220)]();console[_0x2d3b94(0x218)](_0x2d3b94(0x1b7),_0x2b8b82);const _0x4e1418=await warehouse[_0x2d3b94(0x226)]([{'$unwind':_0x2d3b94(0x251)},{'$lookup':{'from':_0x2d3b94(0x14d),'localField':'product_details.product_name','foreignField':_0x2d3b94(0x136),'as':_0x2d3b94(0x151)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x2d3b94(0x135)}},{'$group':{'_id':_0x2d3b94(0x211),'product_stock':{'$sum':_0x2d3b94(0x156)}}}]);console[_0x2d3b94(0x218)](_0x2d3b94(0x1eb),_0x4e1418),_0x4e1418[_0x2d3b94(0x149)](_0x42bb55=>{const _0x825891=_0x2d3b94,_0x2aeef1=_0x2b8b82[_0x825891(0x25b)](_0x332f71=>{const _0x4b201f=_0x825891;_0x332f71[_0x4b201f(0x136)]==_0x42bb55[_0x4b201f(0x176)]&&(_0x332f71[_0x4b201f(0xf1)]=parseInt(_0x332f71[_0x4b201f(0xf1)])+parseInt(_0x42bb55[_0x4b201f(0x177)]));});});const _0x33468b=await staff[_0x2d3b94(0x220)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x4cbdf9=await staff[_0x2d3b94(0x1b4)]({'email':_0x8bc1a0[_0x2d3b94(0x1ce)]});if(_0xd6d4b4[0x0][_0x2d3b94(0x209)]=='English\x20(US)')var _0x3271e8=users[_0x2d3b94(0x1d7)];else{if(_0xd6d4b4[0x0][_0x2d3b94(0x209)]=='Hindi')var _0x3271e8=users['Hindi'];else{if(_0xd6d4b4[0x0]['language']==_0x2d3b94(0x24a))var _0x3271e8=users[_0x2d3b94(0x24a)];else{if(_0xd6d4b4[0x0][_0x2d3b94(0x209)]==_0x2d3b94(0x237))var _0x3271e8=users['Spanish'];else{if(_0xd6d4b4[0x0]['language']==_0x2d3b94(0x216))var _0x3271e8=users[_0x2d3b94(0x216)];else{if(_0xd6d4b4[0x0][_0x2d3b94(0x209)]=='Portuguese\x20(BR)')var _0x3271e8=users[_0x2d3b94(0x217)];else{if(_0xd6d4b4[0x0]['language']==_0x2d3b94(0x1f1))var _0x3271e8=users[_0x2d3b94(0x1f1)];else{if(_0xd6d4b4[0x0][_0x2d3b94(0x209)]==_0x2d3b94(0x1ec))var _0x3271e8=users[_0x2d3b94(0x140)];}}}}}}}_0x3ea122[_0x2d3b94(0x11d)](_0x2d3b94(0x133),{'success':_0x28ed9d[_0x2d3b94(0x215)]('success'),'errors':_0x28ed9d[_0x2d3b94(0x215)](_0x2d3b94(0x13a)),'alldata':_0x2b8b82,'profile':_0x5c20ee,'master_shop':_0xd6d4b4,'role':_0x8bc1a0,'product_stock':_0x4e1418,'language':_0x3271e8,'staff_arr':_0x4cbdf9,'staff_data_all':_0x33468b});}catch(_0x348c55){}}),router[a0_0x279c9d(0x205)](a0_0x279c9d(0x122),auth,async(_0x64f6cd,_0xbd4049)=>{const _0x1075e2=a0_0x279c9d;try{const {from:_0x4c5445,to:_0x589e49,staff_data:_0x4424e8}=_0x64f6cd['body'],_0x15daf7=await Reference['aggregate']([{'$match':{'date_include':{'$gte':_0x4c5445,'$lte':_0x589e49},'staff_id':_0x4424e8}},{'$sort':{'date_include':0x1}}]);_0xbd4049[_0x1075e2(0x1bb)](_0x15daf7);}catch(_0x57a317){_0xbd4049['json'](_0x57a317);}}),router[a0_0x279c9d(0x20f)]('/dsrr_admin/view_data/:id',auth,async(_0x4a6e4a,_0xd02b7)=>{const _0x31ca75=a0_0x279c9d;try{const _0x3cccf4=_0x4a6e4a[_0x31ca75(0x269)]['id'],_0x45012e=await Reference[_0x31ca75(0x1a3)](_0x3cccf4);let _0x48e441='';_0x48e441+=_0x45012e[_0x31ca75(0x24b)],_0x48e441+='<script>',_0x48e441+='window.onload\x20=\x20function()\x20{',_0x48e441+='window.print();',_0x48e441+='};',_0x48e441+=_0x31ca75(0xf3),_0xd02b7[_0x31ca75(0x1cc)](_0x48e441);}catch(_0x866cb1){_0xd02b7[_0x31ca75(0x1bb)](_0x866cb1);}}),router['post'](a0_0x279c9d(0x137),auth,async(_0x4b9347,_0x2158b7)=>{const _0x2ffc34=a0_0x279c9d;try{const {ref_data:_0x2e461f}=_0x4b9347['body'],_0x6739c1=_0x2e461f[_0x2ffc34(0xf4)]('~'),_0x1b646d=_0x6739c1[_0x2ffc34(0x183)](_0x209a8f=>_0x209a8f!==''),_0x222ff4=await Reference[_0x2ffc34(0x226)]([{'$match':{'referenceNumber':{'$in':_0x1b646d}}}]),_0x51716b=XLSX[_0x2ffc34(0xfb)][_0x2ffc34(0x23e)]();_0x222ff4[_0x2ffc34(0x149)](_0x518237=>{const _0x55fecc=_0x2ffc34,_0x424613=cheerio[_0x55fecc(0x1ad)](_0x518237[_0x55fecc(0x24b)]);let _0x303f2a=[],_0x1b80ea=[],_0x139ba5=[];_0x424613(_0x55fecc(0x197))[_0x55fecc(0x189)]((_0x20939a,_0x541540)=>{const _0x16c1d0=_0x55fecc;let _0x506bfc=[],_0x452c6b=0x0;while(_0x139ba5[_0x452c6b]){_0x139ba5[_0x452c6b]--,_0x452c6b++;}_0x424613(_0x541540)['find'](_0x16c1d0(0x20d))[_0x16c1d0(0x189)]((_0x15c7cc,_0x49c90d)=>{const _0x3ec04f=_0x16c1d0;let _0x1f4154=_0x424613(_0x49c90d)[_0x3ec04f(0x1ff)]()['trim'](),_0x5ecc0e=parseFloat(_0x1f4154['replace'](/,/g,''));isNaN(_0x5ecc0e)&&(_0x5ecc0e=_0x1f4154);let _0x29c4b9=parseInt(_0x424613(_0x49c90d)['attr']('colspan'))||0x1,_0x27b796=parseInt(_0x424613(_0x49c90d)[_0x3ec04f(0x1f8)](_0x3ec04f(0x116)))||0x1;_0x506bfc[_0x452c6b]=_0x5ecc0e;(_0x29c4b9>0x1||_0x27b796>0x1)&&_0x1b80ea[_0x3ec04f(0x19e)]({'s':{'r':_0x20939a,'c':_0x452c6b},'e':{'r':_0x20939a+_0x27b796-0x1,'c':_0x452c6b+_0x29c4b9-0x1}});for(let _0x5379e8=0x0;_0x5379e8<_0x29c4b9;_0x5379e8++){_0x27b796>0x1&&(_0x139ba5[_0x452c6b+_0x5379e8]=_0x27b796-0x1);}_0x452c6b+=_0x29c4b9;}),_0x303f2a[_0x16c1d0(0x19e)](_0x506bfc);});const _0x15c62e=XLSX[_0x55fecc(0xfb)]['aoa_to_sheet'](_0x303f2a);_0x1b80ea[_0x55fecc(0x10b)]>0x0&&(_0x15c62e[_0x55fecc(0x261)]=_0x1b80ea),_0x15c62e[_0x55fecc(0x22a)]=_0x303f2a[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x55fecc(0xfb)][_0x55fecc(0x138)](_0x51716b,_0x15c62e,_0x518237[_0x55fecc(0x108)]);});const _0x41f395=XLSX[_0x2ffc34(0x165)](_0x51716b,{'bookType':'xlsx','type':_0x2ffc34(0x228)});_0x2158b7[_0x2ffc34(0x1df)](_0x2ffc34(0x139),_0x2ffc34(0x1b3)),_0x2158b7[_0x2ffc34(0x1df)](_0x2ffc34(0x10c),_0x2ffc34(0x265)),_0x2158b7[_0x2ffc34(0x1cc)](_0x41f395);}catch(_0x55f128){_0x2158b7[_0x2ffc34(0x1bb)](_0x55f128);}}),router[a0_0x279c9d(0x205)]('/dsrr_admin/pdf_admin',auth,async(_0x17d2d2,_0x3decd8)=>{const _0x5b6ae9=a0_0x279c9d,{from_date:_0x376f62,agent_id:_0x5bc860}=_0x17d2d2['body'],_0x5489d6=_0x17d2d2[_0x5b6ae9(0x18e)],_0x59bfcb=await staff[_0x5b6ae9(0x1b4)]({'email':_0x5489d6[_0x5b6ae9(0x1ce)]}),_0x20fe3c=await master_shop[_0x5b6ae9(0x220)](),_0x4ad53d=await agentsdataDSICheck_DSRR(_0x376f62,_0x5bc860,_0x155df8);let _0xa0847f=_0x5b6ae9(0x1c9);var _0x9b44f4=new Date(_0x376f62);const _0x240776={'year':_0x5b6ae9(0x19f),'month':_0x5b6ae9(0x224),'day':_0x5b6ae9(0x19f)},_0x3eff8a=new Intl['DateTimeFormat']('en-US',_0x240776)['format'](_0x9b44f4);_0xa0847f+=_0x5b6ae9(0x1dd),_0xa0847f+='<div\x20\x20id=\x22table-conatainer\x22>',_0xa0847f+=_0x5b6ae9(0x26d),_0xa0847f+=_0x4ad53d,_0xa0847f+=_0x5b6ae9(0x1da),_0xa0847f+=_0x5b6ae9(0x250),_0xa0847f+=_0x5b6ae9(0x250);let _0x43f5a6=_0x5b6ae9(0xfa);const _0x6cba7={'width':'15in','height':_0x5b6ae9(0x18f),'orientation':_0x5b6ae9(0x22c),'border':{'top':_0x5b6ae9(0x249),'right':'0.1in','bottom':_0x5b6ae9(0x249),'left':_0x5b6ae9(0x249)},'header':{'height':_0x5b6ae9(0x104),'contents':_0x5b6ae9(0x169)+_0x43f5a6+_0x5b6ae9(0x20e)+_0x3eff8a+_0x5b6ae9(0x163)},'footer':{'height':_0x5b6ae9(0x260),'contents':{'default':_0x5b6ae9(0x13d)}},'dpi':0x5,'zoomFactor':'1'};var _0x155df8='on';if(_0x155df8=='on'){const _0x240cf4=cheerio[_0x5b6ae9(0x1ad)](_0xa0847f);let _0x50efdd=[],_0x2a32a2=[],_0x2a77f5=[];_0x240cf4(_0x5b6ae9(0x197))[_0x5b6ae9(0x189)]((_0x3f51e6,_0xb0cb80)=>{const _0x422111=_0x5b6ae9;let _0xd320d8=[],_0x375a8f=0x0;while(_0x2a77f5[_0x375a8f]){_0x2a77f5[_0x375a8f]--,_0x375a8f++;}_0x240cf4(_0xb0cb80)[_0x422111(0x220)](_0x422111(0x20d))[_0x422111(0x189)]((_0x22d530,_0x1fd148)=>{const _0x5cd39b=_0x422111;let _0x27ed75=_0x240cf4(_0x1fd148)[_0x5cd39b(0x1ff)]()['trim'](),_0x4d0f67=parseFloat(_0x27ed75[_0x5cd39b(0x22d)](/,/g,''));isNaN(_0x4d0f67)&&(_0x4d0f67=_0x27ed75);let _0x3f0553=parseInt(_0x240cf4(_0x1fd148)[_0x5cd39b(0x1f8)](_0x5cd39b(0x1c6)))||0x1,_0x417b4b=parseInt(_0x240cf4(_0x1fd148)[_0x5cd39b(0x1f8)](_0x5cd39b(0x116)))||0x1;_0xd320d8[_0x375a8f]=_0x4d0f67;(_0x3f0553>0x1||_0x417b4b>0x1)&&_0x2a32a2[_0x5cd39b(0x19e)]({'s':{'r':_0x3f51e6,'c':_0x375a8f},'e':{'r':_0x3f51e6+_0x417b4b-0x1,'c':_0x375a8f+_0x3f0553-0x1}});for(let _0x4c3951=0x0;_0x4c3951<_0x3f0553;_0x4c3951++){_0x417b4b>0x1&&(_0x2a77f5[_0x375a8f+_0x4c3951]=_0x417b4b-0x1);}_0x375a8f+=_0x3f0553;}),_0x50efdd[_0x422111(0x19e)](_0xd320d8);});const _0x2fb38c=XLSX[_0x5b6ae9(0xfb)][_0x5b6ae9(0x23e)](),_0x128cd6=XLSX[_0x5b6ae9(0xfb)][_0x5b6ae9(0x26e)](_0x50efdd);_0x2a32a2[_0x5b6ae9(0x10b)]>0x0&&(_0x128cd6[_0x5b6ae9(0x261)]=_0x2a32a2);_0x128cd6[_0x5b6ae9(0x22a)]=_0x50efdd[0x0][_0x5b6ae9(0x25b)](()=>({'wpx':0x64})),XLSX[_0x5b6ae9(0xfb)][_0x5b6ae9(0x138)](_0x2fb38c,_0x128cd6,_0x5b6ae9(0x1a7));const _0xd2d3ef=XLSX[_0x5b6ae9(0x165)](_0x2fb38c,{'bookType':'xlsx','type':'buffer'});_0x3decd8[_0x5b6ae9(0x1df)](_0x5b6ae9(0x139),_0x5b6ae9(0x17e)),_0x3decd8[_0x5b6ae9(0x1df)]('Content-Type',_0x5b6ae9(0x265)),_0x3decd8[_0x5b6ae9(0x1cc)](_0xd2d3ef);}else pdf[_0x5b6ae9(0x16b)](_0xa0847f,_0x6cba7)[_0x5b6ae9(0x227)](function(_0x4ea1d3,_0x467cd3){const _0x58e911=_0x5b6ae9;if(_0x4ea1d3){_0x3decd8[_0x58e911(0x172)](0x1f4)[_0x58e911(0x1cc)](_0x58e911(0x1ba));return;}_0x3decd8[_0x58e911(0x1df)](_0x58e911(0x10c),_0x58e911(0x1a4)),_0x467cd3[_0x58e911(0x17f)](_0x3decd8);});}),module[a0_0x279c9d(0x24e)]=router;